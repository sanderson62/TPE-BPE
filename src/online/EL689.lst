* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   1
* EL689.cbl
* Options: int("EL689.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL689.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL689.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL689.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3
     4 PROGRAM-ID.                 EL689 .
     5*              PROGRAM CONVERTED BY
     6*              COBOL CONVERSION AID PO 5785-ABJ
     7*              CONVERSION DATE 04/20/94 15:10:07.
     8*                            VMOD=2.037
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12*DATE-COMPILED.
    13*REMARKS.    TRANSACTION - EXH3 - CREDIT LETTER WRITER.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   2
* EL689.cbl
    14*
    15******************************************************************
    16
    17* W-FILE-USED REFERENCE LIST:
    18* (1)  ELCNTL - COMPANY
    19* (2)  ELCNTL - LIFE BENEFIT
    20* (3)  ELCNTL - A&H BENEFIT
    21* (4)  ELCNTL - CARRIER
    22* (5)  MAIL
    23* (6)  ERACCT
    24* (7)  USED FOR SYSTEM VARIABLES ?
    25* (8)  ELCERT
    26* (9)  PENDING BUSINESS
    27* (10) COMPENSATION
    28* (11) ELCNTL - PROCESSOR DATA ?
    29* (12) ERCHEK
    30* (13) ERPYAJ
    31* (14) NOT USED
    32* (15) NOT USED
    33* (16) NOT USED
    34* (17) NOT USED
    35* (18) NOT USED
    36* (19) NOT USED
    37* (20) NOT USED
    38*
    39******************************************************************
    40*                   C H A N G E   L O G
    41*
    42* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    43*-----------------------------------------------------------------
    44*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    45* EFFECTIVE    NUMBER
    46*-----------------------------------------------------------------
    47* 101501    2001100100006  SMVA  ADD USERID to screen header
    48*                                ADJUSTED REDEFINES EL689AI FILLER
    49* 031504    2004020600009  SMVA  PULL MOST CURRENT ACCT ADDRESS
    50* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
    51* 100705    2004072800003  PEMA  ADD NEW VARIABLES
    52* 072308    2008062700001  PEMA  ADD NEW VARIABLES
    53* 092908    2008013100006  PEMA  MOVE VAR 154
    54* 102408  CR2008091000001  PEMA  MOVE PNDB VARS TO CERT VARS
    55* 051209  CR2009021700003  PEMA  ADD CRED BENE VARIABLES
    56* 051209  CR2009042700002  PEMA  ADD ERACCT ACCT NUMBER VARIABLE
    57* 022510  IR2009062300003  PEMA  ADD ENDFILE TEST TO ERACCT READ
    58* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    59* 041811  CR2011010400001  PEMA  DISABLE PF8 FOR CERTAIN USERS
    60* 042011  CR2011010400001  PEMA  FIX CRED BENE ADDRESS LINES
    61* 061411  CR2011061300001  PEMA  ADD ALWA TO PF8 DISABLE LIST
    62* 092911  IR2011092900001  AJRA  CLEAR LABEL LINES BEFORE CRED BEN
    63* 022712  IR2012022700001  AJRA  DON'T COUNT &&&&&& IN LINES
    64* 122011  CR2011022800001  AJRA  NAPERSOFT
    65* 090612  IR2012090600001  AJRA  NAPERSOFT
    66* 091712  IR2012091400001  AJRA  NAPERSOFT CERT ID
    67* 091912  IR2012091900001  AJRA  ALLOW FOLLOW UP DATE TO = CURR DT
    68* 101812  CR2012101700002  AJRA  ADD ENDARCH AND SCREENID
    69* 110512  CR2012101700002  AJRA  EXIT LETTER WRITER AFTER PF7
    70* 120512  CR2012101700002  AJRA  ADD RE ENCL CODE
    71* 011013  CR2012101700002  AJRA  CHECK REQ REASON CODE IND
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   3
* EL689.cbl
    72* 012413  CR2013012100001  AJRA  ADD AUTO BILLING NOTE
    73* 121213  CR2013090300001  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    74* 123113  CR2013090300001  AJRA  USE NEXT BUS DT FOR RESEND DT CAL
    75* 010814  CR2013090300001  AJRA  CALL SQL STORED PROC FOR NEXT BUS
    76* 021214  IR2014021200002  AJRA  ADD SQL DISCONNECT
    77* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    78* 062017  CR2015091000001  PEMA  ADD PROCESSING FOR TN REF INTERES
    79* 041320  CR2020030500002  PEMA  Issue, cancel billing notes
    80******************************************************************
    81
    82 DATA DIVISION.
    83 WORKING-STORAGE SECTION.
    84 01  DFH-START PIC X(04).
    85 77  LCP-WS-ADDR-COMP              PIC x(4) comp-5 value 0.
    86 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    87                                   USAGE POINTER.
    88 77  FILLER  PIC X(32) VALUE '********************************'.
    89 77  FILLER  PIC X(32) VALUE '*    EL689 WORKING STORAGE     *'.
    90 77  FILLER  PIC X(32) VALUE '*********** VMOD=2.037 *********'.
    91
*   92 EXEC SQL
*   93    INCLUDE SQLDA
*   94 END-EXEC
    95 01 SQLDA sync.
    96    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
    97    05 SQLDABC               PIC S9(9) COMP-5 value 0.
    98    05 SQLN                  PIC S9(4) COMP-5 value 0.
    99    05 SQLD                  PIC S9(4) COMP-5 value 0.
   100    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   101       10 SQLTYPE            PIC S9(4) COMP-5.
   102       10 SQLLEN             PIC S9(4) COMP-5.
   103$IF P64 SET
   104X      *> For 64-bit environments, ensure that SQLDATA is
   105X      *> aligned on an 8-byte boundary.
   106X      10 FILLER             PIC S9(9) COMP-5.
   107$END
   108       10 SQLDATA            USAGE POINTER.
   109       10 SQLIND             USAGE POINTER.
   110       10 SQLNAME.
   111          15 SQLNAMEL        PIC S9(4) COMP-5.
   112          15 SQLNAMEC        PIC X(30).
   113
   114* Values for SQLTYPE
   115
   116 78  ESQL-DATE-CHAR              VALUE 384.
   117 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   118 78  ESQL-DATE-REC               VALUE 386.
   119 78  ESQL-DATE-REC-NULL          VALUE 387.
   120 78  ESQL-TIME-CHAR              VALUE 388.
   121 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   122 78  ESQL-TIME-REC               VALUE 390.
   123 78  ESQL-TIME-REC-NULL          VALUE 391.
   124 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   125 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   126 78  ESQL-TIMESTAMP-REC          VALUE 394.
   127 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   128 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   129 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   4
* EL689.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-TS-OFFSET-REC          VALUE 398.
   131 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   132 78  ESQL-LONGVARBINARY          VALUE 404.
   133 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   134 78  ESQL-LONGVARCHAR            VALUE 408.
   135 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   136 78  ESQL-BINARY                 VALUE 444.
   137 78  ESQL-BINARY-NULL            VALUE 445.
   138 78  ESQL-VARBINARY              VALUE 446.
   139 78  ESQL-VARBINARY-NULL         VALUE 447.
   140 78  ESQL-VARCHAR                VALUE 448.
   141 78  ESQL-VARCHAR-NULL           VALUE 449.
   142
   143 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   144 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   145
   146 78  ESQL-CHAR                   VALUE 452.
   147 78  ESQL-CHAR-NULL              VALUE 453.
   148
   149 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   150 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   151
   152 78  ESQL-DOUBLE                 VALUE 480.
   153 78  ESQL-DOUBLE-NULL            VALUE 481.
   154 78  ESQL-REAL                   VALUE 482.
   155 78  ESQL-REAL-NULL              VALUE 483.
   156 78  ESQL-DECIMAL                VALUE 484.
   157 78  ESQL-DECIMAL-NULL           VALUE 485.
   158 78  ESQL-INTEGER                VALUE 496.
   159 78  ESQL-INTEGER-NULL           VALUE 497.
   160 78  ESQL-SMALLINT               VALUE 500.
   161 78  ESQL-SMALLINT-NULL          VALUE 501.
   162 78  ESQL-TINYINT                VALUE 502.
   163 78  ESQL-TINYINT-NULL           VALUE 503.
   164
*  165 EXEC SQL
*  166    INCLUDE SQLCA
*  167 END-EXEC
   168 01 SQLCA.
   169     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   170     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   171     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   172     05  SQLERRM.
   173         49  SQLERRML    PIC S9(4) COMP-5.
   174         49  SQLERRMC    PIC X(70).
   175     05  SQLERRP         PIC X(8).
   176     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   177     05  SQLWARN.
   178         10  SQLWARN0    PIC X.
   179         10  SQLWARN1    PIC X.
   180         10  SQLWARN2    PIC X.
   181         10  SQLWARN3    PIC X.
   182         10  SQLWARN4    PIC X.
   183         10  SQLWARN5    PIC X.
   184         10  SQLWARN6    PIC X.
   185         10  SQLWARN7    PIC X.
   186     05  SQLEXT.
   187         10  SQLWARN8    PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   5
* EL689.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         10  SQLWARN9    PIC X.
   189         10  SQLWARN10   PIC X.
   190         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   191     05  SQLSTATE    PIC X(5).
   192
   193 EXEC SQL
   194    BEGIN DECLARE SECTION
   195 END-EXEC
   196
   197 01  SQLCMD                      PIC X(1024).
   198 01  SVR                         PIC X(32).
   199 01  USR                         PIC X(32).
   200 01  PASS                        PIC X(32).
   201 01  USR-PASS                    PIC X(64).
   202
   203 01  WS-SQL-DATA.
   204     05  WS-CYCLE-DATE           PIC X(10).
   205     05  WS-NEXT-BUS-DT          PIC X(10).
   206
   207 EXEC SQL
   208    END DECLARE SECTION
   209 END-EXEC
   210
   211 01  P pointer.
   212 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
   213 01  KIXHOST             pic x(9) value Z"HOSTNAME".
   214 01  var-ptr pointer.
   215 01  env-var-len                 pic 9(4)  binary.
   216 01  rc                          pic 9(9)  binary.
   217 01  WS-KIXHOST                  PIC X(10).
   218 01  WS-KIXSYS.
   219     05  WS-KIX-FIL1             PIC X(10).
   220     05  WS-KIX-APPS             PIC X(10).
   221     05  WS-KIX-ENV              PIC X(10).
   222     05  WS-KIX-MYENV            PIC X(10).
   223     05  WS-KIX-SYS              PIC X(10).
   224 01 srch-commarea.
   225*                                copy ELCADLTRSPI.
   226******************************************************************
   227*                   C H A N G E   L O G
   228*
   229* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   230*-----------------------------------------------------------------
   231*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   232* EFFECTIVE    NUMBER
   233*-----------------------------------------------------------------
   234* 060611    2011022800001  PEMA  NEW COPYBOOK
   235* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   236* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   237******************************************************************
   238****************************************
   239*  commarea for NaperSoft On Demand Admin services letters
   240*  (business logic input & output)
   241****************************************
   242     03  BL-INPUT.
   243         05  BL-DATA-SRCE        PIC X.
   244         05  BL-LETTER-ID        PIC XXXX.
   245         05  BL-CARRIER          PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   6
* EL689.cbl
   246         05  BL-GROUP            PIC X(6).
   247         05  BL-STATE            PIC XX.
   248         05  BL-ACCOUNT          PIC X(10).
   249         05  BL-EFF-DT           PIC X(10).
   250         05  BL-CERT-NO          PIC X(11).
   251         05  BL-BATCH-NO         PIC X(6).
   252         05  BL-BATCH-SEQ        PIC 9(8).
   253         05  BL-RESP-NO          PIC X(10).
   254         05  BL-NO-OF-COPIES     PIC 99.
   255         05  BL-PROC-ID          PIC XXXX.
   256         05  BL-COMP-ID          PIC XXX.
   257         05  BL-PRINT-NOW-SW     PIC X.
   258         05  BL-ENC-CD           PIC XXX.
   259         05  BL-RESEND-DT        PIC X(10).
   260         05  BL-FOLLOW-UP-DT     PIC X(10).
   261         05  BL-ARCHIVE-NO       PIC 9(8).
   262         05  BL-FUNC             PIC X(8).
   263         05  BL-COMMENTS         PIC X(100).
   264         05  FILLER REDEFINES BL-COMMENTS.
   265             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   266             10  BL-LETTER-TO-ACCT PIC X.
   267             10  BL-LETTER-TO-BENE PIC X.
   268             10  BL-WRITE-ERARCH   PIC X.
   269                 88  ERARCH-QWS      VALUE 'Q'.
   270                 88  ERARCH-BATCH    VALUE 'B'.
   271                 88  ERARCH-TEMP     VALUE 'T'.
   272             10  BL-PROCESS-TYPE PIC X(07).
   273             10  BL-CERT-FORM-ID PIC X(05).
   274             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   275             10  BL-SOURCE-SCREEN PIC X(8).
   276             10  FILLER          PIC X(25).
   277     03  BL-OUTPUT.
   278         05  BL-STATUS                   PIC X.
   279             88  BL-OK                      VALUE "P".
   280             88  BL-FAIL                  VALUE "F".
   281         05  BL-MESSAGE          PIC X(50).
   282     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   283     03  FILLER                  PIC X(31).
   284 01  W-WORK-AREAS.
   285     12  FILLER                  PIC  X(18)
   286                                      VALUE 'PROGRAM WORK AREA:'.
   287
   288     12  W-ASKTIME-CTR           PIC S9(04)  COMP   VALUE +0.
   289     12  W-CWA-NDX               PIC S9(04)  COMP   VALUE +0.
   290     12  W-DISPLAY-NDX           PIC S9(04)  COMP   VALUE +0.
   291     12  W-FIRST-BAD-VARIABLE    PIC S9(04)  COMP   VALUE +0.
   292     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
   293     12  W-NDX2                  PIC S9(04)  COMP   VALUE +0.
   294     12  W-SEQ-CTR               PIC S9(04)  COMP   VALUE +0.
   295     12  W-TS-ITEM               PIC S9(04)  COMP   VALUE +0.
   296     12  W-TOTAL-LINE-LENGTH     PIC S9(04)  COMP   VALUE +0.
   297     12  W-WORK-NDX              PIC S9(04)  COMP   VALUE +0.
   298
   299     12  W-ADJUST-SHORT          PIC S9(03) VALUE +0   COMP-3.
   300     12  W-DIFFERENCE            PIC S9(07)V9(02)
   301                                            VALUE +0   COMP-3.
   302     12  W-INITIAL-COLUMN        PIC S9(03) VALUE +0   COMP-3.
   303     12  W-LAST-COLUMN           PIC S9(03) VALUE +70 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   7
* EL689.cbl
   304     12  W-LAST-SQUEEZED-SPACE   PIC S9(03) VALUE +0   COMP-3.
   305     12  W-LAST-TX-SPACE         PIC S9(03) VALUE +0   COMP-3.
   306     12  W-LAST-WC-SPACE         PIC S9(03) VALUE +0   COMP-3.
   307     12  W-LINE-COUNT            PIC S9(03) VALUE +0   COMP-3.
   308     12  W-LINE-INDENT-1         PIC  9(02) VALUE 0    COMP-3.
   309     12  W-LINE-INDENT-2         PIC  9(02) VALUE 0    COMP-3.
   310     12  W-LINE-INDENT-3         PIC  9(02) VALUE 0    COMP-3.
   311     12  W-LINE-INDENT-4         PIC  9(02) VALUE 0    COMP-3.
   312     12  W-LINE-INDENT-5         PIC  9(02) VALUE 0    COMP-3.
   313     12  W-MAX-LINES-PER-PAGE    PIC  9(02) VALUE 56   COMP-3.
   314     12  W-NEXT-INDENT           PIC  9(02) VALUE 0    COMP-3.
   315     12  W-PAGE                  PIC S9(02) VALUE +0   COMP-3.
   316     12  W-PAGE-LINE             PIC S9(03) VALUE +0   COMP-3.
   317     12  W-PARAGRAPH-INDENT      PIC  9(02) VALUE 0    COMP-3.
   318     12  W-ROLL-COUNTER          PIC S9(03) VALUE +0   COMP-3.
   319     12  W-START-COLUMN          PIC S9(03) VALUE +1   COMP-3.
   320     12  W-TEMP-CURRENT-LINE     PIC S9(03) VALUE +0   COMP-3.
   321     12  W-TOO-FAR               PIC S9(03) VALUE +71 COMP-3.
   322     12  W-TOP-MARGIN            PIC  9(02) VALUE 0    COMP-3.
   323     12  W-TOTAL-TX-LINES        PIC S9(03) VALUE +0   COMP-3.
   324     12  W-TS-GROUP-WORK         PIC  9(05) VALUE 0    COMP-3.
   325     12  W-WORK-INDENT           PIC  9(02) VALUE 0    COMP-3.
   326     12  W-WORK-AMOUNT           PIC S9(09)V9(02)
   327                                            VALUE +0   COMP-3.
   328
   329     12  W-DATA-SOURCE           PIC  9(01) VALUE 0.
   330     12  W-LABEL-SOURCE          PIC  9(01) value 0.
   331         88  W-LABEL-SOURCE-VALID           VALUE 1 THRU 7.
   332     12  W-LABEL-JOINT-NAME      PIC  X(30) VALUE SPACES.
   333     12  W-LAST-ERROR            PIC  9(04) VALUE 9999.
   334     12  W-NUMB-LABEL-LINES      PIC  9(01) VALUE 0.
   335     12  W-PRINT-CONTROL         PIC  9(02) VALUE 0.
   336     12  W-SAVE-REVISION         PIC  9(03) value 0.
   337     12  W-DISPLAY-3             PIC  9(03) value 0.
   338     12  W-DISPLAY-8             PIC  9(08) value 0.
   339     12  W-DISPLAY-7             PIC  9(07) value 0.
   340     12  W-EDIT-2-5-S            PIC  Z9.9(05).
   341     12  W-EDIT-3-0              PIC  ZZ9.
   342     12  W-EDIT-7-2              PIC  $$,$$$,$$9.99.
   343     12  W-EDIT-7-2-NEGATIVE     PIC  $$,$$$,$$9.99-.
   344     12  W-EDIT-9-2              PIC  $$$$,$$$,$$9.99.
   345     12  W-EDIT-12-2             PIC  $$$$,$$$,$$$,$$9.99.
   346
   347     12  WS-ACCT-PKEY-MATCH-SW   PIC  X(01) VALUE SPACE.
   348         88  PRIOR-MATCH-ACCT-PKEY          VALUE 'Y'.
   349
   350     12  W-ARCH-SUPPRESS         PIC 99999999.
   351     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   352                                 PIC  X(08).
   353     12  W-COMP-WORK-AREA.
   354         16  W-CWA-CHAR OCCURS 10 TIMES
   355                                 PIC  X(01).
   356     12  W-INCOMING-ARCHIVE      PIC  X(08).
   357     12  W-INCOMING-ARCH-NO REDEFINES W-INCOMING-ARCHIVE
   358                                 PIC  9(08).
   359
   360     12  W-BATCH-BREAKDOWN.
   361         16  W-BATCH-CONTROL     PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   8
* EL689.cbl
   362         16  W-BATCH-SEQ         PIC S9(04) COMP.
   363     12  W-BEN-HOLD              PIC  X(02).
   364     12  W-BENEFIT-WORK          PIC  X(03).
   365     12  W-BEN-R REDEFINES W-BENEFIT-WORK.
   366         16  W-ELIM-DAYS         PIC  X(02).
   367         16  FILLER              PIC  X(01).
   368     12  W-CALL-PGM              PIC  X(08).
   369     12  W-CURRENT-SAVE          PIC  X(02) VALUE SPACES.
   370
   371     12  FILLER                  PIC  X(09) VALUE 'LINE CNTL'.
   372     12  W-LINE-CONTROL-RECORD.
   373         16  W-LC-LINE-WIDTH     PIC  9(02).
   374         16  FILLER              PIC  X(01).
   375         16  W-LC-PARAGRAPH-INDENT
   376                                 PIC  9(02).
   377         16  FILLER              PIC  X(01).
   378         16  W-LC-MAX-LINES-PER-PAGE
   379                                 PIC  9(02).
   380         16  FILLER              PIC  X(01).
   381         16  W-LC-LINE-ADJUST    PIC  9(02).
   382         16  FILLER              PIC  X(01).
   383         16  W-LC-LINE-INDENT-1  PIC  9(02).
   384         16  FILLER              PIC  X(01).
   385         16  W-LC-LINE-INDENT-2  PIC  9(02).
   386         16  FILLER              PIC  X(01).
   387         16  W-LC-LINE-INDENT-3  PIC  9(02).
   388         16  FILLER              PIC  X(01).
   389         16  W-LC-LINE-INDENT-4  PIC  9(02).
   390         16  FILLER              PIC  X(01).
   391         16  W-LC-LINE-INDENT-5  PIC  9(02).
   392         16  FILLER              PIC  X(01).
   393         16  W-LC-TOP-MARGIN     PIC  9(02).
   394         16  FILLER              PIC  X(01).
   395         16  W-LC-CASE-IND       PIC  X(01).
   396             88  W-LC-USE-BOTH-CASES        VALUE 'Y'.
   397         16  FILLER              PIC  X(01).
   398         16  W-LC-PAGE-IND       PIC  X(01).
   399             88  W-LC-CREATE-PAGES          VALUE 'Y'.
   400     12  W-DATE-WORK             PIC  9(07).
   401     12  W-DT-REDEF REDEFINES W-DATE-WORK.
   402         16  FILLER              PIC  X(02).
   403         16  W-DT-WORK           PIC  9(05).
   404
   405     12  W-DEEDIT-FIELD          PIC  X(15).
   406     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD PIC S9(15).
   407
   408     12  W-EDIT-DATE-1.
   409         16  W-ED1-MM            PIC  X(02).
   410         16  FILLER              PIC  X(01) VALUE '/'.
   411         16  W-ED1-DD            PIC  X(02).
   412         16  FILLER              PIC  X(01) VALUE '/'.
   413         16  W-ED1-YY            PIC  X(02).
   414
   415     12  W-EDIT-DATE-2.
   416         16  W-ED2-DD            PIC  X(02).
   417         16  FILLER              PIC  X(01) VALUE '/'.
   418         16  W-ED2-MM            PIC  X(02).
   419         16  FILLER              PIC  X(01) VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   9
* EL689.cbl
   420         16  W-ED2-YY            PIC  X(02).
   421
   422     12  W-EDIT-A-DATE.
   423         16  W-EDIT-A-MM                  PIC X(2).
   424         16  FILLER                       PIC X(1).
   425         16  W-EDIT-A-DD                  PIC X(2).
   426         16  FILLER                       PIC X(1).
   427         16  W-EDIT-A-CCYY.
   428             20  W-EDIT-A-CC              PIC X(2).
   429             20  W-EDIT-A-YY              PIC X(2).
   430
   431     12  W-LABEL-HOLD-AREA.
   432         16  W-LABEL-LINES OCCURS 6 TIMES.
   433             20  W-LABEL-ZIP.
   434                 24  W-LABEL-1ST-ZIP  PIC  X(05).
   435                 24  W-LABEL-DASH     PIC  X(01).
   436                 24  W-LABEL-2ND-ZIP  PIC  X(04).
   437             20  W-LAB-CAN-POSTAL-CODES REDEFINES W-LABEL-ZIP.
   438                 24  W-LAB-CAN-POSTAL-CD-1
   439                                      PIC  X(03).
   440                 24  W-LAB-CAN-DASH   PIC  X(01).
   441                 24  W-LAB-CAN-POSTAL-CD-2
   442                                      PIC  X(03).
   443                 24  W-LAB-CAN-FILLER PIC  X(03).
   444             20  FILLER               PIC  X(10).
   445             20  W-LAST-ZIP.
   446                 24  W-LAST-1ST-ZIP   PIC  X(05).
   447                 24  W-LABEL-DASH-LAST
   448                                      PIC  X(01).
   449                 24  W-LAST-2ND-ZIP   PIC  X(04).
   450             20  W-LAST-CAN-POSTAL-CODES REDEFINES W-LAST-ZIP.
   451                 24  W-LAST-CAN-POSTAL-CD-1
   452                                      PIC  X(03).
   453                 24  W-LAST-CAN-DASH  PIC  X(01).
   454                 24  W-LAST-CAN-POSTAL-CD-2
   455                                      PIC  X(03).
   456                 24  W-LAST-CAN-FILLER
   457                                      PIC  X(03).
   458
   459     12  W-LAST-CHAR             PIC  X(01).
   460         88  W-LAST-CHAR-PUNC    VALUE '-' '/'.
   461     12  W-LAST-SQ-CHAR          PIC  X(01).
   462
   463     12  W-LINE-NUM.
   464         16  W-LINE1             PIC  X(01).
   465         16  W-LINE23            PIC  9(02).
   466     12  W-LIN-NUM REDEFINES W-LINE-NUM
   467                                 PIC  9(03).
   468
   469     12  W-NAME-LAST             PIC  X(15).
   470     12  W-NAME-FIRST.
   471         16  W-NAME-FIRST-INIT   PIC  X(01).
   472         16  W-NAME-FIRST-REMAIN PIC  X(14).
   473     12  W-NAME-MIDDLE.
   474         16  FILLER              PIC  X(01).
   475         16  W-NAME-MIDDLE-2     PIC  X(01).
   476         16  FILLER              PIC  X(13).
   477
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  10
* EL689.cbl
   478     12  W-PAGE-PRT.
   479         16  FILLER              PIC  X(34) VALUE SPACES.
   480         16  W-PAGE-NUMBER       PIC  Z9.
   481         16  FILLER              PIC  X(01) VALUE '.'.
   482         16  FILLER              PIC  X(33) VALUE SPACES.
   483
   484     12  W-PHONE-IN              PIC  9(11) VALUE ZEROS.
   485     12  W-PHONE-IN-R   REDEFINES W-PHONE-IN.
   486         16  FILLER              PIC  9(01).
   487         16  W-PHI-AREA          PIC  9(03).
   488         16  W-PHI-PFX           PIC  9(03).
   489         16  W-PHI-SFX           PIC  9(04).
   490     12  W-PHONE-OUT.
   491         16  W-PO-AREA           PIC  X(03).
   492         16  FILLER              PIC  X(01) VALUE '-'.
   493         16  W-PO-PFX            PIC  X(03).
   494         16  FILLER              PIC  X(01) VALUE '-'.
   495         16  W-PO-SFX            PIC  X(04).
   496
   497     12  W-SAVE-BIN-DATE         PIC  X(02) VALUE SPACES.
   498     12  W-SAVE-BIN-NEXT-BUS-DT  PIC  X(02) VALUE SPACES.
   499     12  W-SAVE-NEXT-BUS-DT-EDIT-A PIC X(10)   VALUE SPACES.
   500     12  W-SAVE-CYCLE-DAY-OF-WEEK PIC S9   COMP-3 VALUE +0.
   501     12  W-SAVE-EDIT-A-DATE      PIC  X(10) VALUE SPACES.
   502     12  W-SAVE-DATE             PIC  X(08) VALUE SPACES.
   503     12  W-SAVE-PLAN             PIC  X(02) VALUE SPACES.
   504
   505     12  W-SINGLE-LINE           PIC  X(70).
   506     12  W-SINGLE-LINE-BY REDEFINES W-SINGLE-LINE.
   507         16  ONE-CHAR OCCURS 70 TIMES INDEXED BY NDX1 NDX2 NDXA
   508                                 PIC  X(01).
   509
   510     12  W-SQUEEZED-LINE.
   511         16  W-SQ-CHAR OCCURS 70 TIMES
   512                       INDEXED BY W-SQ-NDX
   513                                 PIC  X(01).
   514
   515     12  W-TIME-IN               PIC S9(07).
   516     12  W-TIME-OUT-R REDEFINES W-TIME-IN.
   517         16  FILLER              PIC  X(01).
   518         16  W-TIME-OUT          PIC  99V9(02).
   519         16  FILLER              PIC  X(02).
   520
   521     12  W-TS-NAME-TEXT.
   522         16  W-TS-ID-TEXT        PIC  X(04) VALUE '104A'.
   523         16  W-TS-ID-TIME
   524             REDEFINES W-TS-ID-TEXT
   525                                 PIC S9(07) COMP-3.
   526         16  W-TS-TERM-TEXT.
   527             20 W-TS-TERM-PREFIX PIC  X(02).
   528             20 FILLER           PIC  X(02).
   529     12  W-TS-NAME-SCREEN.
   530         16  FILLER              PIC  X(04) VALUE '689X'.
   531         16  W-TS-TERM-SCREEN    PIC  X(04).
   532
   533     12  W-WORK-LINE.
   534         16  W-WORK-CHAR OCCURS 70 TIMES
   535                       INDEXED BY W-WC-NDX
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  11
* EL689.cbl
   536                                  W-WC-NDX2
   537                                  W-WC-NDX3
   538                                 PIC  X(01).
   539
   540     12  W-WORK-ZIP-NUMERIC      PIC  9(09).
   541     12  W-WORK-ZIP REDEFINES W-WORK-ZIP-NUMERIC.
   542         16  W-WORK-ZIP5         PIC  X(05).
   543         16  W-WORK-ZIP4         PIC  X(04).
   544     12  W-CANADIAN-POSTAL-CODES REDEFINES W-WORK-ZIP-NUMERIC.
   545         16  W-CAN-POSTAL-CD-1.
   546             20  FILLER          PIC  X(01).
   547                 88 W-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
   548             20  FILLER          PIC  X(02).
   549         16  W-CAN-POSTAL-CD-2   PIC  X(03).
   550         16  W-FILLER            PIC  X(03).
   551
   552**** Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
   553*                   COPY ELCZREC.
   554******************************************************************
   555*                                                                *
   556*                                                                *
   557*                            ELCZREC.                            *
   558*                                                                *
   559*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   560*                                                                *
   561******************************************************************
   562*-----------------------------------------------------------------
   563*                   C H A N G E   L O G
   564*
   565* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   566*-----------------------------------------------------------------
   567*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   568* EFFECTIVE    NUMBER
   569*-----------------------------------------------------------------
   570* 122011    2011022800001  AJRA  NEW FILE
   571* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   572* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   573* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   574* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   575*-----------------------------------------------------------------
   576 01  W-Z-CONTROL-DATA.
   577     05  W-NUMBER-OF-COPIES      PIC  9.
   578     05  FILLER                  PIC  X.
   579     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   580     05  FILLER                  PIC  X.
   581     05  W-DAYS-TO-RESEND        PIC  999.
   582     05  FILLER                  PIC  X.
   583     05  W-FORM-TO-RESEND        PIC  X(4).
   584     05  W-ADD-BAR-CODE          PIC  X.
   585     05  W-PROMPT-LETTER         PIC  X.
   586     05  W-HAS-RETURN-ENV        PIC  X.
   587     05  W-ENCLOSURE-CD          PIC  XXX.
   588     05  W-SIG-FLAG-DEFAULT      PIC  X.
   589     05  W-AUTO-CLOSE-IND        PIC  X.
   590     05  FILLER                  PIC  X.
   591     05  W-LETTER-TO-BENE        PIC  X.
   592     05  FILLER                  PIC  X.
   593     05  W-LETTER-TO-ACCT        PIC  X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  12
* EL689.cbl
   594     05  FILLER                  PIC  X.
   595     05  W-LETTER-TYPE           PIC  X.
   596     05  FILLER                  PIC  X.
   597     05  W-PRINT-CERTIFICATE     PIC  X.
   598     05  FILLER                  PIC  X.
   599     05  W-REFUND-REQUIRED       PIC  X.
   600     05  FILLER                  PIC  X.
   601     05  W-ONBASE-CODE           PIC  XX.
   602     05  FILLER                  PIC  X.
   603     05  W-ACCT-SUMM             PIC  X.
   604     05  FILLER                  PIC  X.
   605     05  W-CSO-SUMM              PIC  X.
   606     05  FILLER                  PIC  X.
   607     05  W-REASONS-REQUIRED      PIC  X.
   608     05  FILLER                  PIC  X(29).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  13
* EL689.cbl
   610 01  W-SWITCH-INDICATORS-AREA.
   611     12  FILLER                  PIC  X(16)
   612                                      VALUE 'PROGRAM SWITCHS:'.
   613     12  W-ADDRESS-ONLY-SW       PIC  X(01) VALUE ' '.
   614         88  W-ADDRESS-ONLY      VALUE 'Y'.
   615         88  W-FULL-DATA         VALUE ' '.
   616     12  W-ACCT-BROWSE-STARTED-SW
   617                                 PIC  X(01) VALUE 'N'.
   618         88  W-ACCT-BROWSE-STARTED          VALUE 'Y'.
   619     12  W-ARCT-BROWSE-STARTED   PIC  X(01) VALUE 'N'.
   620     12  W-CERT-FOUND-SW         PIC  X(01) VALUE 'N'.
   621         88  W-CERT-FOUND                   VALUE 'Y'.
   622     12  W-CHARACTER-TYPE        PIC  X(01).
   623         88  W-END-OF-SENTENCE   VALUE '.' '?' '!'.
   624         88  W-PUNCTUATION       VALUE '.' '?' '!' ',' ';'.
   625         88  W-SPACE             VALUE ' '.
   626     12  W-COMP-BROWSE-SW        PIC  X(01) VALUE 'N'.
   627         88  W-COMP-BROWSE-STARTED          VALUE 'Y'.
   628     12  W-DATA-SHRINK-IND       PIC  X(01) VALUE SPACES.
   629         88  W-DATA-SHRINKING    VALUE 'Y'.
   630     12  W-END-OF-SENTENCE-IND   PIC  X(01) VALUE SPACES.
   631         88  W-END-OF-SENTENCE-WORKING      VALUE 'Y'.
   632     12  W-FIRST-BAD-VARIABLE-IND
   633                                 PIC  X(01) VALUE SPACES.
   634         88  W-FIRST-BAD-VARIABLE-FOUND     VALUE 'Y'.
   635     12  W-FIRST-CHAR-FOUND-IND  PIC  X(01) VALUE SPACES.
   636         88  W-FIRST-CHAR-FOUND             VALUE 'Y'.
   637         88  W-FIRST-CHAR-NOT-FOUND         VALUE SPACES.
   638     12  W-FORM-CHANGED-IND      PIC  X(01) VALUE SPACES.
   639         88  W-FORM-CHANGED                 VALUE 'Y'.
   640     12  W-FORM-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   641         88  W-FORM-SQUEEZE-ON              VALUE 'Y'.
   642         88  W-FORM-SQUEEZE-OFF             VALUE ' '.
   643     12  W-HOLD-IND              PIC  X(01) VALUE SPACES.
   644         88  W-HOLD-ON                      VALUE 'Y'.
   645         88  W-HOLD-OFF                     VALUE ' '.
   646     12  W-INDIVIDUAL-DATA-SW    PIC  X(01) VALUE ' '.
   647         88  W-INDIVIDUAL-DATA-COMPLETED    VALUE 'Y'.
   648         88  W-INDIV-DATA-NOT-COMPLETED     VALUE ' '.
   649     12  W-KEY-FIELDS-CHANGED-IND
   650                                 PIC  X(01) VALUE ' '.
   651         88  W-KEY-FIELDS-CHANGED           VALUE 'Y'.
   652         88  W-KEY-FIELDS-NOT-CHANGED       VALUE ' '.
   653     12  W-LAST-ONE              PIC  X(01) VALUE HIGH-VALUES.
   654         88  W-LAST-ONE-A-SPACE  VALUE ' '.
   655     12  W-LINE-SQUEEZE-IND      PIC  X(01) VALUE SPACES.
   656         88  W-NEW-PARAGRAPH                VALUE 'P' 'Q' 'R' 'S'
   657                                                   'T' 'U'.
   658         88  W-CONTINUE-PARAGRAPH           VALUE 'C' 'D' 'E' 'F'
   659                                                   'G' 'H'.
   660         88  W-FORM-CONTROL-LINE            VALUE 'K'.
   661         88  W-DO-NOT-ADJUST                VALUE 'N'.
   662         88  W-ADJUST-TO-LINE-LENGTH        VALUE 'A'.
   663         88  W-AS-IS                        VALUE 'A' 'N'.
   664         88  W-CONTINUE-PREVIOUS-PROCESS    VALUE ' ' '1' '2' '3'
   665                                                   '4' '5'.
   666
   667     12  W-PNDB-FOUND-SW         PIC  X(01) VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  14
* EL689.cbl
   668         88  W-PNDB-FOUND                   VALUE 'Y'.
   669     12  W-REMAINING-VAR-SW      PIC  X(01) VALUE SPACES.
   670         88  W-REMAINING-VAR-FOUND          VALUE 'Y'.
   671     12  W-REVERSE-DATE-SW       PIC  X(01) VALUE SPACES.
   672         88  W-REVERSE-DATE                 VALUE 'Y'.
   673     12  W-TEXT-BROWSED-SW       PIC  X(01) VALUE 'N'.
   674         88  W-TEXT-BROWSE-STARTED          VALUE 'Y'.
   675         88  W-TEXT-BROWSE-NOT-STARTED      VALUE 'N'.
   676
   677     12  W-VALID-ENDT-SW         PIC  X(01) VALUE 'N'.
   678         88  W-VALID-ENDT                   VALUE 'Y'.
   679     12  W-RESPONSE              PIC S9(8)   COMP.
   680         88  RESP-NORMAL                  VALUE +00.
   681         88  RESP-NOTFND                  VALUE +13.
   682         88  RESP-DUPREC                  VALUE +14.
   683         88  RESP-DUPKEY                  VALUE +15.
   684         88  RESP-NOTOPEN                 VALUE +19.
   685         88  RESP-ENDFILE                 VALUE +20.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  15
* EL689.cbl
   687 01  WS-SAVE-AREA.
   688     12  WS-SAV-AM-DEFN-1.
   689         16  WS-SAV-AM-AGT-COMMS OCCURS 10 TIMES.
   690             20  WS-SAV-AM-AGT             PIC  X(10).
   691             20  WS-SAV-AM-COM-TYP         PIC  X(01).
   692             20  FILLER                    PIC  X(15).
   693     12  WS-SAV-AM-REMIT-TO                PIC  9(02).
   694     12  WS-SAV-AM-CSR-CODE                PIC  X(04).
   695     12  WS-SAV-AM-CARRIER                 PIC  X(01).
   696     12  WS-SAV-AM-ACCOUNT                 PIC  X(10).
   697     12  WS-SAV-AM-CONTROL-NAME            PIC  X(30).
   698     12  WS-SAV-AM-NAME                    PIC  X(30).
   699     12  WS-SAV-AM-PERSON                  PIC  X(30).
   700     12  WS-SAV-AM-ADDRS                   PIC  X(30).
   701     12  WS-SAV-AM-CITY                    PIC  X(30).
   702     12  WS-SAV-AM-ERACCT-ACCOUNT          PIC  X(10).
   703     12  WS-SAV-AM-ZIP.
   704         16  WS-SAV-AM-ZIP-PRIME.
   705             20  WS-SAV-AM-ZIP-PRI-1ST     PIC  X(01).
   706                 88  SAVE-AM-CANADIAN-POST-CODE       VALUE
   707                     'A' THRU 'Z'.
   708             20  FILLER                    PIC  X(04).
   709         16  FILLER                        PIC  X(04).
   710     12  WS-SAV-AM-CANADIAN-POSTAL-CODE REDEFINES
   711                        WS-SAV-AM-ZIP      PIC  X(09).
   712     12  WS-SAV-AM-TEL-NO.
   713         16  WS-SAV-AM-AREA-CODE           PIC 9(03).
   714         16  WS-SAV-AM-TEL-PRE             PIC 9(03).
   715         16  WS-SAV-AM-TEL-NBR             PIC 9(04).
   716 01  W-KEY-AREAS.
   717     12  FILLER                    PIC  X(13)
   718                                      VALUE 'PROGRAM KEYS:'.
   719
   720     12  W-ACCT-SAVE-KEY           PIC  X(20).
   721     12  W-ACCT-KEY.
   722         16  W-ACCT-PARTIAL-KEY.
   723             20  W-ACCT-COMPANY-CD PIC  X(01).
   724             20  W-ACCT-CARRIER    PIC  X(01).
   725             20  W-ACCT-GROUPING   PIC  X(06).
   726             20  W-ACCT-STATE      PIC  X(02).
   727             20  W-ACCT-ACCOUNT    PIC  X(10).
   728         16  W-ACCT-EXP-DT         PIC  X(02).
   729
   730     12  W-ARCH-SAVE-KEY         PIC  X(05).
   731     12  W-ARCH-KEY.
   732         16  W-ARCH-PARTIAL-KEY.
   733             20  W-ARCH-COMPANY-CD
   734                                 PIC  X(01).
   735             20  W-ARCH-NUMBER   PIC S9(08)      COMP.
   736         16  W-ARCH-SEQ-NO       PIC S9(04)      COMP VALUE +0.
   737
   738     12  W-ARCT-KEY.
   739         16  W-ARCT-PARTIAL-KEY.
   740             20  W-ARCT-COMPANY-CD
   741                                 PIC  X(01).
   742             20  W-ARCT-NUMBER   PIC S9(08)      COMP.
   743         16  W-ARCT-REC-TYPE     PIC  X(01).
   744         16  W-ARCT-SEQ-NO       PIC S9(04)      COMP VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  16
* EL689.cbl
   745
   746     12  W-CERT-KEY.
   747         16  W-CERT-COMPANY-CD   PIC  X(01).
   748         16  W-CERT-CARRIER      PIC  X(01).
   749         16  W-CERT-GROUPING     PIC  X(06).
   750         16  W-CERT-STATE        PIC  X(02).
   751         16  W-CERT-ACCOUNT      PIC  X(10).
   752         16  W-CERT-EFF-DT       PIC  X(02).
   753         16  W-CERT-CERT-NO.
   754             20  W-CERT-CERT-PRIME
   755                                 PIC  X(10).
   756             20  W-CERT-CERT-SFX PIC  X(01).
   757
   758     12  W-CHEK-KEY.
   759         16  W-CHEK-COMPANY-CD   PIC  X(01).
   760         16  W-CHEK-CARRIER      PIC  X(01).
   761         16  W-CHEK-GROUPING     PIC  X(06).
   762         16  W-CHEK-STATE        PIC  X(02).
   763         16  W-CHEK-ACCOUNT      PIC  X(10).
   764         16  W-CHEK-EFF-DT       PIC  X(02).
   765         16  W-CHEK-CERT-NO.
   766             20  W-CHEK-CERT-PRIME
   767                                 PIC  X(10).
   768             20  W-CHEK-CERT-SFX PIC  X(01).
   769         16  W-CHEK-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   770
   771     12  W-CNTL-KEY.
   772         16  W-CNTL-COMPANY-ID   PIC  X(03).
   773         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   774         16  W-CNTL-GENL.
   775             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   776             20  W-CNTL-GEN2.
   777                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   778                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   779         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   780
   781     12  W-COMP-SAVE-KEY         PIC  X(29).
   782     12  W-COMP-KEY.
   783         16  W-COMP-COMPANY-CD   PIC  X(01).
   784         16  W-COMP-CARRIER      PIC  X(01).
   785         16  W-COMP-GROUPING     PIC  X(06).
   786         16  W-COMP-RESP-PERSON.
   787             20  W-COMP-RP-CHAR OCCURS 10 TIMES
   788                                INDEXED BY W-COMP-NDX
   789                                 PIC  X(01).
   790         16  W-COMP-ACCOUNT      PIC  X(10).
   791         16  W-COMP-TYPE         PIC  X(01).
   792
   793     12  W-DELETE-KEY.
   794         16  W-DELETE-PARTIAL-KEY.
   795             20  W-DELETE-COMPANY-CD
   796                                 PIC  X(01).
   797             20  W-DELETE-NUMBER PIC S9(08)      COMP.
   798         16  W-DELETE-RECORD-TYPE
   799                                 PIC  X(01).
   800         16  W-DELETE-SEQ        PIC S9(04)      COMP VALUE +0.
   801
   802     12  W-MAIL-KEY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  17
* EL689.cbl
   803         16  W-MAIL-COMPANY-CD   PIC  X(01).
   804         16  W-MAIL-CARRIER      PIC  X(01).
   805         16  W-MAIL-GROUPING     PIC  X(06).
   806         16  W-MAIL-STATE        PIC  X(02).
   807         16  W-MAIL-ACCOUNT      PIC  X(10).
   808         16  W-MAIL-EFF-DT       PIC  X(02).
   809         16  W-MAIL-CERT-NO.
   810             20  W-MAIL-CERT-PRIME
   811                                 PIC  X(10).
   812             20  W-MAIL-CERT-SFX PIC  X(01).
   813
   814     12  W-PNDB-KEY.
   815         16  W-PNDB-COMPANY-CD   PIC  X(01).
   816         16  W-PNDB-ENTRY        PIC  X(06).
   817         16  W-PNDB-SEQ-NO       PIC S9(04)  COMP.
   818         16  W-PNDB-CHG-SEQ-NO   PIC S9(04)  COMP.
   819
   820     12  W-PNDB2-KEY.
   821         16  W-PNDB2-COMPANY-CD  PIC  X(01).
   822         16  W-PNDB2-CARRIER     PIC  X(01).
   823         16  W-PNDB2-GROUPING    PIC  X(06).
   824         16  W-PNDB2-STATE       PIC  X(02).
   825         16  W-PNDB2-ACCOUNT     PIC  X(10).
   826         16  W-PNDB2-EFF-DT      PIC  X(02).
   827         16  W-PNDB2-CERT-NO.
   828             20  W-PNDB2-CERT-PRIME
   829                                 PIC  X(10).
   830             20  W-PNDB2-CERT-SFX
   831                                 PIC  X(01).
   832         16  W-PNDB2-ALT-CHG-SEQ-NO
   833                                 PIC S9(04)  COMP.
   834         16  W-PNDB2-TYPE        PIC  X(01).
   835
   836     12  W-PYAJ-KEY.
   837         16  W-PYAJ-COMPANY-CD   PIC  X(01).
   838         16  W-PYAJ-CARRIER      PIC  X(01).
   839         16  W-PYAJ-GROUPING     PIC  X(06).
   840         16  W-PYAJ-FIN-RESP     PIC  X(10).
   841         16  W-PYAJ-ACCOUNT      PIC  X(10).
   842         16  W-PYAJ-FILE-SEQ-NO  PIC S9(08)    COMP.
   843         16  W-PYAJ-RECORD-TYPE  PIC  X(01).
   844
   845     12  W-SC-QUID-KEY.
   846         16  W-SC-QUID-TERMINAL  PIC  X(04).
   847         16  W-SC-QUID-SYSTEM    PIC  X(04).
   848
   849     12  W-TEXT-SAVE-KEY         PIC  X(05).
   850     12  W-TEXT-KEY.
   851         16  W-TEXT-PARTIAL-KEY.
   852             20  W-TEXT-COMPANY-CD
   853                                 PIC  X(01).
   854             20  W-TEXT-LETTER   PIC  X(04).
   855         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
   856         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
   857
   858     12  W-ERENDT-KEY-BY-ARCH.
   859         16  W-ERENDT-COMPANY-CD-A1 PIC X.
   860         16  W-ERENDT-ARCHIVE       PIC 9(8) BINARY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  18
* EL689.cbl
   861
   862     12  W-ELEOBC-KEY.
   863         16  W-EOBC-COMPANY-CD   PIC X.
   864         16  W-EOBC-REC-TYPE     PIC X.
   865         16  W-EOBC-CODE         PIC X(4).
   866         16  FILLER              PIC X(9).
   867     12  W-ERNOTE-KEY.
   868         16  W-NOTE-COMPANY-CD   PIC X.
   869         16  W-NOTE-CARRIER      PIC X.
   870         16  W-NOTE-GROUPING     PIC X(6).
   871         16  W-NOTE-STATE        PIC XX.
   872         16  W-NOTE-ACCOUNT      PIC X(10).
   873         16  W-NOTE-CERT-EFF-DT  PIC XX.
   874         16  W-NOTE-CERT-PRIME   PIC X(10).
   875         16  W-NOTE-CERT-SFX     PIC X.
   876         16  w-note-record-type  pic x.
   877     12  W-SAVE-KEY.
   878         16  W-SV-COMPANY-CD     PIC X.
   879         16  W-SV-CARRIER        PIC X.
   880         16  W-SV-GROUPING       PIC X(6).
   881         16  W-SV-STATE          PIC XX.
   882         16  W-SV-ACCOUNT        PIC X(10).
   883         16  W-SV-CERT-EFF-DT    PIC XX.
   884         16  W-SV-CERT-PRIME     PIC X(10).
   885         16  W-SV-CERT-SFX       PIC X.
   886     12  W-BILLING-NOTE.
   887         16  W-BN-NOTE           PIC X(25).
   888         16  W-BN-LTRID          PIC X(4).
   889         16  FILLER              PIC X(3).
   890         16  W-BN-DATE           PIC X(8).
   891         16  FILLER              PIC X(3).
   892         16  W-BN-USERID         PIC X(4).
   893         16  FILLER              PIC X(30).
   894     12  W-LEN                   PIC S9(5) COMP-3 VALUE +0.
   895     12  NOTE-SUB                PIC S9(5) COMP-3 VALUE +0.
   896     12  W-CERT-UPDATE-SW        PIC X  VALUE ' '.
   897         88  NO-CERT-RW                 VALUE 'N'.
   898         88  CERT-RW                    VALUE 'Y'.
   899
   900     12  W-ELENCC-KEY.
   901         16  W-ENCC-COMPANY-CD   PIC X.
   902         16  W-ENCC-REC-TYPE     PIC X.
   903         16  W-ENCC-ENC-CODE     PIC X(5).
   904         16  FILLER              PIC X(09).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  19
* EL689.cbl
   906 01  FILLER                      PIC  X(22)
   907                                 VALUE 'INTERFACE AREA STARTS:'.
   908*    COPY ELCINTF.
   909******************************************************************
   910*                                                                *
   911*                                                                *
   912*                            ELCINTF.                            *
   913*                            VMOD=2.017                          *
   914*                                                                *
   915*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   916*                                                                *
   917*       LENGTH = 1024                                            *
   918*                                                                *
   919******************************************************************
   920*                   C H A N G E   L O G
   921*
   922* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   923*-----------------------------------------------------------------
   924*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   925* EFFECTIVE    NUMBER
   926*-----------------------------------------------------------------
   927* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   928******************************************************************
   929 01  PROGRAM-INTERFACE-BLOCK.
   930     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   931     12  PI-CALLING-PROGRAM              PIC X(8).
   932     12  PI-SAVED-PROGRAM-1              PIC X(8).
   933     12  PI-SAVED-PROGRAM-2              PIC X(8).
   934     12  PI-SAVED-PROGRAM-3              PIC X(8).
   935     12  PI-SAVED-PROGRAM-4              PIC X(8).
   936     12  PI-SAVED-PROGRAM-5              PIC X(8).
   937     12  PI-SAVED-PROGRAM-6              PIC X(8).
   938     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   939     12  PI-COMPANY-ID                   PIC XXX.
   940     12  PI-COMPANY-CD                   PIC X.
   941
   942     12  PI-COMPANY-PASSWORD             PIC X(8).
   943
   944     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   945
   946     12  PI-CONTROL-IN-PROGRESS.
   947         16  PI-CARRIER                  PIC X.
   948         16  PI-GROUPING                 PIC X(6).
   949         16  PI-STATE                    PIC XX.
   950         16  PI-ACCOUNT                  PIC X(10).
   951         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   952                                         PIC X(10).
   953         16  PI-CLAIM-CERT-GRP.
   954             20  PI-CLAIM-NO             PIC X(7).
   955             20  PI-CERT-NO.
   956                 25  PI-CERT-PRIME       PIC X(10).
   957                 25  PI-CERT-SFX         PIC X.
   958             20  PI-CERT-EFF-DT          PIC XX.
   959         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   960             20  PI-PLAN-CODE            PIC X(2).
   961             20  PI-REVISION-NUMBER      PIC X(3).
   962             20  PI-PLAN-EFF-DT          PIC X(2).
   963             20  PI-PLAN-EXP-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  20
* EL689.cbl
   964             20  FILLER                  PIC X(11).
   965         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   966             20  PI-OE-REFERENCE-1.
   967                 25  PI-OE-REF-1-PRIME   PIC X(18).
   968                 25  PI-OE-REF-1-SUFF    PIC XX.
   969
   970     12  PI-SESSION-IN-PROGRESS          PIC X.
   971         88  CLAIM-SESSION                   VALUE '1'.
   972         88  CREDIT-SESSION                  VALUE '2'.
   973         88  WARRANTY-SESSION                VALUE '3'.
   974         88  MORTGAGE-SESSION                VALUE '4'.
   975         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   976
   977
   978*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   979
   980     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   981     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   982
   983     12  PI-CREDIT-USER                  PIC X.
   984         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   985         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   986
   987     12  PI-CLAIM-USER                   PIC X.
   988         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   989         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   990
   991     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   992         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   993         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   994         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   995         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   996         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   997
   998     12  PI-PROCESSOR-ID                 PIC X(4).
   999
  1000     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1001
  1002     12  PI-MEMBER-CAPTION               PIC X(10).
  1003
  1004     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1005         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1006
  1007     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1008     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1009     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1010     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1011
  1012     12  PI-AH-OVERRIDE-L1               PIC X.
  1013     12  PI-AH-OVERRIDE-L2               PIC XX.
  1014     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1015     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1016
  1017     12  PI-NEW-SYSTEM                   PIC X(2).
  1018
  1019     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1020     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1021         88  PI-USES-PAID-TO                 VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  21
* EL689.cbl
  1022     12  PI-CRDTCRD-SYSTEM.
  1023         16  PI-CRDTCRD-USER             PIC X.
  1024             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1025             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1026         16  PI-CC-MONTH-END-DT          PIC XX.
  1027     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1028
  1029     12  PI-OE-REFERENCE-2.
  1030         16  PI-OE-REF-2-PRIME           PIC X(10).
  1031         16  PI-OE-REF-2-SUFF            PIC X.
  1032
  1033     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1034
  1035     12  PI-LANGUAGE-TYPE                PIC X.
  1036             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1037             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1038             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1039
  1040     12  PI-POLICY-LINKAGE-IND           PIC X.
  1041         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1042         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1043                                                   LOW-VALUES.
  1044
  1045     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1046     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1047         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1048         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1049
  1050     12  PI-PROCESSOR-CSR-IND            PIC X.
  1051         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1052         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1053
  1054     12  FILLER                          PIC X(3).
  1055
  1056     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1057
  1058     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1059         PI-SYSTEM-LEVEL.
  1060
  1061         16  PI-ENTRY-CODES.
  1062             20  PI-ENTRY-CD-1           PIC X.
  1063             20  PI-ENTRY-CD-2           PIC X.
  1064
  1065         16  PI-RETURN-CODES.
  1066             20  PI-RETURN-CD-1          PIC X.
  1067             20  PI-RETURN-CD-2          PIC X.
  1068
  1069         16  PI-UPDATE-STATUS-SAVE.
  1070             20  PI-UPDATE-BY            PIC X(4).
  1071             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1072
  1073         16  PI-LOWER-CASE-LETTERS       PIC X.
  1074             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1075
  1076*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1077*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1078*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1079
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  22
* EL689.cbl
  1080         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1081             88  ST-ACCNT-CNTL               VALUE ' '.
  1082             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1083             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1084             88  ACCNT-CNTL                  VALUE '3'.
  1085             88  CARR-ACCNT-CNTL             VALUE '4'.
  1086
  1087         16  PI-PROCESSOR-CAP-LIST.
  1088             20  PI-SYSTEM-CONTROLS.
  1089                24 PI-SYSTEM-DISPLAY     PIC X.
  1090                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1091                24 PI-SYSTEM-MODIFY      PIC X.
  1092                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1093             20  FILLER                  PIC XX.
  1094             20  PI-DISPLAY-CAP          PIC X.
  1095                 88  DISPLAY-CAP             VALUE 'Y'.
  1096             20  PI-MODIFY-CAP           PIC X.
  1097                 88  MODIFY-CAP              VALUE 'Y'.
  1098             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1099                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1100             20  PI-FORCE-CAP            PIC X.
  1101                 88  FORCE-CAP               VALUE 'Y'.
  1102
  1103         16  PI-PROGRAM-CONTROLS.
  1104             20  PI-PGM-PRINT-OPT        PIC X.
  1105             20  PI-PGM-FORMAT-OPT       PIC X.
  1106             20  PI-PGM-PROCESS-OPT      PIC X.
  1107             20  PI-PGM-TOTALS-OPT       PIC X.
  1108
  1109         16  PI-HELP-INTERFACE.
  1110             20  PI-LAST-ERROR-NO        PIC X(4).
  1111             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1112
  1113         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1114             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1115
  1116         16  PI-CR-CONTROL-IN-PROGRESS.
  1117             20  PI-CR-CARRIER           PIC X.
  1118             20  PI-CR-GROUPING          PIC X(6).
  1119             20  PI-CR-STATE             PIC XX.
  1120             20  PI-CR-ACCOUNT           PIC X(10).
  1121             20  PI-CR-FIN-RESP          PIC X(10).
  1122             20  PI-CR-TYPE              PIC X.
  1123
  1124         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1125
  1126         16  PI-CR-MONTH-END-DT          PIC XX.
  1127
  1128         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1129             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1130             88  PI-ZERO-CARRIER             VALUE '1'.
  1131             88  PI-ZERO-GROUPING            VALUE '2'.
  1132             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1133
  1134         16  PI-CARRIER-SECURITY         PIC X.
  1135             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1136
  1137         16  PI-ACCOUNT-SECURITY         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  23
* EL689.cbl
  1138             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1139             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1140
  1141         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1142             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1143                                         INDEXED BY PI-ACCESS-NDX
  1144                                         PIC X.
  1145
  1146         16  PI-GA-BILLING-CONTROL       PIC X.
  1147             88  PI-GA-BILLING               VALUE '1'.
  1148
  1149         16  PI-MAIL-PROCESSING          PIC X.
  1150             88  PI-MAIL-YES                 VALUE 'Y'.
  1151
  1152         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1153
  1154         16  PI-AR-SYSTEM.
  1155             20  PI-AR-PROCESSING-CNTL   PIC X.
  1156                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1157             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1158             20  PI-AR-MONTH-END-DT      PIC XX.
  1159
  1160         16  PI-MP-SYSTEM.
  1161             20  PI-MORTGAGE-USER            PIC X.
  1162                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1163                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1164             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1165                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1166                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1167                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1168                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1169                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1170             20  PI-MP-MONTH-END-DT          PIC XX.
  1171             20  PI-MP-REFERENCE-NO.
  1172                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1173                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1174
  1175         16  PI-LABEL-CONTROL            PIC X(01).
  1176             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1177             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1178
  1179         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1180             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1181
  1182         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1183             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1184             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1185
  1186         16  FILLER                      PIC X(14).
  1187
  1188     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1189******************************************************************
  1190     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
  1191*    COPY ELC1042.
  1192******************************************************************
  1193*                                                                *
  1194*                                                                *
  1195*                           ELC1042                              *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  24
* EL689.cbl
  1196*                            VMOD=2.002                          *
  1197*                                                                *
  1198*    NOTE                                                        *
  1199*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1200*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1201*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1202*        TO THESE PROGRAMS.                                      *
  1203*                                                                *
  1204*    NOTE                                                        *
  1205*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1206*        USE ONLY!                                               *
  1207*                                                                *
  1208******************************************************************
  1209
  1210         16  PI-1042-WA.
  1211             20  PI-ACTION       PIC  X(01).
  1212                 88 PI-SHOW-MODE           VALUE '1'.
  1213                 88 PI-CLEAR-MODE          VALUE '2'.
  1214                 88 PI-CREATE-MODE         VALUE '3'.
  1215             20  PI-COMM-CONTROL PIC  X(12).
  1216             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1217             20  PI-EOF-SW       PIC  X(01).
  1218                 88  PI-FILE-EOF           VALUE 'Y'.
  1219             20  PI-FILETYP      PIC  X(01).
  1220             20  PI-FORM-SQUEEZE-CONTROL
  1221                                 PIC  X(01).
  1222                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1223                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1224             20  PI-LAST-CONTROL PIC  X(12).
  1225             20  PI-TEMP-STOR-ITEMS
  1226                                 PIC S9(04) COMP.
  1227             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1228             20  PI-UPDATE-SW    PIC  9(01).
  1229                 88 ANY-UPDATES            VALUE 1.
  1230             20  PI-104-SCREEN-SENT-IND
  1231                                 PIC  X(01).
  1232                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1233                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1234             20  PI-1042-SCREEN-SENT-IND
  1235                                 PIC  X(01).
  1236                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1237                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1238             20  PI-1042-ARCHIVE-IND
  1239                                 PIC  X(01).
  1240                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1241             20  FILLER          PIC  X(29).
  1242*    COPY ELC689PI.
  1243******************************************************************
  1244*                                                                *
  1245*                            ELC689PI                            *
  1246*                            VMOD=2.003                          *
  1247*                                                                *
  1248*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1249*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  1250*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1251*                                                                *
  1252*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
  1253*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  25
* EL689.cbl
  1254*    BETWEEN PROGRAMS.                                           *
  1255*                                                                *
  1256*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1257*                                                                *
  1258*               EL631 - EL689  - EL6891 - EL6892                 *
  1259*                                                                *
  1260******************************************************************
  1261*                   C H A N G E   L O G
  1262*
  1263* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1264*-----------------------------------------------------------------
  1265*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1266* EFFECTIVE    NUMBER
  1267*-----------------------------------------------------------------
  1268* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  1269* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  1270* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1271******************************************************************
  1272
  1273
  1274         16  PI-689-WORK-AREA.
  1275             20  PI-689-ALT-PRINTER-ID
  1276                                 PIC  X(04).
  1277             20  PI-689-ARCHIVE-NUMBER
  1278                                 PIC  9(08).
  1279             20  PI-689-ARCHIVE-SW
  1280                                 PIC  X(01).
  1281                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  1282             20  PI-689-DATA-SOURCE
  1283                                 PIC  X(01).
  1284                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  1285                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  1286                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  1287                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  1288                 88  PI-689-SRC-CHECKS         VALUE '5'.
  1289             20  PI-689-ERROR-IND
  1290                                 PIC  X(01).
  1291                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  1292             20  PI-689-ERROR    PIC  9(04).
  1293                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  1294                 88  PI-689-FATAL-ERROR
  1295                     VALUES 0004 0006 0008 0013 0023 0029 0033
  1296                            0042 0047 0051 0066 0067 0070
  1297                            0168 0169 0174 0175 0176 0177 0179
  1298                            0180 0181 0182 0184 0185 0189 0190
  1299                            0191
  1300                            0215 0279 0280
  1301                            0412 0413 0454
  1302                            0533 0537
  1303                            2055 2114 2208 2209 2216 2232 2369
  1304                            2398 2433 2908 2999
  1305                            3000 3770 3771 3775
  1306                            7250 7365 7367 7368 7369 7370 7371
  1307                            7272 7373 7374 7376 7377 7378 7379
  1308                            7381 7388 7390 7393 7395 7396 7398
  1309                            9095 9096 9281 9298 9299 9320 9327
  1310                            9426 9427.
  1311                 88  PI-689-STOP-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  26
* EL689.cbl
  1312                     VALUES 0004 0008 0013 0023 0029 0033
  1313                            0042 0047 0066 0067 0070
  1314                            0168 0169 0174 0175 0176 0177
  1315                            0181 0182 0184 0185 0189 0190
  1316                            0279 0280
  1317                            0412 0413 0454
  1318                            2055 2208 2209 2216 2232
  1319                            2398 2999
  1320                            3000 3770 3771 3775
  1321                            7250 7365 7369 7370 7371
  1322                            7272 7373 7374 7376 7377 7378 7379
  1323                            7381 7388 7390 7393 7396 7398
  1324                            9095 9096 9299 9320 9426.
  1325             20  PI-689-FOLLOW-UP-DATE
  1326                                 PIC  X(02).
  1327             20  PI-689-FORM-NUMBER
  1328                                 PIC  X(04).
  1329             20  PI-689-LABEL-SOURCE
  1330                                 PIC X(01).
  1331                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1332                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1333                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1334                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1335                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1336                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1337                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1338             20  PI-689-NUMBER-COPIES
  1339                                 PIC  9(01).
  1340             20  PI-689-NUMBER-LABEL-LINES
  1341                                 PIC  9(01).
  1342             20  PI-689-NUMBER-TEXT-RECORDS
  1343                                 PIC  9(03).
  1344             20  PI-689-PRINT-ORDER-SW
  1345                                 PIC  X(01).
  1346                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1347                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1348                 88  PI-689-PRINT-LATER     VALUE '3'.
  1349                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1350             20  PI-689-PRINT-RESTRICTION
  1351                                 PIC  X(01).
  1352                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1353                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1354                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1355             20  PI-689-PRINT-SW PIC  X(01).
  1356                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1357             20  PI-689-RESEND-DATE-1
  1358                                 PIC  X(02).
  1359             20  PI-689-RESEND-LETR-1
  1360                                 PIC X(4).
  1361             20  PI-689-TEMP-STOR-ID
  1362                                 PIC  X(08).
  1363             20  PI-689-USE-SCREEN-IND
  1364                                 PIC  X(01).
  1365                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1366             20  PI-689-ARCH-POINTER
  1367                                 PIC S9(08) COMP.
  1368                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
  1369             20  PI-689-ARCT-POINTER
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  27
* EL689.cbl
  1370                                 PIC S9(08) COMP.
  1371                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1372             20  PI-689-VARIABLE-DATA-GRP.
  1373                 24  PI-689-VARIABLE-DATA-1
  1374                                 PIC  X(30).
  1375                 24  PI-689-VARIABLE-DATA-2
  1376                                 PIC  X(30).
  1377                 24  PI-689-VARIABLE-DATA-3
  1378                                 PIC  X(30).
  1379                 24  PI-689-VARIABLE-DATA-4
  1380                                 PIC  X(30).
  1381
  1382         16  PI-689-KEY-DATA-FIELDS.
  1383             20  PI-689-ACCOUNT  PIC  X(10).
  1384             20  PI-689-CARRIER  PIC  X(01).
  1385             20  PI-689-CERT-NO.
  1386                 24  PI-689-CERT-PRIME
  1387                                 PIC  X(10).
  1388                 24  PI-689-CERT-SFX
  1389                                 PIC  X(01).
  1390             20  PI-689-CHG-SEQ-NO
  1391                                 PIC S9(04)    COMP.
  1392             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1393                                 PIC  X(02).
  1394             20  PI-689-ENTRY-BATCH
  1395                                 PIC  X(06).
  1396             20  PI-689-EFF-DATE PIC  X(02).
  1397             20  PI-689-EXP-DATE PIC  X(02).
  1398             20  PI-689-GROUPING PIC  X(06).
  1399             20  PI-689-RESP-PERSON
  1400                                 PIC  X(10).
  1401             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1402             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1403                                 PIC  X(04).
  1404             20  PI-689-STATE    PIC  X(02).
  1405             20  PI-689-TYPE     PIC  X(01).
  1406             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1407             20  PI-689-ALT-SEQ-NO
  1408                                 PIC S9(04)    COMP.
  1409         16  PI-689-DATE-EDIT    PIC  X(08).
  1410         16  PI-689-FOLLOW-UP-EDIT
  1411                                 PIC  X(08).
  1412         16  PI-689-RESEND1-EDIT PIC  X(08).
  1413         16  PI-689-SEQ-EDIT     PIC  X(08).
  1414         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1415         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1416             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1417         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1418         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1419         16  PI-PROMPT-IND       PIC X(1).
  1420         16  PI-CERT-FORM-ID     PIC X(5).
  1421         16  PI-PRINT-NOW        PIC X(1).
  1422         16  PI-ENCLOSURE-CD     PIC X(3).
  1423         16  PI-CERT-REQ-IND     PIC X(1).
  1424         16  PI-ENDT-ARCH-NO     PIC 9(8).
  1425         16  PI-REASON-REQ-IND   PIC X(1).
  1426         16  pi-iss-can-pend-rec pic x.
  1427         16  FILLER              PIC X(243).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  28
* EL689.cbl
  1428*        16  FILLER                        PIC X(276).
  1429*        16  FILLER                        PIC X(280).
  1430
  1431 01  FILLER                      PIC  X(20)
  1432                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  29
* EL689.cbl
  1434 01  FILLER                      PIC  X(16)
  1435                        VALUE 'MAP AREA STARTS:'.
  1436*    COPY EL689S.
  1437 01  EL689AI.
  1438     05  FILLER            PIC  X(0012).
  1439*    -------------------------------
  1440     05  RUNDTEL PIC S9(0004) COMP.
  1441     05  RUNDTEF PIC  X(0001).
  1442     05  FILLER REDEFINES RUNDTEF.
  1443         10  RUNDTEA PIC  X(0001).
  1444     05  RUNDTEI PIC  X(0008).
  1445*    -------------------------------
  1446     05  RUNTIMEL PIC S9(0004) COMP.
  1447     05  RUNTIMEF PIC  X(0001).
  1448     05  FILLER REDEFINES RUNTIMEF.
  1449         10  RUNTIMEA PIC  X(0001).
  1450     05  RUNTIMEI PIC  X(0005).
  1451*    -------------------------------
  1452     05  HOSTL PIC S9(0004) COMP.
  1453     05  HOSTF PIC  X(0001).
  1454     05  FILLER REDEFINES HOSTF.
  1455         10  HOSTA PIC  X(0001).
  1456     05  HOSTI PIC  X(0010).
  1457*    -------------------------------
  1458     05  SYSL PIC S9(0004) COMP.
  1459     05  SYSF PIC  X(0001).
  1460     05  FILLER REDEFINES SYSF.
  1461         10  SYSA PIC  X(0001).
  1462     05  SYSI PIC  X(0008).
  1463*    -------------------------------
  1464     05  COMPANYL PIC S9(0004) COMP.
  1465     05  COMPANYF PIC  X(0001).
  1466     05  FILLER REDEFINES COMPANYF.
  1467         10  COMPANYA PIC  X(0001).
  1468     05  COMPANYI PIC  X(0003).
  1469*    -------------------------------
  1470     05  USERIDL PIC S9(0004) COMP.
  1471     05  USERIDF PIC  X(0001).
  1472     05  FILLER REDEFINES USERIDF.
  1473         10  USERIDA PIC  X(0001).
  1474     05  USERIDI PIC  X(0004).
  1475*    -------------------------------
  1476     05  MAINTL PIC S9(0004) COMP.
  1477     05  MAINTF PIC  X(0001).
  1478     05  FILLER REDEFINES MAINTF.
  1479         10  MAINTA PIC  X(0001).
  1480     05  MAINTI PIC  X(0001).
  1481*    -------------------------------
  1482     05  FORML PIC S9(0004) COMP.
  1483     05  FORMF PIC  X(0001).
  1484     05  FILLER REDEFINES FORMF.
  1485         10  FORMA PIC  X(0001).
  1486     05  FORMI PIC  X(0004).
  1487*    -------------------------------
  1488     05  ARCHNUML PIC S9(0004) COMP.
  1489     05  ARCHNUMF PIC  X(0001).
  1490     05  FILLER REDEFINES ARCHNUMF.
  1491         10  ARCHNUMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  30
* EL689.cbl
  1492     05  ARCHNUMI PIC  99999999.
  1493*    -------------------------------
  1494     05  PRTNOWL PIC S9(0004) COMP.
  1495     05  PRTNOWF PIC  X(0001).
  1496     05  FILLER REDEFINES PRTNOWF.
  1497         10  PRTNOWA PIC  X(0001).
  1498     05  PRTNOWI PIC  X(0001).
  1499*    -------------------------------
  1500     05  CARRIERL PIC S9(0004) COMP.
  1501     05  CARRIERF PIC  X(0001).
  1502     05  FILLER REDEFINES CARRIERF.
  1503         10  CARRIERA PIC  X(0001).
  1504     05  CARRIERI PIC  X(0001).
  1505*    -------------------------------
  1506     05  GROUPL PIC S9(0004) COMP.
  1507     05  GROUPF PIC  X(0001).
  1508     05  FILLER REDEFINES GROUPF.
  1509         10  GROUPA PIC  X(0001).
  1510     05  GROUPI PIC  X(0006).
  1511*    -------------------------------
  1512     05  STATEL PIC S9(0004) COMP.
  1513     05  STATEF PIC  X(0001).
  1514     05  FILLER REDEFINES STATEF.
  1515         10  STATEA PIC  X(0001).
  1516     05  STATEI PIC  X(0002).
  1517*    -------------------------------
  1518     05  ACCTL PIC S9(0004) COMP.
  1519     05  ACCTF PIC  X(0001).
  1520     05  FILLER REDEFINES ACCTF.
  1521         10  ACCTA PIC  X(0001).
  1522     05  ACCTI PIC  X(0010).
  1523*    -------------------------------
  1524     05  CERTL PIC S9(0004) COMP.
  1525     05  CERTF PIC  X(0001).
  1526     05  FILLER REDEFINES CERTF.
  1527         10  CERTA PIC  X(0001).
  1528     05  CERTI PIC  X(0010).
  1529*    -------------------------------
  1530     05  SFXL PIC S9(0004) COMP.
  1531     05  SFXF PIC  X(0001).
  1532     05  FILLER REDEFINES SFXF.
  1533         10  SFXA PIC  X(0001).
  1534     05  SFXI PIC  X(0001).
  1535*    -------------------------------
  1536     05  TYPEL PIC S9(0004) COMP.
  1537     05  TYPEF PIC  X(0001).
  1538     05  FILLER REDEFINES TYPEF.
  1539         10  TYPEA PIC  X(0001).
  1540     05  TYPEI PIC  X(0001).
  1541*    -------------------------------
  1542     05  DATEL PIC S9(0004) COMP.
  1543     05  DATEF PIC  X(0001).
  1544     05  FILLER REDEFINES DATEF.
  1545         10  DATEA PIC  X(0001).
  1546     05  DATEI PIC  X(0008).
  1547*    -------------------------------
  1548     05  FOLLOWL PIC S9(0004) COMP.
  1549     05  FOLLOWF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  31
* EL689.cbl
  1550     05  FILLER REDEFINES FOLLOWF.
  1551         10  FOLLOWA PIC  X(0001).
  1552     05  FOLLOWI PIC  X(0008).
  1553*    -------------------------------
  1554     05  RESEND1L PIC S9(0004) COMP.
  1555     05  RESEND1F PIC  X(0001).
  1556     05  FILLER REDEFINES RESEND1F.
  1557         10  RESEND1A PIC  X(0001).
  1558     05  RESEND1I PIC  X(0008).
  1559*    -------------------------------
  1560     05  ENCL PIC S9(0004) COMP.
  1561     05  ENCF PIC  X(0001).
  1562     05  FILLER REDEFINES ENCF.
  1563         10  ENCA PIC  X(0001).
  1564     05  ENCI PIC  X(0003).
  1565*    -------------------------------
  1566     05  ENDARCHL PIC S9(0004) COMP.
  1567     05  ENDARCHF PIC  X(0001).
  1568     05  FILLER REDEFINES ENDARCHF.
  1569         10  ENDARCHA PIC  X(0001).
  1570     05  ENDARCHI PIC  99999999.
  1571*    -------------------------------
  1572     05  CERTIDL PIC S9(0004) COMP.
  1573     05  CERTIDF PIC  X(0001).
  1574     05  FILLER REDEFINES CERTIDF.
  1575         10  CERTIDA PIC  X(0001).
  1576     05  CERTIDI PIC  X(0005).
  1577*    -------------------------------
  1578     05  ADDRSL PIC S9(0004) COMP.
  1579     05  ADDRSF PIC  X(0001).
  1580     05  FILLER REDEFINES ADDRSF.
  1581         10  ADDRSA PIC  X(0001).
  1582     05  ADDRSI PIC  X(0001).
  1583*    -------------------------------
  1584     05  PRINTERL PIC S9(0004) COMP.
  1585     05  PRINTERF PIC  X(0001).
  1586     05  FILLER REDEFINES PRINTERF.
  1587         10  PRINTERA PIC  X(0001).
  1588     05  PRINTERI PIC  X(0004).
  1589*    -------------------------------
  1590     05  COPIESL PIC S9(0004) COMP.
  1591     05  COPIESF PIC  X(0001).
  1592     05  FILLER REDEFINES COPIESF.
  1593         10  COPIESA PIC  X(0001).
  1594     05  COPIESI PIC  X(0001).
  1595*    -------------------------------
  1596     05  DATASORL PIC S9(0004) COMP.
  1597     05  DATASORF PIC  X(0001).
  1598     05  FILLER REDEFINES DATASORF.
  1599         10  DATASORA PIC  X(0001).
  1600     05  DATASORI PIC  X(0001).
  1601*    -------------------------------
  1602     05  ADDRLBLL PIC S9(0004) COMP.
  1603     05  ADDRLBLF PIC  X(0001).
  1604     05  FILLER REDEFINES ADDRLBLF.
  1605         10  ADDRLBLA PIC  X(0001).
  1606     05  ADDRLBLI PIC  X(0001).
  1607*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  32
* EL689.cbl
  1608     05  RPERSONL PIC S9(0004) COMP.
  1609     05  RPERSONF PIC  X(0001).
  1610     05  FILLER REDEFINES RPERSONF.
  1611         10  RPERSONA PIC  X(0001).
  1612     05  RPERSONI PIC  X(0010).
  1613*    -------------------------------
  1614     05  BENTRYL PIC S9(0004) COMP.
  1615     05  BENTRYF PIC  X(0001).
  1616     05  FILLER REDEFINES BENTRYF.
  1617         10  BENTRYA PIC  X(0001).
  1618     05  BENTRYI PIC  X(0006).
  1619*    -------------------------------
  1620     05  SEQL PIC S9(0004) COMP.
  1621     05  SEQF PIC  X(0001).
  1622     05  FILLER REDEFINES SEQF.
  1623         10  SEQA PIC  X(0001).
  1624     05  SEQI PIC  X(0008).
  1625*    -------------------------------
  1626     05  BCSEQL PIC S9(0004) COMP.
  1627     05  BCSEQF PIC  X(0001).
  1628     05  FILLER REDEFINES BCSEQF.
  1629         10  BCSEQA PIC  X(0001).
  1630     05  BCSEQI PIC  X(0004).
  1631*    -------------------------------
  1632     05  L1L PIC S9(0004) COMP.
  1633     05  L1F PIC  X(0001).
  1634     05  FILLER REDEFINES L1F.
  1635         10  L1A PIC  X(0001).
  1636     05  L1I PIC  X(0003).
  1637*    -------------------------------
  1638     05  TEXT1L PIC S9(0004) COMP.
  1639     05  TEXT1F PIC  X(0001).
  1640     05  FILLER REDEFINES TEXT1F.
  1641         10  TEXT1A PIC  X(0001).
  1642     05  TEXT1I PIC  X(0070).
  1643*    -------------------------------
  1644     05  L2L PIC S9(0004) COMP.
  1645     05  L2F PIC  X(0001).
  1646     05  FILLER REDEFINES L2F.
  1647         10  L2A PIC  X(0001).
  1648     05  L2I PIC  X(0003).
  1649*    -------------------------------
  1650     05  TEXT2L PIC S9(0004) COMP.
  1651     05  TEXT2F PIC  X(0001).
  1652     05  FILLER REDEFINES TEXT2F.
  1653         10  TEXT2A PIC  X(0001).
  1654     05  TEXT2I PIC  X(0070).
  1655*    -------------------------------
  1656     05  L3L PIC S9(0004) COMP.
  1657     05  L3F PIC  X(0001).
  1658     05  FILLER REDEFINES L3F.
  1659         10  L3A PIC  X(0001).
  1660     05  L3I PIC  X(0003).
  1661*    -------------------------------
  1662     05  TEXT3L PIC S9(0004) COMP.
  1663     05  TEXT3F PIC  X(0001).
  1664     05  FILLER REDEFINES TEXT3F.
  1665         10  TEXT3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  33
* EL689.cbl
  1666     05  TEXT3I PIC  X(0070).
  1667*    -------------------------------
  1668     05  L4L PIC S9(0004) COMP.
  1669     05  L4F PIC  X(0001).
  1670     05  FILLER REDEFINES L4F.
  1671         10  L4A PIC  X(0001).
  1672     05  L4I PIC  X(0003).
  1673*    -------------------------------
  1674     05  TEXT4L PIC S9(0004) COMP.
  1675     05  TEXT4F PIC  X(0001).
  1676     05  FILLER REDEFINES TEXT4F.
  1677         10  TEXT4A PIC  X(0001).
  1678     05  TEXT4I PIC  X(0070).
  1679*    -------------------------------
  1680     05  L5L PIC S9(0004) COMP.
  1681     05  L5F PIC  X(0001).
  1682     05  FILLER REDEFINES L5F.
  1683         10  L5A PIC  X(0001).
  1684     05  L5I PIC  X(0003).
  1685*    -------------------------------
  1686     05  TEXT5L PIC S9(0004) COMP.
  1687     05  TEXT5F PIC  X(0001).
  1688     05  FILLER REDEFINES TEXT5F.
  1689         10  TEXT5A PIC  X(0001).
  1690     05  TEXT5I PIC  X(0070).
  1691*    -------------------------------
  1692     05  L6L PIC S9(0004) COMP.
  1693     05  L6F PIC  X(0001).
  1694     05  FILLER REDEFINES L6F.
  1695         10  L6A PIC  X(0001).
  1696     05  L6I PIC  X(0003).
  1697*    -------------------------------
  1698     05  TEXT6L PIC S9(0004) COMP.
  1699     05  TEXT6F PIC  X(0001).
  1700     05  FILLER REDEFINES TEXT6F.
  1701         10  TEXT6A PIC  X(0001).
  1702     05  TEXT6I PIC  X(0070).
  1703*    -------------------------------
  1704     05  L7L PIC S9(0004) COMP.
  1705     05  L7F PIC  X(0001).
  1706     05  FILLER REDEFINES L7F.
  1707         10  L7A PIC  X(0001).
  1708     05  L7I PIC  X(0003).
  1709*    -------------------------------
  1710     05  TEXT7L PIC S9(0004) COMP.
  1711     05  TEXT7F PIC  X(0001).
  1712     05  FILLER REDEFINES TEXT7F.
  1713         10  TEXT7A PIC  X(0001).
  1714     05  TEXT7I PIC  X(0070).
  1715*    -------------------------------
  1716     05  L8L PIC S9(0004) COMP.
  1717     05  L8F PIC  X(0001).
  1718     05  FILLER REDEFINES L8F.
  1719         10  L8A PIC  X(0001).
  1720     05  L8I PIC  X(0003).
  1721*    -------------------------------
  1722     05  TEXT8L PIC S9(0004) COMP.
  1723     05  TEXT8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  34
* EL689.cbl
  1724     05  FILLER REDEFINES TEXT8F.
  1725         10  TEXT8A PIC  X(0001).
  1726     05  TEXT8I PIC  X(0070).
  1727*    -------------------------------
  1728     05  L9L PIC S9(0004) COMP.
  1729     05  L9F PIC  X(0001).
  1730     05  FILLER REDEFINES L9F.
  1731         10  L9A PIC  X(0001).
  1732     05  L9I PIC  X(0003).
  1733*    -------------------------------
  1734     05  TEXT9L PIC S9(0004) COMP.
  1735     05  TEXT9F PIC  X(0001).
  1736     05  FILLER REDEFINES TEXT9F.
  1737         10  TEXT9A PIC  X(0001).
  1738     05  TEXT9I PIC  X(0070).
  1739*    -------------------------------
  1740     05  L10L PIC S9(0004) COMP.
  1741     05  L10F PIC  X(0001).
  1742     05  FILLER REDEFINES L10F.
  1743         10  L10A PIC  X(0001).
  1744     05  L10I PIC  X(0003).
  1745*    -------------------------------
  1746     05  TEXT10L PIC S9(0004) COMP.
  1747     05  TEXT10F PIC  X(0001).
  1748     05  FILLER REDEFINES TEXT10F.
  1749         10  TEXT10A PIC  X(0001).
  1750     05  TEXT10I PIC  X(0070).
  1751*    -------------------------------
  1752     05  L11L PIC S9(0004) COMP.
  1753     05  L11F PIC  X(0001).
  1754     05  FILLER REDEFINES L11F.
  1755         10  L11A PIC  X(0001).
  1756     05  L11I PIC  X(0003).
  1757*    -------------------------------
  1758     05  TEXT11L PIC S9(0004) COMP.
  1759     05  TEXT11F PIC  X(0001).
  1760     05  FILLER REDEFINES TEXT11F.
  1761         10  TEXT11A PIC  X(0001).
  1762     05  TEXT11I PIC  X(0070).
  1763*    -------------------------------
  1764     05  L12L PIC S9(0004) COMP.
  1765     05  L12F PIC  X(0001).
  1766     05  FILLER REDEFINES L12F.
  1767         10  L12A PIC  X(0001).
  1768     05  L12I PIC  X(0003).
  1769*    -------------------------------
  1770     05  TEXT12L PIC S9(0004) COMP.
  1771     05  TEXT12F PIC  X(0001).
  1772     05  FILLER REDEFINES TEXT12F.
  1773         10  TEXT12A PIC  X(0001).
  1774     05  TEXT12I PIC  X(0070).
  1775*    -------------------------------
  1776     05  ERRMSGL PIC S9(0004) COMP.
  1777     05  ERRMSGF PIC  X(0001).
  1778     05  FILLER REDEFINES ERRMSGF.
  1779         10  ERRMSGA PIC  X(0001).
  1780     05  ERRMSGI PIC  X(0079).
  1781*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  35
* EL689.cbl
  1782     05  ENTERPFL PIC S9(0004) COMP.
  1783     05  ENTERPFF PIC  X(0001).
  1784     05  FILLER REDEFINES ENTERPFF.
  1785         10  ENTERPFA PIC  X(0001).
  1786     05  ENTERPFI PIC  99.
  1787*    -------------------------------
  1788     05  PF8HDL PIC S9(0004) COMP.
  1789     05  PF8HDF PIC  X(0001).
  1790     05  FILLER REDEFINES PF8HDF.
  1791         10  PF8HDA PIC  X(0001).
  1792     05  PF8HDI PIC  X(0022).
  1793 01  EL689AO REDEFINES EL689AI.
  1794     05  FILLER            PIC  X(0012).
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  RUNDTEO PIC  X(0008).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  RUNTIMEO PIC  99.99.
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  HOSTO PIC  X(0010).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  SYSO PIC  X(0008).
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  COMPANYO PIC  X(0003).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  USERIDO PIC  X(0004).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  MAINTO PIC  X(0001).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  FORMO PIC  X(0004).
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  ARCHNUMO PIC  99999999.
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  PRTNOWO PIC  X(0001).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  CARRIERO PIC  X(0001).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  GROUPO PIC  X(0006).
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  STATEO PIC  X(0002).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  ACCTO PIC  X(0010).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  CERTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  36
* EL689.cbl
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  SFXO PIC  X(0001).
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  TYPEO PIC  X(0001).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  DATEO PIC  X(0008).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  FOLLOWO PIC  X(0008).
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  RESEND1O PIC  X(0008).
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  ENCO PIC  X(0003).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  ENDARCHO PIC  99999999.
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  CERTIDO PIC  X(0005).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  ADDRSO PIC  X(0001).
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  PRINTERO PIC  X(0004).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  COPIESO PIC  X(0001).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  DATASORO PIC  X(0001).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  ADDRLBLO PIC  X(0001).
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  RPERSONO PIC  X(0010).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  BENTRYO PIC  X(0006).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  SEQO PIC  X(0008).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  BCSEQO PIC  X(0004).
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  L1O PIC  X(0003).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  TEXT1O PIC  X(0070).
  1897*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  37
* EL689.cbl
  1898     05  FILLER            PIC  X(0003).
  1899     05  L2O PIC  X(0003).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  TEXT2O PIC  X(0070).
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  L3O PIC  X(0003).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  TEXT3O PIC  X(0070).
  1909*    -------------------------------
  1910     05  FILLER            PIC  X(0003).
  1911     05  L4O PIC  X(0003).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  TEXT4O PIC  X(0070).
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  L5O PIC  X(0003).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  TEXT5O PIC  X(0070).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  L6O PIC  X(0003).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  TEXT6O PIC  X(0070).
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  L7O PIC  X(0003).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  TEXT7O PIC  X(0070).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  L8O PIC  X(0003).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  TEXT8O PIC  X(0070).
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  L9O PIC  X(0003).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  TEXT9O PIC  X(0070).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  L10O PIC  X(0003).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  TEXT10O PIC  X(0070).
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  L11O PIC  X(0003).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  38
* EL689.cbl
  1956     05  TEXT11O PIC  X(0070).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  L12O PIC  X(0003).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  TEXT12O PIC  X(0070).
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  ERRMSGO PIC  X(0079).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
  1968     05  ENTERPFO PIC  X(0002).
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  PF8HDO PIC  X(0022).
  1972*    -------------------------------
  1973 01  W-MAP-REDEF REDEFINES EL689AI.
  1974*    12  FILLER                  PIC X(218).
  1975     12  FILLER                  PIC X(267).
  1976     12  EL689RI.
  1977         16  W-TEXT-LINES OCCURS 12 TIMES INDEXED BY W-SC-NDX.
  1978             20  W-SC-LINEL      PIC S9(04) COMP.
  1979             20  W-SC-LINEA      PIC  X(01).
  1980             20  W-SC-LINE       PIC  X(03).
  1981             20  W-SC-TEXTL      PIC S9(04) COMP.
  1982             20  W-SC-TEXTA      PIC  X(01).
  1983             20  W-SC-TEXT       PIC  X(70).
  1984*    12  FILLER                  PIC  X(87).
  1985     12  FILLER                  PIC  X(112).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  39
* EL689.cbl
  1987 01  W-CONSTANT-AREA.
  1988     12  FILLER                  PIC  X(18)
  1989                                 VALUE 'PROGRAM CONSTANTS:'.
  1990     12  W-APPL-SCRTY-NDX        PIC S9(04)  COMP  VALUE +03.
  1991     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
  1992     12  W-ARCT-LENGTH           PIC S9(04)  COMP  VALUE +1640.
  1993     12  W-ENDT-LENGTH           PIC S9(04)  COMP  VALUE +579.
  1994     12  W-NOTE-LENGTH           PIC S9(04)  COMP  VALUE +825.
  1995     12  W-EOBC-LENGTH           PIC S9(04)  COMP  VALUE +350.
  1996     12  W-ENCC-LENGTH           PIC S9(04)  COMP  VALUE +400.
  1997     12  W-MAX-LINES             PIC S9(03) VALUE +300 COMP-3.
  1998     12  W-NUM-LINES-PER-SCREEN  PIC  9(02)        VALUE 12.
  1999     12  W-TS-NUM-REC-IN-GROUP   PIC  9(02)        VALUE 50.
  2000     12  W-TS-LENGTH             PIC S9(04)  COMP  VALUE +3650.
  2001     12  W-TS-MAP-LENGTH         PIC S9(04)  COMP  VALUE +1260.
  2002     12  W-ZEROS                 PIC S9(03) VALUE +000 COMP-3.
  2003
  2004     12  W-ACCT-FILE-ID          PIC  X(08) VALUE 'ERACCT'.
  2005     12  W-ACCT2-FILE-ID         PIC  X(08) VALUE 'ERACCT2'.
  2006     12  W-ARCH-FILE-ID          PIC  X(08) VALUE 'ERARCH'.
  2007     12  W-ARCH2-FILE-ID         PIC  X(08) VALUE 'ERARCH2'.
  2008     12  W-ARCH3-FILE-ID         PIC  X(08) VALUE 'ERARCH3'.
  2009     12  W-ARCH4-FILE-ID         PIC  X(08) VALUE 'ERARCH4'.
  2010     12  W-ARCH5-FILE-ID         PIC  X(08) VALUE 'ERARCH5'.
  2011     12  W-ARCT-FILE-ID          PIC  X(08) VALUE 'ERARCT'.
  2012     12  W-CERT-FILE-ID          PIC  X(08) VALUE 'ELCERT'.
  2013     12  W-CHEK-FILE-ID          PIC  X(08) VALUE 'ERCHEK'.
  2014     12  W-CNTL-FILE-ID          PIC  X(08) VALUE 'ELCNTL'.
  2015     12  W-COMP-FILE-ID          PIC  X(08) VALUE 'ERCOMP'.
  2016     12  W-NOTE-FILE-ID          PIC  X(08) VALUE 'ERNOTE'.
  2017     12  W-EOBC-FILE-ID          PIC  X(08) VALUE 'ELEOBC'.
  2018     12  W-ENCC-FILE-ID          PIC  X(08) VALUE 'ELENCC'.
  2019     12  W-GETMAIN-SPACE         PIC  X(01) VALUE SPACE.
  2020     12  W-LGXX-ID               PIC  X(04) VALUE 'LGXX'.
  2021     12  W-LINK-001              PIC  X(05) VALUE 'EL001'.
  2022     12  W-LINK-004              PIC  X(05) VALUE 'EL004'.
  2023     12  W-LINK-ELDATCV          PIC  X(07) VALUE 'ELDATCV'.
  2024     12  W-LOWER-CASE            PIC  X(26)
  2025         VALUE 'abcdefghijklmnopqrstuvwxyz'.
  2026     12  W-MAIL-FILE-ID          PIC  X(08) VALUE 'ERMAIL'.
  2027     12  W-MAP.
  2028         16  W-MAP-PREFIX        PIC  X(02) VALUE 'EL'.
  2029         16  W-MAP-NUM           PIC  X(04) VALUE '689A'.
  2030         16  W-MAP-FILLER        PIC  X(02) VALUE SPACES.
  2031     12  W-MAPSET                PIC  X(08) VALUE 'EL689S'.
  2032     12  W-PGM-EL1042            PIC  X(08) VALUE 'EL1042'.
  2033     12  W-PGM-EL690             PIC  X(08) VALUE 'EL690'.
  2034     12  W-PGM-EL626             PIC  X(08) VALUE 'EL626'.
  2035     12  W-PNDB-FILE-ID          PIC  X(08) VALUE 'ERPNDB'.
  2036     12  W-PRINT-TRANS           PIC  X(04) VALUE 'EXH5'.
  2037     12  W-PYAJ-FILE-ID          PIC  X(08) VALUE 'ERPYAJ'.
  2038
  2039     12  W-TEXT-FILE-ID          PIC  X(08) VALUE 'ELLETR'.
  2040     12  W-THIS-PGM              PIC  X(08) VALUE 'EL689'.
  2041     12  W-TOP-FORM              PIC  X(70)
  2042                              VALUE '*****TOP OF FORM *****'.
  2043     12  W-TRANSACTION           PIC  X(04) VALUE 'EXH3'.
  2044     12  W-UPPER-CASE            PIC  X(26)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  40
* EL689.cbl
  2045         VALUE 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
  2046     12  W-XCTL-005              PIC  X(05) VALUE 'EL005'.
  2047     12  W-XCTL-010              PIC  X(05) VALUE 'EL010'.
  2048     12  W-XCTL-626              PIC  X(05) VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  41
* EL689.cbl
  2050 01  W-VARIABLE-PROCESS-CNTLS.
  2051     12  FILLER                  PIC  X(26)
  2052                        VALUE 'VARIABLE WORK AREA STARTS:'.
  2053     12  W-NUM-OF-VARIABLES      PIC S9(03) VALUE +189 COMP-3.
  2054     12  W-VAR-HOLD.
  2055         16  W-V1                PIC  X(01).
  2056         16  W-V2                PIC  X(01).
  2057         16  W-V3                PIC  X(01).
  2058     12  FILLER REDEFINES W-VAR-HOLD.
  2059         16  W-VAR-RELATIVE-NUM  PIC  9(03).
  2060     12  W-FIELD-SQUEEZE-IND     PIC  X(01).
  2061         88  W-SQUEEZE-FIELD          VALUE '#'.
  2062
  2063 01  W-SUPPORTED-VARIABLES.
  2064
  2065*****************COMPANY VARIABLES - ELCNTL ********************
  2066*****COMPANY NAME
  2067     12  FILLER                  PIC  X(03) VALUE '001'.
  2068     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2069     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2070     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2071     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2072
  2073*****FULL COMPANY ADDRESS
  2074     12  FILLER                  PIC  X(03) VALUE '002'.
  2075     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2076     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2077     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2078     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2079
  2080     12  FILLER                  PIC  X(03) VALUE '003'.
  2081     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2082     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2083     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2084     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2085
  2086     12  FILLER                  PIC  X(03) VALUE '004'.
  2087     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2088     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2089     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2090     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2091
  2092     12  FILLER                  PIC  X(03) VALUE '005'.
  2093     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2094     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2095     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2096     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2097
  2098     12  FILLER                  PIC  X(03) VALUE '006'.
  2099     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2100     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2101     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2102     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2103
  2104*****REMAINING 4 ARE NOT CURRENTLY USED
  2105     12  FILLER                  PIC  X(03) VALUE '007'.
  2106     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2107     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  42
* EL689.cbl
  2108     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2109     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2110
  2111     12  FILLER                  PIC  X(03) VALUE '008'.
  2112     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2113     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2114     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2115     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2116
  2117     12  FILLER                  PIC  X(03) VALUE '009'.
  2118     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2119     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2120     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2121     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2122
  2123     12  FILLER                  PIC  X(03) VALUE '010'.
  2124     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2125     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2126     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2127     12  FILLER                  PIC S9(04) COMP VALUE +01.
  2128
  2129************ LIFE BENEFIT VARIABLES - ELCNTL *******************
  2130*****LIFE BENEFIT DESCRIPTION
  2131     12  FILLER                  PIC  X(03) VALUE '011'.
  2132     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2133     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2134     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2135     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2136
  2137*****REMAINING 3 ARE NOT CURRENTLY USED
  2138     12  FILLER                  PIC  X(03) VALUE '012'.
  2139     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2140     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2141     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2142     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2143
  2144     12  FILLER                  PIC  X(03) VALUE '013'.
  2145     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2146     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2147     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2148     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2149
  2150     12  FILLER                  PIC  X(03) VALUE '014'.
  2151     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2152     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2153     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2154     12  FILLER                  PIC S9(04) COMP VALUE +02.
  2155
  2156************* A&H BENEFIT VARIABLES - ELCNTL *******************
  2157*****AH BENEFIT DESCRIPTION
  2158     12  FILLER                  PIC  X(03) VALUE '015'.
  2159     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2160     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2161     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2162     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2163
  2164*****ELIMINATION PERIOD
  2165     12  FILLER                  PIC  X(03) VALUE '016'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  43
* EL689.cbl
  2166     12  FILLER                  PIC S9(04) COMP VALUE +2.
  2167     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2168     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2169     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2170
  2171*****REMAINING 3 ARE NOT CURRENTLY USED
  2172     12  FILLER                  PIC  X(03) VALUE '017'.
  2173     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2174     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2175     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2176     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2177
  2178     12  FILLER                  PIC  X(03) VALUE '018'.
  2179     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2180     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2181     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2182     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2183
  2184     12  FILLER                  PIC  X(03) VALUE '019'.
  2185     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2186     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2187     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2188     12  FILLER                  PIC S9(04) COMP VALUE +03.
  2189
  2190*****************CARRIER VARIABLES - ELCNTL ********************
  2191*****CARRIER NAME
  2192     12  FILLER                  PIC  X(03) VALUE '020'.
  2193     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2194     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2195     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2196     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2197
  2198*****FULL CARRIER ADDRESS
  2199     12  FILLER                  PIC  X(03) VALUE '021'.
  2200     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2201     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2202     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2203     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2204
  2205     12  FILLER                  PIC  X(03) VALUE '022'.
  2206     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2207     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2208     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2209     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2210
  2211     12  FILLER                  PIC  X(03) VALUE '023'.
  2212     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2213     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2214     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2215     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2216
  2217     12  FILLER                  PIC  X(03) VALUE '024'.
  2218     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2219     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2220     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2221     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2222
  2223     12  FILLER                  PIC  X(03) VALUE '025'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  44
* EL689.cbl
  2224     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2225     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2226     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2227     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2228
  2229*****CARRIER PHONE NUMBER
  2230     12  FILLER                  PIC  X(03) VALUE '026'.
  2231     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2232     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2233     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2234     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2235
  2236*****REMAINING 4 ARE NOT CURRENTLY USED
  2237     12  FILLER                  PIC  X(03) VALUE '027'.
  2238     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2239     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2240     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2241     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2242
  2243     12  FILLER                  PIC  X(03) VALUE '028'.
  2244     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2245     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2246     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2247     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2248
  2249     12  FILLER                  PIC  X(03) VALUE '029'.
  2250     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2251     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2252     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2253     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2254
  2255     12  FILLER                  PIC  X(03) VALUE '030'.
  2256     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2257     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2258     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2259     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2260
  2261***************** MAIL VARIABLES - ELMAIL **********************
  2262*****FULL MAIL ADDRESS
  2263     12  FILLER                  PIC  X(03) VALUE '031'.
  2264     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2265     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2266     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2267     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2268
  2269     12  FILLER                  PIC  X(03) VALUE '032'.
  2270     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2271     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2272     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2273     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2274
  2275     12  FILLER                  PIC  X(03) VALUE '033'.
  2276     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2277     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2278     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2279     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2280
  2281     12  FILLER                  PIC  X(03) VALUE '034'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  45
* EL689.cbl
  2282     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2283     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2284     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2285     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2286
  2287     12  FILLER                  PIC  X(03) VALUE '035'.
  2288     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2289     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2290     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2291     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2292
  2293     12  FILLER                  PIC  X(03) VALUE '036'.
  2294     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2295     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2296     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2297     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2298**** CRED BENE NAME FROM ERMAIL
  2299     12  FILLER                  PIC  X(03) VALUE '037'.
  2300     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2301     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2302     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2303     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2304*****REMAINING 2 ARE NOT CURRENTLY USED
  2305     12  FILLER                  PIC  X(03) VALUE '038'.
  2306     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2307     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2308     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2309     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2310
  2311     12  FILLER                  PIC  X(03) VALUE '039'.
  2312     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2313     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2314     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2315     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2316
  2317*************** ACCOUNT VARIABLES - ERACCT *********************
  2318*****ACCOUNT NAME
  2319     12  FILLER                  PIC  X(03) VALUE '040'.
  2320     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2321     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2322     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2323     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2324
  2325*****FULL ACCOUNT ADDRESS
  2326     12  FILLER                  PIC  X(03) VALUE '041'.
  2327     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2328     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2329     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2330     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2331
  2332     12  FILLER                  PIC  X(03) VALUE '042'.
  2333     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2334     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2335     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2336     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2337
  2338     12  FILLER                  PIC  X(03) VALUE '043'.
  2339     12  FILLER                  PIC S9(04) COMP VALUE +30.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  46
* EL689.cbl
  2340     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2341     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2342     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2343
  2344     12  FILLER                  PIC  X(03) VALUE '044'.
  2345     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2346     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2347     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2348     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2349
  2350     12  FILLER                  PIC  X(03) VALUE '045'.
  2351     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2352     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2353     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2354     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2355
  2356*****ACCOUNT PHONE NUMBER
  2357     12  FILLER                  PIC  X(03) VALUE '046'.
  2358     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2359     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2360     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2361     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2362
  2363*****ACCOUNT CONTROL NAME AM-CONTROL-NAME
  2364     12  FILLER                  PIC  X(03) VALUE '047'.
  2365     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2366     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2367     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2368     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2369
  2370****ACCOUNT CSR CODE
  2371     12  FILLER                  PIC  X(03) VALUE '048'.
  2372     12  FILLER                  PIC S9(04) COMP VALUE +4..
  2373     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2374     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2375     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2376****ACCOUNT ACCOUNT NUMBER
  2377     12  FILLER                  PIC  X(03) VALUE '049'.
  2378     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2379     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2380     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2381     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2382
  2383**** CRED BENE ADDRESS LINE 1 ERMAIL
  2384     12  FILLER                  PIC  X(03) VALUE '050'.
  2385     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2386     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2387     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2388     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2389
  2390**** CRED BENE ADDRESS LINE 2 ERMAIL
  2391     12  FILLER                  PIC  X(03) VALUE '051'.
  2392     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2393     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2394     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2395     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2396
  2397**** CRED BENE CITY STATE   ERMAIL
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  47
* EL689.cbl
  2398     12  FILLER                  PIC  X(03) VALUE '052'.
  2399     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2400     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2401     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2402     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2403
  2404**** CRED BENE ZIP  1 ERMAIL
  2405     12  FILLER                  PIC  X(03) VALUE '053'.
  2406     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2407     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2408     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2409     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2410
  2411*****REMAINING 6 ARE NOT CURRENTLY USED
  2412     12  FILLER                  PIC  X(03) VALUE '054'.
  2413     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2414     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2415     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2416     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2417
  2418     12  FILLER                  PIC  X(03) VALUE '055'.
  2419     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2420     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2421     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2422     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2423
  2424     12  FILLER                  PIC  X(03) VALUE '056'.
  2425     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2426     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2427     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2428     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2429
  2430     12  FILLER                  PIC  X(03) VALUE '057'.
  2431     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2432     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2433     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2434     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2435
  2436     12  FILLER                  PIC  X(03) VALUE '058'.
  2437     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2438     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2439     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2440     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2441
  2442     12  FILLER                  PIC  X(03) VALUE '059'.
  2443     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2444     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2445     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2446     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2447
  2448*************** NON FILE VARIABLES *****************************
  2449*****CURRENT DATE
  2450     12  FILLER                  PIC  X(03) VALUE '060'.
  2451     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2452     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2453     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2454     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2455
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  48
* EL689.cbl
  2456*****FULL CURRENT DATE
  2457     12  FILLER                  PIC  X(03) VALUE '061'.
  2458     12  FILLER                  PIC S9(04) COMP VALUE +18.
  2459     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2460     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2461     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2462
  2463*****FORM
  2464     12  FILLER                  PIC  X(03) VALUE '062'.
  2465     12  FILLER                  PIC S9(04) COMP VALUE +04.
  2466     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2467     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2468     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2469
  2470*****VARIABLE 1
  2471     12  FILLER                  PIC  X(03) VALUE '063'.
  2472     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2473     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2474     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2475     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2476
  2477*****VARIABLE 2
  2478     12  FILLER                  PIC  X(03) VALUE '064'.
  2479     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2480     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2481     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2482     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2483
  2484*****VARIABLE 3
  2485     12  FILLER                  PIC  X(03) VALUE '065'.
  2486     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2487     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2488     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2489     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2490
  2491*****VARIABLE 4
  2492     12  FILLER                  PIC  X(03) VALUE '066'.
  2493     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2494     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2495     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2496     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2497
  2498*****REMAINING 3 ARE NOT CURRENTLY USED
  2499     12  FILLER                  PIC  X(03) VALUE '067'.
  2500     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2501     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2502     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2503     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2504
  2505     12  FILLER                  PIC  X(03) VALUE '068'.
  2506     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2507     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2508     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2509     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2510
  2511     12  FILLER                  PIC  X(03) VALUE '069'.
  2512     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2513     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  49
* EL689.cbl
  2514     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2515     12  FILLER                  PIC S9(04) COMP VALUE +07.
  2516
  2517************** CERTIFICATE VARIABLES - ELCERT *****************
  2518*****CARRIER CODE IN CERT
  2519     12  FILLER                  PIC  X(03) VALUE '070'.
  2520     12  FILLER                  PIC S9(04) COMP VALUE +1.
  2521     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2522     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2523     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2524
  2525*****GROUPING CODE IN CERT
  2526     12  FILLER                  PIC  X(03) VALUE '071'.
  2527     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2528     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2529     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2530     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2531
  2532*****ACCOUNT NUMBER IN CERT
  2533     12  FILLER                  PIC  X(03) VALUE '072'.
  2534     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2535     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2536     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2537     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2538
  2539*****CERTIFICATE NUMBER
  2540     12  FILLER                  PIC  X(03) VALUE '073'.
  2541     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2542     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2543     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2544     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2545
  2546*****CERT EFFECTIVE DATE
  2547     12  FILLER                  PIC  X(03) VALUE '074'.
  2548     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2549     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2550     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2551     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2552
  2553*****CERT EXPIRATION DATE (LIFE)
  2554     12  FILLER                  PIC  X(03) VALUE '075'.
  2555     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2556     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2557     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2558     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2559
  2560*****CERT EXPIRATION DATE (AH)
  2561     12  FILLER                  PIC  X(03) VALUE '076'.
  2562     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2563     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2564     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2565     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2566
  2567*****LIFE TERM
  2568     12  FILLER                  PIC  X(03) VALUE '077'.
  2569     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2570     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2571     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  50
* EL689.cbl
  2572     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2573
  2574*****AH  TERM
  2575     12  FILLER                  PIC  X(03) VALUE '078'.
  2576     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2577     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2578     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2579     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2580
  2581*****LIFE COVERAGE AMOUNT
  2582     12  FILLER                  PIC  X(03) VALUE '079'.
  2583     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2584     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2585     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2586     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2587
  2588*****AH MONTHLY BENEFIT
  2589     12  FILLER                  PIC  X(03) VALUE '080'.
  2590     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2591     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2592     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2593     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2594
  2595*****LIFE CANCEL DATE
  2596     12  FILLER                  PIC  X(03) VALUE '081'.
  2597     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2598     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2599     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2600     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2601
  2602*****AH CANCEL DATE
  2603     12  FILLER                  PIC  X(03) VALUE '082'.
  2604     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2605     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2606     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2607     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2608
  2609*****LIFE COVERAGE FORM NUMBER
  2610     12  FILLER                  PIC  X(03) VALUE '083'.
  2611     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2612     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2613     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2614     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2615
  2616*****UNUSED
  2617     12  FILLER                  PIC  X(03) VALUE '084'.
  2618     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2619     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2620     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2621     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2622
  2623*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
  2624     12  FILLER                  PIC  X(03) VALUE '085'.
  2625     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2626     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2627     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2628     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2629
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  51
* EL689.cbl
  2630*****LOAN NUMBER
  2631     12  FILLER                  PIC  X(03) VALUE '086'.
  2632     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2633     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2634     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2635     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2636
  2637*****LOAN BALANCE
  2638     12  FILLER                  PIC  X(03) VALUE '087'.
  2639     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2640     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2641     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2642     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2643
  2644*****MEMBER NUMBER
  2645     12  FILLER                  PIC  X(03) VALUE '088'.
  2646     12  FILLER                  PIC S9(04) COMP VALUE +12.
  2647     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2648     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2649     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2650
  2651*****INSURED SOC SEC NUMBER
  2652     12  FILLER                  PIC  X(03) VALUE '089'.
  2653     12  FILLER                  PIC S9(04) COMP VALUE +11.
  2654     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2655     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2656     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2657
  2658*****INSURED INITIALS & LAST NAME (CERTIFICATE)
  2659     12  FILLER                  PIC  X(03) VALUE '090'.
  2660     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2661     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2662     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2663     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2664
  2665*****INSURED FIRST NAME (CERTIFICATE)
  2666     12  FILLER                  PIC  X(03) VALUE '091'.
  2667     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2668     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2669     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2670     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2671
  2672*****INSURED MIDDLE INITIAL (CERTIFICATE)
  2673     12  FILLER                  PIC  X(03) VALUE '092'.
  2674     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2675     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2676     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2677     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2678
  2679*****ORIG TERM * MON BEN
  2680     12  FILLER                  PIC  X(03) VALUE '093'.
  2681     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2682     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2683     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2684     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2685
  2686*****INSURED'S NAME (LAST, FIRST, INIT)
  2687     12  FILLER                  PIC  X(03) VALUE '094'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  52
* EL689.cbl
  2688     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2689     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2690     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2691     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2692
  2693*****INSURED'S NAME (FIRST, INIT, LAST)
  2694     12  FILLER                  PIC  X(03) VALUE  '095'.
  2695     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2696     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2697     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2698     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2699
  2700*****TITLE (MR/MS)
  2701     12  FILLER                  PIC  X(03) VALUE '096'.
  2702     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2703     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2704     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2705     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2706
  2707*****LIFE PREMIUM (CERTIFICATE)
  2708     12  FILLER                  PIC  X(03) VALUE '097'.
  2709     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2710     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2711     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2712     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2713
  2714*****A/H PREMIUM (CERTIFICATE)
  2715     12  FILLER                  PIC  X(03) VALUE '098'.
  2716     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2717     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2718     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2719     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2720
  2721*****JOINT'S INITIALS & LAST NAME (CERTIFICATE)
  2722     12  FILLER                  PIC  X(03) VALUE '099'.
  2723     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2724     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2725     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2726     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2727
  2728*****JOINT'S FIRST NAME (CERTIFICATE)
  2729     12  FILLER                  PIC  X(03) VALUE '100'.
  2730     12  FILLER                  PIC S9(04) COMP VALUE +10.
  2731     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2732     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2733     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2734
  2735*****JOINT'S MIDDLE INITIAL (CERTIFICATE)
  2736     12  FILLER                  PIC  X(03) VALUE '101'.
  2737     12  FILLER                  PIC S9(04) COMP VALUE +05.
  2738     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2739     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2740     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2741
  2742*****JOINT'S NAME (LAST, FIRST, INIT)
  2743     12  FILLER                  PIC  X(03) VALUE '102'.
  2744     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2745     12  FILLER                  PIC  X(30) VALUE ALL '*'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  53
* EL689.cbl
  2746     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2747     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2748
  2749*****JOINT'S NAME (FIRST, INIT, LAST)
  2750     12  FILLER                  PIC  X(03) VALUE '103'.
  2751     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2752     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2753     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2754     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2755
  2756*****INSURED'S FIRST AND LAST NAME
  2757     12  FILLER                  PIC  X(03) VALUE '104'.
  2758     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2759     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2760     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2761     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2762
  2763*****JOINT'S FIRST AND LAST NAME
  2764     12  FILLER                  PIC  X(03) VALUE '105'.
  2765     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2766     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2767     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2768     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2769
  2770*****ENTERED LIFE REFUND (CERT)
  2771     12  FILLER                  PIC  X(03) VALUE '106'.
  2772     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2773     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2774     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2775     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2776
  2777*****ENTERED A/H REFUND (CERT)
  2778     12  FILLER                  PIC  X(03) VALUE '107'.
  2779     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2780     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2781     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2782     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2783
  2784*****INSURED'S LAST NAME
  2785     12  FILLER                  PIC  X(03) VALUE '108'.
  2786     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2787     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2788     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  2789     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2790
  2791*****BENEFICIARY
  2792     12  FILLER                  PIC  X(03) VALUE  '109'.
  2793     12  FILLER                  PIC S9(04) COMP VALUE +25.
  2794     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2795     12  FILLER                  PIC  X(01) VALUE 'Y'.
  2796     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2797
  2798************** PENDING VARIABLES - ERPNDB *********************
  2799*****INSURED DATE OF BIRTH
  2800     12  FILLER                  PIC  X(03) VALUE '110'.
  2801     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2802     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2803     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  54
* EL689.cbl
  2804     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2805
  2806*****ENTERED LIFE PREMIUM (PENDING)
  2807     12  FILLER                  PIC  X(03) VALUE '111'.
  2808     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2809     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2810     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2811     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2812
  2813*****ENTERED A/H PREMIUM (PENDING)
  2814     12  FILLER                  PIC  X(03) VALUE '112'.
  2815     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2816     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2817     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2818     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2819
  2820*****CALCULATED LIFE PREMIUM (PENDING)
  2821     12  FILLER                  PIC  X(03) VALUE '113'.
  2822     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2823     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2824     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2825     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2826
  2827*****CALCULATED A/H PREMIUM (PENDING)
  2828     12  FILLER                  PIC  X(03) VALUE '114'.
  2829     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2830     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2831     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2832     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2833
  2834*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
  2835     12  FILLER                  PIC  X(03) VALUE '115'.
  2836     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2837     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2838     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2839     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2840
  2841*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
  2842     12  FILLER                  PIC  X(03) VALUE '116'.
  2843     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2844     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2845     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2846     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2847
  2848*****PRIOR CANCEL DATE
  2849     12  FILLER                  PIC  X(03) VALUE '117'.
  2850     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2851     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2852     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2853     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2854
  2855*****ENTERED LIFE REFUND (PENDING)
  2856     12  FILLER                  PIC  X(03) VALUE '118'.
  2857     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2858     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2859     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2860     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2861
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  55
* EL689.cbl
  2862*****ENTERED A/H REFUND (PENDING)
  2863     12  FILLER                  PIC  X(03) VALUE '119'.
  2864     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2865     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2866     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2867     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2868
  2869*****CALCULATED LIFE REFUND (PENDING)
  2870     12  FILLER                  PIC  X(03) VALUE '120'.
  2871     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2872     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2873     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2874     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2875
  2876*****CALCULATED A/H REFUND (PENDING)
  2877     12  FILLER                  PIC  X(03) VALUE '121'.
  2878     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2879     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2880     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2881     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2882
  2883*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
  2884     12  FILLER                  PIC  X(03) VALUE '122'.
  2885     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2886     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2887     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2888     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2889
  2890*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
  2891     12  FILLER                  PIC  X(03) VALUE '123'.
  2892     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2893     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2894     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2895     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2896
  2897*****INSUREDS AGE
  2898     12  FILLER                  PIC  X(03) VALUE '124'.
  2899     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2900     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2901     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2902     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2903
  2904*****LIFE BENEFIT (PENDING)
  2905     12  FILLER                  PIC  X(03) VALUE '125'.
  2906     12  FILLER                  PIC S9(04) COMP VALUE +15.
  2907     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2908     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2909     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2910
  2911*****A/H BENEFIT (PENDING)
  2912     12  FILLER                  PIC  X(03) VALUE '126'.
  2913     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2914     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2915     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2916     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2917
  2918*****LIFE RATE
  2919     12  FILLER                  PIC  X(03) VALUE '127'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  56
* EL689.cbl
  2920     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2921     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2922     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2923     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2924
  2925*****A/H RATE
  2926     12  FILLER                  PIC  X(03) VALUE '128'.
  2927     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2928     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2929     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2930     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2931
  2932*****TERM (PENDING)
  2933     12  FILLER                  PIC  X(03) VALUE '129'.
  2934     12  FILLER                  PIC S9(04) COMP VALUE +3.
  2935     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2936     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2937     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2938
  2939*****BATCH NUMBER
  2940     12  FILLER                  PIC  X(03) VALUE '130'.
  2941     12  FILLER                  PIC S9(04) COMP VALUE +06.
  2942     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2943     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2944     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2945
  2946*****TOTAL OF LIFE AND A&H REFUND
  2947     12  FILLER                  PIC  X(03) VALUE '131'.
  2948     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2949     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2950     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2951     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2952
  2953*****NH INTEREST ON REFUNDS
  2954     12  FILLER                  PIC  X(03) VALUE '132'.
  2955     12  FILLER                  PIC S9(04) COMP VALUE +13.
  2956     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2957     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2958     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2959*****GREATER OF THE LIFE AND AH CANCEL DATE
  2960     12  FILLER                  PIC  X(03) VALUE '133'.
  2961     12  FILLER                  PIC S9(04) COMP VALUE +8.
  2962     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2963     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2964     12  FILLER                  PIC S9(04) COMP VALUE +08.
  2965
  2966*****THE NEXT 6 NOT CURRENTLY USED
  2967     12  FILLER                  PIC  X(03) VALUE '134'.
  2968     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2969     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2970     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2971     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2972
  2973     12  FILLER                  PIC  X(03) VALUE '135'.
  2974     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2975     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2976     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2977     12  FILLER                  PIC S9(04) COMP VALUE +09.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  57
* EL689.cbl
  2978
  2979     12  FILLER                  PIC  X(03) VALUE '136'.
  2980     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2981     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2982     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2983     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2984
  2985     12  FILLER                  PIC  X(03) VALUE '137'.
  2986     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2987     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2988     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2989     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2990
  2991     12  FILLER                  PIC  X(03) VALUE '138'.
  2992     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2993     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  2994     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  2995     12  FILLER                  PIC S9(04) COMP VALUE +09.
  2996
  2997     12  FILLER                  PIC  X(03) VALUE '139'.
  2998     12  FILLER                  PIC S9(04) COMP VALUE +30.
  2999     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3000     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3001     12  FILLER                  PIC S9(04) COMP VALUE +09.
  3002
  3003************** COMPENSATION VARIABLES - ERCOMP ****************
  3004*****COMPENSATION ACCT NAME
  3005     12  FILLER                  PIC  X(03) VALUE '140'.
  3006     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3007     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3008     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3009     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3010
  3011*****FULL COMPENSATION ADDRESS TYPE 'A'
  3012     12  FILLER                  PIC  X(03) VALUE '141'.
  3013     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3014     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3015     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3016     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3017
  3018     12  FILLER                  PIC  X(03) VALUE '142'.
  3019     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3020     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3021     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3022     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3023
  3024     12  FILLER                  PIC  X(03) VALUE '143'.
  3025     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3026     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3027     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3028     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3029
  3030     12  FILLER                  PIC  X(03) VALUE '144'.
  3031     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3032     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3033     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3034     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3035
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  58
* EL689.cbl
  3036     12  FILLER                  PIC  X(03) VALUE '145'.
  3037     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3038     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3039     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3040     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3041
  3042     12  FILLER                  PIC  X(03) VALUE '146'.
  3043     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3044     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3045     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3046     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3047
  3048*****COMPENSATION PHONE NUMBER
  3049     12  FILLER                  PIC  X(03) VALUE '147'.
  3050     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3051     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3052     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3053     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3054
  3055*****COMPENSATION CSR NAME
  3056     12  FILLER                  PIC  X(03) VALUE '148'.
  3057     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3058     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3059     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3060     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3061
  3062*****COMPENSATION LAST STATEMENT DATE
  3063     12  FILLER                  PIC  X(03) VALUE '149'.
  3064     12  FILLER                  PIC S9(04) COMP VALUE +18.
  3065     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3066     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3067     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3068
  3069*****COMPENSATION ENDING BALANCE
  3070     12  FILLER                  PIC  X(03) VALUE '150'.
  3071     12  FILLER                  PIC S9(04) COMP VALUE +14.
  3072     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3073     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3074     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3075
  3076******************  PROCESSOR DATA - ELCNTL (2) ****************
  3077*****EXECUTING PROCESSOR NAME
  3078     12  FILLER                  PIC  X(03) VALUE '151'.
  3079     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3080     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3081     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3082     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3083
  3084*****PROCESSOR TITLE
  3085     12  FILLER                  PIC  X(03) VALUE '152'.
  3086     12  FILLER                  PIC S9(04) COMP VALUE +26.
  3087     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3088     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3089     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3090
  3091*****PROCESSOR
  3092     12  FILLER                  PIC  X(03) VALUE '153'.
  3093     12  FILLER                  PIC S9(04) COMP VALUE +04.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  59
* EL689.cbl
  3094     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3095     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3096     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3097
  3098*****CSR TITLE
  3099     12  FILLER                  PIC  X(03) VALUE '154'.
  3100     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3101     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3102     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3103     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3104*****REMAINING 2 ARE NOT CURRENTLY USED
  3105     12  FILLER                  PIC  X(03) VALUE '155'.
  3106     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3107     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3108     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3109     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3110
  3111     12  FILLER                  PIC  X(03) VALUE '156'.
  3112     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3113     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3114     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3115     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3116
  3117******************  CHECK DATA - ERCHEK    *********************
  3118*****CHECK AMOUNT
  3119     12  FILLER                  PIC  X(03) VALUE '157'.
  3120     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3121     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3122     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3123     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3124
  3125*****CHECK NUMBER
  3126     12  FILLER                  PIC  X(03) VALUE '158'.
  3127     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3128     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3129     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3130     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3131
  3132*****PAYEE 1 NAME
  3133     12  FILLER                  PIC  X(03) VALUE '159'.
  3134     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3135     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3136     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3137     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3138
  3139*****PAYEE 2 NAME
  3140     12  FILLER                  PIC  X(03) VALUE '160'.
  3141     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3142     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3143     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3144     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3145
  3146*****ADDRSS 1
  3147     12  FILLER                  PIC  X(03) VALUE '161'.
  3148     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3149     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3150     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3151     12  FILLER                  PIC S9(04) COMP VALUE +12.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  60
* EL689.cbl
  3152
  3153*****ADDRESS 2
  3154     12  FILLER                  PIC  X(03) VALUE '162'.
  3155     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3156     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3157     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3158     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3159
  3160*****PAYEE CITY STATE
  3161     12  FILLER                  PIC  X(03) VALUE '163'.
  3162     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3163     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3164     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3165     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3166
  3167*****ZIP CODE
  3168     12  FILLER                  PIC  X(03) VALUE '164'.
  3169     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3170     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3171     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3172     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3173
  3174*****CHECK CONTROL
  3175     12  FILLER                  PIC  X(03) VALUE '165'.
  3176     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3177     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3178     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3179     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3180
  3181*****REASON FOR CHECK
  3182     12  FILLER                  PIC  X(03) VALUE '166'.
  3183     12  FILLER                  PIC S9(04) COMP VALUE +25.
  3184     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3185     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3186     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3187
  3188*****REMAINING 3 ARE NOT CURRENTLY USED
  3189     12  FILLER                  PIC  X(03) VALUE '167'.
  3190     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3191     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3192     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3193     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3194
  3195     12  FILLER                  PIC  X(03) VALUE '168'.
  3196     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3197     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3198     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3199     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3200
  3201     12  FILLER                  PIC  X(03) VALUE '169'.
  3202     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3203     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3204     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3205     12  FILLER                  PIC S9(04) COMP VALUE +11.
  3206
  3207
  3208*********** PAYMENT AND ADJUSTMENT DATA - ERPYAJ  **************
  3209*****CHECK AMOUNT - PYAJ
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  61
* EL689.cbl
  3210     12  FILLER                  PIC  X(03) VALUE '170'.
  3211     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3212     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3213     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3214     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3215
  3216*****CHECK NUMBER - PYAJ
  3217     12  FILLER                  PIC  X(03) VALUE '171'.
  3218     12  FILLER                  PIC S9(04) COMP VALUE +7.
  3219     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3220     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3221     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3222
  3223*****CHECK CONTROL - PYAJ
  3224     12  FILLER                  PIC  X(03) VALUE '172'.
  3225     12  FILLER                  PIC S9(04) COMP VALUE +08.
  3226     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3227     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3228     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3229
  3230***** COMMENT - PYAJ
  3231     12  FILLER                  PIC  X(03) VALUE '173'.
  3232     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3233     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3234     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3235     12  FILLER                  PIC S9(04) COMP VALUE +13.
  3236
  3237*****NEW FIELDS.
  3238*****COMPENSATION FULL ADDRESS TYPE 'G'
  3239     12  FILLER                  PIC  X(03) VALUE '174'.
  3240     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3241     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3242     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3243     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3244
  3245     12  FILLER                  PIC  X(03) VALUE '175'.
  3246     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3247     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3248     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3249     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3250
  3251     12  FILLER                  PIC  X(03) VALUE '176'.
  3252     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3253     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3254     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3255     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3256
  3257     12  FILLER                  PIC  X(03) VALUE '177'.
  3258     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3259     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3260     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3261     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3262
  3263     12  FILLER                  PIC  X(03) VALUE '178'.
  3264     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3265     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3266     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3267     12  FILLER                  PIC S9(04) COMP VALUE +10.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  62
* EL689.cbl
  3268
  3269     12  FILLER                  PIC  X(03) VALUE '179'.
  3270     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3271     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3272     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3273     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3274
  3275*****COMPENSATION FINANCIAL RESPONSIBLE NO.
  3276     12  FILLER                  PIC  X(03) VALUE '180'.
  3277     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3278     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3279     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3280     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3281**** COMPENSATION BILLING SWITCH
  3282     12  FILLER                  PIC XXX    VALUE '181'.
  3283     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3284     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3285     12  FILLER                  PIC X      VALUE ALL 'N'.
  3286     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3287*****COMPENSATION FAX NUMBER
  3288     12  FILLER                  PIC  X(03) VALUE '182'.
  3289     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3290     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3291     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3292     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3293**** COMPENSATION STATUS
  3294     12  FILLER                  PIC XXX    VALUE '183'.
  3295     12  FILLER                  PIC S9(4)  COMP VALUE +7.
  3296     12  FILLER                  PIC X(30)  VALUE ALL '*'.
  3297     12  FILLER                  PIC X      VALUE ALL 'N'.
  3298     12  FILLER                  PIC S9(4)  COMP VALUE +10.
  3299***** THE VARS 184 - 189 WILL TYPICALLY BE USED FOR DCC BANKS
  3300*****COMPENSATION FULL ADDRESS TYPE 'B'
  3301     12  FILLER                  PIC  X(03) VALUE '184'.
  3302     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3303     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3304     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3305     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3306
  3307     12  FILLER                  PIC  X(03) VALUE '185'.
  3308     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3309     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3310     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3311     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3312
  3313     12  FILLER                  PIC  X(03) VALUE '186'.
  3314     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3315     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3316     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3317     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3318
  3319     12  FILLER                  PIC  X(03) VALUE '187'.
  3320     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3321     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3322     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3323     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3324
  3325     12  FILLER                  PIC  X(03) VALUE '188'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  63
* EL689.cbl
  3326     12  FILLER                  PIC S9(04) COMP VALUE +30.
  3327     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3328     12  FILLER                  PIC  X(01) VALUE ALL 'Y'.
  3329     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3330
  3331     12  FILLER                  PIC  X(03) VALUE '189'.
  3332     12  FILLER                  PIC S9(04) COMP VALUE +12.
  3333     12  FILLER                  PIC  X(30) VALUE ALL '*'.
  3334     12  FILLER                  PIC  X(01) VALUE ALL 'N'.
  3335     12  FILLER                  PIC S9(04) COMP VALUE +10.
  3336
  3337
  3338 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
  3339*    12  W-VARIABLE-GRP OCCURS 180 TIMES
  3340     12  W-VARIABLE-GRP OCCURS 189 TIMES
  3341                        INDEXED BY W-VG-NDX.
  3342         16  W-VARIABLE-ID         PIC  X(03).
  3343         16  W-VARIABLE-SIZE       PIC S9(04) COMP.
  3344         16  W-VG-TEXT.
  3345             20  W-VAR-CHAR
  3346                        OCCURS 30 TIMES
  3347                        INDEXED BY W-VC-NDX
  3348                                   PIC  X(01).
  3349         16  W-VARIABLE-UPLOW-IND  PIC  X(01).
  3350             88  W-USE-UPPER-AND-LOWER-CASE VALUE 'Y'.
  3351
  3352         16  W-VARIABLE-SOURCE   PIC S9(04) COMP.
  3353
  3354 01  W-VAR-END                   PIC  X(23)
  3355                        VALUE ':VARIABLE WORK AREA END'.
  3356
  3357 01  W-PROGRAM-TABLE-AREA.
  3358     12  FILLER                  PIC  X(15)
  3359                                 VALUE 'PROGRAM TABLES:'.
  3360
  3361     12  W-RECORD-TABLE              VALUE SPACES.
  3362         16  W-RC-GRP OCCURS 500 TIMES
  3363                       INDEXED BY W-RG-NDX
  3364                                  W-RG-NDX1.
  3365             20  W-RC-TEXT.
  3366                 24  W-RC-CHAR OCCURS 70 TIMES
  3367                                INDEXED BY W-RC-NDX
  3368                                           W-RC-NDX1
  3369                                 PIC  X(01).
  3370             20  W-RC-PC         PIC  9(02).
  3371             20  W-RC-SC         PIC  X(01).
  3372
  3373     12  FILLER REDEFINES W-RECORD-TABLE.
  3374         16  W-REC-CHAR OCCURS 36500 TIMES
  3375                        INDEXED BY W-RVS-NDX
  3376                                   W-RVS-NDX2
  3377                                 PIC  X(01).
  3378     12  FILLER REDEFINES W-RECORD-TABLE.
  3379         16  W-TS-GROUP OCCURS 10 TIMES
  3380                        INDEXED BY W-TS-NDX
  3381                                 PIC X(3650).
  3382
  3383     12  FILLER                  PIC  X(11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  64
* EL689.cbl
  3384                                 VALUE 'TEXT TABLE:'.
  3385     12  W-TX-TABLE                  VALUE SPACES.
  3386         16  W-TX-GRP OCCURS 500 TIMES
  3387                       INDEXED BY W-TG-NDX
  3388                                  W-TG-NDX2.
  3389             20  W-TX-TEXT.
  3390                 24  W-TX-CHAR OCCURS 70 TIMES
  3391                                    INDEXED BY W-TX-NDX
  3392                                               W-TX-NDX1
  3393                                               W-TX-NDX2
  3394                                 PIC  X(01).
  3395             20  W-TX-PC         PIC  9(02).
  3396             20  W-TX-SC         PIC  X(01).
  3397
  3398     12  FILLER                  PIC  X(11)
  3399                                 VALUE 'FILE TABLE:'.
  3400     12  W-FILE-TABLE                VALUE SPACES.
  3401         16  W-FILE-USE-IND OCCURS 20 TIMES
  3402                       INDEXED BY W-FILE-NDX
  3403                                 PIC  X(01).
  3404             88  W-FILE-NOT-USED     VALUE SPACE.
  3405             88  W-FILE-USED         VALUE 'Y'.
  3406
  3407     12  FILLER                  PIC  X(14)
  3408                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  65
* EL689.cbl
  3410 01  ERROR-MESSAGES.
  3411     12  ER-0000                 PIC  X(04) VALUE '0000'.
  3412     12  ER-0004                 PIC  X(04) VALUE '0004'.
  3413     12  ER-0006                 PIC  X(04) VALUE '0006'.
  3414     12  ER-0008                 PIC  X(04) VALUE '0008'.
  3415     12  ER-0013                 PIC  X(04) VALUE '0013'.
  3416     12  ER-0023                 PIC  X(04) VALUE '0023'.
  3417     12  ER-0029                 PIC  X(04) VALUE '0029'.
  3418     12  ER-0033                 PIC  X(04) VALUE '0033'.
  3419     12  ER-0042                 PIC  X(04) VALUE '0042'.
  3420     12  ER-0047                 PIC  X(04) VALUE '0047'.
  3421     12  ER-0051                 PIC  X(04) VALUE '0051'.
  3422     12  ER-0066                 PIC  X(04) VALUE '0066'.
  3423     12  ER-0067                 PIC  X(04) VALUE '0067'.
  3424     12  ER-0070                 PIC  X(04) VALUE '0070'.
  3425     12  ER-0168                 PIC  X(04) VALUE '0168'.
  3426     12  ER-0169                 PIC  X(04) VALUE '0169'.
  3427     12  ER-0174                 PIC  X(04) VALUE '0174'.
  3428     12  ER-0175                 PIC  X(04) VALUE '0175'.
  3429     12  ER-0176                 PIC  X(04) VALUE '0176'.
  3430     12  ER-0177                 PIC  X(04) VALUE '0177'.
  3431     12  ER-0179                 PIC  X(04) VALUE '0179'.
  3432     12  ER-0180                 PIC  X(04) VALUE '0180'.
  3433     12  ER-0181                 PIC  X(04) VALUE '0181'.
  3434     12  ER-0182                 PIC  X(04) VALUE '0182'.
  3435     12  ER-0184                 PIC  X(04) VALUE '0184'.
  3436     12  ER-0185                 PIC  X(04) VALUE '0185'.
  3437     12  ER-0187                 PIC  X(04) VALUE '0187'.
  3438     12  ER-0188                 PIC  X(04) VALUE '0188'.
  3439     12  ER-0189                 PIC  X(04) VALUE '0189'.
  3440     12  ER-0190                 PIC  X(04) VALUE '0190'.
  3441     12  ER-0191                 PIC  X(04) VALUE '0191'.
  3442     12  ER-0215                 PIC  X(04) VALUE '0215'.
  3443     12  ER-0279                 PIC  X(04) VALUE '0279'.
  3444     12  ER-0280                 PIC  X(04) VALUE '0280'.
  3445     12  ER-0412                 PIC  X(04) VALUE '0412'.
  3446     12  ER-0413                 PIC  X(04) VALUE '0413'.
  3447     12  ER-0454                 PIC  X(04) VALUE '0454'.
  3448     12  ER-0533                 PIC  X(04) VALUE '0533'.
  3449     12  ER-0537                 PIC  X(04) VALUE '0537'.
  3450     12  ER-0715                 PIC  X(04) VALUE '0715'.
  3451     12  ER-0894                 PIC  X(04) VALUE '0894'.
  3452     12  ER-1560                 PIC  X(04) VALUE '1560'.
  3453     12  ER-1565                 PIC  X(04) VALUE '1565'.
  3454     12  ER-1778                 PIC  X(04) VALUE '1778'.
  3455     12  ER-1818                 PIC  X(04) VALUE '1818'.
  3456     12  ER-2055                 PIC  X(04) VALUE '2055'.
  3457     12  ER-2114                 PIC  X(04) VALUE '2114'.
  3458     12  ER-2208                 PIC  X(04) VALUE '2208'.
  3459     12  ER-2209                 PIC  X(04) VALUE '2209'.
  3460     12  ER-2216                 PIC  X(04) VALUE '2216'.
  3461     12  ER-2232                 PIC  X(04) VALUE '2232'.
  3462     12  ER-2369                 PIC  X(04) VALUE '2369'.
  3463     12  ER-2398                 PIC  X(04) VALUE '2398'.
  3464     12  ER-2433                 PIC  X(04) VALUE '2433'.
  3465     12  ER-2908                 PIC  X(04) VALUE '2908'.
  3466     12  ER-2999                 PIC  X(04) VALUE '2999'.
  3467     12  ER-3000                 PIC  X(04) VALUE '3000'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  66
* EL689.cbl
  3468     12  ER-3770                 PIC  X(04) VALUE '3770'.
  3469     12  ER-3771                 PIC  X(04) VALUE '3771'.
  3470     12  ER-3775                 PIC  X(04) VALUE '3775'.
  3471     12  ER-3783                 PIC  X(04) VALUE '3783'.
  3472     12  ER-7243                 PIC  X(04) VALUE '7243'.
  3473     12  ER-7245                 PIC  X(04) VALUE '7245'.
  3474     12  ER-7246                 PIC  X(04) VALUE '7246'.
  3475     12  ER-7247                 PIC  X(04) VALUE '7247'.
  3476     12  ER-7250                 PIC  X(04) VALUE '7250'.
  3477     12  ER-7365                 PIC  X(04) VALUE '7365'.
  3478     12  ER-7367                 PIC  X(04) VALUE '7367'.
  3479     12  ER-7368                 PIC  X(04) VALUE '7368'.
  3480     12  ER-7369                 PIC  X(04) VALUE '7369'.
  3481     12  ER-7370                 PIC  X(04) VALUE '7370'.
  3482     12  ER-7371                 PIC  X(04) VALUE '7371'.
  3483     12  ER-7372                 PIC  X(04) VALUE '7372'.
  3484     12  ER-7373                 PIC  X(04) VALUE '7373'.
  3485     12  ER-7374                 PIC  X(04) VALUE '7374'.
  3486     12  ER-7376                 PIC  X(04) VALUE '7376'.
  3487     12  ER-7377                 PIC  X(04) VALUE '7377'.
  3488     12  ER-7378                 PIC  X(04) VALUE '7378'.
  3489     12  ER-7379                 PIC  X(04) VALUE '7379'.
  3490     12  ER-7381                 PIC  X(04) VALUE '7381'.
  3491     12  ER-7388                 PIC  X(04) VALUE '7388'.
  3492     12  ER-7390                 PIC  X(04) VALUE '7390'.
  3493     12  ER-7393                 PIC  X(04) VALUE '7393'.
  3494     12  ER-7395                 PIC  X(04) VALUE '7395'.
  3495     12  ER-7396                 PIC  X(04) VALUE '7396'.
  3496     12  ER-7398                 PIC  X(04) VALUE '7398'.
  3497     12  ER-8965                 PIC  X(04) VALUE '8965'.
  3498     12  ER-9095                 PIC  X(04) VALUE '9095'.
  3499     12  ER-9097                 PIC  X(04) VALUE '9097'.
  3500     12  ER-9281                 PIC  X(04) VALUE '9281'.
  3501     12  ER-9283                 PIC  X(04) VALUE '9283'.
  3502     12  ER-9298                 PIC  X(04) VALUE '9298'.
  3503     12  ER-9299                 PIC  X(04) VALUE '9299'.
  3504     12  ER-9320                 PIC  X(04) VALUE '9320'.
  3505     12  ER-9327                 PIC  X(04) VALUE '9327'.
  3506     12  ER-9426                 PIC  X(04) VALUE '9426'.
  3507     12  ER-9427                 PIC  X(04) VALUE '9427'.
  3508     12  ER-9840                 PIC  X(04) VALUE '9840'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  67
* EL689.cbl
  3510*    COPY ELCAID.
  3511******************************************************************
  3512*                                                                *
  3513*                            ELCAID.                             *
  3514*                            VMOD=2.001                          *
  3515*                                                                *
  3516*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  3517*                                                                *
  3518*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  3519*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  3520******************************************************************
  3521
  3522 01  DFHAID.
  3523   02  DFHNULL   PIC  X  VALUE  ' '.
  3524   02  DFHENTER  PIC  X  VALUE  QUOTE.
  3525   02  DFHCLEAR  PIC  X  VALUE  '_'.
  3526   02  DFHPEN    PIC  X  VALUE  '='.
  3527   02  DFHOPID   PIC  X  VALUE  'W'.
  3528   02  DFHPA1    PIC  X  VALUE  '%'.
  3529   02  DFHPA2    PIC  X  VALUE  '>'.
  3530   02  DFHPA3    PIC  X  VALUE  ','.
  3531   02  DFHPF1    PIC  X  VALUE  '1'.
  3532   02  DFHPF2    PIC  X  VALUE  '2'.
  3533   02  DFHPF3    PIC  X  VALUE  '3'.
  3534   02  DFHPF4    PIC  X  VALUE  '4'.
  3535   02  DFHPF5    PIC  X  VALUE  '5'.
  3536   02  DFHPF6    PIC  X  VALUE  '6'.
  3537   02  DFHPF7    PIC  X  VALUE  '7'.
  3538   02  DFHPF8    PIC  X  VALUE  '8'.
  3539   02  DFHPF9    PIC  X  VALUE  '9'.
  3540   02  DFHPF10   PIC  X  VALUE  ':'.
  3541   02  DFHPF11   PIC  X  VALUE  '#'.
  3542   02  DFHPF12   PIC  X  VALUE  '@'.
  3543   02  DFHPF13   PIC  X  VALUE  'A'.
  3544   02  DFHPF14   PIC  X  VALUE  'B'.
  3545   02  DFHPF15   PIC  X  VALUE  'C'.
  3546   02  DFHPF16   PIC  X  VALUE  'D'.
  3547   02  DFHPF17   PIC  X  VALUE  'E'.
  3548   02  DFHPF18   PIC  X  VALUE  'F'.
  3549   02  DFHPF19   PIC  X  VALUE  'G'.
  3550   02  DFHPF20   PIC  X  VALUE  'H'.
  3551   02  DFHPF21   PIC  X  VALUE  'I'.
  3552*00039    02  DFHPF22   PIC  X  VALUE  ''.
  3553   02  DFHPF22   PIC  X  VALUE  '['.
  3554   02  DFHPF23   PIC  X  VALUE  '.'.
  3555   02  DFHPF24   PIC  X  VALUE  '<'.
  3556   02  DFHMSRE   PIC  X  VALUE  'X'.
  3557   02  DFHSTRF   PIC  X  VALUE  'h'.
  3558   02  DFHTRIG   PIC  X  VALUE  '"'.
  3559 01  FILLER    REDEFINES DFHAID.
  3560     12  FILLER                  PIC  X(08).
  3561     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  68
* EL689.cbl
  3563*    COPY ELCATTR.
  3564******************************************************************
  3565*                                                                *
  3566*                            ELCATTR.                            *
  3567*                            VMOD=2.001                          *
  3568*                                                                *
  3569*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  3570*                                                                *
  3571*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  3572*                                                                *
  3573*                   POS 1   P=PROTECTED                          *
  3574*                           U=UNPROTECTED                        *
  3575*                           S=ASKIP                              *
  3576*                   POS 2   A=ALPHA/NUMERIC                      *
  3577*                           N=NUMERIC                            *
  3578*                   POS 3   N=NORMAL                             *
  3579*                           B=BRIGHT                             *
  3580*                           D=DARK                               *
  3581*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  3582*                           OF=MODIFIED DATA TAG OFF             *
  3583*                                                                *
  3584*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  3585******************************************************************
  3586 01  ATTRIBUTE-LIST.
  3587     12  AL-PABOF            PIC X       VALUE 'Y'.
  3588     12  AL-PABON            PIC X       VALUE 'Z'.
  3589     12  AL-PADOF            PIC X       VALUE '%'.
  3590     12  AL-PADON            PIC X       VALUE '_'.
  3591     12  AL-PANOF            PIC X       VALUE '-'.
  3592     12  AL-PANON            PIC X       VALUE '/'.
  3593     12  AL-SABOF            PIC X       VALUE '8'.
  3594     12  AL-SABON            PIC X       VALUE '9'.
  3595     12  AL-SADOF            PIC X       VALUE '@'.
  3596     12  AL-SADON            PIC X       VALUE QUOTE.
  3597     12  AL-SANOF            PIC X       VALUE '0'.
  3598     12  AL-SANON            PIC X       VALUE '1'.
  3599     12  AL-UABOF            PIC X       VALUE 'H'.
  3600     12  AL-UABON            PIC X       VALUE 'I'.
  3601     12  AL-UADOF            PIC X       VALUE '<'.
  3602     12  AL-UADON            PIC X       VALUE '('.
  3603     12  AL-UANOF            PIC X       VALUE ' '.
  3604     12  AL-UANON            PIC X       VALUE 'A'.
  3605     12  AL-UNBOF            PIC X       VALUE 'Q'.
  3606     12  AL-UNBON            PIC X       VALUE 'R'.
  3607     12  AL-UNDOF            PIC X       VALUE '*'.
  3608     12  AL-UNDON            PIC X       VALUE ')'.
  3609     12  AL-UNNOF            PIC X       VALUE '&'.
  3610     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  69
* EL689.cbl
  3612*    COPY ELCDATE.
  3613******************************************************************
  3614*                                                                *
  3615*                                                                *
  3616*                            ELCDATE.                            *
  3617*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3618*                            VMOD=2.003
  3619*                                                                *
  3620*                                                                *
  3621*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  3622*                 LENGTH = 200                                   *
  3623******************************************************************
  3624
  3625 01  DATE-CONVERSION-DATA.
  3626     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  3627     12  DC-OPTION-CODE                PIC X.
  3628         88  BIN-TO-GREG                VALUE ' '.
  3629         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  3630         88  EDIT-GREG-TO-BIN           VALUE '2'.
  3631         88  YMD-GREG-TO-BIN            VALUE '3'.
  3632         88  MDY-GREG-TO-BIN            VALUE '4'.
  3633         88  JULIAN-TO-BIN              VALUE '5'.
  3634         88  BIN-PLUS-ELAPSED           VALUE '6'.
  3635         88  FIND-CENTURY               VALUE '7'.
  3636         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  3637         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  3638         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  3639         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  3640         88  JULIAN-TO-BIN-3            VALUE 'C'.
  3641         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  3642         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  3643         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  3644         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  3645         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  3646         88  CHECK-LEAP-YEAR            VALUE 'H'.
  3647         88  BIN-3-TO-GREG              VALUE 'I'.
  3648         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  3649         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  3650         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  3651         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  3652         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  3653         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  3654         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  3655         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  3656         88  THREE-CHARACTER-BIN
  3657                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  3658         88  GREGORIAN-TO-BIN
  3659                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  3660         88  BIN-TO-GREGORIAN
  3661                  VALUES ' ' '1' 'I' '8' 'G'.
  3662         88  JULIAN-TO-BINARY
  3663                  VALUES '5' 'C' 'E' 'F'.
  3664     12  DC-ERROR-CODE                 PIC X.
  3665         88  NO-CONVERSION-ERROR        VALUE ' '.
  3666         88  DATE-CONVERSION-ERROR
  3667                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  3668         88  DATE-IS-ZERO               VALUE '1'.
  3669         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  70
* EL689.cbl
  3670         88  DATE-IS-INVALID            VALUE '3'.
  3671         88  DATE1-GREATER-DATE2        VALUE '4'.
  3672         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  3673         88  DATE-INVALID-OPTION        VALUE '9'.
  3674         88  INVALID-CENTURY            VALUE 'A'.
  3675         88  ONLY-CENTURY               VALUE 'B'.
  3676         88  ONLY-LEAP-YEAR             VALUE 'C'.
  3677         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  3678     12  DC-END-OF-MONTH               PIC X.
  3679         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  3680     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  3681         88  USE-NORMAL-PROCESS         VALUE ' '.
  3682         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  3683         88  ADJUST-UP-100-YRS          VALUE '2'.
  3684     12  FILLER                        PIC X.
  3685     12  DC-CONVERSION-DATES.
  3686         16  DC-BIN-DATE-1             PIC XX.
  3687         16  DC-BIN-DATE-2             PIC XX.
  3688         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  3689         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  3690                       DC-GREG-DATE-1-EDIT.
  3691             20  DC-EDIT1-MONTH        PIC 99.
  3692             20  SLASH1-1              PIC X.
  3693             20  DC-EDIT1-DAY          PIC 99.
  3694             20  SLASH1-2              PIC X.
  3695             20  DC-EDIT1-YEAR         PIC 99.
  3696         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  3697         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  3698                     DC-GREG-DATE-2-EDIT.
  3699             20  DC-EDIT2-MONTH        PIC 99.
  3700             20  SLASH2-1              PIC X.
  3701             20  DC-EDIT2-DAY          PIC 99.
  3702             20  SLASH2-2              PIC X.
  3703             20  DC-EDIT2-YEAR         PIC 99.
  3704         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  3705         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  3706                     DC-GREG-DATE-1-YMD.
  3707             20  DC-YMD-YEAR           PIC 99.
  3708             20  DC-YMD-MONTH          PIC 99.
  3709             20  DC-YMD-DAY            PIC 99.
  3710         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  3711         16  DC-GREG-DATE-1-MDY-R REDEFINES
  3712                      DC-GREG-DATE-1-MDY.
  3713             20  DC-MDY-MONTH          PIC 99.
  3714             20  DC-MDY-DAY            PIC 99.
  3715             20  DC-MDY-YEAR           PIC 99.
  3716         16  DC-GREG-DATE-1-ALPHA.
  3717             20  DC-ALPHA-MONTH        PIC X(10).
  3718             20  DC-ALPHA-DAY          PIC 99.
  3719             20  FILLER                PIC XX.
  3720             20  DC-ALPHA-CENTURY.
  3721                 24 DC-ALPHA-CEN-N     PIC 99.
  3722             20  DC-ALPHA-YEAR         PIC 99.
  3723         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  3724         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  3725         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  3726         16  DC-JULIAN-DATE            PIC 9(05).
  3727         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  71
* EL689.cbl
  3728                                       PIC 9(05).
  3729         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  3730             20  DC-JULIAN-YEAR        PIC 99.
  3731             20  DC-JULIAN-DAYS        PIC 999.
  3732         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  3733         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  3734         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  3735     12  DATE-CONVERSION-VARIBLES.
  3736         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  3737         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  3738             20  FILLER                PIC 9(3).
  3739             20  HOLD-CEN-1-CCYY.
  3740                 24  HOLD-CEN-1-CC     PIC 99.
  3741                 24  HOLD-CEN-1-YY     PIC 99.
  3742             20  HOLD-CEN-1-MO         PIC 99.
  3743             20  HOLD-CEN-1-DA         PIC 99.
  3744         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  3745             20  HOLD-CEN-1-R-MO       PIC 99.
  3746             20  HOLD-CEN-1-R-DA       PIC 99.
  3747             20  HOLD-CEN-1-R-CCYY.
  3748                 24  HOLD-CEN-1-R-CC   PIC 99.
  3749                 24  HOLD-CEN-1-R-YY   PIC 99.
  3750             20  FILLER                PIC 9(3).
  3751         16  HOLD-CENTURY-1-X.
  3752             20  FILLER                PIC X(3)  VALUE SPACES.
  3753             20  HOLD-CEN-1-X-CCYY.
  3754                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  3755                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  3756             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  3757             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  3758         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  3759             20  HOLD-CEN-1-R-X-MO     PIC XX.
  3760             20  HOLD-CEN-1-R-X-DA     PIC XX.
  3761             20  HOLD-CEN-1-R-X-CCYY.
  3762                 24  HOLD-CEN-1-R-X-CC PIC XX.
  3763                 24  HOLD-CEN-1-R-X-YY PIC XX.
  3764             20  FILLER                PIC XXX.
  3765         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  3766         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  3767         16  DC-JULIAN-DATE-1          PIC 9(07).
  3768         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  3769             20  DC-JULIAN-1-CCYY.
  3770                 24  DC-JULIAN-1-CC    PIC 99.
  3771                 24  DC-JULIAN-1-YR    PIC 99.
  3772             20  DC-JULIAN-DA-1        PIC 999.
  3773         16  DC-JULIAN-DATE-2          PIC 9(07).
  3774         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  3775             20  DC-JULIAN-2-CCYY.
  3776                 24  DC-JULIAN-2-CC    PIC 99.
  3777                 24  DC-JULIAN-2-YR    PIC 99.
  3778             20  DC-JULIAN-DA-2        PIC 999.
  3779         16  DC-GREG-DATE-A-EDIT.
  3780             20  DC-EDITA-MONTH        PIC 99.
  3781             20  SLASHA-1              PIC X VALUE '/'.
  3782             20  DC-EDITA-DAY          PIC 99.
  3783             20  SLASHA-2              PIC X VALUE '/'.
  3784             20  DC-EDITA-CCYY.
  3785                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  72
* EL689.cbl
  3786                 24  DC-EDITA-YEAR     PIC 99.
  3787         16  DC-GREG-DATE-B-EDIT.
  3788             20  DC-EDITB-MONTH        PIC 99.
  3789             20  SLASHB-1              PIC X VALUE '/'.
  3790             20  DC-EDITB-DAY          PIC 99.
  3791             20  SLASHB-2              PIC X VALUE '/'.
  3792             20  DC-EDITB-CCYY.
  3793                 24  DC-EDITB-CENT     PIC 99.
  3794                 24  DC-EDITB-YEAR     PIC 99.
  3795         16  DC-GREG-DATE-CYMD         PIC 9(08).
  3796         16  DC-GREG-DATE-CYMD-R REDEFINES
  3797                              DC-GREG-DATE-CYMD.
  3798             20  DC-CYMD-CEN           PIC 99.
  3799             20  DC-CYMD-YEAR          PIC 99.
  3800             20  DC-CYMD-MONTH         PIC 99.
  3801             20  DC-CYMD-DAY           PIC 99.
  3802         16  DC-GREG-DATE-MDCY         PIC 9(08).
  3803         16  DC-GREG-DATE-MDCY-R REDEFINES
  3804                              DC-GREG-DATE-MDCY.
  3805             20  DC-MDCY-MONTH         PIC 99.
  3806             20  DC-MDCY-DAY           PIC 99.
  3807             20  DC-MDCY-CEN           PIC 99.
  3808             20  DC-MDCY-YEAR          PIC 99.
  3809    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  3810        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  3811    12  DC-EL310-DATE                  PIC X(21).
  3812    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  73
* EL689.cbl
  3814*    COPY ELCNWA.
  3815*****************************************************************
  3816*                                                               *
  3817*                                                               *
  3818*                            ELCNWA.                            *
  3819*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3820*                            VMOD=2.003                         *
  3821*                                                               *
  3822*            M O V E   N A M E   W O R K   A R E A.             *
  3823*                                                               *
  3824*****************************************************************.
  3825
  3826 01  WS-NAME-WORK-AREA.
  3827     05  WS-INSURED-LAST-NAME        PIC X(15).
  3828     05  WS-INSURED-1ST-NAME         PIC X(12).
  3829     05  WS-INSURED-MID-INIT         PIC X.
  3830
  3831     05  WS-NAME-WORK.
  3832         10  WS-NW                   PIC X
  3833             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
  3834
  3835     05  WS-NAME-WORK2.
  3836         10  WS-NW2                  PIC X
  3837             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
  3838                                        NWA-INDEX0.
  3839
  3840     05  WS-NAME-SW                  PIC S9          VALUE ZERO
  3841                                     COMP-3.
  3842
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  74
* EL689.cbl
  3844*    COPY ELCEMIB.
  3845******************************************************************
  3846*                                                                *
  3847*                                                                *
  3848*                            ELCEMIB.                            *
  3849*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3850*                            VMOD=2.005                          *
  3851*                                                                *
  3852*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  3853*                                                                *
  3854******************************************************************
  3855 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  3856     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  3857     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  3858     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  3859     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  3860     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  3861     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  3862     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  3863     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  3864     12  EMI-SWITCH1             PIC X        VALUE '1'.
  3865         88  EMI-NO-ERRORS                    VALUE '1'.
  3866         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  3867         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  3868     12  EMI-SWITCH2             PIC X        VALUE '1'.
  3869         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  3870     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  3871         88  EMI-AREA1-EMPTY                  VALUE '1'.
  3872         88  EMI-AREA1-FULL                   VALUE '2'.
  3873     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  3874         88  EMI-AREA2-EMPTY                  VALUE '1'.
  3875         88  EMI-AREA2-FULL                   VALUE '2'.
  3876     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  3877         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  3878         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  3879         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  3880         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  3881         88  EMI-BYPASS-FATALS                VALUE 'X'.
  3882     12  EMI-ERROR-LINES.
  3883         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  3884         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  3885         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  3886         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  3887             20  EMI-ERR-CODES OCCURS 10 TIMES.
  3888                 24  EMI-ERR-NUM         PIC X(4).
  3889                 24  EMI-FILLER          PIC X.
  3890                 24  EMI-SEV             PIC X.
  3891                 24  FILLER              PIC X.
  3892             20  FILLER                  PIC X(02).
  3893     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  3894         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  3895             20  EMI-ERROR-NUMBER    PIC X(4).
  3896             20  EMI-FILL            PIC X.
  3897             20  EMI-SEVERITY        PIC X.
  3898             20  FILLER              PIC X.
  3899             20  EMI-ERROR-TEXT.
  3900                 24  EMI-TEXT-VARIABLE   PIC X(10).
  3901                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  75
* EL689.cbl
  3902     12  EMI-SEVERITY-SAVE           PIC X.
  3903         88  EMI-NOTE                    VALUE 'N'.
  3904         88  EMI-WARNING                 VALUE 'W'.
  3905         88  EMI-FORCABLE                VALUE 'F'.
  3906         88  EMI-FATAL                   VALUE 'X'.
  3907     12  EMI-MESSAGE-FLAG            PIC X.
  3908         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  3909         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  3910     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  3911     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  3912         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  3913         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  3914         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  3915     12  emi-claim-no                pic x(7).
  3916     12  emi-claim-type              pic x(6).
  3917     12  FILLER                      PIC X(124)  VALUE SPACES.
  3918     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  3919     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  3920     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  3921     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  3922 01  EMI-SAVE-AREA               PIC X(400).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  76
* EL689.cbl
  3924*    COPY ELCLOGOF.
  3925******************************************************************
  3926*                                                                *
  3927*                                                                *
  3928*                            ELCLOGOF.                           *
  3929*                            VMOD=2.001                          *
  3930*                                                                *
  3931*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  3932*                                                                *
  3933******************************************************************
  3934 01  CLASIC-LOGOFF.
  3935     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  3936     12  LOGOFF-TEXT.
  3937         16  FILLER          PIC X(5)    VALUE SPACES.
  3938         16  LOGOFF-MSG.
  3939             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  3940             20  FILLER      PIC X       VALUE SPACES.
  3941             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  3942         16  FILLER          PIC X(80)
  3943           VALUE '* YOU ARE NOW LOGGED OFF'.
  3944         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  3945         16  FILLER          PIC X       VALUE QUOTE.
  3946         16  LOGOFF-SYS-MSG  PIC X(17)
  3947           VALUE 'S CLAS-IC SYSTEM '.
  3948     12  TEXT-MESSAGES.
  3949         16  UNACCESS-MSG    PIC X(29)
  3950             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  3951         16  PGMIDERR-MSG    PIC X(17)
  3952             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  77
* EL689.cbl
  3954*    COPY ELCSCTM.
  3955******************************************************************
  3956*                                                                *
  3957*                                                                *
  3958*                            ELCSCTM                             *
  3959*                            VMOD=2.001                          *
  3960*                                                                *
  3961*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  3962*                                                                *
  3963******************************************************************
  3964 01  SECURITY-MESSAGE.
  3965     12  FILLER                          PIC X(30)
  3966            VALUE '** LOGIC SECURITY VIOLATION -'.
  3967     12  SM-READ                         PIC X(6).
  3968     12  FILLER                          PIC X(5)
  3969            VALUE ' PGM='.
  3970     12  SM-PGM                          PIC X(6).
  3971     12  FILLER                          PIC X(5)
  3972            VALUE ' OPR='.
  3973     12  SM-PROCESSOR-ID                 PIC X(4).
  3974     12  FILLER                          PIC X(6)
  3975            VALUE ' TERM='.
  3976     12  SM-TERMID                       PIC X(4).
  3977     12  FILLER                          PIC XX   VALUE SPACE.
  3978     12  SM-JUL-DATE                     PIC 9(5).
  3979     12  FILLER                          PIC X    VALUE SPACE.
  3980     12  SM-TIME                         PIC 99.99.
  3981
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  78
* EL689.cbl
  3983*    COPY ELCSCRTY.
  3984******************************************************************
  3985*                                                                *
  3986*                                                                *
  3987*                            ELCSCRTY                            *
  3988*                            VMOD=2.001                          *
  3989*                                                                *
  3990*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  3991*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  3992*        SAVED IN PI-SECURITY-ADDRESS.                           *
  3993*                                                                *
  3994******************************************************************
  3995 01  SECURITY-CONTROL.
  3996     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  3997     12  FILLER                       PIC XX    VALUE 'SC'.
  3998     12  SC-CREDIT-CODES.
  3999         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  4000             20  SC-CREDIT-DISPLAY    PIC X.
  4001             20  SC-CREDIT-UPDATE     PIC X.
  4002     12  SC-CLAIMS-CODES.
  4003         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  4004             20  SC-CLAIMS-DISPLAY    PIC X.
  4005             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  79
* EL689.cbl
  4007
  4008 01  W-TS-WORK-AREA              PIC X(3650).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  80
* EL689.cbl
  4010****************************************************************
  4011*
  4012* Copyright (c) 2007-2013 Dell Inc.
  4013* All rights reserved.
  4014*
  4015****************************************************************
  4016 01  DFHEIV.
  4017   02  DFHEIV0               PIC X(35).
  4018   02  DFHEIV1               PIC X(08).
  4019   02  DFHEIV2               PIC X(08).
  4020   02  DFHEIV3               PIC X(08).
  4021   02  DFHEIV4               PIC X(06).
  4022   02  DFHEIV5               PIC X(04).
  4023   02  DFHEIV6               PIC X(04).
  4024   02  DFHEIV7               PIC X(02).
  4025   02  DFHEIV8               PIC X(02).
  4026   02  DFHEIV9               PIC X(01).
  4027   02  DFHEIV10              PIC S9(7) COMP-3.
  4028   02  DFHEIV11              PIC S9(4) COMP SYNC.
  4029   02  DFHEIV12              PIC S9(4) COMP SYNC.
  4030   02  DFHEIV13              PIC S9(4) COMP SYNC.
  4031   02  DFHEIV14              PIC S9(4) COMP SYNC.
  4032   02  DFHEIV15              PIC S9(4) COMP SYNC.
  4033   02  DFHEIV16              PIC S9(9) COMP SYNC.
  4034   02  DFHEIV17              PIC X(04).
  4035   02  DFHEIV18              PIC X(04).
  4036   02  DFHEIV19              PIC X(04).
  4037   02  DFHEIV20              USAGE IS POINTER.
  4038   02  DFHEIV21              USAGE IS POINTER.
  4039   02  DFHEIV22              USAGE IS POINTER.
  4040   02  DFHEIV23              USAGE IS POINTER.
  4041   02  DFHEIV24              USAGE IS POINTER.
  4042   02  DFHEIV25              PIC S9(9) COMP SYNC.
  4043   02  DFHEIV26              PIC S9(9) COMP SYNC.
  4044   02  DFHEIV27              PIC S9(9) COMP SYNC.
  4045   02  DFHEIV28              PIC S9(9) COMP SYNC.
  4046   02  DFHEIV29              PIC S9(9) COMP SYNC.
  4047   02  DFHEIV30              PIC S9(9) COMP SYNC.
  4048   02  DFHEIV31              PIC S9(9) COMP SYNC.
  4049   02  DFHEIV32              PIC S9(4) COMP SYNC.
  4050   02  DFHEIV33              PIC S9(4) COMP SYNC.
  4051   02  DFHEIV34              PIC S9(4) COMP SYNC.
  4052   02  DFHEIV35              PIC S9(4) COMP SYNC.
  4053   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  4054   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  4055   02  FILLER                PIC X(02).
  4056   02  DFHEIV99              PIC X(08) VALUE SPACE.
  4057   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  4058   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  4059   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  4060   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  4061   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  4062   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  4063 LINKAGE  SECTION.
  4064*****************************************************************
  4065*                                                               *
  4066* Copyright (c) 2007-2013 Dell Inc.                             *
  4067* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  81
* EL689.cbl
  4068*                                                               *
  4069*****************************************************************
  4070 01  dfheiblk.
  4071     02  eibtime          pic s9(7) comp-3.
  4072     02  eibdate          pic s9(7) comp-3.
  4073     02  eibtrnid         pic x(4).
  4074     02  eibtaskn         pic s9(7) comp-3.
  4075     02  eibtrmid         pic x(4).
  4076     02  dfheigdi         pic s9(4) comp.
  4077     02  eibcposn         pic s9(4) comp.
  4078     02  eibcalen         pic s9(4) comp.
  4079     02  eibaid           pic x(1).
  4080     02  eibfiller1       pic x(1).
  4081     02  eibfn            pic x(2).
  4082     02  eibfiller2       pic x(2).
  4083     02  eibrcode         pic x(6).
  4084     02  eibfiller3       pic x(2).
  4085     02  eibds            pic x(8).
  4086     02  eibreqid         pic x(8).
  4087     02  eibrsrce         pic x(8).
  4088     02  eibsync          pic x(1).
  4089     02  eibfree          pic x(1).
  4090     02  eibrecv          pic x(1).
  4091     02  eibsend          pic x(1).
  4092     02  eibatt           pic x(1).
  4093     02  eibeoc           pic x(1).
  4094     02  eibfmh           pic x(1).
  4095     02  eibcompl         pic x(1).
  4096     02  eibsig           pic x(1).
  4097     02  eibconf          pic x(1).
  4098     02  eiberr           pic x(1).
  4099     02  eibrldbk         pic x(1).
  4100     02  eiberrcd         pic x(4).
  4101     02  eibsynrb         pic x(1).
  4102     02  eibnodat         pic x(1).
  4103     02  eibfiller5       pic x(2).
  4104     02  eibresp          pic s9(8) comp.
  4105     02  eibresp2         pic s9(8) comp.
  4106     02  dfheigdj         pic s9(4) comp.
  4107     02  dfheigdk         pic s9(4) comp.
  4108 01  DFHCOMMAREA                 PIC X(1024).
  4109 01  var  pic x(30).
  4110
  4111*    COPY ERCACCT.
  4112******************************************************************
  4113*                                                                *
  4114*                                                                *
  4115*                            ERCACCT                             *
  4116*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4117*                            VMOD=2.031                          *
  4118*                                                                *
  4119*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  4120*                                                                *
  4121*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  4122*   VSAM ACCOUNT MASTER FILES.                                   *
  4123*                                                                *
  4124*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  4125*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  82
* EL689.cbl
  4126*   FILE TYPE = VSAM,KSDS                                        *
  4127*   RECORD SIZE = 2000  RECFORM = FIX                            *
  4128*                                                                *
  4129*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  4130*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  4131*                                                                *
  4132*   LOG = NO                                                     *
  4133*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4134*                                                                *
  4135*                                                                *
  4136******************************************************************
  4137*                   C H A N G E   L O G
  4138*
  4139* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4140*-----------------------------------------------------------------
  4141*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4142* EFFECTIVE    NUMBER
  4143*-----------------------------------------------------------------
  4144* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  4145* 092705    2005050300006  PEMA  ADD SPP LEASES
  4146* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  4147* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4148* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  4149* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  4150* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  4151* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  4152******************************************************************
  4153
  4154 01  ACCOUNT-MASTER.
  4155     12  AM-RECORD-ID                      PIC XX.
  4156         88  VALID-AM-ID                      VALUE 'AM'.
  4157
  4158     12  AM-CONTROL-PRIMARY.
  4159         16  AM-COMPANY-CD                 PIC X.
  4160         16  AM-MSTR-CNTRL.
  4161             20  AM-CONTROL-A.
  4162                 24  AM-CARRIER            PIC X.
  4163                 24  AM-GROUPING.
  4164                     28 AM-GROUPING-PREFIX PIC XXX.
  4165                     28 AM-GROUPING-PRIME  PIC XXX.
  4166                 24  AM-STATE              PIC XX.
  4167                 24  AM-ACCOUNT.
  4168                     28  AM-ACCOUNT-PREFIX PIC X(4).
  4169                     28  AM-ACCOUNT-PRIME  PIC X(6).
  4170             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  4171                                           PIC X(19).
  4172             20  AM-CNTRL-B.
  4173                 24  AM-EXPIRATION-DT      PIC XX.
  4174                 24  FILLER                PIC X(4).
  4175             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  4176                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  4177
  4178     12  AM-CONTROL-BY-VAR-GRP.
  4179         16  AM-COMPANY-CD-A1              PIC X.
  4180         16  AM-VG-CARRIER                 PIC X.
  4181         16  AM-VG-GROUPING                PIC X(6).
  4182         16  AM-VG-STATE                   PIC XX.
  4183         16  AM-VG-ACCOUNT                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  83
* EL689.cbl
  4184         16  AM-VG-DATE.
  4185             20  AM-VG-EXPIRATION-DT       PIC XX.
  4186             20  FILLER                    PIC X(4).
  4187         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  4188                                           PIC 9(11)      COMP-3.
  4189     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  4190         16  FILLER                        PIC X(10).
  4191         16  AM-VG-KEY3.
  4192             20  AM-VG3-ACCOUNT            PIC X(10).
  4193             20  AM-VG3-EXP-DT             PIC XX.
  4194         16  FILLER                        PIC X(4).
  4195     12  AM-MAINT-INFORMATION.
  4196         16  AM-LAST-MAINT-DT              PIC XX.
  4197         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  4198         16  AM-LAST-MAINT-USER            PIC X(4).
  4199         16  FILLER                        PIC XX.
  4200
  4201     12  AM-EFFECTIVE-DT                   PIC XX.
  4202     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  4203
  4204     12  AM-PREV-DATES  COMP-3.
  4205         16  AM-PREV-EXP-DT                PIC 9(11).
  4206         16  AM-PREV-EFF-DT                PIC 9(11).
  4207
  4208     12  AM-REPORT-CODE-1                  PIC X(10).
  4209     12  AM-REPORT-CODE-2                  PIC X(10).
  4210
  4211     12  AM-CITY-CODE                      PIC X(4).
  4212     12  AM-COUNTY-PARISH                  PIC X(6).
  4213
  4214     12  AM-NAME                           PIC X(30).
  4215     12  AM-PERSON                         PIC X(30).
  4216     12  AM-ADDRS                          PIC X(30).
  4217     12  AM-CITY.
  4218         16  AM-ADDR-CITY                  PIC X(28).
  4219         16  AM-ADDR-STATE                 PIC XX.
  4220     12  AM-ZIP.
  4221         16  AM-ZIP-PRIME.
  4222             20  AM-ZIP-PRI-1ST            PIC X.
  4223                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  4224             20  FILLER                    PIC X(4).
  4225         16  AM-ZIP-PLUS4                  PIC X(4).
  4226     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  4227         16  AM-CAN-POSTAL-1               PIC XXX.
  4228         16  AM-CAN-POSTAL-2               PIC XXX.
  4229         16  FILLER                        PIC XXX.
  4230     12  AM-TEL-NO.
  4231         16  AM-AREA-CODE                  PIC 999.
  4232         16  AM-TEL-PRE                    PIC 999.
  4233         16  AM-TEL-NBR                    PIC 9(4).
  4234     12  AM-TEL-LOC                        PIC X.
  4235         88  AM-TEL-AT-HOME                   VALUE 'H'.
  4236         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  4237
  4238     12  AM-COMM-STRUCTURE.
  4239         16  AM-DEFN-1.
  4240             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  4241                 24  AM-AGT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  84
* EL689.cbl
  4242                     28  AM-AGT-PREFIX     PIC X(4).
  4243                     28  AM-AGT-PRIME      PIC X(6).
  4244                 24  AM-COM-TYP            PIC X.
  4245                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  4246                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  4247                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  4248                 24  AM-RECALC-LV-INDIC    PIC X.
  4249                 24  AM-RETRO-LV-INDIC     PIC X.
  4250                 24  AM-GL-CODES           PIC X.
  4251                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  4252                 24  FILLER                PIC X(01).
  4253         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  4254             20  AM-COM-TBLS        OCCURS 10 TIMES.
  4255                 24  FILLER                PIC X(11).
  4256                 24  AM-L-COMA             PIC XXX.
  4257                 24  AM-J-COMA             PIC XXX.
  4258                 24  AM-A-COMA             PIC XXX.
  4259                 24  FILLER                PIC X(6).
  4260
  4261     12  AM-COMM-CHANGE-STATUS             PIC X.
  4262         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  4263
  4264     12  AM-CSR-CODE                       PIC X(4).
  4265
  4266     12  AM-BILLING-STATUS                 PIC X.
  4267         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  4268         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  4269     12  AM-AUTO-REFUND-SW                 PIC X.
  4270         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  4271         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  4272     12  AM-GPCD                           PIC 99.
  4273     12  AM-IG                             PIC X.
  4274         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  4275         88  AM-HAS-GROUP                     VALUE '2'.
  4276     12  AM-STATUS                         PIC X.
  4277         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  4278         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  4279         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  4280         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  4281         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  4282         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  4283         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  4284         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  4285         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  4286         88  AM-ACCOUNT-PENDING               VALUE '9'.
  4287     12  AM-REMIT-TO                       PIC 99.
  4288     12  AM-ID-NO                          PIC X(11).
  4289
  4290     12  AM-CAL-TABLE                      PIC XX.
  4291     12  AM-LF-DEVIATION                   PIC XXX.
  4292     12  AM-AH-DEVIATION                   PIC XXX.
  4293     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4294     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  4295     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  4296     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  4297     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4298     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  4299
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  85
* EL689.cbl
  4300     12  AM-USER-FIELDS.
  4301         16  AM-FLD-1                      PIC XX.
  4302         16  AM-FLD-2                      PIC XX.
  4303         16  AM-FLD-3                      PIC XX.
  4304         16  AM-FLD-4                      PIC XX.
  4305         16  AM-FLD-5                      PIC XX.
  4306
  4307     12  AM-1ST-PROD-DATE.
  4308         16  AM-1ST-PROD-YR                PIC XX.
  4309         16  AM-1ST-PROD-MO                PIC XX.
  4310         16  AM-1ST-PROD-DA                PIC XX.
  4311     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  4312     12  AM-CERTS-PURGED-DATE.
  4313         16  AM-PUR-YR                     PIC XX.
  4314         16  AM-PUR-MO                     PIC XX.
  4315         16  AM-PUR-DA                     PIC XX.
  4316     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  4317     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  4318     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  4319     12  AM-INACTIVE-DATE.
  4320         16  AM-INA-MO                     PIC 99.
  4321         16  AM-INA-DA                     PIC 99.
  4322         16  AM-INA-YR                     PIC 99.
  4323     12  AM-AR-HI-CERT-DATE                PIC XX.
  4324
  4325     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4326     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  4327
  4328     12  AM-OB-PAYMENT-MODE                PIC X.
  4329         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  4330         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  4331         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  4332         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  4333
  4334     12  AM-AH-ONLY-INDICATOR              PIC X.
  4335         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  4336         88  AM-NO-AH-ONLY                    VALUE 'N'.
  4337
  4338     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  4339
  4340     12  AM-OVER-SHORT.
  4341         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  4342         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  4343
  4344     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  4345     12  AM-DCC-CLP-STATE                  PIC XX.
  4346
  4347     12  AM-RECALC-COMM                    PIC X.
  4348     12  AM-RECALC-REIN                    PIC X.
  4349
  4350     12  AM-REI-TABLE                      PIC XXX.
  4351     12  AM-REI-ET-LF                      PIC X.
  4352     12  AM-REI-ET-AH                      PIC X.
  4353     12  AM-REI-PE-LF                      PIC X.
  4354     12  AM-REI-PE-AH                      PIC X.
  4355     12  AM-REI-PRT-ST                     PIC X.
  4356     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  4357     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  86
* EL689.cbl
  4358     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  4359     12  AM-REI-GROUP-A                    PIC X(6).
  4360     12  AM-REI-MORT                       PIC X(4).
  4361     12  AM-REI-PRT-OW                     PIC X.
  4362     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  4363     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  4364     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  4365     12  AM-REI-GROUP-B                    PIC X(6).
  4366
  4367     12  AM-TRUST-TYPE                     PIC X(2).
  4368
  4369     12  AM-EMPLOYER-STMT-USED             PIC X.
  4370     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  4371
  4372     12  AM-STD-AH-TYPE                    PIC XX.
  4373     12  AM-EARN-METHODS.
  4374         16  AM-EARN-METHOD-R              PIC X.
  4375             88 AM-REF-RL-R78                 VALUE 'R'.
  4376             88 AM-REF-RL-PR                  VALUE 'P'.
  4377             88 AM-REF-RL-MEAN                VALUE 'M'.
  4378             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  4379         16  AM-EARN-METHOD-L              PIC X.
  4380             88 AM-REF-LL-R78                 VALUE 'R'.
  4381             88 AM-REF-LL-PR                  VALUE 'P'.
  4382             88 AM-REF-LL-MEAN                VALUE 'M'.
  4383             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  4384         16  AM-EARN-METHOD-A              PIC X.
  4385             88 AM-REF-AH-R78                 VALUE 'R'.
  4386             88 AM-REF-AH-PR                  VALUE 'P'.
  4387             88 AM-REF-AH-MEAN                VALUE 'M'.
  4388             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  4389             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  4390             88 AM-REF-AH-NET                 VALUE 'N'.
  4391
  4392     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  4393     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  4394     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  4395
  4396     12  AM-RET-Y-N                        PIC X.
  4397     12  AM-RET-P-E                        PIC X.
  4398     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  4399     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  4400     12  AM-RET-GRP                        PIC X(6).
  4401     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  4402         16  AM-POOL-PRIME                 PIC XXX.
  4403         16  AM-POOL-SUB                   PIC XXX.
  4404     12  AM-RETRO-EARNINGS.
  4405         16  AM-RET-EARN-R                 PIC X.
  4406         16  AM-RET-EARN-L                 PIC X.
  4407         16  AM-RET-EARN-A                 PIC X.
  4408     12  AM-RET-ST-TAX-USE                 PIC X.
  4409         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  4410         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  4411     12  AM-RETRO-BEG-EARNINGS.
  4412         16  AM-RET-BEG-EARN-R             PIC X.
  4413         16  AM-RET-BEG-EARN-L             PIC X.
  4414         16  AM-RET-BEG-EARN-A             PIC X.
  4415     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  87
* EL689.cbl
  4416     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  4417
  4418     12  AM-USER-SELECT-OPTIONS.
  4419         16  AM-USER-SELECT-1              PIC X(10).
  4420         16  AM-USER-SELECT-2              PIC X(10).
  4421         16  AM-USER-SELECT-3              PIC X(10).
  4422         16  AM-USER-SELECT-4              PIC X(10).
  4423         16  AM-USER-SELECT-5              PIC X(10).
  4424
  4425     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4426
  4427     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  4428
  4429     12  AM-RPT045A-SWITCH                 PIC X.
  4430         88  RPT045A-OFF                   VALUE 'N'.
  4431
  4432     12  AM-INSURANCE-LIMITS.
  4433         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  4434         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  4435
  4436     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  4437         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  4438
  4439     12  AM-DISMBR-COVERAGE-SW             PIC X.
  4440         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  4441         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  4442
  4443     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  4444
  4445     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  4446     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  4447     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  4448     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  4449     12  AM-DCC-UEF-STATE                  PIC XX.
  4450     12  FILLER                            PIC XXX.
  4451     12  AM-REPORT-CODE-3                  PIC X(10).
  4452*    12  FILLER                            PIC X(22).
  4453
  4454     12  AM-RESERVE-DATE.
  4455         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  4456         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  4457         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  4458
  4459     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  4460     12  AM-NOTIFICATION-TYPES.
  4461         16  AM-NOTIF-OF-LETTERS           PIC X.
  4462         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  4463         16  AM-NOTIF-OF-REPORTS           PIC X.
  4464         16  AM-NOTIF-OF-STATUS            PIC X.
  4465
  4466     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  4467         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  4468         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  4469         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  4470         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  4471
  4472     12  AM-BENEFIT-CONTROLS.
  4473         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  88
* EL689.cbl
  4474             20  AM-BENEFIT-CODE           PIC XX.
  4475             20  AM-BENEFIT-TYPE           PIC X.
  4476             20  AM-BENEFIT-REVISION       PIC XXX.
  4477             20  AM-BENEFIT-REM-TERM       PIC X.
  4478             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  4479             20  FILLER                    PIC XX.
  4480         16  FILLER                        PIC X(80).
  4481
  4482     12  AM-TRANSFER-DATA.
  4483         16  AM-TRANSFERRED-FROM.
  4484             20  AM-TRNFROM-CARRIER        PIC X.
  4485             20  AM-TRNFROM-GROUPING.
  4486                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  4487                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  4488             20  AM-TRNFROM-STATE          PIC XX.
  4489             20  AM-TRNFROM-ACCOUNT.
  4490                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  4491                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  4492             20  AM-TRNFROM-DTE            PIC XX.
  4493         16  AM-TRANSFERRED-TO.
  4494             20  AM-TRNTO-CARRIER          PIC X.
  4495             20  AM-TRNTO-GROUPING.
  4496                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  4497                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  4498             20  AM-TRNTO-STATE            PIC XX.
  4499             20  AM-TRNTO-ACCOUNT.
  4500                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  4501                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  4502             20  AM-TRNTO-DTE              PIC XX.
  4503         16  FILLER                        PIC X(10).
  4504
  4505     12  AM-SAVED-REMIT-TO                 PIC 99.
  4506
  4507     12  AM-COMM-STRUCTURE-SAVED.
  4508         16  AM-DEFN-1-SAVED.
  4509             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  4510                 24  AM-AGT-SV             PIC X(10).
  4511                 24  AM-COM-TYP-SV         PIC X.
  4512                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  4513                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  4514                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  4515                 24  AM-RECALC-LV-INDIC-SV PIC X.
  4516                 24  FILLER                PIC X.
  4517                 24  AM-GL-CODES-SV        PIC X.
  4518                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  4519                 24  FILLER                PIC X.
  4520         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  4521             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  4522                 24  FILLER                PIC X(11).
  4523                 24  AM-L-COMA-SV          PIC XXX.
  4524                 24  AM-J-COMA-SV          PIC XXX.
  4525                 24  AM-A-COMA-SV          PIC XXX.
  4526                 24  FILLER                PIC X(6).
  4527
  4528     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  4529         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  4530            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  4531            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  89
* EL689.cbl
  4532            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  4533
  4534     12  AM-ORIG-DEALER-NO                 PIC X(10).
  4535     12  FILLER                            PIC X(120).
  4536
  4537     12  AM-ACCOUNT-EXECUTIVE-DATA.
  4538         16  AM-CONTROL-NAME               PIC X(30).
  4539         16  AM-EXECUTIVE-ONE.
  4540             20  AM-EXEC1-NAME             PIC X(15).
  4541             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  4542                                                          COMP-3.
  4543             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  4544                                                          COMP-3.
  4545         16  AM-EXECUTIVE-TWO.
  4546             20  AM-EXEC2-NAME             PIC X(15).
  4547             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  4548                                                          COMP-3.
  4549             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  4550                                                          COMP-3.
  4551
  4552     12  AM-RETRO-ADDITIONAL-DATA.
  4553         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  4554         16  AM-RETRO-PREM-P-E             PIC X.
  4555         16  AM-RETRO-CLMS-P-I             PIC X.
  4556         16  AM-RETRO-RET-BRACKET-LF.
  4557             20  AM-RETRO-RET-METHOD-LF    PIC X.
  4558                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  4559                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  4560             20  AM-RETRO-RET-BASIS-LF     PIC X.
  4561                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  4562                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  4563             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  4564                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  4565                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  4566         16  AM-RETRO-RET-BRACKET-AH.
  4567             20  AM-RETRO-RET-METHOD-AH    PIC X.
  4568                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  4569                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  4570                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  4571             20  AM-RETRO-RET-BASIS-AH     PIC X.
  4572                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  4573                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  4574             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  4575                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  4576                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  4577
  4578     12  AM-COMMENTS.
  4579         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  4580
  4581     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  4582         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  4583         16  AM-FLI-BILLING-CODE           PIC X.
  4584         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  4585         16  AM-FLI-UNITED-IDENT           PIC X.
  4586         16  AM-FLI-INTEREST-LOST-DATA.
  4587             20  AM-FLI-BANK-NO            PIC X(5).
  4588             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  4589             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  90
* EL689.cbl
  4590             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  4591         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  4592             20  AM-FLI-AGT                PIC X(9).
  4593             20  AM-FLI-AGT-COMM-ACC       PIC X.
  4594             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  4595         16  FILLER                        PIC X(102).
  4596
  4597     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  4598         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  4599             20  AM-BENEFIT-DMD-CODE         PIC XX.
  4600             20  AM-BENEFIT-DMD-TYPE         PIC X.
  4601             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  4602             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  4603             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  4604         16  FILLER                          PIC X(10).
  4605******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  91
* EL689.cbl
  4607*    COPY ERCARCH.
  4608******************************************************************
  4609*                                                                *
  4610*                            ERCARCH.                            *
  4611*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4612*                            VMOD=2.002                          *
  4613*                                                                *
  4614*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  4615*                                                                *
  4616*   FILE TYPE = VSAM,KSDS                                        *
  4617*   RECORD SIZE = 250  RECFORM = FIXED                           *
  4618*                                                                *
  4619*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  4620*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  4621*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  4622*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  4623*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  4624*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  4625*                                                                *
  4626*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4627******************************************************************
  4628*                   C H A N G E   L O G
  4629*
  4630* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4631*-----------------------------------------------------------------
  4632*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4633* EFFECTIVE    NUMBER
  4634*-----------------------------------------------------------------
  4635* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  4636* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4637* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4638* 102918  CR2018080300002  PEMA  ADD ONBASE STUFF
  4639******************************************************************
  4640 01  LETTER-ARCHIVE.
  4641     12  LA-RECORD-ID                PIC  X(02).
  4642         88  LA-VALID-ID                VALUE 'LA'.
  4643
  4644     12  LA-CONTROL-PRIMARY.
  4645         16  LA-COMPANY-CD           PIC  X(01).
  4646         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  4647
  4648     12  LA-CONTROL-BY-CERT-RESP.
  4649         16  LA-COMPANY-CD-A2        PIC  X(01).
  4650         16  LA-CERT-NO-A2.
  4651             20  LA-CERT-PRIME-A2    PIC  X(10).
  4652             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  4653         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  4654             20  LA-RESP-PERSON-A2   PIC  X(10).
  4655             20  LA-TYPE-A2          PIC  X(01).
  4656         16  LA-CARRIER-A2           PIC  X(01).
  4657         16  LA-GROUPING-A2          PIC  X(06).
  4658         16  LA-STATE-A2             PIC  X(02).
  4659         16  LA-ACCOUNT-A2           PIC  X(10).
  4660         16  LA-EFFECT-DATE-A2       PIC  X(02).
  4661         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  4662
  4663     12  LA-CONTROL-BY-FORM.
  4664         16  LA-COMPANY-CD-A3        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  92
* EL689.cbl
  4665         16  LA-FORM-A3              PIC  X(04).
  4666         16  LA-CARRIER-A3           PIC  X(01).
  4667         16  LA-GROUPING-A3          PIC  X(06).
  4668         16  LA-STATE-A3             PIC  X(02).
  4669         16  LA-ACCOUNT-A3           PIC  X(10).
  4670         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  4671
  4672     12  LA-CONTROL-BY-PROCESSOR.
  4673         16  LA-COMPANY-CD-A4        PIC  X(01).
  4674         16  LA-PROCESSOR-CD         PIC  X(04).
  4675         16  LA-CARRIER-A4           PIC  X(01).
  4676         16  LA-GROUPING-A4          PIC  X(06).
  4677         16  LA-STATE-A4             PIC  X(02).
  4678         16  LA-ACCOUNT-A4           PIC  X(10).
  4679         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  4680
  4681     12  LA-CONTROL-BY-KEY-FIELDS.
  4682         16  LA-COMPANY-CD-A5        PIC  X(01).
  4683         16  LA-CARRIER-A5           PIC  X(01).
  4684         16  LA-GROUPING-A5          PIC  X(06).
  4685         16  LA-STATE-A5             PIC  X(02).
  4686         16  LA-ACCOUNT-A5           PIC  X(10).
  4687         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  4688
  4689     12  LA-CONTROL-BY-GROUP-CODE.
  4690         16  LA-COMPANY-CD-A6        PIC  X(01).
  4691         16  LA-ENTRY-A6.
  4692             20  LA-FILLER           PIC  X(02).
  4693             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  4694         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  4695
  4696     12  FILLER                      PIC  X(09).
  4697
  4698     12  LA-HEADER-RECORD.
  4699         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  4700         16  LA-CREATION-DATE        PIC  X(02).
  4701         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  4702         16  LA-FINAL-ACT-DATE       REDEFINES
  4703               LA-FOLLOW-UP-DATE     PIC  X(02).
  4704         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  4705         16  LA-NO-OF-COPIES         PIC S9(01).
  4706         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  4707         16  LA-REPLY-DATE           PIC  X(02).
  4708         16  LA-RESEND-DATES.
  4709             20  LA-RESEND-DATE      PIC  X(02).
  4710             20  LA-SENT-DATE        PIC  X(02).
  4711             20  FILLER              PIC  X(08).
  4712         16  LA-SOURCE-INFORMATION.
  4713             20  LA-DATA-SOURCE      PIC  X(01).
  4714             20  LA-ADDR-SOURCE      PIC  X(01).
  4715         16  LA-STATUS               PIC  X(01).
  4716             88  LA-STATUS-ACTIVE         VALUE 'A'.
  4717             88  LA-STATUS-COMPLETED      VALUE 'C'.
  4718             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  4719             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  4720             88  LA-STATUS-PURGED         VALUE 'P'.
  4721             88  LA-STATUS-VOIDED         VALUE 'V'.
  4722         16  LA-LAST-RESENT-PRINT-DATE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  93
* EL689.cbl
  4723                                     PIC  X(02).
  4724         16  LA-PRINT-RESTRICTION    PIC  X(01).
  4725             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4726                                          VALUE 'C'.
  4727             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4728                                          VALUE 'F'.
  4729             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4730                                          VALUE 'P'.
  4731         16  LA-PURGED-DATE          PIC  X(02).
  4732         16  LA-VOIDED-DATE          PIC  X(02).
  4733         16  LA-RESEND-LETR          PIC  X(4).
  4734         16  LA-VOID-ONBASE-YN       PIC  X.
  4735         16  LA-ONBASE-UNIQUE-ID     PIC S9(5) COMP-3.
  4736         16  FILLER                  PIC  X(04).
  4737*        16  LA-RESEND-LETR-2        PIC  X(4).
  4738*        16  LA-RESEND-LETR-3        PIC  X(4).
  4739*        16  FILLER                  PIC  X(59).
  4740         16  LA-ARCHIVE-STATUS       PIC  X.
  4741             88  LA-TEMP                VALUE 'T'.
  4742             88  LA-QWS                 VALUE 'Q'.
  4743             88  LA-BATCH               VALUE 'B'.
  4744         16  LA-FINAL-ACT-IND        PIC  X(1).
  4745         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  4746         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  4747         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  4748                                     PIC X(4).
  4749         16  FILLER                  PIC  X(42).
  4750*        16  FILLER                  PIC  X(71).
  4751         16  LA-LAST-MAINT-DATE      PIC  X(2).
  4752         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  4753         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  4754                                     PIC  X(4).
  4755         16  LA-LAST-UPDATED-BY      PIC  X(4).
  4756
  4757******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  94
* EL689.cbl
  4759*    COPY ERCARCT.
  4760******************************************************************
  4761*                                                                *
  4762*                            ERCARCT.                            *
  4763*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4764*                            VMOD=2.002                          *
  4765*                                                                *
  4766*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  4767*                                                                *
  4768*   FILE TYPE = VSAM,KSDS                                        *
  4769*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  4770*                                                                *
  4771*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  4772*                                                                *
  4773*   LOG = NO                                                     *
  4774*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4775******************************************************************
  4776*                   C H A N G E   L O G
  4777*
  4778* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4779*-----------------------------------------------------------------
  4780*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4781* EFFECTIVE    NUMBER
  4782*-----------------------------------------------------------------
  4783* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  4784******************************************************************
  4785 01  LETTER-ARCHIVE-TEXT.
  4786     12  LT-RECORD-ID                PIC  X(02).
  4787         88  LT-VALID-ID                VALUE 'LT'.
  4788
  4789     12  LT-CONTROL-PRIMARY.
  4790         16  LT-COMPANY-CD           PIC  X(01).
  4791         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  4792         16  LT-RECORD-TYPE          PIC  X(01).
  4793             88  LT-ADDRESS-DATA        VALUE '1'.
  4794             88  LT-TEXT-DATA           VALUE '2'.
  4795             88  LT-COMMENT-DATA        VALUE '3'.
  4796         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  4797
  4798     12  FILLER                      PIC  X(28).
  4799     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  4800
  4801     12  LT-TEXT-RECORD.
  4802         16  LT-LETTER-TEXT OCCURS 20 TIMES
  4803                            INDEXED BY LT-NDX.
  4804             20  LT-TEXT-LINE        PIC  X(70).
  4805             20  LT-SKIP-CONTROL     PIC  X(02).
  4806                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  4807                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  4808             20  FILLER              PIC  X(08).
  4809
  4810     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  4811         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  4812             20  LT-COMMENT-LINE     PIC X(69).
  4813             20  LT-COMMENT-CHG-DT   PIC X(02).
  4814             20  LT-COMMENT-CHG-BY   PIC X(04).
  4815             20  FILLER              PIC X(05).
  4816
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  95
* EL689.cbl
  4818*    COPY ELCCERT.
  4819******************************************************************
  4820*                                                                *
  4821*                            ELCCERT.                            *
  4822*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4823*                            VMOD=2.013                          *
  4824*                                                                *
  4825*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4826*                                                                *
  4827*   FILE TYPE = VSAM,KSDS                                        *
  4828*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4829*                                                                *
  4830*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4831*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4832*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4833*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4834*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4835*                                                                *
  4836*   LOG = YES                                                    *
  4837*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4838******************************************************************
  4839*                   C H A N G E   L O G
  4840*
  4841* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4842*-----------------------------------------------------------------
  4843*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4844* EFFECTIVE    NUMBER
  4845*-----------------------------------------------------------------
  4846* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4847* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4848* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4849* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4850* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4851* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4852* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4853* 032612  CR2011110200001  PEMA  AHL CHANGES
  4854* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4855* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4856* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4857******************************************************************
  4858
  4859 01  CERTIFICATE-MASTER.
  4860     12  CM-RECORD-ID                      PIC XX.
  4861         88  VALID-CM-ID                      VALUE 'CM'.
  4862
  4863     12  CM-CONTROL-PRIMARY.
  4864         16  CM-COMPANY-CD                 PIC X.
  4865         16  CM-CARRIER                    PIC X.
  4866         16  CM-GROUPING.
  4867             20  CM-GROUPING-PREFIX        PIC X(3).
  4868             20  CM-GROUPING-PRIME         PIC X(3).
  4869         16  CM-STATE                      PIC XX.
  4870         16  CM-ACCOUNT.
  4871             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4872             20  CM-ACCOUNT-PRIME          PIC X(6).
  4873         16  CM-CERT-EFF-DT                PIC XX.
  4874         16  CM-CERT-NO.
  4875             20  CM-CERT-PRIME             PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  96
* EL689.cbl
  4876             20  CM-CERT-SFX               PIC X.
  4877
  4878     12  CM-CONTROL-BY-NAME.
  4879         16  CM-COMPANY-CD-A1              PIC X.
  4880         16  CM-INSURED-LAST-NAME          PIC X(15).
  4881         16  CM-INSURED-INITIALS.
  4882             20  CM-INSURED-INITIAL1       PIC X.
  4883             20  CM-INSURED-INITIAL2       PIC X.
  4884
  4885     12  CM-CONTROL-BY-SSN.
  4886         16  CM-COMPANY-CD-A2              PIC X.
  4887         16  CM-SOC-SEC-NO.
  4888             20  CM-SSN-STATE              PIC XX.
  4889             20  CM-SSN-ACCOUNT            PIC X(6).
  4890             20  CM-SSN-LN3.
  4891                 25  CM-INSURED-INITIALS-A2.
  4892                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4893                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4894                 25 CM-PART-LAST-NAME-A2         PIC X.
  4895
  4896     12  CM-CONTROL-BY-CERT-NO.
  4897         16  CM-COMPANY-CD-A4              PIC X.
  4898         16  CM-CERT-NO-A4                 PIC X(11).
  4899
  4900     12  CM-CONTROL-BY-MEMB.
  4901         16  CM-COMPANY-CD-A5              PIC X.
  4902         16  CM-MEMBER-NO.
  4903             20  CM-MEMB-STATE             PIC XX.
  4904             20  CM-MEMB-ACCOUNT           PIC X(6).
  4905             20  CM-MEMB-LN4.
  4906                 25  CM-INSURED-INITIALS-A5.
  4907                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4908                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4909                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4910
  4911     12  CM-INSURED-PROFILE-DATA.
  4912         16  CM-INSURED-FIRST-NAME.
  4913             20  CM-INSURED-1ST-INIT       PIC X.
  4914             20  FILLER                    PIC X(9).
  4915         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4916         16  CM-INSURED-SEX                PIC X.
  4917             88  CM-SEX-MALE                  VALUE 'M'.
  4918             88  CM-SEX-FEMAL                 VALUE 'F'.
  4919         16  CM-INSURED-JOINT-AGE          PIC 99.
  4920         16  CM-JOINT-INSURED-NAME.
  4921             20  CM-JT-LAST-NAME           PIC X(15).
  4922             20  CM-JT-FIRST-NAME.
  4923                 24  CM-JT-1ST-INIT        PIC X.
  4924                 24  FILLER                PIC X(9).
  4925             20  CM-JT-INITIAL             PIC X.
  4926
  4927     12  CM-LIFE-DATA.
  4928         16  CM-LF-BENEFIT-CD              PIC XX.
  4929         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4930         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4931         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4932         16  CM-LF-DEV-CODE                PIC XXX.
  4933         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  97
* EL689.cbl
  4934         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4935         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4936         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4937         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4938         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4939         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4940         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4941         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4942         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4943         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4944         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4945         16  cm-temp-epiq                  pic xx.
  4946             88  EPIQ-CLASS                  value 'EQ'.
  4947*        16  FILLER                        PIC XX.
  4948
  4949     12  CM-AH-DATA.
  4950         16  CM-AH-BENEFIT-CD              PIC XX.
  4951         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4952         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4953         16  CM-AH-DEV-CODE                PIC XXX.
  4954         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4955         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4956         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4957         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4958         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4959         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4960         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4961         16  CM-AH-PAID-THRU-DT            PIC XX.
  4962             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4963         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4964         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4965         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4966         16  FILLER                        PIC X.
  4967
  4968     12  CM-LOAN-INFORMATION.
  4969         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4970         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4971                                           PIC S9(5)V99  COMP-3.
  4972         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4973         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4974         16  CM-PAY-FREQUENCY              PIC S99.
  4975         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4976         16  CM-RATE-CLASS                 PIC XX.
  4977         16  CM-BENEFICIARY                PIC X(25).
  4978         16  CM-POLICY-FORM-NO             PIC X(12).
  4979         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4980         16  CM-LAST-ADD-ON-DT             PIC XX.
  4981         16  CM-DEDUCTIBLE-AMOUNTS.
  4982             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4983             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4984         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4985             20  CM-RESIDENT-STATE         PIC XX.
  4986             20  CM-RATE-CODE              PIC X(4).
  4987             20  FILLER                    PIC XX.
  4988         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4989             20  CM-LOAN-OFFICER           PIC X(5).
  4990             20  FILLER                    PIC XXX.
  4991         16  CM-CSR-CODE                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  98
* EL689.cbl
  4992         16  CM-UNDERWRITING-CODE          PIC X.
  4993             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4994         16  CM-POST-CARD-IND              PIC X.
  4995         16  CM-REF-INTERFACE-SW           PIC X.
  4996         16  CM-PREMIUM-TYPE               PIC X.
  4997             88  CM-SING-PRM                  VALUE '1'.
  4998             88  CM-O-B-COVERAGE              VALUE '2'.
  4999             88  CM-OPEN-END                  VALUE '3'.
  5000         16  CM-IND-GRP-TYPE               PIC X.
  5001             88  CM-INDIVIDUAL                VALUE 'I'.
  5002             88  CM-GROUP                     VALUE 'G'.
  5003         16  CM-SKIP-CODE                  PIC X.
  5004             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5005             88  SKIP-JULY                    VALUE '1'.
  5006             88  SKIP-AUGUST                  VALUE '2'.
  5007             88  SKIP-SEPTEMBER               VALUE '3'.
  5008             88  SKIP-JULY-AUG                VALUE '4'.
  5009             88  SKIP-AUG-SEPT                VALUE '5'.
  5010             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5011             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5012             88  SKIP-JUNE                    VALUE '8'.
  5013             88  SKIP-JUNE-JULY               VALUE '9'.
  5014             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5015             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5016         16  CM-PAYMENT-MODE               PIC X.
  5017             88  PAY-MONTHLY                  VALUE SPACE.
  5018             88  PAY-WEEKLY                   VALUE '1'.
  5019             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5020             88  PAY-BI-WEEKLY                VALUE '3'.
  5021             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5022         16  CM-LOAN-NUMBER                PIC X(8).
  5023         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5024         16  CM-OLD-LOF                    PIC XXX.
  5025*        16  CM-LOAN-OFFICER               PIC XXX.
  5026         16  CM-REIN-TABLE                 PIC XXX.
  5027         16  CM-SPECIAL-REIN-CODE          PIC X.
  5028         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5029         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5030         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5031
  5032     12  CM-STATUS-DATA.
  5033         16  CM-ENTRY-STATUS               PIC X.
  5034         16  CM-ENTRY-DT                   PIC XX.
  5035
  5036         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5037         16  CM-LF-CANCEL-DT               PIC XX.
  5038         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5039
  5040         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5041         16  CM-LF-DEATH-DT                PIC XX.
  5042         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5043
  5044         16  CM-LF-CURRENT-STATUS          PIC X.
  5045             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5046                                                'M' '4' '5' '9'.
  5047             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5048             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5049             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  99
* EL689.cbl
  5050             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5051             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5052             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  5053             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5054             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5055             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5056             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5057             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  5058             88  CM-LF-DECLINED               VALUE 'D'.
  5059             88  CM-LF-VOIDED                 VALUE 'V'.
  5060
  5061         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5062         16  CM-AH-CANCEL-DT               PIC XX.
  5063         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5064
  5065         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5066         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5067         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5068
  5069         16  CM-AH-CURRENT-STATUS          PIC X.
  5070             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5071                                                'M' '4' '5' '9'.
  5072             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5073             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5074             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5075             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5076             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5077             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  5078             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5079             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5080             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5081             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5082             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5083             88  CM-AH-DECLINED               VALUE 'D'.
  5084             88  CM-AH-VOIDED                 VALUE 'V'.
  5085
  5086         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5087             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5088             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5089             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5090         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5091
  5092         16  CM-ENTRY-BATCH                PIC X(6).
  5093         16  CM-LF-EXIT-BATCH              PIC X(6).
  5094         16  CM-AH-EXIT-BATCH              PIC X(6).
  5095         16  CM-LAST-MONTH-END             PIC XX.
  5096
  5097     12  CM-NOTE-SW                        PIC X.
  5098         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5099         88  CERT-NOTES-PRESENT               VALUE '1'.
  5100         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5101         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5102         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5103         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5104         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5105         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5106     12  CM-COMP-EXCP-SW                   PIC X.
  5107         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 100
* EL689.cbl
  5108         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5109     12  CM-INSURED-ADDRESS-SW             PIC X.
  5110         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5111         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5112
  5113*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5114     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5115     12  FILLER                            PIC X.
  5116
  5117*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5118     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5119     12  FILLER                            PIC X.
  5120*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5121     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  5122
  5123     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5124         88  CERT-ADDED-BATCH                 VALUE ' '.
  5125         88  CERT-ADDED-ONLINE                VALUE '1'.
  5126         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5127         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5128         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5129     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5130         88  CERT-AS-LOADED                   VALUE ' '.
  5131         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5132         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5133         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5134         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5135         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5136         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5137         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5138
  5139     12  CM-ACCOUNT-COMM-PCTS.
  5140         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5141         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5142
  5143     12  CM-USER-FIELD                     PIC X.
  5144     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5145     12  CM-CLP-STATE                      PIC XX.
  5146     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  5147     12  CM-USER-RESERVED                  PIC XXX.
  5148     12  FILLER REDEFINES CM-USER-RESERVED.
  5149         16  CM-AH-CLASS-CD                PIC XX.
  5150         16  F                             PIC X.
  5151******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 101
* EL689.cbl
  5153*    COPY ERCCHEK.
  5154******************************************************************
  5155*                                                                *
  5156*                                                                *
  5157*                            ERCCHEK                             *
  5158*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5159*                            VMOD=2.008                          *
  5160*                                                                *
  5161*   FILE DESCRIPTION = CHECK RECORDS                             *
  5162*                                                                *
  5163*   FILE TYPE = VSAM,KSDS                                        *
  5164*   RECORD SIZE = 600    RECFORM = FIXED                         *
  5165*                                                                *
  5166*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  5167*       ALTERNATE INDEX = NONE                                   *
  5168*                                                                *
  5169*   LOG = YES                                                    *
  5170*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5171******************************************************************
  5172*                   C H A N G E   L O G
  5173*
  5174* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5175*-----------------------------------------------------------------
  5176*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5177* EFFECTIVE    NUMBER
  5178*-----------------------------------------------------------------
  5179* 021414    2003053000001  PEMA  changes for auto chk request
  5180******************************************************************
  5181 01  CHECK-RECORDS.
  5182     12  CH-RECORD-ID                      PIC XX.
  5183         88  VALID-CH-ID                      VALUE 'CH'.
  5184
  5185     12  CH-CONTROL-PRIMARY.
  5186         16  CH-COMPANY-CD                 PIC X.
  5187         16  CH-CARRIER                    PIC X.
  5188         16  CH-GROUPING                   PIC X(6).
  5189         16  CH-STATE                      PIC XX.
  5190         16  CH-ACCOUNT                    PIC X(10).
  5191         16  CH-CERT-EFF-DT                PIC XX.
  5192         16  CH-CERT-NO.
  5193             20  CH-CERT-PRIME             PIC X(10).
  5194             20  CH-CERT-SFX               PIC X.
  5195         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  5196
  5197     12  CH-RECORDED-DT                    PIC XX.
  5198     12  CH-RECORDED-BY                    PIC X(4).
  5199     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  5200
  5201     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  5202     12  CH-CHECK-NO                       PIC X(7).
  5203     12  CH-REASON-FOR-CHECK               PIC X(25).
  5204     12  CH-CHECK-WRITTEN-DT               PIC XX.
  5205     12  FILLER                            PIC X.
  5206
  5207     12  CH-PAYEE-INFO.
  5208         16  CH-PAYEE-NAME-1               PIC X(30).
  5209         16  CH-PAYEE-NAME-2               PIC X(30).
  5210         16  CH-PAYEE-ADDRESS-1            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 102
* EL689.cbl
  5211         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  5212         16  CH-PAYEE-CITY-ST.
  5213             20  CH-PAYEE-CITY             PIC X(28).
  5214             20  CH-PAYEE-STATE            PIC XX.
  5215         16  CH-PAYEE-ZIP-CODE.
  5216             20  CH-PAYEE-ZIP.
  5217                 24  CH-ZIP-PRI-1ST        PIC X.
  5218                     88  CH-CANADIAN-POST-CODE
  5219                                           VALUES 'A' THRU 'Z'.
  5220                 24  FILLER                PIC X(4).
  5221             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  5222         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  5223             20  CH-CAN-POSTAL-1           PIC XXX.
  5224             20  CH-CAN-POSTAL-2           PIC XXX.
  5225             20  FILLER                    PIC XXX.
  5226
  5227     12  CH-CHECK-STUB-TEXT.
  5228         16  CH-STUB-LINE-1                PIC X(30).
  5229         16  CH-TEXT-LINE-1                PIC X(50).
  5230         16  CH-TEXT-LINE-2                PIC X(50).
  5231         16  CH-TEXT-LINE-3                PIC X(40).
  5232     12  CH-RETURN-TO                      PIC X(30).
  5233
  5234     12  CH-COMPENSATION-CONTROL.
  5235         16  CH-COMP-CARRIER               PIC X.
  5236         16  CH-COMP-GROUPING              PIC X(6).
  5237         16  CH-COMP-FIN-RESP              PIC X(10).
  5238         16  CH-COMP-ACCOUNT               PIC X(10).
  5239
  5240     12  CH-CREDIT-SELECT-DT               PIC XX.
  5241     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  5242     12  CH-PAYEE-CODE                     PIC X(6).
  5243
  5244     12  CH-VOID-DATA.
  5245         20  CH-VOID-DT                    PIC XX.
  5246         20  CH-VOID-BY                    PIC X(4).
  5247         20  CH-VOID-REASON                PIC X(25).
  5248
  5249     12  CH-APPROVAL-DATA.
  5250         20  CH-APPROVAL-DT                PIC XX.
  5251         20  CH-APPROVAL-STATUS            PIC X.
  5252             88  CH-IN-LIMBO                  VALUE ' '.
  5253             88  CH-APPROV-PENDING            VALUE 'P' '2'.
  5254             88  CH-APPROVED                  VALUE 'A'.
  5255             88  CH-DENIED                    VALUE 'D'.
  5256         20  CH-APPROVED-BY                PIC XXXX.
  5257     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  5258             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  5259     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  5260
  5261     12  ch-released-dt                    pic xx.
  5262     12  ch-check-cashed-dt                pic xx.
  5263     12  FILLER                            PIC X.
  5264*    12  CH-CHECK-REFERENCE                PIC X(12).
  5265     12  CH-CHECK-ORIGIN-SW                PIC X.
  5266             88  CH-REFUND-CHECK              VALUE 'R'.
  5267             88  CH-MAINT-CHECK               VALUE 'M'.
  5268
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 103
* EL689.cbl
  5269     12  CH-CANC-DT                        PIC XX.
  5270     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  5271     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  5272
  5273     12  CH-INSURED-NAME                   PIC X(28).
  5274
  5275     12  ch-released-by                    pic x(4).
  5276     12  ch-csr                            pic x(4).
  5277     12  ch-deduct-commission              pic x.
  5278         88  ch-deduct-comm                  value 'Y'.
  5279         88  ch-do-not-deduct-comm           value 'N'.
  5280
  5281     12  FILLER                            PIC X(11).
  5282*    12  CH-LETTER-TABLE.
  5283*        16  CH-LETTERS OCCURS 3 TIMES
  5284*                       INDEXED BY CH-LT-NDX
  5285*                                          PIC X(04).
  5286
  5287     12  FILLER                            PIC X(07).
  5288
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 104
* EL689.cbl
  5290*    COPY ELCCNTL.
  5291******************************************************************
  5292*                                                                *
  5293*                                                                *
  5294*                            ELCCNTL.                            *
  5295*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5296*                            VMOD=2.059                          *
  5297*                                                                *
  5298*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  5299*                                                                *
  5300*   FILE TYPE = VSAM,KSDS                                        *
  5301*   RECORD SIZE = 750  RECFORM = FIXED                           *
  5302*                                                                *
  5303*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  5304*       ALTERNATE INDEX = NONE                                   *
  5305*                                                                *
  5306*   LOG = YES                                                    *
  5307*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5308******************************************************************
  5309*                   C H A N G E   L O G
  5310*
  5311* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5312*-----------------------------------------------------------------
  5313*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5314* EFFECTIVE    NUMBER
  5315*-----------------------------------------------------------------
  5316* 082503                   PEMA  ADD BENEFIT GROUP
  5317* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  5318* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  5319* 092705    2005050300006  PEMA  ADD SPP LEASES
  5320* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  5321* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  5322* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  5323* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  5324* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  5325* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  5326* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  5327* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  5328* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  5329* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5330* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  5331******************************************************************
  5332*
  5333 01  CONTROL-FILE.
  5334     12  CF-RECORD-ID                       PIC XX.
  5335         88  VALID-CF-ID                        VALUE 'CF'.
  5336
  5337     12  CF-CONTROL-PRIMARY.
  5338         16  CF-COMPANY-ID                  PIC XXX.
  5339         16  CF-RECORD-TYPE                 PIC X.
  5340             88  CF-COMPANY-MASTER              VALUE '1'.
  5341             88  CF-PROCESSOR-MASTER            VALUE '2'.
  5342             88  CF-STATE-MASTER                VALUE '3'.
  5343             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  5344             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  5345             88  CF-CARRIER-MASTER              VALUE '6'.
  5346             88  CF-MORTALITY-MASTER            VALUE '7'.
  5347             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 105
* EL689.cbl
  5348             88  CF-TERMINAL-MASTER             VALUE '9'.
  5349             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  5350             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  5351             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  5352             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  5353             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  5354             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  5355             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  5356             88  CF-REMINDERS-MASTER            VALUE 'R'.
  5357             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  5358         16  CF-ACCESS-CD-GENL              PIC X(4).
  5359         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  5360             20  CF-PROCESSOR               PIC X(4).
  5361         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  5362             20  CF-STATE-CODE              PIC XX.
  5363             20  FILLER                     PIC XX.
  5364         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  5365             20  FILLER                     PIC XX.
  5366             20  CF-HI-BEN-IN-REC           PIC XX.
  5367         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  5368             20  FILLER                     PIC XXX.
  5369             20  CF-CARRIER-CNTL            PIC X.
  5370         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  5371             20  FILLER                     PIC XX.
  5372             20  CF-HI-TYPE-IN-REC          PIC 99.
  5373         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  5374             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  5375                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  5376             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  5377             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  5378         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  5379             20  FILLER                     PIC X.
  5380             20  CF-CUSTOM-REPORT-NO        PIC 999.
  5381         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  5382             20  FILLER                     PIC XX.
  5383             20  CF-MORTGAGE-PLAN           PIC XX.
  5384         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  5385
  5386     12  CF-LAST-MAINT-DT                   PIC XX.
  5387     12  CF-LAST-MAINT-BY                   PIC X(4).
  5388     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  5389
  5390     12  CF-RECORD-BODY                     PIC X(728).
  5391
  5392
  5393****************************************************************
  5394*             COMPANY MASTER RECORD                            *
  5395****************************************************************
  5396
  5397     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5398         16  CF-COMPANY-ADDRESS.
  5399             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  5400             20  CF-CL-IN-CARE-OF           PIC X(30).
  5401             20  CF-CL-ADDR-LINE-1          PIC X(30).
  5402             20  CF-CL-ADDR-LINE-2          PIC X(30).
  5403             20  CF-CL-CITY-STATE           PIC X(30).
  5404             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  5405             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 106
* EL689.cbl
  5406         16  CF-COMPANY-CD                  PIC X.
  5407         16  CF-COMPANY-PASSWORD            PIC X(8).
  5408         16  CF-SECURITY-OPTION             PIC X.
  5409             88  ALL-SECURITY                   VALUE '1'.
  5410             88  COMPANY-VERIFY                 VALUE '2'.
  5411             88  PROCESSOR-VERIFY               VALUE '3'.
  5412             88  NO-SECURITY                    VALUE '4'.
  5413             88  ALL-BUT-TERM                   VALUE '5'.
  5414         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  5415             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  5416         16  CF-LGX-INTERFACE-CNTL          PIC X.
  5417             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  5418         16  CF-INFORCE-LOCATION            PIC X.
  5419             88  CERTS-ARE-ONLINE               VALUE '1'.
  5420             88  CERTS-ARE-OFFLINE              VALUE '2'.
  5421             88  NO-CERTS-AVAILABLE             VALUE '3'.
  5422         16  CF-LOWER-CASE-LETTERS          PIC X.
  5423         16  CF-CERT-ACCESS-CONTROL         PIC X.
  5424             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  5425             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  5426             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  5427             88  CF-ACCNT-CNTL                  VALUE '3'.
  5428             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  5429
  5430         16  CF-FORMS-PRINTER-ID            PIC X(4).
  5431         16  CF-CHECK-PRINTER-ID            PIC X(4).
  5432
  5433         16  CF-LGX-CREDIT-USER             PIC X.
  5434             88  CO-IS-NOT-USER                 VALUE 'N'.
  5435             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  5436
  5437         16 CF-CREDIT-CALC-CODES.
  5438             20  CF-CR-REM-TERM-CALC PIC X.
  5439               88  CR-EARN-AFTER-15TH           VALUE '1'.
  5440               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  5441               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  5442               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  5443               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  5444               88  CR-EARN-AFTER-14TH           VALUE '6'.
  5445               88  CR-EARN-AFTER-16TH           VALUE '7'.
  5446             20  CF-CR-R78-METHOD           PIC X.
  5447               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  5448               88  DONT-USE-PLUS-ONE            VALUE '1'.
  5449
  5450         16  CF-CLAIM-CONTROL-COUNTS.
  5451             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  5452                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  5453
  5454             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  5455                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  5456
  5457             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  5458                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  5459
  5460             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  5461                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  5462
  5463         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 107
* EL689.cbl
  5464
  5465         16  CF-CO-CALC-QUOTE-TOLERANCE.
  5466             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  5467             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  5468             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  5469             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  5470                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5471                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5472             20  CF-CO-PREM-REJECT-SW       PIC X.
  5473                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  5474                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  5475             20  CF-CO-REF-REJECT-SW        PIC X.
  5476                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  5477                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  5478
  5479         16  CF-CO-REPORTING-DT             PIC XX.
  5480         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  5481         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  5482           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  5483           88  CF-CO-MONTH-END                  VALUE '1'.
  5484
  5485         16  CF-LGX-CLAIM-USER              PIC X.
  5486             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  5487             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  5488
  5489         16  CF-CREDIT-EDIT-CONTROLS.
  5490             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  5491             20  CF-MIN-AGE                 PIC 99.
  5492             20  CF-DEFAULT-AGE             PIC 99.
  5493             20  CF-MIN-TERM                PIC S999      COMP-3.
  5494             20  CF-MAX-TERM                PIC S999      COMP-3.
  5495             20  CF-DEFAULT-SEX             PIC X.
  5496             20  CF-JOINT-AGE-INPUT         PIC X.
  5497                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  5498             20  CF-BIRTH-DATE-INPUT        PIC X.
  5499                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  5500             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  5501                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  5502                 88  CF-ZERO-CARRIER            VALUE '1'.
  5503                 88  CF-ZERO-GROUPING           VALUE '2'.
  5504                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  5505             20  CF-EDIT-SW                 PIC X.
  5506                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  5507             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  5508             20  CF-CR-PR-METHOD            PIC X.
  5509               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  5510               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  5511             20  FILLER                     PIC X.
  5512
  5513         16  CF-CREDIT-MISC-CONTROLS.
  5514             20  CF-REIN-TABLE-SW           PIC X.
  5515                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  5516             20  CF-COMP-TABLE-SW           PIC X.
  5517                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  5518             20  CF-EXPERIENCE-RETENTION-AGE
  5519                                            PIC S9        COMP-3.
  5520             20  CF-CONVERSION-DT           PIC XX.
  5521             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 108
* EL689.cbl
  5522             20  CF-RUN-FREQUENCY-SW        PIC X.
  5523                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  5524                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  5525
  5526             20  CF-CR-CHECK-NO-CONTROL.
  5527                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  5528                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  5529                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  5530                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  5531                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  5532                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  5533
  5534                 24  CF-CR-CHECK-COUNT       REDEFINES
  5535                     CF-CR-CHECK-COUNTER      PIC X(4).
  5536
  5537                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  5538                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  5539
  5540                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  5541                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  5542                 24  CF-MAIL-PROCESSING       PIC X.
  5543                     88  MAIL-PROCESSING          VALUE 'Y'.
  5544
  5545         16  CF-MISC-SYSTEM-CONTROL.
  5546             20  CF-SYSTEM-C                 PIC X.
  5547                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  5548             20  CF-SYSTEM-D                 PIC X.
  5549                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  5550             20  CF-SOC-SEC-NO-SW            PIC X.
  5551                 88  SOC-SEC-NO-USED             VALUE '1'.
  5552             20  CF-MEMBER-NO-SW             PIC X.
  5553                 88  MEMBER-NO-USED              VALUE '1'.
  5554             20  CF-TAX-ID-NUMBER            PIC X(11).
  5555             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  5556             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  5557                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  5558                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  5559                 88  CF-ALL-APPROVED             VALUE 'Y'.
  5560                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  5561             20  CF-SYSTEM-E                 PIC X.
  5562                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  5563
  5564         16  CF-LGX-LIFE-USER               PIC X.
  5565             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  5566             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  5567
  5568         16  CF-CR-MONTH-END-DT             PIC XX.
  5569
  5570         16  CF-FILE-MAINT-DATES.
  5571             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  5572                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  5573             20  CF-LAST-BATCH       REDEFINES
  5574                 CF-LAST-BATCH-NO               PIC X(4).
  5575             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  5576             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  5577             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  5578             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  5579             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 109
* EL689.cbl
  5580             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  5581             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  5582             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  5583             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  5584             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  5585
  5586         16  CF-NEXT-COMPANY-ID             PIC XXX.
  5587         16  FILLER                         PIC X.
  5588
  5589         16  CF-ALT-MORT-CODE               PIC X(4).
  5590         16  CF-MEMBER-CAPTION              PIC X(10).
  5591
  5592         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  5593             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  5594             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  5595             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  5596             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  5597             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  5598
  5599         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  5600
  5601         16  CF-LIFE-OVERRIDE-L1            PIC X.
  5602         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  5603         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  5604         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  5605
  5606         16  CF-AH-OVERRIDE-L1              PIC X.
  5607         16  CF-AH-OVERRIDE-L2              PIC XX.
  5608         16  CF-AH-OVERRIDE-L6              PIC X(6).
  5609         16  CF-AH-OVERRIDE-L12             PIC X(12).
  5610
  5611         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  5612         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  5613
  5614         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  5615         16  CF-AR-LAST-EL860-DT            PIC XX.
  5616         16  CF-MP-MONTH-END-DT             PIC XX.
  5617
  5618         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  5619         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  5620             88  CF-CLAIM-PAID-TO               VALUE '1'.
  5621
  5622         16  CF-AR-MONTH-END-DT             PIC XX.
  5623
  5624         16  CF-CRDTCRD-USER                PIC X.
  5625             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  5626             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  5627
  5628         16  CF-CC-MONTH-END-DT             PIC XX.
  5629
  5630         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  5631
  5632         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  5633             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  5634             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  5635             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  5636         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  5637         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 110
* EL689.cbl
  5638         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  5639         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  5640             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  5641             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  5642         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  5643         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  5644         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  5645             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  5646         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  5647
  5648         16  CF-CL-ZIP-CODE.
  5649             20  CF-CL-ZIP-PRIME.
  5650                 24  CF-CL-ZIP-1ST          PIC X.
  5651                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  5652                 24  FILLER                 PIC X(4).
  5653             20  CF-CL-ZIP-PLUS4            PIC X(4).
  5654         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  5655             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  5656             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  5657             20  FILLER                     PIC XXX.
  5658
  5659         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  5660         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  5661         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  5662         16  CF-CO-OPTION-START-DATE        PIC XX.
  5663         16  CF-REM-TRM-CALC-OPTION         PIC X.
  5664           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  5665                                                      '3' '4'.
  5666           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  5667           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  5668           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  5669           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  5670           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  5671           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  5672
  5673         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  5674
  5675         16  CF-PAYMENT-APPROVAL-LEVELS.
  5676             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  5677             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  5678             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  5679             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  5680             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  5681             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  5682
  5683         16  CF-END-USER-REPORTING-USER     PIC X.
  5684             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  5685             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  5686
  5687         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  5688             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  5689             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  5690
  5691         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  5692
  5693         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  5694         16  FILLER                         PIC X.
  5695
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 111
* EL689.cbl
  5696         16  CF-CREDIT-ARCHIVE-CNTL.
  5697             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  5698             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  5699             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  5700
  5701         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  5702
  5703         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  5704             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  5705             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  5706
  5707         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  5708             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  5709             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  5710
  5711         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  5712
  5713         16  CF-CO-ACH-ID-CODE              PIC  X.
  5714             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  5715             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  5716             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  5717         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  5718         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  5719         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  5720         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  5721         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  5722         16  CF-CO-ACH-RECV-NO              PIC X(08).
  5723         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  5724         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  5725         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  5726                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  5727         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  5728                 CF-CO-ACH-TRACE-NO         PIC X(4).
  5729
  5730         16  CF-CO-OVER-SHORT.
  5731             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  5732             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  5733
  5734*         16  FILLER                         PIC X(102).
  5735         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  5736             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  5737             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  5738
  5739         16  CF-AH-APPROVAL-DAYS.
  5740             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  5741             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  5742             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  5743             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  5744
  5745         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  5746
  5747         16  CF-APPROV-LEV-5.
  5748             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  5749             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  5750             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  5751
  5752         16  FILLER                         PIC X(68).
  5753****************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 112
* EL689.cbl
  5754*             PROCESSOR/USER RECORD                            *
  5755****************************************************************
  5756
  5757     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5758         16  CF-PROCESSOR-NAME              PIC X(30).
  5759         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  5760         16  CF-PROCESSOR-TITLE             PIC X(26).
  5761         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  5762                 88  MESSAGE-YES                VALUE 'Y'.
  5763                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  5764
  5765*****************************************************
  5766****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  5767****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  5768****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  5769****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  5770*****************************************************
  5771
  5772         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  5773             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  5774             20  CF-APPLICATION-FORCE       PIC X.
  5775             20  CF-INDIVIDUAL-APP.
  5776                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  5777                     28  CF-BROWSE-APP      PIC X.
  5778                     28  CF-UPDATE-APP      PIC X.
  5779
  5780         16  CF-CURRENT-TERM-ON             PIC X(4).
  5781         16  CF-PROCESSOR-LIMITS-CLAIMS.
  5782             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  5783             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  5784             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  5785             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  5786             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  5787             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  5788             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  5789         16  CF-PROCESSOR-CARRIER           PIC X.
  5790             88  NO-CARRIER-SECURITY            VALUE ' '.
  5791         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  5792             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  5793         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  5794             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  5795         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  5796             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  5797
  5798         16  CF-PROC-SYS-ACCESS-SW.
  5799             20  CF-PROC-CREDIT-CLAIMS-SW.
  5800                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  5801                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  5802                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  5803                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  5804             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  5805                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  5806                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  5807             20  CF-PROC-LIFE-GNRLDGR-SW.
  5808                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  5809                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  5810                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  5811                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 113
* EL689.cbl
  5812             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  5813                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  5814                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  5815         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  5816             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  5817             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  5818         16  CF-PROCESSOR-PRINTER               PIC X(4).
  5819
  5820         16  CF-APPROVAL-LEVEL                  PIC X.
  5821             88  APPROVAL-LEVEL-1                   VALUE '1'.
  5822             88  APPROVAL-LEVEL-2                   VALUE '2'.
  5823             88  APPROVAL-LEVEL-3                   VALUE '3'.
  5824             88  APPROVAL-LEVEL-4                   VALUE '4'.
  5825             88  APPROVAL-LEVEL-5                   VALUE '5'.
  5826
  5827         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  5828
  5829         16  CF-LANGUAGE-TYPE                   PIC X.
  5830             88  CF-LANG-IS-ENG                     VALUE 'E'.
  5831             88  CF-LANG-IS-FR                      VALUE 'F'.
  5832
  5833         16  CF-CSR-IND                         PIC X.
  5834         16  FILLER                             PIC X(239).
  5835
  5836****************************************************************
  5837*             PROCESSOR/REMINDERS RECORD                       *
  5838****************************************************************
  5839
  5840     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  5841         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  5842             20  CF-START-REMIND-DT         PIC XX.
  5843             20  CF-END-REMIND-DT           PIC XX.
  5844             20  CF-REMINDER-TEXT           PIC X(50).
  5845         16  FILLER                         PIC X(296).
  5846
  5847
  5848****************************************************************
  5849*             STATE MASTER RECORD                              *
  5850****************************************************************
  5851
  5852     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  5853         16  CF-STATE-ABBREVIATION          PIC XX.
  5854         16  CF-STATE-NAME                  PIC X(25).
  5855         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  5856         16  CF-ST-CALC-QUOTE-TOLERANCE.
  5857             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  5858             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  5859             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  5860             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  5861                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  5862                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  5863             20  CF-ST-PREM-REJECT-SW       PIC X.
  5864                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  5865                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  5866             20  CF-ST-REF-REJECT-SW        PIC X.
  5867                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  5868                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  5869         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 114
* EL689.cbl
  5870         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  5871         16  CF-ST-REFUND-RULES.
  5872             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  5873             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  5874             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  5875         16  CF-ST-FST-PMT-EXTENSION.
  5876             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  5877             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  5878                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  5879                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  5880                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  5881                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  5882         16  CF-ST-STATE-CALL.
  5883             20  CF-ST-CALL-UNEARNED        PIC X.
  5884             20  CF-ST-CALL-RPT-CNTL        PIC X.
  5885             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  5886         16  CF-REPLACEMENT-LAW-SW          PIC X.
  5887             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  5888             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  5889         16  CF-REPLACEMENT-LETTER          PIC X(4).
  5890         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  5891         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  5892         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  5893         16  CF-ST-SPLIT-PAYMENT            PIC X.
  5894         16  FILLER                         PIC X.
  5895         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  5896             20  CF-ST-BENEFIT-CD           PIC XX.
  5897             20  CF-ST-BENEFIT-KIND         PIC X.
  5898                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  5899                 88  CF-ST-AH-KIND              VALUE 'A'.
  5900             20  CF-ST-REM-TERM-CALC        PIC X.
  5901                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  5902                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  5903                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  5904                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  5905                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  5906                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  5907                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  5908                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  5909
  5910             20  CF-ST-REFUND-CALC          PIC X.
  5911                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  5912                 88  ST-REFD-BY-R78             VALUE '1'.
  5913                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  5914                 88  ST-REFD-AS-CALIF           VALUE '3'.
  5915                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  5916                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  5917                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  5918                 88  ST-REFD-UTAH               VALUE '7'.
  5919                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  5920                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  5921                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  5922
  5923             20  CF-ST-EARNING-CALC         PIC X.
  5924                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  5925                 88  ST-EARN-BY-R78             VALUE '1'.
  5926                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  5927                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 115
* EL689.cbl
  5928                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  5929                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  5930                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  5931                 88  ST-EARN-MEAN               VALUE '8'.
  5932                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  5933
  5934             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  5935                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  5936                 88  ST-OVRD-BY-R78             VALUE '1'.
  5937                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  5938                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  5939                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  5940                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  5941                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  5942                 88  ST-OVRD-MEAN               VALUE '8'.
  5943                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  5944             20  cf-st-extra-periods        pic 9.
  5945*            20  FILLER                     PIC X.
  5946
  5947         16  CF-ST-COMMISSION-CAPS.
  5948             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  5949             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  5950             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  5951             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  5952         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  5953                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  5954                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  5955                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  5956
  5957         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  5958
  5959         16  CF-ST-STATUTORY-INTEREST.
  5960             20  CF-ST-STAT-DATE-FROM       PIC X.
  5961                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  5962                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  5963             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  5964             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  5965             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  5966             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  5967             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  5968
  5969         16  CF-ST-OVER-SHORT.
  5970             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  5971             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  5972
  5973         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  5974
  5975         16  CF-ST-RT-CALC                  PIC X.
  5976
  5977         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  5978         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  5979         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  5980         16  CF-ST-RF-LR-CALC               PIC X.
  5981         16  CF-ST-RF-LL-CALC               PIC X.
  5982         16  CF-ST-RF-LN-CALC               PIC X.
  5983         16  CF-ST-RF-AH-CALC               PIC X.
  5984         16  CF-ST-RF-CP-CALC               PIC X.
  5985*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 116
* EL689.cbl
  5986*CIDMOD         16  FILLER                         PIC X(192).
  5987         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  5988             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  5989         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  5990         16  CF-ST-VFY-2ND-BENE             PIC X.
  5991         16  CF-ST-CAUSAL-STATE             PIC X.
  5992         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  5993         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  5994         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  5995             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  5996         16  CF-ST-NET-ONLY-STATE           PIC X.
  5997             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  5998         16  cf-commission-cap-required     pic x.
  5999         16  CF-ST-GA-COMMISSION-CAPS.
  6000             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  6001             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  6002             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  6003             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  6004         16  CF-ST-TOT-COMMISSION-CAPS.
  6005             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  6006             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  6007             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  6008             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  6009         16  FILLER                         PIC X(156).
  6010
  6011****************************************************************
  6012*             BENEFIT MASTER RECORD                            *
  6013****************************************************************
  6014
  6015     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6016         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  6017             20  CF-BENEFIT-CODE            PIC XX.
  6018             20  CF-BENEFIT-NUMERIC  REDEFINES
  6019                 CF-BENEFIT-CODE            PIC XX.
  6020             20  CF-BENEFIT-ALPHA           PIC XXX.
  6021             20  CF-BENEFIT-DESCRIP         PIC X(10).
  6022             20  CF-BENEFIT-COMMENT         PIC X(10).
  6023
  6024             20  CF-LF-COVERAGE-TYPE        PIC X.
  6025                 88  CF-REDUCING                VALUE 'R'.
  6026                 88  CF-LEVEL                   VALUE 'L' 'P'.
  6027
  6028             20  CF-SPECIAL-CALC-CD         PIC X.
  6029                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  6030                 88  CF-NP-0-MO-INT             VALUE 'A'.
  6031                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  6032                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  6033                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  6034                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  6035                 88  CF-FARM-PLAN               VALUE 'F'.
  6036                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  6037                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  6038                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  6039                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  6040                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  6041                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  6042                 88  CF-PRUDENTIAL              VALUE 'P'.
  6043                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 117
* EL689.cbl
  6044                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  6045                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  6046                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  6047                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  6048                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  6049
  6050             20  CF-JOINT-INDICATOR         PIC X.
  6051                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  6052
  6053*            20  FILLER                     PIC X(12).
  6054             20  cf-maximum-benefits        pic s999 comp-3.
  6055             20  FILLER                     PIC X(09).
  6056             20  CF-BENEFIT-CATEGORY        PIC X.
  6057             20  CF-LOAN-TYPE               PIC X(8).
  6058
  6059             20  CF-CO-REM-TERM-CALC        PIC X.
  6060                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  6061                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  6062                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  6063                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  6064                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  6065
  6066             20  CF-CO-EARNINGS-CALC        PIC X.
  6067                 88  CO-EARN-BY-R78             VALUE '1'.
  6068                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  6069                 88  CO-EARN-AS-CALIF           VALUE '3'.
  6070                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  6071                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  6072                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  6073                 88  CO-EARN-AS-MEAN            VALUE '8'.
  6074                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  6075
  6076             20  CF-CO-REFUND-CALC          PIC X.
  6077                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  6078                 88  CO-REFD-BY-R78             VALUE '1'.
  6079                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  6080                 88  CO-REFD-AS-CALIF           VALUE '3'.
  6081                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  6082                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  6083                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  6084                 88  CO-REFD-MEAN               VALUE '8'.
  6085                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  6086                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  6087                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  6088
  6089             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  6090                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  6091                 88  CO-OVRD-BY-R78             VALUE '1'.
  6092                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  6093                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  6094                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  6095                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  6096                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  6097                 88  CO-OVRD-MEAN               VALUE '8'.
  6098                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  6099
  6100             20  CF-CO-BEN-I-G-CD           PIC X.
  6101                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 118
* EL689.cbl
  6102                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  6103                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  6104
  6105         16  FILLER                         PIC X(304).
  6106
  6107
  6108****************************************************************
  6109*             CARRIER MASTER RECORD                            *
  6110****************************************************************
  6111
  6112     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6113         16  CF-ADDRESS-DATA.
  6114             20  CF-MAIL-TO-NAME            PIC X(30).
  6115             20  CF-IN-CARE-OF              PIC X(30).
  6116             20  CF-ADDRESS-LINE-1          PIC X(30).
  6117             20  CF-ADDRESS-LINE-2          PIC X(30).
  6118             20  CF-CITY-STATE              PIC X(30).
  6119             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  6120             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  6121
  6122         16  CF-CLAIM-NO-CONTROL.
  6123             20  CF-CLAIM-NO-METHOD         PIC X.
  6124                 88  CLAIM-NO-MANUAL            VALUE '1'.
  6125                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  6126                 88  CLAIM-NO-SEQ               VALUE '3'.
  6127                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  6128             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  6129                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  6130                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  6131                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  6132
  6133         16  CF-CHECK-NO-CONTROL.
  6134             20  CF-CHECK-NO-METHOD         PIC X.
  6135                 88  CHECK-NO-MANUAL            VALUE '1'.
  6136                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  6137                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  6138                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  6139             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  6140                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  6141
  6142         16  CF-DOMICILE-STATE              PIC XX.
  6143
  6144         16  CF-EXPENSE-CONTROLS.
  6145             20  CF-EXPENSE-METHOD          PIC X.
  6146                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  6147                 88  DOLLARS-PER-PMT            VALUE '2'.
  6148                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  6149                 88  DOLLARS-PER-MONTH          VALUE '4'.
  6150             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  6151             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  6152
  6153         16  CF-CORRESPONDENCE-CONTROL.
  6154             20  CF-LETTER-RESEND-OPT       PIC X.
  6155                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  6156                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  6157             20  FILLER                     PIC X(4).
  6158
  6159         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 119
* EL689.cbl
  6160             20  CF-MANUAL-SW               PIC X.
  6161                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  6162             20  CF-FUTURE-SW               PIC X.
  6163                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  6164             20  CF-PTC-SW                  PIC X.
  6165                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  6166             20  CF-IBNR-SW                 PIC X.
  6167                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  6168             20  CF-PTC-LF-SW               PIC X.
  6169                 88  CF-LF-PTC-USED             VALUE '1'.
  6170             20  CF-CDT-ACCESS-METHOD       PIC X.
  6171                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  6172                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  6173                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  6174             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  6175
  6176         16  CF-CLAIM-CALC-METHOD           PIC X.
  6177             88  360-PLUS-MONTHS                VALUE '1'.
  6178             88  365-PLUS-MONTHS                VALUE '2'.
  6179             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  6180             88  360-DAILY                      VALUE '4'.
  6181             88  365-DAILY                      VALUE '5'.
  6182
  6183         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  6184         16  FILLER                         PIC X(11).
  6185
  6186         16  CF-LIMIT-AMOUNTS.
  6187             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  6188             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  6189             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  6190             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  6191             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  6192             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  6193             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  6194             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  6195             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  6196             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  6197
  6198         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  6199         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  6200         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  6201
  6202         16  CF-ZIP-CODE.
  6203             20  CF-ZIP-PRIME.
  6204                 24  CF-ZIP-1ST             PIC X.
  6205                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  6206                 24  FILLER                 PIC X(4).
  6207             20  CF-ZIP-PLUS4               PIC X(4).
  6208         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  6209             20  CF-CAN-POSTAL-1            PIC XXX.
  6210             20  CF-CAN-POSTAL-2            PIC XXX.
  6211             20  FILLER                     PIC XXX.
  6212
  6213         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  6214         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  6215         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  6216
  6217         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 120
* EL689.cbl
  6218             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  6219             88  CF-NO-RATING                   VALUE 'N'.
  6220
  6221         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  6222
  6223         16  CF-CARRIER-OVER-SHORT.
  6224             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  6225             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  6226
  6227         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  6228         16  CF-SECPAY-SWITCH               PIC X.
  6229             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  6230             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  6231         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  6232         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  6233         16  FILLER                         PIC X(444).
  6234*        16  FILLER                         PIC X(452).
  6235
  6236
  6237****************************************************************
  6238*             MORTALITY MASTER RECORD                          *
  6239****************************************************************
  6240
  6241     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6242         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  6243                                INDEXED BY CF-MORT-NDX.
  6244             20  CF-MORT-TABLE              PIC X(5).
  6245             20  CF-MORT-TABLE-TYPE         PIC X.
  6246                 88  CF-MORT-JOINT              VALUE 'J'.
  6247                 88  CF-MORT-SINGLE             VALUE 'S'.
  6248                 88  CF-MORT-COMBINED           VALUE 'C'.
  6249                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  6250                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  6251             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  6252             20  CF-MORT-AGE-METHOD         PIC XX.
  6253                 88  CF-AGE-LAST                VALUE 'AL'.
  6254                 88  CF-AGE-NEAR                VALUE 'AN'.
  6255             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  6256             20  CF-MORT-ADJUSTMENT-DIRECTION
  6257                                            PIC X.
  6258                 88  CF-MINUS                   VALUE '-'.
  6259                 88  CF-PLUS                    VALUE '+'.
  6260             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  6261             20  CF-MORT-JOINT-CODE         PIC X.
  6262                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  6263             20  CF-MORT-PC-Q               PIC X.
  6264                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  6265             20  CF-MORT-TABLE-CODE         PIC X(4).
  6266             20  CF-MORT-COMMENTS           PIC X(15).
  6267             20  FILLER                     PIC X(14).
  6268
  6269         16  FILLER                         PIC X(251).
  6270
  6271
  6272****************************************************************
  6273*             BUSSINESS TYPE MASTER RECORD                     *
  6274****************************************************************
  6275
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 121
* EL689.cbl
  6276     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6277* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  6278* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  6279* AND RECORD 05 IS TYPES 81-99
  6280         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  6281             20  CF-BUSINESS-TITLE          PIC  X(19).
  6282             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  6283                                            PIC S9V9(4) COMP-3.
  6284             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  6285             20  FILLER                     PIC  X.
  6286         16  FILLER                         PIC  X(248).
  6287
  6288
  6289****************************************************************
  6290*             TERMINAL MASTER RECORD                           *
  6291****************************************************************
  6292
  6293     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6294
  6295         16  CF-COMPANY-TERMINALS.
  6296             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  6297                                  PIC X(4).
  6298         16  FILLER               PIC X(248).
  6299
  6300
  6301****************************************************************
  6302*             LIFE EDIT MASTER RECORD                          *
  6303****************************************************************
  6304
  6305     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6306         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  6307             20  CF-LIFE-CODE-IN            PIC XX.
  6308             20  CF-LIFE-CODE-OUT           PIC XX.
  6309         16  FILLER                         PIC X(248).
  6310
  6311
  6312****************************************************************
  6313*             AH EDIT MASTER RECORD                            *
  6314****************************************************************
  6315
  6316     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6317         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  6318             20  CF-AH-CODE-IN              PIC XXX.
  6319             20  CF-AH-CODE-OUT             PIC XX.
  6320         16  FILLER                         PIC X(248).
  6321
  6322
  6323****************************************************************
  6324*             CREDIBILITY TABLES                               *
  6325****************************************************************
  6326
  6327     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  6328         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  6329                             INDEXED BY CF-CRDB-NDX.
  6330             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  6331             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  6332             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  6333         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 122
* EL689.cbl
  6334
  6335
  6336****************************************************************
  6337*             REPORT CUSTOMIZATION RECORD                      *
  6338****************************************************************
  6339
  6340     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  6341         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  6342             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  6343             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  6344             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  6345**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  6346****       A T-TRANSFER.                                   ****
  6347             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  6348
  6349         16  FILLER                         PIC XX.
  6350
  6351         16  CF-CARRIER-CNTL-OPT.
  6352             20  CF-CARRIER-OPT-SEQ         PIC 9.
  6353                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  6354                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  6355             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  6356                                            PIC X.
  6357         16  CF-GROUP-CNTL-OPT.
  6358             20  CF-GROUP-OPT-SEQ           PIC 9.
  6359                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  6360                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  6361             20  CF-GROUP-SELECT OCCURS 3 TIMES
  6362                                            PIC X(6).
  6363         16  CF-STATE-CNTL-OPT.
  6364             20  CF-STATE-OPT-SEQ           PIC 9.
  6365                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  6366                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  6367             20  CF-STATE-SELECT OCCURS 3 TIMES
  6368                                            PIC XX.
  6369         16  CF-ACCOUNT-CNTL-OPT.
  6370             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  6371                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  6372                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  6373             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  6374                                            PIC X(10).
  6375         16  CF-BUS-TYP-CNTL-OPT.
  6376             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  6377                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  6378                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  6379             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  6380                                            PIC XX.
  6381         16  CF-LF-TYP-CNTL-OPT.
  6382             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  6383                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  6384                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  6385             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  6386                                            PIC XX.
  6387         16  CF-AH-TYP-CNTL-OPT.
  6388             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  6389                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  6390                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  6391             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 123
* EL689.cbl
  6392                                            PIC XX.
  6393         16  CF-REPTCD1-CNTL-OPT.
  6394             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  6395                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  6396                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  6397             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  6398                                            PIC X(10).
  6399         16  CF-REPTCD2-CNTL-OPT.
  6400             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  6401                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  6402                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  6403             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  6404                                            PIC X(10).
  6405         16  CF-USER1-CNTL-OPT.
  6406             20  CF-USER1-OPT-SEQ           PIC 9.
  6407                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  6408                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  6409             20  CF-USER1-SELECT OCCURS 3 TIMES
  6410                                            PIC X(10).
  6411         16  CF-USER2-CNTL-OPT.
  6412             20  CF-USER2-OPT-SEQ           PIC 9.
  6413                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  6414                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  6415             20  CF-USER2-SELECT OCCURS 3 TIMES
  6416                                            PIC X(10).
  6417         16  CF-USER3-CNTL-OPT.
  6418             20  CF-USER3-OPT-SEQ           PIC 9.
  6419                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  6420                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  6421             20  CF-USER3-SELECT OCCURS 3 TIMES
  6422                                            PIC X(10).
  6423         16  CF-USER4-CNTL-OPT.
  6424             20  CF-USER4-OPT-SEQ           PIC 9.
  6425                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  6426                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  6427             20  CF-USER4-SELECT OCCURS 3 TIMES
  6428                                            PIC X(10).
  6429         16  CF-USER5-CNTL-OPT.
  6430             20  CF-USER5-OPT-SEQ           PIC 9.
  6431                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  6432                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  6433             20  CF-USER5-SELECT OCCURS 3 TIMES
  6434                                            PIC X(10).
  6435         16  CF-REINS-CNTL-OPT.
  6436             20  CF-REINS-OPT-SEQ           PIC 9.
  6437                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  6438                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  6439             20  CF-REINS-SELECT OCCURS 3 TIMES.
  6440                 24  CF-REINS-PRIME         PIC XXX.
  6441                 24  CF-REINS-SUB           PIC XXX.
  6442
  6443         16  CF-AGENT-CNTL-OPT.
  6444             20  CF-AGENT-OPT-SEQ           PIC 9.
  6445                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  6446                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  6447             20  CF-AGENT-SELECT OCCURS 3 TIMES
  6448                                            PIC X(10).
  6449
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 124
* EL689.cbl
  6450         16  FILLER                         PIC X(43).
  6451
  6452         16  CF-LOSS-RATIO-SELECT.
  6453             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  6454             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  6455         16  CF-ENTRY-DATE-SELECT.
  6456             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  6457             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  6458         16  CF-EFFECTIVE-DATE-SELECT.
  6459             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  6460             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  6461
  6462         16  CF-EXCEPTION-LIST-IND          PIC X.
  6463             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  6464
  6465         16  FILLER                         PIC X(318).
  6466
  6467****************************************************************
  6468*                  EXCEPTION REPORTING RECORD                  *
  6469****************************************************************
  6470
  6471     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  6472         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  6473             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  6474
  6475         16  CF-COMBINED-LIFE-AH-OPT.
  6476             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  6477             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  6478             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  6479             20  CF-CANCELLATION-RATIO      PIC S9(02).
  6480
  6481         16  CF-LIFE-OPT.
  6482             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6483             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6484             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6485             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6486             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6487             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6488             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6489             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6490             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6491             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  6492
  6493         16  CF-AH-OPT.
  6494             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  6495             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  6496             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  6497             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  6498             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  6499             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  6500             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  6501             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  6502             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  6503             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  6504
  6505         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  6506             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  6507             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 125
* EL689.cbl
  6508             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  6509
  6510         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  6511
  6512         16  FILLER                         PIC X(673).
  6513
  6514
  6515****************************************************************
  6516*             MORTGAGE SYSTEM PLAN RECORD                      *
  6517****************************************************************
  6518
  6519     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  6520         16  CF-PLAN-TYPE                   PIC X.
  6521             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  6522             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  6523             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  6524         16  CF-PLAN-ABBREV                 PIC XXX.
  6525         16  CF-PLAN-DESCRIPT               PIC X(10).
  6526         16  CF-PLAN-NOTES                  PIC X(20).
  6527         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  6528         16  CF-PLAN-UNDERWRITING.
  6529             20  CF-PLAN-TERM-DATA.
  6530                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  6531                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  6532             20  CF-PLAN-AGE-DATA.
  6533                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  6534                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  6535                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  6536             20  CF-PLAN-BENEFIT-DATA.
  6537                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6538                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  6539                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  6540                                            PIC S9(7)V99  COMP-3.
  6541         16  CF-PLAN-POLICY-FORMS.
  6542             20  CF-POLICY-FORM             PIC X(12).
  6543             20  CF-MASTER-APPLICATION      PIC X(12).
  6544             20  CF-MASTER-POLICY           PIC X(12).
  6545         16  CF-PLAN-RATING.
  6546             20  CF-RATE-CODE               PIC X(5).
  6547             20  CF-SEX-RATING              PIC X.
  6548                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  6549                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  6550             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  6551             20  CF-SUB-STD-TYPE            PIC X.
  6552                 88  CF-PCT-OF-PREM            VALUE '1'.
  6553                 88  CF-PCT-OF-BENE            VALUE '2'.
  6554         16  CF-PLAN-PREM-TOLERANCES.
  6555             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  6556             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  6557         16  CF-PLAN-PYMT-TOLERANCES.
  6558             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  6559             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  6560         16  CF-PLAN-MISC-DATA.
  6561             20  FILLER                     PIC X.
  6562             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  6563             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  6564         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  6565         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 126
* EL689.cbl
  6566             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  6567                                                     '1'.
  6568             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  6569                                                     '2'.
  6570         16  CF-MIB-SEARCH-SW               PIC X.
  6571             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  6572             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  6573             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  6574             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  6575         16  CF-ALPHA-SEARCH-SW             PIC X.
  6576             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  6577             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  6578             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  6579             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  6580             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  6581             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  6582             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  6583             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  6584             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  6585             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  6586                                                     'A' 'B' 'C'
  6587                                                     'X' 'Y' 'Z'.
  6588         16  CF-EFF-DT-RULE-SW              PIC X.
  6589             88  CF-EFF-DT-ENTER               VALUE 'E'.
  6590             88  CF-EFF-DT-MONTH               VALUE 'M'.
  6591             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  6592             88  CF-EFF-DT-SEMI                VALUE 'S'.
  6593             88  CF-EFF-DT-ANN                 VALUE 'A'.
  6594         16  FILLER                         PIC X(4).
  6595         16  CF-HEALTH-QUESTIONS            PIC X.
  6596             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  6597         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  6598         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  6599         16  CF-PLAN-SNGL-JNT               PIC X.
  6600             88  CF-COMBINED-PLAN              VALUE 'C'.
  6601             88  CF-JNT-PLAN                   VALUE 'J'.
  6602             88  CF-SNGL-PLAN                  VALUE 'S'.
  6603         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  6604         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  6605         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  6606         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  6607         16  CF-RERATE-CNTL                 PIC  X.
  6608             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  6609             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  6610             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  6611             88  CF-AUTO-RECALC                 VALUE '4'.
  6612         16  CF-BENEFIT-TYPE                PIC  X.
  6613             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  6614             88  CF-BENEFIT-REDUCES             VALUE '2'.
  6615         16  CF-POLICY-FEE                  PIC S999V99
  6616                                                    COMP-3.
  6617         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  6618         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  6619         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  6620         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  6621         16  FILLER                         PIC  X(32).
  6622         16  CF-TERMINATION-FORM            PIC  X(04).
  6623         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 127
* EL689.cbl
  6624         16  CF-CLAIM-CAP                   PIC S9(7)V99
  6625                                                       COMP-3.
  6626         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  6627         16  CF-ISSUE-LETTER                PIC  X(4).
  6628         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  6629         16  CF-DEPENDENT-COVERAGE          PIC  X.
  6630             88  CF-YES-DEP-COV                 VALUE 'Y'.
  6631             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  6632         16  CF-MP-REFUND-CALC              PIC X.
  6633             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  6634             88  CF-MP-REFD-BY-R78              VALUE '1'.
  6635             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  6636             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  6637             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  6638             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  6639             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  6640             88  CF-MP-REFD-MEAN                VALUE '8'.
  6641         16  CF-ALT-RATE-CODE               PIC  X(5).
  6642
  6643
  6644         16  FILLER                         PIC X(498).
  6645****************************************************************
  6646*             MORTGAGE COMPANY MASTER RECORD                   *
  6647****************************************************************
  6648
  6649     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  6650         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  6651         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  6652             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  6653             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  6654             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  6655             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  6656             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  6657
  6658         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  6659         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  6660         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  6661         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  6662         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  6663
  6664         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  6665             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  6666         16  CF-MP-RECON-USE-IND            PIC X(1).
  6667             88  CF-MP-USE-RECON             VALUE 'Y'.
  6668         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  6669             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  6670         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  6671             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  6672             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  6673         16  FILLER                         PIC X(1).
  6674         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  6675             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  6676         16  CF-MORTG-MIB-VERSION           PIC X.
  6677             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  6678             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  6679             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  6680         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  6681             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 128
* EL689.cbl
  6682                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  6683             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  6684                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  6685             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  6686                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  6687             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  6688                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  6689             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  6690                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  6691             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  6692                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  6693         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  6694         16  FILLER                         PIC X(7).
  6695         16  CF-MORTG-DESTINATION-SYMBOL.
  6696             20  CF-MORTG-MIB-COMM          PIC X(5).
  6697             20  CF-MORTG-MIB-TERM          PIC X(5).
  6698         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  6699             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  6700         16  FILLER                         PIC X(03).
  6701         16  CF-MP-CHECK-NO-CONTROL.
  6702             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  6703                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  6704                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  6705                                                ' ' LOW-VALUES.
  6706                 88  CF-MP-CHECK-NO-PRE-PRINTED
  6707                                               VALUE '3'.
  6708         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  6709         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  6710         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  6711             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  6712                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  6713             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  6714                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  6715             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  6716                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  6717             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  6718                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  6719             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  6720                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  6721             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  6722                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  6723         16  CF-MORTG-BILLING-AREA.
  6724             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  6725                                            PIC X.
  6726         16  CF-MORTG-MONTH-END-DT          PIC XX.
  6727         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  6728         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  6729         16  CF-MORTG-MIB-DEST-SW           PIC X.
  6730             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  6731             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  6732         16  FILLER                         PIC X.
  6733         16  CF-MORTG-LABEL-CONTROL         PIC X.
  6734             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  6735             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  6736         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  6737         16  FILLER                         PIC X(8).
  6738         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  6739         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 129
* EL689.cbl
  6740         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  6741         16  CF-ACH-COMPANY-ID.
  6742             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  6743                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  6744                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  6745                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  6746             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  6747         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  6748             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  6749         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  6750             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  6751             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  6752         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  6753         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  6754         16  FILLER                         PIC X(536).
  6755
  6756****************************************************************
  6757*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  6758****************************************************************
  6759
  6760     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  6761         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  6762             20  CF-FEMALE-HEIGHT.
  6763                 24  CF-FEMALE-FT           PIC 99.
  6764                 24  CF-FEMALE-IN           PIC 99.
  6765             20  CF-FEMALE-MIN-WT           PIC 999.
  6766             20  CF-FEMALE-MAX-WT           PIC 999.
  6767         16  FILLER                         PIC X(428).
  6768
  6769     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  6770         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  6771             20  CF-MALE-HEIGHT.
  6772                 24  CF-MALE-FT             PIC 99.
  6773                 24  CF-MALE-IN             PIC 99.
  6774             20  CF-MALE-MIN-WT             PIC 999.
  6775             20  CF-MALE-MAX-WT             PIC 999.
  6776         16  FILLER                         PIC X(428).
  6777******************************************************************
  6778*             AUTOMATIC ACTIVITY RECORD                          *
  6779******************************************************************
  6780     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  6781         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  6782             20  CF-SYS-ACTIVE-SW           PIC X(01).
  6783             20  CF-SYS-LETTER-ID           PIC X(04).
  6784             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  6785             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  6786             20  CF-SYS-RESET-SW            PIC X(01).
  6787             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  6788             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  6789
  6790         16  FILLER                         PIC X(50).
  6791
  6792         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  6793             20  CF-USER-ACTIVE-SW          PIC X(01).
  6794             20  CF-USER-LETTER-ID          PIC X(04).
  6795             20  CF-USER-RESEND-DAYS        PIC 9(03).
  6796             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  6797             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 130
* EL689.cbl
  6798             20  CF-USER-REPORT-DAYS        PIC 9(03).
  6799             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  6800             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  6801
  6802         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 131
* EL689.cbl
  6804*    COPY ERCCOMP.
  6805******************************************************************
  6806*                                                                *
  6807*                                                                *
  6808*                            ERCCOMP                             *
  6809*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  6810*                            VMOD=2.019                          *
  6811*                                                                *
  6812*   ONLINE CREDIT SYSTEM                                         *
  6813*                                                                *
  6814*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  6815*                                                                *
  6816*   FILE TYPE = VSAM,KSDS                                        *
  6817*   RECORD SIZE = 700   RECFORM = FIXED                          *
  6818*                                                                *
  6819*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  6820*       ALTERNATE PATH = NONE                                    *
  6821*                                                                *
  6822*   LOG = NO                                                     *
  6823*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  6824*                                                                *
  6825******************************************************************
  6826*                   C H A N G E   L O G
  6827*
  6828* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  6829*-----------------------------------------------------------------
  6830*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  6831* EFFECTIVE    NUMBER
  6832*-----------------------------------------------------------------
  6833* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  6834* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  6835* 092205    2005050300006  PEMA  ADD LEASE FEE
  6836* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  6837* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  6838* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  6839* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  6840* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  6841* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  6842******************************************************************
  6843
  6844 01  COMPENSATION-MASTER.
  6845     12  CO-RECORD-ID                          PIC XX.
  6846         88  VALID-CO-ID                          VALUE 'CO'.
  6847
  6848     12  CO-CONTROL-PRIMARY.
  6849         16  CO-COMPANY-CD                     PIC X.
  6850         16  CO-CONTROL.
  6851             20  CO-CTL-1.
  6852                 24  CO-CARR-GROUP.
  6853                     28  CO-CARRIER            PIC X.
  6854                     28  CO-GROUPING.
  6855                         32  CO-GROUP-PREFIX   PIC XXX.
  6856                         32  CO-GROUP-PRIME    PIC XXX.
  6857                 24  CO-RESP-NO.
  6858                     28  CO-RESP-PREFIX        PIC X(4).
  6859                     28  CO-RESP-PRIME         PIC X(6).
  6860             20  CO-CTL-2.
  6861                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 132
* EL689.cbl
  6862                     28  CO-ACCT-PREFIX        PIC X(4).
  6863                     28  CO-ACCT-PRIME         PIC X(6).
  6864         16  CO-TYPE                           PIC X.
  6865             88  CO-COMPANY-TYPE                  VALUE 'C'.
  6866             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  6867             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  6868
  6869     12  CO-MAINT-INFORMATION.
  6870         16  CO-LAST-MAINT-DT                  PIC XX.
  6871         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  6872         16  CO-LAST-MAINT-USER                PIC X(4).
  6873     12  FILLER                                PIC XX.
  6874     12  CO-STMT-TYPE                          PIC XXX.
  6875     12  CO-COMP-TYPE                          PIC X.
  6876         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  6877     12  CO-STMT-OWNER                         PIC X(4).
  6878     12  CO-BALANCE-CONTROL                    PIC X.
  6879         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  6880         88  CO-NO-BALANCE                        VALUE 'N'.
  6881
  6882     12  CO-INTERNAL-CONTROL-1                 PIC X.
  6883         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  6884         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  6885         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  6886
  6887     12  CO-INTERNAL-CONTROL-2                 PIC X.
  6888         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  6889         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  6890
  6891     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  6892     12  CO-GA-DIRECT-DEP                      PIC X.
  6893     12  CO-FUTURE-SPACE                       PIC X.
  6894         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  6895
  6896     12  CO-ACCT-NAME                          PIC X(30).
  6897     12  CO-MAIL-NAME                          PIC X(30).
  6898     12  CO-ADDR-1                             PIC X(30).
  6899     12  CO-ADDR-2                             PIC X(30).
  6900     12  CO-ADDR-3.
  6901         16  CO-ADDR-CITY                      PIC X(27).
  6902         16  CO-ADDR-STATE                     PIC XX.
  6903     12  CO-CSO-1099                           PIC X.
  6904     12  CO-ZIP.
  6905         16  CO-ZIP-PRIME.
  6906             20  CO-ZIP-PRI-1ST                PIC X.
  6907                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  6908             20  FILLER                        PIC X(4).
  6909         16  CO-ZIP-PLUS4                      PIC X(4).
  6910     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  6911         16  CO-CAN-POSTAL-1                   PIC XXX.
  6912         16  CO-CAN-POSTAL-2                   PIC XXX.
  6913         16  FILLER                            PIC XXX.
  6914     12  CO-SOC-SEC                            PIC X(13).
  6915     12  CO-TELEPHONE.
  6916         16  CO-AREA-CODE                      PIC XXX.
  6917         16  CO-PREFIX                         PIC XXX.
  6918         16  CO-PHONE                          PIC X(4).
  6919
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 133
* EL689.cbl
  6920     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  6921
  6922     12  CO-AR-BAL-LEVEL                       PIC X.
  6923         88  CO-AR-REF-LVL                        VALUE '1'.
  6924         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  6925         88  CO-AR-BILL-LVL                       VALUE '2'.
  6926         88  CO-AR-AGT-LVL                        VALUE '3'.
  6927         88  CO-AR-FR-LVL                         VALUE '4'.
  6928
  6929     12  CO-AR-NORMAL-PRINT                    PIC X.
  6930         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  6931         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  6932
  6933     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  6934
  6935     12  CO-AR-REPORTING                       PIC X.
  6936         88  CO-AR-NET-REPORT                     VALUE 'N'.
  6937         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  6938
  6939     12  CO-AR-PULL-CHECK                      PIC X.
  6940         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  6941         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  6942
  6943     12  CO-AR-BALANCE-PRINT                   PIC X.
  6944         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  6945
  6946     12  CO-AR-LAST-RUN-CODE                   PIC X.
  6947         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  6948         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  6949         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  6950
  6951     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  6952
  6953     12  CO-USER-CODE                          PIC X.
  6954     12  CO-REPORT-GROUP-ID                    PIC X(12).
  6955
  6956******************************************************************
  6957*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  6958*    THE LAST MONTH END RUN.
  6959******************************************************************
  6960
  6961     12  CO-LAST-ACTIVITY-DATE.
  6962         16  CO-ACT-YEAR                       PIC 99.
  6963         16  CO-ACT-MONTH                      PIC 99.
  6964         16  CO-ACT-DAY                        PIC 99.
  6965
  6966     12  CO-LAST-STMT-DT.
  6967         16  CO-LAST-STMT-YEAR                 PIC 99.
  6968         16  CO-LAST-STMT-MONTH                PIC 99.
  6969         16  CO-LAST-STMT-DAY                  PIC 99.
  6970
  6971     12  CO-MO-END-TOTALS.
  6972         16  CO-MONTHLY-TOTALS.
  6973             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  6974             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  6975             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  6976             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  6977             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 134
* EL689.cbl
  6978
  6979         16  CO-AGING-TOTALS.
  6980             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  6981             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  6982             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  6983             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  6984
  6985         16  CO-YTD-TOTALS.
  6986             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  6987             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  6988
  6989         16  CO-OVER-UNDER-TOTALS.
  6990             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6991             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  6992
  6993     12  CO-MISCELLANEOUS-TOTALS.
  6994         16  CO-FICA-TOTALS.
  6995             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  6996             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  6997
  6998         16  CO-CLAIM-TOTALS.
  6999             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  7000             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  7001
  7002******************************************************************
  7003*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  7004*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  7005******************************************************************
  7006
  7007     12  CO-CURRENT-TOTALS.
  7008         16  CO-CURRENT-LAST-STMT-DT.
  7009             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  7010             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  7011             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  7012
  7013         16  CO-CURRENT-MONTHLY-TOTALS.
  7014             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  7015             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  7016             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  7017             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  7018             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  7019
  7020         16  CO-CURRENT-AGING-TOTALS.
  7021             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  7022             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  7023             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  7024             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  7025
  7026         16  CO-CURRENT-YTD-TOTALS.
  7027             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  7028             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  7029
  7030     12  CO-PAID-COMM-TOTALS.
  7031         16  CO-YTD-PAID-COMMS.
  7032             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  7033             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  7034
  7035     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 135
* EL689.cbl
  7036         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  7037         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  7038
  7039     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  7040         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  7041         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  7042         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  7043         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  7044         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  7045         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  7046         88  CO-FINAL-LETTER                  VALUE 'F'.
  7047         88  CO-RECONCILING                   VALUE 'R'.
  7048         88  CO-PHONE-CALL                    VALUE 'P'.
  7049         88  CO-LEGAL                         VALUE 'L'.
  7050         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  7051         88  CO-WRITE-OFF                     VALUE 'W'.
  7052         88  CO-NO-ACTION                     VALUE 'N' ' '.
  7053
  7054     12  CO-CSR-CODE                       PIC X(4).
  7055
  7056     12  CO-GA-STATUS-INFO.
  7057         16  CO-GA-EFFECTIVE-DT            PIC XX.
  7058         16  CO-GA-TERMINATION-DT          PIC XX.
  7059         16  CO-GA-STATUS-CODE             PIC X.
  7060             88  CO-GA-ACTIVE                 VALUE 'A'.
  7061             88  CO-GA-INACTIVE               VALUE 'I'.
  7062             88  CO-GA-PENDING                VALUE 'P'.
  7063         16  CO-GA-COMMENTS.
  7064             20  CO-GA-COMMENT-1           PIC X(40).
  7065             20  CO-GA-COMMENT-2           PIC X(40).
  7066             20  CO-GA-COMMENT-3           PIC X(40).
  7067             20  CO-GA-COMMENT-4           PIC X(40).
  7068
  7069     12  CO-RPTCD2                         PIC X(10).
  7070     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  7071         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  7072         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  7073
  7074     12  CO-TYPE-AGENT                     PIC X(01).
  7075         88  CO-CORPORATION                   VALUE 'C'.
  7076         88  CO-PARTNERSHIP                   VALUE 'P'.
  7077         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  7078         88  CO-TRUST                         VALUE 'T'.
  7079         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  7080
  7081     12  CO-FAXNO.
  7082         16  CO-FAX-AREA-CODE                  PIC XXX.
  7083         16  CO-FAX-PREFIX                     PIC XXX.
  7084         16  CO-FAX-PHONE                      PIC X(4).
  7085
  7086     12  CO-BANK-INFORMATION.
  7087         16  CO-BANK-TRANSIT-NO                PIC X(8).
  7088         16  CO-BANK-TRANSIT-NON REDEFINES
  7089             CO-BANK-TRANSIT-NO                PIC 9(8).
  7090
  7091         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  7092     12  CO-MISC-DEDUCT-INFO REDEFINES
  7093                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 136
* EL689.cbl
  7094         16  CO-MD-GL-ACCT                     PIC X(10).
  7095         16  CO-MD-DIV                         PIC XX.
  7096         16  CO-MD-CENTER                      PIC X(4).
  7097         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  7098         16  CO-CREATE-AP-CHECK                PIC X.
  7099         16  CO-DELIVER-CK-TO-MEL              PIC X.
  7100         16  FILLER                            PIC XXX.
  7101     12  CO-ACH-STATUS                         PIC X.
  7102         88  CO-ACH-ACTIVE                         VALUE 'A'.
  7103         88  CO-ACH-PENDING                        VALUE 'P'.
  7104
  7105     12  CO-BILL-SW                            PIC X.
  7106     12  CO-CONTROL-NAME                       PIC X(30).
  7107     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  7108     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  7109     12  CO-CLP-STATE                          PIC XX.
  7110     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  7111     12  CO-SPP-REFUND-EDIT                    PIC X.
  7112
  7113******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 137
* EL689.cbl
  7115*    COPY ERCMAIL.
  7116******************************************************************
  7117*                                                                *
  7118*                                                                *
  7119*                            ERCMAIL                             *
  7120*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7121*                            VMOD=2.003                          *
  7122*                                                                *
  7123*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  7124*                                                                *
  7125*   FILE TYPE = VSAM,KSDS                                        *
  7126*   RECORD SIZE = 374   RECFORM = FIX                            *
  7127*                                                                *
  7128*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  7129*   ALTERNATE PATH    = NOT USED                                 *
  7130*                                                                *
  7131*   LOG = YES                                                    *
  7132*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7133******************************************************************
  7134*                   C H A N G E   L O G
  7135*
  7136* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7137*-----------------------------------------------------------------
  7138*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7139* EFFECTIVE    NUMBER
  7140*-----------------------------------------------------------------
  7141* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  7142* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7143* 111108                   PEMA  ADD CRED BENE ADDR2
  7144******************************************************************
  7145
  7146 01  MAILING-DATA.
  7147     12  MA-RECORD-ID                      PIC XX.
  7148         88  VALID-MA-ID                       VALUE 'MA'.
  7149
  7150     12  MA-CONTROL-PRIMARY.
  7151         16  MA-COMPANY-CD                 PIC X.
  7152         16  MA-CARRIER                    PIC X.
  7153         16  MA-GROUPING.
  7154             20  MA-GROUPING-PREFIX        PIC XXX.
  7155             20  MA-GROUPING-PRIME         PIC XXX.
  7156         16  MA-STATE                      PIC XX.
  7157         16  MA-ACCOUNT.
  7158             20  MA-ACCOUNT-PREFIX         PIC X(4).
  7159             20  MA-ACCOUNT-PRIME          PIC X(6).
  7160         16  MA-CERT-EFF-DT                PIC XX.
  7161         16  MA-CERT-NO.
  7162             20  MA-CERT-PRIME             PIC X(10).
  7163             20  MA-CERT-SFX               PIC X.
  7164
  7165     12  FILLER                            PIC XX.
  7166
  7167     12  MA-ACCESS-CONTROL.
  7168         16  MA-SOURCE-SYSTEM              PIC XX.
  7169             88  MA-FROM-CREDIT                VALUE 'CR'.
  7170             88  MA-FROM-VSI                   VALUE 'VS'.
  7171             88  MA-FROM-WARRANTY              VALUE 'WA'.
  7172             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 138
* EL689.cbl
  7173         16  MA-RECORD-ADD-DT              PIC XX.
  7174         16  MA-RECORD-ADDED-BY            PIC XXXX.
  7175         16  MA-LAST-MAINT-DT              PIC XX.
  7176         16  MA-LAST-MAINT-BY              PIC XXXX.
  7177         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  7178
  7179     12  MA-PROFILE-INFO.
  7180         16  MA-QUALIFY-CODE-1             PIC XX.
  7181         16  MA-QUALIFY-CODE-2             PIC XX.
  7182         16  MA-QUALIFY-CODE-3             PIC XX.
  7183         16  MA-QUALIFY-CODE-4             PIC XX.
  7184         16  MA-QUALIFY-CODE-5             PIC XX.
  7185
  7186         16  MA-INSURED-LAST-NAME          PIC X(15).
  7187         16  MA-INSURED-FIRST-NAME         PIC X(10).
  7188         16  MA-INSURED-MIDDLE-INIT        PIC X.
  7189         16  MA-INSURED-ISSUE-AGE          PIC 99.
  7190         16  MA-INSURED-BIRTH-DT           PIC XX.
  7191         16  MA-INSURED-SEX                PIC X.
  7192             88  MA-SEX-MALE                   VALUE 'M'.
  7193             88  MA-SEX-FEMALE                 VALUE 'F'.
  7194         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  7195
  7196         16  MA-ADDRESS-CORRECTED          PIC X.
  7197         16  MA-JOINT-BIRTH-DT             PIC XX.
  7198*        16  FILLER                        PIC X(12).
  7199
  7200         16  MA-ADDRESS-LINE-1             PIC X(30).
  7201         16  MA-ADDRESS-LINE-2             PIC X(30).
  7202         16  MA-CITY-STATE.
  7203             20  MA-CITY                   PIC X(28).
  7204             20  MA-ADDR-STATE             PIC XX.
  7205         16  MA-ZIP.
  7206             20  MA-ZIP-CODE.
  7207                 24  MA-ZIP-CODE-1ST       PIC X(1).
  7208                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  7209                 24  FILLER                PIC X(4).
  7210             20  MA-ZIP-PLUS4              PIC X(4).
  7211         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  7212             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  7213             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  7214             20  FILLER                    PIC X(3).
  7215
  7216         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  7217
  7218         16  FILLER                        PIC XXX.
  7219*        16  FILLER                        PIC X(10).
  7220
  7221     12  MA-CRED-BENE-INFO.
  7222         16  MA-CRED-BENE-NAME                 PIC X(25).
  7223         16  MA-CRED-BENE-ADDR                 PIC X(30).
  7224         16  MA-CRED-BENE-ADDR2                PIC X(30).
  7225         16  MA-CRED-BENE-CTYST.
  7226             20  MA-CRED-BENE-CITY             PIC X(28).
  7227             20  MA-CRED-BENE-STATE            PIC XX.
  7228         16  MA-CRED-BENE-ZIP.
  7229             20  MA-CB-ZIP-CODE.
  7230                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 139
* EL689.cbl
  7231                     88  MA-CB-CANADIAN-POST-CODE
  7232                                           VALUE 'A' THRU 'Z'.
  7233                 24  FILLER                    PIC X(4).
  7234             20  MA-CB-ZIP-PLUS4               PIC X(4).
  7235         16  MA-CB-CANADIAN-POSTAL-CODE
  7236                            REDEFINES MA-CRED-BENE-ZIP.
  7237             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  7238             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  7239             20  FILLER                        PIC X(3).
  7240     12  MA-POST-CARD-MAIL-DATA.
  7241         16  MA-MAIL-DATA OCCURS 7.
  7242             20  MA-MAIL-TYPE              PIC X.
  7243                 88  MA-12MO-MAILING           VALUE '1'.
  7244                 88  MA-EXP-MAILING            VALUE '2'.
  7245             20  MA-MAIL-STATUS            PIC X.
  7246                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  7247                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  7248                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  7249             20  MA-MAIL-DATE              PIC XX.
  7250     12  FILLER                            PIC XX.
  7251     12  FILLER                            PIC XX.
  7252*    12  FILLER                            PIC X(30).
  7253******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 140
* EL689.cbl
  7255*    COPY ERCPNDB.
  7256******************************************************************
  7257*                                                                *
  7258*                                                                *
  7259*                            ERCPNDB.                            *
  7260*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7261*                            VMOD=2.025                          *
  7262*                                                                *
  7263*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  7264*                                                                *
  7265******************************************************************
  7266*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  7267*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  7268******************************************************************
  7269*                                                                *
  7270*                                                                *
  7271*   FILE TYPE = VSAM,KSDS                                        *
  7272*   RECORD SIZE = 585  RECFORM = FIXED                           *
  7273*                                                                *
  7274*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  7275*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  7276*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  7277*                                                 RKP=13,LEN=36  *
  7278*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  7279*                                      AND CHG-SEQ.)             *
  7280*                                                RKP=49,LEN=11   *
  7281*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  7282*                                      AND CHG-SEQ.)             *
  7283*                                                RKP=60,LEN=15   *
  7284*                                                                *
  7285*   LOG = NO                                                     *
  7286*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7287******************************************************************
  7288******************************************************************
  7289*                   C H A N G E   L O G
  7290*
  7291* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7292*-----------------------------------------------------------------
  7293*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7294* EFFECTIVE    NUMBER
  7295*-----------------------------------------------------------------
  7296* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  7297* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  7298* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  7299* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  7300* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  7301* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  7302* 032306                   PEMA  ADD BOW LOAN NUMBER
  7303* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  7304* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  7305* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  7306* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  7307* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  7308* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  7309* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  7310* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  7311* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  7312* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 141
* EL689.cbl
  7313* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  7314* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  7315* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  7316******************************************************************
  7317
  7318 01  PENDING-BUSINESS.
  7319     12  PB-RECORD-ID                     PIC XX.
  7320         88  VALID-PB-ID                        VALUE 'PB'.
  7321
  7322     12  PB-CONTROL-PRIMARY.
  7323         16  PB-COMPANY-CD                PIC X.
  7324         16  PB-ENTRY-BATCH               PIC X(6).
  7325         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  7326         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  7327
  7328     12  PB-CONTROL-BY-ACCOUNT.
  7329         16  PB-COMPANY-CD-A1             PIC X.
  7330         16  PB-CARRIER                   PIC X.
  7331         16  PB-GROUPING.
  7332             20  PB-GROUPING-PREFIX       PIC XXX.
  7333             20  PB-GROUPING-PRIME        PIC XXX.
  7334         16  PB-STATE                     PIC XX.
  7335         16  PB-ACCOUNT.
  7336             20  PB-ACCOUNT-PREFIX        PIC X(4).
  7337             20  PB-ACCOUNT-PRIME         PIC X(6).
  7338         16  PB-CERT-EFF-DT               PIC XX.
  7339         16  PB-CERT-NO.
  7340             20  PB-CERT-PRIME            PIC X(10).
  7341             20  PB-CERT-SFX              PIC X.
  7342         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  7343
  7344         16  PB-RECORD-TYPE               PIC X.
  7345             88  PB-MAILING-DATA                VALUE '0'.
  7346             88  PB-ISSUE                       VALUE '1'.
  7347             88  PB-CANCELLATION                VALUE '2'.
  7348             88  PB-BATCH-TRAILER               VALUE '9'.
  7349
  7350     12  PB-CONTROL-BY-ORIG-BATCH.
  7351         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  7352         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  7353         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  7354         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  7355
  7356     12  PB-CONTROL-BY-CSR.
  7357         16  PB-CSR-COMPANY-CD            PIC X.
  7358         16  PB-CSR-ID                    PIC X(4).
  7359         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  7360         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  7361         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  7362******************************************************************
  7363*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  7364******************************************************************
  7365
  7366     12  PB-LAST-MAINT-DT                 PIC XX.
  7367     12  PB-LAST-MAINT-BY                 PIC X(4).
  7368     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7369
  7370     12  PB-RECORD-BODY                   PIC X(375).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 142
* EL689.cbl
  7371
  7372     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  7373         16  PB-CERT-ORIGIN               PIC X.
  7374             88  CLASIC-CREATED-CERT         VALUE '1'.
  7375         16  PB-I-NAME.
  7376             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  7377             20  PB-I-INSURED-FIRST-NAME.
  7378                 24  PB-I-INSURED-1ST-INIT PIC X.
  7379                 24  FILLER                PIC X(9).
  7380             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  7381         16  PB-I-AGE                     PIC S99   COMP-3.
  7382         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  7383         16  PB-I-BIRTHDAY                PIC XX.
  7384         16  PB-I-INSURED-SEX             PIC X.
  7385             88  PB-SEX-MALE     VALUE 'M'.
  7386             88  PB-SEX-FEMALE   VALUE 'F'.
  7387
  7388         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  7389         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  7390         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  7391         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  7392         16  PB-I-SKIP-CODE               PIC X.
  7393             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  7394             88  PB-SKIP-JULY              VALUE '1'.
  7395             88  PB-SKIP-AUGUST            VALUE '2'.
  7396             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  7397             88  PB-SKIP-JULY-AUG          VALUE '4'.
  7398             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  7399             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  7400             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  7401             88  PB-SKIP-JUNE              VALUE '8'.
  7402             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  7403             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  7404             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  7405         16  PB-I-TERM-TYPE               PIC X.
  7406             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  7407             88  PB-PAID-WEEKLY            VALUE 'W'.
  7408             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  7409             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  7410             88  PB-PAID-13-YEARLY         VALUE 'T'.
  7411         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  7412         16  PB-I-POLICY-FORM-NO          PIC X(12).
  7413         16  PB-I-DATA-ENTRY-SW           PIC X.
  7414             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  7415             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  7416             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  7417             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  7418         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  7419         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  7420*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  7421         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  7422         16  PB-I-LETTER-REQD             PIC X.
  7423
  7424         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  7425             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  7426             88  PB-INVALID-LIFE             VALUE '  ' '00'
  7427                                                   '90' THRU '99'.
  7428         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 143
* EL689.cbl
  7429                                          PIC XX.
  7430         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  7431         16  PB-I-AMOUNT-FINANCED REDEFINES
  7432                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  7433         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  7434         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  7435                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  7436         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7437         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  7438         16  PB-I-CLP-AMOUNT REDEFINES
  7439                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  7440         16  PB-I-LF-CALC-FLAG            PIC X.
  7441             88 PB-COMP-LF-PREM               VALUE '?'.
  7442         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  7443         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  7444         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  7445         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  7446         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  7447         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  7448         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  7449         16  PB-I-LF-ABBR                 PIC XXX.
  7450         16  PB-I-LF-INPUT-CD             PIC XX.
  7451
  7452         16  PB-I-AH-BENEFIT-CD           PIC XX.
  7453             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  7454             88  PB-INVALID-AH               VALUE '  ' '00'
  7455                                                   '90' THRU '99'.
  7456         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  7457         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  7458         16  PB-I-AH-CALC-FLAG            PIC X.
  7459             88 PB-COMP-AH-PREM                  VALUE '?'.
  7460         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  7461         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  7462         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  7463         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  7464         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  7465         16  PB-I-AH-ABBR                 PIC XXX.
  7466         16  PB-I-AH-INPUT-CD             PIC XXX.
  7467
  7468         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  7469         16  PB-I-REIN-TABLE              PIC XXX.
  7470         16  PB-I-BUSINESS-TYPE           PIC 99.
  7471         16  PB-I-INDV-GRP-CD             PIC X.
  7472         16  PB-I-MORT-CODE.
  7473             20  PB-I-TABLE               PIC X.
  7474             20  PB-I-INTEREST            PIC XX.
  7475             20  PB-I-MORT-TYP            PIC X.
  7476         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  7477         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  7478         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  7479         16  PB-I-INDV-GRP-OVRD           PIC X.
  7480         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  7481         16  PB-I-SIG-SW                  PIC X.
  7482             88  PB-POLICY-SIGNED             VALUE 'Y'.
  7483         16  PB-I-RATE-CLASS              PIC XX.
  7484         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  7485         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  7486         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 144
* EL689.cbl
  7487         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  7488         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  7489         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  7490         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  7491         16  PB-I-BENEFIT-TYPE            PIC XXX.
  7492         16  PB-I-OB-FLAG                 PIC X.
  7493             88  PB-I-OB                      VALUE 'B'.
  7494             88  PB-I-SUMMARY                 VALUE 'Z'.
  7495         16  PB-I-ENTRY-STATUS            PIC X.
  7496             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  7497                                              'M' '5' '9' '2'.
  7498             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  7499             88  PB-I-POLICY-PENDING          VALUE '2'.
  7500             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  7501             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  7502             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  7503             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  7504             88  PB-I-REIN-ONLY               VALUE '9'.
  7505             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  7506             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  7507             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  7508             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  7509         16  PB-I-INT-CODE                PIC X.
  7510             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  7511             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  7512         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  7513         16  PB-I-SOC-SEC-NO              PIC X(11).
  7514         16  PB-I-MEMBER-NO               PIC X(12).
  7515         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  7516*        16  PB-I-LOAN-OFFICER            PIC XXX.
  7517         16  PB-I-OLD-LOF                 PIC XXX.
  7518         16  PB-I-LF-EXPIRE-DT            PIC XX.
  7519         16  PB-I-AH-EXPIRE-DT            PIC XX.
  7520         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  7521         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  7522         16  PB-I-LIFE-INDICATOR          PIC X.
  7523             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  7524         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  7525         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  7526                                          PIC S9(5)V99    COMP-3.
  7527         16  PB-I-MAIL-ADDRS-SW           PIC X.
  7528             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  7529             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  7530         16  PB-I-1ST-PMT-DT              PIC XX.
  7531         16  PB-I-JOINT-INSURED.
  7532             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  7533             20 PB-I-JOINT-FIRST-NAME.
  7534                24  PB-I-JOINT-FIRST-INIT PIC X.
  7535                24  FILLER                PIC X(9).
  7536             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  7537*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  7538         16  PB-I-BENEFICIARY-NAME.
  7539             20  PB-I-BANK-NUMBER         PIC X(10).
  7540             20  FILLER                   PIC X(15).
  7541         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  7542         16  PB-I-REFERENCE               PIC X(12).
  7543         16  FILLER REDEFINES PB-I-REFERENCE.
  7544             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 145
* EL689.cbl
  7545             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  7546             20  PB-I-CLP-STATE           PIC XX.
  7547         16  PB-I-UNDERWRITING-STATUS     PIC X.
  7548             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  7549             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  7550             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  7551         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  7552         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  7553         16  PB-I-RESIDENT-STATE          PIC XX.
  7554         16  PB-I-RATE-CODE               PIC X(4).
  7555         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  7556         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7557         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7558         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  7559         16  PB-I-BANK-NOCHRGB            PIC 99.
  7560         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  7561         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  7562
  7563     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  7564         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  7565             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  7566         16  PB-C-CANCEL-ORIGIN           PIC X.
  7567             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  7568         16  PB-C-LF-CANCEL-DT            PIC XX.
  7569         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7570         16  PB-C-LF-CALC-REQ             PIC X.
  7571             88 PB-COMP-LF-CANCEL            VALUE '?'.
  7572         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  7573         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  7574         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  7575             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  7576         16  PB-C-AH-CANCEL-DT            PIC XX.
  7577         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  7578         16  PB-C-AH-CALC-REQ             PIC X.
  7579             88 PB-COMP-AH-CANCEL            VALUE '?'.
  7580         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  7581         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  7582         16  PB-C-LAST-NAME               PIC X(15).
  7583         16  PB-C-REFUND-SW               PIC X.
  7584             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  7585             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  7586         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  7587         16  PB-C-PAYEE-CODE              PIC X(6).
  7588         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  7589         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  7590         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  7591         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  7592         16  PB-C-REFERENCE               PIC X(12).
  7593         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  7594         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  7595         16  PB-C-POST-CARD-IND           PIC X.
  7596         16  PB-C-CANCEL-REASON           PIC X.
  7597         16  PB-C-REF-INTERFACE-SW        PIC X.
  7598         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  7599         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  7600         16  FILLER                       PIC X(01).
  7601*        16  FILLER                       PIC X(18).
  7602         16  PB-C-POLICY-FORM-NO          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 146
* EL689.cbl
  7603*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  7604         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  7605         16  PB-CANCELED-CERT-DATA.
  7606             20  PB-CI-INSURED-NAME.
  7607                 24  PB-CI-LAST-NAME      PIC X(15).
  7608                 24  PB-CI-INITIALS       PIC XX.
  7609             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  7610             20  PB-CI-INSURED-SEX        PIC X.
  7611             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  7612             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  7613             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  7614             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  7615             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7616             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  7617             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  7618             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  7619             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  7620             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  7621             20  PB-CI-RATE-CLASS         PIC XX.
  7622             20  PB-CI-RATE-DEV-LF        PIC XXX.
  7623             20  PB-CI-RATE-DEV-AH        PIC XXX.
  7624             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  7625             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  7626             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  7627             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  7628             20  PB-CI-LF-ABBR            PIC X(3).
  7629             20  PB-CI-AH-ABBR            PIC X(3).
  7630             20  PB-CI-OB-FLAG            PIC X.
  7631                 88  PB-CI-OB                VALUE 'B'.
  7632             20  PB-CI-LF-POLICY-STATUS   PIC X.
  7633                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  7634                                           'M' '4' '5' '9' '2'.
  7635                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  7636                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  7637                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  7638                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  7639                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  7640                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  7641                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  7642                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  7643                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  7644                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  7645                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  7646                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  7647                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  7648             20  PB-CI-AH-POLICY-STATUS   PIC X.
  7649                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  7650                                           'M' '4' '5' '9' '2'.
  7651                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  7652                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  7653                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  7654                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  7655                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  7656                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  7657                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  7658                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  7659                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  7660                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 147
* EL689.cbl
  7661                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  7662                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  7663                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  7664             20  PB-CI-PAY-FREQUENCY      PIC 99.
  7665             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  7666             20  PB-CI-SOC-SEC-NO         PIC X(11).
  7667             20  PB-CI-MEMBER-NO          PIC X(12).
  7668             20  PB-CI-INT-CODE           PIC X.
  7669                 88  PB-CI-ADD-ON                  VALUE 'A'.
  7670                 88  PB-CI-SIMPLE                  VALUE 'S'.
  7671             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  7672             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  7673             20  PB-CI-COMP-EXCP-SW       PIC X.
  7674                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  7675                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  7676             20  PB-CI-ENTRY-STATUS       PIC X.
  7677             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  7678             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  7679             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  7680             20  PB-CI-DEATH-DT           PIC XX.
  7681             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  7682             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  7683             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7684             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  7685             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  7686             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  7687             20  PB-CI-ENTRY-DT              PIC XX.
  7688             20  PB-CI-ENTRY-BATCH           PIC X(6).
  7689             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  7690             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  7691             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  7692             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  7693             20  PB-CI-OLD-LOF               PIC XXX.
  7694*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  7695             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  7696             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  7697             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  7698             20  PB-CI-INDV-GRP-CD           PIC X.
  7699             20  PB-CI-BENEFICIARY-NAME.
  7700                 24  PB-CI-BANK-NUMBER       PIC X(10).
  7701                 24  FILLER                  PIC X(15).
  7702             20  PB-CI-NOTE-SW               PIC X.
  7703             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  7704             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  7705             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  7706             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  7707             20  PB-CI-LOAN-OFFICER          PIC X(5).
  7708             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  7709             20  PB-CI-FIRST-NAME            PIC X(10).
  7710             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  7711
  7712         16  FILLER                       PIC X(13).
  7713*032306  16  FILLER                       PIC X(27).
  7714*        16  FILLER                       PIC X(46).
  7715
  7716     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  7717         16  FILLER                       PIC X(10).
  7718         16  PB-M-INSURED-LAST-NAME       PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 148
* EL689.cbl
  7719         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  7720         16  PB-M-INSURED-MID-INIT        PIC X.
  7721         16  PB-M-INSURED-AGE             PIC 99.
  7722         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  7723         16  PB-M-INSURED-SEX             PIC X.
  7724         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  7725         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  7726         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  7727         16  PB-M-INSURED-CITY-STATE.
  7728             20  PB-M-INSURED-CITY        PIC X(28).
  7729             20  PB-M-INSURED-STATE       PIC XX.
  7730         16  PB-M-INSURED-ZIP-CODE.
  7731             20  PB-M-INSURED-ZIP-PRIME.
  7732                 24  PB-M-INSURED-ZIP-1   PIC X.
  7733                     88  PB-M-CANADIAN-POST-CODE
  7734                                             VALUE 'A' THRU 'Z'.
  7735                 24  FILLER               PIC X(4).
  7736             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  7737         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  7738                                        PB-M-INSURED-ZIP-CODE.
  7739             20  PM-M-INS-CAN-POST1       PIC XXX.
  7740             20  PM-M-INS-CAN-POST2       PIC XXX.
  7741             20  FILLER                   PIC XXX.
  7742         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  7743         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  7744         16  PB-M-CRED-BENE-NAME          PIC X(30).
  7745         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  7746         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  7747         16  PB-M-CRED-BENE-CITYST.
  7748             20  PB-M-CRED-BENE-CITY      PIC X(28).
  7749             20  PB-M-CRED-BENE-STATE     PIC XX.
  7750         16  FILLER                       PIC X(92).
  7751
  7752     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  7753         16  FILLER                       PIC X(10).
  7754         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7755         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7756         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7757         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7758         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7759         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7760         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7761         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7762         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7763         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  7764         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  7765         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  7766         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  7767         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  7768         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  7769         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  7770         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  7771         16  PB-ACCOUNT-NAME              PIC X(30).
  7772         16  PB-PREM-REF-RPT-FLAG         PIC X.
  7773         16  PB-REFERENCE                 PIC X(12).
  7774         16  PB-B-RECEIVED-DT             PIC XX.
  7775         16  FILLER                       PIC X(234).
  7776
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 149
* EL689.cbl
  7777     12  PB-RECORD-STATUS.
  7778         16  PB-CREDIT-SELECT-DT          PIC XX.
  7779         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  7780         16  PB-BILLED-DT                 PIC XX.
  7781         16  PB-BILLING-STATUS            PIC X.
  7782             88  PB-ENTRY-REVERSED            VALUE 'R'.
  7783             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  7784             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  7785         16  PB-RECORD-BILL               PIC X.
  7786             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  7787             88  PB-RECORD-RETURNED           VALUE 'R'.
  7788             88  PB-RECORD-ENDORSED           VALUE 'E'.
  7789             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  7790             88  PB-OVERRIDE-AH               VALUE 'A'.
  7791             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  7792         16  PB-BATCH-ENTRY               PIC X.
  7793             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  7794             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  7795             88  PB-REISSUED-CERT             VALUE 'E'.
  7796             88  PB-CASH-CERT                 VALUE 'C'.
  7797             88  PB-MONTHLY-CERT              VALUE 'M'.
  7798             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  7799             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  7800             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  7801         16  PB-FORCE-CODE                PIC X.
  7802             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  7803             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  7804             88  PB-CANCEL-FORCE              VALUE '8'.
  7805             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  7806             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  7807             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  7808             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  7809             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  7810             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  7811             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  7812             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  7813         16  PB-FATAL-FLAG                PIC X.
  7814             88  PB-FATAL-ERRORS              VALUE 'X'.
  7815         16  PB-FORCE-ER-CD               PIC X.
  7816             88  PB-FORCE-ERRORS              VALUE 'F'.
  7817             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  7818         16  PB-WARN-ER-CD                PIC X.
  7819             88  PB-WARNING-ERRORS            VALUE 'W'.
  7820         16  FILLER                       PIC X.
  7821         16  PB-OUT-BAL-CD                PIC X.
  7822             88  PB-OUT-OF-BAL                VALUE 'O'.
  7823         16  PB-LIFE-OVERRIDE-L1          PIC X.
  7824         16  PB-AH-OVERRIDE-L1            PIC X.
  7825         16  PB-INPUT-DT                  PIC XX.
  7826         16  PB-INPUT-BY                  PIC X(4).
  7827         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  7828         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  7829         16  PB-TOLERANCE-REJECT-SW       PIC X.
  7830         16  PB-LF-EARNING-METHOD         PIC X.
  7831         16  PB-AH-EARNING-METHOD         PIC X.
  7832         16  PB-LF-TERM-CALC-METHOD       PIC X.
  7833         16  PB-AH-TERM-CALC-METHOD       PIC X.
  7834         16  PB-REIN-CD                   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 150
* EL689.cbl
  7835         16  PB-LF-REFUND-TYPE            PIC X.
  7836         16  PB-AH-REFUND-TYPE            PIC X.
  7837         16  PB-ACCT-EFF-DT               PIC XX.
  7838         16  PB-ACCT-EXP-DT               PIC XX.
  7839         16  PB-COMPANY-ID                PIC X(3).
  7840         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7841         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  7842         16  PB-SV-CARRIER                PIC X.
  7843         16  PB-SV-GROUPING               PIC X(6).
  7844         16  PB-SV-STATE                  PIC XX.
  7845         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  7846         16  PB-GA-BILLING-INFO.
  7847             20  PB-GA-BILL-DT OCCURS 5 TIMES
  7848                                          PIC XX.
  7849         16  PB-SV-REMIT-TO  REDEFINES
  7850             PB-GA-BILLING-INFO           PIC X(10).
  7851         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  7852         16  PB-I-LOAN-OFFICER            PIC X(5).
  7853         16  PB-I-VIN                     PIC X(17).
  7854
  7855         16  FILLER                       PIC X(04).
  7856         16  IMNET-BYPASS-SW              PIC X.
  7857
  7858******************************************************************
  7859*                COMMON EDIT ERRORS                              *
  7860******************************************************************
  7861
  7862     12  PB-COMMON-ERRORS.
  7863         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  7864                                           PIC S9(4)     COMP.
  7865
  7866******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 151
* EL689.cbl
  7868*    COPY ERCPYAJ.
  7869******************************************************************
  7870*                                                                *
  7871*                            ERCPYAJ                             *
  7872*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  7873*                            VMOD=2.015                          *
  7874*                                                                *
  7875*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  7876*                                                                *
  7877*                                                                *
  7878*   FILE TYPE = VSAM,KSDS                                        *
  7879*   RECORD SIZE = 200  RECFORM = FIXED                           *
  7880*                                                                *
  7881*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  7882*       ALTERNATE PATHS = NONE                                   *
  7883*                                                                *
  7884*   LOG = YES                                                    *
  7885*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  7886******************************************************************
  7887******************************************************************
  7888*                   C H A N G E   L O G
  7889*
  7890* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  7891*-----------------------------------------------------------------
  7892*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  7893* EFFECTIVE    NUMBER
  7894*-----------------------------------------------------------------
  7895* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  7896* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  7897******************************************************************
  7898
  7899 01  PENDING-PAY-ADJ.
  7900     12  PY-RECORD-ID                     PIC XX.
  7901         88  VALID-PY-ID                        VALUE 'PY'.
  7902
  7903     12  PY-CONTROL-PRIMARY.
  7904         16  PY-COMPANY-CD                PIC X.
  7905         16  PY-CARRIER                   PIC X.
  7906         16  PY-GROUPING                  PIC X(6).
  7907         16  PY-FIN-RESP                  PIC X(10).
  7908         16  PY-ACCOUNT                   PIC X(10).
  7909         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  7910                                          PIC X(10).
  7911         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  7912         16  PY-RECORD-TYPE               PIC X.
  7913             88  PY-REMIT-RECEIVED            VALUE 'R'.
  7914             88  PY-DEPOSIT                   VALUE 'D'.
  7915             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  7916             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  7917             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  7918             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  7919             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  7920             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  7921             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  7922             88  PY-FICA-ENTRY                VALUE 'F'.
  7923             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  7924             88  PY-POLICY-FEE                VALUE 'W'.
  7925             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 152
* EL689.cbl
  7926
  7927     12  PY-PYMT-TYPE                     PIC X.
  7928             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  7929             88  PY-REINS-PYMT                VALUE 'R'.
  7930             88  PY-EXP-PYMT                  VALUE 'E'.
  7931
  7932     12  PY-BIL-INV                       PIC X(6).
  7933     12  PY-REF-NO                        PIC X(12).
  7934
  7935     12  PY-LAST-MAINT-DT                 PIC XX.
  7936     12  PY-LAST-MAINT-BY                 PIC X(4).
  7937     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  7938
  7939     12  PY-PYADJ-RECORD.
  7940         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  7941         16  PY-ENTRY-COMMENT             PIC X(30).
  7942         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  7943             20  PY-GL-ACCOUNT            PIC X(10).
  7944             20  PY-GL-STATE              PIC X(02).
  7945             20  PY-GL-CANC-SW            PIC X(01).
  7946                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  7947                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  7948             20  PY-GL-COMMENT            PIC X(10).
  7949             20  FILLER      REDEFINES PY-GL-COMMENT.
  7950                 24  PY-GL-CHECK-NO       PIC 9(06).
  7951                 24  FILLER               PIC X(04).
  7952             20  FILLER                   PIC X(07).
  7953         16  PY-SAVE-ACCOUNT              PIC X(10).
  7954         16  PY-SAVE-TYPE                 PIC X(01).
  7955
  7956         16  PY-LETTERS.
  7957             20  PY-LETTER OCCURS 3 TIMES
  7958                           INDEXED BY PY-LET-NDX
  7959                                          PIC X(04).
  7960
  7961         16  PY-ERCOMP-TYPE               PIC X.
  7962             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  7963             88  PY-GA-TYPE                   VALUE 'G'.
  7964             88  PY-BANK-TYPE                 VALUE 'B'.
  7965         16  FILLER                       PIC X(05).
  7966
  7967     12  PY-RECORD-STATUS.
  7968         16  PY-CREDIT-SELECT-DT          PIC XX.
  7969         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  7970         16  PY-BILLED-DATE               PIC XX.
  7971         16  PY-REPORTED-DT               PIC XX.
  7972         16  PY-PMT-APPLIED               PIC X.
  7973             88  PY-ACCOUNT-PMT               VALUE 'A'.
  7974             88  PY-GA-PMT                    VALUE 'G'.
  7975             88  PY-OVWRITE-PMT               VALUE 'O'.
  7976             88  PY-NON-AR-PMT                VALUE 'N'.
  7977         16  FILLER                       PIC X(5).
  7978         16  PY-INPUT-DT                  PIC XX.
  7979         16  PY-CHECK-NUMBER              PIC X(6).
  7980         16  PY-VOID-SW                   PIC X.
  7981             88  PY-CHECK-VOIDED              VALUE 'V'.
  7982         16  PY-CHECK-ORIGIN-SW           PIC X.
  7983             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 153
* EL689.cbl
  7984             88  PY-REFUND-CHECK              VALUE 'R'.
  7985             88  PY-GA-CHECK                  VALUE 'G'.
  7986             88  PY-CHECK-WRITTEN             VALUE 'W'.
  7987             88  PY-CHECK-REVERSAL            VALUE 'V'.
  7988         16  PY-CHECK-WRITTEN-DT          PIC XX.
  7989         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  7990         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  7991         16  PY-BILL-FLAG                 PIC X.
  7992             88  PY-BILLED                    VALUE 'B'.
  7993         16  PY-AR-FLAG                   PIC X.
  7994             88  PY-AR-CYCLE                  VALUE 'C'.
  7995             88  PY-AR-MONTH-END              VALUE 'M'.
  7996         16  PY-AR-DATE                   PIC XX.
  7997
  7998     12  PY-GL-CODES.
  7999         16  PY-GL-DB                     PIC X(14).
  8000         16  PY-GL-CR                     PIC X(14).
  8001         16  PY-GL-FLAG                   PIC X.
  8002         16  PY-GL-DATE                   PIC XX.
  8003
  8004     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  8005     12  FILLER                           PIC X(3).
  8006******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 154
* EL689.cbl
  8008*    COPY ELCTEXT.
  8009******************************************************************
  8010*                                                                *
  8011*                                                                *
  8012*                            ELCTEXT.                            *
  8013*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8014*                            VMOD=2.008                          *
  8015*                                                                *
  8016*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  8017*                                     FORM LETTERS,              *
  8018*                                     CERT FORM DISPLAY.
  8019*                                                                *
  8020*   FILE TYPE = VSAM,KSDS                                        *
  8021*   RECORD SIZE = 100   RECFORM = FIXED                          *
  8022*                                                                *
  8023*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  8024*       ALTERNATE INDEX = NONE                                   *
  8025*                                                                *
  8026*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  8027*       ALTERNATE INDEX = NONE                                   *
  8028*                                                                *
  8029*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  8030*       ALTERNATE INDEX = NONE                                   *
  8031*                                                                *
  8032*   LOG = NO                                                     *
  8033*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8034******************************************************************
  8035 01  TEXT-FILES.
  8036     12  TEXT-FILE-ID                PIC XX.
  8037         88  FORMS-FILE-TEXT            VALUE 'TF'.
  8038         88  LETTER-FILE-TEXT           VALUE 'TL'.
  8039         88  HELP-FILE-TEXT             VALUE 'TH'.
  8040
  8041     12  TX-CONTROL-PRIMARY.
  8042         16  TX-COMPANY-CD           PIC X.
  8043             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  8044         16  TX-ACCESS-CD-GENL       PIC X(12).
  8045
  8046         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  8047             20  TX-LETTER-NO        PIC X(4).
  8048             20  FILLER              PIC X(8).
  8049
  8050         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  8051             20  TX-FORM-NO          PIC X(12).
  8052
  8053         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  8054             20  TX-HELP-TYPE        PIC X.
  8055                 88  HELP-FOR-GENERAL   VALUE ' '.
  8056                 88  HELP-BY-SCREEN     VALUE 'S'.
  8057                 88  HELP-BY-ERROR      VALUE 'E'.
  8058             20  TX-SCREEN-OR-ERROR  PIC X(4).
  8059                 88  GENERAL-INFO-HELP  VALUE '0000'.
  8060             20  TX-HELP-FOR-COMPANY  PIC XXX.
  8061                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  8062             20  FILLER              PIC X(4).
  8063
  8064         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  8065
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 155
* EL689.cbl
  8066     12  TX-PROCESS-CONTROL          PIC XX.
  8067         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  8068
  8069     12  TX-TEXT-LINE                PIC X(70).
  8070
  8071     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  8072         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  8073         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  8074         88  TX-VALID-FORM-SQUEEZE-VALUE
  8075                                        VALUE 'Y' ' '.
  8076
  8077     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  8078         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  8079         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  8080         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  8081         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  8082         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  8083         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  8084         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  8085                                              'K' 'N' ' '
  8086                                              'Z'.
  8087
  8088     12  TX-ARCHIVE-SW               PIC X.
  8089         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  8090         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  8091         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  8092
  8093     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  8094     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  8095
  8096     12  TX-BSR-CODE                 PIC X.
  8097         88  TX-BSR-LETTER              VALUE 'B'.
  8098         88  TX-NON-BSR-LETTER          VALUE ' '.
  8099
  8100     12  FILLER                      PIC X.
  8101*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 156
* EL689.cbl
  8103*    COPY ERCENDT.
  8104******************************************************************
  8105*                                                                *
  8106*                                                                *
  8107*                            ERCENDT.                            *
  8108*                            VMOD=2.001                          *
  8109*                                                                *
  8110*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  8111*                                                                *
  8112*   FILE TYPE = VSAM,KSDS                                        *
  8113*   RECORD SIZE = 579  RECFORM = FIXED                           *
  8114*                                                                *
  8115*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  8116*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  8117*                                                                *
  8118*   LOG = NO                                                     *
  8119*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8120******************************************************************
  8121*-----------------------------------------------------------------
  8122*                   C H A N G E   L O G
  8123*
  8124* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8125*-----------------------------------------------------------------
  8126*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8127* EFFECTIVE    NUMBER
  8128*-----------------------------------------------------------------
  8129* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  8130*                                WITH OPEN CLAIMS
  8131* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  8132* 110612    2012101700002  AJRA  ADD NEW FIELDS
  8133* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  8134* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  8135*-----------------------------------------------------------------
  8136 01  ENDORSEMENT-RECORD.
  8137     12  EN-RECORD-ID                PIC XX.
  8138         88  VALID-EN-ID                VALUE 'EN'.
  8139     12  EN-CONTROL-PRIMARY.
  8140         16  EN-COMPANY-CD           PIC X.
  8141         16  EN-CARRIER              PIC X.
  8142         16  EN-GROUPING             PIC X(6).
  8143         16  EN-STATE                PIC XX.
  8144         16  EN-ACCOUNT              PIC X(10).
  8145         16  EN-CERT-EFF-DT          PIC XX.
  8146         16  EN-CERT-NO.
  8147             20  EN-CERT-PRIME       PIC X(10).
  8148             20  EN-CERT-SFX         PIC X.
  8149         16  EN-REC-TYPE             PIC X.
  8150             88  EN-ISSUE               VALUE 'I'.
  8151             88  EN-CANCELLATION        VALUE 'C'.
  8152         16  EN-SEQ-NO               PIC 9(04) BINARY.
  8153     12  EN-CONTROL-BY-ARCH-NO.
  8154         16  EN-COMPANY-CD-A1              PIC X.
  8155         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  8156     12  EN-LAST-MAINT-DT            PIC XX.
  8157     12  EN-LAST-MAINT-BY            PIC X(4).
  8158     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  8159     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  8160     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 157
* EL689.cbl
  8161         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  8162         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  8163         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  8164         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  8165         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  8166         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  8167         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  8168         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  8169         16  EN-LF-ORIG-BENCD        PIC XX.
  8170         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  8171         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  8172         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  8173         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  8174         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  8175         16  EN-LF-ORIG-EXP-DT       PIC XX.
  8176*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  8177         16  EN-ORIG-CRED-BENE       PIC X(25).
  8178         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  8179         16  FILLER                  PIC X.
  8180         16  EN-AH-ORIG-BENCD        PIC XX.
  8181         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  8182         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  8183         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  8184         16  EN-AH-ORIG-EXP-DT       PIC XX.
  8185*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  8186*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  8187         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  8188         16  F                       PIC X(09).
  8189         16  EN-AH-ORIG-CP           PIC 99.
  8190         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  8191         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  8192         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  8193         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  8194         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  8195         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  8196         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  8197         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  8198         16  EN-LF-NEW-BENCD         PIC XX.
  8199         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  8200         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8201         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8202         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  8203         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  8204         16  EN-LF-NEW-EXP-DT        PIC XX.
  8205         16  EN-NEW-CRED-BENE        PIC X(25).
  8206         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  8207         16  FILLER                  PIC X.
  8208         16  EN-AH-NEW-BENCD         PIC XX.
  8209         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  8210         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  8211         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  8212         16  EN-AH-NEW-EXP-DT        PIC XX.
  8213*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  8214*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  8215*        16  F                       PIC X(12).
  8216         16  EN-AH-NEW-CP            PIC 99.
  8217         16  EN-SIG-SW               PIC X.
  8218         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 158
* EL689.cbl
  8219         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  8220         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  8221         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  8222         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  8223         16  FILLER                  PIC X(33).
  8224     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  8225         16  EN-LF-ORIG-REF-DT       PIC XX.
  8226         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8227         16  EN-AH-ORIG-REF-DT       PIC XX.
  8228         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  8229         16  EN-LF-NEW-REF-DT        PIC XX.
  8230         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8231         16  EN-AH-NEW-REF-DT        PIC XX.
  8232         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  8233         16  EN-FLAG-CERT            PIC X.
  8234         16  EN-INS-LAST-NAME        PIC X(15).
  8235         16  EN-INS-FIRST-NAME       PIC X(10).
  8236         16  EN-INS-MIDDLE-INIT      PIC X.
  8237         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8238         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  8239         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8240         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  8241         16  FILLER                  PIC X(262).
  8242     12  EN-MONEY-SW             PIC X.
  8243     12  EN-HEALTH-APP           PIC X.
  8244     12  EN-VOUCHER-SW           PIC X.
  8245     12  EN-PAYEE                PIC X(14).
  8246     12  EN-INPUT-DT             PIC XX.
  8247     12  EN-PROCESS-DT           PIC XX.
  8248     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  8249     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  8250     12  EN-REASON-CODES.
  8251         16  F OCCURS 12.
  8252             20  EN-REASON-CODE  PIC X(4).
  8253     12  EN-TEMPLATE-USED        PIC X(8).
  8254     12  EN-DOCU-TYPE            PIC X.
  8255         88  EN-VERI-DOCU          VALUE 'V'.
  8256         88  EN-GCE-DOCU           VALUE 'G'.
  8257         88  EN-CANC-DOCU          VALUE 'C'.
  8258     12  EN-COMMENTS1            PIC X(13).
  8259     12  EN-COMMENTS2            PIC X(70).
  8260     12  EN-COMM-CHGBK           PIC X.
  8261         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  8262         88  EN-CHG-ACCT           VALUE 'Y'.
  8263     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  8264     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  8265     12  EN-BATCH-NUMBER         PIC X(6).
  8266     12  EN-ACCT-SUMM            PIC X.
  8267     12  EN-CSO-SUMM             PIC X.
  8268     12  en-check-type           pic x.
  8269     12  FILLER                  PIC X(12).
  8270******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 159
* EL689.cbl
  8272*    COPY ERCNOTE.
  8273******************************************************************
  8274*                                                                *
  8275*                                                                *
  8276*                            ERCNOTE                             *
  8277*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  8278*                            VMOD=2.003                          *
  8279*                                                                *
  8280*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  8281*                                                                *
  8282*        FILE TYPE= VSAM,KSDS                                    *
  8283*        RECORD SIZE = 825    RECFORM = FIXED                    *
  8284*                                                                *
  8285*        BASE CLUSTER = ERNOTE        RKP=2,LEN=34               *
  8286*                                                                *
  8287*        LOG = YES                                               *
  8288*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  8289*                                                                *
  8290******************************************************************
  8291*                   C H A N G E   L O G
  8292*
  8293* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8294*-----------------------------------------------------------------
  8295*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8296* EFFECTIVE    NUMBER
  8297*-----------------------------------------------------------------
  8298* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  8299*                                FILE WILL CONTAIN BILLING NOTES O
  8300* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
  8301******************************************************************
  8302
  8303 01  CERTIFICATE-NOTE.
  8304     12  CN-RECORD-ID                PIC  XX.
  8305         88  VALID-CN-ID                  VALUE 'CN'.
  8306
  8307     12  CN-CONTROL-PRIMARY.
  8308         16  CN-COMPANY-CD           PIC X.
  8309         16  CN-CARRIER              PIC X.
  8310         16  CN-GROUPING.
  8311             20 CN-GROUPING-PREFIX   PIC XXX.
  8312             20 CN-GROUPING-PRIME    PIC XXX.
  8313         16  CN-STATE                PIC XX.
  8314         16  CN-ACCOUNT.
  8315             20 CN-ACCOUNT-PREFIX    PIC X(4).
  8316             20 CN-ACCOUNT-PRIME     PIC X(6).
  8317         16  CN-CERT-EFF-DT          PIC XX.
  8318         16  CN-CERT-NO.
  8319             20  CN-CERT-PRIME       PIC X(10).
  8320             20  CN-CERT-SFX         PIC X.
  8321         16  CN-RECORD-TYPE          PIC X.
  8322             88  CN-ISSUE-BILLING-NOTE    VALUE '1'.
  8323             88  CN-CANCEL-BILLING-NOTE   VALUE '2'.
  8324     12  CN-BILLING-START-LINE-NO    PIC 99.
  8325     12  CN-BILLING-END-LINE-NO      PIC 99.
  8326
  8327     12  CN-LINES.
  8328         16  CN-LINE OCCURS 10       PIC X(77).
  8329
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 160
* EL689.cbl
  8330     12  CN-LAST-MAINT-DT            PIC XX.
  8331     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  8332     12  CN-LAST-MAINT-USER          PIC X(4).
  8333     12  FILLER                      PIC X(5).
  8334******************************************************************
  8335*    COPY ELCEOBC.
  8336******************************************************************
  8337*                                                                *
  8338*                                                                *
  8339*                            ELCEOBC                             *
  8340*                            VMOD=2.001                          *
  8341*                                                                *
  8342*   CLAIM SYSTEM EOB CODE TABLE                                  *
  8343*                                                                *
  8344*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  8345*   VSAM EOB CODE TABLE                                          *
  8346*                                                                *
  8347*   FILE DESCRIPTION = EOB CODE TABLE                            *
  8348*                                                                *
  8349*   FILE TYPE = VSAM,KSDS                                        *
  8350*   RECORD SIZE = 350   RECFORM = FIX                            *
  8351*                                                                *
  8352*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  8353*                                                                *
  8354*   LOG = NO                                                     *
  8355*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8356*                                                                *
  8357*                                                                *
  8358******************************************************************
  8359*                   C H A N G E   L O G
  8360*
  8361* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8362*-----------------------------------------------------------------
  8363*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8364* EFFECTIVE    NUMBER
  8365*-----------------------------------------------------------------
  8366* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  8367* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  8368* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  8369******************************************************************
  8370 01  EOB-CODES.
  8371     12  EO-RECORD-ID                      PIC XX.
  8372         88  VALID-DN-ID                      VALUE 'EO'.
  8373     12  EO-CONTROL-PRIMARY.
  8374         16  EO-COMPANY-CD                 PIC X.
  8375         16  EO-RECORD-TYPE                PIC X.
  8376             88  EO-EOB-RECS                  VALUE '1'.
  8377             88  EO-VERIF-RECS                VALUE '2'.
  8378             88  EO-GCE-RECS                  VALUE '3'.
  8379             88  EO-CANC-RECS                 VALUE '4'.
  8380             88  EO-BILL-NOTE-RECS            VALUE '5'.
  8381         16  EO-EOB-CODE                   PIC X(4).
  8382         16  FILLER                        PIC X(9).
  8383     12  EO-MAINT-INFORMATION.
  8384         16  EO-LAST-MAINT-DT              PIC XX.
  8385         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8386         16  EO-LAST-MAINT-USER            PIC X(4).
  8387         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 161
* EL689.cbl
  8388     12  EO-DESCRIPTION                    PIC X(275).
  8389     12  FILLER                            PIC X(46).
  8390******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 162
* EL689.cbl
  8392*    COPY ELCENCC.
  8393******************************************************************
  8394*                                                                *
  8395*                                                                *
  8396*                            ELCENCC                             *
  8397*                            VMOD=2.001                          *
  8398*                                                                *
  8399*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  8400*                                                                *
  8401*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  8402*   A NAPERSOFT DOCUMENT                                         *
  8403*                                                                *
  8404*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  8405*                                                                *
  8406*   FILE TYPE = VSAM,KSDS                                        *
  8407*   RECORD SIZE = 400   RECFORM = FIX                            *
  8408*                                                                *
  8409*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  8410*                                                                *
  8411*   LOG = NO                                                     *
  8412*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  8413*                                                                *
  8414*                                                                *
  8415******************************************************************
  8416*                   C H A N G E   L O G
  8417*
  8418* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  8419*-----------------------------------------------------------------
  8420*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  8421* EFFECTIVE    NUMBER
  8422*-----------------------------------------------------------------
  8423* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  8424* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  8425******************************************************************
  8426 01  ENCLOSURE-CODES.
  8427     12  NC-RECORD-ID                      PIC XX.
  8428         88  VALID-NC-ID                      VALUE 'NC'.
  8429     12  NC-CONTROL-PRIMARY.
  8430         16  NC-COMPANY-CD                 PIC X.
  8431         16  NC-REC-TYPE                   PIC X.
  8432             88  NC-CLAIMS                   VALUE '1'.
  8433             88  NC-ADMIN                    VALUE '2'.
  8434         16  NC-ENC-CODE                   PIC X(5).
  8435         16  FILLER                        PIC X(09).
  8436     12  NC-MAINT-INFORMATION.
  8437         16  NC-LAST-MAINT-DT              PIC XX.
  8438         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  8439         16  NC-LAST-MAINT-USER            PIC X(4).
  8440         16  FILLER                        PIC XX.
  8441     12  NC-OUTPUT-STACK                   PIC XXX.
  8442     12  NC-ENCLOSURE-LINE                 PIC X(100).
  8443     12  NC-ATTACHMENTS                    PIC X(255).
  8444     12  NC-FUTURE                         PIC X(12).
  8445******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 163
* EL689.cbl
  8447 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  8448                          ACCOUNT-MASTER LETTER-ARCHIVE
  8449                          LETTER-ARCHIVE-TEXT
  8450                          CERTIFICATE-MASTER CHECK-RECORDS
  8451                          CONTROL-FILE COMPENSATION-MASTER
  8452                          MAILING-DATA PENDING-BUSINESS
  8453                          PENDING-PAY-ADJ TEXT-FILES
  8454                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  8455                          EOB-CODES ENCLOSURE-CODES.
  8456 0000-DFHEXIT SECTION.
  8457     MOVE '9#                    $   ' TO DFHEIV0.
  8458     MOVE 'EL689' TO DFHEIV1.
  8459     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  8460     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  8461
  8462     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8463     MOVE '5'                    TO DC-OPTION-CODE.
  8464     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  8465     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  8466     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE
  8467                                    W-CURRENT-SAVE.
  8468     MOVE DC-GREG-DATE-A-EDIT    TO W-SAVE-EDIT-A-DATE
  8469     MOVE DC-DAY-OF-WEEK         TO W-SAVE-CYCLE-DAY-OF-WEEK
  8470
  8471     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  8472     MOVE ERROR-MESSAGE-INTERFACE-BLOCK
  8473                                 TO EMI-SAVE-AREA.
  8474
  8475     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8476                                    W-TS-TERM-SCREEN.
  8477
  8478     IF  EIBCALEN EQUAL 0
  8479         MOVE UNACCESS-MSG       TO LOGOFF-MSG
  8480         GO TO 8300-SEND-TEXT
  8481     END-IF.
  8482     set P to address of KIXSYS
  8483     CALL "getenv" using by value P returning var-ptr
  8484     if var-ptr = null then
  8485        display ' kixsys not set '
  8486     else
  8487        set address of var to var-ptr
  8488        move 0 to env-var-len
  8489        inspect var tallying env-var-len
  8490          for characters before X'00'
  8491*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  8492        unstring var (1:env-var-len) delimited by '/'
  8493           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8494              WS-KIX-SYS
  8495        end-unstring
  8496*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  8497*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8498     end-if
  8499     set P to address of KIXHOST
  8500     CALL "getenv" using by value P returning var-ptr
  8501     if var-ptr = null then
  8502        display ' kixhost not set '
  8503     else
  8504        set address of var to var-ptr
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 164
* EL689.cbl
  8505        move 0 to env-var-len
  8506        inspect var tallying env-var-len
  8507          for characters before X'00'
  8508*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  8509        MOVE var(1:env-var-len)  to ws-kixhost
  8510*       unstring var (1:env-var-len) delimited by '/'
  8511*          into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8512*             WS-KIX-SYS
  8513*       end-unstring
  8514        DISPLAY ' WS KIX HOST ' WS-KIXSYS
  8515*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8516     end-if
  8517
  8518**** This routine will connect to the Logic Database on SQL Server
  8519**** and call a stored procedure to determine the next business da
  8520
  8521     PERFORM 4500-CONNECT-TO-DB  THRU 4500-EXIT
  8522     IF SQLCODE = 0
  8523        PERFORM 4600-GET-NEXT-BUS-DT  THRU 4600-EXIT
  8524        IF SQLCODE = 0
  8525            MOVE WS-NEXT-BUS-DT TO W-SAVE-NEXT-BUS-DT-EDIT-A
  8526                                   W-EDIT-A-DATE
  8527            MOVE W-EDIT-A-YY    TO DC-YMD-YEAR
  8528            MOVE W-EDIT-A-MM    TO DC-YMD-MONTH
  8529            MOVE W-EDIT-A-DD    TO DC-YMD-DAY
  8530            MOVE '3'            TO DC-OPTION-CODE
  8531            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8532            IF NO-CONVERSION-ERROR
  8533               MOVE DC-BIN-DATE-1 TO W-SAVE-BIN-NEXT-BUS-DT
  8534            ELSE
  8535               MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8536               MOVE '6'         TO DC-OPTION-CODE
  8537               MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8538               IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
  8539                  MOVE 3        TO DC-ELAPSED-DAYS
  8540               ELSE
  8541                 IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8542                    MOVE 2     TO DC-ELAPSED-DAYS
  8543                 ELSE
  8544                    MOVE 1     TO DC-ELAPSED-DAYS
  8545                 END-IF
  8546               END-IF
  8547               PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8548               IF NO-CONVERSION-ERROR
  8549                   MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8550                   MOVE DC-GREG-DATE-A-EDIT TO
  8551                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8552               ELSE
  8553                   MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8554                   MOVE W-SAVE-EDIT-A-DATE TO
  8555                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8556               END-IF
  8557            END-IF
  8558        ELSE
  8559            MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8560            MOVE '6'         TO DC-OPTION-CODE
  8561            MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8562            IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 165
* EL689.cbl
  8563               MOVE 3        TO DC-ELAPSED-DAYS
  8564            ELSE
  8565              IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8566                 MOVE 2     TO DC-ELAPSED-DAYS
  8567              ELSE
  8568                 MOVE 1     TO DC-ELAPSED-DAYS
  8569              END-IF
  8570            END-IF
  8571            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8572            IF NO-CONVERSION-ERROR
  8573                MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8574                MOVE DC-GREG-DATE-A-EDIT TO
  8575                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8576            ELSE
  8577                MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8578                MOVE W-SAVE-EDIT-A-DATE TO
  8579                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8580            END-IF
  8581        END-IF
  8582     ELSE
  8583        MOVE W-SAVE-BIN-DATE TO DC-BIN-DATE-1
  8584        MOVE '6'         TO DC-OPTION-CODE
  8585        MOVE ZEROS       TO DC-ELAPSED-MONTHS
  8586        IF W-SAVE-CYCLE-DAY-OF-WEEK = 6
  8587           MOVE 3        TO DC-ELAPSED-DAYS
  8588        ELSE
  8589          IF W-SAVE-CYCLE-DAY-OF-WEEK = 7
  8590             MOVE 2     TO DC-ELAPSED-DAYS
  8591          ELSE
  8592             MOVE 1     TO DC-ELAPSED-DAYS
  8593          END-IF
  8594        END-IF
  8595        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8596        IF NO-CONVERSION-ERROR
  8597            MOVE DC-BIN-DATE-2 TO W-SAVE-BIN-NEXT-BUS-DT
  8598            MOVE DC-GREG-DATE-A-EDIT TO
  8599                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8600        ELSE
  8601            MOVE W-SAVE-BIN-DATE TO W-SAVE-BIN-NEXT-BUS-DT
  8602            MOVE W-SAVE-EDIT-A-DATE TO
  8603                                W-SAVE-NEXT-BUS-DT-EDIT-A
  8604        END-IF
  8605     END-IF
  8606     PERFORM 4700-DISCONNECT THRU 4700-EXIT
  8607
  8608     IF  PI-689-CREATE-NO-SCREENS
  8609         GO TO 0600-BYPASS-SCREEN-CNTL
  8610     END-IF.
  8611
  8612     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  8613         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  8614             MOVE PI-SAVED-PROGRAM-5
  8615                                 TO PI-SAVED-PROGRAM-6
  8616             MOVE PI-SAVED-PROGRAM-4
  8617                                 TO PI-SAVED-PROGRAM-5
  8618             MOVE PI-SAVED-PROGRAM-3
  8619                                 TO PI-SAVED-PROGRAM-4
  8620             MOVE PI-SAVED-PROGRAM-2
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 166
* EL689.cbl
  8621                                 TO PI-SAVED-PROGRAM-3
  8622             MOVE PI-SAVED-PROGRAM-1
  8623                                 TO PI-SAVED-PROGRAM-2
  8624             MOVE PI-RETURN-TO-PROGRAM
  8625                                 TO PI-SAVED-PROGRAM-1
  8626             MOVE PI-CALLING-PROGRAM
  8627                                 TO PI-RETURN-TO-PROGRAM
  8628             MOVE W-THIS-PGM     TO PI-CALLING-PROGRAM
  8629             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8630             MOVE LOW-VALUES     TO EL689AO
  8631             PERFORM 9905-INITIALIZE-SECURITY THRU 9905-EXIT
  8632             IF PI-689-ARCHIVE-NUMBER NOT NUMERIC
  8633                MOVE ZEROS       TO PI-689-ARCHIVE-NUMBEr
  8634             END-IF
  8635             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  8636                     AND
  8637                 PI-689-KEY-DATA-FIELDS GREATER THAN LOW-VALUES
  8638                 GO TO 0400-EL6311-INCOMING
  8639             ELSE
  8640                 MOVE PI-689-ARCHIVE-NUMBER
  8641                                 TO W-INCOMING-ARCHIVE
  8642                 MOVE LOW-VALUES TO PI-1042-WA
  8643                                    PI-689-WORK-AREA
  8644                 MOVE ZEROS      TO PI-CURRENT-LINE
  8645                                    PI-TEMP-STOR-ITEMS
  8646                                    PI-TOTAL-LINES
  8647                                    PI-UPDATE-SW
  8648                                    PI-689-NUMBER-LABEL-LINES
  8649                                    PI-689-NUMBER-TEXT-RECORDS
  8650                                    PI-689-ERROR
  8651                 MOVE SPACES     TO PI-689-PRINT-SW
  8652                                    PI-689-ALT-PRINTER-ID
  8653                                    PI-689-LBL-OVERRIDE
  8654                                    PI-COMM-CONTROL
  8655                                    PI-689-FORM-NUMBER
  8656                                    PI-689-TEMP-STOR-ID
  8657                                    PI-689-LABEL-SOURCE
  8658                                    PI-689-USE-SCREEN-IND
  8659                 MOVE '2'        TO PI-ACTION
  8660                 MOVE -1         TO MAINTL
  8661                 MOVE PI-LOWER-CASE-LETTERS
  8662                                 TO W-LC-CASE-IND
  8663                 IF  W-INCOMING-ARCHIVE NUMERIC
  8664                         AND
  8665                     W-INCOMING-ARCH-NO GREATER THAN ZEROS
  8666                     MOVE 'S'    TO MAINTI
  8667                     MOVE +1     TO MAINTL
  8668                     MOVE AL-UANON
  8669                                 TO MAINTA
  8670                     MOVE W-INCOMING-ARCH-NO
  8671                                 TO ARCHNUMI
  8672                     MOVE +8     TO ARCHNUML
  8673                     MOVE AL-UNNON
  8674                                 TO ARCHNUMA
  8675                     GO TO 1000-SHOW
  8676                 ELSE
  8677                     GO TO 0450-SPECIAL-INPUT-PROCESS
  8678                 END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 167
* EL689.cbl
  8679             END-IF
  8680         ELSE
  8681             MOVE PI-CALLING-PROGRAM TO W-CALL-PGM
  8682             MOVE PI-RETURN-TO-PROGRAM
  8683                                     TO PI-CALLING-PROGRAM
  8684             MOVE PI-SAVED-PROGRAM-1 TO PI-RETURN-TO-PROGRAM
  8685             MOVE PI-SAVED-PROGRAM-2 TO PI-SAVED-PROGRAM-1
  8686             MOVE PI-SAVED-PROGRAM-3 TO PI-SAVED-PROGRAM-2
  8687             MOVE PI-SAVED-PROGRAM-4 TO PI-SAVED-PROGRAM-3
  8688             MOVE PI-SAVED-PROGRAM-5 TO PI-SAVED-PROGRAM-4
  8689             MOVE PI-SAVED-PROGRAM-6 TO PI-SAVED-PROGRAM-5
  8690             MOVE SPACES             TO PI-SAVED-PROGRAM-6
  8691             PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  8692             MOVE LOW-VALUES         TO EL689AO
  8693             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8694             SET W-RG-NDX            TO PI-CURRENT-LINE
  8695             PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  8696                 VARYING
  8697                     W-SC-NDX FROM 1 BY 1
  8698                 UNTIL
  8699                     W-SC-NDX GREATER THAN
  8700                     W-NUM-LINES-PER-SCREEN
  8701             MOVE PI-689-ALT-PRINTER-ID
  8702                                     TO PRINTERO
  8703             MOVE AL-UANON           TO PRINTERA
  8704             MOVE -1                 TO PRINTERL
  8705             GO TO 8100-SEND-INITIAL-MAP
  8706         END-IF
  8707     END-IF.
  8708
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 168
* EL689.cbl
  8710 0200-RECEIVE.
  8711
  8712     MOVE PI-689-FATAL-CTR       TO EMI-FATAL-CTR
  8713     MOVE PI-689-FORCABLE-CTR    TO EMI-FORCABLE-CTR
  8714     IF  EMI-FATAL-CTR GREATER THAN ZEROS
  8715             OR
  8716         EMI-FORCABLE-CTR GREATER THAN ZEROS
  8717         MOVE 'Y'                TO W-HOLD-IND.
  8718
  8719     MOVE W-TRANSACTION          TO EIBTRNID.
  8720     MOVE EMI-SAVE-AREA          TO ERROR-MESSAGE-INTERFACE-BLOCK.
  8721     MOVE ZEROS                  TO W-LAST-ERROR.
  8722     MOVE LOW-VALUES             TO EL689AI.
  8723     MOVE '104A'                 TO W-TS-ID-TEXT.
  8724     MOVE EIBTRMID               TO W-TS-TERM-TEXT
  8725                                    W-TS-TERM-SCREEN.
  8726
  8727
  8728* EXEC CICS HANDLE AID
  8729*        CLEAR    (9300-DFHCLEAR)
  8730*        PA1      (9200-PA)
  8731*        PA2      (9200-PA)
  8732*        PA3      (9200-PA)
  8733*    END-EXEC.
  8734*    MOVE '"&=!"#               V! " #00008630' TO DFHEIV0
  8735     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  8736     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  8737     MOVE X'2220233030303038363330' TO DFHEIV0(25:11)
  8738     CALL 'kxdfhei1' USING DFHEIV0
  8739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8740
  8741
  8742
  8743* EXEC CICS HANDLE CONDITION
  8744*        PGMIDERR (9700-PGMID-ERROR)
  8745*        ERROR    (9800-ABEND)
  8746*        MAPFAIL  (0325-MAPFAIL)
  8747*    END-EXEC.
  8748*    MOVE '"$L.?                 ! # #00008637' TO DFHEIV0
  8749     MOVE X'22244C2E3F20202020202020' TO DFHEIV0(1:12)
  8750     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8751     MOVE X'2320233030303038363337' TO DFHEIV0(25:11)
  8752     CALL 'kxdfhei1' USING DFHEIV0
  8753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8754
  8755
  8756
  8757* EXEC CICS SYNCPOINT
  8758*    END-EXEC.
  8759*    MOVE '6"                    !   #00008643' TO DFHEIV0
  8760     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  8761     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8762     MOVE X'2020233030303038363433' TO DFHEIV0(25:11)
  8763     CALL 'kxdfhei1' USING DFHEIV0
  8764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8765
  8766
  8767     IF PI-LOWER-CASE-LETTERS = 'Y'
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 169
* EL689.cbl
  8768*    IF  W-LC-USE-BOTH-CASES
  8769
  8770* EXEC CICS RECEIVE
  8771*            MAP      (W-MAP)
  8772*            MAPSET   (W-MAPSET)
  8773*            INTO     (EL689AI)
  8774*            ASIS
  8775*        END-EXEC
  8776     MOVE LENGTH OF
  8777      EL689AI
  8778       TO DFHEIV11
  8779*    MOVE '8"TAI  L              ''   #00008648' TO DFHEIV0
  8780     MOVE X'382254414920204C20202020' TO DFHEIV0(1:12)
  8781     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8782     MOVE X'2020233030303038363438' TO DFHEIV0(25:11)
  8783     CALL 'kxdfhei1' USING DFHEIV0,
  8784           W-MAP,
  8785           EL689AI,
  8786           DFHEIV11,
  8787           W-MAPSET,
  8788           DFHEIV99,
  8789           DFHEIV99
  8790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8791     ELSE
  8792
  8793* EXEC CICS RECEIVE
  8794*            MAP      (W-MAP)
  8795*            MAPSET   (W-MAPSET)
  8796*            INTO     (EL689AI)
  8797*        END-EXEC.
  8798     MOVE LENGTH OF
  8799      EL689AI
  8800       TO DFHEIV11
  8801*    MOVE '8"T I  L              ''   #00008655' TO DFHEIV0
  8802     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  8803     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8804     MOVE X'2020233030303038363535' TO DFHEIV0(25:11)
  8805     CALL 'kxdfhei1' USING DFHEIV0,
  8806           W-MAP,
  8807           EL689AI,
  8808           DFHEIV11,
  8809           W-MAPSET,
  8810           DFHEIV99,
  8811           DFHEIV99
  8812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8813
  8814
  8815     IF  NOT DISPLAY-CAP
  8816         MOVE 'READ'             TO SM-READ
  8817         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  8818         MOVE ER-9097            TO EMI-ERROR
  8819         MOVE -1                 TO MAINTL
  8820         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8821         GO TO 8100-SEND-INITIAL-MAP.
  8822
  8823     INSPECT MAINTI CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
  8824
  8825     IF  ENTERPFL EQUAL 0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 170
* EL689.cbl
  8826         GO TO 0300-CHECK-PFKEYS.
  8827
  8828     IF  EIBAID NOT EQUAL DFHENTER
  8829         MOVE ER-0004            TO EMI-ERROR
  8830         GO TO 0320-INPUT-ERROR.
  8831
  8832     IF  ENTERPFI NUMERIC
  8833             AND
  8834         ENTERPFI GREATER THAN 0
  8835             AND
  8836         ENTERPFI LESS THAN 25
  8837         MOVE PF-VALUES (ENTERPFI)
  8838                                 TO EIBAID
  8839     ELSE
  8840         MOVE ER-0029            TO EMI-ERROR
  8841         GO TO 0320-INPUT-ERROR.
  8842
  8843 0300-CHECK-PFKEYS.
  8844
  8845     IF  EIBAID EQUAL DFHPF23
  8846         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8847         MOVE ZEROS              TO PI-TOTAL-LINES
  8848                                    PI-CURRENT-LINE
  8849         MOVE EIBAID             TO PI-ENTRY-CD-1
  8850         MOVE W-XCTL-005         TO W-CALL-PGM
  8851         GO TO 9400-XCTL.
  8852
  8853     IF  EIBAID EQUAL DFHPF24
  8854         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
  8855         MOVE ZEROS              TO PI-TOTAL-LINES
  8856                                    PI-CURRENT-LINE
  8857         MOVE W-XCTL-626         TO W-CALL-PGM
  8858         GO TO 9400-XCTL.
  8859
  8860     MOVE SPACES                 TO W-KEY-FIELDS-CHANGED-IND
  8861                                    W-FORM-CHANGED-IND.
  8862
  8863     IF  PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  8864             OR
  8865         PI-SHOW-MODE
  8866         NEXT SENTENCE
  8867     ELSE
  8868         IF  PI-689-FORM-NUMBER GREATER THAN SPACES
  8869                 AND
  8870             FORML NOT EQUAL ZEROS
  8871                 AND
  8872             PI-689-FORM-NUMBER NOT EQUAL FORMI
  8873             MOVE FORMI          TO PI-689-FORM-NUMBER
  8874             MOVE LOW-VALUES     TO EL689AI
  8875                                    PI-1042-WA
  8876                                    PI-689-FOLLOW-UP-DATE
  8877                                    PI-689-PRINT-RESTRICTION
  8878                                    PI-689-RESEND-DATE-1
  8879                                    PI-689-RESEND1-EDIT
  8880                                    PI-689-FOLLOW-UP-DATE
  8881                                    PI-689-FOLLOW-UP-EDIT
  8882                                    PI-689-ERROR-IND
  8883             MOVE ZEROS          TO PI-689-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 171
* EL689.cbl
  8884                                    PI-689-NUMBER-COPIES
  8885                                    PI-689-NUMBER-LABEL-LINES
  8886                                    PI-689-NUMBER-TEXT-RECORDS
  8887                                    PI-CURRENT-LINE
  8888                                    PI-TEMP-STOR-ITEMS
  8889                                    PI-TOTAL-LINES
  8890                                    PI-UPDATE-SW
  8891             MOVE SPACES         TO PI-689-PRINT-SW
  8892                                    PI-689-ALT-PRINTER-ID
  8893                                    PI-COMM-CONTROL
  8894                                    PI-689-TEMP-STOR-ID
  8895                                    PI-689-USE-SCREEN-IND
  8896                                    PI-689-RESEND-LETR-1
  8897                                    PI-CERT-FORM-ID
  8898                                    PI-CERT-REQ-IND
  8899                                    PI-REASON-REQ-IND
  8900             PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
  8901             MOVE DFHENTER       TO EIBAID
  8902             MOVE 'Y'            TO W-FORM-CHANGED-IND
  8903             GO TO 0330-FUNCTION-CHECK
  8904         ELSE
  8905             IF  PI-689-DATA-SOURCE NOT EQUAL DATASORI
  8906                     OR
  8907                 (PI-689-LABEL-SOURCE NOT EQUAL ADDRSI
  8908                         AND
  8909                     (PI-689-LABEL-SOURCE NOT EQUAL SPACES
  8910                             OR
  8911                         ADDRSI NOT EQUAL LOW-VALUES))
  8912                     OR
  8913                 PI-689-CARRIER NOT EQUAL CARRIERI
  8914                     OR
  8915                 PI-689-GROUPING NOT EQUAL GROUPI
  8916                     OR
  8917                 PI-689-STATE NOT EQUAL STATEI
  8918                     OR
  8919                 PI-689-ACCOUNT NOT EQUAL ACCTI
  8920                     OR
  8921                 PI-689-CERT-PRIME NOT EQUAL CERTI
  8922                     OR
  8923                 PI-689-CERT-SFX NOT EQUAL SFXI
  8924                     OR
  8925                 PI-689-TYPE NOT EQUAL TYPEI
  8926                     OR
  8927                 PI-689-DATE-EDIT NOT EQUAL DATEI
  8928                     OR
  8929                 PI-689-RESP-PERSON NOT EQUAL RPERSONI
  8930                     OR
  8931                 PI-689-SEQ-EDIT NOT EQUAL SEQI
  8932                     OR
  8933                 PI-689-ENTRY-BATCH NOT EQUAL BENTRYI
  8934                     OR
  8935                 PI-689-BCSEQ-EDIT NOT EQUAL BCSEQI
  8936                 MOVE 'Y'        TO W-KEY-FIELDS-CHANGED-IND
  8937                 MOVE DFHENTER   TO EIBAID
  8938                 GO TO 0330-FUNCTION-CHECK.
  8939
  8940*    IF  EIBAID EQUAL DFHPF1
  8941*        MOVE +7                 TO W-ROLL-COUNTER
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 172
* EL689.cbl
  8942*        GO TO 4000-ROLL-PAGE.
  8943
  8944*    IF  EIBAID EQUAL DFHPF2
  8945*        MOVE -7                 TO W-ROLL-COUNTER
  8946*        GO TO 4000-ROLL-PAGE.
  8947
  8948*    IF  EIBAID EQUAL DFHPF3
  8949*        IF  W-HOLD-ON
  8950*            MOVE ER-7245        TO EMI-ERROR
  8951*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8952*            MOVE -1             TO MAINTL
  8953*            MOVE AL-UABON       TO MAINTA
  8954*            GO TO 8200-SEND-DATAONLY
  8955*        ELSE
  8956*            GO TO 0330-FUNCTION-CHECK.
  8957*    IF (EIBAID = DFHPF8)
  8958*       AND (PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR
  8959*         'CAGB' OR 'DLVA' OR 'ECCA' OR 'KRHA' OR 'ALWA')
  8960*       MOVE ER-0029             TO EMI-ERROR
  8961*       GO TO 0320-INPUT-ERROR
  8962*    END-IF
  8963*    IF EIBAID = DFHPF4 OR DFHPF8
  8964*        IF  W-HOLD-ON
  8965*            MOVE ER-7245        TO EMI-ERROR
  8966*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8967*            MOVE -1             TO MAINTL
  8968*            MOVE AL-UABON       TO MAINTA
  8969*            GO TO 8200-SEND-DATAONLY
  8970*        ELSE
  8971*            GO TO 0330-FUNCTION-CHECK.
  8972
  8973*    IF  EIBAID = DFHPF5
  8974*        COMPUTE W-ROLL-COUNTER = ((PI-TOTAL-LINES - 1) * -1)
  8975*        GO TO 4000-ROLL-PAGE.
  8976
  8977*    IF  EIBAID = DFHPF6
  8978*        MOVE PI-TOTAL-LINES     TO W-ROLL-COUNTER
  8979*        GO TO 4000-ROLL-PAGE.
  8980
  8981     IF  EIBAID EQUAL DFHPF7
  8982         IF PI-PROMPT-IND EQUAL 'Y'
  8983             MOVE ER-0894        TO EMI-ERROR
  8984             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8985             MOVE -1             TO MAINTL
  8986             MOVE AL-UABON       TO MAINTA
  8987             GO TO 8200-SEND-DATAONLY
  8988         END-IF
  8989     END-IF.
  8990
  8991     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  8992         IF  W-HOLD-ON
  8993             MOVE ER-7245        TO EMI-ERROR
  8994             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8995             MOVE -1             TO MAINTL
  8996             MOVE AL-UABON       TO MAINTA
  8997             GO TO 8200-SEND-DATAONLY
  8998         ELSE
  8999             GO TO 0330-FUNCTION-CHECK.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 173
* EL689.cbl
  9000
  9001     IF  EIBAID EQUAL DFHENTER
  9002         GO TO 0330-FUNCTION-CHECK.
  9003
  9004     MOVE ER-0029                TO EMI-ERROR.
  9005
  9006 0320-INPUT-ERROR.
  9007
  9008     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9009
  9010     IF  ENTERPFL EQUAL 0
  9011         MOVE -1                 TO MAINTL
  9012         MOVE AL-UABON           TO MAINTA
  9013     ELSE
  9014         MOVE AL-UNBON           TO ENTERPFA
  9015         MOVE -1                 TO ENTERPFL.
  9016
  9017     GO TO 8200-SEND-DATAONLY.
  9018
  9019 0325-MAPFAIL.
  9020***********************************************************
  9021*      ROUTINE SHOULD ONLY BE PERFORMED WHEN PRINTING     *
  9022*      LETTERS ON A 3275 PRINTER.                         *
  9023***********************************************************
  9024
  9025     PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
  9026
  9027     SET W-RG-NDX                TO PI-CURRENT-LINE.
  9028     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
  9029             VARYING
  9030         W-SC-NDX FROM 1 BY 1
  9031             UNTIL
  9032         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
  9033
  9034     MOVE -1                     TO MAINTL.
  9035     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 174
* EL689.cbl
  9037 0330-FUNCTION-CHECK.
  9038
  9039     IF  MAINTI EQUAL 'S'
  9040*        IF EIBAID = DFHPF4 OR DFHPF8
  9041*            GO TO 7900-PRINT-LETTER-NOW
  9042*        ELSE
  9043             GO TO 1000-SHOW.
  9044
  9045     IF  NOT MODIFY-CAP
  9046         MOVE 'UPDATE'           TO SM-READ
  9047         PERFORM 9995-SECURITY-VIOLATION
  9048         MOVE ER-0070            TO EMI-ERROR
  9049         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9050         MOVE -1                 TO MAINTL
  9051         GO TO 8100-SEND-INITIAL-MAP.
  9052
  9053     IF  W-FORM-CHANGED
  9054             OR
  9055         W-KEY-FIELDS-CHANGED
  9056         GO TO 0330-EDIT.
  9057
  9058     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  9059
  9060
  9061*    IF  EIBAID EQUAL DFHPF3
  9062*        IF  PI-NO-CARRIER-SECURITY
  9063*                AND
  9064*            PI-NO-ACCOUNT-SECURITY
  9065*            GO TO 5000-EDIT-MODE.
  9066
  9067     IF  EIBAID EQUAL DFHPF7 or dfhpf8
  9068         IF  PI-NO-CARRIER-SECURITY
  9069                 AND
  9070             PI-NO-ACCOUNT-SECURITY
  9071             GO TO 5400-LETTER-RELEASE
  9072         ELSE
  9073             IF  PI-689-PRINT-PERFORMED
  9074                 GO TO 5400-LETTER-RELEASE
  9075             ELSE
  9076                 MOVE AL-UNBON TO ENTERPFA
  9077                 MOVE -1       TO ENTERPFL
  9078                 MOVE ER-2398  TO EMI-ERROR
  9079                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9080                 GO TO 8200-SEND-DATAONLY.
  9081
  9082*    IF  EIBAID = DFHPF4 OR DFHPF8
  9083*        GO TO 7900-PRINT-LETTER-NOW.
  9084
  9085 0330-EDIT.
  9086
  9087     IF  W-SC-TEXTL (1) NOT EQUAL ZEROS
  9088             OR
  9089         W-SC-TEXTL (2) NOT EQUAL ZEROS
  9090             OR
  9091         W-SC-TEXTL (3) NOT EQUAL ZEROS
  9092             OR
  9093         W-SC-TEXTL (4) NOT EQUAL ZEROS
  9094             OR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 175
* EL689.cbl
  9095         W-SC-TEXTL (5) NOT EQUAL ZEROS
  9096             OR
  9097         W-SC-TEXTL (6) NOT EQUAL ZEROS
  9098             OR
  9099         W-SC-TEXTL (7) NOT EQUAL ZEROS
  9100             OR
  9101         W-SC-TEXTL (8) NOT EQUAL ZEROS
  9102             OR
  9103         W-SC-TEXTL (9) NOT EQUAL ZEROS
  9104             OR
  9105         W-SC-TEXTL (10) NOT EQUAL ZEROS
  9106             OR
  9107         W-SC-TEXTL (11) NOT EQUAL ZEROS
  9108         IF  W-KEY-FIELDS-CHANGED
  9109                 OR
  9110             W-FORM-CHANGED
  9111             MOVE ER-7250        TO EMI-ERROR
  9112             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9113             MOVE -1             TO MAINTL
  9114             MOVE AL-UABON       TO MAINTA
  9115         ELSE
  9116             PERFORM 4100-SET-NDX THRU 4100-EXIT
  9117             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
  9118                     VARYING
  9119                 W-SC-NDX FROM 1 BY 1
  9120                     UNTIL
  9121                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
  9122             MOVE ER-7398        TO EMI-ERROR
  9123             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9124             MOVE -1             TO MAINTL
  9125             MOVE AL-UABON       TO MAINTA
  9126             GO TO 8200-SEND-DATAONLY.
  9127
  9128     PERFORM 0350-EDIT-ROUTINE THRU 0350-EXIT.
  9129
  9130     IF  W-KEY-FIELDS-CHANGED
  9131             OR
  9132         PI-689-KEY-DATA-FIELDS EQUAL LOW-VALUES OR SPACES
  9133         PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  9134         IF  MAINTI EQUAL 'C'
  9135             GO TO 2000-CREATE
  9136         ELSE
  9137             NEXT SENTENCE
  9138     ELSE
  9139         IF  W-FORM-CHANGED
  9140             PERFORM 0800-EDIT-KEY-FIELDS THRU 0800-EXIT
  9141             IF  MAINTI EQUAL 'C'
  9142                 GO TO 2000-CREATE
  9143             ELSE
  9144                 NEXT SENTENCE
  9145         ELSE
  9146             MOVE -1             TO MAINTL
  9147             GO TO 8200-SEND-DATAONLY.
  9148
  9149     MOVE ER-0023                TO EMI-ERROR.
  9150     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9151     MOVE -1                     TO MAINTL.
  9152     MOVE AL-UABON               TO MAINTA.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 176
* EL689.cbl
  9153     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 177
* EL689.cbl
  9155 0350-EDIT-ROUTINE.
  9156
  9157     IF  MAINTI EQUAL 'C'
  9158             AND
  9159         FORML EQUAL ZEROS
  9160         MOVE -1                 TO FORML
  9161         MOVE ER-0177            TO EMI-ERROR
  9162         MOVE AL-UABON           TO FORMA
  9163         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9164
  9165     IF PRTNOWL > ZEROS
  9166        IF PRTNOWI = 'Y' OR 'N' OR 'P' OR ' '
  9167           MOVE PRTNOWI          TO PI-PRINT-NOW
  9168           MOVE AL-UANON         TO PRTNOWA
  9169        END-IF
  9170     END-IF
  9171     IF ENDARCHL > ZEROS
  9172        IF ENDARCHI NUMERIC
  9173            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
  9174            MOVE AL-UNNON       TO ENDARCHA
  9175            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
  9176            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
  9177            MOVE 'N'            TO W-VALID-ENDT-SW
  9178            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
  9179            IF NOT W-VALID-ENDT
  9180                MOVE -1         TO ENDARCHL
  9181                MOVE ER-1565    TO EMI-ERROR
  9182                MOVE AL-UNBON   TO ENDARCHA
  9183                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9184            END-IF
  9185        END-IF
  9186     ELSE
  9187        MOVE ZEROS              TO PI-ENDT-ARCH-NO
  9188     END-IF
  9189     MOVE SPACES                 TO PI-689-PRINT-RESTRICTION
  9190*    IF  PRTRESTL NOT EQUAL ZEROS
  9191*        PERFORM 0360-EDIT-PRINT-RESTRICTIONS THRU 0360-EXIT.
  9192
  9193     IF  FOLLOWL NOT EQUAL ZEROS
  9194         MOVE FOLLOWI            TO W-DEEDIT-FIELD
  9195         PERFORM 8600-DEEDIT
  9196         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9197         MOVE '4'                TO DC-OPTION-CODE
  9198         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9199         IF  DATE-CONVERSION-ERROR
  9200             MOVE ER-0182        TO EMI-ERROR
  9201             MOVE -1             TO FOLLOWL
  9202             MOVE AL-UABON       TO FOLLOWA
  9203             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9204         ELSE
  9205             MOVE DC-GREG-DATE-1-EDIT
  9206                                 TO FOLLOWO
  9207                                    PI-689-FOLLOW-UP-EDIT
  9208             MOVE AL-UANON       TO FOLLOWA
  9209             MOVE DC-BIN-DATE-1  TO PI-689-FOLLOW-UP-DATE
  9210     ELSE
  9211         MOVE LOW-VALUES         TO PI-689-FOLLOW-UP-DATE.
  9212
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 178
* EL689.cbl
  9213     IF  PI-689-FOLLOW-UP-DATE NOT EQUAL LOW-VALUES
  9214         IF  PI-689-FOLLOW-UP-DATE LESS THAN
  9215                 W-SAVE-BIN-DATE
  9216             MOVE ER-0533        TO EMI-ERROR
  9217             MOVE AL-UABON       TO FOLLOWA
  9218             MOVE -1             TO FOLLOWL
  9219             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9220
  9221     IF  RESEND1L NOT EQUAL ZEROS
  9222         MOVE RESEND1I           TO W-DEEDIT-FIELD
  9223         PERFORM 8600-DEEDIT
  9224         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
  9225         MOVE '4'                TO DC-OPTION-CODE
  9226         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9227         IF  DATE-CONVERSION-ERROR
  9228             MOVE ER-0185        TO EMI-ERROR
  9229             MOVE -1             TO RESEND1L
  9230             MOVE AL-UABON       TO RESEND1A
  9231             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9232         ELSE
  9233             MOVE DC-GREG-DATE-1-EDIT
  9234                                 TO RESEND1O
  9235                                    PI-689-RESEND1-EDIT
  9236             MOVE AL-UANON       TO RESEND1A
  9237             MOVE DC-BIN-DATE-1  TO PI-689-RESEND-DATE-1
  9238     ELSE
  9239         MOVE LOW-VALUES         TO PI-689-RESEND-DATE-1.
  9240
  9241     IF  PI-689-RESEND-DATE-1 NOT EQUAL LOW-VALUES
  9242         IF  PI-689-RESEND-DATE-1 NOT GREATER THAN
  9243                 W-SAVE-BIN-DATE
  9244             MOVE ER-0537        TO EMI-ERROR
  9245             MOVE AL-UABON       TO RESEND1A
  9246             MOVE -1             TO RESEND1L
  9247             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9248
  9249     IF ENCL > ZEROS
  9250        MOVE FUNCTION UPPER-CASE(ENCI) TO ENCI
  9251                                          PI-ENCLOSURE-CD
  9252        MOVE SPACES             TO W-ELENCC-KEY
  9253        MOVE PI-COMPANY-CD      TO W-ENCC-COMPANY-CD
  9254        MOVE '2'                TO W-ENCC-REC-TYPE
  9255        MOVE ENCI               TO W-ENCC-ENC-CODE
  9256
  9257
  9258* EXEC CICS READ
  9259*           DATASET    (W-ENCC-FILE-ID)
  9260*           SET        (ADDRESS OF ENCLOSURE-CODES)
  9261*           RIDFLD     (W-ELENCC-KEY)
  9262*           RESP       (W-RESPONSE)
  9263*       END-EXEC
  9264*    MOVE '&"S        E          (  N#00009103' TO DFHEIV0
  9265     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9266     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9267     MOVE X'204E233030303039313033' TO DFHEIV0(25:11)
  9268     CALL 'kxdfhei1' USING DFHEIV0,
  9269           W-ENCC-FILE-ID,
  9270           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 179
* EL689.cbl
  9271           DFHEIV99,
  9272           W-ELENCC-KEY,
  9273           DFHEIV99,
  9274           DFHEIV99,
  9275           DFHEIV99
  9276     SET ADDRESS OF ENCLOSURE-CODES TO
  9277         DFHEIV20
  9278     MOVE EIBRESP  TO W-RESPONSE
  9279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9280
  9281        IF RESP-NORMAL
  9282           MOVE ENCI             TO PI-ENCLOSURE-CD
  9283                                    W-ENCLOSURE-CD
  9284           MOVE AL-UANON         TO ENCA
  9285        ELSE
  9286           MOVE ER-1560          TO EMI-ERROR
  9287           MOVE -1               TO ENCL
  9288           MOVE AL-UABON         TO ENCA
  9289           PERFORM 9900-ERROR-FORMAT
  9290                                 THRU 9900-EXIT
  9291        END-IF
  9292     END-IF
  9293
  9294
  9295     IF NOT PI-CREATE-LABELS
  9296         MOVE PI-LABEL-CONTROL   TO ADDRLBLI
  9297         MOVE AL-PANON           TO ADDRLBLA
  9298         GO TO 0350-BYPASS-OVERRIDE.
  9299
  9300     IF  ADDRLBLL GREATER THAN ZEROS
  9301          INSPECT ADDRLBLI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9302          IF ADDRLBLI = 'N' OR 'Y'
  9303              MOVE ADDRLBLI      TO PI-689-LBL-OVERRIDE
  9304              MOVE AL-UANON      TO ADDRLBLA
  9305          ELSE
  9306             MOVE ER-3783        TO EMI-ERROR
  9307             MOVE -1             TO ADDRLBLL
  9308             MOVE AL-UABON       TO ADDRLBLA
  9309             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9310
  9311 0350-BYPASS-OVERRIDE.
  9312
  9313     IF  PI-BYPASS-LABELS
  9314             OR
  9315         FORMI EQUAL '9999'
  9316             OR
  9317         PI-689-LABELS-OVERRIDEN
  9318         MOVE SPACES             TO PI-689-LABEL-SOURCE
  9319         MOVE LOW-VALUES         TO ADDRSI
  9320         MOVE AL-UANOF           TO ADDRSA
  9321         MOVE ZEROS              TO ADDRSL
  9322     ELSE
  9323         IF  ADDRSL GREATER THAN ZEROS
  9324             MOVE ADDRSI         TO W-LABEL-SOURCE
  9325             IF  W-LABEL-SOURCE-VALID
  9326                 MOVE ADDRSI     TO PI-689-LABEL-SOURCE
  9327             ELSE
  9328                 MOVE -1         TO ADDRSL
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 180
* EL689.cbl
  9329                 MOVE ER-0176    TO EMI-ERROR
  9330                 MOVE AL-UABON   TO ADDRSA
  9331                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9332         ELSE
  9333             IF  MAINTI EQUAL 'C'
  9334                 MOVE -1         TO ADDRSL
  9335                 MOVE ER-0176    TO EMI-ERROR
  9336                 MOVE AL-UABON   TO ADDRSA
  9337                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9338
  9339     MOVE SPACES                 TO PI-ALT-DMD-PRT-ID.
  9340     IF  PRINTERL GREATER ZERO
  9341         INSPECT PRINTERI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9342         MOVE AL-UANON           TO PRINTERA
  9343         MOVE PRINTERI           TO PI-689-ALT-PRINTER-ID
  9344                                    PI-ALT-DMD-PRT-ID
  9345     ELSE
  9346         IF  PI-NO-CARRIER-SECURITY
  9347                 AND
  9348             PI-NO-ACCOUNT-SECURITY
  9349             IF  PI-PROCESSOR-PRINTER GREATER THAN SPACES
  9350                 MOVE PI-PROCESSOR-PRINTER
  9351                                 TO PI-689-ALT-PRINTER-ID
  9352                                    PRINTERI
  9353                 MOVE AL-UABON   TO PRINTERA
  9354             ELSE
  9355                 MOVE PI-COMPANY-ID
  9356                                 TO W-CNTL-COMPANY-ID
  9357                 MOVE '1'        TO W-CNTL-RECORD-TYPE
  9358                 MOVE SPACES     TO W-CNTL-GENL
  9359                 MOVE ZEROS      TO W-CNTL-SEQ-NO
  9360
  9361* EXEC CICS HANDLE CONDITION
  9362*                     NOTOPEN    (8040-CNTL-NOT-OPEN)
  9363*                     NOTFND     (7945-NOT-FOUND)
  9364*                END-EXEC
  9365*    MOVE '"$JI                  ! $ #00009189' TO DFHEIV0
  9366     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  9367     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9368     MOVE X'2420233030303039313839' TO DFHEIV0(25:11)
  9369     CALL 'kxdfhei1' USING DFHEIV0
  9370     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9371
  9372* EXEC CICS READ
  9373*                     DATASET    (W-CNTL-FILE-ID)
  9374*                     SET        (ADDRESS OF CONTROL-FILE)
  9375*                     RIDFLD     (W-CNTL-KEY)
  9376*                END-EXEC
  9377*    MOVE '&"S        E          (   #00009193' TO DFHEIV0
  9378     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9379     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9380     MOVE X'2020233030303039313933' TO DFHEIV0(25:11)
  9381     CALL 'kxdfhei1' USING DFHEIV0,
  9382           W-CNTL-FILE-ID,
  9383           DFHEIV20,
  9384           DFHEIV99,
  9385           W-CNTL-KEY,
  9386           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 181
* EL689.cbl
  9387           DFHEIV99,
  9388           DFHEIV99
  9389     SET ADDRESS OF CONTROL-FILE TO
  9390         DFHEIV20
  9391     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9392                 MOVE CF-FORMS-PRINTER-ID
  9393                                 TO PI-689-ALT-PRINTER-ID
  9394                                    PRINTERI
  9395                                    W-TS-TERM-TEXT
  9396                 MOVE AL-UABON   TO PRINTERA
  9397         ELSE
  9398             MOVE AL-UABON       TO PRINTERA
  9399             MOVE -1             TO PRINTERL
  9400             MOVE ER-9283        TO EMI-ERROR
  9401             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9402
  9403     IF  COPIESL NOT EQUAL ZEROS
  9404         IF  COPIESI NOT NUMERIC
  9405                 OR
  9406             COPIESI EQUAL '0'
  9407             MOVE ER-0184        TO EMI-ERROR
  9408             MOVE -1             TO COPIESL
  9409             MOVE AL-UABON       TO COPIESA
  9410             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9411         ELSE
  9412             MOVE COPIESI        TO PI-689-NUMBER-COPIES
  9413             MOVE AL-UANON       TO COPIESA
  9414     ELSE
  9415         IF FORMI EQUAL '9999'
  9416             MOVE 1              TO PI-689-NUMBER-COPIES
  9417                                    COPIESL
  9418                                    COPIESO.
  9419
  9420     IF  FORML NOT EQUAL ZEROS
  9421         INSPECT FORMI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
  9422         MOVE FORMI              TO PI-689-FORM-NUMBER.
  9423
  9424     MOVE SPACES                 TO W-HOLD-IND.
  9425
  9426     IF PI-CERT-REQ-IND = 'Y'
  9427       IF  CERTIDL NOT EQUAL ZEROS
  9428         IF CERTIDI NUMERIC
  9429             MOVE AL-UANON      TO CERTIDA
  9430             MOVE CERTIDI       TO PI-CERT-FORM-ID
  9431         ELSE
  9432             MOVE ER-1778       TO EMI-ERROR
  9433             MOVE -1            TO CERTIDL
  9434             MOVE AL-UABON      TO CERTIDA
  9435             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9436         END-IF
  9437       ELSE
  9438          MOVE ER-0715       TO EMI-ERROR
  9439          MOVE -1            TO CERTIDL
  9440          MOVE AL-UABON      TO CERTIDA
  9441          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9442       END-IF
  9443     END-IF.
  9444
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 182
* EL689.cbl
  9445     IF PI-REASON-REQ-IND = 'Y'
  9446        IF PI-ENDT-ARCH-NO NOT > ZERO
  9447          MOVE ER-9840       TO EMI-ERROR
  9448          MOVE -1            TO FORML
  9449          MOVE AL-UABON      TO FORMA
  9450          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9451        END-IF
  9452     END-IF.
  9453
  9454     IF  NOT EMI-NO-ERRORS
  9455         IF  EMI-ERROR EQUAL ER-7250
  9456             GO TO 0350-EXIT
  9457         ELSE
  9458            MOVE -1             TO MAINTL
  9459            GO TO 8200-SEND-DATAONLY.
  9460
  9461 0350-EXIT.
  9462      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 183
* EL689.cbl
  9464 0355-CHECK-ERENDT.
  9465
  9466*     EXEC CICS GETMAIN
  9467*          SET      (ADDRESS OF ENDORSEMENT-RECORD)
  9468*          LENGTH   (W-ENDT-LENGTH)
  9469*     END-EXEC
  9470
  9471
  9472* EXEC CICS READ
  9473*         DATASET    ('ERENDT2')
  9474*         SET        (ADDRESS OF ENDORSEMENT-RECORD)
  9475*         RIDFLD     (W-ERENDT-KEY-BY-ARCH)
  9476*         RESP       (W-RESPONSE)
  9477*    END-EXEC
  9478     MOVE 'ERENDT2' TO DFHEIV1
  9479*    MOVE '&"S        E          (  N#00009277' TO DFHEIV0
  9480     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9481     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9482     MOVE X'204E233030303039323737' TO DFHEIV0(25:11)
  9483     CALL 'kxdfhei1' USING DFHEIV0,
  9484           DFHEIV1,
  9485           DFHEIV20,
  9486           DFHEIV99,
  9487           W-ERENDT-KEY-BY-ARCH,
  9488           DFHEIV99,
  9489           DFHEIV99,
  9490           DFHEIV99
  9491     SET ADDRESS OF ENDORSEMENT-RECORD TO
  9492         DFHEIV20
  9493     MOVE EIBRESP  TO W-RESPONSE
  9494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9495
  9496     IF (RESP-NORMAL)
  9497         IF PI-RETURN-TO-PROGRAM EQUAL 'EL6311'  AND
  9498            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9499            EN-CARRIER     =  PI-689-CARRIER     AND
  9500            EN-GROUPING    =  PI-689-GROUPING    AND
  9501            EN-STATE       =  PI-689-STATE       AND
  9502            EN-ACCOUNT     =  PI-689-ACCOUNT     AND
  9503            EN-CERT-EFF-DT =  PI-689-EFF-DATE    AND
  9504            EN-CERT-NO     =  PI-689-CERT-NO
  9505               SET W-VALID-ENDT TO TRUE
  9506         END-IF
  9507         IF PI-RETURN-TO-PROGRAM EQUAL 'EL1273'  AND
  9508            EN-COMPANY-CD  =  PI-COMPANY-CD      AND
  9509            EN-CARRIER     =  PI-CARRIER         AND
  9510            EN-GROUPING    =  PI-GROUPING        AND
  9511            EN-STATE       =  PI-STATE           AND
  9512            EN-ACCOUNT     =  PI-ACCOUNT         AND
  9513            EN-CERT-EFF-DT =  PI-CERT-EFF-DT     AND
  9514            EN-CERT-NO     =  PI-CERT-NO
  9515               SET W-VALID-ENDT TO TRUE
  9516         END-IF
  9517     END-IF
  9518      .
  9519
  9520 0355-EXIT.
  9521      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 184
* EL689.cbl
  9523 0360-EDIT-PRINT-RESTRICTIONS.
  9524
  9525*    INSPECT PRTRESTI CONVERTING W-LOWER-CASE
  9526*                                TO W-UPPER-CASE.
  9527*
  9528*    IF  (PI-689-PRINT-RESTRICTION EQUAL ' ' OR 'F'
  9529*                                     OR 'P' OR LOW-VALUES)
  9530*            AND
  9531*        PRTRESTI EQUAL 'C'
  9532*            AND
  9533*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9534*        MOVE ER-7243            TO EMI-ERROR
  9535*        MOVE -1                 TO PRTRESTL
  9536*        MOVE AL-UABON           TO PRTRESTA
  9537*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9538*        GO TO 0360-EXIT.
  9539*
  9540*    IF  PRTRESTL NOT EQUAL ZEROS
  9541*        IF PRTRESTI = 'C' OR 'F' OR 'P'
  9542*            MOVE PRTRESTI       TO PI-689-PRINT-RESTRICTION
  9543*            MOVE AL-UANON       TO PRTRESTA
  9544*        ELSE
  9545*            IF  PRTRESTI EQUAL ' '
  9546*                MOVE SPACES     TO PI-689-PRINT-RESTRICTION
  9547*                MOVE AL-UANON   TO PRTRESTA
  9548*            ELSE
  9549*                MOVE ER-7393    TO EMI-ERROR
  9550*                MOVE -1         TO PRTRESTL
  9551*                MOVE AL-UABON   TO PRTRESTA
  9552*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9553*
  9554*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
  9555*            AND
  9556*        W-HOLD-ON
  9557*            AND
  9558*        PI-689-CONTROL NOT GREATER THAN ZEROS
  9559*        MOVE ER-7243            TO EMI-ERROR
  9560*        MOVE -1                 TO PRTRESTL
  9561*        MOVE AL-UABON           TO PRTRESTA
  9562*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  9563     .
  9564 0360-EXIT.
  9565      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 185
* EL689.cbl
  9567 0400-EL6311-INCOMING.
  9568
  9569     MOVE ZEROS                  TO PI-CURRENT-LINE
  9570                                    PI-TEMP-STOR-ITEMS
  9571                                    PI-TOTAL-LINES
  9572                                    PI-UPDATE-SW
  9573                                    PI-689-NUMBER-LABEL-LINES
  9574                                    PI-689-ERROR
  9575                                    PI-689-NUMBER-TEXT-RECORDS.
  9576     MOVE SPACES                 TO PI-689-PRINT-SW
  9577                                    PI-689-ALT-PRINTER-ID
  9578                                    PI-COMM-CONTROL
  9579                                    PI-689-FORM-NUMBER
  9580                                    PI-689-TEMP-STOR-ID
  9581                                    PI-689-LABEL-SOURCE
  9582                                    PI-689-USE-SCREEN-IND.
  9583
  9584     IF PI-CREATE-LABELS
  9585         MOVE  AL-UANON          TO ADDRLBLA
  9586         MOVE  +1                TO ADDRLBLL.
  9587
  9588     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9589                                    PI-689-LBL-OVERRIDE.
  9590
  9591     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
  9592     MOVE '2'                    TO PI-ACTION.
  9593     MOVE -1                     TO MAINTL.
  9594
  9595     MOVE AL-UANON               TO PRTNOWA.
  9596     MOVE +1                     TO PRTNOWL.
  9597     MOVE 'N'                    TO PRTNOWI
  9598                                    PI-PRINT-NOW.
  9599
  9600     IF  PI-689-CARRIER NOT EQUAL LOW-VALUES
  9601         MOVE AL-UANON           TO CARRIERA
  9602         MOVE +1                 TO CARRIERL
  9603         MOVE PI-689-CARRIER     TO CARRIERI.
  9604
  9605     IF  PI-689-GROUPING NOT EQUAL LOW-VALUES
  9606         MOVE +6                 TO GROUPL
  9607         MOVE AL-UANON           TO GROUPA
  9608         MOVE PI-689-GROUPING    TO GROUPI.
  9609
  9610     IF  PI-689-STATE NOT EQUAL LOW-VALUES
  9611         MOVE +2                 TO STATEL
  9612         MOVE AL-UANON           TO STATEA
  9613         MOVE PI-689-STATE       TO STATEI.
  9614
  9615     IF  PI-689-ACCOUNT NOT EQUAL LOW-VALUES
  9616         MOVE +10                TO ACCTL
  9617         MOVE AL-UANON           TO ACCTA
  9618         MOVE PI-689-ACCOUNT     TO ACCTI.
  9619
  9620     IF  PI-689-CERT-PRIME NOT EQUAL LOW-VALUES
  9621         MOVE +10                TO CERTL
  9622         MOVE AL-UANON           TO CERTA
  9623         MOVE PI-689-CERT-PRIME  TO CERTI.
  9624
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 186
* EL689.cbl
  9625     IF  PI-689-CERT-SFX NOT EQUAL LOW-VALUES
  9626         MOVE +1                 TO SFXL
  9627         MOVE AL-UANON           TO SFXA
  9628         MOVE PI-689-CERT-SFX    TO SFXI.
  9629
  9630     IF  PI-689-ENTRY-BATCH NOT EQUAL LOW-VALUES
  9631         MOVE +6                 TO BENTRYL
  9632         MOVE AL-UANON           TO BENTRYA
  9633         MOVE PI-689-ENTRY-BATCH TO BENTRYI.
  9634
  9635     MOVE +4                     TO BCSEQL.
  9636     MOVE AL-UANON               TO BCSEQA.
  9637     MOVE PI-689-CHG-SEQ-NO      TO BCSEQI.
  9638
  9639     IF  PI-689-SEQ-NO NOT EQUAL ZEROS
  9640         MOVE +8                 TO SEQL
  9641         MOVE AL-UANON           TO SEQA
  9642         MOVE PI-689-SEQ-NO      TO SEQI.
  9643
  9644     IF  PI-689-EFF-DATE NOT EQUAL LOW-VALUES
  9645         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  9646         MOVE ' '                TO DC-OPTION-CODE
  9647         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9648         MOVE +8                 TO DATEL
  9649         MOVE DC-GREG-DATE-1-EDIT
  9650                                 TO DATEI
  9651         MOVE AL-UANON           TO DATEA.
  9652
  9653     MOVE -1                     TO MAINTL.
  9654     MOVE '4'                    TO DATASORI
  9655                                    PI-689-DATA-SOURCE.
  9656     MOVE +1                     TO DATASORL.
  9657     MOVE AL-UANON               TO DATASORA.
  9658
  9659     GO TO 8100-SEND-INITIAL-MAP.
  9660
  9661 0400-EXIT.
  9662      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 187
* EL689.cbl
  9664 0450-SPECIAL-INPUT-PROCESS.
  9665
  9666     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  9667             AND
  9668         PI-CARRIER GREATER THAN LOW-VALUES
  9669         MOVE '1'                TO DATASORI
  9670                                    PI-689-DATA-SOURCE
  9671         MOVE PI-CARRIER         TO CARRIERI
  9672         MOVE PI-GROUPING        TO GROUPI
  9673         MOVE PI-STATE           TO STATEI
  9674         MOVE PI-ACCOUNT         TO ACCTI
  9675         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  9676         MOVE ' '                TO DC-OPTION-CODE
  9677         PERFORM 9500-LINK-DATE-CONVERT
  9678             THRU 9500-EXIT
  9679         MOVE DC-GREG-DATE-1-EDIT
  9680                                 TO DATEI
  9681         MOVE 'N'                TO PRTNOWI
  9682                                    PI-PRINT-NOW
  9683         MOVE AL-UANON           TO ACCTA
  9684                                    CARRIERA
  9685                                    DATEA
  9686                                    DATASORA
  9687                                    GROUPA
  9688                                    STATEA
  9689                                    PRTNOWA
  9690         MOVE +1                 TO CARRIERL
  9691                                    DATASORL
  9692                                    PRTNOWL
  9693         MOVE -1                 TO MAINTL
  9694         MOVE +6                 TO GROUPL
  9695         MOVE +2                 TO STATEL
  9696         MOVE +8                 TO DATEL
  9697         MOVE +10                TO ACCTL
  9698     ELSE
  9699         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  9700                 AND
  9701             PI-CARRIER GREATER THAN LOW-VALUES
  9702             MOVE '3'            TO DATASORI
  9703                                    PI-689-DATA-SOURCE
  9704             MOVE PI-CR-CARRIER  TO CARRIERI
  9705             MOVE PI-CR-GROUPING TO GROUPI
  9706             MOVE PI-CR-ACCOUNT  TO ACCTI
  9707             MOVE PI-CR-FIN-RESP TO RPERSONI
  9708             MOVE PI-CR-TYPE     TO TYPEI
  9709             MOVE 'N'            TO PRTNOWI
  9710                                    PI-PRINT-NOW
  9711             MOVE AL-UANON       TO CARRIERA
  9712                                    GROUPA
  9713                                    ACCTA
  9714                                    DATASORA
  9715                                    RPERSONA
  9716                                    TYPEA
  9717                                    PRTNOWA
  9718             MOVE +1             TO CARRIERL
  9719                                    DATASORL
  9720                                    TYPEL
  9721                                    PRTNOWL
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 188
* EL689.cbl
  9722             MOVE -1             TO MAINTL
  9723             MOVE +6             TO GROUPL
  9724             MOVE +10            TO ACCTL
  9725                                    RPERSONL
  9726         ELSE
  9727             IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  9728                     AND
  9729                 PI-CARRIER GREATER THAN LOW-VALUES
  9730                 MOVE '2'        TO DATASORI
  9731                                    PI-689-DATA-SOURCE
  9732                 MOVE PI-CARRIER TO CARRIERI
  9733                 MOVE PI-GROUPING
  9734                                 TO GROUPI
  9735                 MOVE PI-STATE   TO STATEI
  9736                 MOVE PI-ACCOUNT TO ACCTI
  9737                 MOVE PI-CERT-PRIME
  9738                                 TO CERTI
  9739                 MOVE PI-CERT-SFX
  9740                                 TO SFXI
  9741                 MOVE PI-CERT-EFF-DT
  9742                                 TO DC-BIN-DATE-1
  9743                 MOVE ' '        TO DC-OPTION-CODE
  9744                 PERFORM 9500-LINK-DATE-CONVERT
  9745                     THRU 9500-EXIT
  9746                 MOVE DC-GREG-DATE-1-EDIT
  9747                                 TO DATEI
  9748                 MOVE 'N'        TO PRTNOWI
  9749                                    PI-PRINT-NOW
  9750                 MOVE AL-UANON   TO CARRIERA
  9751                                    GROUPA
  9752                                    STATEA
  9753                                    ACCTA
  9754                                    CERTA
  9755                                    SFXA
  9756                                    DATEA
  9757                                    ADDRSA
  9758                                    DATASORA
  9759                                    PRTNOWA
  9760                 MOVE +1         TO CARRIERL
  9761                                    SFXL
  9762                                    DATASORL
  9763                                    ADDRSL
  9764                                    PRTNOWL
  9765                 MOVE -1         TO MAINTL
  9766                 MOVE +6         TO GROUPL
  9767                 MOVE +2         TO STATEL
  9768                 MOVE +8         TO DATEL
  9769                 MOVE +10        TO ACCTL
  9770                                    CERTL.
  9771
  9772     IF PI-CREATE-LABELS
  9773         MOVE  AL-UANON          TO ADDRLBLA
  9774         MOVE  +1                TO ADDRLBLL.
  9775
  9776     MOVE PI-LABEL-CONTROL       TO ADDRLBLI
  9777                                    PI-689-LBL-OVERRIDE.
  9778
  9779     MOVE LOW-VALUES             TO PI-689-KEY-DATA-FIELDS.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 189
* EL689.cbl
  9780     GO TO 8100-SEND-INITIAL-MAP.
  9781
  9782 0450-EXIT.
  9783      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 190
* EL689.cbl
  9785 0600-BYPASS-SCREEN-CNTL.
  9786***************************************************************
  9787*     THIS ROUTINE WILL PROCESS A NEW LETTER REQUIREMENT      *
  9788*     WITH THE INFORMATION FOUND IN THE PI AREA WITHOUT       *
  9789*     PERFORMING ANY SCREEN IO.                               *
  9790***************************************************************
  9791
  9792
  9793* EXEC CICS HANDLE CONDITION
  9794*        PGMIDERR (9700-PGMID-ERROR)
  9795*        MAPFAIL  (0325-MAPFAIL)
  9796*        ERROR    (9800-ABEND)
  9797*    END-EXEC.
  9798*    MOVE '"$L?.                 ! % #00009580' TO DFHEIV0
  9799     MOVE X'22244C3F2E20202020202020' TO DFHEIV0(1:12)
  9800     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9801     MOVE X'2520233030303039353830' TO DFHEIV0(25:11)
  9802     CALL 'kxdfhei1' USING DFHEIV0
  9803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9804
  9805
  9806     MOVE LOW-VALUES             TO EL689AI.
  9807
  9808     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM
  9809
  9810     MOVE PI-689-FORM-NUMBER     TO FORMI.
  9811     MOVE +4                     TO FORML.
  9812
  9813     IF  PI-689-NUMBER-COPIES GREATER THAN ZERO
  9814         MOVE PI-689-NUMBER-COPIES
  9815                                 TO COPIESI
  9816         MOVE +1                 TO COPIESL.
  9817
  9818     MOVE PI-689-LABEL-SOURCE    TO ADDRSI.
  9819     MOVE +1                     TO ADDRSL.
  9820     MOVE PI-689-DATA-SOURCE     TO DATASORI.
  9821     MOVE +1                     TO DATASORL.
  9822
  9823*    IF  PI-689-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
  9824*        MOVE PI-689-PRINT-RESTRICTION
  9825*                                TO PRTRESTI
  9826*        MOVE +1                 TO PRTRESTL.
  9827
  9828     MOVE SPACES                 TO PI-689-PRINT-SW
  9829                                    PI-689-LBL-OVERRIDE.
  9830     MOVE ZEROS                  TO PI-TOTAL-LINES
  9831                                    PI-CURRENT-LINE
  9832                                    PI-TEMP-STOR-ITEMS
  9833                                    PI-UPDATE-SW
  9834                                    PI-689-ERROR
  9835                                    PI-689-NUMBER-LABEL-LINES
  9836                                    PI-689-NUMBER-TEXT-RECORDS.
  9837
  9838     IF  PI-689-ALT-PRINTER-ID NOT EQUAL LOW-VALUES
  9839         MOVE +4                 TO PRINTERL
  9840         MOVE PI-689-ALT-PRINTER-ID
  9841                                 TO PRINTERI PI-ALT-DMD-PRT-ID.
  9842
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 191
* EL689.cbl
  9843     MOVE SPACES                 TO PI-689-ALT-PRINTER-ID.
  9844
  9845     IF  PI-689-SOURCE-VARIABLE
  9846         PERFORM 0700-GET-VARIABLE-LABEL THRU 0700-EXIT.
  9847
  9848     MOVE SPACES                 TO W-CNTL-KEY
  9849     MOVE LOW-VALUES             TO W-ACCT-KEY
  9850                                    W-CERT-KEY
  9851                                    W-CHEK-KEY
  9852                                    W-COMP-KEY
  9853                                    W-MAIL-KEY
  9854                                    W-PNDB-KEY
  9855                                    W-PNDB2-KEY
  9856                                    W-PYAJ-KEY.
  9857
  9858     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  9859     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
  9860                                    W-CERT-COMPANY-CD
  9861                                    W-CHEK-COMPANY-CD
  9862                                    W-COMP-COMPANY-CD
  9863                                    W-MAIL-COMPANY-CD
  9864                                    W-PNDB-COMPANY-CD
  9865                                    W-PNDB2-COMPANY-CD
  9866                                    W-PYAJ-COMPANY-CD.
  9867
  9868     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
  9869         MOVE PI-689-CARRIER     TO W-ACCT-CARRIER
  9870                                    W-CERT-CARRIER
  9871                                    W-MAIL-CARRIER
  9872                                    W-CERT-CARRIER
  9873                                    W-COMP-CARRIER
  9874                                    W-CHEK-CARRIER
  9875                                    W-PNDB2-CARRIER
  9876                                    W-PYAJ-CARRIER.
  9877
  9878     IF  PI-689-GROUPING GREATER THAN LOW-VALUES
  9879         MOVE PI-689-GROUPING    TO W-ACCT-GROUPING
  9880                                    W-CERT-GROUPING
  9881                                    W-CHEK-GROUPING
  9882                                    W-COMP-GROUPING
  9883                                    W-MAIL-GROUPING
  9884                                    W-PNDB2-GROUPING
  9885                                    W-PYAJ-GROUPING.
  9886
  9887     IF  PI-689-STATE GREATER THAN LOW-VALUES
  9888         MOVE PI-689-STATE       TO W-ACCT-STATE
  9889                                    W-CERT-STATE
  9890                                    W-CHEK-STATE
  9891                                    W-MAIL-STATE
  9892                                    W-PNDB2-STATE.
  9893
  9894     IF  PI-689-ACCOUNT GREATER THAN LOW-VALUES
  9895         IF PI-689-DATA-SOURCE = '3' OR '6'
  9896             MOVE PI-689-ACCOUNT TO W-COMP-ACCOUNT
  9897                                    W-PYAJ-ACCOUNT
  9898         ELSE
  9899             MOVE PI-689-ACCOUNT TO W-ACCT-ACCOUNT
  9900                                    W-CERT-ACCOUNT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 192
* EL689.cbl
  9901                                    W-CHEK-ACCOUNT
  9902                                    W-MAIL-ACCOUNT
  9903                                    W-PNDB2-ACCOUNT.
  9904
  9905     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  9906         MOVE PI-689-EFF-DATE    TO W-CERT-EFF-DT
  9907                                    W-CHEK-EFF-DT
  9908                                    W-MAIL-EFF-DT
  9909                                    W-PNDB2-EFF-DT.
  9910
  9911     IF  PI-689-CERT-PRIME GREATER THAN LOW-VALUES
  9912         MOVE PI-689-CERT-PRIME  TO W-CERT-CERT-PRIME
  9913                                    W-CHEK-CERT-PRIME
  9914                                    W-MAIL-CERT-PRIME
  9915                                    W-PNDB2-CERT-PRIME
  9916
  9917         IF  PI-689-CERT-SFX GREATER THAN LOW-VALUES
  9918             MOVE PI-689-CERT-SFX
  9919                                 TO W-CERT-CERT-SFX
  9920                                    W-CHEK-CERT-SFX
  9921                                    W-MAIL-CERT-SFX
  9922                                    W-PNDB2-CERT-SFX
  9923         ELSE
  9924             MOVE SPACES         TO W-CERT-CERT-SFX
  9925                                    W-CHEK-CERT-SFX
  9926                                    W-MAIL-CERT-SFX
  9927                                    W-PNDB2-CERT-SFX.
  9928
  9929     IF  PI-689-RESP-PERSON GREATER THAN LOW-VALUES
  9930         IF PI-689-DATA-SOURCE = '3' OR '6'
  9931             MOVE PI-689-RESP-PERSON
  9932                                 TO W-COMP-RESP-PERSON
  9933                                    W-PYAJ-FIN-RESP.
  9934
  9935     IF  PI-689-TYPE GREATER THAN LOW-VALUES
  9936         IF PI-689-DATA-SOURCE = '3' OR '6'
  9937             MOVE PI-689-TYPE    TO W-COMP-TYPE
  9938                                    W-PYAJ-RECORD-TYPE
  9939         ELSE
  9940             MOVE PI-689-TYPE    TO W-PNDB2-TYPE.
  9941
  9942     IF  PI-689-SEQ-NO GREATER THAN ZEROS
  9943         MOVE PI-689-SEQ-NO      TO W-PNDB-SEQ-NO
  9944                                    W-PYAJ-FILE-SEQ-NO
  9945                                    W-CHEK-SEQ-NO.
  9946
  9947     IF  PI-689-CHG-SEQ-NO GREATER THAN ZEROS
  9948         MOVE PI-689-CHG-SEQ-NO  TO W-PNDB-CHG-SEQ-NO
  9949                                    W-PNDB2-ALT-CHG-SEQ-NO.
  9950
  9951     IF  PI-689-ENTRY-BATCH GREATER THAN LOW-VALUES
  9952         MOVE PI-689-ENTRY-BATCH TO W-PNDB-ENTRY.
  9953
  9954     IF  PI-689-NO-ERRORS-DETECTED
  9955         PERFORM 2000-CREATE THRU 2000-EXIT
  9956         IF  NOT PI-689-FATAL-ERROR
  9957                 AND
  9958             NOT PI-689-ERR-DETECTED-PREV
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 193
* EL689.cbl
  9959             IF  PI-689-PRINT-ONLY
  9960                 PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9961             ELSE
  9962                 IF  PI-689-PRINT-FIRST
  9963                     PERFORM 7900-PRINT-LETTER-NOW THRU 7900-EXIT
  9964                     IF  NOT PI-689-FATAL-ERROR
  9965                         IF  PI-689-ARCHIVE-LETTER
  9966                             PERFORM 5400-LETTER-RELEASE
  9967                                 THRU 5400-EXIT
  9968                         ELSE
  9969                             MOVE ER-7390
  9970                                 TO PI-689-ERROR
  9971                     ELSE
  9972                         NEXT SENTENCE
  9973                 ELSE
  9974                     IF  NOT PI-689-ARCHIVE-LETTER
  9975                         MOVE ER-7390
  9976                                 TO PI-689-ERROR
  9977                     ELSE
  9978                         PERFORM 5400-LETTER-RELEASE
  9979                             THRU 5400-EXIT
  9980                         IF  NOT PI-689-FATAL-ERROR
  9981                             IF  PI-689-PRINT-SECOND
  9982                                 PERFORM 7900-PRINT-LETTER-NOW
  9983                                     THRU 7900-EXIT.
  9984
  9985 0600-EXIT.
  9986     EXIT.
  9987
  9988 0620-RETURN-TO-CALLER.
  9989
  9990     MOVE PROGRAM-INTERFACE-BLOCK
  9991                                 TO DFHCOMMAREA.
  9992
  9993* EXEC CICS RETURN
  9994*    END-EXEC.
  9995*    MOVE '.(                    ''   #00009772' TO DFHEIV0
  9996     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9997     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9998     MOVE X'2020233030303039373732' TO DFHEIV0(25:11)
  9999     CALL 'kxdfhei1' USING DFHEIV0,
 10000           DFHEIV99,
 10001           DFHEIV99,
 10002           DFHEIV99,
 10003           DFHEIV99,
 10004           DFHEIV99,
 10005           DFHEIV99
 10006     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10007
 10008
 10009 0700-GET-VARIABLE-LABEL.
 10010
 10011     IF  PI-689-VARIABLE-DATA-1 NOT GREATER THAN SPACES
 10012         MOVE '(VARIABLE NOT PROVIDED)'
 10013                                 TO W-RC-TEXT (1)
 10014                                    W-VG-TEXT (48)
 10015         GO TO 0700-EXIT.
 10016
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 194
* EL689.cbl
 10017     MOVE PI-689-VARIABLE-DATA-1 TO W-RC-TEXT (1)
 10018                                    W-VG-TEXT (48).
 10019     MOVE PI-689-VARIABLE-DATA-2 TO W-RC-TEXT (2)
 10020                                    W-VG-TEXT (49).
 10021     MOVE PI-689-VARIABLE-DATA-3 TO W-RC-TEXT (3)
 10022                                    W-VG-TEXT (50).
 10023     MOVE PI-689-VARIABLE-DATA-4 TO W-RC-TEXT (4)
 10024                                    W-VG-TEXT (51).
 10025     SET W-RG-NDX                TO +5.
 10026
 10027 0700-EXIT.
 10028     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 195
* EL689.cbl
 10030 0800-EDIT-KEY-FIELDS.
 10031***************************************************************
 10032*     THIS ROUTINE WILL DECIDE WHAT FIELDS ARE NECESSARY      *
 10033*     FROM THE DATA SOURCE FIELD.  IF A NECESSARY FIELD       *
 10034*     IS NOT PROVIDED AN ERROR WILL PREVENT FURTHER           *
 10035*     PROCESSING.                                             *
 10036***************************************************************
 10037     MOVE SPACES                 TO W-CNTL-KEY
 10038     MOVE LOW-VALUES             TO W-ACCT-KEY
 10039                                    W-CERT-KEY
 10040                                    W-CHEK-KEY
 10041                                    W-COMP-KEY
 10042                                    W-MAIL-KEY
 10043                                    W-PNDB-KEY
 10044                                    W-PNDB2-KEY
 10045                                    W-PYAJ-KEY.
 10046
 10047     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10048     MOVE PI-COMPANY-CD          TO W-ACCT-COMPANY-CD
 10049                                    W-CERT-COMPANY-CD
 10050                                    W-CHEK-COMPANY-CD
 10051                                    W-COMP-COMPANY-CD
 10052                                    W-MAIL-COMPANY-CD
 10053                                    W-PNDB-COMPANY-CD
 10054                                    W-PNDB2-COMPANY-CD
 10055                                    W-PYAJ-COMPANY-CD.
 10056
 10057     PERFORM 0900-EDIT-CARRIER THRU 0900-EXIT.
 10058     PERFORM 0905-EDIT-GROUPING THRU 0905-EXIT.
 10059     PERFORM 0910-EDIT-STATE THRU 0910-EXIT.
 10060     PERFORM 0915-EDIT-ACCOUNT THRU 0915-EXIT.
 10061     PERFORM 0920-EDIT-EXP-DATE THRU 0920-EXIT.
 10062     PERFORM 0925-EDIT-EFF-DATE THRU 0925-EXIT.
 10063     PERFORM 0930-EDIT-CERTIFICATE THRU 0930-EXIT.
 10064     PERFORM 0935-EDIT-RESP-PERSON THRU 0935-EXIT.
 10065     PERFORM 0940-EDIT-ACCOUNT THRU 0940-EXIT.
 10066     PERFORM 0945-EDIT-TYPE THRU 0945-EXIT.
 10067     PERFORM 0950-EDIT-ENTRY THRU 0950-EXIT.
 10068     PERFORM 0955-EDIT-SEQUENCE THRU 0955-EXIT.
 10069     PERFORM 0960-EDIT-BATCH-SEQ THRU 0960-EXIT.
 10070     PERFORM 0965-EDIT-TYPE THRU 0965-EXIT.
 10071     PERFORM 0970-EDIT-CSO THRU 0970-EXIT.
 10072
 10073     IF  DATASORI NUMERIC
 10074         MOVE DATASORI           TO W-DATA-SOURCE
 10075                                    PI-689-DATA-SOURCE
 10076         GO TO 0800-SOURCE-ACCOUNT
 10077               0800-SOURCE-CERTIFICATE
 10078               0800-SOURCE-COMPENSATION
 10079               0800-SOURCE-PENDING
 10080               0800-SOURCE-CHEK
 10081               0800-SOURCE-PAYMENTS-ADJS
 10082                                 DEPENDING ON W-DATA-SOURCE.
 10083
 10084     IF  FORMI NOT EQUAL '9999'
 10085         MOVE ER-7365            TO EMI-ERROR
 10086         MOVE -1                 TO MAINTL
 10087         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 196
* EL689.cbl
 10088         GO TO 8200-SEND-DATAONLY
 10089
 10090     ELSE
 10091         GO TO 0800-EXIT.
 10092
 10093 0800-SOURCE-ACCOUNT.
 10094
 10095     IF  W-ACCT-COMPANY-CD EQUAL LOW-VALUES
 10096             OR
 10097         W-ACCT-CARRIER EQUAL LOW-VALUES
 10098             OR
 10099         W-ACCT-GROUPING EQUAL LOW-VALUES
 10100             OR
 10101         W-ACCT-STATE EQUAL LOW-VALUES
 10102             OR
 10103         W-ACCT-ACCOUNT EQUAL LOW-VALUES
 10104             OR
 10105         W-ACCT-EXP-DT EQUAL LOW-VALUES
 10106         MOVE ER-7376            TO EMI-ERROR
 10107         MOVE -1                 TO MAINTL
 10108         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10109
 10110     GO TO 0800-ERROR-TEST.
 10111
 10112 0800-SOURCE-CERTIFICATE.
 10113
 10114     IF  W-CERT-COMPANY-CD EQUAL LOW-VALUES
 10115             OR
 10116         W-CERT-CARRIER EQUAL LOW-VALUES
 10117             OR
 10118         W-CERT-GROUPING EQUAL LOW-VALUES
 10119             OR
 10120         W-CERT-STATE EQUAL LOW-VALUES
 10121             OR
 10122         W-CERT-ACCOUNT EQUAL LOW-VALUES
 10123             OR
 10124         W-CERT-EFF-DT EQUAL LOW-VALUES
 10125             OR
 10126         W-CERT-CERT-NO EQUAL LOW-VALUES
 10127         MOVE ER-7377            TO EMI-ERROR
 10128         MOVE -1                 TO MAINTL
 10129         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10130
 10131     GO TO 0800-ERROR-TEST.
 10132
 10133 0800-SOURCE-COMPENSATION.
 10134
 10135     IF  W-COMP-COMPANY-CD EQUAL LOW-VALUES
 10136             OR
 10137         W-COMP-CARRIER EQUAL LOW-VALUES
 10138             OR
 10139         W-COMP-GROUPING EQUAL LOW-VALUES
 10140             OR
 10141         W-COMP-RESP-PERSON EQUAL LOW-VALUES
 10142             OR
 10143         W-COMP-TYPE EQUAL LOW-VALUES
 10144             OR
 10145         (W-COMP-TYPE EQUAL 'A'
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 197
* EL689.cbl
 10146                 AND
 10147             W-COMP-ACCOUNT EQUAL LOW-VALUES)
 10148         MOVE ER-7378            TO EMI-ERROR
 10149         MOVE -1                 TO MAINTL
 10150         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10151
 10152     GO TO 0800-ERROR-TEST.
 10153
 10154 0800-SOURCE-PENDING.
 10155
 10156     IF  BENTRYL EQUAL ZEROS
 10157         IF  W-PNDB2-COMPANY-CD EQUAL LOW-VALUES
 10158                 OR
 10159             W-PNDB2-CARRIER EQUAL LOW-VALUES
 10160                 OR
 10161             W-PNDB2-GROUPING EQUAL LOW-VALUES
 10162                 OR
 10163             W-PNDB2-STATE EQUAL LOW-VALUES
 10164                 OR
 10165             W-PNDB2-ACCOUNT EQUAL LOW-VALUES
 10166                 OR
 10167             W-PNDB2-EFF-DT EQUAL LOW-VALUES
 10168                 OR
 10169             W-PNDB2-CERT-NO EQUAL LOW-VALUES
 10170                 OR
 10171             W-PNDB2-TYPE EQUAL LOW-VALUES
 10172                 OR
 10173             W-PNDB2-ALT-CHG-SEQ-NO NOT = ZEROS
 10174             MOVE ER-7379        TO EMI-ERROR
 10175             MOVE -1             TO MAINTL
 10176             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10177         ELSE
 10178             NEXT SENTENCE
 10179     ELSE
 10180         IF  W-PNDB-COMPANY-CD EQUAL LOW-VALUES
 10181                 OR
 10182             W-PNDB-ENTRY EQUAL LOW-VALUES
 10183                 OR
 10184             W-PNDB-SEQ-NO EQUAL ZEROS
 10185             MOVE ER-7379        TO EMI-ERROR
 10186             MOVE -1             TO MAINTL
 10187             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10188
 10189     GO TO 0800-ERROR-TEST.
 10190
 10191 0800-SOURCE-CHEK.
 10192
 10193     IF  W-CHEK-COMPANY-CD EQUAL LOW-VALUES
 10194             OR
 10195         W-CHEK-CARRIER EQUAL LOW-VALUES
 10196             OR
 10197         W-CHEK-GROUPING EQUAL LOW-VALUES
 10198             OR
 10199         W-CHEK-STATE EQUAL LOW-VALUES
 10200             OR
 10201         W-CHEK-ACCOUNT EQUAL LOW-VALUES
 10202             OR
 10203         W-CHEK-EFF-DT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 198
* EL689.cbl
 10204             OR
 10205         W-CHEK-CERT-NO EQUAL LOW-VALUES
 10206         MOVE ER-7381            TO EMI-ERROR
 10207         MOVE -1                 TO MAINTL
 10208         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10209
 10210     GO TO 0800-ERROR-TEST.
 10211
 10212 0800-SOURCE-PAYMENTS-ADJS.
 10213
 10214     IF  W-PYAJ-COMPANY-CD EQUAL LOW-VALUES
 10215             OR
 10216         W-PYAJ-CARRIER EQUAL LOW-VALUES
 10217             OR
 10218         W-PYAJ-GROUPING EQUAL LOW-VALUES
 10219             OR
 10220         W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 10221             OR
 10222         W-PYAJ-ACCOUNT EQUAL LOW-VALUES
 10223             OR
 10224         W-PYAJ-RECORD-TYPE EQUAL LOW-VALUES
 10225         MOVE ER-7396            TO EMI-ERROR
 10226         MOVE -1                 TO MAINTL
 10227         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10228
 10229     GO TO 0800-ERROR-TEST.
 10230
 10231 0800-ERROR-TEST.
 10232
 10233     IF  NOT EMI-NO-ERRORS
 10234         IF  EMI-ERROR EQUAL ER-7250
 10235             GO TO 0800-EXIT
 10236         ELSE
 10237             GO TO 8200-SEND-DATAONLY.
 10238
 10239 0800-EXIT.
 10240     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 199
* EL689.cbl
 10242 0900-EDIT-CARRIER.
 10243
 10244     IF  CARRIERL EQUAL ZEROES
 10245         MOVE LOW-VALUES         TO PI-689-CARRIER
 10246                                    W-ACCT-CARRIER
 10247                                    W-CERT-CARRIER
 10248                                    W-COMP-CARRIER
 10249                                    W-CHEK-CARRIER
 10250                                    W-MAIL-CARRIER
 10251                                    W-PNDB2-CARRIER
 10252                                    W-PYAJ-CARRIER
 10253     ELSE
 10254         PERFORM 0990-CARRIER-VALIDITY-CHECK THRU 0990-EXIT.
 10255
 10256 0900-EXIT.
 10257     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 200
* EL689.cbl
 10259 0905-EDIT-GROUPING.
 10260
 10261     IF  GROUPL EQUAL ZEROES
 10262         MOVE LOW-VALUES         TO PI-689-GROUPING
 10263                                    W-ACCT-GROUPING
 10264                                    W-CERT-GROUPING
 10265                                    W-CHEK-GROUPING
 10266                                    W-COMP-GROUPING
 10267                                    W-MAIL-GROUPING
 10268                                    W-PNDB2-GROUPING
 10269                                    W-PYAJ-GROUPING
 10270     ELSE
 10271         MOVE AL-UANON           TO GROUPA
 10272         MOVE GROUPI             TO PI-689-GROUPING
 10273                                    W-ACCT-GROUPING
 10274                                    W-CERT-GROUPING
 10275                                    W-CHEK-GROUPING
 10276                                    W-COMP-GROUPING
 10277                                    W-MAIL-GROUPING
 10278                                    W-PNDB2-GROUPING
 10279                                    W-PYAJ-GROUPING.
 10280
 10281 0905-EXIT.
 10282     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 201
* EL689.cbl
 10284 0910-EDIT-STATE.
 10285
 10286     IF  STATEL EQUAL ZEROES
 10287         MOVE LOW-VALUES         TO PI-689-STATE
 10288                                    W-ACCT-STATE
 10289                                    W-CERT-STATE
 10290                                    W-CHEK-STATE
 10291                                    W-MAIL-STATE
 10292                                    W-PNDB2-STATE
 10293     ELSE
 10294         PERFORM 0994-STATE-VALIDITY-CHECK THRU 0994-EXIT.
 10295
 10296 0910-EXIT.
 10297     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 202
* EL689.cbl
 10299 0915-EDIT-ACCOUNT.
 10300
 10301     IF  ACCTL EQUAL ZEROES
 10302         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10303                                    W-ACCT-ACCOUNT
 10304                                    W-CERT-ACCOUNT
 10305                                    W-CHEK-ACCOUNT
 10306                                    W-COMP-ACCOUNT
 10307                                    W-MAIL-ACCOUNT
 10308                                    W-PNDB2-ACCOUNT
 10309                                    W-PYAJ-ACCOUNT
 10310     ELSE
 10311         MOVE AL-UANON           TO ACCTA
 10312         MOVE ACCTI              TO PI-689-ACCOUNT
 10313                                    W-ACCT-ACCOUNT
 10314                                    W-CERT-ACCOUNT
 10315                                    W-CHEK-ACCOUNT
 10316                                    W-COMP-ACCOUNT
 10317                                    W-MAIL-ACCOUNT
 10318                                    W-PYAJ-ACCOUNT
 10319                                    W-PNDB2-ACCOUNT.
 10320
 10321 0915-EXIT.
 10322     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 203
* EL689.cbl
 10324 0920-EDIT-EXP-DATE.
 10325
 10326     IF  DATEL NOT EQUAL ZEROS
 10327         IF  DATEI EQUAL '99/99/99' OR '999999'
 10328             MOVE '99/99/99'     TO DATEO
 10329                                    PI-689-DATE-EDIT
 10330             MOVE AL-UANON       TO DATEA
 10331             MOVE HIGH-VALUES    TO PI-689-EXP-DATE
 10332                                    W-ACCT-EXP-DT
 10333         ELSE
 10334             MOVE DATEI          TO W-DEEDIT-FIELD
 10335             PERFORM 8600-DEEDIT
 10336             MOVE W-DEEDIT-FIELD-V0
 10337                                 TO DC-GREG-DATE-1-MDY
 10338             MOVE '4'            TO DC-OPTION-CODE
 10339             PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10340             IF  DATE-CONVERSION-ERROR
 10341                 MOVE ER-0454    TO EMI-ERROR
 10342                 MOVE -1         TO DATEL
 10343                 MOVE AL-UABON   TO DATEA
 10344                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10345             ELSE
 10346                 MOVE DC-GREG-DATE-1-EDIT
 10347                                 TO DATEO
 10348                                    PI-689-DATE-EDIT
 10349                 MOVE AL-UANON   TO DATEA
 10350                 MOVE DC-BIN-DATE-1
 10351                                 TO PI-689-EXP-DATE
 10352                                    W-ACCT-EXP-DT
 10353     ELSE
 10354         MOVE LOW-VALUES         TO PI-689-EXP-DATE
 10355                                    W-ACCT-EXP-DT
 10356                                    PI-689-DATE-EDIT.
 10357
 10358 0920-EXIT.
 10359     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 204
* EL689.cbl
 10361 0925-EDIT-EFF-DATE.
 10362
 10363     IF  CERTL EQUAL ZERO
 10364             AND
 10365         DATASORI NOT EQUAL '2'
 10366         GO TO 0925-EXIT.
 10367
 10368     IF  DATEL NOT EQUAL ZEROS
 10369         MOVE DATEI              TO W-DEEDIT-FIELD
 10370         PERFORM 8600-DEEDIT
 10371         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-MDY
 10372         MOVE '4'                TO DC-OPTION-CODE
 10373         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10374
 10375         IF  DATE-CONVERSION-ERROR
 10376             MOVE ER-0215        TO EMI-ERROR
 10377             MOVE -1             TO DATEL
 10378             MOVE AL-UABON       TO DATEA
 10379             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10380         ELSE
 10381             MOVE DC-GREG-DATE-1-EDIT
 10382                                 TO DATEO
 10383                                    PI-689-DATE-EDIT
 10384             MOVE AL-UANON       TO DATEA
 10385             MOVE DC-BIN-DATE-1  TO PI-689-EFF-DATE
 10386                                    W-CERT-EFF-DT
 10387                                    W-CHEK-EFF-DT
 10388                                    W-MAIL-EFF-DT
 10389                                    W-PNDB2-EFF-DT
 10390     ELSE
 10391         MOVE LOW-VALUES         TO PI-689-EFF-DATE
 10392                                    W-PNDB2-EFF-DT
 10393                                    W-CHEK-EFF-DT
 10394                                    W-MAIL-EFF-DT
 10395                                    W-CERT-EFF-DT
 10396                                    PI-689-DATE-EDIT.
 10397
 10398 0925-EXIT.
 10399     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 205
* EL689.cbl
 10401 0930-EDIT-CERTIFICATE.
 10402
 10403     IF  CERTL EQUAL ZEROES
 10404         MOVE LOW-VALUES         TO PI-689-CERT-PRIME
 10405                                    W-CERT-CERT-PRIME
 10406                                    W-CHEK-CERT-PRIME
 10407                                    W-MAIL-CERT-PRIME
 10408                                    W-PNDB2-CERT-PRIME
 10409                                    PI-689-CERT-SFX
 10410                                    W-CERT-CERT-SFX
 10411                                    W-CHEK-CERT-SFX
 10412                                    W-MAIL-CERT-SFX
 10413                                    W-PNDB2-CERT-SFX
 10414     ELSE
 10415         MOVE AL-UANON           TO CERTA
 10416         MOVE CERTI              TO PI-689-CERT-PRIME
 10417                                    W-CERT-CERT-PRIME
 10418                                    W-CHEK-CERT-PRIME
 10419                                    W-MAIL-CERT-PRIME
 10420                                    W-PNDB2-CERT-PRIME
 10421         IF  SFXL EQUAL ZEROES
 10422                 OR
 10423             SFXI EQUAL LOW-VALUES
 10424             MOVE SPACES         TO PI-689-CERT-SFX
 10425                                    W-CERT-CERT-SFX
 10426                                    W-CHEK-CERT-SFX
 10427                                    W-MAIL-CERT-SFX
 10428                                    W-PNDB2-CERT-SFX
 10429         ELSE
 10430             MOVE AL-UANON       TO SFXA
 10431             MOVE SFXI           TO PI-689-CERT-SFX
 10432                                    W-CERT-CERT-SFX
 10433                                    W-CHEK-CERT-SFX
 10434                                    W-MAIL-CERT-SFX
 10435                                    W-PNDB2-CERT-SFX.
 10436
 10437 0930-EXIT.
 10438     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 206
* EL689.cbl
 10440 0935-EDIT-RESP-PERSON.
 10441
 10442     IF  RPERSONL EQUAL ZEROES
 10443         MOVE LOW-VALUES         TO PI-689-RESP-PERSON
 10444                                    W-COMP-RESP-PERSON
 10445                                    W-PYAJ-FIN-RESP
 10446     ELSE
 10447         MOVE AL-UANON           TO RPERSONA
 10448         MOVE RPERSONI           TO PI-689-RESP-PERSON
 10449                                    W-PYAJ-FIN-RESP
 10450                                    W-COMP-RESP-PERSON.
 10451
 10452 0935-EXIT.
 10453     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 207
* EL689.cbl
 10455 0940-EDIT-ACCOUNT.
 10456
 10457     IF  ACCTL EQUAL ZEROES
 10458         MOVE LOW-VALUES         TO PI-689-ACCOUNT
 10459                                    W-COMP-ACCOUNT
 10460                                    W-PYAJ-ACCOUNT
 10461     ELSE
 10462         MOVE AL-UANON           TO ACCTA
 10463         MOVE ACCTI              TO PI-689-ACCOUNT
 10464                                    W-PYAJ-ACCOUNT
 10465                                    W-COMP-ACCOUNT.
 10466
 10467 0940-EXIT.
 10468     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 208
* EL689.cbl
 10470 0945-EDIT-TYPE.
 10471
 10472     IF  TYPEL EQUAL ZEROES
 10473         MOVE LOW-VALUES         TO PI-689-TYPE
 10474                                    W-COMP-TYPE
 10475                                    W-PYAJ-RECORD-TYPE
 10476     ELSE
 10477         INSPECT TYPEI CONVERTING W-LOWER-CASE TO W-UPPER-CASE
 10478         IF TYPEI = 'C' OR 'G' OR 'A'
 10479             MOVE AL-UANON       TO TYPEA
 10480             MOVE TYPEI          TO PI-689-TYPE
 10481                                    W-COMP-TYPE
 10482                                    W-PYAJ-RECORD-TYPE
 10483         ELSE
 10484             MOVE ER-7368        TO EMI-ERROR
 10485             MOVE -1             TO TYPEL
 10486             MOVE AL-UABON       TO TYPEA
 10487             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10488
 10489 0945-EXIT.
 10490     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 209
* EL689.cbl
 10492 0950-EDIT-ENTRY.
 10493
 10494     IF  BENTRYL EQUAL ZEROES
 10495         MOVE LOW-VALUES         TO PI-689-ENTRY-BATCH
 10496                                    W-PNDB-ENTRY
 10497     ELSE
 10498         MOVE AL-UANON           TO BENTRYA
 10499         MOVE BENTRYI            TO PI-689-ENTRY-BATCH
 10500                                    W-PNDB-ENTRY.
 10501
 10502 0950-EXIT.
 10503     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 210
* EL689.cbl
 10505 0955-EDIT-SEQUENCE.
 10506
 10507     IF  SEQL NOT EQUAL ZEROS
 10508         IF  SEQI NOT NUMERIC
 10509                 OR
 10510             SEQI EQUAL '0'
 10511             MOVE ER-7367        TO EMI-ERROR
 10512             MOVE -1             TO SEQL
 10513             MOVE AL-UABON       TO SEQA
 10514             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10515         ELSE
 10516             MOVE AL-UANON       TO SEQA
 10517             MOVE SEQI           TO PI-689-SEQ-NO
 10518                                    W-CHEK-SEQ-NO
 10519                                    W-PYAJ-FILE-SEQ-NO
 10520                                    W-PNDB-SEQ-NO
 10521                                    PI-689-SEQ-EDIT
 10522     ELSE
 10523         MOVE LOW-VALUES         TO PI-689-SEQ-EDIT.
 10524
 10525 0955-EXIT.
 10526     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 211
* EL689.cbl
 10528 0960-EDIT-BATCH-SEQ.
 10529
 10530     IF  BCSEQL NOT EQUAL ZEROS
 10531         IF  BCSEQI NOT NUMERIC
 10532             MOVE ER-7368        TO EMI-ERROR
 10533             MOVE -1             TO BCSEQL
 10534             MOVE AL-UABON       TO BCSEQA
 10535             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10536         ELSE
 10537             MOVE AL-UANON       TO BCSEQA
 10538             MOVE BCSEQI         TO PI-689-CHG-SEQ-NO
 10539                                    W-PNDB-CHG-SEQ-NO
 10540                                    W-PNDB2-ALT-CHG-SEQ-NO
 10541                                    PI-689-BCSEQ-EDIT
 10542     ELSE
 10543         MOVE LOW-VALUES         TO PI-689-BCSEQ-EDIT.
 10544
 10545 0960-EXIT.
 10546     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 212
* EL689.cbl
 10548 0965-EDIT-TYPE.
 10549
 10550     IF  TYPEL EQUAL ZEROES
 10551         MOVE LOW-VALUES         TO PI-689-TYPE
 10552                                    W-PNDB2-TYPE
 10553     ELSE
 10554         IF  DATASORI NOT EQUAL '4'
 10555             GO TO 0965-EXIT
 10556         ELSE
 10557             IF TYPEI = '0' OR '1' OR '2' OR '3'
 10558                 MOVE AL-UANON   TO TYPEA
 10559                 MOVE TYPEI      TO PI-689-TYPE
 10560                                    W-PNDB2-TYPE
 10561             ELSE
 10562                 MOVE ER-7370    TO EMI-ERROR
 10563                 MOVE -1         TO TYPEL
 10564                 MOVE AL-UABON   TO TYPEA
 10565                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10566
 10567 0965-EXIT.
 10568     EXIT.
 10569
 10570 0970-EDIT-CSO.
 10571
 10572     IF ENDARCHL > ZEROS
 10573        IF ENDARCHI NUMERIC
 10574            MOVE ENDARCHI       TO PI-ENDT-ARCH-NO
 10575            MOVE AL-UNNON       TO ENDARCHA
 10576            MOVE ENDARCHI       TO W-ERENDT-ARCHIVE
 10577            MOVE PI-COMPANY-CD  TO W-ERENDT-COMPANY-CD-A1
 10578            MOVE 'N'            TO W-VALID-ENDT-SW
 10579            PERFORM 0355-CHECK-ERENDT THRU 0355-EXIT
 10580            IF NOT W-VALID-ENDT
 10581                MOVE -1         TO ENDARCHL
 10582                MOVE ER-1565    TO EMI-ERROR
 10583                MOVE AL-UNBON   TO ENDARCHA
 10584                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10585            END-IF
 10586        END-IF
 10587     ELSE
 10588        MOVE ZEROS              TO PI-ENDT-ARCH-NO
 10589     END-IF
 10590
 10591     IF PI-CERT-REQ-IND = 'Y'
 10592       IF  CERTIDL NOT EQUAL ZEROS
 10593         IF CERTIDI NUMERIC
 10594             MOVE AL-UANON      TO CERTIDA
 10595             MOVE CERTIDI       TO PI-CERT-FORM-ID
 10596         ELSE
 10597             MOVE ER-1778       TO EMI-ERROR
 10598             MOVE -1            TO CERTIDL
 10599             MOVE AL-UABON      TO CERTIDA
 10600             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10601         END-IF
 10602       ELSE
 10603          MOVE ER-0715       TO EMI-ERROR
 10604          MOVE -1            TO CERTIDL
 10605          MOVE AL-UABON      TO CERTIDA
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 213
* EL689.cbl
 10606          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10607       END-IF
 10608     END-IF.
 10609
 10610 0970-EXIT.
 10611      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 214
* EL689.cbl
 10613 0990-CARRIER-VALIDITY-CHECK.
 10614
 10615     IF  CARRIERI EQUAL SPACES
 10616         GO TO 0990-EXIT.
 10617
 10618     MOVE SPACES                 TO W-CNTL-KEY.
 10619     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10620     MOVE '6'                    TO W-CNTL-RECORD-TYPE.
 10621     MOVE CARRIERI               TO W-CNTL-GEN4.
 10622     MOVE +0                     TO W-CNTL-SEQ-NO.
 10623
 10624
 10625* EXEC CICS HANDLE CONDITION
 10626*        NOTFND  (0990-CARRIER-NOT-FOUND)
 10627*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10628*    END-EXEC.
 10629*    MOVE '"$IJ                  ! & #00010390' TO DFHEIV0
 10630     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10631     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10632     MOVE X'2620233030303130333930' TO DFHEIV0(25:11)
 10633     CALL 'kxdfhei1' USING DFHEIV0
 10634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10635
 10636
 10637
 10638* EXEC CICS READ
 10639*        DATASET (W-CNTL-FILE-ID)
 10640*        SET     (ADDRESS OF CONTROL-FILE)
 10641*        RIDFLD  (W-CNTL-KEY)
 10642*    END-EXEC.
 10643*    MOVE '&"S        E          (   #00010395' TO DFHEIV0
 10644     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10645     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10646     MOVE X'2020233030303130333935' TO DFHEIV0(25:11)
 10647     CALL 'kxdfhei1' USING DFHEIV0,
 10648           W-CNTL-FILE-ID,
 10649           DFHEIV20,
 10650           DFHEIV99,
 10651           W-CNTL-KEY,
 10652           DFHEIV99,
 10653           DFHEIV99,
 10654           DFHEIV99
 10655     SET ADDRESS OF CONTROL-FILE TO
 10656         DFHEIV20
 10657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10658
 10659
 10660     IF  PI-NO-CARRIER-SECURITY
 10661             OR
 10662         PI-CARRIER-SECURITY EQUAL CARRIERI
 10663         MOVE AL-UANON           TO CARRIERA
 10664         MOVE CARRIERI           TO PI-689-CARRIER
 10665                                    W-ACCT-CARRIER
 10666                                    W-CERT-CARRIER
 10667                                    W-CHEK-CARRIER
 10668                                    W-COMP-CARRIER
 10669                                    W-MAIL-CARRIER
 10670                                    W-PNDB2-CARRIER
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 215
* EL689.cbl
 10671                                    W-PYAJ-CARRIER
 10672     ELSE
 10673         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
 10674         MOVE ER-9095            TO EMI-ERROR
 10675         MOVE -1                 TO MAINTL
 10676         MOVE AL-UANON           TO MAINTA
 10677         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10678
 10679     GO TO 0990-EXIT.
 10680
 10681 0990-CARRIER-NOT-FOUND.
 10682
 10683     MOVE -1                     TO CARRIERL.
 10684     MOVE AL-UABON               TO CARRIERA.
 10685     MOVE ER-2208                TO EMI-ERROR.
 10686     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10687
 10688 0990-EXIT.
 10689     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 216
* EL689.cbl
 10691 0994-STATE-VALIDITY-CHECK.
 10692
 10693     IF  STATEI EQUAL SPACES
 10694         GO TO 0994-EXIT.
 10695
 10696     MOVE SPACES                 TO W-CNTL-KEY.
 10697     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 10698     MOVE '3'                    TO W-CNTL-RECORD-TYPE.
 10699     MOVE STATEI                 TO W-CNTL-GEN1.
 10700     MOVE +0                     TO W-CNTL-SEQ-NO.
 10701
 10702
 10703* EXEC CICS HANDLE CONDITION
 10704*        NOTFND  (0994-STATE-NOT-FOUND)
 10705*        NOTOPEN (8040-CNTL-NOT-OPEN)
 10706*    END-EXEC.
 10707*    MOVE '"$IJ                  ! '' #00010443' TO DFHEIV0
 10708     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
 10709     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10710     MOVE X'2720233030303130343433' TO DFHEIV0(25:11)
 10711     CALL 'kxdfhei1' USING DFHEIV0
 10712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10713
 10714
 10715
 10716* EXEC CICS READ
 10717*        DATASET (W-CNTL-FILE-ID)
 10718*        SET     (ADDRESS OF CONTROL-FILE)
 10719*        RIDFLD  (W-CNTL-KEY)
 10720*    END-EXEC.
 10721*    MOVE '&"S        E          (   #00010448' TO DFHEIV0
 10722     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10723     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10724     MOVE X'2020233030303130343438' TO DFHEIV0(25:11)
 10725     CALL 'kxdfhei1' USING DFHEIV0,
 10726           W-CNTL-FILE-ID,
 10727           DFHEIV20,
 10728           DFHEIV99,
 10729           W-CNTL-KEY,
 10730           DFHEIV99,
 10731           DFHEIV99,
 10732           DFHEIV99
 10733     SET ADDRESS OF CONTROL-FILE TO
 10734         DFHEIV20
 10735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10736
 10737
 10738     MOVE AL-UANON               TO STATEA.
 10739     MOVE STATEI                 TO PI-689-STATE
 10740                                    W-ACCT-STATE
 10741                                    W-CERT-STATE
 10742                                    W-CHEK-STATE
 10743                                    W-MAIL-STATE
 10744                                    W-PNDB2-STATE.
 10745
 10746     GO TO 0994-EXIT.
 10747
 10748 0994-STATE-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 217
* EL689.cbl
 10749
 10750     MOVE -1                     TO STATEL.
 10751     MOVE AL-UABON               TO STATEA.
 10752     MOVE ER-2209                TO EMI-ERROR.
 10753     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10754
 10755 0994-EXIT.
 10756     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 218
* EL689.cbl
 10758 1000-SHOW.
 10759***************************************************************
 10760*     THIS ROUTINE WILL BROWSE THE ARCHIVE FILE WITH THE      *
 10761*     ARCHIVE NUMBER SPECIFIED FROM THE SCREEN.  IF THE       *
 10762*     HEADER RECORD IS FOUND THE TEXT IS THEN READ AND        *
 10763*     WILL BE INSERTED INTO THE W-TS-TABLE AND DISPLAYED.     *
 10764***************************************************************
 10765
 10766     MOVE SPACES                 TO W-RECORD-TABLE.
 10767
 10768     IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 10769          MOVE PI-689-LBL-OVERRIDE
 10770                                 TO ADDRLBLI
 10771          MOVE +1                TO ADDRLBLL
 10772          MOVE AL-UANON          TO ADDRLBLA
 10773     ELSE
 10774          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 10775          MOVE +1                TO ADDRLBLL
 10776          MOVE AL-UANON          TO ADDRLBLA.
 10777
 10778     IF  ARCHNUML EQUAL ZEROS
 10779         MOVE -1                 TO ARCHNUML
 10780         MOVE AL-UNBON           TO ARCHNUMA
 10781         MOVE ER-0174            TO EMI-ERROR
 10782         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10783         GO TO 8200-SEND-DATAONLY.
 10784
 10785     IF  ARCHNUMI NOT NUMERIC
 10786         MOVE -1                 TO ARCHNUML
 10787         MOVE AL-UNBON           TO ARCHNUMA
 10788         MOVE ER-0175            TO EMI-ERROR
 10789         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 10790         GO TO 8200-SEND-DATAONLY.
 10791
 10792     IF  PI-SHOW-MODE
 10793
 10794         IF  PI-689-ARCHIVE-NUMBER EQUAL ARCHNUMI
 10795             MOVE -1             TO MAINTL
 10796             GO TO 8200-SEND-DATAONLY
 10797         ELSE
 10798             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT.
 10799
 10800     MOVE +0                     TO W-ARCH-SEQ-NO
 10801                                    W-ARCT-SEQ-NO.
 10802     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
 10803                                    W-ARCT-COMPANY-CD.
 10804     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 10805                                    W-ARCT-NUMBER
 10806                                    PI-689-ARCHIVE-NUMBER.
 10807     MOVE ' '                    TO W-ARCT-REC-TYPE.
 10808     MOVE '1'                    TO PI-ACTION.
 10809     MOVE SPACES                 TO PI-689-PRINT-SW
 10810                                    PI-689-FORM-NUMBER
 10811                                    W-DELETE-KEY.
 10812     SET W-RG-NDX                TO W-ZEROS.
 10813
 10814
 10815* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 219
* EL689.cbl
 10816*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 10817*         NOTFND     (1070-ARCH-NOT-FOUND)
 10818*         ENDFILE    (1070-ARCH-NOT-FOUND)
 10819*    END-EXEC.
 10820*    MOVE '"$JI''                 ! ( #00010530' TO DFHEIV0
 10821     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 10822     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10823     MOVE X'2820233030303130353330' TO DFHEIV0(25:11)
 10824     CALL 'kxdfhei1' USING DFHEIV0
 10825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10826
 10827
 10828
 10829* EXEC CICS READ
 10830*        DATASET (W-ARCH-FILE-ID)
 10831*        SET     (ADDRESS OF LETTER-ARCHIVE)
 10832*        RIDFLD  (W-ARCH-KEY)
 10833*    END-EXEC.
 10834*    MOVE '&"S        E          (   #00010536' TO DFHEIV0
 10835     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10836     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10837     MOVE X'2020233030303130353336' TO DFHEIV0(25:11)
 10838     CALL 'kxdfhei1' USING DFHEIV0,
 10839           W-ARCH-FILE-ID,
 10840           DFHEIV20,
 10841           DFHEIV99,
 10842           W-ARCH-KEY,
 10843           DFHEIV99,
 10844           DFHEIV99,
 10845           DFHEIV99
 10846     SET ADDRESS OF LETTER-ARCHIVE TO
 10847         DFHEIV20
 10848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10849
 10850
 10851     PERFORM 1040-FORMAT-HEADER-DATA THRU 1040-EXIT.
 10852
 10853*    EXEC CICS HANDLE CONDITION
 10854*         NOTOPEN    (8015-ARCT-NOT-OPEN)
 10855*         NOTFND     (1020-ARCT-ENDBR)
 10856*         ENDFILE    (1020-ARCT-ENDBR)
 10857*    END-EXEC.
 10858*
 10859*1005-START-BROWSE.
 10860*
 10861*    EXEC CICS STARTBR
 10862*         DATASET    (W-ARCT-FILE-ID)
 10863*         RIDFLD     (W-ARCT-KEY)
 10864*         GTEQ
 10865*    END-EXEC.
 10866*
 10867*    MOVE 'Y'                    TO W-ARCT-BROWSE-STARTED.
 10868*
 10869*1010-READ-NEXT.
 10870*
 10871*    EXEC CICS READNEXT
 10872*         SET       (ADDRESS OF LETTER-ARCHIVE-TEXT)
 10873*         DATASET   (W-ARCT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 220
* EL689.cbl
 10874*         RIDFLD    (W-ARCT-KEY)
 10875*    END-EXEC.
 10876*
 10877*    IF  W-ARCH-PARTIAL-KEY EQUAL W-ARCT-PARTIAL-KEY
 10878*        IF  LT-ADDRESS-DATA
 10879*            IF  PI-CREATE-LABELS  AND
 10880*                NOT PI-689-LABELS-OVERRIDEN
 10881*                PERFORM 1050-MOVE-LABELS THRU 1050-EXIT
 10882*                        VARYING
 10883*                    LT-NDX FROM 1 BY 1
 10884*                        UNTIL
 10885*                    LT-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 10886*                GO TO 1010-READ-NEXT
 10887*            ELSE
 10888*                MOVE LT-CONTROL-PRIMARY
 10889*                                TO W-DELETE-KEY
 10890*                GO TO 1010-READ-NEXT
 10891*        ELSE
 10892*            PERFORM 1030-TEXT-BUILD THRU 1030-EXIT
 10893*                    VARYING
 10894*                LT-NDX FROM 1 BY 1
 10895*                    UNTIL
 10896*                LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD
 10897*                    OR
 10898*                LT-NDX GREATER THAN +20
 10899*            GO TO 1010-READ-NEXT.
 10900*
 10901*1020-ARCT-ENDBR.
 10902*
 10903*    IF  W-ARCT-BROWSE-STARTED EQUAL 'Y'
 10904*        EXEC CICS ENDBR
 10905*             DATASET   (W-ARCT-FILE-ID)
 10906*        END-EXEC.
 10907*
 10908*    IF  W-RG-NDX EQUAL ZEROS
 10909*        GO TO 1080-ARCHIVE-TEXT-NOT-FOUND.
 10910*
 10911*    IF  PI-689-NUMBER-LABEL-LINES GREATER THAN +0
 10912*            AND
 10913*        PI-BYPASS-LABELS
 10914*        MOVE W-DELETE-KEY       TO W-ARCT-KEY
 10915*        PERFORM 1060-DELETE-ADDRESS-RECORD THRU 1060-EXIT
 10916*        MOVE +0                 TO PI-689-NUMBER-LABEL-LINES.
 10917*
 10918*    SET PI-TOTAL-LINES          TO W-RG-NDX.
 10919*    MOVE 1                      TO PI-CURRENT-LINE.
 10920*    SET W-RG-NDX                TO +1.
 10921*
 10922*    PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 10923*            VARYING
 10924*        W-SC-NDX FROM 1 BY 1
 10925*            UNTIL
 10926*        W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 10927
 10928     MOVE -1                     TO MAINTL.
 10929     GO TO 8100-SEND-INITIAL-MAP.
 10930
 10931 1020-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 221
* EL689.cbl
 10932     EXIT.
 10933
 10934 1030-TEXT-BUILD.
 10935
 10936     SET W-RG-NDX UP BY 1.
 10937     MOVE LT-SKIP-CONTROL (LT-NDX)
 10938                                 TO W-PRINT-CONTROL.
 10939
 10940     IF  W-PRINT-CONTROL EQUAL 99
 10941         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 10942         SET W-RG-NDX UP BY 1
 10943     ELSE
 10944         SET W-RG-NDX UP BY W-PRINT-CONTROL.
 10945
 10946     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 10947     MOVE LT-SKIP-CONTROL (LT-NDX)
 10948                                 TO W-RC-PC (W-RG-NDX).
 10949     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 10950
 10951 1030-EXIT.
 10952     EXIT.
 10953
 10954 1040-FORMAT-HEADER-DATA.
 10955
 10956     MOVE LA-ACCOUNT-A2          TO ACCTO.
 10957     MOVE LA-ADDR-SOURCE         TO ADDRSO.
 10958     MOVE LA-CARRIER-A2          TO CARRIERO.
 10959     MOVE LA-CERT-NO-A2          TO CERTO.
 10960     MOVE LA-CERT-SUFFIX-A2      TO SFXO.
 10961     MOVE LA-DATA-SOURCE         TO DATASORO.
 10962
 10963     IF  LA-EFFECT-DATE-A2 EQUAL LOW-VALUES
 10964         MOVE ZEROES             TO DATEO
 10965
 10966     ELSE
 10967         MOVE LA-EFFECT-DATE-A2  TO DC-BIN-DATE-1
 10968         MOVE ' '                TO DC-OPTION-CODE
 10969         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10970         MOVE DC-GREG-DATE-1-EDIT
 10971                                 TO DATEO.
 10972
 10973     IF  LA-FOLLOW-UP-DATE EQUAL LOW-VALUES
 10974         MOVE ZEROES             TO FOLLOWO
 10975     ELSE
 10976         MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
 10977         MOVE ' '                TO DC-OPTION-CODE
 10978         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10979         MOVE DC-GREG-DATE-1-EDIT
 10980                                 TO FOLLOWO.
 10981
 10982     MOVE LA-FORM-A3             TO FORMO.
 10983     MOVE LA-GROUPING-A2         TO GROUPO.
 10984     MOVE LA-NO-OF-COPIES        TO COPIESO
 10985                                    PI-689-NUMBER-COPIES.
 10986
 10987*    IF LA-PRINT-RESTRICTION = 'C' OR 'F' OR 'P'
 10988*        MOVE LA-PRINT-RESTRICTION
 10989*                                TO PRTRESTO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 222
* EL689.cbl
 10990*    ELSE
 10991*        MOVE SPACES             TO PRTRESTO.
 10992
 10993     IF  LA-RESEND-DATE = LOW-VALUES
 10994         MOVE ZEROES             TO RESEND1O
 10995     ELSE
 10996         MOVE LA-RESEND-DATE     TO DC-BIN-DATE-1
 10997         MOVE ' '                TO DC-OPTION-CODE
 10998         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 10999         MOVE DC-GREG-DATE-1-EDIT
 11000                                 TO RESEND1O.
 11001
 11002     MOVE LA-STATE-A2            TO STATEO.
 11003
 11004     MOVE LA-NUMBER-LABEL-LINES  TO PI-689-NUMBER-LABEL-LINES.
 11005
 11006 1040-EXIT.
 11007     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 223
* EL689.cbl
 11009 1050-MOVE-LABELS.
 11010
 11011     SET W-RG-NDX                TO LT-NDX.
 11012     MOVE ZEROS                  TO W-RC-PC (W-RG-NDX).
 11013     MOVE SPACES                 TO W-RC-SC (W-RG-NDX).
 11014     MOVE LT-TEXT-LINE (LT-NDX)  TO W-RC-TEXT (W-RG-NDX).
 11015
 11016 1050-EXIT.
 11017     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 224
* EL689.cbl
 11019 1060-DELETE-ADDRESS-RECORD.
 11020
 11021
 11022* EXEC CICS DELETE
 11023*        DATASET (W-ARCT-FILE-ID)
 11024*        RIDFLD  (W-DELETE-KEY)
 11025*    END-EXEC.
 11026*    MOVE '&(  R                 &   #00010712' TO DFHEIV0
 11027     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
 11028     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11029     MOVE X'2020233030303130373132' TO DFHEIV0(25:11)
 11030     CALL 'kxdfhei1' USING DFHEIV0,
 11031           W-ARCT-FILE-ID,
 11032           W-DELETE-KEY,
 11033           DFHEIV99,
 11034           DFHEIV99,
 11035           DFHEIV99
 11036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11037
 11038
 11039
 11040* EXEC CICS READ
 11041*        DATASET (W-ARCH-FILE-ID)
 11042*        SET     (ADDRESS OF LETTER-ARCHIVE)
 11043*        RIDFLD  (W-ARCH-KEY)
 11044*        UPDATE
 11045*    END-EXEC.
 11046*    MOVE '&"S        EU         (   #00010717' TO DFHEIV0
 11047     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 11048     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 11049     MOVE X'2020233030303130373137' TO DFHEIV0(25:11)
 11050     CALL 'kxdfhei1' USING DFHEIV0,
 11051           W-ARCH-FILE-ID,
 11052           DFHEIV20,
 11053           DFHEIV99,
 11054           W-ARCH-KEY,
 11055           DFHEIV99,
 11056           DFHEIV99,
 11057           DFHEIV99
 11058     SET ADDRESS OF LETTER-ARCHIVE TO
 11059         DFHEIV20
 11060     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11061
 11062
 11063     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES.
 11064
 11065
 11066* EXEC CICS REWRITE
 11067*         FROM      (LETTER-ARCHIVE)
 11068*         DATASET   (W-ARCH-FILE-ID)
 11069*    END-EXEC.
 11070     MOVE LENGTH OF
 11071      LETTER-ARCHIVE
 11072       TO DFHEIV11
 11073*    MOVE '&& L                  %   #00010726' TO DFHEIV0
 11074     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 11075     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 11076     MOVE X'2020233030303130373236' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 225
* EL689.cbl
 11077     CALL 'kxdfhei1' USING DFHEIV0,
 11078           W-ARCH-FILE-ID,
 11079           LETTER-ARCHIVE,
 11080           DFHEIV11,
 11081           DFHEIV99
 11082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11083
 11084
 11085 1060-EXIT.
 11086     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 226
* EL689.cbl
 11088 1070-ARCH-NOT-FOUND.
 11089
 11090     MOVE ER-7371                TO EMI-ERROR.
 11091     MOVE -1                     TO ARCHNUML.
 11092     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11093     GO TO 8100-SEND-INITIAL-MAP.
 11094
 11095 1080-ARCHIVE-TEXT-NOT-FOUND.
 11096
 11097     MOVE ER-7372                TO EMI-ERROR.
 11098     MOVE -1                     TO ARCHNUML.
 11099     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11100     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 227
* EL689.cbl
 11102 2000-CREATE.
 11103***************************************************************
 11104*    THIS ROUTINE WILL CREATE A NEW LETTER BY READING THE     *
 11105*    TEXT FILE WITH THE FORM CODE SPECIFIED FROM THE SCREEN.  *
 11106*    ALL VARIABLE SYMBOLS WILL BE RESOLVED AND THE LETTER     *
 11107*    WILL BE DISPLAYED ON THE SCREEN.                         *
 11108*                                                             *
 11109***************************************************************
 11110
 11111***************************************************************
 11112*    CHECK TO SEE IF IT IS THE SAME REQUEST OR NOT.           *
 11113*    IF IT IS A NEW REQUEST AND A LETTER WAS PRINTED          *
 11114*    THEN FORCE AN ERROR.                                     *
 11115***************************************************************
 11116
 11117     IF  PI-689-CREATE-NO-SCREENS
 11118         GO TO 2000-GET-TEXT.
 11119
 11120     IF  PI-CREATE-MODE
 11121         IF  PI-689-PRINT-PERFORMED
 11122                 AND
 11123             FORMI NOT EQUAL 9999
 11124             MOVE ER-0279    TO EMI-ERROR
 11125             MOVE -1         TO MAINTL
 11126             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11127             GO TO 8200-SEND-DATAONLY.
 11128
 11129     IF  ARCHNUML GREATER THAN ZEROS
 11130         MOVE ER-9320            TO EMI-ERROR
 11131         MOVE -1                 TO ARCHNUML
 11132         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11133         GO TO 8200-SEND-DATAONLY.
 11134
 11135***************************************************************
 11136*    IF  A NEW LETTER IS BEING CREATED FROM SCRATCH, SAVE     *
 11137*    THE EXISTING SCREEN AND PASS CONTROL TO THE TEXT EDITOR  *
 11138***************************************************************
 11139
 11140     IF  FORMI EQUAL '9999'
 11141         MOVE 16                 TO PI-TOTAL-LINES
 11142         MOVE 1                  TO PI-CURRENT-LINE
 11143         MOVE SPACES             TO W-FILE-TABLE
 11144                                    W-LINE-CONTROL-RECORD
 11145                                    W-RECORD-TABLE
 11146                                    W-SINGLE-LINE
 11147                                    W-SQUEEZED-LINE
 11148                                    W-TS-WORK-AREA
 11149                                    W-TX-TABLE
 11150         PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 11151         MOVE '3'                TO PI-ACTION
 11152         MOVE FORMI              TO PI-689-FORM-NUMBER
 11153                                    PI-COMM-CONTROL
 11154         MOVE ZEROS              TO PI-UPDATE-SW
 11155         MOVE W-PGM-EL1042       TO W-CALL-PGM
 11156         GO TO 9400-XCTL.
 11157
 11158 2000-GET-TEXT.
 11159
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 228
* EL689.cbl
 11160     MOVE SPACES                 TO W-FILE-TABLE
 11161                                    W-LINE-CONTROL-RECORD
 11162                                    W-RECORD-TABLE
 11163                                    W-SINGLE-LINE
 11164                                    W-SQUEEZED-LINE
 11165                                    W-TS-WORK-AREA
 11166                                    W-TX-TABLE.
 11167     SET W-TG-NDX                TO +1
 11168     MOVE ZEROS                  TO W-INITIAL-COLUMN
 11169                                    W-LINE-COUNT
 11170                                    W-LINE-INDENT-1
 11171                                    W-LINE-INDENT-2
 11172                                    W-LINE-INDENT-3
 11173                                    W-LINE-INDENT-4
 11174                                    W-LINE-INDENT-5
 11175                                    W-PAGE
 11176                                    W-PARAGRAPH-INDENT
 11177                                    W-TOP-MARGIN
 11178                                    W-WORK-INDENT.
 11179     MOVE PI-LOWER-CASE-LETTERS  TO W-LC-CASE-IND.
 11180     MOVE +70                    TO W-LAST-COLUMN.
 11181     MOVE +56                    TO W-MAX-LINES-PER-PAGE.
 11182     MOVE +1                     TO W-START-COLUMN.
 11183     MOVE +71                    TO W-TOO-FAR.
 11184
 11185     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
 11186     MOVE FORMI                  TO W-TEXT-LETTER.
 11187     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
 11188     MOVE 'N'                    TO W-TEXT-BROWSED-SW.
 11189
 11190
 11191* EXEC CICS HANDLE CONDITION
 11192*         NOTFND     (2001-NOT-FOUND)
 11193*         ENDFILE    (2001-NOT-FOUND)
 11194*         NOTOPEN    (8050-TEXT-NOT-OPEN)
 11195*    END-EXEC.
 11196*    MOVE '"$I''J                 ! ) #00010836' TO DFHEIV0
 11197     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
 11198     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11199     MOVE X'2920233030303130383336' TO DFHEIV0(25:11)
 11200     CALL 'kxdfhei1' USING DFHEIV0
 11201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11202
 11203
 11204
 11205* EXEC CICS STARTBR
 11206*         DATASET    (W-TEXT-FILE-ID)
 11207*         RIDFLD     (W-TEXT-KEY)
 11208*         GTEQ
 11209*    END-EXEC.
 11210     MOVE 0
 11211       TO DFHEIV11
 11212*    MOVE '&,         G          &   #00010842' TO DFHEIV0
 11213     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 11214     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11215     MOVE X'2020233030303130383432' TO DFHEIV0(25:11)
 11216     CALL 'kxdfhei1' USING DFHEIV0,
 11217           W-TEXT-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 229
* EL689.cbl
 11218           W-TEXT-KEY,
 11219           DFHEIV99,
 11220           DFHEIV11,
 11221           DFHEIV99
 11222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11223
 11224
 11225
 11226* EXEC CICS HANDLE CONDITION
 11227*         ENDFILE    (2000-ENDBR)
 11228*    END-EXEC.
 11229*    MOVE '"$''                   ! * #00010848' TO DFHEIV0
 11230     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
 11231     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11232     MOVE X'2A20233030303130383438' TO DFHEIV0(25:11)
 11233     CALL 'kxdfhei1' USING DFHEIV0
 11234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11235
 11236
 11237 2000-READ-NEXT.
 11238
 11239     IF  W-TG-NDX GREATER THAN W-MAX-LINES
 11240         MOVE ER-0051            TO EMI-ERROR
 11241         MOVE -1                 TO MAINTL
 11242         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11243         GO TO 2000-ENDBR.
 11244
 11245
 11246* EXEC CICS READNEXT
 11247*         DATASET    (W-TEXT-FILE-ID)
 11248*         SET        (ADDRESS OF TEXT-FILES)
 11249*         RIDFLD     (W-TEXT-KEY)
 11250*    END-EXEC.
 11251     MOVE 0
 11252       TO DFHEIV11
 11253*    MOVE '&.S                   )   #00010860' TO DFHEIV0
 11254     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 11255     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 11256     MOVE X'2020233030303130383630' TO DFHEIV0(25:11)
 11257     CALL 'kxdfhei1' USING DFHEIV0,
 11258           W-TEXT-FILE-ID,
 11259           DFHEIV20,
 11260           DFHEIV99,
 11261           W-TEXT-KEY,
 11262           DFHEIV99,
 11263           DFHEIV11,
 11264           DFHEIV99,
 11265           DFHEIV99
 11266     SET ADDRESS OF TEXT-FILES TO
 11267         DFHEIV20
 11268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11269
 11270
 11271     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
 11272         GO TO 2000-ENDBR.
 11273
 11274     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
 11275
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 230
* EL689.cbl
 11276     MOVE TX-FORM-SQUEEZE-CONTROL
 11277                                 TO W-FORM-SQUEEZE-IND.
 11278
 11279     IF  PI-689-ARCHIVE-SW NOT GREATER THAN SPACES
 11280         MOVE TX-ARCHIVE-SW      TO PI-689-ARCHIVE-SW.
 11281
 11282     IF  TX-FORM-CONTROL-LINE
 11283         PERFORM 2100-PROCESS-FORM-CONTROL-LINE THRU 2100-EXIT
 11284         GO TO 2000-READ-NEXT.
 11285
 11286     IF  TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
 11287         PERFORM 2150-PROCESS-Z-CONTROLS THRU 2150-EXIT
 11288         GO TO 2000-READ-NEXT.
 11289
 11290     MOVE TX-TEXT-LINE           TO W-TX-TEXT (W-TG-NDX).
 11291     MOVE TX-PROCESS-CONTROL     TO W-TX-PC (W-TG-NDX).
 11292     PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT.
 11293     MOVE TX-LINE-SQUEEZE-CONTROL
 11294                                 TO W-TX-SC (W-TG-NDX).
 11295
 11296     SET W-TG-NDX UP BY 1.
 11297     GO TO 2000-READ-NEXT.
 11298
 11299 2000-ENDBR.
 11300
 11301
 11302* EXEC CICS ENDBR
 11303*        DATASET     (W-TEXT-FILE-ID)
 11304*    END-EXEC.
 11305     MOVE 0
 11306       TO DFHEIV11
 11307*    MOVE '&2                    $   #00010896' TO DFHEIV0
 11308     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 11309     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11310     MOVE X'2020233030303130383936' TO DFHEIV0(25:11)
 11311     CALL 'kxdfhei1' USING DFHEIV0,
 11312           W-TEXT-FILE-ID,
 11313           DFHEIV11,
 11314           DFHEIV99
 11315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11316
 11317
 11318     IF  W-TEXT-BROWSE-NOT-STARTED
 11319         MOVE ER-0006            TO EMI-ERROR
 11320         MOVE -1                 TO FORML
 11321         MOVE AL-UABON           TO FORMA
 11322         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11323         GO TO 8350-SEND-DATAONLY-ERASEAUP.
 11324
 11325     SET  W-TOTAL-TX-LINES       TO W-TG-NDX.
 11326     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
 11327     MOVE 1                      TO PI-CURRENT-LINE.
 11328
 11329     IF  COPIESL NOT GREATER THAN ZEROS
 11330         MOVE +1                 TO COPIESI
 11331                                    PI-689-NUMBER-COPIES
 11332         MOVE +1                 TO COPIESL
 11333         MOVE AL-UNNON           TO COPIESA.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 231
* EL689.cbl
 11334
 11335***************************************************************
 11336*    IF IT IS A FORM WITH VARIABLES, THEN RESOLVE ALL OF      *
 11337*    VARIABLE SYMBOLS AND INSERT THEM INTO THE TEXT DATA.     *
 11338***************************************************************
 11339
 11340     PERFORM 6000-RESOLVE-VARIABLES THRU 6000-EXIT.
 11341
 11342*    IF  PI-689-PRINT-RESTRICTION EQUAL 'C'
 11343*        IF  PI-689-CONTROL NOT GREATER THAN ZEROS
 11344*            MOVE ER-7243        TO EMI-ERROR
 11345*            MOVE -1             TO PRTRESTL
 11346*            MOVE AL-UABON       TO PRTRESTA
 11347*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11348
 11349     IF  PI-CREATE-LABELS AND
 11350         NOT  PI-689-LABELS-OVERRIDEN
 11351         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 11352         SET W-RG-NDX UP BY +1
 11353     ELSE
 11354         SET W-RG-NDX            TO +1.
 11355
 11356     MOVE W-TOP-FORM             TO W-RC-TEXT (W-RG-NDX).
 11357     SET W-RG-NDX UP BY W-TOP-MARGIN.
 11358
 11359     PERFORM 7400-CREATE-LETTER THRU 7400-EXIT.
 11360
 11361     SET PI-TOTAL-LINES          TO W-RG-NDX.
 11362
 11363     IF  W-FIRST-BAD-VARIABLE-FOUND
 11364         SET W-RG-NDX            TO W-FIRST-BAD-VARIABLE
 11365         MOVE W-FIRST-BAD-VARIABLE
 11366                                 TO PI-CURRENT-LINE
 11367     ELSE
 11368         SET W-RG-NDX            TO 1.
 11369
 11370     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11371             VARYING
 11372         W-SC-NDX FROM 1 BY 1
 11373             UNTIL
 11374         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11375     IF  PI-689-CREATE-NO-SCREENS
 11376         GO TO 2000-EXIT
 11377     ELSE
 11378         IF  W-FORM-CHANGED
 11379             MOVE '3'            TO PI-ACTION
 11380             MOVE -1             TO MAINTL
 11381             GO TO 8100-SEND-INITIAL-MAP
 11382         ELSE
 11383             MOVE '3'            TO PI-ACTION
 11384             MOVE -1             TO MAINTL
 11385             GO TO 8350-SEND-DATAONLY-ERASEAUP.
 11386
 11387 2000-EXIT.
 11388     EXIT.
 11389
 11390 2001-NOT-FOUND.
 11391
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 232
* EL689.cbl
 11392     MOVE ER-0006                TO EMI-ERROR.
 11393     MOVE -1                     TO FORML.
 11394     MOVE AL-UABON               TO FORMA.
 11395     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 11396     GO TO 8350-SEND-DATAONLY-ERASEAUP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 233
* EL689.cbl
 11398 2100-PROCESS-FORM-CONTROL-LINE.
 11399
 11400     MOVE TX-TEXT-LINE           TO W-LINE-CONTROL-RECORD.
 11401
 11402     IF  W-LC-LINE-WIDTH NUMERIC
 11403             AND
 11404         W-LC-LINE-WIDTH GREATER THAN ZEROS
 11405         COMPUTE W-INITIAL-COLUMN
 11406             = (70 - W-LC-LINE-WIDTH) / 2
 11407         COMPUTE W-START-COLUMN = W-INITIAL-COLUMN + 1
 11408         COMPUTE W-LAST-COLUMN ROUNDED
 11409             = W-INITIAL-COLUMN + W-LC-LINE-WIDTH
 11410         COMPUTE W-TOO-FAR = W-LAST-COLUMN + 1
 11411     ELSE
 11412         MOVE 70                 TO W-LC-LINE-WIDTH.
 11413
 11414     IF  W-LC-PARAGRAPH-INDENT NUMERIC
 11415             AND
 11416         W-LC-PARAGRAPH-INDENT GREATER THAN ZEROS
 11417         MOVE W-LC-PARAGRAPH-INDENT
 11418                                 TO W-PARAGRAPH-INDENT.
 11419
 11420     IF  W-LC-MAX-LINES-PER-PAGE NUMERIC
 11421             AND
 11422         W-LC-MAX-LINES-PER-PAGE GREATER THAN ZEROS
 11423         MOVE W-LC-MAX-LINES-PER-PAGE
 11424                                 TO W-MAX-LINES-PER-PAGE.
 11425
 11426     IF  W-LC-LINE-ADJUST NUMERIC
 11427             AND
 11428         W-LC-LINE-ADJUST GREATER THAN ZEROS
 11429         COMPUTE W-TOTAL-LINE-LENGTH
 11430             = W-LC-LINE-WIDTH + (W-LC-LINE-ADJUST * 2)
 11431         IF  W-TOTAL-LINE-LENGTH LESS THAN +71
 11432             ADD W-LC-LINE-ADJUST
 11433                                 TO W-INITIAL-COLUMN
 11434                                    W-LAST-COLUMN
 11435                                    W-START-COLUMN
 11436                                    W-TOO-FAR.
 11437
 11438     IF  W-LC-LINE-INDENT-1 NUMERIC
 11439             AND
 11440         W-LC-LINE-INDENT-1 LESS THAN W-LC-LINE-WIDTH
 11441         MOVE W-LC-LINE-INDENT-1 TO W-LINE-INDENT-1
 11442     ELSE
 11443         MOVE +0                 TO W-LINE-INDENT-1.
 11444
 11445     IF  W-LC-LINE-INDENT-2 NUMERIC
 11446             AND
 11447         W-LC-LINE-INDENT-2 LESS THAN W-LC-LINE-WIDTH
 11448         MOVE W-LC-LINE-INDENT-2 TO W-LINE-INDENT-2
 11449     ELSE
 11450         MOVE +0                 TO W-LINE-INDENT-2.
 11451
 11452     IF  W-LC-LINE-INDENT-3 NUMERIC
 11453             AND
 11454         W-LC-LINE-INDENT-3 LESS THAN W-LC-LINE-WIDTH
 11455         MOVE W-LC-LINE-INDENT-3 TO W-LINE-INDENT-3
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 234
* EL689.cbl
 11456     ELSE
 11457         MOVE +0                 TO W-LINE-INDENT-3.
 11458
 11459     IF  W-LC-LINE-INDENT-4 NUMERIC
 11460             AND
 11461         W-LC-LINE-INDENT-4 LESS THAN W-LC-LINE-WIDTH
 11462         MOVE W-LC-LINE-INDENT-4 TO W-LINE-INDENT-4
 11463     ELSE
 11464         MOVE +0                 TO W-LINE-INDENT-4.
 11465
 11466     IF  W-LC-LINE-INDENT-5 NUMERIC
 11467             AND
 11468         W-LC-LINE-INDENT-5 LESS THAN W-LC-LINE-WIDTH
 11469         MOVE W-LC-LINE-INDENT-5 TO W-LINE-INDENT-5
 11470
 11471     ELSE
 11472         MOVE +0                 TO W-LINE-INDENT-5.
 11473
 11474     IF  W-LC-TOP-MARGIN NUMERIC
 11475         MOVE W-LC-TOP-MARGIN    TO W-TOP-MARGIN
 11476     ELSE
 11477         MOVE +0                 TO W-TOP-MARGIN.
 11478
 11479     IF W-LC-CASE-IND = 'Y' OR 'N'
 11480         NEXT SENTENCE
 11481     ELSE
 11482         MOVE PI-LOWER-CASE-LETTERS
 11483                                 TO W-LC-CASE-IND.
 11484
 11485 2100-EXIT.
 11486     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 235
* EL689.cbl
 11488 2150-PROCESS-Z-CONTROLS.
 11489
 11490     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA.
 11491
 11492     IF PI-689-RESEND-DATE-1 = LOW-VALUES
 11493        IF W-DAYS-TO-RESEND NUMERIC
 11494           IF W-DAYS-TO-RESEND > ZEROS
 11495              MOVE '6'           TO DC-OPTION-CODE
 11496              MOVE W-SAVE-BIN-NEXT-BUS-DT
 11497                                 TO DC-BIN-DATE-1
 11498              MOVE ZEROS         TO DC-ELAPSED-MONTHS
 11499              MOVE W-DAYS-TO-RESEND
 11500                                 TO DC-ELAPSED-DAYS
 11501              PERFORM 9500-LINK-DATE-CONVERT
 11502                                 THRU 9500-EXIT
 11503              IF NO-CONVERSION-ERROR
 11504                 MOVE DC-BIN-DATE-2
 11505                                 TO PI-689-RESEND-DATE-1
 11506                 MOVE DC-GREG-DATE-1-EDIT
 11507                                 TO RESEND1O
 11508                                    PI-689-RESEND1-EDIT
 11509                 MOVE AL-UANON
 11510                                 TO RESEND1A
 11511                 MOVE +8         TO RESEND1L
 11512              ELSE
 11513                 MOVE ER-3770
 11514                                 TO EMI-ERROR
 11515                 MOVE -1         TO MAINTL
 11516                 PERFORM 9900-ERROR-FORMAT
 11517                                 THRU 9900-EXIT
 11518                 GO TO 8200-SEND-DATAONLY
 11519              END-IF
 11520           END-IF
 11521        END-IF
 11522     END-IF
 11523     IF W-FORM-TO-RESEND NOT = SPACES AND ZEROS
 11524        MOVE W-FORM-TO-RESEND    TO PI-689-RESEND-LETR-1
 11525     END-IF
 11526     IF  PI-689-FOLLOW-UP-DATE EQUAL LOW-VALUES
 11527         IF  W-DAYS-TO-FOLLOW-UP NUMERIC
 11528            IF  W-DAYS-TO-FOLLOW-UP >= ZEROS
 11529                 MOVE '6'        TO DC-OPTION-CODE
 11530                 MOVE W-SAVE-BIN-DATE
 11531                                 TO DC-BIN-DATE-1
 11532                 MOVE ZEROS      TO DC-ELAPSED-MONTHS
 11533                 MOVE W-DAYS-TO-FOLLOW-UP
 11534                                 TO DC-ELAPSED-DAYS
 11535                 PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 11536                 IF  NO-CONVERSION-ERROR
 11537                     MOVE DC-BIN-DATE-2
 11538                                 TO PI-689-FOLLOW-UP-DATE
 11539                     MOVE DC-GREG-DATE-1-EDIT
 11540                                 TO FOLLOWO
 11541                     MOVE AL-UANON
 11542                                 TO FOLLOWA
 11543                     MOVE +8     TO FOLLOWL
 11544                 ELSE
 11545                     MOVE ER-3771
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 236
* EL689.cbl
 11546                                 TO EMI-ERROR
 11547                     MOVE -1     TO MAINTL
 11548                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11549                     GO TO 8200-SEND-DATAONLY.
 11550
 11551     IF  COPIESI NOT NUMERIC
 11552             OR
 11553         COPIESI NOT GREATER THAN ZEROS
 11554         IF  W-NUMBER-OF-COPIES NUMERIC
 11555             IF  W-NUMBER-OF-COPIES GREATER THAN ZEROS
 11556                 MOVE W-NUMBER-OF-COPIES
 11557                                 TO COPIESI
 11558                                    PI-689-NUMBER-COPIES
 11559                 MOVE AL-UNNON   TO COPIESA
 11560                 MOVE +1         TO COPIESL
 11561             ELSE
 11562                 MOVE +1         TO COPIESI
 11563                                    PI-689-NUMBER-COPIES
 11564                 MOVE AL-UNNON   TO COPIESA
 11565                 MOVE +1         TO COPIESL
 11566         ELSE
 11567             MOVE +1             TO COPIESI
 11568                                    PI-689-NUMBER-COPIES
 11569             MOVE AL-UNNON       TO COPIESA
 11570             MOVE +1             TO COPIESL.
 11571
 11572     IF W-PROMPT-LETTER EQUAL 'Y'
 11573         MOVE 'Y'                TO PI-PROMPT-IND
 11574         MOVE ER-0894            TO EMI-ERROR
 11575         MOVE -1                 TO MAINTL
 11576         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11577     END-IF.
 11578
 11579     MOVE W-ENCLOSURE-CD                TO PI-ENCLOSURE-CD
 11580                                           ENCO
 11581     MOVE AL-UANON                      TO ENCA
 11582     MOVE +3                            TO ENCL
 11583
 11584     IF W-PRINT-CERTIFICATE = 'Y'
 11585        MOVE 'Y' TO PI-CERT-REQ-IND
 11586        IF CERTIDL > ZEROS
 11587            IF CERTIDI NUMERIC
 11588              MOVE AL-UANON      TO CERTIDA
 11589              MOVE CERTIDI       TO PI-CERT-FORM-ID
 11590            ELSE
 11591              MOVE ER-1778       TO EMI-ERROR
 11592              MOVE -1            TO CERTIDL
 11593              MOVE AL-UABON      TO CERTIDA
 11594              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11595           END-IF
 11596        ELSE
 11597              MOVE ER-0715       TO EMI-ERROR
 11598              MOVE -1            TO CERTIDL
 11599              MOVE AL-UABON      TO CERTIDA
 11600              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11601        END-IF
 11602     END-IF.
 11603
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 237
* EL689.cbl
 11604     IF W-REASONS-REQUIRED = 'Y'
 11605        MOVE 'Y' TO PI-REASON-REQ-IND
 11606        IF PI-ENDT-ARCH-NO NOT > ZERO
 11607          MOVE ER-9840       TO EMI-ERROR
 11608          MOVE -1            TO FORML
 11609          MOVE AL-UABON      TO FORMA
 11610          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11611        END-IF
 11612     END-IF.
 11613
 11614*    IF  PI-689-PRINT-RESTRICTION NOT = 'C' AND 'F' AND 'P' AND
 11615*                                       SPACES
 11616*        IF  W-PRINT-RESTRICTED
 11617*            MOVE W-PRINT-RESTRICTED-IND
 11618*                                TO PRTRESTI
 11619*                                   PI-689-PRINT-RESTRICTION
 11620*            MOVE AL-UANON       TO PRTRESTA
 11621*            MOVE +1             TO PRTRESTL.
 11622     .
 11623 2150-EXIT.
 11624     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 238
* EL689.cbl
 11626 2200-CHECK-FOR-VARIABLE.
 11627
 11628     IF  W-TX-TEXT (W-TG-NDX) EQUAL SPACES
 11629         GO TO 2200-EXIT.
 11630
 11631     SET W-TX-NDX                TO +1.
 11632
 11633 2200-CONTINUE.
 11634
 11635     SEARCH W-TX-CHAR
 11636         VARYING
 11637             W-TX-NDX
 11638         AT END
 11639             GO TO 2200-EXIT
 11640         WHEN
 11641             W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11642             NEXT SENTENCE.
 11643
 11644     SET W-TX-NDX UP BY +1.
 11645
 11646     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 11647         PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
 11648         GO TO 2200-CONTINUE.
 11649
 11650 2200-EXIT.
 11651     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 239
* EL689.cbl
 11653 2220-BUILD-VARIABLE-NUMBER.
 11654
 11655     SET W-TX-NDX UP BY +1.
 11656     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V1.
 11657     SET W-TX-NDX UP BY +1.
 11658     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V2.
 11659     SET W-TX-NDX UP BY +1.
 11660     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX) TO W-V3.
 11661
 11662     IF  W-VAR-RELATIVE-NUM NUMERIC
 11663         SET W-FILE-NDX TO W-VARIABLE-SOURCE (W-VAR-RELATIVE-NUM)
 11664         MOVE 'Y' TO W-FILE-USE-IND (W-FILE-NDX).
 11665
 11666 2220-EXIT.
 11667     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 240
* EL689.cbl
 11669 4000-ROLL-PAGE.
 11670
 11671     IF  ENTERPFL NOT EQUAL ZEROS
 11672         MOVE -1                 TO ENTERPFL
 11673     ELSE
 11674         MOVE -1                 TO MAINTL.
 11675
 11676     IF  PI-TOTAL-LINES EQUAL 0
 11677         MOVE ER-0047            TO EMI-ERROR
 11678         MOVE -1                 TO MAINTL
 11679         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11680         GO TO 8200-SEND-DATAONLY.
 11681
 11682     COMPUTE W-TEMP-CURRENT-LINE EQUAL
 11683         PI-CURRENT-LINE + W-ROLL-COUNTER.
 11684
 11685     IF  W-TEMP-CURRENT-LINE NEGATIVE
 11686             OR
 11687         W-TEMP-CURRENT-LINE EQUAL ZEROS
 11688         MOVE ER-0067            TO EMI-ERROR
 11689         MOVE -1                 TO MAINTL
 11690         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11691         MOVE 1                  TO W-TEMP-CURRENT-LINE.
 11692
 11693*    IF  W-TEMP-CURRENT-LINE GREATER THAN PI-TOTAL-LINES
 11694*            AND
 11695*        (EIBAID EQUAL DFHPF1 OR DFHPF6)
 11696*        MOVE ER-0066            TO EMI-ERROR
 11697*        MOVE -1                 TO MAINTL
 11698*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11699*        COMPUTE W-TEMP-CURRENT-LINE
 11700*            = PI-TOTAL-LINES + 1 - W-NUM-LINES-PER-SCREEN
 11701*        IF  W-TEMP-CURRENT-LINE NEGATIVE
 11702*                OR
 11703*            W-TEMP-CURRENT-LINE = ZEROS
 11704*            MOVE 1 TO W-TEMP-CURRENT-LINE.
 11705
 11706     IF  EMI-ERROR NOT EQUAL ER-0191
 11707             AND
 11708         MAINTI NOT EQUAL 'S'
 11709         PERFORM 7700-READ-TEXT-TS THRU 7700-EXIT
 11710         PERFORM 4100-SET-NDX THRU 4100-EXIT
 11711         PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11712                 VARYING
 11713             W-SC-NDX FROM 1 BY 1
 11714                 UNTIL
 11715             W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11716
 11717     IF  EMI-ERROR EQUAL ER-0066 OR ER-0067 OR ER-0000 OR
 11718                         ER-0191
 11719         NEXT SENTENCE
 11720     ELSE
 11721         GO TO 8200-SEND-DATAONLY.
 11722
 11723     MOVE W-TEMP-CURRENT-LINE    TO PI-CURRENT-LINE
 11724     SET W-RG-NDX                TO PI-CURRENT-LINE
 11725     MOVE LOW-VALUES             TO EL689RI
 11726*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 241
* EL689.cbl
 11727     PERFORM 7740-RESTORE-SCREEN THRU 7749-EXIT
 11728     SET W-RG-NDX                TO PI-CURRENT-LINE
 11729     PERFORM 7000-FORMAT-SCREEN THRU 7000-EXIT
 11730             VARYING
 11731         W-SC-NDX FROM 1 BY 1
 11732             UNTIL
 11733         W-SC-NDX GREATER W-NUM-LINES-PER-SCREEN.
 11734
 11735     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 242
* EL689.cbl
 11737 4100-SET-NDX.
 11738
 11739     IF  PI-CURRENT-LINE EQUAL 0
 11740         SET W-RG-NDX            TO 1
 11741     ELSE
 11742         SET W-RG-NDX            TO PI-CURRENT-LINE.
 11743
 11744 4100-EXIT.
 11745      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 243
* EL689.cbl
 11747 4200-UPDATE-TABLE-FROM-SCREEN.
 11748
 11749     IF  W-SC-TEXTL (W-SC-NDX) NOT EQUAL ZEROS
 11750         MOVE ZEROS              TO W-SC-TEXTL (W-SC-NDX)
 11751         IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 11752             IF  PI-TOTAL-LINES EQUAL W-MAX-LINES
 11753                 MOVE ER-0051    TO EMI-ERROR
 11754                 MOVE -1         TO MAINTL
 11755                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11756                 GO TO 8200-SEND-DATAONLY
 11757             ELSE
 11758                 MOVE W-SC-TEXT (W-SC-NDX)
 11759                                 TO W-RC-TEXT (W-RG-NDX)
 11760                 ADD 1           TO PI-TOTAL-LINES
 11761         ELSE
 11762             MOVE W-SC-TEXT (W-SC-NDX)
 11763                                 TO W-RC-TEXT (W-RG-NDX).
 11764
 11765     SET W-RG-NDX UP BY 1.
 11766
 11767 4200-EXIT.
 11768      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 244
* EL689.cbl
 11770
 11771
 11772 4500-CONNECT-TO-DB.
 11773
 11774     MOVE 'NTCSO2_LOGIC'         TO SVR
 11775     MOVE 'sa'                   TO USR
 11776     MOVE 'ntcso2'               TO PASS
 11777
 11778     STRING
 11779         USR DELIMITED SPACE
 11780         "." DELIMITED SIZE
 11781         PASS DELIMITED SPACE INTO USR-PASS
 11782     END-STRING
 11783
 11784     EXEC SQL
 11785        CONNECT TO :SVR USER :USR-PASS
 11786     END-EXEC
 11787
 11788     IF SQLCODE NOT = 0
 11789        DISPLAY "ERROR: CANNOT CONNECT "
 11790        DISPLAY SQLCODE
 11791        DISPLAY SQLERRMC
 11792        GO TO 4500-EXIT
 11793     END-IF
 11794
 11795     .
 11796 4500-EXIT.
 11797     EXIT.
 11798
 11799
 11800
 11801 4600-GET-NEXT-BUS-DT.
 11802
 11803     MOVE W-SAVE-EDIT-A-DATE     TO WS-CYCLE-DATE
 11804     MOVE SPACES                 TO WS-NEXT-BUS-DT
 11805
 11806     IF WS-KIXHOST = 'logictest'
 11807        EXEC SQL
 11808          CALL NaperTestCalcNextBusDt
 11809                        @cycledate = :WS-CYCLE-DATE,
 11810                        @nextbusdate = :WS-NEXT-BUS-DT OUT
 11811        END-EXEC
 11812     ELSE
 11813        EXEC SQL
 11814          CALL NaperProdCalcNextBusDt
 11815                        @cycledate = :WS-CYCLE-DATE,
 11816                        @nextbusdate = :WS-NEXT-BUS-DT OUT
 11817        END-EXEC
 11818     END-IF
 11819
 11820     IF SQLCODE NOT = 0
 11821        DISPLAY "ERROR: DID NOT RETURN NEXT BUS DT "
 11822        DISPLAY ' SQL RETURN CODE ' SQLCODE
 11823        DISPLAY ' SQL ERR MESS    ' SQLERRMC
 11824        GO TO 4600-EXIT
 11825     END-IF
 11826
 11827     .
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 245
* EL689.cbl
 11828 4600-EXIT.
 11829     EXIT.
 11830
 11831
 11832
 11833 4700-DISCONNECT.
 11834
 11835     EXEC SQL
 11836        DISCONNECT
 11837     END-EXEC
 11838     .
 11839 4700-EXIT.
 11840     EXIT.
 11841
 11842 5000-EDIT-MODE.
 11843***************************************************************
 11844*    THIS ROUTINE WILL SAVE A COPY OF THE EXISTING SCREEN     *
 11845*    AND THE W-TS-TABLE OF LETTER TEXT.  IT WILL THEN         *
 11846*    TRANSFER TO THE W-TEXT-EDITOR PROGRAM.                   *
 11847***************************************************************
 11848
 11849     IF  PI-SHOW-MODE
 11850         MOVE ER-0188            TO EMI-ERROR
 11851         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11852         MOVE -1                 TO MAINTL
 11853         MOVE AL-UABON           TO MAINTA
 11854         GO TO 8200-SEND-DATAONLY.
 11855
 11856     IF  PI-CURRENT-LINE EQUAL ZEROS
 11857         MOVE ER-0187            TO EMI-ERROR
 11858         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11859         MOVE -1                 TO MAINTL
 11860         GO TO 8200-SEND-DATAONLY.
 11861
 11862     PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11863     PERFORM 4100-SET-NDX THRU 4100-EXIT.
 11864     PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11865             VARYING
 11866         W-SC-NDX FROM 1 BY 1
 11867             UNTIL
 11868         W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 11869
 11870     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 11871
 11872     MOVE PI-689-FORM-NUMBER     TO PI-COMM-CONTROL.
 11873     MOVE ZEROS                  TO PI-UPDATE-SW.
 11874     MOVE '1'                    TO PI-ENTRY-CD-1.
 11875     MOVE W-PGM-EL1042           TO W-CALL-PGM.
 11876     GO TO 9400-XCTL.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 246
* EL689.cbl
 11878 5400-LETTER-RELEASE.
 11879***************************************************************
 11880*    THIS ROUTINE WILL BE USED WHEN THE LETTER HAS BEEN       *
 11881*    COMPLETED AND IS TO BE PUT AS PERMANENT RECORDS IN       *
 11882*    THE ARCHIVE FILE.                                        *
 11883*    THE FUNCTIONS BELOW WILL BE PERFORMED.                   *
 11884*        1. CHECK SECURITY.                                   *
 11885*        2. MAKE SURE THERE ARE NO UNRESOLVED SYMBOLS.        *
 11886*        3. GET THE ARCHIVE NUMBER FROM THE CONTROL FILE.     *
 11887*        4. WRITE THE NEW ARCHIVE RECORDS FROM W-TS-TABLE.    *
 11888*        5. RESET INSURED'S CONTROL FIELDS AND RETURN THE     *
 11889*           ARCHIVE NUMBER USED  TO FILE THE RECORDS.         *
 11890***************************************************************
 11891
 11892     IF  NOT MODIFY-CAP
 11893         MOVE ER-0070            TO EMI-ERROR
 11894         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11895         MOVE -1                 TO MAINTL
 11896         GO TO 8200-SEND-DATAONLY.
 11897
 11898     IF  PI-SHOW-MODE
 11899         MOVE ER-0188            TO EMI-ERROR
 11900         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11901         MOVE -1                 TO MAINTL
 11902         MOVE AL-UABON           TO MAINTA
 11903         GO TO 8200-SEND-DATAONLY.
 11904
 11905      IF  ARCHNUML GREATER THAN ZEROS
 11906          MOVE ER-9320            TO EMI-ERROR
 11907          MOVE -1                 TO ARCHNUML
 11908          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11909          GO TO 8200-SEND-DATAONLY.
 11910
 11911*     IF  PI-CURRENT-LINE EQUAL ZEROS
 11912*        MOVE ER-0187            TO EMI-ERROR
 11913*        MOVE -1                 TO MAINTL
 11914*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 11915*        GO TO 8200-SEND-DATAONLY.
 11916
 11917*    PERFORM 7700-READ-TEXT-TS   THRU 7700-EXIT
 11918*
 11919*    IF  NOT PI-689-CREATE-NO-SCREENS
 11920*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 11921*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 11922*                VARYING
 11923*            W-SC-NDX FROM 1 BY 1
 11924*                UNTIL
 11925*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 11926*        IF  EMI-FATAL-CTR GREATER THAN ZEROS
 11927*                OR
 11928*            PI-689-FATAL-ERROR
 11929*            GO TO 8200-SEND-DATAONLY.
 11930*
 11931*    MOVE SPACES                 TO W-REMAINING-VAR-SW.
 11932*    PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 11933*            VARYING
 11934*        W-RVS-NDX FROM +1 BY +1
 11935*            UNTIL
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 247
* EL689.cbl
 11936*        W-RVS-NDX > +36500
 11937*            OR
 11938*        W-REMAINING-VAR-FOUND.
 11939*
 11940*    IF  NOT PI-689-CREATE-NO-SCREENS
 11941*        IF  W-REMAINING-VAR-FOUND
 11942*            GO TO 4000-ROLL-PAGE.
 11943
 11944*    MOVE SPACES                 TO W-CNTL-KEY.
 11945*    MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 11946*    MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 11947*    MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 11948*
 11949*    EXEC CICS HANDLE CONDITION
 11950*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 11951*         NOTFND     (5470-CNTL-NOT-FOUND)
 11952*    END-EXEC.
 11953*
 11954*    EXEC CICS READ
 11955*         DATASET    (W-CNTL-FILE-ID)
 11956*         SET        (ADDRESS OF CONTROL-FILE)
 11957*         RIDFLD     (W-CNTL-KEY)
 11958*         UPDATE
 11959*    END-EXEC.
 11960*
 11961*    IF  CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
 11962*        MOVE ZEROS              TO CF-CREDIT-LAST-ARCH-NUM
 11963*                                   CF-CREDIT-START-ARCH-NUM.
 11964*
 11965*    ADD 1                       TO CF-CREDIT-LAST-ARCH-NUM.
 11966*    MOVE CF-CREDIT-LAST-ARCH-NUM
 11967*                                TO W-ARCH-NUMBER
 11968*                                   W-ARCT-NUMBER.
 11969*
 11970*    EXEC CICS REWRITE
 11971*         FROM      (CONTROL-FILE)
 11972*         DATASET   (W-CNTL-FILE-ID)
 11973*    END-EXEC
 11974
 11975*    EXEC CICS HANDLE CONDITION
 11976*         NOTOPEN   (8010-ARCH-NOT-OPEN)
 11977*    END-EXEC.
 11978*
 11979*    EXEC CICS GETMAIN
 11980*       SET      (ADDRESS OF LETTER-ARCHIVE)
 11981*       LENGTH   (W-ARCH-LENGTH)
 11982*    END-EXEC
 11983*
 11984*    MOVE SPACES                 TO LETTER-ARCHIVE
 11985*    MOVE 'LA'                   TO LA-RECORD-ID.
 11986*    MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
 11987*                                   LA-ARCHIVE-NO-A2
 11988*                                   LA-ARCHIVE-NO-A3
 11989*                                   LA-ARCHIVE-NO-A4
 11990*                                   LA-ARCHIVE-NO-A5
 11991*                                   LA-ARCHIVE-NO-A6
 11992*                                   PI-689-ARCHIVE-NUMBER.
 11993*    MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 248
* EL689.cbl
 11994*                                   LA-COMPANY-CD-A2
 11995*                                   LA-COMPANY-CD-A3
 11996*                                   LA-COMPANY-CD-A4
 11997*                                   LA-COMPANY-CD-A5
 11998*                                   LA-COMPANY-CD-A6.
 11999*    MOVE PI-689-CARRIER         TO LA-CARRIER-A2
 12000*                                   LA-CARRIER-A3
 12001*                                   LA-CARRIER-A4
 12002*                                   LA-CARRIER-A5.
 12003*    MOVE PI-689-EFF-DATE        TO LA-EFFECT-DATE-A2.
 12004*    MOVE PI-689-GROUPING        TO LA-GROUPING-A2
 12005*                                   LA-GROUPING-A3
 12006*                                   LA-GROUPING-A4
 12007*                                   LA-GROUPING-A5.
 12008*    MOVE PI-689-ACCOUNT         TO LA-ACCOUNT-A2
 12009*                                   LA-ACCOUNT-A3
 12010*                                   LA-ACCOUNT-A4
 12011*                                   LA-ACCOUNT-A5.
 12012*    MOVE PI-689-STATE           TO LA-STATE-A2
 12013*                                   LA-STATE-A3
 12014*                                   LA-STATE-A4
 12015*                                   LA-STATE-A5.
 12016*
 12017*    IF  PI-689-DATA-SOURCE EQUAL '3'
 12018*            AND
 12019*        PI-689-RESP-PERSON GREATER THAN SPACES
 12020*        MOVE PI-689-RESP-PERSON
 12021*                                TO LA-RESP-PERSON-A2
 12022*        MOVE PI-689-TYPE        TO LA-TYPE-A2
 12023*    ELSE
 12024*        IF  PI-689-CERT-PRIME GREATER THAN SPACES
 12025*            MOVE PI-689-CERT-PRIME
 12026*                                TO LA-CERT-PRIME-A2
 12027*            MOVE PI-689-CERT-SFX
 12028*                                TO LA-CERT-SUFFIX-A2
 12029*        ELSE
 12030*            MOVE LOW-VALUE      TO LA-RESP-PERSON-A2
 12031*                                   LA-TYPE-A2.
 12032*
 12033*    IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 12034*        MOVE PI-689-ENTRY-BATCH TO LA-ENTRY-A6
 12035*        IF  PI-689-CONTROL GREATER THAN ZEROS
 12036*                AND
 12037*            PI-689-PRINT-RESTRICTION EQUAL 'C'
 12038*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 12039*            MOVE 'CK'           TO LA-FILLER
 12040*        ELSE
 12041*            NEXT SENTENCE
 12042*    ELSE
 12043*        IF  PI-689-CONTROL GREATER THAN ZEROS
 12044*            MOVE PI-689-CONTROL TO LA-QUE-CONTROL-A6
 12045*            MOVE 'CK'           TO LA-FILLER
 12046*        ELSE
 12047*            MOVE LOW-VALUES     TO LA-ENTRY-A6.
 12048*
 12049*    MOVE ZEROS                  TO W-SEQ-CTR.
 12050*
 12051*    MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 249
* EL689.cbl
 12052*
 12053*    MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
 12054*                                   LA-INITIAL-PRINT-DATE
 12055*                                   LA-SENT-DATE
 12056*                                   LA-REPLY-DATE.
 12057*    MOVE 'A'                    TO LA-STATUS.
 12058*
 12059*    IF  PI-689-NUMBER-COPIES NOT NUMERIC
 12060*            OR
 12061*        PI-689-NUMBER-COPIES EQUAL ZEROS
 12062*        MOVE  1                 TO LA-NO-OF-COPIES
 12063*    ELSE
 12064*        MOVE PI-689-NUMBER-COPIES
 12065*                                TO LA-NO-OF-COPIES.
 12066*
 12067*    MOVE PI-689-FORM-NUMBER     TO LA-FORM-A3.
 12068*    MOVE PI-689-FOLLOW-UP-DATE  TO LA-FOLLOW-UP-DATE.
 12069*    MOVE PI-689-PRINT-RESTRICTION
 12070*                                TO LA-PRINT-RESTRICTION
 12071*    MOVE PI-689-LABEL-SOURCE    TO LA-ADDR-SOURCE.
 12072*    MOVE PI-689-DATA-SOURCE     TO LA-DATA-SOURCE.
 12073*    MOVE PI-689-RESEND-DATE-1   TO LA-RESEND-DATE
 12074*    MOVE PI-689-RESEND-LETR-1   TO LA-RESEND-LETR
 12075*    MOVE W-CURRENT-SAVE         TO LA-CREATION-DATE.
 12076*
 12077*    IF  PI-689-PRINT-PERFORMED
 12078*        MOVE SPACES             TO PI-689-PRINT-SW
 12079*        MOVE W-CURRENT-SAVE     TO LA-INITIAL-PRINT-DATE
 12080*        IF  LA-RESEND-DATE = LOW-VALUES
 12081*            MOVE 'C'            TO LA-STATUS.
 12082*
 12083*    MOVE PI-689-NUMBER-LABEL-LINES
 12084*                                TO LA-NUMBER-LABEL-LINES.
 12085*    MOVE ZEROS                  TO PI-689-NUMBER-TEXT-RECORDS.
 12086*
 12087*    PERFORM 5410-CREATE-TEXT-RECORDS THRU 5410-EXIT.
 12088*
 12089*    MOVE PI-689-NUMBER-TEXT-RECORDS
 12090*    MOVE ZEROS                  TO LA-NO-OF-TEXT-RECORDS.
 12091*
 12092*    EXEC CICS HANDLE CONDITION
 12093*        DUPREC    (5460-DUPLICATE-ARCHIVE-RCD)
 12094*    END-EXEC.
 12095*
 12096*    PERFORM 5650-WRITE-ARCHIVE THRU 5650-EXIT.
 12097*    MOVE ER-0280                TO EMI-ERROR.
 12098*    MOVE -1                     TO MAINTL.
 12099*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12100*    MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 12101*    MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1).
 12102     .
 12103 5400-END.
 12104     DISPLAY ' MADE IT TO 5400 '
 12105     MOVE SPACES                 TO BL-INPUT
 12106     MOVE ZEROS                  TO BL-ARCHIVE-NO
 12107     MOVE PI-689-DATA-SOURCE     TO BL-DATA-SRCE
 12108     MOVE PI-689-CARRIER         TO BL-CARRIER
 12109     MOVE PI-689-GROUPING        TO BL-GROUP
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 250
* EL689.cbl
 12110     MOVE PI-689-STATE           TO BL-STATE
 12111     MOVE PI-689-ACCOUNT         TO BL-ACCOUNT
 12112     IF PI-689-EFF-DATE NOT = LOW-VALUES
 12113        MOVE PI-689-EFF-DATE     TO DC-BIN-DATE-1
 12114        MOVE ' '                 TO DC-OPTION-CODE
 12115        PERFORM 9500-LINK-DATE-CONVERT
 12116                                 THRU 9500-EXIT
 12117        IF NO-CONVERSION-ERROR
 12118           MOVE DC-GREG-DATE-1-EDIT
 12119                                 TO BL-EFF-DT
 12120        END-IF
 12121     END-IF
 12122     MOVE PI-689-CERT-NO         TO BL-CERT-NO
 12123     MOVE PI-689-ENTRY-BATCH     TO BL-BATCH-NO
 12124     MOVE PI-689-SEQ-NO          TO BL-BATCH-SEQ
 12125     MOVE PI-689-RESP-PERSON     TO BL-RESP-NO
 12126     MOVE PI-689-FORM-NUMBER     TO BL-LETTER-ID
 12127     MOVE PI-689-NUMBER-COPIES   TO BL-NO-OF-COPIES
 12128     IF PI-ENDT-ARCH-NO > ZERO
 12129         MOVE PI-ENDT-ARCH-NO    TO BL-ENDT-ARCH-NO
 12130     END-IF
 12131     MOVE 'LETTER  '             TO BL-SOURCE-SCREEN
 12132     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
 12133*    MOVE 'ALWA'                 TO BL-PROC-ID
 12134     MOVE PI-COMPANY-ID          TO BL-COMP-ID
 12135*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
 12136     MOVE PI-ENCLOSURE-CD        TO BL-ENC-CD
 12137     IF PI-689-RESEND-DATE-1 NOT = LOW-VALUES
 12138        MOVE PI-689-RESEND-DATE-1 TO DC-BIN-DATE-1
 12139        MOVE ' '                 TO DC-OPTION-CODE
 12140        PERFORM 9500-LINK-DATE-CONVERT
 12141                                 THRU 9500-EXIT
 12142        IF NO-CONVERSION-ERROR
 12143           MOVE DC-GREG-DATE-B-EDIT
 12144                                 TO BL-RESEND-DT
 12145        END-IF
 12146     END-IF
 12147     IF PI-689-FOLLOW-UP-DATE NOT = LOW-VALUES
 12148        MOVE PI-689-FOLLOW-UP-DATE TO DC-BIN-DATE-1
 12149        MOVE ' '                 TO DC-OPTION-CODE
 12150        PERFORM 9500-LINK-DATE-CONVERT
 12151                                 THRU 9500-EXIT
 12152        IF NO-CONVERSION-ERROR
 12153           MOVE DC-GREG-DATE-B-EDIT
 12154                                 TO BL-FOLLOW-UP-DT
 12155        END-IF
 12156     END-IF
 12157*    MOVE IFF-COMMENTS           TO BL-COMMENTS
 12158*    MOVE 'TEST COMMENTS'        TO BL-COMMENTS
 12159     MOVE PI-CERT-FORM-ID        TO BL-CERT-FORM-ID
 12160     if eibaid = dfhpf7
 12161        move 'B'                 TO BL-WRITE-ERARCH
 12162     else
 12163        move 'T'                 to bl-write-erarch
 12164     end-if
 12165    DISPLAY ' ABOUT TO LINK TO NSRASBL '
 12166*****************************************
 12167* Invoke the LETTER business logic
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 251
* EL689.cbl
 12168*****************************************
 12169
 12170* exec cics link
 12171*       program('NSRASBL')
 12172*       commarea(srch-commarea)
 12173*    end-exec.
 12174     MOVE LENGTH OF
 12175      srch-commarea
 12176       TO DFHEIV11
 12177     MOVE 'NSRASBL' TO DFHEIV1
 12178*    MOVE '."C                   (   #00011751' TO DFHEIV0
 12179     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 12180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12181     MOVE X'2020233030303131373531' TO DFHEIV0(25:11)
 12182     CALL 'kxdfhei1' USING DFHEIV0,
 12183           DFHEIV1,
 12184           srch-commarea,
 12185           DFHEIV11,
 12186           DFHEIV99,
 12187           DFHEIV99,
 12188           DFHEIV99,
 12189           DFHEIV99
 12190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12191
 12192     DISPLAY ' MADE IT BACK FROM NSRASBL ' bl-status ' '
 12193        bl-message ' ' bl-archive-no
 12194     move bl-archive-no to w-arch-number
 12195
 12196     if eibaid = dfhpf7
 12197        PERFORM 5440-ADD-BILLING-NOTE THRU 5440-EXIT
 12198        MOVE ER-0280                TO EMI-ERROR
 12199        MOVE -1                     TO MAINTL
 12200        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12201        MOVE W-ARCH-NUMBER          TO W-ARCH-SUPPRESS
 12202        MOVE W-ARCH-EDIT            TO EMI-TEXT-VARIABLE (1)
 12203        MOVE '2'                    TO PI-ACTION
 12204        MOVE ZEROS                  TO PI-TOTAL-LINES
 12205                                       PI-CURRENT-LINE
 12206        MOVE SPACES                 TO PI-689-PRINT-SW
 12207                                       PI-689-FORM-NUMBER
 12208        GO TO 9300-DFHCLEAR
 12209     else
 12210        move w-arch-number          to archnumo
 12211        MOVE ER-1818                TO EMI-ERROR
 12212        MOVE -1                     TO MAINTL
 12213        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 12214     end-if
 12215     MOVE -1                     TO MAINTL
 12216     GO TO 8200-SEND-DATAONLY
 12217     .
 12218 5400-EXIT.
 12219     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 252
* EL689.cbl
 12221 5410-CREATE-TEXT-RECORDS.
 12222
 12223*    EXEC CICS HANDLE CONDITION
 12224*         NOTOPEN   (8015-ARCT-NOT-OPEN)
 12225*         DUPREC    (5465-DUPLICATE-ARCH-TEXT)
 12226*    END-EXEC.
 12227*
 12228*    IF  PI-689-CREATE-NO-SCREENS
 12229*        IF  PI-689-GET-ARCT-MAIN
 12230*            EXEC CICS GETMAIN
 12231*                 SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 12232*                 LENGTH   (W-ARCT-LENGTH)
 12233*            END-EXEC
 12234*            SET LCP-WS-ADDR-PNTR TO ADDRESS OF
 12235*                                    LETTER-ARCHIVE-TEXT
 12236*            MOVE LCP-WS-ADDR-COMP
 12237*                                TO PI-689-ARCT-POINTER
 12238*        ELSE
 12239*            MOVE PI-689-ARCT-POINTER
 12240*                                TO LCP-WS-ADDR-COMP
 12241*            SET ADDRESS OF LETTER-ARCHIVE-TEXT
 12242*                                TO LCP-WS-ADDR-PNTR
 12243*    ELSE
 12244*        EXEC CICS GETMAIN
 12245*             SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
 12246*             LENGTH   (W-ARCT-LENGTH)
 12247*        END-EXEC.
 12248*
 12249*    PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 12250*
 12251*    MOVE ZEROS                  TO W-SEQ-CTR
 12252*
 12253*    IF  PI-CREATE-LABELS AND
 12254*        NOT PI-689-LABELS-OVERRIDEN
 12255*        MOVE '1'                TO LT-RECORD-TYPE
 12256*        MOVE +0                 TO LT-LINE-SEQ-NO
 12257*        PERFORM 5600-FORMAT-ADDRESS-LINE THRU 5600-EXIT
 12258*                VARYING
 12259*            W-RG-NDX FROM 1 BY 1
 12260*                UNTIL
 12261*            W-RG-NDX GREATER THAN PI-689-NUMBER-LABEL-LINES
 12262*        PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12263*        PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT
 12264*    ELSE
 12265*        SET W-RG-NDX            TO +1.
 12266*
 12267*    SET LT-NDX                  TO W-ZEROS.
 12268*
 12269*    PERFORM 5500-FORMAT-TEXT THRU 5500-EXIT
 12270*            VARYING
 12271*        W-RG-NDX FROM W-RG-NDX BY +1
 12272*            UNTIL
 12273*        W-RG-NDX GREATER THAN PI-TOTAL-LINES.
 12274
 12275 5410-EXIT.
 12276     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 253
* EL689.cbl
 12278 5415-INITIALIZE-TEXT.
 12279
 12280     MOVE SPACES                 TO LETTER-ARCHIVE-TEXT.
 12281     MOVE 'LT'                   TO LT-RECORD-ID.
 12282
 12283     MOVE LA-ARCHIVE-NO          TO LT-ARCHIVE-NO.
 12284     MOVE PI-COMPANY-CD          TO LT-COMPANY-CD.
 12285
 12286     MOVE ZEROS                  TO LT-LINE-SEQ-NO
 12287                                    LT-NUM-LINES-ON-RECORD.
 12288
 12289 5415-EXIT.
 12290     EXIT.
 12291
 12292 5440-ADD-BILLING-NOTE.
 12293
 12294     MOVE LOW-VALUES             TO W-ELEOBC-KEY
 12295     MOVE PI-COMPANY-CD          TO W-EOBC-COMPANY-CD
 12296     MOVE '5'                    TO W-EOBC-REC-TYPE
 12297
 12298
 12299* EXEC CICS STARTBR
 12300*        DATASET   ('ELEOBC')
 12301*        RIDFLD    (W-ELEOBC-KEY)
 12302*        GTEQ
 12303*        RESP      (W-RESPONSE)
 12304*    END-EXEC
 12305     MOVE 'ELEOBC' TO DFHEIV1
 12306     MOVE 0
 12307       TO DFHEIV11
 12308*    MOVE '&,         G          &  N#00011861' TO DFHEIV0
 12309     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 12310     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 12311     MOVE X'204E233030303131383631' TO DFHEIV0(25:11)
 12312     CALL 'kxdfhei1' USING DFHEIV0,
 12313           DFHEIV1,
 12314           W-ELEOBC-KEY,
 12315           DFHEIV99,
 12316           DFHEIV11,
 12317           DFHEIV99
 12318     MOVE EIBRESP  TO W-RESPONSE
 12319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12320
 12321     IF NOT RESP-NORMAL
 12322        GO TO 5440-EXIT
 12323     END-IF
 12324      .
 12325 5440-READNEXT-ELEOBC.
 12326
 12327
 12328* EXEC CICS READNEXT
 12329*       INTO    (EOB-CODES)
 12330*       DATASET ('ELEOBC')
 12331*       RIDFLD  (W-ELEOBC-KEY)
 12332*       RESP    (W-RESPONSE)
 12333*    END-EXEC
 12334     MOVE LENGTH OF
 12335      EOB-CODES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 254
* EL689.cbl
 12336       TO DFHEIV12
 12337     MOVE 'ELEOBC' TO DFHEIV1
 12338     MOVE 0
 12339       TO DFHEIV11
 12340*    MOVE '&.IL                  )  N#00011874' TO DFHEIV0
 12341     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
 12342     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 12343     MOVE X'204E233030303131383734' TO DFHEIV0(25:11)
 12344     CALL 'kxdfhei1' USING DFHEIV0,
 12345           DFHEIV1,
 12346           EOB-CODES,
 12347           DFHEIV12,
 12348           W-ELEOBC-KEY,
 12349           DFHEIV99,
 12350           DFHEIV11,
 12351           DFHEIV99,
 12352           DFHEIV99
 12353     MOVE EIBRESP  TO W-RESPONSE
 12354     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12355
 12356     IF RESP-NORMAL
 12357         IF EO-RECORD-TYPE NOT = '5'
 12358             GO TO 5440-EXIT
 12359         END-IF
 12360     ELSE
 12361         GO TO 5440-EXIT
 12362     END-IF
 12363
 12364     IF EO-RECORD-TYPE = '5' AND
 12365        EO-EOB-CODE = PI-689-FORM-NUMBER
 12366           CONTINUE
 12367     ELSE
 12368         GO TO 5440-READNEXT-ELEOBC
 12369     END-IF
 12370
 12371     MOVE SPACES TO W-BILLING-NOTE
 12372     MOVE EO-DESCRIPTION TO W-BN-NOTE
 12373     MOVE PI-689-FORM-NUMBER TO W-BN-LTRID
 12374     MOVE W-SAVE-DATE TO W-BN-DATE
 12375     MOVE PI-PROCESSOR-ID TO W-BN-USERID
 12376     MOVE +25 TO W-LEN
 12377
 12378     PERFORM 5441-UPDATE-BILLING-NOTE THRU 5441-EXIT
 12379     .
 12380 5440-EXIT.
 12381     EXIT.
 12382
 12383 5441-UPDATE-BILLING-NOTE.
 12384
 12385     MOVE PI-COMPANY-CD          TO W-SV-COMPANY-CD
 12386     MOVE PI-689-CARRIER         TO W-SV-CARRIER
 12387     MOVE PI-689-GROUPING        TO W-SV-GROUPING
 12388     MOVE PI-689-STATE           TO W-SV-STATE
 12389     MOVE PI-689-ACCOUNT         TO W-SV-ACCOUNT
 12390     MOVE PI-689-EFF-DATE        TO W-SV-CERT-EFF-DT
 12391     MOVE PI-689-CERT-PRIME      TO W-SV-CERT-PRIME
 12392     MOVE PI-689-CERT-SFX        TO W-SV-CERT-SFX
 12393     MOVE W-SAVE-KEY             TO W-ERNOTE-KEY
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 255
* EL689.cbl
 12394     if pi-iss-can-pend-rec = '2'
 12395        move '2'              to cn-record-type
 12396     else
 12397        move '1'              to cn-record-type
 12398     end-if
 12399     move cn-record-type      to w-note-record-type
 12400
 12401
 12402* EXEC CICS READ
 12403*       DATASET    (W-NOTE-FILE-ID)
 12404*       RIDFLD     (W-ERNOTE-KEY)
 12405*       INTO       (CERTIFICATE-NOTE)
 12406*       RESP       (W-RESPONSE)
 12407*       UPDATE
 12408*    END-EXEC
 12409     MOVE LENGTH OF
 12410      CERTIFICATE-NOTE
 12411       TO DFHEIV11
 12412*    MOVE '&"IL       EU         (  N#00011926' TO DFHEIV0
 12413     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
 12414     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12415     MOVE X'204E233030303131393236' TO DFHEIV0(25:11)
 12416     CALL 'kxdfhei1' USING DFHEIV0,
 12417           W-NOTE-FILE-ID,
 12418           CERTIFICATE-NOTE,
 12419           DFHEIV11,
 12420           W-ERNOTE-KEY,
 12421           DFHEIV99,
 12422           DFHEIV99,
 12423           DFHEIV99
 12424     MOVE EIBRESP  TO W-RESPONSE
 12425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12426
 12427     IF RESP-NORMAL
 12428       IF CN-BILLING-START-LINE-NO NOT NUMERIC
 12429          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
 12430       END-IF
 12431       IF CN-BILLING-END-LINE-NO NOT NUMERIC
 12432          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
 12433       END-IF
 12434       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 12435           (NOTE-SUB > +10) OR
 12436           (CN-LINE (NOTE-SUB) (1:W-LEN) =
 12437                             W-BILLING-NOTE (1:W-LEN))
 12438       END-PERFORM
 12439       IF CN-LINE (NOTE-SUB) (1:W-LEN) =
 12440                              W-BILLING-NOTE (1:W-LEN)
 12441
 12442* EXEC CICS UNLOCK
 12443*           DATASET    (W-NOTE-FILE-ID)
 12444*        END-EXEC
 12445*    MOVE '&*                    #   #00011948' TO DFHEIV0
 12446     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12447     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12448     MOVE X'2020233030303131393438' TO DFHEIV0(25:11)
 12449     CALL 'kxdfhei1' USING DFHEIV0,
 12450           W-NOTE-FILE-ID,
 12451           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 256
* EL689.cbl
 12452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12453       ELSE
 12454         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
 12455           (NOTE-SUB > +10) OR
 12456           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
 12457         END-PERFORM
 12458         IF (NOTE-SUB < +11)
 12459           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
 12460              NOTE-SUB <= CN-BILLING-END-LINE-NO
 12461                MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 12462           ELSE
 12463             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
 12464              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
 12465                MOVE W-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
 12466                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
 12467             ELSE
 12468               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
 12469                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
 12470                     MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB)
 12471                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
 12472               ELSE
 12473                 IF (CN-BILLING-END-LINE-NO = ZEROS)
 12474                   MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
 12475                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
 12476                                       CN-BILLING-START-LINE-NO
 12477                 ELSE
 12478                    PERFORM 5442-SQUEEZE-IT-IN THRU 5442-EXIT
 12479                 END-IF
 12480               END-IF
 12481             END-IF
 12482           END-IF
 12483           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12484           MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12485           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12486
 12487* EXEC CICS REWRITE
 12488*             DATASET    (W-NOTE-FILE-ID)
 12489*             FROM       (CERTIFICATE-NOTE)
 12490*             RESP       (W-RESPONSE)
 12491*          END-EXEC
 12492     MOVE LENGTH OF
 12493      CERTIFICATE-NOTE
 12494       TO DFHEIV11
 12495*    MOVE '&& L                  %  N#00011984' TO DFHEIV0
 12496     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12497     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12498     MOVE X'204E233030303131393834' TO DFHEIV0(25:11)
 12499     CALL 'kxdfhei1' USING DFHEIV0,
 12500           W-NOTE-FILE-ID,
 12501           CERTIFICATE-NOTE,
 12502           DFHEIV11,
 12503           DFHEIV99
 12504     MOVE EIBRESP  TO W-RESPONSE
 12505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12506           PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12507         END-IF
 12508       END-IF
 12509     ELSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 257
* EL689.cbl
 12510        MOVE SPACES              TO CERTIFICATE-NOTE
 12511        MOVE 'CN'                TO CN-RECORD-ID
 12512        MOVE W-SAVE-KEY          TO CN-CONTROL-PRIMARY
 12513                                    W-ERNOTE-KEY
 12514        if pi-iss-can-pend-rec = '2'
 12515           move '2'              to cn-record-type
 12516        else
 12517           move '1'              to cn-record-type
 12518        end-if
 12519        move cn-record-type      to w-note-record-type
 12520        MOVE 01                  TO CN-BILLING-START-LINE-NO
 12521                                    CN-BILLING-END-LINE-NO
 12522        MOVE W-BILLING-NOTE      TO CN-LINE (01)
 12523        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
 12524        MOVE W-SAVE-BIN-DATE     TO CN-LAST-MAINT-DT
 12525        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
 12526
 12527* EXEC CICS WRITE
 12528*          DATASET    (W-NOTE-FILE-ID)
 12529*          FROM       (CERTIFICATE-NOTE)
 12530*          RIDFLD     (cn-control-primary)
 12531*          RESP       (W-RESPONSE)
 12532*       END-EXEC
 12533     MOVE LENGTH OF
 12534      CERTIFICATE-NOTE
 12535       TO DFHEIV11
 12536*    MOVE '&$ L                  ''  N#00012009' TO DFHEIV0
 12537     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12538     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12539     MOVE X'204E233030303132303039' TO DFHEIV0(25:11)
 12540     CALL 'kxdfhei1' USING DFHEIV0,
 12541           W-NOTE-FILE-ID,
 12542           CERTIFICATE-NOTE,
 12543           DFHEIV11,
 12544           cn-control-primary,
 12545           DFHEIV99,
 12546           DFHEIV99
 12547     MOVE EIBRESP  TO W-RESPONSE
 12548     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12549
 12550        PERFORM 5445-CERTIFICATE-UPDATE THRU 5445-EXIT
 12551     END-IF
 12552
 12553     .
 12554 5441-EXIT.
 12555     EXIT.
 12556
 12557
 12558 5442-SQUEEZE-IT-IN.
 12559
 12560     IF NOTE-SUB < CN-BILLING-START-LINE-NO
 12561        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
 12562           NOTE-SUB = +10
 12563           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
 12564           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
 12565             MOVE W-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
 12566             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
 12567             MOVE +9 TO NOTE-SUB
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 258
* EL689.cbl
 12568           END-IF
 12569        END-PERFORM
 12570     ELSE
 12571        IF NOTE-SUB > CN-BILLING-END-LINE-NO
 12572           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
 12573             UNTIL NOTE-SUB = +1
 12574             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
 12575             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
 12576                MOVE W-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
 12577                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
 12578                MOVE +2          TO NOTE-SUB
 12579             END-IF
 12580           END-PERFORM
 12581        END-IF
 12582     END-IF
 12583
 12584     .
 12585 5442-EXIT.
 12586     EXIT.
 12587
 12588 5445-CERTIFICATE-UPDATE.
 12589
 12590     MOVE W-SAVE-KEY         TO W-CERT-KEY
 12591
 12592
 12593* EXEC CICS READ
 12594*        DATASET  (W-CERT-FILE-ID)
 12595*        RIDFLD   (W-CERT-KEY)
 12596*        SET      (ADDRESS OF CERTIFICATE-MASTER)
 12597*        RESP     (W-RESPONSE)
 12598*        UPDATE
 12599*    END-EXEC
 12600*    MOVE '&"S        EU         (  N#00012058' TO DFHEIV0
 12601     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12602     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 12603     MOVE X'204E233030303132303538' TO DFHEIV0(25:11)
 12604     CALL 'kxdfhei1' USING DFHEIV0,
 12605           W-CERT-FILE-ID,
 12606           DFHEIV20,
 12607           DFHEIV99,
 12608           W-CERT-KEY,
 12609           DFHEIV99,
 12610           DFHEIV99,
 12611           DFHEIV99
 12612     SET ADDRESS OF CERTIFICATE-MASTER TO
 12613         DFHEIV20
 12614     MOVE EIBRESP  TO W-RESPONSE
 12615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12616
 12617     IF RESP-NORMAL
 12618        EVALUATE CM-NOTE-SW
 12619           WHEN '2'
 12620           WHEN '3'
 12621           WHEN '6'
 12622           WHEN '7'
 12623              SET NO-CERT-RW     TO TRUE
 12624           WHEN ' '
 12625              MOVE '2'           TO CM-NOTE-SW
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 259
* EL689.cbl
 12626           WHEN '1'
 12627              MOVE '3'           TO CM-NOTE-SW
 12628           WHEN '4'
 12629              MOVE '6'           TO CM-NOTE-SW
 12630           WHEN '5'
 12631              MOVE '7'           TO CM-NOTE-SW
 12632        END-EVALUATE
 12633     END-IF
 12634     IF NOT NO-CERT-RW
 12635
 12636* EXEC CICS REWRITE
 12637*          FROM     (CERTIFICATE-MASTER)
 12638*          DATASET  (W-CERT-FILE-ID)
 12639*          RESP     (W-RESPONSE)
 12640*       END-EXEC
 12641     MOVE LENGTH OF
 12642      CERTIFICATE-MASTER
 12643       TO DFHEIV11
 12644*    MOVE '&& L                  %  N#00012084' TO DFHEIV0
 12645     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 12646     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 12647     MOVE X'204E233030303132303834' TO DFHEIV0(25:11)
 12648     CALL 'kxdfhei1' USING DFHEIV0,
 12649           W-CERT-FILE-ID,
 12650           CERTIFICATE-MASTER,
 12651           DFHEIV11,
 12652           DFHEIV99
 12653     MOVE EIBRESP  TO W-RESPONSE
 12654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12655     ELSE
 12656
 12657* EXEC CICS UNLOCK
 12658*          DATASET  (W-CERT-FILE-ID)
 12659*       END-EXEC
 12660*    MOVE '&*                    #   #00012090' TO DFHEIV0
 12661     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 12662     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 12663     MOVE X'2020233030303132303930' TO DFHEIV0(25:11)
 12664     CALL 'kxdfhei1' USING DFHEIV0,
 12665           W-CERT-FILE-ID,
 12666           DFHEIV99
 12667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 12668     END-IF
 12669
 12670     .
 12671 5445-EXIT.
 12672     EXIT.
 12673
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 260
* EL689.cbl
 12675 5460-DUPLICATE-ARCHIVE-RCD.
 12676
 12677     IF  NOT PI-689-CREATE-NO-SCREENS
 12678
 12679* EXEC CICS SYNCPOINT ROLLBACK
 12680*        END-EXEC.
 12681*    MOVE '6"R                   !   #00012103' TO DFHEIV0
 12682     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12683     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12684     MOVE X'2020233030303132313033' TO DFHEIV0(25:11)
 12685     CALL 'kxdfhei1' USING DFHEIV0
 12686     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12687
 12688
 12689     MOVE ER-9426                TO EMI-ERROR.
 12690     MOVE -1                     TO MAINTL.
 12691     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12692     GO TO 8200-SEND-DATAONLY.
 12693
 12694 5465-DUPLICATE-ARCH-TEXT.
 12695
 12696     IF  NOT PI-689-CREATE-NO-SCREENS
 12697
 12698* EXEC CICS SYNCPOINT ROLLBACK
 12699*        END-EXEC.
 12700*    MOVE '6"R                   !   #00012114' TO DFHEIV0
 12701     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
 12702     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12703     MOVE X'2020233030303132313134' TO DFHEIV0(25:11)
 12704     CALL 'kxdfhei1' USING DFHEIV0
 12705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12706
 12707
 12708     MOVE ER-7369                TO EMI-ERROR.
 12709     MOVE -1                     TO MAINTL.
 12710     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12711     GO TO 8200-SEND-DATAONLY.
 12712
 12713 5470-CNTL-NOT-FOUND.
 12714
 12715     MOVE ER-9299                TO EMI-ERROR.
 12716     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 12717     MOVE -1                     TO MAINTL.
 12718     MOVE AL-UANON               TO MAINTA.
 12719     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 261
* EL689.cbl
 12721 5500-FORMAT-TEXT.
 12722
 12723     SET LT-NDX UP BY +1.
 12724
 12725     IF  W-RC-TEXT (W-RG-NDX) EQUAL W-TOP-FORM
 12726         SET W-RG-NDX UP BY 1
 12727         MOVE 99                 TO LT-SKIP-CONTROL (LT-NDX)
 12728         MOVE W-RC-TEXT (W-RG-NDX)
 12729                                 TO LT-TEXT-LINE (LT-NDX)
 12730     ELSE
 12731         IF  W-RC-TEXT (W-RG-NDX) EQUAL SPACES
 12732             MOVE ZEROS          TO W-PRINT-CONTROL
 12733             PERFORM 5505-FIND-USED-LINE THRU 5505-EXIT
 12734                     VARYING
 12735                 W-RG-NDX FROM W-RG-NDX BY 1
 12736                     UNTIL
 12737                 W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12738                     OR
 12739                 W-RC-TEXT (W-RG-NDX) GREATER THAN SPACES
 12740             IF  W-RG-NDX GREATER THAN PI-TOTAL-LINES
 12741                 GO TO 5500-WRITE-TEST
 12742             ELSE
 12743                 MOVE W-PRINT-CONTROL
 12744                                 TO LT-SKIP-CONTROL (LT-NDX)
 12745                 MOVE W-RC-TEXT (W-RG-NDX)
 12746                                 TO LT-TEXT-LINE (LT-NDX)
 12747         ELSE
 12748             MOVE W-RC-TEXT (W-RG-NDX)
 12749                                 TO LT-TEXT-LINE (LT-NDX)
 12750             MOVE ZEROS          TO W-PRINT-CONTROL.
 12751
 12752     ADD +1                      TO LT-NUM-LINES-ON-RECORD.
 12753
 12754 5500-WRITE-TEST.
 12755
 12756     IF  W-RG-NDX NOT LESS THAN PI-TOTAL-LINES
 12757         IF  LT-TEXT-RECORD NOT EQUAL SPACES
 12758             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12759             MOVE '2'            TO LT-RECORD-TYPE
 12760             ADD +1              TO W-SEQ-CTR
 12761             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12762             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12763         ELSE
 12764             NEXT SENTENCE
 12765     ELSE
 12766         IF  LT-NDX EQUAL +20
 12767             ADD +1              TO PI-689-NUMBER-TEXT-RECORDS
 12768             MOVE '2'            TO LT-RECORD-TYPE
 12769             ADD +1              TO W-SEQ-CTR
 12770             MOVE W-SEQ-CTR      TO LT-LINE-SEQ-NO
 12771             PERFORM 5655-WRITE-ARCHIVE-TEXT THRU 5655-EXIT
 12772             SET LT-NDX          TO W-ZEROS
 12773             PERFORM 5415-INITIALIZE-TEXT THRU 5415-EXIT.
 12774
 12775 5500-EXIT.
 12776      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 262
* EL689.cbl
 12778 5505-FIND-USED-LINE.
 12779
 12780     ADD +1                      TO W-PRINT-CONTROL.
 12781
 12782 5505-EXIT.
 12783      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 263
* EL689.cbl
 12785 5600-FORMAT-ADDRESS-LINE.
 12786
 12787     SET LT-NDX                  TO W-RG-NDX.
 12788     MOVE W-RC-TEXT (W-RG-NDX)   TO LT-TEXT-LINE (LT-NDX).
 12789
 12790 5600-EXIT.
 12791     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 264
* EL689.cbl
 12793 5650-WRITE-ARCHIVE.
 12794
 12795
 12796* EXEC CICS WRITE
 12797*         DATASET   (W-ARCH-FILE-ID)
 12798*         FROM      (LETTER-ARCHIVE)
 12799*         RIDFLD    (LA-CONTROL-PRIMARY)
 12800*    END-EXEC.
 12801     MOVE LENGTH OF
 12802      LETTER-ARCHIVE
 12803       TO DFHEIV11
 12804*    MOVE '&$ L                  ''   #00012204' TO DFHEIV0
 12805     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12806     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12807     MOVE X'2020233030303132323034' TO DFHEIV0(25:11)
 12808     CALL 'kxdfhei1' USING DFHEIV0,
 12809           W-ARCH-FILE-ID,
 12810           LETTER-ARCHIVE,
 12811           DFHEIV11,
 12812           LA-CONTROL-PRIMARY,
 12813           DFHEIV99,
 12814           DFHEIV99
 12815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12816
 12817
 12818 5650-EXIT.
 12819     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 265
* EL689.cbl
 12821 5655-WRITE-ARCHIVE-TEXT.
 12822
 12823
 12824* EXEC CICS WRITE
 12825*         DATASET   (W-ARCT-FILE-ID)
 12826*         FROM      (LETTER-ARCHIVE-TEXT)
 12827*         RIDFLD    (LT-CONTROL-PRIMARY)
 12828*    END-EXEC.
 12829     MOVE LENGTH OF
 12830      LETTER-ARCHIVE-TEXT
 12831       TO DFHEIV11
 12832*    MOVE '&$ L                  ''   #00012215' TO DFHEIV0
 12833     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 12834     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 12835     MOVE X'2020233030303132323135' TO DFHEIV0(25:11)
 12836     CALL 'kxdfhei1' USING DFHEIV0,
 12837           W-ARCT-FILE-ID,
 12838           LETTER-ARCHIVE-TEXT,
 12839           DFHEIV11,
 12840           LT-CONTROL-PRIMARY,
 12841           DFHEIV99,
 12842           DFHEIV99
 12843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12844
 12845
 12846 5655-EXIT.
 12847     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 266
* EL689.cbl
 12849 6000-RESOLVE-VARIABLES.
 12850***************************************************************
 12851*    THIS ROUTINE WILL FORMAT THE SYSTEM DEFINED SYMBOLS      *
 12852*    WITH DATA PERTAINING TO THE FORM WITH VARIABLES.         *
 12853*    THIS ROUTINE IS PERFORM THRU 6000-EXIT IN ORDER TO       *
 12854*    RESOLVE ALL OF THE SYMBOLS.                              *
 12855*                                                             *
 12856***************************************************************
 12857
 12858     PERFORM 6200-GET-COMPANY-DATA THRU 6200-EXIT.
 12859     PERFORM 6250-GET-CNTL2-DATA THRU 6250-EXIT.
 12860     PERFORM 6400-GET-PENDING-DATA THRU 6400-EXIT.
 12861     PERFORM 6450-GET-CERT-DATA THRU 6450-EXIT.
 12862     PERFORM 6500-GET-ACCOUNT-DATA THRU 6500-EXIT
 12863*    PERFORM 6350-GET-CSR-DATA   THRU 6350-EXIT
 12864     PERFORM 6600-GET-COMPENSATION-DATA THRU 6600-EXIT.
 12865     PERFORM 6700-GET-MAIL-DATA THRU 6700-EXIT.
 12866     PERFORM 6300-GET-CARRIER-DATA THRU 6300-EXIT.
 12867     PERFORM 6750-GET-LIFE-BENEFIT-DATA THRU 6750-EXIT.
 12868     PERFORM 6800-GET-A-H-BENEFIT-DATA THRU 6800-EXIT.
 12869     PERFORM 6850-GET-CHECK-DATA THRU 6850-EXIT.
 12870     PERFORM 6900-GET-PYAJ-DATA THRU 6900-EXIT.
 12871     PERFORM 6950-MOVE-SYSTEM-DATA THRU 6950-EXIT.
 12872
 12873     MOVE SPACES                 TO W-REVERSE-DATE-SW.
 12874
 12875 6000-EXIT.
 12876     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 267
* EL689.cbl
 12878 6200-GET-COMPANY-DATA.
 12879
 12880     IF  ADDRSI EQUAL '3'
 12881             AND
 12882         PI-CREATE-LABELS
 12883             AND
 12884         NOT PI-689-LABELS-OVERRIDEN
 12885         NEXT SENTENCE
 12886     ELSE
 12887         IF  W-FILE-NOT-USED (1)
 12888             GO TO 6200-EXIT.
 12889
 12890     MOVE SPACES                 TO W-CNTL-KEY.
 12891     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 12892     MOVE +0                     TO W-CNTL-SEQ-NO.
 12893     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
 12894
 12895
 12896* EXEC CICS HANDLE CONDITION
 12897*         NOTOPEN   (8040-CNTL-NOT-OPEN)
 12898*         NOTFND    (6200-CNTL1-NOT-FOUND)
 12899*    END-EXEC.
 12900*    MOVE '"$JI                  ! + #00012270' TO DFHEIV0
 12901     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 12902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 12903     MOVE X'2B20233030303132323730' TO DFHEIV0(25:11)
 12904     CALL 'kxdfhei1' USING DFHEIV0
 12905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12906
 12907
 12908
 12909* EXEC CICS READ
 12910*         DATASET   (W-CNTL-FILE-ID)
 12911*         SET       (ADDRESS OF CONTROL-FILE)
 12912*         RIDFLD    (W-CNTL-KEY)
 12913*    END-EXEC.
 12914*    MOVE '&"S        E          (   #00012275' TO DFHEIV0
 12915     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 12916     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 12917     MOVE X'2020233030303132323735' TO DFHEIV0(25:11)
 12918     CALL 'kxdfhei1' USING DFHEIV0,
 12919           W-CNTL-FILE-ID,
 12920           DFHEIV20,
 12921           DFHEIV99,
 12922           W-CNTL-KEY,
 12923           DFHEIV99,
 12924           DFHEIV99,
 12925           DFHEIV99
 12926     SET ADDRESS OF CONTROL-FILE TO
 12927         DFHEIV20
 12928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 12929
 12930
 12931     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 12932     MOVE CF-CL-MAIL-TO-NAME     TO W-LABEL-LINES (1)
 12933                                    W-VG-TEXT (25).
 12934     MOVE CF-CL-IN-CARE-OF       TO W-LABEL-LINES (2).
 12935     MOVE CF-CL-ADDR-LINE-1      TO W-LABEL-LINES (3).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 268
* EL689.cbl
 12936     MOVE CF-CL-ADDR-LINE-2      TO W-LABEL-LINES (4).
 12937     MOVE CF-CL-CITY-STATE       TO W-LABEL-LINES (5).
 12938
 12939     IF  CF-CL-CAN-POST-CODE
 12940         MOVE CF-CL-CANADIAN-POSTAL-CODE
 12941                                 TO W-CANADIAN-POSTAL-CODES
 12942         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 12943         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 12944         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 12945                                    W-LAB-CAN-FILLER (6)
 12946         GO TO 6200-CONTINUE.
 12947
 12948     IF CF-CL-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 12949         MOVE CF-CL-ZIP-CODE     TO W-WORK-ZIP
 12950         MOVE SPACES             TO W-LABEL-ZIP (6)
 12951         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 12952
 12953         IF  W-WORK-ZIP4 GREATER THAN '0000'
 12954             MOVE '-'            TO W-LABEL-DASH (6)
 12955             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 12956             GO TO 6200-CONTINUE
 12957         ELSE
 12958             MOVE SPACES         TO W-LABEL-DASH (6)
 12959                                    W-LABEL-2ND-ZIP (6)
 12960             GO TO 6200-CONTINUE.
 12961
 12962     IF  CF-CL-ZIP-CODE-NUM NOT NUMERIC
 12963         GO TO 6200-CONTINUE.
 12964
 12965     MOVE CF-CL-ZIP-CODE-NUM     TO W-WORK-ZIP-NUMERIC.
 12966
 12967     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 12968         COMPUTE W-WORK-ZIP-NUMERIC
 12969             = W-WORK-ZIP-NUMERIC * 10000.
 12970
 12971     MOVE SPACES                 TO W-LABEL-ZIP (6).
 12972     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 12973
 12974     IF  W-WORK-ZIP4 GREATER THAN '0000'
 12975         MOVE '-'                TO W-LABEL-DASH (6)
 12976         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 12977         GO TO 6200-CONTINUE
 12978     ELSE
 12979         MOVE SPACES             TO W-LABEL-DASH (6)
 12980                                    W-LABEL-2ND-ZIP (6)
 12981         GO TO 6200-CONTINUE.
 12982
 12983 6200-CONTINUE.
 12984
 12985     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 12986
 12987     IF  ADDRSI EQUAL '3'
 12988             AND
 12989         PI-CREATE-LABELS
 12990             AND
 12991         NOT PI-689-LABELS-OVERRIDEN
 12992         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (1)
 12993         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (2)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 269
* EL689.cbl
 12994         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (3)
 12995         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (04)
 12996         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (5)
 12997         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (6)
 12998         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 12999         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13000         SET W-RG-NDX UP BY +1
 13001     ELSE
 13002         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (1)
 13003         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (2)
 13004         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (3)
 13005         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (4)
 13006         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (5)
 13007         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (6).
 13008
 13009     GO TO 6200-EXIT.
 13010
 13011 6200-CNTL1-NOT-FOUND.
 13012
 13013     MOVE ER-9299                TO EMI-ERROR.
 13014     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13015     MOVE -1                     TO ADDRSL.
 13016     MOVE AL-UANON               TO ADDRSA.
 13017     GO TO 8200-SEND-DATAONLY.
 13018
 13019 6200-EXIT.
 13020     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 270
* EL689.cbl
 13022 6250-GET-CNTL2-DATA.
 13023
 13024     IF  PI-PROCESSOR-ID EQUAL W-LGXX-ID
 13025         GO TO 6250-EXIT.
 13026
 13027     IF  W-FILE-NOT-USED (11)
 13028         GO TO 6250-EXIT.
 13029
 13030     MOVE SPACES                 TO W-CNTL-KEY.
 13031     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 13032     MOVE +0                     TO W-CNTL-SEQ-NO.
 13033     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 13034     MOVE PI-PROCESSOR-ID        TO W-CNTL-GENL.
 13035
 13036
 13037* EXEC CICS HANDLE CONDITION
 13038*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13039*         NOTFND     (6250-CNTL2-NOT-FOUND)
 13040*    END-EXEC.
 13041*    MOVE '"$JI                  ! , #00012386' TO DFHEIV0
 13042     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13043     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13044     MOVE X'2C20233030303132333836' TO DFHEIV0(25:11)
 13045     CALL 'kxdfhei1' USING DFHEIV0
 13046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13047
 13048
 13049
 13050* EXEC CICS READ
 13051*         DATASET    (W-CNTL-FILE-ID)
 13052*         SET        (ADDRESS OF CONTROL-FILE)
 13053*         RIDFLD     (W-CNTL-KEY)
 13054*    END-EXEC.
 13055*    MOVE '&"S        E          (   #00012391' TO DFHEIV0
 13056     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13057     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13058     MOVE X'2020233030303132333931' TO DFHEIV0(25:11)
 13059     CALL 'kxdfhei1' USING DFHEIV0,
 13060           W-CNTL-FILE-ID,
 13061           DFHEIV20,
 13062           DFHEIV99,
 13063           W-CNTL-KEY,
 13064           DFHEIV99,
 13065           DFHEIV99,
 13066           DFHEIV99
 13067     SET ADDRESS OF CONTROL-FILE TO
 13068         DFHEIV20
 13069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13070
 13071
 13072     MOVE CF-PROCESSOR           TO W-VG-TEXT (153).
 13073     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (151).
 13074     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (152).
 13075     GO TO 6250-EXIT.
 13076
 13077 6250-CNTL2-NOT-FOUND.
 13078
 13079     MOVE ER-9299                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 271
* EL689.cbl
 13080     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13081     MOVE -1                     TO MAINTL.
 13082     MOVE AL-UANON               TO MAINTA.
 13083     GO TO 8200-SEND-DATAONLY.
 13084
 13085 6250-EXIT.
 13086     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 272
* EL689.cbl
 13088 6300-GET-CARRIER-DATA.
 13089
 13090     IF  ADDRSI EQUAL '2'
 13091             AND
 13092         PI-CREATE-LABELS
 13093             AND
 13094         NOT PI-689-LABELS-OVERRIDEN
 13095         NEXT SENTENCE
 13096     ELSE
 13097         IF  W-FILE-NOT-USED (4)
 13098             GO TO 6300-EXIT.
 13099
 13100     IF  PI-689-CARRIER GREATER THAN LOW-VALUES
 13101         MOVE SPACES             TO W-CNTL-KEY
 13102         MOVE PI-COMPANY-ID      TO W-CNTL-COMPANY-ID
 13103         MOVE +0                 TO W-CNTL-SEQ-NO
 13104         MOVE '6'                TO W-CNTL-RECORD-TYPE
 13105         MOVE PI-689-CARRIER     TO W-CNTL-GEN4
 13106     ELSE
 13107         MOVE ER-9327            TO EMI-ERROR
 13108         MOVE -1                 TO CARRIERL
 13109         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13110         GO TO 6300-EXIT.
 13111
 13112
 13113* EXEC CICS HANDLE CONDITION
 13114*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13115*         NOTFND     (6300-CNTL6-NOT-FOUND)
 13116*    END-EXEC.
 13117*    MOVE '"$JI                  ! - #00012437' TO DFHEIV0
 13118     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13119     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13120     MOVE X'2D20233030303132343337' TO DFHEIV0(25:11)
 13121     CALL 'kxdfhei1' USING DFHEIV0
 13122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13123
 13124
 13125
 13126* EXEC CICS READ
 13127*         DATASET    (W-CNTL-FILE-ID)
 13128*         SET        (ADDRESS OF CONTROL-FILE)
 13129*         RIDFLD     (W-CNTL-KEY)
 13130*    END-EXEC.
 13131*    MOVE '&"S        E          (   #00012442' TO DFHEIV0
 13132     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13133     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13134     MOVE X'2020233030303132343432' TO DFHEIV0(25:11)
 13135     CALL 'kxdfhei1' USING DFHEIV0,
 13136           W-CNTL-FILE-ID,
 13137           DFHEIV20,
 13138           DFHEIV99,
 13139           W-CNTL-KEY,
 13140           DFHEIV99,
 13141           DFHEIV99,
 13142           DFHEIV99
 13143     SET ADDRESS OF CONTROL-FILE TO
 13144         DFHEIV20
 13145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 273
* EL689.cbl
 13146
 13147
 13148     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13149     MOVE CF-MAIL-TO-NAME        TO W-LABEL-LINES (1).
 13150     MOVE CF-IN-CARE-OF          TO W-LABEL-LINES (2).
 13151     MOVE CF-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 13152     MOVE CF-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 13153     MOVE CF-CITY-STATE          TO W-LABEL-LINES (5).
 13154
 13155     IF  CF-CANADIAN-POST-CODE
 13156         MOVE CF-CANADIAN-POSTAL-CODE
 13157                                 TO W-CANADIAN-POSTAL-CODES
 13158         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 13159         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 13160         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 13161                                    W-LAB-CAN-FILLER (6)
 13162         GO TO 6300-CONTINUE.
 13163
 13164     IF CF-ZIP-CODE NOT = SPACES AND ZEROS AND LOW-VALUES
 13165         MOVE CF-ZIP-CODE        TO W-WORK-ZIP
 13166         MOVE SPACES             TO W-LABEL-ZIP (6)
 13167         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 13168         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13169             MOVE '-'            TO W-LABEL-DASH (6)
 13170             MOVE W-WORK-ZIP4
 13171                                 TO W-LABEL-2ND-ZIP (6)
 13172             GO TO 6300-CONTINUE
 13173         ELSE
 13174             MOVE SPACES         TO W-LABEL-DASH (6)
 13175                                    W-LABEL-2ND-ZIP (6)
 13176             GO TO 6300-CONTINUE.
 13177
 13178     IF  CF-ZIP-CODE-NUM NOT NUMERIC
 13179         GO TO 6300-CONTINUE.
 13180
 13181     MOVE CF-ZIP-CODE-NUM TO W-WORK-ZIP-NUMERIC.
 13182
 13183     IF  W-WORK-ZIP-NUMERIC LESS THAN +100000
 13184         COMPUTE W-WORK-ZIP-NUMERIC
 13185             = W-WORK-ZIP-NUMERIC * 10000.
 13186
 13187     MOVE SPACES                 TO W-LABEL-ZIP (6).
 13188     MOVE W-WORK-ZIP5            TO W-LABEL-1ST-ZIP (6).
 13189
 13190     IF  W-WORK-ZIP4 GREATER THAN '0000'
 13191         MOVE '-'                TO W-LABEL-DASH (6)
 13192         MOVE W-WORK-ZIP4        TO W-LABEL-2ND-ZIP (6)
 13193         GO TO 6300-CONTINUE
 13194     ELSE
 13195         MOVE SPACES             TO W-LABEL-DASH (6)
 13196                                    W-LABEL-2ND-ZIP (6)
 13197         GO TO 6300-CONTINUE.
 13198
 13199 6300-CONTINUE.
 13200
 13201     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13202
 13203     IF  ADDRSI EQUAL '2'
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 274
* EL689.cbl
 13204             AND
 13205         PI-CREATE-LABELS
 13206             AND
 13207         NOT PI-689-LABELS-OVERRIDEN
 13208         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1) W-VG-TEXT (20)
 13209         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2) W-VG-TEXT (21)
 13210         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3) W-VG-TEXT (22)
 13211         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4) W-VG-TEXT (23)
 13212         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5) W-VG-TEXT (24)
 13213         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6) W-VG-TEXT (25)
 13214         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13215         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13216         SET W-RG-NDX UP BY +1
 13217     ELSE
 13218         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (20)
 13219         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (21)
 13220         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (22)
 13221         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (23)
 13222         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (24)
 13223         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (25).
 13224
 13225     IF  W-FULL-DATA
 13226         MOVE ZEROS              TO W-PHONE-IN
 13227         MOVE CF-PHONE-NO        TO W-PHONE-IN
 13228         MOVE W-PHI-AREA         TO W-PO-AREA
 13229         MOVE W-PHI-PFX          TO W-PO-PFX
 13230         MOVE W-PHI-SFX          TO W-PO-SFX
 13231         MOVE W-PHONE-OUT        TO W-VG-TEXT (26).
 13232
 13233     GO TO 6300-EXIT.
 13234
 13235 6300-CNTL6-NOT-FOUND.
 13236
 13237     MOVE ER-9298                TO EMI-ERROR.
 13238     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13239     MOVE -1                     TO ADDRSL.
 13240     MOVE AL-UANON               TO ADDRSA.
 13241     GO TO 8200-SEND-DATAONLY.
 13242
 13243 6300-EXIT.
 13244     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 275
* EL689.cbl
 13246 6350-GET-CSR-DATA.
 13247     IF W-VG-TEXT (148) (1:4) = '****' OR SPACES
 13248        GO TO 6350-EXIT
 13249     END-IF
 13250*    IF W-FILE-NOT-USED (11)
 13251*       GO TO 6350-EXIT
 13252*    END-IF
 13253     MOVE SPACES                 TO W-CNTL-KEY
 13254     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
 13255     MOVE +0                     TO W-CNTL-SEQ-NO
 13256     MOVE '2'                    TO W-CNTL-RECORD-TYPE
 13257     MOVE CO-CSR-CODE            TO W-CNTL-GENL
 13258
 13259* EXEC CICS HANDLE CONDITION
 13260*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 13261*         NOTFND     (6350-CNTL2-NOT-FOUND)
 13262*    END-EXEC
 13263*    MOVE '"$JI                  ! . #00012558' TO DFHEIV0
 13264     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13265     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13266     MOVE X'2E20233030303132353538' TO DFHEIV0(25:11)
 13267     CALL 'kxdfhei1' USING DFHEIV0
 13268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13269
 13270* EXEC CICS READ
 13271*         DATASET    (W-CNTL-FILE-ID)
 13272*         SET        (ADDRESS OF CONTROL-FILE)
 13273*         RIDFLD     (W-CNTL-KEY)
 13274*    END-EXEC
 13275*    MOVE '&"S        E          (   #00012562' TO DFHEIV0
 13276     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13277     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13278     MOVE X'2020233030303132353632' TO DFHEIV0(25:11)
 13279     CALL 'kxdfhei1' USING DFHEIV0,
 13280           W-CNTL-FILE-ID,
 13281           DFHEIV20,
 13282           DFHEIV99,
 13283           W-CNTL-KEY,
 13284           DFHEIV99,
 13285           DFHEIV99,
 13286           DFHEIV99
 13287     SET ADDRESS OF CONTROL-FILE TO
 13288         DFHEIV20
 13289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13290     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 13291     GO TO 6350-EXIT
 13292     .
 13293 6350-CNTL2-NOT-FOUND.
 13294     MOVE ER-9299                TO EMI-ERROR.
 13295     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13296     MOVE -1                     TO MAINTL.
 13297     MOVE AL-UANON               TO MAINTA.
 13298     GO TO 8200-SEND-DATAONLY.
 13299 6350-EXIT.
 13300     EXIT.
 13301 6400-GET-PENDING-DATA.
 13302
 13303     IF (ADDRSI EQUAL '7')
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 276
* EL689.cbl
 13304        AND (PI-CREATE-LABELS)
 13305        AND (NOT PI-689-LABELS-OVERRIDEN)
 13306        CONTINUE
 13307     ELSE
 13308        IF PI-689-DATA-SOURCE = '4'
 13309           CONTINUE
 13310        ELSE
 13311           IF W-FILE-NOT-USED (9)
 13312              GO TO 6400-EXIT
 13313           END-IF
 13314        END-IF
 13315     END-IF
 13316     IF  W-PNDB-ENTRY EQUAL LOW-VALUES
 13317         MOVE ER-9327            TO EMI-ERROR
 13318         MOVE -1                 TO MAINTL
 13319         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13320         GO TO 6400-EXIT.
 13321
 13322 6400-READ-PNDB-ONLY.
 13323
 13324
 13325* EXEC CICS HANDLE CONDITION
 13326*         NOTOPEN (8060-PNDB-NOT-OPEN)
 13327*         NOTFND  (8070-PNDB-NOT-FOUND)
 13328*    END-EXEC.
 13329*    MOVE '"$JI                  ! / #00012601' TO DFHEIV0
 13330     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13331     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13332     MOVE X'2F20233030303132363031' TO DFHEIV0(25:11)
 13333     CALL 'kxdfhei1' USING DFHEIV0
 13334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13335
 13336
 13337
 13338* EXEC CICS READ
 13339*         DATASET (W-PNDB-FILE-ID)
 13340*         SET     (ADDRESS OF PENDING-BUSINESS)
 13341*         RIDFLD  (W-PNDB-KEY)
 13342*    END-EXEC.
 13343*    MOVE '&"S        E          (   #00012606' TO DFHEIV0
 13344     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13345     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13346     MOVE X'2020233030303132363036' TO DFHEIV0(25:11)
 13347     CALL 'kxdfhei1' USING DFHEIV0,
 13348           W-PNDB-FILE-ID,
 13349           DFHEIV20,
 13350           DFHEIV99,
 13351           W-PNDB-KEY,
 13352           DFHEIV99,
 13353           DFHEIV99,
 13354           DFHEIV99
 13355     SET ADDRESS OF PENDING-BUSINESS TO
 13356         DFHEIV20
 13357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13358
 13359
 13360     MOVE 'Y'                    TO W-PNDB-FOUND-SW.
 13361     move pb-record-type         to pi-iss-can-pend-rec
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 277
* EL689.cbl
 13362
 13363     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 13364         MOVE PB-SV-CARRIER      TO PB-CARRIER
 13365                                    PI-689-CARRIER
 13366         MOVE PB-SV-GROUPING     TO PB-GROUPING
 13367                                    PI-689-GROUPING
 13368         MOVE PB-SV-STATE        TO PB-STATE
 13369                                    PI-689-STATE
 13370         MOVE PB-CONTROL-BY-ACCOUNT
 13371                                 TO W-CERT-KEY
 13372                                    W-MAIL-KEY
 13373                                    W-ACCT-KEY
 13374         MOVE PB-ACCOUNT         TO PI-689-ACCOUNT
 13375         MOVE PB-CERT-EFF-DT     TO PI-689-EFF-DATE
 13376         MOVE PB-CERT-NO         TO PI-689-CERT-NO.
 13377
 13378 6400-ONLY-STOP.
 13379
 13380     MOVE PB-ENTRY-BATCH         TO W-VG-TEXT (130).
 13381
 13382     IF  NOT PB-ISSUE
 13383         GO TO 6400-CANCEL.
 13384
 13385     MOVE PB-I-BIRTHDAY          TO DC-BIN-DATE-1.
 13386     MOVE SPACES                 TO DC-OPTION-CODE.
 13387     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13388
 13389     IF  NO-CONVERSION-ERROR
 13390         MOVE DC-GREG-DATE-1-EDIT
 13391                                 TO W-VG-TEXT (110).
 13392
 13393     MOVE PB-I-AGE               TO W-EDIT-3-0.
 13394     MOVE W-EDIT-3-0             TO W-VG-TEXT (124).
 13395     MOVE PB-I-LF-PREMIUM-AMT    TO W-EDIT-7-2.
 13396     MOVE W-EDIT-7-2             TO W-VG-TEXT (111).
 13397     MOVE PB-I-AH-PREMIUM-AMT    TO W-EDIT-7-2.
 13398     MOVE W-EDIT-7-2             TO W-VG-TEXT (112).
 13399     MOVE PB-I-LF-PREM-CALC      TO W-EDIT-7-2.
 13400     MOVE W-EDIT-7-2             TO W-VG-TEXT (113).
 13401     MOVE PB-I-AH-PREM-CALC      TO W-EDIT-7-2.
 13402     MOVE W-EDIT-7-2             TO W-VG-TEXT (114).
 13403     MOVE PB-I-LF-BENEFIT-AMT    TO W-EDIT-9-2.
 13404     MOVE W-EDIT-9-2             TO W-VG-TEXT (125).
 13405     MOVE PB-I-AH-BENEFIT-AMT    TO W-EDIT-7-2.
 13406     MOVE W-EDIT-7-2             TO W-VG-TEXT (126).
 13407     MOVE PB-I-LF-RATE           TO W-EDIT-2-5-S.
 13408     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (127).
 13409     MOVE PB-I-AH-RATE           TO W-EDIT-2-5-S.
 13410     MOVE W-EDIT-2-5-S           TO W-VG-TEXT (128).
 13411     MOVE PB-I-LOAN-TERM         TO W-EDIT-3-0.
 13412     MOVE W-EDIT-3-0             TO W-VG-TEXT (129).
 13413
 13414     COMPUTE W-DIFFERENCE
 13415         = PB-I-LF-PREM-CALC - PB-I-LF-PREMIUM-AMT.
 13416
 13417     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13418     MOVE W-EDIT-7-2             TO W-VG-TEXT (115).
 13419
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 278
* EL689.cbl
 13420     COMPUTE W-DIFFERENCE
 13421         = PB-I-AH-PREM-CALC - PB-I-AH-PREMIUM-AMT.
 13422
 13423     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13424     MOVE W-EDIT-7-2             TO W-VG-TEXT (116).
 13425
 13426 6400-CANCEL.
 13427
 13428     IF  NOT PB-CANCELLATION
 13429         GO TO 6400-EXIT.
 13430
 13431     MOVE PB-CI-AH-PRIOR-CANCEL-DT
 13432                                 TO DC-BIN-DATE-1.
 13433     MOVE SPACES                 TO DC-OPTION-CODE.
 13434     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13435
 13436     IF  NO-CONVERSION-ERROR
 13437         MOVE DC-GREG-DATE-1-EDIT
 13438                                 TO W-VG-TEXT (117).
 13439
 13440     MOVE PB-C-LF-CANCEL-AMT     TO W-EDIT-7-2.
 13441     MOVE W-EDIT-7-2             TO W-VG-TEXT (118).
 13442     MOVE PB-C-AH-CANCEL-AMT     TO W-EDIT-7-2.
 13443     MOVE W-EDIT-7-2             TO W-VG-TEXT (119).
 13444     MOVE PB-C-LF-REF-CALC       TO W-EDIT-7-2.
 13445     MOVE W-EDIT-7-2             TO W-VG-TEXT (120).
 13446     MOVE PB-C-AH-REF-CALC       TO W-EDIT-7-2.
 13447     MOVE W-EDIT-7-2             TO W-VG-TEXT (121).
 13448     COMPUTE W-EDIT-7-2 = PB-C-LF-CANCEL-AMT + PB-C-AH-CANCEL-AMT
 13449     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13450
 13451     IF PB-C-INT-ON-REFS NOT NUMERIC
 13452        MOVE ZEROS               TO PB-C-INT-ON-REFS
 13453     END-IF
 13454     MOVE PB-C-INT-ON-REFS       TO W-EDIT-7-2
 13455     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13456     MOVE PB-C-LF-CANCEL-DT      TO DC-BIN-DATE-1
 13457     IF PB-C-AH-CANCEL-DT > DC-BIN-DATE-1
 13458        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 13459     END-IF
 13460     MOVE SPACES                 TO DC-OPTION-CODE
 13461     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13462
 13463     IF NO-CONVERSION-ERROR
 13464        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13465     END-IF
 13466
 13467     COMPUTE W-DIFFERENCE = PB-C-LF-REF-CALC
 13468                           - PB-C-LF-CANCEL-AMT.
 13469
 13470     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13471     MOVE W-EDIT-7-2             TO W-VG-TEXT (122).
 13472
 13473     COMPUTE W-DIFFERENCE = PB-C-AH-REF-CALC
 13474                           - PB-C-AH-CANCEL-AMT.
 13475
 13476     MOVE W-DIFFERENCE           TO W-EDIT-7-2.
 13477     MOVE W-EDIT-7-2             TO W-VG-TEXT (123).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 279
* EL689.cbl
 13478
 13479 6400-EXIT.
 13480     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 280
* EL689.cbl
 13482 6450-GET-CERT-DATA.
 13483     IF  W-FILE-NOT-USED (8)
 13484         GO TO 6450-EXIT.
 13485
 13486     IF  W-CERT-CERT-PRIME EQUAL LOW-VALUES
 13487         MOVE ER-9327            TO EMI-ERROR
 13488         MOVE -1                 TO MAINTL
 13489         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13490         GO TO 6450-EXIT.
 13491
 13492 6450-READ-CERT-ONLY.
 13493
 13494
 13495* EXEC CICS HANDLE CONDITION
 13496*         NOTOPEN (8030-CERT-NOT-OPEN)
 13497*         NOTFND  (8035-CERT-NOT-FOUND)
 13498*    END-EXEC.
 13499*    MOVE '"$JI                  ! 0 #00012746' TO DFHEIV0
 13500     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 13501     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13502     MOVE X'3020233030303132373436' TO DFHEIV0(25:11)
 13503     CALL 'kxdfhei1' USING DFHEIV0
 13504     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13505
 13506
 13507
 13508* EXEC CICS READ
 13509*         DATASET (W-CERT-FILE-ID)
 13510*         SET     (ADDRESS OF CERTIFICATE-MASTER)
 13511*         RIDFLD  (W-CERT-KEY)
 13512*    END-EXEC.
 13513*    MOVE '&"S        E          (   #00012751' TO DFHEIV0
 13514     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 13515     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 13516     MOVE X'2020233030303132373531' TO DFHEIV0(25:11)
 13517     CALL 'kxdfhei1' USING DFHEIV0,
 13518           W-CERT-FILE-ID,
 13519           DFHEIV20,
 13520           DFHEIV99,
 13521           W-CERT-KEY,
 13522           DFHEIV99,
 13523           DFHEIV99,
 13524           DFHEIV99
 13525     SET ADDRESS OF CERTIFICATE-MASTER TO
 13526         DFHEIV20
 13527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13528
 13529
 13530     MOVE 'Y'                    TO W-CERT-FOUND-SW.
 13531
 13532 6450-ONLY-STOP.
 13533
 13534     MOVE CM-INSURED-LAST-NAME   TO W-VG-TEXT (108).
 13535
 13536     MOVE CM-BENEFICIARY         TO W-VG-TEXT (109).
 13537
 13538     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13539     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 281
* EL689.cbl
 13540     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13541     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13542     MOVE WS-NAME-WORK           TO W-VG-TEXT (95).
 13543
 13544     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13545     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13546     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13547     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13548     MOVE WS-NAME-WORK           TO W-VG-TEXT (94).
 13549
 13550     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13551     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13552     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13553     MOVE CM-INSURED-INITIAL2    TO W-NAME-MIDDLE.
 13554     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13555     MOVE WS-NAME-WORK           TO W-VG-TEXT (90).
 13556
 13557     MOVE CM-INSURED-LAST-NAME   TO W-NAME-LAST.
 13558     MOVE CM-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 13559     MOVE SPACES                 TO W-NAME-MIDDLE.
 13560     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13561     MOVE WS-NAME-WORK           TO W-VG-TEXT (104).
 13562
 13563     MOVE CM-INSURED-FIRST-NAME  TO W-VG-TEXT (91).
 13564     MOVE CM-INSURED-INITIAL2    TO W-VG-TEXT (92).
 13565
 13566     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13567     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13568     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13569     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13570     MOVE WS-NAME-WORK           TO W-VG-TEXT (103)
 13571                                    W-LABEL-JOINT-NAME.
 13572
 13573     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13574     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13575     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13576     PERFORM 7100-FORMAT-LAST-NAME-1ST THRU 7100-EXIT.
 13577     MOVE WS-NAME-WORK           TO W-VG-TEXT (102).
 13578
 13579     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13580     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13581     MOVE '.'                    TO W-NAME-FIRST-REMAIN.
 13582     MOVE CM-JT-INITIAL          TO W-NAME-MIDDLE.
 13583     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13584     MOVE WS-NAME-WORK           TO W-VG-TEXT (99).
 13585
 13586     MOVE CM-JT-LAST-NAME        TO W-NAME-LAST.
 13587     MOVE CM-JT-FIRST-NAME       TO W-NAME-FIRST.
 13588     MOVE SPACES                 TO W-NAME-MIDDLE.
 13589     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
 13590     MOVE WS-NAME-WORK           TO W-VG-TEXT (105).
 13591
 13592     MOVE CM-JT-FIRST-NAME       TO W-VG-TEXT (100).
 13593     MOVE CM-JT-INITIAL          TO W-VG-TEXT (101).
 13594
 13595     COMPUTE W-WORK-AMOUNT
 13596         = CM-LF-PREMIUM-AMT + CM-LF-ALT-PREMIUM-AMT.
 13597     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 282
* EL689.cbl
 13598     MOVE W-EDIT-9-2             TO W-VG-TEXT (97).
 13599     MOVE CM-AH-PREMIUM-AMT      TO W-EDIT-7-2.
 13600     MOVE W-EDIT-7-2             TO W-VG-TEXT (98).
 13601
 13602     IF  CM-SEX-FEMAL
 13603         MOVE 'MS.'              TO W-VG-TEXT (96)
 13604
 13605     ELSE
 13606         MOVE 'MR.'              TO W-VG-TEXT (96).
 13607
 13608     MOVE CM-CARRIER OF CERTIFICATE-MASTER
 13609                                 TO W-VG-TEXT (70).
 13610     MOVE CM-GROUPING            TO W-VG-TEXT (71).
 13611     MOVE CM-ACCOUNT             TO W-VG-TEXT (72).
 13612     MOVE CM-CERT-NO             TO W-VG-TEXT (73).
 13613     MOVE CM-INSURED-ISSUE-AGE   TO W-DISPLAY-3.
 13614     MOVE W-DISPLAY-3            TO W-VG-TEXT (83).
 13615     MOVE CM-LOAN-NUMBER         TO W-VG-TEXT (86).
 13616     MOVE CM-LOAN-BALANCE        TO W-EDIT-7-2.
 13617     MOVE W-EDIT-7-2             TO W-VG-TEXT (87).
 13618     MOVE CM-MEMBER-NO           TO W-VG-TEXT (88).
 13619     MOVE CM-SOC-SEC-NO          TO W-VG-TEXT (89).
 13620     MOVE CM-POLICY-FORM-NO      TO W-VG-TEXT (83).
 13621     MOVE CM-LF-ORIG-TERM        TO W-EDIT-3-0.
 13622     MOVE W-EDIT-3-0             TO W-VG-TEXT (77).
 13623     MOVE CM-LF-BENEFIT-AMT      TO W-EDIT-9-2.
 13624     MOVE W-EDIT-9-2             TO W-VG-TEXT (79).
 13625     MOVE CM-AH-ORIG-TERM        TO W-EDIT-3-0.
 13626     MOVE W-EDIT-3-0             TO W-VG-TEXT (78).
 13627     MOVE CM-AH-BENEFIT-AMT      TO W-EDIT-7-2.
 13628     MOVE W-EDIT-7-2             TO W-VG-TEXT (80).
 13629     MOVE CM-AH-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13630     MOVE W-EDIT-7-2             TO W-VG-TEXT (107).
 13631     MOVE CM-LF-ITD-CANCEL-AMT   TO W-EDIT-7-2.
 13632     MOVE W-EDIT-7-2             TO W-VG-TEXT (106).
 13633     IF PI-689-DATA-SOURCE NOT = '4'
 13634     COMPUTE W-EDIT-7-2 = CM-LF-ITD-CANCEL-AMT
 13635        + CM-AH-ITD-CANCEL-AMT
 13636     MOVE W-EDIT-7-2             TO W-VG-TEXT (131)
 13637     IF CM-INT-ON-REFS NOT NUMERIC
 13638        MOVE ZEROS               TO CM-INT-ON-REFS
 13639     END-IF
 13640     MOVE CM-INT-ON-REFS         TO W-EDIT-7-2
 13641     MOVE W-EDIT-7-2             TO W-VG-TEXT (132)
 13642     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
 13643     IF CM-AH-CANCEL-DT > DC-BIN-DATE-1
 13644        MOVE CM-AH-CANCEL-DT     TO DC-BIN-DATE-1
 13645     END-IF
 13646     MOVE SPACES                 TO DC-OPTION-CODE
 13647     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
 13648
 13649     IF NO-CONVERSION-ERROR
 13650        MOVE DC-GREG-DATE-1-EDIT TO W-VG-TEXT (133)
 13651     END-IF
 13652     END-IF
 13653     COMPUTE W-WORK-AMOUNT = CM-AH-ORIG-TERM * CM-AH-BENEFIT-AMT.
 13654     MOVE W-WORK-AMOUNT          TO W-EDIT-9-2.
 13655     MOVE W-EDIT-9-2             TO W-VG-TEXT (93).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 283
* EL689.cbl
 13656
 13657     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1.
 13658     MOVE SPACES                 TO DC-OPTION-CODE.
 13659     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13660
 13661     IF  NO-CONVERSION-ERROR
 13662         MOVE DC-GREG-DATE-1-EDIT
 13663                                 TO W-VG-TEXT (81).
 13664
 13665     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1.
 13666     MOVE SPACES                 TO DC-OPTION-CODE.
 13667     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13668
 13669     IF  NO-CONVERSION-ERROR
 13670         MOVE DC-GREG-DATE-1-EDIT
 13671                                 TO W-VG-TEXT (82).
 13672
 13673     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13674     MOVE SPACES                 TO DC-OPTION-CODE.
 13675     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13676
 13677     IF  NO-CONVERSION-ERROR
 13678         MOVE DC-GREG-DATE-1-EDIT
 13679                                 TO W-VG-TEXT (74).
 13680
 13681     MOVE CM-LF-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13682
 13683     IF  CM-PMT-EXTENSION-DAYS NUMERIC
 13684         MOVE CM-PMT-EXTENSION-DAYS
 13685                                 TO DC-ELAPSED-DAYS
 13686     ELSE
 13687         MOVE ZEROS              TO DC-ELAPSED-DAYS.
 13688
 13689     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13690     MOVE '6'                    TO DC-OPTION-CODE.
 13691     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13692
 13693     IF  NO-CONVERSION-ERROR
 13694         MOVE DC-GREG-DATE-1-EDIT
 13695                                 TO W-VG-TEXT (75).
 13696
 13697     MOVE CM-AH-ORIG-TERM        TO DC-ELAPSED-MONTHS.
 13698     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1.
 13699     MOVE '6'                    TO DC-OPTION-CODE.
 13700     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 13701
 13702     IF  NO-CONVERSION-ERROR
 13703         MOVE DC-GREG-DATE-1-EDIT
 13704                                 TO W-VG-TEXT (76).
 13705
 13706 6450-EXIT.
 13707     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 284
* EL689.cbl
 13709 6500-GET-ACCOUNT-DATA.
 13710
 13711     IF  ADDRSI EQUAL '1'
 13712             AND
 13713         PI-CREATE-LABELS
 13714             AND
 13715         NOT PI-689-LABELS-OVERRIDEN
 13716         NEXT SENTENCE
 13717     ELSE
 13718         IF  W-FILE-NOT-USED (6)
 13719             GO TO 6500-EXIT
 13720         END-IF
 13721     END-IF.
 13722
 13723 6500-READ-ACCT-ONLY.
 13724
 13725     IF  W-ACCT-ACCOUNT EQUAL LOW-VALUES
 13726         MOVE ER-9327            TO EMI-ERROR
 13727         MOVE -1                 TO MAINTL
 13728         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13729         GO TO 6500-EXIT.
 13730
 13731
 13732* EXEC CICS HANDLE CONDITION
 13733*         NOTOPEN    (8020-ACCT-NOT-OPEN)
 13734*         NOTFND     (6500-ACCT-NOT-FOUND)
 13735*         ENDFILE    (6500-ONLY-STOP)
 13736*    END-EXEC.
 13737*    MOVE '"$JI''                 ! 1 #00012958' TO DFHEIV0
 13738     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 13739     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 13740     MOVE X'3120233030303132393538' TO DFHEIV0(25:11)
 13741     CALL 'kxdfhei1' USING DFHEIV0
 13742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13743
 13744
 13745
 13746* EXEC CICS STARTBR
 13747*         RIDFLD     (W-ACCT-KEY)
 13748*         DATASET    (W-ACCT-FILE-ID)
 13749*         KEYLENGTH  (20)
 13750*         GENERIC
 13751*    END-EXEC.
 13752     MOVE 20
 13753       TO DFHEIV11
 13754     MOVE 0
 13755       TO DFHEIV12
 13756*    MOVE '&,   KG    G          &   #00012964' TO DFHEIV0
 13757     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
 13758     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 13759     MOVE X'2020233030303132393634' TO DFHEIV0(25:11)
 13760     CALL 'kxdfhei1' USING DFHEIV0,
 13761           W-ACCT-FILE-ID,
 13762           W-ACCT-KEY,
 13763           DFHEIV11,
 13764           DFHEIV12,
 13765           DFHEIV99
 13766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 285
* EL689.cbl
 13767
 13768
 13769     MOVE W-ACCT-PARTIAL-KEY     TO W-ACCT-SAVE-KEY.
 13770     MOVE 'Y'                    TO W-ACCT-BROWSE-STARTED-SW.
 13771
 13772 6500-READNEXT.
 13773
 13774
 13775* EXEC CICS READNEXT
 13776*         DATASET    (W-ACCT-FILE-ID)
 13777*         SET        (ADDRESS OF ACCOUNT-MASTER)
 13778*         RIDFLD     (W-ACCT-KEY)
 13779*    END-EXEC.
 13780     MOVE 0
 13781       TO DFHEIV11
 13782*    MOVE '&.S                   )   #00012976' TO DFHEIV0
 13783     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 13784     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 13785     MOVE X'2020233030303132393736' TO DFHEIV0(25:11)
 13786     CALL 'kxdfhei1' USING DFHEIV0,
 13787           W-ACCT-FILE-ID,
 13788           DFHEIV20,
 13789           DFHEIV99,
 13790           W-ACCT-KEY,
 13791           DFHEIV99,
 13792           DFHEIV11,
 13793           DFHEIV99,
 13794           DFHEIV99
 13795     SET ADDRESS OF ACCOUNT-MASTER TO
 13796         DFHEIV20
 13797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 13798
 13799
 13800     IF  W-ACCT-PARTIAL-KEY NOT EQUAL W-ACCT-SAVE-KEY
 13801         IF  PRIOR-MATCH-ACCT-PKEY
 13802             CONTINUE
 13803*            GO TO 6500-ONLY-STOP
 13804         ELSE
 13805             IF  W-FILE-NOT-USED (6)
 13806                 PERFORM 6500-ENDBR
 13807                 GO TO 6500-EXIT
 13808             ELSE
 13809                 GO TO 6500-ACCT-NOT-FOUND
 13810             END-IF
 13811         END-IF
 13812     ELSE
 13813         SET PRIOR-MATCH-ACCT-PKEY TO TRUE
 13814         MOVE AM-CARRIER           TO WS-SAV-AM-CARRIER
 13815         MOVE AM-ACCOUNT           TO WS-SAV-AM-ACCOUNT
 13816         MOVE AM-DEFN-1            TO WS-SAV-AM-DEFN-1
 13817         MOVE AM-REMIT-TO          TO WS-SAV-AM-REMIT-TO
 13818         MOVE AM-NAME              TO WS-SAV-AM-NAME
 13819         MOVE AM-PERSON            TO WS-SAV-AM-PERSON
 13820         MOVE AM-ADDRS             TO WS-SAV-AM-ADDRS
 13821         MOVE SPACES               TO WS-SAV-AM-CITY
 13822*        MOVE AM-CITY              TO WS-SAV-AM-CITY
 13823         STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
 13824            DELIMITED BY '  ' INTO WS-SAV-AM-CITY
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 286
* EL689.cbl
 13825         END-STRING
 13826         MOVE AM-ZIP               TO WS-SAV-AM-ZIP
 13827         MOVE AM-TEL-NO            TO WS-SAV-AM-TEL-NO
 13828         MOVE AM-CONTROL-NAME      TO WS-SAV-AM-CONTROL-NAME
 13829         MOVE AM-CSR-CODE          TO WS-SAV-AM-CSR-CODE
 13830         MOVE AM-ACCOUNT           TO WS-SAV-AM-ERACCT-ACCOUNT
 13831         GO TO 6500-READNEXT
 13832     END-IF
 13833     .
 13834 6500-ONLY-STOP.
 13835
 13836     IF  NOT PI-NO-CARRIER-SECURITY
 13837             AND
 13838         PI-CARRIER-SECURITY NOT = WS-SAV-AM-CARRIER
 13839         MOVE -1                 TO CARRIERL
 13840         MOVE AL-UANON           TO CARRIERA
 13841         MOVE ER-9095            TO EMI-ERROR
 13842         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13843         PERFORM 6500-ENDBR
 13844         GO TO 8200-SEND-DATAONLY.
 13845
 13846     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 13847     MOVE WS-SAV-AM-NAME         TO W-LABEL-LINES (1).
 13848     MOVE WS-SAV-AM-PERSON       TO W-LABEL-LINES (2).
 13849     MOVE WS-SAV-AM-ADDRS        TO W-LABEL-LINES (3).
 13850     MOVE WS-SAV-AM-CITY         TO W-LABEL-LINES (4).
 13851
 13852     MOVE WS-SAV-AM-ZIP          TO W-WORK-ZIP.
 13853     MOVE SPACES                 TO W-LABEL-ZIP (5).
 13854
 13855     IF  SAVE-AM-CANADIAN-POST-CODE
 13856         MOVE WS-SAV-AM-CANADIAN-POSTAL-CODE
 13857                                 TO W-CANADIAN-POSTAL-CODES
 13858         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 13859         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 13860         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 13861                                    W-LAB-CAN-FILLER (5)
 13862     ELSE
 13863         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 13864
 13865         IF  W-WORK-ZIP4 GREATER THAN '0000'
 13866             MOVE '-'            TO W-LABEL-DASH (5)
 13867             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 13868         ELSE
 13869             MOVE SPACES         TO W-LABEL-DASH (5)
 13870                                    W-LABEL-2ND-ZIP (5).
 13871
 13872     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 13873
 13874     IF  ADDRSI EQUAL '1'
 13875             AND
 13876         PI-CREATE-LABELS
 13877             AND
 13878         NOT PI-689-LABELS-OVERRIDEN
 13879         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 13880                                    W-VG-TEXT (40)
 13881         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 13882                                    W-VG-TEXT (41)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 287
* EL689.cbl
 13883         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 13884                                    W-VG-TEXT (42)
 13885         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 13886                                    W-VG-TEXT (43)
 13887         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 13888                                    W-VG-TEXT (44)
 13889         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 13890                                    W-VG-TEXT (45)
 13891         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 13892         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 13893         SET W-RG-NDX UP BY +1
 13894     ELSE
 13895         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (40)
 13896         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (41)
 13897         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (42)
 13898         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (43)
 13899         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (44)
 13900         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (45).
 13901
 13902     IF  WS-SAV-AM-TEL-NO NOT NUMERIC
 13903             OR
 13904         WS-SAV-AM-TEL-NO EQUAL ZEROS
 13905         MOVE SPACES             TO W-VG-TEXT (46)
 13906     ELSE
 13907         MOVE ZEROS                  TO W-PHONE-IN
 13908         MOVE WS-SAV-AM-AREA-CODE    TO W-PO-AREA
 13909         MOVE WS-SAV-AM-TEL-PRE      TO W-PO-PFX
 13910         MOVE WS-SAV-AM-TEL-NBR      TO W-PO-SFX
 13911         MOVE W-PHONE-OUT            TO W-VG-TEXT (46).
 13912
 13913     IF WS-SAV-AM-CONTROL-NAME (1:1) NOT = LOW-VALUES
 13914        MOVE WS-SAV-AM-CONTROL-NAME  TO W-VG-TEXT (47)
 13915     ELSE
 13916        MOVE SPACES                   TO W-VG-TEXT (47)
 13917     END-IF.
 13918     MOVE WS-SAV-AM-CSR-CODE     TO W-VG-TEXT (48)
 13919     MOVE WS-SAV-AM-ERACCT-ACCOUNT
 13920                                 TO W-VG-TEXT (49)
 13921
 13922     MOVE WS-SAV-AM-ACCOUNT      TO W-VG-TEXT (72)
 13923     PERFORM 6500-ENDBR.
 13924
 13925     GO TO 6500-EXIT.
 13926
 13927 6500-ENDBR.
 13928
 13929     IF  W-ACCT-BROWSE-STARTED
 13930         MOVE 'N'                TO W-ACCT-BROWSE-STARTED-SW
 13931
 13932* EXEC CICS ENDBR
 13933*            DATASET (W-ACCT-FILE-ID)
 13934*        END-EXEC
 13935     MOVE 0
 13936       TO DFHEIV11
 13937*    MOVE '&2                    $   #00013113' TO DFHEIV0
 13938     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 13939     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 13940     MOVE X'2020233030303133313133' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 288
* EL689.cbl
 13941     CALL 'kxdfhei1' USING DFHEIV0,
 13942           W-ACCT-FILE-ID,
 13943           DFHEIV11,
 13944           DFHEIV99
 13945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 13946     END-IF.
 13947
 13948 6500-ACCT-NOT-FOUND.
 13949
 13950     PERFORM 6500-ENDBR.
 13951
 13952     IF  DATASORI NOT EQUAL '1'
 13953         MOVE ER-0179            TO EMI-ERROR
 13954         GO TO 6500-EXIT.
 13955
 13956     MOVE ER-0179                TO EMI-ERROR.
 13957     MOVE -1                     TO MAINTL.
 13958     MOVE AL-UNBON               TO MAINTA.
 13959     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 13960     GO TO 8200-SEND-DATAONLY.
 13961
 13962 6500-EXIT.
 13963     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 289
* EL689.cbl
 13965 6600-GET-COMPENSATION-DATA.
 13966
 13967     IF  ADDRSI EQUAL '4'
 13968             AND
 13969         PI-CREATE-LABELS
 13970             AND
 13971         NOT PI-689-LABELS-OVERRIDEN
 13972         NEXT SENTENCE
 13973     ELSE
 13974         IF  W-FILE-NOT-USED (10)
 13975             GO TO 6600-EXIT.
 13976
 13977     IF  W-COMP-RESP-PERSON GREATER THAN LOW-VALUES
 13978         MOVE W-COMP-KEY         TO W-COMP-SAVE-KEY
 13979         GO TO 6600-START.
 13980
 13981     IF  PI-ZERO-CARRIER
 13982             OR
 13983         PI-ZERO-CAR-GROUP
 13984         MOVE ZEROS              TO W-COMP-CARRIER.
 13985
 13986     IF  PI-ZERO-GROUPING
 13987             OR
 13988         PI-ZERO-CAR-GROUP
 13989         MOVE ZEROS              TO W-COMP-GROUPING.
 13990
 13991     IF  W-FILE-NOT-USED (6)
 13992         PERFORM 6500-READ-ACCT-ONLY THRU 6500-READNEXT
 13993         IF  EMI-ERROR EQUAL ER-0179
 13994             MOVE ER-9327        TO EMI-ERROR
 13995             MOVE -1             TO MAINTL
 13996             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 13997             GO TO 6600-EXIT.
 13998
 13999     MOVE  'A'                   TO W-COMP-TYPE.
 14000
 14001     IF  WS-SAV-AM-REMIT-TO GREATER THAN ZEROS
 14002         MOVE WS-SAV-AM-AGT (WS-SAV-AM-REMIT-TO)
 14003                                 TO W-COMP-RESP-PERSON
 14004     ELSE
 14005         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 14006
 14007     PERFORM VARYING W-NDX FROM +1 BY +1 UNTIL
 14008        (W-NDX > +10)
 14009            OR
 14010         (WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'F')
 14011     END-PERFORM
 14012
 14013     IF  WS-SAV-AM-COM-TYP (W-NDX) = 'C' OR 'D' OR 'F'
 14014         MOVE WS-SAV-AM-AGT (W-NDX)  TO W-COMP-ACCOUNT
 14015     ELSE
 14016         MOVE PI-689-ACCOUNT     TO W-COMP-ACCOUNT.
 14017
 14018     PERFORM 6500-ENDBR.
 14019     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 14020
 14021     IF  W-COMP-RESP-PERSON EQUAL LOW-VALUES
 14022         MOVE ER-9327            TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 290
* EL689.cbl
 14023         MOVE -1                 TO MAINTL
 14024         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14025         GO TO 6600-EXIT.
 14026
 14027 6600-START.
 14028
 14029
 14030* EXEC CICS HANDLE CONDITION
 14031*         NOTOPEN (8080-COMP-NOT-OPEN)
 14032*         NOTFND  (6600-COMP-NOT-FOUND)
 14033*    END-EXEC.
 14034*    MOVE '"$JI                  ! 2 #00013199' TO DFHEIV0
 14035     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14036     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14037     MOVE X'3220233030303133313939' TO DFHEIV0(25:11)
 14038     CALL 'kxdfhei1' USING DFHEIV0
 14039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14040
 14041
 14042
 14043* EXEC CICS STARTBR
 14044*         RIDFLD  (W-COMP-KEY)
 14045*         DATASET (W-COMP-FILE-ID)
 14046*    END-EXEC.
 14047     MOVE 0
 14048       TO DFHEIV11
 14049*    MOVE '&,         G          &   #00013204' TO DFHEIV0
 14050     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
 14051     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14052     MOVE X'2020233030303133323034' TO DFHEIV0(25:11)
 14053     CALL 'kxdfhei1' USING DFHEIV0,
 14054           W-COMP-FILE-ID,
 14055           W-COMP-KEY,
 14056           DFHEIV99,
 14057           DFHEIV11,
 14058           DFHEIV99
 14059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14060
 14061
 14062     MOVE 'Y'                    TO W-COMP-BROWSE-SW.
 14063
 14064 6600-READNEXT.
 14065
 14066
 14067* EXEC CICS READNEXT
 14068*         DATASET (W-COMP-FILE-ID)
 14069*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14070*         RIDFLD  (W-COMP-KEY)
 14071*    END-EXEC.
 14072     MOVE 0
 14073       TO DFHEIV11
 14074*    MOVE '&.S                   )   #00013213' TO DFHEIV0
 14075     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14076     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14077     MOVE X'2020233030303133323133' TO DFHEIV0(25:11)
 14078     CALL 'kxdfhei1' USING DFHEIV0,
 14079           W-COMP-FILE-ID,
 14080           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 291
* EL689.cbl
 14081           DFHEIV99,
 14082           W-COMP-KEY,
 14083           DFHEIV99,
 14084           DFHEIV11,
 14085           DFHEIV99,
 14086           DFHEIV99
 14087     SET ADDRESS OF COMPENSATION-MASTER TO
 14088         DFHEIV20
 14089     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14090
 14091
 14092     IF CO-CONTROL-PRIMARY
 14093           NOT = W-COMP-SAVE-KEY
 14094        GO TO 6600-COMP-NOT-FOUND.
 14095
 14096     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14097     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1)
 14098                                    W-VG-TEXT (140).
 14099     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14100     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14101     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14102*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14103     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14104        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14105     END-STRING
 14106
 14107     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14108
 14109     IF  CO-CANADIAN-POST-CODE
 14110         MOVE CO-CANADIAN-POSTAL-CODE
 14111                                 TO W-CANADIAN-POSTAL-CODES
 14112         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14113         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14114         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14115                                    W-LAB-CAN-FILLER (6)
 14116     ELSE
 14117         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14118
 14119         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14120             MOVE '-'            TO W-LABEL-DASH (6)
 14121             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14122         ELSE
 14123             MOVE SPACES         TO W-LABEL-DASH (6)
 14124                                    W-LABEL-2ND-ZIP (6).
 14125
 14126     IF  CO-TELEPHONE NOT NUMERIC
 14127             OR
 14128         CO-TELEPHONE = ZEROS
 14129         MOVE SPACES             TO W-VG-TEXT (147)
 14130     ELSE
 14131         MOVE ZEROS              TO W-PHONE-IN
 14132         MOVE CO-AREA-CODE       TO W-PO-AREA
 14133         MOVE CO-PREFIX          TO W-PO-PFX
 14134         MOVE CO-PHONE           TO W-PO-SFX
 14135         MOVE W-PHONE-OUT        TO W-VG-TEXT (147).
 14136
 14137     IF (CO-FAXNO NOT NUMERIC)
 14138        OR (CO-FAXNO = ZEROS)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 292
* EL689.cbl
 14139        MOVE SPACES              TO W-VG-TEXT (182)
 14140     ELSE
 14141        MOVE ZEROS               TO W-PHONE-IN
 14142        MOVE CO-FAX-AREA-CODE    TO W-PO-AREA
 14143        MOVE CO-FAX-PREFIX       TO W-PO-PFX
 14144        MOVE CO-FAX-PHONE        TO W-PO-SFX
 14145        MOVE W-PHONE-OUT         TO W-VG-TEXT (182)
 14146     END-IF
 14147     IF CO-GA-STATUS-CODE NOT = 'A' AND 'I' AND 'P'
 14148        MOVE SPACES              TO W-VG-TEXT (183)
 14149     ELSE
 14150        EVALUATE CO-GA-STATUS-CODE
 14151           WHEN 'A'
 14152              MOVE 'ACTIVE'      TO W-VG-TEXT (183)
 14153           WHEN 'I'
 14154              MOVE 'INACTIVE'    TO W-VG-TEXT (183)
 14155           WHEN 'P'
 14156              MOVE 'PENDING'     TO W-VG-TEXT (183)
 14157        END-EVALUATE
 14158     END-IF
 14159     IF CO-BILL-SW NOT = 'B' AND 'R' AND 'T' AND 'S'
 14160        MOVE SPACES              TO W-VG-TEXT (181)
 14161     ELSE
 14162        EVALUATE CO-BILL-SW
 14163           WHEN 'B'
 14164              MOVE 'BILLED'      TO W-VG-TEXT (181)
 14165           WHEN 'R'
 14166              MOVE 'REMIT'       TO W-VG-TEXT (181)
 14167           WHEN 'T'
 14168              MOVE 'T'           TO W-VG-TEXT (181)
 14169           WHEN 'S'
 14170              MOVE 'S'           TO W-VG-TEXT (181)
 14171        END-EVALUATE
 14172     END-IF
 14173     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14174
 14175     IF  ADDRSI EQUAL '4'
 14176             AND
 14177         PI-CREATE-LABELS
 14178             AND
 14179         NOT PI-689-LABELS-OVERRIDEN
 14180         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14181                                    W-VG-TEXT (141)
 14182         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14183                                    W-VG-TEXT (142)
 14184         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14185                                    W-VG-TEXT (143)
 14186         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14187                                    W-VG-TEXT (144)
 14188         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14189                                    W-VG-TEXT (145)
 14190         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14191                                    W-VG-TEXT (146)
 14192         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14193         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14194         SET W-RG-NDX UP BY +1
 14195     ELSE
 14196         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (141)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 293
* EL689.cbl
 14197         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (142)
 14198         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (143)
 14199         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (144)
 14200         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (145)
 14201         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (146).
 14202
 14203     PERFORM 6630-GET-CSR-NAME THRU 6630-EXIT.
 14204
 14205     MOVE CO-RESP-NO             TO W-VG-TEXT (180).
 14206     MOVE CO-END-BAL             TO W-EDIT-7-2-NEGATIVE.
 14207     MOVE W-EDIT-7-2-NEGATIVE    TO W-VG-TEXT (150).
 14208
 14209     MOVE CO-LAST-STMT-DT        TO DC-GREG-DATE-1-YMD.
 14210     MOVE '3'                    TO DC-OPTION-CODE.
 14211     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 14212
 14213     IF  NO-CONVERSION-ERROR
 14214         MOVE DC-GREG-DATE-1-ALPHA
 14215                                 TO W-VG-TEXT (149).
 14216
 14217     PERFORM 6620-GET-G-DATA THRU 6620-EXIT.
 14218     PERFORM 6626-GET-B-DATA     THRU 6626-EXIT
 14219
 14220     PERFORM 6600-ENDBR.
 14221     GO TO 6600-EXIT.
 14222
 14223 6600-ENDBR.
 14224
 14225     IF  W-COMP-BROWSE-STARTED
 14226         MOVE 'N'                      TO W-COMP-BROWSE-SW
 14227
 14228* EXEC CICS ENDBR
 14229*             DATASET(W-COMP-FILE-ID)
 14230*        END-EXEC.
 14231     MOVE 0
 14232       TO DFHEIV11
 14233*    MOVE '&2                    $   #00013354' TO DFHEIV0
 14234     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
 14235     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 14236     MOVE X'2020233030303133333534' TO DFHEIV0(25:11)
 14237     CALL 'kxdfhei1' USING DFHEIV0,
 14238           W-COMP-FILE-ID,
 14239           DFHEIV11,
 14240           DFHEIV99
 14241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14242
 14243
 14244 6600-COMP-NOT-FOUND.
 14245
 14246     PERFORM 6600-ENDBR.
 14247
 14248     IF ADDRSL GREATER ZERO
 14249         IF ADDRSI = '4'
 14250            IF PI-689-TYPE EQUAL LOW-VALUES OR SPACES
 14251                MOVE ER-7378                TO EMI-ERROR
 14252                MOVE -1                     TO TYPEL
 14253                MOVE AL-UNBON               TO TYPEA
 14254                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 294
* EL689.cbl
 14255                GO TO 8200-SEND-DATAONLY
 14256            ELSE
 14257                MOVE ER-2114                TO EMI-ERROR
 14258                MOVE -1                     TO ADDRSL
 14259                MOVE AL-UNBON               TO ADDRSA
 14260                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14261                GO TO 8200-SEND-DATAONLY.
 14262
 14263 6600-EXIT.
 14264     EXIT.
 14265 6620-GET-G-DATA.
 14266
 14267     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY.
 14268
 14269     IF  CO-RPTCD2 GREATER THAN SPACES
 14270         MOVE SPACES             TO W-COMP-RESP-PERSON
 14271         MOVE CO-RPTCD2          TO W-COMP-WORK-AREA
 14272         MOVE +10                TO W-CWA-NDX
 14273         PERFORM 6622-FIND-LAST-NON-SPACE
 14274         SET W-COMP-NDX          TO +10
 14275         PERFORM 6625-FILL-IN-RESP-PERSON.
 14276         INSPECT W-COMP-RESP-PERSON CONVERTING SPACES TO ZEROS.
 14277
 14278     MOVE LOW-VALUES             TO W-COMP-ACCOUNT.
 14279     MOVE 'G'                    TO W-COMP-TYPE.
 14280     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY.
 14281
 14282
 14283* EXEC CICS RESETBR
 14284*         RIDFLD  (W-COMP-KEY)
 14285*         DATASET (W-COMP-FILE-ID)
 14286*    END-EXEC.
 14287     MOVE 0
 14288       TO DFHEIV11
 14289*    MOVE '&4         G          &   #00013396' TO DFHEIV0
 14290     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 14291     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14292     MOVE X'2020233030303133333936' TO DFHEIV0(25:11)
 14293     CALL 'kxdfhei1' USING DFHEIV0,
 14294           W-COMP-FILE-ID,
 14295           W-COMP-KEY,
 14296           DFHEIV99,
 14297           DFHEIV11,
 14298           DFHEIV99
 14299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14300
 14301
 14302
 14303* EXEC CICS READNEXT
 14304*         DATASET (W-COMP-FILE-ID)
 14305*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14306*         RIDFLD  (W-COMP-KEY)
 14307*    END-EXEC.
 14308     MOVE 0
 14309       TO DFHEIV11
 14310*    MOVE '&.S                   )   #00013401' TO DFHEIV0
 14311     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14312     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 295
* EL689.cbl
 14313     MOVE X'2020233030303133343031' TO DFHEIV0(25:11)
 14314     CALL 'kxdfhei1' USING DFHEIV0,
 14315           W-COMP-FILE-ID,
 14316           DFHEIV20,
 14317           DFHEIV99,
 14318           W-COMP-KEY,
 14319           DFHEIV99,
 14320           DFHEIV11,
 14321           DFHEIV99,
 14322           DFHEIV99
 14323     SET ADDRESS OF COMPENSATION-MASTER TO
 14324         DFHEIV20
 14325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14326
 14327
 14328     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 14329         GO TO 6620-EXIT.
 14330
 14331     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14332     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 14333     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14334     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14335     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14336*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14337     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14338        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14339     END-STRING
 14340
 14341     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14342
 14343     IF  CO-CANADIAN-POST-CODE
 14344         MOVE CO-CANADIAN-POSTAL-CODE
 14345                                 TO W-CANADIAN-POSTAL-CODES
 14346         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14347         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14348         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14349                                    W-LAB-CAN-FILLER (6)
 14350     ELSE
 14351         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14352         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14353             MOVE '-'            TO W-LABEL-DASH (6)
 14354             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14355         ELSE
 14356             MOVE SPACES         TO W-LABEL-DASH (6)
 14357                                    W-LABEL-2ND-ZIP (6).
 14358
 14359     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14360
 14361     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (174).
 14362     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (175).
 14363     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (176).
 14364     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (177).
 14365     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (178).
 14366     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (179).
 14367
 14368 6620-EXIT.
 14369     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 296
* EL689.cbl
 14371 6622-FIND-LAST-NON-SPACE.
 14372
 14373     IF  W-CWA-CHAR (W-CWA-NDX) EQUAL SPACES
 14374         SUBTRACT +1 FROM W-CWA-NDX
 14375         GO TO 6622-FIND-LAST-NON-SPACE.
 14376
 14377 6622-EXIT.
 14378     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 297
* EL689.cbl
 14380 6625-FILL-IN-RESP-PERSON.
 14381
 14382     MOVE W-CWA-CHAR (W-CWA-NDX) TO W-COMP-RP-CHAR (W-COMP-NDX)
 14383     SET W-COMP-NDX DOWN BY +1.
 14384     SUBTRACT +1 FROM W-CWA-NDX.
 14385
 14386     IF  W-CWA-NDX GREATER THAN ZEROS
 14387         GO TO 6625-FILL-IN-RESP-PERSON.
 14388
 14389 6625-EXIT.
 14390     EXIT.
 14391 6626-GET-B-DATA.
 14392     MOVE W-COMP-SAVE-KEY        TO W-COMP-KEY
 14393     IF W-FILE-USED (8)
 14394        PERFORM 6450-READ-CERT-ONLY
 14395        IF W-CERT-FOUND
 14396           MOVE CM-BENEFICIARY (1:10)
 14397                                 TO W-COMP-RESP-PERSON
 14398        ELSE
 14399           MOVE SPACES           TO W-COMP-RESP-PERSON
 14400           GO TO 6626-EXIT
 14401        END-IF
 14402     ELSE
 14403        MOVE CM-BENEFICIARY (1:10)
 14404                                 TO W-COMP-RESP-PERSON
 14405     END-IF
 14406     MOVE LOW-VALUES             TO W-COMP-ACCOUNT
 14407     MOVE 'B'                    TO W-COMP-TYPE
 14408     MOVE W-COMP-KEY             TO W-COMP-SAVE-KEY
 14409
 14410
 14411* EXEC CICS RESETBR
 14412*         RIDFLD  (W-COMP-KEY)
 14413*         DATASET (W-COMP-FILE-ID)
 14414*    END-EXEC.
 14415     MOVE 0
 14416       TO DFHEIV11
 14417*    MOVE '&4         G          &   #00013489' TO DFHEIV0
 14418     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
 14419     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 14420     MOVE X'2020233030303133343839' TO DFHEIV0(25:11)
 14421     CALL 'kxdfhei1' USING DFHEIV0,
 14422           W-COMP-FILE-ID,
 14423           W-COMP-KEY,
 14424           DFHEIV99,
 14425           DFHEIV11,
 14426           DFHEIV99
 14427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14428
 14429
 14430
 14431* EXEC CICS READNEXT
 14432*         DATASET (W-COMP-FILE-ID)
 14433*         SET     (ADDRESS OF COMPENSATION-MASTER)
 14434*         RIDFLD  (W-COMP-KEY)
 14435*    END-EXEC.
 14436     MOVE 0
 14437       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 298
* EL689.cbl
 14438*    MOVE '&.S                   )   #00013494' TO DFHEIV0
 14439     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
 14440     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
 14441     MOVE X'2020233030303133343934' TO DFHEIV0(25:11)
 14442     CALL 'kxdfhei1' USING DFHEIV0,
 14443           W-COMP-FILE-ID,
 14444           DFHEIV20,
 14445           DFHEIV99,
 14446           W-COMP-KEY,
 14447           DFHEIV99,
 14448           DFHEIV11,
 14449           DFHEIV99,
 14450           DFHEIV99
 14451     SET ADDRESS OF COMPENSATION-MASTER TO
 14452         DFHEIV20
 14453     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14454
 14455
 14456     IF  CO-CONTROL-PRIMARY NOT = W-COMP-SAVE-KEY
 14457         GO TO 6626-EXIT.
 14458
 14459     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14460     MOVE CO-ACCT-NAME           TO W-LABEL-LINES (1).
 14461     MOVE CO-MAIL-NAME           TO W-LABEL-LINES (2).
 14462     MOVE CO-ADDR-1              TO W-LABEL-LINES (3).
 14463     MOVE CO-ADDR-2              TO W-LABEL-LINES (4).
 14464*    MOVE CO-ADDR-3              TO W-LABEL-LINES (5).
 14465     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
 14466        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14467     END-STRING
 14468
 14469     MOVE CO-ZIP                 TO W-WORK-ZIP.
 14470
 14471     IF  CO-CANADIAN-POST-CODE
 14472         MOVE CO-CANADIAN-POSTAL-CODE
 14473                                 TO W-CANADIAN-POSTAL-CODES
 14474         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14475         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14476         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14477                                    W-LAB-CAN-FILLER (6)
 14478     ELSE
 14479         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14480         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14481             MOVE '-'            TO W-LABEL-DASH (6)
 14482             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14483         ELSE
 14484             MOVE SPACES         TO W-LABEL-DASH (6)
 14485                                    W-LABEL-2ND-ZIP (6).
 14486
 14487     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14488
 14489     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (184).
 14490     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (185).
 14491     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (186).
 14492     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (187).
 14493     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (188).
 14494     MOVE W-LABEL-LINES (6)      TO W-VG-TEXT (189).
 14495
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 299
* EL689.cbl
 14496 6626-EXIT.
 14497     EXIT.
 14498 6630-GET-CSR-NAME.
 14499
 14500     MOVE SPACES                 TO W-CNTL-KEY.
 14501     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
 14502     MOVE +0                     TO W-CNTL-SEQ-NO.
 14503     MOVE '2'                    TO W-CNTL-RECORD-TYPE.
 14504     MOVE CO-CSR-CODE            TO W-CNTL-GENL.
 14505
 14506
 14507* EXEC CICS HANDLE CONDITION
 14508*         NOTOPEN    (8040-CNTL-NOT-OPEN)
 14509*         NOTFND     (6630-CNTL2-NOT-FOUND)
 14510*    END-EXEC.
 14511*    MOVE '"$JI                  ! 3 #00013550' TO DFHEIV0
 14512     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14513     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14514     MOVE X'3320233030303133353530' TO DFHEIV0(25:11)
 14515     CALL 'kxdfhei1' USING DFHEIV0
 14516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14517
 14518
 14519
 14520* EXEC CICS READ
 14521*         DATASET    (W-CNTL-FILE-ID)
 14522*         SET        (ADDRESS OF CONTROL-FILE)
 14523*         RIDFLD     (W-CNTL-KEY)
 14524*    END-EXEC.
 14525*    MOVE '&"S        E          (   #00013555' TO DFHEIV0
 14526     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14527     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14528     MOVE X'2020233030303133353535' TO DFHEIV0(25:11)
 14529     CALL 'kxdfhei1' USING DFHEIV0,
 14530           W-CNTL-FILE-ID,
 14531           DFHEIV20,
 14532           DFHEIV99,
 14533           W-CNTL-KEY,
 14534           DFHEIV99,
 14535           DFHEIV99,
 14536           DFHEIV99
 14537     SET ADDRESS OF CONTROL-FILE TO
 14538         DFHEIV20
 14539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14540
 14541
 14542     MOVE CF-PROCESSOR-NAME      TO W-VG-TEXT (148).
 14543     MOVE CF-PROCESSOR-TITLE     TO W-VG-TEXT (154)
 14544     GO TO 6630-EXIT.
 14545
 14546 6630-CNTL2-NOT-FOUND.
 14547
 14548*    MOVE ER-8965                TO EMI-ERROR.
 14549*    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 14550*    MOVE -1                     TO MAINTL.
 14551*    MOVE AL-UANON               TO MAINTA.
 14552*    GO TO 8200-SEND-DATAONLY
 14553     .
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 300
* EL689.cbl
 14554 6630-EXIT.
 14555     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 301
* EL689.cbl
 14557 6700-GET-MAIL-DATA.
 14558
 14559     IF  ADDRSI EQUAL '5'
 14560             AND
 14561         PI-CREATE-LABELS
 14562             AND
 14563         NOT PI-689-LABELS-OVERRIDEN
 14564         NEXT SENTENCE
 14565     ELSE
 14566         IF  W-FILE-NOT-USED (5)
 14567             GO TO 6700-EXIT.
 14568
 14569     IF  W-MAIL-CERT-NO EQUAL LOW-VALUES
 14570         MOVE ER-9327            TO EMI-ERROR
 14571         MOVE -1                 TO MAINTL
 14572         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14573         GO TO 6700-EXIT.
 14574
 14575
 14576* EXEC CICS HANDLE CONDITION
 14577*         NOTOPEN (8090-MAIL-NOT-OPEN)
 14578*         NOTFND  (6700-MAIL-NOT-FOUND)
 14579*    END-EXEC.
 14580*    MOVE '"$JI                  ! 4 #00013594' TO DFHEIV0
 14581     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14582     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14583     MOVE X'3420233030303133353934' TO DFHEIV0(25:11)
 14584     CALL 'kxdfhei1' USING DFHEIV0
 14585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14586
 14587
 14588
 14589* EXEC CICS READ
 14590*         DATASET(W-MAIL-FILE-ID)
 14591*         SET    (ADDRESS OF MAILING-DATA)
 14592*         RIDFLD (W-MAIL-KEY)
 14593*    END-EXEC.
 14594*    MOVE '&"S        E          (   #00013599' TO DFHEIV0
 14595     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14596     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14597     MOVE X'2020233030303133353939' TO DFHEIV0(25:11)
 14598     CALL 'kxdfhei1' USING DFHEIV0,
 14599           W-MAIL-FILE-ID,
 14600           DFHEIV20,
 14601           DFHEIV99,
 14602           W-MAIL-KEY,
 14603           DFHEIV99,
 14604           DFHEIV99,
 14605           DFHEIV99
 14606     SET ADDRESS OF MAILING-DATA TO
 14607         DFHEIV20
 14608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14609
 14610
 14611     MOVE MA-INSURED-LAST-NAME   TO W-NAME-LAST.
 14612     MOVE MA-INSURED-FIRST-NAME  TO W-NAME-FIRST.
 14613     MOVE MA-INSURED-MIDDLE-INIT TO W-NAME-MIDDLE.
 14614     PERFORM 7200-FORMAT-NAME-STRAIGHT THRU 7200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 302
* EL689.cbl
 14615
 14616     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14617     MOVE WS-NAME-WORK           TO W-LABEL-LINES (1).
 14618     MOVE W-LABEL-JOINT-NAME     TO W-LABEL-LINES (2).
 14619     MOVE MA-ADDRESS-LINE-1      TO W-LABEL-LINES (3).
 14620     MOVE MA-ADDRESS-LINE-2      TO W-LABEL-LINES (4).
 14621*    MOVE MA-CITY-STATE          TO W-LABEL-LINES (5).
 14622     STRING MA-CITY ' ' MA-ADDR-STATE
 14623        DELIMITED BY '  ' INTO W-LABEL-LINES (5)
 14624     END-STRING
 14625
 14626     MOVE MA-ZIP                 TO W-WORK-ZIP.
 14627     MOVE SPACES                 TO W-LABEL-ZIP (6).
 14628
 14629     IF  MA-CANADIAN-POST-CODE
 14630         MOVE MA-CANADIAN-POSTAL-CODE
 14631                                 TO W-CANADIAN-POSTAL-CODES
 14632         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 14633         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 14634         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 14635                                    W-LAB-CAN-FILLER (6)
 14636     ELSE
 14637         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 14638         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14639             MOVE '-'            TO W-LABEL-DASH (6)
 14640             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 14641         ELSE
 14642             MOVE SPACES         TO W-LABEL-DASH (6)
 14643                                    W-LABEL-2ND-ZIP (6).
 14644
 14645     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 14646
 14647     IF  ADDRSI EQUAL '5'
 14648             AND
 14649         PI-CREATE-LABELS
 14650             AND
 14651         NOT PI-689-LABELS-OVERRIDEN
 14652         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 14653                                    W-VG-TEXT (31)
 14654         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 14655                                    W-VG-TEXT (32)
 14656         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 14657                                    W-VG-TEXT (33)
 14658         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 14659                                    W-VG-TEXT (34)
 14660         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 14661                                    W-VG-TEXT (35)
 14662         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 14663                                    W-VG-TEXT (36)
 14664         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 14665         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 14666         SET W-RG-NDX UP BY +1
 14667     ELSE
 14668         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (31)
 14669         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (32)
 14670         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (33)
 14671         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (34)
 14672         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (35)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 303
* EL689.cbl
 14673         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (36).
 14674     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 14675     MOVE MA-CRED-BENE-NAME      TO W-LABEL-LINES (1)
 14676     MOVE MA-CRED-BENE-ADDR      TO W-LABEL-LINES (2)
 14677     MOVE MA-CRED-BENE-ADDR2     TO W-LABEL-LINES (3)
 14678     STRING MA-CRED-BENE-CITY ' ' MA-CRED-BENE-STATE
 14679        DELIMITED BY '  ' INTO W-LABEL-LINES (4)
 14680     END-STRING
 14681
 14682     MOVE MA-CRED-BENE-ZIP       TO W-WORK-ZIP
 14683     MOVE SPACES                 TO W-LABEL-ZIP (5)
 14684
 14685     IF  MA-CB-CANADIAN-POST-CODE
 14686         MOVE MA-CB-CANADIAN-POSTAL-CODE
 14687                                 TO W-CANADIAN-POSTAL-CODES
 14688         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (5)
 14689         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (5)
 14690         MOVE SPACES             TO W-LAB-CAN-DASH (5)
 14691                                    W-LAB-CAN-FILLER (5)
 14692     ELSE
 14693         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (5)
 14694         IF  W-WORK-ZIP4 GREATER THAN '0000'
 14695             MOVE '-'            TO W-LABEL-DASH (5)
 14696             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (5)
 14697         ELSE
 14698             MOVE SPACES         TO W-LABEL-DASH (5)
 14699                                    W-LABEL-2ND-ZIP (5)
 14700         END-IF
 14701     END-IF
 14702     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT
 14703     MOVE W-LABEL-LINES (1)      TO W-VG-TEXT (37)
 14704     MOVE W-LABEL-LINES (2)      TO W-VG-TEXT (50)
 14705     MOVE W-LABEL-LINES (3)      TO W-VG-TEXT (51)
 14706     MOVE W-LABEL-LINES (4)      TO W-VG-TEXT (52)
 14707     MOVE W-LABEL-LINES (5)      TO W-VG-TEXT (53)
 14708     GO TO 6700-EXIT.
 14709
 14710 6700-MAIL-NOT-FOUND.
 14711
 14712     IF  ADDRSL GREATER ZERO
 14713         IF ADDRSI = '5'
 14714            MOVE ER-3000         TO EMI-ERROR
 14715            MOVE -1              TO ADDRSL
 14716            MOVE AL-UNBON        TO ADDRSA
 14717            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14718            GO TO 8200-SEND-DATAONLY.
 14719
 14720 6700-EXIT.
 14721     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 304
* EL689.cbl
 14723 6750-GET-LIFE-BENEFIT-DATA.
 14724
 14725     IF  W-FILE-NOT-USED (2)
 14726         GO TO 6750-EXIT.
 14727
 14728     MOVE SPACES                 TO W-CNTL-GEN2.
 14729
 14730     IF  DATASORI EQUAL '2'
 14731         IF  W-FILE-NOT-USED (8)
 14732             PERFORM 6450-READ-CERT-ONLY
 14733             IF  W-CERT-FOUND
 14734                 MOVE CM-LF-BENEFIT-CD
 14735                                 TO W-BEN-HOLD
 14736                                    W-CNTL-GEN2
 14737             ELSE
 14738                 NEXT SENTENCE
 14739         ELSE
 14740             MOVE CM-LF-BENEFIT-CD
 14741                                 TO W-BEN-HOLD
 14742                                    W-CNTL-GEN2
 14743     ELSE
 14744         IF  DATASORI EQUAL '4'
 14745             IF  W-FILE-NOT-USED (9)
 14746                 PERFORM 6400-READ-PNDB-ONLY
 14747                 IF  W-PNDB-FOUND
 14748                     IF  PI-689-TYPE = '1'
 14749                         MOVE PB-I-LF-BENEFIT-CD
 14750                                 TO W-BEN-HOLD
 14751                                    W-CNTL-GEN2
 14752                     ELSE
 14753                         MOVE PB-CI-LF-BENEFIT-CD
 14754                                 TO W-BEN-HOLD
 14755                                    W-CNTL-GEN2
 14756             ELSE
 14757                 NEXT SENTENCE
 14758         ELSE
 14759             IF  W-FILE-USED (8)
 14760                 MOVE CM-LF-BENEFIT-CD
 14761                                 TO W-BEN-HOLD
 14762                                    W-CNTL-GEN2
 14763             ELSE
 14764                 IF  W-FILE-USED (9)
 14765                     IF  PI-689-TYPE = '1'
 14766                         MOVE PB-I-LF-BENEFIT-CD
 14767                                 TO W-BEN-HOLD
 14768                                    W-CNTL-GEN2
 14769                     ELSE
 14770                         MOVE PB-CI-LF-BENEFIT-CD
 14771                                 TO W-BEN-HOLD
 14772                                    W-CNTL-GEN2.
 14773
 14774     IF  W-CNTL-GEN2 EQUAL SPACES
 14775         MOVE ER-9327            TO EMI-ERROR
 14776         MOVE -1                 TO MAINTL
 14777         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14778         GO TO 6750-EXIT.
 14779
 14780     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 305
* EL689.cbl
 14781     MOVE '4'                    TO W-CNTL-RECORD-TYPE.
 14782     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14783
 14784
 14785* EXEC CICS HANDLE CONDITION
 14786*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14787*         NOTFND  (6750-EXIT)
 14788*    END-EXEC.
 14789*    MOVE '"$JI                  ! 5 #00013778' TO DFHEIV0
 14790     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14791     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14792     MOVE X'3520233030303133373738' TO DFHEIV0(25:11)
 14793     CALL 'kxdfhei1' USING DFHEIV0
 14794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14795
 14796
 14797
 14798* EXEC CICS READ
 14799*         DATASET (W-CNTL-FILE-ID)
 14800*         SET     (ADDRESS OF CONTROL-FILE)
 14801*         GTEQ
 14802*         RIDFLD  (W-CNTL-KEY)
 14803*    END-EXEC.
 14804*    MOVE '&"S        G          (   #00013783' TO DFHEIV0
 14805     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14806     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14807     MOVE X'2020233030303133373833' TO DFHEIV0(25:11)
 14808     CALL 'kxdfhei1' USING DFHEIV0,
 14809           W-CNTL-FILE-ID,
 14810           DFHEIV20,
 14811           DFHEIV99,
 14812           W-CNTL-KEY,
 14813           DFHEIV99,
 14814           DFHEIV99,
 14815           DFHEIV99
 14816     SET ADDRESS OF CONTROL-FILE TO
 14817         DFHEIV20
 14818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14819
 14820
 14821     MOVE 1                      TO W-NDX.
 14822
 14823 6750-LOOP.
 14824
 14825     IF  W-NDX = 9
 14826         GO TO 6750-EXIT.
 14827
 14828     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14829         ADD 1                   TO W-NDX
 14830         GO TO 6750-LOOP.
 14831
 14832     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14833         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14834                                 TO W-VG-TEXT (11).
 14835
 14836 6750-EXIT.
 14837     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 306
* EL689.cbl
 14839 6800-GET-A-H-BENEFIT-DATA.
 14840
 14841     IF  W-FILE-NOT-USED (3)
 14842         GO TO 6800-EXIT.
 14843
 14844     MOVE SPACES                 TO W-CNTL-GEN2.
 14845
 14846     IF  DATASORI EQUAL '2'
 14847         IF  W-FILE-NOT-USED (8)
 14848             PERFORM 6450-READ-CERT-ONLY
 14849             IF  W-CERT-FOUND
 14850                 MOVE CM-AH-BENEFIT-CD
 14851                                 TO W-BEN-HOLD
 14852                                    W-CNTL-GEN2
 14853             ELSE
 14854                 NEXT SENTENCE
 14855         ELSE
 14856             MOVE CM-AH-BENEFIT-CD
 14857                                 TO W-BEN-HOLD
 14858                                    W-CNTL-GEN2
 14859     ELSE
 14860         IF  DATASORI EQUAL '4'
 14861             IF  W-FILE-NOT-USED (9)
 14862                 PERFORM 6400-READ-PNDB-ONLY
 14863                 IF  W-PNDB-FOUND
 14864                     IF  PI-689-TYPE = '1'
 14865                         MOVE PB-I-AH-BENEFIT-CD
 14866                                 TO W-BEN-HOLD
 14867                                    W-CNTL-GEN2
 14868                     ELSE
 14869                         MOVE PB-CI-AH-BENEFIT-CD
 14870                                 TO W-BEN-HOLD
 14871                                    W-CNTL-GEN2
 14872             ELSE
 14873                 NEXT SENTENCE
 14874         ELSE
 14875             IF  W-FILE-USED (8)
 14876                 MOVE CM-AH-BENEFIT-CD
 14877                                 TO W-BEN-HOLD
 14878                                    W-CNTL-GEN2
 14879             ELSE
 14880                 IF  W-FILE-USED (9)
 14881                     IF  PI-689-TYPE = '1'
 14882                         MOVE PB-I-AH-BENEFIT-CD
 14883                                 TO W-BEN-HOLD
 14884                                    W-CNTL-GEN2
 14885                     ELSE
 14886                         MOVE PB-CI-AH-BENEFIT-CD
 14887                                 TO W-BEN-HOLD
 14888                                    W-CNTL-GEN2.
 14889
 14890     IF  W-CNTL-GEN2 EQUAL SPACES
 14891         MOVE ER-9327            TO EMI-ERROR
 14892         MOVE -1                 TO MAINTL
 14893         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14894         GO TO 6800-EXIT.
 14895
 14896     MOVE SPACES                 TO W-CNTL-GEN1.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 307
* EL689.cbl
 14897     MOVE '5'                    TO W-CNTL-RECORD-TYPE.
 14898     MOVE ZEROS                  TO W-CNTL-SEQ-NO.
 14899
 14900
 14901* EXEC CICS HANDLE CONDITION
 14902*         NOTOPEN (8040-CNTL-NOT-OPEN)
 14903*         NOTFND  (6800-EXIT)
 14904*    END-EXEC.
 14905*    MOVE '"$JI                  ! 6 #00013869' TO DFHEIV0
 14906     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14907     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14908     MOVE X'3620233030303133383639' TO DFHEIV0(25:11)
 14909     CALL 'kxdfhei1' USING DFHEIV0
 14910     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14911
 14912
 14913
 14914* EXEC CICS READ
 14915*         DATASET (W-CNTL-FILE-ID)
 14916*         SET     (ADDRESS OF CONTROL-FILE)
 14917*         RIDFLD  (W-CNTL-KEY)
 14918*         GTEQ
 14919*    END-EXEC.
 14920*    MOVE '&"S        G          (   #00013874' TO DFHEIV0
 14921     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 14922     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14923     MOVE X'2020233030303133383734' TO DFHEIV0(25:11)
 14924     CALL 'kxdfhei1' USING DFHEIV0,
 14925           W-CNTL-FILE-ID,
 14926           DFHEIV20,
 14927           DFHEIV99,
 14928           W-CNTL-KEY,
 14929           DFHEIV99,
 14930           DFHEIV99,
 14931           DFHEIV99
 14932     SET ADDRESS OF CONTROL-FILE TO
 14933         DFHEIV20
 14934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14935
 14936
 14937     MOVE 1                      TO W-NDX.
 14938
 14939 6800-LOOP-AH.
 14940
 14941     IF  W-NDX = 9
 14942         GO TO 6800-EXIT.
 14943
 14944     IF  CF-BENEFIT-CODE (W-NDX) LESS W-BEN-HOLD
 14945         ADD 1                   TO W-NDX
 14946         GO TO 6800-LOOP-AH.
 14947
 14948     IF  W-BEN-HOLD = CF-BENEFIT-CODE (W-NDX)
 14949         MOVE CF-BENEFIT-DESCRIP (W-NDX)
 14950                                 TO W-VG-TEXT (15)
 14951         MOVE CF-BENEFIT-ALPHA (W-NDX)
 14952                                 TO W-BENEFIT-WORK
 14953         MOVE W-ELIM-DAYS        TO W-VG-TEXT (16).
 14954
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 308
* EL689.cbl
 14955 6800-EXIT.
 14956     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 309
* EL689.cbl
 14958 6850-GET-CHECK-DATA.
 14959
 14960     IF  ADDRSI EQUAL '6'
 14961             AND
 14962         PI-CREATE-LABELS
 14963             AND
 14964         NOT PI-689-LABELS-OVERRIDEN
 14965         NEXT SENTENCE
 14966     ELSE
 14967         IF  W-FILE-NOT-USED (12)
 14968             GO TO 6850-EXIT.
 14969
 14970     IF  W-CHEK-CERT-NO EQUAL LOW-VALUES
 14971         MOVE ER-9327            TO EMI-ERROR
 14972         MOVE -1                 TO MAINTL
 14973         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 14974         GO TO 6850-EXIT.
 14975
 14976
 14977* EXEC CICS HANDLE CONDITION
 14978*         NOTOPEN (8045-CHEK-NOT-OPEN)
 14979*         NOTFND  (6850-CHEK-NOT-FOUND)
 14980*    END-EXEC.
 14981*    MOVE '"$JI                  ! 7 #00013920' TO DFHEIV0
 14982     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 14983     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 14984     MOVE X'3720233030303133393230' TO DFHEIV0(25:11)
 14985     CALL 'kxdfhei1' USING DFHEIV0
 14986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 14987
 14988
 14989
 14990* EXEC CICS READ
 14991*         DATASET (W-CHEK-FILE-ID)
 14992*         SET     (ADDRESS OF CHECK-RECORDS)
 14993*         RIDFLD  (W-CHEK-KEY)
 14994*    END-EXEC.
 14995*    MOVE '&"S        E          (   #00013925' TO DFHEIV0
 14996     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 14997     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 14998     MOVE X'2020233030303133393235' TO DFHEIV0(25:11)
 14999     CALL 'kxdfhei1' USING DFHEIV0,
 15000           W-CHEK-FILE-ID,
 15001           DFHEIV20,
 15002           DFHEIV99,
 15003           W-CHEK-KEY,
 15004           DFHEIV99,
 15005           DFHEIV99,
 15006           DFHEIV99
 15007     SET ADDRESS OF CHECK-RECORDS TO
 15008         DFHEIV20
 15009     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15010
 15011
 15012     MOVE CH-CHECK-NO            TO W-VG-TEXT (158).
 15013     MOVE CH-AMOUNT-PAID         TO W-EDIT-7-2.
 15014     MOVE W-EDIT-7-2             TO W-VG-TEXT (157).
 15015     MOVE CH-CHECK-QUE-CONTROL   TO W-DISPLAY-8
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 310
* EL689.cbl
 15016                                    PI-689-CONTROL.
 15017     MOVE W-DISPLAY-8            TO W-VG-TEXT (165).
 15018     MOVE CH-REASON-FOR-CHECK    TO W-VG-TEXT (166).
 15019
 15020     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
 15021     MOVE CH-PAYEE-NAME-1        TO W-LABEL-LINES (1).
 15022     MOVE CH-PAYEE-NAME-2        TO W-LABEL-LINES (2).
 15023     MOVE CH-PAYEE-ADDRESS-1     TO W-LABEL-LINES (3).
 15024     MOVE CH-PAYEE-ADDRESS-2     TO W-LABEL-LINES (4).
 15025     MOVE CH-PAYEE-CITY-ST       TO W-LABEL-LINES (5).
 15026
 15027     MOVE CH-PAYEE-ZIP           TO W-WORK-ZIP.
 15028     MOVE SPACES                 TO W-LABEL-ZIP (6).
 15029
 15030     IF  CH-CANADIAN-POST-CODE
 15031         MOVE CH-CANADIAN-POSTAL-CODE
 15032                                 TO W-CANADIAN-POSTAL-CODES
 15033         MOVE W-CAN-POSTAL-CD-1  TO W-LAB-CAN-POSTAL-CD-1 (6)
 15034         MOVE W-CAN-POSTAL-CD-2  TO W-LAB-CAN-POSTAL-CD-2 (6)
 15035         MOVE SPACES             TO W-LAB-CAN-DASH (6)
 15036                                    W-LAB-CAN-FILLER (6)
 15037     ELSE
 15038         MOVE W-WORK-ZIP5        TO W-LABEL-1ST-ZIP (6)
 15039         IF  W-WORK-ZIP4 GREATER THAN '0000'
 15040             MOVE '-'            TO W-LABEL-DASH (6)
 15041             MOVE W-WORK-ZIP4    TO W-LABEL-2ND-ZIP (6)
 15042         ELSE
 15043             MOVE SPACES         TO W-LABEL-DASH (6)
 15044                                    W-LABEL-2ND-ZIP (6).
 15045
 15046     PERFORM 7300-LABEL-MOVE THRU 7300-EXIT.
 15047
 15048     IF  ADDRSI EQUAL '6'
 15049             AND
 15050         PI-CREATE-LABELS
 15051             AND
 15052         NOT PI-689-LABELS-OVERRIDEN
 15053         MOVE W-LABEL-LINES (1)  TO W-RC-TEXT (1)
 15054                                    W-VG-TEXT (159)
 15055         MOVE W-LABEL-LINES (2)  TO W-RC-TEXT (2)
 15056                                    W-VG-TEXT (160)
 15057         MOVE W-LABEL-LINES (3)  TO W-RC-TEXT (3)
 15058                                    W-VG-TEXT (161)
 15059         MOVE W-LABEL-LINES (4)  TO W-RC-TEXT (4)
 15060                                    W-VG-TEXT (162)
 15061         MOVE W-LABEL-LINES (5)  TO W-RC-TEXT (5)
 15062                                    W-VG-TEXT (163)
 15063         MOVE W-LABEL-LINES (6)  TO W-RC-TEXT (6)
 15064                                    W-VG-TEXT (164)
 15065         MOVE W-NUMB-LABEL-LINES TO PI-689-NUMBER-LABEL-LINES
 15066         SET W-RG-NDX            TO PI-689-NUMBER-LABEL-LINES
 15067         SET W-RG-NDX UP BY +1
 15068     ELSE
 15069         MOVE W-LABEL-LINES (1)  TO W-VG-TEXT (159)
 15070         MOVE W-LABEL-LINES (2)  TO W-VG-TEXT (160)
 15071         MOVE W-LABEL-LINES (3)  TO W-VG-TEXT (161)
 15072         MOVE W-LABEL-LINES (4)  TO W-VG-TEXT (162)
 15073         MOVE W-LABEL-LINES (5)  TO W-VG-TEXT (163)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 311
* EL689.cbl
 15074         MOVE W-LABEL-LINES (6)  TO W-VG-TEXT (164).
 15075
 15076     GO TO 6850-EXIT.
 15077
 15078 6850-CHEK-NOT-FOUND.
 15079
 15080     IF  ADDRSL GREATER ZERO
 15081         IF ADDRSI = '6'
 15082            MOVE ER-2908         TO EMI-ERROR
 15083            MOVE -1              TO ADDRSL
 15084            MOVE AL-UNBON        TO ADDRSA
 15085            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15086            GO TO 8200-SEND-DATAONLY.
 15087
 15088 6850-EXIT.
 15089     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 312
* EL689.cbl
 15091 6900-GET-PYAJ-DATA.
 15092
 15093     IF  W-FILE-NOT-USED (13)
 15094         GO TO 6900-EXIT.
 15095
 15096     IF  W-PYAJ-FIN-RESP EQUAL LOW-VALUES
 15097         MOVE ER-9327            TO EMI-ERROR
 15098         MOVE -1                 TO MAINTL
 15099         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15100         GO TO 6900-EXIT.
 15101
 15102
 15103* EXEC CICS HANDLE CONDITION
 15104*         NOTOPEN (8085-PYAJ-NOT-OPEN)
 15105*         NOTFND  (6900-PYAJ-NOT-FOUND)
 15106*    END-EXEC.
 15107*    MOVE '"$JI                  ! 8 #00014021' TO DFHEIV0
 15108     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 15109     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 15110     MOVE X'3820233030303134303231' TO DFHEIV0(25:11)
 15111     CALL 'kxdfhei1' USING DFHEIV0
 15112     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15113
 15114
 15115 6900-READ-NEXT.
 15116
 15117
 15118* EXEC CICS READ
 15119*         DATASET (W-PYAJ-FILE-ID)
 15120*         SET     (ADDRESS OF PENDING-PAY-ADJ)
 15121*         RIDFLD  (W-PYAJ-KEY)
 15122*         GTEQ
 15123*    END-EXEC.
 15124*    MOVE '&"S        G          (   #00014028' TO DFHEIV0
 15125     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
 15126     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 15127     MOVE X'2020233030303134303238' TO DFHEIV0(25:11)
 15128     CALL 'kxdfhei1' USING DFHEIV0,
 15129           W-PYAJ-FILE-ID,
 15130           DFHEIV20,
 15131           DFHEIV99,
 15132           W-PYAJ-KEY,
 15133           DFHEIV99,
 15134           DFHEIV99,
 15135           DFHEIV99
 15136     SET ADDRESS OF PENDING-PAY-ADJ TO
 15137         DFHEIV20
 15138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 15139
 15140
 15141     IF  PY-COMPANY-CD NOT EQUAL W-PYAJ-COMPANY-CD
 15142             OR
 15143         PY-CARRIER NOT EQUAL W-PYAJ-CARRIER
 15144             OR
 15145         PY-GROUPING NOT EQUAL W-PYAJ-GROUPING
 15146             OR
 15147         PY-FIN-RESP NOT EQUAL W-PYAJ-FIN-RESP
 15148             OR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 313
* EL689.cbl
 15149         PY-ACCOUNT NOT EQUAL W-PYAJ-ACCOUNT
 15150         GO TO 6900-PYAJ-NOT-FOUND.
 15151
 15152     IF  PI-689-SEQ-NO GREATER THAN ZEROS
 15153             AND
 15154         PY-FILE-SEQ-NO NOT EQUAL PI-689-SEQ-NO
 15155         GO TO 6900-PYAJ-NOT-FOUND.
 15156
 15157     IF  PY-RECORD-TYPE NOT EQUAL W-PYAJ-RECORD-TYPE
 15158         MOVE PY-CONTROL-PRIMARY TO W-PYAJ-KEY
 15159         ADD +1                  TO W-PYAJ-FILE-SEQ-NO
 15160         GO TO 6900-READ-NEXT.
 15161
 15162     MOVE PY-CHECK-NUMBER        TO W-DISPLAY-7.
 15163     MOVE W-DISPLAY-7            TO W-VG-TEXT (171).
 15164
 15165     MOVE PY-ENTRY-AMT           TO W-EDIT-7-2.
 15166     MOVE W-EDIT-7-2             TO W-VG-TEXT (170).
 15167
 15168     MOVE PY-CHECK-QUE-CONTROL   TO W-DISPLAY-8
 15169                                    PI-689-CONTROL.
 15170     MOVE W-DISPLAY-8            TO W-VG-TEXT (172).
 15171     MOVE PY-ENTRY-COMMENT       TO W-VG-TEXT (173).
 15172
 15173     GO TO 6900-EXIT.
 15174
 15175 6900-PYAJ-NOT-FOUND.
 15176
 15177     MOVE ER-7395                TO EMI-ERROR
 15178     MOVE -1                     TO DATASORL
 15179     MOVE AL-UNBON               TO DATASORA
 15180     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15181     GO TO 8200-SEND-DATAONLY.
 15182
 15183 6900-EXIT.
 15184     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 314
* EL689.cbl
 15186 6950-MOVE-SYSTEM-DATA.
 15187
 15188     IF  W-FILE-NOT-USED (7)
 15189         GO TO 6950-EXIT.
 15190
 15191     MOVE EIBDATE                TO W-DATE-WORK.
 15192     MOVE W-DT-WORK              TO DC-JULIAN-YYDDD.
 15193     MOVE '5'                    TO DC-OPTION-CODE.
 15194     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
 15195     MOVE DC-GREG-DATE-1-EDIT    TO W-VG-TEXT (60).
 15196     MOVE DC-GREG-DATE-1-ALPHA   TO W-VG-TEXT (61).
 15197
 15198     MOVE FORMI                  TO W-VG-TEXT (62).
 15199
 15200     IF  PI-689-VARIABLE-DATA-1 GREATER THAN SPACES
 15201         MOVE PI-689-VARIABLE-DATA-1
 15202                                 TO W-VG-TEXT (63)
 15203         MOVE PI-689-VARIABLE-DATA-2
 15204                                 TO W-VG-TEXT (64)
 15205         MOVE PI-689-VARIABLE-DATA-3
 15206                                 TO W-VG-TEXT (65)
 15207         MOVE PI-689-VARIABLE-DATA-4
 15208                                 TO W-VG-TEXT (66)
 15209     ELSE
 15210         MOVE '(VARIABLE NOT PROVIDED)'
 15211                                 TO W-VG-TEXT (63).
 15212
 15213 6950-EXIT.
 15214     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 315
* EL689.cbl
 15216 7000-FORMAT-SCREEN.
 15217
 15218     IF  MAINTI EQUAL 'S'
 15219             OR
 15220         PI-SHOW-MODE
 15221         MOVE AL-PANOF           TO W-SC-TEXTA (W-SC-NDX)
 15222     ELSE
 15223         MOVE AL-UANOF           TO W-SC-TEXTA (W-SC-NDX).
 15224
 15225     IF  W-RG-NDX NOT GREATER THAN PI-689-NUMBER-LABEL-LINES
 15226         SET W-LINE23            TO W-RG-NDX
 15227         MOVE 'A'                TO W-LINE1
 15228     ELSE
 15229         SET W-LIN-NUM           TO W-RG-NDX
 15230         COMPUTE W-LIN-NUM
 15231             = W-LIN-NUM - PI-689-NUMBER-LABEL-LINES - 1.
 15232
 15233     MOVE W-LINE-NUM             TO W-SC-LINE (W-SC-NDX).
 15234     MOVE W-RC-TEXT (W-RG-NDX)   TO W-SC-TEXT (W-SC-NDX).
 15235     SET W-RG-NDX UP BY 1.
 15236
 15237 7000-EXIT.
 15238      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 316
* EL689.cbl
 15240 7100-FORMAT-LAST-NAME-1ST.
 15241*****************************************************************
 15242*             M O V E   N A M E   R O U T I N E                 *
 15243*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15244*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15245*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15246*                  FIELD                   VALUE                *
 15247*           W-NAME-LAST    (CL15)      SMITH                    *
 15248*           W-NAME-FIRST   (CL15)      JOHN                     *
 15249*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15250*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15251*     CONTAIN                                                   *
 15252*                SMITH, JOHN ALLEN                              *
 15253*     OR                                                        *
 15254*                SMITH, JOHN A.                                 *
 15255*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15256*     COPYBOOK, ELCNWA.                                         *
 15257*****************************************************************.
 15258
 15259     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15260     MOVE ZERO                   TO WS-NAME-SW.
 15261     SET NWA-INDEX               TO +1.
 15262
 15263     IF  W-NAME-LAST EQUAL SPACES
 15264             AND
 15265         W-NAME-MIDDLE EQUAL SPACES
 15266         MOVE +1                 TO WS-NAME-SW.
 15267
 15268     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15269     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15270
 15271     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15272     PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15273
 15274     SET NWA-INDEX UP BY +1.
 15275
 15276     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 15277         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 15278             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15279             SET NWA-INDEX UP BY +1
 15280             MOVE '.'            TO WS-NW (NWA-INDEX)
 15281             SET NWA-INDEX UP BY +2
 15282         ELSE
 15283             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15284             PERFORM 7110-MOVE-NAME THRU 7110-EXIT.
 15285
 15286 7100-EXIT.
 15287     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 317
* EL689.cbl
 15289 7110-MOVE-NAME.
 15290
 15291     IF  WS-NAME-SW GREATER THAN +1
 15292         GO TO 7110-EXIT.
 15293
 15294     IF  WS-NAME-WORK2 = SPACES
 15295         GO TO 7110-EXIT.
 15296
 15297     SET NWA-INDEX2            TO +1.
 15298     SET NWA-INDEX3            TO +2.
 15299
 15300 7110-MOVE-NAME-CYCLE.
 15301
 15302     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15303
 15304     IF  NWA-INDEX LESS THAN +30
 15305         SET NWA-INDEX UP BY +1
 15306     ELSE
 15307         ADD +2                TO WS-NAME-SW
 15308         GO TO 7110-EXIT.
 15309
 15310     IF  NWA-INDEX2 LESS THAN +20
 15311         SET NWA-INDEX3 UP BY +1
 15312         SET NWA-INDEX2 UP BY +1.
 15313
 15314     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 15315             AND
 15316         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 15317         IF  WS-NAME-SW EQUAL ZERO
 15318             MOVE ','            TO WS-NW (NWA-INDEX)
 15319             SET NWA-INDEX UP BY +2
 15320             MOVE +1             TO WS-NAME-SW
 15321             GO TO 7110-EXIT
 15322         ELSE
 15323             GO TO 7110-EXIT.
 15324
 15325     GO TO 7110-MOVE-NAME-CYCLE.
 15326
 15327 7110-EXIT.
 15328     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 318
* EL689.cbl
 15330 7200-FORMAT-NAME-STRAIGHT.
 15331*****************************************************************
 15332*           M O V E   N A M E   R O U T I N E                   *
 15333*     THE FOLLOWING ROUTINE REARRANGES A GIVEN NAME SO          *
 15334*     THAT IT READS LAST, FIRST, MIDDLE.  PLACE NAME            *
 15335*     FIELDS IN THE FOLLOWING WORKING STORAGE FIELDS.           *
 15336*                  FIELD                   VALUE                *
 15337*           W-NAME-LAST    (CL15)      SMITH                    *
 15338*           W-NAME-FIRST   (CL15)      JOHN                     *
 15339*           W-NAME-MIDDLE  (CL15)      ALLEN/A                  *
 15340*     AFTER NAME HAS BEEN MOVED WS-NAME-WORK (CL30) WILL        *
 15341*     CONTAIN                                                   *
 15342*              JOHN A. SMITH                                    *
 15343*     OR                                                        *
 15344*              JOHN ALLEN SMITH                                 *
 15345*     TO USE THIS ROUTINE YOU NEED THE WORKING STORAGE          *
 15346*     COPYBOOK, ELCNWA.                                         *
 15347*****************************************************************
 15348
 15349     MOVE SPACES                 TO WS-NAME-WORK-AREA.
 15350     MOVE ZERO                   TO WS-NAME-SW.
 15351     SET NWA-INDEX               TO +1.
 15352
 15353     IF  W-NAME-FIRST EQUAL SPACES
 15354             AND
 15355         W-NAME-MIDDLE EQUAL SPACES
 15356         MOVE W-NAME-LAST        TO WS-NAME-WORK
 15357         GO TO 7200-EXIT.
 15358
 15359     MOVE W-NAME-FIRST           TO WS-NAME-WORK2.
 15360     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15361
 15362     IF  W-NAME-MIDDLE NOT EQUAL SPACES
 15363         SET NWA-INDEX UP BY +1
 15364
 15365         IF  W-NAME-MIDDLE-2 EQUAL SPACES
 15366             MOVE W-NAME-MIDDLE  TO WS-NW (NWA-INDEX)
 15367             SET NWA-INDEX UP BY +1
 15368             MOVE '.'            TO WS-NW (NWA-INDEX)
 15369             SET NWA-INDEX UP BY +1
 15370
 15371         ELSE
 15372             MOVE W-NAME-MIDDLE  TO WS-NAME-WORK2
 15373             PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15374
 15375     SET NWA-INDEX UP BY +1
 15376     MOVE W-NAME-LAST            TO WS-NAME-WORK2.
 15377     PERFORM 7290-MOVE-NAME THRU 7290-EXIT.
 15378
 15379 7200-EXIT.
 15380     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 319
* EL689.cbl
 15382 7290-MOVE-NAME.
 15383
 15384     IF  WS-NAME-SW GREATER THAN +1
 15385         GO TO 7290-EXIT.
 15386
 15387     IF  WS-NAME-WORK2 EQUAL SPACES
 15388         GO TO 7290-EXIT.
 15389
 15390     SET NWA-INDEX2            TO +1.
 15391     SET NWA-INDEX3            TO +2.
 15392
 15393 7290-MOVE-NAME-CYCLE.
 15394
 15395     MOVE WS-NW2 (NWA-INDEX2)  TO WS-NW (NWA-INDEX).
 15396
 15397     IF  NWA-INDEX LESS THAN +30
 15398         SET NWA-INDEX UP BY +1
 15399     ELSE
 15400         ADD +2                TO WS-NAME-SW
 15401         GO TO 7290-EXIT.
 15402
 15403     IF  NWA-INDEX2 LESS THAN +20
 15404         SET NWA-INDEX2 UP BY +1
 15405         SET NWA-INDEX3 UP BY +1.
 15406
 15407     IF  WS-NW2 (NWA-INDEX2) EQUAL SPACES
 15408             AND
 15409         WS-NW2 (NWA-INDEX3) EQUAL SPACES
 15410         GO TO 7290-EXIT.
 15411
 15412     GO TO 7290-MOVE-NAME-CYCLE.
 15413
 15414 7290-EXIT.
 15415     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 320
* EL689.cbl
 15417 7300-LABEL-MOVE.
 15418
 15419     IF  W-LABEL-HOLD-AREA = SPACES
 15420         MOVE +0                 TO W-NUMB-LABEL-LINES
 15421         GO TO 7300-EXIT.
 15422
 15423     IF  W-LABEL-LINES (1) = SPACES
 15424         MOVE W-LABEL-LINES (2)  TO W-LABEL-LINES (1)
 15425         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 15426         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15427         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15428         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15429         MOVE SPACES             TO W-LABEL-LINES (6)
 15430         GO TO 7300-LABEL-MOVE.
 15431
 15432     IF  W-LABEL-LINES (2) = SPACES
 15433             AND
 15434         W-LABEL-LINES (3) = SPACES
 15435             AND
 15436         W-LABEL-LINES (4) = SPACES
 15437             AND
 15438         W-LABEL-LINES (5) = SPACES
 15439             AND
 15440         W-LABEL-LINES (6) = SPACES
 15441         MOVE 1                  TO W-NDX
 15442                                    W-NUMB-LABEL-LINES
 15443         GO TO 7300-EXIT.
 15444
 15445 7300-TRY-2.
 15446
 15447     IF  W-LABEL-LINES (2) = SPACES
 15448         MOVE W-LABEL-LINES (3)  TO W-LABEL-LINES (2)
 15449         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15450         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15451         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15452         MOVE SPACES             TO W-LABEL-LINES (6)
 15453         GO TO 7300-TRY-2.
 15454
 15455     IF  W-LABEL-LINES (3) = SPACES
 15456             AND
 15457         W-LABEL-LINES (4) = SPACES
 15458             AND
 15459         W-LABEL-LINES (5) = SPACES
 15460             AND
 15461         W-LABEL-LINES (6) = SPACES
 15462         MOVE 2                  TO W-NDX
 15463         GO TO 7300-MOVE-ZIP.
 15464
 15465 7300-TRY-3.
 15466
 15467     IF  W-LABEL-LINES (3) = SPACES
 15468         MOVE W-LABEL-LINES (4)  TO W-LABEL-LINES (3)
 15469         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15470         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15471         MOVE SPACES             TO W-LABEL-LINES (6)
 15472         GO TO 7300-TRY-3.
 15473
 15474     IF  W-LABEL-LINES (4) = SPACES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 321
* EL689.cbl
 15475             AND
 15476         W-LABEL-LINES (5) = SPACES
 15477             AND
 15478         W-LABEL-LINES (6) = SPACES
 15479         MOVE 3                   TO W-NDX
 15480         GO TO 7300-MOVE-ZIP.
 15481
 15482 7300-TRY-4.
 15483
 15484     IF  W-LABEL-LINES (4) = SPACES
 15485         MOVE W-LABEL-LINES (5)  TO W-LABEL-LINES (4)
 15486         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15487         MOVE SPACES             TO W-LABEL-LINES (6)
 15488         GO TO 7300-TRY-4.
 15489
 15490     IF  W-LABEL-LINES (5) = SPACES
 15491             AND
 15492         W-LABEL-LINES (6) = SPACES
 15493         MOVE 4                  TO W-NDX
 15494         GO TO 7300-MOVE-ZIP.
 15495
 15496 7300-TRY-5.
 15497
 15498     IF  W-LABEL-LINES (5) = SPACES
 15499         MOVE W-LABEL-LINES (6)  TO W-LABEL-LINES (5)
 15500         MOVE SPACES             TO W-LABEL-LINES (6)
 15501         GO TO 7300-TRY-5
 15502     ELSE
 15503         IF  W-LABEL-LINES (6) = SPACES
 15504             MOVE 5              TO W-NDX
 15505             GO TO 7300-MOVE-ZIP
 15506         ELSE
 15507             MOVE 6              TO W-NDX.
 15508
 15509 7300-MOVE-ZIP.
 15510
 15511     COMPUTE W-NDX2 = W-NDX - 1.
 15512
 15513     IF  W-LAST-ZIP (W-NDX2) = SPACES
 15514*****CANADIAN ZIP CODES (NON NUMERIC) STAY ON THE LAST LINE
 15515
 15516         IF  W-LABEL-1ST-ZIP (W-NDX) NUMERIC
 15517                 MOVE W-LABEL-ZIP (W-NDX)
 15518                                 TO W-LAST-ZIP (W-NDX2)
 15519                 MOVE SPACES     TO W-LABEL-LINES (W-NDX)
 15520                 MOVE W-NDX2     TO W-NUMB-LABEL-LINES
 15521                 GO TO 7300-EXIT.
 15522
 15523     MOVE W-NDX                  TO W-NUMB-LABEL-LINES.
 15524
 15525 7300-EXIT.
 15526     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 322
* EL689.cbl
 15528 7400-CREATE-LETTER.
 15529****************************************************************
 15530*    THIS AREA CONTROLS THE PROCESSING OF INDIVIDUAL INPUT     *
 15531*    RECORDS.                                                  *
 15532****************************************************************
 15533
 15534     SET W-SQ-NDX                TO W-START-COLUMN.
 15535     MOVE SPACES                 TO W-SQUEEZED-LINE
 15536                                    W-WORK-LINE.
 15537     MOVE W-START-COLUMN         TO W-LAST-SQUEEZED-SPACE
 15538     MOVE +1                     TO W-LAST-WC-SPACE.
 15539     MOVE HIGH-VALUES            TO W-LAST-SQ-CHAR.
 15540
 15541     SET W-TG-NDX                TO +1.
 15542
 15543     PERFORM 7410-TEXT-LINE-PROCESS THRU 7410-EXIT
 15544            VARYING
 15545         W-TG-NDX FROM W-TG-NDX BY +1
 15546            UNTIL
 15547         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
 15548
 15549     IF  W-FORM-SQUEEZE-ON
 15550             AND
 15551         W-SQUEEZED-LINE GREATER THAN SPACES
 15552         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT.
 15553
 15554     PERFORM 7640-PAGING THRU 7640-EXIT.
 15555
 15556 7400-EXIT.
 15557     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 323
* EL689.cbl
 15559 7410-TEXT-LINE-PROCESS.
 15560***************************************************************
 15561*    THIS ROUTINE SEARCHES THE TEXT WORK AREA FOR ANY         *
 15562*    VARIABLE SYMBOL AND WILL REPLACE THE VARIABLE SYMBOL     *
 15563*    WITH THE CORRESPONDING DATA FROM THE SYSTEM DEFINED      *
 15564*    DATA THAT WAS GENERATED PREVIOUSLY.  WHILE PERFORMING    *
 15565*    THIS FUNCTION THE ROUTINE MOVES EACH CHARACTER OR ITS    *
 15566*    VARIABLE REPLACEMENT TO A WORK LINE.                     *
 15567***************************************************************
 15568
 15569
 15570     SET W-WC-NDX                TO W-ZEROS.
 15571     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15572
 15573     MOVE W-TX-SC (W-TG-NDX)     TO W-LINE-SQUEEZE-IND.
 15574
 15575     PERFORM 7420-TEXT-CHAR-PROCESS THRU 7420-EXIT
 15576             VARYING
 15577         W-TX-NDX FROM +1 BY +1
 15578             UNTIL
 15579         W-TX-NDX GREATER THAN +70.
 15580
 15581****************************************************************
 15582*    IF SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS    *
 15583*    EACH LINE OF TEXT IS PROCESSED ACCORDING TO THE INDICATED *
 15584*    LINE SQUEEZE CONTROL.                                     *
 15585****************************************************************
 15586     IF  W-FORM-SQUEEZE-ON
 15587
 15588         IF  W-WORK-LINE GREATER THAN SPACES
 15589                 OR
 15590             W-AS-IS
 15591             PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15592
 15593         ELSE
 15594             NEXT SENTENCE
 15595****************************************************************
 15596*    IF NO SPACE 'SQUEEZING' IS INDICATED ON A FORM WIDE BASIS *
 15597*    EACH LINE OF TEXT IS PRINT AS IS EXCEPT FOR VARIABLES     *
 15598****************************************************************
 15599     ELSE
 15600         IF  W-WORK-LINE GREATER THAN SPACES
 15601             MOVE W-TX-PC (W-TG-NDX)
 15602                                 TO W-PRINT-CONTROL
 15603             MOVE W-WORK-LINE    TO W-SQUEEZED-LINE
 15604             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15605             MOVE SPACES         TO W-WORK-LINE.
 15606
 15607 7410-EXIT.
 15608     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 324
* EL689.cbl
 15610 7420-TEXT-CHAR-PROCESS.
 15611****************************************************************
 15612*    LOOKING FOR VARIABLE INDICATORS (**XXX) THIS SECTION      *
 15613*    CONTROLS THE CONVERSION OF THESE INDICATORS INTO THEIR    *
 15614*    ACTUAL VALUES.  IT MOVES THESE REPLACEMENTS AND THE       *
 15615*    REMAINING CHARACTERS TO THE WORK LINE.                    *
 15616****************************************************************
 15617
 15618     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) EQUAL '@'
 15619             AND
 15620         W-LAST-CHAR EQUAL '@'
 15621         PERFORM 7430-PROCESS-VARIABLE THRU 7430-EXIT.
 15622
 15623     SET W-WC-NDX UP BY +1.
 15624
 15625     IF  W-WC-NDX GREATER THAN +70
 15626         IF  W-FORM-SQUEEZE-ON
 15627                 AND
 15628             NOT W-AS-IS
 15629             PERFORM 7440-BACK-TO-NEAREST-WORD THRU 7440-EXIT
 15630                     VARYING
 15631                 W-WC-NDX FROM W-LAST-WC-SPACE BY +1
 15632                     UNTIL
 15633                 W-WC-NDX EQUAL +71
 15634             SET W-TX-NDX        TO W-LAST-TX-SPACE
 15635
 15636             IF  W-WORK-LINE GREATER THAN SPACES
 15637                 PERFORM 7450-SQUEEZING THRU 7450-EXIT
 15638                 MOVE SPACES     TO W-WORK-LINE
 15639                                    W-LINE-SQUEEZE-IND
 15640                 SET W-WC-NDX    TO +1
 15641             ELSE
 15642                 SET W-WC-NDX    TO +1
 15643         ELSE
 15644             PERFORM 7460-REMAIN-CHAR-CHECK THRU 7460-EXIT.
 15645
 15646     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15647                                 TO W-CHARACTER-TYPE.
 15648
 15649     SET W-WC-NDX2               TO W-WC-NDX.
 15650     SET W-WC-NDX2 DOWN BY +1.
 15651
 15652     IF  W-PUNCTUATION
 15653             AND
 15654         W-WC-NDX2 GREATER THAN W-ZEROS
 15655             AND
 15656         W-WORK-CHAR (W-WC-NDX2) EQUAL SPACES
 15657         SET W-WC-NDX DOWN BY +1.
 15658
 15659     MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15660                                 TO W-LAST-CHAR
 15661                                    W-WORK-CHAR (W-WC-NDX).
 15662
 15663     IF  W-LAST-CHAR EQUAL SPACES
 15664         SET W-LAST-WC-SPACE     TO W-WC-NDX
 15665         SET W-LAST-TX-SPACE     TO W-TX-NDX.
 15666
 15667 7420-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 325
* EL689.cbl
 15668     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 326
* EL689.cbl
 15670 7430-PROCESS-VARIABLE.
 15671******************************************************************
 15672*    THIS SECTION CHECKS ON ALL '@@XXX' FORMATED CHARACTER       *
 15673*    GROUPS.  IF IN PROPER FORMAT, EACH GROUP IS REPLACED WITH   *
 15674*    ITS CORRESPONDING VALUES.                                   *
 15675******************************************************************
 15676
 15677     SET W-TX-NDX UP BY +1.
 15678
 15679     IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15680         MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15681                                 TO W-V1
 15682         SET W-TX-NDX UP BY +1
 15683
 15684         IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15685             MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15686                                 TO W-V2
 15687             SET W-TX-NDX UP BY +1
 15688             IF  W-TX-CHAR (W-TG-NDX W-TX-NDX) NUMERIC
 15689                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15690                                 TO W-V3
 15691                 SET W-TX-NDX UP BY +1
 15692                 MOVE W-TX-CHAR (W-TG-NDX W-TX-NDX)
 15693                                 TO W-FIELD-SQUEEZE-IND
 15694                 GO TO 7430-CONTINUE
 15695             ELSE
 15696                 SET W-TX-NDX DOWN BY +3
 15697                 MOVE ER-0180    TO EMI-ERROR
 15698                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15699                 MOVE -1         TO MAINTL
 15700                 MOVE HIGH-VALUES
 15701                                 TO W-LAST-CHAR
 15702         ELSE
 15703             SET W-TX-NDX DOWN BY +2
 15704             MOVE ER-0180        TO EMI-ERROR
 15705             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15706             MOVE -1             TO MAINTL
 15707             MOVE HIGH-VALUES    TO W-LAST-CHAR
 15708     ELSE
 15709         SET W-TX-NDX DOWN BY +1
 15710         MOVE ER-7246            TO EMI-ERROR
 15711         MOVE -1                 TO MAINTL
 15712         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15713         MOVE HIGH-VALUES        TO W-LAST-CHAR.
 15714
 15715****************************************************************
 15716*    WHEN THE PROPER FORM IS NOT FOUND THE CHARACTERS INVOLVED *
 15717*    ARE TRANSFERRED INTACT AND A NOTE MADE INDICATING THIS    *
 15718*    ACTION.                                                   *
 15719****************************************************************
 15720
 15721     IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15722         MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15723         GO TO 7430-EXIT
 15724     ELSE
 15725         GO TO 7430-EXIT.
 15726
 15727 7430-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 327
* EL689.cbl
 15728
 15729     IF  W-VAR-RELATIVE-NUM LESS THAN 001
 15730             OR
 15731         W-VAR-RELATIVE-NUM GREATER THAN W-NUM-OF-VARIABLES
 15732         SET W-TX-NDX DOWN BY +4
 15733         MOVE ER-0180            TO EMI-ERROR
 15734         MOVE -1                 TO MAINTL
 15735         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15736         MOVE HIGH-VALUES        TO W-LAST-CHAR
 15737         IF  W-FIRST-BAD-VARIABLE EQUAL ZEROS
 15738             MOVE 'Y'                TO W-FIRST-BAD-VARIABLE-IND
 15739             GO TO 7430-EXIT
 15740         ELSE
 15741             GO TO 7430-EXIT.
 15742
 15743     SET W-VG-NDX                TO W-VAR-RELATIVE-NUM.
 15744
 15745     SET W-WC-NDX DOWN BY +1.
 15746
 15747     IF  (W-FORM-SQUEEZE-OFF
 15748                 AND
 15749             NOT W-SQUEEZE-FIELD)
 15750             OR
 15751         (W-FORM-SQUEEZE-ON
 15752                 AND
 15753             W-AS-IS)
 15754         PERFORM 7435-MOVE-VARIABLE-DIRECT THRU 7435-EXIT
 15755                 VARYING
 15756             W-VC-NDX FROM +1 BY +1
 15757                 UNTIL
 15758             W-VC-NDX GREATER THAN
 15759                 W-VARIABLE-SIZE (W-VG-NDX)
 15760
 15761         IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +5
 15762             SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15763             SET W-TX-NDX DOWN BY +5
 15764             IF  W-TX-NDX GREATER THAN +70
 15765                 SET W-TX-NDX    TO +70
 15766                 GO TO 7430-EXIT
 15767             ELSE
 15768                 GO TO 7430-EXIT
 15769         ELSE
 15770             COMPUTE W-ADJUST-SHORT
 15771                 = 5 - W-VARIABLE-SIZE (W-VG-NDX)
 15772             SET W-WC-NDX UP BY W-ADJUST-SHORT
 15773             GO TO 7430-EXIT.
 15774
 15775     IF  W-SQUEEZE-FIELD
 15776         SET W-TX-NDX UP BY +1.
 15777
 15778     MOVE SPACES                 TO W-FIRST-CHAR-FOUND-IND.
 15779
 15780     PERFORM 7470-MOVE-CHAR THRU 7470-EXIT
 15781             VARYING
 15782         W-VC-NDX FROM +1 BY +1
 15783             UNTIL
 15784         W-VC-NDX GREATER THAN
 15785             W-VARIABLE-SIZE (W-VG-NDX).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 328
* EL689.cbl
 15786
 15787     MOVE HIGH-VALUES            TO W-LAST-CHAR.
 15788
 15789     IF  W-FORM-SQUEEZE-ON
 15790         GO TO 7430-EXIT.
 15791
 15792     IF  W-VARIABLE-SIZE (W-VG-NDX) GREATER THAN +6
 15793         SET W-TX-NDX UP BY W-VARIABLE-SIZE (W-VG-NDX)
 15794         SET W-TX-NDX DOWN BY +6
 15795         IF  W-TX-NDX GREATER THAN +70
 15796             SET W-TX-NDX        TO +70.
 15797
 15798     IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 15799         SET W-WC-NDX DOWN BY +1.
 15800
 15801 7430-EXIT.
 15802     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 329
* EL689.cbl
 15804 7435-MOVE-VARIABLE-DIRECT.
 15805
 15806     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 15807             AND
 15808         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 15809             AND
 15810         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 15811             AND
 15812         (W-VC-NDX GREATER THAN +1
 15813                 AND
 15814             W-LAST-CHAR NOT EQUAL SPACE
 15815                 AND
 15816             NOT W-LAST-CHAR-PUNC)
 15817         IF  W-LC-USE-BOTH-CASES
 15818             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15819                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 15820         ELSE
 15821             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15822                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 15823
 15824     SET W-WC-NDX UP BY +1.
 15825     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 15826                                 TO W-WORK-CHAR (W-WC-NDX)
 15827                                    W-LAST-CHAR.
 15828
 15829 7435-EXIT.
 15830     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 330
* EL689.cbl
 15832 7437-FIND-NEXT-CHARACTER.
 15833*DELIBERATELY LEFT BLANK.
 15834 7437-EXIT.
 15835     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 331
* EL689.cbl
 15837 7440-BACK-TO-NEAREST-WORD.
 15838
 15839     MOVE SPACES                 TO W-WORK-CHAR (W-WC-NDX).
 15840
 15841 7440-EXIT.
 15842     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 332
* EL689.cbl
 15844 7450-SQUEEZING.
 15845
 15846     IF  W-NEW-PARAGRAPH
 15847         PERFORM 7600-SET-PARA-INDENT THRU 7600-EXIT
 15848         MOVE SPACES             TO W-LINE-SQUEEZE-IND
 15849         IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15850             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15851             MOVE W-TX-PC (W-TG-NDX)
 15852                                 TO W-PRINT-CONTROL
 15853             MOVE SPACES         TO W-SQUEEZED-LINE
 15854             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15855             SET W-SQ-NDX UP BY W-WORK-INDENT
 15856         ELSE
 15857             MOVE W-TX-PC (W-TG-NDX)
 15858                                 TO W-PRINT-CONTROL
 15859             SET W-SQ-NDX        TO W-INITIAL-COLUMN
 15860             SET W-SQ-NDX UP BY W-WORK-INDENT
 15861     ELSE
 15862         IF  W-DO-NOT-ADJUST
 15863             MOVE SPACES         TO W-LINE-SQUEEZE-IND
 15864             IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15865                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15866                 MOVE W-WORK-LINE
 15867                                 TO W-SQUEEZED-LINE
 15868                 MOVE W-TX-PC (W-TG-NDX)
 15869                                 TO W-PRINT-CONTROL
 15870                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15871                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15872                 MOVE SPACES     TO W-SQUEEZED-LINE
 15873                 GO TO 7450-EXIT
 15874             ELSE
 15875                 MOVE W-WORK-LINE
 15876                                 TO W-SQUEEZED-LINE
 15877                 MOVE W-TX-PC (W-TG-NDX)
 15878                                 TO W-PRINT-CONTROL
 15879                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15880                 MOVE SPACES     TO W-SQUEEZED-LINE
 15881                                    W-WORK-LINE
 15882                 SET W-SQ-NDX    TO W-INITIAL-COLUMN
 15883                 GO TO 7450-EXIT
 15884         ELSE
 15885             IF  W-ADJUST-TO-LINE-LENGTH
 15886                 MOVE SPACES     TO W-LINE-SQUEEZE-IND
 15887
 15888                 IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15889                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15890                     SET W-SQ-NDX
 15891                                 TO W-INITIAL-COLUMN
 15892                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15893                             VARYING
 15894                         W-WC-NDX FROM 1 BY 1
 15895                             UNTIL
 15896                         W-SQ-NDX EQUAL W-TOO-FAR
 15897                     MOVE W-TX-PC (W-TG-NDX)
 15898                                 TO W-PRINT-CONTROL
 15899                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15900                     SET W-SQ-NDX
 15901                                 TO W-INITIAL-COLUMN
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 333
* EL689.cbl
 15902                     MOVE SPACES TO W-SQUEEZED-LINE
 15903                                    W-WORK-LINE
 15904                     GO TO 7450-EXIT
 15905                 ELSE
 15906                     SET W-SQ-NDX
 15907                                 TO W-INITIAL-COLUMN
 15908                     PERFORM 7505-MOVE-STRAIGHT THRU 7505-EXIT
 15909                             VARYING
 15910                         W-WC-NDX FROM 1 BY 1
 15911                             UNTIL
 15912                         W-SQ-NDX EQUAL W-TOO-FAR
 15913                     MOVE W-TX-PC (W-TG-NDX)
 15914                                 TO W-PRINT-CONTROL
 15915                     PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15916                     MOVE SPACES TO W-SQUEEZED-LINE
 15917                                    W-WORK-LINE
 15918                     SET W-SQ-NDX
 15919                                 TO W-INITIAL-COLUMN
 15920                     GO TO 7450-EXIT
 15921             ELSE
 15922                 IF  W-CONTINUE-PARAGRAPH
 15923                     IF  W-SQUEEZED-LINE GREATER THAN SPACES
 15924                         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15925                         PERFORM 7610-SET-CONP-INDENT
 15926                             THRU 7610-EXIT
 15927                         MOVE SPACES
 15928                                 TO W-LINE-SQUEEZE-IND
 15929                         MOVE W-TX-PC (W-TG-NDX)
 15930                                 TO W-PRINT-CONTROL
 15931                         MOVE SPACES
 15932                                 TO W-SQUEEZED-LINE
 15933                         SET W-SQ-NDX
 15934                                 TO W-INITIAL-COLUMN
 15935                         SET W-SQ-NDX UP BY W-WORK-INDENT
 15936                     ELSE
 15937                         PERFORM 7610-SET-CONP-INDENT
 15938                             THRU 7610-EXIT
 15939                         MOVE SPACES
 15940                                 TO W-LINE-SQUEEZE-IND
 15941                         MOVE W-TX-PC (W-TG-NDX)
 15942                                 TO W-PRINT-CONTROL
 15943                         MOVE SPACES
 15944                                 TO W-SQUEEZED-LINE
 15945                         SET W-SQ-NDX
 15946                                 TO W-INITIAL-COLUMN
 15947                         SET W-SQ-NDX UP BY W-WORK-INDENT.
 15948
 15949
 15950     PERFORM 7480-UPDATE-SQUEEZED-LINE THRU 7480-EXIT
 15951             VARYING
 15952         W-WC-NDX FROM +1 BY +1
 15953             UNTIL
 15954         W-WC-NDX GREATER THAN +70.
 15955
 15956 7450-EXIT.
 15957     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 334
* EL689.cbl
 15959 7460-REMAIN-CHAR-CHECK.
 15960
 15961     IF  W-TX-NDX EQUAL W-WC-NDX
 15962         MOVE W-TX-PC (W-TG-NDX)
 15963                                 TO W-PRINT-CONTROL
 15964         MOVE W-WORK-LINE        TO W-SQUEEZED-LINE
 15965         PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15966         MOVE SPACES             TO W-WORK-LINE
 15967         SET W-WC-NDX            TO +1
 15968     ELSE
 15969         SET W-TX-NDX1           TO W-TX-NDX
 15970         SEARCH W-TX-CHAR
 15971             VARYING W-TX-NDX1
 15972             AT END
 15973                 MOVE W-TX-PC (W-TG-NDX)
 15974                                 TO W-PRINT-CONTROL
 15975                 MOVE W-WORK-LINE
 15976                                 TO W-SQUEEZED-LINE
 15977                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15978                 MOVE SPACES     TO W-WORK-LINE
 15979                 SET W-WC-NDX    TO +1
 15980                 SET W-TX-NDX    TO +1
 15981                 SET W-TG-NDX UP BY +1
 15982             WHEN
 15983                 W-TX-CHAR (W-TG-NDX W-TX-NDX1) NOT EQUAL SPACES
 15984                 MOVE ER-9427    TO EMI-ERROR
 15985                 MOVE -1         TO MAINTL
 15986                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 15987                 MOVE W-TX-PC (W-TG-NDX)
 15988                                 TO W-PRINT-CONTROL
 15989                 MOVE W-WORK-LINE
 15990                                 TO W-SQUEEZED-LINE
 15991                 PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 15992                 MOVE SPACES     TO W-WORK-LINE
 15993                 SET W-WC-NDX    TO +1.
 15994
 15995 7460-EXIT.
 15996     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 335
* EL689.cbl
 15998 7470-MOVE-CHAR.
 15999
 16000     IF  W-FIRST-CHAR-NOT-FOUND
 16001             AND
 16002         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 16003         MOVE SPACES             TO W-LAST-CHAR
 16004         GO TO 7470-EXIT.
 16005
 16006     MOVE 'Y'                    TO W-FIRST-CHAR-FOUND-IND.
 16007
 16008     IF  W-SQUEEZE-FIELD
 16009             AND
 16010         W-LAST-CHAR EQUAL SPACES
 16011             AND
 16012         W-VAR-CHAR (W-VG-NDX W-VC-NDX) EQUAL SPACES
 16013         GO TO 7470-EXIT.
 16014
 16015     SET W-WC-NDX UP BY +1.
 16016
 16017     IF  W-WC-NDX GREATER THAN +70
 16018         IF  W-FORM-SQUEEZE-ON
 16019             GO TO 7470-EXIT
 16020         ELSE
 16021             MOVE ER-9427        TO EMI-ERROR
 16022             MOVE -1             TO MAINTL
 16023             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16024             GO TO 7470-EXIT.
 16025
 16026     IF  W-USE-UPPER-AND-LOWER-CASE (W-VAR-RELATIVE-NUM)
 16027             AND
 16028         W-VAR-CHAR (W-VG-NDX W-VC-NDX) NOT EQUAL SPACES
 16029             AND
 16030         W-VAR-CHAR (W-VG-NDX W-VC-NDX) ALPHABETIC
 16031             AND
 16032         (W-VC-NDX GREATER THAN +1
 16033                 AND
 16034             W-LAST-CHAR NOT EQUAL SPACE
 16035                 AND
 16036             NOT W-LAST-CHAR-PUNC)
 16037         IF  W-LC-USE-BOTH-CASES
 16038             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 16039                 CONVERTING W-UPPER-CASE TO W-LOWER-CASE
 16040         ELSE
 16041             INSPECT W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 16042                 CONVERTING W-LOWER-CASE TO W-UPPER-CASE.
 16043
 16044     MOVE W-VAR-CHAR (W-VG-NDX W-VC-NDX)
 16045                                 TO W-WORK-CHAR (W-WC-NDX)
 16046                                    W-LAST-CHAR.
 16047
 16048     IF  W-LAST-CHAR EQUAL SPACES
 16049         SET W-LAST-WC-SPACE     TO W-WC-NDX.
 16050
 16051 7470-EXIT.
 16052     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 336
* EL689.cbl
 16054 7480-UPDATE-SQUEEZED-LINE.
 16055****************************************************************
 16056*    THIS SECTION CONTROLS THE MOVEMENT FROM THE WORK LINE TO *
 16057*    THE SQUEEZED LINE.  DURING THIS PROCESS ALL EXTRA SPACES  *
 16058*    (DEFINED AS TWO OR MORE SPACES NOT FOLLOWING A END OF     *
 16059*    SENTENCE INDICATOR) ARE REMOVED.  IF THE LAST CHARACTER   *
 16060*    IS NOT A SPACE OR PUNCTUATION MARK AN UNFINISHED WORD IS  *
 16061*    ASSUMED.  EVERYTHING TO THE PREVIOUS SPACE IS REMOVED     *
 16062****************************************************************
 16063
 16064     SET W-SQ-NDX UP BY +1.
 16065
 16066     IF  W-SQ-NDX GREATER THAN W-LAST-COLUMN
 16067         MOVE W-SQ-CHAR (W-LAST-COLUMN)
 16068                                 TO W-CHARACTER-TYPE
 16069         IF  W-PUNCTUATION
 16070                 OR
 16071             W-SPACE
 16072             PERFORM 7485-FIND-NEXT-CHARACTER THRU 7485-EXIT
 16073             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 16074             MOVE SPACES         TO W-SQUEEZED-LINE
 16075             SET W-SQ-NDX        TO W-START-COLUMN
 16076             SET W-SQ-NDX UP BY W-NEXT-INDENT
 16077             SET W-LAST-SQUEEZED-SPACE
 16078                                 TO W-SQ-NDX
 16079         ELSE
 16080             PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 16081             PERFORM 7510-MOVE-TO-TABLE THRU 7510-EXIT
 16082             MOVE SPACES         TO W-SQUEEZED-LINE
 16083             SET W-SQ-NDX        TO W-START-COLUMN
 16084             SET W-SQ-NDX UP BY W-NEXT-INDENT
 16085             SET W-LAST-SQUEEZED-SPACE
 16086                                 TO W-SQ-NDX.
 16087
 16088     IF  W-WC-NDX GREATER THAN +70
 16089         GO TO 7480-EXIT.
 16090
 16091     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 16092
 16093     IF  W-END-OF-SENTENCE
 16094         MOVE 'Y'                TO W-END-OF-SENTENCE-IND
 16095         SET W-WORK-NDX          TO W-SQ-NDX
 16096         COMPUTE W-DISPLAY-NDX = W-WORK-NDX - 1
 16097         IF  W-DISPLAY-NDX EQUAL W-LAST-SQUEEZED-SPACE
 16098             SET W-SQ-NDX        TO W-LAST-SQUEEZED-SPACE
 16099         ELSE
 16100             NEXT SENTENCE
 16101     ELSE
 16102         IF  W-PUNCTUATION
 16103                 AND
 16104             W-LAST-SQ-CHAR EQUAL SPACES
 16105             SET W-SQ-NDX DOWN BY +1
 16106             MOVE SPACES         TO W-END-OF-SENTENCE-IND
 16107         ELSE
 16108             IF  W-WORK-CHAR (W-WC-NDX) EQUAL SPACES
 16109                 IF  W-LAST-SQ-CHAR EQUAL SPACES
 16110                     IF  W-END-OF-SENTENCE-WORKING
 16111                         MOVE SPACES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 337
* EL689.cbl
 16112                                 TO W-END-OF-SENTENCE-IND
 16113                         SET W-LAST-SQUEEZED-SPACE
 16114                                 TO W-SQ-NDX
 16115                     ELSE
 16116                         SET W-SQ-NDX DOWN BY +1
 16117                         GO TO 7480-EXIT
 16118                 ELSE
 16119                     SET W-LAST-SQUEEZED-SPACE
 16120                                 TO W-SQ-NDX
 16121             ELSE
 16122                 MOVE SPACES     TO W-END-OF-SENTENCE-IND.
 16123
 16124     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX)
 16125                                    W-LAST-SQ-CHAR.
 16126
 16127     IF  W-WC-NDX EQUAL +70
 16128             AND
 16129         W-WORK-CHAR (W-WC-NDX) GREATER THAN SPACES
 16130             AND
 16131         W-SQ-NDX NOT EQUAL W-LAST-COLUMN
 16132         SET W-SQ-NDX UP BY +1
 16133         SET W-LAST-SQUEEZED-SPACE
 16134                                 TO W-SQ-NDX
 16135         MOVE SPACES             TO W-SQ-CHAR (W-SQ-NDX)
 16136                                    W-LAST-SQ-CHAR.
 16137
 16138 7480-EXIT.
 16139     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 338
* EL689.cbl
 16141 7485-FIND-NEXT-CHARACTER.
 16142
 16143     MOVE W-WORK-CHAR (W-WC-NDX) TO W-CHARACTER-TYPE.
 16144
 16145     IF  W-PUNCTUATION
 16146         PERFORM 7490-REMOVE-LAST-WORD THRU 7490-EXIT
 16147     ELSE
 16148         SET W-WC-NDX            TO W-WC-NDX
 16149         SEARCH W-WORK-CHAR
 16150             VARYING W-WC-NDX
 16151             AT END
 16152                 GO TO 7485-EXIT
 16153             WHEN
 16154                 W-WORK-CHAR (W-WC-NDX) NOT EQUAL SPACES
 16155                 GO TO 7485-EXIT.
 16156
 16157 7485-EXIT.
 16158     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 339
* EL689.cbl
 16160 7490-REMOVE-LAST-WORD.
 16161
 16162*********  NOTE: W-WORK-LINE ALWAYS STARTS WITH A FULL WORD*******
 16163     IF  W-WC-NDX EQUAL +1
 16164         GO TO 7490-EXIT.
 16165
 16166     ADD +1                      TO W-LAST-SQUEEZED-SPACE.
 16167
 16168     PERFORM 7500-CLEAR-SQUEEZED-EXCESS THRU 7500-EXIT
 16169             VARYING
 16170         W-SQ-NDX FROM W-LAST-SQUEEZED-SPACE BY +1
 16171             UNTIL
 16172         W-SQ-NDX EQUAL W-TOO-FAR.
 16173
 16174     SET W-WORK-NDX              TO W-WC-NDX.
 16175     COMPUTE W-LAST-WC-SPACE
 16176         = W-WORK-NDX - W-TOO-FAR + W-LAST-SQUEEZED-SPACE.
 16177     SET W-WC-NDX                TO W-LAST-WC-SPACE.
 16178
 16179 7490-EXIT.
 16180     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 340
* EL689.cbl
 16182 7500-CLEAR-SQUEEZED-EXCESS.
 16183
 16184     MOVE SPACES                 TO W-SQ-CHAR (W-SQ-NDX).
 16185
 16186 7500-EXIT.
 16187     EXIT.
 16188
 16189 7505-MOVE-STRAIGHT.
 16190
 16191     SET W-SQ-NDX UP BY +1.
 16192
 16193     MOVE W-WORK-CHAR (W-WC-NDX) TO W-SQ-CHAR (W-SQ-NDX).
 16194
 16195 7505-EXIT.
 16196     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 341
* EL689.cbl
 16198 7510-MOVE-TO-TABLE.
 16199
 16200     IF  W-PRINT-CONTROL NOT NUMERIC
 16201         MOVE 00                 TO W-PRINT-CONTROL
 16202         ADD +1                  TO W-LINE-COUNT
 16203     ELSE
 16204         IF  W-PRINT-CONTROL EQUAL 99
 16205             PERFORM 7640-PAGING THRU 7640-EXIT
 16206             MOVE 00             TO W-PRINT-CONTROL
 16207             SET W-RG-NDX UP BY +1
 16208             MOVE W-TOP-FORM     TO W-RC-TEXT (W-RG-NDX)
 16209             MOVE +1             TO W-LINE-COUNT
 16210             SET W-RG-NDX UP BY W-TOP-MARGIN
 16211         ELSE
 16212           IF W-SQUEEZED-LINE (1:6) NOT EQUAL '&&&&&&'
 16213             COMPUTE W-LINE-COUNT
 16214                 = W-LINE-COUNT + W-PRINT-CONTROL + 1.
 16215
 16216     IF  W-LINE-COUNT GREATER THAN W-MAX-LINES-PER-PAGE
 16217         PERFORM 7640-PAGING THRU 7640-EXIT
 16218         MOVE 00                 TO W-PRINT-CONTROL
 16219         SET W-RG-NDX UP BY +1
 16220         MOVE W-TOP-FORM         TO W-RC-TEXT (W-RG-NDX)
 16221         SET W-RG-NDX UP BY W-TOP-MARGIN
 16222         MOVE +1                 TO W-LINE-COUNT.
 16223
 16224     SET W-RG-NDX UP BY W-PRINT-CONTROL.
 16225     SET W-RG-NDX UP BY +1.
 16226     MOVE W-SQUEEZED-LINE        TO W-RC-TEXT (W-RG-NDX).
 16227     MOVE 00                     TO W-PRINT-CONTROL.
 16228
 16229     IF  W-FIRST-BAD-VARIABLE-FOUND
 16230             AND
 16231         W-FIRST-BAD-VARIABLE EQUAL ZEROS
 16232         SET W-FIRST-BAD-VARIABLE
 16233                                 TO W-RG-NDX.
 16234
 16235 7510-EXIT.
 16236     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 342
* EL689.cbl
 16238 7600-SET-PARA-INDENT.
 16239
 16240     IF  W-LINE-SQUEEZE-IND EQUAL 'P'
 16241         MOVE W-PARAGRAPH-INDENT TO W-WORK-INDENT
 16242     ELSE
 16243     IF  W-LINE-SQUEEZE-IND EQUAL 'Q'
 16244         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 16245         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16246     ELSE
 16247     IF  W-LINE-SQUEEZE-IND EQUAL 'R'
 16248         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 16249         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16250     ELSE
 16251     IF  W-LINE-SQUEEZE-IND EQUAL 'S'
 16252         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 16253         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16254     ELSE
 16255     IF  W-LINE-SQUEEZE-IND EQUAL 'T'
 16256         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 16257         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT
 16258     ELSE
 16259     IF  W-LINE-SQUEEZE-IND EQUAL 'U'
 16260         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT
 16261         ADD W-PARAGRAPH-INDENT  TO W-WORK-INDENT.
 16262
 16263     SET W-TG-NDX2               TO W-TG-NDX.
 16264     SET W-TG-NDX2 UP BY +1.
 16265
 16266     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 16267         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16268     ELSE
 16269         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 16270
 16271 7600-EXIT.
 16272     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 343
* EL689.cbl
 16274 7610-SET-CONP-INDENT.
 16275
 16276     IF  W-LINE-SQUEEZE-IND EQUAL 'C'
 16277         MOVE +0                 TO W-WORK-INDENT
 16278     ELSE
 16279     IF  W-LINE-SQUEEZE-IND EQUAL 'D'
 16280         MOVE W-LINE-INDENT-1    TO W-WORK-INDENT
 16281     ELSE
 16282     IF  W-LINE-SQUEEZE-IND EQUAL 'E'
 16283         MOVE W-LINE-INDENT-2    TO W-WORK-INDENT
 16284     ELSE
 16285     IF  W-LINE-SQUEEZE-IND EQUAL 'F'
 16286         MOVE W-LINE-INDENT-3    TO W-WORK-INDENT
 16287     ELSE
 16288     IF  W-LINE-SQUEEZE-IND EQUAL 'G'
 16289         MOVE W-LINE-INDENT-4    TO W-WORK-INDENT
 16290     ELSE
 16291     IF  W-LINE-SQUEEZE-IND EQUAL 'H'
 16292         MOVE W-LINE-INDENT-5    TO W-WORK-INDENT.
 16293
 16294     SET W-TG-NDX2               TO W-TG-NDX.
 16295     SET W-TG-NDX2 UP BY +1.
 16296
 16297     IF  W-TG-NDX EQUAL W-TOTAL-TX-LINES
 16298         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16299     ELSE
 16300         PERFORM 7630-NEXT-LINE THRU 7630-EXIT.
 16301
 16302 7610-EXIT.
 16303     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 344
* EL689.cbl
 16305 7630-NEXT-LINE.
 16306
 16307     IF  W-TX-SC (W-TG-NDX2) EQUAL ' '
 16308         MOVE ZEROS              TO W-NEXT-INDENT
 16309     ELSE
 16310     IF  W-TX-SC (W-TG-NDX2) EQUAL '1'
 16311         MOVE W-LINE-INDENT-1    TO W-NEXT-INDENT
 16312     ELSE
 16313     IF  W-TX-SC (W-TG-NDX2) EQUAL '2'
 16314         MOVE W-LINE-INDENT-2    TO W-NEXT-INDENT
 16315     ELSE
 16316     IF  W-TX-SC (W-TG-NDX2) EQUAL '3'
 16317         MOVE W-LINE-INDENT-3    TO W-NEXT-INDENT
 16318     ELSE
 16319     IF  W-TX-SC (W-TG-NDX2) EQUAL '4'
 16320         MOVE W-LINE-INDENT-4    TO W-NEXT-INDENT
 16321     ELSE
 16322     IF  W-TX-SC (W-TG-NDX2) EQUAL '5'
 16323         MOVE W-LINE-INDENT-5    TO W-NEXT-INDENT
 16324     ELSE
 16325         MOVE W-WORK-INDENT      TO W-NEXT-INDENT
 16326         SUBTRACT W-PARAGRAPH-INDENT
 16327                                  FROM W-NEXT-INDENT.
 16328
 16329 7630-EXIT.
 16330     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 345
* EL689.cbl
 16332 7640-PAGING.
 16333
 16334     IF  NOT W-LC-CREATE-PAGES
 16335         GO TO 7640-EXIT.
 16336
 16337     IF  W-LINE-COUNT GREATER ZEROS
 16338             AND
 16339         W-RG-NDX GREATER THAN +1
 16340         ADD +1                  TO W-PAGE
 16341         MOVE W-PAGE             TO W-PAGE-NUMBER
 16342         COMPUTE W-PAGE-LINE
 16343             = W-MAX-LINES-PER-PAGE - W-LINE-COUNT + 3
 16344         IF  W-PAGE-LINE GREATER THAN +2
 16345             SET W-RG-NDX UP BY W-PAGE-LINE
 16346             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX)
 16347         ELSE
 16348             SET W-RG-NDX UP BY +2
 16349             MOVE W-PAGE-PRT     TO W-RC-TEXT (W-RG-NDX).
 16350
 16351 7640-EXIT.
 16352     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 346
* EL689.cbl
 16354 7700-READ-TEXT-TS.
 16355**************************************************************
 16356*  THIS PARAGRAPH READS THE TEMPORARY STORAGE RECORDS THAT   *
 16357*  CONTAIN THE TEXT THAT IS PAST BETWEEN EL689, EL6892       *
 16358*  AND EL1042.                                               *
 16359**************************************************************
 16360
 16361
 16362* EXEC CICS HANDLE CONDITION
 16363*         QIDERR     (7700-TS-ERROR)
 16364*         ITEMERR    (7700-TS-ERROR)
 16365*    END-EXEC.
 16366*    MOVE '"$N<                  ! 9 #00015255' TO DFHEIV0
 16367     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
 16368     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16369     MOVE X'3920233030303135323535' TO DFHEIV0(25:11)
 16370     CALL 'kxdfhei1' USING DFHEIV0
 16371     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16372
 16373
 16374     SET W-TS-NDX                TO 1.
 16375     MOVE 1                      TO W-TS-ITEM.
 16376
 16377 7700-LOOP.
 16378
 16379     IF  W-TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS
 16380         IF  PI-TEMP-STOR-ITEMS GREATER THAN ZEROS
 16381             PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 16382             GO TO 7700-EXIT
 16383         ELSE
 16384             GO TO 7700-EXIT.
 16385
 16386
 16387* EXEC CICS READQ TS
 16388*         INTO     (W-TS-WORK-AREA)
 16389*         QUEUE    (W-TS-NAME-TEXT)
 16390*         LENGTH   (W-TS-LENGTH)
 16391*         ITEM     (W-TS-ITEM)
 16392*    END-EXEC.
 16393*    MOVE '*$II   L              ''   #00015272' TO DFHEIV0
 16394     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 16395     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16396     MOVE X'2020233030303135323732' TO DFHEIV0(25:11)
 16397     CALL 'kxdfhei1' USING DFHEIV0,
 16398           W-TS-NAME-TEXT,
 16399           W-TS-WORK-AREA,
 16400           W-TS-LENGTH,
 16401           W-TS-ITEM,
 16402           DFHEIV99,
 16403           DFHEIV99
 16404     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16405
 16406
 16407     MOVE W-TS-WORK-AREA         TO W-TS-GROUP (W-TS-NDX).
 16408     SET W-TS-NDX UP BY 1.
 16409     ADD 1                       TO W-TS-ITEM.
 16410     GO TO 7700-LOOP.
 16411
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 347
* EL689.cbl
 16412 7700-TS-ERROR.
 16413
 16414     IF  EIBTRNID = W-TRANSACTION OR 'EX14'
 16415         MOVE ER-0033            TO EMI-ERROR
 16416         MOVE -1                 TO MAINTL
 16417         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16418         GO TO 8200-SEND-DATAONLY.
 16419
 16420 7700-EXIT.
 16421      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 348
* EL689.cbl
 16423 7740-RESTORE-SCREEN.
 16424
 16425     MOVE 'C'                    TO MAINTI.
 16426     MOVE +1                     TO MAINTL.
 16427     MOVE AL-UANON               TO MAINTA.
 16428
 16429     MOVE PI-689-FORM-NUMBER     TO FORMI.
 16430     MOVE +4                     TO FORML.
 16431     MOVE AL-UANON               TO FORMA.
 16432
 16433*    IF  PI-689-PRINT-RESTRICTION GREATER THAN SPACES
 16434*        MOVE PI-689-PRINT-RESTRICTION
 16435*                                TO PRTRESTL
 16436*        MOVE +1                 TO PRTRESTL
 16437*        MOVE AL-UANON           TO PRTRESTA.
 16438
 16439     IF  PI-689-FOLLOW-UP-EDIT GREATER THAN SPACES
 16440         MOVE PI-689-FOLLOW-UP-EDIT
 16441                                 TO FOLLOWI
 16442         MOVE +8                 TO FOLLOWL
 16443         MOVE AL-UANON           TO FOLLOWA.
 16444
 16445     IF  PI-689-RESEND1-EDIT GREATER THAN SPACES
 16446         MOVE PI-689-RESEND1-EDIT
 16447                                 TO RESEND1I
 16448         MOVE +8                 TO RESEND1L
 16449         MOVE AL-UANON           TO RESEND1A.
 16450     IF  PI-689-ALT-PRINTER-ID GREATER THAN SPACES
 16451         MOVE PI-689-ALT-PRINTER-ID
 16452                                 TO PRINTERI
 16453         MOVE +1                 TO PRINTERL
 16454         MOVE AL-UANON           TO PRINTERA.
 16455
 16456     IF  PI-BYPASS-LABELS
 16457          MOVE PI-LABEL-CONTROL  TO ADDRLBLI
 16458          MOVE +1                TO ADDRLBLL
 16459          MOVE AL-UANON          TO ADDRLBLA
 16460     ELSE
 16461          IF  PI-689-LBL-OVERRIDE GREATER THAN SPACES
 16462               MOVE PI-689-LBL-OVERRIDE
 16463                                 TO ADDRLBLI
 16464               MOVE +1           TO ADDRLBLL
 16465               MOVE AL-UANON     TO ADDRLBLA.
 16466
 16467     IF  PI-689-NUMBER-COPIES GREATER THAN ZEROS
 16468         MOVE PI-689-NUMBER-COPIES   TO COPIESI
 16469         MOVE +1                     TO COPIESL
 16470         MOVE AL-UNNON               TO COPIESA.
 16471
 16472     IF  PI-689-LABEL-SOURCE GREATER THAN SPACES
 16473         MOVE PI-689-LABEL-SOURCE
 16474                                 TO ADDRSI
 16475         MOVE +1                 TO ADDRSL
 16476         MOVE AL-UANON           TO ADDRSA.
 16477
 16478     MOVE PI-689-DATA-SOURCE     TO DATASORI.
 16479     MOVE +1                     TO DATASORL.
 16480     MOVE AL-UANON               TO DATASORA.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 349
* EL689.cbl
 16481
 16482     IF  PI-689-CARRIER GREATER THAN SPACES
 16483         MOVE PI-689-CARRIER     TO CARRIERI
 16484         MOVE +1                 TO CARRIERL
 16485         MOVE AL-UANON           TO CARRIERA.
 16486
 16487     IF  PI-689-GROUPING GREATER THAN SPACES
 16488         MOVE PI-689-GROUPING    TO GROUPI
 16489         MOVE +6                 TO GROUPL
 16490         MOVE AL-UANON           TO GROUPA.
 16491
 16492     IF  PI-689-STATE GREATER THAN SPACES
 16493         MOVE PI-689-STATE       TO STATEI
 16494         MOVE +2                 TO STATEL
 16495         MOVE AL-UANON           TO STATEA.
 16496
 16497     IF  PI-689-ACCOUNT GREATER THAN SPACES
 16498         MOVE PI-689-ACCOUNT     TO ACCTI
 16499         MOVE +10                TO ACCTL
 16500         MOVE AL-UANON           TO ACCTA.
 16501
 16502     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 16503         MOVE PI-689-CERT-PRIME  TO CERTI
 16504         MOVE +10                TO CERTL
 16505         MOVE AL-UANON           TO CERTA.
 16506
 16507     IF  PI-689-CERT-PRIME GREATER THAN SPACES
 16508         MOVE PI-689-CERT-SFX    TO SFXI
 16509         MOVE +1                 TO SFXL
 16510         MOVE AL-UANON           TO SFXA.
 16511
 16512     IF  PI-689-TYPE GREATER THAN SPACES
 16513         MOVE PI-689-TYPE        TO TYPEI
 16514         MOVE +1                 TO TYPEL
 16515         MOVE AL-UANON           TO TYPEA.
 16516
 16517     IF  PI-689-RESP-PERSON GREATER THAN SPACES
 16518         MOVE PI-689-RESP-PERSON TO RPERSONI
 16519         MOVE +10                TO RPERSONL
 16520         MOVE AL-UANON           TO RPERSONA.
 16521
 16522     IF  PI-689-ENTRY-BATCH GREATER THAN SPACES
 16523         MOVE PI-689-ENTRY-BATCH TO BENTRYI
 16524         MOVE +6                 TO BENTRYL
 16525         MOVE AL-UANON           TO BENTRYA.
 16526
 16527     IF  PI-689-SEQ-EDIT GREATER THAN SPACES
 16528         MOVE PI-689-SEQ-EDIT    TO SEQI
 16529         MOVE +8                 TO SEQL
 16530         MOVE AL-UNNON           TO SEQA.
 16531
 16532     IF  PI-689-BCSEQ-EDIT GREATER THAN SPACES
 16533         MOVE PI-689-BCSEQ-EDIT  TO BCSEQI
 16534         MOVE +4                 TO BCSEQL
 16535         MOVE AL-UNNON           TO BCSEQA.
 16536
 16537     IF  PI-689-DATE-EDIT GREATER THAN SPACES
 16538         MOVE PI-689-DATE-EDIT   TO DATEI
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 350
* EL689.cbl
 16539         MOVE +8                 TO DATEL
 16540         MOVE AL-UNNON           TO DATEA.
 16541
 16542     IF PI-CERT-FORM-ID GREATER THAN SPACES
 16543        MOVE PI-CERT-FORM-ID     TO CERTIDI
 16544        MOVE +5                  TO CERTIDL
 16545        MOVE AL-UNNON            TO CERTIDA
 16546     END-IF.
 16547
 16548     IF PI-PRINT-NOW GREATER THAN SPACES
 16549        MOVE PI-PRINT-NOW        TO PRTNOWI
 16550        MOVE +1                  TO PRTNOWL
 16551        MOVE AL-UNNON            TO PRTNOWA
 16552     END-IF.
 16553     IF PI-ENDT-ARCH-NO GREATER THAN ZERO
 16554        MOVE PI-ENDT-ARCH-NO     TO ENDARCHI
 16555        MOVE +8                  TO ENDARCHL
 16556        MOVE AL-UNNON            TO ENDARCHA
 16557     END-IF
 16558
 16559     MOVE PI-ENCLOSURE-CD        TO ENCI.
 16560     MOVE +3                     TO ENCL.
 16561     MOVE AL-UANON               TO ENCA.
 16562
 16563 7749-EXIT.
 16564     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 351
* EL689.cbl
 16566 7760-PUT-TEMP-STORAGE.
 16567**************************************************************
 16568*  THIS PARAGRAPH WRITES THE TEMPORARY STORAGE RECORDS THAT  *
 16569*  WILL CONTAIN THE CONTENTS OF THE TEXT TABLE FOR USE BY    *
 16570*  EL1042 AND EL6892.                                        *
 16571**************************************************************
 16572
 16573     SET W-TS-NDX                TO 1.
 16574     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16575
 16576     MOVE -1                     TO MAINTL.
 16577     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16578             VARYING
 16579         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16580             UNTIL
 16581         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16582
 16583 7760-EXIT.
 16584      EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 352
* EL689.cbl
 16586 7780-DELETE-TEMP-STOR-TEXT.
 16587
 16588
 16589* EXEC CICS HANDLE CONDITION
 16590*         QIDERR      (7780-EXIT)
 16591*    END-EXEC.
 16592*    MOVE '"$N                   ! : #00015460' TO DFHEIV0
 16593     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
 16594     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16595     MOVE X'3A20233030303135343630' TO DFHEIV0(25:11)
 16596     CALL 'kxdfhei1' USING DFHEIV0
 16597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16598
 16599
 16600
 16601* EXEC CICS DELETEQ TS
 16602*         QUEUE       (W-TS-NAME-TEXT)
 16603*    END-EXEC.
 16604*    MOVE '*&                    #   #00015464' TO DFHEIV0
 16605     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
 16606     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 16607     MOVE X'2020233030303135343634' TO DFHEIV0(25:11)
 16608     CALL 'kxdfhei1' USING DFHEIV0,
 16609           W-TS-NAME-TEXT,
 16610           DFHEIV99
 16611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16612
 16613
 16614 7780-EXIT.
 16615     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 353
* EL689.cbl
 16617 7840-WRITE-TS.
 16618
 16619     MOVE W-TS-GROUP (W-TS-NDX)  TO W-TS-WORK-AREA.
 16620     SET W-TS-NDX UP BY 1.
 16621     ADD 1                       TO PI-TEMP-STOR-ITEMS.
 16622
 16623
 16624* EXEC CICS WRITEQ TS
 16625*         FROM    (W-TS-WORK-AREA)
 16626*         QUEUE   (W-TS-NAME-TEXT)
 16627*         LENGTH  (W-TS-LENGTH)
 16628*         ITEM    (PI-TEMP-STOR-ITEMS)
 16629*    END-EXEC.
 16630*    MOVE '*" I   L              ''   #00015477' TO DFHEIV0
 16631     MOVE X'2A2220492020204C20202020' TO DFHEIV0(1:12)
 16632     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 16633     MOVE X'2020233030303135343737' TO DFHEIV0(25:11)
 16634     CALL 'kxdfhei1' USING DFHEIV0,
 16635           W-TS-NAME-TEXT,
 16636           W-TS-WORK-AREA,
 16637           W-TS-LENGTH,
 16638           PI-TEMP-STOR-ITEMS,
 16639           DFHEIV99,
 16640           DFHEIV99
 16641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16642
 16643
 16644 7840-EXIT.
 16645     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 354
* EL689.cbl
 16647 7900-PRINT-LETTER-NOW.
 16648***************************************************************
 16649*     THIS ROUTINE WILL CAUSE THE CURRENTLY CREATED LETTER    *
 16650*     TO BE PRINTED ON A HARDCOPY PRINTER.                    *
 16651*     THE TEXT IS EDITED FOR ANY UNRESOLVED SYMBOLS.          *
 16652*     THE PRINTER ID IS OBTAINED FROM THE CONTROL FILE.       *
 16653*     THE LETTER IS SAVED IN TEMP-STORAGE AND A START IS      *
 16654*     ISSUED FOR THE PRINT TRANSACTION.                       *
 16655***************************************************************
 16656
 16657*    IF (EIBAID = DFHPF4 OR DFHPF8)
 16658*            AND
 16659*        PI-SHOW-MODE
 16660*        IF  PRINTERL GREATER ZERO
 16661*            INSPECT PRINTERI CONVERTING W-LOWER-CASE TO
 16662*                                                    W-UPPER-CASE
 16663*            MOVE PRINTERI       TO PI-689-ALT-PRINTER-ID
 16664*                                   PI-ALT-DMD-PRT-ID.
 16665*
 16666*    IF  EIBAID EQUAL DFHPF8
 16667*            AND
 16668*        PI-SHOW-MODE
 16669*            AND
 16670*        LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
 16671*        MOVE ER-7247            TO EMI-ERROR
 16672*        MOVE -1                 TO MAINTL
 16673*        MOVE AL-UABON           TO MAINTA
 16674*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16675*        GO TO 8200-SEND-DATAONLY.
 16676
 16677     IF  PI-TOTAL-LINES EQUAL 0
 16678         MOVE ER-0187            TO EMI-ERROR
 16679         MOVE -1                 TO MAINTL
 16680         MOVE AL-UABON           TO MAINTA
 16681         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
 16682         GO TO 8200-SEND-DATAONLY.
 16683
 16684     IF  EMI-ERROR NOT EQUAL ER-0191
 16685         IF  PI-689-CREATE-NO-SCREENS
 16686*                OR
 16687*            (EIBAID = DFHPF4 OR DFHPF8)
 16688             SET W-RG-NDX        TO +1
 16689         ELSE
 16690             PERFORM 4100-SET-NDX THRU 4100-EXIT
 16691             PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16692                     VARYING
 16693                 W-SC-NDX FROM 1 BY 1
 16694                     UNTIL
 16695                 W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN.
 16696
 16697     MOVE SPACES                 TO W-REMAINING-VAR-SW.
 16698
 16699     IF EIBAID NOT = DFHPF4 AND DFHPF8
 16700         PERFORM 7915-SEARCH-REMAINING-VARS THRU 7915-EXIT
 16701                 VARYING
 16702             W-RVS-NDX FROM +1 BY +1
 16703                 UNTIL
 16704             W-RVS-NDX GREATER THAN +36500
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 355
* EL689.cbl
 16705                 OR
 16706             W-REMAINING-VAR-FOUND
 16707         IF  W-REMAINING-VAR-FOUND
 16708             GO TO 4000-ROLL-PAGE.
 16709
 16710*    IF EIBAID = DFHPF4 OR DFHPF8
 16711*       PERFORM 7700-READ-TEXT-TS
 16712*                                THRU 7700-EXIT
 16713*
 16714*        PERFORM 4100-SET-NDX THRU 4100-EXIT
 16715*        PERFORM 4200-UPDATE-TABLE-FROM-SCREEN THRU 4200-EXIT
 16716*                VARYING
 16717*            W-SC-NDX FROM 1 BY 1
 16718*                UNTIL
 16719*            W-SC-NDX GREATER THAN W-NUM-LINES-PER-SCREEN
 16720*
 16721*       PERFORM 7760-PUT-TEMP-STORAGE
 16722*                                THRU 7760-EXIT
 16723*    END-IF
 16724     IF PI-689-ALT-PRINTER-ID NOT = SPACES AND LOW-VALUES
 16725         MOVE PI-689-ALT-PRINTER-ID
 16726                                 TO W-TS-TERM-TEXT
 16727     ELSE
 16728         IF PI-PROCESSOR-PRINTER NOT = SPACES AND LOW-VALUES
 16729             MOVE PI-PROCESSOR-PRINTER
 16730                                 TO W-TS-TERM-TEXT
 16731         ELSE
 16732             MOVE PI-COMPANY-ID  TO W-CNTL-COMPANY-ID
 16733             MOVE '1'            TO W-CNTL-RECORD-TYPE
 16734             MOVE SPACES         TO W-CNTL-GENL
 16735             MOVE ZEROS          TO W-CNTL-SEQ-NO
 16736
 16737* EXEC CICS HANDLE CONDITION
 16738*                 NOTOPEN    (8040-CNTL-NOT-OPEN)
 16739*                 NOTFND     (7945-NOT-FOUND)
 16740*            END-EXEC
 16741*    MOVE '"$JI                  ! ; #00015576' TO DFHEIV0
 16742     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
 16743     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16744     MOVE X'3B20233030303135353736' TO DFHEIV0(25:11)
 16745     CALL 'kxdfhei1' USING DFHEIV0
 16746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16747
 16748* EXEC CICS READ
 16749*                 DATASET    (W-CNTL-FILE-ID)
 16750*                 SET        (ADDRESS OF CONTROL-FILE)
 16751*                 RIDFLD     (W-CNTL-KEY)
 16752*            END-EXEC
 16753*    MOVE '&"S        E          (   #00015580' TO DFHEIV0
 16754     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16755     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 16756     MOVE X'2020233030303135353830' TO DFHEIV0(25:11)
 16757     CALL 'kxdfhei1' USING DFHEIV0,
 16758           W-CNTL-FILE-ID,
 16759           DFHEIV20,
 16760           DFHEIV99,
 16761           W-CNTL-KEY,
 16762           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 356
* EL689.cbl
 16763           DFHEIV99,
 16764           DFHEIV99
 16765     SET ADDRESS OF CONTROL-FILE TO
 16766         DFHEIV20
 16767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 16768             MOVE CF-FORMS-PRINTER-ID
 16769                                 TO W-TS-TERM-TEXT.
 16770
 16771***********************************************************
 16772*      CHECK TO SEE IF IT IS A PRINT REQUEST FOR PRINTING *
 16773*      LETTERS ON A 3275 PRINTER. IF SO, SAVE THE SCREEN  *
 16774***********************************************************
 16775
 16776     SET W-TS-NDX                TO 1.
 16777     MOVE EIBTIME                TO W-TS-ID-TIME.
 16778     MOVE W-TS-NAME-TEXT         TO PI-689-TEMP-STOR-ID.
 16779     MOVE 0                      TO PI-TEMP-STOR-ITEMS.
 16780
 16781     PERFORM 7840-WRITE-TS THRU 7840-EXIT
 16782             VARYING
 16783         W-TS-GROUP-WORK FROM 0 BY W-TS-NUM-REC-IN-GROUP
 16784             UNTIL
 16785         W-TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES.
 16786
 16787*    IF  EIBAID EQUAL DFHPF8
 16788*        MOVE '1'                TO PI-689-PRINT-SW
 16789*    ELSE
 16790         MOVE SPACES             TO PI-689-PRINT-SW.
 16791
 16792
 16793* EXEC CICS HANDLE CONDITION
 16794*         TERMIDERR  (7935-TERM-ERROR)
 16795*         TRANSIDERR (7940-TRAN-ERROR)
 16796*    END-EXEC.
 16797*    MOVE '"$[\                  ! < #00015609' TO DFHEIV0
 16798     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
 16799     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16800     MOVE X'3C20233030303135363039' TO DFHEIV0(25:11)
 16801     CALL 'kxdfhei1' USING DFHEIV0
 16802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16803
 16804
 16805
 16806* EXEC CICS START
 16807*             INTERVAL    (0)
 16808*             TRANSID     (W-PRINT-TRANS)
 16809*             FROM        (PROGRAM-INTERFACE-BLOCK)
 16810*             LENGTH      (PI-COMM-LENGTH)
 16811*             TERMID      (W-TS-TERM-TEXT)
 16812*    END-EXEC.
 16813     MOVE 0 TO DFHEIV10
 16814*    MOVE '0(ILFT                1   #00015614' TO DFHEIV0
 16815     MOVE X'3028494C4654202020202020' TO DFHEIV0(1:12)
 16816     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
 16817     MOVE X'2020233030303135363134' TO DFHEIV0(25:11)
 16818     CALL 'kxdfhei1' USING DFHEIV0,
 16819           DFHEIV10,
 16820           W-PRINT-TRANS,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 357
* EL689.cbl
 16821           DFHEIV99,
 16822           PROGRAM-INTERFACE-BLOCK,
 16823           PI-COMM-LENGTH,
 16824           W-TS-TERM-TEXT,
 16825           DFHEIV99,
 16826           DFHEIV99,
 16827           DFHEIV99,
 16828           DFHEIV99,
 16829           DFHEIV99,
 16830           DFHEIV99,
 16831           DFHEIV99,
 16832           DFHEIV99,
 16833           DFHEIV99,
 16834           DFHEIV99
 16835     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16836
 16837
 16838
 16839* EXEC CICS SYNCPOINT
 16840*    END-EXEC.
 16841*    MOVE '6"                    !   #00015622' TO DFHEIV0
 16842     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
 16843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16844     MOVE X'2020233030303135363232' TO DFHEIV0(25:11)
 16845     CALL 'kxdfhei1' USING DFHEIV0
 16846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16847
 16848
 16849     IF  PI-689-CREATE-NO-SCREENS
 16850         GO TO 7900-EXIT.
 16851
 16852*    IF  EIBAID EQUAL DFHPF8
 16853*            AND
 16854*        PI-SHOW-MODE
 16855*            AND
 16856*        LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
 16857*        PERFORM 7920-UPDATE-INITIAL-PRINT THRU 7920-EXIT.
 16858
 16859     MOVE ER-0189                TO EMI-ERROR.
 16860     MOVE -1                     TO MAINTL.
 16861
 16862     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
 16863     MOVE -1                     TO MAINTL
 16864     MOVE AL-UABON               TO MAINTA
 16865     MOVE '104A'                 TO W-TS-ID-TEXT
 16866     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 16867                                    W-TS-TERM-SCREEN
 16868     GO TO 8200-SEND-DATAONLY.
 16869
 16870 7900-EXIT.
 16871     EXIT.
 16872
 16873 7915-SEARCH-REMAINING-VARS.
 16874
 16875     IF  W-REC-CHAR (W-RVS-NDX) EQUAL '@'
 16876         SET W-RVS-NDX2          TO W-RVS-NDX
 16877         SET W-RVS-NDX2 UP BY +1
 16878         IF  W-REC-CHAR (W-RVS-NDX2) EQUAL '@'
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 358
* EL689.cbl
 16879             SET W-RVS-NDX2 UP BY +1
 16880             IF  W-REC-CHAR (W-RVS-NDX2) NUMERIC
 16881                 SET PI-CURRENT-LINE  TO W-RVS-NDX
 16882                 COMPUTE PI-CURRENT-LINE
 16883                     = PI-CURRENT-LINE / 73
 16884                 MOVE 'Y'        TO W-REMAINING-VAR-SW
 16885                 MOVE +0         TO W-ROLL-COUNTER
 16886                 MOVE ER-0191    TO EMI-ERROR
 16887                 MOVE -1         TO MAINTL
 16888                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16889
 16890 7915-EXIT.
 16891     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 359
* EL689.cbl
 16893 7920-UPDATE-INITIAL-PRINT.
 16894
 16895
 16896* EXEC CICS HANDLE CONDITION
 16897*         NOTOPEN    (8010-ARCH-NOT-OPEN)
 16898*         NOTFND     (1070-ARCH-NOT-FOUND)
 16899*         ENDFILE    (1070-ARCH-NOT-FOUND)
 16900*    END-EXEC.
 16901*    MOVE '"$JI''                 ! = #00015671' TO DFHEIV0
 16902     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
 16903     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 16904     MOVE X'3D20233030303135363731' TO DFHEIV0(25:11)
 16905     CALL 'kxdfhei1' USING DFHEIV0
 16906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16907
 16908     MOVE PI-COMPANY-CD TO W-ARCH-COMPANY-CD
 16909     MOVE ARCHNUMI               TO W-ARCH-NUMBER
 16910
 16911* EXEC CICS READ
 16912*        DATASET (W-ARCH-FILE-ID)
 16913*        SET     (ADDRESS OF LETTER-ARCHIVE)
 16914*        RIDFLD  (W-ARCH-PARTIAL-KEY)
 16915*        UPDATE
 16916*    END-EXEC.
 16917*    MOVE '&"S        EU         (   #00015678' TO DFHEIV0
 16918     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 16919     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 16920     MOVE X'2020233030303135363738' TO DFHEIV0(25:11)
 16921     CALL 'kxdfhei1' USING DFHEIV0,
 16922           W-ARCH-FILE-ID,
 16923           DFHEIV20,
 16924           DFHEIV99,
 16925           W-ARCH-PARTIAL-KEY,
 16926           DFHEIV99,
 16927           DFHEIV99,
 16928           DFHEIV99
 16929     SET ADDRESS OF LETTER-ARCHIVE TO
 16930         DFHEIV20
 16931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16932
 16933
 16934     MOVE W-SAVE-BIN-DATE        TO LA-INITIAL-PRINT-DATE.
 16935
 16936     IF  LA-RESEND-DATE = LOW-VALUES
 16937         MOVE 'C'                TO LA-STATUS.
 16938
 16939
 16940* EXEC CICS REWRITE
 16941*         FROM      (LETTER-ARCHIVE)
 16942*         DATASET   (W-ARCH-FILE-ID)
 16943*    END-EXEC.
 16944     MOVE LENGTH OF
 16945      LETTER-ARCHIVE
 16946       TO DFHEIV11
 16947*    MOVE '&& L                  %   #00015690' TO DFHEIV0
 16948     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
 16949     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 16950     MOVE X'2020233030303135363930' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 360
* EL689.cbl
 16951     CALL 'kxdfhei1' USING DFHEIV0,
 16952           W-ARCH-FILE-ID,
 16953           LETTER-ARCHIVE,
 16954           DFHEIV11,
 16955           DFHEIV99
 16956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 16957
 16958
 16959 7920-EXIT.
 16960     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 361
* EL689.cbl
 16962 7935-TERM-ERROR.
 16963
 16964     MOVE ER-0412                TO EMI-ERROR.
 16965     MOVE SPACES                 TO PI-689-PRINT-SW.
 16966     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16967     MOVE -1                     TO MAINTL.
 16968     GO TO 8200-SEND-DATAONLY.
 16969
 16970 7940-TRAN-ERROR.
 16971
 16972     MOVE ER-0413                TO EMI-ERROR.
 16973     MOVE SPACES                 TO PI-689-PRINT-SW.
 16974     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16975     MOVE -1                     TO MAINTL.
 16976     GO TO 8200-SEND-DATAONLY.
 16977
 16978 7945-NOT-FOUND.
 16979
 16980     MOVE ER-0190                TO EMI-ERROR.
 16981     MOVE -1                     TO MAINTL.
 16982     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16983     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 362
* EL689.cbl
 16985 8010-ARCH-NOT-OPEN.
 16986
 16987     MOVE ER-7388                TO EMI-ERROR.
 16988     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16989     MOVE -1                     TO MAINTL.
 16990     GO TO 8200-SEND-DATAONLY.
 16991
 16992 8015-ARCT-NOT-OPEN.
 16993
 16994     MOVE ER-7373                TO EMI-ERROR.
 16995     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 16996     MOVE -1                     TO MAINTL.
 16997     GO TO 8200-SEND-DATAONLY.
 16998
 16999 8020-ACCT-NOT-OPEN.
 17000
 17001     MOVE ER-0168 TO EMI-ERROR
 17002     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17003     MOVE -1                     TO MAINTL.
 17004     GO TO 8200-SEND-DATAONLY.
 17005
 17006 8030-CERT-NOT-OPEN.
 17007
 17008     MOVE ER-0169 TO EMI-ERROR.
 17009     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17010     MOVE -1                     TO MAINTL.
 17011     GO TO 8200-SEND-DATAONLY.
 17012
 17013 8035-CERT-NOT-FOUND.
 17014
 17015     MOVE ER-2369 TO EMI-ERROR.
 17016     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17017     MOVE -1                     TO MAINTL.
 17018     GO TO 8200-SEND-DATAONLY.
 17019
 17020 8040-CNTL-NOT-OPEN.
 17021
 17022     MOVE ER-0042                TO EMI-ERROR.
 17023     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17024     MOVE -1                     TO MAINTL.
 17025     GO TO 8200-SEND-DATAONLY.
 17026
 17027 8045-CHEK-NOT-OPEN.
 17028
 17029     MOVE ER-3775                TO EMI-ERROR.
 17030     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17031     MOVE -1                     TO MAINTL.
 17032     GO TO 8200-SEND-DATAONLY.
 17033
 17034 8050-TEXT-NOT-OPEN.
 17035
 17036     MOVE ER-0013                TO EMI-ERROR.
 17037     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17038     MOVE -1                     TO MAINTL.
 17039     GO TO 8200-SEND-DATAONLY.
 17040
 17041 8060-PNDB-NOT-OPEN.
 17042
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 363
* EL689.cbl
 17043     MOVE ER-2216 TO EMI-ERROR.
 17044     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17045     MOVE -1                     TO MAINTL.
 17046     GO TO 8200-SEND-DATAONLY.
 17047
 17048 8070-PNDB-NOT-FOUND.
 17049
 17050     MOVE ER-7374 TO EMI-ERROR.
 17051     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17052     MOVE -1                     TO MAINTL.
 17053     GO TO 8200-SEND-DATAONLY.
 17054
 17055 8080-COMP-NOT-OPEN.
 17056
 17057     MOVE ER-2055 TO EMI-ERROR
 17058     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17059     MOVE -1                     TO MAINTL.
 17060     GO TO 8200-SEND-DATAONLY.
 17061
 17062 8085-PYAJ-NOT-OPEN.
 17063
 17064     MOVE ER-2232 TO EMI-ERROR
 17065     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17066     MOVE -1                     TO MAINTL.
 17067     GO TO 8200-SEND-DATAONLY.
 17068
 17069 8090-MAIL-NOT-OPEN.
 17070
 17071     MOVE ER-2999                TO EMI-ERROR.
 17072     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17073     MOVE -1                     TO MAINTL.
 17074     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 364
* EL689.cbl
 17076 8100-SEND-INITIAL-MAP.
 17077
 17078     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT
 17079     IF  PI-689-CREATE-NO-SCREENS
 17080         MOVE '9999'             TO PI-689-ERROR
 17081         GO TO 0620-RETURN-TO-CALLER.
 17082
 17083     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17084
 17085     IF  NOT EMI-NO-ERRORS
 17086         MOVE EMI-MESSAGE-AREA (1)
 17087                                 TO ERRMSGO
 17088     ELSE
 17089         MOVE SPACES             TO ERRMSGO.
 17090     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
 17091                                 TO SYSO
 17092     MOVE WS-KIXHOST             TO HOSTO
 17093     IF PI-PROCESSOR-ID = 'LMLC' OR 'SPJA' OR 'KAWA' OR 'CAGB'
 17094        OR 'DLVA' OR 'ECCA' OR 'KRHA'
 17095        MOVE AL-SADOF            TO PF8HDA
 17096     END-IF
 17097     IF NOT PI-CREATE-LABELS
 17098         MOVE AL-PANON           TO ADDRLBLA.
 17099
 17100
 17101* EXEC CICS SEND
 17102*        MAP    (W-MAP)
 17103*        MAPSET (W-MAPSET)
 17104*        FROM   (EL689AO)
 17105*        ERASE
 17106*        CURSOR
 17107*    END-EXEC.
 17108     MOVE LENGTH OF
 17109      EL689AO
 17110       TO DFHEIV12
 17111     MOVE -1
 17112       TO DFHEIV11
 17113*    MOVE '8$     CT  E    H L F ,   #00015836' TO DFHEIV0
 17114     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 17115     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17116     MOVE X'2020233030303135383336' TO DFHEIV0(25:11)
 17117     CALL 'kxdfhei1' USING DFHEIV0,
 17118           W-MAP,
 17119           EL689AO,
 17120           DFHEIV12,
 17121           W-MAPSET,
 17122           DFHEIV99,
 17123           DFHEIV99,
 17124           DFHEIV99,
 17125           DFHEIV11,
 17126           DFHEIV99,
 17127           DFHEIV99,
 17128           DFHEIV99
 17129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17130
 17131
 17132     GO TO 9000-RETURN-TRANS.
 17133
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 365
* EL689.cbl
 17134 8100-EXIT.
 17135     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 366
* EL689.cbl
 17137 8200-SEND-DATAONLY.
 17138
 17139     PERFORM 7760-PUT-TEMP-STORAGE THRU 7760-EXIT.
 17140     IF  PI-689-CREATE-NO-SCREENS
 17141         MOVE '9999'             TO PI-689-ERROR
 17142         GO TO 0620-RETURN-TO-CALLER.
 17143
 17144     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17145
 17146     IF EMI-ERROR = ER-0715
 17147         DISPLAY 'ER 0715'
 17148         MOVE -1          TO CERTIDL
 17149         MOVE +0          TO MAINTL
 17150     END-IF
 17151
 17152     IF  NOT EMI-NO-ERRORS
 17153         MOVE EMI-MESSAGE-AREA (1)
 17154                                 TO ERRMSGO
 17155     ELSE
 17156         MOVE SPACES             TO ERRMSGO.
 17157
 17158
 17159* EXEC CICS SEND
 17160*        MAP    (W-MAP)
 17161*        MAPSET (W-MAPSET)
 17162*        FROM   (EL689AO)
 17163*        DATAONLY
 17164*        CURSOR
 17165*    END-EXEC.
 17166     MOVE LENGTH OF
 17167      EL689AO
 17168       TO DFHEIV12
 17169     MOVE -1
 17170       TO DFHEIV11
 17171*    MOVE '8$D    CT       H L F ,   #00015870' TO DFHEIV0
 17172     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 17173     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17174     MOVE X'2020233030303135383730' TO DFHEIV0(25:11)
 17175     CALL 'kxdfhei1' USING DFHEIV0,
 17176           W-MAP,
 17177           EL689AO,
 17178           DFHEIV12,
 17179           W-MAPSET,
 17180           DFHEIV99,
 17181           DFHEIV99,
 17182           DFHEIV99,
 17183           DFHEIV11,
 17184           DFHEIV99,
 17185           DFHEIV99,
 17186           DFHEIV99
 17187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17188
 17189
 17190     GO TO 9000-RETURN-TRANS.
 17191
 17192 8200-EXIT.
 17193     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 367
* EL689.cbl
 17195 8300-SEND-TEXT.
 17196
 17197     IF  PI-689-CREATE-NO-SCREENS
 17198         MOVE '9999'             TO PI-689-ERROR
 17199         GO TO 0620-RETURN-TO-CALLER.
 17200
 17201
 17202* EXEC CICS SEND TEXT
 17203*        FROM    (LOGOFF-TEXT)
 17204*        LENGTH  (LOGOFF-LENGTH)
 17205*        ERASE
 17206*        FREEKB
 17207*    END-EXEC.
 17208*    MOVE '8&      T  E F  H   F -   #00015889' TO DFHEIV0
 17209     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 17210     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 17211     MOVE X'2020233030303135383839' TO DFHEIV0(25:11)
 17212     CALL 'kxdfhei1' USING DFHEIV0,
 17213           LOGOFF-TEXT,
 17214           LOGOFF-LENGTH,
 17215           DFHEIV99,
 17216           DFHEIV99,
 17217           DFHEIV99,
 17218           DFHEIV99,
 17219           DFHEIV99,
 17220           DFHEIV99,
 17221           DFHEIV99,
 17222           DFHEIV99,
 17223           DFHEIV99,
 17224           DFHEIV99
 17225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17226
 17227
 17228     GO TO 9000-RETURN-TRANS.
 17229
 17230 8300-EXIT.
 17231     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 368
* EL689.cbl
 17233 8350-SEND-DATAONLY-ERASEAUP.
 17234
 17235     MOVE EIBTRMID               TO W-TS-TERM-TEXT
 17236     PERFORM 7760-PUT-TEMP-STORAGE
 17237                                 THRU 7760-EXIT
 17238     IF  PI-689-CREATE-NO-SCREENS
 17239         MOVE '9999'             TO PI-689-ERROR
 17240         GO TO 0620-RETURN-TO-CALLER.
 17241
 17242     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
 17243
 17244     IF EMI-ERROR = ER-0715
 17245         DISPLAY 'ER 0715'
 17246         MOVE -1          TO CERTIDL
 17247         MOVE +0          TO MAINTL
 17248     END-IF
 17249
 17250     IF  NOT EMI-NO-ERRORS
 17251         MOVE EMI-MESSAGE-AREA (1)
 17252                                 TO ERRMSGO
 17253     ELSE
 17254         MOVE SPACES             TO ERRMSGO.
 17255
 17256
 17257* EXEC CICS SEND
 17258*        MAP      (W-MAP)
 17259*        MAPSET   (W-MAPSET)
 17260*        FROM     (EL689AO)
 17261*        DATAONLY
 17262*        ERASEAUP
 17263*        CURSOR
 17264*    END-EXEC.
 17265     MOVE LENGTH OF
 17266      EL689AO
 17267       TO DFHEIV12
 17268     MOVE -1
 17269       TO DFHEIV11
 17270*    MOVE '8$D    CT  A    H L F ,   #00015924' TO DFHEIV0
 17271     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
 17272     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 17273     MOVE X'2020233030303135393234' TO DFHEIV0(25:11)
 17274     CALL 'kxdfhei1' USING DFHEIV0,
 17275           W-MAP,
 17276           EL689AO,
 17277           DFHEIV12,
 17278           W-MAPSET,
 17279           DFHEIV99,
 17280           DFHEIV99,
 17281           DFHEIV99,
 17282           DFHEIV11,
 17283           DFHEIV99,
 17284           DFHEIV99,
 17285           DFHEIV99
 17286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17287
 17288
 17289     GO TO 9000-RETURN-TRANS.
 17290
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 369
* EL689.cbl
 17291 8350-EXIT.
 17292     EXIT.
 17293
 17294 8600-DEEDIT.
 17295
 17296
 17297* EXEC CICS BIF DEEDIT
 17298*         FIELD    (W-DEEDIT-FIELD)
 17299*         LENGTH   (15)
 17300*    END-EXEC.
 17301     MOVE 15
 17302       TO DFHEIV11
 17303*    MOVE '@"L                   #   #00015940' TO DFHEIV0
 17304     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 17305     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 17306     MOVE X'2020233030303135393430' TO DFHEIV0(25:11)
 17307     CALL 'kxdfhei1' USING DFHEIV0,
 17308           W-DEEDIT-FIELD,
 17309           DFHEIV11
 17310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17311
 17312
 17313 8600-EXIT.
 17314     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 370
* EL689.cbl
 17316 9000-RETURN-TRANS.
 17317
 17318     MOVE EMI-FATAL-CTR      TO PI-689-FATAL-CTR
 17319     MOVE EMI-FORCABLE-CTR   TO PI-689-FORCABLE-CTR
 17320     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO
 17321     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO
 17322
 17323* EXEC CICS RETURN
 17324*        TRANSID    (W-TRANSACTION)
 17325*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 17326*        LENGTH     (PI-COMM-LENGTH)
 17327*    END-EXEC.
 17328*    MOVE '.(CT                  ''   #00015954' TO DFHEIV0
 17329     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 17330     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17331     MOVE X'2020233030303135393534' TO DFHEIV0(25:11)
 17332     CALL 'kxdfhei1' USING DFHEIV0,
 17333           W-TRANSACTION,
 17334           PROGRAM-INTERFACE-BLOCK,
 17335           PI-COMM-LENGTH,
 17336           DFHEIV99,
 17337           DFHEIV99,
 17338           DFHEIV99
 17339     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17340
 17341*    MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 17342*    MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 17343*    GO TO 0200-RECEIVE.
 17344
 17345 9000-EXIT.
 17346     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 371
* EL689.cbl
 17348 9200-PA.
 17349
 17350     MOVE ER-0008                TO EMI-ERROR.
 17351     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 17352     MOVE -1                     TO MAINTL.
 17353     GO TO 8200-SEND-DATAONLY.
 17354
 17355 9200-EXIT.
 17356     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 372
* EL689.cbl
 17358 9300-DFHCLEAR.
 17359
 17360     IF PI-RETURN-TO-PROGRAM = 'EL689' OR 'EL690'
 17361         MOVE '2'                TO PI-ACTION.
 17362
 17363     IF  PI-CLEAR-MODE
 17364         MOVE PI-RETURN-TO-PROGRAM
 17365                                 TO W-CALL-PGM
 17366         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 17367         GO TO 9400-XCTL
 17368     ELSE
 17369         PERFORM 7780-DELETE-TEMP-STOR-TEXT THRU 7780-EXIT
 17370         MOVE LOW-VALUES         TO EL689AO
 17371                                    PI-1042-WA
 17372                                    PI-689-WORK-AREA
 17373         MOVE ZEROS              TO PI-CURRENT-LINE
 17374                                    PI-TEMP-STOR-ITEMS
 17375                                    PI-TOTAL-LINES
 17376                                    PI-UPDATE-SW
 17377                                    PI-689-NUMBER-LABEL-LINES
 17378         MOVE SPACES             TO PI-689-PRINT-SW
 17379                                    PI-689-ALT-PRINTER-ID
 17380                                    PI-COMM-CONTROL
 17381                                    PI-689-FORM-NUMBER
 17382                                    PI-689-TEMP-STOR-ID
 17383                                    PI-689-LABEL-SOURCE
 17384                                    PI-689-USE-SCREEN-IND
 17385         MOVE '2'                TO PI-ACTION
 17386         MOVE -1                 TO MAINTL
 17387         GO TO 8100-SEND-INITIAL-MAP.
 17388
 17389 9300-EXIT.
 17390     EXIT.
 17391
 17392 9400-XCTL.
 17393
 17394
 17395* EXEC CICS XCTL
 17396*        PROGRAM  (W-CALL-PGM)
 17397*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
 17398*        LENGTH   (PI-COMM-LENGTH)
 17399*    END-EXEC.
 17400*    MOVE '.$C                   %   #00016012' TO DFHEIV0
 17401     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 17402     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 17403     MOVE X'2020233030303136303132' TO DFHEIV0(25:11)
 17404     CALL 'kxdfhei1' USING DFHEIV0,
 17405           W-CALL-PGM,
 17406           PROGRAM-INTERFACE-BLOCK,
 17407           PI-COMM-LENGTH,
 17408           DFHEIV99
 17409     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17410
 17411
 17412 9400-EXIT.
 17413     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 373
* EL689.cbl
 17415 9500-LINK-DATE-CONVERT.
 17416
 17417     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
 17418             AND
 17419         DC-OPTION-CODE EQUAL ' '
 17420         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
 17421         GO TO 9500-EXIT.
 17422
 17423
 17424* EXEC CICS LINK
 17425*        PROGRAM    ('ELDATCV')
 17426*        COMMAREA   (DATE-CONVERSION-DATA)
 17427*        LENGTH     (DC-COMM-LENGTH)
 17428*    END-EXEC.
 17429     MOVE 'ELDATCV' TO DFHEIV1
 17430*    MOVE '."C                   (   #00016029' TO DFHEIV0
 17431     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17432     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17433     MOVE X'2020233030303136303239' TO DFHEIV0(25:11)
 17434     CALL 'kxdfhei1' USING DFHEIV0,
 17435           DFHEIV1,
 17436           DATE-CONVERSION-DATA,
 17437           DC-COMM-LENGTH,
 17438           DFHEIV99,
 17439           DFHEIV99,
 17440           DFHEIV99,
 17441           DFHEIV99
 17442     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17443
 17444
 17445     IF  NO-CONVERSION-ERROR
 17446             AND
 17447         PI-COMPANY-ID EQUAL 'AUK'
 17448             AND
 17449         W-REVERSE-DATE
 17450         MOVE DC-GREG-DATE-1-EDIT
 17451                                 TO W-EDIT-DATE-1
 17452         MOVE W-ED1-MM           TO W-ED2-MM
 17453         MOVE W-ED1-DD           TO W-ED2-DD
 17454         MOVE W-ED1-YY           TO W-ED2-YY
 17455         MOVE W-EDIT-DATE-2      TO DC-GREG-DATE-1-EDIT.
 17456
 17457 9500-EXIT.
 17458     EXIT.
 17459
 17460 9600-FORMAT-DATE-TIME.
 17461
 17462     MOVE W-SAVE-DATE            TO RUNDTEO.
 17463     MOVE EIBTIME                TO W-TIME-IN.
 17464     MOVE W-TIME-OUT             TO RUNTIMEO.
 17465     MOVE PI-COMPANY-ID          TO COMPANYO.
 17466     MOVE PI-PROCESSOR-ID        TO USERIDO.
 17467     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
 17468
 17469 9600-EXIT.
 17470     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 374
* EL689.cbl
 17472 9700-PGMID-ERROR.
 17473
 17474     IF  PI-689-CREATE-NO-SCREENS
 17475         MOVE '9999'             TO PI-689-ERROR
 17476         GO TO 0620-RETURN-TO-CALLER.
 17477
 17478
 17479* EXEC CICS  HANDLE CONDITION
 17480*        PGMIDERR  (8300-SEND-TEXT)
 17481*    END-EXEC.
 17482*    MOVE '"$L                   ! > #00016068' TO DFHEIV0
 17483     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 17484     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 17485     MOVE X'3E20233030303136303638' TO DFHEIV0(25:11)
 17486     CALL 'kxdfhei1' USING DFHEIV0
 17487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17488
 17489
 17490     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
 17491     MOVE ' '                    TO PI-ENTRY-CD-1.
 17492     MOVE W-XCTL-005             TO W-CALL-PGM
 17493                                    LOGOFF-PGM.
 17494     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 17495
 17496     PERFORM 9400-XCTL THRU 9400-EXIT.
 17497
 17498 9700-EXIT.
 17499     EXIT.
 17500
 17501 9800-ABEND.
 17502
 17503     IF  PI-689-CREATE-NO-SCREENS
 17504         MOVE '9999'             TO PI-689-ERROR
 17505         GO TO 0620-RETURN-TO-CALLER.
 17506
 17507     MOVE W-LINK-004             TO W-CALL-PGM.
 17508     MOVE DFHEIBLK               TO EMI-LINE1
 17509
 17510
 17511* EXEC CICS  LINK
 17512*        PROGRAM   (W-CALL-PGM)
 17513*        COMMAREA  (EMI-LINE1)
 17514*        LENGTH    (72)
 17515*    END-EXEC.
 17516     MOVE 72
 17517       TO DFHEIV11
 17518*    MOVE '."C                   (   #00016092' TO DFHEIV0
 17519     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17520     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17521     MOVE X'2020233030303136303932' TO DFHEIV0(25:11)
 17522     CALL 'kxdfhei1' USING DFHEIV0,
 17523           W-CALL-PGM,
 17524           EMI-LINE1,
 17525           DFHEIV11,
 17526           DFHEIV99,
 17527           DFHEIV99,
 17528           DFHEIV99,
 17529           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 375
* EL689.cbl
 17530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17531
 17532
 17533     GO TO 8200-SEND-DATAONLY.
 17534
 17535 9800-EXIT.
 17536     EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 376
* EL689.cbl
 17538 9900-ERROR-FORMAT.
 17539
 17540     IF  PI-689-CREATE-NO-SCREENS
 17541         MOVE EMI-ERROR          TO PI-689-ERROR
 17542         IF  PI-689-FATAL-ERROR
 17543             GO TO 0620-RETURN-TO-CALLER
 17544         ELSE
 17545             GO TO 9900-EXIT.
 17546
 17547     IF  EMI-ERROR EQUAL ER-9097
 17548         NEXT SENTENCE
 17549     ELSE
 17550         IF  EMI-ERRORS-COMPLETE
 17551                 OR
 17552             EMI-ERROR EQUAL W-LAST-ERROR
 17553             GO TO 9900-EXIT.
 17554
 17555     MOVE W-LINK-001             TO W-CALL-PGM.
 17556
 17557
 17558* EXEC CICS LINK
 17559*        PROGRAM    (W-CALL-PGM)
 17560*        COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 17561*        LENGTH     (EMI-COMM-LENGTH)
 17562*    END-EXEC.
 17563*    MOVE '."C                   (   #00016122' TO DFHEIV0
 17564     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17565     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17566     MOVE X'2020233030303136313232' TO DFHEIV0(25:11)
 17567     CALL 'kxdfhei1' USING DFHEIV0,
 17568           W-CALL-PGM,
 17569           ERROR-MESSAGE-INTERFACE-BLOCK,
 17570           EMI-COMM-LENGTH,
 17571           DFHEIV99,
 17572           DFHEIV99,
 17573           DFHEIV99,
 17574           DFHEIV99
 17575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17576
 17577
 17578     IF  EMI-SEVERITY (2) EQUAL 'X'
 17579             AND
 17580         EMI-SEVERITY (1) NOT EQUAL 'X'
 17581         MOVE EMI-MESSAGE-AREA (2)
 17582                                 TO EMI-MESSAGE-AREA (1).
 17583
 17584     MOVE EMI-ERROR              TO W-LAST-ERROR.
 17585
 17586 9900-EXIT.
 17587     EXIT.
 17588
 17589 9905-INITIALIZE-SECURITY.
 17590******************************************************************
 17591*                                                                *
 17592*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
 17593*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
 17594*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
 17595*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 377
* EL689.cbl
 17596*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
 17597*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
 17598*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
 17599*       ERROR CONDITION AND EXIT THE PROGRAM.                    *
 17600*                                                                *
 17601*       NOTE:  THE CARRIER/GRP/STATE/ACCOUNT SECURITY DATA       *
 17602*       IS ALSO PROVIDED BY THIS LOGIC.                          *
 17603*                                                                *
 17604******************************************************************
 17605
 17606     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
 17607         MOVE 'Y'                TO PI-DISPLAY-CAP
 17608                                    PI-MODIFY-CAP
 17609     ELSE
 17610
 17611* EXEC CICS READQ TS
 17612*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
 17613*            INTO   (SECURITY-CONTROL)
 17614*            LENGTH (SC-COMM-LENGTH)
 17615*            ITEM   (1)
 17616*        END-EXEC
 17617     MOVE 1
 17618       TO DFHEIV11
 17619*    MOVE '*$II   L              ''   #00016160' TO DFHEIV0
 17620     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
 17621     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 17622     MOVE X'2020233030303136313630' TO DFHEIV0(25:11)
 17623     CALL 'kxdfhei1' USING DFHEIV0,
 17624           PI-SECURITY-TEMP-STORE-ID,
 17625           SECURITY-CONTROL,
 17626           SC-COMM-LENGTH,
 17627           DFHEIV11,
 17628           DFHEIV99,
 17629           DFHEIV99
 17630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 17631         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
 17632                                 TO PI-DISPLAY-CAP
 17633         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
 17634                                 TO PI-MODIFY-CAP.
 17635
 17636 9905-EXIT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 378
* EL689.cbl
 17638 9995-SECURITY-VIOLATION.
 17639
 17640     MOVE EIBDATE                TO SM-JUL-DATE.
 17641     MOVE EIBTRMID               TO SM-TERMID.
 17642     MOVE W-THIS-PGM             TO SM-PGM.
 17643     MOVE EIBTIME                TO W-TIME-IN.
 17644     MOVE W-TIME-OUT             TO SM-TIME.
 17645     MOVE PI-PROCESSOR-ID        TO SM-PROCESSOR-ID.
 17646
 17647
 17648* EXEC CICS LINK
 17649*         PROGRAM  ('EL003')
 17650*         COMMAREA (SECURITY-MESSAGE)
 17651*         LENGTH   (80)
 17652*    END-EXEC.
 17653     MOVE 'EL003' TO DFHEIV1
 17654     MOVE 80
 17655       TO DFHEIV11
 17656*    MOVE '."C                   (   #00016182' TO DFHEIV0
 17657     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 17658     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 17659     MOVE X'2020233030303136313832' TO DFHEIV0(25:11)
 17660     CALL 'kxdfhei1' USING DFHEIV0,
 17661           DFHEIV1,
 17662           SECURITY-MESSAGE,
 17663           DFHEIV11,
 17664           DFHEIV99,
 17665           DFHEIV99,
 17666           DFHEIV99,
 17667           DFHEIV99
 17668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 17669
 17670
 17671 9995-EXIT.
 17672     EXIT.
 17673
 17674 9999-GOBACK.
 17675
 17676
 17677* GOBACK.
 17678     MOVE '9%                    "   ' TO DFHEIV0
 17679     MOVE 'EL689' TO DFHEIV1
 17680     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17681     GOBACK.
 17682
 17683 9999-EXIT.
 17684     EXIT.
 17685
 17686 9999-DFHBACK SECTION.
 17687     MOVE '9%                    "   ' TO DFHEIV0
 17688     MOVE 'EL689' TO DFHEIV1
 17689     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17690     GOBACK.
 17691 9999-DFHEXIT.
 17692     IF DFHEIGDJ EQUAL 0001
 17693         NEXT SENTENCE
 17694     ELSE IF DFHEIGDJ EQUAL 2
 17695         GO TO 9300-DFHCLEAR,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 379
* EL689.cbl
 17696               9200-PA,
 17697               9200-PA,
 17698               9200-PA
 17699         DEPENDING ON DFHEIGDI
 17700     ELSE IF DFHEIGDJ EQUAL 3
 17701         GO TO 9700-PGMID-ERROR,
 17702               9800-ABEND,
 17703               0325-MAPFAIL
 17704         DEPENDING ON DFHEIGDI
 17705     ELSE IF DFHEIGDJ EQUAL 4
 17706         GO TO 8040-CNTL-NOT-OPEN,
 17707               7945-NOT-FOUND
 17708         DEPENDING ON DFHEIGDI
 17709     ELSE IF DFHEIGDJ EQUAL 5
 17710         GO TO 9700-PGMID-ERROR,
 17711               0325-MAPFAIL,
 17712               9800-ABEND
 17713         DEPENDING ON DFHEIGDI
 17714     ELSE IF DFHEIGDJ EQUAL 6
 17715         GO TO 0990-CARRIER-NOT-FOUND,
 17716               8040-CNTL-NOT-OPEN
 17717         DEPENDING ON DFHEIGDI
 17718     ELSE IF DFHEIGDJ EQUAL 7
 17719         GO TO 0994-STATE-NOT-FOUND,
 17720               8040-CNTL-NOT-OPEN
 17721         DEPENDING ON DFHEIGDI
 17722     ELSE IF DFHEIGDJ EQUAL 8
 17723         GO TO 8010-ARCH-NOT-OPEN,
 17724               1070-ARCH-NOT-FOUND,
 17725               1070-ARCH-NOT-FOUND
 17726         DEPENDING ON DFHEIGDI
 17727     ELSE IF DFHEIGDJ EQUAL 9
 17728         GO TO 2001-NOT-FOUND,
 17729               2001-NOT-FOUND,
 17730               8050-TEXT-NOT-OPEN
 17731         DEPENDING ON DFHEIGDI
 17732     ELSE IF DFHEIGDJ EQUAL 10
 17733         GO TO 2000-ENDBR
 17734         DEPENDING ON DFHEIGDI
 17735     ELSE IF DFHEIGDJ EQUAL 11
 17736         GO TO 8040-CNTL-NOT-OPEN,
 17737               6200-CNTL1-NOT-FOUND
 17738         DEPENDING ON DFHEIGDI
 17739     ELSE IF DFHEIGDJ EQUAL 12
 17740         GO TO 8040-CNTL-NOT-OPEN,
 17741               6250-CNTL2-NOT-FOUND
 17742         DEPENDING ON DFHEIGDI
 17743     ELSE IF DFHEIGDJ EQUAL 13
 17744         GO TO 8040-CNTL-NOT-OPEN,
 17745               6300-CNTL6-NOT-FOUND
 17746         DEPENDING ON DFHEIGDI
 17747     ELSE IF DFHEIGDJ EQUAL 14
 17748         GO TO 8040-CNTL-NOT-OPEN,
 17749               6350-CNTL2-NOT-FOUND
 17750         DEPENDING ON DFHEIGDI
 17751     ELSE IF DFHEIGDJ EQUAL 15
 17752         GO TO 8060-PNDB-NOT-OPEN,
 17753               8070-PNDB-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 380
* EL689.cbl
 17754         DEPENDING ON DFHEIGDI
 17755     ELSE IF DFHEIGDJ EQUAL 16
 17756         GO TO 8030-CERT-NOT-OPEN,
 17757               8035-CERT-NOT-FOUND
 17758         DEPENDING ON DFHEIGDI
 17759     ELSE IF DFHEIGDJ EQUAL 17
 17760         GO TO 8020-ACCT-NOT-OPEN,
 17761               6500-ACCT-NOT-FOUND,
 17762               6500-ONLY-STOP
 17763         DEPENDING ON DFHEIGDI
 17764     ELSE IF DFHEIGDJ EQUAL 18
 17765         GO TO 8080-COMP-NOT-OPEN,
 17766               6600-COMP-NOT-FOUND
 17767         DEPENDING ON DFHEIGDI
 17768     ELSE IF DFHEIGDJ EQUAL 19
 17769         GO TO 8040-CNTL-NOT-OPEN,
 17770               6630-CNTL2-NOT-FOUND
 17771         DEPENDING ON DFHEIGDI
 17772     ELSE IF DFHEIGDJ EQUAL 20
 17773         GO TO 8090-MAIL-NOT-OPEN,
 17774               6700-MAIL-NOT-FOUND
 17775         DEPENDING ON DFHEIGDI
 17776     ELSE IF DFHEIGDJ EQUAL 21
 17777         GO TO 8040-CNTL-NOT-OPEN,
 17778               6750-EXIT
 17779         DEPENDING ON DFHEIGDI
 17780     ELSE IF DFHEIGDJ EQUAL 22
 17781         GO TO 8040-CNTL-NOT-OPEN,
 17782               6800-EXIT
 17783         DEPENDING ON DFHEIGDI
 17784     ELSE IF DFHEIGDJ EQUAL 23
 17785         GO TO 8045-CHEK-NOT-OPEN,
 17786               6850-CHEK-NOT-FOUND
 17787         DEPENDING ON DFHEIGDI
 17788     ELSE IF DFHEIGDJ EQUAL 24
 17789         GO TO 8085-PYAJ-NOT-OPEN,
 17790               6900-PYAJ-NOT-FOUND
 17791         DEPENDING ON DFHEIGDI
 17792     ELSE IF DFHEIGDJ EQUAL 25
 17793         GO TO 7700-TS-ERROR,
 17794               7700-TS-ERROR
 17795         DEPENDING ON DFHEIGDI
 17796     ELSE IF DFHEIGDJ EQUAL 26
 17797         GO TO 7780-EXIT
 17798         DEPENDING ON DFHEIGDI
 17799     ELSE IF DFHEIGDJ EQUAL 27
 17800         GO TO 8040-CNTL-NOT-OPEN,
 17801               7945-NOT-FOUND
 17802         DEPENDING ON DFHEIGDI
 17803     ELSE IF DFHEIGDJ EQUAL 28
 17804         GO TO 7935-TERM-ERROR,
 17805               7940-TRAN-ERROR
 17806         DEPENDING ON DFHEIGDI
 17807     ELSE IF DFHEIGDJ EQUAL 29
 17808         GO TO 8010-ARCH-NOT-OPEN,
 17809               1070-ARCH-NOT-FOUND,
 17810               1070-ARCH-NOT-FOUND
 17811         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 381
* EL689.cbl
 17812     ELSE IF DFHEIGDJ EQUAL 30
 17813         GO TO 8300-SEND-TEXT
 17814         DEPENDING ON DFHEIGDI.
 17815     MOVE '9%                    "   ' TO DFHEIV0
 17816     MOVE 'EL689' TO DFHEIV1
 17817     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 17818     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      232716     Code:       60394
