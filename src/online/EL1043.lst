* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL1043.cbl
* Options: int("EL1043.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1043.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1043.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1043.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1043.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:40:03.
     7*                            VMOD=2.003
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL1043.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    TRANSACTION - EXM7 - CREDIT VARIABLE CONVERTER
    26
    27 ENVIRONMENT DIVISION.
    28
    29 DATA DIVISION.
    30 WORKING-STORAGE SECTION.
    31 01  DFH-START PIC X(04).
    32 77  FILLER  PIC X(32)  VALUE '********************************'.
    33 77  FILLER  PIC X(32)  VALUE '*    EL1043 WORKING STORAGE    *'.
    34 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.003 *********'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL1043.cbl
    36
    37 01  W-WORK-AREAS.
    38     12  FILLER                  PIC  X(18)
    39                                      VALUE 'PROGRAM WORK AREA:'.
    40     12  W-EXTRA-LENGTH          PIC S9(04)  COMP   VALUE +0.
    41     12  W-TOTAL-TX-LINES        PIC S9(03)  COMP-3 VALUE +0.
    42     12  W-LAST-SKIP-LINES       PIC  9(02)         VALUE  0.
    43     12  W-SKIP-LINES            PIC  9(02)         VALUE  0.
    44
    45     12  W-CALL-PGM              PIC  X(08).
    46     12  W-SAVE-BIN-DATE         PIC  X(02)  VALUE SPACES.
    47     12  W-SAVE-DATE             PIC  X(08)  VALUE SPACES.
    48     12  W-SAVE-PLAN             PIC  X(02)  VALUE SPACES.
    49     12  W-TEXT-RECORD.
    50         16  FILLER              PIC  X(02).
    51         16  W-TR-KEY.
    52             20  FILLER          PIC  X(01).
    53             20  W-TR-LETTER-NO  PIC  X(04).
    54             20  FILLER          PIC  X(08).
    55             20  W-TR-SEQ-NO     PIC S9(04) COMP.
    56         16  FILLER              PIC  X(02).
    57         16  W-TR-TEXT-LINE      PIC  X(70).
    58         16  FILLER              PIC  X(11).
    59
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL1043.cbl
    61 01  W-SWITCH-INDICATORS-AREA.
    62     12  FILLER                  PIC  X(16)
    63                                      VALUE 'PROGRAM SWITCHS:'.
    64     12  W-TEXT-BROWSED-SW       PIC  X(01)  VALUE 'N'.
    65         88  W-TEXT-BROWSE-STARTED           VALUE 'Y'.
    66         88  W-TEXT-BROWSE-NOT-STARTED       VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL1043.cbl
    68 01  W-KEY-AREAS.
    69     12  FILLER                  PIC  X(13)
    70                                      VALUE 'PROGRAM KEYS:'.
    71
    72     12  W-TEXT-SAVE-KEY         PIC  X(05).
    73     12  W-TEXT-KEY.
    74         16  W-TEXT-PARTIAL-KEY.
    75             20  W-TEXT-COMPANY-CD
    76                                 PIC  X(01).
    77             20  W-TEXT-LETTER   PIC  X(04).
    78         16  W-TEXT-FILLER       PIC  X(08)   VALUE SPACES.
    79         16  W-TEXT-SEQ          PIC S9(04)   VALUE +0    COMP.
    80
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL1043.cbl
    82 01  FILLER                      PIC  X(22)
    83                                 VALUE 'INTERFACE AREA STARTS:'.
    84*    COPY ELCINTF.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCINTF.                            *
    89*                            VMOD=2.017                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
    92*                                                                *
    93*       LENGTH = 1024                                            *
    94*                                                                *
    95******************************************************************
    96 01  PROGRAM-INTERFACE-BLOCK.
    97     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
    98     12  PI-CALLING-PROGRAM              PIC X(8).
    99     12  PI-SAVED-PROGRAM-1              PIC X(8).
   100     12  PI-SAVED-PROGRAM-2              PIC X(8).
   101     12  PI-SAVED-PROGRAM-3              PIC X(8).
   102     12  PI-SAVED-PROGRAM-4              PIC X(8).
   103     12  PI-SAVED-PROGRAM-5              PIC X(8).
   104     12  PI-SAVED-PROGRAM-6              PIC X(8).
   105     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   106     12  PI-COMPANY-ID                   PIC XXX.
   107     12  PI-COMPANY-CD                   PIC X.
   108
   109     12  PI-COMPANY-PASSWORD             PIC X(8).
   110
   111     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   112
   113     12  PI-CONTROL-IN-PROGRESS.
   114         16  PI-CARRIER                  PIC X.
   115         16  PI-GROUPING                 PIC X(6).
   116         16  PI-STATE                    PIC XX.
   117         16  PI-ACCOUNT                  PIC X(10).
   118         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   119                                         PIC X(10).
   120         16  PI-CLAIM-CERT-GRP.
   121             20  PI-CLAIM-NO             PIC X(7).
   122             20  PI-CERT-NO.
   123                 25  PI-CERT-PRIME       PIC X(10).
   124                 25  PI-CERT-SFX         PIC X.
   125             20  PI-CERT-EFF-DT          PIC XX.
   126         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   127             20  PI-PLAN-CODE            PIC X(2).
   128             20  PI-REVISION-NUMBER      PIC X(3).
   129             20  PI-PLAN-EFF-DT          PIC X(2).
   130             20  PI-PLAN-EXP-DT          PIC X(2).
   131             20  FILLER                  PIC X(11).
   132         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   133             20  PI-OE-REFERENCE-1.
   134                 25  PI-OE-REF-1-PRIME   PIC X(18).
   135                 25  PI-OE-REF-1-SUFF    PIC XX.
   136
   137     12  PI-SESSION-IN-PROGRESS          PIC X.
   138         88  CLAIM-SESSION                   VALUE '1'.
   139         88  CREDIT-SESSION                  VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL1043.cbl
   140         88  WARRANTY-SESSION                VALUE '3'.
   141         88  MORTGAGE-SESSION                VALUE '4'.
   142         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   143
   144
   145*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   146
   147     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   148     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   149
   150     12  PI-CREDIT-USER                  PIC X.
   151         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   152         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   153
   154     12  PI-CLAIM-USER                   PIC X.
   155         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   156         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   157
   158     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   159         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   160         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   161         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   162         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   163         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   164
   165     12  PI-PROCESSOR-ID                 PIC X(4).
   166
   167     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   168
   169     12  PI-MEMBER-CAPTION               PIC X(10).
   170
   171     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   172         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   173
   174     12  PI-LIFE-OVERRIDE-L1             PIC X.
   175     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   176     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   177     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   178
   179     12  PI-AH-OVERRIDE-L1               PIC X.
   180     12  PI-AH-OVERRIDE-L2               PIC XX.
   181     12  PI-AH-OVERRIDE-L6               PIC X(6).
   182     12  PI-AH-OVERRIDE-L12              PIC X(12).
   183
   184     12  PI-NEW-SYSTEM                   PIC X(2).
   185
   186     12  PI-PRIMARY-CERT-NO              PIC X(11).
   187     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   188         88  PI-USES-PAID-TO                 VALUE '1'.
   189     12  PI-CRDTCRD-SYSTEM.
   190         16  PI-CRDTCRD-USER             PIC X.
   191             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   192             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   193         16  PI-CC-MONTH-END-DT          PIC XX.
   194     12  PI-PROCESSOR-PRINTER            PIC X(4).
   195
   196     12  PI-OE-REFERENCE-2.
   197         16  PI-OE-REF-2-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL1043.cbl
   198         16  PI-OE-REF-2-SUFF            PIC X.
   199
   200     12  PI-REM-TRM-CALC-OPTION          PIC X.
   201
   202     12  PI-LANGUAGE-TYPE                PIC X.
   203             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   204             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   205             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   206
   207     12  PI-POLICY-LINKAGE-IND           PIC X.
   208         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   209         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   210                                                   LOW-VALUES.
   211
   212     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   213     12  PI-CLAIM-PW-SESSION             PIC X(1).
   214         88  PI-CLAIM-CREDIT                 VALUE '1'.
   215         88  PI-CLAIM-CONVEN                 VALUE '2'.
   216     12  FILLER                          PIC X(4).
   217
   218     12  PI-SYSTEM-LEVEL                 PIC X(145).
   219
   220     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   221         PI-SYSTEM-LEVEL.
   222
   223         16  PI-ENTRY-CODES.
   224             20  PI-ENTRY-CD-1           PIC X.
   225             20  PI-ENTRY-CD-2           PIC X.
   226
   227         16  PI-RETURN-CODES.
   228             20  PI-RETURN-CD-1          PIC X.
   229             20  PI-RETURN-CD-2          PIC X.
   230
   231         16  PI-UPDATE-STATUS-SAVE.
   232             20  PI-UPDATE-BY            PIC X(4).
   233             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   234
   235         16  PI-LOWER-CASE-LETTERS       PIC X.
   236             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   237
   238*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   239*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   240*            88  CARRIER-CLM-CNTL            VALUE '2'.
   241
   242         16  PI-CERT-ACCESS-CONTROL      PIC X.
   243             88  ST-ACCNT-CNTL               VALUE ' '.
   244             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   245             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   246             88  ACCNT-CNTL                  VALUE '3'.
   247             88  CARR-ACCNT-CNTL             VALUE '4'.
   248
   249         16  PI-PROCESSOR-CAP-LIST.
   250             20  PI-SYSTEM-CONTROLS.
   251                24 PI-SYSTEM-DISPLAY     PIC X.
   252                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   253                24 PI-SYSTEM-MODIFY      PIC X.
   254                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   255             20  FILLER                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL1043.cbl
   256             20  PI-DISPLAY-CAP          PIC X.
   257                 88  DISPLAY-CAP             VALUE 'Y'.
   258             20  PI-MODIFY-CAP           PIC X.
   259                 88  MODIFY-CAP              VALUE 'Y'.
   260             20  PI-MSG-AT-LOGON-CAP     PIC X.
   261                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   262             20  PI-FORCE-CAP            PIC X.
   263                 88  FORCE-CAP               VALUE 'Y'.
   264
   265         16  PI-PROGRAM-CONTROLS.
   266             20  PI-PGM-PRINT-OPT        PIC X.
   267             20  PI-PGM-FORMAT-OPT       PIC X.
   268             20  PI-PGM-PROCESS-OPT      PIC X.
   269             20  PI-PGM-TOTALS-OPT       PIC X.
   270
   271         16  PI-HELP-INTERFACE.
   272             20  PI-LAST-ERROR-NO        PIC X(4).
   273             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   274
   275         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   276             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   277
   278         16  PI-CR-CONTROL-IN-PROGRESS.
   279             20  PI-CR-CARRIER           PIC X.
   280             20  PI-CR-GROUPING          PIC X(6).
   281             20  PI-CR-STATE             PIC XX.
   282             20  PI-CR-ACCOUNT           PIC X(10).
   283             20  PI-CR-FIN-RESP          PIC X(10).
   284             20  PI-CR-TYPE              PIC X.
   285
   286         16  PI-CR-BATCH-NUMBER          PIC X(6).
   287
   288         16  PI-CR-MONTH-END-DT          PIC XX.
   289
   290         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   291             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   292             88  PI-ZERO-CARRIER             VALUE '1'.
   293             88  PI-ZERO-GROUPING            VALUE '2'.
   294             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   295
   296         16  PI-CARRIER-SECURITY         PIC X.
   297             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   298
   299         16  PI-ACCOUNT-SECURITY         PIC X(10).
   300             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   301             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   302
   303         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   304             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   305                                         INDEXED BY PI-ACCESS-NDX
   306                                         PIC X.
   307
   308         16  PI-GA-BILLING-CONTROL       PIC X.
   309             88  PI-GA-BILLING               VALUE '1'.
   310
   311         16  PI-MAIL-PROCESSING          PIC X.
   312             88  PI-MAIL-YES                 VALUE 'Y'.
   313
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL1043.cbl
   314         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   315
   316         16  PI-AR-SYSTEM.
   317             20  PI-AR-PROCESSING-CNTL   PIC X.
   318                 88  PI-AR-PROCESSING        VALUE 'Y'.
   319             20  PI-AR-SUMMARY-CODE      PIC X(6).
   320             20  PI-AR-MONTH-END-DT      PIC XX.
   321
   322         16  PI-MP-SYSTEM.
   323             20  PI-MORTGAGE-USER            PIC X.
   324                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   325                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   326             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   327                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   328                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   329                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   330                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   331                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   332             20  PI-MP-MONTH-END-DT          PIC XX.
   333             20  PI-MP-REFERENCE-NO.
   334                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   335                 24  PI-MP-REFERENCE-SFX     PIC XX.
   336
   337         16  PI-LABEL-CONTROL            PIC X(01).
   338             88  PI-CREATE-LABELS                    VALUE 'Y'.
   339             88  PI-BYPASS-LABELS                    VALUE 'N'.
   340
   341         16  PI-BILL-GROUPING-CODE       PIC X(01).
   342             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   343
   344         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   345             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   346             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   347
   348         16  FILLER                      PIC X(14).
   349
   350     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   351******************************************************************
   352     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   353*    COPY ELC1042.
   354******************************************************************
   355*                                                                *
   356*                                                                *
   357*                           ELC1042                              *
   358*                            VMOD=2.002                          *
   359*                                                                *
   360*    NOTE                                                        *
   361*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   362*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   363*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   364*        TO THESE PROGRAMS.                                      *
   365*                                                                *
   366*    NOTE                                                        *
   367*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   368*        USE ONLY!                                               *
   369*                                                                *
   370******************************************************************
   371
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL1043.cbl
   372         16  PI-1042-WA.
   373             20  PI-ACTION       PIC  X(01).
   374                 88 PI-SHOW-MODE           VALUE '1'.
   375                 88 PI-CLEAR-MODE          VALUE '2'.
   376                 88 PI-CREATE-MODE         VALUE '3'.
   377             20  PI-COMM-CONTROL PIC  X(12).
   378             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   379             20  PI-EOF-SW       PIC  X(01).
   380                 88  PI-FILE-EOF           VALUE 'Y'.
   381             20  PI-FILETYP      PIC  X(01).
   382             20  PI-FORM-SQUEEZE-CONTROL
   383                                 PIC  X(01).
   384                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   385                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   386             20  PI-LAST-CONTROL PIC  X(12).
   387             20  PI-TEMP-STOR-ITEMS
   388                                 PIC S9(04) COMP.
   389             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   390             20  PI-UPDATE-SW    PIC  9(01).
   391                 88 ANY-UPDATES            VALUE 1.
   392             20  PI-104-SCREEN-SENT-IND
   393                                 PIC  X(01).
   394                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   395                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   396             20  PI-1042-SCREEN-SENT-IND
   397                                 PIC  X(01).
   398                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   399                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   400             20  PI-1042-ARCHIVE-IND
   401                                 PIC  X(01).
   402                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   403             20  FILLER          PIC  X(29).
   404         16  FILLER              PIC X(444).
   405         16  PI-OLD-NAME         PIC  X(04).
   406         16  PI-NEW-NAME         PIC  X(04).
   407         16  PI-1043-ERROR       PIC  9(04).
   408         16  FILLER              PIC X(117).
   409
   410 01  FILLER                      PIC  X(20)
   411                                 VALUE ':INTERFACE AREA ENDS'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL1043.cbl
   413 01  W-CONSTANT-AREA.
   414     12  FILLER                  PIC  X(18)
   415                                 VALUE 'PROGRAM CONSTANTS:'.
   416     12  W-ZEROS                 PIC S9(04)  VALUE ZEROS.
   417
   418     12  W-LGXX-ID               PIC  X(04)  VALUE 'LGXX'.
   419     12  W-LINK-001              PIC  X(05)  VALUE 'EL001'.
   420     12  W-LINK-004              PIC  X(05)  VALUE 'EL004'.
   421     12  W-LINK-ELDATCV          PIC  X(07)  VALUE 'ELDATCV'.
   422     12  W-PGM-EL626             PIC  X(08)  VALUE 'EL626'.
   423     12  W-TEXT-FILE-ID          PIC  X(08)  VALUE 'ELLETR'.
   424     12  W-THIS-PGM              PIC  X(08)  VALUE 'EL1043'.
   425     12  W-TOP-FORM              PIC  X(70)
   426                              VALUE '*****TOP OF FORM *****'.
   427     12  W-TRANSACTION           PIC  X(04)  VALUE 'EXM7'.
   428     12  W-XCTL-005              PIC  X(05)  VALUE 'EL005'.
   429     12  W-XCTL-010              PIC  X(05)  VALUE 'EL010'.
   430     12  W-XCTL-626              PIC  X(05)  VALUE 'EL626'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL1043.cbl
   432 01  W-VARIABLE-PROCESS-CNTLS.
   433     12  FILLER                  PIC  X(26)
   434                        VALUE 'VARIABLE WORK AREA STARTS:'.
   435     12  W-VAR-HOLD.
   436         16  W-V1                PIC  X(01).
   437         16  W-V2                PIC  X(01).
   438         16  W-V3                PIC  X(01).
   439         16  W-V4                PIC  X(01).
   440
   441 01  W-SUPPORTED-VARIABLES.
   442*****************COMPANY VARIABLES - ELCNTL ********************
   443*****COMPANY NAME
   444     12  FILLER                  PIC  X(04) VALUE    '01.0'.
   445     12  FILLER                  PIC  X(06) VALUE  '@@001#'.
   446*****FULL COMPANY ADDRESS
   447     12  FILLER                  PIC  X(04) VALUE    '02.1'.
   448     12  FILLER                  PIC  X(06) VALUE  '@@002#'.
   449     12  FILLER                  PIC  X(04) VALUE    '02.2'.
   450     12  FILLER                  PIC  X(06) VALUE  '@@003#'.
   451     12  FILLER                  PIC  X(04) VALUE    '02.3'.
   452     12  FILLER                  PIC  X(06) VALUE  '@@004#'.
   453     12  FILLER                  PIC  X(04) VALUE    '02.4'.
   454     12  FILLER                  PIC  X(06) VALUE  '@@005#'.
   455     12  FILLER                  PIC  X(04) VALUE    '02.5'.
   456     12  FILLER                  PIC  X(06) VALUE  '@@006#'.
   457************ LIFE BENEFIT VARIABLES - ELCNTL *******************
   458*****LIFE BENEFIT DESCRIPTION
   459     12  FILLER                  PIC  X(04) VALUE    '12.0'.
   460     12  FILLER                  PIC  X(06) VALUE  '@@011#'.
   461************* A&H BENEFIT VARIABLES - ELCNTL *******************
   462*****AH BENEFIT DESCRIPTION
   463     12  FILLER                  PIC  X(04) VALUE    '12.5'.
   464     12  FILLER                  PIC  X(06) VALUE  '@@015#'.
   465*****ELIMINATION PERIOD
   466     12  FILLER                  PIC  X(04) VALUE    '27.0'.
   467     12  FILLER                  PIC  X(06) VALUE  '@@016#'.
   468*****************CARRIER VARIABLES - ELCNTL ********************
   469*****CARRIER NAME
   470     12  FILLER                  PIC  X(04) VALUE    '03.0'.
   471     12  FILLER                  PIC  X(06) VALUE  '@@020#'.
   472*****FULL CARRIER ADDRESS
   473     12  FILLER                  PIC  X(04) VALUE    '04.1'.
   474     12  FILLER                  PIC  X(06) VALUE  '@@021#'.
   475     12  FILLER                  PIC  X(04) VALUE    '04.2'.
   476     12  FILLER                  PIC  X(06) VALUE  '@@022#'.
   477     12  FILLER                  PIC  X(04) VALUE    '04.3'.
   478     12  FILLER                  PIC  X(06) VALUE  '@@023#'.
   479     12  FILLER                  PIC  X(04) VALUE    '04.4'.
   480     12  FILLER                  PIC  X(06) VALUE  '@@024#'.
   481     12  FILLER                  PIC  X(04) VALUE    '04.5'.
   482     12  FILLER                  PIC  X(06) VALUE  '@@025#'.
   483*****CARRIER PHONE NUMBER
   484     12  FILLER                  PIC  X(04) VALUE    '04.6'.
   485     12  FILLER                  PIC  X(06) VALUE  '@@026#'.
   486***************** MAIL VARIABLES - ELMAIL **********************
   487*****FULL MAIL ADDRESS
   488     12  FILLER                  PIC  X(04) VALUE    '05.1'.
   489     12  FILLER                  PIC  X(06) VALUE  '@@031#'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL1043.cbl
   490     12  FILLER                  PIC  X(04) VALUE    '05.2'.
   491     12  FILLER                  PIC  X(06) VALUE  '@@032#'.
   492     12  FILLER                  PIC  X(04) VALUE    '05.3'.
   493     12  FILLER                  PIC  X(06) VALUE  '@@033#'.
   494     12  FILLER                  PIC  X(04) VALUE    '05.4'.
   495     12  FILLER                  PIC  X(06) VALUE  '@@034#'.
   496     12  FILLER                  PIC  X(04) VALUE    '05.5'.
   497     12  FILLER                  PIC  X(06) VALUE  '@@035#'.
   498     12  FILLER                  PIC  X(04) VALUE    '05.6'.
   499     12  FILLER                  PIC  X(06) VALUE  '@@036#'.
   500*************** ACCOUNT VARIABLES - ERACCT *********************
   501*****ACCOUNT NAME
   502     12  FILLER                  PIC  X(04) VALUE    '06.0'.
   503     12  FILLER                  PIC  X(06) VALUE  '@@040#'.
   504*****FULL ACCOUNT ADDRESS
   505     12  FILLER                  PIC  X(04) VALUE    '07.1'.
   506     12  FILLER                  PIC  X(06) VALUE  '@@041#'.
   507     12  FILLER                  PIC  X(04) VALUE    '07.2'.
   508     12  FILLER                  PIC  X(06) VALUE  '@@042#'.
   509     12  FILLER                  PIC  X(04) VALUE    '07.3'.
   510     12  FILLER                  PIC  X(06) VALUE  '@@043#'.
   511     12  FILLER                  PIC  X(04) VALUE    '07.4'.
   512     12  FILLER                  PIC  X(06) VALUE  '@@044#'.
   513     12  FILLER                  PIC  X(04) VALUE    '07.5'.
   514     12  FILLER                  PIC  X(06) VALUE  '@@045#'.
   515*****ACCOUNT PHONE NUMBER
   516     12  FILLER                  PIC  X(04) VALUE    '07.6'.
   517     12  FILLER                  PIC  X(06) VALUE  '@@046#'.
   518*************** NON FILE VARIABLES *****************************
   519*****CURRENT DATE
   520     12  FILLER                  PIC  X(04) VALUE    '10.0'.
   521     12  FILLER                  PIC  X(06) VALUE  '@@060#'.
   522*****FULL CURRENT DATE
   523     12  FILLER                  PIC  X(04) VALUE    '11.0'.
   524     12  FILLER                  PIC  X(06) VALUE  '@@061#'.
   525************** CERTIFICATE VARIABLES - ELCERT *****************
   526*****CARRIER CODE IN CERT
   527     12  FILLER                  PIC  X(04) VALUE    '13.0'.
   528     12  FILLER                  PIC  X(06) VALUE  '@@070#'.
   529*****GROUPING CODE IN CERT
   530     12  FILLER                  PIC  X(04) VALUE    '14.0'.
   531     12  FILLER                  PIC  X(06) VALUE  '@@071#'.
   532*****ACCOUNT NUMBER IN CERT
   533     12  FILLER                  PIC  X(04) VALUE    '15.0'.
   534     12  FILLER                  PIC  X(06) VALUE  '@@072#'.
   535*****CERTIFICATE NUMBER
   536     12  FILLER                  PIC  X(04) VALUE    '16.0'.
   537     12  FILLER                  PIC  X(06) VALUE  '@@073#'.
   538*****CERT EFFECTIVE DATE
   539     12  FILLER7                 PIC  X(04) VALUE    '17.0'.
   540     12  FILLER                  PIC  X(06) VALUE  '@@074#'.
   541*****CERT EXPIRATION DATE (LIFE)
   542     12  FILLER                  PIC  X(04) VALUE    '18.0'.
   543     12  FILLER                  PIC  X(06) VALUE  '@@075#'.
   544*****CERT EXPIRATION DATE (AH)
   545     12  FILLER                  PIC  X(04) VALUE    '18.5'.
   546     12  FILLER                  PIC  X(06) VALUE  '@@076#'.
   547*****LIFE TERM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL1043.cbl
   548     12  FILLER                  PIC  X(04) VALUE    '19.0'.
   549     12  FILLER                  PIC  X(06) VALUE  '@@077#'.
   550*****AH  TERM
   551     12  FILLER                  PIC  X(04) VALUE    '19.5'.
   552     12  FILLER                  PIC  X(06) VALUE  '@@078#'.
   553*****LIFE COVERAGE AMOUNT
   554     12  FILLER                  PIC  X(04) VALUE    '20.0'.
   555     12  FILLER                  PIC  X(06) VALUE  '@@079#'.
   556*****AH MONTHLY BENEFIT
   557     12  FILLER                  PIC  X(04) VALUE    '20.5'.
   558     12  FILLER                  PIC  X(06) VALUE  '@@080#'.
   559*****LIFE CANCEL DATE
   560     12  FILLER                  PIC  X(04) VALUE    '21.0'.
   561     12  FILLER                  PIC  X(06) VALUE  '@@081#'.
   562*****AH CANCEL DATE
   563     12  FILLER                  PIC  X(04) VALUE    '21.5'.
   564     12  FILLER                  PIC  X(06) VALUE  '@@082#'.
   565*****LIFE COVERAGE FORM NUMBER
   566     12  FILLER                  PIC  X(04) VALUE    '22.0'.
   567     12  FILLER                  PIC  X(06) VALUE  '@@083#'.
   568*****AH COVERAGE FORM NUMBER
   569     12  FILLER                  PIC  X(04) VALUE    '22.5'.
   570     12  FILLER                  PIC  X(06) VALUE  '@@083#'.
   571*****INSUREDS AGE AT POLICY ISSUE (NOT USED)
   572     12  FILLER                  PIC  X(04) VALUE    '23.0'.
   573     12  FILLER                  PIC  X(06) VALUE  '@@085#'.
   574*****LOAN NUMBER
   575     12  FILLER                  PIC  X(04) VALUE    '24.0'.
   576     12  FILLER                  PIC  X(06) VALUE  '@@086#'.
   577*****LOAN BALANCE
   578     12  FILLER                  PIC  X(04) VALUE    '25.0'.
   579     12  FILLER                  PIC  X(06) VALUE  '@@087#'.
   580*****MEMBER NUMBER
   581     12  FILLER                  PIC  X(04) VALUE    '26.0'.
   582     12  FILLER                  PIC  X(06) VALUE  '@@088#'.
   583*****INSURED SOC SEC NUMBER
   584     12  FILLER                  PIC  X(04) VALUE    '29.0'.
   585     12  FILLER                  PIC  X(06) VALUE  '@@089#'.
   586*****INSURED INITIALS & LAST NAME (CERTIFICATE)
   587     12  FILLER                  PIC  X(04) VALUE    '30.0'.
   588     12  FILLER                  PIC  X(06) VALUE  '@@090#'.
   589*****INSURED FIRST NAME (CERTIFICATE)
   590     12  FILLER                  PIC  X(04) VALUE    '30.1'.
   591     12  FILLER                  PIC  X(06) VALUE  '@@091#'.
   592*****INSURED MIDDLE INITIAL (CERTIFICATE)
   593     12  FILLER                  PIC  X(04) VALUE    '30.2'.
   594     12  FILLER                  PIC  X(06) VALUE  '@@092#'.
   595*****ORIG TERM * MON BEN
   596     12  FILLER                  PIC  X(04) VALUE    '50.0'.
   597     12  FILLER                  PIC  X(06) VALUE  '@@093#'.
   598*****INSURED'S NAME (LAST, FIRST, INIT)
   599     12  FILLER                  PIC  X(04) VALUE    '51.0'.
   600     12  FILLER                  PIC  X(06) VALUE  '@@094#'.
   601*****INSURED'S NAME (FIRST, INIT, LAST)
   602     12  FILLER                  PIC  X(04) VALUE    '52.0'.
   603     12  FILLER                  PIC  X(06) VALUE  '@@095#'.
   604*****TITLE (MR/MS)
   605     12  FILLER                  PIC  X(04) VALUE    '53.0'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL1043.cbl
   606     12  FILLER                  PIC  X(06) VALUE  '@@096#'.
   607*****LIFE PREMIUM (CERTIFICATE)
   608     12  FILLER                  PIC  X(04) VALUE    '55.0'.
   609     12  FILLER                  PIC  X(06) VALUE  '@@097#'.
   610*****A/H PREMIUM (CERTIFICATE)
   611     12  FILLER                  PIC  X(04) VALUE    '56.0'.
   612     12  FILLER                  PIC  X(06) VALUE  '@@098#'.
   613************** PENDING VARIABLES - ERPNDB *********************
   614*****INSURED DATE OF BIRTH
   615     12  SS28                    PIC  X(04) VALUE    '28.0'.
   616     12  FILLER                  PIC  X(06) VALUE  '@@110#'.
   617*****ENTERED LIFE PREMIUM (PENDING)
   618     12  FILLER                  PIC  X(04) VALUE    '31.0'.
   619     12  FILLER                  PIC  X(06) VALUE  '@@111#'.
   620*****ENTERED A/H PREMIUM (PENDING)
   621     12  FILLER                  PIC  X(04) VALUE    '32.0'.
   622     12  FILLER                  PIC  X(06) VALUE  '@@112#'.
   623*****CALCULATED LIFE PREMIUM (PENDING)
   624     12  FILLER                  PIC  X(04) VALUE    '33.0'.
   625     12  FILLER                  PIC  X(06) VALUE  '@@113#'.
   626*****CALCULATED A/H PREMIUM (PENDING)
   627     12  FILLER                  PIC  X(04) VALUE    '34.0'.
   628     12  FILLER                  PIC  X(06) VALUE  '@@114#'.
   629*****DIFFERENCE ENTER/COMPUTED LIFE PREMIUM (PENDING)
   630     12  FILLER                  PIC  X(04) VALUE    '35.0'.
   631     12  FILLER                  PIC  X(06) VALUE  '@@115#'.
   632*****DIFFERENCE ENTER/COMPUTED A/H PREMIUM (PENDING)
   633     12  FILLER                  PIC  X(04) VALUE    '36.0'.
   634     12  FILLER                  PIC  X(06) VALUE  '@@116#'.
   635*****PRIOR CANCEL DATE
   636     12  FILLER                  PIC  X(04) VALUE    '37.0'.
   637     12  FILLER                  PIC  X(06) VALUE  '@@117#'.
   638*****ENTERED LIFE REFUND (PENDING)
   639     12  FILLER                  PIC  X(04) VALUE    '38.0'.
   640     12  FILLER                  PIC  X(06) VALUE  '@@118#'.
   641*****ENTERED A/H REFUND (PENDING)
   642     12  FILLER                  PIC  X(04) VALUE    '39.0'.
   643     12  FILLER                  PIC  X(06) VALUE  '@@119#'.
   644*****CALCULATED LIFE REFUND (PENDING)
   645     12  FILLER                  PIC  X(04) VALUE    '40.0'.
   646     12  FILLER                  PIC  X(06) VALUE  '@@120#'.
   647*****CALCULATED A/H REFUND (PENDING)
   648     12  FILLER                  PIC  X(04) VALUE    '41.0'.
   649     12  FILLER                  PIC  X(06) VALUE  '@@121#'.
   650*****DIFFERENCE ENTER/COMPUTED LIFE REFUND (PENDING)
   651     12  FILLER                  PIC  X(04) VALUE    '42.0'.
   652     12  FILLER                  PIC  X(06) VALUE  '@@122#'.
   653*****DIFFERENCE ENTER/COMPUTED A/H REFUND (PENDING)
   654     12  FILLER                  PIC  X(04) VALUE    '43.0'.
   655     12  FILLER                  PIC  X(06) VALUE  '@@123#'.
   656*****INSUREDS AGE
   657     12  FILLER                  PIC  X(04) VALUE    '44.0'.
   658     12  FILLER                  PIC  X(06) VALUE  '@@124#'.
   659*****LIFE BENEFIT (PENDING)
   660     12  FILLER                  PIC  X(04) VALUE    '45.0'.
   661     12  FILLER                  PIC  X(06) VALUE  '@@125#'.
   662*****A/H BENEFIT (PENDING)
   663     12  FILLER                  PIC  X(04) VALUE    '46.0'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL1043.cbl
   664     12  FILLER                  PIC  X(06) VALUE  '@@126#'.
   665*****LIFE RATE
   666     12  FILLER                  PIC  X(04) VALUE    '47.0'.
   667     12  FILLER                  PIC  X(06) VALUE  '@@127#'.
   668*****A/H RATE
   669     12  FILLER                  PIC  X(04) VALUE    '48.0'.
   670     12  FILLER                  PIC  X(06) VALUE  '@@128#'.
   671*****TERM (PENDING)
   672     12  FILLER                  PIC  X(04) VALUE    '49.0'.
   673     12  FILLER                  PIC  X(06) VALUE  '@@129#'.
   674*****TITLE BATCH NUMBER
   675     12  FILLER                  PIC  X(04) VALUE    '54.0'.
   676     12  FILLER                  PIC  X(06) VALUE  '@@130#'.
   677************** COMPENSATION VARIABLES - ERCOMP ****************
   678*****COMPENSATION ACCT NAME
   679     12  FILLER                  PIC  X(04) VALUE    '60.0'.
   680     12  FILLER                  PIC  X(06) VALUE  '@@140#'.
   681*****FULL COMPENSATION ADDRESS
   682     12  FILLER                  PIC  X(04) VALUE    '60.1'.
   683     12  FILLER                  PIC  X(06) VALUE  '@@141#'.
   684     12  FILLER                  PIC  X(04) VALUE    '60.2'.
   685     12  FILLER                  PIC  X(06) VALUE  '@@142#'.
   686     12  FILLER                  PIC  X(04) VALUE    '60.3'.
   687     12  FILLER                  PIC  X(06) VALUE  '@@143#'.
   688     12  FILLER                  PIC  X(04) VALUE    '60.4'.
   689     12  FILLER                  PIC  X(06) VALUE  '@@144#'.
   690     12  FILLER                  PIC  X(04) VALUE    '60.5'.
   691     12  FILLER                  PIC  X(06) VALUE  '@@145#'.
   692*****COMPENSATION PHONE NUMBER
   693     12  FILLER                  PIC  X(04) VALUE    '60.6'.
   694     12  FILLER                  PIC  X(06) VALUE  '@@147#'.
   695******************  PROCESSOR DATA - ELCNTL (2) ****************
   696*****EXECUTING PROCESSOR NAME
   697     12  FILLER                  PIC  X(04) VALUE    '08.0'.
   698     12  FILLER                  PIC  X(06) VALUE  '@@151#'.
   699*****PROCESSOR TITLE
   700     12  FILLER                  PIC  X(04) VALUE    '09.0'.
   701     12  FILLER                  PIC  X(06) VALUE  '@@152#'.
   702 01  FILLER REDEFINES W-SUPPORTED-VARIABLES.
   703     12  W-VAR-HOLD-GRP OCCURS 90 TIMES
   704                        INDEXED BY W-VG-NDX.
   705         16  W-VAR-OLD           PIC  X(04).
   706         16  W-VAR-NEW.
   707             20  W-VC-CHAR OCCURS 6 TIMES
   708                           INDEXED BY W-VC-NDX
   709                                 PIC  X(01).
   710
   711 01  W-VAR-END                   PIC  X(23)
   712                        VALUE ':VARIABLE WORK AREA END'.
   713
   714 01  W-PROGRAM-TABLE-AREA.
   715     12  FILLER                  PIC  X(15)
   716                                 VALUE 'PROGRAM TABLES:'.
   717
   718     12  W-TX-TABLE.
   719         16  W-TX-GRP OCCURS 300 TIMES
   720                       INDEXED BY W-TG-NDX.
   721             20  FILLER              PIC  X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL1043.cbl
   722             20  W-TX-KEY.
   723                 24  FILLER          PIC  X(01).
   724                 24  W-TX-LETTER-NO  PIC  X(04).
   725                 24  FILLER          PIC  X(08).
   726                 24  W-TX-SEQ-NO     PIC S9(04) COMP.
   727             20  FILLER              PIC  X(02).
   728
   729             20  W-TEXT-LINE.
   730                 24  W-TX-CHAR OCCURS 70 TIMES
   731                               INDEXED BY W-TX-NDX
   732                                     PIC  X(01).
   733
   734         16  FILLER                  PIC  X(11).
   735
   736     12  W-WORK-LINE.
   737         16  W-WK-CHAR OCCURS 70 TIMES
   738                       INDEXED BY W-WK-NDX
   739                                  W-WK-NDX1
   740                                     PIC  X(01).
   741
   742     12  FILLER                  PIC  X(14)
   743                                 VALUE 'END OF TABLES:'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL1043.cbl
   745 01  ERROR-MESSAGES.
   746     12  ER-0000                 PIC  X(04) VALUE '0000'.
   747     12  ER-0004                 PIC  X(04) VALUE '0004'.
   748     12  ER-0006                 PIC  X(04) VALUE '0006'.
   749     12  ER-0013                 PIC  X(04) VALUE '0013'.
   750     12  ER-0180                 PIC  X(04) VALUE '0180'.
   751     12  ER-7391                 PIC  X(04) VALUE '7391'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL1043.cbl
   753*****DFHAID                  COPY ELCAID.
   754*    COPY ELCAID.
   755******************************************************************
   756*                                                                *
   757*                            ELCAID.                             *
   758*                            VMOD=2.001                          *
   759*                                                                *
   760*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   761*                                                                *
   762*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   763*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   764******************************************************************
   765
   766 01  DFHAID.
   767   02  DFHNULL   PIC  X  VALUE  ' '.
   768   02  DFHENTER  PIC  X  VALUE  QUOTE.
   769   02  DFHCLEAR  PIC  X  VALUE  '_'.
   770   02  DFHPEN    PIC  X  VALUE  '='.
   771   02  DFHOPID   PIC  X  VALUE  'W'.
   772   02  DFHPA1    PIC  X  VALUE  '%'.
   773   02  DFHPA2    PIC  X  VALUE  '>'.
   774   02  DFHPA3    PIC  X  VALUE  ','.
   775   02  DFHPF1    PIC  X  VALUE  '1'.
   776   02  DFHPF2    PIC  X  VALUE  '2'.
   777   02  DFHPF3    PIC  X  VALUE  '3'.
   778   02  DFHPF4    PIC  X  VALUE  '4'.
   779   02  DFHPF5    PIC  X  VALUE  '5'.
   780   02  DFHPF6    PIC  X  VALUE  '6'.
   781   02  DFHPF7    PIC  X  VALUE  '7'.
   782   02  DFHPF8    PIC  X  VALUE  '8'.
   783   02  DFHPF9    PIC  X  VALUE  '9'.
   784   02  DFHPF10   PIC  X  VALUE  ':'.
   785   02  DFHPF11   PIC  X  VALUE  '#'.
   786   02  DFHPF12   PIC  X  VALUE  '@'.
   787   02  DFHPF13   PIC  X  VALUE  'A'.
   788   02  DFHPF14   PIC  X  VALUE  'B'.
   789   02  DFHPF15   PIC  X  VALUE  'C'.
   790   02  DFHPF16   PIC  X  VALUE  'D'.
   791   02  DFHPF17   PIC  X  VALUE  'E'.
   792   02  DFHPF18   PIC  X  VALUE  'F'.
   793   02  DFHPF19   PIC  X  VALUE  'G'.
   794   02  DFHPF20   PIC  X  VALUE  'H'.
   795   02  DFHPF21   PIC  X  VALUE  'I'.
   796*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   797   02  DFHPF22   PIC  X  VALUE  '['.
   798   02  DFHPF23   PIC  X  VALUE  '.'.
   799   02  DFHPF24   PIC  X  VALUE  '<'.
   800   02  DFHMSRE   PIC  X  VALUE  'X'.
   801   02  DFHSTRF   PIC  X  VALUE  'h'.
   802   02  DFHTRIG   PIC  X  VALUE  '"'.
   803 01  FILLER    REDEFINES DFHAID.
   804     12  FILLER                  PIC  X(08).
   805     12  PF-VALUES               PIC  X(01) OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL1043.cbl
   807*    COPY ELCATTR.
   808******************************************************************
   809*                                                                *
   810*                            ELCATTR.                            *
   811*                            VMOD=2.001                          *
   812*                                                                *
   813*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   814*                                                                *
   815*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   816*                                                                *
   817*                   POS 1   P=PROTECTED                          *
   818*                           U=UNPROTECTED                        *
   819*                           S=ASKIP                              *
   820*                   POS 2   A=ALPHA/NUMERIC                      *
   821*                           N=NUMERIC                            *
   822*                   POS 3   N=NORMAL                             *
   823*                           B=BRIGHT                             *
   824*                           D=DARK                               *
   825*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   826*                           OF=MODIFIED DATA TAG OFF             *
   827*                                                                *
   828*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   829******************************************************************
   830 01  ATTRIBUTE-LIST.
   831     12  AL-PABOF            PIC X       VALUE 'Y'.
   832     12  AL-PABON            PIC X       VALUE 'Z'.
   833     12  AL-PADOF            PIC X       VALUE '%'.
   834     12  AL-PADON            PIC X       VALUE '_'.
   835     12  AL-PANOF            PIC X       VALUE '-'.
   836     12  AL-PANON            PIC X       VALUE '/'.
   837     12  AL-SABOF            PIC X       VALUE '8'.
   838     12  AL-SABON            PIC X       VALUE '9'.
   839     12  AL-SADOF            PIC X       VALUE '@'.
   840     12  AL-SADON            PIC X       VALUE QUOTE.
   841     12  AL-SANOF            PIC X       VALUE '0'.
   842     12  AL-SANON            PIC X       VALUE '1'.
   843     12  AL-UABOF            PIC X       VALUE 'H'.
   844     12  AL-UABON            PIC X       VALUE 'I'.
   845     12  AL-UADOF            PIC X       VALUE '<'.
   846     12  AL-UADON            PIC X       VALUE '('.
   847     12  AL-UANOF            PIC X       VALUE ' '.
   848     12  AL-UANON            PIC X       VALUE 'A'.
   849     12  AL-UNBOF            PIC X       VALUE 'Q'.
   850     12  AL-UNBON            PIC X       VALUE 'R'.
   851     12  AL-UNDOF            PIC X       VALUE '*'.
   852     12  AL-UNDON            PIC X       VALUE ')'.
   853     12  AL-UNNOF            PIC X       VALUE '&'.
   854     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL1043.cbl
   856*    COPY ELCNWA.
   857*****************************************************************
   858*                                                               *
   859*                                                               *
   860*                            ELCNWA.                            *
   861*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   862*                            VMOD=2.003                         *
   863*                                                               *
   864*            M O V E   N A M E   W O R K   A R E A.             *
   865*                                                               *
   866*****************************************************************.
   867
   868 01  WS-NAME-WORK-AREA.
   869     05  WS-INSURED-LAST-NAME        PIC X(15).
   870     05  WS-INSURED-1ST-NAME         PIC X(12).
   871     05  WS-INSURED-MID-INIT         PIC X.
   872
   873     05  WS-NAME-WORK.
   874         10  WS-NW                   PIC X
   875             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   876
   877     05  WS-NAME-WORK2.
   878         10  WS-NW2                  PIC X
   879             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   880                                        NWA-INDEX0.
   881
   882     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   883                                     COMP-3.
   884
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL1043.cbl
   886*    COPY ELCEMIB.
   887******************************************************************
   888*                                                                *
   889*                                                                *
   890*                            ELCEMIB.                            *
   891*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   892*                            VMOD=2.005                          *
   893*                                                                *
   894*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   895*                                                                *
   896******************************************************************
   897 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   898     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   899     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   900     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   901     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   902     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   903     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   904     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   905     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   906     12  EMI-SWITCH1             PIC X        VALUE '1'.
   907         88  EMI-NO-ERRORS                    VALUE '1'.
   908         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   909         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   910     12  EMI-SWITCH2             PIC X        VALUE '1'.
   911         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   912     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   913         88  EMI-AREA1-EMPTY                  VALUE '1'.
   914         88  EMI-AREA1-FULL                   VALUE '2'.
   915     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   916         88  EMI-AREA2-EMPTY                  VALUE '1'.
   917         88  EMI-AREA2-FULL                   VALUE '2'.
   918     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   919         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   920         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   921         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   922         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   923         88  EMI-BYPASS-FATALS                VALUE 'X'.
   924     12  EMI-ERROR-LINES.
   925         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   926         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   927         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   928         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   929             20  EMI-ERR-CODES OCCURS 10 TIMES.
   930                 24  EMI-ERR-NUM         PIC X(4).
   931                 24  EMI-FILLER          PIC X.
   932                 24  EMI-SEV             PIC X.
   933                 24  FILLER              PIC X.
   934             20  FILLER                  PIC X(02).
   935     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   936         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   937             20  EMI-ERROR-NUMBER    PIC X(4).
   938             20  EMI-FILL            PIC X.
   939             20  EMI-SEVERITY        PIC X.
   940             20  FILLER              PIC X.
   941             20  EMI-ERROR-TEXT.
   942                 24  EMI-TEXT-VARIABLE   PIC X(10).
   943                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL1043.cbl
   944     12  EMI-SEVERITY-SAVE           PIC X.
   945         88  EMI-NOTE                    VALUE 'N'.
   946         88  EMI-WARNING                 VALUE 'W'.
   947         88  EMI-FORCABLE                VALUE 'F'.
   948         88  EMI-FATAL                   VALUE 'X'.
   949     12  EMI-MESSAGE-FLAG            PIC X.
   950         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   951         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   952     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   953     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   954         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   955         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   956         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   957     12  FILLER                      PIC X(137)  VALUE SPACES.
   958     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   959     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   960     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   961     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   962 01  EMI-SAVE-AREA               PIC  X(400).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL1043.cbl
   964*    COPY ELCDATE.
   965******************************************************************
   966*                                                                *
   967*                                                                *
   968*                            ELCDATE.                            *
   969*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   970*                            VMOD=2.003
   971*                                                                *
   972*                                                                *
   973*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   974*                 LENGTH = 200                                   *
   975******************************************************************
   976
   977 01  DATE-CONVERSION-DATA.
   978     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   979     12  DC-OPTION-CODE                PIC X.
   980         88  BIN-TO-GREG                VALUE ' '.
   981         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   982         88  EDIT-GREG-TO-BIN           VALUE '2'.
   983         88  YMD-GREG-TO-BIN            VALUE '3'.
   984         88  MDY-GREG-TO-BIN            VALUE '4'.
   985         88  JULIAN-TO-BIN              VALUE '5'.
   986         88  BIN-PLUS-ELAPSED           VALUE '6'.
   987         88  FIND-CENTURY               VALUE '7'.
   988         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   989         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   990         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   991         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   992         88  JULIAN-TO-BIN-3            VALUE 'C'.
   993         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   994         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   995         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   996         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   997         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   998         88  CHECK-LEAP-YEAR            VALUE 'H'.
   999         88  BIN-3-TO-GREG              VALUE 'I'.
  1000         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1001         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1002         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1003         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1004         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1005         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1006         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1007         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1008         88  THREE-CHARACTER-BIN
  1009                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1010         88  GREGORIAN-TO-BIN
  1011                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1012         88  BIN-TO-GREGORIAN
  1013                  VALUES ' ' '1' 'I' '8' 'G'.
  1014         88  JULIAN-TO-BINARY
  1015                  VALUES '5' 'C' 'E' 'F'.
  1016     12  DC-ERROR-CODE                 PIC X.
  1017         88  NO-CONVERSION-ERROR        VALUE ' '.
  1018         88  DATE-CONVERSION-ERROR
  1019                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1020         88  DATE-IS-ZERO               VALUE '1'.
  1021         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL1043.cbl
  1022         88  DATE-IS-INVALID            VALUE '3'.
  1023         88  DATE1-GREATER-DATE2        VALUE '4'.
  1024         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1025         88  DATE-INVALID-OPTION        VALUE '9'.
  1026         88  INVALID-CENTURY            VALUE 'A'.
  1027         88  ONLY-CENTURY               VALUE 'B'.
  1028         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1029         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1030     12  DC-END-OF-MONTH               PIC X.
  1031         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1032     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1033         88  USE-NORMAL-PROCESS         VALUE ' '.
  1034         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1035         88  ADJUST-UP-100-YRS          VALUE '2'.
  1036     12  FILLER                        PIC X.
  1037     12  DC-CONVERSION-DATES.
  1038         16  DC-BIN-DATE-1             PIC XX.
  1039         16  DC-BIN-DATE-2             PIC XX.
  1040         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1041         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1042                       DC-GREG-DATE-1-EDIT.
  1043             20  DC-EDIT1-MONTH        PIC 99.
  1044             20  SLASH1-1              PIC X.
  1045             20  DC-EDIT1-DAY          PIC 99.
  1046             20  SLASH1-2              PIC X.
  1047             20  DC-EDIT1-YEAR         PIC 99.
  1048         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1049         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1050                     DC-GREG-DATE-2-EDIT.
  1051             20  DC-EDIT2-MONTH        PIC 99.
  1052             20  SLASH2-1              PIC X.
  1053             20  DC-EDIT2-DAY          PIC 99.
  1054             20  SLASH2-2              PIC X.
  1055             20  DC-EDIT2-YEAR         PIC 99.
  1056         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1057         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1058                     DC-GREG-DATE-1-YMD.
  1059             20  DC-YMD-YEAR           PIC 99.
  1060             20  DC-YMD-MONTH          PIC 99.
  1061             20  DC-YMD-DAY            PIC 99.
  1062         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1063         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1064                      DC-GREG-DATE-1-MDY.
  1065             20  DC-MDY-MONTH          PIC 99.
  1066             20  DC-MDY-DAY            PIC 99.
  1067             20  DC-MDY-YEAR           PIC 99.
  1068         16  DC-GREG-DATE-1-ALPHA.
  1069             20  DC-ALPHA-MONTH        PIC X(10).
  1070             20  DC-ALPHA-DAY          PIC 99.
  1071             20  FILLER                PIC XX.
  1072             20  DC-ALPHA-CENTURY.
  1073                 24 DC-ALPHA-CEN-N     PIC 99.
  1074             20  DC-ALPHA-YEAR         PIC 99.
  1075         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1076         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1077         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1078         16  DC-JULIAN-DATE            PIC 9(05).
  1079         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL1043.cbl
  1080                                       PIC 9(05).
  1081         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1082             20  DC-JULIAN-YEAR        PIC 99.
  1083             20  DC-JULIAN-DAYS        PIC 999.
  1084         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1085         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1086         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1087     12  DATE-CONVERSION-VARIBLES.
  1088         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1089         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1090             20  FILLER                PIC 9(3).
  1091             20  HOLD-CEN-1-CCYY.
  1092                 24  HOLD-CEN-1-CC     PIC 99.
  1093                 24  HOLD-CEN-1-YY     PIC 99.
  1094             20  HOLD-CEN-1-MO         PIC 99.
  1095             20  HOLD-CEN-1-DA         PIC 99.
  1096         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1097             20  HOLD-CEN-1-R-MO       PIC 99.
  1098             20  HOLD-CEN-1-R-DA       PIC 99.
  1099             20  HOLD-CEN-1-R-CCYY.
  1100                 24  HOLD-CEN-1-R-CC   PIC 99.
  1101                 24  HOLD-CEN-1-R-YY   PIC 99.
  1102             20  FILLER                PIC 9(3).
  1103         16  HOLD-CENTURY-1-X.
  1104             20  FILLER                PIC X(3)  VALUE SPACES.
  1105             20  HOLD-CEN-1-X-CCYY.
  1106                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1107                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1108             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1109             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1110         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1111             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1112             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1113             20  HOLD-CEN-1-R-X-CCYY.
  1114                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1115                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1116             20  FILLER                PIC XXX.
  1117         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1118         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1119         16  DC-JULIAN-DATE-1          PIC 9(07).
  1120         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1121             20  DC-JULIAN-1-CCYY.
  1122                 24  DC-JULIAN-1-CC    PIC 99.
  1123                 24  DC-JULIAN-1-YR    PIC 99.
  1124             20  DC-JULIAN-DA-1        PIC 999.
  1125         16  DC-JULIAN-DATE-2          PIC 9(07).
  1126         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1127             20  DC-JULIAN-2-CCYY.
  1128                 24  DC-JULIAN-2-CC    PIC 99.
  1129                 24  DC-JULIAN-2-YR    PIC 99.
  1130             20  DC-JULIAN-DA-2        PIC 999.
  1131         16  DC-GREG-DATE-A-EDIT.
  1132             20  DC-EDITA-MONTH        PIC 99.
  1133             20  SLASHA-1              PIC X VALUE '/'.
  1134             20  DC-EDITA-DAY          PIC 99.
  1135             20  SLASHA-2              PIC X VALUE '/'.
  1136             20  DC-EDITA-CCYY.
  1137                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL1043.cbl
  1138                 24  DC-EDITA-YEAR     PIC 99.
  1139         16  DC-GREG-DATE-B-EDIT.
  1140             20  DC-EDITB-MONTH        PIC 99.
  1141             20  SLASHB-1              PIC X VALUE '/'.
  1142             20  DC-EDITB-DAY          PIC 99.
  1143             20  SLASHB-2              PIC X VALUE '/'.
  1144             20  DC-EDITB-CCYY.
  1145                 24  DC-EDITB-CENT     PIC 99.
  1146                 24  DC-EDITB-YEAR     PIC 99.
  1147         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1148         16  DC-GREG-DATE-CYMD-R REDEFINES
  1149                              DC-GREG-DATE-CYMD.
  1150             20  DC-CYMD-CEN           PIC 99.
  1151             20  DC-CYMD-YEAR          PIC 99.
  1152             20  DC-CYMD-MONTH         PIC 99.
  1153             20  DC-CYMD-DAY           PIC 99.
  1154         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1155         16  DC-GREG-DATE-MDCY-R REDEFINES
  1156                              DC-GREG-DATE-MDCY.
  1157             20  DC-MDCY-MONTH         PIC 99.
  1158             20  DC-MDCY-DAY           PIC 99.
  1159             20  DC-MDCY-CEN           PIC 99.
  1160             20  DC-MDCY-YEAR          PIC 99.
  1161    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1162        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1163    12  DC-EL310-DATE                  PIC X(21).
  1164    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL1043.cbl
  1166*    COPY ELCLOGOF.
  1167******************************************************************
  1168*                                                                *
  1169*                                                                *
  1170*                            ELCLOGOF.                           *
  1171*                            VMOD=2.001                          *
  1172*                                                                *
  1173*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1174*                                                                *
  1175******************************************************************
  1176 01  CLASIC-LOGOFF.
  1177     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1178     12  LOGOFF-TEXT.
  1179         16  FILLER          PIC X(5)    VALUE SPACES.
  1180         16  LOGOFF-MSG.
  1181             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1182             20  FILLER      PIC X       VALUE SPACES.
  1183             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1184         16  FILLER          PIC X(80)
  1185           VALUE '* YOU ARE NOW LOGGED OFF'.
  1186         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1187         16  FILLER          PIC X       VALUE QUOTE.
  1188         16  LOGOFF-SYS-MSG  PIC X(17)
  1189           VALUE 'S CLAS-IC SYSTEM '.
  1190     12  TEXT-MESSAGES.
  1191         16  UNACCESS-MSG    PIC X(29)
  1192             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1193         16  PGMIDERR-MSG    PIC X(17)
  1194             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL1043.cbl
  1196*    COPY ELCSCTM.
  1197******************************************************************
  1198*                                                                *
  1199*                                                                *
  1200*                            ELCSCTM                             *
  1201*                            VMOD=2.001                          *
  1202*                                                                *
  1203*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  1204*                                                                *
  1205******************************************************************
  1206 01  SECURITY-MESSAGE.
  1207     12  FILLER                          PIC X(30)
  1208            VALUE '** LOGIC SECURITY VIOLATION -'.
  1209     12  SM-READ                         PIC X(6).
  1210     12  FILLER                          PIC X(5)
  1211            VALUE ' PGM='.
  1212     12  SM-PGM                          PIC X(6).
  1213     12  FILLER                          PIC X(5)
  1214            VALUE ' OPR='.
  1215     12  SM-PROCESSOR-ID                 PIC X(4).
  1216     12  FILLER                          PIC X(6)
  1217            VALUE ' TERM='.
  1218     12  SM-TERMID                       PIC X(4).
  1219     12  FILLER                          PIC XX   VALUE SPACE.
  1220     12  SM-JUL-DATE                     PIC 9(5).
  1221     12  FILLER                          PIC X    VALUE SPACE.
  1222     12  SM-TIME                         PIC 99.99.
  1223
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL1043.cbl
  1225*    COPY ELCSCRTY.
  1226******************************************************************
  1227*                                                                *
  1228*                                                                *
  1229*                            ELCSCRTY                            *
  1230*                            VMOD=2.001                          *
  1231*                                                                *
  1232*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  1233*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  1234*        SAVED IN PI-SECURITY-ADDRESS.                           *
  1235*                                                                *
  1236******************************************************************
  1237 01  SECURITY-CONTROL.
  1238     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  1239     12  FILLER                       PIC XX    VALUE 'SC'.
  1240     12  SC-CREDIT-CODES.
  1241         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  1242             20  SC-CREDIT-DISPLAY    PIC X.
  1243             20  SC-CREDIT-UPDATE     PIC X.
  1244     12  SC-CLAIMS-CODES.
  1245         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  1246             20  SC-CLAIMS-DISPLAY    PIC X.
  1247             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL1043.cbl
  1249****************************************************************
  1250*
  1251* Copyright (c) 2007 by Clerity Solutions, Inc.
  1252* All rights reserved.
  1253*
  1254****************************************************************
  1255 01  DFHEIV.
  1256   02  DFHEIV0               PIC X(35).
  1257   02  DFHEIV1               PIC X(08).
  1258   02  DFHEIV2               PIC X(08).
  1259   02  DFHEIV3               PIC X(08).
  1260   02  DFHEIV4               PIC X(06).
  1261   02  DFHEIV5               PIC X(04).
  1262   02  DFHEIV6               PIC X(04).
  1263   02  DFHEIV7               PIC X(02).
  1264   02  DFHEIV8               PIC X(02).
  1265   02  DFHEIV9               PIC X(01).
  1266   02  DFHEIV10              PIC S9(7) COMP-3.
  1267   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1268   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1269   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1270   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1271   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1272   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1273   02  DFHEIV17              PIC X(04).
  1274   02  DFHEIV18              PIC X(04).
  1275   02  DFHEIV19              PIC X(04).
  1276   02  DFHEIV20              USAGE IS POINTER.
  1277   02  DFHEIV21              USAGE IS POINTER.
  1278   02  DFHEIV22              USAGE IS POINTER.
  1279   02  DFHEIV23              USAGE IS POINTER.
  1280   02  DFHEIV24              USAGE IS POINTER.
  1281   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1282   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1283   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1284   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1285   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1286   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1287   02  FILLER                PIC X(02).
  1288   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1289   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1290   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1291   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1292   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1293 LINKAGE  SECTION.
  1294*****************************************************************
  1295*                                                               *
  1296* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1297* All rights reserved.                                          *
  1298*                                                               *
  1299*****************************************************************
  1300 01  dfheiblk.
  1301     02  eibtime          pic s9(7) comp-3.
  1302     02  eibdate          pic s9(7) comp-3.
  1303     02  eibtrnid         pic x(4).
  1304     02  eibtaskn         pic s9(7) comp-3.
  1305     02  eibtrmid         pic x(4).
  1306     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL1043.cbl
  1307     02  eibcposn         pic s9(4) comp.
  1308     02  eibcalen         pic s9(4) comp.
  1309     02  eibaid           pic x(1).
  1310     02  eibfiller1       pic x(1).
  1311     02  eibfn            pic x(2).
  1312     02  eibfiller2       pic x(2).
  1313     02  eibrcode         pic x(6).
  1314     02  eibfiller3       pic x(2).
  1315     02  eibds            pic x(8).
  1316     02  eibreqid         pic x(8).
  1317     02  eibrsrce         pic x(8).
  1318     02  eibsync          pic x(1).
  1319     02  eibfree          pic x(1).
  1320     02  eibrecv          pic x(1).
  1321     02  eibsend          pic x(1).
  1322     02  eibatt           pic x(1).
  1323     02  eibeoc           pic x(1).
  1324     02  eibfmh           pic x(1).
  1325     02  eibcompl         pic x(1).
  1326     02  eibsig           pic x(1).
  1327     02  eibconf          pic x(1).
  1328     02  eiberr           pic x(1).
  1329     02  eibrldbk         pic x(1).
  1330     02  eiberrcd         pic x(4).
  1331     02  eibsynrb         pic x(1).
  1332     02  eibnodat         pic x(1).
  1333     02  eibfiller5       pic x(2).
  1334     02  eibresp          pic 9(09) comp.
  1335     02  eibresp2         pic 9(09) comp.
  1336     02  dfheigdj         pic s9(4) comp.
  1337     02  dfheigdk         pic s9(4) comp.
  1338 01  DFHCOMMAREA                 PIC  X(1024).
  1339
  1340*01 PARMLIST .
  1341*    02  FILLER                  PIC S9(08)  COMP.
  1342
  1343*    02  L-TEXT-POINTER          PIC S9(08)  COMP.
  1344
  1345*    COPY ELCTEXT.
  1346******************************************************************
  1347*                                                                *
  1348*                                                                *
  1349*                            ELCTEXT.                            *
  1350*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1351*                            VMOD=2.008                          *
  1352*                                                                *
  1353*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1354*                                     FORM LETTERS,              *
  1355*                                     CERT FORM DISPLAY.
  1356*                                                                *
  1357*   FILE TYPE = VSAM,KSDS                                        *
  1358*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1359*                                                                *
  1360*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1361*       ALTERNATE INDEX = NONE                                   *
  1362*                                                                *
  1363*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1364*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL1043.cbl
  1365*                                                                *
  1366*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1367*       ALTERNATE INDEX = NONE                                   *
  1368*                                                                *
  1369*   LOG = NO                                                     *
  1370*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1371******************************************************************
  1372 01  TEXT-FILES.
  1373     12  TEXT-FILE-ID                PIC XX.
  1374         88  FORMS-FILE-TEXT            VALUE 'TF'.
  1375         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1376         88  HELP-FILE-TEXT             VALUE 'TH'.
  1377
  1378     12  TX-CONTROL-PRIMARY.
  1379         16  TX-COMPANY-CD           PIC X.
  1380             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1381         16  TX-ACCESS-CD-GENL       PIC X(12).
  1382
  1383         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1384             20  TX-LETTER-NO        PIC X(4).
  1385             20  FILLER              PIC X(8).
  1386
  1387         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1388             20  TX-FORM-NO          PIC X(12).
  1389
  1390         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1391             20  TX-HELP-TYPE        PIC X.
  1392                 88  HELP-FOR-GENERAL   VALUE ' '.
  1393                 88  HELP-BY-SCREEN     VALUE 'S'.
  1394                 88  HELP-BY-ERROR      VALUE 'E'.
  1395             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1396                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1397             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1398                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1399             20  FILLER              PIC X(4).
  1400
  1401         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1402
  1403     12  TX-PROCESS-CONTROL          PIC XX.
  1404         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1405
  1406     12  TX-TEXT-LINE                PIC X(70).
  1407
  1408     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1409         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1410         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1411         88  TX-VALID-FORM-SQUEEZE-VALUE
  1412                                        VALUE 'Y' ' '.
  1413
  1414     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1415         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1416         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1417         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1418         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1419         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1420         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1421         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1422                                              'K' 'N' ' '
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL1043.cbl
  1423                                              'Z'.
  1424
  1425     12  TX-ARCHIVE-SW               PIC X.
  1426         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1427         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1428         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1429
  1430     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1431     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1432
  1433     12  TX-BSR-CODE                 PIC X.
  1434         88  TX-BSR-LETTER              VALUE 'B'.
  1435         88  TX-NON-BSR-LETTER          VALUE ' '.
  1436
  1437     12  FILLER                      PIC X.
  1438*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL1043.cbl
  1440 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES.
  1441 0000-DFHEXIT SECTION.
  1442     MOVE '9#                    $   ' TO DFHEIV0.
  1443     MOVE 'EL1043' TO DFHEIV1.
  1444     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1445
  1446     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1447
  1448     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1449     MOVE '5'                    TO DC-OPTION-CODE.
  1450     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  1451     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  1452     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE.
  1453
  1454
  1455* EXEC CICS HANDLE CONDITION
  1456*        PGMIDERR (9700-PGMID-ERROR)
  1457*        ERROR    (9800-ABEND)
  1458*    END-EXEC.
  1459*    MOVE '"$L.                  ! " #00001450' TO DFHEIV0
  1460     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1461     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1462     MOVE X'2220233030303031343530' TO DFHEIV0(25:11)
  1463     CALL 'kxdfhei1' USING DFHEIV0
  1464     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1465
  1466
  1467     MOVE 0000                   TO PI-1043-ERROR.
  1468
  1469     PERFORM 1000-CREATE-WORK-TABLE THRU 1000-EXIT.
  1470
  1471     IF  PI-1043-ERROR EQUAL 0000
  1472         PERFORM 3000-CREATE-NEW-TEXT THRU 3000-EXIT.
  1473
  1474     MOVE PROGRAM-INTERFACE-BLOCK
  1475                                 TO DFHCOMMAREA.
  1476
  1477* EXEC CICS RETURN
  1478*    END-EXEC.
  1479*    MOVE '.(                    &   #00001464' TO DFHEIV0
  1480     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1481     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1482     MOVE X'2020233030303031343634' TO DFHEIV0(25:11)
  1483     CALL 'kxdfhei1' USING DFHEIV0,
  1484           DFHEIV99,
  1485           DFHEIV99,
  1486           DFHEIV99,
  1487           DFHEIV99,
  1488           DFHEIV99
  1489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1490
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL1043.cbl
  1492 1000-CREATE-WORK-TABLE.
  1493
  1494     MOVE SPACES                 TO W-TX-TABLE.
  1495     SET W-TG-NDX                TO +1
  1496
  1497     MOVE PI-COMPANY-CD          TO W-TEXT-COMPANY-CD.
  1498     MOVE PI-OLD-NAME            TO W-TEXT-LETTER.
  1499     MOVE W-TEXT-PARTIAL-KEY     TO W-TEXT-SAVE-KEY.
  1500
  1501
  1502* EXEC CICS HANDLE CONDITION
  1503*         NOTFND     (1001-NOT-FOUND)
  1504*         ENDFILE    (1001-NOT-FOUND)
  1505*         NOTOPEN    (8050-TEXT-NOT-OPEN)
  1506*    END-EXEC.
  1507*    MOVE '"$I''J                 ! # #00001476' TO DFHEIV0
  1508     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  1509     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1510     MOVE X'2320233030303031343736' TO DFHEIV0(25:11)
  1511     CALL 'kxdfhei1' USING DFHEIV0
  1512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1513
  1514
  1515
  1516* EXEC CICS STARTBR
  1517*         DATASET    (W-TEXT-FILE-ID)
  1518*         RIDFLD     (W-TEXT-KEY)
  1519*         GTEQ
  1520*    END-EXEC.
  1521     MOVE 0
  1522       TO DFHEIV11
  1523*    MOVE '&,         G          &   #00001482' TO DFHEIV0
  1524     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1525     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1526     MOVE X'2020233030303031343832' TO DFHEIV0(25:11)
  1527     CALL 'kxdfhei1' USING DFHEIV0,
  1528           W-TEXT-FILE-ID,
  1529           W-TEXT-KEY,
  1530           DFHEIV99,
  1531           DFHEIV11,
  1532           DFHEIV99
  1533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1534
  1535
  1536
  1537* EXEC CICS HANDLE CONDITION
  1538*         ENDFILE    (1000-ENDBR)
  1539*    END-EXEC.
  1540*    MOVE '"$''                   ! $ #00001488' TO DFHEIV0
  1541     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  1542     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1543     MOVE X'2420233030303031343838' TO DFHEIV0(25:11)
  1544     CALL 'kxdfhei1' USING DFHEIV0
  1545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1546
  1547
  1548 1000-READ-NEXT.
  1549
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL1043.cbl
  1550
  1551* EXEC CICS READNEXT
  1552*         DATASET    (W-TEXT-FILE-ID)
  1553*         SET        (ADDRESS OF TEXT-FILES)
  1554*         RIDFLD     (W-TEXT-KEY)
  1555*    END-EXEC.
  1556     MOVE 0
  1557       TO DFHEIV11
  1558*    MOVE '&.S                   )   #00001494' TO DFHEIV0
  1559     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1560     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1561     MOVE X'2020233030303031343934' TO DFHEIV0(25:11)
  1562     CALL 'kxdfhei1' USING DFHEIV0,
  1563           W-TEXT-FILE-ID,
  1564           DFHEIV20,
  1565           DFHEIV99,
  1566           W-TEXT-KEY,
  1567           DFHEIV99,
  1568           DFHEIV11,
  1569           DFHEIV99,
  1570           DFHEIV99
  1571     SET ADDRESS OF TEXT-FILES TO
  1572         DFHEIV20
  1573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1574
  1575
  1576     IF  W-TEXT-PARTIAL-KEY NOT EQUAL W-TEXT-SAVE-KEY
  1577         GO TO 1000-ENDBR.
  1578
  1579     MOVE 'Y'                    TO W-TEXT-BROWSED-SW.
  1580
  1581     IF  TX-FORM-CONTROL-LINE
  1582             OR
  1583         TX-LINE-SQUEEZE-CONTROL EQUAL 'Z'
  1584         MOVE TEXT-FILES         TO W-TX-GRP (W-TG-NDX)
  1585         GO TO 1000-READ-NEXT.
  1586
  1587     MOVE TX-PROCESS-CONTROL     TO W-SKIP-LINES.
  1588
  1589     IF  TX-TEXT-LINE GREATER THAN SPACES
  1590         MOVE W-LAST-SKIP-LINES  TO TX-PROCESS-CONTROL
  1591         MOVE W-SKIP-LINES       TO W-LAST-SKIP-LINES
  1592         MOVE TEXT-FILES         TO W-TX-GRP (W-TG-NDX)
  1593         MOVE TX-TEXT-LINE       TO W-WORK-LINE
  1594         SET W-TX-NDX            TO W-ZEROS
  1595         PERFORM 2200-CHECK-FOR-VARIABLE THRU 2200-EXIT
  1596                 VARYING
  1597             W-WK-NDX FROM 1 BY 1
  1598                 UNTIL
  1599             W-WK-NDX GREATER THAN 70
  1600
  1601     ELSE
  1602         IF  W-SKIP-LINES EQUAL 99
  1603             MOVE W-SKIP-LINES   TO W-LAST-SKIP-LINES
  1604             GO TO 1000-READ-NEXT
  1605
  1606         ELSE
  1607             IF  W-SKIP-LINES GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL1043.cbl
  1608                 ADD W-SKIP-LINES
  1609                                 TO W-LAST-SKIP-LINES
  1610                 ADD +1          TO W-LAST-SKIP-LINES
  1611                 GO TO 1000-READ-NEXT
  1612
  1613             ELSE
  1614                 ADD +1          TO W-LAST-SKIP-LINES
  1615                 GO TO 1000-READ-NEXT.
  1616
  1617     SET W-TG-NDX UP BY 1.
  1618     GO TO 1000-READ-NEXT.
  1619
  1620 1000-ENDBR.
  1621
  1622
  1623* EXEC CICS ENDBR
  1624*        DATASET     (W-TEXT-FILE-ID)
  1625*    END-EXEC.
  1626     MOVE 0
  1627       TO DFHEIV11
  1628*    MOVE '&2                    $   #00001546' TO DFHEIV0
  1629     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1630     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1631     MOVE X'2020233030303031353436' TO DFHEIV0(25:11)
  1632     CALL 'kxdfhei1' USING DFHEIV0,
  1633           W-TEXT-FILE-ID,
  1634           DFHEIV11,
  1635           DFHEIV99
  1636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1637
  1638
  1639     IF  W-TEXT-BROWSE-NOT-STARTED
  1640         MOVE ER-0006            TO EMI-ERROR
  1641         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1642
  1643     SET W-TOTAL-TX-LINES        TO W-TG-NDX.
  1644     SUBTRACT +1 FROM W-TOTAL-TX-LINES.
  1645
  1646 1000-EXIT.
  1647     EXIT.
  1648
  1649 1001-NOT-FOUND.
  1650
  1651     MOVE ER-0006                TO EMI-ERROR.
  1652     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL1043.cbl
  1654 2200-CHECK-FOR-VARIABLE.
  1655
  1656     SET W-TX-NDX UP BY +1.
  1657
  1658     IF  W-WK-CHAR (W-WK-NDX) EQUAL '@'
  1659         SET W-WK-NDX1           TO W-WK-NDX
  1660         SET W-WK-NDX1 UP BY +1
  1661
  1662         IF  W-WK-CHAR (W-WK-NDX1) EQUAL '@'
  1663             MOVE W-WK-CHAR (W-WK-NDX)
  1664                 TO W-TX-CHAR (W-TG-NDX W-TX-NDX)
  1665             SET W-WK-NDX UP BY +1
  1666             SET W-TX-NDX UP BY +1
  1667
  1668         ELSE
  1669             PERFORM 2220-BUILD-VARIABLE-NUMBER THRU 2220-EXIT
  1670             PERFORM 2240-CONVERT-VARIABLE THRU 2240-EXIT.
  1671
  1672     MOVE W-WK-CHAR (W-WK-NDX)   TO W-TX-CHAR (W-TG-NDX W-TX-NDX).
  1673
  1674 2200-EXIT.
  1675     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL1043.cbl
  1677 2220-BUILD-VARIABLE-NUMBER.
  1678
  1679     SET W-WK-NDX UP BY +1.
  1680     MOVE W-WK-CHAR (W-WK-NDX)   TO W-V1.
  1681     SET W-WK-NDX UP BY +1.
  1682     MOVE W-WK-CHAR (W-WK-NDX)   TO W-V2.
  1683     SET W-WK-NDX UP BY +1.
  1684
  1685     IF  W-WK-CHAR (W-WK-NDX) EQUAL '.'
  1686         MOVE W-WK-CHAR (W-WK-NDX)
  1687                                 TO W-V3
  1688         SET W-WK-NDX UP BY +1
  1689         MOVE W-WK-CHAR (W-WK-NDX)
  1690                                 TO W-V4
  1691         SET W-WK-NDX UP BY +1
  1692         MOVE +1                 TO W-EXTRA-LENGTH
  1693
  1694     ELSE
  1695         MOVE +3                 TO W-EXTRA-LENGTH
  1696         MOVE '.'                TO W-V3
  1697         MOVE ZEROS              TO W-V4.
  1698
  1699 2220-EXIT.
  1700     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL1043.cbl
  1702 2240-CONVERT-VARIABLE.
  1703
  1704     SET W-VG-NDX                TO +1.
  1705     SEARCH W-VAR-HOLD-GRP
  1706         AT END
  1707             MOVE ER-0180        TO EMI-ERROR
  1708             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1709
  1710         WHEN
  1711             W-VAR-OLD (W-VG-NDX) EQUAL W-VAR-HOLD
  1712             PERFORM 2260-MOVE-NEW-VAR-HOLD THRU 2260-EXIT
  1713                     VARYING
  1714                 W-VC-NDX FROM 1 BY 1
  1715                     UNTIL
  1716                 W-VC-NDX EQUAL 7.
  1717
  1718     PERFORM 2270-ADJUST-EXTRA-LENGTH THRU 2270-EXIT
  1719             VARYING
  1720         W-WK-NDX FROM W-WK-NDX BY +1
  1721             UNTIL
  1722         W-EXTRA-LENGTH EQUAL ZERO.
  1723
  1724 2240-EXIT.
  1725     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL1043.cbl
  1727 2260-MOVE-NEW-VAR-HOLD.
  1728
  1729     MOVE W-VC-CHAR (W-VG-NDX W-VC-NDX)
  1730                                 TO W-TX-CHAR (W-TG-NDX W-TX-NDX).
  1731     SET W-TX-NDX UP BY +1.
  1732
  1733 2260-EXIT.
  1734     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL1043.cbl
  1736 2270-ADJUST-EXTRA-LENGTH.
  1737
  1738     IF  W-WK-CHAR (W-WK-NDX) EQUAL SPACES
  1739         SUBTRACT +1 FROM W-EXTRA-LENGTH
  1740
  1741     ELSE
  1742         MOVE ZEROS              TO W-EXTRA-LENGTH
  1743         SET W-WK-NDX DOWN BY +1.
  1744
  1745 2270-EXIT.
  1746     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL1043.cbl
  1748 3000-CREATE-NEW-TEXT.
  1749
  1750     IF  PI-NEW-NAME EQUAL PI-OLD-NAME
  1751         MOVE W-TX-KEY (1)       TO W-TEXT-KEY
  1752         PERFORM 4000-DELETE-OLD-TEXT THRU 4000-EXIT.
  1753
  1754
  1755* EXEC CICS HANDLE CONDITION
  1756*         NOTFND     (3200-NOT-FOUND)
  1757*         ENDFILE    (3200-NOT-FOUND)
  1758*         NOTOPEN    (8050-TEXT-NOT-OPEN)
  1759*         DUPREC     (3300-DUP-RECORD)
  1760*    END-EXEC.
  1761*    MOVE '"$I''J%                ! % #00001665' TO DFHEIV0
  1762     MOVE X'222449274A25202020202020' TO DFHEIV0(1:12)
  1763     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1764     MOVE X'2520233030303031363635' TO DFHEIV0(25:11)
  1765     CALL 'kxdfhei1' USING DFHEIV0
  1766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1767
  1768
  1769     PERFORM 3100-WRITE-NEW-TEXT THRU 3100-EXIT
  1770             VARYING
  1771         W-TG-NDX FROM 1 BY 1
  1772             UNTIL
  1773         W-TG-NDX GREATER THAN W-TOTAL-TX-LINES.
  1774
  1775 3000-EXIT.
  1776     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL1043.cbl
  1778 3100-WRITE-NEW-TEXT.
  1779
  1780     MOVE PI-NEW-NAME            TO W-TX-LETTER-NO (W-TG-NDX).
  1781     MOVE W-TX-GRP (W-TG-NDX)    TO W-TEXT-RECORD.
  1782     SET W-TR-SEQ-NO             TO W-TG-NDX.
  1783
  1784
  1785* EXEC CICS WRITE
  1786*        DATASET (W-TEXT-FILE-ID)
  1787*        FROM    (W-TEXT-RECORD)
  1788*        RIDFLD  (W-TR-KEY)
  1789*    END-EXEC.
  1790     MOVE LENGTH OF
  1791      W-TEXT-RECORD
  1792       TO DFHEIV11
  1793*    MOVE '&$ L                  ''   #00001687' TO DFHEIV0
  1794     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  1795     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1796     MOVE X'2020233030303031363837' TO DFHEIV0(25:11)
  1797     CALL 'kxdfhei1' USING DFHEIV0,
  1798           W-TEXT-FILE-ID,
  1799           W-TEXT-RECORD,
  1800           DFHEIV11,
  1801           W-TR-KEY,
  1802           DFHEIV99,
  1803           DFHEIV99
  1804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1805
  1806
  1807 3100-EXIT.
  1808     EXIT.
  1809
  1810 3200-NOT-FOUND.
  1811
  1812     MOVE ER-0006                TO EMI-ERROR.
  1813     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1814
  1815 3200-EXIT.
  1816     EXIT.
  1817
  1818 3300-DUP-RECORD.
  1819
  1820     MOVE ER-7391                TO EMI-ERROR.
  1821     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1822
  1823 3300-EXIT.
  1824     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL1043.cbl
  1826 4000-DELETE-OLD-TEXT.
  1827
  1828
  1829* EXEC CICS DELETE
  1830*        DATASET (W-TEXT-FILE-ID)
  1831*        RIDFLD  (W-TEXT-KEY)
  1832*        KEYLENGTH (5)
  1833*        GENERIC
  1834*    END-EXEC.
  1835     MOVE 5
  1836       TO DFHEIV11
  1837*    MOVE '&(  RKG               &   #00001714' TO DFHEIV0
  1838     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  1839     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1840     MOVE X'2020233030303031373134' TO DFHEIV0(25:11)
  1841     CALL 'kxdfhei1' USING DFHEIV0,
  1842           W-TEXT-FILE-ID,
  1843           W-TEXT-KEY,
  1844           DFHEIV11,
  1845           DFHEIV99,
  1846           DFHEIV99
  1847     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1848
  1849
  1850 4000-EXIT.
  1851     EXIT.
  1852
  1853 8050-TEXT-NOT-OPEN.
  1854
  1855     MOVE ER-0013                TO EMI-ERROR.
  1856     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL1043.cbl
  1858 9000-RETURN-TRANS.
  1859
  1860
  1861
  1862* EXEC CICS RETURN
  1863*        TRANSID  (W-TRANSACTION)
  1864*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  1865*        LENGTH   (PI-COMM-LENGTH)
  1866*    END-EXEC.
  1867*    MOVE '.(CT                  &   #00001732' TO DFHEIV0
  1868     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1869     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1870     MOVE X'2020233030303031373332' TO DFHEIV0(25:11)
  1871     CALL 'kxdfhei1' USING DFHEIV0,
  1872           W-TRANSACTION,
  1873           PROGRAM-INTERFACE-BLOCK,
  1874           PI-COMM-LENGTH,
  1875           DFHEIV99,
  1876           DFHEIV99
  1877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1878
  1879
  1880 9000-EXIT.
  1881     EXIT.
  1882
  1883 9400-XCTL.
  1884
  1885
  1886* EXEC CICS XCTL
  1887*        PROGRAM  (W-CALL-PGM)
  1888*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  1889*        LENGTH   (PI-COMM-LENGTH)
  1890*    END-EXEC.
  1891*    MOVE '.$C                   $   #00001743' TO DFHEIV0
  1892     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  1893     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1894     MOVE X'2020233030303031373433' TO DFHEIV0(25:11)
  1895     CALL 'kxdfhei1' USING DFHEIV0,
  1896           W-CALL-PGM,
  1897           PROGRAM-INTERFACE-BLOCK,
  1898           PI-COMM-LENGTH
  1899     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1900
  1901
  1902 9400-EXIT.
  1903     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL1043.cbl
  1905 9500-LINK-DATE-CONVERT.
  1906
  1907     IF  DC-BIN-DATE-1 EQUAL HIGH-VALUES
  1908             AND
  1909         DC-OPTION-CODE EQUAL ' '
  1910         MOVE '99/99/99'         TO DC-GREG-DATE-1-EDIT
  1911         GO TO 9500-EXIT.
  1912
  1913
  1914* EXEC CICS LINK
  1915*        PROGRAM    ('ELDATCV')
  1916*        COMMAREA   (DATE-CONVERSION-DATA)
  1917*        LENGTH     (DC-COMM-LENGTH)
  1918*    END-EXEC.
  1919     MOVE 'ELDATCV' TO DFHEIV1
  1920*    MOVE '."C                   ''   #00001760' TO DFHEIV0
  1921     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1922     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1923     MOVE X'2020233030303031373630' TO DFHEIV0(25:11)
  1924     CALL 'kxdfhei1' USING DFHEIV0,
  1925           DFHEIV1,
  1926           DATE-CONVERSION-DATA,
  1927           DC-COMM-LENGTH,
  1928           DFHEIV99,
  1929           DFHEIV99,
  1930           DFHEIV99
  1931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1932
  1933
  1934 9500-EXIT.
  1935     EXIT.
  1936
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL1043.cbl
  1938 9700-PGMID-ERROR.
  1939
  1940     MOVE '9999'                 TO PI-1043-ERROR.
  1941     MOVE PROGRAM-INTERFACE-BLOCK
  1942                                 TO DFHCOMMAREA.
  1943
  1944* EXEC CICS RETURN
  1945*    END-EXEC.
  1946*    MOVE '.(                    &   #00001775' TO DFHEIV0
  1947     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1948     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1949     MOVE X'2020233030303031373735' TO DFHEIV0(25:11)
  1950     CALL 'kxdfhei1' USING DFHEIV0,
  1951           DFHEIV99,
  1952           DFHEIV99,
  1953           DFHEIV99,
  1954           DFHEIV99,
  1955           DFHEIV99
  1956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1957
  1958
  1959 9700-EXIT.
  1960     EXIT.
  1961
  1962 9800-ABEND.
  1963
  1964     MOVE '9999'                 TO PI-1043-ERROR.
  1965     MOVE PROGRAM-INTERFACE-BLOCK
  1966                                 TO DFHCOMMAREA.
  1967
  1968* EXEC CICS RETURN
  1969*    END-EXEC.
  1970*    MOVE '.(                    &   #00001786' TO DFHEIV0
  1971     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1972     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1973     MOVE X'2020233030303031373836' TO DFHEIV0(25:11)
  1974     CALL 'kxdfhei1' USING DFHEIV0,
  1975           DFHEIV99,
  1976           DFHEIV99,
  1977           DFHEIV99,
  1978           DFHEIV99,
  1979           DFHEIV99
  1980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1981
  1982
  1983 9800-EXIT.
  1984     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL1043.cbl
  1986 9900-ERROR-FORMAT.
  1987
  1988     MOVE EMI-ERROR              TO PI-1043-ERROR
  1989
  1990     MOVE PROGRAM-INTERFACE-BLOCK
  1991                                 TO DFHCOMMAREA.
  1992
  1993* EXEC CICS RETURN
  1994*    END-EXEC.
  1995*    MOVE '.(                    &   #00001798' TO DFHEIV0
  1996     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1997     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1998     MOVE X'2020233030303031373938' TO DFHEIV0(25:11)
  1999     CALL 'kxdfhei1' USING DFHEIV0,
  2000           DFHEIV99,
  2001           DFHEIV99,
  2002           DFHEIV99,
  2003           DFHEIV99,
  2004           DFHEIV99
  2005     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2006
  2007
  2008 9900-EXIT.
  2009     EXIT.
  2010
  2011 9999-GOBACK.
  2012
  2013
  2014* GOBACK.
  2015     MOVE '9%                    "   ' TO DFHEIV0
  2016     MOVE 'EL1043' TO DFHEIV1
  2017     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2018     GOBACK.
  2019
  2020 9999-EXIT.
  2021     EXIT.
  2022
  2023 9999-DFHBACK SECTION.
  2024     MOVE '9%                    "   ' TO DFHEIV0
  2025     MOVE 'EL1043' TO DFHEIV1
  2026     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2027     GOBACK.
  2028 9999-DFHEXIT.
  2029     IF DFHEIGDJ EQUAL 0001
  2030         NEXT SENTENCE
  2031     ELSE IF DFHEIGDJ EQUAL 2
  2032         GO TO 9700-PGMID-ERROR,
  2033               9800-ABEND
  2034         DEPENDING ON DFHEIGDI
  2035     ELSE IF DFHEIGDJ EQUAL 3
  2036         GO TO 1001-NOT-FOUND,
  2037               1001-NOT-FOUND,
  2038               8050-TEXT-NOT-OPEN
  2039         DEPENDING ON DFHEIGDI
  2040     ELSE IF DFHEIGDJ EQUAL 4
  2041         GO TO 1000-ENDBR
  2042         DEPENDING ON DFHEIGDI
  2043     ELSE IF DFHEIGDJ EQUAL 5
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL1043.cbl
  2044         GO TO 3200-NOT-FOUND,
  2045               3200-NOT-FOUND,
  2046               8050-TEXT-NOT-OPEN,
  2047               3300-DUP-RECORD
  2048         DEPENDING ON DFHEIGDI.
  2049     MOVE '9%                    "   ' TO DFHEIV0
  2050     MOVE 'EL1043' TO DFHEIV1
  2051     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2052     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       32000     Code:        3573
