* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL605.cbl
* Options: int("EL605.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL605.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL605.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL605.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL605.
     4*                            VMOD=2.001.
     5*
     6*
     7*AUTHOR.     CENTRAL STATES HEALTH AND LIFE.
     8*            OMAHA, NEBRASKA
     9
    10*DATE-COMPILED.
    11
    12*SECURITY.   *****************************************************
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL605.cbl
    14*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    15*            *                                                   *
    16*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    17*            *   OF     CSO     IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF CSO             *
    19*            *                                                   *
    20*            *****************************************************
    21
    22*REMARKS.    TRANSACTION - EXAA - LIFE CLAIM INTEREST MENU
    23
    24 ENVIRONMENT DIVISION.
    25
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL605.cbl
    27 DATA DIVISION.
    28 WORKING-STORAGE SECTION.
    29 01  DFH-START PIC X(04).
    30 77  FILLER  PIC X(32)  VALUE '********************************'.
    31 77  FILLER  PIC X(32)  VALUE '*    EL605 WORKING STORAGE     *'.
    32 77  FILLER  PIC X(32)  VALUE '*************V/M 2.001 *********'.
    33
    34 01  WS-DATE-AREA.
    35     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    36     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
    37
    38 01  MISC-WORK-AREAS.
    39
    40     12  MAP-EL605A          PIC X(8)    VALUE 'EL605A'.
    41     12  MAPSET-EL605S       PIC X(8)    VALUE 'EL605S'.
    42     12  TRANS-EXAA          PIC X(4)    VALUE 'EXAA'.
    43     12  PGM-EL605           PIC X(8)    VALUE 'EL605'.
    44     12  PGM-NAME            PIC X(8).
    45     12  TIME-IN             PIC S9(7).
    46     12  TIME-OUT-R  REDEFINES TIME-IN.
    47         16  FILLER          PIC X.
    48         16  TIME-OUT        PIC 99V99.
    49         16  FILLER          PIC X(2).
    50     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
    51     12  LINK-EL001          PIC X(8)    VALUE 'EL001'.
    52     12  LINK-EL004          PIC X(8)    VALUE 'EL004'.
    53
    54     12  XCTL-EL005          PIC X(8)    VALUE 'EL005'.
    55     12  XCTL-EL010          PIC X(8)    VALUE 'EL010'.
    56     12  XCTL-EL102          PIC X(8)    VALUE 'EL102'.
    57     12  XCTL-EL103          PIC X(8)    VALUE 'EL103'.
    58     12  XCTL-EL104          PIC X(8)    VALUE 'EL104'.
    59     12  XCTL-EL105          PIC X(8)    VALUE 'EL105'.
    60     12  XCTL-EL106          PIC X(8)    VALUE 'EL106'.
    61     12  XCTL-EL107          PIC X(8)    VALUE 'EL107'.
    62     12  XCTL-EL108          PIC X(8)    VALUE 'EL108'.
    63     12  XCTL-EL110          PIC X(8)    VALUE 'EL110'.
    64     12  XCTL-EL111          PIC X(8)    VALUE 'EL111'.
    65     12  XCTL-EL112          PIC X(8)    VALUE 'EL112'.
    66     12  XCTL-EL119          PIC X(8)    VALUE 'EL119'.
    67     12  XCTL-EL126          PIC X(8)    VALUE 'EL800'.
    68     12  XCTL-EL158          PIC X(8)    VALUE 'EL158'.
    69     12  XCTL-EL602          PIC X(8)    VALUE 'EL602'.
    70     12  XCTL-EL603          PIC X(8)    VALUE 'EL603'.
    71     12  XCTL-EL604          PIC X(8)    VALUE 'EL604'.
    72     12  XCTL-EL605          PIC X(8)    VALUE 'EL605'.
    73     12  XCTL-EL606          PIC X(8)    VALUE 'EL606'.
    74     12  XCTL-EL607          PIC X(8)    VALUE 'EL607'.
    75     12  XCTL-EL608          PIC X(8)    VALUE 'EL608 '.
    76     12  XCTL-EL609          PIC X(8)    VALUE 'EL609 '.
    77     12  XCTL-EL610          PIC X(8)    VALUE 'EL610'.
    78     12  XCTL-EL612          PIC X(8)    VALUE 'EL612'.
    79     12  XCTL-EL613          PIC X(8)    VALUE 'EL613'.
    80     12  XCTL-EL626          PIC X(8)    VALUE 'EL626'.
    81     12  XCTL-EL650          PIC X(8)    VALUE 'EL650'.
    82     12  XCTL-EL651          PIC X(8)    VALUE 'EL651'.
    83     12  XCTL-EL652          PIC X(8)    VALUE 'EL652'.
    84     12  XCTL-EL653          PIC X(8)    VALUE 'EL653'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL605.cbl
    85     12  XCTL-EL654          PIC X(8)    VALUE 'EL654'.
    86     12  XCTL-EL656          PIC X(8)    VALUE 'EL656'.
    87     12  XCTL-EL658          PIC X(8)    VALUE 'EL658'.
    88     12  XCTL-EL659          PIC X(8)    VALUE 'EL659'.
    89     12  XCTL-EL1062         PIC X(8)    VALUE 'EL1062'.
    90     12  XCTL-EL1064         PIC X(8)    VALUE 'EL1064'.
    91
    92     12  ER-0002             PIC X(4)    VALUE '0002'.
    93     12  ER-2370             PIC X(4)    VALUE '2370'.
    94     12  ER-2371             PIC X(4)    VALUE '2371'.
    95     12  ER-7000             PIC X(4)    VALUE '7000'.
    96     12  ER-7001             PIC X(4)    VALUE '7001'.
    97     12  ER-7002             PIC X(4)    VALUE '7002'.
    98     12  ER-7003             PIC X(4)    VALUE '7003'.
    99     12  ER-7008             PIC X(4)    VALUE '7008'.
   100     12  ER-7448             PIC X(4)    VALUE '7448'.
   101
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL605.cbl
   103*                            COPY ELCLOGOF.
   104******************************************************************
   105*                                                                *
   106*                                                                *
   107*                            ELCLOGOF.                           *
   108*                            VMOD=2.001                          *
   109*                                                                *
   110*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   111*                                                                *
   112******************************************************************
   113 01  CLASIC-LOGOFF.
   114     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   115     12  LOGOFF-TEXT.
   116         16  FILLER          PIC X(5)    VALUE SPACES.
   117         16  LOGOFF-MSG.
   118             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   119             20  FILLER      PIC X       VALUE SPACES.
   120             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   121         16  FILLER          PIC X(80)
   122           VALUE '* YOU ARE NOW LOGGED OFF'.
   123         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   124         16  FILLER          PIC X       VALUE QUOTE.
   125         16  LOGOFF-SYS-MSG  PIC X(17)
   126           VALUE 'S CLAS-IC SYSTEM '.
   127     12  TEXT-MESSAGES.
   128         16  UNACCESS-MSG    PIC X(29)
   129             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   130         16  PGMIDERR-MSG    PIC X(17)
   131             VALUE 'PROGRAM NOT FOUND'.
   132
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL605.cbl
   134*                            COPY ELCDATE.
   135******************************************************************
   136*                                                                *
   137*                                                                *
   138*                            ELCDATE.                            *
   139*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   140*                            VMOD=2.003
   141*                                                                *
   142*                                                                *
   143*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   144*                 LENGTH = 200                                   *
   145******************************************************************
   146
   147 01  DATE-CONVERSION-DATA.
   148     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   149     12  DC-OPTION-CODE                PIC X.
   150         88  BIN-TO-GREG                VALUE ' '.
   151         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   152         88  EDIT-GREG-TO-BIN           VALUE '2'.
   153         88  YMD-GREG-TO-BIN            VALUE '3'.
   154         88  MDY-GREG-TO-BIN            VALUE '4'.
   155         88  JULIAN-TO-BIN              VALUE '5'.
   156         88  BIN-PLUS-ELAPSED           VALUE '6'.
   157         88  FIND-CENTURY               VALUE '7'.
   158         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   159         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   160         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   161         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   162         88  JULIAN-TO-BIN-3            VALUE 'C'.
   163         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   164         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   165         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   166         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   167         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   168         88  CHECK-LEAP-YEAR            VALUE 'H'.
   169         88  BIN-3-TO-GREG              VALUE 'I'.
   170         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   171         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   172         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   173         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   174         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   175         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   176         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   177         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   178         88  THREE-CHARACTER-BIN
   179                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   180         88  GREGORIAN-TO-BIN
   181                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   182         88  BIN-TO-GREGORIAN
   183                  VALUES ' ' '1' 'I' '8' 'G'.
   184         88  JULIAN-TO-BINARY
   185                  VALUES '5' 'C' 'E' 'F'.
   186     12  DC-ERROR-CODE                 PIC X.
   187         88  NO-CONVERSION-ERROR        VALUE ' '.
   188         88  DATE-CONVERSION-ERROR
   189                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   190         88  DATE-IS-ZERO               VALUE '1'.
   191         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL605.cbl
   192         88  DATE-IS-INVALID            VALUE '3'.
   193         88  DATE1-GREATER-DATE2        VALUE '4'.
   194         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   195         88  DATE-INVALID-OPTION        VALUE '9'.
   196         88  INVALID-CENTURY            VALUE 'A'.
   197         88  ONLY-CENTURY               VALUE 'B'.
   198         88  ONLY-LEAP-YEAR             VALUE 'C'.
   199         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   200     12  DC-END-OF-MONTH               PIC X.
   201         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   202     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   203         88  USE-NORMAL-PROCESS         VALUE ' '.
   204         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   205         88  ADJUST-UP-100-YRS          VALUE '2'.
   206     12  FILLER                        PIC X.
   207     12  DC-CONVERSION-DATES.
   208         16  DC-BIN-DATE-1             PIC XX.
   209         16  DC-BIN-DATE-2             PIC XX.
   210         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   211         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   212                       DC-GREG-DATE-1-EDIT.
   213             20  DC-EDIT1-MONTH        PIC 99.
   214             20  SLASH1-1              PIC X.
   215             20  DC-EDIT1-DAY          PIC 99.
   216             20  SLASH1-2              PIC X.
   217             20  DC-EDIT1-YEAR         PIC 99.
   218         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   219         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   220                     DC-GREG-DATE-2-EDIT.
   221             20  DC-EDIT2-MONTH        PIC 99.
   222             20  SLASH2-1              PIC X.
   223             20  DC-EDIT2-DAY          PIC 99.
   224             20  SLASH2-2              PIC X.
   225             20  DC-EDIT2-YEAR         PIC 99.
   226         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   227         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   228                     DC-GREG-DATE-1-YMD.
   229             20  DC-YMD-YEAR           PIC 99.
   230             20  DC-YMD-MONTH          PIC 99.
   231             20  DC-YMD-DAY            PIC 99.
   232         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   233         16  DC-GREG-DATE-1-MDY-R REDEFINES
   234                      DC-GREG-DATE-1-MDY.
   235             20  DC-MDY-MONTH          PIC 99.
   236             20  DC-MDY-DAY            PIC 99.
   237             20  DC-MDY-YEAR           PIC 99.
   238         16  DC-GREG-DATE-1-ALPHA.
   239             20  DC-ALPHA-MONTH        PIC X(10).
   240             20  DC-ALPHA-DAY          PIC 99.
   241             20  FILLER                PIC XX.
   242             20  DC-ALPHA-CENTURY.
   243                 24 DC-ALPHA-CEN-N     PIC 99.
   244             20  DC-ALPHA-YEAR         PIC 99.
   245         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   246         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   247         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   248         16  DC-JULIAN-DATE            PIC 9(05).
   249         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL605.cbl
   250                                       PIC 9(05).
   251         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   252             20  DC-JULIAN-YEAR        PIC 99.
   253             20  DC-JULIAN-DAYS        PIC 999.
   254         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   255         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   256         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   257     12  DATE-CONVERSION-VARIBLES.
   258         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   259         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   260             20  FILLER                PIC 9(3).
   261             20  HOLD-CEN-1-CCYY.
   262                 24  HOLD-CEN-1-CC     PIC 99.
   263                 24  HOLD-CEN-1-YY     PIC 99.
   264             20  HOLD-CEN-1-MO         PIC 99.
   265             20  HOLD-CEN-1-DA         PIC 99.
   266         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   267             20  HOLD-CEN-1-R-MO       PIC 99.
   268             20  HOLD-CEN-1-R-DA       PIC 99.
   269             20  HOLD-CEN-1-R-CCYY.
   270                 24  HOLD-CEN-1-R-CC   PIC 99.
   271                 24  HOLD-CEN-1-R-YY   PIC 99.
   272             20  FILLER                PIC 9(3).
   273         16  HOLD-CENTURY-1-X.
   274             20  FILLER                PIC X(3)  VALUE SPACES.
   275             20  HOLD-CEN-1-X-CCYY.
   276                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   277                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   278             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   279             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   280         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   281             20  HOLD-CEN-1-R-X-MO     PIC XX.
   282             20  HOLD-CEN-1-R-X-DA     PIC XX.
   283             20  HOLD-CEN-1-R-X-CCYY.
   284                 24  HOLD-CEN-1-R-X-CC PIC XX.
   285                 24  HOLD-CEN-1-R-X-YY PIC XX.
   286             20  FILLER                PIC XXX.
   287         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   288         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   289         16  DC-JULIAN-DATE-1          PIC 9(07).
   290         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   291             20  DC-JULIAN-1-CCYY.
   292                 24  DC-JULIAN-1-CC    PIC 99.
   293                 24  DC-JULIAN-1-YR    PIC 99.
   294             20  DC-JULIAN-DA-1        PIC 999.
   295         16  DC-JULIAN-DATE-2          PIC 9(07).
   296         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   297             20  DC-JULIAN-2-CCYY.
   298                 24  DC-JULIAN-2-CC    PIC 99.
   299                 24  DC-JULIAN-2-YR    PIC 99.
   300             20  DC-JULIAN-DA-2        PIC 999.
   301         16  DC-GREG-DATE-A-EDIT.
   302             20  DC-EDITA-MONTH        PIC 99.
   303             20  SLASHA-1              PIC X VALUE '/'.
   304             20  DC-EDITA-DAY          PIC 99.
   305             20  SLASHA-2              PIC X VALUE '/'.
   306             20  DC-EDITA-CCYY.
   307                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL605.cbl
   308                 24  DC-EDITA-YEAR     PIC 99.
   309         16  DC-GREG-DATE-B-EDIT.
   310             20  DC-EDITB-MONTH        PIC 99.
   311             20  SLASHB-1              PIC X VALUE '/'.
   312             20  DC-EDITB-DAY          PIC 99.
   313             20  SLASHB-2              PIC X VALUE '/'.
   314             20  DC-EDITB-CCYY.
   315                 24  DC-EDITB-CENT     PIC 99.
   316                 24  DC-EDITB-YEAR     PIC 99.
   317         16  DC-GREG-DATE-CYMD         PIC 9(08).
   318         16  DC-GREG-DATE-CYMD-R REDEFINES
   319                              DC-GREG-DATE-CYMD.
   320             20  DC-CYMD-CEN           PIC 99.
   321             20  DC-CYMD-YEAR          PIC 99.
   322             20  DC-CYMD-MONTH         PIC 99.
   323             20  DC-CYMD-DAY           PIC 99.
   324         16  DC-GREG-DATE-MDCY         PIC 9(08).
   325         16  DC-GREG-DATE-MDCY-R REDEFINES
   326                              DC-GREG-DATE-MDCY.
   327             20  DC-MDCY-MONTH         PIC 99.
   328             20  DC-MDCY-DAY           PIC 99.
   329             20  DC-MDCY-CEN           PIC 99.
   330             20  DC-MDCY-YEAR          PIC 99.
   331    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   332        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   333    12  DC-EL310-DATE                  PIC X(21).
   334    12  FILLER                         PIC X(28).
   335
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL605.cbl
   337*                            COPY ELCATTR.
   338******************************************************************
   339*                                                                *
   340*                            ELCATTR.                            *
   341*                            VMOD=2.001                          *
   342*                                                                *
   343*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   344*                                                                *
   345*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   346*                                                                *
   347*                   POS 1   P=PROTECTED                          *
   348*                           U=UNPROTECTED                        *
   349*                           S=ASKIP                              *
   350*                   POS 2   A=ALPHA/NUMERIC                      *
   351*                           N=NUMERIC                            *
   352*                   POS 3   N=NORMAL                             *
   353*                           B=BRIGHT                             *
   354*                           D=DARK                               *
   355*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   356*                           OF=MODIFIED DATA TAG OFF             *
   357*                                                                *
   358*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   359******************************************************************
   360 01  ATTRIBUTE-LIST.
   361     12  AL-PABOF            PIC X       VALUE 'Y'.
   362     12  AL-PABON            PIC X       VALUE 'Z'.
   363     12  AL-PADOF            PIC X       VALUE '%'.
   364     12  AL-PADON            PIC X       VALUE '_'.
   365     12  AL-PANOF            PIC X       VALUE '-'.
   366     12  AL-PANON            PIC X       VALUE '/'.
   367     12  AL-SABOF            PIC X       VALUE '8'.
   368     12  AL-SABON            PIC X       VALUE '9'.
   369     12  AL-SADOF            PIC X       VALUE '@'.
   370     12  AL-SADON            PIC X       VALUE QUOTE.
   371     12  AL-SANOF            PIC X       VALUE '0'.
   372     12  AL-SANON            PIC X       VALUE '1'.
   373     12  AL-UABOF            PIC X       VALUE 'H'.
   374     12  AL-UABON            PIC X       VALUE 'I'.
   375     12  AL-UADOF            PIC X       VALUE '<'.
   376     12  AL-UADON            PIC X       VALUE '('.
   377     12  AL-UANOF            PIC X       VALUE ' '.
   378     12  AL-UANON            PIC X       VALUE 'A'.
   379     12  AL-UNBOF            PIC X       VALUE 'Q'.
   380     12  AL-UNBON            PIC X       VALUE 'R'.
   381     12  AL-UNDOF            PIC X       VALUE '*'.
   382     12  AL-UNDON            PIC X       VALUE ')'.
   383     12  AL-UNNOF            PIC X       VALUE '&'.
   384     12  AL-UNNON            PIC X       VALUE 'J'.
   385
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL605.cbl
   387*                            COPY ELCEMIB.
   388******************************************************************
   389*                                                                *
   390*                                                                *
   391*                            ELCEMIB.                            *
   392*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   393*                            VMOD=2.005                          *
   394*                                                                *
   395*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   396*                                                                *
   397******************************************************************
   398 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   399     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   400     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   401     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   402     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   403     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   404     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   405     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   406     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   407     12  EMI-SWITCH1             PIC X        VALUE '1'.
   408         88  EMI-NO-ERRORS                    VALUE '1'.
   409         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   410         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   411     12  EMI-SWITCH2             PIC X        VALUE '1'.
   412         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   413     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   414         88  EMI-AREA1-EMPTY                  VALUE '1'.
   415         88  EMI-AREA1-FULL                   VALUE '2'.
   416     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   417         88  EMI-AREA2-EMPTY                  VALUE '1'.
   418         88  EMI-AREA2-FULL                   VALUE '2'.
   419     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   420         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   421         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   422         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   423         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   424         88  EMI-BYPASS-FATALS                VALUE 'X'.
   425     12  EMI-ERROR-LINES.
   426         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   427         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   428         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   429         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   430             20  EMI-ERR-CODES OCCURS 10 TIMES.
   431                 24  EMI-ERR-NUM         PIC X(4).
   432                 24  EMI-FILLER          PIC X.
   433                 24  EMI-SEV             PIC X.
   434                 24  FILLER              PIC X.
   435             20  FILLER                  PIC X(02).
   436     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   437         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   438             20  EMI-ERROR-NUMBER    PIC X(4).
   439             20  EMI-FILL            PIC X.
   440             20  EMI-SEVERITY        PIC X.
   441             20  FILLER              PIC X.
   442             20  EMI-ERROR-TEXT.
   443                 24  EMI-TEXT-VARIABLE   PIC X(10).
   444                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL605.cbl
   445     12  EMI-SEVERITY-SAVE           PIC X.
   446         88  EMI-NOTE                    VALUE 'N'.
   447         88  EMI-WARNING                 VALUE 'W'.
   448         88  EMI-FORCABLE                VALUE 'F'.
   449         88  EMI-FATAL                   VALUE 'X'.
   450     12  EMI-MESSAGE-FLAG            PIC X.
   451         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   452         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   453     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   454     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   455         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   456         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   457         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   458     12  FILLER                      PIC X(137)  VALUE SPACES.
   459     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   460     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   461     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   462     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   463
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL605.cbl
   465*                            COPY ELCINTF.
   466******************************************************************
   467*                                                                *
   468*                                                                *
   469*                            ELCINTF.                            *
   470*                            VMOD=2.017                          *
   471*                                                                *
   472*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   473*                                                                *
   474*       LENGTH = 1024                                            *
   475*                                                                *
   476******************************************************************
   477 01  PROGRAM-INTERFACE-BLOCK.
   478     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   479     12  PI-CALLING-PROGRAM              PIC X(8).
   480     12  PI-SAVED-PROGRAM-1              PIC X(8).
   481     12  PI-SAVED-PROGRAM-2              PIC X(8).
   482     12  PI-SAVED-PROGRAM-3              PIC X(8).
   483     12  PI-SAVED-PROGRAM-4              PIC X(8).
   484     12  PI-SAVED-PROGRAM-5              PIC X(8).
   485     12  PI-SAVED-PROGRAM-6              PIC X(8).
   486     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   487     12  PI-COMPANY-ID                   PIC XXX.
   488     12  PI-COMPANY-CD                   PIC X.
   489
   490     12  PI-COMPANY-PASSWORD             PIC X(8).
   491
   492     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   493
   494     12  PI-CONTROL-IN-PROGRESS.
   495         16  PI-CARRIER                  PIC X.
   496         16  PI-GROUPING                 PIC X(6).
   497         16  PI-STATE                    PIC XX.
   498         16  PI-ACCOUNT                  PIC X(10).
   499         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   500                                         PIC X(10).
   501         16  PI-CLAIM-CERT-GRP.
   502             20  PI-CLAIM-NO             PIC X(7).
   503             20  PI-CERT-NO.
   504                 25  PI-CERT-PRIME       PIC X(10).
   505                 25  PI-CERT-SFX         PIC X.
   506             20  PI-CERT-EFF-DT          PIC XX.
   507         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   508             20  PI-PLAN-CODE            PIC X(2).
   509             20  PI-REVISION-NUMBER      PIC X(3).
   510             20  PI-PLAN-EFF-DT          PIC X(2).
   511             20  PI-PLAN-EXP-DT          PIC X(2).
   512             20  FILLER                  PIC X(11).
   513         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   514             20  PI-OE-REFERENCE-1.
   515                 25  PI-OE-REF-1-PRIME   PIC X(18).
   516                 25  PI-OE-REF-1-SUFF    PIC XX.
   517
   518     12  PI-SESSION-IN-PROGRESS          PIC X.
   519         88  CLAIM-SESSION                   VALUE '1'.
   520         88  CREDIT-SESSION                  VALUE '2'.
   521         88  WARRANTY-SESSION                VALUE '3'.
   522         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL605.cbl
   523         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   524
   525
   526*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   527
   528     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   529     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   530
   531     12  PI-CREDIT-USER                  PIC X.
   532         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   533         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   534
   535     12  PI-CLAIM-USER                   PIC X.
   536         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   537         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   538
   539     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   540         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   541         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   542         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   543         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   544         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   545
   546     12  PI-PROCESSOR-ID                 PIC X(4).
   547
   548     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   549
   550     12  PI-MEMBER-CAPTION               PIC X(10).
   551
   552     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   553         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   554
   555     12  PI-LIFE-OVERRIDE-L1             PIC X.
   556     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   557     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   558     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   559
   560     12  PI-AH-OVERRIDE-L1               PIC X.
   561     12  PI-AH-OVERRIDE-L2               PIC XX.
   562     12  PI-AH-OVERRIDE-L6               PIC X(6).
   563     12  PI-AH-OVERRIDE-L12              PIC X(12).
   564
   565     12  PI-NEW-SYSTEM                   PIC X(2).
   566
   567     12  PI-PRIMARY-CERT-NO              PIC X(11).
   568     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   569         88  PI-USES-PAID-TO                 VALUE '1'.
   570     12  PI-CRDTCRD-SYSTEM.
   571         16  PI-CRDTCRD-USER             PIC X.
   572             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   573             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   574         16  PI-CC-MONTH-END-DT          PIC XX.
   575     12  PI-PROCESSOR-PRINTER            PIC X(4).
   576
   577     12  PI-OE-REFERENCE-2.
   578         16  PI-OE-REF-2-PRIME           PIC X(10).
   579         16  PI-OE-REF-2-SUFF            PIC X.
   580
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL605.cbl
   581     12  PI-REM-TRM-CALC-OPTION          PIC X.
   582
   583     12  PI-LANGUAGE-TYPE                PIC X.
   584             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   585             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   586             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   587
   588     12  PI-POLICY-LINKAGE-IND           PIC X.
   589         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   590         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   591                                                   LOW-VALUES.
   592
   593     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   594     12  PI-CLAIM-PW-SESSION             PIC X(1).
   595         88  PI-CLAIM-CREDIT                 VALUE '1'.
   596         88  PI-CLAIM-CONVEN                 VALUE '2'.
   597     12  FILLER                          PIC X(4).
   598
   599     12  PI-SYSTEM-LEVEL                 PIC X(145).
   600
   601     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   602         PI-SYSTEM-LEVEL.
   603
   604         16  PI-ENTRY-CODES.
   605             20  PI-ENTRY-CD-1           PIC X.
   606             20  PI-ENTRY-CD-2           PIC X.
   607
   608         16  PI-RETURN-CODES.
   609             20  PI-RETURN-CD-1          PIC X.
   610             20  PI-RETURN-CD-2          PIC X.
   611
   612         16  PI-UPDATE-STATUS-SAVE.
   613             20  PI-UPDATE-BY            PIC X(4).
   614             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   615
   616         16  PI-LOWER-CASE-LETTERS       PIC X.
   617             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   618
   619*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   620*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   621*            88  CARRIER-CLM-CNTL            VALUE '2'.
   622
   623         16  PI-CERT-ACCESS-CONTROL      PIC X.
   624             88  ST-ACCNT-CNTL               VALUE ' '.
   625             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   626             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   627             88  ACCNT-CNTL                  VALUE '3'.
   628             88  CARR-ACCNT-CNTL             VALUE '4'.
   629
   630         16  PI-PROCESSOR-CAP-LIST.
   631             20  PI-SYSTEM-CONTROLS.
   632                24 PI-SYSTEM-DISPLAY     PIC X.
   633                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   634                24 PI-SYSTEM-MODIFY      PIC X.
   635                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   636             20  FILLER                  PIC XX.
   637             20  PI-DISPLAY-CAP          PIC X.
   638                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL605.cbl
   639             20  PI-MODIFY-CAP           PIC X.
   640                 88  MODIFY-CAP              VALUE 'Y'.
   641             20  PI-MSG-AT-LOGON-CAP     PIC X.
   642                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   643             20  PI-FORCE-CAP            PIC X.
   644                 88  FORCE-CAP               VALUE 'Y'.
   645
   646         16  PI-PROGRAM-CONTROLS.
   647             20  PI-PGM-PRINT-OPT        PIC X.
   648             20  PI-PGM-FORMAT-OPT       PIC X.
   649             20  PI-PGM-PROCESS-OPT      PIC X.
   650             20  PI-PGM-TOTALS-OPT       PIC X.
   651
   652         16  PI-HELP-INTERFACE.
   653             20  PI-LAST-ERROR-NO        PIC X(4).
   654             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   655
   656         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   657             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   658
   659         16  PI-CR-CONTROL-IN-PROGRESS.
   660             20  PI-CR-CARRIER           PIC X.
   661             20  PI-CR-GROUPING          PIC X(6).
   662             20  PI-CR-STATE             PIC XX.
   663             20  PI-CR-ACCOUNT           PIC X(10).
   664             20  PI-CR-FIN-RESP          PIC X(10).
   665             20  PI-CR-TYPE              PIC X.
   666
   667         16  PI-CR-BATCH-NUMBER          PIC X(6).
   668
   669         16  PI-CR-MONTH-END-DT          PIC XX.
   670
   671         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   672             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   673             88  PI-ZERO-CARRIER             VALUE '1'.
   674             88  PI-ZERO-GROUPING            VALUE '2'.
   675             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   676
   677         16  PI-CARRIER-SECURITY         PIC X.
   678             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   679
   680         16  PI-ACCOUNT-SECURITY         PIC X(10).
   681             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   682             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   683
   684         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   685             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   686                                         INDEXED BY PI-ACCESS-NDX
   687                                         PIC X.
   688
   689         16  PI-GA-BILLING-CONTROL       PIC X.
   690             88  PI-GA-BILLING               VALUE '1'.
   691
   692         16  PI-MAIL-PROCESSING          PIC X.
   693             88  PI-MAIL-YES                 VALUE 'Y'.
   694
   695         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   696
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL605.cbl
   697         16  PI-AR-SYSTEM.
   698             20  PI-AR-PROCESSING-CNTL   PIC X.
   699                 88  PI-AR-PROCESSING        VALUE 'Y'.
   700             20  PI-AR-SUMMARY-CODE      PIC X(6).
   701             20  PI-AR-MONTH-END-DT      PIC XX.
   702
   703         16  PI-MP-SYSTEM.
   704             20  PI-MORTGAGE-USER            PIC X.
   705                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   706                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   707             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   708                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   709                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   710                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   711                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   712                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   713             20  PI-MP-MONTH-END-DT          PIC XX.
   714             20  PI-MP-REFERENCE-NO.
   715                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   716                 24  PI-MP-REFERENCE-SFX     PIC XX.
   717
   718         16  PI-LABEL-CONTROL            PIC X(01).
   719             88  PI-CREATE-LABELS                    VALUE 'Y'.
   720             88  PI-BYPASS-LABELS                    VALUE 'N'.
   721
   722         16  PI-BILL-GROUPING-CODE       PIC X(01).
   723             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   724
   725         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   726             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   727             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   728
   729         16  FILLER                      PIC X(14).
   730
   731     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   732******************************************************************
   733     12  PI-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
   734         16  PI-FILE-ID                    PIC XX.
   735         16  FILLER                        PIC X(638).
   736
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL605.cbl
   738*                            COPY ELCAID.
   739******************************************************************
   740*                                                                *
   741*                            ELCAID.                             *
   742*                            VMOD=2.001                          *
   743*                                                                *
   744*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   745*                                                                *
   746*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   747*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   748******************************************************************
   749
   750 01  DFHAID.
   751   02  DFHNULL   PIC  X  VALUE  ' '.
   752   02  DFHENTER  PIC  X  VALUE  QUOTE.
   753   02  DFHCLEAR  PIC  X  VALUE  '_'.
   754   02  DFHPEN    PIC  X  VALUE  '='.
   755   02  DFHOPID   PIC  X  VALUE  'W'.
   756   02  DFHPA1    PIC  X  VALUE  '%'.
   757   02  DFHPA2    PIC  X  VALUE  '>'.
   758   02  DFHPA3    PIC  X  VALUE  ','.
   759   02  DFHPF1    PIC  X  VALUE  '1'.
   760   02  DFHPF2    PIC  X  VALUE  '2'.
   761   02  DFHPF3    PIC  X  VALUE  '3'.
   762   02  DFHPF4    PIC  X  VALUE  '4'.
   763   02  DFHPF5    PIC  X  VALUE  '5'.
   764   02  DFHPF6    PIC  X  VALUE  '6'.
   765   02  DFHPF7    PIC  X  VALUE  '7'.
   766   02  DFHPF8    PIC  X  VALUE  '8'.
   767   02  DFHPF9    PIC  X  VALUE  '9'.
   768   02  DFHPF10   PIC  X  VALUE  ':'.
   769   02  DFHPF11   PIC  X  VALUE  '#'.
   770   02  DFHPF12   PIC  X  VALUE  '@'.
   771   02  DFHPF13   PIC  X  VALUE  'A'.
   772   02  DFHPF14   PIC  X  VALUE  'B'.
   773   02  DFHPF15   PIC  X  VALUE  'C'.
   774   02  DFHPF16   PIC  X  VALUE  'D'.
   775   02  DFHPF17   PIC  X  VALUE  'E'.
   776   02  DFHPF18   PIC  X  VALUE  'F'.
   777   02  DFHPF19   PIC  X  VALUE  'G'.
   778   02  DFHPF20   PIC  X  VALUE  'H'.
   779   02  DFHPF21   PIC  X  VALUE  'I'.
   780*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   781   02  DFHPF22   PIC  X  VALUE  '['.
   782   02  DFHPF23   PIC  X  VALUE  '.'.
   783   02  DFHPF24   PIC  X  VALUE  '<'.
   784   02  DFHMSRE   PIC  X  VALUE  'X'.
   785   02  DFHSTRF   PIC  X  VALUE  'h'.
   786   02  DFHTRIG   PIC  X  VALUE  '"'.
   787 01  FILLER    REDEFINES DFHAID.
   788     12  FILLER              PIC X(8).
   789     12  PF-VALUES           PIC X       OCCURS 2.
   790
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL605.cbl
   792*                            COPY EL605S.
   793 01  EL605AI.
   794     05  FILLER            PIC  X(0012).
   795*    -------------------------------
   796     05  DATEL PIC S9(0004) COMP.
   797     05  DATEF PIC  X(0001).
   798     05  FILLER REDEFINES DATEF.
   799         10  DATEA PIC  X(0001).
   800     05  DATEI PIC  X(0008).
   801*    -------------------------------
   802     05  TIMEL PIC S9(0004) COMP.
   803     05  TIMEF PIC  X(0001).
   804     05  FILLER REDEFINES TIMEF.
   805         10  TIMEA PIC  X(0001).
   806     05  TIMEI PIC  X(0005).
   807*    -------------------------------
   808     05  ERRMSGL PIC S9(0004) COMP.
   809     05  ERRMSGF PIC  X(0001).
   810     05  FILLER REDEFINES ERRMSGF.
   811         10  ERRMSGA PIC  X(0001).
   812     05  ERRMSGI PIC  X(0079).
   813*    -------------------------------
   814     05  SELECTL PIC S9(0004) COMP.
   815     05  SELECTF PIC  X(0001).
   816     05  FILLER REDEFINES SELECTF.
   817         10  SELECTA PIC  X(0001).
   818     05  SELECTI PIC  X(0002).
   819*    -------------------------------
   820     05  PROGL PIC S9(0004) COMP.
   821     05  PROGF PIC  X(0001).
   822     05  FILLER REDEFINES PROGF.
   823         10  PROGA PIC  X(0001).
   824     05  PROGI PIC  X(0008).
   825*    -------------------------------
   826     05  PFKEYL PIC S9(0004) COMP.
   827     05  PFKEYF PIC  X(0001).
   828     05  FILLER REDEFINES PFKEYF.
   829         10  PFKEYA PIC  X(0001).
   830     05  PFKEYI PIC  X(0002).
   831 01  EL605AO REDEFINES EL605AI.
   832     05  FILLER            PIC  X(0012).
   833*    -------------------------------
   834     05  FILLER            PIC  X(0003).
   835     05  DATEO PIC  X(0008).
   836*    -------------------------------
   837     05  FILLER            PIC  X(0003).
   838     05  TIMEO PIC  99.99.
   839*    -------------------------------
   840     05  FILLER            PIC  X(0003).
   841     05  ERRMSGO PIC  X(0079).
   842*    -------------------------------
   843     05  FILLER            PIC  X(0003).
   844     05  SELECTO PIC  X(0002).
   845*    -------------------------------
   846     05  FILLER            PIC  X(0003).
   847     05  PROGO PIC  X(0008).
   848*    -------------------------------
   849     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL605.cbl
   850     05  PFKEYO PIC  X(0002).
   851*    -------------------------------
   852
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL605.cbl
   854****************************************************************
   855*
   856* Copyright (c) 2007 by Clerity Solutions, Inc.
   857* All rights reserved.
   858*
   859****************************************************************
   860 01  DFHEIV.
   861   02  DFHEIV0               PIC X(35).
   862   02  DFHEIV1               PIC X(08).
   863   02  DFHEIV2               PIC X(08).
   864   02  DFHEIV3               PIC X(08).
   865   02  DFHEIV4               PIC X(06).
   866   02  DFHEIV5               PIC X(04).
   867   02  DFHEIV6               PIC X(04).
   868   02  DFHEIV7               PIC X(02).
   869   02  DFHEIV8               PIC X(02).
   870   02  DFHEIV9               PIC X(01).
   871   02  DFHEIV10              PIC S9(7) COMP-3.
   872   02  DFHEIV11              PIC S9(4) COMP SYNC.
   873   02  DFHEIV12              PIC S9(4) COMP SYNC.
   874   02  DFHEIV13              PIC S9(4) COMP SYNC.
   875   02  DFHEIV14              PIC S9(4) COMP SYNC.
   876   02  DFHEIV15              PIC S9(4) COMP SYNC.
   877   02  DFHEIV16              PIC S9(9) COMP SYNC.
   878   02  DFHEIV17              PIC X(04).
   879   02  DFHEIV18              PIC X(04).
   880   02  DFHEIV19              PIC X(04).
   881   02  DFHEIV20              USAGE IS POINTER.
   882   02  DFHEIV21              USAGE IS POINTER.
   883   02  DFHEIV22              USAGE IS POINTER.
   884   02  DFHEIV23              USAGE IS POINTER.
   885   02  DFHEIV24              USAGE IS POINTER.
   886   02  DFHEIV25              PIC S9(9) COMP SYNC.
   887   02  DFHEIV26              PIC S9(9) COMP SYNC.
   888   02  DFHEIV27              PIC S9(9) COMP SYNC.
   889   02  DFHEIV28              PIC S9(9) COMP SYNC.
   890   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   891   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   892   02  FILLER                PIC X(02).
   893   02  DFHEIV99              PIC X(08) VALUE SPACE.
   894   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   895   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   896   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   897   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   898 LINKAGE  SECTION.
   899*****************************************************************
   900*                                                               *
   901* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   902* All rights reserved.                                          *
   903*                                                               *
   904*****************************************************************
   905 01  dfheiblk.
   906     02  eibtime          pic s9(7) comp-3.
   907     02  eibdate          pic s9(7) comp-3.
   908     02  eibtrnid         pic x(4).
   909     02  eibtaskn         pic s9(7) comp-3.
   910     02  eibtrmid         pic x(4).
   911     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL605.cbl
   912     02  eibcposn         pic s9(4) comp.
   913     02  eibcalen         pic s9(4) comp.
   914     02  eibaid           pic x(1).
   915     02  eibfiller1       pic x(1).
   916     02  eibfn            pic x(2).
   917     02  eibfiller2       pic x(2).
   918     02  eibrcode         pic x(6).
   919     02  eibfiller3       pic x(2).
   920     02  eibds            pic x(8).
   921     02  eibreqid         pic x(8).
   922     02  eibrsrce         pic x(8).
   923     02  eibsync          pic x(1).
   924     02  eibfree          pic x(1).
   925     02  eibrecv          pic x(1).
   926     02  eibsend          pic x(1).
   927     02  eibatt           pic x(1).
   928     02  eibeoc           pic x(1).
   929     02  eibfmh           pic x(1).
   930     02  eibcompl         pic x(1).
   931     02  eibsig           pic x(1).
   932     02  eibconf          pic x(1).
   933     02  eiberr           pic x(1).
   934     02  eibrldbk         pic x(1).
   935     02  eiberrcd         pic x(4).
   936     02  eibsynrb         pic x(1).
   937     02  eibnodat         pic x(1).
   938     02  eibfiller5       pic x(2).
   939     02  eibresp          pic 9(09) comp.
   940     02  eibresp2         pic 9(09) comp.
   941     02  dfheigdj         pic s9(4) comp.
   942     02  dfheigdk         pic s9(4) comp.
   943 01  DFHCOMMAREA             PIC X(1024).
   944
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL605.cbl
   946 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
   947 0000-DFHEXIT SECTION.
   948     MOVE '9#                    $   ' TO DFHEIV0.
   949     MOVE 'EL605' TO DFHEIV1.
   950     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   951
   952     MOVE DFHCOMMAREA   TO PROGRAM-INTERFACE-BLOCK.
   953
   954     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
   955     MOVE '5'                    TO DC-OPTION-CODE.
   956     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
   957     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
   958     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
   959
   960     IF EIBCALEN = 0
   961         GO TO 8800-UNAUTHORIZED-ACCESS.
   962
   963     IF PI-CALLING-PROGRAM NOT = PGM-EL605
   964         IF PI-RETURN-TO-PROGRAM NOT = PGM-EL605
   965             MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6
   966             MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5
   967             MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4
   968             MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3
   969             MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2
   970             MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1
   971             MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM
   972             MOVE PGM-EL605              TO PI-CALLING-PROGRAM
   973         ELSE
   974             MOVE PI-RETURN-TO-PROGRAM   TO PI-CALLING-PROGRAM
   975             MOVE PI-SAVED-PROGRAM-1     TO PI-RETURN-TO-PROGRAM
   976             MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-1
   977             MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-2
   978             MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-3
   979             MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-4
   980             MOVE PI-SAVED-PROGRAM-6     TO PI-SAVED-PROGRAM-5
   981             MOVE SPACES                 TO PI-SAVED-PROGRAM-6.
   982
   983
   984* EXEC CICS HANDLE CONDITION
   985*        PGMIDERR  (9600-PGMID-ERROR)
   986*        ERROR     (9990-ABEND)
   987*    END-EXEC.
   988*    MOVE '"$L.                  ! " #00000979' TO DFHEIV0
   989     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
   990     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
   991     MOVE X'2220233030303030393739' TO DFHEIV0(25:11)
   992     CALL 'kxdfhei1' USING DFHEIV0
   993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   994
   995
   996     IF EIBTRNID  = TRANS-EXAA
   997         GO TO 0100-SAME-TRAN.
   998
   999     GO TO 8100-SEND-INITIAL-MAP.
  1000
  1001 0100-SAME-TRAN.
  1002     IF EIBAID = DFHCLEAR
  1003         GO TO 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL605.cbl
  1004
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL605.cbl
  1006 0200-RECEIVE.
  1007     MOVE LOW-VALUES   TO EL605AI.
  1008
  1009     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1010         MOVE -1                 TO SELECTL
  1011         MOVE ER-7008         TO EMI-ERROR
  1012         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1013         GO TO 8200-SEND-DATAONLY.
  1014
  1015
  1016* EXEC CICS RECEIVE
  1017*        MAP      (MAP-EL605A)
  1018*        MAPSET   (MAPSET-EL605S)
  1019*        INTO     (EL605AI)
  1020*    END-EXEC.
  1021     MOVE LENGTH OF
  1022      EL605AI
  1023       TO DFHEIV11
  1024*    MOVE '8"T I  L              ''   #00001003' TO DFHEIV0
  1025     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1026     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1027     MOVE X'2020233030303031303033' TO DFHEIV0(25:11)
  1028     CALL 'kxdfhei1' USING DFHEIV0,
  1029           MAP-EL605A,
  1030           EL605AI,
  1031           DFHEIV11,
  1032           MAPSET-EL605S,
  1033           DFHEIV99,
  1034           DFHEIV99
  1035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1036
  1037
  1038     MOVE SPACES                 TO PI-ENTRY-CD-1.
  1039
  1040     IF EIBAID = DFHPF12
  1041        GO TO 9500-HELP
  1042     ELSE
  1043        IF EIBAID = DFHPF23
  1044           GO TO 8810-PF23
  1045        ELSE
  1046           IF EIBAID = DFHPF24
  1047              GO TO 9200-PF24.
  1048
  1049     IF PFKEYL = ZEROS
  1050         NEXT SENTENCE
  1051     ELSE
  1052         IF PFKEYI = '12'
  1053            GO TO 9500-HELP
  1054         ELSE
  1055            IF PFKEYI = '23'
  1056               GO TO 8810-PF23
  1057            ELSE
  1058               IF PFKEYI = '24'
  1059                  GO TO 9200-PF24.
  1060
  1061     IF EIBAID NOT = DFHENTER
  1062         MOVE ER-0002         TO EMI-ERROR
  1063         GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL605.cbl
  1064
  1065     IF SELECTL = 0
  1066         MOVE ER-0002         TO EMI-ERROR
  1067         GO TO 0320-INPUT-ERROR.
  1068
  1069 0310-CHECK-PFKEYS.
  1070     IF SELECTI = '01'
  1071         MOVE XCTL-EL606 TO PGM-NAME
  1072         GO TO 9300-XCTL.
  1073
  1074     IF SELECTI = '02'
  1075         MOVE XCTL-EL607 TO PGM-NAME
  1076         GO TO 9300-XCTL.
  1077
  1078     IF SELECTI = '03'
  1079         MOVE XCTL-EL608 TO PGM-NAME
  1080         GO TO 9300-XCTL.
  1081
  1082     IF SELECTI = '04'
  1083         MOVE XCTL-EL609 TO PGM-NAME
  1084         GO TO 9300-XCTL.
  1085
  1086     IF SELECTI = '05'
  1087         MOVE XCTL-EL612 TO PGM-NAME
  1088         GO TO 9300-XCTL.
  1089
  1090     MOVE ER-7002                TO EMI-ERROR.
  1091
  1092 0320-INPUT-ERROR.
  1093     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1094     MOVE AL-UNBON               TO SELECTA.
  1095     MOVE -1                     TO SELECTL.
  1096     GO TO 8200-SEND-DATAONLY.
  1097
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL605.cbl
  1099 8100-SEND-INITIAL-MAP.
  1100     MOVE LOW-VALUES             TO EL605AO.
  1101     MOVE EIBTIME                TO TIME-IN.
  1102     MOVE TIME-OUT               TO TIMEO.
  1103     MOVE SAVE-DATE              TO DATEO.
  1104
  1105     MOVE -1                     TO SELECTL.
  1106
  1107
  1108* EXEC CICS SEND
  1109*        MAP     (MAP-EL605A)
  1110*        MAPSET  (MAPSET-EL605S)
  1111*        FROM    (EL605AO)
  1112*        ERASE
  1113*        CURSOR
  1114*    END-EXEC.
  1115     MOVE LENGTH OF
  1116      EL605AO
  1117       TO DFHEIV12
  1118     MOVE -1
  1119       TO DFHEIV11
  1120*    MOVE '8$     CT  E    H L F ,   #00001078' TO DFHEIV0
  1121     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1122     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1123     MOVE X'2020233030303031303738' TO DFHEIV0(25:11)
  1124     CALL 'kxdfhei1' USING DFHEIV0,
  1125           MAP-EL605A,
  1126           EL605AO,
  1127           DFHEIV12,
  1128           MAPSET-EL605S,
  1129           DFHEIV99,
  1130           DFHEIV99,
  1131           DFHEIV99,
  1132           DFHEIV11,
  1133           DFHEIV99,
  1134           DFHEIV99,
  1135           DFHEIV99
  1136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1137
  1138
  1139     GO TO 9100-RETURN-TRAN.
  1140
  1141 8200-SEND-DATAONLY.
  1142     MOVE SAVE-DATE              TO DATEO.
  1143     MOVE EIBTIME                TO TIME-IN.
  1144     MOVE TIME-OUT               TO TIMEO.
  1145     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  1146
  1147
  1148* EXEC CICS SEND
  1149*        MAP      (MAP-EL605A)
  1150*        MAPSET   (MAPSET-EL605S)
  1151*        FROM     (EL605AO)
  1152*        DATAONLY
  1153*        CURSOR
  1154*    END-EXEC.
  1155     MOVE LENGTH OF
  1156      EL605AO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL605.cbl
  1157       TO DFHEIV12
  1158     MOVE -1
  1159       TO DFHEIV11
  1160*    MOVE '8$D    CT       H L F ,   #00001094' TO DFHEIV0
  1161     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  1162     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1163     MOVE X'2020233030303031303934' TO DFHEIV0(25:11)
  1164     CALL 'kxdfhei1' USING DFHEIV0,
  1165           MAP-EL605A,
  1166           EL605AO,
  1167           DFHEIV12,
  1168           MAPSET-EL605S,
  1169           DFHEIV99,
  1170           DFHEIV99,
  1171           DFHEIV99,
  1172           DFHEIV11,
  1173           DFHEIV99,
  1174           DFHEIV99,
  1175           DFHEIV99
  1176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1177
  1178
  1179     GO TO 9100-RETURN-TRAN.
  1180
  1181 8300-SEND-TEXT.
  1182
  1183* EXEC CICS SEND TEXT
  1184*        FROM     (LOGOFF-TEXT)
  1185*        LENGTH   (LOGOFF-LENGTH)
  1186*        ERASE
  1187*        FREEKB
  1188*    END-EXEC.
  1189*    MOVE '8&      T  E F  H   F -   #00001105' TO DFHEIV0
  1190     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  1191     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  1192     MOVE X'2020233030303031313035' TO DFHEIV0(25:11)
  1193     CALL 'kxdfhei1' USING DFHEIV0,
  1194           LOGOFF-TEXT,
  1195           LOGOFF-LENGTH,
  1196           DFHEIV99,
  1197           DFHEIV99,
  1198           DFHEIV99,
  1199           DFHEIV99,
  1200           DFHEIV99,
  1201           DFHEIV99,
  1202           DFHEIV99,
  1203           DFHEIV99,
  1204           DFHEIV99,
  1205           DFHEIV99
  1206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1207
  1208
  1209
  1210* EXEC CICS RETURN
  1211*    END-EXEC.
  1212*    MOVE '.(                    &   #00001112' TO DFHEIV0
  1213     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1214     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL605.cbl
  1215     MOVE X'2020233030303031313132' TO DFHEIV0(25:11)
  1216     CALL 'kxdfhei1' USING DFHEIV0,
  1217           DFHEIV99,
  1218           DFHEIV99,
  1219           DFHEIV99,
  1220           DFHEIV99,
  1221           DFHEIV99
  1222     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1223
  1224
  1225 8800-UNAUTHORIZED-ACCESS.
  1226     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  1227     GO TO 8300-SEND-TEXT.
  1228
  1229 8810-PF23.
  1230     MOVE DFHPF23                TO PI-ENTRY-CD-1.
  1231     MOVE XCTL-EL005             TO PGM-NAME.
  1232     GO TO 9300-XCTL.
  1233
  1234 9100-RETURN-TRAN.
  1235     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  1236     MOVE '605A'                 TO PI-CURRENT-SCREEN-NO.
  1237
  1238
  1239* EXEC CICS RETURN
  1240*        TRANSID   (TRANS-EXAA)
  1241*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  1242*        LENGTH    (PI-COMM-LENGTH)
  1243*    END-EXEC.
  1244*    MOVE '.(CT                  &   #00001128' TO DFHEIV0
  1245     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1246     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1247     MOVE X'2020233030303031313238' TO DFHEIV0(25:11)
  1248     CALL 'kxdfhei1' USING DFHEIV0,
  1249           TRANS-EXAA,
  1250           PROGRAM-INTERFACE-BLOCK,
  1251           PI-COMM-LENGTH,
  1252           DFHEIV99,
  1253           DFHEIV99
  1254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1255
  1256
  1257 9200-PF24.
  1258     MOVE XCTL-EL626             TO PGM-NAME.
  1259     GO TO 9300-XCTL.
  1260
  1261 9300-XCTL.
  1262     MOVE SPACES                 TO PI-ENTRY-CD-2
  1263                                    PI-RETURN-CODES
  1264                                    PI-UPDATE-BY
  1265                                    PI-PROGRAM-WORK-AREA.
  1266     MOVE ZEROS                  TO PI-UPDATE-HHMMSS.
  1267
  1268
  1269* EXEC CICS XCTL
  1270*        PROGRAM    (PGM-NAME)
  1271*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  1272*        LENGTH     (PI-COMM-LENGTH)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL605.cbl
  1273*    END-EXEC.
  1274*    MOVE '.$C                   $   #00001145' TO DFHEIV0
  1275     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  1276     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1277     MOVE X'2020233030303031313435' TO DFHEIV0(25:11)
  1278     CALL 'kxdfhei1' USING DFHEIV0,
  1279           PGM-NAME,
  1280           PROGRAM-INTERFACE-BLOCK,
  1281           PI-COMM-LENGTH
  1282     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1283
  1284
  1285 9400-CLEAR.
  1286     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  1287     GO TO 9300-XCTL.
  1288
  1289 9500-HELP.
  1290     MOVE XCTL-EL010             TO PGM-NAME.
  1291     GO TO 9300-XCTL.
  1292
  1293 9600-PGMID-ERROR.
  1294     MOVE PGM-NAME               TO PROGO.
  1295     MOVE AL-UNBON               TO SELECTA.
  1296     MOVE ER-7003                TO EMI-ERROR.
  1297
  1298
  1299* EXEC CICS HANDLE CONDITION
  1300*        PGMIDERR  (8300-SEND-TEXT)
  1301*    END-EXEC.
  1302*    MOVE '"$L                   ! # #00001164' TO DFHEIV0
  1303     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  1304     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1305     MOVE X'2320233030303031313634' TO DFHEIV0(25:11)
  1306     CALL 'kxdfhei1' USING DFHEIV0
  1307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1308
  1309
  1310     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  1311     MOVE ' '                    TO PI-ENTRY-CD-1.
  1312     MOVE XCTL-EL005             TO PGM-NAME.
  1313     MOVE PGM-NAME               TO LOGOFF-PGM.
  1314     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  1315     GO TO 9300-XCTL.
  1316
  1317 9700-LINK-DATE-CONVERT.
  1318
  1319* EXEC CICS LINK
  1320*        PROGRAM    (LINK-ELDATCV)
  1321*        COMMAREA   (DATE-CONVERSION-DATA)
  1322*        LENGTH     (DC-COMM-LENGTH)
  1323*    END-EXEC.
  1324*    MOVE '."C                   ''   #00001176' TO DFHEIV0
  1325     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1326     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1327     MOVE X'2020233030303031313736' TO DFHEIV0(25:11)
  1328     CALL 'kxdfhei1' USING DFHEIV0,
  1329           LINK-ELDATCV,
  1330           DATE-CONVERSION-DATA,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL605.cbl
  1331           DC-COMM-LENGTH,
  1332           DFHEIV99,
  1333           DFHEIV99,
  1334           DFHEIV99
  1335     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1336
  1337
  1338 9700-EXIT.
  1339     EXIT.
  1340
  1341 9900-ERROR-FORMAT.
  1342     IF NOT EMI-ERRORS-COMPLETE
  1343         MOVE LINK-EL001         TO PGM-NAME
  1344
  1345* EXEC CICS LINK
  1346*            PROGRAM    (PGM-NAME)
  1347*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  1348*            LENGTH     (EMI-COMM-LENGTH)
  1349*        END-EXEC.
  1350*    MOVE '."C                   ''   #00001188' TO DFHEIV0
  1351     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1352     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1353     MOVE X'2020233030303031313838' TO DFHEIV0(25:11)
  1354     CALL 'kxdfhei1' USING DFHEIV0,
  1355           PGM-NAME,
  1356           ERROR-MESSAGE-INTERFACE-BLOCK,
  1357           EMI-COMM-LENGTH,
  1358           DFHEIV99,
  1359           DFHEIV99,
  1360           DFHEIV99
  1361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1362
  1363
  1364 9900-EXIT.
  1365     EXIT.
  1366
  1367 9990-ABEND.
  1368     MOVE LINK-EL004             TO PGM-NAME.
  1369     MOVE DFHEIBLK               TO EMI-LINE1.
  1370
  1371
  1372* EXEC CICS LINK
  1373*        PROGRAM   (PGM-NAME)
  1374*        COMMAREA  (EMI-LINE1)
  1375*        LENGTH    (72)
  1376*    END-EXEC.
  1377     MOVE 72
  1378       TO DFHEIV11
  1379*    MOVE '."C                   ''   #00001201' TO DFHEIV0
  1380     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1381     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1382     MOVE X'2020233030303031323031' TO DFHEIV0(25:11)
  1383     CALL 'kxdfhei1' USING DFHEIV0,
  1384           PGM-NAME,
  1385           EMI-LINE1,
  1386           DFHEIV11,
  1387           DFHEIV99,
  1388           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL605.cbl
  1389           DFHEIV99
  1390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1391
  1392
  1393     GO TO 8200-SEND-DATAONLY.
  1394
  1395
  1396 9999-DFHBACK SECTION.
  1397     MOVE '9%                    "   ' TO DFHEIV0
  1398     MOVE 'EL605' TO DFHEIV1
  1399     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1400     GOBACK.
  1401 9999-DFHEXIT.
  1402     IF DFHEIGDJ EQUAL 0001
  1403         NEXT SENTENCE
  1404     ELSE IF DFHEIGDJ EQUAL 2
  1405         GO TO 9600-PGMID-ERROR,
  1406               9990-ABEND
  1407         DEPENDING ON DFHEIGDI
  1408     ELSE IF DFHEIGDJ EQUAL 3
  1409         GO TO 8300-SEND-TEXT
  1410         DEPENDING ON DFHEIGDI.
  1411     MOVE '9%                    "   ' TO DFHEIV0
  1412     MOVE 'EL605' TO DFHEIV1
  1413     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1414     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3532     Code:        2683
