* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6526.cbl
* Options: int("EL6526.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6526.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6526.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6526.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID. EL6526.
     3*AUTHOR.     PABLO.
     4*            COLLEYVILLE, TEXAS.
     5*DATE-COMPILED.
     6*SECURITY.   *****************************************************
     7*            *                                                   *
     8*            *   THIS PROGRAM IS THE PROPERTY OF CSO.            *
     9*            *                                                   *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*                                                                *
    12*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6526.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*
    17*REMARKS.  TRANSACTION - EXDG - RDS EMAIL ADDRESS DISPLAY ONLY
    18*
    19******************************************************************
    20*                   C H A N G E   L O G
    21*
    22* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    23*-----------------------------------------------------------------
    24*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    25* EFFECTIVE    NUMBER
    26*-----------------------------------------------------------------
    27* 022211    2010012100001  PEMA  NEW PROGRAM
    28******************************************************************
    29 ENVIRONMENT DIVISION.
    30 DATA DIVISION.
    31 WORKING-STORAGE SECTION.
    32 01  DFH-START PIC X(04).
    33 77  FILLER  PIC X(32)  VALUE '********************************'.
    34 77  FILLER  PIC X(32)  VALUE '*    EL6526 WORKING STORAGE    *'.
    35 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    36 01  WS-DATE-AREA.
    37     05  WS-SAVE-DATE                PIC X(8) VALUE SPACES.
    38     05  WS-SAVE-BIN-DT              PIC XX   VALUE SPACES.
    39     05  WS-EFF-YMD                  PIC X(6).
    40     05  WS-TRM-YMD                  PIC X(6).
    41     05  SUPPRESS-MAP-SW             PIC X    VALUE SPACE.
    42         88  DO-NOT-MOVE-TO-MAP          VALUE 'N'.
    43         88  MOVE-TO-MAP                 VALUE 'Y'.
    44     05  MAP-CHANGED-SW              PIC X    VALUE 'N'.
    45         88  MAP-NOT-CHANGED             VALUE 'N'.
    46         88  MAP-CHANGED                 VALUE 'Y'.
    47     05  BILL-INST-SW                PIC X.
    48         88  BILL-INST-CHANGED           VALUE 'Y'.
    49 01  WS-RESPONSE                 PIC S9(8)   COMP.
    50     88  RESP-NORMAL                  VALUE +00.
    51     88  RESP-NOTFND                  VALUE +13.
    52     88  RESP-NOTOPEN                 VALUE +19.
    53     88  RESP-ENDFILE                 VALUE +20.
    54 01  EADR-KEY.
    55     05  EADR-COMPANY-CD                   PIC X.
    56     05  EADR-REC-TYPE                     PIC XX.
    57     05  EADR-ERCOMP-KEY.
    58         10  EADR-CARRIER                  PIC X.
    59         10  EADR-GROUPING                 PIC X(6).
    60         10  EADR-FIN-RESP                 PIC X(10).
    61         10  EADR-ACCOUNT                  PIC X(10).
    62         10  EADR-TYPE                     PIC X.
    63         10  FILLER                        PIC X(17).
    64 01  STANDARD-AREAS.
    65     12  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1024.
    66     12  WS-SUB                      PIC S9(4) COMP VALUE +0.
    67     12  MAP-NAME                    PIC X(8) VALUE 'EL6526A'.
    68     12  MAPSET-NAME                 PIC X(8) VALUE 'EL6526S'.
    69     12  SCREEN-NUMBER               PIC X(4) VALUE '652G'.
    70     12  TRANS-ID                    PIC X(4) VALUE 'EXDG'.
    71     12  EL611-TRANS-ID              PIC X(4) VALUE 'EXL3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6526.cbl
    72     12  THIS-PGM                    PIC X(8) VALUE 'EL6526'.
    73     12  PGM-NAME                    PIC X(8).
    74     12  TIME-IN                     PIC S9(7).
    75     12  TIME-OUT-R  REDEFINES TIME-IN.
    76         16  FILLER                  PIC X.
    77         16  TIME-OUT                PIC 99V99.
    78         16  FILLER                  PIC XX.
    79     12  XCTL-005                    PIC X(8) VALUE 'EL005'.
    80     12  XCTL-010                    PIC X(8) VALUE 'EL010'.
    81     12  XCTL-626                    PIC X(8) VALUE 'EL626'.
    82     12  XCTL-611                    PIC X(8) VALUE 'EL611'.
    83     12  XCTL-652                    PIC X(8) VALUE 'EL652'.
    84     12  LINK-001                    PIC X(8) VALUE 'EL001'.
    85     12  LINK-004                    PIC X(8) VALUE 'EL004'.
    86     12  QID.
    87         16  QID-TERM                PIC X(4) VALUE SPACES.
    88         16  FILLER                  PIC X(4) VALUE '526A'.
    89     12  MAP-LENGTH                  PIC S9(4) VALUE +600  COMP.
    90     12  EREADR-FILE-ID              PIC X(8) VALUE 'EREADR'.
    91     12  ERCOMP-FILE-ID              PIC X(8) VALUE 'ERCOMP'.
    92     12  DEEDIT-FIELD                PIC X(15).
    93     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD PIC S9(15).
    94     12  WS-BILL-INST-SW            PIC X  VALUE SPACES.
    95         88  BILLING-INSTRUCTIONS-FOUND  VALUE 'Y'.
    96     12  ERROR-MESSAGES.
    97         16  ER-0000                 PIC X(4) VALUE '0000'.
    98         16  ER-0004                 PIC X(4) VALUE '0004'.
    99         16  ER-0008                 PIC X(4) VALUE '0008'.
   100         16  ER-0029                 PIC X(4) VALUE '0029'.
   101         16  ER-0068                 PIC X(4) VALUE '0068'.
   102         16  ER-0070                 PIC X(4) VALUE '0070'.
   103         16  ER-0348                 PIC X(4) VALUE '0348'.
   104         16  ER-0454                 PIC X(4) VALUE '0454'.
   105         16  ER-0876                 PIC X(4) VALUE '0876'.
   106         16  ER-1228                 PIC X(4) VALUE '1228'.
   107         16  ER-1626                 PIC X(4) VALUE '1626'.
   108         16  ER-1629                 PIC X(4) VALUE '1629'.
   109         16  ER-2039                 PIC X(4) VALUE '2039'.
   110         16  ER-2056                 PIC X(4) VALUE '2056'.
   111         16  ER-2057                 PIC X(4) VALUE '2057'.
   112         16  ER-2233                 PIC X(4) VALUE '2233'.
   113         16  ER-7430                 PIC X(4) VALUE '7430'.
   114         16  ER-7431                 PIC X(4) VALUE '7431'.
   115         16  ER-7432                 PIC X(4) VALUE '7432'.
   116         16  ER-7434                 PIC X(4) VALUE '7434'.
   117         16  ER-7435                 PIC X(4) VALUE '7435'.
   118         16  ER-7436                 PIC X(4) VALUE '7436'.
   119         16  ER-7438                 PIC X(4) VALUE '7438'.
   120         16  ER-7440                 PIC X(4) VALUE '7440'.
   121         16  ER-7447                 PIC X(4) VALUE '7447'.
   122         16  ER-7449                 PIC X(4) VALUE '7449'.
   123         16  ER-7462                 PIC X(4) VALUE '7462'.
   124         16  ER-7465                 PIC X(4) VALUE '7465'.
   125         16  ER-7468                 PIC X(4) VALUE '7468'.
   126         16  ER-7469                 PIC X(4) VALUE '7469'.
   127         16  ER-8799                 PIC X(4) VALUE '8799'.
   128         16  ER-9388                 PIC X(4) VALUE '9388'.
   129         16  ER-9399                 PIC X(4) VALUE '9399'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6526.cbl
   130         16  ER-9999                 PIC X(4) VALUE '9999'.
   131     12  ELCNTL-KEY.
   132         16  CNTL-COMP-ID            PIC X(3) VALUE SPACES.
   133         16  CNTL-REC-TYPE           PIC X    VALUE SPACES.
   134         16  CNTL-ACCESS             PIC X(4) VALUE SPACES.
   135         16  CNTL-SEQ-NO             PIC S9(4) VALUE +0  COMP.
   136*    COPY ELCLOGOF.
   137******************************************************************
   138*                                                                *
   139*                                                                *
   140*                            ELCLOGOF.                           *
   141*                            VMOD=2.001                          *
   142*                                                                *
   143*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   144*                                                                *
   145******************************************************************
   146 01  CLASIC-LOGOFF.
   147     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   148     12  LOGOFF-TEXT.
   149         16  FILLER          PIC X(5)    VALUE SPACES.
   150         16  LOGOFF-MSG.
   151             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   152             20  FILLER      PIC X       VALUE SPACES.
   153             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   154         16  FILLER          PIC X(80)
   155           VALUE '* YOU ARE NOW LOGGED OFF'.
   156         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   157         16  FILLER          PIC X       VALUE QUOTE.
   158         16  LOGOFF-SYS-MSG  PIC X(17)
   159           VALUE 'S CLAS-IC SYSTEM '.
   160     12  TEXT-MESSAGES.
   161         16  UNACCESS-MSG    PIC X(29)
   162             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   163         16  PGMIDERR-MSG    PIC X(17)
   164             VALUE 'PROGRAM NOT FOUND'.
   165*    COPY ELCDATE.
   166******************************************************************
   167*                                                                *
   168*                                                                *
   169*                            ELCDATE.                            *
   170*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   171*                            VMOD=2.003
   172*                                                                *
   173*                                                                *
   174*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   175*                 LENGTH = 200                                   *
   176******************************************************************
   177
   178 01  DATE-CONVERSION-DATA.
   179     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   180     12  DC-OPTION-CODE                PIC X.
   181         88  BIN-TO-GREG                VALUE ' '.
   182         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   183         88  EDIT-GREG-TO-BIN           VALUE '2'.
   184         88  YMD-GREG-TO-BIN            VALUE '3'.
   185         88  MDY-GREG-TO-BIN            VALUE '4'.
   186         88  JULIAN-TO-BIN              VALUE '5'.
   187         88  BIN-PLUS-ELAPSED           VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6526.cbl
   188         88  FIND-CENTURY               VALUE '7'.
   189         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   190         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   191         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   192         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   193         88  JULIAN-TO-BIN-3            VALUE 'C'.
   194         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   195         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   196         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   197         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   198         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   199         88  CHECK-LEAP-YEAR            VALUE 'H'.
   200         88  BIN-3-TO-GREG              VALUE 'I'.
   201         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   202         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   203         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   204         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   205         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   206         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   207         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   208         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   209         88  THREE-CHARACTER-BIN
   210                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   211         88  GREGORIAN-TO-BIN
   212                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   213         88  BIN-TO-GREGORIAN
   214                  VALUES ' ' '1' 'I' '8' 'G'.
   215         88  JULIAN-TO-BINARY
   216                  VALUES '5' 'C' 'E' 'F'.
   217     12  DC-ERROR-CODE                 PIC X.
   218         88  NO-CONVERSION-ERROR        VALUE ' '.
   219         88  DATE-CONVERSION-ERROR
   220                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   221         88  DATE-IS-ZERO               VALUE '1'.
   222         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   223         88  DATE-IS-INVALID            VALUE '3'.
   224         88  DATE1-GREATER-DATE2        VALUE '4'.
   225         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   226         88  DATE-INVALID-OPTION        VALUE '9'.
   227         88  INVALID-CENTURY            VALUE 'A'.
   228         88  ONLY-CENTURY               VALUE 'B'.
   229         88  ONLY-LEAP-YEAR             VALUE 'C'.
   230         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   231     12  DC-END-OF-MONTH               PIC X.
   232         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   233     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   234         88  USE-NORMAL-PROCESS         VALUE ' '.
   235         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   236         88  ADJUST-UP-100-YRS          VALUE '2'.
   237     12  FILLER                        PIC X.
   238     12  DC-CONVERSION-DATES.
   239         16  DC-BIN-DATE-1             PIC XX.
   240         16  DC-BIN-DATE-2             PIC XX.
   241         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   242         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   243                       DC-GREG-DATE-1-EDIT.
   244             20  DC-EDIT1-MONTH        PIC 99.
   245             20  SLASH1-1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6526.cbl
   246             20  DC-EDIT1-DAY          PIC 99.
   247             20  SLASH1-2              PIC X.
   248             20  DC-EDIT1-YEAR         PIC 99.
   249         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   250         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   251                     DC-GREG-DATE-2-EDIT.
   252             20  DC-EDIT2-MONTH        PIC 99.
   253             20  SLASH2-1              PIC X.
   254             20  DC-EDIT2-DAY          PIC 99.
   255             20  SLASH2-2              PIC X.
   256             20  DC-EDIT2-YEAR         PIC 99.
   257         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   258         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   259                     DC-GREG-DATE-1-YMD.
   260             20  DC-YMD-YEAR           PIC 99.
   261             20  DC-YMD-MONTH          PIC 99.
   262             20  DC-YMD-DAY            PIC 99.
   263         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   264         16  DC-GREG-DATE-1-MDY-R REDEFINES
   265                      DC-GREG-DATE-1-MDY.
   266             20  DC-MDY-MONTH          PIC 99.
   267             20  DC-MDY-DAY            PIC 99.
   268             20  DC-MDY-YEAR           PIC 99.
   269         16  DC-GREG-DATE-1-ALPHA.
   270             20  DC-ALPHA-MONTH        PIC X(10).
   271             20  DC-ALPHA-DAY          PIC 99.
   272             20  FILLER                PIC XX.
   273             20  DC-ALPHA-CENTURY.
   274                 24 DC-ALPHA-CEN-N     PIC 99.
   275             20  DC-ALPHA-YEAR         PIC 99.
   276         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   277         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   278         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   279         16  DC-JULIAN-DATE            PIC 9(05).
   280         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   281                                       PIC 9(05).
   282         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   283             20  DC-JULIAN-YEAR        PIC 99.
   284             20  DC-JULIAN-DAYS        PIC 999.
   285         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   286         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   287         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   288     12  DATE-CONVERSION-VARIBLES.
   289         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   290         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   291             20  FILLER                PIC 9(3).
   292             20  HOLD-CEN-1-CCYY.
   293                 24  HOLD-CEN-1-CC     PIC 99.
   294                 24  HOLD-CEN-1-YY     PIC 99.
   295             20  HOLD-CEN-1-MO         PIC 99.
   296             20  HOLD-CEN-1-DA         PIC 99.
   297         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   298             20  HOLD-CEN-1-R-MO       PIC 99.
   299             20  HOLD-CEN-1-R-DA       PIC 99.
   300             20  HOLD-CEN-1-R-CCYY.
   301                 24  HOLD-CEN-1-R-CC   PIC 99.
   302                 24  HOLD-CEN-1-R-YY   PIC 99.
   303             20  FILLER                PIC 9(3).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6526.cbl
   304         16  HOLD-CENTURY-1-X.
   305             20  FILLER                PIC X(3)  VALUE SPACES.
   306             20  HOLD-CEN-1-X-CCYY.
   307                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   308                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   309             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   310             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   311         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   312             20  HOLD-CEN-1-R-X-MO     PIC XX.
   313             20  HOLD-CEN-1-R-X-DA     PIC XX.
   314             20  HOLD-CEN-1-R-X-CCYY.
   315                 24  HOLD-CEN-1-R-X-CC PIC XX.
   316                 24  HOLD-CEN-1-R-X-YY PIC XX.
   317             20  FILLER                PIC XXX.
   318         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   319         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   320         16  DC-JULIAN-DATE-1          PIC 9(07).
   321         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   322             20  DC-JULIAN-1-CCYY.
   323                 24  DC-JULIAN-1-CC    PIC 99.
   324                 24  DC-JULIAN-1-YR    PIC 99.
   325             20  DC-JULIAN-DA-1        PIC 999.
   326         16  DC-JULIAN-DATE-2          PIC 9(07).
   327         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   328             20  DC-JULIAN-2-CCYY.
   329                 24  DC-JULIAN-2-CC    PIC 99.
   330                 24  DC-JULIAN-2-YR    PIC 99.
   331             20  DC-JULIAN-DA-2        PIC 999.
   332         16  DC-GREG-DATE-A-EDIT.
   333             20  DC-EDITA-MONTH        PIC 99.
   334             20  SLASHA-1              PIC X VALUE '/'.
   335             20  DC-EDITA-DAY          PIC 99.
   336             20  SLASHA-2              PIC X VALUE '/'.
   337             20  DC-EDITA-CCYY.
   338                 24  DC-EDITA-CENT     PIC 99.
   339                 24  DC-EDITA-YEAR     PIC 99.
   340         16  DC-GREG-DATE-B-EDIT.
   341             20  DC-EDITB-MONTH        PIC 99.
   342             20  SLASHB-1              PIC X VALUE '/'.
   343             20  DC-EDITB-DAY          PIC 99.
   344             20  SLASHB-2              PIC X VALUE '/'.
   345             20  DC-EDITB-CCYY.
   346                 24  DC-EDITB-CENT     PIC 99.
   347                 24  DC-EDITB-YEAR     PIC 99.
   348         16  DC-GREG-DATE-CYMD         PIC 9(08).
   349         16  DC-GREG-DATE-CYMD-R REDEFINES
   350                              DC-GREG-DATE-CYMD.
   351             20  DC-CYMD-CEN           PIC 99.
   352             20  DC-CYMD-YEAR          PIC 99.
   353             20  DC-CYMD-MONTH         PIC 99.
   354             20  DC-CYMD-DAY           PIC 99.
   355         16  DC-GREG-DATE-MDCY         PIC 9(08).
   356         16  DC-GREG-DATE-MDCY-R REDEFINES
   357                              DC-GREG-DATE-MDCY.
   358             20  DC-MDCY-MONTH         PIC 99.
   359             20  DC-MDCY-DAY           PIC 99.
   360             20  DC-MDCY-CEN           PIC 99.
   361             20  DC-MDCY-YEAR          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6526.cbl
   362    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   363        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   364    12  DC-EL310-DATE                  PIC X(21).
   365    12  FILLER                         PIC X(28).
   366*    COPY ELCATTR.
   367******************************************************************
   368*                                                                *
   369*                            ELCATTR.                            *
   370*                            VMOD=2.001                          *
   371*                                                                *
   372*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   373*                                                                *
   374*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   375*                                                                *
   376*                   POS 1   P=PROTECTED                          *
   377*                           U=UNPROTECTED                        *
   378*                           S=ASKIP                              *
   379*                   POS 2   A=ALPHA/NUMERIC                      *
   380*                           N=NUMERIC                            *
   381*                   POS 3   N=NORMAL                             *
   382*                           B=BRIGHT                             *
   383*                           D=DARK                               *
   384*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   385*                           OF=MODIFIED DATA TAG OFF             *
   386*                                                                *
   387*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   388******************************************************************
   389 01  ATTRIBUTE-LIST.
   390     12  AL-PABOF            PIC X       VALUE 'Y'.
   391     12  AL-PABON            PIC X       VALUE 'Z'.
   392     12  AL-PADOF            PIC X       VALUE '%'.
   393     12  AL-PADON            PIC X       VALUE '_'.
   394     12  AL-PANOF            PIC X       VALUE '-'.
   395     12  AL-PANON            PIC X       VALUE '/'.
   396     12  AL-SABOF            PIC X       VALUE '8'.
   397     12  AL-SABON            PIC X       VALUE '9'.
   398     12  AL-SADOF            PIC X       VALUE '@'.
   399     12  AL-SADON            PIC X       VALUE QUOTE.
   400     12  AL-SANOF            PIC X       VALUE '0'.
   401     12  AL-SANON            PIC X       VALUE '1'.
   402     12  AL-UABOF            PIC X       VALUE 'H'.
   403     12  AL-UABON            PIC X       VALUE 'I'.
   404     12  AL-UADOF            PIC X       VALUE '<'.
   405     12  AL-UADON            PIC X       VALUE '('.
   406     12  AL-UANOF            PIC X       VALUE ' '.
   407     12  AL-UANON            PIC X       VALUE 'A'.
   408     12  AL-UNBOF            PIC X       VALUE 'Q'.
   409     12  AL-UNBON            PIC X       VALUE 'R'.
   410     12  AL-UNDOF            PIC X       VALUE '*'.
   411     12  AL-UNDON            PIC X       VALUE ')'.
   412     12  AL-UNNOF            PIC X       VALUE '&'.
   413     12  AL-UNNON            PIC X       VALUE 'J'.
   414*    COPY ELCEMIB.
   415******************************************************************
   416*                                                                *
   417*                                                                *
   418*                            ELCEMIB.                            *
   419*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6526.cbl
   420*                            VMOD=2.005                          *
   421*                                                                *
   422*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   423*                                                                *
   424******************************************************************
   425 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   426     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   427     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   428     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   429     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   430     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   431     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   432     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   433     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   434     12  EMI-SWITCH1             PIC X        VALUE '1'.
   435         88  EMI-NO-ERRORS                    VALUE '1'.
   436         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   437         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   438     12  EMI-SWITCH2             PIC X        VALUE '1'.
   439         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   440     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   441         88  EMI-AREA1-EMPTY                  VALUE '1'.
   442         88  EMI-AREA1-FULL                   VALUE '2'.
   443     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   444         88  EMI-AREA2-EMPTY                  VALUE '1'.
   445         88  EMI-AREA2-FULL                   VALUE '2'.
   446     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   447         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   448         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   449         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   450         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   451         88  EMI-BYPASS-FATALS                VALUE 'X'.
   452     12  EMI-ERROR-LINES.
   453         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   454         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   455         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   456         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   457             20  EMI-ERR-CODES OCCURS 10 TIMES.
   458                 24  EMI-ERR-NUM         PIC X(4).
   459                 24  EMI-FILLER          PIC X.
   460                 24  EMI-SEV             PIC X.
   461                 24  FILLER              PIC X.
   462             20  FILLER                  PIC X(02).
   463     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   464         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   465             20  EMI-ERROR-NUMBER    PIC X(4).
   466             20  EMI-FILL            PIC X.
   467             20  EMI-SEVERITY        PIC X.
   468             20  FILLER              PIC X.
   469             20  EMI-ERROR-TEXT.
   470                 24  EMI-TEXT-VARIABLE   PIC X(10).
   471                 24  FILLER          PIC X(55).
   472     12  EMI-SEVERITY-SAVE           PIC X.
   473         88  EMI-NOTE                    VALUE 'N'.
   474         88  EMI-WARNING                 VALUE 'W'.
   475         88  EMI-FORCABLE                VALUE 'F'.
   476         88  EMI-FATAL                   VALUE 'X'.
   477     12  EMI-MESSAGE-FLAG            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6526.cbl
   478         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   479         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   480     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   481     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   482         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   483         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   484         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   485     12  FILLER                      PIC X(137)  VALUE SPACES.
   486     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   487     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   488     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   489     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   490*    COPY ELCSCTM.
   491******************************************************************
   492*                                                                *
   493*                                                                *
   494*                            ELCSCTM                             *
   495*                            VMOD=2.001                          *
   496*                                                                *
   497*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   498*                                                                *
   499******************************************************************
   500 01  SECURITY-MESSAGE.
   501     12  FILLER                          PIC X(30)
   502            VALUE '** LOGIC SECURITY VIOLATION -'.
   503     12  SM-READ                         PIC X(6).
   504     12  FILLER                          PIC X(5)
   505            VALUE ' PGM='.
   506     12  SM-PGM                          PIC X(6).
   507     12  FILLER                          PIC X(5)
   508            VALUE ' OPR='.
   509     12  SM-PROCESSOR-ID                 PIC X(4).
   510     12  FILLER                          PIC X(6)
   511            VALUE ' TERM='.
   512     12  SM-TERMID                       PIC X(4).
   513     12  FILLER                          PIC XX   VALUE SPACE.
   514     12  SM-JUL-DATE                     PIC 9(5).
   515     12  FILLER                          PIC X    VALUE SPACE.
   516     12  SM-TIME                         PIC 99.99.
   517
   518*    COPY ELCSCRTY.
   519******************************************************************
   520*                                                                *
   521*                                                                *
   522*                            ELCSCRTY                            *
   523*                            VMOD=2.001                          *
   524*                                                                *
   525*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   526*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   527*        SAVED IN PI-SECURITY-ADDRESS.                           *
   528*                                                                *
   529******************************************************************
   530 01  SECURITY-CONTROL.
   531     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   532     12  FILLER                       PIC XX    VALUE 'SC'.
   533     12  SC-CREDIT-CODES.
   534         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   535             20  SC-CREDIT-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6526.cbl
   536             20  SC-CREDIT-UPDATE     PIC X.
   537     12  SC-CLAIMS-CODES.
   538         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   539             20  SC-CLAIMS-DISPLAY    PIC X.
   540             20  SC-CLAIMS-UPDATE     PIC X.
   541*    COPY ELCINTF.
   542******************************************************************
   543*                                                                *
   544*                                                                *
   545*                            ELCINTF.                            *
   546*                            VMOD=2.017                          *
   547*                                                                *
   548*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   549*                                                                *
   550*       LENGTH = 1024                                            *
   551*                                                                *
   552******************************************************************
   553 01  PROGRAM-INTERFACE-BLOCK.
   554     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   555     12  PI-CALLING-PROGRAM              PIC X(8).
   556     12  PI-SAVED-PROGRAM-1              PIC X(8).
   557     12  PI-SAVED-PROGRAM-2              PIC X(8).
   558     12  PI-SAVED-PROGRAM-3              PIC X(8).
   559     12  PI-SAVED-PROGRAM-4              PIC X(8).
   560     12  PI-SAVED-PROGRAM-5              PIC X(8).
   561     12  PI-SAVED-PROGRAM-6              PIC X(8).
   562     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   563     12  PI-COMPANY-ID                   PIC XXX.
   564     12  PI-COMPANY-CD                   PIC X.
   565
   566     12  PI-COMPANY-PASSWORD             PIC X(8).
   567
   568     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   569
   570     12  PI-CONTROL-IN-PROGRESS.
   571         16  PI-CARRIER                  PIC X.
   572         16  PI-GROUPING                 PIC X(6).
   573         16  PI-STATE                    PIC XX.
   574         16  PI-ACCOUNT                  PIC X(10).
   575         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   576                                         PIC X(10).
   577         16  PI-CLAIM-CERT-GRP.
   578             20  PI-CLAIM-NO             PIC X(7).
   579             20  PI-CERT-NO.
   580                 25  PI-CERT-PRIME       PIC X(10).
   581                 25  PI-CERT-SFX         PIC X.
   582             20  PI-CERT-EFF-DT          PIC XX.
   583         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   584             20  PI-PLAN-CODE            PIC X(2).
   585             20  PI-REVISION-NUMBER      PIC X(3).
   586             20  PI-PLAN-EFF-DT          PIC X(2).
   587             20  PI-PLAN-EXP-DT          PIC X(2).
   588             20  FILLER                  PIC X(11).
   589         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   590             20  PI-OE-REFERENCE-1.
   591                 25  PI-OE-REF-1-PRIME   PIC X(18).
   592                 25  PI-OE-REF-1-SUFF    PIC XX.
   593
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6526.cbl
   594     12  PI-SESSION-IN-PROGRESS          PIC X.
   595         88  CLAIM-SESSION                   VALUE '1'.
   596         88  CREDIT-SESSION                  VALUE '2'.
   597         88  WARRANTY-SESSION                VALUE '3'.
   598         88  MORTGAGE-SESSION                VALUE '4'.
   599         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   600
   601
   602*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   603
   604     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   605     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   606
   607     12  PI-CREDIT-USER                  PIC X.
   608         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   609         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   610
   611     12  PI-CLAIM-USER                   PIC X.
   612         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   613         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   614
   615     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   616         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   617         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   618         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   619         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   620         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   621
   622     12  PI-PROCESSOR-ID                 PIC X(4).
   623
   624     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   625
   626     12  PI-MEMBER-CAPTION               PIC X(10).
   627
   628     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   629         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   630
   631     12  PI-LIFE-OVERRIDE-L1             PIC X.
   632     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   633     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   634     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   635
   636     12  PI-AH-OVERRIDE-L1               PIC X.
   637     12  PI-AH-OVERRIDE-L2               PIC XX.
   638     12  PI-AH-OVERRIDE-L6               PIC X(6).
   639     12  PI-AH-OVERRIDE-L12              PIC X(12).
   640
   641     12  PI-NEW-SYSTEM                   PIC X(2).
   642
   643     12  PI-PRIMARY-CERT-NO              PIC X(11).
   644     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   645         88  PI-USES-PAID-TO                 VALUE '1'.
   646     12  PI-CRDTCRD-SYSTEM.
   647         16  PI-CRDTCRD-USER             PIC X.
   648             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   649             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   650         16  PI-CC-MONTH-END-DT          PIC XX.
   651     12  PI-PROCESSOR-PRINTER            PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6526.cbl
   652
   653     12  PI-OE-REFERENCE-2.
   654         16  PI-OE-REF-2-PRIME           PIC X(10).
   655         16  PI-OE-REF-2-SUFF            PIC X.
   656
   657     12  PI-REM-TRM-CALC-OPTION          PIC X.
   658
   659     12  PI-LANGUAGE-TYPE                PIC X.
   660             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   661             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   662             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   663
   664     12  PI-POLICY-LINKAGE-IND           PIC X.
   665         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   666         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   667                                                   LOW-VALUES.
   668
   669     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   670     12  PI-CLAIM-PW-SESSION             PIC X(1).
   671         88  PI-CLAIM-CREDIT                 VALUE '1'.
   672         88  PI-CLAIM-CONVEN                 VALUE '2'.
   673     12  FILLER                          PIC X(4).
   674
   675     12  PI-SYSTEM-LEVEL                 PIC X(145).
   676
   677     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   678         PI-SYSTEM-LEVEL.
   679
   680         16  PI-ENTRY-CODES.
   681             20  PI-ENTRY-CD-1           PIC X.
   682             20  PI-ENTRY-CD-2           PIC X.
   683
   684         16  PI-RETURN-CODES.
   685             20  PI-RETURN-CD-1          PIC X.
   686             20  PI-RETURN-CD-2          PIC X.
   687
   688         16  PI-UPDATE-STATUS-SAVE.
   689             20  PI-UPDATE-BY            PIC X(4).
   690             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   691
   692         16  PI-LOWER-CASE-LETTERS       PIC X.
   693             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   694
   695*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   696*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   697*            88  CARRIER-CLM-CNTL            VALUE '2'.
   698
   699         16  PI-CERT-ACCESS-CONTROL      PIC X.
   700             88  ST-ACCNT-CNTL               VALUE ' '.
   701             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   702             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   703             88  ACCNT-CNTL                  VALUE '3'.
   704             88  CARR-ACCNT-CNTL             VALUE '4'.
   705
   706         16  PI-PROCESSOR-CAP-LIST.
   707             20  PI-SYSTEM-CONTROLS.
   708                24 PI-SYSTEM-DISPLAY     PIC X.
   709                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6526.cbl
   710                24 PI-SYSTEM-MODIFY      PIC X.
   711                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   712             20  FILLER                  PIC XX.
   713             20  PI-DISPLAY-CAP          PIC X.
   714                 88  DISPLAY-CAP             VALUE 'Y'.
   715             20  PI-MODIFY-CAP           PIC X.
   716                 88  MODIFY-CAP              VALUE 'Y'.
   717             20  PI-MSG-AT-LOGON-CAP     PIC X.
   718                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   719             20  PI-FORCE-CAP            PIC X.
   720                 88  FORCE-CAP               VALUE 'Y'.
   721
   722         16  PI-PROGRAM-CONTROLS.
   723             20  PI-PGM-PRINT-OPT        PIC X.
   724             20  PI-PGM-FORMAT-OPT       PIC X.
   725             20  PI-PGM-PROCESS-OPT      PIC X.
   726             20  PI-PGM-TOTALS-OPT       PIC X.
   727
   728         16  PI-HELP-INTERFACE.
   729             20  PI-LAST-ERROR-NO        PIC X(4).
   730             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   731
   732         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   733             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   734
   735         16  PI-CR-CONTROL-IN-PROGRESS.
   736             20  PI-CR-CARRIER           PIC X.
   737             20  PI-CR-GROUPING          PIC X(6).
   738             20  PI-CR-STATE             PIC XX.
   739             20  PI-CR-ACCOUNT           PIC X(10).
   740             20  PI-CR-FIN-RESP          PIC X(10).
   741             20  PI-CR-TYPE              PIC X.
   742
   743         16  PI-CR-BATCH-NUMBER          PIC X(6).
   744
   745         16  PI-CR-MONTH-END-DT          PIC XX.
   746
   747         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   748             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   749             88  PI-ZERO-CARRIER             VALUE '1'.
   750             88  PI-ZERO-GROUPING            VALUE '2'.
   751             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   752
   753         16  PI-CARRIER-SECURITY         PIC X.
   754             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   755
   756         16  PI-ACCOUNT-SECURITY         PIC X(10).
   757             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   758             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   759
   760         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   761             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   762                                         INDEXED BY PI-ACCESS-NDX
   763                                         PIC X.
   764
   765         16  PI-GA-BILLING-CONTROL       PIC X.
   766             88  PI-GA-BILLING               VALUE '1'.
   767
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6526.cbl
   768         16  PI-MAIL-PROCESSING          PIC X.
   769             88  PI-MAIL-YES                 VALUE 'Y'.
   770
   771         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   772
   773         16  PI-AR-SYSTEM.
   774             20  PI-AR-PROCESSING-CNTL   PIC X.
   775                 88  PI-AR-PROCESSING        VALUE 'Y'.
   776             20  PI-AR-SUMMARY-CODE      PIC X(6).
   777             20  PI-AR-MONTH-END-DT      PIC XX.
   778
   779         16  PI-MP-SYSTEM.
   780             20  PI-MORTGAGE-USER            PIC X.
   781                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   782                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   783             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   784                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   785                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   786                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   787                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   788                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   789             20  PI-MP-MONTH-END-DT          PIC XX.
   790             20  PI-MP-REFERENCE-NO.
   791                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   792                 24  PI-MP-REFERENCE-SFX     PIC XX.
   793
   794         16  PI-LABEL-CONTROL            PIC X(01).
   795             88  PI-CREATE-LABELS                    VALUE 'Y'.
   796             88  PI-BYPASS-LABELS                    VALUE 'N'.
   797
   798         16  PI-BILL-GROUPING-CODE       PIC X(01).
   799             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   800
   801         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   802             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   803             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   804
   805         16  FILLER                      PIC X(14).
   806
   807     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   808******************************************************************
   809     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
   810         16  PI-MAINT                PIC  X.
   811         16  PI-CHECK-TYPE           PIC  X.
   812         16  PI-CHECK-CARRY-BAL      PIC  X.
   813         16  PI-FIRST-TIME-SW        PIC  X.
   814             88  FIRST-TIME                  VALUE 'Y'.
   815         16  PI-ERCOMP-EOF-SW        PIC  X.
   816             88  ERCOMP-EOF                  VALUE 'Y'.
   817         16  PI-SAVE-PHONE           PIC  X(10).
   818         16  PI-SAVE-PHONE-RED REDEFINES PI-SAVE-PHONE  PIC 9(10).
   819         16  PI-ERC-END-BAL          PIC S9(9)V99       COMP-3.
   820         16  PI-ERCOMP-KEY.
   821             20  PI-ERC-GROUP-CD     PIC  X.
   822             20  PI-ERC-CARRIER      PIC  X.
   823             20  PI-ERC-GROUP        PIC  X(6).
   824             20  PI-ERC-RESP         PIC  X(10).
   825             20  PI-ERC-ACCT         PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6526.cbl
   826             20  PI-ERC-TYPE         PIC  X.
   827         16  PI-SAVE-ERCOMP-KEY      PIC  X(29).
   828         16  PI-BANK-TRANSIT-NUMBER.
   829             20  PI-BANK-COMPANY-CD  PIC X.
   830             20  PI-FEDERAL-NUMBER   PIC X(4).
   831             20  PI-BANK-NUMBER      PIC X(4).
   832         16  PI-BANK-ACCOUNT-NO      PIC X(17).
   833         16  PI-BANK-ACTION-CODE     PIC X.
   834         16  PI-ERCOBI-KEY.
   835             20  PI-ERCOBI-COMPANY-CD PIC X.
   836             20  PI-ERCOBI-STMT-OWNER PIC X(4).
   837             20  PI-ERCOBI-RGID      PIC X(12).
   838         16  PI-SAVE-ERCOBI-KEY      PIC X(17).
   839         16  FILLER                  PIC  X(500).
   840*    COPY ELCAID.
   841******************************************************************
   842*                                                                *
   843*                            ELCAID.                             *
   844*                            VMOD=2.001                          *
   845*                                                                *
   846*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   847*                                                                *
   848*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   849*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   850******************************************************************
   851
   852 01  DFHAID.
   853   02  DFHNULL   PIC  X  VALUE  ' '.
   854   02  DFHENTER  PIC  X  VALUE  QUOTE.
   855   02  DFHCLEAR  PIC  X  VALUE  '_'.
   856   02  DFHPEN    PIC  X  VALUE  '='.
   857   02  DFHOPID   PIC  X  VALUE  'W'.
   858   02  DFHPA1    PIC  X  VALUE  '%'.
   859   02  DFHPA2    PIC  X  VALUE  '>'.
   860   02  DFHPA3    PIC  X  VALUE  ','.
   861   02  DFHPF1    PIC  X  VALUE  '1'.
   862   02  DFHPF2    PIC  X  VALUE  '2'.
   863   02  DFHPF3    PIC  X  VALUE  '3'.
   864   02  DFHPF4    PIC  X  VALUE  '4'.
   865   02  DFHPF5    PIC  X  VALUE  '5'.
   866   02  DFHPF6    PIC  X  VALUE  '6'.
   867   02  DFHPF7    PIC  X  VALUE  '7'.
   868   02  DFHPF8    PIC  X  VALUE  '8'.
   869   02  DFHPF9    PIC  X  VALUE  '9'.
   870   02  DFHPF10   PIC  X  VALUE  ':'.
   871   02  DFHPF11   PIC  X  VALUE  '#'.
   872   02  DFHPF12   PIC  X  VALUE  '@'.
   873   02  DFHPF13   PIC  X  VALUE  'A'.
   874   02  DFHPF14   PIC  X  VALUE  'B'.
   875   02  DFHPF15   PIC  X  VALUE  'C'.
   876   02  DFHPF16   PIC  X  VALUE  'D'.
   877   02  DFHPF17   PIC  X  VALUE  'E'.
   878   02  DFHPF18   PIC  X  VALUE  'F'.
   879   02  DFHPF19   PIC  X  VALUE  'G'.
   880   02  DFHPF20   PIC  X  VALUE  'H'.
   881   02  DFHPF21   PIC  X  VALUE  'I'.
   882*00039    02  DFHPF22   PIC  X  VALUE  ''.
   883   02  DFHPF22   PIC  X  VALUE  '['.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6526.cbl
   884   02  DFHPF23   PIC  X  VALUE  '.'.
   885   02  DFHPF24   PIC  X  VALUE  '<'.
   886   02  DFHMSRE   PIC  X  VALUE  'X'.
   887   02  DFHSTRF   PIC  X  VALUE  'h'.
   888   02  DFHTRIG   PIC  X  VALUE  '"'.
   889 01  FILLER    REDEFINES DFHAID.
   890     12  FILLER                      PIC X(8).
   891     12  PF-VALUES                   PIC X       OCCURS 2.
   892*                                COPY EL6526S.
   893 01  EL6526AI.
   894     05  FILLER            PIC  X(0012).
   895*    -------------------------------
   896     05  DATEL PIC S9(0004) COMP.
   897     05  DATEF PIC  X(0001).
   898     05  FILLER REDEFINES DATEF.
   899         10  DATEA PIC  X(0001).
   900     05  DATEI PIC  X(0008).
   901*    -------------------------------
   902     05  TIMEL PIC S9(0004) COMP.
   903     05  TIMEF PIC  X(0001).
   904     05  FILLER REDEFINES TIMEF.
   905         10  TIMEA PIC  X(0001).
   906     05  TIMEI PIC  X(0005).
   907*    -------------------------------
   908     05  CMPNYIDL PIC S9(0004) COMP.
   909     05  CMPNYIDF PIC  X(0001).
   910     05  FILLER REDEFINES CMPNYIDF.
   911         10  CMPNYIDA PIC  X(0001).
   912     05  CMPNYIDI PIC  X(0003).
   913*    -------------------------------
   914     05  USERIDL PIC S9(0004) COMP.
   915     05  USERIDF PIC  X(0001).
   916     05  FILLER REDEFINES USERIDF.
   917         10  USERIDA PIC  X(0001).
   918     05  USERIDI PIC  X(0004).
   919*    -------------------------------
   920     05  CARRIERL PIC S9(0004) COMP.
   921     05  CARRIERF PIC  X(0001).
   922     05  FILLER REDEFINES CARRIERF.
   923         10  CARRIERA PIC  X(0001).
   924     05  CARRIERI PIC  X(0001).
   925*    -------------------------------
   926     05  GROUPL PIC S9(0004) COMP.
   927     05  GROUPF PIC  X(0001).
   928     05  FILLER REDEFINES GROUPF.
   929         10  GROUPA PIC  X(0001).
   930     05  GROUPI PIC  X(0006).
   931*    -------------------------------
   932     05  TYPEL PIC S9(0004) COMP.
   933     05  TYPEF PIC  X(0001).
   934     05  FILLER REDEFINES TYPEF.
   935         10  TYPEA PIC  X(0001).
   936     05  TYPEI PIC  X(0001).
   937*    -------------------------------
   938     05  FINRESPL PIC S9(0004) COMP.
   939     05  FINRESPF PIC  X(0001).
   940     05  FILLER REDEFINES FINRESPF.
   941         10  FINRESPA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6526.cbl
   942     05  FINRESPI PIC  X(0010).
   943*    -------------------------------
   944     05  COACCTL PIC S9(0004) COMP.
   945     05  COACCTF PIC  X(0001).
   946     05  FILLER REDEFINES COACCTF.
   947         10  COACCTA PIC  X(0001).
   948     05  COACCTI PIC  X(0010).
   949*    -------------------------------
   950     05  NAME1L PIC S9(0004) COMP.
   951     05  NAME1F PIC  X(0001).
   952     05  FILLER REDEFINES NAME1F.
   953         10  NAME1A PIC  X(0001).
   954     05  NAME1I PIC  X(0030).
   955*    -------------------------------
   956     05  EADR1L PIC S9(0004) COMP.
   957     05  EADR1F PIC  X(0001).
   958     05  FILLER REDEFINES EADR1F.
   959         10  EADR1A PIC  X(0001).
   960     05  EADR1I PIC  X(0045).
   961*    -------------------------------
   962     05  NAME2L PIC S9(0004) COMP.
   963     05  NAME2F PIC  X(0001).
   964     05  FILLER REDEFINES NAME2F.
   965         10  NAME2A PIC  X(0001).
   966     05  NAME2I PIC  X(0030).
   967*    -------------------------------
   968     05  EADR2L PIC S9(0004) COMP.
   969     05  EADR2F PIC  X(0001).
   970     05  FILLER REDEFINES EADR2F.
   971         10  EADR2A PIC  X(0001).
   972     05  EADR2I PIC  X(0045).
   973*    -------------------------------
   974     05  NAME3L PIC S9(0004) COMP.
   975     05  NAME3F PIC  X(0001).
   976     05  FILLER REDEFINES NAME3F.
   977         10  NAME3A PIC  X(0001).
   978     05  NAME3I PIC  X(0030).
   979*    -------------------------------
   980     05  EADR3L PIC S9(0004) COMP.
   981     05  EADR3F PIC  X(0001).
   982     05  FILLER REDEFINES EADR3F.
   983         10  EADR3A PIC  X(0001).
   984     05  EADR3I PIC  X(0045).
   985*    -------------------------------
   986     05  NAME4L PIC S9(0004) COMP.
   987     05  NAME4F PIC  X(0001).
   988     05  FILLER REDEFINES NAME4F.
   989         10  NAME4A PIC  X(0001).
   990     05  NAME4I PIC  X(0030).
   991*    -------------------------------
   992     05  EADR4L PIC S9(0004) COMP.
   993     05  EADR4F PIC  X(0001).
   994     05  FILLER REDEFINES EADR4F.
   995         10  EADR4A PIC  X(0001).
   996     05  EADR4I PIC  X(0045).
   997*    -------------------------------
   998     05  NAME5L PIC S9(0004) COMP.
   999     05  NAME5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6526.cbl
  1000     05  FILLER REDEFINES NAME5F.
  1001         10  NAME5A PIC  X(0001).
  1002     05  NAME5I PIC  X(0030).
  1003*    -------------------------------
  1004     05  EADR5L PIC S9(0004) COMP.
  1005     05  EADR5F PIC  X(0001).
  1006     05  FILLER REDEFINES EADR5F.
  1007         10  EADR5A PIC  X(0001).
  1008     05  EADR5I PIC  X(0045).
  1009*    -------------------------------
  1010     05  NAME6L PIC S9(0004) COMP.
  1011     05  NAME6F PIC  X(0001).
  1012     05  FILLER REDEFINES NAME6F.
  1013         10  NAME6A PIC  X(0001).
  1014     05  NAME6I PIC  X(0030).
  1015*    -------------------------------
  1016     05  EADR6L PIC S9(0004) COMP.
  1017     05  EADR6F PIC  X(0001).
  1018     05  FILLER REDEFINES EADR6F.
  1019         10  EADR6A PIC  X(0001).
  1020     05  EADR6I PIC  X(0045).
  1021*    -------------------------------
  1022     05  NAME7L PIC S9(0004) COMP.
  1023     05  NAME7F PIC  X(0001).
  1024     05  FILLER REDEFINES NAME7F.
  1025         10  NAME7A PIC  X(0001).
  1026     05  NAME7I PIC  X(0030).
  1027*    -------------------------------
  1028     05  EADR7L PIC S9(0004) COMP.
  1029     05  EADR7F PIC  X(0001).
  1030     05  FILLER REDEFINES EADR7F.
  1031         10  EADR7A PIC  X(0001).
  1032     05  EADR7I PIC  X(0045).
  1033*    -------------------------------
  1034     05  NAME8L PIC S9(0004) COMP.
  1035     05  NAME8F PIC  X(0001).
  1036     05  FILLER REDEFINES NAME8F.
  1037         10  NAME8A PIC  X(0001).
  1038     05  NAME8I PIC  X(0030).
  1039*    -------------------------------
  1040     05  EADR8L PIC S9(0004) COMP.
  1041     05  EADR8F PIC  X(0001).
  1042     05  FILLER REDEFINES EADR8F.
  1043         10  EADR8A PIC  X(0001).
  1044     05  EADR8I PIC  X(0045).
  1045*    -------------------------------
  1046     05  NAME9L PIC S9(0004) COMP.
  1047     05  NAME9F PIC  X(0001).
  1048     05  FILLER REDEFINES NAME9F.
  1049         10  NAME9A PIC  X(0001).
  1050     05  NAME9I PIC  X(0030).
  1051*    -------------------------------
  1052     05  EADR9L PIC S9(0004) COMP.
  1053     05  EADR9F PIC  X(0001).
  1054     05  FILLER REDEFINES EADR9F.
  1055         10  EADR9A PIC  X(0001).
  1056     05  EADR9I PIC  X(0045).
  1057*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6526.cbl
  1058     05  NAME10L PIC S9(0004) COMP.
  1059     05  NAME10F PIC  X(0001).
  1060     05  FILLER REDEFINES NAME10F.
  1061         10  NAME10A PIC  X(0001).
  1062     05  NAME10I PIC  X(0030).
  1063*    -------------------------------
  1064     05  EADR10L PIC S9(0004) COMP.
  1065     05  EADR10F PIC  X(0001).
  1066     05  FILLER REDEFINES EADR10F.
  1067         10  EADR10A PIC  X(0001).
  1068     05  EADR10I PIC  X(0045).
  1069*    -------------------------------
  1070     05  PFENTERL PIC S9(0004) COMP.
  1071     05  PFENTERF PIC  X(0001).
  1072     05  FILLER REDEFINES PFENTERF.
  1073         10  PFENTERA PIC  X(0001).
  1074     05  PFENTERI PIC  99.
  1075 01  EL6526AO REDEFINES EL6526AI.
  1076     05  FILLER            PIC  X(0012).
  1077*    -------------------------------
  1078     05  FILLER            PIC  X(0003).
  1079     05  DATEO PIC  X(0008).
  1080*    -------------------------------
  1081     05  FILLER            PIC  X(0003).
  1082     05  TIMEO PIC  99.99.
  1083*    -------------------------------
  1084     05  FILLER            PIC  X(0003).
  1085     05  CMPNYIDO PIC  X(0003).
  1086*    -------------------------------
  1087     05  FILLER            PIC  X(0003).
  1088     05  USERIDO PIC  X(0004).
  1089*    -------------------------------
  1090     05  FILLER            PIC  X(0003).
  1091     05  CARRIERO PIC  X(0001).
  1092*    -------------------------------
  1093     05  FILLER            PIC  X(0003).
  1094     05  GROUPO PIC  X(0006).
  1095*    -------------------------------
  1096     05  FILLER            PIC  X(0003).
  1097     05  TYPEO PIC  X(0001).
  1098*    -------------------------------
  1099     05  FILLER            PIC  X(0003).
  1100     05  FINRESPO PIC  X(0010).
  1101*    -------------------------------
  1102     05  FILLER            PIC  X(0003).
  1103     05  COACCTO PIC  X(0010).
  1104*    -------------------------------
  1105     05  FILLER            PIC  X(0003).
  1106     05  NAME1O PIC  X(0030).
  1107*    -------------------------------
  1108     05  FILLER            PIC  X(0003).
  1109     05  EADR1O PIC  X(0045).
  1110*    -------------------------------
  1111     05  FILLER            PIC  X(0003).
  1112     05  NAME2O PIC  X(0030).
  1113*    -------------------------------
  1114     05  FILLER            PIC  X(0003).
  1115     05  EADR2O PIC  X(0045).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6526.cbl
  1116*    -------------------------------
  1117     05  FILLER            PIC  X(0003).
  1118     05  NAME3O PIC  X(0030).
  1119*    -------------------------------
  1120     05  FILLER            PIC  X(0003).
  1121     05  EADR3O PIC  X(0045).
  1122*    -------------------------------
  1123     05  FILLER            PIC  X(0003).
  1124     05  NAME4O PIC  X(0030).
  1125*    -------------------------------
  1126     05  FILLER            PIC  X(0003).
  1127     05  EADR4O PIC  X(0045).
  1128*    -------------------------------
  1129     05  FILLER            PIC  X(0003).
  1130     05  NAME5O PIC  X(0030).
  1131*    -------------------------------
  1132     05  FILLER            PIC  X(0003).
  1133     05  EADR5O PIC  X(0045).
  1134*    -------------------------------
  1135     05  FILLER            PIC  X(0003).
  1136     05  NAME6O PIC  X(0030).
  1137*    -------------------------------
  1138     05  FILLER            PIC  X(0003).
  1139     05  EADR6O PIC  X(0045).
  1140*    -------------------------------
  1141     05  FILLER            PIC  X(0003).
  1142     05  NAME7O PIC  X(0030).
  1143*    -------------------------------
  1144     05  FILLER            PIC  X(0003).
  1145     05  EADR7O PIC  X(0045).
  1146*    -------------------------------
  1147     05  FILLER            PIC  X(0003).
  1148     05  NAME8O PIC  X(0030).
  1149*    -------------------------------
  1150     05  FILLER            PIC  X(0003).
  1151     05  EADR8O PIC  X(0045).
  1152*    -------------------------------
  1153     05  FILLER            PIC  X(0003).
  1154     05  NAME9O PIC  X(0030).
  1155*    -------------------------------
  1156     05  FILLER            PIC  X(0003).
  1157     05  EADR9O PIC  X(0045).
  1158*    -------------------------------
  1159     05  FILLER            PIC  X(0003).
  1160     05  NAME10O PIC  X(0030).
  1161*    -------------------------------
  1162     05  FILLER            PIC  X(0003).
  1163     05  EADR10O PIC  X(0045).
  1164*    -------------------------------
  1165     05  FILLER            PIC  X(0003).
  1166     05  PFENTERO PIC  99.
  1167*    -------------------------------
  1168****************************************************************
  1169*
  1170* Copyright (c) 2007 by Clerity Solutions, Inc.
  1171* All rights reserved.
  1172*
  1173****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6526.cbl
  1174 01  DFHEIV.
  1175   02  DFHEIV0               PIC X(35).
  1176   02  DFHEIV1               PIC X(08).
  1177   02  DFHEIV2               PIC X(08).
  1178   02  DFHEIV3               PIC X(08).
  1179   02  DFHEIV4               PIC X(06).
  1180   02  DFHEIV5               PIC X(04).
  1181   02  DFHEIV6               PIC X(04).
  1182   02  DFHEIV7               PIC X(02).
  1183   02  DFHEIV8               PIC X(02).
  1184   02  DFHEIV9               PIC X(01).
  1185   02  DFHEIV10              PIC S9(7) COMP-3.
  1186   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1187   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1188   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1189   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1190   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1191   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1192   02  DFHEIV17              PIC X(04).
  1193   02  DFHEIV18              PIC X(04).
  1194   02  DFHEIV19              PIC X(04).
  1195   02  DFHEIV20              USAGE IS POINTER.
  1196   02  DFHEIV21              USAGE IS POINTER.
  1197   02  DFHEIV22              USAGE IS POINTER.
  1198   02  DFHEIV23              USAGE IS POINTER.
  1199   02  DFHEIV24              USAGE IS POINTER.
  1200   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1201   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1202   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1203   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1204   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1205   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1206   02  FILLER                PIC X(02).
  1207   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1208   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1209   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1210   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1211   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1212 LINKAGE  SECTION.
  1213*****************************************************************
  1214*                                                               *
  1215* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1216* All rights reserved.                                          *
  1217*                                                               *
  1218*****************************************************************
  1219 01  dfheiblk.
  1220     02  eibtime          pic s9(7) comp-3.
  1221     02  eibdate          pic s9(7) comp-3.
  1222     02  eibtrnid         pic x(4).
  1223     02  eibtaskn         pic s9(7) comp-3.
  1224     02  eibtrmid         pic x(4).
  1225     02  dfheigdi         pic s9(4) comp.
  1226     02  eibcposn         pic s9(4) comp.
  1227     02  eibcalen         pic s9(4) comp.
  1228     02  eibaid           pic x(1).
  1229     02  eibfiller1       pic x(1).
  1230     02  eibfn            pic x(2).
  1231     02  eibfiller2       pic x(2).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6526.cbl
  1232     02  eibrcode         pic x(6).
  1233     02  eibfiller3       pic x(2).
  1234     02  eibds            pic x(8).
  1235     02  eibreqid         pic x(8).
  1236     02  eibrsrce         pic x(8).
  1237     02  eibsync          pic x(1).
  1238     02  eibfree          pic x(1).
  1239     02  eibrecv          pic x(1).
  1240     02  eibsend          pic x(1).
  1241     02  eibatt           pic x(1).
  1242     02  eibeoc           pic x(1).
  1243     02  eibfmh           pic x(1).
  1244     02  eibcompl         pic x(1).
  1245     02  eibsig           pic x(1).
  1246     02  eibconf          pic x(1).
  1247     02  eiberr           pic x(1).
  1248     02  eibrldbk         pic x(1).
  1249     02  eiberrcd         pic x(4).
  1250     02  eibsynrb         pic x(1).
  1251     02  eibnodat         pic x(1).
  1252     02  eibfiller5       pic x(2).
  1253     02  eibresp          pic 9(09) comp.
  1254     02  eibresp2         pic 9(09) comp.
  1255     02  dfheigdj         pic s9(4) comp.
  1256     02  dfheigdk         pic s9(4) comp.
  1257 01  DFHCOMMAREA                     PIC X(1024).
  1258*                                COPY ERCEADR.
  1259******************************************************************
  1260*                                                                *
  1261*                                                                *
  1262*                            ERCEADR                             *
  1263*                                                                *
  1264*   ONLINE CREDIT SYSTEM                                         *
  1265*                                                                *
  1266*   FILE DESCRIPTION = EMAIL ADDRESS FILE                        *
  1267*                                                                *
  1268*   FILE TYPE = VSAM,KSDS                                        *
  1269*   RECORD SIZE = 910   RECFORM = FIXED                          *
  1270*                                                                *
  1271*   BASE CLUSTER NAME = EREADR                   RKP=2,LEN=48    *
  1272*       ALTERNATE PATH = NONE                                    *
  1273*                                                                *
  1274*   LOG = NO                                                     *
  1275*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1276*                                                                *
  1277******************************************************************
  1278*                   C H A N G E   L O G
  1279*
  1280* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1281*-----------------------------------------------------------------
  1282*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1283* EFFECTIVE    NUMBER
  1284*-----------------------------------------------------------------
  1285* 100703    2003080800002  PEMA  NEW FILE
  1286******************************************************************
  1287 01  EMAIL-ADDRESS.
  1288     12  EA-RECORD-ID                          PIC XX.
  1289         88  VALID-EA-ID                          VALUE 'EA'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6526.cbl
  1290     12  EA-CONTROL-PRIMARY.
  1291         16  EA-COMPANY-CD                     PIC X.
  1292         16  EA-RECORD-TYPE                    PIC XX.
  1293             88  EA-ERCOMP-EMAIL                  VALUE 'CO'.
  1294         16  EA-REST-OF-KEY                    PIC X(45).
  1295         16  EA-ERCOMP-EMAIL-KEY REDEFINES EA-REST-OF-KEY.
  1296             20  EA-CO-CARRIER                 PIC X.
  1297             20  EA-CO-GROUPING                PIC X(6).
  1298             20  EA-CO-FIN-RESP                PIC X(10).
  1299             20  EA-CO-ACCOUNT                 PIC X(10).
  1300             20  EA-CO-TYPE                    PIC X.
  1301             20  FILLER                        PIC X(17).
  1302     12  EA-RECORD-BODY.
  1303         16  FILLER OCCURS 10.
  1304             20  EA-PERSONS-NAME               PIC X(30).
  1305             20  EA-PERSONS-EMAIL              PIC X(45).
  1306         16  EA-LAST-UPDATE-DT                 PIC 9(8).
  1307     12  FILLER                                PIC X(102).
  1308 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA EMAIL-ADDRESS.
  1309 0000-DFHEXIT SECTION.
  1310     MOVE '9#                    $   ' TO DFHEIV0.
  1311     MOVE 'EL6526' TO DFHEIV1.
  1312     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1313     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1314     MOVE '5'                    TO DC-OPTION-CODE.
  1315     PERFORM 9700-DATE-CONVERT THRU 9700-EXIT.
  1316     MOVE DC-GREG-DATE-1-EDIT    TO WS-SAVE-DATE.
  1317     MOVE DC-BIN-DATE-1          TO WS-SAVE-BIN-DT.
  1318     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1319     MOVE EIBTRMID               TO QID-TERM.
  1320     MOVE +1                     TO EMI-NUMBER-OF-LINES.
  1321     MOVE SPACE                  TO SUPPRESS-MAP-SW.
  1322     IF EIBCALEN = 0
  1323         GO TO 8800-UNAUTHORIZED-ACCESS.
  1324     MOVE LOW-VALUES             TO EL6526AI.
  1325     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1326         MOVE PI-SAVED-PROGRAM-5 TO  PI-SAVED-PROGRAM-6
  1327         MOVE PI-SAVED-PROGRAM-4 TO  PI-SAVED-PROGRAM-5
  1328         MOVE PI-SAVED-PROGRAM-3 TO  PI-SAVED-PROGRAM-4
  1329         MOVE PI-SAVED-PROGRAM-2 TO  PI-SAVED-PROGRAM-3
  1330         MOVE PI-SAVED-PROGRAM-1 TO  PI-SAVED-PROGRAM-2
  1331         MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  1332         MOVE PI-CALLING-PROGRAM TO  PI-RETURN-TO-PROGRAM
  1333         MOVE THIS-PGM           TO  PI-CALLING-PROGRAM.
  1334     IF EIBTRNID NOT = TRANS-ID
  1335        GO TO 4000-SHOW
  1336     END-IF
  1337
  1338* EXEC CICS HANDLE CONDITION
  1339*        PGMIDERR  (9600-PGMID-ERROR)
  1340*        ERROR     (9990-ABEND)
  1341*    END-EXEC.
  1342*    MOVE '"$L.                  ! " #00001333' TO DFHEIV0
  1343     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1344     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1345     MOVE X'2220233030303031333333' TO DFHEIV0(25:11)
  1346     CALL 'kxdfhei1' USING DFHEIV0
  1347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6526.cbl
  1348
  1349     IF EIBAID = DFHCLEAR
  1350         GO TO 9400-CLEAR.
  1351     .
  1352 0200-RECEIVE.
  1353     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1354         MOVE ER-0008            TO EMI-ERROR
  1355         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1356         MOVE -1                 TO PFENTERL
  1357         GO TO 8200-SEND-DATAONLY.
  1358
  1359* EXEC CICS RECEIVE
  1360*        MAP      (MAP-NAME)
  1361*        MAPSET   (MAPSET-NAME)
  1362*        INTO     (EL6526AI)
  1363*    END-EXEC.
  1364     MOVE LENGTH OF
  1365      EL6526AI
  1366       TO DFHEIV11
  1367*    MOVE '8"T I  L              ''   #00001346' TO DFHEIV0
  1368     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1369     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1370     MOVE X'2020233030303031333436' TO DFHEIV0(25:11)
  1371     CALL 'kxdfhei1' USING DFHEIV0,
  1372           MAP-NAME,
  1373           EL6526AI,
  1374           DFHEIV11,
  1375           MAPSET-NAME,
  1376           DFHEIV99,
  1377           DFHEIV99
  1378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1379
  1380     IF PFENTERL = 0
  1381         GO TO 0300-CHECK-PFKEYS.
  1382     IF EIBAID NOT = DFHENTER
  1383         MOVE ER-0004            TO EMI-ERROR
  1384         GO TO 0320-INPUT-ERROR.
  1385     IF (PFENTERI NUMERIC) AND (PFENTERI GREATER 0 AND LESS 25)
  1386         MOVE PF-VALUES (PFENTERI) TO EIBAID
  1387     ELSE
  1388         MOVE ER-0029              TO EMI-ERROR
  1389         GO TO 0320-INPUT-ERROR.
  1390 0300-CHECK-PFKEYS.
  1391     IF EIBAID = DFHPF23
  1392         GO TO 8810-PF23.
  1393     IF EIBAID = DFHPF24
  1394         GO TO 9200-RETURN-MAIN-MENU.
  1395     IF EIBAID = DFHPF12
  1396         GO TO 9500-PF12.
  1397     IF EIBAID = DFHENTER
  1398         GO TO 0330-CHECK-MAINTYP.
  1399     MOVE ER-0029                TO EMI-ERROR.
  1400 0320-INPUT-ERROR.
  1401     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1402     MOVE AL-UNBON               TO PFENTERA.
  1403     MOVE -1                     TO PFENTERL.
  1404     GO TO 8200-SEND-DATAONLY.
  1405 0330-CHECK-MAINTYP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6526.cbl
  1406     .
  1407 4000-SHOW.
  1408     MOVE PI-COMPANY-CD          TO EADR-KEY
  1409     MOVE 'CO'                   TO EADR-REC-TYPE
  1410     MOVE PI-ERC-CARRIER         TO EADR-CARRIER
  1411     MOVE PI-ERC-GROUP           TO EADR-GROUPING
  1412     MOVE PI-ERC-RESP            TO EADR-FIN-RESP
  1413     MOVE PI-ERC-ACCT            TO EADR-ACCOUNT
  1414     MOVE PI-ERC-TYPE            TO EADR-TYPE
  1415     display ' key = ' eadr-key (2:47)
  1416
  1417* EXEC CICS READ
  1418*       DATASET   (EREADR-FILE-ID)
  1419*       SET       (ADDRESS OF EMAIL-ADDRESS)
  1420*       RIDFLD    (EADR-KEY)
  1421*       RESP      (WS-RESPONSE)
  1422*    END-EXEC
  1423*    MOVE '&"S        E          (  N#00001387' TO DFHEIV0
  1424     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1425     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1426     MOVE X'204E233030303031333837' TO DFHEIV0(25:11)
  1427     CALL 'kxdfhei1' USING DFHEIV0,
  1428           EREADR-FILE-ID,
  1429           DFHEIV20,
  1430           DFHEIV99,
  1431           EADR-KEY,
  1432           DFHEIV99,
  1433           DFHEIV99,
  1434           DFHEIV99
  1435     SET ADDRESS OF EMAIL-ADDRESS TO
  1436         DFHEIV20
  1437     MOVE EIBRESP  TO WS-RESPONSE
  1438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1439     IF NOT RESP-NORMAL
  1440        display ' not normal ' ws-response
  1441        MOVE ER-9999             TO EMI-ERROR
  1442        MOVE -1                  TO CARRIERL
  1443        MOVE AL-SABOF            TO CARRIERA
  1444        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1445        GO TO 8200-SEND-DATAONLY
  1446     END-IF
  1447     display ' good read ' ea-co-account
  1448     display ' ea email ' ea-persons-email (1)
  1449     MOVE LOW-VALUES             TO EL6526AO
  1450     MOVE EA-CO-CARRIER          TO CARRIERO
  1451     MOVE EA-CO-GROUPING         TO GROUPO
  1452     MOVE EA-CO-FIN-RESP         TO FINRESPO
  1453     MOVE EA-CO-ACCOUNT          TO COACCTO
  1454     MOVE EA-CO-TYPE             TO TYPEO
  1455     MOVE EA-PERSONS-NAME (1)    TO NAME1O
  1456     MOVE EA-PERSONS-EMAIL (1)   TO EADR1O
  1457     MOVE EA-PERSONS-NAME (2)    TO NAME2O
  1458     MOVE EA-PERSONS-EMAIL (2)   TO EADR2O
  1459     MOVE EA-PERSONS-NAME (3)    TO NAME3O
  1460     MOVE EA-PERSONS-EMAIL (3)   TO EADR3O
  1461     MOVE EA-PERSONS-NAME (4)    TO NAME4O
  1462     MOVE EA-PERSONS-EMAIL (4)   TO EADR4O
  1463     MOVE EA-PERSONS-NAME (5)    TO NAME5O
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6526.cbl
  1464     MOVE EA-PERSONS-EMAIL (5)   TO EADR5O
  1465     MOVE EA-PERSONS-NAME (6)    TO NAME6O
  1466     MOVE EA-PERSONS-EMAIL (6)   TO EADR6O
  1467     MOVE EA-PERSONS-NAME (7)    TO NAME7O
  1468     MOVE EA-PERSONS-EMAIL (7)   TO EADR7O
  1469     MOVE EA-PERSONS-NAME (8)    TO NAME8O
  1470     MOVE EA-PERSONS-EMAIL (8)   TO EADR8O
  1471     MOVE EA-PERSONS-NAME (9)    TO NAME9O
  1472     MOVE EA-PERSONS-EMAIL (9)   TO EADR9O
  1473     MOVE EA-PERSONS-NAME (10)   TO NAME10O
  1474     MOVE EA-PERSONS-EMAIL (10)  TO EADR10O
  1475     MOVE AL-SANOF               TO CARRIERA
  1476     MOVE -1                     TO CARRIERL
  1477     GO TO 8100-SEND-INITIAL-MAP
  1478     .
  1479 5099-EXIT.
  1480     EXIT.
  1481******************************************************************
  1482 8100-SEND-INITIAL-MAP.
  1483     display ' made 8100 '
  1484     MOVE WS-SAVE-DATE           TO DATEO.
  1485     MOVE EIBTIME                TO TIME-IN.
  1486     MOVE TIME-OUT               TO TIMEO.
  1487     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  1488     MOVE PI-PROCESSOR-ID        TO USERIDO.
  1489     MOVE -1                     TO CARRIERL
  1490*    MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  1491
  1492* EXEC CICS SEND
  1493*        MAP      (MAP-NAME)
  1494*        MAPSET   (MAPSET-NAME)
  1495*        FROM     (EL6526AO)
  1496*        ERASE
  1497*        CURSOR
  1498*    END-EXEC.
  1499     MOVE LENGTH OF
  1500      EL6526AO
  1501       TO DFHEIV12
  1502     MOVE -1
  1503       TO DFHEIV11
  1504*    MOVE '8$     CT  E    H L F ,   #00001445' TO DFHEIV0
  1505     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1506     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1507     MOVE X'2020233030303031343435' TO DFHEIV0(25:11)
  1508     CALL 'kxdfhei1' USING DFHEIV0,
  1509           MAP-NAME,
  1510           EL6526AO,
  1511           DFHEIV12,
  1512           MAPSET-NAME,
  1513           DFHEIV99,
  1514           DFHEIV99,
  1515           DFHEIV99,
  1516           DFHEIV11,
  1517           DFHEIV99,
  1518           DFHEIV99,
  1519           DFHEIV99
  1520     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1521
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6526.cbl
  1522     GO TO 9100-RETURN-TRAN.
  1523 8200-SEND-DATAONLY.
  1524     IF EIBTRNID NOT = TRANS-ID
  1525        GO TO 8100-SEND-INITIAL-MAP
  1526     END-IF
  1527     MOVE WS-SAVE-DATE           TO DATEO.
  1528     MOVE EIBTIME                TO TIME-IN.
  1529     MOVE TIME-OUT               TO TIMEO.
  1530     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  1531     MOVE PI-PROCESSOR-ID        TO USERIDO.
  1532*    MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  1533
  1534* EXEC CICS SEND
  1535*        MAP      (MAP-NAME)
  1536*        MAPSET   (MAPSET-NAME)
  1537*        FROM     (EL6526AO)
  1538*        DATAONLY
  1539*        CURSOR
  1540*    END-EXEC.
  1541     MOVE LENGTH OF
  1542      EL6526AO
  1543       TO DFHEIV12
  1544     MOVE -1
  1545       TO DFHEIV11
  1546*    MOVE '8$D    CT       H L F ,   #00001463' TO DFHEIV0
  1547     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  1548     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1549     MOVE X'2020233030303031343633' TO DFHEIV0(25:11)
  1550     CALL 'kxdfhei1' USING DFHEIV0,
  1551           MAP-NAME,
  1552           EL6526AO,
  1553           DFHEIV12,
  1554           MAPSET-NAME,
  1555           DFHEIV99,
  1556           DFHEIV99,
  1557           DFHEIV99,
  1558           DFHEIV11,
  1559           DFHEIV99,
  1560           DFHEIV99,
  1561           DFHEIV99
  1562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1563
  1564     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6526.cbl
  1566 8300-SEND-TEXT.
  1567
  1568* EXEC CICS SEND TEXT
  1569*        FROM     (LOGOFF-TEXT)
  1570*        LENGTH   (LOGOFF-LENGTH)
  1571*        ERASE
  1572*        FREEKB
  1573*    END-EXEC.
  1574*    MOVE '8&      T  E F  H   F -   #00001473' TO DFHEIV0
  1575     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  1576     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  1577     MOVE X'2020233030303031343733' TO DFHEIV0(25:11)
  1578     CALL 'kxdfhei1' USING DFHEIV0,
  1579           LOGOFF-TEXT,
  1580           LOGOFF-LENGTH,
  1581           DFHEIV99,
  1582           DFHEIV99,
  1583           DFHEIV99,
  1584           DFHEIV99,
  1585           DFHEIV99,
  1586           DFHEIV99,
  1587           DFHEIV99,
  1588           DFHEIV99,
  1589           DFHEIV99,
  1590           DFHEIV99
  1591     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1592
  1593
  1594* EXEC CICS RETURN
  1595*    END-EXEC.
  1596*    MOVE '.(                    &   #00001479' TO DFHEIV0
  1597     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1598     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1599     MOVE X'2020233030303031343739' TO DFHEIV0(25:11)
  1600     CALL 'kxdfhei1' USING DFHEIV0,
  1601           DFHEIV99,
  1602           DFHEIV99,
  1603           DFHEIV99,
  1604           DFHEIV99,
  1605           DFHEIV99
  1606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1607
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6526.cbl
  1609 8600-DEEDIT.
  1610
  1611* EXEC CICS BIF DEEDIT
  1612*         FIELD(DEEDIT-FIELD)
  1613*         LENGTH(15)
  1614*    END-EXEC.
  1615     MOVE 15
  1616       TO DFHEIV11
  1617*    MOVE '@"L                   #   #00001483' TO DFHEIV0
  1618     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  1619     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1620     MOVE X'2020233030303031343833' TO DFHEIV0(25:11)
  1621     CALL 'kxdfhei1' USING DFHEIV0,
  1622           DEEDIT-FIELD,
  1623           DFHEIV11
  1624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1625
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6526.cbl
  1627 8800-UNAUTHORIZED-ACCESS.
  1628     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  1629     GO TO 8300-SEND-TEXT.
  1630 8810-PF23.
  1631     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  1632     MOVE XCTL-005               TO PGM-NAME.
  1633     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6526.cbl
  1635 9100-RETURN-TRAN.
  1636     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  1637     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  1638
  1639* EXEC CICS RETURN
  1640*        TRANSID    (TRANS-ID)
  1641*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  1642*        LENGTH     (WS-COMM-LENGTH)
  1643*    END-EXEC.
  1644*    MOVE '.(CT                  &   #00001499' TO DFHEIV0
  1645     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1646     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1647     MOVE X'2020233030303031343939' TO DFHEIV0(25:11)
  1648     CALL 'kxdfhei1' USING DFHEIV0,
  1649           TRANS-ID,
  1650           PROGRAM-INTERFACE-BLOCK,
  1651           WS-COMM-LENGTH,
  1652           DFHEIV99,
  1653           DFHEIV99
  1654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1655
  1656 9200-RETURN-MAIN-MENU.
  1657     MOVE XCTL-626               TO PGM-NAME.
  1658     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6526.cbl
  1660 9300-XCTL.
  1661
  1662* EXEC CICS XCTL
  1663*        PROGRAM    (PGM-NAME)
  1664*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  1665*        LENGTH     (WS-COMM-LENGTH)
  1666*    END-EXEC.
  1667*    MOVE '.$C                   $   #00001509' TO DFHEIV0
  1668     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  1669     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1670     MOVE X'2020233030303031353039' TO DFHEIV0(25:11)
  1671     CALL 'kxdfhei1' USING DFHEIV0,
  1672           PGM-NAME,
  1673           PROGRAM-INTERFACE-BLOCK,
  1674           WS-COMM-LENGTH
  1675     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1676
  1677 9400-CLEAR.
  1678     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  1679     GO TO 9300-XCTL.
  1680 9500-PF12.
  1681     MOVE XCTL-010               TO PGM-NAME.
  1682     GO TO 9300-XCTL.
  1683 9600-PGMID-ERROR.
  1684
  1685* EXEC CICS HANDLE CONDITION
  1686*        PGMIDERR    (8300-SEND-TEXT)
  1687*    END-EXEC.
  1688*    MOVE '"$L                   ! # #00001521' TO DFHEIV0
  1689     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  1690     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1691     MOVE X'2320233030303031353231' TO DFHEIV0(25:11)
  1692     CALL 'kxdfhei1' USING DFHEIV0
  1693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1694
  1695     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  1696     MOVE ' '                    TO PI-ENTRY-CD-1.
  1697     MOVE XCTL-005               TO PGM-NAME.
  1698     MOVE PGM-NAME               TO LOGOFF-PGM.
  1699     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  1700     GO TO 9300-XCTL.
  1701 9700-DATE-CONVERT.
  1702
  1703* EXEC CICS LINK
  1704*        PROGRAM    ('ELDATCV')
  1705*        COMMAREA   (DATE-CONVERSION-DATA)
  1706*        LENGTH     (DC-COMM-LENGTH)
  1707*    END-EXEC.
  1708     MOVE 'ELDATCV' TO DFHEIV1
  1709*    MOVE '."C                   ''   #00001531' TO DFHEIV0
  1710     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1711     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1712     MOVE X'2020233030303031353331' TO DFHEIV0(25:11)
  1713     CALL 'kxdfhei1' USING DFHEIV0,
  1714           DFHEIV1,
  1715           DATE-CONVERSION-DATA,
  1716           DC-COMM-LENGTH,
  1717           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6526.cbl
  1718           DFHEIV99,
  1719           DFHEIV99
  1720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1721
  1722 9700-EXIT.
  1723     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6526.cbl
  1725 9900-ERROR-FORMAT.
  1726     IF NOT EMI-ERRORS-COMPLETE
  1727         MOVE LINK-001           TO PGM-NAME
  1728
  1729* EXEC CICS LINK
  1730*            PROGRAM    (PGM-NAME)
  1731*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  1732*            LENGTH     (EMI-COMM-LENGTH)
  1733*        END-EXEC.
  1734*    MOVE '."C                   ''   #00001542' TO DFHEIV0
  1735     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1736     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1737     MOVE X'2020233030303031353432' TO DFHEIV0(25:11)
  1738     CALL 'kxdfhei1' USING DFHEIV0,
  1739           PGM-NAME,
  1740           ERROR-MESSAGE-INTERFACE-BLOCK,
  1741           EMI-COMM-LENGTH,
  1742           DFHEIV99,
  1743           DFHEIV99,
  1744           DFHEIV99
  1745     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1746
  1747 9900-EXIT.
  1748     EXIT.
  1749 9990-ABEND.
  1750     MOVE LINK-004               TO PGM-NAME.
  1751     MOVE DFHEIBLK               TO EMI-LINE1.
  1752
  1753* EXEC CICS LINK
  1754*        PROGRAM   (PGM-NAME)
  1755*        COMMAREA  (EMI-LINE1)
  1756*        LENGTH    (72)
  1757*    END-EXEC.
  1758     MOVE 72
  1759       TO DFHEIV11
  1760*    MOVE '."C                   ''   #00001552' TO DFHEIV0
  1761     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1762     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1763     MOVE X'2020233030303031353532' TO DFHEIV0(25:11)
  1764     CALL 'kxdfhei1' USING DFHEIV0,
  1765           PGM-NAME,
  1766           EMI-LINE1,
  1767           DFHEIV11,
  1768           DFHEIV99,
  1769           DFHEIV99,
  1770           DFHEIV99
  1771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1772
  1773     GO TO 8200-SEND-DATAONLY.
  1774 9995-SECURITY-VIOLATION.
  1775*           COPY ELCSCTP.
  1776******************************************************************
  1777*                                                                *
  1778*                            ELCSCTP                             *
  1779*                            VMOD=2.001                          *
  1780*                                                                *
  1781*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  1782******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6526.cbl
  1783
  1784
  1785     MOVE EIBDATE          TO SM-JUL-DATE.
  1786     MOVE EIBTRMID         TO SM-TERMID.
  1787     MOVE THIS-PGM         TO SM-PGM.
  1788     MOVE EIBTIME          TO TIME-IN.
  1789     MOVE TIME-OUT         TO SM-TIME.
  1790     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  1791
  1792
  1793* EXEC CICS LINK
  1794*         PROGRAM  ('EL003')
  1795*         COMMAREA (SECURITY-MESSAGE)
  1796*         LENGTH   (80)
  1797*    END-EXEC.
  1798     MOVE 'EL003' TO DFHEIV1
  1799     MOVE 80
  1800       TO DFHEIV11
  1801*    MOVE '."C                   ''   #00001576' TO DFHEIV0
  1802     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1803     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1804     MOVE X'2020233030303031353736' TO DFHEIV0(25:11)
  1805     CALL 'kxdfhei1' USING DFHEIV0,
  1806           DFHEIV1,
  1807           SECURITY-MESSAGE,
  1808           DFHEIV11,
  1809           DFHEIV99,
  1810           DFHEIV99,
  1811           DFHEIV99
  1812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1813
  1814
  1815******************************************************************
  1816
  1817 9995-EXIT.
  1818      EXIT.
  1819
  1820 9999-DFHBACK SECTION.
  1821     MOVE '9%                    "   ' TO DFHEIV0
  1822     MOVE 'EL6526' TO DFHEIV1
  1823     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1824     GOBACK.
  1825 9999-DFHEXIT.
  1826     IF DFHEIGDJ EQUAL 0001
  1827         NEXT SENTENCE
  1828     ELSE IF DFHEIGDJ EQUAL 2
  1829         GO TO 9600-PGMID-ERROR,
  1830               9990-ABEND
  1831         DEPENDING ON DFHEIGDI
  1832     ELSE IF DFHEIGDJ EQUAL 3
  1833         GO TO 8300-SEND-TEXT
  1834         DEPENDING ON DFHEIGDI.
  1835     MOVE '9%                    "   ' TO DFHEIV0
  1836     MOVE 'EL6526' TO DFHEIV1
  1837     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1838     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6526.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4504     Code:        3463
