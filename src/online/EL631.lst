* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   1
* EL631.cbl
* Options: int("EL631.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL631.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL631.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL631.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL631.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 16:44:20.
     7*                            VMOD=2.021.
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   2
* EL631.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22
    23*REMARKS.    TRANSACTION - EXB0 - NEW BUSINESS
    24*                                 REVIEW AND CORRECTION
    25
    26******************************************************************
    27*                   C H A N G E   L O G
    28*
    29* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    30*-----------------------------------------------------------------
    31*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    32* EFFECTIVE    NUMBER
    33*-----------------------------------------------------------------
    34* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    35******************************************************************
    36 ENVIRONMENT DIVISION.
    37
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   3
* EL631.cbl
    39 DATA DIVISION.
    40 WORKING-STORAGE SECTION.
    41 01  DFH-START PIC X(04).
    42 77  FILLER  PIC X(32)  VALUE '********************************'.
    43 77  FILLER  PIC X(32)  VALUE '*    EL631   WORKING STORAGE   *'.
    44 77  FILLER  PIC X(32)  VALUE '************VMOD=2.021 *********'.
    45
    46*    COPY ELCSCTM.
    47******************************************************************
    48*                                                                *
    49*                                                                *
    50*                            ELCSCTM                             *
    51*                            VMOD=2.001                          *
    52*                                                                *
    53*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    54*                                                                *
    55******************************************************************
    56 01  SECURITY-MESSAGE.
    57     12  FILLER                          PIC X(30)
    58            VALUE '** LOGIC SECURITY VIOLATION -'.
    59     12  SM-READ                         PIC X(6).
    60     12  FILLER                          PIC X(5)
    61            VALUE ' PGM='.
    62     12  SM-PGM                          PIC X(6).
    63     12  FILLER                          PIC X(5)
    64            VALUE ' OPR='.
    65     12  SM-PROCESSOR-ID                 PIC X(4).
    66     12  FILLER                          PIC X(6)
    67            VALUE ' TERM='.
    68     12  SM-TERMID                       PIC X(4).
    69     12  FILLER                          PIC XX   VALUE SPACE.
    70     12  SM-JUL-DATE                     PIC 9(5).
    71     12  FILLER                          PIC X    VALUE SPACE.
    72     12  SM-TIME                         PIC 99.99.
    73
    74*    COPY ELCSCRTY.
    75******************************************************************
    76*                                                                *
    77*                                                                *
    78*                            ELCSCRTY                            *
    79*                            VMOD=2.001                          *
    80*                                                                *
    81*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    82*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    83*        SAVED IN PI-SECURITY-ADDRESS.                           *
    84*                                                                *
    85******************************************************************
    86 01  SECURITY-CONTROL.
    87     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    88     12  FILLER                       PIC XX    VALUE 'SC'.
    89     12  SC-CREDIT-CODES.
    90         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    91             20  SC-CREDIT-DISPLAY    PIC X.
    92             20  SC-CREDIT-UPDATE     PIC X.
    93     12  SC-CLAIMS-CODES.
    94         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    95             20  SC-CLAIMS-DISPLAY    PIC X.
    96             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   4
* EL631.cbl
    97
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   5
* EL631.cbl
    99
   100 01  WS-DATE-AREA.
   101     05  SAVE-DATE               PIC X(8)    VALUE SPACES.
   102     05  SAVE-BIN-DATE           PIC X(2)    VALUE SPACES.
   103
   104 01  STANDARD-AREAS.
   105     12  SC-ITEM                 PIC S9(4) COMP VALUE +1.
   106     12  MAP-NAME                PIC X(8)    VALUE 'EL631A'.
   107     12  MAPSET-NAME             PIC X(8)    VALUE 'EL631S'.
   108     12  SCREEN-NUMBER           PIC X(4)    VALUE '631A'.
   109     12  TRANS-ID                PIC X(4)    VALUE 'EXB0'.
   110     12  THIS-PGM                PIC X(8)    VALUE 'EL631'.
   111     12  PGM-NAME                PIC X(8).
   112     12  TIME-IN                 PIC S9(7).
   113     12  TIME-OUT-R  REDEFINES TIME-IN.
   114         16  FILLER              PIC X.
   115         16  TIME-OUT            PIC 99V99.
   116         16  FILLER              PIC XX.
   117     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   118     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   119     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   120     12  XCTL-6311               PIC X(8)    VALUE 'EL6311'.
   121     12  XCTL-630                PIC X(8)    VALUE 'EL630'.
   122     12  XCTL-656                PIC X(8)    VALUE 'EL656'.
   123     12  XCTL-663                PIC X(8)    VALUE 'EL663'.
   124     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   125     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   126     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   127     12  FILE-ID                 PIC X(8)    VALUE SPACES.
   128     12  ERPNDB-FILE-ID          PIC X(8)    VALUE 'ERPNDB'.
   129     12  ERPNDB3-FILE-ID         PIC X(8)    VALUE 'ERPNDB3'.
   130     12  ERACCT2-FILE-ID         PIC X(8)    VALUE 'ERACCT2'.
   131
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   6
* EL631.cbl
   133
   134 01  ERROR-MESSAGES.
   135     12  ER-0004                 PIC X(4)  VALUE '0004'.
   136     12  ER-0008                 PIC X(4)  VALUE '0008'.
   137     12  ER-0029                 PIC X(4)  VALUE '0029'.
   138     12  ER-0033                 PIC X(4)  VALUE '0033'.
   139     12  ER-0070                 PIC X(4)  VALUE '0070'.
   140     12  ER-0144                 PIC X(4)  VALUE '0144'.
   141     12  ER-0179                 PIC X(4)  VALUE '0179'.
   142     12  ER-0193                 PIC X(4)  VALUE '0193'.
   143     12  ER-0195                 PIC X(4)  VALUE '0195'.
   144     12  ER-0329                 PIC X(4)  VALUE '0329'.
   145     12  ER-0348                 PIC X(4)  VALUE '0348'.
   146     12  ER-2059                 PIC X(4)  VALUE '2059'.
   147     12  ER-2150                 PIC X(4)  VALUE '2150'.
   148     12  ER-2190                 PIC X(4)  VALUE '2190'.
   149     12  ER-2191                 PIC X(4)  VALUE '2191'.
   150     12  ER-2192                 PIC X(4)  VALUE '2192'.
   151     12  ER-2193                 PIC X(4)  VALUE '2193'.
   152     12  ER-2201                 PIC X(4)  VALUE '2201'.
   153     12  ER-2314                 PIC X(4)  VALUE '2314'.
   154     12  ER-2372                 PIC X(4)  VALUE '2372'.
   155     12  ER-2375                 PIC X(4)  VALUE '2375'.
   156     12  ER-2377                 PIC X(4)  VALUE '2377'.
   157     12  ER-2971                 PIC X(4)  VALUE '2971'.
   158
   159     12  DEEDIT-FIELD            PIC X(15).
   160     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   161
   162     12  CLIENT-MIC              PIC X(3)  VALUE 'MIC'.
   163     12  CLIENT-PEM              PIC X(3)  VALUE 'PEM'.
   164     12  CLIENT-CSO              PIC X(3)  VALUE 'CSO'.
   165     12  CLIENT-FLA              PIC X(3)  VALUE 'FLA'.
   166
   167     12  WS-ACCT-KEY.
   168         16  FILLER              PIC X(20).
   169         16  WS-EFF-DT           PIC XX.
   170
   171     12  RETURN-FROM             PIC X(8).
   172     12  QID.
   173         16  QID-TERM            PIC X(4).
   174         16  FILLER              PIC X(4)    VALUE '631A'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   7
* EL631.cbl
   176*    COPY ELCDATE.
   177******************************************************************
   178*                                                                *
   179*                                                                *
   180*                            ELCDATE.                            *
   181*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   182*                            VMOD=2.003
   183*                                                                *
   184*                                                                *
   185*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   186*                 LENGTH = 200                                   *
   187******************************************************************
   188
   189 01  DATE-CONVERSION-DATA.
   190     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   191     12  DC-OPTION-CODE                PIC X.
   192         88  BIN-TO-GREG                VALUE ' '.
   193         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   194         88  EDIT-GREG-TO-BIN           VALUE '2'.
   195         88  YMD-GREG-TO-BIN            VALUE '3'.
   196         88  MDY-GREG-TO-BIN            VALUE '4'.
   197         88  JULIAN-TO-BIN              VALUE '5'.
   198         88  BIN-PLUS-ELAPSED           VALUE '6'.
   199         88  FIND-CENTURY               VALUE '7'.
   200         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   201         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   202         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   203         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   204         88  JULIAN-TO-BIN-3            VALUE 'C'.
   205         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   206         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   207         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   208         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   209         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   210         88  CHECK-LEAP-YEAR            VALUE 'H'.
   211         88  BIN-3-TO-GREG              VALUE 'I'.
   212         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   213         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   214         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   215         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   216         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   217         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   218         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   219         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   220         88  THREE-CHARACTER-BIN
   221                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   222         88  GREGORIAN-TO-BIN
   223                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   224         88  BIN-TO-GREGORIAN
   225                  VALUES ' ' '1' 'I' '8' 'G'.
   226         88  JULIAN-TO-BINARY
   227                  VALUES '5' 'C' 'E' 'F'.
   228     12  DC-ERROR-CODE                 PIC X.
   229         88  NO-CONVERSION-ERROR        VALUE ' '.
   230         88  DATE-CONVERSION-ERROR
   231                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   232         88  DATE-IS-ZERO               VALUE '1'.
   233         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   8
* EL631.cbl
   234         88  DATE-IS-INVALID            VALUE '3'.
   235         88  DATE1-GREATER-DATE2        VALUE '4'.
   236         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   237         88  DATE-INVALID-OPTION        VALUE '9'.
   238         88  INVALID-CENTURY            VALUE 'A'.
   239         88  ONLY-CENTURY               VALUE 'B'.
   240         88  ONLY-LEAP-YEAR             VALUE 'C'.
   241         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   242     12  DC-END-OF-MONTH               PIC X.
   243         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   244     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   245         88  USE-NORMAL-PROCESS         VALUE ' '.
   246         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   247         88  ADJUST-UP-100-YRS          VALUE '2'.
   248     12  FILLER                        PIC X.
   249     12  DC-CONVERSION-DATES.
   250         16  DC-BIN-DATE-1             PIC XX.
   251         16  DC-BIN-DATE-2             PIC XX.
   252         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   253         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   254                       DC-GREG-DATE-1-EDIT.
   255             20  DC-EDIT1-MONTH        PIC 99.
   256             20  SLASH1-1              PIC X.
   257             20  DC-EDIT1-DAY          PIC 99.
   258             20  SLASH1-2              PIC X.
   259             20  DC-EDIT1-YEAR         PIC 99.
   260         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   261         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   262                     DC-GREG-DATE-2-EDIT.
   263             20  DC-EDIT2-MONTH        PIC 99.
   264             20  SLASH2-1              PIC X.
   265             20  DC-EDIT2-DAY          PIC 99.
   266             20  SLASH2-2              PIC X.
   267             20  DC-EDIT2-YEAR         PIC 99.
   268         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   269         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   270                     DC-GREG-DATE-1-YMD.
   271             20  DC-YMD-YEAR           PIC 99.
   272             20  DC-YMD-MONTH          PIC 99.
   273             20  DC-YMD-DAY            PIC 99.
   274         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   275         16  DC-GREG-DATE-1-MDY-R REDEFINES
   276                      DC-GREG-DATE-1-MDY.
   277             20  DC-MDY-MONTH          PIC 99.
   278             20  DC-MDY-DAY            PIC 99.
   279             20  DC-MDY-YEAR           PIC 99.
   280         16  DC-GREG-DATE-1-ALPHA.
   281             20  DC-ALPHA-MONTH        PIC X(10).
   282             20  DC-ALPHA-DAY          PIC 99.
   283             20  FILLER                PIC XX.
   284             20  DC-ALPHA-CENTURY.
   285                 24 DC-ALPHA-CEN-N     PIC 99.
   286             20  DC-ALPHA-YEAR         PIC 99.
   287         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   288         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   289         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   290         16  DC-JULIAN-DATE            PIC 9(05).
   291         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page   9
* EL631.cbl
   292                                       PIC 9(05).
   293         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   294             20  DC-JULIAN-YEAR        PIC 99.
   295             20  DC-JULIAN-DAYS        PIC 999.
   296         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   297         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   298         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   299     12  DATE-CONVERSION-VARIBLES.
   300         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   301         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   302             20  FILLER                PIC 9(3).
   303             20  HOLD-CEN-1-CCYY.
   304                 24  HOLD-CEN-1-CC     PIC 99.
   305                 24  HOLD-CEN-1-YY     PIC 99.
   306             20  HOLD-CEN-1-MO         PIC 99.
   307             20  HOLD-CEN-1-DA         PIC 99.
   308         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   309             20  HOLD-CEN-1-R-MO       PIC 99.
   310             20  HOLD-CEN-1-R-DA       PIC 99.
   311             20  HOLD-CEN-1-R-CCYY.
   312                 24  HOLD-CEN-1-R-CC   PIC 99.
   313                 24  HOLD-CEN-1-R-YY   PIC 99.
   314             20  FILLER                PIC 9(3).
   315         16  HOLD-CENTURY-1-X.
   316             20  FILLER                PIC X(3)  VALUE SPACES.
   317             20  HOLD-CEN-1-X-CCYY.
   318                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   319                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   320             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   321             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   322         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   323             20  HOLD-CEN-1-R-X-MO     PIC XX.
   324             20  HOLD-CEN-1-R-X-DA     PIC XX.
   325             20  HOLD-CEN-1-R-X-CCYY.
   326                 24  HOLD-CEN-1-R-X-CC PIC XX.
   327                 24  HOLD-CEN-1-R-X-YY PIC XX.
   328             20  FILLER                PIC XXX.
   329         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   330         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   331         16  DC-JULIAN-DATE-1          PIC 9(07).
   332         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   333             20  DC-JULIAN-1-CCYY.
   334                 24  DC-JULIAN-1-CC    PIC 99.
   335                 24  DC-JULIAN-1-YR    PIC 99.
   336             20  DC-JULIAN-DA-1        PIC 999.
   337         16  DC-JULIAN-DATE-2          PIC 9(07).
   338         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   339             20  DC-JULIAN-2-CCYY.
   340                 24  DC-JULIAN-2-CC    PIC 99.
   341                 24  DC-JULIAN-2-YR    PIC 99.
   342             20  DC-JULIAN-DA-2        PIC 999.
   343         16  DC-GREG-DATE-A-EDIT.
   344             20  DC-EDITA-MONTH        PIC 99.
   345             20  SLASHA-1              PIC X VALUE '/'.
   346             20  DC-EDITA-DAY          PIC 99.
   347             20  SLASHA-2              PIC X VALUE '/'.
   348             20  DC-EDITA-CCYY.
   349                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  10
* EL631.cbl
   350                 24  DC-EDITA-YEAR     PIC 99.
   351         16  DC-GREG-DATE-B-EDIT.
   352             20  DC-EDITB-MONTH        PIC 99.
   353             20  SLASHB-1              PIC X VALUE '/'.
   354             20  DC-EDITB-DAY          PIC 99.
   355             20  SLASHB-2              PIC X VALUE '/'.
   356             20  DC-EDITB-CCYY.
   357                 24  DC-EDITB-CENT     PIC 99.
   358                 24  DC-EDITB-YEAR     PIC 99.
   359         16  DC-GREG-DATE-CYMD         PIC 9(08).
   360         16  DC-GREG-DATE-CYMD-R REDEFINES
   361                              DC-GREG-DATE-CYMD.
   362             20  DC-CYMD-CEN           PIC 99.
   363             20  DC-CYMD-YEAR          PIC 99.
   364             20  DC-CYMD-MONTH         PIC 99.
   365             20  DC-CYMD-DAY           PIC 99.
   366         16  DC-GREG-DATE-MDCY         PIC 9(08).
   367         16  DC-GREG-DATE-MDCY-R REDEFINES
   368                              DC-GREG-DATE-MDCY.
   369             20  DC-MDCY-MONTH         PIC 99.
   370             20  DC-MDCY-DAY           PIC 99.
   371             20  DC-MDCY-CEN           PIC 99.
   372             20  DC-MDCY-YEAR          PIC 99.
   373    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   374        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   375    12  DC-EL310-DATE                  PIC X(21).
   376    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  11
* EL631.cbl
   378*    COPY ELCLOGOF.
   379******************************************************************
   380*                                                                *
   381*                                                                *
   382*                            ELCLOGOF.                           *
   383*                            VMOD=2.001                          *
   384*                                                                *
   385*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   386*                                                                *
   387******************************************************************
   388 01  CLASIC-LOGOFF.
   389     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   390     12  LOGOFF-TEXT.
   391         16  FILLER          PIC X(5)    VALUE SPACES.
   392         16  LOGOFF-MSG.
   393             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   394             20  FILLER      PIC X       VALUE SPACES.
   395             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   396         16  FILLER          PIC X(80)
   397           VALUE '* YOU ARE NOW LOGGED OFF'.
   398         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   399         16  FILLER          PIC X       VALUE QUOTE.
   400         16  LOGOFF-SYS-MSG  PIC X(17)
   401           VALUE 'S CLAS-IC SYSTEM '.
   402     12  TEXT-MESSAGES.
   403         16  UNACCESS-MSG    PIC X(29)
   404             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   405         16  PGMIDERR-MSG    PIC X(17)
   406             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  12
* EL631.cbl
   408*    COPY ELCATTR.
   409******************************************************************
   410*                                                                *
   411*                            ELCATTR.                            *
   412*                            VMOD=2.001                          *
   413*                                                                *
   414*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   415*                                                                *
   416*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   417*                                                                *
   418*                   POS 1   P=PROTECTED                          *
   419*                           U=UNPROTECTED                        *
   420*                           S=ASKIP                              *
   421*                   POS 2   A=ALPHA/NUMERIC                      *
   422*                           N=NUMERIC                            *
   423*                   POS 3   N=NORMAL                             *
   424*                           B=BRIGHT                             *
   425*                           D=DARK                               *
   426*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   427*                           OF=MODIFIED DATA TAG OFF             *
   428*                                                                *
   429*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   430******************************************************************
   431 01  ATTRIBUTE-LIST.
   432     12  AL-PABOF            PIC X       VALUE 'Y'.
   433     12  AL-PABON            PIC X       VALUE 'Z'.
   434     12  AL-PADOF            PIC X       VALUE '%'.
   435     12  AL-PADON            PIC X       VALUE '_'.
   436     12  AL-PANOF            PIC X       VALUE '-'.
   437     12  AL-PANON            PIC X       VALUE '/'.
   438     12  AL-SABOF            PIC X       VALUE '8'.
   439     12  AL-SABON            PIC X       VALUE '9'.
   440     12  AL-SADOF            PIC X       VALUE '@'.
   441     12  AL-SADON            PIC X       VALUE QUOTE.
   442     12  AL-SANOF            PIC X       VALUE '0'.
   443     12  AL-SANON            PIC X       VALUE '1'.
   444     12  AL-UABOF            PIC X       VALUE 'H'.
   445     12  AL-UABON            PIC X       VALUE 'I'.
   446     12  AL-UADOF            PIC X       VALUE '<'.
   447     12  AL-UADON            PIC X       VALUE '('.
   448     12  AL-UANOF            PIC X       VALUE ' '.
   449     12  AL-UANON            PIC X       VALUE 'A'.
   450     12  AL-UNBOF            PIC X       VALUE 'Q'.
   451     12  AL-UNBON            PIC X       VALUE 'R'.
   452     12  AL-UNDOF            PIC X       VALUE '*'.
   453     12  AL-UNDON            PIC X       VALUE ')'.
   454     12  AL-UNNOF            PIC X       VALUE '&'.
   455     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  13
* EL631.cbl
   457*    COPY ELCEMIB.
   458******************************************************************
   459*                                                                *
   460*                                                                *
   461*                            ELCEMIB.                            *
   462*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   463*                            VMOD=2.005                          *
   464*                                                                *
   465*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   466*                                                                *
   467******************************************************************
   468 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   469     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   470     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   471     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   472     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   473     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   474     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   475     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   476     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   477     12  EMI-SWITCH1             PIC X        VALUE '1'.
   478         88  EMI-NO-ERRORS                    VALUE '1'.
   479         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   480         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   481     12  EMI-SWITCH2             PIC X        VALUE '1'.
   482         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   483     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   484         88  EMI-AREA1-EMPTY                  VALUE '1'.
   485         88  EMI-AREA1-FULL                   VALUE '2'.
   486     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   487         88  EMI-AREA2-EMPTY                  VALUE '1'.
   488         88  EMI-AREA2-FULL                   VALUE '2'.
   489     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   490         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   491         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   492         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   493         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   494         88  EMI-BYPASS-FATALS                VALUE 'X'.
   495     12  EMI-ERROR-LINES.
   496         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   497         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   498         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   499         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   500             20  EMI-ERR-CODES OCCURS 10 TIMES.
   501                 24  EMI-ERR-NUM         PIC X(4).
   502                 24  EMI-FILLER          PIC X.
   503                 24  EMI-SEV             PIC X.
   504                 24  FILLER              PIC X.
   505             20  FILLER                  PIC X(02).
   506     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   507         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   508             20  EMI-ERROR-NUMBER    PIC X(4).
   509             20  EMI-FILL            PIC X.
   510             20  EMI-SEVERITY        PIC X.
   511             20  FILLER              PIC X.
   512             20  EMI-ERROR-TEXT.
   513                 24  EMI-TEXT-VARIABLE   PIC X(10).
   514                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  14
* EL631.cbl
   515     12  EMI-SEVERITY-SAVE           PIC X.
   516         88  EMI-NOTE                    VALUE 'N'.
   517         88  EMI-WARNING                 VALUE 'W'.
   518         88  EMI-FORCABLE                VALUE 'F'.
   519         88  EMI-FATAL                   VALUE 'X'.
   520     12  EMI-MESSAGE-FLAG            PIC X.
   521         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   522         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   523     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   524     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   525         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   526         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   527         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   528     12  emi-claim-no                pic x(7).
   529     12  emi-claim-type              pic x(6).
   530     12  FILLER                      PIC X(124)  VALUE SPACES.
   531     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   532     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   533     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   534     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  15
* EL631.cbl
   536*    COPY ELCINTF.
   537******************************************************************
   538*                                                                *
   539*                                                                *
   540*                            ELCINTF.                            *
   541*                            VMOD=2.017                          *
   542*                                                                *
   543*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   544*                                                                *
   545*       LENGTH = 1024                                            *
   546*                                                                *
   547******************************************************************
   548*                   C H A N G E   L O G
   549*
   550* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   551*-----------------------------------------------------------------
   552*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   553* EFFECTIVE    NUMBER
   554*-----------------------------------------------------------------
   555* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   556******************************************************************
   557 01  PROGRAM-INTERFACE-BLOCK.
   558     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   559     12  PI-CALLING-PROGRAM              PIC X(8).
   560     12  PI-SAVED-PROGRAM-1              PIC X(8).
   561     12  PI-SAVED-PROGRAM-2              PIC X(8).
   562     12  PI-SAVED-PROGRAM-3              PIC X(8).
   563     12  PI-SAVED-PROGRAM-4              PIC X(8).
   564     12  PI-SAVED-PROGRAM-5              PIC X(8).
   565     12  PI-SAVED-PROGRAM-6              PIC X(8).
   566     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   567     12  PI-COMPANY-ID                   PIC XXX.
   568     12  PI-COMPANY-CD                   PIC X.
   569
   570     12  PI-COMPANY-PASSWORD             PIC X(8).
   571
   572     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   573
   574     12  PI-CONTROL-IN-PROGRESS.
   575         16  PI-CARRIER                  PIC X.
   576         16  PI-GROUPING                 PIC X(6).
   577         16  PI-STATE                    PIC XX.
   578         16  PI-ACCOUNT                  PIC X(10).
   579         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   580                                         PIC X(10).
   581         16  PI-CLAIM-CERT-GRP.
   582             20  PI-CLAIM-NO             PIC X(7).
   583             20  PI-CERT-NO.
   584                 25  PI-CERT-PRIME       PIC X(10).
   585                 25  PI-CERT-SFX         PIC X.
   586             20  PI-CERT-EFF-DT          PIC XX.
   587         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   588             20  PI-PLAN-CODE            PIC X(2).
   589             20  PI-REVISION-NUMBER      PIC X(3).
   590             20  PI-PLAN-EFF-DT          PIC X(2).
   591             20  PI-PLAN-EXP-DT          PIC X(2).
   592             20  FILLER                  PIC X(11).
   593         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  16
* EL631.cbl
   594             20  PI-OE-REFERENCE-1.
   595                 25  PI-OE-REF-1-PRIME   PIC X(18).
   596                 25  PI-OE-REF-1-SUFF    PIC XX.
   597
   598     12  PI-SESSION-IN-PROGRESS          PIC X.
   599         88  CLAIM-SESSION                   VALUE '1'.
   600         88  CREDIT-SESSION                  VALUE '2'.
   601         88  WARRANTY-SESSION                VALUE '3'.
   602         88  MORTGAGE-SESSION                VALUE '4'.
   603         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   604
   605
   606*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   607
   608     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   609     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   610
   611     12  PI-CREDIT-USER                  PIC X.
   612         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   613         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   614
   615     12  PI-CLAIM-USER                   PIC X.
   616         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   617         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   618
   619     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   620         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   621         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   622         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   623         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   624         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   625
   626     12  PI-PROCESSOR-ID                 PIC X(4).
   627
   628     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   629
   630     12  PI-MEMBER-CAPTION               PIC X(10).
   631
   632     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   633         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   634
   635     12  PI-LIFE-OVERRIDE-L1             PIC X.
   636     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   637     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   638     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   639
   640     12  PI-AH-OVERRIDE-L1               PIC X.
   641     12  PI-AH-OVERRIDE-L2               PIC XX.
   642     12  PI-AH-OVERRIDE-L6               PIC X(6).
   643     12  PI-AH-OVERRIDE-L12              PIC X(12).
   644
   645     12  PI-NEW-SYSTEM                   PIC X(2).
   646
   647     12  PI-PRIMARY-CERT-NO              PIC X(11).
   648     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   649         88  PI-USES-PAID-TO                 VALUE '1'.
   650     12  PI-CRDTCRD-SYSTEM.
   651         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  17
* EL631.cbl
   652             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   653             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   654         16  PI-CC-MONTH-END-DT          PIC XX.
   655     12  PI-PROCESSOR-PRINTER            PIC X(4).
   656
   657     12  PI-OE-REFERENCE-2.
   658         16  PI-OE-REF-2-PRIME           PIC X(10).
   659         16  PI-OE-REF-2-SUFF            PIC X.
   660
   661     12  PI-REM-TRM-CALC-OPTION          PIC X.
   662
   663     12  PI-LANGUAGE-TYPE                PIC X.
   664             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   665             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   666             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   667
   668     12  PI-POLICY-LINKAGE-IND           PIC X.
   669         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   670         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   671                                                   LOW-VALUES.
   672
   673     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   674     12  PI-CLAIM-PW-SESSION             PIC X(1).
   675         88  PI-CLAIM-CREDIT                 VALUE '1'.
   676         88  PI-CLAIM-CONVEN                 VALUE '2'.
   677
   678     12  PI-PROCESSOR-CSR-IND            PIC X.
   679         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   680         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   681
   682     12  FILLER                          PIC X(3).
   683
   684     12  PI-SYSTEM-LEVEL                 PIC X(145).
   685
   686     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   687         PI-SYSTEM-LEVEL.
   688
   689         16  PI-ENTRY-CODES.
   690             20  PI-ENTRY-CD-1           PIC X.
   691             20  PI-ENTRY-CD-2           PIC X.
   692
   693         16  PI-RETURN-CODES.
   694             20  PI-RETURN-CD-1          PIC X.
   695             20  PI-RETURN-CD-2          PIC X.
   696
   697         16  PI-UPDATE-STATUS-SAVE.
   698             20  PI-UPDATE-BY            PIC X(4).
   699             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   700
   701         16  PI-LOWER-CASE-LETTERS       PIC X.
   702             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   703
   704*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   705*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   706*            88  CARRIER-CLM-CNTL            VALUE '2'.
   707
   708         16  PI-CERT-ACCESS-CONTROL      PIC X.
   709             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  18
* EL631.cbl
   710             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   711             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   712             88  ACCNT-CNTL                  VALUE '3'.
   713             88  CARR-ACCNT-CNTL             VALUE '4'.
   714
   715         16  PI-PROCESSOR-CAP-LIST.
   716             20  PI-SYSTEM-CONTROLS.
   717                24 PI-SYSTEM-DISPLAY     PIC X.
   718                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   719                24 PI-SYSTEM-MODIFY      PIC X.
   720                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   721             20  FILLER                  PIC XX.
   722             20  PI-DISPLAY-CAP          PIC X.
   723                 88  DISPLAY-CAP             VALUE 'Y'.
   724             20  PI-MODIFY-CAP           PIC X.
   725                 88  MODIFY-CAP              VALUE 'Y'.
   726             20  PI-MSG-AT-LOGON-CAP     PIC X.
   727                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   728             20  PI-FORCE-CAP            PIC X.
   729                 88  FORCE-CAP               VALUE 'Y'.
   730
   731         16  PI-PROGRAM-CONTROLS.
   732             20  PI-PGM-PRINT-OPT        PIC X.
   733             20  PI-PGM-FORMAT-OPT       PIC X.
   734             20  PI-PGM-PROCESS-OPT      PIC X.
   735             20  PI-PGM-TOTALS-OPT       PIC X.
   736
   737         16  PI-HELP-INTERFACE.
   738             20  PI-LAST-ERROR-NO        PIC X(4).
   739             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   740
   741         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   742             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   743
   744         16  PI-CR-CONTROL-IN-PROGRESS.
   745             20  PI-CR-CARRIER           PIC X.
   746             20  PI-CR-GROUPING          PIC X(6).
   747             20  PI-CR-STATE             PIC XX.
   748             20  PI-CR-ACCOUNT           PIC X(10).
   749             20  PI-CR-FIN-RESP          PIC X(10).
   750             20  PI-CR-TYPE              PIC X.
   751
   752         16  PI-CR-BATCH-NUMBER          PIC X(6).
   753
   754         16  PI-CR-MONTH-END-DT          PIC XX.
   755
   756         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   757             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   758             88  PI-ZERO-CARRIER             VALUE '1'.
   759             88  PI-ZERO-GROUPING            VALUE '2'.
   760             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   761
   762         16  PI-CARRIER-SECURITY         PIC X.
   763             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   764
   765         16  PI-ACCOUNT-SECURITY         PIC X(10).
   766             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   767             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  19
* EL631.cbl
   768
   769         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   770             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   771                                         INDEXED BY PI-ACCESS-NDX
   772                                         PIC X.
   773
   774         16  PI-GA-BILLING-CONTROL       PIC X.
   775             88  PI-GA-BILLING               VALUE '1'.
   776
   777         16  PI-MAIL-PROCESSING          PIC X.
   778             88  PI-MAIL-YES                 VALUE 'Y'.
   779
   780         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   781
   782         16  PI-AR-SYSTEM.
   783             20  PI-AR-PROCESSING-CNTL   PIC X.
   784                 88  PI-AR-PROCESSING        VALUE 'Y'.
   785             20  PI-AR-SUMMARY-CODE      PIC X(6).
   786             20  PI-AR-MONTH-END-DT      PIC XX.
   787
   788         16  PI-MP-SYSTEM.
   789             20  PI-MORTGAGE-USER            PIC X.
   790                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   791                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   792             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   793                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   794                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   795                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   796                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   797                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   798             20  PI-MP-MONTH-END-DT          PIC XX.
   799             20  PI-MP-REFERENCE-NO.
   800                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   801                 24  PI-MP-REFERENCE-SFX     PIC XX.
   802
   803         16  PI-LABEL-CONTROL            PIC X(01).
   804             88  PI-CREATE-LABELS                    VALUE 'Y'.
   805             88  PI-BYPASS-LABELS                    VALUE 'N'.
   806
   807         16  PI-BILL-GROUPING-CODE       PIC X(01).
   808             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   809
   810         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   811             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   812             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   813
   814         16  FILLER                      PIC X(14).
   815
   816     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   817******************************************************************
   818     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   819*    COPY ELC631PI.
   820******************************************************************
   821*                                                                *
   822*                                                                *
   823*                            ELC631PI                            *
   824*                            VMOD=2.012                          *
   825*                                                                *
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  20
* EL631.cbl
   826*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
   827*    REVIEW AND CORRRECTION SUB-SYSTEM.  ANY CHANGES WILL        *
   828*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
   829*                                                                *
   830*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
   831*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
   832*    BETWEEN PROGRAMS.                                           *
   833*                                                                *
   834*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
   835*                                                                *
   836*               EL631 - EL6311 - EL6312 - EL6313                 *
   837*                                                                *
   838******************************************************************
   839*                   C H A N G E   L O G
   840*
   841* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   842*-----------------------------------------------------------------
   843*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   844* EFFECTIVE    NUMBER
   845*-----------------------------------------------------------------
   846* 021414    2003053000001  PEMA  changes for auto chk request
   847******************************************************************
   848
   849         16  PI-631-DATA.
   850             20  PI-ERPNDB-KEY.
   851                 24  PI-PB-COMPANY-CD     PIC X.
   852                 24  PI-PB-ENTRY-BATCH    PIC X(6).
   853                 24  PI-PB-BATCH-SEQ-NO   PIC S9(4) COMP.
   854                 24  PI-PB-BATCH-CHG-SEQ-NO PIC S9(4) COMP.
   855
   856             20  PI-ERPNDB-ALT-KEY.
   857                 24  PI-PB-COMPANY-CD-A1  PIC X.
   858                 24  PI-PB-CARRIER        PIC X.
   859                 24  PI-PB-GROUPING       PIC X(6).
   860                 24  PI-PB-STATE          PIC XX.
   861                 24  PI-PB-ACCOUNT        PIC X(10).
   862                 24  PI-PB-CERT-EFF-DT    PIC XX.
   863                 24  PI-PB-CERT-NO.
   864                     28  PI-PB-CERT-PRIME PIC X(10).
   865                     28  PI-PB-CERT-SFX   PIC X.
   866                 24  PI-PB-ALT-CHG-SEQ-NO PIC S9(4) COMP.
   867                 24  PI-PB-RECORD-TYPE    PIC X.
   868
   869             20  PI-ERPNDB-CSR-KEY.
   870                 24  PI-PB-CSR-COMPANY-CD-A2  PIC X.
   871                 24  PI-PB-CSR-ID             PIC X(4).
   872                 24  PI-PB-CSR-ENTRY-BATCH    PIC X(6).
   873                 24  PI-PB-CSR-BTCH-SEQ-NO    PIC S9(4) COMP.
   874                 24  PI-PB-CSR-BTCH-CHG-SEQ-NO PIC S9(4) COMP.
   875
   876             20  PI-BROWSE-TYPE               PIC X.
   877                 88  PI-FILE-BROWSE             VALUE ' '.
   878                 88  PI-PRIMARY-BROWSE          VALUE '1'.
   879                 88  PI-ALTERNATE-BROWSE        VALUE '2'.
   880                 88  PI-PRIMARY-WITH-SELECT     VALUE '3'.
   881                 88  PI-CSR-BROWSE              VALUE '4'.
   882
   883             20  PI-MAINT-FUNCTION            PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  21
* EL631.cbl
   884                 88  PI-ADD-FUNCTION            VALUE 'A'.
   885                 88  PI-BROWSE-FUNCTION         VALUE 'B'.
   886                 88  PI-CHANGE-FUNCTION         VALUE 'C'.
   887                 88  PI-DELETE-FUNCTION         VALUE 'D'.
   888                 88  PI-SHOW-FUNCTION           VALUE 'S'.
   889                 88  PI-PF5-FUNCTION            VALUE '5'.
   890                 88  PI-PF6-FUNCTION            VALUE '6'.
   891
   892             20  PI-FILE-SWITCHES.
   893                 24  PI-ALL-ISSUES-SW         PIC X.
   894                     88  ALL-ISSUES             VALUE 'Y'.
   895                 24  PI-ALL-CANCELS-SW        PIC X.
   896                     88  ALL-CANCELS            VALUE 'Y'.
   897                 24  PI-ISSUES-IN-ERROR-SW    PIC X.
   898                     88  ISSUES-IN-ERROR        VALUE 'Y'.
   899                 24  PI-CANCELS-IN-ERROR-SW   PIC X.
   900                     88  CANCEL-IN-ERROR        VALUE 'Y'.
   901                 24  PI-ONLY-BATCH-HEADERS-SW PIC X.
   902                     88  ONLY-BATCH-HEADERS     VALUE 'Y'.
   903                 24  PI-ALL-OUT-OF-BAL-SW     PIC X.
   904                     88  ALL-OUT-OF-BAL         VALUE 'Y'.
   905                 24  PI-HOLD-REC-SW           PIC X.
   906                     88  DISPLAY-HOLD-RECORDS   VALUE 'Y'.
   907                 24  PI-CHANGE-REC-SW         PIC X.
   908                     88  DISPLAY-CHANGE-RECORDS VALUE 'Y'.
   909                 24  PI-CHK-REQ-REC-SW        PIC X.
   910                     88  DISPLAY-CHK-REQ-RECORDS VALUE 'Y'.
   911                 24  PI-ISSUE-WARNING-SW      PIC X.
   912                     88  ISSUE-WITH-WARNING     VALUE 'Y'.
   913                 24  PI-CANCEL-WARNING-SW     PIC X.
   914                     88  CANCEL-WITH-WARNING    VALUE 'Y'.
   915             20  PI-DISPLAY-SCREEN-SW         PIC X.
   916                     88  PI-DISPLAY-SCREEN      VALUE 'Y'.
   917             20  PI-ORIGINAL-BATCH-SW         PIC X.
   918                     88  PI-DISPLAY-ORIGINAL-BATCH VALUE 'Y'.
   919
   920             20  PI-MAP-NAME                  PIC X(8).
   921
   922             20  PI-CURSOR                    PIC S9(4) COMP.
   923
   924             20  PI-PREV-ALT-KEY              PIC X(36).
   925             20  PI-PREV-CSR-KEY              PIC X(15).
   926             20  PI-PREV-KEY.
   927                 24  PI-PREV-COMPANY-CD       PIC X.
   928                 24  PI-PREV-BATCH            PIC X(6).
   929                 24  PI-PREV-SEQ-NO           PIC S9(4) COMP.
   930                 24  PI-PREV-CHG-SEQ-NO       PIC S9(4) COMP.
   931             20  PI-PREV-CONTROL-PRIMARY      PIC X(11).
   932             20  PI-BROWSE-SW                 PIC X.
   933                 88  PI-GOOD-BROWSE             VALUE 'Y'.
   934                 88  PI-NO-PB-RECS-FOUND        VALUE '9'.
   935             20  PI-SV-CARRIER                PIC X.
   936             20  PI-SV-GROUPING               PIC X(6).
   937             20  PI-SV-STATE                  PIC XX.
   938             20  PI-EDIT-SW                   PIC X.
   939             20  PI-DISPLAY-SW                PIC XX.
   940                 88 PI-DISPLAY-LIFE        VALUE 'LF'.
   941                 88 PI-DISPLAY-AH          VALUE 'AH'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  22
* EL631.cbl
   942             20  PI-CRITERIA-DATA             PIC X(350).
   943             20  PI-BMODE                     PIC X.
   944             20  PI-BPMTAMT                   PIC S9(7)V99 COMP-3.
   945             20  PI-BPMTS                     PIC S999     COMP-3.
   946             20  PI-BTYPE                     PIC XXX OCCURS 2.
   947             20  PI-HIGH-SEQ-NO               PIC S9(4) COMP.
   948             20  PI-CSR-SESSION-SW            PIC X.
   949                 88  CSR-EDIT-SESSION           VALUE 'Y'.
   950             20  PI-ERRORS-SW                 PIC X.
   951                 88  FATAL-ERRORS               VALUE 'X'.
   952*                88  FATAL-OR-UNFORCED          VALUE 'X'.
   953             20  pi-unforced-sw               pic x.
   954                 88  unforced-errors            value 'X'.
   955             20  FILLER                       PIC X(4).
   956
   957         16  FILLER              PIC X(94).
   958
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  23
* EL631.cbl
   960
   961*    COPY ELCAID.
   962******************************************************************
   963*                                                                *
   964*                            ELCAID.                             *
   965*                            VMOD=2.001                          *
   966*                                                                *
   967*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   968*                                                                *
   969*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   970*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   971******************************************************************
   972
   973 01  DFHAID.
   974   02  DFHNULL   PIC  X  VALUE  ' '.
   975   02  DFHENTER  PIC  X  VALUE  QUOTE.
   976   02  DFHCLEAR  PIC  X  VALUE  '_'.
   977   02  DFHPEN    PIC  X  VALUE  '='.
   978   02  DFHOPID   PIC  X  VALUE  'W'.
   979   02  DFHPA1    PIC  X  VALUE  '%'.
   980   02  DFHPA2    PIC  X  VALUE  '>'.
   981   02  DFHPA3    PIC  X  VALUE  ','.
   982   02  DFHPF1    PIC  X  VALUE  '1'.
   983   02  DFHPF2    PIC  X  VALUE  '2'.
   984   02  DFHPF3    PIC  X  VALUE  '3'.
   985   02  DFHPF4    PIC  X  VALUE  '4'.
   986   02  DFHPF5    PIC  X  VALUE  '5'.
   987   02  DFHPF6    PIC  X  VALUE  '6'.
   988   02  DFHPF7    PIC  X  VALUE  '7'.
   989   02  DFHPF8    PIC  X  VALUE  '8'.
   990   02  DFHPF9    PIC  X  VALUE  '9'.
   991   02  DFHPF10   PIC  X  VALUE  ':'.
   992   02  DFHPF11   PIC  X  VALUE  '#'.
   993   02  DFHPF12   PIC  X  VALUE  '@'.
   994   02  DFHPF13   PIC  X  VALUE  'A'.
   995   02  DFHPF14   PIC  X  VALUE  'B'.
   996   02  DFHPF15   PIC  X  VALUE  'C'.
   997   02  DFHPF16   PIC  X  VALUE  'D'.
   998   02  DFHPF17   PIC  X  VALUE  'E'.
   999   02  DFHPF18   PIC  X  VALUE  'F'.
  1000   02  DFHPF19   PIC  X  VALUE  'G'.
  1001   02  DFHPF20   PIC  X  VALUE  'H'.
  1002   02  DFHPF21   PIC  X  VALUE  'I'.
  1003*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1004   02  DFHPF22   PIC  X  VALUE  '['.
  1005   02  DFHPF23   PIC  X  VALUE  '.'.
  1006   02  DFHPF24   PIC  X  VALUE  '<'.
  1007   02  DFHMSRE   PIC  X  VALUE  'X'.
  1008   02  DFHSTRF   PIC  X  VALUE  'h'.
  1009   02  DFHTRIG   PIC  X  VALUE  '"'.
  1010 01  FILLER    REDEFINES DFHAID.
  1011     12  FILLER                  PIC X(8).
  1012     12  PF-VALUES               PIC X       OCCURS 24 TIMES.
  1013
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  24
* EL631.cbl
  1015
  1016*    COPY EL631S.
  1017 01  EL631AI.
  1018     05  FILLER            PIC  X(0012).
  1019*    -------------------------------
  1020     05  DATEL PIC S9(0004) COMP.
  1021     05  DATEF PIC  X(0001).
  1022     05  FILLER REDEFINES DATEF.
  1023         10  DATEA PIC  X(0001).
  1024     05  DATEI PIC  X(0008).
  1025*    -------------------------------
  1026     05  TIMEL PIC S9(0004) COMP.
  1027     05  TIMEF PIC  X(0001).
  1028     05  FILLER REDEFINES TIMEF.
  1029         10  TIMEA PIC  X(0001).
  1030     05  TIMEI PIC  X(0005).
  1031*    -------------------------------
  1032     05  HEADL PIC S9(0004) COMP.
  1033     05  HEADF PIC  X(0001).
  1034     05  FILLER REDEFINES HEADF.
  1035         10  HEADA PIC  X(0001).
  1036     05  HEADI PIC  X(0038).
  1037*    -------------------------------
  1038     05  MODL PIC S9(0004) COMP.
  1039     05  MODF PIC  X(0001).
  1040     05  FILLER REDEFINES MODF.
  1041         10  MODA PIC  X(0001).
  1042     05  MODI PIC  X(0003).
  1043*    -------------------------------
  1044     05  BATCHL PIC S9(0004) COMP.
  1045     05  BATCHF PIC  X(0001).
  1046     05  FILLER REDEFINES BATCHF.
  1047         10  BATCHA PIC  X(0001).
  1048     05  BATCHI PIC  X(0006).
  1049*    -------------------------------
  1050     05  SEQL PIC S9(0004) COMP.
  1051     05  SEQF PIC  X(0001).
  1052     05  FILLER REDEFINES SEQF.
  1053         10  SEQA PIC  X(0001).
  1054     05  SEQI PIC  X(0004).
  1055*    -------------------------------
  1056     05  CARRIERL PIC S9(0004) COMP.
  1057     05  CARRIERF PIC  X(0001).
  1058     05  FILLER REDEFINES CARRIERF.
  1059         10  CARRIERA PIC  X(0001).
  1060     05  CARRIERI PIC  X(0001).
  1061*    -------------------------------
  1062     05  GROUPL PIC S9(0004) COMP.
  1063     05  GROUPF PIC  X(0001).
  1064     05  FILLER REDEFINES GROUPF.
  1065         10  GROUPA PIC  X(0001).
  1066     05  GROUPI PIC  X(0006).
  1067*    -------------------------------
  1068     05  STATEL PIC S9(0004) COMP.
  1069     05  STATEF PIC  X(0001).
  1070     05  FILLER REDEFINES STATEF.
  1071         10  STATEA PIC  X(0001).
  1072     05  STATEI PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  25
* EL631.cbl
  1073*    -------------------------------
  1074     05  ACCOUNTL PIC S9(0004) COMP.
  1075     05  ACCOUNTF PIC  X(0001).
  1076     05  FILLER REDEFINES ACCOUNTF.
  1077         10  ACCOUNTA PIC  X(0001).
  1078     05  ACCOUNTI PIC  X(0010).
  1079*    -------------------------------
  1080     05  EFFDTL PIC S9(0004) COMP.
  1081     05  EFFDTF PIC  X(0001).
  1082     05  FILLER REDEFINES EFFDTF.
  1083         10  EFFDTA PIC  X(0001).
  1084     05  EFFDTI PIC  X(0008).
  1085*    -------------------------------
  1086     05  CERTNOL PIC S9(0004) COMP.
  1087     05  CERTNOF PIC  X(0001).
  1088     05  FILLER REDEFINES CERTNOF.
  1089         10  CERTNOA PIC  X(0001).
  1090     05  CERTNOI PIC  X(0010).
  1091*    -------------------------------
  1092     05  SUFFIXL PIC S9(0004) COMP.
  1093     05  SUFFIXF PIC  X(0001).
  1094     05  FILLER REDEFINES SUFFIXF.
  1095         10  SUFFIXA PIC  X(0001).
  1096     05  SUFFIXI PIC  X(0001).
  1097*    -------------------------------
  1098     05  CSRHDL PIC S9(0004) COMP.
  1099     05  CSRHDF PIC  X(0001).
  1100     05  FILLER REDEFINES CSRHDF.
  1101         10  CSRHDA PIC  X(0001).
  1102     05  CSRHDI PIC  X(0004).
  1103*    -------------------------------
  1104     05  CSRL PIC S9(0004) COMP.
  1105     05  CSRF PIC  X(0001).
  1106     05  FILLER REDEFINES CSRF.
  1107         10  CSRA PIC  X(0001).
  1108     05  CSRI PIC  X(0004).
  1109*    -------------------------------
  1110     05  ANYISSL PIC S9(0004) COMP.
  1111     05  ANYISSF PIC  X(0001).
  1112     05  FILLER REDEFINES ANYISSF.
  1113         10  ANYISSA PIC  X(0001).
  1114     05  ANYISSI PIC  X(0001).
  1115*    -------------------------------
  1116     05  ANYCANL PIC S9(0004) COMP.
  1117     05  ANYCANF PIC  X(0001).
  1118     05  FILLER REDEFINES ANYCANF.
  1119         10  ANYCANA PIC  X(0001).
  1120     05  ANYCANI PIC  X(0001).
  1121*    -------------------------------
  1122     05  ALLISSL PIC S9(0004) COMP.
  1123     05  ALLISSF PIC  X(0001).
  1124     05  FILLER REDEFINES ALLISSF.
  1125         10  ALLISSA PIC  X(0001).
  1126     05  ALLISSI PIC  X(0001).
  1127*    -------------------------------
  1128     05  ALLCANL PIC S9(0004) COMP.
  1129     05  ALLCANF PIC  X(0001).
  1130     05  FILLER REDEFINES ALLCANF.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  26
* EL631.cbl
  1131         10  ALLCANA PIC  X(0001).
  1132     05  ALLCANI PIC  X(0001).
  1133*    -------------------------------
  1134     05  ONLYHDRL PIC S9(0004) COMP.
  1135     05  ONLYHDRF PIC  X(0001).
  1136     05  FILLER REDEFINES ONLYHDRF.
  1137         10  ONLYHDRA PIC  X(0001).
  1138     05  ONLYHDRI PIC  X(0001).
  1139*    -------------------------------
  1140     05  OUTBALL PIC S9(0004) COMP.
  1141     05  OUTBALF PIC  X(0001).
  1142     05  FILLER REDEFINES OUTBALF.
  1143         10  OUTBALA PIC  X(0001).
  1144     05  OUTBALI PIC  X(0001).
  1145*    -------------------------------
  1146     05  ORGINALL PIC S9(0004) COMP.
  1147     05  ORGINALF PIC  X(0001).
  1148     05  FILLER REDEFINES ORGINALF.
  1149         10  ORGINALA PIC  X(0001).
  1150     05  ORGINALI PIC  X(0001).
  1151*    -------------------------------
  1152     05  ORGHDRL PIC S9(0004) COMP.
  1153     05  ORGHDRF PIC  X(0001).
  1154     05  FILLER REDEFINES ORGHDRF.
  1155         10  ORGHDRA PIC  X(0001).
  1156     05  ORGHDRI PIC  X(0028).
  1157*    -------------------------------
  1158     05  HLDRECL PIC S9(0004) COMP.
  1159     05  HLDRECF PIC  X(0001).
  1160     05  FILLER REDEFINES HLDRECF.
  1161         10  HLDRECA PIC  X(0001).
  1162     05  HLDRECI PIC  X(0001).
  1163*    -------------------------------
  1164     05  CHGRECL PIC S9(0004) COMP.
  1165     05  CHGRECF PIC  X(0001).
  1166     05  FILLER REDEFINES CHGRECF.
  1167         10  CHGRECA PIC  X(0001).
  1168     05  CHGRECI PIC  X(0001).
  1169*    -------------------------------
  1170     05  CHKREQL PIC S9(0004) COMP.
  1171     05  CHKREQF PIC  X(0001).
  1172     05  FILLER REDEFINES CHKREQF.
  1173         10  CHKREQA PIC  X(0001).
  1174     05  CHKREQI PIC  X(0001).
  1175*    -------------------------------
  1176     05  STARTATL PIC S9(0004) COMP.
  1177     05  STARTATF PIC  X(0001).
  1178     05  FILLER REDEFINES STARTATF.
  1179         10  STARTATA PIC  X(0001).
  1180     05  STARTATI PIC  X(0001).
  1181*    -------------------------------
  1182     05  ANYISSWL PIC S9(0004) COMP.
  1183     05  ANYISSWF PIC  X(0001).
  1184     05  FILLER REDEFINES ANYISSWF.
  1185         10  ANYISSWA PIC  X(0001).
  1186     05  ANYISSWI PIC  X(0001).
  1187*    -------------------------------
  1188     05  ANYCANWL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  27
* EL631.cbl
  1189     05  ANYCANWF PIC  X(0001).
  1190     05  FILLER REDEFINES ANYCANWF.
  1191         10  ANYCANWA PIC  X(0001).
  1192     05  ANYCANWI PIC  X(0001).
  1193*    -------------------------------
  1194     05  ERRMSG1L PIC S9(0004) COMP.
  1195     05  ERRMSG1F PIC  X(0001).
  1196     05  FILLER REDEFINES ERRMSG1F.
  1197         10  ERRMSG1A PIC  X(0001).
  1198     05  ERRMSG1I PIC  X(0079).
  1199*    -------------------------------
  1200     05  ERRMSG2L PIC S9(0004) COMP.
  1201     05  ERRMSG2F PIC  X(0001).
  1202     05  FILLER REDEFINES ERRMSG2F.
  1203         10  ERRMSG2A PIC  X(0001).
  1204     05  ERRMSG2I PIC  X(0079).
  1205*    -------------------------------
  1206     05  PFENTERL PIC S9(0004) COMP.
  1207     05  PFENTERF PIC  X(0001).
  1208     05  FILLER REDEFINES PFENTERF.
  1209         10  PFENTERA PIC  X(0001).
  1210     05  PFENTERI PIC  99.
  1211 01  EL631AO REDEFINES EL631AI.
  1212     05  FILLER            PIC  X(0012).
  1213*    -------------------------------
  1214     05  FILLER            PIC  X(0003).
  1215     05  DATEO PIC  X(0008).
  1216*    -------------------------------
  1217     05  FILLER            PIC  X(0003).
  1218     05  TIMEO PIC  99.99.
  1219*    -------------------------------
  1220     05  FILLER            PIC  X(0003).
  1221     05  HEADO PIC  X(0038).
  1222*    -------------------------------
  1223     05  FILLER            PIC  X(0003).
  1224     05  MODO PIC  X(0003).
  1225*    -------------------------------
  1226     05  FILLER            PIC  X(0003).
  1227     05  BATCHO PIC  X(0006).
  1228*    -------------------------------
  1229     05  FILLER            PIC  X(0003).
  1230     05  SEQO PIC  X(0004).
  1231*    -------------------------------
  1232     05  FILLER            PIC  X(0003).
  1233     05  CARRIERO PIC  X(0001).
  1234*    -------------------------------
  1235     05  FILLER            PIC  X(0003).
  1236     05  GROUPO PIC  X(0006).
  1237*    -------------------------------
  1238     05  FILLER            PIC  X(0003).
  1239     05  STATEO PIC  X(0002).
  1240*    -------------------------------
  1241     05  FILLER            PIC  X(0003).
  1242     05  ACCOUNTO PIC  X(0010).
  1243*    -------------------------------
  1244     05  FILLER            PIC  X(0003).
  1245     05  EFFDTO PIC  X(0008).
  1246*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  28
* EL631.cbl
  1247     05  FILLER            PIC  X(0003).
  1248     05  CERTNOO PIC  X(0010).
  1249*    -------------------------------
  1250     05  FILLER            PIC  X(0003).
  1251     05  SUFFIXO PIC  X(0001).
  1252*    -------------------------------
  1253     05  FILLER            PIC  X(0003).
  1254     05  CSRHDO PIC  X(0004).
  1255*    -------------------------------
  1256     05  FILLER            PIC  X(0003).
  1257     05  CSRO PIC  X(0004).
  1258*    -------------------------------
  1259     05  FILLER            PIC  X(0003).
  1260     05  ANYISSO PIC  X(0001).
  1261*    -------------------------------
  1262     05  FILLER            PIC  X(0003).
  1263     05  ANYCANO PIC  X(0001).
  1264*    -------------------------------
  1265     05  FILLER            PIC  X(0003).
  1266     05  ALLISSO PIC  X(0001).
  1267*    -------------------------------
  1268     05  FILLER            PIC  X(0003).
  1269     05  ALLCANO PIC  X(0001).
  1270*    -------------------------------
  1271     05  FILLER            PIC  X(0003).
  1272     05  ONLYHDRO PIC  X(0001).
  1273*    -------------------------------
  1274     05  FILLER            PIC  X(0003).
  1275     05  OUTBALO PIC  X(0001).
  1276*    -------------------------------
  1277     05  FILLER            PIC  X(0003).
  1278     05  ORGINALO PIC  X(0001).
  1279*    -------------------------------
  1280     05  FILLER            PIC  X(0003).
  1281     05  ORGHDRO PIC  X(0028).
  1282*    -------------------------------
  1283     05  FILLER            PIC  X(0003).
  1284     05  HLDRECO PIC  X(0001).
  1285*    -------------------------------
  1286     05  FILLER            PIC  X(0003).
  1287     05  CHGRECO PIC  X(0001).
  1288*    -------------------------------
  1289     05  FILLER            PIC  X(0003).
  1290     05  CHKREQO PIC  X(0001).
  1291*    -------------------------------
  1292     05  FILLER            PIC  X(0003).
  1293     05  STARTATO PIC  X(0001).
  1294*    -------------------------------
  1295     05  FILLER            PIC  X(0003).
  1296     05  ANYISSWO PIC  X(0001).
  1297*    -------------------------------
  1298     05  FILLER            PIC  X(0003).
  1299     05  ANYCANWO PIC  X(0001).
  1300*    -------------------------------
  1301     05  FILLER            PIC  X(0003).
  1302     05  ERRMSG1O PIC  X(0079).
  1303*    -------------------------------
  1304     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  29
* EL631.cbl
  1305     05  ERRMSG2O PIC  X(0079).
  1306*    -------------------------------
  1307     05  FILLER            PIC  X(0003).
  1308     05  PFENTERO PIC  99.
  1309*    -------------------------------
  1310
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  30
* EL631.cbl
  1312
  1313****************************************************************
  1314*
  1315* Copyright (c) 2007 by Clerity Solutions, Inc.
  1316* All rights reserved.
  1317*
  1318****************************************************************
  1319 01  DFHEIV.
  1320   02  DFHEIV0               PIC X(35).
  1321   02  DFHEIV1               PIC X(08).
  1322   02  DFHEIV2               PIC X(08).
  1323   02  DFHEIV3               PIC X(08).
  1324   02  DFHEIV4               PIC X(06).
  1325   02  DFHEIV5               PIC X(04).
  1326   02  DFHEIV6               PIC X(04).
  1327   02  DFHEIV7               PIC X(02).
  1328   02  DFHEIV8               PIC X(02).
  1329   02  DFHEIV9               PIC X(01).
  1330   02  DFHEIV10              PIC S9(7) COMP-3.
  1331   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1332   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1333   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1334   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1335   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1336   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1337   02  DFHEIV17              PIC X(04).
  1338   02  DFHEIV18              PIC X(04).
  1339   02  DFHEIV19              PIC X(04).
  1340   02  DFHEIV20              USAGE IS POINTER.
  1341   02  DFHEIV21              USAGE IS POINTER.
  1342   02  DFHEIV22              USAGE IS POINTER.
  1343   02  DFHEIV23              USAGE IS POINTER.
  1344   02  DFHEIV24              USAGE IS POINTER.
  1345   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1346   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1347   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1348   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1349   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1350   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1351   02  FILLER                PIC X(02).
  1352   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1353   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1354   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1355   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1356   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1357 LINKAGE  SECTION.
  1358*****************************************************************
  1359*                                                               *
  1360* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1361* All rights reserved.                                          *
  1362*                                                               *
  1363*****************************************************************
  1364 01  dfheiblk.
  1365     02  eibtime          pic s9(7) comp-3.
  1366     02  eibdate          pic s9(7) comp-3.
  1367     02  eibtrnid         pic x(4).
  1368     02  eibtaskn         pic s9(7) comp-3.
  1369     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  31
* EL631.cbl
  1370     02  dfheigdi         pic s9(4) comp.
  1371     02  eibcposn         pic s9(4) comp.
  1372     02  eibcalen         pic s9(4) comp.
  1373     02  eibaid           pic x(1).
  1374     02  eibfiller1       pic x(1).
  1375     02  eibfn            pic x(2).
  1376     02  eibfiller2       pic x(2).
  1377     02  eibrcode         pic x(6).
  1378     02  eibfiller3       pic x(2).
  1379     02  eibds            pic x(8).
  1380     02  eibreqid         pic x(8).
  1381     02  eibrsrce         pic x(8).
  1382     02  eibsync          pic x(1).
  1383     02  eibfree          pic x(1).
  1384     02  eibrecv          pic x(1).
  1385     02  eibsend          pic x(1).
  1386     02  eibatt           pic x(1).
  1387     02  eibeoc           pic x(1).
  1388     02  eibfmh           pic x(1).
  1389     02  eibcompl         pic x(1).
  1390     02  eibsig           pic x(1).
  1391     02  eibconf          pic x(1).
  1392     02  eiberr           pic x(1).
  1393     02  eibrldbk         pic x(1).
  1394     02  eiberrcd         pic x(4).
  1395     02  eibsynrb         pic x(1).
  1396     02  eibnodat         pic x(1).
  1397     02  eibfiller5       pic x(2).
  1398     02  eibresp          pic 9(09) comp.
  1399     02  eibresp2         pic 9(09) comp.
  1400     02  dfheigdj         pic s9(4) comp.
  1401     02  dfheigdk         pic s9(4) comp.
  1402 01  DFHCOMMAREA                 PIC X(1300).
  1403
  1404*01 PARMLIST .
  1405*    02  FILLER                  PIC S9(8)   COMP.
  1406*    02  ERPNDB-POINTER          PIC S9(8)   COMP.
  1407*    02  ERACCT-POINTER          PIC S9(8)   COMP.
  1408
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  32
* EL631.cbl
  1410*    COPY ERCPNDB.
  1411******************************************************************
  1412*                                                                *
  1413*                                                                *
  1414*                            ERCPNDB.                            *
  1415*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1416*                            VMOD=2.025                          *
  1417*                                                                *
  1418*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  1419*                                                                *
  1420******************************************************************
  1421*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  1422*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  1423******************************************************************
  1424*                                                                *
  1425*                                                                *
  1426*   FILE TYPE = VSAM,KSDS                                        *
  1427*   RECORD SIZE = 585  RECFORM = FIXED                           *
  1428*                                                                *
  1429*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  1430*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  1431*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  1432*                                                 RKP=13,LEN=36  *
  1433*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  1434*                                      AND CHG-SEQ.)             *
  1435*                                                RKP=49,LEN=11   *
  1436*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  1437*                                      AND CHG-SEQ.)             *
  1438*                                                RKP=60,LEN=15   *
  1439*                                                                *
  1440*   LOG = NO                                                     *
  1441*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1442******************************************************************
  1443******************************************************************
  1444*                   C H A N G E   L O G
  1445*
  1446* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1447*-----------------------------------------------------------------
  1448*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1449* EFFECTIVE    NUMBER
  1450*-----------------------------------------------------------------
  1451* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1452* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1453* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  1454* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1455* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  1456* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1457* 032306                   PEMA  ADD BOW LOAN NUMBER
  1458* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  1459* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  1460* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1461* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  1462* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  1463* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  1464* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1465* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  1466* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  1467* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  33
* EL631.cbl
  1468******************************************************************
  1469
  1470 01  PENDING-BUSINESS.
  1471     12  PB-RECORD-ID                     PIC XX.
  1472         88  VALID-PB-ID                        VALUE 'PB'.
  1473
  1474     12  PB-CONTROL-PRIMARY.
  1475         16  PB-COMPANY-CD                PIC X.
  1476         16  PB-ENTRY-BATCH               PIC X(6).
  1477         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  1478         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  1479
  1480     12  PB-CONTROL-BY-ACCOUNT.
  1481         16  PB-COMPANY-CD-A1             PIC X.
  1482         16  PB-CARRIER                   PIC X.
  1483         16  PB-GROUPING.
  1484             20  PB-GROUPING-PREFIX       PIC XXX.
  1485             20  PB-GROUPING-PRIME        PIC XXX.
  1486         16  PB-STATE                     PIC XX.
  1487         16  PB-ACCOUNT.
  1488             20  PB-ACCOUNT-PREFIX        PIC X(4).
  1489             20  PB-ACCOUNT-PRIME         PIC X(6).
  1490         16  PB-CERT-EFF-DT               PIC XX.
  1491         16  PB-CERT-NO.
  1492             20  PB-CERT-PRIME            PIC X(10).
  1493             20  PB-CERT-SFX              PIC X.
  1494         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  1495
  1496         16  PB-RECORD-TYPE               PIC X.
  1497             88  PB-MAILING-DATA                VALUE '0'.
  1498             88  PB-ISSUE                       VALUE '1'.
  1499             88  PB-CANCELLATION                VALUE '2'.
  1500             88  PB-BATCH-TRAILER               VALUE '9'.
  1501
  1502     12  PB-CONTROL-BY-ORIG-BATCH.
  1503         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  1504         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  1505         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  1506         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  1507
  1508     12  PB-CONTROL-BY-CSR.
  1509         16  PB-CSR-COMPANY-CD            PIC X.
  1510         16  PB-CSR-ID                    PIC X(4).
  1511         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  1512         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  1513         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  1514******************************************************************
  1515*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  1516******************************************************************
  1517
  1518     12  PB-LAST-MAINT-DT                 PIC XX.
  1519     12  PB-LAST-MAINT-BY                 PIC X(4).
  1520     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1521
  1522     12  PB-RECORD-BODY                   PIC X(375).
  1523
  1524     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  1525         16  PB-CERT-ORIGIN               PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  34
* EL631.cbl
  1526             88  CLASIC-CREATED-CERT         VALUE '1'.
  1527         16  PB-I-NAME.
  1528             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  1529             20  PB-I-INSURED-FIRST-NAME.
  1530                 24  PB-I-INSURED-1ST-INIT PIC X.
  1531                 24  FILLER                PIC X(9).
  1532             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  1533         16  PB-I-AGE                     PIC S99   COMP-3.
  1534         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  1535         16  PB-I-BIRTHDAY                PIC XX.
  1536         16  PB-I-INSURED-SEX             PIC X.
  1537             88  PB-SEX-MALE     VALUE 'M'.
  1538             88  PB-SEX-FEMALE   VALUE 'F'.
  1539
  1540         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  1541         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  1542         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  1543         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  1544         16  PB-I-SKIP-CODE               PIC X.
  1545             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  1546             88  PB-SKIP-JULY              VALUE '1'.
  1547             88  PB-SKIP-AUGUST            VALUE '2'.
  1548             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  1549             88  PB-SKIP-JULY-AUG          VALUE '4'.
  1550             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  1551             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  1552             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  1553             88  PB-SKIP-JUNE              VALUE '8'.
  1554             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  1555             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  1556             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  1557         16  PB-I-TERM-TYPE               PIC X.
  1558             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  1559             88  PB-PAID-WEEKLY            VALUE 'W'.
  1560             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  1561             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  1562             88  PB-PAID-13-YEARLY         VALUE 'T'.
  1563         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  1564         16  PB-I-POLICY-FORM-NO          PIC X(12).
  1565         16  PB-I-DATA-ENTRY-SW           PIC X.
  1566             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  1567             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  1568             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  1569             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  1570         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  1571         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  1572*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  1573         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  1574         16  FILLER                       PIC X.
  1575
  1576         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  1577             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  1578             88  PB-INVALID-LIFE             VALUE '  ' '00'
  1579                                                   '90' THRU '99'.
  1580         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  1581                                          PIC XX.
  1582         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  1583         16  PB-I-AMOUNT-FINANCED REDEFINES
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  35
* EL631.cbl
  1584                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  1585         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  1586         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  1587                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  1588         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1589         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  1590         16  PB-I-CLP-AMOUNT REDEFINES
  1591                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  1592         16  PB-I-LF-CALC-FLAG            PIC X.
  1593             88 PB-COMP-LF-PREM               VALUE '?'.
  1594         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  1595         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  1596         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  1597         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  1598         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  1599         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  1600         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  1601         16  PB-I-LF-ABBR                 PIC XXX.
  1602         16  PB-I-LF-INPUT-CD             PIC XX.
  1603
  1604         16  PB-I-AH-BENEFIT-CD           PIC XX.
  1605             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  1606             88  PB-INVALID-AH               VALUE '  ' '00'
  1607                                                   '90' THRU '99'.
  1608         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  1609         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  1610         16  PB-I-AH-CALC-FLAG            PIC X.
  1611             88 PB-COMP-AH-PREM                  VALUE '?'.
  1612         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  1613         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  1614         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  1615         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  1616         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  1617         16  PB-I-AH-ABBR                 PIC XXX.
  1618         16  PB-I-AH-INPUT-CD             PIC XXX.
  1619
  1620         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  1621         16  PB-I-REIN-TABLE              PIC XXX.
  1622         16  PB-I-BUSINESS-TYPE           PIC 99.
  1623         16  PB-I-INDV-GRP-CD             PIC X.
  1624         16  PB-I-MORT-CODE.
  1625             20  PB-I-TABLE               PIC X.
  1626             20  PB-I-INTEREST            PIC XX.
  1627             20  PB-I-MORT-TYP            PIC X.
  1628         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  1629         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  1630         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  1631         16  PB-I-INDV-GRP-OVRD           PIC X.
  1632         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  1633         16  PB-I-SIG-SW                  PIC X.
  1634             88  PB-POLICY-SIGNED             VALUE 'Y'.
  1635         16  PB-I-RATE-CLASS              PIC XX.
  1636         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  1637         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  1638         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  1639         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  1640         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  1641         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  36
* EL631.cbl
  1642         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  1643         16  PB-I-BENEFIT-TYPE            PIC XXX.
  1644         16  PB-I-OB-FLAG                 PIC X.
  1645             88  PB-I-OB                      VALUE 'B'.
  1646             88  PB-I-SUMMARY                 VALUE 'Z'.
  1647         16  PB-I-ENTRY-STATUS            PIC X.
  1648             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  1649                                              'M' '5' '9' '2'.
  1650             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  1651             88  PB-I-POLICY-PENDING          VALUE '2'.
  1652             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  1653             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  1654             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  1655             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  1656             88  PB-I-REIN-ONLY               VALUE '9'.
  1657             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  1658             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  1659             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  1660             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  1661         16  PB-I-INT-CODE                PIC X.
  1662             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  1663             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  1664         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  1665         16  PB-I-SOC-SEC-NO              PIC X(11).
  1666         16  PB-I-MEMBER-NO               PIC X(12).
  1667         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  1668*        16  PB-I-LOAN-OFFICER            PIC XXX.
  1669         16  PB-I-OLD-LOF                 PIC XXX.
  1670         16  PB-I-LF-EXPIRE-DT            PIC XX.
  1671         16  PB-I-AH-EXPIRE-DT            PIC XX.
  1672         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  1673         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  1674         16  PB-I-LIFE-INDICATOR          PIC X.
  1675             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  1676         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  1677         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  1678                                          PIC S9(5)V99    COMP-3.
  1679         16  PB-I-MAIL-ADDRS-SW           PIC X.
  1680             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  1681             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  1682         16  PB-I-1ST-PMT-DT              PIC XX.
  1683         16  PB-I-JOINT-INSURED.
  1684             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  1685             20 PB-I-JOINT-FIRST-NAME.
  1686                24  PB-I-JOINT-FIRST-INIT PIC X.
  1687                24  FILLER                PIC X(9).
  1688             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  1689*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  1690         16  PB-I-BENEFICIARY-NAME.
  1691             20  PB-I-BANK-NUMBER         PIC X(10).
  1692             20  FILLER                   PIC X(15).
  1693         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  1694         16  PB-I-REFERENCE               PIC X(12).
  1695         16  FILLER REDEFINES PB-I-REFERENCE.
  1696             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  1697             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  1698             20  PB-I-CLP-STATE           PIC XX.
  1699         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  37
* EL631.cbl
  1700             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  1701             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  1702             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  1703         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  1704         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  1705         16  PB-I-RESIDENT-STATE          PIC XX.
  1706         16  PB-I-RATE-CODE               PIC X(4).
  1707         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  1708         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1709         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1710         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  1711         16  PB-I-BANK-NOCHRGB            PIC 99.
  1712         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  1713         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  1714
  1715     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  1716         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  1717             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  1718         16  PB-C-CANCEL-ORIGIN           PIC X.
  1719             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  1720         16  PB-C-LF-CANCEL-DT            PIC XX.
  1721         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1722         16  PB-C-LF-CALC-REQ             PIC X.
  1723             88 PB-COMP-LF-CANCEL            VALUE '?'.
  1724         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  1725         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  1726         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  1727             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  1728         16  PB-C-AH-CANCEL-DT            PIC XX.
  1729         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  1730         16  PB-C-AH-CALC-REQ             PIC X.
  1731             88 PB-COMP-AH-CANCEL            VALUE '?'.
  1732         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  1733         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  1734         16  PB-C-LAST-NAME               PIC X(15).
  1735         16  PB-C-REFUND-SW               PIC X.
  1736             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  1737             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  1738         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  1739         16  PB-C-PAYEE-CODE              PIC X(6).
  1740         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  1741         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  1742         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  1743         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  1744         16  PB-C-REFERENCE               PIC X(12).
  1745         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  1746         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  1747         16  PB-C-POST-CARD-IND           PIC X.
  1748         16  PB-C-CANCEL-REASON           PIC X.
  1749         16  PB-C-REF-INTERFACE-SW        PIC X.
  1750         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  1751         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  1752         16  FILLER                       PIC X(01).
  1753*        16  FILLER                       PIC X(18).
  1754         16  PB-C-POLICY-FORM-NO          PIC X(12).
  1755*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  1756         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  1757         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  38
* EL631.cbl
  1758             20  PB-CI-INSURED-NAME.
  1759                 24  PB-CI-LAST-NAME      PIC X(15).
  1760                 24  PB-CI-INITIALS       PIC XX.
  1761             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  1762             20  PB-CI-INSURED-SEX        PIC X.
  1763             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  1764             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  1765             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  1766             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  1767             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1768             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  1769             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  1770             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  1771             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  1772             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  1773             20  PB-CI-RATE-CLASS         PIC XX.
  1774             20  PB-CI-RATE-DEV-LF        PIC XXX.
  1775             20  PB-CI-RATE-DEV-AH        PIC XXX.
  1776             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  1777             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  1778             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  1779             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  1780             20  PB-CI-LF-ABBR            PIC X(3).
  1781             20  PB-CI-AH-ABBR            PIC X(3).
  1782             20  PB-CI-OB-FLAG            PIC X.
  1783                 88  PB-CI-OB                VALUE 'B'.
  1784             20  PB-CI-LF-POLICY-STATUS   PIC X.
  1785                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  1786                                           'M' '4' '5' '9' '2'.
  1787                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  1788                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  1789                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  1790                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  1791                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  1792                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  1793                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1794                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  1795                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1796                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  1797                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  1798                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  1799                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  1800             20  PB-CI-AH-POLICY-STATUS   PIC X.
  1801                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  1802                                           'M' '4' '5' '9' '2'.
  1803                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  1804                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  1805                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  1806                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  1807                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  1808                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  1809                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1810                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  1811                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1812                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  1813                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  1814                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  1815                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  39
* EL631.cbl
  1816             20  PB-CI-PAY-FREQUENCY      PIC 99.
  1817             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  1818             20  PB-CI-SOC-SEC-NO         PIC X(11).
  1819             20  PB-CI-MEMBER-NO          PIC X(12).
  1820             20  PB-CI-INT-CODE           PIC X.
  1821                 88  PB-CI-ADD-ON                  VALUE 'A'.
  1822                 88  PB-CI-SIMPLE                  VALUE 'S'.
  1823             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  1824             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  1825             20  PB-CI-COMP-EXCP-SW       PIC X.
  1826                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  1827                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  1828             20  PB-CI-ENTRY-STATUS       PIC X.
  1829             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  1830             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  1831             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  1832             20  PB-CI-DEATH-DT           PIC XX.
  1833             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  1834             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  1835             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1836             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  1837             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  1838             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  1839             20  PB-CI-ENTRY-DT              PIC XX.
  1840             20  PB-CI-ENTRY-BATCH           PIC X(6).
  1841             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  1842             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  1843             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  1844             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  1845             20  PB-CI-OLD-LOF               PIC XXX.
  1846*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  1847             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  1848             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  1849             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  1850             20  PB-CI-INDV-GRP-CD           PIC X.
  1851             20  PB-CI-BENEFICIARY-NAME.
  1852                 24  PB-CI-BANK-NUMBER       PIC X(10).
  1853                 24  FILLER                  PIC X(15).
  1854             20  PB-CI-NOTE-SW               PIC X.
  1855             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  1856             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  1857             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  1858             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  1859             20  PB-CI-LOAN-OFFICER          PIC X(5).
  1860             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  1861             20  PB-CI-FIRST-NAME            PIC X(10).
  1862             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  1863
  1864         16  FILLER                       PIC X(13).
  1865*032306  16  FILLER                       PIC X(27).
  1866*        16  FILLER                       PIC X(46).
  1867
  1868     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  1869         16  FILLER                       PIC X(10).
  1870         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  1871         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  1872         16  PB-M-INSURED-MID-INIT        PIC X.
  1873         16  PB-M-INSURED-AGE             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  40
* EL631.cbl
  1874         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  1875         16  PB-M-INSURED-SEX             PIC X.
  1876         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  1877         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  1878         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  1879         16  PB-M-INSURED-CITY-STATE.
  1880             20  PB-M-INSURED-CITY        PIC X(28).
  1881             20  PB-M-INSURED-STATE       PIC XX.
  1882         16  PB-M-INSURED-ZIP-CODE.
  1883             20  PB-M-INSURED-ZIP-PRIME.
  1884                 24  PB-M-INSURED-ZIP-1   PIC X.
  1885                     88  PB-M-CANADIAN-POST-CODE
  1886                                             VALUE 'A' THRU 'Z'.
  1887                 24  FILLER               PIC X(4).
  1888             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  1889         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  1890                                        PB-M-INSURED-ZIP-CODE.
  1891             20  PM-M-INS-CAN-POST1       PIC XXX.
  1892             20  PM-M-INS-CAN-POST2       PIC XXX.
  1893             20  FILLER                   PIC XXX.
  1894         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  1895         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  1896         16  PB-M-CRED-BENE-NAME          PIC X(30).
  1897         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  1898         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  1899         16  PB-M-CRED-BENE-CITYST.
  1900             20  PB-M-CRED-BENE-CITY      PIC X(28).
  1901             20  PB-M-CRED-BENE-STATE     PIC XX.
  1902         16  FILLER                       PIC X(92).
  1903
  1904     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  1905         16  FILLER                       PIC X(10).
  1906         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1907         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1908         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1909         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1910         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1911         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1912         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1913         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1914         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1915         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  1916         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  1917         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  1918         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  1919         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  1920         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  1921         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  1922         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  1923         16  PB-ACCOUNT-NAME              PIC X(30).
  1924         16  PB-PREM-REF-RPT-FLAG         PIC X.
  1925         16  PB-REFERENCE                 PIC X(12).
  1926         16  PB-B-RECEIVED-DT             PIC XX.
  1927         16  FILLER                       PIC X(234).
  1928
  1929     12  PB-RECORD-STATUS.
  1930         16  PB-CREDIT-SELECT-DT          PIC XX.
  1931         16  PB-CREDIT-ACCEPT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  41
* EL631.cbl
  1932         16  PB-BILLED-DT                 PIC XX.
  1933         16  PB-BILLING-STATUS            PIC X.
  1934             88  PB-ENTRY-REVERSED            VALUE 'R'.
  1935             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  1936             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  1937         16  PB-RECORD-BILL               PIC X.
  1938             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  1939             88  PB-RECORD-RETURNED           VALUE 'R'.
  1940             88  PB-RECORD-ENDORSED           VALUE 'E'.
  1941             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  1942             88  PB-OVERRIDE-AH               VALUE 'A'.
  1943             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  1944         16  PB-BATCH-ENTRY               PIC X.
  1945             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  1946             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  1947             88  PB-REISSUED-CERT             VALUE 'E'.
  1948             88  PB-CASH-CERT                 VALUE 'C'.
  1949             88  PB-MONTHLY-CERT              VALUE 'M'.
  1950             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  1951             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  1952             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  1953         16  PB-FORCE-CODE                PIC X.
  1954             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  1955             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  1956             88  PB-CANCEL-FORCE              VALUE '8'.
  1957             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  1958             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  1959             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  1960             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  1961             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  1962             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  1963             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  1964         16  PB-FATAL-FLAG                PIC X.
  1965             88  PB-FATAL-ERRORS              VALUE 'X'.
  1966         16  PB-FORCE-ER-CD               PIC X.
  1967             88  PB-FORCE-ERRORS              VALUE 'F'.
  1968             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  1969         16  PB-WARN-ER-CD                PIC X.
  1970             88  PB-WARNING-ERRORS            VALUE 'W'.
  1971         16  FILLER                       PIC X.
  1972         16  PB-OUT-BAL-CD                PIC X.
  1973             88  PB-OUT-OF-BAL                VALUE 'O'.
  1974         16  PB-LIFE-OVERRIDE-L1          PIC X.
  1975         16  PB-AH-OVERRIDE-L1            PIC X.
  1976         16  PB-INPUT-DT                  PIC XX.
  1977         16  PB-INPUT-BY                  PIC X(4).
  1978         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  1979         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  1980         16  PB-TOLERANCE-REJECT-SW       PIC X.
  1981         16  PB-LF-EARNING-METHOD         PIC X.
  1982         16  PB-AH-EARNING-METHOD         PIC X.
  1983         16  PB-LF-TERM-CALC-METHOD       PIC X.
  1984         16  PB-AH-TERM-CALC-METHOD       PIC X.
  1985         16  PB-REIN-CD                   PIC XXX.
  1986         16  PB-LF-REFUND-TYPE            PIC X.
  1987         16  PB-AH-REFUND-TYPE            PIC X.
  1988         16  PB-ACCT-EFF-DT               PIC XX.
  1989         16  PB-ACCT-EXP-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  42
* EL631.cbl
  1990         16  PB-COMPANY-ID                PIC X(3).
  1991         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1992         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  1993         16  PB-SV-CARRIER                PIC X.
  1994         16  PB-SV-GROUPING               PIC X(6).
  1995         16  PB-SV-STATE                  PIC XX.
  1996         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  1997         16  PB-GA-BILLING-INFO.
  1998             20  PB-GA-BILL-DT OCCURS 5 TIMES
  1999                                          PIC XX.
  2000         16  PB-SV-REMIT-TO  REDEFINES
  2001             PB-GA-BILLING-INFO           PIC X(10).
  2002         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  2003         16  PB-I-LOAN-OFFICER            PIC X(5).
  2004         16  PB-I-VIN                     PIC X(17).
  2005
  2006         16  FILLER                       PIC X(04).
  2007         16  IMNET-BYPASS-SW              PIC X.
  2008
  2009******************************************************************
  2010*                COMMON EDIT ERRORS                              *
  2011******************************************************************
  2012
  2013     12  PB-COMMON-ERRORS.
  2014         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  2015                                           PIC S9(4)     COMP.
  2016
  2017******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  43
* EL631.cbl
  2019*    COPY ERCACCT.
  2020******************************************************************
  2021*                                                                *
  2022*                                                                *
  2023*                            ERCACCT                             *
  2024*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2025*                            VMOD=2.031                          *
  2026*                                                                *
  2027*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2028*                                                                *
  2029*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2030*   VSAM ACCOUNT MASTER FILES.                                   *
  2031*                                                                *
  2032*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2033*                                                                *
  2034*   FILE TYPE = VSAM,KSDS                                        *
  2035*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2036*                                                                *
  2037*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2038*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2039*                                                                *
  2040*   LOG = NO                                                     *
  2041*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2042*                                                                *
  2043*                                                                *
  2044******************************************************************
  2045*                   C H A N G E   L O G
  2046*
  2047* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2048*-----------------------------------------------------------------
  2049*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2050* EFFECTIVE    NUMBER
  2051*-----------------------------------------------------------------
  2052* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2053* 092705    2005050300006  PEMA  ADD SPP LEASES
  2054* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2055* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2056* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2057* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2058* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2059******************************************************************
  2060
  2061 01  ACCOUNT-MASTER.
  2062     12  AM-RECORD-ID                      PIC XX.
  2063         88  VALID-AM-ID                      VALUE 'AM'.
  2064
  2065     12  AM-CONTROL-PRIMARY.
  2066         16  AM-COMPANY-CD                 PIC X.
  2067         16  AM-MSTR-CNTRL.
  2068             20  AM-CONTROL-A.
  2069                 24  AM-CARRIER            PIC X.
  2070                 24  AM-GROUPING.
  2071                     28 AM-GROUPING-PREFIX PIC XXX.
  2072                     28 AM-GROUPING-PRIME  PIC XXX.
  2073                 24  AM-STATE              PIC XX.
  2074                 24  AM-ACCOUNT.
  2075                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2076                     28  AM-ACCOUNT-PRIME  PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  44
* EL631.cbl
  2077             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2078                                           PIC X(19).
  2079             20  AM-CNTRL-B.
  2080                 24  AM-EXPIRATION-DT      PIC XX.
  2081                 24  FILLER                PIC X(4).
  2082             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2083                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2084
  2085     12  AM-CONTROL-BY-VAR-GRP.
  2086         16  AM-COMPANY-CD-A1              PIC X.
  2087         16  AM-VG-CARRIER                 PIC X.
  2088         16  AM-VG-GROUPING                PIC X(6).
  2089         16  AM-VG-STATE                   PIC XX.
  2090         16  AM-VG-ACCOUNT                 PIC X(10).
  2091         16  AM-VG-DATE.
  2092             20  AM-VG-EXPIRATION-DT       PIC XX.
  2093             20  FILLER                    PIC X(4).
  2094         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2095                                           PIC 9(11)      COMP-3.
  2096     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2097         16  FILLER                        PIC X(10).
  2098         16  AM-VG-KEY3.
  2099             20  AM-VG3-ACCOUNT            PIC X(10).
  2100             20  AM-VG3-EXP-DT             PIC XX.
  2101         16  FILLER                        PIC X(4).
  2102     12  AM-MAINT-INFORMATION.
  2103         16  AM-LAST-MAINT-DT              PIC XX.
  2104         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2105         16  AM-LAST-MAINT-USER            PIC X(4).
  2106         16  FILLER                        PIC XX.
  2107
  2108     12  AM-EFFECTIVE-DT                   PIC XX.
  2109     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2110
  2111     12  AM-PREV-DATES  COMP-3.
  2112         16  AM-PREV-EXP-DT                PIC 9(11).
  2113         16  AM-PREV-EFF-DT                PIC 9(11).
  2114
  2115     12  AM-REPORT-CODE-1                  PIC X(10).
  2116     12  AM-REPORT-CODE-2                  PIC X(10).
  2117
  2118     12  AM-CITY-CODE                      PIC X(4).
  2119     12  AM-COUNTY-PARISH                  PIC X(6).
  2120
  2121     12  AM-NAME                           PIC X(30).
  2122     12  AM-PERSON                         PIC X(30).
  2123     12  AM-ADDRS                          PIC X(30).
  2124     12  AM-CITY.
  2125         16  AM-ADDR-CITY                  PIC X(28).
  2126         16  AM-ADDR-STATE                 PIC XX.
  2127     12  AM-ZIP.
  2128         16  AM-ZIP-PRIME.
  2129             20  AM-ZIP-PRI-1ST            PIC X.
  2130                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2131             20  FILLER                    PIC X(4).
  2132         16  AM-ZIP-PLUS4                  PIC X(4).
  2133     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2134         16  AM-CAN-POSTAL-1               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  45
* EL631.cbl
  2135         16  AM-CAN-POSTAL-2               PIC XXX.
  2136         16  FILLER                        PIC XXX.
  2137     12  AM-TEL-NO.
  2138         16  AM-AREA-CODE                  PIC 999.
  2139         16  AM-TEL-PRE                    PIC 999.
  2140         16  AM-TEL-NBR                    PIC 9(4).
  2141     12  AM-TEL-LOC                        PIC X.
  2142         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2143         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2144
  2145     12  AM-COMM-STRUCTURE.
  2146         16  AM-DEFN-1.
  2147             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2148                 24  AM-AGT.
  2149                     28  AM-AGT-PREFIX     PIC X(4).
  2150                     28  AM-AGT-PRIME      PIC X(6).
  2151                 24  AM-COM-TYP            PIC X.
  2152                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2153                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2154                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2155                 24  AM-RECALC-LV-INDIC    PIC X.
  2156                 24  AM-RETRO-LV-INDIC     PIC X.
  2157                 24  AM-GL-CODES           PIC X.
  2158                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2159                 24  FILLER                PIC X(01).
  2160         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2161             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2162                 24  FILLER                PIC X(11).
  2163                 24  AM-L-COMA             PIC XXX.
  2164                 24  AM-J-COMA             PIC XXX.
  2165                 24  AM-A-COMA             PIC XXX.
  2166                 24  FILLER                PIC X(6).
  2167
  2168     12  AM-COMM-CHANGE-STATUS             PIC X.
  2169         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2170
  2171     12  AM-CSR-CODE                       PIC X(4).
  2172
  2173     12  AM-BILLING-STATUS                 PIC X.
  2174         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2175         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2176     12  AM-AUTO-REFUND-SW                 PIC X.
  2177         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2178         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2179     12  AM-GPCD                           PIC 99.
  2180     12  AM-IG                             PIC X.
  2181         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2182         88  AM-HAS-GROUP                     VALUE '2'.
  2183     12  AM-STATUS                         PIC X.
  2184         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2185         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2186         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2187         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2188         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2189         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2190     12  AM-REMIT-TO                       PIC 99.
  2191     12  AM-ID-NO                          PIC X(11).
  2192
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  46
* EL631.cbl
  2193     12  AM-CAL-TABLE                      PIC XX.
  2194     12  AM-LF-DEVIATION                   PIC XXX.
  2195     12  AM-AH-DEVIATION                   PIC XXX.
  2196     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2197     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2198     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2199     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2200     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2201     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2202
  2203     12  AM-USER-FIELDS.
  2204         16  AM-FLD-1                      PIC XX.
  2205         16  AM-FLD-2                      PIC XX.
  2206         16  AM-FLD-3                      PIC XX.
  2207         16  AM-FLD-4                      PIC XX.
  2208         16  AM-FLD-5                      PIC XX.
  2209
  2210     12  AM-1ST-PROD-DATE.
  2211         16  AM-1ST-PROD-YR                PIC XX.
  2212         16  AM-1ST-PROD-MO                PIC XX.
  2213         16  AM-1ST-PROD-DA                PIC XX.
  2214     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2215     12  AM-CERTS-PURGED-DATE.
  2216         16  AM-PUR-YR                     PIC XX.
  2217         16  AM-PUR-MO                     PIC XX.
  2218         16  AM-PUR-DA                     PIC XX.
  2219     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2220     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2221     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2222     12  AM-INACTIVE-DATE.
  2223         16  AM-INA-MO                     PIC 99.
  2224         16  AM-INA-DA                     PIC 99.
  2225         16  AM-INA-YR                     PIC 99.
  2226     12  AM-AR-HI-CERT-DATE                PIC XX.
  2227
  2228     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2229     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2230
  2231     12  AM-OB-PAYMENT-MODE                PIC X.
  2232         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2233         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2234         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2235         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2236
  2237     12  AM-AH-ONLY-INDICATOR              PIC X.
  2238         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2239         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2240
  2241     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2242
  2243     12  AM-OVER-SHORT.
  2244         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2245         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2246
  2247     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2248     12  AM-DCC-CLP-STATE                  PIC XX.
  2249
  2250     12  AM-RECALC-COMM                    PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  47
* EL631.cbl
  2251     12  AM-RECALC-REIN                    PIC X.
  2252
  2253     12  AM-REI-TABLE                      PIC XXX.
  2254     12  AM-REI-ET-LF                      PIC X.
  2255     12  AM-REI-ET-AH                      PIC X.
  2256     12  AM-REI-PE-LF                      PIC X.
  2257     12  AM-REI-PE-AH                      PIC X.
  2258     12  AM-REI-PRT-ST                     PIC X.
  2259     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2260     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2261     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2262     12  AM-REI-GROUP-A                    PIC X(6).
  2263     12  AM-REI-MORT                       PIC X(4).
  2264     12  AM-REI-PRT-OW                     PIC X.
  2265     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2266     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2267     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2268     12  AM-REI-GROUP-B                    PIC X(6).
  2269
  2270     12  AM-TRUST-TYPE                     PIC X(2).
  2271
  2272     12  AM-EMPLOYER-STMT-USED             PIC X.
  2273     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2274
  2275     12  AM-STD-AH-TYPE                    PIC XX.
  2276     12  AM-EARN-METHODS.
  2277         16  AM-EARN-METHOD-R              PIC X.
  2278             88 AM-REF-RL-R78                 VALUE 'R'.
  2279             88 AM-REF-RL-PR                  VALUE 'P'.
  2280             88 AM-REF-RL-MEAN                VALUE 'M'.
  2281             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2282         16  AM-EARN-METHOD-L              PIC X.
  2283             88 AM-REF-LL-R78                 VALUE 'R'.
  2284             88 AM-REF-LL-PR                  VALUE 'P'.
  2285             88 AM-REF-LL-MEAN                VALUE 'M'.
  2286             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2287         16  AM-EARN-METHOD-A              PIC X.
  2288             88 AM-REF-AH-R78                 VALUE 'R'.
  2289             88 AM-REF-AH-PR                  VALUE 'P'.
  2290             88 AM-REF-AH-MEAN                VALUE 'M'.
  2291             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2292             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2293             88 AM-REF-AH-NET                 VALUE 'N'.
  2294
  2295     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2296     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2297     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2298
  2299     12  AM-RET-Y-N                        PIC X.
  2300     12  AM-RET-P-E                        PIC X.
  2301     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2302     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2303     12  AM-RET-GRP                        PIC X(6).
  2304     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2305         16  AM-POOL-PRIME                 PIC XXX.
  2306         16  AM-POOL-SUB                   PIC XXX.
  2307     12  AM-RETRO-EARNINGS.
  2308         16  AM-RET-EARN-R                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  48
* EL631.cbl
  2309         16  AM-RET-EARN-L                 PIC X.
  2310         16  AM-RET-EARN-A                 PIC X.
  2311     12  AM-RET-ST-TAX-USE                 PIC X.
  2312         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2313         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2314     12  AM-RETRO-BEG-EARNINGS.
  2315         16  AM-RET-BEG-EARN-R             PIC X.
  2316         16  AM-RET-BEG-EARN-L             PIC X.
  2317         16  AM-RET-BEG-EARN-A             PIC X.
  2318     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2319     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2320
  2321     12  AM-USER-SELECT-OPTIONS.
  2322         16  AM-USER-SELECT-1              PIC X(10).
  2323         16  AM-USER-SELECT-2              PIC X(10).
  2324         16  AM-USER-SELECT-3              PIC X(10).
  2325         16  AM-USER-SELECT-4              PIC X(10).
  2326         16  AM-USER-SELECT-5              PIC X(10).
  2327
  2328     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2329
  2330     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2331
  2332     12  AM-RPT045A-SWITCH                 PIC X.
  2333         88  RPT045A-OFF                   VALUE 'N'.
  2334
  2335     12  AM-INSURANCE-LIMITS.
  2336         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2337         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2338
  2339     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2340         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2341
  2342     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2343         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2344         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2345
  2346     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2347
  2348     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2349     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2350     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2351     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2352     12  AM-DCC-UEF-STATE                  PIC XX.
  2353     12  FILLER                            PIC XXX.
  2354     12  AM-REPORT-CODE-3                  PIC X(10).
  2355*    12  FILLER                            PIC X(22).
  2356
  2357     12  AM-RESERVE-DATE.
  2358         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2359         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2360         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2361
  2362     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2363     12  AM-NOTIFICATION-TYPES.
  2364         16  AM-NOTIF-OF-LETTERS           PIC X.
  2365         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2366         16  AM-NOTIF-OF-REPORTS           PIC X.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  49
* EL631.cbl
  2367         16  AM-NOTIF-OF-STATUS            PIC X.
  2368
  2369     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2370         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2371         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2372         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2373         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2374
  2375     12  AM-BENEFIT-CONTROLS.
  2376         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2377             20  AM-BENEFIT-CODE           PIC XX.
  2378             20  AM-BENEFIT-TYPE           PIC X.
  2379             20  AM-BENEFIT-REVISION       PIC XXX.
  2380             20  AM-BENEFIT-REM-TERM       PIC X.
  2381             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2382             20  FILLER                    PIC XX.
  2383         16  FILLER                        PIC X(80).
  2384
  2385     12  AM-TRANSFER-DATA.
  2386         16  AM-TRANSFERRED-FROM.
  2387             20  AM-TRNFROM-CARRIER        PIC X.
  2388             20  AM-TRNFROM-GROUPING.
  2389                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2390                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2391             20  AM-TRNFROM-STATE          PIC XX.
  2392             20  AM-TRNFROM-ACCOUNT.
  2393                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2394                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2395             20  AM-TRNFROM-DTE            PIC XX.
  2396         16  AM-TRANSFERRED-TO.
  2397             20  AM-TRNTO-CARRIER          PIC X.
  2398             20  AM-TRNTO-GROUPING.
  2399                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2400                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2401             20  AM-TRNTO-STATE            PIC XX.
  2402             20  AM-TRNTO-ACCOUNT.
  2403                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2404                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2405             20  AM-TRNTO-DTE              PIC XX.
  2406         16  FILLER                        PIC X(10).
  2407
  2408     12  AM-SAVED-REMIT-TO                 PIC 99.
  2409
  2410     12  AM-COMM-STRUCTURE-SAVED.
  2411         16  AM-DEFN-1-SAVED.
  2412             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2413                 24  AM-AGT-SV             PIC X(10).
  2414                 24  AM-COM-TYP-SV         PIC X.
  2415                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2416                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2417                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2418                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2419                 24  FILLER                PIC X.
  2420                 24  AM-GL-CODES-SV        PIC X.
  2421                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2422                 24  FILLER                PIC X.
  2423         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2424             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  50
* EL631.cbl
  2425                 24  FILLER                PIC X(11).
  2426                 24  AM-L-COMA-SV          PIC XXX.
  2427                 24  AM-J-COMA-SV          PIC XXX.
  2428                 24  AM-A-COMA-SV          PIC XXX.
  2429                 24  FILLER                PIC X(6).
  2430
  2431     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2432         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2433            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2434            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2435            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2436
  2437     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2438     12  FILLER                            PIC X(120).
  2439
  2440     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2441         16  AM-CONTROL-NAME               PIC X(30).
  2442         16  AM-EXECUTIVE-ONE.
  2443             20  AM-EXEC1-NAME             PIC X(15).
  2444             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2445                                                          COMP-3.
  2446             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2447                                                          COMP-3.
  2448         16  AM-EXECUTIVE-TWO.
  2449             20  AM-EXEC2-NAME             PIC X(15).
  2450             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2451                                                          COMP-3.
  2452             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2453                                                          COMP-3.
  2454
  2455     12  AM-RETRO-ADDITIONAL-DATA.
  2456         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2457         16  AM-RETRO-PREM-P-E             PIC X.
  2458         16  AM-RETRO-CLMS-P-I             PIC X.
  2459         16  AM-RETRO-RET-BRACKET-LF.
  2460             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2461                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2462                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2463             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2464                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2465                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2466             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2467                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2468                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2469         16  AM-RETRO-RET-BRACKET-AH.
  2470             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2471                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2472                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2473                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2474             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2475                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2476                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2477             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2478                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2479                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2480
  2481     12  AM-COMMENTS.
  2482         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  51
* EL631.cbl
  2483
  2484     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2485         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2486         16  AM-FLI-BILLING-CODE           PIC X.
  2487         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2488         16  AM-FLI-UNITED-IDENT           PIC X.
  2489         16  AM-FLI-INTEREST-LOST-DATA.
  2490             20  AM-FLI-BANK-NO            PIC X(5).
  2491             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2492             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2493             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2494         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2495             20  AM-FLI-AGT                PIC X(9).
  2496             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2497             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2498         16  FILLER                        PIC X(102).
  2499
  2500     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2501         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2502             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2503             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2504             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2505             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2506             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2507         16  FILLER                          PIC X(10).
  2508******************************************************************
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  52
* EL631.cbl
  2510 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-BUSINESS
  2511                          ACCOUNT-MASTER.
  2512 0000-DFHEXIT SECTION.
  2513     MOVE '9#                    $   ' TO DFHEIV0.
  2514     MOVE 'EL631' TO DFHEIV1.
  2515     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2516
  2517     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  2518     MOVE '5'                   TO DC-OPTION-CODE.
  2519     PERFORM 9700-DATE-LINK.
  2520     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  2521     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  2522
  2523     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  2524     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  2525     MOVE EIBTRMID               TO QID-TERM.
  2526
  2527     IF EIBCALEN = 0
  2528         GO TO 8800-UNAUTHORIZED-ACCESS.
  2529
  2530     MOVE LOW-VALUES             TO EL631AI.
  2531
  2532     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2533         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2534             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2535             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2536             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2537             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2538             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2539             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2540             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2541             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  2542             IF PI-COMPANY-ID = CLIENT-MIC OR CLIENT-PEM OR
  2543                                CLIENT-FLA
  2544                MOVE 'Y'               TO ORGINALI
  2545             END-IF
  2546         ELSE
  2547             MOVE PI-CALLING-PROGRAM   TO RETURN-FROM
  2548             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2549             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2550             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2551             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2552             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2553             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2554             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2555             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  2556             PERFORM 6000-BUILD-SCREEN THRU 6099-EXIT.
  2557
  2558******************************************************************
  2559*                                                                *
  2560*        IF THERE WERE NO RECORDS FOUND FOR CARRIER AND ACCOUNT  *
  2561*        DISPLAY ORIGINAL SCREEN.                                *
  2562*                                                                *
  2563******************************************************************
  2564
  2565     IF PI-NO-PB-RECS-FOUND
  2566         MOVE SPACE TO PI-BROWSE-SW
  2567         GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  53
* EL631.cbl
  2568
  2569     IF EIBTRNID NOT = TRANS-ID
  2570         GO TO 8100-SEND-INITIAL-MAP.
  2571
  2572
  2573* EXEC CICS HANDLE CONDITION
  2574*        PGMIDERR  (9600-PGMID-ERROR)
  2575*        ERROR     (9990-ABEND)
  2576*    END-EXEC.
  2577*    MOVE '"$L.                  ! " #00002568' TO DFHEIV0
  2578     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2579     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2580     MOVE X'2220233030303032353638' TO DFHEIV0(25:11)
  2581     CALL 'kxdfhei1' USING DFHEIV0
  2582     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2583
  2584
  2585     IF EIBAID = DFHCLEAR
  2586         GO TO 9400-CLEAR.
  2587
  2588     IF PI-PROCESSOR-ID = 'LGXX'
  2589         GO TO 0200-RECEIVE.
  2590
  2591
  2592* EXEC CICS READQ TS
  2593*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  2594*        INTO   (SECURITY-CONTROL)
  2595*        LENGTH (SC-COMM-LENGTH)
  2596*        ITEM   (SC-ITEM)
  2597*    END-EXEC.
  2598*    MOVE '*$II   L              ''   #00002579' TO DFHEIV0
  2599     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  2600     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2601     MOVE X'2020233030303032353739' TO DFHEIV0(25:11)
  2602     CALL 'kxdfhei1' USING DFHEIV0,
  2603           PI-SECURITY-TEMP-STORE-ID,
  2604           SECURITY-CONTROL,
  2605           SC-COMM-LENGTH,
  2606           SC-ITEM,
  2607           DFHEIV99,
  2608           DFHEIV99
  2609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2610
  2611
  2612     MOVE SC-CREDIT-DISPLAY (12)  TO PI-DISPLAY-CAP.
  2613     MOVE SC-CREDIT-UPDATE  (12)  TO PI-MODIFY-CAP.
  2614
  2615     IF NOT DISPLAY-CAP
  2616         MOVE 'READ'          TO SM-READ
  2617         PERFORM 9995-SECURITY-VIOLATION
  2618         MOVE ER-0070         TO  EMI-ERROR
  2619         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2620         GO TO 8100-SEND-INITIAL-MAP.
  2621
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  54
* EL631.cbl
  2623
  2624 0200-RECEIVE.
  2625     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2626         MOVE ER-0008            TO EMI-ERROR
  2627         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2628         MOVE -1                 TO BATCHL
  2629         GO TO 8200-SEND-DATAONLY.
  2630
  2631
  2632* EXEC CICS RECEIVE
  2633*        MAP      (MAP-NAME)
  2634*        MAPSET   (MAPSET-NAME)
  2635*        INTO     (EL631AI)
  2636*    END-EXEC.
  2637     MOVE LENGTH OF
  2638      EL631AI
  2639       TO DFHEIV11
  2640*    MOVE '8"T I  L              ''   #00002605' TO DFHEIV0
  2641     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2642     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2643     MOVE X'2020233030303032363035' TO DFHEIV0(25:11)
  2644     CALL 'kxdfhei1' USING DFHEIV0,
  2645           MAP-NAME,
  2646           EL631AI,
  2647           DFHEIV11,
  2648           MAPSET-NAME,
  2649           DFHEIV99,
  2650           DFHEIV99
  2651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2652
  2653
  2654     IF PFENTERL = 0
  2655         GO TO 0300-CHECK-PFKEYS.
  2656
  2657     IF EIBAID NOT = DFHENTER
  2658         MOVE ER-0004            TO EMI-ERROR
  2659         GO TO 0320-INPUT-ERROR.
  2660
  2661     IF PFENTERI NUMERIC
  2662        IF PFENTERI GREATER 0 AND LESS 25
  2663           MOVE PF-VALUES (PFENTERI) TO EIBAID
  2664        ELSE
  2665           MOVE ER-0029            TO EMI-ERROR
  2666           GO TO 0320-INPUT-ERROR.
  2667
  2668 0300-CHECK-PFKEYS.
  2669     IF EIBAID = DFHPF1 OR DFHPF2 OR DFHPF3
  2670        GO TO 330-EDIT-INPUT-DATA.
  2671
  2672     IF EIBAID = DFHPF23
  2673         GO TO 8810-PF23.
  2674
  2675     IF EIBAID = DFHPF24
  2676         GO TO 9200-RETURN-MAIN-MENU.
  2677
  2678     IF EIBAID = DFHPF12
  2679         GO TO 9500-PF12.
  2680
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  55
* EL631.cbl
  2681     IF EIBAID = DFHENTER
  2682         GO TO 330-EDIT-INPUT-DATA.
  2683
  2684     MOVE ER-0029                TO EMI-ERROR.
  2685
  2686 0320-INPUT-ERROR.
  2687     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2688     MOVE AL-UNBON               TO PFENTERA.
  2689
  2690     IF PFENTERL = 0
  2691         MOVE -1                 TO BATCHL
  2692     ELSE
  2693         MOVE -1                 TO PFENTERL.
  2694
  2695     GO TO 8200-SEND-DATAONLY.
  2696
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  56
* EL631.cbl
  2698
  2699 330-EDIT-INPUT-DATA.
  2700     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  2701     MOVE PI-ENTRY-CD-1          TO PI-CSR-SESSION-SW
  2702     MOVE LOW-VALUES             TO PI-ERPNDB-KEY
  2703                                    PI-ERPNDB-ALT-KEY.
  2704
  2705     MOVE PI-COMPANY-CD          TO PI-PB-COMPANY-CD
  2706                                    PI-PB-COMPANY-CD-A1.
  2707
  2708     IF ANYISSI NOT = 'N' AND 'Y'
  2709        MOVE -1                  TO ANYISSL
  2710        MOVE AL-UABON            TO ANYISSA
  2711        PERFORM 0350-SELECTION-ERROR
  2712     ELSE
  2713        MOVE ANYISSI             TO PI-ISSUES-IN-ERROR-SW.
  2714
  2715     IF ANYCANI NOT = 'N' AND 'Y'
  2716        MOVE -1                  TO ANYCANL
  2717        MOVE AL-UABON            TO ANYCANA
  2718        PERFORM 0350-SELECTION-ERROR
  2719     ELSE
  2720        MOVE ANYCANI             TO PI-CANCELS-IN-ERROR-SW.
  2721
  2722     IF ALLISSI NOT = 'N' AND 'Y'
  2723        MOVE -1                  TO ALLISSL
  2724        MOVE AL-UABON            TO ALLISSA
  2725        PERFORM 0350-SELECTION-ERROR
  2726     ELSE
  2727        MOVE ALLISSI             TO PI-ALL-ISSUES-SW.
  2728
  2729     IF ALLCANI NOT = 'N' AND 'Y'
  2730        MOVE -1                  TO ALLCANL
  2731        MOVE AL-UABON            TO ALLCANA
  2732        PERFORM 0350-SELECTION-ERROR
  2733     ELSE
  2734        MOVE ALLCANI             TO PI-ALL-CANCELS-SW.
  2735
  2736     IF ONLYHDRI NOT = 'N' AND 'Y'
  2737        MOVE -1                  TO ONLYHDRL
  2738        MOVE AL-UABON            TO ONLYHDRA
  2739        PERFORM 0350-SELECTION-ERROR
  2740     ELSE
  2741        MOVE ONLYHDRI             TO PI-ONLY-BATCH-HEADERS-SW.
  2742
  2743     IF OUTBALI NOT = 'N' AND 'Y'
  2744        MOVE -1                  TO OUTBALL
  2745        MOVE AL-UABON            TO OUTBALA
  2746        PERFORM 0350-SELECTION-ERROR
  2747     ELSE
  2748        MOVE OUTBALI             TO PI-ALL-OUT-OF-BAL-SW.
  2749
  2750     IF HLDRECI NOT = 'N' AND 'Y'
  2751        MOVE -1                  TO HLDRECL
  2752        MOVE AL-UABON            TO HLDRECA
  2753        PERFORM 0350-SELECTION-ERROR
  2754     ELSE
  2755        MOVE HLDRECI             TO PI-HOLD-REC-SW.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  57
* EL631.cbl
  2756
  2757     IF CHGRECI NOT = 'N' AND 'Y'
  2758        MOVE -1                  TO CHGRECL
  2759        MOVE AL-UABON            TO CHGRECA
  2760        PERFORM 0350-SELECTION-ERROR
  2761     ELSE
  2762        MOVE CHGRECI             TO PI-CHANGE-REC-SW.
  2763
  2764     IF CHKREQI NOT = 'N' AND 'Y'
  2765        MOVE -1                  TO CHKREQL
  2766        MOVE AL-UABON            TO CHKREQA
  2767        PERFORM 0350-SELECTION-ERROR
  2768     ELSE
  2769        MOVE CHKREQI             TO PI-CHK-REQ-REC-SW.
  2770
  2771     IF STARTATI NOT = 'N' AND 'Y'
  2772        MOVE -1                  TO STARTATL
  2773        MOVE AL-UABON            TO STARTATA
  2774        PERFORM 0350-SELECTION-ERROR.
  2775
  2776     IF ORGINALI NOT = 'N' AND 'Y'
  2777        MOVE -1                  TO ORGINALL
  2778        MOVE AL-UABON            TO ORGINALA
  2779        PERFORM 0350-SELECTION-ERROR
  2780     ELSE
  2781        MOVE ORGINALI            TO PI-ORIGINAL-BATCH-SW.
  2782
  2783     IF ANYISSWI NOT = 'N' AND 'Y'
  2784        MOVE -1                  TO ANYISSWL
  2785        MOVE AL-UABON            TO ANYISSWA
  2786        PERFORM 0350-SELECTION-ERROR
  2787     ELSE
  2788        MOVE ANYISSWI            TO PI-ISSUE-WARNING-SW.
  2789
  2790     IF ANYCANWI NOT = 'N' AND 'Y'
  2791        MOVE -1                  TO ANYCANWL
  2792        MOVE AL-UABON            TO ANYCANWA
  2793        PERFORM 0350-SELECTION-ERROR
  2794     ELSE
  2795        MOVE ANYCANWI            TO PI-CANCEL-WARNING-SW.
  2796
  2797     IF NOT EMI-NO-ERRORS
  2798        GO TO 8200-SEND-DATAONLY.
  2799
  2800     IF ANYISSI = 'Y' AND (ALLISSI = 'Y' OR ANYISSWI = 'Y')
  2801        MOVE -1                  TO ANYISSL
  2802        MOVE AL-UABON            TO ANYISSA  ANYISSWA ALLISSA
  2803        PERFORM 0360-COMBINATION-ERROR.
  2804
  2805     IF ANYISSWI = 'Y' AND (ALLISSI = 'Y' OR ANYISSI = 'Y')
  2806        MOVE -1                  TO ANYISSL
  2807        MOVE AL-UABON            TO ANYISSA  ANYISSWA ALLISSA
  2808        PERFORM 0360-COMBINATION-ERROR.
  2809
  2810     IF ANYCANI = 'Y' AND (ALLCANI = 'Y' OR ANYCANWI = 'Y')
  2811        MOVE -1                  TO ANYCANL
  2812        MOVE AL-UABON            TO ANYCANA  ANYCANWA ALLCANA
  2813        PERFORM 0360-COMBINATION-ERROR.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  58
* EL631.cbl
  2814
  2815     IF ANYCANWI = 'Y' AND (ALLCANI = 'Y' OR ANYCANI = 'Y')
  2816        MOVE -1                  TO ANYCANL
  2817        MOVE AL-UABON            TO ANYCANA  ANYCANWA ALLCANA
  2818        PERFORM 0360-COMBINATION-ERROR.
  2819
  2820     IF OUTBALI = 'Y' AND ONLYHDRI = 'Y'
  2821        MOVE -1                  TO ONLYHDRL
  2822        MOVE AL-UABON            TO ONLYHDRA  OUTBALA
  2823        PERFORM 0360-COMBINATION-ERROR.
  2824
  2825     IF STARTATI = 'Y'
  2826        IF BATCHL NOT GREATER THAN ZEROS
  2827           MOVE -1                  TO BATCHL
  2828           MOVE AL-UANOF            TO BATCHA
  2829           MOVE ER-2201             TO EMI-ERROR
  2830           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2831
  2832     IF ANYISSI  = 'N' AND ALLISSI  = 'N' AND
  2833        ANYCANI  = 'N' AND ALLCANI  = 'N' AND
  2834        OUTBALI  = 'N' AND ONLYHDRI = 'N' AND
  2835        ANYISSWI = 'N' AND ANYCANWI = 'N'
  2836        MOVE ER-0329             TO EMI-ERROR
  2837        MOVE -1                  TO ANYISSL
  2838        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2839
  2840     IF PI-COMPANY-ID = CLIENT-MIC OR CLIENT-PEM OR CLIENT-FLA
  2841        IF ORGINALI = 'N'
  2842           NEXT SENTENCE
  2843        ELSE
  2844           IF CARRIERL = ZEROS AND GROUPL = ZEROS AND
  2845              STATEL = ZEROS   AND ACCOUNTL = ZEROS AND
  2846              BATCHL = ZEROS
  2847              MOVE -1            TO BATCHL
  2848              MOVE ER-2150       TO EMI-ERROR
  2849              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2850
  2851     IF (ONLYHDRI = 'Y' OR OUTBALI = 'Y' OR
  2852        CHGRECI  = 'Y') AND ORGINALI = 'Y'
  2853        MOVE -1                  TO ORGINALL
  2854        PERFORM 0360-COMBINATION-ERROR.
  2855
  2856     IF (ANYISSI  = 'Y' OR ALLISSI  = 'Y' OR
  2857         ANYISSWI = 'Y' OR ANYCANWI = 'Y' OR
  2858         ANYCANI  = 'Y' OR ALLCANI  = 'Y')   AND
  2859        (OUTBALI  = 'Y' OR ONLYHDRI = 'Y')
  2860        MOVE -1                  TO ANYISSL
  2861        PERFORM 0360-COMBINATION-ERROR.
  2862
  2863     IF (ANYISSI = 'Y' OR ALLISSI   = 'Y' OR
  2864         CHGRECI = 'Y' OR ONLYHDRI  = 'Y' OR
  2865         OUTBALI = 'Y' OR ANYISSWI  = 'Y')
  2866         AND CHKREQI = 'Y'
  2867         MOVE -1                  TO ANYISSL
  2868         PERFORM 0360-COMBINATION-ERROR.
  2869
  2870     IF  EIBAID = DFHPF1
  2871         GO TO 330-CHECK-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  59
* EL631.cbl
  2872
  2873     IF PI-CARRIER-SECURITY GREATER THAN SPACES
  2874        IF  CARRIERL GREATER THAN ZEROS
  2875            IF PI-CARRIER-SECURITY = CARRIERI
  2876               MOVE AL-UANON     TO CARRIERA
  2877            ELSE
  2878               MOVE ER-2372      TO EMI-ERROR
  2879               MOVE -1           TO CARRIERL
  2880               MOVE AL-UABON     TO CARRIERA
  2881               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2882
  2883     IF PI-ACCOUNT-SECURITY GREATER THAN SPACES
  2884        IF  ACCOUNTL GREATER THAN ZEROS
  2885            IF PI-ACCOUNT-SECURITY = ACCOUNTI
  2886               MOVE AL-UANON     TO ACCOUNTA
  2887            ELSE
  2888               MOVE ER-2372      TO EMI-ERROR
  2889               MOVE -1           TO ACCOUNTL
  2890               MOVE AL-UABON     TO ACCOUNTA
  2891               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2892
  2893     IF BATCHL  GREATER THAN +0
  2894        IF CSRL GREATER THAN +0
  2895           MOVE AL-UABON         TO BATCHA
  2896                                    CSRA
  2897           MOVE ER-2971          TO EMI-ERROR
  2898           MOVE -1               TO BATCHL
  2899           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2900
  2901 330-CHECK-ERRORS.
  2902     IF NOT EMI-NO-ERRORS
  2903        GO TO 8200-SEND-DATAONLY.
  2904
  2905     IF EIBAID = DFHPF1
  2906         PERFORM 5000-CREATE-TEMP-STORAGE THRU 5000-EXIT
  2907         MOVE XCTL-630            TO PGM-NAME
  2908         GO TO 9300-XCTL.
  2909
  2910     IF EIBAID = DFHPF2
  2911         PERFORM 5000-CREATE-TEMP-STORAGE THRU 5000-EXIT
  2912         MOVE XCTL-663            TO PGM-NAME
  2913         GO TO 9300-XCTL.
  2914
  2915     IF EIBAID = DFHPF3
  2916         PERFORM 5000-CREATE-TEMP-STORAGE THRU 5000-EXIT
  2917         MOVE XCTL-656            TO PGM-NAME
  2918         GO TO 9300-XCTL.
  2919
  2920     IF PI-NO-ACCOUNT-SECURITY
  2921        IF PI-NO-CARRIER-SECURITY
  2922           GO TO 330-CONTINUE-EDIT.
  2923
  2924     IF ONLY-BATCH-HEADERS OR ALL-OUT-OF-BAL
  2925         GO TO 330-CONTINUE-EDIT.
  2926
  2927     IF BATCHL GREATER THAN ZEROS
  2928         GO TO 330-CONTINUE-EDIT.
  2929
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  60
* EL631.cbl
  2930     IF CARRIERL GREATER THAN ZEROS
  2931         GO TO 330-CONTINUE-EDIT.
  2932
  2933     MOVE -1                     TO BATCHL.
  2934     MOVE ER-2377                TO EMI-ERROR.
  2935     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2936     GO TO 8200-SEND-DATAONLY.
  2937
  2938 330-CONTINUE-EDIT.
  2939     MOVE ZEROS                  TO PI-PB-BATCH-SEQ-NO.
  2940
  2941     IF BATCHL NOT = ZERO
  2942        MOVE BATCHI              TO PI-PB-ENTRY-BATCH
  2943        PERFORM 6200-READ-FILE  THRU 6299-EXIT
  2944     ELSE
  2945        GO TO 330-SET-BROWSE-CONTROL.
  2946
  2947     IF SEQL NOT = ZERO
  2948         IF SEQI NOT NUMERIC
  2949             MOVE ER-2314 TO EMI-ERROR
  2950             MOVE -1             TO SEQL
  2951             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2952             GO TO 8200-SEND-DATAONLY
  2953         ELSE
  2954             MOVE SEQI TO PI-PB-BATCH-SEQ-NO.
  2955
  2956     IF PI-CARRIER-SECURITY GREATER THAN SPACES
  2957        IF PI-CARRIER-SECURITY = PB-CARRIER NEXT SENTENCE
  2958     ELSE
  2959        MOVE ER-2372             TO EMI-ERROR
  2960        MOVE -1                  TO BATCHL
  2961        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2962        GO TO 8200-SEND-DATAONLY.
  2963
  2964     IF PI-ACCOUNT-SECURITY GREATER THAN SPACES
  2965        IF PI-ACCOUNT-SECURITY = PB-ACCOUNT
  2966         NEXT SENTENCE
  2967     ELSE
  2968        MOVE ER-2372             TO EMI-ERROR
  2969        MOVE -1                  TO BATCHL
  2970        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2971        GO TO 8200-SEND-DATAONLY.
  2972
  2973 330-SET-BROWSE-CONTROL.
  2974
  2975     IF CSRL GREATER THAN +0
  2976        IF OUTBALI = 'Y' OR ONLYHDRI = 'Y'
  2977           MOVE LOW-VALUES          TO PI-ERPNDB-CSR-KEY
  2978           MOVE PI-COMPANY-CD       TO PI-PB-CSR-COMPANY-CD-A2
  2979           MOVE CSRI                TO PI-PB-CSR-ID
  2980           MOVE SPACES           TO PI-PB-CARRIER   PI-PB-GROUPING
  2981                                    PI-PB-STATE     PI-PB-ACCOUNT
  2982           MOVE '4'                 TO PI-BROWSE-TYPE
  2983           GO TO 0340-XCTL.
  2984
  2985     IF OUTBALI = 'Y' OR ONLYHDRI = 'Y'
  2986        IF CARRIERL = ZEROS AND GROUPL = ZEROS AND
  2987           STATEL = ZEROS   AND ACCOUNTL = ZEROS
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  61
* EL631.cbl
  2988           MOVE SPACES           TO PI-PB-CARRIER   PI-PB-GROUPING
  2989                                    PI-PB-STATE     PI-PB-ACCOUNT
  2990           MOVE  '1'             TO PI-BROWSE-TYPE
  2991           GO TO 0340-XCTL
  2992        ELSE
  2993           PERFORM 6100-BUILD-KEY THRU 6199-EXIT
  2994           MOVE  '1'             TO PI-BROWSE-TYPE
  2995           GO TO 0340-XCTL.
  2996
  2997     IF CERTNOL NOT = ZEROS
  2998        MOVE CERTNOI             TO PI-PB-CERT-PRIME
  2999        MOVE SPACE               TO PI-PB-CERT-SFX
  3000        IF SUFFIXL NOT = ZEROS
  3001           MOVE SUFFIXI          TO PI-PB-CERT-SFX
  3002        ELSE
  3003           NEXT SENTENCE
  3004     ELSE
  3005        MOVE LOW-VALUES          TO PI-PB-CERT-NO.
  3006
  3007     IF EFFDTL NOT = ZEROS
  3008        MOVE EFFDTI                 TO DEEDIT-FIELD
  3009        PERFORM 8600-DEEDIT
  3010        MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY
  3011        MOVE '4'                    TO DC-OPTION-CODE
  3012        PERFORM 9700-DATE-LINK
  3013        IF DATE-CONVERSION-ERROR
  3014           MOVE ER-0348             TO EMI-ERROR
  3015           MOVE -1                  TO EFFDTL
  3016           MOVE AL-UABON            TO EFFDTA
  3017           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3018        ELSE
  3019           MOVE DC-GREG-DATE-1-EDIT TO EFFDTI
  3020           MOVE AL-UANON            TO EFFDTA
  3021           MOVE DC-BIN-DATE-1       TO PI-PB-CERT-EFF-DT.
  3022
  3023     IF CSRL GREATER THAN +0
  3024        MOVE LOW-VALUES             TO PI-ERPNDB-CSR-KEY
  3025        MOVE PI-COMPANY-CD          TO PI-PB-CSR-COMPANY-CD-A2
  3026        MOVE CSRI                   TO PI-PB-CSR-ID
  3027        MOVE '4'                    TO PI-BROWSE-TYPE
  3028        GO TO 0340-XCTL.
  3029
  3030     IF CARRIERL = ZEROS AND
  3031        GROUPL   = ZEROS AND
  3032        STATEL   = ZEROS AND
  3033        ACCOUNTL = ZEROS
  3034        IF BATCHL NOT = ZEROS
  3035           GO TO 0335-SET-BROWSE-TYPE
  3036        ELSE
  3037           MOVE ' '                 TO PI-BROWSE-TYPE
  3038           GO TO 0340-XCTL.
  3039
  3040     PERFORM 6100-BUILD-KEY THRU 6199-EXIT.
  3041
  3042     IF NOT EMI-NO-ERRORS
  3043        GO TO 8200-SEND-DATAONLY.
  3044
  3045     IF PI-COMPANY-ID NOT = 'DMD'
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  62
* EL631.cbl
  3046         PERFORM 6300-READ-ACCOUNT-FILE THRU 6399-EXIT.
  3047
  3048 0335-SET-BROWSE-TYPE.
  3049     IF STARTATI = 'Y'
  3050        MOVE BATCHI              TO PI-PB-ENTRY-BATCH
  3051        MOVE SPACE               TO PI-BROWSE-TYPE
  3052        GO TO 0340-XCTL.
  3053
  3054     IF BATCHL NOT = ZEROS
  3055        IF CERTNOL = ZEROS AND EFFDTL = ZEROS
  3056           MOVE '1'              TO PI-BROWSE-TYPE
  3057        ELSE
  3058           MOVE '3'              TO PI-BROWSE-TYPE
  3059     ELSE
  3060        MOVE '2'              TO PI-BROWSE-TYPE.
  3061
  3062 0340-XCTL.
  3063     if pi-company-id = 'VPP'
  3064        move 'VP6311'            TO PGM-NAME
  3065     ELSE
  3066        MOVE XCTL-6311           TO PGM-NAME
  3067     END-IF
  3068
  3069* EXEC CICS XCTL
  3070*        PROGRAM    (PGM-NAME)
  3071*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3072*        LENGTH     (1300)
  3073*    END-EXEC.
  3074     MOVE 1300
  3075       TO DFHEIV11
  3076*    MOVE '.$C                   %   #00003025' TO DFHEIV0
  3077     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3078     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3079     MOVE X'2020233030303033303235' TO DFHEIV0(25:11)
  3080     CALL 'kxdfhei1' USING DFHEIV0,
  3081           PGM-NAME,
  3082           PROGRAM-INTERFACE-BLOCK,
  3083           DFHEIV11,
  3084           DFHEIV99
  3085     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3086
  3087
  3088 0350-SELECTION-ERROR.
  3089     MOVE ER-2190                TO EMI-ERROR.
  3090     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3091
  3092 0360-COMBINATION-ERROR.
  3093     MOVE ER-2191                TO EMI-ERROR.
  3094     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3095
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  63
* EL631.cbl
  3097
  3098 5000-CREATE-TEMP-STORAGE.
  3099
  3100* EXEC CICS WRITEQ TS
  3101*        QUEUE    (QID)
  3102*        FROM     (PROGRAM-INTERFACE-BLOCK)
  3103*        LENGTH   (PI-COMM-LENGTH)
  3104*    END-EXEC.
  3105*    MOVE '*"                    ''   #00003042' TO DFHEIV0
  3106     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  3107     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3108     MOVE X'2020233030303033303432' TO DFHEIV0(25:11)
  3109     CALL 'kxdfhei1' USING DFHEIV0,
  3110           QID,
  3111           PROGRAM-INTERFACE-BLOCK,
  3112           PI-COMM-LENGTH,
  3113           DFHEIV99,
  3114           DFHEIV99,
  3115           DFHEIV99
  3116     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3117
  3118
  3119 5000-EXIT.
  3120      EXIT.
  3121
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  64
* EL631.cbl
  3123
  3124 5050-RECOVER-TEMP-STORAGE.
  3125
  3126* EXEC CICS HANDLE CONDITION
  3127*        QIDERR  (5050-QID-ERROR)
  3128*    END-EXEC.
  3129*    MOVE '"$N                   ! # #00003054' TO DFHEIV0
  3130     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  3131     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3132     MOVE X'2320233030303033303534' TO DFHEIV0(25:11)
  3133     CALL 'kxdfhei1' USING DFHEIV0
  3134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3135
  3136
  3137
  3138* EXEC CICS READQ TS
  3139*         QUEUE   (QID)
  3140*         INTO    (PROGRAM-INTERFACE-BLOCK)
  3141*         LENGTH  (PI-COMM-LENGTH)
  3142*     END-EXEC.
  3143*    MOVE '*$I    L              ''   #00003058' TO DFHEIV0
  3144     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  3145     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3146     MOVE X'2020233030303033303538' TO DFHEIV0(25:11)
  3147     CALL 'kxdfhei1' USING DFHEIV0,
  3148           QID,
  3149           PROGRAM-INTERFACE-BLOCK,
  3150           PI-COMM-LENGTH,
  3151           DFHEIV99,
  3152           DFHEIV99,
  3153           DFHEIV99
  3154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3155
  3156
  3157
  3158* EXEC CICS DELETEQ TS
  3159*        QUEUE   (QID)
  3160*    END-EXEC.
  3161*    MOVE '*&                    #   #00003064' TO DFHEIV0
  3162     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  3163     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3164     MOVE X'2020233030303033303634' TO DFHEIV0(25:11)
  3165     CALL 'kxdfhei1' USING DFHEIV0,
  3166           QID,
  3167           DFHEIV99
  3168     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3169
  3170
  3171     GO TO 5050-EXIT.
  3172
  3173 5050-QID-ERROR.
  3174     MOVE ER-0033                TO EMI-ERROR.
  3175     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3176
  3177 5050-EXIT.
  3178      EXIT.
  3179
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  65
* EL631.cbl
  3181
  3182 6000-BUILD-SCREEN.
  3183     IF RETURN-FROM = XCTL-630 OR XCTL-663 OR XCTL-656
  3184        PERFORM 5050-RECOVER-TEMP-STORAGE THRU 5050-EXIT.
  3185
  3186     MOVE PI-ISSUES-IN-ERROR-SW      TO ANYISSI.
  3187     MOVE PI-CANCELS-IN-ERROR-SW     TO ANYCANI.
  3188     MOVE PI-ALL-ISSUES-SW           TO ALLISSI.
  3189     MOVE PI-ALL-CANCELS-SW          TO ALLCANI.
  3190     MOVE PI-ONLY-BATCH-HEADERS-SW   TO ONLYHDRI.
  3191     MOVE PI-ALL-OUT-OF-BAL-SW       TO OUTBALI.
  3192     MOVE PI-HOLD-REC-SW             TO HLDRECI.
  3193     MOVE PI-CHANGE-REC-SW           TO CHGRECI.
  3194     MOVE PI-ORIGINAL-BATCH-SW       TO ORGINALI.
  3195     MOVE PI-ISSUE-WARNING-SW        TO ANYISSWI.
  3196     MOVE PI-CANCEL-WARNING-SW       TO ANYCANWI.
  3197
  3198     IF PI-PB-ENTRY-BATCH  = SPACES OR = LOW-VALUES
  3199        NEXT SENTENCE
  3200     ELSE
  3201        MOVE AL-UANON            TO BATCHA
  3202        MOVE PI-PB-ENTRY-BATCH   TO BATCHI.
  3203
  3204     IF PI-PB-CERT-NO = SPACES OR = LOW-VALUES
  3205        NEXT SENTENCE
  3206     ELSE
  3207        MOVE AL-UANON            TO CERTNOA
  3208        MOVE PI-PB-CERT-PRIME    TO CERTNOI
  3209        MOVE AL-UANON            TO SUFFIXA
  3210        MOVE PI-PB-CERT-SFX      TO SUFFIXI.
  3211
  3212     IF PI-PB-CERT-EFF-DT = LOW-VALUES OR SPACES
  3213        NEXT SENTENCE
  3214     ELSE
  3215        MOVE PI-PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  3216        MOVE ' '                    TO DC-OPTION-CODE
  3217        PERFORM 9700-DATE-LINK
  3218        MOVE DC-GREG-DATE-1-EDIT    TO EFFDTI
  3219        MOVE AL-UANON               TO EFFDTA.
  3220
  3221     IF PI-NO-PB-RECS-FOUND
  3222        MOVE ER-2375             TO EMI-ERROR
  3223        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3224
  3225     IF NOT PI-ALTERNATE-BROWSE
  3226        GO TO 6099-EXIT.
  3227
  3228     IF PI-PB-CARRIER = SPACES OR = LOW-VALUES
  3229        NEXT SENTENCE
  3230     ELSE
  3231        MOVE PI-PB-CARRIER       TO CARRIERI
  3232        MOVE AL-UANON            TO CARRIERA.
  3233
  3234     IF PI-PB-GROUPING = SPACES OR = LOW-VALUES
  3235        NEXT SENTENCE
  3236     ELSE
  3237        MOVE PI-PB-GROUPING      TO GROUPI
  3238        MOVE AL-UANON            TO GROUPA.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  66
* EL631.cbl
  3239
  3240     IF PI-PB-STATE  = SPACES OR = LOW-VALUES
  3241        NEXT SENTENCE
  3242     ELSE
  3243        MOVE PI-PB-STATE         TO STATEI
  3244        MOVE AL-UANON            TO STATEA.
  3245
  3246     IF PI-PB-ACCOUNT  = SPACES OR = LOW-VALUES
  3247        NEXT SENTENCE
  3248     ELSE
  3249        MOVE PI-PB-ACCOUNT       TO ACCOUNTI
  3250        MOVE AL-UANON            TO ACCOUNTA.
  3251
  3252 6099-EXIT.
  3253     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  67
* EL631.cbl
  3255 6100-BUILD-KEY.
  3256     MOVE SPACES                 TO PI-PB-CARRIER
  3257                                    PI-PB-GROUPING
  3258                                    PI-PB-STATE.
  3259
  3260     IF CARRIERL GREATER THAN ZEROS
  3261        IF (CARR-ACCNT-CNTL       OR
  3262            CARR-ST-ACCNT-CNTL    OR
  3263            CARR-GROUP-ST-ACCNT-CNTL)
  3264            MOVE CARRIERI         TO PI-PB-CARRIER.
  3265
  3266
  3267     IF GROUPL GREATER THAN ZEROS
  3268        IF CARR-GROUP-ST-ACCNT-CNTL
  3269           MOVE GROUPI            TO PI-PB-GROUPING.
  3270
  3271
  3272     IF STATEL GREATER THAN ZEROS
  3273        IF (ST-ACCNT-CNTL         OR
  3274            CARR-ST-ACCNT-CNTL    OR
  3275            CARR-GROUP-ST-ACCNT-CNTL)
  3276            MOVE STATEI           TO PI-PB-STATE.
  3277
  3278     IF ACCOUNTI = SPACES OR = LOW-VALUES
  3279        MOVE SPACES              TO PI-PB-ACCOUNT
  3280        ELSE
  3281        MOVE ACCOUNTI            TO PI-PB-ACCOUNT.
  3282
  3283     IF PI-PB-CARRIER = SPACES AND
  3284        (CARR-ACCNT-CNTL       OR
  3285         CARR-ST-ACCNT-CNTL    OR
  3286         CARR-GROUP-ST-ACCNT-CNTL)
  3287        MOVE ER-0193             TO EMI-ERROR
  3288        MOVE -1                  TO CARRIERL
  3289        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3290
  3291     IF PI-PB-GROUPING = SPACES AND
  3292         CARR-GROUP-ST-ACCNT-CNTL
  3293        MOVE ER-0195             TO EMI-ERROR
  3294        MOVE -1                  TO GROUPL
  3295        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3296
  3297     IF PI-PB-STATE = SPACES AND
  3298        (ST-ACCNT-CNTL         OR
  3299         CARR-ST-ACCNT-CNTL    OR
  3300         CARR-GROUP-ST-ACCNT-CNTL)
  3301        MOVE ER-0144             TO EMI-ERROR
  3302        MOVE -1                  TO STATEL
  3303        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3304
  3305 6199-EXIT.
  3306     EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  68
* EL631.cbl
  3308 6200-READ-FILE.
  3309
  3310* EXEC CICS HANDLE CONDITION
  3311*        NOTFND   (6250-NOT-FOUND)
  3312*    END-EXEC.
  3313*    MOVE '"$I                   ! $ #00003206' TO DFHEIV0
  3314     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3315     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3316     MOVE X'2420233030303033323036' TO DFHEIV0(25:11)
  3317     CALL 'kxdfhei1' USING DFHEIV0
  3318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3319
  3320
  3321     IF PI-COMPANY-ID = CLIENT-MIC OR CLIENT-PEM OR CLIENT-FLA
  3322        IF PI-DISPLAY-ORIGINAL-BATCH
  3323           MOVE ERPNDB3-FILE-ID     TO FILE-ID
  3324        ELSE
  3325           MOVE ERPNDB-FILE-ID      TO FILE-ID
  3326     ELSE
  3327        MOVE ERPNDB-FILE-ID         TO FILE-ID.
  3328
  3329
  3330* EXEC CICS READ
  3331*        GTEQ
  3332*        DATASET   (FILE-ID)
  3333*        SET       (ADDRESS OF PENDING-BUSINESS)
  3334*        RIDFLD    (PI-ERPNDB-KEY)
  3335*    END-EXEC.
  3336*    MOVE '&"S        G          (   #00003218' TO DFHEIV0
  3337     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3338     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3339     MOVE X'2020233030303033323138' TO DFHEIV0(25:11)
  3340     CALL 'kxdfhei1' USING DFHEIV0,
  3341           FILE-ID,
  3342           DFHEIV20,
  3343           DFHEIV99,
  3344           PI-ERPNDB-KEY,
  3345           DFHEIV99,
  3346           DFHEIV99,
  3347           DFHEIV99
  3348     SET ADDRESS OF PENDING-BUSINESS TO
  3349         DFHEIV20
  3350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3351
  3352
  3353     IF ORGINALL GREATER THAN ZEROS
  3354        AND ORGINALI = 'Y'
  3355        IF PI-PB-ENTRY-BATCH = PB-ORIGINAL-ENTRY-BATCH AND
  3356           PI-PB-COMPANY-CD  = PB-ORIGINAL-COMPANY-CD
  3357           GO TO 6299-EXIT.
  3358
  3359     IF PI-PB-COMPANY-CD  = PB-COMPANY-CD
  3360        IF STARTATI = 'Y'
  3361            MOVE PB-ENTRY-BATCH TO PI-PB-ENTRY-BATCH
  3362            GO TO 6299-EXIT
  3363        ELSE
  3364            IF PI-PB-ENTRY-BATCH = PB-ENTRY-BATCH
  3365                GO TO 6299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  69
* EL631.cbl
  3366
  3367 6250-NOT-FOUND.
  3368     MOVE ER-2193                TO EMI-ERROR
  3369     MOVE -1                     TO BATCHL
  3370     MOVE AL-UABON               TO BATCHA
  3371     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3372     GO TO 8200-SEND-DATAONLY.
  3373
  3374 6299-EXIT.
  3375      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  70
* EL631.cbl
  3377 6300-READ-ACCOUNT-FILE.
  3378     MOVE PI-ERPNDB-ALT-KEY       TO WS-ACCT-KEY.
  3379     MOVE LOW-VALUES              TO WS-EFF-DT.
  3380
  3381
  3382* EXEC CICS HANDLE CONDITION
  3383*        NOTFND   (6350-NOT-FOUND)
  3384*    END-EXEC.
  3385*    MOVE '"$I                   ! % #00003253' TO DFHEIV0
  3386     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3388     MOVE X'2520233030303033323533' TO DFHEIV0(25:11)
  3389     CALL 'kxdfhei1' USING DFHEIV0
  3390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3391
  3392
  3393
  3394* EXEC CICS READ
  3395*        GTEQ
  3396*        DATASET   (ERACCT2-FILE-ID)
  3397*        SET       (ADDRESS OF ACCOUNT-MASTER)
  3398*        RIDFLD    (WS-ACCT-KEY)
  3399*    END-EXEC.
  3400*    MOVE '&"S        G          (   #00003257' TO DFHEIV0
  3401     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3402     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3403     MOVE X'2020233030303033323537' TO DFHEIV0(25:11)
  3404     CALL 'kxdfhei1' USING DFHEIV0,
  3405           ERACCT2-FILE-ID,
  3406           DFHEIV20,
  3407           DFHEIV99,
  3408           WS-ACCT-KEY,
  3409           DFHEIV99,
  3410           DFHEIV99,
  3411           DFHEIV99
  3412     SET ADDRESS OF ACCOUNT-MASTER TO
  3413         DFHEIV20
  3414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3415
  3416
  3417     IF PI-PB-ACCOUNT    = AM-VG-ACCOUNT   AND
  3418        PI-PB-STATE      = AM-VG-STATE     AND
  3419        PI-PB-GROUPING   = AM-VG-GROUPING  AND
  3420        PI-PB-CARRIER    = AM-VG-CARRIER   AND
  3421        PI-PB-COMPANY-CD = AM-COMPANY-CD-A1
  3422          GO TO 6399-EXIT.
  3423
  3424 6350-NOT-FOUND.
  3425     MOVE ER-0179                TO EMI-ERROR.
  3426     MOVE -1                     TO BATCHL.
  3427     MOVE AL-UABON               TO BATCHA.
  3428     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3429     GO TO 8200-SEND-DATAONLY.
  3430
  3431 6399-EXIT.
  3432      EXIT.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  71
* EL631.cbl
  3434 8100-SEND-INITIAL-MAP.
  3435     MOVE SPACE                  TO PI-DISPLAY-SCREEN-SW.
  3436
  3437     IF PI-COMPANY-ID = CLIENT-MIC OR CLIENT-PEM OR CLIENT-FLA
  3438        MOVE AL-SANOF            TO ORGHDRA
  3439        MOVE AL-UANON            TO ORGINALA
  3440        MOVE 'N'                 TO ORGINALI
  3441     ELSE
  3442        MOVE AL-SADOF            TO ORGHDRA
  3443        MOVE 'N'                 TO ORGINALI
  3444        MOVE AL-SADON            TO ORGINALA.
  3445
  3446     MOVE PI-ENTRY-CD-1          TO PI-CSR-SESSION-SW
  3447     IF CSR-EDIT-SESSION
  3448        MOVE '- CUSTOMER SERVICE REVIEW/CORRECTION -'
  3449                                 TO HEADO
  3450     END-IF
  3451     MOVE SAVE-DATE              TO DATEO.
  3452     MOVE EIBTIME                TO TIME-IN.
  3453     MOVE TIME-OUT               TO TIMEO.
  3454     MOVE -1                     TO BATCHL.
  3455     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  3456     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  3457
  3458
  3459* EXEC CICS SEND
  3460*        MAP      (MAP-NAME)
  3461*        MAPSET   (MAPSET-NAME)
  3462*        FROM     (EL631AO)
  3463*        ERASE
  3464*        CURSOR
  3465*    END-EXEC.
  3466     MOVE LENGTH OF
  3467      EL631AO
  3468       TO DFHEIV12
  3469     MOVE -1
  3470       TO DFHEIV11
  3471*    MOVE '8$     CT  E    H L F ,   #00003305' TO DFHEIV0
  3472     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3473     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3474     MOVE X'2020233030303033333035' TO DFHEIV0(25:11)
  3475     CALL 'kxdfhei1' USING DFHEIV0,
  3476           MAP-NAME,
  3477           EL631AO,
  3478           DFHEIV12,
  3479           MAPSET-NAME,
  3480           DFHEIV99,
  3481           DFHEIV99,
  3482           DFHEIV99,
  3483           DFHEIV11,
  3484           DFHEIV99,
  3485           DFHEIV99,
  3486           DFHEIV99
  3487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3488
  3489
  3490     GO TO 9100-RETURN-TRAN.
  3491
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  72
* EL631.cbl
  3492 8200-SEND-DATAONLY.
  3493     MOVE SAVE-DATE              TO DATEO.
  3494     MOVE EIBTIME                TO TIME-IN.
  3495     MOVE TIME-OUT               TO TIMEO.
  3496     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  3497     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  3498
  3499
  3500* EXEC CICS SEND
  3501*        MAP      (MAP-NAME)
  3502*        MAPSET   (MAPSET-NAME)
  3503*        FROM     (EL631AO)
  3504*        DATAONLY
  3505*        ERASEAUP
  3506*        CURSOR
  3507*    END-EXEC.
  3508     MOVE LENGTH OF
  3509      EL631AO
  3510       TO DFHEIV12
  3511     MOVE -1
  3512       TO DFHEIV11
  3513*    MOVE '8$D    CT  A    H L F ,   #00003322' TO DFHEIV0
  3514     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  3515     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3516     MOVE X'2020233030303033333232' TO DFHEIV0(25:11)
  3517     CALL 'kxdfhei1' USING DFHEIV0,
  3518           MAP-NAME,
  3519           EL631AO,
  3520           DFHEIV12,
  3521           MAPSET-NAME,
  3522           DFHEIV99,
  3523           DFHEIV99,
  3524           DFHEIV99,
  3525           DFHEIV11,
  3526           DFHEIV99,
  3527           DFHEIV99,
  3528           DFHEIV99
  3529     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3530
  3531
  3532     GO TO 9100-RETURN-TRAN.
  3533
  3534 8300-SEND-TEXT.
  3535
  3536* EXEC CICS SEND TEXT
  3537*        FROM     (LOGOFF-TEXT)
  3538*        LENGTH   (LOGOFF-LENGTH)
  3539*        ERASE
  3540*        FREEKB
  3541*    END-EXEC.
  3542*    MOVE '8&      T  E F  H   F -   #00003334' TO DFHEIV0
  3543     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3544     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3545     MOVE X'2020233030303033333334' TO DFHEIV0(25:11)
  3546     CALL 'kxdfhei1' USING DFHEIV0,
  3547           LOGOFF-TEXT,
  3548           LOGOFF-LENGTH,
  3549           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  73
* EL631.cbl
  3550           DFHEIV99,
  3551           DFHEIV99,
  3552           DFHEIV99,
  3553           DFHEIV99,
  3554           DFHEIV99,
  3555           DFHEIV99,
  3556           DFHEIV99,
  3557           DFHEIV99,
  3558           DFHEIV99
  3559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3560
  3561
  3562
  3563* EXEC CICS RETURN
  3564*    END-EXEC.
  3565*    MOVE '.(                    ''   #00003341' TO DFHEIV0
  3566     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3567     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3568     MOVE X'2020233030303033333431' TO DFHEIV0(25:11)
  3569     CALL 'kxdfhei1' USING DFHEIV0,
  3570           DFHEIV99,
  3571           DFHEIV99,
  3572           DFHEIV99,
  3573           DFHEIV99,
  3574           DFHEIV99,
  3575           DFHEIV99
  3576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3577
  3578
  3579 8600-DEEDIT.
  3580
  3581* EXEC CICS BIF DEEDIT
  3582*         FIELD   (DEEDIT-FIELD)
  3583*         LENGTH  (15)
  3584*    END-EXEC.
  3585     MOVE 15
  3586       TO DFHEIV11
  3587*    MOVE '@"L                   #   #00003345' TO DFHEIV0
  3588     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3589     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3590     MOVE X'2020233030303033333435' TO DFHEIV0(25:11)
  3591     CALL 'kxdfhei1' USING DFHEIV0,
  3592           DEEDIT-FIELD,
  3593           DFHEIV11
  3594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3595
  3596
  3597 8800-UNAUTHORIZED-ACCESS.
  3598     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3599     GO TO 8300-SEND-TEXT.
  3600
  3601 8810-PF23.
  3602     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3603     MOVE XCTL-005               TO PGM-NAME.
  3604     GO TO 9300-XCTL.
  3605
  3606 9000-RETURN-CICS.
  3607
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  74
* EL631.cbl
  3608* EXEC CICS RETURN
  3609*    END-EXEC.
  3610*    MOVE '.(                    ''   #00003360' TO DFHEIV0
  3611     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3612     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3613     MOVE X'2020233030303033333630' TO DFHEIV0(25:11)
  3614     CALL 'kxdfhei1' USING DFHEIV0,
  3615           DFHEIV99,
  3616           DFHEIV99,
  3617           DFHEIV99,
  3618           DFHEIV99,
  3619           DFHEIV99,
  3620           DFHEIV99
  3621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3622
  3623
  3624 9100-RETURN-TRAN.
  3625     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3626     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  3627
  3628* EXEC CICS RETURN
  3629*        TRANSID    (TRANS-ID)
  3630*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3631*        LENGTH     (PI-COMM-LENGTH)
  3632*    END-EXEC.
  3633*    MOVE '.(CT                  ''   #00003366' TO DFHEIV0
  3634     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3635     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3636     MOVE X'2020233030303033333636' TO DFHEIV0(25:11)
  3637     CALL 'kxdfhei1' USING DFHEIV0,
  3638           TRANS-ID,
  3639           PROGRAM-INTERFACE-BLOCK,
  3640           PI-COMM-LENGTH,
  3641           DFHEIV99,
  3642           DFHEIV99,
  3643           DFHEIV99
  3644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3645
  3646
  3647 9200-RETURN-MAIN-MENU.
  3648     MOVE XCTL-626               TO PGM-NAME.
  3649     GO TO 9300-XCTL.
  3650
  3651 9300-XCTL.
  3652
  3653* EXEC CICS XCTL
  3654*        PROGRAM    (PGM-NAME)
  3655*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3656*        LENGTH     (PI-COMM-LENGTH)
  3657*    END-EXEC.
  3658*    MOVE '.$C                   %   #00003377' TO DFHEIV0
  3659     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3660     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3661     MOVE X'2020233030303033333737' TO DFHEIV0(25:11)
  3662     CALL 'kxdfhei1' USING DFHEIV0,
  3663           PGM-NAME,
  3664           PROGRAM-INTERFACE-BLOCK,
  3665           PI-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  75
* EL631.cbl
  3666           DFHEIV99
  3667     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3668
  3669
  3670 9400-CLEAR.
  3671     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  3672     GO TO 9300-XCTL.
  3673
  3674 9500-PF12.
  3675     MOVE XCTL-010               TO PGM-NAME.
  3676     GO TO 9300-XCTL.
  3677
  3678 9600-PGMID-ERROR.
  3679
  3680* EXEC CICS HANDLE CONDITION
  3681*        PGMIDERR    (8300-SEND-TEXT)
  3682*    END-EXEC.
  3683*    MOVE '"$L                   ! & #00003392' TO DFHEIV0
  3684     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3685     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3686     MOVE X'2620233030303033333932' TO DFHEIV0(25:11)
  3687     CALL 'kxdfhei1' USING DFHEIV0
  3688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3689
  3690
  3691     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  3692     MOVE ' '                    TO PI-ENTRY-CD-1.
  3693     MOVE XCTL-005               TO PGM-NAME.
  3694     MOVE PGM-NAME               TO LOGOFF-PGM.
  3695     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  3696     GO TO 9300-XCTL.
  3697
  3698 9700-DATE-LINK.
  3699     MOVE LINK-ELDATCV           TO PGM-NAME
  3700
  3701* EXEC CICS LINK
  3702*        PROGRAM    (PGM-NAME)
  3703*        COMMAREA   (DATE-CONVERSION-DATA)
  3704*        LENGTH     (DC-COMM-LENGTH)
  3705*    END-EXEC.
  3706*    MOVE '."C                   (   #00003405' TO DFHEIV0
  3707     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3708     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3709     MOVE X'2020233030303033343035' TO DFHEIV0(25:11)
  3710     CALL 'kxdfhei1' USING DFHEIV0,
  3711           PGM-NAME,
  3712           DATE-CONVERSION-DATA,
  3713           DC-COMM-LENGTH,
  3714           DFHEIV99,
  3715           DFHEIV99,
  3716           DFHEIV99,
  3717           DFHEIV99
  3718     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3719
  3720
  3721 9900-ERROR-FORMAT.
  3722     IF NOT EMI-ERRORS-COMPLETE
  3723         MOVE LINK-001           TO PGM-NAME
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  76
* EL631.cbl
  3724
  3725* EXEC CICS LINK
  3726*            PROGRAM    (PGM-NAME)
  3727*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  3728*            LENGTH     (EMI-COMM-LENGTH)
  3729*        END-EXEC.
  3730*    MOVE '."C                   (   #00003414' TO DFHEIV0
  3731     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3732     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3733     MOVE X'2020233030303033343134' TO DFHEIV0(25:11)
  3734     CALL 'kxdfhei1' USING DFHEIV0,
  3735           PGM-NAME,
  3736           ERROR-MESSAGE-INTERFACE-BLOCK,
  3737           EMI-COMM-LENGTH,
  3738           DFHEIV99,
  3739           DFHEIV99,
  3740           DFHEIV99,
  3741           DFHEIV99
  3742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3743
  3744
  3745 9900-EXIT.
  3746     EXIT.
  3747
  3748 9990-ABEND.
  3749     MOVE LINK-004               TO PGM-NAME.
  3750     MOVE DFHEIBLK               TO EMI-LINE1.
  3751
  3752* EXEC CICS LINK
  3753*        PROGRAM   (PGM-NAME)
  3754*        COMMAREA  (EMI-LINE1)
  3755*        LENGTH    (72)
  3756*    END-EXEC.
  3757     MOVE 72
  3758       TO DFHEIV11
  3759*    MOVE '."C                   (   #00003426' TO DFHEIV0
  3760     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3761     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3762     MOVE X'2020233030303033343236' TO DFHEIV0(25:11)
  3763     CALL 'kxdfhei1' USING DFHEIV0,
  3764           PGM-NAME,
  3765           EMI-LINE1,
  3766           DFHEIV11,
  3767           DFHEIV99,
  3768           DFHEIV99,
  3769           DFHEIV99,
  3770           DFHEIV99
  3771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3772
  3773
  3774     GO TO 8200-SEND-DATAONLY.
  3775
  3776
  3777* GOBACK.
  3778     MOVE '9%                    "   ' TO DFHEIV0
  3779     MOVE 'EL631' TO DFHEIV1
  3780     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3781     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  77
* EL631.cbl
  3782
  3783 9995-SECURITY-VIOLATION.
  3784*                            COPY ELCSCTP.
  3785******************************************************************
  3786*                                                                *
  3787*                            ELCSCTP                             *
  3788*                            VMOD=2.001                          *
  3789*                                                                *
  3790*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3791******************************************************************
  3792
  3793
  3794     MOVE EIBDATE          TO SM-JUL-DATE.
  3795     MOVE EIBTRMID         TO SM-TERMID.
  3796     MOVE THIS-PGM         TO SM-PGM.
  3797     MOVE EIBTIME          TO TIME-IN.
  3798     MOVE TIME-OUT         TO SM-TIME.
  3799     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3800
  3801
  3802* EXEC CICS LINK
  3803*         PROGRAM  ('EL003')
  3804*         COMMAREA (SECURITY-MESSAGE)
  3805*         LENGTH   (80)
  3806*    END-EXEC.
  3807     MOVE 'EL003' TO DFHEIV1
  3808     MOVE 80
  3809       TO DFHEIV11
  3810*    MOVE '."C                   (   #00003454' TO DFHEIV0
  3811     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3812     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3813     MOVE X'2020233030303033343534' TO DFHEIV0(25:11)
  3814     CALL 'kxdfhei1' USING DFHEIV0,
  3815           DFHEIV1,
  3816           SECURITY-MESSAGE,
  3817           DFHEIV11,
  3818           DFHEIV99,
  3819           DFHEIV99,
  3820           DFHEIV99,
  3821           DFHEIV99
  3822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3823
  3824
  3825******************************************************************
  3826
  3827
  3828 9995-EXIT.
  3829     EXIT.
  3830
  3831
  3832
  3833 9999-DFHBACK SECTION.
  3834     MOVE '9%                    "   ' TO DFHEIV0
  3835     MOVE 'EL631' TO DFHEIV1
  3836     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3837     GOBACK.
  3838 9999-DFHEXIT.
  3839     IF DFHEIGDJ EQUAL 0001
* Micro Focus Server Express         V5.1 revision 000 26-Feb-16 10:14 Page  78
* EL631.cbl
  3840         NEXT SENTENCE
  3841     ELSE IF DFHEIGDJ EQUAL 2
  3842         GO TO 9600-PGMID-ERROR,
  3843               9990-ABEND
  3844         DEPENDING ON DFHEIGDI
  3845     ELSE IF DFHEIGDJ EQUAL 3
  3846         GO TO 5050-QID-ERROR
  3847         DEPENDING ON DFHEIGDI
  3848     ELSE IF DFHEIGDJ EQUAL 4
  3849         GO TO 6250-NOT-FOUND
  3850         DEPENDING ON DFHEIGDI
  3851     ELSE IF DFHEIGDJ EQUAL 5
  3852         GO TO 6350-NOT-FOUND
  3853         DEPENDING ON DFHEIGDI
  3854     ELSE IF DFHEIGDJ EQUAL 6
  3855         GO TO 8300-SEND-TEXT
  3856         DEPENDING ON DFHEIGDI.
  3857     MOVE '9%                    "   ' TO DFHEIV0
  3858     MOVE 'EL631' TO DFHEIV1
  3859     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3860     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3980     Code:        8135
