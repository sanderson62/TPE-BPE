00001  ID DIVISION.                                                     00000010
00002                                                                   00000020
00003  PROGRAM-ID.                 EL6503.                              00000030
00004 *                            VMOD=2.003                           00000040
00005                                                                   00000050
00006  AUTHOR.     LOGIC,INC.                                           00000060
00007 *            DALLAS, TEXAS.                                       00000070
00008                                                                   00000080
00009  DATE-COMPILED.                                                   00000090
00010  SECURITY.   *****************************************************00000100
00011              *                                                   *00000110
00012              *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *00000120
00013              *                                                   *00000130
00014              *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *00000140
00015              *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *00000150
00016              *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *00000160
00017              *                                                   *00000170
00018              *****************************************************00000180
00019                                                                   00000190
00020  REMARKS.    TRANSACTION - EXC7 - ACCOUNT MAINT (A&H LIMITS).     00000200
00021                                                                   00000210
00022  ENVIRONMENT DIVISION.                                            00000220
00023                                                                   00000230
00024      EJECT                                                        00000240
00025  DATA DIVISION.                                                   00000250
00026  WORKING-STORAGE SECTION.                                         00000260
00027  77  FILLER  PIC X(32)  VALUE '********************************'. 00000270
00028  77  FILLER  PIC X(32)  VALUE '*    EL6503 WORKING STORAGE    *'. 00000280
00029  77  FILLER  PIC X(32)  VALUE '************ V/M 2.003 *********'. 00000290
00030                                                                   00000300
00031  01  WS-DATE-AREA.                                                00000310
00032      05  SAVE-DATE                   PIC X(8)    VALUE SPACES.    00000320
00033      05  SAVE-BIN-DATE               PIC X(2)    VALUE SPACES.    00000330
00034                                                                   00000340
00035  01  STANDARD-AREAS.                                              00000350
00036      12  MAP-NAME                    PIC X(8)    VALUE 'EL6503A'. 00000360
00037      12  MAPSET-NAME                 PIC X(8)    VALUE 'EL6503S'. 00000370
00038      12  SCREEN-NUMBER               PIC X(4)    VALUE '650D'.    00000380
00039      12  TRANS-ID                    PIC X(4)    VALUE 'EXC7'.    00000390
00040      12  THIS-PGM                    PIC X(8)    VALUE 'EL6503'.  00000400
00041      12  PGM-NAME                    PIC X(8).                    00000410
00042      12  TIME-IN                     PIC S9(7).                   00000420
00043      12  TIME-OUT-R  REDEFINES TIME-IN.                           00000430
00044          16  FILLER                  PIC X.                       00000440
00045          16  TIME-OUT                PIC 99V99.                   00000450
00046          16  FILLER                  PIC X(2).                    00000460
00047      12  XCTL-005                    PIC X(8)    VALUE 'EL005'.   00000470
00048      12  XCTL-010                    PIC X(8)    VALUE 'EL010'.   00000480
00049      12  XCTL-626                    PIC X(8)    VALUE 'EL626'.   00000490
00050      12  XCTL-650                    PIC X(8)    VALUE 'EL650'.   00000500
00051      12  XCTL-6501                   PIC X(8)    VALUE 'EL6501'.  00000510
00052      12  XCTL-6502                   PIC X(8)    VALUE 'EL6502'.  00000520
00053      12  XCTL-6504                   PIC X(8)    VALUE 'EL6504'.  00000530
00054      12  XCTL-6505                   PIC X(8)    VALUE 'EL6505'.  00000540
00055      12  XCTL-6506                   PIC X(8)    VALUE 'EL6506'.  00000550
00056      12  LINK-001                    PIC X(8)    VALUE 'EL001'.   00000560
00057      12  LINK-004                    PIC X(8)    VALUE 'EL004'.   00000570
00058      12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'. 00000580
00059      12  FILE-ID                     PIC X(8)    VALUE SPACES.    00000590
00060      12  ACCT-FILE-ID                PIC X(8)    VALUE 'ERACCT'.  00000600
00061      12  CNTL-FILE-ID                PIC X(8)    VALUE 'ELCNTL'.  00000610
00062      12  BIN-CURRENT-SAVE            PIC XX      VALUE SPACES.    00000620
00063      12  YMD-CURRENT-SAVE            PIC X(6)    VALUE SPACES.    00000630
00064                                                                   00000640
00065      12  ERACCT-LENGTH               PIC S9(4)   VALUE +2023 COMP.00000650
00066      12  ELCNTL-LENGTH               PIC S9(4)   VALUE +527  COMP.00000660
00067      12  SC-ITEM                     PIC S9(4)   VALUE +1    COMP.00000670
00068      12  WS-JOURNAL-FILE-LENGTH      PIC S9(4)   VALUE +0    COMP.00000680
00069      12  SUB1                        PIC S9(4)   VALUE +0    COMP.00000690
00070      12  SUB2                        PIC S9(4)   VALUE +0    COMP.00000700
00071      12  SUB3                        PIC S9(4)   VALUE +0    COMP.00000710
00072      12  SUB4                        PIC S9(4)   VALUE +0    COMP.00000720
00073      12  SUB5                        PIC S9(4)   VALUE +0    COMP.00000730
00074 ***********MAX-LIMITS NEEDS TO BE SET TO 8 IF ALL 8 LIMITS        00000740
00075 ***********ARE TO BE DISPLAYED. MAP WILL ALSO HAVE TO BE RESET.   00000750
00076      12  MAX-LIMITS                  PIC S9      VALUE +6  COMP.  00000760
00077                                                                   00000770
00078      12  DEEDIT-FIELD                PIC X(15).                   00000780
00079      12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD PIC S9(15).      00000790
00080      12  DEEDIT-FIELD-V1  REDEFINES DEEDIT-FIELD PIC S9(13)V99.   00000800
00081                                                                   00000810
00082      12  WS-PREV-TYPE                PIC XX      VALUE SPACES.    00000820
00083      12  WS-PREV-AGE                 PIC 99      VALUE ZERO.      00000830
00084                                                                   00000840
00085      12  WS-NO-OCCURS                PIC S99     VALUE +0.        00000850
00086          88  NO-OCCURRENCES                      VALUE +0.        00000860
00087                                                                   00000870
00088      12  WS-CHECK-MAINT-TYPE         PIC X       VALUE SPACE.     00000880
00089          88  VALID-MAINT-TYPE                    VALUE 'S' 'A'    00000890
00090                                                        'C'.       00000900
00091                                                                   00000910
00092      12  WS-DELETE-SW.                                            00000920
00093          16  WS-DELETE1-SW           PIC X       VALUE SPACES.    00000930
00094              88  AGE-INVALID                     VALUE 'X'.       00000940
00095          16  WS-DELETE2-SW           PIC X       VALUE SPACES.    00000950
00096              88  TERM-INVALID                    VALUE 'X'.       00000960
00097          16  WS-DELETE3-SW           PIC X       VALUE SPACES.    00000970
00098              88  MOA-INVALID                     VALUE 'X'.       00000980
00099          16  WS-DELETE4-SW           PIC X       VALUE SPACES.    00000990
00100              88  AMT-INVALID                     VALUE 'X'.       00001000
00101      12  WS-DEL-SW           REDEFINES                            00001010
00102          WS-DELETE-SW                PIC X(4).                    00001020
00103          88  RECORD-TO-BE-DELETED                VALUE 'XXXX'.    00001030
00104          88  RECORD-IS-VALID                     VALUE SPACES.    00001040
00105                                                                   00001050
00106      12  WS-PFKEY-MSG.                                            00001060
00107          16  FILLER                  PIC X(4)    VALUE 'PF5='.    00001070
00108          16  WS-BENE-ID              PIC XX      VALUE SPACES.    00001080
00109          16  FILLER                  PIC X(7)    VALUE ' LIMITS'. 00001090
00110                                                                   00001100
00111      12  WS-SAVE-LIMITS.                                          00001110
00112          16  WS-SAVE-TYPE-L          PIC S9(4)   COMP.            00001120
00113          16  WS-SAVE-TYPE-A          PIC X.                       00001130
00114          16  WS-SAVE-TYPE            PIC XX.                      00001140
00115          16  WS-SAVE-ATT-AGE-L       PIC S9(4)   COMP.            00001150
00116          16  WS-SAVE-ATT-AGE-A       PIC X.                       00001160
00117          16  WS-SAVE-ATT-AGE         PIC S99.                     00001170
00118          16  WS-SAVE-ADA OCCURS 4 TIMES.                          00001180
00119              20  WS-SAVE-AGE-L       PIC S9(4)   COMP.            00001190
00120              20  WS-SAVE-AGE-A       PIC X.                       00001200
00121              20  WS-SAVE-AGE         PIC 99.                      00001210
00122              20  WS-SAVE-TERM-L      PIC S9(4)   COMP.            00001220
00123              20  WS-SAVE-TERM-A      PIC X.                       00001230
00124              20  WS-SAVE-TERM        PIC 999.                     00001240
00125              20  WS-SAVE-MOA-L       PIC S9(4)   COMP.            00001250
00126              20  WS-SAVE-MOA-A       PIC X.                       00001260
00127              20  WS-SAVE-MOA         PIC 9(5).                    00001270
00128              20  WS-SAVE-AMT-L       PIC S9(4)   COMP.            00001280
00129              20  WS-SAVE-AMT-A       PIC X.                       00001290
00130              20  WS-SAVE-AMT         PIC 9(7).                    00001300
00131                                                                   00001310
00132      12  DO-SEQ-SW                   PIC X.                       00001320
00133                                                                   00001330
00134                                                                   00001340
00135      EJECT                                                        00001350
00136      12  ERROR-MESSAGES.                                          00001360
00137          16  ER-0000                 PIC X(4)    VALUE '0000'.    00001370
00138          16  ER-0002                 PIC X(4)    VALUE '0002'.    00001380
00139          16  ER-0004                 PIC X(4)    VALUE '0004'.    00001390
00140          16  ER-0008                 PIC X(4)    VALUE '0008'.    00001400
00141          16  ER-0029                 PIC X(4)    VALUE '0029'.    00001410
00142          16  ER-0068                 PIC X(4)    VALUE '0068'.    00001420
00143          16  ER-0070                 PIC X(4)    VALUE '0070'.    00001430
00144          16  ER-2039                 PIC X(4)    VALUE '2039'.    00001440
00145          16  ER-2076                 PIC X(4)    VALUE '2076'.    00001450
00146          16  ER-2077                 PIC X(4)    VALUE '2077'.    00001460
00147          16  ER-2078                 PIC X(4)    VALUE '2078'.    00001470
00148          16  ER-2079                 PIC X(4)    VALUE '2079'.    00001480
00149          16  ER-2080                 PIC X(4)    VALUE '2080'.    00001490
00150          16  ER-2104                 PIC X(4)    VALUE '2104'.    00001500
00151          16  ER-2105                 PIC X(4)    VALUE '2105'.    00001510
00152          16  ER-2107                 PIC X(4)    VALUE '2107'.    00001520
00153          16  ER-2108                 PIC X(4)    VALUE '2108'.    00001530
00154          16  ER-2110                 PIC X(4)    VALUE '2110'.    00001540
00155          16  ER-2111                 PIC X(4)    VALUE '2111'.    00001550
00156          16  ER-2572                 PIC X(4)    VALUE '2572'.    00001560
00157                                                                   00001570
00158      SKIP3                                                        00001580
00159      12  ELCNTL-KEY.                                              00001590
00160          16  CNTL-COMP-ID            PIC X(3)    VALUE SPACES.    00001600
00161          16  CNTL-REC-TYPE           PIC X       VALUE SPACES.    00001610
00162          16  CNTL-ACCESS             PIC X(4)    VALUE SPACES.    00001620
00163          16  CNTL-SEQ-NO             PIC S9(4)   VALUE +0  COMP.  00001630
00164                                                                   00001640
00165      EJECT                                                        00001650
uktdel*01  SECURITY-MESSAGE                COPY ELCSCTM.                00001660
uktins     COPY ELCSCTM.
00167      EJECT                                                        00001670
uktdel*01  SECURITY-CONTROL                COPY ELCSCRTY.               00001680
uktins     COPY ELCSCRTY.
00169      EJECT                                                        00001690
uktdel*01  CLASIC-LOGOFF                   COPY ELCLOGOF.               00001700
uktins     COPY ELCLOGOF.
00171                                                                   00001710
00172      EJECT                                                        00001720
uktdel*01  DATE-CONVERSION-DATA            COPY ELCDATE.                00001730
uktins     COPY ELCDATE.
00174                                                                   00001740
00175      EJECT                                                        00001750
uktdel*01  ATTRIBUTE-LIST                  COPY ELCATTR.                00001760
uktins     COPY ELCATTR.
00177                                                                   00001770
00178      EJECT                                                        00001780
uktdel*01  ERROR-MESSAGE-INTERFACE-BLOCK   COPY ELCEMIB.                00001790
uktins     COPY ELCEMIB.
00180                                                                   00001800
00181      EJECT                                                        00001810
uktdel*01  PROGRAM-INTERFACE-BLOCK         COPY ELCINTF.                00001820
uktins     COPY ELCINTF.
00183      12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.                00001830
00184          16  PI-MAINT                       PIC X.                00001840
00185          16  PI-PREV-ACCOUNT                PIC X(20).            00001850
00186          16  PI-PREV-VG-ACCOUNT             PIC X(20).            00001860
00187          16  PI-ACCT-KEY.                                         00001870
00188              20  PI-ACCT-CCGSA-KEY.                               00001880
00189                  24  PI-ACCT-CO             PIC X.                00001890
00190                  24  PI-ACCT-CARRIER        PIC X.                00001900
00191                  24  PI-ACCT-GROUPING       PIC X(6).             00001910
00192                  24  PI-ACCT-STATE          PIC XX.               00001920
00193                  24  PI-ACCT-ACCOUNT        PIC X(10).            00001930
00194              20  PI-ACCT-EXP-DT             PIC XX.               00001940
00195              20  PI-ACCT-REST-OF-EXP        PIC X(4).             00001950
00196                                                                   00001960
00197      EJECT                                                        00001970
uktdel*01  JOURNAL-RECORD                  COPY ELCJPFX.                00001980
uktins     COPY ELCJPFX.
00199                                      PIC X(2000).                 00001990
00200                                                                   00002000
00201      EJECT                                                        00002010
uktdel*01  DFHAID                          COPY ELCAID.                 00002020
uktins     COPY ELCAID.
00203  01  FILLER    REDEFINES DFHAID.                                  00002030
00204      12  FILLER                      PIC X(8).                    00002040
00205      12  PF-VALUES                   PIC X       OCCURS 2.        00002050
00206                                                                   00002060
00207      EJECT                                                        00002070
uktdel*01  EL6503AI                        COPY EL6503S.                00002080
uktins     COPY EL6503S.
00209                                                                   00002090
00210  01  EL6503AO-R     REDEFINES EL6503AI.                           00002100
00211      12  FILLER                      PIC X(44).                   00002110
00212      12  SCREEN-TABLE            OCCURS 6 TIMES                   00002120
00213                                  INDEXED BY ST-INDX.              00002130
00214          16  ACCT-TYPE-L             PIC S9(4)       COMP.        00002140
00215          16  ACCT-TYPE-A             PIC X.                       00002150
00216          16  ACCT-TYPE               PIC XX.                      00002160
00217          16  ACCT-ATT-AGE-L          PIC S9(4)       COMP.        00002170
00218          16  ACCT-ATT-AGE-A          PIC X.                       00002180
00219          16  ACCT-ATT-AGE            PIC 99.                      00002190
00220                                                                   00002200
00221          16  LIMITS-TABLE        OCCURS 4 TIMES                   00002210
00222                                  INDEXED BY LT-INDX.              00002220
00223              20  ACCT-AGE-L          PIC S9(4)       COMP.        00002230
00224              20  ACCT-AGE-A          PIC X.                       00002240
00225              20  ACCT-AGE            PIC 99.                      00002250
00226              20  ACCT-TERM-L         PIC S9(4)       COMP.        00002260
00227              20  ACCT-TERM-A         PIC X.                       00002270
00228              20  ACCT-TERM           PIC 9(3).                    00002280
00229              20  ACCT-MOA-L          PIC S9(4)       COMP.        00002290
00230              20  ACCT-MOA-A          PIC X.                       00002300
00231              20  ACCT-MOA            PIC 9(5).                    00002310
00232              20  ACCT-MOA1       REDEFINES                        00002320
00233                  ACCT-MOA            PIC Z,ZZZ.                   00002330
00234              20  ACCT-AMT-L          PIC S9(4)       COMP.        00002340
00235              20  ACCT-AMT-A          PIC X.                       00002350
00236              20  ACCT-AMT            PIC 9(7).                    00002360
00237              20  ACCT-AMT1       REDEFINES                        00002370
00238                  ACCT-AMT            PIC ZZZ,ZZZ.                 00002380
00239                                                                   00002390
00240      12  FILLER                      PIC X(5).                    00002400
00241                                                                   00002410
00242      EJECT                                                        00002420
00243  LINKAGE SECTION.                                                 00002430
00244  01  DFHCOMMAREA                     PIC X(1024).                 00002440
00245                                                                   00002450
00246      EJECT                                                        00002460
00247  01  PARMLIST.                                                    00002470
00248      02  FILLER                      PIC S9(8)   COMP.            00002480
00249      02  ERACCT-POINTER              PIC S9(8)   COMP.            00002490
00250      02  ELCNTL-POINTER              PIC S9(8)   COMP.            00002500
00251                                                                   00002510
uktdel*01  ACCOUNT-MASTER                  COPY ERCACCT.                00002520
uktins     COPY ERCACCT.
00253      EJECT                                                        00002530
uktdel*01  CONTROL-FILE                    COPY ELCCNTL SUPPRESS.       00002540
uktins     COPY ELCCNTL SUPPRESS.
00255      EJECT                                                        00002550
00256                                                                   00002560
00257  PROCEDURE DIVISION.                                              00002570
00258      SERVICE RELOAD PARMLIST.                                     00002580
00259                                                                   00002590
00260      MOVE EIBDATE                TO  DC-JULIAN-YYDDD.             00002600
00261      MOVE '5'                    TO  DC-OPTION-CODE.              00002610
00262      PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.               00002620
00263      MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.                   00002630
00264      MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.               00002640
00265      MOVE DC-GREG-DATE-1-YMD     TO  YMD-CURRENT-SAVE.            00002650
00266                                                                   00002660
00267      MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.     00002670
00268      IF EIBCALEN = 0                                              00002680
00269          GO TO 8800-UNAUTHORIZED-ACCESS.                          00002690
00270                                                                   00002700
00271      MOVE 2                      TO  EMI-NUMBER-OF-LINES.         00002710
00272                                                                   00002720
00273      IF PI-CALLING-PROGRAM NOT = THIS-PGM                         00002730
00274          MOVE THIS-PGM           TO  PI-CALLING-PROGRAM.          00002740
00275                                                                   00002750
00276      MOVE LOW-VALUES             TO  EL6503AI.                    00002760
00277                                                                   00002770
00278      IF EIBTRNID NOT = TRANS-ID                                   00002780
00279          MOVE PI-MAINT           TO  MAINTYPO                     00002790
00280          MOVE AL-UANON           TO  MAINTYPA                     00002800
00281          MOVE -1                 TO  MAINTYPL                     00002810
00282          IF PI-MAINT = 'S' OR 'C'                                 00002820
00283              GO TO 4000-SHOW                                      00002830
00284          ELSE                                                     00002840
00285              IF PI-MAINT = 'A'                                    00002850
00286                  MOVE 'C'        TO  PI-MAINT                     00002860
00287                  GO TO 4000-SHOW                                  00002870
00288              ELSE                                                 00002880
00289                  GO TO 8100-SEND-INITIAL-MAP.                     00002890
00290                                                                   00002900
00291      EXEC CICS HANDLE CONDITION                                   00002910
00292          PGMIDERR  (9600-PGMID-ERROR)                             00002920
00293          ERROR     (9990-ABEND)                                   00002930
00294          END-EXEC.                                                00002940
00295                                                                   00002950
00296      IF EIBAID = DFHCLEAR                                         00002960
00297          GO TO 9400-CLEAR.                                        00002970
00298                                                                   00002980
00299      EJECT                                                        00002990
00300  0200-RECEIVE.                                                    00003000
00301      IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3                       00003010
00302          MOVE ER-0008            TO  EMI-ERROR                    00003020
00303          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00003030
00304          MOVE -1                 TO  PFENTERL                     00003040
00305          GO TO 8200-SEND-DATAONLY.                                00003050
00306      EXEC CICS RECEIVE                                            00003060
00307          MAP      (MAP-NAME)                                      00003070
00308          MAPSET   (MAPSET-NAME)                                   00003080
00309          INTO     (EL6503AI)                                      00003090
00310      END-EXEC.                                                    00003100
00311                                                                   00003110
00312      IF PFENTERL = 0                                              00003120
00313          GO TO 0300-CHECK-PFKEYS.                                 00003130
00314      IF EIBAID NOT = DFHENTER                                     00003140
00315          MOVE ER-0004            TO  EMI-ERROR                    00003150
00316          GO TO 0320-INPUT-ERROR.                                  00003160
00317      IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)            00003170
00318          MOVE PF-VALUES (PFENTERI)   TO  EIBAID                   00003180
00319      ELSE                                                         00003190
00320          MOVE ER-0029            TO  EMI-ERROR                    00003200
00321          GO TO 0320-INPUT-ERROR.                                  00003210
00322      EJECT                                                        00003220
00323  0300-CHECK-PFKEYS.                                               00003230
00324      IF EIBAID = DFHPF23                                          00003240
00325          GO TO 8810-PF23.                                         00003250
00326      IF EIBAID = DFHPF24                                          00003260
00327          GO TO 9200-RETURN-MAIN-MENU.                             00003270
00328      IF EIBAID = DFHPF12                                          00003280
00329          GO TO 9500-PF12.                                         00003290
00330      IF EIBAID = DFHPF5                                           00003300
00331          MOVE XCTL-6502          TO  PGM-NAME                     00003310
00332          GO TO 9300-XCTL.                                         00003320
00333      IF EIBAID = DFHPF6                                           00003330
00334          MOVE XCTL-6501          TO  PGM-NAME                     00003340
00335          GO TO 9300-XCTL.                                         00003350
00336      IF EIBAID = DFHPF7                                           00003360
00337          MOVE XCTL-6504          TO  PGM-NAME                     00003370
00338          GO TO 9300-XCTL.                                         00003380
00339      IF EIBAID = DFHPF8                                           00003390
00340          MOVE XCTL-6506          TO  PGM-NAME                     00003400
00341          GO TO 9300-XCTL.                                         00003410
00342      IF EIBAID = DFHPF9                                           00003420
00343          MOVE XCTL-6505          TO  PGM-NAME                     00003430
00344          GO TO 9300-XCTL.                                         00003440
00345      IF EIBAID = DFHENTER                                         00003450
00346          GO TO 0330-CHECK-MAINTYP.                                00003460
00347                                                                   00003470
00348      MOVE ER-0029                TO  EMI-ERROR.                   00003480
00349  0320-INPUT-ERROR.                                                00003490
00350      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    00003500
00351      MOVE AL-UNBON               TO  PFENTERA.                    00003510
00352      MOVE -1                     TO  PFENTERL.                    00003520
00353      GO TO 8200-SEND-DATAONLY.                                    00003530
00354                                                                   00003540
00355  0330-CHECK-MAINTYP.                                              00003550
00356      IF MAINTYPL GREATER THAN ZERO                                00003560
00357          MOVE MAINTYPI           TO  WS-CHECK-MAINT-TYPE          00003570
00358          IF VALID-MAINT-TYPE                                      00003580
00359              MOVE AL-UANON       TO  MAINTYPA                     00003590
00360              MOVE MAINTYPI       TO  PI-MAINT                     00003600
00361          ELSE                                                     00003610
00362              MOVE -1             TO  MAINTYPL                     00003620
00363              MOVE AL-UABON       TO  MAINTYPA                     00003630
00364              MOVE ER-2039        TO  EMI-ERROR                    00003640
00365              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             00003650
00366              GO TO 8200-SEND-DATAONLY                             00003660
00367      ELSE                                                         00003670
00368          MOVE -1                 TO  MAINTYPL                     00003680
00369          MOVE AL-UABON           TO  MAINTYPA                     00003690
00370          MOVE ER-2039            TO  EMI-ERROR                    00003700
00371          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00003710
00372          GO TO 8200-SEND-DATAONLY.                                00003720
00373                                                                   00003730
00374      IF PI-MAINT = 'S'                                            00003740
00375          GO TO 4000-SHOW.                                         00003750
00376                                                                   00003760
00377      PERFORM 7800-COMPANY-REC-READ THRU 7899-EXIT.                00003770
00378                                                                   00003780
00379      IF EMI-ERROR NOT = ZEROS                                     00003790
00380          MOVE -1                 TO  MAINTYPL                     00003800
00381          GO TO 8200-SEND-DATAONLY.                                00003810
00382                                                                   00003820
00383      GO TO 4200-MAINT.                                            00003830
00384      EJECT                                                        00003840
00385  4000-SHOW.                                                       00003850
00386      PERFORM 7100-READ-ERACCT THRU 7100-EXIT.                     00003860
00387      MOVE LOW-VALUES             TO  EL6503AO.                    00003870
00388      GO TO 5000-BUILD-INITIAL-SCREEN.                             00003880
00389                                                                   00003890
00390      EJECT                                                        00003900
00391                                                                   00003910
00392  4200-MAINT.                                                      00003920
00393      IF NOT MODIFY-CAP                                            00003930
00394         MOVE 'UPDATE'            TO  SM-READ                      00003940
00395         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT            00003950
00396         MOVE ER-0070             TO  EMI-ERROR                    00003960
00397         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                  00003970
00398         GO TO 8100-SEND-INITIAL-MAP.                              00003980
00399                                                                   00003990
00400      PERFORM 7000-EDIT THRU 7099-EXIT.                            00004000
00401                                                                   00004010
00402      IF EMI-NO-ERRORS                                             00004020
00403          NEXT SENTENCE                                            00004030
00404      ELSE                                                         00004040
00405          GO TO 8200-SEND-DATAONLY.                                00004050
00406                                                                   00004060
00407      PERFORM 7300-READ-ERACCT-UPDATE THRU 7300-EXIT.              00004070
00408                                                                   00004080
00409      MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.              00004090
00410                                                                   00004100
00411      PERFORM 6000-CHECK-FOR-UPDATE   THRU 6049-EXIT.              00004110
00412                                                                   00004120
00413      IF AM-LAST-MAINT-USER = PI-UPDATE-BY OR                      00004130
00414         AM-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS                   00004140
00415          NEXT SENTENCE                                            00004150
00416      ELSE                                                         00004160
00417          EXEC CICS UNLOCK                                         00004170
00418               DATASET  (ACCT-FILE-ID)                             00004180
00419          END-EXEC                                                 00004190
00420          MOVE ER-0068            TO  EMI-ERROR                    00004200
00421          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00004210
00422          PERFORM 7100-READ-ERACCT  THRU 7100-EXIT                 00004220
00423          MOVE LOW-VALUES         TO  EL6503AO                     00004230
00424          MOVE -1                 TO  MAINTYPL                     00004240
00425          MOVE 'S'                TO  PI-MAINT                     00004250
00426          GO TO 5000-BUILD-INITIAL-SCREEN.                         00004260
00427                                                                   00004270
00428      MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.          00004280
00429      MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.        00004290
00430      MOVE EIBDATE                TO  DC-JULIAN-YYDDD.             00004300
00431      MOVE '5'                    TO  DC-OPTION-CODE.              00004310
00432      MOVE LINK-ELDATCV           TO  PGM-NAME.                    00004320
00433                                                                   00004330
00434      EXEC CICS LINK                                               00004340
00435          PROGRAM   (PGM-NAME)                                     00004350
00436          COMMAREA  (DATE-CONVERSION-DATA)                         00004360
00437          LENGTH    (DC-COMM-LENGTH)                               00004370
00438      END-EXEC.                                                    00004380
00439                                                                   00004390
00440      MOVE DC-BIN-DATE-1          TO  AM-LAST-MAINT-DT             00004400
00441                                      BIN-CURRENT-SAVE.            00004410
00442 *    MOVE YMD-CURRENT-SAVE       TO  ACC-LST-75-UPD.              00004420
00443      MOVE 'B'                    TO  JP-RECORD-TYPE.              00004430
00444      MOVE ERACCT-LENGTH          TO  WS-JOURNAL-FILE-LENGTH.      00004440
00445      MOVE ACCT-FILE-ID           TO  FILE-ID.                     00004450
00446      PERFORM 8400-LOG-JOURNAL-RECORD.                             00004460
00447      MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.              00004470
00448                                                                   00004480
00449      EXEC CICS REWRITE                                            00004490
00450          DATASET  (ACCT-FILE-ID)                                  00004500
00451          FROM     (ACCOUNT-MASTER)                                00004510
00452      END-EXEC.                                                    00004520
00453                                                                   00004530
00454      MOVE 'C'                    TO  JP-RECORD-TYPE.              00004540
00455      MOVE ERACCT-LENGTH          TO  WS-JOURNAL-FILE-LENGTH.      00004550
00456      MOVE ACCT-FILE-ID           TO  FILE-ID.                     00004560
00457      PERFORM 8400-LOG-JOURNAL-RECORD.                             00004570
00458      PERFORM 8000-UPDATE-MAINT-DATE THRU 8000-EXIT.               00004580
00459      MOVE ER-0000                TO  EMI-ERROR.                   00004590
00460      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    00004600
00461                                                                   00004610
00462      PERFORM 7100-READ-ERACCT THRU 7100-EXIT.                     00004620
00463      MOVE LOW-VALUES             TO  EL6503AO.                    00004630
00464      MOVE 'S'                    TO  PI-MAINT.                    00004640
00465                                                                   00004650
00466                                                                   00004660
00467      EJECT                                                        00004670
00468  5000-BUILD-INITIAL-SCREEN.                                       00004680
00469      SET ST-INDX                 TO  +1.                          00004690
00470      SET LT-INDX                 TO  +1.                          00004700
00471      MOVE +1                     TO  SUB1                         00004710
00472                                      SUB2.                        00004720
00473                                                                   00004730
00474  5010-PROCESS.                                                    00004740
00475      IF SUB1    GREATER MAX-LIMITS                                00004750
00476          MOVE PI-MAINT           TO  MAINTYPO                     00004760
00477          MOVE AL-UANON           TO  MAINTYPA                     00004770
00478          MOVE -1                 TO  MAINTYPL                     00004780
00479          GO TO 8100-SEND-INITIAL-MAP.                             00004790
00480                                                                   00004800
00481      IF AM-A-TYPE (SUB1) = ZEROS  OR  SPACES                      00004810
00482          ADD MAX-LIMITS  TO SUB1                                  00004820
00483          GO TO 5010-PROCESS.                                      00004830
00484                                                                   00004840
00485      MOVE AM-A-TYPE (SUB1)       TO  ACCT-TYPE (ST-INDX).         00004850
00486      MOVE AM-AH-ATT-AGE (SUB1)   TO  ACCT-ATT-AGE  (ST-INDX).     00004860
00487      MOVE AL-UANON               TO  ACCT-TYPE-A (ST-INDX).       00004870
00488      MOVE AL-UNNON               TO  ACCT-ATT-AGE-A (ST-INDX).    00004880
00489                                                                   00004890
00490  5020-CONT.                                                       00004900
00491      IF SUB2     GREATER +4                                       00004910
00492          SET ST-INDX UP BY +1                                     00004920
00493          ADD +1                  TO  SUB1                         00004930
00494          SET LT-INDX             TO  +1                           00004940
00495          MOVE +1                 TO  SUB2                         00004950
00496          GO TO 5010-PROCESS.                                      00004960
00497                                                                   00004970
00498      IF AM-AH-LM-AGE (SUB1 SUB2) = ZEROS AND                      00004980
00499         AM-AH-LM-DUR (SUB1 SUB2) = ZEROS AND                      00004990
00500         AM-AH-LM-MOA (SUB1 SUB2) = ZEROS AND                      00005000
00501         AM-AH-LM-AMT (SUB1 SUB2) = ZEROS                          00005010
00502             ADD  +4              TO  SUB2                         00005020
00503             GO TO 5020-CONT.                                      00005030
00504                                                                   00005040
00505      MOVE AM-AH-LM-AGE (SUB1 SUB2)                                00005050
00506                                  TO  ACCT-AGE (ST-INDX LT-INDX).  00005060
00507      MOVE AM-AH-LM-DUR (SUB1 SUB2)                                00005070
00508                                  TO  ACCT-TERM (ST-INDX LT-INDX). 00005080
00509      MOVE AM-AH-LM-MOA (SUB1 SUB2)                                00005090
00510                                  TO  ACCT-MOA1 (ST-INDX LT-INDX). 00005100
00511      MOVE AM-AH-LM-AMT (SUB1 SUB2)                                00005110
00512                                  TO  ACCT-AMT1 (ST-INDX LT-INDX). 00005120
00513                                                                   00005130
00514      MOVE AL-UNNON               TO  ACCT-AGE-A (ST-INDX LT-INDX) 00005140
00515                                      ACCT-TERM-A (ST-INDX LT-INDX)00005150
00516                                      ACCT-MOA-A (ST-INDX LT-INDX) 00005160
00517                                      ACCT-AMT-A (ST-INDX LT-INDX).00005170
00518                                                                   00005180
00519      SET LT-INDX UP BY +1.                                        00005190
00520      ADD +1                      TO  SUB2.                        00005200
00521                                                                   00005210
00522      GO TO 5020-CONT.                                             00005220
00523                                                                   00005230
00524  5099-EXIT.                                                       00005240
00525      EXIT.                                                        00005250
00526      EJECT                                                        00005260
00527  6000-CHECK-FOR-UPDATE.                                           00005270
00528      SET ST-INDX                 TO  +1.                          00005280
00529      SET LT-INDX                 TO  +1.                          00005290
00530      MOVE +1                     TO  SUB1                         00005300
00531                                      SUB2.                        00005310
00532                                                                   00005320
00533  6010-PROCESS.                                                    00005330
00534      IF ST-INDX GREATER THAN MAX-LIMITS                           00005340
00535          IF SUB1 GREATER THAN MAX-LIMITS                          00005350
00536              GO TO 6049-EXIT                                      00005360
00537          ELSE                                                     00005370
00538              MOVE ZEROS          TO  AM-A-TYPE (SUB1)             00005380
00539                                      AM-AH-ATT-AGE (SUB1)         00005390
00540              MOVE +1             TO  SUB2                         00005400
00541              PERFORM 6060-ZERO-AGE-GROUP THRU 6069-EXIT           00005410
00542              ADD +1              TO  SUB1                         00005420
00543              GO TO 6010-PROCESS.                                  00005430
00544                                                                   00005440
00545                                                                   00005450
00546      IF ACCT-TYPE-L (ST-INDX) GREATER ZERO                        00005460
00547          MOVE ACCT-TYPE (ST-INDX)    TO  AM-A-TYPE (SUB1)         00005470
00548          IF ACCT-TYPE (ST-INDX) = ZEROS  OR  SPACES               00005480
00549              MOVE ZEROS          TO  AM-AH-ATT-AGE (SUB1)         00005490
00550              MOVE +1             TO  SUB2                         00005500
00551              PERFORM 6060-ZERO-AGE-GROUP THRU 6069-EXIT           00005510
00552              SET ST-INDX UP BY +1                                 00005520
00553              GO TO 6010-PROCESS                                   00005530
00554          ELSE                                                     00005540
00555              NEXT SENTENCE                                        00005550
00556      ELSE                                                         00005560
00557          SET ST-INDX UP BY MAX-LIMITS                             00005570
00558          GO TO 6010-PROCESS.                                      00005580
00559                                                                   00005590
00560      IF ACCT-ATT-AGE-L (ST-INDX) GREATER ZERO                     00005600
00561          MOVE ACCT-ATT-AGE (ST-INDX) TO  AM-AH-ATT-AGE (SUB1).    00005610
00562                                                                   00005620
00563  6020-CONT.                                                       00005630
00564      IF LT-INDX GREATER +4                                        00005640
00565          IF SUB2 GREATER +4                                       00005650
00566              SET ST-INDX UP BY +1                                 00005660
00567              SET LT-INDX TO    +1                                 00005670
00568              ADD +1              TO  SUB1                         00005680
00569              MOVE +1             TO  SUB2                         00005690
00570              GO TO 6010-PROCESS                                   00005700
00571          ELSE                                                     00005710
00572              PERFORM 6060-ZERO-AGE-GROUP                          00005720
00573                 THRU 6069-EXIT                                    00005730
00574              MOVE +5             TO  SUB2                         00005740
00575              GO TO 6020-CONT.                                     00005750
00576                                                                   00005760
00577      IF ACCT-AGE-L (ST-INDX LT-INDX) GREATER ZERO                 00005770
00578          MOVE ACCT-AGE (ST-INDX LT-INDX)                          00005780
00579                                  TO  AM-AH-LM-AGE (SUB1 SUB2)     00005790
00580          IF ACCT-AGE (ST-INDX LT-INDX) = ZEROS                    00005800
00581              MOVE 'X'            TO  WS-DELETE1-SW                00005810
00582          ELSE                                                     00005820
00583              NEXT SENTENCE                                        00005830
00584      ELSE                                                         00005840
00585          MOVE 'X'                TO  WS-DELETE1-SW.               00005850
00586                                                                   00005860
00587                                                                   00005870
00588      IF ACCT-TERM-L (ST-INDX LT-INDX) GREATER ZERO                00005880
00589          MOVE ACCT-TERM (ST-INDX LT-INDX)                         00005890
00590                                  TO  AM-AH-LM-DUR (SUB1 SUB2)     00005900
00591          IF ACCT-TERM (ST-INDX LT-INDX) = ZEROS                   00005910
00592              MOVE 'X'            TO  WS-DELETE2-SW                00005920
00593          ELSE                                                     00005930
00594              NEXT SENTENCE                                        00005940
00595      ELSE                                                         00005950
00596          MOVE 'X'                TO  WS-DELETE2-SW.               00005960
00597                                                                   00005970
00598                                                                   00005980
00599      IF ACCT-MOA-L (ST-INDX LT-INDX) GREATER ZERO                 00005990
00600          MOVE ACCT-MOA (ST-INDX LT-INDX) TO  DEEDIT-FIELD         00006000
00601          PERFORM 7200-DEEDIT THRU 7200-EXIT                       00006010
00602          MOVE DEEDIT-FIELD-V0    TO  AM-AH-LM-MOA (SUB1 SUB2)     00006020
00603          IF DEEDIT-FIELD-V0 EQUAL ZEROS                           00006030
00604              MOVE 'X'            TO  WS-DELETE3-SW                00006040
00605          ELSE                                                     00006050
00606              NEXT SENTENCE                                        00006060
00607      ELSE                                                         00006070
00608          MOVE 'X'                TO  WS-DELETE3-SW.               00006080
00609                                                                   00006090
00610      IF ACCT-AMT-L (ST-INDX LT-INDX) GREATER ZERO                 00006100
00611          MOVE ACCT-AMT (ST-INDX LT-INDX) TO  DEEDIT-FIELD         00006110
00612          PERFORM 7200-DEEDIT THRU 7200-EXIT                       00006120
00613          MOVE DEEDIT-FIELD-V0    TO  AM-AH-LM-AMT (SUB1 SUB2)     00006130
00614          IF DEEDIT-FIELD-V0 = ZEROS                               00006140
00615              MOVE 'X'            TO  WS-DELETE4-SW                00006150
00616          ELSE                                                     00006160
00617              NEXT SENTENCE                                        00006170
00618      ELSE                                                         00006180
00619          MOVE 'X'                TO  WS-DELETE4-SW.               00006190
00620                                                                   00006200
00621      SET LT-INDX UP BY +1.                                        00006210
00622                                                                   00006220
00623      IF RECORD-TO-BE-DELETED                                      00006230
00624         MOVE SPACES              TO  WS-DELETE-SW                 00006240
00625      ELSE                                                         00006250
00626          ADD +1                  TO  SUB2.                        00006260
00627                                                                   00006270
00628      GO TO 6020-CONT.                                             00006280
00629                                                                   00006290
00630                                                                   00006300
00631  6049-EXIT.                                                       00006310
00632      EXIT.                                                        00006320
00633      EJECT                                                        00006330
00634  6060-ZERO-AGE-GROUP.                                             00006340
00635      IF SUB2    GREATER +4                                        00006350
00636          MOVE +1                 TO  SUB2                         00006360
00637          GO TO 6069-EXIT.                                         00006370
00638                                                                   00006380
00639      MOVE ZEROS                  TO  AM-AH-LM-AGE (SUB1 SUB2).    00006390
00640      MOVE ZEROS                  TO  AM-AH-LM-DUR (SUB1 SUB2).    00006400
00641      MOVE ZEROS                  TO  AM-AH-LM-MOA (SUB1 SUB2).    00006410
00642      MOVE ZEROS                  TO  AM-AH-LM-AMT (SUB1 SUB2).    00006420
00643                                                                   00006430
00644      ADD +1                      TO  SUB2.                        00006440
00645      GO TO 6060-ZERO-AGE-GROUP.                                   00006450
00646                                                                   00006460
00647  6069-EXIT.                                                       00006470
00648      EXIT.                                                        00006480
00649      EJECT                                                        00006490
00650  7000-EDIT.                                                       00006500
00651      SET ST-INDX TO +1.                                           00006510
00652      SET LT-INDX TO +1.                                           00006520
00653                                                                   00006530
00654  7010-PROCESS.                                                    00006540
00655      IF ST-INDX GREATER MAX-LIMITS                                00006550
00656          GO TO 7099-EXIT.                                         00006560
00657                                                                   00006570
00658      IF ACCT-TYPE-L (ST-INDX) GREATER ZERO                        00006580
00659          IF ACCT-TYPE (ST-INDX) = ZERO  OR  SPACES                00006590
00660              MOVE AL-UANON   TO  ACCT-TYPE-A (ST-INDX)            00006600
00661              SET ST-INDX UP BY +1                                 00006610
00662              GO TO 7010-PROCESS                                   00006620
00663          ELSE                                                     00006630
00664              IF ACCT-TYPE (ST-INDX) GREATER WS-PREV-TYPE          00006640
00665                  MOVE AL-UANON   TO  ACCT-TYPE-A (ST-INDX)        00006650
00666                  MOVE ACCT-TYPE (ST-INDX)   TO  WS-PREV-TYPE      00006660
00667              ELSE                                                 00006670
00668                  MOVE 'Y'        TO  DO-SEQ-SW                    00006680
00669      ELSE                                                         00006690
00670          SET ST-INDX UP BY MAX-LIMITS                             00006700
00671          GO TO 7010-PROCESS.                                      00006710
00672                                                                   00006720
00673      IF ACCT-ATT-AGE-L (ST-INDX) GREATER ZERO                     00006730
00674          NEXT SENTENCE                                            00006740
00675      ELSE                                                         00006750
00676          MOVE AL-UNBON           TO  ACCT-ATT-AGE-A (ST-INDX)     00006760
00677          MOVE -1                 TO  ACCT-ATT-AGE-L (ST-INDX)     00006770
00678          MOVE ER-2077            TO  EMI-ERROR                    00006780
00679          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00006790
00680          GO TO 7020-CONT.                                         00006800
00681                                                                   00006810
00682      IF ACCT-ATT-AGE (ST-INDX) NUMERIC                            00006820
00683          IF ACCT-ATT-AGE (ST-INDX) GREATER ZERO                   00006830
00684              MOVE AL-UNNON       TO  ACCT-ATT-AGE-A (ST-INDX)     00006840
00685          ELSE                                                     00006850
00686              MOVE AL-UNBON       TO  ACCT-ATT-AGE-A (ST-INDX)     00006860
00687              MOVE -1             TO  ACCT-ATT-AGE-L (ST-INDX)     00006870
00688              MOVE ER-2077        TO  EMI-ERROR                    00006880
00689              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             00006890
00690      ELSE                                                         00006900
00691          MOVE AL-UNBON           TO  ACCT-ATT-AGE-A (ST-INDX)     00006910
00692          MOVE -1                 TO  ACCT-ATT-AGE-L (ST-INDX)     00006920
00693          MOVE ER-2077            TO  EMI-ERROR                    00006930
00694          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                00006940
00695                                                                   00006950
00696  7020-CONT.                                                       00006960
00697      IF ACCT-AGE-L (ST-INDX LT-INDX) = ZERO                       00006970
00698          GO TO 7030-EDIT-TERM                                     00006980
00699      ELSE                                                         00006990
00700          ADD +1                  TO  WS-NO-OCCURS.                00007000
00701                                                                   00007010
00702      IF ACCT-AGE (ST-INDX LT-INDX) NUMERIC                        00007020
00703          IF ACCT-AGE (ST-INDX LT-INDX) = ZERO                     00007030
00704              MOVE 'X'            TO  WS-DELETE1-SW                00007040
00705              MOVE AL-UNNON       TO  ACCT-AGE-A (ST-INDX LT-INDX) 00007050
00706          ELSE                                                     00007060
00707              IF ACCT-AGE (ST-INDX LT-INDX) LESS THAN WS-PREV-AGE  00007070
00708                  MOVE -1         TO  ACCT-AGE-L (ST-INDX LT-INDX) 00007080
00709                  MOVE AL-UNBON   TO  ACCT-AGE-A (ST-INDX LT-INDX) 00007090
00710                  MOVE ER-2104    TO  EMI-ERROR                    00007100
00711                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT         00007110
00712              ELSE                                                 00007120
00713                 MOVE AL-UNNON    TO  ACCT-AGE-A (ST-INDX LT-INDX) 00007130
00714                 MOVE ACCT-AGE (ST-INDX LT-INDX) TO WS-PREV-AGE    00007140
00715      ELSE                                                         00007150
00716          MOVE AL-UNBON           TO  ACCT-AGE-A (ST-INDX LT-INDX) 00007160
00717          MOVE -1                 TO  ACCT-AGE-L (ST-INDX LT-INDX) 00007170
00718          MOVE ER-2078            TO  EMI-ERROR                    00007180
00719          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                00007190
00720                                                                   00007200
00721  7030-EDIT-TERM.                                                  00007210
00722      IF ACCT-TERM-L (ST-INDX LT-INDX) GREATER ZERO                00007220
00723          IF ACCT-TERM (ST-INDX LT-INDX) NUMERIC                   00007230
00724              MOVE AL-UNNON       TO  ACCT-TERM-A (ST-INDX LT-INDX)00007240
00725              IF ACCT-TERM (ST-INDX LT-INDX) = ZERO                00007250
00726                  MOVE 'X'        TO  WS-DELETE2-SW                00007260
00727              ELSE                                                 00007270
00728                  NEXT SENTENCE                                    00007280
00729          ELSE                                                     00007290
00730              MOVE AL-UNBON       TO  ACCT-TERM-A (ST-INDX LT-INDX)00007300
00731              MOVE -1             TO  ACCT-TERM-L (ST-INDX LT-INDX)00007310
00732              MOVE ER-2079        TO  EMI-ERROR                    00007320
00733              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             00007330
00734      ELSE                                                         00007340
00735          IF ACCT-AGE-L (ST-INDX LT-INDX) = ZERO                   00007350
00736              NEXT SENTENCE                                        00007360
00737          ELSE                                                     00007370
00738              MOVE AL-UNBON       TO  ACCT-TERM-A (ST-INDX LT-INDX)00007380
00739              MOVE -1             TO  ACCT-TERM-L (ST-INDX LT-INDX)00007390
00740              MOVE ER-2107        TO  EMI-ERROR                    00007400
00741              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.            00007410
00742                                                                   00007420
00743  7040-EDIT-MOA.                                                   00007430
00744      IF ACCT-MOA-L (ST-INDX LT-INDX) GREATER ZERO                 00007440
00745          MOVE ACCT-MOA (ST-INDX LT-INDX) TO  DEEDIT-FIELD         00007450
00746          IF ACCT-MOA (ST-INDX LT-INDX) NUMERIC                    00007460
00747              IF ACCT-MOA (ST-INDX LT-INDX) = ZEROS                00007470
00748                  MOVE 'X'        TO  WS-DELETE3-SW                00007480
00749                  GO TO 7050-EDIT-AMT                              00007490
00750              ELSE                                                 00007500
00751                  NEXT SENTENCE                                    00007510
00752          ELSE                                                     00007520
00753              NEXT SENTENCE                                        00007530
00754      ELSE                                                         00007540
00755          IF ACCT-AGE-L (ST-INDX LT-INDX) = ZERO                   00007550
00756              GO TO 7050-EDIT-AMT                                  00007560
00757          ELSE                                                     00007570
00758              MOVE AL-UNBON       TO  ACCT-AMT-A (ST-INDX LT-INDX) 00007580
00759              MOVE -1             TO  ACCT-AMT-L (ST-INDX LT-INDX) 00007590
00760              MOVE ER-2107        TO  EMI-ERROR                    00007600
00761              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             00007610
00762              GO TO 7050-EDIT-AMT.                                 00007620
00763                                                                   00007630
00764      PERFORM 7200-DEEDIT THRU 7200-EXIT.                          00007640
00765                                                                   00007650
00766      IF DEEDIT-FIELD-V0 GREATER ZERO                              00007660
00767          IF ACCT-AGE-L (ST-INDX LT-INDX) = ZERO                   00007670
00768              MOVE AL-UNBON       TO  ACCT-AGE-A (ST-INDX LT-INDX) 00007680
00769              MOVE -1             TO  ACCT-AGE-L (ST-INDX LT-INDX) 00007690
00770              MOVE ER-2107        TO  EMI-ERROR                    00007700
00771              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             00007710
00772          ELSE                                                     00007720
00773              MOVE AL-UNNON       TO  ACCT-MOA-A (ST-INDX LT-INDX) 00007730
00774              MOVE DEEDIT-FIELD-V0  TO  ACCT-MOA1 (ST-INDX LT-INDX)00007740
00775      ELSE                                                         00007750
00776          MOVE AL-UNBON           TO  ACCT-MOA-A (ST-INDX LT-INDX) 00007760
00777          MOVE -1                 TO  ACCT-MOA-L (ST-INDX LT-INDX) 00007770
00778          MOVE ER-2111            TO  EMI-ERROR                    00007780
00779          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                00007790
00780                                                                   00007800
00781  7050-EDIT-AMT.                                                   00007810
00782      IF ACCT-AMT-L (ST-INDX LT-INDX) GREATER ZERO                 00007820
00783          MOVE ACCT-AMT (ST-INDX LT-INDX) TO  DEEDIT-FIELD         00007830
00784          IF ACCT-AMT (ST-INDX LT-INDX) NUMERIC                    00007840
00785              IF ACCT-AMT (ST-INDX LT-INDX) = ZEROS                00007850
00786                  MOVE 'X'        TO  WS-DELETE4-SW                00007860
00787                  GO TO 7060-CHECK-FOR-OCCURANCE                   00007870
00788              ELSE                                                 00007880
00789                  NEXT SENTENCE                                    00007890
00790          ELSE                                                     00007900
00791              NEXT SENTENCE                                        00007910
00792      ELSE                                                         00007920
00793          IF ACCT-AGE-L (ST-INDX LT-INDX) = ZERO                   00007930
00794              GO TO 7060-CHECK-FOR-OCCURANCE                       00007940
00795          ELSE                                                     00007950
00796              MOVE AL-UNBON       TO  ACCT-AMT-A (ST-INDX LT-INDX) 00007960
00797              MOVE -1             TO  ACCT-AMT-L (ST-INDX LT-INDX) 00007970
00798              MOVE ER-2107        TO  EMI-ERROR                    00007980
00799              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             00007990
00800              GO TO 7060-CHECK-FOR-OCCURANCE.                      00008000
00801                                                                   00008010
00802      PERFORM 7200-DEEDIT THRU 7200-EXIT.                          00008020
00803                                                                   00008030
00804      IF DEEDIT-FIELD-V0 GREATER ZERO                              00008040
00805          IF ACCT-AGE-L (ST-INDX LT-INDX) = ZERO                   00008050
00806              MOVE AL-UNBON       TO  ACCT-AGE-A (ST-INDX LT-INDX) 00008060
00807              MOVE -1             TO  ACCT-AGE-L (ST-INDX LT-INDX) 00008070
00808              MOVE ER-2107        TO  EMI-ERROR                    00008080
00809              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT             00008090
00810          ELSE                                                     00008100
00811              MOVE AL-UNNON       TO  ACCT-AMT-A (ST-INDX LT-INDX) 00008110
00812              MOVE DEEDIT-FIELD-V0 TO ACCT-AMT1 (ST-INDX LT-INDX)  00008120
00813      ELSE                                                         00008130
00814          MOVE AL-UNBON           TO  ACCT-AMT-A (ST-INDX LT-INDX) 00008140
00815          MOVE -1                 TO  ACCT-AMT-L (ST-INDX LT-INDX) 00008150
00816          MOVE ER-2080            TO  EMI-ERROR                    00008160
00817          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                00008170
00818                                                                   00008180
00819  7060-CHECK-FOR-OCCURANCE.                                        00008190
00820      IF RECORD-TO-BE-DELETED                                      00008200
00821          SUBTRACT +1 FROM WS-NO-OCCURS                            00008210
00822          MOVE SPACES             TO  WS-DELETE-SW                 00008220
00823          GO TO 7070-CHECK-INDX                                    00008230
00824      ELSE                                                         00008240
00825          IF RECORD-IS-VALID                                       00008250
00826              GO TO 7070-CHECK-INDX.                               00008260
00827                                                                   00008270
00828      IF AGE-INVALID                                               00008280
00829          MOVE AL-UNBON           TO  ACCT-AGE-A (ST-INDX LT-INDX) 00008290
00830          MOVE -1                 TO  ACCT-AGE-L (ST-INDX LT-INDX) 00008300
00831          MOVE ER-2078            TO  EMI-ERROR                    00008310
00832          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                00008320
00833                                                                   00008330
00834      IF TERM-INVALID                                              00008340
00835          MOVE AL-UNBON           TO  ACCT-TERM-A (ST-INDX LT-INDX)00008350
00836          MOVE -1                 TO  ACCT-TERM-L (ST-INDX LT-INDX)00008360
00837          MOVE ER-2079            TO  EMI-ERROR                    00008370
00838          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                00008380
00839                                                                   00008390
00840      IF MOA-INVALID                                               00008400
00841          MOVE AL-UNBON           TO  ACCT-MOA-A (ST-INDX LT-INDX) 00008410
00842          MOVE -1                 TO  ACCT-MOA-L (ST-INDX LT-INDX) 00008420
00843          MOVE ER-2111            TO  EMI-ERROR                    00008430
00844          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                00008440
00845                                                                   00008450
00846      IF AMT-INVALID                                               00008460
00847          MOVE AL-UNBON           TO  ACCT-AMT-A (ST-INDX LT-INDX) 00008470
00848          MOVE -1                 TO  ACCT-AMT-L (ST-INDX LT-INDX) 00008480
00849          MOVE ER-2080            TO  EMI-ERROR                    00008490
00850          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                00008500
00851                                                                   00008510
00852      MOVE SPACES                 TO  WS-DELETE-SW.                00008520
00853                                                                   00008530
00854  7070-CHECK-INDX.                                                 00008540
00855      SET LT-INDX UP BY +1.                                        00008550
00856                                                                   00008560
00857      IF LT-INDX GREATER +4                                        00008570
00858          NEXT SENTENCE                                            00008580
00859      ELSE                                                         00008590
00860          GO TO 7020-CONT.                                         00008600
00861                                                                   00008610
00862      IF DO-SEQ-SW EQUAL TO 'Y'                                    00008620
00863          PERFORM 7500-SEQ-LIMITS  THRU 7599-EXIT.                 00008630
00864                                                                   00008640
00865      IF NO-OCCURRENCES                                            00008650
00866          SET LT-INDX             TO  +1                           00008660
00867          MOVE AL-UNBON           TO  ACCT-AGE-A (ST-INDX LT-INDX) 00008670
00868                                      ACCT-TERM-A (ST-INDX LT-INDX)00008680
00869                                      ACCT-MOA-A (ST-INDX LT-INDX) 00008690
00870                                      ACCT-AMT-A (ST-INDX LT-INDX) 00008700
00871          MOVE -1                 TO  ACCT-AGE-L (ST-INDX LT-INDX) 00008710
00872          MOVE ER-2108            TO  EMI-ERROR                    00008720
00873          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT                 00008730
00874          MOVE ER-2110            TO  EMI-ERROR                    00008740
00875          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                00008750
00876                                                                   00008760
00877      MOVE ZEROS                  TO  WS-NO-OCCURS.                00008770
00878      SET ST-INDX UP BY +1.                                        00008780
00879      SET LT-INDX                 TO  +1.                          00008790
00880      MOVE ZEROS                  TO  WS-PREV-AGE.                 00008800
00881      GO TO 7010-PROCESS.                                          00008810
00882                                                                   00008820
00883  7099-EXIT.                                                       00008830
00884      EXIT.                                                        00008840
00885      EJECT                                                        00008850
00886  7100-READ-ERACCT.                                                00008860
00887      EXEC CICS READ                                               00008870
00888           DATASET  (ACCT-FILE-ID)                                 00008880
00889           SET      (ERACCT-POINTER)                               00008890
00890           RIDFLD   (PI-ACCT-KEY)                                  00008900
00891      END-EXEC.                                                    00008910
00892                                                                   00008920
00893      SERVICE RELOAD ACCOUNT-MASTER.                               00008930
00894                                                                   00008940
00895      MOVE AM-LAST-MAINT-USER     TO  PI-UPDATE-BY.                00008950
00896      MOVE AM-LAST-MAINT-HHMMSS   TO  PI-UPDATE-HHMMSS.            00008960
00897                                                                   00008970
00898      MOVE PI-ACCT-CCGSA-KEY      TO  PI-PREV-ACCOUNT.             00008980
00899                                                                   00008990
00900  7100-EXIT.                                                       00009000
00901      EXIT.                                                        00009010
00902      EJECT                                                        00009020
00903  7200-DEEDIT.                                                     00009030
00904      EXEC CICS BIF                                                00009040
00905           DEEDIT                                                  00009050
00906           FIELD  (DEEDIT-FIELD)                                   00009060
00907           LENGTH (15)                                             00009070
00908      END-EXEC.                                                    00009080
00909                                                                   00009090
00910  7200-EXIT.                                                       00009100
00911      EXIT.                                                        00009110
00912      EJECT                                                        00009120
00913                                                                   00009130
00914  7300-READ-ERACCT-UPDATE.                                         00009140
00915      EXEC CICS READ                                               00009150
00916           DATASET  (ACCT-FILE-ID)                                 00009160
00917           SET      (ERACCT-POINTER)                               00009170
00918           RIDFLD   (PI-ACCT-KEY)                                  00009180
00919           UPDATE                                                  00009190
00920      END-EXEC.                                                    00009200
00921                                                                   00009210
00922      SERVICE RELOAD ACCOUNT-MASTER.                               00009220
00923                                                                   00009230
00924                                                                   00009240
00925  7300-EXIT.                                                       00009250
00926      EXIT.                                                        00009260
00927      EJECT                                                        00009270
00928  7500-SEQ-LIMITS.                                                 00009280
00929                                                                   00009290
00930      MOVE 'N'                    TO DO-SEQ-SW.                    00009300
00931      MOVE +1                     TO SUB5.                         00009310
00932      SET SUB3 TO ST-INDX.                                         00009320
00933      SET SUB4 TO ST-INDX.                                         00009330
00934      SUBTRACT +1 FROM SUB3.                                       00009340
00935                                                                   00009350
00936  7510-REP-SEQ.                                                    00009360
00937      MOVE ACCT-TYPE-L (SUB3)     TO WS-SAVE-TYPE-L.               00009370
00938      MOVE ACCT-TYPE-A (SUB3)     TO WS-SAVE-TYPE-A.               00009380
00939      MOVE ACCT-TYPE (SUB3)       TO WS-SAVE-TYPE.                 00009390
00940      MOVE ACCT-ATT-AGE-L (SUB3)  TO WS-SAVE-ATT-AGE-L.            00009400
00941      MOVE ACCT-ATT-AGE-A (SUB3)  TO WS-SAVE-ATT-AGE-A.            00009410
00942      MOVE ACCT-ATT-AGE (SUB3)    TO WS-SAVE-ATT-AGE.              00009420
00943  7520-SAVE-ADA.                                                   00009430
00944      MOVE ACCT-AGE-L (SUB3 SUB5)   TO WS-SAVE-AGE-L (SUB5).       00009440
00945      MOVE ACCT-AGE-A (SUB3 SUB5)   TO WS-SAVE-AGE-A (SUB5).       00009450
00946      MOVE ACCT-AGE (SUB3 SUB5)     TO WS-SAVE-AGE (SUB5).         00009460
00947      MOVE ACCT-TERM-L (SUB3 SUB5)  TO WS-SAVE-TERM-L (SUB5).      00009470
00948      MOVE ACCT-TERM-A (SUB3 SUB5)  TO WS-SAVE-TERM-A (SUB5).      00009480
00949      MOVE ACCT-TERM (SUB3 SUB5)    TO WS-SAVE-TERM (SUB5).        00009490
00950      MOVE ACCT-MOA-L (SUB3 SUB5)   TO WS-SAVE-MOA-L (SUB5).       00009500
00951      MOVE ACCT-MOA-A (SUB3 SUB5)   TO WS-SAVE-MOA-A (SUB5).       00009510
00952      MOVE ACCT-MOA (SUB3 SUB5)     TO WS-SAVE-MOA (SUB5).         00009520
00953      MOVE ACCT-AMT-L (SUB3 SUB5)   TO WS-SAVE-AMT-L (SUB5).       00009530
00954      MOVE ACCT-AMT-A (SUB3 SUB5)   TO WS-SAVE-AMT-A (SUB5).       00009540
00955      MOVE ACCT-AMT (SUB3 SUB5)     TO WS-SAVE-AMT (SUB5).         00009550
00956      ADD +1 TO SUB5.                                              00009560
00957      IF SUB5 LESS THAN +5                                         00009570
00958          GO TO 7520-SAVE-ADA.                                     00009580
00959                                                                   00009590
00960      MOVE +1                     TO SUB5.                         00009600
00961      MOVE ACCT-TYPE-L (SUB4)     TO ACCT-TYPE-L (SUB3).           00009610
00962      MOVE ACCT-TYPE-A (SUB4)     TO ACCT-TYPE-A (SUB3).           00009620
00963      MOVE ACCT-TYPE (SUB4)       TO ACCT-TYPE (SUB3).             00009630
00964      MOVE ACCT-ATT-AGE-L (SUB4)  TO ACCT-ATT-AGE-L (SUB3).        00009640
00965      MOVE ACCT-ATT-AGE-A (SUB4)  TO ACCT-ATT-AGE-A (SUB3).        00009650
00966      MOVE ACCT-ATT-AGE (SUB4)    TO ACCT-ATT-AGE (SUB3).          00009660
00967  7530-REVE-ADA.                                                   00009670
00968      MOVE ACCT-AGE-L (SUB4 SUB5)   TO ACCT-AGE-L (SUB3 SUB5).     00009680
00969      MOVE ACCT-AGE-A (SUB4 SUB5)   TO ACCT-AGE-A (SUB3 SUB5).     00009690
00970      MOVE ACCT-AGE (SUB4 SUB5)     TO ACCT-AGE (SUB3 SUB5).       00009700
00971      MOVE ACCT-TERM-L (SUB4 SUB5)  TO ACCT-TERM-L (SUB3 SUB5).    00009710
00972      MOVE ACCT-TERM-A (SUB4 SUB5)  TO ACCT-TERM-A (SUB3 SUB5).    00009720
00973      MOVE ACCT-TERM (SUB4 SUB5)    TO ACCT-TERM (SUB3 SUB5).      00009730
00974      MOVE ACCT-MOA-L (SUB4 SUB5)   TO ACCT-MOA-L (SUB3 SUB5).     00009740
00975      MOVE ACCT-MOA-A (SUB4 SUB5)   TO ACCT-MOA-A (SUB3 SUB5).     00009750
00976      MOVE ACCT-MOA (SUB4 SUB5)     TO ACCT-MOA (SUB3 SUB5).       00009760
00977      MOVE ACCT-AMT-L (SUB4 SUB5)   TO ACCT-AMT-L (SUB3 SUB5).     00009770
00978      MOVE ACCT-AMT-A (SUB4 SUB5)   TO ACCT-AMT-A (SUB3 SUB5).     00009780
00979      MOVE ACCT-AMT (SUB4 SUB5)     TO ACCT-AMT (SUB3 SUB5).       00009790
00980      ADD +1 TO SUB5.                                              00009800
00981      IF SUB5 LESS THAN +5                                         00009810
00982          GO TO 7530-REVE-ADA.                                     00009820
00983                                                                   00009830
00984      MOVE +1                     TO SUB5.                         00009840
00985      MOVE WS-SAVE-TYPE-L         TO ACCT-TYPE-L (SUB4).           00009850
00986      MOVE WS-SAVE-TYPE-A         TO ACCT-TYPE-A (SUB4).           00009860
00987      MOVE WS-SAVE-TYPE           TO ACCT-TYPE (SUB4).             00009870
00988      MOVE WS-SAVE-ATT-AGE-L      TO ACCT-ATT-AGE-L (SUB4).        00009880
00989      MOVE WS-SAVE-ATT-AGE-A      TO ACCT-ATT-AGE-A (SUB4).        00009890
00990      MOVE WS-SAVE-ATT-AGE        TO ACCT-ATT-AGE (SUB4).          00009900
00991  7540-MOVE-ADA.                                                   00009910
00992      MOVE WS-SAVE-AGE-L (SUB5)   TO ACCT-AGE-L (SUB4 SUB5).       00009920
00993      MOVE WS-SAVE-AGE-A (SUB5)   TO ACCT-AGE-A (SUB4 SUB5).       00009930
00994      MOVE WS-SAVE-AGE (SUB5)     TO ACCT-AGE (SUB4 SUB5).         00009940
00995      MOVE WS-SAVE-TERM-L (SUB5)  TO ACCT-TERM-L (SUB4 SUB5).      00009950
00996      MOVE WS-SAVE-TERM-A (SUB5)  TO ACCT-TERM-A (SUB4 SUB5).      00009960
00997      MOVE WS-SAVE-TERM (SUB5)    TO ACCT-TERM (SUB4 SUB5).        00009970
00998      MOVE WS-SAVE-MOA-L (SUB5)   TO ACCT-MOA-L (SUB4 SUB5).       00009980
00999      MOVE WS-SAVE-MOA-A (SUB5)   TO ACCT-MOA-A (SUB4 SUB5).       00009990
01000      MOVE WS-SAVE-MOA (SUB5)     TO ACCT-MOA (SUB4 SUB5).         00010000
01001      MOVE WS-SAVE-AMT-L (SUB5)   TO ACCT-AMT-L (SUB4 SUB5).       00010010
01002      MOVE WS-SAVE-AMT-A (SUB5)   TO ACCT-AMT-A (SUB4 SUB5).       00010020
01003      MOVE WS-SAVE-AMT (SUB5)     TO ACCT-AMT (SUB4 SUB5).         00010030
01004      ADD +1 TO SUB5.                                              00010040
01005      IF SUB5 LESS THAN +5                                         00010050
01006          GO TO 7540-MOVE-ADA.                                     00010060
01007                                                                   00010070
01008      IF SUB3 EQUAL +1                                             00010080
01009          GO TO 7599-EXIT.                                         00010090
01010                                                                   00010100
01011      SUBTRACT +1 FROM SUB3.                                       00010110
01012      SUBTRACT +1 FROM SUB4.                                       00010120
01013      MOVE +1                     TO SUB5.                         00010130
01014                                                                   00010140
01015      IF ACCT-TYPE (SUB3) GREATER THAN ACCT-TYPE (SUB4)            00010150
01016          GO TO 7510-REP-SEQ.                                      00010160
01017                                                                   00010170
01018  7599-EXIT.                                                       00010180
01019      EXIT.                                                        00010190
01020      EJECT                                                        00010200
01021                                                                   00010210
01022  7800-COMPANY-REC-READ.                                           00010220
01023      MOVE SPACES                 TO  ELCNTL-KEY.                  00010230
01024      MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.                00010240
01025      MOVE '1'                    TO  CNTL-REC-TYPE.               00010250
01026      MOVE +0                     TO  CNTL-SEQ-NO.                 00010260
01027                                                                   00010270
01028      EXEC CICS HANDLE CONDITION                                   00010280
01029          NOTFND    (7880-NO-COMP)                                 00010290
01030      END-EXEC.                                                    00010300
01031                                                                   00010310
01032      EXEC CICS READ                                               00010320
01033          DATASET   (CNTL-FILE-ID)                                 00010330
01034          SET       (ELCNTL-POINTER)                               00010340
01035          RIDFLD    (ELCNTL-KEY)                                   00010350
01036      END-EXEC.                                                    00010360
01037                                                                   00010370
01038      SERVICE RELOAD CONTROL-FILE.                                 00010380
01039                                                                   00010390
01040      IF CF-ACCOUNT-MSTR-MAINT-DT = LOW-VALUES                     00010400
01041          MOVE ER-2572            TO  EMI-ERROR                    00010410
01042          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                00010420
01043                                                                   00010430
01044      GO TO 7899-EXIT.                                             00010440
01045                                                                   00010450
01046  7880-NO-COMP.                                                    00010460
01047      MOVE ER-0002                TO  EMI-ERROR.                   00010470
01048      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.                    00010480
01049                                                                   00010490
01050  7899-EXIT.                                                       00010500
01051      EXIT.                                                        00010510
01052      EJECT                                                        00010520
01053  8000-UPDATE-MAINT-DATE.                                          00010530
01054      MOVE SPACES                 TO  ELCNTL-KEY.                  00010540
01055                                                                   00010550
01056      MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.                00010560
01057      MOVE '1'                    TO  CNTL-REC-TYPE.               00010570
01058      MOVE +0                     TO  CNTL-SEQ-NO.                 00010580
01059                                                                   00010590
01060      EXEC CICS HANDLE CONDITION                                   00010600
01061          NOTFND   (8000-EXIT)                                     00010610
01062      END-EXEC.                                                    00010620
01063                                                                   00010630
01064      EXEC CICS READ                                               00010640
01065          UPDATE                                                   00010650
01066          DATASET   (CNTL-FILE-ID)                                 00010660
01067          SET       (ELCNTL-POINTER)                               00010670
01068          RIDFLD    (ELCNTL-KEY)                                   00010680
01069      END-EXEC.                                                    00010690
01070                                                                   00010700
01071      SERVICE RELOAD CONTROL-FILE                                  00010710
01072                                                                   00010720
01073      MOVE CONTROL-FILE           TO  JP-RECORD-AREA.              00010730
01074      MOVE 'B'                    TO  JP-RECORD-TYPE.              00010740
01075      MOVE ELCNTL-LENGTH          TO  WS-JOURNAL-FILE-LENGTH.      00010750
01076      MOVE CNTL-FILE-ID           TO  FILE-ID.                     00010760
01077      PERFORM 8400-LOG-JOURNAL-RECORD.                             00010770
01078                                                                   00010780
01079      MOVE BIN-CURRENT-SAVE       TO  CF-ACCOUNT-MSTR-MAINT-DT.    00010790
01080                                                                   00010800
01081      MOVE CONTROL-FILE           TO  JP-RECORD-AREA.              00010810
01082      MOVE 'C'                    TO  JP-RECORD-TYPE.              00010820
01083      MOVE CNTL-FILE-ID           TO  FILE-ID.                     00010830
01084                                                                   00010840
01085      EXEC CICS REWRITE                                            00010850
01086          DATASET   (CNTL-FILE-ID)                                 00010860
01087          FROM      (CONTROL-FILE)                                 00010870
01088      END-EXEC.                                                    00010880
01089                                                                   00010890
01090      MOVE ELCNTL-LENGTH          TO  WS-JOURNAL-FILE-LENGTH.      00010900
01091      PERFORM 8400-LOG-JOURNAL-RECORD.                             00010910
01092                                                                   00010920
01093  8000-EXIT.                                                       00010930
01094       EXIT.                                                       00010940
01095      EJECT                                                        00010950
01096  8100-SEND-INITIAL-MAP.                                           00010960
01097      MOVE SAVE-DATE              TO  DATEO.                       00010970
01098      MOVE EIBTIME                TO  TIME-IN.                     00010980
01099      MOVE TIME-OUT               TO  TIMEO.                       00010990
01100      MOVE -1                     TO  PFENTERL.                    00011000
01101      MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.                    00011010
01102      MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O                     00011020
01103                                                                   00011030
01104      MOVE PI-AH-OVERRIDE-L6      TO  BENEHDGO.                    00011040
01105      MOVE PI-LIFE-OVERRIDE-L2    TO  WS-BENE-ID.                  00011050
01106      MOVE WS-PFKEY-MSG           TO  PF5KEYO.                     00011060
01107                                                                   00011070
01108      EXEC CICS SEND                                               00011080
01109          MAP      (MAP-NAME)                                      00011090
01110          MAPSET   (MAPSET-NAME)                                   00011100
01111          FROM     (EL6503AO)                                      00011110
01112          ERASE                                                    00011120
01113          CURSOR                                                   00011130
01114      END-EXEC.                                                    00011140
01115                                                                   00011150
01116      GO TO 9100-RETURN-TRAN.                                      00011160
01117                                                                   00011170
01118  8200-SEND-DATAONLY.                                              00011180
01119      MOVE SAVE-DATE              TO  DATEO.                       00011190
01120      MOVE EIBTIME                TO  TIME-IN.                     00011200
01121      MOVE TIME-OUT               TO  TIMEO.                       00011210
01122      MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.                    00011220
01123      MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.                    00011230
01124                                                                   00011240
01125      MOVE PI-AH-OVERRIDE-L6      TO  BENEHDGO.                    00011250
01126      MOVE PI-LIFE-OVERRIDE-L2    TO  WS-BENE-ID.                  00011260
01127      MOVE WS-PFKEY-MSG           TO  PF5KEYO.                     00011270
01128                                                                   00011280
01129      EXEC CICS SEND                                               00011290
01130          MAP      (MAP-NAME)                                      00011300
01131          MAPSET   (MAPSET-NAME)                                   00011310
01132          FROM     (EL6503AO)                                      00011320
01133          DATAONLY                                                 00011330
01134          ERASEAUP                                                 00011340
01135          CURSOR                                                   00011350
01136      END-EXEC.                                                    00011360
01137                                                                   00011370
01138      GO TO 9100-RETURN-TRAN.                                      00011380
01139                                                                   00011390
01140  8300-SEND-TEXT.                                                  00011400
01141      EXEC CICS SEND TEXT                                          00011410
01142          FROM     (LOGOFF-TEXT)                                   00011420
01143          LENGTH   (LOGOFF-LENGTH)                                 00011430
01144          ERASE                                                    00011440
01145          FREEKB                                                   00011450
01146      END-EXEC.                                                    00011460
01147                                                                   00011470
01148      EXEC CICS RETURN                                             00011480
01149      END-EXEC.                                                    00011490
01150                                                                   00011500
01151  8400-LOG-JOURNAL-RECORD.                                         00011510
01152      MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.                  00011520
01153      MOVE FILE-ID                TO  JP-FILE-ID.                  00011530
01154      MOVE THIS-PGM               TO  JP-PROGRAM-ID.               00011540
pemuni*    IF PI-JOURNAL-FILE-ID NOT = ZERO                             00011550
pemuni*        EXEC CICS JOURNAL                                        00011560
pemuni*            JFILEID     (PI-JOURNAL-FILE-ID)                     00011570
pemuni*            JTYPEID     ('ER')                                   00011580
pemuni*            FROM        (JOURNAL-RECORD)                         00011590
pemuni*            LENGTH      (WS-JOURNAL-FILE-LENGTH)                 00011600
pemuni*        END-EXEC.                                                00011610
01162                                                                   00011620
01163  8800-UNAUTHORIZED-ACCESS.                                        00011630
01164      MOVE UNACCESS-MSG           TO  LOGOFF-MSG.                  00011640
01165      GO TO 8300-SEND-TEXT.                                        00011650
01166                                                                   00011660
01167  8810-PF23.                                                       00011670
01168      MOVE EIBAID                 TO  PI-ENTRY-CD-1.               00011680
01169      MOVE XCTL-005               TO  PGM-NAME.                    00011690
01170      GO TO 9300-XCTL.                                             00011700
01171                                                                   00011710
01172  9000-RETURN-CICS.                                                00011720
01173      EXEC CICS RETURN                                             00011730
01174      END-EXEC.                                                    00011740
01175                                                                   00011750
01176  9100-RETURN-TRAN.                                                00011760
01177      MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.            00011770
01178      MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.        00011780
01179      EXEC CICS RETURN                                             00011790
01180          TRANSID    (TRANS-ID)                                    00011800
01181          COMMAREA   (PROGRAM-INTERFACE-BLOCK)                     00011810
01182          LENGTH     (PI-COMM-LENGTH)                              00011820
01183      END-EXEC.                                                    00011830
01184                                                                   00011840
01185  9200-RETURN-MAIN-MENU.                                           00011850
01186      MOVE XCTL-626               TO  PGM-NAME.                    00011860
01187      GO TO 9300-XCTL.                                             00011870
01188                                                                   00011880
01189  9300-XCTL.                                                       00011890
01190      EXEC CICS XCTL                                               00011900
01191          PROGRAM    (PGM-NAME)                                    00011910
01192          COMMAREA   (PROGRAM-INTERFACE-BLOCK)                     00011920
01193          LENGTH     (PI-COMM-LENGTH)                              00011930
01194      END-EXEC.                                                    00011940
01195                                                                   00011950
01196  9400-CLEAR.                                                      00011960
01197      MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.                    00011970
01198      GO TO 9300-XCTL.                                             00011980
01199                                                                   00011990
01200  9500-PF12.                                                       00012000
01201      MOVE XCTL-010               TO  PGM-NAME.                    00012010
01202      GO TO 9300-XCTL.                                             00012020
01203                                                                   00012030
01204  9600-PGMID-ERROR.                                                00012040
01205      EXEC CICS HANDLE CONDITION                                   00012050
01206          PGMIDERR    (8300-SEND-TEXT)                             00012060
01207      END-EXEC.                                                    00012070
01208                                                                   00012080
01209      MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.          00012090
01210      MOVE ' '                    TO  PI-ENTRY-CD-1.               00012100
01211      MOVE XCTL-005               TO  PGM-NAME.                    00012110
01212      MOVE PGM-NAME               TO  LOGOFF-PGM.                  00012120
01213      MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.                 00012130
01214      GO TO 9300-XCTL.                                             00012140
01215                                                                   00012150
01216  9700-LINK-DATE-CONVERT.                                          00012160
01217                                                                   00012170
01218      EXEC CICS LINK                                               00012180
01219          PROGRAM    ('ELDATCV')                                   00012190
01220          COMMAREA   (DATE-CONVERSION-DATA)                        00012200
01221          LENGTH     (DC-COMM-LENGTH)                              00012210
01222      END-EXEC.                                                    00012220
01223                                                                   00012230
01224  9700-EXIT.                                                       00012240
01225      EXIT.                                                        00012250
01226                                                                   00012260
01227  9900-ERROR-FORMAT.                                               00012270
01228      IF NOT EMI-ERRORS-COMPLETE                                   00012280
01229          MOVE LINK-001           TO  PGM-NAME                     00012290
01230          EXEC CICS LINK                                           00012300
01231              PROGRAM    (PGM-NAME)                                00012310
01232              COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)           00012320
01233              LENGTH     (EMI-COMM-LENGTH)                         00012330
01234          END-EXEC.                                                00012340
01235                                                                   00012350
01236  9900-EXIT.                                                       00012360
01237      EXIT.                                                        00012370
01238                                                                   00012380
01239  9990-ABEND.                                                      00012390
01240      MOVE LINK-004               TO  PGM-NAME.                    00012400
01241      MOVE DFHEIBLK               TO  EMI-LINE1.                   00012410
01242      EXEC CICS LINK                                               00012420
01243          PROGRAM   (PGM-NAME)                                     00012430
01244          COMMAREA  (EMI-LINE1)                                    00012440
01245          LENGTH    (72)                                           00012450
01246      END-EXEC.                                                    00012460
01247                                                                   00012470
01248      GO TO 8200-SEND-DATAONLY.                                    00012480
01249                                                                   00012490
01250      GOBACK.                                                      00012500
01251                                                                   00012510
01252  9995-SECURITY-VIOLATION.                                         00012520
01253                              COPY ELCSCTP.                        00012530
01254                                                                   00012540
01255  9995-EXIT.                                                       00012550
01256      EXIT.                                                        00012560
01257                                                                   00012570
