* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   1
* EL650.cbl
* Options: int("EL650.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL650.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL650.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL650.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL650 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 07/14/94 14:53:46.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.048.
     9
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   2
* EL650.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*        TRANSACTION - EXC4 - ACCOUNT MASTER MAINTENANCE.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL650AI FILLER
    38* 100703    2003080800002  PEMA  ADD SUPER GAP PROCESSING
    39* 110706  CR2006071700004  PEMA  ADD BRANCH LOCATIONS
    40*           AND SHIPPING ADDRESS TO ACCOUNT NOTES FILE
    41* 121207  CR2007121100001  PEMA  SPACE OUT ORIG DLR NO ON COPY
    42* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
    43* 080612  CR2012042700005  PEMA  ADD OVER 120 DAYS FOR AHL
    44* 111513  IR2013110500003  PEMA  CORRECT MAINT FUNC OF "N"
    45* 052814  CR2014012300001  PEMA  DCC CREDIT UNION CHANGES
    46* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    47* 052716  CR2016052600003  PEMA  Correct "D" delete processing
    48******************************************************************
    49
    50 ENVIRONMENT DIVISION.
    51 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   3
* EL650.cbl
    53 WORKING-STORAGE SECTION.
    54 01  DFH-START PIC X(04).
    55 77  FILLER  PIC  X(32) VALUE '********************************'.
    56 77  FILLER  PIC  X(32) VALUE '*    EL650 WORKING STORAGE     *'.
    57 77  FILLER  PIC  X(32) VALUE '********* VMOD=2.048 ***********'.
    58 77  d1                      pic s999 value +0 comp-3.
    59
    60 01  WS-COMM-LENGTH          PIC S9(4) COMP VALUE +1500.
    61
    62 01  ws-display-eff-date     pic x(10) value spaces.
    63 01  ws-display-exp-date     pic x(10) value spaces.
    64 01  WS-DATE-AREA.
    65     12  SAVE-DATE           PIC  X(8)       VALUE SPACES.
    66     12  SAVE-BIN-DATE       PIC  XX         VALUE SPACES.
    67
    68 01  STANDARD-AREAS.
    69     12  GETMAIN-SPACE           PIC  X      VALUE SPACE.
    70     12  MAP-NAME                PIC  X(8)   VALUE 'EL650A'.
    71     12  MAPSET-NAME             PIC  X(8)   VALUE 'EL650S'.
    72     12  SCREEN-NUMBER           PIC  X(4)   VALUE '650A'.
    73     12  TRANS-ID                PIC  X(4)   VALUE 'EXC4'.
    74     12  EL6311-TRANS-ID         PIC  X(4)   VALUE 'EXB1'.
    75     12  vp6311-trans-id         pic  x(4)   value 'VPB1'.
    76     12  EL1273-TRANS-ID         PIC  X(4)   VALUE 'EXX3'.
    77     12  EL652-TRANS-ID          PIC  X(4)   VALUE 'EXD4'.
    78     12  EL6523-TRANS-ID         PIC  X(4)   VALUE 'EXDD'.
    79     12  EL6311NC-TRANS-ID       PIC  X(4)   VALUE 'NXB1'.
    80     12  EL640-TRANS-ID          PIC  X(4)   VALUE 'EXC1'.
    81     12  EL658-TRANS-ID          PIC  X(4)   VALUE 'EXJ3'.
    82     12  EL130-TRANS-ID          PIC  X(4)   VALUE 'EX19'.
    83     12  EL6503-TRANS-ID         PIC  X(4)   VALUE 'EXC7'.
    84     12  EL6509-TRANS-ID         PIC  X(4)   VALUE 'EXDA'.
    85     12  EL6592-TRANS-ID         PIC  X(4)   VALUE 'EX66'.
    86     12  EL608-TRANS-ID          PIC  X(4)   VALUE 'EX1E'.
    87     12  THIS-PGM                PIC  X(8)   VALUE 'EL650'.
    88     12  PGM-NAME                PIC  X(8).
    89     12  RETURNED-FROM           PIC  X(8)   VALUE SPACES.
    90     12  TIME-IN                 PIC S9(7)   VALUE ZEROS.
    91     12  TIME-OUT-R  REDEFINES  TIME-IN.
    92         16  FILLER              PIC  X.
    93         16  TIME-OUT            PIC  99V99.
    94         16  FILLER              PIC  XX.
    95     12  XCTL-005                PIC  X(8)   VALUE 'EL005'.
    96     12  XCTL-010                PIC  X(8)   VALUE 'EL010'.
    97     12  XCTL-126                PIC  X(8)   VALUE 'EL126'.
    98     12  XCTL-EL601              PIC  X(8)   VALUE 'EL601 '.
    99     12  XCTL-6501               PIC  X(8)   VALUE 'EL6501'.
   100     12  XCTL-6502               PIC  X(8)   VALUE 'EL6502'.
   101     12  XCTL-6503               PIC  X(8)   VALUE 'EL6503'.
   102     12  XCTL-6504               PIC  X(8)   VALUE 'EL6504'.
   103     12  XCTL-6505               PIC  X(8)   VALUE 'EL6505'.
   104     12  XCTL-6506               PIC  X(8)   VALUE 'EL6506'.
   105     12  XCTL-6508               PIC  X(8)   VALUE 'EL6508'.
   106     12  XCTL-6509               PIC  X(8)   VALUE 'EL6509'.
   107     12  LINK-001                PIC  X(8)   VALUE 'EL001'.
   108     12  LINK-004                PIC  X(8)   VALUE 'EL004'.
   109     12  LINK-ELDATCV            PIC  X(8)   VALUE 'ELDATCV'.
   110     12  FILE-ID                 PIC  X(8)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   4
* EL650.cbl
   111     12  CNTL-FILE-ID            PIC  X(8)   VALUE 'ELCNTL'.
   112     12  ACCT-FILE-ID            PIC  X(8)   VALUE 'ERACCT'.
   113     12  COMP-FILE-ID            PIC  X(8)   VALUE 'ERCOMP'.
   114     12  NAME-FILE-ID            PIC  X(8)   VALUE 'ERNAME'.
   115     12  PEND2-FILE-ID           PIC  X(8)   VALUE 'ERPNDB2'.
   116     12  PLAN-FILE-ID            PIC  X(8)   VALUE 'ERPLAN'.
   117     12  ACCT2-FILE-ID           PIC  X(8)   VALUE 'ERACCT2'.
   118     12  ACCT-REC-LEN            PIC S9(4)   VALUE +2000  COMP.
   119     12  PLAN-REC-LEN            PIC S9(4)   VALUE +420   COMP.
   120     12  COMP-REC-LEN            PIC S9(4)   VALUE +700   COMP.
   121     12  NAME-REC-LEN            PIC S9(4)   VALUE +160   COMP.
   122     12  SC-ITEM                 PIC S9(4)   VALUE +1     COMP.
   123     12  ERGXRF-FILE-ID          PIC  X(8)   VALUE 'ERGXRF'.
   124     12  ERGXRF-REC-LEN          PIC S9(4)   VALUE +0     COMP.
   125     12  ERGXRF-INC-LEN          PIC S9(4)   VALUE +31    COMP.
   126     12  ERGXRF-MIN-LEN          PIC S9(4)   VALUE +109   COMP.
   127     12  ERGXRF-MAX-LEN          PIC S9(8)   VALUE +31264 COMP.
   128     12  BIN-MIN-DATE            PIC  XX     VALUE LOW-VALUES.
   129     12  BIN-MAX-DATE            PIC  XX     VALUE LOW-VALUES.
   130     12  B4-ACCT-KEY.
   131         16  B4-ACCT-CO          PIC  X      VALUE LOW-VALUES.
   132         16  B4-ACCT-CARRIER     PIC  X      VALUE SPACES.
   133         16  B4-ACCT-GROUPING    PIC  X(6)   VALUE SPACES.
   134         16  B4-ACCT-STATE       PIC  XX     VALUE SPACES.
   135         16  B4-ACCT-ACCOUNT     PIC  X(10)  VALUE SPACES.
   136         16  B4-ACCT-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   137         16  B4-ACCT-EFF-DT      PIC  XX     VALUE LOW-VALUES.
   138     12  AF-ACCT-KEY.
   139         16  AF-ACCT-CO          PIC  X      VALUE LOW-VALUES.
   140         16  AF-ACCT-CARRIER     PIC  X      VALUE SPACES.
   141         16  AF-ACCT-GROUPING    PIC  X(6)   VALUE SPACES.
   142         16  AF-ACCT-STATE       PIC  XX     VALUE SPACES.
   143         16  AF-ACCT-ACCOUNT     PIC  X(10)  VALUE SPACES.
   144         16  AF-ACCT-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   145         16  AF-ACCT-EFF-DT      PIC  XX     VALUE LOW-VALUES.
   146     12  GX-AM-CONTROL-PRIMARY.
   147         16  GX-AM-COMPANY-CD    PIC  X      VALUE LOW-VALUES.
   148         16  GX-REST-OF-KEY      PIC  X(21)  VALUE SPACES.
   149         16  GX-AM-CNTL-FILLER   PIC  X(4)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   5
* EL650.cbl
   151*                                copy ERCGXRF.
   152******************************************************************
   153*                                                                *
   154*                                                                *
   155*                            ERCGXRF                             *
   156*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   157*                            VMOD=2.002                          *
   158*                                                                *
   159*   ONLINE CREDIT SYSTEM                                         *
   160*                                                                *
   161*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   162*                                                                *
   163*   FILE TYPE = VSAM,KSDS                                        *
   164*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   165*                                                                *
   166*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   167*       ALTERNATE PATH = NONE                                    *
   168*                                                                *
   169*   LOG = NO                                                     *
   170*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   171*                                                                *
   172******************************************************************
   173
   174 01  AGENT-CROSS-REFERENCE.
   175     12  GX-RECORD-ID                PIC XX.
   176         88  VALID-GX-ID             VALUE 'GX'.
   177
   178     12  GX-CONTROL-PRIMARY.
   179         16  GX-COMPANY-CD           PIC X.
   180         16  GX-CARRIER              PIC X.
   181         16  GX-GROUPING             PIC X(6).
   182         16  GX-AGENT-NO             PIC X(10).
   183
   184     12  GX-MAINT-INFORMATION.
   185         16  GX-LAST-MAINT-DT        PIC XX.
   186         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   187         16  GX-LAST-MAINT-USER      PIC X(4).
   188         16  FILLER                  PIC X(9).
   189
   190     12  FILLER                      PIC X(37).
   191
   192     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   193
   194     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   195                            DEPENDING ON GX-AGENT-POINTER-CNT.
   196         16  GX-AM-CARRIER           PIC X.
   197         16  GX-AM-GROUPING          PIC X(6).
   198         16  GX-AM-STATE             PIC XX.
   199         16  GX-AM-ACCOUNT           PIC X(10).
   200         16  GX-AM-EXPIRATION-DT     PIC XX.
   201         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   202         16  GX-LAST-BILL-DT         PIC XX.
   203         16  GX-AM-EFF-DT            PIC XX.
   204         16  FILLER                  PIC X(4).
   205
   206******************************************************************
   207 01  WORK-AREAS-AND-SWITCHES.
   208     12  WS-PAGE-LINES               PIC  S99    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   6
* EL650.cbl
   209     12  WS-ACCT2-FOUND              PIC  X      VALUE 'N'.
   210     12  GETMAIN-SW                  PIC  X      VALUE SPACES.
   211     12  NEW-KEY-SAVE.
   212         16  NEW-KEY-COMPANY-CD      PIC  X      VALUE LOW-VALUES.
   213         16  NEW-KEY-CNTRL           PIC  X(19)  VALUE SPACES.
   214     12  WS-PLAN-KEY.
   215         16  EK-CCGSA-KEY.
   216           18  EK-COMPANY-CD         PIC  X     VALUE LOW-VALUES.
   217           18  EK-CARRIER            PIC  X     VALUE SPACES.
   218           18  EK-GROUPING           PIC  X(6)  VALUE SPACES.
   219           18  EK-STATE              PIC  XX    VALUE SPACES.
   220           18  EK-ACCOUNT            PIC  X(10) VALUE SPACES.
   221         16  EK-BTYPE                PIC  X     VALUE SPACES.
   222         16  EK-BCODE                PIC  XX    VALUE SPACES.
   223         16  EK-REVISION             PIC  XXX   VALUE SPACES.
   224     12  WS-EXP-SAVE                 PIC  XX    VALUE LOW-VALUES.
   225     12  CURRENT-SAVE                PIC  X(6)  VALUE SPACES.
   226     12  SAVE-ACCT-KEY               PIC  X(26).
   227     12  SAVE-CURR-EXP-DT            PIC  XX    VALUE LOW-VALUES.
   228     12  SAVE-CURR-EFF-DT            PIC  XX    VALUE LOW-VALUES.
   229     12  WS-EFFCHG-SAVE              PIC  9(11) VALUE ZEROS.
   230     12  WS-EXPCHG-SAVE              PIC  9(11) VALUE ZEROS.
   231     12  BIN-CURRENT-SAVE            PIC  XX    VALUE LOW-VALUES.
   232     12  WS-VERIFY-AREA.
   233         16  FILLER      OCCURS  33  TIMES
   234                             INDEXED  BY  WS-INDEX.
   235             20  WS-ACCT-KEY         PIC  X(20).
   236             20  WS-ACCT-EXP-DT      PIC  XX.
   237             20  WS-ACCT-EFF-DT      PIC  XX.
   238             20  WS-ACCT-HI-CERT     PIC  XX.
   239             20  WS-ACCT-LO-CERT     PIC  XX.
   240     12  WS-TEST-KEY                 PIC  X(20)  VALUE SPACES.
   241     12  WS-SAVE-VERIFY-KEY          PIC  X(20)  VALUE SPACES.
   242     12  WS-ACCT-VERIFY-KEY.
   243         16  WS-ACCT-VER-COMP-CD     PIC  X      VALUE LOW-VALUES.
   244         16  WS-ACCT-VER-CARR        PIC  X      VALUE SPACES.
   245         16  WS-ACCT-VER-GROUP       PIC  X(6)   VALUE SPACES.
   246         16  WS-ACCT-VER-STATE       PIC  XX     VALUE SPACES.
   247         16  WS-ACCT-VER-ACCOUNT     PIC  X(10)  VALUE SPACES.
   248         16  WS-ACCT-VER-EXP-DT      PIC  XX     VALUE LOW-VALUES.
   249     12  filler                      pic x(10)   value spaces.
   250     12  KEY-SAVE.
   251         16  SV-CO                   PIC  X      VALUE LOW-VALUES.
   252         16  SV-CARRIER              PIC  X      VALUE SPACES.
   253         16  SV-GROUPING             PIC  X(6)   VALUE SPACES.
   254         16  SV-STATE                PIC  XX     VALUE SPACES.
   255         16  SV-ACCOUNT              PIC  X(10)  VALUE SPACES.
   256
   257     12  WS-DEEDIT-FIELD              PIC X(10)  VALUE SPACES.
   258     12  WS-DT-DEEDIT-FIELD REDEFINES WS-DEEDIT-FIELD
   259                                      PIC X(10).
   260     12  WS-DEEDIT-FIELD-DATE REDEFINES WS-DT-DEEDIT-FIELD.
   261         16  FILLER                   PIC X(4).
   262         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   263
   264     12  WS-AXRF-KEY.
   265         16  WS-AXRF-COMPANY-CD      PIC  X     VALUE LOW-VALUES.
   266         16  WS-AXRF-CARRIER         PIC  X     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   7
* EL650.cbl
   267         16  WS-AXRF-GROUPING        PIC  X(6)  VALUE SPACES.
   268         16  WS-AXRF-AGENT-NO        PIC  X(10) VALUE SPACES.
   269     12  AXRF-SUB                    PIC S9(4) COMP VALUE +0.
   270     12  GX-AGENT-SUB                PIC S9(4) COMP VALUE +0.
   271     12  COMM-WORK-SUB               PIC S9(4) COMP VALUE +0.
   272     12  COMM-WORK-SUB2              PIC S9(4) COMP VALUE +0.
   273     12  ELCNTL-KEY.
   274         16  CNTL-COMP-ID            PIC  X(3) VALUE SPACES.
   275         16  CNTL-REC-TYPE           PIC  X    VALUE SPACES.
   276         16  CNTL-ACCESS.
   277             20  CNTL-STATE          PIC  XX   VALUE SPACES.
   278             20  FILLER              PIC  X    VALUE SPACES.
   279             20  CNTL-CARRIER        PIC  X    VALUE SPACES.
   280         16  CNTL-SEQ-NO             PIC S9(4) COMP VALUE +0.
   281     12  ERPNDB-KEY.
   282         16  PNDB-COMPANY-CD-A1      PIC  X  VALUE LOW-VALUES.
   283         16  PNDB-CARRIER            PIC  X    VALUE SPACES.
   284         16  PNDB-GROUPING           PIC  X(6) VALUE SPACES.
   285         16  PNDB-STATE              PIC  XX   VALUE SPACES.
   286         16  PNDB-ACCOUNT            PIC  X(10) VALUE SPACES.
   287         16  PNDB-CERT-EFF-DT        PIC  XX    VALUE LOW-VALUES.
   288         16  PNDB-CERT-NO            PIC  X(11) VALUE SPACES.
   289         16  PNDB-ALT-CHG-SEQ-NO     PIC S9(4)   COMP VALUE +0.
   290         16  PNDB-RECORD-TYPE        PIC  X   VALUE SPACES.
   291     12  REC-SW                      PIC  9          VALUE 0.
   292         88  REC-FOUND                               VALUE 1.
   293     12  K-WITH-LINE-USED            PIC  9          VALUE 0.
   294         88  K-WITH-LINE-NO                          VALUE 1.
   295     12  RETURN-FROM-SW              PIC  9          VALUE 0.
   296         88  RETURNING-FROM-6501                     VALUE 1.
   297     12  BROWSE-STARTED-SW           PIC  X          VALUE ' '.
   298         88  BROWSE-STARTED                          VALUE 'Y'.
   299     12  FIRST-TIME-SW               PIC  X          VALUE ' '.
   300         88  FIRST-TIME                              VALUE 'Y'.
   301     12  FROM-WHERE-SW               PIC  X          VALUE ' '.
   302         88  FROM-DELETE                             VALUE '1'.
   303         88  FROM-CHANGE                             VALUE '2'.
   304     12  FROM-EL608-SW               PIC  X          VALUE 'N'.
   305     12  PENDING-BUSINESS-SW         PIC  X          VALUE 'N'.
   306         88  THERE-IS-PENDING-BUSINESS               VALUE 'Y'.
   307     12  PENDING-BROWSE-SW           PIC  X          VALUE 'N'.
   308         88  PENDING-BROWSE-STARTED                  VALUE 'Y'.
   309     12  TS-QUEUE.
   310         16  TS-SCREEN               PIC  X(4)   VALUE SPACES.
   311         16  TS-TERM                 PIC  X(4)   VALUE SPACES.
   312     12  TS-LENGTH                   PIC S9(4) COMP VALUE +640.
   313     12  TS-ITEM                     PIC S9(4) COMP VALUE +0.
   314     12  AGT-SUB                     PIC 99      VALUE ZEROS.
   315     12  VALID-AGT-SW                PIC X       VALUE 'N'.
   316
   317 01  ERROR-MESSAGES.
   318     12  ER-0000             PIC  X(4)       VALUE '0000'.
   319     12  ER-0004             PIC  X(4)       VALUE '0004'.
   320     12  ER-0008             PIC  X(4)       VALUE '0008'.
   321     12  ER-0022             PIC  X(4)       VALUE '0022'.
   322     12  ER-0023             PIC  X(4)       VALUE '0023'.
   323     12  ER-0029             PIC  X(4)       VALUE '0029'.
   324     12  ER-0042             PIC  X(4)       VALUE '0042'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   8
* EL650.cbl
   325     12  ER-0050             PIC  X(4)       VALUE '0050'.
   326     12  ER-0052             PIC  X(4)       VALUE '0052'.
   327     12  ER-0066             PIC  X(4)       VALUE '0066'.
   328     12  ER-0067             PIC  X(4)       VALUE '0067'.
   329     12  ER-0070             PIC  X(4)       VALUE '0070'.
   330     12  ER-0144             PIC  X(4)       VALUE '0144'.
   331     12  ER-0168             PIC  X(4)       VALUE '0168'.
   332     12  ER-0193             PIC  X(4)       VALUE '0193'.
   333     12  ER-0195             PIC  X(4)       VALUE '0195'.
   334     12  ER-0216             PIC  X(4)       VALUE '0216'.
   335     12  ER-0226             PIC  X(4)       VALUE '0226'.
   336     12  ER-0348             PIC  X(4)       VALUE '0348'.
   337     12  ER-0453             PIC  X(4)       VALUE '0453'.
   338     12  ER-0454             PIC  X(4)       VALUE '0454'.
   339     12  ER-0455             PIC  X(4)       VALUE '0455'.
   340     12  ER-0456             PIC  X(4)       VALUE '0456'.
   341     12  ER-0457             PIC  X(4)       VALUE '0457'.
   342     12  ER-0470             PIC  X(4)       VALUE '0470'.
   343     12  ER-0471             PIC  X(4)       VALUE '0471'.
   344     12  ER-0472             PIC  X(4)       VALUE '0472'.
   345     12  ER-0482             PIC  X(4)       VALUE '0482'.
   346     12  ER-0561             PIC  X(4)       VALUE '0561'.
   347     12  ER-0619             PIC  X(4)       VALUE '0619'.
   348     12  ER-0630             PIC  X(4)       VALUE '0630'.
   349     12  ER-0668             PIC  X(4)       VALUE '0668'.
   350     12  ER-0899             PIC  X(4)       VALUE '0899'.
   351     12  ER-1220             PIC  X(4)       VALUE '1220'.
   352     12  ER-1228             PIC  X(4)       VALUE '1228'.
   353     12  ER-1238             PIC  X(4)       VALUE '1238'.
   354     12  ER-1299             PIC  X(4)       VALUE '1299'.
   355     12  ER-1612             PIC  X(4)       VALUE '1612'.
   356     12  ER-2051             PIC  X(4)       VALUE '2051'.
   357     12  ER-2052             PIC  X(4)       VALUE '2052'.
   358     12  ER-2053             PIC  X(4)       VALUE '2053'.
   359     12  ER-2054             PIC  X(4)       VALUE '2054'.
   360     12  ER-2058             PIC  X(4)       VALUE '2058'.
   361     12  ER-2059             PIC  X(4)       VALUE '2059'.
   362     12  ER-2060             PIC  X(4)       VALUE '2060'.
   363     12  ER-2061             PIC  X(4)       VALUE '2061'.
   364     12  ER-2062             PIC  X(4)       VALUE '2062'.
   365     12  ER-2063             PIC  X(4)       VALUE '2063'.
   366     12  ER-2064             PIC  X(4)       VALUE '2064'.
   367     12  ER-2065             PIC  X(4)       VALUE '2065'.
   368     12  ER-2066             PIC  X(4)       VALUE '2066'.
   369     12  ER-2068             PIC  X(4)       VALUE '2068'.
   370     12  ER-2069             PIC  X(4)       VALUE '2069'.
   371     12  ER-2070             PIC  X(4)       VALUE '2070'.
   372     12  ER-2072             PIC  X(4)       VALUE '2072'.
   373     12  ER-2073             PIC  X(4)       VALUE '2073'.
   374     12  ER-2074             PIC  X(4)       VALUE '2074'.
   375     12  ER-2075             PIC  X(4)       VALUE '2075'.
   376     12  ER-2087             PIC  X(4)       VALUE '2087'.
   377     12  ER-2113             PIC  X(4)       VALUE '2113'.
   378     12  ER-2151             PIC  X(4)       VALUE '2151'.
   379     12  ER-2370             PIC  X(4)       VALUE '2370'.
   380     12  ER-2572             PIC  X(4)       VALUE '2572'.
   381     12  ER-3155             PIC  X(4)       VALUE '3155'.
   382     12  ER-3785             PIC  X(4)       VALUE '3785'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page   9
* EL650.cbl
   383     12  ER-9638             PIC  X(4)       VALUE '9638'.
   384     12  ER-9999             PIC  X(4)       VALUE '9999'.
   385
   386 01  TEMP-STORAGE-RECORD.
   387     12  TS-ACCT-KEY     OCCURS  32  TIMES
   388                             INDEXED  BY  TS-INDEX
   389                                 PIC  X(20).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  10
* EL650.cbl
   391*    COPY ELCSCTM.
   392******************************************************************
   393*                                                                *
   394*                                                                *
   395*                            ELCSCTM                             *
   396*                            VMOD=2.001                          *
   397*                                                                *
   398*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   399*                                                                *
   400******************************************************************
   401 01  SECURITY-MESSAGE.
   402     12  FILLER                          PIC X(30)
   403            VALUE '** LOGIC SECURITY VIOLATION -'.
   404     12  SM-READ                         PIC X(6).
   405     12  FILLER                          PIC X(5)
   406            VALUE ' PGM='.
   407     12  SM-PGM                          PIC X(6).
   408     12  FILLER                          PIC X(5)
   409            VALUE ' OPR='.
   410     12  SM-PROCESSOR-ID                 PIC X(4).
   411     12  FILLER                          PIC X(6)
   412            VALUE ' TERM='.
   413     12  SM-TERMID                       PIC X(4).
   414     12  FILLER                          PIC XX   VALUE SPACE.
   415     12  SM-JUL-DATE                     PIC 9(5).
   416     12  FILLER                          PIC X    VALUE SPACE.
   417     12  SM-TIME                         PIC 99.99.
   418
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  11
* EL650.cbl
   420*    COPY ELCSCRTY.
   421******************************************************************
   422*                                                                *
   423*                                                                *
   424*                            ELCSCRTY                            *
   425*                            VMOD=2.001                          *
   426*                                                                *
   427*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   428*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   429*        SAVED IN PI-SECURITY-ADDRESS.                           *
   430*                                                                *
   431******************************************************************
   432 01  SECURITY-CONTROL.
   433     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   434     12  FILLER                       PIC XX    VALUE 'SC'.
   435     12  SC-CREDIT-CODES.
   436         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   437             20  SC-CREDIT-DISPLAY    PIC X.
   438             20  SC-CREDIT-UPDATE     PIC X.
   439     12  SC-CLAIMS-CODES.
   440         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   441             20  SC-CLAIMS-DISPLAY    PIC X.
   442             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  12
* EL650.cbl
   444*    COPY ELCLOGOF.
   445******************************************************************
   446*                                                                *
   447*                                                                *
   448*                            ELCLOGOF.                           *
   449*                            VMOD=2.001                          *
   450*                                                                *
   451*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   452*                                                                *
   453******************************************************************
   454 01  CLASIC-LOGOFF.
   455     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   456     12  LOGOFF-TEXT.
   457         16  FILLER          PIC X(5)    VALUE SPACES.
   458         16  LOGOFF-MSG.
   459             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   460             20  FILLER      PIC X       VALUE SPACES.
   461             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   462         16  FILLER          PIC X(80)
   463           VALUE '* YOU ARE NOW LOGGED OFF'.
   464         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   465         16  FILLER          PIC X       VALUE QUOTE.
   466         16  LOGOFF-SYS-MSG  PIC X(17)
   467           VALUE 'S CLAS-IC SYSTEM '.
   468     12  TEXT-MESSAGES.
   469         16  UNACCESS-MSG    PIC X(29)
   470             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   471         16  PGMIDERR-MSG    PIC X(17)
   472             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  13
* EL650.cbl
   474*    COPY ELCDATE.
   475******************************************************************
   476*                                                                *
   477*                                                                *
   478*                            ELCDATE.                            *
   479*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   480*                            VMOD=2.003
   481*                                                                *
   482*                                                                *
   483*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   484*                 LENGTH = 200                                   *
   485******************************************************************
   486
   487 01  DATE-CONVERSION-DATA.
   488     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   489     12  DC-OPTION-CODE                PIC X.
   490         88  BIN-TO-GREG                VALUE ' '.
   491         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   492         88  EDIT-GREG-TO-BIN           VALUE '2'.
   493         88  YMD-GREG-TO-BIN            VALUE '3'.
   494         88  MDY-GREG-TO-BIN            VALUE '4'.
   495         88  JULIAN-TO-BIN              VALUE '5'.
   496         88  BIN-PLUS-ELAPSED           VALUE '6'.
   497         88  FIND-CENTURY               VALUE '7'.
   498         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   499         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   500         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   501         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   502         88  JULIAN-TO-BIN-3            VALUE 'C'.
   503         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   504         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   505         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   506         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   507         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   508         88  CHECK-LEAP-YEAR            VALUE 'H'.
   509         88  BIN-3-TO-GREG              VALUE 'I'.
   510         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   511         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   512         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   513         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   514         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   515         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   516         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   517         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   518         88  THREE-CHARACTER-BIN
   519                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   520         88  GREGORIAN-TO-BIN
   521                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   522         88  BIN-TO-GREGORIAN
   523                  VALUES ' ' '1' 'I' '8' 'G'.
   524         88  JULIAN-TO-BINARY
   525                  VALUES '5' 'C' 'E' 'F'.
   526     12  DC-ERROR-CODE                 PIC X.
   527         88  NO-CONVERSION-ERROR        VALUE ' '.
   528         88  DATE-CONVERSION-ERROR
   529                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   530         88  DATE-IS-ZERO               VALUE '1'.
   531         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  14
* EL650.cbl
   532         88  DATE-IS-INVALID            VALUE '3'.
   533         88  DATE1-GREATER-DATE2        VALUE '4'.
   534         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   535         88  DATE-INVALID-OPTION        VALUE '9'.
   536         88  INVALID-CENTURY            VALUE 'A'.
   537         88  ONLY-CENTURY               VALUE 'B'.
   538         88  ONLY-LEAP-YEAR             VALUE 'C'.
   539         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   540     12  DC-END-OF-MONTH               PIC X.
   541         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   542     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   543         88  USE-NORMAL-PROCESS         VALUE ' '.
   544         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   545         88  ADJUST-UP-100-YRS          VALUE '2'.
   546     12  FILLER                        PIC X.
   547     12  DC-CONVERSION-DATES.
   548         16  DC-BIN-DATE-1             PIC XX.
   549         16  DC-BIN-DATE-2             PIC XX.
   550         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   551         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   552                       DC-GREG-DATE-1-EDIT.
   553             20  DC-EDIT1-MONTH        PIC 99.
   554             20  SLASH1-1              PIC X.
   555             20  DC-EDIT1-DAY          PIC 99.
   556             20  SLASH1-2              PIC X.
   557             20  DC-EDIT1-YEAR         PIC 99.
   558         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   559         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   560                     DC-GREG-DATE-2-EDIT.
   561             20  DC-EDIT2-MONTH        PIC 99.
   562             20  SLASH2-1              PIC X.
   563             20  DC-EDIT2-DAY          PIC 99.
   564             20  SLASH2-2              PIC X.
   565             20  DC-EDIT2-YEAR         PIC 99.
   566         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   567         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   568                     DC-GREG-DATE-1-YMD.
   569             20  DC-YMD-YEAR           PIC 99.
   570             20  DC-YMD-MONTH          PIC 99.
   571             20  DC-YMD-DAY            PIC 99.
   572         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   573         16  DC-GREG-DATE-1-MDY-R REDEFINES
   574                      DC-GREG-DATE-1-MDY.
   575             20  DC-MDY-MONTH          PIC 99.
   576             20  DC-MDY-DAY            PIC 99.
   577             20  DC-MDY-YEAR           PIC 99.
   578         16  DC-GREG-DATE-1-ALPHA.
   579             20  DC-ALPHA-MONTH        PIC X(10).
   580             20  DC-ALPHA-DAY          PIC 99.
   581             20  FILLER                PIC XX.
   582             20  DC-ALPHA-CENTURY.
   583                 24 DC-ALPHA-CEN-N     PIC 99.
   584             20  DC-ALPHA-YEAR         PIC 99.
   585         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   586         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   587         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   588         16  DC-JULIAN-DATE            PIC 9(05).
   589         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  15
* EL650.cbl
   590                                       PIC 9(05).
   591         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   592             20  DC-JULIAN-YEAR        PIC 99.
   593             20  DC-JULIAN-DAYS        PIC 999.
   594         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   595         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   596         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   597     12  DATE-CONVERSION-VARIBLES.
   598         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   599         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   600             20  FILLER                PIC 9(3).
   601             20  HOLD-CEN-1-CCYY.
   602                 24  HOLD-CEN-1-CC     PIC 99.
   603                 24  HOLD-CEN-1-YY     PIC 99.
   604             20  HOLD-CEN-1-MO         PIC 99.
   605             20  HOLD-CEN-1-DA         PIC 99.
   606         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   607             20  HOLD-CEN-1-R-MO       PIC 99.
   608             20  HOLD-CEN-1-R-DA       PIC 99.
   609             20  HOLD-CEN-1-R-CCYY.
   610                 24  HOLD-CEN-1-R-CC   PIC 99.
   611                 24  HOLD-CEN-1-R-YY   PIC 99.
   612             20  FILLER                PIC 9(3).
   613         16  HOLD-CENTURY-1-X.
   614             20  FILLER                PIC X(3)  VALUE SPACES.
   615             20  HOLD-CEN-1-X-CCYY.
   616                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   617                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   618             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   619             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   620         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   621             20  HOLD-CEN-1-R-X-MO     PIC XX.
   622             20  HOLD-CEN-1-R-X-DA     PIC XX.
   623             20  HOLD-CEN-1-R-X-CCYY.
   624                 24  HOLD-CEN-1-R-X-CC PIC XX.
   625                 24  HOLD-CEN-1-R-X-YY PIC XX.
   626             20  FILLER                PIC XXX.
   627         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   628         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   629         16  DC-JULIAN-DATE-1          PIC 9(07).
   630         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   631             20  DC-JULIAN-1-CCYY.
   632                 24  DC-JULIAN-1-CC    PIC 99.
   633                 24  DC-JULIAN-1-YR    PIC 99.
   634             20  DC-JULIAN-DA-1        PIC 999.
   635         16  DC-JULIAN-DATE-2          PIC 9(07).
   636         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   637             20  DC-JULIAN-2-CCYY.
   638                 24  DC-JULIAN-2-CC    PIC 99.
   639                 24  DC-JULIAN-2-YR    PIC 99.
   640             20  DC-JULIAN-DA-2        PIC 999.
   641         16  DC-GREG-DATE-A-EDIT.
   642             20  DC-EDITA-MONTH        PIC 99.
   643             20  SLASHA-1              PIC X VALUE '/'.
   644             20  DC-EDITA-DAY          PIC 99.
   645             20  SLASHA-2              PIC X VALUE '/'.
   646             20  DC-EDITA-CCYY.
   647                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  16
* EL650.cbl
   648                 24  DC-EDITA-YEAR     PIC 99.
   649         16  DC-GREG-DATE-B-EDIT.
   650             20  DC-EDITB-MONTH        PIC 99.
   651             20  SLASHB-1              PIC X VALUE '/'.
   652             20  DC-EDITB-DAY          PIC 99.
   653             20  SLASHB-2              PIC X VALUE '/'.
   654             20  DC-EDITB-CCYY.
   655                 24  DC-EDITB-CENT     PIC 99.
   656                 24  DC-EDITB-YEAR     PIC 99.
   657         16  DC-GREG-DATE-CYMD         PIC 9(08).
   658         16  DC-GREG-DATE-CYMD-R REDEFINES
   659                              DC-GREG-DATE-CYMD.
   660             20  DC-CYMD-CEN           PIC 99.
   661             20  DC-CYMD-YEAR          PIC 99.
   662             20  DC-CYMD-MONTH         PIC 99.
   663             20  DC-CYMD-DAY           PIC 99.
   664         16  DC-GREG-DATE-MDCY         PIC 9(08).
   665         16  DC-GREG-DATE-MDCY-R REDEFINES
   666                              DC-GREG-DATE-MDCY.
   667             20  DC-MDCY-MONTH         PIC 99.
   668             20  DC-MDCY-DAY           PIC 99.
   669             20  DC-MDCY-CEN           PIC 99.
   670             20  DC-MDCY-YEAR          PIC 99.
   671    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   672        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   673    12  DC-EL310-DATE                  PIC X(21).
   674    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  17
* EL650.cbl
   676*    COPY ELCATTR.
   677******************************************************************
   678*                                                                *
   679*                            ELCATTR.                            *
   680*                            VMOD=2.001                          *
   681*                                                                *
   682*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   683*                                                                *
   684*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   685*                                                                *
   686*                   POS 1   P=PROTECTED                          *
   687*                           U=UNPROTECTED                        *
   688*                           S=ASKIP                              *
   689*                   POS 2   A=ALPHA/NUMERIC                      *
   690*                           N=NUMERIC                            *
   691*                   POS 3   N=NORMAL                             *
   692*                           B=BRIGHT                             *
   693*                           D=DARK                               *
   694*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   695*                           OF=MODIFIED DATA TAG OFF             *
   696*                                                                *
   697*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   698******************************************************************
   699 01  ATTRIBUTE-LIST.
   700     12  AL-PABOF            PIC X       VALUE 'Y'.
   701     12  AL-PABON            PIC X       VALUE 'Z'.
   702     12  AL-PADOF            PIC X       VALUE '%'.
   703     12  AL-PADON            PIC X       VALUE '_'.
   704     12  AL-PANOF            PIC X       VALUE '-'.
   705     12  AL-PANON            PIC X       VALUE '/'.
   706     12  AL-SABOF            PIC X       VALUE '8'.
   707     12  AL-SABON            PIC X       VALUE '9'.
   708     12  AL-SADOF            PIC X       VALUE '@'.
   709     12  AL-SADON            PIC X       VALUE QUOTE.
   710     12  AL-SANOF            PIC X       VALUE '0'.
   711     12  AL-SANON            PIC X       VALUE '1'.
   712     12  AL-UABOF            PIC X       VALUE 'H'.
   713     12  AL-UABON            PIC X       VALUE 'I'.
   714     12  AL-UADOF            PIC X       VALUE '<'.
   715     12  AL-UADON            PIC X       VALUE '('.
   716     12  AL-UANOF            PIC X       VALUE ' '.
   717     12  AL-UANON            PIC X       VALUE 'A'.
   718     12  AL-UNBOF            PIC X       VALUE 'Q'.
   719     12  AL-UNBON            PIC X       VALUE 'R'.
   720     12  AL-UNDOF            PIC X       VALUE '*'.
   721     12  AL-UNDON            PIC X       VALUE ')'.
   722     12  AL-UNNOF            PIC X       VALUE '&'.
   723     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  18
* EL650.cbl
   725*    COPY ELCEMIB.
   726******************************************************************
   727*                                                                *
   728*                                                                *
   729*                            ELCEMIB.                            *
   730*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   731*                            VMOD=2.005                          *
   732*                                                                *
   733*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   734*                                                                *
   735******************************************************************
   736 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   737     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   738     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   739     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   740     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   741     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   742     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   743     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   744     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   745     12  EMI-SWITCH1             PIC X        VALUE '1'.
   746         88  EMI-NO-ERRORS                    VALUE '1'.
   747         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   748         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   749     12  EMI-SWITCH2             PIC X        VALUE '1'.
   750         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   751     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   752         88  EMI-AREA1-EMPTY                  VALUE '1'.
   753         88  EMI-AREA1-FULL                   VALUE '2'.
   754     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   755         88  EMI-AREA2-EMPTY                  VALUE '1'.
   756         88  EMI-AREA2-FULL                   VALUE '2'.
   757     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   758         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   759         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   760         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   761         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   762         88  EMI-BYPASS-FATALS                VALUE 'X'.
   763     12  EMI-ERROR-LINES.
   764         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   765         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   766         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   767         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   768             20  EMI-ERR-CODES OCCURS 10 TIMES.
   769                 24  EMI-ERR-NUM         PIC X(4).
   770                 24  EMI-FILLER          PIC X.
   771                 24  EMI-SEV             PIC X.
   772                 24  FILLER              PIC X.
   773             20  FILLER                  PIC X(02).
   774     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   775         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   776             20  EMI-ERROR-NUMBER    PIC X(4).
   777             20  EMI-FILL            PIC X.
   778             20  EMI-SEVERITY        PIC X.
   779             20  FILLER              PIC X.
   780             20  EMI-ERROR-TEXT.
   781                 24  EMI-TEXT-VARIABLE   PIC X(10).
   782                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  19
* EL650.cbl
   783     12  EMI-SEVERITY-SAVE           PIC X.
   784         88  EMI-NOTE                    VALUE 'N'.
   785         88  EMI-WARNING                 VALUE 'W'.
   786         88  EMI-FORCABLE                VALUE 'F'.
   787         88  EMI-FATAL                   VALUE 'X'.
   788     12  EMI-MESSAGE-FLAG            PIC X.
   789         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   790         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   791     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   792     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   793         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   794         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   795         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   796     12  emi-claim-no                pic x(7).
   797     12  emi-claim-type              pic x(6).
   798     12  FILLER                      PIC X(124)  VALUE SPACES.
   799     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   800     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   801     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   802     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  20
* EL650.cbl
   804*    COPY ELCINTF.
   805******************************************************************
   806*                                                                *
   807*                                                                *
   808*                            ELCINTF.                            *
   809*                            VMOD=2.017                          *
   810*                                                                *
   811*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   812*                                                                *
   813*       LENGTH = 1024                                            *
   814*                                                                *
   815******************************************************************
   816*                   C H A N G E   L O G
   817*
   818* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   819*-----------------------------------------------------------------
   820*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   821* EFFECTIVE    NUMBER
   822*-----------------------------------------------------------------
   823* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   824******************************************************************
   825 01  PROGRAM-INTERFACE-BLOCK.
   826     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   827     12  PI-CALLING-PROGRAM              PIC X(8).
   828     12  PI-SAVED-PROGRAM-1              PIC X(8).
   829     12  PI-SAVED-PROGRAM-2              PIC X(8).
   830     12  PI-SAVED-PROGRAM-3              PIC X(8).
   831     12  PI-SAVED-PROGRAM-4              PIC X(8).
   832     12  PI-SAVED-PROGRAM-5              PIC X(8).
   833     12  PI-SAVED-PROGRAM-6              PIC X(8).
   834     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   835     12  PI-COMPANY-ID                   PIC XXX.
   836     12  PI-COMPANY-CD                   PIC X.
   837
   838     12  PI-COMPANY-PASSWORD             PIC X(8).
   839
   840     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   841
   842     12  PI-CONTROL-IN-PROGRESS.
   843         16  PI-CARRIER                  PIC X.
   844         16  PI-GROUPING                 PIC X(6).
   845         16  PI-STATE                    PIC XX.
   846         16  PI-ACCOUNT                  PIC X(10).
   847         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   848                                         PIC X(10).
   849         16  PI-CLAIM-CERT-GRP.
   850             20  PI-CLAIM-NO             PIC X(7).
   851             20  PI-CERT-NO.
   852                 25  PI-CERT-PRIME       PIC X(10).
   853                 25  PI-CERT-SFX         PIC X.
   854             20  PI-CERT-EFF-DT          PIC XX.
   855         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   856             20  PI-PLAN-CODE            PIC X(2).
   857             20  PI-REVISION-NUMBER      PIC X(3).
   858             20  PI-PLAN-EFF-DT          PIC X(2).
   859             20  PI-PLAN-EXP-DT          PIC X(2).
   860             20  FILLER                  PIC X(11).
   861         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  21
* EL650.cbl
   862             20  PI-OE-REFERENCE-1.
   863                 25  PI-OE-REF-1-PRIME   PIC X(18).
   864                 25  PI-OE-REF-1-SUFF    PIC XX.
   865
   866     12  PI-SESSION-IN-PROGRESS          PIC X.
   867         88  CLAIM-SESSION                   VALUE '1'.
   868         88  CREDIT-SESSION                  VALUE '2'.
   869         88  WARRANTY-SESSION                VALUE '3'.
   870         88  MORTGAGE-SESSION                VALUE '4'.
   871         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   872
   873
   874*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   875
   876     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   877     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   878
   879     12  PI-CREDIT-USER                  PIC X.
   880         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   881         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   882
   883     12  PI-CLAIM-USER                   PIC X.
   884         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   885         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   886
   887     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   888         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   889         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   890         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   891         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   892         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   893
   894     12  PI-PROCESSOR-ID                 PIC X(4).
   895
   896     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   897
   898     12  PI-MEMBER-CAPTION               PIC X(10).
   899
   900     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   901         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   902
   903     12  PI-LIFE-OVERRIDE-L1             PIC X.
   904     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   905     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   906     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   907
   908     12  PI-AH-OVERRIDE-L1               PIC X.
   909     12  PI-AH-OVERRIDE-L2               PIC XX.
   910     12  PI-AH-OVERRIDE-L6               PIC X(6).
   911     12  PI-AH-OVERRIDE-L12              PIC X(12).
   912
   913     12  PI-NEW-SYSTEM                   PIC X(2).
   914
   915     12  PI-PRIMARY-CERT-NO              PIC X(11).
   916     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   917         88  PI-USES-PAID-TO                 VALUE '1'.
   918     12  PI-CRDTCRD-SYSTEM.
   919         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  22
* EL650.cbl
   920             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   921             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   922         16  PI-CC-MONTH-END-DT          PIC XX.
   923     12  PI-PROCESSOR-PRINTER            PIC X(4).
   924
   925     12  PI-OE-REFERENCE-2.
   926         16  PI-OE-REF-2-PRIME           PIC X(10).
   927         16  PI-OE-REF-2-SUFF            PIC X.
   928
   929     12  PI-REM-TRM-CALC-OPTION          PIC X.
   930
   931     12  PI-LANGUAGE-TYPE                PIC X.
   932             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   933             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   934             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   935
   936     12  PI-POLICY-LINKAGE-IND           PIC X.
   937         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   938         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   939                                                   LOW-VALUES.
   940
   941     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   942     12  PI-CLAIM-PW-SESSION             PIC X(1).
   943         88  PI-CLAIM-CREDIT                 VALUE '1'.
   944         88  PI-CLAIM-CONVEN                 VALUE '2'.
   945
   946     12  PI-PROCESSOR-CSR-IND            PIC X.
   947         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   948         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   949
   950     12  FILLER                          PIC X(3).
   951
   952     12  PI-SYSTEM-LEVEL                 PIC X(145).
   953
   954     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   955         PI-SYSTEM-LEVEL.
   956
   957         16  PI-ENTRY-CODES.
   958             20  PI-ENTRY-CD-1           PIC X.
   959             20  PI-ENTRY-CD-2           PIC X.
   960
   961         16  PI-RETURN-CODES.
   962             20  PI-RETURN-CD-1          PIC X.
   963             20  PI-RETURN-CD-2          PIC X.
   964
   965         16  PI-UPDATE-STATUS-SAVE.
   966             20  PI-UPDATE-BY            PIC X(4).
   967             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   968
   969         16  PI-LOWER-CASE-LETTERS       PIC X.
   970             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   971
   972*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   973*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   974*            88  CARRIER-CLM-CNTL            VALUE '2'.
   975
   976         16  PI-CERT-ACCESS-CONTROL      PIC X.
   977             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  23
* EL650.cbl
   978             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   979             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   980             88  ACCNT-CNTL                  VALUE '3'.
   981             88  CARR-ACCNT-CNTL             VALUE '4'.
   982
   983         16  PI-PROCESSOR-CAP-LIST.
   984             20  PI-SYSTEM-CONTROLS.
   985                24 PI-SYSTEM-DISPLAY     PIC X.
   986                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   987                24 PI-SYSTEM-MODIFY      PIC X.
   988                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   989             20  FILLER                  PIC XX.
   990             20  PI-DISPLAY-CAP          PIC X.
   991                 88  DISPLAY-CAP             VALUE 'Y'.
   992             20  PI-MODIFY-CAP           PIC X.
   993                 88  MODIFY-CAP              VALUE 'Y'.
   994             20  PI-MSG-AT-LOGON-CAP     PIC X.
   995                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   996             20  PI-FORCE-CAP            PIC X.
   997                 88  FORCE-CAP               VALUE 'Y'.
   998
   999         16  PI-PROGRAM-CONTROLS.
  1000             20  PI-PGM-PRINT-OPT        PIC X.
  1001             20  PI-PGM-FORMAT-OPT       PIC X.
  1002             20  PI-PGM-PROCESS-OPT      PIC X.
  1003             20  PI-PGM-TOTALS-OPT       PIC X.
  1004
  1005         16  PI-HELP-INTERFACE.
  1006             20  PI-LAST-ERROR-NO        PIC X(4).
  1007             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1008
  1009         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1010             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1011
  1012         16  PI-CR-CONTROL-IN-PROGRESS.
  1013             20  PI-CR-CARRIER           PIC X.
  1014             20  PI-CR-GROUPING          PIC X(6).
  1015             20  PI-CR-STATE             PIC XX.
  1016             20  PI-CR-ACCOUNT           PIC X(10).
  1017             20  PI-CR-FIN-RESP          PIC X(10).
  1018             20  PI-CR-TYPE              PIC X.
  1019
  1020         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1021
  1022         16  PI-CR-MONTH-END-DT          PIC XX.
  1023
  1024         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1025             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1026             88  PI-ZERO-CARRIER             VALUE '1'.
  1027             88  PI-ZERO-GROUPING            VALUE '2'.
  1028             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1029
  1030         16  PI-CARRIER-SECURITY         PIC X.
  1031             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1032
  1033         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1034             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1035             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  24
* EL650.cbl
  1036
  1037         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1038             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1039                                         INDEXED BY PI-ACCESS-NDX
  1040                                         PIC X.
  1041
  1042         16  PI-GA-BILLING-CONTROL       PIC X.
  1043             88  PI-GA-BILLING               VALUE '1'.
  1044
  1045         16  PI-MAIL-PROCESSING          PIC X.
  1046             88  PI-MAIL-YES                 VALUE 'Y'.
  1047
  1048         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1049
  1050         16  PI-AR-SYSTEM.
  1051             20  PI-AR-PROCESSING-CNTL   PIC X.
  1052                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1053             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1054             20  PI-AR-MONTH-END-DT      PIC XX.
  1055
  1056         16  PI-MP-SYSTEM.
  1057             20  PI-MORTGAGE-USER            PIC X.
  1058                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1059                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1060             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1061                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1062                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1063                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1064                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1065                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1066             20  PI-MP-MONTH-END-DT          PIC XX.
  1067             20  PI-MP-REFERENCE-NO.
  1068                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1069                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1070
  1071         16  PI-LABEL-CONTROL            PIC X(01).
  1072             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1073             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1074
  1075         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1076             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1077
  1078         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1079             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1080             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1081
  1082         16  FILLER                      PIC X(14).
  1083
  1084     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1085******************************************************************
  1086*    COPY ELC650PI.
  1087******************************************************************
  1088*
  1089*                            ELC650PI.
  1090*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1091*                            VMOD=2.007
  1092*  ***  NOTE  ***   IF ANY CHANGES ARE MADE TO THIS COPYBOOK
  1093*   YOU MUST CONSIDER ALL PROGRAMS THAT USE THIS COPYBOOK AND
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  25
* EL650.cbl
  1094* PROGRAM EL6565.  ALSO, CONSIDER EL106 AND EL1061
  1095*
  1096******************************************************************
  1097******************************************************************
  1098*                   C H A N G E   L O G
  1099*
  1100* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1101*-----------------------------------------------------------------
  1102*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1103* EFFECTIVE    NUMBER
  1104*-----------------------------------------------------------------
  1105* 101916  IR2016101900001  PEMA  Inc tot line to 3 bytes
  1106
  1107     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1108         16  PI-MAINT                   PIC X.
  1109         16  PI-PREV-ACCOUNT            PIC X(20).
  1110         16  PI-PREV-VG-ACCOUNT         PIC X(20).
  1111         16  PI-ACCT-KEY.
  1112             20  PI-ACCT-CCGSA-KEY.
  1113                 24  PI-ACCT-CO             PIC X.
  1114                 24  PI-ACCT-CARRIER        PIC X.
  1115                 24  PI-ACCT-GROUPING       PIC X(6).
  1116                 24  PI-ACCT-STATE          PIC XX.
  1117                 24  PI-ACCT-ACCOUNT        PIC X(10).
  1118             20  PI-ACCT-EXP-DT           PIC XX.
  1119             20  PI-ACCT-REST-OF-EXP      PIC X(4).
  1120         16  PI-ACCT-ID                 PIC X(8).
  1121         16  PI-PLAN-KEY.
  1122             20  PI-PLAN-ACCT-KEY.
  1123                 24  PI-PLAN-COMPANY-CD PIC X.
  1124                 24  PI-PLAN-CARRIER    PIC X.
  1125                 24  PI-PLAN-GROUP      PIC X(6).
  1126                 24  PI-PLAN-STATE      PIC X(2).
  1127                 24  PI-PLAN-ACCOUNT    PIC X(10).
  1128             20  PI-PLAN-BEN-TYPE       PIC X.
  1129             20  PI-PLAN-BEN            PIC XX.
  1130             20  PI-PLAN-REVISION       PIC X(3).
  1131         16  PI-WS-STATE                PIC XX.
  1132         16  PI-WS-CLASS                PIC XX.
  1133         16  PI-WS-DEV                  PIC X(3).
  1134         16  PI-WS-TYPE                 PIC X.
  1135         16  PI-WS-PLAN                 PIC XX.
  1136
  1137         16  PI-ERPNDB-ALT-KEY.
  1138             20  PI-PB-COMPANY-CD-A1    PIC X.
  1139             20  PI-PB-CARRIER          PIC X.
  1140             20  PI-PB-GROUPING         PIC X(6).
  1141             20  PI-PB-STATE            PIC XX.
  1142             20  PI-PB-ACCOUNT          PIC X(10).
  1143             20  PI-PB-CERT-EFF-DT      PIC XX.
  1144             20  PI-PB-CERT-NO          PIC X(10).
  1145             20  PI-PB-ALT-CHG-SEQ-NO   PIC S9(4)      COMP.
  1146             20  PI-PB-RECORD-TYPE      PIC X.
  1147
  1148         16  PI-DATE-RANGE-TABLE.
  1149             20  PI-TABLE-ENT OCCURS 32 TIMES
  1150                            INDEXED BY T-INDEX.
  1151                 24  PI-BIN-EFF-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  26
* EL650.cbl
  1152                 24  PI-BIN-EXP-DT          PIC XX.
  1153                 24  PI-BIN-MAINT-DT        PIC XX.
  1154                 24  PI-BIN-LO-CERT         PIC XX.
  1155                 24  PI-BIN-AR-HI-CERT      PIC XX.
  1156                 24  PI-BIN-HI-CERT         PIC XX.
  1157         16  PI-PAGE-NUMBER             PIC S9.
  1158             88  PI-FST-PAGE               VALUE +1.
  1159             88  PI-2ND-PAGE               VALUE +2.
  1160             88  PI-3RD-PAGE               VALUE +3.
  1161             88  PI-LST-PAGE               VALUE +4.
  1162         16  PI-TOTAL-LINES             PIC S999.
  1163         16  PI-LINE-SELECTED    PIC S9.
  1164***  Y2K PROJ 7744
  1165         16  EFFCHG-SAVE         PIC 9(11)   COMP-3.
  1166         16  BIN-EFFCHG-SAVE     PIC XX.
  1167         16  EXPCHG-SAVE         PIC 9(11)   COMP-3.
  1168***  Y2K PROJ 7744
  1169         16  BIN-EXPCHG-SAVE     PIC XX.
  1170         16  PI-RECORD-ADDED-SW  PIC X.
  1171             88  PI-RECORD-ADDED            VALUE '1'.
  1172             88  PI-RECORD-NOT-CREATED      VALUE SPACE.
  1173         16  PI-ACCNAME          PIC X(30).
  1174         16  PI-COMM-POINTER     PIC S9(8)   COMP.
  1175         16  PI-SV-MAINT         PIC X.
  1176         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
  1177         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
  1178         16  PI-UPDATE-SW        PIC X.
  1179             88  PI-CHANGES-MADE             VALUE '1'.
  1180         16  PI-NOTE-TYPE        PIC X.
  1181             88  PI-ACCT-NOTE                VALUE '1'.
  1182         16  PI-DMD-FILE-SW      PIC X.
  1183             88  END-OF-FILE                 VALUE 'E'.
  1184             88  INTO-NEXT-BENEFITS          VALUE 'I'.
  1185             88  FIRST-OCCURS                VALUE 'F'.
  1186         16  PI-DMD-OCCURS       PIC S999.
  1187         16  PI-DMD-SCREEN       PIC X.
  1188             88  SCREEN-1-DISPLAYED  VALUE '1'.
  1189             88  SCREEN-2-DISPLAYED  VALUE '2'.
  1190             88  SCREEN-3-DISPLAYED  VALUE '3'.
  1191         16  PI-NAMEFLG          PIC X.
  1192         16  PI-EL650-DEL-SW     PIC X.
  1193         16  PI-MAX-MFEE         PIC S9(5) COMP-3.
  1194         16  PI-DCC-PROD-CODE    PIC XXX.
  1195         16  FILLER              PIC X(34).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  27
* EL650.cbl
  1197*          16  PI-NAMEFLG       PIC X.
  1198
  1199*    COPY ELCJPFX.
  1200******************************************************************
  1201*                                                                *
  1202*                                                                *
  1203*                            ELCJPFX.                            *
  1204*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1205*                            VMOD=2.002                          *
  1206*                                                                *
  1207*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1208*                                                                *
  1209*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1210*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1211*        ELCNTL - CONTROL FILE                                   *
  1212*        ELMSTR - CLAIM MASTERS                                  *
  1213*        ELTRLR - ACTIVITY TRAILERS                              *
  1214*        ELCHKQ - CHECK QUE                                      *
  1215******************************************************************
  1216 01  JOURNAL-RECORD.
  1217     12  jp-date                     pic s9(5) comp-3.
  1218     12  jp-time                     pic s9(7) comp-3.
  1219     12  JP-USER-ID                  PIC X(4).
  1220     12  JP-FILE-ID                  PIC X(8).
  1221     12  JP-PROGRAM-ID               PIC X(8).
  1222     12  JP-RECORD-TYPE              PIC X.
  1223         88 JP-ADD              VALUE 'A'.
  1224         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1225         88 JP-AFTER-CHANGE     VALUE 'C'.
  1226         88 JP-DELETE           VALUE 'D'.
  1227         88 JP-GENERIC-DELETE   VALUE 'G'.
  1228         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1229         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1230     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1231     12  JP-RECORD-AREA
  1232
  1233
  1234                                 PIC  X(2000).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  28
* EL650.cbl
  1236*    COPY ELCAID.
  1237******************************************************************
  1238*                                                                *
  1239*                            ELCAID.                             *
  1240*                            VMOD=2.001                          *
  1241*                                                                *
  1242*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1243*                                                                *
  1244*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1245*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1246******************************************************************
  1247
  1248 01  DFHAID.
  1249   02  DFHNULL   PIC  X  VALUE  ' '.
  1250   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1251   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1252   02  DFHPEN    PIC  X  VALUE  '='.
  1253   02  DFHOPID   PIC  X  VALUE  'W'.
  1254   02  DFHPA1    PIC  X  VALUE  '%'.
  1255   02  DFHPA2    PIC  X  VALUE  '>'.
  1256   02  DFHPA3    PIC  X  VALUE  ','.
  1257   02  DFHPF1    PIC  X  VALUE  '1'.
  1258   02  DFHPF2    PIC  X  VALUE  '2'.
  1259   02  DFHPF3    PIC  X  VALUE  '3'.
  1260   02  DFHPF4    PIC  X  VALUE  '4'.
  1261   02  DFHPF5    PIC  X  VALUE  '5'.
  1262   02  DFHPF6    PIC  X  VALUE  '6'.
  1263   02  DFHPF7    PIC  X  VALUE  '7'.
  1264   02  DFHPF8    PIC  X  VALUE  '8'.
  1265   02  DFHPF9    PIC  X  VALUE  '9'.
  1266   02  DFHPF10   PIC  X  VALUE  ':'.
  1267   02  DFHPF11   PIC  X  VALUE  '#'.
  1268   02  DFHPF12   PIC  X  VALUE  '@'.
  1269   02  DFHPF13   PIC  X  VALUE  'A'.
  1270   02  DFHPF14   PIC  X  VALUE  'B'.
  1271   02  DFHPF15   PIC  X  VALUE  'C'.
  1272   02  DFHPF16   PIC  X  VALUE  'D'.
  1273   02  DFHPF17   PIC  X  VALUE  'E'.
  1274   02  DFHPF18   PIC  X  VALUE  'F'.
  1275   02  DFHPF19   PIC  X  VALUE  'G'.
  1276   02  DFHPF20   PIC  X  VALUE  'H'.
  1277   02  DFHPF21   PIC  X  VALUE  'I'.
  1278*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1279   02  DFHPF22   PIC  X  VALUE  '['.
  1280   02  DFHPF23   PIC  X  VALUE  '.'.
  1281   02  DFHPF24   PIC  X  VALUE  '<'.
  1282   02  DFHMSRE   PIC  X  VALUE  'X'.
  1283   02  DFHSTRF   PIC  X  VALUE  'h'.
  1284   02  DFHTRIG   PIC  X  VALUE  '"'.
  1285
  1286 01  FILLER  REDEFINES  DFHAID.
  1287     12  FILLER              PIC  X(8).
  1288     12  PF-VALUES           PIC  X      OCCURS  24  TIMES.
  1289     12  FILLER              PIC  X(3).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  29
* EL650.cbl
  1291*    COPY EL650S.
  1292 01  EL650AI.
  1293     05  FILLER            PIC  X(0012).
  1294*    -------------------------------
  1295     05  DATEL PIC S9(0004) COMP.
  1296     05  DATEF PIC  X(0001).
  1297     05  FILLER REDEFINES DATEF.
  1298         10  DATEA PIC  X(0001).
  1299     05  DATEI PIC  X(0008).
  1300*    -------------------------------
  1301     05  TIMEL PIC S9(0004) COMP.
  1302     05  TIMEF PIC  X(0001).
  1303     05  FILLER REDEFINES TIMEF.
  1304         10  TIMEA PIC  X(0001).
  1305     05  TIMEI PIC  X(0005).
  1306*    -------------------------------
  1307     05  CMPNYIDL PIC S9(0004) COMP.
  1308     05  CMPNYIDF PIC  X(0001).
  1309     05  FILLER REDEFINES CMPNYIDF.
  1310         10  CMPNYIDA PIC  X(0001).
  1311     05  CMPNYIDI PIC  X(0003).
  1312*    -------------------------------
  1313     05  USERIDL PIC S9(0004) COMP.
  1314     05  USERIDF PIC  X(0001).
  1315     05  FILLER REDEFINES USERIDF.
  1316         10  USERIDA PIC  X(0001).
  1317     05  USERIDI PIC  X(0004).
  1318*    -------------------------------
  1319     05  MAINTL PIC S9(0004) COMP.
  1320     05  MAINTF PIC  X(0001).
  1321     05  FILLER REDEFINES MAINTF.
  1322         10  MAINTA PIC  X(0001).
  1323     05  MAINTI PIC  X(0001).
  1324*    -------------------------------
  1325     05  TRNMSG1L PIC S9(0004) COMP.
  1326     05  TRNMSG1F PIC  X(0001).
  1327     05  FILLER REDEFINES TRNMSG1F.
  1328         10  TRNMSG1A PIC  X(0001).
  1329     05  TRNMSG1I PIC  X(0017).
  1330*    -------------------------------
  1331     05  LINEL PIC S9(0004) COMP.
  1332     05  LINEF PIC  X(0001).
  1333     05  FILLER REDEFINES LINEF.
  1334         10  LINEA PIC  X(0001).
  1335     05  LINEI PIC  9.
  1336*    -------------------------------
  1337     05  ACARIERL PIC S9(0004) COMP.
  1338     05  ACARIERF PIC  X(0001).
  1339     05  FILLER REDEFINES ACARIERF.
  1340         10  ACARIERA PIC  X(0001).
  1341     05  ACARIERI PIC  X(0001).
  1342*    -------------------------------
  1343     05  AGROUPL PIC S9(0004) COMP.
  1344     05  AGROUPF PIC  X(0001).
  1345     05  FILLER REDEFINES AGROUPF.
  1346         10  AGROUPA PIC  X(0001).
  1347     05  AGROUPI PIC  X(0006).
  1348*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  30
* EL650.cbl
  1349     05  ASTATEL PIC S9(0004) COMP.
  1350     05  ASTATEF PIC  X(0001).
  1351     05  FILLER REDEFINES ASTATEF.
  1352         10  ASTATEA PIC  X(0001).
  1353     05  ASTATEI PIC  X(0002).
  1354*    -------------------------------
  1355     05  AACCTL PIC S9(0004) COMP.
  1356     05  AACCTF PIC  X(0001).
  1357     05  FILLER REDEFINES AACCTF.
  1358         10  AACCTA PIC  X(0001).
  1359     05  AACCTI PIC  X(0010).
  1360*    -------------------------------
  1361     05  NAMEFLGL PIC S9(0004) COMP.
  1362     05  NAMEFLGF PIC  X(0001).
  1363     05  FILLER REDEFINES NAMEFLGF.
  1364         10  NAMEFLGA PIC  X(0001).
  1365     05  NAMEFLGI PIC  X(0001).
  1366*    -------------------------------
  1367     05  NAMEL PIC S9(0004) COMP.
  1368     05  NAMEF PIC  X(0001).
  1369     05  FILLER REDEFINES NAMEF.
  1370         10  NAMEA PIC  X(0001).
  1371     05  NAMEI PIC  X(0030).
  1372*    -------------------------------
  1373     05  ARHDGL PIC S9(0004) COMP.
  1374     05  ARHDGF PIC  X(0001).
  1375     05  FILLER REDEFINES ARHDGF.
  1376         10  ARHDGA PIC  X(0001).
  1377     05  ARHDGI PIC  X(0010).
  1378*    -------------------------------
  1379     05  DET1L PIC S9(0004) COMP.
  1380     05  DET1F PIC  X(0001).
  1381     05  FILLER REDEFINES DET1F.
  1382         10  DET1A PIC  X(0001).
  1383     05  DET1I PIC  X(0070).
  1384*    -------------------------------
  1385     05  DET2L PIC S9(0004) COMP.
  1386     05  DET2F PIC  X(0001).
  1387     05  FILLER REDEFINES DET2F.
  1388         10  DET2A PIC  X(0001).
  1389     05  DET2I PIC  X(0070).
  1390*    -------------------------------
  1391     05  DET3L PIC S9(0004) COMP.
  1392     05  DET3F PIC  X(0001).
  1393     05  FILLER REDEFINES DET3F.
  1394         10  DET3A PIC  X(0001).
  1395     05  DET3I PIC  X(0070).
  1396*    -------------------------------
  1397     05  DET4L PIC S9(0004) COMP.
  1398     05  DET4F PIC  X(0001).
  1399     05  FILLER REDEFINES DET4F.
  1400         10  DET4A PIC  X(0001).
  1401     05  DET4I PIC  X(0070).
  1402*    -------------------------------
  1403     05  DET5L PIC S9(0004) COMP.
  1404     05  DET5F PIC  X(0001).
  1405     05  FILLER REDEFINES DET5F.
  1406         10  DET5A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  31
* EL650.cbl
  1407     05  DET5I PIC  X(0070).
  1408*    -------------------------------
  1409     05  DET6L PIC S9(0004) COMP.
  1410     05  DET6F PIC  X(0001).
  1411     05  FILLER REDEFINES DET6F.
  1412         10  DET6A PIC  X(0001).
  1413     05  DET6I PIC  X(0070).
  1414*    -------------------------------
  1415     05  DET7L PIC S9(0004) COMP.
  1416     05  DET7F PIC  X(0001).
  1417     05  FILLER REDEFINES DET7F.
  1418         10  DET7A PIC  X(0001).
  1419     05  DET7I PIC  X(0070).
  1420*    -------------------------------
  1421     05  DET8L PIC S9(0004) COMP.
  1422     05  DET8F PIC  X(0001).
  1423     05  FILLER REDEFINES DET8F.
  1424         10  DET8A PIC  X(0001).
  1425     05  DET8I PIC  X(0070).
  1426*    -------------------------------
  1427     05  TRNMSG2L PIC S9(0004) COMP.
  1428     05  TRNMSG2F PIC  X(0001).
  1429     05  FILLER REDEFINES TRNMSG2F.
  1430         10  TRNMSG2A PIC  X(0001).
  1431     05  TRNMSG2I PIC  X(0020).
  1432*    -------------------------------
  1433     05  EFFCHGL PIC S9(0004) COMP.
  1434     05  EFFCHGF PIC  X(0001).
  1435     05  FILLER REDEFINES EFFCHGF.
  1436         10  EFFCHGA PIC  X(0001).
  1437     05  EFFCHGI PIC  X(0008).
  1438*    -------------------------------
  1439     05  EXPCHGL PIC S9(0004) COMP.
  1440     05  EXPCHGF PIC  X(0001).
  1441     05  FILLER REDEFINES EXPCHGF.
  1442         10  EXPCHGA PIC  X(0001).
  1443     05  EXPCHGI PIC  X(0008).
  1444*    -------------------------------
  1445     05  TRNMSG3L PIC S9(0004) COMP.
  1446     05  TRNMSG3F PIC  X(0001).
  1447     05  FILLER REDEFINES TRNMSG3F.
  1448         10  TRNMSG3A PIC  X(0001).
  1449     05  TRNMSG3I PIC  X(0003).
  1450*    -------------------------------
  1451     05  TRNTOL PIC S9(0004) COMP.
  1452     05  TRNTOF PIC  X(0001).
  1453     05  FILLER REDEFINES TRNTOF.
  1454         10  TRNTOA PIC  X(0001).
  1455     05  TRNTOI PIC  X(0019).
  1456*    -------------------------------
  1457     05  TRNTODTL PIC S9(0004) COMP.
  1458     05  TRNTODTF PIC  X(0001).
  1459     05  FILLER REDEFINES TRNTODTF.
  1460         10  TRNTODTA PIC  X(0001).
  1461     05  TRNTODTI PIC  X(0008).
  1462*    -------------------------------
  1463     05  TRNMSG4L PIC S9(0004) COMP.
  1464     05  TRNMSG4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  32
* EL650.cbl
  1465     05  FILLER REDEFINES TRNMSG4F.
  1466         10  TRNMSG4A PIC  X(0001).
  1467     05  TRNMSG4I PIC  X(0005).
  1468*    -------------------------------
  1469     05  TRNFROML PIC S9(0004) COMP.
  1470     05  TRNFROMF PIC  X(0001).
  1471     05  FILLER REDEFINES TRNFROMF.
  1472         10  TRNFROMA PIC  X(0001).
  1473     05  TRNFROMI PIC  X(0019).
  1474*    -------------------------------
  1475     05  TRNFRDTL PIC S9(0004) COMP.
  1476     05  TRNFRDTF PIC  X(0001).
  1477     05  FILLER REDEFINES TRNFRDTF.
  1478         10  TRNFRDTA PIC  X(0001).
  1479     05  TRNFRDTI PIC  X(0008).
  1480*    -------------------------------
  1481     05  ERRMSG1L PIC S9(0004) COMP.
  1482     05  ERRMSG1F PIC  X(0001).
  1483     05  FILLER REDEFINES ERRMSG1F.
  1484         10  ERRMSG1A PIC  X(0001).
  1485     05  ERRMSG1I PIC  X(0075).
  1486*    -------------------------------
  1487     05  ERRMSG2L PIC S9(0004) COMP.
  1488     05  ERRMSG2F PIC  X(0001).
  1489     05  FILLER REDEFINES ERRMSG2F.
  1490         10  ERRMSG2A PIC  X(0001).
  1491     05  ERRMSG2I PIC  X(0075).
  1492*    -------------------------------
  1493     05  PFENTERL PIC S9(0004) COMP.
  1494     05  PFENTERF PIC  X(0001).
  1495     05  FILLER REDEFINES PFENTERF.
  1496         10  PFENTERA PIC  X(0001).
  1497     05  PFENTERI PIC  9(2).
  1498 01  EL650AO REDEFINES EL650AI.
  1499     05  FILLER            PIC  X(0012).
  1500*    -------------------------------
  1501     05  FILLER            PIC  X(0003).
  1502     05  DATEO PIC  X(0008).
  1503*    -------------------------------
  1504     05  FILLER            PIC  X(0003).
  1505     05  TIMEO PIC  99.99.
  1506*    -------------------------------
  1507     05  FILLER            PIC  X(0003).
  1508     05  CMPNYIDO PIC  X(0003).
  1509*    -------------------------------
  1510     05  FILLER            PIC  X(0003).
  1511     05  USERIDO PIC  X(0004).
  1512*    -------------------------------
  1513     05  FILLER            PIC  X(0003).
  1514     05  MAINTO PIC  X(0001).
  1515*    -------------------------------
  1516     05  FILLER            PIC  X(0003).
  1517     05  TRNMSG1O PIC  X(0017).
  1518*    -------------------------------
  1519     05  FILLER            PIC  X(0003).
  1520     05  LINEO PIC  X(0001).
  1521*    -------------------------------
  1522     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  33
* EL650.cbl
  1523     05  ACARIERO PIC  X(0001).
  1524*    -------------------------------
  1525     05  FILLER            PIC  X(0003).
  1526     05  AGROUPO PIC  X(0006).
  1527*    -------------------------------
  1528     05  FILLER            PIC  X(0003).
  1529     05  ASTATEO PIC  X(0002).
  1530*    -------------------------------
  1531     05  FILLER            PIC  X(0003).
  1532     05  AACCTO PIC  X(0010).
  1533*    -------------------------------
  1534     05  FILLER            PIC  X(0003).
  1535     05  NAMEFLGO PIC  X(0001).
  1536*    -------------------------------
  1537     05  FILLER            PIC  X(0003).
  1538     05  NAMEO PIC  X(0030).
  1539*    -------------------------------
  1540     05  FILLER            PIC  X(0003).
  1541     05  ARHDGO PIC  X(0010).
  1542*    -------------------------------
  1543     05  FILLER            PIC  X(0003).
  1544     05  DET1O PIC  X(0070).
  1545*    -------------------------------
  1546     05  FILLER            PIC  X(0003).
  1547     05  DET2O PIC  X(0070).
  1548*    -------------------------------
  1549     05  FILLER            PIC  X(0003).
  1550     05  DET3O PIC  X(0070).
  1551*    -------------------------------
  1552     05  FILLER            PIC  X(0003).
  1553     05  DET4O PIC  X(0070).
  1554*    -------------------------------
  1555     05  FILLER            PIC  X(0003).
  1556     05  DET5O PIC  X(0070).
  1557*    -------------------------------
  1558     05  FILLER            PIC  X(0003).
  1559     05  DET6O PIC  X(0070).
  1560*    -------------------------------
  1561     05  FILLER            PIC  X(0003).
  1562     05  DET7O PIC  X(0070).
  1563*    -------------------------------
  1564     05  FILLER            PIC  X(0003).
  1565     05  DET8O PIC  X(0070).
  1566*    -------------------------------
  1567     05  FILLER            PIC  X(0003).
  1568     05  TRNMSG2O PIC  X(0020).
  1569*    -------------------------------
  1570     05  FILLER            PIC  X(0003).
  1571     05  EFFCHGO PIC  X(0008).
  1572*    -------------------------------
  1573     05  FILLER            PIC  X(0003).
  1574     05  EXPCHGO PIC  99B99B99.
  1575*    -------------------------------
  1576     05  FILLER            PIC  X(0003).
  1577     05  TRNMSG3O PIC  X(0003).
  1578*    -------------------------------
  1579     05  FILLER            PIC  X(0003).
  1580     05  TRNTOO PIC  X(0019).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  34
* EL650.cbl
  1581*    -------------------------------
  1582     05  FILLER            PIC  X(0003).
  1583     05  TRNTODTO PIC  X(0008).
  1584*    -------------------------------
  1585     05  FILLER            PIC  X(0003).
  1586     05  TRNMSG4O PIC  X(0005).
  1587*    -------------------------------
  1588     05  FILLER            PIC  X(0003).
  1589     05  TRNFROMO PIC  X(0019).
  1590*    -------------------------------
  1591     05  FILLER            PIC  X(0003).
  1592     05  TRNFRDTO PIC  X(0008).
  1593*    -------------------------------
  1594     05  FILLER            PIC  X(0003).
  1595     05  ERRMSG1O PIC  X(0075).
  1596*    -------------------------------
  1597     05  FILLER            PIC  X(0003).
  1598     05  ERRMSG2O PIC  X(0075).
  1599*    -------------------------------
  1600     05  FILLER            PIC  X(0003).
  1601     05  PFENTERO PIC  X(0002).
  1602*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  35
* EL650.cbl
  1604 01  EL650R  REDEFINES  EL650AI.
  1605     12  FILLER                      PIC  X(153).
  1606     12  MAP-RECORD-AREA.
  1607         16  DATE-RANGES     OCCURS  8  TIMES
  1608                                 INDEXED  BY  M-INDEX.
  1609             20  FILLER              PIC  X(3).
  1610             20  MAP-EFF-DT          PIC  X(8).
  1611             20  FILLER              PIC  X(6).
  1612             20  MAP-EXP-DT          PIC  X(8).
  1613             20  MAP-EXP-DT-ED  REDEFINES
  1614                 MAP-EXP-DT          PIC 99B99B99.
  1615             20  FILLER              PIC  X(4).
  1616             20  MAP-LST-MAINT-DT    PIC  X(8).
  1617             20  FILLER              PIC  X(3).
  1618             20  MAP-LOW-CERT        PIC  X(8).
  1619             20  FILLER              PIC  X(3).
  1620             20  MAP-HIGH-CERT       PIC  X(8).
  1621             20  FILLER              PIC  X(4).
  1622             20  MAP-AR-DATE         PIC  X(8).
  1623             20  FILLER              PIC  XX.
  1624     12  FILLER                      PIC  X(286).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  36
* EL650.cbl
  1626****************************************************************
  1627*
  1628* Copyright (c) 2007 by Clerity Solutions, Inc.
  1629* All rights reserved.
  1630*
  1631****************************************************************
  1632 01  DFHEIV.
  1633   02  DFHEIV0               PIC X(35).
  1634   02  DFHEIV1               PIC X(08).
  1635   02  DFHEIV2               PIC X(08).
  1636   02  DFHEIV3               PIC X(08).
  1637   02  DFHEIV4               PIC X(06).
  1638   02  DFHEIV5               PIC X(04).
  1639   02  DFHEIV6               PIC X(04).
  1640   02  DFHEIV7               PIC X(02).
  1641   02  DFHEIV8               PIC X(02).
  1642   02  DFHEIV9               PIC X(01).
  1643   02  DFHEIV10              PIC S9(7) COMP-3.
  1644   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1645   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1646   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1647   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1648   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1649   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1650   02  DFHEIV17              PIC X(04).
  1651   02  DFHEIV18              PIC X(04).
  1652   02  DFHEIV19              PIC X(04).
  1653   02  DFHEIV20              USAGE IS POINTER.
  1654   02  DFHEIV21              USAGE IS POINTER.
  1655   02  DFHEIV22              USAGE IS POINTER.
  1656   02  DFHEIV23              USAGE IS POINTER.
  1657   02  DFHEIV24              USAGE IS POINTER.
  1658   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1659   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1660   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1661   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1662   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1663   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1664   02  FILLER                PIC X(02).
  1665   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1666   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1667   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1668   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1669   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1670 LINKAGE  SECTION.
  1671*****************************************************************
  1672*                                                               *
  1673* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1674* All rights reserved.                                          *
  1675*                                                               *
  1676*****************************************************************
  1677 01  dfheiblk.
  1678     02  eibtime          pic s9(7) comp-3.
  1679     02  eibdate          pic s9(7) comp-3.
  1680     02  eibtrnid         pic x(4).
  1681     02  eibtaskn         pic s9(7) comp-3.
  1682     02  eibtrmid         pic x(4).
  1683     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  37
* EL650.cbl
  1684     02  eibcposn         pic s9(4) comp.
  1685     02  eibcalen         pic s9(4) comp.
  1686     02  eibaid           pic x(1).
  1687     02  eibfiller1       pic x(1).
  1688     02  eibfn            pic x(2).
  1689     02  eibfiller2       pic x(2).
  1690     02  eibrcode         pic x(6).
  1691     02  eibfiller3       pic x(2).
  1692     02  eibds            pic x(8).
  1693     02  eibreqid         pic x(8).
  1694     02  eibrsrce         pic x(8).
  1695     02  eibsync          pic x(1).
  1696     02  eibfree          pic x(1).
  1697     02  eibrecv          pic x(1).
  1698     02  eibsend          pic x(1).
  1699     02  eibatt           pic x(1).
  1700     02  eibeoc           pic x(1).
  1701     02  eibfmh           pic x(1).
  1702     02  eibcompl         pic x(1).
  1703     02  eibsig           pic x(1).
  1704     02  eibconf          pic x(1).
  1705     02  eiberr           pic x(1).
  1706     02  eibrldbk         pic x(1).
  1707     02  eiberrcd         pic x(4).
  1708     02  eibsynrb         pic x(1).
  1709     02  eibnodat         pic x(1).
  1710     02  eibfiller5       pic x(2).
  1711     02  eibresp          pic 9(09) comp.
  1712     02  eibresp2         pic 9(09) comp.
  1713     02  dfheigdj         pic s9(4) comp.
  1714     02  dfheigdk         pic s9(4) comp.
  1715 01  DFHCOMMAREA             PIC  X(1500).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  38
* EL650.cbl
  1717*01 PARMLIST .
  1718*    12  FILLER              PIC S9(8)   COMP.
  1719*    12  ERACCT-POINTER      PIC S9(8)   COMP.
  1720*    12  ERCOMP-POINTER      PIC S9(8)   COMP.
  1721*    12  ERNAME-POINTER      PIC S9(8)   COMP.
  1722*    12  ERPLAN-POINTER      PIC S9(8)   COMP.
  1723*    12  ELCNTL-POINTER      PIC S9(8)   COMP.
  1724*    12  ERPNDB-POINTER      PIC S9(8)   COMP.
  1725*    12  AXRF-POINTER        PIC S9(8)   COMP.
  1726*    12  AXRF2-POINTER       PIC S9(8)   COMP.
  1727*    12  AXRF3-POINTER       PIC S9(8)   COMP.
  1728*    12  AXRF4-POINTER       PIC S9(8)   COMP.
  1729*    12  AXRF5-POINTER       PIC S9(8)   COMP.
  1730*    12  AXRF6-POINTER       PIC S9(8)   COMP.
  1731*    12  AXRF7-POINTER       PIC S9(8)   COMP.
  1732*    12  AXRF8-POINTER       PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  39
* EL650.cbl
  1734*    COPY ERCACCT.
  1735******************************************************************
  1736*                                                                *
  1737*                                                                *
  1738*                            ERCACCT                             *
  1739*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1740*                            VMOD=2.031                          *
  1741*                                                                *
  1742*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1743*                                                                *
  1744*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1745*   VSAM ACCOUNT MASTER FILES.                                   *
  1746*                                                                *
  1747*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1748*                                                                *
  1749*   FILE TYPE = VSAM,KSDS                                        *
  1750*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1751*                                                                *
  1752*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1753*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1754*                                                                *
  1755*   LOG = NO                                                     *
  1756*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1757*                                                                *
  1758*                                                                *
  1759******************************************************************
  1760*                   C H A N G E   L O G
  1761*
  1762* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1763*-----------------------------------------------------------------
  1764*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1765* EFFECTIVE    NUMBER
  1766*-----------------------------------------------------------------
  1767* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1768* 092705    2005050300006  PEMA  ADD SPP LEASES
  1769* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1770* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1771* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1772* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1773* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1774* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1775******************************************************************
  1776
  1777 01  ACCOUNT-MASTER.
  1778     12  AM-RECORD-ID                      PIC XX.
  1779         88  VALID-AM-ID                      VALUE 'AM'.
  1780
  1781     12  AM-CONTROL-PRIMARY.
  1782         16  AM-COMPANY-CD                 PIC X.
  1783         16  AM-MSTR-CNTRL.
  1784             20  AM-CONTROL-A.
  1785                 24  AM-CARRIER            PIC X.
  1786                 24  AM-GROUPING.
  1787                     28 AM-GROUPING-PREFIX PIC XXX.
  1788                     28 AM-GROUPING-PRIME  PIC XXX.
  1789                 24  AM-STATE              PIC XX.
  1790                 24  AM-ACCOUNT.
  1791                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  40
* EL650.cbl
  1792                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1793             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1794                                           PIC X(19).
  1795             20  AM-CNTRL-B.
  1796                 24  AM-EXPIRATION-DT      PIC XX.
  1797                 24  FILLER                PIC X(4).
  1798             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1799                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1800
  1801     12  AM-CONTROL-BY-VAR-GRP.
  1802         16  AM-COMPANY-CD-A1              PIC X.
  1803         16  AM-VG-CARRIER                 PIC X.
  1804         16  AM-VG-GROUPING                PIC X(6).
  1805         16  AM-VG-STATE                   PIC XX.
  1806         16  AM-VG-ACCOUNT                 PIC X(10).
  1807         16  AM-VG-DATE.
  1808             20  AM-VG-EXPIRATION-DT       PIC XX.
  1809             20  FILLER                    PIC X(4).
  1810         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1811                                           PIC 9(11)      COMP-3.
  1812     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1813         16  FILLER                        PIC X(10).
  1814         16  AM-VG-KEY3.
  1815             20  AM-VG3-ACCOUNT            PIC X(10).
  1816             20  AM-VG3-EXP-DT             PIC XX.
  1817         16  FILLER                        PIC X(4).
  1818     12  AM-MAINT-INFORMATION.
  1819         16  AM-LAST-MAINT-DT              PIC XX.
  1820         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1821         16  AM-LAST-MAINT-USER            PIC X(4).
  1822         16  FILLER                        PIC XX.
  1823
  1824     12  AM-EFFECTIVE-DT                   PIC XX.
  1825     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1826
  1827     12  AM-PREV-DATES  COMP-3.
  1828         16  AM-PREV-EXP-DT                PIC 9(11).
  1829         16  AM-PREV-EFF-DT                PIC 9(11).
  1830
  1831     12  AM-REPORT-CODE-1                  PIC X(10).
  1832     12  AM-REPORT-CODE-2                  PIC X(10).
  1833
  1834     12  AM-CITY-CODE                      PIC X(4).
  1835     12  AM-COUNTY-PARISH                  PIC X(6).
  1836
  1837     12  AM-NAME                           PIC X(30).
  1838     12  AM-PERSON                         PIC X(30).
  1839     12  AM-ADDRS                          PIC X(30).
  1840     12  AM-CITY.
  1841         16  AM-ADDR-CITY                  PIC X(28).
  1842         16  AM-ADDR-STATE                 PIC XX.
  1843     12  AM-ZIP.
  1844         16  AM-ZIP-PRIME.
  1845             20  AM-ZIP-PRI-1ST            PIC X.
  1846                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1847             20  FILLER                    PIC X(4).
  1848         16  AM-ZIP-PLUS4                  PIC X(4).
  1849     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  41
* EL650.cbl
  1850         16  AM-CAN-POSTAL-1               PIC XXX.
  1851         16  AM-CAN-POSTAL-2               PIC XXX.
  1852         16  FILLER                        PIC XXX.
  1853     12  AM-TEL-NO.
  1854         16  AM-AREA-CODE                  PIC 999.
  1855         16  AM-TEL-PRE                    PIC 999.
  1856         16  AM-TEL-NBR                    PIC 9(4).
  1857     12  AM-TEL-LOC                        PIC X.
  1858         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1859         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1860
  1861     12  AM-COMM-STRUCTURE.
  1862         16  AM-DEFN-1.
  1863             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1864                 24  AM-AGT.
  1865                     28  AM-AGT-PREFIX     PIC X(4).
  1866                     28  AM-AGT-PRIME      PIC X(6).
  1867                 24  AM-COM-TYP            PIC X.
  1868                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1869                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1870                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1871                 24  AM-RECALC-LV-INDIC    PIC X.
  1872                 24  AM-RETRO-LV-INDIC     PIC X.
  1873                 24  AM-GL-CODES           PIC X.
  1874                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1875                 24  FILLER                PIC X(01).
  1876         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1877             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1878                 24  FILLER                PIC X(11).
  1879                 24  AM-L-COMA             PIC XXX.
  1880                 24  AM-J-COMA             PIC XXX.
  1881                 24  AM-A-COMA             PIC XXX.
  1882                 24  FILLER                PIC X(6).
  1883
  1884     12  AM-COMM-CHANGE-STATUS             PIC X.
  1885         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1886
  1887     12  AM-CSR-CODE                       PIC X(4).
  1888
  1889     12  AM-BILLING-STATUS                 PIC X.
  1890         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1891         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1892     12  AM-AUTO-REFUND-SW                 PIC X.
  1893         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1894         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1895     12  AM-GPCD                           PIC 99.
  1896     12  AM-IG                             PIC X.
  1897         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1898         88  AM-HAS-GROUP                     VALUE '2'.
  1899     12  AM-STATUS                         PIC X.
  1900         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1901         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1902         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1903         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1904         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1905         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  1906         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  1907         88  AM-ACCOUNT-LAPSED                VALUE '7'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  42
* EL650.cbl
  1908         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  1909         88  AM-ACCOUNT-PENDING               VALUE '9'.
  1910     12  AM-REMIT-TO                       PIC 99.
  1911     12  AM-ID-NO                          PIC X(11).
  1912
  1913     12  AM-CAL-TABLE                      PIC XX.
  1914     12  AM-LF-DEVIATION                   PIC XXX.
  1915     12  AM-AH-DEVIATION                   PIC XXX.
  1916     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1917     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1918     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1919     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1920     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1921     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1922
  1923     12  AM-USER-FIELDS.
  1924         16  AM-FLD-1                      PIC XX.
  1925         16  AM-FLD-2                      PIC XX.
  1926         16  AM-FLD-3                      PIC XX.
  1927         16  AM-FLD-4                      PIC XX.
  1928         16  AM-FLD-5                      PIC XX.
  1929
  1930     12  AM-1ST-PROD-DATE.
  1931         16  AM-1ST-PROD-YR                PIC XX.
  1932         16  AM-1ST-PROD-MO                PIC XX.
  1933         16  AM-1ST-PROD-DA                PIC XX.
  1934     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1935     12  AM-CERTS-PURGED-DATE.
  1936         16  AM-PUR-YR                     PIC XX.
  1937         16  AM-PUR-MO                     PIC XX.
  1938         16  AM-PUR-DA                     PIC XX.
  1939     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1940     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1941     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1942     12  AM-INACTIVE-DATE.
  1943         16  AM-INA-MO                     PIC 99.
  1944         16  AM-INA-DA                     PIC 99.
  1945         16  AM-INA-YR                     PIC 99.
  1946     12  AM-AR-HI-CERT-DATE                PIC XX.
  1947
  1948     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1949     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1950
  1951     12  AM-OB-PAYMENT-MODE                PIC X.
  1952         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1953         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1954         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1955         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1956
  1957     12  AM-AH-ONLY-INDICATOR              PIC X.
  1958         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1959         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1960
  1961     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1962
  1963     12  AM-OVER-SHORT.
  1964         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1965         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  43
* EL650.cbl
  1966
  1967     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1968     12  AM-DCC-CLP-STATE                  PIC XX.
  1969
  1970     12  AM-RECALC-COMM                    PIC X.
  1971     12  AM-RECALC-REIN                    PIC X.
  1972
  1973     12  AM-REI-TABLE                      PIC XXX.
  1974     12  AM-REI-ET-LF                      PIC X.
  1975     12  AM-REI-ET-AH                      PIC X.
  1976     12  AM-REI-PE-LF                      PIC X.
  1977     12  AM-REI-PE-AH                      PIC X.
  1978     12  AM-REI-PRT-ST                     PIC X.
  1979     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1980     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1981     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1982     12  AM-REI-GROUP-A                    PIC X(6).
  1983     12  AM-REI-MORT                       PIC X(4).
  1984     12  AM-REI-PRT-OW                     PIC X.
  1985     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1986     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1987     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1988     12  AM-REI-GROUP-B                    PIC X(6).
  1989
  1990     12  AM-TRUST-TYPE                     PIC X(2).
  1991
  1992     12  AM-EMPLOYER-STMT-USED             PIC X.
  1993     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1994
  1995     12  AM-STD-AH-TYPE                    PIC XX.
  1996     12  AM-EARN-METHODS.
  1997         16  AM-EARN-METHOD-R              PIC X.
  1998             88 AM-REF-RL-R78                 VALUE 'R'.
  1999             88 AM-REF-RL-PR                  VALUE 'P'.
  2000             88 AM-REF-RL-MEAN                VALUE 'M'.
  2001             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2002         16  AM-EARN-METHOD-L              PIC X.
  2003             88 AM-REF-LL-R78                 VALUE 'R'.
  2004             88 AM-REF-LL-PR                  VALUE 'P'.
  2005             88 AM-REF-LL-MEAN                VALUE 'M'.
  2006             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2007         16  AM-EARN-METHOD-A              PIC X.
  2008             88 AM-REF-AH-R78                 VALUE 'R'.
  2009             88 AM-REF-AH-PR                  VALUE 'P'.
  2010             88 AM-REF-AH-MEAN                VALUE 'M'.
  2011             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2012             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2013             88 AM-REF-AH-NET                 VALUE 'N'.
  2014
  2015     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2016     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2017     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2018
  2019     12  AM-RET-Y-N                        PIC X.
  2020     12  AM-RET-P-E                        PIC X.
  2021     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2022     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2023     12  AM-RET-GRP                        PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  44
* EL650.cbl
  2024     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2025         16  AM-POOL-PRIME                 PIC XXX.
  2026         16  AM-POOL-SUB                   PIC XXX.
  2027     12  AM-RETRO-EARNINGS.
  2028         16  AM-RET-EARN-R                 PIC X.
  2029         16  AM-RET-EARN-L                 PIC X.
  2030         16  AM-RET-EARN-A                 PIC X.
  2031     12  AM-RET-ST-TAX-USE                 PIC X.
  2032         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2033         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2034     12  AM-RETRO-BEG-EARNINGS.
  2035         16  AM-RET-BEG-EARN-R             PIC X.
  2036         16  AM-RET-BEG-EARN-L             PIC X.
  2037         16  AM-RET-BEG-EARN-A             PIC X.
  2038     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2039     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2040
  2041     12  AM-USER-SELECT-OPTIONS.
  2042         16  AM-USER-SELECT-1              PIC X(10).
  2043         16  AM-USER-SELECT-2              PIC X(10).
  2044         16  AM-USER-SELECT-3              PIC X(10).
  2045         16  AM-USER-SELECT-4              PIC X(10).
  2046         16  AM-USER-SELECT-5              PIC X(10).
  2047
  2048     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2049
  2050     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2051
  2052     12  AM-RPT045A-SWITCH                 PIC X.
  2053         88  RPT045A-OFF                   VALUE 'N'.
  2054
  2055     12  AM-INSURANCE-LIMITS.
  2056         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2057         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2058
  2059     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2060         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2061
  2062     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2063         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2064         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2065
  2066     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2067
  2068     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2069     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2070     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2071     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2072     12  AM-DCC-UEF-STATE                  PIC XX.
  2073     12  FILLER                            PIC XXX.
  2074     12  AM-REPORT-CODE-3                  PIC X(10).
  2075*    12  FILLER                            PIC X(22).
  2076
  2077     12  AM-RESERVE-DATE.
  2078         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2079         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2080         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2081
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  45
* EL650.cbl
  2082     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2083     12  AM-NOTIFICATION-TYPES.
  2084         16  AM-NOTIF-OF-LETTERS           PIC X.
  2085         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2086         16  AM-NOTIF-OF-REPORTS           PIC X.
  2087         16  AM-NOTIF-OF-STATUS            PIC X.
  2088
  2089     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2090         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2091         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2092         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2093         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2094
  2095     12  AM-BENEFIT-CONTROLS.
  2096         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2097             20  AM-BENEFIT-CODE           PIC XX.
  2098             20  AM-BENEFIT-TYPE           PIC X.
  2099             20  AM-BENEFIT-REVISION       PIC XXX.
  2100             20  AM-BENEFIT-REM-TERM       PIC X.
  2101             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2102             20  FILLER                    PIC XX.
  2103         16  FILLER                        PIC X(80).
  2104
  2105     12  AM-TRANSFER-DATA.
  2106         16  AM-TRANSFERRED-FROM.
  2107             20  AM-TRNFROM-CARRIER        PIC X.
  2108             20  AM-TRNFROM-GROUPING.
  2109                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2110                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2111             20  AM-TRNFROM-STATE          PIC XX.
  2112             20  AM-TRNFROM-ACCOUNT.
  2113                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2114                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2115             20  AM-TRNFROM-DTE            PIC XX.
  2116         16  AM-TRANSFERRED-TO.
  2117             20  AM-TRNTO-CARRIER          PIC X.
  2118             20  AM-TRNTO-GROUPING.
  2119                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2120                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2121             20  AM-TRNTO-STATE            PIC XX.
  2122             20  AM-TRNTO-ACCOUNT.
  2123                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2124                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2125             20  AM-TRNTO-DTE              PIC XX.
  2126         16  FILLER                        PIC X(10).
  2127
  2128     12  AM-SAVED-REMIT-TO                 PIC 99.
  2129
  2130     12  AM-COMM-STRUCTURE-SAVED.
  2131         16  AM-DEFN-1-SAVED.
  2132             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2133                 24  AM-AGT-SV             PIC X(10).
  2134                 24  AM-COM-TYP-SV         PIC X.
  2135                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2136                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2137                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2138                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2139                 24  FILLER                PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  46
* EL650.cbl
  2140                 24  AM-GL-CODES-SV        PIC X.
  2141                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2142                 24  FILLER                PIC X.
  2143         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2144             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2145                 24  FILLER                PIC X(11).
  2146                 24  AM-L-COMA-SV          PIC XXX.
  2147                 24  AM-J-COMA-SV          PIC XXX.
  2148                 24  AM-A-COMA-SV          PIC XXX.
  2149                 24  FILLER                PIC X(6).
  2150
  2151     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2152         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2153            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2154            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2155            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2156
  2157     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2158     12  FILLER                            PIC X(120).
  2159
  2160     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2161         16  AM-CONTROL-NAME               PIC X(30).
  2162         16  AM-EXECUTIVE-ONE.
  2163             20  AM-EXEC1-NAME             PIC X(15).
  2164             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2165                                                          COMP-3.
  2166             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2167                                                          COMP-3.
  2168         16  AM-EXECUTIVE-TWO.
  2169             20  AM-EXEC2-NAME             PIC X(15).
  2170             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2171                                                          COMP-3.
  2172             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2173                                                          COMP-3.
  2174
  2175     12  AM-RETRO-ADDITIONAL-DATA.
  2176         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2177         16  AM-RETRO-PREM-P-E             PIC X.
  2178         16  AM-RETRO-CLMS-P-I             PIC X.
  2179         16  AM-RETRO-RET-BRACKET-LF.
  2180             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2181                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2182                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2183             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2184                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2185                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2186             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2187                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2188                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2189         16  AM-RETRO-RET-BRACKET-AH.
  2190             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2191                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2192                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2193                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2194             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2195                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2196                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2197             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  47
* EL650.cbl
  2198                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2199                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2200
  2201     12  AM-COMMENTS.
  2202         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2203
  2204     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2205         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2206         16  AM-FLI-BILLING-CODE           PIC X.
  2207         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2208         16  AM-FLI-UNITED-IDENT           PIC X.
  2209         16  AM-FLI-INTEREST-LOST-DATA.
  2210             20  AM-FLI-BANK-NO            PIC X(5).
  2211             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2212             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2213             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2214         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2215             20  AM-FLI-AGT                PIC X(9).
  2216             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2217             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2218         16  FILLER                        PIC X(102).
  2219
  2220     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2221         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2222             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2223             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2224             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2225             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2226             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2227         16  FILLER                          PIC X(10).
  2228******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  48
* EL650.cbl
  2230*    COPY ERCCOMP.
  2231******************************************************************
  2232*                                                                *
  2233*                                                                *
  2234*                            ERCCOMP                             *
  2235*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2236*                            VMOD=2.019                          *
  2237*                                                                *
  2238*   ONLINE CREDIT SYSTEM                                         *
  2239*                                                                *
  2240*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2241*                                                                *
  2242*   FILE TYPE = VSAM,KSDS                                        *
  2243*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2244*                                                                *
  2245*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2246*       ALTERNATE PATH = NONE                                    *
  2247*                                                                *
  2248*   LOG = NO                                                     *
  2249*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2250*                                                                *
  2251******************************************************************
  2252*                   C H A N G E   L O G
  2253*
  2254* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2255*-----------------------------------------------------------------
  2256*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2257* EFFECTIVE    NUMBER
  2258*-----------------------------------------------------------------
  2259* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2260* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2261* 092205    2005050300006  PEMA  ADD LEASE FEE
  2262* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2263* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2264* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2265* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2266* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2267* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  2268******************************************************************
  2269
  2270 01  COMPENSATION-MASTER.
  2271     12  CO-RECORD-ID                          PIC XX.
  2272         88  VALID-CO-ID                          VALUE 'CO'.
  2273
  2274     12  CO-CONTROL-PRIMARY.
  2275         16  CO-COMPANY-CD                     PIC X.
  2276         16  CO-CONTROL.
  2277             20  CO-CTL-1.
  2278                 24  CO-CARR-GROUP.
  2279                     28  CO-CARRIER            PIC X.
  2280                     28  CO-GROUPING.
  2281                         32  CO-GROUP-PREFIX   PIC XXX.
  2282                         32  CO-GROUP-PRIME    PIC XXX.
  2283                 24  CO-RESP-NO.
  2284                     28  CO-RESP-PREFIX        PIC X(4).
  2285                     28  CO-RESP-PRIME         PIC X(6).
  2286             20  CO-CTL-2.
  2287                 24  CO-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  49
* EL650.cbl
  2288                     28  CO-ACCT-PREFIX        PIC X(4).
  2289                     28  CO-ACCT-PRIME         PIC X(6).
  2290         16  CO-TYPE                           PIC X.
  2291             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2292             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2293             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2294
  2295     12  CO-MAINT-INFORMATION.
  2296         16  CO-LAST-MAINT-DT                  PIC XX.
  2297         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2298         16  CO-LAST-MAINT-USER                PIC X(4).
  2299     12  FILLER                                PIC XX.
  2300     12  CO-STMT-TYPE                          PIC XXX.
  2301     12  CO-COMP-TYPE                          PIC X.
  2302         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2303     12  CO-STMT-OWNER                         PIC X(4).
  2304     12  CO-BALANCE-CONTROL                    PIC X.
  2305         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2306         88  CO-NO-BALANCE                        VALUE 'N'.
  2307
  2308     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2309         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2310         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2311         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2312
  2313     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2314         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2315         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2316
  2317     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2318     12  CO-GA-DIRECT-DEP                      PIC X.
  2319     12  CO-FUTURE-SPACE                       PIC X.
  2320         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2321
  2322     12  CO-ACCT-NAME                          PIC X(30).
  2323     12  CO-MAIL-NAME                          PIC X(30).
  2324     12  CO-ADDR-1                             PIC X(30).
  2325     12  CO-ADDR-2                             PIC X(30).
  2326     12  CO-ADDR-3.
  2327         16  CO-ADDR-CITY                      PIC X(27).
  2328         16  CO-ADDR-STATE                     PIC XX.
  2329     12  CO-CSO-1099                           PIC X.
  2330     12  CO-ZIP.
  2331         16  CO-ZIP-PRIME.
  2332             20  CO-ZIP-PRI-1ST                PIC X.
  2333                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2334             20  FILLER                        PIC X(4).
  2335         16  CO-ZIP-PLUS4                      PIC X(4).
  2336     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2337         16  CO-CAN-POSTAL-1                   PIC XXX.
  2338         16  CO-CAN-POSTAL-2                   PIC XXX.
  2339         16  FILLER                            PIC XXX.
  2340     12  CO-SOC-SEC                            PIC X(13).
  2341     12  CO-TELEPHONE.
  2342         16  CO-AREA-CODE                      PIC XXX.
  2343         16  CO-PREFIX                         PIC XXX.
  2344         16  CO-PHONE                          PIC X(4).
  2345
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  50
* EL650.cbl
  2346     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  2347
  2348     12  CO-AR-BAL-LEVEL                       PIC X.
  2349         88  CO-AR-REF-LVL                        VALUE '1'.
  2350         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2351         88  CO-AR-BILL-LVL                       VALUE '2'.
  2352         88  CO-AR-AGT-LVL                        VALUE '3'.
  2353         88  CO-AR-FR-LVL                         VALUE '4'.
  2354
  2355     12  CO-AR-NORMAL-PRINT                    PIC X.
  2356         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2357         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2358
  2359     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2360
  2361     12  CO-AR-REPORTING                       PIC X.
  2362         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2363         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2364
  2365     12  CO-AR-PULL-CHECK                      PIC X.
  2366         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2367         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2368
  2369     12  CO-AR-BALANCE-PRINT                   PIC X.
  2370         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2371
  2372     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2373         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2374         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2375         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2376
  2377     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2378
  2379     12  CO-USER-CODE                          PIC X.
  2380     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2381
  2382******************************************************************
  2383*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2384*    THE LAST MONTH END RUN.
  2385******************************************************************
  2386
  2387     12  CO-LAST-ACTIVITY-DATE.
  2388         16  CO-ACT-YEAR                       PIC 99.
  2389         16  CO-ACT-MONTH                      PIC 99.
  2390         16  CO-ACT-DAY                        PIC 99.
  2391
  2392     12  CO-LAST-STMT-DT.
  2393         16  CO-LAST-STMT-YEAR                 PIC 99.
  2394         16  CO-LAST-STMT-MONTH                PIC 99.
  2395         16  CO-LAST-STMT-DAY                  PIC 99.
  2396
  2397     12  CO-MO-END-TOTALS.
  2398         16  CO-MONTHLY-TOTALS.
  2399             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2400             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2401             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2402             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2403             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  51
* EL650.cbl
  2404
  2405         16  CO-AGING-TOTALS.
  2406             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2407             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2408             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2409             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2410
  2411         16  CO-YTD-TOTALS.
  2412             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2413             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2414
  2415         16  CO-OVER-UNDER-TOTALS.
  2416             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2417             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2418
  2419     12  CO-MISCELLANEOUS-TOTALS.
  2420         16  CO-FICA-TOTALS.
  2421             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2422             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2423
  2424         16  CO-CLAIM-TOTALS.
  2425             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2426             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2427
  2428******************************************************************
  2429*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2430*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2431******************************************************************
  2432
  2433     12  CO-CURRENT-TOTALS.
  2434         16  CO-CURRENT-LAST-STMT-DT.
  2435             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2436             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2437             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2438
  2439         16  CO-CURRENT-MONTHLY-TOTALS.
  2440             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2441             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2442             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2443             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2444             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2445
  2446         16  CO-CURRENT-AGING-TOTALS.
  2447             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2448             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2449             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2450             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2451
  2452         16  CO-CURRENT-YTD-TOTALS.
  2453             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2454             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2455
  2456     12  CO-PAID-COMM-TOTALS.
  2457         16  CO-YTD-PAID-COMMS.
  2458             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2459             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2460
  2461     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  52
* EL650.cbl
  2462         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  2463         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2464
  2465     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2466         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2467         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2468         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2469         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2470         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2471         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2472         88  CO-FINAL-LETTER                  VALUE 'F'.
  2473         88  CO-RECONCILING                   VALUE 'R'.
  2474         88  CO-PHONE-CALL                    VALUE 'P'.
  2475         88  CO-LEGAL                         VALUE 'L'.
  2476         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2477         88  CO-WRITE-OFF                     VALUE 'W'.
  2478         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2479
  2480     12  CO-CSR-CODE                       PIC X(4).
  2481
  2482     12  CO-GA-STATUS-INFO.
  2483         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2484         16  CO-GA-TERMINATION-DT          PIC XX.
  2485         16  CO-GA-STATUS-CODE             PIC X.
  2486             88  CO-GA-ACTIVE                 VALUE 'A'.
  2487             88  CO-GA-INACTIVE               VALUE 'I'.
  2488             88  CO-GA-PENDING                VALUE 'P'.
  2489         16  CO-GA-COMMENTS.
  2490             20  CO-GA-COMMENT-1           PIC X(40).
  2491             20  CO-GA-COMMENT-2           PIC X(40).
  2492             20  CO-GA-COMMENT-3           PIC X(40).
  2493             20  CO-GA-COMMENT-4           PIC X(40).
  2494
  2495     12  CO-RPTCD2                         PIC X(10).
  2496     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  2497         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  2498         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  2499
  2500     12  CO-TYPE-AGENT                     PIC X(01).
  2501         88  CO-CORPORATION                   VALUE 'C'.
  2502         88  CO-PARTNERSHIP                   VALUE 'P'.
  2503         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2504         88  CO-TRUST                         VALUE 'T'.
  2505         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2506
  2507     12  CO-FAXNO.
  2508         16  CO-FAX-AREA-CODE                  PIC XXX.
  2509         16  CO-FAX-PREFIX                     PIC XXX.
  2510         16  CO-FAX-PHONE                      PIC X(4).
  2511
  2512     12  CO-BANK-INFORMATION.
  2513         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2514         16  CO-BANK-TRANSIT-NON REDEFINES
  2515             CO-BANK-TRANSIT-NO                PIC 9(8).
  2516
  2517         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2518     12  CO-MISC-DEDUCT-INFO REDEFINES
  2519                  CO-BANK-INFORMATION.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  53
* EL650.cbl
  2520         16  CO-MD-GL-ACCT                     PIC X(10).
  2521         16  CO-MD-DIV                         PIC XX.
  2522         16  CO-MD-CENTER                      PIC X(4).
  2523         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  2524         16  CO-CREATE-AP-CHECK                PIC X.
  2525         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2526         16  FILLER                            PIC XXX.
  2527     12  CO-ACH-STATUS                         PIC X.
  2528         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2529         88  CO-ACH-PENDING                        VALUE 'P'.
  2530
  2531     12  CO-BILL-SW                            PIC X.
  2532     12  CO-CONTROL-NAME                       PIC X(30).
  2533     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2534     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2535     12  CO-CLP-STATE                          PIC XX.
  2536     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2537     12  CO-SPP-REFUND-EDIT                    PIC X.
  2538
  2539******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  54
* EL650.cbl
  2541*    COPY ERCNAME.
  2542******************************************************************
  2543*                                                                *
  2544*                                                                *
  2545*                            ERCNAME                             *
  2546*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2547*                            VMOD=2.003                          *
  2548*                                                                *
  2549*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  2550*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  2551*                                                                *
  2552*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  2553*                                                                *
  2554*   FILE TYPE = VSAM,KSDS                                        *
  2555*   RECORD SIZE = 160   RECFORM = FIX                            *
  2556*                                                                *
  2557*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  2558*                                                                *
  2559*   LOG = NO                                                     *
  2560*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2561*                                                                *
  2562*                                                                *
  2563******************************************************************
  2564
  2565 01  NAME-LOOKUP-MASTER.
  2566     12  NL-RECORD-ID                PIC  X(02).
  2567         88  VALID-NL-ID                         VALUE 'NL'.
  2568
  2569     12  NL-RECORD-KEY.
  2570         16  NL-CONTROL-PRIMARY.
  2571             20  NL-COMPANY-CD       PIC  X(01).
  2572             20  NL-NAME             PIC  X(30).
  2573             20  NL-RECORD-TYPE      PIC  X(01).
  2574                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  2575                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  2576                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  2577
  2578         16  NL-ACCOUNT-MASTER.
  2579             20  NL-AM-COMPANY-CD    PIC  X(01).
  2580             20  NL-AM-CARRIER       PIC  X(01).
  2581             20  NL-AM-GROUPING      PIC  X(06).
  2582             20  NL-AM-STATE         PIC  X(02).
  2583             20  NL-AM-ACCOUNT       PIC  X(10).
  2584             20  FILLER              PIC  X(09).
  2585
  2586         16  NL-COMPENSATION-MASTER
  2587                                 REDEFINES  NL-ACCOUNT-MASTER.
  2588             20  NL-CO-COMPANY-CD    PIC  X(01).
  2589             20  NL-CO-CARRIER       PIC  X(01).
  2590             20  NL-CO-GROUPING      PIC  X(06).
  2591             20  NL-CO-RESP-NO       PIC  X(10).
  2592             20  NL-CO-ACCOUNT       PIC  X(10).
  2593             20  NL-CO-TYPE          PIC  X(01).
  2594
  2595         16  NL-REINSURANCE-RECORD
  2596                                 REDEFINES  NL-ACCOUNT-MASTER.
  2597             20  NL-RE-COMPANY-CD    PIC  X(01).
  2598             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  55
* EL650.cbl
  2599             20  NL-RE-COMPANY.
  2600                 24  NL-RE-COMP      PIC  X(03).
  2601                 24  NL-RE-CO-SUB    PIC  X(03).
  2602             20  NL-RE-TABLE         PIC  X(03).
  2603             20  FILLER              PIC  X(18).
  2604
  2605     12  NL-MAINT-INFORMATION.
  2606         16  NL-LAST-MAINT-DT        PIC  X(02).
  2607         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  2608         16  NL-LAST-MAINT-USER      PIC  X(04).
  2609         16  FILLER                  PIC  X(10).
  2610
  2611     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  2612         16  NL-RE-LEVEL             PIC  9(02).
  2613
  2614     12  NL-CITY                     PIC  X(15).
  2615     12  NL-ST                       PIC  XX.
  2616
  2617******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  56
* EL650.cbl
  2619*    COPY ERCPLAN.
  2620******************************************************************
  2621*                                                                *
  2622*                                                                *
  2623*                            ERCPLAN                             *
  2624*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2625*                            VMOD=2.003                          *
  2626*                                                                *
  2627*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2628*                                                                *
  2629*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2630*   PLAN MASTER                                                  *
  2631*                                                                *
  2632*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2633*                                                                *
  2634*   FILE TYPE = VSAM,KSDS                                        *
  2635*   RECORD SIZE = 420   RECFORM = FIX                            *
  2636*                                                                *
  2637*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2638*       ALTERNATE PATH1 = N/A                                    *
  2639*                                                                *
  2640*   LOG = NO                                                     *
  2641*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2642*                                                                *
  2643*                                                                *
  2644******************************************************************
  2645
  2646 01  PLAN-MASTER.
  2647     12  PL-RECORD-ID                      PIC XX.
  2648         88  VALID-PL-ID                      VALUE 'PL'.
  2649
  2650     12  PL-CONTROL-PRIMARY.
  2651         16  PL-COMPANY-CD                 PIC X.
  2652         16  PL-MSTR-CNTRL.
  2653             20  PL-CONTROL-A.
  2654                 24  PL-CARRIER            PIC X.
  2655                 24  PL-GROUPING           PIC X(6).
  2656                 24  PL-STATE              PIC XX.
  2657                 24  PL-ACCOUNT            PIC X(10).
  2658             20  PL-BENEFIT-TYPE           PIC X.
  2659             20  PL-BENEFIT-CODE           PIC XX.
  2660             20  PL-REVISION-NO            PIC X(3).
  2661
  2662     12  PL-CONTROL-BY-VAR-GRP.
  2663         16  PL-COMPANY-CD-A1              PIC X.
  2664         16  PL-VG-CARRIER                 PIC X.
  2665         16  PL-VG-GROUPING                PIC X(6).
  2666         16  PL-VG-STATE                   PIC XX.
  2667         16  PL-VG-ACCOUNT                 PIC X(10).
  2668         16  PL-BENEFIT-TYPE-A1            PIC X.
  2669         16  PL-BENEFIT-CODE-A1            PIC XX.
  2670         16  PL-REVISION-NO-A1             PIC 999.
  2671
  2672     12  PL-MAINT-INFORMATION.
  2673         16  PL-LAST-MAINT-DT              PIC XX.
  2674         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2675         16  PL-LAST-MAINT-USER            PIC X(4).
  2676         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  57
* EL650.cbl
  2677
  2678     12  PL-LIABILITY-LIMITS.
  2679         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2680         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2681             20  PL-LM-AGE                 PIC S99        COMP-3.
  2682             20  PL-LM-DUR                 PIC S999       COMP-3.
  2683             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2684             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2685
  2686     12  FILLER                            PIC X(30).
  2687
  2688     12  PL-GL-ACCOUNT-NOS.
  2689         16  PL-PREMIUM-GL                 PIC X(8).
  2690         16  PL-COMM-GL                    PIC X(8).
  2691         16  PL-CLAIM-GL                   PIC X(8).
  2692     12  FILLER                            PIC X(24).
  2693     12  PL-TOLERANCES.
  2694         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2695         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2696         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2697         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2698         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2699         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2700     12  PL-OVER-SHORT.
  2701         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2702         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2703     12  FILLER                            PIC X(24).
  2704     12  PLAN-MISC.
  2705         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2706         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2707         16  PL-IG                         PIC X.
  2708         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2709         16  PL-POLICY-FORM                PIC X(12).
  2710         16  PL-EDIT-FOR-FORM              PIC X(01).
  2711         16  PL-DEV-CODE                   PIC XXX.
  2712         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2713         16  PL-CALC-METHOD                PIC X.
  2714         16  PL-BENEFIT-GROUP              PIC X(05).
  2715         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2716
  2717         16  FILLER                        PIC X(99).
  2718******************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  58
* EL650.cbl
  2720*    COPY ELCCNTL.
  2721******************************************************************
  2722*                                                                *
  2723*                                                                *
  2724*                            ELCCNTL.                            *
  2725*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2726*                            VMOD=2.059                          *
  2727*                                                                *
  2728*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2729*                                                                *
  2730*   FILE TYPE = VSAM,KSDS                                        *
  2731*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2732*                                                                *
  2733*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2734*       ALTERNATE INDEX = NONE                                   *
  2735*                                                                *
  2736*   LOG = YES                                                    *
  2737*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2738******************************************************************
  2739*                   C H A N G E   L O G
  2740*
  2741* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2742*-----------------------------------------------------------------
  2743*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2744* EFFECTIVE    NUMBER
  2745*-----------------------------------------------------------------
  2746* 082503                   PEMA  ADD BENEFIT GROUP
  2747* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2748* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2749* 092705    2005050300006  PEMA  ADD SPP LEASES
  2750* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2751* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2752* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2753* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2754* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2755* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2756* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2757* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2758* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2759* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2760******************************************************************
  2761*
  2762 01  CONTROL-FILE.
  2763     12  CF-RECORD-ID                       PIC XX.
  2764         88  VALID-CF-ID                        VALUE 'CF'.
  2765
  2766     12  CF-CONTROL-PRIMARY.
  2767         16  CF-COMPANY-ID                  PIC XXX.
  2768         16  CF-RECORD-TYPE                 PIC X.
  2769             88  CF-COMPANY-MASTER              VALUE '1'.
  2770             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2771             88  CF-STATE-MASTER                VALUE '3'.
  2772             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2773             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2774             88  CF-CARRIER-MASTER              VALUE '6'.
  2775             88  CF-MORTALITY-MASTER            VALUE '7'.
  2776             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2777             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  59
* EL650.cbl
  2778             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2779             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2780             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2781             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2782             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2783             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2784             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2785             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2786             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2787         16  CF-ACCESS-CD-GENL              PIC X(4).
  2788         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2789             20  CF-PROCESSOR               PIC X(4).
  2790         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2791             20  CF-STATE-CODE              PIC XX.
  2792             20  FILLER                     PIC XX.
  2793         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2794             20  FILLER                     PIC XX.
  2795             20  CF-HI-BEN-IN-REC           PIC XX.
  2796         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2797             20  FILLER                     PIC XXX.
  2798             20  CF-CARRIER-CNTL            PIC X.
  2799         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2800             20  FILLER                     PIC XX.
  2801             20  CF-HI-TYPE-IN-REC          PIC 99.
  2802         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2803             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2804                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2805             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2806             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2807         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2808             20  FILLER                     PIC X.
  2809             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2810         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2811             20  FILLER                     PIC XX.
  2812             20  CF-MORTGAGE-PLAN           PIC XX.
  2813         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2814
  2815     12  CF-LAST-MAINT-DT                   PIC XX.
  2816     12  CF-LAST-MAINT-BY                   PIC X(4).
  2817     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2818
  2819     12  CF-RECORD-BODY                     PIC X(728).
  2820
  2821
  2822****************************************************************
  2823*             COMPANY MASTER RECORD                            *
  2824****************************************************************
  2825
  2826     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2827         16  CF-COMPANY-ADDRESS.
  2828             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2829             20  CF-CL-IN-CARE-OF           PIC X(30).
  2830             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2831             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2832             20  CF-CL-CITY-STATE           PIC X(30).
  2833             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2834             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2835         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  60
* EL650.cbl
  2836         16  CF-COMPANY-PASSWORD            PIC X(8).
  2837         16  CF-SECURITY-OPTION             PIC X.
  2838             88  ALL-SECURITY                   VALUE '1'.
  2839             88  COMPANY-VERIFY                 VALUE '2'.
  2840             88  PROCESSOR-VERIFY               VALUE '3'.
  2841             88  NO-SECURITY                    VALUE '4'.
  2842             88  ALL-BUT-TERM                   VALUE '5'.
  2843         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2844             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2845         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2846             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2847         16  CF-INFORCE-LOCATION            PIC X.
  2848             88  CERTS-ARE-ONLINE               VALUE '1'.
  2849             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2850             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2851         16  CF-LOWER-CASE-LETTERS          PIC X.
  2852         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2853             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2854             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2855             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2856             88  CF-ACCNT-CNTL                  VALUE '3'.
  2857             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2858
  2859         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2860         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2861
  2862         16  CF-LGX-CREDIT-USER             PIC X.
  2863             88  CO-IS-NOT-USER                 VALUE 'N'.
  2864             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2865
  2866         16 CF-CREDIT-CALC-CODES.
  2867             20  CF-CR-REM-TERM-CALC PIC X.
  2868               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2869               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2870               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2871               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2872               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2873               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2874               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2875             20  CF-CR-R78-METHOD           PIC X.
  2876               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2877               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2878
  2879         16  CF-CLAIM-CONTROL-COUNTS.
  2880             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2881                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2882
  2883             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2884                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2885
  2886             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2887                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2888
  2889             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2890                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2891
  2892         16  CF-CURRENT-MONTH-END           PIC XX.
  2893
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  61
* EL650.cbl
  2894         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2895             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2896             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2897             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2898             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2899                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2900                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2901             20  CF-CO-PREM-REJECT-SW       PIC X.
  2902                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2903                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2904             20  CF-CO-REF-REJECT-SW        PIC X.
  2905                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2906                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2907
  2908         16  CF-CO-REPORTING-DT             PIC XX.
  2909         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2910         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2911           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2912           88  CF-CO-MONTH-END                  VALUE '1'.
  2913
  2914         16  CF-LGX-CLAIM-USER              PIC X.
  2915             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2916             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2917
  2918         16  CF-CREDIT-EDIT-CONTROLS.
  2919             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2920             20  CF-MIN-AGE                 PIC 99.
  2921             20  CF-DEFAULT-AGE             PIC 99.
  2922             20  CF-MIN-TERM                PIC S999      COMP-3.
  2923             20  CF-MAX-TERM                PIC S999      COMP-3.
  2924             20  CF-DEFAULT-SEX             PIC X.
  2925             20  CF-JOINT-AGE-INPUT         PIC X.
  2926                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2927             20  CF-BIRTH-DATE-INPUT        PIC X.
  2928                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2929             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2930                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2931                 88  CF-ZERO-CARRIER            VALUE '1'.
  2932                 88  CF-ZERO-GROUPING           VALUE '2'.
  2933                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2934             20  CF-EDIT-SW                 PIC X.
  2935                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2936             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2937             20  CF-CR-PR-METHOD            PIC X.
  2938               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2939               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2940             20  FILLER                     PIC X.
  2941
  2942         16  CF-CREDIT-MISC-CONTROLS.
  2943             20  CF-REIN-TABLE-SW           PIC X.
  2944                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2945             20  CF-COMP-TABLE-SW           PIC X.
  2946                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2947             20  CF-EXPERIENCE-RETENTION-AGE
  2948                                            PIC S9        COMP-3.
  2949             20  CF-CONVERSION-DT           PIC XX.
  2950             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2951             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  62
* EL650.cbl
  2952                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2953                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2954
  2955             20  CF-CR-CHECK-NO-CONTROL.
  2956                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2957                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2958                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2959                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2960                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2961                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2962
  2963                 24  CF-CR-CHECK-COUNT       REDEFINES
  2964                     CF-CR-CHECK-COUNTER      PIC X(4).
  2965
  2966                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2967                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2968
  2969                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2970                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2971                 24  CF-MAIL-PROCESSING       PIC X.
  2972                     88  MAIL-PROCESSING          VALUE 'Y'.
  2973
  2974         16  CF-MISC-SYSTEM-CONTROL.
  2975             20  CF-SYSTEM-C                 PIC X.
  2976                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2977             20  CF-SYSTEM-D                 PIC X.
  2978                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2979             20  CF-SOC-SEC-NO-SW            PIC X.
  2980                 88  SOC-SEC-NO-USED             VALUE '1'.
  2981             20  CF-MEMBER-NO-SW             PIC X.
  2982                 88  MEMBER-NO-USED              VALUE '1'.
  2983             20  CF-TAX-ID-NUMBER            PIC X(11).
  2984             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2985             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2986                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2987                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2988                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2989                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2990             20  CF-SYSTEM-E                 PIC X.
  2991                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2992
  2993         16  CF-LGX-LIFE-USER               PIC X.
  2994             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2995             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2996
  2997         16  CF-CR-MONTH-END-DT             PIC XX.
  2998
  2999         16  CF-FILE-MAINT-DATES.
  3000             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3001                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3002             20  CF-LAST-BATCH       REDEFINES
  3003                 CF-LAST-BATCH-NO               PIC X(4).
  3004             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3005             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3006             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3007             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3008             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3009             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  63
* EL650.cbl
  3010             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3011             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3012             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3013             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3014
  3015         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3016         16  FILLER                         PIC X.
  3017
  3018         16  CF-ALT-MORT-CODE               PIC X(4).
  3019         16  CF-MEMBER-CAPTION              PIC X(10).
  3020
  3021         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3022             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3023             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3024             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3025             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3026             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3027
  3028         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3029
  3030         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3031         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3032         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3033         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3034
  3035         16  CF-AH-OVERRIDE-L1              PIC X.
  3036         16  CF-AH-OVERRIDE-L2              PIC XX.
  3037         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3038         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3039
  3040         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3041         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3042
  3043         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3044         16  CF-AR-LAST-EL860-DT            PIC XX.
  3045         16  CF-MP-MONTH-END-DT             PIC XX.
  3046
  3047         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3048         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3049             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3050
  3051         16  CF-AR-MONTH-END-DT             PIC XX.
  3052
  3053         16  CF-CRDTCRD-USER                PIC X.
  3054             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3055             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3056
  3057         16  CF-CC-MONTH-END-DT             PIC XX.
  3058
  3059         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3060
  3061         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3062             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3063             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3064             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3065         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3066         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3067         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  64
* EL650.cbl
  3068         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3069             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3070             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3071         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3072         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3073         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3074             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3075         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3076
  3077         16  CF-CL-ZIP-CODE.
  3078             20  CF-CL-ZIP-PRIME.
  3079                 24  CF-CL-ZIP-1ST          PIC X.
  3080                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3081                 24  FILLER                 PIC X(4).
  3082             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3083         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3084             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3085             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3086             20  FILLER                     PIC XXX.
  3087
  3088         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3089         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3090         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3091         16  CF-CO-OPTION-START-DATE        PIC XX.
  3092         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3093           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3094                                                      '3' '4'.
  3095           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3096           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3097           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3098           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3099           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3100           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3101
  3102         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3103
  3104         16  CF-PAYMENT-APPROVAL-LEVELS.
  3105             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3106             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3107             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3108             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3109             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3110             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3111
  3112         16  CF-END-USER-REPORTING-USER     PIC X.
  3113             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3114             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3115
  3116         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3117             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3118             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3119
  3120         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3121
  3122         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3123         16  FILLER                         PIC X.
  3124
  3125         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  65
* EL650.cbl
  3126             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3127             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3128             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3129
  3130         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3131
  3132         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3133             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3134             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3135
  3136         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3137             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3138             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3139
  3140         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3141
  3142         16  CF-CO-ACH-ID-CODE              PIC  X.
  3143             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3144             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3145             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3146         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3147         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3148         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3149         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3150         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3151         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3152         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3153         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3154         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3155                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3156         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3157                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3158
  3159         16  CF-CO-OVER-SHORT.
  3160             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3161             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3162
  3163*         16  FILLER                         PIC X(102).
  3164         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3165             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3166             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3167
  3168         16  CF-AH-APPROVAL-DAYS.
  3169             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3170             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3171             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3172             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3173
  3174         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3175
  3176         16  CF-APPROV-LEV-5.
  3177             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3178             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3179             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3180
  3181         16  FILLER                         PIC X(68).
  3182****************************************************************
  3183*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  66
* EL650.cbl
  3184****************************************************************
  3185
  3186     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3187         16  CF-PROCESSOR-NAME              PIC X(30).
  3188         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3189         16  CF-PROCESSOR-TITLE             PIC X(26).
  3190         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3191                 88  MESSAGE-YES                VALUE 'Y'.
  3192                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3193
  3194*****************************************************
  3195****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3196****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3197****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3198****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3199*****************************************************
  3200
  3201         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3202             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3203             20  CF-APPLICATION-FORCE       PIC X.
  3204             20  CF-INDIVIDUAL-APP.
  3205                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3206                     28  CF-BROWSE-APP      PIC X.
  3207                     28  CF-UPDATE-APP      PIC X.
  3208
  3209         16  CF-CURRENT-TERM-ON             PIC X(4).
  3210         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3211             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3212             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3213             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3214             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3215             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3216             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3217             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3218         16  CF-PROCESSOR-CARRIER           PIC X.
  3219             88  NO-CARRIER-SECURITY            VALUE ' '.
  3220         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3221             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3222         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3223             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3224         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3225             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3226
  3227         16  CF-PROC-SYS-ACCESS-SW.
  3228             20  CF-PROC-CREDIT-CLAIMS-SW.
  3229                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3230                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3231                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3232                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3233             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3234                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3235                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3236             20  CF-PROC-LIFE-GNRLDGR-SW.
  3237                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3238                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3239                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3240                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3241             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  67
* EL650.cbl
  3242                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3243                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3244         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3245             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3246             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3247         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3248
  3249         16  CF-APPROVAL-LEVEL                  PIC X.
  3250             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3251             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3252             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3253             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3254             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3255
  3256         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3257
  3258         16  CF-LANGUAGE-TYPE                   PIC X.
  3259             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3260             88  CF-LANG-IS-FR                      VALUE 'F'.
  3261
  3262         16  CF-CSR-IND                         PIC X.
  3263         16  FILLER                             PIC X(239).
  3264
  3265****************************************************************
  3266*             PROCESSOR/REMINDERS RECORD                       *
  3267****************************************************************
  3268
  3269     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3270         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3271             20  CF-START-REMIND-DT         PIC XX.
  3272             20  CF-END-REMIND-DT           PIC XX.
  3273             20  CF-REMINDER-TEXT           PIC X(50).
  3274         16  FILLER                         PIC X(296).
  3275
  3276
  3277****************************************************************
  3278*             STATE MASTER RECORD                              *
  3279****************************************************************
  3280
  3281     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3282         16  CF-STATE-ABBREVIATION          PIC XX.
  3283         16  CF-STATE-NAME                  PIC X(25).
  3284         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3285         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3286             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3287             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3288             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3289             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3290                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3291                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3292             20  CF-ST-PREM-REJECT-SW       PIC X.
  3293                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3294                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3295             20  CF-ST-REF-REJECT-SW        PIC X.
  3296                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3297                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3298         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3299         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  68
* EL650.cbl
  3300         16  CF-ST-REFUND-RULES.
  3301             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3302             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3303             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3304         16  CF-ST-FST-PMT-EXTENSION.
  3305             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3306             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3307                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3308                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3309                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3310                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3311         16  CF-ST-STATE-CALL.
  3312             20  CF-ST-CALL-UNEARNED        PIC X.
  3313             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3314             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3315         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3316             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3317             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3318         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3319         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3320         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3321         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3322         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3323         16  FILLER                         PIC X.
  3324         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3325             20  CF-ST-BENEFIT-CD           PIC XX.
  3326             20  CF-ST-BENEFIT-KIND         PIC X.
  3327                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3328                 88  CF-ST-AH-KIND              VALUE 'A'.
  3329             20  CF-ST-REM-TERM-CALC        PIC X.
  3330                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3331                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3332                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3333                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3334                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3335                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3336                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3337                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3338
  3339             20  CF-ST-REFUND-CALC          PIC X.
  3340                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3341                 88  ST-REFD-BY-R78             VALUE '1'.
  3342                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3343                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3344                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3345                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3346                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3347                 88  ST-REFD-UTAH               VALUE '7'.
  3348                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3349                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3350                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3351
  3352             20  CF-ST-EARNING-CALC         PIC X.
  3353                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3354                 88  ST-EARN-BY-R78             VALUE '1'.
  3355                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3356                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3357                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  69
* EL650.cbl
  3358                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3359                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3360                 88  ST-EARN-MEAN               VALUE '8'.
  3361                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3362
  3363             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3364                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3365                 88  ST-OVRD-BY-R78             VALUE '1'.
  3366                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3367                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3368                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3369                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3370                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3371                 88  ST-OVRD-MEAN               VALUE '8'.
  3372                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3373             20  cf-st-extra-periods        pic 9.
  3374*            20  FILLER                     PIC X.
  3375
  3376         16  CF-ST-COMMISSION-CAPS.
  3377             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3378             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3379             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3380             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3381         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3382                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3383
  3384         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3385
  3386         16  CF-ST-STATUTORY-INTEREST.
  3387             20  CF-ST-STAT-DATE-FROM       PIC X.
  3388                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3389                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3390             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3391             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3392             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3393             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3394             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3395
  3396         16  CF-ST-OVER-SHORT.
  3397             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3398             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3399
  3400         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3401
  3402         16  CF-ST-RT-CALC                  PIC X.
  3403
  3404         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3405         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3406         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3407         16  CF-ST-RF-LR-CALC               PIC X.
  3408         16  CF-ST-RF-LL-CALC               PIC X.
  3409         16  CF-ST-RF-LN-CALC               PIC X.
  3410         16  CF-ST-RF-AH-CALC               PIC X.
  3411         16  CF-ST-RF-CP-CALC               PIC X.
  3412*        16  FILLER                         PIC X(206).
  3413*CIDMOD         16  FILLER                         PIC X(192).
  3414         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3415             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  70
* EL650.cbl
  3416         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3417         16  CF-ST-VFY-2ND-BENE             PIC X.
  3418         16  CF-ST-CAUSAL-STATE             PIC X.
  3419         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3420         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3421         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3422             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3423         16  CF-ST-NET-ONLY-STATE           PIC X.
  3424             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3425         16  FILLER                         PIC X(181).
  3426
  3427****************************************************************
  3428*             BENEFIT MASTER RECORD                            *
  3429****************************************************************
  3430
  3431     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3432         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3433             20  CF-BENEFIT-CODE            PIC XX.
  3434             20  CF-BENEFIT-NUMERIC  REDEFINES
  3435                 CF-BENEFIT-CODE            PIC XX.
  3436             20  CF-BENEFIT-ALPHA           PIC XXX.
  3437             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3438             20  CF-BENEFIT-COMMENT         PIC X(10).
  3439
  3440             20  CF-LF-COVERAGE-TYPE        PIC X.
  3441                 88  CF-REDUCING                VALUE 'R'.
  3442                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3443
  3444             20  CF-SPECIAL-CALC-CD         PIC X.
  3445                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3446                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3447                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3448                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3449                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3450                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3451                 88  CF-FARM-PLAN               VALUE 'F'.
  3452                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3453                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3454                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3455                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3456                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3457                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3458                 88  CF-PRUDENTIAL              VALUE 'P'.
  3459                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3460                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3461                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3462                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3463                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3464                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3465
  3466             20  CF-JOINT-INDICATOR         PIC X.
  3467                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3468
  3469*            20  FILLER                     PIC X(12).
  3470             20  cf-maximum-benefits        pic s999 comp-3.
  3471             20  FILLER                     PIC X(09).
  3472             20  CF-BENEFIT-CATEGORY        PIC X.
  3473             20  CF-LOAN-TYPE               PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  71
* EL650.cbl
  3474
  3475             20  CF-CO-REM-TERM-CALC        PIC X.
  3476                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3477                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3478                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3479                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3480                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3481
  3482             20  CF-CO-EARNINGS-CALC        PIC X.
  3483                 88  CO-EARN-BY-R78             VALUE '1'.
  3484                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3485                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3486                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3487                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3488                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3489                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3490                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3491
  3492             20  CF-CO-REFUND-CALC          PIC X.
  3493                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3494                 88  CO-REFD-BY-R78             VALUE '1'.
  3495                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3496                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3497                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3498                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3499                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3500                 88  CO-REFD-MEAN               VALUE '8'.
  3501                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3502                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3503                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3504
  3505             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3506                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3507                 88  CO-OVRD-BY-R78             VALUE '1'.
  3508                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3509                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3510                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3511                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3512                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3513                 88  CO-OVRD-MEAN               VALUE '8'.
  3514                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3515
  3516             20  CF-CO-BEN-I-G-CD           PIC X.
  3517                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3518                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3519                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3520
  3521         16  FILLER                         PIC X(304).
  3522
  3523
  3524****************************************************************
  3525*             CARRIER MASTER RECORD                            *
  3526****************************************************************
  3527
  3528     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3529         16  CF-ADDRESS-DATA.
  3530             20  CF-MAIL-TO-NAME            PIC X(30).
  3531             20  CF-IN-CARE-OF              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  72
* EL650.cbl
  3532             20  CF-ADDRESS-LINE-1          PIC X(30).
  3533             20  CF-ADDRESS-LINE-2          PIC X(30).
  3534             20  CF-CITY-STATE              PIC X(30).
  3535             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3536             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3537
  3538         16  CF-CLAIM-NO-CONTROL.
  3539             20  CF-CLAIM-NO-METHOD         PIC X.
  3540                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3541                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3542                 88  CLAIM-NO-SEQ               VALUE '3'.
  3543                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3544             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3545                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3546                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3547                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3548
  3549         16  CF-CHECK-NO-CONTROL.
  3550             20  CF-CHECK-NO-METHOD         PIC X.
  3551                 88  CHECK-NO-MANUAL            VALUE '1'.
  3552                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3553                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3554                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3555             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3556                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3557
  3558         16  CF-DOMICILE-STATE              PIC XX.
  3559
  3560         16  CF-EXPENSE-CONTROLS.
  3561             20  CF-EXPENSE-METHOD          PIC X.
  3562                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3563                 88  DOLLARS-PER-PMT            VALUE '2'.
  3564                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3565                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3566             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3567             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3568
  3569         16  CF-CORRESPONDENCE-CONTROL.
  3570             20  CF-LETTER-RESEND-OPT       PIC X.
  3571                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3572                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3573             20  FILLER                     PIC X(4).
  3574
  3575         16  CF-RESERVE-CONTROLS.
  3576             20  CF-MANUAL-SW               PIC X.
  3577                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3578             20  CF-FUTURE-SW               PIC X.
  3579                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3580             20  CF-PTC-SW                  PIC X.
  3581                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3582             20  CF-IBNR-SW                 PIC X.
  3583                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3584             20  CF-PTC-LF-SW               PIC X.
  3585                 88  CF-LF-PTC-USED             VALUE '1'.
  3586             20  CF-CDT-ACCESS-METHOD       PIC X.
  3587                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3588                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3589                 88  CF-CDT-INTERPOLATED        VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  73
* EL650.cbl
  3590             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3591
  3592         16  CF-CLAIM-CALC-METHOD           PIC X.
  3593             88  360-PLUS-MONTHS                VALUE '1'.
  3594             88  365-PLUS-MONTHS                VALUE '2'.
  3595             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3596             88  360-DAILY                      VALUE '4'.
  3597             88  365-DAILY                      VALUE '5'.
  3598
  3599         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3600         16  FILLER                         PIC X(11).
  3601
  3602         16  CF-LIMIT-AMOUNTS.
  3603             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3604             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3605             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3606             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3607             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3608             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3609             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3610             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3611             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3612             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3613
  3614         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3615         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3616         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3617
  3618         16  CF-ZIP-CODE.
  3619             20  CF-ZIP-PRIME.
  3620                 24  CF-ZIP-1ST             PIC X.
  3621                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3622                 24  FILLER                 PIC X(4).
  3623             20  CF-ZIP-PLUS4               PIC X(4).
  3624         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3625             20  CF-CAN-POSTAL-1            PIC XXX.
  3626             20  CF-CAN-POSTAL-2            PIC XXX.
  3627             20  FILLER                     PIC XXX.
  3628
  3629         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3630         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3631         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3632
  3633         16  CF-RATING-SWITCH               PIC X.
  3634             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3635             88  CF-NO-RATING                   VALUE 'N'.
  3636
  3637         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3638
  3639         16  CF-CARRIER-OVER-SHORT.
  3640             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3641             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3642
  3643         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3644         16  CF-SECPAY-SWITCH               PIC X.
  3645             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3646             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3647         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  74
* EL650.cbl
  3648         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3649         16  FILLER                         PIC X(444).
  3650*        16  FILLER                         PIC X(452).
  3651
  3652
  3653****************************************************************
  3654*             MORTALITY MASTER RECORD                          *
  3655****************************************************************
  3656
  3657     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3658         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3659                                INDEXED BY CF-MORT-NDX.
  3660             20  CF-MORT-TABLE              PIC X(5).
  3661             20  CF-MORT-TABLE-TYPE         PIC X.
  3662                 88  CF-MORT-JOINT              VALUE 'J'.
  3663                 88  CF-MORT-SINGLE             VALUE 'S'.
  3664                 88  CF-MORT-COMBINED           VALUE 'C'.
  3665                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3666                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3667             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3668             20  CF-MORT-AGE-METHOD         PIC XX.
  3669                 88  CF-AGE-LAST                VALUE 'AL'.
  3670                 88  CF-AGE-NEAR                VALUE 'AN'.
  3671             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3672             20  CF-MORT-ADJUSTMENT-DIRECTION
  3673                                            PIC X.
  3674                 88  CF-MINUS                   VALUE '-'.
  3675                 88  CF-PLUS                    VALUE '+'.
  3676             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3677             20  CF-MORT-JOINT-CODE         PIC X.
  3678                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3679             20  CF-MORT-PC-Q               PIC X.
  3680                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3681             20  CF-MORT-TABLE-CODE         PIC X(4).
  3682             20  CF-MORT-COMMENTS           PIC X(15).
  3683             20  FILLER                     PIC X(14).
  3684
  3685         16  FILLER                         PIC X(251).
  3686
  3687
  3688****************************************************************
  3689*             BUSSINESS TYPE MASTER RECORD                     *
  3690****************************************************************
  3691
  3692     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3693* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3694* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3695* AND RECORD 05 IS TYPES 81-99
  3696         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3697             20  CF-BUSINESS-TITLE          PIC  X(19).
  3698             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3699                                            PIC S9V9(4) COMP-3.
  3700             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3701             20  FILLER                     PIC  X.
  3702         16  FILLER                         PIC  X(248).
  3703
  3704
  3705****************************************************************
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  75
* EL650.cbl
  3706*             TERMINAL MASTER RECORD                           *
  3707****************************************************************
  3708
  3709     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3710
  3711         16  CF-COMPANY-TERMINALS.
  3712             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3713                                  PIC X(4).
  3714         16  FILLER               PIC X(248).
  3715
  3716
  3717****************************************************************
  3718*             LIFE EDIT MASTER RECORD                          *
  3719****************************************************************
  3720
  3721     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3722         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3723             20  CF-LIFE-CODE-IN            PIC XX.
  3724             20  CF-LIFE-CODE-OUT           PIC XX.
  3725         16  FILLER                         PIC X(248).
  3726
  3727
  3728****************************************************************
  3729*             AH EDIT MASTER RECORD                            *
  3730****************************************************************
  3731
  3732     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3733         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3734             20  CF-AH-CODE-IN              PIC XXX.
  3735             20  CF-AH-CODE-OUT             PIC XX.
  3736         16  FILLER                         PIC X(248).
  3737
  3738
  3739****************************************************************
  3740*             CREDIBILITY TABLES                               *
  3741****************************************************************
  3742
  3743     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3744         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3745                             INDEXED BY CF-CRDB-NDX.
  3746             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3747             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3748             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3749         16  FILLER                         PIC  X(332).
  3750
  3751
  3752****************************************************************
  3753*             REPORT CUSTOMIZATION RECORD                      *
  3754****************************************************************
  3755
  3756     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3757         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3758             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3759             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3760             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3761**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3762****       A T-TRANSFER.                                   ****
  3763             88  CF-ALL-ACCOUNTS                VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  76
* EL650.cbl
  3764
  3765         16  FILLER                         PIC XX.
  3766
  3767         16  CF-CARRIER-CNTL-OPT.
  3768             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3769                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3770                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3771             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3772                                            PIC X.
  3773         16  CF-GROUP-CNTL-OPT.
  3774             20  CF-GROUP-OPT-SEQ           PIC 9.
  3775                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3776                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3777             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3778                                            PIC X(6).
  3779         16  CF-STATE-CNTL-OPT.
  3780             20  CF-STATE-OPT-SEQ           PIC 9.
  3781                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3782                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3783             20  CF-STATE-SELECT OCCURS 3 TIMES
  3784                                            PIC XX.
  3785         16  CF-ACCOUNT-CNTL-OPT.
  3786             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3787                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3788                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3789             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3790                                            PIC X(10).
  3791         16  CF-BUS-TYP-CNTL-OPT.
  3792             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3793                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3794                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3795             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3796                                            PIC XX.
  3797         16  CF-LF-TYP-CNTL-OPT.
  3798             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3799                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3800                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3801             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3802                                            PIC XX.
  3803         16  CF-AH-TYP-CNTL-OPT.
  3804             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3805                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3806                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3807             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3808                                            PIC XX.
  3809         16  CF-REPTCD1-CNTL-OPT.
  3810             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3811                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3812                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3813             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3814                                            PIC X(10).
  3815         16  CF-REPTCD2-CNTL-OPT.
  3816             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3817                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3818                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3819             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3820                                            PIC X(10).
  3821         16  CF-USER1-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  77
* EL650.cbl
  3822             20  CF-USER1-OPT-SEQ           PIC 9.
  3823                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3824                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3825             20  CF-USER1-SELECT OCCURS 3 TIMES
  3826                                            PIC X(10).
  3827         16  CF-USER2-CNTL-OPT.
  3828             20  CF-USER2-OPT-SEQ           PIC 9.
  3829                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3830                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3831             20  CF-USER2-SELECT OCCURS 3 TIMES
  3832                                            PIC X(10).
  3833         16  CF-USER3-CNTL-OPT.
  3834             20  CF-USER3-OPT-SEQ           PIC 9.
  3835                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3836                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3837             20  CF-USER3-SELECT OCCURS 3 TIMES
  3838                                            PIC X(10).
  3839         16  CF-USER4-CNTL-OPT.
  3840             20  CF-USER4-OPT-SEQ           PIC 9.
  3841                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3842                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3843             20  CF-USER4-SELECT OCCURS 3 TIMES
  3844                                            PIC X(10).
  3845         16  CF-USER5-CNTL-OPT.
  3846             20  CF-USER5-OPT-SEQ           PIC 9.
  3847                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3848                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3849             20  CF-USER5-SELECT OCCURS 3 TIMES
  3850                                            PIC X(10).
  3851         16  CF-REINS-CNTL-OPT.
  3852             20  CF-REINS-OPT-SEQ           PIC 9.
  3853                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3854                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3855             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3856                 24  CF-REINS-PRIME         PIC XXX.
  3857                 24  CF-REINS-SUB           PIC XXX.
  3858
  3859         16  CF-AGENT-CNTL-OPT.
  3860             20  CF-AGENT-OPT-SEQ           PIC 9.
  3861                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3862                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3863             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3864                                            PIC X(10).
  3865
  3866         16  FILLER                         PIC X(43).
  3867
  3868         16  CF-LOSS-RATIO-SELECT.
  3869             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3870             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3871         16  CF-ENTRY-DATE-SELECT.
  3872             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3873             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3874         16  CF-EFFECTIVE-DATE-SELECT.
  3875             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3876             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3877
  3878         16  CF-EXCEPTION-LIST-IND          PIC X.
  3879             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  78
* EL650.cbl
  3880
  3881         16  FILLER                         PIC X(318).
  3882
  3883****************************************************************
  3884*                  EXCEPTION REPORTING RECORD                  *
  3885****************************************************************
  3886
  3887     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3888         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3889             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3890
  3891         16  CF-COMBINED-LIFE-AH-OPT.
  3892             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3893             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3894             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3895             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3896
  3897         16  CF-LIFE-OPT.
  3898             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3899             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3900             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3901             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3902             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3903             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3904             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3905             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3906             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3907             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3908
  3909         16  CF-AH-OPT.
  3910             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3911             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3912             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3913             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3914             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3915             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3916             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3917             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3918             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3919             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3920
  3921         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3922             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3923             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3924             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3925
  3926         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3927
  3928         16  FILLER                         PIC X(673).
  3929
  3930
  3931****************************************************************
  3932*             MORTGAGE SYSTEM PLAN RECORD                      *
  3933****************************************************************
  3934
  3935     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3936         16  CF-PLAN-TYPE                   PIC X.
  3937             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  79
* EL650.cbl
  3938             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3939             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3940         16  CF-PLAN-ABBREV                 PIC XXX.
  3941         16  CF-PLAN-DESCRIPT               PIC X(10).
  3942         16  CF-PLAN-NOTES                  PIC X(20).
  3943         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3944         16  CF-PLAN-UNDERWRITING.
  3945             20  CF-PLAN-TERM-DATA.
  3946                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3947                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3948             20  CF-PLAN-AGE-DATA.
  3949                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3950                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3951                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3952             20  CF-PLAN-BENEFIT-DATA.
  3953                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3954                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3955                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3956                                            PIC S9(7)V99  COMP-3.
  3957         16  CF-PLAN-POLICY-FORMS.
  3958             20  CF-POLICY-FORM             PIC X(12).
  3959             20  CF-MASTER-APPLICATION      PIC X(12).
  3960             20  CF-MASTER-POLICY           PIC X(12).
  3961         16  CF-PLAN-RATING.
  3962             20  CF-RATE-CODE               PIC X(5).
  3963             20  CF-SEX-RATING              PIC X.
  3964                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3965                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3966             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3967             20  CF-SUB-STD-TYPE            PIC X.
  3968                 88  CF-PCT-OF-PREM            VALUE '1'.
  3969                 88  CF-PCT-OF-BENE            VALUE '2'.
  3970         16  CF-PLAN-PREM-TOLERANCES.
  3971             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3972             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3973         16  CF-PLAN-PYMT-TOLERANCES.
  3974             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3975             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3976         16  CF-PLAN-MISC-DATA.
  3977             20  FILLER                     PIC X.
  3978             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3979             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3980         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3981         16  CF-PLAN-IND-GRP                PIC X.
  3982             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3983                                                     '1'.
  3984             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3985                                                     '2'.
  3986         16  CF-MIB-SEARCH-SW               PIC X.
  3987             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3988             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3989             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3990             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3991         16  CF-ALPHA-SEARCH-SW             PIC X.
  3992             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3993             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3994             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3995             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  80
* EL650.cbl
  3996             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3997             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3998             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3999             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4000             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4001             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4002                                                     'A' 'B' 'C'
  4003                                                     'X' 'Y' 'Z'.
  4004         16  CF-EFF-DT-RULE-SW              PIC X.
  4005             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4006             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4007             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4008             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4009             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4010         16  FILLER                         PIC X(4).
  4011         16  CF-HEALTH-QUESTIONS            PIC X.
  4012             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4013         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4014         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4015         16  CF-PLAN-SNGL-JNT               PIC X.
  4016             88  CF-COMBINED-PLAN              VALUE 'C'.
  4017             88  CF-JNT-PLAN                   VALUE 'J'.
  4018             88  CF-SNGL-PLAN                  VALUE 'S'.
  4019         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4020         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4021         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4022         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4023         16  CF-RERATE-CNTL                 PIC  X.
  4024             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4025             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4026             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4027             88  CF-AUTO-RECALC                 VALUE '4'.
  4028         16  CF-BENEFIT-TYPE                PIC  X.
  4029             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4030             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4031         16  CF-POLICY-FEE                  PIC S999V99
  4032                                                    COMP-3.
  4033         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4034         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4035         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4036         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4037         16  FILLER                         PIC  X(32).
  4038         16  CF-TERMINATION-FORM            PIC  X(04).
  4039         16  FILLER                         PIC  X(08).
  4040         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4041                                                       COMP-3.
  4042         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4043         16  CF-ISSUE-LETTER                PIC  X(4).
  4044         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4045         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4046             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4047             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4048         16  CF-MP-REFUND-CALC              PIC X.
  4049             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4050             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4051             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4052             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4053             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  81
* EL650.cbl
  4054             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4055             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4056             88  CF-MP-REFD-MEAN                VALUE '8'.
  4057         16  CF-ALT-RATE-CODE               PIC  X(5).
  4058
  4059
  4060         16  FILLER                         PIC X(498).
  4061****************************************************************
  4062*             MORTGAGE COMPANY MASTER RECORD                   *
  4063****************************************************************
  4064
  4065     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4066         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4067         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4068             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4069             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4070             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4071             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4072             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4073
  4074         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4075         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4076         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4077         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4078         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4079
  4080         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4081             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4082         16  CF-MP-RECON-USE-IND            PIC X(1).
  4083             88  CF-MP-USE-RECON             VALUE 'Y'.
  4084         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4085             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4086         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4087             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4088             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4089         16  FILLER                         PIC X(1).
  4090         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4091             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4092         16  CF-MORTG-MIB-VERSION           PIC X.
  4093             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4094             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4095             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4096         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4097             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4098                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4099             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4100                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4101             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4102                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4103             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4104                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4105             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4106                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4107             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4108                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4109         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4110         16  FILLER                         PIC X(7).
  4111         16  CF-MORTG-DESTINATION-SYMBOL.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  82
* EL650.cbl
  4112             20  CF-MORTG-MIB-COMM          PIC X(5).
  4113             20  CF-MORTG-MIB-TERM          PIC X(5).
  4114         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4115             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4116         16  FILLER                         PIC X(03).
  4117         16  CF-MP-CHECK-NO-CONTROL.
  4118             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4119                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4120                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4121                                                ' ' LOW-VALUES.
  4122                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4123                                               VALUE '3'.
  4124         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4125         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4126         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4127             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4128                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4129             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4130                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4131             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4132                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4133             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4134                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4135             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4136                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4137             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4138                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4139         16  CF-MORTG-BILLING-AREA.
  4140             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4141                                            PIC X.
  4142         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4143         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4144         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4145         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4146             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4147             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4148         16  FILLER                         PIC X.
  4149         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4150             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4151             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4152         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4153         16  FILLER                         PIC X(8).
  4154         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4155         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4156         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4157         16  CF-ACH-COMPANY-ID.
  4158             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4159                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4160                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4161                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4162             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4163         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4164             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4165         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4166             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4167             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4168         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4169         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  83
* EL650.cbl
  4170         16  FILLER                         PIC X(536).
  4171
  4172****************************************************************
  4173*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4174****************************************************************
  4175
  4176     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4177         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4178             20  CF-FEMALE-HEIGHT.
  4179                 24  CF-FEMALE-FT           PIC 99.
  4180                 24  CF-FEMALE-IN           PIC 99.
  4181             20  CF-FEMALE-MIN-WT           PIC 999.
  4182             20  CF-FEMALE-MAX-WT           PIC 999.
  4183         16  FILLER                         PIC X(428).
  4184
  4185     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4186         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4187             20  CF-MALE-HEIGHT.
  4188                 24  CF-MALE-FT             PIC 99.
  4189                 24  CF-MALE-IN             PIC 99.
  4190             20  CF-MALE-MIN-WT             PIC 999.
  4191             20  CF-MALE-MAX-WT             PIC 999.
  4192         16  FILLER                         PIC X(428).
  4193******************************************************************
  4194*             AUTOMATIC ACTIVITY RECORD                          *
  4195******************************************************************
  4196     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4197         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4198             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4199             20  CF-SYS-LETTER-ID           PIC X(04).
  4200             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4201             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4202             20  CF-SYS-RESET-SW            PIC X(01).
  4203             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4204             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4205
  4206         16  FILLER                         PIC X(50).
  4207
  4208         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4209             20  CF-USER-ACTIVE-SW          PIC X(01).
  4210             20  CF-USER-LETTER-ID          PIC X(04).
  4211             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4212             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4213             20  CF-USER-RESET-SW           PIC X(01).
  4214             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4215             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4216             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4217
  4218         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  84
* EL650.cbl
  4220*    COPY ERCPNDB.
  4221******************************************************************
  4222*                                                                *
  4223*                                                                *
  4224*                            ERCPNDB.                            *
  4225*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4226*                            VMOD=2.025                          *
  4227*                                                                *
  4228*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4229*                                                                *
  4230******************************************************************
  4231*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4232*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4233******************************************************************
  4234*                                                                *
  4235*                                                                *
  4236*   FILE TYPE = VSAM,KSDS                                        *
  4237*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4238*                                                                *
  4239*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4240*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4241*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4242*                                                 RKP=13,LEN=36  *
  4243*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4244*                                      AND CHG-SEQ.)             *
  4245*                                                RKP=49,LEN=11   *
  4246*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4247*                                      AND CHG-SEQ.)             *
  4248*                                                RKP=60,LEN=15   *
  4249*                                                                *
  4250*   LOG = NO                                                     *
  4251*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4252******************************************************************
  4253******************************************************************
  4254*                   C H A N G E   L O G
  4255*
  4256* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4257*-----------------------------------------------------------------
  4258*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4259* EFFECTIVE    NUMBER
  4260*-----------------------------------------------------------------
  4261* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4262* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4263* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4264* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4265* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4266* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4267* 032306                   PEMA  ADD BOW LOAN NUMBER
  4268* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4269* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4270* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4271* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4272* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4273* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4274* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4275* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4276* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4277* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  85
* EL650.cbl
  4278******************************************************************
  4279
  4280 01  PENDING-BUSINESS.
  4281     12  PB-RECORD-ID                     PIC XX.
  4282         88  VALID-PB-ID                        VALUE 'PB'.
  4283
  4284     12  PB-CONTROL-PRIMARY.
  4285         16  PB-COMPANY-CD                PIC X.
  4286         16  PB-ENTRY-BATCH               PIC X(6).
  4287         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4288         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4289
  4290     12  PB-CONTROL-BY-ACCOUNT.
  4291         16  PB-COMPANY-CD-A1             PIC X.
  4292         16  PB-CARRIER                   PIC X.
  4293         16  PB-GROUPING.
  4294             20  PB-GROUPING-PREFIX       PIC XXX.
  4295             20  PB-GROUPING-PRIME        PIC XXX.
  4296         16  PB-STATE                     PIC XX.
  4297         16  PB-ACCOUNT.
  4298             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4299             20  PB-ACCOUNT-PRIME         PIC X(6).
  4300         16  PB-CERT-EFF-DT               PIC XX.
  4301         16  PB-CERT-NO.
  4302             20  PB-CERT-PRIME            PIC X(10).
  4303             20  PB-CERT-SFX              PIC X.
  4304         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4305
  4306         16  PB-RECORD-TYPE               PIC X.
  4307             88  PB-MAILING-DATA                VALUE '0'.
  4308             88  PB-ISSUE                       VALUE '1'.
  4309             88  PB-CANCELLATION                VALUE '2'.
  4310             88  PB-BATCH-TRAILER               VALUE '9'.
  4311
  4312     12  PB-CONTROL-BY-ORIG-BATCH.
  4313         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4314         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4315         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4316         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4317
  4318     12  PB-CONTROL-BY-CSR.
  4319         16  PB-CSR-COMPANY-CD            PIC X.
  4320         16  PB-CSR-ID                    PIC X(4).
  4321         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4322         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4323         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4324******************************************************************
  4325*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4326******************************************************************
  4327
  4328     12  PB-LAST-MAINT-DT                 PIC XX.
  4329     12  PB-LAST-MAINT-BY                 PIC X(4).
  4330     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4331
  4332     12  PB-RECORD-BODY                   PIC X(375).
  4333
  4334     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4335         16  PB-CERT-ORIGIN               PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  86
* EL650.cbl
  4336             88  CLASIC-CREATED-CERT         VALUE '1'.
  4337         16  PB-I-NAME.
  4338             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4339             20  PB-I-INSURED-FIRST-NAME.
  4340                 24  PB-I-INSURED-1ST-INIT PIC X.
  4341                 24  FILLER                PIC X(9).
  4342             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4343         16  PB-I-AGE                     PIC S99   COMP-3.
  4344         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4345         16  PB-I-BIRTHDAY                PIC XX.
  4346         16  PB-I-INSURED-SEX             PIC X.
  4347             88  PB-SEX-MALE     VALUE 'M'.
  4348             88  PB-SEX-FEMALE   VALUE 'F'.
  4349
  4350         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4351         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4352         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4353         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4354         16  PB-I-SKIP-CODE               PIC X.
  4355             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4356             88  PB-SKIP-JULY              VALUE '1'.
  4357             88  PB-SKIP-AUGUST            VALUE '2'.
  4358             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4359             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4360             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4361             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4362             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4363             88  PB-SKIP-JUNE              VALUE '8'.
  4364             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4365             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4366             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4367         16  PB-I-TERM-TYPE               PIC X.
  4368             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4369             88  PB-PAID-WEEKLY            VALUE 'W'.
  4370             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4371             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4372             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4373         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4374         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4375         16  PB-I-DATA-ENTRY-SW           PIC X.
  4376             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4377             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4378             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4379             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4380         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4381         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4382*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4383         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4384         16  FILLER                       PIC X.
  4385
  4386         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4387             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4388             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4389                                                   '90' THRU '99'.
  4390         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4391                                          PIC XX.
  4392         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4393         16  PB-I-AMOUNT-FINANCED REDEFINES
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  87
* EL650.cbl
  4394                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4395         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4396         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4397                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4398         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4399         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4400         16  PB-I-CLP-AMOUNT REDEFINES
  4401                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4402         16  PB-I-LF-CALC-FLAG            PIC X.
  4403             88 PB-COMP-LF-PREM               VALUE '?'.
  4404         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4405         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4406         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4407         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4408         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4409         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4410         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4411         16  PB-I-LF-ABBR                 PIC XXX.
  4412         16  PB-I-LF-INPUT-CD             PIC XX.
  4413
  4414         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4415             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4416             88  PB-INVALID-AH               VALUE '  ' '00'
  4417                                                   '90' THRU '99'.
  4418         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4419         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4420         16  PB-I-AH-CALC-FLAG            PIC X.
  4421             88 PB-COMP-AH-PREM                  VALUE '?'.
  4422         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4423         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4424         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4425         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4426         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4427         16  PB-I-AH-ABBR                 PIC XXX.
  4428         16  PB-I-AH-INPUT-CD             PIC XXX.
  4429
  4430         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4431         16  PB-I-REIN-TABLE              PIC XXX.
  4432         16  PB-I-BUSINESS-TYPE           PIC 99.
  4433         16  PB-I-INDV-GRP-CD             PIC X.
  4434         16  PB-I-MORT-CODE.
  4435             20  PB-I-TABLE               PIC X.
  4436             20  PB-I-INTEREST            PIC XX.
  4437             20  PB-I-MORT-TYP            PIC X.
  4438         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4439         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4440         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4441         16  PB-I-INDV-GRP-OVRD           PIC X.
  4442         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4443         16  PB-I-SIG-SW                  PIC X.
  4444             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4445         16  PB-I-RATE-CLASS              PIC XX.
  4446         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4447         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4448         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4449         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4450         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4451         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  88
* EL650.cbl
  4452         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4453         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4454         16  PB-I-OB-FLAG                 PIC X.
  4455             88  PB-I-OB                      VALUE 'B'.
  4456             88  PB-I-SUMMARY                 VALUE 'Z'.
  4457         16  PB-I-ENTRY-STATUS            PIC X.
  4458             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4459                                              'M' '5' '9' '2'.
  4460             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4461             88  PB-I-POLICY-PENDING          VALUE '2'.
  4462             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4463             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4464             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4465             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4466             88  PB-I-REIN-ONLY               VALUE '9'.
  4467             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4468             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4469             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4470             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4471         16  PB-I-INT-CODE                PIC X.
  4472             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4473             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4474         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4475         16  PB-I-SOC-SEC-NO              PIC X(11).
  4476         16  PB-I-MEMBER-NO               PIC X(12).
  4477         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4478*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4479         16  PB-I-OLD-LOF                 PIC XXX.
  4480         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4481         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4482         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4483         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4484         16  PB-I-LIFE-INDICATOR          PIC X.
  4485             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4486         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4487         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4488                                          PIC S9(5)V99    COMP-3.
  4489         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4490             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4491             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4492         16  PB-I-1ST-PMT-DT              PIC XX.
  4493         16  PB-I-JOINT-INSURED.
  4494             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4495             20 PB-I-JOINT-FIRST-NAME.
  4496                24  PB-I-JOINT-FIRST-INIT PIC X.
  4497                24  FILLER                PIC X(9).
  4498             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4499*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4500         16  PB-I-BENEFICIARY-NAME.
  4501             20  PB-I-BANK-NUMBER         PIC X(10).
  4502             20  FILLER                   PIC X(15).
  4503         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4504         16  PB-I-REFERENCE               PIC X(12).
  4505         16  FILLER REDEFINES PB-I-REFERENCE.
  4506             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4507             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4508             20  PB-I-CLP-STATE           PIC XX.
  4509         16  PB-I-UNDERWRITING-STATUS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  89
* EL650.cbl
  4510             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4511             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4512             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4513         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4514         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4515         16  PB-I-RESIDENT-STATE          PIC XX.
  4516         16  PB-I-RATE-CODE               PIC X(4).
  4517         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4518         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4519         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4520         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4521         16  PB-I-BANK-NOCHRGB            PIC 99.
  4522         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4523         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4524
  4525     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4526         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4527             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4528         16  PB-C-CANCEL-ORIGIN           PIC X.
  4529             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4530         16  PB-C-LF-CANCEL-DT            PIC XX.
  4531         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4532         16  PB-C-LF-CALC-REQ             PIC X.
  4533             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4534         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4535         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4536         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4537             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4538         16  PB-C-AH-CANCEL-DT            PIC XX.
  4539         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4540         16  PB-C-AH-CALC-REQ             PIC X.
  4541             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4542         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4543         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4544         16  PB-C-LAST-NAME               PIC X(15).
  4545         16  PB-C-REFUND-SW               PIC X.
  4546             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4547             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4548         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4549         16  PB-C-PAYEE-CODE              PIC X(6).
  4550         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4551         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4552         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4553         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4554         16  PB-C-REFERENCE               PIC X(12).
  4555         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4556         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4557         16  PB-C-POST-CARD-IND           PIC X.
  4558         16  PB-C-CANCEL-REASON           PIC X.
  4559         16  PB-C-REF-INTERFACE-SW        PIC X.
  4560         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4561         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4562         16  FILLER                       PIC X(01).
  4563*        16  FILLER                       PIC X(18).
  4564         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4565*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4566         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  4567         16  PB-CANCELED-CERT-DATA.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  90
* EL650.cbl
  4568             20  PB-CI-INSURED-NAME.
  4569                 24  PB-CI-LAST-NAME      PIC X(15).
  4570                 24  PB-CI-INITIALS       PIC XX.
  4571             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4572             20  PB-CI-INSURED-SEX        PIC X.
  4573             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4574             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4575             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4576             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4577             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4578             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4579             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4580             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4581             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4582             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4583             20  PB-CI-RATE-CLASS         PIC XX.
  4584             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4585             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4586             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4587             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4588             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4589             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4590             20  PB-CI-LF-ABBR            PIC X(3).
  4591             20  PB-CI-AH-ABBR            PIC X(3).
  4592             20  PB-CI-OB-FLAG            PIC X.
  4593                 88  PB-CI-OB                VALUE 'B'.
  4594             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4595                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4596                                           'M' '4' '5' '9' '2'.
  4597                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4598                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4599                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4600                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4601                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4602                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4603                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4604                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4605                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4606                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4607                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4608                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4609                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4610             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4611                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4612                                           'M' '4' '5' '9' '2'.
  4613                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4614                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4615                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4616                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4617                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4618                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4619                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4620                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4621                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4622                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4623                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4624                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4625                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  91
* EL650.cbl
  4626             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4627             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4628             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4629             20  PB-CI-MEMBER-NO          PIC X(12).
  4630             20  PB-CI-INT-CODE           PIC X.
  4631                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4632                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4633             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4634             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4635             20  PB-CI-COMP-EXCP-SW       PIC X.
  4636                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4637                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4638             20  PB-CI-ENTRY-STATUS       PIC X.
  4639             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4640             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4641             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4642             20  PB-CI-DEATH-DT           PIC XX.
  4643             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4644             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4645             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4646             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4647             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4648             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4649             20  PB-CI-ENTRY-DT              PIC XX.
  4650             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4651             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4652             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4653             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4654             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4655             20  PB-CI-OLD-LOF               PIC XXX.
  4656*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4657             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4658             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4659             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4660             20  PB-CI-INDV-GRP-CD           PIC X.
  4661             20  PB-CI-BENEFICIARY-NAME.
  4662                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4663                 24  FILLER                  PIC X(15).
  4664             20  PB-CI-NOTE-SW               PIC X.
  4665             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4666             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4667             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4668             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4669             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4670             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4671             20  PB-CI-FIRST-NAME            PIC X(10).
  4672             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4673
  4674         16  FILLER                       PIC X(13).
  4675*032306  16  FILLER                       PIC X(27).
  4676*        16  FILLER                       PIC X(46).
  4677
  4678     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4679         16  FILLER                       PIC X(10).
  4680         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4681         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4682         16  PB-M-INSURED-MID-INIT        PIC X.
  4683         16  PB-M-INSURED-AGE             PIC 99.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  92
* EL650.cbl
  4684         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4685         16  PB-M-INSURED-SEX             PIC X.
  4686         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4687         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4688         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4689         16  PB-M-INSURED-CITY-STATE.
  4690             20  PB-M-INSURED-CITY        PIC X(28).
  4691             20  PB-M-INSURED-STATE       PIC XX.
  4692         16  PB-M-INSURED-ZIP-CODE.
  4693             20  PB-M-INSURED-ZIP-PRIME.
  4694                 24  PB-M-INSURED-ZIP-1   PIC X.
  4695                     88  PB-M-CANADIAN-POST-CODE
  4696                                             VALUE 'A' THRU 'Z'.
  4697                 24  FILLER               PIC X(4).
  4698             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4699         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4700                                        PB-M-INSURED-ZIP-CODE.
  4701             20  PM-M-INS-CAN-POST1       PIC XXX.
  4702             20  PM-M-INS-CAN-POST2       PIC XXX.
  4703             20  FILLER                   PIC XXX.
  4704         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4705         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4706         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4707         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4708         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4709         16  PB-M-CRED-BENE-CITYST.
  4710             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4711             20  PB-M-CRED-BENE-STATE     PIC XX.
  4712         16  FILLER                       PIC X(92).
  4713
  4714     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4715         16  FILLER                       PIC X(10).
  4716         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4717         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4718         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4719         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4720         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4721         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4722         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4723         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4724         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4725         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4726         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4727         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4728         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4729         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4730         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4731         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4732         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4733         16  PB-ACCOUNT-NAME              PIC X(30).
  4734         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4735         16  PB-REFERENCE                 PIC X(12).
  4736         16  PB-B-RECEIVED-DT             PIC XX.
  4737         16  FILLER                       PIC X(234).
  4738
  4739     12  PB-RECORD-STATUS.
  4740         16  PB-CREDIT-SELECT-DT          PIC XX.
  4741         16  PB-CREDIT-ACCEPT-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  93
* EL650.cbl
  4742         16  PB-BILLED-DT                 PIC XX.
  4743         16  PB-BILLING-STATUS            PIC X.
  4744             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4745             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4746             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4747         16  PB-RECORD-BILL               PIC X.
  4748             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4749             88  PB-RECORD-RETURNED           VALUE 'R'.
  4750             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4751             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4752             88  PB-OVERRIDE-AH               VALUE 'A'.
  4753             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4754         16  PB-BATCH-ENTRY               PIC X.
  4755             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4756             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4757             88  PB-REISSUED-CERT             VALUE 'E'.
  4758             88  PB-CASH-CERT                 VALUE 'C'.
  4759             88  PB-MONTHLY-CERT              VALUE 'M'.
  4760             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4761             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4762             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4763         16  PB-FORCE-CODE                PIC X.
  4764             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4765             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4766             88  PB-CANCEL-FORCE              VALUE '8'.
  4767             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4768             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4769             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4770             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4771             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4772             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4773             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4774         16  PB-FATAL-FLAG                PIC X.
  4775             88  PB-FATAL-ERRORS              VALUE 'X'.
  4776         16  PB-FORCE-ER-CD               PIC X.
  4777             88  PB-FORCE-ERRORS              VALUE 'F'.
  4778             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4779         16  PB-WARN-ER-CD                PIC X.
  4780             88  PB-WARNING-ERRORS            VALUE 'W'.
  4781         16  FILLER                       PIC X.
  4782         16  PB-OUT-BAL-CD                PIC X.
  4783             88  PB-OUT-OF-BAL                VALUE 'O'.
  4784         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4785         16  PB-AH-OVERRIDE-L1            PIC X.
  4786         16  PB-INPUT-DT                  PIC XX.
  4787         16  PB-INPUT-BY                  PIC X(4).
  4788         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4789         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4790         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4791         16  PB-LF-EARNING-METHOD         PIC X.
  4792         16  PB-AH-EARNING-METHOD         PIC X.
  4793         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4794         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4795         16  PB-REIN-CD                   PIC XXX.
  4796         16  PB-LF-REFUND-TYPE            PIC X.
  4797         16  PB-AH-REFUND-TYPE            PIC X.
  4798         16  PB-ACCT-EFF-DT               PIC XX.
  4799         16  PB-ACCT-EXP-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  94
* EL650.cbl
  4800         16  PB-COMPANY-ID                PIC X(3).
  4801         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4802         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4803         16  PB-SV-CARRIER                PIC X.
  4804         16  PB-SV-GROUPING               PIC X(6).
  4805         16  PB-SV-STATE                  PIC XX.
  4806         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4807         16  PB-GA-BILLING-INFO.
  4808             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4809                                          PIC XX.
  4810         16  PB-SV-REMIT-TO  REDEFINES
  4811             PB-GA-BILLING-INFO           PIC X(10).
  4812         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4813         16  PB-I-LOAN-OFFICER            PIC X(5).
  4814         16  PB-I-VIN                     PIC X(17).
  4815
  4816         16  FILLER                       PIC X(04).
  4817         16  IMNET-BYPASS-SW              PIC X.
  4818
  4819******************************************************************
  4820*                COMMON EDIT ERRORS                              *
  4821******************************************************************
  4822
  4823     12  PB-COMMON-ERRORS.
  4824         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4825                                           PIC S9(4)     COMP.
  4826
  4827******************************************************************
  4828*EJECT
  4829*    COPY ERCGXRF.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  95
* EL650.cbl
  4831 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  4832                          COMPENSATION-MASTER
  4833                          NAME-LOOKUP-MASTER PLAN-MASTER
  4834                          CONTROL-FILE PENDING-BUSINESS.
  4835 0000-DFHEXIT SECTION.
  4836     MOVE '9#                    $   ' TO DFHEIV0.
  4837     MOVE 'EL650' TO DFHEIV1.
  4838     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4839
  4840     MOVE LOW-VALUES             TO  WS-VERIFY-AREA.
  4841     INITIALIZE  TEMP-STORAGE-RECORD.
  4842
  4843     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  4844     MOVE '5'                    TO  DC-OPTION-CODE.
  4845
  4846     PERFORM 9700-DATE-CONVERSION.
  4847
  4848     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  4849     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  4850     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  4851     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  4852*    display ' beginning of program el650   '
  4853
  4854     IF EIBCALEN  =  0
  4855         GO TO 8800-UNAUTHORIZED-ACCESS.
  4856
  4857     MOVE SCREEN-NUMBER          TO  TS-SCREEN.
  4858     MOVE EIBTRMID               TO  TS-TERM.
  4859     MOVE LOW-VALUES             TO  EL650AI.
  4860
  4861     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  4862         MOVE PI-CALLING-PROGRAM        TO  RETURNED-FROM.
  4863
  4864     IF PI-CALLING-PROGRAM  NOT = THIS-PGM
  4865         IF PI-RETURN-TO-PROGRAM  NOT = THIS-PGM
  4866             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  4867             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  4868             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  4869             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  4870             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  4871             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  4872             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  4873             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  4874             MOVE LOW-VALUES            TO  PI-PROGRAM-WORK-AREA
  4875             MOVE ZEROS                 TO  PI-TOTAL-LINES
  4876                                            PI-LINE-SELECTED
  4877             MOVE SPACE                 TO  PI-RECORD-ADDED-SW
  4878             MOVE 1                     TO  PI-PAGE-NUMBER
  4879         ELSE
  4880             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  4881             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  4882             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  4883             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  4884             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  4885             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  4886             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  4887             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  4888
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  96
* EL650.cbl
  4889**************************************************************
  4890*               CLIENT "DMD" CUSTOM CODE
  4891* CHECK IF CONTROL PASSED FROM EL608 PROGRAM
  4892* START BROWSE BEGINNING WITH KEY PASSED BY EL608
  4893*              CSO CR# 6475
  4894     IF EIBTRNID  =  EL608-TRANS-ID
  4895         MOVE 1                     TO RETURN-FROM-SW
  4896         MOVE 'Y'                   TO FROM-EL608-SW
  4897         MOVE TRANS-ID              TO EIBTRNID
  4898         MOVE XCTL-EL601            TO PI-RETURN-TO-PROGRAM
  4899         MOVE PI-PREV-VG-ACCOUNT    TO PI-ACCT-CCGSA-KEY
  4900                                       KEY-SAVE
  4901         MOVE LOW-VALUES            TO PI-ACCT-EXP-DT
  4902                                       PI-ACCT-REST-OF-EXP
  4903                                       PI-DATE-RANGE-TABLE
  4904
  4905* EXEC CICS  HANDLE CONDITION
  4906*            NOTFND   (5340-END)
  4907*            ENDFILE  (5330-NOT-FOUND)
  4908*        END-EXEC
  4909*    MOVE '"$I''                  ! " #00004900' TO DFHEIV0
  4910     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4911     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4912     MOVE X'2220233030303034393030' TO DFHEIV0(25:11)
  4913     CALL 'kxdfhei1' USING DFHEIV0
  4914     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4915         MOVE 'Y'                   TO FIRST-TIME-SW
  4916         MOVE ZEROS                 TO PI-TOTAL-LINES
  4917         SET T-INDEX
  4918             TS-INDEX  TO  +1
  4919         MOVE ACCT-FILE-ID          TO PI-ACCT-ID
  4920         MOVE 1                     TO PI-PAGE-NUMBER
  4921         MOVE 'S'                   TO PI-MAINT
  4922         MOVE DFHPF1                TO EIBAID
  4923         GO TO 1002-SHOW-NEW-RECORDS.
  4924*    END OF CLIENT "DMD" CUSTOM CODE
  4925**************************************************************
  4926
  4927     IF RETURNED-FROM = XCTL-6501 OR XCTL-6502 OR XCTL-6503 OR
  4928                        XCTL-6504 OR XCTL-6505 OR XCTL-6506 OR
  4929                        XCTL-6508
  4930         MOVE 1                     TO  RETURN-FROM-SW
  4931         MOVE PI-PREV-VG-ACCOUNT    TO  PI-ACCT-CCGSA-KEY
  4932         MOVE PI-ACCT-CCGSA-KEY     TO  KEY-SAVE
  4933         MOVE LOW-VALUES            TO  PI-ACCT-EXP-DT
  4934         GO TO 1002-SHOW-NEW-RECORDS.
  4935
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  97
* EL650.cbl
  4937     IF EIBTRNID  NOT =  TRANS-ID
  4938         IF EIBTRNID  NOT = EL640-TRANS-ID  AND
  4939            EIBTRNID  NOT = EL658-TRANS-ID  AND
  4940            EIBTRNID  NOT = EL6311-TRANS-ID AND
  4941            EIBTRNID  NOT = VP6311-TRANS-ID AND
  4942            EIBTRNID  NOT = EL1273-TRANS-ID AND
  4943            EIBTRNID  NOT = EL652-TRANS-ID  AND
  4944            EIBTRNID  NOT = EL6523-TRANS-ID AND
  4945            EIBTRNID  NOT = EL6311NC-TRANS-ID AND
  4946            EIBTRNID  NOT = EL130-TRANS-ID  AND
  4947            EIBTRNID  NOT = EL6592-TRANS-ID AND
  4948            EIBTRNID  NOT = EL6509-TRANS-ID
  4949            AND EIBTRNID NOT = EL6503-TRANS-ID
  4950             GO TO 8100-SEND-INITIAL-MAP
  4951         ELSE
  4952             IF PI-CR-CONTROL-IN-PROGRESS  = SPACES
  4953                 GO TO 8100-SEND-INITIAL-MAP
  4954             ELSE
  4955                 MOVE 'S'             TO  MAINTI
  4956                 MOVE PI-CR-CARRIER   TO  ACARIERI
  4957                 MOVE PI-CR-GROUPING  TO  AGROUPI
  4958                 MOVE PI-CR-STATE     TO  ASTATEI
  4959                 MOVE PI-CR-ACCOUNT   TO  AACCTI
  4960                 MOVE +1              TO  ACARIERL
  4961                                          MAINTL
  4962                 MOVE +6              TO  AGROUPL
  4963                 MOVE +2              TO  ASTATEL
  4964                 MOVE +10             TO  AACCTL
  4965                 GO TO 0330-EDIT-DATA.
  4966
  4967
  4968* EXEC CICS  HANDLE CONDITION
  4969*        PGMIDERR  (9600-PGMID-ERROR)
  4970*        ERROR     (9990-ABEND)
  4971*    END-EXEC.
  4972*    MOVE '"$L.                  ! # #00004956' TO DFHEIV0
  4973     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  4974     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4975     MOVE X'2320233030303034393536' TO DFHEIV0(25:11)
  4976     CALL 'kxdfhei1' USING DFHEIV0
  4977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4978
  4979
  4980     IF EIBAID  = DFHCLEAR
  4981         GO TO 9400-CLEAR.
  4982
  4983     IF PI-PROCESSOR-ID  =  'LGXX'
  4984         GO TO 0200-RECEIVE.
  4985
  4986
  4987* EXEC CICS  READQ TS
  4988*        QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  4989*        INTO    (SECURITY-CONTROL)
  4990*        LENGTH  (SC-COMM-LENGTH)
  4991*        ITEM    (SC-ITEM)
  4992*    END-EXEC.
  4993*    MOVE '*$II   L              ''   #00004967' TO DFHEIV0
  4994     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  98
* EL650.cbl
  4995     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4996     MOVE X'2020233030303034393637' TO DFHEIV0(25:11)
  4997     CALL 'kxdfhei1' USING DFHEIV0,
  4998           PI-SECURITY-TEMP-STORE-ID,
  4999           SECURITY-CONTROL,
  5000           SC-COMM-LENGTH,
  5001           SC-ITEM,
  5002           DFHEIV99,
  5003           DFHEIV99
  5004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5005
  5006
  5007     MOVE SC-CREDIT-DISPLAY (04)  TO  PI-DISPLAY-CAP.
  5008     MOVE SC-CREDIT-UPDATE  (04)  TO  PI-MODIFY-CAP.
  5009
  5010     IF NOT DISPLAY-CAP
  5011         MOVE 'READ'             TO  SM-READ
  5012         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  5013         MOVE ER-0070            TO  EMI-ERROR
  5014         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5015         GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page  99
* EL650.cbl
  5017 0200-RECEIVE.
  5018     IF EIBAID  = DFHPA1  OR  DFHPA2  OR  DFHPA3
  5019         MOVE ER-0008            TO  EMI-ERROR
  5020         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5021         MOVE -1                 TO  MAINTL
  5022         GO TO 8200-SEND-DATAONLY.
  5023
  5024
  5025* EXEC CICS  RECEIVE
  5026*        MAP     (MAP-NAME)
  5027*        MAPSET  (MAPSET-NAME)
  5028*        INTO    (EL650AI)
  5029*    END-EXEC.
  5030     MOVE LENGTH OF
  5031      EL650AI
  5032       TO DFHEIV11
  5033*    MOVE '8"T I  L              ''   #00004991' TO DFHEIV0
  5034     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5035     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5036     MOVE X'2020233030303034393931' TO DFHEIV0(25:11)
  5037     CALL 'kxdfhei1' USING DFHEIV0,
  5038           MAP-NAME,
  5039           EL650AI,
  5040           DFHEIV11,
  5041           MAPSET-NAME,
  5042           DFHEIV99,
  5043           DFHEIV99
  5044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5045
  5046
  5047     IF PFENTERL  = ZERO
  5048         GO TO 0300-CHECK-PFKEYS.
  5049
  5050     IF EIBAID  NOT = DFHENTER
  5051         MOVE ER-0004            TO  EMI-ERROR
  5052         GO TO 0320-INPUT-ERROR.
  5053
  5054     IF (PFENTERI NUMERIC)
  5055       AND  (PFENTERI GREATER ZERO AND LESS 25)
  5056         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  5057     ELSE
  5058         MOVE ER-0029               TO  EMI-ERROR
  5059         GO TO 0320-INPUT-ERROR.
  5060
  5061 0300-CHECK-PFKEYS.
  5062     IF EIBAID  = DFHPF23
  5063         GO TO 8810-PF23.
  5064
  5065     IF EIBAID  = DFHPF24
  5066         GO TO 9200-RETURN-MAIN-MENU.
  5067
  5068     IF EIBAID  = DFHPF12
  5069         GO TO 9500-PF12.
  5070
  5071     IF MAINTL  NOT = ZERO   AND
  5072        MAINTI  NOT = SPACE  AND
  5073        EIBAID  NOT = DFHENTER
  5074          MOVE ER-0050            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 100
* EL650.cbl
  5075          GO TO 0320-INPUT-ERROR.
  5076
  5077     if (maintl not = zeros)
  5078        and (mainti not = 'D')
  5079        move spaces              to pi-el650-del-sw
  5080     end-if
  5081     IF EIBAID  = DFHPF1
  5082         GO TO 5300-FIND-NEXT-ACCOUNT.
  5083
  5084     IF EIBAID  = DFHPF2
  5085         GO TO 5400-FIND-PREV-ACCOUNT.
  5086
  5087     IF EIBAID  = DFHPF3
  5088         GO TO 5100-FIND-NEXT-RANGE.
  5089
  5090     IF EIBAID  = DFHPF4
  5091         GO TO 5200-FIND-PREV-RANGE.
  5092
  5093     IF EIBAID  = DFHPF5
  5094         GO TO 8900-PF5.
  5095
  5096     IF EIBAID  = DFHPF6
  5097        GO TO 8910-PF6
  5098     END-IF
  5099     IF EIBAID  = DFHENTER
  5100         GO TO 0330-EDIT-DATA.
  5101
  5102     MOVE ER-0029                TO  EMI-ERROR.
  5103
  5104 0320-INPUT-ERROR.
  5105     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5106
  5107     MOVE AL-UNBON               TO  PFENTERA.
  5108
  5109     IF PFENTERL  = ZERO
  5110         MOVE -1                 TO  MAINTL
  5111     ELSE
  5112         MOVE -1                 TO  PFENTERL.
  5113
  5114     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 101
* EL650.cbl
  5116 0330-EDIT-DATA.
  5117     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  5118     MOVE '5'                    TO  DC-OPTION-CODE.
  5119
  5120     PERFORM 9700-DATE-CONVERSION.
  5121
  5122     MOVE DC-BIN-DATE-1          TO  BIN-CURRENT-SAVE.
  5123     MOVE DC-GREG-DATE-1-YMD     TO  CURRENT-SAVE.
  5124
  5125     IF ACARIERL GREATER ZEROS
  5126         IF PI-CARRIER-SECURITY GREATER SPACES
  5127             IF ACARIERI = PI-CARRIER-SECURITY
  5128                 NEXT SENTENCE
  5129             ELSE
  5130                 MOVE -1         TO  ACARIERL
  5131                 MOVE ER-2370    TO  EMI-ERROR
  5132                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5133                 MOVE AL-UABON   TO  ACARIERA
  5134                 GO TO 8200-SEND-DATAONLY.
  5135
  5136     IF MAINTI  = 'S'
  5137       IF LINEL = ZEROS
  5138           MOVE 1 TO PI-PAGE-NUMBER
  5139           GO TO 1000-SHOW-ACCOUNT
  5140       ELSE
  5141           GO TO 1000-SHOW-ACCOUNT.
  5142
  5143     PERFORM 6800-COMPANY-REC-READ  THRU  6899-EXIT.
  5144
  5145     IF EMI-ERROR  NOT = ZEROS
  5146         MOVE -1                 TO  MAINTL
  5147         GO TO 8200-SEND-DATAONLY.
  5148
  5149     IF NOT  MODIFY-CAP
  5150         MOVE 'UPDATE'           TO  SM-READ
  5151         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  5152         MOVE ER-0070            TO  EMI-ERROR
  5153         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5154         MOVE AL-UANON           TO  ACARIERA  AGROUPA
  5155                                     ASTATEA   AACCTA
  5156         GO TO 8100-SEND-INITIAL-MAP.
  5157
  5158     IF MAINTI  = 'A'
  5159         GO TO 1500-ADD-ACCOUNT.
  5160
  5161     IF MAINTI  = 'C'
  5162         IF PI-SV-MAINT IS EQUAL TO 'L'
  5163            MOVE -1              TO  MAINTL
  5164            MOVE AL-UABON        TO  MAINTA
  5165            MOVE ER-0899         TO  EMI-ERROR
  5166            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5167            GO TO 8200-SEND-DATAONLY
  5168         ELSE
  5169            GO TO 2000-CHANGE-ACCOUNT.
  5170
  5171     IF MAINTI  = 'D'
  5172         GO TO 2500-DELETE-ACCOUNT.
  5173
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 102
* EL650.cbl
  5174     IF MAINTI  = 'X'
  5175         GO TO 3000-CHANGE-EXPIRATION.
  5176
  5177     IF MAINTI  = 'E'
  5178         GO TO 3500-CHANGE-EFFECTIVE.
  5179
  5180     IF MAINTI  = 'L'
  5181         MOVE 'L'             TO  PI-SV-MAINT
  5182         GO TO 4000-CHANGE-ALL.
  5183
  5184     IF MAINTI  = 'K'
  5185       IF LINEL GREATER ZERO
  5186           GO TO 4900-CREATE-NEW-ACCOUNT
  5187        ELSE
  5188           GO TO 4500-CREATE-NEW-ACCOUNT.
  5189
  5190     IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5191         IF MAINTI  = 'T'
  5192             GO TO 4500-CREATE-NEW-ACCOUNT.
  5193
  5194     IF MAINTI  = 'N'
  5195         GO TO 5000-CREATE-NEW-RANGE.
  5196
  5197     MOVE ER-0023                TO  EMI-ERROR.
  5198
  5199     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5200
  5201     MOVE -1                     TO  MAINTL.
  5202     MOVE AL-UABON               TO  MAINTA.
  5203
  5204     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 103
* EL650.cbl
  5206 1000-SHOW-ACCOUNT.
  5207     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5208
  5209     IF LINEL GREATER ZEROS   AND
  5210        PI-TOTAL-LINES  NOT =  ZEROS
  5211         NEXT SENTENCE
  5212     ELSE
  5213         GO TO 1002-SHOW-NEW-RECORDS.
  5214
  5215     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5216
  5217     IF EMI-ERROR  NOT = ZEROS
  5218         GO TO 8200-SEND-DATAONLY.
  5219
  5220     SET T-INDEX                 TO  LINEI.
  5221
  5222     IF PI-2ND-PAGE
  5223         SET T-INDEX  UP  BY  8
  5224     ELSE
  5225     IF PI-3RD-PAGE
  5226         SET T-INDEX  UP  BY  16
  5227     ELSE
  5228     IF PI-LST-PAGE
  5229         SET T-INDEX  UP  BY  24.
  5230
  5231     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5232     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5233
  5234     IF PI-PREV-ACCOUNT  =  PI-ACCT-CCGSA-KEY
  5235         MOVE MAINTI             TO  PI-MAINT
  5236         MOVE XCTL-6501          TO  PGM-NAME
  5237         GO TO 9300-XCTL
  5238     ELSE
  5239         IF PI-PREV-VG-ACCOUNT = PI-ACCT-CCGSA-KEY
  5240             MOVE MAINTI         TO  PI-MAINT
  5241             MOVE XCTL-6501      TO  PGM-NAME
  5242             PERFORM 7400-READ-TEMP-STORAGE  THRU  7400-EXIT
  5243             SET TS-INDEX        TO  T-INDEX
  5244             MOVE TS-ACCT-KEY (TS-INDEX)
  5245                                 TO  PI-ACCT-CCGSA-KEY
  5246             GO TO 9300-XCTL.
  5247
  5248 1002-SHOW-NEW-RECORDS.
  5249
  5250* EXEC CICS  HANDLE CONDITION
  5251*         NOTFND   (1010-NOT-FOUND)
  5252*         ENDFILE  (1010-NOT-FOUND)
  5253*    END-EXEC.
  5254*    MOVE '"$I''                  ! $ #00005199' TO DFHEIV0
  5255     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5256     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5257     MOVE X'2420233030303035313939' TO DFHEIV0(25:11)
  5258     CALL 'kxdfhei1' USING DFHEIV0
  5259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5260
  5261
  5262     SET T-INDEX
  5263        TS-INDEX  TO  +1.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 104
* EL650.cbl
  5264
  5265     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE.
  5266
  5267     MOVE LOW-VALUES             TO  TEMP-STORAGE-RECORD.
  5268
  5269     MOVE ZEROS                  TO  PI-TOTAL-LINES.
  5270
  5271     PERFORM 7100-START-BROWSE  THRU  7100-EXIT.
  5272
  5273     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  5274
  5275 1005-READ-ACCT.
  5276     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  5277
  5278     IF K-WITH-LINE-NO
  5279       IF SV-CARRIER   NOT = AM-CARRIER  OR
  5280          SV-GROUPING  NOT = AM-GROUPING OR
  5281          SV-STATE     NOT = AM-STATE    OR
  5282          SV-ACCOUNT   NOT = AM-ACCOUNT
  5283            GO TO 1010-NOT-FOUND.
  5284
  5285     IF SV-CO  NOT = AM-COMPANY-CD
  5286         GO TO 1010-NOT-FOUND.
  5287
  5288     IF SV-ACCOUNT  NOT =  AM-ACCOUNT
  5289         GO TO 1010-NOT-FOUND.
  5290
  5291     IF SV-STATE  NOT = AM-STATE
  5292       AND  (ST-ACCNT-CNTL
  5293       OR  CARR-ST-ACCNT-CNTL
  5294       OR  CARR-GROUP-ST-ACCNT-CNTL)
  5295         GO TO 1010-NOT-FOUND.
  5296
  5297     IF SV-CARRIER  NOT =  AM-CARRIER
  5298       AND  (CARR-ACCNT-CNTL
  5299       OR  CARR-ST-ACCNT-CNTL
  5300       OR  CARR-GROUP-ST-ACCNT-CNTL)
  5301         GO TO 1010-NOT-FOUND.
  5302
  5303     IF SV-GROUPING  NOT = AM-GROUPING
  5304       AND  CARR-GROUP-ST-ACCNT-CNTL
  5305         GO TO 1010-NOT-FOUND.
  5306
  5307     IF AM-TRNTO-DTE  =  SPACES
  5308         MOVE LOW-VALUES         TO  AM-TRNTO-DTE.
  5309
  5310     IF AM-TRNFROM-DTE  = SPACES
  5311         MOVE LOW-VALUES         TO  AM-TRNFROM-DTE.
  5312
  5313     IF T-INDEX  = 1
  5314         IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5315             MOVE AM-TRANSFERRED-TO  TO  TRNTOO
  5316             MOVE AM-TRNTO-DTE       TO  DC-BIN-DATE-1
  5317             MOVE SPACE              TO  DC-OPTION-CODE
  5318             PERFORM 9700-DATE-CONVERSION
  5319             IF DATE-CONVERSION-ERROR
  5320                 MOVE SPACES         TO  TRNTODTO
  5321             ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 105
* EL650.cbl
  5322                 MOVE DC-GREG-DATE-1-EDIT
  5323                                     TO  TRNTODTO.
  5324
  5325     IF T-INDEX  =  1
  5326         IF PI-COMPANY-ID  =  'LGX' OR 'MIC' OR 'MCC'
  5327             MOVE AM-TRANSFERRED-FROM  TO  TRNFROMO
  5328             MOVE AM-TRNFROM-DTE       TO  DC-BIN-DATE-1
  5329             MOVE SPACE                TO  DC-OPTION-CODE
  5330             PERFORM 9700-DATE-CONVERSION
  5331             IF DATE-CONVERSION-ERROR
  5332                 MOVE SPACES           TO  TRNFRDTO
  5333             ELSE
  5334                 MOVE DC-GREG-DATE-1-EDIT
  5335                                       TO  TRNFRDTO.
  5336
  5337     IF T-INDEX  = 1
  5338         MOVE AM-CONTROL-PRIMARY  TO  PI-PREV-ACCOUNT
  5339         MOVE PI-ACCT-CCGSA-KEY   TO  PI-PREV-VG-ACCOUNT
  5340         MOVE AM-NAME             TO  NAMEO
  5341                                      PI-ACCNAME
  5342         MOVE SPACE               TO  NAMEFLGO
  5343                                      PI-NAMEFLG.
  5344
  5345     IF AM-NAME  NOT = NAMEO
  5346         MOVE '*'                TO  NAMEFLGO
  5347                                     PI-NAMEFLG.
  5348
  5349     PERFORM 1020-MOVE-TO-TABLE  THRU  1020-EXIT.
  5350
  5351     GO TO 1005-READ-ACCT.
  5352
  5353 1010-NOT-FOUND.
  5354     IF BROWSE-STARTED
  5355
  5356* EXEC CICS  ENDBR
  5357*            DATASET  (PI-ACCT-ID)
  5358*        END-EXEC.
  5359     MOVE 0
  5360       TO DFHEIV11
  5361*    MOVE '&2                    $   #00005297' TO DFHEIV0
  5362     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5363     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5364     MOVE X'2020233030303035323937' TO DFHEIV0(25:11)
  5365     CALL 'kxdfhei1' USING DFHEIV0,
  5366           PI-ACCT-ID,
  5367           DFHEIV11,
  5368           DFHEIV99
  5369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5370
  5371
  5372     IF T-INDEX  NOT = 1
  5373         PERFORM 7200-WRITE-TEMP-STORAGE  THRU  7200-EXIT
  5374         GO TO 7000-BUILD-OUTPUT-MAP.
  5375
  5376     MOVE ER-0226                TO  EMI-ERROR.
  5377
  5378     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5379
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 106
* EL650.cbl
  5380     MOVE -1                     TO  ACARIERL.
  5381     MOVE AL-UABON               TO  ACARIERA
  5382                                     AGROUPA
  5383                                     ASTATEA
  5384                                     AACCTA.
  5385
  5386     IF FROM-EL608-SW = 'Y'
  5387         MOVE SV-CARRIER     TO  ACARIERO
  5388         MOVE SV-GROUPING    TO  AGROUPO
  5389         MOVE SV-STATE       TO  ASTATEO
  5390         MOVE SV-ACCOUNT     TO  AACCTO
  5391         MOVE 'N'            TO  FROM-EL608-SW.
  5392
  5393     IF PI-MAINT = 'A'
  5394         IF PI-RECORD-NOT-CREATED
  5395             MOVE SV-CARRIER     TO  ACARIERO
  5396             MOVE SV-GROUPING    TO  AGROUPO
  5397             MOVE SV-STATE       TO  ASTATEO
  5398             MOVE SV-ACCOUNT     TO  AACCTO
  5399             MOVE ER-2151        TO  EMI-ERROR
  5400             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5401             MOVE 'S'            TO  PI-MAINT.
  5402
  5403     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 107
* EL650.cbl
  5405 1020-MOVE-TO-TABLE.
  5406     MOVE AM-EXPIRATION-DT       TO  PI-BIN-EXP-DT   (T-INDEX).
  5407     MOVE AM-EFFECTIVE-DT        TO  PI-BIN-EFF-DT   (T-INDEX).
  5408     MOVE AM-LAST-MAINT-DT       TO  PI-BIN-MAINT-DT (T-INDEX).
  5409     MOVE AM-HI-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  5410     MOVE '3'                    TO  DC-OPTION-CODE.
  5411
  5412     PERFORM 9700-DATE-CONVERSION.
  5413
  5414     IF DATE-CONVERSION-ERROR
  5415         MOVE LOW-VALUES         TO  PI-BIN-HI-CERT (T-INDEX)
  5416     ELSE
  5417         MOVE DC-BIN-DATE-1      TO  PI-BIN-HI-CERT (T-INDEX).
  5418
  5419     MOVE AM-LO-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  5420     MOVE '3'                    TO  DC-OPTION-CODE.
  5421
  5422     PERFORM 9700-DATE-CONVERSION.
  5423
  5424     IF DATE-CONVERSION-ERROR
  5425         MOVE LOW-VALUES         TO  PI-BIN-LO-CERT (T-INDEX)
  5426     ELSE
  5427         MOVE DC-BIN-DATE-1      TO  PI-BIN-LO-CERT (T-INDEX).
  5428
  5429     MOVE AM-AR-HI-CERT-DATE     TO  PI-BIN-AR-HI-CERT (T-INDEX).
  5430     MOVE AM-CONTROL-PRIMARY     TO  TS-ACCT-KEY (TS-INDEX).
  5431
  5432     ADD 1                       TO  PI-TOTAL-LINES.
  5433
  5434     SET T-INDEX
  5435        TS-INDEX  UP  BY  +1.
  5436
  5437     IF T-INDEX  = +33
  5438         GO TO 7000-BUILD-OUTPUT-MAP.
  5439
  5440
  5441 1020-EXIT.
  5442     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 108
* EL650.cbl
  5444 1500-ADD-ACCOUNT.
  5445     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  5446
  5447     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  5448
  5449     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  5450                                     PI-ACCT-REST-OF-EXP.
  5451
  5452     PERFORM 6500-READ-ACCT  THRU  6599-EXIT.
  5453
  5454     IF REC-FOUND
  5455         MOVE -1                 TO  ACARIERL
  5456         MOVE ER-0561            TO  EMI-ERROR
  5457         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5458         GO TO 8200-SEND-DATAONLY.
  5459
  5460     MOVE NEW-KEY-SAVE           TO PI-ACCT-CCGSA-KEY.
  5461
  5462     PERFORM 6000-EDIT-EFFECTIVE-DATE   THRU  6000-EFF-EXIT.
  5463
  5464     PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT.
  5465
  5466     PERFORM 6700-VERIFY-STATE-CARRIER  THRU  6799-EXIT.
  5467
  5468     IF BIN-EXPCHG-SAVE NOT GREATER BIN-EFFCHG-SAVE
  5469         MOVE -1                 TO  EXPCHGL
  5470         MOVE ER-1228            TO  EMI-ERROR
  5471         MOVE AL-UABON           TO  EXPCHGA
  5472         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5473
  5474     IF NOT EMI-NO-ERRORS
  5475         GO TO 8200-SEND-DATAONLY.
  5476
  5477     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  5478
  5479     IF WS-ACCT2-FOUND  = 'Y'
  5480         PERFORM 4200-CHECK-VALIDITY  THRU  4200-EXIT
  5481             VARYING  WS-INDEX  FROM  +1  BY  +1
  5482                UNTIL WS-INDEX GREATER +32.
  5483
  5484     IF NOT EMI-NO-ERRORS
  5485         GO TO 8200-SEND-DATAONLY.
  5486
  5487     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  5488
  5489     MOVE NEW-KEY-SAVE           TO  PI-ACCT-CCGSA-KEY
  5490                                     PI-PREV-ACCOUNT
  5491                                     PI-PREV-VG-ACCOUNT.
  5492     MOVE LOW-VALUES             TO  PI-DATE-RANGE-TABLE
  5493                                     PI-ACCT-REST-OF-EXP.
  5494     MOVE BIN-EXPCHG-SAVE        TO  PI-ACCT-EXP-DT
  5495                                     PI-BIN-EXP-DT (1)
  5496     MOVE BIN-EFFCHG-SAVE        TO  PI-BIN-EFF-DT (1).
  5497     MOVE 1                      TO  PI-TOTAL-LINES
  5498                                     PI-PAGE-NUMBER
  5499                                     PI-LINE-SELECTED.
  5500     MOVE SPACE                  TO  PI-RECORD-ADDED-SW.
  5501     MOVE MAINTI                 TO  PI-MAINT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 109
* EL650.cbl
  5502     MOVE XCTL-6501              TO  PGM-NAME.
  5503
  5504     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 110
* EL650.cbl
  5506 2000-CHANGE-ACCOUNT.
  5507     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5508
  5509     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5510
  5511     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5512
  5513     IF NOT EMI-NO-ERRORS
  5514         GO TO 8200-SEND-DATAONLY.
  5515
  5516     SET T-INDEX TO LINEI.
  5517
  5518     IF PI-2ND-PAGE
  5519         SET T-INDEX  UP  BY  8
  5520     ELSE
  5521     IF PI-3RD-PAGE
  5522         SET T-INDEX  UP  BY  16
  5523     ELSE
  5524     IF PI-LST-PAGE
  5525         SET T-INDEX  UP  BY  24.
  5526
  5527     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5528     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5529     MOVE MAINTI                   TO  PI-MAINT.
  5530     MOVE XCTL-6501                TO  PGM-NAME.
  5531
  5532     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 111
* EL650.cbl
  5534 2500-DELETE-ACCOUNT.
  5535     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  5536
  5537     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  5538
  5539     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  5540
  5541     IF NOT EMI-NO-ERRORS
  5542         GO TO 8200-SEND-DATAONLY.
  5543
  5544     SET T-INDEX                 TO  LINEI.
  5545
  5546     IF PI-2ND-PAGE
  5547         SET T-INDEX  UP  BY  8
  5548     ELSE
  5549     IF PI-3RD-PAGE
  5550         SET T-INDEX  UP  BY  16
  5551     ELSE
  5552     IF PI-LST-PAGE
  5553         SET T-INDEX  UP  BY  24.
  5554
  5555     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT
  5556                                       BIN-MAX-DATE.
  5557     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5558     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  BIN-MIN-DATE.
  5559     MOVE '1'                      TO  FROM-WHERE-SW.
  5560
  5561     PERFORM 2550-CHECK-HI-LO-DATES  THRU  2550-EXIT
  5562       VARYING  T-INDEX  FROM  +1  BY  +1
  5563         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  5564
  5565     MOVE SPACE                  TO  FROM-WHERE-SW.
  5566
  5567     IF NOT EMI-NO-ERRORS
  5568         GO TO 8200-SEND-DATAONLY.
  5569
  5570     SET T-INDEX TO LINEI.
  5571
  5572     IF PI-2ND-PAGE
  5573         SET T-INDEX  UP  BY  8
  5574     ELSE
  5575     IF PI-3RD-PAGE
  5576         SET T-INDEX  UP  BY  16
  5577     ELSE
  5578     IF PI-LST-PAGE
  5579         SET T-INDEX  UP  BY  24.
  5580
  5581
  5582* EXEC CICS  READ
  5583*        UPDATE
  5584*        DATASET  (PI-ACCT-ID)
  5585*        SET      (ADDRESS OF ACCOUNT-MASTER)
  5586*        RIDFLD   (PI-ACCT-KEY)
  5587*    END-EXEC.
  5588*    MOVE '&"S        EU         (   #00005510' TO DFHEIV0
  5589     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5590     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5591     MOVE X'2020233030303035353130' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 112
* EL650.cbl
  5592     CALL 'kxdfhei1' USING DFHEIV0,
  5593           PI-ACCT-ID,
  5594           DFHEIV20,
  5595           DFHEIV99,
  5596           PI-ACCT-KEY,
  5597           DFHEIV99,
  5598           DFHEIV99,
  5599           DFHEIV99
  5600     SET ADDRESS OF ACCOUNT-MASTER TO
  5601         DFHEIV20
  5602     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5603
  5604
  5605     IF PI-BIN-LO-CERT (T-INDEX)  NOT =  LOW-VALUES  OR
  5606        PI-BIN-HI-CERT (T-INDEX)  NOT =  LOW-VALUES
  5607         MOVE ER-2070            TO  EMI-ERROR
  5608         MOVE -1                 TO  MAINTL
  5609         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5610         GO TO 8200-SEND-DATAONLY.
  5611
  5612     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  5613         MOVE 'N'                TO  PENDING-BUSINESS-SW
  5614     ELSE
  5615         PERFORM 2560-CHECK-PENDING-BUSINESS  THRU  2569-EXIT.
  5616
  5617     IF THERE-IS-PENDING-BUSINESS
  5618         MOVE ER-1612            TO  EMI-ERROR
  5619         MOVE -1                 TO  MAINTL
  5620         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5621         GO TO 8200-SEND-DATAONLY.
  5622
  5623     MOVE AM-CONTROL-PRIMARY     TO  B4-ACCT-KEY.
  5624     MOVE AM-EFFECTIVE-DT        TO  B4-ACCT-EFF-DT.
  5625
  5626     if pi-el650-del-sw = 'Y'
  5627        move ' '                 to pi-el650-del-sw
  5628     else
  5629        move 'Y'                 to pi-el650-del-sw
  5630        move er-1299             to emi-error
  5631        perform 9900-error-format thru 9900-exit
  5632*       MOVE 1 TO PI-PAGE-NUMBER
  5633        move spaces              to mainto
  5634        MOVE -1                  TO MAINTL
  5635        GO TO 1000-SHOW-ACCOUNT
  5636     end-if
  5637     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  5638
  5639****** DO NOT DELETE PLAN MASTER RECORDS IF MORE ACCT DATE RANGES
  5640     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  5641         NEXT SENTENCE
  5642     ELSE
  5643         IF PI-TOTAL-LINES  = 1
  5644             PERFORM 4800-DELETE-PLAN-REC   THRU  4899-EXIT
  5645         end-if
  5646     end-if
  5647
  5648     MOVE 'D'                    TO  JP-RECORD-TYPE
  5649     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 113
* EL650.cbl
  5650
  5651
  5652* EXEC CICS  DELETE
  5653*        DATASET  (PI-ACCT-ID)
  5654*    END-EXEC
  5655*    MOVE '&(                    &   #00005563' TO DFHEIV0
  5656     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5657     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5658     MOVE X'2020233030303035353633' TO DFHEIV0(25:11)
  5659     CALL 'kxdfhei1' USING DFHEIV0,
  5660           PI-ACCT-ID,
  5661           DFHEIV99,
  5662           DFHEIV99,
  5663           DFHEIV99,
  5664           DFHEIV99
  5665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5666
  5667     PERFORM 8400-LOG-JOURNAL-RECORD
  5668
  5669     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT
  5670
  5671     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  5672                                     PI-ACCT-REST-OF-EXP
  5673                                     LINEO
  5674     MOVE ER-0000                TO  EMI-ERROR
  5675
  5676     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  5677
  5678     IF PI-TOTAL-LINES  = 1
  5679         MOVE LOW-VALUES         TO  PI-DATE-RANGE-TABLE
  5680         MOVE ZEROS              TO  PI-TOTAL-LINES
  5681         MOVE 1                  TO  PI-PAGE-NUMBER
  5682         GO TO 7000-BUILD-OUTPUT-MAP
  5683     end-if
  5684     GO TO 1002-SHOW-NEW-RECORDS.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 114
* EL650.cbl
  5686 2550-CHECK-HI-LO-DATES.
  5687     IF FROM-CHANGE
  5688         GO TO 2550-CHECK-CHANGE.
  5689
  5690     IF PI-BIN-LO-CERT (T-INDEX)  =  LOW-VALUES  AND
  5691        PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  5692         GO TO 2550-CHECK-AR-DELETE.
  5693
  5694     IF ((PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-MIN-DATE AND
  5695          PI-BIN-HI-CERT (T-INDEX) LESS BIN-MAX-DATE)
  5696       OR
  5697         (PI-BIN-LO-CERT (T-INDEX) NOT LESS BIN-MIN-DATE AND
  5698          PI-BIN-LO-CERT (T-INDEX) LESS BIN-MAX-DATE))
  5699       AND
  5700            (PI-PROCESSOR-ID  NOT =  'LGXX')
  5701         MOVE ER-2087            TO  EMI-ERROR
  5702         MOVE -1                 TO  MAINTL
  5703         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5704
  5705 2550-CHECK-AR-DELETE.
  5706     IF NOT PI-AR-PROCESSING
  5707         GO TO 2550-EXIT.
  5708
  5709     IF T-INDEX NOT = LINEI
  5710         GO TO 2550-EXIT.
  5711
  5712     IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES OR SPACES
  5713        GO TO 2550-EXIT.
  5714
  5715     MOVE ER-3155                TO  EMI-ERROR
  5716     MOVE -1                     TO  MAINTL
  5717     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5718
  5719 2550-CHECK-CHANGE.
  5720     IF PI-BIN-HI-CERT (T-INDEX)  = LOW-VALUES OR SPACES
  5721         GO TO 2550-CHECK-AR-CHANGE.
  5722
  5723     IF PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-MAX-DATE
  5724         MOVE ER-2113            TO  EMI-ERROR
  5725         MOVE -1                 TO  MAINTL
  5726         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5727
  5728 2550-CHECK-AR-CHANGE.
  5729      IF NOT PI-AR-PROCESSING
  5730          GO TO 2550-EXIT.
  5731
  5732      IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES
  5733          GO TO 2550-EXIT.
  5734
  5735      IF PI-BIN-AR-HI-CERT (T-INDEX) NOT LESS BIN-MAX-DATE
  5736         MOVE ER-3155            TO  EMI-ERROR
  5737         MOVE -1                 TO  MAINTL
  5738         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5739
  5740 2550-EXIT.
  5741     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 115
* EL650.cbl
  5743 2560-CHECK-PENDING-BUSINESS.
  5744     MOVE 'N'                    TO  PENDING-BUSINESS-SW.
  5745     MOVE LOW-VALUES             TO  ERPNDB-KEY
  5746                                     PI-ERPNDB-ALT-KEY.
  5747     MOVE AM-COMPANY-CD-A1       TO  PNDB-COMPANY-CD-A1
  5748                                     PI-PB-COMPANY-CD-A1.
  5749     MOVE AM-VG-CARRIER          TO  PNDB-CARRIER
  5750                                     PI-PB-CARRIER.
  5751     MOVE AM-VG-GROUPING         TO  PNDB-GROUPING
  5752                                     PI-PB-GROUPING.
  5753     MOVE AM-VG-STATE            TO  PNDB-STATE
  5754                                     PI-PB-STATE.
  5755     MOVE AM-VG-ACCOUNT          TO  PNDB-ACCOUNT
  5756                                     PI-PB-ACCOUNT.
  5757
  5758
  5759* EXEC CICS  HANDLE CONDITION
  5760*         NOTFND   (2568-NO-RECORDS)
  5761*         ENDFILE  (2568-NO-RECORDS)
  5762*    END-EXEC.
  5763*    MOVE '"$I''                  ! % #00005658' TO DFHEIV0
  5764     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5766     MOVE X'2520233030303035363538' TO DFHEIV0(25:11)
  5767     CALL 'kxdfhei1' USING DFHEIV0
  5768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5769
  5770
  5771
  5772* EXEC CICS  STARTBR
  5773*        DATASET  (PEND2-FILE-ID)
  5774*        RIDFLD   (ERPNDB-KEY)
  5775*    END-EXEC.
  5776     MOVE 0
  5777       TO DFHEIV11
  5778*    MOVE '&,         G          &   #00005663' TO DFHEIV0
  5779     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5780     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5781     MOVE X'2020233030303035363633' TO DFHEIV0(25:11)
  5782     CALL 'kxdfhei1' USING DFHEIV0,
  5783           PEND2-FILE-ID,
  5784           ERPNDB-KEY,
  5785           DFHEIV99,
  5786           DFHEIV11,
  5787           DFHEIV99
  5788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5789
  5790
  5791     MOVE 'Y'                    TO  PENDING-BROWSE-SW.
  5792
  5793 2562-READ-NEXT-PENDING.
  5794
  5795* EXEC CICS  READNEXT
  5796*        DATASET  (PEND2-FILE-ID)
  5797*        RIDFLD   (ERPNDB-KEY)
  5798*        SET      (ADDRESS OF PENDING-BUSINESS)
  5799*    END-EXEC.
  5800     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 116
* EL650.cbl
  5801       TO DFHEIV11
  5802*    MOVE '&.S                   )   #00005671' TO DFHEIV0
  5803     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5804     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5805     MOVE X'2020233030303035363731' TO DFHEIV0(25:11)
  5806     CALL 'kxdfhei1' USING DFHEIV0,
  5807           PEND2-FILE-ID,
  5808           DFHEIV20,
  5809           DFHEIV99,
  5810           ERPNDB-KEY,
  5811           DFHEIV99,
  5812           DFHEIV11,
  5813           DFHEIV99,
  5814           DFHEIV99
  5815     SET ADDRESS OF PENDING-BUSINESS TO
  5816         DFHEIV20
  5817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5818
  5819
  5820     IF PB-COMPANY-CD-A1 = PI-PB-COMPANY-CD-A1 AND
  5821        PB-CARRIER       = PI-PB-CARRIER       AND
  5822        PB-GROUPING      = PI-PB-GROUPING      AND
  5823        PB-STATE         = PI-PB-STATE         AND
  5824        PB-ACCOUNT       = PI-PB-ACCOUNT
  5825            NEXT SENTENCE
  5826          ELSE
  5827            GO TO 2568-NO-RECORDS.
  5828
  5829     IF PB-ISSUE
  5830       OR  PB-CANCELLATION
  5831         NEXT SENTENCE
  5832     ELSE
  5833         GO TO 2562-READ-NEXT-PENDING.
  5834
  5835     IF PB-CERT-EFF-DT  IS EQUAL TO  AM-EFFECTIVE-DT
  5836         MOVE 'Y'                TO  PENDING-BUSINESS-SW
  5837         GO TO 2568-NO-RECORDS.
  5838
  5839     IF PB-CERT-EFF-DT  IS GREATER THAN  AM-EFFECTIVE-DT
  5840       AND PB-CERT-EFF-DT  IS LESS THAN  AM-EXPIRATION-DT
  5841         MOVE 'Y'                TO  PENDING-BUSINESS-SW
  5842         GO TO 2568-NO-RECORDS.
  5843
  5844     GO TO 2562-READ-NEXT-PENDING.
  5845
  5846 2568-NO-RECORDS.
  5847     IF PENDING-BROWSE-STARTED
  5848         MOVE ' '                TO  PENDING-BROWSE-SW
  5849
  5850* EXEC CICS ENDBR
  5851*           DATASET  (PEND2-FILE-ID)
  5852*       END-EXEC.
  5853     MOVE 0
  5854       TO DFHEIV11
  5855*    MOVE '&2                    $   #00005706' TO DFHEIV0
  5856     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5857     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5858     MOVE X'2020233030303035373036' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 117
* EL650.cbl
  5859     CALL 'kxdfhei1' USING DFHEIV0,
  5860           PEND2-FILE-ID,
  5861           DFHEIV11,
  5862           DFHEIV99
  5863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5864
  5865
  5866 2569-EXIT.
  5867     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 118
* EL650.cbl
  5869 3000-CHANGE-EXPIRATION.
  5870     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  5871     PERFORM 6200-CHECK-KEY             THRU  6200-EXIT.
  5872     PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT.
  5873     PERFORM 4100-BUILD-VERIFICATION    THRU  4199-EXIT.
  5874
  5875     SET T-INDEX  TO  PI-TOTAL-LINES.
  5876
  5877     PERFORM VARYING WS-INDEX FROM +1 BY +1
  5878             UNTIL  PI-BIN-EXP-DT (T-INDEX)
  5879                        =  WS-ACCT-EXP-DT (WS-INDEX)
  5880                 OR  WS-INDEX GREATER +32
  5881     END-PERFORM.
  5882
  5883     IF PI-BIN-EXP-DT (T-INDEX) = WS-ACCT-EXP-DT (WS-INDEX)
  5884         MOVE BIN-EXPCHG-SAVE    TO  WS-ACCT-EXP-DT (WS-INDEX)
  5885         PERFORM 4300-VERIFY-INTEGRITY THRU 4399-EXIT
  5886             VARYING  WS-INDEX  FROM  +1  BY  +1
  5887               UNTIL  WS-INDEX GREATER +32
  5888     ELSE
  5889         MOVE ER-0453            TO  EMI-ERROR
  5890         MOVE -1                 TO  MAINTL
  5891         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5892
  5893     IF NOT EMI-NO-ERRORS
  5894         GO TO 8200-SEND-DATAONLY.
  5895
  5896     MOVE BIN-EXPCHG-SAVE        TO  BIN-MAX-DATE.
  5897     MOVE '2'                    TO  FROM-WHERE-SW.
  5898
  5899     PERFORM 2550-CHECK-HI-LO-DATES  THRU  2550-EXIT
  5900       VARYING  T-INDEX  FROM  +1  BY  +1
  5901         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  5902
  5903     MOVE SPACE                  TO  FROM-WHERE-SW.
  5904
  5905     IF NOT EMI-NO-ERRORS
  5906         GO TO 8200-SEND-DATAONLY.
  5907
  5908     SET T-INDEX  TO  PI-TOTAL-LINES.
  5909     PERFORM 6010-DATE-CHECK  THRU  6010-EXIT.
  5910
  5911     IF NOT EMI-NO-ERRORS
  5912         GO TO 8200-SEND-DATAONLY.
  5913
  5914     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  5915     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  5916     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  5917     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  5918
  5919     PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT.
  5920
  5921     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  5922                                     AM-VG-EXPIRATION-DT
  5923                                     PI-BIN-EXP-DT (T-INDEX).
  5924     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  5925                                     PI-BIN-MAINT-DT (T-INDEX).
  5926     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 119
* EL650.cbl
  5927     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  5928
  5929     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  5930
  5931     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  5932
  5933     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  5934
  5935     MOVE SPACES                 TO  EXPCHGI.
  5936     MOVE AL-UANOF               TO  EXPCHGA.
  5937     MOVE ER-0000                TO  EMI-ERROR.
  5938
  5939     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  5940
  5941     GO TO 7000-BUILD-OUTPUT-MAP.
  5942
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 120
* EL650.cbl
  5944 3100-DELETE-DATE-RANGE.
  5945
  5946* EXEC CICS GETMAIN
  5947*        LENGTH   (ACCT-REC-LEN)
  5948*        SET      (ADDRESS OF ACCOUNT-MASTER)
  5949*        INITIMG  (GETMAIN-SPACE)
  5950*    END-EXEC.
  5951*    MOVE ',"IL                  $   #00005789' TO DFHEIV0
  5952     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5953     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5954     MOVE X'2020233030303035373839' TO DFHEIV0(25:11)
  5955     CALL 'kxdfhei1' USING DFHEIV0,
  5956           DFHEIV20,
  5957           ACCT-REC-LEN,
  5958           GETMAIN-SPACE
  5959     SET ADDRESS OF ACCOUNT-MASTER TO
  5960         DFHEIV20
  5961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5962
  5963
  5964
  5965* EXEC CICS  HANDLE CONDITION
  5966*        NOTFND   (3175-CONTINUE)
  5967*        ENDFILE  (3175-CONTINUE)
  5968*    END-EXEC.
  5969*    MOVE '"$I''                  ! & #00005795' TO DFHEIV0
  5970     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5971     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5972     MOVE X'2620233030303035373935' TO DFHEIV0(25:11)
  5973     CALL 'kxdfhei1' USING DFHEIV0
  5974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5975
  5976
  5977
  5978
  5979* EXEC CICS  READ
  5980*        UPDATE
  5981*        DATASET  (PI-ACCT-ID)
  5982*        INTO     (ACCOUNT-MASTER)
  5983*        RIDFLD   (PI-ACCT-KEY)
  5984*    END-EXEC.
  5985     MOVE LENGTH OF
  5986      ACCOUNT-MASTER
  5987       TO DFHEIV11
  5988*    MOVE '&"IL       EU         (   #00005801' TO DFHEIV0
  5989     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  5990     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5991     MOVE X'2020233030303035383031' TO DFHEIV0(25:11)
  5992     CALL 'kxdfhei1' USING DFHEIV0,
  5993           PI-ACCT-ID,
  5994           ACCOUNT-MASTER,
  5995           DFHEIV11,
  5996           PI-ACCT-KEY,
  5997           DFHEIV99,
  5998           DFHEIV99,
  5999           DFHEIV99
  6000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6001
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 121
* EL650.cbl
  6002
  6003     MOVE 'D'                    TO  JP-RECORD-TYPE.
  6004     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6005     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6006
  6007
  6008* EXEC CICS  DELETE
  6009*        DATASET  (PI-ACCT-ID)
  6010*    END-EXEC.
  6011*    MOVE '&(                    &   #00005812' TO DFHEIV0
  6012     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  6013     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6014     MOVE X'2020233030303035383132' TO DFHEIV0(25:11)
  6015     CALL 'kxdfhei1' USING DFHEIV0,
  6016           PI-ACCT-ID,
  6017           DFHEIV99,
  6018           DFHEIV99,
  6019           DFHEIV99,
  6020           DFHEIV99
  6021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6022
  6023
  6024     PERFORM 8400-LOG-JOURNAL-RECORD.
  6025
  6026     GO TO 3199-EXIT.
  6027
  6028 3175-CONTINUE.
  6029     IF BROWSE-STARTED
  6030         PERFORM 6320-ENDBR THRU 6320-EXIT.
  6031
  6032     MOVE ER-0226                TO  EMI-ERROR.
  6033
  6034     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6035
  6036     MOVE -1                     TO  MAINTL.
  6037
  6038     GO TO 8200-SEND-DATAONLY.
  6039
  6040 3199-EXIT.
  6041     EXIT.
  6042
  6043 3200-ADD-DATE-RANGE.
  6044     MOVE 'A'                    TO  JP-RECORD-TYPE.
  6045     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6046
  6047
  6048* EXEC CICS  WRITE
  6049*        FROM     (ACCOUNT-MASTER)
  6050*        RIDFLD   (AM-CONTROL-PRIMARY)
  6051*        DATASET  (PI-ACCT-ID)
  6052*    END-EXEC.
  6053     MOVE LENGTH OF
  6054      ACCOUNT-MASTER
  6055       TO DFHEIV11
  6056*    MOVE '&$ L                  ''   #00005839' TO DFHEIV0
  6057     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6058     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6059     MOVE X'2020233030303035383339' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 122
* EL650.cbl
  6060     CALL 'kxdfhei1' USING DFHEIV0,
  6061           PI-ACCT-ID,
  6062           ACCOUNT-MASTER,
  6063           DFHEIV11,
  6064           AM-CONTROL-PRIMARY,
  6065           DFHEIV99,
  6066           DFHEIV99
  6067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6068
  6069
  6070     PERFORM 8400-LOG-JOURNAL-RECORD.
  6071
  6072 3299-EXIT.
  6073     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 123
* EL650.cbl
  6075 3500-CHANGE-EFFECTIVE.
  6076     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  6077
  6078     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  6079
  6080     PERFORM 6000-EDIT-EFFECTIVE-DATE  THRU  6000-EFF-EXIT.
  6081
  6082     IF NOT EMI-NO-ERRORS
  6083         GO TO 8200-SEND-DATAONLY.
  6084
  6085     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  6086
  6087     SET T-INDEX                 TO  +1.
  6088
  6089     PERFORM VARYING  WS-INDEX  FROM  +1  BY  +1
  6090             UNTIL  PI-BIN-EFF-DT (T-INDEX)
  6091                        =  WS-ACCT-EFF-DT (WS-INDEX)
  6092                 OR  WS-INDEX GREATER +32
  6093     END-PERFORM.
  6094
  6095     IF PI-BIN-EFF-DT (T-INDEX)
  6096                 = WS-ACCT-EFF-DT (WS-INDEX)
  6097         MOVE BIN-EFFCHG-SAVE    TO  WS-ACCT-EFF-DT (WS-INDEX)
  6098         PERFORM 4300-VERIFY-INTEGRITY THRU 4399-EXIT
  6099             VARYING  WS-INDEX  FROM  +1  BY  +1
  6100               UNTIL  WS-INDEX GREATER +32
  6101     ELSE
  6102         MOVE ER-0453            TO  EMI-ERROR
  6103         MOVE -1                 TO  MAINTL
  6104         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6105
  6106     IF NOT EMI-NO-ERRORS
  6107         GO TO 8200-SEND-DATAONLY.
  6108
  6109     SET T-INDEX TO  1.
  6110
  6111     PERFORM 6010-DATE-CHECK  THRU  6010-EXIT.
  6112
  6113     IF NOT EMI-NO-ERRORS
  6114         GO TO 8200-SEND-DATAONLY.
  6115
  6116     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  6117     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  6118     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  6119     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  6120
  6121
  6122* EXEC CICS  READ
  6123*        UPDATE
  6124*        DATASET  (PI-ACCT-ID)
  6125*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6126*        RIDFLD   (PI-ACCT-KEY)
  6127*    END-EXEC.
  6128*    MOVE '&"S        EU         (   #00005896' TO DFHEIV0
  6129     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6130     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6131     MOVE X'2020233030303035383936' TO DFHEIV0(25:11)
  6132     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 124
* EL650.cbl
  6133           PI-ACCT-ID,
  6134           DFHEIV20,
  6135           DFHEIV99,
  6136           PI-ACCT-KEY,
  6137           DFHEIV99,
  6138           DFHEIV99,
  6139           DFHEIV99
  6140     SET ADDRESS OF ACCOUNT-MASTER TO
  6141         DFHEIV20
  6142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6143
  6144
  6145     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6146     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6147     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6148
  6149     PERFORM 8400-LOG-JOURNAL-RECORD.
  6150
  6151     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT
  6152                                     PI-BIN-EFF-DT (T-INDEX).
  6153     MOVE EFFCHG-SAVE            TO  AM-EFFECT-DT.
  6154     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  6155                                     PI-BIN-MAINT-DT (T-INDEX).
  6156     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  6157     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  6158     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6159     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6160
  6161     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  6162
  6163
  6164* EXEC CICS  REWRITE
  6165*        FROM     (ACCOUNT-MASTER)
  6166*        DATASET  (PI-ACCT-ID)
  6167*    END-EXEC.
  6168     MOVE LENGTH OF
  6169      ACCOUNT-MASTER
  6170       TO DFHEIV11
  6171*    MOVE '&& L                  %   #00005921' TO DFHEIV0
  6172     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6173     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6174     MOVE X'2020233030303035393231' TO DFHEIV0(25:11)
  6175     CALL 'kxdfhei1' USING DFHEIV0,
  6176           PI-ACCT-ID,
  6177           ACCOUNT-MASTER,
  6178           DFHEIV11,
  6179           DFHEIV99
  6180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6181
  6182
  6183     PERFORM 8400-LOG-JOURNAL-RECORD.
  6184
  6185     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  6186
  6187     MOVE SPACES                 TO  EFFCHGO.
  6188
  6189     MOVE ZERO                   TO  EFFCHGL
  6190                                     EXPCHGL.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 125
* EL650.cbl
  6191
  6192     MOVE AL-UANOF               TO  EFFCHGA.
  6193
  6194     MOVE ER-0000                TO  EMI-ERROR.
  6195
  6196     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6197
  6198     GO TO 7000-BUILD-OUTPUT-MAP.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 126
* EL650.cbl
  6200 4000-CHANGE-ALL.
  6201     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  6202
  6203     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  6204
  6205     IF NOT EMI-NO-ERRORS
  6206         GO TO 8200-SEND-DATAONLY.
  6207
  6208     MOVE 1                      TO  PI-LINE-SELECTED.
  6209     MOVE MAINTI                 TO  PI-MAINT.
  6210     MOVE XCTL-6501              TO  PGM-NAME.
  6211
  6212     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 127
* EL650.cbl
  6214 4100-BUILD-VERIFICATION.
  6215     MOVE SPACES                 TO  BROWSE-STARTED-SW.
  6216
  6217     SET WS-INDEX  TO  +1.
  6218
  6219     MOVE 'N'                    TO  WS-ACCT2-FOUND.
  6220     MOVE PI-ACCT-KEY            TO  WS-ACCT-VERIFY-KEY.
  6221     MOVE LOW-VALUES             TO  WS-ACCT-VER-EXP-DT
  6222                                     WS-VERIFY-AREA.
  6223
  6224     IF ST-ACCNT-CNTL  OR
  6225        ACCNT-CNTL
  6226          MOVE SPACES             TO  WS-ACCT-VER-CARR.
  6227
  6228     IF ST-ACCNT-CNTL      OR
  6229        CARR-ST-ACCNT-CNTL OR
  6230        ACCNT-CNTL         OR
  6231        CARR-ACCNT-CNTL
  6232          MOVE SPACES             TO  WS-ACCT-VER-GROUP.
  6233
  6234     IF ACCNT-CNTL OR
  6235        CARR-ACCNT-CNTL
  6236          MOVE SPACES             TO  WS-ACCT-VER-STATE.
  6237
  6238     MOVE WS-ACCT-VERIFY-KEY     TO  WS-SAVE-VERIFY-KEY.
  6239
  6240
  6241* EXEC CICS  HANDLE CONDITION
  6242*        NOTFND   (4175-CONTINUE)
  6243*        ENDFILE  (4175-CONTINUE)
  6244*    END-EXEC.
  6245*    MOVE '"$I''                  ! '' #00005983' TO DFHEIV0
  6246     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6247     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6248     MOVE X'2720233030303035393833' TO DFHEIV0(25:11)
  6249     CALL 'kxdfhei1' USING DFHEIV0
  6250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6251
  6252
  6253
  6254* EXEC CICS  STARTBR
  6255*        DATASET  (ACCT2-FILE-ID)
  6256*        RIDFLD   (WS-ACCT-VERIFY-KEY)
  6257*        GTEQ
  6258*    END-EXEC.
  6259     MOVE 0
  6260       TO DFHEIV11
  6261*    MOVE '&,         G          &   #00005988' TO DFHEIV0
  6262     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6263     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6264     MOVE X'2020233030303035393838' TO DFHEIV0(25:11)
  6265     CALL 'kxdfhei1' USING DFHEIV0,
  6266           ACCT2-FILE-ID,
  6267           WS-ACCT-VERIFY-KEY,
  6268           DFHEIV99,
  6269           DFHEIV11,
  6270           DFHEIV99
  6271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 128
* EL650.cbl
  6272
  6273
  6274     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  6275
  6276 4150-READ-NEXT.
  6277
  6278* EXEC CICS  READNEXT
  6279*        DATASET  (ACCT2-FILE-ID)
  6280*        RIDFLD   (WS-ACCT-VERIFY-KEY)
  6281*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6282*    END-EXEC.
  6283     MOVE 0
  6284       TO DFHEIV11
  6285*    MOVE '&.S                   )   #00005997' TO DFHEIV0
  6286     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6287     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6288     MOVE X'2020233030303035393937' TO DFHEIV0(25:11)
  6289     CALL 'kxdfhei1' USING DFHEIV0,
  6290           ACCT2-FILE-ID,
  6291           DFHEIV20,
  6292           DFHEIV99,
  6293           WS-ACCT-VERIFY-KEY,
  6294           DFHEIV99,
  6295           DFHEIV11,
  6296           DFHEIV99,
  6297           DFHEIV99
  6298     SET ADDRESS OF ACCOUNT-MASTER TO
  6299         DFHEIV20
  6300     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6301
  6302
  6303     MOVE AM-CONTROL-BY-VAR-GRP  TO  WS-TEST-KEY.
  6304
  6305     IF WS-TEST-KEY  NOT = WS-SAVE-VERIFY-KEY
  6306         GO TO 4175-CONTINUE.
  6307
  6308     MOVE 'Y'                    TO  WS-ACCT2-FOUND.
  6309     MOVE AM-CONTROL-PRIMARY     TO  WS-ACCT-KEY (WS-INDEX).
  6310     MOVE AM-VG-EXPIRATION-DT    TO  WS-ACCT-EXP-DT (WS-INDEX).
  6311     MOVE AM-EFFECTIVE-DT        TO  WS-ACCT-EFF-DT (WS-INDEX).
  6312     MOVE AM-HI-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  6313     MOVE '3'                    TO  DC-OPTION-CODE.
  6314
  6315     PERFORM 9700-DATE-CONVERSION.
  6316
  6317     IF DATE-CONVERSION-ERROR
  6318         MOVE LOW-VALUES         TO  WS-ACCT-HI-CERT (WS-INDEX)
  6319     ELSE
  6320         MOVE DC-BIN-DATE-1      TO  WS-ACCT-HI-CERT (WS-INDEX).
  6321
  6322     MOVE AM-LO-CERT-DATE        TO  DC-GREG-DATE-1-YMD.
  6323     MOVE '3'                    TO  DC-OPTION-CODE.
  6324
  6325     PERFORM 9700-DATE-CONVERSION.
  6326
  6327     IF DATE-CONVERSION-ERROR
  6328         MOVE LOW-VALUES         TO  WS-ACCT-LO-CERT (WS-INDEX)
  6329     ELSE
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 129
* EL650.cbl
  6330         MOVE DC-BIN-DATE-1      TO  WS-ACCT-LO-CERT (WS-INDEX).
  6331
  6332     SET WS-INDEX  UP  BY  +1.
  6333
  6334     GO TO 4150-READ-NEXT.
  6335
  6336 4175-CONTINUE.
  6337     IF BROWSE-STARTED
  6338
  6339* EXEC CICS  ENDBR
  6340*            DATASET  (ACCT2-FILE-ID)
  6341*        END-EXEC
  6342     MOVE 0
  6343       TO DFHEIV11
  6344*    MOVE '&2                    $   #00006038' TO DFHEIV0
  6345     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6346     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6347     MOVE X'2020233030303036303338' TO DFHEIV0(25:11)
  6348     CALL 'kxdfhei1' USING DFHEIV0,
  6349           ACCT2-FILE-ID,
  6350           DFHEIV11,
  6351           DFHEIV99
  6352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6353         MOVE SPACES             TO  BROWSE-STARTED-SW.
  6354
  6355 4199-EXIT.
  6356     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 130
* EL650.cbl
  6358 4200-CHECK-VALIDITY.
  6359     IF (BIN-EXPCHG-SAVE GREATER
  6360                    WS-ACCT-EFF-DT (WS-INDEX))
  6361       AND  (BIN-EXPCHG-SAVE NOT GREATER
  6362                    WS-ACCT-EXP-DT (WS-INDEX))
  6363         MOVE ER-2051            TO  EMI-ERROR
  6364         MOVE -1                 TO  EXPCHGL
  6365         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6366
  6367     IF BIN-EFFCHG-SAVE NOT LESS WS-ACCT-EFF-DT (WS-INDEX) AND
  6368        BIN-EFFCHG-SAVE LESS     WS-ACCT-EXP-DT (WS-INDEX)
  6369          MOVE ER-2051            TO  EMI-ERROR
  6370          MOVE -1                 TO  EFFCHGL
  6371          PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6372
  6373 4200-EXIT.
  6374     EXIT.
  6375 4220-DISPLAY-VERI-TABLE.
  6376
  6377     perform varying d1 from +1 by +1 until
  6378        (d1 > +32)
  6379        or (ws-acct-eff-dt (d1) = low-values)
  6380        move ws-acct-eff-dt (d1) to dc-bin-date-1
  6381        move ' '                 to dc-option-code
  6382        perform 9700-date-conversion
  6383        move dc-greg-date-1-edit to ws-display-eff-date
  6384
  6385        move ws-acct-exp-dt (d1) to dc-bin-date-1
  6386        move ' '                 to dc-option-code
  6387        perform 9700-date-conversion
  6388        move dc-greg-date-1-edit to ws-display-exp-date
  6389
  6390        display ' date range ' d1 ' ' ws-display-eff-date
  6391                                  ' ' ws-display-exp-date
  6392     end-perform
  6393
  6394     .
  6395 4220-EXIT.
  6396     EXIT.
  6397
  6398 4300-VERIFY-INTEGRITY.
  6399     set d1 to ws-index
  6400     IF WS-ACCT-EFF-DT (WS-INDEX + 1)  = LOW-VALUES
  6401         SET WS-INDEX  TO  +32
  6402         GO TO 4399-EXIT.
  6403
  6404     IF ((WS-ACCT-EXP-DT (WS-INDEX)  =  BIN-EXPCHG-SAVE)  OR
  6405        (WS-ACCT-EFF-DT (WS-INDEX + 1)  =  BIN-EFFCHG-SAVE))
  6406                  AND
  6407        (WS-ACCT-EXP-DT (WS-INDEX) > WS-ACCT-EFF-DT (WS-INDEX))
  6408         SET WS-INDEX  TO  +33
  6409         GO TO 4399-EXIT.
  6410
  6411     IF (WS-ACCT-EXP-DT (WS-INDEX) NOT GREATER
  6412                    WS-ACCT-EFF-DT (WS-INDEX + 1))
  6413       AND  (WS-ACCT-EXP-DT (WS-INDEX) GREATER
  6414                    WS-ACCT-EFF-DT (WS-INDEX))
  6415         GO TO 4399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 131
* EL650.cbl
  6416
  6417     MOVE ER-2051                TO  EMI-ERROR.
  6418     MOVE -1                     TO  EXPCHGL.
  6419
  6420     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6421
  6422 4399-EXIT.
  6423     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 132
* EL650.cbl
  6425 4500-CREATE-NEW-ACCOUNT.
  6426     PERFORM 6100-BUILD-KEY            THRU 6199-EXIT.
  6427
  6428     PERFORM 6700-VERIFY-STATE-CARRIER THRU 6799-EXIT.
  6429
  6430     IF MAINTI = 'T'
  6431         PERFORM 6000-EDIT-EFFECTIVE-DATE THRU 6000-EFF-EXIT.
  6432
  6433     PERFORM 4100-BUILD-VERIFICATION THRU 4199-EXIT.
  6434
  6435     IF WS-ACCT2-FOUND = 'Y'
  6436         MOVE ER-0561            TO  EMI-ERROR
  6437         MOVE -1                 TO  MAINTL
  6438         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6439
  6440     MOVE SPACES                 TO  GETMAIN-SW.
  6441
  6442     IF NOT EMI-NO-ERRORS
  6443         GO TO 8200-SEND-DATAONLY.
  6444
  6445     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  6446         MOVE ER-0453            TO  EMI-ERROR
  6447         MOVE -1                 TO  MAINTL
  6448         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6449         GO TO 8200-SEND-DATAONLY.
  6450
  6451     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  6452
  6453     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6454                                     PI-ACCT-REST-OF-EXP.
  6455
  6456     PERFORM 6500-READ-ACCT  THRU  6599-EXIT.
  6457
  6458     IF REC-FOUND
  6459         MOVE -1                 TO  ACARIERL
  6460         MOVE ER-0561            TO  EMI-ERROR
  6461         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  6462         GO TO 8200-SEND-DATAONLY.
  6463
  6464     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  6465     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6466                                     PI-ACCT-REST-OF-EXP.
  6467
  6468
  6469* EXEC CICS  HANDLE CONDITION
  6470*        NOTFND   (4530-NOT-FOUND)
  6471*        ENDFILE  (4530-NOT-FOUND)
  6472*    END-EXEC.
  6473*    MOVE '"$I''                  ! ( #00006156' TO DFHEIV0
  6474     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6475     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6476     MOVE X'2820233030303036313536' TO DFHEIV0(25:11)
  6477     CALL 'kxdfhei1' USING DFHEIV0
  6478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6479
  6480
  6481     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  6482
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 133
* EL650.cbl
  6483 4510-READ-NEXT.
  6484     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  6485
  6486     IF PI-ACCT-CCGSA-KEY  NOT = PI-PREV-ACCOUNT
  6487         GO TO 4540-END-COPY.
  6488
  6489     MOVE AM-EXPIRATION-DT       TO  WS-EXP-SAVE.
  6490     MOVE NEW-KEY-SAVE           TO  AM-CONTROL-PRIMARY.
  6491     MOVE LOW-VALUES             TO  AM-CNTRL-B.
  6492     MOVE WS-EXP-SAVE            TO  AM-EXPIRATION-DT.
  6493
  6494     PERFORM 6400-BUILD-VG-KEY  THRU  6499-EXIT.
  6495
  6496     IF MAINTI  = 'T'
  6497         MOVE '2'                TO  AM-STATUS
  6498         MOVE AM-ACCOUNT         TO  AM-AGT (1)
  6499         MOVE PI-ACCT-CARRIER    TO  AM-TRNFROM-CARRIER
  6500         MOVE PI-ACCT-GROUPING   TO  AM-TRNFROM-GROUPING
  6501         MOVE PI-ACCT-STATE      TO  AM-TRNFROM-STATE
  6502         MOVE PI-ACCT-ACCOUNT    TO  AM-TRNFROM-ACCOUNT
  6503         MOVE BIN-EFFCHG-SAVE    TO  AM-TRNFROM-DTE
  6504     ELSE
  6505         MOVE LOW-VALUES         TO  AM-AR-HI-CERT-DATE
  6506         MOVE ZEROS              TO  AM-HI-CERT-DATE
  6507                                     AM-LO-CERT-DATE
  6508         MOVE SPACES             TO  AM-1ST-PROD-DATE
  6509                                     AM-PREV-DATES
  6510                                     AM-ORIG-DEALER-NO
  6511     END-IF
  6512
  6513     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE.
  6514     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6515     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6516     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6517
  6518     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  6519
  6520     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6521     MOVE 'A'                    TO  JP-RECORD-TYPE.
  6522
  6523     PERFORM 6320-ENDBR THRU 6320-EXIT.
  6524
  6525
  6526* EXEC CICS GETMAIN
  6527*        LENGTH   (ACCT-REC-LEN)
  6528*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6529*        INITIMG  (GETMAIN-SPACE)
  6530*    END-EXEC.
  6531*    MOVE ',"IL                  $   #00006205' TO DFHEIV0
  6532     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6533     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6534     MOVE X'2020233030303036323035' TO DFHEIV0(25:11)
  6535     CALL 'kxdfhei1' USING DFHEIV0,
  6536           DFHEIV20,
  6537           ACCT-REC-LEN,
  6538           GETMAIN-SPACE
  6539     SET ADDRESS OF ACCOUNT-MASTER TO
  6540         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 134
* EL650.cbl
  6541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6542
  6543
  6544     MOVE JP-RECORD-AREA         TO  ACCOUNT-MASTER.
  6545
  6546
  6547* EXEC CICS  WRITE
  6548*        DATASET  (PI-ACCT-ID)
  6549*        RIDFLD   (AM-CONTROL-PRIMARY)
  6550*        FROM     (ACCOUNT-MASTER)
  6551*    END-EXEC.
  6552     MOVE LENGTH OF
  6553      ACCOUNT-MASTER
  6554       TO DFHEIV11
  6555*    MOVE '&$ L                  ''   #00006213' TO DFHEIV0
  6556     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6557     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6558     MOVE X'2020233030303036323133' TO DFHEIV0(25:11)
  6559     CALL 'kxdfhei1' USING DFHEIV0,
  6560           PI-ACCT-ID,
  6561           ACCOUNT-MASTER,
  6562           DFHEIV11,
  6563           AM-CONTROL-PRIMARY,
  6564           DFHEIV99,
  6565           DFHEIV99
  6566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6567
  6568
  6569     MOVE PI-ACCT-ID             TO  FILE-ID.
  6570
  6571     PERFORM 8400-LOG-JOURNAL-RECORD.
  6572
  6573     PERFORM 6300-STARTBR  THRU 6300-EXIT.
  6574     PERFORM 6310-READNEXT THRU 6310-EXIT.
  6575
  6576     GO TO 4510-READ-NEXT.
  6577
  6578 4530-NOT-FOUND.
  6579     IF BROWSE-STARTED
  6580         PERFORM 6320-ENDBR THRU 6320-EXIT.
  6581
  6582     MOVE ER-0226                TO  EMI-ERROR.
  6583
  6584     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6585
  6586     MOVE -1                     TO  MAINTL.
  6587
  6588     GO TO 8200-SEND-DATAONLY.
  6589
  6590 4540-END-COPY.
  6591     IF MAINTI = 'K'
  6592         IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  6593             NEXT SENTENCE
  6594         ELSE
  6595             PERFORM 4600-ADD-ERPLAN-RECORD THRU 4699-EXIT.
  6596
  6597     IF BROWSE-STARTED
  6598         PERFORM 6320-ENDBR THRU 6320-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 135
* EL650.cbl
  6599
  6600     IF MAINTI  NOT = 'T'
  6601         GO TO 4590-SHOW-NEW-ACCOUNT.
  6602
  6603     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  6604     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  6605                                     PI-ACCT-REST-OF-EXP.
  6606
  6607     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  6608
  6609 4550-READ-NEXT.
  6610     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  6611
  6612     IF PI-ACCT-CCGSA-KEY  NOT =  PI-PREV-ACCOUNT
  6613         GO TO 4570-END-REWRITE.
  6614
  6615
  6616* EXEC CICS  READ
  6617*        UPDATE
  6618*        DATASET  (PI-ACCT-ID)
  6619*        SET      (ADDRESS OF ACCOUNT-MASTER)
  6620*        RIDFLD   (PI-ACCT-KEY)
  6621*    END-EXEC.
  6622*    MOVE '&"S        EU         (   #00006265' TO DFHEIV0
  6623     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6624     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6625     MOVE X'2020233030303036323635' TO DFHEIV0(25:11)
  6626     CALL 'kxdfhei1' USING DFHEIV0,
  6627           PI-ACCT-ID,
  6628           DFHEIV20,
  6629           DFHEIV99,
  6630           PI-ACCT-KEY,
  6631           DFHEIV99,
  6632           DFHEIV99,
  6633           DFHEIV99
  6634     SET ADDRESS OF ACCOUNT-MASTER TO
  6635         DFHEIV20
  6636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6637
  6638
  6639     MOVE 'B'                    TO  JP-RECORD-TYPE.
  6640     MOVE ACCT-FILE-ID           TO  FILE-ID.
  6641     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6642
  6643     PERFORM 8400-LOG-JOURNAL-RECORD.
  6644
  6645     MOVE NEW-KEY-CNTRL          TO  AM-TRANSFERRED-TO.
  6646     MOVE BIN-EFFCHG-SAVE        TO  AM-TRNTO-DTE.
  6647     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  6648     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  6649     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  6650     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  6651     MOVE 'C'                    TO  JP-RECORD-TYPE.
  6652
  6653
  6654* EXEC CICS  REWRITE
  6655*        DATASET  (PI-ACCT-ID)
  6656*        FROM     (ACCOUNT-MASTER)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 136
* EL650.cbl
  6657*    END-EXEC.
  6658     MOVE LENGTH OF
  6659      ACCOUNT-MASTER
  6660       TO DFHEIV11
  6661*    MOVE '&& L                  %   #00006286' TO DFHEIV0
  6662     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6663     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6664     MOVE X'2020233030303036323836' TO DFHEIV0(25:11)
  6665     CALL 'kxdfhei1' USING DFHEIV0,
  6666           PI-ACCT-ID,
  6667           ACCOUNT-MASTER,
  6668           DFHEIV11,
  6669           DFHEIV99
  6670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6671
  6672
  6673     MOVE PI-ACCT-ID             TO  FILE-ID.
  6674
  6675     PERFORM 8400-LOG-JOURNAL-RECORD.
  6676
  6677     GO TO 4550-READ-NEXT.
  6678
  6679 4570-END-REWRITE.
  6680     IF BROWSE-STARTED
  6681         PERFORM 6320-ENDBR  THRU  6320-EXIT.
  6682
  6683     MOVE SPACES                 TO  MAINTI
  6684                                     EFFCHGI.
  6685     MOVE AL-UANOF               TO  EFFCHGA.
  6686
  6687 4590-SHOW-NEW-ACCOUNT.
  6688     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  6689
  6690     MOVE NEW-KEY-SAVE           TO  PI-PREV-ACCOUNT
  6691                                     PI-ACCT-CCGSA-KEY.
  6692
  6693     MOVE -1                     TO  MAINTL.
  6694     MOVE ER-0000                TO  EMI-ERROR.
  6695
  6696     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  6697
  6698     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT.
  6699
  6700     GO TO 1002-SHOW-NEW-RECORDS.
  6701
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 137
* EL650.cbl
  6703 4600-ADD-ERPLAN-RECORD.
  6704
  6705* EXEC CICS  HANDLE CONDITION
  6706*        NOTFND   (4699-EXIT)
  6707*        ENDFILE  (4689-EOF)
  6708*    END-EXEC.
  6709*    MOVE '"$I''                  ! ) #00006322' TO DFHEIV0
  6710     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6711     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6712     MOVE X'2920233030303036333232' TO DFHEIV0(25:11)
  6713     CALL 'kxdfhei1' USING DFHEIV0
  6714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6715
  6716
  6717     MOVE LOW-VALUES            TO WS-PLAN-KEY.
  6718     MOVE PI-PREV-ACCOUNT       TO EK-CCGSA-KEY.
  6719
  6720     PERFORM 4700-STARTBR-PLAN THRU 4700-EXIT.
  6721
  6722 4610-READ-NEXT.
  6723     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6724
  6725     IF EK-CCGSA-KEY NOT = PI-PREV-ACCOUNT
  6726         GO TO 4689-EOF.
  6727
  6728     MOVE NEW-KEY-SAVE           TO  PL-CONTROL-PRIMARY.
  6729
  6730     MOVE EK-BTYPE               TO  PL-BENEFIT-TYPE.
  6731     MOVE EK-BCODE               TO  PL-BENEFIT-CODE.
  6732     MOVE EK-REVISION            TO  PL-REVISION-NO.
  6733
  6734     MOVE PL-CONTROL-PRIMARY     TO  PL-CONTROL-BY-VAR-GRP.
  6735
  6736     MOVE PLAN-MASTER            TO  JP-RECORD-AREA.
  6737
  6738
  6739* EXEC CICS  ENDBR
  6740*        DATASET  (PLAN-FILE-ID)
  6741*    END-EXEC.
  6742     MOVE 0
  6743       TO DFHEIV11
  6744*    MOVE '&2                    $   #00006348' TO DFHEIV0
  6745     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6746     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6747     MOVE X'2020233030303036333438' TO DFHEIV0(25:11)
  6748     CALL 'kxdfhei1' USING DFHEIV0,
  6749           PLAN-FILE-ID,
  6750           DFHEIV11,
  6751           DFHEIV99
  6752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6753
  6754
  6755
  6756* EXEC CICS GETMAIN
  6757*        LENGTH   (PLAN-REC-LEN)
  6758*        SET      (ADDRESS OF PLAN-MASTER)
  6759*        INITIMG  (GETMAIN-SPACE)
  6760*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 138
* EL650.cbl
  6761*    MOVE ',"IL                  $   #00006352' TO DFHEIV0
  6762     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6763     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6764     MOVE X'2020233030303036333532' TO DFHEIV0(25:11)
  6765     CALL 'kxdfhei1' USING DFHEIV0,
  6766           DFHEIV20,
  6767           PLAN-REC-LEN,
  6768           GETMAIN-SPACE
  6769     SET ADDRESS OF PLAN-MASTER TO
  6770         DFHEIV20
  6771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6772
  6773
  6774     MOVE JP-RECORD-AREA         TO PLAN-MASTER.
  6775
  6776
  6777* EXEC CICS  WRITE
  6778*        DATASET  (PLAN-FILE-ID)
  6779*        RIDFLD   (PL-CONTROL-PRIMARY)
  6780*        FROM     (PLAN-MASTER)
  6781*    END-EXEC.
  6782     MOVE LENGTH OF
  6783      PLAN-MASTER
  6784       TO DFHEIV11
  6785*    MOVE '&$ L                  ''   #00006360' TO DFHEIV0
  6786     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6787     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6788     MOVE X'2020233030303036333630' TO DFHEIV0(25:11)
  6789     CALL 'kxdfhei1' USING DFHEIV0,
  6790           PLAN-FILE-ID,
  6791           PLAN-MASTER,
  6792           DFHEIV11,
  6793           PL-CONTROL-PRIMARY,
  6794           DFHEIV99,
  6795           DFHEIV99
  6796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6797
  6798
  6799     PERFORM 4700-STARTBR-PLAN  THRU 4700-EXIT.
  6800     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6801
  6802     GO TO 4610-READ-NEXT.
  6803
  6804 4689-EOF.
  6805
  6806* EXEC CICS  ENDBR
  6807*        DATASET  (PLAN-FILE-ID)
  6808*    END-EXEC.
  6809     MOVE 0
  6810       TO DFHEIV11
  6811*    MOVE '&2                    $   #00006372' TO DFHEIV0
  6812     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6813     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6814     MOVE X'2020233030303036333732' TO DFHEIV0(25:11)
  6815     CALL 'kxdfhei1' USING DFHEIV0,
  6816           PLAN-FILE-ID,
  6817           DFHEIV11,
  6818           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 139
* EL650.cbl
  6819     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6820
  6821
  6822 4699-EXIT.
  6823      EXIT.
  6824
  6825 4700-STARTBR-PLAN.
  6826
  6827* EXEC CICS  STARTBR
  6828*        DATASET  (PLAN-FILE-ID)
  6829*        RIDFLD   (WS-PLAN-KEY)
  6830*    END-EXEC.
  6831     MOVE 0
  6832       TO DFHEIV11
  6833*    MOVE '&,         G          &   #00006380' TO DFHEIV0
  6834     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6835     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6836     MOVE X'2020233030303036333830' TO DFHEIV0(25:11)
  6837     CALL 'kxdfhei1' USING DFHEIV0,
  6838           PLAN-FILE-ID,
  6839           WS-PLAN-KEY,
  6840           DFHEIV99,
  6841           DFHEIV11,
  6842           DFHEIV99
  6843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6844
  6845
  6846 4700-EXIT.
  6847      EXIT.
  6848
  6849 4710-READNEXT-PLAN.
  6850
  6851* EXEC CICS  READNEXT
  6852*        DATASET  (PLAN-FILE-ID)
  6853*        SET      (ADDRESS OF PLAN-MASTER)
  6854*        RIDFLD   (WS-PLAN-KEY)
  6855*    END-EXEC.
  6856     MOVE 0
  6857       TO DFHEIV11
  6858*    MOVE '&.S                   )   #00006389' TO DFHEIV0
  6859     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6860     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6861     MOVE X'2020233030303036333839' TO DFHEIV0(25:11)
  6862     CALL 'kxdfhei1' USING DFHEIV0,
  6863           PLAN-FILE-ID,
  6864           DFHEIV20,
  6865           DFHEIV99,
  6866           WS-PLAN-KEY,
  6867           DFHEIV99,
  6868           DFHEIV11,
  6869           DFHEIV99,
  6870           DFHEIV99
  6871     SET ADDRESS OF PLAN-MASTER TO
  6872         DFHEIV20
  6873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6874
  6875
  6876 4710-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 140
* EL650.cbl
  6877      EXIT.
  6878
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 141
* EL650.cbl
  6880 4800-DELETE-PLAN-REC.
  6881
  6882* EXEC CICS  HANDLE CONDITION
  6883*        NOTFND   (4899-EXIT)
  6884*        ENDFILE  (4889-EOF)
  6885*    END-EXEC.
  6886*    MOVE '"$I''                  ! * #00006400' TO DFHEIV0
  6887     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6889     MOVE X'2A20233030303036343030' TO DFHEIV0(25:11)
  6890     CALL 'kxdfhei1' USING DFHEIV0
  6891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6892
  6893
  6894     MOVE LOW-VALUES            TO WS-PLAN-KEY.
  6895     MOVE AM-CONTROL-PRIMARY    TO EK-CCGSA-KEY
  6896                                   PI-PREV-ACCOUNT.
  6897
  6898 4805-STARTBR.
  6899     PERFORM 4700-STARTBR-PLAN THRU 4700-EXIT.
  6900
  6901 4810-READ-NEXT.
  6902     PERFORM 4710-READNEXT-PLAN THRU 4710-EXIT.
  6903
  6904     IF EK-CCGSA-KEY NOT = PI-PREV-ACCOUNT
  6905         GO TO 4889-EOF.
  6906
  6907
  6908* EXEC CICS  ENDBR
  6909*        DATASET  (PLAN-FILE-ID)
  6910*    END-EXEC.
  6911     MOVE 0
  6912       TO DFHEIV11
  6913*    MOVE '&2                    $   #00006418' TO DFHEIV0
  6914     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6915     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6916     MOVE X'2020233030303036343138' TO DFHEIV0(25:11)
  6917     CALL 'kxdfhei1' USING DFHEIV0,
  6918           PLAN-FILE-ID,
  6919           DFHEIV11,
  6920           DFHEIV99
  6921     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6922
  6923
  6924
  6925* EXEC CICS  READ
  6926*        UPDATE
  6927*        DATASET  (PLAN-FILE-ID)
  6928*        SET      (ADDRESS OF PLAN-MASTER)
  6929*        RIDFLD   (WS-PLAN-KEY)
  6930*    END-EXEC.
  6931*    MOVE '&"S        EU         (   #00006422' TO DFHEIV0
  6932     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6933     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6934     MOVE X'2020233030303036343232' TO DFHEIV0(25:11)
  6935     CALL 'kxdfhei1' USING DFHEIV0,
  6936           PLAN-FILE-ID,
  6937           DFHEIV20,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 142
* EL650.cbl
  6938           DFHEIV99,
  6939           WS-PLAN-KEY,
  6940           DFHEIV99,
  6941           DFHEIV99,
  6942           DFHEIV99
  6943     SET ADDRESS OF PLAN-MASTER TO
  6944         DFHEIV20
  6945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6946
  6947
  6948
  6949* EXEC CICS  DELETE
  6950*        DATASET  (PLAN-FILE-ID)
  6951*    END-EXEC.
  6952*    MOVE '&(                    &   #00006429' TO DFHEIV0
  6953     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  6954     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6955     MOVE X'2020233030303036343239' TO DFHEIV0(25:11)
  6956     CALL 'kxdfhei1' USING DFHEIV0,
  6957           PLAN-FILE-ID,
  6958           DFHEIV99,
  6959           DFHEIV99,
  6960           DFHEIV99,
  6961           DFHEIV99
  6962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6963
  6964
  6965     GO TO 4805-STARTBR.
  6966
  6967 4889-EOF.
  6968
  6969* EXEC CICS  ENDBR
  6970*        DATASET  (PLAN-FILE-ID)
  6971*    END-EXEC.
  6972     MOVE 0
  6973       TO DFHEIV11
  6974*    MOVE '&2                    $   #00006436' TO DFHEIV0
  6975     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6976     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6977     MOVE X'2020233030303036343336' TO DFHEIV0(25:11)
  6978     CALL 'kxdfhei1' USING DFHEIV0,
  6979           PLAN-FILE-ID,
  6980           DFHEIV11,
  6981           DFHEIV99
  6982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6983
  6984
  6985 4899-EXIT.
  6986      EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 143
* EL650.cbl
  6988 4900-CREATE-NEW-ACCOUNT.
  6989     PERFORM 6100-BUILD-KEY             THRU  6199-EXIT.
  6990
  6991     SET T-INDEX                 TO  LINEI.
  6992
  6993     IF PI-2ND-PAGE
  6994         SET T-INDEX  UP  BY  8
  6995     ELSE
  6996     IF PI-3RD-PAGE
  6997         SET T-INDEX  UP  BY  16
  6998     ELSE
  6999     IF PI-LST-PAGE
  7000         SET T-INDEX  UP  BY  24.
  7001
  7002     IF EFFCHGL NOT =  ZERO
  7003         PERFORM 6000-EDIT-EFFECTIVE-DATE   THRU  6000-EFF-EXIT
  7004       ELSE
  7005         MOVE PI-BIN-EFF-DT (T-INDEX)  TO  BIN-EFFCHG-SAVE.
  7006
  7007     IF EXPCHGL NOT =  ZERO
  7008         PERFORM 6000-EDIT-EXPIRATION-DATE  THRU  6000-EXP-EXIT
  7009       ELSE
  7010         MOVE PI-BIN-EXP-DT (T-INDEX)  TO  BIN-EXPCHG-SAVE.
  7011
  7012     PERFORM 6700-VERIFY-STATE-CARRIER  THRU  6799-EXIT.
  7013
  7014     IF BIN-EXPCHG-SAVE NOT GREATER BIN-EFFCHG-SAVE
  7015         MOVE -1                 TO  EXPCHGL
  7016         MOVE ER-1228            TO  EMI-ERROR
  7017         MOVE AL-UABON           TO  EXPCHGA
  7018         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7019
  7020     PERFORM 6000-EDIT-LINE  THRU  6000-LIN-EXIT.
  7021
  7022     IF EMI-ERROR  NOT = ZEROS
  7023         GO TO 8200-SEND-DATAONLY.
  7024
  7025     MOVE SPACES                 TO  GETMAIN-SW.
  7026
  7027     IF NOT EMI-NO-ERRORS
  7028         GO TO 8200-SEND-DATAONLY.
  7029
  7030     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  7031         MOVE ER-0453            TO  EMI-ERROR
  7032         MOVE -1                 TO  MAINTL
  7033         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7034         GO TO 8200-SEND-DATAONLY.
  7035
  7036     MOVE PI-ACCT-CCGSA-KEY      TO  NEW-KEY-SAVE.
  7037
  7038     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  7039
  7040     PERFORM 4200-CHECK-VALIDITY  THRU  4200-EXIT
  7041         VARYING  WS-INDEX  FROM  +1  BY  +1
  7042            UNTIL WS-INDEX GREATER +32.
  7043
  7044     IF NOT EMI-NO-ERRORS
  7045         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 144
* EL650.cbl
  7046
  7047     MOVE PI-PREV-ACCOUNT          TO  PI-ACCT-CCGSA-KEY.
  7048     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7049     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7050
  7051     PERFORM 6500-READ-ACCT     THRU  6599-EXIT.
  7052
  7053     MOVE LOW-VALUES             TO  AM-AR-HI-CERT-DATE
  7054     MOVE ZEROS                  TO  AM-HI-CERT-DATE
  7055                                     AM-LO-CERT-DATE
  7056     MOVE ZEROS                  TO  AM-DCC-MAX-MARKETING-FEE
  7057     MOVE SPACES                 TO  AM-1ST-PROD-DATE
  7058                                     AM-PREV-DATES
  7059                                     AM-ORIG-DEALER-NO
  7060
  7061     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE.
  7062     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  7063     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  7064     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  7065
  7066     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  7067
  7068     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7069     MOVE 'A'                    TO  JP-RECORD-TYPE.
  7070
  7071
  7072* EXEC CICS GETMAIN
  7073*        LENGTH   (ACCT-REC-LEN)
  7074*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7075*        INITIMG  (GETMAIN-SPACE)
  7076*    END-EXEC.
  7077*    MOVE ',"IL                  $   #00006526' TO DFHEIV0
  7078     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7079     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7080     MOVE X'2020233030303036353236' TO DFHEIV0(25:11)
  7081     CALL 'kxdfhei1' USING DFHEIV0,
  7082           DFHEIV20,
  7083           ACCT-REC-LEN,
  7084           GETMAIN-SPACE
  7085     SET ADDRESS OF ACCOUNT-MASTER TO
  7086         DFHEIV20
  7087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7088
  7089
  7090     MOVE JP-RECORD-AREA         TO  ACCOUNT-MASTER.
  7091     MOVE NEW-KEY-SAVE           TO  AM-CONTROL-PRIMARY.
  7092     MOVE LOW-VALUES             TO  AM-CNTRL-B.
  7093     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT.
  7094     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  7095                                     AM-VG-EXPIRATION-DT.
  7096
  7097     PERFORM 6400-BUILD-VG-KEY  THRU  6499-EXIT.
  7098
  7099
  7100* EXEC CICS  HANDLE CONDITION
  7101*        DUPREC   (4580-DUPREC)
  7102*        DUPKEY   (4580-DUPREC)
  7103*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 145
* EL650.cbl
  7104*    MOVE '"$%$                  ! + #00006541' TO DFHEIV0
  7105     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7106     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7107     MOVE X'2B20233030303036353431' TO DFHEIV0(25:11)
  7108     CALL 'kxdfhei1' USING DFHEIV0
  7109     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7110
  7111
  7112
  7113* EXEC CICS  WRITE
  7114*        DATASET  (PI-ACCT-ID)
  7115*        RIDFLD   (AM-CONTROL-PRIMARY)
  7116*        FROM     (ACCOUNT-MASTER)
  7117*    END-EXEC.
  7118     MOVE LENGTH OF
  7119      ACCOUNT-MASTER
  7120       TO DFHEIV11
  7121*    MOVE '&$ L                  ''   #00006546' TO DFHEIV0
  7122     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7123     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7124     MOVE X'2020233030303036353436' TO DFHEIV0(25:11)
  7125     CALL 'kxdfhei1' USING DFHEIV0,
  7126           PI-ACCT-ID,
  7127           ACCOUNT-MASTER,
  7128           DFHEIV11,
  7129           AM-CONTROL-PRIMARY,
  7130           DFHEIV99,
  7131           DFHEIV99
  7132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7133
  7134
  7135     MOVE PI-ACCT-ID             TO  FILE-ID.
  7136
  7137     PERFORM 8400-LOG-JOURNAL-RECORD.
  7138
  7139     IF (PI-COMPANY-ID IS EQUAL TO 'AIG' OR 'AUK')
  7140         NEXT SENTENCE
  7141     ELSE
  7142         PERFORM 4950-ADD-ERPLAN-RECORD THRU 4959-EXIT
  7143         PERFORM 4960-ADD-ERCOMP-RECORD THRU 4969-EXIT.
  7144
  7145 4580-DUPREC.
  7146     MOVE 1                  TO K-WITH-LINE-USED.
  7147     MOVE LOW-VALUES         TO EL650AI.
  7148
  7149     GO TO 4590-SHOW-NEW-ACCOUNT.
  7150
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 146
* EL650.cbl
  7152 4950-ADD-ERPLAN-RECORD.
  7153
  7154* EXEC CICS GETMAIN
  7155*        LENGTH   (PLAN-REC-LEN)
  7156*        SET      (ADDRESS OF PLAN-MASTER)
  7157*        INITIMG  (GETMAIN-SPACE)
  7158*    END-EXEC.
  7159*    MOVE ',"IL                  $   #00006570' TO DFHEIV0
  7160     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7161     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7162     MOVE X'2020233030303036353730' TO DFHEIV0(25:11)
  7163     CALL 'kxdfhei1' USING DFHEIV0,
  7164           DFHEIV20,
  7165           PLAN-REC-LEN,
  7166           GETMAIN-SPACE
  7167     SET ADDRESS OF PLAN-MASTER TO
  7168         DFHEIV20
  7169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7170
  7171
  7172
  7173* EXEC CICS  HANDLE CONDITION
  7174*        DUPREC   (4959-EXIT)
  7175*        DUPKEY   (4959-EXIT)
  7176*    END-EXEC.
  7177*    MOVE '"$%$                  ! , #00006576' TO DFHEIV0
  7178     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7180     MOVE X'2C20233030303036353736' TO DFHEIV0(25:11)
  7181     CALL 'kxdfhei1' USING DFHEIV0
  7182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7183
  7184
  7185     MOVE NEW-KEY-SAVE           TO  PL-CONTROL-PRIMARY.
  7186
  7187     MOVE EK-BTYPE               TO  PL-BENEFIT-TYPE.
  7188     MOVE EK-BCODE               TO  PL-BENEFIT-CODE.
  7189     MOVE EK-REVISION            TO  PL-REVISION-NO.
  7190
  7191     MOVE PL-CONTROL-PRIMARY     TO  PL-CONTROL-BY-VAR-GRP.
  7192
  7193
  7194* EXEC CICS  WRITE
  7195*        DATASET  (PLAN-FILE-ID)
  7196*        RIDFLD   (PL-CONTROL-PRIMARY)
  7197*        FROM     (PLAN-MASTER)
  7198*    END-EXEC.
  7199     MOVE LENGTH OF
  7200      PLAN-MASTER
  7201       TO DFHEIV11
  7202*    MOVE '&$ L                  ''   #00006589' TO DFHEIV0
  7203     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7204     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7205     MOVE X'2020233030303036353839' TO DFHEIV0(25:11)
  7206     CALL 'kxdfhei1' USING DFHEIV0,
  7207           PLAN-FILE-ID,
  7208           PLAN-MASTER,
  7209           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 147
* EL650.cbl
  7210           PL-CONTROL-PRIMARY,
  7211           DFHEIV99,
  7212           DFHEIV99
  7213     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7214
  7215
  7216 4959-EXIT.
  7217     EXIT.
  7218
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 148
* EL650.cbl
  7220 4960-ADD-ERCOMP-RECORD.
  7221
  7222* EXEC CICS GETMAIN
  7223*         LENGTH   (COMP-REC-LEN)
  7224*         SET      (ADDRESS OF COMPENSATION-MASTER)
  7225*         INITIMG  (GETMAIN-SPACE)
  7226*    END-EXEC.
  7227*    MOVE ',"IL                  $   #00006600' TO DFHEIV0
  7228     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7229     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7230     MOVE X'2020233030303036363030' TO DFHEIV0(25:11)
  7231     CALL 'kxdfhei1' USING DFHEIV0,
  7232           DFHEIV20,
  7233           COMP-REC-LEN,
  7234           GETMAIN-SPACE
  7235     SET ADDRESS OF COMPENSATION-MASTER TO
  7236         DFHEIV20
  7237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7238
  7239
  7240     MOVE SPACES                 TO COMPENSATION-MASTER.
  7241     MOVE ZEROS TO CO-BAL-FWD      CO-CUR-COM   CO-CUR-CHG
  7242                   CO-CUR-PMT      CO-END-BAL   CO-CUR
  7243                   CO-OV30         CO-OV60      CO-OV90
  7244                   CO-YTD-COM      CO-YTD-OV    CO-CUR-OVR-UNDR
  7245                   CO-YTD-OVR-UNDR CO-CUR-FICA CO-YTD-FICA
  7246                   CO-LF-CLM-AMT   CO-AH-CLM-AMT
  7247                   CO-CURRENT-BAL-FWD CO-CURRENT-CUR-COM
  7248                   CO-CURRENT-CUR-CHG CO-CURRENT-END-BAL
  7249                   CO-CURRENT-CUR     CO-CURRENT-OV30
  7250                   CO-CURRENT-OV60    CO-CURRENT-OV90
  7251                   CO-CURRENT-CUR-PMT
  7252                   CO-CURRENT-YTD-COM CO-CURRENT-YTD-OV
  7253                   CO-ACT-YEAR        CO-ACT-MONTH
  7254                   CO-ACT-DAY         CO-LAST-STMT-YEAR
  7255                   CO-LAST-STMT-MONTH CO-LAST-STMT-DAY
  7256                   CO-CURRENT-LAST-STMT-YEAR
  7257                   CO-CURRENT-LAST-STMT-MONTH
  7258                   CO-CURRENT-LAST-STMT-DAY
  7259                   CO-YTD-PAID-COM
  7260                   CO-YTD-PAID-OV co-ov120 co-current-ov120
  7261     MOVE BIN-CURRENT-SAVE       TO CO-LAST-MAINT-DT.
  7262     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  7263     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  7264     MOVE PI-CR-MONTH-END-DT     TO CO-ROLADEX-PRINT-DT.
  7265     MOVE PI-COMPANY-CD          TO CO-COMPANY-CD.
  7266
  7267     IF PI-ZERO-CARRIER OR PI-ZERO-CAR-GROUP
  7268         MOVE ZEROS              TO CO-CARRIER
  7269     ELSE
  7270         MOVE AM-CARRIER         TO CO-CARRIER.
  7271
  7272     IF PI-ZERO-GROUPING OR PI-ZERO-CAR-GROUP
  7273         MOVE ZEROS              TO CO-GROUPING
  7274     ELSE
  7275         MOVE AM-GROUPING        TO CO-GROUPING.
  7276
  7277     MOVE 'A'                    TO CO-TYPE.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 149
* EL650.cbl
  7278     MOVE AM-NAME                TO CO-ACCT-NAME.
  7279     MOVE AM-PERSON              TO CO-MAIL-NAME.
  7280     MOVE AM-ADDRS               TO CO-ADDR-1.
  7281*    MOVE AM-CITY                TO CO-ADDR-3.
  7282     MOVE AM-ADDR-CITY           TO CO-ADDR-CITY
  7283     MOVE AM-ADDR-STATE          TO CO-ADDR-STATE
  7284     MOVE AM-ZIP                 TO CO-ZIP.
  7285     MOVE AM-CSR-CODE            TO CO-CSR-CODE.
  7286     MOVE AM-TEL-NO              TO CO-TELEPHONE.
  7287     MOVE AM-ID-NO               TO CO-SOC-SEC.
  7288
  7289     IF AM-REMIT-TO NOT = ZERO
  7290         MOVE AM-AGT (AM-REMIT-TO) TO CO-RESP-NO
  7291       ELSE
  7292         MOVE AM-ACCOUNT           TO CO-RESP-NO.
  7293
  7294     MOVE +0                      TO AGT-SUB.
  7295
  7296     PERFORM 4970-FIND-C-AGT THRU 4970-EXIT.
  7297
  7298     IF VALID-AGT-SW = 'Y'
  7299         NEXT SENTENCE
  7300     ELSE
  7301         GO TO 4969-EXIT.
  7302
  7303     IF CO-RESP-NO = CO-ACCOUNT
  7304         MOVE 'Y'                  TO CO-BALANCE-CONTROL
  7305     ELSE
  7306         MOVE 'N'                  TO CO-BALANCE-CONTROL.
  7307
  7308     IF PI-AR-PROCESSING
  7309        MOVE 'G'                   TO CO-AR-REPORTING
  7310        MOVE '1'                   TO CO-AR-BAL-LEVEL
  7311        MOVE 'Y'                   TO CO-AR-PULL-CHECK
  7312        MOVE 'Y'                   TO CO-AR-NORMAL-PRINT.
  7313
  7314     IF PI-COMPANY-ID = 'CRI' OR 'HER' OR 'HSL'
  7315        MOVE 'N'                   TO CO-AR-REPORTING.
  7316
  7317     IF PI-COMPANY-ID = 'HER' OR 'HSL'
  7318        MOVE '999999'              TO CO-AR-SUMMARY-CODE.
  7319
  7320     PERFORM 4980-ADD-COMPENSATION-NAME THRU 4980-EXIT.
  7321
  7322
  7323* EXEC CICS HANDLE CONDITION
  7324*         DUPREC   (4969-EXIT)
  7325*         DUPKEY   (4969-EXIT)
  7326*    END-EXEC.
  7327*    MOVE '"$%$                  ! - #00006688' TO DFHEIV0
  7328     MOVE X'222425242020202020202020' TO DFHEIV0(1:12)
  7329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7330     MOVE X'2D20233030303036363838' TO DFHEIV0(25:11)
  7331     CALL 'kxdfhei1' USING DFHEIV0
  7332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7333
  7334
  7335
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 150
* EL650.cbl
  7336* EXEC CICS WRITE
  7337*        FROM      (COMPENSATION-MASTER)
  7338*        RIDFLD    (CO-CONTROL-PRIMARY)
  7339*        DATASET   (COMP-FILE-ID)
  7340*    END-EXEC.
  7341     MOVE LENGTH OF
  7342      COMPENSATION-MASTER
  7343       TO DFHEIV11
  7344*    MOVE '&$ L                  ''   #00006693' TO DFHEIV0
  7345     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7346     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7347     MOVE X'2020233030303036363933' TO DFHEIV0(25:11)
  7348     CALL 'kxdfhei1' USING DFHEIV0,
  7349           COMP-FILE-ID,
  7350           COMPENSATION-MASTER,
  7351           DFHEIV11,
  7352           CO-CONTROL-PRIMARY,
  7353           DFHEIV99,
  7354           DFHEIV99
  7355     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7356
  7357
  7358 4969-EXIT.
  7359     EXIT.
  7360
  7361 4970-FIND-C-AGT.
  7362     ADD 1 TO  AGT-SUB.
  7363     IF AGT-SUB GREATER 10
  7364         MOVE 'N'                TO  VALID-AGT-SW
  7365         GO TO 4970-EXIT.
  7366
  7367     IF (AM-COM-TYP (AGT-SUB) = 'C' OR 'D' OR 'F')
  7368         MOVE AM-AGT (AGT-SUB)   TO  CO-ACCOUNT
  7369         MOVE 'Y'                TO  VALID-AGT-SW
  7370         GO TO 4970-EXIT
  7371     ELSE
  7372         GO TO 4970-FIND-C-AGT.
  7373
  7374 4970-EXIT.
  7375     EXIT.
  7376
  7377 4980-ADD-COMPENSATION-NAME.
  7378
  7379* EXEC CICS HANDLE CONDITION
  7380*         DUPREC   (4980-EXIT)
  7381*    END-EXEC.
  7382*    MOVE '"$%                   ! . #00006719' TO DFHEIV0
  7383     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  7384     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7385     MOVE X'2E20233030303036373139' TO DFHEIV0(25:11)
  7386     CALL 'kxdfhei1' USING DFHEIV0
  7387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7388
  7389
  7390
  7391* EXEC CICS GETMAIN
  7392*         LENGTH   (NAME-REC-LEN)
  7393*         SET      (ADDRESS OF NAME-LOOKUP-MASTER)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 151
* EL650.cbl
  7394*         INITIMG  (GETMAIN-SPACE)
  7395*    END-EXEC.
  7396*    MOVE ',"IL                  $   #00006723' TO DFHEIV0
  7397     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7398     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7399     MOVE X'2020233030303036373233' TO DFHEIV0(25:11)
  7400     CALL 'kxdfhei1' USING DFHEIV0,
  7401           DFHEIV20,
  7402           NAME-REC-LEN,
  7403           GETMAIN-SPACE
  7404     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  7405         DFHEIV20
  7406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7407
  7408
  7409     MOVE SPACES                 TO  NAME-LOOKUP-MASTER.
  7410     MOVE BIN-CURRENT-SAVE       TO  NL-LAST-MAINT-DT.
  7411     MOVE PI-PROCESSOR-ID        TO  NL-LAST-MAINT-USER.
  7412     MOVE EIBTIME                TO  NL-LAST-MAINT-HHMMSS.
  7413     MOVE PI-COMPANY-CD          TO  NL-COMPANY-CD.
  7414     MOVE CO-ACCT-NAME           TO  NL-NAME.
  7415     MOVE CO-ADDR-CITY           TO  NL-CITY
  7416     MOVE CO-ADDR-STATE          TO  NL-ST
  7417     MOVE 'C'                    TO  NL-RECORD-TYPE.
  7418     MOVE PI-COMPANY-CD          TO  NL-CO-COMPANY-CD.
  7419     MOVE CO-CARRIER             TO  NL-CO-CARRIER.
  7420     MOVE CO-GROUPING            TO  NL-CO-GROUPING.
  7421     MOVE CO-RESP-NO             TO  NL-CO-RESP-NO.
  7422     MOVE CO-ACCOUNT             TO  NL-CO-ACCOUNT.
  7423     MOVE CO-TYPE                TO  NL-CO-TYPE.
  7424
  7425
  7426* EXEC CICS WRITE
  7427*        FROM      (NAME-LOOKUP-MASTER)
  7428*        RIDFLD    (NL-CONTROL-PRIMARY)
  7429*        DATASET   (NAME-FILE-ID)
  7430*    END-EXEC.
  7431     MOVE LENGTH OF
  7432      NAME-LOOKUP-MASTER
  7433       TO DFHEIV11
  7434*    MOVE '&$ L                  ''   #00006745' TO DFHEIV0
  7435     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7436     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7437     MOVE X'2020233030303036373435' TO DFHEIV0(25:11)
  7438     CALL 'kxdfhei1' USING DFHEIV0,
  7439           NAME-FILE-ID,
  7440           NAME-LOOKUP-MASTER,
  7441           DFHEIV11,
  7442           NL-CONTROL-PRIMARY,
  7443           DFHEIV99,
  7444           DFHEIV99
  7445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7446
  7447
  7448 4980-EXIT.
  7449     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 152
* EL650.cbl
  7451 5000-CREATE-NEW-RANGE.
  7452
  7453     PERFORM 6100-BUILD-KEY  THRU  6199-EXIT.
  7454     PERFORM 6200-CHECK-KEY  THRU  6200-EXIT.
  7455
  7456     PERFORM 6000-EDIT-EFFECTIVE-DATE  THRU 6000-EFF-EXIT.
  7457     PERFORM 6000-EDIT-EXPIRATION-DATE THRU 6000-EXP-EXIT.
  7458
  7459     SET T-INDEX TO PI-TOTAL-LINES.
  7460
  7461     PERFORM 600A-CHECK-HI-LO-DATES    THRU 600A-EXIT
  7462        VARYING T-INDEX FROM T-INDEX BY +1
  7463         UNTIL  T-INDEX GREATER PI-TOTAL-LINES.
  7464
  7465     IF NOT EMI-NO-ERRORS
  7466         GO TO 8200-SEND-DATAONLY.
  7467
  7468     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7469     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7470
  7471     IF BIN-EFFCHG-SAVE NOT LESS BIN-EXPCHG-SAVE
  7472         MOVE -1                 TO  EFFCHGL EXPCHGL
  7473         MOVE AL-UANON           TO  EFFCHGA EXPCHGA
  7474         MOVE ER-2053            TO  EMI-ERROR
  7475         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7476
  7477     IF NOT EMI-NO-ERRORS
  7478         GO TO 8200-SEND-DATAONLY.
  7479
  7480***************************************************************
  7481*    NO EFFECTIVE DATE ENTERED, WILL USE CURRENT EXPIRATION   *
  7482*    DATE IF WITHIN LIMITS                                    *
  7483***************************************************************
  7484
  7485     IF EFFCHGL = ZERO
  7486         SET T-INDEX             TO  PI-TOTAL-LINES
  7487         IF PI-BIN-EXP-DT (T-INDEX)  =  HIGH-VALUES
  7488             MOVE ER-2060        TO  EMI-ERROR
  7489             MOVE -1             TO  EFFCHGL
  7490             MOVE AL-UABON       TO  EFFCHGA
  7491             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7492             GO TO 8200-SEND-DATAONLY
  7493         ELSE
  7494             IF PI-BIN-EXP-DT (T-INDEX) NOT LESS
  7495                    BIN-EXPCHG-SAVE
  7496                 MOVE ER-2061    TO  EMI-ERROR
  7497                 MOVE -1         TO  EXPCHGL
  7498                 MOVE AL-UABON   TO  EXPCHGA
  7499                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7500                 GO TO 8200-SEND-DATAONLY.
  7501
  7502     PERFORM 4100-BUILD-VERIFICATION  THRU  4199-EXIT.
  7503
  7504*    display ' VERI TABLE BEFORE '
  7505*    perform 4220-DISPLAY-VERI-TABLE
  7506*                                thru 4220-exit
  7507     IF EFFCHGL = ZERO
  7508         MOVE PI-BIN-EXP-DT (T-INDEX)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 153
* EL650.cbl
  7509                                 TO WS-ACCT-EFF-DT (WS-INDEX)
  7510         MOVE BIN-EXPCHG-SAVE    TO WS-ACCT-EXP-DT (WS-INDEX)
  7511     ELSE
  7512         MOVE BIN-EFFCHG-SAVE    TO WS-ACCT-EFF-DT (WS-INDEX)
  7513                                    WS-ACCT-EXP-DT (WS-INDEX - 1)
  7514         MOVE BIN-EXPCHG-SAVE    TO WS-ACCT-EXP-DT (WS-INDEX).
  7515
  7516*    display ' VERI TABLE AFTER  '
  7517*    perform 4220-DISPLAY-VERI-TABLE
  7518*                                thru 4220-exit
  7519     PERFORM 4300-VERIFY-INTEGRITY  THRU  4399-EXIT
  7520         VARYING  WS-INDEX  FROM  +1  BY  +1
  7521           UNTIL  WS-INDEX  GREATER +32.
  7522
  7523     IF NOT EMI-NO-ERRORS
  7524         GO TO 8200-SEND-DATAONLY.
  7525
  7526     IF EFFCHGL  =  ZEROS
  7527         MOVE PI-BIN-EXP-DT (T-INDEX)
  7528                                  TO  PI-ACCT-EXP-DT
  7529                                      BIN-EFFCHG-SAVE
  7530                                      DC-BIN-DATE-1
  7531         MOVE SPACE               TO  DC-OPTION-CODE
  7532         PERFORM 9700-DATE-CONVERSION
  7533***  Y2K PROJ 7744
  7534         MOVE DC-GREG-DATE-1-YMD  TO  WS-EFFCHG-SAVE
  7535         MOVE DC-ALPHA-CENTURY    TO  WS-EFFCHG-SAVE(4:2)
  7536         MOVE WS-EFFCHG-SAVE      TO  EFFCHG-SAVE
  7537
  7538         PERFORM 5020-READ-PREV-REC
  7539         PERFORM 5050-CREATE-NEW-REC  THRU  5050-EXIT
  7540         GO TO 5005-EXIT
  7541     END-IF.
  7542***  Y2K PROJ 7744
  7543
  7544     IF NOT EMI-NO-ERRORS
  7545         GO TO 8200-SEND-DATAONLY.
  7546
  7547     SET T-INDEX  TO  PI-TOTAL-LINES.
  7548
  7549*    IF (EFFCHGL GREATER THAN +0) AND
  7550*       (EXPCHGL GREATER THAN +0)
  7551*       IF (PI-BIN-EXP-DT (T-INDEX) EQUAL HIGH-VALUES) AND
  7552*          (BIN-EXPCHG-SAVE EQUAL HIGH-VALUES)
  7553*          NEXT SENTENCE
  7554*       ELSE
  7555*          GO TO 5006-FIND-EXP-DATE.
  7556*
  7557
  7558
  7559***************************************************************
  7560*    EFFECTIVE DATE ENTERED, WILL REPLACE CURRENT EXPIRATION  *
  7561*    DATE IF ALL NINES AND CREATE NEW RANGE                   *
  7562***************************************************************
  7563     SET T-INDEX  TO  PI-TOTAL-LINES.
  7564
  7565     IF BROWSE-STARTED-SW EQUAL 'Y'
  7566        PERFORM 6320-ENDBR THRU 6320-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 154
* EL650.cbl
  7567
  7568     IF PI-BIN-EXP-DT (T-INDEX)  = HIGH-VALUES
  7569         IF PI-BIN-EFF-DT (T-INDEX) NOT LESS BIN-EFFCHG-SAVE
  7570             MOVE ER-2063             TO  EMI-ERROR
  7571             MOVE -1                  TO  EFFCHGL
  7572             MOVE AL-UABON            TO  EFFCHGA
  7573             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7574             GO TO 8200-SEND-DATAONLY
  7575         ELSE
  7576             MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT
  7577             MOVE LOW-VALUES              TO  PI-ACCT-REST-OF-EXP
  7578             MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  7579             MOVE PI-BIN-EFF-DT (T-INDEX)
  7580                                      TO  B4-ACCT-EFF-DT
  7581             PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  7582             MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  7583                                          AM-VG-EXPIRATION-DT
  7584                                          PI-BIN-EXP-DT
  7585                                                    (T-INDEX)
  7586             MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  7587             MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  7588             PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  7589             PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  7590             PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  7591             GO TO 5005-EXIT.
  7592
  7593***************************************************************
  7594*    EFFECTIVE DATE ENTERED, CHECK TO ENSURE EFFECTIVE        *
  7595*    DATE GREATER PREVIOUS EXPIRATION DATE                    *
  7596***************************************************************
  7597     SET T-INDEX  TO  PI-TOTAL-LINES.
  7598
  7599     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7600     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7601
  7602     IF BIN-EFFCHG-SAVE LESS PI-BIN-EXP-DT (T-INDEX)
  7603         PERFORM 5010-CHECK-VALID-NEW-RANGE  THRU  5010-EXIT
  7604     ELSE
  7605         PERFORM 5020-READ-PREV-REC
  7606         PERFORM 5050-CREATE-NEW-REC  THRU  5050-EXIT.
  7607
  7608 5005-EXIT.
  7609     MOVE SPACES                 TO  EFFCHGO
  7610                                     EXPCHGI.
  7611     MOVE AL-UANOF               TO  EFFCHGA
  7612                                     EXPCHGA.
  7613     MOVE ER-0000                TO  EMI-ERROR.
  7614
  7615     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  7616
  7617     GO TO 7000-BUILD-OUTPUT-MAP.
  7618
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 155
* EL650.cbl
  7620 5006-FIND-EXP-DATE.
  7621     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  7622                                     PI-ACCT-REST-OF-EXP.
  7623     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  7624
  7625     PERFORM 6310-READNEXT  THRU  6310-EXIT
  7626         VARYING  T-INDEX  FROM  +1  BY  +1
  7627           UNTIL  PI-BIN-EXP-DT (T-INDEX)  > BIN-EFFCHG-SAVE.
  7628
  7629     IF BIN-EFFCHG-SAVE > PI-BIN-EXP-DT (T-INDEX)
  7630        MOVE ER-1220             TO  EMI-ERROR
  7631        MOVE -1                  TO  EFFCHGL
  7632        MOVE AL-UABON            TO  EFFCHGA
  7633        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7634        GO TO         8200-SEND-DATAONLY.
  7635
  7636     IF (BIN-EFFCHG-SAVE > PI-BIN-EFF-DT (T-INDEX)) AND
  7637        (BIN-EXPCHG-SAVE < PI-BIN-EXP-DT (T-INDEX))
  7638        PERFORM 5007-CREATE-SUB-DATE-RANGES THRU 5007-EXIT
  7639        MOVE 1 TO PI-PAGE-NUMBER
  7640        GO TO 1000-SHOW-ACCOUNT
  7641     ELSE
  7642     IF (BIN-EFFCHG-SAVE = PI-BIN-EFF-DT (T-INDEX)) AND
  7643        (BIN-EXPCHG-SAVE < PI-BIN-EXP-DT (T-INDEX))
  7644        PERFORM 5008-CREATE-SUB-DATE-RANGES THRU 5008-EXIT
  7645        MOVE 1 TO PI-PAGE-NUMBER
  7646        GO TO 1000-SHOW-ACCOUNT
  7647     ELSE
  7648        MOVE ER-2051             TO  EMI-ERROR
  7649        MOVE -1                  TO  EFFCHGL
  7650        MOVE AL-UABON            TO  EFFCHGA
  7651        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7652        GO TO 8200-SEND-DATAONLY.
  7653
  7654 5006-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 156
* EL650.cbl
  7656 5007-CREATE-SUB-DATE-RANGES.
  7657
  7658     IF BROWSE-STARTED-SW EQUAL 'Y'
  7659        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7660
  7661     IF NOT SYSTEM-MODIFY-CAP
  7662         MOVE 'UPDATE'           TO  SM-READ
  7663         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  7664         MOVE ER-0070            TO  EMI-ERROR
  7665         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7666         GO TO 8100-SEND-INITIAL-MAP.
  7667
  7668
  7669* EXEC CICS GETMAIN
  7670*        LENGTH   (ACCT-REC-LEN)
  7671*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7672*        INITIMG  (GETMAIN-SPACE)
  7673*    END-EXEC.
  7674*    MOVE ',"IL                  $   #00006971' TO DFHEIV0
  7675     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7676     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7677     MOVE X'2020233030303036393731' TO DFHEIV0(25:11)
  7678     CALL 'kxdfhei1' USING DFHEIV0,
  7679           DFHEIV20,
  7680           ACCT-REC-LEN,
  7681           GETMAIN-SPACE
  7682     SET ADDRESS OF ACCOUNT-MASTER TO
  7683         DFHEIV20
  7684     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7685
  7686
  7687
  7688* EXEC CICS  HANDLE CONDITION
  7689*        ENDFILE  (5007-EXIT)
  7690*        NOTFND   (5007-EXIT)
  7691*    END-EXEC.
  7692*    MOVE '"$''I                  ! / #00006977' TO DFHEIV0
  7693     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  7694     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7695     MOVE X'2F20233030303036393737' TO DFHEIV0(25:11)
  7696     CALL 'kxdfhei1' USING DFHEIV0
  7697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7698
  7699
  7700     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7701     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7702
  7703
  7704* EXEC CICS  READ
  7705*        UPDATE
  7706*        DATASET  (PI-ACCT-ID)
  7707*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7708*        RIDFLD   (PI-ACCT-KEY)
  7709*    END-EXEC.
  7710*    MOVE '&"S        EU         (   #00006985' TO DFHEIV0
  7711     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7712     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7713     MOVE X'2020233030303036393835' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 157
* EL650.cbl
  7714     CALL 'kxdfhei1' USING DFHEIV0,
  7715           PI-ACCT-ID,
  7716           DFHEIV20,
  7717           DFHEIV99,
  7718           PI-ACCT-KEY,
  7719           DFHEIV99,
  7720           DFHEIV99,
  7721           DFHEIV99
  7722     SET ADDRESS OF ACCOUNT-MASTER TO
  7723         DFHEIV20
  7724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7725
  7726
  7727     MOVE AM-CONTROL-PRIMARY     TO  SAVE-ACCT-KEY.
  7728     MOVE AM-EXPIRATION-DT       TO  SAVE-CURR-EXP-DT.
  7729     MOVE AM-EFFECTIVE-DT        TO  SAVE-CURR-EFF-DT.
  7730     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7731     MOVE AM-EXPIRATION-DT       TO  AF-ACCT-EFF-DT.
  7732     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7733     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7734     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7735     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7736
  7737     MOVE BIN-EXPCHG-SAVE     TO  AM-EFFECTIVE-DT
  7738                                  PI-BIN-EFF-DT (T-INDEX).
  7739
  7740* EXEC CICS  REWRITE
  7741*        FROM     (ACCOUNT-MASTER)
  7742*        DATASET  (PI-ACCT-ID)
  7743*    END-EXEC.
  7744     MOVE LENGTH OF
  7745      ACCOUNT-MASTER
  7746       TO DFHEIV11
  7747*    MOVE '&& L                  %   #00007004' TO DFHEIV0
  7748     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7749     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7750     MOVE X'2020233030303037303034' TO DFHEIV0(25:11)
  7751     CALL 'kxdfhei1' USING DFHEIV0,
  7752           PI-ACCT-ID,
  7753           ACCOUNT-MASTER,
  7754           DFHEIV11,
  7755           DFHEIV99
  7756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7757
  7758
  7759
  7760* EXEC CICS SYNCPOINT
  7761*    END-EXEC.
  7762*    MOVE '6"                    !   #00007009' TO DFHEIV0
  7763     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  7764     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7765     MOVE X'2020233030303037303039' TO DFHEIV0(25:11)
  7766     CALL 'kxdfhei1' USING DFHEIV0
  7767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7768
  7769
  7770     PERFORM 8400-LOG-JOURNAL-RECORD.
  7771     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 158
* EL650.cbl
  7772     MOVE SAVE-ACCT-KEY       TO  AM-CONTROL-PRIMARY.
  7773     MOVE LOW-VALUES          TO  AM-CNTRL-B.
  7774     MOVE SAVE-CURR-EFF-DT    TO  PI-BIN-EFF-DT (T-INDEX)
  7775                                  AM-EFFECTIVE-DT.
  7776     MOVE BIN-EFFCHG-SAVE     TO  PI-BIN-EXP-DT (T-INDEX)
  7777                                  AM-EXPIRATION-DT
  7778                                  AM-VG-EXPIRATION-DT.
  7779     MOVE BIN-CURRENT-SAVE    TO  AM-LAST-MAINT-DT
  7780                                  PI-BIN-MAINT-DT (T-INDEX).
  7781     MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY.
  7782     MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT.
  7783     MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE
  7784     MOVE SPACES              TO  AM-1ST-PROD-DATE
  7785                                  AM-PREV-DATES.
  7786     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7787
  7788
  7789* EXEC CICS  HANDLE CONDITION
  7790*        ENDFILE  (5007-EXIT)
  7791*        NOTFND   (5007-EXIT)
  7792*        DUPREC   (5007-EXIT)
  7793*        ILLOGIC  (5007-EXIT)
  7794*        INVREQ   (5007-EXIT)
  7795*    END-EXEC.
  7796*    MOVE '"$''I%38               ! 0 #00007030' TO DFHEIV0
  7797     MOVE X'222427492533382020202020' TO DFHEIV0(1:12)
  7798     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7799     MOVE X'3020233030303037303330' TO DFHEIV0(25:11)
  7800     CALL 'kxdfhei1' USING DFHEIV0
  7801     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7802
  7803
  7804     MOVE 'AM'                TO AM-RECORD-ID.
  7805
  7806     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7807     PERFORM 8400-LOG-JOURNAL-RECORD.
  7808     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7809
  7810     MOVE SAVE-ACCT-KEY       TO  AM-CONTROL-PRIMARY.
  7811     MOVE BIN-EFFCHG-SAVE     TO  AM-EFFECTIVE-DT
  7812                                  PI-BIN-EFF-DT (T-INDEX).
  7813     MOVE BIN-EXPCHG-SAVE     TO  PI-BIN-EXP-DT (T-INDEX)
  7814                                  AM-EXPIRATION-DT
  7815                                  AM-VG-EXPIRATION-DT.
  7816     MOVE BIN-CURRENT-SAVE    TO  AM-LAST-MAINT-DT
  7817                                  PI-BIN-MAINT-DT (T-INDEX).
  7818     MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE
  7819     MOVE SPACES              TO  AM-1ST-PROD-DATE
  7820                                  AM-PREV-DATES.
  7821     MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY.
  7822     MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT.
  7823     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7824     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7825     PERFORM 8400-LOG-JOURNAL-RECORD.
  7826     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7827
  7828     MOVE ZERO                TO EFFCHGL
  7829                                 EXPCHGL.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 159
* EL650.cbl
  7830
  7831
  7832* EXEC CICS  HANDLE CONDITION
  7833*         NOTFND   (5015-NOT-FOUND)
  7834*         ENDFILE  (5015-NOT-FOUND)
  7835*    END-EXEC.
  7836*    MOVE '"$I''                  ! 1 #00007065' TO DFHEIV0
  7837     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7838     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7839     MOVE X'3120233030303037303635' TO DFHEIV0(25:11)
  7840     CALL 'kxdfhei1' USING DFHEIV0
  7841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7842
  7843
  7844 5007-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 160
* EL650.cbl
  7846 5008-CREATE-SUB-DATE-RANGES.
  7847
  7848     IF BROWSE-STARTED-SW EQUAL 'Y'
  7849        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7850
  7851     IF NOT SYSTEM-MODIFY-CAP
  7852         MOVE 'UPDATE'           TO  SM-READ
  7853         PERFORM 9995-SECURITY-VIOLATION  THRU  9995-EXIT
  7854         MOVE ER-0070            TO  EMI-ERROR
  7855         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  7856         GO TO 8100-SEND-INITIAL-MAP.
  7857
  7858     MOVE PI-BIN-EXP-DT (T-INDEX)  TO  PI-ACCT-EXP-DT.
  7859     MOVE LOW-VALUES               TO  PI-ACCT-REST-OF-EXP.
  7860     MOVE PI-ACCT-KEY              TO  B4-ACCT-KEY.
  7861     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  B4-ACCT-EFF-DT.
  7862
  7863     PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT.
  7864
  7865     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  7866                                     AM-VG-EXPIRATION-DT
  7867                                     PI-BIN-EXP-DT (T-INDEX).
  7868     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7869                                     PI-BIN-MAINT-DT (T-INDEX).
  7870     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7871     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  7872
  7873     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7874
  7875     PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT.
  7876
  7877     PERFORM 6600-UPDATE-MAINT-DT   THRU  6699-EXIT.
  7878
  7879     IF T-INDEX = PI-TOTAL-LINES
  7880        MOVE ZERO             TO EFFCHGL
  7881                                 EXPCHGL
  7882        GO TO 5008-EXIT.
  7883
  7884     MOVE BIN-EXPCHG-SAVE        TO  PI-ACCT-EXP-DT
  7885     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  7886     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  7887
  7888     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  7889
  7890     PERFORM 6310-READNEXT  THRU  6310-EXIT
  7891         VARYING  T-INDEX  FROM T-INDEX  BY  +1
  7892           UNTIL  PI-BIN-EXP-DT (T-INDEX)  > BIN-EXPCHG-SAVE.
  7893
  7894     IF BROWSE-STARTED-SW EQUAL 'Y'
  7895        PERFORM 6320-ENDBR THRU 6320-EXIT.
  7896
  7897
  7898* EXEC CICS  READ
  7899*        UPDATE
  7900*        DATASET  (PI-ACCT-ID)
  7901*        SET      (ADDRESS OF ACCOUNT-MASTER)
  7902*        RIDFLD   (PI-ACCT-KEY)
  7903*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 161
* EL650.cbl
  7904*    MOVE '&"S        EU         (   #00007123' TO DFHEIV0
  7905     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7906     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7907     MOVE X'2020233030303037313233' TO DFHEIV0(25:11)
  7908     CALL 'kxdfhei1' USING DFHEIV0,
  7909           PI-ACCT-ID,
  7910           DFHEIV20,
  7911           DFHEIV99,
  7912           PI-ACCT-KEY,
  7913           DFHEIV99,
  7914           DFHEIV99,
  7915           DFHEIV99
  7916     SET ADDRESS OF ACCOUNT-MASTER TO
  7917         DFHEIV20
  7918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7919
  7920
  7921     MOVE 'B'                    TO  JP-RECORD-TYPE.
  7922     MOVE ACCT-FILE-ID           TO  FILE-ID.
  7923     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7924
  7925     PERFORM 8400-LOG-JOURNAL-RECORD.
  7926
  7927     MOVE BIN-EXPCHG-SAVE        TO  AM-EFFECTIVE-DT
  7928                                     PI-BIN-EFF-DT (T-INDEX).
  7929     MOVE EXPCHG-SAVE            TO  AM-EFFECT-DT.
  7930     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT
  7931                                     PI-BIN-MAINT-DT (T-INDEX).
  7932     MOVE AM-CONTROL-PRIMARY     TO  AF-ACCT-KEY.
  7933     MOVE AM-EFFECTIVE-DT        TO  AF-ACCT-EFF-DT.
  7934     MOVE 'C'                    TO  JP-RECORD-TYPE.
  7935     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  7936
  7937     PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT.
  7938
  7939
  7940* EXEC CICS  REWRITE
  7941*        FROM     (ACCOUNT-MASTER)
  7942*        DATASET  (PI-ACCT-ID)
  7943*    END-EXEC.
  7944     MOVE LENGTH OF
  7945      ACCOUNT-MASTER
  7946       TO DFHEIV11
  7947*    MOVE '&& L                  %   #00007148' TO DFHEIV0
  7948     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7949     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7950     MOVE X'2020233030303037313438' TO DFHEIV0(25:11)
  7951     CALL 'kxdfhei1' USING DFHEIV0,
  7952           PI-ACCT-ID,
  7953           ACCOUNT-MASTER,
  7954           DFHEIV11,
  7955           DFHEIV99
  7956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7957
  7958
  7959     PERFORM 8400-LOG-JOURNAL-RECORD.
  7960
  7961     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 162
* EL650.cbl
  7962
  7963
  7964
  7965     MOVE ZERO                TO EFFCHGL
  7966                                 EXPCHGL.
  7967
  7968
  7969* EXEC CICS  HANDLE CONDITION
  7970*         NOTFND   (5015-NOT-FOUND)
  7971*         ENDFILE  (5015-NOT-FOUND)
  7972*    END-EXEC.
  7973*    MOVE '"$I''                  ! 2 #00007162' TO DFHEIV0
  7974     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7975     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7976     MOVE X'3220233030303037313632' TO DFHEIV0(25:11)
  7977     CALL 'kxdfhei1' USING DFHEIV0
  7978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7979
  7980
  7981 5008-EXIT. EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 163
* EL650.cbl
  7983 5010-CHECK-VALID-NEW-RANGE.
  7984
  7985***************************************************************
  7986*    THIS PARAGRAPH ALLOWS YOU TO EXPIRE A RANGE PRIOR TO HI  *
  7987*    CERT DATE AS LONG AS A NEW RANGE IS BEING CREATED        *
  7988***************************************************************
  7989
  7990     IF PI-AR-PROCESSING
  7991        GO TO 5010-CHECK-AR-VALID-NEW-RANGE.
  7992
  7993     IF BIN-EXPCHG-SAVE GREATER PI-BIN-EXP-DT (T-INDEX)  AND
  7994                        GREATER BIN-EFFCHG-SAVE          AND
  7995                        GREATER PI-BIN-HI-CERT (T-INDEX)
  7996         MOVE PI-BIN-EXP-DT (T-INDEX)
  7997                                  TO  PI-ACCT-EXP-DT
  7998         MOVE LOW-VALUES          TO  PI-ACCT-REST-OF-EXP
  7999         MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  8000         MOVE PI-BIN-EFF-DT (T-INDEX)
  8001                                  TO  B4-ACCT-EFF-DT
  8002         PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  8003         MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  8004                                      AM-VG-EXPIRATION-DT
  8005                                      PI-BIN-EXP-DT (T-INDEX)
  8006         MOVE BIN-CURRENT-SAVE    TO  PI-BIN-MAINT-DT (T-INDEX)
  8007         MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  8008         MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  8009         PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  8010         PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  8011         PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  8012     ELSE
  8013         MOVE ER-2051             TO  EMI-ERROR
  8014         MOVE -1                  TO  EFFCHGL
  8015         MOVE AL-UABON            TO  EFFCHGA  EXPCHGA
  8016         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8017         GO TO 8200-SEND-DATAONLY.
  8018
  8019     GO TO 5010-EXIT.
  8020
  8021 5010-CHECK-AR-VALID-NEW-RANGE.
  8022
  8023***************************************************************
  8024*    THIS PARAGRAPH ALLOWS YOU TO EXPIRE A RANGE PRIOR TO HI  *
  8025*    A/R CERT DATE AS LONG AS A NEW RANGE IS BEING CREATED    *
  8026***************************************************************
  8027
  8028     IF BIN-EXPCHG-SAVE GREATER PI-BIN-EXP-DT (T-INDEX)  AND
  8029                        GREATER BIN-EFFCHG-SAVE          AND
  8030                        GREATER PI-BIN-AR-HI-CERT (T-INDEX)
  8031         MOVE PI-BIN-EXP-DT (T-INDEX)
  8032                                  TO  PI-ACCT-EXP-DT
  8033         MOVE LOW-VALUES          TO  PI-ACCT-REST-OF-EXP
  8034         MOVE PI-ACCT-KEY         TO  B4-ACCT-KEY
  8035         MOVE PI-BIN-EFF-DT (T-INDEX)
  8036                                  TO  B4-ACCT-EFF-DT
  8037         PERFORM 3100-DELETE-DATE-RANGE  THRU  3199-EXIT
  8038         MOVE BIN-EFFCHG-SAVE     TO  AM-EXPIRATION-DT
  8039                                      AM-VG-EXPIRATION-DT
  8040                                      PI-BIN-EXP-DT (T-INDEX)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 164
* EL650.cbl
  8041         MOVE BIN-CURRENT-SAVE    TO  PI-BIN-MAINT-DT (T-INDEX)
  8042         MOVE AM-CONTROL-PRIMARY  TO  AF-ACCT-KEY
  8043         MOVE AM-EFFECTIVE-DT     TO  AF-ACCT-EFF-DT
  8044         PERFORM 5600-CHG-AXRF-RECORDS  THRU  5699-EXIT
  8045         PERFORM 3200-ADD-DATE-RANGE    THRU  3299-EXIT
  8046         PERFORM 5050-CREATE-NEW-REC    THRU  5050-EXIT
  8047     ELSE
  8048         MOVE ER-2051             TO  EMI-ERROR
  8049         MOVE -1                  TO  EFFCHGL
  8050         MOVE AL-UABON            TO  EFFCHGA  EXPCHGA
  8051         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8052         GO TO 8200-SEND-DATAONLY.
  8053
  8054 5010-EXIT.
  8055     EXIT.
  8056
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 165
* EL650.cbl
  8058 5015-NOT-FOUND.
  8059     MOVE ER-0226                TO  EMI-ERROR.
  8060     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8061     MOVE -1                 TO  MAINTL.
  8062     GO TO 8200-SEND-DATAONLY.
  8063
  8064 5015-EXIT.
  8065     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 166
* EL650.cbl
  8067 5020-READ-PREV-REC.
  8068
  8069* EXEC CICS  READ
  8070*        DATASET  (PI-ACCT-ID)
  8071*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8072*        RIDFLD   (PI-ACCT-KEY)
  8073*    END-EXEC.
  8074*    MOVE '&"S        E          (   #00007254' TO DFHEIV0
  8075     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8076     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8077     MOVE X'2020233030303037323534' TO DFHEIV0(25:11)
  8078     CALL 'kxdfhei1' USING DFHEIV0,
  8079           PI-ACCT-ID,
  8080           DFHEIV20,
  8081           DFHEIV99,
  8082           PI-ACCT-KEY,
  8083           DFHEIV99,
  8084           DFHEIV99,
  8085           DFHEIV99
  8086     SET ADDRESS OF ACCOUNT-MASTER TO
  8087         DFHEIV20
  8088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8089
  8090
  8091 5050-CREATE-NEW-REC.
  8092     MOVE BIN-EFFCHG-SAVE        TO  AM-EFFECTIVE-DT.
  8093     MOVE BIN-EXPCHG-SAVE        TO  AM-EXPIRATION-DT
  8094                                     AM-VG-EXPIRATION-DT.
  8095     MOVE EFFCHG-SAVE            TO  AM-EFFECT-DT.
  8096     MOVE SPACES                 TO  AM-CERTS-PURGED-DATE
  8097                                     AM-1ST-PROD-DATE
  8098                                     AM-PREV-DATES
  8099                                     AM-BILLING-STATUS.
  8100     MOVE ZEROS                  TO  AM-HI-CERT-DATE
  8101                                     AM-LO-CERT-DATE.
  8102
  8103     IF AM-AR-HI-CERT-DATE NOT LESS THAN AM-EFFECTIVE-DT
  8104        NEXT SENTENCE
  8105     ELSE
  8106        MOVE LOW-VALUES          TO  AM-AR-HI-CERT-DATE.
  8107
  8108     MOVE BIN-CURRENT-SAVE       TO  AM-LAST-MAINT-DT.
  8109     MOVE PI-PROCESSOR-ID        TO  AM-LAST-MAINT-USER.
  8110     MOVE EIBTIME                TO  AM-LAST-MAINT-HHMMSS.
  8111
  8112     SET T-INDEX  UP  BY  1.
  8113     IF T-INDEX  GREATER 32
  8114         MOVE ER-2062            TO  EMI-ERROR
  8115         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8116         MOVE -1                 TO  MAINTL
  8117         GO TO 8200-SEND-DATAONLY.
  8118
  8119     ADD 1                       TO  PI-TOTAL-LINES.
  8120
  8121     MOVE LOW-VALUES             TO  PI-TABLE-ENT    (T-INDEX).
  8122     MOVE BIN-EFFCHG-SAVE        TO  PI-BIN-EFF-DT   (T-INDEX).
  8123     MOVE BIN-EXPCHG-SAVE        TO  PI-BIN-EXP-DT   (T-INDEX).
  8124     MOVE AM-AR-HI-CERT-DATE     TO  PI-BIN-AR-HI-CERT (T-INDEX).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 167
* EL650.cbl
  8125     MOVE BIN-CURRENT-SAVE       TO  PI-BIN-MAINT-DT (T-INDEX).
  8126
  8127     PERFORM 5500-ADD-NEW-AXRF-RECORD  THRU  5599-EXIT.
  8128
  8129     MOVE 'A'                    TO  JP-RECORD-TYPE.
  8130     MOVE ACCOUNT-MASTER         TO  JP-RECORD-AREA.
  8131     MOVE ACCT-FILE-ID           TO  FILE-ID.
  8132
  8133
  8134* EXEC CICS  WRITE
  8135*        RIDFLD   (AM-CONTROL-PRIMARY)
  8136*        FROM     (ACCOUNT-MASTER)
  8137*        DATASET  (PI-ACCT-ID)
  8138*    END-EXEC.
  8139     MOVE LENGTH OF
  8140      ACCOUNT-MASTER
  8141       TO DFHEIV11
  8142*    MOVE '&$ L                  ''   #00007302' TO DFHEIV0
  8143     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8144     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8145     MOVE X'2020233030303037333032' TO DFHEIV0(25:11)
  8146     CALL 'kxdfhei1' USING DFHEIV0,
  8147           PI-ACCT-ID,
  8148           ACCOUNT-MASTER,
  8149           DFHEIV11,
  8150           AM-CONTROL-PRIMARY,
  8151           DFHEIV99,
  8152           DFHEIV99
  8153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8154
  8155
  8156     PERFORM 8400-LOG-JOURNAL-RECORD.
  8157
  8158     PERFORM 6600-UPDATE-MAINT-DT  THRU  6699-EXIT.
  8159
  8160 5050-EXIT.
  8161     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 168
* EL650.cbl
  8163 5100-FIND-NEXT-RANGE.
  8164     MOVE PI-PREV-VG-ACCOUNT     TO  KEY-SAVE.
  8165
  8166     IF PI-TOTAL-LINES  = ZERO
  8167         GO TO 5210-NO-DATA.
  8168
  8169     IF PI-LST-PAGE
  8170       OR (PI-FST-PAGE AND PI-TOTAL-LINES NOT GREATER 8)
  8171       OR (PI-2ND-PAGE AND PI-TOTAL-LINES NOT GREATER 16)
  8172       OR (PI-3RD-PAGE AND PI-TOTAL-LINES NOT GREATER 24)
  8173         MOVE ER-2065            TO  EMI-ERROR
  8174         MOVE -1                 TO  MAINTL
  8175         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8176         GO TO 8200-SEND-DATAONLY.
  8177
  8178     IF PI-FST-PAGE
  8179         MOVE 2                  TO  PI-PAGE-NUMBER
  8180     ELSE
  8181     IF PI-2ND-PAGE
  8182         MOVE 3                  TO  PI-PAGE-NUMBER
  8183     ELSE
  8184     IF PI-3RD-PAGE
  8185         MOVE 4                  TO  PI-PAGE-NUMBER.
  8186
  8187     GO TO 7000-BUILD-OUTPUT-MAP.
  8188
  8189 5200-FIND-PREV-RANGE.
  8190     MOVE PI-PREV-VG-ACCOUNT     TO  KEY-SAVE.
  8191
  8192     IF PI-TOTAL-LINES  =  ZERO
  8193         GO TO 5210-NO-DATA.
  8194
  8195     IF PI-FST-PAGE
  8196         MOVE ER-2066            TO  EMI-ERROR
  8197         MOVE -1                 TO  MAINTL
  8198         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8199         GO TO 8200-SEND-DATAONLY.
  8200
  8201     IF PI-2ND-PAGE
  8202         MOVE 1                  TO  PI-PAGE-NUMBER
  8203     ELSE
  8204     IF PI-3RD-PAGE
  8205         MOVE 2                  TO  PI-PAGE-NUMBER
  8206     ELSE
  8207     IF PI-LST-PAGE
  8208         MOVE 3                  TO  PI-PAGE-NUMBER.
  8209
  8210     GO TO 7000-BUILD-OUTPUT-MAP.
  8211
  8212 5210-NO-DATA.
  8213     MOVE ER-2069                TO  EMI-ERROR.
  8214     MOVE -1                     TO  MAINTL.
  8215
  8216     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8217
  8218     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 169
* EL650.cbl
  8220 5300-FIND-NEXT-ACCOUNT.
  8221     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8222     MOVE 'Y'                    TO  FIRST-TIME-SW.
  8223
  8224     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8225         MOVE PI-COMPANY-CD      TO  PI-ACCT-CO
  8226     ELSE
  8227         PERFORM 6100-BUILD-KEY  THRU  6199-EXIT
  8228         MOVE HIGH-VALUES        TO  PI-ACCT-EXP-DT
  8229         MOVE LOW-VALUES         TO  PI-ACCT-REST-OF-EXP.
  8230
  8231     IF NOT EMI-NO-ERRORS
  8232         GO TO 8200-SEND-DATAONLY.
  8233
  8234
  8235* EXEC CICS  HANDLE CONDITION
  8236*        NOTFND   (5340-END)
  8237*        ENDFILE  (5330-NOT-FOUND)
  8238*    END-EXEC.
  8239*    MOVE '"$I''                  ! 3 #00007386' TO DFHEIV0
  8240     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8242     MOVE X'3320233030303037333836' TO DFHEIV0(25:11)
  8243     CALL 'kxdfhei1' USING DFHEIV0
  8244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8245
  8246
  8247 5305-START-BR.
  8248     MOVE ZEROS                  TO  PI-TOTAL-LINES.
  8249
  8250     SET T-INDEX
  8251        TS-INDEX  TO  +1.
  8252
  8253     PERFORM 6300-STARTBR  THRU  6300-EXIT.
  8254
  8255 5310-READ-NEXT.
  8256     PERFORM 6310-READNEXT  THRU  6310-EXIT.
  8257
  8258     IF PI-ACCT-CO  NOT = PI-COMPANY-CD
  8259         GO TO 5330-NOT-FOUND.
  8260
  8261     IF PI-CARRIER-SECURITY GREATER SPACES
  8262         IF PI-ACCT-CARRIER  =  PI-CARRIER-SECURITY
  8263             NEXT SENTENCE
  8264         ELSE
  8265             GO TO 5310-READ-NEXT.
  8266
  8267     IF FIRST-TIME
  8268         IF PI-ACCT-CCGSA-KEY  NOT = KEY-SAVE
  8269             MOVE SPACES             TO  FIRST-TIME-SW
  8270             MOVE PI-ACCT-CCGSA-KEY  TO  KEY-SAVE
  8271                                         PI-PREV-VG-ACCOUNT
  8272         ELSE
  8273             GO TO 5310-READ-NEXT.
  8274
  8275     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  8276         IF PI-COMPANY-CD  = PI-ACCT-CO
  8277             GO TO 5320-DISPLAY-RECORD
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 170
* EL650.cbl
  8278         ELSE
  8279             MOVE ER-0066        TO  EMI-ERROR
  8280             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8281             MOVE -1             TO  MAINTL
  8282             GO TO 8200-SEND-DATAONLY.
  8283
  8284     IF PI-ACCT-CCGSA-KEY  = KEY-SAVE
  8285         GO TO 5320-DISPLAY-RECORD
  8286     ELSE
  8287         MOVE 1                  TO  PI-PAGE-NUMBER
  8288         GO TO 7000-BUILD-OUTPUT-MAP.
  8289
  8290 5320-DISPLAY-RECORD.
  8291     IF T-INDEX  = 1
  8292         MOVE LOW-VALUES         TO  PI-DATE-RANGE-TABLE
  8293         MOVE SPACE              TO  NAMEFLGO
  8294                                     PI-NAMEFLG.
  8295
  8296     IF AM-TRNTO-DTE  =  SPACES
  8297         MOVE LOW-VALUES         TO  AM-TRNTO-DTE.
  8298
  8299     IF AM-TRNFROM-DTE  = SPACES
  8300         MOVE LOW-VALUES         TO  AM-TRNFROM-DTE.
  8301
  8302     IF T-INDEX  = 1
  8303         IF PI-COMPANY-ID  = 'LGX'  OR
  8304                             'MIC'  OR  'MCC'
  8305             MOVE AM-TRANSFERRED-TO  TO  TRNTOO
  8306             MOVE AM-TRNTO-DTE       TO  DC-BIN-DATE-1
  8307             MOVE SPACE              TO  DC-OPTION-CODE
  8308             PERFORM 9700-DATE-CONVERSION
  8309             IF DATE-CONVERSION-ERROR
  8310                 MOVE SPACES         TO  TRNTODTO
  8311             ELSE
  8312                 MOVE DC-GREG-DATE-1-EDIT
  8313                                     TO  TRNTODTO.
  8314
  8315     IF T-INDEX  = 1
  8316         IF PI-COMPANY-ID  =  'LGX'  OR
  8317                              'MIC'  OR  'MCC'
  8318             MOVE AM-TRANSFERRED-FROM  TO  TRNFROMO
  8319             MOVE AM-TRNFROM-DTE       TO  DC-BIN-DATE-1
  8320             MOVE SPACE                TO  DC-OPTION-CODE
  8321             PERFORM 9700-DATE-CONVERSION
  8322             IF DATE-CONVERSION-ERROR
  8323                 MOVE SPACES           TO  TRNFRDTO
  8324             ELSE
  8325                 MOVE DC-GREG-DATE-1-EDIT
  8326                                       TO  TRNFRDTO.
  8327
  8328     IF NAMEO  NOT = LOW-VALUES
  8329         IF AM-NAME  NOT = NAMEO
  8330             MOVE '*'            TO  NAMEFLGO
  8331                                     PI-NAMEFLG.
  8332
  8333     MOVE AM-CONTROL-PRIMARY     TO  PI-PREV-ACCOUNT.
  8334
  8335     IF T-INDEX  = 1
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 171
* EL650.cbl
  8336         MOVE AM-NAME                TO  NAMEO
  8337                                         PI-ACCNAME
  8338        ELSE
  8339         MOVE PI-ACCNAME             TO  NAMEO.
  8340
  8341     PERFORM 1020-MOVE-TO-TABLE  THRU  1020-EXIT.
  8342
  8343     GO TO 5310-READ-NEXT.
  8344
  8345 5330-NOT-FOUND.
  8346     IF BROWSE-STARTED
  8347         PERFORM 6320-ENDBR  THRU  6320-EXIT
  8348     ELSE
  8349         GO TO 5340-END.
  8350
  8351     IF PI-ACCT-ACCOUNT  = LOW-VALUE
  8352         MOVE ER-0472            TO  EMI-ERROR
  8353         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8354         MOVE -1                 TO  MAINTL
  8355         GO TO 8200-SEND-DATAONLY.
  8356
  8357     IF PI-ACCT-CCGSA-KEY  =  PI-PREV-ACCOUNT
  8358       AND  T-INDEX  NOT = 1
  8359         MOVE 1                  TO  PI-PAGE-NUMBER
  8360         GO TO 7000-BUILD-OUTPUT-MAP
  8361     ELSE
  8362         IF T-INDEX  NOT = 1
  8363             MOVE ER-0066        TO  EMI-ERROR
  8364             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8365             MOVE 1              TO  PI-PAGE-NUMBER
  8366             GO TO 7000-BUILD-OUTPUT-MAP.
  8367
  8368 5340-END.
  8369     MOVE ER-0066                TO  EMI-ERROR.
  8370
  8371     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8372
  8373     MOVE -1                     TO  MAINTL.
  8374
  8375     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 172
* EL650.cbl
  8377 5400-FIND-PREV-ACCOUNT.
  8378     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8379         GO TO 5430-NOT-FOUND.
  8380
  8381     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8382     MOVE PI-BIN-EXP-DT (1)      TO  PI-ACCT-EXP-DT.
  8383     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  8384
  8385
  8386* EXEC CICS  HANDLE CONDITION
  8387*        NOTFND   (5440-NOT-FOUND)
  8388*        ENDFILE  (5430-NOT-FOUND)
  8389*    END-EXEC.
  8390*    MOVE '"$I''                  ! 4 #00007529' TO DFHEIV0
  8391     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8392     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8393     MOVE X'3420233030303037353239' TO DFHEIV0(25:11)
  8394     CALL 'kxdfhei1' USING DFHEIV0
  8395     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8396
  8397
  8398
  8399* EXEC CICS  STARTBR
  8400*        DATASET  (PI-ACCT-ID)
  8401*        RIDFLD   (PI-ACCT-KEY)
  8402*    END-EXEC.
  8403     MOVE 0
  8404       TO DFHEIV11
  8405*    MOVE '&,         G          &   #00007534' TO DFHEIV0
  8406     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8407     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8408     MOVE X'2020233030303037353334' TO DFHEIV0(25:11)
  8409     CALL 'kxdfhei1' USING DFHEIV0,
  8410           PI-ACCT-ID,
  8411           PI-ACCT-KEY,
  8412           DFHEIV99,
  8413           DFHEIV11,
  8414           DFHEIV99
  8415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8416
  8417
  8418     MOVE 'Y'                    TO  BROWSE-STARTED-SW
  8419                                     FIRST-TIME-SW.
  8420 5410-READ-PREV.
  8421
  8422* EXEC CICS  READPREV
  8423*        DATASET  (PI-ACCT-ID)
  8424*        SET      (ADDRESS OF ACCOUNT-MASTER)
  8425*        RIDFLD   (PI-ACCT-KEY)
  8426*    END-EXEC.
  8427     MOVE 0
  8428       TO DFHEIV11
  8429*    MOVE '&0S                   )   #00007542' TO DFHEIV0
  8430     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8431     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8432     MOVE X'2020233030303037353432' TO DFHEIV0(25:11)
  8433     CALL 'kxdfhei1' USING DFHEIV0,
  8434           PI-ACCT-ID,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 173
* EL650.cbl
  8435           DFHEIV20,
  8436           DFHEIV99,
  8437           PI-ACCT-KEY,
  8438           DFHEIV99,
  8439           DFHEIV11,
  8440           DFHEIV99,
  8441           DFHEIV99
  8442     SET ADDRESS OF ACCOUNT-MASTER TO
  8443         DFHEIV20
  8444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8445
  8446
  8447     IF FIRST-TIME
  8448         MOVE SPACE              TO  FIRST-TIME-SW
  8449         GO TO 5410-READ-PREV.
  8450
  8451     IF PI-ACCT-CO  NOT = PI-COMPANY-CD
  8452         GO TO 5430-NOT-FOUND.
  8453
  8454     IF PI-CARRIER-SECURITY GREATER SPACES
  8455         IF PI-ACCT-CARRIER  = PI-CARRIER-SECURITY
  8456             NEXT SENTENCE
  8457         ELSE
  8458             GO TO 5410-READ-PREV.
  8459
  8460     MOVE AM-CONTROL-PRIMARY     TO  PI-PREV-ACCOUNT.
  8461     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE
  8462                                     PI-PREV-VG-ACCOUNT.
  8463     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  8464                                     PI-ACCT-REST-OF-EXP
  8465                                     PI-DATE-RANGE-TABLE.
  8466
  8467     MOVE SPACE                  TO  BROWSE-STARTED-SW.
  8468
  8469
  8470* EXEC CICS  ENDBR
  8471*        DATASET  (PI-ACCT-ID)
  8472*    END-EXEC.
  8473     MOVE 0
  8474       TO DFHEIV11
  8475*    MOVE '&2                    $   #00007570' TO DFHEIV0
  8476     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8477     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8478     MOVE X'2020233030303037353730' TO DFHEIV0(25:11)
  8479     CALL 'kxdfhei1' USING DFHEIV0,
  8480           PI-ACCT-ID,
  8481           DFHEIV11,
  8482           DFHEIV99
  8483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8484
  8485
  8486     GO TO 5305-START-BR.
  8487
  8488 5430-NOT-FOUND.
  8489     IF BROWSE-STARTED
  8490         MOVE SPACE              TO  BROWSE-STARTED-SW
  8491
  8492* EXEC CICS  ENDBR
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 174
* EL650.cbl
  8493*            DATASET  (PI-ACCT-ID)
  8494*        END-EXEC.
  8495     MOVE 0
  8496       TO DFHEIV11
  8497*    MOVE '&2                    $   #00007579' TO DFHEIV0
  8498     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8499     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8500     MOVE X'2020233030303037353739' TO DFHEIV0(25:11)
  8501     CALL 'kxdfhei1' USING DFHEIV0,
  8502           PI-ACCT-ID,
  8503           DFHEIV11,
  8504           DFHEIV99
  8505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8506
  8507
  8508     MOVE ER-0067                TO  EMI-ERROR.
  8509
  8510     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8511
  8512     MOVE -1                     TO  MAINTL.
  8513
  8514     IF PI-PREV-ACCOUNT  = LOW-VALUES
  8515         GO TO 5300-FIND-NEXT-ACCOUNT.
  8516
  8517     GO TO 8200-SEND-DATAONLY.
  8518
  8519 5440-NOT-FOUND.
  8520     MOVE PI-PREV-ACCOUNT        TO  PI-ACCT-CCGSA-KEY.
  8521
  8522     PERFORM 6310-READNEXT THRU 6310-EXIT.
  8523
  8524     GO TO 5410-READ-PREV.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 175
* EL650.cbl
  8526 5500-ADD-NEW-AXRF-RECORD.
  8527     IF NOT PI-GA-BILLING
  8528         GO TO 5599-EXIT.
  8529
  8530     MOVE +1                     TO  AXRF-SUB.
  8531
  8532*    IF MAINTI  = 'K'
  8533*        IF GETMAIN-SW  = 'X'
  8534*            GO TO 5510-BUILD-AXRF-KEY.
  8535
  8536     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8537
  8538*    EXEC CICS  GETMAIN
  8539*        LENGTH   (ERGXRF-REC-LEN)
  8540*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8541*        INITIMG  (GETMAIN-SPACE)
  8542*    END-EXEC.
  8543*    display ' beginning of CP displays  '
  8544*    display ' ergxrf-rec-len  ==   '  ergxrf-rec-len
  8545*    display ' address         ==   '
  8546*              address of agent-cross-reference
  8547*    display ' contents        ==   '  agent-cross-reference (1:1)
  8548*    display ' end       of CP displays  '
  8549
  8550*    MOVE 'X'                    TO  GETMAIN-SW.
  8551
  8552 5510-BUILD-AXRF-KEY.
  8553     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8554
  8555     IF AXRF-SUB  =  +11
  8556         GO TO 5599-EXIT.
  8557
  8558     IF AM-AGT (AXRF-SUB)  =  SPACES  OR ZEROS OR LOW-VALUES
  8559         ADD +1 TO AXRF-SUB
  8560         GO TO 5510-BUILD-AXRF-KEY.
  8561
  8562     IF (AM-COM-TYP (AXRF-SUB)  NOT = 'O' AND 'P' AND 'S'
  8563         AND 'G' AND 'B' AND 'I' AND 'L' AND 'K' AND 'A')
  8564         ADD +1 TO AXRF-SUB
  8565         GO TO 5510-BUILD-AXRF-KEY.
  8566
  8567     MOVE PI-COMPANY-CD          TO  WS-AXRF-COMPANY-CD.
  8568
  8569     IF PI-ZERO-CARRIER  OR
  8570        PI-ZERO-CAR-GROUP
  8571         MOVE ZERO               TO  WS-AXRF-CARRIER
  8572     ELSE
  8573         MOVE AM-CARRIER         TO  WS-AXRF-CARRIER.
  8574
  8575     IF PI-ZERO-GROUPING  OR
  8576        PI-ZERO-CAR-GROUP
  8577         MOVE ZEROS              TO  WS-AXRF-GROUPING
  8578     ELSE
  8579         MOVE AM-GROUPING        TO  WS-AXRF-GROUPING.
  8580
  8581     MOVE AM-AGT (AXRF-SUB)      TO  WS-AXRF-AGENT-NO.
  8582
  8583
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 176
* EL650.cbl
  8584* EXEC CICS  HANDLE CONDITION
  8585*        ENDFILE  (5525-SKIP-REWRITE)
  8586*        NOTFND   (5525-SKIP-REWRITE)
  8587*    END-EXEC.
  8588*    MOVE '"$''I                  ! 5 #00007658' TO DFHEIV0
  8589     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8590     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8591     MOVE X'3520233030303037363538' TO DFHEIV0(25:11)
  8592     CALL 'kxdfhei1' USING DFHEIV0
  8593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8594
  8595
  8596
  8597* EXEC CICS  READ
  8598*        DATASET  (ERGXRF-FILE-ID)
  8599*        LENGTH   (ERGXRF-REC-LEN)
  8600*        INTO     (AGENT-CROSS-REFERENCE)
  8601*        RIDFLD   (WS-AXRF-KEY)
  8602*        EQUAL
  8603*        UPDATE
  8604*    END-EXEC.
  8605*    MOVE '&"IL       EU         (   #00007663' TO DFHEIV0
  8606     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8607     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8608     MOVE X'2020233030303037363633' TO DFHEIV0(25:11)
  8609     CALL 'kxdfhei1' USING DFHEIV0,
  8610           ERGXRF-FILE-ID,
  8611           AGENT-CROSS-REFERENCE,
  8612           ERGXRF-REC-LEN,
  8613           WS-AXRF-KEY,
  8614           DFHEIV99,
  8615           DFHEIV99,
  8616           DFHEIV99
  8617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8618
  8619
  8620     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8621     MOVE +1                     TO  GX-AGENT-SUB.
  8622
  8623     IF GX-AGENT-POINTER-CNT = +1006
  8624         GO TO 5525-SKIP-REWRITE.
  8625
  8626
  8627 5520-FIND-REC-LOCATION.
  8628     MOVE AM-COMPANY-CD          TO  GX-AM-COMPANY-CD.
  8629     MOVE GX-AGENT-POINTER (GX-AGENT-SUB)
  8630                                 TO  GX-REST-OF-KEY.
  8631     MOVE LOW-VALUES             TO  GX-AM-CNTL-FILLER.
  8632
  8633     IF GX-AM-CONTROL-PRIMARY GREATER AM-CONTROL-PRIMARY  OR
  8634        GX-AGENT-SUB          GREATER GX-AGENT-POINTER-CNT
  8635         NEXT SENTENCE
  8636     ELSE
  8637         ADD +1 TO GX-AGENT-SUB
  8638         GO TO 5520-FIND-REC-LOCATION.
  8639
  8640     MOVE GX-AGENT-POINTER-CNT   TO  COMM-WORK-SUB
  8641                                     COMM-WORK-SUB2.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 177
* EL650.cbl
  8642
  8643     ADD +1 TO COMM-WORK-SUB2.
  8644
  8645     IF GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT
  8646         NEXT SENTENCE
  8647      ELSE
  8648         PERFORM 5530-BUMP-AXRF-REC
  8649             VARYING  COMM-WORK-SUB  FROM  COMM-WORK-SUB  BY  -1
  8650               UNTIL  COMM-WORK-SUB2 = GX-AGENT-SUB.
  8651
  8652     ADD ERGXRF-INC-LEN TO  ERGXRF-REC-LEN.
  8653     ADD  +1 TO  GX-AGENT-POINTER-CNT.
  8654
  8655     MOVE AM-CARRIER        TO  GX-AM-CARRIER   (COMM-WORK-SUB2).
  8656     MOVE AM-GROUPING       TO  GX-AM-GROUPING  (COMM-WORK-SUB2).
  8657     MOVE AM-STATE          TO  GX-AM-STATE     (COMM-WORK-SUB2).
  8658     MOVE AM-ACCOUNT        TO  GX-AM-ACCOUNT   (COMM-WORK-SUB2).
  8659     MOVE AM-EXPIRATION-DT  TO  GX-AM-EXPIRATION-DT
  8660                                                (COMM-WORK-SUB2).
  8661     MOVE AM-EFFECTIVE-DT   TO  GX-AM-EFF-DT    (COMM-WORK-SUB2).
  8662     MOVE AXRF-SUB          TO  GX-AM-LEVEL-NO  (COMM-WORK-SUB2).
  8663     MOVE LOW-VALUES        TO  GX-LAST-BILL-DT (COMM-WORK-SUB2).
  8664     MOVE BIN-CURRENT-SAVE  TO  GX-LAST-MAINT-DT.
  8665     MOVE EIBTIME           TO  GX-LAST-MAINT-HHMMSS.
  8666     MOVE PI-PROCESSOR-ID   TO  GX-LAST-MAINT-USER.
  8667     compute ergxrf-rec-len = (gx-agent-pointer-cnt * +31) + +78
  8668     if ergxrf-rec-len > +31264
  8669        move +31264          to ergxrf-rec-len
  8670        move +1006           to gx-agent-pointer-cnt
  8671     end-if
  8672
  8673
  8674* EXEC CICS  REWRITE
  8675*        FROM     (AGENT-CROSS-REFERENCE)
  8676*        LENGTH   (ERGXRF-REC-LEN)
  8677*        DATASET  (ERGXRF-FILE-ID)
  8678*    END-EXEC.
  8679*    MOVE '&& L                  %   #00007725' TO DFHEIV0
  8680     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8681     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8682     MOVE X'2020233030303037373235' TO DFHEIV0(25:11)
  8683     CALL 'kxdfhei1' USING DFHEIV0,
  8684           ERGXRF-FILE-ID,
  8685           AGENT-CROSS-REFERENCE,
  8686           ERGXRF-REC-LEN,
  8687           DFHEIV99
  8688     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8689
  8690
  8691 5525-SKIP-REWRITE.
  8692
  8693     ADD +1 TO AXRF-SUB.
  8694
  8695     GO TO 5510-BUILD-AXRF-KEY.
  8696
  8697 5530-BUMP-AXRF-REC.
  8698     MOVE GX-AGENT-POINTER (COMM-WORK-SUB)
  8699                          TO  GX-AGENT-POINTER (COMM-WORK-SUB2).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 178
* EL650.cbl
  8700
  8701     SUBTRACT +1  FROM  COMM-WORK-SUB2.
  8702
  8703 5599-EXIT.
  8704     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 179
* EL650.cbl
  8706 5600-CHG-AXRF-RECORDS.
  8707     IF NOT PI-GA-BILLING
  8708         GO TO 5699-EXIT.
  8709
  8710     MOVE +1                     TO  AXRF-SUB.
  8711     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8712
  8713*    IF GETMAIN-SW  = 'X'
  8714*        GO TO 5610-BUILD-AXRF-KEY.
  8715
  8716*    EXEC CICS  GETMAIN
  8717*        LENGTH   (ERGXRF-REC-LEN)
  8718*        SET      (ADDRESS OF AGENT-CROSS-REFERENCE)
  8719*        INITIMG  (GETMAIN-SPACE)
  8720*    END-EXEC.
  8721*
  8722*    display ' beginning of CP displays  '
  8723*    display ' ergxrf-rec-len  ==   '  ergxrf-rec-len
  8724*    display ' address         ==   '
  8725*              address of agent-cross-reference
  8726*    display ' contents        ==   '  agent-cross-reference (1:1)
  8727*    display ' end       of CP displays  '
  8728
  8729*    MOVE 'X'                    TO  GETMAIN-SW.
  8730
  8731 5610-BUILD-AXRF-KEY.
  8732     IF AXRF-SUB  = +11
  8733         GO TO 5699-EXIT.
  8734
  8735     IF AM-AGT (AXRF-SUB)  = SPACES OR ZEROS OR LOW-VALUES
  8736         ADD +1 TO AXRF-SUB
  8737         GO TO 5610-BUILD-AXRF-KEY.
  8738
  8739     IF (AM-COM-TYP (AXRF-SUB) NOT = 'O' AND 'P' AND 'S'
  8740         AND 'G' AND 'B' AND 'I' AND 'L' AND 'K' AND 'A')
  8741         ADD +1 TO AXRF-SUB
  8742         GO TO 5610-BUILD-AXRF-KEY.
  8743
  8744     MOVE ERGXRF-MAX-LEN         TO  ERGXRF-REC-LEN.
  8745     MOVE PI-COMPANY-CD          TO  WS-AXRF-COMPANY-CD.
  8746
  8747     IF PI-ZERO-CARRIER OR
  8748        PI-ZERO-CAR-GROUP
  8749         MOVE ZERO               TO  WS-AXRF-CARRIER
  8750     ELSE
  8751         MOVE AM-CARRIER         TO  WS-AXRF-CARRIER.
  8752
  8753     IF PI-ZERO-GROUPING  OR
  8754        PI-ZERO-CAR-GROUP
  8755         MOVE ZEROS              TO  WS-AXRF-GROUPING
  8756     ELSE
  8757         MOVE AM-GROUPING        TO  WS-AXRF-GROUPING.
  8758
  8759     MOVE AM-AGT (AXRF-SUB)      TO  WS-AXRF-AGENT-NO.
  8760
  8761
  8762* EXEC CICS  HANDLE CONDITION
  8763*        ENDFILE  (5615-SKIP-REWRITE)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 180
* EL650.cbl
  8764*        NOTFND   (5615-SKIP-REWRITE)
  8765*    END-EXEC.
  8766*    MOVE '"$''I                  ! 6 #00007801' TO DFHEIV0
  8767     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  8768     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8769     MOVE X'3620233030303037383031' TO DFHEIV0(25:11)
  8770     CALL 'kxdfhei1' USING DFHEIV0
  8771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8772
  8773
  8774
  8775* EXEC CICS  READ
  8776*        DATASET  (ERGXRF-FILE-ID)
  8777*        LENGTH   (ERGXRF-REC-LEN)
  8778*        INTO     (AGENT-CROSS-REFERENCE)
  8779*        RIDFLD   (WS-AXRF-KEY)
  8780*        EQUAL
  8781*        UPDATE
  8782*    END-EXEC.
  8783*    MOVE '&"IL       EU         (   #00007806' TO DFHEIV0
  8784     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  8785     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8786     MOVE X'2020233030303037383036' TO DFHEIV0(25:11)
  8787     CALL 'kxdfhei1' USING DFHEIV0,
  8788           ERGXRF-FILE-ID,
  8789           AGENT-CROSS-REFERENCE,
  8790           ERGXRF-REC-LEN,
  8791           WS-AXRF-KEY,
  8792           DFHEIV99,
  8793           DFHEIV99,
  8794           DFHEIV99
  8795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8796
  8797
  8798     MOVE GX-AGENT-POINTER-CNT   TO  GX-AGENT-POINTER-CNT.
  8799
  8800     PERFORM VARYING GX-AGENT-SUB FROM +1 BY +1
  8801             UNTIL
  8802       (GX-AGENT-SUB GREATER GX-AGENT-POINTER-CNT)
  8803            OR
  8804       (GX-AM-ACCOUNT       (GX-AGENT-SUB) = B4-ACCT-ACCOUNT  AND
  8805        GX-AM-EXPIRATION-DT (GX-AGENT-SUB) = B4-ACCT-EXP-DT   AND
  8806        GX-AM-EFF-DT        (GX-AGENT-SUB) = B4-ACCT-EFF-DT   AND
  8807        GX-AM-CARRIER       (GX-AGENT-SUB) = B4-ACCT-CARRIER  AND
  8808        GX-AM-GROUPING      (GX-AGENT-SUB) = B4-ACCT-GROUPING AND
  8809        GX-AM-STATE         (GX-AGENT-SUB) = B4-ACCT-STATE)
  8810     END-PERFORM.
  8811
  8812     IF MAINTI  = 'D'
  8813        IF GX-AGENT-SUB NOT GREATER GX-AGENT-POINTER-CNT
  8814            MOVE GX-AGENT-SUB    TO  COMM-WORK-SUB
  8815            PERFORM 5630-BUMP-RECORDS
  8816                VARYING  GX-AGENT-SUB  FROM  GX-AGENT-SUB  BY  +1
  8817                  UNTIL  GX-AGENT-SUB  = GX-AGENT-POINTER-CNT
  8818            SUBTRACT ERGXRF-INC-LEN  FROM  ERGXRF-REC-LEN
  8819            SUBTRACT +1              FROM  GX-AGENT-POINTER-CNT
  8820            GO TO 5615-REWRITE-AXRF-RECORD.
  8821
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 181
* EL650.cbl
  8822     IF GX-AGENT-SUB NOT GREATER GX-AGENT-POINTER-CNT
  8823        MOVE AF-ACCT-EFF-DT  TO GX-AM-EFF-DT        (GX-AGENT-SUB)
  8824        MOVE AF-ACCT-EXP-DT  TO GX-AM-EXPIRATION-DT (GX-AGENT-SUB)
  8825        MOVE AXRF-SUB        TO GX-AM-LEVEL-NO      (GX-AGENT-SUB)
  8826        GO TO 5615-REWRITE-AXRF-RECORD.
  8827
  8828
  8829* EXEC CICS  UNLOCK
  8830*        DATASET  (ERGXRF-FILE-ID)
  8831*    END-EXEC.
  8832*    MOVE '&*                    #   #00007845' TO DFHEIV0
  8833     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8834     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8835     MOVE X'2020233030303037383435' TO DFHEIV0(25:11)
  8836     CALL 'kxdfhei1' USING DFHEIV0,
  8837           ERGXRF-FILE-ID,
  8838           DFHEIV99
  8839     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8840
  8841
  8842     GO TO 5615-SKIP-REWRITE.
  8843
  8844 5615-REWRITE-AXRF-RECORD.
  8845     IF MAINTI  = 'D'
  8846       AND  GX-AGENT-POINTER-CNT  =  +0
  8847
  8848* EXEC CICS  DELETE
  8849*            DATASET  (ERGXRF-FILE-ID)
  8850*        END-EXEC
  8851*    MOVE '&(                    &   #00007854' TO DFHEIV0
  8852     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  8853     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8854     MOVE X'2020233030303037383534' TO DFHEIV0(25:11)
  8855     CALL 'kxdfhei1' USING DFHEIV0,
  8856           ERGXRF-FILE-ID,
  8857           DFHEIV99,
  8858           DFHEIV99,
  8859           DFHEIV99,
  8860           DFHEIV99
  8861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8862     ELSE
  8863         MOVE BIN-CURRENT-SAVE   TO  GX-LAST-MAINT-DT
  8864         MOVE EIBTIME            TO  GX-LAST-MAINT-HHMMSS
  8865         MOVE PI-PROCESSOR-ID    TO  GX-LAST-MAINT-USER
  8866         compute ergxrf-rec-len =
  8867              (gx-agent-pointer-cnt * +31) + +78
  8868         if ergxrf-rec-len > +31264
  8869            move +31264          to ergxrf-rec-len
  8870            move +1006           to gx-agent-pointer-cnt
  8871         end-if
  8872
  8873* EXEC CICS  REWRITE
  8874*            FROM     (AGENT-CROSS-REFERENCE)
  8875*            LENGTH   (ERGXRF-REC-LEN)
  8876*            DATASET  (ERGXRF-FILE-ID)
  8877*        END-EXEC.
  8878*    MOVE '&& L                  %   #00007867' TO DFHEIV0
  8879     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 182
* EL650.cbl
  8880     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8881     MOVE X'2020233030303037383637' TO DFHEIV0(25:11)
  8882     CALL 'kxdfhei1' USING DFHEIV0,
  8883           ERGXRF-FILE-ID,
  8884           AGENT-CROSS-REFERENCE,
  8885           ERGXRF-REC-LEN,
  8886           DFHEIV99
  8887     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8888
  8889
  8890 5615-SKIP-REWRITE.
  8891     ADD +1  TO  AXRF-SUB.
  8892
  8893     GO TO 5610-BUILD-AXRF-KEY.
  8894
  8895 5630-BUMP-RECORDS.
  8896     ADD +1  TO  COMM-WORK-SUB.
  8897
  8898     MOVE GX-AGENT-POINTER (COMM-WORK-SUB)
  8899                            TO  GX-AGENT-POINTER (GX-AGENT-SUB).
  8900
  8901 5699-EXIT.
  8902     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 183
* EL650.cbl
  8904 6000-EDIT-EFFECTIVE-DATE.
  8905     IF EFFCHGL  NOT =  ZEROS
  8906         MOVE EFFCHGI                  TO  WS-DT-DEEDIT-FIELD
  8907         PERFORM 8600-DEEDIT  THRU 8600-EXIT
  8908         MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  8909         MOVE '4'                      TO  DC-OPTION-CODE
  8910         PERFORM 9700-DATE-CONVERSION
  8911         IF DATE-CONVERSION-ERROR
  8912             MOVE ER-0348              TO  EMI-ERROR
  8913             MOVE -1                   TO  EFFCHGL
  8914             MOVE AL-UABON             TO  EFFCHGA
  8915             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8916         ELSE
  8917             MOVE DC-GREG-DATE-1-EDIT  TO  EFFCHGI
  8918             MOVE AL-UANON             TO  EFFCHGA
  8919***  Y2K PROJ 7744
  8920             MOVE DC-GREG-DATE-1-YMD   TO  WS-EFFCHG-SAVE
  8921             MOVE DC-ALPHA-CENTURY     TO  WS-EFFCHG-SAVE(4:2)
  8922             MOVE WS-EFFCHG-SAVE       TO  EFFCHG-SAVE
  8923             MOVE DC-BIN-DATE-1        TO  BIN-EFFCHG-SAVE
  8924         END-IF
  8925***  Y2K PROJ 7744
  8926     ELSE
  8927         IF MAINTI  NOT = 'N'
  8928             MOVE ER-0216              TO  EMI-ERROR
  8929             MOVE -1                   TO  EFFCHGL
  8930             MOVE AL-UABON             TO  EFFCHGA
  8931             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  8932
  8933 6000-EFF-EXIT.
  8934     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 184
* EL650.cbl
  8936 6000-EDIT-EXPIRATION-DATE.
  8937***  Y2K PROJ 7744
  8938     IF EXPCHGL  NOT = ZEROS
  8939         MOVE EXPCHGI                  TO  WS-DT-DEEDIT-FIELD
  8940         PERFORM 8600-DEEDIT  THRU 8600-EXIT
  8941         IF WS-DEEDIT-FIELD-DATE-OUT NOT LESS 999999
  8942             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  EXPCHGO
  8943             INSPECT EXPCHGI CONVERTING SPACES TO '/'
  8944             MOVE HIGH-VALUES              TO  BIN-EXPCHG-SAVE
  8945             MOVE 99999999999              TO  EXPCHG-SAVE
  8946         ELSE
  8947             MOVE WS-DEEDIT-FIELD-DATE-OUT TO  DC-GREG-DATE-1-MDY
  8948             MOVE '4'                      TO  DC-OPTION-CODE
  8949             PERFORM 9700-DATE-CONVERSION
  8950             IF DATE-CONVERSION-ERROR
  8951                 MOVE ER-0454              TO  EMI-ERROR
  8952                 MOVE -1                   TO  EXPCHGL
  8953                 MOVE AL-UABON             TO  EXPCHGA
  8954                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8955             ELSE
  8956                 MOVE DC-GREG-DATE-1-EDIT  TO  EXPCHGI
  8957                 MOVE AL-UANON             TO  EXPCHGA
  8958                 MOVE DC-GREG-DATE-1-YMD   TO  WS-EXPCHG-SAVE
  8959                 MOVE DC-ALPHA-CENTURY     TO  WS-EXPCHG-SAVE(4:2)
  8960                 MOVE WS-EXPCHG-SAVE       TO  EXPCHG-SAVE
  8961                 MOVE DC-BIN-DATE-1        TO  BIN-EXPCHG-SAVE
  8962             END-IF
  8963         END-IF
  8964     ELSE
  8965         IF MAINTI  NOT =  'N'
  8966             MOVE ER-2058                  TO  EMI-ERROR
  8967             MOVE -1                       TO  EXPCHGL
  8968             MOVE AL-UABON                 TO  EXPCHGA
  8969             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  8970         ELSE
  8971             MOVE HIGH-VALUES              TO  BIN-EXPCHG-SAVE
  8972             MOVE 99999999999              TO  EXPCHG-SAVE
  8973         END-IF
  8974     END-IF.
  8975***  Y2K PROJ 7744
  8976
  8977 6000-EXP-EXIT.
  8978     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 185
* EL650.cbl
  8980 6000-EDIT-LINE.
  8981     IF LINEL  = ZEROS
  8982         GO TO 6000-NO-LINE.
  8983
  8984     MOVE AL-UNNON               TO  LINEA.
  8985
  8986     IF LINEI NOT NUMERIC
  8987         GO TO 6000-LINE-ERROR.
  8988
  8989     IF LINEI LESS 1 OR GREATER 8 OR GREATER PI-TOTAL-LINES
  8990         GO TO 6000-LINE-ERROR.
  8991
  8992     MOVE PI-TOTAL-LINES         TO WS-PAGE-LINES.
  8993
  8994     IF PI-2ND-PAGE
  8995         SUBTRACT 8 FROM WS-PAGE-LINES
  8996     ELSE
  8997     IF PI-3RD-PAGE
  8998         SUBTRACT 16 FROM WS-PAGE-LINES
  8999     ELSE
  9000     IF PI-LST-PAGE
  9001         SUBTRACT 24 FROM WS-PAGE-LINES.
  9002
  9003     IF LINEI GREATER WS-PAGE-LINES
  9004         GO TO 6000-LINE-ERROR.
  9005
  9006     MOVE LINEI                  TO  PI-LINE-SELECTED.
  9007
  9008     GO TO 6000-LIN-EXIT.
  9009
  9010 6000-NO-LINE.
  9011     IF PI-TOTAL-LINES  = 1
  9012         MOVE 1                  TO  PI-LINE-SELECTED
  9013                                     LINEI
  9014         MOVE AL-UNNON           TO  LINEA
  9015         GO TO 6000-LIN-EXIT.
  9016
  9017 6000-LINE-ERROR.
  9018     MOVE ER-2064                TO  EMI-ERROR.
  9019     MOVE -1                     TO  LINEL.
  9020     MOVE AL-UABON               TO  LINEA.
  9021
  9022     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9023
  9024 6000-LIN-EXIT.
  9025     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 186
* EL650.cbl
  9027 600A-CHECK-HI-LO-DATES.
  9028
  9029     IF PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  9030         GO TO 600A-CHECK-AR-DATES.
  9031
  9032     IF BIN-EFFCHG-SAVE GREATER THAN PI-BIN-EFF-DT (T-INDEX)
  9033     IF (PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9034         MOVE ER-2113            TO  EMI-ERROR
  9035         MOVE -1                 TO  MAINTL
  9036         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9037
  9038*    IF (PI-BIN-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9039*        MOVE ER-2113            TO  EMI-ERROR
  9040*        MOVE -1                 TO  MAINTL
  9041*        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9042
  9043 600A-CHECK-AR-DATES.
  9044     IF NOT PI-AR-PROCESSING
  9045         GO TO 600A-EXIT.
  9046
  9047     IF PI-BIN-AR-HI-CERT (T-INDEX) = LOW-VALUES OR SPACES
  9048        GO TO 600A-EXIT.
  9049
  9050     IF (PI-BIN-AR-HI-CERT (T-INDEX) NOT LESS BIN-EXPCHG-SAVE)
  9051         MOVE ER-2113            TO  EMI-ERROR
  9052         MOVE -1                 TO  MAINTL
  9053         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9054
  9055 600A-EXIT.
  9056     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 187
* EL650.cbl
  9058 6010-DATE-CHECK.
  9059     IF MAINTI  = 'E'
  9060         GO TO 6010-CHECK-EFF.
  9061
  9062     IF PI-BIN-HI-CERT (T-INDEX)  NOT = LOW-VALUES
  9063         IF BIN-EXPCHG-SAVE NOT GREATER PI-BIN-HI-CERT (T-INDEX)
  9064             MOVE ER-2072        TO  EMI-ERROR
  9065             MOVE -1             TO  EXPCHGL
  9066             MOVE AL-UABON       TO  EXPCHGA
  9067             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9068
  9069     IF BIN-EXPCHG-SAVE NOT GREATER PI-BIN-EFF-DT (T-INDEX)
  9070         MOVE ER-2074            TO  EMI-ERROR
  9071         MOVE -1                 TO  EXPCHGL
  9072         MOVE AL-UABON           TO  EXPCHGA
  9073         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9074
  9075     GO TO 6010-EXIT.
  9076
  9077 6010-CHECK-EFF.
  9078     IF PI-BIN-LO-CERT (T-INDEX)  NOT =  LOW-VALUES
  9079        IF (BIN-EFFCHG-SAVE >= PI-BIN-LO-CERT (T-INDEX))
  9080           AND (PI-PROCESSOR-ID NOT = 'PEMA')
  9081           MOVE ER-2073          TO EMI-ERROR
  9082           MOVE -1               TO EFFCHGL
  9083           MOVE AL-UABON         TO EFFCHGA
  9084           PERFORM 9900-ERROR-FORMAT
  9085                                 THRU 9900-EXIT
  9086        END-IF
  9087     END-IF
  9088
  9089     IF BIN-EFFCHG-SAVE NOT LESS PI-BIN-EXP-DT (T-INDEX)
  9090         MOVE ER-2075            TO  EMI-ERROR
  9091         MOVE -1                 TO  EFFCHGL
  9092         MOVE AL-UABON           TO  EFFCHGA
  9093         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9094
  9095 6010-EXIT.
  9096     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 188
* EL650.cbl
  9098 6100-BUILD-KEY.
  9099     MOVE LOW-VALUES             TO  PI-ACCT-KEY.
  9100     MOVE PI-COMPANY-CD          TO  PI-ACCT-CO.
  9101
  9102     IF ACARIERI  =  SPACES  OR  LOW-VALUES
  9103         IF MAINTI  = 'S'
  9104           OR  FIRST-TIME
  9105             MOVE SPACES         TO  PI-ACCT-CARRIER
  9106         ELSE
  9107             MOVE -1             TO  ACARIERL
  9108             MOVE ER-2059        TO  EMI-ERROR
  9109             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9110     ELSE
  9111         MOVE AL-UANON           TO  ACARIERA
  9112         MOVE ACARIERI           TO  PI-ACCT-CARRIER.
  9113
  9114     IF AGROUPI  =  SPACES  OR  LOW-VALUES
  9115         IF MAINTI  = 'S'
  9116           OR  FIRST-TIME
  9117             MOVE SPACES         TO  PI-ACCT-GROUPING
  9118         ELSE
  9119             MOVE -1             TO  AGROUPL
  9120             MOVE ER-2059        TO  EMI-ERROR
  9121             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9122     ELSE
  9123         IF AGROUPI  =  '0     '
  9124             MOVE -1             TO  AGROUPL
  9125             MOVE ER-0195        TO  EMI-ERROR
  9126             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9127         ELSE
  9128             MOVE AL-UANON       TO  AGROUPA
  9129             MOVE AGROUPI        TO  PI-ACCT-GROUPING.
  9130
  9131     IF ASTATEI  = SPACES  OR  LOW-VALUES
  9132         IF MAINTI  =  'S'
  9133           OR  FIRST-TIME
  9134             MOVE SPACES         TO  PI-ACCT-STATE
  9135         ELSE
  9136             MOVE -1             TO  ASTATEL
  9137             MOVE ER-2059        TO  EMI-ERROR
  9138             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9139     ELSE
  9140         MOVE AL-UANON           TO  ASTATEA
  9141         MOVE ASTATEI            TO  PI-ACCT-STATE.
  9142
  9143     IF AACCTI  = SPACES  OR  LOW-VALUES
  9144        IF MAINTI  = 'S'
  9145          OR  FIRST-TIME
  9146            MOVE SPACES          TO  PI-ACCT-ACCOUNT
  9147        ELSE
  9148            MOVE -1              TO  AACCTL
  9149            MOVE ER-2059         TO  EMI-ERROR
  9150            PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9151     ELSE
  9152         MOVE AL-UANON           TO  AACCTA
  9153         MOVE AACCTI             TO  PI-ACCT-ACCOUNT.
  9154
  9155     IF PI-ACCT-CARRIER  = SPACES
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 189
* EL650.cbl
  9156       AND  (CARR-ACCNT-CNTL
  9157       OR   CARR-ST-ACCNT-CNTL
  9158       OR   CARR-GROUP-ST-ACCNT-CNTL)
  9159         MOVE ER-0193            TO  EMI-ERROR
  9160         MOVE -1                 TO  ACARIERL
  9161         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9162
  9163     IF PI-ACCT-GROUPING  =  SPACES
  9164       AND  CARR-GROUP-ST-ACCNT-CNTL
  9165         MOVE ER-0195            TO  EMI-ERROR
  9166         MOVE -1                 TO  AGROUPL
  9167         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9168
  9169     IF PI-ACCT-STATE  = SPACES
  9170       AND  (ST-ACCNT-CNTL
  9171       OR   CARR-ST-ACCNT-CNTL
  9172       OR   CARR-GROUP-ST-ACCNT-CNTL)
  9173         MOVE ER-0144            TO  EMI-ERROR
  9174         MOVE -1                 TO  ASTATEL
  9175         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9176
  9177     IF MAINTI  =  'S'
  9178       OR  FIRST-TIME
  9179         NEXT SENTENCE
  9180     ELSE
  9181         MOVE PI-ACCT-CCGSA-KEY  TO  KEY-SAVE.
  9182
  9183     IF NOT EMI-NO-ERRORS
  9184         IF EIBTRNID = EL6311-TRANS-ID OR VP6311-TRANS-ID
  9185             GO TO 8100-SEND-INITIAL-MAP
  9186           ELSE
  9187             GO TO 8200-SEND-DATAONLY.
  9188
  9189     IF PI-ACCT-CARRIER   = SPACES  OR
  9190        PI-ACCT-STATE     = SPACES  OR
  9191        PI-ACCT-GROUPING  = SPACES
  9192         MOVE ACCT2-FILE-ID      TO  PI-ACCT-ID
  9193     ELSE
  9194         MOVE ACCT-FILE-ID       TO  PI-ACCT-ID.
  9195
  9196     MOVE LOW-VALUES             TO  PI-ACCT-EXP-DT
  9197                                     PI-ACCT-REST-OF-EXP.
  9198
  9199 6199-EXIT.
  9200     EXIT.
  9201
  9202 6200-CHECK-KEY.
  9203     IF PI-PREV-ACCOUNT  NOT = PI-ACCT-CCGSA-KEY
  9204         MOVE ER-0453            TO  EMI-ERROR
  9205         MOVE -1                 TO  MAINTL
  9206         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9207
  9208 6200-EXIT.
  9209     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 190
* EL650.cbl
  9211 6300-STARTBR.
  9212     MOVE ACCT-FILE-ID           TO  PI-ACCT-ID.
  9213
  9214
  9215* EXEC CICS  STARTBR
  9216*        DATASET  (PI-ACCT-ID)
  9217*        RIDFLD   (PI-ACCT-KEY)
  9218*    END-EXEC.
  9219     MOVE 0
  9220       TO DFHEIV11
  9221*    MOVE '&,         G          &   #00008197' TO DFHEIV0
  9222     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9223     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9224     MOVE X'2020233030303038313937' TO DFHEIV0(25:11)
  9225     CALL 'kxdfhei1' USING DFHEIV0,
  9226           PI-ACCT-ID,
  9227           PI-ACCT-KEY,
  9228           DFHEIV99,
  9229           DFHEIV11,
  9230           DFHEIV99
  9231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9232
  9233
  9234     MOVE 'Y'                    TO  BROWSE-STARTED-SW.
  9235     MOVE PI-ACCT-CCGSA-KEY      TO  KEY-SAVE.
  9236
  9237 6300-EXIT.
  9238     EXIT.
  9239
  9240 6310-READNEXT.
  9241
  9242* EXEC CICS  READNEXT
  9243*        DATASET  (PI-ACCT-ID)
  9244*        SET      (ADDRESS OF ACCOUNT-MASTER)
  9245*        RIDFLD   (PI-ACCT-KEY)
  9246*    END-EXEC.
  9247     MOVE 0
  9248       TO DFHEIV11
  9249*    MOVE '&.S                   )   #00008209' TO DFHEIV0
  9250     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  9251     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  9252     MOVE X'2020233030303038323039' TO DFHEIV0(25:11)
  9253     CALL 'kxdfhei1' USING DFHEIV0,
  9254           PI-ACCT-ID,
  9255           DFHEIV20,
  9256           DFHEIV99,
  9257           PI-ACCT-KEY,
  9258           DFHEIV99,
  9259           DFHEIV11,
  9260           DFHEIV99,
  9261           DFHEIV99
  9262     SET ADDRESS OF ACCOUNT-MASTER TO
  9263         DFHEIV20
  9264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9265
  9266
  9267 6310-EXIT.
  9268     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 191
* EL650.cbl
  9269
  9270 6320-ENDBR.
  9271     MOVE SPACE                  TO  BROWSE-STARTED-SW.
  9272
  9273
  9274* EXEC CICS  ENDBR
  9275*        DATASET  (PI-ACCT-ID)
  9276*    END-EXEC.
  9277     MOVE 0
  9278       TO DFHEIV11
  9279*    MOVE '&2                    $   #00008221' TO DFHEIV0
  9280     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  9281     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9282     MOVE X'2020233030303038323231' TO DFHEIV0(25:11)
  9283     CALL 'kxdfhei1' USING DFHEIV0,
  9284           PI-ACCT-ID,
  9285           DFHEIV11,
  9286           DFHEIV99
  9287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9288
  9289
  9290 6320-EXIT.
  9291     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 192
* EL650.cbl
  9293 6400-BUILD-VG-KEY.
  9294     MOVE AM-CONTROL-PRIMARY     TO  AM-CONTROL-BY-VAR-GRP.
  9295
  9296     IF ST-ACCNT-CNTL
  9297         MOVE SPACES             TO  AM-VG-CARRIER
  9298                                     AM-VG-GROUPING.
  9299
  9300     IF CARR-ST-ACCNT-CNTL
  9301         MOVE SPACES             TO  AM-VG-GROUPING.
  9302
  9303     IF ACCNT-CNTL
  9304         MOVE SPACES             TO  AM-VG-CARRIER
  9305                                     AM-VG-STATE
  9306                                     AM-VG-GROUPING.
  9307
  9308     IF CARR-ACCNT-CNTL
  9309         MOVE SPACES             TO  AM-VG-STATE
  9310                                     AM-VG-GROUPING.
  9311
  9312 6499-EXIT.
  9313     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 193
* EL650.cbl
  9315 6500-READ-ACCT.
  9316
  9317* EXEC CICS  HANDLE CONDITION
  9318*        NOTFND  (6599-EXIT)
  9319*    END-EXEC.
  9320*    MOVE '"$I                   ! 7 #00008251' TO DFHEIV0
  9321     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9322     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9323     MOVE X'3720233030303038323531' TO DFHEIV0(25:11)
  9324     CALL 'kxdfhei1' USING DFHEIV0
  9325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9326
  9327
  9328     MOVE ZERO                   TO  REC-SW.
  9329
  9330
  9331* EXEC CICS  READ
  9332*        GTEQ
  9333*        DATASET  (ACCT-FILE-ID)
  9334*        SET      (ADDRESS OF ACCOUNT-MASTER)
  9335*        RIDFLD   (PI-ACCT-KEY)
  9336*    END-EXEC.
  9337*    MOVE '&"S        G          (   #00008257' TO DFHEIV0
  9338     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  9339     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9340     MOVE X'2020233030303038323537' TO DFHEIV0(25:11)
  9341     CALL 'kxdfhei1' USING DFHEIV0,
  9342           ACCT-FILE-ID,
  9343           DFHEIV20,
  9344           DFHEIV99,
  9345           PI-ACCT-KEY,
  9346           DFHEIV99,
  9347           DFHEIV99,
  9348           DFHEIV99
  9349     SET ADDRESS OF ACCOUNT-MASTER TO
  9350         DFHEIV20
  9351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9352
  9353
  9354     MOVE AM-CONTROL-PRIMARY     TO  PI-ACCT-KEY.
  9355     MOVE LOW-VALUES             TO  PI-ACCT-REST-OF-EXP.
  9356
  9357     IF PI-ACCT-CCGSA-KEY  = NEW-KEY-SAVE
  9358         MOVE 1                  TO  REC-SW.
  9359
  9360 6599-EXIT.
  9361     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 194
* EL650.cbl
  9363 6600-UPDATE-MAINT-DT.
  9364     MOVE SPACES                 TO  ELCNTL-KEY.
  9365     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9366     MOVE '1'                    TO  CNTL-REC-TYPE.
  9367     MOVE +0                     TO  CNTL-SEQ-NO.
  9368
  9369
  9370* EXEC CICS  HANDLE CONDITION
  9371*        NOTFND  (6699-EXIT)
  9372*    END-EXEC.
  9373*    MOVE '"$I                   ! 8 #00008279' TO DFHEIV0
  9374     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9375     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9376     MOVE X'3820233030303038323739' TO DFHEIV0(25:11)
  9377     CALL 'kxdfhei1' USING DFHEIV0
  9378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9379
  9380
  9381
  9382* EXEC CICS  READ
  9383*        UPDATE
  9384*        DATASET  (CNTL-FILE-ID)
  9385*        SET      (ADDRESS OF CONTROL-FILE)
  9386*        RIDFLD   (ELCNTL-KEY)
  9387*    END-EXEC.
  9388*    MOVE '&"S        EU         (   #00008283' TO DFHEIV0
  9389     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9390     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9391     MOVE X'2020233030303038323833' TO DFHEIV0(25:11)
  9392     CALL 'kxdfhei1' USING DFHEIV0,
  9393           CNTL-FILE-ID,
  9394           DFHEIV20,
  9395           DFHEIV99,
  9396           ELCNTL-KEY,
  9397           DFHEIV99,
  9398           DFHEIV99,
  9399           DFHEIV99
  9400     SET ADDRESS OF CONTROL-FILE TO
  9401         DFHEIV20
  9402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9403
  9404
  9405     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9406     MOVE 'B'                    TO  JP-RECORD-TYPE.
  9407     MOVE CNTL-FILE-ID           TO  FILE-ID.
  9408
  9409     PERFORM 8400-LOG-JOURNAL-RECORD.
  9410
  9411     MOVE BIN-CURRENT-SAVE       TO  CF-ACCOUNT-MSTR-MAINT-DT.
  9412     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  9413     MOVE 'C'                    TO  JP-RECORD-TYPE.
  9414     MOVE CNTL-FILE-ID           TO  FILE-ID.
  9415
  9416
  9417* EXEC CICS  REWRITE
  9418*        DATASET  (CNTL-FILE-ID)
  9419*        FROM     (CONTROL-FILE)
  9420*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 195
* EL650.cbl
  9421     MOVE LENGTH OF
  9422      CONTROL-FILE
  9423       TO DFHEIV11
  9424*    MOVE '&& L                  %   #00008301' TO DFHEIV0
  9425     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9426     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9427     MOVE X'2020233030303038333031' TO DFHEIV0(25:11)
  9428     CALL 'kxdfhei1' USING DFHEIV0,
  9429           CNTL-FILE-ID,
  9430           CONTROL-FILE,
  9431           DFHEIV11,
  9432           DFHEIV99
  9433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9434
  9435
  9436     PERFORM 8400-LOG-JOURNAL-RECORD.
  9437
  9438 6699-EXIT.
  9439     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 196
* EL650.cbl
  9441 6700-VERIFY-STATE-CARRIER.
  9442     IF PI-ACCT-CARRIER  = SPACES
  9443         GO TO 6750-CHECK-STATE.
  9444
  9445     MOVE SPACES                 TO  ELCNTL-KEY.
  9446     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9447     MOVE '6'                    TO  CNTL-REC-TYPE.
  9448     MOVE PI-ACCT-CARRIER        TO  CNTL-CARRIER
  9449     MOVE +0                     TO  CNTL-SEQ-NO.
  9450
  9451
  9452* EXEC CICS  HANDLE CONDITION
  9453*        NOTFND  (6720-NO-CARRIER)
  9454*    END-EXEC.
  9455*    MOVE '"$I                   ! 9 #00008321' TO DFHEIV0
  9456     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9457     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9458     MOVE X'3920233030303038333231' TO DFHEIV0(25:11)
  9459     CALL 'kxdfhei1' USING DFHEIV0
  9460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9461
  9462
  9463
  9464* EXEC CICS  READ
  9465*        DATASET  (CNTL-FILE-ID)
  9466*        SET      (ADDRESS OF CONTROL-FILE)
  9467*        RIDFLD   (ELCNTL-KEY)
  9468*    END-EXEC.
  9469*    MOVE '&"S        E          (   #00008325' TO DFHEIV0
  9470     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9471     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9472     MOVE X'2020233030303038333235' TO DFHEIV0(25:11)
  9473     CALL 'kxdfhei1' USING DFHEIV0,
  9474           CNTL-FILE-ID,
  9475           DFHEIV20,
  9476           DFHEIV99,
  9477           ELCNTL-KEY,
  9478           DFHEIV99,
  9479           DFHEIV99,
  9480           DFHEIV99
  9481     SET ADDRESS OF CONTROL-FILE TO
  9482         DFHEIV20
  9483     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9484
  9485
  9486     GO TO 6750-CHECK-STATE.
  9487
  9488 6720-NO-CARRIER.
  9489     MOVE ER-0193                TO  EMI-ERROR.
  9490     MOVE -1                     TO  ACARIERL.
  9491     MOVE AL-UABON               TO  ACARIERA.
  9492
  9493     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9494
  9495 6750-CHECK-STATE.
  9496     IF PI-ACCT-STATE  =  SPACES
  9497         GO TO 6799-EXIT.
  9498
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 197
* EL650.cbl
  9499     MOVE SPACES                 TO  ELCNTL-KEY.
  9500     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9501     MOVE '3'                    TO  CNTL-REC-TYPE.
  9502     MOVE PI-ACCT-STATE          TO  CNTL-STATE.
  9503     MOVE +0                     TO  CNTL-SEQ-NO.
  9504
  9505
  9506* EXEC CICS  HANDLE CONDITION
  9507*        NOTFND  (6780-NO-STATE)
  9508*    END-EXEC.
  9509*    MOVE '"$I                   ! : #00008350' TO DFHEIV0
  9510     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9511     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9512     MOVE X'3A20233030303038333530' TO DFHEIV0(25:11)
  9513     CALL 'kxdfhei1' USING DFHEIV0
  9514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9515
  9516
  9517
  9518* EXEC CICS  READ
  9519*        DATASET  (CNTL-FILE-ID)
  9520*        SET      (ADDRESS OF CONTROL-FILE)
  9521*        RIDFLD   (ELCNTL-KEY)
  9522*    END-EXEC.
  9523*    MOVE '&"S        E          (   #00008354' TO DFHEIV0
  9524     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9525     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9526     MOVE X'2020233030303038333534' TO DFHEIV0(25:11)
  9527     CALL 'kxdfhei1' USING DFHEIV0,
  9528           CNTL-FILE-ID,
  9529           DFHEIV20,
  9530           DFHEIV99,
  9531           ELCNTL-KEY,
  9532           DFHEIV99,
  9533           DFHEIV99,
  9534           DFHEIV99
  9535     SET ADDRESS OF CONTROL-FILE TO
  9536         DFHEIV20
  9537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9538
  9539
  9540     GO TO 6799-EXIT.
  9541
  9542 6780-NO-STATE.
  9543     MOVE ER-0144                TO  EMI-ERROR.
  9544     MOVE -1                     TO  ASTATEL.
  9545     MOVE AL-UABON               TO  ASTATEA.
  9546
  9547     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9548
  9549 6799-EXIT.
  9550     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 198
* EL650.cbl
  9552 6800-COMPANY-REC-READ.
  9553     MOVE SPACES                 TO  ELCNTL-KEY.
  9554     MOVE PI-COMPANY-ID          TO  CNTL-COMP-ID.
  9555     MOVE '1'                    TO  CNTL-REC-TYPE.
  9556     MOVE +0                     TO  CNTL-SEQ-NO.
  9557
  9558
  9559* EXEC CICS  HANDLE CONDITION
  9560*        NOTFND  (6880-NO-COMP)
  9561*    END-EXEC.
  9562*    MOVE '"$I                   ! ; #00008378' TO DFHEIV0
  9563     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9565     MOVE X'3B20233030303038333738' TO DFHEIV0(25:11)
  9566     CALL 'kxdfhei1' USING DFHEIV0
  9567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9568
  9569
  9570
  9571* EXEC CICS  READ
  9572*        DATASET  (CNTL-FILE-ID)
  9573*        SET      (ADDRESS OF CONTROL-FILE)
  9574*        RIDFLD   (ELCNTL-KEY)
  9575*    END-EXEC.
  9576*    MOVE '&"S        E          (   #00008382' TO DFHEIV0
  9577     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9578     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9579     MOVE X'2020233030303038333832' TO DFHEIV0(25:11)
  9580     CALL 'kxdfhei1' USING DFHEIV0,
  9581           CNTL-FILE-ID,
  9582           DFHEIV20,
  9583           DFHEIV99,
  9584           ELCNTL-KEY,
  9585           DFHEIV99,
  9586           DFHEIV99,
  9587           DFHEIV99
  9588     SET ADDRESS OF CONTROL-FILE TO
  9589         DFHEIV20
  9590     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9591
  9592
  9593     IF CF-ACCOUNT-MSTR-MAINT-DT  = LOW-VALUES
  9594         MOVE ER-2572            TO  EMI-ERROR
  9595         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9596
  9597     GO TO 6899-EXIT.
  9598
  9599 6880-NO-COMP.
  9600     MOVE ER-0022                TO  EMI-ERROR.
  9601
  9602     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9603
  9604 6899-EXIT.
  9605     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 199
* EL650.cbl
  9607 7000-BUILD-OUTPUT-MAP.
  9608     IF RETURNING-FROM-6501
  9609         MOVE PI-PREV-VG-ACCOUNT  TO  KEY-SAVE.
  9610
  9611     IF PI-COMPANY-ID  = 'LGX'  OR  'MIC'  OR  'MCC'
  9612         MOVE AL-SANOF           TO  TRNMSG1A
  9613                                     TRNMSG2A
  9614                                     TRNMSG3A
  9615                                     TRNMSG4A.
  9616
  9617     MOVE AL-UANON               TO  ACARIERA
  9618                                     AGROUPA
  9619                                     ASTATEA
  9620                                     AACCTA.
  9621     MOVE SV-CARRIER             TO  ACARIERO.
  9622     MOVE SV-GROUPING            TO  AGROUPO.
  9623     MOVE SV-STATE               TO  ASTATEO.
  9624     MOVE SV-ACCOUNT             TO  AACCTO.
  9625
  9626     SET M-INDEX  TO  1.
  9627
  9628     MOVE LOW-VALUES             TO  MAP-RECORD-AREA.
  9629
  9630     IF PI-MAINT  = 'A'
  9631       AND  PI-RECORD-NOT-CREATED
  9632         MOVE ER-2151            TO  EMI-ERROR
  9633         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  9634         GO TO 7000-END.
  9635
  9636     IF PI-FST-PAGE
  9637         SET T-INDEX   TO  1
  9638     ELSE
  9639     IF PI-2ND-PAGE
  9640         SET T-INDEX   TO  9
  9641     ELSE
  9642     IF PI-3RD-PAGE
  9643         SET T-INDEX   TO  17
  9644     ELSE
  9645         SET T-INDEX   TO  25.
  9646
  9647 7000-LOOP.
  9648     IF PI-BIN-EXP-DT (T-INDEX)  NOT = HIGH-VALUES
  9649         MOVE PI-BIN-EXP-DT (T-INDEX)
  9650                                 TO  DC-BIN-DATE-1
  9651         MOVE SPACE              TO  DC-OPTION-CODE
  9652         PERFORM 9700-DATE-CONVERSION
  9653         IF DATE-CONVERSION-ERROR
  9654             MOVE SPACES         TO  MAP-EXP-DT (M-INDEX)
  9655         ELSE
  9656             MOVE DC-GREG-DATE-1-EDIT
  9657                                 TO  MAP-EXP-DT (M-INDEX)
  9658     ELSE
  9659         MOVE 999999             TO  MAP-EXP-DT-ED (M-INDEX)
  9660         INSPECT MAP-EXP-DT-ED (M-INDEX) CONVERTING SPACES TO '/'.
  9661
  9662     MOVE PI-BIN-EFF-DT (T-INDEX)  TO  DC-BIN-DATE-1.
  9663     MOVE SPACE                    TO  DC-OPTION-CODE.
  9664
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 200
* EL650.cbl
  9665     PERFORM 9700-DATE-CONVERSION.
  9666
  9667     IF DATE-CONVERSION-ERROR
  9668         MOVE SPACES               TO  MAP-EFF-DT (M-INDEX)
  9669     ELSE
  9670         MOVE DC-GREG-DATE-1-EDIT  TO  MAP-EFF-DT (M-INDEX).
  9671
  9672     IF PI-BIN-MAINT-DT (T-INDEX)  = LOW-VALUES
  9673         MOVE SPACES             TO  MAP-LST-MAINT-DT (M-INDEX)
  9674     ELSE
  9675         MOVE PI-BIN-MAINT-DT (T-INDEX)
  9676                                 TO  DC-BIN-DATE-1
  9677         MOVE SPACE              TO  DC-OPTION-CODE
  9678         PERFORM 9700-DATE-CONVERSION
  9679         IF DATE-CONVERSION-ERROR
  9680             MOVE SPACES         TO  MAP-LST-MAINT-DT (M-INDEX)
  9681         ELSE
  9682             MOVE DC-GREG-DATE-1-EDIT
  9683                                 TO  MAP-LST-MAINT-DT (M-INDEX).
  9684
  9685     IF PI-BIN-HI-CERT (T-INDEX)  =  LOW-VALUES
  9686         MOVE SPACES             TO  MAP-HIGH-CERT (M-INDEX)
  9687     ELSE
  9688         MOVE PI-BIN-HI-CERT (T-INDEX)
  9689                                 TO  DC-BIN-DATE-1
  9690         MOVE SPACE              TO  DC-OPTION-CODE
  9691         PERFORM 9700-DATE-CONVERSION
  9692         IF DATE-CONVERSION-ERROR
  9693             MOVE SPACES         TO  MAP-HIGH-CERT (M-INDEX)
  9694         ELSE
  9695             MOVE DC-GREG-DATE-1-EDIT
  9696                                 TO  MAP-HIGH-CERT (M-INDEX).
  9697
  9698     IF PI-BIN-LO-CERT (T-INDEX)  = LOW-VALUES
  9699         MOVE SPACES             TO  MAP-LOW-CERT (M-INDEX)
  9700     ELSE
  9701         MOVE PI-BIN-LO-CERT (T-INDEX)
  9702                                 TO  DC-BIN-DATE-1
  9703         MOVE SPACE              TO  DC-OPTION-CODE
  9704         PERFORM 9700-DATE-CONVERSION
  9705         IF DATE-CONVERSION-ERROR
  9706             MOVE SPACES         TO  MAP-LOW-CERT (M-INDEX)
  9707         ELSE
  9708             MOVE DC-GREG-DATE-1-EDIT
  9709                                 TO  MAP-LOW-CERT (M-INDEX).
  9710
  9711     IF PI-BIN-AR-HI-CERT (T-INDEX)  = LOW-VALUES OR SPACES
  9712         MOVE SPACES             TO  MAP-AR-DATE (M-INDEX)
  9713     ELSE
  9714         MOVE PI-BIN-AR-HI-CERT (T-INDEX)
  9715                                 TO  DC-BIN-DATE-1
  9716         MOVE SPACE              TO  DC-OPTION-CODE
  9717         PERFORM 9700-DATE-CONVERSION
  9718         IF DATE-CONVERSION-ERROR
  9719             MOVE SPACES         TO  MAP-AR-DATE (M-INDEX)
  9720         ELSE
  9721             MOVE DC-GREG-DATE-1-EDIT
  9722                                 TO  MAP-AR-DATE (M-INDEX).
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 201
* EL650.cbl
  9723
  9724     IF M-INDEX  =  8  OR
  9725        T-INDEX  =  PI-TOTAL-LINES
  9726         NEXT SENTENCE
  9727     ELSE
  9728         SET M-INDEX
  9729             T-INDEX  UP  BY  1
  9730         GO TO 7000-LOOP.
  9731
  9732     IF M-INDEX  =  8
  9733       AND  T-INDEX  LESS THAN  PI-TOTAL-LINES
  9734         MOVE ER-0668            TO  EMI-ERROR
  9735         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9736
  9737     IF T-INDEX  =  PI-TOTAL-LINES
  9738         MOVE ER-0630            TO  EMI-ERROR
  9739         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  9740
  9741 7000-END.
  9742     MOVE -1                     TO  MAINTL.
  9743     MOVE MAINTI                 TO  PI-MAINT.
  9744
  9745     IF MAINTI  = 'S'  OR  'D'
  9746       OR  RETURNING-FROM-6501
  9747         MOVE LOW-VALUES         TO  MAINTI
  9748         MOVE PI-ACCNAME         TO  NAMEO
  9749         MOVE PI-NAMEFLG         TO  NAMEFLGO
  9750         GO TO 8100-SEND-INITIAL-MAP.
  9751
  9752     IF EIBAID  =  DFHPF1  OR  DFHPF2  OR
  9753                   DFHPF3  OR  DFHPF4
  9754         MOVE 'S'                TO  PI-MAINT
  9755         MOVE PI-ACCNAME         TO  NAMEO
  9756         MOVE PI-NAMEFLG         TO  NAMEFLGO
  9757         GO TO 8100-SEND-INITIAL-MAP.
  9758
  9759     IF MAINTI  = 'N' OR 'E' OR 'X'
  9760        MOVE SPACES                 TO  BIN-EXPCHG-SAVE
  9761                                        BIN-EFFCHG-SAVE
  9762        MOVE SPACES                 TO  EFFCHGI
  9763                                        EXPCHGI
  9764        MOVE AL-UANOF               TO  EFFCHGA
  9765                                        EXPCHGA
  9766        MOVE SPACES                 TO  PI-MAINT
  9767        MOVE SPACES                 TO  MAINTI
  9768                                        MAINTO
  9769        MOVE AL-UANOF               TO  MAINTA.
  9770
  9771     IF K-WITH-LINE-NO
  9772         MOVE ZERO         TO K-WITH-LINE-USED
  9773         GO TO 8100-SEND-INITIAL-MAP.
  9774
  9775     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 202
* EL650.cbl
  9777 7100-START-BROWSE.
  9778
  9779* EXEC CICS  STARTBR
  9780*        DATASET  (PI-ACCT-ID)
  9781*        RIDFLD   (PI-ACCT-KEY)
  9782*    END-EXEC.
  9783     MOVE 0
  9784       TO DFHEIV11
  9785*    MOVE '&,         G          &   #00008573' TO DFHEIV0
  9786     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  9787     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  9788     MOVE X'2020233030303038353733' TO DFHEIV0(25:11)
  9789     CALL 'kxdfhei1' USING DFHEIV0,
  9790           PI-ACCT-ID,
  9791           PI-ACCT-KEY,
  9792           DFHEIV99,
  9793           DFHEIV11,
  9794           DFHEIV99
  9795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9796
  9797
  9798 7100-EXIT.
  9799     EXIT.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 203
* EL650.cbl
  9801 7200-WRITE-TEMP-STORAGE.
  9802     PERFORM 7300-DELETE-TEMP-STORAGE  THRU  7300-EXIT.
  9803
  9804
  9805* EXEC CICS  HANDLE CONDITION
  9806*        ITEMERR  (7200-EXIT)
  9807*        QIDERR   (7200-EXIT)
  9808*    END-EXEC.
  9809*    MOVE '"$<N                  ! < #00008584' TO DFHEIV0
  9810     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9811     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9812     MOVE X'3C20233030303038353834' TO DFHEIV0(25:11)
  9813     CALL 'kxdfhei1' USING DFHEIV0
  9814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9815
  9816
  9817     MOVE +0                     TO  TS-ITEM.
  9818
  9819
  9820* EXEC CICS  WRITEQ TS
  9821*        QUEUE   (TS-QUEUE)
  9822*        FROM    (TEMP-STORAGE-RECORD)
  9823*        LENGTH  (TS-LENGTH)
  9824*        ITEM    (TS-ITEM)
  9825*    END-EXEC.
  9826*    MOVE '*" I                  ''   #00008591' TO DFHEIV0
  9827     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  9828     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9829     MOVE X'2020233030303038353931' TO DFHEIV0(25:11)
  9830     CALL 'kxdfhei1' USING DFHEIV0,
  9831           TS-QUEUE,
  9832           TEMP-STORAGE-RECORD,
  9833           TS-LENGTH,
  9834           TS-ITEM,
  9835           DFHEIV99,
  9836           DFHEIV99
  9837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9838
  9839
  9840 7200-EXIT.
  9841     EXIT.
  9842
  9843 7300-DELETE-TEMP-STORAGE.
  9844
  9845* EXEC CICS  HANDLE CONDITION
  9846*        ITEMERR  (7300-EXIT)
  9847*        QIDERR   (7300-EXIT)
  9848*    END-EXEC.
  9849*    MOVE '"$<N                  ! = #00008602' TO DFHEIV0
  9850     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9851     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9852     MOVE X'3D20233030303038363032' TO DFHEIV0(25:11)
  9853     CALL 'kxdfhei1' USING DFHEIV0
  9854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9855
  9856
  9857
  9858* EXEC CICS  DELETEQ TS
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 204
* EL650.cbl
  9859*        QUEUE  (TS-QUEUE)
  9860*    END-EXEC.
  9861*    MOVE '*&                    #   #00008607' TO DFHEIV0
  9862     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  9863     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9864     MOVE X'2020233030303038363037' TO DFHEIV0(25:11)
  9865     CALL 'kxdfhei1' USING DFHEIV0,
  9866           TS-QUEUE,
  9867           DFHEIV99
  9868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9869
  9870
  9871 7300-EXIT.
  9872     EXIT.
  9873
  9874 7400-READ-TEMP-STORAGE.
  9875
  9876* EXEC CICS  HANDLE CONDITION
  9877*        ITEMERR  (7400-EXIT)
  9878*        QIDERR   (7400-EXIT)
  9879*    END-EXEC.
  9880*    MOVE '"$<N                  ! > #00008615' TO DFHEIV0
  9881     MOVE X'22243C4E2020202020202020' TO DFHEIV0(1:12)
  9882     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9883     MOVE X'3E20233030303038363135' TO DFHEIV0(25:11)
  9884     CALL 'kxdfhei1' USING DFHEIV0
  9885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9886
  9887
  9888     MOVE +1                     TO  TS-ITEM.
  9889
  9890
  9891* EXEC CICS  READQ TS
  9892*        QUEUE   (TS-QUEUE)
  9893*        INTO    (TEMP-STORAGE-RECORD)
  9894*        LENGTH  (TS-LENGTH)
  9895*        ITEM    (TS-ITEM)
  9896*    END-EXEC.
  9897*    MOVE '*$II   L              ''   #00008622' TO DFHEIV0
  9898     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  9899     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9900     MOVE X'2020233030303038363232' TO DFHEIV0(25:11)
  9901     CALL 'kxdfhei1' USING DFHEIV0,
  9902           TS-QUEUE,
  9903           TEMP-STORAGE-RECORD,
  9904           TS-LENGTH,
  9905           TS-ITEM,
  9906           DFHEIV99,
  9907           DFHEIV99
  9908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9909
  9910
  9911 7400-EXIT.
  9912     EXIT.
  9913
  9914 8100-SEND-INITIAL-MAP.
  9915     MOVE SAVE-DATE              TO  DATEO.
  9916     MOVE EIBTIME                TO  TIME-IN.
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 205
* EL650.cbl
  9917     MOVE TIME-OUT               TO  TIMEO.
  9918     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9919     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9920     MOVE -1                     TO  MAINTL.
  9921     MOVE AL-UABON               TO  MAINTA.
  9922     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9923     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9924
  9925     IF PI-AR-PROCESSING
  9926        MOVE AL-PANOF            TO  ARHDGA.
  9927
  9928
  9929* EXEC CICS  SEND
  9930*        MAP     (MAP-NAME)
  9931*        MAPSET  (MAPSET-NAME)
  9932*        FROM    (EL650AO)
  9933*        ERASE
  9934*        CURSOR
  9935*    END-EXEC.
  9936     MOVE LENGTH OF
  9937      EL650AO
  9938       TO DFHEIV12
  9939     MOVE -1
  9940       TO DFHEIV11
  9941*    MOVE '8$     CT  E    H L F ,   #00008646' TO DFHEIV0
  9942     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9943     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9944     MOVE X'2020233030303038363436' TO DFHEIV0(25:11)
  9945     CALL 'kxdfhei1' USING DFHEIV0,
  9946           MAP-NAME,
  9947           EL650AO,
  9948           DFHEIV12,
  9949           MAPSET-NAME,
  9950           DFHEIV99,
  9951           DFHEIV99,
  9952           DFHEIV99,
  9953           DFHEIV11,
  9954           DFHEIV99,
  9955           DFHEIV99,
  9956           DFHEIV99
  9957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9958
  9959
  9960     GO TO 9100-RETURN-TRAN.
  9961
  9962 8200-SEND-DATAONLY.
  9963     MOVE SAVE-DATE              TO  DATEO.
  9964     MOVE EIBTIME                TO  TIME-IN.
  9965     MOVE TIME-OUT               TO  TIMEO.
  9966     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  9967     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  9968     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  9969     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  9970
  9971
  9972* EXEC CICS  SEND
  9973*        MAP     (MAP-NAME)
  9974*        MAPSET  (MAPSET-NAME)
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 206
* EL650.cbl
  9975*        FROM    (EL650AO)
  9976*        DATAONLY
  9977*        CURSOR
  9978*    END-EXEC.
  9979     MOVE LENGTH OF
  9980      EL650AO
  9981       TO DFHEIV12
  9982     MOVE -1
  9983       TO DFHEIV11
  9984*    MOVE '8$D    CT       H L F ,   #00008665' TO DFHEIV0
  9985     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9986     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9987     MOVE X'2020233030303038363635' TO DFHEIV0(25:11)
  9988     CALL 'kxdfhei1' USING DFHEIV0,
  9989           MAP-NAME,
  9990           EL650AO,
  9991           DFHEIV12,
  9992           MAPSET-NAME,
  9993           DFHEIV99,
  9994           DFHEIV99,
  9995           DFHEIV99,
  9996           DFHEIV11,
  9997           DFHEIV99,
  9998           DFHEIV99,
  9999           DFHEIV99
 10000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10001
 10002
 10003     GO TO 9100-RETURN-TRAN.
 10004
 10005 8300-SEND-TEXT.
 10006
 10007* EXEC CICS  SEND TEXT
 10008*        FROM    (LOGOFF-TEXT)
 10009*        LENGTH  (LOGOFF-LENGTH)
 10010*        ERASE
 10011*        FREEKB
 10012*    END-EXEC.
 10013*    MOVE '8&      T  E F  H   F -   #00008676' TO DFHEIV0
 10014     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 10015     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 10016     MOVE X'2020233030303038363736' TO DFHEIV0(25:11)
 10017     CALL 'kxdfhei1' USING DFHEIV0,
 10018           LOGOFF-TEXT,
 10019           LOGOFF-LENGTH,
 10020           DFHEIV99,
 10021           DFHEIV99,
 10022           DFHEIV99,
 10023           DFHEIV99,
 10024           DFHEIV99,
 10025           DFHEIV99,
 10026           DFHEIV99,
 10027           DFHEIV99,
 10028           DFHEIV99,
 10029           DFHEIV99
 10030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10031
 10032
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 207
* EL650.cbl
 10033
 10034* EXEC CICS  RETURN
 10035*    END-EXEC.
 10036*    MOVE '.(                    ''   #00008683' TO DFHEIV0
 10037     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 10038     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10039     MOVE X'2020233030303038363833' TO DFHEIV0(25:11)
 10040     CALL 'kxdfhei1' USING DFHEIV0,
 10041           DFHEIV99,
 10042           DFHEIV99,
 10043           DFHEIV99,
 10044           DFHEIV99,
 10045           DFHEIV99,
 10046           DFHEIV99
 10047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10048
 10049
 10050 8400-LOG-JOURNAL-RECORD.
 10051*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
 10052*    MOVE FILE-ID                TO  JP-FILE-ID.
 10053*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
 10054*
 10055*    IF PI-JOURNAL-FILE-ID  NOT =  ZERO
 10056*        EXEC CICS  JOURNAL
 10057*            JFILEID  (PI-JOURNAL-FILE-ID)
 10058*            JTYPEID  ('ER')
 10059*            FROM     (JOURNAL-RECORD)
 10060*            LENGTH   (2023)
 10061*        END-EXEC.
 10062
 10063 8600-DEEDIT.
 10064
 10065* EXEC CICS  BIF DEEDIT
 10066*        FIELD   (WS-DEEDIT-FIELD)
 10067*        LENGTH  (10)
 10068*    END-EXEC.
 10069     MOVE 10
 10070       TO DFHEIV11
 10071*    MOVE '@"L                   #   #00008700' TO DFHEIV0
 10072     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 10073     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10074     MOVE X'2020233030303038373030' TO DFHEIV0(25:11)
 10075     CALL 'kxdfhei1' USING DFHEIV0,
 10076           WS-DEEDIT-FIELD,
 10077           DFHEIV11
 10078     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10079
 10080 8600-EXIT.
 10081      EXIT.
 10082 8800-UNAUTHORIZED-ACCESS.
 10083     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
 10084
 10085     GO TO 8300-SEND-TEXT.
 10086
 10087 8810-PF23.
 10088     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
 10089     MOVE XCTL-005               TO  PGM-NAME.
 10090
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 208
* EL650.cbl
 10091     GO TO 9300-XCTL.
 10092
 10093 8900-PF5.
 10094     IF PI-PREV-VG-ACCOUNT EQUAL LOW-VALUES OR SPACES
 10095         MOVE ER-3785            TO  EMI-ERROR
 10096         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
 10097         MOVE -1                 TO  MAINTL
 10098         GO TO 8200-SEND-DATAONLY.
 10099
 10100     MOVE PI-PREV-VG-ACCOUNT     TO  PI-ACCT-CCGSA-KEY.
 10101
 10102     MOVE XCTL-6509              TO  PGM-NAME.
 10103
 10104     GO TO 9300-XCTL.
 10105
 10106 8910-PF6.
 10107     IF PI-PREV-VG-ACCOUNT EQUAL LOW-VALUES OR SPACES
 10108        MOVE ER-3785             TO EMI-ERROR
 10109        PERFORM 9900-ERROR-FORMAT
 10110                                 THRU 9900-EXIT
 10111        MOVE -1                  TO MAINTL
 10112        GO TO 8200-SEND-DATAONLY
 10113     END-IF
 10114     MOVE PI-PREV-VG-ACCOUNT     TO PI-ACCT-CCGSA-KEY
 10115     MOVE XCTL-6503              TO PGM-NAME
 10116     GO TO 9300-XCTL
 10117     .
 10118 9100-RETURN-TRAN.
 10119     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
 10120     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
 10121
 10122* EXEC CICS  RETURN
 10123*        TRANSID   (TRANS-ID)
 10124*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10125*        LENGTH    (WS-COMM-LENGTH)
 10126*    END-EXEC.
 10127*    MOVE '.(CT                  ''   #00008745' TO DFHEIV0
 10128     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 10129     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10130     MOVE X'2020233030303038373435' TO DFHEIV0(25:11)
 10131     CALL 'kxdfhei1' USING DFHEIV0,
 10132           TRANS-ID,
 10133           PROGRAM-INTERFACE-BLOCK,
 10134           WS-COMM-LENGTH,
 10135           DFHEIV99,
 10136           DFHEIV99,
 10137           DFHEIV99
 10138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10139
 10140
 10141 9200-RETURN-MAIN-MENU.
 10142     MOVE XCTL-126               TO  PGM-NAME.
 10143
 10144     GO TO 9300-XCTL.
 10145
 10146 9300-XCTL.
 10147
 10148* EXEC CICS  XCTL
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 209
* EL650.cbl
 10149*        PROGRAM   (PGM-NAME)
 10150*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
 10151*        LENGTH    (WS-COMM-LENGTH)
 10152*    END-EXEC.
 10153*    MOVE '.$C                   %   #00008757' TO DFHEIV0
 10154     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 10155     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
 10156     MOVE X'2020233030303038373537' TO DFHEIV0(25:11)
 10157     CALL 'kxdfhei1' USING DFHEIV0,
 10158           PGM-NAME,
 10159           PROGRAM-INTERFACE-BLOCK,
 10160           WS-COMM-LENGTH,
 10161           DFHEIV99
 10162     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10163
 10164
 10165 9400-CLEAR.
 10166     MOVE SPACES                 TO  PI-SV-MAINT.
 10167     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
 10168
 10169     GO TO 9300-XCTL.
 10170
 10171 9500-PF12.
 10172     MOVE XCTL-010               TO  PGM-NAME.
 10173
 10174     GO TO 9300-XCTL.
 10175
 10176 9600-PGMID-ERROR.
 10177
 10178* EXEC CICS  HANDLE CONDITION
 10179*        PGMIDERR  (8300-SEND-TEXT)
 10180*    END-EXEC.
 10181*    MOVE '"$L                   ! ? #00008775' TO DFHEIV0
 10182     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 10183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10184     MOVE X'3F20233030303038373735' TO DFHEIV0(25:11)
 10185     CALL 'kxdfhei1' USING DFHEIV0
 10186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10187
 10188
 10189     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
 10190     MOVE ' '                    TO  PI-ENTRY-CD-1.
 10191     MOVE XCTL-005               TO  PGM-NAME.
 10192     MOVE PGM-NAME               TO  LOGOFF-PGM.
 10193     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
 10194
 10195     GO TO 9300-XCTL.
 10196
 10197 9700-DATE-CONVERSION.
 10198     MOVE LINK-ELDATCV           TO  PGM-NAME.
 10199
 10200
 10201* EXEC CICS  LINK
 10202*        PROGRAM   (PGM-NAME)
 10203*        COMMAREA  (DATE-CONVERSION-DATA)
 10204*        LENGTH    (DC-COMM-LENGTH)
 10205*    END-EXEC.
 10206*    MOVE '."C                   (   #00008790' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 210
* EL650.cbl
 10207     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10208     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10209     MOVE X'2020233030303038373930' TO DFHEIV0(25:11)
 10210     CALL 'kxdfhei1' USING DFHEIV0,
 10211           PGM-NAME,
 10212           DATE-CONVERSION-DATA,
 10213           DC-COMM-LENGTH,
 10214           DFHEIV99,
 10215           DFHEIV99,
 10216           DFHEIV99,
 10217           DFHEIV99
 10218     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10219
 10220
 10221 9900-ERROR-FORMAT.
 10222     IF NOT EMI-ERRORS-COMPLETE
 10223         MOVE LINK-001           TO  PGM-NAME
 10224
 10225* EXEC CICS  LINK
 10226*            PROGRAM   (PGM-NAME)
 10227*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
 10228*            LENGTH    (EMI-COMM-LENGTH)
 10229*        END-EXEC.
 10230*    MOVE '."C                   (   #00008799' TO DFHEIV0
 10231     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10232     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10233     MOVE X'2020233030303038373939' TO DFHEIV0(25:11)
 10234     CALL 'kxdfhei1' USING DFHEIV0,
 10235           PGM-NAME,
 10236           ERROR-MESSAGE-INTERFACE-BLOCK,
 10237           EMI-COMM-LENGTH,
 10238           DFHEIV99,
 10239           DFHEIV99,
 10240           DFHEIV99,
 10241           DFHEIV99
 10242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10243
 10244
 10245 9900-EXIT.
 10246     EXIT.
 10247
 10248 9990-ABEND.
 10249     MOVE LINK-004               TO  PGM-NAME.
 10250     MOVE DFHEIBLK               TO  EMI-LINE1.
 10251
 10252
 10253* EXEC CICS  LINK
 10254*        PROGRAM   (PGM-NAME)
 10255*        COMMAREA  (EMI-LINE1)
 10256*        LENGTH    (72)
 10257*    END-EXEC.
 10258     MOVE 72
 10259       TO DFHEIV11
 10260*    MOVE '."C                   (   #00008812' TO DFHEIV0
 10261     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10262     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10263     MOVE X'2020233030303038383132' TO DFHEIV0(25:11)
 10264     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 211
* EL650.cbl
 10265           PGM-NAME,
 10266           EMI-LINE1,
 10267           DFHEIV11,
 10268           DFHEIV99,
 10269           DFHEIV99,
 10270           DFHEIV99,
 10271           DFHEIV99
 10272     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10273
 10274
 10275     MOVE -1                     TO  MAINTL.
 10276
 10277     GO TO 8200-SEND-DATAONLY.
 10278
 10279 9995-SECURITY-VIOLATION.
 10280*                            COPY ELCSCTP.
 10281******************************************************************
 10282*                                                                *
 10283*                            ELCSCTP                             *
 10284*                            VMOD=2.001                          *
 10285*                                                                *
 10286*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 10287******************************************************************
 10288
 10289
 10290     MOVE EIBDATE          TO SM-JUL-DATE.
 10291     MOVE EIBTRMID         TO SM-TERMID.
 10292     MOVE THIS-PGM         TO SM-PGM.
 10293     MOVE EIBTIME          TO TIME-IN.
 10294     MOVE TIME-OUT         TO SM-TIME.
 10295     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 10296
 10297
 10298* EXEC CICS LINK
 10299*         PROGRAM  ('EL003')
 10300*         COMMAREA (SECURITY-MESSAGE)
 10301*         LENGTH   (80)
 10302*    END-EXEC.
 10303     MOVE 'EL003' TO DFHEIV1
 10304     MOVE 80
 10305       TO DFHEIV11
 10306*    MOVE '."C                   (   #00008840' TO DFHEIV0
 10307     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 10308     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
 10309     MOVE X'2020233030303038383430' TO DFHEIV0(25:11)
 10310     CALL 'kxdfhei1' USING DFHEIV0,
 10311           DFHEIV1,
 10312           SECURITY-MESSAGE,
 10313           DFHEIV11,
 10314           DFHEIV99,
 10315           DFHEIV99,
 10316           DFHEIV99,
 10317           DFHEIV99
 10318     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10319
 10320
 10321******************************************************************
 10322
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 212
* EL650.cbl
 10323
 10324 9995-EXIT.
 10325     EXIT.
 10326
 10327 9999-DFHBACK SECTION.
 10328     MOVE '9%                    "   ' TO DFHEIV0
 10329     MOVE 'EL650' TO DFHEIV1
 10330     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10331     GOBACK.
 10332 9999-DFHEXIT.
 10333     IF DFHEIGDJ EQUAL 0001
 10334         NEXT SENTENCE
 10335     ELSE IF DFHEIGDJ EQUAL 2
 10336         GO TO 5340-END,
 10337               5330-NOT-FOUND
 10338         DEPENDING ON DFHEIGDI
 10339     ELSE IF DFHEIGDJ EQUAL 3
 10340         GO TO 9600-PGMID-ERROR,
 10341               9990-ABEND
 10342         DEPENDING ON DFHEIGDI
 10343     ELSE IF DFHEIGDJ EQUAL 4
 10344         GO TO 1010-NOT-FOUND,
 10345               1010-NOT-FOUND
 10346         DEPENDING ON DFHEIGDI
 10347     ELSE IF DFHEIGDJ EQUAL 5
 10348         GO TO 2568-NO-RECORDS,
 10349               2568-NO-RECORDS
 10350         DEPENDING ON DFHEIGDI
 10351     ELSE IF DFHEIGDJ EQUAL 6
 10352         GO TO 3175-CONTINUE,
 10353               3175-CONTINUE
 10354         DEPENDING ON DFHEIGDI
 10355     ELSE IF DFHEIGDJ EQUAL 7
 10356         GO TO 4175-CONTINUE,
 10357               4175-CONTINUE
 10358         DEPENDING ON DFHEIGDI
 10359     ELSE IF DFHEIGDJ EQUAL 8
 10360         GO TO 4530-NOT-FOUND,
 10361               4530-NOT-FOUND
 10362         DEPENDING ON DFHEIGDI
 10363     ELSE IF DFHEIGDJ EQUAL 9
 10364         GO TO 4699-EXIT,
 10365               4689-EOF
 10366         DEPENDING ON DFHEIGDI
 10367     ELSE IF DFHEIGDJ EQUAL 10
 10368         GO TO 4899-EXIT,
 10369               4889-EOF
 10370         DEPENDING ON DFHEIGDI
 10371     ELSE IF DFHEIGDJ EQUAL 11
 10372         GO TO 4580-DUPREC,
 10373               4580-DUPREC
 10374         DEPENDING ON DFHEIGDI
 10375     ELSE IF DFHEIGDJ EQUAL 12
 10376         GO TO 4959-EXIT,
 10377               4959-EXIT
 10378         DEPENDING ON DFHEIGDI
 10379     ELSE IF DFHEIGDJ EQUAL 13
 10380         GO TO 4969-EXIT,
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 213
* EL650.cbl
 10381               4969-EXIT
 10382         DEPENDING ON DFHEIGDI
 10383     ELSE IF DFHEIGDJ EQUAL 14
 10384         GO TO 4980-EXIT
 10385         DEPENDING ON DFHEIGDI
 10386     ELSE IF DFHEIGDJ EQUAL 15
 10387         GO TO 5007-EXIT,
 10388               5007-EXIT
 10389         DEPENDING ON DFHEIGDI
 10390     ELSE IF DFHEIGDJ EQUAL 16
 10391         GO TO 5007-EXIT,
 10392               5007-EXIT,
 10393               5007-EXIT,
 10394               5007-EXIT,
 10395               5007-EXIT
 10396         DEPENDING ON DFHEIGDI
 10397     ELSE IF DFHEIGDJ EQUAL 17
 10398         GO TO 5015-NOT-FOUND,
 10399               5015-NOT-FOUND
 10400         DEPENDING ON DFHEIGDI
 10401     ELSE IF DFHEIGDJ EQUAL 18
 10402         GO TO 5015-NOT-FOUND,
 10403               5015-NOT-FOUND
 10404         DEPENDING ON DFHEIGDI
 10405     ELSE IF DFHEIGDJ EQUAL 19
 10406         GO TO 5340-END,
 10407               5330-NOT-FOUND
 10408         DEPENDING ON DFHEIGDI
 10409     ELSE IF DFHEIGDJ EQUAL 20
 10410         GO TO 5440-NOT-FOUND,
 10411               5430-NOT-FOUND
 10412         DEPENDING ON DFHEIGDI
 10413     ELSE IF DFHEIGDJ EQUAL 21
 10414         GO TO 5525-SKIP-REWRITE,
 10415               5525-SKIP-REWRITE
 10416         DEPENDING ON DFHEIGDI
 10417     ELSE IF DFHEIGDJ EQUAL 22
 10418         GO TO 5615-SKIP-REWRITE,
 10419               5615-SKIP-REWRITE
 10420         DEPENDING ON DFHEIGDI
 10421     ELSE IF DFHEIGDJ EQUAL 23
 10422         GO TO 6599-EXIT
 10423         DEPENDING ON DFHEIGDI
 10424     ELSE IF DFHEIGDJ EQUAL 24
 10425         GO TO 6699-EXIT
 10426         DEPENDING ON DFHEIGDI
 10427     ELSE IF DFHEIGDJ EQUAL 25
 10428         GO TO 6720-NO-CARRIER
 10429         DEPENDING ON DFHEIGDI
 10430     ELSE IF DFHEIGDJ EQUAL 26
 10431         GO TO 6780-NO-STATE
 10432         DEPENDING ON DFHEIGDI
 10433     ELSE IF DFHEIGDJ EQUAL 27
 10434         GO TO 6880-NO-COMP
 10435         DEPENDING ON DFHEIGDI
 10436     ELSE IF DFHEIGDJ EQUAL 28
 10437         GO TO 7200-EXIT,
 10438               7200-EXIT
* Micro Focus Server Express         V5.1 revision 000 20-Oct-16 12:40 Page 214
* EL650.cbl
 10439         DEPENDING ON DFHEIGDI
 10440     ELSE IF DFHEIGDJ EQUAL 29
 10441         GO TO 7300-EXIT,
 10442               7300-EXIT
 10443         DEPENDING ON DFHEIGDI
 10444     ELSE IF DFHEIGDJ EQUAL 30
 10445         GO TO 7400-EXIT,
 10446               7400-EXIT
 10447         DEPENDING ON DFHEIGDI
 10448     ELSE IF DFHEIGDJ EQUAL 31
 10449         GO TO 8300-SEND-TEXT
 10450         DEPENDING ON DFHEIGDI.
 10451     MOVE '9%                    "   ' TO DFHEIV0
 10452     MOVE 'EL650' TO DFHEIV1
 10453     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 10454     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       40228     Code:       34370
