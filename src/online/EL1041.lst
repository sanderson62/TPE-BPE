* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page   1
* EL1041.cbl
* Options: int("EL1041.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1041.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1041.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1041.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2 PROGRAM-ID.                 EL1041.
     3*
     4*AUTHOR.     PABLO
     5*            OMAHA NE
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF CENTRAL STATES IS EXPRESSLY PROHIBITED       *
    12*            *   WITHOUT THE PRIOR WRITTEN PERMISSION OF         *
    13*            *   CENTRAL STATES                                  *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page   2
* EL1041.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE Z LETTER CONTROLS
    19*    SCREENS     - EL104Z - LETTER (Z) CONTROL MAINTENANCE
    20*    ENTERED BY  - EL1042 - TEXT MAINT
    21*    EXIT TO     - EL1042 - TEXT MAINT
    22*    INPUT FILE  - ELLETR -              - LETTER TEXT
    23*    OUTPUT FILE - ELLETR -              - LETTER TEXT
    24*    COMMAREA    - PASSED
    25*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL1042. ON
    26*                  FIRST ENTRY, WE READ THE ELLETR FILE USING THE
    27*                  LETTER ID PASSED FROM EL1042.     ON SUBSEQUENT
    28*                  ENTRIES (XCTL FROM CICS VIA     ) THE SCREEN
    29*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    30*                  MAINTENANCE TYPE INDICATED.
    31*-----------------------------------------------------------------
    32*                   C H A N G E   L O G
    33*
    34* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    35*-----------------------------------------------------------------
    36*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    37* EFFECTIVE    NUMBER
    38*-----------------------------------------------------------------
    39* 041513    2013011500003  AJRA  VALIDATE ENC CODE AGAINST ELENCC
    40* 092413    2013062000003  AJRA  ADD BARCODE IND (USE ZREC COPYBOO
    41* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    42*-----------------------------------------------------------------
    43 ENVIRONMENT DIVISION.
    44 DATA DIVISION.
    45 WORKING-STORAGE SECTION.
    46 01  DFH-START PIC X(04).
    47 77  FILLER  PIC X(32)  VALUE '********************************'.
    48 77  FILLER  PIC X(32)  VALUE '*   EL1041 WORKING STORAGE     *'.
    49 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.001 *********'.
    50 77  M1                          PIC S999 COMP-3 VALUE +0.
    51 77  M2                          PIC S999 COMP-3 VALUE +0.
    52 77  WS-STOP-SW                  PIC X  VALUE ' '.
    53     88  I-SAY-TO-STOP              VALUE 'Y'.
    54 77  WS-FIND-SW                  PIC X  VALUE ' '.
    55     88  WE-FOUND-IT                VALUE 'Y'.
    56 77  WS-DONE-WITH-ENCC           PIC X  VALUE ' '.
    57     88  DONE-WITH-ENCC             VALUE 'Y'.
    58 77  WS-SEQ-NO-TO-USE            PIC S9(4) COMP VALUE +0.
    59 01  ACCESS-KEYS.
    60     12  ELLETR-KEY.
    61         16  ELLETR-COMPANY-CD   PIC X.
    62         16  ELLETR-ACCESS-CD    PIC X(12).
    63         16  ELLETR-SEQ-NO       PIC S9(4) COMP.
    64
    65     12  ELENCC-KEY.
    66         16  ELENCC-COMPANY-CD    PIC X.
    67         16  ELENCC-REC-TYPE      PIC X.
    68         16  ELENCC-ENC-CODE      PIC X(5).
    69         16  F                    PIC X(09).
    70 01  WS-DATE-AREA.
    71     05  SAVE-DATE                   PIC X(08)   VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page   3
* EL1041.cbl
    72     05  SAVE-BIN-DATE               PIC X(02)   VALUE SPACES.
    73 01  MISC-WORK-AREAS.
    74     12  WS-RESPONSE             PIC S9(8)   COMP.
    75         88  RESP-NORMAL              VALUE +00.
    76         88  RESP-ERROR               VALUE +01.
    77         88  RESP-NOTFND              VALUE +13.
    78         88  RESP-NOTOPEN             VALUE +19.
    79         88  RESP-ENDFILE             VALUE +20.
    80     12  WS-NUMVAL.
    81         16  WS-NUMVAL-OF-DEEDIT     PIC 9(11) VALUE ZEROS.
    82         16  WS-9V999-OF-DEEDIT REDEFINES
    83             WS-NUMVAL-OF-DEEDIT     PIC 9(8)V999.
    84     12  DEEDIT-FIELD                PIC X(11).
    85     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
    86                                     PIC S9(11).
    87     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
    88                                     PIC S9(09)V99.
    89
    90     12  WS-TEST-STATE               PIC X(2) VALUE SPACES.
    91         88 STATE-SPECIFIC    VALUES 'AK','AL','AR','AS','AZ',
    92            'CA','CO','CT','DC','DE','FL','GA','GU','HI','IA',
    93            'ID','IL','IN','KS','KY','LA','MA','MD','ME','MI',
    94            'MN','MO','MS','MT','NC','ND','NE','NH','NJ','NM',
    95            'NV','NY','OH','OK','OR','PA','PR','RI','SC','SD',
    96            'TN','TX','UT','VA','VI','VT','WA','WI','WV','WY'.
    97 01  STANDARD-AREAS.
    98     12  SC-ITEM                     PIC S9(4)   VALUE +1  COMP.
    99     12  TRANS-ID                    PIC X(04)   VALUE 'EX1E'.
   100     12  PGM-NAME                    PIC X(08).
   101     12  TIME-IN                     PIC S9(07).
   102     12  TIME-OUT-R  REDEFINES TIME-IN.
   103         16  FILLER                  PIC X(01).
   104         16  TIME-OUT                PIC 99V99.
   105         16  FILLER                  PIC X(02).
   106     12  XCTL-005                    PIC X(08)   VALUE 'EL005'.
   107     12  XCTL-010                    PIC X(08)   VALUE 'EL010'.
   108     12  XCTL-155                    PIC X(08)   VALUE 'EL155'.
   109     12  XCTL-626                    PIC X(08)   VALUE 'EL626'.
   110     12  LINK-001                    PIC X(08)   VALUE 'EL001'.
   111     12  LINK-004                    PIC X(08)   VALUE 'EL004'.
   112     12  LINK-ELDATCV                PIC X(08)   VALUE 'ELDATCV'.
   113     12  THIS-PGM                    PIC X(08)   VALUE 'EL1041'.
   114     12  ELLETR-FILE-ID              PIC X(08)   VALUE 'ELLETR'.
   115     12  ELLETR-LENGTH               PIC S9(04)  VALUE +100  COMP.
   116     12  ELENCC-FILE-ID              PIC X(08)   VALUE 'ELENCC'.
   117     12  ELENCC-LENGTH               PIC S9(04)  VALUE +400  COMP.
   118     12  SUB                         PIC 9(02).
   119     12  SUB-1                       PIC 9(02).
   120     12  SUB2                        PIC 9(02).
   121     12  GETMAIN-SPACE               PIC X(01)   VALUE SPACE.
   122     12  MAPSET-NAME                 PIC X(08)   VALUE 'EL1041S'.
   123     12  WS-MAP-NAME                 PIC X(08)   VALUE 'EL104Z'.
   124     12  WS-PF-KEY                   PIC 9(02)   VALUE ZEROS.
   125     12  HOLD-ENC-CODES              PIC X(120)  VALUE SPACES.
   126     12  WS-SUB1                     PIC S9(03).
   127     12  WS-SUB2                     PIC S9(03).
   128     12  WS-SUB3                     PIC S9(03).
   129****  Z RECORD LAYOUT MOVED TO COPYBOOK ELCZREC
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page   4
* EL1041.cbl
   130*                                    COPY ELCZREC.
   131******************************************************************
   132*                                                                *
   133*                                                                *
   134*                            ELCZREC.                            *
   135*                                                                *
   136*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   137*                                                                *
   138******************************************************************
   139*-----------------------------------------------------------------
   140*                   C H A N G E   L O G
   141*
   142* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   143*-----------------------------------------------------------------
   144*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   145* EFFECTIVE    NUMBER
   146*-----------------------------------------------------------------
   147* 122011    2011022800001  AJRA  NEW FILE
   148* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   149* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   150* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   151* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   152*-----------------------------------------------------------------
   153 01  W-Z-CONTROL-DATA.
   154     05  W-NUMBER-OF-COPIES      PIC  9.
   155     05  FILLER                  PIC  X.
   156     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   157     05  FILLER                  PIC  X.
   158     05  W-DAYS-TO-RESEND        PIC  999.
   159     05  FILLER                  PIC  X.
   160     05  W-FORM-TO-RESEND        PIC  X(4).
   161     05  W-ADD-BAR-CODE          PIC  X.
   162     05  W-PROMPT-LETTER         PIC  X.
   163     05  W-HAS-RETURN-ENV        PIC  X.
   164     05  W-ENCLOSURE-CD          PIC  XXX.
   165     05  W-SIG-FLAG-DEFAULT      PIC  X.
   166     05  W-AUTO-CLOSE-IND        PIC  X.
   167     05  FILLER                  PIC  X.
   168     05  W-LETTER-TO-BENE        PIC  X.
   169     05  FILLER                  PIC  X.
   170     05  W-LETTER-TO-ACCT        PIC  X.
   171     05  FILLER                  PIC  X.
   172     05  W-LETTER-TYPE           PIC  X.
   173     05  FILLER                  PIC  X.
   174     05  W-PRINT-CERTIFICATE     PIC  X.
   175     05  FILLER                  PIC  X.
   176     05  W-REFUND-REQUIRED       PIC  X.
   177     05  FILLER                  PIC  X.
   178     05  W-ONBASE-CODE           PIC  XX.
   179     05  FILLER                  PIC  X.
   180     05  W-ACCT-SUMM             PIC  X.
   181     05  FILLER                  PIC  X.
   182     05  W-CSO-SUMM              PIC  X.
   183     05  FILLER                  PIC  X.
   184     05  W-REASONS-REQUIRED      PIC  X.
   185     05  FILLER                  PIC  X(29).
   186*                                    COPY ELCSCTM.
   187******************************************************************
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page   5
* EL1041.cbl
   188*                                                                *
   189*                                                                *
   190*                            ELCSCTM                             *
   191*                            VMOD=2.001                          *
   192*                                                                *
   193*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   194*                                                                *
   195******************************************************************
   196 01  SECURITY-MESSAGE.
   197     12  FILLER                          PIC X(30)
   198            VALUE '** LOGIC SECURITY VIOLATION -'.
   199     12  SM-READ                         PIC X(6).
   200     12  FILLER                          PIC X(5)
   201            VALUE ' PGM='.
   202     12  SM-PGM                          PIC X(6).
   203     12  FILLER                          PIC X(5)
   204            VALUE ' OPR='.
   205     12  SM-PROCESSOR-ID                 PIC X(4).
   206     12  FILLER                          PIC X(6)
   207            VALUE ' TERM='.
   208     12  SM-TERMID                       PIC X(4).
   209     12  FILLER                          PIC XX   VALUE SPACE.
   210     12  SM-JUL-DATE                     PIC 9(5).
   211     12  FILLER                          PIC X    VALUE SPACE.
   212     12  SM-TIME                         PIC 99.99.
   213
   214*                                    COPY ELCSCRTY.
   215******************************************************************
   216*                                                                *
   217*                                                                *
   218*                            ELCSCRTY                            *
   219*                            VMOD=2.001                          *
   220*                                                                *
   221*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   222*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   223*        SAVED IN PI-SECURITY-ADDRESS.                           *
   224*                                                                *
   225******************************************************************
   226 01  SECURITY-CONTROL.
   227     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   228     12  FILLER                       PIC XX    VALUE 'SC'.
   229     12  SC-CREDIT-CODES.
   230         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   231             20  SC-CREDIT-DISPLAY    PIC X.
   232             20  SC-CREDIT-UPDATE     PIC X.
   233     12  SC-CLAIMS-CODES.
   234         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   235             20  SC-CLAIMS-DISPLAY    PIC X.
   236             20  SC-CLAIMS-UPDATE     PIC X.
   237 01  ERROR-MESSAGES.
   238     12  ER-0000                     PIC X(04)   VALUE '0000'.
   239     12  ER-0005                     PIC X(04)   VALUE '0005'.
   240     12  ER-0023                     PIC X(04)   VALUE '0023'.
   241     12  ER-0029                     PIC X(04)   VALUE '0029'.
   242     12  ER-0050                     PIC X(04)   VALUE '0050'.
   243     12  ER-0068                     PIC X(04)   VALUE '0068'.
   244     12  ER-0070                     PIC X(04)   VALUE '0070'.
   245     12  ER-0130                     PIC X(04)   VALUE '0130'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page   6
* EL1041.cbl
   246     12  ER-0131                     PIC X(04)   VALUE '0131'.
   247     12  ER-0132                     PIC X(04)   VALUE '0132'.
   248     12  ER-0138                     PIC X(04)   VALUE '0138'.
   249     12  ER-0144                     PIC X(04)   VALUE '0144'.
   250     12  ER-0145                     PIC X(04)   VALUE '0145'.
   251     12  ER-0184                     PIC X(04)   VALUE '0184'.
   252     12  ER-0418                     PIC X(04)   VALUE '0418'.
   253     12  ER-0491                     PIC X(04)   VALUE '0491'.
   254     12  ER-0582                     PIC X(04)   VALUE '0582'.
   255     12  ER-0627                     PIC X(04)   VALUE '0627'.
   256     12  ER-0701                     PIC X(04)   VALUE '0701'.
   257     12  ER-0702                     PIC X(04)   VALUE '0702'.
   258     12  ER-0703                     PIC X(04)   VALUE '0703'.
   259     12  ER-0704                     PIC X(04)   VALUE '0704'.
   260     12  ER-0705                     PIC X(04)   VALUE '0705'.
   261     12  ER-0706                     PIC X(04)   VALUE '0706'.
   262     12  ER-0707                     PIC X(04)   VALUE '0707'.
   263     12  ER-0708                     PIC X(04)   VALUE '0708'.
   264     12  ER-0709                     PIC X(04)   VALUE '0709'.
   265     12  ER-0710                     PIC X(04)   VALUE '0710'.
   266     12  ER-0711                     PIC X(04)   VALUE '0711'.
   267     12  ER-0712                     PIC X(04)   VALUE '0712'.
   268     12  ER-0713                     PIC X(04)   VALUE '0713'.
   269     12  ER-0717                     PIC X(04)   VALUE '0717'.
   270     12  ER-0718                     PIC X(04)   VALUE '0718'.
   271     12  ER-0719                     PIC X(04)   VALUE '0719'.
   272     12  ER-0720                     PIC X(04)   VALUE '0720'.
   273     12  ER-0721                     PIC X(04)   VALUE '0721'.
   274     12  ER-0722                     PIC X(04)   VALUE '0722'.
   275     12  ER-0723                     PIC X(04)   VALUE '0723'.
   276     12  ER-0724                     PIC X(04)   VALUE '0724'.
   277     12  ER-0725                     PIC X(04)   VALUE '0725'.
   278     12  ER-0726                     PIC X(04)   VALUE '0726'.
   279     12  ER-0727                     PIC X(04)   VALUE '0727'.
   280     12  ER-0729                     PIC X(04)   VALUE '0729'.
   281     12  ER-0754                     PIC X(04)   VALUE '0754'.
   282     12  ER-1560                     PIC X(04)   VALUE '1560'.
   283     12  ER-1562                     PIC X(04)   VALUE '1562'.
   284     12  ER-2241                     PIC X(04)   VALUE '2241'.
   285     12  ER-2276                     PIC X(04)   VALUE '2276'.
   286     12  ER-7008                     PIC X(04)   VALUE '7008'.
   287     12  ER-7031                     PIC X(04)   VALUE '7031'.
   288     12  ER-7123                     PIC X(04)   VALUE '7123'.
   289     12  ER-8150                     PIC X(04)   VALUE '8150'.
   290     12  ER-9999                     PIC XXXX    VALUE '9999'.
   291*                                    COPY ELCDATE.
   292******************************************************************
   293*                                                                *
   294*                                                                *
   295*                            ELCDATE.                            *
   296*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   297*                            VMOD=2.003
   298*                                                                *
   299*                                                                *
   300*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   301*                 LENGTH = 200                                   *
   302******************************************************************
   303
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page   7
* EL1041.cbl
   304 01  DATE-CONVERSION-DATA.
   305     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   306     12  DC-OPTION-CODE                PIC X.
   307         88  BIN-TO-GREG                VALUE ' '.
   308         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   309         88  EDIT-GREG-TO-BIN           VALUE '2'.
   310         88  YMD-GREG-TO-BIN            VALUE '3'.
   311         88  MDY-GREG-TO-BIN            VALUE '4'.
   312         88  JULIAN-TO-BIN              VALUE '5'.
   313         88  BIN-PLUS-ELAPSED           VALUE '6'.
   314         88  FIND-CENTURY               VALUE '7'.
   315         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   316         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   317         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   318         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   319         88  JULIAN-TO-BIN-3            VALUE 'C'.
   320         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   321         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   322         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   323         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   324         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   325         88  CHECK-LEAP-YEAR            VALUE 'H'.
   326         88  BIN-3-TO-GREG              VALUE 'I'.
   327         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   328         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   329         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   330         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   331         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   332         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   333         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   334         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   335         88  THREE-CHARACTER-BIN
   336                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   337         88  GREGORIAN-TO-BIN
   338                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   339         88  BIN-TO-GREGORIAN
   340                  VALUES ' ' '1' 'I' '8' 'G'.
   341         88  JULIAN-TO-BINARY
   342                  VALUES '5' 'C' 'E' 'F'.
   343     12  DC-ERROR-CODE                 PIC X.
   344         88  NO-CONVERSION-ERROR        VALUE ' '.
   345         88  DATE-CONVERSION-ERROR
   346                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   347         88  DATE-IS-ZERO               VALUE '1'.
   348         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   349         88  DATE-IS-INVALID            VALUE '3'.
   350         88  DATE1-GREATER-DATE2        VALUE '4'.
   351         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   352         88  DATE-INVALID-OPTION        VALUE '9'.
   353         88  INVALID-CENTURY            VALUE 'A'.
   354         88  ONLY-CENTURY               VALUE 'B'.
   355         88  ONLY-LEAP-YEAR             VALUE 'C'.
   356         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   357     12  DC-END-OF-MONTH               PIC X.
   358         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   359     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   360         88  USE-NORMAL-PROCESS         VALUE ' '.
   361         88  ADJUST-DOWN-100-YRS        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page   8
* EL1041.cbl
   362         88  ADJUST-UP-100-YRS          VALUE '2'.
   363     12  FILLER                        PIC X.
   364     12  DC-CONVERSION-DATES.
   365         16  DC-BIN-DATE-1             PIC XX.
   366         16  DC-BIN-DATE-2             PIC XX.
   367         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   368         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   369                       DC-GREG-DATE-1-EDIT.
   370             20  DC-EDIT1-MONTH        PIC 99.
   371             20  SLASH1-1              PIC X.
   372             20  DC-EDIT1-DAY          PIC 99.
   373             20  SLASH1-2              PIC X.
   374             20  DC-EDIT1-YEAR         PIC 99.
   375         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   376         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   377                     DC-GREG-DATE-2-EDIT.
   378             20  DC-EDIT2-MONTH        PIC 99.
   379             20  SLASH2-1              PIC X.
   380             20  DC-EDIT2-DAY          PIC 99.
   381             20  SLASH2-2              PIC X.
   382             20  DC-EDIT2-YEAR         PIC 99.
   383         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   384         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   385                     DC-GREG-DATE-1-YMD.
   386             20  DC-YMD-YEAR           PIC 99.
   387             20  DC-YMD-MONTH          PIC 99.
   388             20  DC-YMD-DAY            PIC 99.
   389         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   390         16  DC-GREG-DATE-1-MDY-R REDEFINES
   391                      DC-GREG-DATE-1-MDY.
   392             20  DC-MDY-MONTH          PIC 99.
   393             20  DC-MDY-DAY            PIC 99.
   394             20  DC-MDY-YEAR           PIC 99.
   395         16  DC-GREG-DATE-1-ALPHA.
   396             20  DC-ALPHA-MONTH        PIC X(10).
   397             20  DC-ALPHA-DAY          PIC 99.
   398             20  FILLER                PIC XX.
   399             20  DC-ALPHA-CENTURY.
   400                 24 DC-ALPHA-CEN-N     PIC 99.
   401             20  DC-ALPHA-YEAR         PIC 99.
   402         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   403         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   404         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   405         16  DC-JULIAN-DATE            PIC 9(05).
   406         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   407                                       PIC 9(05).
   408         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   409             20  DC-JULIAN-YEAR        PIC 99.
   410             20  DC-JULIAN-DAYS        PIC 999.
   411         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   412         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   413         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   414     12  DATE-CONVERSION-VARIBLES.
   415         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   416         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   417             20  FILLER                PIC 9(3).
   418             20  HOLD-CEN-1-CCYY.
   419                 24  HOLD-CEN-1-CC     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page   9
* EL1041.cbl
   420                 24  HOLD-CEN-1-YY     PIC 99.
   421             20  HOLD-CEN-1-MO         PIC 99.
   422             20  HOLD-CEN-1-DA         PIC 99.
   423         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   424             20  HOLD-CEN-1-R-MO       PIC 99.
   425             20  HOLD-CEN-1-R-DA       PIC 99.
   426             20  HOLD-CEN-1-R-CCYY.
   427                 24  HOLD-CEN-1-R-CC   PIC 99.
   428                 24  HOLD-CEN-1-R-YY   PIC 99.
   429             20  FILLER                PIC 9(3).
   430         16  HOLD-CENTURY-1-X.
   431             20  FILLER                PIC X(3)  VALUE SPACES.
   432             20  HOLD-CEN-1-X-CCYY.
   433                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   434                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   435             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   436             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   437         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   438             20  HOLD-CEN-1-R-X-MO     PIC XX.
   439             20  HOLD-CEN-1-R-X-DA     PIC XX.
   440             20  HOLD-CEN-1-R-X-CCYY.
   441                 24  HOLD-CEN-1-R-X-CC PIC XX.
   442                 24  HOLD-CEN-1-R-X-YY PIC XX.
   443             20  FILLER                PIC XXX.
   444         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   445         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   446         16  DC-JULIAN-DATE-1          PIC 9(07).
   447         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   448             20  DC-JULIAN-1-CCYY.
   449                 24  DC-JULIAN-1-CC    PIC 99.
   450                 24  DC-JULIAN-1-YR    PIC 99.
   451             20  DC-JULIAN-DA-1        PIC 999.
   452         16  DC-JULIAN-DATE-2          PIC 9(07).
   453         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   454             20  DC-JULIAN-2-CCYY.
   455                 24  DC-JULIAN-2-CC    PIC 99.
   456                 24  DC-JULIAN-2-YR    PIC 99.
   457             20  DC-JULIAN-DA-2        PIC 999.
   458         16  DC-GREG-DATE-A-EDIT.
   459             20  DC-EDITA-MONTH        PIC 99.
   460             20  SLASHA-1              PIC X VALUE '/'.
   461             20  DC-EDITA-DAY          PIC 99.
   462             20  SLASHA-2              PIC X VALUE '/'.
   463             20  DC-EDITA-CCYY.
   464                 24  DC-EDITA-CENT     PIC 99.
   465                 24  DC-EDITA-YEAR     PIC 99.
   466         16  DC-GREG-DATE-B-EDIT.
   467             20  DC-EDITB-MONTH        PIC 99.
   468             20  SLASHB-1              PIC X VALUE '/'.
   469             20  DC-EDITB-DAY          PIC 99.
   470             20  SLASHB-2              PIC X VALUE '/'.
   471             20  DC-EDITB-CCYY.
   472                 24  DC-EDITB-CENT     PIC 99.
   473                 24  DC-EDITB-YEAR     PIC 99.
   474         16  DC-GREG-DATE-CYMD         PIC 9(08).
   475         16  DC-GREG-DATE-CYMD-R REDEFINES
   476                              DC-GREG-DATE-CYMD.
   477             20  DC-CYMD-CEN           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  10
* EL1041.cbl
   478             20  DC-CYMD-YEAR          PIC 99.
   479             20  DC-CYMD-MONTH         PIC 99.
   480             20  DC-CYMD-DAY           PIC 99.
   481         16  DC-GREG-DATE-MDCY         PIC 9(08).
   482         16  DC-GREG-DATE-MDCY-R REDEFINES
   483                              DC-GREG-DATE-MDCY.
   484             20  DC-MDCY-MONTH         PIC 99.
   485             20  DC-MDCY-DAY           PIC 99.
   486             20  DC-MDCY-CEN           PIC 99.
   487             20  DC-MDCY-YEAR          PIC 99.
   488    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   489        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   490    12  DC-EL310-DATE                  PIC X(21).
   491    12  FILLER                         PIC X(28).
   492*                                    COPY ELCLOGOF.
   493******************************************************************
   494*                                                                *
   495*                                                                *
   496*                            ELCLOGOF.                           *
   497*                            VMOD=2.001                          *
   498*                                                                *
   499*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   500*                                                                *
   501******************************************************************
   502 01  CLASIC-LOGOFF.
   503     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   504     12  LOGOFF-TEXT.
   505         16  FILLER          PIC X(5)    VALUE SPACES.
   506         16  LOGOFF-MSG.
   507             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   508             20  FILLER      PIC X       VALUE SPACES.
   509             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   510         16  FILLER          PIC X(80)
   511           VALUE '* YOU ARE NOW LOGGED OFF'.
   512         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   513         16  FILLER          PIC X       VALUE QUOTE.
   514         16  LOGOFF-SYS-MSG  PIC X(17)
   515           VALUE 'S CLAS-IC SYSTEM '.
   516     12  TEXT-MESSAGES.
   517         16  UNACCESS-MSG    PIC X(29)
   518             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   519         16  PGMIDERR-MSG    PIC X(17)
   520             VALUE 'PROGRAM NOT FOUND'.
   521*                                    COPY ELCATTR.
   522******************************************************************
   523*                                                                *
   524*                            ELCATTR.                            *
   525*                            VMOD=2.001                          *
   526*                                                                *
   527*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   528*                                                                *
   529*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   530*                                                                *
   531*                   POS 1   P=PROTECTED                          *
   532*                           U=UNPROTECTED                        *
   533*                           S=ASKIP                              *
   534*                   POS 2   A=ALPHA/NUMERIC                      *
   535*                           N=NUMERIC                            *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  11
* EL1041.cbl
   536*                   POS 3   N=NORMAL                             *
   537*                           B=BRIGHT                             *
   538*                           D=DARK                               *
   539*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   540*                           OF=MODIFIED DATA TAG OFF             *
   541*                                                                *
   542*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   543******************************************************************
   544 01  ATTRIBUTE-LIST.
   545     12  AL-PABOF            PIC X       VALUE 'Y'.
   546     12  AL-PABON            PIC X       VALUE 'Z'.
   547     12  AL-PADOF            PIC X       VALUE '%'.
   548     12  AL-PADON            PIC X       VALUE '_'.
   549     12  AL-PANOF            PIC X       VALUE '-'.
   550     12  AL-PANON            PIC X       VALUE '/'.
   551     12  AL-SABOF            PIC X       VALUE '8'.
   552     12  AL-SABON            PIC X       VALUE '9'.
   553     12  AL-SADOF            PIC X       VALUE '@'.
   554     12  AL-SADON            PIC X       VALUE QUOTE.
   555     12  AL-SANOF            PIC X       VALUE '0'.
   556     12  AL-SANON            PIC X       VALUE '1'.
   557     12  AL-UABOF            PIC X       VALUE 'H'.
   558     12  AL-UABON            PIC X       VALUE 'I'.
   559     12  AL-UADOF            PIC X       VALUE '<'.
   560     12  AL-UADON            PIC X       VALUE '('.
   561     12  AL-UANOF            PIC X       VALUE ' '.
   562     12  AL-UANON            PIC X       VALUE 'A'.
   563     12  AL-UNBOF            PIC X       VALUE 'Q'.
   564     12  AL-UNBON            PIC X       VALUE 'R'.
   565     12  AL-UNDOF            PIC X       VALUE '*'.
   566     12  AL-UNDON            PIC X       VALUE ')'.
   567     12  AL-UNNOF            PIC X       VALUE '&'.
   568     12  AL-UNNON            PIC X       VALUE 'J'.
   569*                                    COPY ELCEMIB.
   570******************************************************************
   571*                                                                *
   572*                                                                *
   573*                            ELCEMIB.                            *
   574*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   575*                            VMOD=2.005                          *
   576*                                                                *
   577*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   578*                                                                *
   579******************************************************************
   580 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   581     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   582     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   583     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   584     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   585     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   586     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   587     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   588     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   589     12  EMI-SWITCH1             PIC X        VALUE '1'.
   590         88  EMI-NO-ERRORS                    VALUE '1'.
   591         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   592         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   593     12  EMI-SWITCH2             PIC X        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  12
* EL1041.cbl
   594         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   595     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   596         88  EMI-AREA1-EMPTY                  VALUE '1'.
   597         88  EMI-AREA1-FULL                   VALUE '2'.
   598     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   599         88  EMI-AREA2-EMPTY                  VALUE '1'.
   600         88  EMI-AREA2-FULL                   VALUE '2'.
   601     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   602         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   603         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   604         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   605         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   606         88  EMI-BYPASS-FATALS                VALUE 'X'.
   607     12  EMI-ERROR-LINES.
   608         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   609         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   610         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   611         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   612             20  EMI-ERR-CODES OCCURS 10 TIMES.
   613                 24  EMI-ERR-NUM         PIC X(4).
   614                 24  EMI-FILLER          PIC X.
   615                 24  EMI-SEV             PIC X.
   616                 24  FILLER              PIC X.
   617             20  FILLER                  PIC X(02).
   618     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   619         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   620             20  EMI-ERROR-NUMBER    PIC X(4).
   621             20  EMI-FILL            PIC X.
   622             20  EMI-SEVERITY        PIC X.
   623             20  FILLER              PIC X.
   624             20  EMI-ERROR-TEXT.
   625                 24  EMI-TEXT-VARIABLE   PIC X(10).
   626                 24  FILLER          PIC X(55).
   627     12  EMI-SEVERITY-SAVE           PIC X.
   628         88  EMI-NOTE                    VALUE 'N'.
   629         88  EMI-WARNING                 VALUE 'W'.
   630         88  EMI-FORCABLE                VALUE 'F'.
   631         88  EMI-FATAL                   VALUE 'X'.
   632     12  EMI-MESSAGE-FLAG            PIC X.
   633         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   634         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   635     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   636     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   637         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   638         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   639         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   640     12  emi-claim-no                pic x(7).
   641     12  emi-claim-type              pic x(6).
   642     12  FILLER                      PIC X(124)  VALUE SPACES.
   643     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   644     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   645     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   646     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   647*                                    COPY ELCJPFX.
   648******************************************************************
   649*                                                                *
   650*                                                                *
   651*                            ELCJPFX.                            *
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  13
* EL1041.cbl
   652*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   653*                            VMOD=2.002                          *
   654*                                                                *
   655*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   656*                                                                *
   657*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   658*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   659*        ELCNTL - CONTROL FILE                                   *
   660*        ELMSTR - CLAIM MASTERS                                  *
   661*        ELTRLR - ACTIVITY TRAILERS                              *
   662*        ELCHKQ - CHECK QUE                                      *
   663******************************************************************
   664 01  JOURNAL-RECORD.
   665     12  jp-date                     pic s9(5) comp-3.
   666     12  jp-time                     pic s9(7) comp-3.
   667     12  JP-USER-ID                  PIC X(4).
   668     12  JP-FILE-ID                  PIC X(8).
   669     12  JP-PROGRAM-ID               PIC X(8).
   670     12  JP-RECORD-TYPE              PIC X.
   671         88 JP-ADD              VALUE 'A'.
   672         88 JP-BEFORE-CHANGE    VALUE 'B'.
   673         88 JP-AFTER-CHANGE     VALUE 'C'.
   674         88 JP-DELETE           VALUE 'D'.
   675         88 JP-GENERIC-DELETE   VALUE 'G'.
   676         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   677         88 JP-KEY-CHG-ADD      VALUE 'N'.
   678     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   679     12  JP-RECORD-AREA
   680
   681
   682                                     PIC X(530).
   683*                                    COPY ELCINTF.
   684******************************************************************
   685*                                                                *
   686*                                                                *
   687*                            ELCINTF.                            *
   688*                            VMOD=2.017                          *
   689*                                                                *
   690*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   691*                                                                *
   692*       LENGTH = 1024                                            *
   693*                                                                *
   694******************************************************************
   695*                   C H A N G E   L O G
   696*
   697* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   698*-----------------------------------------------------------------
   699*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   700* EFFECTIVE    NUMBER
   701*-----------------------------------------------------------------
   702* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   703******************************************************************
   704 01  PROGRAM-INTERFACE-BLOCK.
   705     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   706     12  PI-CALLING-PROGRAM              PIC X(8).
   707     12  PI-SAVED-PROGRAM-1              PIC X(8).
   708     12  PI-SAVED-PROGRAM-2              PIC X(8).
   709     12  PI-SAVED-PROGRAM-3              PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  14
* EL1041.cbl
   710     12  PI-SAVED-PROGRAM-4              PIC X(8).
   711     12  PI-SAVED-PROGRAM-5              PIC X(8).
   712     12  PI-SAVED-PROGRAM-6              PIC X(8).
   713     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   714     12  PI-COMPANY-ID                   PIC XXX.
   715     12  PI-COMPANY-CD                   PIC X.
   716
   717     12  PI-COMPANY-PASSWORD             PIC X(8).
   718
   719     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   720
   721     12  PI-CONTROL-IN-PROGRESS.
   722         16  PI-CARRIER                  PIC X.
   723         16  PI-GROUPING                 PIC X(6).
   724         16  PI-STATE                    PIC XX.
   725         16  PI-ACCOUNT                  PIC X(10).
   726         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   727                                         PIC X(10).
   728         16  PI-CLAIM-CERT-GRP.
   729             20  PI-CLAIM-NO             PIC X(7).
   730             20  PI-CERT-NO.
   731                 25  PI-CERT-PRIME       PIC X(10).
   732                 25  PI-CERT-SFX         PIC X.
   733             20  PI-CERT-EFF-DT          PIC XX.
   734         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   735             20  PI-PLAN-CODE            PIC X(2).
   736             20  PI-REVISION-NUMBER      PIC X(3).
   737             20  PI-PLAN-EFF-DT          PIC X(2).
   738             20  PI-PLAN-EXP-DT          PIC X(2).
   739             20  FILLER                  PIC X(11).
   740         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   741             20  PI-OE-REFERENCE-1.
   742                 25  PI-OE-REF-1-PRIME   PIC X(18).
   743                 25  PI-OE-REF-1-SUFF    PIC XX.
   744
   745     12  PI-SESSION-IN-PROGRESS          PIC X.
   746         88  CLAIM-SESSION                   VALUE '1'.
   747         88  CREDIT-SESSION                  VALUE '2'.
   748         88  WARRANTY-SESSION                VALUE '3'.
   749         88  MORTGAGE-SESSION                VALUE '4'.
   750         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   751
   752
   753*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   754
   755     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   756     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   757
   758     12  PI-CREDIT-USER                  PIC X.
   759         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   760         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   761
   762     12  PI-CLAIM-USER                   PIC X.
   763         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   764         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   765
   766     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   767         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  15
* EL1041.cbl
   768         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   769         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   770         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   771         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   772
   773     12  PI-PROCESSOR-ID                 PIC X(4).
   774
   775     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   776
   777     12  PI-MEMBER-CAPTION               PIC X(10).
   778
   779     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   780         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   781
   782     12  PI-LIFE-OVERRIDE-L1             PIC X.
   783     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   784     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   785     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   786
   787     12  PI-AH-OVERRIDE-L1               PIC X.
   788     12  PI-AH-OVERRIDE-L2               PIC XX.
   789     12  PI-AH-OVERRIDE-L6               PIC X(6).
   790     12  PI-AH-OVERRIDE-L12              PIC X(12).
   791
   792     12  PI-NEW-SYSTEM                   PIC X(2).
   793
   794     12  PI-PRIMARY-CERT-NO              PIC X(11).
   795     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   796         88  PI-USES-PAID-TO                 VALUE '1'.
   797     12  PI-CRDTCRD-SYSTEM.
   798         16  PI-CRDTCRD-USER             PIC X.
   799             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   800             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   801         16  PI-CC-MONTH-END-DT          PIC XX.
   802     12  PI-PROCESSOR-PRINTER            PIC X(4).
   803
   804     12  PI-OE-REFERENCE-2.
   805         16  PI-OE-REF-2-PRIME           PIC X(10).
   806         16  PI-OE-REF-2-SUFF            PIC X.
   807
   808     12  PI-REM-TRM-CALC-OPTION          PIC X.
   809
   810     12  PI-LANGUAGE-TYPE                PIC X.
   811             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   812             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   813             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   814
   815     12  PI-POLICY-LINKAGE-IND           PIC X.
   816         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   817         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   818                                                   LOW-VALUES.
   819
   820     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   821     12  PI-CLAIM-PW-SESSION             PIC X(1).
   822         88  PI-CLAIM-CREDIT                 VALUE '1'.
   823         88  PI-CLAIM-CONVEN                 VALUE '2'.
   824
   825     12  PI-PROCESSOR-CSR-IND            PIC X.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  16
* EL1041.cbl
   826         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   827         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   828
   829     12  FILLER                          PIC X(3).
   830
   831     12  PI-SYSTEM-LEVEL                 PIC X(145).
   832
   833     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   834         PI-SYSTEM-LEVEL.
   835
   836         16  PI-ENTRY-CODES.
   837             20  PI-ENTRY-CD-1           PIC X.
   838             20  PI-ENTRY-CD-2           PIC X.
   839
   840         16  PI-RETURN-CODES.
   841             20  PI-RETURN-CD-1          PIC X.
   842             20  PI-RETURN-CD-2          PIC X.
   843
   844         16  PI-UPDATE-STATUS-SAVE.
   845             20  PI-UPDATE-BY            PIC X(4).
   846             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   847
   848         16  PI-LOWER-CASE-LETTERS       PIC X.
   849             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   850
   851*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   852*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   853*            88  CARRIER-CLM-CNTL            VALUE '2'.
   854
   855         16  PI-CERT-ACCESS-CONTROL      PIC X.
   856             88  ST-ACCNT-CNTL               VALUE ' '.
   857             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   858             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   859             88  ACCNT-CNTL                  VALUE '3'.
   860             88  CARR-ACCNT-CNTL             VALUE '4'.
   861
   862         16  PI-PROCESSOR-CAP-LIST.
   863             20  PI-SYSTEM-CONTROLS.
   864                24 PI-SYSTEM-DISPLAY     PIC X.
   865                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   866                24 PI-SYSTEM-MODIFY      PIC X.
   867                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   868             20  FILLER                  PIC XX.
   869             20  PI-DISPLAY-CAP          PIC X.
   870                 88  DISPLAY-CAP             VALUE 'Y'.
   871             20  PI-MODIFY-CAP           PIC X.
   872                 88  MODIFY-CAP              VALUE 'Y'.
   873             20  PI-MSG-AT-LOGON-CAP     PIC X.
   874                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   875             20  PI-FORCE-CAP            PIC X.
   876                 88  FORCE-CAP               VALUE 'Y'.
   877
   878         16  PI-PROGRAM-CONTROLS.
   879             20  PI-PGM-PRINT-OPT        PIC X.
   880             20  PI-PGM-FORMAT-OPT       PIC X.
   881             20  PI-PGM-PROCESS-OPT      PIC X.
   882             20  PI-PGM-TOTALS-OPT       PIC X.
   883
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  17
* EL1041.cbl
   884         16  PI-HELP-INTERFACE.
   885             20  PI-LAST-ERROR-NO        PIC X(4).
   886             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   887
   888         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   889             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   890
   891         16  PI-CR-CONTROL-IN-PROGRESS.
   892             20  PI-CR-CARRIER           PIC X.
   893             20  PI-CR-GROUPING          PIC X(6).
   894             20  PI-CR-STATE             PIC XX.
   895             20  PI-CR-ACCOUNT           PIC X(10).
   896             20  PI-CR-FIN-RESP          PIC X(10).
   897             20  PI-CR-TYPE              PIC X.
   898
   899         16  PI-CR-BATCH-NUMBER          PIC X(6).
   900
   901         16  PI-CR-MONTH-END-DT          PIC XX.
   902
   903         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   904             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   905             88  PI-ZERO-CARRIER             VALUE '1'.
   906             88  PI-ZERO-GROUPING            VALUE '2'.
   907             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   908
   909         16  PI-CARRIER-SECURITY         PIC X.
   910             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   911
   912         16  PI-ACCOUNT-SECURITY         PIC X(10).
   913             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   914             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   915
   916         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   917             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   918                                         INDEXED BY PI-ACCESS-NDX
   919                                         PIC X.
   920
   921         16  PI-GA-BILLING-CONTROL       PIC X.
   922             88  PI-GA-BILLING               VALUE '1'.
   923
   924         16  PI-MAIL-PROCESSING          PIC X.
   925             88  PI-MAIL-YES                 VALUE 'Y'.
   926
   927         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   928
   929         16  PI-AR-SYSTEM.
   930             20  PI-AR-PROCESSING-CNTL   PIC X.
   931                 88  PI-AR-PROCESSING        VALUE 'Y'.
   932             20  PI-AR-SUMMARY-CODE      PIC X(6).
   933             20  PI-AR-MONTH-END-DT      PIC XX.
   934
   935         16  PI-MP-SYSTEM.
   936             20  PI-MORTGAGE-USER            PIC X.
   937                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   938                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   939             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   940                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   941                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  18
* EL1041.cbl
   942                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   943                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   944                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   945             20  PI-MP-MONTH-END-DT          PIC XX.
   946             20  PI-MP-REFERENCE-NO.
   947                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   948                 24  PI-MP-REFERENCE-SFX     PIC XX.
   949
   950         16  PI-LABEL-CONTROL            PIC X(01).
   951             88  PI-CREATE-LABELS                    VALUE 'Y'.
   952             88  PI-BYPASS-LABELS                    VALUE 'N'.
   953
   954         16  PI-BILL-GROUPING-CODE       PIC X(01).
   955             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   956
   957         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   958             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   959             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   960
   961         16  FILLER                      PIC X(14).
   962
   963     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   964******************************************************************
   965     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   966*                                    COPY ELC1042.
   967******************************************************************
   968*                                                                *
   969*                                                                *
   970*                           ELC1042                              *
   971*                            VMOD=2.002                          *
   972*                                                                *
   973*    NOTE                                                        *
   974*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   975*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   976*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   977*        TO THESE PROGRAMS.                                      *
   978*                                                                *
   979*    NOTE                                                        *
   980*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   981*        USE ONLY!                                               *
   982*                                                                *
   983******************************************************************
   984
   985         16  PI-1042-WA.
   986             20  PI-ACTION       PIC  X(01).
   987                 88 PI-SHOW-MODE           VALUE '1'.
   988                 88 PI-CLEAR-MODE          VALUE '2'.
   989                 88 PI-CREATE-MODE         VALUE '3'.
   990             20  PI-COMM-CONTROL PIC  X(12).
   991             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   992             20  PI-EOF-SW       PIC  X(01).
   993                 88  PI-FILE-EOF           VALUE 'Y'.
   994             20  PI-FILETYP      PIC  X(01).
   995             20  PI-FORM-SQUEEZE-CONTROL
   996                                 PIC  X(01).
   997                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   998                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   999             20  PI-LAST-CONTROL PIC  X(12).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  19
* EL1041.cbl
  1000             20  PI-TEMP-STOR-ITEMS
  1001                                 PIC S9(04) COMP.
  1002             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1003             20  PI-UPDATE-SW    PIC  9(01).
  1004                 88 ANY-UPDATES            VALUE 1.
  1005             20  PI-104-SCREEN-SENT-IND
  1006                                 PIC  X(01).
  1007                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1008                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1009             20  PI-1042-SCREEN-SENT-IND
  1010                                 PIC  X(01).
  1011                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1012                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1013             20  PI-1042-ARCHIVE-IND
  1014                                 PIC  X(01).
  1015                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1016             20  FILLER          PIC  X(29).
  1017         16  PI-PREV-LETR-KEY        PIC X(15).
  1018         16  PI-CURR-LETR-KEY        PIC X(15).
  1019         16  PI-UPDATE-DT            PIC XX.
  1020         16  PI-ENC-CODES            PIC X(120).
  1021         16  PI-SPLIT-SUB            PIC S9(3)  COMP.
  1022         16  FILLER                  PIC X(434).
  1023*                                    COPY ELCAID.
  1024******************************************************************
  1025*                                                                *
  1026*                            ELCAID.                             *
  1027*                            VMOD=2.001                          *
  1028*                                                                *
  1029*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1030*                                                                *
  1031*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1032*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1033******************************************************************
  1034
  1035 01  DFHAID.
  1036   02  DFHNULL   PIC  X  VALUE  ' '.
  1037   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1038   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1039   02  DFHPEN    PIC  X  VALUE  '='.
  1040   02  DFHOPID   PIC  X  VALUE  'W'.
  1041   02  DFHPA1    PIC  X  VALUE  '%'.
  1042   02  DFHPA2    PIC  X  VALUE  '>'.
  1043   02  DFHPA3    PIC  X  VALUE  ','.
  1044   02  DFHPF1    PIC  X  VALUE  '1'.
  1045   02  DFHPF2    PIC  X  VALUE  '2'.
  1046   02  DFHPF3    PIC  X  VALUE  '3'.
  1047   02  DFHPF4    PIC  X  VALUE  '4'.
  1048   02  DFHPF5    PIC  X  VALUE  '5'.
  1049   02  DFHPF6    PIC  X  VALUE  '6'.
  1050   02  DFHPF7    PIC  X  VALUE  '7'.
  1051   02  DFHPF8    PIC  X  VALUE  '8'.
  1052   02  DFHPF9    PIC  X  VALUE  '9'.
  1053   02  DFHPF10   PIC  X  VALUE  ':'.
  1054   02  DFHPF11   PIC  X  VALUE  '#'.
  1055   02  DFHPF12   PIC  X  VALUE  '@'.
  1056   02  DFHPF13   PIC  X  VALUE  'A'.
  1057   02  DFHPF14   PIC  X  VALUE  'B'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  20
* EL1041.cbl
  1058   02  DFHPF15   PIC  X  VALUE  'C'.
  1059   02  DFHPF16   PIC  X  VALUE  'D'.
  1060   02  DFHPF17   PIC  X  VALUE  'E'.
  1061   02  DFHPF18   PIC  X  VALUE  'F'.
  1062   02  DFHPF19   PIC  X  VALUE  'G'.
  1063   02  DFHPF20   PIC  X  VALUE  'H'.
  1064   02  DFHPF21   PIC  X  VALUE  'I'.
  1065*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1066   02  DFHPF22   PIC  X  VALUE  '['.
  1067   02  DFHPF23   PIC  X  VALUE  '.'.
  1068   02  DFHPF24   PIC  X  VALUE  '<'.
  1069   02  DFHMSRE   PIC  X  VALUE  'X'.
  1070   02  DFHSTRF   PIC  X  VALUE  'h'.
  1071   02  DFHTRIG   PIC  X  VALUE  '"'.
  1072 01  FILLER    REDEFINES DFHAID.
  1073     12  FILLER                      PIC X(08).
  1074     12  PF-VALUES                   PIC X         OCCURS 24.
  1075*                                    COPY EL1041S.
  1076 01  EL104ZI.
  1077     05  FILLER            PIC  X(0012).
  1078*    -------------------------------
  1079     05  DATEL PIC S9(0004) COMP.
  1080     05  DATEF PIC  X(0001).
  1081     05  FILLER REDEFINES DATEF.
  1082         10  DATEA PIC  X(0001).
  1083     05  FILLER            PIC  X(3).
  1084     05  DATEI PIC  X(0008).
  1085*    -------------------------------
  1086     05  TIMEL PIC S9(0004) COMP.
  1087     05  TIMEF PIC  X(0001).
  1088     05  FILLER REDEFINES TIMEF.
  1089         10  TIMEA PIC  X(0001).
  1090     05  FILLER            PIC  X(3).
  1091     05  TIMEI PIC  X(0005).
  1092*    -------------------------------
  1093     05  CMPNYIDL PIC S9(0004) COMP.
  1094     05  CMPNYIDF PIC  X(0001).
  1095     05  FILLER REDEFINES CMPNYIDF.
  1096         10  CMPNYIDA PIC  X(0001).
  1097     05  FILLER            PIC  X(3).
  1098     05  CMPNYIDI PIC  X(0003).
  1099*    -------------------------------
  1100     05  USERIDL PIC S9(0004) COMP.
  1101     05  USERIDF PIC  X(0001).
  1102     05  FILLER REDEFINES USERIDF.
  1103         10  USERIDA PIC  X(0001).
  1104     05  FILLER            PIC  X(3).
  1105     05  USERIDI PIC  X(0004).
  1106*    -------------------------------
  1107     05  MAINTL PIC S9(0004) COMP.
  1108     05  MAINTF PIC  X(0001).
  1109     05  FILLER REDEFINES MAINTF.
  1110         10  MAINTA PIC  X(0001).
  1111     05  FILLER            PIC  X(3).
  1112     05  MAINTI PIC  X(0001).
  1113*    -------------------------------
  1114     05  LSTUSRL PIC S9(0004) COMP.
  1115     05  LSTUSRF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  21
* EL1041.cbl
  1116     05  FILLER REDEFINES LSTUSRF.
  1117         10  LSTUSRA PIC  X(0001).
  1118     05  FILLER            PIC  X(3).
  1119     05  LSTUSRI PIC  X(0004).
  1120*    -------------------------------
  1121     05  LSTDTEL PIC S9(0004) COMP.
  1122     05  LSTDTEF PIC  X(0001).
  1123     05  FILLER REDEFINES LSTDTEF.
  1124         10  LSTDTEA PIC  X(0001).
  1125     05  FILLER            PIC  X(3).
  1126     05  LSTDTEI PIC  X(0008).
  1127*    -------------------------------
  1128     05  LSTTIMEL PIC S9(0004) COMP.
  1129     05  LSTTIMEF PIC  X(0001).
  1130     05  FILLER REDEFINES LSTTIMEF.
  1131         10  LSTTIMEA PIC  X(0001).
  1132     05  FILLER            PIC  X(3).
  1133     05  LSTTIMEI PIC  X(0005).
  1134*    -------------------------------
  1135     05  ZLETRL PIC S9(0004) COMP.
  1136     05  ZLETRF PIC  X(0001).
  1137     05  FILLER REDEFINES ZLETRF.
  1138         10  ZLETRA PIC  X(0001).
  1139     05  FILLER            PIC  X(3).
  1140     05  ZLETRI PIC  X(0004).
  1141*    -------------------------------
  1142     05  ZCOPIESL PIC S9(0004) COMP.
  1143     05  ZCOPIESF PIC  X(0001).
  1144     05  FILLER REDEFINES ZCOPIESF.
  1145         10  ZCOPIESA PIC  X(0001).
  1146     05  FILLER            PIC  X(3).
  1147     05  ZCOPIESI PIC  X(0001).
  1148*    -------------------------------
  1149     05  ZPROMPTL PIC S9(0004) COMP.
  1150     05  ZPROMPTF PIC  X(0001).
  1151     05  FILLER REDEFINES ZPROMPTF.
  1152         10  ZPROMPTA PIC  X(0001).
  1153     05  FILLER            PIC  X(3).
  1154     05  ZPROMPTI PIC  X(0001).
  1155*    -------------------------------
  1156     05  ZENCCDL PIC S9(0004) COMP.
  1157     05  ZENCCDF PIC  X(0001).
  1158     05  FILLER REDEFINES ZENCCDF.
  1159         10  ZENCCDA PIC  X(0001).
  1160     05  FILLER            PIC  X(3).
  1161     05  ZENCCDI PIC  X(0003).
  1162*    -------------------------------
  1163     05  ZRDAYSL PIC S9(0004) COMP.
  1164     05  ZRDAYSF PIC  X(0001).
  1165     05  FILLER REDEFINES ZRDAYSF.
  1166         10  ZRDAYSA PIC  X(0001).
  1167     05  FILLER            PIC  X(3).
  1168     05  ZRDAYSI PIC  X(0003).
  1169*    -------------------------------
  1170     05  ZFORML PIC S9(0004) COMP.
  1171     05  ZFORMF PIC  X(0001).
  1172     05  FILLER REDEFINES ZFORMF.
  1173         10  ZFORMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  22
* EL1041.cbl
  1174     05  FILLER            PIC  X(3).
  1175     05  ZFORMI PIC  X(0004).
  1176*    -------------------------------
  1177     05  ZBENEL PIC S9(0004) COMP.
  1178     05  ZBENEF PIC  X(0001).
  1179     05  FILLER REDEFINES ZBENEF.
  1180         10  ZBENEA PIC  X(0001).
  1181     05  FILLER            PIC  X(3).
  1182     05  ZBENEI PIC  X(0001).
  1183*    -------------------------------
  1184     05  ZBARCODL PIC S9(0004) COMP.
  1185     05  ZBARCODF PIC  X(0001).
  1186     05  FILLER REDEFINES ZBARCODF.
  1187         10  ZBARCODA PIC  X(0001).
  1188     05  FILLER            PIC  X(3).
  1189     05  ZBARCODI PIC  X(0001).
  1190*    -------------------------------
  1191     05  ZRETENVL PIC S9(0004) COMP.
  1192     05  ZRETENVF PIC  X(0001).
  1193     05  FILLER REDEFINES ZRETENVF.
  1194         10  ZRETENVA PIC  X(0001).
  1195     05  FILLER            PIC  X(3).
  1196     05  ZRETENVI PIC  X(0001).
  1197*    -------------------------------
  1198     05  ZCODES1L PIC S9(0004) COMP.
  1199     05  ZCODES1F PIC  X(0001).
  1200     05  FILLER REDEFINES ZCODES1F.
  1201         10  ZCODES1A PIC  X(0001).
  1202     05  FILLER            PIC  X(3).
  1203     05  ZCODES1I PIC  X(0053).
  1204*    -------------------------------
  1205     05  ZCODES2L PIC S9(0004) COMP.
  1206     05  ZCODES2F PIC  X(0001).
  1207     05  FILLER REDEFINES ZCODES2F.
  1208         10  ZCODES2A PIC  X(0001).
  1209     05  FILLER            PIC  X(3).
  1210     05  ZCODES2I PIC  X(0078).
  1211*    -------------------------------
  1212     05  DCCOPTL PIC S9(0004) COMP.
  1213     05  DCCOPTF PIC  X(0001).
  1214     05  FILLER REDEFINES DCCOPTF.
  1215         10  DCCOPTA PIC  X(0001).
  1216     05  FILLER            PIC  X(3).
  1217     05  DCCOPTI PIC  X(0035).
  1218*    -------------------------------
  1219     05  ZFADAYSL PIC S9(0004) COMP.
  1220     05  ZFADAYSF PIC  X(0001).
  1221     05  FILLER REDEFINES ZFADAYSF.
  1222         10  ZFADAYSA PIC  X(0001).
  1223     05  FILLER            PIC  X(3).
  1224     05  ZFADAYSI PIC  X(0003).
  1225*    -------------------------------
  1226     05  ZACLOSEL PIC S9(0004) COMP.
  1227     05  ZACLOSEF PIC  X(0001).
  1228     05  FILLER REDEFINES ZACLOSEF.
  1229         10  ZACLOSEA PIC  X(0001).
  1230     05  FILLER            PIC  X(3).
  1231     05  ZACLOSEI PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  23
* EL1041.cbl
  1232*    -------------------------------
  1233     05  ERRMSGL PIC S9(0004) COMP.
  1234     05  ERRMSGF PIC  X(0001).
  1235     05  FILLER REDEFINES ERRMSGF.
  1236         10  ERRMSGA PIC  X(0001).
  1237     05  FILLER            PIC  X(3).
  1238     05  ERRMSGI PIC  X(0072).
  1239*    -------------------------------
  1240     05  PFKEYL PIC S9(0004) COMP.
  1241     05  PFKEYF PIC  X(0001).
  1242     05  FILLER REDEFINES PFKEYF.
  1243         10  PFKEYA PIC  X(0001).
  1244     05  FILLER            PIC  X(3).
  1245     05  PFKEYI PIC  99.
  1246 01  EL104ZO REDEFINES EL104ZI.
  1247     05  FILLER            PIC  X(0012).
  1248*    -------------------------------
  1249     05  FILLER            PIC  X(3).
  1250     05  DATEC PIC  X(0001).
  1251     05  DATEH PIC  X(0001).
  1252     05  DATEU PIC  X(0001).
  1253     05  DATEO PIC  X(0008).
  1254*    -------------------------------
  1255     05  FILLER            PIC  X(3).
  1256     05  TIMEC PIC  X(0001).
  1257     05  TIMEH PIC  X(0001).
  1258     05  TIMEU PIC  X(0001).
  1259     05  TIMEO PIC  99.99.
  1260*    -------------------------------
  1261     05  FILLER            PIC  X(3).
  1262     05  CMPNYIDC PIC  X(0001).
  1263     05  CMPNYIDH PIC  X(0001).
  1264     05  CMPNYIDU PIC  X(0001).
  1265     05  CMPNYIDO PIC  X(0003).
  1266*    -------------------------------
  1267     05  FILLER            PIC  X(3).
  1268     05  USERIDC PIC  X(0001).
  1269     05  USERIDH PIC  X(0001).
  1270     05  USERIDU PIC  X(0001).
  1271     05  USERIDO PIC  X(0004).
  1272*    -------------------------------
  1273     05  FILLER            PIC  X(3).
  1274     05  MAINTC PIC  X(0001).
  1275     05  MAINTH PIC  X(0001).
  1276     05  MAINTU PIC  X(0001).
  1277     05  MAINTO PIC  X(0001).
  1278*    -------------------------------
  1279     05  FILLER            PIC  X(3).
  1280     05  LSTUSRC PIC  X(0001).
  1281     05  LSTUSRH PIC  X(0001).
  1282     05  LSTUSRU PIC  X(0001).
  1283     05  LSTUSRO PIC  X(0004).
  1284*    -------------------------------
  1285     05  FILLER            PIC  X(3).
  1286     05  LSTDTEC PIC  X(0001).
  1287     05  LSTDTEH PIC  X(0001).
  1288     05  LSTDTEU PIC  X(0001).
  1289     05  LSTDTEO PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  24
* EL1041.cbl
  1290*    -------------------------------
  1291     05  FILLER            PIC  X(3).
  1292     05  LSTTIMEC PIC  X(0001).
  1293     05  LSTTIMEH PIC  X(0001).
  1294     05  LSTTIMEU PIC  X(0001).
  1295     05  LSTTIMEO PIC  99.99.
  1296*    -------------------------------
  1297     05  FILLER            PIC  X(3).
  1298     05  ZLETRC PIC  X(0001).
  1299     05  ZLETRH PIC  X(0001).
  1300     05  ZLETRU PIC  X(0001).
  1301     05  ZLETRO PIC  X(0004).
  1302*    -------------------------------
  1303     05  FILLER            PIC  X(3).
  1304     05  ZCOPIESC PIC  X(0001).
  1305     05  ZCOPIESH PIC  X(0001).
  1306     05  ZCOPIESU PIC  X(0001).
  1307     05  ZCOPIESO PIC  9.
  1308*    -------------------------------
  1309     05  FILLER            PIC  X(3).
  1310     05  ZPROMPTC PIC  X(0001).
  1311     05  ZPROMPTH PIC  X(0001).
  1312     05  ZPROMPTU PIC  X(0001).
  1313     05  ZPROMPTO PIC  X(0001).
  1314*    -------------------------------
  1315     05  FILLER            PIC  X(3).
  1316     05  ZENCCDC PIC  X(0001).
  1317     05  ZENCCDH PIC  X(0001).
  1318     05  ZENCCDU PIC  X(0001).
  1319     05  ZENCCDO PIC  X(0003).
  1320*    -------------------------------
  1321     05  FILLER            PIC  X(3).
  1322     05  ZRDAYSC PIC  X(0001).
  1323     05  ZRDAYSH PIC  X(0001).
  1324     05  ZRDAYSU PIC  X(0001).
  1325     05  ZRDAYSO PIC  999.
  1326*    -------------------------------
  1327     05  FILLER            PIC  X(3).
  1328     05  ZFORMC PIC  X(0001).
  1329     05  ZFORMH PIC  X(0001).
  1330     05  ZFORMU PIC  X(0001).
  1331     05  ZFORMO PIC  X(0004).
  1332*    -------------------------------
  1333     05  FILLER            PIC  X(3).
  1334     05  ZBENEC PIC  X(0001).
  1335     05  ZBENEH PIC  X(0001).
  1336     05  ZBENEU PIC  X(0001).
  1337     05  ZBENEO PIC  X(0001).
  1338*    -------------------------------
  1339     05  FILLER            PIC  X(3).
  1340     05  ZBARCODC PIC  X(0001).
  1341     05  ZBARCODH PIC  X(0001).
  1342     05  ZBARCODU PIC  X(0001).
  1343     05  ZBARCODO PIC  X(0001).
  1344*    -------------------------------
  1345     05  FILLER            PIC  X(3).
  1346     05  ZRETENVC PIC  X(0001).
  1347     05  ZRETENVH PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  25
* EL1041.cbl
  1348     05  ZRETENVU PIC  X(0001).
  1349     05  ZRETENVO PIC  X(0001).
  1350*    -------------------------------
  1351     05  FILLER            PIC  X(3).
  1352     05  ZCODES1C PIC  X(0001).
  1353     05  ZCODES1H PIC  X(0001).
  1354     05  ZCODES1U PIC  X(0001).
  1355     05  ZCODES1O PIC  X(0053).
  1356*    -------------------------------
  1357     05  FILLER            PIC  X(3).
  1358     05  ZCODES2C PIC  X(0001).
  1359     05  ZCODES2H PIC  X(0001).
  1360     05  ZCODES2U PIC  X(0001).
  1361     05  ZCODES2O PIC  X(0078).
  1362*    -------------------------------
  1363     05  FILLER            PIC  X(3).
  1364     05  DCCOPTC PIC  X(0001).
  1365     05  DCCOPTH PIC  X(0001).
  1366     05  DCCOPTU PIC  X(0001).
  1367     05  DCCOPTO PIC  X(0035).
  1368*    -------------------------------
  1369     05  FILLER            PIC  X(3).
  1370     05  ZFADAYSC PIC  X(0001).
  1371     05  ZFADAYSH PIC  X(0001).
  1372     05  ZFADAYSU PIC  X(0001).
  1373     05  ZFADAYSO PIC  999.
  1374*    -------------------------------
  1375     05  FILLER            PIC  X(3).
  1376     05  ZACLOSEC PIC  X(0001).
  1377     05  ZACLOSEH PIC  X(0001).
  1378     05  ZACLOSEU PIC  X(0001).
  1379     05  ZACLOSEO PIC  X(0001).
  1380*    -------------------------------
  1381     05  FILLER            PIC  X(3).
  1382     05  ERRMSGC PIC  X(0001).
  1383     05  ERRMSGH PIC  X(0001).
  1384     05  ERRMSGU PIC  X(0001).
  1385     05  ERRMSGO PIC  X(0072).
  1386*    -------------------------------
  1387     05  FILLER            PIC  X(3).
  1388     05  PFKEYC PIC  X(0001).
  1389     05  PFKEYH PIC  X(0001).
  1390     05  PFKEYU PIC  X(0001).
  1391     05  PFKEYO PIC  99.
  1392*    -------------------------------
  1393****************************************************************
  1394*
  1395* Copyright (c) 2007-2013 Dell Inc.
  1396* All rights reserved.
  1397*
  1398****************************************************************
  1399 01  DFHEIV.
  1400   02  DFHEIV0               PIC X(35).
  1401   02  DFHEIV1               PIC X(08).
  1402   02  DFHEIV2               PIC X(08).
  1403   02  DFHEIV3               PIC X(08).
  1404   02  DFHEIV4               PIC X(06).
  1405   02  DFHEIV5               PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  26
* EL1041.cbl
  1406   02  DFHEIV6               PIC X(04).
  1407   02  DFHEIV7               PIC X(02).
  1408   02  DFHEIV8               PIC X(02).
  1409   02  DFHEIV9               PIC X(01).
  1410   02  DFHEIV10              PIC S9(7) COMP-3.
  1411   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1412   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1413   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1414   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1415   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1416   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1417   02  DFHEIV17              PIC X(04).
  1418   02  DFHEIV18              PIC X(04).
  1419   02  DFHEIV19              PIC X(04).
  1420   02  DFHEIV20              USAGE IS POINTER.
  1421   02  DFHEIV21              USAGE IS POINTER.
  1422   02  DFHEIV22              USAGE IS POINTER.
  1423   02  DFHEIV23              USAGE IS POINTER.
  1424   02  DFHEIV24              USAGE IS POINTER.
  1425   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1426   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1427   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1428   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1429   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1430   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1431   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1432   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1433   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1434   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1435   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1436   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1437   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1438   02  FILLER                PIC X(02).
  1439   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1440   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1441   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1442   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1443   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1444   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1445   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1446 LINKAGE  SECTION.
  1447*****************************************************************
  1448*                                                               *
  1449* Copyright (c) 2007-2013 Dell Inc.                             *
  1450* All rights reserved.                                          *
  1451*                                                               *
  1452*****************************************************************
  1453 01  dfheiblk.
  1454     02  eibtime          pic s9(7) comp-3.
  1455     02  eibdate          pic s9(7) comp-3.
  1456     02  eibtrnid         pic x(4).
  1457     02  eibtaskn         pic s9(7) comp-3.
  1458     02  eibtrmid         pic x(4).
  1459     02  dfheigdi         pic s9(4) comp.
  1460     02  eibcposn         pic s9(4) comp.
  1461     02  eibcalen         pic s9(4) comp.
  1462     02  eibaid           pic x(1).
  1463     02  eibfiller1       pic x(1).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  27
* EL1041.cbl
  1464     02  eibfn            pic x(2).
  1465     02  eibfiller2       pic x(2).
  1466     02  eibrcode         pic x(6).
  1467     02  eibfiller3       pic x(2).
  1468     02  eibds            pic x(8).
  1469     02  eibreqid         pic x(8).
  1470     02  eibrsrce         pic x(8).
  1471     02  eibsync          pic x(1).
  1472     02  eibfree          pic x(1).
  1473     02  eibrecv          pic x(1).
  1474     02  eibsend          pic x(1).
  1475     02  eibatt           pic x(1).
  1476     02  eibeoc           pic x(1).
  1477     02  eibfmh           pic x(1).
  1478     02  eibcompl         pic x(1).
  1479     02  eibsig           pic x(1).
  1480     02  eibconf          pic x(1).
  1481     02  eiberr           pic x(1).
  1482     02  eibrldbk         pic x(1).
  1483     02  eiberrcd         pic x(4).
  1484     02  eibsynrb         pic x(1).
  1485     02  eibnodat         pic x(1).
  1486     02  eibfiller5       pic x(2).
  1487     02  eibresp          pic s9(8) comp.
  1488     02  eibresp2         pic s9(8) comp.
  1489     02  dfheigdj         pic s9(4) comp.
  1490     02  dfheigdk         pic s9(4) comp.
  1491 01  DFHCOMMAREA                     PIC X(1024).
  1492*                                    COPY ELCTEXT.
  1493******************************************************************
  1494*                                                                *
  1495*                                                                *
  1496*                            ELCTEXT.                            *
  1497*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1498*                            VMOD=2.008                          *
  1499*                                                                *
  1500*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
  1501*                                     FORM LETTERS,              *
  1502*                                     CERT FORM DISPLAY.
  1503*                                                                *
  1504*   FILE TYPE = VSAM,KSDS                                        *
  1505*   RECORD SIZE = 100   RECFORM = FIXED                          *
  1506*                                                                *
  1507*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
  1508*       ALTERNATE INDEX = NONE                                   *
  1509*                                                                *
  1510*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
  1511*       ALTERNATE INDEX = NONE                                   *
  1512*                                                                *
  1513*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
  1514*       ALTERNATE INDEX = NONE                                   *
  1515*                                                                *
  1516*   LOG = NO                                                     *
  1517*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1518******************************************************************
  1519 01  TEXT-FILES.
  1520     12  TEXT-FILE-ID                PIC XX.
  1521         88  FORMS-FILE-TEXT            VALUE 'TF'.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  28
* EL1041.cbl
  1522         88  LETTER-FILE-TEXT           VALUE 'TL'.
  1523         88  HELP-FILE-TEXT             VALUE 'TH'.
  1524
  1525     12  TX-CONTROL-PRIMARY.
  1526         16  TX-COMPANY-CD           PIC X.
  1527             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
  1528         16  TX-ACCESS-CD-GENL       PIC X(12).
  1529
  1530         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1531             20  TX-LETTER-NO        PIC X(4).
  1532             20  FILLER              PIC X(8).
  1533
  1534         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1535             20  TX-FORM-NO          PIC X(12).
  1536
  1537         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
  1538             20  TX-HELP-TYPE        PIC X.
  1539                 88  HELP-FOR-GENERAL   VALUE ' '.
  1540                 88  HELP-BY-SCREEN     VALUE 'S'.
  1541                 88  HELP-BY-ERROR      VALUE 'E'.
  1542             20  TX-SCREEN-OR-ERROR  PIC X(4).
  1543                 88  GENERAL-INFO-HELP  VALUE '0000'.
  1544             20  TX-HELP-FOR-COMPANY  PIC XXX.
  1545                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
  1546             20  FILLER              PIC X(4).
  1547
  1548         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
  1549
  1550     12  TX-PROCESS-CONTROL          PIC XX.
  1551         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
  1552
  1553     12  TX-TEXT-LINE                PIC X(70).
  1554
  1555     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
  1556         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
  1557         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
  1558         88  TX-VALID-FORM-SQUEEZE-VALUE
  1559                                        VALUE 'Y' ' '.
  1560
  1561     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
  1562         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
  1563         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
  1564         88  TX-DO-NOT-ADJUST           VALUE 'N'.
  1565         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
  1566         88  TX-NEW-PARAGRAPH           VALUE 'P'.
  1567         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
  1568         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
  1569                                              'K' 'N' ' '
  1570                                              'Z'.
  1571
  1572     12  TX-ARCHIVE-SW               PIC X.
  1573         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1574         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1575         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1576
  1577     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1578     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1579
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  29
* EL1041.cbl
  1580     12  TX-BSR-CODE                 PIC X.
  1581         88  TX-BSR-LETTER              VALUE 'B'.
  1582         88  TX-NON-BSR-LETTER          VALUE ' '.
  1583
  1584     12  FILLER                      PIC X.
  1585*****************************************************************
  1586*                                    COPY ELCENCC.
  1587******************************************************************
  1588*                                                                *
  1589*                                                                *
  1590*                            ELCENCC                             *
  1591*                            VMOD=2.001                          *
  1592*                                                                *
  1593*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  1594*                                                                *
  1595*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  1596*   A NAPERSOFT DOCUMENT                                         *
  1597*                                                                *
  1598*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  1599*                                                                *
  1600*   FILE TYPE = VSAM,KSDS                                        *
  1601*   RECORD SIZE = 400   RECFORM = FIX                            *
  1602*                                                                *
  1603*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  1604*                                                                *
  1605*   LOG = NO                                                     *
  1606*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1607*                                                                *
  1608*                                                                *
  1609******************************************************************
  1610*                   C H A N G E   L O G
  1611*
  1612* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1613*-----------------------------------------------------------------
  1614*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1615* EFFECTIVE    NUMBER
  1616*-----------------------------------------------------------------
  1617* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  1618* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  1619******************************************************************
  1620 01  ENCLOSURE-CODES.
  1621     12  NC-RECORD-ID                      PIC XX.
  1622         88  VALID-NC-ID                      VALUE 'NC'.
  1623     12  NC-CONTROL-PRIMARY.
  1624         16  NC-COMPANY-CD                 PIC X.
  1625         16  NC-REC-TYPE                   PIC X.
  1626             88  NC-CLAIMS                   VALUE '1'.
  1627             88  NC-ADMIN                    VALUE '2'.
  1628         16  NC-ENC-CODE                   PIC X(5).
  1629         16  FILLER                        PIC X(09).
  1630     12  NC-MAINT-INFORMATION.
  1631         16  NC-LAST-MAINT-DT              PIC XX.
  1632         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1633         16  NC-LAST-MAINT-USER            PIC X(4).
  1634         16  FILLER                        PIC XX.
  1635     12  NC-OUTPUT-STACK                   PIC XXX.
  1636     12  NC-ENCLOSURE-LINE                 PIC X(100).
  1637     12  NC-ATTACHMENTS                    PIC X(255).
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  30
* EL1041.cbl
  1638     12  NC-FUTURE                         PIC X(12).
  1639******************************************************************
  1640 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA TEXT-FILES
  1641                          ENCLOSURE-CODES.
  1642 0000-DFHEXIT SECTION.
  1643     MOVE '9#                    $   ' TO DFHEIV0.
  1644     MOVE 'EL1041' TO DFHEIV1.
  1645     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1646     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1647     MOVE '5'                    TO DC-OPTION-CODE
  1648     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  1649     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1650     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1651     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  1652     IF EIBCALEN = 0
  1653        GO TO 8800-UNAUTHORIZED-ACCESS.
  1654     MOVE PI-LIFE-OVERRIDE-L6    TO EMI-LIFE-OVERRIDE-L6
  1655     MOVE PI-AH-OVERRIDE-L6      TO EMI-AH-OVERRIDE-L6
  1656     MOVE 1                      TO EMI-NUMBER-OF-LINES
  1657
  1658* EXEC CICS HANDLE CONDITION
  1659*        DUPREC     (8850-DUPREC)
  1660*        NOTOPEN    (8870-NOTOPEN)
  1661*        NOTFND     (8880-NOT-FOUND)
  1662*        PGMIDERR   (9600-PGMID-ERROR)
  1663*        ERROR      (9990-ABEND)
  1664*    END-EXEC.
  1665*    MOVE '"$%JIL.               ! " #00001653' TO DFHEIV0
  1666     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  1667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1668     MOVE X'2220233030303031363533' TO DFHEIV0(25:11)
  1669     CALL 'kxdfhei1' USING DFHEIV0
  1670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1671
  1672     .
  1673 0150-SET-PROGRAM-SAVES.
  1674     IF PI-CALLING-PROGRAM NOT EQUAL THIS-PGM
  1675         IF PI-RETURN-TO-PROGRAM NOT EQUAL THIS-PGM
  1676             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1677             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1678             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1679             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1680             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1681             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1682             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1683             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1684         ELSE
  1685             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1686             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1687             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1688             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1689             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1690             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1691             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1692             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  1693     ELSE
  1694         GO TO 0200-RECEIVE.
  1695     DISPLAY ' COMM KEY PASSED ' PI-COMM-CONTROL
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  31
* EL1041.cbl
  1696     MOVE PI-COMPANY-CD          TO ELLETR-KEY
  1697     MOVE PI-COMM-CONTROL        TO ELLETR-KEY (2:12)
  1698     MOVE ZEROS                  TO ELLETR-SEQ-NO
  1699     MOVE ELLETR-KEY             TO PI-CURR-LETR-KEY
  1700                                    PI-PREV-LETR-KEY
  1701
  1702     PERFORM 6500-BUILD-CURRENT-CODES THRU 6500-EXIT
  1703
  1704     GO TO 1000-SHOW-LETR-RECORD
  1705     .
  1706 0200-RECEIVE.
  1707     IF EIBAID = DFHCLEAR
  1708        GO TO 9400-CLEAR.
  1709     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  1710         MOVE LOW-VALUES             TO  EL104ZI
  1711         MOVE ER-7008                TO  EMI-ERROR
  1712         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1713         MOVE -1                     TO  MAINTL
  1714         GO TO 8200-SEND-DATAONLY.
  1715     IF PI-PROCESSOR-ID EQUAL 'LGXX'
  1716         NEXT SENTENCE
  1717     ELSE
  1718
  1719* EXEC CICS READQ TS
  1720*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  1721*            INTO   (SECURITY-CONTROL)
  1722*            LENGTH (SC-COMM-LENGTH)
  1723*            ITEM   (SC-ITEM)
  1724*        END-EXEC
  1725*    MOVE '*$II   L              ''   #00001706' TO DFHEIV0
  1726     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1727     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1728     MOVE X'2020233030303031373036' TO DFHEIV0(25:11)
  1729     CALL 'kxdfhei1' USING DFHEIV0,
  1730           PI-SECURITY-TEMP-STORE-ID,
  1731           SECURITY-CONTROL,
  1732           SC-COMM-LENGTH,
  1733           SC-ITEM,
  1734           DFHEIV99,
  1735           DFHEIV99
  1736     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1737         MOVE SC-CLAIMS-DISPLAY (4)  TO  PI-DISPLAY-CAP
  1738         MOVE SC-CLAIMS-UPDATE  (4)  TO  PI-MODIFY-CAP.
  1739
  1740* EXEC CICS RECEIVE
  1741*        MAP      (WS-MAP-NAME)
  1742*        MAPSET   (MAPSET-NAME)
  1743*        INTO     (EL104ZI)
  1744*    END-EXEC
  1745     MOVE LENGTH OF
  1746      EL104ZI
  1747       TO DFHEIV11
  1748*    MOVE '8"T I  L              ''   #00001714' TO DFHEIV0
  1749     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1750     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1751     MOVE X'2020233030303031373134' TO DFHEIV0(25:11)
  1752     CALL 'kxdfhei1' USING DFHEIV0,
  1753           WS-MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  32
* EL1041.cbl
  1754           EL104ZI,
  1755           DFHEIV11,
  1756           MAPSET-NAME,
  1757           DFHEIV99,
  1758           DFHEIV99
  1759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1760     IF PFKEYL = +0
  1761         GO TO 0300-CHECK-PFKEYS.
  1762     IF (PFKEYI NUMERIC) AND (PFKEYI GREATER 0 AND LESS 25)
  1763         MOVE PF-VALUES (PFKEYI)     TO  EIBAID
  1764     ELSE
  1765         MOVE ER-0029                TO  EMI-ERROR
  1766         GO TO 0320-INPUT-ERROR.
  1767 0300-CHECK-PFKEYS.
  1768     DISPLAY ' MADE IT TO 0300 '
  1769     IF EIBAID EQUAL DFHPF23
  1770         GO TO 8810-PF23.
  1771     IF EIBAID EQUAL DFHPF24
  1772         GO TO 9200-RETURN-MAIN-MENU.
  1773     IF EIBAID EQUAL DFHPF12
  1774         GO TO 9500-PF12.
  1775     IF (MAINTL <> 0) AND (EIBAID <> DFHENTER)
  1776         MOVE ER-0050            TO EMI-ERROR
  1777         GO TO 0320-INPUT-ERROR.
  1778     IF EIBAID EQUAL DFHENTER
  1779         GO TO 0330-EDIT-DATA.
  1780     MOVE ER-0029                    TO  EMI-ERROR.
  1781 0320-INPUT-ERROR.
  1782     DISPLAY ' MADE IT TO 0320 '
  1783     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1784     MOVE AL-UNBON                   TO  PFKEYA.
  1785     MOVE -1                         TO  PFKEYL.
  1786     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  33
* EL1041.cbl
  1788 0330-EDIT-DATA.
  1789     IF NOT DISPLAY-CAP
  1790         MOVE 'READ'                 TO  SM-READ
  1791         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1792         MOVE ER-0070                TO  EMI-ERROR
  1793         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1794         MOVE -1                     TO  MAINTL
  1795         GO TO 8100-SEND-INITIAL-MAP.
  1796     IF MAINTI EQUAL 'S'
  1797        GO TO 1000-SHOW-LETR-RECORD.
  1798     IF MAINTI = 'C' OR 'A'
  1799        IF NOT MODIFY-CAP
  1800           PERFORM 9995-SECURITY-VIOLATION
  1801                                 THRU 9995-EXIT
  1802           MOVE ER-0070          TO EMI-ERROR
  1803           PERFORM 9900-ERROR-FORMAT
  1804                                 THRU 9900-EXIT
  1805           MOVE LOW-VALUES       TO EL104ZO
  1806           MOVE -1               TO MAINTL
  1807           GO TO 8100-SEND-INITIAL-MAP
  1808        END-IF
  1809     END-IF
  1810     IF MAINTI = 'C'
  1811        GO TO 2000-CHANGE-LETR-RECORD
  1812     END-IF
  1813     IF MAINTI = 'A'
  1814        GO TO 3000-ADD-LETR-RECORD
  1815     END-IF
  1816     MOVE ER-0023                    TO  EMI-ERROR.
  1817     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1818     MOVE -1                         TO  MAINTL.
  1819     MOVE AL-UABON                   TO  MAINTA.
  1820     GO TO 8200-SEND-DATAONLY.
  1821 1000-SHOW-LETR-RECORD.
  1822     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1823
  1824* EXEC CICS STARTBR
  1825*        DATASET   (ELLETR-FILE-ID)
  1826*        RIDFLD    (ELLETR-KEY)
  1827*        GTEQ
  1828*        RESP      (WS-RESPONSE)
  1829*    END-EXEC
  1830     MOVE 0
  1831       TO DFHEIV11
  1832*    MOVE '&,         G          &  N#00001782' TO DFHEIV0
  1833     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1834     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1835     MOVE X'204E233030303031373832' TO DFHEIV0(25:11)
  1836     CALL 'kxdfhei1' USING DFHEIV0,
  1837           ELLETR-FILE-ID,
  1838           ELLETR-KEY,
  1839           DFHEIV99,
  1840           DFHEIV11,
  1841           DFHEIV99
  1842     MOVE EIBRESP  TO WS-RESPONSE
  1843     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1844     IF RESP-NORMAL
  1845        PERFORM UNTIL I-SAY-TO-STOP
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  34
* EL1041.cbl
  1846           OR WE-FOUND-IT
  1847
  1848* EXEC CICS READNEXT
  1849*              DATASET    (ELLETR-FILE-ID)
  1850*              SET        (ADDRESS OF TEXT-FILES)
  1851*              RIDFLD     (ELLETR-KEY)
  1852*              RESP       (WS-RESPONSE)
  1853*          END-EXEC
  1854     MOVE 0
  1855       TO DFHEIV11
  1856*    MOVE '&.S                   )  N#00001791' TO DFHEIV0
  1857     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1858     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1859     MOVE X'204E233030303031373931' TO DFHEIV0(25:11)
  1860     CALL 'kxdfhei1' USING DFHEIV0,
  1861           ELLETR-FILE-ID,
  1862           DFHEIV20,
  1863           DFHEIV99,
  1864           ELLETR-KEY,
  1865           DFHEIV99,
  1866           DFHEIV11,
  1867           DFHEIV99,
  1868           DFHEIV99
  1869     SET ADDRESS OF TEXT-FILES TO
  1870         DFHEIV20
  1871     MOVE EIBRESP  TO WS-RESPONSE
  1872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1873           IF (RESP-NORMAL)
  1874              AND (TX-LETTER-NO = PI-COMM-CONTROL (1:4))
  1875              IF (TX-LINE-SQUEEZE-CONTROL = 'Z')
  1876                 SET WE-FOUND-IT   TO TRUE
  1877              END-IF
  1878           ELSE
  1879              SET I-SAY-TO-STOP  TO TRUE
  1880           END-IF
  1881        END-PERFORM
  1882     END-IF
  1883     IF WE-FOUND-IT
  1884        MOVE TX-CONTROL-PRIMARY  TO PI-CURR-LETR-KEY
  1885                                    PI-PREV-LETR-KEY
  1886        GO TO 7000-BUILD-OUTPUT-MAP
  1887     END-IF
  1888     MOVE ER-0418                TO EMI-ERROR.
  1889     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  1890     MOVE -1                     TO MAINTL
  1891     MOVE 'A'                    TO MAINTI
  1892     MOVE AL-UANON               TO MAINTA
  1893     MOVE PI-COMM-CONTROL (1:4)  TO ZLETRI
  1894     MOVE +4                     TO ZLETRL
  1895     MOVE AL-UANON               TO ZLETRA
  1896     GO TO 8100-SEND-INITIAL-MAP
  1897     .
  1898 2000-CHANGE-LETR-RECORD.
  1899     display ' made it to 2000 '
  1900     display ' curr   ' pi-curr-letr-key
  1901     display ' prev   ' pi-prev-letr-key
  1902     IF PI-CURR-LETR-KEY NOT = PI-PREV-LETR-KEY
  1903        MOVE ER-0145             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  35
* EL1041.cbl
  1904        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1905        MOVE -1                  TO MAINTL
  1906        GO TO 8200-SEND-DATAONLY
  1907     END-IF
  1908     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  1909     IF NOT EMI-NO-ERRORS
  1910         GO TO 8200-SEND-DATAONLY.
  1911     MOVE PI-CURR-LETR-KEY       TO ELLETR-KEY
  1912     .
  1913 2000-CHANGE-CONTINUE.
  1914
  1915* EXEC CICS READ
  1916*        DATASET    (ELLETR-FILE-ID)
  1917*        SET        (ADDRESS OF TEXT-FILES)
  1918*        RIDFLD     (ELLETR-KEY)
  1919*        UPDATE
  1920*        RESP       (WS-RESPONSE)
  1921*    END-EXEC
  1922*    MOVE '&"S        EU         (  N#00001838' TO DFHEIV0
  1923     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1924     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1925     MOVE X'204E233030303031383338' TO DFHEIV0(25:11)
  1926     CALL 'kxdfhei1' USING DFHEIV0,
  1927           ELLETR-FILE-ID,
  1928           DFHEIV20,
  1929           DFHEIV99,
  1930           ELLETR-KEY,
  1931           DFHEIV99,
  1932           DFHEIV99,
  1933           DFHEIV99
  1934     SET ADDRESS OF TEXT-FILES TO
  1935         DFHEIV20
  1936     MOVE EIBRESP  TO WS-RESPONSE
  1937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1938     IF RESP-NOTFND
  1939        IF ELLETR-SEQ-NO = +0
  1940           GO TO 3000-CONTINUE-ADD
  1941        END-IF
  1942     END-IF
  1943     IF TX-LAST-MAINTENANCED-BY NOT = PI-UPDATE-BY OR
  1944        TX-LAST-MAINTENANCED-DT NOT = PI-UPDATE-DT
  1945
  1946* EXEC CICS UNLOCK
  1947*            DATASET   (ELLETR-FILE-ID)
  1948*        END-EXEC
  1949*    MOVE '&*                    #   #00001852' TO DFHEIV0
  1950     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  1951     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1952     MOVE X'2020233030303031383532' TO DFHEIV0(25:11)
  1953     CALL 'kxdfhei1' USING DFHEIV0,
  1954           ELLETR-FILE-ID,
  1955           DFHEIV99
  1956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1957         MOVE ER-0068                TO  EMI-ERROR
  1958         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1959         GO TO 1000-SHOW-LETR-RECORD.
  1960     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  1961     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  36
* EL1041.cbl
  1962     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  1963     IF ZCOPIESL > +0
  1964        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  1965     END-IF
  1966     IF ZFADAYSL > +0
  1967        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  1968     END-IF
  1969     IF ZRDAYSL > +0
  1970        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  1971     END-IF
  1972     IF ZFORML > +0
  1973        MOVE ZFORMI              TO W-FORM-TO-RESEND
  1974     END-IF
  1975     IF ZPROMPTL > +0
  1976        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  1977     END-IF
  1978     IF ZENCCDL > +0
  1979        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  1980     END-IF
  1981     IF ZACLOSEL > +0
  1982        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  1983     END-IF
  1984     IF ZBENEL > +0
  1985        MOVE ZBENEI              TO W-LETTER-TO-BENE
  1986     END-IF
  1987
  1988     IF ZBARCODL > +0
  1989        MOVE ZBARCODI            TO W-ADD-BAR-CODE
  1990     END-IF
  1991
  1992     IF ZRETENVL > +0
  1993        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
  1994     END-IF
  1995     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  1996     .
  1997 2000-CONTINUE-CHANGE.
  1998     DISPLAY ' ABOUT TO REWRITE '
  1999
  2000* EXEC CICS REWRITE
  2001*        DATASET   (ELLETR-FILE-ID)
  2002*        FROM      (TEXT-FILES)
  2003*    END-EXEC.
  2004     MOVE LENGTH OF
  2005      TEXT-FILES
  2006       TO DFHEIV11
  2007*    MOVE '&& L                  %   #00001897' TO DFHEIV0
  2008     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2009     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2010     MOVE X'2020233030303031383937' TO DFHEIV0(25:11)
  2011     CALL 'kxdfhei1' USING DFHEIV0,
  2012           ELLETR-FILE-ID,
  2013           TEXT-FILES,
  2014           DFHEIV11,
  2015           DFHEIV99
  2016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2017
  2018     MOVE ER-0000                    TO  EMI-ERROR.
  2019     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  37
* EL1041.cbl
  2020     GO TO 1000-SHOW-LETR-RECORD
  2021     .
  2022 3000-ADD-LETR-RECORD.
  2023     display ' made it to 3000 '
  2024     display ' curr   ' pi-curr-letr-key
  2025     display ' prev   ' pi-prev-letr-key
  2026     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT
  2027     .
  2028 3000-CONTINUE-ADD.
  2029     IF NOT EMI-NO-ERRORS
  2030        GO TO 8200-SEND-DATAONLY
  2031     END-IF
  2032     MOVE SPACES                 TO ELLETR-KEY
  2033     MOVE PI-COMPANY-CD          TO ELLETR-COMPANY-CD
  2034     MOVE ZLETRI                 TO ELLETR-ACCESS-CD
  2035     MOVE +0                     TO ELLETR-SEQ-NO
  2036
  2037* EXEC CICS READ
  2038*        DATASET    (ELLETR-FILE-ID)
  2039*        SET        (ADDRESS OF TEXT-FILES)
  2040*        RIDFLD     (ELLETR-KEY)
  2041*        GTEQ
  2042*        RESP       (WS-RESPONSE)
  2043*    END-EXEC
  2044*    MOVE '&"S        G          (  N#00001919' TO DFHEIV0
  2045     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2046     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2047     MOVE X'204E233030303031393139' TO DFHEIV0(25:11)
  2048     CALL 'kxdfhei1' USING DFHEIV0,
  2049           ELLETR-FILE-ID,
  2050           DFHEIV20,
  2051           DFHEIV99,
  2052           ELLETR-KEY,
  2053           DFHEIV99,
  2054           DFHEIV99,
  2055           DFHEIV99
  2056     SET ADDRESS OF TEXT-FILES TO
  2057         DFHEIV20
  2058     MOVE EIBRESP  TO WS-RESPONSE
  2059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2060     IF RESP-NORMAL
  2061        IF TX-LETTER-NO = ZLETRI
  2062           IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  2063              MOVE ER-0132       TO EMI-ERROR
  2064              PERFORM 9900-ERROR-FORMAT
  2065                                 THRU 9900-EXIT
  2066              MOVE -1            TO ZLETRL
  2067              MOVE AL-UABON      TO ZLETRA
  2068              GO TO 8200-SEND-DATAONLY
  2069           ELSE
  2070              MOVE +0            TO WS-SEQ-NO-TO-USE
  2071           END-IF
  2072        ELSE
  2073           MOVE +1               TO WS-SEQ-NO-TO-USE
  2074        END-IF
  2075     ELSE
  2076        MOVE +1                  TO WS-SEQ-NO-TO-USE
  2077     END-IF
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  38
* EL1041.cbl
  2078
  2079* EXEC CICS GETMAIN
  2080*       SET(ADDRESS OF TEXT-FILES)
  2081*       LENGTH(ELLETR-LENGTH)
  2082*    END-EXEC
  2083*    MOVE '," L                  $   #00001944' TO DFHEIV0
  2084     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  2085     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2086     MOVE X'2020233030303031393434' TO DFHEIV0(25:11)
  2087     CALL 'kxdfhei1' USING DFHEIV0,
  2088           DFHEIV20,
  2089           ELLETR-LENGTH,
  2090           DFHEIV99
  2091     SET ADDRESS OF TEXT-FILES TO
  2092         DFHEIV20
  2093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2094     MOVE SPACES                 TO TEXT-FILES
  2095     MOVE 'TL'                   TO TEXT-FILE-ID
  2096     MOVE PI-COMPANY-CD          TO TX-COMPANY-CD
  2097     MOVE ZLETRI                 TO TX-LETTER-NO
  2098     MOVE WS-SEQ-NO-TO-USE       TO TX-LINE-SEQUENCE
  2099     MOVE 'Z'                    TO TX-LINE-SQUEEZE-CONTROL
  2100     MOVE PI-PROCESSOR-ID        TO TX-LAST-MAINTENANCED-BY
  2101     MOVE SAVE-BIN-DATE          TO TX-LAST-MAINTENANCED-DT
  2102     MOVE SPACES                 TO W-Z-CONTROL-DATA
  2103     IF ZCOPIESL > +0
  2104        MOVE ZCOPIESO            TO W-NUMBER-OF-COPIES
  2105     ELSE
  2106        MOVE 1                   TO W-NUMBER-OF-COPIES
  2107     END-IF
  2108     IF ZFADAYSL > +0
  2109        MOVE ZFADAYSO            TO W-DAYS-TO-FOLLOW-UP
  2110     ELSE
  2111        MOVE ZEROS               TO W-DAYS-TO-FOLLOW-UP
  2112     END-IF
  2113     IF ZRDAYSL > +0
  2114        MOVE ZRDAYSO             TO W-DAYS-TO-RESEND
  2115     ELSE
  2116        MOVE ZEROS               TO W-DAYS-TO-RESEND
  2117     END-IF
  2118     IF ZFORML > +0
  2119        MOVE ZFORMI              TO W-FORM-TO-RESEND
  2120     END-IF
  2121     IF ZPROMPTL > +0
  2122        MOVE ZPROMPTI            TO W-PROMPT-LETTER
  2123     END-IF
  2124     IF ZENCCDL > +0
  2125        MOVE ZENCCDI             TO W-ENCLOSURE-CD
  2126     END-IF
  2127     IF ZACLOSEL > +0
  2128        MOVE ZACLOSEI            TO W-AUTO-CLOSE-IND
  2129     END-IF
  2130     IF ZBENEL > +0
  2131        MOVE ZBENEI              TO W-LETTER-TO-BENE
  2132     END-IF
  2133
  2134     IF ZBARCODL > +0
  2135        MOVE ZBARCODI            TO W-ADD-BAR-CODE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  39
* EL1041.cbl
  2136     END-IF
  2137
  2138     IF ZRETENVL > +0
  2139        MOVE ZRETENVI            TO W-HAS-RETURN-ENV
  2140     END-IF
  2141     MOVE W-Z-CONTROL-DATA       TO TX-TEXT-LINE
  2142     DISPLAY ' ABOUT TO WRITE '
  2143     MOVE TX-CONTROL-PRIMARY     TO ELLETR-KEY
  2144                                    PI-CURR-LETR-KEY
  2145                                    PI-PREV-LETR-KEY
  2146
  2147* EXEC CICS WRITE
  2148*       DATASET (ELLETR-FILE-ID)
  2149*       FROM    (TEXT-FILES)
  2150*       RIDFLD  (ELLETR-KEY)
  2151*    END-EXEC
  2152     MOVE LENGTH OF
  2153      TEXT-FILES
  2154       TO DFHEIV11
  2155*    MOVE '&$ L                  ''   #00002000' TO DFHEIV0
  2156     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2157     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2158     MOVE X'2020233030303032303030' TO DFHEIV0(25:11)
  2159     CALL 'kxdfhei1' USING DFHEIV0,
  2160           ELLETR-FILE-ID,
  2161           TEXT-FILES,
  2162           DFHEIV11,
  2163           ELLETR-KEY,
  2164           DFHEIV99,
  2165           DFHEIV99
  2166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2167     MOVE ER-0000                    TO  EMI-ERROR.
  2168     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2169     GO TO 1000-SHOW-LETR-RECORD
  2170     .
  2171 5000-FIND-NEXT-PROD-RECORD.
  2172*    MOVE PI-PROD-KEY            TO ELLETR-KEY
  2173*
  2174*    EXEC CICS STARTBR
  2175*        DATASET   (ELLETR-FILE-ID)
  2176*        RIDFLD    (ELLETR-KEY)
  2177*        GTEQ
  2178*        RESP      (WS-RESPONSE)
  2179*    END-EXEC
  2180*
  2181*    IF NOT RESP-NORMAL
  2182*       MOVE -1                  TO PFKEYL
  2183*       MOVE ER-0130             TO EMI-ERROR
  2184*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2185*       GO TO 8200-SEND-DATAONLY
  2186*    END-IF
  2187     .
  2188 5000-READNEXT-LOOP.
  2189*    EXEC CICS READNEXT
  2190*        DATASET   (ELLETR-FILE-ID)
  2191*        SET       (ADDRESS OF PRODUCT-MASTER)
  2192*        RIDFLD    (ELLETR-KEY)
  2193*        RESP      (WS-RESPONSE)
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  40
* EL1041.cbl
  2194*    END-EXEC
  2195*
  2196*    IF (NOT RESP-NORMAL)
  2197*       OR (PD-COMPANY-CD NOT = PI-COMPANY-CD)
  2198*       PERFORM 5000-END-BROWSE
  2199*       MOVE -1                  TO PFKEYL
  2200*       MOVE ER-0130             TO EMI-ERROR
  2201*       PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2202*       GO TO 1000-SHOW-LETR-RECORD
  2203*    END-IF
  2204*
  2205*    IF ELLETR-KEY = PI-PREV-LETR-KEY
  2206*       GO TO 5000-READNEXT-LOOP
  2207*    END-IF
  2208*
  2209*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2210*
  2211*    PERFORM 5000-END-BROWSE
  2212*    GO TO 7000-BUILD-OUTPUT-MAP
  2213     .
  2214 5000-END-BROWSE.
  2215*    EXEC CICS ENDBR
  2216*        DATASET   (ELLETR-FILE-ID)
  2217*    END-EXEC
  2218     .
  2219 5100-FIND-PREV-PROD-RECORD.
  2220*    MOVE PI-PREV-LETR-KEY       TO ELLETR-KEY
  2221*    IF STATEL > +0
  2222*       MOVE STATEI              TO ELLETR-STATE
  2223*    END-IF
  2224*    IF PRODCDL > +0
  2225*       MOVE PRODCDI             TO ELLETR-PROD-CD
  2226*    END-IF
  2227*    IF BENTYPL > +0
  2228*        MOVE BENTYPI                TO  ELLETR-BEN-TYPE.
  2229*    IF BENCODEL > +0
  2230*        MOVE BENCODEI               TO  ELLETR-BEN-CODE.
  2231*    IF EXPDTL IS GREATER THAN +0
  2232*        MOVE EXPDTI                 TO  DEEDIT-FIELD
  2233*        PERFORM 8600-DEEDIT THRU 8600-EXIT
  2234*        IF WS-NUMVAL-OF-DEEDIT >= 999999
  2235*            MOVE HIGH-VALUES        TO  ELLETR-EXP-DT
  2236*        ELSE
  2237*          STRING WS-NUMVAL (8:4) WS-NUMVAL (4:2) WS-NUMVAL (6:12)
  2238*             DELIMITED BY SIZE INTO DC-GREG-DATE-CYMD
  2239*          END-STRING
  2240*           MOVE 'L'                    TO  DC-OPTION-CODE
  2241*            PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  2242*            IF NO-CONVERSION-ERROR
  2243*                MOVE DC-BIN-DATE-1  TO  ELLETR-EXP-DT
  2244*            ELSE
  2245*                MOVE LOW-VALUES     TO  ELLETR-EXP-DT.
  2246*
  2247*    EXEC CICS HANDLE CONDITION
  2248*        ENDFILE (5100-UNSUCCESSFUL-SEARCH)
  2249*    END-EXEC.
  2250*
  2251*    EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  41
* EL1041.cbl
  2252*        DATASET   (ELLETR-FILE-ID)
  2253*        RIDFLD    (ELLETR-KEY)
  2254*        GTEQ
  2255*    END-EXEC.
  2256 5100-READPREV-LOOP.
  2257*    EXEC CICS READPREV
  2258*        DATASET   (ELLETR-FILE-ID)
  2259*        SET       (ADDRESS OF PRODUCT-MASTER)
  2260*        RIDFLD    (ELLETR-KEY)
  2261*    END-EXEC.
  2262*
  2263*    IF PD-COMPANY-CD  NOT EQUAL PI-COMPANY-CD
  2264*        GO TO 5100-UNSUCCESSFUL-SEARCH.
  2265*
  2266*    IF ELLETR-KEY IS EQUAL TO PI-PREV-LETR-KEY
  2267*        GO TO 5100-READPREV-LOOP.
  2268*
  2269*    MOVE ELLETR-KEY             TO PI-PROD-KEY
  2270*
  2271*    GO TO 7000-BUILD-OUTPUT-MAP.
  2272 5100-END-BROWSE.
  2273*    EXEC CICS ENDBR
  2274*        DATASET   (ELLETR-FILE-ID)
  2275*    END-EXEC.
  2276 5100-UNSUCCESSFUL-SEARCH.
  2277     PERFORM 5100-END-BROWSE.
  2278     MOVE ER-0131                    TO  EMI-ERROR.
  2279     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2280     GO TO 1000-SHOW-LETR-RECORD.
  2281     .
  2282 6000-EDIT-INPUT-DATA.
  2283     IF MAINTI = 'A'
  2284        IF ZLETRL > +0
  2285           AND ZLETRI NOT = SPACES
  2286           CONTINUE
  2287        ELSE
  2288           MOVE AL-UNBON         TO ZCOPIESA
  2289           MOVE -1               TO ZCOPIESL
  2290           MOVE ER-0005          TO EMI-ERROR
  2291           PERFORM 9900-ERROR-FORMAT
  2292                                 THRU 9900-EXIT
  2293        END-IF
  2294     END-IF
  2295     IF ZCOPIESL > +0
  2296        IF ZCOPIESI NUMERIC
  2297           CONTINUE
  2298        ELSE
  2299           MOVE AL-UNBON         TO ZCOPIESA
  2300           MOVE -1               TO ZCOPIESL
  2301           MOVE ER-0184          TO EMI-ERROR
  2302           PERFORM 9900-ERROR-FORMAT
  2303                                 THRU 9900-EXIT
  2304        END-IF
  2305     END-IF
  2306     IF ZFADAYSL > +0
  2307        IF ZFADAYSI NUMERIC
  2308           CONTINUE
  2309        ELSE
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  42
* EL1041.cbl
  2310           MOVE AL-UNBON         TO ZFADAYSA
  2311           MOVE -1               TO ZFADAYSL
  2312           MOVE ER-0491          TO EMI-ERROR
  2313           PERFORM 9900-ERROR-FORMAT
  2314                                 THRU 9900-EXIT
  2315        END-IF
  2316     END-IF
  2317     IF ZRDAYSL > +0
  2318        IF ZRDAYSI NUMERIC
  2319           CONTINUE
  2320        ELSE
  2321           MOVE AL-UNBON         TO ZRDAYSA
  2322           MOVE -1               TO ZRDAYSL
  2323           MOVE ER-0491          TO EMI-ERROR
  2324           PERFORM 9900-ERROR-FORMAT
  2325                                 THRU 9900-EXIT
  2326        END-IF
  2327     END-IF
  2328     IF ZPROMPTL > +0
  2329        IF ZPROMPTI = 'Y' OR 'N' OR ' '
  2330           CONTINUE
  2331        ELSE
  2332           MOVE AL-UABON         TO ZPROMPTA
  2333           MOVE -1               TO ZPROMPTL
  2334           MOVE ER-0627          TO EMI-ERROR
  2335           PERFORM 9900-ERROR-FORMAT
  2336                                 THRU 9900-EXIT
  2337        END-IF
  2338     END-IF
  2339     IF MAINTI = 'A'
  2340        AND ZENCCDL <= 0
  2341        MOVE AL-UABON            TO ZENCCDA
  2342        MOVE -1                  TO ZENCCDL
  2343        MOVE ER-1560             TO EMI-ERROR
  2344        PERFORM 9900-ERROR-FORMAT
  2345                                 THRU 9900-EXIT
  2346     END-IF
  2347     IF ZENCCDL > +0
  2348        IF ZENCCDI = '@'
  2349            CONTINUE
  2350        ELSE
  2351           MOVE SPACES             TO ELENCC-KEY
  2352           MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  2353           MOVE '1'                TO ELENCC-REC-TYPE
  2354           MOVE ZENCCDI            TO ELENCC-ENC-CODE
  2355
  2356
  2357* EXEC CICS READ
  2358*              DATASET    (ELENCC-FILE-ID)
  2359*              SET        (ADDRESS OF ENCLOSURE-CODES)
  2360*              RIDFLD     (ELENCC-KEY)
  2361*              RESP       (WS-RESPONSE)
  2362*          END-EXEC
  2363*    MOVE '&"S        E          (  N#00002194' TO DFHEIV0
  2364     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2365     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2366     MOVE X'204E233030303032313934' TO DFHEIV0(25:11)
  2367     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  43
* EL1041.cbl
  2368           ELENCC-FILE-ID,
  2369           DFHEIV20,
  2370           DFHEIV99,
  2371           ELENCC-KEY,
  2372           DFHEIV99,
  2373           DFHEIV99,
  2374           DFHEIV99
  2375     SET ADDRESS OF ENCLOSURE-CODES TO
  2376         DFHEIV20
  2377     MOVE EIBRESP  TO WS-RESPONSE
  2378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2379
  2380           IF RESP-NORMAL
  2381              CONTINUE
  2382           ELSE
  2383              MOVE AL-UABON         TO ZENCCDA
  2384              MOVE -1               TO ZENCCDL
  2385              MOVE ER-1560          TO EMI-ERROR
  2386              PERFORM 9900-ERROR-FORMAT
  2387                                 THRU 9900-EXIT
  2388           END-IF
  2389        END-IF
  2390     END-IF
  2391     IF ZACLOSEL > +0
  2392        IF ZACLOSEI = 'S' OR 'C' OR 'B' OR ' '
  2393           CONTINUE
  2394        ELSE
  2395           MOVE -1               TO ZACLOSEL
  2396           MOVE AL-UABON         TO ZACLOSEA
  2397           MOVE ER-1562          TO EMI-ERROR
  2398           PERFORM 9900-ERROR-FORMAT
  2399                                 THRU 9900-EXIT
  2400        END-IF
  2401     END-IF
  2402     IF ZBENEL > +0
  2403        IF ZBENEI = 'Y' OR 'N' OR ' '
  2404           CONTINUE
  2405        ELSE
  2406           MOVE AL-UABON         TO ZBENEA
  2407           MOVE -1               TO ZBENEL
  2408           MOVE ER-0627          TO EMI-ERROR
  2409           PERFORM 9900-ERROR-FORMAT
  2410                                 THRU 9900-EXIT
  2411        END-IF
  2412     END-IF
  2413
  2414     IF ZBARCODL > +0
  2415        IF ZBARCODI = 'Y' OR 'N' OR ' '
  2416           CONTINUE
  2417        ELSE
  2418           MOVE AL-UABON         TO ZBARCODA
  2419           MOVE -1               TO ZBARCODL
  2420           MOVE ER-0627          TO EMI-ERROR
  2421           PERFORM 9900-ERROR-FORMAT
  2422                                 THRU 9900-EXIT
  2423        END-IF
  2424     END-IF
  2425
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  44
* EL1041.cbl
  2426     IF ZRETENVL > +0
  2427        IF ZRETENVI = 'Y' OR 'N' OR ' '
  2428           CONTINUE
  2429        ELSE
  2430           MOVE AL-UABON         TO ZRETENVA
  2431           MOVE -1               TO ZRETENVL
  2432           MOVE ER-0627          TO EMI-ERROR
  2433           PERFORM 9900-ERROR-FORMAT
  2434                                 THRU 9900-EXIT
  2435        END-IF
  2436     END-IF
  2437     .
  2438 6000-EXIT.
  2439     EXIT.
  2440
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  45
* EL1041.cbl
  2442 6500-BUILD-CURRENT-CODES.
  2443      MOVE SPACES             TO ELENCC-KEY
  2444      MOVE PI-COMPANY-CD      TO ELENCC-COMPANY-CD
  2445      MOVE '1'                TO ELENCC-REC-TYPE
  2446      MOVE LOW-VALUES         TO ELENCC-ENC-CODE
  2447      MOVE SPACES             TO HOLD-ENC-CODES
  2448      MOVE '@'                TO HOLD-ENC-CODES (1:1)
  2449      MOVE HOLD-ENC-CODES     TO PI-ENC-CODES
  2450
  2451
  2452* EXEC CICS STARTBR
  2453*        DATASET   (ELENCC-FILE-ID)
  2454*        RIDFLD    (ELENCC-KEY)
  2455*        GTEQ
  2456*        RESP      (WS-RESPONSE)
  2457*     END-EXEC
  2458     MOVE 0
  2459       TO DFHEIV11
  2460*    MOVE '&,         G          &  N#00002272' TO DFHEIV0
  2461     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2462     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2463     MOVE X'204E233030303032323732' TO DFHEIV0(25:11)
  2464     CALL 'kxdfhei1' USING DFHEIV0,
  2465           ELENCC-FILE-ID,
  2466           ELENCC-KEY,
  2467           DFHEIV99,
  2468           DFHEIV11,
  2469           DFHEIV99
  2470     MOVE EIBRESP  TO WS-RESPONSE
  2471     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2472
  2473      IF RESP-NORMAL
  2474        PERFORM UNTIL DONE-WITH-ENCC
  2475           MOVE PI-ENC-CODES TO HOLD-ENC-CODES
  2476
  2477* EXEC CICS READNEXT
  2478*              DATASET    (ELENCC-FILE-ID)
  2479*              SET        (ADDRESS OF ENCLOSURE-CODES)
  2480*              RIDFLD     (ELENCC-KEY)
  2481*              RESP       (WS-RESPONSE)
  2482*          END-EXEC
  2483     MOVE 0
  2484       TO DFHEIV11
  2485*    MOVE '&.S                   )  N#00002282' TO DFHEIV0
  2486     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2487     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2488     MOVE X'204E233030303032323832' TO DFHEIV0(25:11)
  2489     CALL 'kxdfhei1' USING DFHEIV0,
  2490           ELENCC-FILE-ID,
  2491           DFHEIV20,
  2492           DFHEIV99,
  2493           ELENCC-KEY,
  2494           DFHEIV99,
  2495           DFHEIV11,
  2496           DFHEIV99,
  2497           DFHEIV99
  2498     SET ADDRESS OF ENCLOSURE-CODES TO
  2499         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  46
* EL1041.cbl
  2500     MOVE EIBRESP  TO WS-RESPONSE
  2501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2502           IF (RESP-NORMAL)
  2503              AND (ELENCC-COMPANY-CD = PI-COMPANY-CD)
  2504              AND (ELENCC-REC-TYPE = '1')
  2505                 PERFORM VARYING WS-SUB1 FROM 5 BY -1
  2506                      UNTIL ELENCC-ENC-CODE (WS-SUB1:1) <> ' '
  2507                 END-PERFORM
  2508                 IF WS-SUB1 > 2
  2509                     SUBTRACT +1 FROM WS-SUB1
  2510                 END-IF
  2511                 MOVE ELENCC-ENC-CODE (WS-SUB1:2) TO
  2512                             WS-TEST-STATE
  2513                 IF STATE-SPECIFIC AND
  2514                    ELENCC-ENC-CODE NOT = 'ENV'
  2515                    CONTINUE
  2516                 ELSE
  2517                    STRING HOLD-ENC-CODES DELIMITED BY ' '
  2518                         ','
  2519                         ELENCC-ENC-CODE DELIMITED BY ' '
  2520                    INTO PI-ENC-CODES
  2521                 end-if
  2522           ELSE
  2523              SET DONE-WITH-ENCC  TO TRUE
  2524           END-IF
  2525        END-PERFORM
  2526     END-IF
  2527
  2528     MOVE +53 TO PI-SPLIT-SUB
  2529     PERFORM UNTIL PI-ENC-CODES (PI-SPLIT-SUB:1) = ' ' OR ','
  2530         SUBTRACT +1 FROM PI-SPLIT-SUB
  2531     END-PERFORM
  2532
  2533     .
  2534 6500-EXIT.
  2535     EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  47
* EL1041.cbl
  2537 7000-BUILD-OUTPUT-MAP.
  2538     MOVE LOW-VALUES             TO EL104ZO
  2539     MOVE TX-TEXT-LINE           TO W-Z-CONTROL-DATA
  2540     MOVE TX-LETTER-NO           TO ZLETRO
  2541     MOVE W-NUMBER-OF-COPIES     TO ZCOPIESO
  2542     MOVE W-DAYS-TO-FOLLOW-UP    TO ZFADAYSO
  2543     MOVE W-DAYS-TO-RESEND       TO ZRDAYSO
  2544     MOVE W-FORM-TO-RESEND       TO ZFORMO
  2545     MOVE W-PROMPT-LETTER        TO ZPROMPTO
  2546     MOVE W-ENCLOSURE-CD         TO ZENCCDO
  2547     MOVE W-AUTO-CLOSE-IND       TO ZACLOSEO
  2548     MOVE W-LETTER-TO-BENE       TO ZBENEO
  2549     MOVE W-ADD-BAR-CODE         TO ZBARCODO
  2550     MOVE W-HAS-RETURN-ENV       TO ZRETENVO
  2551     MOVE PI-SPLIT-SUB           TO WS-SUB1
  2552     COMPUTE WS-SUB2 = PI-SPLIT-SUB + 1
  2553     COMPUTE WS-SUB3 = 120 - PI-SPLIT-SUB
  2554     MOVE PI-ENC-CODES (1:WS-SUB1) TO ZCODES1O
  2555     MOVE PI-ENC-CODES (WS-SUB2:WS-SUB3) TO ZCODES2O
  2556     MOVE TX-LAST-MAINTENANCED-BY TO LSTUSRO
  2557                                    PI-UPDATE-BY
  2558     MOVE TX-LAST-MAINTENANCED-DT TO PI-UPDATE-DT
  2559                                    DC-BIN-DATE-1
  2560     MOVE ' '                    TO DC-OPTION-CODE
  2561     MOVE +0                     TO DC-ELAPSED-DAYS
  2562                                     DC-ELAPSED-MONTHS.
  2563     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2564     IF NO-CONVERSION-ERROR
  2565        MOVE DC-GREG-DATE-1-EDIT TO LSTDTEO
  2566     ELSE
  2567        MOVE LOW-VALUES          TO LSTDTEO
  2568     END-IF
  2569     MOVE -1                     TO MAINTL
  2570     .
  2571 8100-SEND-INITIAL-MAP.
  2572     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2573     MOVE EIBTIME                    TO  TIME-IN.
  2574     MOVE SAVE-DATE                  TO  DATEO.
  2575     MOVE TIME-OUT                   TO  TIMEO
  2576     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2577     MOVE PI-PROCESSOR-ID        TO USERIDO
  2578     IF PI-COMPANY-ID = 'DCC' OR 'VPP'
  2579        MOVE '6-IU CLM FORM,   7-CONTINUING IU,  ' TO DCCOPTO
  2580     END-IF
  2581
  2582* EXEC CICS SEND
  2583*        MAP      (WS-MAP-NAME)
  2584*        MAPSET   (MAPSET-NAME)
  2585*        FROM     (EL104ZO)
  2586*        ERASE
  2587*        CURSOR
  2588*    END-EXEC.
  2589     MOVE LENGTH OF
  2590      EL104ZO
  2591       TO DFHEIV12
  2592     MOVE -1
  2593       TO DFHEIV11
  2594*    MOVE '8$     CT  E    H L F ,   #00002367' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  48
* EL1041.cbl
  2595     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2596     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2597     MOVE X'2020233030303032333637' TO DFHEIV0(25:11)
  2598     CALL 'kxdfhei1' USING DFHEIV0,
  2599           WS-MAP-NAME,
  2600           EL104ZO,
  2601           DFHEIV12,
  2602           MAPSET-NAME,
  2603           DFHEIV99,
  2604           DFHEIV99,
  2605           DFHEIV99,
  2606           DFHEIV11,
  2607           DFHEIV99,
  2608           DFHEIV99,
  2609           DFHEIV99
  2610     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2611
  2612     MOVE '104Z'                 TO PI-CURRENT-SCREEN-NO
  2613     GO TO 9100-RETURN-TRAN
  2614     .
  2615 8200-SEND-DATAONLY.
  2616     DISPLAY ' MADE IT TO 8200 '
  2617     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSGO.
  2618     MOVE EIBTIME                    TO  TIME-IN.
  2619     MOVE SAVE-DATE                  TO  DATEO.
  2620     MOVE TIME-OUT                   TO  TIMEO.
  2621     MOVE PI-COMPANY-ID          TO CMPNYIDO
  2622     MOVE PI-PROCESSOR-ID        TO USERIDO
  2623
  2624* EXEC CICS SEND
  2625*        MAP      (WS-MAP-NAME)
  2626*        MAPSET   (MAPSET-NAME)
  2627*        FROM     (EL104ZO)
  2628*        DATAONLY
  2629*        CURSOR
  2630*    END-EXEC.
  2631     MOVE LENGTH OF
  2632      EL104ZO
  2633       TO DFHEIV12
  2634     MOVE -1
  2635       TO DFHEIV11
  2636*    MOVE '8$D    CT       H L F ,   #00002385' TO DFHEIV0
  2637     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2638     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2639     MOVE X'2020233030303032333835' TO DFHEIV0(25:11)
  2640     CALL 'kxdfhei1' USING DFHEIV0,
  2641           WS-MAP-NAME,
  2642           EL104ZO,
  2643           DFHEIV12,
  2644           MAPSET-NAME,
  2645           DFHEIV99,
  2646           DFHEIV99,
  2647           DFHEIV99,
  2648           DFHEIV11,
  2649           DFHEIV99,
  2650           DFHEIV99,
  2651           DFHEIV99
  2652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  49
* EL1041.cbl
  2653
  2654     GO TO 9100-RETURN-TRAN
  2655     .
  2656 8300-SEND-TEXT.
  2657
  2658* EXEC CICS SEND TEXT
  2659*        FROM  (LOGOFF-TEXT)
  2660*        LENGTH(LOGOFF-LENGTH)
  2661*        ERASE
  2662*        FREEKB
  2663*    END-EXEC.
  2664*    MOVE '8&      T  E F  H   F -   #00002395' TO DFHEIV0
  2665     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2666     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2667     MOVE X'2020233030303032333935' TO DFHEIV0(25:11)
  2668     CALL 'kxdfhei1' USING DFHEIV0,
  2669           LOGOFF-TEXT,
  2670           LOGOFF-LENGTH,
  2671           DFHEIV99,
  2672           DFHEIV99,
  2673           DFHEIV99,
  2674           DFHEIV99,
  2675           DFHEIV99,
  2676           DFHEIV99,
  2677           DFHEIV99,
  2678           DFHEIV99,
  2679           DFHEIV99,
  2680           DFHEIV99
  2681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2682
  2683
  2684* EXEC CICS RETURN
  2685*        END-EXEC.
  2686*    MOVE '.(                    ''   #00002401' TO DFHEIV0
  2687     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2688     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2689     MOVE X'2020233030303032343031' TO DFHEIV0(25:11)
  2690     CALL 'kxdfhei1' USING DFHEIV0,
  2691           DFHEIV99,
  2692           DFHEIV99,
  2693           DFHEIV99,
  2694           DFHEIV99,
  2695           DFHEIV99,
  2696           DFHEIV99
  2697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2698
  2699     .
  2700 8500-DEEDIT.
  2701     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2702                                 TO WS-9V999-OF-DEEDIT
  2703     .
  2704 8500-EXIT.
  2705     EXIT.
  2706 8600-DEEDIT.
  2707     MOVE FUNCTION NUMVAL(DEEDIT-FIELD)
  2708                                 TO WS-NUMVAL-OF-DEEDIT
  2709     .
  2710 8600-EXIT.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  50
* EL1041.cbl
  2711     EXIT.
  2712 8800-UNAUTHORIZED-ACCESS.
  2713     MOVE UNACCESS-MSG               TO  LOGOFF-MSG.
  2714     GO TO 8300-SEND-TEXT.
  2715 8810-PF23.
  2716     MOVE EIBAID                     TO  PI-ENTRY-CD-1.
  2717     MOVE XCTL-005                   TO  PGM-NAME.
  2718     GO TO 9300-XCTL.
  2719 8850-DUPREC.
  2720     MOVE ER-0132                    TO  EMI-ERROR.
  2721     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2722     MOVE -1                         TO  MAINTL
  2723     MOVE AL-UABON                   TO  ZLETRA
  2724     GO TO 8100-SEND-INITIAL-MAP.
  2725 8870-NOTOPEN.
  2726     MOVE LOW-VALUES                 TO  EL104ZO.
  2727     MOVE -1                         TO  MAINTL.
  2728     MOVE ER-0701                    TO  EMI-ERROR.
  2729     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2730     GO TO 8100-SEND-INITIAL-MAP.
  2731 8880-NOT-FOUND.
  2732     MOVE ER-0702                    TO  EMI-ERROR.
  2733     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2734     MOVE -1                         TO  MAINTL
  2735     MOVE AL-UABON                   TO  ZLETRA
  2736     GO TO 8100-SEND-INITIAL-MAP.
  2737     .
  2738 9100-RETURN-TRAN.
  2739     MOVE EMI-ERROR-NUMBER (1)       TO  PI-LAST-ERROR-NO.
  2740
  2741* EXEC CICS RETURN
  2742*        TRANSID    (TRANS-ID)
  2743*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2744*        LENGTH     (PI-COMM-LENGTH)
  2745*    END-EXEC.
  2746*    MOVE '.(CT                  ''   #00002444' TO DFHEIV0
  2747     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2748     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2749     MOVE X'2020233030303032343434' TO DFHEIV0(25:11)
  2750     CALL 'kxdfhei1' USING DFHEIV0,
  2751           TRANS-ID,
  2752           PROGRAM-INTERFACE-BLOCK,
  2753           PI-COMM-LENGTH,
  2754           DFHEIV99,
  2755           DFHEIV99,
  2756           DFHEIV99
  2757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2758
  2759 9200-RETURN-MAIN-MENU.
  2760     MOVE XCTL-626                   TO  PGM-NAME.
  2761     GO TO 9300-XCTL.
  2762 9300-XCTL.
  2763
  2764* EXEC CICS XCTL
  2765*        PROGRAM    (PGM-NAME)
  2766*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2767*        LENGTH     (PI-COMM-LENGTH)
  2768*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  51
* EL1041.cbl
  2769*    MOVE '.$C                   %   #00002453' TO DFHEIV0
  2770     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2771     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2772     MOVE X'2020233030303032343533' TO DFHEIV0(25:11)
  2773     CALL 'kxdfhei1' USING DFHEIV0,
  2774           PGM-NAME,
  2775           PROGRAM-INTERFACE-BLOCK,
  2776           PI-COMM-LENGTH,
  2777           DFHEIV99
  2778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2779
  2780 9400-CLEAR.
  2781     MOVE PI-RETURN-TO-PROGRAM       TO  PGM-NAME.
  2782     GO TO 9300-XCTL.
  2783 9500-PF12.
  2784     MOVE XCTL-010                   TO  PGM-NAME.
  2785     GO TO 9300-XCTL.
  2786 9600-PGMID-ERROR.
  2787
  2788* EXEC CICS HANDLE CONDITION
  2789*        PGMIDERR   (8300-SEND-TEXT)
  2790*    END-EXEC.
  2791*    MOVE '"$L                   ! # #00002465' TO DFHEIV0
  2792     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2793     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2794     MOVE X'2320233030303032343635' TO DFHEIV0(25:11)
  2795     CALL 'kxdfhei1' USING DFHEIV0
  2796     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2797
  2798     MOVE PGM-NAME                   TO  PI-CALLING-PROGRAM.
  2799     MOVE ' '                        TO  PI-ENTRY-CD-1.
  2800     MOVE XCTL-005                   TO  PGM-NAME.
  2801     MOVE PGM-NAME                   TO  LOGOFF-PGM.
  2802     MOVE PGMIDERR-MSG               TO  LOGOFF-FILL.
  2803     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  52
* EL1041.cbl
  2805 9700-LINK-DATE-CONVERT.
  2806
  2807* EXEC CICS LINK
  2808*        PROGRAM    ('ELDATCV')
  2809*        COMMAREA   (DATE-CONVERSION-DATA)
  2810*        LENGTH     (DC-COMM-LENGTH)
  2811*    END-EXEC.
  2812     MOVE 'ELDATCV' TO DFHEIV1
  2813*    MOVE '."C                   (   #00002476' TO DFHEIV0
  2814     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2815     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2816     MOVE X'2020233030303032343736' TO DFHEIV0(25:11)
  2817     CALL 'kxdfhei1' USING DFHEIV0,
  2818           DFHEIV1,
  2819           DATE-CONVERSION-DATA,
  2820           DC-COMM-LENGTH,
  2821           DFHEIV99,
  2822           DFHEIV99,
  2823           DFHEIV99,
  2824           DFHEIV99
  2825     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2826
  2827 9700-EXIT.
  2828     EXIT.
  2829 9900-ERROR-FORMAT.
  2830     IF NOT EMI-ERRORS-COMPLETE
  2831         MOVE LINK-001               TO  PGM-NAME
  2832
  2833* EXEC CICS LINK
  2834*            PROGRAM    (PGM-NAME)
  2835*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2836*            LENGTH     (EMI-COMM-LENGTH)
  2837*        END-EXEC.
  2838*    MOVE '."C                   (   #00002486' TO DFHEIV0
  2839     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2840     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2841     MOVE X'2020233030303032343836' TO DFHEIV0(25:11)
  2842     CALL 'kxdfhei1' USING DFHEIV0,
  2843           PGM-NAME,
  2844           ERROR-MESSAGE-INTERFACE-BLOCK,
  2845           EMI-COMM-LENGTH,
  2846           DFHEIV99,
  2847           DFHEIV99,
  2848           DFHEIV99,
  2849           DFHEIV99
  2850     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2851
  2852 9900-EXIT.
  2853     EXIT.
  2854 9990-ABEND.
  2855     MOVE LINK-004                   TO  PGM-NAME.
  2856     MOVE DFHEIBLK                   TO  EMI-LINE1.
  2857
  2858* EXEC CICS LINK
  2859*        PROGRAM   (PGM-NAME)
  2860*        COMMAREA  (EMI-LINE1)
  2861*        LENGTH    (72)
  2862*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  53
* EL1041.cbl
  2863     MOVE 72
  2864       TO DFHEIV11
  2865*    MOVE '."C                   (   #00002496' TO DFHEIV0
  2866     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2867     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2868     MOVE X'2020233030303032343936' TO DFHEIV0(25:11)
  2869     CALL 'kxdfhei1' USING DFHEIV0,
  2870           PGM-NAME,
  2871           EMI-LINE1,
  2872           DFHEIV11,
  2873           DFHEIV99,
  2874           DFHEIV99,
  2875           DFHEIV99,
  2876           DFHEIV99
  2877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2878
  2879     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  54
* EL1041.cbl
  2881 9995-SECURITY-VIOLATION.
  2882*                            COPY ELCSCTP.
  2883******************************************************************
  2884*                                                                *
  2885*                            ELCSCTP                             *
  2886*                            VMOD=2.001                          *
  2887*                                                                *
  2888*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2889******************************************************************
  2890
  2891
  2892     MOVE EIBDATE          TO SM-JUL-DATE.
  2893     MOVE EIBTRMID         TO SM-TERMID.
  2894     MOVE THIS-PGM         TO SM-PGM.
  2895     MOVE EIBTIME          TO TIME-IN.
  2896     MOVE TIME-OUT         TO SM-TIME.
  2897     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2898
  2899
  2900* EXEC CICS LINK
  2901*         PROGRAM  ('EL003')
  2902*         COMMAREA (SECURITY-MESSAGE)
  2903*         LENGTH   (80)
  2904*    END-EXEC.
  2905     MOVE 'EL003' TO DFHEIV1
  2906     MOVE 80
  2907       TO DFHEIV11
  2908*    MOVE '."C                   (   #00002521' TO DFHEIV0
  2909     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2910     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2911     MOVE X'2020233030303032353231' TO DFHEIV0(25:11)
  2912     CALL 'kxdfhei1' USING DFHEIV0,
  2913           DFHEIV1,
  2914           SECURITY-MESSAGE,
  2915           DFHEIV11,
  2916           DFHEIV99,
  2917           DFHEIV99,
  2918           DFHEIV99,
  2919           DFHEIV99
  2920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2921
  2922
  2923******************************************************************
  2924
  2925 9995-EXIT.
  2926     EXIT.
  2927
  2928 9999-DFHBACK SECTION.
  2929     MOVE '9%                    "   ' TO DFHEIV0
  2930     MOVE 'EL1041' TO DFHEIV1
  2931     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2932     GOBACK.
  2933 9999-DFHEXIT.
  2934     IF DFHEIGDJ EQUAL 0001
  2935         NEXT SENTENCE
  2936     ELSE IF DFHEIGDJ EQUAL 2
  2937         GO TO 8850-DUPREC,
  2938               8870-NOTOPEN,
* Micro Focus Server Express         V5.1 revision 000 14-Jun-17 11:20 Page  55
* EL1041.cbl
  2939               8880-NOT-FOUND,
  2940               9600-PGMID-ERROR,
  2941               9990-ABEND
  2942         DEPENDING ON DFHEIGDI
  2943     ELSE IF DFHEIGDJ EQUAL 3
  2944         GO TO 8300-SEND-TEXT
  2945         DEPENDING ON DFHEIGDI.
  2946     MOVE '9%                    "   ' TO DFHEIV0
  2947     MOVE 'EL1041' TO DFHEIV1
  2948     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2949     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5476     Code:        8017
