* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page   1
* SOCK16.cbl
* Options: int("SOCK16.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK16.lst")
     1$SET SQL(dbman=ODBC, TARGETDB=MSSQLSERVER, NOAUTOCOMMIT)
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK16.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"SOCK16.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     2 IDENTIFICATION DIVISION.
     3 PROGRAM-ID. SOCK16.
     4 AUTHOR.     Paul.
     5 DATE-COMPILED. 28-Jul-21 10:46.
     6*SECURITY.   *****************************************************
     7*            *                                                   *
     8*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
     9*            *                                                   *
    10*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    11*            *   OF     CSO     IS EXPRESSLY PROHIBITED WITHOUT  *
    12*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page   2
* SOCK16.cbl
    14*            *****************************************************
    15******************************************************************
    16*REMARKS.                                                        *
    17*       Receives a call from the GA withholding app and          *
    18*   will update the ercomp table with the latest values based on *
    19*   the key(s) passed to this program.                           *
    20*                                                                *
    21******************************************************************
    22*                   C H A N G E   L O G
    23*
    24* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    25*-----------------------------------------------------------------
    26*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    27* EFFECTIVE    NUMBER
    28*-----------------------------------------------------------------
    29* 020119 CR2020060800001   PEMA  New Program
    30******************************************************************
    31 ENVIRONMENT DIVISION.
    32 DATA DIVISION.
    33 WORKING-STORAGE SECTION.
    34 01  DFH-START PIC X(04).
    35*
    36* program buffers
    37*
    38 77 ws-send-msg-size             pic s9(8) comp value 4096.
    39 77 ws-recv-msg-size             pic s9(8) comp value 4096.
    40 77 ws-recv-buf                  pic x(4096).
    41 77 ws-send-buf                  pic x(4096) VALUE SPACES.
    42 77 ws-recv-total                pic s9(8) comp value 0.
    43 77 ws-recv-left                 pic s9(8) comp value 0.
    44 77 ws-seq-num                   pic s9(8) comp value 0.
    45 77 ws-flags                     pic s9(8) comp value 0.
    46 77 WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    47 77  ws-comp-id                  pic xxx value spaces.
    48 77 WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    49 77 WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    50 77 WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    51 77 WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    52 77 WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    53 77 S1                           PIC S999 COMP-3 VALUE +0.
    54 77 S2                           PIC S999 COMP-3 VALUE +0.
    55 77 WS-BUILD-SW                  PIC X.
    56    88  TIME-TO-BUILD               VALUE 'Y'.
    57 77 WS-SAVE-ERACCT               PIC X(2000).
    58 77 WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    59 77 WS-PERFORM-SW                PIC X VALUE SPACES.
    60    88  GET-RATES                    VALUE 'R'.
    61    88  GET-ACT-ACCTS                VALUE 'A'.
    62 77  ws-bin-current-dt           pic xx value low-values.
    63 77 ws-bin-eff-dt                pic xx  value low-values.
    64 77 ws-bin-1st-pay-dt            pic xx  value low-values.
    65 77 WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    66 77 ws-disp-rate                 pic z9.99999.
    67 77  WS-ERACCT-SW                PIC X VALUE ' '.
    68     88  END-OF-ERACCT                 VALUE 'Y'.
    69 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    70     88  END-OF-ERCTBL                 VALUE 'Y'.
    71 77  WS-STATUS                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page   3
* SOCK16.cbl
    72 77  ws-connect-sw               pic x value ' '.
    73     88  connected-to-db           value 'Y'.
    74 77  ws-socket-sw                pic x value ' '.
    75     88  end-of-socket              value 'Y'.
    76 01  P pointer.
    77 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    78 01  var-ptr pointer.
    79 01  env-var-len                 pic 9(4)  binary.
    80 01  rc                          pic 9(9)  binary.
    81 01  WS-KIXSYS.
    82     05  WS-KIX-FIL1             PIC X(10).
    83     05  WS-KIX-APPS             PIC X(10).
    84     05  WS-KIX-ENV              PIC X(10).
    85     05  WS-KIX-MYENV            PIC X(10).
    86     05  WS-KIX-SYS              PIC X(10).
    87 01  ws-return-string.
    88     05  ws-return-error-no      pic x(4).
    89     05  ws-sc1                  pic x.
    90     05  ws-return-error-mess    pic x(45).
    91     05  ws-sc2                  pic x.
    92     05  ws-return-accts-read    pic zzzzzz9.
    93     05  ws-sc3                  pic x.
    94     05  ws-return-acnts-read    pic zzzzzz9.
    95     05  ws-sc4                  pic x.
    96     05  ws-return-acnts-updated pic zzzzzz9.
    97     05  ws-sc5                  pic x.
    98     05  ws-return-acnts-deletes pic zzzzzz9.
*   99 EXEC SQL
*  100    INCLUDE SQLDA
*  101 END-EXEC
   102 01 SQLDA sync.
   103    05 SQLDAID               PIC X(8)  VALUE "SQLDA  ".
   104    05 SQLDABC               PIC S9(9) COMP-5 value 0.
   105    05 SQLN                  PIC S9(4) COMP-5 value 0.
   106    05 SQLD                  PIC S9(4) COMP-5 value 0.
   107    05 SQLVAR OCCURS 0 TO 1489 TIMES DEPENDING ON SQLD.
   108       10 SQLTYPE            PIC S9(4) COMP-5.
   109       10 SQLLEN             PIC S9(4) COMP-5.
   110$IF P64 SET
   111X      *> For 64-bit environments, ensure that SQLDATA is
   112X      *> aligned on an 8-byte boundary.
   113X      10 FILLER             PIC S9(9) COMP-5.
   114$END
   115       10 SQLDATA            USAGE POINTER.
   116       10 SQLIND             USAGE POINTER.
   117       10 SQLNAME.
   118          15 SQLNAMEL        PIC S9(4) COMP-5.
   119          15 SQLNAMEC        PIC X(30).
   120
   121* Values for SQLTYPE
   122
   123 78  ESQL-DATE-CHAR              VALUE 384.
   124 78  ESQL-DATE-CHAR-NULL         VALUE 385.
   125 78  ESQL-DATE-REC               VALUE 386.
   126 78  ESQL-DATE-REC-NULL          VALUE 387.
   127 78  ESQL-TIME-CHAR              VALUE 388.
   128 78  ESQL-TIME-CHAR-NULL         VALUE 389.
   129 78  ESQL-TIME-REC               VALUE 390.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page   4
* SOCK16.cbl (/opt/lib/cobol/cpylib/sqlda.cpy)
   130 78  ESQL-TIME-REC-NULL          VALUE 391.
   131 78  ESQL-TIMESTAMP-CHAR         VALUE 392.
   132 78  ESQL-TIMESTAMP-CHAR-NULL    VALUE 393.
   133 78  ESQL-TIMESTAMP-REC          VALUE 394.
   134 78  ESQL-TIMESTAMP-REC-NULL     VALUE 395.
   135 78  ESQL-TS-OFFSET-CHAR         VALUE 396. *> added nx51sp1
   136 78  ESQL-TS-OFFSET-CHAR-NULL    VALUE 397.
   137 78  ESQL-TS-OFFSET-REC          VALUE 398.
   138 78  ESQL-TS-OFFSET-REC-NULL     VALUE 399. *> end adds nx51sp1
   139 78  ESQL-LONGVARBINARY          VALUE 404.
   140 78  ESQL-LONGVARBINARY-NULL     VALUE 405.
   141 78  ESQL-LONGVARCHAR            VALUE 408.
   142 78  ESQL-LONGVARCHAR-NULL       VALUE 409.
   143 78  ESQL-BINARY                 VALUE 444.
   144 78  ESQL-BINARY-NULL            VALUE 445.
   145 78  ESQL-VARBINARY              VALUE 446.
   146 78  ESQL-VARBINARY-NULL         VALUE 447.
   147 78  ESQL-VARCHAR                VALUE 448.
   148 78  ESQL-VARCHAR-NULL           VALUE 449.
   149
   150 78  ESQL-CHARVARYING            VALUE 450.  *> added esq03n31
   151 78  ESQL-CHARVARYING-NULL       VALUE 451.  *> added esq03n31
   152
   153 78  ESQL-CHAR                   VALUE 452.
   154 78  ESQL-CHAR-NULL              VALUE 453.
   155
   156 78  ESQL-CHAR-FIXED             VALUE 454.  *> added esq03n31
   157 78  ESQL-CHAR-FIXED-NULL        VALUE 455.  *> added esq03n31
   158
   159 78  ESQL-DOUBLE                 VALUE 480.
   160 78  ESQL-DOUBLE-NULL            VALUE 481.
   161 78  ESQL-REAL                   VALUE 482.
   162 78  ESQL-REAL-NULL              VALUE 483.
   163 78  ESQL-DECIMAL                VALUE 484.
   164 78  ESQL-DECIMAL-NULL           VALUE 485.
   165 78  ESQL-INTEGER                VALUE 496.
   166 78  ESQL-INTEGER-NULL           VALUE 497.
   167 78  ESQL-SMALLINT               VALUE 500.
   168 78  ESQL-SMALLINT-NULL          VALUE 501.
   169 78  ESQL-TINYINT                VALUE 502.
   170 78  ESQL-TINYINT-NULL           VALUE 503.
*  171 EXEC SQL
*  172    INCLUDE SQLCA
*  173 END-EXEC
   174 01 SQLCA.
   175     05  SQLCAID         PIC X(8)         VALUE "SQLCA   ".
   176     05  SQLCABC         PIC S9(9) COMP-5 VALUE 136.
   177     05  SQLCODE         PIC S9(9) COMP-5 VALUE 0.
   178     05  SQLERRM.
   179         49  SQLERRML    PIC S9(4) COMP-5.
   180         49  SQLERRMC    PIC X(70).
   181     05  SQLERRP         PIC X(8).
   182     05  SQLERRD         PIC S9(9) COMP-5 OCCURS 6 VALUE 0.
   183     05  SQLWARN.
   184         10  SQLWARN0    PIC X.
   185         10  SQLWARN1    PIC X.
   186         10  SQLWARN2    PIC X.
   187         10  SQLWARN3    PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page   5
* SOCK16.cbl (/opt/lib/cobol/cpylib/sqlca.cpy)
   188         10  SQLWARN4    PIC X.
   189         10  SQLWARN5    PIC X.
   190         10  SQLWARN6    PIC X.
   191         10  SQLWARN7    PIC X.
   192     05  SQLEXT.
   193         10  SQLWARN8    PIC X.
   194         10  SQLWARN9    PIC X.
   195         10  SQLWARN10   PIC X.
   196         10  SQLWARNA    REDEFINES SQLWARN10 PIC X .
   197     05  SQLSTATE    PIC X(5).
   198 EXEC SQL
   199    BEGIN DECLARE SECTION
   200 END-EXEC
   201 01  sqlcmd                      pic x(1024).
   202 01  svr                         pic x(32).
   203 01  usr                         pic x(32).
   204 01  pass                        pic x(32).
   205 01  usr-pass                    pic x(64).
   206 01  ws-disp-code                pic s9(11).
   207 01  ws-display-response         pic s9(9) value zeros.
   208 01  indicator-vaiables-for-nulls.
   209     05  nu-last-maint-dt        pic s9(4) comp value +0.
   210     05  nu-rolodex-print-dt     pic s9(4) comp value +0.
   211     05  nu-last-eom-stmt-dt     pic s9(4) comp value +0.
   212     05  nu-last-activity-date   pic s9(4) comp value +0.
   213     05  nu-last-stmt-dt         pic s9(4) comp value +0.
   214     05  nu-current-last-stmt-dt pic s9(4) comp value +0.
   215     05  nu-ga-effective-dt      pic s9(4) comp value +0.
   216     05  nu-ga-termination-dt    pic s9(4) comp value +0.
   217     05  nu-first-written-dt     pic s9(4) comp value +0.
   218 01  comp-record.
   219     12  cr-carrier                            pic x.
   220     12  cr-grouping                           pic x(6).
   221     12  cr-resp-no                            pic x(10).
   222     12  cr-account                            pic x(10).
   223     12  cr-type                               pic x.
   224     12  CR-LAST-MAINT-DT                      PIC x(10).
   225     12  CR-LAST-MAINT-HHMMSS                  PIC x(8).
   226     12  cr-last-maint-hhmmss-n redefines
   227         CR-LAST-MAINT-HHMMSS                  PIC -9(7).
   228     12  CR-LAST-MAINT-USER                    PIC X(4).
   229     12  CR-STMT-TYPE                          PIC XXX.
   230     12  CR-COMP-TYPE                          PIC X.
   231     12  CR-STMT-OWNER                         PIC X(4).
   232     12  CR-BALANCE-CONTROL                    PIC X.
   233     12  CR-INTERNAL-CONTROL-1                 PIC X.
   234     12  CR-INTERNAL-CONTROL-2                 PIC X.
   235     12  cr-ga-withold-pct                     pic x(7).
   236     12  CR-GA-WITHOLD-PCT-n redefines
   237         cr-ga-withold-pct                     PIC -9.9999.
   238     12  CR-GA-DIRECT-DEP                      PIC X.
   239     12  CR-ACCT-NAME                          PIC X(30).
   240     12  CR-MAIL-NAME                          PIC X(30).
   241     12  CR-ADDR-1                             PIC X(30).
   242     12  CR-ADDR-2                             PIC X(30).
   243     12  CR-ADDR-3                             pic x(29).
   244     12  CR-CSO-1099                           PIC X.
   245     12  CR-ZIP                                pic x(9).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page   6
* SOCK16.cbl
   246     12  CR-SOC-SEC                            PIC X(13).
   247     12  CR-TELEPHONE                          pic x(10).
   248     12  CR-ROLODEX-PRINT-DT                   PIC X(10).
   249     12  CR-AR-BAL-LEVEL                       PIC X.
   250     12  CR-AR-NORMAL-PRINT                    PIC X.
   251     12  CR-AR-SUMMARY-CODE                    PIC X(6).
   252     12  CR-AR-REPORTING                       PIC X.
   253     12  CR-AR-PULL-CHECK                      PIC X.
   254     12  CR-AR-BALANCE-PRINT                   PIC X.
   255     12  CR-AR-LAST-RUN-CODE                   PIC X.
   256     12  CR-LAST-EOM-STMT-DT                   PIC X(10).
   257     12  CR-USER-CODE                          PIC X.
   258     12  CR-REPORT-GROUP-ID                    PIC X(12).
   259     12  CR-LAST-ACTIVITY-DATE                 pic x(10).
   260     12  CR-LAST-STMT-DT                       pic x(10).
   261     12  CR-BAL-FWD                            PIC -9(7).99.
   262     12  CR-CUR-COM                            PIC -9(7).99.
   263     12  CR-CUR-CHG                            PIC -9(7).99.
   264     12  CR-CUR-PMT                            PIC -9(7).99.
   265     12  CR-END-BAL                            PIC -9(7).99.
   266     12  CR-CUR                                PIC -9(7).99.
   267     12  CR-OV30                               PIC -9(7).99.
   268     12  CR-OV60                               PIC -9(7).99.
   269     12  CR-OV90                               PIC -9(7).99.
   270     12  CR-YTD-COM                            PIC -9(7).99.
   271     12  CR-YTD-OV                             PIC -9(7).99.
   272     12  CR-CUR-OVR-UNDR                       PIC -9(7).99.
   273     12  CR-YTD-OVR-UNDR                       PIC -9(7).99.
   274     12  CR-CUR-FICA                           PIC -9(7).99.
   275     12  CR-YTD-FICA                           PIC -9(7).99.
   276     12  CR-LF-CLM-AMT                         PIC -9(9).99.
   277     12  CR-AH-CLM-AMT                         PIC -9(9).99.
   278     12  CR-CURRENT-LAST-STMT-DT               pic x(10).
   279     12  CR-CURRENT-BAL-FWD                    PIC -9(7).99.
   280     12  CR-CURRENT-CUR-COM                    PIC -9(7).99.
   281     12  CR-CURRENT-CUR-CHG                    PIC -9(7).99.
   282     12  CR-CURRENT-CUR-PMT                    PIC -9(7).99.
   283     12  CR-CURRENT-END-BAL                    PIC -9(7).99.
   284     12  CR-CURRENT-CUR                        PIC -9(7).99.
   285     12  CR-CURRENT-OV30                       PIC -9(7).99.
   286     12  CR-CURRENT-OV60                       PIC -9(7).99.
   287     12  CR-CURRENT-OV90                       PIC -9(7).99.
   288     12  CR-CURRENT-YTD-COM                    PIC -9(7).99.
   289     12  CR-CURRENT-YTD-OV                     PIC -9(7).99.
   290     12  CR-YTD-PAID-COM                       PIC -9(7).99.
   291     12  CR-YTD-PAID-OV                        PIC -9(7).99.
   292     12  CR-CURRENT-MONTH-ACTIVITY             PIC X.
   293     12  CR-DELINQUENT-LETTER-CODE             PIC X.
   294     12  CR-CSR-CODE                           PIC X(4).
   295     12  CR-GA-EFFECTIVE-DT                    PIC X(10).
   296     12  CR-GA-TERMINATION-DT                  PIC X(10).
   297     12  CR-GA-STATUS-CODE                     PIC X.
   298     12  CR-GA-COMMENT-1                       PIC X(40).
   299     12  CR-GA-COMMENT-2                       PIC X(40).
   300     12  CR-GA-COMMENT-3                       PIC X(40).
   301     12  CR-GA-COMMENT-4                       PIC X(40).
   302     12  CR-RPTCD2                             PIC X(10).
   303     12  CR-OV120                              PIC -9(7).99.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page   7
* SOCK16.cbl
   304     12  CR-CURRENT-OV120                      PIC -9(7).99.
   305     12  CR-TYPE-AGENT                         PIC X(01).
   306     12  CR-FAXNO                              pic x(10).
   307     12  CR-MD-GL-ACCT                         PIC X(10).
   308     12  CR-MD-DIV                             PIC XX.
   309     12  CR-MD-CENTER                          PIC X(4).
   310     12  cr-md-amt                             pic x(9).
   311     12  CR-MD-AMT-n redefines
   312         cr-md-amt                             PIC -9(5).99.
   313     12  CR-CREATE-AP-CHECK                    PIC X.
   314     12  CR-DELIVER-CK-TO-MEL                  PIC X.
   315     12  CR-ACH-STATUS                         PIC X.
   316     12  CR-BILL-SW                            PIC X.
   317     12  CR-CONTROL-NAME                       PIC X(30).
   318     12  CR-MAX-BANK-FEE-LEASE                 PIC -9(5).99.
   319     12  CR-MAX-BANK-FEE                       PIC -9(5).99.
   320     12  CR-CLP-STATE                          PIC XX.
   321     12  CR-FIRST-WRITTEN-DT                   PIC X(10).
   322     12  CR-SPP-REFUND-EDIT                    PIC X.
   323 EXEC SQL
   324    END DECLARE SECTION
   325 END-EXEC
   326 01  kt-sub                      pic s9(5) comp-3 value +0.
   327 01  kt-max                      pic s9(5) comp-3 value +0.
   328 01  WS-KEY-TABLE.
   329     05  key-table occurs 10.
   330         10  kt-carrier          pic x.
   331         10  kt-group            pic x(6).
   332         10  kt-fin-resp         pic x(10).
   333         10  kt-account          pic x(10).
   334         10  kt-type             pic x.
   335         10  kt-delim            pic x.
   336 01  ws-work-date.
   337     05  ws-work-ccyy            pic x(4).
   338     05  ws-work-mm              pic xx.
   339     05  ws-work-dd              pic xx.
   340 01  ws-work-date-num redefines ws-work-date
   341                                 pic 9(8).
   342 01  ws-work-time                pic 9(7).
   343 01  filler redefines ws-work-time.
   344     05  filler                  pic x.
   345     05  ws-hh                   pic 99.
   346     05  ws-mm                   pic 99.
   347     05  ws-ss                   pic 99.
   348 01  WS-FIN-RESP                 PIC X(10).
   349 01  WS-CO-DATA.
   350     05  WS-CO-NUM               PIC X(10).
   351     05  WS-CO-PRIMARY-CONTACT   PIC X(30).
   352     05  WS-CO-NAME              PIC X(30).
   353     05  WS-CO-MAIL-NAME         PIC X(30).
   354     05  WS-CO-ADDR1             PIC X(30).
   355     05  WS-CO-ADDR2             PIC X(30).
   356     05  WS-CO-ADDR3             PIC X(30).
   357     05  WS-CO-ZIP               PIC X(9).
   358     05  WS-CO-PHONE             PIC X(10).
   359 01  WS-CO-KEY.
   360     05  WS-CO-COMPANY-CD        PIC X.
   361     05  WS-CO-CARRIER           PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page   8
* SOCK16.cbl
   362     05  WS-CO-GROUP             PIC X(6).
   363     05  WS-CO-FIN-RESP          PIC X(10).
   364     05  WS-CO-ACCOUNT           PIC X(10).
   365     05  WS-CO-TYPE              PIC X.
   366 01  WS-CID-NO                   PIC X(8).
   367 01  WS-DISP-RESP                PIC 9(5).
   368 01  WS-RESPONSE                 PIC S9(8)   COMP.
   369     88  RESP-NORMAL                  VALUE +00.
   370     88  RESP-NOTFND                  VALUE +13.
   371     88  RESP-NOTOPEN                 VALUE +19.
   372     88  RESP-ENDFILE                 VALUE +20.
   373*                                 COPY ERCCOMP.
   374******************************************************************
   375*                                                                *
   376*                                                                *
   377*                            ERCCOMP                             *
   378*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   379*                            VMOD=2.019                          *
   380*                                                                *
   381*   ONLINE CREDIT SYSTEM                                         *
   382*                                                                *
   383*   FILE DESCRIPTION = COMPENSATION MASTER                       *
   384*                                                                *
   385*   FILE TYPE = VSAM,KSDS                                        *
   386*   RECORD SIZE = 700   RECFORM = FIXED                          *
   387*                                                                *
   388*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
   389*       ALTERNATE PATH = NONE                                    *
   390*                                                                *
   391*   LOG = NO                                                     *
   392*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   393*                                                                *
   394******************************************************************
   395*                   C H A N G E   L O G
   396*
   397* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   398*-----------------------------------------------------------------
   399*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   400* EFFECTIVE    NUMBER
   401*-----------------------------------------------------------------
   402* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   403* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
   404* 092205    2005050300006  PEMA  ADD LEASE FEE
   405* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
   406* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
   407* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
   408* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   409* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
   410* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
   411******************************************************************
   412
   413 01  COMPENSATION-MASTER.
   414     12  CO-RECORD-ID                          PIC XX.
   415         88  VALID-CO-ID                          VALUE 'CO'.
   416
   417     12  CO-CONTROL-PRIMARY.
   418         16  CO-COMPANY-CD                     PIC X.
   419         16  CO-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page   9
* SOCK16.cbl
   420             20  CO-CTL-1.
   421                 24  CO-CARR-GROUP.
   422                     28  CO-CARRIER            PIC X.
   423                     28  CO-GROUPING.
   424                         32  CO-GROUP-PREFIX   PIC XXX.
   425                         32  CO-GROUP-PRIME    PIC XXX.
   426                 24  CO-RESP-NO.
   427                     28  CO-RESP-PREFIX        PIC X(4).
   428                     28  CO-RESP-PRIME         PIC X(6).
   429             20  CO-CTL-2.
   430                 24  CO-ACCOUNT.
   431                     28  CO-ACCT-PREFIX        PIC X(4).
   432                     28  CO-ACCT-PRIME         PIC X(6).
   433         16  CO-TYPE                           PIC X.
   434             88  CO-COMPANY-TYPE                  VALUE 'C'.
   435             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
   436             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
   437
   438     12  CO-MAINT-INFORMATION.
   439         16  CO-LAST-MAINT-DT                  PIC XX.
   440         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
   441         16  CO-LAST-MAINT-USER                PIC X(4).
   442     12  FILLER                                PIC XX.
   443     12  CO-STMT-TYPE                          PIC XXX.
   444     12  CO-COMP-TYPE                          PIC X.
   445         88  CO-COMP-IS-SPPDD                    VALUE '1'.
   446     12  CO-STMT-OWNER                         PIC X(4).
   447     12  CO-BALANCE-CONTROL                    PIC X.
   448         88  CO-CARRY-BALANCE                     VALUE 'Y'.
   449         88  CO-NO-BALANCE                        VALUE 'N'.
   450
   451     12  CO-INTERNAL-CONTROL-1                 PIC X.
   452         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
   453         88  CO-AUTO-GENERATED                    VALUE 'Y'.
   454         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
   455
   456     12  CO-INTERNAL-CONTROL-2                 PIC X.
   457         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
   458         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
   459
   460     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
   461     12  CO-GA-DIRECT-DEP                      PIC X.
   462     12  CO-FUTURE-SPACE                       PIC X.
   463         88  CO-FUTURE-NOT-USED                   VALUE ' '.
   464
   465     12  CO-ACCT-NAME                          PIC X(30).
   466     12  CO-MAIL-NAME                          PIC X(30).
   467     12  CO-ADDR-1                             PIC X(30).
   468     12  CO-ADDR-2                             PIC X(30).
   469     12  CO-ADDR-3.
   470         16  CO-ADDR-CITY                      PIC X(27).
   471         16  CO-ADDR-STATE                     PIC XX.
   472     12  CO-CSO-1099                           PIC X.
   473     12  CO-ZIP.
   474         16  CO-ZIP-PRIME.
   475             20  CO-ZIP-PRI-1ST                PIC X.
   476                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
   477             20  FILLER                        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  10
* SOCK16.cbl
   478         16  CO-ZIP-PLUS4                      PIC X(4).
   479     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
   480         16  CO-CAN-POSTAL-1                   PIC XXX.
   481         16  CO-CAN-POSTAL-2                   PIC XXX.
   482         16  FILLER                            PIC XXX.
   483     12  CO-SOC-SEC                            PIC X(13).
   484     12  CO-TELEPHONE.
   485         16  CO-AREA-CODE                      PIC XXX.
   486         16  CO-PREFIX                         PIC XXX.
   487         16  CO-PHONE                          PIC X(4).
   488
   489     12  CO-ROLADEX-PRINT-DT                   PIC XX.
   490
   491     12  CO-AR-BAL-LEVEL                       PIC X.
   492         88  CO-AR-REF-LVL                        VALUE '1'.
   493         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
   494         88  CO-AR-BILL-LVL                       VALUE '2'.
   495         88  CO-AR-AGT-LVL                        VALUE '3'.
   496         88  CO-AR-FR-LVL                         VALUE '4'.
   497
   498     12  CO-AR-NORMAL-PRINT                    PIC X.
   499         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
   500         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
   501
   502     12  CO-AR-SUMMARY-CODE                    PIC X(6).
   503
   504     12  CO-AR-REPORTING                       PIC X.
   505         88  CO-AR-NET-REPORT                     VALUE 'N'.
   506         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
   507
   508     12  CO-AR-PULL-CHECK                      PIC X.
   509         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
   510         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
   511
   512     12  CO-AR-BALANCE-PRINT                   PIC X.
   513         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
   514
   515     12  CO-AR-LAST-RUN-CODE                   PIC X.
   516         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
   517         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
   518         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
   519
   520     12  CO-LAST-EOM-STMT-DT                   PIC XX.
   521
   522     12  CO-USER-CODE                          PIC X.
   523     12  CO-REPORT-GROUP-ID                    PIC X(12).
   524
   525******************************************************************
   526*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
   527*    THE LAST MONTH END RUN.
   528******************************************************************
   529
   530     12  CO-LAST-ACTIVITY-DATE.
   531         16  CO-ACT-YEAR                       PIC 99.
   532         16  CO-ACT-MONTH                      PIC 99.
   533         16  CO-ACT-DAY                        PIC 99.
   534
   535     12  CO-LAST-STMT-DT.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  11
* SOCK16.cbl
   536         16  CO-LAST-STMT-YEAR                 PIC 99.
   537         16  CO-LAST-STMT-MONTH                PIC 99.
   538         16  CO-LAST-STMT-DAY                  PIC 99.
   539
   540     12  CO-MO-END-TOTALS.
   541         16  CO-MONTHLY-TOTALS.
   542             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
   543             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
   544             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
   545             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
   546             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
   547
   548         16  CO-AGING-TOTALS.
   549             20  CO-CUR                    PIC S9(7)V99   COMP-3.
   550             20  CO-OV30                   PIC S9(7)V99   COMP-3.
   551             20  CO-OV60                   PIC S9(7)V99   COMP-3.
   552             20  CO-OV90                   PIC S9(7)V99   COMP-3.
   553
   554         16  CO-YTD-TOTALS.
   555             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
   556             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
   557
   558         16  CO-OVER-UNDER-TOTALS.
   559             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
   560             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
   561
   562     12  CO-MISCELLANEOUS-TOTALS.
   563         16  CO-FICA-TOTALS.
   564             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
   565             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
   566
   567         16  CO-CLAIM-TOTALS.
   568             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
   569             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
   570
   571******************************************************************
   572*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
   573*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
   574******************************************************************
   575
   576     12  CO-CURRENT-TOTALS.
   577         16  CO-CURRENT-LAST-STMT-DT.
   578             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
   579             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
   580             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
   581
   582         16  CO-CURRENT-MONTHLY-TOTALS.
   583             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
   584             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
   585             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
   586             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
   587             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
   588
   589         16  CO-CURRENT-AGING-TOTALS.
   590             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
   591             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
   592             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
   593             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  12
* SOCK16.cbl
   594
   595         16  CO-CURRENT-YTD-TOTALS.
   596             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
   597             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
   598
   599     12  CO-PAID-COMM-TOTALS.
   600         16  CO-YTD-PAID-COMMS.
   601             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
   602             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
   603
   604     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
   605         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
   606         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
   607
   608     12  CO-DELINQUENT-LETTER-CODE         PIC X.
   609         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
   610         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
   611         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
   612         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
   613         88  CO-OVERWRITE-LETTER              VALUE 'O'.
   614         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
   615         88  CO-FINAL-LETTER                  VALUE 'F'.
   616         88  CO-RECONCILING                   VALUE 'R'.
   617         88  CO-PHONE-CALL                    VALUE 'P'.
   618         88  CO-LEGAL                         VALUE 'L'.
   619         88  CO-COLLECTION-AGENCY             VALUE 'C'.
   620         88  CO-WRITE-OFF                     VALUE 'W'.
   621         88  CO-NO-ACTION                     VALUE 'N' ' '.
   622
   623     12  CO-CSR-CODE                       PIC X(4).
   624
   625     12  CO-GA-STATUS-INFO.
   626         16  CO-GA-EFFECTIVE-DT            PIC XX.
   627         16  CO-GA-TERMINATION-DT          PIC XX.
   628         16  CO-GA-STATUS-CODE             PIC X.
   629             88  CO-GA-ACTIVE                 VALUE 'A'.
   630             88  CO-GA-INACTIVE               VALUE 'I'.
   631             88  CO-GA-PENDING                VALUE 'P'.
   632         16  CO-GA-COMMENTS.
   633             20  CO-GA-COMMENT-1           PIC X(40).
   634             20  CO-GA-COMMENT-2           PIC X(40).
   635             20  CO-GA-COMMENT-3           PIC X(40).
   636             20  CO-GA-COMMENT-4           PIC X(40).
   637
   638     12  CO-RPTCD2                         PIC X(10).
   639     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
   640         16  CO-OV120                      PIC S9(7)V99   COMP-3.
   641         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
   642
   643     12  CO-TYPE-AGENT                     PIC X(01).
   644         88  CO-CORPORATION                   VALUE 'C'.
   645         88  CO-PARTNERSHIP                   VALUE 'P'.
   646         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
   647         88  CO-TRUST                         VALUE 'T'.
   648         88  CO-UNKNOWN                       VALUE ' ' 'X'.
   649
   650     12  CO-FAXNO.
   651         16  CO-FAX-AREA-CODE                  PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  13
* SOCK16.cbl
   652         16  CO-FAX-PREFIX                     PIC XXX.
   653         16  CO-FAX-PHONE                      PIC X(4).
   654
   655     12  CO-BANK-INFORMATION.
   656         16  CO-BANK-TRANSIT-NO                PIC X(8).
   657         16  CO-BANK-TRANSIT-NON REDEFINES
   658             CO-BANK-TRANSIT-NO                PIC 9(8).
   659
   660         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
   661     12  CO-MISC-DEDUCT-INFO REDEFINES
   662                  CO-BANK-INFORMATION.
   663         16  CO-MD-GL-ACCT                     PIC X(10).
   664         16  CO-MD-DIV                         PIC XX.
   665         16  CO-MD-CENTER                      PIC X(4).
   666         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
   667         16  CO-CREATE-AP-CHECK                PIC X.
   668         16  CO-DELIVER-CK-TO-MEL              PIC X.
   669         16  FILLER                            PIC XXX.
   670     12  CO-ACH-STATUS                         PIC X.
   671         88  CO-ACH-ACTIVE                         VALUE 'A'.
   672         88  CO-ACH-PENDING                        VALUE 'P'.
   673
   674     12  CO-BILL-SW                            PIC X.
   675     12  CO-CONTROL-NAME                       PIC X(30).
   676     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
   677     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
   678     12  CO-CLP-STATE                          PIC XX.
   679     12  CO-FIRST-WRITTEN-DT                   PIC XX.
   680     12  CO-SPP-REFUND-EDIT                    PIC X.
   681
   682******************************************************************
   683*                                 COPY ELCFUNDT.
   684*****************************************************************
   685*                                                               *
   686*                            ELCFUNDT.                          *
   687*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE *
   688*                            VMOD=2.001                         *
   689*                                                               *
   690*           COPYBOOK FOR THE FUNCTION DATE FORMAT               *
   691*                                                               *
   692*****************************************************************
   693
   694
   695 01  FUNCTION-DATE.
   696     05  WS-FN-DATE                PIC 9(8)    VALUE ZEROS.
   697     05  WS-FN-CYMD  REDEFINES  WS-FN-DATE.
   698         10  WS-FN-CCYR            PIC 9(4).
   699         10  WS-FN-CCYY  REDEFINES  WS-FN-CCYR.
   700             15  WS-FN-CC          PIC 99.
   701             15  WS-FN-YR          PIC 99.
   702         10  WS-FN-MO              PIC 99.
   703         10  WS-FN-DA              PIC 99.
   704     05  WS-FN-HOURS               PIC 99      VALUE ZEROS.
   705     05  WS-FN-MINUTES             PIC 99      VALUE ZEROS.
   706     05  WS-FN-SECONDS             PIC 99      VALUE ZEROS.
   707     05  WS-FN-HUNDSECS            PIC 99      VALUE ZEROS.
   708     05  WS-FN-GMT-IND             PIC X       VALUE SPACES.
   709         88  WS-BEHIND-GMT                     VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  14
* SOCK16.cbl
   710         88  WS-AFTER-GMT                      VALUE '+'.
   711         88  WS-NO-GMT                         VALUE ZERO.
   712     05  WS-FN-GMT-HOURS           PIC 99      VALUE ZEROS.
   713     05  WS-FN-GMT-MINUTES         PIC 99      VALUE ZEROS.
   714*                                 COPY ELCDATE.
   715******************************************************************
   716*                                                                *
   717*                                                                *
   718*                            ELCDATE.                            *
   719*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   720*                            VMOD=2.003
   721*                                                                *
   722*                                                                *
   723*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   724*                 LENGTH = 200                                   *
   725******************************************************************
   726
   727 01  DATE-CONVERSION-DATA.
   728     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   729     12  DC-OPTION-CODE                PIC X.
   730         88  BIN-TO-GREG                VALUE ' '.
   731         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   732         88  EDIT-GREG-TO-BIN           VALUE '2'.
   733         88  YMD-GREG-TO-BIN            VALUE '3'.
   734         88  MDY-GREG-TO-BIN            VALUE '4'.
   735         88  JULIAN-TO-BIN              VALUE '5'.
   736         88  BIN-PLUS-ELAPSED           VALUE '6'.
   737         88  FIND-CENTURY               VALUE '7'.
   738         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   739         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   740         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   741         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   742         88  JULIAN-TO-BIN-3            VALUE 'C'.
   743         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   744         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   745         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   746         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   747         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   748         88  CHECK-LEAP-YEAR            VALUE 'H'.
   749         88  BIN-3-TO-GREG              VALUE 'I'.
   750         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   751         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   752         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   753         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   754         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   755         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   756         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   757         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   758         88  THREE-CHARACTER-BIN
   759                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   760         88  GREGORIAN-TO-BIN
   761                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   762         88  BIN-TO-GREGORIAN
   763                  VALUES ' ' '1' 'I' '8' 'G'.
   764         88  JULIAN-TO-BINARY
   765                  VALUES '5' 'C' 'E' 'F'.
   766     12  DC-ERROR-CODE                 PIC X.
   767         88  NO-CONVERSION-ERROR        VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  15
* SOCK16.cbl
   768         88  DATE-CONVERSION-ERROR
   769                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   770         88  DATE-IS-ZERO               VALUE '1'.
   771         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   772         88  DATE-IS-INVALID            VALUE '3'.
   773         88  DATE1-GREATER-DATE2        VALUE '4'.
   774         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   775         88  DATE-INVALID-OPTION        VALUE '9'.
   776         88  INVALID-CENTURY            VALUE 'A'.
   777         88  ONLY-CENTURY               VALUE 'B'.
   778         88  ONLY-LEAP-YEAR             VALUE 'C'.
   779         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   780     12  DC-END-OF-MONTH               PIC X.
   781         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   782     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   783         88  USE-NORMAL-PROCESS         VALUE ' '.
   784         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   785         88  ADJUST-UP-100-YRS          VALUE '2'.
   786     12  FILLER                        PIC X.
   787     12  DC-CONVERSION-DATES.
   788         16  DC-BIN-DATE-1             PIC XX.
   789         16  DC-BIN-DATE-2             PIC XX.
   790         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   791         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   792                       DC-GREG-DATE-1-EDIT.
   793             20  DC-EDIT1-MONTH        PIC 99.
   794             20  SLASH1-1              PIC X.
   795             20  DC-EDIT1-DAY          PIC 99.
   796             20  SLASH1-2              PIC X.
   797             20  DC-EDIT1-YEAR         PIC 99.
   798         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   799         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   800                     DC-GREG-DATE-2-EDIT.
   801             20  DC-EDIT2-MONTH        PIC 99.
   802             20  SLASH2-1              PIC X.
   803             20  DC-EDIT2-DAY          PIC 99.
   804             20  SLASH2-2              PIC X.
   805             20  DC-EDIT2-YEAR         PIC 99.
   806         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   807         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   808                     DC-GREG-DATE-1-YMD.
   809             20  DC-YMD-YEAR           PIC 99.
   810             20  DC-YMD-MONTH          PIC 99.
   811             20  DC-YMD-DAY            PIC 99.
   812         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   813         16  DC-GREG-DATE-1-MDY-R REDEFINES
   814                      DC-GREG-DATE-1-MDY.
   815             20  DC-MDY-MONTH          PIC 99.
   816             20  DC-MDY-DAY            PIC 99.
   817             20  DC-MDY-YEAR           PIC 99.
   818         16  DC-GREG-DATE-1-ALPHA.
   819             20  DC-ALPHA-MONTH        PIC X(10).
   820             20  DC-ALPHA-DAY          PIC 99.
   821             20  FILLER                PIC XX.
   822             20  DC-ALPHA-CENTURY.
   823                 24 DC-ALPHA-CEN-N     PIC 99.
   824             20  DC-ALPHA-YEAR         PIC 99.
   825         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  16
* SOCK16.cbl
   826         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   827         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   828         16  DC-JULIAN-DATE            PIC 9(05).
   829         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   830                                       PIC 9(05).
   831         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   832             20  DC-JULIAN-YEAR        PIC 99.
   833             20  DC-JULIAN-DAYS        PIC 999.
   834         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   835         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   836         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   837     12  DATE-CONVERSION-VARIBLES.
   838         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   839         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   840             20  FILLER                PIC 9(3).
   841             20  HOLD-CEN-1-CCYY.
   842                 24  HOLD-CEN-1-CC     PIC 99.
   843                 24  HOLD-CEN-1-YY     PIC 99.
   844             20  HOLD-CEN-1-MO         PIC 99.
   845             20  HOLD-CEN-1-DA         PIC 99.
   846         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   847             20  HOLD-CEN-1-R-MO       PIC 99.
   848             20  HOLD-CEN-1-R-DA       PIC 99.
   849             20  HOLD-CEN-1-R-CCYY.
   850                 24  HOLD-CEN-1-R-CC   PIC 99.
   851                 24  HOLD-CEN-1-R-YY   PIC 99.
   852             20  FILLER                PIC 9(3).
   853         16  HOLD-CENTURY-1-X.
   854             20  FILLER                PIC X(3)  VALUE SPACES.
   855             20  HOLD-CEN-1-X-CCYY.
   856                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   857                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   858             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   859             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   860         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   861             20  HOLD-CEN-1-R-X-MO     PIC XX.
   862             20  HOLD-CEN-1-R-X-DA     PIC XX.
   863             20  HOLD-CEN-1-R-X-CCYY.
   864                 24  HOLD-CEN-1-R-X-CC PIC XX.
   865                 24  HOLD-CEN-1-R-X-YY PIC XX.
   866             20  FILLER                PIC XXX.
   867         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   868         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   869         16  DC-JULIAN-DATE-1          PIC 9(07).
   870         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   871             20  DC-JULIAN-1-CCYY.
   872                 24  DC-JULIAN-1-CC    PIC 99.
   873                 24  DC-JULIAN-1-YR    PIC 99.
   874             20  DC-JULIAN-DA-1        PIC 999.
   875         16  DC-JULIAN-DATE-2          PIC 9(07).
   876         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   877             20  DC-JULIAN-2-CCYY.
   878                 24  DC-JULIAN-2-CC    PIC 99.
   879                 24  DC-JULIAN-2-YR    PIC 99.
   880             20  DC-JULIAN-DA-2        PIC 999.
   881         16  DC-GREG-DATE-A-EDIT.
   882             20  DC-EDITA-MONTH        PIC 99.
   883             20  SLASHA-1              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  17
* SOCK16.cbl
   884             20  DC-EDITA-DAY          PIC 99.
   885             20  SLASHA-2              PIC X VALUE '/'.
   886             20  DC-EDITA-CCYY.
   887                 24  DC-EDITA-CENT     PIC 99.
   888                 24  DC-EDITA-YEAR     PIC 99.
   889         16  DC-GREG-DATE-B-EDIT.
   890             20  DC-EDITB-MONTH        PIC 99.
   891             20  SLASHB-1              PIC X VALUE '/'.
   892             20  DC-EDITB-DAY          PIC 99.
   893             20  SLASHB-2              PIC X VALUE '/'.
   894             20  DC-EDITB-CCYY.
   895                 24  DC-EDITB-CENT     PIC 99.
   896                 24  DC-EDITB-YEAR     PIC 99.
   897         16  DC-GREG-DATE-CYMD         PIC 9(08).
   898         16  DC-GREG-DATE-CYMD-R REDEFINES
   899                              DC-GREG-DATE-CYMD.
   900             20  DC-CYMD-CEN           PIC 99.
   901             20  DC-CYMD-YEAR          PIC 99.
   902             20  DC-CYMD-MONTH         PIC 99.
   903             20  DC-CYMD-DAY           PIC 99.
   904         16  DC-GREG-DATE-MDCY         PIC 9(08).
   905         16  DC-GREG-DATE-MDCY-R REDEFINES
   906                              DC-GREG-DATE-MDCY.
   907             20  DC-MDCY-MONTH         PIC 99.
   908             20  DC-MDCY-DAY           PIC 99.
   909             20  DC-MDCY-CEN           PIC 99.
   910             20  DC-MDCY-YEAR          PIC 99.
   911    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   912        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   913    12  DC-EL310-DATE                  PIC X(21).
   914    12  FILLER                         PIC X(28).
   915****************************************************************
   916*
   917* Copyright (c) 2007-2013 Dell Inc.
   918* All rights reserved.
   919*
   920****************************************************************
   921 01  DFHEIV.
   922   02  DFHEIV0               PIC X(35).
   923   02  DFHEIV1               PIC X(08).
   924   02  DFHEIV2               PIC X(08).
   925   02  DFHEIV3               PIC X(08).
   926   02  DFHEIV4               PIC X(06).
   927   02  DFHEIV5               PIC X(04).
   928   02  DFHEIV6               PIC X(04).
   929   02  DFHEIV7               PIC X(02).
   930   02  DFHEIV8               PIC X(02).
   931   02  DFHEIV9               PIC X(01).
   932   02  DFHEIV10              PIC S9(7) COMP-3.
   933   02  DFHEIV11              PIC S9(4) COMP SYNC.
   934   02  DFHEIV12              PIC S9(4) COMP SYNC.
   935   02  DFHEIV13              PIC S9(4) COMP SYNC.
   936   02  DFHEIV14              PIC S9(4) COMP SYNC.
   937   02  DFHEIV15              PIC S9(4) COMP SYNC.
   938   02  DFHEIV16              PIC S9(9) COMP SYNC.
   939   02  DFHEIV17              PIC X(04).
   940   02  DFHEIV18              PIC X(04).
   941   02  DFHEIV19              PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  18
* SOCK16.cbl
   942   02  DFHEIV20              USAGE IS POINTER.
   943   02  DFHEIV21              USAGE IS POINTER.
   944   02  DFHEIV22              USAGE IS POINTER.
   945   02  DFHEIV23              USAGE IS POINTER.
   946   02  DFHEIV24              USAGE IS POINTER.
   947   02  DFHEIV25              PIC S9(9) COMP SYNC.
   948   02  DFHEIV26              PIC S9(9) COMP SYNC.
   949   02  DFHEIV27              PIC S9(9) COMP SYNC.
   950   02  DFHEIV28              PIC S9(9) COMP SYNC.
   951   02  DFHEIV29              PIC S9(9) COMP SYNC.
   952   02  DFHEIV30              PIC S9(9) COMP SYNC.
   953   02  DFHEIV31              PIC S9(9) COMP SYNC.
   954   02  DFHEIV32              PIC S9(4) COMP SYNC.
   955   02  DFHEIV33              PIC S9(4) COMP SYNC.
   956   02  DFHEIV34              PIC S9(4) COMP SYNC.
   957   02  DFHEIV35              PIC S9(4) COMP SYNC.
   958   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   959   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   960   02  FILLER                PIC X(02).
   961   02  DFHEIV99              PIC X(08) VALUE SPACE.
   962   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   963   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   964   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   965   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   966   02  DFHEIVL4              PIC X(255) VALUE SPACE.
   967   02  DFHEIVL5              PIC X(255) VALUE SPACE.
   968 LINKAGE  SECTION.
   969*****************************************************************
   970*                                                               *
   971* Copyright (c) 2007-2013 Dell Inc.                             *
   972* All rights reserved.                                          *
   973*                                                               *
   974*****************************************************************
   975 01  dfheiblk.
   976     02  eibtime          pic s9(7) comp-3.
   977     02  eibdate          pic s9(7) comp-3.
   978     02  eibtrnid         pic x(4).
   979     02  eibtaskn         pic s9(7) comp-3.
   980     02  eibtrmid         pic x(4).
   981     02  dfheigdi         pic s9(4) comp.
   982     02  eibcposn         pic s9(4) comp.
   983     02  eibcalen         pic s9(4) comp.
   984     02  eibaid           pic x(1).
   985     02  eibfiller1       pic x(1).
   986     02  eibfn            pic x(2).
   987     02  eibfiller2       pic x(2).
   988     02  eibrcode         pic x(6).
   989     02  eibfiller3       pic x(2).
   990     02  eibds            pic x(8).
   991     02  eibreqid         pic x(8).
   992     02  eibrsrce         pic x(8).
   993     02  eibsync          pic x(1).
   994     02  eibfree          pic x(1).
   995     02  eibrecv          pic x(1).
   996     02  eibsend          pic x(1).
   997     02  eibatt           pic x(1).
   998     02  eibeoc           pic x(1).
   999     02  eibfmh           pic x(1).
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  19
* SOCK16.cbl
  1000     02  eibcompl         pic x(1).
  1001     02  eibsig           pic x(1).
  1002     02  eibconf          pic x(1).
  1003     02  eiberr           pic x(1).
  1004     02  eibrldbk         pic x(1).
  1005     02  eiberrcd         pic x(4).
  1006     02  eibsynrb         pic x(1).
  1007     02  eibnodat         pic x(1).
  1008     02  eibfiller5       pic x(2).
  1009     02  eibresp          pic s9(8) comp.
  1010     02  eibresp2         pic s9(8) comp.
  1011     02  dfheigdj         pic s9(4) comp.
  1012     02  dfheigdk         pic s9(4) comp.
  1013 01  DFHCOMMAREA.
  1014   05 GIVE-TAKE-SOCKET         PIC 9(8) COMP.
  1015   05 LSTN-NAME                PIC X(8).
  1016   05 LSTN-SUBNAME             PIC X(8).
  1017   05 CLIENT-IN-DATA.
  1018      15  CLIENT-KICK-OFF      PIC X(8).
  1019      15  CLIENT-ID            PIC XXX.
  1020      15  client-cntr          pic 999.
  1021      15  FILLER               PIC X(22).
  1022   05 SOCKADDR-IN-PARM.
  1023     15 SIN-FAMILY             PIC 9(4) COMP.
  1024     15 SIN-PORT               PIC 9(4) COMP.
  1025     15 SIN-ADDRESS            PIC 9(8) COMP.
  1026     15 SIN-ZERO               PIC X(8).
  1027 01  var  pic x(30).
  1028 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
  1029 0000-DFHEXIT SECTION.
  1030     MOVE '9#                    $   ' TO DFHEIV0.
  1031     MOVE 'SOCK16' TO DFHEIV1.
  1032     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1033     display 'SOCK16:transaction data = ', CLIENT-IN-DATA.
  1034     display 'SOCK16:socket number    =', GIVE-TAKE-SOCKET.
  1035     display ' client kick off **'client-kick-off '**'
  1036     display ' client in data **' client-in-data '**'
  1037     perform 0000-init           thru 0000-exit
  1038     perform 0010-init-contact   thru 0010-exit
  1039     perform 0100-process-socket thru 0100-exit until
  1040        end-of-socket
  1041     display ' after 0100 '
  1042     move '0000;Success '        to ws-return-string
  1043     PERFORM 0200-SEND-BUFFER    thru 0200-exit
  1044     go to 0300-close-socket
  1045     .
  1046 0000-init.
  1047     display ' made it to 0000-init '
  1048     MOVE FUNCTION CURRENT-DATE  TO FUNCTION-DATE
  1049     move ws-fn-cymd             to dc-greg-date-cymd
  1050     move 'L'                    to dc-option-code
  1051     perform 9700-date-link      thru 9700-exit
  1052     if no-conversion-error
  1053        move dc-bin-date-1       to ws-bin-current-dt
  1054     else
  1055        display ' error current dt invalid ' dc-error-code
  1056     end-if
  1057     set P to address of KIXSYS
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  20
* SOCK16.cbl
  1058     CALL "getenv" using by value P returning var-ptr
  1059     if var-ptr = null then
  1060        display ' kixsys not set '
  1061     else
  1062        set address of var to var-ptr
  1063        move 0 to env-var-len
  1064        inspect var tallying env-var-len
  1065          for characters before X'00'
  1066        unstring var (1:env-var-len) delimited by '/'
  1067           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  1068              WS-KIX-SYS
  1069        end-unstring
  1070     end-if
  1071     display ' client kick off **'client-kick-off '**'
  1072     .
  1073 0000-exit.
  1074     exit.
  1075 0010-init-contact.
  1076     display ' made it to 0010-init '
  1077     display ' client kick off **'client-kick-off '**'
  1078     if client-kick-off = 'SOCKET16'
  1079        continue
  1080     else
  1081        move '9999;Unknown origin, who are you? '
  1082                                 to ws-return-string
  1083        PERFORM 0200-SEND-BUFFER thru 0200-exit
  1084        display ' Unknown origin ' client-in-data
  1085        go to 0300-close-socket
  1086     end-if
  1087     evaluate client-id
  1088        when 'VPP'
  1089           MOVE X'07'            TO WS-COMP-CD
  1090           MOVE 'VPP'            TO WS-COMP-ID
  1091        when 'AHL'
  1092           MOVE X'06'            TO WS-COMP-CD
  1093           MOVE 'AHL'            TO WS-COMP-ID
  1094        when 'DCC'
  1095           MOVE X'05'            TO WS-COMP-CD
  1096           MOVE 'DCC'            TO WS-COMP-ID
  1097        when 'CID'
  1098           MOVE X'04'            TO WS-COMP-CD
  1099           MOVE 'CID'            TO WS-COMP-ID
  1100        when other
  1101           move '0113;Invalid company id ' to ws-return-string
  1102           PERFORM 0200-SEND-BUFFER thru 0200-exit
  1103           display ' Invalid company id ' client-id
  1104           go to 0300-close-socket
  1105     END-evaluate
  1106     if client-cntr numeric
  1107        move client-cntr         to kt-max
  1108     else
  1109        move '0117;Invalid Counter ' to ws-return-string
  1110        PERFORM 0200-SEND-BUFFER thru 0200-exit
  1111        display ' Invalid Counter  ' client-cntr
  1112        go to 0300-close-socket
  1113     end-if
  1114     move 'SOCKET16READY'        to ws-send-buf
  1115     move +25                    to ws-send-msg-size
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  21
* SOCK16.cbl
  1116     call "send" using by value GIVE-TAKE-SOCKET,
  1117         by reference ws-send-buf,
  1118         by value ws-send-msg-size,
  1119         by value ws-flags
  1120     if return-code <= zero
  1121        display 'SOCK16:send error ' return-code
  1122        perform 0250-socket-error thru 0250-exit
  1123        go to 0300-close-socket
  1124     end-if
  1125     .
  1126 0010-exit.
  1127     exit.
  1128 0100-process-socket.
  1129     display ' made it to 0100-process '
  1130     if kt-sub = +0
  1131        perform 0110-receive     thru 0110-exit
  1132     end-if
  1133     compute kt-sub = kt-sub + +1
  1134     if kt-sub > kt-max
  1135        set end-of-socket to true
  1136     end-if
  1137     if end-of-socket
  1138        go to 0100-exit
  1139     end-if
  1140     move ws-comp-cd             to ws-co-key
  1141     move key-table(kt-sub)(1:28) to ws-co-key (2:28)
  1142     perform 0400-get-ercomp     thru 0400-exit
  1143     .
  1144 0100-exit.
  1145     exit.
  1146 0110-receive.
  1147     display ' made it to 0110-receive '
  1148     move spaces                 to ws-recv-buf
  1149     call "recv" using by value GIVE-TAKE-SOCKET
  1150         by reference ws-recv-buf
  1151         by value ws-recv-msg-size
  1152         by value ws-flags.
  1153     display ' ret code ' return-code
  1154     if return-code < zero
  1155        display 'SOCK16:recv error ' return-code
  1156        perform 0250-socket-error thru 0250-exit
  1157        set end-of-socket to true
  1158        go to 0110-exit
  1159     end-if
  1160     if return-code = zero
  1161        display 'SOCK16:client disconnected',
  1162        perform 0250-socket-error thru 0250-exit
  1163        set end-of-socket to true
  1164        go to 0110-exit
  1165     end-if
  1166     display ' recv buf ' ws-recv-buf (1:50)
  1167     move ws-recv-buf (1:290)     to ws-key-table
  1168     if ws-recv-buf (1:4) = 'DONE' or 'done' or 'Done'
  1169        set end-of-socket to true
  1170     end-if
  1171     .
  1172 0110-exit.
  1173     exit.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  22
* SOCK16.cbl
  1174 0200-send-buffer.
  1175     move ws-return-string       to ws-send-buf
  1176     call "send" using by value GIVE-TAKE-SOCKET,
  1177         by reference ws-send-buf,
  1178         by value ws-send-msg-size,
  1179         by value ws-flags.
  1180     if return-code <= zero
  1181        display 'SOCK16:send error ',
  1182        perform 0250-socket-error thru 0250-exit
  1183        go to 0300-close-socket
  1184     end-if
  1185     .
  1186 0200-exit.
  1187     exit.
  1188 0250-socket-error.
  1189     display "SOCK16:did not complete"
  1190     display 'SOCK16:transaction data =', CLIENT-IN-DATA '**'
  1191     display 'SOCK16:socket number    =', GIVE-TAKE-SOCKET.
  1192     display ' return code = ' return-code
  1193     .
  1194 0250-exit.
  1195     exit.
  1196 0300-close-socket.
  1197     if connected-to-db
  1198        EXEC SQL
  1199            commit work release
  1200        END-EXEC
  1201        if sqlcode not = 0
  1202           move ' Failed to Commit DB '
  1203                                 to ws-return-string
  1204           display "Error: commit release "
  1205           display ' sql return code ' sqlcode
  1206           display ' sql err mess    ' sqlerrmc
  1207        end-if
  1208     end-if
  1209     if connected-to-db
  1210        EXEC SQL
  1211            disconnect all
  1212        END-EXEC
  1213        move ' '                 to ws-connect-sw
  1214     end-if
  1215     display ' about to return cics '
  1216
  1217* exec cics return end-exec
  1218*    MOVE '.(                    ''   #00001119' TO DFHEIV0
  1219     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1220     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1221     MOVE X'2020233030303031313139' TO DFHEIV0(25:11)
  1222     CALL 'kxdfhei1' USING DFHEIV0,
  1223           DFHEIV99,
  1224           DFHEIV99,
  1225           DFHEIV99,
  1226           DFHEIV99,
  1227           DFHEIV99,
  1228           DFHEIV99
  1229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1230
  1231* goback
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  23
* SOCK16.cbl
  1232
  1233     MOVE '9%                    "   ' TO DFHEIV0
  1234     MOVE 'SOCK16' TO DFHEIV1
  1235     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1236     goback
  1237     .
  1238 0300-exit.
  1239     exit.
  1240 0400-GET-ERCOMP.
  1241     display ' made it to 0400-get  '
  1242*    move ws-comp-cd to ws-co-company-cd
  1243*    move kt-carrier(1) to ws-co-carrier
  1244*    move kt-group(1) to ws-co-group
  1245*    move kt-fin-resp(1) to ws-co-fin-resp
  1246*    move kt-account(1) to ws-co-account
  1247*    move kt-type(1) to ws-co-type
  1248     display ' ws co key ' ws-co-key (2:28)
  1249     IF WS-CO-ACCOUNT = SPACES OR ZEROS OR LOW-VALUES
  1250        MOVE LOW-VALUES          TO WS-CO-ACCOUNT
  1251        MOVE 'G'                 TO WS-CO-TYPE
  1252     END-IF
  1253
  1254* EXEC CICS READ
  1255*         INTO    (COMPENSATION-MASTER)
  1256*         DATASET ('ERCOMP')
  1257*         RIDFLD  (WS-CO-KEY)
  1258*         RESP    (WS-RESPONSE)
  1259*    END-EXEC
  1260     MOVE LENGTH OF
  1261      COMPENSATION-MASTER
  1262       TO DFHEIV11
  1263     MOVE 'ERCOMP' TO DFHEIV1
  1264*    MOVE '&"IL       E          (  N#00001137' TO DFHEIV0
  1265     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1266     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1267     MOVE X'204E233030303031313337' TO DFHEIV0(25:11)
  1268     CALL 'kxdfhei1' USING DFHEIV0,
  1269           DFHEIV1,
  1270           COMPENSATION-MASTER,
  1271           DFHEIV11,
  1272           WS-CO-KEY,
  1273           DFHEIV99,
  1274           DFHEIV99,
  1275           DFHEIV99
  1276     MOVE EIBRESP  TO WS-RESPONSE
  1277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1278     display ' read response ' ws-response
  1279     if not resp-normal
  1280        go to 0400-exit
  1281     end-if
  1282     move co-carrier             to cr-carrier
  1283     move co-grouping            to cr-grouping
  1284     move co-resp-no             to cr-resp-no
  1285     move co-account             to cr-account
  1286     move co-type                to cr-type
  1287     move co-last-maint-hhmmss   to ws-work-time
  1288     string
  1289        ws-hh   ':'
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  24
* SOCK16.cbl
  1290        ws-mm   ':'
  1291        ws-ss delimited by size into cr-last-maint-hhmmss
  1292     end-string
  1293*    move co-last-maint-hhmmss   to cr-last-maint-hhmmss-n
  1294     move co-last-maint-user     to cr-last-maint-user
  1295     if co-last-maint-dt <> spaces and low-values
  1296        move co-last-maint-dt    to dc-bin-date-1
  1297        set bin-to-greg to true *> move ' ' to dc-option
  1298        perform 9700-date-link   thru 9700-exit
  1299        if no-conversion-error
  1300           move dc-greg-date-a-edit
  1301                                 to cr-last-maint-dt
  1302           move +0               to nu-last-maint-dt
  1303        else
  1304           display ' error maint dt invalid ' dc-error-code
  1305           move -1               to nu-last-maint-dt
  1306        end-if
  1307     else
  1308        move spaces              to cr-last-maint-dt
  1309        move -1                  to nu-last-maint-dt
  1310     end-if
  1311     move co-stmt-type           to cr-stmt-type
  1312     move co-comp-type           to cr-comp-type
  1313     move co-stmt-owner          to cr-stmt-owner
  1314     move co-balance-control     to cr-balance-control
  1315     move co-internal-control-1  to cr-internal-control-1
  1316     move CO-INTERNAL-CONTROL-1  to cr-INTERNAL-CONTROL-1
  1317     move CO-INTERNAL-CONTROL-2  to cr-INTERNAL-CONTROL-2
  1318     move CO-GA-WITHOLD-PCT      to cr-GA-WITHOLD-PCT-n
  1319     move CO-GA-DIRECT-DEP       to cr-GA-DIRECT-DEP
  1320     move CO-ACCT-NAME           to cr-ACCT-NAME
  1321     move CO-MAIL-NAME           to cr-MAIL-NAME
  1322     move CO-ADDR-1              to cr-ADDR-1
  1323     move CO-ADDR-2              to cr-ADDR-2
  1324     move CO-ADDR-3              to cr-ADDR-3
  1325     move CO-CSO-1099            to cr-CSO-1099
  1326     move CO-ZIP                 to cr-ZIP
  1327     move CO-SOC-SEC             to cr-SOC-SEC
  1328     move CO-TELEPHONE           to cr-TELEPHONE
  1329     if co-roladex-print-dt <> spaces and low-values
  1330        move co-roladex-print-dt to dc-bin-date-1
  1331        set bin-to-greg to true *> move ' ' to dc-option
  1332        perform 9700-date-link   thru 9700-exit
  1333        if no-conversion-error
  1334           move dc-greg-date-a-edit
  1335                                 to cr-rolodex-print-dt
  1336           move +0               to nu-rolodex-print-dt
  1337        else
  1338           display ' error rolodex print dt invalid '
  1339              dc-error-code
  1340           move -1               to nu-rolodex-print-dt
  1341        end-if
  1342     else
  1343        move spaces              to cr-rolodex-print-dt
  1344        move -1                  to nu-rolodex-print-dt
  1345     end-if
  1346     move CO-AR-BAL-LEVEL        to cr-AR-BAL-LEVEL
  1347     move CO-AR-NORMAL-PRINT     to cr-AR-NORMAL-PRINT
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  25
* SOCK16.cbl
  1348     move CO-AR-SUMMARY-CODE     to cr-AR-SUMMARY-CODE
  1349     move CO-AR-REPORTING        to cr-AR-REPORTING
  1350     move CO-AR-PULL-CHECK       to cr-AR-PULL-CHECK
  1351     move CO-AR-BALANCE-PRINT    to cr-AR-BALANCE-PRINT
  1352     move CO-AR-LAST-RUN-CODE    to cr-AR-LAST-RUN-CODE
  1353     if co-LAST-EOM-STMT-DT <> spaces and low-values
  1354        move co-LAST-EOM-STMT-DT to dc-bin-date-1
  1355        set bin-to-greg to true *> move ' ' to dc-option
  1356        perform 9700-date-link   thru 9700-exit
  1357        if no-conversion-error
  1358           move dc-greg-date-a-edit
  1359                                 to cr-LAST-EOM-STMT-DT
  1360           move +0               to nu-LAST-EOM-STMT-DT
  1361        else
  1362           display ' error last eom stmt dt invalid '
  1363              dc-error-code
  1364           move -1               to nu-LAST-EOM-STMT-DT
  1365        end-if
  1366     else
  1367        move spaces              to cr-LAST-EOM-STMT-DT
  1368        move -1                  to nu-LAST-EOM-STMT-DT
  1369     end-if
  1370     move CO-USER-CODE           to cr-USER-CODE
  1371     move CO-REPORT-GROUP-ID     to cr-REPORT-GROUP-ID
  1372     if co-LAST-ACTIVITY-DATE <> spaces and low-values
  1373        move co-LAST-ACTIVITY-DATE
  1374                                 to dc-greg-date-1-ymd-r
  1375        set ymd-greg-to-bin to true *> move '3' to dc-option
  1376        perform 9700-date-link   thru 9700-exit
  1377        if no-conversion-error
  1378           move dc-greg-date-a-edit
  1379                                 to cr-LAST-ACTIVITY-DATE
  1380           move +0               to nu-LAST-ACTIVITY-DATE
  1381        else
  1382           display ' error last activity dt invalid '
  1383              dc-error-code
  1384           move -1               to nu-LAST-ACTIVITY-DATE
  1385        end-if
  1386     else
  1387        move spaces              to cr-LAST-ACTIVITY-DATE
  1388        move -1                  to nu-LAST-ACTIVITY-DATE
  1389     end-if
  1390     if co-LAST-STMT-DT <> spaces and low-values
  1391        move co-LAST-STMT-DT     to dc-greg-date-1-ymd-r
  1392        set ymd-greg-to-bin to true *> move '3' to dc-option
  1393        perform 9700-date-link   thru 9700-exit
  1394        if no-conversion-error
  1395           move dc-greg-date-a-edit
  1396                                 to cr-LAST-STMT-DT
  1397           move +0               to nu-LAST-STMT-DT
  1398        else
  1399           display ' error last stmt dt invalid '
  1400              dc-error-code
  1401           move -1               to nu-LAST-STMT-DT
  1402        end-if
  1403     else
  1404        move spaces              to cr-LAST-STMT-DT
  1405        move -1                  to nu-LAST-STMT-DT
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  26
* SOCK16.cbl
  1406     end-if
  1407     move CO-BAL-FWD             to cr-BAL-FWD
  1408     move CO-CUR-COM             to cr-CUR-COM
  1409     move CO-CUR-CHG             to cr-CUR-CHG
  1410     move CO-CUR-PMT             to cr-CUR-PMT
  1411     move CO-END-BAL             to cr-END-BAL
  1412     move CO-CUR                 to cr-CUR
  1413     move CO-OV30                to cr-OV30
  1414     move CO-OV60                to cr-OV60
  1415     move CO-OV90                to cr-OV90
  1416     move CO-YTD-COM             to cr-YTD-COM
  1417     move CO-YTD-OV              to cr-YTD-OV
  1418     move CO-CUR-OVR-UNDR        to cr-CUR-OVR-UNDR
  1419     move CO-YTD-OVR-UNDR        to cr-YTD-OVR-UNDR
  1420     move CO-CUR-FICA            to cr-CUR-FICA
  1421     move CO-YTD-FICA            to cr-YTD-FICA
  1422     move CO-LF-CLM-AMT          to cr-LF-CLM-AMT
  1423     move CO-AH-CLM-AMT          to cr-AH-CLM-AMT
  1424     if co-current-LAST-STMT-DT <> spaces and low-values
  1425        move co-current-LAST-STMT-DT
  1426                                 to dc-greg-date-1-ymd-r
  1427        set ymd-greg-to-bin to true *> move '3' to dc-option
  1428        perform 9700-date-link   thru 9700-exit
  1429        if no-conversion-error
  1430           move dc-greg-date-a-edit
  1431                                 to cr-current-LAST-STMT-DT
  1432           move +0               to nu-current-LAST-STMT-DT
  1433        else
  1434           display ' error current last stmt dt invalid '
  1435              dc-error-code
  1436           move -1               to nu-current-LAST-STMT-DT
  1437        end-if
  1438     else
  1439        move spaces              to cr-current-LAST-STMT-DT
  1440        move -1                  to nu-current-LAST-STMT-DT
  1441     end-if
  1442     move CO-CURRENT-BAL-FWD     to cr-CURRENT-BAL-FWD
  1443     move CO-CURRENT-CUR-COM     to cr-CURRENT-CUR-COM
  1444     move CO-CURRENT-CUR-CHG     to cr-CURRENT-CUR-CHG
  1445     move CO-CURRENT-CUR-PMT     to cr-CURRENT-CUR-PMT
  1446     move CO-CURRENT-END-BAL     to cr-CURRENT-END-BAL
  1447     move CO-CURRENT-CUR         to cr-CURRENT-CUR
  1448     move CO-CURRENT-OV30        to cr-CURRENT-OV30
  1449     move CO-CURRENT-OV60        to cr-CURRENT-OV60
  1450     move CO-CURRENT-OV90        to cr-CURRENT-OV90
  1451     move CO-CURRENT-YTD-COM     to cr-CURRENT-YTD-COM
  1452     move CO-CURRENT-YTD-OV      to cr-CURRENT-YTD-OV
  1453     move CO-YTD-PAID-COM        to cr-YTD-PAID-COM
  1454     move CO-YTD-PAID-OV         to cr-YTD-PAID-OV
  1455     move CO-CURRENT-MONTH-ACTIVITY
  1456                                 to cr-CURRENT-MONTH-ACTIVIty
  1457     move CO-DELINQUENT-LETTER-CODE
  1458                                 to cr-DELINQUENT-LETTER-COde
  1459     move CO-CSR-CODE            to cr-CSR-CODE
  1460     if co-GA-EFFECTIVE-DT <> spaces and low-values
  1461        move co-GA-EFFECTIVE-DT to dc-bin-date-1
  1462        set bin-to-greg to true *> move ' ' to dc-option
  1463        perform 9700-date-link   thru 9700-exit
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  27
* SOCK16.cbl
  1464        if no-conversion-error
  1465           move dc-greg-date-a-edit
  1466                                 to cr-GA-EFFECTIVE-DT
  1467           move +0               to nu-GA-EFFECTIVE-DT
  1468        else
  1469           display ' error GA EFF dt invalid '
  1470              dc-error-code
  1471           move -1               to nu-GA-EFFECTIVE-DT
  1472        end-if
  1473     else
  1474        move spaces              to cr-GA-EFFECTIVE-DT
  1475        move -1                  to nu-GA-EFFECTIVE-DT
  1476     end-if
  1477     if co-GA-termination-DT <> spaces and low-values
  1478        move co-GA-TERMINATION-DT to dc-bin-date-1
  1479        set bin-to-greg to true *> move ' ' to dc-option
  1480        perform 9700-date-link   thru 9700-exit
  1481        if no-conversion-error
  1482           move dc-greg-date-a-edit
  1483                                 to cr-GA-TERMINATION-DT
  1484           move +0               to nu-GA-TERMINATION-DT
  1485        else
  1486           display ' error GA termination dt invalid '
  1487              dc-error-code
  1488           move -1               to nu-GA-TERMINATION-DT
  1489        end-if
  1490     else
  1491        move spaces              to cr-GA-TERMINATION-DT
  1492        move -1                  to nu-GA-TERMINATION-DT
  1493     end-if
  1494     move CO-GA-STATUS-CODE      to cr-GA-STATUS-CODE
  1495     move CO-GA-COMMENT-1        to cr-GA-COMMENT-1
  1496     move CO-GA-COMMENT-2        to cr-GA-COMMENT-2
  1497     move CO-GA-COMMENT-3        to cr-GA-COMMENT-3
  1498     move CO-GA-COMMENT-4        to cr-GA-COMMENT-4
  1499     move CO-RPTCD2              to cr-RPTCD2
  1500     move CO-OV120               to cr-OV120
  1501     move CO-CURRENT-OV120       to cr-CURRENT-OV120
  1502     move CO-TYPE-AGENT          to cr-TYPE-AGENT
  1503     move CO-FAXNO               to cr-FAXNO
  1504     move CO-MD-GL-ACCT          to cr-MD-GL-ACCT
  1505     move CO-MD-DIV              to cr-MD-DIV
  1506     move CO-MD-CENTER           to cr-MD-CENTER
  1507     move CO-MD-AMT              to cr-MD-AMT-n
  1508     move CO-CREATE-AP-CHECK     to cr-CREATE-AP-CHECK
  1509     move CO-DELIVER-CK-TO-MEL   to cr-DELIVER-CK-TO-MEL
  1510     move CO-ACH-STATUS          to cr-ACH-STATUS
  1511     display ' co bill sw ' co-bill-sw
  1512     move CO-BILL-SW             to cr-BILL-SW
  1513     move CO-CONTROL-NAME        to cr-CONTROL-NAME
  1514     move CO-MAX-BANK-FEE-LEASE  to cr-MAX-BANK-FEE-LEASE
  1515     move CO-MAX-BANK-FEE        to cr-MAX-BANK-FEE
  1516     move CO-CLP-STATE           to cr-CLP-STATE
  1517     if co-FIRST-WRITTEN-DT <> spaces and low-values
  1518        move co-FIRST-WRITTEN-DT to dc-bin-date-1
  1519        set bin-to-greg to true *> move ' ' to dc-option
  1520        perform 9700-date-link   thru 9700-exit
  1521        if no-conversion-error
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  28
* SOCK16.cbl
  1522           move dc-greg-date-a-edit
  1523                                 to cr-FIRST-WRITTEN-DT
  1524           move +0               to nu-FIRST-WRITTEN-DT
  1525        else
  1526           display ' error 1st written dt invalid '
  1527              dc-error-code
  1528           move -1               to nu-FIRST-WRITTEN-DT
  1529        end-if
  1530     else
  1531        move spaces              to cr-FIRST-WRITTEN-DT
  1532        move -1                  to nu-FIRST-WRITTEN-DT
  1533     end-if
  1534     move CO-SPP-REFUND-EDIT     to cr-SPP-REFUND-EDIT
  1535     perform 0500-update-table   thru 0500-exit
  1536     .
  1537 0400-EXIT.
  1538     EXIT.
  1539 0500-update-table.
  1540     display ' made it to 0500-update '
  1541     if not connected-to-db
  1542        perform 6000-connect-to-db thru 6000-exit
  1543     end-if
  1544     display ' bill sw ' cr-bill-sw
  1545     display ' key *' cr-carrier '*' cr-grouping '*'
  1546        cr-resp-no '*' cr-account '*' cr-type '*'
  1547     exec sql
  1548        update
  1549           ERCOMP
  1550        set
  1551           ex_stmt_type = :cr-stmt-type,
  1552           ex_comp_spp = :cr-comp-type,
  1553           ex_balance_control = :cr-balance-control,
  1554           ex_bill_sw = :cr-bill-sw,
  1555           ex_ga_withhold_pct = :cr-ga-withold-pct,
  1556           ex_ga_direct_deposit = :cr-ga-direct-dep,
  1557           ex_create_ap_check = :cr-create-ap-check,
  1558           ex_deliver_to_mel = :cr-deliver-ck-to-mel,
  1559           ex_md_gl_acct = :cr-md-gl-acct,
  1560           ex_md_div = :cr-md-div,
  1561           ex_md_center = :cr-md-center,
  1562           ex_md_amount = :cr-md-amt,
  1563           ex_report_group_id = :cr-report-group-id,
  1564           ex_comment1 = :cr-ga-comment-1,
  1565           ex_comment2 = :cr-ga-comment-2,
  1566           ex_comment3 = :cr-ga-comment-3,
  1567           ex_comment4 = :cr-ga-comment-4,
  1568           ex_status = :cr-ga-status-code,
  1569           ex_effect = :cr-GA-EFFECTIVE-DT :nu-GA-EFFECTIVE-DT,
  1570           ex_expire = :CR-GA-TERMINATION-DT
  1571                       :nu-GA-TERMINATION-DT,
  1572           ex_last_maint_dt = :cr-last-maint-dt
  1573                       :nu-last-maint-dt,
  1574           ex_last_maint_user = :cr-last-maint-user,
  1575           ex_last_maint_time = :cr-last-maint-hhmmss,
  1576           ex_stmt_owner = :cr-stmt-owner
  1577        where
  1578           ex_carrier  = :cr-carrier and
  1579           ex_grouping = :cr-grouping and
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  29
* SOCK16.cbl
  1580           ex_resp_no  = :cr-resp-no and
  1581           ex_account  = :cr-account and
  1582           ex_type     = :cr-type
  1583     end-exec
  1584     if sqlcode not = 0
  1585        display "Error: did not update table "
  1586        display ' sql return code ' sqlcode
  1587        display ' sql err mess    ' sqlerrmc
  1588        move sqlcode             to ws-display-response
  1589        move '9999;Did not update ' to ws-return-string
  1590        PERFORM 0200-SEND-BUFFER thru 0200-exit
  1591        perform 0250-socket-error thru 0250-exit
  1592        go to 0300-close-socket
  1593     end-if
  1594     display ' sql code upd ' sqlcode
  1595     .
  1596 0500-exit.
  1597     exit.
  1598 6000-CONNECT-TO-DB.
  1599***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
  1600***                                                            ***
  1601***                                                            ***
  1602***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
  1603     MOVE 'HOVTSTDB01_Logic'
  1604                                 TO SVR
  1605     move 'appuser'              to usr
  1606     move 'appuser@cso'          to pass
  1607     if ws-kix-myenv = 'cid1p'
  1608        MOVE 'SDVDB01_Logic'
  1609                                 TO SVR
  1610        move 'appuser'           to usr
  1611        move 'appuser@cso'       to pass
  1612     end-if
  1613     string
  1614         usr delimited space
  1615         "." delimited size
  1616         pass delimited space into usr-pass
  1617     end-string
  1618     display ' About to connect to ' svr ' ' usr-pass
  1619     EXEC SQL
  1620        CONNECT TO :svr USER :usr-pass
  1621     END-EXEC
  1622     if sqlcode not = 0
  1623        display "Error: cannot connect to " svr
  1624        display sqlcode
  1625        display sqlerrmc
  1626        move '9999;Could not connect to DB ' to ws-return-string
  1627        PERFORM 0200-SEND-BUFFER thru 0200-exit
  1628        perform 0250-socket-error thru 0250-exit
  1629        go to 0300-close-socket
  1630     else
  1631        display ' Successful Connect ' sqlcode
  1632        set connected-to-db to true
  1633     end-if
  1634     .
  1635 6000-EXIT.
  1636     EXIT.
  1637 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 28-Jul-21 10:46 Page  30
* SOCK16.cbl
  1638
  1639* EXEC CICS LINK
  1640*         PROGRAM  ('ELDATCV')
  1641*         COMMAREA (DATE-CONVERSION-DATA)
  1642*         LENGTH   (DC-COMM-LENGTH)
  1643*    END-EXEC.
  1644     MOVE 'ELDATCV' TO DFHEIV1
  1645*    MOVE '."C                   (   #00001503' TO DFHEIV0
  1646     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1647     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1648     MOVE X'2020233030303031353033' TO DFHEIV0(25:11)
  1649     CALL 'kxdfhei1' USING DFHEIV0,
  1650           DFHEIV1,
  1651           DATE-CONVERSION-DATA,
  1652           DC-COMM-LENGTH,
  1653           DFHEIV99,
  1654           DFHEIV99,
  1655           DFHEIV99,
  1656           DFHEIV99
  1657     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1658
  1659 9700-EXIT.
  1660      EXIT.
  1661
  1662 9999-DFHBACK SECTION.
  1663     MOVE '9%                    "   ' TO DFHEIV0
  1664     MOVE 'SOCK16' TO DFHEIV1
  1665     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1666     GOBACK.
  1667 9999-DFHEXIT.
  1668     IF DFHEIGDJ EQUAL 0001
  1669         NEXT SENTENCE.
  1670     MOVE '9%                    "   ' TO DFHEIV0
  1671     MOVE 'SOCK16' TO DFHEIV1
  1672     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1673     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:      147888     Code:       10856
