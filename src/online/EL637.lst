* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL637.cbl
* Options: int("EL637.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL637.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL637.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL637.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL637 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:53:54.
     7*                            VMOD=2.012
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL637.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS. TRANSACTION - EXJB - CHECK VOID PROGRAM.
    25
    26 ENVIRONMENT DIVISION.
    27
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL637.cbl
    29 DATA DIVISION.
    30 WORKING-STORAGE SECTION.
    31 01  DFH-START PIC X(04).
    32
    33 77  FILLER  PIC X(32)  VALUE '********************************'.
    34 77  FILLER  PIC X(32)  VALUE '*    EL637 WORKING STORAGE     *'.
    35 77  FILLER  PIC X(32)  VALUE '************ V/M 2.012 *********'.
    36
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL637.cbl
    38
    39*                            COPY ELCSCTM.
    40******************************************************************
    41*                                                                *
    42*                                                                *
    43*                            ELCSCTM                             *
    44*                            VMOD=2.001                          *
    45*                                                                *
    46*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    47*                                                                *
    48******************************************************************
    49 01  SECURITY-MESSAGE.
    50     12  FILLER                          PIC X(30)
    51            VALUE '** LOGIC SECURITY VIOLATION -'.
    52     12  SM-READ                         PIC X(6).
    53     12  FILLER                          PIC X(5)
    54            VALUE ' PGM='.
    55     12  SM-PGM                          PIC X(6).
    56     12  FILLER                          PIC X(5)
    57            VALUE ' OPR='.
    58     12  SM-PROCESSOR-ID                 PIC X(4).
    59     12  FILLER                          PIC X(6)
    60            VALUE ' TERM='.
    61     12  SM-TERMID                       PIC X(4).
    62     12  FILLER                          PIC XX   VALUE SPACE.
    63     12  SM-JUL-DATE                     PIC 9(5).
    64     12  FILLER                          PIC X    VALUE SPACE.
    65     12  SM-TIME                         PIC 99.99.
    66
    67*                            COPY ELCSCRTY.
    68******************************************************************
    69*                                                                *
    70*                                                                *
    71*                            ELCSCRTY                            *
    72*                            VMOD=2.001                          *
    73*                                                                *
    74*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    75*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    76*        SAVED IN PI-SECURITY-ADDRESS.                           *
    77*                                                                *
    78******************************************************************
    79 01  SECURITY-CONTROL.
    80     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    81     12  FILLER                       PIC XX    VALUE 'SC'.
    82     12  SC-CREDIT-CODES.
    83         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    84             20  SC-CREDIT-DISPLAY    PIC X.
    85             20  SC-CREDIT-UPDATE     PIC X.
    86     12  SC-CLAIMS-CODES.
    87         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    88             20  SC-CLAIMS-DISPLAY    PIC X.
    89             20  SC-CLAIMS-UPDATE     PIC X.
    90
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL637.cbl
    92
    93******************************************************************
    94*                                                                *
    95*              S T A N D A R D   A R E A S                       *
    96*                                                                *
    97******************************************************************
    98
    99 01  STANDARD-AREAS.
   100     12  SC-ITEM                     PIC S9(4)   VALUE +1   COMP.
   101     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   102     12  EL637A                      PIC X(8)    VALUE 'EL637A'.
   103     12  MAPSET-EL637S               PIC X(8)    VALUE 'EL637S'.
   104     12  TRANS-EXJB                  PIC X(4)    VALUE 'EXJB'.
   105     12  THIS-PGM                    PIC X(8)    VALUE 'EL637 '.
   106     12  PGM-NAME                    PIC X(8).
   107     12  TIME-IN                     PIC S9(7).
   108     12  TIME-OUT-R  REDEFINES TIME-IN.
   109         16  FILLER                  PIC X.
   110         16  TIME-OUT                PIC 99V99.
   111         16  FILLER                  PIC X(2).
   112     12  LINK-EL001                  PIC X(8)    VALUE 'EL001'.
   113     12  LINK-EL004                  PIC X(8)    VALUE 'EL004'.
   114     12  XCTL-EL005                  PIC X(8)    VALUE 'EL005'.
   115     12  XCTL-EL010                  PIC X(8)    VALUE 'EL010'.
   116     12  XCTL-EL626                  PIC X(8)    VALUE 'EL626'.
   117     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   118     12  FILE-ID-ERCMKQ              PIC X(8)    VALUE 'ERCMKQ '.
   119     12  FILE-ID-ERCMKQ2             PIC X(8)    VALUE 'ERCMKQ2'.
   120     12  FILE-ID-ERCMCK              PIC X(8)    VALUE 'ERCMCK '.
   121     12  FILE-ID-ERCKWK              PIC X(8)    VALUE 'ERCKWK '.
   122     12  FILE-ID-ERPYAJ              PIC X(8)    VALUE 'ERPYAJ '.
   123     12  WS-CURRENT-DT               PIC X(8)    VALUE SPACES.
   124     12  WS-CURRENT-BIN-DT           PIC XX      VALUE SPACES.
   125     12  QID.
   126         16  QID-TERM                PIC X(4)    VALUE SPACES.
   127         16  FILLER                  PIC X(4)    VALUE '125D'.
   128     12  WS-TIME                     PIC 9(6)    VALUE ZEROS.
   129     12  WS-HR-MINS-SECS REDEFINES WS-TIME.
   130         16  WS-HR-MINS              PIC 99V99.
   131         16  FILLER                  PIC XX.
   132
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL637.cbl
   134
   135 01  WORK-AREA.
   136     12  DEEDIT-FIELD               PIC X(12).
   137     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD   PIC S9(10)V99.
   138     12  WS-WORK-SEQ-NO             PIC S9(9)   VALUE +0 COMP.
   139     12  WS-WORK-SEQ-HOLD           PIC S9(3)   VALUE +0.
   140     12  WS-SUB1                    PIC S9(4)   VALUE +0 COMP.
   141     12  WS-ERCKWK-PROCESS-SW       PIC X       VALUE SPACE.
   142         88  WS-ERCKWK-PROCESSED                VALUE 'Y'.
   143     12  WS-BROWSE-SW               PIC X       VALUE SPACE.
   144         88  WS-BROWSE-STARTED                  VALUE 'Y'.
   145     12  WS-FIRST-TIME-SW           PIC X       VALUE 'Y'.
   146         88  WS-FIRST-TIME                      VALUE 'Y'.
   147     12  WS-STRT-CK-NO              PIC 9(6)  VALUE ZEROS.
   148
   149 01  WS-MAX-TEXT-SEQ                PIC S9(4)   VALUE +9002 COMP.
   150
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL637.cbl
   152
   153******************************************************************
   154*                                                                *
   155*                E R R O R   M E S S A G E S                     *
   156*                                                                *
   157******************************************************************
   158
   159 01  ERROR-MESSAGES.
   160     12  ER-0000                 PIC X(4)  VALUE '0000'.
   161     12  ER-0004                 PIC X(4)  VALUE '0004'.
   162     12  ER-0008                 PIC X(4)  VALUE '0008'.
   163     12  ER-0023                 PIC X(4)  VALUE '0023'.
   164     12  ER-0029                 PIC X(4)  VALUE '0029'.
   165     12  ER-0070                 PIC X(4)  VALUE '0070'.
   166     12  ER-0194                 PIC X(4)  VALUE '0194'.
   167     12  ER-0195                 PIC X(4)  VALUE '0195'.
   168     12  ER-2056                 PIC X(4)  VALUE '2056'.
   169     12  ER-2132                 PIC X(4)  VALUE '2132'.
   170     12  ER-2223                 PIC X(4)  VALUE '2223'.
   171     12  ER-2251                 PIC X(4)  VALUE '2251'.
   172     12  ER-2252                 PIC X(4)  VALUE '2252'.
   173     12  ER-2800                 PIC X(4)  VALUE '2800'.
   174     12  ER-3129                 PIC X(4)  VALUE '3129'.
   175     12  ER-3147                 PIC X(4)  VALUE '3147'.
   176     12  ER-3148                 PIC X(4)  VALUE '3148'.
   177     12  ER-3158                 PIC X(4)  VALUE '3158'.
   178     12  ER-3159                 PIC X(4)  VALUE '3159'.
   179     12  ER-3160                 PIC X(4)  VALUE '3160'.
   180     12  ER-3161                 PIC X(4)  VALUE '3161'.
   181     12  ER-3162                 PIC X(4)  VALUE '3162'.
   182     12  ER-3163                 PIC X(4)  VALUE '3163'.
   183     12  ER-3164                 PIC X(4)  VALUE '3164'.
   184     12  ER-3165                 PIC X(4)  VALUE '3165'.
   185     12  ER-3171                 PIC X(4)  VALUE '3171'.
   186     12  ER-3176                 PIC X(4)  VALUE '3176'.
   187     12  ER-3185                 PIC X(4)  VALUE '3185'.
   188
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL637.cbl
   190
   191******************************************************************
   192*                                                                *
   193*              A C C E S S   K E Y S                             *
   194*                                                                *
   195******************************************************************
   196
   197 01  ACCESS-KEYS.
   198
   199     12  ERCMKQ-KEY.
   200         16  ERCMKQ-COMPANY-CD       PIC X           VALUE SPACES.
   201         16  ERCMKQ-CONTROL-NUMBER   PIC S9(8) COMP VALUE +0.
   202         16  ERCMKQ-SEQUENCE-NUMBER  PIC S9(4) COMP VALUE +0.
   203
   204     12  ERCMKQ2-KEY.
   205         16  ERCMKQ2-COMPANY-CD      PIC X          VALUE SPACES.
   206         16  ERCMKQ2-CSR             PIC X(4)       VALUE SPACES.
   207         16  ERCMKQ2-CARRIER         PIC X          VALUE SPACES.
   208         16  ERCMKQ2-GROUPING        PIC X(6)       VALUE SPACES.
   209         16  ERCMKQ2-PAYEE           PIC X(10)      VALUE SPACES.
   210         16  ERCMKQ2-PAYEE-SEQ       PIC S9(4) COMP VALUE +0.
   211         16  ERCMKQ2-CONTROL-NUMBER  PIC S9(8) COMP VALUE +0.
   212         16  ERCMKQ2-SEQUENCE-NUMBER PIC S9(4) COMP VALUE +0.
   213
   214     12  ERCMKQ2-PREV-KEY            PIC X(30)      VALUE SPACES.
   215
   216     12  ERCMKQ2-COMPARE-KEY         PIC X(28)      VALUE SPACES.
   217
   218     12  SVCMKQ2-COMPARE-KEY         PIC X(28)      VALUE SPACES.
   219
   220     12  ERCMKQ-RECORD-LENGTH        PIC S9(4) COMP VALUE +1800.
   221
   222     12  ERCMCK-KEY.
   223         16  ERCMCK-COMPANY-CD       PIC X          VALUE SPACES.
   224         16  ERCMCK-CSR              PIC X(4)       VALUE SPACES.
   225         16  ERCMCK-CARRIER          PIC X          VALUE SPACES.
   226         16  ERCMCK-GROUPING         PIC X(6)       VALUE SPACES.
   227         16  ERCMCK-PAYEE            PIC X(10)      VALUE SPACES.
   228         16  ERCMCK-PAYEE-SEQ        PIC S9(4) COMP VALUE +0.
   229         16  ERCMCK-SEQUENCE-NO      PIC S9(4) COMP VALUE +0.
   230
   231     12  ERCMCK-RECORD-LENGTH        PIC S9(4) COMP VALUE +2000.
   232
   233     12  ERCKWK-KEY.
   234         16  ERCKWK-COMPANY-CD       PIC X           VALUE SPACES.
   235         16  ERCKWK-CSR              PIC X(4)        VALUE SPACES.
   236         16  ERCKWK-CARRIER          PIC X           VALUE SPACES.
   237         16  ERCKWK-GROUPING         PIC X(6)        VALUE SPACES.
   238         16  ERCKWK-PAYEE            PIC X(10)       VALUE SPACES.
   239         16  ERCKWK-PAYEE-SEQ        PIC S9(4)  COMP VALUE +0.
   240         16  ERCKWK-SEQUENCE-NO      PIC S9(4)  COMP VALUE +0.
   241
   242
   243     12  ERPYAJ-KEY.
   244         16  ERPYAJ-COMPANY-CD       PIC X           VALUE SPACE.
   245         16  ERPYAJ-CARRIER          PIC X           VALUE SPACE.
   246         16  ERPYAJ-GROUPING         PIC X(6)        VALUE SPACE.
   247         16  ERPYAJ-FIN-RESP         PIC X(10)       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL637.cbl
   248         16  ERPYAJ-ACCOUNT          PIC X(10)       VALUE SPACE.
   249         16  ERPYAJ-FILE-SEQ-NO      PIC S9(8) COMP  VALUE +0.
   250         16  ERPYAJ-RECORD-TYPE      PIC X.
   251
   252     12  ERPYAJ-RECORD-LENGTH        PIC S9(4) COMP  VALUE +200.
   253
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL637.cbl
   255
   256*                            COPY ELCDATE.
   257******************************************************************
   258*                                                                *
   259*                                                                *
   260*                            ELCDATE.                            *
   261*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   262*                            VMOD=2.003
   263*                                                                *
   264*                                                                *
   265*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   266*                 LENGTH = 200                                   *
   267******************************************************************
   268
   269 01  DATE-CONVERSION-DATA.
   270     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   271     12  DC-OPTION-CODE                PIC X.
   272         88  BIN-TO-GREG                VALUE ' '.
   273         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   274         88  EDIT-GREG-TO-BIN           VALUE '2'.
   275         88  YMD-GREG-TO-BIN            VALUE '3'.
   276         88  MDY-GREG-TO-BIN            VALUE '4'.
   277         88  JULIAN-TO-BIN              VALUE '5'.
   278         88  BIN-PLUS-ELAPSED           VALUE '6'.
   279         88  FIND-CENTURY               VALUE '7'.
   280         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   281         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   282         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   283         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   284         88  JULIAN-TO-BIN-3            VALUE 'C'.
   285         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   286         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   287         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   288         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   289         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   290         88  CHECK-LEAP-YEAR            VALUE 'H'.
   291         88  BIN-3-TO-GREG              VALUE 'I'.
   292         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   293         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   294         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   295         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   296         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   297         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   298         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   299         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   300         88  THREE-CHARACTER-BIN
   301                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   302         88  GREGORIAN-TO-BIN
   303                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   304         88  BIN-TO-GREGORIAN
   305                  VALUES ' ' '1' 'I' '8' 'G'.
   306         88  JULIAN-TO-BINARY
   307                  VALUES '5' 'C' 'E' 'F'.
   308     12  DC-ERROR-CODE                 PIC X.
   309         88  NO-CONVERSION-ERROR        VALUE ' '.
   310         88  DATE-CONVERSION-ERROR
   311                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   312         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL637.cbl
   313         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   314         88  DATE-IS-INVALID            VALUE '3'.
   315         88  DATE1-GREATER-DATE2        VALUE '4'.
   316         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   317         88  DATE-INVALID-OPTION        VALUE '9'.
   318         88  INVALID-CENTURY            VALUE 'A'.
   319         88  ONLY-CENTURY               VALUE 'B'.
   320         88  ONLY-LEAP-YEAR             VALUE 'C'.
   321         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   322     12  DC-END-OF-MONTH               PIC X.
   323         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   324     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   325         88  USE-NORMAL-PROCESS         VALUE ' '.
   326         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   327         88  ADJUST-UP-100-YRS          VALUE '2'.
   328     12  FILLER                        PIC X.
   329     12  DC-CONVERSION-DATES.
   330         16  DC-BIN-DATE-1             PIC XX.
   331         16  DC-BIN-DATE-2             PIC XX.
   332         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   333         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   334                       DC-GREG-DATE-1-EDIT.
   335             20  DC-EDIT1-MONTH        PIC 99.
   336             20  SLASH1-1              PIC X.
   337             20  DC-EDIT1-DAY          PIC 99.
   338             20  SLASH1-2              PIC X.
   339             20  DC-EDIT1-YEAR         PIC 99.
   340         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   341         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   342                     DC-GREG-DATE-2-EDIT.
   343             20  DC-EDIT2-MONTH        PIC 99.
   344             20  SLASH2-1              PIC X.
   345             20  DC-EDIT2-DAY          PIC 99.
   346             20  SLASH2-2              PIC X.
   347             20  DC-EDIT2-YEAR         PIC 99.
   348         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   349         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   350                     DC-GREG-DATE-1-YMD.
   351             20  DC-YMD-YEAR           PIC 99.
   352             20  DC-YMD-MONTH          PIC 99.
   353             20  DC-YMD-DAY            PIC 99.
   354         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   355         16  DC-GREG-DATE-1-MDY-R REDEFINES
   356                      DC-GREG-DATE-1-MDY.
   357             20  DC-MDY-MONTH          PIC 99.
   358             20  DC-MDY-DAY            PIC 99.
   359             20  DC-MDY-YEAR           PIC 99.
   360         16  DC-GREG-DATE-1-ALPHA.
   361             20  DC-ALPHA-MONTH        PIC X(10).
   362             20  DC-ALPHA-DAY          PIC 99.
   363             20  FILLER                PIC XX.
   364             20  DC-ALPHA-CENTURY.
   365                 24 DC-ALPHA-CEN-N     PIC 99.
   366             20  DC-ALPHA-YEAR         PIC 99.
   367         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   368         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   369         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   370         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL637.cbl
   371         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   372                                       PIC 9(05).
   373         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   374             20  DC-JULIAN-YEAR        PIC 99.
   375             20  DC-JULIAN-DAYS        PIC 999.
   376         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   377         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   378         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   379     12  DATE-CONVERSION-VARIBLES.
   380         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   381         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   382             20  FILLER                PIC 9(3).
   383             20  HOLD-CEN-1-CCYY.
   384                 24  HOLD-CEN-1-CC     PIC 99.
   385                 24  HOLD-CEN-1-YY     PIC 99.
   386             20  HOLD-CEN-1-MO         PIC 99.
   387             20  HOLD-CEN-1-DA         PIC 99.
   388         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   389             20  HOLD-CEN-1-R-MO       PIC 99.
   390             20  HOLD-CEN-1-R-DA       PIC 99.
   391             20  HOLD-CEN-1-R-CCYY.
   392                 24  HOLD-CEN-1-R-CC   PIC 99.
   393                 24  HOLD-CEN-1-R-YY   PIC 99.
   394             20  FILLER                PIC 9(3).
   395         16  HOLD-CENTURY-1-X.
   396             20  FILLER                PIC X(3)  VALUE SPACES.
   397             20  HOLD-CEN-1-X-CCYY.
   398                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   399                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   400             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   401             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   402         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   403             20  HOLD-CEN-1-R-X-MO     PIC XX.
   404             20  HOLD-CEN-1-R-X-DA     PIC XX.
   405             20  HOLD-CEN-1-R-X-CCYY.
   406                 24  HOLD-CEN-1-R-X-CC PIC XX.
   407                 24  HOLD-CEN-1-R-X-YY PIC XX.
   408             20  FILLER                PIC XXX.
   409         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   410         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   411         16  DC-JULIAN-DATE-1          PIC 9(07).
   412         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   413             20  DC-JULIAN-1-CCYY.
   414                 24  DC-JULIAN-1-CC    PIC 99.
   415                 24  DC-JULIAN-1-YR    PIC 99.
   416             20  DC-JULIAN-DA-1        PIC 999.
   417         16  DC-JULIAN-DATE-2          PIC 9(07).
   418         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   419             20  DC-JULIAN-2-CCYY.
   420                 24  DC-JULIAN-2-CC    PIC 99.
   421                 24  DC-JULIAN-2-YR    PIC 99.
   422             20  DC-JULIAN-DA-2        PIC 999.
   423         16  DC-GREG-DATE-A-EDIT.
   424             20  DC-EDITA-MONTH        PIC 99.
   425             20  SLASHA-1              PIC X VALUE '/'.
   426             20  DC-EDITA-DAY          PIC 99.
   427             20  SLASHA-2              PIC X VALUE '/'.
   428             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL637.cbl
   429                 24  DC-EDITA-CENT     PIC 99.
   430                 24  DC-EDITA-YEAR     PIC 99.
   431         16  DC-GREG-DATE-B-EDIT.
   432             20  DC-EDITB-MONTH        PIC 99.
   433             20  SLASHB-1              PIC X VALUE '/'.
   434             20  DC-EDITB-DAY          PIC 99.
   435             20  SLASHB-2              PIC X VALUE '/'.
   436             20  DC-EDITB-CCYY.
   437                 24  DC-EDITB-CENT     PIC 99.
   438                 24  DC-EDITB-YEAR     PIC 99.
   439         16  DC-GREG-DATE-CYMD         PIC 9(08).
   440         16  DC-GREG-DATE-CYMD-R REDEFINES
   441                              DC-GREG-DATE-CYMD.
   442             20  DC-CYMD-CEN           PIC 99.
   443             20  DC-CYMD-YEAR          PIC 99.
   444             20  DC-CYMD-MONTH         PIC 99.
   445             20  DC-CYMD-DAY           PIC 99.
   446         16  DC-GREG-DATE-MDCY         PIC 9(08).
   447         16  DC-GREG-DATE-MDCY-R REDEFINES
   448                              DC-GREG-DATE-MDCY.
   449             20  DC-MDCY-MONTH         PIC 99.
   450             20  DC-MDCY-DAY           PIC 99.
   451             20  DC-MDCY-CEN           PIC 99.
   452             20  DC-MDCY-YEAR          PIC 99.
   453    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   454        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   455    12  DC-EL310-DATE                  PIC X(21).
   456    12  FILLER                         PIC X(28).
   457
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL637.cbl
   459*                            COPY ELCLOGOF.
   460******************************************************************
   461*                                                                *
   462*                                                                *
   463*                            ELCLOGOF.                           *
   464*                            VMOD=2.001                          *
   465*                                                                *
   466*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   467*                                                                *
   468******************************************************************
   469 01  CLASIC-LOGOFF.
   470     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   471     12  LOGOFF-TEXT.
   472         16  FILLER          PIC X(5)    VALUE SPACES.
   473         16  LOGOFF-MSG.
   474             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   475             20  FILLER      PIC X       VALUE SPACES.
   476             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   477         16  FILLER          PIC X(80)
   478           VALUE '* YOU ARE NOW LOGGED OFF'.
   479         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   480         16  FILLER          PIC X       VALUE QUOTE.
   481         16  LOGOFF-SYS-MSG  PIC X(17)
   482           VALUE 'S CLAS-IC SYSTEM '.
   483     12  TEXT-MESSAGES.
   484         16  UNACCESS-MSG    PIC X(29)
   485             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   486         16  PGMIDERR-MSG    PIC X(17)
   487             VALUE 'PROGRAM NOT FOUND'.
   488
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL637.cbl
   490*                            COPY ELCATTR.
   491******************************************************************
   492*                                                                *
   493*                            ELCATTR.                            *
   494*                            VMOD=2.001                          *
   495*                                                                *
   496*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   497*                                                                *
   498*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   499*                                                                *
   500*                   POS 1   P=PROTECTED                          *
   501*                           U=UNPROTECTED                        *
   502*                           S=ASKIP                              *
   503*                   POS 2   A=ALPHA/NUMERIC                      *
   504*                           N=NUMERIC                            *
   505*                   POS 3   N=NORMAL                             *
   506*                           B=BRIGHT                             *
   507*                           D=DARK                               *
   508*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   509*                           OF=MODIFIED DATA TAG OFF             *
   510*                                                                *
   511*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   512******************************************************************
   513 01  ATTRIBUTE-LIST.
   514     12  AL-PABOF            PIC X       VALUE 'Y'.
   515     12  AL-PABON            PIC X       VALUE 'Z'.
   516     12  AL-PADOF            PIC X       VALUE '%'.
   517     12  AL-PADON            PIC X       VALUE '_'.
   518     12  AL-PANOF            PIC X       VALUE '-'.
   519     12  AL-PANON            PIC X       VALUE '/'.
   520     12  AL-SABOF            PIC X       VALUE '8'.
   521     12  AL-SABON            PIC X       VALUE '9'.
   522     12  AL-SADOF            PIC X       VALUE '@'.
   523     12  AL-SADON            PIC X       VALUE QUOTE.
   524     12  AL-SANOF            PIC X       VALUE '0'.
   525     12  AL-SANON            PIC X       VALUE '1'.
   526     12  AL-UABOF            PIC X       VALUE 'H'.
   527     12  AL-UABON            PIC X       VALUE 'I'.
   528     12  AL-UADOF            PIC X       VALUE '<'.
   529     12  AL-UADON            PIC X       VALUE '('.
   530     12  AL-UANOF            PIC X       VALUE ' '.
   531     12  AL-UANON            PIC X       VALUE 'A'.
   532     12  AL-UNBOF            PIC X       VALUE 'Q'.
   533     12  AL-UNBON            PIC X       VALUE 'R'.
   534     12  AL-UNDOF            PIC X       VALUE '*'.
   535     12  AL-UNDON            PIC X       VALUE ')'.
   536     12  AL-UNNOF            PIC X       VALUE '&'.
   537     12  AL-UNNON            PIC X       VALUE 'J'.
   538
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL637.cbl
   540*                            COPY ELCEMIB.
   541******************************************************************
   542*                                                                *
   543*                                                                *
   544*                            ELCEMIB.                            *
   545*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   546*                            VMOD=2.005                          *
   547*                                                                *
   548*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   549*                                                                *
   550******************************************************************
   551 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   552     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   553     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   554     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   555     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   556     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   557     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   558     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   559     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   560     12  EMI-SWITCH1             PIC X        VALUE '1'.
   561         88  EMI-NO-ERRORS                    VALUE '1'.
   562         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   563         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   564     12  EMI-SWITCH2             PIC X        VALUE '1'.
   565         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   566     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   567         88  EMI-AREA1-EMPTY                  VALUE '1'.
   568         88  EMI-AREA1-FULL                   VALUE '2'.
   569     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   570         88  EMI-AREA2-EMPTY                  VALUE '1'.
   571         88  EMI-AREA2-FULL                   VALUE '2'.
   572     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   573         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   574         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   575         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   576         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   577         88  EMI-BYPASS-FATALS                VALUE 'X'.
   578     12  EMI-ERROR-LINES.
   579         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   580         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   581         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   582         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   583             20  EMI-ERR-CODES OCCURS 10 TIMES.
   584                 24  EMI-ERR-NUM         PIC X(4).
   585                 24  EMI-FILLER          PIC X.
   586                 24  EMI-SEV             PIC X.
   587                 24  FILLER              PIC X.
   588             20  FILLER                  PIC X(02).
   589     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   590         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   591             20  EMI-ERROR-NUMBER    PIC X(4).
   592             20  EMI-FILL            PIC X.
   593             20  EMI-SEVERITY        PIC X.
   594             20  FILLER              PIC X.
   595             20  EMI-ERROR-TEXT.
   596                 24  EMI-TEXT-VARIABLE   PIC X(10).
   597                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL637.cbl
   598     12  EMI-SEVERITY-SAVE           PIC X.
   599         88  EMI-NOTE                    VALUE 'N'.
   600         88  EMI-WARNING                 VALUE 'W'.
   601         88  EMI-FORCABLE                VALUE 'F'.
   602         88  EMI-FATAL                   VALUE 'X'.
   603     12  EMI-MESSAGE-FLAG            PIC X.
   604         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   605         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   606     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   607     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   608         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   609         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   610         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   611     12  FILLER                      PIC X(137)  VALUE SPACES.
   612     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   613     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   614     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   615     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   616
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL637.cbl
   618*                            COPY ELCINTF.
   619******************************************************************
   620*                                                                *
   621*                                                                *
   622*                            ELCINTF.                            *
   623*                            VMOD=2.017                          *
   624*                                                                *
   625*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   626*                                                                *
   627*       LENGTH = 1024                                            *
   628*                                                                *
   629******************************************************************
   630 01  PROGRAM-INTERFACE-BLOCK.
   631     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   632     12  PI-CALLING-PROGRAM              PIC X(8).
   633     12  PI-SAVED-PROGRAM-1              PIC X(8).
   634     12  PI-SAVED-PROGRAM-2              PIC X(8).
   635     12  PI-SAVED-PROGRAM-3              PIC X(8).
   636     12  PI-SAVED-PROGRAM-4              PIC X(8).
   637     12  PI-SAVED-PROGRAM-5              PIC X(8).
   638     12  PI-SAVED-PROGRAM-6              PIC X(8).
   639     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   640     12  PI-COMPANY-ID                   PIC XXX.
   641     12  PI-COMPANY-CD                   PIC X.
   642
   643     12  PI-COMPANY-PASSWORD             PIC X(8).
   644
   645     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   646
   647     12  PI-CONTROL-IN-PROGRESS.
   648         16  PI-CARRIER                  PIC X.
   649         16  PI-GROUPING                 PIC X(6).
   650         16  PI-STATE                    PIC XX.
   651         16  PI-ACCOUNT                  PIC X(10).
   652         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   653                                         PIC X(10).
   654         16  PI-CLAIM-CERT-GRP.
   655             20  PI-CLAIM-NO             PIC X(7).
   656             20  PI-CERT-NO.
   657                 25  PI-CERT-PRIME       PIC X(10).
   658                 25  PI-CERT-SFX         PIC X.
   659             20  PI-CERT-EFF-DT          PIC XX.
   660         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   661             20  PI-PLAN-CODE            PIC X(2).
   662             20  PI-REVISION-NUMBER      PIC X(3).
   663             20  PI-PLAN-EFF-DT          PIC X(2).
   664             20  PI-PLAN-EXP-DT          PIC X(2).
   665             20  FILLER                  PIC X(11).
   666         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   667             20  PI-OE-REFERENCE-1.
   668                 25  PI-OE-REF-1-PRIME   PIC X(18).
   669                 25  PI-OE-REF-1-SUFF    PIC XX.
   670
   671     12  PI-SESSION-IN-PROGRESS          PIC X.
   672         88  CLAIM-SESSION                   VALUE '1'.
   673         88  CREDIT-SESSION                  VALUE '2'.
   674         88  WARRANTY-SESSION                VALUE '3'.
   675         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL637.cbl
   676         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   677
   678
   679*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   680
   681     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   682     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   683
   684     12  PI-CREDIT-USER                  PIC X.
   685         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   686         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   687
   688     12  PI-CLAIM-USER                   PIC X.
   689         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   690         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   691
   692     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   693         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   694         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   695         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   696         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   697         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   698
   699     12  PI-PROCESSOR-ID                 PIC X(4).
   700
   701     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   702
   703     12  PI-MEMBER-CAPTION               PIC X(10).
   704
   705     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   706         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   707
   708     12  PI-LIFE-OVERRIDE-L1             PIC X.
   709     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   710     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   711     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   712
   713     12  PI-AH-OVERRIDE-L1               PIC X.
   714     12  PI-AH-OVERRIDE-L2               PIC XX.
   715     12  PI-AH-OVERRIDE-L6               PIC X(6).
   716     12  PI-AH-OVERRIDE-L12              PIC X(12).
   717
   718     12  PI-NEW-SYSTEM                   PIC X(2).
   719
   720     12  PI-PRIMARY-CERT-NO              PIC X(11).
   721     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   722         88  PI-USES-PAID-TO                 VALUE '1'.
   723     12  PI-CRDTCRD-SYSTEM.
   724         16  PI-CRDTCRD-USER             PIC X.
   725             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   726             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   727         16  PI-CC-MONTH-END-DT          PIC XX.
   728     12  PI-PROCESSOR-PRINTER            PIC X(4).
   729
   730     12  PI-OE-REFERENCE-2.
   731         16  PI-OE-REF-2-PRIME           PIC X(10).
   732         16  PI-OE-REF-2-SUFF            PIC X.
   733
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL637.cbl
   734     12  PI-REM-TRM-CALC-OPTION          PIC X.
   735
   736     12  PI-LANGUAGE-TYPE                PIC X.
   737             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   738             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   739             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   740
   741     12  PI-POLICY-LINKAGE-IND           PIC X.
   742         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   743         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   744                                                   LOW-VALUES.
   745
   746     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   747     12  PI-CLAIM-PW-SESSION             PIC X(1).
   748         88  PI-CLAIM-CREDIT                 VALUE '1'.
   749         88  PI-CLAIM-CONVEN                 VALUE '2'.
   750     12  FILLER                          PIC X(4).
   751
   752     12  PI-SYSTEM-LEVEL                 PIC X(145).
   753
   754     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   755         PI-SYSTEM-LEVEL.
   756
   757         16  PI-ENTRY-CODES.
   758             20  PI-ENTRY-CD-1           PIC X.
   759             20  PI-ENTRY-CD-2           PIC X.
   760
   761         16  PI-RETURN-CODES.
   762             20  PI-RETURN-CD-1          PIC X.
   763             20  PI-RETURN-CD-2          PIC X.
   764
   765         16  PI-UPDATE-STATUS-SAVE.
   766             20  PI-UPDATE-BY            PIC X(4).
   767             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   768
   769         16  PI-LOWER-CASE-LETTERS       PIC X.
   770             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   771
   772*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   773*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   774*            88  CARRIER-CLM-CNTL            VALUE '2'.
   775
   776         16  PI-CERT-ACCESS-CONTROL      PIC X.
   777             88  ST-ACCNT-CNTL               VALUE ' '.
   778             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   779             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   780             88  ACCNT-CNTL                  VALUE '3'.
   781             88  CARR-ACCNT-CNTL             VALUE '4'.
   782
   783         16  PI-PROCESSOR-CAP-LIST.
   784             20  PI-SYSTEM-CONTROLS.
   785                24 PI-SYSTEM-DISPLAY     PIC X.
   786                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   787                24 PI-SYSTEM-MODIFY      PIC X.
   788                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   789             20  FILLER                  PIC XX.
   790             20  PI-DISPLAY-CAP          PIC X.
   791                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL637.cbl
   792             20  PI-MODIFY-CAP           PIC X.
   793                 88  MODIFY-CAP              VALUE 'Y'.
   794             20  PI-MSG-AT-LOGON-CAP     PIC X.
   795                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   796             20  PI-FORCE-CAP            PIC X.
   797                 88  FORCE-CAP               VALUE 'Y'.
   798
   799         16  PI-PROGRAM-CONTROLS.
   800             20  PI-PGM-PRINT-OPT        PIC X.
   801             20  PI-PGM-FORMAT-OPT       PIC X.
   802             20  PI-PGM-PROCESS-OPT      PIC X.
   803             20  PI-PGM-TOTALS-OPT       PIC X.
   804
   805         16  PI-HELP-INTERFACE.
   806             20  PI-LAST-ERROR-NO        PIC X(4).
   807             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   808
   809         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   810             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   811
   812         16  PI-CR-CONTROL-IN-PROGRESS.
   813             20  PI-CR-CARRIER           PIC X.
   814             20  PI-CR-GROUPING          PIC X(6).
   815             20  PI-CR-STATE             PIC XX.
   816             20  PI-CR-ACCOUNT           PIC X(10).
   817             20  PI-CR-FIN-RESP          PIC X(10).
   818             20  PI-CR-TYPE              PIC X.
   819
   820         16  PI-CR-BATCH-NUMBER          PIC X(6).
   821
   822         16  PI-CR-MONTH-END-DT          PIC XX.
   823
   824         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   825             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   826             88  PI-ZERO-CARRIER             VALUE '1'.
   827             88  PI-ZERO-GROUPING            VALUE '2'.
   828             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   829
   830         16  PI-CARRIER-SECURITY         PIC X.
   831             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   832
   833         16  PI-ACCOUNT-SECURITY         PIC X(10).
   834             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   835             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   836
   837         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   838             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   839                                         INDEXED BY PI-ACCESS-NDX
   840                                         PIC X.
   841
   842         16  PI-GA-BILLING-CONTROL       PIC X.
   843             88  PI-GA-BILLING               VALUE '1'.
   844
   845         16  PI-MAIL-PROCESSING          PIC X.
   846             88  PI-MAIL-YES                 VALUE 'Y'.
   847
   848         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   849
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL637.cbl
   850         16  PI-AR-SYSTEM.
   851             20  PI-AR-PROCESSING-CNTL   PIC X.
   852                 88  PI-AR-PROCESSING        VALUE 'Y'.
   853             20  PI-AR-SUMMARY-CODE      PIC X(6).
   854             20  PI-AR-MONTH-END-DT      PIC XX.
   855
   856         16  PI-MP-SYSTEM.
   857             20  PI-MORTGAGE-USER            PIC X.
   858                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   859                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   860             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   861                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   862                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   863                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   864                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   865                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   866             20  PI-MP-MONTH-END-DT          PIC XX.
   867             20  PI-MP-REFERENCE-NO.
   868                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   869                 24  PI-MP-REFERENCE-SFX     PIC XX.
   870
   871         16  PI-LABEL-CONTROL            PIC X(01).
   872             88  PI-CREATE-LABELS                    VALUE 'Y'.
   873             88  PI-BYPASS-LABELS                    VALUE 'N'.
   874
   875         16  PI-BILL-GROUPING-CODE       PIC X(01).
   876             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   877
   878         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   879             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   880             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   881
   882         16  FILLER                      PIC X(14).
   883
   884     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   885******************************************************************
   886
   887     12  FILLER  REDEFINES PI-PROGRAM-WORK-AREA.
   888         16  PI-MAINT-FUNCTION               PIC X.
   889             88  PI-VOID-FUNCTION                VALUE 'V'.
   890             88  PI-SHOW-FUNCTION                VALUE 'S'.
   891
   892         16  PI-END-OF-FILE-SW               PIC X.
   893             88  PI-END-OF-FILE                  VALUE 'Y'.
   894         16  PI-ERCMKQ2-KEY.
   895             20  PI-ERCMKQ2-COMPANY-CD       PIC X.
   896             20  PI-ERCMKQ2-CSR              PIC X(4).
   897             20  PI-ERCMKQ2-CARRIER          PIC X.
   898             20  PI-ERCMKQ2-GROUPING         PIC X(6).
   899             20  PI-ERCMKQ2-PAYEE            PIC X(10).
   900             20  PI-ERCMKQ2-PAYEE-SEQ        PIC S9(4) COMP.
   901             20  PI-ERCMKQ2-CONTROL-NUMBER   PIC S9(8) COMP.
   902             20  PI-ERCMKQ2-SEQUENCE-NUMBER  PIC S9(4) COMP.
   903
   904         16  PI-SAVE-ERCMKQ2-KEY.
   905             20  PI-SVCMKQ2-COMPANY-CD       PIC X.
   906             20  PI-SVCMKQ2-CSR              PIC X(4).
   907             20  PI-SVCMKQ2-CARRIER          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL637.cbl
   908             20  PI-SVCMKQ2-GROUPING         PIC X(6).
   909             20  PI-SVCMKQ2-PAYEE            PIC X(10).
   910             20  PI-SVCMKQ2-PAYEE-SEQ        PIC S9(4) COMP.
   911             20  PI-SVCMKQ2-CONTROL-NUMBER   PIC S9(8) COMP.
   912             20  PI-SVCMKQ2-SEQUENCE-NUMBER  PIC S9(4) COMP.
   913         16  FILLER                          PIC X(578).
   914
   915
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL637.cbl
   917*                            COPY ELCJPFX.
   918******************************************************************
   919*                                                                *
   920*                                                                *
   921*                            ELCJPFX.                            *
   922*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   923*                            VMOD=2.002                          *
   924*                                                                *
   925*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   926*                                                                *
   927*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   928*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   929*        ELCNTL - CONTROL FILE                                   *
   930*        ELMSTR - CLAIM MASTERS                                  *
   931*        ELTRLR - ACTIVITY TRAILERS                              *
   932*        ELCHKQ - CHECK QUE                                      *
   933******************************************************************
   934 01  JOURNAL-RECORD.
   935     12  JP-USER-ID                  PIC X(4).
   936     12  JP-FILE-ID                  PIC X(8).
   937     12  JP-PROGRAM-ID               PIC X(8).
   938     12  JP-RECORD-TYPE              PIC X.
   939         88 JP-ADD              VALUE 'A'.
   940         88 JP-BEFORE-CHANGE    VALUE 'B'.
   941         88 JP-AFTER-CHANGE     VALUE 'C'.
   942         88 JP-DELETE           VALUE 'D'.
   943         88 JP-GENERIC-DELETE   VALUE 'G'.
   944         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   945         88 JP-KEY-CHG-ADD      VALUE 'N'.
   946     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   947     12  JP-RECORD-AREA
   948
   949
   950                             PIC X(1583).
   951
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL637.cbl
   953*                            COPY ELCAID.
   954******************************************************************
   955*                                                                *
   956*                            ELCAID.                             *
   957*                            VMOD=2.001                          *
   958*                                                                *
   959*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   960*                                                                *
   961*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   962*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   963******************************************************************
   964
   965 01  DFHAID.
   966   02  DFHNULL   PIC  X  VALUE  ' '.
   967   02  DFHENTER  PIC  X  VALUE  QUOTE.
   968   02  DFHCLEAR  PIC  X  VALUE  '_'.
   969   02  DFHPEN    PIC  X  VALUE  '='.
   970   02  DFHOPID   PIC  X  VALUE  'W'.
   971   02  DFHPA1    PIC  X  VALUE  '%'.
   972   02  DFHPA2    PIC  X  VALUE  '>'.
   973   02  DFHPA3    PIC  X  VALUE  ','.
   974   02  DFHPF1    PIC  X  VALUE  '1'.
   975   02  DFHPF2    PIC  X  VALUE  '2'.
   976   02  DFHPF3    PIC  X  VALUE  '3'.
   977   02  DFHPF4    PIC  X  VALUE  '4'.
   978   02  DFHPF5    PIC  X  VALUE  '5'.
   979   02  DFHPF6    PIC  X  VALUE  '6'.
   980   02  DFHPF7    PIC  X  VALUE  '7'.
   981   02  DFHPF8    PIC  X  VALUE  '8'.
   982   02  DFHPF9    PIC  X  VALUE  '9'.
   983   02  DFHPF10   PIC  X  VALUE  ':'.
   984   02  DFHPF11   PIC  X  VALUE  '#'.
   985   02  DFHPF12   PIC  X  VALUE  '@'.
   986   02  DFHPF13   PIC  X  VALUE  'A'.
   987   02  DFHPF14   PIC  X  VALUE  'B'.
   988   02  DFHPF15   PIC  X  VALUE  'C'.
   989   02  DFHPF16   PIC  X  VALUE  'D'.
   990   02  DFHPF17   PIC  X  VALUE  'E'.
   991   02  DFHPF18   PIC  X  VALUE  'F'.
   992   02  DFHPF19   PIC  X  VALUE  'G'.
   993   02  DFHPF20   PIC  X  VALUE  'H'.
   994   02  DFHPF21   PIC  X  VALUE  'I'.
   995*00039    02  DFHPF22   PIC  X  VALUE  ''.
   996   02  DFHPF22   PIC  X  VALUE  '['.
   997   02  DFHPF23   PIC  X  VALUE  '.'.
   998   02  DFHPF24   PIC  X  VALUE  '<'.
   999   02  DFHMSRE   PIC  X  VALUE  'X'.
  1000   02  DFHSTRF   PIC  X  VALUE  'h'.
  1001   02  DFHTRIG   PIC  X  VALUE  '"'.
  1002 01  FILLER    REDEFINES DFHAID.
  1003     12  FILLER              PIC X(8).
  1004     12  PF-VALUES           PIC X       OCCURS 2.
  1005
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL637.cbl
  1007*                            COPY EL637S.
  1008 01  EL637AI.
  1009     05  FILLER            PIC  X(0012).
  1010*    -------------------------------
  1011     05  DATEL PIC S9(0004) COMP.
  1012     05  DATEF PIC  X(0001).
  1013     05  FILLER REDEFINES DATEF.
  1014         10  DATEA PIC  X(0001).
  1015     05  DATEI PIC  X(0008).
  1016*    -------------------------------
  1017     05  TIMEL PIC S9(0004) COMP.
  1018     05  TIMEF PIC  X(0001).
  1019     05  FILLER REDEFINES TIMEF.
  1020         10  TIMEA PIC  X(0001).
  1021     05  TIMEI PIC  X(0005).
  1022*    -------------------------------
  1023     05  MAINTL PIC S9(0004) COMP.
  1024     05  MAINTF PIC  X(0001).
  1025     05  FILLER REDEFINES MAINTF.
  1026         10  MAINTA PIC  X(0001).
  1027     05  MAINTI PIC  X(0001).
  1028*    -------------------------------
  1029     05  CSRL PIC S9(0004) COMP.
  1030     05  CSRF PIC  X(0001).
  1031     05  FILLER REDEFINES CSRF.
  1032         10  CSRA PIC  X(0001).
  1033     05  CSRI PIC  X(0004).
  1034*    -------------------------------
  1035     05  CARL PIC S9(0004) COMP.
  1036     05  CARF PIC  X(0001).
  1037     05  FILLER REDEFINES CARF.
  1038         10  CARA PIC  X(0001).
  1039     05  CARI PIC  X(0001).
  1040*    -------------------------------
  1041     05  GROUPL PIC S9(0004) COMP.
  1042     05  GROUPF PIC  X(0001).
  1043     05  FILLER REDEFINES GROUPF.
  1044         10  GROUPA PIC  X(0001).
  1045     05  GROUPI PIC  X(0006).
  1046*    -------------------------------
  1047     05  PAYEEL PIC S9(0004) COMP.
  1048     05  PAYEEF PIC  X(0001).
  1049     05  FILLER REDEFINES PAYEEF.
  1050         10  PAYEEA PIC  X(0001).
  1051     05  PAYEEI PIC  X(0010).
  1052*    -------------------------------
  1053     05  PAYSEQL PIC S9(0004) COMP.
  1054     05  PAYSEQF PIC  X(0001).
  1055     05  FILLER REDEFINES PAYSEQF.
  1056         10  PAYSEQA PIC  X(0001).
  1057     05  PAYSEQI PIC  9(4).
  1058*    -------------------------------
  1059     05  CNTRLNOL PIC S9(0004) COMP.
  1060     05  CNTRLNOF PIC  X(0001).
  1061     05  FILLER REDEFINES CNTRLNOF.
  1062         10  CNTRLNOA PIC  X(0001).
  1063     05  CNTRLNOI PIC  9(8).
  1064*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL637.cbl
  1065     05  PAYTOL PIC S9(0004) COMP.
  1066     05  PAYTOF PIC  X(0001).
  1067     05  FILLER REDEFINES PAYTOF.
  1068         10  PAYTOA PIC  X(0001).
  1069     05  PAYTOI PIC  X(0030).
  1070*    -------------------------------
  1071     05  MAINTBYL PIC S9(0004) COMP.
  1072     05  MAINTBYF PIC  X(0001).
  1073     05  FILLER REDEFINES MAINTBYF.
  1074         10  MAINTBYA PIC  X(0001).
  1075     05  MAINTBYI PIC  X(0004).
  1076*    -------------------------------
  1077     05  ADDRS1L PIC S9(0004) COMP.
  1078     05  ADDRS1F PIC  X(0001).
  1079     05  FILLER REDEFINES ADDRS1F.
  1080         10  ADDRS1A PIC  X(0001).
  1081     05  ADDRS1I PIC  X(0030).
  1082*    -------------------------------
  1083     05  MAINTATL PIC S9(0004) COMP.
  1084     05  MAINTATF PIC  X(0001).
  1085     05  FILLER REDEFINES MAINTATF.
  1086         10  MAINTATA PIC  X(0001).
  1087     05  MAINTATI PIC  X(0005).
  1088*    -------------------------------
  1089     05  MAINTONL PIC S9(0004) COMP.
  1090     05  MAINTONF PIC  X(0001).
  1091     05  FILLER REDEFINES MAINTONF.
  1092         10  MAINTONA PIC  X(0001).
  1093     05  MAINTONI PIC  X(0008).
  1094*    -------------------------------
  1095     05  ADDRS2L PIC S9(0004) COMP.
  1096     05  ADDRS2F PIC  X(0001).
  1097     05  FILLER REDEFINES ADDRS2F.
  1098         10  ADDRS2A PIC  X(0001).
  1099     05  ADDRS2I PIC  X(0030).
  1100*    -------------------------------
  1101     05  CITYSTL PIC S9(0004) COMP.
  1102     05  CITYSTF PIC  X(0001).
  1103     05  FILLER REDEFINES CITYSTF.
  1104         10  CITYSTA PIC  X(0001).
  1105     05  CITYSTI PIC  X(0030).
  1106*    -------------------------------
  1107     05  CHKRELL PIC S9(0004) COMP.
  1108     05  CHKRELF PIC  X(0001).
  1109     05  FILLER REDEFINES CHKRELF.
  1110         10  CHKRELA PIC  X(0001).
  1111     05  CHKRELI PIC  X(0008).
  1112*    -------------------------------
  1113     05  ZIPL PIC S9(0004) COMP.
  1114     05  ZIPF PIC  X(0001).
  1115     05  FILLER REDEFINES ZIPF.
  1116         10  ZIPA PIC  X(0001).
  1117     05  ZIPI PIC  X(0005).
  1118*    -------------------------------
  1119     05  ZIPEXTL PIC S9(0004) COMP.
  1120     05  ZIPEXTF PIC  X(0001).
  1121     05  FILLER REDEFINES ZIPEXTF.
  1122         10  ZIPEXTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL637.cbl
  1123     05  ZIPEXTI PIC  X(0004).
  1124*    -------------------------------
  1125     05  CHKWRTNL PIC S9(0004) COMP.
  1126     05  CHKWRTNF PIC  X(0001).
  1127     05  FILLER REDEFINES CHKWRTNF.
  1128         10  CHKWRTNA PIC  X(0001).
  1129     05  CHKWRTNI PIC  X(0008).
  1130*    -------------------------------
  1131     05  VOIDDTL PIC S9(0004) COMP.
  1132     05  VOIDDTF PIC  X(0001).
  1133     05  FILLER REDEFINES VOIDDTF.
  1134         10  VOIDDTA PIC  X(0001).
  1135     05  VOIDDTI PIC  X(0008).
  1136*    -------------------------------
  1137     05  CHKAMTL PIC S9(0004) COMP.
  1138     05  CHKAMTF PIC  X(0001).
  1139     05  FILLER REDEFINES CHKAMTF.
  1140         10  CHKAMTA PIC  X(0001).
  1141     05  CHKAMTI PIC  X(0013).
  1142*    -------------------------------
  1143     05  STRTCHKL PIC S9(0004) COMP.
  1144     05  STRTCHKF PIC  X(0001).
  1145     05  FILLER REDEFINES STRTCHKF.
  1146         10  STRTCHKA PIC  X(0001).
  1147     05  STRTCHKI PIC  X(0006).
  1148*    -------------------------------
  1149     05  DASHL PIC S9(0004) COMP.
  1150     05  DASHF PIC  X(0001).
  1151     05  FILLER REDEFINES DASHF.
  1152         10  DASHA PIC  X(0001).
  1153     05  DASHI PIC  X(0001).
  1154*    -------------------------------
  1155     05  ENDCHKL PIC S9(0004) COMP.
  1156     05  ENDCHKF PIC  X(0001).
  1157     05  FILLER REDEFINES ENDCHKF.
  1158         10  ENDCHKA PIC  X(0001).
  1159     05  ENDCHKI PIC  X(0006).
  1160*    -------------------------------
  1161     05  ERMESGL PIC S9(0004) COMP.
  1162     05  ERMESGF PIC  X(0001).
  1163     05  FILLER REDEFINES ERMESGF.
  1164         10  ERMESGA PIC  X(0001).
  1165     05  ERMESGI PIC  X(0079).
  1166*    -------------------------------
  1167     05  PFENTERL PIC S9(0004) COMP.
  1168     05  PFENTERF PIC  X(0001).
  1169     05  FILLER REDEFINES PFENTERF.
  1170         10  PFENTERA PIC  X(0001).
  1171     05  PFENTERI PIC  9(2).
  1172 01  EL637AO REDEFINES EL637AI.
  1173     05  FILLER            PIC  X(0012).
  1174*    -------------------------------
  1175     05  FILLER            PIC  X(0003).
  1176     05  DATEO PIC  X(0008).
  1177*    -------------------------------
  1178     05  FILLER            PIC  X(0003).
  1179     05  TIMEO PIC  99.99.
  1180*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL637.cbl
  1181     05  FILLER            PIC  X(0003).
  1182     05  MAINTO PIC  X(0001).
  1183*    -------------------------------
  1184     05  FILLER            PIC  X(0003).
  1185     05  CSRO PIC  X(0004).
  1186*    -------------------------------
  1187     05  FILLER            PIC  X(0003).
  1188     05  CARO PIC  X(0001).
  1189*    -------------------------------
  1190     05  FILLER            PIC  X(0003).
  1191     05  GROUPO PIC  X(0006).
  1192*    -------------------------------
  1193     05  FILLER            PIC  X(0003).
  1194     05  PAYEEO PIC  X(0010).
  1195*    -------------------------------
  1196     05  FILLER            PIC  X(0003).
  1197     05  PAYSEQO PIC  9(4).
  1198*    -------------------------------
  1199     05  FILLER            PIC  X(0003).
  1200     05  CNTRLNOO PIC  9(8).
  1201*    -------------------------------
  1202     05  FILLER            PIC  X(0003).
  1203     05  PAYTOO PIC  X(0030).
  1204*    -------------------------------
  1205     05  FILLER            PIC  X(0003).
  1206     05  MAINTBYO PIC  X(0004).
  1207*    -------------------------------
  1208     05  FILLER            PIC  X(0003).
  1209     05  ADDRS1O PIC  X(0030).
  1210*    -------------------------------
  1211     05  FILLER            PIC  X(0003).
  1212     05  MAINTATO PIC  99.99.
  1213*    -------------------------------
  1214     05  FILLER            PIC  X(0003).
  1215     05  MAINTONO PIC  X(0008).
  1216*    -------------------------------
  1217     05  FILLER            PIC  X(0003).
  1218     05  ADDRS2O PIC  X(0030).
  1219*    -------------------------------
  1220     05  FILLER            PIC  X(0003).
  1221     05  CITYSTO PIC  X(0030).
  1222*    -------------------------------
  1223     05  FILLER            PIC  X(0003).
  1224     05  CHKRELO PIC  X(0008).
  1225*    -------------------------------
  1226     05  FILLER            PIC  X(0003).
  1227     05  ZIPO PIC  X(0005).
  1228*    -------------------------------
  1229     05  FILLER            PIC  X(0003).
  1230     05  ZIPEXTO PIC  X(0004).
  1231*    -------------------------------
  1232     05  FILLER            PIC  X(0003).
  1233     05  CHKWRTNO PIC  X(0008).
  1234*    -------------------------------
  1235     05  FILLER            PIC  X(0003).
  1236     05  VOIDDTO PIC  X(0008).
  1237*    -------------------------------
  1238     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL637.cbl
  1239     05  CHKAMTO PIC  Z,ZZZ,ZZZ.99-.
  1240*    -------------------------------
  1241     05  FILLER            PIC  X(0003).
  1242     05  STRTCHKO PIC  X(0006).
  1243*    -------------------------------
  1244     05  FILLER            PIC  X(0003).
  1245     05  DASHO PIC  X(0001).
  1246*    -------------------------------
  1247     05  FILLER            PIC  X(0003).
  1248     05  ENDCHKO PIC  X(0006).
  1249*    -------------------------------
  1250     05  FILLER            PIC  X(0003).
  1251     05  ERMESGO PIC  X(0079).
  1252*    -------------------------------
  1253     05  FILLER            PIC  X(0003).
  1254     05  PFENTERO PIC  X(0002).
  1255*    -------------------------------
  1256
  1257
  1258
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL637.cbl
  1260****************************************************************
  1261*
  1262* Copyright (c) 2007 by Clerity Solutions, Inc.
  1263* All rights reserved.
  1264*
  1265****************************************************************
  1266 01  DFHEIV.
  1267   02  DFHEIV0               PIC X(35).
  1268   02  DFHEIV1               PIC X(08).
  1269   02  DFHEIV2               PIC X(08).
  1270   02  DFHEIV3               PIC X(08).
  1271   02  DFHEIV4               PIC X(06).
  1272   02  DFHEIV5               PIC X(04).
  1273   02  DFHEIV6               PIC X(04).
  1274   02  DFHEIV7               PIC X(02).
  1275   02  DFHEIV8               PIC X(02).
  1276   02  DFHEIV9               PIC X(01).
  1277   02  DFHEIV10              PIC S9(7) COMP-3.
  1278   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1279   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1280   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1281   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1282   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1283   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1284   02  DFHEIV17              PIC X(04).
  1285   02  DFHEIV18              PIC X(04).
  1286   02  DFHEIV19              PIC X(04).
  1287   02  DFHEIV20              USAGE IS POINTER.
  1288   02  DFHEIV21              USAGE IS POINTER.
  1289   02  DFHEIV22              USAGE IS POINTER.
  1290   02  DFHEIV23              USAGE IS POINTER.
  1291   02  DFHEIV24              USAGE IS POINTER.
  1292   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1293   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1294   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1295   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1296   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1297   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1298   02  FILLER                PIC X(02).
  1299   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1300   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1301   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1302   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1303   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1304 LINKAGE  SECTION.
  1305*****************************************************************
  1306*                                                               *
  1307* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1308* All rights reserved.                                          *
  1309*                                                               *
  1310*****************************************************************
  1311 01  dfheiblk.
  1312     02  eibtime          pic s9(7) comp-3.
  1313     02  eibdate          pic s9(7) comp-3.
  1314     02  eibtrnid         pic x(4).
  1315     02  eibtaskn         pic s9(7) comp-3.
  1316     02  eibtrmid         pic x(4).
  1317     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL637.cbl
  1318     02  eibcposn         pic s9(4) comp.
  1319     02  eibcalen         pic s9(4) comp.
  1320     02  eibaid           pic x(1).
  1321     02  eibfiller1       pic x(1).
  1322     02  eibfn            pic x(2).
  1323     02  eibfiller2       pic x(2).
  1324     02  eibrcode         pic x(6).
  1325     02  eibfiller3       pic x(2).
  1326     02  eibds            pic x(8).
  1327     02  eibreqid         pic x(8).
  1328     02  eibrsrce         pic x(8).
  1329     02  eibsync          pic x(1).
  1330     02  eibfree          pic x(1).
  1331     02  eibrecv          pic x(1).
  1332     02  eibsend          pic x(1).
  1333     02  eibatt           pic x(1).
  1334     02  eibeoc           pic x(1).
  1335     02  eibfmh           pic x(1).
  1336     02  eibcompl         pic x(1).
  1337     02  eibsig           pic x(1).
  1338     02  eibconf          pic x(1).
  1339     02  eiberr           pic x(1).
  1340     02  eibrldbk         pic x(1).
  1341     02  eiberrcd         pic x(4).
  1342     02  eibsynrb         pic x(1).
  1343     02  eibnodat         pic x(1).
  1344     02  eibfiller5       pic x(2).
  1345     02  eibresp          pic 9(09) comp.
  1346     02  eibresp2         pic 9(09) comp.
  1347     02  dfheigdj         pic s9(4) comp.
  1348     02  dfheigdk         pic s9(4) comp.
  1349 01  DFHCOMMAREA             PIC X(1024).
  1350
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL637.cbl
  1352*01 PARMLIST .
  1353*    02  FILLER              PIC S9(8)   COMP.
  1354*    02  ERCKWK-POINTER      PIC S9(8)   COMP.
  1355*    02  ERCMCK-POINTER      PIC S9(8)   COMP.
  1356*    02  ERCMKQ-POINTER      PIC S9(8)   COMP.
  1357*    02  ERPYAJ-POINTER      PIC S9(8)   COMP.
  1358
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL637.cbl
  1360
  1361*                                COPY ERCCKWK.
  1362******************************************************************
  1363*                                                                *
  1364*                                                                *
  1365*                            ERCCKWK                             *
  1366*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1367*                            VMOD=2.011                          *
  1368*                                                                *
  1369*   FILE DESCRIPTION = CHECK WORK RECORDS                        *
  1370*                                                                *
  1371*   FILE TYPE = VSAM,KSDS                                        *
  1372*   RECORD SIZE = 200    RECFORM = FIXED                         *
  1373*                                                                *
  1374*   BASE CLUSTER NAME = ERCKWK             RKP=2,LEN=26          *
  1375*       ALTERNATE INDEX = NONE                                   *
  1376*                                                                *
  1377*   LOG = YES                                                    *
  1378*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1379******************************************************************
  1380 01  CHECK-WORK-RECORDS.
  1381     12  CW-RECORD-ID                      PIC XX.
  1382         88  VALID-CW-ID                      VALUE 'CW'.
  1383
  1384     12  CW-CONTROL-PRIMARY.
  1385         16  CW-COMPANY-CD                 PIC X.
  1386         16  CW-CSR                        PIC X(4).
  1387         16  CW-CARRIER                    PIC X.
  1388         16  CW-GROUPING                   PIC X(6).
  1389         16  CW-PAYEE                      PIC X(10).
  1390         16  CW-PAYEE-SEQ                  PIC S9(4)     COMP.
  1391         16  CW-SEQUENCE-NO                PIC S9(4)     COMP.
  1392
  1393     12  CW-RECORD-TYPE                    PIC X.
  1394         88 CW-HEADER                            VALUE '0'.
  1395         88 CW-DETAIL                            VALUE '1'.
  1396         88 CW-TEXT                              VALUE '2'.
  1397
  1398     12  CW-RECORDED-DT                    PIC XX.
  1399     12  CW-RECORDED-BY                    PIC X(4).
  1400     12  CW-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  1401
  1402     12  CW-RELEASE-DT                     PIC XX.
  1403
  1404     12  CW-HEADER-RECORD.
  1405         16  CW-PAYEE-NAME                 PIC X(30).
  1406         16  CW-ADDRESS-1                  PIC X(30).
  1407         16  CW-ADDRESS-2                  PIC X(30).
  1408         16  CW-PAYEE-CITY-ST              PIC X(30).
  1409         16  CW-PAYEE-ZIP-CODE.
  1410             20  CW-PAYEE-ZIP              PIC X(5).
  1411             20  CW-PAYEE-ZIP-EXT          PIC X(4).
  1412         16  CW-TOTAL-COMMISSION           PIC S9(7)V99   COMP-3.
  1413         16  CW-TOTAL-ENTRIES              PIC S9(3)      COMP-3.
  1414
  1415     12  CW-DETAIL-RECORD REDEFINES CW-HEADER-RECORD.
  1416         16  CW-COMMENT                    PIC X(23).
  1417         16  CW-ACCT-AGENT                 PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL637.cbl
  1418         16  CW-INVOICE                    PIC X(6).
  1419         16  CW-REFERENCE                  PIC X(12).
  1420         16  CW-LEDGER-NO.
  1421             20  CW-LEDGER-PREFIX          PIC X(7).
  1422             20  CW-LEDGER-SUFFIX          PIC X(7).
  1423         16  CW-DETAIL-AMOUNT              PIC S9(7)V99  COMP-3.
  1424         16  CW-PAYMENT-TYPE               PIC X.
  1425         16  CW-LAST-MAINT-APPLIED         PIC X.
  1426         16  CW-NON-AR-ITEM                PIC X.
  1427         16  FILLER                        PIC X(63).
  1428
  1429     12  CW-TEXT-RECORD REDEFINES CW-HEADER-RECORD.
  1430         16  CW-STUB-TEXT                  PIC X(70).
  1431         16  CW-FILLER                     PIC X(66).
  1432
  1433     12  CW-CREDIT-SELECT-DT               PIC XX.
  1434     12  CW-CREDIT-ACCEPT-DT               PIC XX.
  1435
  1436     12  CW-AR-STATEMENT-DT                PIC XX.
  1437     12  CW-PMT-APPLIED                    PIC X.
  1438
  1439     12  CW-PYAJ-MADE                      PIC X.
  1440
  1441     12  FILLER                            PIC X(15).
  1442
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL637.cbl
  1444
  1445*                                COPY ERCCMCK.
  1446******************************************************************
  1447*                                                                *
  1448*                                                                *
  1449*                            ERCCMCK                             *
  1450*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1451*                            VMOD=2.012                          *
  1452*                                                                *
  1453*   FILE DESCRIPTION = COMMISSION CHECK RECORDS                  *
  1454*                                                                *
  1455*   FILE TYPE = VSAM,KSDS                                        *
  1456*   RECORD SIZE = 2000   RECFORM = FIXED                         *
  1457*                                                                *
  1458*   BASE CLUSTER NAME = ERCMCK             RKP=2,LEN=26          *
  1459*       ALTERNATE INDEX = NONE                                   *
  1460*                                                                *
  1461*   LOG = NO                                                     *
  1462*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1463******************************************************************
  1464 01  COMM-CHECK-RECORDS.
  1465     12  CK-RECORD-ID                      PIC XX.
  1466         88  VALID-CK-ID                      VALUE 'CK'.
  1467
  1468     12  CK-CONTROL-PRIMARY.
  1469         16  CK-COMPANY-CD                 PIC X.
  1470         16  CK-CSR                        PIC X(4).
  1471         16  CK-CARRIER                    PIC X.
  1472         16  CK-GROUPING                   PIC X(6).
  1473         16  CK-PAYEE                      PIC X(10).
  1474         16  CK-PAYEE-SEQ                  PIC S9(4)     COMP.
  1475         16  CK-SEQUENCE-NO                PIC S9(4)     COMP.
  1476
  1477     12  CK-RECORDED-DT                    PIC XX.
  1478     12  CK-RECORDED-BY                    PIC X(4).
  1479     12  CK-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  1480
  1481     12  CK-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  1482     12  CK-RECORD-TYPE                    PIC X.
  1483         88  CK-DETAIL                        VALUE 'D'.
  1484         88  CK-TEXT                          VALUE 'T'.
  1485     12  CK-CHECK-NO                       PIC X(6).
  1486     12  CK-CHECK-WRITTEN-DT               PIC XX.
  1487     12  CK-PAYEE-INFO.
  1488         16  CK-PAYEE-NAME                 PIC X(30).
  1489         16  CK-PAYEE-ADDRESS-1            PIC X(30).
  1490         16  CK-PAYEE-ADDRESS-2            PIC X(30).
  1491         16  CK-PAYEE-CITY-ST              PIC X(30).
  1492         16  CK-PAYEE-ZIP-CODE.
  1493             20  CK-PAYEE-ZIP              PIC X(5).
  1494             20  CK-PAYEE-ZIP-EXT          PIC X(4).
  1495
  1496     12  CK-CHECK-STUB-DATA.
  1497         16  CK-CHECK-STUB-INFO  OCCURS  15  TIMES.
  1498             20  CK-STUB-LINE.
  1499                 24  CK-STUB-COMMENT       PIC X(23).
  1500                 24  CK-ACCT-AGENT         PIC X(10).
  1501                 24  CK-INVOICE            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL637.cbl
  1502                 24  CK-REFERENCE          PIC X(12).
  1503                 24  CK-LEDGER-NO          PIC X(14).
  1504                 24  CK-DETAIL-AMT         PIC S9(7)V99 COMP-3.
  1505                 24  CK-LAST-MAINT-APPLIED PIC X.
  1506                 24  CK-NON-AR-ITEM        PIC X.
  1507                 24  FILLER                PIC X(19).
  1508
  1509             20  CK-CHECK-WORK-CONTROL.
  1510                  24  CK-CKWK-CSR          PIC X(4).
  1511                  24  CK-CKWK-CARRIER      PIC X.
  1512                  24  CK-CKWK-GROUPING     PIC X(6).
  1513                  24  CK-CKWK-PAYEE        PIC X(10).
  1514                  24  CK-CKWK-PAYEE-SEQ    PIC S9(4) COMP.
  1515                  24  CK-CKWK-SEQ-NO       PIC S9(4) COMP.
  1516             20  CK-PAYMENT-TYPE           PIC X.
  1517             20  CK-PYAJ-PMT-APPLIED       PIC X.
  1518
  1519     12  CK-CHECK-STUB-TEXT  REDEFINES CK-CHECK-STUB-DATA.
  1520         16  CK-CHECK-TEXT-ITEMS OCCURS 3 TIMES.
  1521             20  CK-STUB-TEXT              PIC X(70).
  1522         16  CK-STUB-FILL-AREA             PIC X(1560).
  1523
  1524     12  CK-CHECK-QUE-CONTROL.
  1525         20  CK-QUE-CONTROL-NUMBER         PIC S9(8) COMP.
  1526         20  CK-QUE-SEQ-NO                 PIC S9(4) COMP.
  1527
  1528     12  CK-CREDIT-SELECT-DT               PIC XX.
  1529     12  CK-CREDIT-ACCEPT-DT               PIC XX.
  1530
  1531     12  CK-VOID-DATA.
  1532         20  CK-VOID-DT                    PIC XX.
  1533         20  CK-VOID-REASON                PIC X(25).
  1534
  1535     12  CK-AR-STATEMENT-DT                PIC XX.
  1536     12  CK-PMT-APPLIED                    PIC X.
  1537     12  CK-ACH-PAYMENT                    PIC X.
  1538          88 PAID-BY-ACH                   VALUE 'P'.
  1539          88 NOT-PAID-BY-ACH               VALUE 'N'.
  1540     12  FILLER                            PIC X(08).
  1541
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL637.cbl
  1543
  1544*                                COPY ERCCMKQ.
  1545******************************************************************
  1546*                                                                *
  1547*                                                                *
  1548*                            ERCCMKQ                             *
  1549*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1550*                            VMOD=2.014                          *
  1551*                                                                *
  1552*   FILE DESCRIPTION = CHECK QUE FILE FOR THE COMMISSION         *
  1553*                      CHECK OF THE CREDIT SYSTEM                *
  1554*                                                                *
  1555*   FILE TYPE = VSAM,KSDS                                        *
  1556*   RECORD SIZE = 1800 RECFORM = FIXED                           *
  1557*                                                                *
  1558*   BASE CLUSTER = ERCMKQ                         RKP=2,LEN=7    *
  1559*       ALTERNATE PATH  = ERCMKQ2  (BY PAYEE CONTRO AND          *
  1560*                                      CONTROL NUMBER)           *
  1561*                                                 RKP=9,LEN=30   *
  1562*                                                                *
  1563*   LOG = NO                                                     *
  1564*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1565******************************************************************
  1566 01  COMMISSION-CHECK-QUE.
  1567     12  MQ-RECORD-ID                PIC XX.
  1568         88  VALID-MQ-ID                     VALUE 'MQ'.
  1569
  1570     12  MQ-CONTROL-PRIMARY.
  1571         16  MQ-COMPANY-CD           PIC X.
  1572         16  MQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  1573         16  MQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  1574
  1575     12  MQ-CONTROL-BY-PAYEE.
  1576         16  MQ-COMPANY-CD-A1        PIC X.
  1577         16  MQ-CSR-A1               PIC X(4).
  1578         16  MQ-CARRIER-A1           PIC X.
  1579         16  MQ-GROUPING-A1          PIC X(6).
  1580         16  MQ-PAYEE-A1             PIC X(10).
  1581         16  MQ-PAYEE-SEQ-A1         PIC S9(4)       COMP.
  1582         16  MQ-CONTROL-NUMBER-A1    PIC S9(8)       COMP.
  1583         16  MQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  1584
  1585     12  MQ-ENTRY-TYPE               PIC X.
  1586             88  CHECK-ON-QUE           VALUE 'Q'.
  1587             88  ALIGNMENT-CHECK        VALUE 'A'.
  1588             88  SPOILED-CHECK          VALUE 'S'.
  1589             88  PAYMENT-ABORTED        VALUE 'X'.
  1590             88  ACH-PAYMENT            VALUE 'P'.
  1591
  1592     12  FILLER                      PIC X(10).
  1593
  1594     12  MQ-CREDIT-CHEK-CNTL.
  1595         16  MQ-CHEK-CSR             PIC X(4).
  1596         16  MQ-CHEK-CARRIER         PIC X.
  1597         16  MQ-CHEK-GROUPING        PIC X(6).
  1598         16  MQ-CHEK-PAYEE           PIC X(10).
  1599         16  MQ-CHEK-PAYEE-SEQ       PIC S9(4)       COMP.
  1600         16  MQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL637.cbl
  1601
  1602     12  FILLER                      PIC X(10).
  1603
  1604     12  MQ-PAYEE-INFO.
  1605         16  MQ-PAYEE-NAME           PIC X(30).
  1606         16  MQ-PAYEE-ADDRESS-1      PIC X(30).
  1607         16  MQ-PAYEE-ADDRESS-2      PIC X(30).
  1608         16  MQ-PAYEE-CITY-ST        PIC X(30).
  1609         16  MQ-PAYEE-ZIP-CODE.
  1610             20  MQ-PAYEE-ZIP.
  1611                 24  FILLER          PIC X(1).
  1612                     88 MQ-PAYEE-CANADIAN-POST-CODE
  1613                                     VALUE 'A' THRU 'Z'.
  1614                 24  FILLER          PIC X(4).
  1615             20  MQ-PAYEE-ZIP-EXT    PIC X(4).
  1616         16  MQ-PAYEE-CANADIAN-POSTAL-CODES
  1617                 REDEFINES MQ-PAYEE-ZIP-CODE.
  1618             20  MQ-PAY-CAN-POSTAL-CD-1
  1619                                     PIC X(3).
  1620             20  MQ-PAY-CAN-POSTAL-CD-2
  1621                                     PIC X(3).
  1622             20  FILLER              PIC X(3).
  1623
  1624     12  MQ-CREDIT-PYAJ-CNTL.
  1625         16  MQ-PYAJ-CARRIER         PIC X.
  1626         16  MQ-PYAJ-GROUPING        PIC X(6).
  1627         16  MQ-PYAJ-FIN-RESP        PIC X(10).
  1628         16  FILLER                  PIC X(6).
  1629
  1630     12  MQ-CHECK-NUMBER             PIC X(6).
  1631     12  MQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  1632     12  MQ-NUMBER-OF-CK-STUBS       PIC S9(3)       COMP-3.
  1633     12  MQ-VOID-DT                  PIC XX.
  1634     12  MQ-TIMES-PRINTED            PIC S9(4)       COMP.
  1635     12  MQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  1636     12  MQ-CHECK-BY-USER            PIC X(4).
  1637     12  MQ-PRE-NUMBERING-SW         PIC X.
  1638       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  1639       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  1640
  1641     12  MQ-CHECK-WRITTEN-DT         PIC XX.
  1642     12  MQ-ACH-WRITTEN-DT REDEFINES  MQ-CHECK-WRITTEN-DT
  1643                                     PIC XX.
  1644     12  MQ-LAST-MAINT-BY            PIC X(4).
  1645     12  MQ-LAST-MAINT-HHMMSS        PIC S9(6)       COMP-3.
  1646     12  MQ-LAST-MAINT-DT            PIC XX.
  1647     12  MQ-CHECK-RELEASE-DT         PIC XX.
  1648     12  MQ-RECORD-TYPE              PIC X.
  1649         88  MQ-DETAIL                     VALUE 'D'.
  1650         88  MQ-TEXT                       VALUE 'T'.
  1651
  1652     12  MQ-DETAIL-INFORMATION.
  1653         16  MQ-DETAIL-INFO        OCCURS 15 TIMES.
  1654             20  MQ-CHECK-STUB-LINE.
  1655                 24  MQ-STUB-COMMENT        PIC X(23).
  1656                 24  MQ-ACCT-AGENT          PIC X(10).
  1657                 24  MQ-INVOICE             PIC X(6).
  1658                 24  MQ-REFERENCE           PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL637.cbl
  1659                 24  MQ-LEDGER-NO           PIC X(14).
  1660                 24  MQ-PYAJ-AMT            PIC S9(7)V99 COMP-3.
  1661                 24  MQ-PYAJ-REC-TYPE       PIC X.
  1662                 24  MQ-PYAJ-SEQ            PIC S9(8)    COMP.
  1663                 24  MQ-PAYMENT-TYPE        PIC X.
  1664                 24  MQ-PYAJ-PMT-APPLIED    PIC X.
  1665                 24  MQ-LAST-MAINT-APPLIED  PIC X.
  1666                 24  MQ-NON-AR-ITEM         PIC X.
  1667                 24  FILLER                 PIC X(19).
  1668
  1669     12  MQ-CHECK-STUB-TEXT REDEFINES MQ-DETAIL-INFORMATION.
  1670         16  MQ-CHECK-TEXT-ITEMS   OCCURS 3 TIMES.
  1671             20  MQ-STUB-TEXT        PIC X(70).
  1672         16  MQ-STUB-FILLER          PIC X(1260).
  1673
  1674     12  MQ-CREDIT-SELECT-DATE       PIC XX.
  1675     12  MQ-CREDIT-ACCEPT-DATE       PIC XX.
  1676
  1677     12  MQ-AR-STATEMENT-DT          PIC XX.
  1678     12  MQ-CO-TYPE                  PIC X.
  1679
  1680     12  MQ-STARTING-CHECK-NUMBER    PIC X(06).
  1681     12  FILLER                      PIC X(41).
  1682******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL637.cbl
  1684*                                COPY ERCPYAJ.
  1685******************************************************************
  1686*                                                                *
  1687*                            ERCPYAJ                             *
  1688*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1689*                            VMOD=2.015                          *
  1690*                                                                *
  1691*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  1692*                                                                *
  1693*                                                                *
  1694*   FILE TYPE = VSAM,KSDS                                        *
  1695*   RECORD SIZE = 200  RECFORM = FIXED                           *
  1696*                                                                *
  1697*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  1698*       ALTERNATE PATHS = NONE                                   *
  1699*                                                                *
  1700*   LOG = YES                                                    *
  1701*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1702******************************************************************
  1703******************************************************************
  1704*                   C H A N G E   L O G
  1705*
  1706* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1707*-----------------------------------------------------------------
  1708*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1709* EFFECTIVE    NUMBER
  1710*-----------------------------------------------------------------
  1711* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  1712* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  1713******************************************************************
  1714
  1715 01  PENDING-PAY-ADJ.
  1716     12  PY-RECORD-ID                     PIC XX.
  1717         88  VALID-PY-ID                        VALUE 'PY'.
  1718
  1719     12  PY-CONTROL-PRIMARY.
  1720         16  PY-COMPANY-CD                PIC X.
  1721         16  PY-CARRIER                   PIC X.
  1722         16  PY-GROUPING                  PIC X(6).
  1723         16  PY-FIN-RESP                  PIC X(10).
  1724         16  PY-ACCOUNT                   PIC X(10).
  1725         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  1726                                          PIC X(10).
  1727         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  1728         16  PY-RECORD-TYPE               PIC X.
  1729             88  PY-REMIT-RECEIVED            VALUE 'R'.
  1730             88  PY-DEPOSIT                   VALUE 'D'.
  1731             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  1732             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  1733             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  1734             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  1735             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  1736             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  1737             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  1738             88  PY-FICA-ENTRY                VALUE 'F'.
  1739             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  1740             88  PY-POLICY-FEE                VALUE 'W'.
  1741             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL637.cbl
  1742
  1743     12  PY-PYMT-TYPE                     PIC X.
  1744             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  1745             88  PY-REINS-PYMT                VALUE 'R'.
  1746             88  PY-EXP-PYMT                  VALUE 'E'.
  1747
  1748     12  PY-BIL-INV                       PIC X(6).
  1749     12  PY-REF-NO                        PIC X(12).
  1750
  1751     12  PY-LAST-MAINT-DT                 PIC XX.
  1752     12  PY-LAST-MAINT-BY                 PIC X(4).
  1753     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1754
  1755     12  PY-PYADJ-RECORD.
  1756         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  1757         16  PY-ENTRY-COMMENT             PIC X(30).
  1758         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  1759             20  PY-GL-ACCOUNT            PIC X(10).
  1760             20  PY-GL-STATE              PIC X(02).
  1761             20  PY-GL-CANC-SW            PIC X(01).
  1762                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  1763                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  1764             20  PY-GL-COMMENT            PIC X(10).
  1765             20  FILLER      REDEFINES PY-GL-COMMENT.
  1766                 24  PY-GL-CHECK-NO       PIC 9(06).
  1767                 24  FILLER               PIC X(04).
  1768             20  FILLER                   PIC X(07).
  1769         16  PY-SAVE-ACCOUNT              PIC X(10).
  1770         16  PY-SAVE-TYPE                 PIC X(01).
  1771
  1772         16  PY-LETTERS.
  1773             20  PY-LETTER OCCURS 3 TIMES
  1774                           INDEXED BY PY-LET-NDX
  1775                                          PIC X(04).
  1776
  1777         16  PY-ERCOMP-TYPE               PIC X.
  1778             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  1779             88  PY-GA-TYPE                   VALUE 'G'.
  1780             88  PY-BANK-TYPE                 VALUE 'B'.
  1781         16  FILLER                       PIC X(05).
  1782
  1783     12  PY-RECORD-STATUS.
  1784         16  PY-CREDIT-SELECT-DT          PIC XX.
  1785         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  1786         16  PY-BILLED-DATE               PIC XX.
  1787         16  PY-REPORTED-DT               PIC XX.
  1788         16  PY-PMT-APPLIED               PIC X.
  1789             88  PY-ACCOUNT-PMT               VALUE 'A'.
  1790             88  PY-GA-PMT                    VALUE 'G'.
  1791             88  PY-OVWRITE-PMT               VALUE 'O'.
  1792             88  PY-NON-AR-PMT                VALUE 'N'.
  1793         16  FILLER                       PIC X(5).
  1794         16  PY-INPUT-DT                  PIC XX.
  1795         16  PY-CHECK-NUMBER              PIC X(6).
  1796         16  PY-VOID-SW                   PIC X.
  1797             88  PY-CHECK-VOIDED              VALUE 'V'.
  1798         16  PY-CHECK-ORIGIN-SW           PIC X.
  1799             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL637.cbl
  1800             88  PY-REFUND-CHECK              VALUE 'R'.
  1801             88  PY-GA-CHECK                  VALUE 'G'.
  1802             88  PY-CHECK-WRITTEN             VALUE 'W'.
  1803             88  PY-CHECK-REVERSAL            VALUE 'V'.
  1804         16  PY-CHECK-WRITTEN-DT          PIC XX.
  1805         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  1806         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  1807         16  PY-BILL-FLAG                 PIC X.
  1808             88  PY-BILLED                    VALUE 'B'.
  1809         16  PY-AR-FLAG                   PIC X.
  1810             88  PY-AR-CYCLE                  VALUE 'C'.
  1811             88  PY-AR-MONTH-END              VALUE 'M'.
  1812         16  PY-AR-DATE                   PIC XX.
  1813
  1814     12  PY-GL-CODES.
  1815         16  PY-GL-DB                     PIC X(14).
  1816         16  PY-GL-CR                     PIC X(14).
  1817         16  PY-GL-FLAG                   PIC X.
  1818         16  PY-GL-DATE                   PIC XX.
  1819
  1820     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  1821     12  FILLER                           PIC X(3).
  1822******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL637.cbl
  1824
  1825 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1826                          CHECK-WORK-RECORDS COMM-CHECK-RECORDS
  1827                          COMMISSION-CHECK-QUE PENDING-PAY-ADJ.
  1828 0000-DFHEXIT SECTION.
  1829     MOVE '9#                    $   ' TO DFHEIV0.
  1830     MOVE 'EL637' TO DFHEIV1.
  1831     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1832
  1833     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1834     MOVE 1                      TO EMI-NUMBER-OF-LINES.
  1835
  1836     IF EIBCALEN = 0
  1837         GO TO 8800-UNAUTHORIZED-ACCESS.
  1838
  1839     MOVE EIBTRMID               TO QID-TERM.
  1840     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1841     MOVE '5'                    TO DC-OPTION-CODE.
  1842     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  1843     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  1844     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT.
  1845
  1846     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1847         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1848             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1849             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1850             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1851             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1852             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1853             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1854             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1855             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1856         ELSE
  1857             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1858             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1859             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1860             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1861             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1862             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1863             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1864             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  1865
  1866     MOVE LOW-VALUES             TO EL637AI.
  1867
  1868     IF EIBTRNID NOT = TRANS-EXJB
  1869        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  1870        MOVE PI-COMPANY-CD       TO PI-ERCMKQ2-COMPANY-CD
  1871        MOVE +9999               TO PI-ERCMKQ2-SEQUENCE-NUMBER
  1872        GO TO 8100-SEND-INITIAL-MAP.
  1873
  1874
  1875* EXEC CICS HANDLE CONDITION
  1876*        PGMIDERR  (9600-PGMID-ERROR)
  1877*        ERROR     (9990-ABEND)
  1878*    END-EXEC.
  1879*    MOVE '"$L.                  ! " #00001870' TO DFHEIV0
  1880     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1881     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL637.cbl
  1882     MOVE X'2220233030303031383730' TO DFHEIV0(25:11)
  1883     CALL 'kxdfhei1' USING DFHEIV0
  1884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1885
  1886
  1887     IF EIBAID = DFHCLEAR
  1888         GO TO 9400-CLEAR.
  1889
  1890     IF PI-PROCESSOR-ID = 'LGXX'
  1891         GO TO 0200-RECEIVE.
  1892
  1893
  1894* EXEC CICS READQ TS
  1895*        QUEUE  (QID)
  1896*        INTO   (SECURITY-CONTROL)
  1897*        LENGTH (SC-COMM-LENGTH)
  1898*        ITEM   (SC-ITEM)
  1899*    END-EXEC.
  1900*    MOVE '*$II   L              ''   #00001881' TO DFHEIV0
  1901     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1902     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1903     MOVE X'2020233030303031383831' TO DFHEIV0(25:11)
  1904     CALL 'kxdfhei1' USING DFHEIV0,
  1905           QID,
  1906           SECURITY-CONTROL,
  1907           SC-COMM-LENGTH,
  1908           SC-ITEM,
  1909           DFHEIV99,
  1910           DFHEIV99
  1911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1912
  1913
  1914     MOVE SC-CREDIT-DISPLAY (7)   TO PI-DISPLAY-CAP.
  1915     MOVE SC-CREDIT-UPDATE  (7)   TO PI-MODIFY-CAP.
  1916
  1917     IF NOT DISPLAY-CAP
  1918         MOVE 'READ'          TO SM-READ
  1919         PERFORM 9995-SECURITY-VIOLATION
  1920         MOVE ER-0070         TO  EMI-ERROR
  1921         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1922         GO TO 8100-SEND-INITIAL-MAP.
  1923
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL637.cbl
  1925
  1926******************************************************************
  1927*                                                                *
  1928*              R E C E I V E   M A P                             *
  1929*                                                                *
  1930******************************************************************
  1931
  1932 0200-RECEIVE.
  1933
  1934     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1935         MOVE ER-0008            TO EMI-ERROR
  1936         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1937         MOVE -1                 TO MAINTL
  1938         GO TO 8200-SEND-DATAONLY.
  1939
  1940
  1941* EXEC CICS RECEIVE
  1942*        MAP      (EL637A)
  1943*        MAPSET   (MAPSET-EL637S)
  1944*        INTO     (EL637AI)
  1945*    END-EXEC.
  1946     MOVE LENGTH OF
  1947      EL637AI
  1948       TO DFHEIV11
  1949*    MOVE '8"T I  L              ''   #00001914' TO DFHEIV0
  1950     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1951     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1952     MOVE X'2020233030303031393134' TO DFHEIV0(25:11)
  1953     CALL 'kxdfhei1' USING DFHEIV0,
  1954           EL637A,
  1955           EL637AI,
  1956           DFHEIV11,
  1957           MAPSET-EL637S,
  1958           DFHEIV99,
  1959           DFHEIV99
  1960     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1961
  1962
  1963     IF PFENTERL GREATER THAN ZERO
  1964        IF EIBAID NOT = DFHENTER
  1965           MOVE ER-0004          TO EMI-ERROR
  1966           MOVE AL-UNBOF         TO PFENTERA
  1967           MOVE -1               TO PFENTERL
  1968           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1969           GO TO 8200-SEND-DATAONLY
  1970        ELSE
  1971           IF PFENTERI NUMERIC AND
  1972              PFENTERI GREATER 0 AND LESS 23
  1973              MOVE PF-VALUES (PFENTERI) TO EIBAID
  1974           ELSE
  1975              MOVE ER-0029       TO EMI-ERROR
  1976              MOVE AL-UNBOF      TO PFENTERA
  1977              MOVE -1            TO PFENTERL
  1978              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1979              GO TO 8200-SEND-DATAONLY.
  1980
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL637.cbl
  1982
  1983******************************************************************
  1984*                                                                *
  1985*              C H E C K   P F K E Y S                           *
  1986*                                                                *
  1987******************************************************************
  1988
  1989 0300-CHECK-PFKEYS.
  1990
  1991     IF EIBAID = DFHPF23
  1992         GO TO 8810-PF23.
  1993
  1994     IF EIBAID = DFHPF24
  1995         GO TO 9200-RETURN-MAIN-MENU.
  1996
  1997     IF EIBAID = DFHPF12
  1998         GO TO 9500-PF12.
  1999
  2000     IF EIBAID = DFHPF1
  2001        IF PI-END-OF-FILE
  2002           MOVE -1               TO MAINTL
  2003           MOVE ER-2251          TO EMI-ERROR
  2004           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2005           GO TO 8200-SEND-DATAONLY
  2006        ELSE
  2007           MOVE SPACE            TO PI-MAINT-FUNCTION
  2008           GO TO 5000-DISPLAY-PAYEE.
  2009
  2010     IF EIBAID = DFHPF2
  2011         MOVE SPACE              TO PI-MAINT-FUNCTION
  2012         GO TO 6100-DISPLAY-PREV-PAYEE.
  2013
  2014
  2015     IF EIBAID = DFHENTER
  2016         GO TO 1000-EDIT-MAP.
  2017
  2018     MOVE ER-0008 TO EMI-ERROR.
  2019     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2020     MOVE -1                     TO PFENTERL.
  2021
  2022     GO TO 8200-SEND-DATAONLY.
  2023
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL637.cbl
  2025
  2026******************************************************************
  2027*                                                                *
  2028*                  E D I T    M A P                              *
  2029*                                                                *
  2030******************************************************************
  2031
  2032 1000-EDIT-MAP.
  2033
  2034     IF MAINTI = 'S' OR 'R'
  2035        MOVE MAINTI              TO PI-MAINT-FUNCTION
  2036        MOVE AL-UANON            TO MAINTA
  2037     ELSE
  2038        MOVE ER-0023             TO EMI-ERROR
  2039        MOVE -1                  TO MAINTL
  2040        MOVE AL-UABON            TO MAINTA
  2041        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2042        GO TO 8200-SEND-DATAONLY.
  2043
  2044     IF NOT MODIFY-CAP
  2045        IF MAINTI = 'S'
  2046           MOVE MAINTI              TO PI-MAINT-FUNCTION
  2047        ELSE
  2048           MOVE 'UPDATE'            TO SM-READ
  2049           PERFORM 9995-SECURITY-VIOLATION
  2050           MOVE ER-0070             TO EMI-ERROR
  2051           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2052           GO TO 8100-SEND-INITIAL-MAP.
  2053
  2054     IF MAINTI = 'R'
  2055        IF PI-COMPANY-CD = PI-SVCMKQ2-COMPANY-CD AND
  2056           CSRI          = PI-SVCMKQ2-CSR        AND
  2057           CARI          = PI-SVCMKQ2-CARRIER    AND
  2058           GROUPI        = PI-SVCMKQ2-GROUPING   AND
  2059           PAYEEI        = PI-SVCMKQ2-PAYEE      AND
  2060           PAYSEQI       = PI-SVCMKQ2-PAYEE-SEQ  AND
  2061           CNTRLNOI      = PI-SVCMKQ2-CONTROL-NUMBER
  2062           GO TO 7500-REVERSE-COMM-CHECK
  2063        ELSE
  2064           MOVE ER-2056             TO EMI-ERROR
  2065           MOVE -1                  TO MAINTL
  2066           MOVE AL-UABON            TO MAINTA
  2067           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2068           GO TO 8200-SEND-DATAONLY.
  2069
  2070     IF CSRL GREATER THAN ZERO
  2071        MOVE AL-UANON            TO CSRA
  2072     ELSE
  2073        MOVE LOW-VALUES          TO CSRI.
  2074
  2075     IF CARL GREATER THAN ZERO
  2076        MOVE AL-UANON            TO CARA
  2077     ELSE
  2078        MOVE -1                  TO CARL
  2079        MOVE ER-0194             TO EMI-ERROR
  2080        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2081
  2082     IF GROUPL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL637.cbl
  2083        MOVE AL-UANON            TO GROUPA
  2084     ELSE
  2085        MOVE -1                  TO GROUPL
  2086        MOVE ER-0195             TO EMI-ERROR
  2087        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2088
  2089     IF PAYEEL GREATER THAN ZEROS
  2090        MOVE AL-UANON            TO PAYEEA
  2091     ELSE
  2092        MOVE -1                  TO PAYEEL
  2093        MOVE ER-3148             TO EMI-ERROR
  2094        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2095
  2096     IF PAYSEQL GREATER THAN ZEROS
  2097        MOVE AL-UANON            TO PAYSEQA
  2098     ELSE
  2099        MOVE -1                  TO PAYSEQL
  2100        MOVE ER-3176             TO EMI-ERROR
  2101        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2102
  2103     IF CNTRLNOL GREATER THAN ZEROS
  2104        MOVE AL-UANON            TO CNTRLNOA
  2105     ELSE
  2106        MOVE -1                  TO CNTRLNOL
  2107        MOVE ER-3129             TO EMI-ERROR
  2108        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2109
  2110
  2111 1050-EDIT-COMPLETE.
  2112
  2113     IF EMI-ERROR NOT = ZEROS
  2114        GO TO 8200-SEND-DATAONLY.
  2115
  2116     MOVE PI-COMPANY-CD          TO PI-ERCMKQ2-COMPANY-CD.
  2117     MOVE CSRI                   TO PI-ERCMKQ2-CSR.
  2118     MOVE CARI                   TO PI-ERCMKQ2-CARRIER.
  2119     MOVE GROUPI                 TO PI-ERCMKQ2-GROUPING.
  2120     MOVE PAYEEI                 TO PI-ERCMKQ2-PAYEE.
  2121     MOVE PAYSEQI                TO PI-ERCMKQ2-PAYEE-SEQ.
  2122     MOVE CNTRLNOI               TO PI-ERCMKQ2-CONTROL-NUMBER.
  2123
  2124     IF MAINTI = 'S'
  2125        MOVE +0                 TO PI-ERCMKQ2-SEQUENCE-NUMBER
  2126        GO TO 5000-DISPLAY-PAYEE.
  2127
  2128
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL637.cbl
  2130
  2131******************************************************************
  2132*                                                                *
  2133*               D I S P L A Y   P A Y E E                        *
  2134*                                                                *
  2135******************************************************************
  2136
  2137 5000-DISPLAY-PAYEE.
  2138
  2139     MOVE SPACE                  TO  PI-END-OF-FILE-SW.
  2140
  2141     IF EIBAID = DFHPF1 OR DFHPF2
  2142         IF CSRI EQUAL SPACES OR LOW-VALUES OR ALL '_'
  2143             MOVE LOW-VALUES TO PI-ERCMKQ2-CSR.
  2144
  2145     MOVE LOW-VALUES             TO  EL637AI.
  2146     MOVE 'S'                    TO  MAINTI.
  2147     MOVE AL-UANON               TO  MAINTA.
  2148
  2149     MOVE PI-ERCMKQ2-KEY         TO  SVCMKQ2-COMPARE-KEY.
  2150
  2151
  2152* EXEC CICS HANDLE CONDITION
  2153*        NOTFND    (5090-CHECKS-NOTFND)
  2154*    END-EXEC.
  2155*    MOVE '"$I                   ! # #00002108' TO DFHEIV0
  2156     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2157     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2158     MOVE X'2320233030303032313038' TO DFHEIV0(25:11)
  2159     CALL 'kxdfhei1' USING DFHEIV0
  2160     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2161
  2162
  2163     MOVE SPACE                  TO WS-BROWSE-SW.
  2164
  2165
  2166* EXEC CICS STARTBR
  2167*        DATASET (FILE-ID-ERCMKQ2)
  2168*        RIDFLD  (PI-ERCMKQ2-KEY)
  2169*    END-EXEC.
  2170     MOVE 0
  2171       TO DFHEIV11
  2172*    MOVE '&,         G          &   #00002114' TO DFHEIV0
  2173     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2174     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2175     MOVE X'2020233030303032313134' TO DFHEIV0(25:11)
  2176     CALL 'kxdfhei1' USING DFHEIV0,
  2177           FILE-ID-ERCMKQ2,
  2178           PI-ERCMKQ2-KEY,
  2179           DFHEIV99,
  2180           DFHEIV11,
  2181           DFHEIV99
  2182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2183
  2184
  2185
  2186* EXEC CICS HANDLE CONDITION
  2187*        NOTFND    (5070-CHECK-PROCESSED)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL637.cbl
  2188*        ENDFILE   (5060-END-OF-FILE)
  2189*    END-EXEC.
  2190*    MOVE '"$I''                  ! $ #00002119' TO DFHEIV0
  2191     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  2192     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2193     MOVE X'2420233030303032313139' TO DFHEIV0(25:11)
  2194     CALL 'kxdfhei1' USING DFHEIV0
  2195     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2196
  2197
  2198     MOVE 'Y'                    TO WS-BROWSE-SW.
  2199
  2200 5010-READ-CHECK-QUE-FILE.
  2201
  2202
  2203* EXEC CICS READNEXT
  2204*        SET     (ADDRESS OF COMMISSION-CHECK-QUE)
  2205*        DATASET (FILE-ID-ERCMKQ2)
  2206*        RIDFLD  (PI-ERCMKQ2-KEY)
  2207*    END-EXEC.
  2208     MOVE 0
  2209       TO DFHEIV11
  2210*    MOVE '&.S                   )   #00002128' TO DFHEIV0
  2211     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2212     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2213     MOVE X'2020233030303032313238' TO DFHEIV0(25:11)
  2214     CALL 'kxdfhei1' USING DFHEIV0,
  2215           FILE-ID-ERCMKQ2,
  2216           DFHEIV20,
  2217           DFHEIV99,
  2218           PI-ERCMKQ2-KEY,
  2219           DFHEIV99,
  2220           DFHEIV11,
  2221           DFHEIV99,
  2222           DFHEIV99
  2223     SET ADDRESS OF COMMISSION-CHECK-QUE TO
  2224         DFHEIV20
  2225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2226
  2227
  2228     IF PI-COMPANY-CD  NOT =  MQ-COMPANY-CD
  2229         GO TO      5060-END-OF-FILE.
  2230
  2231     IF CHECK-ON-QUE OR ACH-PAYMENT
  2232         NEXT SENTENCE
  2233     ELSE
  2234         GO TO 5010-READ-CHECK-QUE-FILE.
  2235
  2236     MOVE PI-ERCMKQ2-KEY TO ERCMKQ2-COMPARE-KEY.
  2237
  2238     IF WS-FIRST-TIME
  2239        IF PI-SHOW-FUNCTION
  2240           IF ERCMKQ2-COMPARE-KEY NOT = SVCMKQ2-COMPARE-KEY
  2241              MOVE PI-SAVE-ERCMKQ2-KEY TO PI-ERCMKQ2-KEY
  2242              GO TO 5090-CHECKS-NOTFND
  2243           ELSE
  2244              MOVE PI-ERCMKQ2-KEY    TO PI-SAVE-ERCMKQ2-KEY
  2245              MOVE 'N'               TO WS-FIRST-TIME-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL637.cbl
  2246              GO TO 5025-PROCESS-PAYEE
  2247        ELSE
  2248           MOVE PI-ERCMKQ2-KEY       TO PI-SAVE-ERCMKQ2-KEY
  2249           MOVE 'N'                  TO WS-FIRST-TIME-SW
  2250           GO TO 5025-PROCESS-PAYEE.
  2251
  2252     IF ERCMKQ2-COMPARE-KEY  NOT =  SVCMKQ2-COMPARE-KEY
  2253         GO TO 5070-CHECK-PROCESSED.
  2254
  2255     IF MQ-CHECK-AMOUNT NOT = ZERO
  2256         MOVE MQ-CHECK-AMOUNT    TO CHKAMTO.
  2257
  2258     IF MQ-CHECK-NUMBER GREATER THAN WS-STRT-CK-NO
  2259         MOVE '-'                TO DASHO
  2260         MOVE MQ-CHECK-NUMBER    TO ENDCHKO.
  2261
  2262     GO TO 5010-READ-CHECK-QUE-FILE.
  2263
  2264 5025-PROCESS-PAYEE.
  2265
  2266     MOVE AL-UANON               TO  CSRA.
  2267     MOVE MQ-CSR-A1              TO  CSRO.
  2268     MOVE AL-UANON               TO  CARA.
  2269     MOVE MQ-CARRIER-A1          TO  CARO.
  2270     MOVE AL-UANON               TO  CARA.
  2271     MOVE MQ-GROUPING-A1         TO  GROUPO.
  2272     MOVE AL-UANON               TO  GROUPA.
  2273     MOVE MQ-PAYEE-A1            TO  PAYEEO.
  2274     MOVE AL-UANON               TO  PAYEEA.
  2275     MOVE MQ-PAYEE-SEQ-A1        TO  PAYSEQO.
  2276     MOVE AL-UANON               TO  PAYSEQA.
  2277     MOVE MQ-CONTROL-NUMBER-A1   TO  CNTRLNOO.
  2278     MOVE AL-UANON               TO  CNTRLNOA.
  2279     MOVE MQ-PAYEE-NAME          TO  PAYTOO.
  2280     MOVE MQ-PAYEE-ADDRESS-1     TO  ADDRS1O.
  2281     MOVE MQ-PAYEE-ADDRESS-2     TO  ADDRS2O.
  2282     MOVE MQ-PAYEE-CITY-ST       TO  CITYSTO.
  2283
  2284     IF  MQ-PAYEE-CANADIAN-POST-CODE
  2285         MOVE MQ-PAY-CAN-POSTAL-CD-1
  2286                                 TO  ZIPO
  2287         MOVE MQ-PAY-CAN-POSTAL-CD-2
  2288                                 TO  ZIPEXTO
  2289
  2290     ELSE
  2291         MOVE MQ-PAYEE-ZIP       TO  ZIPO
  2292         MOVE MQ-PAYEE-ZIP-EXT   TO  ZIPEXTO.
  2293
  2294     MOVE MQ-LAST-MAINT-BY       TO  MAINTBYO.
  2295     MOVE MQ-LAST-MAINT-HHMMSS   TO  WS-TIME.
  2296     MOVE WS-HR-MINS             TO  MAINTATO.
  2297     MOVE MQ-LAST-MAINT-DT       TO  DC-BIN-DATE-1.
  2298     MOVE SPACE                  TO  DC-OPTION-CODE.
  2299     PERFORM 8500-DATE-CONVERT.
  2300
  2301     IF NO-CONVERSION-ERROR
  2302        MOVE DC-GREG-DATE-1-EDIT TO  MAINTONO.
  2303
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL637.cbl
  2304     IF MQ-CHECK-WRITTEN-DT GREATER THAN LOW-VALUES
  2305        MOVE MQ-CHECK-WRITTEN-DT TO  DC-BIN-DATE-1
  2306        MOVE SPACE               TO  DC-OPTION-CODE
  2307        PERFORM 8500-DATE-CONVERT
  2308        IF NO-CONVERSION-ERROR
  2309           MOVE DC-GREG-DATE-1-EDIT TO  CHKWRTNO.
  2310
  2311     IF MQ-CHECK-RELEASE-DT GREATER THAN LOW-VALUES
  2312        MOVE MQ-CHECK-RELEASE-DT TO  DC-BIN-DATE-1
  2313        MOVE SPACE               TO  DC-OPTION-CODE
  2314        PERFORM 8500-DATE-CONVERT
  2315        IF NO-CONVERSION-ERROR
  2316           MOVE DC-GREG-DATE-1-EDIT TO  CHKRELO.
  2317
  2318     IF MQ-VOID-DT   GREATER THAN LOW-VALUES
  2319        MOVE MQ-VOID-DT TO  DC-BIN-DATE-1
  2320        MOVE SPACE               TO  DC-OPTION-CODE
  2321        PERFORM 8500-DATE-CONVERT
  2322        IF NO-CONVERSION-ERROR
  2323           MOVE DC-GREG-DATE-1-EDIT TO  VOIDDTO.
  2324
  2325     IF MQ-CHECK-AMOUNT NOT = ZERO
  2326         MOVE MQ-CHECK-AMOUNT    TO CHKAMTO.
  2327
  2328     IF MQ-CHECK-NUMBER GREATER THAN WS-STRT-CK-NO
  2329         MOVE '-'                TO DASHO
  2330         MOVE MQ-CHECK-NUMBER    TO ENDCHKO.
  2331
  2332     MOVE ' '                    TO DASHO.
  2333
  2334     MOVE MQ-CHECK-NUMBER        TO STRTCHKO.
  2335
  2336     GO TO 5010-READ-CHECK-QUE-FILE.
  2337
  2338
  2339 5060-END-OF-FILE.
  2340
  2341     MOVE 'Y'                    TO PI-END-OF-FILE-SW.
  2342     MOVE ER-2251                TO EMI-ERROR.
  2343     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2344
  2345 5070-CHECK-PROCESSED.
  2346
  2347     IF WS-BROWSE-STARTED
  2348
  2349* EXEC CICS ENDBR
  2350*            DATASET (FILE-ID-ERCMKQ2)
  2351*       END-EXEC.
  2352     MOVE 0
  2353       TO DFHEIV11
  2354*    MOVE '&2                    $   #00002254' TO DFHEIV0
  2355     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2356     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2357     MOVE X'2020233030303032323534' TO DFHEIV0(25:11)
  2358     CALL 'kxdfhei1' USING DFHEIV0,
  2359           FILE-ID-ERCMKQ2,
  2360           DFHEIV11,
  2361           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL637.cbl
  2362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2363
  2364
  2365     MOVE 'S'                    TO  PI-MAINT-FUNCTION.
  2366     MOVE -1                     TO  MAINTL.
  2367     GO TO 8100-SEND-INITIAL-MAP.
  2368
  2369 5080-END-OF-ENTRIES.
  2370
  2371     MOVE -1                     TO MAINTL.
  2372     GO TO 8200-SEND-DATAONLY.
  2373
  2374 5090-CHECKS-NOTFND.
  2375
  2376     MOVE SPACE                  TO PI-MAINT-FUNCTION.
  2377     MOVE ER-3160                TO EMI-ERROR.
  2378     MOVE -1                     TO CARL.
  2379     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2380     GO TO 8200-SEND-DATAONLY.
  2381
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL637.cbl
  2383
  2384******************************************************************
  2385*                                                                *
  2386*            D I S P L A Y   P R E V   P A Y E E                 *
  2387*                                                                *
  2388******************************************************************
  2389
  2390 6100-DISPLAY-PREV-PAYEE.
  2391
  2392
  2393     IF PI-SAVE-ERCMKQ2-KEY = SPACES
  2394        GO TO 6160-END-OF-FILE.
  2395
  2396     MOVE PI-SAVE-ERCMKQ2-KEY    TO PI-ERCMKQ2-KEY.
  2397
  2398
  2399* EXEC CICS HANDLE CONDITION
  2400*        ENDFILE   (6160-END-OF-FILE)
  2401*    END-EXEC.
  2402*    MOVE '"$''                   ! % #00002291' TO DFHEIV0
  2403     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  2404     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2405     MOVE X'2520233030303032323931' TO DFHEIV0(25:11)
  2406     CALL 'kxdfhei1' USING DFHEIV0
  2407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2408
  2409
  2410
  2411* EXEC CICS STARTBR
  2412*        DATASET (FILE-ID-ERCMKQ2)
  2413*        RIDFLD  (PI-ERCMKQ2-KEY)
  2414*    END-EXEC.
  2415     MOVE 0
  2416       TO DFHEIV11
  2417*    MOVE '&,         G          &   #00002295' TO DFHEIV0
  2418     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2419     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2420     MOVE X'2020233030303032323935' TO DFHEIV0(25:11)
  2421     CALL 'kxdfhei1' USING DFHEIV0,
  2422           FILE-ID-ERCMKQ2,
  2423           PI-ERCMKQ2-KEY,
  2424           DFHEIV99,
  2425           DFHEIV11,
  2426           DFHEIV99
  2427     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2428
  2429
  2430 6110-READ-PREV-ENTRY.
  2431
  2432
  2433* EXEC CICS READPREV
  2434*        SET     (ADDRESS OF COMMISSION-CHECK-QUE)
  2435*        DATASET (FILE-ID-ERCMKQ2)
  2436*        RIDFLD  (PI-ERCMKQ2-KEY)
  2437*    END-EXEC.
  2438     MOVE 0
  2439       TO DFHEIV11
  2440*    MOVE '&0S                   )   #00002302' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL637.cbl
  2441     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  2442     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2443     MOVE X'2020233030303032333032' TO DFHEIV0(25:11)
  2444     CALL 'kxdfhei1' USING DFHEIV0,
  2445           FILE-ID-ERCMKQ2,
  2446           DFHEIV20,
  2447           DFHEIV99,
  2448           PI-ERCMKQ2-KEY,
  2449           DFHEIV99,
  2450           DFHEIV11,
  2451           DFHEIV99,
  2452           DFHEIV99
  2453     SET ADDRESS OF COMMISSION-CHECK-QUE TO
  2454         DFHEIV20
  2455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2456
  2457
  2458     IF PI-COMPANY-CD  NOT =  MQ-COMPANY-CD
  2459         GO TO      6160-END-OF-FILE.
  2460
  2461     IF PI-ERCMKQ2-KEY = PI-SAVE-ERCMKQ2-KEY
  2462        GO TO 6110-READ-PREV-ENTRY.
  2463
  2464     IF CHECK-ON-QUE OR ACH-PAYMENT
  2465         NEXT SENTENCE
  2466     ELSE
  2467         GO TO 6110-READ-PREV-ENTRY.
  2468
  2469     IF MQ-TEXT
  2470        GO TO 6110-READ-PREV-ENTRY.
  2471
  2472
  2473* EXEC CICS ENDBR
  2474*         DATASET (FILE-ID-ERCMKQ2)
  2475*    END-EXEC.
  2476     MOVE 0
  2477       TO DFHEIV11
  2478*    MOVE '&2                    $   #00002322' TO DFHEIV0
  2479     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2480     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2481     MOVE X'2020233030303032333232' TO DFHEIV0(25:11)
  2482     CALL 'kxdfhei1' USING DFHEIV0,
  2483           FILE-ID-ERCMKQ2,
  2484           DFHEIV11,
  2485           DFHEIV99
  2486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2487
  2488
  2489     IF PI-ERCMKQ2-COMPANY-CD NOT = PI-COMPANY-CD
  2490        GO TO 6160-END-OF-FILE
  2491     ELSE
  2492        MOVE +0                  TO PI-ERCMKQ2-SEQUENCE-NUMBER
  2493        GO TO 5000-DISPLAY-PAYEE.
  2494
  2495 6160-END-OF-FILE.
  2496
  2497     MOVE SPACE                  TO PI-MAINT-FUNCTION.
  2498     MOVE ER-2252                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL637.cbl
  2499     MOVE -1                     TO CARL.
  2500     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2501     MOVE  PI-SAVE-ERCMKQ2-KEY   TO  PI-ERCMKQ2-KEY.
  2502     GO TO 8200-SEND-DATAONLY.
  2503
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL637.cbl
  2505
  2506******************************************************************
  2507*                                                                *
  2508*       R E V E R S E   C O M M I S I O N   C H E C K            *
  2509*                CHECK QUE FILE (ERCMKQ)                         *
  2510*                                                                *
  2511******************************************************************
  2512
  2513 7500-REVERSE-COMM-CHECK.
  2514
  2515
  2516* EXEC CICS HANDLE CONDITION
  2517*        NOTFND    (7580-PAYEE-NOTFND)
  2518*    END-EXEC.
  2519*    MOVE '"$I                   ! & #00002352' TO DFHEIV0
  2520     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2522     MOVE X'2620233030303032333532' TO DFHEIV0(25:11)
  2523     CALL 'kxdfhei1' USING DFHEIV0
  2524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2525
  2526
  2527     MOVE SPACE                  TO WS-BROWSE-SW.
  2528     MOVE PI-SAVE-ERCMKQ2-KEY    TO PI-ERCMKQ2-KEY
  2529                                    SVCMKQ2-COMPARE-KEY.
  2530
  2531 7505-PROCESS-CHECK-QUE-FILE.
  2532
  2533
  2534* EXEC CICS STARTBR
  2535*        DATASET (FILE-ID-ERCMKQ2)
  2536*        RIDFLD  (PI-ERCMKQ2-KEY)
  2537*    END-EXEC.
  2538     MOVE 0
  2539       TO DFHEIV11
  2540*    MOVE '&,         G          &   #00002362' TO DFHEIV0
  2541     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2542     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2543     MOVE X'2020233030303032333632' TO DFHEIV0(25:11)
  2544     CALL 'kxdfhei1' USING DFHEIV0,
  2545           FILE-ID-ERCMKQ2,
  2546           PI-ERCMKQ2-KEY,
  2547           DFHEIV99,
  2548           DFHEIV11,
  2549           DFHEIV99
  2550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2551
  2552
  2553
  2554* EXEC CICS HANDLE CONDITION
  2555*        NOTFND    (7570-COMM-CHECK-REVERSED)
  2556*        ENDFILE   (7570-COMM-CHECK-REVERSED)
  2557*    END-EXEC.
  2558*    MOVE '"$I''                  ! '' #00002367' TO DFHEIV0
  2559     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  2560     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2561     MOVE X'2720233030303032333637' TO DFHEIV0(25:11)
  2562     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL637.cbl
  2563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2564
  2565
  2566     MOVE 'Y'                    TO WS-BROWSE-SW.
  2567
  2568 7510-READ-CHECK-QUE-FILE.
  2569
  2570
  2571* EXEC CICS READNEXT
  2572*        SET     (ADDRESS OF COMMISSION-CHECK-QUE)
  2573*        DATASET (FILE-ID-ERCMKQ2)
  2574*        RIDFLD  (PI-ERCMKQ2-KEY)
  2575*    END-EXEC.
  2576     MOVE 0
  2577       TO DFHEIV11
  2578*    MOVE '&.S                   )   #00002376' TO DFHEIV0
  2579     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2580     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2581     MOVE X'2020233030303032333736' TO DFHEIV0(25:11)
  2582     CALL 'kxdfhei1' USING DFHEIV0,
  2583           FILE-ID-ERCMKQ2,
  2584           DFHEIV20,
  2585           DFHEIV99,
  2586           PI-ERCMKQ2-KEY,
  2587           DFHEIV99,
  2588           DFHEIV11,
  2589           DFHEIV99,
  2590           DFHEIV99
  2591     SET ADDRESS OF COMMISSION-CHECK-QUE TO
  2592         DFHEIV20
  2593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2594
  2595
  2596     IF PI-COMPANY-CD  NOT =  MQ-COMPANY-CD
  2597         GO TO      7570-COMM-CHECK-REVERSED.
  2598
  2599     IF CHECK-ON-QUE OR ACH-PAYMENT
  2600         NEXT SENTENCE
  2601     ELSE
  2602         GO TO 7510-READ-CHECK-QUE-FILE.
  2603
  2604     IF PI-ERCMKQ2-KEY = ERCMKQ2-PREV-KEY
  2605        GO TO 7510-READ-CHECK-QUE-FILE.
  2606
  2607     MOVE PI-ERCMKQ2-KEY TO ERCMKQ2-COMPARE-KEY.
  2608
  2609     IF WS-FIRST-TIME
  2610        IF ERCMKQ2-COMPARE-KEY NOT = SVCMKQ2-COMPARE-KEY
  2611           GO TO 7580-PAYEE-NOTFND
  2612        ELSE
  2613           MOVE 'N'        TO WS-FIRST-TIME-SW
  2614           GO TO 7525-PROCESS-PAYEE.
  2615
  2616     IF ERCMKQ2-COMPARE-KEY  NOT =  SVCMKQ2-COMPARE-KEY
  2617        GO TO 7570-COMM-CHECK-REVERSED.
  2618
  2619 7525-PROCESS-PAYEE.
  2620
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL637.cbl
  2621     IF MQ-VOID-DT GREATER THAN LOW-VALUES
  2622        GO TO 7585-REVERSAL-ERROR.
  2623
  2624     MOVE PI-ERCMKQ2-KEY         TO ERCMKQ2-PREV-KEY.
  2625
  2626     IF MQ-TEXT
  2627         NEXT SENTENCE
  2628     ELSE
  2629        IF MQ-CHECK-WRITTEN-DT EQUAL LOW-VALUES OR SPACES
  2630            NEXT SENTENCE
  2631        ELSE
  2632            PERFORM 7600-REVERSE-PMTS-ADJS  THRU 7690-EXIT.
  2633
  2634     PERFORM 7700-REVERSE-COMM-CHECK THRU 7790-EXIT.
  2635
  2636     MOVE MQ-COMPANY-CD          TO ERCMKQ-COMPANY-CD.
  2637     MOVE MQ-CONTROL-NUMBER      TO ERCMKQ-CONTROL-NUMBER.
  2638     MOVE MQ-SEQUENCE-NUMBER     TO ERCMKQ-SEQUENCE-NUMBER.
  2639
  2640
  2641* EXEC CICS ENDBR
  2642*         DATASET (FILE-ID-ERCMKQ2)
  2643*    END-EXEC.
  2644     MOVE 0
  2645       TO DFHEIV11
  2646*    MOVE '&2                    $   #00002426' TO DFHEIV0
  2647     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2648     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2649     MOVE X'2020233030303032343236' TO DFHEIV0(25:11)
  2650     CALL 'kxdfhei1' USING DFHEIV0,
  2651           FILE-ID-ERCMKQ2,
  2652           DFHEIV11,
  2653           DFHEIV99
  2654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2655
  2656
  2657
  2658* EXEC CICS READ
  2659*        SET     (ADDRESS OF COMMISSION-CHECK-QUE)
  2660*        DATASET (FILE-ID-ERCMKQ)
  2661*        RIDFLD  (ERCMKQ-KEY)
  2662*        UPDATE
  2663*    END-EXEC.
  2664*    MOVE '&"S        EU         (   #00002430' TO DFHEIV0
  2665     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2666     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2667     MOVE X'2020233030303032343330' TO DFHEIV0(25:11)
  2668     CALL 'kxdfhei1' USING DFHEIV0,
  2669           FILE-ID-ERCMKQ,
  2670           DFHEIV20,
  2671           DFHEIV99,
  2672           ERCMKQ-KEY,
  2673           DFHEIV99,
  2674           DFHEIV99,
  2675           DFHEIV99
  2676     SET ADDRESS OF COMMISSION-CHECK-QUE TO
  2677         DFHEIV20
  2678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL637.cbl
  2679
  2680
  2681     MOVE PI-PROCESSOR-ID        TO MQ-LAST-MAINT-BY.
  2682     MOVE EIBTIME                TO MQ-LAST-MAINT-HHMMSS.
  2683     MOVE WS-CURRENT-BIN-DT      TO MQ-LAST-MAINT-DT
  2684                                    MQ-VOID-DT.
  2685
  2686     MOVE LOW-VALUES             TO MQ-CREDIT-SELECT-DATE
  2687                                    MQ-CREDIT-ACCEPT-DATE.
  2688
  2689
  2690* EXEC CICS REWRITE
  2691*         FROM    (COMMISSION-CHECK-QUE)
  2692*         DATASET (FILE-ID-ERCMKQ)
  2693*    END-EXEC.
  2694     MOVE LENGTH OF
  2695      COMMISSION-CHECK-QUE
  2696       TO DFHEIV11
  2697*    MOVE '&& L                  %   #00002445' TO DFHEIV0
  2698     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2699     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2700     MOVE X'2020233030303032343435' TO DFHEIV0(25:11)
  2701     CALL 'kxdfhei1' USING DFHEIV0,
  2702           FILE-ID-ERCMKQ,
  2703           COMMISSION-CHECK-QUE,
  2704           DFHEIV11,
  2705           DFHEIV99
  2706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2707
  2708
  2709     GO TO 7505-PROCESS-CHECK-QUE-FILE.
  2710
  2711 7570-COMM-CHECK-REVERSED.
  2712
  2713     IF WS-BROWSE-STARTED
  2714
  2715* EXEC CICS ENDBR
  2716*            DATASET (FILE-ID-ERCMKQ2)
  2717*       END-EXEC.
  2718     MOVE 0
  2719       TO DFHEIV11
  2720*    MOVE '&2                    $   #00002455' TO DFHEIV0
  2721     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2722     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2723     MOVE X'2020233030303032343535' TO DFHEIV0(25:11)
  2724     CALL 'kxdfhei1' USING DFHEIV0,
  2725           FILE-ID-ERCMKQ2,
  2726           DFHEIV11,
  2727           DFHEIV99
  2728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2729
  2730
  2731     MOVE SPACE                     TO WS-BROWSE-SW.
  2732     MOVE 'Y'                       TO WS-FIRST-TIME-SW.
  2733
  2734     MOVE PI-SAVE-ERCMKQ2-KEY       TO PI-ERCMKQ2-KEY.
  2735
  2736     MOVE ER-0000                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL637.cbl
  2737     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2738     GO TO 5000-DISPLAY-PAYEE.
  2739
  2740 7580-PAYEE-NOTFND.
  2741
  2742
  2743* EXEC CICS ENDBR
  2744*         DATASET (FILE-ID-ERCMKQ2)
  2745*    END-EXEC.
  2746     MOVE 0
  2747       TO DFHEIV11
  2748*    MOVE '&2                    $   #00002470' TO DFHEIV0
  2749     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2750     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2751     MOVE X'2020233030303032343730' TO DFHEIV0(25:11)
  2752     CALL 'kxdfhei1' USING DFHEIV0,
  2753           FILE-ID-ERCMKQ2,
  2754           DFHEIV11,
  2755           DFHEIV99
  2756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2757
  2758
  2759     MOVE SPACE                  TO PI-MAINT-FUNCTION.
  2760     MOVE ER-3160                TO EMI-ERROR.
  2761     MOVE -1                     TO CARL.
  2762     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2763     GO TO 8200-SEND-DATAONLY.
  2764
  2765 7585-REVERSAL-ERROR.
  2766
  2767
  2768* EXEC CICS ENDBR
  2769*         DATASET (FILE-ID-ERCMKQ2)
  2770*    END-EXEC.
  2771     MOVE 0
  2772       TO DFHEIV11
  2773*    MOVE '&2                    $   #00002482' TO DFHEIV0
  2774     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2775     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2776     MOVE X'2020233030303032343832' TO DFHEIV0(25:11)
  2777     CALL 'kxdfhei1' USING DFHEIV0,
  2778           FILE-ID-ERCMKQ2,
  2779           DFHEIV11,
  2780           DFHEIV99
  2781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2782
  2783
  2784     MOVE SPACE                  TO PI-MAINT-FUNCTION.
  2785     MOVE ER-3171                TO EMI-ERROR.
  2786     MOVE -1                     TO MAINTL.
  2787     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2788     GO TO 8200-SEND-DATAONLY.
  2789
  2790 7590-EXIT.
  2791     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL637.cbl
  2793
  2794******************************************************************
  2795*                                                                *
  2796*   R E V E R S E   P A Y M E N T S  &  A D J U S T M E N T S    *
  2797*                                                                *
  2798******************************************************************
  2799
  2800 7600-REVERSE-PMTS-ADJS.
  2801
  2802
  2803* EXEC CICS GETMAIN
  2804*         SET     (ADDRESS OF PENDING-PAY-ADJ)
  2805*         LENGTH  (ERPYAJ-RECORD-LENGTH)
  2806*         INITIMG (GETMAIN-SPACE)
  2807*    END-EXEC.
  2808*    MOVE ',"IL                  $   #00002504' TO DFHEIV0
  2809     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  2810     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2811     MOVE X'2020233030303032353034' TO DFHEIV0(25:11)
  2812     CALL 'kxdfhei1' USING DFHEIV0,
  2813           DFHEIV20,
  2814           ERPYAJ-RECORD-LENGTH,
  2815           GETMAIN-SPACE
  2816     SET ADDRESS OF PENDING-PAY-ADJ TO
  2817         DFHEIV20
  2818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2819
  2820
  2821     COMPUTE WS-WORK-SEQ-NO = EIBTIME * 10.
  2822
  2823     MOVE SPACES                 TO PENDING-PAY-ADJ.
  2824     MOVE 'PY'                   TO PY-RECORD-ID.
  2825     MOVE MQ-COMPANY-CD-A1       TO PY-COMPANY-CD.
  2826     MOVE MQ-CARRIER-A1          TO PY-CARRIER.
  2827     MOVE MQ-GROUPING-A1         TO PY-GROUPING.
  2828     MOVE MQ-PAYEE-A1            TO PY-FIN-RESP.
  2829     MOVE 'B'                    TO PY-PYMT-TYPE.
  2830     MOVE WS-CURRENT-BIN-DT      TO PY-LAST-MAINT-DT.
  2831     MOVE PI-PROCESSOR-ID        TO PY-LAST-MAINT-BY.
  2832     MOVE EIBTIME                TO PY-LAST-MAINT-HHMMSS.
  2833     MOVE PI-AR-MONTH-END-DT     TO PY-CREDIT-SELECT-DT.
  2834     MOVE LOW-VALUES             TO PY-CREDIT-ACCEPT-DT.
  2835     MOVE LOW-VALUES             TO PY-BILLED-DATE.
  2836     MOVE LOW-VALUES             TO PY-REPORTED-DT.
  2837     MOVE WS-CURRENT-BIN-DT      TO PY-INPUT-DT.
  2838     MOVE MQ-CHECK-NUMBER        TO PY-CHECK-NUMBER.
  2839     MOVE ' '                    TO PY-VOID-SW.
  2840     MOVE LOW-VALUES             TO PY-BILLED-DATE.
  2841     MOVE LOW-VALUE              TO PY-CHECK-WRITTEN-DT.
  2842     MOVE ZEROS                  TO PY-CHECK-QUE-CONTROL.
  2843     MOVE ZEROS                  TO PY-CHECK-QUE-SEQUENCE.
  2844     MOVE LOW-VALUES             TO PY-AR-DATE.
  2845     MOVE 'V'                    TO PY-CHECK-ORIGIN-SW.
  2846
  2847     MOVE +0                     TO WS-SUB1.
  2848
  2849 7610-PROCESS-PMT-ADJS.
  2850
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL637.cbl
  2851     ADD +1                      TO WS-SUB1.
  2852
  2853     IF WS-SUB1 GREATER THAN +15
  2854        GO TO 7690-EXIT.
  2855
  2856     IF MQ-LAST-MAINT-APPLIED (WS-SUB1) EQUAL 'H'
  2857         GO TO 7610-PROCESS-PMT-ADJS
  2858     ELSE
  2859         IF MQ-PYAJ-SEQ    (WS-SUB1) = ZEROS
  2860             GO TO 7690-EXIT.
  2861
  2862******************************************************************
  2863*    MODIFIED 07/14 TO MATCH FIX APPLIED TO PRODUCTION MODULE.
  2864*    THIS WAS APPLIED TO ELIMINATE DUPREC CONDITION ON WRITE OF
  2865*    PYAJ RECORDS WRITTEN IN REVERSAL
  2866******************************************************************
  2867
  2868     ADD +1                          TO WS-WORK-SEQ-HOLD.
  2869     COMPUTE PY-FILE-SEQ-NO = WS-WORK-SEQ-NO + WS-WORK-SEQ-HOLD.
  2870
  2871     MOVE MQ-PYAJ-REC-TYPE    (WS-SUB1) TO PY-RECORD-TYPE.
  2872     MOVE MQ-ACCT-AGENT       (WS-SUB1) TO PY-ACCOUNT.
  2873     MOVE MQ-INVOICE          (WS-SUB1) TO PY-BIL-INV.
  2874     MOVE MQ-REFERENCE        (WS-SUB1) TO PY-REF-NO.
  2875     MOVE MQ-LEDGER-NO        (WS-SUB1) TO PY-GL-CR.
  2876     MOVE MQ-PYAJ-PMT-APPLIED (WS-SUB1) TO PY-PMT-APPLIED.
  2877
  2878     COMPUTE PY-ENTRY-AMT = MQ-PYAJ-AMT (WS-SUB1) * -1.
  2879
  2880     MOVE 'CHECK REVERSAL'           TO PY-ENTRY-COMMENT.
  2881
  2882
  2883* EXEC CICS WRITE
  2884*         DATASET   (FILE-ID-ERPYAJ)
  2885*         FROM      (PENDING-PAY-ADJ)
  2886*         RIDFLD    (PY-CONTROL-PRIMARY)
  2887*    END-EXEC.
  2888     MOVE LENGTH OF
  2889      PENDING-PAY-ADJ
  2890       TO DFHEIV11
  2891*    MOVE '&$ L                  ''   #00002571' TO DFHEIV0
  2892     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2893     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2894     MOVE X'2020233030303032353731' TO DFHEIV0(25:11)
  2895     CALL 'kxdfhei1' USING DFHEIV0,
  2896           FILE-ID-ERPYAJ,
  2897           PENDING-PAY-ADJ,
  2898           DFHEIV11,
  2899           PY-CONTROL-PRIMARY,
  2900           DFHEIV99,
  2901           DFHEIV99
  2902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2903
  2904
  2905     GO TO 7610-PROCESS-PMT-ADJS.
  2906
  2907 7690-EXIT.
  2908     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL637.cbl
  2909
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL637.cbl
  2911
  2912
  2913******************************************************************
  2914*                                                                *
  2915*       R E V E R S E   C O M M I S S I O N   C H E C K          *
  2916*              COMMISSION CHECK FILE (ERCMCK)                    *
  2917*                                                                *
  2918******************************************************************
  2919
  2920 7700-REVERSE-COMM-CHECK.
  2921
  2922
  2923* EXEC CICS HANDLE CONDITION
  2924*        NOTFND    (7790-EXIT)
  2925*    END-EXEC.
  2926*    MOVE '"$I                   ! ( #00002594' TO DFHEIV0
  2927     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2928     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2929     MOVE X'2820233030303032353934' TO DFHEIV0(25:11)
  2930     CALL 'kxdfhei1' USING DFHEIV0
  2931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2932
  2933
  2934     MOVE MQ-COMPANY-CD          TO ERCMCK-COMPANY-CD.
  2935     MOVE MQ-CHEK-CSR            TO ERCMCK-CSR.
  2936     MOVE MQ-CHEK-CARRIER        TO ERCMCK-CARRIER.
  2937     MOVE MQ-CHEK-GROUPING       TO ERCMCK-GROUPING.
  2938     MOVE MQ-CHEK-PAYEE          TO ERCMCK-PAYEE.
  2939     MOVE MQ-CHEK-PAYEE-SEQ      TO ERCMCK-PAYEE-SEQ.
  2940     MOVE MQ-CHEK-SEQ-NO         TO ERCMCK-SEQUENCE-NO.
  2941
  2942
  2943* EXEC CICS READ
  2944*        SET     (ADDRESS OF COMM-CHECK-RECORDS)
  2945*        DATASET (FILE-ID-ERCMCK)
  2946*        RIDFLD  (ERCMCK-KEY)
  2947*        UPDATE
  2948*    END-EXEC.
  2949*    MOVE '&"S        EU         (   #00002606' TO DFHEIV0
  2950     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2951     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2952     MOVE X'2020233030303032363036' TO DFHEIV0(25:11)
  2953     CALL 'kxdfhei1' USING DFHEIV0,
  2954           FILE-ID-ERCMCK,
  2955           DFHEIV20,
  2956           DFHEIV99,
  2957           ERCMCK-KEY,
  2958           DFHEIV99,
  2959           DFHEIV99,
  2960           DFHEIV99
  2961     SET ADDRESS OF COMM-CHECK-RECORDS TO
  2962         DFHEIV20
  2963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2964
  2965
  2966     IF MQ-TEXT
  2967         PERFORM 7900-REVERSE-CHECK-TEXT-RECS THRU 7990-EXIT
  2968     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL637.cbl
  2969         PERFORM 7800-REVERSE-CHECK-WORK-RECS THRU 7890-EXIT.
  2970
  2971
  2972* EXEC CICS DELETE
  2973*         DATASET (FILE-ID-ERCMCK)
  2974*    END-EXEC.
  2975*    MOVE '&(                    &   #00002618' TO DFHEIV0
  2976     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2977     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2978     MOVE X'2020233030303032363138' TO DFHEIV0(25:11)
  2979     CALL 'kxdfhei1' USING DFHEIV0,
  2980           FILE-ID-ERCMCK,
  2981           DFHEIV99,
  2982           DFHEIV99,
  2983           DFHEIV99,
  2984           DFHEIV99
  2985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2986
  2987
  2988 7790-EXIT.
  2989     EXIT.
  2990
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL637.cbl
  2992
  2993******************************************************************
  2994*                                                                *
  2995*       R E V E R S E   C H E C K   W O R K   R E C S .          *
  2996*               CHECK WORK FILE (ERCKWK)                         *
  2997*                                                                *
  2998******************************************************************
  2999
  3000 7800-REVERSE-CHECK-WORK-RECS.
  3001
  3002
  3003* EXEC CICS HANDLE CONDITION
  3004*        NOTFND    (7810-PROCESS-CHECK-WORK-RECS)
  3005*    END-EXEC.
  3006*    MOVE '"$I                   ! ) #00002636' TO DFHEIV0
  3007     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3008     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3009     MOVE X'2920233030303032363336' TO DFHEIV0(25:11)
  3010     CALL 'kxdfhei1' USING DFHEIV0
  3011     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3012
  3013
  3014     MOVE +0                     TO WS-SUB1.
  3015
  3016 7810-PROCESS-CHECK-WORK-RECS.
  3017
  3018     ADD +1                      TO WS-SUB1.
  3019
  3020     IF WS-SUB1 GREATER THAN +15
  3021        GO TO 7870-UPDATE-HEADER-REC.
  3022
  3023     IF CK-CKWK-PAYEE      (WS-SUB1) = SPACES
  3024        GO TO 7870-UPDATE-HEADER-REC.
  3025
  3026     MOVE CK-COMPANY-CD              TO ERCKWK-COMPANY-CD.
  3027     MOVE CK-CKWK-CSR      (WS-SUB1) TO ERCKWK-CSR.
  3028     MOVE CK-CKWK-CARRIER  (WS-SUB1) TO ERCKWK-CARRIER.
  3029     MOVE CK-CKWK-GROUPING (WS-SUB1) TO ERCKWK-GROUPING.
  3030     MOVE CK-CKWK-PAYEE    (WS-SUB1) TO ERCKWK-PAYEE.
  3031     MOVE CK-CKWK-PAYEE-SEQ (WS-SUB1)
  3032                                     TO ERCKWK-PAYEE-SEQ.
  3033     MOVE CK-CKWK-SEQ-NO   (WS-SUB1) TO ERCKWK-SEQUENCE-NO.
  3034
  3035
  3036* EXEC CICS READ
  3037*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  3038*        DATASET (FILE-ID-ERCKWK)
  3039*        RIDFLD  (ERCKWK-KEY)
  3040*        UPDATE
  3041*    END-EXEC.
  3042*    MOVE '&"S        EU         (   #00002661' TO DFHEIV0
  3043     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3044     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3045     MOVE X'2020233030303032363631' TO DFHEIV0(25:11)
  3046     CALL 'kxdfhei1' USING DFHEIV0,
  3047           FILE-ID-ERCKWK,
  3048           DFHEIV20,
  3049           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL637.cbl
  3050           ERCKWK-KEY,
  3051           DFHEIV99,
  3052           DFHEIV99,
  3053           DFHEIV99
  3054     SET ADDRESS OF CHECK-WORK-RECORDS TO
  3055         DFHEIV20
  3056     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3057
  3058
  3059     MOVE 'Y'                        TO WS-ERCKWK-PROCESS-SW.
  3060
  3061     MOVE WS-CURRENT-BIN-DT          TO CW-RECORDED-DT.
  3062     MOVE PI-PROCESSOR-ID            TO CW-RECORDED-BY.
  3063     MOVE EIBTIME                    TO CW-LAST-MAINT-HHMMSS.
  3064
  3065     MOVE LOW-VALUES                 TO CW-RELEASE-DT
  3066                                        CW-CREDIT-SELECT-DT
  3067                                        CW-CREDIT-ACCEPT-DT.
  3068
  3069
  3070* EXEC CICS REWRITE
  3071*         FROM    (CHECK-WORK-RECORDS)
  3072*         DATASET (FILE-ID-ERCKWK)
  3073*    END-EXEC.
  3074     MOVE LENGTH OF
  3075      CHECK-WORK-RECORDS
  3076       TO DFHEIV11
  3077*    MOVE '&& L                  %   #00002678' TO DFHEIV0
  3078     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3079     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3080     MOVE X'2020233030303032363738' TO DFHEIV0(25:11)
  3081     CALL 'kxdfhei1' USING DFHEIV0,
  3082           FILE-ID-ERCKWK,
  3083           CHECK-WORK-RECORDS,
  3084           DFHEIV11,
  3085           DFHEIV99
  3086     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3087
  3088
  3089     GO TO 7810-PROCESS-CHECK-WORK-RECS.
  3090
  3091 7870-UPDATE-HEADER-REC.
  3092
  3093     MOVE +0                        TO ERCKWK-SEQUENCE-NO.
  3094
  3095
  3096* EXEC CICS HANDLE CONDITION
  3097*        NOTFND    (7880-HEADER-NOTFND)
  3098*    END-EXEC.
  3099*    MOVE '"$I                   ! * #00002689' TO DFHEIV0
  3100     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3101     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3102     MOVE X'2A20233030303032363839' TO DFHEIV0(25:11)
  3103     CALL 'kxdfhei1' USING DFHEIV0
  3104     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3105
  3106
  3107
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL637.cbl
  3108* EXEC CICS READ
  3109*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  3110*        DATASET (FILE-ID-ERCKWK)
  3111*        RIDFLD  (ERCKWK-KEY)
  3112*        UPDATE
  3113*    END-EXEC.
  3114*    MOVE '&"S        EU         (   #00002693' TO DFHEIV0
  3115     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3116     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3117     MOVE X'2020233030303032363933' TO DFHEIV0(25:11)
  3118     CALL 'kxdfhei1' USING DFHEIV0,
  3119           FILE-ID-ERCKWK,
  3120           DFHEIV20,
  3121           DFHEIV99,
  3122           ERCKWK-KEY,
  3123           DFHEIV99,
  3124           DFHEIV99,
  3125           DFHEIV99
  3126     SET ADDRESS OF CHECK-WORK-RECORDS TO
  3127         DFHEIV20
  3128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3129
  3130
  3131     MOVE WS-CURRENT-BIN-DT          TO CW-RECORDED-DT.
  3132     MOVE PI-PROCESSOR-ID            TO CW-RECORDED-BY.
  3133     MOVE EIBTIME                    TO CW-LAST-MAINT-HHMMSS.
  3134
  3135     MOVE LOW-VALUES                 TO CW-RELEASE-DT
  3136                                        CW-CREDIT-SELECT-DT
  3137                                        CW-CREDIT-ACCEPT-DT.
  3138
  3139
  3140* EXEC CICS REWRITE
  3141*         FROM    (CHECK-WORK-RECORDS)
  3142*         DATASET (FILE-ID-ERCKWK)
  3143*    END-EXEC.
  3144     MOVE LENGTH OF
  3145      CHECK-WORK-RECORDS
  3146       TO DFHEIV11
  3147*    MOVE '&& L                  %   #00002708' TO DFHEIV0
  3148     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3149     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3150     MOVE X'2020233030303032373038' TO DFHEIV0(25:11)
  3151     CALL 'kxdfhei1' USING DFHEIV0,
  3152           FILE-ID-ERCKWK,
  3153           CHECK-WORK-RECORDS,
  3154           DFHEIV11,
  3155           DFHEIV99
  3156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3157
  3158
  3159     GO TO 7890-EXIT.
  3160
  3161 7880-HEADER-NOTFND.
  3162
  3163     IF WS-ERCKWK-PROCESSED
  3164        NEXT SENTENCE
  3165     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL637.cbl
  3166        GO TO 7890-EXIT.
  3167
  3168
  3169* EXEC CICS SYNCPOINT ROLLBACK
  3170*    END-EXEC.
  3171*    MOVE '6"R                   !   #00002722' TO DFHEIV0
  3172     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  3173     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3174     MOVE X'2020233030303032373232' TO DFHEIV0(25:11)
  3175     CALL 'kxdfhei1' USING DFHEIV0
  3176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3177
  3178
  3179     MOVE SPACE                  TO PI-MAINT-FUNCTION.
  3180     MOVE ER-3161                TO EMI-ERROR.
  3181     MOVE -1                     TO CARL.
  3182     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3183     GO TO 8200-SEND-DATAONLY.
  3184
  3185 7890-EXIT.
  3186     EXIT.
  3187
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL637.cbl
  3189
  3190******************************************************************
  3191*                                                                *
  3192*       R E V E R S E   C H E C K   T E X T   R E C S .          *
  3193*              COMMISSION CHECK FILE (ERCMCK)                    *
  3194*                                                                *
  3195******************************************************************
  3196
  3197 7900-REVERSE-CHECK-TEXT-RECS.
  3198
  3199
  3200* EXEC CICS HANDLE CONDITION
  3201*        NOTFND    (7990-EXIT)
  3202*    END-EXEC.
  3203*    MOVE '"$I                   ! + #00002745' TO DFHEIV0
  3204     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3205     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3206     MOVE X'2B20233030303032373435' TO DFHEIV0(25:11)
  3207     CALL 'kxdfhei1' USING DFHEIV0
  3208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3209
  3210
  3211     MOVE MQ-COMPANY-CD              TO ERCKWK-COMPANY-CD.
  3212     MOVE MQ-CHEK-CSR                TO ERCKWK-CSR.
  3213     MOVE MQ-CHEK-CARRIER            TO ERCKWK-CARRIER.
  3214     MOVE MQ-CHEK-GROUPING           TO ERCKWK-GROUPING.
  3215     MOVE MQ-CHEK-PAYEE              TO ERCKWK-PAYEE.
  3216     MOVE MQ-CHEK-PAYEE-SEQ          TO ERCKWK-PAYEE-SEQ.
  3217     MOVE +8999                      TO ERCKWK-SEQUENCE-NO.
  3218
  3219 7910-PROCESS-CHECK-TEXT-RECS.
  3220
  3221     IF ERCKWK-SEQUENCE-NO LESS THAN WS-MAX-TEXT-SEQ
  3222         ADD +1                      TO ERCKWK-SEQUENCE-NO
  3223     ELSE
  3224         GO TO 7990-EXIT.
  3225
  3226
  3227* EXEC CICS READ
  3228*        SET     (ADDRESS OF CHECK-WORK-RECORDS)
  3229*        DATASET (FILE-ID-ERCKWK)
  3230*        RIDFLD  (ERCKWK-KEY)
  3231*        UPDATE
  3232*    END-EXEC.
  3233*    MOVE '&"S        EU         (   #00002764' TO DFHEIV0
  3234     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3235     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3236     MOVE X'2020233030303032373634' TO DFHEIV0(25:11)
  3237     CALL 'kxdfhei1' USING DFHEIV0,
  3238           FILE-ID-ERCKWK,
  3239           DFHEIV20,
  3240           DFHEIV99,
  3241           ERCKWK-KEY,
  3242           DFHEIV99,
  3243           DFHEIV99,
  3244           DFHEIV99
  3245     SET ADDRESS OF CHECK-WORK-RECORDS TO
  3246         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL637.cbl
  3247     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3248
  3249
  3250     MOVE 'Y'                        TO WS-ERCKWK-PROCESS-SW.
  3251
  3252     MOVE WS-CURRENT-BIN-DT          TO CW-RECORDED-DT.
  3253     MOVE PI-PROCESSOR-ID            TO CW-RECORDED-BY.
  3254     MOVE EIBTIME                    TO CW-LAST-MAINT-HHMMSS.
  3255
  3256     MOVE LOW-VALUES                 TO CW-RELEASE-DT
  3257                                        CW-CREDIT-SELECT-DT
  3258                                        CW-CREDIT-ACCEPT-DT.
  3259
  3260
  3261* EXEC CICS REWRITE
  3262*         FROM    (CHECK-WORK-RECORDS)
  3263*         DATASET (FILE-ID-ERCKWK)
  3264*    END-EXEC.
  3265     MOVE LENGTH OF
  3266      CHECK-WORK-RECORDS
  3267       TO DFHEIV11
  3268*    MOVE '&& L                  %   #00002781' TO DFHEIV0
  3269     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  3270     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3271     MOVE X'2020233030303032373831' TO DFHEIV0(25:11)
  3272     CALL 'kxdfhei1' USING DFHEIV0,
  3273           FILE-ID-ERCKWK,
  3274           CHECK-WORK-RECORDS,
  3275           DFHEIV11,
  3276           DFHEIV99
  3277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3278
  3279
  3280     GO TO 7910-PROCESS-CHECK-TEXT-RECS.
  3281
  3282 7990-EXIT.
  3283     EXIT.
  3284
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL637.cbl
  3286
  3287******************************************************************
  3288*                                                                *
  3289*             S E N D    I N I T I A L   M A P                   *
  3290*                                                                *
  3291******************************************************************
  3292
  3293 8100-SEND-INITIAL-MAP.
  3294
  3295     MOVE WS-CURRENT-DT          TO DATEO.
  3296     MOVE EIBTIME                TO TIME-IN.
  3297     MOVE TIME-OUT               TO TIMEO.
  3298     MOVE -1                     TO MAINTL.
  3299
  3300     MOVE EMI-MESSAGE-AREA (1)   TO ERMESGO.
  3301
  3302
  3303* EXEC CICS SEND
  3304*        MAP      (EL637A)
  3305*        MAPSET   (MAPSET-EL637S)
  3306*        FROM     (EL637AI)
  3307*        ERASE
  3308*        CURSOR
  3309*    END-EXEC.
  3310     MOVE LENGTH OF
  3311      EL637AI
  3312       TO DFHEIV12
  3313     MOVE -1
  3314       TO DFHEIV11
  3315*    MOVE '8$     CT  E    H L F ,   #00002808' TO DFHEIV0
  3316     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3317     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3318     MOVE X'2020233030303032383038' TO DFHEIV0(25:11)
  3319     CALL 'kxdfhei1' USING DFHEIV0,
  3320           EL637A,
  3321           EL637AI,
  3322           DFHEIV12,
  3323           MAPSET-EL637S,
  3324           DFHEIV99,
  3325           DFHEIV99,
  3326           DFHEIV99,
  3327           DFHEIV11,
  3328           DFHEIV99,
  3329           DFHEIV99,
  3330           DFHEIV99
  3331     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3332
  3333
  3334     GO TO 9100-RETURN-TRAN.
  3335
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL637.cbl
  3337
  3338******************************************************************
  3339*                                                                *
  3340*              S E N D    D A T A O N L Y                        *
  3341*                                                                *
  3342******************************************************************
  3343
  3344 8200-SEND-DATAONLY.
  3345
  3346     MOVE WS-CURRENT-DT          TO DATEO.
  3347     MOVE EIBTIME                TO TIME-IN.
  3348     MOVE TIME-OUT               TO TIMEO.
  3349
  3350     MOVE EMI-MESSAGE-AREA (1)   TO ERMESGO.
  3351
  3352
  3353* EXEC CICS SEND
  3354*         MAP      (EL637A)
  3355*         MAPSET   (MAPSET-EL637S)
  3356*         FROM     (EL637AI)
  3357*         DATAONLY
  3358*         CURSOR
  3359*    END-EXEC.
  3360     MOVE LENGTH OF
  3361      EL637AI
  3362       TO DFHEIV12
  3363     MOVE -1
  3364       TO DFHEIV11
  3365*    MOVE '8$D    CT       H L F ,   #00002834' TO DFHEIV0
  3366     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3367     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3368     MOVE X'2020233030303032383334' TO DFHEIV0(25:11)
  3369     CALL 'kxdfhei1' USING DFHEIV0,
  3370           EL637A,
  3371           EL637AI,
  3372           DFHEIV12,
  3373           MAPSET-EL637S,
  3374           DFHEIV99,
  3375           DFHEIV99,
  3376           DFHEIV99,
  3377           DFHEIV11,
  3378           DFHEIV99,
  3379           DFHEIV99,
  3380           DFHEIV99
  3381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3382
  3383
  3384     GO TO 9100-RETURN-TRAN.
  3385
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL637.cbl
  3387
  3388 8300-SEND-TEXT.
  3389
  3390* EXEC CICS SEND TEXT
  3391*        FROM     (LOGOFF-TEXT)
  3392*        LENGTH   (LOGOFF-LENGTH)
  3393*        ERASE
  3394*        FREEKB
  3395*    END-EXEC.
  3396*    MOVE '8&      T  E F  H   F -   #00002847' TO DFHEIV0
  3397     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3398     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3399     MOVE X'2020233030303032383437' TO DFHEIV0(25:11)
  3400     CALL 'kxdfhei1' USING DFHEIV0,
  3401           LOGOFF-TEXT,
  3402           LOGOFF-LENGTH,
  3403           DFHEIV99,
  3404           DFHEIV99,
  3405           DFHEIV99,
  3406           DFHEIV99,
  3407           DFHEIV99,
  3408           DFHEIV99,
  3409           DFHEIV99,
  3410           DFHEIV99,
  3411           DFHEIV99,
  3412           DFHEIV99
  3413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3414
  3415
  3416
  3417* EXEC CICS RETURN
  3418*    END-EXEC.
  3419*    MOVE '.(                    &   #00002854' TO DFHEIV0
  3420     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3421     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3422     MOVE X'2020233030303032383534' TO DFHEIV0(25:11)
  3423     CALL 'kxdfhei1' USING DFHEIV0,
  3424           DFHEIV99,
  3425           DFHEIV99,
  3426           DFHEIV99,
  3427           DFHEIV99,
  3428           DFHEIV99
  3429     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3430
  3431
  3432
  3433 8400-LOG-JOURNAL-RECORD.
  3434     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
  3435     MOVE THIS-PGM                TO JP-PROGRAM-ID.
  3436
  3437*    EXEC CICS JOURNAL
  3438*        JFILEID     (PI-JOURNAL-FILE-ID)
  3439*        JTYPEID     ('EL')
  3440*        FROM        (JOURNAL-RECORD)
  3441*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
  3442*        END-EXEC.
  3443
  3444 8500-DATE-CONVERT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL637.cbl
  3445
  3446* EXEC CICS LINK
  3447*        PROGRAM  (LINK-ELDATCV)
  3448*        COMMAREA (DATE-CONVERSION-DATA)
  3449*        LENGTH   (DC-COMM-LENGTH)
  3450*    END-EXEC.
  3451*    MOVE '."C                   ''   #00002870' TO DFHEIV0
  3452     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3453     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3454     MOVE X'2020233030303032383730' TO DFHEIV0(25:11)
  3455     CALL 'kxdfhei1' USING DFHEIV0,
  3456           LINK-ELDATCV,
  3457           DATE-CONVERSION-DATA,
  3458           DC-COMM-LENGTH,
  3459           DFHEIV99,
  3460           DFHEIV99,
  3461           DFHEIV99
  3462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3463
  3464
  3465 8500-EXIT.
  3466     EXIT.
  3467
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL637.cbl
  3469
  3470 8600-DEEDIT.
  3471
  3472
  3473* EXEC CICS BIF DEEDIT
  3474*         FIELD   (DEEDIT-FIELD)
  3475*         LENGTH  (12)
  3476*    END-EXEC.
  3477     MOVE 12
  3478       TO DFHEIV11
  3479*    MOVE '@"L                   #   #00002883' TO DFHEIV0
  3480     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3481     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3482     MOVE X'2020233030303032383833' TO DFHEIV0(25:11)
  3483     CALL 'kxdfhei1' USING DFHEIV0,
  3484           DEEDIT-FIELD,
  3485           DFHEIV11
  3486     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3487
  3488
  3489 8800-UNAUTHORIZED-ACCESS.
  3490     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3491     GO TO 8300-SEND-TEXT.
  3492
  3493 8810-PF23.
  3494     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3495     MOVE XCTL-EL005             TO PGM-NAME.
  3496     GO TO 9300-XCTL.
  3497
  3498 9200-RETURN-MAIN-MENU.
  3499     MOVE XCTL-EL626             TO PGM-NAME.
  3500     GO TO 9300-XCTL.
  3501
  3502 9000-RETURN-CICS.
  3503
  3504* EXEC CICS RETURN
  3505*    END-EXEC.
  3506*    MOVE '.(                    &   #00002902' TO DFHEIV0
  3507     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3508     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3509     MOVE X'2020233030303032393032' TO DFHEIV0(25:11)
  3510     CALL 'kxdfhei1' USING DFHEIV0,
  3511           DFHEIV99,
  3512           DFHEIV99,
  3513           DFHEIV99,
  3514           DFHEIV99,
  3515           DFHEIV99
  3516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3517
  3518
  3519 9100-RETURN-TRAN.
  3520
  3521     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3522     MOVE '852A'                 TO PI-CURRENT-SCREEN-NO.
  3523
  3524
  3525* EXEC CICS RETURN
  3526*        TRANSID    (TRANS-EXJB)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL637.cbl
  3527*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3528*        LENGTH     (PI-COMM-LENGTH)
  3529*    END-EXEC.
  3530*    MOVE '.(CT                  &   #00002910' TO DFHEIV0
  3531     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3532     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3533     MOVE X'2020233030303032393130' TO DFHEIV0(25:11)
  3534     CALL 'kxdfhei1' USING DFHEIV0,
  3535           TRANS-EXJB,
  3536           PROGRAM-INTERFACE-BLOCK,
  3537           PI-COMM-LENGTH,
  3538           DFHEIV99,
  3539           DFHEIV99
  3540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3541
  3542
  3543 9300-XCTL.
  3544
  3545* EXEC CICS XCTL
  3546*        PROGRAM    (PGM-NAME)
  3547*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3548*        LENGTH     (PI-COMM-LENGTH)
  3549*    END-EXEC.
  3550*    MOVE '.$C                   $   #00002917' TO DFHEIV0
  3551     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3552     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3553     MOVE X'2020233030303032393137' TO DFHEIV0(25:11)
  3554     CALL 'kxdfhei1' USING DFHEIV0,
  3555           PGM-NAME,
  3556           PROGRAM-INTERFACE-BLOCK,
  3557           PI-COMM-LENGTH
  3558     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3559
  3560
  3561 9400-CLEAR.
  3562     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
  3563     GO TO 9300-XCTL.
  3564
  3565 9500-PF12.
  3566     MOVE XCTL-EL010             TO PGM-NAME.
  3567     GO TO 9300-XCTL.
  3568
  3569 9600-PGMID-ERROR.
  3570
  3571
  3572* EXEC CICS HANDLE CONDITION
  3573*        PGMIDERR    (8300-SEND-TEXT)
  3574*    END-EXEC.
  3575*    MOVE '"$L                   ! , #00002933' TO DFHEIV0
  3576     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3577     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3578     MOVE X'2C20233030303032393333' TO DFHEIV0(25:11)
  3579     CALL 'kxdfhei1' USING DFHEIV0
  3580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3581
  3582
  3583     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  3584     MOVE ' '                    TO PI-ENTRY-CD-1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL637.cbl
  3585     MOVE XCTL-EL005             TO PGM-NAME.
  3586     MOVE PGM-NAME               TO LOGOFF-PGM.
  3587     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  3588     GO TO 9300-XCTL.
  3589
  3590 9900-ERROR-FORMAT.
  3591
  3592     IF NOT EMI-ERRORS-COMPLETE
  3593         MOVE LINK-EL001         TO PGM-NAME
  3594
  3595* EXEC CICS LINK
  3596*            PROGRAM    (PGM-NAME)
  3597*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  3598*            LENGTH     (EMI-COMM-LENGTH)
  3599*        END-EXEC.
  3600*    MOVE '."C                   ''   #00002948' TO DFHEIV0
  3601     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3602     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3603     MOVE X'2020233030303032393438' TO DFHEIV0(25:11)
  3604     CALL 'kxdfhei1' USING DFHEIV0,
  3605           PGM-NAME,
  3606           ERROR-MESSAGE-INTERFACE-BLOCK,
  3607           EMI-COMM-LENGTH,
  3608           DFHEIV99,
  3609           DFHEIV99,
  3610           DFHEIV99
  3611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3612
  3613
  3614 9900-EXIT.
  3615     EXIT.
  3616
  3617 9990-ABEND.
  3618     MOVE LINK-EL004             TO PGM-NAME.
  3619     MOVE DFHEIBLK               TO EMI-LINE1.
  3620
  3621* EXEC CICS LINK
  3622*        PROGRAM   (PGM-NAME)
  3623*        COMMAREA  (EMI-LINE1)
  3624*        LENGTH    (72)
  3625*    END-EXEC.
  3626     MOVE 72
  3627       TO DFHEIV11
  3628*    MOVE '."C                   ''   #00002960' TO DFHEIV0
  3629     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3630     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3631     MOVE X'2020233030303032393630' TO DFHEIV0(25:11)
  3632     CALL 'kxdfhei1' USING DFHEIV0,
  3633           PGM-NAME,
  3634           EMI-LINE1,
  3635           DFHEIV11,
  3636           DFHEIV99,
  3637           DFHEIV99,
  3638           DFHEIV99
  3639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3640
  3641
  3642     MOVE -1                     TO PFENTERL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL637.cbl
  3643
  3644     GO TO 8200-SEND-DATAONLY.
  3645
  3646
  3647* GOBACK.
  3648     MOVE '9%                    "   ' TO DFHEIV0
  3649     MOVE 'EL637' TO DFHEIV1
  3650     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3651     GOBACK.
  3652
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL637.cbl
  3654
  3655 9995-SECURITY-VIOLATION.
  3656*                            COPY ELCSCTP.
  3657******************************************************************
  3658*                                                                *
  3659*                            ELCSCTP                             *
  3660*                            VMOD=2.001                          *
  3661*                                                                *
  3662*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3663******************************************************************
  3664
  3665
  3666     MOVE EIBDATE          TO SM-JUL-DATE.
  3667     MOVE EIBTRMID         TO SM-TERMID.
  3668     MOVE THIS-PGM         TO SM-PGM.
  3669     MOVE EIBTIME          TO TIME-IN.
  3670     MOVE TIME-OUT         TO SM-TIME.
  3671     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3672
  3673
  3674* EXEC CICS LINK
  3675*         PROGRAM  ('EL003')
  3676*         COMMAREA (SECURITY-MESSAGE)
  3677*         LENGTH   (80)
  3678*    END-EXEC.
  3679     MOVE 'EL003' TO DFHEIV1
  3680     MOVE 80
  3681       TO DFHEIV11
  3682*    MOVE '."C                   ''   #00002992' TO DFHEIV0
  3683     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3684     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3685     MOVE X'2020233030303032393932' TO DFHEIV0(25:11)
  3686     CALL 'kxdfhei1' USING DFHEIV0,
  3687           DFHEIV1,
  3688           SECURITY-MESSAGE,
  3689           DFHEIV11,
  3690           DFHEIV99,
  3691           DFHEIV99,
  3692           DFHEIV99
  3693     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3694
  3695
  3696******************************************************************
  3697
  3698
  3699 9995-EXIT.
  3700     EXIT.
  3701
  3702
  3703 9999-DFHBACK SECTION.
  3704     MOVE '9%                    "   ' TO DFHEIV0
  3705     MOVE 'EL637' TO DFHEIV1
  3706     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3707     GOBACK.
  3708 9999-DFHEXIT.
  3709     IF DFHEIGDJ EQUAL 0001
  3710         NEXT SENTENCE
  3711     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL637.cbl
  3712         GO TO 9600-PGMID-ERROR,
  3713               9990-ABEND
  3714         DEPENDING ON DFHEIGDI
  3715     ELSE IF DFHEIGDJ EQUAL 3
  3716         GO TO 5090-CHECKS-NOTFND
  3717         DEPENDING ON DFHEIGDI
  3718     ELSE IF DFHEIGDJ EQUAL 4
  3719         GO TO 5070-CHECK-PROCESSED,
  3720               5060-END-OF-FILE
  3721         DEPENDING ON DFHEIGDI
  3722     ELSE IF DFHEIGDJ EQUAL 5
  3723         GO TO 6160-END-OF-FILE
  3724         DEPENDING ON DFHEIGDI
  3725     ELSE IF DFHEIGDJ EQUAL 6
  3726         GO TO 7580-PAYEE-NOTFND
  3727         DEPENDING ON DFHEIGDI
  3728     ELSE IF DFHEIGDJ EQUAL 7
  3729         GO TO 7570-COMM-CHECK-REVERSED,
  3730               7570-COMM-CHECK-REVERSED
  3731         DEPENDING ON DFHEIGDI
  3732     ELSE IF DFHEIGDJ EQUAL 8
  3733         GO TO 7790-EXIT
  3734         DEPENDING ON DFHEIGDI
  3735     ELSE IF DFHEIGDJ EQUAL 9
  3736         GO TO 7810-PROCESS-CHECK-WORK-RECS
  3737         DEPENDING ON DFHEIGDI
  3738     ELSE IF DFHEIGDJ EQUAL 10
  3739         GO TO 7880-HEADER-NOTFND
  3740         DEPENDING ON DFHEIGDI
  3741     ELSE IF DFHEIGDJ EQUAL 11
  3742         GO TO 7990-EXIT
  3743         DEPENDING ON DFHEIGDI
  3744     ELSE IF DFHEIGDJ EQUAL 12
  3745         GO TO 8300-SEND-TEXT
  3746         DEPENDING ON DFHEIGDI.
  3747     MOVE '9%                    "   ' TO DFHEIV0
  3748     MOVE 'EL637' TO DFHEIV1
  3749     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3750     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5788     Code:       10203
