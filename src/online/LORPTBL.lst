* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* LORPTBL.cbl
* Options: int("LORPTBL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("LORPTBL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"LORPTBL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"LORPTBL.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   LORPTBL.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM LORPT
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* LORPTBL.cbl
    14* 111810                   PEMA  NEW PROGRAM
    15******************************************************************
    16 ENVIRONMENT DIVISION.
    17 DATA DIVISION.
    18 working-storage section.
    19 01  DFH-START PIC X(04).
    20 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    21 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    22 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    23 77  R1                          PIC S999 COMP-3 VALUE +0.
    24 77  E1                          PIC S999 COMP-3 VALUE +0.
    25 77  A1                          PIC S9(5) COMP-3 VALUE +0.
    26 77  M1                          PIC S999 COMP-3 VALUE +0.
    27 77  WS-WORK-FIELD               PIC X(80)    VALUE SPACES.
    28 77  WS-LAST-ACT-TYPE            PIC X   VALUE ' '.
    29 77  WS-EOF-SW                   PIC X  VALUE ' '.
    30     88  END-OF-INPUT              VALUE 'Y'.
    31 77  WS-LOAN-OFF-SW              PIC X   VALUE ' '.
    32     88  LOAN-OFF-GOOD               VALUE 'Y'.
    33 77  WS-ACCT-SW                  PIC X VALUE ' '.
    34     88  FOUND-ACCOUNT               VALUE 'Y'.
    35     88  ERROR-ON-ACCOUNT            VALUE 'X'.
    36     88  NO-ACCOUNT                  VALUE 'N'.
    37 77  WS-BROWSE-SW                PIC X  VALUE ' '.
    38     88  BROWSE-STARTED             VALUE 'Y'.
    39 77  WS-TALLY                    PIC S999 COMP-3 VALUE +0.
    40 77  WS-TALLY1                   PIC S999 COMP-3 VALUE +0.
    41 77  NS-LEN                      PIC S9(5) COMP-3 VALUE +0.
    42 01  WS-XML-WORK                 PIC X(2500)  VALUE SPACES.
    43 01 response-code         pic s9(8) comp.
    44 01 display-response      pic 9(8).
    45 01 bl-index              pic 9(8) comp.
    46 01 max-last-name         pic x(18).
    47 01 first-initial         pic x.
    48 01 name-in-range-flag    pic 9.
    49 01 max-entries           pic s9(8) comp value 100.
    50 01 lower-case    pic x(26) value
    51            "abcdefghijklmnopqrstuvwxyz".
    52 01 upper-case    pic x(26) value
    53            "ABCDEFGHIJKLMNOPQRSTUVWXYZ".
    54 01  MISC.
    55     12  WS-RESPONSE             PIC S9(8)   COMP.
    56         88  RESP-NORMAL                  VALUE +00.
    57         88  RESP-NOTFND                  VALUE +13.
    58         88  RESP-DUPREC                  VALUE +14.
    59         88  RESP-DUPKEY                  VALUE +15.
    60         88  RESP-NOTOPEN                 VALUE +19.
    61         88  RESP-ENDFILE                 VALUE +20.
    62 01  WS-ERLOFC-KEY.
    63     05  WS-ERLOFC-1             PIC X(20).
    64     05  WS-ERLOFC-CODE          PIC X(5).
    65 01  WS-ERPNDB2-KEY.
    66     05  WS-ERPNDB2-COMPANY-CD    PIC X.
    67     05  WS-ERPNDB2-CARRIER       PIC X.
    68     05  WS-ERPNDB2-GROUP         PIC X(6).
    69     05  WS-ERPNDB2-STATE         PIC XX.
    70     05  WS-ERPNDB2-ACCOUNT       PIC X(10).
    71     05  WS-ERPNDB2-EFF-DT        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* LORPTBL.cbl
    72     05  WS-ERPNDB2-CERT-NO       PIC X(11).
    73 01  WS-ERACCT-KEY.
    74     05  WS-ERACCT-COMPANY-CD    PIC X.
    75     05  WS-ERACCT-CARRIER       PIC X.
    76     05  WS-ERACCT-GROUP         PIC X(6).
    77     05  WS-ERACCT-STATE         PIC XX.
    78     05  WS-ERACCT-ACCOUNT       PIC X(10).
    79     05  WS-ERACCT-EXP-DT        PIC XX.
    80     05  FILLER                  PIC XXXX.
    81*                                COPY ELCDATE.
    82******************************************************************
    83*                                                                *
    84*                                                                *
    85*                            ELCDATE.                            *
    86*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    87*                            VMOD=2.003
    88*                                                                *
    89*                                                                *
    90*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
    91*                 LENGTH = 200                                   *
    92******************************************************************
    93
    94 01  DATE-CONVERSION-DATA.
    95     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
    96     12  DC-OPTION-CODE                PIC X.
    97         88  BIN-TO-GREG                VALUE ' '.
    98         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
    99         88  EDIT-GREG-TO-BIN           VALUE '2'.
   100         88  YMD-GREG-TO-BIN            VALUE '3'.
   101         88  MDY-GREG-TO-BIN            VALUE '4'.
   102         88  JULIAN-TO-BIN              VALUE '5'.
   103         88  BIN-PLUS-ELAPSED           VALUE '6'.
   104         88  FIND-CENTURY               VALUE '7'.
   105         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   106         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   107         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   108         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   109         88  JULIAN-TO-BIN-3            VALUE 'C'.
   110         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   111         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   112         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   113         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   114         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   115         88  CHECK-LEAP-YEAR            VALUE 'H'.
   116         88  BIN-3-TO-GREG              VALUE 'I'.
   117         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   118         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   119         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   120         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   121         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   122         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   123         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   124         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   125         88  THREE-CHARACTER-BIN
   126                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   127         88  GREGORIAN-TO-BIN
   128                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   129         88  BIN-TO-GREGORIAN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* LORPTBL.cbl
   130                  VALUES ' ' '1' 'I' '8' 'G'.
   131         88  JULIAN-TO-BINARY
   132                  VALUES '5' 'C' 'E' 'F'.
   133     12  DC-ERROR-CODE                 PIC X.
   134         88  NO-CONVERSION-ERROR        VALUE ' '.
   135         88  DATE-CONVERSION-ERROR
   136                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   137         88  DATE-IS-ZERO               VALUE '1'.
   138         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   139         88  DATE-IS-INVALID            VALUE '3'.
   140         88  DATE1-GREATER-DATE2        VALUE '4'.
   141         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   142         88  DATE-INVALID-OPTION        VALUE '9'.
   143         88  INVALID-CENTURY            VALUE 'A'.
   144         88  ONLY-CENTURY               VALUE 'B'.
   145         88  ONLY-LEAP-YEAR             VALUE 'C'.
   146         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   147     12  DC-END-OF-MONTH               PIC X.
   148         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   149     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   150         88  USE-NORMAL-PROCESS         VALUE ' '.
   151         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   152         88  ADJUST-UP-100-YRS          VALUE '2'.
   153     12  FILLER                        PIC X.
   154     12  DC-CONVERSION-DATES.
   155         16  DC-BIN-DATE-1             PIC XX.
   156         16  DC-BIN-DATE-2             PIC XX.
   157         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   158         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   159                       DC-GREG-DATE-1-EDIT.
   160             20  DC-EDIT1-MONTH        PIC 99.
   161             20  SLASH1-1              PIC X.
   162             20  DC-EDIT1-DAY          PIC 99.
   163             20  SLASH1-2              PIC X.
   164             20  DC-EDIT1-YEAR         PIC 99.
   165         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   166         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   167                     DC-GREG-DATE-2-EDIT.
   168             20  DC-EDIT2-MONTH        PIC 99.
   169             20  SLASH2-1              PIC X.
   170             20  DC-EDIT2-DAY          PIC 99.
   171             20  SLASH2-2              PIC X.
   172             20  DC-EDIT2-YEAR         PIC 99.
   173         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   174         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   175                     DC-GREG-DATE-1-YMD.
   176             20  DC-YMD-YEAR           PIC 99.
   177             20  DC-YMD-MONTH          PIC 99.
   178             20  DC-YMD-DAY            PIC 99.
   179         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   180         16  DC-GREG-DATE-1-MDY-R REDEFINES
   181                      DC-GREG-DATE-1-MDY.
   182             20  DC-MDY-MONTH          PIC 99.
   183             20  DC-MDY-DAY            PIC 99.
   184             20  DC-MDY-YEAR           PIC 99.
   185         16  DC-GREG-DATE-1-ALPHA.
   186             20  DC-ALPHA-MONTH        PIC X(10).
   187             20  DC-ALPHA-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* LORPTBL.cbl
   188             20  FILLER                PIC XX.
   189             20  DC-ALPHA-CENTURY.
   190                 24 DC-ALPHA-CEN-N     PIC 99.
   191             20  DC-ALPHA-YEAR         PIC 99.
   192         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   193         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   194         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   195         16  DC-JULIAN-DATE            PIC 9(05).
   196         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   197                                       PIC 9(05).
   198         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   199             20  DC-JULIAN-YEAR        PIC 99.
   200             20  DC-JULIAN-DAYS        PIC 999.
   201         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   202         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   203         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   204     12  DATE-CONVERSION-VARIBLES.
   205         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   206         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   207             20  FILLER                PIC 9(3).
   208             20  HOLD-CEN-1-CCYY.
   209                 24  HOLD-CEN-1-CC     PIC 99.
   210                 24  HOLD-CEN-1-YY     PIC 99.
   211             20  HOLD-CEN-1-MO         PIC 99.
   212             20  HOLD-CEN-1-DA         PIC 99.
   213         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   214             20  HOLD-CEN-1-R-MO       PIC 99.
   215             20  HOLD-CEN-1-R-DA       PIC 99.
   216             20  HOLD-CEN-1-R-CCYY.
   217                 24  HOLD-CEN-1-R-CC   PIC 99.
   218                 24  HOLD-CEN-1-R-YY   PIC 99.
   219             20  FILLER                PIC 9(3).
   220         16  HOLD-CENTURY-1-X.
   221             20  FILLER                PIC X(3)  VALUE SPACES.
   222             20  HOLD-CEN-1-X-CCYY.
   223                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   224                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   225             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   226             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   227         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   228             20  HOLD-CEN-1-R-X-MO     PIC XX.
   229             20  HOLD-CEN-1-R-X-DA     PIC XX.
   230             20  HOLD-CEN-1-R-X-CCYY.
   231                 24  HOLD-CEN-1-R-X-CC PIC XX.
   232                 24  HOLD-CEN-1-R-X-YY PIC XX.
   233             20  FILLER                PIC XXX.
   234         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   235         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   236         16  DC-JULIAN-DATE-1          PIC 9(07).
   237         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   238             20  DC-JULIAN-1-CCYY.
   239                 24  DC-JULIAN-1-CC    PIC 99.
   240                 24  DC-JULIAN-1-YR    PIC 99.
   241             20  DC-JULIAN-DA-1        PIC 999.
   242         16  DC-JULIAN-DATE-2          PIC 9(07).
   243         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   244             20  DC-JULIAN-2-CCYY.
   245                 24  DC-JULIAN-2-CC    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* LORPTBL.cbl
   246                 24  DC-JULIAN-2-YR    PIC 99.
   247             20  DC-JULIAN-DA-2        PIC 999.
   248         16  DC-GREG-DATE-A-EDIT.
   249             20  DC-EDITA-MONTH        PIC 99.
   250             20  SLASHA-1              PIC X VALUE '/'.
   251             20  DC-EDITA-DAY          PIC 99.
   252             20  SLASHA-2              PIC X VALUE '/'.
   253             20  DC-EDITA-CCYY.
   254                 24  DC-EDITA-CENT     PIC 99.
   255                 24  DC-EDITA-YEAR     PIC 99.
   256         16  DC-GREG-DATE-B-EDIT.
   257             20  DC-EDITB-MONTH        PIC 99.
   258             20  SLASHB-1              PIC X VALUE '/'.
   259             20  DC-EDITB-DAY          PIC 99.
   260             20  SLASHB-2              PIC X VALUE '/'.
   261             20  DC-EDITB-CCYY.
   262                 24  DC-EDITB-CENT     PIC 99.
   263                 24  DC-EDITB-YEAR     PIC 99.
   264         16  DC-GREG-DATE-CYMD         PIC 9(08).
   265         16  DC-GREG-DATE-CYMD-R REDEFINES
   266                              DC-GREG-DATE-CYMD.
   267             20  DC-CYMD-CEN           PIC 99.
   268             20  DC-CYMD-YEAR          PIC 99.
   269             20  DC-CYMD-MONTH         PIC 99.
   270             20  DC-CYMD-DAY           PIC 99.
   271         16  DC-GREG-DATE-MDCY         PIC 9(08).
   272         16  DC-GREG-DATE-MDCY-R REDEFINES
   273                              DC-GREG-DATE-MDCY.
   274             20  DC-MDCY-MONTH         PIC 99.
   275             20  DC-MDCY-DAY           PIC 99.
   276             20  DC-MDCY-CEN           PIC 99.
   277             20  DC-MDCY-YEAR          PIC 99.
   278    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   279        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   280    12  DC-EL310-DATE                  PIC X(21).
   281    12  FILLER                         PIC X(28).
   282*                                COPY ERCLOFC.
   283******************************************************************
   284*                                                                *
   285*                                                                *
   286*                            ERCLOFC                             *
   287*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   288*                            VMOD=2.003                          *
   289*                                                                *
   290*   FILE DESCRIPTION = LOAN OFFICER CONTROLS                     *
   291*                                                                *
   292*   FILE TYPE = VSAM,KSDS                                        *
   293*   RECORD SIZE = 670   RECFORM = FIX                            *
   294*                                                                *
   295*   BASE CLUSTER NAME = ERLOFC                   RKP=2,LEN=25    *
   296*                                                                *
   297*   LOG = YES                                                    *
   298*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   299*                                                                *
   300******************************************************************
   301
   302 01  LOAN-OFFICER-MASTER.
   303     12  LO-RECORD-ID                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* LORPTBL.cbl
   304         88  VALID-LO-ID                VALUE 'LO'.
   305
   306     12  LO-CONTROL-PRIMARY.
   307         16  LO-COMPANY-CD           PIC X.
   308         16  LO-CARRIER              PIC X.
   309         16  LO-GROUPING.
   310             20  LO-GROUPING-PREFIX  PIC XXX.
   311             20  LO-GROUPING-PRIME   PIC XXX.
   312         16  LO-STATE                PIC XX.
   313         16  LO-ACCOUNT.
   314             20  LO-ACCOUNT-PREFIX   PIC X(4).
   315             20  LO-ACCOUNT-PRIME    PIC X(6).
   316         16  LO-OFFICER-CODE         PIC X(5).
   317
   318     12  LO-OFFICER-NAME             PIC X(30).
   319
   320     12  LO-LAST-MAINT-DT            PIC XX.
   321     12  LO-LAST-USER                PIC X(4).
   322     12  LO-LAST-MAINT-HHMMSS        PIC S9(6) COMP-3.
   323
   324     12  LO-COMP-CONTROL             PIC X.
   325             88  LO-SHOW-COMP           VALUE 'Y'.
   326             88  LO-SUPPRESS-COMP       VALUE 'N'.
   327     12  LO-DETAIL-CONTROL           PIC X.
   328             88  LO-PRINT-DETAIL        VALUE 'D'.
   329             88  LO-PRINT-SUMMARY       VALUE 'S'.
   330
   331     12  LO-SV-CARRIER               PIC X.
   332     12  LO-SV-GROUPING              PIC X(6).
   333     12  LO-SV-STATE                 PIC XX.
   334
   335     12  LO-PROCESS-MO-YR            PIC 9(7)  COMP-3.
   336     12  LO-TOTAL-COMMISSION         PIC S9(9)V99 COMP-3.
   337
   338     12  LO-OFFICER-INFO.
   339         16  FILLER OCCURS 12 TIMES.
   340             20  LO-LOAN-COUNT       PIC S9(5) COMP-3.
   341             20  LO-LOAN-VOLUME      PIC S9(9) COMP-3.
   342             20  LO-LF-COUNT         PIC S9(5) COMP-3.
   343             20  LO-LF-PREM          PIC S9(7) COMP-3.
   344             20  LO-LF-BENEFIT       PIC S9(9) COMP-3.
   345             20  LO-AH-COUNT         PIC S9(5) COMP-3.
   346             20  LO-AH-PREM          PIC S9(7) COMP-3.
   347             20  LO-AH-BENEFIT       PIC S9(9) COMP-3.
   348     12  FILLER                      PIC X(198).
   349******************************************************************
   350*                                COPY ERCPNDB.
   351******************************************************************
   352*                                                                *
   353*                                                                *
   354*                            ERCPNDB.                            *
   355*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   356*                            VMOD=2.025                          *
   357*                                                                *
   358*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
   359*                                                                *
   360******************************************************************
   361*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* LORPTBL.cbl
   362*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
   363******************************************************************
   364*                                                                *
   365*                                                                *
   366*   FILE TYPE = VSAM,KSDS                                        *
   367*   RECORD SIZE = 585  RECFORM = FIXED                           *
   368*                                                                *
   369*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
   370*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
   371*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
   372*                                                 RKP=13,LEN=36  *
   373*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
   374*                                      AND CHG-SEQ.)             *
   375*                                                RKP=49,LEN=11   *
   376*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
   377*                                      AND CHG-SEQ.)             *
   378*                                                RKP=60,LEN=15   *
   379*                                                                *
   380*   LOG = NO                                                     *
   381*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   382******************************************************************
   383******************************************************************
   384*                   C H A N G E   L O G
   385*
   386* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   387*-----------------------------------------------------------------
   388*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   389* EFFECTIVE    NUMBER
   390*-----------------------------------------------------------------
   391* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   392* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
   393* 011904                   PEMA  ADD TOTAL FEE PROCESSING
   394* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   395* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
   396* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   397* 032306                   PEMA  ADD BOW LOAN NUMBER
   398* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
   399* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
   400* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   401* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
   402* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
   403* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
   404* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   405******************************************************************
   406
   407 01  PENDING-BUSINESS.
   408     12  PB-RECORD-ID                     PIC XX.
   409         88  VALID-PB-ID                        VALUE 'PB'.
   410
   411     12  PB-CONTROL-PRIMARY.
   412         16  PB-COMPANY-CD                PIC X.
   413         16  PB-ENTRY-BATCH               PIC X(6).
   414         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
   415         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
   416
   417     12  PB-CONTROL-BY-ACCOUNT.
   418         16  PB-COMPANY-CD-A1             PIC X.
   419         16  PB-CARRIER                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* LORPTBL.cbl
   420         16  PB-GROUPING.
   421             20  PB-GROUPING-PREFIX       PIC XXX.
   422             20  PB-GROUPING-PRIME        PIC XXX.
   423         16  PB-STATE                     PIC XX.
   424         16  PB-ACCOUNT.
   425             20  PB-ACCOUNT-PREFIX        PIC X(4).
   426             20  PB-ACCOUNT-PRIME         PIC X(6).
   427         16  PB-CERT-EFF-DT               PIC XX.
   428         16  PB-CERT-NO.
   429             20  PB-CERT-PRIME            PIC X(10).
   430             20  PB-CERT-SFX              PIC X.
   431         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
   432
   433         16  PB-RECORD-TYPE               PIC X.
   434             88  PB-MAILING-DATA                VALUE '0'.
   435             88  PB-ISSUE                       VALUE '1'.
   436             88  PB-CANCELLATION                VALUE '2'.
   437             88  PB-BATCH-TRAILER               VALUE '9'.
   438
   439     12  PB-CONTROL-BY-ORIG-BATCH.
   440         16  PB-ORIGINAL-COMPANY-CD       PIC X.
   441         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
   442         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
   443         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
   444
   445     12  PB-CONTROL-BY-CSR.
   446         16  PB-CSR-COMPANY-CD            PIC X.
   447         16  PB-CSR-ID                    PIC X(4).
   448         16  PB-CSR-ENTRY-BATCH           PIC X(6).
   449         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
   450         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
   451******************************************************************
   452*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
   453******************************************************************
   454
   455     12  PB-LAST-MAINT-DT                 PIC XX.
   456     12  PB-LAST-MAINT-BY                 PIC X(4).
   457     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
   458
   459     12  PB-RECORD-BODY                   PIC X(375).
   460
   461     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
   462         16  PB-CERT-ORIGIN               PIC X.
   463             88  CLASIC-CREATED-CERT         VALUE '1'.
   464         16  PB-I-NAME.
   465             20  PB-I-INSURED-LAST-NAME   PIC X(15).
   466             20  PB-I-INSURED-FIRST-NAME.
   467                 24  PB-I-INSURED-1ST-INIT PIC X.
   468                 24  FILLER                PIC X(9).
   469             20  PB-I-INSURED-MIDDLE-INIT PIC X.
   470         16  PB-I-AGE                     PIC S99   COMP-3.
   471         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
   472         16  PB-I-BIRTHDAY                PIC XX.
   473         16  PB-I-INSURED-SEX             PIC X.
   474             88  PB-SEX-MALE     VALUE 'M'.
   475             88  PB-SEX-FEMALE   VALUE 'F'.
   476
   477         16  PB-I-LF-TERM                 PIC S999   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* LORPTBL.cbl
   478         16  PB-I-AH-TERM                 PIC S999   COMP-3.
   479         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
   480         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
   481         16  PB-I-SKIP-CODE               PIC X.
   482             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
   483             88  PB-SKIP-JULY              VALUE '1'.
   484             88  PB-SKIP-AUGUST            VALUE '2'.
   485             88  PB-SKIP-SEPTEMBER         VALUE '3'.
   486             88  PB-SKIP-JULY-AUG          VALUE '4'.
   487             88  PB-SKIP-AUG-SEPT          VALUE '5'.
   488             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
   489             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
   490             88  PB-SKIP-JUNE              VALUE '8'.
   491             88  PB-SKIP-JUNE-JULY         VALUE '9'.
   492             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
   493             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
   494         16  PB-I-TERM-TYPE               PIC X.
   495             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
   496             88  PB-PAID-WEEKLY            VALUE 'W'.
   497             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
   498             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
   499             88  PB-PAID-13-YEARLY         VALUE 'T'.
   500         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
   501         16  PB-I-POLICY-FORM-NO          PIC X(12).
   502         16  PB-I-DATA-ENTRY-SW           PIC X.
   503             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
   504             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
   505             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
   506             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
   507         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
   508         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
   509*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
   510         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
   511         16  FILLER                       PIC X.
   512
   513         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
   514             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
   515             88  PB-INVALID-LIFE             VALUE '  ' '00'
   516                                                   '90' THRU '99'.
   517         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
   518                                          PIC XX.
   519         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
   520         16  PB-I-AMOUNT-FINANCED REDEFINES
   521                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
   522         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
   523         16  PB-I-UNPAID-CASH-PRICE REDEFINES
   524                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
   525         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   526         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
   527         16  PB-I-CLP-AMOUNT REDEFINES
   528                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
   529         16  PB-I-LF-CALC-FLAG            PIC X.
   530             88 PB-COMP-LF-PREM               VALUE '?'.
   531         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
   532         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
   533         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
   534         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
   535         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* LORPTBL.cbl
   536         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
   537         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
   538         16  PB-I-LF-ABBR                 PIC XXX.
   539         16  PB-I-LF-INPUT-CD             PIC XX.
   540
   541         16  PB-I-AH-BENEFIT-CD           PIC XX.
   542             88  PB-VALID-AH                 VALUE '01' THRU '89'.
   543             88  PB-INVALID-AH               VALUE '  ' '00'
   544                                                   '90' THRU '99'.
   545         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
   546         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
   547         16  PB-I-AH-CALC-FLAG            PIC X.
   548             88 PB-COMP-AH-PREM                  VALUE '?'.
   549         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
   550         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
   551         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
   552         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
   553         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
   554         16  PB-I-AH-ABBR                 PIC XXX.
   555         16  PB-I-AH-INPUT-CD             PIC XXX.
   556
   557         16  PB-I-SPECIAL-REIN-CODE       PIC X.
   558         16  PB-I-REIN-TABLE              PIC XXX.
   559         16  PB-I-BUSINESS-TYPE           PIC 99.
   560         16  PB-I-INDV-GRP-CD             PIC X.
   561         16  PB-I-MORT-CODE.
   562             20  PB-I-TABLE               PIC X.
   563             20  PB-I-INTEREST            PIC XX.
   564             20  PB-I-MORT-TYP            PIC X.
   565         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
   566         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
   567         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
   568         16  PB-I-INDV-GRP-OVRD           PIC X.
   569         16  PB-I-RATE-CLASS-OVRD         PIC XX.
   570         16  PB-I-SIG-SW                  PIC X.
   571             88  PB-POLICY-SIGNED             VALUE 'Y'.
   572         16  PB-I-RATE-CLASS              PIC XX.
   573         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
   574         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
   575         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
   576         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
   577         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
   578         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
   579         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
   580         16  PB-I-BENEFIT-TYPE            PIC XXX.
   581         16  PB-I-OB-FLAG                 PIC X.
   582             88  PB-I-OB                      VALUE 'B'.
   583             88  PB-I-SUMMARY                 VALUE 'Z'.
   584         16  PB-I-ENTRY-STATUS            PIC X.
   585             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
   586                                              'M' '5' '9' '2'.
   587             88  PB-I-NORMAL-ENTRY            VALUE '1'.
   588             88  PB-I-POLICY-PENDING          VALUE '2'.
   589             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
   590             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
   591             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
   592             88  PB-I-REIN-ONLY               VALUE '9'.
   593             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* LORPTBL.cbl
   594             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
   595             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
   596             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
   597         16  PB-I-INT-CODE                PIC X.
   598             88  PB-ADD-ON-INTEREST           VALUE 'A'.
   599             88  PB-SIMPLE-INTEREST           VALUE 'S'.
   600         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
   601         16  PB-I-SOC-SEC-NO              PIC X(11).
   602         16  PB-I-MEMBER-NO               PIC X(12).
   603         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
   604*        16  PB-I-LOAN-OFFICER            PIC XXX.
   605         16  PB-I-OLD-LOF                 PIC XXX.
   606         16  PB-I-LF-EXPIRE-DT            PIC XX.
   607         16  PB-I-AH-EXPIRE-DT            PIC XX.
   608         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
   609         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
   610         16  PB-I-LIFE-INDICATOR          PIC X.
   611             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
   612         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
   613         16  PB-I-MAIL-ADDRS-SW           PIC X.
   614             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
   615             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
   616         16  PB-I-1ST-PMT-DT              PIC XX.
   617         16  PB-I-JOINT-INSURED.
   618             20 PB-I-JOINT-LAST-NAME      PIC X(15).
   619             20 PB-I-JOINT-FIRST-NAME.
   620                24  PB-I-JOINT-FIRST-INIT PIC X.
   621                24  FILLER                PIC X(9).
   622             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
   623*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
   624         16  PB-I-BENEFICIARY-NAME.
   625             20  PB-I-BANK-NUMBER         PIC X(10).
   626             20  FILLER                   PIC X(15).
   627         16  PB-I-LAST-ADD-ON-DT          PIC XX.
   628         16  PB-I-REFERENCE               PIC X(12).
   629         16  FILLER REDEFINES PB-I-REFERENCE.
   630             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
   631             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
   632             20  PB-I-CLP-STATE           PIC XX.
   633         16  PB-I-UNDERWRITING-STATUS     PIC X.
   634             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
   635             88  PB-I-POLICY-DECLINED         VALUE 'D'.
   636             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
   637         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
   638         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
   639         16  PB-I-RESIDENT-STATE          PIC XX.
   640         16  PB-I-RATE-CODE               PIC X(4).
   641         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
   642         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   643         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   644         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
   645         16  PB-I-BANK-NOCHRGB            PIC 99.
   646         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
   647         16  PB-I-JOINT-BIRTHDAY          PIC XX.
   648
   649     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
   650         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
   651             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* LORPTBL.cbl
   652         16  PB-C-CANCEL-ORIGIN           PIC X.
   653             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
   654         16  PB-C-LF-CANCEL-DT            PIC XX.
   655         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   656         16  PB-C-LF-CALC-REQ             PIC X.
   657             88 PB-COMP-LF-CANCEL            VALUE '?'.
   658         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
   659         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
   660         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
   661             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
   662         16  PB-C-AH-CANCEL-DT            PIC XX.
   663         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
   664         16  PB-C-AH-CALC-REQ             PIC X.
   665             88 PB-COMP-AH-CANCEL            VALUE '?'.
   666         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
   667         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
   668         16  PB-C-LAST-NAME               PIC X(15).
   669         16  PB-C-REFUND-SW               PIC X.
   670             88  PB-C-REFUND-CREATED          VALUE 'Y'.
   671             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
   672         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
   673         16  PB-C-PAYEE-CODE              PIC X(6).
   674         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
   675         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
   676         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
   677         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
   678         16  PB-C-REFERENCE               PIC X(12).
   679         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
   680         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
   681         16  PB-C-POST-CARD-IND           PIC X.
   682         16  PB-C-CANCEL-REASON           PIC X.
   683         16  PB-C-REF-INTERFACE-SW        PIC X.
   684         16  FILLER                       PIC X(09).
   685*        16  FILLER                       PIC X(18).
   686         16  PB-C-POLICY-FORM-NO          PIC X(12).
   687*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
   688         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
   689         16  PB-CANCELED-CERT-DATA.
   690             20  PB-CI-INSURED-NAME.
   691                 24  PB-CI-LAST-NAME      PIC X(15).
   692                 24  PB-CI-INITIALS       PIC XX.
   693             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
   694             20  PB-CI-INSURED-SEX        PIC X.
   695             20  PB-CI-LF-TERM            PIC S999        COMP-3.
   696             20  PB-CI-LF-BENEFIT-CD      PIC XX.
   697             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
   698             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
   699             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   700             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
   701             20  PB-CI-AH-TERM            PIC S999        COMP-3.
   702             20  PB-CI-AH-BENEFIT-CD      PIC XX.
   703             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
   704             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
   705             20  PB-CI-RATE-CLASS         PIC XX.
   706             20  PB-CI-RATE-DEV-LF        PIC XXX.
   707             20  PB-CI-RATE-DEV-AH        PIC XXX.
   708             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
   709             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* LORPTBL.cbl
   710             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
   711             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
   712             20  PB-CI-LF-ABBR            PIC X(3).
   713             20  PB-CI-AH-ABBR            PIC X(3).
   714             20  PB-CI-OB-FLAG            PIC X.
   715                 88  PB-CI-OB                VALUE 'B'.
   716             20  PB-CI-LF-POLICY-STATUS   PIC X.
   717                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
   718                                           'M' '4' '5' '9' '2'.
   719                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
   720                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
   721                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
   722                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
   723                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
   724                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   725                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
   726                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   727                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
   728                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
   729                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
   730                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
   731             20  PB-CI-AH-POLICY-STATUS   PIC X.
   732                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
   733                                           'M' '4' '5' '9' '2'.
   734                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
   735                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
   736                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
   737                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
   738                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
   739                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   740                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
   741                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   742                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
   743                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
   744                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
   745                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
   746             20  PB-CI-PAY-FREQUENCY      PIC 99.
   747             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
   748             20  PB-CI-SOC-SEC-NO         PIC X(11).
   749             20  PB-CI-MEMBER-NO          PIC X(12).
   750             20  PB-CI-INT-CODE           PIC X.
   751                 88  PB-CI-ADD-ON                  VALUE 'A'.
   752                 88  PB-CI-SIMPLE                  VALUE 'S'.
   753             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
   754             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
   755             20  PB-CI-COMP-EXCP-SW       PIC X.
   756                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
   757                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
   758             20  PB-CI-ENTRY-STATUS       PIC X.
   759             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
   760             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
   761             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
   762             20  PB-CI-DEATH-DT           PIC XX.
   763             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
   764             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
   765             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   766             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
   767             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* LORPTBL.cbl
   768             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
   769             20  PB-CI-ENTRY-DT              PIC XX.
   770             20  PB-CI-ENTRY-BATCH           PIC X(6).
   771             20  PB-CI-LF-EXPIRE-DT          PIC XX.
   772             20  PB-CI-AH-EXPIRE-DT          PIC XX.
   773             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
   774             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
   775             20  PB-CI-OLD-LOF               PIC XXX.
   776*            20  PB-CI-LOAN-OFFICER          PIC XXX.
   777             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
   778             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
   779             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
   780             20  PB-CI-INDV-GRP-CD           PIC X.
   781             20  PB-CI-BENEFICIARY-NAME.
   782                 24  PB-CI-BANK-NUMBER       PIC X(10).
   783                 24  FILLER                  PIC X(15).
   784             20  PB-CI-NOTE-SW               PIC X.
   785             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
   786             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
   787             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
   788             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
   789             20  PB-CI-LOAN-OFFICER          PIC X(5).
   790             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
   791             20  PB-CI-FIRST-NAME            PIC X(10).
   792
   793         16  FILLER                       PIC X(17).
   794*032306  16  FILLER                       PIC X(27).
   795*        16  FILLER                       PIC X(46).
   796
   797     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
   798         16  FILLER                       PIC X(10).
   799         16  PB-M-INSURED-LAST-NAME       PIC X(15).
   800         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
   801         16  PB-M-INSURED-MID-INIT        PIC X.
   802         16  PB-M-INSURED-AGE             PIC 99.
   803         16  PB-M-INSURED-BIRTHDAY        PIC XX.
   804         16  PB-M-INSURED-SEX             PIC X.
   805         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
   806         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
   807         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
   808         16  PB-M-INSURED-CITY-STATE.
   809             20  PB-M-INSURED-CITY        PIC X(28).
   810             20  PB-M-INSURED-STATE       PIC XX.
   811         16  PB-M-INSURED-ZIP-CODE.
   812             20  PB-M-INSURED-ZIP-PRIME.
   813                 24  PB-M-INSURED-ZIP-1   PIC X.
   814                     88  PB-M-CANADIAN-POST-CODE
   815                                             VALUE 'A' THRU 'Z'.
   816                 24  FILLER               PIC X(4).
   817             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
   818         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
   819                                        PB-M-INSURED-ZIP-CODE.
   820             20  PM-M-INS-CAN-POST1       PIC XXX.
   821             20  PM-M-INS-CAN-POST2       PIC XXX.
   822             20  FILLER                   PIC XXX.
   823         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
   824         16  PB-M-JOINT-BIRTHDAY          PIC XX.
   825         16  PB-M-CRED-BENE-NAME          PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* LORPTBL.cbl
   826         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
   827         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
   828         16  PB-M-CRED-BENE-CITYST.
   829             20  PB-M-CRED-BENE-CITY      PIC X(28).
   830             20  PB-M-CRED-BENE-STATE     PIC XX.
   831         16  FILLER                       PIC X(92).
   832
   833     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
   834         16  FILLER                       PIC X(10).
   835         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   836         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   837         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   838         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   839         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   840         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   841         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   842         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   843         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   844         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
   845         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
   846         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
   847         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
   848         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
   849         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
   850         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
   851         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
   852         16  PB-ACCOUNT-NAME              PIC X(30).
   853         16  PB-PREM-REF-RPT-FLAG         PIC X.
   854         16  PB-REFERENCE                 PIC X(12).
   855         16  PB-B-RECEIVED-DT             PIC XX.
   856         16  FILLER                       PIC X(234).
   857
   858     12  PB-RECORD-STATUS.
   859         16  PB-CREDIT-SELECT-DT          PIC XX.
   860         16  PB-CREDIT-ACCEPT-DT          PIC XX.
   861         16  PB-BILLED-DT                 PIC XX.
   862         16  PB-BILLING-STATUS            PIC X.
   863             88  PB-ENTRY-REVERSED            VALUE 'R'.
   864             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
   865             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
   866         16  PB-RECORD-BILL               PIC X.
   867             88  PB-RECORD-ON-HOLD            VALUE 'H'.
   868             88  PB-RECORD-RETURNED           VALUE 'R'.
   869             88  PB-RECORD-ENDORSED           VALUE 'E'.
   870             88  PB-OVERRIDE-LIFE             VALUE 'L'.
   871             88  PB-OVERRIDE-AH               VALUE 'A'.
   872             88  PB-OVERRIDE-BOTH             VALUE 'B'.
   873         16  PB-BATCH-ENTRY               PIC X.
   874             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
   875             88  PB-REIN-ONLY-CERT            VALUE 'R'.
   876             88  PB-REISSUED-CERT             VALUE 'E'.
   877             88  PB-MONTHLY-CERT              VALUE 'M'.
   878             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
   879             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
   880             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
   881         16  PB-FORCE-CODE                PIC X.
   882             88  PB-FORCE-OFF                 VALUE ' ' '0'.
   883             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* LORPTBL.cbl
   884             88  PB-CANCEL-FORCE              VALUE '8'.
   885             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
   886             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
   887             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
   888             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
   889             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
   890             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
   891             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
   892         16  PB-FATAL-FLAG                PIC X.
   893             88  PB-FATAL-ERRORS              VALUE 'X'.
   894         16  PB-FORCE-ER-CD               PIC X.
   895             88  PB-FORCE-ERRORS              VALUE 'F'.
   896             88  PB-UNFORCED-ERRORS           VALUE 'X'.
   897         16  PB-WARN-ER-CD                PIC X.
   898             88  PB-WARNING-ERRORS            VALUE 'W'.
   899         16  FILLER                       PIC X.
   900         16  PB-OUT-BAL-CD                PIC X.
   901             88  PB-OUT-OF-BAL                VALUE 'O'.
   902         16  PB-LIFE-OVERRIDE-L1          PIC X.
   903         16  PB-AH-OVERRIDE-L1            PIC X.
   904         16  PB-INPUT-DT                  PIC XX.
   905         16  PB-INPUT-BY                  PIC X(4).
   906         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
   907         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
   908         16  PB-TOLERANCE-REJECT-SW       PIC X.
   909         16  PB-LF-EARNING-METHOD         PIC X.
   910         16  PB-AH-EARNING-METHOD         PIC X.
   911         16  PB-LF-TERM-CALC-METHOD       PIC X.
   912         16  PB-AH-TERM-CALC-METHOD       PIC X.
   913         16  PB-REIN-CD                   PIC XXX.
   914         16  PB-LF-REFUND-TYPE            PIC X.
   915         16  PB-AH-REFUND-TYPE            PIC X.
   916         16  PB-ACCT-EFF-DT               PIC XX.
   917         16  PB-ACCT-EXP-DT               PIC XX.
   918         16  PB-COMPANY-ID                PIC X(3).
   919         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
   920         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
   921         16  PB-SV-CARRIER                PIC X.
   922         16  PB-SV-GROUPING               PIC X(6).
   923         16  PB-SV-STATE                  PIC XX.
   924         16  PB-CONFIRMATION-REPT-DT      PIC XX.
   925         16  PB-GA-BILLING-INFO.
   926             20  PB-GA-BILL-DT OCCURS 5 TIMES
   927                                          PIC XX.
   928         16  PB-SV-REMIT-TO  REDEFINES
   929             PB-GA-BILLING-INFO           PIC X(10).
   930         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
   931         16  PB-I-LOAN-OFFICER            PIC X(5).
   932         16  PB-I-VIN                     PIC X(17).
   933
   934         16  FILLER                       PIC X(04).
   935         16  IMNET-BYPASS-SW              PIC X.
   936
   937******************************************************************
   938*                COMMON EDIT ERRORS                              *
   939******************************************************************
   940
   941     12  PB-COMMON-ERRORS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* LORPTBL.cbl
   942         16  PB-COMMON-ERROR    OCCURS 10 TIMES
   943                                           PIC S9(4)     COMP.
   944
   945******************************************************************
   946*                                COPY ERCACCT.
   947******************************************************************
   948*                                                                *
   949*                                                                *
   950*                            ERCACCT                             *
   951*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   952*                            VMOD=2.031                          *
   953*                                                                *
   954*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   955*                                                                *
   956*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   957*   VSAM ACCOUNT MASTER FILES.                                   *
   958*                                                                *
   959*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   960*                                                                *
   961*   FILE TYPE = VSAM,KSDS                                        *
   962*   RECORD SIZE = 2000  RECFORM = FIX                            *
   963*                                                                *
   964*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   965*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   966*                                                                *
   967*   LOG = NO                                                     *
   968*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   969*                                                                *
   970*                                                                *
   971******************************************************************
   972*                   C H A N G E   L O G
   973*
   974* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   975*-----------------------------------------------------------------
   976*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   977* EFFECTIVE    NUMBER
   978*-----------------------------------------------------------------
   979* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   980* 092705    2005050300006  PEMA  ADD SPP LEASES
   981* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   982* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   983******************************************************************
   984
   985 01  ACCOUNT-MASTER.
   986     12  AM-RECORD-ID                      PIC XX.
   987         88  VALID-AM-ID                      VALUE 'AM'.
   988
   989     12  AM-CONTROL-PRIMARY.
   990         16  AM-COMPANY-CD                 PIC X.
   991         16  AM-MSTR-CNTRL.
   992             20  AM-CONTROL-A.
   993                 24  AM-CARRIER            PIC X.
   994                 24  AM-GROUPING.
   995                     28 AM-GROUPING-PREFIX PIC XXX.
   996                     28 AM-GROUPING-PRIME  PIC XXX.
   997                 24  AM-STATE              PIC XX.
   998                 24  AM-ACCOUNT.
   999                     28  AM-ACCOUNT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* LORPTBL.cbl
  1000                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1001             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1002                                           PIC X(19).
  1003             20  AM-CNTRL-B.
  1004                 24  AM-EXPIRATION-DT      PIC XX.
  1005                 24  FILLER                PIC X(4).
  1006             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1007                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1008
  1009     12  AM-CONTROL-BY-VAR-GRP.
  1010         16  AM-COMPANY-CD-A1              PIC X.
  1011         16  AM-VG-CARRIER                 PIC X.
  1012         16  AM-VG-GROUPING                PIC X(6).
  1013         16  AM-VG-STATE                   PIC XX.
  1014         16  AM-VG-ACCOUNT                 PIC X(10).
  1015         16  AM-VG-DATE.
  1016             20  AM-VG-EXPIRATION-DT       PIC XX.
  1017             20  FILLER                    PIC X(4).
  1018         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1019                                           PIC 9(11)      COMP-3.
  1020     12  AM-MAINT-INFORMATION.
  1021         16  AM-LAST-MAINT-DT              PIC XX.
  1022         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1023         16  AM-LAST-MAINT-USER            PIC X(4).
  1024         16  FILLER                        PIC XX.
  1025
  1026     12  AM-EFFECTIVE-DT                   PIC XX.
  1027     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1028
  1029     12  AM-PREV-DATES  COMP-3.
  1030         16  AM-PREV-EXP-DT                PIC 9(11).
  1031         16  AM-PREV-EFF-DT                PIC 9(11).
  1032
  1033     12  AM-REPORT-CODE-1                  PIC X(10).
  1034     12  AM-REPORT-CODE-2                  PIC X(10).
  1035
  1036     12  AM-CITY-CODE                      PIC X(4).
  1037     12  AM-COUNTY-PARISH                  PIC X(6).
  1038
  1039     12  AM-NAME                           PIC X(30).
  1040     12  AM-PERSON                         PIC X(30).
  1041     12  AM-ADDRS                          PIC X(30).
  1042     12  AM-CITY.
  1043         16  AM-ADDR-CITY                  PIC X(28).
  1044         16  AM-ADDR-STATE                 PIC XX.
  1045     12  AM-ZIP.
  1046         16  AM-ZIP-PRIME.
  1047             20  AM-ZIP-PRI-1ST            PIC X.
  1048                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1049             20  FILLER                    PIC X(4).
  1050         16  AM-ZIP-PLUS4                  PIC X(4).
  1051     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1052         16  AM-CAN-POSTAL-1               PIC XXX.
  1053         16  AM-CAN-POSTAL-2               PIC XXX.
  1054         16  FILLER                        PIC XXX.
  1055     12  AM-TEL-NO.
  1056         16  AM-AREA-CODE                  PIC 999.
  1057         16  AM-TEL-PRE                    PIC 999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* LORPTBL.cbl
  1058         16  AM-TEL-NBR                    PIC 9(4).
  1059     12  AM-TEL-LOC                        PIC X.
  1060         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1061         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  1062
  1063     12  AM-COMM-STRUCTURE.
  1064         16  AM-DEFN-1.
  1065             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1066                 24  AM-AGT.
  1067                     28  AM-AGT-PREFIX     PIC X(4).
  1068                     28  AM-AGT-PRIME      PIC X(6).
  1069                 24  AM-COM-TYP            PIC X.
  1070                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1071                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1072                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1073                 24  AM-RECALC-LV-INDIC    PIC X.
  1074                 24  AM-RETRO-LV-INDIC     PIC X.
  1075                 24  AM-GL-CODES           PIC X.
  1076                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1077                 24  FILLER                PIC X(01).
  1078         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1079             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1080                 24  FILLER                PIC X(11).
  1081                 24  AM-L-COMA             PIC XXX.
  1082                 24  AM-J-COMA             PIC XXX.
  1083                 24  AM-A-COMA             PIC XXX.
  1084                 24  FILLER                PIC X(6).
  1085
  1086     12  AM-COMM-CHANGE-STATUS             PIC X.
  1087         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1088
  1089     12  AM-CSR-CODE                       PIC X(4).
  1090
  1091     12  AM-BILLING-STATUS                 PIC X.
  1092         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1093         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1094     12  AM-AUTO-REFUND-SW                 PIC X.
  1095         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1096         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1097     12  AM-GPCD                           PIC 99.
  1098     12  AM-IG                             PIC X.
  1099         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1100         88  AM-HAS-GROUP                     VALUE '2'.
  1101     12  AM-STATUS                         PIC X.
  1102         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1103         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1104         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1105         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1106         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1107     12  AM-REMIT-TO                       PIC 99.
  1108     12  AM-ID-NO                          PIC X(11).
  1109
  1110     12  AM-CAL-TABLE                      PIC XX.
  1111     12  AM-LF-DEVIATION                   PIC XXX.
  1112     12  AM-AH-DEVIATION                   PIC XXX.
  1113     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1114     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1115     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* LORPTBL.cbl
  1116     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1117     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1118     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1119
  1120     12  AM-USER-FIELDS.
  1121         16  AM-FLD-1                      PIC XX.
  1122         16  AM-FLD-2                      PIC XX.
  1123         16  AM-FLD-3                      PIC XX.
  1124         16  AM-FLD-4                      PIC XX.
  1125         16  AM-FLD-5                      PIC XX.
  1126
  1127     12  AM-1ST-PROD-DATE.
  1128         16  AM-1ST-PROD-YR                PIC XX.
  1129         16  AM-1ST-PROD-MO                PIC XX.
  1130         16  AM-1ST-PROD-DA                PIC XX.
  1131     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1132     12  AM-CERTS-PURGED-DATE.
  1133         16  AM-PUR-YR                     PIC XX.
  1134         16  AM-PUR-MO                     PIC XX.
  1135         16  AM-PUR-DA                     PIC XX.
  1136     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1137     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1138     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1139     12  AM-INACTIVE-DATE.
  1140         16  AM-INA-MO                     PIC 99.
  1141         16  AM-INA-DA                     PIC 99.
  1142         16  AM-INA-YR                     PIC 99.
  1143     12  AM-AR-HI-CERT-DATE                PIC XX.
  1144
  1145     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1146     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1147
  1148     12  AM-OB-PAYMENT-MODE                PIC X.
  1149         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1150         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1151         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1152         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1153
  1154     12  AM-AH-ONLY-INDICATOR              PIC X.
  1155         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1156         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1157
  1158     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1159
  1160     12  AM-OVER-SHORT.
  1161         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1162         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1163
  1164     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1165     12  AM-DCC-CLP-STATE                  PIC XX.
  1166
  1167     12  AM-RECALC-COMM                    PIC X.
  1168     12  AM-RECALC-REIN                    PIC X.
  1169
  1170     12  AM-REI-TABLE                      PIC XXX.
  1171     12  AM-REI-ET-LF                      PIC X.
  1172     12  AM-REI-ET-AH                      PIC X.
  1173     12  AM-REI-PE-LF                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* LORPTBL.cbl
  1174     12  AM-REI-PE-AH                      PIC X.
  1175     12  AM-REI-PRT-ST                     PIC X.
  1176     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1177     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  1178     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1179     12  AM-REI-GROUP-A                    PIC X(6).
  1180     12  AM-REI-MORT                       PIC X(4).
  1181     12  AM-REI-PRT-OW                     PIC X.
  1182     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1183     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1184     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1185     12  AM-REI-GROUP-B                    PIC X(6).
  1186
  1187     12  AM-TRUST-TYPE                     PIC X(2).
  1188
  1189     12  AM-EMPLOYER-STMT-USED             PIC X.
  1190     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1191
  1192     12  AM-STD-AH-TYPE                    PIC XX.
  1193     12  AM-EARN-METHODS.
  1194         16  AM-EARN-METHOD-R              PIC X.
  1195             88 AM-REF-RL-R78                 VALUE 'R'.
  1196             88 AM-REF-RL-PR                  VALUE 'P'.
  1197             88 AM-REF-RL-MEAN                VALUE 'M'.
  1198             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1199         16  AM-EARN-METHOD-L              PIC X.
  1200             88 AM-REF-LL-R78                 VALUE 'R'.
  1201             88 AM-REF-LL-PR                  VALUE 'P'.
  1202             88 AM-REF-LL-MEAN                VALUE 'M'.
  1203             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1204         16  AM-EARN-METHOD-A              PIC X.
  1205             88 AM-REF-AH-R78                 VALUE 'R'.
  1206             88 AM-REF-AH-PR                  VALUE 'P'.
  1207             88 AM-REF-AH-MEAN                VALUE 'M'.
  1208             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1209             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1210             88 AM-REF-AH-NET                 VALUE 'N'.
  1211
  1212     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1213     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1214     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1215
  1216     12  AM-RET-Y-N                        PIC X.
  1217     12  AM-RET-P-E                        PIC X.
  1218     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1219     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1220     12  AM-RET-GRP                        PIC X(6).
  1221     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1222         16  AM-POOL-PRIME                 PIC XXX.
  1223         16  AM-POOL-SUB                   PIC XXX.
  1224     12  AM-RETRO-EARNINGS.
  1225         16  AM-RET-EARN-R                 PIC X.
  1226         16  AM-RET-EARN-L                 PIC X.
  1227         16  AM-RET-EARN-A                 PIC X.
  1228     12  AM-RET-ST-TAX-USE                 PIC X.
  1229         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1230         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1231     12  AM-RETRO-BEG-EARNINGS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* LORPTBL.cbl
  1232         16  AM-RET-BEG-EARN-R             PIC X.
  1233         16  AM-RET-BEG-EARN-L             PIC X.
  1234         16  AM-RET-BEG-EARN-A             PIC X.
  1235     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  1236     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1237
  1238     12  AM-USER-SELECT-OPTIONS.
  1239         16  AM-USER-SELECT-1              PIC X(10).
  1240         16  AM-USER-SELECT-2              PIC X(10).
  1241         16  AM-USER-SELECT-3              PIC X(10).
  1242         16  AM-USER-SELECT-4              PIC X(10).
  1243         16  AM-USER-SELECT-5              PIC X(10).
  1244
  1245     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1246
  1247     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1248
  1249     12  AM-RPT045A-SWITCH                 PIC X.
  1250         88  RPT045A-OFF                   VALUE 'N'.
  1251
  1252     12  AM-INSURANCE-LIMITS.
  1253         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1254         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1255
  1256     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1257         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1258
  1259     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1260         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1261         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1262
  1263     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1264
  1265     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1266     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1267     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1268     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1269     12  FILLER                            PIC X(5).
  1270     12  AM-REPORT-CODE-3                  PIC X(10).
  1271*    12  FILLER                            PIC X(22).
  1272
  1273     12  AM-RESERVE-DATE.
  1274         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1275         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1276         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1277
  1278     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1279     12  AM-NOTIFICATION-TYPES.
  1280         16  AM-NOTIF-OF-LETTERS           PIC X.
  1281         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1282         16  AM-NOTIF-OF-REPORTS           PIC X.
  1283         16  AM-NOTIF-OF-STATUS            PIC X.
  1284
  1285     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1286         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1287         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1288         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1289         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* LORPTBL.cbl
  1290
  1291     12  AM-BENEFIT-CONTROLS.
  1292         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1293             20  AM-BENEFIT-CODE           PIC XX.
  1294             20  AM-BENEFIT-TYPE           PIC X.
  1295             20  AM-BENEFIT-REVISION       PIC XXX.
  1296             20  AM-BENEFIT-REM-TERM       PIC X.
  1297             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1298             20  FILLER                    PIC XX.
  1299         16  FILLER                        PIC X(80).
  1300
  1301     12  AM-TRANSFER-DATA.
  1302         16  AM-TRANSFERRED-FROM.
  1303             20  AM-TRNFROM-CARRIER        PIC X.
  1304             20  AM-TRNFROM-GROUPING.
  1305                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1306                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1307             20  AM-TRNFROM-STATE          PIC XX.
  1308             20  AM-TRNFROM-ACCOUNT.
  1309                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1310                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1311             20  AM-TRNFROM-DTE            PIC XX.
  1312         16  AM-TRANSFERRED-TO.
  1313             20  AM-TRNTO-CARRIER          PIC X.
  1314             20  AM-TRNTO-GROUPING.
  1315                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1316                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1317             20  AM-TRNTO-STATE            PIC XX.
  1318             20  AM-TRNTO-ACCOUNT.
  1319                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1320                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1321             20  AM-TRNTO-DTE              PIC XX.
  1322         16  FILLER                        PIC X(10).
  1323
  1324     12  AM-SAVED-REMIT-TO                 PIC 99.
  1325
  1326     12  AM-COMM-STRUCTURE-SAVED.
  1327         16  AM-DEFN-1-SAVED.
  1328             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1329                 24  AM-AGT-SV             PIC X(10).
  1330                 24  AM-COM-TYP-SV         PIC X.
  1331                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1332                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1333                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1334                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1335                 24  FILLER                PIC X.
  1336                 24  AM-GL-CODES-SV        PIC X.
  1337                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1338                 24  FILLER                PIC X.
  1339         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1340             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1341                 24  FILLER                PIC X(11).
  1342                 24  AM-L-COMA-SV          PIC XXX.
  1343                 24  AM-J-COMA-SV          PIC XXX.
  1344                 24  AM-A-COMA-SV          PIC XXX.
  1345                 24  FILLER                PIC X(6).
  1346
  1347     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* LORPTBL.cbl
  1348         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1349            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1350            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1351            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1352
  1353     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1354     12  FILLER                            PIC X(120).
  1355
  1356     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1357         16  AM-CONTROL-NAME               PIC X(30).
  1358         16  AM-EXECUTIVE-ONE.
  1359             20  AM-EXEC1-NAME             PIC X(15).
  1360             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1361                                                          COMP-3.
  1362             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1363                                                          COMP-3.
  1364         16  AM-EXECUTIVE-TWO.
  1365             20  AM-EXEC2-NAME             PIC X(15).
  1366             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1367                                                          COMP-3.
  1368             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1369                                                          COMP-3.
  1370
  1371     12  AM-RETRO-ADDITIONAL-DATA.
  1372         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1373         16  AM-RETRO-PREM-P-E             PIC X.
  1374         16  AM-RETRO-CLMS-P-I             PIC X.
  1375         16  AM-RETRO-RET-BRACKET-LF.
  1376             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1377                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1378                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1379             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1380                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1381                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1382             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1383                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1384                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1385         16  AM-RETRO-RET-BRACKET-AH.
  1386             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1387                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1388                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1389                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1390             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1391                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1392                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1393             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1394                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1395                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1396
  1397     12  AM-COMMENTS.
  1398         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1399
  1400     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1401         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1402         16  AM-FLI-BILLING-CODE           PIC X.
  1403         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1404         16  AM-FLI-UNITED-IDENT           PIC X.
  1405         16  AM-FLI-INTEREST-LOST-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* LORPTBL.cbl
  1406             20  AM-FLI-BANK-NO            PIC X(5).
  1407             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1408             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1409             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1410         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1411             20  AM-FLI-AGT                PIC X(9).
  1412             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1413             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1414         16  FILLER                        PIC X(102).
  1415
  1416     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1417         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1418             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1419             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1420             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1421             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1422             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1423         16  FILLER                          PIC X(10).
  1424******************************************************************
  1425 01  FILLER                      PIC X(500)  VALUE SPACES.
  1426****************************************************************
  1427*
  1428* Copyright (c) 2007 by Clerity Solutions, Inc.
  1429* All rights reserved.
  1430*
  1431****************************************************************
  1432 01  DFHEIV.
  1433   02  DFHEIV0               PIC X(35).
  1434   02  DFHEIV1               PIC X(08).
  1435   02  DFHEIV2               PIC X(08).
  1436   02  DFHEIV3               PIC X(08).
  1437   02  DFHEIV4               PIC X(06).
  1438   02  DFHEIV5               PIC X(04).
  1439   02  DFHEIV6               PIC X(04).
  1440   02  DFHEIV7               PIC X(02).
  1441   02  DFHEIV8               PIC X(02).
  1442   02  DFHEIV9               PIC X(01).
  1443   02  DFHEIV10              PIC S9(7) COMP-3.
  1444   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1445   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1446   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1447   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1448   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1449   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1450   02  DFHEIV17              PIC X(04).
  1451   02  DFHEIV18              PIC X(04).
  1452   02  DFHEIV19              PIC X(04).
  1453   02  DFHEIV20              USAGE IS POINTER.
  1454   02  DFHEIV21              USAGE IS POINTER.
  1455   02  DFHEIV22              USAGE IS POINTER.
  1456   02  DFHEIV23              USAGE IS POINTER.
  1457   02  DFHEIV24              USAGE IS POINTER.
  1458   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1459   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1460   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1461   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1462   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1463   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* LORPTBL.cbl
  1464   02  FILLER                PIC X(02).
  1465   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1466   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1467   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1468   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1469   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1470 LINKAGE  SECTION.
  1471*****************************************************************
  1472*                                                               *
  1473* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1474* All rights reserved.                                          *
  1475*                                                               *
  1476*****************************************************************
  1477 01  dfheiblk.
  1478     02  eibtime          pic s9(7) comp-3.
  1479     02  eibdate          pic s9(7) comp-3.
  1480     02  eibtrnid         pic x(4).
  1481     02  eibtaskn         pic s9(7) comp-3.
  1482     02  eibtrmid         pic x(4).
  1483     02  dfheigdi         pic s9(4) comp.
  1484     02  eibcposn         pic s9(4) comp.
  1485     02  eibcalen         pic s9(4) comp.
  1486     02  eibaid           pic x(1).
  1487     02  eibfiller1       pic x(1).
  1488     02  eibfn            pic x(2).
  1489     02  eibfiller2       pic x(2).
  1490     02  eibrcode         pic x(6).
  1491     02  eibfiller3       pic x(2).
  1492     02  eibds            pic x(8).
  1493     02  eibreqid         pic x(8).
  1494     02  eibrsrce         pic x(8).
  1495     02  eibsync          pic x(1).
  1496     02  eibfree          pic x(1).
  1497     02  eibrecv          pic x(1).
  1498     02  eibsend          pic x(1).
  1499     02  eibatt           pic x(1).
  1500     02  eibeoc           pic x(1).
  1501     02  eibfmh           pic x(1).
  1502     02  eibcompl         pic x(1).
  1503     02  eibsig           pic x(1).
  1504     02  eibconf          pic x(1).
  1505     02  eiberr           pic x(1).
  1506     02  eibrldbk         pic x(1).
  1507     02  eiberrcd         pic x(4).
  1508     02  eibsynrb         pic x(1).
  1509     02  eibnodat         pic x(1).
  1510     02  eibfiller5       pic x(2).
  1511     02  eibresp          pic 9(09) comp.
  1512     02  eibresp2         pic 9(09) comp.
  1513     02  dfheigdj         pic s9(4) comp.
  1514     02  dfheigdk         pic s9(4) comp.
  1515 01 dfhcommarea.
  1516  02  BL-COMMAREA.
  1517     03  BL-OUTPUT OCCURS 200.
  1518         05  BL-CARRIER          PIC X.
  1519         05  BL-STATE            PIC XX.
  1520         05  BL-ACCOUNT          PIC X(10).
  1521         05  BL-EFF-DT           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* LORPTBL.cbl
  1522         05  BL-CERT-NO          PIC X(11).
  1523         05  BL-ISS-CAN          PIC X(10).
  1524         05  BL-LOAN-OFF         PIC X(5).
  1525         05  BL-RETURN-CODE REDEFINES BL-LOAN-OFF
  1526                                 PIC 9(5).
  1527         05  BL-BATCH-NO         PIC X(6).
  1528         05  BL-ACCT-NAME        PIC X(30).
  1529     03  BL-COUNT                PIC 999.
  1530     03  BL-STATUS.
  1531         88  BL-OK                          VALUE "P".
  1532         88  BL-FAIL                      VALUE "F".
  1533         05  BL-MESSAGE          PIC X(50).
  1534 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1535 0000-DFHEXIT SECTION.
  1536     MOVE '9#                    $   ' TO DFHEIV0.
  1537     MOVE 'LORPTBL' TO DFHEIV1.
  1538     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1539     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1540     MOVE '5'                    TO DC-OPTION-CODE
  1541     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  1542     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
  1543     MOVE DC-GREG-DATE-A-EDIT    TO WS-SAVE-EDIT-A-DATE
  1544     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
  1545     PERFORM 0000-GET-STARTED    THRU 0000-EXIT
  1546     PERFORM 0100-PROCESS-INPUT  THRU 0100-EXIT UNTIL
  1547        (END-OF-INPUT)
  1548        OR (R1 > 195)
  1549     MOVE R1                     TO BL-COUNT
  1550     IF R1 = ZEROS
  1551        MOVE 1                   TO BL-COUNT
  1552        MOVE ' ALL IS WELL IN LOAN OFFICER LAND '
  1553                                 TO BL-MESSAGE
  1554     END-IF
  1555
  1556* exec cics return end-exec.
  1557*    MOVE '.(                    &   #00001551' TO DFHEIV0
  1558     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1559     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1560     MOVE X'2020233030303031353531' TO DFHEIV0(25:11)
  1561     CALL 'kxdfhei1' USING DFHEIV0,
  1562           DFHEIV99,
  1563           DFHEIV99,
  1564           DFHEIV99,
  1565           DFHEIV99,
  1566           DFHEIV99
  1567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1568
  1569     .
  1570 0000-GET-STARTED.
  1571     MOVE X'04'                  TO WS-ERPNDB2-KEY
  1572
  1573* EXEC CICS STARTBR
  1574*        DATASET   ('ERPNDB2')
  1575*        RIDFLD    (WS-ERPNDB2-KEY)
  1576*        GTEQ
  1577*        RESP      (WS-RESPONSE)
  1578*    END-EXEC
  1579     MOVE 'ERPNDB2' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* LORPTBL.cbl
  1580     MOVE 0
  1581       TO DFHEIV11
  1582*    MOVE '&,         G          &  N#00001555' TO DFHEIV0
  1583     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1584     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1585     MOVE X'204E233030303031353535' TO DFHEIV0(25:11)
  1586     CALL 'kxdfhei1' USING DFHEIV0,
  1587           DFHEIV1,
  1588           WS-ERPNDB2-KEY,
  1589           DFHEIV99,
  1590           DFHEIV11,
  1591           DFHEIV99
  1592     MOVE EIBRESP  TO WS-RESPONSE
  1593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1594     IF NOT RESP-NORMAL
  1595        MOVE 1                   TO R1
  1596        MOVE ALL '?'             TO BL-OUTPUT (R1)
  1597        MOVE 'BAD STARTBR ON ERPNDB2 ' TO BL-MESSAGE
  1598        MOVE WS-RESPONSE         TO BL-RETURN-CODE (R1)
  1599        SET END-OF-INPUT         TO TRUE
  1600        GO TO 0000-EXIT
  1601     END-IF
  1602
  1603* EXEC CICS STARTBR
  1604*        DATASET   ('ERACCT')
  1605*        RIDFLD    (WS-ERACCT-KEY)
  1606*        GTEQ
  1607*        RESP      (WS-RESPONSE)
  1608*    END-EXEC
  1609     MOVE 'ERACCT' TO DFHEIV1
  1610     MOVE 0
  1611       TO DFHEIV11
  1612*    MOVE '&,         G          &  N#00001569' TO DFHEIV0
  1613     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1614     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1615     MOVE X'204E233030303031353639' TO DFHEIV0(25:11)
  1616     CALL 'kxdfhei1' USING DFHEIV0,
  1617           DFHEIV1,
  1618           WS-ERACCT-KEY,
  1619           DFHEIV99,
  1620           DFHEIV11,
  1621           DFHEIV99
  1622     MOVE EIBRESP  TO WS-RESPONSE
  1623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1624     IF NOT RESP-NORMAL
  1625        ADD +1                   TO R1
  1626        MOVE ALL '?'             TO BL-OUTPUT (R1)
  1627        MOVE 'BAD STARTBR ON ERACCT  ' TO BL-MESSAGE
  1628        MOVE WS-RESPONSE         TO BL-RETURN-CODE (R1)
  1629        SET END-OF-INPUT         TO TRUE
  1630     ELSE
  1631
  1632* EXEC CICS READNEXT
  1633*          INTO    (ACCOUNT-MASTER)
  1634*          DATASET ('ERACCT')
  1635*          RIDFLD  (WS-ERACCT-KEY)
  1636*          RESP    (WS-RESPONSE)
  1637*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* LORPTBL.cbl
  1638     MOVE LENGTH OF
  1639      ACCOUNT-MASTER
  1640       TO DFHEIV12
  1641     MOVE 'ERACCT' TO DFHEIV1
  1642     MOVE 0
  1643       TO DFHEIV11
  1644*    MOVE '&.IL                  )  N#00001582' TO DFHEIV0
  1645     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1646     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1647     MOVE X'204E233030303031353832' TO DFHEIV0(25:11)
  1648     CALL 'kxdfhei1' USING DFHEIV0,
  1649           DFHEIV1,
  1650           ACCOUNT-MASTER,
  1651           DFHEIV12,
  1652           WS-ERACCT-KEY,
  1653           DFHEIV99,
  1654           DFHEIV11,
  1655           DFHEIV99,
  1656           DFHEIV99
  1657     MOVE EIBRESP  TO WS-RESPONSE
  1658     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1659        IF NOT RESP-NORMAL
  1660           ADD +1                   TO R1
  1661           MOVE ALL '?'             TO BL-OUTPUT (R1)
  1662           MOVE 'BAD INIT READNEXT ON ERACCT  ' TO BL-MESSAGE
  1663           MOVE WS-RESPONSE         TO BL-RETURN-CODE (R1)
  1664           SET END-OF-INPUT         TO TRUE
  1665        END-IF
  1666     END-IF
  1667     .
  1668 0000-EXIT.
  1669     EXIT.
  1670 0100-PROCESS-INPUT.
  1671
  1672* EXEC CICS READNEXT
  1673*       INTO    (PENDING-BUSINESS)
  1674*       DATASET ('ERPNDB2')
  1675*       RIDFLD  (WS-ERPNDB2-KEY)
  1676*       RESP    (WS-RESPONSE)
  1677*    END-EXEC
  1678     MOVE LENGTH OF
  1679      PENDING-BUSINESS
  1680       TO DFHEIV12
  1681     MOVE 'ERPNDB2' TO DFHEIV1
  1682     MOVE 0
  1683       TO DFHEIV11
  1684*    MOVE '&.IL                  )  N#00001600' TO DFHEIV0
  1685     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1686     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1687     MOVE X'204E233030303031363030' TO DFHEIV0(25:11)
  1688     CALL 'kxdfhei1' USING DFHEIV0,
  1689           DFHEIV1,
  1690           PENDING-BUSINESS,
  1691           DFHEIV12,
  1692           WS-ERPNDB2-KEY,
  1693           DFHEIV99,
  1694           DFHEIV11,
  1695           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* LORPTBL.cbl
  1696           DFHEIV99
  1697     MOVE EIBRESP  TO WS-RESPONSE
  1698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1699     IF (NOT RESP-NORMAL)
  1700        OR (PB-COMPANY-CD NOT = X'04')
  1701        MOVE 'REACHED END OF CID '
  1702                                 TO BL-MESSAGE
  1703        SET END-OF-INPUT         TO TRUE
  1704        GO TO 0100-EXIT
  1705     END-IF
  1706     IF (PB-RECORD-TYPE = '1' OR '2')
  1707        AND (NOT PB-FATAL-ERRORS)
  1708        AND (NOT PB-UNFORCED-ERRORS)
  1709        AND (NOT PB-RECORD-ON-HOLD)
  1710        AND (NOT PB-RECORD-RETURNED)
  1711        AND (NOT PB-POLICY-IS-DECLINED)
  1712        AND (NOT PB-REIN-ONLY-CERT)
  1713        AND (NOT PB-REISSUED-CERT)
  1714        AND (NOT PB-POLICY-IS-VOIDED)
  1715        MOVE ' '                 TO WS-ACCT-SW
  1716     ELSE
  1717        GO TO 0100-EXIT
  1718     END-IF
  1719     PERFORM 1200-GET-ERACCT     THRU 1200-EXIT UNTIL
  1720        (FOUND-ACCOUNT)
  1721        OR (ERROR-ON-ACCOUNT)
  1722        OR (NO-ACCOUNT)
  1723     IF ERROR-ON-ACCOUNT
  1724        SET END-OF-INPUT         TO TRUE
  1725        GO TO 0100-EXIT
  1726     END-IF
  1727     IF NO-ACCOUNT
  1728        GO TO 0100-EXIT
  1729     END-IF
  1730     IF AM-EDIT-LOAN-OFC = 'Y'
  1731        PERFORM 0200-CHECK-LOAN-OFFICER
  1732                                 THRU 0200-EXIT
  1733     ELSE
  1734        GO TO 0100-EXIT
  1735     END-IF
  1736     IF LOAN-OFF-GOOD
  1737        GO TO 0100-EXIT
  1738     END-IF
  1739     ADD +1                      TO R1
  1740     MOVE PB-CARRIER             TO BL-CARRIER  (R1)
  1741     MOVE PB-STATE               TO BL-STATE    (R1)
  1742     MOVE PB-ACCOUNT             TO BL-ACCOUNT  (R1)
  1743     MOVE PB-CERT-NO             TO BL-CERT-NO  (R1)
  1744     MOVE PB-ENTRY-BATCH         TO BL-BATCH-NO (R1)
  1745     MOVE AM-NAME                TO BL-ACCT-NAME (R1)
  1746     IF PB-ISSUE
  1747        MOVE 'ISSUE'             TO BL-ISS-CAN  (R1)
  1748        MOVE PB-I-LOAN-OFFICER   TO BL-LOAN-OFF (R1)
  1749     ELSE
  1750        MOVE 'CANCEL'            TO BL-ISS-CAN  (R1)
  1751        MOVE PB-CI-LOAN-OFFICER  TO BL-LOAN-OFF (R1)
  1752     END-IF
  1753     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* LORPTBL.cbl
  1754     MOVE ' '                    TO DC-OPTION-CODE
  1755     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
  1756     IF NO-CONVERSION-ERROR
  1757        MOVE DC-GREG-DATE-A-EDIT TO BL-EFF-DT (R1)
  1758     ELSE
  1759        MOVE '01/01/1900'        TO BL-EFF-DT (R1)
  1760     END-IF
  1761     .
  1762 0100-EXIT.
  1763     EXIT.
  1764 0200-CHECK-LOAN-OFFICER.
  1765     MOVE PB-CONTROL-BY-ACCOUNT (1:20)
  1766                                 TO WS-ERLOFC-1
  1767     IF PB-ISSUE
  1768        MOVE PB-I-LOAN-OFFICER   TO WS-ERLOFC-CODE
  1769     ELSE
  1770        MOVE PB-CI-LOAN-OFFICER  TO WS-ERLOFC-CODE
  1771     END-IF
  1772     MOVE ' '                    TO WS-LOAN-OFF-SW
  1773     IF WS-ERLOFC-CODE = SPACES OR ZEROS
  1774        CONTINUE
  1775     ELSE
  1776
  1777* EXEC CICS READ
  1778*            DATASET    ('ERLOFC')
  1779*            INTO       (LOAN-OFFICER-MASTER)
  1780*            RIDFLD     (WS-ERLOFC-KEY)
  1781*            RESP       (WS-RESPONSE)
  1782*       END-EXEC
  1783     MOVE LENGTH OF
  1784      LOAN-OFFICER-MASTER
  1785       TO DFHEIV11
  1786     MOVE 'ERLOFC' TO DFHEIV1
  1787*    MOVE '&"IL       E          (  N#00001683' TO DFHEIV0
  1788     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1789     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1790     MOVE X'204E233030303031363833' TO DFHEIV0(25:11)
  1791     CALL 'kxdfhei1' USING DFHEIV0,
  1792           DFHEIV1,
  1793           LOAN-OFFICER-MASTER,
  1794           DFHEIV11,
  1795           WS-ERLOFC-KEY,
  1796           DFHEIV99,
  1797           DFHEIV99,
  1798           DFHEIV99
  1799     MOVE EIBRESP  TO WS-RESPONSE
  1800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1801        IF RESP-NORMAL
  1802           SET LOAN-OFF-GOOD     TO TRUE
  1803        END-IF
  1804     END-IF
  1805     .
  1806 0200-EXIT.
  1807     EXIT.
  1808 1200-GET-ERACCT.
  1809    IF (PB-CONTROL-BY-ACCOUNT (2:19) < AM-CONTROL-A)
  1810       SET NO-ACCOUNT            TO TRUE
  1811       GO TO 1200-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* LORPTBL.cbl
  1812    ELSE
  1813       IF (PB-CONTROL-BY-ACCOUNT (2:19) > AM-CONTROL-A)
  1814          PERFORM 1210-READNEXT  THRU 1210-EXIT
  1815          GO TO 1200-EXIT
  1816       END-IF
  1817    END-IF
  1818    IF (PB-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  1819       AND (PB-CERT-EFF-DT < AM-EXPIRATION-DT)
  1820       SET FOUND-ACCOUNT      TO TRUE
  1821       GO TO 1200-EXIT
  1822    END-IF
  1823    PERFORM 1210-READNEXT  THRU 1210-EXIT
  1824     .
  1825 1200-EXIT.
  1826     EXIT.
  1827 1210-READNEXT.
  1828
  1829* EXEC CICS READNEXT
  1830*       INTO    (ACCOUNT-MASTER)
  1831*       DATASET ('ERACCT')
  1832*       RIDFLD  (WS-ERACCT-KEY)
  1833*       RESP    (WS-RESPONSE)
  1834*    END-EXEC
  1835     MOVE LENGTH OF
  1836      ACCOUNT-MASTER
  1837       TO DFHEIV12
  1838     MOVE 'ERACCT' TO DFHEIV1
  1839     MOVE 0
  1840       TO DFHEIV11
  1841*    MOVE '&.IL                  )  N#00001716' TO DFHEIV0
  1842     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1843     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1844     MOVE X'204E233030303031373136' TO DFHEIV0(25:11)
  1845     CALL 'kxdfhei1' USING DFHEIV0,
  1846           DFHEIV1,
  1847           ACCOUNT-MASTER,
  1848           DFHEIV12,
  1849           WS-ERACCT-KEY,
  1850           DFHEIV99,
  1851           DFHEIV11,
  1852           DFHEIV99,
  1853           DFHEIV99
  1854     MOVE EIBRESP  TO WS-RESPONSE
  1855     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1856     IF NOT RESP-NORMAL
  1857        ADD +1                   TO R1
  1858        MOVE PB-CONTROL-BY-ACCOUNT (2:19)
  1859                                 TO BL-OUTPUT (R1)
  1860        MOVE 'BAD READNEXT ON ERACCT  ' TO BL-MESSAGE
  1861        MOVE WS-RESPONSE         TO BL-RETURN-CODE (R1)
  1862        SET ERROR-ON-ACCOUNT     TO TRUE
  1863     END-IF
  1864    .
  1865 1210-EXIT.
  1866     EXIT.
  1867 9700-DATE-LINK.
  1868
  1869* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* LORPTBL.cbl
  1870*        PROGRAM   ('ELDATCV')
  1871*        COMMAREA  (DATE-CONVERSION-DATA)
  1872*        LENGTH    (DC-COMM-LENGTH)
  1873*    END-EXEC.
  1874     MOVE 'ELDATCV' TO DFHEIV1
  1875*    MOVE '."C                   ''   #00001734' TO DFHEIV0
  1876     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1877     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1878     MOVE X'2020233030303031373334' TO DFHEIV0(25:11)
  1879     CALL 'kxdfhei1' USING DFHEIV0,
  1880           DFHEIV1,
  1881           DATE-CONVERSION-DATA,
  1882           DC-COMM-LENGTH,
  1883           DFHEIV99,
  1884           DFHEIV99,
  1885           DFHEIV99
  1886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1887
  1888 9700-EXIT.
  1889      EXIT.
  1890
  1891 9999-DFHBACK SECTION.
  1892     MOVE '9%                    "   ' TO DFHEIV0
  1893     MOVE 'LORPTBL' TO DFHEIV1
  1894     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1895     GOBACK.
  1896 9999-DFHEXIT.
  1897     IF DFHEIGDJ EQUAL 0001
  1898         NEXT SENTENCE.
  1899     MOVE '9%                    "   ' TO DFHEIV0
  1900     MOVE 'LORPTBL' TO DFHEIV1
  1901     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1902     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        7872     Code:        2669
