* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL930.cbl
* Options: int("EL930.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL930.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL930.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL930.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL930.
     4*                            VMOD=2.001.
     5
     6 AUTHOR.     LOGIC,INC.
     7             DALLAS, TEXAS.
     8
     9 DATE-COMPILED. 02-Nov-12 23:15.
    10 SECURITY.   *****************************************************
    11             *                                                   *
    12             *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    13             *                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL930.cbl
    14             *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    15             *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    16             *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    17             *                                                   *
    18             *****************************************************
    19
    20 REMARKS.    TRANSACTION - EXI1 - NEW BUSINESS - DATA ENTRY.
    21
    22 ENVIRONMENT DIVISION.
    23
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL930.cbl
    25 DATA DIVISION.
    26 WORKING-STORAGE SECTION.
    27 01  DFH-START PIC X(04).
    28 77  FILLER  PIC X(32)  VALUE '********************************'.
    29 77  FILLER  PIC X(32)  VALUE '*    EL930 WORKING STORAGE     *'.
    30 77  FILLER  PIC X(32)  VALUE '************ V/M 2.001 *********'.
    31
    32*                            COPY ELCSCTM.
    33******************************************************************
    34*                                                                *
    35*                                                                *
    36*                            ELCSCTM                             *
    37*                            VMOD=2.001                          *
    38*                                                                *
    39*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    40*                                                                *
    41******************************************************************
    42 01  SECURITY-MESSAGE.
    43     12  FILLER                          PIC X(30)
    44            VALUE '** LOGIC SECURITY VIOLATION -'.
    45     12  SM-READ                         PIC X(6).
    46     12  FILLER                          PIC X(5)
    47            VALUE ' PGM='.
    48     12  SM-PGM                          PIC X(6).
    49     12  FILLER                          PIC X(5)
    50            VALUE ' OPR='.
    51     12  SM-PROCESSOR-ID                 PIC X(4).
    52     12  FILLER                          PIC X(6)
    53            VALUE ' TERM='.
    54     12  SM-TERMID                       PIC X(4).
    55     12  FILLER                          PIC XX   VALUE SPACE.
    56     12  SM-JUL-DATE                     PIC 9(5).
    57     12  FILLER                          PIC X    VALUE SPACE.
    58     12  SM-TIME                         PIC 99.99.
    59
    60
    61*                            COPY ELCSCRTY.
    62******************************************************************
    63*                                                                *
    64*                                                                *
    65*                            ELCSCRTY                            *
    66*                            VMOD=2.001                          *
    67*                                                                *
    68*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    69*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    70*        SAVED IN PI-SECURITY-ADDRESS.                           *
    71*                                                                *
    72******************************************************************
    73 01  SECURITY-CONTROL.
    74     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    75     12  FILLER                       PIC XX    VALUE 'SC'.
    76     12  SC-CREDIT-CODES.
    77         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    78             20  SC-CREDIT-DISPLAY    PIC X.
    79             20  SC-CREDIT-UPDATE     PIC X.
    80     12  SC-CLAIMS-CODES.
    81         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    82             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL930.cbl
    83             20  SC-CLAIMS-UPDATE     PIC X.
    84
    85 01  STANDARD-AREAS.
    86     12  SC-ITEM                 PIC S9(4) COMP VALUE +1.
    87     12  GETMAIN-SPACE           PIC X       VALUE SPACE.
    88     12  MAP-NAME                PIC X(8)    VALUE 'EL930A  '.
    89     12  MAPSET-NAME             PIC X(8)    VALUE 'EL930S  '.
    90     12  SCREEN-NUMBER           PIC X(4)    VALUE '930A'.
    91     12  TRANS-ID                PIC X(4)    VALUE 'EXI1'.
    92     12  EDIT-TRANS              PIC X(4)    VALUE 'EXBT'.
    93     12  PASS-AREA-LEN           PIC S9(4)   COMP VALUE +16.
    94     12  THIS-PGM                PIC X(8)    VALUE 'EL930   '.
    95     12  PGM-NAME                PIC X(8).
    96     12  TIME-IN                 PIC S9(7).
    97     12  TIME-OUT-R  REDEFINES TIME-IN.
    98         16  FILLER              PIC X.
    99         16  TIME-OUT            PIC 99V99.
   100         16  FILLER              PIC X(2).
   101     12  XCTL-005                PIC X(8)    VALUE 'EL005   '.
   102     12  XCTL-010                PIC X(8)    VALUE 'EL010   '.
   103     12  XCTL-626                PIC X(8)    VALUE 'EL626   '.
   104     12  XCTL-9301               PIC X(8)    VALUE 'EL9301  '.
   105     12  XCTL-9302               PIC X(8)    VALUE 'EL9302  '.
   106     12  XCTL-633                PIC X(8)    VALUE 'EL633   '.
   107     12  LINK-001                PIC X(8)    VALUE 'EL001   '.
   108     12  LINK-004                PIC X(8)    VALUE 'EL004   '.
   109     12  LINK-CLDATCV            PIC X(8)    VALUE 'ELDATCV '.
   110     12  ELCNTL-FILE-ID          PIC X(8)    VALUE 'ELCNTL  '.
   111     12  ERPNDT-FILE-ID          PIC X(8)    VALUE 'ERPNDT  '.
   112     12  ELCERT-FILE-ID          PIC X(8)    VALUE 'ELCERT  '.
   113     12  ERNOTE-FILE-ID          PIC X(8)    VALUE 'ERNOTE  '.
   114     12  ERMAIL-FILE-ID          PIC X(8)    VALUE 'ERMAIL  '.
   115     12  ERPNDM-FILE-ID          PIC X(8)    VALUE 'ERPNDM  '.
   116     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   117     12  WS-CURRENT-DT           PIC X(8)    VALUE SPACES.
   118     12  WS-SYNC-CNTR            PIC S9(3)   VALUE +0 COMP-3.
   119
   120     12  WS-RECORD-LENGTHS   COMP.
   121        16  WS-ERNOTE-RECORD-LENGTH  PIC S9(4)   VALUE +500.
   122        16  WS-ERPNDT-RECORD-LENGTH  PIC S9(4)   VALUE +585.
   123        16  WS-ERMAIL-RECORD-LENGTH  PIC S9(4)   VALUE +250.
   124        16  WS-ERPNDM-RECORD-LENGTH  PIC S9(4)   VALUE +250.
   125        16  WS-ELCERT-RECORD-LENGTH  PIC S9(4)   VALUE +450.
   126        16  WS-ELCNTL-RECORD-LENGTH  PIC S9(4)   VALUE +504.
   127        16  WS-JOURNAL-RECORD-LENGTH PIC S9(4)   VALUE ZEROS.
   128
   129 01  BATCH-TO-PROCESS.
   130     05  EDIT-COMPANY-CD         PIC X.
   131     05  EDIT-BATCH              PIC X(6).
   132     05  EDIT-COMPANY-ID         PIC XXX.
   133     05  EDIT-RESTART-BATCH      PIC X(6).
   134
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL930.cbl
   136
   137 01  ERROR-MESSAGES.
   138     12  ER-0008                 PIC X(4)    VALUE '0008'.
   139     12  ER-0023                 PIC X(4)    VALUE '0023'.
   140     12  ER-0029                 PIC X(4)    VALUE '0029'.
   141     12  ER-0070                 PIC X(4)    VALUE '0070'.
   142     12  ER-0194                 PIC X(4)    VALUE '0194'.
   143     12  ER-0195                 PIC X(4)    VALUE '0195'.
   144     12  ER-0196                 PIC X(4)    VALUE '0196'.
   145     12  ER-0197                 PIC X(4)    VALUE '0197'.
   146     12  ER-0340                 PIC X(4)    VALUE '0340'.
   147     12  ER-2201                 PIC X(4)    VALUE '2201'.
   148     12  ER-2208                 PIC X(4)    VALUE '2208'.
   149     12  ER-2209                 PIC X(4)    VALUE '2209'.
   150     12  ER-2210                 PIC X(4)    VALUE '2210'.
   151     12  ER-2211                 PIC X(4)    VALUE '2211'.
   152     12  ER-2212                 PIC X(4)    VALUE '2212'.
   153     12  ER-2213                 PIC X(4)    VALUE '2213'.
   154     12  ER-2214                 PIC X(4)    VALUE '2214'.
   155     12  ER-2215                 PIC X(4)    VALUE '2215'.
   156     12  ER-2216                 PIC X(4)    VALUE '2216'.
   157     12  ER-2229                 PIC X(4)    VALUE '2229'.
   158     12  ER-2242                 PIC X(4)    VALUE '2242'.
   159     12  ER-2248                 PIC X(4)    VALUE '2248'.
   160     12  ER-2370                 PIC X(4)    VALUE '2370'.
   161     12  ER-2371                 PIC X(4)    VALUE '2371'.
   162     12  ER-2402                 PIC X(4)    VALUE '2402'.
   163     12  ER-2422                 PIC X(4)    VALUE '2422'.
   164
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL930.cbl
   166
   167 01  ACCESS-KEYS.
   168     12  ELCNTL-KEY.
   169         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   170         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   171         16  CNTL-ACCESS.
   172             20  CNTL-STATE      PIC XX    VALUE SPACES.
   173             20  FILLER          PIC X     VALUE SPACES.
   174             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   175         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   176
   177     12  ERPNDT-KEY.
   178         16  PNDT-COMP-CD        PIC X     VALUE SPACE.
   179         16  PNDT-ENTRY-BATCH    PIC X(6)  VALUE SPACES.
   180         16  PNDT-BATCH-SEQ      PIC S9(4) VALUE +0 COMP.
   181         16  PNDT-BATCH-CHG-SEQ  PIC S9(4) VALUE +0 COMP.
   182
   183     12  ELCERT-KEY.
   184         16  CERT-COMPANY-CD     PIC X     VALUE SPACES.
   185         16  CERT-CARRIER        PIC X     VALUE SPACES.
   186         16  CERT-GROUPING       PIC X(6)  VALUE SPACES.
   187         16  CERT-STATE          PIC XX    VALUE SPACES.
   188         16  FILLER              PIC X(23) VALUE SPACES.
   189
   190 01  FILLER.
   191     12  WS-DEEDIT-FIELD         PIC S9(8)V99.
   192     12  WS-DT-DEEDIT-FIELD REDEFINES
   193         WS-DEEDIT-FIELD         PIC X(10).
   194     12  QUESTION-MARKS          PIC X(6)  VALUE '??????'.
   195     12  WS-BATCH-NO             PIC 9(6)  VALUE ZEROS.
   196     12  WS-OBAL                 PIC S9(8)V99  VALUE ZEROS.
   197     12  WS-OCNT                 PIC S9(5)     VALUE ZEROS.
   198     12  WS-DELETE-CNT           PIC S9(5)     VALUE ZEROS.
   199     12  WS-PF1-SW               PIC X         VALUE SPACES.
   200         88  WS-PF1                            VALUE 'Y'.
   201
   202     12  WS-SAV-PNDT-KEY.
   203         16  WS-SAV-COMP-CD        PIC X.
   204         16  WS-SAV-ENTRY-BATCH    PIC X(6).
   205         16  WS-SAV-BATCH-SEQ      PIC S9(4) COMP.
   206         16  WS-SAV-BATCH-CHG-SEQ  PIC S9(4) COMP.
   207
   208     12  DATE-TEST-AREA          PIC 9(6).
   209     12  DATE-TEST-AREA-R  REDEFINES DATE-TEST-AREA.
   210         16  DATE-TEST-MM        PIC 99.
   211         16  DATE-TEST-DD        PIC 99.
   212         16  DATE-TEST-YY        PIC 99.
   213     12  DIVIDE-RESULT           PIC 99.
   214     12  DIVIDE-REMAINDER        PIC 9.
   215     12  WS-CERT-NOTE-SW         PIC X   VALUE ' '.
   216         88 CERT-NOTES-ARE-PRESENT  VALUE 'Y'.
   217     12  WS-CERT-ADDRESS-SW      PIC X   VALUE ' '.
   218         88 CERT-ADDRESS-PRESENT     VALUE 'Y'.
   219     12  WS-PRM-HEADER.
   220         16  WS-PRM-OVERRIDE     PIC XX    VALUE SPACES.
   221         16  FILLER              PIC X(8)  VALUE '-PREMIUM'.
   222     12  WS-REFUND-HEADER.
   223         16  WS-REFUND-OVERRIDE  PIC XX    VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL930.cbl
   224         16  FILLER              PIC X(7)  VALUE '-REFUND'.
   225
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL930.cbl
   227
   228*                            COPY ELCDATE.
   229******************************************************************
   230*                                                                *
   231*                                                                *
   232*                            ELCDATE.                            *
   233*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   234*                            VMOD=2.003
   235*                                                                *
   236*                                                                *
   237*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   238*                 LENGTH = 200                                   *
   239******************************************************************
   240
   241 01  DATE-CONVERSION-DATA.
   242     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   243     12  DC-OPTION-CODE                PIC X.
   244         88  BIN-TO-GREG                VALUE ' '.
   245         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   246         88  EDIT-GREG-TO-BIN           VALUE '2'.
   247         88  YMD-GREG-TO-BIN            VALUE '3'.
   248         88  MDY-GREG-TO-BIN            VALUE '4'.
   249         88  JULIAN-TO-BIN              VALUE '5'.
   250         88  BIN-PLUS-ELAPSED           VALUE '6'.
   251         88  FIND-CENTURY               VALUE '7'.
   252         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   253         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   254         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   255         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   256         88  JULIAN-TO-BIN-3            VALUE 'C'.
   257         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   258         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   259         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   260         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   261         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   262         88  CHECK-LEAP-YEAR            VALUE 'H'.
   263         88  BIN-3-TO-GREG              VALUE 'I'.
   264         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   265         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   266         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   267         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   268         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   269         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   270         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   271         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   272         88  THREE-CHARACTER-BIN
   273                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   274         88  GREGORIAN-TO-BIN
   275                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   276         88  BIN-TO-GREGORIAN
   277                  VALUES ' ' '1' 'I' '8' 'G'.
   278         88  JULIAN-TO-BINARY
   279                  VALUES '5' 'C' 'E' 'F'.
   280     12  DC-ERROR-CODE                 PIC X.
   281         88  NO-CONVERSION-ERROR        VALUE ' '.
   282         88  DATE-CONVERSION-ERROR
   283                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   284         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL930.cbl
   285         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   286         88  DATE-IS-INVALID            VALUE '3'.
   287         88  DATE1-GREATER-DATE2        VALUE '4'.
   288         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   289         88  DATE-INVALID-OPTION        VALUE '9'.
   290         88  INVALID-CENTURY            VALUE 'A'.
   291         88  ONLY-CENTURY               VALUE 'B'.
   292         88  ONLY-LEAP-YEAR             VALUE 'C'.
   293         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   294     12  DC-END-OF-MONTH               PIC X.
   295         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   296     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   297         88  USE-NORMAL-PROCESS         VALUE ' '.
   298         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   299         88  ADJUST-UP-100-YRS          VALUE '2'.
   300     12  FILLER                        PIC X.
   301     12  DC-CONVERSION-DATES.
   302         16  DC-BIN-DATE-1             PIC XX.
   303         16  DC-BIN-DATE-2             PIC XX.
   304         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   305         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   306                       DC-GREG-DATE-1-EDIT.
   307             20  DC-EDIT1-MONTH        PIC 99.
   308             20  SLASH1-1              PIC X.
   309             20  DC-EDIT1-DAY          PIC 99.
   310             20  SLASH1-2              PIC X.
   311             20  DC-EDIT1-YEAR         PIC 99.
   312         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   313         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   314                     DC-GREG-DATE-2-EDIT.
   315             20  DC-EDIT2-MONTH        PIC 99.
   316             20  SLASH2-1              PIC X.
   317             20  DC-EDIT2-DAY          PIC 99.
   318             20  SLASH2-2              PIC X.
   319             20  DC-EDIT2-YEAR         PIC 99.
   320         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   321         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   322                     DC-GREG-DATE-1-YMD.
   323             20  DC-YMD-YEAR           PIC 99.
   324             20  DC-YMD-MONTH          PIC 99.
   325             20  DC-YMD-DAY            PIC 99.
   326         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   327         16  DC-GREG-DATE-1-MDY-R REDEFINES
   328                      DC-GREG-DATE-1-MDY.
   329             20  DC-MDY-MONTH          PIC 99.
   330             20  DC-MDY-DAY            PIC 99.
   331             20  DC-MDY-YEAR           PIC 99.
   332         16  DC-GREG-DATE-1-ALPHA.
   333             20  DC-ALPHA-MONTH        PIC X(10).
   334             20  DC-ALPHA-DAY          PIC 99.
   335             20  FILLER                PIC XX.
   336             20  DC-ALPHA-CENTURY.
   337                 24 DC-ALPHA-CEN-N     PIC 99.
   338             20  DC-ALPHA-YEAR         PIC 99.
   339         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   340         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   341         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   342         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL930.cbl
   343         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   344                                       PIC 9(05).
   345         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   346             20  DC-JULIAN-YEAR        PIC 99.
   347             20  DC-JULIAN-DAYS        PIC 999.
   348         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   349         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   350         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   351     12  DATE-CONVERSION-VARIBLES.
   352         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   353         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   354             20  FILLER                PIC 9(3).
   355             20  HOLD-CEN-1-CCYY.
   356                 24  HOLD-CEN-1-CC     PIC 99.
   357                 24  HOLD-CEN-1-YY     PIC 99.
   358             20  HOLD-CEN-1-MO         PIC 99.
   359             20  HOLD-CEN-1-DA         PIC 99.
   360         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   361             20  HOLD-CEN-1-R-MO       PIC 99.
   362             20  HOLD-CEN-1-R-DA       PIC 99.
   363             20  HOLD-CEN-1-R-CCYY.
   364                 24  HOLD-CEN-1-R-CC   PIC 99.
   365                 24  HOLD-CEN-1-R-YY   PIC 99.
   366             20  FILLER                PIC 9(3).
   367         16  HOLD-CENTURY-1-X.
   368             20  FILLER                PIC X(3)  VALUE SPACES.
   369             20  HOLD-CEN-1-X-CCYY.
   370                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   371                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   372             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   373             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   374         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   375             20  HOLD-CEN-1-R-X-MO     PIC XX.
   376             20  HOLD-CEN-1-R-X-DA     PIC XX.
   377             20  HOLD-CEN-1-R-X-CCYY.
   378                 24  HOLD-CEN-1-R-X-CC PIC XX.
   379                 24  HOLD-CEN-1-R-X-YY PIC XX.
   380             20  FILLER                PIC XXX.
   381         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   382         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   383         16  DC-JULIAN-DATE-1          PIC 9(07).
   384         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   385             20  DC-JULIAN-1-CCYY.
   386                 24  DC-JULIAN-1-CC    PIC 99.
   387                 24  DC-JULIAN-1-YR    PIC 99.
   388             20  DC-JULIAN-DA-1        PIC 999.
   389         16  DC-JULIAN-DATE-2          PIC 9(07).
   390         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   391             20  DC-JULIAN-2-CCYY.
   392                 24  DC-JULIAN-2-CC    PIC 99.
   393                 24  DC-JULIAN-2-YR    PIC 99.
   394             20  DC-JULIAN-DA-2        PIC 999.
   395         16  DC-GREG-DATE-A-EDIT.
   396             20  DC-EDITA-MONTH        PIC 99.
   397             20  SLASHA-1              PIC X VALUE '/'.
   398             20  DC-EDITA-DAY          PIC 99.
   399             20  SLASHA-2              PIC X VALUE '/'.
   400             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL930.cbl
   401                 24  DC-EDITA-CENT     PIC 99.
   402                 24  DC-EDITA-YEAR     PIC 99.
   403         16  DC-GREG-DATE-B-EDIT.
   404             20  DC-EDITB-MONTH        PIC 99.
   405             20  SLASHB-1              PIC X VALUE '/'.
   406             20  DC-EDITB-DAY          PIC 99.
   407             20  SLASHB-2              PIC X VALUE '/'.
   408             20  DC-EDITB-CCYY.
   409                 24  DC-EDITB-CENT     PIC 99.
   410                 24  DC-EDITB-YEAR     PIC 99.
   411         16  DC-GREG-DATE-CYMD         PIC 9(08).
   412         16  DC-GREG-DATE-CYMD-R REDEFINES
   413                              DC-GREG-DATE-CYMD.
   414             20  DC-CYMD-CEN           PIC 99.
   415             20  DC-CYMD-YEAR          PIC 99.
   416             20  DC-CYMD-MONTH         PIC 99.
   417             20  DC-CYMD-DAY           PIC 99.
   418         16  DC-GREG-DATE-MDCY         PIC 9(08).
   419         16  DC-GREG-DATE-MDCY-R REDEFINES
   420                              DC-GREG-DATE-MDCY.
   421             20  DC-MDCY-MONTH         PIC 99.
   422             20  DC-MDCY-DAY           PIC 99.
   423             20  DC-MDCY-CEN           PIC 99.
   424             20  DC-MDCY-YEAR          PIC 99.
   425    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   426        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   427    12  DC-EL310-DATE                  PIC X(21).
   428    12  FILLER                         PIC X(28).
   429
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL930.cbl
   431*                            COPY ELCLOGOF.
   432******************************************************************
   433*                                                                *
   434*                                                                *
   435*                            ELCLOGOF.                           *
   436*                            VMOD=2.001                          *
   437*                                                                *
   438*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   439*                                                                *
   440******************************************************************
   441 01  CLASIC-LOGOFF.
   442     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   443     12  LOGOFF-TEXT.
   444         16  FILLER          PIC X(5)    VALUE SPACES.
   445         16  LOGOFF-MSG.
   446             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   447             20  FILLER      PIC X       VALUE SPACES.
   448             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   449         16  FILLER          PIC X(80)
   450           VALUE '* YOU ARE NOW LOGGED OFF'.
   451         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   452         16  FILLER          PIC X       VALUE QUOTE.
   453         16  LOGOFF-SYS-MSG  PIC X(17)
   454           VALUE 'S CLAS-IC SYSTEM '.
   455     12  TEXT-MESSAGES.
   456         16  UNACCESS-MSG    PIC X(29)
   457             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   458         16  PGMIDERR-MSG    PIC X(17)
   459             VALUE 'PROGRAM NOT FOUND'.
   460
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL930.cbl
   462*                            COPY ELCATTR.
   463******************************************************************
   464*                                                                *
   465*                            ELCATTR.                            *
   466*                            VMOD=2.001                          *
   467*                                                                *
   468*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   469*                                                                *
   470*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   471*                                                                *
   472*                   POS 1   P=PROTECTED                          *
   473*                           U=UNPROTECTED                        *
   474*                           S=ASKIP                              *
   475*                   POS 2   A=ALPHA/NUMERIC                      *
   476*                           N=NUMERIC                            *
   477*                   POS 3   N=NORMAL                             *
   478*                           B=BRIGHT                             *
   479*                           D=DARK                               *
   480*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   481*                           OF=MODIFIED DATA TAG OFF             *
   482*                                                                *
   483*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   484******************************************************************
   485 01  ATTRIBUTE-LIST.
   486     12  AL-PABOF            PIC X       VALUE 'Y'.
   487     12  AL-PABON            PIC X       VALUE 'Z'.
   488     12  AL-PADOF            PIC X       VALUE '%'.
   489     12  AL-PADON            PIC X       VALUE '_'.
   490     12  AL-PANOF            PIC X       VALUE '-'.
   491     12  AL-PANON            PIC X       VALUE '/'.
   492     12  AL-SABOF            PIC X       VALUE '8'.
   493     12  AL-SABON            PIC X       VALUE '9'.
   494     12  AL-SADOF            PIC X       VALUE '@'.
   495     12  AL-SADON            PIC X       VALUE QUOTE.
   496     12  AL-SANOF            PIC X       VALUE '0'.
   497     12  AL-SANON            PIC X       VALUE '1'.
   498     12  AL-UABOF            PIC X       VALUE 'H'.
   499     12  AL-UABON            PIC X       VALUE 'I'.
   500     12  AL-UADOF            PIC X       VALUE '<'.
   501     12  AL-UADON            PIC X       VALUE '('.
   502     12  AL-UANOF            PIC X       VALUE ' '.
   503     12  AL-UANON            PIC X       VALUE 'A'.
   504     12  AL-UNBOF            PIC X       VALUE 'Q'.
   505     12  AL-UNBON            PIC X       VALUE 'R'.
   506     12  AL-UNDOF            PIC X       VALUE '*'.
   507     12  AL-UNDON            PIC X       VALUE ')'.
   508     12  AL-UNNOF            PIC X       VALUE '&'.
   509     12  AL-UNNON            PIC X       VALUE 'J'.
   510
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL930.cbl
   512*                                  COPY ELCEMIB.
   513******************************************************************
   514*                                                                *
   515*                                                                *
   516*                            ELCEMIB.                            *
   517*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   518*                            VMOD=2.005                          *
   519*                                                                *
   520*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   521*                                                                *
   522******************************************************************
   523 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   524     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   525     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   526     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   527     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   528     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   529     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   530     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   531     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   532     12  EMI-SWITCH1             PIC X        VALUE '1'.
   533         88  EMI-NO-ERRORS                    VALUE '1'.
   534         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   535         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   536     12  EMI-SWITCH2             PIC X        VALUE '1'.
   537         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   538     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   539         88  EMI-AREA1-EMPTY                  VALUE '1'.
   540         88  EMI-AREA1-FULL                   VALUE '2'.
   541     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   542         88  EMI-AREA2-EMPTY                  VALUE '1'.
   543         88  EMI-AREA2-FULL                   VALUE '2'.
   544     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   545         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   546         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   547         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   548         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   549         88  EMI-BYPASS-FATALS                VALUE 'X'.
   550     12  EMI-ERROR-LINES.
   551         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   552         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   553         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   554         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   555             20  EMI-ERR-CODES OCCURS 10 TIMES.
   556                 24  EMI-ERR-NUM         PIC X(4).
   557                 24  EMI-FILLER          PIC X.
   558                 24  EMI-SEV             PIC X.
   559                 24  FILLER              PIC X.
   560             20  FILLER                  PIC X(02).
   561     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   562         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   563             20  EMI-ERROR-NUMBER    PIC X(4).
   564             20  EMI-FILL            PIC X.
   565             20  EMI-SEVERITY        PIC X.
   566             20  FILLER              PIC X.
   567             20  EMI-ERROR-TEXT.
   568                 24  EMI-TEXT-VARIABLE   PIC X(10).
   569                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL930.cbl
   570     12  EMI-SEVERITY-SAVE           PIC X.
   571         88  EMI-NOTE                    VALUE 'N'.
   572         88  EMI-WARNING                 VALUE 'W'.
   573         88  EMI-FORCABLE                VALUE 'F'.
   574         88  EMI-FATAL                   VALUE 'X'.
   575     12  EMI-MESSAGE-FLAG            PIC X.
   576         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   577         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   578     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   579     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   580         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   581         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   582         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   583     12  FILLER                      PIC X(137)  VALUE SPACES.
   584     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   585     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   586     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   587     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   588
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL930.cbl
   590*                            COPY ELCINTF.
   591******************************************************************
   592*                                                                *
   593*                                                                *
   594*                            ELCINTF.                            *
   595*                            VMOD=2.017                          *
   596*                                                                *
   597*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   598*                                                                *
   599*       LENGTH = 1024                                            *
   600*                                                                *
   601******************************************************************
   602 01  PROGRAM-INTERFACE-BLOCK.
   603     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   604     12  PI-CALLING-PROGRAM              PIC X(8).
   605     12  PI-SAVED-PROGRAM-1              PIC X(8).
   606     12  PI-SAVED-PROGRAM-2              PIC X(8).
   607     12  PI-SAVED-PROGRAM-3              PIC X(8).
   608     12  PI-SAVED-PROGRAM-4              PIC X(8).
   609     12  PI-SAVED-PROGRAM-5              PIC X(8).
   610     12  PI-SAVED-PROGRAM-6              PIC X(8).
   611     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   612     12  PI-COMPANY-ID                   PIC XXX.
   613     12  PI-COMPANY-CD                   PIC X.
   614
   615     12  PI-COMPANY-PASSWORD             PIC X(8).
   616
   617     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   618
   619     12  PI-CONTROL-IN-PROGRESS.
   620         16  PI-CARRIER                  PIC X.
   621         16  PI-GROUPING                 PIC X(6).
   622         16  PI-STATE                    PIC XX.
   623         16  PI-ACCOUNT                  PIC X(10).
   624         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   625                                         PIC X(10).
   626         16  PI-CLAIM-CERT-GRP.
   627             20  PI-CLAIM-NO             PIC X(7).
   628             20  PI-CERT-NO.
   629                 25  PI-CERT-PRIME       PIC X(10).
   630                 25  PI-CERT-SFX         PIC X.
   631             20  PI-CERT-EFF-DT          PIC XX.
   632         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   633             20  PI-PLAN-CODE            PIC X(2).
   634             20  PI-REVISION-NUMBER      PIC X(3).
   635             20  PI-PLAN-EFF-DT          PIC X(2).
   636             20  PI-PLAN-EXP-DT          PIC X(2).
   637             20  FILLER                  PIC X(11).
   638         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   639             20  PI-OE-REFERENCE-1.
   640                 25  PI-OE-REF-1-PRIME   PIC X(18).
   641                 25  PI-OE-REF-1-SUFF    PIC XX.
   642
   643     12  PI-SESSION-IN-PROGRESS          PIC X.
   644         88  CLAIM-SESSION                   VALUE '1'.
   645         88  CREDIT-SESSION                  VALUE '2'.
   646         88  WARRANTY-SESSION                VALUE '3'.
   647         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL930.cbl
   648         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   649
   650
   651*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   652
   653     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   654     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   655
   656     12  PI-CREDIT-USER                  PIC X.
   657         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   658         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   659
   660     12  PI-CLAIM-USER                   PIC X.
   661         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   662         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   663
   664     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   665         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   666         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   667         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   668         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   669         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   670
   671     12  PI-PROCESSOR-ID                 PIC X(4).
   672
   673     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   674
   675     12  PI-MEMBER-CAPTION               PIC X(10).
   676
   677     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   678         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   679
   680     12  PI-LIFE-OVERRIDE-L1             PIC X.
   681     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   682     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   683     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   684
   685     12  PI-AH-OVERRIDE-L1               PIC X.
   686     12  PI-AH-OVERRIDE-L2               PIC XX.
   687     12  PI-AH-OVERRIDE-L6               PIC X(6).
   688     12  PI-AH-OVERRIDE-L12              PIC X(12).
   689
   690     12  PI-NEW-SYSTEM                   PIC X(2).
   691
   692     12  PI-PRIMARY-CERT-NO              PIC X(11).
   693     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   694         88  PI-USES-PAID-TO                 VALUE '1'.
   695     12  PI-CRDTCRD-SYSTEM.
   696         16  PI-CRDTCRD-USER             PIC X.
   697             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   698             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   699         16  PI-CC-MONTH-END-DT          PIC XX.
   700     12  PI-PROCESSOR-PRINTER            PIC X(4).
   701
   702     12  PI-OE-REFERENCE-2.
   703         16  PI-OE-REF-2-PRIME           PIC X(10).
   704         16  PI-OE-REF-2-SUFF            PIC X.
   705
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL930.cbl
   706     12  PI-REM-TRM-CALC-OPTION          PIC X.
   707
   708     12  PI-LANGUAGE-TYPE                PIC X.
   709             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   710             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   711             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   712
   713     12  PI-POLICY-LINKAGE-IND           PIC X.
   714         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   715         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   716                                                   LOW-VALUES.
   717
   718     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   719     12  PI-CLAIM-PW-SESSION             PIC X(1).
   720         88  PI-CLAIM-CREDIT                 VALUE '1'.
   721         88  PI-CLAIM-CONVEN                 VALUE '2'.
   722     12  FILLER                          PIC X(4).
   723
   724     12  PI-SYSTEM-LEVEL                 PIC X(145).
   725
   726     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   727         PI-SYSTEM-LEVEL.
   728
   729         16  PI-ENTRY-CODES.
   730             20  PI-ENTRY-CD-1           PIC X.
   731             20  PI-ENTRY-CD-2           PIC X.
   732
   733         16  PI-RETURN-CODES.
   734             20  PI-RETURN-CD-1          PIC X.
   735             20  PI-RETURN-CD-2          PIC X.
   736
   737         16  PI-UPDATE-STATUS-SAVE.
   738             20  PI-UPDATE-BY            PIC X(4).
   739             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   740
   741         16  PI-LOWER-CASE-LETTERS       PIC X.
   742             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   743
   744*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   745*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   746*            88  CARRIER-CLM-CNTL            VALUE '2'.
   747
   748         16  PI-CERT-ACCESS-CONTROL      PIC X.
   749             88  ST-ACCNT-CNTL               VALUE ' '.
   750             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   751             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   752             88  ACCNT-CNTL                  VALUE '3'.
   753             88  CARR-ACCNT-CNTL             VALUE '4'.
   754
   755         16  PI-PROCESSOR-CAP-LIST.
   756             20  PI-SYSTEM-CONTROLS.
   757                24 PI-SYSTEM-DISPLAY     PIC X.
   758                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   759                24 PI-SYSTEM-MODIFY      PIC X.
   760                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   761             20  FILLER                  PIC XX.
   762             20  PI-DISPLAY-CAP          PIC X.
   763                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL930.cbl
   764             20  PI-MODIFY-CAP           PIC X.
   765                 88  MODIFY-CAP              VALUE 'Y'.
   766             20  PI-MSG-AT-LOGON-CAP     PIC X.
   767                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   768             20  PI-FORCE-CAP            PIC X.
   769                 88  FORCE-CAP               VALUE 'Y'.
   770
   771         16  PI-PROGRAM-CONTROLS.
   772             20  PI-PGM-PRINT-OPT        PIC X.
   773             20  PI-PGM-FORMAT-OPT       PIC X.
   774             20  PI-PGM-PROCESS-OPT      PIC X.
   775             20  PI-PGM-TOTALS-OPT       PIC X.
   776
   777         16  PI-HELP-INTERFACE.
   778             20  PI-LAST-ERROR-NO        PIC X(4).
   779             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   780
   781         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   782             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   783
   784         16  PI-CR-CONTROL-IN-PROGRESS.
   785             20  PI-CR-CARRIER           PIC X.
   786             20  PI-CR-GROUPING          PIC X(6).
   787             20  PI-CR-STATE             PIC XX.
   788             20  PI-CR-ACCOUNT           PIC X(10).
   789             20  PI-CR-FIN-RESP          PIC X(10).
   790             20  PI-CR-TYPE              PIC X.
   791
   792         16  PI-CR-BATCH-NUMBER          PIC X(6).
   793
   794         16  PI-CR-MONTH-END-DT          PIC XX.
   795
   796         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   797             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   798             88  PI-ZERO-CARRIER             VALUE '1'.
   799             88  PI-ZERO-GROUPING            VALUE '2'.
   800             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   801
   802         16  PI-CARRIER-SECURITY         PIC X.
   803             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   804
   805         16  PI-ACCOUNT-SECURITY         PIC X(10).
   806             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   807             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   808
   809         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   810             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   811                                         INDEXED BY PI-ACCESS-NDX
   812                                         PIC X.
   813
   814         16  PI-GA-BILLING-CONTROL       PIC X.
   815             88  PI-GA-BILLING               VALUE '1'.
   816
   817         16  PI-MAIL-PROCESSING          PIC X.
   818             88  PI-MAIL-YES                 VALUE 'Y'.
   819
   820         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   821
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL930.cbl
   822         16  PI-AR-SYSTEM.
   823             20  PI-AR-PROCESSING-CNTL   PIC X.
   824                 88  PI-AR-PROCESSING        VALUE 'Y'.
   825             20  PI-AR-SUMMARY-CODE      PIC X(6).
   826             20  PI-AR-MONTH-END-DT      PIC XX.
   827
   828         16  PI-MP-SYSTEM.
   829             20  PI-MORTGAGE-USER            PIC X.
   830                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   831                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   832             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   833                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   834                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   835                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   836                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   837                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   838             20  PI-MP-MONTH-END-DT          PIC XX.
   839             20  PI-MP-REFERENCE-NO.
   840                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   841                 24  PI-MP-REFERENCE-SFX     PIC XX.
   842
   843         16  PI-LABEL-CONTROL            PIC X(01).
   844             88  PI-CREATE-LABELS                    VALUE 'Y'.
   845             88  PI-BYPASS-LABELS                    VALUE 'N'.
   846
   847         16  PI-BILL-GROUPING-CODE       PIC X(01).
   848             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   849
   850         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   851             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   852             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   853
   854         16  FILLER                      PIC X(14).
   855
   856     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   857******************************************************************
   858*    COPY ELC930PI.
   859
   860******************************************************************
   861*                            ELC930PI                            *
   862*                            VMOD=2.001                          *
   863*                                                                *
   864*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE DATA  *
   865*    ENTRY SUB-SYSTEM.                                           *
   866*                                                                *
   867*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
   868*                                                                *
   869*               EL930 - EL9301 - EL9302                          *
   870******************************************************************
   871
   872     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   873         16  PI-AM-NAME                  PIC X(30).
   874         16  PI-MAP-NAME                 PIC X(8).
   875         16  PI-BATCH-AMOUNTS    COMP-3.
   876             20  PI-LF-ISS-REMITTED      PIC S9(8)V99.
   877             20  PI-LF-ISS-ENTERED       PIC S9(8)V99.
   878             20  PI-LF-CAN-REMITTED      PIC S9(8)V99.
   879             20  PI-LF-CAN-ENTERED       PIC S9(8)V99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL930.cbl
   880             20  PI-AH-ISS-REMITTED      PIC S9(8)V99.
   881             20  PI-AH-ISS-ENTERED       PIC S9(8)V99.
   882             20  PI-AH-CAN-REMITTED      PIC S9(8)V99.
   883             20  PI-AH-CAN-ENTERED       PIC S9(8)V99.
   884             20  PI-ISS-CNT-REMITTED     PIC S9(5).
   885             20  PI-ISS-CNT-ENTERED      PIC S9(5).
   886             20  PI-CAN-CNT-REMITTED     PIC S9(5).
   887             20  PI-CAN-CNT-ENTERED      PIC S9(5).
   888         16  PI-MAINT-FUNC               PIC X.
   889         16  PI-ERROR-SW                 PIC X.
   890             88  PI-DATA-ERRORS              VALUE 'Y'.
   891         16  PI-UPDATE-SW                PIC X.
   892             88  PI-DATA-UPDATED             VALUE 'Y'.
   893         16  PI-DISPLAY-SW               PIC X.
   894             88  PI-LAST-FUNC-DISPLAY        VALUE 'Y'.
   895         16  PI-SAVE-CALLING-PGM         PIC X(8).
   896         16  PI-LAST-SEQ-NO-ADDED        PIC S9(4) COMP.
   897         16  PI-NEXT-DISPLAY-SEQ-NO      PIC S9(4) COMP.
   898         16  PI-SAV-CARRIER              PIC X.
   899         16  PI-SAV-GROUPING             PIC X(6).
   900         16  PI-SAV-STATE                PIC XX.
   901         16  PI-SAV-ACCOUNT              PIC X(10).
   902         16  PI-SAV-CERT-EFF-DT          PIC XX.
   903         16  PI-SAV-CERT-NO.
   904             20  PI-SAV-CERT-PRIME       PIC X(14).
   905             20  PI-SAV-CERT-SFX         PIC X.
   906         16  PI-SAV-ENDING-ERPNDT-KEY.
   907             20  PI-SAV-COMP-CD          PIC X.
   908             20  PI-SAV-ENTRY-BATCH      PIC X(6).
   909             20  PI-SAV-BATCH-SEQ        PIC S9(4) COMP.
   910             20  PI-SAV-BATCH-CHG-SEQ    PIC S9(4) COMP.
   911         16  PI-VERIFY-DELETE-SW         PIC X.
   912             88  PI-DELETE-IS-OK             VALUE 'Y'.
   913         16  PI-EL930-FIRST-TIME-SW      PIC X.
   914             88  PI-EL930-FIRST-TIME         VALUE SPACE.
   915         16  PI-CREDIT-EDIT-CONTROLS.
   916             20  PI-MIN-PREMIUM          PIC S9(3)V99  COMP-3.
   917             20  PI-MIN-AGE              PIC 99.
   918             20  PI-DEFAULT-AGE          PIC 99.
   919             20  PI-MIN-TERM             PIC S9(3)     COMP-3.
   920             20  PI-MAX-TERM             PIC S9(3)     COMP-3.
   921             20  PI-DEFAULT-SEX          PIC X.
   922             20  PI-JOINT-AGE-INPUT      PIC X.
   923                 88 PI-JOINT-AGE-IS-INPUT       VALUE '1'.
   924             20  PI-BIRTH-DATE-INPUT     PIC X.
   925                 88 PI-BIRTH-DATE-IS-INPUT      VALUE '1'.
   926         16  PI-KEYED-SWITCHES.
   927             20  PI-ISS-SUFFIX-KEYED-SW  PIC X.
   928                 88  PI-ISS-SUFFIX-KEYED     VALUE 'Y'.
   929             20  PI-CAN-SUFFIX-KEYED-SW  PIC X.
   930                 88  PI-CAN-SUFFIX-KEYED     VALUE 'Y'.
   931             20  PI-IG-KEYED-SW          PIC X.
   932                 88  PI-IG-KEYED             VALUE 'Y'.
   933             20  PI-APR-KEYED-SW         PIC X.
   934                 88  PI-APR-KEYED            VALUE 'Y'.
   935             20  PI-FREQ-KEYED-SW        PIC X.
   936                 88  PI-FREQ-KEYED           VALUE 'Y'.
   937             20  PI-SIG-KEYED-SW         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL930.cbl
   938                 88  PI-SIG-KEYED            VALUE 'Y'.
   939             20  PI-LFRT-KEYED-SW        PIC X.
   940                 88  PI-LFRT-KEYED           VALUE 'Y'.
   941             20  PI-AHRT-KEYED-SW        PIC X.
   942                 88  PI-AHRT-KEYED           VALUE 'Y'.
   943             20  PI-SSNUM-KEYED-SW       PIC X.
   944                 88  PI-SSNUM-KEYED          VALUE 'Y'.
   945             20  PI-JNT-SSNUM-KEYED-SW   PIC X.
   946                 88  PI-JNT-SSNUM-KEYED      VALUE 'Y'.
   947             20  PI-MEMBER-KEYED-SW      PIC X.
   948                 88  PI-MEMBER-KEYED         VALUE 'Y'.
   949             20  PI-MODE-KEYED-SW        PIC X.
   950                 88  PI-MODE-KEYED           VALUE 'Y'.
   951             20  PI-PMTS-KEYED-SW        PIC X.
   952                 88  PI-PMTS-KEYED           VALUE 'Y'.
   953             20  PI-LN-OFFICER-KEYED-SW  PIC X.
   954                 88  PI-LN-OFFICER-KEYED     VALUE 'Y'.
   955             20  PI-ENTRY-KEYED-SW       PIC X.
   956                 88  PI-ENTRY-KEYED          VALUE 'Y'.
   957             20  PI-RINCD-KEYED-SW       PIC X.
   958                 88  PI-RINCD-KEYED          VALUE 'Y'.
   959             20  PI-RTCLS-KEYED-SW       PIC X.
   960                 88  PI-RTCLS-KEYED          VALUE 'Y'.
   961             20  PI-LNTRM-KEYED-SW       PIC X.
   962                 88  PI-LNTRM-KEYED          VALUE 'Y'.
   963             20  PI-EXPIR-KEYED-SW       PIC X.
   964                 88  PI-EXPIR-KEYED          VALUE 'Y'.
   965             20  PI-PMT-KEYED-SW         PIC X.
   966                 88  PI-PMT-KEYED            VALUE 'Y'.
   967             20  PI-1ST-PMT-KEYED-SW     PIC X.
   968                 88  PI-1ST-PMT-KEYED        VALUE 'Y'.
   969             20  PI-DAYS-KEYED-SW        PIC X.
   970                 88  PI-DAYS-KEYED           VALUE 'Y'.
   971             20  PI-SKPCD-KEYED-SW       PIC X.
   972                 88  PI-SKPCD-KEYED          VALUE 'Y'.
   973             20  PI-JNT-AGE-KEYED-SW     PIC X.
   974                 88  PI-JNT-AGE-KEYED        VALUE 'Y'.
   975             20  PI-JNT-NAME-KEYED-SW    PIC X.
   976                 88  PI-JNT-NAME-KEYED       VALUE 'Y'.
   977             20  PI-ISS-LIVES-KEYED-SW   PIC X.
   978                 88  PI-ISS-LIVES-KEYED      VALUE 'Y'.
   979             20  PI-CAN-LIVES-KEYED-SW   PIC X.
   980                 88  PI-CAN-LIVES-KEYED      VALUE 'Y'.
   981             20  PI-PAYEE-KEYED-SW       PIC X.
   982                 88  PI-PAYEE-KEYED          VALUE 'Y'.
   983             20  PI-CHK-REQ-KEYED-SW     PIC X.
   984                 88  PI-CHK-REQ-KEYED        VALUE 'Y'.
   985             20  PI-ZIP4-KEYED-SW        PIC X.
   986                 88  PI-ZIP4-KEYED           VALUE 'Y'.
   987             20  PI-POLICY-KEYED-SW      PIC X.
   988                 88  PI-POLICY-KEYED         VALUE 'Y'.
   989             20  PI-EXPIRE-KEYED-SW      PIC X.
   990                 88  PI-EXPIRE-KEYED         VALUE 'Y'.
   991             20  PI-CRIT-PERD-KEYED-SW    PIC X.
   992                 88  PI-CRIT-PERD-KEYED      VALUE 'Y'.
   993             20  PI-BENEFICIARY-KEYED-SW PIC X.
   994                 88  PI-BENEFICIARY-KEYED    VALUE 'Y'.
   995             20  PI-PHONE-KEYED-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL930.cbl
   996                 88  PI-PHONE-KEYED          VALUE 'Y'.
   997             20  PI-ALT-BEN-KEYED-SW     PIC X.
   998                 88  PI-ALT-BEN-KEYED        VALUE 'Y'.
   999             20  PI-ALT-PREM-KEYED-SW    PIC X.
  1000                 88  PI-ALT-PREM-KEYED       VALUE 'Y'.
  1001         16  PI-ACCT-LOW-EFF-DT          PIC XX.
  1002         16  PI-ACCT-HIGH-EXP-DT         PIC XX.
  1003         16  PI-BATCH-EOF-SW             PIC X.
  1004             88  PI-BATCH-EOF                VALUE 'Y'.
  1005         16  PI-NB-MONTH-END-DT          PIC XX.
  1006         16  PI-ISSUE-ADDED-SW           PIC X.
  1007             88  PI-ISSUE-ADDED              VALUE 'Y'.
  1008
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL930.cbl
  1010
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL930.cbl
  1012*                            COPY ELCJPFX.
  1013******************************************************************
  1014*                                                                *
  1015*                                                                *
  1016*                            ELCJPFX.                            *
  1017*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1018*                            VMOD=2.002                          *
  1019*                                                                *
  1020*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1021*                                                                *
  1022*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1023*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1024*        ELCNTL - CONTROL FILE                                   *
  1025*        ELMSTR - CLAIM MASTERS                                  *
  1026*        ELTRLR - ACTIVITY TRAILERS                              *
  1027*        ELCHKQ - CHECK QUE                                      *
  1028******************************************************************
  1029 01  JOURNAL-RECORD.
  1030     12  JP-USER-ID                  PIC X(4).
  1031     12  JP-FILE-ID                  PIC X(8).
  1032     12  JP-PROGRAM-ID               PIC X(8).
  1033     12  JP-RECORD-TYPE              PIC X.
  1034         88 JP-ADD              VALUE 'A'.
  1035         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1036         88 JP-AFTER-CHANGE     VALUE 'C'.
  1037         88 JP-DELETE           VALUE 'D'.
  1038         88 JP-GENERIC-DELETE   VALUE 'G'.
  1039         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1040         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1041     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1042     12  JP-RECORD-AREA
  1043
  1044
  1045                             PIC X(585).
  1046
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL930.cbl
  1048*                            COPY ELCAID.
  1049******************************************************************
  1050*                                                                *
  1051*                            ELCAID.                             *
  1052*                            VMOD=2.001                          *
  1053*                                                                *
  1054*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1055*                                                                *
  1056*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1057*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1058******************************************************************
  1059
  1060 01  DFHAID.
  1061   02  DFHNULL   PIC  X  VALUE  ' '.
  1062   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1063   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1064   02  DFHPEN    PIC  X  VALUE  '='.
  1065   02  DFHOPID   PIC  X  VALUE  'W'.
  1066   02  DFHPA1    PIC  X  VALUE  '%'.
  1067   02  DFHPA2    PIC  X  VALUE  '>'.
  1068   02  DFHPA3    PIC  X  VALUE  ','.
  1069   02  DFHPF1    PIC  X  VALUE  '1'.
  1070   02  DFHPF2    PIC  X  VALUE  '2'.
  1071   02  DFHPF3    PIC  X  VALUE  '3'.
  1072   02  DFHPF4    PIC  X  VALUE  '4'.
  1073   02  DFHPF5    PIC  X  VALUE  '5'.
  1074   02  DFHPF6    PIC  X  VALUE  '6'.
  1075   02  DFHPF7    PIC  X  VALUE  '7'.
  1076   02  DFHPF8    PIC  X  VALUE  '8'.
  1077   02  DFHPF9    PIC  X  VALUE  '9'.
  1078   02  DFHPF10   PIC  X  VALUE  ':'.
  1079   02  DFHPF11   PIC  X  VALUE  '#'.
  1080   02  DFHPF12   PIC  X  VALUE  '@'.
  1081   02  DFHPF13   PIC  X  VALUE  'A'.
  1082   02  DFHPF14   PIC  X  VALUE  'B'.
  1083   02  DFHPF15   PIC  X  VALUE  'C'.
  1084   02  DFHPF16   PIC  X  VALUE  'D'.
  1085   02  DFHPF17   PIC  X  VALUE  'E'.
  1086   02  DFHPF18   PIC  X  VALUE  'F'.
  1087   02  DFHPF19   PIC  X  VALUE  'G'.
  1088   02  DFHPF20   PIC  X  VALUE  'H'.
  1089   02  DFHPF21   PIC  X  VALUE  'I'.
  1090*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1091   02  DFHPF22   PIC  X  VALUE  '['.
  1092   02  DFHPF23   PIC  X  VALUE  '.'.
  1093   02  DFHPF24   PIC  X  VALUE  '<'.
  1094   02  DFHMSRE   PIC  X  VALUE  'X'.
  1095   02  DFHSTRF   PIC  X  VALUE  'h'.
  1096   02  DFHTRIG   PIC  X  VALUE  '"'.
  1097 01  FILLER    REDEFINES DFHAID.
  1098     12  FILLER              PIC X(8).
  1099     12  PF-VALUES           PIC X       OCCURS 2.
  1100
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL930.cbl
  1102*                            COPY EL930S.
  1103 01  EL930AI.
  1104     05  FILLER            PIC  X(0012).
  1105*    -------------------------------
  1106     05  DATEL PIC S9(0004) COMP.
  1107     05  DATEF PIC  X(0001).
  1108     05  FILLER REDEFINES DATEF.
  1109         10  DATEA PIC  X(0001).
  1110     05  DATEI PIC  X(0008).
  1111*    -------------------------------
  1112     05  TIMEL PIC S9(0004) COMP.
  1113     05  TIMEF PIC  X(0001).
  1114     05  FILLER REDEFINES TIMEF.
  1115         10  TIMEA PIC  X(0001).
  1116     05  TIMEI PIC  X(0005).
  1117*    -------------------------------
  1118     05  MAINTL PIC S9(0004) COMP.
  1119     05  MAINTF PIC  X(0001).
  1120     05  FILLER REDEFINES MAINTF.
  1121         10  MAINTA PIC  X(0001).
  1122     05  MAINTI PIC  X(0001).
  1123*    -------------------------------
  1124     05  BATCHL PIC S9(0004) COMP.
  1125     05  BATCHF PIC  X(0001).
  1126     05  FILLER REDEFINES BATCHF.
  1127         10  BATCHA PIC  X(0001).
  1128     05  BATCHI PIC  X(0006).
  1129*    -------------------------------
  1130     05  LFPHDGL PIC S9(0004) COMP.
  1131     05  LFPHDGF PIC  X(0001).
  1132     05  FILLER REDEFINES LFPHDGF.
  1133         10  LFPHDGA PIC  X(0001).
  1134     05  LFPHDGI PIC  X(0010).
  1135*    -------------------------------
  1136     05  AHPHDGL PIC S9(0004) COMP.
  1137     05  AHPHDGF PIC  X(0001).
  1138     05  FILLER REDEFINES AHPHDGF.
  1139         10  AHPHDGA PIC  X(0001).
  1140     05  AHPHDGI PIC  X(0010).
  1141*    -------------------------------
  1142     05  LFRHDGL PIC S9(0004) COMP.
  1143     05  LFRHDGF PIC  X(0001).
  1144     05  FILLER REDEFINES LFRHDGF.
  1145         10  LFRHDGA PIC  X(0001).
  1146     05  LFRHDGI PIC  X(0009).
  1147*    -------------------------------
  1148     05  AHRHDGL PIC S9(0004) COMP.
  1149     05  AHRHDGF PIC  X(0001).
  1150     05  FILLER REDEFINES AHRHDGF.
  1151         10  AHRHDGA PIC  X(0001).
  1152     05  AHRHDGI PIC  X(0009).
  1153*    -------------------------------
  1154     05  EISSCNTL PIC S9(0004) COMP.
  1155     05  EISSCNTF PIC  X(0001).
  1156     05  FILLER REDEFINES EISSCNTF.
  1157         10  EISSCNTA PIC  X(0001).
  1158     05  EISSCNTI PIC  S9(6).
  1159*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL930.cbl
  1160     05  ELFISSL PIC S9(0004) COMP.
  1161     05  ELFISSF PIC  X(0001).
  1162     05  FILLER REDEFINES ELFISSF.
  1163         10  ELFISSA PIC  X(0001).
  1164     05  ELFISSI PIC  S9(10)V9(2).
  1165*    -------------------------------
  1166     05  EAHISSL PIC S9(0004) COMP.
  1167     05  EAHISSF PIC  X(0001).
  1168     05  FILLER REDEFINES EAHISSF.
  1169         10  EAHISSA PIC  X(0001).
  1170     05  EAHISSI PIC  S9(10)V9(2).
  1171*    -------------------------------
  1172     05  ECANCNTL PIC S9(0004) COMP.
  1173     05  ECANCNTF PIC  X(0001).
  1174     05  FILLER REDEFINES ECANCNTF.
  1175         10  ECANCNTA PIC  X(0001).
  1176     05  ECANCNTI PIC  S9(6).
  1177*    -------------------------------
  1178     05  ELFCANL PIC S9(0004) COMP.
  1179     05  ELFCANF PIC  X(0001).
  1180     05  FILLER REDEFINES ELFCANF.
  1181         10  ELFCANA PIC  X(0001).
  1182     05  ELFCANI PIC  S9(8)V9(2).
  1183*    -------------------------------
  1184     05  EAHCANL PIC S9(0004) COMP.
  1185     05  EAHCANF PIC  X(0001).
  1186     05  FILLER REDEFINES EAHCANF.
  1187         10  EAHCANA PIC  X(0001).
  1188     05  EAHCANI PIC  S9(8)V9(2).
  1189*    -------------------------------
  1190     05  AISSCNTL PIC S9(0004) COMP.
  1191     05  AISSCNTF PIC  X(0001).
  1192     05  FILLER REDEFINES AISSCNTF.
  1193         10  AISSCNTA PIC  X(0001).
  1194     05  AISSCNTI PIC  S9(6).
  1195*    -------------------------------
  1196     05  ALFISSL PIC S9(0004) COMP.
  1197     05  ALFISSF PIC  X(0001).
  1198     05  FILLER REDEFINES ALFISSF.
  1199         10  ALFISSA PIC  X(0001).
  1200     05  ALFISSI PIC  S9(10)V9(2).
  1201*    -------------------------------
  1202     05  AAHISSL PIC S9(0004) COMP.
  1203     05  AAHISSF PIC  X(0001).
  1204     05  FILLER REDEFINES AAHISSF.
  1205         10  AAHISSA PIC  X(0001).
  1206     05  AAHISSI PIC  S9(10)V9(2).
  1207*    -------------------------------
  1208     05  ACANCNTL PIC S9(0004) COMP.
  1209     05  ACANCNTF PIC  X(0001).
  1210     05  FILLER REDEFINES ACANCNTF.
  1211         10  ACANCNTA PIC  X(0001).
  1212     05  ACANCNTI PIC  S9(6).
  1213*    -------------------------------
  1214     05  ALFCANL PIC S9(0004) COMP.
  1215     05  ALFCANF PIC  X(0001).
  1216     05  FILLER REDEFINES ALFCANF.
  1217         10  ALFCANA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL930.cbl
  1218     05  ALFCANI PIC  S9(8)V9(2).
  1219*    -------------------------------
  1220     05  AAHCANL PIC S9(0004) COMP.
  1221     05  AAHCANF PIC  X(0001).
  1222     05  FILLER REDEFINES AAHCANF.
  1223         10  AAHCANA PIC  X(0001).
  1224     05  AAHCANI PIC  S9(8)V9(2).
  1225*    -------------------------------
  1226     05  OISSCNTL PIC S9(0004) COMP.
  1227     05  OISSCNTF PIC  X(0001).
  1228     05  FILLER REDEFINES OISSCNTF.
  1229         10  OISSCNTA PIC  X(0001).
  1230     05  OISSCNTI PIC  S9(6).
  1231*    -------------------------------
  1232     05  OLFISSL PIC S9(0004) COMP.
  1233     05  OLFISSF PIC  X(0001).
  1234     05  FILLER REDEFINES OLFISSF.
  1235         10  OLFISSA PIC  X(0001).
  1236     05  OLFISSI PIC  S9(10)V9(2).
  1237*    -------------------------------
  1238     05  OAHISSL PIC S9(0004) COMP.
  1239     05  OAHISSF PIC  X(0001).
  1240     05  FILLER REDEFINES OAHISSF.
  1241         10  OAHISSA PIC  X(0001).
  1242     05  OAHISSI PIC  S9(10)V9(2).
  1243*    -------------------------------
  1244     05  OCANCNTL PIC S9(0004) COMP.
  1245     05  OCANCNTF PIC  X(0001).
  1246     05  FILLER REDEFINES OCANCNTF.
  1247         10  OCANCNTA PIC  X(0001).
  1248     05  OCANCNTI PIC  S9(6).
  1249*    -------------------------------
  1250     05  OLFCANL PIC S9(0004) COMP.
  1251     05  OLFCANF PIC  X(0001).
  1252     05  FILLER REDEFINES OLFCANF.
  1253         10  OLFCANA PIC  X(0001).
  1254     05  OLFCANI PIC  S9(8)V9(2).
  1255*    -------------------------------
  1256     05  OAHCANL PIC S9(0004) COMP.
  1257     05  OAHCANF PIC  X(0001).
  1258     05  FILLER REDEFINES OAHCANF.
  1259         10  OAHCANA PIC  X(0001).
  1260     05  OAHCANI PIC  S9(8)V9(2).
  1261*    -------------------------------
  1262     05  MNTHNDTL PIC S9(0004) COMP.
  1263     05  MNTHNDTF PIC  X(0001).
  1264     05  FILLER REDEFINES MNTHNDTF.
  1265         10  MNTHNDTA PIC  X(0001).
  1266     05  MNTHNDTI PIC  X(0008).
  1267*    -------------------------------
  1268     05  ERRMSG1L PIC S9(0004) COMP.
  1269     05  ERRMSG1F PIC  X(0001).
  1270     05  FILLER REDEFINES ERRMSG1F.
  1271         10  ERRMSG1A PIC  X(0001).
  1272     05  ERRMSG1I PIC  X(0076).
  1273*    -------------------------------
  1274     05  ERRMSG2L PIC S9(0004) COMP.
  1275     05  ERRMSG2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL930.cbl
  1276     05  FILLER REDEFINES ERRMSG2F.
  1277         10  ERRMSG2A PIC  X(0001).
  1278     05  ERRMSG2I PIC  X(0076).
  1279*    -------------------------------
  1280     05  PFENTERL PIC S9(0004) COMP.
  1281     05  PFENTERF PIC  X(0001).
  1282     05  FILLER REDEFINES PFENTERF.
  1283         10  PFENTERA PIC  X(0001).
  1284     05  PFENTERI PIC  9(2).
  1285 01  EL930AO REDEFINES EL930AI.
  1286     05  FILLER            PIC  X(0012).
  1287*    -------------------------------
  1288     05  FILLER            PIC  X(0003).
  1289     05  DATEO PIC  X(0008).
  1290*    -------------------------------
  1291     05  FILLER            PIC  X(0003).
  1292     05  TIMEO PIC  99.99.
  1293*    -------------------------------
  1294     05  FILLER            PIC  X(0003).
  1295     05  MAINTO PIC  X(0001).
  1296*    -------------------------------
  1297     05  FILLER            PIC  X(0003).
  1298     05  BATCHO PIC  X(0006).
  1299*    -------------------------------
  1300     05  FILLER            PIC  X(0003).
  1301     05  LFPHDGO PIC  X(0010).
  1302*    -------------------------------
  1303     05  FILLER            PIC  X(0003).
  1304     05  AHPHDGO PIC  X(0010).
  1305*    -------------------------------
  1306     05  FILLER            PIC  X(0003).
  1307     05  LFRHDGO PIC  X(0009).
  1308*    -------------------------------
  1309     05  FILLER            PIC  X(0003).
  1310     05  AHRHDGO PIC  X(0009).
  1311*    -------------------------------
  1312     05  FILLER            PIC  X(0003).
  1313     05  EISSCNTO PIC  Z(5)-.
  1314*    -------------------------------
  1315     05  FILLER            PIC  X(0003).
  1316     05  ELFISSO PIC  Z(8).99-.
  1317*    -------------------------------
  1318     05  FILLER            PIC  X(0003).
  1319     05  EAHISSO PIC  Z(8).99-.
  1320*    -------------------------------
  1321     05  FILLER            PIC  X(0003).
  1322     05  ECANCNTO PIC  Z(5)-.
  1323*    -------------------------------
  1324     05  FILLER            PIC  X(0003).
  1325     05  ELFCANO PIC  Z(6).99-.
  1326*    -------------------------------
  1327     05  FILLER            PIC  X(0003).
  1328     05  EAHCANO PIC  Z(6).99-.
  1329*    -------------------------------
  1330     05  FILLER            PIC  X(0003).
  1331     05  AISSCNTO PIC  Z(5)-.
  1332*    -------------------------------
  1333     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL930.cbl
  1334     05  ALFISSO PIC  Z(8).99-.
  1335*    -------------------------------
  1336     05  FILLER            PIC  X(0003).
  1337     05  AAHISSO PIC  Z(8).99-.
  1338*    -------------------------------
  1339     05  FILLER            PIC  X(0003).
  1340     05  ACANCNTO PIC  Z(5)-.
  1341*    -------------------------------
  1342     05  FILLER            PIC  X(0003).
  1343     05  ALFCANO PIC  Z(6).99-.
  1344*    -------------------------------
  1345     05  FILLER            PIC  X(0003).
  1346     05  AAHCANO PIC  Z(6).99-.
  1347*    -------------------------------
  1348     05  FILLER            PIC  X(0003).
  1349     05  OISSCNTO PIC  Z(5)-.
  1350*    -------------------------------
  1351     05  FILLER            PIC  X(0003).
  1352     05  OLFISSO PIC  Z(8).99-.
  1353*    -------------------------------
  1354     05  FILLER            PIC  X(0003).
  1355     05  OAHISSO PIC  Z(8).99-.
  1356*    -------------------------------
  1357     05  FILLER            PIC  X(0003).
  1358     05  OCANCNTO PIC  Z(5)-.
  1359*    -------------------------------
  1360     05  FILLER            PIC  X(0003).
  1361     05  OLFCANO PIC  Z(6).99-.
  1362*    -------------------------------
  1363     05  FILLER            PIC  X(0003).
  1364     05  OAHCANO PIC  Z(6).99-.
  1365*    -------------------------------
  1366     05  FILLER            PIC  X(0003).
  1367     05  MNTHNDTO PIC  X(0008).
  1368*    -------------------------------
  1369     05  FILLER            PIC  X(0003).
  1370     05  ERRMSG1O PIC  X(0076).
  1371*    -------------------------------
  1372     05  FILLER            PIC  X(0003).
  1373     05  ERRMSG2O PIC  X(0076).
  1374*    -------------------------------
  1375     05  FILLER            PIC  X(0003).
  1376     05  PFENTERO PIC  X(0002).
  1377*    -------------------------------
  1378
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL930.cbl
  1380****************************************************************
  1381*
  1382* Copyright (c) 2007 by Clerity Solutions, Inc.
  1383* All rights reserved.
  1384*
  1385****************************************************************
  1386 01  DFHEIV.
  1387   02  DFHEIV0               PIC X(35).
  1388   02  DFHEIV1               PIC X(08).
  1389   02  DFHEIV2               PIC X(08).
  1390   02  DFHEIV3               PIC X(08).
  1391   02  DFHEIV4               PIC X(06).
  1392   02  DFHEIV5               PIC X(04).
  1393   02  DFHEIV6               PIC X(04).
  1394   02  DFHEIV7               PIC X(02).
  1395   02  DFHEIV8               PIC X(02).
  1396   02  DFHEIV9               PIC X(01).
  1397   02  DFHEIV10              PIC S9(7) COMP-3.
  1398   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1399   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1400   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1401   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1402   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1403   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1404   02  DFHEIV17              PIC X(04).
  1405   02  DFHEIV18              PIC X(04).
  1406   02  DFHEIV19              PIC X(04).
  1407   02  DFHEIV20              USAGE IS POINTER.
  1408   02  DFHEIV21              USAGE IS POINTER.
  1409   02  DFHEIV22              USAGE IS POINTER.
  1410   02  DFHEIV23              USAGE IS POINTER.
  1411   02  DFHEIV24              USAGE IS POINTER.
  1412   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1413   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1414   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1415   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1416   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1417   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1418   02  FILLER                PIC X(02).
  1419   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1420   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1421   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1422   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1423   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1424 LINKAGE  SECTION.
  1425*****************************************************************
  1426*                                                               *
  1427* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1428* All rights reserved.                                          *
  1429*                                                               *
  1430*****************************************************************
  1431 01  dfheiblk.
  1432     02  eibtime          pic s9(7) comp-3.
  1433     02  eibdate          pic s9(7) comp-3.
  1434     02  eibtrnid         pic x(4).
  1435     02  eibtaskn         pic s9(7) comp-3.
  1436     02  eibtrmid         pic x(4).
  1437     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL930.cbl
  1438     02  eibcposn         pic s9(4) comp.
  1439     02  eibcalen         pic s9(4) comp.
  1440     02  eibaid           pic x(1).
  1441     02  eibfiller1       pic x(1).
  1442     02  eibfn            pic x(2).
  1443     02  eibfiller2       pic x(2).
  1444     02  eibrcode         pic x(6).
  1445     02  eibfiller3       pic x(2).
  1446     02  eibds            pic x(8).
  1447     02  eibreqid         pic x(8).
  1448     02  eibrsrce         pic x(8).
  1449     02  eibsync          pic x(1).
  1450     02  eibfree          pic x(1).
  1451     02  eibrecv          pic x(1).
  1452     02  eibsend          pic x(1).
  1453     02  eibatt           pic x(1).
  1454     02  eibeoc           pic x(1).
  1455     02  eibfmh           pic x(1).
  1456     02  eibcompl         pic x(1).
  1457     02  eibsig           pic x(1).
  1458     02  eibconf          pic x(1).
  1459     02  eiberr           pic x(1).
  1460     02  eibrldbk         pic x(1).
  1461     02  eiberrcd         pic x(4).
  1462     02  eibsynrb         pic x(1).
  1463     02  eibnodat         pic x(1).
  1464     02  eibfiller5       pic x(2).
  1465     02  eibresp          pic 9(09) comp.
  1466     02  eibresp2         pic 9(09) comp.
  1467     02  dfheigdj         pic s9(4) comp.
  1468     02  dfheigdk         pic s9(4) comp.
  1469 01  DFHCOMMAREA             PIC X(1024).
  1470
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL930.cbl
  1472 01  PARMLIST      COMP.
  1473     02  FILLER              PIC S9(8).
  1474     02  ELCNTL-POINTER      PIC S9(8).
  1475     02  ERPNDT-POINTER      PIC S9(8).
  1476     02  ELCERT-POINTER      PIC S9(8).
  1477     02  ERNOTE-POINTER      PIC S9(8).
  1478     02  ERMAIL-POINTER      PIC S9(8).
  1479     02  ERPNDM-POINTER      PIC S9(8).
  1480
  1481*                            COPY ELCCNTL.
  1482******************************************************************
  1483*                                                                *
  1484*                                                                *
  1485*                            ELCCNTL.                            *
  1486*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1487*                            VMOD=2.059                          *
  1488*                                                                *
  1489*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1490*                                                                *
  1491*   FILE TYPE = VSAM,KSDS                                        *
  1492*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1493*                                                                *
  1494*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1495*       ALTERNATE INDEX = NONE                                   *
  1496*                                                                *
  1497*   LOG = YES                                                    *
  1498*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1499******************************************************************
  1500*                   C H A N G E   L O G
  1501*
  1502* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1503*-----------------------------------------------------------------
  1504*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1505* EFFECTIVE    NUMBER
  1506*-----------------------------------------------------------------
  1507* 082503                   PEMA  ADD BENEFIT GROUP
  1508* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1509* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1510* 092705    2005050300006  PEMA  ADD SPP LEASES
  1511* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1512* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1513* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1514* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1515******************************************************************
  1516*
  1517 01  CONTROL-FILE.
  1518     12  CF-RECORD-ID                       PIC XX.
  1519         88  VALID-CF-ID                        VALUE 'CF'.
  1520
  1521     12  CF-CONTROL-PRIMARY.
  1522         16  CF-COMPANY-ID                  PIC XXX.
  1523         16  CF-RECORD-TYPE                 PIC X.
  1524             88  CF-COMPANY-MASTER              VALUE '1'.
  1525             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1526             88  CF-STATE-MASTER                VALUE '3'.
  1527             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1528             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1529             88  CF-CARRIER-MASTER              VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL930.cbl
  1530             88  CF-MORTALITY-MASTER            VALUE '7'.
  1531             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1532             88  CF-TERMINAL-MASTER             VALUE '9'.
  1533             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1534             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1535             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1536             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1537             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1538             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1539             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1540             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1541             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1542         16  CF-ACCESS-CD-GENL              PIC X(4).
  1543         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1544             20  CF-PROCESSOR               PIC X(4).
  1545         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1546             20  CF-STATE-CODE              PIC XX.
  1547             20  FILLER                     PIC XX.
  1548         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1549             20  FILLER                     PIC XX.
  1550             20  CF-HI-BEN-IN-REC           PIC XX.
  1551         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1552             20  FILLER                     PIC XXX.
  1553             20  CF-CARRIER-CNTL            PIC X.
  1554         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1555             20  FILLER                     PIC XX.
  1556             20  CF-HI-TYPE-IN-REC          PIC 99.
  1557         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1558             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1559                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1560             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1561             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1562         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1563             20  FILLER                     PIC X.
  1564             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1565         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1566             20  FILLER                     PIC XX.
  1567             20  CF-MORTGAGE-PLAN           PIC XX.
  1568         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1569
  1570     12  CF-LAST-MAINT-DT                   PIC XX.
  1571     12  CF-LAST-MAINT-BY                   PIC X(4).
  1572     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1573
  1574     12  CF-RECORD-BODY                     PIC X(728).
  1575
  1576
  1577****************************************************************
  1578*             COMPANY MASTER RECORD                            *
  1579****************************************************************
  1580
  1581     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1582         16  CF-COMPANY-ADDRESS.
  1583             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1584             20  CF-CL-IN-CARE-OF           PIC X(30).
  1585             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1586             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1587             20  CF-CL-CITY-STATE           PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL930.cbl
  1588             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1589             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1590         16  CF-COMPANY-CD                  PIC X.
  1591         16  CF-COMPANY-PASSWORD            PIC X(8).
  1592         16  CF-SECURITY-OPTION             PIC X.
  1593             88  ALL-SECURITY                   VALUE '1'.
  1594             88  COMPANY-VERIFY                 VALUE '2'.
  1595             88  PROCESSOR-VERIFY               VALUE '3'.
  1596             88  NO-SECURITY                    VALUE '4'.
  1597             88  ALL-BUT-TERM                   VALUE '5'.
  1598         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1599             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1600         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1601             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1602         16  CF-INFORCE-LOCATION            PIC X.
  1603             88  CERTS-ARE-ONLINE               VALUE '1'.
  1604             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1605             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1606         16  CF-LOWER-CASE-LETTERS          PIC X.
  1607         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1608             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1609             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1610             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1611             88  CF-ACCNT-CNTL                  VALUE '3'.
  1612             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1613
  1614         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1615         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1616
  1617         16  CF-LGX-CREDIT-USER             PIC X.
  1618             88  CO-IS-NOT-USER                 VALUE 'N'.
  1619             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1620
  1621         16 CF-CREDIT-CALC-CODES.
  1622             20  CF-CR-REM-TERM-CALC PIC X.
  1623               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1624               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1625               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1626               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1627               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1628               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1629               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1630             20  CF-CR-R78-METHOD           PIC X.
  1631               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1632               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1633
  1634         16  CF-CLAIM-CONTROL-COUNTS.
  1635             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1636                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1637
  1638             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1639                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1640
  1641             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1642                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1643
  1644             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1645                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL930.cbl
  1646
  1647         16  CF-CURRENT-MONTH-END           PIC XX.
  1648
  1649         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1650             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1651             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1652             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1653             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1654                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1655                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1656             20  CF-CO-PREM-REJECT-SW       PIC X.
  1657                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1658                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1659             20  CF-CO-REF-REJECT-SW        PIC X.
  1660                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1661                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1662
  1663         16  CF-CO-REPORTING-DT             PIC XX.
  1664         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1665         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1666           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1667           88  CF-CO-MONTH-END                  VALUE '1'.
  1668
  1669         16  CF-LGX-CLAIM-USER              PIC X.
  1670             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1671             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1672
  1673         16  CF-CREDIT-EDIT-CONTROLS.
  1674             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1675             20  CF-MIN-AGE                 PIC 99.
  1676             20  CF-DEFAULT-AGE             PIC 99.
  1677             20  CF-MIN-TERM                PIC S999      COMP-3.
  1678             20  CF-MAX-TERM                PIC S999      COMP-3.
  1679             20  CF-DEFAULT-SEX             PIC X.
  1680             20  CF-JOINT-AGE-INPUT         PIC X.
  1681                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1682             20  CF-BIRTH-DATE-INPUT        PIC X.
  1683                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1684             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1685                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1686                 88  CF-ZERO-CARRIER            VALUE '1'.
  1687                 88  CF-ZERO-GROUPING           VALUE '2'.
  1688                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1689             20  CF-EDIT-SW                 PIC X.
  1690                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1691             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1692             20  CF-CR-PR-METHOD            PIC X.
  1693               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1694               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1695             20  FILLER                     PIC X.
  1696
  1697         16  CF-CREDIT-MISC-CONTROLS.
  1698             20  CF-REIN-TABLE-SW           PIC X.
  1699                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1700             20  CF-COMP-TABLE-SW           PIC X.
  1701                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1702             20  CF-EXPERIENCE-RETENTION-AGE
  1703                                            PIC S9        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL930.cbl
  1704             20  CF-CONVERSION-DT           PIC XX.
  1705             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1706             20  CF-RUN-FREQUENCY-SW        PIC X.
  1707                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1708                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1709
  1710             20  CF-CR-CHECK-NO-CONTROL.
  1711                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1712                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1713                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1714                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1715                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1716                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1717
  1718                 24  CF-CR-CHECK-COUNT       REDEFINES
  1719                     CF-CR-CHECK-COUNTER      PIC X(4).
  1720
  1721                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1722                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1723
  1724                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1725                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1726                 24  CF-MAIL-PROCESSING       PIC X.
  1727                     88  MAIL-PROCESSING          VALUE 'Y'.
  1728
  1729         16  CF-MISC-SYSTEM-CONTROL.
  1730             20  CF-SYSTEM-C                 PIC X.
  1731                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1732             20  CF-SYSTEM-D                 PIC X.
  1733                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1734             20  CF-SOC-SEC-NO-SW            PIC X.
  1735                 88  SOC-SEC-NO-USED             VALUE '1'.
  1736             20  CF-MEMBER-NO-SW             PIC X.
  1737                 88  MEMBER-NO-USED              VALUE '1'.
  1738             20  CF-TAX-ID-NUMBER            PIC X(11).
  1739             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1740             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1741                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1742                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1743                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1744                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1745             20  CF-SYSTEM-E                 PIC X.
  1746                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1747
  1748         16  CF-LGX-LIFE-USER               PIC X.
  1749             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1750             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1751
  1752         16  CF-CR-MONTH-END-DT             PIC XX.
  1753
  1754         16  CF-FILE-MAINT-DATES.
  1755             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1756                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1757             20  CF-LAST-BATCH       REDEFINES
  1758                 CF-LAST-BATCH-NO               PIC X(4).
  1759             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1760             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1761             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL930.cbl
  1762             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1763             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1764             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1765             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1766             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1767             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1768             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1769
  1770         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1771         16  FILLER                         PIC X.
  1772
  1773         16  CF-ALT-MORT-CODE               PIC X(4).
  1774         16  CF-MEMBER-CAPTION              PIC X(10).
  1775
  1776         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1777             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1778             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1779             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1780             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1781             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1782
  1783         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1784
  1785         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1786         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1787         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1788         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1789
  1790         16  CF-AH-OVERRIDE-L1              PIC X.
  1791         16  CF-AH-OVERRIDE-L2              PIC XX.
  1792         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1793         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1794
  1795         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1796         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1797
  1798         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1799         16  CF-AR-LAST-EL860-DT            PIC XX.
  1800         16  CF-MP-MONTH-END-DT             PIC XX.
  1801
  1802         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1803         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1804             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1805
  1806         16  CF-AR-MONTH-END-DT             PIC XX.
  1807
  1808         16  CF-CRDTCRD-USER                PIC X.
  1809             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1810             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1811
  1812         16  CF-CC-MONTH-END-DT             PIC XX.
  1813
  1814         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1815
  1816         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1817             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1818             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1819             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL930.cbl
  1820         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1821         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1822         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1823         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1824             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1825             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1826         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1827         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1828         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1829             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1830         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1831
  1832         16  CF-CL-ZIP-CODE.
  1833             20  CF-CL-ZIP-PRIME.
  1834                 24  CF-CL-ZIP-1ST          PIC X.
  1835                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1836                 24  FILLER                 PIC X(4).
  1837             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1838         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1839             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1840             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1841             20  FILLER                     PIC XXX.
  1842
  1843         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1844         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1845         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1846         16  CF-CO-OPTION-START-DATE        PIC XX.
  1847         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1848           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1849                                                      '3' '4'.
  1850           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1851           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1852           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1853           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1854           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1855           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1856
  1857         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1858
  1859         16  CF-PAYMENT-APPROVAL-LEVELS.
  1860             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1861             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1862             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1863             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1864             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1865             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1866
  1867         16  CF-END-USER-REPORTING-USER     PIC X.
  1868             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1869             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1870
  1871         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1872             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1873             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1874
  1875         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1876
  1877         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL930.cbl
  1878         16  FILLER                         PIC X.
  1879
  1880         16  CF-CREDIT-ARCHIVE-CNTL.
  1881             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1882             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1883             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1884
  1885         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1886
  1887         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1888             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1889             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1890
  1891         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1892             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1893             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1894
  1895         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1896
  1897         16  CF-CO-ACH-ID-CODE              PIC  X.
  1898             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1899             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1900             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1901         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1902         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1903         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1904         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1905         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1906         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1907         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1908         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1909         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1910                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1911         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1912                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1913
  1914         16  CF-CO-OVER-SHORT.
  1915             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1916             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1917
  1918*         16  FILLER                         PIC X(102).
  1919         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1920             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1921             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1922
  1923         16  CF-AH-APPROVAL-DAYS.
  1924             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1925             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1926             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1927             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1928
  1929         16  FILLER                         PIC X(82).
  1930****************************************************************
  1931*             PROCESSOR/USER RECORD                            *
  1932****************************************************************
  1933
  1934     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1935         16  CF-PROCESSOR-NAME              PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL930.cbl
  1936         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1937         16  CF-PROCESSOR-TITLE             PIC X(26).
  1938         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1939                 88  MESSAGE-YES                VALUE 'Y'.
  1940                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1941
  1942*****************************************************
  1943****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1944****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1945****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1946****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1947*****************************************************
  1948
  1949         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1950             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1951             20  CF-APPLICATION-FORCE       PIC X.
  1952             20  CF-INDIVIDUAL-APP.
  1953                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1954                     28  CF-BROWSE-APP      PIC X.
  1955                     28  CF-UPDATE-APP      PIC X.
  1956
  1957         16  CF-CURRENT-TERM-ON             PIC X(4).
  1958         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1959             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1960             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1961             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1962             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1963             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1964             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1965             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1966         16  CF-PROCESSOR-CARRIER           PIC X.
  1967             88  NO-CARRIER-SECURITY            VALUE ' '.
  1968         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1969             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1970         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1971             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1972         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1973             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1974
  1975         16  CF-PROC-SYS-ACCESS-SW.
  1976             20  CF-PROC-CREDIT-CLAIMS-SW.
  1977                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1978                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1979                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1980                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1981             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1982                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1983                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1984             20  CF-PROC-LIFE-GNRLDGR-SW.
  1985                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1986                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1987                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1988                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1989             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1990                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1991                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1992         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1993             CF-PROC-SYS-ACCESS-SW              PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL930.cbl
  1994             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1995         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1996
  1997         16  CF-APPROVAL-LEVEL                  PIC X.
  1998             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1999             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2000             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2001             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2002
  2003         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2004
  2005         16  CF-LANGUAGE-TYPE                   PIC X.
  2006             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2007             88  CF-LANG-IS-FR                      VALUE 'F'.
  2008         16  FILLER                             PIC  X(240).
  2009
  2010****************************************************************
  2011*             PROCESSOR/REMINDERS RECORD                       *
  2012****************************************************************
  2013
  2014     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2015         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2016             20  CF-START-REMIND-DT         PIC XX.
  2017             20  CF-END-REMIND-DT           PIC XX.
  2018             20  CF-REMINDER-TEXT           PIC X(50).
  2019         16  FILLER                         PIC X(296).
  2020
  2021
  2022****************************************************************
  2023*             STATE MASTER RECORD                              *
  2024****************************************************************
  2025
  2026     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2027         16  CF-STATE-ABBREVIATION          PIC XX.
  2028         16  CF-STATE-NAME                  PIC X(25).
  2029         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2030         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2031             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2032             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2033             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2034             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2035                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2036                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2037             20  CF-ST-PREM-REJECT-SW       PIC X.
  2038                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2039                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2040             20  CF-ST-REF-REJECT-SW        PIC X.
  2041                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2042                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2043         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2044         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2045         16  CF-ST-REFUND-RULES.
  2046             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2047             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2048             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2049         16  CF-ST-FST-PMT-EXTENSION.
  2050             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2051             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL930.cbl
  2052                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2053                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2054                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2055                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2056         16  CF-ST-STATE-CALL.
  2057             20  CF-ST-CALL-UNEARNED        PIC X.
  2058             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2059             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2060         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2061             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2062             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2063         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2064         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2065         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2066         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2067         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2068         16  FILLER                         PIC X.
  2069         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2070             20  CF-ST-BENEFIT-CD           PIC XX.
  2071             20  CF-ST-BENEFIT-KIND         PIC X.
  2072                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2073                 88  CF-ST-AH-KIND              VALUE 'A'.
  2074             20  CF-ST-REM-TERM-CALC        PIC X.
  2075                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2076                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2077                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2078                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2079                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2080                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2081                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2082                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2083
  2084             20  CF-ST-REFUND-CALC          PIC X.
  2085                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2086                 88  ST-REFD-BY-R78             VALUE '1'.
  2087                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2088                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2089                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2090                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2091                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2092                 88  ST-REFD-UTAH               VALUE '7'.
  2093                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2094                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2095                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2096
  2097             20  CF-ST-EARNING-CALC         PIC X.
  2098                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2099                 88  ST-EARN-BY-R78             VALUE '1'.
  2100                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2101                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2102                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2103                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2104                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2105                 88  ST-EARN-MEAN               VALUE '8'.
  2106                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2107
  2108             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2109                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL930.cbl
  2110                 88  ST-OVRD-BY-R78             VALUE '1'.
  2111                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2112                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2113                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2114                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2115                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2116                 88  ST-OVRD-MEAN               VALUE '8'.
  2117                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2118             20  FILLER                     PIC X.
  2119
  2120         16  CF-ST-COMMISSION-CAPS.
  2121             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2122             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2123             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2124             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2125         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2126                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2127
  2128         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2129
  2130         16  CF-ST-STATUTORY-INTEREST.
  2131             20  CF-ST-STAT-DATE-FROM       PIC X.
  2132                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2133                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2134             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2135             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2136             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2137             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2138             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2139
  2140         16  CF-ST-OVER-SHORT.
  2141             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2142             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2143
  2144         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2145
  2146         16  CF-ST-RT-CALC                  PIC X.
  2147
  2148         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2149         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2150         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2151         16  CF-ST-RF-LR-CALC               PIC X.
  2152         16  CF-ST-RF-LL-CALC               PIC X.
  2153         16  CF-ST-RF-LN-CALC               PIC X.
  2154         16  CF-ST-RF-AH-CALC               PIC X.
  2155         16  CF-ST-RF-CP-CALC               PIC X.
  2156*        16  FILLER                         PIC X(206).
  2157*CIDMOD         16  FILLER                         PIC X(192).
  2158         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2159             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2160         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2161         16  FILLER                         PIC X(187).
  2162
  2163****************************************************************
  2164*             BENEFIT MASTER RECORD                            *
  2165****************************************************************
  2166
  2167     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL930.cbl
  2168         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2169             20  CF-BENEFIT-CODE            PIC XX.
  2170             20  CF-BENEFIT-NUMERIC  REDEFINES
  2171                 CF-BENEFIT-CODE            PIC XX.
  2172             20  CF-BENEFIT-ALPHA           PIC XXX.
  2173             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2174             20  CF-BENEFIT-COMMENT         PIC X(10).
  2175
  2176             20  CF-LF-COVERAGE-TYPE        PIC X.
  2177                 88  CF-REDUCING                VALUE 'R'.
  2178                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2179
  2180             20  CF-SPECIAL-CALC-CD         PIC X.
  2181                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2182                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2183                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2184                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2185                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2186                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2187                 88  CF-FARM-PLAN               VALUE 'F'.
  2188                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2189                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2190                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2191                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2192                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2193                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2194                 88  CF-PRUDENTIAL              VALUE 'P'.
  2195                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2196                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2197                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2198                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2199                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2200                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2201
  2202             20  CF-JOINT-INDICATOR         PIC X.
  2203                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2204
  2205*            20  FILLER                     PIC X(12).
  2206             20  FILLER                     PIC X(11).
  2207             20  CF-BENEFIT-CATEGORY        PIC X.
  2208             20  CF-LOAN-TYPE               PIC X(8).
  2209
  2210             20  CF-CO-REM-TERM-CALC        PIC X.
  2211                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2212                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2213                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2214                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2215                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2216
  2217             20  CF-CO-EARNINGS-CALC        PIC X.
  2218                 88  CO-EARN-BY-R78             VALUE '1'.
  2219                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2220                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2221                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2222                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2223                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2224                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2225                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL930.cbl
  2226
  2227             20  CF-CO-REFUND-CALC          PIC X.
  2228                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2229                 88  CO-REFD-BY-R78             VALUE '1'.
  2230                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2231                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2232                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2233                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2234                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2235                 88  CO-REFD-MEAN               VALUE '8'.
  2236                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2237                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2238                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2239
  2240             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2241                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2242                 88  CO-OVRD-BY-R78             VALUE '1'.
  2243                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2244                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2245                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2246                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2247                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2248                 88  CO-OVRD-MEAN               VALUE '8'.
  2249                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2250
  2251             20  CF-CO-BEN-I-G-CD           PIC X.
  2252                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2253                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2254                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2255
  2256         16  FILLER                         PIC X(304).
  2257
  2258
  2259****************************************************************
  2260*             CARRIER MASTER RECORD                            *
  2261****************************************************************
  2262
  2263     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2264         16  CF-ADDRESS-DATA.
  2265             20  CF-MAIL-TO-NAME            PIC X(30).
  2266             20  CF-IN-CARE-OF              PIC X(30).
  2267             20  CF-ADDRESS-LINE-1          PIC X(30).
  2268             20  CF-ADDRESS-LINE-2          PIC X(30).
  2269             20  CF-CITY-STATE              PIC X(30).
  2270             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2271             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2272
  2273         16  CF-CLAIM-NO-CONTROL.
  2274             20  CF-CLAIM-NO-METHOD         PIC X.
  2275                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2276                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2277                 88  CLAIM-NO-SEQ               VALUE '3'.
  2278                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2279             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2280                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2281                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2282                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2283
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL930.cbl
  2284         16  CF-CHECK-NO-CONTROL.
  2285             20  CF-CHECK-NO-METHOD         PIC X.
  2286                 88  CHECK-NO-MANUAL            VALUE '1'.
  2287                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2288                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2289                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2290             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2291                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2292
  2293         16  CF-DOMICILE-STATE              PIC XX.
  2294
  2295         16  CF-EXPENSE-CONTROLS.
  2296             20  CF-EXPENSE-METHOD          PIC X.
  2297                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2298                 88  DOLLARS-PER-PMT            VALUE '2'.
  2299                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2300                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2301             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2302             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2303
  2304         16  CF-CORRESPONDENCE-CONTROL.
  2305             20  CF-LETTER-RESEND-OPT       PIC X.
  2306                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2307                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2308             20  FILLER                     PIC X(4).
  2309
  2310         16  CF-RESERVE-CONTROLS.
  2311             20  CF-MANUAL-SW               PIC X.
  2312                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2313             20  CF-FUTURE-SW               PIC X.
  2314                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2315             20  CF-PTC-SW                  PIC X.
  2316                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2317             20  CF-IBNR-SW                 PIC X.
  2318                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2319             20  CF-PTC-LF-SW               PIC X.
  2320                 88  CF-LF-PTC-USED             VALUE '1'.
  2321             20  CF-CDT-ACCESS-METHOD       PIC X.
  2322                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2323                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2324                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2325             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2326
  2327         16  CF-CLAIM-CALC-METHOD           PIC X.
  2328             88  360-PLUS-MONTHS                VALUE '1'.
  2329             88  365-PLUS-MONTHS                VALUE '2'.
  2330             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2331             88  360-DAILY                      VALUE '4'.
  2332             88  365-DAILY                      VALUE '5'.
  2333
  2334         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2335         16  FILLER                         PIC X(11).
  2336
  2337         16  CF-LIMIT-AMOUNTS.
  2338             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2339             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2340             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2341             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL930.cbl
  2342             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2343             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2344             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2345             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2346             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2347             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2348
  2349         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2350         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2351         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2352
  2353         16  CF-ZIP-CODE.
  2354             20  CF-ZIP-PRIME.
  2355                 24  CF-ZIP-1ST             PIC X.
  2356                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2357                 24  FILLER                 PIC X(4).
  2358             20  CF-ZIP-PLUS4               PIC X(4).
  2359         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2360             20  CF-CAN-POSTAL-1            PIC XXX.
  2361             20  CF-CAN-POSTAL-2            PIC XXX.
  2362             20  FILLER                     PIC XXX.
  2363
  2364         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2365         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2366         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2367
  2368         16  CF-RATING-SWITCH               PIC X.
  2369             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2370             88  CF-NO-RATING                   VALUE 'N'.
  2371
  2372         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2373
  2374         16  CF-CARRIER-OVER-SHORT.
  2375             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2376             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2377
  2378         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2379         16  CF-SECPAY-SWITCH               PIC X.
  2380             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2381             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2382         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2383         16  FILLER                         PIC X(448).
  2384*        16  FILLER                         PIC X(452).
  2385
  2386
  2387****************************************************************
  2388*             MORTALITY MASTER RECORD                          *
  2389****************************************************************
  2390
  2391     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2392         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2393                                INDEXED BY CF-MORT-NDX.
  2394             20  CF-MORT-TABLE              PIC X(5).
  2395             20  CF-MORT-TABLE-TYPE         PIC X.
  2396                 88  CF-MORT-JOINT              VALUE 'J'.
  2397                 88  CF-MORT-SINGLE             VALUE 'S'.
  2398                 88  CF-MORT-COMBINED           VALUE 'C'.
  2399                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL930.cbl
  2400                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2401             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2402             20  CF-MORT-AGE-METHOD         PIC XX.
  2403                 88  CF-AGE-LAST                VALUE 'AL'.
  2404                 88  CF-AGE-NEAR                VALUE 'AN'.
  2405             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2406             20  CF-MORT-ADJUSTMENT-DIRECTION
  2407                                            PIC X.
  2408                 88  CF-MINUS                   VALUE '-'.
  2409                 88  CF-PLUS                    VALUE '+'.
  2410             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2411             20  CF-MORT-JOINT-CODE         PIC X.
  2412                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2413             20  CF-MORT-PC-Q               PIC X.
  2414                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2415             20  CF-MORT-TABLE-CODE         PIC X(4).
  2416             20  CF-MORT-COMMENTS           PIC X(15).
  2417             20  FILLER                     PIC X(14).
  2418
  2419         16  FILLER                         PIC X(251).
  2420
  2421
  2422****************************************************************
  2423*             BUSSINESS TYPE MASTER RECORD                     *
  2424****************************************************************
  2425
  2426     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2427* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2428* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2429* AND RECORD 05 IS TYPES 81-99
  2430         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2431             20  CF-BUSINESS-TITLE          PIC  X(19).
  2432             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2433                                            PIC S9V9(4) COMP-3.
  2434             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2435             20  FILLER                     PIC  X.
  2436         16  FILLER                         PIC  X(248).
  2437
  2438
  2439****************************************************************
  2440*             TERMINAL MASTER RECORD                           *
  2441****************************************************************
  2442
  2443     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2444
  2445         16  CF-COMPANY-TERMINALS.
  2446             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2447                                  PIC X(4).
  2448         16  FILLER               PIC X(248).
  2449
  2450
  2451****************************************************************
  2452*             LIFE EDIT MASTER RECORD                          *
  2453****************************************************************
  2454
  2455     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2456         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2457             20  CF-LIFE-CODE-IN            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL930.cbl
  2458             20  CF-LIFE-CODE-OUT           PIC XX.
  2459         16  FILLER                         PIC X(248).
  2460
  2461
  2462****************************************************************
  2463*             AH EDIT MASTER RECORD                            *
  2464****************************************************************
  2465
  2466     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2467         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2468             20  CF-AH-CODE-IN              PIC XXX.
  2469             20  CF-AH-CODE-OUT             PIC XX.
  2470         16  FILLER                         PIC X(248).
  2471
  2472
  2473****************************************************************
  2474*             CREDIBILITY TABLES                               *
  2475****************************************************************
  2476
  2477     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2478         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2479                             INDEXED BY CF-CRDB-NDX.
  2480             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2481             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2482             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2483         16  FILLER                         PIC  X(332).
  2484
  2485
  2486****************************************************************
  2487*             REPORT CUSTOMIZATION RECORD                      *
  2488****************************************************************
  2489
  2490     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2491         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2492             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2493             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2494             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2495**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2496****       A T-TRANSFER.                                   ****
  2497             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2498
  2499         16  FILLER                         PIC XX.
  2500
  2501         16  CF-CARRIER-CNTL-OPT.
  2502             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2503                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2504                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2505             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2506                                            PIC X.
  2507         16  CF-GROUP-CNTL-OPT.
  2508             20  CF-GROUP-OPT-SEQ           PIC 9.
  2509                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2510                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2511             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2512                                            PIC X(6).
  2513         16  CF-STATE-CNTL-OPT.
  2514             20  CF-STATE-OPT-SEQ           PIC 9.
  2515                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL930.cbl
  2516                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2517             20  CF-STATE-SELECT OCCURS 3 TIMES
  2518                                            PIC XX.
  2519         16  CF-ACCOUNT-CNTL-OPT.
  2520             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2521                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2522                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2523             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2524                                            PIC X(10).
  2525         16  CF-BUS-TYP-CNTL-OPT.
  2526             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2527                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2528                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2529             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2530                                            PIC XX.
  2531         16  CF-LF-TYP-CNTL-OPT.
  2532             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2533                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2534                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2535             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2536                                            PIC XX.
  2537         16  CF-AH-TYP-CNTL-OPT.
  2538             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2539                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2540                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2541             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2542                                            PIC XX.
  2543         16  CF-REPTCD1-CNTL-OPT.
  2544             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2545                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2546                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2547             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2548                                            PIC X(10).
  2549         16  CF-REPTCD2-CNTL-OPT.
  2550             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2551                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2552                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2553             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2554                                            PIC X(10).
  2555         16  CF-USER1-CNTL-OPT.
  2556             20  CF-USER1-OPT-SEQ           PIC 9.
  2557                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2558                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2559             20  CF-USER1-SELECT OCCURS 3 TIMES
  2560                                            PIC X(10).
  2561         16  CF-USER2-CNTL-OPT.
  2562             20  CF-USER2-OPT-SEQ           PIC 9.
  2563                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2564                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2565             20  CF-USER2-SELECT OCCURS 3 TIMES
  2566                                            PIC X(10).
  2567         16  CF-USER3-CNTL-OPT.
  2568             20  CF-USER3-OPT-SEQ           PIC 9.
  2569                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2570                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2571             20  CF-USER3-SELECT OCCURS 3 TIMES
  2572                                            PIC X(10).
  2573         16  CF-USER4-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL930.cbl
  2574             20  CF-USER4-OPT-SEQ           PIC 9.
  2575                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2576                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2577             20  CF-USER4-SELECT OCCURS 3 TIMES
  2578                                            PIC X(10).
  2579         16  CF-USER5-CNTL-OPT.
  2580             20  CF-USER5-OPT-SEQ           PIC 9.
  2581                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2582                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2583             20  CF-USER5-SELECT OCCURS 3 TIMES
  2584                                            PIC X(10).
  2585         16  CF-REINS-CNTL-OPT.
  2586             20  CF-REINS-OPT-SEQ           PIC 9.
  2587                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2588                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2589             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2590                 24  CF-REINS-PRIME         PIC XXX.
  2591                 24  CF-REINS-SUB           PIC XXX.
  2592
  2593         16  CF-AGENT-CNTL-OPT.
  2594             20  CF-AGENT-OPT-SEQ           PIC 9.
  2595                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2596                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2597             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2598                                            PIC X(10).
  2599
  2600         16  FILLER                         PIC X(43).
  2601
  2602         16  CF-LOSS-RATIO-SELECT.
  2603             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2604             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2605         16  CF-ENTRY-DATE-SELECT.
  2606             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2607             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2608         16  CF-EFFECTIVE-DATE-SELECT.
  2609             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2610             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2611
  2612         16  CF-EXCEPTION-LIST-IND          PIC X.
  2613             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2614
  2615         16  FILLER                         PIC X(318).
  2616
  2617****************************************************************
  2618*                  EXCEPTION REPORTING RECORD                  *
  2619****************************************************************
  2620
  2621     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2622         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2623             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2624
  2625         16  CF-COMBINED-LIFE-AH-OPT.
  2626             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2627             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2628             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2629             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2630
  2631         16  CF-LIFE-OPT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL930.cbl
  2632             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2633             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2634             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2635             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2636             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2637             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2638             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2639             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2640             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2641             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2642
  2643         16  CF-AH-OPT.
  2644             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2645             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2646             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2647             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2648             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2649             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2650             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2651             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2652             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2653             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2654
  2655         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2656             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2657             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2658             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2659
  2660         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2661
  2662         16  FILLER                         PIC X(673).
  2663
  2664
  2665****************************************************************
  2666*             MORTGAGE SYSTEM PLAN RECORD                      *
  2667****************************************************************
  2668
  2669     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2670         16  CF-PLAN-TYPE                   PIC X.
  2671             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2672             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2673             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2674         16  CF-PLAN-ABBREV                 PIC XXX.
  2675         16  CF-PLAN-DESCRIPT               PIC X(10).
  2676         16  CF-PLAN-NOTES                  PIC X(20).
  2677         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2678         16  CF-PLAN-UNDERWRITING.
  2679             20  CF-PLAN-TERM-DATA.
  2680                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2681                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2682             20  CF-PLAN-AGE-DATA.
  2683                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2684                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2685                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2686             20  CF-PLAN-BENEFIT-DATA.
  2687                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2688                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2689                 24  CF-MAXIMUM-MONTHLY-BENEFIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL930.cbl
  2690                                            PIC S9(7)V99  COMP-3.
  2691         16  CF-PLAN-POLICY-FORMS.
  2692             20  CF-POLICY-FORM             PIC X(12).
  2693             20  CF-MASTER-APPLICATION      PIC X(12).
  2694             20  CF-MASTER-POLICY           PIC X(12).
  2695         16  CF-PLAN-RATING.
  2696             20  CF-RATE-CODE               PIC X(5).
  2697             20  CF-SEX-RATING              PIC X.
  2698                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2699                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2700             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2701             20  CF-SUB-STD-TYPE            PIC X.
  2702                 88  CF-PCT-OF-PREM            VALUE '1'.
  2703                 88  CF-PCT-OF-BENE            VALUE '2'.
  2704         16  CF-PLAN-PREM-TOLERANCES.
  2705             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2706             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2707         16  CF-PLAN-PYMT-TOLERANCES.
  2708             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2709             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2710         16  CF-PLAN-MISC-DATA.
  2711             20  FILLER                     PIC X.
  2712             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2713             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2714         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2715         16  CF-PLAN-IND-GRP                PIC X.
  2716             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2717                                                     '1'.
  2718             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2719                                                     '2'.
  2720         16  CF-MIB-SEARCH-SW               PIC X.
  2721             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2722             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2723             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2724             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2725         16  CF-ALPHA-SEARCH-SW             PIC X.
  2726             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2727             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2728             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2729             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2730             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2731             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2732             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2733             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2734             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2735             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2736                                                     'A' 'B' 'C'
  2737                                                     'X' 'Y' 'Z'.
  2738         16  CF-EFF-DT-RULE-SW              PIC X.
  2739             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2740             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2741             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2742             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2743             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2744         16  FILLER                         PIC X(4).
  2745         16  CF-HEALTH-QUESTIONS            PIC X.
  2746             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2747         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL930.cbl
  2748         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2749         16  CF-PLAN-SNGL-JNT               PIC X.
  2750             88  CF-COMBINED-PLAN              VALUE 'C'.
  2751             88  CF-JNT-PLAN                   VALUE 'J'.
  2752             88  CF-SNGL-PLAN                  VALUE 'S'.
  2753         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2754         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2755         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2756         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2757         16  CF-RERATE-CNTL                 PIC  X.
  2758             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2759             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2760             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2761             88  CF-AUTO-RECALC                 VALUE '4'.
  2762         16  CF-BENEFIT-TYPE                PIC  X.
  2763             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2764             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2765         16  CF-POLICY-FEE                  PIC S999V99
  2766                                                    COMP-3.
  2767         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2768         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2769         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2770         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2771         16  FILLER                         PIC  X(32).
  2772         16  CF-TERMINATION-FORM            PIC  X(04).
  2773         16  FILLER                         PIC  X(08).
  2774         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2775                                                       COMP-3.
  2776         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2777         16  CF-ISSUE-LETTER                PIC  X(4).
  2778         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2779         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2780             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2781             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2782         16  CF-MP-REFUND-CALC              PIC X.
  2783             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2784             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2785             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2786             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2787             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2788             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2789             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2790             88  CF-MP-REFD-MEAN                VALUE '8'.
  2791         16  CF-ALT-RATE-CODE               PIC  X(5).
  2792
  2793
  2794         16  FILLER                         PIC X(498).
  2795****************************************************************
  2796*             MORTGAGE COMPANY MASTER RECORD                   *
  2797****************************************************************
  2798
  2799     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2800         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2801         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2802             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2803             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2804             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2805             88  CF-MORT-PROD-CNTL                   VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL930.cbl
  2806             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2807
  2808         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2809         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2810         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2811         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2812         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2813
  2814         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2815             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2816         16  CF-MP-RECON-USE-IND            PIC X(1).
  2817             88  CF-MP-USE-RECON             VALUE 'Y'.
  2818         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2819             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2820         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2821             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2822             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2823         16  FILLER                         PIC X(1).
  2824         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2825             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2826         16  CF-MORTG-MIB-VERSION           PIC X.
  2827             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2828             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2829             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2830         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2831             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2832                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2833             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2834                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2835             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2836                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2837             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2838                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2839             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2840                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2841             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2842                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2843         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2844         16  FILLER                         PIC X(7).
  2845         16  CF-MORTG-DESTINATION-SYMBOL.
  2846             20  CF-MORTG-MIB-COMM          PIC X(5).
  2847             20  CF-MORTG-MIB-TERM          PIC X(5).
  2848         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2849             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2850         16  FILLER                         PIC X(03).
  2851         16  CF-MP-CHECK-NO-CONTROL.
  2852             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2853                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2854                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2855                                                ' ' LOW-VALUES.
  2856                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2857                                               VALUE '3'.
  2858         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2859         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2860         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2861             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2862                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2863             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL930.cbl
  2864                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2865             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2866                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2867             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2868                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2869             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2870                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2871             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2872                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2873         16  CF-MORTG-BILLING-AREA.
  2874             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2875                                            PIC X.
  2876         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2877         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2878         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2879         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2880             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2881             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2882         16  FILLER                         PIC X.
  2883         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2884             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2885             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2886         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2887         16  FILLER                         PIC X(8).
  2888         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2889         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2890         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2891         16  CF-ACH-COMPANY-ID.
  2892             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2893                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2894                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2895                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2896             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2897         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2898             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2899         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2900             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2901             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2902         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2903         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2904         16  FILLER                         PIC X(536).
  2905
  2906****************************************************************
  2907*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2908****************************************************************
  2909
  2910     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2911         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2912             20  CF-FEMALE-HEIGHT.
  2913                 24  CF-FEMALE-FT           PIC 99.
  2914                 24  CF-FEMALE-IN           PIC 99.
  2915             20  CF-FEMALE-MIN-WT           PIC 999.
  2916             20  CF-FEMALE-MAX-WT           PIC 999.
  2917         16  FILLER                         PIC X(428).
  2918
  2919     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2920         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2921             20  CF-MALE-HEIGHT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL930.cbl
  2922                 24  CF-MALE-FT             PIC 99.
  2923                 24  CF-MALE-IN             PIC 99.
  2924             20  CF-MALE-MIN-WT             PIC 999.
  2925             20  CF-MALE-MAX-WT             PIC 999.
  2926         16  FILLER                         PIC X(428).
  2927******************************************************************
  2928*             AUTOMATIC ACTIVITY RECORD                          *
  2929******************************************************************
  2930     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2931         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2932             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2933             20  CF-SYS-LETTER-ID           PIC X(04).
  2934             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2935             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2936             20  CF-SYS-RESET-SW            PIC X(01).
  2937             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2938             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2939
  2940         16  FILLER                         PIC X(50).
  2941
  2942         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2943             20  CF-USER-ACTIVE-SW          PIC X(01).
  2944             20  CF-USER-LETTER-ID          PIC X(04).
  2945             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2946             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2947             20  CF-USER-RESET-SW           PIC X(01).
  2948             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2949             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2950             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2951
  2952         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL930.cbl
  2954*                            COPY ERCPNDB.
  2955******************************************************************
  2956*                                                                *
  2957*                                                                *
  2958*                            ERCPNDB.                            *
  2959*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2960*                            VMOD=2.025                          *
  2961*                                                                *
  2962*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2963*                                                                *
  2964******************************************************************
  2965*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2966*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2967******************************************************************
  2968*                                                                *
  2969*                                                                *
  2970*   FILE TYPE = VSAM,KSDS                                        *
  2971*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2972*                                                                *
  2973*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2974*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2975*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2976*                                                 RKP=13,LEN=36  *
  2977*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2978*                                      AND CHG-SEQ.)             *
  2979*                                                RKP=49,LEN=11   *
  2980*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2981*                                      AND CHG-SEQ.)             *
  2982*                                                RKP=60,LEN=15   *
  2983*                                                                *
  2984*   LOG = NO                                                     *
  2985*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2986******************************************************************
  2987******************************************************************
  2988*                   C H A N G E   L O G
  2989*
  2990* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2991*-----------------------------------------------------------------
  2992*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2993* EFFECTIVE    NUMBER
  2994*-----------------------------------------------------------------
  2995* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2996* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2997* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2998* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2999* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3000* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3001* 032306                   PEMA  ADD BOW LOAN NUMBER
  3002* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3003* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3004* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3005* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3006* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3007* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3008* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3009******************************************************************
  3010
  3011 01  PENDING-BUSINESS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL930.cbl
  3012     12  PB-RECORD-ID                     PIC XX.
  3013         88  VALID-PB-ID                        VALUE 'PB'.
  3014
  3015     12  PB-CONTROL-PRIMARY.
  3016         16  PB-COMPANY-CD                PIC X.
  3017         16  PB-ENTRY-BATCH               PIC X(6).
  3018         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3019         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3020
  3021     12  PB-CONTROL-BY-ACCOUNT.
  3022         16  PB-COMPANY-CD-A1             PIC X.
  3023         16  PB-CARRIER                   PIC X.
  3024         16  PB-GROUPING.
  3025             20  PB-GROUPING-PREFIX       PIC XXX.
  3026             20  PB-GROUPING-PRIME        PIC XXX.
  3027         16  PB-STATE                     PIC XX.
  3028         16  PB-ACCOUNT.
  3029             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3030             20  PB-ACCOUNT-PRIME         PIC X(6).
  3031         16  PB-CERT-EFF-DT               PIC XX.
  3032         16  PB-CERT-NO.
  3033             20  PB-CERT-PRIME            PIC X(10).
  3034             20  PB-CERT-SFX              PIC X.
  3035         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3036
  3037         16  PB-RECORD-TYPE               PIC X.
  3038             88  PB-MAILING-DATA                VALUE '0'.
  3039             88  PB-ISSUE                       VALUE '1'.
  3040             88  PB-CANCELLATION                VALUE '2'.
  3041             88  PB-BATCH-TRAILER               VALUE '9'.
  3042
  3043     12  PB-CONTROL-BY-ORIG-BATCH.
  3044         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  3045         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  3046         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  3047         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  3048
  3049     12  PB-CONTROL-BY-CSR.
  3050         16  PB-CSR-COMPANY-CD            PIC X.
  3051         16  PB-CSR-ID                    PIC X(4).
  3052         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  3053         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  3054         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  3055******************************************************************
  3056*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  3057******************************************************************
  3058
  3059     12  PB-LAST-MAINT-DT                 PIC XX.
  3060     12  PB-LAST-MAINT-BY                 PIC X(4).
  3061     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3062
  3063     12  PB-RECORD-BODY                   PIC X(375).
  3064
  3065     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  3066         16  PB-CERT-ORIGIN               PIC X.
  3067             88  CLASIC-CREATED-CERT         VALUE '1'.
  3068         16  PB-I-NAME.
  3069             20  PB-I-INSURED-LAST-NAME   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL930.cbl
  3070             20  PB-I-INSURED-FIRST-NAME.
  3071                 24  PB-I-INSURED-1ST-INIT PIC X.
  3072                 24  FILLER                PIC X(9).
  3073             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  3074         16  PB-I-AGE                     PIC S99   COMP-3.
  3075         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  3076         16  PB-I-BIRTHDAY                PIC XX.
  3077         16  PB-I-INSURED-SEX             PIC X.
  3078             88  PB-SEX-MALE     VALUE 'M'.
  3079             88  PB-SEX-FEMALE   VALUE 'F'.
  3080
  3081         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  3082         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  3083         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  3084         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  3085         16  PB-I-SKIP-CODE               PIC X.
  3086             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  3087             88  PB-SKIP-JULY              VALUE '1'.
  3088             88  PB-SKIP-AUGUST            VALUE '2'.
  3089             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  3090             88  PB-SKIP-JULY-AUG          VALUE '4'.
  3091             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  3092             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  3093             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  3094             88  PB-SKIP-JUNE              VALUE '8'.
  3095             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  3096             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  3097             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  3098         16  PB-I-TERM-TYPE               PIC X.
  3099             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  3100             88  PB-PAID-WEEKLY            VALUE 'W'.
  3101             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  3102             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  3103             88  PB-PAID-13-YEARLY         VALUE 'T'.
  3104         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  3105         16  PB-I-POLICY-FORM-NO          PIC X(12).
  3106         16  PB-I-DATA-ENTRY-SW           PIC X.
  3107             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  3108             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  3109             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  3110             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  3111         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  3112         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  3113*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  3114         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  3115         16  FILLER                       PIC X.
  3116
  3117         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  3118             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  3119             88  PB-INVALID-LIFE             VALUE '  ' '00'
  3120                                                   '90' THRU '99'.
  3121         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  3122                                          PIC XX.
  3123         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  3124         16  PB-I-AMOUNT-FINANCED REDEFINES
  3125                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  3126         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  3127         16  PB-I-UNPAID-CASH-PRICE REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL930.cbl
  3128                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  3129         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3130         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  3131         16  PB-I-CLP-AMOUNT REDEFINES
  3132                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  3133         16  PB-I-LF-CALC-FLAG            PIC X.
  3134             88 PB-COMP-LF-PREM               VALUE '?'.
  3135         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  3136         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  3137         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  3138         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  3139         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3140         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  3141         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  3142         16  PB-I-LF-ABBR                 PIC XXX.
  3143         16  PB-I-LF-INPUT-CD             PIC XX.
  3144
  3145         16  PB-I-AH-BENEFIT-CD           PIC XX.
  3146             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  3147             88  PB-INVALID-AH               VALUE '  ' '00'
  3148                                                   '90' THRU '99'.
  3149         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  3150         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  3151         16  PB-I-AH-CALC-FLAG            PIC X.
  3152             88 PB-COMP-AH-PREM                  VALUE '?'.
  3153         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  3154         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  3155         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  3156         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  3157         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  3158         16  PB-I-AH-ABBR                 PIC XXX.
  3159         16  PB-I-AH-INPUT-CD             PIC XXX.
  3160
  3161         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  3162         16  PB-I-REIN-TABLE              PIC XXX.
  3163         16  PB-I-BUSINESS-TYPE           PIC 99.
  3164         16  PB-I-INDV-GRP-CD             PIC X.
  3165         16  PB-I-MORT-CODE.
  3166             20  PB-I-TABLE               PIC X.
  3167             20  PB-I-INTEREST            PIC XX.
  3168             20  PB-I-MORT-TYP            PIC X.
  3169         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  3170         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  3171         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  3172         16  PB-I-INDV-GRP-OVRD           PIC X.
  3173         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  3174         16  PB-I-SIG-SW                  PIC X.
  3175             88  PB-POLICY-SIGNED             VALUE 'Y'.
  3176         16  PB-I-RATE-CLASS              PIC XX.
  3177         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  3178         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3179         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3180         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3181         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3182         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3183         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3184         16  PB-I-BENEFIT-TYPE            PIC XXX.
  3185         16  PB-I-OB-FLAG                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL930.cbl
  3186             88  PB-I-OB                      VALUE 'B'.
  3187             88  PB-I-SUMMARY                 VALUE 'Z'.
  3188         16  PB-I-ENTRY-STATUS            PIC X.
  3189             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3190                                              'M' '5' '9' '2'.
  3191             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3192             88  PB-I-POLICY-PENDING          VALUE '2'.
  3193             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3194             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3195             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3196             88  PB-I-REIN-ONLY               VALUE '9'.
  3197             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3198             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3199             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3200             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3201         16  PB-I-INT-CODE                PIC X.
  3202             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3203             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3204         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3205         16  PB-I-SOC-SEC-NO              PIC X(11).
  3206         16  PB-I-MEMBER-NO               PIC X(12).
  3207         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3208*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3209         16  PB-I-OLD-LOF                 PIC XXX.
  3210         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3211         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3212         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3213         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3214         16  PB-I-LIFE-INDICATOR          PIC X.
  3215             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3216         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3217         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3218             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3219             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3220         16  PB-I-1ST-PMT-DT              PIC XX.
  3221         16  PB-I-JOINT-INSURED.
  3222             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3223             20 PB-I-JOINT-FIRST-NAME.
  3224                24  PB-I-JOINT-FIRST-INIT PIC X.
  3225                24  FILLER                PIC X(9).
  3226             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3227*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3228         16  PB-I-BENEFICIARY-NAME.
  3229             20  PB-I-BANK-NUMBER         PIC X(10).
  3230             20  FILLER                   PIC X(15).
  3231         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  3232         16  PB-I-REFERENCE               PIC X(12).
  3233         16  FILLER REDEFINES PB-I-REFERENCE.
  3234             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  3235             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3236             20  PB-I-CLP-STATE           PIC XX.
  3237         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3238             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3239             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3240             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3241         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3242         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  3243         16  PB-I-RESIDENT-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL930.cbl
  3244         16  PB-I-RATE-CODE               PIC X(4).
  3245         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3246         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3247         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3248         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3249         16  PB-I-BANK-NOCHRGB            PIC 99.
  3250         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3251         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3252
  3253     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3254         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3255             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3256         16  PB-C-CANCEL-ORIGIN           PIC X.
  3257             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3258         16  PB-C-LF-CANCEL-DT            PIC XX.
  3259         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3260         16  PB-C-LF-CALC-REQ             PIC X.
  3261             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3262         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3263         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  3264         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  3265             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  3266         16  PB-C-AH-CANCEL-DT            PIC XX.
  3267         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3268         16  PB-C-AH-CALC-REQ             PIC X.
  3269             88 PB-COMP-AH-CANCEL            VALUE '?'.
  3270         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  3271         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  3272         16  PB-C-LAST-NAME               PIC X(15).
  3273         16  PB-C-REFUND-SW               PIC X.
  3274             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  3275             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  3276         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  3277         16  PB-C-PAYEE-CODE              PIC X(6).
  3278         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  3279         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  3280         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  3281         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  3282         16  PB-C-REFERENCE               PIC X(12).
  3283         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3284         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3285         16  PB-C-POST-CARD-IND           PIC X.
  3286         16  PB-C-CANCEL-REASON           PIC X.
  3287         16  PB-C-REF-INTERFACE-SW        PIC X.
  3288         16  FILLER                       PIC X(09).
  3289*        16  FILLER                       PIC X(18).
  3290         16  PB-C-POLICY-FORM-NO          PIC X(12).
  3291*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  3292         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  3293         16  PB-CANCELED-CERT-DATA.
  3294             20  PB-CI-INSURED-NAME.
  3295                 24  PB-CI-LAST-NAME      PIC X(15).
  3296                 24  PB-CI-INITIALS       PIC XX.
  3297             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  3298             20  PB-CI-INSURED-SEX        PIC X.
  3299             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  3300             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  3301             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL930.cbl
  3302             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  3303             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3304             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  3305             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  3306             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  3307             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  3308             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3309             20  PB-CI-RATE-CLASS         PIC XX.
  3310             20  PB-CI-RATE-DEV-LF        PIC XXX.
  3311             20  PB-CI-RATE-DEV-AH        PIC XXX.
  3312             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  3313             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  3314             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  3315             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  3316             20  PB-CI-LF-ABBR            PIC X(3).
  3317             20  PB-CI-AH-ABBR            PIC X(3).
  3318             20  PB-CI-OB-FLAG            PIC X.
  3319                 88  PB-CI-OB                VALUE 'B'.
  3320             20  PB-CI-LF-POLICY-STATUS   PIC X.
  3321                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  3322                                           'M' '4' '5' '9' '2'.
  3323                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  3324                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  3325                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  3326                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  3327                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  3328                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3329                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  3330                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3331                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  3332                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  3333                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  3334                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  3335             20  PB-CI-AH-POLICY-STATUS   PIC X.
  3336                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  3337                                           'M' '4' '5' '9' '2'.
  3338                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  3339                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  3340                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  3341                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  3342                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  3343                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3344                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  3345                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3346                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  3347                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  3348                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  3349                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  3350             20  PB-CI-PAY-FREQUENCY      PIC 99.
  3351             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  3352             20  PB-CI-SOC-SEC-NO         PIC X(11).
  3353             20  PB-CI-MEMBER-NO          PIC X(12).
  3354             20  PB-CI-INT-CODE           PIC X.
  3355                 88  PB-CI-ADD-ON                  VALUE 'A'.
  3356                 88  PB-CI-SIMPLE                  VALUE 'S'.
  3357             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  3358             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  3359             20  PB-CI-COMP-EXCP-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL930.cbl
  3360                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  3361                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  3362             20  PB-CI-ENTRY-STATUS       PIC X.
  3363             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  3364             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  3365             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  3366             20  PB-CI-DEATH-DT           PIC XX.
  3367             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  3368             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  3369             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3370             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3371             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  3372             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  3373             20  PB-CI-ENTRY-DT              PIC XX.
  3374             20  PB-CI-ENTRY-BATCH           PIC X(6).
  3375             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  3376             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  3377             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  3378             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  3379             20  PB-CI-OLD-LOF               PIC XXX.
  3380*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  3381             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  3382             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  3383             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  3384             20  PB-CI-INDV-GRP-CD           PIC X.
  3385             20  PB-CI-BENEFICIARY-NAME.
  3386                 24  PB-CI-BANK-NUMBER       PIC X(10).
  3387                 24  FILLER                  PIC X(15).
  3388             20  PB-CI-NOTE-SW               PIC X.
  3389             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  3390             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  3391             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  3392             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  3393             20  PB-CI-LOAN-OFFICER          PIC X(5).
  3394             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  3395             20  PB-CI-FIRST-NAME            PIC X(10).
  3396
  3397         16  FILLER                       PIC X(17).
  3398*032306  16  FILLER                       PIC X(27).
  3399*        16  FILLER                       PIC X(46).
  3400
  3401     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  3402         16  FILLER                       PIC X(10).
  3403         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  3404         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  3405         16  PB-M-INSURED-MID-INIT        PIC X.
  3406         16  PB-M-INSURED-AGE             PIC 99.
  3407         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  3408         16  PB-M-INSURED-SEX             PIC X.
  3409         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  3410         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  3411         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  3412         16  PB-M-INSURED-CITY-STATE.
  3413             20  PB-M-INSURED-CITY        PIC X(28).
  3414             20  PB-M-INSURED-STATE       PIC XX.
  3415         16  PB-M-INSURED-ZIP-CODE.
  3416             20  PB-M-INSURED-ZIP-PRIME.
  3417                 24  PB-M-INSURED-ZIP-1   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL930.cbl
  3418                     88  PB-M-CANADIAN-POST-CODE
  3419                                             VALUE 'A' THRU 'Z'.
  3420                 24  FILLER               PIC X(4).
  3421             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  3422         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  3423                                        PB-M-INSURED-ZIP-CODE.
  3424             20  PM-M-INS-CAN-POST1       PIC XXX.
  3425             20  PM-M-INS-CAN-POST2       PIC XXX.
  3426             20  FILLER                   PIC XXX.
  3427         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  3428         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  3429         16  PB-M-CRED-BENE-NAME          PIC X(30).
  3430         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  3431         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  3432         16  PB-M-CRED-BENE-CITYST.
  3433             20  PB-M-CRED-BENE-CITY      PIC X(28).
  3434             20  PB-M-CRED-BENE-STATE     PIC XX.
  3435         16  FILLER                       PIC X(92).
  3436
  3437     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  3438         16  FILLER                       PIC X(10).
  3439         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3440         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3441         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3442         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3443         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3444         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3445         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3446         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3447         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3448         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3449         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3450         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3451         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  3452         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  3453         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  3454         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  3455         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  3456         16  PB-ACCOUNT-NAME              PIC X(30).
  3457         16  PB-PREM-REF-RPT-FLAG         PIC X.
  3458         16  PB-REFERENCE                 PIC X(12).
  3459         16  PB-B-RECEIVED-DT             PIC XX.
  3460         16  FILLER                       PIC X(234).
  3461
  3462     12  PB-RECORD-STATUS.
  3463         16  PB-CREDIT-SELECT-DT          PIC XX.
  3464         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  3465         16  PB-BILLED-DT                 PIC XX.
  3466         16  PB-BILLING-STATUS            PIC X.
  3467             88  PB-ENTRY-REVERSED            VALUE 'R'.
  3468             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  3469             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  3470         16  PB-RECORD-BILL               PIC X.
  3471             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  3472             88  PB-RECORD-RETURNED           VALUE 'R'.
  3473             88  PB-RECORD-ENDORSED           VALUE 'E'.
  3474             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  3475             88  PB-OVERRIDE-AH               VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL930.cbl
  3476             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  3477         16  PB-BATCH-ENTRY               PIC X.
  3478             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  3479             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  3480             88  PB-REISSUED-CERT             VALUE 'E'.
  3481             88  PB-MONTHLY-CERT              VALUE 'M'.
  3482             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  3483             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  3484             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  3485         16  PB-FORCE-CODE                PIC X.
  3486             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  3487             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  3488             88  PB-CANCEL-FORCE              VALUE '8'.
  3489             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  3490             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  3491             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  3492             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  3493             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  3494             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  3495             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  3496         16  PB-FATAL-FLAG                PIC X.
  3497             88  PB-FATAL-ERRORS              VALUE 'X'.
  3498         16  PB-FORCE-ER-CD               PIC X.
  3499             88  PB-FORCE-ERRORS              VALUE 'F'.
  3500             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  3501         16  PB-WARN-ER-CD                PIC X.
  3502             88  PB-WARNING-ERRORS            VALUE 'W'.
  3503         16  FILLER                       PIC X.
  3504         16  PB-OUT-BAL-CD                PIC X.
  3505             88  PB-OUT-OF-BAL                VALUE 'O'.
  3506         16  PB-LIFE-OVERRIDE-L1          PIC X.
  3507         16  PB-AH-OVERRIDE-L1            PIC X.
  3508         16  PB-INPUT-DT                  PIC XX.
  3509         16  PB-INPUT-BY                  PIC X(4).
  3510         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  3511         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  3512         16  PB-TOLERANCE-REJECT-SW       PIC X.
  3513         16  PB-LF-EARNING-METHOD         PIC X.
  3514         16  PB-AH-EARNING-METHOD         PIC X.
  3515         16  PB-LF-TERM-CALC-METHOD       PIC X.
  3516         16  PB-AH-TERM-CALC-METHOD       PIC X.
  3517         16  PB-REIN-CD                   PIC XXX.
  3518         16  PB-LF-REFUND-TYPE            PIC X.
  3519         16  PB-AH-REFUND-TYPE            PIC X.
  3520         16  PB-ACCT-EFF-DT               PIC XX.
  3521         16  PB-ACCT-EXP-DT               PIC XX.
  3522         16  PB-COMPANY-ID                PIC X(3).
  3523         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3524         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3525         16  PB-SV-CARRIER                PIC X.
  3526         16  PB-SV-GROUPING               PIC X(6).
  3527         16  PB-SV-STATE                  PIC XX.
  3528         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  3529         16  PB-GA-BILLING-INFO.
  3530             20  PB-GA-BILL-DT OCCURS 5 TIMES
  3531                                          PIC XX.
  3532         16  PB-SV-REMIT-TO  REDEFINES
  3533             PB-GA-BILLING-INFO           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL930.cbl
  3534         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  3535         16  PB-I-LOAN-OFFICER            PIC X(5).
  3536         16  PB-I-VIN                     PIC X(17).
  3537
  3538         16  FILLER                       PIC X(04).
  3539         16  IMNET-BYPASS-SW              PIC X.
  3540
  3541******************************************************************
  3542*                COMMON EDIT ERRORS                              *
  3543******************************************************************
  3544
  3545     12  PB-COMMON-ERRORS.
  3546         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  3547                                           PIC S9(4)     COMP.
  3548
  3549******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL930.cbl
  3551*                            COPY ELCCERT.
  3552******************************************************************
  3553*                                                                *
  3554*                            ELCCERT.                            *
  3555*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3556*                            VMOD=2.013                          *
  3557*                                                                *
  3558*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  3559*                                                                *
  3560*   FILE TYPE = VSAM,KSDS                                        *
  3561*   RECORD SIZE = 450  RECFORM = FIXED                           *
  3562*                                                                *
  3563*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  3564*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  3565*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  3566*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  3567*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  3568*                                                                *
  3569*   LOG = YES                                                    *
  3570*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3571******************************************************************
  3572*                   C H A N G E   L O G
  3573*
  3574* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3575*-----------------------------------------------------------------
  3576*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3577* EFFECTIVE    NUMBER
  3578*-----------------------------------------------------------------
  3579* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3580* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3581* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  3582* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3583* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3584* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  3585* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3586******************************************************************
  3587
  3588 01  CERTIFICATE-MASTER.
  3589     12  CM-RECORD-ID                      PIC XX.
  3590         88  VALID-CM-ID                      VALUE 'CM'.
  3591
  3592     12  CM-CONTROL-PRIMARY.
  3593         16  CM-COMPANY-CD                 PIC X.
  3594         16  CM-CARRIER                    PIC X.
  3595         16  CM-GROUPING.
  3596             20  CM-GROUPING-PREFIX        PIC X(3).
  3597             20  CM-GROUPING-PRIME         PIC X(3).
  3598         16  CM-STATE                      PIC XX.
  3599         16  CM-ACCOUNT.
  3600             20  CM-ACCOUNT-PREFIX         PIC X(4).
  3601             20  CM-ACCOUNT-PRIME          PIC X(6).
  3602         16  CM-CERT-EFF-DT                PIC XX.
  3603         16  CM-CERT-NO.
  3604             20  CM-CERT-PRIME             PIC X(10).
  3605             20  CM-CERT-SFX               PIC X.
  3606
  3607     12  CM-CONTROL-BY-NAME.
  3608         16  CM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL930.cbl
  3609         16  CM-INSURED-LAST-NAME          PIC X(15).
  3610         16  CM-INSURED-INITIALS.
  3611             20  CM-INSURED-INITIAL1       PIC X.
  3612             20  CM-INSURED-INITIAL2       PIC X.
  3613
  3614     12  CM-CONTROL-BY-SSN.
  3615         16  CM-COMPANY-CD-A2              PIC X.
  3616         16  CM-SOC-SEC-NO.
  3617             20  CM-SSN-STATE              PIC XX.
  3618             20  CM-SSN-ACCOUNT            PIC X(6).
  3619             20  CM-SSN-LN3.
  3620                 25  CM-INSURED-INITIALS-A2.
  3621                     30 CM-INSURED-INITIAL1-A2   PIC X.
  3622                     30 CM-INSURED-INITIAL2-A2   PIC X.
  3623                 25 CM-PART-LAST-NAME-A2         PIC X.
  3624
  3625     12  CM-CONTROL-BY-CERT-NO.
  3626         16  CM-COMPANY-CD-A4              PIC X.
  3627         16  CM-CERT-NO-A4                 PIC X(11).
  3628
  3629     12  CM-CONTROL-BY-MEMB.
  3630         16  CM-COMPANY-CD-A5              PIC X.
  3631         16  CM-MEMBER-NO.
  3632             20  CM-MEMB-STATE             PIC XX.
  3633             20  CM-MEMB-ACCOUNT           PIC X(6).
  3634             20  CM-MEMB-LN4.
  3635                 25  CM-INSURED-INITIALS-A5.
  3636                     30 CM-INSURED-INITIAL1-A5   PIC X.
  3637                     30 CM-INSURED-INITIAL2-A5   PIC X.
  3638                 25 CM-PART-LAST-NAME-A5         PIC XX.
  3639
  3640     12  CM-INSURED-PROFILE-DATA.
  3641         16  CM-INSURED-FIRST-NAME.
  3642             20  CM-INSURED-1ST-INIT       PIC X.
  3643             20  FILLER                    PIC X(9).
  3644         16  CM-INSURED-ISSUE-AGE          PIC 99.
  3645         16  CM-INSURED-SEX                PIC X.
  3646             88  CM-SEX-MALE                  VALUE 'M'.
  3647             88  CM-SEX-FEMAL                 VALUE 'F'.
  3648         16  CM-INSURED-JOINT-AGE          PIC 99.
  3649         16  CM-JOINT-INSURED-NAME.
  3650             20  CM-JT-LAST-NAME           PIC X(15).
  3651             20  CM-JT-FIRST-NAME.
  3652                 24  CM-JT-1ST-INIT        PIC X.
  3653                 24  FILLER                PIC X(9).
  3654             20  CM-JT-INITIAL             PIC X.
  3655
  3656     12  CM-LIFE-DATA.
  3657         16  CM-LF-BENEFIT-CD              PIC XX.
  3658         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  3659         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  3660         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  3661         16  CM-LF-DEV-CODE                PIC XXX.
  3662         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3663         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  3664         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3665         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  3666         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL930.cbl
  3667         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3668         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  3669         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3670         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  3671         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3672         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3673         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  3674         16  FILLER                        PIC XX.
  3675
  3676     12  CM-AH-DATA.
  3677         16  CM-AH-BENEFIT-CD              PIC XX.
  3678         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  3679         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  3680         16  CM-AH-DEV-CODE                PIC XXX.
  3681         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  3682         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  3683         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  3684         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  3685         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  3686         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  3687         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  3688         16  CM-AH-PAID-THRU-DT            PIC XX.
  3689             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  3690         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  3691         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  3692         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  3693         16  FILLER                        PIC X.
  3694
  3695     12  CM-LOAN-INFORMATION.
  3696         16  CM-LIVES                      PIC S9(7)     COMP-3.
  3697         16  CM-BILLED                     PIC S9(7)     COMP-3.
  3698         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  3699         16  CM-PAY-FREQUENCY              PIC S99.
  3700         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  3701         16  CM-RATE-CLASS                 PIC XX.
  3702         16  CM-BENEFICIARY                PIC X(25).
  3703         16  CM-POLICY-FORM-NO             PIC X(12).
  3704         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  3705         16  CM-LAST-ADD-ON-DT             PIC XX.
  3706         16  CM-DEDUCTIBLE-AMOUNTS.
  3707             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  3708             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  3709         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3710             20  CM-RESIDENT-STATE         PIC XX.
  3711             20  CM-RATE-CODE              PIC X(4).
  3712             20  FILLER                    PIC XX.
  3713         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  3714             20  CM-LOAN-OFFICER           PIC X(5).
  3715             20  FILLER                    PIC XXX.
  3716         16  CM-CSR-CODE                   PIC XXX.
  3717         16  CM-UNDERWRITING-CODE          PIC X.
  3718             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  3719         16  CM-POST-CARD-IND              PIC X.
  3720         16  CM-NH-INTERFACE-SW            PIC X.
  3721         16  CM-PREMIUM-TYPE               PIC X.
  3722             88  CM-SING-PRM                  VALUE '1'.
  3723             88  CM-O-B-COVERAGE              VALUE '2'.
  3724             88  CM-OPEN-END                  VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL930.cbl
  3725         16  CM-IND-GRP-TYPE               PIC X.
  3726             88  CM-INDIVIDUAL                VALUE 'I'.
  3727             88  CM-GROUP                     VALUE 'G'.
  3728         16  CM-SKIP-CODE                  PIC X.
  3729             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  3730             88  SKIP-JULY                    VALUE '1'.
  3731             88  SKIP-AUGUST                  VALUE '2'.
  3732             88  SKIP-SEPTEMBER               VALUE '3'.
  3733             88  SKIP-JULY-AUG                VALUE '4'.
  3734             88  SKIP-AUG-SEPT                VALUE '5'.
  3735             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  3736             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  3737             88  SKIP-JUNE                    VALUE '8'.
  3738             88  SKIP-JUNE-JULY               VALUE '9'.
  3739             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  3740             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  3741         16  CM-PAYMENT-MODE               PIC X.
  3742             88  PAY-MONTHLY                  VALUE SPACE.
  3743             88  PAY-WEEKLY                   VALUE '1'.
  3744             88  PAY-SEMI-MONTHLY             VALUE '2'.
  3745             88  PAY-BI-WEEKLY                VALUE '3'.
  3746             88  PAY-SEMI-ANUALLY             VALUE '4'.
  3747         16  CM-LOAN-NUMBER                PIC X(8).
  3748         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  3749         16  CM-OLD-LOF                    PIC XXX.
  3750*        16  CM-LOAN-OFFICER               PIC XXX.
  3751         16  CM-REIN-TABLE                 PIC XXX.
  3752         16  CM-SPECIAL-REIN-CODE          PIC X.
  3753         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  3754         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  3755         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  3756
  3757     12  CM-STATUS-DATA.
  3758         16  CM-ENTRY-STATUS               PIC X.
  3759         16  CM-ENTRY-DT                   PIC XX.
  3760
  3761         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  3762         16  CM-LF-CANCEL-DT               PIC XX.
  3763         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  3764
  3765         16  CM-LF-STATUS-AT-DEATH         PIC X.
  3766         16  CM-LF-DEATH-DT                PIC XX.
  3767         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  3768
  3769         16  CM-LF-CURRENT-STATUS          PIC X.
  3770             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3771                                                'M' '4' '5' '9'.
  3772             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  3773             88  CM-LF-POLICY-PENDING         VALUE '2'.
  3774             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  3775             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  3776             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  3777             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3778             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  3779             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3780             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  3781             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  3782             88  CM-LF-DECLINED               VALUE 'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL930.cbl
  3783             88  CM-LF-VOIDED                 VALUE 'V'.
  3784
  3785         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  3786         16  CM-AH-CANCEL-DT               PIC XX.
  3787         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  3788
  3789         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  3790         16  CM-AH-SETTLEMENT-DT           PIC XX.
  3791         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  3792
  3793         16  CM-AH-CURRENT-STATUS          PIC X.
  3794             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  3795                                                'M' '4' '5' '9'.
  3796             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  3797             88  CM-AH-POLICY-PENDING         VALUE '2'.
  3798             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  3799             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  3800             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  3801             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3802             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  3803             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3804             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  3805             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  3806             88  CM-AH-DECLINED               VALUE 'D'.
  3807             88  CM-AH-VOIDED                 VALUE 'V'.
  3808
  3809         16  CM-CLAIM-INTERFACE-SW         PIC X.
  3810             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  3811             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  3812             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  3813         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  3814
  3815         16  CM-ENTRY-BATCH                PIC X(6).
  3816         16  CM-LF-EXIT-BATCH              PIC X(6).
  3817         16  CM-AH-EXIT-BATCH              PIC X(6).
  3818         16  CM-LAST-MONTH-END             PIC XX.
  3819
  3820     12  CM-NOTE-SW                        PIC X.
  3821         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  3822         88  CERT-NOTES-PRESENT               VALUE '1'.
  3823         88  BILLING-NOTES-PRESENT            VALUE '2'.
  3824         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  3825         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  3826         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  3827         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  3828         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  3829     12  CM-COMP-EXCP-SW                   PIC X.
  3830         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  3831         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  3832     12  CM-INSURED-ADDRESS-SW             PIC X.
  3833         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  3834         88  INSURED-ADDR-PRESENT             VALUE '1'.
  3835
  3836*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  3837     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  3838     12  FILLER                            PIC X.
  3839
  3840*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL930.cbl
  3841     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  3842     12  FILLER                            PIC X.
  3843*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  3844     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  3845
  3846     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  3847         88  CERT-ADDED-BATCH                 VALUE ' '.
  3848         88  CERT-ADDED-ONLINE                VALUE '1'.
  3849         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  3850         88  CERT-PURGED-OFFLINE              VALUE '3'.
  3851         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  3852     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  3853         88  CERT-AS-LOADED                   VALUE ' '.
  3854         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  3855         88  CERT-CLAIM-ONLINE                VALUE '2'.
  3856         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  3857         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  3858         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  3859         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  3860         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  3861
  3862     12  CM-ACCOUNT-COMM-PCTS.
  3863         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  3864         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  3865
  3866     12  CM-USER-FIELD                     PIC X.
  3867     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  3868     12  CM-CLP-STATE                      PIC XX.
  3869     12  CM-USER-RESERVED                  PIC XXX.
  3870******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL930.cbl
  3872*                            COPY ERCNOTE.
  3873******************************************************************
  3874*                                                                *
  3875*                                                                *
  3876*                            ERCNOTE                             *
  3877*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3878*                            VMOD=2.003                          *
  3879*                                                                *
  3880*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  3881*                                                                *
  3882*        FILE TYPE= VSAM,KSDS                                    *
  3883*        RECORD SIZE = 825    RECFORM = FIXED                    *
  3884*                                                                *
  3885*        BASE CLUSTER = ERNOTE        RKP=2,LEN=33               *
  3886*                                                                *
  3887*        LOG = YES                                               *
  3888*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  3889*                                                                *
  3890******************************************************************
  3891*                   C H A N G E   L O G
  3892*
  3893* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3894*-----------------------------------------------------------------
  3895*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3896* EFFECTIVE    NUMBER
  3897*-----------------------------------------------------------------
  3898* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  3899*                                FILE WILL CONTAIN BILLING NOTES O
  3900******************************************************************
  3901
  3902 01  CERTIFICATE-NOTE.
  3903     12  CN-RECORD-ID                PIC  XX.
  3904         88  VALID-CN-ID                  VALUE 'CN'.
  3905
  3906     12  CN-CONTROL-PRIMARY.
  3907         16  CN-COMPANY-CD           PIC X.
  3908         16  CN-CARRIER              PIC X.
  3909         16  CN-GROUPING.
  3910             20 CN-GROUPING-PREFIX   PIC XXX.
  3911             20 CN-GROUPING-PRIME    PIC XXX.
  3912         16  CN-STATE                PIC XX.
  3913         16  CN-ACCOUNT.
  3914             20 CN-ACCOUNT-PREFIX    PIC X(4).
  3915             20 CN-ACCOUNT-PRIME     PIC X(6).
  3916         16  CN-CERT-EFF-DT          PIC XX.
  3917         16  CN-CERT-NO.
  3918             20  CN-CERT-PRIME       PIC X(10).
  3919             20  CN-CERT-SFX         PIC X.
  3920
  3921     12  CN-BILLING-START-LINE-NO    PIC 99.
  3922     12  CN-BILLING-END-LINE-NO      PIC 99.
  3923
  3924     12  CN-LINES.
  3925         16  CN-LINE OCCURS 10       PIC X(77).
  3926
  3927     12  CN-LAST-MAINT-DT            PIC XX.
  3928     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  3929     12  CN-LAST-MAINT-USER          PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL930.cbl
  3930     12  FILLER                      PIC X(6).
  3931******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL930.cbl
  3933*                            COPY ERCMAIL.
  3934******************************************************************
  3935*                                                                *
  3936*                                                                *
  3937*                            ERCMAIL                             *
  3938*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3939*                            VMOD=2.003                          *
  3940*                                                                *
  3941*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  3942*                                                                *
  3943*   FILE TYPE = VSAM,KSDS                                        *
  3944*   RECORD SIZE = 374   RECFORM = FIX                            *
  3945*                                                                *
  3946*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  3947*   ALTERNATE PATH    = NOT USED                                 *
  3948*                                                                *
  3949*   LOG = YES                                                    *
  3950*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3951******************************************************************
  3952*                   C H A N G E   L O G
  3953*
  3954* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3955*-----------------------------------------------------------------
  3956*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3957* EFFECTIVE    NUMBER
  3958*-----------------------------------------------------------------
  3959* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  3960* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3961* 111108                   PEMA  ADD CRED BENE ADDR2
  3962******************************************************************
  3963
  3964 01  MAILING-DATA.
  3965     12  MA-RECORD-ID                      PIC XX.
  3966         88  VALID-MA-ID                       VALUE 'MA'.
  3967
  3968     12  MA-CONTROL-PRIMARY.
  3969         16  MA-COMPANY-CD                 PIC X.
  3970         16  MA-CARRIER                    PIC X.
  3971         16  MA-GROUPING.
  3972             20  MA-GROUPING-PREFIX        PIC XXX.
  3973             20  MA-GROUPING-PRIME         PIC XXX.
  3974         16  MA-STATE                      PIC XX.
  3975         16  MA-ACCOUNT.
  3976             20  MA-ACCOUNT-PREFIX         PIC X(4).
  3977             20  MA-ACCOUNT-PRIME          PIC X(6).
  3978         16  MA-CERT-EFF-DT                PIC XX.
  3979         16  MA-CERT-NO.
  3980             20  MA-CERT-PRIME             PIC X(10).
  3981             20  MA-CERT-SFX               PIC X.
  3982
  3983     12  FILLER                            PIC XX.
  3984
  3985     12  MA-ACCESS-CONTROL.
  3986         16  MA-SOURCE-SYSTEM              PIC XX.
  3987             88  MA-FROM-CREDIT                VALUE 'CR'.
  3988             88  MA-FROM-VSI                   VALUE 'VS'.
  3989             88  MA-FROM-WARRANTY              VALUE 'WA'.
  3990             88  MA-FROM-OTHER                 VALUE 'OT'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL930.cbl
  3991         16  MA-RECORD-ADD-DT              PIC XX.
  3992         16  MA-RECORD-ADDED-BY            PIC XXXX.
  3993         16  MA-LAST-MAINT-DT              PIC XX.
  3994         16  MA-LAST-MAINT-BY              PIC XXXX.
  3995         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  3996
  3997     12  MA-PROFILE-INFO.
  3998         16  MA-QUALIFY-CODE-1             PIC XX.
  3999         16  MA-QUALIFY-CODE-2             PIC XX.
  4000         16  MA-QUALIFY-CODE-3             PIC XX.
  4001         16  MA-QUALIFY-CODE-4             PIC XX.
  4002         16  MA-QUALIFY-CODE-5             PIC XX.
  4003
  4004         16  MA-INSURED-LAST-NAME          PIC X(15).
  4005         16  MA-INSURED-FIRST-NAME         PIC X(10).
  4006         16  MA-INSURED-MIDDLE-INIT        PIC X.
  4007         16  MA-INSURED-ISSUE-AGE          PIC 99.
  4008         16  MA-INSURED-BIRTH-DT           PIC XX.
  4009         16  MA-INSURED-SEX                PIC X.
  4010             88  MA-SEX-MALE                   VALUE 'M'.
  4011             88  MA-SEX-FEMALE                 VALUE 'F'.
  4012         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  4013
  4014         16  MA-ADDRESS-CORRECTED          PIC X.
  4015         16  MA-JOINT-BIRTH-DT             PIC XX.
  4016*        16  FILLER                        PIC X(12).
  4017
  4018         16  MA-ADDRESS-LINE-1             PIC X(30).
  4019         16  MA-ADDRESS-LINE-2             PIC X(30).
  4020         16  MA-CITY-STATE.
  4021             20  MA-CITY                   PIC X(28).
  4022             20  MA-ADDR-STATE             PIC XX.
  4023         16  MA-ZIP.
  4024             20  MA-ZIP-CODE.
  4025                 24  MA-ZIP-CODE-1ST       PIC X(1).
  4026                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4027                 24  FILLER                PIC X(4).
  4028             20  MA-ZIP-PLUS4              PIC X(4).
  4029         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  4030             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  4031             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  4032             20  FILLER                    PIC X(3).
  4033
  4034         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  4035
  4036         16  FILLER                        PIC XXX.
  4037*        16  FILLER                        PIC X(10).
  4038
  4039     12  MA-CRED-BENE-INFO.
  4040         16  MA-CRED-BENE-NAME                 PIC X(25).
  4041         16  MA-CRED-BENE-ADDR                 PIC X(30).
  4042         16  MA-CRED-BENE-ADDR2                PIC X(30).
  4043         16  MA-CRED-BENE-CTYST.
  4044             20  MA-CRED-BENE-CITY             PIC X(28).
  4045             20  MA-CRED-BENE-STATE            PIC XX.
  4046         16  MA-CRED-BENE-ZIP.
  4047             20  MA-CB-ZIP-CODE.
  4048                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL930.cbl
  4049                     88  MA-CB-CANADIAN-POST-CODE
  4050                                           VALUE 'A' THRU 'Z'.
  4051                 24  FILLER                    PIC X(4).
  4052             20  MA-CB-ZIP-PLUS4               PIC X(4).
  4053         16  MA-CB-CANADIAN-POSTAL-CODE
  4054                            REDEFINES MA-CRED-BENE-ZIP.
  4055             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  4056             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  4057             20  FILLER                        PIC X(3).
  4058     12  MA-POST-CARD-MAIL-DATA.
  4059         16  MA-MAIL-DATA OCCURS 7.
  4060             20  MA-MAIL-TYPE              PIC X.
  4061                 88  MA-12MO-MAILING           VALUE '1'.
  4062                 88  MA-EXP-MAILING            VALUE '2'.
  4063             20  MA-MAIL-STATUS            PIC X.
  4064                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  4065                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  4066                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  4067             20  MA-MAIL-DATE              PIC XX.
  4068     12  FILLER                            PIC XX.
  4069     12  FILLER                            PIC XX.
  4070*    12  FILLER                            PIC X(30).
  4071******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL930.cbl
  4073*                            COPY ERCPNDM.
  4074******************************************************************
  4075*                                                                *
  4076*                                                                *
  4077*                            ERCPNDM                             *
  4078*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4079*                            VMOD=2.003                          *
  4080*                                                                *
  4081*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  4082*                                                                *
  4083*   FILE TYPE = VSAM,KSDS                                        *
  4084*   RECORD SIZE = 374   RECFORM = FIX                            *
  4085*                                                                *
  4086*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  4087*   ALTERNATE PATH    = NOT USED                                 *
  4088*                                                                *
  4089*   LOG = YES                                                    *
  4090*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4091******************************************************************
  4092*                   C H A N G E   L O G
  4093*
  4094* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4095*-----------------------------------------------------------------
  4096*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4097* EFFECTIVE    NUMBER
  4098*-----------------------------------------------------------------
  4099* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  4100* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  4101* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4102******************************************************************
  4103
  4104 01  PENDING-MAILING-DATA.
  4105     12  PM-RECORD-ID                      PIC XX.
  4106         88  VALID-MA-ID                       VALUE 'PM'.
  4107
  4108     12  PM-CONTROL-PRIMARY.
  4109         16  PM-COMPANY-CD                 PIC X.
  4110         16  PM-ENTRY-BATCH                PIC X(6).
  4111         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  4112         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  4113
  4114     12  FILLER                            PIC X(14).
  4115
  4116     12  PM-ACCESS-CONTROL.
  4117         16  PM-SOURCE-SYSTEM              PIC XX.
  4118             88  PM-FROM-CREDIT                VALUE 'CR'.
  4119             88  PM-FROM-VSI                   VALUE 'VS'.
  4120             88  PM-FROM-WARRANTY              VALUE 'WA'.
  4121             88  PM-FROM-OTHER                 VALUE 'OT'.
  4122         16  PM-RECORD-ADD-DT              PIC XX.
  4123         16  PM-RECORD-ADDED-BY            PIC XXXX.
  4124         16  PM-LAST-MAINT-DT              PIC XX.
  4125         16  PM-LAST-MAINT-BY              PIC XXXX.
  4126         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  4127
  4128     12  PM-PROFILE-INFO.
  4129         16  PM-QUALIFY-CODE-1             PIC XX.
  4130         16  PM-QUALIFY-CODE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL930.cbl
  4131         16  PM-QUALIFY-CODE-3             PIC XX.
  4132         16  PM-QUALIFY-CODE-4             PIC XX.
  4133         16  PM-QUALIFY-CODE-5             PIC XX.
  4134
  4135         16  PM-INSURED-LAST-NAME          PIC X(15).
  4136         16  PM-INSURED-FIRST-NAME         PIC X(10).
  4137         16  PM-INSURED-MIDDLE-INIT        PIC X.
  4138         16  PM-INSURED-ISSUE-AGE          PIC 99.
  4139         16  PM-INSURED-BIRTH-DT           PIC XX.
  4140         16  PM-INSURED-SEX                PIC X.
  4141             88  PM-SEX-MALE                   VALUE 'M'.
  4142             88  PM-SEX-FEMALE                 VALUE 'F'.
  4143         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  4144
  4145         16  PM-ADDRESS-CORRECTED          PIC X.
  4146         16  PM-JOINT-BIRTH-DT             PIC XX.
  4147*        16  FILLER                        PIC X(12).
  4148
  4149         16  PM-ADDRESS-LINE-1             PIC X(30).
  4150         16  PM-ADDRESS-LINE-2             PIC X(30).
  4151         16  PM-CITY-STATE.
  4152             20  PM-CITY                   PIC X(28).
  4153             20  PM-STATE                  PIC XX.
  4154         16  PM-ZIP.
  4155             20  PM-ZIP-CODE.
  4156                 24  PM-ZIP-1              PIC X.
  4157                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4158                 24  FILLER                PIC X(4).
  4159             20  PM-ZIP-PLUS4              PIC X(4).
  4160         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  4161             20  PM-CAN-POST1              PIC XXX.
  4162             20  PM-CAN-POST2              PIC XXX.
  4163             20  FILLER                    PIC XXX.
  4164
  4165         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  4166
  4167         16  FILLER                        PIC X(03).
  4168
  4169     12  PM-CRED-BENE-INFO.
  4170         16  PM-CRED-BENE-NAME             PIC X(25).
  4171         16  PM-CRED-BENE-ADDR             PIC X(30).
  4172         16  PM-CRED-BENE-ADDR2            PIC X(30).
  4173         16  PM-CRED-BENE-CTYST.
  4174             20  PM-CRED-BENE-CITY         PIC X(28).
  4175             20  PM-CRED-BENE-STATE        PIC XX.
  4176         16  PM-CRED-BENE-ZIP.
  4177             20  PM-CB-ZIP-CODE.
  4178                 24  PM-CB-ZIP-1           PIC X.
  4179                     88  PM-CB-CANADIAN-POST-CODE
  4180                                  VALUE 'A' THRU 'Z'.
  4181                 24  FILLER                PIC X(4).
  4182             20  PM-CB-ZIP-PLUS4           PIC X(4).
  4183         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  4184             20  PM-CB-CAN-POST1           PIC XXX.
  4185             20  PM-CB-CAN-POST2           PIC XXX.
  4186             20  FILLER                    PIC XXX.
  4187     12  PM-POST-CARD-MAIL-DATA.
  4188         16  PM-MAIL-DATA OCCURS 7.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL930.cbl
  4189             20  PM-MAIL-TYPE              PIC X.
  4190                 88  PM-12MO-MAILING           VALUE '1'.
  4191                 88  PM-EXP-MAILING            VALUE '2'.
  4192             20  PM-MAIL-STATUS            PIC X.
  4193                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  4194                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  4195                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  4196             20  PM-MAIL-DATE              PIC XX.
  4197     12  FILLER                            PIC XX.
  4198     12  FILLER                            PIC X(12).
  4199*    12  FILLER                            PIC X(30).
  4200
  4201******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL930.cbl
  4203
  4204 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PARMLIST
  4205                          CONTROL-FILE PENDING-BUSINESS
  4206                          CERTIFICATE-MASTER CERTIFICATE-NOTE
  4207                          MAILING-DATA PENDING-MAILING-DATA.
  4208 0000-DFHEXIT SECTION.
  4209     MOVE '9#                    $   ' TO DFHEIV0.
  4210     MOVE 'EL930' TO DFHEIV1.
  4211     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4212     SERVICE RELOAD PARMLIST.
  4213     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  4214     MOVE 2                      TO EMI-NUMBER-OF-LINES.
  4215     IF EIBCALEN = 0
  4216         GO TO 8800-UNAUTHORIZED-ACCESS.
  4217     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  4218     MOVE '5'                    TO DC-OPTION-CODE.
  4219     MOVE LINK-CLDATCV           TO PGM-NAME.
  4220
  4221
  4222* EXEC CICS LINK
  4223*        PROGRAM(PGM-NAME)
  4224*        COMMAREA(DATE-CONVERSION-DATA)
  4225*        LENGTH(DC-COMM-LENGTH)
  4226*        END-EXEC.
  4227*    MOVE '."C                   ''   #00004217' TO DFHEIV0
  4228     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4229     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4230     MOVE X'2020233030303034323137' TO DFHEIV0(25:11)
  4231     CALL 'kxdfhei1' USING DFHEIV0,
  4232           PGM-NAME,
  4233           DATE-CONVERSION-DATA,
  4234           DC-COMM-LENGTH,
  4235           DFHEIV99,
  4236           DFHEIV99,
  4237           DFHEIV99
  4238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4239
  4240     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  4241     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT.
  4242
  4243     MOVE PI-CALLING-PROGRAM TO PI-SAVE-CALLING-PGM.
  4244     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  4245         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  4246             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  4247             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  4248             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  4249             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  4250             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  4251             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  4252             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  4253             MOVE THIS-PGM TO PI-CALLING-PROGRAM
  4254         ELSE
  4255             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  4256             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  4257             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  4258             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  4259             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  4260             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL930.cbl
  4261             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  4262             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  4263
  4264     MOVE LOW-VALUES             TO EL930AI.
  4265
  4266     IF PI-SAVE-CALLING-PGM = XCTL-9302
  4267         GO TO 4000-SHOW-TOTALS.
  4268     IF PI-SAVE-CALLING-PGM = XCTL-9301
  4269         MOVE 'N'                TO PI-EL930-FIRST-TIME-SW
  4270         IF PI-ISS-CNT-ENTERED = ZEROS
  4271           AND PI-CAN-CNT-ENTERED = ZEROS
  4272             MOVE 'Y'            TO PI-VERIFY-DELETE-SW
  4273             GO TO 3000-DELETE-ENTERED-BATCH
  4274         ELSE
  4275             GO TO 4000-SHOW-TOTALS.
  4276     IF EIBTRNID NOT = TRANS-ID
  4277         MOVE ZEROS              TO PI-LAST-SEQ-NO-ADDED
  4278         MOVE QUESTION-MARKS     TO BATCHI
  4279         MOVE AL-UANON           TO BATCHA
  4280         GO TO 8100-SEND-INITIAL-MAP.
  4281
  4282
  4283* EXEC CICS HANDLE CONDITION
  4284*        PGMIDERR  (9600-PGMID-ERROR)
  4285*        ERROR     (9990-ABEND)
  4286*        END-EXEC.
  4287*    MOVE '"$L.                  ! " #00004264' TO DFHEIV0
  4288     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  4289     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4290     MOVE X'2220233030303034323634' TO DFHEIV0(25:11)
  4291     CALL 'kxdfhei1' USING DFHEIV0
  4292     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4293
  4294
  4295     IF EIBAID = DFHCLEAR
  4296         GO TO 9400-CLEAR.
  4297
  4298     IF PI-PROCESSOR-ID = 'LGXX'
  4299         GO TO 0200-RECEIVE.
  4300
  4301
  4302* EXEC CICS READQ TS
  4303*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  4304*        INTO   (SECURITY-CONTROL)
  4305*        LENGTH (SC-COMM-LENGTH)
  4306*        ITEM   (SC-ITEM)
  4307*    END-EXEC.
  4308*    MOVE '*$II   L              ''   #00004275' TO DFHEIV0
  4309     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4310     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4311     MOVE X'2020233030303034323735' TO DFHEIV0(25:11)
  4312     CALL 'kxdfhei1' USING DFHEIV0,
  4313           PI-SECURITY-TEMP-STORE-ID,
  4314           SECURITY-CONTROL,
  4315           SC-COMM-LENGTH,
  4316           SC-ITEM,
  4317           DFHEIV99,
  4318           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL930.cbl
  4319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4320
  4321
  4322     MOVE SC-CREDIT-DISPLAY (11)  TO PI-DISPLAY-CAP.
  4323     MOVE SC-CREDIT-UPDATE  (11)  TO PI-MODIFY-CAP.
  4324
  4325     IF NOT DISPLAY-CAP
  4326         MOVE 'READ'          TO SM-READ
  4327         PERFORM 9995-SECURITY-VIOLATION
  4328         MOVE ER-0070         TO  EMI-ERROR
  4329         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4330         GO TO 8100-SEND-INITIAL-MAP.
  4331
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL930.cbl
  4333 0200-RECEIVE.
  4334     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  4335         MOVE ER-0008            TO EMI-ERROR
  4336         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4337         MOVE -1                 TO MAINTL
  4338         GO TO 8200-SEND-DATAONLY.
  4339
  4340
  4341* EXEC CICS RECEIVE
  4342*        MAP      (MAP-NAME)
  4343*        MAPSET   (MAPSET-NAME)
  4344*        INTO     (EL930AI)
  4345*        END-EXEC.
  4346     MOVE LENGTH OF
  4347      EL930AI
  4348       TO DFHEIV11
  4349*    MOVE '8"T I  L              ''   #00004300' TO DFHEIV0
  4350     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4351     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4352     MOVE X'2020233030303034333030' TO DFHEIV0(25:11)
  4353     CALL 'kxdfhei1' USING DFHEIV0,
  4354           MAP-NAME,
  4355           EL930AI,
  4356           DFHEIV11,
  4357           MAPSET-NAME,
  4358           DFHEIV99,
  4359           DFHEIV99
  4360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4361
  4362
  4363     IF PFENTERL = 0
  4364         GO TO 0300-CHECK-PFKEYS.
  4365     IF (PFENTERI NUMERIC)
  4366       AND (PFENTERI GREATER THAN 0 AND LESS THAN 25)
  4367         MOVE PF-VALUES (PFENTERI) TO EIBAID
  4368     ELSE
  4369         MOVE ER-0029            TO EMI-ERROR
  4370         GO TO 0320-INPUT-ERROR.
  4371
  4372 0300-CHECK-PFKEYS.
  4373     IF EIBAID = DFHPF23
  4374         GO TO 8810-PF23.
  4375     IF EIBAID = DFHPF24
  4376         GO TO 9200-RETURN-MAIN-MENU.
  4377     IF EIBAID = DFHPF12
  4378         GO TO 9500-PF12.
  4379
  4380     IF EIBAID = DFHPF1
  4381        IF PI-DATA-UPDATED
  4382             MOVE 'Y'            TO WS-PF1-SW
  4383             MOVE SPACE          TO PI-NB-MONTH-END-DT
  4384             PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  4385             MOVE SPACES TO BATCH-TO-PROCESS
  4386             MOVE PI-COMPANY-ID  TO EDIT-COMPANY-ID
  4387             MOVE PI-COMPANY-CD  TO EDIT-COMPANY-CD
  4388             MOVE PI-SAV-ENTRY-BATCH TO EDIT-BATCH
  4389
  4390* EXEC CICS START
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL930.cbl
  4391*               TRANSID       (EDIT-TRANS)
  4392*               FROM          (BATCH-TO-PROCESS)
  4393*               LENGTH        (PASS-AREA-LEN)
  4394*               END-EXEC
  4395*    MOVE '0( LF                 0   #00004332' TO DFHEIV0
  4396     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  4397     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  4398     MOVE X'2020233030303034333332' TO DFHEIV0(25:11)
  4399     CALL 'kxdfhei1' USING DFHEIV0,
  4400           DFHEIV99,
  4401           EDIT-TRANS,
  4402           DFHEIV99,
  4403           BATCH-TO-PROCESS,
  4404           PASS-AREA-LEN,
  4405           DFHEIV99,
  4406           DFHEIV99,
  4407           DFHEIV99,
  4408           DFHEIV99,
  4409           DFHEIV99,
  4410           DFHEIV99,
  4411           DFHEIV99,
  4412           DFHEIV99,
  4413           DFHEIV99,
  4414           DFHEIV99
  4415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4416             MOVE SPACES         TO PI-UPDATE-SW
  4417                                    PI-KEYED-SWITCHES
  4418             MOVE ZEROS          TO PI-ISS-CNT-ENTERED
  4419             MOVE ZEROS          TO PI-CAN-CNT-ENTERED
  4420             MOVE ZEROS          TO EMI-ERROR
  4421             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4422             MOVE LOW-VALUES     TO EL930AO
  4423             MOVE QUESTION-MARKS TO BATCHI
  4424             MOVE AL-UANON       TO BATCHA
  4425             MOVE -1             TO MAINTL
  4426             GO TO 8100-SEND-INITIAL-MAP
  4427         ELSE
  4428             IF  MAINTI = 'N'
  4429                 MOVE -1             TO MAINTL
  4430                 MOVE ER-2211        TO EMI-ERROR
  4431                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4432                 GO TO 8200-SEND-DATAONLY.
  4433
  4434
  4435     IF EIBAID = DFHPF1
  4436             MOVE SPACE          TO PI-NB-MONTH-END-DT
  4437             MOVE SPACES TO BATCH-TO-PROCESS
  4438             MOVE PI-COMPANY-ID  TO EDIT-COMPANY-ID
  4439             MOVE PI-COMPANY-CD  TO EDIT-COMPANY-CD
  4440             MOVE PI-SAV-ENTRY-BATCH TO EDIT-BATCH
  4441
  4442* EXEC CICS START
  4443*               TRANSID       (EDIT-TRANS)
  4444*               FROM          (BATCH-TO-PROCESS)
  4445*               LENGTH        (PASS-AREA-LEN)
  4446*               END-EXEC
  4447*    MOVE '0( LF                 0   #00004362' TO DFHEIV0
  4448     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL930.cbl
  4449     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  4450     MOVE X'2020233030303034333632' TO DFHEIV0(25:11)
  4451     CALL 'kxdfhei1' USING DFHEIV0,
  4452           DFHEIV99,
  4453           EDIT-TRANS,
  4454           DFHEIV99,
  4455           BATCH-TO-PROCESS,
  4456           PASS-AREA-LEN,
  4457           DFHEIV99,
  4458           DFHEIV99,
  4459           DFHEIV99,
  4460           DFHEIV99,
  4461           DFHEIV99,
  4462           DFHEIV99,
  4463           DFHEIV99,
  4464           DFHEIV99,
  4465           DFHEIV99,
  4466           DFHEIV99
  4467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4468             MOVE SPACE          TO PI-UPDATE-SW
  4469                                    PI-KEYED-SWITCHES
  4470             MOVE ZEROS          TO PI-ISS-CNT-ENTERED
  4471             MOVE ZEROS          TO PI-CAN-CNT-ENTERED
  4472             MOVE ZEROS          TO EMI-ERROR
  4473             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4474             MOVE LOW-VALUES     TO EL930AO
  4475             MOVE QUESTION-MARKS TO BATCHI
  4476             MOVE AL-UANON       TO BATCHA
  4477             MOVE -1             TO MAINTL
  4478             GO TO 8100-SEND-INITIAL-MAP.
  4479
  4480
  4481     IF EIBAID = DFHPF3
  4482        IF BATCHL GREATER THAN ZEROS
  4483           MOVE AL-UNNON         TO BATCHA
  4484           GO TO 6000-BROWSE-BATCH-HEADERS
  4485        ELSE
  4486           GO TO 6000-BROWSE-BATCH-HEADERS.
  4487
  4488     IF EIBAID = DFHPF4
  4489         IF NOT PI-EL930-FIRST-TIME
  4490             MOVE XCTL-9302      TO PGM-NAME
  4491             GO TO 9300-XCTL
  4492         ELSE
  4493             PERFORM 0400-PRIME-BATCH-TOTALS THRU 0490-EXIT
  4494             IF EMI-ERROR = ZEROS
  4495                 MOVE 'N'        TO PI-EL930-FIRST-TIME-SW
  4496                 MOVE XCTL-9302  TO PGM-NAME
  4497                 GO TO 9300-XCTL
  4498             ELSE
  4499                 GO TO 8200-SEND-DATAONLY.
  4500
  4501     IF EIBAID = DFHPF2
  4502         MOVE  AL-UANON          TO  BATCHA
  4503         MOVE  BATCHI TO PI-SAV-ENTRY-BATCH
  4504         GO TO 3000-DELETE-ENTERED-BATCH.
  4505
  4506     IF  MAINTI = 'S'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL930.cbl
  4507         MOVE  MAINTI            TO  PI-MAINT-FUNC
  4508         PERFORM 0400-PRIME-BATCH-TOTALS  THRU  0490-EXIT
  4509             IF EMI-ERROR = ZEROS
  4510                 MOVE 'N'        TO PI-EL930-FIRST-TIME-SW
  4511                 GO TO 4000-SHOW-TOTALS
  4512             ELSE
  4513                 GO TO 8200-SEND-DATAONLY.
  4514
  4515     IF EIBAID = DFHENTER
  4516         GO TO 0330-EDIT-DATA.
  4517 0320-INPUT-ERROR.
  4518     MOVE ER-0029                TO EMI-ERROR.
  4519     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4520     MOVE AL-UNBON               TO PFENTERA.
  4521     IF PFENTERL = 0
  4522         MOVE -1                 TO MAINTL
  4523     ELSE
  4524         MOVE -1                 TO PFENTERL.
  4525     GO TO 8200-SEND-DATAONLY.
  4526
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL930.cbl
  4528 0330-EDIT-DATA.
  4529
  4530     IF MODIFY-CAP
  4531         NEXT SENTENCE
  4532       ELSE
  4533         IF MAINTI NOT = 'S'
  4534         MOVE 'UPDATE'       TO SM-READ
  4535         PERFORM 9995-SECURITY-VIOLATION
  4536         MOVE ER-0070        TO EMI-ERROR
  4537         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4538         GO TO 8100-SEND-INITIAL-MAP.
  4539
  4540     MOVE SPACE                  TO  PI-NB-MONTH-END-DT.
  4541
  4542     PERFORM 1250-READ-COMPANY-REC THRU 1250-EXIT.
  4543     IF MAINTI = 'N' OR 'C' OR 'B'
  4544         NEXT SENTENCE
  4545     ELSE
  4546         MOVE ER-0023            TO EMI-ERROR
  4547         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4548         MOVE -1                 TO MAINTL
  4549         MOVE AL-UABON           TO MAINTA
  4550         GO TO 8200-SEND-DATAONLY.
  4551
  4552     IF  NOT EMI-NO-ERRORS
  4553         GO TO 8200-SEND-DATAONLY.
  4554
  4555     MOVE MAINTI                 TO PI-MAINT-FUNC.
  4556     MOVE AL-UANON               TO MAINTA.
  4557
  4558     MOVE PI-COMPANY-CD          TO PI-SAV-COMP-CD.
  4559     MOVE ZEROS                  TO PI-SAV-BATCH-SEQ
  4560                                    PI-SAV-BATCH-CHG-SEQ.
  4561     MOVE SPACES                 TO PI-SAV-CERT-EFF-DT
  4562                                    PI-SAV-CERT-NO.
  4563
  4564
  4565     IF BATCHL = ZEROS
  4566         MOVE -1                 TO BATCHL
  4567         MOVE AL-UNBON           TO BATCHA
  4568         MOVE ER-2201            TO EMI-ERROR
  4569         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4570     ELSE
  4571         IF BATCHI = QUESTION-MARKS OR SPACES
  4572             IF MAINTI = 'N'
  4573                 PERFORM 1300-GET-BATCH-NO THRU 1300-EXIT
  4574             ELSE
  4575                 MOVE -1         TO BATCHL
  4576                 MOVE AL-UNBON   TO BATCHA
  4577                 MOVE ER-2201    TO EMI-ERROR
  4578                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4579         ELSE
  4580             IF BATCHI EQUAL PI-SAV-ENTRY-BATCH
  4581                 MOVE AL-UANON   TO BATCHA
  4582             ELSE
  4583                 MOVE BATCHI TO PI-SAV-ENTRY-BATCH
  4584                 IF MAINTI = 'C' OR 'B'
  4585                     MOVE AL-UANON TO BATCHA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL930.cbl
  4586                     MOVE ZEROS  TO ELFISSL  ELFCANL
  4587                                    EAHISSL  EAHCANL
  4588                                    EISSCNTL ECANCNTL
  4589                                    PI-LF-ISS-REMITTED
  4590                                    PI-LF-CAN-REMITTED
  4591                                    PI-AH-ISS-REMITTED
  4592                                    PI-AH-CAN-REMITTED
  4593                                    PI-ISS-CNT-REMITTED
  4594                                    PI-CAN-CNT-REMITTED.
  4595
  4596 0340-CHECK-TOTALS.
  4597
  4598*    ********************************************************
  4599*    *         THE FOLLOWING FIELDS ARE NOT REQUIRED        *
  4600*    *         IF ENTERED THE ONLY REQUIREMENT IS NUMERIC   *
  4601*    ********************************************************
  4602
  4603     IF ELFISSL GREATER THAN ZEROS
  4604         MOVE ELFISSI            TO WS-DEEDIT-FIELD
  4605         PERFORM 8600-DEEDIT THRU 8600-EXIT
  4606         MOVE WS-DEEDIT-FIELD    TO PI-LF-ISS-REMITTED
  4607         MOVE AL-UNNON           TO ELFISSA
  4608     ELSE
  4609         MOVE ZEROS              TO PI-LF-ISS-REMITTED.
  4610
  4611     IF ELFCANL GREATER THAN ZEROS
  4612         MOVE ELFCANI            TO WS-DEEDIT-FIELD
  4613         PERFORM 8600-DEEDIT THRU 8600-EXIT
  4614         MOVE WS-DEEDIT-FIELD    TO PI-LF-CAN-REMITTED
  4615         MOVE AL-UNNON           TO ELFCANA
  4616     ELSE
  4617         MOVE ZEROS              TO PI-LF-CAN-REMITTED.
  4618
  4619     IF EAHISSL GREATER THAN ZEROS
  4620         MOVE EAHISSI            TO WS-DEEDIT-FIELD
  4621         PERFORM 8600-DEEDIT THRU 8600-EXIT
  4622         MOVE WS-DEEDIT-FIELD    TO PI-AH-ISS-REMITTED
  4623         MOVE AL-UNNON           TO EAHISSA
  4624     ELSE
  4625         MOVE ZEROS              TO PI-AH-ISS-REMITTED.
  4626
  4627     IF EAHCANL GREATER THAN ZEROS
  4628         MOVE EAHCANI            TO WS-DEEDIT-FIELD
  4629         PERFORM 8600-DEEDIT THRU 8600-EXIT
  4630         MOVE WS-DEEDIT-FIELD    TO PI-AH-CAN-REMITTED
  4631         MOVE AL-UNNON           TO EAHCANA
  4632     ELSE
  4633         MOVE ZEROS              TO PI-AH-CAN-REMITTED.
  4634
  4635     IF EISSCNTL GREATER THAN ZEROS
  4636         MOVE AL-UNNON           TO EISSCNTA
  4637
  4638* EXEC CICS BIF DEEDIT
  4639*            FIELD(EISSCNTI)
  4640*            LENGTH(06)
  4641*            END-EXEC
  4642     MOVE 06
  4643       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL930.cbl
  4644*    MOVE '@"L                   #   #00004536' TO DFHEIV0
  4645     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4646     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4647     MOVE X'2020233030303034353336' TO DFHEIV0(25:11)
  4648     CALL 'kxdfhei1' USING DFHEIV0,
  4649           EISSCNTI,
  4650           DFHEIV11
  4651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4652         MOVE EISSCNTI           TO PI-ISS-CNT-REMITTED
  4653     ELSE
  4654         MOVE ZEROS              TO PI-ISS-CNT-REMITTED.
  4655
  4656     IF ECANCNTL GREATER THAN ZEROS
  4657         MOVE AL-UNNON           TO ECANCNTA
  4658
  4659* EXEC CICS BIF DEEDIT
  4660*            FIELD(ECANCNTI)
  4661*            LENGTH(06)
  4662*            END-EXEC
  4663     MOVE 06
  4664       TO DFHEIV11
  4665*    MOVE '@"L                   #   #00004546' TO DFHEIV0
  4666     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4667     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4668     MOVE X'2020233030303034353436' TO DFHEIV0(25:11)
  4669     CALL 'kxdfhei1' USING DFHEIV0,
  4670           ECANCNTI,
  4671           DFHEIV11
  4672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4673         MOVE ECANCNTI           TO PI-CAN-CNT-REMITTED
  4674     ELSE
  4675         MOVE ZEROS              TO PI-CAN-CNT-REMITTED.
  4676
  4677******************************************************************
  4678*                                                                *
  4679*               EDIT FOR NEW MONTH-END-DATE                      *
  4680*                        04/13/84                                *
  4681*                                                                *
  4682******************************************************************
  4683
  4684     IF MNTHNDTL GREATER THAN ZEROS NEXT SENTENCE
  4685       ELSE
  4686        GO TO 0340-ERROR-CHECK.
  4687
  4688     MOVE MNTHNDTI               TO WS-DT-DEEDIT-FIELD.
  4689     PERFORM 8600-DEEDIT THRU 8600-EXIT.
  4690     MOVE WS-DT-DEEDIT-FIELD     TO DC-GREG-DATE-1-MDY.
  4691     MOVE '4' TO DC-OPTION-CODE.
  4692     MOVE LINK-CLDATCV TO PGM-NAME.
  4693
  4694* EXEC CICS LINK
  4695*         PROGRAM(PGM-NAME)
  4696*         COMMAREA(DATE-CONVERSION-DATA)
  4697*         LENGTH(DC-COMM-LENGTH)
  4698*         END-EXEC.
  4699*    MOVE '."C                   ''   #00004570' TO DFHEIV0
  4700     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4701     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL930.cbl
  4702     MOVE X'2020233030303034353730' TO DFHEIV0(25:11)
  4703     CALL 'kxdfhei1' USING DFHEIV0,
  4704           PGM-NAME,
  4705           DATE-CONVERSION-DATA,
  4706           DC-COMM-LENGTH,
  4707           DFHEIV99,
  4708           DFHEIV99,
  4709           DFHEIV99
  4710     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4711
  4712     IF DATE-CONVERSION-ERROR
  4713        GO TO 0340-DAY-ERROR.
  4714     MOVE DC-GREG-DATE-1-EDIT    TO MNTHNDTO.
  4715     MOVE DC-BIN-DATE-1          TO PI-NB-MONTH-END-DT.
  4716     MOVE DC-GREG-DATE-1-MDY     TO DATE-TEST-AREA.
  4717     IF DATE-TEST-MM = 4 OR 6 OR 9 OR 11
  4718        IF DATE-TEST-DD  NOT = 30
  4719           GO TO 0340-DAY-ERROR
  4720        ELSE
  4721           GO TO 0340-ERROR-CHECK.
  4722
  4723     IF DATE-TEST-MM = 1 OR 3 OR 5 OR 7 OR 8 OR 10 OR 12
  4724        IF DATE-TEST-DD  NOT = 31
  4725           GO TO 0340-DAY-ERROR
  4726        ELSE
  4727           GO TO 0340-ERROR-CHECK.
  4728     DIVIDE DATE-TEST-YY  BY 4 GIVING DIVIDE-RESULT
  4729                               REMAINDER DIVIDE-REMAINDER
  4730     IF (DATE-TEST-YY = 0) OR (DIVIDE-REMAINDER NOT = 0)
  4731        IF DATE-TEST-DD  NOT = 28
  4732           GO TO 0340-DAY-ERROR
  4733
  4734        ELSE
  4735           GO TO 0340-ERROR-CHECK
  4736     ELSE
  4737        IF DATE-TEST-DD = 29
  4738           GO TO 0340-ERROR-CHECK.
  4739
  4740 0340-DAY-ERROR.
  4741     MOVE -1 TO MNTHNDTL.
  4742     MOVE AL-UABON TO MNTHNDTA.
  4743     MOVE ER-0340 TO EMI-ERROR.
  4744     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4745
  4746
  4747 0340-ERROR-CHECK.
  4748     IF NOT EMI-NO-ERRORS
  4749         GO TO 8200-SEND-DATAONLY.
  4750     IF PI-DELETE-IS-OK
  4751         MOVE SPACE              TO PI-VERIFY-DELETE-SW.
  4752     IF MAINTI = 'N'
  4753       AND PI-DATA-UPDATED
  4754         MOVE 'C'                TO PI-MAINT-FUNC
  4755         GO TO 0360-XCTL-EL9301.
  4756
  4757
  4758* EXEC CICS HANDLE CONDITION
  4759*              NOTFND  (0350-NO-RECORDS)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL930.cbl
  4760*              ENDFILE (0350-NO-RECORDS)
  4761*              NOTOPEN (7000-PNDT-FILE-NOTOPEN)
  4762*              END-EXEC.
  4763*    MOVE '"$I''J                 ! # #00004620' TO DFHEIV0
  4764     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  4765     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4766     MOVE X'2320233030303034363230' TO DFHEIV0(25:11)
  4767     CALL 'kxdfhei1' USING DFHEIV0
  4768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4769
  4770
  4771* EXEC CICS READ
  4772*        SET (ERPNDT-POINTER)
  4773*        DATASET (ERPNDT-FILE-ID)
  4774*        RIDFLD (PI-SAV-ENDING-ERPNDT-KEY)
  4775*        GTEQ
  4776*        END-EXEC.
  4777*    MOVE '&"S        G          (   #00004625' TO DFHEIV0
  4778     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  4779     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4780     MOVE X'2020233030303034363235' TO DFHEIV0(25:11)
  4781     CALL 'kxdfhei1' USING DFHEIV0,
  4782           ERPNDT-FILE-ID,
  4783           ERPNDT-POINTER,
  4784           DFHEIV99,
  4785           PI-SAV-ENDING-ERPNDT-KEY,
  4786           DFHEIV99,
  4787           DFHEIV99,
  4788           DFHEIV99
  4789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4790
  4791     SERVICE RELOAD PENDING-BUSINESS.
  4792     IF PI-SAV-COMP-CD = PB-COMPANY-CD
  4793       AND PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  4794         IF MAINTI = 'N'
  4795             MOVE ER-2229        TO EMI-ERROR
  4796             MOVE -1             TO MAINTL
  4797             MOVE AL-UABON       TO MAINTA
  4798             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4799             GO TO 8200-SEND-DATAONLY
  4800         ELSE
  4801             NEXT SENTENCE
  4802     ELSE
  4803         GO TO 0350-NO-RECORDS.
  4804
  4805
  4806     IF PB-BILLED-DT NOT = LOW-VALUES
  4807         MOVE ER-2402            TO EMI-ERROR
  4808         MOVE -1                 TO BATCHL
  4809         MOVE AL-UABON           TO BATCHA
  4810         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4811         GO TO 8200-SEND-DATAONLY.
  4812
  4813     IF PI-SAV-COMP-CD = PB-COMPANY-CD
  4814       AND PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  4815       AND MAINTI NOT = 'N'
  4816         MOVE PB-CARRIER         TO PI-SAV-CARRIER
  4817         MOVE PB-GROUPING        TO PI-SAV-GROUPING
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL930.cbl
  4818         MOVE PB-STATE           TO PI-SAV-STATE
  4819         MOVE PB-ACCOUNT         TO PI-SAV-ACCOUNT
  4820         PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  4821         MOVE 'EL930B  '         TO PI-MAP-NAME.
  4822         GO TO 0360-XCTL-EL9301.
  4823
  4824 0350-NO-RECORDS.
  4825     IF MAINTI = 'N'
  4826         MOVE SPACE              TO PI-ISSUE-ADDED-SW
  4827         MOVE ZEROS              TO PI-LF-ISS-ENTERED
  4828                                    PI-LF-CAN-ENTERED
  4829                                    PI-AH-ISS-ENTERED
  4830                                    PI-AH-CAN-ENTERED
  4831                                    PI-ISS-CNT-ENTERED
  4832                                    PI-CAN-CNT-ENTERED
  4833         PERFORM 2000-WRITE-BATCH-TOTAL-REC THRU 2990-EXIT
  4834         IF PI-LF-ISS-REMITTED = ZEROS
  4835           AND PI-AH-ISS-REMITTED = ZEROS
  4836           AND PI-LF-CAN-REMITTED = ZEROS
  4837           AND PI-AH-CAN-REMITTED = ZEROS
  4838           AND PI-ISS-CNT-REMITTED = ZEROS
  4839           AND PI-CAN-CNT-REMITTED = ZEROS
  4840             MOVE 'EL930B  '     TO PI-MAP-NAME
  4841             GO TO 0360-XCTL-EL9301
  4842         ELSE
  4843             IF PI-LF-ISS-REMITTED = ZEROS
  4844               AND PI-AH-ISS-REMITTED = ZEROS
  4845               AND PI-ISS-CNT-REMITTED = ZEROS
  4846                 MOVE 'EL930C  '     TO PI-MAP-NAME
  4847                 GO TO 0360-XCTL-EL9301
  4848             ELSE
  4849                 MOVE 'EL930B  '     TO PI-MAP-NAME
  4850                 GO TO 0360-XCTL-EL9301
  4851     ELSE
  4852         MOVE ER-2212            TO EMI-ERROR
  4853         MOVE -1                 TO BATCHL
  4854         MOVE AL-UABON           TO BATCHA
  4855         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4856         GO TO 8200-SEND-DATAONLY.
  4857
  4858 0360-XCTL-EL9301.
  4859     IF PI-MAINT-FUNC = 'N'
  4860         MOVE SPACES             TO PI-KEYED-SWITCHES.
  4861
  4862     MOVE XCTL-9301           TO PGM-NAME.
  4863
  4864     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL930.cbl
  4866 0400-PRIME-BATCH-TOTALS.
  4867
  4868* EXEC CICS HANDLE CONDITION
  4869*        NOTFND (0480-NO-BATCH-TRAILER)
  4870*        END-EXEC.
  4871*    MOVE '"$I                   ! $ #00004707' TO DFHEIV0
  4872     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4873     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4874     MOVE X'2420233030303034373037' TO DFHEIV0(25:11)
  4875     CALL 'kxdfhei1' USING DFHEIV0
  4876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4877
  4878     MOVE PI-COMPANY-CD          TO PNDT-COMP-CD.
  4879     MOVE 9999                   TO PNDT-BATCH-SEQ.
  4880     MOVE BATCHI                 TO PNDT-ENTRY-BATCH.
  4881
  4882
  4883* EXEC CICS READ
  4884*        DATASET (ERPNDT-FILE-ID)
  4885*        SET (ERPNDT-POINTER)
  4886*        RIDFLD (ERPNDT-KEY)
  4887*        END-EXEC.
  4888*    MOVE '&"S        E          (   #00004714' TO DFHEIV0
  4889     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4890     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4891     MOVE X'2020233030303034373134' TO DFHEIV0(25:11)
  4892     CALL 'kxdfhei1' USING DFHEIV0,
  4893           ERPNDT-FILE-ID,
  4894           ERPNDT-POINTER,
  4895           DFHEIV99,
  4896           ERPNDT-KEY,
  4897           DFHEIV99,
  4898           DFHEIV99,
  4899           DFHEIV99
  4900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4901
  4902     SERVICE RELOAD PENDING-BUSINESS.
  4903
  4904     IF PB-BILLED-DT NOT = LOW-VALUES
  4905         MOVE ER-2402            TO EMI-ERROR
  4906         MOVE -1                 TO BATCHL
  4907         MOVE AL-UABON           TO BATCHA
  4908         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4909         GO TO 0490-EXIT.
  4910
  4911     MOVE PI-COMPANY-CD          TO PI-SAV-COMP-CD.
  4912     MOVE PB-ENTRY-BATCH           TO PI-SAV-ENTRY-BATCH.
  4913     MOVE PB-CARRIER               TO PI-SAV-CARRIER.
  4914     MOVE PB-GROUPING              TO PI-SAV-GROUPING.
  4915     MOVE PB-STATE                 TO PI-SAV-STATE.
  4916     MOVE PB-ACCOUNT               TO PI-SAV-ACCOUNT.
  4917     MOVE PB-B-LF-ISS-PRM-REMITTED TO PI-LF-ISS-REMITTED.
  4918     MOVE PB-B-LF-ISS-PRM-ENTERED  TO PI-LF-ISS-ENTERED.
  4919     MOVE PB-B-AH-ISS-PRM-REMITTED TO PI-AH-ISS-REMITTED.
  4920     MOVE PB-B-AH-ISS-PRM-ENTERED  TO PI-AH-ISS-ENTERED.
  4921     MOVE PB-B-LF-CAN-PRM-REMITTED TO PI-LF-CAN-REMITTED.
  4922     MOVE PB-B-LF-CAN-PRM-ENTERED  TO PI-LF-CAN-ENTERED.
  4923     MOVE PB-B-AH-CAN-PRM-REMITTED TO PI-AH-CAN-REMITTED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL930.cbl
  4924     MOVE PB-B-AH-CAN-PRM-ENTERED  TO PI-AH-CAN-ENTERED.
  4925     MOVE PB-B-ISSUE-CNT-REMITTED  TO PI-ISS-CNT-REMITTED.
  4926     MOVE PB-B-ISSUE-CNT-ENTERED   TO PI-ISS-CNT-ENTERED.
  4927     MOVE PB-B-CANCEL-CNT-REMITTED TO PI-CAN-CNT-REMITTED.
  4928     MOVE PB-B-CANCEL-CNT-ENTERED  TO PI-CAN-CNT-ENTERED.
  4929
  4930******************************************************************
  4931*                                                                *
  4932*    IF THE MONTH-END-DATE IN THE TRAILER RECORD (BATCH HEADER)  *
  4933*       IS NOT EQUAL TO THE ACCOUNTS MONTH-END-DATE PRIME THE    *
  4934*       TRAILER'S MONTH-END-DATE.                                *
  4935*                                                                *
  4936******************************************************************
  4937
  4938     MOVE SPACE                    TO PI-NB-MONTH-END-DT.
  4939     IF  PB-CREDIT-SELECT-DT = PI-CR-MONTH-END-DT
  4940         NEXT SENTENCE
  4941       ELSE
  4942         MOVE PB-CREDIT-SELECT-DT  TO  PI-NB-MONTH-END-DT.
  4943
  4944     GO TO 0490-EXIT.
  4945
  4946 0480-NO-BATCH-TRAILER.
  4947     MOVE ER-2212                TO EMI-ERROR.
  4948     MOVE -1                     TO BATCHL.
  4949     MOVE AL-UABON               TO BATCHA.
  4950     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4951
  4952 0490-EXIT.
  4953     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL930.cbl
  4956 1250-READ-COMPANY-REC.
  4957     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID.
  4958     MOVE '1'                    TO CNTL-REC-TYPE.
  4959     MOVE SPACES                 TO CNTL-ACCESS.
  4960     MOVE +0                     TO CNTL-SEQ.
  4961
  4962
  4963* EXEC CICS HANDLE CONDITION
  4964*        NOTFND   (1250-NO-COMPANY-REC)
  4965*        NOTOPEN  (7100-CNTL-FILE-NOTOPEN)
  4966*        END-EXEC.
  4967*    MOVE '"$IJ                  ! % #00004779' TO DFHEIV0
  4968     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  4969     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4970     MOVE X'2520233030303034373739' TO DFHEIV0(25:11)
  4971     CALL 'kxdfhei1' USING DFHEIV0
  4972     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4973
  4974
  4975
  4976* EXEC CICS READ
  4977*        DATASET   (ELCNTL-FILE-ID)
  4978*        SET       (ELCNTL-POINTER)
  4979*        RIDFLD    (ELCNTL-KEY)
  4980*        END-EXEC.
  4981*    MOVE '&"S        E          (   #00004784' TO DFHEIV0
  4982     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4983     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4984     MOVE X'2020233030303034373834' TO DFHEIV0(25:11)
  4985     CALL 'kxdfhei1' USING DFHEIV0,
  4986           ELCNTL-FILE-ID,
  4987           ELCNTL-POINTER,
  4988           DFHEIV99,
  4989           ELCNTL-KEY,
  4990           DFHEIV99,
  4991           DFHEIV99,
  4992           DFHEIV99
  4993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4994
  4995     SERVICE RELOAD CONTROL-FILE.
  4996     MOVE CF-CREDIT-EDIT-CONTROLS TO PI-CREDIT-EDIT-CONTROLS.
  4997     GO TO 1250-EXIT.
  4998 1250-NO-COMPANY-REC.
  4999     MOVE ER-2248                TO EMI-ERROR.
  5000     MOVE -1                     TO BATCHL.
  5001     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5002     GO TO 8200-SEND-DATAONLY.
  5003 1250-EXIT.
  5004     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL930.cbl
  5006 1300-GET-BATCH-NO.
  5007
  5008* EXEC CICS HANDLE CONDITION
  5009*        NOTFND   (1300-NO-COMPANY-REC)
  5010*        NOTOPEN  (7100-CNTL-FILE-NOTOPEN)
  5011*        END-EXEC.
  5012*    MOVE '"$IJ                  ! & #00004801' TO DFHEIV0
  5013     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  5014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5015     MOVE X'2620233030303034383031' TO DFHEIV0(25:11)
  5016     CALL 'kxdfhei1' USING DFHEIV0
  5017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5018
  5019
  5020
  5021* EXEC CICS READ
  5022*        DATASET   (ELCNTL-FILE-ID)
  5023*        SET       (ELCNTL-POINTER)
  5024*        RIDFLD    (ELCNTL-KEY)
  5025*        UPDATE
  5026*        END-EXEC.
  5027*    MOVE '&"S        EU         (   #00004806' TO DFHEIV0
  5028     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5029     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5030     MOVE X'2020233030303034383036' TO DFHEIV0(25:11)
  5031     CALL 'kxdfhei1' USING DFHEIV0,
  5032           ELCNTL-FILE-ID,
  5033           ELCNTL-POINTER,
  5034           DFHEIV99,
  5035           ELCNTL-KEY,
  5036           DFHEIV99,
  5037           DFHEIV99,
  5038           DFHEIV99
  5039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5040
  5041     SERVICE RELOAD CONTROL-FILE.
  5042
  5043     MOVE 'B'                    TO  JP-RECORD-TYPE.
  5044     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  5045
  5046     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  5047             WS-ELCNTL-RECORD-LENGTH  +  23.
  5048
  5049     PERFORM 8400-LOG-JOURNAL-RECORD.
  5050
  5051 1300-ASSIGN-NUMBER-LOOP.
  5052     IF CF-LAST-BATCH-RESET
  5053         MOVE ZEROS              TO CF-LAST-BATCH-NO
  5054         ADD +1                  TO CF-LAST-BATCH-NO
  5055     ELSE
  5056         ADD +1                  TO CF-LAST-BATCH-NO.
  5057     MOVE CF-LAST-BATCH-NO       TO WS-BATCH-NO.
  5058     MOVE WS-BATCH-NO            TO PI-SAV-ENTRY-BATCH.
  5059
  5060* EXEC CICS HANDLE CONDITION
  5061*        NOTFND  (1300-REWRITE-COMPANY-REC)
  5062*        NOTOPEN (7000-PNDT-FILE-NOTOPEN)
  5063*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL930.cbl
  5064*    MOVE '"$IJ                  ! '' #00004830' TO DFHEIV0
  5065     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  5066     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5067     MOVE X'2720233030303034383330' TO DFHEIV0(25:11)
  5068     CALL 'kxdfhei1' USING DFHEIV0
  5069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5070
  5071
  5072* EXEC CICS READ
  5073*        SET (ERPNDT-POINTER)
  5074*        DATASET (ERPNDT-FILE-ID)
  5075*        RIDFLD (PI-SAV-ENDING-ERPNDT-KEY)
  5076*        GTEQ
  5077*        END-EXEC.
  5078*    MOVE '&"S        G          (   #00004834' TO DFHEIV0
  5079     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  5080     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5081     MOVE X'2020233030303034383334' TO DFHEIV0(25:11)
  5082     CALL 'kxdfhei1' USING DFHEIV0,
  5083           ERPNDT-FILE-ID,
  5084           ERPNDT-POINTER,
  5085           DFHEIV99,
  5086           PI-SAV-ENDING-ERPNDT-KEY,
  5087           DFHEIV99,
  5088           DFHEIV99,
  5089           DFHEIV99
  5090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5091
  5092     SERVICE RELOAD PENDING-BUSINESS.
  5093     IF PI-SAV-COMP-CD NOT = PB-COMPANY-CD
  5094         GO TO 1300-REWRITE-COMPANY-REC.
  5095     IF PI-SAV-ENTRY-BATCH = PB-ENTRY-BATCH
  5096         GO TO 1300-ASSIGN-NUMBER-LOOP.
  5097 1300-REWRITE-COMPANY-REC.
  5098     MOVE WS-BATCH-NO            TO BATCHI.
  5099     MOVE AL-UANON               TO BATCHA.
  5100
  5101     MOVE 'C'                    TO  JP-RECORD-TYPE.
  5102     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  5103
  5104     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  5105             WS-ELCNTL-RECORD-LENGTH  +  23.
  5106
  5107
  5108* EXEC CICS REWRITE
  5109*        DATASET (ELCNTL-FILE-ID)
  5110*        FROM (CONTROL-FILE)
  5111*        END-EXEC.
  5112     MOVE LENGTH OF
  5113      CONTROL-FILE
  5114       TO DFHEIV11
  5115*    MOVE '&& L                  %   #00004855' TO DFHEIV0
  5116     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5117     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5118     MOVE X'2020233030303034383535' TO DFHEIV0(25:11)
  5119     CALL 'kxdfhei1' USING DFHEIV0,
  5120           ELCNTL-FILE-ID,
  5121           CONTROL-FILE,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL930.cbl
  5122           DFHEIV11,
  5123           DFHEIV99
  5124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5125
  5126
  5127     PERFORM 8400-LOG-JOURNAL-RECORD.
  5128
  5129     GO TO 1300-EXIT.
  5130
  5131 1300-NO-COMPANY-REC.
  5132     MOVE ER-2248                TO EMI-ERROR.
  5133     MOVE -1                     TO BATCHL.
  5134     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5135     GO TO 8200-SEND-DATAONLY.
  5136 1300-EXIT.
  5137     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL930.cbl
  5139 2000-WRITE-BATCH-TOTAL-REC.
  5140     MOVE PI-COMPANY-CD          TO PNDT-COMP-CD.
  5141     MOVE PI-SAV-ENTRY-BATCH     TO PNDT-ENTRY-BATCH.
  5142     MOVE 9999                   TO PNDT-BATCH-SEQ.
  5143
  5144
  5145* EXEC CICS HANDLE CONDITION
  5146*        NOTFND (2100-ADD-BATCH-TOTAL-REC)
  5147*        NOTOPEN (7000-PNDT-FILE-NOTOPEN)
  5148*        END-EXEC.
  5149*    MOVE '"$IJ                  ! ( #00004877' TO DFHEIV0
  5150     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  5151     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5152     MOVE X'2820233030303034383737' TO DFHEIV0(25:11)
  5153     CALL 'kxdfhei1' USING DFHEIV0
  5154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5155
  5156
  5157
  5158* EXEC CICS READ
  5159*        SET(ERPNDT-POINTER)
  5160*        DATASET(ERPNDT-FILE-ID)
  5161*        RIDFLD(ERPNDT-KEY)
  5162*        UPDATE
  5163*        END-EXEC.
  5164*    MOVE '&"S        EU         (   #00004882' TO DFHEIV0
  5165     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5166     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5167     MOVE X'2020233030303034383832' TO DFHEIV0(25:11)
  5168     CALL 'kxdfhei1' USING DFHEIV0,
  5169           ERPNDT-FILE-ID,
  5170           ERPNDT-POINTER,
  5171           DFHEIV99,
  5172           ERPNDT-KEY,
  5173           DFHEIV99,
  5174           DFHEIV99,
  5175           DFHEIV99
  5176     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5177
  5178     SERVICE RELOAD PENDING-BUSINESS.
  5179
  5180******************************************************************
  5181*                                                                *
  5182*    IF THE MONTH-END-DATE IN THE TRAILER RECORD (BATCH HEADER)  *
  5183*       IS NOT EQUAL TO THE ACCOUNTS MONTH-END-DATE AND THE      *
  5184*       OPERATOR HAS NOT ENTERED A NEW MONTH-END-DATE USE THE    *
  5185*       MONTH-END-DATE IN TRAILER RECORD FOR ALL DETAIL RECORDS. *
  5186*                                                                *
  5187******************************************************************
  5188
  5189     IF  PI-NB-MONTH-END-DT = SPACES
  5190         IF  PB-CREDIT-SELECT-DT = PI-CR-MONTH-END-DT
  5191             NEXT SENTENCE
  5192         ELSE
  5193             MOVE PB-CREDIT-SELECT-DT  TO  PI-NB-MONTH-END-DT.
  5194
  5195     MOVE 'B'                    TO JP-RECORD-TYPE.
  5196     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL930.cbl
  5197
  5198     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  5199             WS-ERPNDT-RECORD-LENGTH  +  23.
  5200
  5201     PERFORM 8400-LOG-JOURNAL-RECORD.
  5202
  5203     IF ELFISSL NOT = ZEROS
  5204         MOVE PI-LF-ISS-REMITTED  TO PB-B-LF-ISS-PRM-REMITTED.
  5205     IF EAHISSL NOT = ZEROS
  5206         MOVE PI-AH-ISS-REMITTED  TO PB-B-AH-ISS-PRM-REMITTED.
  5207     IF EISSCNTL NOT = ZEROS
  5208         MOVE PI-ISS-CNT-REMITTED TO PB-B-ISSUE-CNT-REMITTED.
  5209     IF ECANCNTL NOT = ZEROS
  5210         MOVE PI-CAN-CNT-REMITTED TO PB-B-CANCEL-CNT-REMITTED.
  5211     IF ELFCANL NOT = ZEROS
  5212         MOVE PI-LF-CAN-REMITTED  TO PB-B-LF-CAN-PRM-REMITTED.
  5213     IF EAHCANL NOT = ZEROS
  5214         MOVE PI-AH-CAN-REMITTED  TO PB-B-AH-CAN-PRM-REMITTED.
  5215     IF WS-PF1
  5216         MOVE PI-LF-ISS-ENTERED   TO PB-B-LF-ISS-PRM-ENTERED
  5217         MOVE PI-AH-ISS-ENTERED   TO PB-B-AH-ISS-PRM-ENTERED
  5218         MOVE PI-ISS-CNT-ENTERED  TO PB-B-ISSUE-CNT-ENTERED
  5219         MOVE PI-CAN-CNT-ENTERED  TO PB-B-CANCEL-CNT-ENTERED
  5220         MOVE PI-LF-CAN-ENTERED   TO PB-B-LF-CAN-PRM-ENTERED
  5221         MOVE PI-AH-CAN-ENTERED   TO PB-B-AH-CAN-PRM-ENTERED
  5222         MOVE PI-LAST-SEQ-NO-ADDED TO PB-B-HIGHEST-SEQ-NO.
  5223
  5224     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  5225     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  5226     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
  5227     MOVE 'C'                    TO JP-RECORD-TYPE.
  5228     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  5229
  5230     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  5231             WS-ERPNDT-RECORD-LENGTH  +  23.
  5232
  5233
  5234* EXEC CICS REWRITE
  5235*        DATASET(ERPNDT-FILE-ID)
  5236*        FROM(PENDING-BUSINESS)
  5237*        END-EXEC.
  5238     MOVE LENGTH OF
  5239      PENDING-BUSINESS
  5240       TO DFHEIV11
  5241*    MOVE '&& L                  %   #00004943' TO DFHEIV0
  5242     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5243     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5244     MOVE X'2020233030303034393433' TO DFHEIV0(25:11)
  5245     CALL 'kxdfhei1' USING DFHEIV0,
  5246           ERPNDT-FILE-ID,
  5247           PENDING-BUSINESS,
  5248           DFHEIV11,
  5249           DFHEIV99
  5250     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5251
  5252     PERFORM 8400-LOG-JOURNAL-RECORD.
  5253
  5254     IF  PI-NB-MONTH-END-DT = PB-CREDIT-SELECT-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL930.cbl
  5255         GO TO 2990-EXIT.
  5256
  5257     IF PI-NB-MONTH-END-DT GREATER THAN SPACES
  5258        PERFORM 5000-UPDATE-ENTIRE-BATCH THRU
  5259                5900-EXIT.
  5260
  5261     GO TO 2990-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL930.cbl
  5263 2100-ADD-BATCH-TOTAL-REC.
  5264
  5265* EXEC CICS GETMAIN
  5266*        SET(ERPNDT-POINTER)
  5267*        LENGTH(585)
  5268*        INITIMG(GETMAIN-SPACE)
  5269*        END-EXEC.
  5270     MOVE 585
  5271       TO DFHEIV11
  5272*    MOVE ',"IL                  $   #00004959' TO DFHEIV0
  5273     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  5274     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5275     MOVE X'2020233030303034393539' TO DFHEIV0(25:11)
  5276     CALL 'kxdfhei1' USING DFHEIV0,
  5277           ERPNDT-POINTER,
  5278           DFHEIV11,
  5279           GETMAIN-SPACE
  5280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5281
  5282     SERVICE RELOAD PENDING-BUSINESS.
  5283     MOVE 'PB'                   TO PB-RECORD-ID.
  5284
  5285     MOVE HIGH-VALUES            TO PB-CONTROL-BY-ACCOUNT.
  5286
  5287     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD
  5288                                    PB-COMPANY-CD-A1.
  5289     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
  5290     MOVE PI-SAV-ENTRY-BATCH     TO PB-ENTRY-BATCH
  5291                                    PB-CERT-NO.
  5292     MOVE 9999                   TO PB-BATCH-SEQ-NO.
  5293     MOVE HIGH-VALUES            TO PB-CERT-EFF-DT.
  5294     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
  5295                                    PB-ALT-CHG-SEQ-NO.
  5296
  5297     MOVE '9'                    TO PB-RECORD-TYPE.
  5298     MOVE PI-LF-ISS-REMITTED     TO PB-B-LF-ISS-PRM-REMITTED.
  5299     MOVE PI-LF-ISS-ENTERED      TO PB-B-LF-ISS-PRM-ENTERED.
  5300     MOVE PI-AH-ISS-REMITTED     TO PB-B-AH-ISS-PRM-REMITTED.
  5301     MOVE PI-AH-ISS-ENTERED      TO PB-B-AH-ISS-PRM-ENTERED.
  5302     MOVE PI-ISS-CNT-REMITTED    TO PB-B-ISSUE-CNT-REMITTED.
  5303     MOVE PI-ISS-CNT-ENTERED     TO PB-B-ISSUE-CNT-ENTERED.
  5304     MOVE PI-CAN-CNT-REMITTED    TO PB-B-CANCEL-CNT-REMITTED.
  5305     MOVE PI-CAN-CNT-ENTERED     TO PB-B-CANCEL-CNT-ENTERED.
  5306     MOVE PI-LF-CAN-REMITTED     TO PB-B-LF-CAN-PRM-REMITTED.
  5307     MOVE PI-LF-CAN-ENTERED      TO PB-B-LF-CAN-PRM-ENTERED.
  5308     MOVE PI-AH-CAN-REMITTED     TO PB-B-AH-CAN-PRM-REMITTED.
  5309     MOVE PI-AH-CAN-ENTERED      TO PB-B-AH-CAN-PRM-ENTERED.
  5310     MOVE ZEROS                  TO PB-B-LF-ISS-PRM-COMPUTED
  5311                                    PB-B-LF-CAN-PRM-COMPUTED
  5312                                    PB-B-AH-ISS-PRM-COMPUTED
  5313                                    PB-B-AH-CAN-PRM-COMPUTED
  5314                                    PB-LF-BILLED-AMTS
  5315                                    PB-AH-BILLED-AMTS
  5316                                    PB-CHG-COUNT
  5317                                    PB-CALC-TOLERANCE.
  5318     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
  5319                                    PB-BILLED-DT
  5320                                    PB-ACCT-EFF-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL930.cbl
  5321                                    PB-ACCT-EXP-DT.
  5322     IF  PI-NB-MONTH-END-DT GREATER THAN SPACES
  5323         MOVE PI-NB-MONTH-END-DT TO PB-CREDIT-SELECT-DT
  5324        ELSE
  5325         MOVE PI-CR-MONTH-END-DT     TO PB-CREDIT-SELECT-DT.
  5326     MOVE PI-LAST-SEQ-NO-ADDED   TO PB-B-HIGHEST-SEQ-NO.
  5327
  5328     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
  5329                                    PB-INPUT-BY.
  5330     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  5331     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
  5332                                    PB-INPUT-DT.
  5333     MOVE 'A'                    TO JP-RECORD-TYPE.
  5334     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  5335
  5336
  5337     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  5338             WS-ERPNDT-RECORD-LENGTH  +  23.
  5339
  5340     MOVE PI-AM-NAME             TO  PB-ACCOUNT-NAME.
  5341     MOVE PB-CONTROL-PRIMARY     TO  ERPNDT-KEY.
  5342
  5343
  5344* EXEC CICS WRITE
  5345*        DATASET(ERPNDT-FILE-ID)
  5346*        FROM(PENDING-BUSINESS)
  5347*        RIDFLD(PB-CONTROL-PRIMARY)
  5348*        END-EXEC.
  5349     MOVE LENGTH OF
  5350      PENDING-BUSINESS
  5351       TO DFHEIV11
  5352*    MOVE '&$ L                  ''   #00005025' TO DFHEIV0
  5353     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5354     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5355     MOVE X'2020233030303035303235' TO DFHEIV0(25:11)
  5356     CALL 'kxdfhei1' USING DFHEIV0,
  5357           ERPNDT-FILE-ID,
  5358           PENDING-BUSINESS,
  5359           DFHEIV11,
  5360           PB-CONTROL-PRIMARY,
  5361           DFHEIV99,
  5362           DFHEIV99
  5363     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5364
  5365     PERFORM 8400-LOG-JOURNAL-RECORD.
  5366
  5367 2990-EXIT.
  5368     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL930.cbl
  5370 3000-DELETE-ENTERED-BATCH.
  5371
  5372     MOVE SPACE          TO PI-NB-MONTH-END-DT.
  5373
  5374     IF NOT PI-DELETE-IS-OK
  5375         MOVE 'Y'                TO PI-VERIFY-DELETE-SW
  5376         GO TO 3300-FIRST-PF2.
  5377     MOVE SPACE                  TO PI-VERIFY-DELETE-SW.
  5378     MOVE PI-COMPANY-CD          TO PNDT-COMP-CD.
  5379     MOVE PI-SAV-ENTRY-BATCH     TO PNDT-ENTRY-BATCH.
  5380     MOVE 1                      TO PNDT-BATCH-SEQ.
  5381
  5382
  5383* EXEC CICS SYNCPOINT
  5384*         END-EXEC.
  5385*    MOVE '6"                    !   #00005047' TO DFHEIV0
  5386     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  5387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5388     MOVE X'2020233030303035303437' TO DFHEIV0(25:11)
  5389     CALL 'kxdfhei1' USING DFHEIV0
  5390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5391
  5392
  5393
  5394* EXEC CICS HANDLE CONDITION
  5395*        NOTFND(3200-NO-RECORDS)
  5396*        NOTOPEN(7000-PNDT-FILE-NOTOPEN)
  5397*        END-EXEC.
  5398*    MOVE '"$IJ                  ! ) #00005050' TO DFHEIV0
  5399     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  5400     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5401     MOVE X'2920233030303035303530' TO DFHEIV0(25:11)
  5402     CALL 'kxdfhei1' USING DFHEIV0
  5403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5404
  5405
  5406
  5407
  5408* EXEC CICS STARTBR
  5409*        DATASET(ERPNDT-FILE-ID)
  5410*        RIDFLD(ERPNDT-KEY)
  5411*        END-EXEC.
  5412     MOVE 0
  5413       TO DFHEIV11
  5414*    MOVE '&,         G          &   #00005056' TO DFHEIV0
  5415     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5416     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5417     MOVE X'2020233030303035303536' TO DFHEIV0(25:11)
  5418     CALL 'kxdfhei1' USING DFHEIV0,
  5419           ERPNDT-FILE-ID,
  5420           ERPNDT-KEY,
  5421           DFHEIV99,
  5422           DFHEIV11,
  5423           DFHEIV99
  5424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5425
  5426
  5427 3000-GET-NEXT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL930.cbl
  5428
  5429
  5430* EXEC CICS HANDLE CONDITION
  5431*        NOTFND(3120-END-ROUTINE)
  5432*        END-EXEC.
  5433*    MOVE '"$I                   ! * #00005063' TO DFHEIV0
  5434     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5435     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5436     MOVE X'2A20233030303035303633' TO DFHEIV0(25:11)
  5437     CALL 'kxdfhei1' USING DFHEIV0
  5438     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5439
  5440
  5441     ADD +1                      TO  WS-SYNC-CNTR.
  5442     IF  WS-SYNC-CNTR GREATER THAN +100
  5443         MOVE +0                 TO  WS-SYNC-CNTR
  5444
  5445* EXEC  CICS SYNCPOINT
  5446*              END-EXEC.
  5447*    MOVE '6"                    !   #00005070' TO DFHEIV0
  5448     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  5449     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5450     MOVE X'2020233030303035303730' TO DFHEIV0(25:11)
  5451     CALL 'kxdfhei1' USING DFHEIV0
  5452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5453
  5454
  5455     ON 1
  5456        GO TO 3005-READ-NEXT-RECORD.
  5457
  5458
  5459* EXEC CICS STARTBR
  5460*        DATASET(ERPNDT-FILE-ID)
  5461*        RIDFLD(ERPNDT-KEY)
  5462*        END-EXEC.
  5463     MOVE 0
  5464       TO DFHEIV11
  5465*    MOVE '&,         G          &   #00005076' TO DFHEIV0
  5466     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5467     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5468     MOVE X'2020233030303035303736' TO DFHEIV0(25:11)
  5469     CALL 'kxdfhei1' USING DFHEIV0,
  5470           ERPNDT-FILE-ID,
  5471           ERPNDT-KEY,
  5472           DFHEIV99,
  5473           DFHEIV11,
  5474           DFHEIV99
  5475     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5476
  5477
  5478
  5479* EXEC CICS HANDLE CONDITION
  5480*        NOTFND(3100-STOP-BROWSE)
  5481*        ENDFILE(3100-STOP-BROWSE)
  5482*        END-EXEC.
  5483*    MOVE '"$I''                  ! + #00005081' TO DFHEIV0
  5484     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5485     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL930.cbl
  5486     MOVE X'2B20233030303035303831' TO DFHEIV0(25:11)
  5487     CALL 'kxdfhei1' USING DFHEIV0
  5488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5489
  5490
  5491 3005-READ-NEXT-RECORD.
  5492
  5493
  5494* EXEC CICS READNEXT
  5495*        SET(ERPNDT-POINTER)
  5496*        DATASET(ERPNDT-FILE-ID)
  5497*        RIDFLD(ERPNDT-KEY)
  5498*        END-EXEC.
  5499     MOVE 0
  5500       TO DFHEIV11
  5501*    MOVE '&.S                   )   #00005088' TO DFHEIV0
  5502     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5503     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5504     MOVE X'2020233030303035303838' TO DFHEIV0(25:11)
  5505     CALL 'kxdfhei1' USING DFHEIV0,
  5506           ERPNDT-FILE-ID,
  5507           ERPNDT-POINTER,
  5508           DFHEIV99,
  5509           ERPNDT-KEY,
  5510           DFHEIV99,
  5511           DFHEIV11,
  5512           DFHEIV99,
  5513           DFHEIV99
  5514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5515
  5516
  5517     SERVICE RELOAD PENDING-BUSINESS.
  5518
  5519     IF PB-COMPANY-CD = PI-SAV-COMP-CD
  5520       AND PB-ENTRY-BATCH = PI-SAV-ENTRY-BATCH
  5521         NEXT SENTENCE
  5522     ELSE
  5523         GO TO 3100-STOP-BROWSE.
  5524
  5525     IF PB-BILLED-DT NOT = LOW-VALUES
  5526         MOVE ER-2402            TO EMI-ERROR
  5527         MOVE -1                 TO BATCHL
  5528         MOVE AL-UABON           TO BATCHA
  5529         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5530         GO TO 8200-SEND-DATAONLY.
  5531
  5532******************************************************************
  5533*                                                                *
  5534*                DELETE PENDING ADDRESS RECORD                   *
  5535*                                                                *
  5536******************************************************************
  5537
  5538     IF PB-I-MAIL-ADDRS-PRESENT
  5539        NEXT SENTENCE
  5540       ELSE
  5541        GO TO 3006-DELETE-CERTIFICATE.
  5542
  5543
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL930.cbl
  5544* EXEC CICS HANDLE CONDITION
  5545*         NOTOPEN  (3006-DELETE-CERTIFICATE)
  5546*         NOTFND   (3006-DELETE-CERTIFICATE)
  5547*         END-EXEC.
  5548*    MOVE '"$JI                  ! , #00005120' TO DFHEIV0
  5549     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  5550     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5551     MOVE X'2C20233030303035313230' TO DFHEIV0(25:11)
  5552     CALL 'kxdfhei1' USING DFHEIV0
  5553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5554
  5555
  5556
  5557* EXEC CICS READ
  5558*        EQUAL
  5559*        DATASET   (ERPNDM-FILE-ID)
  5560*        SET       (ERPNDM-POINTER)
  5561*        RIDFLD    (ERPNDT-KEY)
  5562*        UPDATE
  5563*        END-EXEC.
  5564*    MOVE '&"S        EU         (   #00005125' TO DFHEIV0
  5565     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5566     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5567     MOVE X'2020233030303035313235' TO DFHEIV0(25:11)
  5568     CALL 'kxdfhei1' USING DFHEIV0,
  5569           ERPNDM-FILE-ID,
  5570           ERPNDM-POINTER,
  5571           DFHEIV99,
  5572           ERPNDT-KEY,
  5573           DFHEIV99,
  5574           DFHEIV99,
  5575           DFHEIV99
  5576     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5577
  5578
  5579        SERVICE RELOAD PENDING-MAILING-DATA.
  5580
  5581     MOVE 'D'                    TO  JP-RECORD-TYPE.
  5582     MOVE PENDING-MAILING-DATA   TO  JP-RECORD-AREA.
  5583
  5584     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  5585             WS-ERPNDM-RECORD-LENGTH  +  23.
  5586
  5587
  5588* EXEC CICS DELETE
  5589*        DATASET   (ERPNDM-FILE-ID)
  5590*        END-EXEC.
  5591*    MOVE '&(                    &   #00005141' TO DFHEIV0
  5592     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5593     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5594     MOVE X'2020233030303035313431' TO DFHEIV0(25:11)
  5595     CALL 'kxdfhei1' USING DFHEIV0,
  5596           ERPNDM-FILE-ID,
  5597           DFHEIV99,
  5598           DFHEIV99,
  5599           DFHEIV99,
  5600           DFHEIV99
  5601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL930.cbl
  5602
  5603
  5604     PERFORM 8400-LOG-JOURNAL-RECORD.
  5605
  5606 3006-DELETE-CERTIFICATE.
  5607
  5608
  5609* EXEC CICS HANDLE CONDITION
  5610*         NOTFND  (3020-CONTINUE-DELETE)
  5611*         END-EXEC.
  5612*    MOVE '"$I                   ! - #00005149' TO DFHEIV0
  5613     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5614     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5615     MOVE X'2D20233030303035313439' TO DFHEIV0(25:11)
  5616     CALL 'kxdfhei1' USING DFHEIV0
  5617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5618
  5619
  5620     MOVE PB-CONTROL-BY-ACCOUNT  TO ELCERT-KEY.
  5621     MOVE PB-SV-CARRIER          TO CERT-CARRIER.
  5622     MOVE PB-SV-GROUPING         TO CERT-GROUPING.
  5623     MOVE PB-SV-STATE            TO CERT-STATE.
  5624
  5625* EXEC CICS READ
  5626*        SET     (ELCERT-POINTER)
  5627*        DATASET (ELCERT-FILE-ID)
  5628*        RIDFLD  (ELCERT-KEY)
  5629*        UPDATE
  5630*        END-EXEC.
  5631*    MOVE '&"S        EU         (   #00005157' TO DFHEIV0
  5632     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5633     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5634     MOVE X'2020233030303035313537' TO DFHEIV0(25:11)
  5635     CALL 'kxdfhei1' USING DFHEIV0,
  5636           ELCERT-FILE-ID,
  5637           ELCERT-POINTER,
  5638           DFHEIV99,
  5639           ELCERT-KEY,
  5640           DFHEIV99,
  5641           DFHEIV99,
  5642           DFHEIV99
  5643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5644
  5645
  5646     SERVICE RELOAD CERTIFICATE-MASTER.
  5647
  5648     IF INSURED-ADDR-PRESENT
  5649        MOVE 'Y'                  TO WS-CERT-ADDRESS-SW
  5650     ELSE
  5651        MOVE ' '                  TO WS-CERT-ADDRESS-SW.
  5652
  5653     IF  CERT-NOTES-ARE-NOT-PRESENT
  5654         MOVE ' '                TO WS-CERT-NOTE-SW
  5655     ELSE
  5656         MOVE 'Y'                TO WS-CERT-NOTE-SW.
  5657
  5658     IF PB-CANCELLATION
  5659        IF PB-CI-LF-PRIOR-CANCEL-DT = LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL930.cbl
  5660           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  5661           MOVE ZERO                  TO CM-LF-ITD-CANCEL-AMT
  5662           MOVE LOW-VALUE             TO CM-LF-CANCEL-EXIT-DT
  5663           MOVE LOW-VALUE             TO CM-LF-CANCEL-DT
  5664           MOVE CM-LF-STATUS-AT-CANCEL TO CM-LF-CURRENT-STATUS
  5665           MOVE SPACE                 TO CM-LF-STATUS-AT-CANCEL
  5666        ELSE
  5667           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  5668           MOVE PB-CI-LF-CANCEL-AMT   TO CM-LF-ITD-CANCEL-AMT
  5669           MOVE PB-CI-LF-PRIOR-CANCEL-DT TO CM-LF-CANCEL-DT
  5670           MOVE PB-CI-LF-POLICY-STATUS   TO CM-LF-CURRENT-STATUS
  5671           MOVE PB-CI-LIVES           TO CM-LIVES.
  5672
  5673     IF PB-CANCELLATION
  5674        IF PB-CI-AH-PRIOR-CANCEL-DT = LOW-VALUES
  5675           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  5676           MOVE ZERO                  TO CM-AH-ITD-CANCEL-AMT
  5677           MOVE LOW-VALUE             TO CM-AH-CANCEL-EXIT-DT
  5678           MOVE LOW-VALUE             TO CM-AH-CANCEL-DT
  5679           MOVE CM-AH-STATUS-AT-CANCEL TO CM-AH-CURRENT-STATUS
  5680           MOVE SPACE                 TO CM-AH-STATUS-AT-CANCEL
  5681           GO TO 3010-REWRITE-CERT
  5682        ELSE
  5683           MOVE SPACE                 TO CM-CREDIT-INTERFACE-SW-2
  5684           MOVE PB-CI-AH-CANCEL-AMT   TO CM-AH-ITD-CANCEL-AMT
  5685           MOVE PB-CI-AH-PRIOR-CANCEL-DT TO CM-AH-CANCEL-DT
  5686           MOVE PB-CI-AH-POLICY-STATUS   TO CM-AH-CURRENT-STATUS
  5687           MOVE PB-CI-LIVES           TO CM-LIVES
  5688           GO TO 3010-REWRITE-CERT.
  5689
  5690     IF CERT-ADDED-BATCH  AND
  5691        (NO-CLAIM-ATTACHED OR CM-CLAIM-ATTACHED-COUNT = ZEROS)
  5692        GO TO 3010-REWRITE-CERT.
  5693
  5694     IF NO-CLAIM-ATTACHED  NEXT SENTENCE
  5695       ELSE
  5696        MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1
  5697        MOVE '2'                    TO CM-CLAIM-INTERFACE-SW
  5698        GO TO 3010-REWRITE-CERT.
  5699
  5700
  5701* EXEC CICS DELETE
  5702*            DATASET    (ELCERT-FILE-ID)
  5703*            END-EXEC.
  5704*    MOVE '&(                    &   #00005218' TO DFHEIV0
  5705     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5706     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5707     MOVE X'2020233030303035323138' TO DFHEIV0(25:11)
  5708     CALL 'kxdfhei1' USING DFHEIV0,
  5709           ELCERT-FILE-ID,
  5710           DFHEIV99,
  5711           DFHEIV99,
  5712           DFHEIV99,
  5713           DFHEIV99
  5714     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5715
  5716
  5717******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL930.cbl
  5718*                                                                *
  5719*       DELETE CERTIFICATE NOTES FOR ALL DELETED CERTIFICATES    *
  5720*                                                                *
  5721******************************************************************
  5722
  5723     IF CERT-NOTES-ARE-PRESENT
  5724        NEXT SENTENCE
  5725     ELSE
  5726        GO TO 3007-DELETE-MAILING-DATA.
  5727
  5728
  5729* EXEC CICS HANDLE CONDITION
  5730*         NOTFND   (3007-DELETE-MAILING-DATA)
  5731*         END-EXEC.
  5732*    MOVE '"$I                   ! . #00005233' TO DFHEIV0
  5733     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5734     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5735     MOVE X'2E20233030303035323333' TO DFHEIV0(25:11)
  5736     CALL 'kxdfhei1' USING DFHEIV0
  5737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5738
  5739
  5740
  5741* EXEC CICS READ
  5742*        EQUAL
  5743*        DATASET   (ERNOTE-FILE-ID)
  5744*        SET       (ERNOTE-POINTER)
  5745*        RIDFLD    (ELCERT-KEY)
  5746*        UPDATE
  5747*        END-EXEC.
  5748*    MOVE '&"S        EU         (   #00005237' TO DFHEIV0
  5749     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5750     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5751     MOVE X'2020233030303035323337' TO DFHEIV0(25:11)
  5752     CALL 'kxdfhei1' USING DFHEIV0,
  5753           ERNOTE-FILE-ID,
  5754           ERNOTE-POINTER,
  5755           DFHEIV99,
  5756           ELCERT-KEY,
  5757           DFHEIV99,
  5758           DFHEIV99,
  5759           DFHEIV99
  5760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5761
  5762
  5763        SERVICE RELOAD CERTIFICATE-NOTE.
  5764
  5765     MOVE 'D'                    TO  JP-RECORD-TYPE.
  5766     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
  5767
  5768     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  5769             WS-ERNOTE-RECORD-LENGTH  +  23.
  5770
  5771
  5772* EXEC CICS DELETE
  5773*        DATASET   (ERNOTE-FILE-ID)
  5774*        END-EXEC.
  5775*    MOVE '&(                    &   #00005253' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL930.cbl
  5776     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5777     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5778     MOVE X'2020233030303035323533' TO DFHEIV0(25:11)
  5779     CALL 'kxdfhei1' USING DFHEIV0,
  5780           ERNOTE-FILE-ID,
  5781           DFHEIV99,
  5782           DFHEIV99,
  5783           DFHEIV99,
  5784           DFHEIV99
  5785     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5786
  5787
  5788     PERFORM 8400-LOG-JOURNAL-RECORD.
  5789
  5790
  5791
  5792******************************************************************
  5793*                                                                *
  5794*     DELETE MAILING ADDRESS RECORDS FOR DELETED CERTIFICATES    *
  5795*                                                                *
  5796******************************************************************
  5797
  5798 3007-DELETE-MAILING-DATA.
  5799
  5800     IF CERT-ADDRESS-PRESENT
  5801        NEXT SENTENCE
  5802     ELSE
  5803        GO TO 3020-CONTINUE-DELETE.
  5804
  5805
  5806* EXEC CICS HANDLE CONDITION
  5807*         NOTOPEN  (3020-CONTINUE-DELETE)
  5808*         NOTFND   (3020-CONTINUE-DELETE)
  5809*         END-EXEC.
  5810*    MOVE '"$JI                  ! / #00005274' TO DFHEIV0
  5811     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  5812     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5813     MOVE X'2F20233030303035323734' TO DFHEIV0(25:11)
  5814     CALL 'kxdfhei1' USING DFHEIV0
  5815     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5816
  5817
  5818
  5819* EXEC CICS READ
  5820*        EQUAL
  5821*        DATASET   (ERMAIL-FILE-ID)
  5822*        SET       (ERMAIL-POINTER)
  5823*        RIDFLD    (ELCERT-KEY)
  5824*        UPDATE
  5825*        END-EXEC.
  5826*    MOVE '&"S        EU         (   #00005279' TO DFHEIV0
  5827     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5828     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5829     MOVE X'2020233030303035323739' TO DFHEIV0(25:11)
  5830     CALL 'kxdfhei1' USING DFHEIV0,
  5831           ERMAIL-FILE-ID,
  5832           ERMAIL-POINTER,
  5833           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL930.cbl
  5834           ELCERT-KEY,
  5835           DFHEIV99,
  5836           DFHEIV99,
  5837           DFHEIV99
  5838     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5839
  5840
  5841        SERVICE RELOAD MAILING-DATA.
  5842
  5843     MOVE 'D'                    TO  JP-RECORD-TYPE.
  5844     MOVE MAILING-DATA           TO  JP-RECORD-AREA.
  5845
  5846     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  5847             WS-ERMAIL-RECORD-LENGTH  +  23.
  5848
  5849
  5850* EXEC CICS DELETE
  5851*        DATASET   (ERMAIL-FILE-ID)
  5852*        END-EXEC.
  5853*    MOVE '&(                    &   #00005295' TO DFHEIV0
  5854     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  5855     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5856     MOVE X'2020233030303035323935' TO DFHEIV0(25:11)
  5857     CALL 'kxdfhei1' USING DFHEIV0,
  5858           ERMAIL-FILE-ID,
  5859           DFHEIV99,
  5860           DFHEIV99,
  5861           DFHEIV99,
  5862           DFHEIV99
  5863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5864
  5865
  5866     PERFORM 8400-LOG-JOURNAL-RECORD.
  5867
  5868     GO TO 3020-CONTINUE-DELETE.
  5869
  5870 3010-REWRITE-CERT.
  5871
  5872     MOVE SPACE                  TO CM-CREDIT-INTERFACE-SW-1.
  5873
  5874
  5875* EXEC CICS REWRITE
  5876*            DATASET    (ELCERT-FILE-ID)
  5877*            FROM       (CERTIFICATE-MASTER)
  5878*            END-EXEC.
  5879     MOVE LENGTH OF
  5880      CERTIFICATE-MASTER
  5881       TO DFHEIV11
  5882*    MOVE '&& L                  %   #00005307' TO DFHEIV0
  5883     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5884     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5885     MOVE X'2020233030303035333037' TO DFHEIV0(25:11)
  5886     CALL 'kxdfhei1' USING DFHEIV0,
  5887           ELCERT-FILE-ID,
  5888           CERTIFICATE-MASTER,
  5889           DFHEIV11,
  5890           DFHEIV99
  5891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL930.cbl
  5892
  5893
  5894 3020-CONTINUE-DELETE.
  5895
  5896     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  5897             WS-ERPNDT-RECORD-LENGTH  +  23.
  5898
  5899     MOVE 'D'                    TO JP-RECORD-TYPE.
  5900     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  5901
  5902
  5903* EXEC CICS ENDBR
  5904*        DATASET(ERPNDT-FILE-ID)
  5905*        END-EXEC.
  5906     MOVE 0
  5907       TO DFHEIV11
  5908*    MOVE '&2                    $   #00005320' TO DFHEIV0
  5909     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5910     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5911     MOVE X'2020233030303035333230' TO DFHEIV0(25:11)
  5912     CALL 'kxdfhei1' USING DFHEIV0,
  5913           ERPNDT-FILE-ID,
  5914           DFHEIV11,
  5915           DFHEIV99
  5916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5917
  5918
  5919
  5920* EXEC CICS DELETE
  5921*        DATASET(ERPNDT-FILE-ID)
  5922*        RIDFLD(ERPNDT-KEY)
  5923*        END-EXEC.
  5924*    MOVE '&(  R                 &   #00005324' TO DFHEIV0
  5925     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  5926     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5927     MOVE X'2020233030303035333234' TO DFHEIV0(25:11)
  5928     CALL 'kxdfhei1' USING DFHEIV0,
  5929           ERPNDT-FILE-ID,
  5930           ERPNDT-KEY,
  5931           DFHEIV99,
  5932           DFHEIV99,
  5933           DFHEIV99
  5934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5935
  5936
  5937     PERFORM 8400-LOG-JOURNAL-RECORD.
  5938     ADD 1   TO WS-DELETE-CNT.
  5939     GO TO 3000-GET-NEXT-RECORD.
  5940
  5941 3100-STOP-BROWSE.
  5942
  5943
  5944* EXEC CICS ENDBR
  5945*        DATASET(ERPNDT-FILE-ID)
  5946*        END-EXEC.
  5947     MOVE 0
  5948       TO DFHEIV11
  5949*    MOVE '&2                    $   #00005335' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL930.cbl
  5950     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5951     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5952     MOVE X'2020233030303035333335' TO DFHEIV0(25:11)
  5953     CALL 'kxdfhei1' USING DFHEIV0,
  5954           ERPNDT-FILE-ID,
  5955           DFHEIV11,
  5956           DFHEIV99
  5957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5958
  5959
  5960 3120-END-ROUTINE.
  5961
  5962     MOVE SPACE                  TO PI-UPDATE-SW.
  5963     IF WS-DELETE-CNT NOT GREATER THAN ZERO
  5964         GO TO 3200-NO-RECORDS.
  5965     IF PI-SAVE-CALLING-PGM NOT = XCTL-9301
  5966         MOVE ZEROS              TO EMI-ERROR
  5967         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5968     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  5969     MOVE LOW-VALUES             TO EL930AO.
  5970     MOVE QUESTION-MARKS         TO BATCHI.
  5971     MOVE AL-UANON               TO BATCHA.
  5972     MOVE -1                     TO MAINTL.
  5973     GO TO 8100-SEND-INITIAL-MAP.
  5974
  5975 3200-NO-RECORDS.
  5976     MOVE ER-2242                TO EMI-ERROR.
  5977     MOVE -1 TO BATCHL
  5978     MOVE AL-UABON               TO BATCHA.
  5979     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5980     GO TO 8200-SEND-DATAONLY.
  5981
  5982 3300-FIRST-PF2.
  5983     MOVE ER-2422                TO EMI-ERROR.
  5984     MOVE -1                     TO PFENTERL.
  5985     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5986     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL930.cbl
  5988 4000-SHOW-TOTALS.
  5989
  5990     MOVE LOW-VALUES             TO EL930AI.
  5991
  5992     MOVE PI-SAV-ENTRY-BATCH     TO BATCHO.
  5993
  5994     MOVE PI-MAINT-FUNC          TO MAINTO.
  5995
  5996
  5997     IF PI-DATA-UPDATED
  5998         MOVE AL-SANON           TO BATCHA
  5999                                    MAINTA
  6000     ELSE
  6001         MOVE AL-UANON           TO BATCHA
  6002                                    MAINTA.
  6003
  6004     MOVE PI-LF-ISS-ENTERED      TO ALFISSO.
  6005
  6006     IF PI-LF-ISS-REMITTED NOT = ZEROS
  6007         MOVE PI-LF-ISS-REMITTED TO ELFISSO
  6008         MOVE AL-UNNON           TO ELFISSA
  6009         COMPUTE WS-OBAL = PI-LF-ISS-REMITTED - PI-LF-ISS-ENTERED
  6010         IF WS-OBAL NOT = ZEROS
  6011             MOVE WS-OBAL        TO OLFISSO.
  6012
  6013     MOVE PI-LF-CAN-ENTERED      TO ALFCANO.
  6014     IF PI-LF-CAN-REMITTED NOT = ZEROS
  6015         MOVE PI-LF-CAN-REMITTED TO ELFCANO
  6016         MOVE AL-UNNON           TO ELFCANA
  6017         COMPUTE WS-OBAL = PI-LF-CAN-REMITTED - PI-LF-CAN-ENTERED
  6018         IF WS-OBAL NOT = ZEROS
  6019             MOVE WS-OBAL        TO OLFCANO.
  6020
  6021     MOVE PI-AH-ISS-ENTERED      TO AAHISSO.
  6022     IF PI-AH-ISS-REMITTED NOT = ZEROS
  6023         MOVE PI-AH-ISS-REMITTED TO EAHISSO
  6024         MOVE AL-UNNON           TO EAHISSA
  6025         COMPUTE WS-OBAL = PI-AH-ISS-REMITTED - PI-AH-ISS-ENTERED
  6026         IF WS-OBAL NOT = ZEROS
  6027             MOVE WS-OBAL        TO OAHISSO.
  6028
  6029     MOVE PI-AH-CAN-ENTERED      TO AAHCANO.
  6030     IF PI-AH-CAN-REMITTED NOT = ZEROS
  6031         MOVE PI-AH-CAN-REMITTED TO EAHCANO
  6032         MOVE AL-UNNON           TO EAHCANA
  6033         COMPUTE WS-OBAL = PI-AH-CAN-REMITTED - PI-AH-CAN-ENTERED
  6034         IF WS-OBAL NOT = ZEROS
  6035             MOVE WS-OBAL        TO OAHCANO.
  6036
  6037     MOVE PI-ISS-CNT-ENTERED     TO AISSCNTO.
  6038     IF PI-ISS-CNT-REMITTED NOT = ZEROS
  6039         MOVE PI-ISS-CNT-REMITTED TO EISSCNTO
  6040         MOVE AL-UNNON            TO EISSCNTA
  6041         COMPUTE WS-OCNT = PI-ISS-CNT-REMITTED -
  6042                                PI-ISS-CNT-ENTERED
  6043         IF WS-OCNT NOT = ZEROS
  6044             MOVE WS-OCNT        TO OISSCNTO.
  6045
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL930.cbl
  6046     MOVE PI-CAN-CNT-ENTERED     TO ACANCNTO.
  6047     IF PI-CAN-CNT-REMITTED NOT = ZEROS
  6048         MOVE PI-CAN-CNT-REMITTED TO ECANCNTO
  6049         MOVE AL-UNNON            TO ECANCNTA
  6050         COMPUTE WS-OCNT = PI-CAN-CNT-REMITTED -
  6051                                PI-CAN-CNT-ENTERED
  6052         IF WS-OCNT NOT = ZEROS
  6053             MOVE WS-OCNT        TO OCANCNTO.
  6054
  6055
  6056     IF  PI-NB-MONTH-END-DT GREATER THAN SPACES
  6057         MOVE PI-NB-MONTH-END-DT TO DC-BIN-DATE-1
  6058       ELSE
  6059         MOVE PI-CR-MONTH-END-DT TO DC-BIN-DATE-1.
  6060
  6061     MOVE  SPACE                 TO  DC-OPTION-CODE.
  6062     PERFORM  9700-DATE-LINK.
  6063
  6064     IF  DATE-CONVERSION-ERROR
  6065         MOVE LOW-VALUES TO MNTHNDTO
  6066         GO TO 0490-EXIT.
  6067
  6068     MOVE DC-GREG-DATE-1-EDIT    TO  MNTHNDTO.
  6069     MOVE AL-UANON               TO  MNTHNDTA.
  6070
  6071     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL930.cbl
  6073
  6074*****************************************************************
  6075*                                                               *
  6076*            U P D A T E   E N T I R E   B A T C H              *
  6077*                                                               *
  6078*  THIS SECTION UPDATES AN ENTIRE BATCH WITH A NEW MONTH END     *
  6079*  DATE.                                                        *
  6080*                                                               *
  6081*****************************************************************
  6082
  6083 5000-UPDATE-ENTIRE-BATCH.
  6084
  6085     MOVE ZEROS                  TO  PNDT-BATCH-SEQ
  6086                                     PNDT-BATCH-CHG-SEQ.
  6087
  6088
  6089* EXEC CICS HANDLE CONDITION
  6090*        NOTFND(5900-EXIT)
  6091*        NOTOPEN(7000-PNDT-FILE-NOTOPEN)
  6092*        END-EXEC.
  6093*    MOVE '"$IJ                  ! 0 #00005467' TO DFHEIV0
  6094     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  6095     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6096     MOVE X'3020233030303035343637' TO DFHEIV0(25:11)
  6097     CALL 'kxdfhei1' USING DFHEIV0
  6098     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6099
  6100
  6101
  6102* EXEC CICS STARTBR
  6103*        DATASET(ERPNDT-FILE-ID)
  6104*        RIDFLD(ERPNDT-KEY)
  6105*        END-EXEC.
  6106     MOVE 0
  6107       TO DFHEIV11
  6108*    MOVE '&,         G          &   #00005472' TO DFHEIV0
  6109     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6110     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6111     MOVE X'2020233030303035343732' TO DFHEIV0(25:11)
  6112     CALL 'kxdfhei1' USING DFHEIV0,
  6113           ERPNDT-FILE-ID,
  6114           ERPNDT-KEY,
  6115           DFHEIV99,
  6116           DFHEIV11,
  6117           DFHEIV99
  6118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6119
  6120
  6121 5010-GET-NEXT-RECORD.
  6122
  6123* EXEC CICS HANDLE CONDITION
  6124*        NOTFND(5100-STOP-BROWSE)
  6125*        ENDFILE(5100-STOP-BROWSE)
  6126*        END-EXEC.
  6127*    MOVE '"$I''                  ! 1 #00005478' TO DFHEIV0
  6128     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6129     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6130     MOVE X'3120233030303035343738' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL930.cbl
  6131     CALL 'kxdfhei1' USING DFHEIV0
  6132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6133
  6134
  6135
  6136* EXEC CICS READNEXT
  6137*        SET(ERPNDT-POINTER)
  6138*        DATASET(ERPNDT-FILE-ID)
  6139*        RIDFLD(ERPNDT-KEY)
  6140*        END-EXEC.
  6141     MOVE 0
  6142       TO DFHEIV11
  6143*    MOVE '&.S                   )   #00005483' TO DFHEIV0
  6144     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6145     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6146     MOVE X'2020233030303035343833' TO DFHEIV0(25:11)
  6147     CALL 'kxdfhei1' USING DFHEIV0,
  6148           ERPNDT-FILE-ID,
  6149           ERPNDT-POINTER,
  6150           DFHEIV99,
  6151           ERPNDT-KEY,
  6152           DFHEIV99,
  6153           DFHEIV11,
  6154           DFHEIV99,
  6155           DFHEIV99
  6156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6157
  6158
  6159
  6160     SERVICE RELOAD PENDING-BUSINESS.
  6161
  6162     ON 1
  6163          MOVE PB-CONTROL-PRIMARY     TO WS-SAV-PNDT-KEY.
  6164
  6165     IF PB-COMPANY-CD = WS-SAV-COMP-CD
  6166       AND PB-ENTRY-BATCH = WS-SAV-ENTRY-BATCH
  6167         NEXT SENTENCE
  6168     ELSE
  6169         GO TO 5100-STOP-BROWSE.
  6170
  6171
  6172     IF  PB-CREDIT-SELECT-DT = PI-NB-MONTH-END-DT
  6173         GO TO 5010-GET-NEXT-RECORD.
  6174
  6175
  6176
  6177
  6178
  6179* EXEC CICS READ
  6180*        SET     (ERPNDT-POINTER)
  6181*        DATASET (ERPNDT-FILE-ID)
  6182*        RIDFLD  (ERPNDT-KEY)
  6183*        UPDATE
  6184*        END-EXEC.
  6185*    MOVE '&"S        EU         (   #00005508' TO DFHEIV0
  6186     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6187     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6188     MOVE X'2020233030303035353038' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL930.cbl
  6189     CALL 'kxdfhei1' USING DFHEIV0,
  6190           ERPNDT-FILE-ID,
  6191           ERPNDT-POINTER,
  6192           DFHEIV99,
  6193           ERPNDT-KEY,
  6194           DFHEIV99,
  6195           DFHEIV99,
  6196           DFHEIV99
  6197     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6198
  6199
  6200     SERVICE RELOAD PENDING-BUSINESS.
  6201
  6202
  6203     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  6204             WS-ERPNDT-RECORD-LENGTH  +  23.
  6205
  6206     MOVE 'B'                    TO JP-RECORD-TYPE.
  6207     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  6208     PERFORM 8400-LOG-JOURNAL-RECORD.
  6209
  6210     MOVE  PI-NB-MONTH-END-DT    TO PB-CREDIT-SELECT-DT.
  6211
  6212     MOVE 'C'                    TO JP-RECORD-TYPE.
  6213     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  6214
  6215 5050-REWRITE-PENDING-BUS.
  6216
  6217* EXEC CICS REWRITE
  6218*            DATASET    (ERPNDT-FILE-ID)
  6219*            FROM       (PENDING-BUSINESS)
  6220*            END-EXEC.
  6221     MOVE LENGTH OF
  6222      PENDING-BUSINESS
  6223       TO DFHEIV11
  6224*    MOVE '&& L                  %   #00005531' TO DFHEIV0
  6225     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6226     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6227     MOVE X'2020233030303035353331' TO DFHEIV0(25:11)
  6228     CALL 'kxdfhei1' USING DFHEIV0,
  6229           ERPNDT-FILE-ID,
  6230           PENDING-BUSINESS,
  6231           DFHEIV11,
  6232           DFHEIV99
  6233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6234
  6235
  6236
  6237     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  6238             WS-ERPNDT-RECORD-LENGTH  +  23.
  6239
  6240     PERFORM 8400-LOG-JOURNAL-RECORD.
  6241
  6242     GO TO 5010-GET-NEXT-RECORD.
  6243
  6244 5100-STOP-BROWSE.
  6245
  6246
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL930.cbl
  6247* EXEC CICS ENDBR
  6248*        DATASET(ERPNDT-FILE-ID)
  6249*        END-EXEC.
  6250     MOVE 0
  6251       TO DFHEIV11
  6252*    MOVE '&2                    $   #00005546' TO DFHEIV0
  6253     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6254     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6255     MOVE X'2020233030303035353436' TO DFHEIV0(25:11)
  6256     CALL 'kxdfhei1' USING DFHEIV0,
  6257           ERPNDT-FILE-ID,
  6258           DFHEIV11,
  6259           DFHEIV99
  6260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6261
  6262
  6263 5900-EXIT.
  6264      EXIT.
  6265
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL930.cbl
  6267
  6268
  6269 6000-BROWSE-BATCH-HEADERS.
  6270
  6271
  6272* EXEC CICS HANDLE CONDITION
  6273*        NOTFND (6200-END-OF-FILE)
  6274*        END-EXEC.
  6275*    MOVE '"$I                   ! 2 #00005558' TO DFHEIV0
  6276     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  6277     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6278     MOVE X'3220233030303035353538' TO DFHEIV0(25:11)
  6279     CALL 'kxdfhei1' USING DFHEIV0
  6280     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6281
  6282
  6283     MOVE SPACES                 TO ERPNDT-KEY.
  6284
  6285     MOVE PI-COMPANY-CD          TO PNDT-COMP-CD.
  6286
  6287     IF  BATCHI = QUESTION-MARKS
  6288         NEXT SENTENCE
  6289     ELSE
  6290         MOVE BATCHI             TO PNDT-ENTRY-BATCH
  6291         MOVE 9999               TO PNDT-BATCH-SEQ.
  6292
  6293
  6294* EXEC CICS STARTBR
  6295*        DATASET (ERPNDT-FILE-ID)
  6296*        RIDFLD  (ERPNDT-KEY)
  6297*        END-EXEC.
  6298     MOVE 0
  6299       TO DFHEIV11
  6300*    MOVE '&,         G          &   #00005572' TO DFHEIV0
  6301     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6302     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6303     MOVE X'2020233030303035353732' TO DFHEIV0(25:11)
  6304     CALL 'kxdfhei1' USING DFHEIV0,
  6305           ERPNDT-FILE-ID,
  6306           ERPNDT-KEY,
  6307           DFHEIV99,
  6308           DFHEIV11,
  6309           DFHEIV99
  6310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6311
  6312
  6313
  6314* EXEC CICS HANDLE CONDITION
  6315*        ENDFILE  (6100-END-BROWSE)
  6316*        END-EXEC.
  6317*    MOVE '"$''                   ! 3 #00005577' TO DFHEIV0
  6318     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  6319     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6320     MOVE X'3320233030303035353737' TO DFHEIV0(25:11)
  6321     CALL 'kxdfhei1' USING DFHEIV0
  6322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6323
  6324
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL930.cbl
  6325 6010-READ-NEXT-RECORD.
  6326
  6327
  6328* EXEC CICS READNEXT
  6329*         DATASET   (ERPNDT-FILE-ID)
  6330*         SET       (ERPNDT-POINTER)
  6331*         RIDFLD    (ERPNDT-KEY)
  6332*         END-EXEC.
  6333     MOVE 0
  6334       TO DFHEIV11
  6335*    MOVE '&.S                   )   #00005583' TO DFHEIV0
  6336     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  6337     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6338     MOVE X'2020233030303035353833' TO DFHEIV0(25:11)
  6339     CALL 'kxdfhei1' USING DFHEIV0,
  6340           ERPNDT-FILE-ID,
  6341           ERPNDT-POINTER,
  6342           DFHEIV99,
  6343           ERPNDT-KEY,
  6344           DFHEIV99,
  6345           DFHEIV11,
  6346           DFHEIV99,
  6347           DFHEIV99
  6348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6349
  6350
  6351     SERVICE RELOAD PENDING-BUSINESS.
  6352
  6353     IF PB-COMPANY-CD NOT = PI-COMPANY-CD
  6354        GO TO 6100-END-BROWSE.
  6355
  6356     IF PB-BATCH-TRAILER
  6357        MOVE PB-ENTRY-BATCH      TO BATCHI
  6358        MOVE +6                  TO BATCHL
  6359        PERFORM 6100-END-BROWSE
  6360        PERFORM 0400-PRIME-BATCH-TOTALS THRU 0490-EXIT
  6361        GO TO 4000-SHOW-TOTALS.
  6362
  6363     MOVE PB-ENTRY-BATCH     TO PNDT-ENTRY-BATCH.
  6364     MOVE 9998               TO PNDT-BATCH-SEQ.
  6365
  6366     GO TO 6010-READ-NEXT-RECORD.
  6367
  6368 6100-END-BROWSE.
  6369
  6370
  6371* EXEC CICS ENDBR
  6372*        DATASET(ERPNDT-FILE-ID)
  6373*        END-EXEC.
  6374     MOVE 0
  6375       TO DFHEIV11
  6376*    MOVE '&2                    $   #00005608' TO DFHEIV0
  6377     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6378     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6379     MOVE X'2020233030303035363038' TO DFHEIV0(25:11)
  6380     CALL 'kxdfhei1' USING DFHEIV0,
  6381           ERPNDT-FILE-ID,
  6382           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL930.cbl
  6383           DFHEIV99
  6384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6385
  6386
  6387 6200-END-OF-FILE.
  6388
  6389     MOVE -1                  TO MAINTL.
  6390     MOVE 2251                TO EMI-ERROR.
  6391     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6392     GO TO 8100-SEND-INITIAL-MAP.
  6393
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL930.cbl
  6395
  6396 7000-PNDT-FILE-NOTOPEN.
  6397     MOVE -1 TO                  MAINTL.
  6398     MOVE 2216                   TO EMI-ERROR.
  6399     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6400     GO TO 8200-SEND-DATAONLY.
  6401
  6402
  6403
  6404 7100-CNTL-FILE-NOTOPEN.
  6405     MOVE -1                     TO MAINTL.
  6406     MOVE 2214                   TO EMI-ERROR.
  6407     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6408     GO TO 8200-SEND-DATAONLY.
  6409
  6410
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL930.cbl
  6412
  6413 8100-SEND-INITIAL-MAP.
  6414     MOVE WS-CURRENT-DT          TO DATEO.
  6415     MOVE EIBTIME                TO TIME-IN.
  6416     MOVE TIME-OUT               TO TIMEO.
  6417     MOVE -1                     TO MAINTL.
  6418     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  6419     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  6420
  6421     MOVE PI-LIFE-OVERRIDE-L2    TO WS-PRM-OVERRIDE
  6422                                    WS-REFUND-OVERRIDE.
  6423     MOVE WS-PRM-HEADER          TO LFPHDGO.
  6424     MOVE WS-REFUND-HEADER       TO LFRHDGO.
  6425
  6426     MOVE PI-AH-OVERRIDE-L2      TO WS-PRM-OVERRIDE
  6427                                    WS-REFUND-OVERRIDE.
  6428     MOVE WS-PRM-HEADER          TO AHPHDGO.
  6429     MOVE WS-REFUND-HEADER       TO AHRHDGO.
  6430
  6431
  6432
  6433* EXEC CICS SEND
  6434*        MAP      (MAP-NAME)
  6435*        MAPSET   (MAPSET-NAME)
  6436*        FROM     (EL930AO)
  6437*        ERASE
  6438*        CURSOR
  6439*        END-EXEC.
  6440     MOVE LENGTH OF
  6441      EL930AO
  6442       TO DFHEIV12
  6443     MOVE -1
  6444       TO DFHEIV11
  6445*    MOVE '8$     CT  E    H L F ,   #00005657' TO DFHEIV0
  6446     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  6447     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  6448     MOVE X'2020233030303035363537' TO DFHEIV0(25:11)
  6449     CALL 'kxdfhei1' USING DFHEIV0,
  6450           MAP-NAME,
  6451           EL930AO,
  6452           DFHEIV12,
  6453           MAPSET-NAME,
  6454           DFHEIV99,
  6455           DFHEIV99,
  6456           DFHEIV99,
  6457           DFHEIV11,
  6458           DFHEIV99,
  6459           DFHEIV99,
  6460           DFHEIV99
  6461     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6462
  6463     GO TO 9100-RETURN-TRAN.
  6464
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL930.cbl
  6466
  6467 8200-SEND-DATAONLY.
  6468     MOVE WS-CURRENT-DT          TO DATEO.
  6469     MOVE EIBTIME                TO TIME-IN.
  6470     MOVE TIME-OUT               TO TIMEO.
  6471     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  6472     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  6473
  6474* EXEC CICS SEND
  6475*        MAP      (MAP-NAME)
  6476*        MAPSET   (MAPSET-NAME)
  6477*        FROM     (EL930AO)
  6478*        DATAONLY
  6479*        ERASEAUP
  6480*        CURSOR
  6481*        END-EXEC.
  6482     MOVE LENGTH OF
  6483      EL930AO
  6484       TO DFHEIV12
  6485     MOVE -1
  6486       TO DFHEIV11
  6487*    MOVE '8$D    CT  A    H L F ,   #00005674' TO DFHEIV0
  6488     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  6489     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  6490     MOVE X'2020233030303035363734' TO DFHEIV0(25:11)
  6491     CALL 'kxdfhei1' USING DFHEIV0,
  6492           MAP-NAME,
  6493           EL930AO,
  6494           DFHEIV12,
  6495           MAPSET-NAME,
  6496           DFHEIV99,
  6497           DFHEIV99,
  6498           DFHEIV99,
  6499           DFHEIV11,
  6500           DFHEIV99,
  6501           DFHEIV99,
  6502           DFHEIV99
  6503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6504
  6505     GO TO 9100-RETURN-TRAN.
  6506
  6507 8300-SEND-TEXT.
  6508
  6509* EXEC CICS SEND TEXT
  6510*        FROM     (LOGOFF-TEXT)
  6511*        LENGTH   (LOGOFF-LENGTH)
  6512*        ERASE
  6513*        FREEKB
  6514*        END-EXEC.
  6515*    MOVE '8&      T  E F  H   F -   #00005685' TO DFHEIV0
  6516     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  6517     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  6518     MOVE X'2020233030303035363835' TO DFHEIV0(25:11)
  6519     CALL 'kxdfhei1' USING DFHEIV0,
  6520           LOGOFF-TEXT,
  6521           LOGOFF-LENGTH,
  6522           DFHEIV99,
  6523           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL930.cbl
  6524           DFHEIV99,
  6525           DFHEIV99,
  6526           DFHEIV99,
  6527           DFHEIV99,
  6528           DFHEIV99,
  6529           DFHEIV99,
  6530           DFHEIV99,
  6531           DFHEIV99
  6532     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6533
  6534
  6535* EXEC CICS RETURN
  6536*        END-EXEC.
  6537*    MOVE '.(                    &   #00005691' TO DFHEIV0
  6538     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6539     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6540     MOVE X'2020233030303035363931' TO DFHEIV0(25:11)
  6541     CALL 'kxdfhei1' USING DFHEIV0,
  6542           DFHEIV99,
  6543           DFHEIV99,
  6544           DFHEIV99,
  6545           DFHEIV99,
  6546           DFHEIV99
  6547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6548
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL930.cbl
  6550 8400-LOG-JOURNAL-RECORD.
  6551     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
  6552     MOVE ERPNDT-FILE-ID         TO JP-FILE-ID.
  6553     MOVE THIS-PGM               TO JP-PROGRAM-ID.
  6554
  6555*    EXEC CICS JOURNAL
  6556*        JFILEID     (PI-JOURNAL-FILE-ID)
  6557*        JTYPEID     ('EL')
  6558*        FROM        (JOURNAL-RECORD)
  6559*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
  6560*        END-EXEC.
  6561
  6562
  6563
  6564
  6565 8600-DEEDIT.
  6566
  6567
  6568* EXEC CICS BIF DEEDIT
  6569*        FIELD(WS-DEEDIT-FIELD)
  6570*        LENGTH(10)
  6571*        END-EXEC.
  6572     MOVE 10
  6573       TO DFHEIV11
  6574*    MOVE '@"L                   #   #00005711' TO DFHEIV0
  6575     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  6576     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6577     MOVE X'2020233030303035373131' TO DFHEIV0(25:11)
  6578     CALL 'kxdfhei1' USING DFHEIV0,
  6579           WS-DEEDIT-FIELD,
  6580           DFHEIV11
  6581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6582
  6583 8600-EXIT.
  6584     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL930.cbl
  6586 8800-UNAUTHORIZED-ACCESS.
  6587     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  6588     GO TO 8300-SEND-TEXT.
  6589
  6590 8810-PF23.
  6591
  6592     IF NOT PI-DATA-UPDATED
  6593         NEXT SENTENCE
  6594     ELSE
  6595         MOVE -1                 TO PFENTERL
  6596         MOVE ER-2213            TO EMI-ERROR
  6597         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6598         GO TO 4000-SHOW-TOTALS.
  6599
  6600     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  6601     MOVE XCTL-005               TO PGM-NAME.
  6602     GO TO 9300-XCTL.
  6603 9000-RETURN-CICS.
  6604
  6605* EXEC CICS RETURN
  6606*        END-EXEC.
  6607*    MOVE '.(                    &   #00005736' TO DFHEIV0
  6608     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  6609     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6610     MOVE X'2020233030303035373336' TO DFHEIV0(25:11)
  6611     CALL 'kxdfhei1' USING DFHEIV0,
  6612           DFHEIV99,
  6613           DFHEIV99,
  6614           DFHEIV99,
  6615           DFHEIV99,
  6616           DFHEIV99
  6617     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6618
  6619
  6620 9100-RETURN-TRAN.
  6621     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  6622     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  6623
  6624* EXEC CICS RETURN
  6625*        TRANSID    (TRANS-ID)
  6626*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  6627*        LENGTH     (PI-COMM-LENGTH)
  6628*        END-EXEC.
  6629*    MOVE '.(CT                  &   #00005742' TO DFHEIV0
  6630     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  6631     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6632     MOVE X'2020233030303035373432' TO DFHEIV0(25:11)
  6633     CALL 'kxdfhei1' USING DFHEIV0,
  6634           TRANS-ID,
  6635           PROGRAM-INTERFACE-BLOCK,
  6636           PI-COMM-LENGTH,
  6637           DFHEIV99,
  6638           DFHEIV99
  6639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6640
  6641
  6642 9200-RETURN-MAIN-MENU.
  6643
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL930.cbl
  6644     IF NOT PI-DATA-UPDATED
  6645         NEXT SENTENCE
  6646     ELSE
  6647         MOVE -1                 TO PFENTERL
  6648         MOVE ER-2213            TO EMI-ERROR
  6649         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6650         GO TO 4000-SHOW-TOTALS.
  6651
  6652     MOVE XCTL-626               TO PGM-NAME.
  6653     GO TO 9300-XCTL.
  6654
  6655 9300-XCTL.
  6656
  6657* EXEC CICS XCTL
  6658*        PROGRAM    (PGM-NAME)
  6659*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  6660*        LENGTH     (PI-COMM-LENGTH)
  6661*        END-EXEC.
  6662*    MOVE '.$C                   $   #00005762' TO DFHEIV0
  6663     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  6664     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6665     MOVE X'2020233030303035373632' TO DFHEIV0(25:11)
  6666     CALL 'kxdfhei1' USING DFHEIV0,
  6667           PGM-NAME,
  6668           PROGRAM-INTERFACE-BLOCK,
  6669           PI-COMM-LENGTH
  6670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6671
  6672
  6673 9400-CLEAR.
  6674     IF NOT PI-DATA-UPDATED
  6675         NEXT SENTENCE
  6676     ELSE
  6677         MOVE -1                 TO PFENTERL
  6678         MOVE ER-2213            TO EMI-ERROR
  6679         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6680         GO TO 4000-SHOW-TOTALS.
  6681     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  6682     GO TO 9300-XCTL.
  6683
  6684 9500-PF12.
  6685     MOVE XCTL-010               TO PGM-NAME.
  6686     GO TO 9300-XCTL.
  6687
  6688 9600-PGMID-ERROR.
  6689
  6690* EXEC CICS HANDLE CONDITION
  6691*        PGMIDERR    (8300-SEND-TEXT)
  6692*        END-EXEC.
  6693*    MOVE '"$L                   ! 4 #00005784' TO DFHEIV0
  6694     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  6695     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6696     MOVE X'3420233030303035373834' TO DFHEIV0(25:11)
  6697     CALL 'kxdfhei1' USING DFHEIV0
  6698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6699
  6700     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  6701     MOVE ' '                    TO PI-ENTRY-CD-1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL930.cbl
  6702     MOVE XCTL-005               TO PGM-NAME.
  6703     MOVE PGM-NAME               TO LOGOFF-PGM.
  6704     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  6705     GO TO 9300-XCTL.
  6706
  6707 9700-DATE-LINK.
  6708     MOVE LINK-CLDATCV           TO PGM-NAME.
  6709
  6710* EXEC CICS LINK
  6711*        PROGRAM    (PGM-NAME)
  6712*        COMMAREA   (DATE-CONVERSION-DATA)
  6713*        LENGTH     (DC-COMM-LENGTH)
  6714*        END-EXEC.
  6715*    MOVE '."C                   ''   #00005796' TO DFHEIV0
  6716     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6717     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6718     MOVE X'2020233030303035373936' TO DFHEIV0(25:11)
  6719     CALL 'kxdfhei1' USING DFHEIV0,
  6720           PGM-NAME,
  6721           DATE-CONVERSION-DATA,
  6722           DC-COMM-LENGTH,
  6723           DFHEIV99,
  6724           DFHEIV99,
  6725           DFHEIV99
  6726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6727
  6728
  6729
  6730 9900-ERROR-FORMAT.
  6731     IF NOT EMI-ERRORS-COMPLETE
  6732         MOVE LINK-001           TO PGM-NAME
  6733
  6734* EXEC CICS LINK
  6735*            PROGRAM    (PGM-NAME)
  6736*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  6737*            LENGTH     (EMI-COMM-LENGTH)
  6738*            END-EXEC.
  6739*    MOVE '."C                   ''   #00005806' TO DFHEIV0
  6740     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6741     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6742     MOVE X'2020233030303035383036' TO DFHEIV0(25:11)
  6743     CALL 'kxdfhei1' USING DFHEIV0,
  6744           PGM-NAME,
  6745           ERROR-MESSAGE-INTERFACE-BLOCK,
  6746           EMI-COMM-LENGTH,
  6747           DFHEIV99,
  6748           DFHEIV99,
  6749           DFHEIV99
  6750     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6751
  6752 9900-EXIT.
  6753     EXIT.
  6754
  6755 9990-ABEND.
  6756     MOVE LINK-004               TO PGM-NAME.
  6757     MOVE DFHEIBLK               TO EMI-LINE1.
  6758
  6759* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL930.cbl
  6760*        PROGRAM   (PGM-NAME)
  6761*        COMMAREA  (EMI-LINE1)
  6762*        LENGTH    (72)
  6763*        END-EXEC.
  6764     MOVE 72
  6765       TO DFHEIV11
  6766*    MOVE '."C                   ''   #00005817' TO DFHEIV0
  6767     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6768     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6769     MOVE X'2020233030303035383137' TO DFHEIV0(25:11)
  6770     CALL 'kxdfhei1' USING DFHEIV0,
  6771           PGM-NAME,
  6772           EMI-LINE1,
  6773           DFHEIV11,
  6774           DFHEIV99,
  6775           DFHEIV99,
  6776           DFHEIV99
  6777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6778
  6779     MOVE -1                     TO PFENTERL.
  6780     GO TO 8200-SEND-DATAONLY.
  6781
  6782* GOBACK.
  6783     MOVE '9%                    "   ' TO DFHEIV0
  6784     MOVE 'EL930' TO DFHEIV1
  6785     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6786     GOBACK.
  6787
  6788 9995-SECURITY-VIOLATION.
  6789*                            COPY ELCSCTP.
  6790******************************************************************
  6791*                                                                *
  6792*                            ELCSCTP                             *
  6793*                            VMOD=2.001                          *
  6794*                                                                *
  6795*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  6796******************************************************************
  6797
  6798
  6799     MOVE EIBDATE          TO SM-JUL-DATE.
  6800     MOVE EIBTRMID         TO SM-TERMID.
  6801     MOVE THIS-PGM         TO SM-PGM.
  6802     MOVE EIBTIME          TO TIME-IN.
  6803     MOVE TIME-OUT         TO SM-TIME.
  6804     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  6805
  6806
  6807* EXEC CICS LINK
  6808*         PROGRAM  ('EL003')
  6809*         COMMAREA (SECURITY-MESSAGE)
  6810*         LENGTH   (80)
  6811*    END-EXEC.
  6812     MOVE 'EL003' TO DFHEIV1
  6813     MOVE 80
  6814       TO DFHEIV11
  6815*    MOVE '."C                   ''   #00005844' TO DFHEIV0
  6816     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6817     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL930.cbl
  6818     MOVE X'2020233030303035383434' TO DFHEIV0(25:11)
  6819     CALL 'kxdfhei1' USING DFHEIV0,
  6820           DFHEIV1,
  6821           SECURITY-MESSAGE,
  6822           DFHEIV11,
  6823           DFHEIV99,
  6824           DFHEIV99,
  6825           DFHEIV99
  6826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6827
  6828
  6829******************************************************************
  6830
  6831
  6832 9995-EXIT.
  6833     EXIT.
  6834
  6835
  6836
  6837 9999-DFHBACK SECTION.
  6838     MOVE '9%                    "   ' TO DFHEIV0
  6839     MOVE 'EL930' TO DFHEIV1
  6840     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6841     GOBACK.
  6842 9999-DFHEXIT.
  6843     IF DFHEIGDJ EQUAL 0001
  6844         NEXT SENTENCE
  6845     ELSE IF DFHEIGDJ EQUAL 2
  6846         GO TO 9600-PGMID-ERROR,
  6847               9990-ABEND
  6848         DEPENDING ON DFHEIGDI
  6849     ELSE IF DFHEIGDJ EQUAL 3
  6850         GO TO 0350-NO-RECORDS,
  6851               0350-NO-RECORDS,
  6852               7000-PNDT-FILE-NOTOPEN
  6853         DEPENDING ON DFHEIGDI
  6854     ELSE IF DFHEIGDJ EQUAL 4
  6855         GO TO 0480-NO-BATCH-TRAILER
  6856         DEPENDING ON DFHEIGDI
  6857     ELSE IF DFHEIGDJ EQUAL 5
  6858         GO TO 1250-NO-COMPANY-REC,
  6859               7100-CNTL-FILE-NOTOPEN
  6860         DEPENDING ON DFHEIGDI
  6861     ELSE IF DFHEIGDJ EQUAL 6
  6862         GO TO 1300-NO-COMPANY-REC,
  6863               7100-CNTL-FILE-NOTOPEN
  6864         DEPENDING ON DFHEIGDI
  6865     ELSE IF DFHEIGDJ EQUAL 7
  6866         GO TO 1300-REWRITE-COMPANY-REC,
  6867               7000-PNDT-FILE-NOTOPEN
  6868         DEPENDING ON DFHEIGDI
  6869     ELSE IF DFHEIGDJ EQUAL 8
  6870         GO TO 2100-ADD-BATCH-TOTAL-REC,
  6871               7000-PNDT-FILE-NOTOPEN
  6872         DEPENDING ON DFHEIGDI
  6873     ELSE IF DFHEIGDJ EQUAL 9
  6874         GO TO 3200-NO-RECORDS,
  6875               7000-PNDT-FILE-NOTOPEN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL930.cbl
  6876         DEPENDING ON DFHEIGDI
  6877     ELSE IF DFHEIGDJ EQUAL 10
  6878         GO TO 3120-END-ROUTINE
  6879         DEPENDING ON DFHEIGDI
  6880     ELSE IF DFHEIGDJ EQUAL 11
  6881         GO TO 3100-STOP-BROWSE,
  6882               3100-STOP-BROWSE
  6883         DEPENDING ON DFHEIGDI
  6884     ELSE IF DFHEIGDJ EQUAL 12
  6885         GO TO 3006-DELETE-CERTIFICATE,
  6886               3006-DELETE-CERTIFICATE
  6887         DEPENDING ON DFHEIGDI
  6888     ELSE IF DFHEIGDJ EQUAL 13
  6889         GO TO 3020-CONTINUE-DELETE
  6890         DEPENDING ON DFHEIGDI
  6891     ELSE IF DFHEIGDJ EQUAL 14
  6892         GO TO 3007-DELETE-MAILING-DATA
  6893         DEPENDING ON DFHEIGDI
  6894     ELSE IF DFHEIGDJ EQUAL 15
  6895         GO TO 3020-CONTINUE-DELETE,
  6896               3020-CONTINUE-DELETE
  6897         DEPENDING ON DFHEIGDI
  6898     ELSE IF DFHEIGDJ EQUAL 16
  6899         GO TO 5900-EXIT,
  6900               7000-PNDT-FILE-NOTOPEN
  6901         DEPENDING ON DFHEIGDI
  6902     ELSE IF DFHEIGDJ EQUAL 17
  6903         GO TO 5100-STOP-BROWSE,
  6904               5100-STOP-BROWSE
  6905         DEPENDING ON DFHEIGDI
  6906     ELSE IF DFHEIGDJ EQUAL 18
  6907         GO TO 6200-END-OF-FILE
  6908         DEPENDING ON DFHEIGDI
  6909     ELSE IF DFHEIGDJ EQUAL 19
  6910         GO TO 6100-END-BROWSE
  6911         DEPENDING ON DFHEIGDI
  6912     ELSE IF DFHEIGDJ EQUAL 20
  6913         GO TO 8300-SEND-TEXT
  6914         DEPENDING ON DFHEIGDI.
  6915     MOVE '9%                    "   ' TO DFHEIV0
  6916     MOVE 'EL930' TO DFHEIV1
  6917     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6918     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4832     Code:       15625
