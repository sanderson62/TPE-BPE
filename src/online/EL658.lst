* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL658.cbl
* Options: int("EL658.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL658.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL658.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL658.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL658 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/14/96 11:58:19.
     7*                            VMOD=2.005
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL658.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    19*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    20*            *                                                   *
    21*            *****************************************************
    22
    23*REMARKS.    TRANSACTION - EXJ3 - DISPLAY GENERAL AGENT
    24*                                 CROSS REFERENCE RECORDS.
    25
    26
    27 ENVIRONMENT DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL658.cbl
    29 DATA DIVISION.
    30 WORKING-STORAGE SECTION.
    31 01  DFH-START PIC X(04).
    32 77  FILLER  PIC X(32)  VALUE '********************************'.
    33 77  FILLER  PIC X(32)  VALUE '*    EL658 WORKING STORAGE     *'.
    34 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.005 ************'.
    35
    36 77  NDX     PIC S9(5)  COMP-3 VALUE +1.
    37
    38 01  WS-DATE-AREA.
    39     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    40     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
    41
    42 01  WS-CONTROL-PRIMARY.
    43     05  WS-COMPANY-CD       PIC X.
    44     05  WS-CARRIER          PIC X.
    45     05  WS-GROUPING         PIC X(6).
    46     05  WS-AGENT            PIC X(10).
    47
    48     05  WS-OPEN-COUNT       PIC S9(4)    COMP-3 VALUE ZEROS.
    49
    50*                            COPY ELCATTR SUPPRESS.
    51******************************************************************
    52*                                                                *
    53*                            ELCATTR.                            *
    54*                            VMOD=2.001                          *
    55*                                                                *
    56*             LIST OF STANDARD ATTRIBUTE VALUES                  *
    57*                                                                *
    58*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
    59*                                                                *
    60*                   POS 1   P=PROTECTED                          *
    61*                           U=UNPROTECTED                        *
    62*                           S=ASKIP                              *
    63*                   POS 2   A=ALPHA/NUMERIC                      *
    64*                           N=NUMERIC                            *
    65*                   POS 3   N=NORMAL                             *
    66*                           B=BRIGHT                             *
    67*                           D=DARK                               *
    68*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
    69*                           OF=MODIFIED DATA TAG OFF             *
    70*                                                                *
    71*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
    72******************************************************************
    73 01  ATTRIBUTE-LIST.
    74     12  AL-PABOF            PIC X       VALUE 'Y'.
    75     12  AL-PABON            PIC X       VALUE 'Z'.
    76     12  AL-PADOF            PIC X       VALUE '%'.
    77     12  AL-PADON            PIC X       VALUE '_'.
    78     12  AL-PANOF            PIC X       VALUE '-'.
    79     12  AL-PANON            PIC X       VALUE '/'.
    80     12  AL-SABOF            PIC X       VALUE '8'.
    81     12  AL-SABON            PIC X       VALUE '9'.
    82     12  AL-SADOF            PIC X       VALUE '@'.
    83     12  AL-SADON            PIC X       VALUE QUOTE.
    84     12  AL-SANOF            PIC X       VALUE '0'.
    85     12  AL-SANON            PIC X       VALUE '1'.
    86     12  AL-UABOF            PIC X       VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL658.cbl
    87     12  AL-UABON            PIC X       VALUE 'I'.
    88     12  AL-UADOF            PIC X       VALUE '<'.
    89     12  AL-UADON            PIC X       VALUE '('.
    90     12  AL-UANOF            PIC X       VALUE ' '.
    91     12  AL-UANON            PIC X       VALUE 'A'.
    92     12  AL-UNBOF            PIC X       VALUE 'Q'.
    93     12  AL-UNBON            PIC X       VALUE 'R'.
    94     12  AL-UNDOF            PIC X       VALUE '*'.
    95     12  AL-UNDON            PIC X       VALUE ')'.
    96     12  AL-UNNOF            PIC X       VALUE '&'.
    97     12  AL-UNNON            PIC X       VALUE 'J'.
    98
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL658.cbl
   100
   101 01  ERROR-MESSAGES.
   102     12  ER-0004                 PIC X(4)  VALUE '0004'.
   103     12  ER-0029                 PIC X(4)  VALUE '0029'.
   104     12  ER-0033                 PIC X(4)  VALUE '0033'.
   105     12  ER-0034                 PIC X(4)  VALUE '0034'.
   106     12  ER-0130                 PIC X(4)  VALUE '0130'.
   107     12  ER-0131                 PIC X(4)  VALUE '0131'.
   108     12  ER-0142                 PIC X(4)  VALUE '0142'.
   109     12  ER-0234                 PIC X(4)  VALUE '0234'.
   110     12  ER-0235                 PIC X(4)  VALUE '0235'.
   111     12  ER-1162                 PIC X(4)  VALUE '1162'.
   112     12  ER-1164                 PIC X(4)  VALUE '1164'.
   113     12  ER-2237                 PIC X(4)  VALUE '2237'.
   114     12  ER-2238                 PIC X(4)  VALUE '2238'.
   115     12  ER-5004                 PIC X(4)  VALUE '5004'.
   116     12  ER-5005                 PIC X(4)  VALUE '5005'.
   117     12  ER-6508                 PIC X(4)  VALUE '6508'.
   118
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL658.cbl
   120
   121 01  STANDARD-AREAS.
   122     12  QID.
   123         16  QID-TERM        PIC X(4).
   124         16  FILLER          PIC X(4)    VALUE '658A'.
   125     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   126     12  QID-MAP-LENGTH      PIC S9(4)   VALUE +1376   COMP.
   127     12  MAP-NAME                PIC X(8)    VALUE 'EL658A'.
   128     12  MAPSET-NAME             PIC X(8)    VALUE 'EL658S'.
   129     12  TRANS-ID                PIC X(4)    VALUE 'EXJ3'.
   130     12  EL642-TRANS-ID          PIC X(4)    VALUE 'EXH7'.
   131     12  EL650-TRANS-ID          PIC X(4)    VALUE 'EXC4'.
   132     12  PGM-NAME                PIC X(8)    VALUE SPACES.
   133     12  THIS-PGM                PIC X(8)    VALUE 'EL658'.
   134     12  XCTL-642                PIC X(8)    VALUE 'EL642'.
   135     12  XCTL-650                PIC X(8)    VALUE 'EL650'.
   136     12  GXRF-FILE-ID            PIC X(8)    VALUE 'ERGXRF'.
   137     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   138     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   139     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   140     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   141     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   142     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   143     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   144     12  TIME-IN                 PIC S9(7).
   145     12  TIME-OUT-R   REDEFINES TIME-IN.
   146         16  FILLER              PIC X.
   147         16  TIME-OUT            PIC 99V99.
   148         16  FILLER              PIC X(2).
   149     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   150         88  BROWSE-STARTED      VALUE 'Y'.
   151
   152 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   153     12  GXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +32062.
   154     12  GXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   155
   156
   157 01  BLD-LINE.
   158     12  BL-ACCOUNT          PIC X(10).
   159     12  FILLER              PIC X         VALUE SPACE.
   160     12  BL-EFFECT           PIC X(8).
   161     12  FILLER              PIC X(3)      VALUE SPACE.
   162     12  BL-EXPIRE           PIC X(8).
   163     12  FILLER              PIC X(3)      VALUE SPACE.
   164     12  BL-LEVEL            PIC ZZ.
   165     12  FILLER              PIC X(5)      VALUE SPACE.
   166     12  BL-LAST-BILL        PIC X(8).
   167     12  FILLER              PIC X(6)      VALUE SPACE.
   168     12  BL-OCCURRENCE       PIC ZZ,ZZZ.
   169     12  FILLER              PIC X(6)      VALUE SPACE.
   170     12  BL-STATE            PIC XX.
   171
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL658.cbl
   173*                            COPY ELCDATE.
   174******************************************************************
   175*                                                                *
   176*                                                                *
   177*                            ELCDATE.                            *
   178*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   179*                            VMOD=2.003
   180*                                                                *
   181*                                                                *
   182*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   183*                 LENGTH = 200                                   *
   184******************************************************************
   185
   186 01  DATE-CONVERSION-DATA.
   187     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   188     12  DC-OPTION-CODE                PIC X.
   189         88  BIN-TO-GREG                VALUE ' '.
   190         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   191         88  EDIT-GREG-TO-BIN           VALUE '2'.
   192         88  YMD-GREG-TO-BIN            VALUE '3'.
   193         88  MDY-GREG-TO-BIN            VALUE '4'.
   194         88  JULIAN-TO-BIN              VALUE '5'.
   195         88  BIN-PLUS-ELAPSED           VALUE '6'.
   196         88  FIND-CENTURY               VALUE '7'.
   197         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   198         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   199         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   200         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   201         88  JULIAN-TO-BIN-3            VALUE 'C'.
   202         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   203         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   204         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   205         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   206         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   207         88  CHECK-LEAP-YEAR            VALUE 'H'.
   208         88  BIN-3-TO-GREG              VALUE 'I'.
   209         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   210         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   211         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   212         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   213         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   214         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   215         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   216         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   217         88  THREE-CHARACTER-BIN
   218                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   219         88  GREGORIAN-TO-BIN
   220                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   221         88  BIN-TO-GREGORIAN
   222                  VALUES ' ' '1' 'I' '8' 'G'.
   223         88  JULIAN-TO-BINARY
   224                  VALUES '5' 'C' 'E' 'F'.
   225     12  DC-ERROR-CODE                 PIC X.
   226         88  NO-CONVERSION-ERROR        VALUE ' '.
   227         88  DATE-CONVERSION-ERROR
   228                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   229         88  DATE-IS-ZERO               VALUE '1'.
   230         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL658.cbl
   231         88  DATE-IS-INVALID            VALUE '3'.
   232         88  DATE1-GREATER-DATE2        VALUE '4'.
   233         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   234         88  DATE-INVALID-OPTION        VALUE '9'.
   235         88  INVALID-CENTURY            VALUE 'A'.
   236         88  ONLY-CENTURY               VALUE 'B'.
   237         88  ONLY-LEAP-YEAR             VALUE 'C'.
   238         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   239     12  DC-END-OF-MONTH               PIC X.
   240         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   241     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   242         88  USE-NORMAL-PROCESS         VALUE ' '.
   243         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   244         88  ADJUST-UP-100-YRS          VALUE '2'.
   245     12  FILLER                        PIC X.
   246     12  DC-CONVERSION-DATES.
   247         16  DC-BIN-DATE-1             PIC XX.
   248         16  DC-BIN-DATE-2             PIC XX.
   249         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   250         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   251                       DC-GREG-DATE-1-EDIT.
   252             20  DC-EDIT1-MONTH        PIC 99.
   253             20  SLASH1-1              PIC X.
   254             20  DC-EDIT1-DAY          PIC 99.
   255             20  SLASH1-2              PIC X.
   256             20  DC-EDIT1-YEAR         PIC 99.
   257         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   258         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   259                     DC-GREG-DATE-2-EDIT.
   260             20  DC-EDIT2-MONTH        PIC 99.
   261             20  SLASH2-1              PIC X.
   262             20  DC-EDIT2-DAY          PIC 99.
   263             20  SLASH2-2              PIC X.
   264             20  DC-EDIT2-YEAR         PIC 99.
   265         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   266         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   267                     DC-GREG-DATE-1-YMD.
   268             20  DC-YMD-YEAR           PIC 99.
   269             20  DC-YMD-MONTH          PIC 99.
   270             20  DC-YMD-DAY            PIC 99.
   271         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   272         16  DC-GREG-DATE-1-MDY-R REDEFINES
   273                      DC-GREG-DATE-1-MDY.
   274             20  DC-MDY-MONTH          PIC 99.
   275             20  DC-MDY-DAY            PIC 99.
   276             20  DC-MDY-YEAR           PIC 99.
   277         16  DC-GREG-DATE-1-ALPHA.
   278             20  DC-ALPHA-MONTH        PIC X(10).
   279             20  DC-ALPHA-DAY          PIC 99.
   280             20  FILLER                PIC XX.
   281             20  DC-ALPHA-CENTURY.
   282                 24 DC-ALPHA-CEN-N     PIC 99.
   283             20  DC-ALPHA-YEAR         PIC 99.
   284         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   285         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   286         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   287         16  DC-JULIAN-DATE            PIC 9(05).
   288         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL658.cbl
   289                                       PIC 9(05).
   290         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   291             20  DC-JULIAN-YEAR        PIC 99.
   292             20  DC-JULIAN-DAYS        PIC 999.
   293         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   294         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   295         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   296     12  DATE-CONVERSION-VARIBLES.
   297         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   298         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   299             20  FILLER                PIC 9(3).
   300             20  HOLD-CEN-1-CCYY.
   301                 24  HOLD-CEN-1-CC     PIC 99.
   302                 24  HOLD-CEN-1-YY     PIC 99.
   303             20  HOLD-CEN-1-MO         PIC 99.
   304             20  HOLD-CEN-1-DA         PIC 99.
   305         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   306             20  HOLD-CEN-1-R-MO       PIC 99.
   307             20  HOLD-CEN-1-R-DA       PIC 99.
   308             20  HOLD-CEN-1-R-CCYY.
   309                 24  HOLD-CEN-1-R-CC   PIC 99.
   310                 24  HOLD-CEN-1-R-YY   PIC 99.
   311             20  FILLER                PIC 9(3).
   312         16  HOLD-CENTURY-1-X.
   313             20  FILLER                PIC X(3)  VALUE SPACES.
   314             20  HOLD-CEN-1-X-CCYY.
   315                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   316                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   317             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   318             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   319         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   320             20  HOLD-CEN-1-R-X-MO     PIC XX.
   321             20  HOLD-CEN-1-R-X-DA     PIC XX.
   322             20  HOLD-CEN-1-R-X-CCYY.
   323                 24  HOLD-CEN-1-R-X-CC PIC XX.
   324                 24  HOLD-CEN-1-R-X-YY PIC XX.
   325             20  FILLER                PIC XXX.
   326         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   327         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   328         16  DC-JULIAN-DATE-1          PIC 9(07).
   329         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   330             20  DC-JULIAN-1-CCYY.
   331                 24  DC-JULIAN-1-CC    PIC 99.
   332                 24  DC-JULIAN-1-YR    PIC 99.
   333             20  DC-JULIAN-DA-1        PIC 999.
   334         16  DC-JULIAN-DATE-2          PIC 9(07).
   335         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   336             20  DC-JULIAN-2-CCYY.
   337                 24  DC-JULIAN-2-CC    PIC 99.
   338                 24  DC-JULIAN-2-YR    PIC 99.
   339             20  DC-JULIAN-DA-2        PIC 999.
   340         16  DC-GREG-DATE-A-EDIT.
   341             20  DC-EDITA-MONTH        PIC 99.
   342             20  SLASHA-1              PIC X VALUE '/'.
   343             20  DC-EDITA-DAY          PIC 99.
   344             20  SLASHA-2              PIC X VALUE '/'.
   345             20  DC-EDITA-CCYY.
   346                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL658.cbl
   347                 24  DC-EDITA-YEAR     PIC 99.
   348         16  DC-GREG-DATE-B-EDIT.
   349             20  DC-EDITB-MONTH        PIC 99.
   350             20  SLASHB-1              PIC X VALUE '/'.
   351             20  DC-EDITB-DAY          PIC 99.
   352             20  SLASHB-2              PIC X VALUE '/'.
   353             20  DC-EDITB-CCYY.
   354                 24  DC-EDITB-CENT     PIC 99.
   355                 24  DC-EDITB-YEAR     PIC 99.
   356         16  DC-GREG-DATE-CYMD         PIC 9(08).
   357         16  DC-GREG-DATE-CYMD-R REDEFINES
   358                              DC-GREG-DATE-CYMD.
   359             20  DC-CYMD-CEN           PIC 99.
   360             20  DC-CYMD-YEAR          PIC 99.
   361             20  DC-CYMD-MONTH         PIC 99.
   362             20  DC-CYMD-DAY           PIC 99.
   363         16  DC-GREG-DATE-MDCY         PIC 9(08).
   364         16  DC-GREG-DATE-MDCY-R REDEFINES
   365                              DC-GREG-DATE-MDCY.
   366             20  DC-MDCY-MONTH         PIC 99.
   367             20  DC-MDCY-DAY           PIC 99.
   368             20  DC-MDCY-CEN           PIC 99.
   369             20  DC-MDCY-YEAR          PIC 99.
   370    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   371        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   372    12  DC-EL310-DATE                  PIC X(21).
   373    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL658.cbl
   375*                                   COPY ELCEMIB SUPPRESS.
   376******************************************************************
   377*                                                                *
   378*                                                                *
   379*                            ELCEMIB.                            *
   380*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   381*                            VMOD=2.005                          *
   382*                                                                *
   383*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   384*                                                                *
   385******************************************************************
   386 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   387     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   388     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   389     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   390     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   391     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   392     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   393     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   394     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   395     12  EMI-SWITCH1             PIC X        VALUE '1'.
   396         88  EMI-NO-ERRORS                    VALUE '1'.
   397         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   398         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   399     12  EMI-SWITCH2             PIC X        VALUE '1'.
   400         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   401     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   402         88  EMI-AREA1-EMPTY                  VALUE '1'.
   403         88  EMI-AREA1-FULL                   VALUE '2'.
   404     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   405         88  EMI-AREA2-EMPTY                  VALUE '1'.
   406         88  EMI-AREA2-FULL                   VALUE '2'.
   407     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   408         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   409         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   410         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   411         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   412         88  EMI-BYPASS-FATALS                VALUE 'X'.
   413     12  EMI-ERROR-LINES.
   414         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   415         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   416         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   417         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   418             20  EMI-ERR-CODES OCCURS 10 TIMES.
   419                 24  EMI-ERR-NUM         PIC X(4).
   420                 24  EMI-FILLER          PIC X.
   421                 24  EMI-SEV             PIC X.
   422                 24  FILLER              PIC X.
   423             20  FILLER                  PIC X(02).
   424     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   425         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   426             20  EMI-ERROR-NUMBER    PIC X(4).
   427             20  EMI-FILL            PIC X.
   428             20  EMI-SEVERITY        PIC X.
   429             20  FILLER              PIC X.
   430             20  EMI-ERROR-TEXT.
   431                 24  EMI-TEXT-VARIABLE   PIC X(10).
   432                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL658.cbl
   433     12  EMI-SEVERITY-SAVE           PIC X.
   434         88  EMI-NOTE                    VALUE 'N'.
   435         88  EMI-WARNING                 VALUE 'W'.
   436         88  EMI-FORCABLE                VALUE 'F'.
   437         88  EMI-FATAL                   VALUE 'X'.
   438     12  EMI-MESSAGE-FLAG            PIC X.
   439         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   440         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   441     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   442     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   443         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   444         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   445         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   446     12  FILLER                      PIC X(137)  VALUE SPACES.
   447     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   448     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   449     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   450     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   451
   452*                  COPY ELCLOGOF SUPPRESS.
   453******************************************************************
   454*                                                                *
   455*                                                                *
   456*                            ELCLOGOF.                           *
   457*                            VMOD=2.001                          *
   458*                                                                *
   459*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   460*                                                                *
   461******************************************************************
   462 01  CLASIC-LOGOFF.
   463     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   464     12  LOGOFF-TEXT.
   465         16  FILLER          PIC X(5)    VALUE SPACES.
   466         16  LOGOFF-MSG.
   467             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   468             20  FILLER      PIC X       VALUE SPACES.
   469             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   470         16  FILLER          PIC X(80)
   471           VALUE '* YOU ARE NOW LOGGED OFF'.
   472         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   473         16  FILLER          PIC X       VALUE QUOTE.
   474         16  LOGOFF-SYS-MSG  PIC X(17)
   475           VALUE 'S CLAS-IC SYSTEM '.
   476     12  TEXT-MESSAGES.
   477         16  UNACCESS-MSG    PIC X(29)
   478             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   479         16  PGMIDERR-MSG    PIC X(17)
   480             VALUE 'PROGRAM NOT FOUND'.
   481
   482*                                    COPY ELCINTF.
   483******************************************************************
   484*                                                                *
   485*                                                                *
   486*                            ELCINTF.                            *
   487*                            VMOD=2.017                          *
   488*                                                                *
   489*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   490*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL658.cbl
   491*       LENGTH = 1024                                            *
   492*                                                                *
   493******************************************************************
   494 01  PROGRAM-INTERFACE-BLOCK.
   495     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   496     12  PI-CALLING-PROGRAM              PIC X(8).
   497     12  PI-SAVED-PROGRAM-1              PIC X(8).
   498     12  PI-SAVED-PROGRAM-2              PIC X(8).
   499     12  PI-SAVED-PROGRAM-3              PIC X(8).
   500     12  PI-SAVED-PROGRAM-4              PIC X(8).
   501     12  PI-SAVED-PROGRAM-5              PIC X(8).
   502     12  PI-SAVED-PROGRAM-6              PIC X(8).
   503     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   504     12  PI-COMPANY-ID                   PIC XXX.
   505     12  PI-COMPANY-CD                   PIC X.
   506
   507     12  PI-COMPANY-PASSWORD             PIC X(8).
   508
   509     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   510
   511     12  PI-CONTROL-IN-PROGRESS.
   512         16  PI-CARRIER                  PIC X.
   513         16  PI-GROUPING                 PIC X(6).
   514         16  PI-STATE                    PIC XX.
   515         16  PI-ACCOUNT                  PIC X(10).
   516         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   517                                         PIC X(10).
   518         16  PI-CLAIM-CERT-GRP.
   519             20  PI-CLAIM-NO             PIC X(7).
   520             20  PI-CERT-NO.
   521                 25  PI-CERT-PRIME       PIC X(10).
   522                 25  PI-CERT-SFX         PIC X.
   523             20  PI-CERT-EFF-DT          PIC XX.
   524         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   525             20  PI-PLAN-CODE            PIC X(2).
   526             20  PI-REVISION-NUMBER      PIC X(3).
   527             20  PI-PLAN-EFF-DT          PIC X(2).
   528             20  PI-PLAN-EXP-DT          PIC X(2).
   529             20  FILLER                  PIC X(11).
   530         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   531             20  PI-OE-REFERENCE-1.
   532                 25  PI-OE-REF-1-PRIME   PIC X(18).
   533                 25  PI-OE-REF-1-SUFF    PIC XX.
   534
   535     12  PI-SESSION-IN-PROGRESS          PIC X.
   536         88  CLAIM-SESSION                   VALUE '1'.
   537         88  CREDIT-SESSION                  VALUE '2'.
   538         88  WARRANTY-SESSION                VALUE '3'.
   539         88  MORTGAGE-SESSION                VALUE '4'.
   540         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   541
   542
   543*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   544
   545     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   546     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   547
   548     12  PI-CREDIT-USER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL658.cbl
   549         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   550         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   551
   552     12  PI-CLAIM-USER                   PIC X.
   553         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   554         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   555
   556     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   557         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   558         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   559         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   560         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   561         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   562
   563     12  PI-PROCESSOR-ID                 PIC X(4).
   564
   565     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   566
   567     12  PI-MEMBER-CAPTION               PIC X(10).
   568
   569     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   570         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   571
   572     12  PI-LIFE-OVERRIDE-L1             PIC X.
   573     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   574     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   575     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   576
   577     12  PI-AH-OVERRIDE-L1               PIC X.
   578     12  PI-AH-OVERRIDE-L2               PIC XX.
   579     12  PI-AH-OVERRIDE-L6               PIC X(6).
   580     12  PI-AH-OVERRIDE-L12              PIC X(12).
   581
   582     12  PI-NEW-SYSTEM                   PIC X(2).
   583
   584     12  PI-PRIMARY-CERT-NO              PIC X(11).
   585     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   586         88  PI-USES-PAID-TO                 VALUE '1'.
   587     12  PI-CRDTCRD-SYSTEM.
   588         16  PI-CRDTCRD-USER             PIC X.
   589             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   590             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   591         16  PI-CC-MONTH-END-DT          PIC XX.
   592     12  PI-PROCESSOR-PRINTER            PIC X(4).
   593
   594     12  PI-OE-REFERENCE-2.
   595         16  PI-OE-REF-2-PRIME           PIC X(10).
   596         16  PI-OE-REF-2-SUFF            PIC X.
   597
   598     12  PI-REM-TRM-CALC-OPTION          PIC X.
   599
   600     12  PI-LANGUAGE-TYPE                PIC X.
   601             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   602             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   603             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   604
   605     12  PI-POLICY-LINKAGE-IND           PIC X.
   606         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL658.cbl
   607         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   608                                                   LOW-VALUES.
   609
   610     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   611     12  PI-CLAIM-PW-SESSION             PIC X(1).
   612         88  PI-CLAIM-CREDIT                 VALUE '1'.
   613         88  PI-CLAIM-CONVEN                 VALUE '2'.
   614     12  FILLER                          PIC X(4).
   615
   616     12  PI-SYSTEM-LEVEL                 PIC X(145).
   617
   618     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   619         PI-SYSTEM-LEVEL.
   620
   621         16  PI-ENTRY-CODES.
   622             20  PI-ENTRY-CD-1           PIC X.
   623             20  PI-ENTRY-CD-2           PIC X.
   624
   625         16  PI-RETURN-CODES.
   626             20  PI-RETURN-CD-1          PIC X.
   627             20  PI-RETURN-CD-2          PIC X.
   628
   629         16  PI-UPDATE-STATUS-SAVE.
   630             20  PI-UPDATE-BY            PIC X(4).
   631             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   632
   633         16  PI-LOWER-CASE-LETTERS       PIC X.
   634             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   635
   636*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   637*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   638*            88  CARRIER-CLM-CNTL            VALUE '2'.
   639
   640         16  PI-CERT-ACCESS-CONTROL      PIC X.
   641             88  ST-ACCNT-CNTL               VALUE ' '.
   642             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   643             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   644             88  ACCNT-CNTL                  VALUE '3'.
   645             88  CARR-ACCNT-CNTL             VALUE '4'.
   646
   647         16  PI-PROCESSOR-CAP-LIST.
   648             20  PI-SYSTEM-CONTROLS.
   649                24 PI-SYSTEM-DISPLAY     PIC X.
   650                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   651                24 PI-SYSTEM-MODIFY      PIC X.
   652                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   653             20  FILLER                  PIC XX.
   654             20  PI-DISPLAY-CAP          PIC X.
   655                 88  DISPLAY-CAP             VALUE 'Y'.
   656             20  PI-MODIFY-CAP           PIC X.
   657                 88  MODIFY-CAP              VALUE 'Y'.
   658             20  PI-MSG-AT-LOGON-CAP     PIC X.
   659                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   660             20  PI-FORCE-CAP            PIC X.
   661                 88  FORCE-CAP               VALUE 'Y'.
   662
   663         16  PI-PROGRAM-CONTROLS.
   664             20  PI-PGM-PRINT-OPT        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL658.cbl
   665             20  PI-PGM-FORMAT-OPT       PIC X.
   666             20  PI-PGM-PROCESS-OPT      PIC X.
   667             20  PI-PGM-TOTALS-OPT       PIC X.
   668
   669         16  PI-HELP-INTERFACE.
   670             20  PI-LAST-ERROR-NO        PIC X(4).
   671             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   672
   673         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   674             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   675
   676         16  PI-CR-CONTROL-IN-PROGRESS.
   677             20  PI-CR-CARRIER           PIC X.
   678             20  PI-CR-GROUPING          PIC X(6).
   679             20  PI-CR-STATE             PIC XX.
   680             20  PI-CR-ACCOUNT           PIC X(10).
   681             20  PI-CR-FIN-RESP          PIC X(10).
   682             20  PI-CR-TYPE              PIC X.
   683
   684         16  PI-CR-BATCH-NUMBER          PIC X(6).
   685
   686         16  PI-CR-MONTH-END-DT          PIC XX.
   687
   688         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   689             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   690             88  PI-ZERO-CARRIER             VALUE '1'.
   691             88  PI-ZERO-GROUPING            VALUE '2'.
   692             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   693
   694         16  PI-CARRIER-SECURITY         PIC X.
   695             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   696
   697         16  PI-ACCOUNT-SECURITY         PIC X(10).
   698             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   699             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   700
   701         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   702             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   703                                         INDEXED BY PI-ACCESS-NDX
   704                                         PIC X.
   705
   706         16  PI-GA-BILLING-CONTROL       PIC X.
   707             88  PI-GA-BILLING               VALUE '1'.
   708
   709         16  PI-MAIL-PROCESSING          PIC X.
   710             88  PI-MAIL-YES                 VALUE 'Y'.
   711
   712         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   713
   714         16  PI-AR-SYSTEM.
   715             20  PI-AR-PROCESSING-CNTL   PIC X.
   716                 88  PI-AR-PROCESSING        VALUE 'Y'.
   717             20  PI-AR-SUMMARY-CODE      PIC X(6).
   718             20  PI-AR-MONTH-END-DT      PIC XX.
   719
   720         16  PI-MP-SYSTEM.
   721             20  PI-MORTGAGE-USER            PIC X.
   722                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL658.cbl
   723                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   724             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   725                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   726                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   727                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   728                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   729                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   730             20  PI-MP-MONTH-END-DT          PIC XX.
   731             20  PI-MP-REFERENCE-NO.
   732                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   733                 24  PI-MP-REFERENCE-SFX     PIC XX.
   734
   735         16  PI-LABEL-CONTROL            PIC X(01).
   736             88  PI-CREATE-LABELS                    VALUE 'Y'.
   737             88  PI-BYPASS-LABELS                    VALUE 'N'.
   738
   739         16  PI-BILL-GROUPING-CODE       PIC X(01).
   740             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   741
   742         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   743             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   744             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   745
   746         16  FILLER                      PIC X(14).
   747
   748     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   749******************************************************************
   750     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   751         16  PI-ERGXRF-KEY.
   752             20  PI-GXRF-COMP-CD     PIC X.
   753             20  PI-GXRF-CARRIER     PIC X.
   754             20  PI-GXRF-GROUPING    PIC X(6).
   755             20  PI-GXRF-AGENT       PIC X(10).
   756         16  PI-NDX                  PIC S9(5)  COMP-3.
   757         16  PI-EOF-SW               PIC X.
   758             88  PI-FILE-EOF             VALUE 'Y'.
   759         16  FILLER                  PIC X(618).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL658.cbl
   761*                            COPY ELCAID SUPPRESS.
   762******************************************************************
   763*                                                                *
   764*                            ELCAID.                             *
   765*                            VMOD=2.001                          *
   766*                                                                *
   767*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   768*                                                                *
   769*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   770*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   771******************************************************************
   772
   773 01  DFHAID.
   774   02  DFHNULL   PIC  X  VALUE  ' '.
   775   02  DFHENTER  PIC  X  VALUE  QUOTE.
   776   02  DFHCLEAR  PIC  X  VALUE  '_'.
   777   02  DFHPEN    PIC  X  VALUE  '='.
   778   02  DFHOPID   PIC  X  VALUE  'W'.
   779   02  DFHPA1    PIC  X  VALUE  '%'.
   780   02  DFHPA2    PIC  X  VALUE  '>'.
   781   02  DFHPA3    PIC  X  VALUE  ','.
   782   02  DFHPF1    PIC  X  VALUE  '1'.
   783   02  DFHPF2    PIC  X  VALUE  '2'.
   784   02  DFHPF3    PIC  X  VALUE  '3'.
   785   02  DFHPF4    PIC  X  VALUE  '4'.
   786   02  DFHPF5    PIC  X  VALUE  '5'.
   787   02  DFHPF6    PIC  X  VALUE  '6'.
   788   02  DFHPF7    PIC  X  VALUE  '7'.
   789   02  DFHPF8    PIC  X  VALUE  '8'.
   790   02  DFHPF9    PIC  X  VALUE  '9'.
   791   02  DFHPF10   PIC  X  VALUE  ':'.
   792   02  DFHPF11   PIC  X  VALUE  '#'.
   793   02  DFHPF12   PIC  X  VALUE  '@'.
   794   02  DFHPF13   PIC  X  VALUE  'A'.
   795   02  DFHPF14   PIC  X  VALUE  'B'.
   796   02  DFHPF15   PIC  X  VALUE  'C'.
   797   02  DFHPF16   PIC  X  VALUE  'D'.
   798   02  DFHPF17   PIC  X  VALUE  'E'.
   799   02  DFHPF18   PIC  X  VALUE  'F'.
   800   02  DFHPF19   PIC  X  VALUE  'G'.
   801   02  DFHPF20   PIC  X  VALUE  'H'.
   802   02  DFHPF21   PIC  X  VALUE  'I'.
   803*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   804   02  DFHPF22   PIC  X  VALUE  '['.
   805   02  DFHPF23   PIC  X  VALUE  '.'.
   806   02  DFHPF24   PIC  X  VALUE  '<'.
   807   02  DFHMSRE   PIC  X  VALUE  'X'.
   808   02  DFHSTRF   PIC  X  VALUE  'h'.
   809   02  DFHTRIG   PIC  X  VALUE  '"'.
   810 01  FILLER    REDEFINES DFHAID.
   811     12  FILLER              PIC X(8).
   812     12  PF-VALUES           PIC X       OCCURS 24.
   813
   814*                            COPY EL658S.
   815 01  EL658AI.
   816     05  FILLER            PIC  X(0012).
   817*    -------------------------------
   818     05  TIMEL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL658.cbl
   819     05  TIMEF PIC  X(0001).
   820     05  FILLER REDEFINES TIMEF.
   821         10  TIMEA PIC  X(0001).
   822     05  TIMEI PIC  X(0005).
   823*    -------------------------------
   824     05  DATEL PIC S9(0004) COMP.
   825     05  DATEF PIC  X(0001).
   826     05  FILLER REDEFINES DATEF.
   827         10  DATEA PIC  X(0001).
   828     05  DATEI PIC  X(0008).
   829*    -------------------------------
   830     05  CARRIERL PIC S9(0004) COMP.
   831     05  CARRIERF PIC  X(0001).
   832     05  FILLER REDEFINES CARRIERF.
   833         10  CARRIERA PIC  X(0001).
   834     05  CARRIERI PIC  X(0001).
   835*    -------------------------------
   836     05  GROUPL PIC S9(0004) COMP.
   837     05  GROUPF PIC  X(0001).
   838     05  FILLER REDEFINES GROUPF.
   839         10  GROUPA PIC  X(0001).
   840     05  GROUPI PIC  X(0006).
   841*    -------------------------------
   842     05  AGENTL PIC S9(0004) COMP.
   843     05  AGENTF PIC  X(0001).
   844     05  FILLER REDEFINES AGENTF.
   845         10  AGENTA PIC  X(0001).
   846     05  AGENTI PIC  X(0010).
   847*    -------------------------------
   848     05  MAINTL PIC S9(0004) COMP.
   849     05  MAINTF PIC  X(0001).
   850     05  FILLER REDEFINES MAINTF.
   851         10  MAINTA PIC  X(0001).
   852     05  MAINTI PIC  X(0008).
   853*    -------------------------------
   854     05  TOTOPNL PIC S9(0004) COMP.
   855     05  TOTOPNF PIC  X(0001).
   856     05  FILLER REDEFINES TOTOPNF.
   857         10  TOTOPNA PIC  X(0001).
   858     05  TOTOPNI PIC  X(0005).
   859*    -------------------------------
   860     05  TOTOCCL PIC S9(0004) COMP.
   861     05  TOTOCCF PIC  X(0001).
   862     05  FILLER REDEFINES TOTOCCF.
   863         10  TOTOCCA PIC  X(0001).
   864     05  TOTOCCI PIC  X(0005).
   865     05  XRFLINED OCCURS 15  TIMES.
   866*    -------------------------------
   867         10  XRFLINEL PIC S9(0004) COMP.
   868         10  XRFLINEF PIC  X(0001).
   869         10  FILLER REDEFINES XRFLINEF.
   870             15  XRFLINEA PIC  X(0001).
   871         10  XRFLINEI PIC  X(0079).
   872*    -------------------------------
   873     05  ACCOCCL PIC S9(0004) COMP.
   874     05  ACCOCCF PIC  X(0001).
   875     05  FILLER REDEFINES ACCOCCF.
   876         10  ACCOCCA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL658.cbl
   877     05  ACCOCCI PIC  9(4).
   878*    -------------------------------
   879     05  ERRMSGL PIC S9(0004) COMP.
   880     05  ERRMSGF PIC  X(0001).
   881     05  FILLER REDEFINES ERRMSGF.
   882         10  ERRMSGA PIC  X(0001).
   883     05  ERRMSGI PIC  X(0076).
   884*    -------------------------------
   885     05  PFENTERL PIC S9(0004) COMP.
   886     05  PFENTERF PIC  X(0001).
   887     05  FILLER REDEFINES PFENTERF.
   888         10  PFENTERA PIC  X(0001).
   889     05  PFENTERI PIC  9(2).
   890 01  EL658AO REDEFINES EL658AI.
   891     05  FILLER            PIC  X(0012).
   892*    -------------------------------
   893     05  FILLER            PIC  X(0003).
   894     05  TIMEO PIC  99.99.
   895*    -------------------------------
   896     05  FILLER            PIC  X(0003).
   897     05  DATEO PIC  X(0008).
   898*    -------------------------------
   899     05  FILLER            PIC  X(0003).
   900     05  CARRIERO PIC  X(0001).
   901*    -------------------------------
   902     05  FILLER            PIC  X(0003).
   903     05  GROUPO PIC  X(0006).
   904*    -------------------------------
   905     05  FILLER            PIC  X(0003).
   906     05  AGENTO PIC  X(0010).
   907*    -------------------------------
   908     05  FILLER            PIC  X(0003).
   909     05  MAINTO PIC  X(0008).
   910*    -------------------------------
   911     05  FILLER            PIC  X(0003).
   912     05  TOTOPNO PIC  Z,ZZ9.
   913*    -------------------------------
   914     05  FILLER            PIC  X(0003).
   915     05  TOTOCCO PIC  Z,ZZ9.
   916*    -------------------------------
   917     05  XRFLINED OCCURS 15  TIMES.
   918         10  FILLER        PIC  X(0003).
   919         10  XRFLINEO PIC  X(0079).
   920*    -------------------------------
   921     05  FILLER            PIC  X(0003).
   922     05  ACCOCCO PIC  Z(4).
   923*    -------------------------------
   924     05  FILLER            PIC  X(0003).
   925     05  ERRMSGO PIC  X(0076).
   926*    -------------------------------
   927     05  FILLER            PIC  X(0003).
   928     05  PFENTERO PIC  X(0002).
   929*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL658.cbl
   931
   932*                            COPY ERCGXRF.
   933******************************************************************
   934*                                                                *
   935*                                                                *
   936*                            ERCGXRF                             *
   937*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   938*                            VMOD=2.002                          *
   939*                                                                *
   940*   ONLINE CREDIT SYSTEM                                         *
   941*                                                                *
   942*   FILE DESCRIPTION = GENERAL AGENT CROSS REFERENCE             *
   943*                                                                *
   944*   FILE TYPE = VSAM,KSDS                                        *
   945*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
   946*                                                                *
   947*   BASE CLUSTER NAME = ERGXRF                   RKP=2,LEN=18    *
   948*       ALTERNATE PATH = NONE                                    *
   949*                                                                *
   950*   LOG = NO                                                     *
   951*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   952*                                                                *
   953******************************************************************
   954
   955 01  AGENT-CROSS-REFERENCE.
   956     12  GX-RECORD-ID                PIC XX.
   957         88  VALID-GX-ID             VALUE 'GX'.
   958
   959     12  GX-CONTROL-PRIMARY.
   960         16  GX-COMPANY-CD           PIC X.
   961         16  GX-CARRIER              PIC X.
   962         16  GX-GROUPING             PIC X(6).
   963         16  GX-AGENT-NO             PIC X(10).
   964
   965     12  GX-MAINT-INFORMATION.
   966         16  GX-LAST-MAINT-DT        PIC XX.
   967         16  GX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
   968         16  GX-LAST-MAINT-USER      PIC X(4).
   969         16  FILLER                  PIC X(9).
   970
   971     12  FILLER                      PIC X(37).
   972
   973     12  GX-AGENT-POINTER-CNT        PIC S9(4)  COMP.
   974
   975     12  GX-AGENT-POINTER   OCCURS 1 TO 1006 TIMES
   976                            DEPENDING ON GX-AGENT-POINTER-CNT.
   977         16  GX-AM-CARRIER           PIC X.
   978         16  GX-AM-GROUPING          PIC X(6).
   979         16  GX-AM-STATE             PIC XX.
   980         16  GX-AM-ACCOUNT           PIC X(10).
   981         16  GX-AM-EXPIRATION-DT     PIC XX.
   982         16  GX-AM-LEVEL-NO          PIC S9(4)     COMP.
   983         16  GX-LAST-BILL-DT         PIC XX.
   984         16  GX-AM-EFF-DT            PIC XX.
   985         16  FILLER                  PIC X(4).
   986
   987******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL658.cbl
   989
   990****************************************************************
   991*
   992* Copyright (c) 2007 by Clerity Solutions, Inc.
   993* All rights reserved.
   994*
   995****************************************************************
   996 01  DFHEIV.
   997   02  DFHEIV0               PIC X(35).
   998   02  DFHEIV1               PIC X(08).
   999   02  DFHEIV2               PIC X(08).
  1000   02  DFHEIV3               PIC X(08).
  1001   02  DFHEIV4               PIC X(06).
  1002   02  DFHEIV5               PIC X(04).
  1003   02  DFHEIV6               PIC X(04).
  1004   02  DFHEIV7               PIC X(02).
  1005   02  DFHEIV8               PIC X(02).
  1006   02  DFHEIV9               PIC X(01).
  1007   02  DFHEIV10              PIC S9(7) COMP-3.
  1008   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1009   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1010   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1011   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1012   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1013   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1014   02  DFHEIV17              PIC X(04).
  1015   02  DFHEIV18              PIC X(04).
  1016   02  DFHEIV19              PIC X(04).
  1017   02  DFHEIV20              USAGE IS POINTER.
  1018   02  DFHEIV21              USAGE IS POINTER.
  1019   02  DFHEIV22              USAGE IS POINTER.
  1020   02  DFHEIV23              USAGE IS POINTER.
  1021   02  DFHEIV24              USAGE IS POINTER.
  1022   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1023   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1024   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1025   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1026   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1027   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1028   02  FILLER                PIC X(02).
  1029   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1030   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1031   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1032   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1033   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1034 LINKAGE  SECTION.
  1035*****************************************************************
  1036*                                                               *
  1037* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1038* All rights reserved.                                          *
  1039*                                                               *
  1040*****************************************************************
  1041 01  dfheiblk.
  1042     02  eibtime          pic s9(7) comp-3.
  1043     02  eibdate          pic s9(7) comp-3.
  1044     02  eibtrnid         pic x(4).
  1045     02  eibtaskn         pic s9(7) comp-3.
  1046     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL658.cbl
  1047     02  dfheigdi         pic s9(4) comp.
  1048     02  eibcposn         pic s9(4) comp.
  1049     02  eibcalen         pic s9(4) comp.
  1050     02  eibaid           pic x(1).
  1051     02  eibfiller1       pic x(1).
  1052     02  eibfn            pic x(2).
  1053     02  eibfiller2       pic x(2).
  1054     02  eibrcode         pic x(6).
  1055     02  eibfiller3       pic x(2).
  1056     02  eibds            pic x(8).
  1057     02  eibreqid         pic x(8).
  1058     02  eibrsrce         pic x(8).
  1059     02  eibsync          pic x(1).
  1060     02  eibfree          pic x(1).
  1061     02  eibrecv          pic x(1).
  1062     02  eibsend          pic x(1).
  1063     02  eibatt           pic x(1).
  1064     02  eibeoc           pic x(1).
  1065     02  eibfmh           pic x(1).
  1066     02  eibcompl         pic x(1).
  1067     02  eibsig           pic x(1).
  1068     02  eibconf          pic x(1).
  1069     02  eiberr           pic x(1).
  1070     02  eibrldbk         pic x(1).
  1071     02  eiberrcd         pic x(4).
  1072     02  eibsynrb         pic x(1).
  1073     02  eibnodat         pic x(1).
  1074     02  eibfiller5       pic x(2).
  1075     02  eibresp          pic 9(09) comp.
  1076     02  eibresp2         pic 9(09) comp.
  1077     02  dfheigdj         pic s9(4) comp.
  1078     02  dfheigdk         pic s9(4) comp.
  1079 01  DFHCOMMAREA             PIC X(1024).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL658.cbl
  1081 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1082 0000-DFHEXIT SECTION.
  1083     MOVE '9#                    $   ' TO DFHEIV0.
  1084     MOVE 'EL658' TO DFHEIV1.
  1085     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1086     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  1087
  1088     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1089     MOVE '5'                   TO DC-OPTION-CODE.
  1090     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  1091     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1092     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1093
  1094     MOVE EIBTRMID              TO QID-TERM.
  1095
  1096
  1097* EXEC CICS HANDLE CONDITION
  1098*        ERROR     (9990-ABEND)
  1099*        MAPFAIL   (8100-SEND-INITIAL-MAP)
  1100*        END-EXEC.
  1101*    MOVE '"$.?                  ! " #00001092' TO DFHEIV0
  1102     MOVE X'22242E3F2020202020202020' TO DFHEIV0(1:12)
  1103     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1104     MOVE X'2220233030303031303932' TO DFHEIV0(25:11)
  1105     CALL 'kxdfhei1' USING DFHEIV0
  1106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1107
  1108
  1109     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1110         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1111             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1112             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1113             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1114             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1115             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1116             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1117             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1118             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1119         ELSE
  1120             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1121             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1122             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1123             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1124             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1125             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1126             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1127             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  1128
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL658.cbl
  1130     IF EIBTRNID = TRANS-ID
  1131         IF EIBAID = DFHCLEAR
  1132             GO TO 9400-CLEAR
  1133         ELSE
  1134             GO TO 0200-RECEIVE-MAP.
  1135
  1136     IF EIBTRNID  = EL642-TRANS-ID
  1137         MOVE DFHENTER       TO EIBAID
  1138         MOVE PI-CR-CARRIER  TO CARRIERI
  1139         MOVE PI-CR-GROUPING TO GROUPI
  1140         MOVE PI-CR-FIN-RESP TO AGENTI
  1141         MOVE 1              TO CARRIERL
  1142         MOVE 6              TO GROUPL
  1143         MOVE 10             TO AGENTL
  1144         MOVE AL-UANON       TO CARRIERA GROUPA AGENTA
  1145         GO TO 1000-EDIT-INPUT.
  1146
  1147     MOVE LOW-VALUES       TO PI-ERGXRF-KEY    EL658AI.
  1148     MOVE PI-COMPANY-CD    TO PI-GXRF-COMP-CD  WS-COMPANY-CD.
  1149
  1150     IF EIBTRNID  = EL650-TRANS-ID
  1151         GO TO 0600-RECOVER-TEMP-STORAGE.
  1152
  1153     GO TO 8100-SEND-INITIAL-MAP.
  1154
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL658.cbl
  1156
  1157 0200-RECEIVE-MAP.
  1158     MOVE LOW-VALUES TO EL658AI.
  1159
  1160
  1161* EXEC CICS RECEIVE
  1162*        MAP (MAP-NAME)
  1163*        MAPSET (MAPSET-NAME)
  1164*        INTO (EL658AI)
  1165*        END-EXEC.
  1166     MOVE LENGTH OF
  1167      EL658AI
  1168       TO DFHEIV11
  1169*    MOVE '8"T I  L              ''   #00001148' TO DFHEIV0
  1170     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1171     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1172     MOVE X'2020233030303031313438' TO DFHEIV0(25:11)
  1173     CALL 'kxdfhei1' USING DFHEIV0,
  1174           MAP-NAME,
  1175           EL658AI,
  1176           DFHEIV11,
  1177           MAPSET-NAME,
  1178           DFHEIV99,
  1179           DFHEIV99
  1180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1181
  1182
  1183     IF PFENTERL = 0
  1184         GO TO 0300-CHECK-PFKEYS.
  1185     IF EIBAID NOT = DFHENTER
  1186         MOVE ER-0004 TO EMI-ERROR
  1187         GO TO 0320-INPUT-ERROR.
  1188     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  1189         MOVE PF-VALUES (PFENTERI) TO EIBAID
  1190     ELSE
  1191         MOVE ER-0029 TO EMI-ERROR
  1192         GO TO 0320-INPUT-ERROR.
  1193
  1194 0300-CHECK-PFKEYS.
  1195     IF EIBAID = DFHPF1 OR DFHPF2
  1196         GO TO 5000-BROWSE-FILE.
  1197
  1198     IF EIBAID = DFHPF3 OR DFHPF4
  1199         GO TO 6000-OCCURRENCE.
  1200
  1201     IF EIBAID = DFHPF5
  1202         GO TO 4000-ACCT-MAINT.
  1203
  1204     IF EIBAID = DFHENTER
  1205         GO TO 1000-EDIT-INPUT.
  1206
  1207     IF EIBAID = DFHPF12
  1208         GO TO 9500-PF12.
  1209
  1210     IF EIBAID = DFHPF23
  1211         GO TO 8810-PF23.
  1212
  1213     IF EIBAID = DFHPF24
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL658.cbl
  1214         GO TO 9200-RETURN-MAIN-MENU.
  1215
  1216     MOVE ER-0029                TO EMI-ERROR.
  1217 0320-INPUT-ERROR.
  1218     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1219     MOVE -1                     TO CARRIERL.
  1220     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL658.cbl
  1222 0500-CREATE-TEMP-STORAGE.
  1223
  1224
  1225* EXEC CICS WRITEQ TS
  1226*        QUEUE   (QID)
  1227*        FROM    (EL658AI)
  1228*        LENGTH  (QID-MAP-LENGTH)
  1229*        END-EXEC.
  1230*    MOVE '*"                    ''   #00001195' TO DFHEIV0
  1231     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  1232     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1233     MOVE X'2020233030303031313935' TO DFHEIV0(25:11)
  1234     CALL 'kxdfhei1' USING DFHEIV0,
  1235           QID,
  1236           EL658AI,
  1237           QID-MAP-LENGTH,
  1238           DFHEIV99,
  1239           DFHEIV99,
  1240           DFHEIV99
  1241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1242
  1243
  1244 0599-EXIT.
  1245      EXIT.
  1246
  1247 0600-RECOVER-TEMP-STORAGE.
  1248
  1249
  1250* EXEC CICS HANDLE CONDITION
  1251*        NOTFND  (1500-GXRF-NOT-FOUND)
  1252*        QIDERR  (0690-QIDERR)
  1253*        END-EXEC.
  1254*    MOVE '"$IN                  ! # #00001206' TO DFHEIV0
  1255     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  1256     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1257     MOVE X'2320233030303031323036' TO DFHEIV0(25:11)
  1258     CALL 'kxdfhei1' USING DFHEIV0
  1259     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1260
  1261
  1262
  1263* EXEC CICS READQ TS
  1264*        QUEUE    (QID)
  1265*        INTO     (EL658AI)
  1266*        LENGTH   (QID-MAP-LENGTH)
  1267*        END-EXEC.
  1268*    MOVE '*$I    L              ''   #00001211' TO DFHEIV0
  1269     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  1270     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1271     MOVE X'2020233030303031323131' TO DFHEIV0(25:11)
  1272     CALL 'kxdfhei1' USING DFHEIV0,
  1273           QID,
  1274           EL658AI,
  1275           QID-MAP-LENGTH,
  1276           DFHEIV99,
  1277           DFHEIV99,
  1278           DFHEIV99
  1279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL658.cbl
  1280
  1281
  1282
  1283* EXEC CICS DELETEQ TS
  1284*        QUEUE   (QID)
  1285*        END-EXEC.
  1286*    MOVE '*&                    #   #00001217' TO DFHEIV0
  1287     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  1288     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1289     MOVE X'2020233030303031323137' TO DFHEIV0(25:11)
  1290     CALL 'kxdfhei1' USING DFHEIV0,
  1291           QID,
  1292           DFHEIV99
  1293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1294
  1295
  1296     IF CARRIERL NOT = 0
  1297         MOVE AL-UANON TO CARRIERA.
  1298
  1299     IF GROUPL NOT = 0
  1300         MOVE AL-UANON TO GROUPA.
  1301
  1302     IF AGENTL NOT = 0
  1303         MOVE AL-UANON TO AGENTA.
  1304
  1305     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD.
  1306     MOVE CARRIERO               TO WS-CARRIER.
  1307     MOVE GROUPO                 TO WS-GROUPING.
  1308     MOVE AGENTO                 TO WS-AGENT.
  1309
  1310     GO TO 1050-READ-GA.
  1311
  1312 0690-QIDERR.
  1313     MOVE ER-0033 TO EMI-ERROR.
  1314     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1315     GO TO 8100-SEND-INITIAL-MAP.
  1316
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL658.cbl
  1318
  1319 1000-EDIT-INPUT.
  1320     IF CARRIERL NOT = ZEROS
  1321         MOVE CARRIERI           TO WS-CARRIER
  1322       ELSE
  1323         MOVE ER-0234            TO EMI-ERROR
  1324         MOVE -1                 TO CARRIERL
  1325         MOVE AL-UABON           TO CARRIERA
  1326         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1327
  1328     IF GROUPL NOT = ZEROS
  1329         MOVE GROUPI             TO WS-GROUPING
  1330       ELSE
  1331         MOVE ER-0235            TO EMI-ERROR
  1332         MOVE -1                 TO GROUPL
  1333         MOVE AL-UABON           TO GROUPA
  1334         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1335
  1336     IF AGENTL NOT = ZEROS
  1337         MOVE AGENTI             TO WS-AGENT
  1338       ELSE
  1339         MOVE ER-6508            TO EMI-ERROR
  1340         MOVE -1                 TO AGENTL
  1341         MOVE AL-UABON           TO AGENTA
  1342         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1343
  1344     IF NOT EMI-NO-ERRORS
  1345         GO TO 8200-SEND-DATAONLY.
  1346
  1347     MOVE PI-COMPANY-CD   TO WS-COMPANY-CD.
  1348
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL658.cbl
  1350 1050-READ-GA.
  1351
  1352* EXEC CICS HANDLE CONDITION
  1353*        NOTFND (1500-GXRF-NOT-FOUND) END-EXEC.
  1354*    MOVE '"$I                   ! $ #00001276' TO DFHEIV0
  1355     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  1356     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1357     MOVE X'2420233030303031323736' TO DFHEIV0(25:11)
  1358     CALL 'kxdfhei1' USING DFHEIV0
  1359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1360
  1361
  1362     MOVE GXRF-MAX-REC-LENGTH    TO GXRF-REC-LENGTH.
  1363
  1364
  1365* EXEC CICS READ
  1366*         INTO    (AGENT-CROSS-REFERENCE)
  1367*         DATASET ('ERGXRF')
  1368*         LENGTH  (GXRF-REC-LENGTH)
  1369*         RIDFLD  (WS-CONTROL-PRIMARY)
  1370*         END-EXEC.
  1371     MOVE 'ERGXRF' TO DFHEIV1
  1372*    MOVE '&"IL       E          (   #00001281' TO DFHEIV0
  1373     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1374     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1375     MOVE X'2020233030303031323831' TO DFHEIV0(25:11)
  1376     CALL 'kxdfhei1' USING DFHEIV0,
  1377           DFHEIV1,
  1378           AGENT-CROSS-REFERENCE,
  1379           GXRF-REC-LENGTH,
  1380           WS-CONTROL-PRIMARY,
  1381           DFHEIV99,
  1382           DFHEIV99,
  1383           DFHEIV99
  1384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1385
  1386
  1387
  1388     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
  1389
  1390     MOVE +1 TO PI-NDX.
  1391     GO TO 5200-FORMAT-SCREEN.
  1392
  1393 1500-GXRF-NOT-FOUND.
  1394     MOVE ER-0142            TO EMI-ERROR.
  1395     MOVE -1                 TO CARRIERL.
  1396     MOVE AL-UABON           TO CARRIERA.
  1397     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1398     IF EIBTRNID  = EL642-TRANS-ID
  1399         GO TO 8100-SEND-INITIAL-MAP
  1400     ELSE
  1401         GO TO 8200-SEND-DATAONLY.
  1402
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL658.cbl
  1404
  1405 3000-BLD-LINE.
  1406     MOVE 1  TO NDX.
  1407     MOVE SPACES TO XRFLINEO (1) XRFLINEO (2) XRFLINEO (3)
  1408                    XRFLINEO (4) XRFLINEO (5) XRFLINEO (6)
  1409                    XRFLINEO (7) XRFLINEO (8) XRFLINEO (9)
  1410                    XRFLINEO (10) XRFLINEO (11) XRFLINEO (12)
  1411                    XRFLINEO (13) XRFLINEO (14) XRFLINEO (15)
  1412                                  BLD-LINE.
  1413 3000-BLD-LINE-LOOP.
  1414     IF PI-NDX GREATER THAN GX-AGENT-POINTER-CNT
  1415          GO TO 3000-XIT.
  1416
  1417     MOVE GX-AM-ACCOUNT (PI-NDX) TO BL-ACCOUNT.
  1418
  1419     IF GX-AM-EFF-DT (PI-NDX) NOT = SPACES AND LOW-VALUES
  1420         MOVE GX-AM-EFF-DT (PI-NDX) TO DC-BIN-DATE-1
  1421         MOVE SPACE                        TO DC-OPTION-CODE
  1422         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  1423         MOVE DC-GREG-DATE-1-EDIT       TO BL-EFFECT.
  1424
  1425     IF GX-AM-EXPIRATION-DT (PI-NDX) NOT = SPACES AND LOW-VALUES
  1426         MOVE GX-AM-EXPIRATION-DT (PI-NDX) TO DC-BIN-DATE-1
  1427         MOVE SPACE                        TO DC-OPTION-CODE
  1428         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  1429         MOVE DC-GREG-DATE-1-EDIT       TO BL-EXPIRE.
  1430
  1431     IF GX-AM-EXPIRATION-DT (PI-NDX) = HIGH-VALUES
  1432         MOVE '99/99/99'                TO BL-EXPIRE.
  1433
  1434     MOVE GX-AM-LEVEL-NO (PI-NDX)       TO BL-LEVEL.
  1435
  1436     IF GX-LAST-BILL-DT (PI-NDX) NOT = SPACES AND LOW-VALUES
  1437         MOVE GX-LAST-BILL-DT (PI-NDX) TO DC-BIN-DATE-1
  1438         MOVE SPACE                 TO DC-OPTION-CODE
  1439         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  1440         MOVE DC-GREG-DATE-1-EDIT   TO BL-LAST-BILL.
  1441
  1442     MOVE PI-NDX                    TO BL-OCCURRENCE.
  1443     MOVE GX-AM-STATE (PI-NDX)      TO BL-STATE.
  1444
  1445     MOVE BLD-LINE                  TO XRFLINEO (NDX).
  1446     MOVE SPACES                    TO BLD-LINE.
  1447
  1448     IF (PI-NDX = GX-AGENT-POINTER-CNT)  OR  (NDX = 15)
  1449          GO TO 3000-XIT.
  1450     ADD  1 TO PI-NDX NDX.
  1451     GO TO 3000-BLD-LINE-LOOP.
  1452
  1453 3000-XIT.
  1454     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL658.cbl
  1456 4000-ACCT-MAINT.
  1457     IF CARRIERI NOT = PI-GXRF-CARRIER   OR
  1458        GROUPI   NOT = PI-GXRF-GROUPING  OR
  1459        AGENTI   NOT = PI-GXRF-AGENT
  1460           MOVE ER-5005 TO EMI-ERROR
  1461           GO TO 4050-ERR.
  1462
  1463     IF ACCOCCI NOT NUMERIC
  1464        GO TO 4010-ERROR.
  1465
  1466     MOVE PI-COMPANY-CD      TO WS-COMPANY-CD.
  1467     MOVE CARRIERI           TO WS-CARRIER.
  1468     MOVE GROUPI             TO WS-GROUPING.
  1469     MOVE AGENTI             TO WS-AGENT.
  1470
  1471
  1472* EXEC CICS HANDLE CONDITION
  1473*        NOTFND (4010-ERROR) END-EXEC.
  1474*    MOVE '"$I                   ! % #00001372' TO DFHEIV0
  1475     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  1476     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1477     MOVE X'2520233030303031333732' TO DFHEIV0(25:11)
  1478     CALL 'kxdfhei1' USING DFHEIV0
  1479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1480
  1481
  1482
  1483     MOVE GXRF-MAX-REC-LENGTH    TO GXRF-REC-LENGTH.
  1484
  1485
  1486* EXEC CICS READ
  1487*         DATASET ('ERGXRF')
  1488*         INTO    (AGENT-CROSS-REFERENCE)
  1489*         LENGTH  (GXRF-REC-LENGTH)
  1490*         RIDFLD  (WS-CONTROL-PRIMARY)
  1491*         END-EXEC.
  1492     MOVE 'ERGXRF' TO DFHEIV1
  1493*    MOVE '&"IL       E          (   #00001378' TO DFHEIV0
  1494     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1495     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1496     MOVE X'2020233030303031333738' TO DFHEIV0(25:11)
  1497     CALL 'kxdfhei1' USING DFHEIV0,
  1498           DFHEIV1,
  1499           AGENT-CROSS-REFERENCE,
  1500           GXRF-REC-LENGTH,
  1501           WS-CONTROL-PRIMARY,
  1502           DFHEIV99,
  1503           DFHEIV99,
  1504           DFHEIV99
  1505     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1506
  1507
  1508     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
  1509
  1510     MOVE ACCOCCI TO NDX.
  1511     IF NDX  NOT GREATER GX-AGENT-POINTER-CNT
  1512         MOVE GX-AM-CARRIER  (NDX)   TO PI-CR-CARRIER
  1513         MOVE GX-AM-GROUPING (NDX)   TO PI-CR-GROUPING
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL658.cbl
  1514         MOVE GX-AM-STATE    (NDX)   TO PI-CR-STATE
  1515         MOVE GX-AM-ACCOUNT  (NDX)   TO PI-CR-ACCOUNT
  1516         PERFORM 0500-CREATE-TEMP-STORAGE THRU 0599-EXIT
  1517         MOVE XCTL-650      TO PGM-NAME
  1518         GO TO 9300-XCTL.
  1519
  1520 4010-ERROR.
  1521      MOVE ER-5004 TO EMI-ERROR.
  1522 4050-ERR.
  1523      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1524      MOVE -1                     TO ACCOCCL.
  1525      MOVE AL-UNBON               TO ACCOCCA.
  1526      GO TO 8200-SEND-DATAONLY.
  1527
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL658.cbl
  1529 5000-BROWSE-FILE.
  1530     MOVE SPACE TO BROWSE-STARTED-SW.
  1531
  1532* EXEC CICS HANDLE CONDITION
  1533*        NOTFND (5800-NO-RECORD)
  1534*        ENDFILE (5900-END-OF-FILE)
  1535*        END-EXEC.
  1536*    MOVE '"$I''                  ! & #00001408' TO DFHEIV0
  1537     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  1538     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1539     MOVE X'2620233030303031343038' TO DFHEIV0(25:11)
  1540     CALL 'kxdfhei1' USING DFHEIV0
  1541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1542
  1543
  1544     MOVE PI-ERGXRF-KEY TO WS-CONTROL-PRIMARY.
  1545
  1546
  1547* EXEC CICS STARTBR
  1548*        DATASET (GXRF-FILE-ID)
  1549*        RIDFLD (WS-CONTROL-PRIMARY)
  1550*        END-EXEC.
  1551     MOVE 0
  1552       TO DFHEIV11
  1553*    MOVE '&,         G          &   #00001415' TO DFHEIV0
  1554     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1555     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1556     MOVE X'2020233030303031343135' TO DFHEIV0(25:11)
  1557     CALL 'kxdfhei1' USING DFHEIV0,
  1558           GXRF-FILE-ID,
  1559           WS-CONTROL-PRIMARY,
  1560           DFHEIV99,
  1561           DFHEIV11,
  1562           DFHEIV99
  1563     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1564
  1565
  1566     MOVE 'Y' TO BROWSE-STARTED-SW.
  1567
  1568     IF EIBAID = DFHPF2
  1569         GO TO 5100-BROWSE-BKWD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL658.cbl
  1571 5010-READ-LOOP.
  1572
  1573     MOVE GXRF-MAX-REC-LENGTH    TO GXRF-REC-LENGTH.
  1574
  1575
  1576* EXEC CICS READNEXT
  1577*        DATASET (GXRF-FILE-ID)
  1578*        INTO    (AGENT-CROSS-REFERENCE)
  1579*        RIDFLD  (WS-CONTROL-PRIMARY)
  1580*        LENGTH  (GXRF-REC-LENGTH)
  1581*        END-EXEC.
  1582     MOVE 0
  1583       TO DFHEIV11
  1584*    MOVE '&.IL                  )   #00001429' TO DFHEIV0
  1585     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  1586     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1587     MOVE X'2020233030303031343239' TO DFHEIV0(25:11)
  1588     CALL 'kxdfhei1' USING DFHEIV0,
  1589           GXRF-FILE-ID,
  1590           AGENT-CROSS-REFERENCE,
  1591           GXRF-REC-LENGTH,
  1592           WS-CONTROL-PRIMARY,
  1593           DFHEIV99,
  1594           DFHEIV11,
  1595           DFHEIV99,
  1596           DFHEIV99
  1597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1598
  1599
  1600
  1601     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
  1602
  1603     MOVE +1 TO PI-NDX.
  1604
  1605     IF GX-COMPANY-CD NOT = PI-COMPANY-CD
  1606         IF EIBAID = DFHENTER
  1607             GO TO 5800-NO-RECORD
  1608         ELSE
  1609             GO TO 5900-END-OF-FILE.
  1610
  1611     IF EIBAID = DFHENTER
  1612        IF WS-CARRIER    = GX-CARRIER     AND
  1613           WS-GROUPING   = GX-GROUPING    AND
  1614           WS-AGENT      = GX-AGENT-NO
  1615              GO TO 5200-FORMAT-SCREEN
  1616           ELSE
  1617              GO TO 5800-NO-RECORD.
  1618
  1619     IF EIBAID = DFHPF1
  1620       IF CARRIERO = GX-CARRIER  AND
  1621          GROUPO   = GX-GROUPING AND
  1622          AGENTO   = GX-AGENT-NO
  1623         GO TO 5010-READ-LOOP.
  1624
  1625     GO TO 5200-FORMAT-SCREEN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL658.cbl
  1627 5100-BROWSE-BKWD.
  1628
  1629* EXEC CICS HANDLE CONDITION
  1630*        NOTFND (5900-END-OF-FILE)
  1631*        END-EXEC.
  1632*    MOVE '"$I                   ! '' #00001464' TO DFHEIV0
  1633     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  1634     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1635     MOVE X'2720233030303031343634' TO DFHEIV0(25:11)
  1636     CALL 'kxdfhei1' USING DFHEIV0
  1637     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1638
  1639
  1640     MOVE GXRF-MAX-REC-LENGTH    TO GXRF-REC-LENGTH.
  1641
  1642
  1643* EXEC CICS READPREV
  1644*        DATASET (GXRF-FILE-ID)
  1645*        INTO    (AGENT-CROSS-REFERENCE)
  1646*        LENGTH  (GXRF-REC-LENGTH)
  1647*        RIDFLD  (WS-CONTROL-PRIMARY)
  1648*        END-EXEC.
  1649     MOVE 0
  1650       TO DFHEIV11
  1651*    MOVE '&0IL                  )   #00001470' TO DFHEIV0
  1652     MOVE X'2630494C2020202020202020' TO DFHEIV0(1:12)
  1653     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1654     MOVE X'2020233030303031343730' TO DFHEIV0(25:11)
  1655     CALL 'kxdfhei1' USING DFHEIV0,
  1656           GXRF-FILE-ID,
  1657           AGENT-CROSS-REFERENCE,
  1658           GXRF-REC-LENGTH,
  1659           WS-CONTROL-PRIMARY,
  1660           DFHEIV99,
  1661           DFHEIV11,
  1662           DFHEIV99,
  1663           DFHEIV99
  1664     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1665
  1666
  1667     MOVE GXRF-MAX-REC-LENGTH    TO GXRF-REC-LENGTH.
  1668
  1669     IF PI-FILE-EOF
  1670         MOVE SPACE    TO PI-EOF-SW
  1671     ELSE
  1672
  1673* EXEC CICS READPREV
  1674*            DATASET (GXRF-FILE-ID)
  1675*            INTO    (AGENT-CROSS-REFERENCE)
  1676*            LENGTH  (GXRF-REC-LENGTH)
  1677*            RIDFLD  (WS-CONTROL-PRIMARY)
  1678*            END-EXEC.
  1679     MOVE 0
  1680       TO DFHEIV11
  1681*    MOVE '&0IL                  )   #00001482' TO DFHEIV0
  1682     MOVE X'2630494C2020202020202020' TO DFHEIV0(1:12)
  1683     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1684     MOVE X'2020233030303031343832' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL658.cbl
  1685     CALL 'kxdfhei1' USING DFHEIV0,
  1686           GXRF-FILE-ID,
  1687           AGENT-CROSS-REFERENCE,
  1688           GXRF-REC-LENGTH,
  1689           WS-CONTROL-PRIMARY,
  1690           DFHEIV99,
  1691           DFHEIV11,
  1692           DFHEIV99,
  1693           DFHEIV99
  1694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1695
  1696
  1697
  1698     MOVE GX-AGENT-POINTER-CNT TO GX-AGENT-POINTER-CNT.
  1699
  1700     MOVE +1 TO PI-NDX.
  1701
  1702     IF GX-COMPANY-CD NOT = PI-COMPANY-CD
  1703         GO TO 5900-END-OF-FILE.
  1704
  1705     GO TO 5200-FORMAT-SCREEN.
  1706
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL658.cbl
  1708 5200-FORMAT-SCREEN.
  1709     MOVE LOW-VALUES             TO EL658AI.
  1710
  1711     MOVE GX-CONTROL-PRIMARY     TO PI-ERGXRF-KEY.
  1712
  1713     MOVE GX-CARRIER             TO CARRIERO.
  1714
  1715     MOVE GX-GROUPING            TO GROUPO.
  1716
  1717     MOVE GX-AGENT-NO            TO AGENTO.
  1718
  1719     MOVE GX-AGENT-POINTER-CNT   TO TOTOCCO.
  1720
  1721     PERFORM 7500-COUNT-OPEN-RANGES  THRU  7500-EXIT.
  1722
  1723     MOVE WS-OPEN-COUNT          TO TOTOPNO.
  1724
  1725     IF GX-LAST-MAINT-DT NOT = SPACES AND LOW-VALUES AND ZEROS
  1726         MOVE GX-LAST-MAINT-DT          TO DC-BIN-DATE-1
  1727         MOVE SPACE                     TO DC-OPTION-CODE
  1728         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  1729         MOVE DC-GREG-DATE-1-EDIT       TO MAINTO
  1730      ELSE
  1731         MOVE '00/00/00'                TO MAINTO.
  1732
  1733     PERFORM 3000-BLD-LINE THRU 3000-XIT.
  1734
  1735     MOVE AL-UANON               TO CARRIERA GROUPA
  1736                                    AGENTA.
  1737     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL658.cbl
  1739 5800-NO-RECORD.
  1740     MOVE -1                     TO CARRIERL.
  1741     MOVE AL-UANON               TO CARRIERA   GROUPA
  1742                                     AGENTA.
  1743     MOVE ER-1164                TO EMI-ERROR.
  1744     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1745     IF BROWSE-STARTED
  1746
  1747* EXEC CICS ENDBR
  1748*           DATASET  (GXRF-FILE-ID)
  1749*           END-EXEC.
  1750     MOVE 0
  1751       TO DFHEIV11
  1752*    MOVE '&2                    $   #00001538' TO DFHEIV0
  1753     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1754     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1755     MOVE X'2020233030303031353338' TO DFHEIV0(25:11)
  1756     CALL 'kxdfhei1' USING DFHEIV0,
  1757           GXRF-FILE-ID,
  1758           DFHEIV11,
  1759           DFHEIV99
  1760     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1761
  1762
  1763     GO TO 8200-SEND-DATAONLY.
  1764
  1765 5900-END-OF-FILE.
  1766     IF EIBAID = DFHPF1
  1767         MOVE 'Y'                TO PI-EOF-SW
  1768         MOVE ER-2237            TO EMI-ERROR
  1769     ELSE
  1770         MOVE LOW-VALUES         TO PI-ERGXRF-KEY
  1771         MOVE PI-COMPANY-CD      TO PI-GXRF-COMP-CD
  1772         MOVE ER-2238            TO EMI-ERROR.
  1773
  1774     MOVE -1            TO CARRIERL.
  1775     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1776     IF BROWSE-STARTED
  1777
  1778* EXEC CICS ENDBR
  1779*           DATASET  (GXRF-FILE-ID)
  1780*           END-EXEC.
  1781     MOVE 0
  1782       TO DFHEIV11
  1783*    MOVE '&2                    $   #00001556' TO DFHEIV0
  1784     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1785     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1786     MOVE X'2020233030303031353536' TO DFHEIV0(25:11)
  1787     CALL 'kxdfhei1' USING DFHEIV0,
  1788           GXRF-FILE-ID,
  1789           DFHEIV11,
  1790           DFHEIV99
  1791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1792
  1793
  1794     MOVE SPACE TO BROWSE-STARTED-SW.
  1795     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL658.cbl
  1797 6000-OCCURRENCE.
  1798     MOVE PI-ERGXRF-KEY TO WS-CONTROL-PRIMARY.
  1799
  1800
  1801* EXEC CICS HANDLE CONDITION
  1802*        NOTFND (1500-GXRF-NOT-FOUND) END-EXEC.
  1803*    MOVE '"$I                   ! ( #00001566' TO DFHEIV0
  1804     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  1805     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1806     MOVE X'2820233030303031353636' TO DFHEIV0(25:11)
  1807     CALL 'kxdfhei1' USING DFHEIV0
  1808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1809
  1810
  1811     MOVE GXRF-MAX-REC-LENGTH    TO GXRF-REC-LENGTH.
  1812
  1813
  1814* EXEC CICS READ
  1815*         DATASET ('ERGXRF')
  1816*         INTO    (AGENT-CROSS-REFERENCE)
  1817*         LENGTH  (GXRF-REC-LENGTH)
  1818*         RIDFLD  (WS-CONTROL-PRIMARY)
  1819*         END-EXEC.
  1820     MOVE 'ERGXRF' TO DFHEIV1
  1821*    MOVE '&"IL       E          (   #00001571' TO DFHEIV0
  1822     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1823     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1824     MOVE X'2020233030303031353731' TO DFHEIV0(25:11)
  1825     CALL 'kxdfhei1' USING DFHEIV0,
  1826           DFHEIV1,
  1827           AGENT-CROSS-REFERENCE,
  1828           GXRF-REC-LENGTH,
  1829           WS-CONTROL-PRIMARY,
  1830           DFHEIV99,
  1831           DFHEIV99,
  1832           DFHEIV99
  1833     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1834
  1835
  1836
  1837     MOVE GX-AGENT-POINTER-CNT   TO GX-AGENT-POINTER-CNT.
  1838
  1839     IF EIBAID = DFHPF3
  1840        GO TO 6500-NEXT-OCC
  1841      ELSE
  1842        GO TO 7000-PRIOR-OCC.
  1843
  1844 6500-NEXT-OCC.
  1845     IF PI-NDX = GX-AGENT-POINTER-CNT
  1846         MOVE -1            TO CARRIERL
  1847         MOVE ER-0130       TO EMI-ERROR
  1848         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1849         GO TO 8200-SEND-DATAONLY.
  1850
  1851     ADD +1 TO PI-NDX.
  1852
  1853     PERFORM 3000-BLD-LINE THRU 3000-XIT.
  1854
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL658.cbl
  1855     MOVE -1      TO CARRIERL.
  1856     GO TO 8200-SEND-DATAONLY.
  1857
  1858 7000-PRIOR-OCC.
  1859     IF PI-NDX LESS 16
  1860         MOVE -1            TO CARRIERL
  1861         MOVE ER-0131       TO EMI-ERROR
  1862         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1863         GO TO 8200-SEND-DATAONLY.
  1864
  1865     COMPUTE PI-NDX = (PI-NDX - 1) / 15.
  1866     IF PI-NDX NOT = 1
  1867        COMPUTE PI-NDX = PI-NDX * 15
  1868        COMPUTE PI-NDX = PI-NDX - 14.
  1869
  1870     PERFORM 3000-BLD-LINE THRU 3000-XIT.
  1871
  1872     MOVE -1      TO CARRIERL.
  1873     GO TO 8200-SEND-DATAONLY.
  1874
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL658.cbl
  1876
  1877 7500-COUNT-OPEN-RANGES.
  1878
  1879     MOVE +1                     TO PI-NDX.
  1880     MOVE +0                     TO WS-OPEN-COUNT.
  1881
  1882 7500-LOOP.
  1883
  1884     IF PI-NDX GREATER THAN GX-AGENT-POINTER-CNT
  1885          MOVE +1                TO PI-NDX
  1886          GO TO 7500-EXIT.
  1887
  1888     IF GX-AM-EXPIRATION-DT (PI-NDX) = HIGH-VALUES
  1889         ADD +1 TO WS-OPEN-COUNT.
  1890
  1891     ADD +1 TO PI-NDX.
  1892
  1893     GO TO 7500-LOOP.
  1894
  1895 7500-EXIT.
  1896     EXIT.
  1897
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL658.cbl
  1899 8100-SEND-INITIAL-MAP.
  1900     MOVE SAVE-DATE              TO DATEO.
  1901     MOVE EIBTIME                TO TIME-IN.
  1902     MOVE TIME-OUT               TO TIMEO.
  1903     MOVE -1                     TO CARRIERL.
  1904     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  1905
  1906
  1907* EXEC CICS SEND
  1908*        MAP    (MAP-NAME)
  1909*        MAPSET (MAPSET-NAME)
  1910*        FROM   (EL658AO)
  1911*        ERASE
  1912*        CURSOR
  1913*        END-EXEC.
  1914     MOVE LENGTH OF
  1915      EL658AO
  1916       TO DFHEIV12
  1917     MOVE -1
  1918       TO DFHEIV11
  1919*    MOVE '8$     CT  E    H L F ,   #00001648' TO DFHEIV0
  1920     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1921     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1922     MOVE X'2020233030303031363438' TO DFHEIV0(25:11)
  1923     CALL 'kxdfhei1' USING DFHEIV0,
  1924           MAP-NAME,
  1925           EL658AO,
  1926           DFHEIV12,
  1927           MAPSET-NAME,
  1928           DFHEIV99,
  1929           DFHEIV99,
  1930           DFHEIV99,
  1931           DFHEIV11,
  1932           DFHEIV99,
  1933           DFHEIV99,
  1934           DFHEIV99
  1935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1936
  1937     GO TO 9100-RETURN-TRAN.
  1938
  1939 8200-SEND-DATAONLY.
  1940     MOVE SAVE-DATE              TO DATEO.
  1941     MOVE EIBTIME                TO TIME-IN.
  1942     MOVE TIME-OUT               TO TIMEO.
  1943     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  1944
  1945* EXEC CICS SEND
  1946*        MAP    (MAP-NAME)
  1947*        MAPSET (MAPSET-NAME)
  1948*        FROM   (EL658AO)
  1949*        DATAONLY
  1950*        CURSOR
  1951*        END-EXEC.
  1952     MOVE LENGTH OF
  1953      EL658AO
  1954       TO DFHEIV12
  1955     MOVE -1
  1956       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL658.cbl
  1957*    MOVE '8$D    CT       H L F ,   #00001662' TO DFHEIV0
  1958     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  1959     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1960     MOVE X'2020233030303031363632' TO DFHEIV0(25:11)
  1961     CALL 'kxdfhei1' USING DFHEIV0,
  1962           MAP-NAME,
  1963           EL658AO,
  1964           DFHEIV12,
  1965           MAPSET-NAME,
  1966           DFHEIV99,
  1967           DFHEIV99,
  1968           DFHEIV99,
  1969           DFHEIV11,
  1970           DFHEIV99,
  1971           DFHEIV99,
  1972           DFHEIV99
  1973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1974
  1975     GO TO 9100-RETURN-TRAN.
  1976
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL658.cbl
  1978 8500-DATE-CONVERT.
  1979     MOVE LINK-ELDATCV           TO PGM-NAME.
  1980
  1981* EXEC CICS LINK
  1982*        PROGRAM    (PGM-NAME)
  1983*        COMMAREA   (DATE-CONVERSION-DATA)
  1984*        LENGTH     (DC-COMM-LENGTH)
  1985*        END-EXEC.
  1986*    MOVE '."C                   ''   #00001674' TO DFHEIV0
  1987     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1988     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1989     MOVE X'2020233030303031363734' TO DFHEIV0(25:11)
  1990     CALL 'kxdfhei1' USING DFHEIV0,
  1991           PGM-NAME,
  1992           DATE-CONVERSION-DATA,
  1993           DC-COMM-LENGTH,
  1994           DFHEIV99,
  1995           DFHEIV99,
  1996           DFHEIV99
  1997     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1998
  1999 8500-EXIT.
  2000     EXIT.
  2001
  2002 8810-PF23.
  2003     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  2004     MOVE XCTL-005               TO PGM-NAME.
  2005     GO TO 9300-XCTL.
  2006
  2007 9100-RETURN-TRAN.
  2008     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  2009     MOVE '658A'               TO PI-CURRENT-SCREEN-NO.
  2010
  2011* EXEC CICS RETURN
  2012*        TRANSID(TRANS-ID)
  2013*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  2014*        LENGTH(PI-COMM-LENGTH)
  2015*        END-EXEC.
  2016*    MOVE '.(CT                  &   #00001690' TO DFHEIV0
  2017     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2018     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2019     MOVE X'2020233030303031363930' TO DFHEIV0(25:11)
  2020     CALL 'kxdfhei1' USING DFHEIV0,
  2021           TRANS-ID,
  2022           PROGRAM-INTERFACE-BLOCK,
  2023           PI-COMM-LENGTH,
  2024           DFHEIV99,
  2025           DFHEIV99
  2026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2027
  2028
  2029
  2030* GOBACK.
  2031     MOVE '9%                    "   ' TO DFHEIV0
  2032     MOVE 'EL658' TO DFHEIV1
  2033     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2034     GOBACK.
  2035
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL658.cbl
  2036 9200-RETURN-MAIN-MENU.
  2037     MOVE XCTL-626               TO PGM-NAME.
  2038     GO TO 9300-XCTL.
  2039
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL658.cbl
  2041
  2042 9300-XCTL.
  2043
  2044* EXEC CICS XCTL
  2045*        PROGRAM    (PGM-NAME)
  2046*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2047*        LENGTH     (PI-COMM-LENGTH)
  2048*        END-EXEC.
  2049*    MOVE '.$C                   $   #00001705' TO DFHEIV0
  2050     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2051     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2052     MOVE X'2020233030303031373035' TO DFHEIV0(25:11)
  2053     CALL 'kxdfhei1' USING DFHEIV0,
  2054           PGM-NAME,
  2055           PROGRAM-INTERFACE-BLOCK,
  2056           PI-COMM-LENGTH
  2057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2058
  2059
  2060 9400-CLEAR.
  2061     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  2062     GO TO 9300-XCTL.
  2063
  2064 9500-PF12.
  2065     MOVE XCTL-010               TO PGM-NAME.
  2066     GO TO 9300-XCTL.
  2067
  2068 9900-ERROR-FORMAT.
  2069     IF NOT EMI-ERRORS-COMPLETE
  2070         MOVE LINK-001 TO PGM-NAME
  2071
  2072* EXEC CICS LINK
  2073*            PROGRAM(PGM-NAME)
  2074*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  2075*            LENGTH(EMI-COMM-LENGTH)
  2076*            END-EXEC.
  2077*    MOVE '."C                   ''   #00001722' TO DFHEIV0
  2078     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2079     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2080     MOVE X'2020233030303031373232' TO DFHEIV0(25:11)
  2081     CALL 'kxdfhei1' USING DFHEIV0,
  2082           PGM-NAME,
  2083           ERROR-MESSAGE-INTERFACE-BLOCK,
  2084           EMI-COMM-LENGTH,
  2085           DFHEIV99,
  2086           DFHEIV99,
  2087           DFHEIV99
  2088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2089
  2090 9900-EXIT.
  2091     EXIT.
  2092
  2093 9990-ABEND.
  2094     MOVE LINK-004 TO PGM-NAME.
  2095     MOVE DFHEIBLK TO EMI-LINE1.
  2096
  2097* EXEC CICS LINK
  2098*        PROGRAM   (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL658.cbl
  2099*        COMMAREA  (EMI-LINE1)
  2100*        LENGTH    (72)
  2101*        END-EXEC.
  2102     MOVE 72
  2103       TO DFHEIV11
  2104*    MOVE '."C                   ''   #00001733' TO DFHEIV0
  2105     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2106     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2107     MOVE X'2020233030303031373333' TO DFHEIV0(25:11)
  2108     CALL 'kxdfhei1' USING DFHEIV0,
  2109           PGM-NAME,
  2110           EMI-LINE1,
  2111           DFHEIV11,
  2112           DFHEIV99,
  2113           DFHEIV99,
  2114           DFHEIV99
  2115     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2116
  2117     GO TO 8200-SEND-DATAONLY.
  2118
  2119 9999-DFHBACK SECTION.
  2120     MOVE '9%                    "   ' TO DFHEIV0
  2121     MOVE 'EL658' TO DFHEIV1
  2122     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2123     GOBACK.
  2124 9999-DFHEXIT.
  2125     IF DFHEIGDJ EQUAL 0001
  2126         NEXT SENTENCE
  2127     ELSE IF DFHEIGDJ EQUAL 2
  2128         GO TO 9990-ABEND,
  2129               8100-SEND-INITIAL-MAP
  2130         DEPENDING ON DFHEIGDI
  2131     ELSE IF DFHEIGDJ EQUAL 3
  2132         GO TO 1500-GXRF-NOT-FOUND,
  2133               0690-QIDERR
  2134         DEPENDING ON DFHEIGDI
  2135     ELSE IF DFHEIGDJ EQUAL 4
  2136         GO TO 1500-GXRF-NOT-FOUND
  2137         DEPENDING ON DFHEIGDI
  2138     ELSE IF DFHEIGDJ EQUAL 5
  2139         GO TO 4010-ERROR
  2140         DEPENDING ON DFHEIGDI
  2141     ELSE IF DFHEIGDJ EQUAL 6
  2142         GO TO 5800-NO-RECORD,
  2143               5900-END-OF-FILE
  2144         DEPENDING ON DFHEIGDI
  2145     ELSE IF DFHEIGDJ EQUAL 7
  2146         GO TO 5900-END-OF-FILE
  2147         DEPENDING ON DFHEIGDI
  2148     ELSE IF DFHEIGDJ EQUAL 8
  2149         GO TO 1500-GXRF-NOT-FOUND
  2150         DEPENDING ON DFHEIGDI.
  2151     MOVE '9%                    "   ' TO DFHEIV0
  2152     MOVE 'EL658' TO DFHEIV1
  2153     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2154     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL658.cbl
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       36000     Code:        6387
