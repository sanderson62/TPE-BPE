* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page   1
* ELCLMI.cbl
* Options: int("ELCLMI.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("ELCLMI.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"ELCLMI.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"ELCLMI.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 ELCLMI.
     3*                            VMOD=2.001
     4*AUTHOR.     CSO
     5*            OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    10*            *                                                   *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO         IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page   2
* ELCLMI.cbl
    14*            *                                                   *
    15*            *****************************************************
    16******************************************************************
    17*  REMARKS   *                                                   *
    18*            *    THIS 'SUBROUTINE' WILL, CALCULATE THE LIFE     *
    19*            *    CLAIM INTEREST DUE DEPENDING ON THE STATE      *
    20******************************************************************
    21*                   C H A N G E   L O G
    22*
    23* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    24*-----------------------------------------------------------------
    25*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    26* EFFECTIVE    NUMBER
    27*-----------------------------------------------------------------
    28* 060608    2008040300002  PEMA  ADD SPEC CALC FOR UT AND WA
    29* 082814    2014082800001  PEMA  CORRECT UT CLAIM IN CALC
    30******************************************************************
    31 ENVIRONMENT DIVISION.
    32 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page   3
* ELCLMI.cbl
    34 WORKING-STORAGE SECTION.
    35 01  DFH-START PIC X(04).
    36 77  FILLER   PIC X(32) VALUE '********************************'.
    37 77  FILLER   PIC X(32) VALUE '**  ELCLMI  WORKING STORAGE   **'.
    38 77  FILLER   PIC X(32) VALUE '***********VMOD 2.001 **********'.
    39 77  SAVE-DATE                   PIC X(8)     VALUE SPACES.
    40 77  SAVE-BIN-DATE               PIC X(2)     VALUE SPACES.
    41 77  WS-SELECT-DATE              PIC XX VALUE LOW-VALUES.
    42 77  WS-REQ-FROM-DT              PIC XX VALUE LOW-VALUES.
    43 77  WS-REQ-END-DT               PIC XX VALUE LOW-VALUES.
    44 77  WS-PAY-FROM-DT              PIC XX VALUE LOW-VALUES.
    45 77  WS-PAY-TO-DT                PIC XX VALUE LOW-VALUES.
    46 77  WS-SUB-FROM-DT              PIC XX VALUE LOW-VALUES.
    47 77  WS-SUB-TO-DT                PIC XX VALUE LOW-VALUES.
    48 77  WS-CALC-START-DT            PIC XX VALUE LOW-VALUES.
    49 77  WS-CALC-END-DT              PIC XX VALUE LOW-VALUES.
    50 77  WS-INTEREST                 PIC S9(7)V99 COMP-3 VALUE +0.
    51 77  WS-TOTAL-INTEREST           PIC S9(7)V99 COMP-3 VALUE +0.
    52 77  WS-DAYS                     PIC S9(5)    COMP-3 VALUE +0.
    53 77  WS-TOTAL-DAYS               PIC S9(5)    COMP-3 VALUE +0.
    54 77  WS-ELCISC-BROWSE-SW         PIC X  VALUE SPACES.
    55     88  ELCISC-BROWSE-STARTED          VALUE 'Y'.
    56 77  WS-ELCISC-SW                PIC X  VALUE SPACES.
    57     88  ELCISC-FOUND                   VALUE 'Y'.
    58 77  WS-ELCISB-SW                PIC X  VALUE SPACES.
    59     88  END-OF-BREAKOUT                VALUE 'Y'.
    60 77  WS-ELCIST-SW                PIC X  VALUE SPACES.
    61     88  END-OF-SCHED-TABLE             VALUE 'Y'.
    62 77  WS-CO-HLD-DAYS              PIC S9(5) COMP-3 VALUE +0.
    63 77  WS-CO-TOTAL-DAYS            PIC S9(5) COMP-3 VALUE +0.
    64 77  WS-CO-SW                    PIC X VALUE SPACES.
    65     88  CO-CHECKED                    VALUE 'Y'.
    66 77  WS-WA-DAYSA                 PIC S9(5) COMP-3 VALUE +0.
    67 77  WS-WA-DAYSB                 PIC S9(5) COMP-3 VALUE +0.
    68 01  GETMAIN-SPACE           PIC  X      VALUE SPACE.
    69 01  WS-RESPONSE                 PIC S9(8)   COMP.
    70     88  RESP-NORMAL                  VALUE +00.
    71     88  RESP-ERROR                   VALUE +01.
    72     88  RESP-NOTFND                  VALUE +13.
    73     88  RESP-NOTOPEN                 VALUE +19.
    74     88  RESP-ENDFILE                 VALUE +20.
    75 01  WS-HOLD-ELCISC              PIC X(100) VALUE SPACES.
    76 01  WS-SC-SAVE-KEY              PIC X(10)  VALUE LOW-VALUES.
    77 01  WS-SB-SAVE-KEY              PIC X(12)  VALUE LOW-VALUES.
    78 01  WS-ST-SAVE-KEY              PIC X(6)   VALUE LOW-VALUES.
    79 01  WS-SC-CONTROL-PRIMARY.
    80     10  WS-SC-COMPANY-CD        PIC X      VALUE SPACES.
    81     10  WS-SC-STATE             PIC XX     VALUE SPACES.
    82     10  WS-SC-PRODUCT           PIC XX     VALUE SPACES.
    83     10  WS-SC-COVERAGE          PIC XX     VALUE SPACES.
    84     10  WS-SC-EXCESS-DAYS       PIC 999    VALUE ZEROS.
    85 01  WS-SB-CONTROL-PRIMARY.
    86     10  WS-SB-COMPANY-CD        PIC X      VALUE SPACES.
    87     10  WS-SB-STATE             PIC XX     VALUE SPACES.
    88     10  WS-SB-PRODUCT           PIC XX     VALUE SPACES.
    89     10  WS-SB-COVERAGE          PIC XX     VALUE SPACES.
    90     10  WS-SB-BREAKOUT-CODE     PIC XX     VALUE SPACES.
    91     10  WS-SB-CALC-END          PIC 999    VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page   4
* ELCLMI.cbl
    92 01  WS-ST-CONTROL-PRIMARY.
    93     10  WS-ST-COMPANY-CD        PIC X      VALUE SPACES.
    94     10  WS-ST-SCHED-CODE        PIC XXX    VALUE SPACES.
    95     10  WS-ST-END-DT            PIC XX     VALUE LOW-VALUES.
    96 01  WS-IR-CONTROL-PRIMARY.
    97     10  WS-IR-COMPANY-CD        PIC X      VALUE SPACES.
    98     10  WS-IR-INT-RATE-CODE     PIC XXX    VALUE SPACES.
    99*                                COPY ELCDATE.
   100******************************************************************
   101*                                                                *
   102*                                                                *
   103*                            ELCDATE.                            *
   104*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   105*                            VMOD=2.003
   106*                                                                *
   107*                                                                *
   108*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   109*                 LENGTH = 200                                   *
   110******************************************************************
   111
   112 01  DATE-CONVERSION-DATA.
   113     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   114     12  DC-OPTION-CODE                PIC X.
   115         88  BIN-TO-GREG                VALUE ' '.
   116         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   117         88  EDIT-GREG-TO-BIN           VALUE '2'.
   118         88  YMD-GREG-TO-BIN            VALUE '3'.
   119         88  MDY-GREG-TO-BIN            VALUE '4'.
   120         88  JULIAN-TO-BIN              VALUE '5'.
   121         88  BIN-PLUS-ELAPSED           VALUE '6'.
   122         88  FIND-CENTURY               VALUE '7'.
   123         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   124         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   125         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   126         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   127         88  JULIAN-TO-BIN-3            VALUE 'C'.
   128         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   129         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   130         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   131         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   132         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   133         88  CHECK-LEAP-YEAR            VALUE 'H'.
   134         88  BIN-3-TO-GREG              VALUE 'I'.
   135         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   136         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   137         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   138         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   139         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   140         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   141         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   142         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   143         88  THREE-CHARACTER-BIN
   144                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   145         88  GREGORIAN-TO-BIN
   146                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   147         88  BIN-TO-GREGORIAN
   148                  VALUES ' ' '1' 'I' '8' 'G'.
   149         88  JULIAN-TO-BINARY
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page   5
* ELCLMI.cbl
   150                  VALUES '5' 'C' 'E' 'F'.
   151     12  DC-ERROR-CODE                 PIC X.
   152         88  NO-CONVERSION-ERROR        VALUE ' '.
   153         88  DATE-CONVERSION-ERROR
   154                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   155         88  DATE-IS-ZERO               VALUE '1'.
   156         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   157         88  DATE-IS-INVALID            VALUE '3'.
   158         88  DATE1-GREATER-DATE2        VALUE '4'.
   159         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   160         88  DATE-INVALID-OPTION        VALUE '9'.
   161         88  INVALID-CENTURY            VALUE 'A'.
   162         88  ONLY-CENTURY               VALUE 'B'.
   163         88  ONLY-LEAP-YEAR             VALUE 'C'.
   164         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   165     12  DC-END-OF-MONTH               PIC X.
   166         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   167     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   168         88  USE-NORMAL-PROCESS         VALUE ' '.
   169         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   170         88  ADJUST-UP-100-YRS          VALUE '2'.
   171     12  FILLER                        PIC X.
   172     12  DC-CONVERSION-DATES.
   173         16  DC-BIN-DATE-1             PIC XX.
   174         16  DC-BIN-DATE-2             PIC XX.
   175         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   176         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   177                       DC-GREG-DATE-1-EDIT.
   178             20  DC-EDIT1-MONTH        PIC 99.
   179             20  SLASH1-1              PIC X.
   180             20  DC-EDIT1-DAY          PIC 99.
   181             20  SLASH1-2              PIC X.
   182             20  DC-EDIT1-YEAR         PIC 99.
   183         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   184         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   185                     DC-GREG-DATE-2-EDIT.
   186             20  DC-EDIT2-MONTH        PIC 99.
   187             20  SLASH2-1              PIC X.
   188             20  DC-EDIT2-DAY          PIC 99.
   189             20  SLASH2-2              PIC X.
   190             20  DC-EDIT2-YEAR         PIC 99.
   191         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   192         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   193                     DC-GREG-DATE-1-YMD.
   194             20  DC-YMD-YEAR           PIC 99.
   195             20  DC-YMD-MONTH          PIC 99.
   196             20  DC-YMD-DAY            PIC 99.
   197         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   198         16  DC-GREG-DATE-1-MDY-R REDEFINES
   199                      DC-GREG-DATE-1-MDY.
   200             20  DC-MDY-MONTH          PIC 99.
   201             20  DC-MDY-DAY            PIC 99.
   202             20  DC-MDY-YEAR           PIC 99.
   203         16  DC-GREG-DATE-1-ALPHA.
   204             20  DC-ALPHA-MONTH        PIC X(10).
   205             20  DC-ALPHA-DAY          PIC 99.
   206             20  FILLER                PIC XX.
   207             20  DC-ALPHA-CENTURY.
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page   6
* ELCLMI.cbl
   208                 24 DC-ALPHA-CEN-N     PIC 99.
   209             20  DC-ALPHA-YEAR         PIC 99.
   210         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   211         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   212         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   213         16  DC-JULIAN-DATE            PIC 9(05).
   214         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   215                                       PIC 9(05).
   216         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   217             20  DC-JULIAN-YEAR        PIC 99.
   218             20  DC-JULIAN-DAYS        PIC 999.
   219         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   220         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   221         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   222     12  DATE-CONVERSION-VARIBLES.
   223         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   224         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   225             20  FILLER                PIC 9(3).
   226             20  HOLD-CEN-1-CCYY.
   227                 24  HOLD-CEN-1-CC     PIC 99.
   228                 24  HOLD-CEN-1-YY     PIC 99.
   229             20  HOLD-CEN-1-MO         PIC 99.
   230             20  HOLD-CEN-1-DA         PIC 99.
   231         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   232             20  HOLD-CEN-1-R-MO       PIC 99.
   233             20  HOLD-CEN-1-R-DA       PIC 99.
   234             20  HOLD-CEN-1-R-CCYY.
   235                 24  HOLD-CEN-1-R-CC   PIC 99.
   236                 24  HOLD-CEN-1-R-YY   PIC 99.
   237             20  FILLER                PIC 9(3).
   238         16  HOLD-CENTURY-1-X.
   239             20  FILLER                PIC X(3)  VALUE SPACES.
   240             20  HOLD-CEN-1-X-CCYY.
   241                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   242                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   243             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   244             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   245         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   246             20  HOLD-CEN-1-R-X-MO     PIC XX.
   247             20  HOLD-CEN-1-R-X-DA     PIC XX.
   248             20  HOLD-CEN-1-R-X-CCYY.
   249                 24  HOLD-CEN-1-R-X-CC PIC XX.
   250                 24  HOLD-CEN-1-R-X-YY PIC XX.
   251             20  FILLER                PIC XXX.
   252         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   253         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   254         16  DC-JULIAN-DATE-1          PIC 9(07).
   255         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   256             20  DC-JULIAN-1-CCYY.
   257                 24  DC-JULIAN-1-CC    PIC 99.
   258                 24  DC-JULIAN-1-YR    PIC 99.
   259             20  DC-JULIAN-DA-1        PIC 999.
   260         16  DC-JULIAN-DATE-2          PIC 9(07).
   261         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   262             20  DC-JULIAN-2-CCYY.
   263                 24  DC-JULIAN-2-CC    PIC 99.
   264                 24  DC-JULIAN-2-YR    PIC 99.
   265             20  DC-JULIAN-DA-2        PIC 999.
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page   7
* ELCLMI.cbl
   266         16  DC-GREG-DATE-A-EDIT.
   267             20  DC-EDITA-MONTH        PIC 99.
   268             20  SLASHA-1              PIC X VALUE '/'.
   269             20  DC-EDITA-DAY          PIC 99.
   270             20  SLASHA-2              PIC X VALUE '/'.
   271             20  DC-EDITA-CCYY.
   272                 24  DC-EDITA-CENT     PIC 99.
   273                 24  DC-EDITA-YEAR     PIC 99.
   274         16  DC-GREG-DATE-B-EDIT.
   275             20  DC-EDITB-MONTH        PIC 99.
   276             20  SLASHB-1              PIC X VALUE '/'.
   277             20  DC-EDITB-DAY          PIC 99.
   278             20  SLASHB-2              PIC X VALUE '/'.
   279             20  DC-EDITB-CCYY.
   280                 24  DC-EDITB-CENT     PIC 99.
   281                 24  DC-EDITB-YEAR     PIC 99.
   282         16  DC-GREG-DATE-CYMD         PIC 9(08).
   283         16  DC-GREG-DATE-CYMD-R REDEFINES
   284                              DC-GREG-DATE-CYMD.
   285             20  DC-CYMD-CEN           PIC 99.
   286             20  DC-CYMD-YEAR          PIC 99.
   287             20  DC-CYMD-MONTH         PIC 99.
   288             20  DC-CYMD-DAY           PIC 99.
   289         16  DC-GREG-DATE-MDCY         PIC 9(08).
   290         16  DC-GREG-DATE-MDCY-R REDEFINES
   291                              DC-GREG-DATE-MDCY.
   292             20  DC-MDCY-MONTH         PIC 99.
   293             20  DC-MDCY-DAY           PIC 99.
   294             20  DC-MDCY-CEN           PIC 99.
   295             20  DC-MDCY-YEAR          PIC 99.
   296    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   297        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   298    12  DC-EL310-DATE                  PIC X(21).
   299    12  FILLER                         PIC X(28).
   300*                                COPY ELCICALC.
   301******************************************************************
   302*                                                                *
   303*                           ELCCICALC.                           *
   304*                            VMOD=2.001                          *
   305*                                                                *
   306*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
   307*                 CALCULATION MODULE                             *
   308*                                                                *
   309*  PASSED TO ELCLMI                                              *
   310*  -----------------                                             *
   311*  STATE                                                         *
   312*  PRODUCT                                                       *
   313*  COVERAGE                                                      *
   314*  EFFECTIVE DATE                                                *
   315*  INCURRED DATE                                                 *
   316*  ESTABLISHED DATE                                              *
   317*  LAST PAID DATE                                                *
   318*  REPORTED DATE                                                 *
   319*  CLAIM PAYMENT AMOUNT                                          *
   320*                                                                *
   321*  RETURNED FROM ELRTRM                                          *
   322*  ---------------------                                         *
   323*  RETURN CODE                                                   *
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page   8
* ELCLMI.cbl
   324*  CLAIM INTEREST DUE SWITCH Y/N                                 *
   325*  CLAIM INTEREST AMOUNT                                         *
   326*----------------------------------------------------------------*
   327*----------------------------------------------------------------*
   328*                 LENGTH = 100                                   *
   329*                                                                *
   330******************************************************************
   331******************************************************************
   332*                   C H A N G E   L O G
   333*
   334* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   335*-----------------------------------------------------------------
   336*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   337* EFFECTIVE    NUMBER
   338*-----------------------------------------------------------------
   339* 120905    2004040700004  PEMA  NEW COPYBOOK
   340* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
   341******************************************************************
   342
   343 01  CLAIM-INT-PASS-AREA.
   344     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
   345                                     COMP.
   346
   347     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
   348       88  NO-CI-ERROR                             VALUE ZERO.
   349       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
   350       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
   351       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
   352       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
   353       88  CP-AMT-LT-5000                          VALUE '4'.
   354       88  CP-ERROR-IN-DATES                       VALUE '5'.
   355       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
   356       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
   357       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
   358***********************  INPUT AREAS ****************************
   359
   360     12  CP-CALCULATION-AREA.
   361         16  CP-COMPANY-CD         PIC X.
   362         16  CP-STATE              PIC XX.
   363         16  CP-PRODUCT            PIC XX.
   364         16  CP-COVERAGE           PIC XX.
   365         16  CP-INC-DT             PIC XX.
   366         16  CP-EST-DT             PIC XX.
   367         16  CP-LSTPD-DT           PIC XX.
   368         16  CP-RPT-DT             PIC XX.
   369         16  CP-PRF-DT             PIC XX.
   370         16  CP-EFF-DT             PIC XX.
   371         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
   372         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
   373         16  FILLER                PIC X(37).
   374
   375***************    OUTPUT FROM ELCLMI   ************************
   376
   377         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
   378
   379         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
   380         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
   381         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page   9
* ELCLMI.cbl
   382         16  FILLER                PIC X(19).
   383******************************************************************
   384****************************************************************
   385*
   386* Copyright (c) 2007 by Clerity Solutions, Inc.
   387* All rights reserved.
   388*
   389****************************************************************
   390 01  DFHEIV.
   391   02  DFHEIV0               PIC X(35).
   392   02  DFHEIV1               PIC X(08).
   393   02  DFHEIV2               PIC X(08).
   394   02  DFHEIV3               PIC X(08).
   395   02  DFHEIV4               PIC X(06).
   396   02  DFHEIV5               PIC X(04).
   397   02  DFHEIV6               PIC X(04).
   398   02  DFHEIV7               PIC X(02).
   399   02  DFHEIV8               PIC X(02).
   400   02  DFHEIV9               PIC X(01).
   401   02  DFHEIV10              PIC S9(7) COMP-3.
   402   02  DFHEIV11              PIC S9(4) COMP SYNC.
   403   02  DFHEIV12              PIC S9(4) COMP SYNC.
   404   02  DFHEIV13              PIC S9(4) COMP SYNC.
   405   02  DFHEIV14              PIC S9(4) COMP SYNC.
   406   02  DFHEIV15              PIC S9(4) COMP SYNC.
   407   02  DFHEIV16              PIC S9(9) COMP SYNC.
   408   02  DFHEIV17              PIC X(04).
   409   02  DFHEIV18              PIC X(04).
   410   02  DFHEIV19              PIC X(04).
   411   02  DFHEIV20              USAGE IS POINTER.
   412   02  DFHEIV21              USAGE IS POINTER.
   413   02  DFHEIV22              USAGE IS POINTER.
   414   02  DFHEIV23              USAGE IS POINTER.
   415   02  DFHEIV24              USAGE IS POINTER.
   416   02  DFHEIV25              PIC S9(9) COMP SYNC.
   417   02  DFHEIV26              PIC S9(9) COMP SYNC.
   418   02  DFHEIV27              PIC S9(9) COMP SYNC.
   419   02  DFHEIV28              PIC S9(9) COMP SYNC.
   420   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   421   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   422   02  FILLER                PIC X(02).
   423   02  DFHEIV99              PIC X(08) VALUE SPACE.
   424   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   425   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   426   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   427   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   428 LINKAGE  SECTION.
   429*****************************************************************
   430*                                                               *
   431* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   432* All rights reserved.                                          *
   433*                                                               *
   434*****************************************************************
   435 01  dfheiblk.
   436     02  eibtime          pic s9(7) comp-3.
   437     02  eibdate          pic s9(7) comp-3.
   438     02  eibtrnid         pic x(4).
   439     02  eibtaskn         pic s9(7) comp-3.
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  10
* ELCLMI.cbl
   440     02  eibtrmid         pic x(4).
   441     02  dfheigdi         pic s9(4) comp.
   442     02  eibcposn         pic s9(4) comp.
   443     02  eibcalen         pic s9(4) comp.
   444     02  eibaid           pic x(1).
   445     02  eibfiller1       pic x(1).
   446     02  eibfn            pic x(2).
   447     02  eibfiller2       pic x(2).
   448     02  eibrcode         pic x(6).
   449     02  eibfiller3       pic x(2).
   450     02  eibds            pic x(8).
   451     02  eibreqid         pic x(8).
   452     02  eibrsrce         pic x(8).
   453     02  eibsync          pic x(1).
   454     02  eibfree          pic x(1).
   455     02  eibrecv          pic x(1).
   456     02  eibsend          pic x(1).
   457     02  eibatt           pic x(1).
   458     02  eibeoc           pic x(1).
   459     02  eibfmh           pic x(1).
   460     02  eibcompl         pic x(1).
   461     02  eibsig           pic x(1).
   462     02  eibconf          pic x(1).
   463     02  eiberr           pic x(1).
   464     02  eibrldbk         pic x(1).
   465     02  eiberrcd         pic x(4).
   466     02  eibsynrb         pic x(1).
   467     02  eibnodat         pic x(1).
   468     02  eibfiller5       pic x(2).
   469     02  eibresp          pic 9(09) comp.
   470     02  eibresp2         pic 9(09) comp.
   471     02  dfheigdj         pic s9(4) comp.
   472     02  dfheigdk         pic s9(4) comp.
   473 01  DFHCOMMAREA                 PIC X(100).
   474*                                COPY ELCCISC.
   475******************************************************************
   476*                                                                *
   477*                                                                *
   478*                            ELCCISC.                            *
   479*                            VMOD=2.001                          *
   480*                                                                *
   481*   FILE DESCRIPTION = LIFE CLAIM INTEREST SELECTION CRITERIA    *
   482*                                                                *
   483*   FILE TYPE = VSAM,KSDS                                        *
   484*   RECORD SIZE = 100  RECFORM = FIXED                           *
   485*                                                                *
   486*   BASE CLUSTER = ELCISC                        RKP=2,LEN=10    *
   487*       ALTERNATE INDEX = NONE                                   *
   488*                                                                *
   489*   LOG = YES                                                    *
   490*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   491******************************************************************
   492*                   C H A N G E   L O G
   493*
   494* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   495*-----------------------------------------------------------------
   496*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   497* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  11
* ELCLMI.cbl
   498*-----------------------------------------------------------------
   499* 053105                   PEMA  NEW FILE AND COPYBOOK
   500******************************************************************
   501*
   502 01  CLAIM-INTEREST-SC.
   503     12  SC-RECORD-ID                       PIC XX.
   504         88  VALID-SC-ID                        VALUE 'SC'.
   505     12  SC-CONTROL-PRIMARY.
   506         16  SC-COMPANY-CD                  PIC X.
   507         16  SC-STATE                       PIC XX.
   508         16  SC-PRODUCT                     PIC XX.
   509         16  SC-COVERAGE                    PIC XX.
   510         16  SC-EXCESS-DAYS                 PIC 999.
   511     12  SC-LAST-MAINT-BY                   PIC X(4).
   512     12  SC-LAST-MAINT-DT                   PIC XX.
   513     12  SC-LAST-MAINT-HHMMSS               PIC S9(6) COMP-3.
   514     12  SC-S-TYPE                          PIC X.
   515     12  SC-SA-DATE                         PIC XX.
   516     12  SC-R-TYPE                          PIC X.
   517     12  SC-P-DAYS                          PIC S999.
   518     12  SC-CS-TYPE                         PIC X.
   519     12  SC-CS-DAYS                         PIC S999.
   520     12  SC-CE-TYPE                         PIC X.
   521     12  SC-BREAKOUT-CODE                   PIC XX.
   522     12  FILLER                             PIC X(64).
   523*                                COPY ELCCISB.
   524******************************************************************
   525*                                                                *
   526*                                                                *
   527*                            ELCCISB.                            *
   528*                            VMOD=2.001                          *
   529*                                                                *
   530*   FILE DESCRIPTION = LIFE CLAIM INTEREST STATE BREAK OUT TABLE *
   531*                                                                *
   532*   FILE TYPE = VSAM,KSDS                                        *
   533*   RECORD SIZE = 100  RECFORM = FIXED                           *
   534*                                                                *
   535*   BASE CLUSTER = ELCISB                        RKP=2,LEN=12    *
   536*       ALTERNATE INDEX = NONE                                   *
   537*                                                                *
   538*   LOG = YES                                                    *
   539*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   540******************************************************************
   541*                   C H A N G E   L O G
   542*
   543* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   544*-----------------------------------------------------------------
   545*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   546* EFFECTIVE    NUMBER
   547*-----------------------------------------------------------------
   548* 053105                   PEMA  NEW FILE AND COPYBOOK
   549******************************************************************
   550*
   551 01  CLAIM-INTEREST-SB.
   552     12  SB-RECORD-ID                       PIC XX.
   553         88  VALID-SB-ID                        VALUE 'SB'.
   554     12  SB-CONTROL-PRIMARY.
   555         16  SB-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  12
* ELCLMI.cbl
   556         16  SB-STATE                       PIC XX.
   557         16  SB-PRODUCT                     PIC XX.
   558         16  SB-COVERAGE                    PIC XX.
   559         16  SB-BREAKOUT-CODE               PIC XX.
   560         16  SB-CALC-END                    PIC 999.
   561     12  SB-LAST-MAINT-BY                   PIC X(4).
   562     12  SB-LAST-MAINT-DT                   PIC XX.
   563     12  SB-LAST-MAINT-HHMMSS               PIC S9(6) COMP-3.
   564     12  SB-CALC-START                      PIC 999.
   565     12  SB-SCHED-CODE                      PIC XXX.
   566     12  FILLER                             PIC X(70).
   567*                                COPY ELCCIST.
   568******************************************************************
   569*                                                                *
   570*                                                                *
   571*                            ELCCIST.                            *
   572*                            VMOD=2.001                          *
   573*                                                                *
   574*   FILE DESCRIPTION = LIFE CLAIM INTEREST SCHEDULE TABLE        *
   575*                                                                *
   576*   FILE TYPE = VSAM,KSDS                                        *
   577*   RECORD SIZE = 100  RECFORM = FIXED                           *
   578*                                                                *
   579*   BASE CLUSTER = ELCIST                        RKP=2,LEN=06    *
   580*       ALTERNATE INDEX = NONE                                   *
   581*                                                                *
   582*   LOG = YES                                                    *
   583*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   584******************************************************************
   585*                   C H A N G E   L O G
   586*
   587* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   588*-----------------------------------------------------------------
   589*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   590* EFFECTIVE    NUMBER
   591*-----------------------------------------------------------------
   592* 053105                   PEMA  NEW FILE AND COPYBOOK
   593******************************************************************
   594*
   595 01  CLAIM-INTEREST-ST.
   596     12  ST-RECORD-ID                       PIC XX.
   597         88  VALID-ST-ID                        VALUE 'ST'.
   598     12  ST-CONTROL-PRIMARY.
   599         16  ST-COMPANY-CD                  PIC X.
   600         16  ST-SCHED-CODE                  PIC XXX.
   601         16  ST-END-DATE                    PIC XX.
   602     12  ST-LAST-MAINT-BY                   PIC X(4).
   603     12  ST-LAST-MAINT-DT                   PIC XX.
   604     12  ST-LAST-MAINT-HHMMSS               PIC S9(6) COMP-3.
   605     12  ST-START-DATE                      PIC XX.
   606     12  ST-INT-RATE-CODE                   PIC XXX.
   607     12  FILLER                             PIC X(77).
   608*                                COPY ELCCIIR.
   609******************************************************************
   610*                                                                *
   611*                                                                *
   612*                            ELCCIIR.                            *
   613*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  13
* ELCLMI.cbl
   614*                                                                *
   615*   FILE DESCRIPTION = LIFE CLAIM INTEREST RATES                 *
   616*                                                                *
   617*   FILE TYPE = VSAM,KSDS                                        *
   618*   RECORD SIZE = 100  RECFORM = FIXED                           *
   619*                                                                *
   620*   BASE CLUSTER = ELCIIR                        RKP=2,LEN=04    *
   621*       ALTERNATE INDEX = NONE                                   *
   622*                                                                *
   623*   LOG = YES                                                    *
   624*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   625******************************************************************
   626*                   C H A N G E   L O G
   627*
   628* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   629*-----------------------------------------------------------------
   630*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   631* EFFECTIVE    NUMBER
   632*-----------------------------------------------------------------
   633* 053105                   PEMA  NEW FILE AND COPYBOOK
   634******************************************************************
   635*
   636 01  CLAIM-INTEREST-IR.
   637     12  IR-RECORD-ID                       PIC XX.
   638         88  VALID-IR-ID                        VALUE 'IR'.
   639     12  IR-CONTROL-PRIMARY.
   640         16  IR-COMPANY-CD                  PIC X.
   641         16  IR-INT-RATE-CODE               PIC XXX.
   642     12  IR-LAST-MAINT-BY                   PIC X(4).
   643     12  IR-LAST-MAINT-DT                   PIC XX.
   644     12  IR-LAST-MAINT-HHMMSS               PIC S9(6) COMP-3.
   645     12  IR-DESCRIPTION                     PIC X(25).
   646     12  IR-INT-RATE                        PIC S99V9(5).
   647     12  FILLER                             PIC X(52).
   648 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-INTEREST-SC
   649                          CLAIM-INTEREST-SB CLAIM-INTEREST-ST
   650                          CLAIM-INTEREST-IR.
   651 0000-DFHEXIT SECTION.
   652     MOVE '9#                    $   ' TO DFHEIV0.
   653     MOVE 'ELCLMI' TO DFHEIV1.
   654     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   655     MOVE DFHCOMMAREA            TO CLAIM-INT-PASS-AREA
   656     MOVE EIBDATE                TO DC-JULIAN-YYDDD
   657     MOVE '5'                    TO DC-OPTION-CODE
   658     PERFORM 9100-CONVERT-DATE   THRU 9100-EXIT
   659     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE
   660     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE
   661     .
   662 0000-START-INTEREST-CALC.
   663     MOVE ZERO                   TO CI-RETURN-CODE
   664                                    CP-CLM-INT-AMT
   665                                    CP-CLM-INT-RATE
   666                                    CP-CLM-INT-NODAYS
   667                                    WS-INTEREST
   668                                    WS-TOTAL-INTEREST
   669                                    WS-TOTAL-DAYS
   670*****************************************************************
   671*
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  14
* ELCLMI.cbl
   672* IF THEY HAVEN'T MADE A PAYMENT YET THEN USE THE CURRENT DATE
   673*
   674*****************************************************************
   675     IF CP-LSTPD-DT = ZEROS OR SPACES OR LOW-VALUES
   676        MOVE SAVE-BIN-DATE       TO CP-LSTPD-DT
   677     END-IF
   678*****************************************************************
   679     MOVE 'Y'                    TO CP-CLM-INT-SW
   680     MOVE CP-COMPANY-CD          TO WS-SC-COMPANY-CD
   681     MOVE CP-STATE               TO WS-SC-STATE
   682     MOVE CP-PRODUCT             TO WS-SC-PRODUCT
   683     MOVE CP-COVERAGE            TO WS-SC-COVERAGE
   684     MOVE ZEROS                  TO WS-SC-EXCESS-DAYS
   685     MOVE WS-SC-CONTROL-PRIMARY  TO WS-SC-SAVE-KEY
   686     PERFORM 0005-FIND-ELCISC    THRU 0005-EXIT
   687     IF (NOT RESP-NORMAL)
   688              OR
   689        (WS-SC-SAVE-KEY (1:7) NOT =
   690                                 WS-SC-CONTROL-PRIMARY (1:7))
   691        MOVE WS-SC-SAVE-KEY      TO WS-SC-CONTROL-PRIMARY
   692        MOVE '**'                TO WS-SC-PRODUCT
   693                                    CP-PRODUCT
   694        MOVE WS-SC-CONTROL-PRIMARY
   695                                 TO WS-SC-SAVE-KEY
   696        PERFORM 0010-FIND-ELCISC THRU 0010-EXIT
   697     END-IF
   698     IF (RESP-NORMAL)
   699        AND (WS-SC-SAVE-KEY (1:7) =
   700                     WS-SC-CONTROL-PRIMARY (1:7))
   701        PERFORM 0030-CALC-CLM-INT THRU 0030-EXIT
   702        MOVE WS-TOTAL-INTEREST   TO CP-CLM-INT-AMT
   703        MOVE IR-INT-RATE         TO CP-CLM-INT-RATE
   704        MOVE WS-TOTAL-DAYS       TO CP-CLM-INT-NODAYS
   705     ELSE
   706        MOVE '1'                 TO CI-RETURN-CODE
   707        MOVE 'N'                 TO CP-CLM-INT-SW
   708     END-IF
   709     MOVE CLAIM-INT-PASS-AREA    TO DFHCOMMAREA
   710
   711* EXEC CICS RETURN
   712*    END-EXEC
   713*    MOVE '.(                    ''   #00000706' TO DFHEIV0
   714     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
   715     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   716     MOVE X'2020233030303030373036' TO DFHEIV0(25:11)
   717     CALL 'kxdfhei1' USING DFHEIV0,
   718           DFHEIV99,
   719           DFHEIV99,
   720           DFHEIV99,
   721           DFHEIV99,
   722           DFHEIV99,
   723           DFHEIV99
   724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   725*****************************************************************
   726*
   727* FIND THE SELECTION CRITERIA RECORD FOR THE CLAIM
   728* IF NOT FOUND THE FIRST TIME THEN TRY USING THE WILD KEY **
   729*
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  15
* ELCLMI.cbl
   730*****************************************************************
   731     .
   732 0005-FIND-ELCISC.
   733     PERFORM 0012-ELCISC-STARTBR THRU 0012-EXIT
   734     IF RESP-NORMAL
   735        PERFORM 0020-ELCISC-READNEXT
   736                                 THRU 0020-EXIT
   737     END-IF
   738     .
   739 0005-EXIT.
   740     EXIT.
   741 0010-FIND-ELCISC.
   742     IF ELCISC-BROWSE-STARTED
   743        PERFORM 0015-ELCISC-RESETBR
   744                                 THRU 0015-EXIT
   745     ELSE
   746        PERFORM 0012-ELCISC-STARTBR
   747                                 THRU 0012-EXIT
   748     END-IF
   749     IF RESP-NORMAL
   750        PERFORM 0020-ELCISC-READNEXT
   751                                 THRU 0020-EXIT
   752     END-IF
   753     .
   754 0010-EXIT.
   755     EXIT.
   756 0012-ELCISC-STARTBR.
   757
   758* EXEC CICS STARTBR
   759*        DATASET   ('ELCISC')
   760*        RIDFLD    (WS-SC-CONTROL-PRIMARY)
   761*        GTEQ
   762*        RESP      (WS-RESPONSE)
   763*    END-EXEC
   764     MOVE 'ELCISC' TO DFHEIV1
   765     MOVE 0
   766       TO DFHEIV11
   767*    MOVE '&,         G          &  N#00000740' TO DFHEIV0
   768     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
   769     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   770     MOVE X'204E233030303030373430' TO DFHEIV0(25:11)
   771     CALL 'kxdfhei1' USING DFHEIV0,
   772           DFHEIV1,
   773           WS-SC-CONTROL-PRIMARY,
   774           DFHEIV99,
   775           DFHEIV11,
   776           DFHEIV99
   777     MOVE EIBRESP  TO WS-RESPONSE
   778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   779     IF RESP-NORMAL
   780        SET ELCISC-BROWSE-STARTED
   781                                 TO TRUE
   782     END-IF
   783     .
   784 0012-EXIT.
   785     EXIT.
   786 0015-ELCISC-RESETBR.
   787
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  16
* ELCLMI.cbl
   788* EXEC CICS RESETBR
   789*        DATASET   ('ELCISC')
   790*        RIDFLD    (WS-SC-CONTROL-PRIMARY)
   791*        GTEQ
   792*        RESP      (WS-RESPONSE)
   793*    END-EXEC
   794     MOVE 'ELCISC' TO DFHEIV1
   795     MOVE 0
   796       TO DFHEIV11
   797*    MOVE '&4         G          &  N#00000754' TO DFHEIV0
   798     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
   799     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   800     MOVE X'204E233030303030373534' TO DFHEIV0(25:11)
   801     CALL 'kxdfhei1' USING DFHEIV0,
   802           DFHEIV1,
   803           WS-SC-CONTROL-PRIMARY,
   804           DFHEIV99,
   805           DFHEIV11,
   806           DFHEIV99
   807     MOVE EIBRESP  TO WS-RESPONSE
   808     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   809     IF RESP-NORMAL
   810        SET ELCISC-BROWSE-STARTED
   811                                 TO TRUE
   812     END-IF
   813     .
   814 0015-EXIT.
   815     EXIT.
   816 0017-ELCISC-ENDBR.
   817
   818* EXEC CICS ENDBR
   819*        DATASET   ('ELCISC')
   820*        RESP      (WS-RESPONSE)
   821*    END-EXEC
   822     MOVE 'ELCISC' TO DFHEIV1
   823     MOVE 0
   824       TO DFHEIV11
   825*    MOVE '&2                    $  N#00000768' TO DFHEIV0
   826     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
   827     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
   828     MOVE X'204E233030303030373638' TO DFHEIV0(25:11)
   829     CALL 'kxdfhei1' USING DFHEIV0,
   830           DFHEIV1,
   831           DFHEIV11,
   832           DFHEIV99
   833     MOVE EIBRESP  TO WS-RESPONSE
   834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   835     .
   836 0017-EXIT.
   837     EXIT.
   838 0020-ELCISC-READNEXT.
   839
   840* EXEC CICS READNEXT
   841*        DATASET  ('ELCISC')
   842*        SET      (ADDRESS OF CLAIM-INTEREST-SC)
   843*        RIDFLD   (WS-SC-CONTROL-PRIMARY)
   844*        RESP     (WS-RESPONSE)
   845*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  17
* ELCLMI.cbl
   846     MOVE 'ELCISC' TO DFHEIV1
   847     MOVE 0
   848       TO DFHEIV11
   849*    MOVE '&.S                   )  N#00000776' TO DFHEIV0
   850     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
   851     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
   852     MOVE X'204E233030303030373736' TO DFHEIV0(25:11)
   853     CALL 'kxdfhei1' USING DFHEIV0,
   854           DFHEIV1,
   855           DFHEIV20,
   856           DFHEIV99,
   857           WS-SC-CONTROL-PRIMARY,
   858           DFHEIV99,
   859           DFHEIV11,
   860           DFHEIV99,
   861           DFHEIV99
   862     SET ADDRESS OF CLAIM-INTEREST-SC TO
   863         DFHEIV20
   864     MOVE EIBRESP  TO WS-RESPONSE
   865     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   866     .
   867 0020-EXIT.
   868     EXIT.
   869*****************************************************************
   870*
   871* FIND OUT IF THE INCURRED DATE OR THE ESTABLISH DATE IS BEYOND
   872* THE SELECT DATE, IF NOT THEN THERE IS NO REQUIREMENT TO
   873* CALCULATE THE INTEREST
   874*
   875*****************************************************************
   876 0030-CALC-CLM-INT.
   877     IF SC-S-TYPE = 'I'
   878        MOVE CP-INC-DT           TO WS-SELECT-DATE
   879     ELSE
   880        IF SC-S-TYPE = 'R'
   881           MOVE CP-RPT-DT        TO WS-SELECT-DATE
   882        ELSE
   883           MOVE CP-PRF-DT        TO WS-SELECT-DATE
   884        END-IF
   885     END-IF
   886     IF WS-SELECT-DATE >= SC-SA-DATE
   887        PERFORM 0040-INT-TYPE    THRU 0040-EXIT
   888     ELSE
   889        MOVE 'N'                 TO CP-CLM-INT-SW
   890        MOVE '2'                 TO CI-RETURN-CODE
   891     END-IF
   892     .
   893 0030-EXIT.
   894     EXIT.
   895*****************************************************************
   896*
   897* ESTABLISH THE EARLIEST REQUIRED DATE BASED ON THE REQUIRE TYPE
   898* I = INCURRED DATE, R = REPORTED DATE.
   899* ESTABLISH THE LATEST REQUIRE DATE USING THE PAID DATE.
   900* CALCULATE THE DURATION BETWEEN THE EARLIEST DATE AND THE
   901* LATEST.  IF THE DURATION IS LESS THAN THE PLUS DAYS
   902* THEN THE CLAIM IS NOT REQUIRED TO CALCULATE INTEREST
   903*
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  18
* ELCLMI.cbl
   904*****************************************************************
   905 0040-INT-TYPE.
   906     IF SC-R-TYPE = 'I'
   907        MOVE CP-INC-DT           TO WS-REQ-FROM-DT
   908     ELSE
   909        IF SC-R-TYPE = 'R'
   910           MOVE CP-RPT-DT        TO WS-REQ-FROM-DT
   911        ELSE
   912           MOVE CP-PRF-DT        TO WS-REQ-FROM-DT
   913        END-IF
   914     END-IF
   915     MOVE CP-LSTPD-DT            TO WS-REQ-END-DT
   916     MOVE WS-REQ-FROM-DT         TO DC-BIN-DATE-1
   917     MOVE WS-REQ-END-DT          TO DC-BIN-DATE-2
   918     MOVE '1'                    TO DC-OPTION-CODE
   919     PERFORM 9100-CONVERT-DATE   THRU 9100-EXIT
   920     IF NO-CONVERSION-ERROR
   921        IF (DC-ELAPSED-DAYS > SC-P-DAYS)
   922                       OR
   923           ((SC-STATE = 'UT')
   924            AND (CP-EFF-DT >= X'A285'))
   925           CONTINUE
   926        ELSE
   927           MOVE 'N'              TO CP-CLM-INT-SW
   928           MOVE '3'              TO CI-RETURN-CODE
   929           GO TO 0040-EXIT
   930        END-IF
   931     END-IF
   932*****************************************************************
   933*
   934* FIGURE OUT IF I NEED TO READ ANOTHER ELCISC RECORD.
   935* I NEED TO READ ANOTHER ONE IF THE STATE IS LA.
   936* I ALSO NEED TO READ ANOTHER ONE IF THE STATE IS ID, MD,
   937*        ND OR PA
   938*
   939*****************************************************************
   940     IF SC-STATE = 'MS'
   941        IF CP-CLAIM-AMT < 5000
   942           MOVE 'N'              TO CP-CLM-INT-SW
   943           MOVE '4'              TO CI-RETURN-CODE
   944           GO TO 0040-EXIT
   945        END-IF
   946     END-IF
   947     IF (SC-STATE = 'UT')
   948        AND (CP-EFF-DT >= X'A285')
   949        PERFORM 0070-UT-SPEC     THRU 0070-EXIT
   950        GO TO 0040-EXIT
   951     END-IF
   952     IF SC-STATE = 'WA'
   953        MOVE DC-ELAPSED-DAYS     TO WS-WA-DAYSA
   954        MOVE +0                  TO WS-WA-DAYSB
   955        MOVE CP-INC-DT           TO DC-BIN-DATE-1
   956        MOVE CP-LSTPD-DT         TO DC-BIN-DATE-2
   957        MOVE '1'                 TO DC-OPTION-CODE
   958        PERFORM 9100-CONVERT-DATE
   959                                 THRU 9100-EXIT
   960        IF NO-CONVERSION-ERROR
   961           MOVE DC-ELAPSED-DAYS  TO WS-WA-DAYSB
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  19
* ELCLMI.cbl
   962        ELSE
   963           MOVE 'N'              TO CP-CLM-INT-SW
   964           MOVE '3'              TO CI-RETURN-CODE
   965           GO TO 0040-EXIT
   966        END-IF
   967     END-IF
   968     IF SC-STATE = 'CO'
   969        MOVE ' '                 TO WS-CO-SW
   970        MOVE +0                  TO WS-CO-HLD-DAYS
   971        MOVE CP-PRF-DT           TO DC-BIN-DATE-1
   972        MOVE CP-LSTPD-DT         TO DC-BIN-DATE-2
   973        MOVE '1'                 TO DC-OPTION-CODE
   974        PERFORM 9100-CONVERT-DATE
   975                                 THRU 9100-EXIT
   976        IF NO-CONVERSION-ERROR
   977           IF DC-ELAPSED-DAYS > +30
   978              COMPUTE WS-CO-HLD-DAYS = DC-ELAPSED-DAYS - +30
   979           ELSE
   980              MOVE +99999        TO WS-CO-HLD-DAYS
   981           END-IF
   982        END-IF
   983     END-IF
   984     IF SC-STATE = 'LA' OR 'MN'
   985        MOVE CLAIM-INTEREST-SC   TO WS-HOLD-ELCISC
   986        PERFORM 0020-ELCISC-READNEXT
   987                                 THRU 0020-EXIT
   988        IF (RESP-NORMAL)
   989           AND (WS-SC-SAVE-KEY (1:7) =
   990                     WS-SC-CONTROL-PRIMARY (1:7))
   991           IF DC-ELAPSED-DAYS > SC-P-DAYS
   992              CONTINUE
   993           ELSE
   994              MOVE WS-HOLD-ELCISC
   995                                 TO CLAIM-INTEREST-SC
   996              MOVE SC-CONTROL-PRIMARY
   997                                 TO WS-SC-CONTROL-PRIMARY
   998           END-IF
   999        ELSE
  1000           MOVE WS-HOLD-ELCISC   TO CLAIM-INTEREST-SC
  1001           MOVE SC-CONTROL-PRIMARY
  1002                                 TO WS-SC-CONTROL-PRIMARY
  1003        END-IF
  1004     ELSE
  1005        IF SC-STATE = 'ID' OR 'MD' OR 'ND' OR 'PA'
  1006           MOVE CP-INC-DT        TO DC-BIN-DATE-1
  1007           MOVE CP-PRF-DT        TO DC-BIN-DATE-2
  1008           MOVE '1'              TO DC-OPTION-CODE
  1009           PERFORM 9100-CONVERT-DATE
  1010                                 THRU 9100-EXIT
  1011           IF NO-CONVERSION-ERROR
  1012              IF DC-ELAPSED-DAYS < SC-EXCESS-DAYS
  1013                 CONTINUE
  1014              ELSE
  1015                 MOVE CLAIM-INTEREST-SC
  1016                                 TO WS-HOLD-ELCISC
  1017                 PERFORM 0020-ELCISC-READNEXT
  1018                                 THRU 0020-EXIT
  1019                 IF (RESP-NORMAL)
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  20
* ELCLMI.cbl
  1020                    AND (WS-SC-SAVE-KEY (1:7) =
  1021                            WS-SC-CONTROL-PRIMARY (1:7))
  1022                    CONTINUE
  1023                 ELSE
  1024                    MOVE WS-HOLD-ELCISC
  1025                                 TO CLAIM-INTEREST-SC
  1026                    MOVE SC-CONTROL-PRIMARY
  1027                                 TO WS-SC-CONTROL-PRIMARY
  1028                 END-IF
  1029              END-IF
  1030           END-IF
  1031        END-IF
  1032     END-IF
  1033*****************************************************************
  1034*
  1035* DETERMINE THE PAY FROM DATE BY THE CALC START TYPE,
  1036* I = INCURRED DATE, R = REPORTED DATE.
  1037* NEXT, ADD THE CALC START DAYS ONTO THE PAY FROM  DATE.
  1038* AS OF 12/15/2005 THE ONLY VALID CALC END TYPE IS 'P' SO
  1039* USE THE PAID DATE AS THE PAY TO DATE.
  1040*
  1041*****************************************************************
  1042     IF SC-CS-TYPE = 'I'
  1043        MOVE CP-INC-DT           TO WS-PAY-FROM-DT
  1044     ELSE
  1045        IF SC-CS-TYPE = 'R'
  1046           MOVE CP-RPT-DT        TO WS-PAY-FROM-DT
  1047        ELSE
  1048           MOVE CP-PRF-DT        TO WS-PAY-FROM-DT
  1049        END-IF
  1050     END-IF
  1051     IF SC-CS-DAYS > ZEROS
  1052        MOVE WS-PAY-FROM-DT      TO DC-BIN-DATE-1
  1053        MOVE SC-CS-DAYS          TO DC-ELAPSED-DAYS
  1054        MOVE ZEROS               TO DC-ELAPSED-MONTHS
  1055        MOVE '6'                 TO DC-OPTION-CODE
  1056        PERFORM 9100-CONVERT-DATE
  1057                                 THRU 9100-EXIT
  1058        IF NO-CONVERSION-ERROR
  1059           MOVE DC-BIN-DATE-2    TO WS-PAY-FROM-DT
  1060        ELSE
  1061           MOVE '5'              TO CI-RETURN-CODE
  1062           GO TO 0040-EXIT
  1063        END-IF
  1064     END-IF
  1065     MOVE CP-LSTPD-DT            TO WS-PAY-TO-DT
  1066*****************************************************************
  1067*
  1068* BROWSE ALL THE STATE BREAKOUT RECORDS FOR THE STATE.
  1069* WHEN FINISHED BROWSING SET END OF BREAKOUT TO TRUE.
  1070*
  1071*****************************************************************
  1072******************************************************************
  1073     IF SC-STATE = 'CO'
  1074        MOVE WS-PAY-FROM-DT      TO DC-BIN-DATE-1
  1075        MOVE WS-PAY-TO-DT        TO DC-BIN-DATE-2
  1076        MOVE '1'                 TO DC-OPTION-CODE
  1077        PERFORM 9100-CONVERT-DATE
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  21
* ELCLMI.cbl
  1078                                 THRU 9100-EXIT
  1079        IF NO-CONVERSION-ERROR
  1080           MOVE DC-ELAPSED-DAYS  TO WS-CO-TOTAL-DAYS
  1081        END-IF
  1082        COMPUTE WS-CO-HLD-DAYS = WS-CO-TOTAL-DAYS - WS-CO-HLD-DAYS
  1083     END-IF
  1084******************************************************************
  1085     MOVE WS-SC-CONTROL-PRIMARY (1:7)
  1086                                 TO WS-SB-CONTROL-PRIMARY (1:7)
  1087     MOVE SC-BREAKOUT-CODE       TO WS-SB-BREAKOUT-CODE
  1088     MOVE ZEROS                  TO WS-SB-CALC-END
  1089     MOVE WS-SB-CONTROL-PRIMARY  TO WS-SB-SAVE-KEY
  1090     PERFORM 0100-ELCISB-STARTBR THRU 0100-EXIT
  1091     IF NOT RESP-NORMAL
  1092        MOVE 'N'                 TO CP-CLM-INT-SW
  1093        MOVE '6'                 TO CI-RETURN-CODE
  1094        GO TO 0040-EXIT
  1095     END-IF
  1096     PERFORM UNTIL END-OF-BREAKOUT
  1097        PERFORM 0110-ELCISB-READNEXT
  1098                                 THRU 0110-EXIT
  1099        IF RESP-NORMAL
  1100           IF (SB-CONTROL-PRIMARY (1:9) = WS-SB-SAVE-KEY (1:9))
  1101              PERFORM 0050-PROCESS-BREAKOUT
  1102                                 THRU 0050-EXIT
  1103           ELSE
  1104              SET END-OF-BREAKOUT TO TRUE
  1105           END-IF
  1106        ELSE
  1107           SET END-OF-BREAKOUT   TO TRUE
  1108        END-IF
  1109     END-PERFORM
  1110     .
  1111 0040-EXIT.
  1112     EXIT.
  1113*****************************************************************
  1114*
  1115* THIS IS A PAIN. HERE WE GO... IF THE CALC START IS 001 AND THE
  1116* CALC END IS 999 THEN IT IS A PIECE OF CAKE. OTHERWISE WE HAVE
  1117* TO SPLIT THE PAYMENTS APART BY THE NUMBER OF DAYS IN THE CALC
  1118* END, THEN READ THE NEXT RECORD AND IF THE END IS 999 THEN THAT
  1119* IS THE LAST ONE.
  1120* NEXT, ADD THE CALC START DAYS ONTO THE CALC START DATE.
  1121* AS OF 12/15/2005 THE ONLY VALID CALC END TYPE IS 'P' SO
  1122* USE THE PAID DATE AS THE CALC END DATE.
  1123*
  1124*****************************************************************
  1125 0050-PROCESS-BREAKOUT.
  1126     IF SB-STATE = 'CO'
  1127        IF CO-CHECKED
  1128           COMPUTE SB-CALC-START = WS-CO-HLD-DAYS + +1
  1129        ELSE
  1130           MOVE WS-CO-HLD-DAYS   TO SB-CALC-END
  1131           SET CO-CHECKED        TO TRUE
  1132        END-IF
  1133     END-IF
  1134     IF SB-CALC-START = 001
  1135        MOVE WS-PAY-FROM-DT      TO WS-SUB-FROM-DT
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  22
* ELCLMI.cbl
  1136        IF (SC-STATE = 'WA')
  1137           AND (WS-WA-DAYSA < SB-CALC-END)
  1138           SET END-OF-BREAKOUT   TO TRUE
  1139        END-IF
  1140     ELSE
  1141        IF SC-STATE = 'WA'
  1142           MOVE CP-PRF-DT        TO WS-PAY-FROM-DT
  1143        END-IF
  1144        MOVE WS-PAY-FROM-DT      TO DC-BIN-DATE-1
  1145        IF SB-CALC-START > 1
  1146           COMPUTE DC-ELAPSED-DAYS = SB-CALC-START - 1
  1147        ELSE
  1148           MOVE 1                TO DC-ELAPSED-DAYS
  1149        END-IF
  1150        MOVE +0                  TO DC-ELAPSED-MONTHS
  1151        MOVE '6'                 TO DC-OPTION-CODE
  1152        PERFORM 9100-CONVERT-DATE
  1153                                 THRU 9100-EXIT
  1154        IF NO-CONVERSION-ERROR
  1155           MOVE DC-BIN-DATE-2    TO WS-SUB-FROM-DT
  1156        ELSE
  1157           MOVE '5'              TO CI-RETURN-CODE
  1158           GO TO 0050-EXIT
  1159        END-IF
  1160     END-IF
  1161     IF SB-CALC-END = 999
  1162        SET END-OF-BREAKOUT TO TRUE
  1163        MOVE WS-PAY-TO-DT        TO WS-SUB-TO-DT
  1164     ELSE
  1165        IF (SC-STATE = 'WA')
  1166           AND (END-OF-BREAKOUT)
  1167           MOVE WS-WA-DAYSB      TO SB-CALC-END
  1168        ELSE
  1169           IF SC-STATE = 'WA'
  1170              COMPUTE SB-CALC-END = WS-WA-DAYSB -
  1171                 (WS-WA-DAYSA - 90)
  1172           END-IF
  1173        END-IF
  1174        MOVE WS-PAY-FROM-DT      TO DC-BIN-DATE-1
  1175        MOVE SB-CALC-END         TO DC-ELAPSED-DAYS
  1176        MOVE +0                  TO DC-ELAPSED-MONTHS
  1177        MOVE '6'                 TO DC-OPTION-CODE
  1178        PERFORM 9100-CONVERT-DATE
  1179                                 THRU 9100-EXIT
  1180        IF NO-CONVERSION-ERROR
  1181           MOVE DC-BIN-DATE-2    TO WS-SUB-TO-DT
  1182           IF WS-PAY-TO-DT < WS-SUB-TO-DT
  1183              MOVE WS-PAY-TO-DT  TO WS-SUB-TO-DT
  1184              SET END-OF-BREAKOUT TO TRUE
  1185           END-IF
  1186        ELSE
  1187           MOVE '5'              TO CI-RETURN-CODE
  1188           GO TO 0050-EXIT
  1189        END-IF
  1190     END-IF
  1191     MOVE CP-COMPANY-CD          TO WS-ST-COMPANY-CD
  1192     MOVE SB-SCHED-CODE          TO WS-ST-SCHED-CODE
  1193     MOVE LOW-VALUES             TO WS-ST-END-DT
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  23
* ELCLMI.cbl
  1194     PERFORM 0200-ELCIST-STARTBR THRU 0200-EXIT
  1195     IF NOT RESP-NORMAL
  1196        MOVE 'N'                 TO CP-CLM-INT-SW
  1197        MOVE '7'                 TO CI-RETURN-CODE
  1198        GO TO 0050-EXIT
  1199     END-IF
  1200     MOVE WS-ST-CONTROL-PRIMARY  TO WS-ST-SAVE-KEY
  1201     MOVE SPACES                 TO WS-ELCIST-SW
  1202     PERFORM UNTIL END-OF-SCHED-TABLE
  1203        PERFORM 0210-ELCIST-READNEXT
  1204                                 THRU 0210-EXIT
  1205        IF RESP-NORMAL
  1206           IF ST-CONTROL-PRIMARY (1:4) = WS-ST-SAVE-KEY (1:4)
  1207              PERFORM 0060-ACCUMULATE THRU 0060-EXIT
  1208           ELSE
  1209              SET END-OF-SCHED-TABLE TO TRUE
  1210           END-IF
  1211        ELSE
  1212           SET END-OF-SCHED-TABLE TO TRUE
  1213        END-IF
  1214     END-PERFORM
  1215
  1216* EXEC CICS ENDBR
  1217*       DATASET ('ELCIST')
  1218*    END-EXEC
  1219     MOVE 'ELCIST' TO DFHEIV1
  1220     MOVE 0
  1221       TO DFHEIV11
  1222*    MOVE '&2                    $   #00001131' TO DFHEIV0
  1223     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1224     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1225     MOVE X'2020233030303031313331' TO DFHEIV0(25:11)
  1226     CALL 'kxdfhei1' USING DFHEIV0,
  1227           DFHEIV1,
  1228           DFHEIV11,
  1229           DFHEIV99
  1230     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1231     .
  1232 0050-EXIT.
  1233     EXIT.
  1234 0060-ACCUMULATE.
  1235     IF WS-SUB-TO-DT < ST-START-DATE
  1236        SET END-OF-SCHED-TABLE   TO TRUE
  1237        GO TO 0060-EXIT
  1238     ELSE
  1239        IF WS-SUB-FROM-DT > ST-END-DATE
  1240           GO TO 0060-EXIT
  1241        END-IF
  1242     END-IF
  1243     IF (WS-SUB-FROM-DT >= ST-START-DATE)
  1244        AND (WS-SUB-FROM-DT <= ST-END-DATE)
  1245        MOVE WS-SUB-FROM-DT      TO WS-CALC-START-DT
  1246        IF (WS-SUB-TO-DT >= ST-START-DATE)
  1247           AND (WS-SUB-TO-DT <= ST-END-DATE)
  1248           MOVE WS-SUB-TO-DT     TO WS-CALC-END-DT
  1249           SET END-OF-SCHED-TABLE TO TRUE
  1250        ELSE
  1251           MOVE ST-END-DATE        TO WS-CALC-END-DT
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  24
* ELCLMI.cbl
  1252        END-IF
  1253     ELSE
  1254        MOVE ST-START-DATE        TO WS-CALC-START-DT
  1255        IF (WS-SUB-TO-DT >= ST-START-DATE)
  1256           AND (WS-SUB-TO-DT <= ST-END-DATE)
  1257           MOVE WS-SUB-TO-DT     TO WS-CALC-END-DT
  1258           SET END-OF-SCHED-TABLE TO TRUE
  1259        ELSE
  1260           MOVE ST-END-DATE        TO WS-CALC-END-DT
  1261        END-IF
  1262     END-IF
  1263     IF WS-CALC-START-DT >= WS-CALC-END-DT
  1264        GO TO 0060-EXIT
  1265     END-IF
  1266     MOVE WS-CALC-START-DT       TO DC-BIN-DATE-1
  1267     MOVE WS-CALC-END-DT         TO DC-BIN-DATE-2
  1268     MOVE '1'                    TO DC-OPTION-CODE
  1269     PERFORM 9100-CONVERT-DATE   THRU 9100-EXIT
  1270     IF NO-CONVERSION-ERROR
  1271        MOVE DC-ELAPSED-DAYS     TO WS-DAYS
  1272     ELSE
  1273        MOVE 'N'                 TO CP-CLM-INT-SW
  1274        MOVE '5'                 TO CI-RETURN-CODE
  1275        GO TO 0060-EXIT
  1276     END-IF
  1277     MOVE CP-COMPANY-CD          TO WS-IR-COMPANY-CD
  1278     MOVE ST-INT-RATE-CODE       TO WS-IR-INT-RATE-CODE
  1279     PERFORM 0300-ELCIIR-READ    THRU 0300-EXIT
  1280     IF RESP-NORMAL
  1281        IF IR-INT-RATE-CODE = 'ZZZ'
  1282           IF CP-INT-RATE = ZEROS
  1283              MOVE 'N'           TO CP-CLM-INT-SW
  1284              MOVE '8'           TO CI-RETURN-CODE
  1285              GO TO 0060-EXIT
  1286           ELSE
  1287              MOVE CP-INT-RATE   TO IR-INT-RATE
  1288           END-IF
  1289        END-IF
  1290        COMPUTE WS-TOTAL-DAYS = WS-TOTAL-DAYS + WS-DAYS
  1291        COMPUTE WS-INTEREST ROUNDED = (CP-CLAIM-AMT *
  1292           ((1 + IR-INT-RATE) ** (WS-DAYS / 365) - 1))
  1293        ADD WS-INTEREST          TO WS-TOTAL-INTEREST
  1294     END-IF
  1295     .
  1296 0060-EXIT.
  1297     EXIT.
  1298 0070-UT-SPEC.
  1299*    X'A285' = 05/05/2008   USED FOR UT ONLY
  1300*    FOR UT ONLY THE CP-RPT-DT IS REALLY THE EFF DATE
  1301     MOVE CP-INC-DT              TO DC-BIN-DATE-1
  1302     MOVE CP-LSTPD-DT            TO DC-BIN-DATE-2
  1303     MOVE '1'                    TO DC-OPTION-CODE
  1304     PERFORM 9100-CONVERT-DATE   THRU 9100-EXIT
  1305     IF NO-CONVERSION-ERROR
  1306        MOVE DC-ELAPSED-DAYS     TO WS-WA-DAYSA
  1307     ELSE
  1308        MOVE 'N'                 TO CP-CLM-INT-SW
  1309        MOVE '5'                 TO CI-RETURN-CODE
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  25
* ELCLMI.cbl
  1310        GO TO 0070-EXIT
  1311     END-IF
  1312     MOVE CP-PRF-DT              TO DC-BIN-DATE-1
  1313     MOVE CP-LSTPD-DT            TO DC-BIN-DATE-2
  1314     MOVE '1'                    TO DC-OPTION-CODE
  1315     PERFORM 9100-CONVERT-DATE   THRU 9100-EXIT
  1316     IF NO-CONVERSION-ERROR
  1317        MOVE DC-ELAPSED-DAYS     TO WS-WA-DAYSB
  1318     ELSE
  1319        MOVE 'N'                 TO CP-CLM-INT-SW
  1320        MOVE '5'                 TO CI-RETURN-CODE
  1321        GO TO 0070-EXIT
  1322     END-IF
  1323
  1324* EXEC CICS GETMAIN
  1325*        LENGTH   (100)
  1326*        SET      (ADDRESS OF claim-interest-ir)
  1327*        INITIMG  (getmain-space)
  1328*    END-EXEC
  1329     MOVE 100
  1330       TO DFHEIV11
  1331*    MOVE ',"IL                  $   #00001226' TO DFHEIV0
  1332     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  1333     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1334     MOVE X'2020233030303031323236' TO DFHEIV0(25:11)
  1335     CALL 'kxdfhei1' USING DFHEIV0,
  1336           DFHEIV20,
  1337           DFHEIV11,
  1338           getmain-space
  1339     SET ADDRESS OF claim-interest-ir TO
  1340         DFHEIV20
  1341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1342
  1343     move +0                     to ir-int-rate
  1344     IF WS-WA-DAYSB < 31
  1345        COMPUTE WS-TOTAL-INTEREST ROUNDED = (CP-CLAIM-AMT *
  1346        ((1.035) ** (WS-WA-DAYSA / 365) - 1))
  1347        MOVE .035                TO IR-INT-RATE
  1348        MOVE WS-WA-DAYSA         TO WS-TOTAL-DAYS
  1349     ELSE
  1350        MOVE CP-INC-DT           TO DC-BIN-DATE-1
  1351        MOVE CP-PRF-DT           TO DC-BIN-DATE-2
  1352        MOVE '1'                 TO DC-OPTION-CODE
  1353        PERFORM 9100-CONVERT-DATE
  1354                                 THRU 9100-EXIT
  1355        IF NO-CONVERSION-ERROR
  1356           COMPUTE WS-DAYS = DC-ELAPSED-DAYS + 30
  1357        ELSE
  1358           MOVE 'N'              TO CP-CLM-INT-SW
  1359           MOVE '5'              TO CI-RETURN-CODE
  1360           GO TO 0070-EXIT
  1361        END-IF
  1362        COMPUTE WS-INTEREST ROUNDED = (CP-CLAIM-AMT *
  1363           ((1.035) ** (WS-DAYS / 365) - 1))
  1364        MOVE .035                TO IR-INT-RATE
  1365        MOVE WS-DAYS             TO WS-TOTAL-DAYS
  1366        SUBTRACT +30             FROM WS-WA-DAYSB
  1367        IF WS-WA-DAYSB > +0
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  26
* ELCLMI.cbl
  1368           COMPUTE WS-TOTAL-INTEREST ROUNDED = (CP-CLAIM-AMT *
  1369              ((1.135) ** (WS-WA-DAYSB / 365) - 1))
  1370           COMPUTE WS-TOTAL-INTEREST = WS-TOTAL-INTEREST +
  1371              WS-INTEREST
  1372           MOVE .135                TO IR-INT-RATE
  1373           COMPUTE WS-TOTAL-DAYS = WS-TOTAL-DAYS + WS-WA-DAYSB
  1374        END-IF
  1375     END-IF
  1376     .
  1377 0070-EXIT.
  1378     EXIT.
  1379 0100-ELCISB-STARTBR.
  1380
  1381* EXEC CICS STARTBR
  1382*        DATASET   ('ELCISB')
  1383*        RIDFLD    (WS-SB-CONTROL-PRIMARY)
  1384*        GTEQ
  1385*        RESP      (WS-RESPONSE)
  1386*    END-EXEC
  1387     MOVE 'ELCISB' TO DFHEIV1
  1388     MOVE 0
  1389       TO DFHEIV11
  1390*    MOVE '&,         G          &  N#00001269' TO DFHEIV0
  1391     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1392     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1393     MOVE X'204E233030303031323639' TO DFHEIV0(25:11)
  1394     CALL 'kxdfhei1' USING DFHEIV0,
  1395           DFHEIV1,
  1396           WS-SB-CONTROL-PRIMARY,
  1397           DFHEIV99,
  1398           DFHEIV11,
  1399           DFHEIV99
  1400     MOVE EIBRESP  TO WS-RESPONSE
  1401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1402     .
  1403 0100-EXIT.
  1404     EXIT.
  1405 0110-ELCISB-READNEXT.
  1406
  1407* EXEC CICS READNEXT
  1408*        DATASET  ('ELCISB')
  1409*        SET      (ADDRESS OF CLAIM-INTEREST-SB)
  1410*        RIDFLD   (WS-SB-CONTROL-PRIMARY)
  1411*        RESP     (WS-RESPONSE)
  1412*    END-EXEC
  1413     MOVE 'ELCISB' TO DFHEIV1
  1414     MOVE 0
  1415       TO DFHEIV11
  1416*    MOVE '&.S                   )  N#00001279' TO DFHEIV0
  1417     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1418     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1419     MOVE X'204E233030303031323739' TO DFHEIV0(25:11)
  1420     CALL 'kxdfhei1' USING DFHEIV0,
  1421           DFHEIV1,
  1422           DFHEIV20,
  1423           DFHEIV99,
  1424           WS-SB-CONTROL-PRIMARY,
  1425           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  27
* ELCLMI.cbl
  1426           DFHEIV11,
  1427           DFHEIV99,
  1428           DFHEIV99
  1429     SET ADDRESS OF CLAIM-INTEREST-SB TO
  1430         DFHEIV20
  1431     MOVE EIBRESP  TO WS-RESPONSE
  1432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1433     .
  1434 0110-EXIT.
  1435     EXIT.
  1436 0200-ELCIST-STARTBR.
  1437
  1438* EXEC CICS STARTBR
  1439*        DATASET   ('ELCIST')
  1440*        RIDFLD    (WS-ST-CONTROL-PRIMARY)
  1441*        GTEQ
  1442*        RESP      (WS-RESPONSE)
  1443*    END-EXEC
  1444     MOVE 'ELCIST' TO DFHEIV1
  1445     MOVE 0
  1446       TO DFHEIV11
  1447*    MOVE '&,         G          &  N#00001289' TO DFHEIV0
  1448     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1449     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1450     MOVE X'204E233030303031323839' TO DFHEIV0(25:11)
  1451     CALL 'kxdfhei1' USING DFHEIV0,
  1452           DFHEIV1,
  1453           WS-ST-CONTROL-PRIMARY,
  1454           DFHEIV99,
  1455           DFHEIV11,
  1456           DFHEIV99
  1457     MOVE EIBRESP  TO WS-RESPONSE
  1458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1459     .
  1460 0200-EXIT.
  1461     EXIT.
  1462 0210-ELCIST-READNEXT.
  1463
  1464* EXEC CICS READNEXT
  1465*        DATASET  ('ELCIST')
  1466*        SET      (ADDRESS OF CLAIM-INTEREST-ST)
  1467*        RIDFLD   (WS-ST-CONTROL-PRIMARY)
  1468*        RESP     (WS-RESPONSE)
  1469*    END-EXEC
  1470     MOVE 'ELCIST' TO DFHEIV1
  1471     MOVE 0
  1472       TO DFHEIV11
  1473*    MOVE '&.S                   )  N#00001299' TO DFHEIV0
  1474     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1475     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1476     MOVE X'204E233030303031323939' TO DFHEIV0(25:11)
  1477     CALL 'kxdfhei1' USING DFHEIV0,
  1478           DFHEIV1,
  1479           DFHEIV20,
  1480           DFHEIV99,
  1481           WS-ST-CONTROL-PRIMARY,
  1482           DFHEIV99,
  1483           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  28
* ELCLMI.cbl
  1484           DFHEIV99,
  1485           DFHEIV99
  1486     SET ADDRESS OF CLAIM-INTEREST-ST TO
  1487         DFHEIV20
  1488     MOVE EIBRESP  TO WS-RESPONSE
  1489     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1490     .
  1491 0210-EXIT.
  1492     EXIT.
  1493 0300-ELCIIR-READ.
  1494
  1495* EXEC CICS READ
  1496*        DATASET  ('ELCIIR')
  1497*        SET      (ADDRESS OF CLAIM-INTEREST-IR)
  1498*        RIDFLD   (WS-IR-CONTROL-PRIMARY)
  1499*        RESP     (WS-RESPONSE)
  1500*    END-EXEC
  1501     MOVE 'ELCIIR' TO DFHEIV1
  1502*    MOVE '&"S        E          (  N#00001309' TO DFHEIV0
  1503     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1504     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1505     MOVE X'204E233030303031333039' TO DFHEIV0(25:11)
  1506     CALL 'kxdfhei1' USING DFHEIV0,
  1507           DFHEIV1,
  1508           DFHEIV20,
  1509           DFHEIV99,
  1510           WS-IR-CONTROL-PRIMARY,
  1511           DFHEIV99,
  1512           DFHEIV99,
  1513           DFHEIV99
  1514     SET ADDRESS OF CLAIM-INTEREST-IR TO
  1515         DFHEIV20
  1516     MOVE EIBRESP  TO WS-RESPONSE
  1517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1518     .
  1519 0300-EXIT.
  1520     EXIT.
  1521 9100-CONVERT-DATE.
  1522
  1523* EXEC CICS LINK
  1524*        PROGRAM  ('ELDATCV')
  1525*        COMMAREA (DATE-CONVERSION-DATA)
  1526*        LENGTH   (DC-COMM-LENGTH)
  1527*    END-EXEC.
  1528     MOVE 'ELDATCV' TO DFHEIV1
  1529*    MOVE '."C                   (   #00001319' TO DFHEIV0
  1530     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1531     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1532     MOVE X'2020233030303031333139' TO DFHEIV0(25:11)
  1533     CALL 'kxdfhei1' USING DFHEIV0,
  1534           DFHEIV1,
  1535           DATE-CONVERSION-DATA,
  1536           DC-COMM-LENGTH,
  1537           DFHEIV99,
  1538           DFHEIV99,
  1539           DFHEIV99,
  1540           DFHEIV99
  1541     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 28-Aug-14 17:08 Page  29
* ELCLMI.cbl
  1542
  1543 9100-EXIT.
  1544     EXIT.
  1545 99999-DUMMY-STOP-RUN.
  1546
  1547 9999-DFHBACK SECTION.
  1548     MOVE '9%                    "   ' TO DFHEIV0
  1549     MOVE 'ELCLMI' TO DFHEIV1
  1550     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1551     GOBACK.
  1552 9999-DFHEXIT.
  1553     IF DFHEIGDJ EQUAL 0001
  1554         NEXT SENTENCE.
  1555     MOVE '9%                    "   ' TO DFHEIV0
  1556     MOVE 'ELCLMI' TO DFHEIV1
  1557     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1558     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1760     Code:        4828
