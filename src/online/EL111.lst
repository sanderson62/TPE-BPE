* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL111.cbl
* Options: int("EL111.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL111.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL111.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL111.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL111 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:47:58.
     7*                            VMOD=2.004
     8*
     9*AUTHOR.        LOGIC, INC.
    10*               DALLAS, TEXAS.
    11*DATE-COMPILED.
    12*SECURITY.   *****************************************************
    13*            *                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL111.cbl
    14*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    15*            *                                                   *
    16*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    17*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    18*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    19*            *                                                   *
    20*            *****************************************************
    21*REMARKS. TRANSACTION EX36 - PROGRAM FILE MAINTENANCE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL111.cbl
    23 ENVIRONMENT DIVISION.
    24 DATA DIVISION.
    25 WORKING-STORAGE SECTION.
    26 01  DFH-START PIC X(04).
    27 01  LCP-TIME-OF-DAY-XX.
    28     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    29     05  FILLER                    PIC 99.
    30 01  LCP-CICS-TIME                 PIC 9(15).
    31
    32 77  FILLER  PIC X(32)  VALUE '********************************'.
    33 77  FILLER  PIC X(32)  VALUE '*    EL111 WORKING STORAGE     *'.
    34 77  FILLER  PIC X(32)  VALUE '*********** VMOD 2.004 *********'.
    35
    36 01  WS-DATE-AREA.
    37     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    38     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
    39
    40 01  LITERALS-NUMBERS.
    41     12  LIT-A                   PIC X       VALUE 'A'.
    42     12  LIT-B                   PIC X       VALUE 'B'.
    43     12  LIT-C                   PIC X       VALUE 'C'.
    44     12  LIT-D                   PIC X       VALUE 'D'.
    45     12  LIT-E                   PIC X       VALUE 'E'.
    46     12  LIT-S                   PIC X       VALUE 'S'.
    47     12  LIT-X                   PIC X       VALUE 'X'.
    48     12  LIT-SPACE               PIC X       VALUE SPACE.
    49     12  LIT-PO                  PIC XX      VALUE 'PO'.
    50     12  LIT-CLAIM               PIC XX      VALUE 'EL'.
    51     12  LIT-GL                  PIC XX      VALUE 'GL'.
    52     12  LIT-EM                  PIC XX      VALUE 'EM'.
    53     12  LIT-EC                  PIC XX      VALUE 'EC'.
    54     12  LIT-FILE                PIC X(8)    VALUE 'ELPGMO'.
    55     12  LIT-FILE-2              PIC X(8)    VALUE 'ELPGMN'.
    56     12  LIT-PGM                 PIC X(8)    VALUE 'EL111'.
    57     12  LIT-SYS                 PIC X(4)    VALUE 'SYS'.
    58     12  LIT-TRANS               PIC X(4)    VALUE 'EX36'.
    59     12  LIT-HELP                PIC X(8)    VALUE 'EL010'.
    60     12  LIT-MAP                 PIC X(4)    VALUE '111A'.
    61     12  CALL-PGM                PIC X(8)    VALUE SPACES.
    62     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
    63     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
    64     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
    65     12  XCTL-EM626              PIC X(8)    VALUE 'EM626'.
    66     12  XCTL-GL800              PIC X(8)    VALUE 'GL800'.
    67     12  COUNT-1                 PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL111.cbl
    69 01  EDIT-WORK-AREA.
    70     12  CHECK-MAINT             PIC X.
    71         88  SHOW-OPTION                     VALUE 'S'.
    72         88  CHANGE-OPTION                   VALUE 'C'.
    73         88  DELETE-OPTION                   VALUE 'D'.
    74         88  VALID-OPTION                    VALUE 'C' 'D' 'S'.
    75     12  CHECK-TYPE              PIC X.
    76         88  VALID-TYPE                      VALUE 'F' 'P' 'T'.
    77     12  CHECK-PFKEYS            PIC 99.
    78     12  SCREEN-SWITCH           PIC X.
    79         88  UPDATES-MADE                    VALUE 'A'.
    80         88  DELETE-CODE-PRESENT             VALUE 'D'.
    81         88  SCREEN-ERROR                    VALUE 'X'.
    82     12  UPDATE-SWITCH           PIC X.
    83         88  NOTHING-CHANGED                 VALUE 'E'.
    84         88  UPDATE-COMPLETE                 VALUE 'D'.
    85     12  FIND-SWITCH             PIC X.
    86         88  END-UPDATES                     VALUE 'E'.
    87         88  UPDATE-FOUND                    VALUE 'D'.
    88     12  BROWSE-KEY.
    89         16  KEY-GENERIC.
    90             20  PGM-NO.
    91                 24  PGM-PREF    PIC XX.
    92                 24  PGM-NUM     PIC XXX.
    93             20  OPT-TYPE        PIC X.
    94         16  OPT-CODE            PIC X.
    95     12  SAVE-KEY                PIC X(6).
    96     12  HOLD-OPT                PIC 9.
    97     12  NAME-KEY                PIC X(5).
    98     12  RECORD-KEY.
    99         16  GENERIC-KEY         PIC X(6).
   100         16  FILLER              PIC X.
   101     12  DESC-HOLD.
   102         16  HOLD-DESC OCCURS 8 TIMES PIC X(40).
   103
   104 01  TIME-UNFORMATTED.
   105     12  UN-HOURS                PIC XX.
   106     12  UN-MINUTES              PIC XX.
   107     12  FILLER                  PIC X(4).
   108
   109 01  TIME-FORMATTED.
   110     12  FOR-HOURS               PIC XX.
   111     12  FILLER                  PIC X       VALUE '.'.
   112     12  FOR-MINUTES             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL111.cbl
   114 01  ERROR-MESSAGES.
   115     12  MAINT-MIS.
   116         16  FILLER              PIC X(39)
   117             VALUE 'MAINTENANCE FUNCTION INVALID OR UNAUTHO'.
   118         16  FILLER              PIC X(18)
   119             VALUE 'RIZED             '.
   120
   121     12  PGM-MIS.
   122         16  FILLER              PIC X(33)
   123             VALUE 'PROGRAM NUMBER MISSING OR INVALID'.
   124         16  FILLER              PIC X(18)
   125             VALUE ' - PLEASE RE-ENTER'.
   126
   127     12  PGM-FILE-MIS.
   128         16  FILLER              PIC X(38)
   129             VALUE 'PROGRAM NUMBER MUST BE DEFINED IN THE '.
   130         16  FILLER              PIC X(24)
   131             VALUE 'PROGRAM DESCRIPTION FILE'.
   132
   133     12  PGM-DUP                 PIC X(42)
   134         VALUE 'PROGRAM NUMBER DUPLICATE - PLEASE RE-ENTER'.
   135
   136     12  OPT-MIS.
   137         16  FILLER              PIC X(30)
   138             VALUE 'OPTION TYPE MISSING OR INVALID'.
   139         16  FILLER              PIC X(18)
   140             VALUE ' - PLEASE RE-ENTER'.
   141
   142     12  DEL-OPT-MIS.
   143         16  FILLER              PIC X(35)
   144             VALUE 'DELETE OPTION MUST BE ENTERED WITH '.
   145         16  FILLER              PIC X(22)
   146             VALUE 'MAINTENANCE FUNCTION D'.
   147
   148     12  DEL-OPT-INV             PIC X(35)
   149             VALUE 'NOTHING TO DELETE FOR OPTIONS GIVEN'.
   150
   151     12  DEL-OPT-ERROR.
   152         16  FILLER              PIC X(39)
   153             VALUE 'DELETE OPTION CAN ONLY BE ENTERED WITH'.
   154         16  FILLER              PIC X(22)
   155             VALUE 'MAINTENANCE FUNCTION D'.
   156
   157     12  INVALID-PFKEY           PIC X(45)
   158         VALUE 'INVALID PF-OPTION REQUESTED - PLEASE RE-ENTER'.
   159
   160     12  END-UPDATE              PIC X(16)
   161         VALUE 'UPDATE COMPLETED'.
   162
   163     12  NO-UPDATES              PIC X(32)
   164         VALUE 'NO UPDATES MADE - SCREEN IGNORED'.
   165
   166     12  SCREEN-TERM             PIC X(42)
   167           VALUE '     CLAS-IC PROGRAM MAINTENANCE COMPLETED'.
   168
   169     12  FILE-MSG                PIC X(25)
   170           VALUE '     FILE ELPGMO NOT OPEN'.
   171
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL111.cbl
   172     12  NO-OPTIONS-PRESENT      PIC X(37)
   173         VALUE 'NO OPTIONS AVAILABLE FOR THIS PROGRAM'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL111.cbl
   175 01  COMP-LENGTHS.
   176     12  LIT-IC                  PIC S9(4)  COMP VALUE -1.
   177     12  FILE-LENGTH             PIC S9(4)  COMP VALUE +25.
   178     12  TERM-LENGTH             PIC S9(4)  COMP VALUE +42.
   179     12  JOURNAL-LENGTH          PIC S9(4)  COMP VALUE +72.
   180     12  SHOW-LENGTH             PIC S9(4)  COMP VALUE +6.
   181     12  PGMO-LENGTH             PIC S9(4)  COMP VALUE +49.
   182
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL111.cbl
   184*    COPY ELCDATE.
   185******************************************************************
   186*                                                                *
   187*                                                                *
   188*                            ELCDATE.                            *
   189*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   190*                            VMOD=2.003
   191*                                                                *
   192*                                                                *
   193*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   194*                 LENGTH = 200                                   *
   195******************************************************************
   196
   197 01  DATE-CONVERSION-DATA.
   198     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   199     12  DC-OPTION-CODE                PIC X.
   200         88  BIN-TO-GREG                VALUE ' '.
   201         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   202         88  EDIT-GREG-TO-BIN           VALUE '2'.
   203         88  YMD-GREG-TO-BIN            VALUE '3'.
   204         88  MDY-GREG-TO-BIN            VALUE '4'.
   205         88  JULIAN-TO-BIN              VALUE '5'.
   206         88  BIN-PLUS-ELAPSED           VALUE '6'.
   207         88  FIND-CENTURY               VALUE '7'.
   208         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   209         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   210         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   211         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   212         88  JULIAN-TO-BIN-3            VALUE 'C'.
   213         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   214         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   215         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   216         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   217         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   218         88  CHECK-LEAP-YEAR            VALUE 'H'.
   219         88  BIN-3-TO-GREG              VALUE 'I'.
   220         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   221         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   222         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   223         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   224         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   225         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   226         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   227         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   228         88  THREE-CHARACTER-BIN
   229                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   230         88  GREGORIAN-TO-BIN
   231                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   232         88  BIN-TO-GREGORIAN
   233                  VALUES ' ' '1' 'I' '8' 'G'.
   234         88  JULIAN-TO-BINARY
   235                  VALUES '5' 'C' 'E' 'F'.
   236     12  DC-ERROR-CODE                 PIC X.
   237         88  NO-CONVERSION-ERROR        VALUE ' '.
   238         88  DATE-CONVERSION-ERROR
   239                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   240         88  DATE-IS-ZERO               VALUE '1'.
   241         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL111.cbl
   242         88  DATE-IS-INVALID            VALUE '3'.
   243         88  DATE1-GREATER-DATE2        VALUE '4'.
   244         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   245         88  DATE-INVALID-OPTION        VALUE '9'.
   246         88  INVALID-CENTURY            VALUE 'A'.
   247         88  ONLY-CENTURY               VALUE 'B'.
   248         88  ONLY-LEAP-YEAR             VALUE 'C'.
   249         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   250     12  DC-END-OF-MONTH               PIC X.
   251         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   252     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   253         88  USE-NORMAL-PROCESS         VALUE ' '.
   254         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   255         88  ADJUST-UP-100-YRS          VALUE '2'.
   256     12  FILLER                        PIC X.
   257     12  DC-CONVERSION-DATES.
   258         16  DC-BIN-DATE-1             PIC XX.
   259         16  DC-BIN-DATE-2             PIC XX.
   260         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   261         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   262                       DC-GREG-DATE-1-EDIT.
   263             20  DC-EDIT1-MONTH        PIC 99.
   264             20  SLASH1-1              PIC X.
   265             20  DC-EDIT1-DAY          PIC 99.
   266             20  SLASH1-2              PIC X.
   267             20  DC-EDIT1-YEAR         PIC 99.
   268         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   269         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   270                     DC-GREG-DATE-2-EDIT.
   271             20  DC-EDIT2-MONTH        PIC 99.
   272             20  SLASH2-1              PIC X.
   273             20  DC-EDIT2-DAY          PIC 99.
   274             20  SLASH2-2              PIC X.
   275             20  DC-EDIT2-YEAR         PIC 99.
   276         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   277         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   278                     DC-GREG-DATE-1-YMD.
   279             20  DC-YMD-YEAR           PIC 99.
   280             20  DC-YMD-MONTH          PIC 99.
   281             20  DC-YMD-DAY            PIC 99.
   282         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   283         16  DC-GREG-DATE-1-MDY-R REDEFINES
   284                      DC-GREG-DATE-1-MDY.
   285             20  DC-MDY-MONTH          PIC 99.
   286             20  DC-MDY-DAY            PIC 99.
   287             20  DC-MDY-YEAR           PIC 99.
   288         16  DC-GREG-DATE-1-ALPHA.
   289             20  DC-ALPHA-MONTH        PIC X(10).
   290             20  DC-ALPHA-DAY          PIC 99.
   291             20  FILLER                PIC XX.
   292             20  DC-ALPHA-CENTURY.
   293                 24 DC-ALPHA-CEN-N     PIC 99.
   294             20  DC-ALPHA-YEAR         PIC 99.
   295         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   296         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   297         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   298         16  DC-JULIAN-DATE            PIC 9(05).
   299         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL111.cbl
   300                                       PIC 9(05).
   301         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   302             20  DC-JULIAN-YEAR        PIC 99.
   303             20  DC-JULIAN-DAYS        PIC 999.
   304         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   305         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   306         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   307     12  DATE-CONVERSION-VARIBLES.
   308         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   309         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   310             20  FILLER                PIC 9(3).
   311             20  HOLD-CEN-1-CCYY.
   312                 24  HOLD-CEN-1-CC     PIC 99.
   313                 24  HOLD-CEN-1-YY     PIC 99.
   314             20  HOLD-CEN-1-MO         PIC 99.
   315             20  HOLD-CEN-1-DA         PIC 99.
   316         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   317             20  HOLD-CEN-1-R-MO       PIC 99.
   318             20  HOLD-CEN-1-R-DA       PIC 99.
   319             20  HOLD-CEN-1-R-CCYY.
   320                 24  HOLD-CEN-1-R-CC   PIC 99.
   321                 24  HOLD-CEN-1-R-YY   PIC 99.
   322             20  FILLER                PIC 9(3).
   323         16  HOLD-CENTURY-1-X.
   324             20  FILLER                PIC X(3)  VALUE SPACES.
   325             20  HOLD-CEN-1-X-CCYY.
   326                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   327                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   328             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   329             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   330         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   331             20  HOLD-CEN-1-R-X-MO     PIC XX.
   332             20  HOLD-CEN-1-R-X-DA     PIC XX.
   333             20  HOLD-CEN-1-R-X-CCYY.
   334                 24  HOLD-CEN-1-R-X-CC PIC XX.
   335                 24  HOLD-CEN-1-R-X-YY PIC XX.
   336             20  FILLER                PIC XXX.
   337         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   338         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   339         16  DC-JULIAN-DATE-1          PIC 9(07).
   340         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   341             20  DC-JULIAN-1-CCYY.
   342                 24  DC-JULIAN-1-CC    PIC 99.
   343                 24  DC-JULIAN-1-YR    PIC 99.
   344             20  DC-JULIAN-DA-1        PIC 999.
   345         16  DC-JULIAN-DATE-2          PIC 9(07).
   346         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   347             20  DC-JULIAN-2-CCYY.
   348                 24  DC-JULIAN-2-CC    PIC 99.
   349                 24  DC-JULIAN-2-YR    PIC 99.
   350             20  DC-JULIAN-DA-2        PIC 999.
   351         16  DC-GREG-DATE-A-EDIT.
   352             20  DC-EDITA-MONTH        PIC 99.
   353             20  SLASHA-1              PIC X VALUE '/'.
   354             20  DC-EDITA-DAY          PIC 99.
   355             20  SLASHA-2              PIC X VALUE '/'.
   356             20  DC-EDITA-CCYY.
   357                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL111.cbl
   358                 24  DC-EDITA-YEAR     PIC 99.
   359         16  DC-GREG-DATE-B-EDIT.
   360             20  DC-EDITB-MONTH        PIC 99.
   361             20  SLASHB-1              PIC X VALUE '/'.
   362             20  DC-EDITB-DAY          PIC 99.
   363             20  SLASHB-2              PIC X VALUE '/'.
   364             20  DC-EDITB-CCYY.
   365                 24  DC-EDITB-CENT     PIC 99.
   366                 24  DC-EDITB-YEAR     PIC 99.
   367         16  DC-GREG-DATE-CYMD         PIC 9(08).
   368         16  DC-GREG-DATE-CYMD-R REDEFINES
   369                              DC-GREG-DATE-CYMD.
   370             20  DC-CYMD-CEN           PIC 99.
   371             20  DC-CYMD-YEAR          PIC 99.
   372             20  DC-CYMD-MONTH         PIC 99.
   373             20  DC-CYMD-DAY           PIC 99.
   374         16  DC-GREG-DATE-MDCY         PIC 9(08).
   375         16  DC-GREG-DATE-MDCY-R REDEFINES
   376                              DC-GREG-DATE-MDCY.
   377             20  DC-MDCY-MONTH         PIC 99.
   378             20  DC-MDCY-DAY           PIC 99.
   379             20  DC-MDCY-CEN           PIC 99.
   380             20  DC-MDCY-YEAR          PIC 99.
   381    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   382        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   383    12  DC-EL310-DATE                  PIC X(21).
   384    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL111.cbl
   386*    COPY ELCLOGOF.
   387******************************************************************
   388*                                                                *
   389*                                                                *
   390*                            ELCLOGOF.                           *
   391*                            VMOD=2.001                          *
   392*                                                                *
   393*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   394*                                                                *
   395******************************************************************
   396 01  CLASIC-LOGOFF.
   397     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   398     12  LOGOFF-TEXT.
   399         16  FILLER          PIC X(5)    VALUE SPACES.
   400         16  LOGOFF-MSG.
   401             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   402             20  FILLER      PIC X       VALUE SPACES.
   403             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   404         16  FILLER          PIC X(80)
   405           VALUE '* YOU ARE NOW LOGGED OFF'.
   406         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   407         16  FILLER          PIC X       VALUE QUOTE.
   408         16  LOGOFF-SYS-MSG  PIC X(17)
   409           VALUE 'S CLAS-IC SYSTEM '.
   410     12  TEXT-MESSAGES.
   411         16  UNACCESS-MSG    PIC X(29)
   412             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   413         16  PGMIDERR-MSG    PIC X(17)
   414             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL111.cbl
   416*    COPY ELCATTR.
   417******************************************************************
   418*                                                                *
   419*                            ELCATTR.                            *
   420*                            VMOD=2.001                          *
   421*                                                                *
   422*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   423*                                                                *
   424*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   425*                                                                *
   426*                   POS 1   P=PROTECTED                          *
   427*                           U=UNPROTECTED                        *
   428*                           S=ASKIP                              *
   429*                   POS 2   A=ALPHA/NUMERIC                      *
   430*                           N=NUMERIC                            *
   431*                   POS 3   N=NORMAL                             *
   432*                           B=BRIGHT                             *
   433*                           D=DARK                               *
   434*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   435*                           OF=MODIFIED DATA TAG OFF             *
   436*                                                                *
   437*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   438******************************************************************
   439 01  ATTRIBUTE-LIST.
   440     12  AL-PABOF            PIC X       VALUE 'Y'.
   441     12  AL-PABON            PIC X       VALUE 'Z'.
   442     12  AL-PADOF            PIC X       VALUE '%'.
   443     12  AL-PADON            PIC X       VALUE '_'.
   444     12  AL-PANOF            PIC X       VALUE '-'.
   445     12  AL-PANON            PIC X       VALUE '/'.
   446     12  AL-SABOF            PIC X       VALUE '8'.
   447     12  AL-SABON            PIC X       VALUE '9'.
   448     12  AL-SADOF            PIC X       VALUE '@'.
   449     12  AL-SADON            PIC X       VALUE QUOTE.
   450     12  AL-SANOF            PIC X       VALUE '0'.
   451     12  AL-SANON            PIC X       VALUE '1'.
   452     12  AL-UABOF            PIC X       VALUE 'H'.
   453     12  AL-UABON            PIC X       VALUE 'I'.
   454     12  AL-UADOF            PIC X       VALUE '<'.
   455     12  AL-UADON            PIC X       VALUE '('.
   456     12  AL-UANOF            PIC X       VALUE ' '.
   457     12  AL-UANON            PIC X       VALUE 'A'.
   458     12  AL-UNBOF            PIC X       VALUE 'Q'.
   459     12  AL-UNBON            PIC X       VALUE 'R'.
   460     12  AL-UNDOF            PIC X       VALUE '*'.
   461     12  AL-UNDON            PIC X       VALUE ')'.
   462     12  AL-UNNOF            PIC X       VALUE '&'.
   463     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL111.cbl
   465*    COPY ELCAID.
   466******************************************************************
   467*                                                                *
   468*                            ELCAID.                             *
   469*                            VMOD=2.001                          *
   470*                                                                *
   471*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   472*                                                                *
   473*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   474*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   475******************************************************************
   476
   477 01  DFHAID.
   478   02  DFHNULL   PIC  X  VALUE  ' '.
   479   02  DFHENTER  PIC  X  VALUE  QUOTE.
   480   02  DFHCLEAR  PIC  X  VALUE  '_'.
   481   02  DFHPEN    PIC  X  VALUE  '='.
   482   02  DFHOPID   PIC  X  VALUE  'W'.
   483   02  DFHPA1    PIC  X  VALUE  '%'.
   484   02  DFHPA2    PIC  X  VALUE  '>'.
   485   02  DFHPA3    PIC  X  VALUE  ','.
   486   02  DFHPF1    PIC  X  VALUE  '1'.
   487   02  DFHPF2    PIC  X  VALUE  '2'.
   488   02  DFHPF3    PIC  X  VALUE  '3'.
   489   02  DFHPF4    PIC  X  VALUE  '4'.
   490   02  DFHPF5    PIC  X  VALUE  '5'.
   491   02  DFHPF6    PIC  X  VALUE  '6'.
   492   02  DFHPF7    PIC  X  VALUE  '7'.
   493   02  DFHPF8    PIC  X  VALUE  '8'.
   494   02  DFHPF9    PIC  X  VALUE  '9'.
   495   02  DFHPF10   PIC  X  VALUE  ':'.
   496   02  DFHPF11   PIC  X  VALUE  '#'.
   497   02  DFHPF12   PIC  X  VALUE  '@'.
   498   02  DFHPF13   PIC  X  VALUE  'A'.
   499   02  DFHPF14   PIC  X  VALUE  'B'.
   500   02  DFHPF15   PIC  X  VALUE  'C'.
   501   02  DFHPF16   PIC  X  VALUE  'D'.
   502   02  DFHPF17   PIC  X  VALUE  'E'.
   503   02  DFHPF18   PIC  X  VALUE  'F'.
   504   02  DFHPF19   PIC  X  VALUE  'G'.
   505   02  DFHPF20   PIC  X  VALUE  'H'.
   506   02  DFHPF21   PIC  X  VALUE  'I'.
   507*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   508   02  DFHPF22   PIC  X  VALUE  '['.
   509   02  DFHPF23   PIC  X  VALUE  '.'.
   510   02  DFHPF24   PIC  X  VALUE  '<'.
   511   02  DFHMSRE   PIC  X  VALUE  'X'.
   512   02  DFHSTRF   PIC  X  VALUE  'h'.
   513   02  DFHTRIG   PIC  X  VALUE  '"'.
   514 01  FILLER REDEFINES DFHAID.
   515     12  FILLER                  PIC X(8).
   516     12  AID-KEYS OCCURS 24 TIMES.
   517         16  FILLER              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL111.cbl
   519*    COPY ELCJPFX.
   520******************************************************************
   521*                                                                *
   522*                                                                *
   523*                            ELCJPFX.                            *
   524*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   525*                            VMOD=2.002                          *
   526*                                                                *
   527*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   528*                                                                *
   529*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   530*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   531*        ELCNTL - CONTROL FILE                                   *
   532*        ELMSTR - CLAIM MASTERS                                  *
   533*        ELTRLR - ACTIVITY TRAILERS                              *
   534*        ELCHKQ - CHECK QUE                                      *
   535******************************************************************
   536 01  JOURNAL-RECORD.
   537     12  JP-USER-ID                  PIC X(4).
   538     12  JP-FILE-ID                  PIC X(8).
   539     12  JP-PROGRAM-ID               PIC X(8).
   540     12  JP-RECORD-TYPE              PIC X.
   541         88 JP-ADD              VALUE 'A'.
   542         88 JP-BEFORE-CHANGE    VALUE 'B'.
   543         88 JP-AFTER-CHANGE     VALUE 'C'.
   544         88 JP-DELETE           VALUE 'D'.
   545         88 JP-GENERIC-DELETE   VALUE 'G'.
   546         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   547         88 JP-KEY-CHG-ADD      VALUE 'N'.
   548     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   549     12  JP-RECORD-AREA
   550
   551
   552                                 PIC X(49).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL111.cbl
   554*    COPY ELCINTF.
   555******************************************************************
   556*                                                                *
   557*                                                                *
   558*                            ELCINTF.                            *
   559*                            VMOD=2.017                          *
   560*                                                                *
   561*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   562*                                                                *
   563*       LENGTH = 1024                                            *
   564*                                                                *
   565******************************************************************
   566 01  PROGRAM-INTERFACE-BLOCK.
   567     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   568     12  PI-CALLING-PROGRAM              PIC X(8).
   569     12  PI-SAVED-PROGRAM-1              PIC X(8).
   570     12  PI-SAVED-PROGRAM-2              PIC X(8).
   571     12  PI-SAVED-PROGRAM-3              PIC X(8).
   572     12  PI-SAVED-PROGRAM-4              PIC X(8).
   573     12  PI-SAVED-PROGRAM-5              PIC X(8).
   574     12  PI-SAVED-PROGRAM-6              PIC X(8).
   575     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   576     12  PI-COMPANY-ID                   PIC XXX.
   577     12  PI-COMPANY-CD                   PIC X.
   578
   579     12  PI-COMPANY-PASSWORD             PIC X(8).
   580
   581     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   582
   583     12  PI-CONTROL-IN-PROGRESS.
   584         16  PI-CARRIER                  PIC X.
   585         16  PI-GROUPING                 PIC X(6).
   586         16  PI-STATE                    PIC XX.
   587         16  PI-ACCOUNT                  PIC X(10).
   588         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   589                                         PIC X(10).
   590         16  PI-CLAIM-CERT-GRP.
   591             20  PI-CLAIM-NO             PIC X(7).
   592             20  PI-CERT-NO.
   593                 25  PI-CERT-PRIME       PIC X(10).
   594                 25  PI-CERT-SFX         PIC X.
   595             20  PI-CERT-EFF-DT          PIC XX.
   596         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   597             20  PI-PLAN-CODE            PIC X(2).
   598             20  PI-REVISION-NUMBER      PIC X(3).
   599             20  PI-PLAN-EFF-DT          PIC X(2).
   600             20  PI-PLAN-EXP-DT          PIC X(2).
   601             20  FILLER                  PIC X(11).
   602         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   603             20  PI-OE-REFERENCE-1.
   604                 25  PI-OE-REF-1-PRIME   PIC X(18).
   605                 25  PI-OE-REF-1-SUFF    PIC XX.
   606
   607     12  PI-SESSION-IN-PROGRESS          PIC X.
   608         88  CLAIM-SESSION                   VALUE '1'.
   609         88  CREDIT-SESSION                  VALUE '2'.
   610         88  WARRANTY-SESSION                VALUE '3'.
   611         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL111.cbl
   612         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   613
   614
   615*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   616
   617     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   618     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   619
   620     12  PI-CREDIT-USER                  PIC X.
   621         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   622         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   623
   624     12  PI-CLAIM-USER                   PIC X.
   625         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   626         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   627
   628     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   629         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   630         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   631         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   632         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   633         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   634
   635     12  PI-PROCESSOR-ID                 PIC X(4).
   636
   637     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   638
   639     12  PI-MEMBER-CAPTION               PIC X(10).
   640
   641     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   642         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   643
   644     12  PI-LIFE-OVERRIDE-L1             PIC X.
   645     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   646     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   647     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   648
   649     12  PI-AH-OVERRIDE-L1               PIC X.
   650     12  PI-AH-OVERRIDE-L2               PIC XX.
   651     12  PI-AH-OVERRIDE-L6               PIC X(6).
   652     12  PI-AH-OVERRIDE-L12              PIC X(12).
   653
   654     12  PI-NEW-SYSTEM                   PIC X(2).
   655
   656     12  PI-PRIMARY-CERT-NO              PIC X(11).
   657     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   658         88  PI-USES-PAID-TO                 VALUE '1'.
   659     12  PI-CRDTCRD-SYSTEM.
   660         16  PI-CRDTCRD-USER             PIC X.
   661             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   662             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   663         16  PI-CC-MONTH-END-DT          PIC XX.
   664     12  PI-PROCESSOR-PRINTER            PIC X(4).
   665
   666     12  PI-OE-REFERENCE-2.
   667         16  PI-OE-REF-2-PRIME           PIC X(10).
   668         16  PI-OE-REF-2-SUFF            PIC X.
   669
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL111.cbl
   670     12  PI-REM-TRM-CALC-OPTION          PIC X.
   671
   672     12  PI-LANGUAGE-TYPE                PIC X.
   673             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   674             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   675             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   676
   677     12  PI-POLICY-LINKAGE-IND           PIC X.
   678         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   679         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   680                                                   LOW-VALUES.
   681
   682     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   683     12  PI-CLAIM-PW-SESSION             PIC X(1).
   684         88  PI-CLAIM-CREDIT                 VALUE '1'.
   685         88  PI-CLAIM-CONVEN                 VALUE '2'.
   686     12  FILLER                          PIC X(4).
   687
   688     12  PI-SYSTEM-LEVEL                 PIC X(145).
   689
   690     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   691         PI-SYSTEM-LEVEL.
   692
   693         16  PI-ENTRY-CODES.
   694             20  PI-ENTRY-CD-1           PIC X.
   695             20  PI-ENTRY-CD-2           PIC X.
   696
   697         16  PI-RETURN-CODES.
   698             20  PI-RETURN-CD-1          PIC X.
   699             20  PI-RETURN-CD-2          PIC X.
   700
   701         16  PI-UPDATE-STATUS-SAVE.
   702             20  PI-UPDATE-BY            PIC X(4).
   703             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   704
   705         16  PI-LOWER-CASE-LETTERS       PIC X.
   706             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   707
   708*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   709*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   710*            88  CARRIER-CLM-CNTL            VALUE '2'.
   711
   712         16  PI-CERT-ACCESS-CONTROL      PIC X.
   713             88  ST-ACCNT-CNTL               VALUE ' '.
   714             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   715             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   716             88  ACCNT-CNTL                  VALUE '3'.
   717             88  CARR-ACCNT-CNTL             VALUE '4'.
   718
   719         16  PI-PROCESSOR-CAP-LIST.
   720             20  PI-SYSTEM-CONTROLS.
   721                24 PI-SYSTEM-DISPLAY     PIC X.
   722                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   723                24 PI-SYSTEM-MODIFY      PIC X.
   724                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   725             20  FILLER                  PIC XX.
   726             20  PI-DISPLAY-CAP          PIC X.
   727                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL111.cbl
   728             20  PI-MODIFY-CAP           PIC X.
   729                 88  MODIFY-CAP              VALUE 'Y'.
   730             20  PI-MSG-AT-LOGON-CAP     PIC X.
   731                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   732             20  PI-FORCE-CAP            PIC X.
   733                 88  FORCE-CAP               VALUE 'Y'.
   734
   735         16  PI-PROGRAM-CONTROLS.
   736             20  PI-PGM-PRINT-OPT        PIC X.
   737             20  PI-PGM-FORMAT-OPT       PIC X.
   738             20  PI-PGM-PROCESS-OPT      PIC X.
   739             20  PI-PGM-TOTALS-OPT       PIC X.
   740
   741         16  PI-HELP-INTERFACE.
   742             20  PI-LAST-ERROR-NO        PIC X(4).
   743             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   744
   745         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   746             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   747
   748         16  PI-CR-CONTROL-IN-PROGRESS.
   749             20  PI-CR-CARRIER           PIC X.
   750             20  PI-CR-GROUPING          PIC X(6).
   751             20  PI-CR-STATE             PIC XX.
   752             20  PI-CR-ACCOUNT           PIC X(10).
   753             20  PI-CR-FIN-RESP          PIC X(10).
   754             20  PI-CR-TYPE              PIC X.
   755
   756         16  PI-CR-BATCH-NUMBER          PIC X(6).
   757
   758         16  PI-CR-MONTH-END-DT          PIC XX.
   759
   760         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   761             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   762             88  PI-ZERO-CARRIER             VALUE '1'.
   763             88  PI-ZERO-GROUPING            VALUE '2'.
   764             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   765
   766         16  PI-CARRIER-SECURITY         PIC X.
   767             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   768
   769         16  PI-ACCOUNT-SECURITY         PIC X(10).
   770             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   771             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   772
   773         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   774             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   775                                         INDEXED BY PI-ACCESS-NDX
   776                                         PIC X.
   777
   778         16  PI-GA-BILLING-CONTROL       PIC X.
   779             88  PI-GA-BILLING               VALUE '1'.
   780
   781         16  PI-MAIL-PROCESSING          PIC X.
   782             88  PI-MAIL-YES                 VALUE 'Y'.
   783
   784         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   785
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL111.cbl
   786         16  PI-AR-SYSTEM.
   787             20  PI-AR-PROCESSING-CNTL   PIC X.
   788                 88  PI-AR-PROCESSING        VALUE 'Y'.
   789             20  PI-AR-SUMMARY-CODE      PIC X(6).
   790             20  PI-AR-MONTH-END-DT      PIC XX.
   791
   792         16  PI-MP-SYSTEM.
   793             20  PI-MORTGAGE-USER            PIC X.
   794                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   795                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   796             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   797                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   798                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   799                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   800                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   801                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   802             20  PI-MP-MONTH-END-DT          PIC XX.
   803             20  PI-MP-REFERENCE-NO.
   804                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   805                 24  PI-MP-REFERENCE-SFX     PIC XX.
   806
   807         16  PI-LABEL-CONTROL            PIC X(01).
   808             88  PI-CREATE-LABELS                    VALUE 'Y'.
   809             88  PI-BYPASS-LABELS                    VALUE 'N'.
   810
   811         16  PI-BILL-GROUPING-CODE       PIC X(01).
   812             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   813
   814         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   815             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   816             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   817
   818         16  FILLER                      PIC X(14).
   819
   820     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   821******************************************************************
   822     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   823         16  MENU-SWITCH         PIC X.
   824         16  SHOW-SWITCH         PIC X.
   825             88   NOT-SHOWN                 VALUE 'X'.
   826         16  FILLER              PIC X(638).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL111.cbl
   828*    COPY EL111S.
   829 01  EL111AI.
   830     05  FILLER            PIC  X(0012).
   831*    -------------------------------
   832     05  DATEL PIC S9(0004) COMP.
   833     05  DATEF PIC  X(0001).
   834     05  FILLER REDEFINES DATEF.
   835         10  DATEA PIC  X(0001).
   836     05  DATEI PIC  X(0008).
   837*    -------------------------------
   838     05  TIMEL PIC S9(0004) COMP.
   839     05  TIMEF PIC  X(0001).
   840     05  FILLER REDEFINES TIMEF.
   841         10  TIMEA PIC  X(0001).
   842     05  TIMEI PIC  X(0005).
   843*    -------------------------------
   844     05  MAINTL PIC S9(0004) COMP.
   845     05  MAINTF PIC  X(0001).
   846     05  FILLER REDEFINES MAINTF.
   847         10  MAINTA PIC  X(0001).
   848     05  MAINTI PIC  X(0001).
   849*    -------------------------------
   850     05  PGRML PIC S9(0004) COMP.
   851     05  PGRMF PIC  X(0001).
   852     05  FILLER REDEFINES PGRMF.
   853         10  PGRMA PIC  X(0001).
   854     05  PGRMI PIC  X(0005).
   855*    -------------------------------
   856     05  OPTTYPEL PIC S9(0004) COMP.
   857     05  OPTTYPEF PIC  X(0001).
   858     05  FILLER REDEFINES OPTTYPEF.
   859         10  OPTTYPEA PIC  X(0001).
   860     05  OPTTYPEI PIC  X(0001).
   861*    -------------------------------
   862     05  DELOPTL PIC S9(0004) COMP.
   863     05  DELOPTF PIC  X(0001).
   864     05  FILLER REDEFINES DELOPTF.
   865         10  DELOPTA PIC  X(0001).
   866     05  DELOPTI PIC  X(0001).
   867*    -------------------------------
   868     05  DESC1L PIC S9(0004) COMP.
   869     05  DESC1F PIC  X(0001).
   870     05  FILLER REDEFINES DESC1F.
   871         10  DESC1A PIC  X(0001).
   872     05  DESC1I PIC  X(0040).
   873*    -------------------------------
   874     05  DESC2L PIC S9(0004) COMP.
   875     05  DESC2F PIC  X(0001).
   876     05  FILLER REDEFINES DESC2F.
   877         10  DESC2A PIC  X(0001).
   878     05  DESC2I PIC  X(0040).
   879*    -------------------------------
   880     05  DESC3L PIC S9(0004) COMP.
   881     05  DESC3F PIC  X(0001).
   882     05  FILLER REDEFINES DESC3F.
   883         10  DESC3A PIC  X(0001).
   884     05  DESC3I PIC  X(0040).
   885*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL111.cbl
   886     05  DESC4L PIC S9(0004) COMP.
   887     05  DESC4F PIC  X(0001).
   888     05  FILLER REDEFINES DESC4F.
   889         10  DESC4A PIC  X(0001).
   890     05  DESC4I PIC  X(0040).
   891*    -------------------------------
   892     05  DESC5L PIC S9(0004) COMP.
   893     05  DESC5F PIC  X(0001).
   894     05  FILLER REDEFINES DESC5F.
   895         10  DESC5A PIC  X(0001).
   896     05  DESC5I PIC  X(0040).
   897*    -------------------------------
   898     05  DESC6L PIC S9(0004) COMP.
   899     05  DESC6F PIC  X(0001).
   900     05  FILLER REDEFINES DESC6F.
   901         10  DESC6A PIC  X(0001).
   902     05  DESC6I PIC  X(0040).
   903*    -------------------------------
   904     05  DESC7L PIC S9(0004) COMP.
   905     05  DESC7F PIC  X(0001).
   906     05  FILLER REDEFINES DESC7F.
   907         10  DESC7A PIC  X(0001).
   908     05  DESC7I PIC  X(0040).
   909*    -------------------------------
   910     05  DESC8L PIC S9(0004) COMP.
   911     05  DESC8F PIC  X(0001).
   912     05  FILLER REDEFINES DESC8F.
   913         10  DESC8A PIC  X(0001).
   914     05  DESC8I PIC  X(0040).
   915*    -------------------------------
   916     05  MSGL PIC S9(0004) COMP.
   917     05  MSGF PIC  X(0001).
   918     05  FILLER REDEFINES MSGF.
   919         10  MSGA PIC  X(0001).
   920     05  MSGI PIC  X(0070).
   921*    -------------------------------
   922     05  PFKEYL PIC S9(0004) COMP.
   923     05  PFKEYF PIC  X(0001).
   924     05  FILLER REDEFINES PFKEYF.
   925         10  PFKEYA PIC  X(0001).
   926     05  PFKEYI PIC  X(0002).
   927 01  EL111AO REDEFINES EL111AI.
   928     05  FILLER            PIC  X(0012).
   929*    -------------------------------
   930     05  FILLER            PIC  X(0003).
   931     05  DATEO PIC  X(0008).
   932*    -------------------------------
   933     05  FILLER            PIC  X(0003).
   934     05  TIMEO PIC  X(0005).
   935*    -------------------------------
   936     05  FILLER            PIC  X(0003).
   937     05  MAINTO PIC  X(0001).
   938*    -------------------------------
   939     05  FILLER            PIC  X(0003).
   940     05  PGRMO PIC  X(0005).
   941*    -------------------------------
   942     05  FILLER            PIC  X(0003).
   943     05  OPTTYPEO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL111.cbl
   944*    -------------------------------
   945     05  FILLER            PIC  X(0003).
   946     05  DELOPTO PIC  X(0001).
   947*    -------------------------------
   948     05  FILLER            PIC  X(0003).
   949     05  DESC1O PIC  X(0040).
   950*    -------------------------------
   951     05  FILLER            PIC  X(0003).
   952     05  DESC2O PIC  X(0040).
   953*    -------------------------------
   954     05  FILLER            PIC  X(0003).
   955     05  DESC3O PIC  X(0040).
   956*    -------------------------------
   957     05  FILLER            PIC  X(0003).
   958     05  DESC4O PIC  X(0040).
   959*    -------------------------------
   960     05  FILLER            PIC  X(0003).
   961     05  DESC5O PIC  X(0040).
   962*    -------------------------------
   963     05  FILLER            PIC  X(0003).
   964     05  DESC6O PIC  X(0040).
   965*    -------------------------------
   966     05  FILLER            PIC  X(0003).
   967     05  DESC7O PIC  X(0040).
   968*    -------------------------------
   969     05  FILLER            PIC  X(0003).
   970     05  DESC8O PIC  X(0040).
   971*    -------------------------------
   972     05  FILLER            PIC  X(0003).
   973     05  MSGO PIC  X(0070).
   974*    -------------------------------
   975     05  FILLER            PIC  X(0003).
   976     05  PFKEYO PIC  X(0002).
   977*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL111.cbl
   979****************************************************************
   980*
   981* Copyright (c) 2007 by Clerity Solutions, Inc.
   982* All rights reserved.
   983*
   984****************************************************************
   985 01  DFHEIV.
   986   02  DFHEIV0               PIC X(35).
   987   02  DFHEIV1               PIC X(08).
   988   02  DFHEIV2               PIC X(08).
   989   02  DFHEIV3               PIC X(08).
   990   02  DFHEIV4               PIC X(06).
   991   02  DFHEIV5               PIC X(04).
   992   02  DFHEIV6               PIC X(04).
   993   02  DFHEIV7               PIC X(02).
   994   02  DFHEIV8               PIC X(02).
   995   02  DFHEIV9               PIC X(01).
   996   02  DFHEIV10              PIC S9(7) COMP-3.
   997   02  DFHEIV11              PIC S9(4) COMP SYNC.
   998   02  DFHEIV12              PIC S9(4) COMP SYNC.
   999   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1000   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1001   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1002   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1003   02  DFHEIV17              PIC X(04).
  1004   02  DFHEIV18              PIC X(04).
  1005   02  DFHEIV19              PIC X(04).
  1006   02  DFHEIV20              USAGE IS POINTER.
  1007   02  DFHEIV21              USAGE IS POINTER.
  1008   02  DFHEIV22              USAGE IS POINTER.
  1009   02  DFHEIV23              USAGE IS POINTER.
  1010   02  DFHEIV24              USAGE IS POINTER.
  1011   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1012   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1013   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1014   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1015   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1016   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1017   02  FILLER                PIC X(02).
  1018   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1019   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1020   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1021   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1022   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1023 LINKAGE  SECTION.
  1024*****************************************************************
  1025*                                                               *
  1026* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1027* All rights reserved.                                          *
  1028*                                                               *
  1029*****************************************************************
  1030 01  dfheiblk.
  1031     02  eibtime          pic s9(7) comp-3.
  1032     02  eibdate          pic s9(7) comp-3.
  1033     02  eibtrnid         pic x(4).
  1034     02  eibtaskn         pic s9(7) comp-3.
  1035     02  eibtrmid         pic x(4).
  1036     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL111.cbl
  1037     02  eibcposn         pic s9(4) comp.
  1038     02  eibcalen         pic s9(4) comp.
  1039     02  eibaid           pic x(1).
  1040     02  eibfiller1       pic x(1).
  1041     02  eibfn            pic x(2).
  1042     02  eibfiller2       pic x(2).
  1043     02  eibrcode         pic x(6).
  1044     02  eibfiller3       pic x(2).
  1045     02  eibds            pic x(8).
  1046     02  eibreqid         pic x(8).
  1047     02  eibrsrce         pic x(8).
  1048     02  eibsync          pic x(1).
  1049     02  eibfree          pic x(1).
  1050     02  eibrecv          pic x(1).
  1051     02  eibsend          pic x(1).
  1052     02  eibatt           pic x(1).
  1053     02  eibeoc           pic x(1).
  1054     02  eibfmh           pic x(1).
  1055     02  eibcompl         pic x(1).
  1056     02  eibsig           pic x(1).
  1057     02  eibconf          pic x(1).
  1058     02  eiberr           pic x(1).
  1059     02  eibrldbk         pic x(1).
  1060     02  eiberrcd         pic x(4).
  1061     02  eibsynrb         pic x(1).
  1062     02  eibnodat         pic x(1).
  1063     02  eibfiller5       pic x(2).
  1064     02  eibresp          pic 9(09) comp.
  1065     02  eibresp2         pic 9(09) comp.
  1066     02  dfheigdj         pic s9(4) comp.
  1067     02  dfheigdk         pic s9(4) comp.
  1068 01  DFHCOMMAREA                 PIC X(1024).
  1069
  1070*01 PARM-LIST .
  1071*    12  FILLER                  PIC S9(8)  COMP.
  1072*    12  PGMO-PNT                PIC S9(8)  COMP.
  1073*    12  PGMN-PNT                PIC S9(8)  COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL111.cbl
  1075*    COPY ELCPGMO.
  1076******************************************************************
  1077*                                                                *
  1078*                                                                *
  1079*                            ELCPGMO.                            *
  1080*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1081*                            VMOD=2.002                          *
  1082*                                                                *
  1083*   FILE DESCRIPTION = AVAILABLE PROGRAM OPTIONS                 *
  1084*                                                                *
  1085*   FILE TYPE = VSAM,KSDS                                        *
  1086*   RECORD SIZE = 49    RECFORM = FIX                            *
  1087*                                                                *
  1088*   BASE CLUSTER NAME = ELPGMO                RKP=2,LEN=7        *
  1089*       ALTERNATE PATH  = NOT USED                               *
  1090*                                                                *
  1091*   LOG = NO                                                     *
  1092*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1093******************************************************************
  1094 01  PROGRAM-OPTIONS-AVAILABLE.
  1095     12  PO-RECORD-ID                PIC XX.
  1096         88  VALID-PO-ID                VALUE 'PO'.
  1097
  1098     12  PO-CONTROL-PRIMARY.
  1099         16  PO-PROGRAM-NUMBER.
  1100             20  PO-SYSTEM-CODE      PIC XX.
  1101                 88  CLAS-IC-ONLINE     VALUE 'EL'.
  1102                 88  CLAS-IC-REPORT     VALUE 'EC'.
  1103                 88  CLAS-GL-BATCH      VALUE 'GL'.
  1104             20  PO-PROGRAM-SEQUENCE PIC 999.
  1105         16  PO-OPTION-TYPE          PIC X.
  1106             88  PO-FORMAT-OPTION       VALUE 'F'.
  1107             88  PO-PROCESS-OPTION      VALUE 'P'.
  1108             88  PO-TOTAL-OPTION        VALUE 'T'.
  1109         16  PO-PGM-OPTION-CD        PIC X.
  1110
  1111     12  PO-OPTION-DESCRIPTION       PIC X(40).
  1112
  1113******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL111.cbl
  1115*    COPY ELCPGMN.
  1116******************************************************************
  1117*                                                                *
  1118*                                                                *
  1119*                            ELCPGMN.                            *
  1120*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1121*                            VMOD=2.002                          *
  1122*                                                                *
  1123*   FILE DESCRIPTION = PROGRAM DESCRIPTIONS                      *
  1124*                                                                *
  1125*   FILE TYPE = VSAM,KSDS                                        *
  1126*   RECORD SIZE = 52    RECFORM = FIX                            *
  1127*                                                                *
  1128*   BASE CLUSTER NAME = ELPGMN                 RKP=2,LEN=5       *
  1129*       ALTERNATE PATH  = NOT USED                               *
  1130*                                                                *
  1131*   LOG = NO                                                     *
  1132*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1133******************************************************************
  1134 01  PROGRAM-DESCRIPTIONS.
  1135     12  PN-RECORD-ID                PIC XX.
  1136         88  VALID-PN-ID                VALUE 'PN'.
  1137
  1138     12  PN-CONTROL-PRIMARY.
  1139         16  PN-PROGRAM-NUMBER.
  1140             20  PN-SYSTEM-CODE      PIC XX.
  1141                 88  CLAS-IC-ONLINE     VALUE 'EL'.
  1142                 88  CLAS-IC-REPORT     VALUE 'EC'.
  1143                 88  CLAS-GL-BATCH      VALUE 'GL'.
  1144             20  PN-PROGRAM-SEQUENCE PIC 999.
  1145     12  PN-PROGRAM-DESCRIPTION      PIC X(40).
  1146     12  PN-TRANSACTION-CODE         PIC X(4).
  1147     12  PN-ENTRY-METHOD             PIC X.
  1148         88  ENTERED-FROM-CICS          VALUE 'C'.
  1149         88  ENTERED-FROM-CLASIC-MENU   VALUE 'M'.
  1150         88  ENTERED-FROM-BATCH         VALUE 'B'.
  1151
  1152******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL111.cbl
  1154 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1155                          PROGRAM-OPTIONS-AVAILABLE
  1156                          PROGRAM-DESCRIPTIONS.
  1157 0000-DFHEXIT SECTION.
  1158     MOVE '9#                    $   ' TO DFHEIV0.
  1159     MOVE 'EL111' TO DFHEIV1.
  1160     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1161
  1162     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1163
  1164     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1165     MOVE '5'                    TO DC-OPTION-CODE.
  1166     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  1167     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1168     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  1169
  1170     IF EIBCALEN = ZERO
  1171         GO TO 8800-UNAUTHORIZED-ACCESS.
  1172
  1173     IF PI-CALLING-PROGRAM NOT = LIT-PGM
  1174         IF PI-RETURN-TO-PROGRAM NOT = LIT-PGM
  1175             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  1176             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  1177             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  1178             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  1179             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  1180             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  1181             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  1182             MOVE LIT-PGM               TO  PI-CALLING-PROGRAM
  1183             MOVE LOW-VALUES            TO  EL111AO
  1184             GO TO 8100-SEND-MAP
  1185         ELSE
  1186             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  1187             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  1188             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  1189             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  1190             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  1191             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  1192             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  1193             MOVE SPACES                TO  PI-SAVED-PROGRAM-6
  1194             MOVE LOW-VALUES            TO  EL111AO
  1195             GO TO 8100-SEND-MAP.
  1196
  1197
  1198     IF EIBAID = DFHCLEAR
  1199             GO TO 9000-XCTL.
  1200
  1201     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1202         MOVE LOW-VALUES         TO EL111AO
  1203         MOVE LIT-IC             TO PFKEYL
  1204         MOVE INVALID-PFKEY      TO MSGO
  1205         GO TO 8110-SEND-DATA.
  1206
  1207
  1208* EXEC CICS RECEIVE
  1209*        MAP    ('EL111A')
  1210*        MAPSET ('EL111S')
  1211*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL111.cbl
  1212     MOVE 'EL111A' TO DFHEIV1
  1213     MOVE 'EL111S' TO DFHEIV2
  1214*    MOVE '8"T                   ''   #00001203' TO DFHEIV0
  1215     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  1216     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1217     MOVE X'2020233030303031323033' TO DFHEIV0(25:11)
  1218     CALL 'kxdfhei1' USING DFHEIV0,
  1219           DFHEIV1,
  1220           EL111AI,
  1221           DFHEIV99,
  1222           DFHEIV2,
  1223           DFHEIV99,
  1224           DFHEIV99
  1225     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1226
  1227
  1228     MOVE SPACES                 TO SCREEN-SWITCH MSGO.
  1229     PERFORM 0200-SET-ATTRB THRU 0210-EXIT.
  1230
  1231     IF PFKEYL GREATER ZERO
  1232         PERFORM 0100-TRANS-PF THRU 0110-EXIT.
  1233
  1234     IF SCREEN-ERROR
  1235         MOVE LIT-IC             TO PFKEYL
  1236         GO TO 8110-SEND-DATA.
  1237
  1238     IF EIBAID = DFHPF23
  1239         GO TO 9100-XCTL.
  1240
  1241     IF EIBAID = DFHPF24
  1242         GO TO 9200-XCTL.
  1243
  1244     IF EIBAID = DFHPF12
  1245         GO TO 8300-GET-HELP.
  1246
  1247     IF EIBAID NOT = DFHENTER
  1248         MOVE INVALID-PFKEY      TO MSGO
  1249         MOVE LIT-IC             TO MAINTL
  1250         GO TO 8110-SEND-DATA.
  1251
  1252     MOVE SPACE                  TO SCREEN-SWITCH.
  1253     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  1254
  1255     IF SCREEN-ERROR
  1256         GO TO 8110-SEND-DATA.
  1257
  1258     PERFORM 1100-SAVE-DESC   THRU 1110-EXIT.
  1259     PERFORM 1200-UPDATE-FILE THRU 1210-EXIT.
  1260
  1261     IF SCREEN-ERROR
  1262         GO TO 8110-SEND-DATA.
  1263
  1264     MOVE LIT-IC                 TO MAINTL.
  1265     MOVE SPACE                  TO MAINTO.
  1266     MOVE SPACE                  TO DELOPTO.
  1267
  1268     IF NOT SHOW-OPTION
  1269         MOVE END-UPDATE         TO MSGO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL111.cbl
  1270
  1271     PERFORM 0300-SET-DESC-ATTRB THRU 0310-EXIT.
  1272
  1273     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL111.cbl
  1275 0100-TRANS-PF.
  1276     IF EIBAID NOT = DFHENTER
  1277         MOVE INVALID-PFKEY      TO MSGO
  1278         MOVE LIT-X              TO SCREEN-SWITCH
  1279         GO TO 0110-EXIT.
  1280
  1281     IF PFKEYI NOT NUMERIC
  1282         MOVE INVALID-PFKEY      TO MSGO
  1283         MOVE LIT-X              TO SCREEN-SWITCH
  1284         GO TO 0110-EXIT.
  1285
  1286     IF PFKEYI LESS 1 OR GREATER 24
  1287         MOVE INVALID-PFKEY      TO MSGO
  1288         MOVE LIT-X              TO SCREEN-SWITCH
  1289         GO TO 0110-EXIT.
  1290
  1291     MOVE PFKEYI                  TO CHECK-PFKEYS.
  1292     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  1293
  1294 0110-EXIT.
  1295     EXIT.
  1296
  1297 0200-SET-ATTRB.
  1298     MOVE AL-UANON               TO MAINTA
  1299                                    OPTTYPEA
  1300                                    DELOPTA
  1301                                    PGRMA.
  1302
  1303 0210-EXIT.
  1304     EXIT.
  1305
  1306 0300-SET-DESC-ATTRB.
  1307     MOVE AL-UANOF               TO DESC1A
  1308                                    DESC2A
  1309                                    DESC3A
  1310                                    DESC4A
  1311                                    DESC5A
  1312                                    DESC6A
  1313                                    DESC7A
  1314                                    DESC8A.
  1315
  1316 0310-EXIT.
  1317     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL111.cbl
  1319 1000-EDIT-SCREEN.
  1320     MOVE MAINTI                 TO CHECK-MAINT.
  1321
  1322     IF (NOT VALID-OPTION) OR
  1323        (PI-PROCESSOR-ID NOT = 'LGXX' AND 'JJPA' AND 'PEMA'
  1324                         AND NOT SHOW-OPTION)
  1325**      (PI-PROCESSOR-ID NOT = 'LGXX' AND NOT SHOW-OPTION)
  1326         MOVE AL-UABON           TO MAINTA
  1327         MOVE LIT-IC             TO MAINTL
  1328         MOVE MAINT-MIS          TO MSGO
  1329         MOVE LIT-X              TO SCREEN-SWITCH
  1330         GO TO 1010-EXIT.
  1331
  1332     IF PGRMI = SPACES OR LOW-VALUES
  1333         MOVE LIT-IC             TO PGRML
  1334         MOVE AL-UABON           TO PGRMA
  1335         MOVE PGM-MIS            TO MSGO
  1336         MOVE LIT-X              TO SCREEN-SWITCH
  1337         GO TO 1010-EXIT.
  1338
  1339     MOVE PGRMI                  TO PGM-NO.
  1340     IF PGM-PREF NOT = LIT-CLAIM AND LIT-EC AND LIT-GL AND LIT-EM
  1341         MOVE LIT-IC             TO PGRML
  1342         MOVE AL-UABON           TO PGRMA
  1343         MOVE PGM-MIS            TO MSGO
  1344         MOVE LIT-X              TO SCREEN-SWITCH
  1345         GO TO 1010-EXIT.
  1346
  1347     IF CHANGE-OPTION
  1348         PERFORM 1050-VERIFY-PGM THRU 1070-EXIT.
  1349
  1350     IF SCREEN-ERROR
  1351         MOVE LIT-IC             TO PGRML
  1352         MOVE AL-UABON           TO PGRMA
  1353         MOVE PGM-FILE-MIS       TO MSGO
  1354         GO TO 1010-EXIT.
  1355
  1356     MOVE OPTTYPEI TO CHECK-TYPE.
  1357
  1358     IF NOT VALID-TYPE
  1359         MOVE AL-UABON           TO OPTTYPEA
  1360         MOVE LIT-IC             TO OPTTYPEL
  1361         MOVE OPT-MIS            TO MSGO
  1362         MOVE LIT-X              TO SCREEN-SWITCH
  1363         GO TO 1010-EXIT.
  1364
  1365     PERFORM 1020-VERIFY-DEL-OPT THRU 1040-EXIT.
  1366
  1367 1010-EXIT.
  1368     EXIT.
  1369
  1370 1020-VERIFY-DEL-OPT.
  1371     IF DELOPTI = SPACES  AND
  1372        NOT DELETE-OPTION
  1373         GO TO 1040-EXIT.
  1374
  1375     IF DELOPTL = ZEROS  AND
  1376        NOT DELETE-OPTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL111.cbl
  1377         GO TO 1040-EXIT.
  1378
  1379     MOVE LIT-D                  TO SCREEN-SWITCH.
  1380
  1381     IF DELOPTI = LIT-A
  1382         GO TO 1040-EXIT.
  1383
  1384     IF DELOPTI LESS '1'
  1385         GO TO 1030-FORMAT-ERR.
  1386
  1387     IF DELOPTI GREATER '8'
  1388         GO TO 1030-FORMAT-ERR.
  1389
  1390     IF DELETE-CODE-PRESENT AND DELETE-OPTION
  1391         GO TO 1040-EXIT.
  1392
  1393     IF DELETE-OPTION AND NOT DELETE-CODE-PRESENT
  1394         MOVE LIT-IC             TO DELOPTL
  1395         MOVE AL-UABON           TO DELOPTA
  1396         MOVE DEL-OPT-MIS        TO MSGO
  1397         MOVE LIT-X              TO SCREEN-SWITCH
  1398         GO TO 1040-EXIT.
  1399
  1400     IF DELETE-CODE-PRESENT AND NOT DELETE-OPTION
  1401         MOVE LIT-IC             TO DELOPTL
  1402         MOVE AL-UABON           TO DELOPTA
  1403         MOVE DEL-OPT-ERROR      TO MSGO
  1404         MOVE LIT-X              TO SCREEN-SWITCH.
  1405
  1406     GO TO 1040-EXIT.
  1407
  1408 1030-FORMAT-ERR.
  1409     MOVE LIT-IC                 TO DELOPTL.
  1410     MOVE AL-UABON               TO DELOPTA.
  1411     MOVE DEL-OPT-INV            TO MSGO.
  1412     MOVE LIT-X                  TO SCREEN-SWITCH.
  1413
  1414 1040-EXIT.
  1415     EXIT.
  1416
  1417 1050-VERIFY-PGM.
  1418     MOVE PGRMI                  TO NAME-KEY.
  1419
  1420* EXEC CICS HANDLE CONDITION
  1421*        NOTFND (1060-PGM-NOTFND)
  1422*    END-EXEC.
  1423*    MOVE '"$I                   ! " #00001399' TO DFHEIV0
  1424     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  1425     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1426     MOVE X'2220233030303031333939' TO DFHEIV0(25:11)
  1427     CALL 'kxdfhei1' USING DFHEIV0
  1428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1429
  1430
  1431     PERFORM 1680-READ-PGMN THRU 1690-EXIT.
  1432     GO TO 1070-EXIT.
  1433
  1434 1060-PGM-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL111.cbl
  1435     MOVE LIT-X                  TO SCREEN-SWITCH.
  1436
  1437 1070-EXIT.
  1438     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL111.cbl
  1440 1100-SAVE-DESC.
  1441     IF DESC1I GREATER LOW-VALUES
  1442         MOVE DESC1I             TO HOLD-DESC (1)
  1443     ELSE
  1444         MOVE SPACES             TO HOLD-DESC (1).
  1445
  1446     IF DESC2I GREATER LOW-VALUES
  1447         MOVE DESC2I             TO HOLD-DESC (2)
  1448     ELSE
  1449         MOVE SPACES             TO HOLD-DESC (2).
  1450
  1451     IF DESC3I GREATER LOW-VALUES
  1452         MOVE DESC3I             TO HOLD-DESC (3)
  1453     ELSE
  1454         MOVE SPACES             TO HOLD-DESC (3).
  1455
  1456     IF DESC4I GREATER LOW-VALUES
  1457         MOVE DESC4I             TO HOLD-DESC (4)
  1458     ELSE
  1459         MOVE SPACES             TO HOLD-DESC (4).
  1460
  1461     IF DESC5I GREATER LOW-VALUES
  1462         MOVE DESC5I             TO HOLD-DESC (5)
  1463     ELSE
  1464         MOVE SPACES             TO HOLD-DESC (5).
  1465
  1466     IF DESC6I GREATER LOW-VALUES
  1467         MOVE DESC6I             TO HOLD-DESC (6)
  1468     ELSE
  1469         MOVE SPACES             TO HOLD-DESC (6).
  1470
  1471     IF DESC7I GREATER LOW-VALUES
  1472         MOVE DESC7I             TO HOLD-DESC (7)
  1473     ELSE
  1474         MOVE SPACES             TO HOLD-DESC (7).
  1475
  1476     IF DESC8I GREATER LOW-VALUES
  1477         MOVE DESC8I             TO HOLD-DESC (8)
  1478     ELSE
  1479         MOVE SPACES             TO HOLD-DESC (8).
  1480
  1481 1110-EXIT.
  1482     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL111.cbl
  1484 1200-UPDATE-FILE.
  1485     MOVE ZEROS                  TO COUNT-1.
  1486     MOVE SPACES                 TO SCREEN-SWITCH UPDATE-SWITCH.
  1487
  1488     IF DELETE-OPTION
  1489         PERFORM 1300-DELETE-OPTION THRU 1310-EXIT.
  1490
  1491     IF CHANGE-OPTION
  1492         PERFORM 1400-CHANGE-OPTION THRU 1410-EXIT
  1493                 UNTIL UPDATE-COMPLETE OR NOTHING-CHANGED.
  1494
  1495     IF UPDATE-COMPLETE
  1496         MOVE ZEROES             TO COUNT-1
  1497         MOVE SPACES             TO SCREEN-SWITCH UPDATE-SWITCH
  1498         MOVE LIT-S              TO CHECK-MAINT.
  1499
  1500     IF SHOW-OPTION
  1501         PERFORM 1500-SHOW-OPTION THRU 1540-EXIT.
  1502
  1503 1210-EXIT.
  1504     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL111.cbl
  1506 1300-DELETE-OPTION.
  1507     MOVE PGRMI                  TO PGM-NO.
  1508     MOVE OPTTYPEI               TO OPT-TYPE.
  1509
  1510     IF DELOPTI = LIT-A
  1511         MOVE ZEROS              TO COUNT-1
  1512         PERFORM 1320-DELETE-ALL THRU 1330-EXIT 9 TIMES
  1513         GO TO 1310-EXIT.
  1514
  1515     MOVE DELOPTI                TO OPT-CODE.
  1516     PERFORM 1340-DELETE-ONE THRU 1360-EXIT.
  1517
  1518 1310-EXIT.
  1519     EXIT.
  1520
  1521 1320-DELETE-ALL.
  1522
  1523* EXEC CICS HANDLE CONDITION
  1524*        NOTFND (1330-EXIT)
  1525*    END-EXEC.
  1526*    MOVE '"$I                   ! # #00001494' TO DFHEIV0
  1527     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  1528     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1529     MOVE X'2320233030303031343934' TO DFHEIV0(25:11)
  1530     CALL 'kxdfhei1' USING DFHEIV0
  1531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1532
  1533
  1534     ADD 1 TO COUNT-1.
  1535     MOVE COUNT-1 TO OPT-CODE.
  1536     PERFORM 1600-READ-UPDATE THRU 1610-EXIT.
  1537     MOVE LIT-D                     TO JP-RECORD-TYPE.
  1538     MOVE PROGRAM-OPTIONS-AVAILABLE TO JP-RECORD-AREA.
  1539     PERFORM 1620-DELETE THRU 1630-EXIT.
  1540     PERFORM 2000-JOURNAL-WRITE THRU 2010-EXIT.
  1541
  1542 1330-EXIT.
  1543     EXIT.
  1544
  1545 1340-DELETE-ONE.
  1546
  1547* EXEC CICS HANDLE CONDITION
  1548*        NOTFND (1350-DELETE-NOTFND)
  1549*    END-EXEC.
  1550*    MOVE '"$I                   ! $ #00001510' TO DFHEIV0
  1551     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  1552     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1553     MOVE X'2420233030303031353130' TO DFHEIV0(25:11)
  1554     CALL 'kxdfhei1' USING DFHEIV0
  1555     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1556
  1557
  1558     PERFORM 1600-READ-UPDATE THRU 1610-EXIT.
  1559     MOVE LIT-D                  TO JP-RECORD-TYPE.
  1560     MOVE PROGRAM-OPTIONS-AVAILABLE TO JP-RECORD-AREA.
  1561     PERFORM 1620-DELETE THRU 1630-EXIT.
  1562     PERFORM 2000-JOURNAL-WRITE THRU 2010-EXIT.
  1563     GO TO 1360-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL111.cbl
  1564
  1565 1350-DELETE-NOTFND.
  1566     MOVE LIT-IC                 TO DELOPTL.
  1567     MOVE AL-UABON               TO DELOPTA.
  1568     MOVE DEL-OPT-INV            TO MSGO.
  1569     MOVE LIT-X                  TO SCREEN-SWITCH.
  1570
  1571 1360-EXIT.
  1572     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL111.cbl
  1574 1400-CHANGE-OPTION.
  1575     MOVE PGRMI                  TO PGM-NO.
  1576     MOVE OPTTYPEI               TO OPT-TYPE.
  1577     MOVE SPACES                 TO FIND-SWITCH.
  1578     PERFORM 1430-FIND-UPDATE THRU 1440-EXIT
  1579         UNTIL END-UPDATES OR UPDATE-FOUND.
  1580
  1581     IF END-UPDATES
  1582         PERFORM 1450-CHECK-UPDATE THRU 1460-EXIT
  1583         GO TO 1410-EXIT.
  1584
  1585     MOVE LIT-A                  TO SCREEN-SWITCH.
  1586     MOVE COUNT-1                TO OPT-CODE.
  1587
  1588
  1589* EXEC CICS HANDLE CONDITION
  1590*        NOTFND (1410-ADD-OPTION)
  1591*    END-EXEC.
  1592*    MOVE '"$I                   ! % #00001544' TO DFHEIV0
  1593     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  1594     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1595     MOVE X'2520233030303031353434' TO DFHEIV0(25:11)
  1596     CALL 'kxdfhei1' USING DFHEIV0
  1597     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1598
  1599
  1600     PERFORM 1600-READ-UPDATE THRU 1610-EXIT.
  1601     MOVE LIT-B                  TO JP-RECORD-TYPE.
  1602     MOVE PROGRAM-OPTIONS-AVAILABLE TO JP-RECORD-AREA.
  1603     PERFORM 2000-JOURNAL-WRITE THRU 2010-EXIT.
  1604     MOVE HOLD-DESC (COUNT-1)    TO PO-OPTION-DESCRIPTION.
  1605     MOVE LIT-C                  TO JP-RECORD-TYPE.
  1606     MOVE PROGRAM-OPTIONS-AVAILABLE TO JP-RECORD-AREA.
  1607     PERFORM 1640-REWRITE THRU 1650-EXIT.
  1608     PERFORM 2000-JOURNAL-WRITE THRU 2010-EXIT.
  1609     GO TO 1410-EXIT.
  1610
  1611 1410-ADD-OPTION.
  1612
  1613* EXEC CICS GETMAIN
  1614*        SET     (ADDRESS OF PROGRAM-OPTIONS-AVAILABLE)
  1615*        LENGTH  (PGMO-LENGTH)
  1616*        INITIMG (LIT-SPACE)
  1617*    END-EXEC.
  1618*    MOVE ',"IL                  $   #00001560' TO DFHEIV0
  1619     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  1620     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1621     MOVE X'2020233030303031353630' TO DFHEIV0(25:11)
  1622     CALL 'kxdfhei1' USING DFHEIV0,
  1623           DFHEIV20,
  1624           PGMO-LENGTH,
  1625           LIT-SPACE
  1626     SET ADDRESS OF PROGRAM-OPTIONS-AVAILABLE TO
  1627         DFHEIV20
  1628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1629
  1630
  1631     MOVE BROWSE-KEY                TO PO-CONTROL-PRIMARY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL111.cbl
  1632     MOVE HOLD-DESC (COUNT-1)       TO PO-OPTION-DESCRIPTION.
  1633     MOVE LIT-PO                    TO PO-RECORD-ID.
  1634     MOVE LIT-A                     TO JP-RECORD-TYPE.
  1635     MOVE PROGRAM-OPTIONS-AVAILABLE TO JP-RECORD-AREA.
  1636
  1637     PERFORM 1660-WRITE THRU 1670-EXIT.
  1638     PERFORM 2000-JOURNAL-WRITE THRU 2010-EXIT.
  1639
  1640 1410-EXIT.
  1641     EXIT.
  1642
  1643 1430-FIND-UPDATE.
  1644     ADD 1 TO COUNT-1.
  1645
  1646     IF COUNT-1 = 9
  1647         MOVE LIT-E              TO FIND-SWITCH
  1648         GO TO 1440-EXIT.
  1649
  1650     IF HOLD-DESC (COUNT-1) = SPACES
  1651         GO TO 1440-EXIT.
  1652
  1653     MOVE LIT-D                  TO FIND-SWITCH.
  1654
  1655 1440-EXIT.
  1656     EXIT.
  1657
  1658 1450-CHECK-UPDATE.
  1659     IF UPDATES-MADE
  1660         MOVE LIT-D              TO UPDATE-SWITCH
  1661         GO TO 1460-EXIT.
  1662
  1663     MOVE LIT-E                  TO UPDATE-SWITCH.
  1664     MOVE NO-UPDATES             TO MSGO.
  1665     MOVE LIT-IC                 TO MAINTL.
  1666     MOVE LIT-X                  TO SCREEN-SWITCH.
  1667
  1668 1460-EXIT.
  1669     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL111.cbl
  1671 1500-SHOW-OPTION.
  1672
  1673* EXEC CICS HANDLE CONDITION
  1674*        NOTFND (1530-SHOW-BUILD)
  1675*        ENDFILE (1520-END-BROWSE)
  1676*    END-EXEC.
  1677*    MOVE '"$I''                  ! & #00001607' TO DFHEIV0
  1678     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  1679     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1680     MOVE X'2620233030303031363037' TO DFHEIV0(25:11)
  1681     CALL 'kxdfhei1' USING DFHEIV0
  1682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1683
  1684
  1685     MOVE PGRMI                  TO PGM-NO.
  1686     MOVE OPTTYPEI               TO OPT-TYPE.
  1687     MOVE SPACES                 TO OPT-CODE DESC-HOLD.
  1688     MOVE BROWSE-KEY             TO SAVE-KEY.
  1689     PERFORM 1700-START-BROWSE THRU 1710-EXIT.
  1690     PERFORM 1720-RESET-BROWSE THRU 1730-EXIT.
  1691
  1692 1510-BROWSE-CONT.
  1693     PERFORM 1740-READ-NEXT THRU 1750-EXIT.
  1694     MOVE PO-CONTROL-PRIMARY     TO RECORD-KEY.
  1695
  1696     IF GENERIC-KEY NOT = SAVE-KEY
  1697         GO TO 1520-END-BROWSE.
  1698     ADD 1 TO COUNT-1.
  1699
  1700     MOVE OPT-CODE               TO HOLD-OPT.
  1701     MOVE PO-OPTION-DESCRIPTION  TO HOLD-DESC (HOLD-OPT).
  1702     GO TO 1510-BROWSE-CONT.
  1703
  1704 1520-END-BROWSE.
  1705     PERFORM 1760-END-BROWSE THRU 1770-EXIT.
  1706
  1707 1530-SHOW-BUILD.
  1708     IF DESC-HOLD = SPACES
  1709         MOVE NO-OPTIONS-PRESENT TO MSGO
  1710         GO TO 1540-EXIT.
  1711
  1712     MOVE HOLD-DESC (1)          TO DESC1O.
  1713     MOVE HOLD-DESC (2)          TO DESC2O.
  1714     MOVE HOLD-DESC (3)          TO DESC3O.
  1715     MOVE HOLD-DESC (4)          TO DESC4O.
  1716     MOVE HOLD-DESC (5)          TO DESC5O.
  1717     MOVE HOLD-DESC (6)          TO DESC6O.
  1718     MOVE HOLD-DESC (7)          TO DESC7O.
  1719     MOVE HOLD-DESC (8)          TO DESC8O.
  1720
  1721 1540-EXIT.
  1722     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL111.cbl
  1724 1600-READ-UPDATE.
  1725
  1726* EXEC CICS READ
  1727*        SET (ADDRESS OF PROGRAM-OPTIONS-AVAILABLE)
  1728*        DATASET (LIT-FILE)
  1729*        RIDFLD (BROWSE-KEY)
  1730*        UPDATE
  1731*    END-EXEC.
  1732*    MOVE '&"S        EU         (   #00001652' TO DFHEIV0
  1733     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1734     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1735     MOVE X'2020233030303031363532' TO DFHEIV0(25:11)
  1736     CALL 'kxdfhei1' USING DFHEIV0,
  1737           LIT-FILE,
  1738           DFHEIV20,
  1739           DFHEIV99,
  1740           BROWSE-KEY,
  1741           DFHEIV99,
  1742           DFHEIV99,
  1743           DFHEIV99
  1744     SET ADDRESS OF PROGRAM-OPTIONS-AVAILABLE TO
  1745         DFHEIV20
  1746     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1747
  1748
  1749 1610-EXIT.
  1750     EXIT.
  1751
  1752 1620-DELETE.
  1753
  1754* EXEC CICS DELETE
  1755*        DATASET (LIT-FILE)
  1756*    END-EXEC.
  1757*    MOVE '&(                    &   #00001663' TO DFHEIV0
  1758     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1759     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1760     MOVE X'2020233030303031363633' TO DFHEIV0(25:11)
  1761     CALL 'kxdfhei1' USING DFHEIV0,
  1762           LIT-FILE,
  1763           DFHEIV99,
  1764           DFHEIV99,
  1765           DFHEIV99,
  1766           DFHEIV99
  1767     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1768
  1769
  1770 1630-EXIT.
  1771     EXIT.
  1772
  1773 1640-REWRITE.
  1774
  1775* EXEC CICS REWRITE
  1776*        FROM (PROGRAM-OPTIONS-AVAILABLE)
  1777*        DATASET (LIT-FILE)
  1778*    END-EXEC.
  1779     MOVE LENGTH OF
  1780      PROGRAM-OPTIONS-AVAILABLE
  1781       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL111.cbl
  1782*    MOVE '&& L                  %   #00001671' TO DFHEIV0
  1783     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1784     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1785     MOVE X'2020233030303031363731' TO DFHEIV0(25:11)
  1786     CALL 'kxdfhei1' USING DFHEIV0,
  1787           LIT-FILE,
  1788           PROGRAM-OPTIONS-AVAILABLE,
  1789           DFHEIV11,
  1790           DFHEIV99
  1791     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1792
  1793
  1794 1650-EXIT.
  1795     EXIT.
  1796
  1797 1660-WRITE.
  1798
  1799* EXEC CICS WRITE
  1800*        FROM (PROGRAM-OPTIONS-AVAILABLE)
  1801*        DATASET (LIT-FILE)
  1802*        RIDFLD (BROWSE-KEY)
  1803*    END-EXEC.
  1804     MOVE LENGTH OF
  1805      PROGRAM-OPTIONS-AVAILABLE
  1806       TO DFHEIV11
  1807*    MOVE '&$ L                  ''   #00001680' TO DFHEIV0
  1808     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  1809     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1810     MOVE X'2020233030303031363830' TO DFHEIV0(25:11)
  1811     CALL 'kxdfhei1' USING DFHEIV0,
  1812           LIT-FILE,
  1813           PROGRAM-OPTIONS-AVAILABLE,
  1814           DFHEIV11,
  1815           BROWSE-KEY,
  1816           DFHEIV99,
  1817           DFHEIV99
  1818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1819
  1820
  1821 1670-EXIT.
  1822     EXIT.
  1823
  1824 1680-READ-PGMN.
  1825
  1826* EXEC CICS READ
  1827*        SET     (ADDRESS OF PROGRAM-DESCRIPTIONS)
  1828*        DATASET (LIT-FILE-2)
  1829*        RIDFLD  (NAME-KEY)
  1830*    END-EXEC.
  1831*    MOVE '&"S        E          (   #00001690' TO DFHEIV0
  1832     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1833     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1834     MOVE X'2020233030303031363930' TO DFHEIV0(25:11)
  1835     CALL 'kxdfhei1' USING DFHEIV0,
  1836           LIT-FILE-2,
  1837           DFHEIV20,
  1838           DFHEIV99,
  1839           NAME-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL111.cbl
  1840           DFHEIV99,
  1841           DFHEIV99,
  1842           DFHEIV99
  1843     SET ADDRESS OF PROGRAM-DESCRIPTIONS TO
  1844         DFHEIV20
  1845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1846
  1847
  1848 1690-EXIT.
  1849     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL111.cbl
  1851 1700-START-BROWSE.
  1852
  1853* EXEC CICS STARTBR
  1854*        DATASET   (LIT-FILE)
  1855*        RIDFLD    (BROWSE-KEY)
  1856*        KEYLENGTH (SHOW-LENGTH)
  1857*        GENERIC
  1858*        EQUAL
  1859*    END-EXEC.
  1860     MOVE 0
  1861       TO DFHEIV11
  1862*    MOVE '&,   KG    E          &   #00001700' TO DFHEIV0
  1863     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
  1864     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1865     MOVE X'2020233030303031373030' TO DFHEIV0(25:11)
  1866     CALL 'kxdfhei1' USING DFHEIV0,
  1867           LIT-FILE,
  1868           BROWSE-KEY,
  1869           SHOW-LENGTH,
  1870           DFHEIV11,
  1871           DFHEIV99
  1872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1873
  1874
  1875 1710-EXIT.
  1876     EXIT.
  1877
  1878 1720-RESET-BROWSE.
  1879
  1880* EXEC CICS RESETBR
  1881*        DATASET (LIT-FILE)
  1882*        RIDFLD  (BROWSE-KEY)
  1883*    END-EXEC.
  1884     MOVE 0
  1885       TO DFHEIV11
  1886*    MOVE '&4         G          &   #00001712' TO DFHEIV0
  1887     MOVE X'263420202020202020202047' TO DFHEIV0(1:12)
  1888     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1889     MOVE X'2020233030303031373132' TO DFHEIV0(25:11)
  1890     CALL 'kxdfhei1' USING DFHEIV0,
  1891           LIT-FILE,
  1892           BROWSE-KEY,
  1893           DFHEIV99,
  1894           DFHEIV11,
  1895           DFHEIV99
  1896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1897
  1898
  1899 1730-EXIT.
  1900     EXIT.
  1901
  1902 1740-READ-NEXT.
  1903
  1904* EXEC CICS READNEXT
  1905*        DATASET (LIT-FILE)
  1906*        RIDFLD  (BROWSE-KEY)
  1907*        SET     (ADDRESS OF PROGRAM-OPTIONS-AVAILABLE)
  1908*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL111.cbl
  1909     MOVE 0
  1910       TO DFHEIV11
  1911*    MOVE '&.S                   )   #00001721' TO DFHEIV0
  1912     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1913     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1914     MOVE X'2020233030303031373231' TO DFHEIV0(25:11)
  1915     CALL 'kxdfhei1' USING DFHEIV0,
  1916           LIT-FILE,
  1917           DFHEIV20,
  1918           DFHEIV99,
  1919           BROWSE-KEY,
  1920           DFHEIV99,
  1921           DFHEIV11,
  1922           DFHEIV99,
  1923           DFHEIV99
  1924     SET ADDRESS OF PROGRAM-OPTIONS-AVAILABLE TO
  1925         DFHEIV20
  1926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1927
  1928
  1929 1750-EXIT.
  1930     EXIT.
  1931
  1932 1760-END-BROWSE.
  1933
  1934* EXEC CICS ENDBR
  1935*        DATASET (LIT-FILE)
  1936*    END-EXEC.
  1937     MOVE 0
  1938       TO DFHEIV11
  1939*    MOVE '&2                    $   #00001731' TO DFHEIV0
  1940     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1941     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1942     MOVE X'2020233030303031373331' TO DFHEIV0(25:11)
  1943     CALL 'kxdfhei1' USING DFHEIV0,
  1944           LIT-FILE,
  1945           DFHEIV11,
  1946           DFHEIV99
  1947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1948
  1949
  1950 1770-EXIT.
  1951     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL111.cbl
  1953 2000-JOURNAL-WRITE.
  1954     MOVE LIT-SYS                TO JP-USER-ID.
  1955     MOVE LIT-FILE               TO JP-FILE-ID.
  1956     MOVE LIT-PGM                TO JP-PROGRAM-ID.
  1957
  1958*    IF PI-JOURNAL-FILE-ID NOT = ZERO
  1959*        EXEC CICS JOURNAL
  1960*            JFILEID (1)
  1961*            JTYPEID ('EL')
  1962*            FROM (JOURNAL-RECORD)
  1963*            LENGTH (JOURNAL-LENGTH)
  1964*        END-EXEC.
  1965
  1966 2010-EXIT.
  1967     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL111.cbl
  1969 8100-SEND-MAP.
  1970     PERFORM 8130-FORMAT-DATE-TIME THRU 8140-EXIT.
  1971     MOVE LIT-IC                 TO MAINTL.
  1972
  1973* EXEC CICS SEND
  1974*        MAP    ('EL111A')
  1975*        MAPSET ('EL111S')
  1976*        ERASE
  1977*        FREEKB
  1978*        CURSOR
  1979*    END-EXEC.
  1980     MOVE 'EL111A' TO DFHEIV1
  1981     MOVE -1
  1982       TO DFHEIV11
  1983     MOVE 'EL111S' TO DFHEIV2
  1984*    MOVE '8$     CT  E F  H     ,   #00001757' TO DFHEIV0
  1985     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1986     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  1987     MOVE X'2020233030303031373537' TO DFHEIV0(25:11)
  1988     CALL 'kxdfhei1' USING DFHEIV0,
  1989           DFHEIV1,
  1990           EL111AO,
  1991           DFHEIV99,
  1992           DFHEIV2,
  1993           DFHEIV99,
  1994           DFHEIV99,
  1995           DFHEIV99,
  1996           DFHEIV11,
  1997           DFHEIV99,
  1998           DFHEIV99,
  1999           DFHEIV99
  2000     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2001
  2002
  2003     GO TO 8120-RETURN-TRANS.
  2004
  2005 8110-SEND-DATA.
  2006     PERFORM 8130-FORMAT-DATE-TIME THRU 8140-EXIT.
  2007
  2008
  2009* EXEC CICS SEND
  2010*        MAP    ('EL111A')
  2011*        MAPSET ('EL111S')
  2012*        DATAONLY
  2013*        ERASEAUP
  2014*        FREEKB
  2015*        CURSOR
  2016*    END-EXEC.
  2017     MOVE 'EL111A' TO DFHEIV1
  2018     MOVE -1
  2019       TO DFHEIV11
  2020     MOVE 'EL111S' TO DFHEIV2
  2021*    MOVE '8$D    CT  A F  H     ,   #00001770' TO DFHEIV0
  2022     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  2023     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  2024     MOVE X'2020233030303031373730' TO DFHEIV0(25:11)
  2025     CALL 'kxdfhei1' USING DFHEIV0,
  2026           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL111.cbl
  2027           EL111AO,
  2028           DFHEIV99,
  2029           DFHEIV2,
  2030           DFHEIV99,
  2031           DFHEIV99,
  2032           DFHEIV99,
  2033           DFHEIV11,
  2034           DFHEIV99,
  2035           DFHEIV99,
  2036           DFHEIV99
  2037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2038
  2039
  2040 8120-RETURN-TRANS.
  2041
  2042* EXEC CICS RETURN
  2043*        TRANSID  (LIT-TRANS)
  2044*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2045*        LENGTH   (PI-COMM-LENGTH)
  2046*    END-EXEC.
  2047*    MOVE '.(CT                  &   #00001780' TO DFHEIV0
  2048     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2049     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2050     MOVE X'2020233030303031373830' TO DFHEIV0(25:11)
  2051     CALL 'kxdfhei1' USING DFHEIV0,
  2052           LIT-TRANS,
  2053           PROGRAM-INTERFACE-BLOCK,
  2054           PI-COMM-LENGTH,
  2055           DFHEIV99,
  2056           DFHEIV99
  2057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2058
  2059
  2060* GOBACK.
  2061     MOVE '9%                    "   ' TO DFHEIV0
  2062     MOVE 'EL111' TO DFHEIV1
  2063     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2064     GOBACK.
  2065
  2066 8130-FORMAT-DATE-TIME.
  2067     MOVE SAVE-DATE              TO DATEO.
  2068
  2069* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
  2070*    END-EXEC
  2071*    MOVE '0"A                   "   #00001789' TO DFHEIV0
  2072     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
  2073     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  2074     MOVE X'2020233030303031373839' TO DFHEIV0(25:11)
  2075     CALL 'kxdfhei1' USING DFHEIV0,
  2076           LCP-CICS-TIME
  2077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2078
  2079* EXEC CICS FORMATTIME
  2080*              ABSTIME(LCP-CICS-TIME)
  2081*              TIME(LCP-TIME-OF-DAY-XX)
  2082*    END-EXEC
  2083*    MOVE 'j$(     (             #   #00001791' TO DFHEIV0
  2084     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL111.cbl
  2085     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2086     MOVE X'2020233030303031373931' TO DFHEIV0(25:11)
  2087     CALL 'kxdfhei1' USING DFHEIV0,
  2088           LCP-CICS-TIME,
  2089           LCP-TIME-OF-DAY-XX
  2090     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2091     MOVE  LCP-TIME-OF-DAY-68 TO TIME-UNFORMATTED.
  2092     MOVE UN-HOURS               TO FOR-HOURS.
  2093     MOVE UN-MINUTES             TO FOR-MINUTES.
  2094     MOVE TIME-FORMATTED         TO TIMEO.
  2095     MOVE LIT-MAP                TO PI-CURRENT-SCREEN-NO.
  2096
  2097 8140-EXIT.
  2098     EXIT.
  2099
  2100 8200-NO-UPDATES.
  2101
  2102* EXEC CICS SEND TEXT
  2103*        FROM   (SCREEN-TERM)
  2104*        LENGTH (TERM-LENGTH)
  2105*        ERASE
  2106*        FREEKB
  2107*    END-EXEC.
  2108*    MOVE '8&      T  E F  H   F -   #00001805' TO DFHEIV0
  2109     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2110     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2111     MOVE X'2020233030303031383035' TO DFHEIV0(25:11)
  2112     CALL 'kxdfhei1' USING DFHEIV0,
  2113           SCREEN-TERM,
  2114           TERM-LENGTH,
  2115           DFHEIV99,
  2116           DFHEIV99,
  2117           DFHEIV99,
  2118           DFHEIV99,
  2119           DFHEIV99,
  2120           DFHEIV99,
  2121           DFHEIV99,
  2122           DFHEIV99,
  2123           DFHEIV99,
  2124           DFHEIV99
  2125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2126
  2127
  2128 8220-RETURN-CICS.
  2129
  2130* EXEC CICS RETURN
  2131*    END-EXEC.
  2132*    MOVE '.(                    &   #00001813' TO DFHEIV0
  2133     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2134     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2135     MOVE X'2020233030303031383133' TO DFHEIV0(25:11)
  2136     CALL 'kxdfhei1' USING DFHEIV0,
  2137           DFHEIV99,
  2138           DFHEIV99,
  2139           DFHEIV99,
  2140           DFHEIV99,
  2141           DFHEIV99
  2142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL111.cbl
  2143
  2144
  2145* GOBACK.
  2146     MOVE '9%                    "   ' TO DFHEIV0
  2147     MOVE 'EL111' TO DFHEIV1
  2148     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2149     GOBACK.
  2150
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL111.cbl
  2152
  2153 8300-GET-HELP.
  2154     MOVE LIT-HELP TO CALL-PGM.
  2155     GO TO 9400-XCTL.
  2156
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL111.cbl
  2158 8800-UNAUTHORIZED-ACCESS.
  2159     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  2160     GO TO 8800-SEND-TEXT.
  2161
  2162 8800-SEND-TEXT.
  2163
  2164* EXEC CICS SEND TEXT
  2165*        FROM    (LOGOFF-TEXT)
  2166*        LENGTH  (LOGOFF-LENGTH)
  2167*        ERASE
  2168*        FREEKB
  2169*    END-EXEC.
  2170*    MOVE '8&      T  E F  H   F -   #00001829' TO DFHEIV0
  2171     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2172     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2173     MOVE X'2020233030303031383239' TO DFHEIV0(25:11)
  2174     CALL 'kxdfhei1' USING DFHEIV0,
  2175           LOGOFF-TEXT,
  2176           LOGOFF-LENGTH,
  2177           DFHEIV99,
  2178           DFHEIV99,
  2179           DFHEIV99,
  2180           DFHEIV99,
  2181           DFHEIV99,
  2182           DFHEIV99,
  2183           DFHEIV99,
  2184           DFHEIV99,
  2185           DFHEIV99,
  2186           DFHEIV99
  2187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2188
  2189
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL111.cbl
  2191 9000-XCTL.
  2192     MOVE PI-RETURN-TO-PROGRAM   TO CALL-PGM.
  2193     GO TO 9400-XCTL.
  2194
  2195 9100-XCTL.
  2196     MOVE XCTL-005               TO CALL-PGM.
  2197     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  2198     GO TO 9400-XCTL.
  2199
  2200 9200-XCTL.
  2201
  2202     IF  CREDIT-SESSION
  2203         MOVE XCTL-EL626         TO CALL-PGM
  2204
  2205     ELSE
  2206         IF  CLAIM-SESSION
  2207             MOVE XCTL-EL126     TO CALL-PGM
  2208
  2209         ELSE
  2210             IF  MORTGAGE-SESSION
  2211                 MOVE XCTL-EM626 TO CALL-PGM
  2212
  2213             ELSE
  2214                 IF  GENERAL-LEDGER-SESSION
  2215                     MOVE XCTL-GL800
  2216                                 TO CALL-PGM.
  2217
  2218     GO TO 9400-XCTL.
  2219
  2220 9400-XCTL.
  2221
  2222* EXEC CICS XCTL
  2223*        PROGRAM (CALL-PGM)
  2224*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2225*        LENGTH   (PI-COMM-LENGTH)
  2226*    END-EXEC.
  2227*    MOVE '.$C                   $   #00001867' TO DFHEIV0
  2228     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2229     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2230     MOVE X'2020233030303031383637' TO DFHEIV0(25:11)
  2231     CALL 'kxdfhei1' USING DFHEIV0,
  2232           CALL-PGM,
  2233           PROGRAM-INTERFACE-BLOCK,
  2234           PI-COMM-LENGTH
  2235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2236
  2237
  2238
  2239* GOBACK.
  2240     MOVE '9%                    "   ' TO DFHEIV0
  2241     MOVE 'EL111' TO DFHEIV1
  2242     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2243     GOBACK.
  2244
  2245 9700-LINK-DATE-CONVERT.
  2246
  2247* EXEC CICS LINK
  2248*        PROGRAM    ('ELDATCV')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL111.cbl
  2249*        COMMAREA   (DATE-CONVERSION-DATA)
  2250*        LENGTH     (DC-COMM-LENGTH)
  2251*    END-EXEC.
  2252     MOVE 'ELDATCV' TO DFHEIV1
  2253*    MOVE '."C                   ''   #00001876' TO DFHEIV0
  2254     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2255     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2256     MOVE X'2020233030303031383736' TO DFHEIV0(25:11)
  2257     CALL 'kxdfhei1' USING DFHEIV0,
  2258           DFHEIV1,
  2259           DATE-CONVERSION-DATA,
  2260           DC-COMM-LENGTH,
  2261           DFHEIV99,
  2262           DFHEIV99,
  2263           DFHEIV99
  2264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2265
  2266
  2267 9700-EXIT.
  2268     EXIT.
  2269
  2270 9999-DFHBACK SECTION.
  2271     MOVE '9%                    "   ' TO DFHEIV0
  2272     MOVE 'EL111' TO DFHEIV1
  2273     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2274     GOBACK.
  2275 9999-DFHEXIT.
  2276     IF DFHEIGDJ EQUAL 0001
  2277         NEXT SENTENCE
  2278     ELSE IF DFHEIGDJ EQUAL 2
  2279         GO TO 1060-PGM-NOTFND
  2280         DEPENDING ON DFHEIGDI
  2281     ELSE IF DFHEIGDJ EQUAL 3
  2282         GO TO 1330-EXIT
  2283         DEPENDING ON DFHEIGDI
  2284     ELSE IF DFHEIGDJ EQUAL 4
  2285         GO TO 1350-DELETE-NOTFND
  2286         DEPENDING ON DFHEIGDI
  2287     ELSE IF DFHEIGDJ EQUAL 5
  2288         GO TO 1410-ADD-OPTION
  2289         DEPENDING ON DFHEIGDI
  2290     ELSE IF DFHEIGDJ EQUAL 6
  2291         GO TO 1530-SHOW-BUILD,
  2292               1520-END-BROWSE
  2293         DEPENDING ON DFHEIGDI.
  2294     MOVE '9%                    "   ' TO DFHEIV0
  2295     MOVE 'EL111' TO DFHEIV1
  2296     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2297     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4296     Code:        6353
