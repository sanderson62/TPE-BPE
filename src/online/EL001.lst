* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page   1
* EL001.cbl
* Options: int("EL001.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL001.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL001.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL001.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL001 .
     4*                            VMOD=2.017.
     5
     6*AUTHOR.           LOGIC,INC.
     7*                  DALLAS,TEXAS.
     8*
     9*
    10 DATE-COMPILED. 10-Jul-13 14:03.
    11 SECURITY.   *****************************************************
    12             *                                                   *
    13             *    THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.    *
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page   2
* EL001.cbl
    14             *                                                   *
    15             *  USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES  *
    16             *  OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT   *
    17             *  THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.      *
    18             *                                                   *
    19             *****************************************************
    20
    21*REMARKS. ERROR TEXT PROCESSOR.
    22*         THIS IS A LINKED TO SUBROUTINE FOR HANDLING THE ERROR
    23*         LOOKUP AND TEXT FORMATTING OF THE ERROR LINES.
    24*
    25*
    26*         ANY PROGRAM CHANGES TO THIS MODULE SHOULD ALSO BE
    27*         APPLIED TO LGX001 WHEN CHANGES EFFECT LOGIC PROCESSING
    28*         CLIENTS.
    29
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page   3
* EL001.cbl
    31 ENVIRONMENT DIVISION.
    32 DATA DIVISION.
    33 WORKING-STORAGE SECTION.
    34 01  DFH-START PIC X(04).
    35 77  FILLER  PIC X(32)  VALUE '********************************'.
    36 77  FILLER  PIC X(32)  VALUE '*    EL001 WORKING STORAGE     *'.
    37 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.017 ************'.
    38
    39 01  WS-DATE-AREA.
    40     05  TRANS-EXB1              PIC X(4)    VALUE 'EXB1'.
    41     05  TRANS-MXB1              PIC X(4)    VALUE 'MXB1'.
    42     05  TRANS-MXA5              PIC X(4)    VALUE 'MXA5'.
    43     05  TRANS-MXA6              PIC X(4)    VALUE 'MXA6'.
    44     05  TRANS-MXB2              PIC X(4)    VALUE 'MXB2'.
    45     05  TRANS-MXB3              PIC X(4)    VALUE 'MXB3'.
    46     05  trans-ex19              pic x(4)    value 'EX19'.
    47     05  SAVE-DATE               PIC X(8)    VALUE SPACES.
    48
    49 01  WORK-AREA.
    50     12  MAP-LENGTH              PIC S9(4)  COMP.
    51     12  WCC-CNTL                PIC X      VALUE ' '.
    52     12  EM-KEY                  PIC 9(4).
    53     12  EM-FILE-ID              PIC X(8)    VALUE 'ELERRS'.
    54     12  EM-FILE-ID-FR           PIC X(8)    VALUE 'MPFERR'.
    55     12  FOUND-SWITCH            PIC 9       VALUE 0.
    56         88  REC-NOT-FOUND           VALUE 1.
    57     12  TIME-IN                 PIC S9(7).
    58     12  TIME-OUT REDEFINES TIME-IN.
    59         16  FILLER              PIC X.
    60         16  TIME-O              PIC 99V99.
    61         16  FILLER              PIC XX.
    62     12  ER-NUM                  PIC 99      VALUE 1.
    63     12  ER-SUB                  PIC 99      VALUE 0.
    64     12  WCC-CTL                 PIC X       VALUE ' '.
    65     12  WS-ERROR-LINE.
    66         16  WS-ERROR-NUMBER     PIC 9999.
    67         16  WS-FILL             PIC X.
    68         16  WS-ERROR-SEVERITY   PIC X.
    69         16  FILLER              PIC X.
    70         16  WS-ERROR-TEXT.
    71             20  WS-PREFIX       PIC X(06).
    72             20  FILLER          PIC X(59).
    73     12  TEMP-ID.
    74         16  TEMP-TERM           PIC X(4).
    75         16  FILLER              PIC X(4)    VALUE '001A'.
    76
    77*            COPY EL001S.
    78 01  EL001AI.
    79     05  FILLER            PIC  X(0012).
    80*    -------------------------------
    81     05  RUNDTEL PIC S9(0004) COMP.
    82     05  RUNDTEF PIC  X(0001).
    83     05  FILLER REDEFINES RUNDTEF.
    84         10  RUNDTEA PIC  X(0001).
    85     05  RUNDTEI PIC  X(0008).
    86*    -------------------------------
    87     05  RUNTIML PIC S9(0004) COMP.
    88     05  RUNTIMF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page   4
* EL001.cbl
    89     05  FILLER REDEFINES RUNTIMF.
    90         10  RUNTIMA PIC  X(0001).
    91     05  RUNTIMI PIC  X(0005).
    92*    -------------------------------
    93     05  L1L PIC S9(0004) COMP.
    94     05  L1F PIC  X(0001).
    95     05  FILLER REDEFINES L1F.
    96         10  L1A PIC  X(0001).
    97     05  L1I PIC  X(0072).
    98*    -------------------------------
    99     05  L2L PIC S9(0004) COMP.
   100     05  L2F PIC  X(0001).
   101     05  FILLER REDEFINES L2F.
   102         10  L2A PIC  X(0001).
   103     05  L2I PIC  X(0072).
   104*    -------------------------------
   105     05  L3L PIC S9(0004) COMP.
   106     05  L3F PIC  X(0001).
   107     05  FILLER REDEFINES L3F.
   108         10  L3A PIC  X(0001).
   109     05  L3I PIC  X(0072).
   110*    -------------------------------
   111     05  L4L PIC S9(0004) COMP.
   112     05  L4F PIC  X(0001).
   113     05  FILLER REDEFINES L4F.
   114         10  L4A PIC  X(0001).
   115     05  L4I PIC  X(0072).
   116*    -------------------------------
   117     05  L5L PIC S9(0004) COMP.
   118     05  L5F PIC  X(0001).
   119     05  FILLER REDEFINES L5F.
   120         10  L5A PIC  X(0001).
   121     05  L5I PIC  X(0072).
   122*    -------------------------------
   123     05  L6L PIC S9(0004) COMP.
   124     05  L6F PIC  X(0001).
   125     05  FILLER REDEFINES L6F.
   126         10  L6A PIC  X(0001).
   127     05  L6I PIC  X(0072).
   128*    -------------------------------
   129     05  L7L PIC S9(0004) COMP.
   130     05  L7F PIC  X(0001).
   131     05  FILLER REDEFINES L7F.
   132         10  L7A PIC  X(0001).
   133     05  L7I PIC  X(0072).
   134*    -------------------------------
   135     05  L8L PIC S9(0004) COMP.
   136     05  L8F PIC  X(0001).
   137     05  FILLER REDEFINES L8F.
   138         10  L8A PIC  X(0001).
   139     05  L8I PIC  X(0072).
   140*    -------------------------------
   141     05  L9L PIC S9(0004) COMP.
   142     05  L9F PIC  X(0001).
   143     05  FILLER REDEFINES L9F.
   144         10  L9A PIC  X(0001).
   145     05  L9I PIC  X(0072).
   146*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page   5
* EL001.cbl
   147     05  L10L PIC S9(0004) COMP.
   148     05  L10F PIC  X(0001).
   149     05  FILLER REDEFINES L10F.
   150         10  L10A PIC  X(0001).
   151     05  L10I PIC  X(0072).
   152*    -------------------------------
   153     05  L11L PIC S9(0004) COMP.
   154     05  L11F PIC  X(0001).
   155     05  FILLER REDEFINES L11F.
   156         10  L11A PIC  X(0001).
   157     05  L11I PIC  X(0072).
   158*    -------------------------------
   159     05  L12L PIC S9(0004) COMP.
   160     05  L12F PIC  X(0001).
   161     05  FILLER REDEFINES L12F.
   162         10  L12A PIC  X(0001).
   163     05  L12I PIC  X(0072).
   164 01  EL001AO REDEFINES EL001AI.
   165     05  FILLER            PIC  X(0012).
   166*    -------------------------------
   167     05  FILLER            PIC  X(0003).
   168     05  RUNDTEO PIC  X(0008).
   169*    -------------------------------
   170     05  FILLER            PIC  X(0003).
   171     05  RUNTIMO PIC  99.99.
   172*    -------------------------------
   173     05  FILLER            PIC  X(0003).
   174     05  L1O PIC  X(0072).
   175*    -------------------------------
   176     05  FILLER            PIC  X(0003).
   177     05  L2O PIC  X(0072).
   178*    -------------------------------
   179     05  FILLER            PIC  X(0003).
   180     05  L3O PIC  X(0072).
   181*    -------------------------------
   182     05  FILLER            PIC  X(0003).
   183     05  L4O PIC  X(0072).
   184*    -------------------------------
   185     05  FILLER            PIC  X(0003).
   186     05  L5O PIC  X(0072).
   187*    -------------------------------
   188     05  FILLER            PIC  X(0003).
   189     05  L6O PIC  X(0072).
   190*    -------------------------------
   191     05  FILLER            PIC  X(0003).
   192     05  L7O PIC  X(0072).
   193*    -------------------------------
   194     05  FILLER            PIC  X(0003).
   195     05  L8O PIC  X(0072).
   196*    -------------------------------
   197     05  FILLER            PIC  X(0003).
   198     05  L9O PIC  X(0072).
   199*    -------------------------------
   200     05  FILLER            PIC  X(0003).
   201     05  L10O PIC  X(0072).
   202*    -------------------------------
   203     05  FILLER            PIC  X(0003).
   204     05  L11O PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page   6
* EL001.cbl
   205*    -------------------------------
   206     05  FILLER            PIC  X(0003).
   207     05  L12O PIC  X(0072).
   208*    -------------------------------
   209 01  MAP-AREA REDEFINES EL001AI.
   210     12  FILLER                  PIC X(31).
   211     12  ERROR-LINES-FOR-MAP OCCURS 12 TIMES.
   212         16  FILLER              PIC X(3).
   213         16  ER-LINE             PIC X(72).
   214
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page   7
* EL001.cbl
   216*            COPY ELCEMIB.
   217******************************************************************
   218*                                                                *
   219*                                                                *
   220*                            ELCEMIB.                            *
   221*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   222*                            VMOD=2.005                          *
   223*                                                                *
   224*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   225*                                                                *
   226******************************************************************
   227 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   228     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   229     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   230     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   231     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   232     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   233     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   234     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   235     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   236     12  EMI-SWITCH1             PIC X        VALUE '1'.
   237         88  EMI-NO-ERRORS                    VALUE '1'.
   238         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   239         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   240     12  EMI-SWITCH2             PIC X        VALUE '1'.
   241         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   242     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   243         88  EMI-AREA1-EMPTY                  VALUE '1'.
   244         88  EMI-AREA1-FULL                   VALUE '2'.
   245     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   246         88  EMI-AREA2-EMPTY                  VALUE '1'.
   247         88  EMI-AREA2-FULL                   VALUE '2'.
   248     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   249         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   250         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   251         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   252         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   253         88  EMI-BYPASS-FATALS                VALUE 'X'.
   254     12  EMI-ERROR-LINES.
   255         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   256         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   257         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   258         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   259             20  EMI-ERR-CODES OCCURS 10 TIMES.
   260                 24  EMI-ERR-NUM         PIC X(4).
   261                 24  EMI-FILLER          PIC X.
   262                 24  EMI-SEV             PIC X.
   263                 24  FILLER              PIC X.
   264             20  FILLER                  PIC X(02).
   265     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   266         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   267             20  EMI-ERROR-NUMBER    PIC X(4).
   268             20  EMI-FILL            PIC X.
   269             20  EMI-SEVERITY        PIC X.
   270             20  FILLER              PIC X.
   271             20  EMI-ERROR-TEXT.
   272                 24  EMI-TEXT-VARIABLE   PIC X(10).
   273                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page   8
* EL001.cbl
   274     12  EMI-SEVERITY-SAVE           PIC X.
   275         88  EMI-NOTE                    VALUE 'N'.
   276         88  EMI-WARNING                 VALUE 'W'.
   277         88  EMI-FORCABLE                VALUE 'F'.
   278         88  EMI-FATAL                   VALUE 'X'.
   279     12  EMI-MESSAGE-FLAG            PIC X.
   280         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   281         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   282     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   283     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   284         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   285         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   286         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   287     12  emi-claim-no                pic x(7).
   288     12  emi-claim-type              pic x(6).
   289     12  FILLER                      PIC X(124)  VALUE SPACES.
   290     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   291     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   292     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   293     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page   9
* EL001.cbl
   295*            COPY ELCDATE.
   296******************************************************************
   297*                                                                *
   298*                                                                *
   299*                            ELCDATE.                            *
   300*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   301*                            VMOD=2.003
   302*                                                                *
   303*                                                                *
   304*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   305*                 LENGTH = 200                                   *
   306******************************************************************
   307
   308 01  DATE-CONVERSION-DATA.
   309     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   310     12  DC-OPTION-CODE                PIC X.
   311         88  BIN-TO-GREG                VALUE ' '.
   312         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   313         88  EDIT-GREG-TO-BIN           VALUE '2'.
   314         88  YMD-GREG-TO-BIN            VALUE '3'.
   315         88  MDY-GREG-TO-BIN            VALUE '4'.
   316         88  JULIAN-TO-BIN              VALUE '5'.
   317         88  BIN-PLUS-ELAPSED           VALUE '6'.
   318         88  FIND-CENTURY               VALUE '7'.
   319         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   320         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   321         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   322         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   323         88  JULIAN-TO-BIN-3            VALUE 'C'.
   324         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   325         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   326         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   327         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   328         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   329         88  CHECK-LEAP-YEAR            VALUE 'H'.
   330         88  BIN-3-TO-GREG              VALUE 'I'.
   331         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   332         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   333         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   334         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   335         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   336         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   337         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   338         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   339         88  THREE-CHARACTER-BIN
   340                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   341         88  GREGORIAN-TO-BIN
   342                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   343         88  BIN-TO-GREGORIAN
   344                  VALUES ' ' '1' 'I' '8' 'G'.
   345         88  JULIAN-TO-BINARY
   346                  VALUES '5' 'C' 'E' 'F'.
   347     12  DC-ERROR-CODE                 PIC X.
   348         88  NO-CONVERSION-ERROR        VALUE ' '.
   349         88  DATE-CONVERSION-ERROR
   350                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   351         88  DATE-IS-ZERO               VALUE '1'.
   352         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  10
* EL001.cbl
   353         88  DATE-IS-INVALID            VALUE '3'.
   354         88  DATE1-GREATER-DATE2        VALUE '4'.
   355         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   356         88  DATE-INVALID-OPTION        VALUE '9'.
   357         88  INVALID-CENTURY            VALUE 'A'.
   358         88  ONLY-CENTURY               VALUE 'B'.
   359         88  ONLY-LEAP-YEAR             VALUE 'C'.
   360         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   361     12  DC-END-OF-MONTH               PIC X.
   362         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   363     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   364         88  USE-NORMAL-PROCESS         VALUE ' '.
   365         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   366         88  ADJUST-UP-100-YRS          VALUE '2'.
   367     12  FILLER                        PIC X.
   368     12  DC-CONVERSION-DATES.
   369         16  DC-BIN-DATE-1             PIC XX.
   370         16  DC-BIN-DATE-2             PIC XX.
   371         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   372         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   373                       DC-GREG-DATE-1-EDIT.
   374             20  DC-EDIT1-MONTH        PIC 99.
   375             20  SLASH1-1              PIC X.
   376             20  DC-EDIT1-DAY          PIC 99.
   377             20  SLASH1-2              PIC X.
   378             20  DC-EDIT1-YEAR         PIC 99.
   379         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   380         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   381                     DC-GREG-DATE-2-EDIT.
   382             20  DC-EDIT2-MONTH        PIC 99.
   383             20  SLASH2-1              PIC X.
   384             20  DC-EDIT2-DAY          PIC 99.
   385             20  SLASH2-2              PIC X.
   386             20  DC-EDIT2-YEAR         PIC 99.
   387         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   388         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   389                     DC-GREG-DATE-1-YMD.
   390             20  DC-YMD-YEAR           PIC 99.
   391             20  DC-YMD-MONTH          PIC 99.
   392             20  DC-YMD-DAY            PIC 99.
   393         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   394         16  DC-GREG-DATE-1-MDY-R REDEFINES
   395                      DC-GREG-DATE-1-MDY.
   396             20  DC-MDY-MONTH          PIC 99.
   397             20  DC-MDY-DAY            PIC 99.
   398             20  DC-MDY-YEAR           PIC 99.
   399         16  DC-GREG-DATE-1-ALPHA.
   400             20  DC-ALPHA-MONTH        PIC X(10).
   401             20  DC-ALPHA-DAY          PIC 99.
   402             20  FILLER                PIC XX.
   403             20  DC-ALPHA-CENTURY.
   404                 24 DC-ALPHA-CEN-N     PIC 99.
   405             20  DC-ALPHA-YEAR         PIC 99.
   406         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   407         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   408         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   409         16  DC-JULIAN-DATE            PIC 9(05).
   410         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  11
* EL001.cbl
   411                                       PIC 9(05).
   412         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   413             20  DC-JULIAN-YEAR        PIC 99.
   414             20  DC-JULIAN-DAYS        PIC 999.
   415         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   416         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   417         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   418     12  DATE-CONVERSION-VARIBLES.
   419         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   420         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   421             20  FILLER                PIC 9(3).
   422             20  HOLD-CEN-1-CCYY.
   423                 24  HOLD-CEN-1-CC     PIC 99.
   424                 24  HOLD-CEN-1-YY     PIC 99.
   425             20  HOLD-CEN-1-MO         PIC 99.
   426             20  HOLD-CEN-1-DA         PIC 99.
   427         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   428             20  HOLD-CEN-1-R-MO       PIC 99.
   429             20  HOLD-CEN-1-R-DA       PIC 99.
   430             20  HOLD-CEN-1-R-CCYY.
   431                 24  HOLD-CEN-1-R-CC   PIC 99.
   432                 24  HOLD-CEN-1-R-YY   PIC 99.
   433             20  FILLER                PIC 9(3).
   434         16  HOLD-CENTURY-1-X.
   435             20  FILLER                PIC X(3)  VALUE SPACES.
   436             20  HOLD-CEN-1-X-CCYY.
   437                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   438                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   439             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   440             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   441         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   442             20  HOLD-CEN-1-R-X-MO     PIC XX.
   443             20  HOLD-CEN-1-R-X-DA     PIC XX.
   444             20  HOLD-CEN-1-R-X-CCYY.
   445                 24  HOLD-CEN-1-R-X-CC PIC XX.
   446                 24  HOLD-CEN-1-R-X-YY PIC XX.
   447             20  FILLER                PIC XXX.
   448         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   449         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   450         16  DC-JULIAN-DATE-1          PIC 9(07).
   451         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   452             20  DC-JULIAN-1-CCYY.
   453                 24  DC-JULIAN-1-CC    PIC 99.
   454                 24  DC-JULIAN-1-YR    PIC 99.
   455             20  DC-JULIAN-DA-1        PIC 999.
   456         16  DC-JULIAN-DATE-2          PIC 9(07).
   457         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   458             20  DC-JULIAN-2-CCYY.
   459                 24  DC-JULIAN-2-CC    PIC 99.
   460                 24  DC-JULIAN-2-YR    PIC 99.
   461             20  DC-JULIAN-DA-2        PIC 999.
   462         16  DC-GREG-DATE-A-EDIT.
   463             20  DC-EDITA-MONTH        PIC 99.
   464             20  SLASHA-1              PIC X VALUE '/'.
   465             20  DC-EDITA-DAY          PIC 99.
   466             20  SLASHA-2              PIC X VALUE '/'.
   467             20  DC-EDITA-CCYY.
   468                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  12
* EL001.cbl
   469                 24  DC-EDITA-YEAR     PIC 99.
   470         16  DC-GREG-DATE-B-EDIT.
   471             20  DC-EDITB-MONTH        PIC 99.
   472             20  SLASHB-1              PIC X VALUE '/'.
   473             20  DC-EDITB-DAY          PIC 99.
   474             20  SLASHB-2              PIC X VALUE '/'.
   475             20  DC-EDITB-CCYY.
   476                 24  DC-EDITB-CENT     PIC 99.
   477                 24  DC-EDITB-YEAR     PIC 99.
   478         16  DC-GREG-DATE-CYMD         PIC 9(08).
   479         16  DC-GREG-DATE-CYMD-R REDEFINES
   480                              DC-GREG-DATE-CYMD.
   481             20  DC-CYMD-CEN           PIC 99.
   482             20  DC-CYMD-YEAR          PIC 99.
   483             20  DC-CYMD-MONTH         PIC 99.
   484             20  DC-CYMD-DAY           PIC 99.
   485         16  DC-GREG-DATE-MDCY         PIC 9(08).
   486         16  DC-GREG-DATE-MDCY-R REDEFINES
   487                              DC-GREG-DATE-MDCY.
   488             20  DC-MDCY-MONTH         PIC 99.
   489             20  DC-MDCY-DAY           PIC 99.
   490             20  DC-MDCY-CEN           PIC 99.
   491             20  DC-MDCY-YEAR          PIC 99.
   492    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   493        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   494    12  DC-EL310-DATE                  PIC X(21).
   495    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  13
* EL001.cbl
   497*            COPY ELCERRWS.
   498******************************************************************
   499*                                                                *
   500*                                                                *
   501*                            ELCERRWS                            *
   502*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   503*                            VMOD=2.005                          *
   504*                                                                *
   505*                                                                *
   506*    WORKING STORAGE FOR ERROR MESSAGES ROUTINE ELCERRPD         *
   507*                                                                *
   508******************************************************************
   509
   510 01  W-ERROR-WORK.
   511     12  E-CLIENT-ID             PIC X(03)   VALUE SPACES.
   512     12  CLIENT-ABL              PIC X(03)   VALUE 'ABL'.
   513     12  CLIENT-AIG              PIC X(03)   VALUE 'AIG'.
   514     12  CLIENT-AUK              PIC X(03)   VALUE 'AUK'.
   515     12  CLIENT-CIG              PIC X(03)   VALUE 'CIG'.
   516     12  CLIENT-CUK              PIC X(03)   VALUE 'CUK'.
   517     12  CLIENT-LAP              PIC X(03)   VALUE 'LAP'.
   518     12  CLIENT-NCB              PIC X(03)   VALUE 'NCB'.
   519     12  CLIENT-TIC              PIC X(03)   VALUE 'TIC'.
   520     12  CLIENT-TMS              PIC X(03)   VALUE 'TMS'.
   521     12  CLIENT-LBL              PIC X(03)   VALUE 'LBL'.
   522     12  CLIENT-HAN              PIC X(03)   VALUE 'HAN'.
   523     12  CLIENT-JHL              PIC X(03)   VALUE 'JHL'.
   524     12  CLIENT-HER              PIC X(03)   VALUE 'HER'.
   525     12  CLIENT-NCX              PIC X(03)   VALUE 'NCX'.
   526     12  CLIENT-DCC              PIC X(03)   VALUE 'DCC'.
   527     12  CLIENT-CID              PIC X(03)   VALUE 'CID'.
   528
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  14
* EL001.cbl
   530*            COPY ELCERRS.
   531******************************************************************
   532*                                                                *
   533*                                                                *
   534*                            ELCERRS.                            *
   535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   536*                            VMOD 2.002                          *
   537*                                                                *
   538*   FILE DESCRIPTION = SYSTEM ERROR MESSAGES                     *
   539*                                                                *
   540*   FILE TYPE = VSAM,KSDS                                        *
   541*   RECORD SIZE = 72    RECFORM = FIX                            *
   542*                                                                *
   543*   BASE CLUSTER NAME = ELERRS                   RKP=2,LEN=4     *
   544*       ALTERNATE PATH  = NOT USED                               *
   545*                                                                *
   546*   LOG = NO                                                     *
   547*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   548******************************************************************
   549 01  ERROR-MESSAGE-FILE.
   550     12  EM-RECORD-ID                PIC XX.
   551         88  VALID-EM-ID                VALUE 'EM'.
   552
   553     12  EM-CONTROL-PRIMARY.
   554         16  EM-MESSAGE-NUMBER       PIC 9(4).
   555
   556     12  EM-ERROR-TEXT.
   557         16  EM-ERROR-TEXT-PREFIX    PIC X(6).
   558         16  FILLER                  PIC X(59).
   559
   560     12  EM-ERROR-SEVERITY           PIC X.
   561         88  ERROR-IS-NOTE              VALUE 'N'.
   562         88  ERROR-IS-WARNING           VALUE 'W'.
   563         88  ERROR-IS-FORCABLE          VALUE 'F'.
   564         88  ERROR-IS-FATAL             VALUE 'X'.
   565
   566******************************************************************
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  15
* EL001.cbl
   568****************************************************************
   569*
   570* Copyright (c) 2007 by Clerity Solutions, Inc.
   571* All rights reserved.
   572*
   573****************************************************************
   574 01  DFHEIV.
   575   02  DFHEIV0               PIC X(35).
   576   02  DFHEIV1               PIC X(08).
   577   02  DFHEIV2               PIC X(08).
   578   02  DFHEIV3               PIC X(08).
   579   02  DFHEIV4               PIC X(06).
   580   02  DFHEIV5               PIC X(04).
   581   02  DFHEIV6               PIC X(04).
   582   02  DFHEIV7               PIC X(02).
   583   02  DFHEIV8               PIC X(02).
   584   02  DFHEIV9               PIC X(01).
   585   02  DFHEIV10              PIC S9(7) COMP-3.
   586   02  DFHEIV11              PIC S9(4) COMP SYNC.
   587   02  DFHEIV12              PIC S9(4) COMP SYNC.
   588   02  DFHEIV13              PIC S9(4) COMP SYNC.
   589   02  DFHEIV14              PIC S9(4) COMP SYNC.
   590   02  DFHEIV15              PIC S9(4) COMP SYNC.
   591   02  DFHEIV16              PIC S9(9) COMP SYNC.
   592   02  DFHEIV17              PIC X(04).
   593   02  DFHEIV18              PIC X(04).
   594   02  DFHEIV19              PIC X(04).
   595   02  DFHEIV20              USAGE IS POINTER.
   596   02  DFHEIV21              USAGE IS POINTER.
   597   02  DFHEIV22              USAGE IS POINTER.
   598   02  DFHEIV23              USAGE IS POINTER.
   599   02  DFHEIV24              USAGE IS POINTER.
   600   02  DFHEIV25              PIC S9(9) COMP SYNC.
   601   02  DFHEIV26              PIC S9(9) COMP SYNC.
   602   02  DFHEIV27              PIC S9(9) COMP SYNC.
   603   02  DFHEIV28              PIC S9(9) COMP SYNC.
   604   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   605   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   606   02  FILLER                PIC X(02).
   607   02  DFHEIV99              PIC X(08) VALUE SPACE.
   608   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   609   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   610   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   611   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   612 LINKAGE  SECTION.
   613*****************************************************************
   614*                                                               *
   615* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   616* All rights reserved.                                          *
   617*                                                               *
   618*****************************************************************
   619 01  dfheiblk.
   620     02  eibtime          pic s9(7) comp-3.
   621     02  eibdate          pic s9(7) comp-3.
   622     02  eibtrnid         pic x(4).
   623     02  eibtaskn         pic s9(7) comp-3.
   624     02  eibtrmid         pic x(4).
   625     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  16
* EL001.cbl
   626     02  eibcposn         pic s9(4) comp.
   627     02  eibcalen         pic s9(4) comp.
   628     02  eibaid           pic x(1).
   629     02  eibfiller1       pic x(1).
   630     02  eibfn            pic x(2).
   631     02  eibfiller2       pic x(2).
   632     02  eibrcode         pic x(6).
   633     02  eibfiller3       pic x(2).
   634     02  eibds            pic x(8).
   635     02  eibreqid         pic x(8).
   636     02  eibrsrce         pic x(8).
   637     02  eibsync          pic x(1).
   638     02  eibfree          pic x(1).
   639     02  eibrecv          pic x(1).
   640     02  eibsend          pic x(1).
   641     02  eibatt           pic x(1).
   642     02  eibeoc           pic x(1).
   643     02  eibfmh           pic x(1).
   644     02  eibcompl         pic x(1).
   645     02  eibsig           pic x(1).
   646     02  eibconf          pic x(1).
   647     02  eiberr           pic x(1).
   648     02  eibrldbk         pic x(1).
   649     02  eiberrcd         pic x(4).
   650     02  eibsynrb         pic x(1).
   651     02  eibnodat         pic x(1).
   652     02  eibfiller5       pic x(2).
   653     02  eibresp          pic 9(09) comp.
   654     02  eibresp2         pic 9(09) comp.
   655     02  dfheigdj         pic s9(4) comp.
   656     02  dfheigdk         pic s9(4) comp.
   657
   658 01  DFHCOMMAREA                 PIC X(400).
   659
   660 01  PARMLIST.
   661     12  FILLER                  PIC S9(8) COMP.
   662     12  ERROR-POINTER           PIC S9(8) COMP.
   663     12  ERROR-POINTER-FR        PIC S9(8) COMP.
   664     12  MAP-POINTER             PIC S9(8) COMP.
   665
   666 01  ERROR-MESSAGE-FILE-REST     PIC X(72).
   667 01  ERROR-MESSAGE-FILE-FR       PIC X(72).
   668
   669 01  MAP-BUFFER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  17
* EL001.cbl
   671 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PARMLIST
   672                          ERROR-MESSAGE-FILE-REST
   673                          ERROR-MESSAGE-FILE-FR MAP-BUFFER.
   674 0000-DFHEXIT SECTION.
   675     MOVE '9#                    $   ' TO DFHEIV0.
   676     MOVE 'EL001' TO DFHEIV1.
   677     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   678     SERVICE RELOAD PARMLIST.
   679
   680     MOVE DFHCOMMAREA  TO  ERROR-MESSAGE-INTERFACE-BLOCK.
   681
   682     IF EMI-ROLL-SWITCH = 'Y'
   683        GO TO 3000-ROLL-CODES.
   684
   685     MOVE EMI-ERROR              TO EM-KEY.
   686
   687 0100-READ-ERRORS.
   688
   689     IF  EMI-LANGUAGE-IS-FR
   690
   691* EXEC CICS HANDLE CONDITION
   692*             NOTFND   (2150-NOT-FOUND-FR)
   693*             NOTOPEN  (2250-NOT-OPEN-FR)
   694*        END-EXEC
   695*    MOVE '"$IJ                  ! " #00000686' TO DFHEIV0
   696     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
   697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
   698     MOVE X'2220233030303030363836' TO DFHEIV0(25:11)
   699     CALL 'kxdfhei1' USING DFHEIV0
   700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   701
   702
   703* EXEC CICS READ
   704*             DATASET  (EM-FILE-ID-FR)
   705*             RIDFLD   (EM-KEY)
   706*             INTO     (ERROR-MESSAGE-FILE)
   707*        END-EXEC
   708     MOVE LENGTH OF
   709      ERROR-MESSAGE-FILE
   710       TO DFHEIV11
   711*    MOVE '&"IL       E          (   #00000691' TO DFHEIV0
   712     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
   713     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
   714     MOVE X'2020233030303030363931' TO DFHEIV0(25:11)
   715     CALL 'kxdfhei1' USING DFHEIV0,
   716           EM-FILE-ID-FR,
   717           ERROR-MESSAGE-FILE,
   718           DFHEIV11,
   719           EM-KEY,
   720           DFHEIV99,
   721           DFHEIV99,
   722           DFHEIV99
   723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   724
   725*        SERVICE RELOAD ERROR-MESSAGE-FILE-FR
   726
   727     ELSE
   728
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  18
* EL001.cbl
   729* EXEC CICS HANDLE CONDITION
   730*             NOTFND   (2100-NOT-FOUND)
   731*             NOTOPEN  (2200-NOT-OPEN)
   732*        END-EXEC
   733*    MOVE '"$IJ                  ! # #00000700' TO DFHEIV0
   734     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
   735     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
   736     MOVE X'2320233030303030373030' TO DFHEIV0(25:11)
   737     CALL 'kxdfhei1' USING DFHEIV0
   738     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   739
   740
   741* EXEC CICS READ
   742*             DATASET  (EM-FILE-ID)
   743*             RIDFLD   (EM-KEY)
   744*             INTO     (ERROR-MESSAGE-FILE)
   745*        END-EXEC.
   746     MOVE LENGTH OF
   747      ERROR-MESSAGE-FILE
   748       TO DFHEIV11
   749*    MOVE '&"IL       E          (   #00000705' TO DFHEIV0
   750     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
   751     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
   752     MOVE X'2020233030303030373035' TO DFHEIV0(25:11)
   753     CALL 'kxdfhei1' USING DFHEIV0,
   754           EM-FILE-ID,
   755           ERROR-MESSAGE-FILE,
   756           DFHEIV11,
   757           EM-KEY,
   758           DFHEIV99,
   759           DFHEIV99,
   760           DFHEIV99
   761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   762
   763
   764*        SERVICE RELOAD ERROR-MESSAGE-FILE-REST.
   765
   766     MOVE EMI-CLIENT-ID TO E-CLIENT-ID.
   767
   768*                                COPY ELCERRPD.
   769******************************************************************
   770*                                                                *
   771*                                                                *
   772*                            ELCERRPD                            *
   773*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   774*                            VMOD=2.005                          *
   775*                                                                *
   776*    CLIENT CODED ERROR MESSAGES                                 *
   777*                                                                *
   778******************************************************************
   779
   780     IF EM-MESSAGE-NUMBER NOT NUMERIC
   781         MOVE ZEROS TO EM-MESSAGE-NUMBER.
   782
   783     IF E-CLIENT-ID EQUAL CLIENT-AIG OR CLIENT-AUK
   784                         OR CLIENT-CIG OR CLIENT-CUK
   785        IF EM-MESSAGE-NUMBER EQUAL 0541
   786            MOVE 'X' TO EM-ERROR-SEVERITY.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  19
* EL001.cbl
   787
   788     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER
   789        IF EM-MESSAGE-NUMBER IS EQUAL TO 1909
   790            MOVE 'F'             TO  EM-ERROR-SEVERITY.
   791
   792     IF E-CLIENT-ID EQUAL CLIENT-LAP
   793        IF EM-MESSAGE-NUMBER EQUAL 2656
   794            MOVE 'F' TO EM-ERROR-SEVERITY.
   795
   796     IF E-CLIENT-ID IS EQUAL TO CLIENT-NCB
   797        IF EM-MESSAGE-NUMBER IS EQUAL TO 2671
   798            MOVE 'F'             TO  EM-ERROR-SEVERITY.
   799
   800     IF E-CLIENT-ID IS EQUAL TO CLIENT-ABL OR CLIENT-TIC
   801        IF EM-MESSAGE-NUMBER IS EQUAL TO 2672
   802            MOVE 'W'             TO  EM-ERROR-SEVERITY.
   803
   804     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER
   805        IF EM-MESSAGE-NUMBER IS EQUAL TO 2693
   806            MOVE 'W'             TO  EM-ERROR-SEVERITY.
   807
   808     IF E-CLIENT-ID IS EQUAL TO CLIENT-TMS
   809        IF EM-MESSAGE-NUMBER IS EQUAL TO 2696
   810            MOVE 'F'             TO  EM-ERROR-SEVERITY.
   811
   812     IF E-CLIENT-ID EQUAL CLIENT-LBL
   813        IF EM-MESSAGE-NUMBER EQUAL 2738
   814            MOVE 'W' TO EM-ERROR-SEVERITY.
   815
   816     IF E-CLIENT-ID EQUAL CLIENT-LBL
   817        IF EM-MESSAGE-NUMBER EQUAL 2739
   818            MOVE 'W' TO EM-ERROR-SEVERITY.
   819
   820     IF E-CLIENT-ID EQUAL CLIENT-LBL
   821        IF EM-MESSAGE-NUMBER EQUAL 2741
   822            MOVE 'W' TO EM-ERROR-SEVERITY.
   823
   824     IF  E-CLIENT-ID EQUAL CLIENT-HAN
   825             OR
   826         E-CLIENT-ID EQUAL CLIENT-JHL
   827
   828         IF  EM-MESSAGE-NUMBER EQUAL 2756
   829             MOVE 'F'            TO EM-ERROR-SEVERITY.
   830
   831     IF E-CLIENT-ID = CLIENT-NCX
   832         IF EM-MESSAGE-NUMBER = 9895
   833             MOVE 'F'            TO EM-ERROR-SEVERITY.
   834     IF E-CLIENT-ID = CLIENT-DCC
   835        IF EM-MESSAGE-NUMBER = 2719
   836           MOVE 'W'              TO EM-ERROR-SEVERITY
   837        END-IF
   838     END-IF
   839     .
   840
   841     IF EM-ERROR-TEXT-PREFIX = 'LLLLLL'
   842        MOVE EMI-LIFE-OVERRIDE-L6  TO EM-ERROR-TEXT-PREFIX.
   843
   844     IF EM-ERROR-TEXT-PREFIX = 'AAAAAA'
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  20
* EL001.cbl
   845        MOVE EMI-AH-OVERRIDE-L6    TO EM-ERROR-TEXT-PREFIX.
   846
   847     IF EM-ERROR-TEXT-PREFIX = 'DDDDDD'
   848        MOVE EMI-DATE-FIELD        TO EM-ERROR-TEXT-PREFIX.
   849     if em-error-text-prefix = 'BBBBBB'
   850        move emi-claim-type        to em-error-text-prefix
   851     end-if
   852     if ws-error-text (1:10) = 'XXXXXXXXXX'
   853        and emi-claim-no not = spaces
   854        move emi-claim-no        to ws-error-text (1:10)
   855     end-if
   856
   857     .
   858 2000-PROCESS-ERRORS.
   859**********************************************************
   860*       THIS ROUTINE WILL CHECK THE SEVERITY OF THE      *
   861*       ERROR AND DETERMINE IF IT IS TO BE PROCESSED     *
   862*       OR NOT                                           *
   863**********************************************************
   864     IF REC-NOT-FOUND
   865*        MOVE 'N'                TO  EMI-MESSAGE-FLAG
   866         GO TO 2000-CONT-PROCESS-ERRORS.
   867
   868     MOVE EM-ERROR-SEVERITY      TO EMI-SEVERITY-SAVE.
   869     MOVE 'N'                    TO EMI-MESSAGE-FLAG.
   870
   871     IF EM-ERROR-SEVERITY = 'N'
   872        ADD 1 TO EMI-NOTE-CTR
   873        IF NOT EMI-PROCESS-ALL-ERRORS
   874           GO TO 2300-RETURN.
   875
   876     IF EM-ERROR-SEVERITY = 'W'
   877        ADD 1 TO EMI-WARNING-CTR
   878        IF EMI-BYPASS-WARNINGS  OR
   879           EMI-BYPASS-FORCABLES OR
   880           EMI-BYPASS-FATALS
   881             GO TO 2300-RETURN.
   882
   883     IF EM-ERROR-SEVERITY = 'F'
   884        ADD 1 TO EMI-FORCABLE-CTR
   885        IF EMI-BYPASS-FORCABLES OR
   886           EMI-BYPASS-FATALS
   887             GO TO 2300-RETURN.
   888
   889     IF EM-ERROR-SEVERITY = 'X'
   890        ADD 1 TO EMI-FATAL-CTR
   891        IF EMI-BYPASS-FATALS
   892           GO TO 2300-RETURN.
   893
   894 2000-CONT-PROCESS-ERRORS.
   895
   896     MOVE 'Y'                    TO EMI-MESSAGE-FLAG.
   897
   898     IF EMI-ERRORS-COMPLETE
   899        GO TO 2300-RETURN.
   900
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  21
* EL001.cbl
   902**********************************************************
   903*       THIS ROUTINE WILL CHECK TO SEE IF THE ERROR      *
   904*       HAS ALREADY BEEN PROCESSED. IF IT HAS, THEN      *
   905*       PROCESSING WILL BE TERMINATED FOR THIS ERROR.    *
   906**********************************************************
   907     IF EMI-FORMAT-CODES-ONLY
   908        IF EMI-ERROR  =  EMI-ERR-NUM (1) OR
   909                         EMI-ERR-NUM (2) OR
   910                         EMI-ERR-NUM (3) OR
   911                         EMI-ERR-NUM (4) OR
   912                         EMI-ERR-NUM (5) OR
   913                         EMI-ERR-NUM (6) OR
   914                         EMI-ERR-NUM (7) OR
   915                         EMI-ERR-NUM (8) OR
   916                         EMI-ERR-NUM (9) OR
   917                         EMI-ERR-NUM (10)
   918           GO TO 2300-RETURN.
   919
   920
   921     IF EMI-NUMBER-OF-LINES = 2
   922        IF EMI-ERROR  =  EMI-ERROR-NUMBER (1)  OR
   923                         EMI-ERROR-NUMBER (2)
   924           GO TO 2300-RETURN
   925        ELSE
   926           GO TO 2050-CHECK-LINE.
   927
   928     IF EMI-NUMBER-OF-LINES = 3
   929        IF EMI-ERROR  =  EMI-ERROR-NUMBER (1)  OR
   930                         EMI-ERROR-NUMBER (2)  OR
   931                         EMI-ERROR-NUMBER (3)
   932           GO TO 2300-RETURN.
   933
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  22
* EL001.cbl
   935 2050-CHECK-LINE.
   936**********************************************************
   937*       THIS ROUTINE WILL DETERMINE WHICH ERROR LINE     *
   938*       THE MESSAGE WILL FORMATTED INTO AND SET THE      *
   939*       NECESSARY SWITCHES AND SUBSCRIPTS.               *
   940**********************************************************
   941     MOVE '2' TO EMI-SWITCH1.
   942
   943     IF EMI-NUMBER-OF-LINES = 1
   944        SET EMI-INDX TO 1
   945        PERFORM 2490-FORMAT-LINE
   946        MOVE '2'                 TO EMI-SWITCH-AREA-1
   947        MOVE '3'                 TO EMI-SWITCH1
   948        GO TO 2300-RETURN.
   949
   950     IF EMI-NUMBER-OF-LINES = 2
   951        IF EMI-AREA1-EMPTY
   952           SET EMI-INDX TO 1
   953           MOVE '2'              TO EMI-SWITCH-AREA-1
   954           PERFORM 2490-FORMAT-LINE
   955           GO TO 2300-RETURN
   956        ELSE
   957           SET EMI-INDX TO 2
   958           IF EMI-FORMAT-CODES-ONLY
   959              PERFORM 2500-FORMAT-CODES-ONLY THRU 2500-EXIT
   960              GO TO 2300-RETURN
   961           ELSE
   962              MOVE '3'           TO EMI-SWITCH1
   963              MOVE '2'           TO EMI-SWITCH-AREA-2
   964              PERFORM 2490-FORMAT-LINE
   965              GO TO 2300-RETURN.
   966
   967        IF EMI-AREA1-EMPTY
   968           SET EMI-INDX TO 1
   969           MOVE '2'              TO EMI-SWITCH-AREA-1
   970           PERFORM 2490-FORMAT-LINE
   971           GO TO 2300-RETURN.
   972
   973        IF EMI-AREA2-EMPTY
   974           SET EMI-INDX TO 2
   975           MOVE '2'              TO EMI-SWITCH-AREA-2
   976           PERFORM 2490-FORMAT-LINE
   977           GO TO 2300-RETURN.
   978
   979        SET EMI-INDX TO 3.
   980
   981        IF EMI-FORMAT-CODES-ONLY
   982           PERFORM 2500-FORMAT-CODES-ONLY THRU 2500-EXIT
   983           GO TO 2300-RETURN
   984        ELSE
   985           MOVE '3'              TO EMI-SWITCH1
   986           PERFORM 2490-FORMAT-LINE
   987           GO TO 2300-RETURN.
   988
   989 2100-NOT-FOUND.
   990     MOVE 1                      TO FOUND-SWITCH.
   991     GO TO 2000-PROCESS-ERRORS.
   992
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  23
* EL001.cbl
   993 2150-NOT-FOUND-FR.
   994     MOVE 'E'                    TO EMI-LANGUAGE-IND.
   995     GO TO 0100-READ-ERRORS.
   996
   997 2200-NOT-OPEN.
   998     SET EMI-INDX TO 1.
   999     MOVE 'ELERRS FILE NOT OPEN' TO EMI-ERROR-TEXT (EMI-INDX).
  1000     MOVE '3'                    TO EMI-SWITCH1.
  1001
  1002 2250-NOT-OPEN-FR.
  1003     SET EMI-INDX TO 1.
  1004     MOVE 'MPERRS FILE NOT OPEN' TO EMI-ERROR-TEXT (EMI-INDX).
  1005     MOVE '3'                    TO EMI-SWITCH1.
  1006
  1007 2300-RETURN.
  1008     MOVE ERROR-MESSAGE-INTERFACE-BLOCK  TO  DFHCOMMAREA.
  1009
  1010
  1011* EXEC CICS RETURN
  1012*    END-EXEC.
  1013*    MOVE '.(                    ''   #00000957' TO DFHEIV0
  1014     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1015     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1016     MOVE X'2020233030303030393537' TO DFHEIV0(25:11)
  1017     CALL 'kxdfhei1' USING DFHEIV0,
  1018           DFHEIV99,
  1019           DFHEIV99,
  1020           DFHEIV99,
  1021           DFHEIV99,
  1022           DFHEIV99,
  1023           DFHEIV99
  1024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1025
  1026
  1027
  1028* GOBACK.
  1029     MOVE '9%                    "   ' TO DFHEIV0
  1030     MOVE 'EL001' TO DFHEIV1
  1031     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1032     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  24
* EL001.cbl
  1034 2490-FORMAT-LINE.
  1035     IF REC-NOT-FOUND
  1036        MOVE 'NO TEXT RECORD FOUND FOR THIS ERROR' TO
  1037              EMI-ERROR-TEXT (EMI-INDX)
  1038        MOVE 'X'                 TO EMI-SEVERITY (EMI-INDX)
  1039     ELSE
  1040        MOVE EM-ERROR-SEVERITY   TO EMI-SEVERITY (EMI-INDX)
  1041        MOVE '-'                 TO EMI-FILL (EMI-INDX)
  1042        MOVE EM-ERROR-TEXT       TO EMI-ERROR-TEXT (EMI-INDX).
  1043
  1044     MOVE EMI-ERROR              TO EMI-ERROR-NUMBER (EMI-INDX).
  1045
  1046 2500-FORMAT-CODES-ONLY.
  1047     IF EMI-SUB = 2
  1048        MOVE SPACES              TO EMI-ERROR-TEXT (3).
  1049
  1050     MOVE EMI-ERROR              TO EMI-ERR-NUM (EMI-SUB).
  1051     MOVE '-'                    TO EMI-FILLER (EMI-SUB).
  1052
  1053     IF REC-NOT-FOUND
  1054        MOVE 'X'                 TO EMI-SEV (EMI-SUB)
  1055     ELSE
  1056        MOVE EM-ERROR-SEVERITY   TO EMI-SEV (EMI-SUB).
  1057
  1058     IF EMI-SUB = 1
  1059        ADD 1 TO EMI-SUB
  1060        PERFORM 2490-FORMAT-LINE
  1061        GO TO 2500-EXIT.
  1062
  1063     IF EMI-INDX = 2
  1064        MOVE EMI-MESSAGE-AREA (3)
  1065                                 TO EMI-MESSAGE-AREA (2).
  1066
  1067     IF EMI-SUB = 10
  1068        MOVE '3'                 TO EMI-SWITCH1
  1069     ELSE
  1070        ADD 1 TO EMI-SUB.
  1071
  1072 2500-EXIT.
  1073      EXIT.
  1074
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  25
* EL001.cbl
  1076 3000-ROLL-CODES.
  1077     MOVE LOW-VALUES             TO EL001AI.
  1078*
  1079*    EXEC CICS HANDLE CONDITION
  1080*         NOTFND    (4080-NOT-FOUND)
  1081*         NOTOPEN   (2200-NOT-OPEN)
  1082*    END-EXEC.
  1083
  1084     IF EMI-NUMBER-OF-LINES = 1
  1085        IF EMI-FORMAT-CODES-ONLY
  1086           MOVE EMI-LINE1        TO EMI-LINE3
  1087           MOVE 1                TO ER-SUB
  1088           PERFORM 4000-READ-ERRORS THRU 4099-EXIT
  1089                   UNTIL ER-NUM GREATER THAN EMI-SUB
  1090           GO TO 3500-SEND-ERROR-SCREEN.
  1091
  1092     IF EMI-NUMBER-OF-LINES = 2
  1093        IF EMI-FORMAT-CODES-ONLY
  1094           MOVE EMI-LINE1        TO ER-LINE (1)
  1095           MOVE EMI-LINE2        TO EMI-LINE3
  1096           MOVE 2                TO ER-SUB
  1097           PERFORM 4000-READ-ERRORS THRU 4099-EXIT
  1098                   UNTIL ER-NUM GREATER THAN EMI-SUB
  1099           GO TO 3500-SEND-ERROR-SCREEN.
  1100
  1101     IF EMI-NUMBER-OF-LINES = 3
  1102        IF EMI-FORMAT-CODES-ONLY
  1103           MOVE EMI-LINE1        TO ER-LINE (1)
  1104           MOVE EMI-LINE2        TO ER-LINE (2)
  1105           MOVE 3                TO ER-SUB
  1106           PERFORM 4000-READ-ERRORS THRU 4099-EXIT
  1107                   UNTIL ER-NUM GREATER THAN EMI-SUB
  1108           GO TO 3500-SEND-ERROR-SCREEN.
  1109
  1110     GO TO 2300-RETURN.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  26
* EL001.cbl
  1112 3500-SEND-ERROR-SCREEN.
  1113
  1114     IF EIBTRNID = TRANS-EXB1 OR
  1115                   TRANS-MXB1 OR
  1116                   TRANS-MXA6 OR
  1117                   TRANS-MXB2 OR
  1118                   TRANS-MXB3 OR
  1119                   TRANS-MXA5
  1120                or trans-ex19
  1121        GO TO 3515-SEND-ERRORS.
  1122
  1123
  1124* EXEC CICS RECEIVE
  1125*         SET    (MAP-POINTER)
  1126*         LENGTH (MAP-LENGTH)
  1127*         BUFFER
  1128*    END-EXEC.
  1129*    MOVE '$"S B  L              ''   #00001051' TO DFHEIV0
  1130     MOVE X'242253204220204C20202020' TO DFHEIV0(1:12)
  1131     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1132     MOVE X'2020233030303031303531' TO DFHEIV0(25:11)
  1133     CALL 'kxdfhei1' USING DFHEIV0,
  1134           MAP-POINTER,
  1135           MAP-LENGTH,
  1136           DFHEIV99,
  1137           DFHEIV99,
  1138           DFHEIV99,
  1139           DFHEIV99
  1140     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1141
  1142
  1143     SERVICE RELOAD MAP-BUFFER.
  1144
  1145     MOVE EIBTRMID               TO TEMP-TERM.
  1146
  1147
  1148* EXEC CICS HANDLE CONDITION
  1149*         QIDERR  (3510-WRITE-TS)
  1150*    END-EXEC.
  1151*    MOVE '"$N                   ! $ #00001061' TO DFHEIV0
  1152     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  1153     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1154     MOVE X'2420233030303031303631' TO DFHEIV0(25:11)
  1155     CALL 'kxdfhei1' USING DFHEIV0
  1156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1157
  1158
  1159
  1160* EXEC CICS DELETEQ TS
  1161*         QUEUE  (TEMP-ID)
  1162*    END-EXEC.
  1163*    MOVE '*&                    #   #00001065' TO DFHEIV0
  1164     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  1165     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1166     MOVE X'2020233030303031303635' TO DFHEIV0(25:11)
  1167     CALL 'kxdfhei1' USING DFHEIV0,
  1168           TEMP-ID,
  1169           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  27
* EL001.cbl
  1170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1171
  1172
  1173 3510-WRITE-TS.
  1174
  1175
  1176* EXEC CICS WRITEQ TS
  1177*         QUEUE  (TEMP-ID)
  1178*         LENGTH (MAP-LENGTH)
  1179*         FROM   (MAP-BUFFER)
  1180*    END-EXEC.
  1181*    MOVE '*"                    ''   #00001071' TO DFHEIV0
  1182     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  1183     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1184     MOVE X'2020233030303031303731' TO DFHEIV0(25:11)
  1185     CALL 'kxdfhei1' USING DFHEIV0,
  1186           TEMP-ID,
  1187           MAP-BUFFER,
  1188           MAP-LENGTH,
  1189           DFHEIV99,
  1190           DFHEIV99,
  1191           DFHEIV99
  1192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1193
  1194
  1195 3515-SEND-ERRORS.
  1196
  1197     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1198     MOVE '5'                    TO DC-OPTION-CODE.
  1199     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  1200     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1201
  1202     MOVE SAVE-DATE              TO RUNDTEI.
  1203     MOVE EIBTIME                TO TIME-IN.
  1204     MOVE TIME-O                 TO RUNTIMO.
  1205
  1206
  1207* EXEC CICS SEND
  1208*         MAPSET  ('EL001S')
  1209*         MAP     ('EL001A')
  1210*         FROM    (EL001AI)
  1211*         ERASE   WAIT
  1212*    END-EXEC.
  1213     MOVE LENGTH OF
  1214      EL001AI
  1215       TO DFHEIV11
  1216     MOVE 'EL001A' TO DFHEIV1
  1217     MOVE 'EL001S' TO DFHEIV2
  1218*    MOVE '8$      TW E    H L F ,   #00001088' TO DFHEIV0
  1219     MOVE X'382420202020202054572045' TO DFHEIV0(1:12)
  1220     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1221     MOVE X'2020233030303031303838' TO DFHEIV0(25:11)
  1222     CALL 'kxdfhei1' USING DFHEIV0,
  1223           DFHEIV1,
  1224           EL001AI,
  1225           DFHEIV11,
  1226           DFHEIV2,
  1227           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  28
* EL001.cbl
  1228           DFHEIV99,
  1229           DFHEIV99,
  1230           DFHEIV99,
  1231           DFHEIV99,
  1232           DFHEIV99,
  1233           DFHEIV99
  1234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1235
  1236
  1237
  1238* EXEC CICS HANDLE AID
  1239*         ANYKEY(3520-SEND-MAP)
  1240*    END-EXEC.
  1241*    MOVE '"&@                  V! % #00001095' TO DFHEIV0
  1242     MOVE X'222640202020202020202020' TO DFHEIV0(1:12)
  1243     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  1244     MOVE X'2520233030303031303935' TO DFHEIV0(25:11)
  1245     CALL 'kxdfhei1' USING DFHEIV0
  1246     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1247
  1248
  1249
  1250* EXEC CICS RECEIVE
  1251*         MAPSET  ('EL001S')
  1252*         MAP     ('EL001A')
  1253*         INTO    (EL001AI)
  1254*    END-EXEC.
  1255     MOVE LENGTH OF
  1256      EL001AI
  1257       TO DFHEIV11
  1258     MOVE 'EL001A' TO DFHEIV1
  1259     MOVE 'EL001S' TO DFHEIV2
  1260*    MOVE '8"T I  L              ''   #00001099' TO DFHEIV0
  1261     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1262     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1263     MOVE X'2020233030303031303939' TO DFHEIV0(25:11)
  1264     CALL 'kxdfhei1' USING DFHEIV0,
  1265           DFHEIV1,
  1266           EL001AI,
  1267           DFHEIV11,
  1268           DFHEIV2,
  1269           DFHEIV99,
  1270           DFHEIV99
  1271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1272
  1273
  1274 3520-SEND-MAP.
  1275
  1276     IF EIBTRNID = TRANS-EXB1 OR
  1277                   TRANS-MXB1 OR
  1278                   TRANS-MXA6 OR
  1279                   TRANS-MXB2 OR
  1280                   TRANS-MXB3 OR
  1281                   TRANS-MXA5
  1282                or trans-ex19
  1283        GO TO 2300-RETURN.
  1284
  1285
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  29
* EL001.cbl
  1286* EXEC CICS READQ TS
  1287*         QUEUE  (TEMP-ID)
  1288*         LENGTH (MAP-LENGTH)
  1289*         SET    (MAP-POINTER)
  1290*    END-EXEC
  1291*    MOVE '*$S    L              ''   #00001116' TO DFHEIV0
  1292     MOVE X'2A2453202020204C20202020' TO DFHEIV0(1:12)
  1293     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1294     MOVE X'2020233030303031313136' TO DFHEIV0(25:11)
  1295     CALL 'kxdfhei1' USING DFHEIV0,
  1296           TEMP-ID,
  1297           MAP-POINTER,
  1298           MAP-LENGTH,
  1299           DFHEIV99,
  1300           DFHEIV99,
  1301           DFHEIV99
  1302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1303
  1304     SERVICE RELOAD MAP-BUFFER.
  1305
  1306
  1307* EXEC CICS SEND
  1308*         FROM    (MAP-BUFFER)
  1309*         LENGTH  (MAP-LENGTH)
  1310*         CTLCHAR (WCC-CTL)
  1311*    END-EXEC.
  1312*    MOVE '$$    C           L F ,   #00001124' TO DFHEIV0
  1313     MOVE X'242420202020432020202020' TO DFHEIV0(1:12)
  1314     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
  1315     MOVE X'2020233030303031313234' TO DFHEIV0(25:11)
  1316     CALL 'kxdfhei1' USING DFHEIV0,
  1317           MAP-BUFFER,
  1318           MAP-LENGTH,
  1319           DFHEIV99,
  1320           DFHEIV99,
  1321           WCC-CTL,
  1322           DFHEIV99,
  1323           DFHEIV99,
  1324           DFHEIV99,
  1325           DFHEIV99,
  1326           DFHEIV99,
  1327           DFHEIV99
  1328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1329
  1330
  1331     GO TO 2300-RETURN.
  1332
  1333 4000-READ-ERRORS.
  1334     IF EMI-ERR-NUM (ER-NUM) NOT NUMERIC
  1335        MOVE 99                  TO ER-NUM
  1336        GO TO 4099-EXIT.
  1337
  1338     MOVE EMI-ERR-NUM (ER-NUM)   TO EM-KEY.
  1339     MOVE SPACES                 TO WS-ERROR-LINE.
  1340
  1341     IF  EMI-LANGUAGE-IS-FR
  1342
  1343* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  30
* EL001.cbl
  1344*             NOTFND   (4090-NOT-FOUND-FR)
  1345*             NOTOPEN  (2250-NOT-OPEN-FR)
  1346*        END-EXEC
  1347*    MOVE '"$IJ                  ! & #00001141' TO DFHEIV0
  1348     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  1349     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1350     MOVE X'2620233030303031313431' TO DFHEIV0(25:11)
  1351     CALL 'kxdfhei1' USING DFHEIV0
  1352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1353
  1354
  1355* EXEC CICS READ
  1356*             DATASET (EM-FILE-ID)
  1357*             RIDFLD  (EM-KEY)
  1358*             INTO    (ERROR-MESSAGE-FILE)
  1359*        END-EXEC
  1360     MOVE LENGTH OF
  1361      ERROR-MESSAGE-FILE
  1362       TO DFHEIV11
  1363*    MOVE '&"IL       E          (   #00001146' TO DFHEIV0
  1364     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1365     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1366     MOVE X'2020233030303031313436' TO DFHEIV0(25:11)
  1367     CALL 'kxdfhei1' USING DFHEIV0,
  1368           EM-FILE-ID,
  1369           ERROR-MESSAGE-FILE,
  1370           DFHEIV11,
  1371           EM-KEY,
  1372           DFHEIV99,
  1373           DFHEIV99,
  1374           DFHEIV99
  1375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1376
  1377*        SERVICE RELOAD ERROR-MESSAGE-FILE-FR
  1378
  1379     ELSE
  1380
  1381* EXEC CICS HANDLE CONDITION
  1382*             NOTFND   (4080-NOT-FOUND)
  1383*             NOTOPEN  (2200-NOT-OPEN)
  1384*        END-EXEC
  1385*    MOVE '"$IJ                  ! '' #00001155' TO DFHEIV0
  1386     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  1387     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1388     MOVE X'2720233030303031313535' TO DFHEIV0(25:11)
  1389     CALL 'kxdfhei1' USING DFHEIV0
  1390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1391
  1392
  1393* EXEC CICS READ
  1394*             DATASET (EM-FILE-ID)
  1395*             RIDFLD  (EM-KEY)
  1396*             INTO    (ERROR-MESSAGE-FILE)
  1397*        END-EXEC.
  1398     MOVE LENGTH OF
  1399      ERROR-MESSAGE-FILE
  1400       TO DFHEIV11
  1401*    MOVE '&"IL       E          (   #00001160' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  31
* EL001.cbl
  1402     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1403     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1404     MOVE X'2020233030303031313630' TO DFHEIV0(25:11)
  1405     CALL 'kxdfhei1' USING DFHEIV0,
  1406           EM-FILE-ID,
  1407           ERROR-MESSAGE-FILE,
  1408           DFHEIV11,
  1409           EM-KEY,
  1410           DFHEIV99,
  1411           DFHEIV99,
  1412           DFHEIV99
  1413     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1414
  1415
  1416*        SERVICE RELOAD ERROR-MESSAGE-FILE-REST.
  1417
  1418     MOVE EMI-CLIENT-ID TO E-CLIENT-ID.
  1419
  1420*                                COPY ELCERRPD.
  1421******************************************************************
  1422*                                                                *
  1423*                                                                *
  1424*                            ELCERRPD                            *
  1425*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1426*                            VMOD=2.005                          *
  1427*                                                                *
  1428*    CLIENT CODED ERROR MESSAGES                                 *
  1429*                                                                *
  1430******************************************************************
  1431
  1432     IF EM-MESSAGE-NUMBER NOT NUMERIC
  1433         MOVE ZEROS TO EM-MESSAGE-NUMBER.
  1434
  1435     IF E-CLIENT-ID EQUAL CLIENT-AIG OR CLIENT-AUK
  1436                         OR CLIENT-CIG OR CLIENT-CUK
  1437        IF EM-MESSAGE-NUMBER EQUAL 0541
  1438            MOVE 'X' TO EM-ERROR-SEVERITY.
  1439
  1440     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER
  1441        IF EM-MESSAGE-NUMBER IS EQUAL TO 1909
  1442            MOVE 'F'             TO  EM-ERROR-SEVERITY.
  1443
  1444     IF E-CLIENT-ID EQUAL CLIENT-LAP
  1445        IF EM-MESSAGE-NUMBER EQUAL 2656
  1446            MOVE 'F' TO EM-ERROR-SEVERITY.
  1447
  1448     IF E-CLIENT-ID IS EQUAL TO CLIENT-NCB
  1449        IF EM-MESSAGE-NUMBER IS EQUAL TO 2671
  1450            MOVE 'F'             TO  EM-ERROR-SEVERITY.
  1451
  1452     IF E-CLIENT-ID IS EQUAL TO CLIENT-ABL OR CLIENT-TIC
  1453        IF EM-MESSAGE-NUMBER IS EQUAL TO 2672
  1454            MOVE 'W'             TO  EM-ERROR-SEVERITY.
  1455
  1456     IF E-CLIENT-ID IS EQUAL TO CLIENT-HER
  1457        IF EM-MESSAGE-NUMBER IS EQUAL TO 2693
  1458            MOVE 'W'             TO  EM-ERROR-SEVERITY.
  1459
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  32
* EL001.cbl
  1460     IF E-CLIENT-ID IS EQUAL TO CLIENT-TMS
  1461        IF EM-MESSAGE-NUMBER IS EQUAL TO 2696
  1462            MOVE 'F'             TO  EM-ERROR-SEVERITY.
  1463
  1464     IF E-CLIENT-ID EQUAL CLIENT-LBL
  1465        IF EM-MESSAGE-NUMBER EQUAL 2738
  1466            MOVE 'W' TO EM-ERROR-SEVERITY.
  1467
  1468     IF E-CLIENT-ID EQUAL CLIENT-LBL
  1469        IF EM-MESSAGE-NUMBER EQUAL 2739
  1470            MOVE 'W' TO EM-ERROR-SEVERITY.
  1471
  1472     IF E-CLIENT-ID EQUAL CLIENT-LBL
  1473        IF EM-MESSAGE-NUMBER EQUAL 2741
  1474            MOVE 'W' TO EM-ERROR-SEVERITY.
  1475
  1476     IF  E-CLIENT-ID EQUAL CLIENT-HAN
  1477             OR
  1478         E-CLIENT-ID EQUAL CLIENT-JHL
  1479
  1480         IF  EM-MESSAGE-NUMBER EQUAL 2756
  1481             MOVE 'F'            TO EM-ERROR-SEVERITY.
  1482
  1483     IF E-CLIENT-ID = CLIENT-NCX
  1484         IF EM-MESSAGE-NUMBER = 9895
  1485             MOVE 'F'            TO EM-ERROR-SEVERITY.
  1486     IF E-CLIENT-ID = CLIENT-DCC
  1487        IF EM-MESSAGE-NUMBER = 2719
  1488           MOVE 'W'              TO EM-ERROR-SEVERITY
  1489        END-IF
  1490     END-IF
  1491     .
  1492
  1493     MOVE '-'                    TO WS-FILL.
  1494     MOVE EM-ERROR-SEVERITY      TO WS-ERROR-SEVERITY.
  1495     MOVE EM-ERROR-TEXT          TO WS-ERROR-TEXT.
  1496
  1497 4050-MOVE-NUMBER.
  1498     MOVE EM-MESSAGE-NUMBER      TO WS-ERROR-NUMBER.
  1499
  1500     IF WS-PREFIX = 'LLLLLL'
  1501        MOVE EMI-LIFE-OVERRIDE-L6  TO WS-PREFIX.
  1502
  1503     IF WS-PREFIX = 'AAAAAA'
  1504        MOVE EMI-AH-OVERRIDE-L6    TO WS-PREFIX.
  1505
  1506     if ws-error-text (1:10) = 'XXXXXXXXXX'
  1507        and emi-claim-no not = spaces
  1508        move emi-claim-no        to ws-error-text (1:10)
  1509     end-if
  1510     MOVE WS-ERROR-LINE          TO ER-LINE (ER-SUB).
  1511
  1512     ADD 1   TO ER-SUB
  1513                ER-NUM.
  1514
  1515     GO TO 4099-EXIT.
  1516
  1517 4080-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  33
* EL001.cbl
  1518     MOVE SPACES                 TO ER-LINE (ER-SUB).
  1519     MOVE 'NO TEXT RECORD FOUND FOR THIS ERROR'  TO WS-ERROR-TEXT.
  1520     MOVE WS-ERROR-LINE          TO ER-LINE (ER-SUB).
  1521     ADD 1                       TO ER-SUB
  1522                                    ER-NUM.
  1523     GO TO 4099-EXIT.
  1524
  1525 4090-NOT-FOUND-FR.
  1526
  1527     MOVE 'E'                    TO EMI-LANGUAGE-IND.
  1528     GO TO 4000-READ-ERRORS.
  1529
  1530 4099-EXIT.
  1531      EXIT.
  1532
  1533 9700-LINK-DATE-CONVERT.
  1534
  1535* EXEC CICS LINK
  1536*        PROGRAM    ('ELDATCV')
  1537*        COMMAREA   (DATE-CONVERSION-DATA)
  1538*        LENGTH     (DC-COMM-LENGTH)
  1539*    END-EXEC.
  1540     MOVE 'ELDATCV' TO DFHEIV1
  1541*    MOVE '."C                   (   #00001284' TO DFHEIV0
  1542     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1543     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1544     MOVE X'2020233030303031323834' TO DFHEIV0(25:11)
  1545     CALL 'kxdfhei1' USING DFHEIV0,
  1546           DFHEIV1,
  1547           DATE-CONVERSION-DATA,
  1548           DC-COMM-LENGTH,
  1549           DFHEIV99,
  1550           DFHEIV99,
  1551           DFHEIV99,
  1552           DFHEIV99
  1553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1554
  1555
  1556 9700-EXIT.
  1557     EXIT.
  1558
  1559
  1560 9999-DFHBACK SECTION.
  1561     MOVE '9%                    "   ' TO DFHEIV0
  1562     MOVE 'EL001' TO DFHEIV1
  1563     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1564     GOBACK.
  1565 9999-DFHEXIT.
  1566     IF DFHEIGDJ EQUAL 0001
  1567         NEXT SENTENCE
  1568     ELSE IF DFHEIGDJ EQUAL 2
  1569         GO TO 2150-NOT-FOUND-FR,
  1570               2250-NOT-OPEN-FR
  1571         DEPENDING ON DFHEIGDI
  1572     ELSE IF DFHEIGDJ EQUAL 3
  1573         GO TO 2100-NOT-FOUND,
  1574               2200-NOT-OPEN
  1575         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 10-Jul-13 14:03 Page  34
* EL001.cbl
  1576     ELSE IF DFHEIGDJ EQUAL 4
  1577         GO TO 3510-WRITE-TS
  1578         DEPENDING ON DFHEIGDI
  1579     ELSE IF DFHEIGDJ EQUAL 5
  1580         GO TO 3520-SEND-MAP
  1581         DEPENDING ON DFHEIGDI
  1582     ELSE IF DFHEIGDJ EQUAL 6
  1583         GO TO 4090-NOT-FOUND-FR,
  1584               2250-NOT-OPEN-FR
  1585         DEPENDING ON DFHEIGDI
  1586     ELSE IF DFHEIGDJ EQUAL 7
  1587         GO TO 4080-NOT-FOUND,
  1588               2200-NOT-OPEN
  1589         DEPENDING ON DFHEIGDI.
  1590     MOVE '9%                    "   ' TO DFHEIV0
  1591     MOVE 'EL001' TO DFHEIV1
  1592     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1593     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2924     Code:        5469
