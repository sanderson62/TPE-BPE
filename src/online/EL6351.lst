* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6351.cbl
* Options: int("EL6351.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6351.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6351.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6351.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6351.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:52:13.
     7*                            VMOD=2.031
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6351.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        TRANSACTION - EXJ5 - COMPENSATION PAYMENTS/ADJUSTMENTS.
    27
    28 ENVIRONMENT DIVISION.
    29 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6351.cbl
    31 WORKING-STORAGE SECTION.
    32 01  DFH-START PIC X(04).
    33 77  FILLER  PIC X(32)  VALUE '********************************'.
    34 77  FILLER  PIC X(32)  VALUE '*    EL6351 WORKING STORAGE    *'.
    35 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.031 *********'.
    36
    37*    COPY ELCSCTM.
    38******************************************************************
    39*                                                                *
    40*                                                                *
    41*                            ELCSCTM                             *
    42*                            VMOD=2.001                          *
    43*                                                                *
    44*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    45*                                                                *
    46******************************************************************
    47 01  SECURITY-MESSAGE.
    48     12  FILLER                          PIC X(30)
    49            VALUE '** LOGIC SECURITY VIOLATION -'.
    50     12  SM-READ                         PIC X(6).
    51     12  FILLER                          PIC X(5)
    52            VALUE ' PGM='.
    53     12  SM-PGM                          PIC X(6).
    54     12  FILLER                          PIC X(5)
    55            VALUE ' OPR='.
    56     12  SM-PROCESSOR-ID                 PIC X(4).
    57     12  FILLER                          PIC X(6)
    58            VALUE ' TERM='.
    59     12  SM-TERMID                       PIC X(4).
    60     12  FILLER                          PIC XX   VALUE SPACE.
    61     12  SM-JUL-DATE                     PIC 9(5).
    62     12  FILLER                          PIC X    VALUE SPACE.
    63     12  SM-TIME                         PIC 99.99.
    64
    65*    COPY ELCSCRTY.
    66******************************************************************
    67*                                                                *
    68*                                                                *
    69*                            ELCSCRTY                            *
    70*                            VMOD=2.001                          *
    71*                                                                *
    72*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    73*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    74*        SAVED IN PI-SECURITY-ADDRESS.                           *
    75*                                                                *
    76******************************************************************
    77 01  SECURITY-CONTROL.
    78     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    79     12  FILLER                       PIC XX    VALUE 'SC'.
    80     12  SC-CREDIT-CODES.
    81         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    82             20  SC-CREDIT-DISPLAY    PIC X.
    83             20  SC-CREDIT-UPDATE     PIC X.
    84     12  SC-CLAIMS-CODES.
    85         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    86             20  SC-CLAIMS-DISPLAY    PIC X.
    87             20  SC-CLAIMS-UPDATE     PIC X.
    88*    COPY MPCSCRT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6351.cbl
    89******************************************************************
    90*                                                                *
    91*                            MPCSCRT                             *
    92*                            VMOD=1.001                          *
    93*                                                                *
    94*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    95*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
    96*                                      (MP MORTGAGE PROTECTION)  *
    97*                                                                *
    98******************************************************************
    99*
   100 01  SECURITY-CONTROL-E.
   101     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
   102     12  FILLER                       PIC  X(02) VALUE 'SC'.
   103     12  SC-QUID-KEY.
   104         16  SC-QUID-TERMINAL         PIC  X(04).
   105         16  SC-QUID-SYSTEM           PIC  X(04).
   106     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   107     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   108     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   109         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   110         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   111     12  SC-MP-CODES.
   112         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   113             20  SC-MP-DISPLAY        PIC  X(01).
   114             20  SC-MP-UPDATE         PIC  X(01).
   115     12  FILLER                       PIC  X(40).
   116
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6351.cbl
   118
   119 01  STANDARD-AREAS.
   120     12  GETMAIN-SPACE       PIC  X          VALUE SPACE.
   121     12  MAP-NAME            PIC  X(8)       VALUE 'EL635B '.
   122     12  MAPSET-NAME         PIC  X(8)       VALUE 'EL6351S'.
   123     12  SCREEN-NUMBER       PIC  X(4)       VALUE '633B'.
   124     12  TRANS-ID            PIC  X(4)       VALUE 'EXJ5'.
   125     12  THIS-PGM            PIC  X(8)       VALUE 'EL6351'.
   126     12  PGM-NAME            PIC  X(8).
   127     12  TIME-IN             PIC S9(7).
   128     12  TIME-OUT-R  REDEFINES  TIME-IN.
   129         16  FILLER          PIC  X.
   130         16  TIME-OUT        PIC  9(2)V9(2).
   131         16  FILLER          PIC  X(2).
   132     12  XCTL-005            PIC  X(8)       VALUE 'EL005'.
   133     12  XCTL-010            PIC  X(8)       VALUE 'EL010'.
   134     12  XCTL-EL126          PIC  X(8)       VALUE 'EL126'.
   135     12  XCTL-EL626          PIC  X(8)       VALUE 'EL626'.
   136     12  XCTL-EM626          PIC  X(8)       VALUE 'EM626'.
   137     12  XCTL-GL800          PIC  X(8)       VALUE 'GL800'.
   138     12  XCTL-652            PIC  X(8)       VALUE 'EL652'.
   139     12  LINK-001            PIC  X(8)       VALUE 'EL001'.
   140     12  LINK-004            PIC  X(8)       VALUE 'EL004'.
   141     12  LINK-CLDATCV        PIC  X(8)       VALUE 'ELDATCV'.
   142     12  PYAJ-FILE-ID        PIC  X(8)       VALUE 'ERPYAJ'.
   143     12  MPPYAJ-FILE-ID      PIC  X(8)       VALUE 'MPPYAJ'.
   144     12  MPPRCN-FILE-ID      PIC  X(8)       VALUE 'MPPRCN'.
   145     12  COMP-FILE-ID        PIC  X(8)       VALUE 'ERCOMP'.
   146     12  RECV-FILE-ID        PIC  X(8)       VALUE 'ERRECV'.
   147     12  WS-CURRENT-DT       PIC  X(8)       VALUE SPACES.
   148     12  WS-CURRENT-MDY      PIC  X(6)       VALUE SPACES.
   149     12  WS-CURRENT-BIN-DT   PIC  X(2)       VALUE SPACES.
   150     12  WS-COMMENT-FULL.
   151         16  WS-COMMENT-24-POS    PIC  X(24) VALUE SPACES.
   152         16  FILLER               PIC  X(06) VALUE SPACES.
   153     12  WORK-SEQ-NO         PIC S9(9)                  COMP-3.
   154     12  CHECK-REC-TYPE      PIC  X          VALUE SPACE.
   155         88  VALID-REC-TYPE                  VALUE  'R' 'D' 'C'
   156                                                    'S' 'T' 'U'
   157                                                    'X' 'Y' 'Z'
   158                                                    'F'.
   159         88  MON-VALID-REC-TYPE              VALUE  'R' 'D' 'C'
   160                                                    'Z'.
   161         88  ANL-VALID-REC-TYPE              VALUE  'R' 'D' 'C'
   162                                                    'S' 'T' 'U'
   163                                                    'X' 'Y' 'Z'.
   164         88  NCL-VALID-REC-TYPE              VALUE  'R' 'D' 'C'
   165                                                    'X' 'Y' 'Z'.
   166     12  ERROR-3183          PIC  X          VALUE SPACE.
   167         88  ER-3183-OCCURRED                VALUE 'Y'.
   168
   169     12  DEEDIT-FIELD            PIC X(11).
   170     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(11).
   171     12  DATE-TEST-AREA          PIC 9(6).
   172     12  DATE-TEST-AREA-R  REDEFINES DATE-TEST-AREA.
   173         16  DATE-TEST-MM        PIC 99.
   174         16  DATE-TEST-DD        PIC 99.
   175         16  DATE-TEST-YY        PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6351.cbl
   176     12  DIVIDE-RESULT           PIC 99.
   177     12  DIVIDE-REMAINDER        PIC 9.
   178     12  WS-EOM-DTS     OCCURS 5 TIMES
   179                                INDEXED BY MINDEX.
   180         16  WS-EOM-DT           PIC XX.
   181     12  WS-INP-DTS     OCCURS 5 TIMES
   182                                INDEXED BY DINDEX.
   183         16  WS-INP-DT           PIC XX.
   184     12  WS-EDITED-AMTS OCCURS 6 TIMES
   185                                INDEXED BY WS-INDX.
   186         16  WS-EDITED-AMT       PIC S9(9)V99.
   187
   188     12  WS-ENTRY-AMT        PIC S9(7)V99      VALUE ZEROS.
   189     12  WS-PREV-PF5         PIC X.
   190     12  WS-ACCEPT.
   191         16  WS-ACCEPT-1   OCCURS 5 TIMES INDEXED BY W-INDX
   192                             PIC  X.
   193
   194 01  ACCESS-KEYS.
   195     12  ERPYAJ-KEY.
   196         16  PYAJ-COMP-CD        PIC  X      VALUE SPACE.
   197         16  PYAJ-CARRIER        PIC  X      VALUE SPACES.
   198         16  PYAJ-GROUPING       PIC  X(6)   VALUE SPACES.
   199         16  PYAJ-FIN-RESP       PIC  X(10)  VALUE SPACES.
   200         16  PYAJ-ACCOUNT        PIC  X(10)  VALUE SPACES.
   201         16  PYAJ-FILE-SEQ-NO    PIC S9(8)   VALUE +0   COMP.
   202         16  PYAJ-RECORD-TYPE    PIC  X      VALUE SPACES.
   203
   204     12  ERPYAJ-RECORD-LENGTH    PIC S9(4)   VALUE +200 COMP.
   205     12  ERPYAJ-JOURNAL-LENGTH   PIC S9(4)   VALUE +223 COMP.
   206
   207     12  ERCOMP-KEY.
   208         16  COMP-COMP-CD        PIC  X      VALUE SPACE.
   209         16  COMP-CARRIER        PIC  X      VALUE SPACES.
   210         16  COMP-GROUPING       PIC  X(6)   VALUE SPACES.
   211         16  COMP-FIN-RESP       PIC  X(10)  VALUE SPACES.
   212         16  COMP-ACCOUNT        PIC  X(10)  VALUE SPACES.
   213         16  COMP-RECORD-TYPE    PIC  X      VALUE SPACES.
   214
   215     12  ERCOMP-RECORD-LENGTH    PIC S9(4)   VALUE +700 COMP.
   216
   217     12  ERRECV-KEY.
   218         16  RECV-COMP-CD        PIC X       VALUE SPACES.
   219         16  RECV-TYPE           PIC X       VALUE SPACES.
   220         16  RECV-CARRIER        PIC X       VALUE SPACES.
   221         16  RECV-GROUPING       PIC X(6)    VALUE SPACES.
   222         16  RECV-BAL-LVL        PIC X       VALUE SPACES.
   223         16  RECV-ENTRY-TYPE     PIC X       VALUE SPACES.
   224         16  RECV-FIN-RESP       PIC X(10)   VALUE SPACES.
   225         16  RECV-ACCOUNT        PIC X(10)   VALUE SPACES.
   226         16  RECV-INVOICE        PIC X(6)    VALUE SPACES.
   227         16  RECV-REFERENCE      PIC X(12)   VALUE SPACES.
   228         16  RECV-RESPONSIBLE    PIC X       VALUE SPACES.
   229         16  RECV-RECORD-TYPE    PIC X       VALUE SPACES.
   230         16  RECV-RECORD-SEQ     PIC S9(4)   VALUE +0 COMP.
   231
   232     12  MPPRCN-KEY.
   233         16  MPPRCN-COMPANY-CD       PIC X       VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6351.cbl
   234         16  MPPRCN-INVOICE          PIC X(6)    VALUE SPACES.
   235         16  MPPRCN-RECORD-SEQU      PIC S9(7)   VALUE +0  COMP-3.
   236
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6351.cbl
   238 01  ERROR-NUMBERS.
   239     12  ER-0000             PIC  X(4)       VALUE '0000'.
   240     12  ER-0008             PIC  X(4)       VALUE '0008'.
   241     12  ER-0029             PIC  X(4)       VALUE '0029'.
   242     12  ER-0070             PIC  X(4)       VALUE '0070'.
   243     12  ER-0194             PIC  X(4)       VALUE '0194'.
   244     12  ER-0195             PIC  X(4)       VALUE '0195'.
   245     12  ER-0197             PIC  X(4)       VALUE '0197'.
   246     12  ER-0587             PIC  X(4)       VALUE '0587'.
   247     12  ER-0714             PIC  X(4)       VALUE '0714'.
   248     12  ER-0761             PIC  X(4)       VALUE '0761'.
   249     12  ER-2232             PIC  X(4)       VALUE '2232'.
   250     12  ER-2233             PIC  X(4)       VALUE '2233'.
   251     12  ER-2234             PIC  X(4)       VALUE '2234'.
   252     12  ER-2235             PIC  X(4)       VALUE '2235'.
   253     12  ER-2236             PIC  X(4)       VALUE '2236'.
   254     12  ER-2245             PIC  X(4)       VALUE '2245'.
   255     12  ER-2562             PIC  X(4)       VALUE '2562'.
   256     12  ER-2587             PIC  X(4)       VALUE '2587'.
   257     12  ER-2588             PIC  X(4)       VALUE '2588'.
   258     12  ER-2595             PIC  X(4)       VALUE '2595'.
   259     12  ER-2596             PIC  X(4)       VALUE '2596'.
   260     12  ER-7806             PIC  X(4)       VALUE '7806'.
   261     12  ER-9296             PIC  X(4)       VALUE '9296'.
   262     12  ER-3146             PIC  X(4)       VALUE '3146'.
   263     12  ER-3172             PIC  X(4)       VALUE '3172'.
   264     12  ER-3175             PIC  X(4)       VALUE '3175'.
   265     12  ER-3177             PIC  X(4)       VALUE '3177'.
   266     12  ER-3178             PIC  X(4)       VALUE '3178'.
   267     12  ER-3179             PIC  X(4)       VALUE '3179'.
   268     12  ER-3180             PIC  X(4)       VALUE '3180'.
   269     12  ER-3183             PIC  X(4)       VALUE '3183'.
   270     12  ER-3184             PIC  X(4)       VALUE '3184'.
   271     12  ER-9280             PIC  X(4)       VALUE '9280'.
   272     12  ER-9094             PIC  X(4)       VALUE '9094'.
   273     12  ER-9095             PIC  X(4)       VALUE '9095'.
   274     12  ER-9179             PIC  X(4)       VALUE '9179'.
   275
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6351.cbl
   277*    COPY ELCDATE.
   278******************************************************************
   279*                                                                *
   280*                                                                *
   281*                            ELCDATE.                            *
   282*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   283*                            VMOD=2.003
   284*                                                                *
   285*                                                                *
   286*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   287*                 LENGTH = 200                                   *
   288******************************************************************
   289
   290 01  DATE-CONVERSION-DATA.
   291     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   292     12  DC-OPTION-CODE                PIC X.
   293         88  BIN-TO-GREG                VALUE ' '.
   294         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   295         88  EDIT-GREG-TO-BIN           VALUE '2'.
   296         88  YMD-GREG-TO-BIN            VALUE '3'.
   297         88  MDY-GREG-TO-BIN            VALUE '4'.
   298         88  JULIAN-TO-BIN              VALUE '5'.
   299         88  BIN-PLUS-ELAPSED           VALUE '6'.
   300         88  FIND-CENTURY               VALUE '7'.
   301         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   302         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   303         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   304         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   305         88  JULIAN-TO-BIN-3            VALUE 'C'.
   306         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   307         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   308         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   309         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   310         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   311         88  CHECK-LEAP-YEAR            VALUE 'H'.
   312         88  BIN-3-TO-GREG              VALUE 'I'.
   313         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   314         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   315         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   316         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   317         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   318         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   319         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   320         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   321         88  THREE-CHARACTER-BIN
   322                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   323         88  GREGORIAN-TO-BIN
   324                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   325         88  BIN-TO-GREGORIAN
   326                  VALUES ' ' '1' 'I' '8' 'G'.
   327         88  JULIAN-TO-BINARY
   328                  VALUES '5' 'C' 'E' 'F'.
   329     12  DC-ERROR-CODE                 PIC X.
   330         88  NO-CONVERSION-ERROR        VALUE ' '.
   331         88  DATE-CONVERSION-ERROR
   332                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   333         88  DATE-IS-ZERO               VALUE '1'.
   334         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6351.cbl
   335         88  DATE-IS-INVALID            VALUE '3'.
   336         88  DATE1-GREATER-DATE2        VALUE '4'.
   337         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   338         88  DATE-INVALID-OPTION        VALUE '9'.
   339         88  INVALID-CENTURY            VALUE 'A'.
   340         88  ONLY-CENTURY               VALUE 'B'.
   341         88  ONLY-LEAP-YEAR             VALUE 'C'.
   342         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   343     12  DC-END-OF-MONTH               PIC X.
   344         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   345     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   346         88  USE-NORMAL-PROCESS         VALUE ' '.
   347         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   348         88  ADJUST-UP-100-YRS          VALUE '2'.
   349     12  FILLER                        PIC X.
   350     12  DC-CONVERSION-DATES.
   351         16  DC-BIN-DATE-1             PIC XX.
   352         16  DC-BIN-DATE-2             PIC XX.
   353         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   354         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   355                       DC-GREG-DATE-1-EDIT.
   356             20  DC-EDIT1-MONTH        PIC 99.
   357             20  SLASH1-1              PIC X.
   358             20  DC-EDIT1-DAY          PIC 99.
   359             20  SLASH1-2              PIC X.
   360             20  DC-EDIT1-YEAR         PIC 99.
   361         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   362         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   363                     DC-GREG-DATE-2-EDIT.
   364             20  DC-EDIT2-MONTH        PIC 99.
   365             20  SLASH2-1              PIC X.
   366             20  DC-EDIT2-DAY          PIC 99.
   367             20  SLASH2-2              PIC X.
   368             20  DC-EDIT2-YEAR         PIC 99.
   369         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   370         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   371                     DC-GREG-DATE-1-YMD.
   372             20  DC-YMD-YEAR           PIC 99.
   373             20  DC-YMD-MONTH          PIC 99.
   374             20  DC-YMD-DAY            PIC 99.
   375         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   376         16  DC-GREG-DATE-1-MDY-R REDEFINES
   377                      DC-GREG-DATE-1-MDY.
   378             20  DC-MDY-MONTH          PIC 99.
   379             20  DC-MDY-DAY            PIC 99.
   380             20  DC-MDY-YEAR           PIC 99.
   381         16  DC-GREG-DATE-1-ALPHA.
   382             20  DC-ALPHA-MONTH        PIC X(10).
   383             20  DC-ALPHA-DAY          PIC 99.
   384             20  FILLER                PIC XX.
   385             20  DC-ALPHA-CENTURY.
   386                 24 DC-ALPHA-CEN-N     PIC 99.
   387             20  DC-ALPHA-YEAR         PIC 99.
   388         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   389         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   390         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   391         16  DC-JULIAN-DATE            PIC 9(05).
   392         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6351.cbl
   393                                       PIC 9(05).
   394         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   395             20  DC-JULIAN-YEAR        PIC 99.
   396             20  DC-JULIAN-DAYS        PIC 999.
   397         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   398         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   399         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   400     12  DATE-CONVERSION-VARIBLES.
   401         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   402         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   403             20  FILLER                PIC 9(3).
   404             20  HOLD-CEN-1-CCYY.
   405                 24  HOLD-CEN-1-CC     PIC 99.
   406                 24  HOLD-CEN-1-YY     PIC 99.
   407             20  HOLD-CEN-1-MO         PIC 99.
   408             20  HOLD-CEN-1-DA         PIC 99.
   409         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   410             20  HOLD-CEN-1-R-MO       PIC 99.
   411             20  HOLD-CEN-1-R-DA       PIC 99.
   412             20  HOLD-CEN-1-R-CCYY.
   413                 24  HOLD-CEN-1-R-CC   PIC 99.
   414                 24  HOLD-CEN-1-R-YY   PIC 99.
   415             20  FILLER                PIC 9(3).
   416         16  HOLD-CENTURY-1-X.
   417             20  FILLER                PIC X(3)  VALUE SPACES.
   418             20  HOLD-CEN-1-X-CCYY.
   419                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   420                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   421             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   422             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   423         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   424             20  HOLD-CEN-1-R-X-MO     PIC XX.
   425             20  HOLD-CEN-1-R-X-DA     PIC XX.
   426             20  HOLD-CEN-1-R-X-CCYY.
   427                 24  HOLD-CEN-1-R-X-CC PIC XX.
   428                 24  HOLD-CEN-1-R-X-YY PIC XX.
   429             20  FILLER                PIC XXX.
   430         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   431         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   432         16  DC-JULIAN-DATE-1          PIC 9(07).
   433         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   434             20  DC-JULIAN-1-CCYY.
   435                 24  DC-JULIAN-1-CC    PIC 99.
   436                 24  DC-JULIAN-1-YR    PIC 99.
   437             20  DC-JULIAN-DA-1        PIC 999.
   438         16  DC-JULIAN-DATE-2          PIC 9(07).
   439         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   440             20  DC-JULIAN-2-CCYY.
   441                 24  DC-JULIAN-2-CC    PIC 99.
   442                 24  DC-JULIAN-2-YR    PIC 99.
   443             20  DC-JULIAN-DA-2        PIC 999.
   444         16  DC-GREG-DATE-A-EDIT.
   445             20  DC-EDITA-MONTH        PIC 99.
   446             20  SLASHA-1              PIC X VALUE '/'.
   447             20  DC-EDITA-DAY          PIC 99.
   448             20  SLASHA-2              PIC X VALUE '/'.
   449             20  DC-EDITA-CCYY.
   450                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6351.cbl
   451                 24  DC-EDITA-YEAR     PIC 99.
   452         16  DC-GREG-DATE-B-EDIT.
   453             20  DC-EDITB-MONTH        PIC 99.
   454             20  SLASHB-1              PIC X VALUE '/'.
   455             20  DC-EDITB-DAY          PIC 99.
   456             20  SLASHB-2              PIC X VALUE '/'.
   457             20  DC-EDITB-CCYY.
   458                 24  DC-EDITB-CENT     PIC 99.
   459                 24  DC-EDITB-YEAR     PIC 99.
   460         16  DC-GREG-DATE-CYMD         PIC 9(08).
   461         16  DC-GREG-DATE-CYMD-R REDEFINES
   462                              DC-GREG-DATE-CYMD.
   463             20  DC-CYMD-CEN           PIC 99.
   464             20  DC-CYMD-YEAR          PIC 99.
   465             20  DC-CYMD-MONTH         PIC 99.
   466             20  DC-CYMD-DAY           PIC 99.
   467         16  DC-GREG-DATE-MDCY         PIC 9(08).
   468         16  DC-GREG-DATE-MDCY-R REDEFINES
   469                              DC-GREG-DATE-MDCY.
   470             20  DC-MDCY-MONTH         PIC 99.
   471             20  DC-MDCY-DAY           PIC 99.
   472             20  DC-MDCY-CEN           PIC 99.
   473             20  DC-MDCY-YEAR          PIC 99.
   474    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   475        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   476    12  DC-EL310-DATE                  PIC X(21).
   477    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6351.cbl
   479*    COPY ELCLOGOF.
   480******************************************************************
   481*                                                                *
   482*                                                                *
   483*                            ELCLOGOF.                           *
   484*                            VMOD=2.001                          *
   485*                                                                *
   486*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   487*                                                                *
   488******************************************************************
   489 01  CLASIC-LOGOFF.
   490     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   491     12  LOGOFF-TEXT.
   492         16  FILLER          PIC X(5)    VALUE SPACES.
   493         16  LOGOFF-MSG.
   494             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   495             20  FILLER      PIC X       VALUE SPACES.
   496             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   497         16  FILLER          PIC X(80)
   498           VALUE '* YOU ARE NOW LOGGED OFF'.
   499         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   500         16  FILLER          PIC X       VALUE QUOTE.
   501         16  LOGOFF-SYS-MSG  PIC X(17)
   502           VALUE 'S CLAS-IC SYSTEM '.
   503     12  TEXT-MESSAGES.
   504         16  UNACCESS-MSG    PIC X(29)
   505             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   506         16  PGMIDERR-MSG    PIC X(17)
   507             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6351.cbl
   509*    COPY ELCATTR.
   510******************************************************************
   511*                                                                *
   512*                            ELCATTR.                            *
   513*                            VMOD=2.001                          *
   514*                                                                *
   515*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   516*                                                                *
   517*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   518*                                                                *
   519*                   POS 1   P=PROTECTED                          *
   520*                           U=UNPROTECTED                        *
   521*                           S=ASKIP                              *
   522*                   POS 2   A=ALPHA/NUMERIC                      *
   523*                           N=NUMERIC                            *
   524*                   POS 3   N=NORMAL                             *
   525*                           B=BRIGHT                             *
   526*                           D=DARK                               *
   527*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   528*                           OF=MODIFIED DATA TAG OFF             *
   529*                                                                *
   530*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   531******************************************************************
   532 01  ATTRIBUTE-LIST.
   533     12  AL-PABOF            PIC X       VALUE 'Y'.
   534     12  AL-PABON            PIC X       VALUE 'Z'.
   535     12  AL-PADOF            PIC X       VALUE '%'.
   536     12  AL-PADON            PIC X       VALUE '_'.
   537     12  AL-PANOF            PIC X       VALUE '-'.
   538     12  AL-PANON            PIC X       VALUE '/'.
   539     12  AL-SABOF            PIC X       VALUE '8'.
   540     12  AL-SABON            PIC X       VALUE '9'.
   541     12  AL-SADOF            PIC X       VALUE '@'.
   542     12  AL-SADON            PIC X       VALUE QUOTE.
   543     12  AL-SANOF            PIC X       VALUE '0'.
   544     12  AL-SANON            PIC X       VALUE '1'.
   545     12  AL-UABOF            PIC X       VALUE 'H'.
   546     12  AL-UABON            PIC X       VALUE 'I'.
   547     12  AL-UADOF            PIC X       VALUE '<'.
   548     12  AL-UADON            PIC X       VALUE '('.
   549     12  AL-UANOF            PIC X       VALUE ' '.
   550     12  AL-UANON            PIC X       VALUE 'A'.
   551     12  AL-UNBOF            PIC X       VALUE 'Q'.
   552     12  AL-UNBON            PIC X       VALUE 'R'.
   553     12  AL-UNDOF            PIC X       VALUE '*'.
   554     12  AL-UNDON            PIC X       VALUE ')'.
   555     12  AL-UNNOF            PIC X       VALUE '&'.
   556     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6351.cbl
   558*    COPY ELCEMIB.
   559******************************************************************
   560*                                                                *
   561*                                                                *
   562*                            ELCEMIB.                            *
   563*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   564*                            VMOD=2.005                          *
   565*                                                                *
   566*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   567*                                                                *
   568******************************************************************
   569 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   570     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   571     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   572     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   573     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   574     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   575     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   576     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   577     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   578     12  EMI-SWITCH1             PIC X        VALUE '1'.
   579         88  EMI-NO-ERRORS                    VALUE '1'.
   580         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   581         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   582     12  EMI-SWITCH2             PIC X        VALUE '1'.
   583         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   584     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   585         88  EMI-AREA1-EMPTY                  VALUE '1'.
   586         88  EMI-AREA1-FULL                   VALUE '2'.
   587     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   588         88  EMI-AREA2-EMPTY                  VALUE '1'.
   589         88  EMI-AREA2-FULL                   VALUE '2'.
   590     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   591         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   592         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   593         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   594         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   595         88  EMI-BYPASS-FATALS                VALUE 'X'.
   596     12  EMI-ERROR-LINES.
   597         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   598         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   599         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   600         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   601             20  EMI-ERR-CODES OCCURS 10 TIMES.
   602                 24  EMI-ERR-NUM         PIC X(4).
   603                 24  EMI-FILLER          PIC X.
   604                 24  EMI-SEV             PIC X.
   605                 24  FILLER              PIC X.
   606             20  FILLER                  PIC X(02).
   607     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   608         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   609             20  EMI-ERROR-NUMBER    PIC X(4).
   610             20  EMI-FILL            PIC X.
   611             20  EMI-SEVERITY        PIC X.
   612             20  FILLER              PIC X.
   613             20  EMI-ERROR-TEXT.
   614                 24  EMI-TEXT-VARIABLE   PIC X(10).
   615                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6351.cbl
   616     12  EMI-SEVERITY-SAVE           PIC X.
   617         88  EMI-NOTE                    VALUE 'N'.
   618         88  EMI-WARNING                 VALUE 'W'.
   619         88  EMI-FORCABLE                VALUE 'F'.
   620         88  EMI-FATAL                   VALUE 'X'.
   621     12  EMI-MESSAGE-FLAG            PIC X.
   622         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   623         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   624     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   625     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   626         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   627         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   628         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   629     12  FILLER                      PIC X(137)  VALUE SPACES.
   630     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   631     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   632     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   633     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6351.cbl
   635*    COPY ELCINTF.
   636******************************************************************
   637*                                                                *
   638*                                                                *
   639*                            ELCINTF.                            *
   640*                            VMOD=2.017                          *
   641*                                                                *
   642*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   643*                                                                *
   644*       LENGTH = 1024                                            *
   645*                                                                *
   646******************************************************************
   647 01  PROGRAM-INTERFACE-BLOCK.
   648     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   649     12  PI-CALLING-PROGRAM              PIC X(8).
   650     12  PI-SAVED-PROGRAM-1              PIC X(8).
   651     12  PI-SAVED-PROGRAM-2              PIC X(8).
   652     12  PI-SAVED-PROGRAM-3              PIC X(8).
   653     12  PI-SAVED-PROGRAM-4              PIC X(8).
   654     12  PI-SAVED-PROGRAM-5              PIC X(8).
   655     12  PI-SAVED-PROGRAM-6              PIC X(8).
   656     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   657     12  PI-COMPANY-ID                   PIC XXX.
   658     12  PI-COMPANY-CD                   PIC X.
   659
   660     12  PI-COMPANY-PASSWORD             PIC X(8).
   661
   662     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   663
   664     12  PI-CONTROL-IN-PROGRESS.
   665         16  PI-CARRIER                  PIC X.
   666         16  PI-GROUPING                 PIC X(6).
   667         16  PI-STATE                    PIC XX.
   668         16  PI-ACCOUNT                  PIC X(10).
   669         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   670                                         PIC X(10).
   671         16  PI-CLAIM-CERT-GRP.
   672             20  PI-CLAIM-NO             PIC X(7).
   673             20  PI-CERT-NO.
   674                 25  PI-CERT-PRIME       PIC X(10).
   675                 25  PI-CERT-SFX         PIC X.
   676             20  PI-CERT-EFF-DT          PIC XX.
   677         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   678             20  PI-PLAN-CODE            PIC X(2).
   679             20  PI-REVISION-NUMBER      PIC X(3).
   680             20  PI-PLAN-EFF-DT          PIC X(2).
   681             20  PI-PLAN-EXP-DT          PIC X(2).
   682             20  FILLER                  PIC X(11).
   683         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   684             20  PI-OE-REFERENCE-1.
   685                 25  PI-OE-REF-1-PRIME   PIC X(18).
   686                 25  PI-OE-REF-1-SUFF    PIC XX.
   687
   688     12  PI-SESSION-IN-PROGRESS          PIC X.
   689         88  CLAIM-SESSION                   VALUE '1'.
   690         88  CREDIT-SESSION                  VALUE '2'.
   691         88  WARRANTY-SESSION                VALUE '3'.
   692         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6351.cbl
   693         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   694
   695
   696*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   697
   698     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   699     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   700
   701     12  PI-CREDIT-USER                  PIC X.
   702         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   703         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   704
   705     12  PI-CLAIM-USER                   PIC X.
   706         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   707         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   708
   709     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   710         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   711         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   712         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   713         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   714         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   715
   716     12  PI-PROCESSOR-ID                 PIC X(4).
   717
   718     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   719
   720     12  PI-MEMBER-CAPTION               PIC X(10).
   721
   722     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   723         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   724
   725     12  PI-LIFE-OVERRIDE-L1             PIC X.
   726     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   727     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   728     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   729
   730     12  PI-AH-OVERRIDE-L1               PIC X.
   731     12  PI-AH-OVERRIDE-L2               PIC XX.
   732     12  PI-AH-OVERRIDE-L6               PIC X(6).
   733     12  PI-AH-OVERRIDE-L12              PIC X(12).
   734
   735     12  PI-NEW-SYSTEM                   PIC X(2).
   736
   737     12  PI-PRIMARY-CERT-NO              PIC X(11).
   738     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   739         88  PI-USES-PAID-TO                 VALUE '1'.
   740     12  PI-CRDTCRD-SYSTEM.
   741         16  PI-CRDTCRD-USER             PIC X.
   742             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   743             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   744         16  PI-CC-MONTH-END-DT          PIC XX.
   745     12  PI-PROCESSOR-PRINTER            PIC X(4).
   746
   747     12  PI-OE-REFERENCE-2.
   748         16  PI-OE-REF-2-PRIME           PIC X(10).
   749         16  PI-OE-REF-2-SUFF            PIC X.
   750
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6351.cbl
   751     12  PI-REM-TRM-CALC-OPTION          PIC X.
   752
   753     12  PI-LANGUAGE-TYPE                PIC X.
   754             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   755             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   756             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   757
   758     12  PI-POLICY-LINKAGE-IND           PIC X.
   759         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   760         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   761                                                   LOW-VALUES.
   762
   763     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   764     12  PI-CLAIM-PW-SESSION             PIC X(1).
   765         88  PI-CLAIM-CREDIT                 VALUE '1'.
   766         88  PI-CLAIM-CONVEN                 VALUE '2'.
   767     12  FILLER                          PIC X(4).
   768
   769     12  PI-SYSTEM-LEVEL                 PIC X(145).
   770
   771     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   772         PI-SYSTEM-LEVEL.
   773
   774         16  PI-ENTRY-CODES.
   775             20  PI-ENTRY-CD-1           PIC X.
   776             20  PI-ENTRY-CD-2           PIC X.
   777
   778         16  PI-RETURN-CODES.
   779             20  PI-RETURN-CD-1          PIC X.
   780             20  PI-RETURN-CD-2          PIC X.
   781
   782         16  PI-UPDATE-STATUS-SAVE.
   783             20  PI-UPDATE-BY            PIC X(4).
   784             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   785
   786         16  PI-LOWER-CASE-LETTERS       PIC X.
   787             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   788
   789*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   790*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   791*            88  CARRIER-CLM-CNTL            VALUE '2'.
   792
   793         16  PI-CERT-ACCESS-CONTROL      PIC X.
   794             88  ST-ACCNT-CNTL               VALUE ' '.
   795             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   796             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   797             88  ACCNT-CNTL                  VALUE '3'.
   798             88  CARR-ACCNT-CNTL             VALUE '4'.
   799
   800         16  PI-PROCESSOR-CAP-LIST.
   801             20  PI-SYSTEM-CONTROLS.
   802                24 PI-SYSTEM-DISPLAY     PIC X.
   803                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   804                24 PI-SYSTEM-MODIFY      PIC X.
   805                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   806             20  FILLER                  PIC XX.
   807             20  PI-DISPLAY-CAP          PIC X.
   808                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6351.cbl
   809             20  PI-MODIFY-CAP           PIC X.
   810                 88  MODIFY-CAP              VALUE 'Y'.
   811             20  PI-MSG-AT-LOGON-CAP     PIC X.
   812                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   813             20  PI-FORCE-CAP            PIC X.
   814                 88  FORCE-CAP               VALUE 'Y'.
   815
   816         16  PI-PROGRAM-CONTROLS.
   817             20  PI-PGM-PRINT-OPT        PIC X.
   818             20  PI-PGM-FORMAT-OPT       PIC X.
   819             20  PI-PGM-PROCESS-OPT      PIC X.
   820             20  PI-PGM-TOTALS-OPT       PIC X.
   821
   822         16  PI-HELP-INTERFACE.
   823             20  PI-LAST-ERROR-NO        PIC X(4).
   824             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   825
   826         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   827             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   828
   829         16  PI-CR-CONTROL-IN-PROGRESS.
   830             20  PI-CR-CARRIER           PIC X.
   831             20  PI-CR-GROUPING          PIC X(6).
   832             20  PI-CR-STATE             PIC XX.
   833             20  PI-CR-ACCOUNT           PIC X(10).
   834             20  PI-CR-FIN-RESP          PIC X(10).
   835             20  PI-CR-TYPE              PIC X.
   836
   837         16  PI-CR-BATCH-NUMBER          PIC X(6).
   838
   839         16  PI-CR-MONTH-END-DT          PIC XX.
   840
   841         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   842             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   843             88  PI-ZERO-CARRIER             VALUE '1'.
   844             88  PI-ZERO-GROUPING            VALUE '2'.
   845             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   846
   847         16  PI-CARRIER-SECURITY         PIC X.
   848             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   849
   850         16  PI-ACCOUNT-SECURITY         PIC X(10).
   851             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   852             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   853
   854         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   855             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   856                                         INDEXED BY PI-ACCESS-NDX
   857                                         PIC X.
   858
   859         16  PI-GA-BILLING-CONTROL       PIC X.
   860             88  PI-GA-BILLING               VALUE '1'.
   861
   862         16  PI-MAIL-PROCESSING          PIC X.
   863             88  PI-MAIL-YES                 VALUE 'Y'.
   864
   865         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   866
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6351.cbl
   867         16  PI-AR-SYSTEM.
   868             20  PI-AR-PROCESSING-CNTL   PIC X.
   869                 88  PI-AR-PROCESSING        VALUE 'Y'.
   870             20  PI-AR-SUMMARY-CODE      PIC X(6).
   871             20  PI-AR-MONTH-END-DT      PIC XX.
   872
   873         16  PI-MP-SYSTEM.
   874             20  PI-MORTGAGE-USER            PIC X.
   875                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   876                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   877             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   878                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   879                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   880                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   881                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   882                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   883             20  PI-MP-MONTH-END-DT          PIC XX.
   884             20  PI-MP-REFERENCE-NO.
   885                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   886                 24  PI-MP-REFERENCE-SFX     PIC XX.
   887
   888         16  PI-LABEL-CONTROL            PIC X(01).
   889             88  PI-CREATE-LABELS                    VALUE 'Y'.
   890             88  PI-BYPASS-LABELS                    VALUE 'N'.
   891
   892         16  PI-BILL-GROUPING-CODE       PIC X(01).
   893             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   894
   895         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   896             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   897             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   898
   899         16  FILLER                      PIC X(14).
   900
   901     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   902******************************************************************
   903     12  FILLER  REDEFINES  PI-PROGRAM-WORK-AREA.
   904         16  PI-PYAJ-FILE-SW         PIC  X.
   905             88  END-OF-ACCT                 VALUE 'A'.
   906             88  END-OF-FILE                 VALUE 'X'.
   907             88  NO-RECORDS                  VALUE 'Y'.
   908             88  NOT-OPEN                    VALUE 'Z'.
   909         16  PI-PREV-FUNCTION        PIC  X.
   910         16  PI-SAV-FUNCTION         PIC  X.
   911         16  PI-SEQ-NOS.
   912             20  FILLER  OCCURS  5 TIMES
   913                             INDEXED BY NDX.
   914                 24  PI-REC-TYPE     PIC  X.
   915                 24  PI-FILE-SEQ-NO  PIC S9(8).
   916         16  PI-SAV-ENDING-PYAJ-KEY.
   917             20  PI-SAV-COMP-CD      PIC  X.
   918             20  PI-SAV-CARRIER      PIC  X.
   919             20  PI-SAV-GROUPING     PIC  X(3).
   920             20  PI-SAV-FIN-RESP     PIC  X(6).
   921             20  PI-SAV-ACCOUNT      PIC  X(6).
   922             20  PI-SAV-FILE-SEQ-NO  PIC S9(8)          COMP.
   923             20  PI-SAV-RECORD-TYPE  PIC  X.
   924         16  PI-ACCEPT-DESC          PIC  X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6351.cbl
   925         16  PI-ACCEPT               PIC  X(5).
   926         16  PI-SAVE-COMP-BAL-CODE   PIC  X.
   927         16  PI-SEQ-FIRST-TIME-SW    PIC  X.
   928             88  PI-SEQ-FST-TIME       VALUE 'Y'.
   929         16  FILLER                  PIC  X(557).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6351.cbl
   931*    COPY ELCJPFX.
   932******************************************************************
   933*                                                                *
   934*                                                                *
   935*                            ELCJPFX.                            *
   936*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   937*                            VMOD=2.002                          *
   938*                                                                *
   939*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   940*                                                                *
   941*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   942*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   943*        ELCNTL - CONTROL FILE                                   *
   944*        ELMSTR - CLAIM MASTERS                                  *
   945*        ELTRLR - ACTIVITY TRAILERS                              *
   946*        ELCHKQ - CHECK QUE                                      *
   947******************************************************************
   948 01  JOURNAL-RECORD.
   949     12  JP-USER-ID                  PIC X(4).
   950     12  JP-FILE-ID                  PIC X(8).
   951     12  JP-PROGRAM-ID               PIC X(8).
   952     12  JP-RECORD-TYPE              PIC X.
   953         88 JP-ADD              VALUE 'A'.
   954         88 JP-BEFORE-CHANGE    VALUE 'B'.
   955         88 JP-AFTER-CHANGE     VALUE 'C'.
   956         88 JP-DELETE           VALUE 'D'.
   957         88 JP-GENERIC-DELETE   VALUE 'G'.
   958         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   959         88 JP-KEY-CHG-ADD      VALUE 'N'.
   960     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   961     12  JP-RECORD-AREA
   962
   963
   964                             PIC  X(223).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6351.cbl
   966*    COPY ELCAID.
   967******************************************************************
   968*                                                                *
   969*                            ELCAID.                             *
   970*                            VMOD=2.001                          *
   971*                                                                *
   972*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   973*                                                                *
   974*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   975*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   976******************************************************************
   977
   978 01  DFHAID.
   979   02  DFHNULL   PIC  X  VALUE  ' '.
   980   02  DFHENTER  PIC  X  VALUE  QUOTE.
   981   02  DFHCLEAR  PIC  X  VALUE  '_'.
   982   02  DFHPEN    PIC  X  VALUE  '='.
   983   02  DFHOPID   PIC  X  VALUE  'W'.
   984   02  DFHPA1    PIC  X  VALUE  '%'.
   985   02  DFHPA2    PIC  X  VALUE  '>'.
   986   02  DFHPA3    PIC  X  VALUE  ','.
   987   02  DFHPF1    PIC  X  VALUE  '1'.
   988   02  DFHPF2    PIC  X  VALUE  '2'.
   989   02  DFHPF3    PIC  X  VALUE  '3'.
   990   02  DFHPF4    PIC  X  VALUE  '4'.
   991   02  DFHPF5    PIC  X  VALUE  '5'.
   992   02  DFHPF6    PIC  X  VALUE  '6'.
   993   02  DFHPF7    PIC  X  VALUE  '7'.
   994   02  DFHPF8    PIC  X  VALUE  '8'.
   995   02  DFHPF9    PIC  X  VALUE  '9'.
   996   02  DFHPF10   PIC  X  VALUE  ':'.
   997   02  DFHPF11   PIC  X  VALUE  '#'.
   998   02  DFHPF12   PIC  X  VALUE  '@'.
   999   02  DFHPF13   PIC  X  VALUE  'A'.
  1000   02  DFHPF14   PIC  X  VALUE  'B'.
  1001   02  DFHPF15   PIC  X  VALUE  'C'.
  1002   02  DFHPF16   PIC  X  VALUE  'D'.
  1003   02  DFHPF17   PIC  X  VALUE  'E'.
  1004   02  DFHPF18   PIC  X  VALUE  'F'.
  1005   02  DFHPF19   PIC  X  VALUE  'G'.
  1006   02  DFHPF20   PIC  X  VALUE  'H'.
  1007   02  DFHPF21   PIC  X  VALUE  'I'.
  1008*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1009   02  DFHPF22   PIC  X  VALUE  '['.
  1010   02  DFHPF23   PIC  X  VALUE  '.'.
  1011   02  DFHPF24   PIC  X  VALUE  '<'.
  1012   02  DFHMSRE   PIC  X  VALUE  'X'.
  1013   02  DFHSTRF   PIC  X  VALUE  'h'.
  1014   02  DFHTRIG   PIC  X  VALUE  '"'.
  1015
  1016 01  FILLER    REDEFINES DFHAID.
  1017     12  FILLER              PIC  X(8).
  1018     12  PF-VALUES           PIC  X          OCCURS 2 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6351.cbl
  1020*    COPY EL6351S.
  1021 01  EL635BI.
  1022     05  FILLER            PIC  X(0012).
  1023*    -------------------------------
  1024     05  DATEL PIC S9(0004) COMP.
  1025     05  DATEF PIC  X(0001).
  1026     05  FILLER REDEFINES DATEF.
  1027         10  DATEA PIC  X(0001).
  1028     05  DATEI PIC  X(0008).
  1029*    -------------------------------
  1030     05  TIMEL PIC S9(0004) COMP.
  1031     05  TIMEF PIC  X(0001).
  1032     05  FILLER REDEFINES TIMEF.
  1033         10  TIMEA PIC  X(0001).
  1034     05  TIMEI PIC  X(0005).
  1035*    -------------------------------
  1036     05  CAR1L PIC S9(0004) COMP.
  1037     05  CAR1F PIC  X(0001).
  1038     05  FILLER REDEFINES CAR1F.
  1039         10  CAR1A PIC  X(0001).
  1040     05  CAR1I PIC  X(0001).
  1041*    -------------------------------
  1042     05  GRP1L PIC S9(0004) COMP.
  1043     05  GRP1F PIC  X(0001).
  1044     05  FILLER REDEFINES GRP1F.
  1045         10  GRP1A PIC  X(0001).
  1046     05  GRP1I PIC  X(0006).
  1047*    -------------------------------
  1048     05  FRESP1L PIC S9(0004) COMP.
  1049     05  FRESP1F PIC  X(0001).
  1050     05  FILLER REDEFINES FRESP1F.
  1051         10  FRESP1A PIC  X(0001).
  1052     05  FRESP1I PIC  X(0010).
  1053*    -------------------------------
  1054     05  ACTHDG1L PIC S9(0004) COMP.
  1055     05  ACTHDG1F PIC  X(0001).
  1056     05  FILLER REDEFINES ACTHDG1F.
  1057         10  ACTHDG1A PIC  X(0001).
  1058     05  ACTHDG1I PIC  X(0005).
  1059*    -------------------------------
  1060     05  ACCT1L PIC S9(0004) COMP.
  1061     05  ACCT1F PIC  X(0001).
  1062     05  FILLER REDEFINES ACCT1F.
  1063         10  ACCT1A PIC  X(0001).
  1064     05  ACCT1I PIC  X(0010).
  1065*    -------------------------------
  1066     05  TYPE1L PIC S9(0004) COMP.
  1067     05  TYPE1F PIC  X(0001).
  1068     05  FILLER REDEFINES TYPE1F.
  1069         10  TYPE1A PIC  X(0001).
  1070     05  TYPE1I PIC  X(0001).
  1071*    -------------------------------
  1072     05  AMT1L PIC S9(0004) COMP.
  1073     05  AMT1F PIC  X(0001).
  1074     05  FILLER REDEFINES AMT1F.
  1075         10  AMT1A PIC  X(0001).
  1076     05  AMT1I PIC  X(0011).
  1077*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6351.cbl
  1078     05  COMM1L PIC S9(0004) COMP.
  1079     05  COMM1F PIC  X(0001).
  1080     05  FILLER REDEFINES COMM1F.
  1081         10  COMM1A PIC  X(0001).
  1082     05  COMM1I PIC  X(0030).
  1083*    -------------------------------
  1084     05  REF1L PIC S9(0004) COMP.
  1085     05  REF1F PIC  X(0001).
  1086     05  FILLER REDEFINES REF1F.
  1087         10  REF1A PIC  X(0001).
  1088     05  REF1I PIC  X(0012).
  1089*    -------------------------------
  1090     05  INV1L PIC S9(0004) COMP.
  1091     05  INV1F PIC  X(0001).
  1092     05  FILLER REDEFINES INV1F.
  1093         10  INV1A PIC  X(0001).
  1094     05  INV1I PIC  X(0006).
  1095*    -------------------------------
  1096     05  APLID1L PIC S9(0004) COMP.
  1097     05  APLID1F PIC  X(0001).
  1098     05  FILLER REDEFINES APLID1F.
  1099         10  APLID1A PIC  X(0001).
  1100     05  APLID1I PIC  X(0001).
  1101*    -------------------------------
  1102     05  CR1L PIC S9(0004) COMP.
  1103     05  CR1F PIC  X(0001).
  1104     05  FILLER REDEFINES CR1F.
  1105         10  CR1A PIC  X(0001).
  1106     05  CR1I PIC  X(0014).
  1107*    -------------------------------
  1108     05  DR1L PIC S9(0004) COMP.
  1109     05  DR1F PIC  X(0001).
  1110     05  FILLER REDEFINES DR1F.
  1111         10  DR1A PIC  X(0001).
  1112     05  DR1I PIC  X(0014).
  1113*    -------------------------------
  1114     05  EOM1L PIC S9(0004) COMP.
  1115     05  EOM1F PIC  X(0001).
  1116     05  FILLER REDEFINES EOM1F.
  1117         10  EOM1A PIC  X(0001).
  1118     05  EOM1I PIC  X(0006).
  1119*    -------------------------------
  1120     05  INDTE1L PIC S9(0004) COMP.
  1121     05  INDTE1F PIC  X(0001).
  1122     05  FILLER REDEFINES INDTE1F.
  1123         10  INDTE1A PIC  X(0001).
  1124     05  INDTE1I PIC  X(0006).
  1125*    -------------------------------
  1126     05  CAR2L PIC S9(0004) COMP.
  1127     05  CAR2F PIC  X(0001).
  1128     05  FILLER REDEFINES CAR2F.
  1129         10  CAR2A PIC  X(0001).
  1130     05  CAR2I PIC  X(0001).
  1131*    -------------------------------
  1132     05  GRP2L PIC S9(0004) COMP.
  1133     05  GRP2F PIC  X(0001).
  1134     05  FILLER REDEFINES GRP2F.
  1135         10  GRP2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6351.cbl
  1136     05  GRP2I PIC  X(0006).
  1137*    -------------------------------
  1138     05  FRESP2L PIC S9(0004) COMP.
  1139     05  FRESP2F PIC  X(0001).
  1140     05  FILLER REDEFINES FRESP2F.
  1141         10  FRESP2A PIC  X(0001).
  1142     05  FRESP2I PIC  X(0010).
  1143*    -------------------------------
  1144     05  ACTHDG2L PIC S9(0004) COMP.
  1145     05  ACTHDG2F PIC  X(0001).
  1146     05  FILLER REDEFINES ACTHDG2F.
  1147         10  ACTHDG2A PIC  X(0001).
  1148     05  ACTHDG2I PIC  X(0005).
  1149*    -------------------------------
  1150     05  ACCT2L PIC S9(0004) COMP.
  1151     05  ACCT2F PIC  X(0001).
  1152     05  FILLER REDEFINES ACCT2F.
  1153         10  ACCT2A PIC  X(0001).
  1154     05  ACCT2I PIC  X(0010).
  1155*    -------------------------------
  1156     05  TYPE2L PIC S9(0004) COMP.
  1157     05  TYPE2F PIC  X(0001).
  1158     05  FILLER REDEFINES TYPE2F.
  1159         10  TYPE2A PIC  X(0001).
  1160     05  TYPE2I PIC  X(0001).
  1161*    -------------------------------
  1162     05  AMT2L PIC S9(0004) COMP.
  1163     05  AMT2F PIC  X(0001).
  1164     05  FILLER REDEFINES AMT2F.
  1165         10  AMT2A PIC  X(0001).
  1166     05  AMT2I PIC  X(0011).
  1167*    -------------------------------
  1168     05  COMM2L PIC S9(0004) COMP.
  1169     05  COMM2F PIC  X(0001).
  1170     05  FILLER REDEFINES COMM2F.
  1171         10  COMM2A PIC  X(0001).
  1172     05  COMM2I PIC  X(0030).
  1173*    -------------------------------
  1174     05  REF2L PIC S9(0004) COMP.
  1175     05  REF2F PIC  X(0001).
  1176     05  FILLER REDEFINES REF2F.
  1177         10  REF2A PIC  X(0001).
  1178     05  REF2I PIC  X(0012).
  1179*    -------------------------------
  1180     05  INV2L PIC S9(0004) COMP.
  1181     05  INV2F PIC  X(0001).
  1182     05  FILLER REDEFINES INV2F.
  1183         10  INV2A PIC  X(0001).
  1184     05  INV2I PIC  X(0006).
  1185*    -------------------------------
  1186     05  APLID2L PIC S9(0004) COMP.
  1187     05  APLID2F PIC  X(0001).
  1188     05  FILLER REDEFINES APLID2F.
  1189         10  APLID2A PIC  X(0001).
  1190     05  APLID2I PIC  X(0001).
  1191*    -------------------------------
  1192     05  CR2L PIC S9(0004) COMP.
  1193     05  CR2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6351.cbl
  1194     05  FILLER REDEFINES CR2F.
  1195         10  CR2A PIC  X(0001).
  1196     05  CR2I PIC  X(0014).
  1197*    -------------------------------
  1198     05  DR2L PIC S9(0004) COMP.
  1199     05  DR2F PIC  X(0001).
  1200     05  FILLER REDEFINES DR2F.
  1201         10  DR2A PIC  X(0001).
  1202     05  DR2I PIC  X(0014).
  1203*    -------------------------------
  1204     05  EOM2L PIC S9(0004) COMP.
  1205     05  EOM2F PIC  X(0001).
  1206     05  FILLER REDEFINES EOM2F.
  1207         10  EOM2A PIC  X(0001).
  1208     05  EOM2I PIC  X(0006).
  1209*    -------------------------------
  1210     05  INDTE2L PIC S9(0004) COMP.
  1211     05  INDTE2F PIC  X(0001).
  1212     05  FILLER REDEFINES INDTE2F.
  1213         10  INDTE2A PIC  X(0001).
  1214     05  INDTE2I PIC  X(0006).
  1215*    -------------------------------
  1216     05  CAR3L PIC S9(0004) COMP.
  1217     05  CAR3F PIC  X(0001).
  1218     05  FILLER REDEFINES CAR3F.
  1219         10  CAR3A PIC  X(0001).
  1220     05  CAR3I PIC  X(0001).
  1221*    -------------------------------
  1222     05  GRP3L PIC S9(0004) COMP.
  1223     05  GRP3F PIC  X(0001).
  1224     05  FILLER REDEFINES GRP3F.
  1225         10  GRP3A PIC  X(0001).
  1226     05  GRP3I PIC  X(0006).
  1227*    -------------------------------
  1228     05  FRESP3L PIC S9(0004) COMP.
  1229     05  FRESP3F PIC  X(0001).
  1230     05  FILLER REDEFINES FRESP3F.
  1231         10  FRESP3A PIC  X(0001).
  1232     05  FRESP3I PIC  X(0010).
  1233*    -------------------------------
  1234     05  ACTHDG3L PIC S9(0004) COMP.
  1235     05  ACTHDG3F PIC  X(0001).
  1236     05  FILLER REDEFINES ACTHDG3F.
  1237         10  ACTHDG3A PIC  X(0001).
  1238     05  ACTHDG3I PIC  X(0005).
  1239*    -------------------------------
  1240     05  ACCT3L PIC S9(0004) COMP.
  1241     05  ACCT3F PIC  X(0001).
  1242     05  FILLER REDEFINES ACCT3F.
  1243         10  ACCT3A PIC  X(0001).
  1244     05  ACCT3I PIC  X(0010).
  1245*    -------------------------------
  1246     05  TYPE3L PIC S9(0004) COMP.
  1247     05  TYPE3F PIC  X(0001).
  1248     05  FILLER REDEFINES TYPE3F.
  1249         10  TYPE3A PIC  X(0001).
  1250     05  TYPE3I PIC  X(0001).
  1251*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6351.cbl
  1252     05  AMT3L PIC S9(0004) COMP.
  1253     05  AMT3F PIC  X(0001).
  1254     05  FILLER REDEFINES AMT3F.
  1255         10  AMT3A PIC  X(0001).
  1256     05  AMT3I PIC  X(0011).
  1257*    -------------------------------
  1258     05  COMM3L PIC S9(0004) COMP.
  1259     05  COMM3F PIC  X(0001).
  1260     05  FILLER REDEFINES COMM3F.
  1261         10  COMM3A PIC  X(0001).
  1262     05  COMM3I PIC  X(0030).
  1263*    -------------------------------
  1264     05  REF3L PIC S9(0004) COMP.
  1265     05  REF3F PIC  X(0001).
  1266     05  FILLER REDEFINES REF3F.
  1267         10  REF3A PIC  X(0001).
  1268     05  REF3I PIC  X(0012).
  1269*    -------------------------------
  1270     05  INV3L PIC S9(0004) COMP.
  1271     05  INV3F PIC  X(0001).
  1272     05  FILLER REDEFINES INV3F.
  1273         10  INV3A PIC  X(0001).
  1274     05  INV3I PIC  X(0006).
  1275*    -------------------------------
  1276     05  APLID3L PIC S9(0004) COMP.
  1277     05  APLID3F PIC  X(0001).
  1278     05  FILLER REDEFINES APLID3F.
  1279         10  APLID3A PIC  X(0001).
  1280     05  APLID3I PIC  X(0001).
  1281*    -------------------------------
  1282     05  CR3L PIC S9(0004) COMP.
  1283     05  CR3F PIC  X(0001).
  1284     05  FILLER REDEFINES CR3F.
  1285         10  CR3A PIC  X(0001).
  1286     05  CR3I PIC  X(0014).
  1287*    -------------------------------
  1288     05  DR3L PIC S9(0004) COMP.
  1289     05  DR3F PIC  X(0001).
  1290     05  FILLER REDEFINES DR3F.
  1291         10  DR3A PIC  X(0001).
  1292     05  DR3I PIC  X(0014).
  1293*    -------------------------------
  1294     05  EOM3L PIC S9(0004) COMP.
  1295     05  EOM3F PIC  X(0001).
  1296     05  FILLER REDEFINES EOM3F.
  1297         10  EOM3A PIC  X(0001).
  1298     05  EOM3I PIC  X(0006).
  1299*    -------------------------------
  1300     05  INDTE3L PIC S9(0004) COMP.
  1301     05  INDTE3F PIC  X(0001).
  1302     05  FILLER REDEFINES INDTE3F.
  1303         10  INDTE3A PIC  X(0001).
  1304     05  INDTE3I PIC  X(0006).
  1305*    -------------------------------
  1306     05  CAR4L PIC S9(0004) COMP.
  1307     05  CAR4F PIC  X(0001).
  1308     05  FILLER REDEFINES CAR4F.
  1309         10  CAR4A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6351.cbl
  1310     05  CAR4I PIC  X(0001).
  1311*    -------------------------------
  1312     05  GRP4L PIC S9(0004) COMP.
  1313     05  GRP4F PIC  X(0001).
  1314     05  FILLER REDEFINES GRP4F.
  1315         10  GRP4A PIC  X(0001).
  1316     05  GRP4I PIC  X(0006).
  1317*    -------------------------------
  1318     05  FRESP4L PIC S9(0004) COMP.
  1319     05  FRESP4F PIC  X(0001).
  1320     05  FILLER REDEFINES FRESP4F.
  1321         10  FRESP4A PIC  X(0001).
  1322     05  FRESP4I PIC  X(0010).
  1323*    -------------------------------
  1324     05  ACTHDG4L PIC S9(0004) COMP.
  1325     05  ACTHDG4F PIC  X(0001).
  1326     05  FILLER REDEFINES ACTHDG4F.
  1327         10  ACTHDG4A PIC  X(0001).
  1328     05  ACTHDG4I PIC  X(0005).
  1329*    -------------------------------
  1330     05  ACCT4L PIC S9(0004) COMP.
  1331     05  ACCT4F PIC  X(0001).
  1332     05  FILLER REDEFINES ACCT4F.
  1333         10  ACCT4A PIC  X(0001).
  1334     05  ACCT4I PIC  X(0010).
  1335*    -------------------------------
  1336     05  TYPE4L PIC S9(0004) COMP.
  1337     05  TYPE4F PIC  X(0001).
  1338     05  FILLER REDEFINES TYPE4F.
  1339         10  TYPE4A PIC  X(0001).
  1340     05  TYPE4I PIC  X(0001).
  1341*    -------------------------------
  1342     05  AMT4L PIC S9(0004) COMP.
  1343     05  AMT4F PIC  X(0001).
  1344     05  FILLER REDEFINES AMT4F.
  1345         10  AMT4A PIC  X(0001).
  1346     05  AMT4I PIC  X(0011).
  1347*    -------------------------------
  1348     05  COMM4L PIC S9(0004) COMP.
  1349     05  COMM4F PIC  X(0001).
  1350     05  FILLER REDEFINES COMM4F.
  1351         10  COMM4A PIC  X(0001).
  1352     05  COMM4I PIC  X(0030).
  1353*    -------------------------------
  1354     05  REF4L PIC S9(0004) COMP.
  1355     05  REF4F PIC  X(0001).
  1356     05  FILLER REDEFINES REF4F.
  1357         10  REF4A PIC  X(0001).
  1358     05  REF4I PIC  X(0012).
  1359*    -------------------------------
  1360     05  INV4L PIC S9(0004) COMP.
  1361     05  INV4F PIC  X(0001).
  1362     05  FILLER REDEFINES INV4F.
  1363         10  INV4A PIC  X(0001).
  1364     05  INV4I PIC  X(0006).
  1365*    -------------------------------
  1366     05  APLID4L PIC S9(0004) COMP.
  1367     05  APLID4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6351.cbl
  1368     05  FILLER REDEFINES APLID4F.
  1369         10  APLID4A PIC  X(0001).
  1370     05  APLID4I PIC  X(0001).
  1371*    -------------------------------
  1372     05  CR4L PIC S9(0004) COMP.
  1373     05  CR4F PIC  X(0001).
  1374     05  FILLER REDEFINES CR4F.
  1375         10  CR4A PIC  X(0001).
  1376     05  CR4I PIC  X(0014).
  1377*    -------------------------------
  1378     05  DR4L PIC S9(0004) COMP.
  1379     05  DR4F PIC  X(0001).
  1380     05  FILLER REDEFINES DR4F.
  1381         10  DR4A PIC  X(0001).
  1382     05  DR4I PIC  X(0014).
  1383*    -------------------------------
  1384     05  EOM4L PIC S9(0004) COMP.
  1385     05  EOM4F PIC  X(0001).
  1386     05  FILLER REDEFINES EOM4F.
  1387         10  EOM4A PIC  X(0001).
  1388     05  EOM4I PIC  X(0006).
  1389*    -------------------------------
  1390     05  INDTE4L PIC S9(0004) COMP.
  1391     05  INDTE4F PIC  X(0001).
  1392     05  FILLER REDEFINES INDTE4F.
  1393         10  INDTE4A PIC  X(0001).
  1394     05  INDTE4I PIC  X(0006).
  1395*    -------------------------------
  1396     05  CAR5L PIC S9(0004) COMP.
  1397     05  CAR5F PIC  X(0001).
  1398     05  FILLER REDEFINES CAR5F.
  1399         10  CAR5A PIC  X(0001).
  1400     05  CAR5I PIC  X(0001).
  1401*    -------------------------------
  1402     05  GRP5L PIC S9(0004) COMP.
  1403     05  GRP5F PIC  X(0001).
  1404     05  FILLER REDEFINES GRP5F.
  1405         10  GRP5A PIC  X(0001).
  1406     05  GRP5I PIC  X(0006).
  1407*    -------------------------------
  1408     05  FRESP5L PIC S9(0004) COMP.
  1409     05  FRESP5F PIC  X(0001).
  1410     05  FILLER REDEFINES FRESP5F.
  1411         10  FRESP5A PIC  X(0001).
  1412     05  FRESP5I PIC  X(0010).
  1413*    -------------------------------
  1414     05  ACTHDG5L PIC S9(0004) COMP.
  1415     05  ACTHDG5F PIC  X(0001).
  1416     05  FILLER REDEFINES ACTHDG5F.
  1417         10  ACTHDG5A PIC  X(0001).
  1418     05  ACTHDG5I PIC  X(0005).
  1419*    -------------------------------
  1420     05  ACCT5L PIC S9(0004) COMP.
  1421     05  ACCT5F PIC  X(0001).
  1422     05  FILLER REDEFINES ACCT5F.
  1423         10  ACCT5A PIC  X(0001).
  1424     05  ACCT5I PIC  X(0010).
  1425*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6351.cbl
  1426     05  TYPE5L PIC S9(0004) COMP.
  1427     05  TYPE5F PIC  X(0001).
  1428     05  FILLER REDEFINES TYPE5F.
  1429         10  TYPE5A PIC  X(0001).
  1430     05  TYPE5I PIC  X(0001).
  1431*    -------------------------------
  1432     05  AMT5L PIC S9(0004) COMP.
  1433     05  AMT5F PIC  X(0001).
  1434     05  FILLER REDEFINES AMT5F.
  1435         10  AMT5A PIC  X(0001).
  1436     05  AMT5I PIC  X(0011).
  1437*    -------------------------------
  1438     05  COMM5L PIC S9(0004) COMP.
  1439     05  COMM5F PIC  X(0001).
  1440     05  FILLER REDEFINES COMM5F.
  1441         10  COMM5A PIC  X(0001).
  1442     05  COMM5I PIC  X(0030).
  1443*    -------------------------------
  1444     05  REF5L PIC S9(0004) COMP.
  1445     05  REF5F PIC  X(0001).
  1446     05  FILLER REDEFINES REF5F.
  1447         10  REF5A PIC  X(0001).
  1448     05  REF5I PIC  X(0012).
  1449*    -------------------------------
  1450     05  INV5L PIC S9(0004) COMP.
  1451     05  INV5F PIC  X(0001).
  1452     05  FILLER REDEFINES INV5F.
  1453         10  INV5A PIC  X(0001).
  1454     05  INV5I PIC  X(0006).
  1455*    -------------------------------
  1456     05  APLID5L PIC S9(0004) COMP.
  1457     05  APLID5F PIC  X(0001).
  1458     05  FILLER REDEFINES APLID5F.
  1459         10  APLID5A PIC  X(0001).
  1460     05  APLID5I PIC  X(0001).
  1461*    -------------------------------
  1462     05  CR5L PIC S9(0004) COMP.
  1463     05  CR5F PIC  X(0001).
  1464     05  FILLER REDEFINES CR5F.
  1465         10  CR5A PIC  X(0001).
  1466     05  CR5I PIC  X(0014).
  1467*    -------------------------------
  1468     05  DR5L PIC S9(0004) COMP.
  1469     05  DR5F PIC  X(0001).
  1470     05  FILLER REDEFINES DR5F.
  1471         10  DR5A PIC  X(0001).
  1472     05  DR5I PIC  X(0014).
  1473*    -------------------------------
  1474     05  EOM5L PIC S9(0004) COMP.
  1475     05  EOM5F PIC  X(0001).
  1476     05  FILLER REDEFINES EOM5F.
  1477         10  EOM5A PIC  X(0001).
  1478     05  EOM5I PIC  X(0006).
  1479*    -------------------------------
  1480     05  INDTE5L PIC S9(0004) COMP.
  1481     05  INDTE5F PIC  X(0001).
  1482     05  FILLER REDEFINES INDTE5F.
  1483         10  INDTE5A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6351.cbl
  1484     05  INDTE5I PIC  X(0006).
  1485*    -------------------------------
  1486     05  ERRMSG1L PIC S9(0004) COMP.
  1487     05  ERRMSG1F PIC  X(0001).
  1488     05  FILLER REDEFINES ERRMSG1F.
  1489         10  ERRMSG1A PIC  X(0001).
  1490     05  ERRMSG1I PIC  X(0079).
  1491*    -------------------------------
  1492     05  ERRMSG2L PIC S9(0004) COMP.
  1493     05  ERRMSG2F PIC  X(0001).
  1494     05  FILLER REDEFINES ERRMSG2F.
  1495         10  ERRMSG2A PIC  X(0001).
  1496     05  ERRMSG2I PIC  X(0079).
  1497*    -------------------------------
  1498     05  PFENTERL PIC S9(0004) COMP.
  1499     05  PFENTERF PIC  X(0001).
  1500     05  FILLER REDEFINES PFENTERF.
  1501         10  PFENTERA PIC  X(0001).
  1502     05  PFENTERI PIC  9(2).
  1503 01  EL635BO REDEFINES EL635BI.
  1504     05  FILLER            PIC  X(0012).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  DATEO PIC  X(0008).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  TIMEO PIC  99.99.
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  CAR1O PIC  X(0001).
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  GRP1O PIC  X(0006).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  FRESP1O PIC  X(0010).
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  ACTHDG1O PIC  X(0005).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  ACCT1O PIC  X(0010).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  TYPE1O PIC  X(0001).
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  AMT1O PIC  X(0011).
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  COMM1O PIC  X(0030).
  1535*    -------------------------------
  1536     05  FILLER            PIC  X(0003).
  1537     05  REF1O PIC  X(0012).
  1538*    -------------------------------
  1539     05  FILLER            PIC  X(0003).
  1540     05  INV1O PIC  X(0006).
  1541*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6351.cbl
  1542     05  FILLER            PIC  X(0003).
  1543     05  APLID1O PIC  X(0001).
  1544*    -------------------------------
  1545     05  FILLER            PIC  X(0003).
  1546     05  CR1O PIC  X(0014).
  1547*    -------------------------------
  1548     05  FILLER            PIC  X(0003).
  1549     05  DR1O PIC  X(0014).
  1550*    -------------------------------
  1551     05  FILLER            PIC  X(0003).
  1552     05  EOM1O PIC  X(0006).
  1553*    -------------------------------
  1554     05  FILLER            PIC  X(0003).
  1555     05  INDTE1O PIC  X(0006).
  1556*    -------------------------------
  1557     05  FILLER            PIC  X(0003).
  1558     05  CAR2O PIC  X(0001).
  1559*    -------------------------------
  1560     05  FILLER            PIC  X(0003).
  1561     05  GRP2O PIC  X(0006).
  1562*    -------------------------------
  1563     05  FILLER            PIC  X(0003).
  1564     05  FRESP2O PIC  X(0010).
  1565*    -------------------------------
  1566     05  FILLER            PIC  X(0003).
  1567     05  ACTHDG2O PIC  X(0005).
  1568*    -------------------------------
  1569     05  FILLER            PIC  X(0003).
  1570     05  ACCT2O PIC  X(0010).
  1571*    -------------------------------
  1572     05  FILLER            PIC  X(0003).
  1573     05  TYPE2O PIC  X(0001).
  1574*    -------------------------------
  1575     05  FILLER            PIC  X(0003).
  1576     05  AMT2O PIC  X(0011).
  1577*    -------------------------------
  1578     05  FILLER            PIC  X(0003).
  1579     05  COMM2O PIC  X(0030).
  1580*    -------------------------------
  1581     05  FILLER            PIC  X(0003).
  1582     05  REF2O PIC  X(0012).
  1583*    -------------------------------
  1584     05  FILLER            PIC  X(0003).
  1585     05  INV2O PIC  X(0006).
  1586*    -------------------------------
  1587     05  FILLER            PIC  X(0003).
  1588     05  APLID2O PIC  X(0001).
  1589*    -------------------------------
  1590     05  FILLER            PIC  X(0003).
  1591     05  CR2O PIC  X(0014).
  1592*    -------------------------------
  1593     05  FILLER            PIC  X(0003).
  1594     05  DR2O PIC  X(0014).
  1595*    -------------------------------
  1596     05  FILLER            PIC  X(0003).
  1597     05  EOM2O PIC  X(0006).
  1598*    -------------------------------
  1599     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6351.cbl
  1600     05  INDTE2O PIC  X(0006).
  1601*    -------------------------------
  1602     05  FILLER            PIC  X(0003).
  1603     05  CAR3O PIC  X(0001).
  1604*    -------------------------------
  1605     05  FILLER            PIC  X(0003).
  1606     05  GRP3O PIC  X(0006).
  1607*    -------------------------------
  1608     05  FILLER            PIC  X(0003).
  1609     05  FRESP3O PIC  X(0010).
  1610*    -------------------------------
  1611     05  FILLER            PIC  X(0003).
  1612     05  ACTHDG3O PIC  X(0005).
  1613*    -------------------------------
  1614     05  FILLER            PIC  X(0003).
  1615     05  ACCT3O PIC  X(0010).
  1616*    -------------------------------
  1617     05  FILLER            PIC  X(0003).
  1618     05  TYPE3O PIC  X(0001).
  1619*    -------------------------------
  1620     05  FILLER            PIC  X(0003).
  1621     05  AMT3O PIC  X(0011).
  1622*    -------------------------------
  1623     05  FILLER            PIC  X(0003).
  1624     05  COMM3O PIC  X(0030).
  1625*    -------------------------------
  1626     05  FILLER            PIC  X(0003).
  1627     05  REF3O PIC  X(0012).
  1628*    -------------------------------
  1629     05  FILLER            PIC  X(0003).
  1630     05  INV3O PIC  X(0006).
  1631*    -------------------------------
  1632     05  FILLER            PIC  X(0003).
  1633     05  APLID3O PIC  X(0001).
  1634*    -------------------------------
  1635     05  FILLER            PIC  X(0003).
  1636     05  CR3O PIC  X(0014).
  1637*    -------------------------------
  1638     05  FILLER            PIC  X(0003).
  1639     05  DR3O PIC  X(0014).
  1640*    -------------------------------
  1641     05  FILLER            PIC  X(0003).
  1642     05  EOM3O PIC  X(0006).
  1643*    -------------------------------
  1644     05  FILLER            PIC  X(0003).
  1645     05  INDTE3O PIC  X(0006).
  1646*    -------------------------------
  1647     05  FILLER            PIC  X(0003).
  1648     05  CAR4O PIC  X(0001).
  1649*    -------------------------------
  1650     05  FILLER            PIC  X(0003).
  1651     05  GRP4O PIC  X(0006).
  1652*    -------------------------------
  1653     05  FILLER            PIC  X(0003).
  1654     05  FRESP4O PIC  X(0010).
  1655*    -------------------------------
  1656     05  FILLER            PIC  X(0003).
  1657     05  ACTHDG4O PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6351.cbl
  1658*    -------------------------------
  1659     05  FILLER            PIC  X(0003).
  1660     05  ACCT4O PIC  X(0010).
  1661*    -------------------------------
  1662     05  FILLER            PIC  X(0003).
  1663     05  TYPE4O PIC  X(0001).
  1664*    -------------------------------
  1665     05  FILLER            PIC  X(0003).
  1666     05  AMT4O PIC  X(0011).
  1667*    -------------------------------
  1668     05  FILLER            PIC  X(0003).
  1669     05  COMM4O PIC  X(0030).
  1670*    -------------------------------
  1671     05  FILLER            PIC  X(0003).
  1672     05  REF4O PIC  X(0012).
  1673*    -------------------------------
  1674     05  FILLER            PIC  X(0003).
  1675     05  INV4O PIC  X(0006).
  1676*    -------------------------------
  1677     05  FILLER            PIC  X(0003).
  1678     05  APLID4O PIC  X(0001).
  1679*    -------------------------------
  1680     05  FILLER            PIC  X(0003).
  1681     05  CR4O PIC  X(0014).
  1682*    -------------------------------
  1683     05  FILLER            PIC  X(0003).
  1684     05  DR4O PIC  X(0014).
  1685*    -------------------------------
  1686     05  FILLER            PIC  X(0003).
  1687     05  EOM4O PIC  X(0006).
  1688*    -------------------------------
  1689     05  FILLER            PIC  X(0003).
  1690     05  INDTE4O PIC  X(0006).
  1691*    -------------------------------
  1692     05  FILLER            PIC  X(0003).
  1693     05  CAR5O PIC  X(0001).
  1694*    -------------------------------
  1695     05  FILLER            PIC  X(0003).
  1696     05  GRP5O PIC  X(0006).
  1697*    -------------------------------
  1698     05  FILLER            PIC  X(0003).
  1699     05  FRESP5O PIC  X(0010).
  1700*    -------------------------------
  1701     05  FILLER            PIC  X(0003).
  1702     05  ACTHDG5O PIC  X(0005).
  1703*    -------------------------------
  1704     05  FILLER            PIC  X(0003).
  1705     05  ACCT5O PIC  X(0010).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  TYPE5O PIC  X(0001).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  AMT5O PIC  X(0011).
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
  1714     05  COMM5O PIC  X(0030).
  1715*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6351.cbl
  1716     05  FILLER            PIC  X(0003).
  1717     05  REF5O PIC  X(0012).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  INV5O PIC  X(0006).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  APLID5O PIC  X(0001).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  CR5O PIC  X(0014).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  DR5O PIC  X(0014).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  EOM5O PIC  X(0006).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  INDTE5O PIC  X(0006).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  ERRMSG1O PIC  X(0079).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  ERRMSG2O PIC  X(0079).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  PFENTERO PIC  X(0002).
  1745*    -------------------------------
  1746
  1747 01  MAP-EL635B   REDEFINES  EL635BI.
  1748     12  FILLER                  PIC  X(31).
  1749     12  DATA-AREA       OCCURS  5 TIMES
  1750                             INDEXED BY INDX.
  1751         16  CARR-LEN            PIC S9(4)              COMP.
  1752         16  CARR-ATTRB          PIC  X.
  1753         16  CARRIER             PIC  X.
  1754         16  GRP-LEN             PIC S9(4)              COMP.
  1755         16  GRP-ATTRB           PIC  X.
  1756         16  GROUPING            PIC  X(6).
  1757         16  FIN-LEN             PIC S9(4)              COMP.
  1758         16  FIN-ATTRB           PIC  X.
  1759         16  FIN-RESP            PIC  X(10).
  1760         16  AHDG-LEN            PIC S9(4)              COMP.
  1761         16  AHDG-ATTRB          PIC  X.
  1762         16  AHDG                PIC  X(5).
  1763         16  ACCT-LEN            PIC S9(4)              COMP.
  1764         16  ACCT-ATTRB          PIC  X.
  1765         16  ACCT                PIC  X(10).
  1766         16  RTYPE-LEN           PIC S9(4)              COMP.
  1767         16  RTYPE-ATTRB         PIC  X.
  1768         16  RTYPE               PIC  X.
  1769         16  AMT-LEN             PIC S9(4)              COMP.
  1770         16  AMT-ATTRB           PIC  X.
  1771         16  AMT                 PIC 9(11).
  1772         16  AMTO  REDEFINES
  1773             AMT                 PIC S9(9)V99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6351.cbl
  1774         16  COMM-LEN            PIC S9(4)              COMP.
  1775         16  COMM-ATTRB          PIC  X.
  1776         16  COMM                PIC  X(30).
  1777         16  NCL-COMM  REDEFINES  COMM.
  1778             20  NCL-COMM-DTE.
  1779                 24  NCL-MO      PIC  X(2).
  1780                 24  NCL-DA      PIC  X(2).
  1781                 24  NCL-YR      PIC  X(2).
  1782             20  NCL-COMM-REST   PIC  X(24).
  1783         16  REF-LEN             PIC S9(4)              COMP.
  1784         16  REF-ATTRB           PIC  X.
  1785         16  REF                 PIC  X(12).
  1786         16  INVOICE-LEN         PIC S9(4)              COMP.
  1787         16  INVOICE-ATTRB       PIC  X.
  1788         16  INVOICE             PIC  X(6).
  1789         16  APPLIED-LEN         PIC S9(4)              COMP.
  1790         16  APPLIED-ATTRB       PIC  X.
  1791         16  APPLIED             PIC  X.
  1792         16  CREDIT-LEN          PIC S9(4)              COMP.
  1793         16  CREDIT-ATTRB        PIC  X.
  1794         16  CREDIT              PIC  X(14).
  1795         16  DEBIT-LEN           PIC S9(4)              COMP.
  1796         16  DEBIT-ATTRB         PIC  X.
  1797         16  DEBIT               PIC  X(14).
  1798         16  EOM-DT-LEN          PIC S9(4)              COMP.
  1799         16  EOM-DT-ATTRB        PIC  X.
  1800         16  EOM-DT              PIC X(6).
  1801         16  INDATE-LEN          PIC S9(4)              COMP.
  1802         16  INDATE-ATTRB        PIC  X.
  1803         16  INDATE              PIC X(6).
  1804     12  FILLER                  PIC X(169).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6351.cbl
  1806****************************************************************
  1807*
  1808* Copyright (c) 2007 by Clerity Solutions, Inc.
  1809* All rights reserved.
  1810*
  1811****************************************************************
  1812 01  DFHEIV.
  1813   02  DFHEIV0               PIC X(35).
  1814   02  DFHEIV1               PIC X(08).
  1815   02  DFHEIV2               PIC X(08).
  1816   02  DFHEIV3               PIC X(08).
  1817   02  DFHEIV4               PIC X(06).
  1818   02  DFHEIV5               PIC X(04).
  1819   02  DFHEIV6               PIC X(04).
  1820   02  DFHEIV7               PIC X(02).
  1821   02  DFHEIV8               PIC X(02).
  1822   02  DFHEIV9               PIC X(01).
  1823   02  DFHEIV10              PIC S9(7) COMP-3.
  1824   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1825   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1826   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1827   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1828   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1829   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1830   02  DFHEIV17              PIC X(04).
  1831   02  DFHEIV18              PIC X(04).
  1832   02  DFHEIV19              PIC X(04).
  1833   02  DFHEIV20              USAGE IS POINTER.
  1834   02  DFHEIV21              USAGE IS POINTER.
  1835   02  DFHEIV22              USAGE IS POINTER.
  1836   02  DFHEIV23              USAGE IS POINTER.
  1837   02  DFHEIV24              USAGE IS POINTER.
  1838   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1839   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1840   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1841   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1842   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1843   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1844   02  FILLER                PIC X(02).
  1845   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1846   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1847   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1848   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1849   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1850 LINKAGE  SECTION.
  1851*****************************************************************
  1852*                                                               *
  1853* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1854* All rights reserved.                                          *
  1855*                                                               *
  1856*****************************************************************
  1857 01  dfheiblk.
  1858     02  eibtime          pic s9(7) comp-3.
  1859     02  eibdate          pic s9(7) comp-3.
  1860     02  eibtrnid         pic x(4).
  1861     02  eibtaskn         pic s9(7) comp-3.
  1862     02  eibtrmid         pic x(4).
  1863     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6351.cbl
  1864     02  eibcposn         pic s9(4) comp.
  1865     02  eibcalen         pic s9(4) comp.
  1866     02  eibaid           pic x(1).
  1867     02  eibfiller1       pic x(1).
  1868     02  eibfn            pic x(2).
  1869     02  eibfiller2       pic x(2).
  1870     02  eibrcode         pic x(6).
  1871     02  eibfiller3       pic x(2).
  1872     02  eibds            pic x(8).
  1873     02  eibreqid         pic x(8).
  1874     02  eibrsrce         pic x(8).
  1875     02  eibsync          pic x(1).
  1876     02  eibfree          pic x(1).
  1877     02  eibrecv          pic x(1).
  1878     02  eibsend          pic x(1).
  1879     02  eibatt           pic x(1).
  1880     02  eibeoc           pic x(1).
  1881     02  eibfmh           pic x(1).
  1882     02  eibcompl         pic x(1).
  1883     02  eibsig           pic x(1).
  1884     02  eibconf          pic x(1).
  1885     02  eiberr           pic x(1).
  1886     02  eibrldbk         pic x(1).
  1887     02  eiberrcd         pic x(4).
  1888     02  eibsynrb         pic x(1).
  1889     02  eibnodat         pic x(1).
  1890     02  eibfiller5       pic x(2).
  1891     02  eibresp          pic 9(09) comp.
  1892     02  eibresp2         pic 9(09) comp.
  1893     02  dfheigdj         pic s9(4) comp.
  1894     02  dfheigdk         pic s9(4) comp.
  1895 01  DFHCOMMAREA             PIC  X(1024).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6351.cbl
  1897*01 PARMLIST         COMP.
  1898*    12  FILLER              PIC S9(8).
  1899*    12  ERPYAJ-POINTER      PIC S9(8).
  1900*    12  ERCOMP-POINTER      PIC S9(8).
  1901*    12  ERRECV-POINTER      PIC S9(8).
  1902*    12  MPPRCN-POINTER      PIC S9(8).
  1903
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6351.cbl
  1905*    COPY ERCPYAJ.
  1906******************************************************************
  1907*                                                                *
  1908*                            ERCPYAJ                             *
  1909*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1910*                            VMOD=2.015                          *
  1911*                                                                *
  1912*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  1913*                                                                *
  1914*                                                                *
  1915*   FILE TYPE = VSAM,KSDS                                        *
  1916*   RECORD SIZE = 200  RECFORM = FIXED                           *
  1917*                                                                *
  1918*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  1919*       ALTERNATE PATHS = NONE                                   *
  1920*                                                                *
  1921*   LOG = YES                                                    *
  1922*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1923******************************************************************
  1924******************************************************************
  1925*                   C H A N G E   L O G
  1926*
  1927* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1928*-----------------------------------------------------------------
  1929*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1930* EFFECTIVE    NUMBER
  1931*-----------------------------------------------------------------
  1932* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  1933* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  1934******************************************************************
  1935
  1936 01  PENDING-PAY-ADJ.
  1937     12  PY-RECORD-ID                     PIC XX.
  1938         88  VALID-PY-ID                        VALUE 'PY'.
  1939
  1940     12  PY-CONTROL-PRIMARY.
  1941         16  PY-COMPANY-CD                PIC X.
  1942         16  PY-CARRIER                   PIC X.
  1943         16  PY-GROUPING                  PIC X(6).
  1944         16  PY-FIN-RESP                  PIC X(10).
  1945         16  PY-ACCOUNT                   PIC X(10).
  1946         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  1947                                          PIC X(10).
  1948         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  1949         16  PY-RECORD-TYPE               PIC X.
  1950             88  PY-REMIT-RECEIVED            VALUE 'R'.
  1951             88  PY-DEPOSIT                   VALUE 'D'.
  1952             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  1953             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  1954             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  1955             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  1956             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  1957             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  1958             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  1959             88  PY-FICA-ENTRY                VALUE 'F'.
  1960             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  1961             88  PY-POLICY-FEE                VALUE 'W'.
  1962             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6351.cbl
  1963
  1964     12  PY-PYMT-TYPE                     PIC X.
  1965             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  1966             88  PY-REINS-PYMT                VALUE 'R'.
  1967             88  PY-EXP-PYMT                  VALUE 'E'.
  1968
  1969     12  PY-BIL-INV                       PIC X(6).
  1970     12  PY-REF-NO                        PIC X(12).
  1971
  1972     12  PY-LAST-MAINT-DT                 PIC XX.
  1973     12  PY-LAST-MAINT-BY                 PIC X(4).
  1974     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1975
  1976     12  PY-PYADJ-RECORD.
  1977         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  1978         16  PY-ENTRY-COMMENT             PIC X(30).
  1979         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  1980             20  PY-GL-ACCOUNT            PIC X(10).
  1981             20  PY-GL-STATE              PIC X(02).
  1982             20  PY-GL-CANC-SW            PIC X(01).
  1983                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  1984                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  1985             20  PY-GL-COMMENT            PIC X(10).
  1986             20  FILLER      REDEFINES PY-GL-COMMENT.
  1987                 24  PY-GL-CHECK-NO       PIC 9(06).
  1988                 24  FILLER               PIC X(04).
  1989             20  FILLER                   PIC X(07).
  1990         16  PY-SAVE-ACCOUNT              PIC X(10).
  1991         16  PY-SAVE-TYPE                 PIC X(01).
  1992
  1993         16  PY-LETTERS.
  1994             20  PY-LETTER OCCURS 3 TIMES
  1995                           INDEXED BY PY-LET-NDX
  1996                                          PIC X(04).
  1997
  1998         16  PY-ERCOMP-TYPE               PIC X.
  1999             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  2000             88  PY-GA-TYPE                   VALUE 'G'.
  2001             88  PY-BANK-TYPE                 VALUE 'B'.
  2002         16  FILLER                       PIC X(05).
  2003
  2004     12  PY-RECORD-STATUS.
  2005         16  PY-CREDIT-SELECT-DT          PIC XX.
  2006         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  2007         16  PY-BILLED-DATE               PIC XX.
  2008         16  PY-REPORTED-DT               PIC XX.
  2009         16  PY-PMT-APPLIED               PIC X.
  2010             88  PY-ACCOUNT-PMT               VALUE 'A'.
  2011             88  PY-GA-PMT                    VALUE 'G'.
  2012             88  PY-OVWRITE-PMT               VALUE 'O'.
  2013             88  PY-NON-AR-PMT                VALUE 'N'.
  2014         16  FILLER                       PIC X(5).
  2015         16  PY-INPUT-DT                  PIC XX.
  2016         16  PY-CHECK-NUMBER              PIC X(6).
  2017         16  PY-VOID-SW                   PIC X.
  2018             88  PY-CHECK-VOIDED              VALUE 'V'.
  2019         16  PY-CHECK-ORIGIN-SW           PIC X.
  2020             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6351.cbl
  2021             88  PY-REFUND-CHECK              VALUE 'R'.
  2022             88  PY-GA-CHECK                  VALUE 'G'.
  2023             88  PY-CHECK-WRITTEN             VALUE 'W'.
  2024             88  PY-CHECK-REVERSAL            VALUE 'V'.
  2025         16  PY-CHECK-WRITTEN-DT          PIC XX.
  2026         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  2027         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  2028         16  PY-BILL-FLAG                 PIC X.
  2029             88  PY-BILLED                    VALUE 'B'.
  2030         16  PY-AR-FLAG                   PIC X.
  2031             88  PY-AR-CYCLE                  VALUE 'C'.
  2032             88  PY-AR-MONTH-END              VALUE 'M'.
  2033         16  PY-AR-DATE                   PIC XX.
  2034
  2035     12  PY-GL-CODES.
  2036         16  PY-GL-DB                     PIC X(14).
  2037         16  PY-GL-CR                     PIC X(14).
  2038         16  PY-GL-FLAG                   PIC X.
  2039         16  PY-GL-DATE                   PIC XX.
  2040
  2041     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  2042     12  FILLER                           PIC X(3).
  2043******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6351.cbl
  2045*    COPY ERCCOMP.
  2046******************************************************************
  2047*                                                                *
  2048*                                                                *
  2049*                            ERCCOMP                             *
  2050*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2051*                            VMOD=2.019                          *
  2052*                                                                *
  2053*   ONLINE CREDIT SYSTEM                                         *
  2054*                                                                *
  2055*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  2056*                                                                *
  2057*   FILE TYPE = VSAM,KSDS                                        *
  2058*   RECORD SIZE = 700   RECFORM = FIXED                          *
  2059*                                                                *
  2060*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  2061*       ALTERNATE PATH = NONE                                    *
  2062*                                                                *
  2063*   LOG = NO                                                     *
  2064*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2065*                                                                *
  2066******************************************************************
  2067*                   C H A N G E   L O G
  2068*
  2069* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2070*-----------------------------------------------------------------
  2071*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2072* EFFECTIVE    NUMBER
  2073*-----------------------------------------------------------------
  2074* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2075* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  2076* 092205    2005050300006  PEMA  ADD LEASE FEE
  2077* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  2078* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  2079* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  2080* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2081* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  2082******************************************************************
  2083
  2084 01  COMPENSATION-MASTER.
  2085     12  CO-RECORD-ID                          PIC XX.
  2086         88  VALID-CO-ID                          VALUE 'CO'.
  2087
  2088     12  CO-CONTROL-PRIMARY.
  2089         16  CO-COMPANY-CD                     PIC X.
  2090         16  CO-CONTROL.
  2091             20  CO-CTL-1.
  2092                 24  CO-CARR-GROUP.
  2093                     28  CO-CARRIER            PIC X.
  2094                     28  CO-GROUPING.
  2095                         32  CO-GROUP-PREFIX   PIC XXX.
  2096                         32  CO-GROUP-PRIME    PIC XXX.
  2097                 24  CO-RESP-NO.
  2098                     28  CO-RESP-PREFIX        PIC X(4).
  2099                     28  CO-RESP-PRIME         PIC X(6).
  2100             20  CO-CTL-2.
  2101                 24  CO-ACCOUNT.
  2102                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6351.cbl
  2103                     28  CO-ACCT-PRIME         PIC X(6).
  2104         16  CO-TYPE                           PIC X.
  2105             88  CO-COMPANY-TYPE                  VALUE 'C'.
  2106             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  2107             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  2108
  2109     12  CO-MAINT-INFORMATION.
  2110         16  CO-LAST-MAINT-DT                  PIC XX.
  2111         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  2112         16  CO-LAST-MAINT-USER                PIC X(4).
  2113     12  FILLER                                PIC XX.
  2114     12  CO-STMT-TYPE                          PIC XXX.
  2115     12  CO-COMP-TYPE                          PIC X.
  2116         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  2117     12  CO-STMT-OWNER                         PIC X(4).
  2118     12  CO-BALANCE-CONTROL                    PIC X.
  2119         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  2120         88  CO-NO-BALANCE                        VALUE 'N'.
  2121
  2122     12  CO-INTERNAL-CONTROL-1                 PIC X.
  2123         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  2124         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  2125         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  2126
  2127     12  CO-INTERNAL-CONTROL-2                 PIC X.
  2128         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  2129         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  2130
  2131     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  2132     12  CO-GA-DIRECT-DEP                      PIC X.
  2133     12  CO-FUTURE-SPACE                       PIC X.
  2134         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  2135
  2136     12  CO-ACCT-NAME                          PIC X(30).
  2137     12  CO-MAIL-NAME                          PIC X(30).
  2138     12  CO-ADDR-1                             PIC X(30).
  2139     12  CO-ADDR-2                             PIC X(30).
  2140     12  CO-ADDR-3.
  2141         16  CO-ADDR-CITY                      PIC X(27).
  2142         16  CO-ADDR-STATE                     PIC XX.
  2143     12  CO-CSO-1099                           PIC X.
  2144     12  CO-ZIP.
  2145         16  CO-ZIP-PRIME.
  2146             20  CO-ZIP-PRI-1ST                PIC X.
  2147                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2148             20  FILLER                        PIC X(4).
  2149         16  CO-ZIP-PLUS4                      PIC X(4).
  2150     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  2151         16  CO-CAN-POSTAL-1                   PIC XXX.
  2152         16  CO-CAN-POSTAL-2                   PIC XXX.
  2153         16  FILLER                            PIC XXX.
  2154     12  CO-SOC-SEC                            PIC X(13).
  2155     12  CO-TELEPHONE.
  2156         16  CO-AREA-CODE                      PIC XXX.
  2157         16  CO-PREFIX                         PIC XXX.
  2158         16  CO-PHONE                          PIC X(4).
  2159
  2160     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6351.cbl
  2161
  2162     12  CO-AR-BAL-LEVEL                       PIC X.
  2163         88  CO-AR-REF-LVL                        VALUE '1'.
  2164         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  2165         88  CO-AR-BILL-LVL                       VALUE '2'.
  2166         88  CO-AR-AGT-LVL                        VALUE '3'.
  2167         88  CO-AR-FR-LVL                         VALUE '4'.
  2168
  2169     12  CO-AR-NORMAL-PRINT                    PIC X.
  2170         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  2171         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  2172
  2173     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  2174
  2175     12  CO-AR-REPORTING                       PIC X.
  2176         88  CO-AR-NET-REPORT                     VALUE 'N'.
  2177         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  2178
  2179     12  CO-AR-PULL-CHECK                      PIC X.
  2180         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  2181         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  2182
  2183     12  CO-AR-BALANCE-PRINT                   PIC X.
  2184         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  2185
  2186     12  CO-AR-LAST-RUN-CODE                   PIC X.
  2187         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  2188         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  2189         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  2190
  2191     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  2192
  2193     12  CO-USER-CODE                          PIC X.
  2194     12  CO-REPORT-GROUP-ID                    PIC X(12).
  2195
  2196******************************************************************
  2197*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  2198*    THE LAST MONTH END RUN.
  2199******************************************************************
  2200
  2201     12  CO-LAST-ACTIVITY-DATE.
  2202         16  CO-ACT-YEAR                       PIC 99.
  2203         16  CO-ACT-MONTH                      PIC 99.
  2204         16  CO-ACT-DAY                        PIC 99.
  2205
  2206     12  CO-LAST-STMT-DT.
  2207         16  CO-LAST-STMT-YEAR                 PIC 99.
  2208         16  CO-LAST-STMT-MONTH                PIC 99.
  2209         16  CO-LAST-STMT-DAY                  PIC 99.
  2210
  2211     12  CO-MO-END-TOTALS.
  2212         16  CO-MONTHLY-TOTALS.
  2213             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  2214             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  2215             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  2216             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  2217             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  2218
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6351.cbl
  2219         16  CO-AGING-TOTALS.
  2220             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  2221             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  2222             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  2223             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  2224
  2225         16  CO-YTD-TOTALS.
  2226             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  2227             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  2228
  2229         16  CO-OVER-UNDER-TOTALS.
  2230             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2231             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  2232
  2233     12  CO-MISCELLANEOUS-TOTALS.
  2234         16  CO-FICA-TOTALS.
  2235             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  2236             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  2237
  2238         16  CO-CLAIM-TOTALS.
  2239             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  2240             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  2241
  2242******************************************************************
  2243*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  2244*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  2245******************************************************************
  2246
  2247     12  CO-CURRENT-TOTALS.
  2248         16  CO-CURRENT-LAST-STMT-DT.
  2249             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  2250             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  2251             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  2252
  2253         16  CO-CURRENT-MONTHLY-TOTALS.
  2254             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  2255             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  2256             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  2257             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  2258             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  2259
  2260         16  CO-CURRENT-AGING-TOTALS.
  2261             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  2262             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  2263             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  2264             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  2265
  2266         16  CO-CURRENT-YTD-TOTALS.
  2267             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  2268             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  2269
  2270     12  CO-PAID-COMM-TOTALS.
  2271         16  CO-YTD-PAID-COMMS.
  2272             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  2273             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  2274
  2275     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  2276         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6351.cbl
  2277         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  2278
  2279     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  2280         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  2281         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  2282         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  2283         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  2284         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  2285         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  2286         88  CO-FINAL-LETTER                  VALUE 'F'.
  2287         88  CO-RECONCILING                   VALUE 'R'.
  2288         88  CO-PHONE-CALL                    VALUE 'P'.
  2289         88  CO-LEGAL                         VALUE 'L'.
  2290         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  2291         88  CO-WRITE-OFF                     VALUE 'W'.
  2292         88  CO-NO-ACTION                     VALUE 'N' ' '.
  2293
  2294     12  CO-CSR-CODE                       PIC X(4).
  2295
  2296     12  CO-GA-STATUS-INFO.
  2297         16  CO-GA-EFFECTIVE-DT            PIC XX.
  2298         16  CO-GA-TERMINATION-DT          PIC XX.
  2299         16  CO-GA-STATUS-CODE             PIC X.
  2300             88  CO-GA-ACTIVE                 VALUE 'A'.
  2301             88  CO-GA-INACTIVE               VALUE 'I'.
  2302             88  CO-GA-PENDING                VALUE 'P'.
  2303         16  CO-GA-COMMENTS.
  2304             20  CO-GA-COMMENT-1           PIC X(40).
  2305             20  CO-GA-COMMENT-2           PIC X(40).
  2306             20  CO-GA-COMMENT-3           PIC X(40).
  2307             20  CO-GA-COMMENT-4           PIC X(40).
  2308
  2309     12  CO-RPTCD2                         PIC X(10).
  2310
  2311     12  CO-TYPE-AGENT                     PIC X(01).
  2312         88  CO-CORPORATION                   VALUE 'C'.
  2313         88  CO-PARTNERSHIP                   VALUE 'P'.
  2314         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  2315         88  CO-TRUST                         VALUE 'T'.
  2316         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  2317
  2318     12  CO-FAXNO.
  2319         16  CO-FAX-AREA-CODE                  PIC XXX.
  2320         16  CO-FAX-PREFIX                     PIC XXX.
  2321         16  CO-FAX-PHONE                      PIC X(4).
  2322
  2323     12  CO-BANK-INFORMATION.
  2324         16  CO-BANK-TRANSIT-NO                PIC X(8).
  2325         16  CO-BANK-TRANSIT-NON REDEFINES
  2326             CO-BANK-TRANSIT-NO                PIC 9(8).
  2327
  2328         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  2329     12  CO-MISC-DEDUCT-INFO REDEFINES
  2330                  CO-BANK-INFORMATION.
  2331         16  CO-MD-GL-ACCT                     PIC X(10).
  2332         16  CO-MD-DIV                         PIC XX.
  2333         16  CO-MD-CENTER                      PIC X(4).
  2334         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6351.cbl
  2335         16  CO-CREATE-AP-CHECK                PIC X.
  2336         16  CO-DELIVER-CK-TO-MEL              PIC X.
  2337         16  FILLER                            PIC XXX.
  2338     12  CO-ACH-STATUS                         PIC X.
  2339         88  CO-ACH-ACTIVE                         VALUE 'A'.
  2340         88  CO-ACH-PENDING                        VALUE 'P'.
  2341
  2342     12  CO-BILL-SW                            PIC X.
  2343     12  CO-CONTROL-NAME                       PIC X(30).
  2344     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  2345     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  2346     12  CO-CLP-STATE                          PIC XX.
  2347     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  2348     12  CO-SPP-REFUND-EDIT                    PIC X.
  2349
  2350******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6351.cbl
  2352*    COPY ERCRECV.
  2353******************************************************************
  2354*                                                                *
  2355*                                                                *
  2356*                            ERCRECV.                            *
  2357*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2358*                            VMOD=2.007                          *
  2359*                                                                *
  2360*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE                       *
  2361*                                                                *
  2362*   FILE TYPE = VSAM,KSDS                                        *
  2363*   RECORD SIZE =  300 RECFORM = FIXED                           *
  2364*                                                                *
  2365*   BASE CLUSTER = ERRECV                         RKP=2,LEN=53   *
  2366*       ALTERNATE PATH1 = ERRECV2  (BY CO, CARR, GROUP, AGENT,   *
  2367*                                      EMO-DT, BAL, ENTRY-TYPE,  *
  2368*                                      F.R, INVOICE, REFERENCE,  *
  2369*                                      RESPONSIBILITY, REC TYPE, *
  2370*                                      SEQ. NO.)                 *
  2371*                                                RKP=64 ,LEN=54  *
  2372*   LOG = NO                                                     *
  2373*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2374******************************************************************
  2375
  2376
  2377 01  ACCOUNTS-RECEIVABLE.
  2378     12  AR-RECORD-ID                      PIC XX.
  2379         88  VALID-AR-ID                      VALUE 'AR'.
  2380
  2381     12  AR-CONTROL-PRIMARY.
  2382         16  AR-COMPANY-CD                 PIC X.
  2383         16  AR-TYPE                       PIC X.
  2384             88 AR-NEW-BUSINESS VALUE '1'.
  2385         16  AR-CARRIER                    PIC X.
  2386         16  AR-GROUPING.
  2387             20 AR-GROUPING-PREFIX         PIC XXX.
  2388             20 AR-GROUPING-PRIME          PIC XXX.
  2389         16  AR-BAL-LEVEL                  PIC X.
  2390             88  AR-BAL-LVL-REF               VALUE '1'.
  2391             88  AR-BAL-LVL-BILL-REF          VALUE '1'.
  2392             88  AR-BAL-LVL-BILL              VALUE '2'.
  2393             88  AR-BAL-LVL-AGT-FR            VALUE '3'.
  2394             88  AR-BAL-LVL-FIN-RES           VALUE '4'.
  2395         16  AR-ENTRY-TYPE                 PIC X.
  2396             88  AR-AGENT-ENTRY               VALUE '1'.
  2397             88  AR-GA-ENTRY                  VALUE '2'.
  2398             88  AR-OVWRT-ENTRY               VALUE '3'.
  2399         16  AR-FIN-RES                    PIC X(10).
  2400         16  AR-AGENT-NO                   PIC X(10).
  2401         16  AR-INVOICE-NO                 PIC X(6).
  2402         16  AR-REFERENCE                  PIC X(12).
  2403         16  AR-RESPONSIBILITY             PIC X.
  2404             88  AR-AGENT-RESPONSIBLE         VALUE 'A'.
  2405             88  AR-GA-RESPONSIBLE            VALUE 'G'.
  2406         16  AR-RECORD-TYPE                PIC X.
  2407             88  AR-BALANCE                   VALUE '0'.
  2408             88  AR-PREMIUM                   VALUE '1'.
  2409             88  AR-COMMISSION                VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6351.cbl
  2410             88  AR-PAY-ADJ                   VALUE '3'.
  2411             88  AR-TRANSFER                  VALUE '4'.
  2412             88  AR-WRITE-OFF                 VALUE '5'.
  2413             88  AR-NOTE                      VALUE '6'.
  2414         16  AR-RECORD-SEQ                 PIC S9(4)    COMP.
  2415
  2416     12  FILLER                            PIC X(9).
  2417
  2418     12  AR-ACCOUNT-AGENT-CONTROL.
  2419         16  AR-ACCOUNT-AGENT.
  2420             20  AR-COMPANY-CD-A1          PIC X.
  2421             20  AR-CARRIER-A1             PIC X.
  2422             20  AR-GROUPING-A1            PIC X(6).
  2423             20  AR-AGENT-NO-A1            PIC X(10).
  2424         16  AR-EOM-DT-A1                  PIC XX.
  2425         16  AR-BAL-LEVEL-A1               PIC X.
  2426         16  AR-ENTRY-TYPE-A1              PIC X.
  2427             88  AR-ACCT-AGENT               VALUE '1'.
  2428             88  AR-GEN-AGENT                VALUE '2'.
  2429             88  AR-OVERWRITE-AGENT          VALUE '3'.
  2430         16  AR-FIN-RES-A1                 PIC X(10).
  2431         16  AR-INVOICE-A1                 PIC X(6).
  2432         16  AR-REFERENCE-A1               PIC X(12).
  2433         16  AR-RESPONSIBILITY-A1          PIC X.
  2434             88  AR-AGENT-RESPONSIBLE-A1      VALUE 'A'.
  2435             88  AR-GA-RESPONSIBLE-A1         VALUE 'G'.
  2436         16  AR-RECORD-TYPE-A1             PIC X.
  2437         16  AR-RECORD-SEQ-A1              PIC S9(4)    COMP.
  2438
  2439     12  AR-CONTROL-GA                     PIC X(10).
  2440
  2441     12  AR-LAST-MAINT-DT                  PIC XX.
  2442     12  AR-LAST-MAINT-BY                  PIC X(4).
  2443     12  AR-LST-MAINT-HHMMSS               PIC S9(6)    COMP-3.
  2444     12  AR-MONTH-END-DT                   PIC XX.
  2445     12  FILLER                            PIC X.
  2446     12  AR-REVERSAL-INFO.
  2447         16  AR-REVERSAL-ID                PIC X(4).
  2448         16  AR-REVERSAL-DT                PIC XX.
  2449     12  AR-UPDATE-CODE                    PIC X.
  2450         88  AR-NEW-RECORD                      VALUE 'N'.
  2451         88  AR-UPDATED-RECORD                  VALUE 'U'.
  2452     12  AR-SYSTEM                         PIC X.
  2453         88  AR-MORTGAGE-SYSTEM                 VALUE 'M'.
  2454     12  AR-CSR-TEMP                       PIC X(04).
  2455     12  AR-CARRIER-TEMP                   PIC X(01).
  2456     12  AR-GROUPING-TEMP                  PIC X(06).
  2457     12  FILLER                            PIC X(20).
  2458
  2459     12  AR-RECORD-BODY                    PIC X(120).
  2460
  2461     12  AR-PREM-COMM-RECORD   REDEFINES AR-RECORD-BODY.
  2462         16  AR-P-C-TRAN-DATE              PIC XX.
  2463         16  AR-P-C-STMT-DATE              PIC XX.
  2464         16  AR-P-C-BATCH                  PIC X(6).
  2465         16  AR-P-C-AMOUNT                 PIC S9(7)V99  COMP-3.
  2466         16  AR-P-C-DB-CR                  PIC XX.
  2467             88 AR-P-C-DEBIT                   VALUE 'DB'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6351.cbl
  2468             88 AR-P-C-CREDIT                  VALUE 'CR'.
  2469         16  AR-P-C-DESCRIPTION            PIC X(30).
  2470         16  AR-P-C-REMITTER-CODE          PIC X.
  2471             88 AR-P-C-REMITTER-PAYS           VALUE 'Y'.
  2472             88 AR-P-C-ACCT-AGT-PAYS           VALUE 'Y'.
  2473         16  FILLER                        PIC X(33).
  2474         16  AR-P-C-REMITTER               PIC X(10).
  2475         16  AR-P-C-AMOUNT-LF              PIC S9(7)V99  COMP-3.
  2476         16  AR-P-C-AMOUNT-AH              PIC S9(7)V99  COMP-3.
  2477         16  FILLER                        PIC X(19).
  2478
  2479     12  AR-PAY-ADJ-RECORD  REDEFINES AR-RECORD-BODY.
  2480         16  AR-PA-TRAN-DATE               PIC XX.
  2481         16  AR-PA-STMT-DATE               PIC XX.
  2482         16  FILLER                        PIC X(6).
  2483         16  AR-PA-AMOUNT                  PIC S9(7)V99  COMP-3.
  2484         16  AR-PA-DB-CR                   PIC XX.
  2485             88  AR-PA-DEBIT                   VALUE 'DB'.
  2486             88  AR-PA-CREDIT                  VALUE 'CR'.
  2487         16  AR-PA-SEQ-NO                  PIC S9(8)     COMP.
  2488         16  AR-PA-TYPE                    PIC X.
  2489         16  AR-PA-DEBIT-LEDGER            PIC X(14).
  2490         16  AR-PA-CREDIT-LEDGER           PIC X(14).
  2491         16  AR-PA-COMMENT                 PIC X(30).
  2492         16  AR-PA-REMITTER-CODE           PIC X.
  2493             88 AR-PA-REMITTER-PAYS            VALUE 'Y'.
  2494             88 AR-PA-ACCT-AGT-PAYS            VALUE 'Y'.
  2495         16  AR-PA-REMITTER                PIC X(10).
  2496         16  AR-NOTE-COUNT                 PIC S9(5).
  2497         16  FILLER                        PIC X(24).
  2498
  2499     12  AR-TRANSFER-RECORD REDEFINES AR-RECORD-BODY.
  2500         16  AR-XRF-TRAN-DATE              PIC XX.
  2501         16  AR-XRF-STMT-DATE              PIC XX.
  2502         16  AR-XRF-BATCH                  PIC X(6).
  2503         16  AR-XRF-AMOUNT                 PIC S9(7)V99  COMP-3.
  2504         16  AR-XRF-DB-CR                  PIC XX.
  2505             88  AR-XRF-DEBIT                  VALUE 'DB'.
  2506             88  AR-XRF-CREDIT                 VALUE 'CR'.
  2507         16  AR-BAL-DESCRIPTION            PIC X(30).
  2508         16  AR-XRF-REMITTER-CODE          PIC X.
  2509             88 AR-XRF-REMITTER-PAYS           VALUE 'Y'.
  2510             88 AR-XRF-ACCT-AGT-PAYS           VALUE 'Y'.
  2511         16  FILLER                        PIC X(33).
  2512         16  AR-XRF-REMITTER               PIC X(10).
  2513         16  FILLER                        PIC X(29).
  2514
  2515     12  AR-BALANCE-RECORD REDEFINES AR-RECORD-BODY.
  2516         16  AR-FST-TRAN-DATE              PIC XX.
  2517         16  AR-LST-TRAN-DATE              PIC XX.
  2518         16  FILLER                        PIC X(6).
  2519         16  AR-BAL-AMOUNT                 PIC S9(7)V99  COMP-3.
  2520         16  AR-BAL-DB-CR                  PIC XX.
  2521             88  AR-BAL-DEBIT                  VALUE 'DB'.
  2522             88  AR-BAL-CREDIT                 VALUE 'CR'.
  2523         16  AR-BAL-DESCRIPTION            PIC X(30).
  2524         16  FILLER                        PIC X(73).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6351.cbl
  2526*    COPY MPCPRCN.
  2527******************************************************************
  2528*                                                                *
  2529*                            MPCPRCN                             *
  2530*                            VMOD=1.014                          *
  2531*                                                                *
  2532*   FILE DESCRIPTION = PAYMENT RECONCILIATION                    *
  2533*   (ANY CHANGES MADE TO THIS COPYBOOK MUST ALSO BE MADE         *
  2534*   TO MPCPEXT)                                                  *
  2535*                                                                *
  2536*   FILE TYPE = VSAM,KSDS                                        *
  2537*   RECORD SIZE = 835  RECFORM = FIXED                           *
  2538*                                                                *
  2539*   BASE CLUSTER = MPPRCN (SEE NOTE ABOVE)          RKP=2,LEN=11 *
  2540*   ALTERNATE PATH2= MPPRCN2(PRODUCER BILLING SEQU)RKP=33,LEN=44 *
  2541*   ALTERNATE PATH3= MPPRCN3(POLICY PRIMARY CNTL  )RKP=97,LEN=46 *
  2542*   ALTERNATE PATH4= MPPRCN4(BY RECORD TYPE CNTL  )RKP=163,LEN=46*
  2543*                                                                *
  2544*   LOG = YES                                                    *
  2545*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2546******************************************************************
  2547
  2548 01  PAYMENT-RECONCILIATION.
  2549     12  PR-RECORD-ID                      PIC XX.
  2550         88  VALID-PR-ID                      VALUE 'PR'.
  2551
  2552******************************************************************
  2553*   BASE CLUSTER = MPPRCN         (BASE KEY)      RKP=2,LEN=11   *
  2554******************************************************************
  2555
  2556     12  PR-CONTROL-PRIMARY.
  2557         16  PR-COMPANY-CD                 PIC X.
  2558         16  PR-INVOICE-NUMBER.
  2559             20  PR-INVOICE-YMD.
  2560                 24  PR-INVOICE-YR         PIC X.
  2561                 24  PR-INVOICE-MO         PIC X.
  2562                 24  PR-INVOICE-DAY        PIC X.
  2563             20  PR-INVOICE-SEQU           PIC X(3).
  2564                 88  PR-INDIVIDUAL-BILL       VALUE 'AAA'.
  2565         16  PR-RECORD-SEQU                PIC S9(7)     COMP-3.
  2566             88  PR-INVOICE-HEADER            VALUE +9999999.
  2567     12  FILLER                            PIC X(20).
  2568
  2569******************************************************************
  2570* ALTERNATE PATH2 = MPPRCN2(PRODUCER BILLING SEQU)RKP=33,LEN=44  *
  2571******************************************************************
  2572
  2573     12  PR-CONTROL-BY-PRODUCER.
  2574         16  PR-COMPANY-CD-A2              PIC X.
  2575         16  PR-CARRIER-A2                 PIC X.
  2576         16  PR-GROUPING-A2.
  2577             20  PR-GROUPING-PREFIX-A2     PIC X(3).
  2578             20  PR-GROUPING-PRIME-A2      PIC X(3).
  2579         16  PR-STATE-A2                   PIC XX.
  2580         16  PR-PRODUCER-A2.
  2581             20  PR-PRODUCER-PREFIX-A2     PIC X(4).
  2582             20  PR-PRODUCER-PRIME-A2      PIC X(6).
  2583         16  PR-PRODUCER-BILLING-SEQU-A2   PIC X(20).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6351.cbl
  2584         16  PR-CURRENT-DATE-BIN-A2        PIC X(02).
  2585         16  PR-UNIQUE-KEY-A2              PIC S9(04) COMP.
  2586     12  FILLER                            PIC X(20).
  2587
  2588******************************************************************
  2589*  ALTERNATE PATH3 = MPPRCN3(POLICY CONTROL SEQU)RKP=97,LEN=46   *
  2590******************************************************************
  2591
  2592     12  PR-CONTROL-BY-POLICY.
  2593         16  PR-COMPANY-CD-A3              PIC X.
  2594         16  PR-POLICY-NO-A3.
  2595             20  PR-POLICY-PRIME-A3        PIC X(18).
  2596             20  PR-POLICY-SFX-A3          PIC XX.
  2597         16  PR-POLICY-CNTL-PARTIAL.
  2598             20  PR-CARRIER-A3             PIC X.
  2599             20  PR-GROUPING-A3.
  2600                 24  PR-GROUPING-PREFIX-A3 PIC X(3).
  2601                 24  PR-GROUPING-PRIME-A3  PIC X(3).
  2602             20  PR-STATE-A3               PIC XX.
  2603             20  PR-PRODUCER-A3.
  2604                 24  PR-PRODUCER-PREFIX-A3 PIC X(4).
  2605                 24  PR-PRODUCER-PRIME-A3  PIC X(6).
  2606             20  PR-POLICY-EFF-DT-A3       PIC XX.
  2607         16  PR-CURRENT-DATE-BIN-A3        PIC X(02).
  2608         16  PR-UNIQUE-KEY-A3              PIC S9(04) COMP.
  2609     12  FILLER                            PIC X(20).
  2610
  2611******************************************************************
  2612*  ALTERNATE PATH4 = MPPRCN4(RECON RECORD TYPE  )RKP=163 LEN=25  *
  2613******************************************************************
  2614
  2615     12  PR-CONTROL-BY-RECORD-TYPE.
  2616         16  PR-COMPANY-CD-A4              PIC X.
  2617         16  PR-RECORD-TYPE-A4             PIC X.
  2618             88  PR-HEADER-RECORD              VALUE '1'.
  2619             88  PR-DETAIL-RECORD              VALUE '2'.
  2620         16  PR-CARRIER-A4                 PIC X.
  2621         16  PR-GROUPING-A4.
  2622             20  PR-GROUPING-PREFIX-A4     PIC X(3).
  2623             20  PR-GROUPING-PRIME-A4      PIC X(3).
  2624         16  PR-STATE-A4                   PIC XX.
  2625         16  PR-PRODUCER-A4.
  2626             20  PR-PRODUCER-PREFIX-A4     PIC X(4).
  2627             20  PR-PRODUCER-PRIME-A4      PIC X(6).
  2628         16  PR-CURRENT-DATE-BIN-A4        PIC X(02).
  2629         16  PR-UNIQUE-KEY-A4              PIC S9(04) COMP.
  2630     12  FILLER                            PIC X(20).
  2631
  2632******************************************************************
  2633*                 FILE SYNCHRONIZATION DATA                      *
  2634******************************************************************
  2635
  2636     12  PR-FILE-SYNCH-DATA.
  2637         16  PR-LAST-CHANGE-DT             PIC XX.
  2638         16  PR-LAST-CHANGE-TIME           PIC S9(7)     COMP-3.
  2639         16  PR-LAST-CHANGE-PROCESSOR      PIC X(4).
  2640         16  PR-SECURITY-ACCESS-CODE       PIC X.
  2641     12  FILLER                            PIC X(16).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6351.cbl
  2642
  2643******************************************************************
  2644*              PREMIUM RECONCILIATION RECORD BODY                *
  2645******************************************************************
  2646
  2647     12  PR-RECORD-BODY                    PIC X(600).
  2648
  2649******************************************************************
  2650*             PREMIUM RECONCILIATION BATCH HEADER                *
  2651******************************************************************
  2652
  2653     12  PR-BATCH-HEADER  REDEFINES  PR-RECORD-BODY.
  2654         16  PR-POSTING-DATA.
  2655             20  PR-POSTING-DT             PIC XX.
  2656             20  PR-POSTING-TIME           PIC S9(7)      COMP-3.
  2657             20  PR-POSTING-PROCESSOR      PIC X(4).
  2658         16  PR-SUMMARY-DATA.
  2659             20  PR-DOCU-COUNTS.
  2660                 24  PR-ACTUAL-DOCU-CNT    PIC S9(5)      COMP-3.
  2661                 24  PR-EXPECTED-DOCU-CNT  PIC S9(5)      COMP-3.
  2662             20  PR-PREMIUM-AMTS.
  2663                 24  PR-RECEIVED-PREMIUM   PIC S9(7)V99   COMP-3.
  2664                 24  PR-ACTUAL-PREMIUM     PIC S9(7)V99   COMP-3.
  2665                 24  PR-EXPECTED-PREMIUM   PIC S9(7)V99   COMP-3.
  2666             20  PR-COMPENSATION-AMTS.
  2667                 24  PR-PROD-EXPECTED-COM  PIC S9(7)V99   COMP-3.
  2668                 24  PR-PROD-ACTUAL-COM    PIC S9(7)V99   COMP-3.
  2669                 24  PR-OVRWT-EXPECTED-COM PIC S9(7)V99   COMP-3.
  2670                 24  PR-OVRWT-ACTUAL-COM   PIC S9(7)V99   COMP-3.
  2671                 24  PR-REMIT-EXPECTED-COM PIC S9(7)V99   COMP-3.
  2672                 24  PR-REMIT-ACTUAL-COM   PIC S9(7)V99   COMP-3.
  2673         16  PR-HDR-BILLING-SEQUENCE       PIC X(01).
  2674             88  PR-HDR-BILL-NAME-SEQU        VALUE '1'.
  2675             88  PR-HDR-BILL-LOAN-SEQU        VALUE '2'.
  2676             88  PR-HDR-BILL-PLCY-SEQU        VALUE '3'.
  2677         16  PR-HDR-BILLING-DT             PIC XX.
  2678         16  PR-HDR-BILL-TO-DT             PIC XX.
  2679         16  PR-HDR-POSTING-STATUS         PIC X.
  2680             88  PR-HDR-NEEDS-EDITING         VALUE '0'.
  2681             88  PR-HDR-EDITED                VALUE '1'.
  2682             88  PR-HDR-OK-TO-POST            VALUE '2'.
  2683             88  PR-HDR-POSTED                VALUE '3'.
  2684             88  PR-HDR-REVERSED              VALUE '4'.
  2685             88  PR-HDR-POSTING               VALUE '5'.
  2686         16  PR-RECEIVED-DT                PIC XX.
  2687         16  PR-RESPONSIBLE-AGENT          PIC X(10).
  2688         16  PR-PAC-INFORMATION.
  2689             20  PR-HDR-BANK-TRANSIT-NUMBER.
  2690                 24  PR-HDR-FEDERAL-NUMBER PIC X(4).
  2691                 24  PR-HDR-BANK-NUMBER    PIC X(4).
  2692             20  PR-HDR-BANK-ACCOUNT-NUMBER
  2693                                           PIC X(20).
  2694             20  PR-SIGNATURE-NAME         PIC X(25).
  2695
  2696******************************************************************
  2697*         HEADER  AGENT AND COMMISSION DATA                      *
  2698******************************************************************
  2699
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6351.cbl
  2700         16  PR-HDR-1STYR-RENEW-SW           PIC X.
  2701             88  PR-HDR-1STYR-COMMISSIONS            VALUE '1'.
  2702             88  PR-HDR-RENEW-COMMISSIONS            VALUE '2'.
  2703             88  PR-HDR-CROSS-BOUNDRIES              VALUE '3'.
  2704         16  PR-HDR-COMMISSION-DATA.
  2705             20  PR-HDR-REMIT-TO             PIC S9(3) COMP-3.
  2706             20  PR-HDR-COMM-CHANGE-SW       PIC X.
  2707                 88  PR-HDR-COMMISSION-CHANGE         VALUE 'Y'.
  2708             20  PR-HDR-AGENT-INFORMATION   OCCURS   5 TIMES.
  2709                 24  PR-HDR-AGENT-NUMBER     PIC X(10).
  2710                 24  PR-HDR-AGENT-TYPE       PIC X.
  2711                     88  PR-HDR-AGENT-GROSS           VALUE 'C'.
  2712                     88  PR-HDR-AGENT-REINS           VALUE 'R'.
  2713                     88  PR-HDR-AGENT-GROSS-REINS     VALUE 'D'.
  2714                     88  PR-HDR-OVERWRITE-GROSS       VALUE 'O'.
  2715                     88  PR-HDR-OVERWRITE-GROSS-REINS
  2716                                                      VALUE 'P'.
  2717                     88  PR-HDR-OVERWRITE-REINS       VALUE 'T'.
  2718                     88  PR-HDR-REINS-ONLY            VALUE 'W'.
  2719                 24  PR-HDR-COMMISSION-BILL-PAID PIC X(1).
  2720                     88  PR-HDR-GENERATE-BILL         VALUE 'B'.
  2721                     88  PR-HDR-GENERATE-PAID         VALUE 'P'.
  2722                 24  PR-HDR-AGENT-COMP-1ST-YEAR  PIC S99V999.
  2723                 24  PR-HDR-COMP-1ST-YEAR-TYPE   PIC X(1).
  2724                     88  PR-HDR-COMP-1ST-YEAR-PERCENT
  2725                                                  VALUE '1'.
  2726                     88  PR-HDR-COMP-1ST-YEAR-DOLLARS
  2727                                                  VALUE '2'.
  2728                     88  PR-HDR-COMP-1ST-YEAR-NOT-USED
  2729                                                  VALUE '3'.
  2730                 24  PR-HDR-RENEW-DATA  OCCURS 6 TIMES.
  2731                     28  PR-HDR-RENEW-MONTHS PIC S999    COMP-3.
  2732                     28  PR-HDR-RENEW-COMM   PIC S99V999 COMP-3.
  2733                     28  PR-HDR-RENEW-TYPE   PIC X(1).
  2734                         88  PR-HDR-COMP-RENEW-PERCENT
  2735                                                        VALUE '1'.
  2736                         88  PR-HDR-COMP-RENEW-DOLLARS
  2737                                                        VALUE '2'.
  2738                         88  PR-HDR-COMP-RENEW-NOT-USED
  2739                                                        VALUE '3'.
  2740                 24  PR-HDR-COMP-RECALC-FLAG     PIC X(1).
  2741                     88  PR-HDR-BYPASS-RECALC          VALUE 'N'.
  2742         16  FILLER                        PIC X(189).
  2743
  2744******************************************************************
  2745*                PREMIUM RECONCILIATION DETAIL                   *
  2746******************************************************************
  2747
  2748     12  PR-RECON-DETAIL  REDEFINES  PR-RECORD-BODY.
  2749         16  PR-TRANSACTION-TYPE           PIC X.
  2750             88  PR-BILL                      VALUE '1'.
  2751             88  PR-CANCEL                    VALUE '2'.
  2752             88  PR-PYMT-REVERSAL             VALUE '3'.
  2753             88  PR-BILL-REVERSAL             VALUE '4'.
  2754             88  PR-PAID-IN-ADVANCE           VALUE '5'.
  2755             88  PR-AR-BILL-REVERSAL          VALUE '6'.
  2756         16  PR-POSTING-STATUS             PIC X.
  2757             88  PR-NEEDS-EDITING             VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6351.cbl
  2758             88  PR-EDITED                    VALUE 'E'.
  2759             88  PR-POSTED                    VALUE 'P'.
  2760             88  PR-FORCE-TO-POST             VALUE 'F'.
  2761             88  PR-DELETED                   VALUE 'D'.
  2762             88  PR-REVERSED                  VALUE 'R'.
  2763         16  PR-POLICY-STATUS              PIC X.
  2764             88  PR-P-ACTIVE                  VALUE  '1'.
  2765             88  PR-P-LAPSE                   VALUE  '0'.
  2766             88  PR-P-CLAIM-APPLIED           VALUE  '6'.
  2767             88  PR-P-CANCEL                  VALUE  '7'.
  2768             88  PR-BILLABLE                  VALUES '0' '1' '6'.
  2769         16  PR-PYMT-REVERSAL-DT           PIC XX.
  2770         16  PR-INSURED-NAME.
  2771             20  PR-INSURED-FIRST-NAME.
  2772                 24  PR-INSURED-1ST-INIT   PIC X.
  2773                 24  FILLER                PIC X(9).
  2774             20  PR-INSURED-MIDDLE-INITIAL PIC X.
  2775             20  PR-INSURED-LAST-NAME      PIC X(15).
  2776         16  PR-LOAN-NUMBER                PIC X(20).
  2777         16  PR-PLAN-CODE                  PIC X(02).
  2778         16  PR-PLAN-REVISION              PIC X(03).
  2779         16  PR-INS-MONTH-PREMIUM          PIC S9(5)V9(6) COMP-3.
  2780         16  PR-BILLING-INFORMATION.
  2781             20  PR-BILLING-TYPE           PIC X.
  2782                 88  PR-LIST-BILL             VALUE '1'.
  2783                 88  PR-TAPE-BILL             VALUE '2'.
  2784                 88  PR-TAPE-LIST-BILL        VALUE '3'.
  2785                 88  PR-GROUP-BILL         VALUES ARE '1' '2' '3'.
  2786                 88  PR-DIRECT-BILL           VALUE '4'.
  2787                 88  PR-PAC-BILL         VALUES ARE '5' 'C' 'S'.
  2788                 88  PR-CHARGE-CARD-BILL      VALUE '6'.
  2789                 88  PR-PAC-REFUND            VALUE 'D'.
  2790                 88  PR-CHARGE-CARD-REFUND    VALUE 'E'.
  2791                 88  PR-INDIV-BILL
  2792                     VALUES ARE '4' '5' '6' 'C' 'S'.
  2793                 88  PR-EFT-CHECKING          VALUE 'C'.
  2794                 88  PR-EFT-SAVINGS           VALUE 'S'.
  2795             20  PR-BILLING-SEQUENCE       PIC X(01).
  2796                 88  PR-BILL-NAME-SEQU        VALUE '1'.
  2797                 88  PR-BILL-LOAN-SEQU        VALUE '2'.
  2798                 88  PR-BILL-PLCY-SEQU        VALUE '3'.
  2799             20  PR-BILLING-MODE           PIC X(01).
  2800                 88  PR-ANNUAL                VALUE '1'.
  2801                 88  PR-SEMI-ANNUAL           VALUE '2'.
  2802                 88  PR-QUARTERLY             VALUE '3'.
  2803                 88  PR-MONTHLY               VALUE '4'.
  2804                 88  PR-BI-MONTHLY            VALUE '5'.
  2805                 88  PR-SINGLE-PREM           VALUE '6'.
  2806             20  PR-MONTHS-BILLED          PIC S9(03)     COMP-3.
  2807             20  PR-BILLED-AMT             PIC S9(5)V99   COMP-3.
  2808             20  PR-BILLED-TO-DT           PIC XX.
  2809             20  PR-BILLING-DT             PIC XX.
  2810             20  PR-BILLING-SW             PIC X.
  2811                 88  PR-FIRST-BILLING         VALUE 'Y'.
  2812                 88  PR-PLCY-PAID-IN-ADVANCE  VALUE 'A'.
  2813             20  PR-BANK-TRANSIT-NUMBER.
  2814                 24  PR-FEDERAL-NUMBER     PIC X(4).
  2815                 24  PR-BANK-NUMBER        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6351.cbl
  2816             20  PR-BANK-ACCOUNT-NUMBER    PIC X(20).
  2817             20  PR-CHARGE-CARD-TYPE       PIC X(2).
  2818                 88  PR-VISA                  VALUE 'VI'.
  2819                 88  PR-MSTR-CARD             VALUE 'MC'.
  2820                 88  PR-DINERS-CLUB           VALUE 'DN'.
  2821                 88  PR-DISCOVER              VALUE 'DS'.
  2822                 88  PR-CARTE-BLANCHE         VALUE 'CB'.
  2823                 88  PR-AMERICAN-EXPRESS      VALUE 'AE'.
  2824             20  PR-CHARGE-CARD-EXP-DT     PIC X(2).
  2825             20  PR-LOAN-OFFICER           PIC X(5).
  2826             20  PR-BILLING-GROUPING-CODE  PIC X(6).
  2827         16  PR-BILLING-RECONCILE-DATA.
  2828             20  PR-EXPECTED-DATA.
  2829                 24  PR-EXPECTED-PAYMENT   PIC S9(5)V99   COMP-3.
  2830                 24  PR-EXPECTED-TO-DT     PIC XX.
  2831             20  PR-EXP-COMPENSATION-DATA.
  2832                 24  PR-EXP-PROD-LVL-COMP  PIC S9(5)V99   COMP-3.
  2833                 24  PR-EXP-OVWR-LVL-COMP  PIC S9(5)V99   COMP-3.
  2834                 24  PR-EXP-REMT-LVL-COMP  PIC S9(5)V99   COMP-3.
  2835             20  PR-ENTERED-DATA.
  2836                 24  PR-ENTERED-PAYMENT    PIC S9(5)V99   COMP-3.
  2837                 24  PR-ENTERED-OVSH       PIC S9(5)V99   COMP-3.
  2838                 24  PR-ENTERED-TO-DT      PIC XX.
  2839                 24  PR-ENTERED-SOURCE     PIC X.
  2840                     88  PR-BILLING-PGM       VALUE 'B'.
  2841                     88  PR-OPERATOR          VALUE 'O'.
  2842                     88  PR-PAYMENT-PGM       VALUE 'P'.
  2843             20  PR-ENT-COMPENSATION-DATA.
  2844                 24  PR-ENT-PROD-LVL-COMP  PIC S9(5)V99   COMP-3.
  2845                 24  PR-ENT-OVWR-LVL-COMP  PIC S9(5)V99   COMP-3.
  2846                 24  PR-ENT-REMT-LVL-COMP  PIC S9(5)V99   COMP-3.
  2847         16  PR-PAYMENT-TYPE               PIC X.
  2848             88  PR-CHECK                     VALUE 'C'.
  2849             88  PR-MONEY-ORDER               VALUE 'M'.
  2850         16  PR-CHECK-NUMBER               PIC X(5).
  2851         16  PR-PREVIOUS-PAYMENT-DATA.
  2852             20  PR-PREV-INVOICE-NUMBER    PIC X(6).
  2853             20  PR-PREV-LAST-PYMT-DT      PIC XX.
  2854             20  PR-PREV-PAID-TO-DT        PIC XX.
  2855             20  PR-PREV-PAYMENT-AMT       PIC S9(5)V99  COMP-3.
  2856             20  PR-PREV-OVER-SHORT-AMT    PIC S9(5)V99  COMP-3.
  2857             20  PR-PREV-TOTAL-PREM-RECVD  PIC S9(7)V99  COMP-3.
  2858             20  PR-PREV-MONTHS-PAID       PIC S9(3)     COMP-3.
  2859         16  PR-PREVIOUS-BILLING-DATA.
  2860             20  PR-PREV-LAST-BILL-DT      PIC XX.
  2861             20  PR-PREV-BILL-TO-DT        PIC XX.
  2862             20  PR-PREV-LAST-BILL-AMT     PIC S9(5)V99  COMP-3.
  2863             20  PR-PREV-BILLING-SW        PIC X.
  2864             20  PR-PREV-EXIT-DT           PIC XX.
  2865             20  PR-PREV-LAST-LAPSE-DT     PIC XX.
  2866         16  PR-MONTH-END-DT               PIC XX.
  2867         16  PR-PLAN-TYPE                  PIC X.
  2868             88  PR-AH-MORT-PLAN              VALUE 'A'.
  2869             88  PR-AD-D-MORT-PLAN            VALUE 'E'.
  2870             88  PR-DISMEM-MORT-PLAN          VALUE 'D'.
  2871             88  PR-LIFE-MORT-PLAN            VALUE 'L'.
  2872         16  PR-EXPECTED-TAX               PIC S9(5)V99   COMP-3.
  2873         16  PR-BILL-DAY                   PIC S99        COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6351.cbl
  2874         16  FILLER                        PIC X(14).
  2875
  2876******************************************************************
  2877*                 AGENT AND COMMISSION DATA                      *
  2878******************************************************************
  2879
  2880         16  PR-1STYR-RENEW-SW               PIC X.
  2881             88  PR-1STYR-COMMISSIONS         VALUE '1'.
  2882             88  PR-RENEW-COMMISSIONS         VALUE '2'.
  2883             88  PR-CROSS-BOUNDRIES           VALUE '3'.
  2884         16  PR-COMMISSION-DATA.
  2885             20  PR-REMIT-TO                 PIC S9(3) COMP-3.
  2886             20  PR-COMM-CHANGE-SW           PIC X.
  2887                 88  PR-COMMISSION-CHANGE         VALUE 'Y'.
  2888             20  PR-AGENT-INFORMATION   OCCURS   5 TIMES.
  2889                 24  PR-AGENT-NUMBER         PIC X(10).
  2890                 24  PR-AGENT-TYPE           PIC X.
  2891                     88  PR-AGENT-GROSS           VALUE 'C'.
  2892                     88  PR-AGENT-REINS           VALUE 'R'.
  2893                     88  PR-AGENT-GROSS-REINS     VALUE 'D'.
  2894                     88  PR-OVERWRITE-GROSS       VALUE 'O'.
  2895                     88  PR-OVERWRITE-GROSS-REINS VALUE 'P'.
  2896                     88  PR-OVERWRITE-REINS       VALUE 'T'.
  2897                     88  PR-REINS-ONLY            VALUE 'W'.
  2898                 24  PR-COMMISSION-BILL-PAID PIC X(1).
  2899                     88  PR-GENERATE-BILL         VALUE 'B'.
  2900                     88  PR-GENERATE-PAID         VALUE 'P'.
  2901                 24  PR-AGENT-COMP-1ST-YEAR  PIC S99V999.
  2902                 24  PR-COMP-1ST-YEAR-TYPE   PIC X(1).
  2903                     88  PR-COMP-1ST-YEAR-PERCENT   VALUE '1'.
  2904                     88  PR-COMP-1ST-YEAR-DOLLARS   VALUE '2'.
  2905                     88  PR-COMP-1ST-YEAR-NOT-USED  VALUE '3'.
  2906                 24  PR-RENEW-DATA OCCURS 6 TIMES.
  2907                     28  PR-RENEW-MONTHS      PIC S999    COMP-3.
  2908                     28  PR-RESNEW-COMMISSION
  2909                                              PIC S99V999 COMP-3.
  2910                     28  PR-COMP-RENEW-TYPE   PIC X(1).
  2911                         88  PR-COMP-RENEW-PERCENT      VALUE '1'.
  2912                         88  PR-COMP-RENEW-DOLLARS      VALUE '2'.
  2913                         88  PR-COMP-RENEW-NOT-USED     VALUE '3'.
  2914                 24  PR-COMP-RECALC-FLAG     PIC X(1).
  2915                     88  PR-BYPASS-RECALC         VALUE 'N'.
  2916         16  FILLER                        PIC X(94).
  2917
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6351.cbl
  2919 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PENDING-PAY-ADJ
  2920                          COMPENSATION-MASTER
  2921                          ACCOUNTS-RECEIVABLE
  2922                          PAYMENT-RECONCILIATION.
  2923 0000-DFHEXIT SECTION.
  2924     MOVE '9#                    $   ' TO DFHEIV0.
  2925     MOVE 'EL6351' TO DFHEIV1.
  2926     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2927
  2928     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  2929     MOVE 2                      TO  EMI-NUMBER-OF-LINES.
  2930
  2931     IF EIBCALEN = ZERO
  2932         GO TO 8800-UNAUTHORIZED-ACCESS.
  2933
  2934     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  2935     MOVE '5'                    TO  DC-OPTION-CODE.
  2936
  2937     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  2938
  2939     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT.
  2940     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT.
  2941     MOVE DC-GREG-DATE-1-MDY     TO  WS-CURRENT-MDY.
  2942
  2943     IF MORTGAGE-SESSION
  2944        MOVE XCTL-EM626           TO XCTL-EL626
  2945        MOVE MPPYAJ-FILE-ID       TO PYAJ-FILE-ID.
  2946
  2947     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2948         MOVE  'Y'                TO  PI-SEQ-FIRST-TIME-SW
  2949         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2950             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  2951             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  2952             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  2953             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  2954             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  2955             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  2956             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  2957             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  2958         ELSE
  2959             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  2960             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  2961             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  2962             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  2963             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  2964             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  2965             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  2966             MOVE SPACES                TO  PI-SAVED-PROGRAM-6.
  2967
  2968     IF PI-SEQ-FIRST-TIME-SW    =   'Y'
  2969         MOVE ZEROS               TO  PI-FILE-SEQ-NO (1)
  2970         MOVE ZEROS               TO  PI-FILE-SEQ-NO (2)
  2971         MOVE ZEROS               TO  PI-FILE-SEQ-NO (3)
  2972         MOVE ZEROS               TO  PI-FILE-SEQ-NO (4)
  2973         MOVE ZEROS               TO  PI-FILE-SEQ-NO (5)
  2974         MOVE 'N'                 TO  PI-SEQ-FIRST-TIME-SW.
  2975
  2976     MOVE LOW-VALUES             TO  EL635BI.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6351.cbl
  2977
  2978     COMPUTE WORK-SEQ-NO  =  EIBTIME  *  10.
  2979
  2980     IF EIBTRNID NOT = TRANS-ID
  2981         MOVE SPACE              TO  PI-PYAJ-FILE-SW
  2982         GO TO 8100-SEND-INITIAL-MAP.
  2983
  2984
  2985* EXEC CICS HANDLE CONDITION
  2986*        PGMIDERR  (9600-PGMID-ERROR)
  2987*        ERROR     (9990-ABEND)
  2988*        END-EXEC.
  2989*    MOVE '"$L.                  ! " #00002980' TO DFHEIV0
  2990     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2991     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2992     MOVE X'2220233030303032393830' TO DFHEIV0(25:11)
  2993     CALL 'kxdfhei1' USING DFHEIV0
  2994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2995
  2996
  2997     IF EIBAID = DFHCLEAR
  2998         GO TO 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6351.cbl
  3000 0200-RECEIVE.
  3001     IF EIBAID = DFHPA1              OR  DFHPA2  OR  DFHPA3
  3002         MOVE ER-0008            TO  EMI-ERROR
  3003         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3004         MOVE -1                 TO  PFENTERL
  3005         GO TO 8200-SEND-DATAONLY.
  3006
  3007
  3008* EXEC CICS RECEIVE
  3009*        MAP     (MAP-NAME)
  3010*        MAPSET  (MAPSET-NAME)
  3011*        INTO    (EL635BI)
  3012*        END-EXEC.
  3013     MOVE LENGTH OF
  3014      EL635BI
  3015       TO DFHEIV11
  3016*    MOVE '8"T I  L              ''   #00002995' TO DFHEIV0
  3017     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3018     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3019     MOVE X'2020233030303032393935' TO DFHEIV0(25:11)
  3020     CALL 'kxdfhei1' USING DFHEIV0,
  3021           MAP-NAME,
  3022           EL635BI,
  3023           DFHEIV11,
  3024           MAPSET-NAME,
  3025           DFHEIV99,
  3026           DFHEIV99
  3027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3028
  3029
  3030     IF PFENTERL = ZERO
  3031         GO TO 0300-CHECK-PFKEYS.
  3032
  3033     IF (PFENTERI  IS NUMERIC)
  3034       AND (PFENTERI  IS GREATER THAN  ZERO
  3035       AND  IS LESS THAN  25)
  3036         MOVE PF-VALUES (PFENTERI)  TO  EIBAID
  3037     ELSE
  3038         MOVE ER-0029               TO  EMI-ERROR
  3039         GO TO 0320-INPUT-ERROR.
  3040
  3041 0300-CHECK-PFKEYS.
  3042     IF EIBAID = DFHPF23
  3043         GO TO 8810-PF23.
  3044
  3045     IF EIBAID = DFHPF24
  3046         GO TO 9200-RETURN-MAIN-MENU.
  3047
  3048     IF EIBAID = DFHPF12
  3049         GO TO 9500-PF12.
  3050
  3051     IF EIBAID = DFHENTER
  3052         MOVE SPACES             TO  WS-ACCEPT
  3053         MOVE SPACES             TO  WS-PREV-PF5
  3054         GO TO 1000-EDIT-DATA.
  3055
  3056     IF EIBAID = DFHPF5
  3057         MOVE PI-ACCEPT          TO  WS-ACCEPT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6351.cbl
  3058         GO TO 1000-EDIT-DATA.
  3059
  3060 0320-INPUT-ERROR.
  3061     MOVE ER-0029                TO  EMI-ERROR.
  3062
  3063     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3064
  3065     MOVE AL-UNBON               TO  PFENTERA.
  3066
  3067     IF PFENTERL = ZERO
  3068         MOVE -1                 TO  PFENTERL
  3069     ELSE
  3070         MOVE -1                 TO  PFENTERL.
  3071
  3072     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6351.cbl
  3074 1000-EDIT-DATA.
  3075
  3076     IF NOT MODIFY-CAP
  3077         MOVE 'UPDATE'       TO SM-READ
  3078         PERFORM 9995-SECURITY-VIOLATION
  3079         MOVE ER-0070        TO EMI-ERROR
  3080         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3081         GO TO 8100-SEND-INITIAL-MAP.
  3082
  3083     MOVE PI-COMPANY-CD          TO  PI-SAV-COMP-CD
  3084                                     COMP-COMP-CD.
  3085     SET INDX                    TO  1.
  3086     MOVE 'ACCEPT'               TO  PI-ACCEPT-DESC.
  3087     MOVE ZEROS                  TO  WS-EOM-DT (1)  WS-INP-DT (1)
  3088                                     WS-EOM-DT (2)  WS-INP-DT (2)
  3089                                     WS-EOM-DT (3)  WS-INP-DT (3)
  3090                                     WS-EOM-DT (4)  WS-INP-DT (4)
  3091                                     WS-EOM-DT (5)  WS-INP-DT (5).
  3092
  3093 1010-EDIT-LOOP.
  3094
  3095     IF CARR-LEN        (INDX) = ZEROS
  3096        AND GRP-LEN     (INDX) = ZEROS
  3097        AND FIN-LEN     (INDX) = ZEROS
  3098        AND ACCT-LEN    (INDX) = ZEROS
  3099        AND COMM-LEN    (INDX) = ZEROS
  3100        AND RTYPE-LEN   (INDX) = ZEROS
  3101        AND AMT-LEN     (INDX) = ZEROS
  3102        AND APPLIED-LEN (INDX) = ZEROS
  3103        AND INVOICE-LEN (INDX) = ZEROS
  3104        AND EOM-DT-LEN  (INDX) = ZEROS
  3105        AND INDATE-LEN  (INDX) = ZEROS
  3106         NEXT SENTENCE
  3107     ELSE
  3108         GO TO 1010-EDIT-PROCESS.
  3109
  3110     IF EIBAID = DFHPF5
  3111         GO TO 1010-EDIT-PROCESS.
  3112
  3113     IF WS-PREV-PF5 = 'Y' AND
  3114         CARRIER    (INDX) NOT = LOW-VALUES AND
  3115         GROUPING   (INDX) NOT = LOW-VALUES AND
  3116         FIN-RESP   (INDX) NOT = LOW-VALUES AND
  3117         ACCT       (INDX) NOT = LOW-VALUES AND
  3118         RTYPE      (INDX) NOT = LOW-VALUES AND
  3119         AMT        (INDX) NOT = LOW-VALUES AND
  3120         COMM       (INDX) NOT = LOW-VALUES AND
  3121         APPLIED    (INDX) NOT = LOW-VALUES AND
  3122         INVOICE    (INDX) NOT = LOW-VALUES AND
  3123         REF        (INDX) NOT = LOW-VALUES
  3124          MOVE 'N'                TO  WS-PREV-PF5
  3125          GO TO 1010-EDIT-PROCESS.
  3126
  3127     GO TO 1060-INCREMENT-INDX.
  3128
  3129 1010-EDIT-PROCESS.
  3130
  3131**************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6351.cbl
  3132*                                                            *
  3133*    THE COMPENSATION CONTROL IS NOT REQUIRED FOR SPECIAL    *
  3134*    GROUPING PROCESS IF THE TYPE IS 'G' AND AN INVOICE      *
  3135*    IS ENTERED.                                             *
  3136*                                                            *
  3137**************************************************************
  3138
  3139     IF MORTGAGE-SESSION
  3140        IF RTYPE            (INDX) = 'G'
  3141           IF CARR-LEN      (INDX) GREATER THAN +0
  3142              OR  GRP-LEN   (INDX) GREATER THAN +0
  3143              OR  FIN-LEN   (INDX) GREATER THAN +0
  3144              OR  ACCT-LEN  (INDX) GREATER THAN +0
  3145                 MOVE ER-9179        TO  EMI-ERROR
  3146                 MOVE -1             TO  CARR-LEN   (INDX)
  3147                 MOVE AL-UABON       TO  CARR-ATTRB (INDX)
  3148                                         FIN-ATTRB  (INDX)
  3149                                         GRP-ATTRB  (INDX)
  3150                                         ACCT-ATTRB (INDX)
  3151                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3152                 GO TO 1040-CONTINUE-EDIT
  3153           ELSE
  3154              GO TO 1040-CONTINUE-EDIT
  3155        ELSE
  3156           NEXT SENTENCE.
  3157
  3158     IF CARR-LEN (INDX) NOT = ZEROS
  3159         MOVE AL-UANON           TO  CARR-ATTRB (INDX)
  3160         MOVE CARRIER (INDX)     TO  COMP-CARRIER
  3161                                     PI-SAV-CARRIER
  3162         IF CARRIER (INDX) NOT = ZEROS
  3163           AND (PI-ZERO-CARRIER  OR  PI-ZERO-CAR-GROUP)
  3164             MOVE ER-2587        TO  EMI-ERROR
  3165             MOVE -1             TO  CARR-LEN (INDX)
  3166             MOVE AL-UABON       TO  CARR-ATTRB (INDX)
  3167             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3168         ELSE
  3169             NEXT SENTENCE
  3170     ELSE
  3171         MOVE ER-0194            TO  EMI-ERROR
  3172         MOVE -1                 TO  CARR-LEN (INDX)
  3173         MOVE AL-UABON           TO  CARR-ATTRB (INDX)
  3174         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3175
  3176     IF GRP-LEN (INDX) NOT = ZEROS
  3177         MOVE AL-UANON           TO  GRP-ATTRB (INDX)
  3178         MOVE GROUPING (INDX)    TO  COMP-GROUPING
  3179                                     PI-SAV-GROUPING
  3180         IF GROUPING (INDX) NOT = ZEROS
  3181           AND (PI-ZERO-GROUPING  OR  PI-ZERO-CAR-GROUP)
  3182             MOVE ER-2588        TO  EMI-ERROR
  3183             MOVE -1             TO  GRP-LEN (INDX)
  3184             MOVE AL-UABON       TO  GRP-ATTRB (INDX)
  3185             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3186         ELSE
  3187             NEXT SENTENCE
  3188     ELSE
  3189         MOVE ER-0195            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6351.cbl
  3190         MOVE -1                 TO  GRP-LEN (INDX)
  3191         MOVE AL-UABON           TO  GRP-ATTRB (INDX)
  3192         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3193
  3194     IF FIN-LEN (INDX) NOT = ZEROS
  3195         MOVE AL-UANON           TO  FIN-ATTRB (INDX)
  3196         MOVE FIN-RESP (INDX)    TO  COMP-FIN-RESP
  3197                                     PI-SAV-FIN-RESP
  3198                                     PI-CR-FIN-RESP
  3199     ELSE
  3200         MOVE ER-2562            TO  EMI-ERROR
  3201         MOVE -1                 TO  FIN-LEN (INDX)
  3202         MOVE AL-UABON           TO  FIN-ATTRB (INDX)
  3203         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3204
  3205     IF ACCT-LEN (INDX) NOT = ZEROS
  3206         MOVE AL-UANON           TO  ACCT-ATTRB (INDX)
  3207         MOVE ACCT (INDX)        TO  COMP-ACCOUNT
  3208                                     PI-SAV-ACCOUNT
  3209     ELSE
  3210         MOVE +1                 TO  ACCT-LEN (INDX)
  3211         MOVE LOW-VALUES         TO  COMP-ACCOUNT
  3212                                     ACCT (INDX)
  3213                                     PI-SAV-ACCOUNT.
  3214
  3215     MOVE 'A'                    TO  COMP-RECORD-TYPE.
  3216
  3217     IF ACCT (INDX) = LOW-VALUES
  3218         IF APPLIED (INDX) NOT = 'G' AND 'O'
  3219             MOVE ER-3183        TO  EMI-ERROR
  3220             MOVE -1             TO  APPLIED-LEN (INDX)
  3221             MOVE AL-UABON       TO  APPLIED-ATTRB(INDX)
  3222             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3223             GO TO 1040-CONTINUE-EDIT
  3224         ELSE
  3225             GO TO 1030-VERIFY-GA-ONLY.
  3226
  3227     IF ACCT (INDX) = FIN-RESP (INDX)
  3228         IF APPLIED (INDX) = 'A'
  3229             GO TO 1015-VERIFY-ACCT-RESP
  3230         ELSE
  3231         IF APPLIED-LEN (INDX) = ZERO
  3232             MOVE 'A'            TO  APPLIED (INDX)
  3233             MOVE +1             TO  APPLIED-ATTRB (INDX)
  3234             GO TO 1015-VERIFY-ACCT-RESP
  3235         ELSE
  3236             IF PI-COMPANY-ID = 'NCL'
  3237                 IF APPLIED (INDX) = 'G'
  3238                     GO TO 1015-VERIFY-ACCT-RESP
  3239                 ELSE
  3240                     MOVE ER-3184
  3241                                 TO  EMI-ERROR
  3242                     MOVE -1     TO  APPLIED-LEN (INDX)
  3243                     MOVE AL-UABON
  3244                                 TO  APPLIED-ATTRB(INDX)
  3245                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3246                     GO TO 1040-CONTINUE-EDIT
  3247             ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6351.cbl
  3248                 MOVE ER-3184    TO  EMI-ERROR
  3249                 MOVE -1         TO  APPLIED-LEN (INDX)
  3250                 MOVE AL-UABON   TO  APPLIED-ATTRB(INDX)
  3251                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3252                 GO TO 1040-CONTINUE-EDIT.
  3253
  3254     IF APPLIED (INDX) = 'G'
  3255         GO TO 1020-VERIFY-RESP-GA.
  3256
  3257     IF APPLIED (INDX) = 'O'
  3258         GO TO 1030-VERIFY-GA-ONLY.
  3259
  3260
  3261* EXEC CICS GETMAIN
  3262*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3263*        LENGTH   (ERCOMP-RECORD-LENGTH)
  3264*        INITIMG  (GETMAIN-SPACE)
  3265*        END-EXEC.
  3266*    MOVE ',"IL                  $   #00003231' TO DFHEIV0
  3267     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3268     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3269     MOVE X'2020233030303033323331' TO DFHEIV0(25:11)
  3270     CALL 'kxdfhei1' USING DFHEIV0,
  3271           DFHEIV20,
  3272           ERCOMP-RECORD-LENGTH,
  3273           GETMAIN-SPACE
  3274     SET ADDRESS OF COMPENSATION-MASTER TO
  3275         DFHEIV20
  3276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3277
  3278
  3279
  3280* EXEC CICS HANDLE CONDITION
  3281*        NOTFND   (1015-NO-COMP-MSTR)
  3282*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3283*        END-EXEC.
  3284*    MOVE '"$IJ                  ! # #00003237' TO DFHEIV0
  3285     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3286     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3287     MOVE X'2320233030303033323337' TO DFHEIV0(25:11)
  3288     CALL 'kxdfhei1' USING DFHEIV0
  3289     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3290
  3291
  3292
  3293* EXEC CICS READ
  3294*        DATASET  (COMP-FILE-ID)
  3295*        INTO     (COMPENSATION-MASTER)
  3296*        RIDFLD   (ERCOMP-KEY)
  3297*        END-EXEC.
  3298     MOVE LENGTH OF
  3299      COMPENSATION-MASTER
  3300       TO DFHEIV11
  3301*    MOVE '&"IL       E          (   #00003242' TO DFHEIV0
  3302     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3303     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3304     MOVE X'2020233030303033323432' TO DFHEIV0(25:11)
  3305     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL6351.cbl
  3306           COMP-FILE-ID,
  3307           COMPENSATION-MASTER,
  3308           DFHEIV11,
  3309           ERCOMP-KEY,
  3310           DFHEIV99,
  3311           DFHEIV99,
  3312           DFHEIV99
  3313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3314
  3315
  3316     IF RTYPE (INDX) = 'R' OR 'D' OR 'S' OR 'T' OR 'Z'
  3317           MOVE 'G'              TO  APPLIED (INDX)
  3318        ELSE
  3319           MOVE 'A'              TO  APPLIED (INDX).
  3320
  3321     MOVE +1                     TO  APPLIED-LEN (INDX).
  3322     GO TO 1020-VERIFY-RESP-GA.
  3323
  3324 1012-NO-COMP-MSTR.
  3325     MOVE 'O'                    TO  APPLIED (INDX).
  3326     MOVE +1                     TO  APPLIED-LEN (INDX).
  3327     GO TO 1030-VERIFY-GA-ONLY.
  3328
  3329 1015-VERIFY-ACCT-RESP.
  3330
  3331
  3332* EXEC CICS GETMAIN
  3333*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3334*        LENGTH   (ERCOMP-RECORD-LENGTH)
  3335*        INITIMG  (GETMAIN-SPACE)
  3336*        END-EXEC.
  3337*    MOVE ',"IL                  $   #00003263' TO DFHEIV0
  3338     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3339     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3340     MOVE X'2020233030303033323633' TO DFHEIV0(25:11)
  3341     CALL 'kxdfhei1' USING DFHEIV0,
  3342           DFHEIV20,
  3343           ERCOMP-RECORD-LENGTH,
  3344           GETMAIN-SPACE
  3345     SET ADDRESS OF COMPENSATION-MASTER TO
  3346         DFHEIV20
  3347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3348
  3349
  3350
  3351* EXEC CICS HANDLE CONDITION
  3352*        NOTFND   (1015-NO-COMP-MSTR)
  3353*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3354*        END-EXEC.
  3355*    MOVE '"$IJ                  ! $ #00003269' TO DFHEIV0
  3356     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3357     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3358     MOVE X'2420233030303033323639' TO DFHEIV0(25:11)
  3359     CALL 'kxdfhei1' USING DFHEIV0
  3360     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3361
  3362
  3363
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL6351.cbl
  3364* EXEC CICS READ
  3365*        DATASET  (COMP-FILE-ID)
  3366*        INTO     (COMPENSATION-MASTER)
  3367*        RIDFLD   (ERCOMP-KEY)
  3368*        END-EXEC.
  3369     MOVE LENGTH OF
  3370      COMPENSATION-MASTER
  3371       TO DFHEIV11
  3372*    MOVE '&"IL       E          (   #00003274' TO DFHEIV0
  3373     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3374     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3375     MOVE X'2020233030303033323734' TO DFHEIV0(25:11)
  3376     CALL 'kxdfhei1' USING DFHEIV0,
  3377           COMP-FILE-ID,
  3378           COMPENSATION-MASTER,
  3379           DFHEIV11,
  3380           ERCOMP-KEY,
  3381           DFHEIV99,
  3382           DFHEIV99,
  3383           DFHEIV99
  3384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3385
  3386
  3387     MOVE CO-AR-BAL-LEVEL        TO  PI-SAVE-COMP-BAL-CODE.
  3388
  3389     GO TO 1040-CONTINUE-EDIT.
  3390
  3391 1015-NO-COMP-MSTR.
  3392
  3393     MOVE ER-3178                TO  EMI-ERROR
  3394     MOVE -1                     TO  CARR-LEN (INDX)
  3395     MOVE AL-UABON               TO  CARR-ATTRB (INDX)
  3396                                     GRP-ATTRB (INDX)
  3397                                     FIN-ATTRB (INDX)
  3398                                     ACCT-ATTRB (INDX).
  3399     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3400     GO TO 1040-CONTINUE-EDIT.
  3401
  3402 1020-VERIFY-RESP-GA.
  3403
  3404
  3405* EXEC CICS GETMAIN
  3406*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3407*        LENGTH   (ERCOMP-RECORD-LENGTH)
  3408*        INITIMG  (GETMAIN-SPACE)
  3409*        END-EXEC.
  3410*    MOVE ',"IL                  $   #00003297' TO DFHEIV0
  3411     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3412     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3413     MOVE X'2020233030303033323937' TO DFHEIV0(25:11)
  3414     CALL 'kxdfhei1' USING DFHEIV0,
  3415           DFHEIV20,
  3416           ERCOMP-RECORD-LENGTH,
  3417           GETMAIN-SPACE
  3418     SET ADDRESS OF COMPENSATION-MASTER TO
  3419         DFHEIV20
  3420     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3421
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL6351.cbl
  3422
  3423
  3424* EXEC CICS HANDLE CONDITION
  3425*        NOTFND   (1015-NO-COMP-MSTR)
  3426*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3427*        END-EXEC.
  3428*    MOVE '"$IJ                  ! % #00003303' TO DFHEIV0
  3429     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3430     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3431     MOVE X'2520233030303033333033' TO DFHEIV0(25:11)
  3432     CALL 'kxdfhei1' USING DFHEIV0
  3433     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3434
  3435
  3436
  3437* EXEC CICS READ
  3438*        DATASET  (COMP-FILE-ID)
  3439*        INTO     (COMPENSATION-MASTER)
  3440*        RIDFLD   (ERCOMP-KEY)
  3441*        END-EXEC.
  3442     MOVE LENGTH OF
  3443      COMPENSATION-MASTER
  3444       TO DFHEIV11
  3445*    MOVE '&"IL       E          (   #00003308' TO DFHEIV0
  3446     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3447     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3448     MOVE X'2020233030303033333038' TO DFHEIV0(25:11)
  3449     CALL 'kxdfhei1' USING DFHEIV0,
  3450           COMP-FILE-ID,
  3451           COMPENSATION-MASTER,
  3452           DFHEIV11,
  3453           ERCOMP-KEY,
  3454           DFHEIV99,
  3455           DFHEIV99,
  3456           DFHEIV99
  3457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3458
  3459
  3460     MOVE CO-AR-BAL-LEVEL        TO  PI-SAVE-COMP-BAL-CODE.
  3461
  3462     MOVE LOW-VALUES             TO  COMP-ACCOUNT.
  3463     MOVE 'G'                    TO  COMP-RECORD-TYPE.
  3464
  3465
  3466* EXEC CICS GETMAIN
  3467*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3468*        LENGTH   (ERCOMP-RECORD-LENGTH)
  3469*        INITIMG  (GETMAIN-SPACE)
  3470*        END-EXEC.
  3471*    MOVE ',"IL                  $   #00003319' TO DFHEIV0
  3472     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3473     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3474     MOVE X'2020233030303033333139' TO DFHEIV0(25:11)
  3475     CALL 'kxdfhei1' USING DFHEIV0,
  3476           DFHEIV20,
  3477           ERCOMP-RECORD-LENGTH,
  3478           GETMAIN-SPACE
  3479     SET ADDRESS OF COMPENSATION-MASTER TO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL6351.cbl
  3480         DFHEIV20
  3481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3482
  3483
  3484
  3485* EXEC CICS HANDLE CONDITION
  3486*        NOTFND   (1015-NO-COMP-MSTR)
  3487*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3488*        END-EXEC.
  3489*    MOVE '"$IJ                  ! & #00003325' TO DFHEIV0
  3490     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3491     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3492     MOVE X'2620233030303033333235' TO DFHEIV0(25:11)
  3493     CALL 'kxdfhei1' USING DFHEIV0
  3494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3495
  3496
  3497
  3498* EXEC CICS READ
  3499*        DATASET  (COMP-FILE-ID)
  3500*        INTO     (COMPENSATION-MASTER)
  3501*        RIDFLD   (ERCOMP-KEY)
  3502*        END-EXEC.
  3503     MOVE LENGTH OF
  3504      COMPENSATION-MASTER
  3505       TO DFHEIV11
  3506*    MOVE '&"IL       E          (   #00003330' TO DFHEIV0
  3507     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3508     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3509     MOVE X'2020233030303033333330' TO DFHEIV0(25:11)
  3510     CALL 'kxdfhei1' USING DFHEIV0,
  3511           COMP-FILE-ID,
  3512           COMPENSATION-MASTER,
  3513           DFHEIV11,
  3514           ERCOMP-KEY,
  3515           DFHEIV99,
  3516           DFHEIV99,
  3517           DFHEIV99
  3518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3519
  3520
  3521     GO TO 1040-CONTINUE-EDIT.
  3522
  3523 1020-NO-COMP-MSTR.
  3524
  3525     IF COMP-RECORD-TYPE = 'A'
  3526         MOVE ER-3178            TO  EMI-ERROR
  3527     ELSE
  3528         MOVE ER-3179            TO  EMI-ERROR.
  3529
  3530     MOVE -1                     TO  CARR-LEN (INDX)
  3531     MOVE AL-UABON               TO  CARR-ATTRB (INDX)
  3532                                     GRP-ATTRB (INDX)
  3533                                     FIN-ATTRB (INDX)
  3534                                     ACCT-ATTRB (INDX).
  3535     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3536     GO TO 1040-CONTINUE-EDIT.
  3537
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL6351.cbl
  3538 1030-VERIFY-GA-ONLY.
  3539
  3540     MOVE 'G'                    TO  COMP-RECORD-TYPE.
  3541     MOVE LOW-VALUES             TO  COMP-ACCOUNT.
  3542
  3543
  3544* EXEC CICS GETMAIN
  3545*        SET      (ADDRESS OF COMPENSATION-MASTER)
  3546*        LENGTH   (ERCOMP-RECORD-LENGTH)
  3547*        INITIMG  (GETMAIN-SPACE)
  3548*        END-EXEC.
  3549*    MOVE ',"IL                  $   #00003358' TO DFHEIV0
  3550     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  3551     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3552     MOVE X'2020233030303033333538' TO DFHEIV0(25:11)
  3553     CALL 'kxdfhei1' USING DFHEIV0,
  3554           DFHEIV20,
  3555           ERCOMP-RECORD-LENGTH,
  3556           GETMAIN-SPACE
  3557     SET ADDRESS OF COMPENSATION-MASTER TO
  3558         DFHEIV20
  3559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3560
  3561
  3562
  3563* EXEC CICS HANDLE CONDITION
  3564*        NOTFND   (1015-NO-COMP-MSTR)
  3565*        NOTOPEN  (7100-COMP-FILE-NOTOPEN)
  3566*        END-EXEC.
  3567*    MOVE '"$IJ                  ! '' #00003364' TO DFHEIV0
  3568     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3569     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3570     MOVE X'2720233030303033333634' TO DFHEIV0(25:11)
  3571     CALL 'kxdfhei1' USING DFHEIV0
  3572     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3573
  3574
  3575
  3576* EXEC CICS READ
  3577*        DATASET  (COMP-FILE-ID)
  3578*        INTO     (COMPENSATION-MASTER)
  3579*        RIDFLD   (ERCOMP-KEY)
  3580*        END-EXEC.
  3581     MOVE LENGTH OF
  3582      COMPENSATION-MASTER
  3583       TO DFHEIV11
  3584*    MOVE '&"IL       E          (   #00003369' TO DFHEIV0
  3585     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  3586     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3587     MOVE X'2020233030303033333639' TO DFHEIV0(25:11)
  3588     CALL 'kxdfhei1' USING DFHEIV0,
  3589           COMP-FILE-ID,
  3590           COMPENSATION-MASTER,
  3591           DFHEIV11,
  3592           ERCOMP-KEY,
  3593           DFHEIV99,
  3594           DFHEIV99,
  3595           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL6351.cbl
  3596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3597
  3598
  3599     MOVE CO-AR-BAL-LEVEL        TO  PI-SAVE-COMP-BAL-CODE.
  3600
  3601     GO TO 1040-CONTINUE-EDIT.
  3602
  3603 1030-NO-COMP-MSTR.
  3604
  3605     MOVE ER-3179                TO  EMI-ERROR.
  3606     MOVE -1                     TO  CARR-LEN (INDX)
  3607     MOVE AL-UABON               TO  CARR-ATTRB (INDX)
  3608                                     GRP-ATTRB (INDX)
  3609                                     FIN-ATTRB (INDX)
  3610                                     ACCT-ATTRB (INDX).
  3611     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3612     GO TO 1040-CONTINUE-EDIT.
  3613
  3614 1040-CONTINUE-EDIT.
  3615
  3616     IF COMM-LEN (INDX) NOT = ZEROS
  3617         MOVE AL-UANON           TO  COMM-ATTRB (INDX)
  3618         IF PI-COMPANY-ID NOT = 'NCL'
  3619             NEXT SENTENCE
  3620         ELSE
  3621             IF NCL-COMM-DTE (INDX) IS NUMERIC
  3622                 MOVE NCL-COMM-DTE (INDX)
  3623                                 TO  DC-GREG-DATE-1-MDY
  3624                 MOVE '4'        TO  DC-OPTION-CODE
  3625                 PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT
  3626                 IF NO-CONVERSION-ERROR
  3627                     NEXT SENTENCE
  3628                 ELSE
  3629                     MOVE ER-2595
  3630                                 TO  EMI-ERROR
  3631                     MOVE -1     TO  COMM-LEN (INDX)
  3632                     MOVE AL-UABON
  3633                                 TO  COMM-ATTRB (INDX)
  3634                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3635             ELSE
  3636                 IF NCL-COMM-DTE (INDX) = SPACES OR LOW-VALUES
  3637                     MOVE WS-CURRENT-MDY
  3638                                 TO  NCL-COMM-DTE (INDX)
  3639                 ELSE
  3640                     MOVE COMM (INDX)
  3641                                 TO  WS-COMMENT-FULL
  3642                     MOVE WS-COMMENT-24-POS
  3643                                 TO  NCL-COMM-REST (INDX)
  3644                     MOVE WS-CURRENT-MDY
  3645                                 TO  NCL-COMM-DTE (INDX)
  3646     ELSE
  3647         IF PI-COMPANY-ID = 'NCL'
  3648           AND PI-FILE-SEQ-NO (NDX) = ZEROS
  3649             MOVE +6             TO  COMM-LEN (INDX)
  3650             MOVE WS-CURRENT-MDY TO  NCL-COMM-DTE (INDX).
  3651
  3652
  3653     IF RTYPE-LEN (INDX) NOT = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL6351.cbl
  3654         MOVE RTYPE (INDX)       TO  CHECK-REC-TYPE
  3655         IF PI-COMPANY-ID = 'MON'
  3656             IF NOT MON-VALID-REC-TYPE
  3657                 MOVE -1         TO  RTYPE-LEN (INDX)
  3658                 MOVE ER-7806    TO  EMI-ERROR
  3659                 MOVE AL-UABON   TO  RTYPE-ATTRB (INDX)
  3660                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3661             ELSE
  3662                 MOVE AL-UANON   TO  RTYPE-ATTRB (INDX)
  3663         ELSE
  3664             IF PI-COMPANY-ID = 'NCL'
  3665                 IF NOT NCL-VALID-REC-TYPE
  3666                     MOVE -1     TO  RTYPE-LEN (INDX)
  3667                     MOVE ER-7806
  3668                                 TO  EMI-ERROR
  3669                     MOVE AL-UABON
  3670                                 TO  RTYPE-ATTRB (INDX)
  3671                     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3672                 ELSE
  3673                     MOVE AL-UANON
  3674                                 TO  RTYPE-ATTRB (INDX)
  3675             ELSE
  3676                 IF PI-COMPANY-ID = 'ANL'
  3677                     IF NOT ANL-VALID-REC-TYPE
  3678                         MOVE -1 TO  RTYPE-LEN (INDX)
  3679                         MOVE ER-7806
  3680                                 TO  EMI-ERROR
  3681                         MOVE AL-UABON
  3682                                 TO  RTYPE-ATTRB (INDX)
  3683                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3684                     ELSE
  3685                         MOVE AL-UANON
  3686                                 TO  RTYPE-ATTRB (INDX)
  3687                 ELSE
  3688                     IF NOT VALID-REC-TYPE
  3689                         MOVE -1 TO  RTYPE-LEN (INDX)
  3690                         MOVE ER-2234
  3691                                 TO  EMI-ERROR
  3692                         MOVE AL-UABON
  3693                                 TO  RTYPE-ATTRB (INDX)
  3694                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3695                     ELSE
  3696                         MOVE AL-UANON
  3697                                 TO  RTYPE-ATTRB (INDX)
  3698     ELSE
  3699         MOVE -1                 TO  RTYPE-LEN (INDX)
  3700         MOVE ER-2235            TO  EMI-ERROR
  3701         MOVE AL-UABON           TO  RTYPE-ATTRB (INDX)
  3702         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3703
  3704     IF AMT-LEN (INDX) NOT = ZEROS
  3705         MOVE AL-UNNON           TO  AMT-ATTRB (INDX)
  3706
  3707* EXEC CICS BIF DEEDIT
  3708*            FIELD   (AMTO (INDX))
  3709*            LENGTH  (11)
  3710*        END-EXEC
  3711     MOVE 11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL6351.cbl
  3712       TO DFHEIV11
  3713*    MOVE '@"L                   #   #00003482' TO DFHEIV0
  3714     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3715     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3716     MOVE X'2020233030303033343832' TO DFHEIV0(25:11)
  3717     CALL 'kxdfhei1' USING DFHEIV0,
  3718           AMTO(INDX),
  3719           DFHEIV11
  3720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3721         IF AMTO (INDX) = ZEROS
  3722             MOVE ER-2245        TO  EMI-ERROR
  3723             MOVE -1             TO  AMT-LEN(INDX)
  3724             MOVE AL-UNBON       TO  AMT-ATTRB (INDX)
  3725             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3726         ELSE
  3727             SET WS-INDX          TO INDX
  3728             MOVE AMTO (INDX)    TO WS-EDITED-AMT (WS-INDX)
  3729     ELSE
  3730         MOVE -1                 TO  AMT-LEN (INDX)
  3731         MOVE ER-2236            TO  EMI-ERROR
  3732         MOVE AL-UNBON           TO  AMT-ATTRB (INDX)
  3733         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3734
  3735     IF APPLIED-LEN (INDX) NOT = ZEROS
  3736        IF APPLIED  (INDX) = 'A' OR 'G' OR 'O'
  3737           NEXT SENTENCE
  3738        ELSE
  3739           MOVE -1               TO APPLIED-LEN   (INDX)
  3740           MOVE ER-3146          TO EMI-ERROR
  3741           MOVE AL-UABON         TO APPLIED-ATTRB (INDX)
  3742           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3743
  3744****************************************************************
  3745**   THIS CODE EDITS THE MONTH END DATE. DATE MUT BE VALID, AN
  3746**   EOM DAY, AND NOT MORE THAN TWO MONTHS PASSED THE CREDIT
  3747**   EOM DATE
  3748****************************************************************
  3749
  3750     IF EOM-DT-LEN (INDX)  =  ZEROS
  3751         GO TO 1040-CHECK-INPUT-DATE.
  3752
  3753     MOVE AL-UNNON               TO  EOM-DT-ATTRB (INDX).
  3754
  3755     MOVE EOM-DT (INDX)    TO  DEEDIT-FIELD.
  3756     PERFORM 8600-DEEDIT.
  3757
  3758     IF DEEDIT-FIELD-V0  NOT NUMERIC
  3759        GO TO 1040-DAY-ERROR.
  3760
  3761     MOVE DEEDIT-FIELD-V0      TO  DC-GREG-DATE-1-MDY.
  3762     MOVE '4'                  TO  DC-OPTION-CODE.
  3763     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3764
  3765     IF DATE-CONVERSION-ERROR
  3766        GO TO 1040-DAY-ERROR
  3767     ELSE
  3768        SET MINDEX             TO  INDX
  3769        MOVE DC-BIN-DATE-1     TO  WS-EOM-DT (MINDEX).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL6351.cbl
  3770
  3771     MOVE DEEDIT-FIELD-V0      TO  DATE-TEST-AREA.
  3772
  3773     IF DATE-TEST-MM    =  4 OR 6 OR 9 OR 11
  3774        IF DATE-TEST-DD  =  30
  3775           GO TO 1040-CHECK-FUTURE-MO
  3776        ELSE
  3777           GO TO 1040-DAY-ERROR.
  3778
  3779     IF DATE-TEST-MM   = 1 OR 3 OR 5 OR 7 OR 8 OR 10 OR 12
  3780        IF DATE-TEST-DD  =  31
  3781           GO TO 1040-CHECK-FUTURE-MO
  3782        ELSE
  3783           GO TO 1040-DAY-ERROR.
  3784
  3785     DIVIDE DATE-TEST-YY  BY  4  GIVING  DIVIDE-RESULT
  3786        REMAINDER  DIVIDE-REMAINDER.
  3787
  3788     IF (DATE-TEST-YY  =  ZERO)  OR
  3789        (DIVIDE-REMAINDER  NOT =  ZERO)
  3790        IF DATE-TEST-DD  NOT =  28
  3791            GO TO 1040-DAY-ERROR
  3792        ELSE
  3793            GO TO 1040-CHECK-FUTURE-MO
  3794     ELSE
  3795        IF DATE-TEST-DD  =  29
  3796            GO TO 1040-CHECK-FUTURE-MO.
  3797
  3798 1040-CHECK-FUTURE-MO.
  3799
  3800     IF WS-EOM-DT (MINDEX) NOT GREATER THAN PI-CR-MONTH-END-DT
  3801         GO TO 1040-CHECK-INPUT-DATE.
  3802
  3803     MOVE PI-CR-MONTH-END-DT  TO  DC-BIN-DATE-1.
  3804     MOVE WS-EOM-DT (MINDEX)  TO  DC-BIN-DATE-2.
  3805     MOVE '1'                 TO  DC-OPTION-CODE.
  3806     PERFORM 8500-DATE-CONVERT  THRU  8500-EXIT.
  3807
  3808     IF DATE-CONVERSION-ERROR
  3809         GO TO 1040-DAY-ERROR.
  3810
  3811     IF DC-ELAPSED-MONTHS  GREATER THAN +2
  3812         MOVE -1        TO  EOM-DT-LEN (INDX)
  3813         MOVE AL-UNBON  TO  EOM-DT-ATTRB (INDX)
  3814         MOVE ER-0761   TO  EMI-ERROR
  3815         PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3816
  3817     GO TO 1040-CHECK-INPUT-DATE.
  3818
  3819 1040-DAY-ERROR.
  3820
  3821     MOVE -1                    TO  EOM-DT-LEN (INDX).
  3822     MOVE AL-UNBON              TO  EOM-DT-ATTRB (INDX).
  3823     MOVE ER-0587               TO  EMI-ERROR.
  3824     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3825
  3826 1040-CHECK-INPUT-DATE.
  3827
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL6351.cbl
  3828****************************************************************
  3829**   THIS CODE EDITS THE INPUT DATE
  3830****************************************************************
  3831
  3832     IF INDATE-LEN (INDX)  = ZEROS
  3833         GO TO 1040-CONTINUE.
  3834
  3835     MOVE AL-UNNON              TO  INDATE-ATTRB (INDX).
  3836     MOVE INDATE (INDX)         TO  DEEDIT-FIELD.
  3837     PERFORM 8600-DEEDIT.
  3838
  3839     IF DEEDIT-FIELD-V0  NOT NUMERIC
  3840        MOVE -1                  TO  INDATE-LEN (INDX)
  3841        MOVE AL-UNBON            TO  INDATE-ATTRB (INDX)
  3842        MOVE ER-0714             TO  EMI-ERROR
  3843        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3844
  3845     MOVE DEEDIT-FIELD-V0       TO  DC-GREG-DATE-1-MDY.
  3846     MOVE '4'                   TO  DC-OPTION-CODE.
  3847     PERFORM 8500-DATE-CONVERT  THRU 8500-EXIT.
  3848
  3849     IF DATE-CONVERSION-ERROR
  3850        MOVE -1                  TO  INDATE-LEN (INDX)
  3851        MOVE AL-UNBON            TO  INDATE-ATTRB (INDX)
  3852        MOVE ER-0714             TO  EMI-ERROR
  3853        PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  3854     ELSE
  3855        SET DINDEX               TO  INDX
  3856        MOVE DC-BIN-DATE-1       TO  WS-INP-DT (DINDEX).
  3857
  3858 1040-CONTINUE.
  3859
  3860     IF MORTGAGE-SESSION
  3861        IF INVOICE-LEN (INDX) = ZEROS
  3862           MOVE -1               TO INVOICE-LEN (INDX)
  3863           MOVE ER-3175          TO EMI-ERROR
  3864           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3865           GO TO 1060-INCREMENT-INDX
  3866        ELSE
  3867           PERFORM 6500-VERIFY-RECON-HEADER THRU 6590-EXIT.
  3868
  3869     IF INVOICE (INDX) = LOW-VALUES
  3870         GO TO 1060-INCREMENT-INDX.
  3871
  3872     IF WS-ACCEPT-1 (W-INDX) = 'A'
  3873         GO TO 1060-INCREMENT-INDX.
  3874
  3875     IF EIBAID = DFHPF5
  3876         MOVE 'Y'                TO  WS-PREV-PF5
  3877         MOVE DFHENTER           TO  EIBAID
  3878         MOVE 'A'                TO  WS-ACCEPT-1 (W-INDX)
  3879         GO TO 1060-INCREMENT-INDX.
  3880
  3881     MOVE PI-COMPANY-CD          TO  RECV-COMP-CD.
  3882     MOVE '1'                    TO  RECV-TYPE.
  3883     MOVE CARRIER (INDX)         TO  RECV-CARRIER.
  3884     MOVE GROUPING (INDX)        TO  RECV-GROUPING.
  3885     MOVE PI-SAVE-COMP-BAL-CODE  TO  RECV-BAL-LVL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL6351.cbl
  3886     MOVE FIN-RESP (INDX)        TO  RECV-FIN-RESP.
  3887     MOVE ACCT (INDX)            TO  RECV-ACCOUNT.
  3888     MOVE INVOICE (INDX)         TO  RECV-INVOICE.
  3889
  3890     IF APPLIED (INDX) = 'A'
  3891         MOVE '1'                TO  RECV-ENTRY-TYPE
  3892         MOVE 'A'                TO  RECV-RESPONSIBLE
  3893     ELSE
  3894         MOVE LOW-VALUES         TO  RECV-RESPONSIBLE
  3895         IF APPLIED (INDX) = 'G'
  3896             MOVE '2'            TO  RECV-ENTRY-TYPE
  3897         ELSE
  3898             MOVE '3'            TO  RECV-ENTRY-TYPE.
  3899
  3900     IF REF-LEN (INDX) NOT = ZEROS
  3901         MOVE REF (INDX)         TO  RECV-REFERENCE
  3902     ELSE
  3903         MOVE LOW-VALUES         TO  RECV-REFERENCE.
  3904
  3905     MOVE ZERO                   TO  RECV-RECORD-TYPE.
  3906     MOVE +0                     TO  RECV-RECORD-SEQ.
  3907
  3908     INSPECT ERRECV-KEY CONVERTING SPACES TO LOW-VALUES.
  3909
  3910
  3911* EXEC CICS HANDLE CONDITION
  3912*        NOTFND   (1050-RECV-NOTFND)
  3913*        NOTOPEN  (7200-RECV-FILE-NOTOPEN)
  3914*        END-EXEC.
  3915*    MOVE '"$IJ                  ! ( #00003675' TO DFHEIV0
  3916     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3917     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3918     MOVE X'2820233030303033363735' TO DFHEIV0(25:11)
  3919     CALL 'kxdfhei1' USING DFHEIV0
  3920     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3921
  3922
  3923     IF RECV-REFERENCE  =  LOW-VALUES
  3924         IF MORTGAGE-SESSION
  3925             MOVE SPACES              TO RECV-REFERENCE.
  3926
  3927
  3928* EXEC CICS READ
  3929*        DATASET  (RECV-FILE-ID)
  3930*        SET      (ADDRESS OF ACCOUNTS-RECEIVABLE)
  3931*        RIDFLD   (ERRECV-KEY)
  3932*        EQUAL
  3933*        END-EXEC.
  3934*    MOVE '&"S        E          (   #00003684' TO DFHEIV0
  3935     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3936     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3937     MOVE X'2020233030303033363834' TO DFHEIV0(25:11)
  3938     CALL 'kxdfhei1' USING DFHEIV0,
  3939           RECV-FILE-ID,
  3940           DFHEIV20,
  3941           DFHEIV99,
  3942           ERRECV-KEY,
  3943           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL6351.cbl
  3944           DFHEIV99,
  3945           DFHEIV99
  3946     SET ADDRESS OF ACCOUNTS-RECEIVABLE TO
  3947         DFHEIV20
  3948     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3949
  3950
  3951     GO TO 1060-INCREMENT-INDX.
  3952
  3953 1050-RECV-NOTFND.
  3954     MOVE ER-3180                TO EMI-ERROR.
  3955     MOVE -1                     TO INVOICE-LEN (INDX).
  3956     MOVE AL-UABON               TO INVOICE-ATTRB (INDX).
  3957
  3958     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3959
  3960 1060-INCREMENT-INDX.
  3961
  3962     IF INDX  IS LESS THAN +5
  3963         SET INDX  UP  BY  1
  3964         SET W-INDX TO INDX
  3965         GO TO 1010-EDIT-LOOP.
  3966
  3967     MOVE WS-ACCEPT             TO  PI-ACCEPT.
  3968
  3969     IF EMI-ERROR = ZEROS
  3970         GO TO 2000-UPDATE-THE-FILE
  3971     ELSE
  3972         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL6351.cbl
  3974 2000-UPDATE-THE-FILE.
  3975     SET INDX                    TO  1.
  3976
  3977 2100-UPDATE-LOOP.
  3978
  3979     IF INDX  IS GREATER THAN  +5
  3980         GO TO 2200-UPDATE-COMPLETE.
  3981
  3982     IF CARR-LEN        (INDX) = ZEROS
  3983        AND GRP-LEN     (INDX) = ZEROS
  3984        AND FIN-LEN     (INDX) = ZEROS
  3985        AND ACCT-LEN    (INDX) = ZEROS
  3986        AND COMM-LEN    (INDX) = ZEROS
  3987        AND RTYPE-LEN   (INDX) = ZEROS
  3988        AND AMT-LEN     (INDX) = ZEROS
  3989        AND EOM-DT-LEN  (INDX) = ZEROS
  3990        AND INDATE-LEN  (INDX) = ZEROS
  3991        SET INDX  UP  BY  1
  3992        GO TO 2100-UPDATE-LOOP.
  3993
  3994
  3995* EXEC CICS GETMAIN
  3996*        SET      (ADDRESS OF PENDING-PAY-ADJ)
  3997*        LENGTH   (ERPYAJ-RECORD-LENGTH)
  3998*        INITIMG  (GETMAIN-SPACE)
  3999*        END-EXEC.
  4000*    MOVE ',"IL                  $   #00003734' TO DFHEIV0
  4001     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4002     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4003     MOVE X'2020233030303033373334' TO DFHEIV0(25:11)
  4004     CALL 'kxdfhei1' USING DFHEIV0,
  4005           DFHEIV20,
  4006           ERPYAJ-RECORD-LENGTH,
  4007           GETMAIN-SPACE
  4008     SET ADDRESS OF PENDING-PAY-ADJ TO
  4009         DFHEIV20
  4010     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4011
  4012
  4013     MOVE SPACES                 TO  PENDING-PAY-ADJ.
  4014
  4015     MOVE 'PY'                   TO  PY-RECORD-ID.
  4016     MOVE PI-COMPANY-CD          TO  PY-COMPANY-CD.
  4017
  4018     IF CARR-LEN   (INDX)        GREATER THAN ZEROS
  4019        MOVE CARRIER     (INDX)  TO  PY-CARRIER.
  4020
  4021     IF GRP-LEN       (INDX)     GREATER THAN ZEROS
  4022        MOVE GROUPING (INDX)     TO  PY-GROUPING.
  4023
  4024     IF FIN-LEN       (INDX)     GREATER THAN ZEROS
  4025        MOVE FIN-RESP (INDX)     TO  PY-FIN-RESP.
  4026
  4027     IF ACCT-LEN      (INDX)     GREATER THAN ZEROS
  4028        MOVE ACCT     (INDX)     TO  PY-ACCOUNT.
  4029
  4030     MOVE RTYPE       (INDX)     TO  PY-RECORD-TYPE.
  4031
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL6351.cbl
  4032     IF REF-LEN       (INDX) NOT = ZEROS
  4033        MOVE REF      (INDX)     TO  PY-REF-NO.
  4034
  4035     IF INVOICE-LEN   (INDX) NOT = ZEROS
  4036        MOVE INVOICE  (INDX)     TO  PY-BIL-INV.
  4037
  4038     IF CREDIT-LEN    (INDX) NOT = ZEROS
  4039        MOVE CREDIT   (INDX)     TO  PY-GL-CR.
  4040
  4041     IF DEBIT-LEN     (INDX) NOT = ZEROS
  4042        MOVE DEBIT    (INDX)     TO  PY-GL-DB.
  4043
  4044     SET MINDEX  TO  INDX.
  4045
  4046     IF WS-EOM-DT (MINDEX)  NOT = ZEROS
  4047         MOVE WS-EOM-DT (MINDEX) TO  PY-CREDIT-SELECT-DT
  4048     ELSE
  4049         MOVE PI-CR-MONTH-END-DT TO  PY-CREDIT-SELECT-DT.
  4050
  4051     SET DINDEX  TO  INDX.
  4052
  4053     IF WS-INP-DT (DINDEX)  NOT = ZEROS
  4054         MOVE WS-INP-DT (DINDEX) TO  PY-INPUT-DT
  4055     ELSE
  4056         MOVE WS-CURRENT-BIN-DT  TO  PY-INPUT-DT.
  4057
  4058     MOVE APPLIED (INDX)         TO  PY-PMT-APPLIED.
  4059     MOVE WORK-SEQ-NO            TO  PY-FILE-SEQ-NO.
  4060
  4061     ADD +1                      TO  WORK-SEQ-NO.
  4062
  4063     IF COMM-LEN (INDX) NOT = ZEROS
  4064         MOVE COMM (INDX)        TO  PY-ENTRY-COMMENT.
  4065
  4066     SET WS-INDX                 TO  INDX.
  4067     MOVE WS-EDITED-AMT(WS-INDX) TO  PY-ENTRY-AMT
  4068                                     WS-ENTRY-AMT.
  4069     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4070     MOVE EIBTIME                TO  PY-LAST-MAINT-HHMMSS.
  4071     MOVE WS-CURRENT-BIN-DT      TO  PY-LAST-MAINT-DT.
  4072*                                    PY-INPUT-DT.
  4073     MOVE ZEROS                  TO  PY-CHECK-QUE-CONTROL
  4074                                     PY-CHECK-QUE-SEQUENCE.
  4075     MOVE LOW-VALUES             TO  PY-CREDIT-ACCEPT-DT
  4076                                     PY-BILLED-DATE
  4077                                     PY-AR-DATE
  4078                                     PY-REPORTED-DT
  4079                                     PY-CHECK-WRITTEN-DT
  4080                                     PY-GL-DATE.
  4081
  4082 2115-WRITE-REC.
  4083
  4084     IF MORTGAGE-SESSION
  4085         MOVE PI-MP-MONTH-END-DT TO  PY-CREDIT-SELECT-DT.
  4086
  4087     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4088     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4089
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL6351.cbl
  4090     IF MORTGAGE-SESSION
  4091        PERFORM 6600-UPDATE-RECON-HEADER THRU 6690-EXIT.
  4092
  4093
  4094* EXEC CICS HANDLE CONDITION
  4095*        DUPREC   (2125-DUP-RECORD)
  4096*        NOTOPEN  (7000-PYAJ-FILE-NOTOPEN)
  4097*        END-EXEC.
  4098*    MOVE '"$%J                  ! ) #00003820' TO DFHEIV0
  4099     MOVE X'2224254A2020202020202020' TO DFHEIV0(1:12)
  4100     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4101     MOVE X'2920233030303033383230' TO DFHEIV0(25:11)
  4102     CALL 'kxdfhei1' USING DFHEIV0
  4103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4104
  4105
  4106 2120-WRITE-PYAJ-REC.
  4107
  4108
  4109* EXEC CICS WRITE
  4110*        DATASET  (PYAJ-FILE-ID)
  4111*        FROM     (PENDING-PAY-ADJ)
  4112*        RIDFLD   (PY-CONTROL-PRIMARY)
  4113*        END-EXEC.
  4114     MOVE LENGTH OF
  4115      PENDING-PAY-ADJ
  4116       TO DFHEIV11
  4117*    MOVE '&$ L                  ''   #00003827' TO DFHEIV0
  4118     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4119     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4120     MOVE X'2020233030303033383237' TO DFHEIV0(25:11)
  4121     CALL 'kxdfhei1' USING DFHEIV0,
  4122           PYAJ-FILE-ID,
  4123           PENDING-PAY-ADJ,
  4124           DFHEIV11,
  4125           PY-CONTROL-PRIMARY,
  4126           DFHEIV99,
  4127           DFHEIV99
  4128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4129
  4130
  4131     PERFORM 8400-LOG-JOURNAL-RECORD.
  4132
  4133     MOVE LOW-VALUES             TO  DATA-AREA (INDX).
  4134
  4135     GO TO 2100-UPDATE-LOOP.
  4136
  4137 2125-DUP-RECORD.
  4138
  4139     COMPUTE PY-FILE-SEQ-NO = PY-FILE-SEQ-NO + 1.
  4140
  4141     GO TO 2120-WRITE-PYAJ-REC.
  4142 2200-UPDATE-COMPLETE.
  4143
  4144     MOVE LOW-VALUES             TO  EL635BI.
  4145     MOVE ER-0000                TO  EMI-ERROR
  4146     MOVE -1                     TO  CAR1L.
  4147
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL6351.cbl
  4148     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  4149
  4150     GO TO 8100-SEND-INITIAL-MAP.
  4151
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL6351.cbl
  4153
  4154 6500-VERIFY-RECON-HEADER.
  4155
  4156     IF RTYPE-LEN (INDX)  GREATER THAN ZEROS
  4157        IF RTYPE  (INDX)  NOT = 'R'
  4158           GO TO 6590-EXIT.
  4159
  4160     MOVE PI-COMPANY-CD           TO MPPRCN-COMPANY-CD.
  4161     MOVE INVOICE (INDX)          TO MPPRCN-INVOICE.
  4162     MOVE +999999999              TO MPPRCN-RECORD-SEQU.
  4163
  4164
  4165* EXEC CICS HANDLE CONDITION
  4166*        NOTFND   (6580-HEADER-NOTFND)
  4167*        END-EXEC.
  4168*    MOVE '"$I                   ! * #00003866' TO DFHEIV0
  4169     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4170     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4171     MOVE X'2A20233030303033383636' TO DFHEIV0(25:11)
  4172     CALL 'kxdfhei1' USING DFHEIV0
  4173     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4174
  4175
  4176
  4177* EXEC CICS READ
  4178*        DATASET   (MPPRCN-FILE-ID)
  4179*        SET       (ADDRESS OF PAYMENT-RECONCILIATION)
  4180*        RIDFLD    (MPPRCN-KEY)
  4181*        END-EXEC.
  4182*    MOVE '&"S        E          (   #00003870' TO DFHEIV0
  4183     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4184     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4185     MOVE X'2020233030303033383730' TO DFHEIV0(25:11)
  4186     CALL 'kxdfhei1' USING DFHEIV0,
  4187           MPPRCN-FILE-ID,
  4188           DFHEIV20,
  4189           DFHEIV99,
  4190           MPPRCN-KEY,
  4191           DFHEIV99,
  4192           DFHEIV99,
  4193           DFHEIV99
  4194     SET ADDRESS OF PAYMENT-RECONCILIATION TO
  4195         DFHEIV20
  4196     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4197
  4198
  4199     IF  NOT PI-NO-CARRIER-SECURITY
  4200             AND
  4201         PI-CARRIER-SECURITY NOT EQUAL PR-CARRIER-A2
  4202         MOVE -1                 TO CARR-LEN      (INDX)
  4203         MOVE AL-UANON           TO CARR-ATTRB    (INDX)
  4204         MOVE ER-9095            TO EMI-ERROR
  4205         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4206         GO TO 8200-SEND-DATAONLY.
  4207
  4208     MOVE PR-SECURITY-ACCESS-CODE
  4209                                 TO SC-SECURITY-ACCESS-CODE.
  4210     PERFORM 9920-PRODUCER-EVALUATION THRU 9920-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL6351.cbl
  4211
  4212     IF  SC-PRODUCER-NOT-AUTHORIZED
  4213         MOVE -1                 TO ACCT-LEN      (INDX)
  4214         MOVE AL-UANON           TO ACCT-ATTRB    (INDX)
  4215         MOVE ER-9094            TO EMI-ERROR
  4216         GO TO 8200-SEND-DATAONLY.
  4217
  4218     IF PR-HDR-POSTED
  4219        GO TO 6560-POST-ERROR.
  4220
  4221     GO TO 6590-EXIT.
  4222
  4223 6560-POST-ERROR.
  4224
  4225     MOVE -1                     TO INVOICE-LEN (INDX)
  4226     MOVE ER-9296                TO EMI-ERROR.
  4227     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  4228
  4229     GO TO 6590-EXIT.
  4230
  4231 6580-HEADER-NOTFND.
  4232
  4233     MOVE -1                     TO INVOICE-LEN (INDX)
  4234     MOVE ER-9280                TO EMI-ERROR.
  4235     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  4236
  4237 6590-EXIT.
  4238     EXIT.
  4239
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL6351.cbl
  4241
  4242
  4243 6600-UPDATE-RECON-HEADER.
  4244
  4245     IF (PY-REMIT-RECEIVED OR PY-REMIT-IND-GROUPING)
  4246        NEXT SENTENCE
  4247     ELSE
  4248        GO TO 6690-EXIT.
  4249
  4250     MOVE PI-COMPANY-CD           TO MPPRCN-COMPANY-CD.
  4251     MOVE INVOICE (INDX)          TO MPPRCN-INVOICE.
  4252     MOVE +999999999              TO MPPRCN-RECORD-SEQU.
  4253
  4254
  4255* EXEC CICS HANDLE CONDITION
  4256*        NOTFND   (6680-HEADER-NOTFND)
  4257*        END-EXEC.
  4258*    MOVE '"$I                   ! + #00003931' TO DFHEIV0
  4259     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4260     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4261     MOVE X'2B20233030303033393331' TO DFHEIV0(25:11)
  4262     CALL 'kxdfhei1' USING DFHEIV0
  4263     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4264
  4265
  4266
  4267* EXEC CICS READ
  4268*        DATASET   (MPPRCN-FILE-ID)
  4269*        SET       (ADDRESS OF PAYMENT-RECONCILIATION)
  4270*        RIDFLD    (MPPRCN-KEY)
  4271*        UPDATE
  4272*        END-EXEC.
  4273*    MOVE '&"S        EU         (   #00003935' TO DFHEIV0
  4274     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4275     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4276     MOVE X'2020233030303033393335' TO DFHEIV0(25:11)
  4277     CALL 'kxdfhei1' USING DFHEIV0,
  4278           MPPRCN-FILE-ID,
  4279           DFHEIV20,
  4280           DFHEIV99,
  4281           MPPRCN-KEY,
  4282           DFHEIV99,
  4283           DFHEIV99,
  4284           DFHEIV99
  4285     SET ADDRESS OF PAYMENT-RECONCILIATION TO
  4286         DFHEIV20
  4287     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4288
  4289
  4290     IF PR-HDR-POSTED
  4291        GO TO 6660-POST-ERROR.
  4292
  4293     ADD  WS-ENTRY-AMT           TO PR-RECEIVED-PREMIUM.
  4294     MOVE WS-CURRENT-BIN-DT      TO PR-RECEIVED-DT.
  4295
  4296     MOVE PI-PROCESSOR-ID        TO PR-LAST-CHANGE-PROCESSOR.
  4297     MOVE EIBTIME                TO PR-LAST-CHANGE-TIME.
  4298     MOVE WS-CURRENT-BIN-DT      TO PR-LAST-CHANGE-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL6351.cbl
  4299
  4300
  4301* EXEC CICS REWRITE
  4302*        DATASET   (MPPRCN-FILE-ID)
  4303*        FROM      (PAYMENT-RECONCILIATION)
  4304*        END-EXEC.
  4305     MOVE LENGTH OF
  4306      PAYMENT-RECONCILIATION
  4307       TO DFHEIV11
  4308*    MOVE '&& L                  %   #00003952' TO DFHEIV0
  4309     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4310     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4311     MOVE X'2020233030303033393532' TO DFHEIV0(25:11)
  4312     CALL 'kxdfhei1' USING DFHEIV0,
  4313           MPPRCN-FILE-ID,
  4314           PAYMENT-RECONCILIATION,
  4315           DFHEIV11,
  4316           DFHEIV99
  4317     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4318
  4319
  4320     GO TO 6690-EXIT.
  4321
  4322 6660-POST-ERROR.
  4323
  4324
  4325* EXEC CICS SYNCPOINT ROLLBACK
  4326*    END-EXEC.
  4327*    MOVE '6"R                   !   #00003961' TO DFHEIV0
  4328     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  4329     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4330     MOVE X'2020233030303033393631' TO DFHEIV0(25:11)
  4331     CALL 'kxdfhei1' USING DFHEIV0
  4332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4333
  4334
  4335     MOVE -1                     TO INVOICE-LEN (INDX)
  4336     MOVE ER-9296                TO EMI-ERROR.
  4337     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  4338     GO TO 8200-SEND-DATAONLY.
  4339
  4340 6680-HEADER-NOTFND.
  4341
  4342
  4343* EXEC CICS SYNCPOINT ROLLBACK
  4344*    END-EXEC.
  4345*    MOVE '6"R                   !   #00003971' TO DFHEIV0
  4346     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  4347     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4348     MOVE X'2020233030303033393731' TO DFHEIV0(25:11)
  4349     CALL 'kxdfhei1' USING DFHEIV0
  4350     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4351
  4352
  4353     MOVE -1                     TO INVOICE-LEN (INDX).
  4354     MOVE ER-9280                TO EMI-ERROR.
  4355     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  4356     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL6351.cbl
  4357
  4358 6690-EXIT.
  4359     EXIT.
  4360
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL6351.cbl
  4362
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL6351.cbl
  4364 7000-PYAJ-FILE-NOTOPEN.
  4365     MOVE -1                     TO  PFENTERL.
  4366     MOVE ER-2232                TO  EMI-ERROR.
  4367
  4368     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4369
  4370     GO TO 8200-SEND-DATAONLY.
  4371
  4372 7100-COMP-FILE-NOTOPEN.
  4373     MOVE -1                     TO  PFENTERL.
  4374     MOVE ER-2233                TO  EMI-ERROR.
  4375
  4376     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4377
  4378     GO TO 8200-SEND-DATAONLY.
  4379 7200-RECV-FILE-NOTOPEN.
  4380     MOVE -1                     TO  PFENTERL.
  4381     MOVE ER-3177                TO  EMI-ERROR.
  4382
  4383     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  4384
  4385     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL6351.cbl
  4387 8100-SEND-INITIAL-MAP.
  4388
  4389     MOVE WS-CURRENT-DT          TO  DATEO.
  4390     MOVE EIBTIME                TO  TIME-IN.
  4391     MOVE TIME-OUT               TO  TIMEO.
  4392     MOVE -1                     TO  CAR1L.
  4393     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  4394     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  4395
  4396     IF MORTGAGE-SESSION
  4397        MOVE  'PROD:'            TO ACTHDG1O
  4398        MOVE AL-SANOF            TO ACTHDG1A
  4399        MOVE  'PROD:'            TO ACTHDG2O
  4400        MOVE AL-SANOF            TO ACTHDG2A
  4401        MOVE  'PROD:'            TO ACTHDG3O
  4402        MOVE AL-SANOF            TO ACTHDG3A
  4403        MOVE  'PROD:'            TO ACTHDG4O
  4404        MOVE AL-SANOF            TO ACTHDG4A
  4405        MOVE  'PROD:'            TO ACTHDG5O
  4406        MOVE AL-SANOF            TO ACTHDG5A.
  4407
  4408
  4409* EXEC CICS SEND
  4410*        MAP     (MAP-NAME)
  4411*        MAPSET  (MAPSET-NAME)
  4412*        FROM    (EL635BO)
  4413*        ERASE
  4414*        CURSOR
  4415*        END-EXEC.
  4416     MOVE LENGTH OF
  4417      EL635BO
  4418       TO DFHEIV12
  4419     MOVE -1
  4420       TO DFHEIV11
  4421*    MOVE '8$     CT  E    H L F ,   #00004029' TO DFHEIV0
  4422     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4423     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4424     MOVE X'2020233030303034303239' TO DFHEIV0(25:11)
  4425     CALL 'kxdfhei1' USING DFHEIV0,
  4426           MAP-NAME,
  4427           EL635BO,
  4428           DFHEIV12,
  4429           MAPSET-NAME,
  4430           DFHEIV99,
  4431           DFHEIV99,
  4432           DFHEIV99,
  4433           DFHEIV11,
  4434           DFHEIV99,
  4435           DFHEIV99,
  4436           DFHEIV99
  4437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4438
  4439
  4440     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL6351.cbl
  4442 8200-SEND-DATAONLY.
  4443
  4444     MOVE WS-CURRENT-DT          TO  DATEO.
  4445     MOVE EIBTIME                TO  TIME-IN.
  4446     MOVE TIME-OUT               TO  TIMEO.
  4447     MOVE EMI-MESSAGE-AREA (1)   TO  ERRMSG1O.
  4448     MOVE EMI-MESSAGE-AREA (2)   TO  ERRMSG2O.
  4449
  4450
  4451* EXEC CICS SEND
  4452*        MAP     (MAP-NAME)
  4453*        MAPSET  (MAPSET-NAME)
  4454*        FROM    (EL635BO)
  4455*        DATAONLY
  4456*        CURSOR
  4457*        END-EXEC.
  4458     MOVE LENGTH OF
  4459      EL635BO
  4460       TO DFHEIV12
  4461     MOVE -1
  4462       TO DFHEIV11
  4463*    MOVE '8$D    CT       H L F ,   #00004047' TO DFHEIV0
  4464     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4465     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4466     MOVE X'2020233030303034303437' TO DFHEIV0(25:11)
  4467     CALL 'kxdfhei1' USING DFHEIV0,
  4468           MAP-NAME,
  4469           EL635BO,
  4470           DFHEIV12,
  4471           MAPSET-NAME,
  4472           DFHEIV99,
  4473           DFHEIV99,
  4474           DFHEIV99,
  4475           DFHEIV11,
  4476           DFHEIV99,
  4477           DFHEIV99,
  4478           DFHEIV99
  4479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4480
  4481
  4482     GO TO 9100-RETURN-TRAN.
  4483
  4484 8300-SEND-TEXT.
  4485
  4486* EXEC CICS SEND TEXT
  4487*        FROM    (LOGOFF-TEXT)
  4488*        LENGTH  (LOGOFF-LENGTH)
  4489*        ERASE
  4490*        FREEKB
  4491*        END-EXEC.
  4492*    MOVE '8&      T  E F  H   F -   #00004058' TO DFHEIV0
  4493     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4494     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4495     MOVE X'2020233030303034303538' TO DFHEIV0(25:11)
  4496     CALL 'kxdfhei1' USING DFHEIV0,
  4497           LOGOFF-TEXT,
  4498           LOGOFF-LENGTH,
  4499           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL6351.cbl
  4500           DFHEIV99,
  4501           DFHEIV99,
  4502           DFHEIV99,
  4503           DFHEIV99,
  4504           DFHEIV99,
  4505           DFHEIV99,
  4506           DFHEIV99,
  4507           DFHEIV99,
  4508           DFHEIV99
  4509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4510
  4511
  4512
  4513* EXEC CICS RETURN
  4514*        END-EXEC.
  4515*    MOVE '.(                    &   #00004065' TO DFHEIV0
  4516     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4517     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4518     MOVE X'2020233030303034303635' TO DFHEIV0(25:11)
  4519     CALL 'kxdfhei1' USING DFHEIV0,
  4520           DFHEIV99,
  4521           DFHEIV99,
  4522           DFHEIV99,
  4523           DFHEIV99,
  4524           DFHEIV99
  4525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4526
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL6351.cbl
  4528 8400-LOG-JOURNAL-RECORD.
  4529*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  4530*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  4531*    MOVE PYAJ-FILE-ID           TO  JP-FILE-ID.
  4532*    MOVE ZERO                   TO  JP-GENERIC-KEY-LENGTH.
  4533
  4534*    EXEC CICS JOURNAL
  4535*        JFILEID  (PI-JOURNAL-FILE-ID)
  4536*        JTYPEID  ('EL')
  4537*        FROM     (JOURNAL-RECORD)
  4538*        LENGTH   (223)
  4539*        END-EXEC.
  4540
  4541 8500-DATE-CONVERT.
  4542
  4543* EXEC CICS LINK
  4544*        PROGRAM   (LINK-CLDATCV)
  4545*        COMMAREA  (DATE-CONVERSION-DATA)
  4546*        LENGTH    (DC-COMM-LENGTH)
  4547*        END-EXEC.
  4548*    MOVE '."C                   ''   #00004082' TO DFHEIV0
  4549     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4550     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4551     MOVE X'2020233030303034303832' TO DFHEIV0(25:11)
  4552     CALL 'kxdfhei1' USING DFHEIV0,
  4553           LINK-CLDATCV,
  4554           DATE-CONVERSION-DATA,
  4555           DC-COMM-LENGTH,
  4556           DFHEIV99,
  4557           DFHEIV99,
  4558           DFHEIV99
  4559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4560
  4561
  4562 8500-EXIT.
  4563     EXIT.
  4564
  4565 8600-DEEDIT.
  4566
  4567* EXEC CICS BIF DEEDIT
  4568*        FIELD   (DEEDIT-FIELD)
  4569*        LENGTH  (11)
  4570*        END-EXEC.
  4571     MOVE 11
  4572       TO DFHEIV11
  4573*    MOVE '@"L                   #   #00004092' TO DFHEIV0
  4574     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  4575     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4576     MOVE X'2020233030303034303932' TO DFHEIV0(25:11)
  4577     CALL 'kxdfhei1' USING DFHEIV0,
  4578           DEEDIT-FIELD,
  4579           DFHEIV11
  4580     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4581
  4582
  4583 8600-EXIT.
  4584     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL6351.cbl
  4586 8800-UNAUTHORIZED-ACCESS.
  4587     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  4588
  4589     GO TO 8300-SEND-TEXT.
  4590
  4591 8810-PF23.
  4592     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  4593     MOVE XCTL-005               TO  PGM-NAME.
  4594
  4595     GO TO 9300-XCTL.
  4596
  4597 9000-RETURN-CICS.
  4598
  4599* EXEC CICS RETURN
  4600*        END-EXEC.
  4601*    MOVE '.(                    &   #00004112' TO DFHEIV0
  4602     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4603     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4604     MOVE X'2020233030303034313132' TO DFHEIV0(25:11)
  4605     CALL 'kxdfhei1' USING DFHEIV0,
  4606           DFHEIV99,
  4607           DFHEIV99,
  4608           DFHEIV99,
  4609           DFHEIV99,
  4610           DFHEIV99
  4611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4612
  4613
  4614 9100-RETURN-TRAN.
  4615     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  4616     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  4617
  4618
  4619* EXEC CICS RETURN
  4620*        TRANSID   (TRANS-ID)
  4621*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  4622*        LENGTH    (PI-COMM-LENGTH)
  4623*        END-EXEC.
  4624*    MOVE '.(CT                  &   #00004119' TO DFHEIV0
  4625     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4626     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4627     MOVE X'2020233030303034313139' TO DFHEIV0(25:11)
  4628     CALL 'kxdfhei1' USING DFHEIV0,
  4629           TRANS-ID,
  4630           PROGRAM-INTERFACE-BLOCK,
  4631           PI-COMM-LENGTH,
  4632           DFHEIV99,
  4633           DFHEIV99
  4634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4635
  4636
  4637 9200-RETURN-MAIN-MENU.
  4638
  4639     IF  CREDIT-SESSION
  4640         MOVE XCTL-EL626         TO PGM-NAME
  4641
  4642     ELSE
  4643         IF  CLAIM-SESSION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL6351.cbl
  4644             MOVE XCTL-EL126     TO PGM-NAME
  4645
  4646         ELSE
  4647             IF  MORTGAGE-SESSION
  4648                 MOVE XCTL-EM626 TO PGM-NAME
  4649
  4650             ELSE
  4651                 IF  GENERAL-LEDGER-SESSION
  4652                     MOVE XCTL-GL800
  4653                                 TO PGM-NAME.
  4654
  4655     GO TO 9300-XCTL.
  4656
  4657 9300-XCTL.
  4658
  4659* EXEC CICS XCTL
  4660*        PROGRAM   (PGM-NAME)
  4661*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  4662*        LENGTH    (PI-COMM-LENGTH)
  4663*        END-EXEC.
  4664*    MOVE '.$C                   $   #00004146' TO DFHEIV0
  4665     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4666     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4667     MOVE X'2020233030303034313436' TO DFHEIV0(25:11)
  4668     CALL 'kxdfhei1' USING DFHEIV0,
  4669           PGM-NAME,
  4670           PROGRAM-INTERFACE-BLOCK,
  4671           PI-COMM-LENGTH
  4672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4673
  4674
  4675 9400-CLEAR.
  4676     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  4677
  4678     GO TO 9300-XCTL.
  4679
  4680 9500-PF12.
  4681     MOVE XCTL-010               TO  PGM-NAME.
  4682
  4683     GO TO 9300-XCTL.
  4684
  4685 9600-PGMID-ERROR.
  4686
  4687* EXEC CICS HANDLE CONDITION
  4688*        PGMIDERR  (8300-SEND-TEXT)
  4689*        END-EXEC.
  4690*    MOVE '"$L                   ! , #00004163' TO DFHEIV0
  4691     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4692     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4693     MOVE X'2C20233030303034313633' TO DFHEIV0(25:11)
  4694     CALL 'kxdfhei1' USING DFHEIV0
  4695     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4696
  4697
  4698     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  4699     MOVE ' '                    TO  PI-ENTRY-CD-1.
  4700     MOVE XCTL-005               TO  PGM-NAME.
  4701     MOVE PGM-NAME               TO  LOGOFF-PGM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL6351.cbl
  4702     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  4703
  4704     GO TO 9300-XCTL.
  4705
  4706 9920-PRODUCER-EVALUATION.
  4707******************************************************************
  4708*                                                                *
  4709*       THIS AREA CONTAINS THE LOGIC NECESSARY TO CHECK THE      *
  4710*       AUTHORIZATION OF THE USER TO 'ACCESS' A PRODUCER.        *
  4711*       IF THE USER IS NOT AUTHORIZED AN APPROPRIATE MESSAGE     *
  4712*       IS GENERATED.                                            *
  4713*                                                                *
  4714******************************************************************
  4715
  4716     MOVE SPACES                 TO SC-PRODUCER-AUTHORIZED-SW.
  4717
  4718     IF  PI-NO-PRODUCER-SECURITY
  4719             OR
  4720         PI-PROCESSOR-ID EQUAL 'LGXX'
  4721         GO TO 9920-EXIT.
  4722
  4723     SET PI-ACCESS-NDX           TO +1
  4724
  4725     SEARCH PI-ACCESS-CODE
  4726         VARYING PI-ACCESS-NDX
  4727
  4728         AT END
  4729             MOVE 'N'            TO SC-PRODUCER-AUTHORIZED-SW
  4730
  4731         WHEN
  4732             PI-ACCESS-CODE (PI-ACCESS-NDX)
  4733                 EQUAL SC-SECURITY-ACCESS-CODE
  4734             GO TO 9920-EXIT.
  4735
  4736 9920-EXIT.
  4737     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL6351.cbl
  4739 9900-ERROR-FORMAT.
  4740     IF NOT EMI-ERRORS-COMPLETE
  4741         MOVE LINK-001           TO  PGM-NAME
  4742
  4743* EXEC CICS LINK
  4744*            PROGRAM   (PGM-NAME)
  4745*            COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  4746*            LENGTH    (EMI-COMM-LENGTH)
  4747*            END-EXEC.
  4748*    MOVE '."C                   ''   #00004211' TO DFHEIV0
  4749     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4750     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4751     MOVE X'2020233030303034323131' TO DFHEIV0(25:11)
  4752     CALL 'kxdfhei1' USING DFHEIV0,
  4753           PGM-NAME,
  4754           ERROR-MESSAGE-INTERFACE-BLOCK,
  4755           EMI-COMM-LENGTH,
  4756           DFHEIV99,
  4757           DFHEIV99,
  4758           DFHEIV99
  4759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4760
  4761
  4762 9900-EXIT.
  4763     EXIT.
  4764
  4765 9990-ABEND.
  4766     MOVE LINK-004               TO  PGM-NAME.
  4767     MOVE DFHEIBLK               TO  EMI-LINE1.
  4768
  4769
  4770* EXEC CICS LINK
  4771*        PROGRAM   (PGM-NAME)
  4772*        COMMAREA  (EMI-LINE1)
  4773*        LENGTH    (72)
  4774*        END-EXEC.
  4775     MOVE 72
  4776       TO DFHEIV11
  4777*    MOVE '."C                   ''   #00004224' TO DFHEIV0
  4778     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4779     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4780     MOVE X'2020233030303034323234' TO DFHEIV0(25:11)
  4781     CALL 'kxdfhei1' USING DFHEIV0,
  4782           PGM-NAME,
  4783           EMI-LINE1,
  4784           DFHEIV11,
  4785           DFHEIV99,
  4786           DFHEIV99,
  4787           DFHEIV99
  4788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4789
  4790
  4791     MOVE -1                     TO  PFENTERL.
  4792
  4793     GO TO 8200-SEND-DATAONLY.
  4794
  4795
  4796* GOBACK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL6351.cbl
  4797     MOVE '9%                    "   ' TO DFHEIV0
  4798     MOVE 'EL6351' TO DFHEIV1
  4799     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4800     GOBACK.
  4801
  4802 9995-SECURITY-VIOLATION.
  4803*                            COPY ELCSCTP.
  4804******************************************************************
  4805*                                                                *
  4806*                            ELCSCTP                             *
  4807*                            VMOD=2.001                          *
  4808*                                                                *
  4809*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  4810******************************************************************
  4811
  4812
  4813     MOVE EIBDATE          TO SM-JUL-DATE.
  4814     MOVE EIBTRMID         TO SM-TERMID.
  4815     MOVE THIS-PGM         TO SM-PGM.
  4816     MOVE EIBTIME          TO TIME-IN.
  4817     MOVE TIME-OUT         TO SM-TIME.
  4818     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  4819
  4820
  4821* EXEC CICS LINK
  4822*         PROGRAM  ('EL003')
  4823*         COMMAREA (SECURITY-MESSAGE)
  4824*         LENGTH   (80)
  4825*    END-EXEC.
  4826     MOVE 'EL003' TO DFHEIV1
  4827     MOVE 80
  4828       TO DFHEIV11
  4829*    MOVE '."C                   ''   #00004254' TO DFHEIV0
  4830     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4831     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4832     MOVE X'2020233030303034323534' TO DFHEIV0(25:11)
  4833     CALL 'kxdfhei1' USING DFHEIV0,
  4834           DFHEIV1,
  4835           SECURITY-MESSAGE,
  4836           DFHEIV11,
  4837           DFHEIV99,
  4838           DFHEIV99,
  4839           DFHEIV99
  4840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4841
  4842
  4843******************************************************************
  4844
  4845
  4846 9995-EXIT.
  4847     EXIT.
  4848
  4849
  4850 9999-DFHBACK SECTION.
  4851     MOVE '9%                    "   ' TO DFHEIV0
  4852     MOVE 'EL6351' TO DFHEIV1
  4853     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4854     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL6351.cbl
  4855 9999-DFHEXIT.
  4856     IF DFHEIGDJ EQUAL 0001
  4857         NEXT SENTENCE
  4858     ELSE IF DFHEIGDJ EQUAL 2
  4859         GO TO 9600-PGMID-ERROR,
  4860               9990-ABEND
  4861         DEPENDING ON DFHEIGDI
  4862     ELSE IF DFHEIGDJ EQUAL 3
  4863         GO TO 1015-NO-COMP-MSTR,
  4864               7100-COMP-FILE-NOTOPEN
  4865         DEPENDING ON DFHEIGDI
  4866     ELSE IF DFHEIGDJ EQUAL 4
  4867         GO TO 1015-NO-COMP-MSTR,
  4868               7100-COMP-FILE-NOTOPEN
  4869         DEPENDING ON DFHEIGDI
  4870     ELSE IF DFHEIGDJ EQUAL 5
  4871         GO TO 1015-NO-COMP-MSTR,
  4872               7100-COMP-FILE-NOTOPEN
  4873         DEPENDING ON DFHEIGDI
  4874     ELSE IF DFHEIGDJ EQUAL 6
  4875         GO TO 1015-NO-COMP-MSTR,
  4876               7100-COMP-FILE-NOTOPEN
  4877         DEPENDING ON DFHEIGDI
  4878     ELSE IF DFHEIGDJ EQUAL 7
  4879         GO TO 1015-NO-COMP-MSTR,
  4880               7100-COMP-FILE-NOTOPEN
  4881         DEPENDING ON DFHEIGDI
  4882     ELSE IF DFHEIGDJ EQUAL 8
  4883         GO TO 1050-RECV-NOTFND,
  4884               7200-RECV-FILE-NOTOPEN
  4885         DEPENDING ON DFHEIGDI
  4886     ELSE IF DFHEIGDJ EQUAL 9
  4887         GO TO 2125-DUP-RECORD,
  4888               7000-PYAJ-FILE-NOTOPEN
  4889         DEPENDING ON DFHEIGDI
  4890     ELSE IF DFHEIGDJ EQUAL 10
  4891         GO TO 6580-HEADER-NOTFND
  4892         DEPENDING ON DFHEIGDI
  4893     ELSE IF DFHEIGDJ EQUAL 11
  4894         GO TO 6680-HEADER-NOTFND
  4895         DEPENDING ON DFHEIGDI
  4896     ELSE IF DFHEIGDJ EQUAL 12
  4897         GO TO 8300-SEND-TEXT
  4898         DEPENDING ON DFHEIGDI.
  4899     MOVE '9%                    "   ' TO DFHEIV0
  4900     MOVE 'EL6351' TO DFHEIV1
  4901     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4902     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5396     Code:       13818
