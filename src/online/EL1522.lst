* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL1522.cbl
* Options: int("EL1522.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1522.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1522.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1522.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL1522.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/13/96 09:53:12.
     7*                            VMOD=2.009.
     8*
     9*AUTHOR.           LOGIC,INC.
    10*                  DALLAS,TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL1522.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*                                                                *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS. TRANSACTION EX57 - HARDCOPY PRINT PROGRAM.
    25*        THIS PROGRAM IS USED TO PRINT LETTERS TO THE COMPANY
    26*        SPECIFIED PRINTER. IT IS ACTIVATED THROUGH THE START
    27*        COMMAND AND WILL HAVE THE INTERFACE BLOCK PASSED.
    28*        DATA IN THE INTERFACE BLOCK WILL INDICATE THE NUMBER OF
    29*        LINES TO PRINT AND THE NUMBER OF COPIES.
    30*        IT WILL ALSO CONTAIN THE TEMP STORAGE ID TO USE IN ORDER
    31*        TO RETRIEVE THE DATA TO BE PRINTED.
    32
    33******************************************************************
    34*                   C H A N G E   L O G
    35*
    36* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    37*-----------------------------------------------------------------
    38*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    39* EFFECTIVE    NUMBER
    40*-----------------------------------------------------------------
    41* 042605    2005042100002  PEMA  FIX TEMP STORAGE PROBLEMS
    42******************************************************************
    43
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL1522.cbl
    45 ENVIRONMENT DIVISION.
    46 DATA DIVISION.
    47 WORKING-STORAGE SECTION.
    48 01  DFH-START PIC X(04).
    49 77  FILLER  PIC X(32)  VALUE '********************************'.
    50 77  FILLER  PIC X(32)  VALUE '*   EL1522 WORKING STORAGE     *'.
    51 77  FILLER  PIC X(32)  VALUE '******* VMOD=2.009 *************'.
    52
    53 01  WS-CONSTANTS.
    54     12  THIS-PGM                PIC X(8)    VALUE 'EL1522'.
    55     12  PGM-EL152               PIC X(8)    VALUE 'EL152'.
    56     12  ERROR-LINE              PIC X(70).
    57     12  TS-ITEM                 PIC S9(4)   COMP.
    58     12  TS-LENGTH               PIC S9(4)   COMP VALUE +3650.
    59     12  INDX-WORK               PIC 99.
    60     12  NUM-ENTRIES-PER-RECORD  PIC 9(3)  COMP-3 VALUE 50.
    61     12  RECORDS-PRINTED         PIC 9(3)  COMP-3 VALUE 0.
    62     12  TOP-OF-FORM-MESSAGE     PIC X(8)  VALUE '*****TOP'.
    63     12  TOP-FORM                PIC X      VALUE '1'.
    64     12  WS-NEXT-TRAN            PIC X(4).
    65     12  WS-TERMINAL-ID.
    66         18  WS-TERM-PREFIX      PIC XX.
    67         18  FILLER              PIC XX.
    68     12  TS-WORK-AREA            PIC X(3650).
    69     12  REC-ENTRIES REDEFINES TS-WORK-AREA.
    70         16  REC-ENT OCCURS 50 TIMES INDEXED BY TB-INDX.
    71             20  REC-TEXT.
    72               24 REC-TEXT-TOP   PIC X(8).
    73               24 FILLER         PIC X(62).
    74             20  REC-PC          PIC 99.
    75             20  FILLER          PIC X.
    76     12  WS-CSO-TEMP-STOR-ID.
    77         18  FILLER              PIC X(04).
    78         18  WS-CSO-PRINTER-ID   PIC X(04).
    79     12  WS-REPORT-STARTED-SW    PIC X      VALUE 'N'.
    80         88  REPORT-STARTED                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL1522.cbl
    81/
    82*                                    COPY ELCDMD34.
    83******************************************************************
    84*                                                                *
    85*                                                                *
    86*                            ELCDMD34.                           *
    87*                            VMOD=2.001                          *
    88*                                                                *
    89*   FILE DESCRIPTION = DMD DLO034 PARAMETER AREA                 *
    90*                                                                *
    91*    LENGTH = 272    RECFRM = FIXED                              *
    92*                                                                *
    93******************************************************************
    94 01  DLO034-COMMUNICATION-AREA.
    95     12  DL34-PROCESS-TYPE             PIC X.
    96     12  DL34-COMPANY-ID               PIC XXX.
    97     12  DL34-PRINT-PROGRAM-ID         PIC X(8).
    98     12  DL34-USERID                   PIC X(4).
    99     12  DL34-PRINT-LINE               PIC X(250).
   100     12  DL34-OVERRIDE-PRINTER-ID      PIC X(4).
   101     12  DL34-RETURN-CODE              PIC XX.
   102 01  DLO034-REC-LENGTH                 PIC S9(4) COMP VALUE +272.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL1522.cbl
   103/
   104*                                    COPY ELCINTF.
   105******************************************************************
   106*                                                                *
   107*                                                                *
   108*                            ELCINTF.                            *
   109*                            VMOD=2.017                          *
   110*                                                                *
   111*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   112*                                                                *
   113*       LENGTH = 1024                                            *
   114*                                                                *
   115******************************************************************
   116 01  PROGRAM-INTERFACE-BLOCK.
   117     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   118     12  PI-CALLING-PROGRAM              PIC X(8).
   119     12  PI-SAVED-PROGRAM-1              PIC X(8).
   120     12  PI-SAVED-PROGRAM-2              PIC X(8).
   121     12  PI-SAVED-PROGRAM-3              PIC X(8).
   122     12  PI-SAVED-PROGRAM-4              PIC X(8).
   123     12  PI-SAVED-PROGRAM-5              PIC X(8).
   124     12  PI-SAVED-PROGRAM-6              PIC X(8).
   125     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   126     12  PI-COMPANY-ID                   PIC XXX.
   127     12  PI-COMPANY-CD                   PIC X.
   128
   129     12  PI-COMPANY-PASSWORD             PIC X(8).
   130
   131     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   132
   133     12  PI-CONTROL-IN-PROGRESS.
   134         16  PI-CARRIER                  PIC X.
   135         16  PI-GROUPING                 PIC X(6).
   136         16  PI-STATE                    PIC XX.
   137         16  PI-ACCOUNT                  PIC X(10).
   138         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   139                                         PIC X(10).
   140         16  PI-CLAIM-CERT-GRP.
   141             20  PI-CLAIM-NO             PIC X(7).
   142             20  PI-CERT-NO.
   143                 25  PI-CERT-PRIME       PIC X(10).
   144                 25  PI-CERT-SFX         PIC X.
   145             20  PI-CERT-EFF-DT          PIC XX.
   146         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   147             20  PI-PLAN-CODE            PIC X(2).
   148             20  PI-REVISION-NUMBER      PIC X(3).
   149             20  PI-PLAN-EFF-DT          PIC X(2).
   150             20  PI-PLAN-EXP-DT          PIC X(2).
   151             20  FILLER                  PIC X(11).
   152         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   153             20  PI-OE-REFERENCE-1.
   154                 25  PI-OE-REF-1-PRIME   PIC X(18).
   155                 25  PI-OE-REF-1-SUFF    PIC XX.
   156
   157     12  PI-SESSION-IN-PROGRESS          PIC X.
   158         88  CLAIM-SESSION                   VALUE '1'.
   159         88  CREDIT-SESSION                  VALUE '2'.
   160         88  WARRANTY-SESSION                VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL1522.cbl
   161         88  MORTGAGE-SESSION                VALUE '4'.
   162         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   163
   164
   165*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   166
   167     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   168     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   169
   170     12  PI-CREDIT-USER                  PIC X.
   171         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   172         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   173
   174     12  PI-CLAIM-USER                   PIC X.
   175         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   176         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   177
   178     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   179         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   180         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   181         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   182         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   183         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   184
   185     12  PI-PROCESSOR-ID                 PIC X(4).
   186
   187     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   188
   189     12  PI-MEMBER-CAPTION               PIC X(10).
   190
   191     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   192         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   193
   194     12  PI-LIFE-OVERRIDE-L1             PIC X.
   195     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   196     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   197     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   198
   199     12  PI-AH-OVERRIDE-L1               PIC X.
   200     12  PI-AH-OVERRIDE-L2               PIC XX.
   201     12  PI-AH-OVERRIDE-L6               PIC X(6).
   202     12  PI-AH-OVERRIDE-L12              PIC X(12).
   203
   204     12  PI-NEW-SYSTEM                   PIC X(2).
   205
   206     12  PI-PRIMARY-CERT-NO              PIC X(11).
   207     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   208         88  PI-USES-PAID-TO                 VALUE '1'.
   209     12  PI-CRDTCRD-SYSTEM.
   210         16  PI-CRDTCRD-USER             PIC X.
   211             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   212             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   213         16  PI-CC-MONTH-END-DT          PIC XX.
   214     12  PI-PROCESSOR-PRINTER            PIC X(4).
   215
   216     12  PI-OE-REFERENCE-2.
   217         16  PI-OE-REF-2-PRIME           PIC X(10).
   218         16  PI-OE-REF-2-SUFF            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL1522.cbl
   219
   220     12  PI-REM-TRM-CALC-OPTION          PIC X.
   221
   222     12  PI-LANGUAGE-TYPE                PIC X.
   223             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   224             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   225             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   226
   227     12  PI-POLICY-LINKAGE-IND           PIC X.
   228         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   229         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   230                                                   LOW-VALUES.
   231
   232     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   233     12  PI-CLAIM-PW-SESSION             PIC X(1).
   234         88  PI-CLAIM-CREDIT                 VALUE '1'.
   235         88  PI-CLAIM-CONVEN                 VALUE '2'.
   236     12  FILLER                          PIC X(4).
   237
   238     12  PI-SYSTEM-LEVEL                 PIC X(145).
   239
   240     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   241         PI-SYSTEM-LEVEL.
   242
   243         16  PI-ENTRY-CODES.
   244             20  PI-ENTRY-CD-1           PIC X.
   245             20  PI-ENTRY-CD-2           PIC X.
   246
   247         16  PI-RETURN-CODES.
   248             20  PI-RETURN-CD-1          PIC X.
   249             20  PI-RETURN-CD-2          PIC X.
   250
   251         16  PI-UPDATE-STATUS-SAVE.
   252             20  PI-UPDATE-BY            PIC X(4).
   253             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   254
   255         16  PI-LOWER-CASE-LETTERS       PIC X.
   256             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   257
   258*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   259*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   260*            88  CARRIER-CLM-CNTL            VALUE '2'.
   261
   262         16  PI-CERT-ACCESS-CONTROL      PIC X.
   263             88  ST-ACCNT-CNTL               VALUE ' '.
   264             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   265             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   266             88  ACCNT-CNTL                  VALUE '3'.
   267             88  CARR-ACCNT-CNTL             VALUE '4'.
   268
   269         16  PI-PROCESSOR-CAP-LIST.
   270             20  PI-SYSTEM-CONTROLS.
   271                24 PI-SYSTEM-DISPLAY     PIC X.
   272                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   273                24 PI-SYSTEM-MODIFY      PIC X.
   274                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   275             20  FILLER                  PIC XX.
   276             20  PI-DISPLAY-CAP          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL1522.cbl
   277                 88  DISPLAY-CAP             VALUE 'Y'.
   278             20  PI-MODIFY-CAP           PIC X.
   279                 88  MODIFY-CAP              VALUE 'Y'.
   280             20  PI-MSG-AT-LOGON-CAP     PIC X.
   281                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   282             20  PI-FORCE-CAP            PIC X.
   283                 88  FORCE-CAP               VALUE 'Y'.
   284
   285         16  PI-PROGRAM-CONTROLS.
   286             20  PI-PGM-PRINT-OPT        PIC X.
   287             20  PI-PGM-FORMAT-OPT       PIC X.
   288             20  PI-PGM-PROCESS-OPT      PIC X.
   289             20  PI-PGM-TOTALS-OPT       PIC X.
   290
   291         16  PI-HELP-INTERFACE.
   292             20  PI-LAST-ERROR-NO        PIC X(4).
   293             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   294
   295         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   296             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   297
   298         16  PI-CR-CONTROL-IN-PROGRESS.
   299             20  PI-CR-CARRIER           PIC X.
   300             20  PI-CR-GROUPING          PIC X(6).
   301             20  PI-CR-STATE             PIC XX.
   302             20  PI-CR-ACCOUNT           PIC X(10).
   303             20  PI-CR-FIN-RESP          PIC X(10).
   304             20  PI-CR-TYPE              PIC X.
   305
   306         16  PI-CR-BATCH-NUMBER          PIC X(6).
   307
   308         16  PI-CR-MONTH-END-DT          PIC XX.
   309
   310         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   311             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   312             88  PI-ZERO-CARRIER             VALUE '1'.
   313             88  PI-ZERO-GROUPING            VALUE '2'.
   314             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   315
   316         16  PI-CARRIER-SECURITY         PIC X.
   317             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   318
   319         16  PI-ACCOUNT-SECURITY         PIC X(10).
   320             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   321             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   322
   323         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   324             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   325                                         INDEXED BY PI-ACCESS-NDX
   326                                         PIC X.
   327
   328         16  PI-GA-BILLING-CONTROL       PIC X.
   329             88  PI-GA-BILLING               VALUE '1'.
   330
   331         16  PI-MAIL-PROCESSING          PIC X.
   332             88  PI-MAIL-YES                 VALUE 'Y'.
   333
   334         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL1522.cbl
   335
   336         16  PI-AR-SYSTEM.
   337             20  PI-AR-PROCESSING-CNTL   PIC X.
   338                 88  PI-AR-PROCESSING        VALUE 'Y'.
   339             20  PI-AR-SUMMARY-CODE      PIC X(6).
   340             20  PI-AR-MONTH-END-DT      PIC XX.
   341
   342         16  PI-MP-SYSTEM.
   343             20  PI-MORTGAGE-USER            PIC X.
   344                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   345                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   346             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   347                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   348                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   349                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   350                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   351                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   352             20  PI-MP-MONTH-END-DT          PIC XX.
   353             20  PI-MP-REFERENCE-NO.
   354                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   355                 24  PI-MP-REFERENCE-SFX     PIC XX.
   356
   357         16  PI-LABEL-CONTROL            PIC X(01).
   358             88  PI-CREATE-LABELS                    VALUE 'Y'.
   359             88  PI-BYPASS-LABELS                    VALUE 'N'.
   360
   361         16  PI-BILL-GROUPING-CODE       PIC X(01).
   362             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   363
   364         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   365             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   366             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   367
   368         16  FILLER                      PIC X(14).
   369
   370     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   371******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL1522.cbl
   372/
   373     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL1522.cbl
   374/
   375*        COPY ELC1042.
   376******************************************************************
   377*                                                                *
   378*                                                                *
   379*                           ELC1042                              *
   380*                            VMOD=2.002                          *
   381*                                                                *
   382*    NOTE                                                        *
   383*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
   384*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
   385*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
   386*        TO THESE PROGRAMS.                                      *
   387*                                                                *
   388*    NOTE                                                        *
   389*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
   390*        USE ONLY!                                               *
   391*                                                                *
   392******************************************************************
   393
   394         16  PI-1042-WA.
   395             20  PI-ACTION       PIC  X(01).
   396                 88 PI-SHOW-MODE           VALUE '1'.
   397                 88 PI-CLEAR-MODE          VALUE '2'.
   398                 88 PI-CREATE-MODE         VALUE '3'.
   399             20  PI-COMM-CONTROL PIC  X(12).
   400             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
   401             20  PI-EOF-SW       PIC  X(01).
   402                 88  PI-FILE-EOF           VALUE 'Y'.
   403             20  PI-FILETYP      PIC  X(01).
   404             20  PI-FORM-SQUEEZE-CONTROL
   405                                 PIC  X(01).
   406                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
   407                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
   408             20  PI-LAST-CONTROL PIC  X(12).
   409             20  PI-TEMP-STOR-ITEMS
   410                                 PIC S9(04) COMP.
   411             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
   412             20  PI-UPDATE-SW    PIC  9(01).
   413                 88 ANY-UPDATES            VALUE 1.
   414             20  PI-104-SCREEN-SENT-IND
   415                                 PIC  X(01).
   416                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
   417                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
   418             20  PI-1042-SCREEN-SENT-IND
   419                                 PIC  X(01).
   420                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
   421                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
   422             20  PI-1042-ARCHIVE-IND
   423                                 PIC  X(01).
   424                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
   425             20  FILLER          PIC  X(29).
   426**********************************************************
   427*    NOTE                                                *
   428*        THE WORK AREA IS USED BY EL152 AND EL1522       *
   429*        AND CANNOT BE REARRANGED WITHOUT COMPILING      *
   430*        BOTH PROGRAMS.                                  *
   431*                                                        *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL1522.cbl
   432**********************************************************
   433         16  PI-EL152-WA.
   434             20  PI-ALT-PRINTER-ID        PIC X(4).
   435             20  PI-ARCHIVE-NUMBER        PIC 9(8).
   436             20  PI-FORM-NUMBER           PIC X(4).
   437             20  PI-ADDR-TYPE             PIC XX.
   438             20  PI-TEMP-STOR-ID          PIC X(8).
   439             20  PI-NUM-PRINT-COPIES      PIC 9.
   440             20  PI-ADDR-SEQ              PIC S9(4)   COMP.
   441             20  PI-PRINT-SW              PIC  X.
   442                 88 PRINT-PERFORMED     VALUE '1'.
   443             20  FILLER                   PIC X(543).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL1522.cbl
   445*                                COPY ELPRTCVD.
   446*****************************************************************
   447*                                                               *
   448*                            ELPRTCVD.                          *
   449*                            VMOD=2.001                         *
   450*****************************************************************.
   451
   452******************************************************************
   453***   WORK AREAS  FOR TERMINAL ONLINE PRINT ROUTINE
   454***                 -ELPRTCVD-
   455***   TO BE USED WITH PROCEDURE COPY MEMBER -ELPRTCVP-
   456******************************************************************
   457
   458 01  S-WORK-AREA                     SYNC.
   459     12  WS-LINE-LEN                 PIC S9(4)       VALUE +80
   460                                     COMP.
   461
   462     12  WS-LINE-LENGTH              PIC S9(4)       VALUE ZERO
   463                                     COMP.
   464
   465     12  WS-BUFFER-SIZE              PIC S9(4)       VALUE +1916
   466                                     COMP.
   467
   468     12  WS-BUFFER-LENGTH            PIC S9(4)       VALUE ZERO
   469                                     COMP.
   470
   471     12  WS-PROG-END                 PIC X           VALUE SPACES.
   472
   473     12  WS-PRINT-AREA.
   474         16  WS-PASSED-CNTL-CHAR     PIC X           VALUE SPACES.
   475           88  SINGLE-SPACE                          VALUE ' '.
   476           88  DOUBLE-SPACE                          VALUE '0'.
   477           88  TRIPLE-SPACE                          VALUE '-'.
   478           88  TOP-PAGE                              VALUE '1'.
   479
   480         16  WS-PASSED-DATA.
   481             20  WS-PRINT-BYTE       PIC X
   482                 OCCURS 132 TIMES    INDEXED BY PRT-INDEX.
   483
   484     12  WS-LINE-CNT                 PIC S9(3)        VALUE ZERO
   485                                     COMP-3.
   486     12  WS-WCC-CNTL                 PIC X(1)         VALUE 'H'.
   487
   488     12  WS-EM                       PIC S9(4)        VALUE +25
   489                                     COMP.
   490     12  FILLER   REDEFINES WS-EM.
   491         16  FILLER                  PIC X.
   492         16  T-EM                    PIC X.
   493
   494*    12  WS-SS                       PIC S9(4)        VALUE +21
   495     12  WS-SS                       PIC S9(4)        VALUE +10
   496                                     COMP.
   497     12  FILLER   REDEFINES WS-SS.
   498         16  FILLER                  PIC X.
   499         16  T-SS                    PIC X.
   500
   501     12  WS-TP                       PIC S9(4)      VALUE +12
   502                                     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL1522.cbl
   503     12  FILLER   REDEFINES WS-TP.
   504         16  FILLER                  PIC X.
   505         16  T-TP                    PIC X.
   506
   507     12  WS-FIRST-TIME-SW            PIC X           VALUE '1'.
   508         88  FIRST-TIME                              VALUE '1'.
   509         88  FIRST-LINE-NEXT-BUFFER                  VALUE '2'.
   510
   511     12  WS-BUFFER-AREA.
   512         16  WS-BUFFER-BYTE          PIC X
   513             OCCURS 1920 TIMES       INDEXED BY BUFFER-INDEX
   514                                                BUFFER-INDEX2.
   515
   516******************************************************************
   517
   518 01  WS-DATA-SHIFT-AREA.
   519     12  WS-DATA-FIL             PIC X(7).
   520     12  WS-DATA-SHIFT           PIC X(125).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL1522.cbl
   522****************************************************************
   523*
   524* Copyright (c) 2007 by Clerity Solutions, Inc.
   525* All rights reserved.
   526*
   527****************************************************************
   528 01  DFHEIV.
   529   02  DFHEIV0               PIC X(35).
   530   02  DFHEIV1               PIC X(08).
   531   02  DFHEIV2               PIC X(08).
   532   02  DFHEIV3               PIC X(08).
   533   02  DFHEIV4               PIC X(06).
   534   02  DFHEIV5               PIC X(04).
   535   02  DFHEIV6               PIC X(04).
   536   02  DFHEIV7               PIC X(02).
   537   02  DFHEIV8               PIC X(02).
   538   02  DFHEIV9               PIC X(01).
   539   02  DFHEIV10              PIC S9(7) COMP-3.
   540   02  DFHEIV11              PIC S9(4) COMP SYNC.
   541   02  DFHEIV12              PIC S9(4) COMP SYNC.
   542   02  DFHEIV13              PIC S9(4) COMP SYNC.
   543   02  DFHEIV14              PIC S9(4) COMP SYNC.
   544   02  DFHEIV15              PIC S9(4) COMP SYNC.
   545   02  DFHEIV16              PIC S9(9) COMP SYNC.
   546   02  DFHEIV17              PIC X(04).
   547   02  DFHEIV18              PIC X(04).
   548   02  DFHEIV19              PIC X(04).
   549   02  DFHEIV20              USAGE IS POINTER.
   550   02  DFHEIV21              USAGE IS POINTER.
   551   02  DFHEIV22              USAGE IS POINTER.
   552   02  DFHEIV23              USAGE IS POINTER.
   553   02  DFHEIV24              USAGE IS POINTER.
   554   02  DFHEIV25              PIC S9(9) COMP SYNC.
   555   02  DFHEIV26              PIC S9(9) COMP SYNC.
   556   02  DFHEIV27              PIC S9(9) COMP SYNC.
   557   02  DFHEIV28              PIC S9(9) COMP SYNC.
   558   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   559   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   560   02  FILLER                PIC X(02).
   561   02  DFHEIV99              PIC X(08) VALUE SPACE.
   562   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   563   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   564   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   565   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   566 LINKAGE  SECTION.
   567*****************************************************************
   568*                                                               *
   569* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   570* All rights reserved.                                          *
   571*                                                               *
   572*****************************************************************
   573 01  dfheiblk.
   574     02  eibtime          pic s9(7) comp-3.
   575     02  eibdate          pic s9(7) comp-3.
   576     02  eibtrnid         pic x(4).
   577     02  eibtaskn         pic s9(7) comp-3.
   578     02  eibtrmid         pic x(4).
   579     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL1522.cbl
   580     02  eibcposn         pic s9(4) comp.
   581     02  eibcalen         pic s9(4) comp.
   582     02  eibaid           pic x(1).
   583     02  eibfiller1       pic x(1).
   584     02  eibfn            pic x(2).
   585     02  eibfiller2       pic x(2).
   586     02  eibrcode         pic x(6).
   587     02  eibfiller3       pic x(2).
   588     02  eibds            pic x(8).
   589     02  eibreqid         pic x(8).
   590     02  eibrsrce         pic x(8).
   591     02  eibsync          pic x(1).
   592     02  eibfree          pic x(1).
   593     02  eibrecv          pic x(1).
   594     02  eibsend          pic x(1).
   595     02  eibatt           pic x(1).
   596     02  eibeoc           pic x(1).
   597     02  eibfmh           pic x(1).
   598     02  eibcompl         pic x(1).
   599     02  eibsig           pic x(1).
   600     02  eibconf          pic x(1).
   601     02  eiberr           pic x(1).
   602     02  eibrldbk         pic x(1).
   603     02  eiberrcd         pic x(4).
   604     02  eibsynrb         pic x(1).
   605     02  eibnodat         pic x(1).
   606     02  eibfiller5       pic x(2).
   607     02  eibresp          pic 9(09) comp.
   608     02  eibresp2         pic 9(09) comp.
   609     02  dfheigdj         pic s9(4) comp.
   610     02  dfheigdk         pic s9(4) comp.
   611 01  DFHCOMMAREA       PIC X(01).
   612 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
   613 0000-DFHEXIT SECTION.
   614     MOVE '9#                    $   ' TO DFHEIV0.
   615     MOVE 'EL1522' TO DFHEIV1.
   616     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   617
   618     MOVE +132                   TO  WS-LINE-LEN.
   619     MOVE SPACES                 TO  DL34-PROCESS-TYPE.
   620     MOVE 'N'                    TO  WS-REPORT-STARTED-SW.
   621
   622 0100-RETRIEVE-LOOP.
   623
   624
   625* EXEC CICS HANDLE CONDITION
   626*         ENDDATA(200-END-DATA)
   627*         NOTFND (300-NOT-FOUND)
   628*    END-EXEC.
   629*    MOVE '"$&I                  ! " #00000620' TO DFHEIV0
   630     MOVE X'222426492020202020202020' TO DFHEIV0(1:12)
   631     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
   632     MOVE X'2220233030303030363230' TO DFHEIV0(25:11)
   633     CALL 'kxdfhei1' USING DFHEIV0
   634     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   635
   636
   637
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL1522.cbl
   638* EXEC CICS RETRIEVE
   639*         INTO  (PROGRAM-INTERFACE-BLOCK)
   640*         LENGTH(PI-COMM-LENGTH)
   641*    END-EXEC.
   642*    MOVE '0*I L                 &   #00000625' TO DFHEIV0
   643     MOVE X'302A49204C20202020202020' TO DFHEIV0(1:12)
   644     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   645     MOVE X'2020233030303030363235' TO DFHEIV0(25:11)
   646     CALL 'kxdfhei1' USING DFHEIV0,
   647           PROGRAM-INTERFACE-BLOCK,
   648           PI-COMM-LENGTH,
   649           DFHEIV99,
   650           DFHEIV99,
   651           DFHEIV99
   652     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   653
   654
   655* DLO034 OPEN WHEN DMD OR CID
   656     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
   657         IF DL34-PROCESS-TYPE = SPACES
   658             MOVE 'O'                TO DL34-PROCESS-TYPE
   659             MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
   660             MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
   661             MOVE PI-PROCESSOR-ID    TO DL34-USERID
   662             MOVE SPACES             TO DL34-PRINT-LINE
   663             MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
   664
   665* EXEC CICS LINK
   666*                PROGRAM    ('DLO034')
   667*                COMMAREA   (DLO034-COMMUNICATION-AREA)
   668*                LENGTH     (DLO034-REC-LENGTH)
   669*            END-EXEC
   670     MOVE 'DLO034' TO DFHEIV1
   671*    MOVE '."C                   ''   #00000639' TO DFHEIV0
   672     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
   673     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   674     MOVE X'2020233030303030363339' TO DFHEIV0(25:11)
   675     CALL 'kxdfhei1' USING DFHEIV0,
   676           DFHEIV1,
   677           DLO034-COMMUNICATION-AREA,
   678           DLO034-REC-LENGTH,
   679           DFHEIV99,
   680           DFHEIV99,
   681           DFHEIV99
   682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   683             IF DL34-RETURN-CODE NOT = 'OK'
   684                 MOVE  '**DLO034 OPEN ERROR - ABORT**'
   685                                     TO ERROR-LINE
   686                 PERFORM 400-SEND-TEXT
   687
   688* EXEC CICS RETURN
   689*                END-EXEC.
   690*    MOVE '.(                    &   #00000648' TO DFHEIV0
   691     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
   692     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   693     MOVE X'2020233030303030363438' TO DFHEIV0(25:11)
   694     CALL 'kxdfhei1' USING DFHEIV0,
   695           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL1522.cbl
   696           DFHEIV99,
   697           DFHEIV99,
   698           DFHEIV99,
   699           DFHEIV99
   700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   701
   702
   703     IF PI-CALLING-PROGRAM = PGM-EL152
   704        GO TO 1000-PRINT-EL152.
   705
   706     GO TO 0100-RETRIEVE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL1522.cbl
   708 200-END-DATA.
   709
   710*    MOVE 'L'                    TO DRS-SW.
   711*    PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
   712
   713     MOVE 'EX27'                 TO WS-NEXT-TRAN.
   714
   715     MOVE EIBTRMID               TO WS-TERMINAL-ID.
   716
   717* DLO034 CLOSE
   718     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
   719         MOVE 'C'                TO DL34-PROCESS-TYPE
   720         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
   721         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
   722         MOVE PI-PROCESSOR-ID    TO DL34-USERID
   723         MOVE SPACES             TO DL34-PRINT-LINE
   724                                    DL34-OVERRIDE-PRINTER-ID
   725
   726* EXEC CICS LINK
   727*            PROGRAM    ('DLO034')
   728*            COMMAREA   (DLO034-COMMUNICATION-AREA)
   729*            LENGTH     (DLO034-REC-LENGTH)
   730*        END-EXEC
   731     MOVE 'DLO034' TO DFHEIV1
   732*    MOVE '."C                   ''   #00000673' TO DFHEIV0
   733     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
   734     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   735     MOVE X'2020233030303030363733' TO DFHEIV0(25:11)
   736     CALL 'kxdfhei1' USING DFHEIV0,
   737           DFHEIV1,
   738           DLO034-COMMUNICATION-AREA,
   739           DLO034-REC-LENGTH,
   740           DFHEIV99,
   741           DFHEIV99,
   742           DFHEIV99
   743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   744         IF DL34-RETURN-CODE NOT = 'OK'
   745             MOVE  '**DLO034 CLOSE ERROR - ABORT**'
   746                                 TO ERROR-LINE
   747             PERFORM 400-SEND-TEXT
   748
   749* EXEC CICS RETURN
   750*                 TRANSID  (WS-NEXT-TRAN)
   751*                 COMMAREA (PROGRAM-INTERFACE-BLOCK)
   752*                 LENGTH   (PI-COMM-LENGTH)
   753*            END-EXEC.
   754*    MOVE '.(CT                  &   #00000682' TO DFHEIV0
   755     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
   756     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   757     MOVE X'2020233030303030363832' TO DFHEIV0(25:11)
   758     CALL 'kxdfhei1' USING DFHEIV0,
   759           WS-NEXT-TRAN,
   760           PROGRAM-INTERFACE-BLOCK,
   761           PI-COMM-LENGTH,
   762           DFHEIV99,
   763           DFHEIV99
   764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   765
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL1522.cbl
   766
   767     IF WS-TERM-PREFIX = 'DU'
   768
   769* EXEC CICS RETURN
   770*            TRANSID  (WS-NEXT-TRAN)
   771*            COMMAREA (PROGRAM-INTERFACE-BLOCK)
   772*            LENGTH   (PI-COMM-LENGTH)
   773*       END-EXEC
   774*    MOVE '.(CT                  &   #00000689' TO DFHEIV0
   775     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
   776     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   777     MOVE X'2020233030303030363839' TO DFHEIV0(25:11)
   778     CALL 'kxdfhei1' USING DFHEIV0,
   779           WS-NEXT-TRAN,
   780           PROGRAM-INTERFACE-BLOCK,
   781           PI-COMM-LENGTH,
   782           DFHEIV99,
   783           DFHEIV99
   784     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   785       ELSE
   786
   787* EXEC CICS RETURN
   788*       END-EXEC.
   789*    MOVE '.(                    &   #00000695' TO DFHEIV0
   790     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
   791     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   792     MOVE X'2020233030303030363935' TO DFHEIV0(25:11)
   793     CALL 'kxdfhei1' USING DFHEIV0,
   794           DFHEIV99,
   795           DFHEIV99,
   796           DFHEIV99,
   797           DFHEIV99,
   798           DFHEIV99
   799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   800
   801
   802 300-NOT-FOUND.
   803     IF PI-COMPANY-ID NOT = 'MON'
   804         MOVE 'NO COMMUNICATION AREA FOUND' TO ERROR-LINE
   805         PERFORM 400-SEND-TEXT.
   806
   807     GO TO 200-END-DATA.
   808
   809 400-SEND-TEXT.
   810
   811* EXEC CICS SEND TEXT
   812*         FROM(ERROR-LINE)
   813*         LENGTH(70)
   814*    END-EXEC.
   815     MOVE 70
   816       TO DFHEIV11
   817*    MOVE '8&      T       H   F -   #00000706' TO DFHEIV0
   818     MOVE X'382620202020202054202020' TO DFHEIV0(1:12)
   819     MOVE X'202020204820202046202D20' TO DFHEIV0(13:12)
   820     MOVE X'2020233030303030373036' TO DFHEIV0(25:11)
   821     CALL 'kxdfhei1' USING DFHEIV0,
   822           ERROR-LINE,
   823           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL1522.cbl
   824           DFHEIV99,
   825           DFHEIV99,
   826           DFHEIV99,
   827           DFHEIV99,
   828           DFHEIV99,
   829           DFHEIV99,
   830           DFHEIV99,
   831           DFHEIV99,
   832           DFHEIV99,
   833           DFHEIV99
   834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   835
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL1522.cbl
   837 1000-PRINT-EL152.
   838
   839* EXEC CICS HANDLE CONDITION
   840*         QIDERR (1090-TS-QIDERR)
   841*         ITEMERR(1089-TS-ITEMERR)
   842*    END-EXEC.
   843*    MOVE '"$N<                  ! # #00000712' TO DFHEIV0
   844     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
   845     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
   846     MOVE X'2320233030303030373132' TO DFHEIV0(25:11)
   847     CALL 'kxdfhei1' USING DFHEIV0
   848     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   849
   850
   851     SUBTRACT 7 FROM PI-TOTAL-LINES.
   852
   853*    MOVE PI-TEMP-STOR-ID  TO  WS-CSO-TEMP-STOR-ID.
   854*    IF REPORT-STARTED
   855*      MOVE 'L'  TO  DRS-SW
   856*      PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
   857*    MOVE 'F'     TO  DRS-SW.
   858*    PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
   859*    MOVE ' '     TO  DRS-SW.
   860
   861
   862 1005-READ-TEMP.
   863     PERFORM 1010-TEMP-READ THRU 1019-EXIT
   864             VARYING TS-ITEM FROM 1 BY 1 UNTIL
   865             TS-ITEM GREATER THAN PI-TEMP-STOR-ITEMS.
   866
   867     MOVE 'X'                    TO WS-PROG-END.
   868
   869     IF PI-COMPANY-ID NOT = 'DMD' AND 'XXX'
   870         PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
   871
   872     MOVE ZEROS                  TO RECORDS-PRINTED.
   873     SUBTRACT 1 FROM PI-NUM-PRINT-COPIES.
   874
   875     IF PI-NUM-PRINT-COPIES = 0
   876        PERFORM 7750-DELETE-TEMP-STOR THRU 7750-EXIT
   877        GO TO 0100-RETRIEVE-LOOP.
   878
   879     GO TO 1005-READ-TEMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL1522.cbl
   881 1010-TEMP-READ.
   882
   883* EXEC CICS READQ TS
   884*         INTO  (TS-WORK-AREA)
   885*         QUEUE (PI-TEMP-STOR-ID)
   886*         LENGTH(TS-LENGTH)
   887*         ITEM  (TS-ITEM)
   888*    END-EXEC.
   889*    MOVE '*$II   L              ''   #00000748' TO DFHEIV0
   890     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
   891     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   892     MOVE X'2020233030303030373438' TO DFHEIV0(25:11)
   893     CALL 'kxdfhei1' USING DFHEIV0,
   894           PI-TEMP-STOR-ID,
   895           TS-WORK-AREA,
   896           TS-LENGTH,
   897           TS-ITEM,
   898           DFHEIV99,
   899           DFHEIV99
   900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   901
   902
   903     IF TS-ITEM = 1
   904        MOVE TOP-FORM            TO WS-PASSED-CNTL-CHAR
   905        PERFORM 1020-RECORD-PRINT THRU 1029-EXIT
   906                VARYING TB-INDX FROM 8 BY 1 UNTIL
   907                 TB-INDX GREATER THAN NUM-ENTRIES-PER-RECORD
   908        ELSE
   909        PERFORM 1020-RECORD-PRINT THRU 1029-EXIT
   910                VARYING TB-INDX FROM 1 BY 1 UNTIL
   911                TB-INDX GREATER THAN NUM-ENTRIES-PER-RECORD.
   912
   913 1019-EXIT.
   914      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL1522.cbl
   916 1020-RECORD-PRINT.
   917     IF REC-TEXT-TOP (TB-INDX) = TOP-OF-FORM-MESSAGE
   918        MOVE TOP-FORM            TO WS-PASSED-CNTL-CHAR
   919        ADD 1                    TO RECORDS-PRINTED
   920        SET TB-INDX UP BY 1
   921        GO TO 1029-EXIT.
   922
   923     IF PI-COMPANY-ID = 'MON'
   924         MOVE SPACES             TO WS-DATA-SHIFT-AREA
   925         MOVE REC-TEXT (TB-INDX) TO WS-DATA-SHIFT
   926         MOVE WS-DATA-SHIFT-AREA TO WS-PASSED-DATA
   927       ELSE
   928         MOVE REC-TEXT (TB-INDX) TO WS-PASSED-DATA.
   929
   930     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
   931     MOVE SPACE                  TO WS-PASSED-CNTL-CHAR.
   932     ADD 1                       TO RECORDS-PRINTED.
   933
   934     IF RECORDS-PRINTED = PI-TOTAL-LINES
   935        SET TB-INDX TO NUM-ENTRIES-PER-RECORD
   936        SET TB-INDX UP BY 1
   937        GO TO 1029-EXIT.
   938
   939 1029-EXIT.
   940      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL1522.cbl
   942 1089-TS-ITEMERR.
   943     MOVE 'TEMP STORAGE RECORD NOT FOUND' TO ERROR-LINE.
   944     PERFORM 400-SEND-TEXT.
   945     GO TO 0100-RETRIEVE-LOOP.
   946
   947 1090-TS-QIDERR.
   948*    MOVE 'NO TEMP STORAGE RECORDS NOT FOUND' TO ERROR-LINE.
   949     MOVE 'TEMP STORAGE REC NOT FOUND '
   950                                 TO ERROR-LINE
   951     MOVE PI-TEMP-STOR-ID        TO ERROR-LINE (30:8)
   952     PERFORM 400-SEND-TEXT.
   953     GO TO 0100-RETRIEVE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL1522.cbl
   955 7750-DELETE-TEMP-STOR.
   956
   957* EXEC CICS HANDLE CONDITION
   958*         QIDERR(7750-EXIT)
   959*    END-EXEC.
   960*    MOVE '"$N                   ! $ #00000808' TO DFHEIV0
   961     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
   962     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
   963     MOVE X'2420233030303030383038' TO DFHEIV0(25:11)
   964     CALL 'kxdfhei1' USING DFHEIV0
   965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   966
   967
   968
   969* EXEC CICS DELETEQ TS
   970*         QUEUE(PI-TEMP-STOR-ID)
   971*    END-EXEC.
   972*    MOVE '*&                    #   #00000812' TO DFHEIV0
   973     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
   974     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
   975     MOVE X'2020233030303030383132' TO DFHEIV0(25:11)
   976     CALL 'kxdfhei1' USING DFHEIV0,
   977           PI-TEMP-STOR-ID,
   978           DFHEIV99
   979     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   980
   981
   982 7750-EXIT.
   983     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL1522.cbl
   985*                          COPY ELPRTCVP.
   986*9800-PRINT-ROUTINE.       COPY ELPRTCVP.
   987 9800-PRINT-ROUTINE.
   988*    COPY ELPRTCVP.
   989******************************************************************
   990***                                                              *
   991***                          ELPRTCVP.                           *
   992***                          VMOD=2.003                          *
   993***                                                              *
   994***     COPY MEMBER FOR TERMINAL ONLINE PRINT ROUTINE.           *
   995***     THIS ROUTINE WILL ACCOMODATE PRINTING TO A 3270          *
   996***     TERMINAL PRINTER. A BUFFER OF UP TO 1920 CHARACTERS      *
   997***     IS ACCUMULATED AND PRINTED COLLECTIVELY.                 *
   998***                                                              *
   999***     THIS ROUTINE TO BE USED ONLY WITH ACCOMPANIMENT          *
  1000***      OF THE WORKING-STORAGE COPY MEMBER ( ELPRTCVD )         *
  1001***     THE HOST PROGRAM MUST INITIALIZE THE FOLLOWING 3 FIELDS  *
  1002***      FROM THE ABOVE COPY MEMBER FOR THIS PROCEDURE TO BE     *
  1003***      SUCCESSFUL.                                             *
  1004***      05  WS-LINE-LEN    PIC  S9(4)  COMP  VALUE +80.         *
  1005***                         LENGTH OF THE LINE TO BE PRINTED     *
  1006***                         DEFAULT IS 80, YOU CAN USE ANY NUMBER*
  1007***                         UP TO 132.  THIS FIELD IS ONLY ACCEP-*
  1008***                         TED THE FIRST TIME THRU THE ROUTINE. *
  1009***      05  WS-PROG-END    PIC  X  VALUE SPACES.                *
  1010***                         PROGRAM END SWITCH. INITIALIZED      *
  1011***                         TO SPACE-     MOVE IN ANY NONBLANK   *
  1012***                         TO IT WHEN PROGRAM IS FINISHED.      *
  1013***      05  WS-PRINT-AREA.                                      *
  1014***          10  WS-PASSED-CNTL-CHAR     PIC X.                  *
  1015***          10  WS-PASSED-DATA          PIC X(132).             *
  1016***                         USE THE DATA TO BE PRINTED IN THE    *
  1017***                         WS-PASSED-DATA.                      *
  1018***                         USE THE STANDARD CARRIAGE CONTROL    *
  1019***                         CHARACTER IN THE WS-PASSED-CNTL-CHAR *
  1020***                           SINGLE-SPACE            VALUE ' '  *
  1021***                           DOUBLE-SPACE            VALUE '0'  *
  1022***                           TRIPLE-SPACE            VALUE '-'  *
  1023***                           TOP-PAGE                VALUE '1'  *
  1024***      NOTE: A LINE COUNT IS PROVIDED IN FIELDNAME -WS-LINE-CNT*
  1025***            THE USE OF THIS FIELD IS OPTIONAL.                *
  1026***            THIS ROUTINE WILL ONLY ADD 1, 2, OR 3             *
  1027***            TO THIS COUNT DEPENDING ON THE WS-PASSED-CNTL-CHAR*
  1028***            AND RESET THE COUNT TO ZERO WHEN TOP-PAGE         *
  1029***            CONDITION.                                        *
  1030***                                                              *
  1031******************************************************************
  1032
  1033 ELPRTCVP.
  1034
  1035*    IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'CID'
  1036     IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'XXX'
  1037         MOVE 'P'                TO DL34-PROCESS-TYPE
  1038         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1039         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1040         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1041         MOVE WS-PRINT-AREA      TO DL34-PRINT-LINE
  1042         MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL1522.cbl
  1043
  1044
  1045* EXEC CICS LINK
  1046*            PROGRAM    ('DLO034')
  1047*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  1048*            LENGTH     (DLO034-REC-LENGTH)
  1049*        END-EXEC
  1050     MOVE 'DLO034' TO DFHEIV1
  1051*    MOVE '."C                   ''   #00000878' TO DFHEIV0
  1052     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1053     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1054     MOVE X'2020233030303030383738' TO DFHEIV0(25:11)
  1055     CALL 'kxdfhei1' USING DFHEIV0,
  1056           DFHEIV1,
  1057           DLO034-COMMUNICATION-AREA,
  1058           DLO034-REC-LENGTH,
  1059           DFHEIV99,
  1060           DFHEIV99,
  1061           DFHEIV99
  1062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1063
  1064            IF DL34-RETURN-CODE = 'OK'
  1065                GO TO ELPRTCVP-EXIT
  1066            ELSE
  1067*               MOVE '8339'     TO EMI-ERROR ?????ERROR MESSAGE???
  1068                GO TO ELPRTCVP-EXIT.
  1069
  1070     IF NOT FIRST-TIME
  1071         GO TO ELPRTCVP-020.
  1072
  1073     IF WS-LINE-LEN NOT GREATER ZERO
  1074         GO TO ELPRTCVP-EXIT.
  1075
  1076     MOVE '2'                    TO WS-FIRST-TIME-SW.
  1077     MOVE LOW-VALUES             TO WS-BUFFER-AREA.
  1078
  1079     SET BUFFER-INDEX TO +1
  1080
  1081     IF EIBTRMID IS EQUAL TO 'AFLP'
  1082         NEXT SENTENCE
  1083     ELSE
  1084         IF NOT TOP-PAGE
  1085             MOVE T-TP           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1086             SET BUFFER-INDEX UP BY +1.
  1087
  1088 ELPRTCVP-020.
  1089     IF WS-PROG-END = SPACES
  1090         GO TO ELPRTCVP-030.
  1091
  1092     MOVE SPACES                 TO WS-PROG-END.
  1093
  1094     IF BUFFER-INDEX GREATER +1
  1095         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  1096
  1097     MOVE '1'                    TO WS-FIRST-TIME-SW.
  1098
  1099     GO TO ELPRTCVP-EXIT.
  1100
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL1522.cbl
  1101 ELPRTCVP-030.
  1102     IF WS-PASSED-DATA = SPACES
  1103         SET PRT-INDEX TO +1
  1104         GO TO ELPRTCVP-050.
  1105
  1106     SET PRT-INDEX TO WS-LINE-LEN.
  1107
  1108 ELPRTCVP-040.
  1109     IF WS-PRINT-BYTE (PRT-INDEX) NOT = SPACES
  1110         GO TO ELPRTCVP-050.
  1111
  1112     IF PRT-INDEX GREATER +1
  1113         SET PRT-INDEX DOWN BY +1
  1114         GO TO ELPRTCVP-040.
  1115
  1116 ELPRTCVP-050.
  1117     SET WS-LINE-LENGTH TO PRT-INDEX.
  1118     SET BUFFER-INDEX2 TO BUFFER-INDEX.
  1119     SET BUFFER-INDEX2 UP BY WS-LINE-LENGTH.
  1120
  1121     IF BUFFER-INDEX2 NOT LESS WS-BUFFER-SIZE
  1122         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  1123
  1124     IF TRIPLE-SPACE
  1125          ADD +2  TO  WS-LINE-CNT
  1126          MOVE T-SS           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1127                                 WS-BUFFER-BYTE (BUFFER-INDEX + 1)
  1128          SET BUFFER-INDEX UP BY +2.
  1129
  1130     IF DOUBLE-SPACE
  1131          ADD +1  TO  WS-LINE-CNT
  1132          MOVE T-SS             TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1133          SET BUFFER-INDEX UP BY +1.
  1134
  1135     ADD +1 TO WS-LINE-CNT
  1136************************************************************
  1137*     BYPASS NEW LINE SYMBOL                               *
  1138*        IF FIRST BUFFER SENT AND TOP-OF-FORM SET.         *
  1139*     OR IF FIRST LINE OF SUBSEQUENT BUFFERS.              *
  1140************************************************************
  1141
  1142     IF (BUFFER-INDEX GREATER +1 AND
  1143         WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-TP)  OR
  1144         FIRST-LINE-NEXT-BUFFER
  1145         MOVE ZERO               TO WS-FIRST-TIME-SW
  1146     ELSE
  1147         MOVE T-SS               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1148         SET BUFFER-INDEX UP BY +1.
  1149
  1150**   NOTE, SINGLE SPACE IS REQUIRED BEFORE TOP PAGE CHAR
  1151
  1152     IF TOP-PAGE
  1153         MOVE +1                TO WS-LINE-CNT
  1154         MOVE T-TP              TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1155         SET BUFFER-INDEX UP BY +1.
  1156
  1157     SET PRT-INDEX TO +1.
  1158
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL1522.cbl
  1159 ELPRTCVP-060.
  1160     MOVE WS-PRINT-BYTE (PRT-INDEX)
  1161                                 TO WS-BUFFER-BYTE (BUFFER-INDEX).
  1162     SET BUFFER-INDEX UP BY +1.
  1163
  1164     IF PRT-INDEX LESS WS-LINE-LENGTH
  1165         SET PRT-INDEX UP BY +1
  1166         GO TO ELPRTCVP-060.
  1167
  1168 ELPRTCVP-EXIT.
  1169     EXIT.
  1170
  1171 ELPRTCVP-PRINT-BUFFER.
  1172     IF WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-SS
  1173        MOVE SPACE               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  1174        SET BUFFER-INDEX UP BY 1.
  1175
  1176     MOVE  T-EM                  TO  WS-BUFFER-BYTE (BUFFER-INDEX)
  1177     SET WS-BUFFER-LENGTH TO BUFFER-INDEX.
  1178
  1179
  1180* EXEC CICS SEND
  1181*        FROM    (WS-BUFFER-AREA)
  1182*        LENGTH  (WS-BUFFER-LENGTH)
  1183*        CTLCHAR (WS-WCC-CNTL)
  1184*        ERASE
  1185*    END-EXEC.
  1186*    MOVE '$$    C E         L F ,   #00000999' TO DFHEIV0
  1187     MOVE X'242420202020432045202020' TO DFHEIV0(1:12)
  1188     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
  1189     MOVE X'2020233030303030393939' TO DFHEIV0(25:11)
  1190     CALL 'kxdfhei1' USING DFHEIV0,
  1191           WS-BUFFER-AREA,
  1192           WS-BUFFER-LENGTH,
  1193           DFHEIV99,
  1194           DFHEIV99,
  1195           WS-WCC-CNTL,
  1196           DFHEIV99,
  1197           DFHEIV99,
  1198           DFHEIV99,
  1199           DFHEIV99,
  1200           DFHEIV99,
  1201           DFHEIV99
  1202     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1203
  1204
  1205     SET BUFFER-INDEX TO +1.
  1206     MOVE '2'                    TO WS-FIRST-TIME-SW.
  1207
  1208 ELPRTCVP-PRINT-EXIT.
  1209     EXIT.
  1210
  1211
  1212
  1213 9999-DFHBACK SECTION.
  1214     MOVE '9%                    "   ' TO DFHEIV0
  1215     MOVE 'EL1522' TO DFHEIV1
  1216     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL1522.cbl
  1217     GOBACK.
  1218 9999-DFHEXIT.
  1219     IF DFHEIGDJ EQUAL 0001
  1220         NEXT SENTENCE
  1221     ELSE IF DFHEIGDJ EQUAL 2
  1222         GO TO 200-END-DATA,
  1223               300-NOT-FOUND
  1224         DEPENDING ON DFHEIGDI
  1225     ELSE IF DFHEIGDJ EQUAL 3
  1226         GO TO 1090-TS-QIDERR,
  1227               1089-TS-ITEMERR
  1228         DEPENDING ON DFHEIGDI
  1229     ELSE IF DFHEIGDJ EQUAL 4
  1230         GO TO 7750-EXIT
  1231         DEPENDING ON DFHEIGDI.
  1232     MOVE '9%                    "   ' TO DFHEIV0
  1233     MOVE 'EL1522' TO DFHEIV1
  1234     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1235     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        8384     Code:        3566
