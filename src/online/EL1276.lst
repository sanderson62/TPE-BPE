* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page   1
* EL1276.cbl
* Options: int("EL1276.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL1276.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL1276.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL1276.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL1276.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/13/96 09:59:22.
     7*                            VMOD=2.004.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page   2
* EL1276.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*                                                                *
    21*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    22*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    23*            *                                                   *
    24*            *****************************************************
    25*
    26*REMARKS.    TRANSACTION - EXX6 - CERTIFICATE AND BILLING NOTES.
    27*
    28******************************************************************
    29*                   C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101201    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL127FO FILLER
    38* 092309    2008100900003  AJRA  CERT NOTES MOVED TO NEW SCREEN
    39* 110811  CR2011110800002  PEMA CORRECT SECURITY ISSUE
    40* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
    41******************************************************************
    42 ENVIRONMENT DIVISION.
    43
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page   3
* EL1276.cbl
    45 DATA DIVISION.
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*    EL1276 WORKING STORAGE    *'.
    50 77  FILLER  PIC X(32)  VALUE '************ V/M 2.004 *********'.
    51
    52*    COPY ELCSCTM.
    53******************************************************************
    54*                                                                *
    55*                                                                *
    56*                            ELCSCTM                             *
    57*                            VMOD=2.001                          *
    58*                                                                *
    59*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    60*                                                                *
    61******************************************************************
    62 01  SECURITY-MESSAGE.
    63     12  FILLER                          PIC X(30)
    64            VALUE '** LOGIC SECURITY VIOLATION -'.
    65     12  SM-READ                         PIC X(6).
    66     12  FILLER                          PIC X(5)
    67            VALUE ' PGM='.
    68     12  SM-PGM                          PIC X(6).
    69     12  FILLER                          PIC X(5)
    70            VALUE ' OPR='.
    71     12  SM-PROCESSOR-ID                 PIC X(4).
    72     12  FILLER                          PIC X(6)
    73            VALUE ' TERM='.
    74     12  SM-TERMID                       PIC X(4).
    75     12  FILLER                          PIC XX   VALUE SPACE.
    76     12  SM-JUL-DATE                     PIC 9(5).
    77     12  FILLER                          PIC X    VALUE SPACE.
    78     12  SM-TIME                         PIC 99.99.
    79
    80
    81*    COPY ELCSCRTY.
    82******************************************************************
    83*                                                                *
    84*                                                                *
    85*                            ELCSCRTY                            *
    86*                            VMOD=2.001                          *
    87*                                                                *
    88*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    89*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    90*        SAVED IN PI-SECURITY-ADDRESS.                           *
    91*                                                                *
    92******************************************************************
    93 01  SECURITY-CONTROL.
    94     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    95     12  FILLER                       PIC XX    VALUE 'SC'.
    96     12  SC-CREDIT-CODES.
    97         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    98             20  SC-CREDIT-DISPLAY    PIC X.
    99             20  SC-CREDIT-UPDATE     PIC X.
   100     12  SC-CLAIMS-CODES.
   101         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   102             20  SC-CLAIMS-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page   4
* EL1276.cbl
   103             20  SC-CLAIMS-UPDATE     PIC X.
   104
   105 01  WS-DATE-AREA.
   106     05  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   107     05  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   108
   109 01  STANDARD-AREAS.
   110     12  SC-ITEM                     PIC S9(4)   VALUE +0001 COMP.
   111     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   112     12  MAP-NAME                    PIC X(8)    VALUE 'EL127F'.
   113     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL1276S'.
   114     12  SCREEN-NUMBER               PIC X(4)    VALUE '127F'.
   115     12  TRANS-ID                    PIC X(4)    VALUE 'EXX6'.
   116     12  THIS-PGM                    PIC X(8)    VALUE 'EL1276'.
   117     12  PGM-NAME                    PIC X(8).
   118     12  TIME-IN                     PIC S9(7).
   119     12  TIME-OUT-R  REDEFINES TIME-IN.
   120         16  FILLER                  PIC X.
   121         16  TIME-OUT                PIC 99V99.
   122         16  FILLER                  PIC XX.
   123     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   124     12  XCTL-010                    PIC X(8)    VALUE 'EL010'.
   125     12  XCTL-626                    PIC X(8)    VALUE 'EL626'.
   126     12  PGM-1279                    PIC X(8)    VALUE 'EL1279'.
   127     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   128     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   129     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   130     12  ERNOTE-ID                   PIC X(8)    VALUE 'ERNOTE'.
   131     12  ELCERT-ID                   PIC X(8)    VALUE 'ELCERT'.
   132     12  WS-RECORD-LENGTHS   COMP.
   133         16  WS-ERNOTE-RECORD-LENGTH  PIC S9(4)  VALUE +825.
   134         16  WS-ELCERT-RECORD-LENGTH  PIC S9(4)  VALUE +450.
   135         16  WS-JOURNAL-RECORD-LENGTH PIC S9(4)  VALUE ZEROS.
   136
   137     12  DEEDIT-FIELD                PIC X(15).
   138     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
   139
   140     12  RETURN-FROM                 PIC X(8).
   141     12  QID.
   142         16  QID-TERM                PIC X(4).
   143         16  FILLER                  PIC X(4)    VALUE '127F'.
   144     12  WS-SUB1                     PIC  S99  COMP.
   145     12  WS-NOTE-LINE-SW             PIC  X      VALUE SPACE.
   146         88  NOTE-LINES-PRESENT                  VALUE 'Y'.
   147     12  WS-RECORD-FOUND-SW          PIC  X      VALUE SPACE.
   148         88  RECORD-FOUND                        VALUE 'Y'.
   149         88  RECORD-NOT-FOUND                    VALUE 'N'.
   150     12  WS-DUPREC-SW                PIC  X      VALUE SPACE.
   151         88  DUPLICATE-RECORD-FOUND              VALUE 'Y'.
   152
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page   5
* EL1276.cbl
   154     12  ERROR-MESSAGES.
   155         16  ER-0000                 PIC  X(4)   VALUE '0000'.
   156         16  ER-0004                 PIC  X(4)   VALUE '0004'.
   157         16  ER-0008                 PIC  X(4)   VALUE '0008'.
   158         16  ER-0023                 PIC  X(4)   VALUE '0023'.
   159         16  ER-0029                 PIC  X(4)   VALUE '0029'.
   160         16  ER-0070                 PIC  X(4)   VALUE '0070'.
   161         16  ER-0142                 PIC  X(4)   VALUE '0142'.
   162         16  ER-2520                 PIC  X(4)   VALUE '2520'.
   163         16  ER-2521                 PIC  X(4)   VALUE '2521'.
   164         16  ER-2522                 PIC  X(4)   VALUE '2522'.
   165         16  ER-2523                 PIC  X(4)   VALUE '2523'.
   166         16  ER-2524                 PIC  X(4)   VALUE '2524'.
   167         16  ER-2525                 PIC  X(4)   VALUE '2525'.
   168         16  ER-2528                 PIC  X(4)   VALUE '2528'.
   169         16  ER-2706                 PIC  X(4)   VALUE '2706'.
   170
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page   6
* EL1276.cbl
   172
   173 01  WS-CM-CONTROL-PRIMARY.
   174     05  WS-CM-COMPANY-CD            PIC  X.
   175     05  WS-CM-CARRIER               PIC  X.
   176     05  WS-CM-GROUPING              PIC  X(6).
   177     05  WS-CM-STATE                 PIC  XX.
   178     05  WS-CM-ACCOUNT               PIC  X(10).
   179     05  WS-CM-CERT-EFF-DT           PIC  XX.
   180     05  WS-CM-CERT-NO.
   181         10  WS-CM-CERT-PRIME        PIC  X(10).
   182         10  WS-CM-CERT-SFX          PIC  X.
   183
   184 01  WS-CN-CONTROL-PRIMARY.
   185     05  WS-CN-COMPANY-CD            PIC  X.
   186     05  WS-CN-CARRIER               PIC  X.
   187     05  WS-CN-GROUPING              PIC  X(6).
   188     05  WS-CN-STATE                 PIC  XX.
   189     05  WS-CN-ACCOUNT               PIC  X(10).
   190     05  WS-CN-CERT-EFF-DT           PIC  XX.
   191     05  WS-CN-CERT-NO.
   192         10  WS-CN-CERT-PRIME        PIC  X(10).
   193         10  WS-CN-CERT-SFX          PIC  X.
   194     05  WS-CN-RECORD-TYPE           PIC  X.
   195*    COPY ELCDATE.
   196******************************************************************
   197*                                                                *
   198*                                                                *
   199*                            ELCDATE.                            *
   200*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   201*                            VMOD=2.003
   202*                                                                *
   203*                                                                *
   204*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   205*                 LENGTH = 200                                   *
   206******************************************************************
   207
   208 01  DATE-CONVERSION-DATA.
   209     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   210     12  DC-OPTION-CODE                PIC X.
   211         88  BIN-TO-GREG                VALUE ' '.
   212         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   213         88  EDIT-GREG-TO-BIN           VALUE '2'.
   214         88  YMD-GREG-TO-BIN            VALUE '3'.
   215         88  MDY-GREG-TO-BIN            VALUE '4'.
   216         88  JULIAN-TO-BIN              VALUE '5'.
   217         88  BIN-PLUS-ELAPSED           VALUE '6'.
   218         88  FIND-CENTURY               VALUE '7'.
   219         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   220         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   221         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   222         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   223         88  JULIAN-TO-BIN-3            VALUE 'C'.
   224         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   225         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   226         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   227         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   228         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   229         88  CHECK-LEAP-YEAR            VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page   7
* EL1276.cbl
   230         88  BIN-3-TO-GREG              VALUE 'I'.
   231         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   232         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   233         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   234         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   235         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   236         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   237         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   238         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   239         88  THREE-CHARACTER-BIN
   240                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   241         88  GREGORIAN-TO-BIN
   242                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   243         88  BIN-TO-GREGORIAN
   244                  VALUES ' ' '1' 'I' '8' 'G'.
   245         88  JULIAN-TO-BINARY
   246                  VALUES '5' 'C' 'E' 'F'.
   247     12  DC-ERROR-CODE                 PIC X.
   248         88  NO-CONVERSION-ERROR        VALUE ' '.
   249         88  DATE-CONVERSION-ERROR
   250                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   251         88  DATE-IS-ZERO               VALUE '1'.
   252         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   253         88  DATE-IS-INVALID            VALUE '3'.
   254         88  DATE1-GREATER-DATE2        VALUE '4'.
   255         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   256         88  DATE-INVALID-OPTION        VALUE '9'.
   257         88  INVALID-CENTURY            VALUE 'A'.
   258         88  ONLY-CENTURY               VALUE 'B'.
   259         88  ONLY-LEAP-YEAR             VALUE 'C'.
   260         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   261     12  DC-END-OF-MONTH               PIC X.
   262         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   263     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   264         88  USE-NORMAL-PROCESS         VALUE ' '.
   265         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   266         88  ADJUST-UP-100-YRS          VALUE '2'.
   267     12  FILLER                        PIC X.
   268     12  DC-CONVERSION-DATES.
   269         16  DC-BIN-DATE-1             PIC XX.
   270         16  DC-BIN-DATE-2             PIC XX.
   271         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   272         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   273                       DC-GREG-DATE-1-EDIT.
   274             20  DC-EDIT1-MONTH        PIC 99.
   275             20  SLASH1-1              PIC X.
   276             20  DC-EDIT1-DAY          PIC 99.
   277             20  SLASH1-2              PIC X.
   278             20  DC-EDIT1-YEAR         PIC 99.
   279         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   280         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   281                     DC-GREG-DATE-2-EDIT.
   282             20  DC-EDIT2-MONTH        PIC 99.
   283             20  SLASH2-1              PIC X.
   284             20  DC-EDIT2-DAY          PIC 99.
   285             20  SLASH2-2              PIC X.
   286             20  DC-EDIT2-YEAR         PIC 99.
   287         16  DC-GREG-DATE-1-YMD        PIC 9(06).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page   8
* EL1276.cbl
   288         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   289                     DC-GREG-DATE-1-YMD.
   290             20  DC-YMD-YEAR           PIC 99.
   291             20  DC-YMD-MONTH          PIC 99.
   292             20  DC-YMD-DAY            PIC 99.
   293         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   294         16  DC-GREG-DATE-1-MDY-R REDEFINES
   295                      DC-GREG-DATE-1-MDY.
   296             20  DC-MDY-MONTH          PIC 99.
   297             20  DC-MDY-DAY            PIC 99.
   298             20  DC-MDY-YEAR           PIC 99.
   299         16  DC-GREG-DATE-1-ALPHA.
   300             20  DC-ALPHA-MONTH        PIC X(10).
   301             20  DC-ALPHA-DAY          PIC 99.
   302             20  FILLER                PIC XX.
   303             20  DC-ALPHA-CENTURY.
   304                 24 DC-ALPHA-CEN-N     PIC 99.
   305             20  DC-ALPHA-YEAR         PIC 99.
   306         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   307         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   308         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   309         16  DC-JULIAN-DATE            PIC 9(05).
   310         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   311                                       PIC 9(05).
   312         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   313             20  DC-JULIAN-YEAR        PIC 99.
   314             20  DC-JULIAN-DAYS        PIC 999.
   315         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   316         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   317         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   318     12  DATE-CONVERSION-VARIBLES.
   319         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   320         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   321             20  FILLER                PIC 9(3).
   322             20  HOLD-CEN-1-CCYY.
   323                 24  HOLD-CEN-1-CC     PIC 99.
   324                 24  HOLD-CEN-1-YY     PIC 99.
   325             20  HOLD-CEN-1-MO         PIC 99.
   326             20  HOLD-CEN-1-DA         PIC 99.
   327         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   328             20  HOLD-CEN-1-R-MO       PIC 99.
   329             20  HOLD-CEN-1-R-DA       PIC 99.
   330             20  HOLD-CEN-1-R-CCYY.
   331                 24  HOLD-CEN-1-R-CC   PIC 99.
   332                 24  HOLD-CEN-1-R-YY   PIC 99.
   333             20  FILLER                PIC 9(3).
   334         16  HOLD-CENTURY-1-X.
   335             20  FILLER                PIC X(3)  VALUE SPACES.
   336             20  HOLD-CEN-1-X-CCYY.
   337                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   338                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   339             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   340             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   341         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   342             20  HOLD-CEN-1-R-X-MO     PIC XX.
   343             20  HOLD-CEN-1-R-X-DA     PIC XX.
   344             20  HOLD-CEN-1-R-X-CCYY.
   345                 24  HOLD-CEN-1-R-X-CC PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page   9
* EL1276.cbl
   346                 24  HOLD-CEN-1-R-X-YY PIC XX.
   347             20  FILLER                PIC XXX.
   348         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   349         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   350         16  DC-JULIAN-DATE-1          PIC 9(07).
   351         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   352             20  DC-JULIAN-1-CCYY.
   353                 24  DC-JULIAN-1-CC    PIC 99.
   354                 24  DC-JULIAN-1-YR    PIC 99.
   355             20  DC-JULIAN-DA-1        PIC 999.
   356         16  DC-JULIAN-DATE-2          PIC 9(07).
   357         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   358             20  DC-JULIAN-2-CCYY.
   359                 24  DC-JULIAN-2-CC    PIC 99.
   360                 24  DC-JULIAN-2-YR    PIC 99.
   361             20  DC-JULIAN-DA-2        PIC 999.
   362         16  DC-GREG-DATE-A-EDIT.
   363             20  DC-EDITA-MONTH        PIC 99.
   364             20  SLASHA-1              PIC X VALUE '/'.
   365             20  DC-EDITA-DAY          PIC 99.
   366             20  SLASHA-2              PIC X VALUE '/'.
   367             20  DC-EDITA-CCYY.
   368                 24  DC-EDITA-CENT     PIC 99.
   369                 24  DC-EDITA-YEAR     PIC 99.
   370         16  DC-GREG-DATE-B-EDIT.
   371             20  DC-EDITB-MONTH        PIC 99.
   372             20  SLASHB-1              PIC X VALUE '/'.
   373             20  DC-EDITB-DAY          PIC 99.
   374             20  SLASHB-2              PIC X VALUE '/'.
   375             20  DC-EDITB-CCYY.
   376                 24  DC-EDITB-CENT     PIC 99.
   377                 24  DC-EDITB-YEAR     PIC 99.
   378         16  DC-GREG-DATE-CYMD         PIC 9(08).
   379         16  DC-GREG-DATE-CYMD-R REDEFINES
   380                              DC-GREG-DATE-CYMD.
   381             20  DC-CYMD-CEN           PIC 99.
   382             20  DC-CYMD-YEAR          PIC 99.
   383             20  DC-CYMD-MONTH         PIC 99.
   384             20  DC-CYMD-DAY           PIC 99.
   385         16  DC-GREG-DATE-MDCY         PIC 9(08).
   386         16  DC-GREG-DATE-MDCY-R REDEFINES
   387                              DC-GREG-DATE-MDCY.
   388             20  DC-MDCY-MONTH         PIC 99.
   389             20  DC-MDCY-DAY           PIC 99.
   390             20  DC-MDCY-CEN           PIC 99.
   391             20  DC-MDCY-YEAR          PIC 99.
   392    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   393        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   394    12  DC-EL310-DATE                  PIC X(21).
   395    12  FILLER                         PIC X(28).
   396
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  10
* EL1276.cbl
   398*    COPY ELCLOGOF.
   399******************************************************************
   400*                                                                *
   401*                                                                *
   402*                            ELCLOGOF.                           *
   403*                            VMOD=2.001                          *
   404*                                                                *
   405*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   406*                                                                *
   407******************************************************************
   408 01  CLASIC-LOGOFF.
   409     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   410     12  LOGOFF-TEXT.
   411         16  FILLER          PIC X(5)    VALUE SPACES.
   412         16  LOGOFF-MSG.
   413             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   414             20  FILLER      PIC X       VALUE SPACES.
   415             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   416         16  FILLER          PIC X(80)
   417           VALUE '* YOU ARE NOW LOGGED OFF'.
   418         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   419         16  FILLER          PIC X       VALUE QUOTE.
   420         16  LOGOFF-SYS-MSG  PIC X(17)
   421           VALUE 'S CLAS-IC SYSTEM '.
   422     12  TEXT-MESSAGES.
   423         16  UNACCESS-MSG    PIC X(29)
   424             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   425         16  PGMIDERR-MSG    PIC X(17)
   426             VALUE 'PROGRAM NOT FOUND'.
   427
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  11
* EL1276.cbl
   429*    COPY ELCATTR.
   430******************************************************************
   431*                                                                *
   432*                            ELCATTR.                            *
   433*                            VMOD=2.001                          *
   434*                                                                *
   435*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   436*                                                                *
   437*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   438*                                                                *
   439*                   POS 1   P=PROTECTED                          *
   440*                           U=UNPROTECTED                        *
   441*                           S=ASKIP                              *
   442*                   POS 2   A=ALPHA/NUMERIC                      *
   443*                           N=NUMERIC                            *
   444*                   POS 3   N=NORMAL                             *
   445*                           B=BRIGHT                             *
   446*                           D=DARK                               *
   447*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   448*                           OF=MODIFIED DATA TAG OFF             *
   449*                                                                *
   450*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   451******************************************************************
   452 01  ATTRIBUTE-LIST.
   453     12  AL-PABOF            PIC X       VALUE 'Y'.
   454     12  AL-PABON            PIC X       VALUE 'Z'.
   455     12  AL-PADOF            PIC X       VALUE '%'.
   456     12  AL-PADON            PIC X       VALUE '_'.
   457     12  AL-PANOF            PIC X       VALUE '-'.
   458     12  AL-PANON            PIC X       VALUE '/'.
   459     12  AL-SABOF            PIC X       VALUE '8'.
   460     12  AL-SABON            PIC X       VALUE '9'.
   461     12  AL-SADOF            PIC X       VALUE '@'.
   462     12  AL-SADON            PIC X       VALUE QUOTE.
   463     12  AL-SANOF            PIC X       VALUE '0'.
   464     12  AL-SANON            PIC X       VALUE '1'.
   465     12  AL-UABOF            PIC X       VALUE 'H'.
   466     12  AL-UABON            PIC X       VALUE 'I'.
   467     12  AL-UADOF            PIC X       VALUE '<'.
   468     12  AL-UADON            PIC X       VALUE '('.
   469     12  AL-UANOF            PIC X       VALUE ' '.
   470     12  AL-UANON            PIC X       VALUE 'A'.
   471     12  AL-UNBOF            PIC X       VALUE 'Q'.
   472     12  AL-UNBON            PIC X       VALUE 'R'.
   473     12  AL-UNDOF            PIC X       VALUE '*'.
   474     12  AL-UNDON            PIC X       VALUE ')'.
   475     12  AL-UNNOF            PIC X       VALUE '&'.
   476     12  AL-UNNON            PIC X       VALUE 'J'.
   477
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  12
* EL1276.cbl
   479*    COPY ELCEMIB.
   480******************************************************************
   481*                                                                *
   482*                                                                *
   483*                            ELCEMIB.                            *
   484*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   485*                            VMOD=2.005                          *
   486*                                                                *
   487*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   488*                                                                *
   489******************************************************************
   490 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   491     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   492     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   493     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   494     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   495     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   496     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   497     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   498     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   499     12  EMI-SWITCH1             PIC X        VALUE '1'.
   500         88  EMI-NO-ERRORS                    VALUE '1'.
   501         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   502         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   503     12  EMI-SWITCH2             PIC X        VALUE '1'.
   504         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   505     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   506         88  EMI-AREA1-EMPTY                  VALUE '1'.
   507         88  EMI-AREA1-FULL                   VALUE '2'.
   508     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   509         88  EMI-AREA2-EMPTY                  VALUE '1'.
   510         88  EMI-AREA2-FULL                   VALUE '2'.
   511     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   512         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   513         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   514         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   515         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   516         88  EMI-BYPASS-FATALS                VALUE 'X'.
   517     12  EMI-ERROR-LINES.
   518         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   519         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   520         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   521         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   522             20  EMI-ERR-CODES OCCURS 10 TIMES.
   523                 24  EMI-ERR-NUM         PIC X(4).
   524                 24  EMI-FILLER          PIC X.
   525                 24  EMI-SEV             PIC X.
   526                 24  FILLER              PIC X.
   527             20  FILLER                  PIC X(02).
   528     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   529         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   530             20  EMI-ERROR-NUMBER    PIC X(4).
   531             20  EMI-FILL            PIC X.
   532             20  EMI-SEVERITY        PIC X.
   533             20  FILLER              PIC X.
   534             20  EMI-ERROR-TEXT.
   535                 24  EMI-TEXT-VARIABLE   PIC X(10).
   536                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  13
* EL1276.cbl
   537     12  EMI-SEVERITY-SAVE           PIC X.
   538         88  EMI-NOTE                    VALUE 'N'.
   539         88  EMI-WARNING                 VALUE 'W'.
   540         88  EMI-FORCABLE                VALUE 'F'.
   541         88  EMI-FATAL                   VALUE 'X'.
   542     12  EMI-MESSAGE-FLAG            PIC X.
   543         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   544         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   545     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   546     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   547         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   548         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   549         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   550     12  emi-claim-no                pic x(7).
   551     12  emi-claim-type              pic x(6).
   552     12  FILLER                      PIC X(124)  VALUE SPACES.
   553     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   554     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   555     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   556     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   557
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  14
* EL1276.cbl
   559*    COPY ELCINTF.
   560******************************************************************
   561*                                                                *
   562*                                                                *
   563*                            ELCINTF.                            *
   564*                            VMOD=2.017                          *
   565*                                                                *
   566*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   567*                                                                *
   568*       LENGTH = 1024                                            *
   569*                                                                *
   570******************************************************************
   571*                   C H A N G E   L O G
   572*
   573* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   574*-----------------------------------------------------------------
   575*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   576* EFFECTIVE    NUMBER
   577*-----------------------------------------------------------------
   578* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   579******************************************************************
   580 01  PROGRAM-INTERFACE-BLOCK.
   581     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   582     12  PI-CALLING-PROGRAM              PIC X(8).
   583     12  PI-SAVED-PROGRAM-1              PIC X(8).
   584     12  PI-SAVED-PROGRAM-2              PIC X(8).
   585     12  PI-SAVED-PROGRAM-3              PIC X(8).
   586     12  PI-SAVED-PROGRAM-4              PIC X(8).
   587     12  PI-SAVED-PROGRAM-5              PIC X(8).
   588     12  PI-SAVED-PROGRAM-6              PIC X(8).
   589     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   590     12  PI-COMPANY-ID                   PIC XXX.
   591     12  PI-COMPANY-CD                   PIC X.
   592
   593     12  PI-COMPANY-PASSWORD             PIC X(8).
   594
   595     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   596
   597     12  PI-CONTROL-IN-PROGRESS.
   598         16  PI-CARRIER                  PIC X.
   599         16  PI-GROUPING                 PIC X(6).
   600         16  PI-STATE                    PIC XX.
   601         16  PI-ACCOUNT                  PIC X(10).
   602         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   603                                         PIC X(10).
   604         16  PI-CLAIM-CERT-GRP.
   605             20  PI-CLAIM-NO             PIC X(7).
   606             20  PI-CERT-NO.
   607                 25  PI-CERT-PRIME       PIC X(10).
   608                 25  PI-CERT-SFX         PIC X.
   609             20  PI-CERT-EFF-DT          PIC XX.
   610         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   611             20  PI-PLAN-CODE            PIC X(2).
   612             20  PI-REVISION-NUMBER      PIC X(3).
   613             20  PI-PLAN-EFF-DT          PIC X(2).
   614             20  PI-PLAN-EXP-DT          PIC X(2).
   615             20  FILLER                  PIC X(11).
   616         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  15
* EL1276.cbl
   617             20  PI-OE-REFERENCE-1.
   618                 25  PI-OE-REF-1-PRIME   PIC X(18).
   619                 25  PI-OE-REF-1-SUFF    PIC XX.
   620
   621     12  PI-SESSION-IN-PROGRESS          PIC X.
   622         88  CLAIM-SESSION                   VALUE '1'.
   623         88  CREDIT-SESSION                  VALUE '2'.
   624         88  WARRANTY-SESSION                VALUE '3'.
   625         88  MORTGAGE-SESSION                VALUE '4'.
   626         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   627
   628
   629*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   630
   631     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   632     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   633
   634     12  PI-CREDIT-USER                  PIC X.
   635         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   636         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   637
   638     12  PI-CLAIM-USER                   PIC X.
   639         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   640         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   641
   642     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   643         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   644         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   645         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   646         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   647         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   648
   649     12  PI-PROCESSOR-ID                 PIC X(4).
   650
   651     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   652
   653     12  PI-MEMBER-CAPTION               PIC X(10).
   654
   655     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   656         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   657
   658     12  PI-LIFE-OVERRIDE-L1             PIC X.
   659     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   660     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   661     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   662
   663     12  PI-AH-OVERRIDE-L1               PIC X.
   664     12  PI-AH-OVERRIDE-L2               PIC XX.
   665     12  PI-AH-OVERRIDE-L6               PIC X(6).
   666     12  PI-AH-OVERRIDE-L12              PIC X(12).
   667
   668     12  PI-NEW-SYSTEM                   PIC X(2).
   669
   670     12  PI-PRIMARY-CERT-NO              PIC X(11).
   671     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   672         88  PI-USES-PAID-TO                 VALUE '1'.
   673     12  PI-CRDTCRD-SYSTEM.
   674         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  16
* EL1276.cbl
   675             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   676             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   677         16  PI-CC-MONTH-END-DT          PIC XX.
   678     12  PI-PROCESSOR-PRINTER            PIC X(4).
   679
   680     12  PI-OE-REFERENCE-2.
   681         16  PI-OE-REF-2-PRIME           PIC X(10).
   682         16  PI-OE-REF-2-SUFF            PIC X.
   683
   684     12  PI-REM-TRM-CALC-OPTION          PIC X.
   685
   686     12  PI-LANGUAGE-TYPE                PIC X.
   687             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   688             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   689             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   690
   691     12  PI-POLICY-LINKAGE-IND           PIC X.
   692         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   693         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   694                                                   LOW-VALUES.
   695
   696     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   697     12  PI-CLAIM-PW-SESSION             PIC X(1).
   698         88  PI-CLAIM-CREDIT                 VALUE '1'.
   699         88  PI-CLAIM-CONVEN                 VALUE '2'.
   700
   701     12  PI-PROCESSOR-CSR-IND            PIC X.
   702         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   703         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   704
   705     12  FILLER                          PIC X(3).
   706
   707     12  PI-SYSTEM-LEVEL                 PIC X(145).
   708
   709     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   710         PI-SYSTEM-LEVEL.
   711
   712         16  PI-ENTRY-CODES.
   713             20  PI-ENTRY-CD-1           PIC X.
   714             20  PI-ENTRY-CD-2           PIC X.
   715
   716         16  PI-RETURN-CODES.
   717             20  PI-RETURN-CD-1          PIC X.
   718             20  PI-RETURN-CD-2          PIC X.
   719
   720         16  PI-UPDATE-STATUS-SAVE.
   721             20  PI-UPDATE-BY            PIC X(4).
   722             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   723
   724         16  PI-LOWER-CASE-LETTERS       PIC X.
   725             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   726
   727*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   728*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   729*            88  CARRIER-CLM-CNTL            VALUE '2'.
   730
   731         16  PI-CERT-ACCESS-CONTROL      PIC X.
   732             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  17
* EL1276.cbl
   733             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   734             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   735             88  ACCNT-CNTL                  VALUE '3'.
   736             88  CARR-ACCNT-CNTL             VALUE '4'.
   737
   738         16  PI-PROCESSOR-CAP-LIST.
   739             20  PI-SYSTEM-CONTROLS.
   740                24 PI-SYSTEM-DISPLAY     PIC X.
   741                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   742                24 PI-SYSTEM-MODIFY      PIC X.
   743                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   744             20  FILLER                  PIC XX.
   745             20  PI-DISPLAY-CAP          PIC X.
   746                 88  DISPLAY-CAP             VALUE 'Y'.
   747             20  PI-MODIFY-CAP           PIC X.
   748                 88  MODIFY-CAP              VALUE 'Y'.
   749             20  PI-MSG-AT-LOGON-CAP     PIC X.
   750                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   751             20  PI-FORCE-CAP            PIC X.
   752                 88  FORCE-CAP               VALUE 'Y'.
   753
   754         16  PI-PROGRAM-CONTROLS.
   755             20  PI-PGM-PRINT-OPT        PIC X.
   756             20  PI-PGM-FORMAT-OPT       PIC X.
   757             20  PI-PGM-PROCESS-OPT      PIC X.
   758             20  PI-PGM-TOTALS-OPT       PIC X.
   759
   760         16  PI-HELP-INTERFACE.
   761             20  PI-LAST-ERROR-NO        PIC X(4).
   762             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   763
   764         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   765             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   766
   767         16  PI-CR-CONTROL-IN-PROGRESS.
   768             20  PI-CR-CARRIER           PIC X.
   769             20  PI-CR-GROUPING          PIC X(6).
   770             20  PI-CR-STATE             PIC XX.
   771             20  PI-CR-ACCOUNT           PIC X(10).
   772             20  PI-CR-FIN-RESP          PIC X(10).
   773             20  PI-CR-TYPE              PIC X.
   774
   775         16  PI-CR-BATCH-NUMBER          PIC X(6).
   776
   777         16  PI-CR-MONTH-END-DT          PIC XX.
   778
   779         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   780             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   781             88  PI-ZERO-CARRIER             VALUE '1'.
   782             88  PI-ZERO-GROUPING            VALUE '2'.
   783             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   784
   785         16  PI-CARRIER-SECURITY         PIC X.
   786             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   787
   788         16  PI-ACCOUNT-SECURITY         PIC X(10).
   789             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   790             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  18
* EL1276.cbl
   791
   792         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   793             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   794                                         INDEXED BY PI-ACCESS-NDX
   795                                         PIC X.
   796
   797         16  PI-GA-BILLING-CONTROL       PIC X.
   798             88  PI-GA-BILLING               VALUE '1'.
   799
   800         16  PI-MAIL-PROCESSING          PIC X.
   801             88  PI-MAIL-YES                 VALUE 'Y'.
   802
   803         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   804
   805         16  PI-AR-SYSTEM.
   806             20  PI-AR-PROCESSING-CNTL   PIC X.
   807                 88  PI-AR-PROCESSING        VALUE 'Y'.
   808             20  PI-AR-SUMMARY-CODE      PIC X(6).
   809             20  PI-AR-MONTH-END-DT      PIC XX.
   810
   811         16  PI-MP-SYSTEM.
   812             20  PI-MORTGAGE-USER            PIC X.
   813                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   814                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   815             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   816                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   817                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   818                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   819                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   820                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   821             20  PI-MP-MONTH-END-DT          PIC XX.
   822             20  PI-MP-REFERENCE-NO.
   823                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   824                 24  PI-MP-REFERENCE-SFX     PIC XX.
   825
   826         16  PI-LABEL-CONTROL            PIC X(01).
   827             88  PI-CREATE-LABELS                    VALUE 'Y'.
   828             88  PI-BYPASS-LABELS                    VALUE 'N'.
   829
   830         16  PI-BILL-GROUPING-CODE       PIC X(01).
   831             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   832
   833         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   834             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   835             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   836
   837         16  FILLER                      PIC X(14).
   838
   839     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   840******************************************************************
   841     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   842         16  FILLER              PIC X(318).
   843         16  PI-TOTAL-LINES      PIC S9(3).
   844         16  PI-CURRENT-LINE     PIC S9(3)   COMP-3.
   845         16  PI-TEMP-STOR-ITEMS  PIC S9(4)   COMP.
   846         16  PI-UPDATE-SW        PIC X.
   847             88  PI-CHANGES-MADE             VALUE '1'.
   848         16  PI-PF5-PRESSED      PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  19
* EL1276.cbl
   849             88 PF5-PRESSED                  VALUE 'Y'.
   850         16  PI-PF6-PRESSED      PIC X.
   851             88 PF6-PRESSED                  VALUE 'Y'.
   852         16  PI-CURR-NOTE-REC-TYPE PIC X.
   853             88 PI-CERT-NOTE                 VALUE '1'.
   854             88 PI-CLAIM-NOTE                VALUE '2'.
   855         16  PI-BILLING-NOTES-EXIST PIC X.
   856         16  PI-CERT-NOTES-EXIST    PIC X.
   857         16  PI-CLAIM-NOTES-EXIST   PIC X.
   858         16  filler                 pic x.
   859         16  pi-iss-can-trans    pic x.
   860             88  pi-from-issue     value '1'.
   861             88  pi-from-cancel    value '2'.
   862         16  pi-active-notes        pic x.
   863             88  pi-issue-notes       value '1'.
   864             88  pi-cancel-notes      value '2'.
   865
   866*    COPY ELCJPFX.
   867******************************************************************
   868*                                                                *
   869*                                                                *
   870*                            ELCJPFX.                            *
   871*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   872*                            VMOD=2.002                          *
   873*                                                                *
   874*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   875*                                                                *
   876*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   877*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   878*        ELCNTL - CONTROL FILE                                   *
   879*        ELMSTR - CLAIM MASTERS                                  *
   880*        ELTRLR - ACTIVITY TRAILERS                              *
   881*        ELCHKQ - CHECK QUE                                      *
   882******************************************************************
   883 01  JOURNAL-RECORD.
   884     12  jp-date                     pic s9(5) comp-3.
   885     12  jp-time                     pic s9(7) comp-3.
   886     12  JP-USER-ID                  PIC X(4).
   887     12  JP-FILE-ID                  PIC X(8).
   888     12  JP-PROGRAM-ID               PIC X(8).
   889     12  JP-RECORD-TYPE              PIC X.
   890         88 JP-ADD              VALUE 'A'.
   891         88 JP-BEFORE-CHANGE    VALUE 'B'.
   892         88 JP-AFTER-CHANGE     VALUE 'C'.
   893         88 JP-DELETE           VALUE 'D'.
   894         88 JP-GENERIC-DELETE   VALUE 'G'.
   895         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   896         88 JP-KEY-CHG-ADD      VALUE 'N'.
   897     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   898     12  JP-RECORD-AREA
   899
   900
   901                                     PIC X(523).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  20
* EL1276.cbl
   903
   904*    COPY ELCAID.
   905******************************************************************
   906*                                                                *
   907*                            ELCAID.                             *
   908*                            VMOD=2.001                          *
   909*                                                                *
   910*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   911*                                                                *
   912*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   913*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   914******************************************************************
   915
   916 01  DFHAID.
   917   02  DFHNULL   PIC  X  VALUE  ' '.
   918   02  DFHENTER  PIC  X  VALUE  QUOTE.
   919   02  DFHCLEAR  PIC  X  VALUE  '_'.
   920   02  DFHPEN    PIC  X  VALUE  '='.
   921   02  DFHOPID   PIC  X  VALUE  'W'.
   922   02  DFHPA1    PIC  X  VALUE  '%'.
   923   02  DFHPA2    PIC  X  VALUE  '>'.
   924   02  DFHPA3    PIC  X  VALUE  ','.
   925   02  DFHPF1    PIC  X  VALUE  '1'.
   926   02  DFHPF2    PIC  X  VALUE  '2'.
   927   02  DFHPF3    PIC  X  VALUE  '3'.
   928   02  DFHPF4    PIC  X  VALUE  '4'.
   929   02  DFHPF5    PIC  X  VALUE  '5'.
   930   02  DFHPF6    PIC  X  VALUE  '6'.
   931   02  DFHPF7    PIC  X  VALUE  '7'.
   932   02  DFHPF8    PIC  X  VALUE  '8'.
   933   02  DFHPF9    PIC  X  VALUE  '9'.
   934   02  DFHPF10   PIC  X  VALUE  ':'.
   935   02  DFHPF11   PIC  X  VALUE  '#'.
   936   02  DFHPF12   PIC  X  VALUE  '@'.
   937   02  DFHPF13   PIC  X  VALUE  'A'.
   938   02  DFHPF14   PIC  X  VALUE  'B'.
   939   02  DFHPF15   PIC  X  VALUE  'C'.
   940   02  DFHPF16   PIC  X  VALUE  'D'.
   941   02  DFHPF17   PIC  X  VALUE  'E'.
   942   02  DFHPF18   PIC  X  VALUE  'F'.
   943   02  DFHPF19   PIC  X  VALUE  'G'.
   944   02  DFHPF20   PIC  X  VALUE  'H'.
   945   02  DFHPF21   PIC  X  VALUE  'I'.
   946*00039    02  DFHPF22   PIC  X  VALUE  ''.
   947   02  DFHPF22   PIC  X  VALUE  '['.
   948   02  DFHPF23   PIC  X  VALUE  '.'.
   949   02  DFHPF24   PIC  X  VALUE  '<'.
   950   02  DFHMSRE   PIC  X  VALUE  'X'.
   951   02  DFHSTRF   PIC  X  VALUE  'h'.
   952   02  DFHTRIG   PIC  X  VALUE  '"'.
   953 01  FILLER    REDEFINES DFHAID.
   954     12  FILLER                      PIC X(8).
   955     12  PF-VALUES                   PIC X       OCCURS 24 TIMES.
   956
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  21
* EL1276.cbl
   958*    COPY EL1276S.
   959 01  EL127FI.
   960     05  FILLER            PIC  X(0012).
   961*    -------------------------------
   962     05  FDATEL PIC S9(0004) COMP.
   963     05  FDATEF PIC  X(0001).
   964     05  FILLER REDEFINES FDATEF.
   965         10  FDATEA PIC  X(0001).
   966     05  FDATEI PIC  X(0008).
   967*    -------------------------------
   968     05  FTIMEL PIC S9(0004) COMP.
   969     05  FTIMEF PIC  X(0001).
   970     05  FILLER REDEFINES FTIMEF.
   971         10  FTIMEA PIC  X(0001).
   972     05  FTIMEI PIC  X(0005).
   973*    -------------------------------
   974     05  CMPNYIDL PIC S9(0004) COMP.
   975     05  CMPNYIDF PIC  X(0001).
   976     05  FILLER REDEFINES CMPNYIDF.
   977         10  CMPNYIDA PIC  X(0001).
   978     05  CMPNYIDI PIC  X(0003).
   979*    -------------------------------
   980     05  USERIDL PIC S9(0004) COMP.
   981     05  USERIDF PIC  X(0001).
   982     05  FILLER REDEFINES USERIDF.
   983         10  USERIDA PIC  X(0001).
   984     05  USERIDI PIC  X(0004).
   985*    -------------------------------
   986     05  FMAINTL PIC S9(0004) COMP.
   987     05  FMAINTF PIC  X(0001).
   988     05  FILLER REDEFINES FMAINTF.
   989         10  FMAINTA PIC  X(0001).
   990     05  FMAINTI PIC  X(0001).
   991*    -------------------------------
   992     05  FCERTL PIC S9(0004) COMP.
   993     05  FCERTF PIC  X(0001).
   994     05  FILLER REDEFINES FCERTF.
   995         10  FCERTA PIC  X(0001).
   996     05  FCERTI PIC  X(0010).
   997*    -------------------------------
   998     05  FCRTSFXL PIC S9(0004) COMP.
   999     05  FCRTSFXF PIC  X(0001).
  1000     05  FILLER REDEFINES FCRTSFXF.
  1001         10  FCRTSFXA PIC  X(0001).
  1002     05  FCRTSFXI PIC  X(0001).
  1003*    -------------------------------
  1004     05  FACOUNTL PIC S9(0004) COMP.
  1005     05  FACOUNTF PIC  X(0001).
  1006     05  FILLER REDEFINES FACOUNTF.
  1007         10  FACOUNTA PIC  X(0001).
  1008     05  FACOUNTI PIC  X(0010).
  1009*    -------------------------------
  1010     05  FSTL PIC S9(0004) COMP.
  1011     05  FSTF PIC  X(0001).
  1012     05  FILLER REDEFINES FSTF.
  1013         10  FSTA PIC  X(0001).
  1014     05  FSTI PIC  X(0002).
  1015*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  22
* EL1276.cbl
  1016     05  FCARRIRL PIC S9(0004) COMP.
  1017     05  FCARRIRF PIC  X(0001).
  1018     05  FILLER REDEFINES FCARRIRF.
  1019         10  FCARRIRA PIC  X(0001).
  1020     05  FCARRIRI PIC  X(0001).
  1021*    -------------------------------
  1022     05  FGROUPL PIC S9(0004) COMP.
  1023     05  FGROUPF PIC  X(0001).
  1024     05  FILLER REDEFINES FGROUPF.
  1025         10  FGROUPA PIC  X(0001).
  1026     05  FGROUPI PIC  X(0006).
  1027*    -------------------------------
  1028     05  FEFFDTL PIC S9(0004) COMP.
  1029     05  FEFFDTF PIC  X(0001).
  1030     05  FILLER REDEFINES FEFFDTF.
  1031         10  FEFFDTA PIC  X(0001).
  1032     05  FEFFDTI PIC  X(0008).
  1033*    -------------------------------
  1034     05  FBSTARTL PIC S9(0004) COMP.
  1035     05  FBSTARTF PIC  X(0001).
  1036     05  FILLER REDEFINES FBSTARTF.
  1037         10  FBSTARTA PIC  X(0001).
  1038     05  FBSTARTI PIC  X(0002).
  1039*    -------------------------------
  1040     05  MAINTONL PIC S9(0004) COMP.
  1041     05  MAINTONF PIC  X(0001).
  1042     05  FILLER REDEFINES MAINTONF.
  1043         10  MAINTONA PIC  X(0001).
  1044     05  MAINTONI PIC  X(0008).
  1045*    -------------------------------
  1046     05  MAINTATL PIC S9(0004) COMP.
  1047     05  MAINTATF PIC  X(0001).
  1048     05  FILLER REDEFINES MAINTATF.
  1049         10  MAINTATA PIC  X(0001).
  1050     05  MAINTATI PIC  X(0005).
  1051*    -------------------------------
  1052     05  MAINTBYL PIC S9(0004) COMP.
  1053     05  MAINTBYF PIC  X(0001).
  1054     05  FILLER REDEFINES MAINTBYF.
  1055         10  MAINTBYA PIC  X(0001).
  1056     05  MAINTBYI PIC  X(0004).
  1057*    -------------------------------
  1058     05  FBENDL PIC S9(0004) COMP.
  1059     05  FBENDF PIC  X(0001).
  1060     05  FILLER REDEFINES FBENDF.
  1061         10  FBENDA PIC  X(0001).
  1062     05  FBENDI PIC  X(0002).
  1063*    -------------------------------
  1064     05  FCERTYNL PIC S9(0004) COMP.
  1065     05  FCERTYNF PIC  X(0001).
  1066     05  FILLER REDEFINES FCERTYNF.
  1067         10  FCERTYNA PIC  X(0001).
  1068     05  FCERTYNI PIC  X(0003).
  1069*    -------------------------------
  1070     05  FCLMYNL PIC S9(0004) COMP.
  1071     05  FCLMYNF PIC  X(0001).
  1072     05  FILLER REDEFINES FCLMYNF.
  1073         10  FCLMYNA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  23
* EL1276.cbl
  1074     05  FCLMYNI PIC  X(0003).
  1075*    -------------------------------
  1076     05  FHEADL PIC S9(0004) COMP.
  1077     05  FHEADF PIC  X(0001).
  1078     05  FILLER REDEFINES FHEADF.
  1079         10  FHEADA PIC  X(0001).
  1080     05  FHEADI PIC  X(0025).
  1081*    -------------------------------
  1082     05  FNLINE1L PIC S9(0004) COMP.
  1083     05  FNLINE1F PIC  X(0001).
  1084     05  FILLER REDEFINES FNLINE1F.
  1085         10  FNLINE1A PIC  X(0001).
  1086     05  FNLINE1I PIC  X(0077).
  1087*    -------------------------------
  1088     05  FNLINE2L PIC S9(0004) COMP.
  1089     05  FNLINE2F PIC  X(0001).
  1090     05  FILLER REDEFINES FNLINE2F.
  1091         10  FNLINE2A PIC  X(0001).
  1092     05  FNLINE2I PIC  X(0077).
  1093*    -------------------------------
  1094     05  FNLINE3L PIC S9(0004) COMP.
  1095     05  FNLINE3F PIC  X(0001).
  1096     05  FILLER REDEFINES FNLINE3F.
  1097         10  FNLINE3A PIC  X(0001).
  1098     05  FNLINE3I PIC  X(0077).
  1099*    -------------------------------
  1100     05  FNLINE4L PIC S9(0004) COMP.
  1101     05  FNLINE4F PIC  X(0001).
  1102     05  FILLER REDEFINES FNLINE4F.
  1103         10  FNLINE4A PIC  X(0001).
  1104     05  FNLINE4I PIC  X(0077).
  1105*    -------------------------------
  1106     05  FNLINE5L PIC S9(0004) COMP.
  1107     05  FNLINE5F PIC  X(0001).
  1108     05  FILLER REDEFINES FNLINE5F.
  1109         10  FNLINE5A PIC  X(0001).
  1110     05  FNLINE5I PIC  X(0077).
  1111*    -------------------------------
  1112     05  FNLINE6L PIC S9(0004) COMP.
  1113     05  FNLINE6F PIC  X(0001).
  1114     05  FILLER REDEFINES FNLINE6F.
  1115         10  FNLINE6A PIC  X(0001).
  1116     05  FNLINE6I PIC  X(0077).
  1117*    -------------------------------
  1118     05  FNLINE7L PIC S9(0004) COMP.
  1119     05  FNLINE7F PIC  X(0001).
  1120     05  FILLER REDEFINES FNLINE7F.
  1121         10  FNLINE7A PIC  X(0001).
  1122     05  FNLINE7I PIC  X(0077).
  1123*    -------------------------------
  1124     05  FNLINE8L PIC S9(0004) COMP.
  1125     05  FNLINE8F PIC  X(0001).
  1126     05  FILLER REDEFINES FNLINE8F.
  1127         10  FNLINE8A PIC  X(0001).
  1128     05  FNLINE8I PIC  X(0077).
  1129*    -------------------------------
  1130     05  FNLINE9L PIC S9(0004) COMP.
  1131     05  FNLINE9F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  24
* EL1276.cbl
  1132     05  FILLER REDEFINES FNLINE9F.
  1133         10  FNLINE9A PIC  X(0001).
  1134     05  FNLINE9I PIC  X(0077).
  1135*    -------------------------------
  1136     05  FNLINEAL PIC S9(0004) COMP.
  1137     05  FNLINEAF PIC  X(0001).
  1138     05  FILLER REDEFINES FNLINEAF.
  1139         10  FNLINEAA PIC  X(0001).
  1140     05  FNLINEAI PIC  X(0077).
  1141*    -------------------------------
  1142     05  FERRMSGL PIC S9(0004) COMP.
  1143     05  FERRMSGF PIC  X(0001).
  1144     05  FILLER REDEFINES FERRMSGF.
  1145         10  FERRMSGA PIC  X(0001).
  1146     05  FERRMSGI PIC  X(0077).
  1147*    -------------------------------
  1148     05  FPFENTRL PIC S9(0004) COMP.
  1149     05  FPFENTRF PIC  X(0001).
  1150     05  FILLER REDEFINES FPFENTRF.
  1151         10  FPFENTRA PIC  X(0001).
  1152     05  FPFENTRI PIC  99.
  1153*    -------------------------------
  1154     05  FPF7HL PIC S9(0004) COMP.
  1155     05  FPF7HF PIC  X(0001).
  1156     05  FILLER REDEFINES FPF7HF.
  1157         10  FPF7HA PIC  X(0001).
  1158     05  FPF7HI PIC  X(0016).
  1159 01  EL127FO REDEFINES EL127FI.
  1160     05  FILLER            PIC  X(0012).
  1161*    -------------------------------
  1162     05  FILLER            PIC  X(0003).
  1163     05  FDATEO PIC  X(0008).
  1164*    -------------------------------
  1165     05  FILLER            PIC  X(0003).
  1166     05  FTIMEO PIC  99.99.
  1167*    -------------------------------
  1168     05  FILLER            PIC  X(0003).
  1169     05  CMPNYIDO PIC  X(0003).
  1170*    -------------------------------
  1171     05  FILLER            PIC  X(0003).
  1172     05  USERIDO PIC  X(0004).
  1173*    -------------------------------
  1174     05  FILLER            PIC  X(0003).
  1175     05  FMAINTO PIC  X(0001).
  1176*    -------------------------------
  1177     05  FILLER            PIC  X(0003).
  1178     05  FCERTO PIC  X(0010).
  1179*    -------------------------------
  1180     05  FILLER            PIC  X(0003).
  1181     05  FCRTSFXO PIC  X(0001).
  1182*    -------------------------------
  1183     05  FILLER            PIC  X(0003).
  1184     05  FACOUNTO PIC  X(0010).
  1185*    -------------------------------
  1186     05  FILLER            PIC  X(0003).
  1187     05  FSTO PIC  X(0002).
  1188*    -------------------------------
  1189     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  25
* EL1276.cbl
  1190     05  FCARRIRO PIC  X(0001).
  1191*    -------------------------------
  1192     05  FILLER            PIC  X(0003).
  1193     05  FGROUPO PIC  X(0006).
  1194*    -------------------------------
  1195     05  FILLER            PIC  X(0003).
  1196     05  FEFFDTO PIC  X(0008).
  1197*    -------------------------------
  1198     05  FILLER            PIC  X(0003).
  1199     05  FBSTARTO PIC  99.
  1200*    -------------------------------
  1201     05  FILLER            PIC  X(0003).
  1202     05  MAINTONO PIC  X(0008).
  1203*    -------------------------------
  1204     05  FILLER            PIC  X(0003).
  1205     05  MAINTATO PIC  99.99.
  1206*    -------------------------------
  1207     05  FILLER            PIC  X(0003).
  1208     05  MAINTBYO PIC  X(0004).
  1209*    -------------------------------
  1210     05  FILLER            PIC  X(0003).
  1211     05  FBENDO PIC  99.
  1212*    -------------------------------
  1213     05  FILLER            PIC  X(0003).
  1214     05  FCERTYNO PIC  X(0003).
  1215*    -------------------------------
  1216     05  FILLER            PIC  X(0003).
  1217     05  FCLMYNO PIC  X(0003).
  1218*    -------------------------------
  1219     05  FILLER            PIC  X(0003).
  1220     05  FHEADO PIC  X(0025).
  1221*    -------------------------------
  1222     05  FILLER            PIC  X(0003).
  1223     05  FNLINE1O PIC  X(0077).
  1224*    -------------------------------
  1225     05  FILLER            PIC  X(0003).
  1226     05  FNLINE2O PIC  X(0077).
  1227*    -------------------------------
  1228     05  FILLER            PIC  X(0003).
  1229     05  FNLINE3O PIC  X(0077).
  1230*    -------------------------------
  1231     05  FILLER            PIC  X(0003).
  1232     05  FNLINE4O PIC  X(0077).
  1233*    -------------------------------
  1234     05  FILLER            PIC  X(0003).
  1235     05  FNLINE5O PIC  X(0077).
  1236*    -------------------------------
  1237     05  FILLER            PIC  X(0003).
  1238     05  FNLINE6O PIC  X(0077).
  1239*    -------------------------------
  1240     05  FILLER            PIC  X(0003).
  1241     05  FNLINE7O PIC  X(0077).
  1242*    -------------------------------
  1243     05  FILLER            PIC  X(0003).
  1244     05  FNLINE8O PIC  X(0077).
  1245*    -------------------------------
  1246     05  FILLER            PIC  X(0003).
  1247     05  FNLINE9O PIC  X(0077).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  26
* EL1276.cbl
  1248*    -------------------------------
  1249     05  FILLER            PIC  X(0003).
  1250     05  FNLINEAO PIC  X(0077).
  1251*    -------------------------------
  1252     05  FILLER            PIC  X(0003).
  1253     05  FERRMSGO PIC  X(0077).
  1254*    -------------------------------
  1255     05  FILLER            PIC  X(0003).
  1256     05  FPFENTRO PIC  X(0002).
  1257*    -------------------------------
  1258     05  FILLER            PIC  X(0003).
  1259     05  FPF7HO PIC  X(0016).
  1260*    -------------------------------
  1261
  1262 01  FILLER REDEFINES EL127FO.
  1263     05  FILLER                      PIC X(183).
  1264     05  DNOTE-LINES   OCCURS 10 TIMES.
  1265         10  DNOTE-LINE-LENGTH       PIC S9(4) COMP.
  1266         10  DNOTE-LINE-ATTRB        PIC X.
  1267         10  DNOTE-LINE              PIC X(77).
  1268     05  FILLER                      PIC X(104).
  1269
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  27
* EL1276.cbl
  1271
  1272****************************************************************
  1273*
  1274* Copyright (c) 2007-2013 Dell Inc.
  1275* All rights reserved.
  1276*
  1277****************************************************************
  1278 01  DFHEIV.
  1279   02  DFHEIV0               PIC X(35).
  1280   02  DFHEIV1               PIC X(08).
  1281   02  DFHEIV2               PIC X(08).
  1282   02  DFHEIV3               PIC X(08).
  1283   02  DFHEIV4               PIC X(06).
  1284   02  DFHEIV5               PIC X(04).
  1285   02  DFHEIV6               PIC X(04).
  1286   02  DFHEIV7               PIC X(02).
  1287   02  DFHEIV8               PIC X(02).
  1288   02  DFHEIV9               PIC X(01).
  1289   02  DFHEIV10              PIC S9(7) COMP-3.
  1290   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1291   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1292   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1293   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1294   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1295   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1296   02  DFHEIV17              PIC X(04).
  1297   02  DFHEIV18              PIC X(04).
  1298   02  DFHEIV19              PIC X(04).
  1299   02  DFHEIV20              USAGE IS POINTER.
  1300   02  DFHEIV21              USAGE IS POINTER.
  1301   02  DFHEIV22              USAGE IS POINTER.
  1302   02  DFHEIV23              USAGE IS POINTER.
  1303   02  DFHEIV24              USAGE IS POINTER.
  1304   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1305   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1306   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1307   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1308   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1309   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1310   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1311   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1312   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1313   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1314   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1315   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1316   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1317   02  FILLER                PIC X(02).
  1318   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1319   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1320   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1321   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1322   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1323   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1324   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1325 LINKAGE  SECTION.
  1326*****************************************************************
  1327*                                                               *
  1328* Copyright (c) 2007-2013 Dell Inc.                             *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  28
* EL1276.cbl
  1329* All rights reserved.                                          *
  1330*                                                               *
  1331*****************************************************************
  1332 01  dfheiblk.
  1333     02  eibtime          pic s9(7) comp-3.
  1334     02  eibdate          pic s9(7) comp-3.
  1335     02  eibtrnid         pic x(4).
  1336     02  eibtaskn         pic s9(7) comp-3.
  1337     02  eibtrmid         pic x(4).
  1338     02  dfheigdi         pic s9(4) comp.
  1339     02  eibcposn         pic s9(4) comp.
  1340     02  eibcalen         pic s9(4) comp.
  1341     02  eibaid           pic x(1).
  1342     02  eibfiller1       pic x(1).
  1343     02  eibfn            pic x(2).
  1344     02  eibfiller2       pic x(2).
  1345     02  eibrcode         pic x(6).
  1346     02  eibfiller3       pic x(2).
  1347     02  eibds            pic x(8).
  1348     02  eibreqid         pic x(8).
  1349     02  eibrsrce         pic x(8).
  1350     02  eibsync          pic x(1).
  1351     02  eibfree          pic x(1).
  1352     02  eibrecv          pic x(1).
  1353     02  eibsend          pic x(1).
  1354     02  eibatt           pic x(1).
  1355     02  eibeoc           pic x(1).
  1356     02  eibfmh           pic x(1).
  1357     02  eibcompl         pic x(1).
  1358     02  eibsig           pic x(1).
  1359     02  eibconf          pic x(1).
  1360     02  eiberr           pic x(1).
  1361     02  eibrldbk         pic x(1).
  1362     02  eiberrcd         pic x(4).
  1363     02  eibsynrb         pic x(1).
  1364     02  eibnodat         pic x(1).
  1365     02  eibfiller5       pic x(2).
  1366     02  eibresp          pic s9(8) comp.
  1367     02  eibresp2         pic s9(8) comp.
  1368     02  dfheigdj         pic s9(4) comp.
  1369     02  dfheigdk         pic s9(4) comp.
  1370 01  DFHCOMMAREA                     PIC X(1024).
  1371
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  29
* EL1276.cbl
  1373
  1374*    COPY ERCNOTE.
  1375******************************************************************
  1376*                                                                *
  1377*                                                                *
  1378*                            ERCNOTE                             *
  1379*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1380*                            VMOD=2.003                          *
  1381*                                                                *
  1382*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  1383*                                                                *
  1384*        FILE TYPE= VSAM,KSDS                                    *
  1385*        RECORD SIZE = 825    RECFORM = FIXED                    *
  1386*                                                                *
  1387*        BASE CLUSTER = ERNOTE        RKP=2,LEN=34               *
  1388*                                                                *
  1389*        LOG = YES                                               *
  1390*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1391*                                                                *
  1392******************************************************************
  1393*                   C H A N G E   L O G
  1394*
  1395* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1396*-----------------------------------------------------------------
  1397*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1398* EFFECTIVE    NUMBER
  1399*-----------------------------------------------------------------
  1400* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  1401*                                FILE WILL CONTAIN BILLING NOTES O
  1402* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
  1403******************************************************************
  1404
  1405 01  CERTIFICATE-NOTE.
  1406     12  CN-RECORD-ID                PIC  XX.
  1407         88  VALID-CN-ID                  VALUE 'CN'.
  1408
  1409     12  CN-CONTROL-PRIMARY.
  1410         16  CN-COMPANY-CD           PIC X.
  1411         16  CN-CARRIER              PIC X.
  1412         16  CN-GROUPING.
  1413             20 CN-GROUPING-PREFIX   PIC XXX.
  1414             20 CN-GROUPING-PRIME    PIC XXX.
  1415         16  CN-STATE                PIC XX.
  1416         16  CN-ACCOUNT.
  1417             20 CN-ACCOUNT-PREFIX    PIC X(4).
  1418             20 CN-ACCOUNT-PRIME     PIC X(6).
  1419         16  CN-CERT-EFF-DT          PIC XX.
  1420         16  CN-CERT-NO.
  1421             20  CN-CERT-PRIME       PIC X(10).
  1422             20  CN-CERT-SFX         PIC X.
  1423         16  CN-RECORD-TYPE          PIC X.
  1424             88  CN-ISSUE-BILLING-NOTE    VALUE '1'.
  1425             88  CN-CANCEL-BILLING-NOTE   VALUE '2'.
  1426     12  CN-BILLING-START-LINE-NO    PIC 99.
  1427     12  CN-BILLING-END-LINE-NO      PIC 99.
  1428
  1429     12  CN-LINES.
  1430         16  CN-LINE OCCURS 10       PIC X(77).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  30
* EL1276.cbl
  1431
  1432     12  CN-LAST-MAINT-DT            PIC XX.
  1433     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1434     12  CN-LAST-MAINT-USER          PIC X(4).
  1435     12  FILLER                      PIC X(5).
  1436******************************************************************
  1437
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  31
* EL1276.cbl
  1439
  1440*    COPY ELCCERT.
  1441******************************************************************
  1442*                                                                *
  1443*                            ELCCERT.                            *
  1444*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1445*                            VMOD=2.013                          *
  1446*                                                                *
  1447*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  1448*                                                                *
  1449*   FILE TYPE = VSAM,KSDS                                        *
  1450*   RECORD SIZE = 450  RECFORM = FIXED                           *
  1451*                                                                *
  1452*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  1453*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  1454*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  1455*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  1456*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  1457*                                                                *
  1458*   LOG = YES                                                    *
  1459*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1460******************************************************************
  1461*                   C H A N G E   L O G
  1462*
  1463* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1464*-----------------------------------------------------------------
  1465*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1466* EFFECTIVE    NUMBER
  1467*-----------------------------------------------------------------
  1468* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  1469* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  1470* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  1471* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  1472* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  1473* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  1474* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1475* 032612  CR2011110200001  PEMA  AHL CHANGES
  1476* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  1477* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  1478* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  1479******************************************************************
  1480
  1481 01  CERTIFICATE-MASTER.
  1482     12  CM-RECORD-ID                      PIC XX.
  1483         88  VALID-CM-ID                      VALUE 'CM'.
  1484
  1485     12  CM-CONTROL-PRIMARY.
  1486         16  CM-COMPANY-CD                 PIC X.
  1487         16  CM-CARRIER                    PIC X.
  1488         16  CM-GROUPING.
  1489             20  CM-GROUPING-PREFIX        PIC X(3).
  1490             20  CM-GROUPING-PRIME         PIC X(3).
  1491         16  CM-STATE                      PIC XX.
  1492         16  CM-ACCOUNT.
  1493             20  CM-ACCOUNT-PREFIX         PIC X(4).
  1494             20  CM-ACCOUNT-PRIME          PIC X(6).
  1495         16  CM-CERT-EFF-DT                PIC XX.
  1496         16  CM-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  32
* EL1276.cbl
  1497             20  CM-CERT-PRIME             PIC X(10).
  1498             20  CM-CERT-SFX               PIC X.
  1499
  1500     12  CM-CONTROL-BY-NAME.
  1501         16  CM-COMPANY-CD-A1              PIC X.
  1502         16  CM-INSURED-LAST-NAME          PIC X(15).
  1503         16  CM-INSURED-INITIALS.
  1504             20  CM-INSURED-INITIAL1       PIC X.
  1505             20  CM-INSURED-INITIAL2       PIC X.
  1506
  1507     12  CM-CONTROL-BY-SSN.
  1508         16  CM-COMPANY-CD-A2              PIC X.
  1509         16  CM-SOC-SEC-NO.
  1510             20  CM-SSN-STATE              PIC XX.
  1511             20  CM-SSN-ACCOUNT            PIC X(6).
  1512             20  CM-SSN-LN3.
  1513                 25  CM-INSURED-INITIALS-A2.
  1514                     30 CM-INSURED-INITIAL1-A2   PIC X.
  1515                     30 CM-INSURED-INITIAL2-A2   PIC X.
  1516                 25 CM-PART-LAST-NAME-A2         PIC X.
  1517
  1518     12  CM-CONTROL-BY-CERT-NO.
  1519         16  CM-COMPANY-CD-A4              PIC X.
  1520         16  CM-CERT-NO-A4                 PIC X(11).
  1521
  1522     12  CM-CONTROL-BY-MEMB.
  1523         16  CM-COMPANY-CD-A5              PIC X.
  1524         16  CM-MEMBER-NO.
  1525             20  CM-MEMB-STATE             PIC XX.
  1526             20  CM-MEMB-ACCOUNT           PIC X(6).
  1527             20  CM-MEMB-LN4.
  1528                 25  CM-INSURED-INITIALS-A5.
  1529                     30 CM-INSURED-INITIAL1-A5   PIC X.
  1530                     30 CM-INSURED-INITIAL2-A5   PIC X.
  1531                 25 CM-PART-LAST-NAME-A5         PIC XX.
  1532
  1533     12  CM-INSURED-PROFILE-DATA.
  1534         16  CM-INSURED-FIRST-NAME.
  1535             20  CM-INSURED-1ST-INIT       PIC X.
  1536             20  FILLER                    PIC X(9).
  1537         16  CM-INSURED-ISSUE-AGE          PIC 99.
  1538         16  CM-INSURED-SEX                PIC X.
  1539             88  CM-SEX-MALE                  VALUE 'M'.
  1540             88  CM-SEX-FEMAL                 VALUE 'F'.
  1541         16  CM-INSURED-JOINT-AGE          PIC 99.
  1542         16  CM-JOINT-INSURED-NAME.
  1543             20  CM-JT-LAST-NAME           PIC X(15).
  1544             20  CM-JT-FIRST-NAME.
  1545                 24  CM-JT-1ST-INIT        PIC X.
  1546                 24  FILLER                PIC X(9).
  1547             20  CM-JT-INITIAL             PIC X.
  1548
  1549     12  CM-LIFE-DATA.
  1550         16  CM-LF-BENEFIT-CD              PIC XX.
  1551         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  1552         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  1553         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  1554         16  CM-LF-DEV-CODE                PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  33
* EL1276.cbl
  1555         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1556         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  1557         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1558         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  1559         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1560         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1561         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  1562         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1563         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  1564         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1565         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  1566         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  1567         16  cm-temp-epiq                  pic xx.
  1568             88  EPIQ-CLASS                  value 'EQ'.
  1569*        16  FILLER                        PIC XX.
  1570
  1571     12  CM-AH-DATA.
  1572         16  CM-AH-BENEFIT-CD              PIC XX.
  1573         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  1574         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  1575         16  CM-AH-DEV-CODE                PIC XXX.
  1576         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  1577         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  1578         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  1579         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  1580         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  1581         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  1582         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  1583         16  CM-AH-PAID-THRU-DT            PIC XX.
  1584             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  1585         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  1586         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  1587         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  1588         16  FILLER                        PIC X.
  1589
  1590     12  CM-LOAN-INFORMATION.
  1591         16  CM-LIVES                      PIC S9(7)     COMP-3.
  1592         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  1593                                           PIC S9(5)V99  COMP-3.
  1594         16  CM-BILLED                     PIC S9(7)     COMP-3.
  1595         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  1596         16  CM-PAY-FREQUENCY              PIC S99.
  1597         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  1598         16  CM-RATE-CLASS                 PIC XX.
  1599         16  CM-BENEFICIARY                PIC X(25).
  1600         16  CM-POLICY-FORM-NO             PIC X(12).
  1601         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  1602         16  CM-LAST-ADD-ON-DT             PIC XX.
  1603         16  CM-DEDUCTIBLE-AMOUNTS.
  1604             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  1605             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  1606         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1607             20  CM-RESIDENT-STATE         PIC XX.
  1608             20  CM-RATE-CODE              PIC X(4).
  1609             20  FILLER                    PIC XX.
  1610         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  1611             20  CM-LOAN-OFFICER           PIC X(5).
  1612             20  FILLER                    PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  34
* EL1276.cbl
  1613         16  CM-CSR-CODE                   PIC XXX.
  1614         16  CM-UNDERWRITING-CODE          PIC X.
  1615             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  1616         16  CM-POST-CARD-IND              PIC X.
  1617         16  CM-REF-INTERFACE-SW           PIC X.
  1618         16  CM-PREMIUM-TYPE               PIC X.
  1619             88  CM-SING-PRM                  VALUE '1'.
  1620             88  CM-O-B-COVERAGE              VALUE '2'.
  1621             88  CM-OPEN-END                  VALUE '3'.
  1622         16  CM-IND-GRP-TYPE               PIC X.
  1623             88  CM-INDIVIDUAL                VALUE 'I'.
  1624             88  CM-GROUP                     VALUE 'G'.
  1625         16  CM-SKIP-CODE                  PIC X.
  1626             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  1627             88  SKIP-JULY                    VALUE '1'.
  1628             88  SKIP-AUGUST                  VALUE '2'.
  1629             88  SKIP-SEPTEMBER               VALUE '3'.
  1630             88  SKIP-JULY-AUG                VALUE '4'.
  1631             88  SKIP-AUG-SEPT                VALUE '5'.
  1632             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  1633             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  1634             88  SKIP-JUNE                    VALUE '8'.
  1635             88  SKIP-JUNE-JULY               VALUE '9'.
  1636             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  1637             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  1638         16  CM-PAYMENT-MODE               PIC X.
  1639             88  PAY-MONTHLY                  VALUE SPACE.
  1640             88  PAY-WEEKLY                   VALUE '1'.
  1641             88  PAY-SEMI-MONTHLY             VALUE '2'.
  1642             88  PAY-BI-WEEKLY                VALUE '3'.
  1643             88  PAY-SEMI-ANUALLY             VALUE '4'.
  1644         16  CM-LOAN-NUMBER                PIC X(8).
  1645         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  1646         16  CM-OLD-LOF                    PIC XXX.
  1647*        16  CM-LOAN-OFFICER               PIC XXX.
  1648         16  CM-REIN-TABLE                 PIC XXX.
  1649         16  CM-SPECIAL-REIN-CODE          PIC X.
  1650         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  1651         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  1652         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  1653
  1654     12  CM-STATUS-DATA.
  1655         16  CM-ENTRY-STATUS               PIC X.
  1656         16  CM-ENTRY-DT                   PIC XX.
  1657
  1658         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  1659         16  CM-LF-CANCEL-DT               PIC XX.
  1660         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  1661
  1662         16  CM-LF-STATUS-AT-DEATH         PIC X.
  1663         16  CM-LF-DEATH-DT                PIC XX.
  1664         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  1665
  1666         16  CM-LF-CURRENT-STATUS          PIC X.
  1667             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1668                                                'M' '4' '5' '9'.
  1669             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  1670             88  CM-LF-POLICY-PENDING         VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  35
* EL1276.cbl
  1671             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  1672             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  1673             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  1674             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  1675             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  1676             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  1677             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  1678             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  1679             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  1680             88  CM-LF-DECLINED               VALUE 'D'.
  1681             88  CM-LF-VOIDED                 VALUE 'V'.
  1682
  1683         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  1684         16  CM-AH-CANCEL-DT               PIC XX.
  1685         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  1686
  1687         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  1688         16  CM-AH-SETTLEMENT-DT           PIC XX.
  1689         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  1690
  1691         16  CM-AH-CURRENT-STATUS          PIC X.
  1692             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  1693                                                'M' '4' '5' '9'.
  1694             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  1695             88  CM-AH-POLICY-PENDING         VALUE '2'.
  1696             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  1697             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  1698             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  1699             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  1700             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  1701             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  1702             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  1703             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  1704             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  1705             88  CM-AH-DECLINED               VALUE 'D'.
  1706             88  CM-AH-VOIDED                 VALUE 'V'.
  1707
  1708         16  CM-CLAIM-INTERFACE-SW         PIC X.
  1709             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  1710             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  1711             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  1712         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  1713
  1714         16  CM-ENTRY-BATCH                PIC X(6).
  1715         16  CM-LF-EXIT-BATCH              PIC X(6).
  1716         16  CM-AH-EXIT-BATCH              PIC X(6).
  1717         16  CM-LAST-MONTH-END             PIC XX.
  1718
  1719     12  CM-NOTE-SW                        PIC X.
  1720         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  1721         88  CERT-NOTES-PRESENT               VALUE '1'.
  1722         88  BILLING-NOTES-PRESENT            VALUE '2'.
  1723         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  1724         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  1725         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  1726         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  1727         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  1728     12  CM-COMP-EXCP-SW                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  36
* EL1276.cbl
  1729         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  1730         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  1731     12  CM-INSURED-ADDRESS-SW             PIC X.
  1732         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  1733         88  INSURED-ADDR-PRESENT             VALUE '1'.
  1734
  1735*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  1736     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  1737     12  FILLER                            PIC X.
  1738
  1739*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  1740     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  1741     12  FILLER                            PIC X.
  1742*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  1743     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  1744
  1745     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  1746         88  CERT-ADDED-BATCH                 VALUE ' '.
  1747         88  CERT-ADDED-ONLINE                VALUE '1'.
  1748         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  1749         88  CERT-PURGED-OFFLINE              VALUE '3'.
  1750         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  1751     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  1752         88  CERT-AS-LOADED                   VALUE ' '.
  1753         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  1754         88  CERT-CLAIM-ONLINE                VALUE '2'.
  1755         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  1756         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  1757         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  1758         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  1759         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  1760
  1761     12  CM-ACCOUNT-COMM-PCTS.
  1762         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  1763         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  1764
  1765     12  CM-USER-FIELD                     PIC X.
  1766     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  1767     12  CM-CLP-STATE                      PIC XX.
  1768     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  1769     12  CM-USER-RESERVED                  PIC XXX.
  1770     12  FILLER REDEFINES CM-USER-RESERVED.
  1771         16  CM-AH-CLASS-CD                PIC XX.
  1772         16  F                             PIC X.
  1773******************************************************************
  1774
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  37
* EL1276.cbl
  1776
  1777 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CERTIFICATE-NOTE
  1778                          CERTIFICATE-MASTER.
  1779 0000-DFHEXIT SECTION.
  1780     MOVE '9#                    $   ' TO DFHEIV0.
  1781     MOVE 'EL1276' TO DFHEIV1.
  1782     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1783
  1784     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  1785     MOVE '5'                    TO  DC-OPTION-CODE.
  1786     PERFORM 9700-DATE-LINK.
  1787     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1788     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  1789
  1790     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  1791     MOVE 1                      TO  EMI-NUMBER-OF-LINES.
  1792     MOVE EIBTRMID               TO  QID-TERM.
  1793
  1794     IF EIBCALEN = 0
  1795         GO TO 8800-UNAUTHORIZED-ACCESS.
  1796
  1797     IF PI-CALLING-PROGRAM = PGM-1279
  1798         move pi-iss-can-trans   to pi-active-notes
  1799         MOVE THIS-PGM           TO PI-CALLING-PROGRAM
  1800     END-IF.
  1801
  1802     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1803         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1804             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1805             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1806             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1807             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1808             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1809             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1810             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1811             MOVE THIS-PGM TO PI-CALLING-PROGRAM
  1812         ELSE
  1813             MOVE PI-CALLING-PROGRAM   TO RETURN-FROM
  1814             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1815             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1816             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1817             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1818             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1819             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1820             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1821             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  1822
  1823
  1824* EXEC CICS HANDLE AID
  1825*         CLEAR(9400-CLEAR)
  1826*    END-EXEC.
  1827*    MOVE '"&=                  V! " #00001819' TO DFHEIV0
  1828     MOVE X'22263D202020202020202020' TO DFHEIV0(1:12)
  1829     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  1830     MOVE X'2220233030303031383139' TO DFHEIV0(25:11)
  1831     CALL 'kxdfhei1' USING DFHEIV0
  1832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1833
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  38
* EL1276.cbl
  1834*     IF EIBAID = DFHCLEAR
  1835*         GO TO 9400-CLEAR.
  1836
  1837     IF PI-PROCESSOR-ID = 'LGXX'
  1838         NEXT SENTENCE
  1839     ELSE
  1840
  1841* EXEC CICS READQ TS
  1842*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  1843*            INTO    (SECURITY-CONTROL)
  1844*            LENGTH  (SC-COMM-LENGTH)
  1845*            ITEM    (SC-ITEM)
  1846*        END-EXEC
  1847*    MOVE '*$II   L              ''   #00001828' TO DFHEIV0
  1848     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1849     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1850     MOVE X'2020233030303031383238' TO DFHEIV0(25:11)
  1851     CALL 'kxdfhei1' USING DFHEIV0,
  1852           PI-SECURITY-TEMP-STORE-ID,
  1853           SECURITY-CONTROL,
  1854           SC-COMM-LENGTH,
  1855           SC-ITEM,
  1856           DFHEIV99,
  1857           DFHEIV99
  1858     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1859         MOVE SC-CREDIT-DISPLAY (32)   TO  PI-DISPLAY-CAP
  1860         MOVE SC-CREDIT-UPDATE  (32)   TO  PI-MODIFY-CAP
  1861         IF NOT DISPLAY-CAP
  1862             MOVE 'READ'               TO  SM-READ
  1863             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1864             MOVE ER-0070              TO  EMI-ERROR
  1865             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1866             GO TO 8100-SEND-INITIAL-MAP.
  1867
  1868     IF  EIBTRNID NOT = TRANS-ID
  1869         MOVE LOW-VALUES         TO  EL127FI
  1870         PERFORM 7000-FORMAT-SCREEN
  1871         GO TO 8100-SEND-INITIAL-MAP.
  1872
  1873
  1874* EXEC CICS    HANDLE    CONDITION
  1875*         PGMIDERR          (9600-PGMID-ERROR)
  1876*         ERROR             (9990-ABEND)
  1877*         END-EXEC.
  1878*    MOVE '"$L.                  ! # #00001848' TO DFHEIV0
  1879     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1880     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1881     MOVE X'2320233030303031383438' TO DFHEIV0(25:11)
  1882     CALL 'kxdfhei1' USING DFHEIV0
  1883     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1884
  1885
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  39
* EL1276.cbl
  1887
  1888 0200-RECEIVE.
  1889     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1890         MOVE ER-0008            TO  EMI-ERROR
  1891         PERFORM 9900-ERROR-FORMAT
  1892         MOVE -1                 TO  FMAINTL
  1893         GO TO 8200-SEND-DATAONLY.
  1894
  1895
  1896* EXEC CICS RECEIVE
  1897*        MAP      (MAP-NAME)
  1898*        MAPSET   (MAPSET-NAME)
  1899*        INTO     (EL127FI)
  1900*    END-EXEC.
  1901     MOVE LENGTH OF
  1902      EL127FI
  1903       TO DFHEIV11
  1904*    MOVE '8"T I  L              ''   #00001862' TO DFHEIV0
  1905     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1906     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1907     MOVE X'2020233030303031383632' TO DFHEIV0(25:11)
  1908     CALL 'kxdfhei1' USING DFHEIV0,
  1909           MAP-NAME,
  1910           EL127FI,
  1911           DFHEIV11,
  1912           MAPSET-NAME,
  1913           DFHEIV99,
  1914           DFHEIV99
  1915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1916
  1917
  1918     IF FPFENTRL = 0
  1919         GO TO 0300-CHECK-PFKEYS.
  1920
  1921     IF EIBAID NOT = DFHENTER
  1922         MOVE ER-0004            TO  EMI-ERROR
  1923         GO TO 0320-INPUT-ERROR.
  1924
  1925     IF  FPFENTRI NUMERIC
  1926         IF  FPFENTRI = '12' OR '23' OR '24'
  1927             MOVE PF-VALUES (FPFENTRI)   TO  EIBAID
  1928         ELSE
  1929             MOVE ER-0029                TO  EMI-ERROR
  1930             GO TO 0320-INPUT-ERROR.
  1931
  1932 0300-CHECK-PFKEYS.
  1933     IF EIBAID = DFHPF23
  1934         GO TO 8810-PF23.
  1935
  1936     IF EIBAID = DFHPF24
  1937         GO TO 9200-RETURN-MAIN-MENU.
  1938
  1939     IF EIBAID = DFHPF12
  1940         GO TO 9500-PF12.
  1941
  1942     IF EIBAID = DFHPF5
  1943         MOVE PGM-1279         TO PGM-NAME
  1944         SET PI-CERT-NOTE     TO TRUE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  40
* EL1276.cbl
  1945         GO TO 9300-XCTL
  1946     END-IF.
  1947
  1948     IF EIBAID = DFHPF6
  1949         MOVE PGM-1279         TO PGM-NAME
  1950         SET PI-CLAIM-NOTE     TO TRUE
  1951         GO TO 9300-XCTL
  1952     END-IF.
  1953     if eibaid = dfhpf7
  1954        if pi-cancel-notes
  1955           set pi-issue-notes to true
  1956        else
  1957           set pi-cancel-notes to true
  1958        end-if
  1959        perform 7000-format-screen
  1960        go to 8100-send-initial-map
  1961     end-if
  1962     IF EIBAID = DFHENTER
  1963         GO TO 400-EDIT-INPUT-DATA.
  1964
  1965     MOVE ER-0029                TO  EMI-ERROR.
  1966
  1967 0320-INPUT-ERROR.
  1968     PERFORM 9900-ERROR-FORMAT.
  1969     MOVE AL-UNBON               TO  FPFENTRA.
  1970
  1971     IF FPFENTRL = 0
  1972         MOVE -1                 TO  FMAINTL
  1973     ELSE
  1974         MOVE -1                 TO  FPFENTRL.
  1975
  1976     GO TO 8200-SEND-DATAONLY.
  1977
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  41
* EL1276.cbl
  1979
  1980 400-EDIT-INPUT-DATA.
  1981     IF FMAINTI = 'A' OR 'C' OR 'D'
  1982         NEXT SENTENCE
  1983     ELSE
  1984         MOVE ER-0023            TO  EMI-ERROR
  1985         MOVE -1                 TO  FMAINTL
  1986         MOVE AL-UABON           TO  FMAINTA
  1987         PERFORM 9900-ERROR-FORMAT
  1988         GO TO 8200-SEND-DATAONLY.
  1989     IF NOT MODIFY-CAP
  1990        MOVE 'UPDATE'            TO SM-READ
  1991        PERFORM 9995-SECURITY-VIOLATION
  1992                                 THRU 9995-EXIT
  1993        MOVE ER-0070             TO EMI-ERROR
  1994        PERFORM 9900-ERROR-FORMAT
  1995                                 THRU 9900-EXIT
  1996        GO TO 8100-SEND-INITIAL-MAP
  1997     END-IF
  1998     IF FMAINTI = 'D'
  1999         GO TO 410-CHECK-ERRORS.
  2000
  2001     IF FBSTARTL GREATER THAN ZERO
  2002        IF FBSTARTI NOT NUMERIC
  2003            MOVE ER-2520         TO  EMI-ERROR
  2004            MOVE AL-UNBON        TO  FBSTARTA
  2005            MOVE -1              TO  FBSTARTL
  2006            PERFORM 9900-ERROR-FORMAT
  2007        ELSE
  2008            IF FBSTARTI LESS '01' OR GREATER '10'
  2009                MOVE ER-2520     TO  EMI-ERROR
  2010                MOVE -1          TO  FBSTARTL
  2011                PERFORM 9900-ERROR-FORMAT.
  2012
  2013     IF FBENDL GREATER THAN ZERO
  2014        IF FBENDI NOT NUMERIC
  2015            MOVE ER-2521         TO  EMI-ERROR
  2016            MOVE AL-UNBON        TO  FBENDA
  2017            MOVE -1              TO  FBENDL
  2018            PERFORM 9900-ERROR-FORMAT
  2019        ELSE
  2020            IF FBENDI LESS '01' OR GREATER '10'
  2021                MOVE ER-2521     TO  EMI-ERROR
  2022                MOVE -1          TO  FBENDL
  2023                PERFORM 9900-ERROR-FORMAT.
  2024
  2025     IF FBENDL GREATER THAN ZEROS
  2026        IF FBSTARTL = ZEROS
  2027            MOVE ER-2524         TO  EMI-ERROR
  2028            MOVE -1              TO  FBSTARTL
  2029            PERFORM 9900-ERROR-FORMAT
  2030            GO TO 410-CHECK-ERRORS.
  2031
  2032     IF FBSTARTL = ZERO OR
  2033        FBENDL   = ZERO
  2034           GO TO 410-CHECK-ERRORS.
  2035
  2036     IF FBSTARTI GREATER THAN FBENDI
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  42
* EL1276.cbl
  2037         MOVE ER-2522            TO  EMI-ERROR
  2038         MOVE -1                 TO  FBSTARTL
  2039         PERFORM 9900-ERROR-FORMAT.
  2040
  2041 410-CHECK-ERRORS.
  2042     IF EMI-ERROR = ZEROS
  2043        NEXT SENTENCE
  2044     ELSE
  2045         GO TO 8200-SEND-DATAONLY.
  2046
  2047     IF FMAINTI = 'A'
  2048         GO TO 1000-ADD-RECORD.
  2049
  2050     IF FMAINTI = 'C'
  2051         GO TO 2000-CHANGE-RECORD.
  2052
  2053     GO TO 3000-DELETE-RECORD.
  2054
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  43
* EL1276.cbl
  2056
  2057 1000-ADD-RECORD       SECTION.
  2058
  2059
  2060* EXEC CICS GETMAIN
  2061*        SET      (ADDRESS OF CERTIFICATE-NOTE)
  2062*        LENGTH   (825)
  2063*        INITIMG  (GETMAIN-SPACE)
  2064*    END-EXEC.
  2065     MOVE 825
  2066       TO DFHEIV11
  2067*    MOVE ',"IL                  $   #00002009' TO DFHEIV0
  2068     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  2069     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2070     MOVE X'2020233030303032303039' TO DFHEIV0(25:11)
  2071     CALL 'kxdfhei1' USING DFHEIV0,
  2072           DFHEIV20,
  2073           DFHEIV11,
  2074           GETMAIN-SPACE
  2075     SET ADDRESS OF CERTIFICATE-NOTE TO
  2076         DFHEIV20
  2077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2078
  2079
  2080     MOVE  SPACES                TO  CERTIFICATE-NOTE.
  2081
  2082     MOVE  'CN'                  TO  CN-RECORD-ID.
  2083
  2084     MOVE  PI-CARRIER            TO  WS-CN-CARRIER
  2085     MOVE  PI-GROUPING           TO  WS-CN-GROUPING
  2086     MOVE  PI-STATE              TO  WS-CN-STATE
  2087     MOVE  PI-ACCOUNT            TO  WS-CN-ACCOUNT
  2088     MOVE  PI-CERT-PRIME         TO  WS-CN-CERT-PRIME
  2089     MOVE  PI-CERT-SFX           TO  WS-CN-CERT-SFX
  2090     MOVE  PI-CERT-EFF-DT        TO  WS-CN-CERT-EFF-DT
  2091     MOVE  PI-COMPANY-CD         TO  WS-CN-COMPANY-CD
  2092     IF PI-CANCEL-NOTES
  2093        MOVE '2'                 TO  WS-CN-RECORD-TYPE
  2094     ELSE
  2095        MOVE '1'                 TO  WS-CN-RECORD-TYPE
  2096     END-IF
  2097
  2098     MOVE  WS-CN-CONTROL-PRIMARY TO  CN-CONTROL-PRIMARY
  2099                                     ws-cm-control-primary
  2100
  2101     IF FBSTARTL GREATER ZERO
  2102         MOVE FBSTARTI           TO  CN-BILLING-START-LINE-NO
  2103     ELSE
  2104         MOVE ZEROS              TO  CN-BILLING-START-LINE-NO.
  2105
  2106     IF FBENDL GREATER ZERO
  2107         MOVE FBENDI             TO  CN-BILLING-END-LINE-NO
  2108     ELSE
  2109         MOVE ZEROS              TO  CN-BILLING-END-LINE-NO.
  2110
  2111     IF FBENDL = ZEROS
  2112         IF FBSTARTL GREATER ZERO
  2113            MOVE FBSTARTI        TO  CN-BILLING-END-LINE-NO.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  44
* EL1276.cbl
  2114
  2115     MOVE +0                     TO  WS-SUB1.
  2116
  2117 1100-BUILD-NOTE-LINES.
  2118     ADD +1                      TO  WS-SUB1.
  2119
  2120     IF WS-SUB1 GREATER +10
  2121        GO TO 1700-WRITE-RECORD.
  2122
  2123     IF DNOTE-LINE-LENGTH (WS-SUB1) GREATER ZERO
  2124         MOVE DNOTE-LINE   (WS-SUB1) TO  CN-LINE (WS-SUB1)
  2125         MOVE 'Y'                    TO  WS-NOTE-LINE-SW
  2126       ELSE
  2127         MOVE SPACES                 TO  CN-LINE (WS-SUB1).
  2128
  2129     GO TO 1100-BUILD-NOTE-LINES.
  2130
  2131 1700-WRITE-RECORD.
  2132     IF NOTE-LINES-PRESENT
  2133         NEXT SENTENCE
  2134     ELSE
  2135         MOVE ER-2523            TO  EMI-ERROR
  2136         MOVE -1                 TO  FMAINTL
  2137         PERFORM 9900-ERROR-FORMAT
  2138         GO TO 8200-SEND-DATAONLY.
  2139
  2140     MOVE PI-PROCESSOR-ID        TO  CN-LAST-MAINT-USER.
  2141     MOVE EIBTIME                TO  CN-LAST-MAINT-HHMMSS.
  2142     MOVE SAVE-BIN-DATE          TO  CN-LAST-MAINT-DT.
  2143
  2144     MOVE 'A'                    TO  JP-RECORD-TYPE.
  2145     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
  2146
  2147     PERFORM 6400-WRITE-NOTE-RECORD.
  2148
  2149     IF DUPLICATE-RECORD-FOUND
  2150         GO TO 1800-DUPLICATE-RECORD.
  2151
  2152     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2153             WS-ERNOTE-RECORD-LENGTH  +  23.
  2154
  2155     PERFORM 8400-LOG-JOURNAL-RECORD.
  2156     MOVE ER-0000                TO  EMI-ERROR.
  2157     PERFORM 9900-ERROR-FORMAT.
  2158     PERFORM 7000-FORMAT-SCREEN.
  2159     PERFORM 4000-CERTIFICATE-UPDATE.
  2160     GO TO 8100-SEND-INITIAL-MAP.
  2161
  2162 1800-DUPLICATE-RECORD.
  2163     MOVE ER-2525                TO  EMI-ERROR.
  2164     PERFORM 9900-ERROR-FORMAT.
  2165     PERFORM 7000-FORMAT-SCREEN.
  2166     GO TO 8100-SEND-INITIAL-MAP.
  2167
  2168 1900-EXIT.
  2169     EXIT.
  2170
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  45
* EL1276.cbl
  2172
  2173 2000-CHANGE-RECORD   SECTION.
  2174
  2175     MOVE  PI-CARRIER            TO  WS-CN-CARRIER
  2176     MOVE  PI-GROUPING           TO  WS-CN-GROUPING
  2177     MOVE  PI-STATE              TO  WS-CN-STATE
  2178     MOVE  PI-ACCOUNT            TO  WS-CN-ACCOUNT
  2179     MOVE  PI-CERT-PRIME         TO  WS-CN-CERT-PRIME
  2180     MOVE  PI-CERT-SFX           TO  WS-CN-CERT-SFX
  2181     MOVE  PI-CERT-EFF-DT        TO  WS-CN-CERT-EFF-DT
  2182     MOVE  PI-COMPANY-CD         TO  WS-CN-COMPANY-CD
  2183     IF PI-CANCEL-NOTEs
  2184        MOVE '2'                 TO  WS-CN-RECORD-TYPE
  2185     ELSE
  2186        MOVE '1'                 TO  WS-CN-RECORD-TYPE
  2187     END-IF
  2188
  2189     MOVE WS-CN-CONTROL-PRIMARY  TO WS-CM-CONTROL-PRIMARY
  2190     PERFORM 6300-READ-NOTE-FILE-UPDT
  2191
  2192     IF RECORD-NOT-FOUND
  2193         GO TO 1000-ADD-RECORD.
  2194
  2195     MOVE 'B'                    TO  JP-RECORD-TYPE.
  2196     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
  2197
  2198     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2199             WS-ERNOTE-RECORD-LENGTH  +  23.
  2200
  2201     PERFORM 8400-LOG-JOURNAL-RECORD.
  2202
  2203     IF FBSTARTL GREATER ZERO
  2204         MOVE FBSTARTI           TO  CN-BILLING-START-LINE-NO
  2205     ELSE
  2206         MOVE ZEROS              TO  CN-BILLING-START-LINE-NO.
  2207
  2208     IF FBENDL GREATER ZERO
  2209         MOVE FBENDI             TO  CN-BILLING-END-LINE-NO
  2210     ELSE
  2211         MOVE ZEROS              TO  CN-BILLING-END-LINE-NO.
  2212
  2213     MOVE +0                     TO  WS-SUB1.
  2214
  2215 2100-BUILD-NOTE-LINES.
  2216     ADD +1                      TO  WS-SUB1.
  2217
  2218     IF WS-SUB1 GREATER 10
  2219        GO TO 2700-REWRITE-RECORD.
  2220
  2221     IF DNOTE-LINE-LENGTH (WS-SUB1) GREATER ZERO
  2222         MOVE DNOTE-LINE   (WS-SUB1) TO  CN-LINE (WS-SUB1)
  2223         MOVE 'Y'                    TO  WS-NOTE-LINE-SW
  2224     ELSE
  2225         MOVE SPACES                 TO  CN-LINE (WS-SUB1).
  2226
  2227     GO TO 2100-BUILD-NOTE-LINES.
  2228
  2229 2700-REWRITE-RECORD.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  46
* EL1276.cbl
  2230     IF NOTE-LINES-PRESENT
  2231         NEXT SENTENCE
  2232     ELSE
  2233         MOVE ER-2523            TO  EMI-ERROR
  2234         MOVE -1                 TO  FMAINTL
  2235         PERFORM 9900-ERROR-FORMAT
  2236         GO TO 8200-SEND-DATAONLY.
  2237
  2238     MOVE PI-PROCESSOR-ID        TO  CN-LAST-MAINT-USER.
  2239     MOVE EIBTIME                TO  CN-LAST-MAINT-HHMMSS.
  2240     MOVE SAVE-BIN-DATE          TO  CN-LAST-MAINT-DT.
  2241
  2242     MOVE 'C'                    TO  JP-RECORD-TYPE.
  2243     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
  2244
  2245     PERFORM 6500-REWRITE-NOTE-RECORD.
  2246
  2247     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2248             WS-ERNOTE-RECORD-LENGTH  +  23.
  2249
  2250     PERFORM 8400-LOG-JOURNAL-RECORD.
  2251
  2252     MOVE ER-0000                TO  EMI-ERROR.
  2253     PERFORM 9900-ERROR-FORMAT.
  2254     PERFORM 7000-FORMAT-SCREEN.
  2255     PERFORM 4000-CERTIFICATE-UPDATE.
  2256     GO TO 8100-SEND-INITIAL-MAP.
  2257
  2258 2900-EXIT.
  2259     EXIT.
  2260
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  47
* EL1276.cbl
  2262
  2263 3000-DELETE-RECORD    SECTION.
  2264
  2265     MOVE  PI-CARRIER            TO  WS-CN-CARRIER.
  2266     MOVE  PI-GROUPING           TO  WS-CN-GROUPING.
  2267     MOVE  PI-STATE              TO  WS-CN-STATE.
  2268     MOVE  PI-ACCOUNT            TO  WS-CN-ACCOUNT.
  2269     MOVE  PI-CERT-PRIME         TO  WS-CN-CERT-PRIME.
  2270     MOVE  PI-CERT-SFX           TO  WS-CN-CERT-SFX.
  2271     MOVE  PI-CERT-EFF-DT        TO  WS-CN-CERT-EFF-DT.
  2272     MOVE  PI-COMPANY-CD         TO  WS-CN-COMPANY-CD.
  2273     IF PI-CANCEL-NOTEs
  2274        MOVE '2'                 TO  WS-CN-RECORD-TYPE
  2275     ELSE
  2276        MOVE '1'                 TO  WS-CN-RECORD-TYPE
  2277     END-IF
  2278     MOVE WS-CN-CONTROL-PRIMARY  TO WS-CM-CONTROL-PRIMARY
  2279     PERFORM 6300-READ-NOTE-FILE-UPDT.
  2280
  2281     IF RECORD-NOT-FOUND
  2282        GO TO 3600-RECORD-PREVS-DELETED.
  2283
  2284     MOVE 'D'                    TO  JP-RECORD-TYPE.
  2285     MOVE CERTIFICATE-NOTE       TO  JP-RECORD-AREA.
  2286
  2287     PERFORM 6600-DELETE-NOTE-RECORD.
  2288
  2289     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2290             WS-ERNOTE-RECORD-LENGTH  +  23.
  2291
  2292     PERFORM 8400-LOG-JOURNAL-RECORD.
  2293     PERFORM 4000-CERTIFICATE-UPDATE.
  2294
  2295 3500-RECORD-DELETED.
  2296     MOVE SPACE                  TO  FMAINTO.
  2297     MOVE ER-0000                TO  EMI-ERROR.
  2298     MOVE -1                     TO  FMAINTL.
  2299     PERFORM 9900-ERROR-FORMAT.
  2300     GO TO 8200-SEND-DATAONLY.
  2301
  2302 3600-RECORD-PREVS-DELETED.
  2303     MOVE ER-2528                TO  EMI-ERROR.
  2304     MOVE -1                     TO  FMAINTL.
  2305     PERFORM 9900-ERROR-FORMAT.
  2306     GO TO 8200-SEND-DATAONLY.
  2307
  2308 3900-EXIT.
  2309     EXIT.
  2310
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  48
* EL1276.cbl
  2312
  2313 4000-CERTIFICATE-UPDATE         SECTION.
  2314
  2315
  2316* EXEC CICS HANDLE CONDITION
  2317*        NOTFND   (4400-NOT-FOUND)
  2318*    END-EXEC.
  2319*    MOVE '"$I                   ! $ #00002250' TO DFHEIV0
  2320     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2321     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2322     MOVE X'2420233030303032323530' TO DFHEIV0(25:11)
  2323     CALL 'kxdfhei1' USING DFHEIV0
  2324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2325
  2326
  2327
  2328* EXEC CICS READ
  2329*        EQUAL
  2330*        DATASET   (ELCERT-ID)
  2331*        SET       (ADDRESS OF CERTIFICATE-MASTER)
  2332*        RIDFLD    (WS-CM-CONTROL-PRIMARY)
  2333*        UPDATE
  2334*    END-EXEC.
  2335*    MOVE '&"S        EU         (   #00002254' TO DFHEIV0
  2336     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2337     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2338     MOVE X'2020233030303032323534' TO DFHEIV0(25:11)
  2339     CALL 'kxdfhei1' USING DFHEIV0,
  2340           ELCERT-ID,
  2341           DFHEIV20,
  2342           DFHEIV99,
  2343           WS-CM-CONTROL-PRIMARY,
  2344           DFHEIV99,
  2345           DFHEIV99,
  2346           DFHEIV99
  2347     SET ADDRESS OF CERTIFICATE-MASTER TO
  2348         DFHEIV20
  2349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2350
  2351
  2352     IF FMAINTI = 'D'
  2353       IF CM-NOTE-SW = '2'
  2354         MOVE SPACE              TO  CM-NOTE-SW
  2355       ELSE
  2356         IF CM-NOTE-SW = '3'
  2357            MOVE '1'             TO  CM-NOTE-SW
  2358         ELSE
  2359           IF CM-NOTE-SW = '6'
  2360              MOVE '4'           TO  CM-NOTE-SW
  2361           ELSE
  2362             IF CM-NOTE-SW = '7'
  2363                MOVE '5'         TO  CM-NOTE-SW
  2364             END-IF
  2365           END-IF
  2366         END-IF
  2367       END-IF
  2368       MOVE 'N'                  TO  PI-BILLING-NOTES-EXIST
  2369       GO TO 4200-REWRITE-CERT-MASTER
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  49
* EL1276.cbl
  2370     END-IF.
  2371
  2372     IF CM-NOTE-SW = ' '
  2373         MOVE '2'                TO  CM-NOTE-SW
  2374     ELSE
  2375       IF CM-NOTE-SW = '1'
  2376          MOVE '3'               TO  CM-NOTE-SW
  2377       ELSE
  2378         IF CM-NOTE-SW = '4'
  2379            MOVE '6'             TO  CM-NOTE-SW
  2380         ELSE
  2381           IF CM-NOTE-SW = '5'
  2382              MOVE '7'           TO  CM-NOTE-SW
  2383           END-IF
  2384         END-IF
  2385       END-IF
  2386     END-IF.
  2387     MOVE 'Y'                    TO  PI-BILLING-NOTES-EXIST
  2388     GO TO 4200-REWRITE-CERT-MASTER.
  2389
  2390     MOVE 'B'                    TO  JP-RECORD-TYPE.
  2391     MOVE CERTIFICATE-MASTER     TO  JP-RECORD-AREA.
  2392
  2393     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2394             WS-ELCERT-RECORD-LENGTH  +  23.
  2395
  2396     PERFORM 8400-LOG-JOURNAL-RECORD.
  2397
  2398*00619      IF CN-BILLING-START-LINE-NO = ZERO
  2399*00620          MOVE '1'                TO  CM-NOTE-SW
  2400*00621          GO TO 4200-REWRITE-CERT-MASTER.
  2401*00622
  2402*00623      MOVE +0                     TO  WS-SUB1.
  2403*00624      MOVE +2                     TO  CM-NOTE-SW.
  2404*00625
  2405*00626  4100-CHECK-NOTE-LINE.
  2406*00627      ADD +1  TO  WS-SUB1.
  2407*00628
  2408*00629      IF WS-SUB1 GREATER +10
  2409*00630          GO TO 4200-REWRITE-CERT-MASTER.
  2410*00631
  2411*00632      IF WS-SUB1 LESS    CN-BILLING-START-LINE-NO  OR
  2412*00633                 GREATER CN-BILLING-END-LINE-NO
  2413*00634          NEXT SENTENCE
  2414*00635      ELSE
  2415*00636          GO TO 4100-CHECK-NOTE-LINE.
  2416*00637
  2417*00638      IF CN-LINE (WS-SUB1) GREATER THAN SPACES
  2418*00639          MOVE  3                 TO  CM-NOTE-SW
  2419*00640          GO TO 4200-REWRITE-CERT-MASTER
  2420*00641      ELSE
  2421*00642          GO TO 4100-CHECK-NOTE-LINE.
  2422
  2423 4200-REWRITE-CERT-MASTER.
  2424     MOVE 'C'                    TO  JP-RECORD-TYPE.
  2425     MOVE CERTIFICATE-MASTER     TO  JP-RECORD-AREA.
  2426
  2427
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  50
* EL1276.cbl
  2428* EXEC CICS REWRITE
  2429*        FROM      (CERTIFICATE-MASTER)
  2430*        DATASET   (ELCERT-ID)
  2431*    END-EXEC.
  2432     MOVE LENGTH OF
  2433      CERTIFICATE-MASTER
  2434       TO DFHEIV11
  2435*    MOVE '&& L                  %   #00002337' TO DFHEIV0
  2436     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2437     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2438     MOVE X'2020233030303032333337' TO DFHEIV0(25:11)
  2439     CALL 'kxdfhei1' USING DFHEIV0,
  2440           ELCERT-ID,
  2441           CERTIFICATE-MASTER,
  2442           DFHEIV11,
  2443           DFHEIV99
  2444     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2445
  2446
  2447     COMPUTE WS-JOURNAL-RECORD-LENGTH =
  2448             WS-ELCERT-RECORD-LENGTH  +  23.
  2449
  2450     PERFORM 8400-LOG-JOURNAL-RECORD.
  2451
  2452     GO TO 4500-EXIT.
  2453
  2454 4400-NOT-FOUND.
  2455     MOVE -1                     TO  FMAINTL.
  2456     MOVE ER-0142                TO  EMI-ERROR.
  2457     PERFORM 9900-ERROR-FORMAT.
  2458     GO TO 8200-SEND-DATAONLY.
  2459
  2460 4500-EXIT.
  2461     EXIT.
  2462
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  51
* EL1276.cbl
  2464
  2465 6200-READ-NOTE-FILE             SECTION.
  2466
  2467
  2468* EXEC CICS HANDLE CONDITION
  2469*        NOTFND   (6250-NOT-FOUND)
  2470*    END-EXEC.
  2471*    MOVE '"$I                   ! % #00002362' TO DFHEIV0
  2472     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2473     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2474     MOVE X'2520233030303032333632' TO DFHEIV0(25:11)
  2475     CALL 'kxdfhei1' USING DFHEIV0
  2476     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2477
  2478
  2479
  2480* EXEC CICS READ
  2481*        EQUAL
  2482*        DATASET   (ERNOTE-ID)
  2483*        SET       (ADDRESS OF CERTIFICATE-NOTE)
  2484*        RIDFLD    (WS-CN-CONTROL-PRIMARY)
  2485*    END-EXEC.
  2486*    MOVE '&"S        E          (   #00002366' TO DFHEIV0
  2487     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2488     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2489     MOVE X'2020233030303032333636' TO DFHEIV0(25:11)
  2490     CALL 'kxdfhei1' USING DFHEIV0,
  2491           ERNOTE-ID,
  2492           DFHEIV20,
  2493           DFHEIV99,
  2494           WS-CN-CONTROL-PRIMARY,
  2495           DFHEIV99,
  2496           DFHEIV99,
  2497           DFHEIV99
  2498     SET ADDRESS OF CERTIFICATE-NOTE TO
  2499         DFHEIV20
  2500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2501
  2502
  2503     GO TO 6290-EXIT.
  2504
  2505 6250-NOT-FOUND.
  2506     MOVE 'N'                    TO  WS-RECORD-FOUND-SW.
  2507
  2508 6290-EXIT.
  2509      EXIT.
  2510
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  52
* EL1276.cbl
  2512
  2513 6300-READ-NOTE-FILE-UPDT        SECTION.
  2514
  2515
  2516* EXEC CICS HANDLE CONDITION
  2517*        NOTFND   (6350-NOT-FOUND)
  2518*    END-EXEC.
  2519*    MOVE '"$I                   ! & #00002385' TO DFHEIV0
  2520     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2521     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2522     MOVE X'2620233030303032333835' TO DFHEIV0(25:11)
  2523     CALL 'kxdfhei1' USING DFHEIV0
  2524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2525
  2526
  2527
  2528* EXEC CICS READ
  2529*        EQUAL
  2530*        DATASET   (ERNOTE-ID)
  2531*        SET       (ADDRESS OF CERTIFICATE-NOTE)
  2532*        RIDFLD    (WS-CN-CONTROL-PRIMARY)
  2533*        UPDATE
  2534*    END-EXEC.
  2535*    MOVE '&"S        EU         (   #00002389' TO DFHEIV0
  2536     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2537     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2538     MOVE X'2020233030303032333839' TO DFHEIV0(25:11)
  2539     CALL 'kxdfhei1' USING DFHEIV0,
  2540           ERNOTE-ID,
  2541           DFHEIV20,
  2542           DFHEIV99,
  2543           WS-CN-CONTROL-PRIMARY,
  2544           DFHEIV99,
  2545           DFHEIV99,
  2546           DFHEIV99
  2547     SET ADDRESS OF CERTIFICATE-NOTE TO
  2548         DFHEIV20
  2549     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2550
  2551
  2552        GO TO 6390-EXIT.
  2553
  2554 6350-NOT-FOUND.
  2555     MOVE 'N'                    TO  WS-RECORD-FOUND-SW.
  2556
  2557 6390-EXIT.
  2558      EXIT.
  2559
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  53
* EL1276.cbl
  2561
  2562 6400-WRITE-NOTE-RECORD          SECTION.
  2563
  2564
  2565* EXEC CICS HANDLE CONDITION
  2566*        DUPREC   (6450-DUPLICATE-RECORD)
  2567*    END-EXEC.
  2568*    MOVE '"$%                   ! '' #00002409' TO DFHEIV0
  2569     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  2570     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2571     MOVE X'2720233030303032343039' TO DFHEIV0(25:11)
  2572     CALL 'kxdfhei1' USING DFHEIV0
  2573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2574
  2575
  2576
  2577* EXEC CICS WRITE
  2578*        FROM      (CERTIFICATE-NOTE)
  2579*        DATASET   (ERNOTE-ID)
  2580*        RIDFLD    (CN-CONTROL-PRIMARY)
  2581*    END-EXEC.
  2582     MOVE LENGTH OF
  2583      CERTIFICATE-NOTE
  2584       TO DFHEIV11
  2585*    MOVE '&$ L                  ''   #00002413' TO DFHEIV0
  2586     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2587     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2588     MOVE X'2020233030303032343133' TO DFHEIV0(25:11)
  2589     CALL 'kxdfhei1' USING DFHEIV0,
  2590           ERNOTE-ID,
  2591           CERTIFICATE-NOTE,
  2592           DFHEIV11,
  2593           CN-CONTROL-PRIMARY,
  2594           DFHEIV99,
  2595           DFHEIV99
  2596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2597
  2598
  2599        GO TO 6490-EXIT.
  2600
  2601 6450-DUPLICATE-RECORD.
  2602     MOVE 'Y'                    TO  WS-DUPREC-SW.
  2603
  2604 6490-EXIT.
  2605     EXIT.
  2606
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  54
* EL1276.cbl
  2608
  2609 6500-REWRITE-NOTE-RECORD        SECTION.
  2610
  2611
  2612* EXEC CICS REWRITE
  2613*        FROM      (CERTIFICATE-NOTE)
  2614*        DATASET   (ERNOTE-ID)
  2615*    END-EXEC.
  2616     MOVE LENGTH OF
  2617      CERTIFICATE-NOTE
  2618       TO DFHEIV11
  2619*    MOVE '&& L                  %   #00002431' TO DFHEIV0
  2620     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2621     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2622     MOVE X'2020233030303032343331' TO DFHEIV0(25:11)
  2623     CALL 'kxdfhei1' USING DFHEIV0,
  2624           ERNOTE-ID,
  2625           CERTIFICATE-NOTE,
  2626           DFHEIV11,
  2627           DFHEIV99
  2628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2629
  2630
  2631
  2632 6590-EXIT.
  2633     EXIT.
  2634
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  55
* EL1276.cbl
  2636
  2637 6600-DELETE-NOTE-RECORD         SECTION.
  2638
  2639
  2640* EXEC CICS HANDLE CONDITION
  2641*        NOTFND (6650-RECORD-PREVS-DELETED)
  2642*    END-EXEC.
  2643*    MOVE '"$I                   ! ( #00002444' TO DFHEIV0
  2644     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2645     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2646     MOVE X'2820233030303032343434' TO DFHEIV0(25:11)
  2647     CALL 'kxdfhei1' USING DFHEIV0
  2648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2649
  2650
  2651
  2652* EXEC CICS DELETE
  2653*        DATASET   (ERNOTE-ID)
  2654*    END-EXEC.
  2655*    MOVE '&(                    &   #00002448' TO DFHEIV0
  2656     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2657     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2658     MOVE X'2020233030303032343438' TO DFHEIV0(25:11)
  2659     CALL 'kxdfhei1' USING DFHEIV0,
  2660           ERNOTE-ID,
  2661           DFHEIV99,
  2662           DFHEIV99,
  2663           DFHEIV99,
  2664           DFHEIV99
  2665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2666
  2667
  2668     GO TO 6690-EXIT.
  2669
  2670 6650-RECORD-PREVS-DELETED.
  2671     MOVE 'N'                    TO  WS-RECORD-FOUND-SW.
  2672
  2673 6690-EXIT.
  2674     EXIT.
  2675
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  56
* EL1276.cbl
  2677
  2678 7000-FORMAT-SCREEN              SECTION.
  2679
  2680     MOVE LOW-VALUES             TO  EL127FI.
  2681
  2682     MOVE  PI-CARRIER            TO  FCARRIRO.
  2683     MOVE  PI-GROUPING           TO  FGROUPO.
  2684     MOVE  PI-STATE              TO  FSTO
  2685     MOVE  PI-ACCOUNT            TO  FACOUNTO.
  2686     MOVE  PI-CERT-PRIME         TO  FCERTO.
  2687     MOVE  PI-CERT-SFX           TO  FCRTSFXO.
  2688     MOVE  ' '                   TO  DC-OPTION-CODE.
  2689     MOVE  PI-CERT-EFF-DT        TO  DC-BIN-DATE-1.
  2690     PERFORM 9700-DATE-LINK.
  2691     MOVE DC-GREG-DATE-1-EDIT    TO  FEFFDTO.
  2692     IF PI-CERT-NOTES-EXIST EQUAL 'Y'
  2693         MOVE 'YES'              TO  FCERTYNO
  2694     ELSE
  2695         MOVE 'NO '              TO  FCERTYNO
  2696     END-IF.
  2697     IF PI-CLAIM-NOTES-EXIST EQUAL 'Y'
  2698         MOVE 'YES'              TO  FCLMYNO
  2699     ELSE
  2700         MOVE 'NO '              TO  FCLMYNO
  2701     END-IF.
  2702     if pi-cancel-notes
  2703        move '*****  C A N C E L  *****'
  2704                                 TO FHEADO
  2705        move 'PF7=ISSUE NOTES'   TO FPF7HO
  2706        move '2'                 to ws-cn-record-type
  2707     ELSE
  2708        move '*****   I S S U E   *****'
  2709                                 TO FHEADO
  2710        MOVE 'PF7=CANCEL NOTES'  TO FPF7HO
  2711        move '1'                 to ws-cn-record-type
  2712     END-IF
  2713     MOVE  PI-CARRIER            TO  WS-CN-CARRIER
  2714     MOVE  PI-GROUPING           TO  WS-CN-GROUPING
  2715     MOVE  PI-STATE              TO  WS-CN-STATE
  2716     MOVE  PI-ACCOUNT            TO  WS-CN-ACCOUNT
  2717     MOVE  PI-CERT-PRIME         TO  WS-CN-CERT-PRIME
  2718     MOVE  PI-CERT-SFX           TO  WS-CN-CERT-SFX
  2719     MOVE  PI-CERT-EFF-DT        TO  WS-CN-CERT-EFF-DT
  2720     MOVE  PI-COMPANY-CD         TO  WS-CN-COMPANY-CD
  2721     PERFORM 6200-READ-NOTE-FILE.
  2722
  2723     IF RECORD-NOT-FOUND
  2724        MOVE 'A'                 TO  FMAINTI
  2725        MOVE AL-UANON            TO  FMAINTA
  2726        GO TO 7900-EXIT.
  2727
  2728     MOVE 'C'                    TO  FMAINTO.
  2729     MOVE AL-UANON               TO  FMAINTA.
  2730
  2731     IF CN-LAST-MAINT-DT = SPACES
  2732         MOVE EIBTIME            TO  CN-LAST-MAINT-HHMMSS
  2733         MOVE SAVE-BIN-DATE      TO  CN-LAST-MAINT-DT.
  2734
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  57
* EL1276.cbl
  2735     IF CN-LAST-MAINT-DT NOT = SPACES AND LOW-VALUES
  2736         MOVE  ' '               TO  DC-OPTION-CODE
  2737         MOVE  CN-LAST-MAINT-DT  TO  DC-BIN-DATE-1
  2738         PERFORM 9700-DATE-LINK
  2739         MOVE DC-GREG-DATE-1-EDIT TO  MAINTONO.
  2740
  2741     IF CN-LAST-MAINT-HHMMSS NUMERIC
  2742         MOVE CN-LAST-MAINT-HHMMSS TO TIME-IN
  2743         MOVE TIME-OUT             TO MAINTATO
  2744       ELSE
  2745         MOVE ZEROS                TO TIME-IN
  2746         MOVE TIME-OUT             TO MAINTATO.
  2747
  2748     MOVE CN-LAST-MAINT-USER       TO MAINTBYO.
  2749
  2750     IF CN-BILLING-START-LINE-NO GREATER THAN ZEROS
  2751         MOVE CN-BILLING-START-LINE-NO   TO  FBSTARTO
  2752         MOVE AL-UNNON                   TO  FBSTARTA.
  2753
  2754     IF CN-BILLING-END-LINE-NO GREATER THAN ZEROS
  2755         MOVE CN-BILLING-END-LINE-NO     TO  FBENDO
  2756         MOVE AL-UNNON                   TO  FBENDA.
  2757
  2758     MOVE +0                     TO  WS-SUB1.
  2759
  2760 7100-BUILD-NOTE-LINES.
  2761     ADD +1 TO  WS-SUB1.
  2762
  2763     IF WS-SUB1 GREATER THAN +10
  2764        GO TO 7900-EXIT.
  2765
  2766     MOVE  CN-LINE (WS-SUB1)     TO  DNOTE-LINE       (WS-SUB1).
  2767     MOVE  AL-UANON              TO  DNOTE-LINE-ATTRB (WS-SUB1).
  2768
  2769     GO TO 7100-BUILD-NOTE-LINES.
  2770
  2771 7900-EXIT.
  2772     EXIT.
  2773
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  58
* EL1276.cbl
  2775
  2776 8100-SEND-INITIAL-MAP SECTION.
  2777
  2778     MOVE SAVE-DATE              TO  FDATEO.
  2779     MOVE EIBTIME                TO  TIME-IN.
  2780     MOVE TIME-OUT               TO  FTIMEO.
  2781     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  2782     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  2783     MOVE -1                     TO  FMAINTL.
  2784     MOVE EMI-MESSAGE-AREA (1)   TO  FERRMSGO.
  2785
  2786* EXEC CICS SEND
  2787*        MAP      (MAP-NAME)
  2788*        MAPSET   (MAPSET-NAME)
  2789*        FROM     (EL127FO)
  2790*        ERASE
  2791*        CURSOR
  2792*    END-EXEC.
  2793     MOVE LENGTH OF
  2794      EL127FO
  2795       TO DFHEIV12
  2796     MOVE -1
  2797       TO DFHEIV11
  2798*    MOVE '8$     CT  E    H L F ,   #00002569' TO DFHEIV0
  2799     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2800     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2801     MOVE X'2020233030303032353639' TO DFHEIV0(25:11)
  2802     CALL 'kxdfhei1' USING DFHEIV0,
  2803           MAP-NAME,
  2804           EL127FO,
  2805           DFHEIV12,
  2806           MAPSET-NAME,
  2807           DFHEIV99,
  2808           DFHEIV99,
  2809           DFHEIV99,
  2810           DFHEIV11,
  2811           DFHEIV99,
  2812           DFHEIV99,
  2813           DFHEIV99
  2814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2815
  2816
  2817     GO TO 9100-RETURN-TRAN.
  2818
  2819 8200-SEND-DATAONLY     SECTION.
  2820
  2821     MOVE SAVE-DATE              TO  FDATEO.
  2822     MOVE EIBTIME                TO  TIME-IN.
  2823     MOVE TIME-OUT               TO  FTIMEO.
  2824     MOVE PI-COMPANY-ID          TO  CMPNYIDO.
  2825     MOVE PI-PROCESSOR-ID        TO  USERIDO.
  2826     MOVE EMI-MESSAGE-AREA (1)   TO  FERRMSGO.
  2827
  2828* EXEC CICS SEND
  2829*        MAP      (MAP-NAME)
  2830*        MAPSET   (MAPSET-NAME)
  2831*        FROM     (EL127FO)
  2832*        DATAONLY
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  59
* EL1276.cbl
  2833*        ERASEAUP
  2834*        CURSOR
  2835*    END-EXEC.
  2836     MOVE LENGTH OF
  2837      EL127FO
  2838       TO DFHEIV12
  2839     MOVE -1
  2840       TO DFHEIV11
  2841*    MOVE '8$D    CT  A    H L F ,   #00002587' TO DFHEIV0
  2842     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  2843     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2844     MOVE X'2020233030303032353837' TO DFHEIV0(25:11)
  2845     CALL 'kxdfhei1' USING DFHEIV0,
  2846           MAP-NAME,
  2847           EL127FO,
  2848           DFHEIV12,
  2849           MAPSET-NAME,
  2850           DFHEIV99,
  2851           DFHEIV99,
  2852           DFHEIV99,
  2853           DFHEIV11,
  2854           DFHEIV99,
  2855           DFHEIV99,
  2856           DFHEIV99
  2857     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2858
  2859
  2860     GO TO 9100-RETURN-TRAN.
  2861
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  60
* EL1276.cbl
  2863
  2864 8300-SEND-TEXT         SECTION.
  2865
  2866* EXEC CICS SEND TEXT
  2867*        FROM     (LOGOFF-TEXT)
  2868*        LENGTH   (LOGOFF-LENGTH)
  2869*        ERASE
  2870*        FREEKB
  2871*    END-EXEC.
  2872*    MOVE '8&      T  E F  H   F -   #00002601' TO DFHEIV0
  2873     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2874     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2875     MOVE X'2020233030303032363031' TO DFHEIV0(25:11)
  2876     CALL 'kxdfhei1' USING DFHEIV0,
  2877           LOGOFF-TEXT,
  2878           LOGOFF-LENGTH,
  2879           DFHEIV99,
  2880           DFHEIV99,
  2881           DFHEIV99,
  2882           DFHEIV99,
  2883           DFHEIV99,
  2884           DFHEIV99,
  2885           DFHEIV99,
  2886           DFHEIV99,
  2887           DFHEIV99,
  2888           DFHEIV99
  2889     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2890
  2891
  2892
  2893* EXEC CICS RETURN
  2894*    END-EXEC.
  2895*    MOVE '.(                    ''   #00002608' TO DFHEIV0
  2896     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2897     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2898     MOVE X'2020233030303032363038' TO DFHEIV0(25:11)
  2899     CALL 'kxdfhei1' USING DFHEIV0,
  2900           DFHEIV99,
  2901           DFHEIV99,
  2902           DFHEIV99,
  2903           DFHEIV99,
  2904           DFHEIV99,
  2905           DFHEIV99
  2906     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2907
  2908
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  61
* EL1276.cbl
  2910
  2911 8400-LOG-JOURNAL-RECORD         SECTION.
  2912
  2913*    MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  2914*    MOVE ERNOTE-ID              TO  JP-FILE-ID.
  2915*    MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  2916*    EXEC CICS JOURNAL
  2917*        JFILEID     (PI-JOURNAL-FILE-ID)
  2918*        JTYPEID     ('ER')
  2919*        FROM        (JOURNAL-RECORD)
  2920*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
  2921*    END-EXEC.
  2922
  2923 8400-EXIT.
  2924     EXIT.
  2925
  2926 8600-DEEDIT           SECTION.
  2927
  2928* EXEC CICS BIF DEEDIT
  2929*         FIELD   (DEEDIT-FIELD)
  2930*         LENGTH  (15)
  2931*    END-EXEC.
  2932     MOVE 15
  2933       TO DFHEIV11
  2934*    MOVE '@"L                   #   #00002629' TO DFHEIV0
  2935     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2936     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2937     MOVE X'2020233030303032363239' TO DFHEIV0(25:11)
  2938     CALL 'kxdfhei1' USING DFHEIV0,
  2939           DEEDIT-FIELD,
  2940           DFHEIV11
  2941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2942
  2943
  2944 8800-UNAUTHORIZED-ACCESS        SECTION.
  2945     MOVE UNACCESS-MSG           TO  LOGOFF-MSG.
  2946     GO TO 8300-SEND-TEXT.
  2947
  2948 8810-PF23              SECTION.
  2949     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2950     MOVE XCTL-005               TO  PGM-NAME.
  2951     GO TO 9300-XCTL.
  2952
  2953 9100-RETURN-TRAN       SECTION.
  2954     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  2955     MOVE SCREEN-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  2956
  2957* EXEC CICS RETURN
  2958*        TRANSID    (TRANS-ID)
  2959*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2960*        LENGTH     (PI-COMM-LENGTH)
  2961*    END-EXEC.
  2962*    MOVE '.(CT                  ''   #00002646' TO DFHEIV0
  2963     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2964     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2965     MOVE X'2020233030303032363436' TO DFHEIV0(25:11)
  2966     CALL 'kxdfhei1' USING DFHEIV0,
  2967           TRANS-ID,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  62
* EL1276.cbl
  2968           PROGRAM-INTERFACE-BLOCK,
  2969           PI-COMM-LENGTH,
  2970           DFHEIV99,
  2971           DFHEIV99,
  2972           DFHEIV99
  2973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2974
  2975
  2976 9200-RETURN-MAIN-MENU SECTION.
  2977     MOVE XCTL-626               TO  PGM-NAME.
  2978     GO TO 9300-XCTL.
  2979
  2980 9300-XCTL             SECTION.
  2981
  2982* EXEC CICS XCTL
  2983*        PROGRAM    (PGM-NAME)
  2984*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2985*        LENGTH     (PI-COMM-LENGTH)
  2986*    END-EXEC.
  2987*    MOVE '.$C                   %   #00002657' TO DFHEIV0
  2988     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2989     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2990     MOVE X'2020233030303032363537' TO DFHEIV0(25:11)
  2991     CALL 'kxdfhei1' USING DFHEIV0,
  2992           PGM-NAME,
  2993           PROGRAM-INTERFACE-BLOCK,
  2994           PI-COMM-LENGTH,
  2995           DFHEIV99
  2996     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2997
  2998
  2999 9400-CLEAR            SECTION.
  3000     MOVE PI-RETURN-TO-PROGRAM   TO  PGM-NAME.
  3001     GO TO 9300-XCTL.
  3002
  3003 9500-PF12             SECTION.
  3004     MOVE XCTL-010               TO  PGM-NAME.
  3005     GO TO 9300-XCTL.
  3006
  3007 9600-PGMID-ERROR      SECTION.
  3008
  3009* EXEC CICS HANDLE CONDITION
  3010*        PGMIDERR    (8300-SEND-TEXT)
  3011*    END-EXEC.
  3012*    MOVE '"$L                   ! ) #00002672' TO DFHEIV0
  3013     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3014     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3015     MOVE X'2920233030303032363732' TO DFHEIV0(25:11)
  3016     CALL 'kxdfhei1' USING DFHEIV0
  3017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3018
  3019
  3020     MOVE PGM-NAME               TO  PI-CALLING-PROGRAM.
  3021     MOVE ' '                    TO  PI-ENTRY-CD-1.
  3022     MOVE XCTL-005               TO  PGM-NAME.
  3023     MOVE PGM-NAME               TO  LOGOFF-PGM.
  3024     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  3025     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  63
* EL1276.cbl
  3026
  3027 9700-DATE-LINK         SECTION.
  3028     MOVE LINK-ELDATCV           TO  PGM-NAME
  3029
  3030* EXEC CICS LINK
  3031*        PROGRAM    (PGM-NAME)
  3032*        COMMAREA   (DATE-CONVERSION-DATA)
  3033*        LENGTH     (DC-COMM-LENGTH)
  3034*    END-EXEC.
  3035*    MOVE '."C                   (   #00002685' TO DFHEIV0
  3036     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3037     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3038     MOVE X'2020233030303032363835' TO DFHEIV0(25:11)
  3039     CALL 'kxdfhei1' USING DFHEIV0,
  3040           PGM-NAME,
  3041           DATE-CONVERSION-DATA,
  3042           DC-COMM-LENGTH,
  3043           DFHEIV99,
  3044           DFHEIV99,
  3045           DFHEIV99,
  3046           DFHEIV99
  3047     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3048
  3049
  3050 9900-ERROR-FORMAT       SECTION.
  3051     IF NOT EMI-ERRORS-COMPLETE
  3052         MOVE LINK-001           TO  PGM-NAME
  3053
  3054* EXEC CICS LINK
  3055*            PROGRAM    (PGM-NAME)
  3056*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  3057*            LENGTH     (EMI-COMM-LENGTH)
  3058*        END-EXEC.
  3059*    MOVE '."C                   (   #00002694' TO DFHEIV0
  3060     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3061     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3062     MOVE X'2020233030303032363934' TO DFHEIV0(25:11)
  3063     CALL 'kxdfhei1' USING DFHEIV0,
  3064           PGM-NAME,
  3065           ERROR-MESSAGE-INTERFACE-BLOCK,
  3066           EMI-COMM-LENGTH,
  3067           DFHEIV99,
  3068           DFHEIV99,
  3069           DFHEIV99,
  3070           DFHEIV99
  3071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3072
  3073
  3074 9900-EXIT.
  3075     EXIT.
  3076
  3077 9990-ABEND             SECTION.
  3078     MOVE LINK-004               TO  PGM-NAME.
  3079     MOVE DFHEIBLK               TO  EMI-LINE1
  3080
  3081
  3082* EXEC CICS LINK
  3083*        PROGRAM   (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  64
* EL1276.cbl
  3084*        COMMAREA  (EMI-LINE1)
  3085*        LENGTH    (72)
  3086*    END-EXEC.
  3087     MOVE 72
  3088       TO DFHEIV11
  3089*    MOVE '."C                   (   #00002707' TO DFHEIV0
  3090     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3091     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3092     MOVE X'2020233030303032373037' TO DFHEIV0(25:11)
  3093     CALL 'kxdfhei1' USING DFHEIV0,
  3094           PGM-NAME,
  3095           EMI-LINE1,
  3096           DFHEIV11,
  3097           DFHEIV99,
  3098           DFHEIV99,
  3099           DFHEIV99,
  3100           DFHEIV99
  3101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3102
  3103
  3104     MOVE -1                     TO  FMAINTL.
  3105     GO TO 8200-SEND-DATAONLY.
  3106
  3107 9995-SECURITY-VIOLATION.
  3108*    COPY ELCSCTP.
  3109******************************************************************
  3110*                                                                *
  3111*                            ELCSCTP                             *
  3112*                            VMOD=2.001                          *
  3113*                                                                *
  3114*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3115******************************************************************
  3116
  3117
  3118     MOVE EIBDATE          TO SM-JUL-DATE.
  3119     MOVE EIBTRMID         TO SM-TERMID.
  3120     MOVE THIS-PGM         TO SM-PGM.
  3121     MOVE EIBTIME          TO TIME-IN.
  3122     MOVE TIME-OUT         TO SM-TIME.
  3123     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3124
  3125
  3126* EXEC CICS LINK
  3127*         PROGRAM  ('EL003')
  3128*         COMMAREA (SECURITY-MESSAGE)
  3129*         LENGTH   (80)
  3130*    END-EXEC.
  3131     MOVE 'EL003' TO DFHEIV1
  3132     MOVE 80
  3133       TO DFHEIV11
  3134*    MOVE '."C                   (   #00002734' TO DFHEIV0
  3135     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3136     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3137     MOVE X'2020233030303032373334' TO DFHEIV0(25:11)
  3138     CALL 'kxdfhei1' USING DFHEIV0,
  3139           DFHEIV1,
  3140           SECURITY-MESSAGE,
  3141           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:17 Page  65
* EL1276.cbl
  3142           DFHEIV99,
  3143           DFHEIV99,
  3144           DFHEIV99,
  3145           DFHEIV99
  3146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3147
  3148
  3149******************************************************************
  3150
  3151
  3152 9995-EXIT.
  3153     EXIT.
  3154
  3155
  3156 9999-DFHBACK SECTION.
  3157     MOVE '9%                    "   ' TO DFHEIV0
  3158     MOVE 'EL1276' TO DFHEIV1
  3159     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3160     GOBACK.
  3161 9999-DFHEXIT.
  3162     IF DFHEIGDJ EQUAL 0001
  3163         NEXT SENTENCE
  3164     ELSE IF DFHEIGDJ EQUAL 2
  3165         GO TO 9400-CLEAR
  3166         DEPENDING ON DFHEIGDI
  3167     ELSE IF DFHEIGDJ EQUAL 3
  3168         GO TO 9600-PGMID-ERROR,
  3169               9990-ABEND
  3170         DEPENDING ON DFHEIGDI
  3171     ELSE IF DFHEIGDJ EQUAL 4
  3172         GO TO 4400-NOT-FOUND
  3173         DEPENDING ON DFHEIGDI
  3174     ELSE IF DFHEIGDJ EQUAL 5
  3175         GO TO 6250-NOT-FOUND
  3176         DEPENDING ON DFHEIGDI
  3177     ELSE IF DFHEIGDJ EQUAL 6
  3178         GO TO 6350-NOT-FOUND
  3179         DEPENDING ON DFHEIGDI
  3180     ELSE IF DFHEIGDJ EQUAL 7
  3181         GO TO 6450-DUPLICATE-RECORD
  3182         DEPENDING ON DFHEIGDI
  3183     ELSE IF DFHEIGDJ EQUAL 8
  3184         GO TO 6650-RECORD-PREVS-DELETED
  3185         DEPENDING ON DFHEIGDI
  3186     ELSE IF DFHEIGDJ EQUAL 9
  3187         GO TO 8300-SEND-TEXT
  3188         DEPENDING ON DFHEIGDI.
  3189     MOVE '9%                    "   ' TO DFHEIV0
  3190     MOVE 'EL1276' TO DFHEIV1
  3191     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3192     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5716     Code:        7407
