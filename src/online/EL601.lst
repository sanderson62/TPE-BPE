* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page   1
* EL601.cbl
* Options: int("EL601.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL601.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL601.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL601.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL601.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 12/06/94 08:32:30.
     7*                            VMOD=2.008.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page   2
* EL601.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    TRANSACTION - EG1A - SYSTEM MAINTENANCE MENU.
    26******************************************************************
    27*                   C H A N G E   L O G
    28*
    29* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    30*-----------------------------------------------------------------
    31*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    32* EFFECTIVE    NUMBER
    33*-----------------------------------------------------------------
    34* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    35* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    36******************************************************************
    37
    38 ENVIRONMENT DIVISION.
    39
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page   3
* EL601.cbl
    41 DATA DIVISION.
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*    EL601 WORKING STORAGE     *'.
    46 77  FILLER  PIC X(32)  VALUE '*************V/M 2.008 *********'.
    47
    48 01  WS-DATE-AREA.
    49     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    50     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
    51
    52 01  MISC-WORK-AREAS.
    53
    54     12  SCREEN-SELECT-CHANGES.
    55         16  SCREEN-RESERVE-10   PIC X(32) VALUE
    56                 ' 10. RESERVED'.
    57         16  SCREEN-RESERVE-11   PIC X(32) VALUE
    58                 ' 11. RESERVED'.
    59         16  SCREEN-RESERVE-13   PIC X(32) VALUE
    60                 ' 13. RESERVED'.
    61         16  SCREEN-RESERVE-14   PIC X(32) VALUE
    62                 ' 14. RESERVED'.
    63         16  SCREEN-RESERVE-15   PIC X(32) VALUE
    64                 ' 15. RESERVED'.
    65         16  SCREEN-RESERVE-16   PIC X(32) VALUE
    66                 ' 16. RESERVED'.
    67         16  SCREEN-RESERVE-17   PIC X(32) VALUE
    68                 ' 17. RESERVED'.
    69         16  SCREEN-SELECT-10    PIC X(32) VALUE
    70                 ' 10. GENERAL LEDGER TABLE LOOKUP'.
    71         16  SCREEN-SELECT-11    PIC X(32) VALUE
    72                 ' 11. RETRO HISTORY MAINTENANCE'.
    73         16  SCREEN-SELECT-12    PIC X(32) VALUE
    74                 ' 12. BANK MASTER MAINTENANCE'.
    75*        16  SCREEN-SELECT-13    PIC X(32) VALUE
    76*                ' 13. RETRO MASTER MAINTENANCE'.
    77         16  SCREEN-SELECT-13    PIC X(32) VALUE
    78                 ' 13. LIFE CLAIM INT. MAINT   '.
    79         16  SCREEN-SELECT-14    PIC X(29) VALUE
    80                 ' 14. RESIDENT STATE TAX MAINT'.
    81         16  SCREEN-SELECT-15    PIC X(38) VALUE
    82                 ' 15. ACCOUNT RESIDENT STATE COMM MAINT'.
    83         16  SCREEN-SELECT-16    PIC X(37) VALUE
    84                 ' 16. RESIDENT ST COMMISSION CAP MAINT'.
    85         16  SCREEN-SELECT-17    PIC X(37) VALUE
    86                 ' 17. CODES TABLE MAINTENANCE'.
    87         16  SCREEN-SELECT-18    PIC X(37) VALUE
    88                 ' 18. HIERARCHY TABLE'.
    89
    90     12  MAP-EL601A          PIC X(8)    VALUE 'EL601A'.
    91     12  MAPSET-EL601S       PIC X(8)    VALUE 'EL601S'.
    92     12  TRANS-EXA1          PIC X(4)    VALUE 'EXA1'.
    93     12  PGM-EL601           PIC X(8)    VALUE 'EL601'.
    94     12  PGM-NAME            PIC X(8).
    95     12  TIME-IN             PIC S9(7).
    96     12  TIME-OUT-R  REDEFINES TIME-IN.
    97         16  FILLER          PIC X.
    98         16  TIME-OUT        PIC 99V99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page   4
* EL601.cbl
    99         16  FILLER          PIC X(2).
   100     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   101     12  LINK-EL001          PIC X(8)    VALUE 'EL001'.
   102     12  LINK-EL004          PIC X(8)    VALUE 'EL004'.
   103
   104     12  XCTL-EL005          PIC X(8)    VALUE 'EL005'.
   105     12  XCTL-EL010          PIC X(8)    VALUE 'EL010'.
   106     12  XCTL-EL102          PIC X(8)    VALUE 'EL102'.
   107     12  XCTL-EL103          PIC X(8)    VALUE 'EL103'.
   108     12  XCTL-EL104          PIC X(8)    VALUE 'EL104'.
   109     12  XCTL-EL105          PIC X(8)    VALUE 'EL105'.
   110     12  XCTL-EL106          PIC X(8)    VALUE 'EL106'.
   111     12  XCTL-EL107          PIC X(8)    VALUE 'EL107'.
   112     12  XCTL-EL108          PIC X(8)    VALUE 'EL108'.
   113     12  XCTL-EL110          PIC X(8)    VALUE 'EL110'.
   114     12  XCTL-EL111          PIC X(8)    VALUE 'EL111'.
   115     12  XCTL-EL112          PIC X(8)    VALUE 'EL112'.
   116     12  XCTL-EL115          PIC X(8)    VALUE 'EL115'.
   117     12  XCTL-EL119          PIC X(8)    VALUE 'EL119'.
   118     12  XCTL-EL126          PIC X(8)    VALUE 'EL800'.
   119     12  XCTL-EL158          PIC X(8)    VALUE 'EL158'.
   120     12  XCTL-EL159          PIC X(8)    VALUE 'EL159'.
   121     12  XCTL-EL400          PIC X(8)    VALUE 'EL400NCB'.
   122     12  XCTL-EL602          PIC X(8)    VALUE 'EL602'.
   123     12  XCTL-EL603          PIC X(8)    VALUE 'EL603'.
   124     12  XCTL-EL604          PIC X(8)    VALUE 'EL604'.
   125     12  XCTL-EL605          PIC X(8)    VALUE 'EL605'.
   126     12  XCTL-EL606          PIC X(8)    VALUE 'EL606'.
   127     12  XCTL-EL607          PIC X(8)    VALUE 'EL607'.
   128     12  XCTL-EL608          PIC X(8)    VALUE 'EL608 '.
   129     12  XCTL-EL610          PIC X(8)    VALUE 'EL610'.
   130     12  XCTL-EL611          PIC X(8)    VALUE 'EL611'.
   131     12  XCTL-EL613          PIC X(8)    VALUE 'EL613'.
   132     12  XCTL-EL626          PIC X(8)    VALUE 'EL626'.
   133     12  XCTL-EL650          PIC X(8)    VALUE 'EL650'.
   134     12  XCTL-EL651          PIC X(8)    VALUE 'EL651'.
   135     12  XCTL-EL652          PIC X(8)    VALUE 'EL652'.
   136     12  XCTL-EL653          PIC X(8)    VALUE 'EL653'.
   137     12  XCTL-EL654          PIC X(8)    VALUE 'EL654'.
   138     12  XCTL-EL656          PIC X(8)    VALUE 'EL656'.
   139     12  XCTL-EL658          PIC X(8)    VALUE 'EL658'.
   140     12  XCTL-EL659          PIC X(8)    VALUE 'EL659'.
   141     12  XCTL-EL1062         PIC X(8)    VALUE 'EL1062'.
   142     12  XCTL-EL1064         PIC X(8)    VALUE 'EL1064'.
   143
   144     12  ER-0002             PIC X(4)    VALUE '0002'.
   145     12  ER-2370             PIC X(4)    VALUE '2370'.
   146     12  ER-2371             PIC X(4)    VALUE '2371'.
   147     12  ER-7000             PIC X(4)    VALUE '7000'.
   148     12  ER-7001             PIC X(4)    VALUE '7001'.
   149     12  ER-7002             PIC X(4)    VALUE '7002'.
   150     12  ER-7003             PIC X(4)    VALUE '7003'.
   151     12  ER-7008             PIC X(4)    VALUE '7008'.
   152     12  ER-7448             PIC X(4)    VALUE '7448'.
   153
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page   5
* EL601.cbl
   155*                            COPY ELCLOGOF.
   156******************************************************************
   157*                                                                *
   158*                                                                *
   159*                            ELCLOGOF.                           *
   160*                            VMOD=2.001                          *
   161*                                                                *
   162*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   163*                                                                *
   164******************************************************************
   165 01  CLASIC-LOGOFF.
   166     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   167     12  LOGOFF-TEXT.
   168         16  FILLER          PIC X(5)    VALUE SPACES.
   169         16  LOGOFF-MSG.
   170             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   171             20  FILLER      PIC X       VALUE SPACES.
   172             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   173         16  FILLER          PIC X(80)
   174           VALUE '* YOU ARE NOW LOGGED OFF'.
   175         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   176         16  FILLER          PIC X       VALUE QUOTE.
   177         16  LOGOFF-SYS-MSG  PIC X(17)
   178           VALUE 'S CLAS-IC SYSTEM '.
   179     12  TEXT-MESSAGES.
   180         16  UNACCESS-MSG    PIC X(29)
   181             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   182         16  PGMIDERR-MSG    PIC X(17)
   183             VALUE 'PROGRAM NOT FOUND'.
   184
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page   6
* EL601.cbl
   186*                            COPY ELCDATE.
   187******************************************************************
   188*                                                                *
   189*                                                                *
   190*                            ELCDATE.                            *
   191*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   192*                            VMOD=2.003
   193*                                                                *
   194*                                                                *
   195*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   196*                 LENGTH = 200                                   *
   197******************************************************************
   198
   199 01  DATE-CONVERSION-DATA.
   200     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   201     12  DC-OPTION-CODE                PIC X.
   202         88  BIN-TO-GREG                VALUE ' '.
   203         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   204         88  EDIT-GREG-TO-BIN           VALUE '2'.
   205         88  YMD-GREG-TO-BIN            VALUE '3'.
   206         88  MDY-GREG-TO-BIN            VALUE '4'.
   207         88  JULIAN-TO-BIN              VALUE '5'.
   208         88  BIN-PLUS-ELAPSED           VALUE '6'.
   209         88  FIND-CENTURY               VALUE '7'.
   210         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   211         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   212         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   213         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   214         88  JULIAN-TO-BIN-3            VALUE 'C'.
   215         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   216         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   217         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   218         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   219         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   220         88  CHECK-LEAP-YEAR            VALUE 'H'.
   221         88  BIN-3-TO-GREG              VALUE 'I'.
   222         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   223         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   224         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   225         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   226         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   227         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   228         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   229         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   230         88  THREE-CHARACTER-BIN
   231                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   232         88  GREGORIAN-TO-BIN
   233                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   234         88  BIN-TO-GREGORIAN
   235                  VALUES ' ' '1' 'I' '8' 'G'.
   236         88  JULIAN-TO-BINARY
   237                  VALUES '5' 'C' 'E' 'F'.
   238     12  DC-ERROR-CODE                 PIC X.
   239         88  NO-CONVERSION-ERROR        VALUE ' '.
   240         88  DATE-CONVERSION-ERROR
   241                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   242         88  DATE-IS-ZERO               VALUE '1'.
   243         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page   7
* EL601.cbl
   244         88  DATE-IS-INVALID            VALUE '3'.
   245         88  DATE1-GREATER-DATE2        VALUE '4'.
   246         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   247         88  DATE-INVALID-OPTION        VALUE '9'.
   248         88  INVALID-CENTURY            VALUE 'A'.
   249         88  ONLY-CENTURY               VALUE 'B'.
   250         88  ONLY-LEAP-YEAR             VALUE 'C'.
   251         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   252     12  DC-END-OF-MONTH               PIC X.
   253         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   254     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   255         88  USE-NORMAL-PROCESS         VALUE ' '.
   256         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   257         88  ADJUST-UP-100-YRS          VALUE '2'.
   258     12  FILLER                        PIC X.
   259     12  DC-CONVERSION-DATES.
   260         16  DC-BIN-DATE-1             PIC XX.
   261         16  DC-BIN-DATE-2             PIC XX.
   262         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   263         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   264                       DC-GREG-DATE-1-EDIT.
   265             20  DC-EDIT1-MONTH        PIC 99.
   266             20  SLASH1-1              PIC X.
   267             20  DC-EDIT1-DAY          PIC 99.
   268             20  SLASH1-2              PIC X.
   269             20  DC-EDIT1-YEAR         PIC 99.
   270         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   271         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   272                     DC-GREG-DATE-2-EDIT.
   273             20  DC-EDIT2-MONTH        PIC 99.
   274             20  SLASH2-1              PIC X.
   275             20  DC-EDIT2-DAY          PIC 99.
   276             20  SLASH2-2              PIC X.
   277             20  DC-EDIT2-YEAR         PIC 99.
   278         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   279         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   280                     DC-GREG-DATE-1-YMD.
   281             20  DC-YMD-YEAR           PIC 99.
   282             20  DC-YMD-MONTH          PIC 99.
   283             20  DC-YMD-DAY            PIC 99.
   284         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   285         16  DC-GREG-DATE-1-MDY-R REDEFINES
   286                      DC-GREG-DATE-1-MDY.
   287             20  DC-MDY-MONTH          PIC 99.
   288             20  DC-MDY-DAY            PIC 99.
   289             20  DC-MDY-YEAR           PIC 99.
   290         16  DC-GREG-DATE-1-ALPHA.
   291             20  DC-ALPHA-MONTH        PIC X(10).
   292             20  DC-ALPHA-DAY          PIC 99.
   293             20  FILLER                PIC XX.
   294             20  DC-ALPHA-CENTURY.
   295                 24 DC-ALPHA-CEN-N     PIC 99.
   296             20  DC-ALPHA-YEAR         PIC 99.
   297         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   298         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   299         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   300         16  DC-JULIAN-DATE            PIC 9(05).
   301         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page   8
* EL601.cbl
   302                                       PIC 9(05).
   303         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   304             20  DC-JULIAN-YEAR        PIC 99.
   305             20  DC-JULIAN-DAYS        PIC 999.
   306         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   307         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   308         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   309     12  DATE-CONVERSION-VARIBLES.
   310         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   311         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   312             20  FILLER                PIC 9(3).
   313             20  HOLD-CEN-1-CCYY.
   314                 24  HOLD-CEN-1-CC     PIC 99.
   315                 24  HOLD-CEN-1-YY     PIC 99.
   316             20  HOLD-CEN-1-MO         PIC 99.
   317             20  HOLD-CEN-1-DA         PIC 99.
   318         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   319             20  HOLD-CEN-1-R-MO       PIC 99.
   320             20  HOLD-CEN-1-R-DA       PIC 99.
   321             20  HOLD-CEN-1-R-CCYY.
   322                 24  HOLD-CEN-1-R-CC   PIC 99.
   323                 24  HOLD-CEN-1-R-YY   PIC 99.
   324             20  FILLER                PIC 9(3).
   325         16  HOLD-CENTURY-1-X.
   326             20  FILLER                PIC X(3)  VALUE SPACES.
   327             20  HOLD-CEN-1-X-CCYY.
   328                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   329                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   330             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   331             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   332         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   333             20  HOLD-CEN-1-R-X-MO     PIC XX.
   334             20  HOLD-CEN-1-R-X-DA     PIC XX.
   335             20  HOLD-CEN-1-R-X-CCYY.
   336                 24  HOLD-CEN-1-R-X-CC PIC XX.
   337                 24  HOLD-CEN-1-R-X-YY PIC XX.
   338             20  FILLER                PIC XXX.
   339         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   340         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   341         16  DC-JULIAN-DATE-1          PIC 9(07).
   342         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   343             20  DC-JULIAN-1-CCYY.
   344                 24  DC-JULIAN-1-CC    PIC 99.
   345                 24  DC-JULIAN-1-YR    PIC 99.
   346             20  DC-JULIAN-DA-1        PIC 999.
   347         16  DC-JULIAN-DATE-2          PIC 9(07).
   348         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   349             20  DC-JULIAN-2-CCYY.
   350                 24  DC-JULIAN-2-CC    PIC 99.
   351                 24  DC-JULIAN-2-YR    PIC 99.
   352             20  DC-JULIAN-DA-2        PIC 999.
   353         16  DC-GREG-DATE-A-EDIT.
   354             20  DC-EDITA-MONTH        PIC 99.
   355             20  SLASHA-1              PIC X VALUE '/'.
   356             20  DC-EDITA-DAY          PIC 99.
   357             20  SLASHA-2              PIC X VALUE '/'.
   358             20  DC-EDITA-CCYY.
   359                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page   9
* EL601.cbl
   360                 24  DC-EDITA-YEAR     PIC 99.
   361         16  DC-GREG-DATE-B-EDIT.
   362             20  DC-EDITB-MONTH        PIC 99.
   363             20  SLASHB-1              PIC X VALUE '/'.
   364             20  DC-EDITB-DAY          PIC 99.
   365             20  SLASHB-2              PIC X VALUE '/'.
   366             20  DC-EDITB-CCYY.
   367                 24  DC-EDITB-CENT     PIC 99.
   368                 24  DC-EDITB-YEAR     PIC 99.
   369         16  DC-GREG-DATE-CYMD         PIC 9(08).
   370         16  DC-GREG-DATE-CYMD-R REDEFINES
   371                              DC-GREG-DATE-CYMD.
   372             20  DC-CYMD-CEN           PIC 99.
   373             20  DC-CYMD-YEAR          PIC 99.
   374             20  DC-CYMD-MONTH         PIC 99.
   375             20  DC-CYMD-DAY           PIC 99.
   376         16  DC-GREG-DATE-MDCY         PIC 9(08).
   377         16  DC-GREG-DATE-MDCY-R REDEFINES
   378                              DC-GREG-DATE-MDCY.
   379             20  DC-MDCY-MONTH         PIC 99.
   380             20  DC-MDCY-DAY           PIC 99.
   381             20  DC-MDCY-CEN           PIC 99.
   382             20  DC-MDCY-YEAR          PIC 99.
   383    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   384        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   385    12  DC-EL310-DATE                  PIC X(21).
   386    12  FILLER                         PIC X(28).
   387
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  10
* EL601.cbl
   389*                            COPY ELCATTR.
   390******************************************************************
   391*                                                                *
   392*                            ELCATTR.                            *
   393*                            VMOD=2.001                          *
   394*                                                                *
   395*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   396*                                                                *
   397*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   398*                                                                *
   399*                   POS 1   P=PROTECTED                          *
   400*                           U=UNPROTECTED                        *
   401*                           S=ASKIP                              *
   402*                   POS 2   A=ALPHA/NUMERIC                      *
   403*                           N=NUMERIC                            *
   404*                   POS 3   N=NORMAL                             *
   405*                           B=BRIGHT                             *
   406*                           D=DARK                               *
   407*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   408*                           OF=MODIFIED DATA TAG OFF             *
   409*                                                                *
   410*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   411******************************************************************
   412 01  ATTRIBUTE-LIST.
   413     12  AL-PABOF            PIC X       VALUE 'Y'.
   414     12  AL-PABON            PIC X       VALUE 'Z'.
   415     12  AL-PADOF            PIC X       VALUE '%'.
   416     12  AL-PADON            PIC X       VALUE '_'.
   417     12  AL-PANOF            PIC X       VALUE '-'.
   418     12  AL-PANON            PIC X       VALUE '/'.
   419     12  AL-SABOF            PIC X       VALUE '8'.
   420     12  AL-SABON            PIC X       VALUE '9'.
   421     12  AL-SADOF            PIC X       VALUE '@'.
   422     12  AL-SADON            PIC X       VALUE QUOTE.
   423     12  AL-SANOF            PIC X       VALUE '0'.
   424     12  AL-SANON            PIC X       VALUE '1'.
   425     12  AL-UABOF            PIC X       VALUE 'H'.
   426     12  AL-UABON            PIC X       VALUE 'I'.
   427     12  AL-UADOF            PIC X       VALUE '<'.
   428     12  AL-UADON            PIC X       VALUE '('.
   429     12  AL-UANOF            PIC X       VALUE ' '.
   430     12  AL-UANON            PIC X       VALUE 'A'.
   431     12  AL-UNBOF            PIC X       VALUE 'Q'.
   432     12  AL-UNBON            PIC X       VALUE 'R'.
   433     12  AL-UNDOF            PIC X       VALUE '*'.
   434     12  AL-UNDON            PIC X       VALUE ')'.
   435     12  AL-UNNOF            PIC X       VALUE '&'.
   436     12  AL-UNNON            PIC X       VALUE 'J'.
   437
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  11
* EL601.cbl
   439*                            COPY ELCEMIB.
   440******************************************************************
   441*                                                                *
   442*                                                                *
   443*                            ELCEMIB.                            *
   444*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   445*                            VMOD=2.005                          *
   446*                                                                *
   447*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   448*                                                                *
   449******************************************************************
   450 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   451     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   452     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   453     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   454     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   455     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   456     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   457     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   458     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   459     12  EMI-SWITCH1             PIC X        VALUE '1'.
   460         88  EMI-NO-ERRORS                    VALUE '1'.
   461         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   462         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   463     12  EMI-SWITCH2             PIC X        VALUE '1'.
   464         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   465     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   466         88  EMI-AREA1-EMPTY                  VALUE '1'.
   467         88  EMI-AREA1-FULL                   VALUE '2'.
   468     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   469         88  EMI-AREA2-EMPTY                  VALUE '1'.
   470         88  EMI-AREA2-FULL                   VALUE '2'.
   471     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   472         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   473         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   474         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   475         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   476         88  EMI-BYPASS-FATALS                VALUE 'X'.
   477     12  EMI-ERROR-LINES.
   478         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   479         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   480         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   481         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   482             20  EMI-ERR-CODES OCCURS 10 TIMES.
   483                 24  EMI-ERR-NUM         PIC X(4).
   484                 24  EMI-FILLER          PIC X.
   485                 24  EMI-SEV             PIC X.
   486                 24  FILLER              PIC X.
   487             20  FILLER                  PIC X(02).
   488     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   489         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   490             20  EMI-ERROR-NUMBER    PIC X(4).
   491             20  EMI-FILL            PIC X.
   492             20  EMI-SEVERITY        PIC X.
   493             20  FILLER              PIC X.
   494             20  EMI-ERROR-TEXT.
   495                 24  EMI-TEXT-VARIABLE   PIC X(10).
   496                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  12
* EL601.cbl
   497     12  EMI-SEVERITY-SAVE           PIC X.
   498         88  EMI-NOTE                    VALUE 'N'.
   499         88  EMI-WARNING                 VALUE 'W'.
   500         88  EMI-FORCABLE                VALUE 'F'.
   501         88  EMI-FATAL                   VALUE 'X'.
   502     12  EMI-MESSAGE-FLAG            PIC X.
   503         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   504         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   505     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   506     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   507         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   508         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   509         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   510     12  emi-claim-no                pic x(7).
   511     12  emi-claim-type              pic x(6).
   512     12  FILLER                      PIC X(124)  VALUE SPACES.
   513     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   514     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   515     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   516     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   517
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  13
* EL601.cbl
   519*                            COPY ELCINTF.
   520******************************************************************
   521*                                                                *
   522*                                                                *
   523*                            ELCINTF.                            *
   524*                            VMOD=2.017                          *
   525*                                                                *
   526*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   527*                                                                *
   528*       LENGTH = 1024                                            *
   529*                                                                *
   530******************************************************************
   531*                   C H A N G E   L O G
   532*
   533* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   534*-----------------------------------------------------------------
   535*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   536* EFFECTIVE    NUMBER
   537*-----------------------------------------------------------------
   538* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   539******************************************************************
   540 01  PROGRAM-INTERFACE-BLOCK.
   541     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   542     12  PI-CALLING-PROGRAM              PIC X(8).
   543     12  PI-SAVED-PROGRAM-1              PIC X(8).
   544     12  PI-SAVED-PROGRAM-2              PIC X(8).
   545     12  PI-SAVED-PROGRAM-3              PIC X(8).
   546     12  PI-SAVED-PROGRAM-4              PIC X(8).
   547     12  PI-SAVED-PROGRAM-5              PIC X(8).
   548     12  PI-SAVED-PROGRAM-6              PIC X(8).
   549     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   550     12  PI-COMPANY-ID                   PIC XXX.
   551     12  PI-COMPANY-CD                   PIC X.
   552
   553     12  PI-COMPANY-PASSWORD             PIC X(8).
   554
   555     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   556
   557     12  PI-CONTROL-IN-PROGRESS.
   558         16  PI-CARRIER                  PIC X.
   559         16  PI-GROUPING                 PIC X(6).
   560         16  PI-STATE                    PIC XX.
   561         16  PI-ACCOUNT                  PIC X(10).
   562         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   563                                         PIC X(10).
   564         16  PI-CLAIM-CERT-GRP.
   565             20  PI-CLAIM-NO             PIC X(7).
   566             20  PI-CERT-NO.
   567                 25  PI-CERT-PRIME       PIC X(10).
   568                 25  PI-CERT-SFX         PIC X.
   569             20  PI-CERT-EFF-DT          PIC XX.
   570         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   571             20  PI-PLAN-CODE            PIC X(2).
   572             20  PI-REVISION-NUMBER      PIC X(3).
   573             20  PI-PLAN-EFF-DT          PIC X(2).
   574             20  PI-PLAN-EXP-DT          PIC X(2).
   575             20  FILLER                  PIC X(11).
   576         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  14
* EL601.cbl
   577             20  PI-OE-REFERENCE-1.
   578                 25  PI-OE-REF-1-PRIME   PIC X(18).
   579                 25  PI-OE-REF-1-SUFF    PIC XX.
   580
   581     12  PI-SESSION-IN-PROGRESS          PIC X.
   582         88  CLAIM-SESSION                   VALUE '1'.
   583         88  CREDIT-SESSION                  VALUE '2'.
   584         88  WARRANTY-SESSION                VALUE '3'.
   585         88  MORTGAGE-SESSION                VALUE '4'.
   586         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   587
   588
   589*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   590
   591     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   592     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   593
   594     12  PI-CREDIT-USER                  PIC X.
   595         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   596         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   597
   598     12  PI-CLAIM-USER                   PIC X.
   599         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   600         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   601
   602     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   603         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   604         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   605         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   606         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   607         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   608
   609     12  PI-PROCESSOR-ID                 PIC X(4).
   610
   611     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   612
   613     12  PI-MEMBER-CAPTION               PIC X(10).
   614
   615     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   616         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   617
   618     12  PI-LIFE-OVERRIDE-L1             PIC X.
   619     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   620     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   621     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   622
   623     12  PI-AH-OVERRIDE-L1               PIC X.
   624     12  PI-AH-OVERRIDE-L2               PIC XX.
   625     12  PI-AH-OVERRIDE-L6               PIC X(6).
   626     12  PI-AH-OVERRIDE-L12              PIC X(12).
   627
   628     12  PI-NEW-SYSTEM                   PIC X(2).
   629
   630     12  PI-PRIMARY-CERT-NO              PIC X(11).
   631     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   632         88  PI-USES-PAID-TO                 VALUE '1'.
   633     12  PI-CRDTCRD-SYSTEM.
   634         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  15
* EL601.cbl
   635             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   636             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   637         16  PI-CC-MONTH-END-DT          PIC XX.
   638     12  PI-PROCESSOR-PRINTER            PIC X(4).
   639
   640     12  PI-OE-REFERENCE-2.
   641         16  PI-OE-REF-2-PRIME           PIC X(10).
   642         16  PI-OE-REF-2-SUFF            PIC X.
   643
   644     12  PI-REM-TRM-CALC-OPTION          PIC X.
   645
   646     12  PI-LANGUAGE-TYPE                PIC X.
   647             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   648             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   649             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   650
   651     12  PI-POLICY-LINKAGE-IND           PIC X.
   652         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   653         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   654                                                   LOW-VALUES.
   655
   656     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   657     12  PI-CLAIM-PW-SESSION             PIC X(1).
   658         88  PI-CLAIM-CREDIT                 VALUE '1'.
   659         88  PI-CLAIM-CONVEN                 VALUE '2'.
   660
   661     12  PI-PROCESSOR-CSR-IND            PIC X.
   662         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   663         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   664
   665     12  FILLER                          PIC X(3).
   666
   667     12  PI-SYSTEM-LEVEL                 PIC X(145).
   668
   669     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   670         PI-SYSTEM-LEVEL.
   671
   672         16  PI-ENTRY-CODES.
   673             20  PI-ENTRY-CD-1           PIC X.
   674             20  PI-ENTRY-CD-2           PIC X.
   675
   676         16  PI-RETURN-CODES.
   677             20  PI-RETURN-CD-1          PIC X.
   678             20  PI-RETURN-CD-2          PIC X.
   679
   680         16  PI-UPDATE-STATUS-SAVE.
   681             20  PI-UPDATE-BY            PIC X(4).
   682             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   683
   684         16  PI-LOWER-CASE-LETTERS       PIC X.
   685             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   686
   687*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   688*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   689*            88  CARRIER-CLM-CNTL            VALUE '2'.
   690
   691         16  PI-CERT-ACCESS-CONTROL      PIC X.
   692             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  16
* EL601.cbl
   693             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   694             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   695             88  ACCNT-CNTL                  VALUE '3'.
   696             88  CARR-ACCNT-CNTL             VALUE '4'.
   697
   698         16  PI-PROCESSOR-CAP-LIST.
   699             20  PI-SYSTEM-CONTROLS.
   700                24 PI-SYSTEM-DISPLAY     PIC X.
   701                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   702                24 PI-SYSTEM-MODIFY      PIC X.
   703                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   704             20  FILLER                  PIC XX.
   705             20  PI-DISPLAY-CAP          PIC X.
   706                 88  DISPLAY-CAP             VALUE 'Y'.
   707             20  PI-MODIFY-CAP           PIC X.
   708                 88  MODIFY-CAP              VALUE 'Y'.
   709             20  PI-MSG-AT-LOGON-CAP     PIC X.
   710                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   711             20  PI-FORCE-CAP            PIC X.
   712                 88  FORCE-CAP               VALUE 'Y'.
   713
   714         16  PI-PROGRAM-CONTROLS.
   715             20  PI-PGM-PRINT-OPT        PIC X.
   716             20  PI-PGM-FORMAT-OPT       PIC X.
   717             20  PI-PGM-PROCESS-OPT      PIC X.
   718             20  PI-PGM-TOTALS-OPT       PIC X.
   719
   720         16  PI-HELP-INTERFACE.
   721             20  PI-LAST-ERROR-NO        PIC X(4).
   722             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   723
   724         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   725             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   726
   727         16  PI-CR-CONTROL-IN-PROGRESS.
   728             20  PI-CR-CARRIER           PIC X.
   729             20  PI-CR-GROUPING          PIC X(6).
   730             20  PI-CR-STATE             PIC XX.
   731             20  PI-CR-ACCOUNT           PIC X(10).
   732             20  PI-CR-FIN-RESP          PIC X(10).
   733             20  PI-CR-TYPE              PIC X.
   734
   735         16  PI-CR-BATCH-NUMBER          PIC X(6).
   736
   737         16  PI-CR-MONTH-END-DT          PIC XX.
   738
   739         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   740             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   741             88  PI-ZERO-CARRIER             VALUE '1'.
   742             88  PI-ZERO-GROUPING            VALUE '2'.
   743             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   744
   745         16  PI-CARRIER-SECURITY         PIC X.
   746             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   747
   748         16  PI-ACCOUNT-SECURITY         PIC X(10).
   749             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   750             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  17
* EL601.cbl
   751
   752         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   753             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   754                                         INDEXED BY PI-ACCESS-NDX
   755                                         PIC X.
   756
   757         16  PI-GA-BILLING-CONTROL       PIC X.
   758             88  PI-GA-BILLING               VALUE '1'.
   759
   760         16  PI-MAIL-PROCESSING          PIC X.
   761             88  PI-MAIL-YES                 VALUE 'Y'.
   762
   763         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   764
   765         16  PI-AR-SYSTEM.
   766             20  PI-AR-PROCESSING-CNTL   PIC X.
   767                 88  PI-AR-PROCESSING        VALUE 'Y'.
   768             20  PI-AR-SUMMARY-CODE      PIC X(6).
   769             20  PI-AR-MONTH-END-DT      PIC XX.
   770
   771         16  PI-MP-SYSTEM.
   772             20  PI-MORTGAGE-USER            PIC X.
   773                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   774                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   775             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   776                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   777                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   778                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   779                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   780                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   781             20  PI-MP-MONTH-END-DT          PIC XX.
   782             20  PI-MP-REFERENCE-NO.
   783                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   784                 24  PI-MP-REFERENCE-SFX     PIC XX.
   785
   786         16  PI-LABEL-CONTROL            PIC X(01).
   787             88  PI-CREATE-LABELS                    VALUE 'Y'.
   788             88  PI-BYPASS-LABELS                    VALUE 'N'.
   789
   790         16  PI-BILL-GROUPING-CODE       PIC X(01).
   791             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   792
   793         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   794             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   795             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   796
   797         16  FILLER                      PIC X(14).
   798
   799     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   800******************************************************************
   801     12  PI-WORK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
   802         16  PI-FILE-ID                    PIC XX.
   803         16  FILLER                        PIC X(638).
   804
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  18
* EL601.cbl
   806*                            COPY ELCAID.
   807******************************************************************
   808*                                                                *
   809*                            ELCAID.                             *
   810*                            VMOD=2.001                          *
   811*                                                                *
   812*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   813*                                                                *
   814*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   815*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   816******************************************************************
   817
   818 01  DFHAID.
   819   02  DFHNULL   PIC  X  VALUE  ' '.
   820   02  DFHENTER  PIC  X  VALUE  QUOTE.
   821   02  DFHCLEAR  PIC  X  VALUE  '_'.
   822   02  DFHPEN    PIC  X  VALUE  '='.
   823   02  DFHOPID   PIC  X  VALUE  'W'.
   824   02  DFHPA1    PIC  X  VALUE  '%'.
   825   02  DFHPA2    PIC  X  VALUE  '>'.
   826   02  DFHPA3    PIC  X  VALUE  ','.
   827   02  DFHPF1    PIC  X  VALUE  '1'.
   828   02  DFHPF2    PIC  X  VALUE  '2'.
   829   02  DFHPF3    PIC  X  VALUE  '3'.
   830   02  DFHPF4    PIC  X  VALUE  '4'.
   831   02  DFHPF5    PIC  X  VALUE  '5'.
   832   02  DFHPF6    PIC  X  VALUE  '6'.
   833   02  DFHPF7    PIC  X  VALUE  '7'.
   834   02  DFHPF8    PIC  X  VALUE  '8'.
   835   02  DFHPF9    PIC  X  VALUE  '9'.
   836   02  DFHPF10   PIC  X  VALUE  ':'.
   837   02  DFHPF11   PIC  X  VALUE  '#'.
   838   02  DFHPF12   PIC  X  VALUE  '@'.
   839   02  DFHPF13   PIC  X  VALUE  'A'.
   840   02  DFHPF14   PIC  X  VALUE  'B'.
   841   02  DFHPF15   PIC  X  VALUE  'C'.
   842   02  DFHPF16   PIC  X  VALUE  'D'.
   843   02  DFHPF17   PIC  X  VALUE  'E'.
   844   02  DFHPF18   PIC  X  VALUE  'F'.
   845   02  DFHPF19   PIC  X  VALUE  'G'.
   846   02  DFHPF20   PIC  X  VALUE  'H'.
   847   02  DFHPF21   PIC  X  VALUE  'I'.
   848*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   849   02  DFHPF22   PIC  X  VALUE  '['.
   850   02  DFHPF23   PIC  X  VALUE  '.'.
   851   02  DFHPF24   PIC  X  VALUE  '<'.
   852   02  DFHMSRE   PIC  X  VALUE  'X'.
   853   02  DFHSTRF   PIC  X  VALUE  'h'.
   854   02  DFHTRIG   PIC  X  VALUE  '"'.
   855 01  FILLER    REDEFINES DFHAID.
   856     12  FILLER              PIC X(8).
   857     12  PF-VALUES           PIC X       OCCURS 2.
   858
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  19
* EL601.cbl
   860*                            COPY EL601S.
   861 01  EL601AI.
   862     05  FILLER            PIC  X(0012).
   863*    -------------------------------
   864     05  DATEL PIC S9(0004) COMP.
   865     05  DATEF PIC  X(0001).
   866     05  FILLER REDEFINES DATEF.
   867         10  DATEA PIC  X(0001).
   868     05  DATEI PIC  X(0008).
   869*    -------------------------------
   870     05  TIMEL PIC S9(0004) COMP.
   871     05  TIMEF PIC  X(0001).
   872     05  FILLER REDEFINES TIMEF.
   873         10  TIMEA PIC  X(0001).
   874     05  TIMEI PIC  X(0005).
   875*    -------------------------------
   876     05  ITEM11L PIC S9(0004) COMP.
   877     05  ITEM11F PIC  X(0001).
   878     05  FILLER REDEFINES ITEM11F.
   879         10  ITEM11A PIC  X(0001).
   880     05  ITEM11I PIC  X(0032).
   881*    -------------------------------
   882     05  ITEM13L PIC S9(0004) COMP.
   883     05  ITEM13F PIC  X(0001).
   884     05  FILLER REDEFINES ITEM13F.
   885         10  ITEM13A PIC  X(0001).
   886     05  ITEM13I PIC  X(0032).
   887*    -------------------------------
   888     05  ITEM14L PIC S9(0004) COMP.
   889     05  ITEM14F PIC  X(0001).
   890     05  FILLER REDEFINES ITEM14F.
   891         10  ITEM14A PIC  X(0001).
   892     05  ITEM14I PIC  X(0029).
   893*    -------------------------------
   894     05  ITEM15L PIC S9(0004) COMP.
   895     05  ITEM15F PIC  X(0001).
   896     05  FILLER REDEFINES ITEM15F.
   897         10  ITEM15A PIC  X(0001).
   898     05  ITEM15I PIC  X(0038).
   899*    -------------------------------
   900     05  ITEM16L PIC S9(0004) COMP.
   901     05  ITEM16F PIC  X(0001).
   902     05  FILLER REDEFINES ITEM16F.
   903         10  ITEM16A PIC  X(0001).
   904     05  ITEM16I PIC  X(0037).
   905*    -------------------------------
   906     05  ITEM17L PIC S9(0004) COMP.
   907     05  ITEM17F PIC  X(0001).
   908     05  FILLER REDEFINES ITEM17F.
   909         10  ITEM17A PIC  X(0001).
   910     05  ITEM17I PIC  X(0037).
   911*    -------------------------------
   912     05  ITEM18L PIC S9(0004) COMP.
   913     05  ITEM18F PIC  X(0001).
   914     05  FILLER REDEFINES ITEM18F.
   915         10  ITEM18A PIC  X(0001).
   916     05  ITEM18I PIC  X(0037).
   917*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  20
* EL601.cbl
   918     05  ERRMSGL PIC S9(0004) COMP.
   919     05  ERRMSGF PIC  X(0001).
   920     05  FILLER REDEFINES ERRMSGF.
   921         10  ERRMSGA PIC  X(0001).
   922     05  ERRMSGI PIC  X(0079).
   923*    -------------------------------
   924     05  SELECTL PIC S9(0004) COMP.
   925     05  SELECTF PIC  X(0001).
   926     05  FILLER REDEFINES SELECTF.
   927         10  SELECTA PIC  X(0001).
   928     05  SELECTI PIC  X(0002).
   929*    -------------------------------
   930     05  PROGL PIC S9(0004) COMP.
   931     05  PROGF PIC  X(0001).
   932     05  FILLER REDEFINES PROGF.
   933         10  PROGA PIC  X(0001).
   934     05  PROGI PIC  X(0008).
   935*    -------------------------------
   936     05  PFKEYL PIC S9(0004) COMP.
   937     05  PFKEYF PIC  X(0001).
   938     05  FILLER REDEFINES PFKEYF.
   939         10  PFKEYA PIC  X(0001).
   940     05  PFKEYI PIC  X(0002).
   941 01  EL601AO REDEFINES EL601AI.
   942     05  FILLER            PIC  X(0012).
   943*    -------------------------------
   944     05  FILLER            PIC  X(0003).
   945     05  DATEO PIC  X(0008).
   946*    -------------------------------
   947     05  FILLER            PIC  X(0003).
   948     05  TIMEO PIC  99.99.
   949*    -------------------------------
   950     05  FILLER            PIC  X(0003).
   951     05  ITEM11O PIC  X(0032).
   952*    -------------------------------
   953     05  FILLER            PIC  X(0003).
   954     05  ITEM13O PIC  X(0032).
   955*    -------------------------------
   956     05  FILLER            PIC  X(0003).
   957     05  ITEM14O PIC  X(0029).
   958*    -------------------------------
   959     05  FILLER            PIC  X(0003).
   960     05  ITEM15O PIC  X(0038).
   961*    -------------------------------
   962     05  FILLER            PIC  X(0003).
   963     05  ITEM16O PIC  X(0037).
   964*    -------------------------------
   965     05  FILLER            PIC  X(0003).
   966     05  ITEM17O PIC  X(0037).
   967*    -------------------------------
   968     05  FILLER            PIC  X(0003).
   969     05  ITEM18O PIC  X(0037).
   970*    -------------------------------
   971     05  FILLER            PIC  X(0003).
   972     05  ERRMSGO PIC  X(0079).
   973*    -------------------------------
   974     05  FILLER            PIC  X(0003).
   975     05  SELECTO PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  21
* EL601.cbl
   976*    -------------------------------
   977     05  FILLER            PIC  X(0003).
   978     05  PROGO PIC  X(0008).
   979*    -------------------------------
   980     05  FILLER            PIC  X(0003).
   981     05  PFKEYO PIC  X(0002).
   982*    -------------------------------
   983
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  22
* EL601.cbl
   985****************************************************************
   986*
   987* Copyright (c) 2007-2013 Dell Inc.
   988* All rights reserved.
   989*
   990****************************************************************
   991 01  DFHEIV.
   992   02  DFHEIV0               PIC X(35).
   993   02  DFHEIV1               PIC X(08).
   994   02  DFHEIV2               PIC X(08).
   995   02  DFHEIV3               PIC X(08).
   996   02  DFHEIV4               PIC X(06).
   997   02  DFHEIV5               PIC X(04).
   998   02  DFHEIV6               PIC X(04).
   999   02  DFHEIV7               PIC X(02).
  1000   02  DFHEIV8               PIC X(02).
  1001   02  DFHEIV9               PIC X(01).
  1002   02  DFHEIV10              PIC S9(7) COMP-3.
  1003   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1004   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1005   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1006   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1007   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1008   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1009   02  DFHEIV17              PIC X(04).
  1010   02  DFHEIV18              PIC X(04).
  1011   02  DFHEIV19              PIC X(04).
  1012   02  DFHEIV20              USAGE IS POINTER.
  1013   02  DFHEIV21              USAGE IS POINTER.
  1014   02  DFHEIV22              USAGE IS POINTER.
  1015   02  DFHEIV23              USAGE IS POINTER.
  1016   02  DFHEIV24              USAGE IS POINTER.
  1017   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1018   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1019   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1020   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1021   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1022   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1023   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1024   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1025   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1026   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1027   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1028   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1029   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1030   02  FILLER                PIC X(02).
  1031   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1032   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1033   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1034   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1035   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1036   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1037   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1038 LINKAGE  SECTION.
  1039*****************************************************************
  1040*                                                               *
  1041* Copyright (c) 2007-2013 Dell Inc.                             *
  1042* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  23
* EL601.cbl
  1043*                                                               *
  1044*****************************************************************
  1045 01  dfheiblk.
  1046     02  eibtime          pic s9(7) comp-3.
  1047     02  eibdate          pic s9(7) comp-3.
  1048     02  eibtrnid         pic x(4).
  1049     02  eibtaskn         pic s9(7) comp-3.
  1050     02  eibtrmid         pic x(4).
  1051     02  dfheigdi         pic s9(4) comp.
  1052     02  eibcposn         pic s9(4) comp.
  1053     02  eibcalen         pic s9(4) comp.
  1054     02  eibaid           pic x(1).
  1055     02  eibfiller1       pic x(1).
  1056     02  eibfn            pic x(2).
  1057     02  eibfiller2       pic x(2).
  1058     02  eibrcode         pic x(6).
  1059     02  eibfiller3       pic x(2).
  1060     02  eibds            pic x(8).
  1061     02  eibreqid         pic x(8).
  1062     02  eibrsrce         pic x(8).
  1063     02  eibsync          pic x(1).
  1064     02  eibfree          pic x(1).
  1065     02  eibrecv          pic x(1).
  1066     02  eibsend          pic x(1).
  1067     02  eibatt           pic x(1).
  1068     02  eibeoc           pic x(1).
  1069     02  eibfmh           pic x(1).
  1070     02  eibcompl         pic x(1).
  1071     02  eibsig           pic x(1).
  1072     02  eibconf          pic x(1).
  1073     02  eiberr           pic x(1).
  1074     02  eibrldbk         pic x(1).
  1075     02  eiberrcd         pic x(4).
  1076     02  eibsynrb         pic x(1).
  1077     02  eibnodat         pic x(1).
  1078     02  eibfiller5       pic x(2).
  1079     02  eibresp          pic s9(8) comp.
  1080     02  eibresp2         pic s9(8) comp.
  1081     02  dfheigdj         pic s9(4) comp.
  1082     02  dfheigdk         pic s9(4) comp.
  1083 01  DFHCOMMAREA             PIC X(1024).
  1084
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  24
* EL601.cbl
  1086 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1087 0000-DFHEXIT SECTION.
  1088     MOVE '9#                    $   ' TO DFHEIV0.
  1089     MOVE 'EL601' TO DFHEIV1.
  1090     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1091
  1092     MOVE DFHCOMMAREA   TO PROGRAM-INTERFACE-BLOCK.
  1093
  1094     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1095     MOVE '5'                    TO DC-OPTION-CODE.
  1096     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  1097     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1098     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  1099
  1100     IF EIBCALEN = 0
  1101         GO TO 8800-UNAUTHORIZED-ACCESS.
  1102
  1103     IF PI-CALLING-PROGRAM NOT = PGM-EL601
  1104         IF PI-RETURN-TO-PROGRAM NOT = PGM-EL601
  1105             MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-6
  1106             MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-5
  1107             MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-4
  1108             MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-3
  1109             MOVE PI-SAVED-PROGRAM-1     TO PI-SAVED-PROGRAM-2
  1110             MOVE PI-RETURN-TO-PROGRAM   TO PI-SAVED-PROGRAM-1
  1111             MOVE PI-CALLING-PROGRAM     TO PI-RETURN-TO-PROGRAM
  1112             MOVE PGM-EL601              TO PI-CALLING-PROGRAM
  1113         ELSE
  1114             MOVE PI-RETURN-TO-PROGRAM   TO PI-CALLING-PROGRAM
  1115             MOVE PI-SAVED-PROGRAM-1     TO PI-RETURN-TO-PROGRAM
  1116             MOVE PI-SAVED-PROGRAM-2     TO PI-SAVED-PROGRAM-1
  1117             MOVE PI-SAVED-PROGRAM-3     TO PI-SAVED-PROGRAM-2
  1118             MOVE PI-SAVED-PROGRAM-4     TO PI-SAVED-PROGRAM-3
  1119             MOVE PI-SAVED-PROGRAM-5     TO PI-SAVED-PROGRAM-4
  1120             MOVE PI-SAVED-PROGRAM-6     TO PI-SAVED-PROGRAM-5
  1121             MOVE SPACES                 TO PI-SAVED-PROGRAM-6.
  1122
  1123
  1124* EXEC CICS HANDLE CONDITION
  1125*        PGMIDERR  (9600-PGMID-ERROR)
  1126*        ERROR     (9990-ABEND)
  1127*    END-EXEC.
  1128*    MOVE '"$L.                  ! " #00001119' TO DFHEIV0
  1129     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1130     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1131     MOVE X'2220233030303031313139' TO DFHEIV0(25:11)
  1132     CALL 'kxdfhei1' USING DFHEIV0
  1133     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1134
  1135
  1136     IF EIBTRNID  = TRANS-EXA1
  1137         GO TO 0100-SAME-TRAN.
  1138
  1139     GO TO 8100-SEND-INITIAL-MAP.
  1140
  1141 0100-SAME-TRAN.
  1142     IF EIBAID = DFHCLEAR
  1143         GO TO 9400-CLEAR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  25
* EL601.cbl
  1144
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  26
* EL601.cbl
  1146 0200-RECEIVE.
  1147     MOVE LOW-VALUES   TO EL601AI.
  1148
  1149     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1150         MOVE -1                 TO SELECTL
  1151         MOVE ER-7008         TO EMI-ERROR
  1152         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1153         GO TO 8200-SEND-DATAONLY.
  1154
  1155
  1156* EXEC CICS RECEIVE
  1157*        MAP      (MAP-EL601A)
  1158*        MAPSET   (MAPSET-EL601S)
  1159*        INTO     (EL601AI)
  1160*    END-EXEC.
  1161     MOVE LENGTH OF
  1162      EL601AI
  1163       TO DFHEIV11
  1164*    MOVE '8"T I  L              ''   #00001143' TO DFHEIV0
  1165     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1166     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1167     MOVE X'2020233030303031313433' TO DFHEIV0(25:11)
  1168     CALL 'kxdfhei1' USING DFHEIV0,
  1169           MAP-EL601A,
  1170           EL601AI,
  1171           DFHEIV11,
  1172           MAPSET-EL601S,
  1173           DFHEIV99,
  1174           DFHEIV99
  1175     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1176
  1177
  1178     MOVE SPACES                 TO PI-ENTRY-CD-1.
  1179
  1180     IF EIBAID = DFHPF12
  1181        GO TO 9500-HELP
  1182     ELSE
  1183        IF EIBAID = DFHPF23
  1184           GO TO 8810-PF23
  1185        ELSE
  1186           IF EIBAID = DFHPF24
  1187              GO TO 9200-PF24.
  1188
  1189     IF PFKEYL = ZEROS
  1190         NEXT SENTENCE
  1191     ELSE
  1192         IF PFKEYI = '12'
  1193            GO TO 9500-HELP
  1194         ELSE
  1195            IF PFKEYI = '23'
  1196               GO TO 8810-PF23
  1197            ELSE
  1198               IF PFKEYI = '24'
  1199                  GO TO 9200-PF24.
  1200
  1201     IF EIBAID NOT = DFHENTER
  1202         MOVE ER-0002         TO EMI-ERROR
  1203         GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  27
* EL601.cbl
  1204
  1205     IF SELECTL = 0
  1206         MOVE ER-0002         TO EMI-ERROR
  1207         GO TO 0320-INPUT-ERROR.
  1208
  1209 0310-CHECK-PFKEYS.
  1210     IF SELECTI = '01'
  1211         MOVE XCTL-EL650 TO PGM-NAME
  1212         GO TO 9300-XCTL.
  1213
  1214     IF SELECTI = '02'
  1215         MOVE XCTL-EL652 TO PGM-NAME
  1216         GO TO 9300-XCTL.
  1217
  1218     IF SELECTI = '03'
  1219         MOVE XCTL-EL656 TO PGM-NAME
  1220         GO TO 9300-XCTL.
  1221
  1222     IF SELECTI = '04'
  1223         MOVE XCTL-EL651 TO PGM-NAME
  1224         GO TO 9300-XCTL.
  1225
  1226     IF SELECTI = '05'
  1227         MOVE XCTL-EL653 TO PGM-NAME
  1228         GO TO 9300-XCTL.
  1229
  1230     IF SELECTI = '06'
  1231         MOVE XCTL-EL658 TO PGM-NAME
  1232         GO TO 9300-XCTL.
  1233
  1234     IF SELECTI = '07'
  1235         MOVE XCTL-EL610 TO PGM-NAME
  1236         GO TO 9300-XCTL.
  1237
  1238     IF SELECTI = '08'
  1239         MOVE XCTL-EL659 TO PGM-NAME
  1240         GO TO 9300-XCTL.
  1241
  1242     IF SELECTI = '09'
  1243         MOVE XCTL-EL158 TO PGM-NAME
  1244         GO TO 9300-XCTL.
  1245
  1246     IF SELECTI = '10'
  1247        MOVE XCTL-EL159 TO PGM-NAME
  1248             GO TO 9300-XCTL.
  1249
  1250     IF SELECTI = '11'
  1251         IF PI-COMPANY-ID  =  'NCL' OR 'LGX'
  1252            MOVE XCTL-EL607 TO PGM-NAME
  1253            GO TO 9300-XCTL.
  1254
  1255     IF SELECTI = '12'
  1256       IF PI-AR-PROCESSING
  1257          MOVE XCTL-EL611 TO PGM-NAME
  1258          GO TO 9300-XCTL
  1259       ELSE
  1260          MOVE ER-7448   TO EMI-ERROR
  1261          GO TO 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  28
* EL601.cbl
  1262
  1263     IF SELECTI = '13'
  1264        IF PI-COMPANY-ID = 'CID' OR 'AHL' or 'FNL'
  1265           MOVE XCTL-EL605       TO PGM-NAME
  1266           GO TO 9300-XCTL
  1267        END-IF
  1268     END-IF
  1269
  1270     IF SELECTI = '13'
  1271         IF PI-COMPANY-ID  =  'NCL' OR 'LGX'
  1272             MOVE XCTL-EL606 TO PGM-NAME
  1273             GO TO 9300-XCTL.
  1274
  1275     IF SELECTI = '14'
  1276         IF PI-COMPANY-ID  =  'DMD'
  1277             MOVE XCTL-EL1062 TO PGM-NAME
  1278             GO TO 9300-XCTL.
  1279
  1280     IF SELECTI = '15'
  1281         IF PI-COMPANY-ID  =  'DMD'
  1282             MOVE XCTL-EL608 TO PGM-NAME
  1283             GO TO 9300-XCTL.
  1284
  1285     IF SELECTI = '16'
  1286         IF PI-COMPANY-ID  =  'DMD'
  1287             MOVE XCTL-EL1064 TO PGM-NAME
  1288             GO TO 9300-XCTL.
  1289
  1290*    IF SELECTI = '17'
  1291*        IF PI-COMPANY-ID  =  'DMD'
  1292*            MOVE XCTL-ELXXXX TO PGM-NAME (CODES TABLE MAINT)
  1293*            GO TO 9300-XCTL.
  1294*
  1295*CODE ABOVE COMMENTED OUT PENDING SPECS APPROVAL
  1296*
  1297
  1298     IF SELECTI = '18'
  1299         IF PI-COMPANY-ID  =  'NCB'
  1300             MOVE XCTL-EL400 TO PGM-NAME
  1301             GO TO 9300-XCTL.
  1302
  1303     IF SELECTI = '21'
  1304         MOVE XCTL-EL102 TO PGM-NAME
  1305         GO TO 9300-XCTL.
  1306
  1307     IF SELECTI = '22'
  1308         MOVE XCTL-EL105 TO PGM-NAME
  1309         GO TO 9300-XCTL.
  1310
  1311     IF SELECTI = '23'
  1312       IF PI-AR-PROCESSING
  1313          MOVE XCTL-EL613 TO PGM-NAME
  1314          GO TO 9300-XCTL
  1315       ELSE
  1316          MOVE ER-7448   TO EMI-ERROR
  1317          GO TO 0320-INPUT-ERROR.
  1318
  1319     IF SELECTI = '24'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  29
* EL601.cbl
  1320         MOVE XCTL-EL106 TO PGM-NAME
  1321         GO TO 9300-XCTL.
  1322     IF SELECTI = '25'
  1323        MOVE XCTL-EL115          TO PGM-NAME
  1324        GO TO 9300-XCTL
  1325     END-IF
  1326     IF SELECTI = '26'
  1327         MOVE XCTL-EL107 TO PGM-NAME
  1328         GO TO 9300-XCTL.
  1329
  1330     IF SELECTI = '27'
  1331         MOVE XCTL-EL604 TO PGM-NAME
  1332         GO TO 9300-XCTL.
  1333
  1334     IF SELECTI = '28'
  1335         MOVE XCTL-EL602 TO PGM-NAME
  1336         GO TO 9300-XCTL.
  1337
  1338     IF SELECTI = '29'
  1339         MOVE XCTL-EL603 TO PGM-NAME
  1340         GO TO 9300-XCTL.
  1341
  1342     IF SELECTI = '30'
  1343         MOVE XCTL-EL654 TO PGM-NAME
  1344         GO TO 9300-XCTL.
  1345
  1346     IF SELECTI = '31'
  1347         MOVE XCTL-EL103 TO PGM-NAME
  1348         GO TO 9300-XCTL.
  1349
  1350     IF SELECTI = '32'
  1351         MOVE XCTL-EL119 TO PGM-NAME
  1352         GO TO 9300-XCTL.
  1353
  1354     IF SELECTI = '33'
  1355         MOVE XCTL-EL108 TO PGM-NAME
  1356         GO TO 9300-XCTL.
  1357
  1358     IF SELECTI = '34'
  1359         MOVE XCTL-EL104 TO PGM-NAME
  1360         GO TO 9300-XCTL.
  1361
  1362     IF SELECTI = '35'
  1363         MOVE XCTL-EL110 TO PGM-NAME
  1364         GO TO 9300-XCTL.
  1365
  1366     IF SELECTI = '36'
  1367         MOVE XCTL-EL111 TO PGM-NAME
  1368         GO TO 9300-XCTL.
  1369
  1370     IF SELECTI = '37'
  1371         MOVE XCTL-EL112 TO PGM-NAME
  1372         GO TO 9300-XCTL.
  1373
  1374     MOVE ER-7002                TO EMI-ERROR.
  1375
  1376 0320-INPUT-ERROR.
  1377     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  30
* EL601.cbl
  1378     MOVE AL-UNBON               TO SELECTA.
  1379     MOVE -1                     TO SELECTL.
  1380     GO TO 8200-SEND-DATAONLY.
  1381
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  31
* EL601.cbl
  1383 8100-SEND-INITIAL-MAP.
  1384     MOVE LOW-VALUES             TO EL601AO.
  1385     MOVE EIBTIME                TO TIME-IN.
  1386     MOVE TIME-OUT               TO TIMEO.
  1387     MOVE SAVE-DATE              TO DATEO.
  1388
  1389     MOVE SCREEN-RESERVE-11      TO ITEM11O.
  1390
  1391     MOVE SCREEN-SELECT-12       TO ITEM13O.
  1392
  1393     IF PI-COMPANY-ID  =  'CID' OR 'AHL' OR 'FNL'
  1394        MOVE SCREEN-SELECT-13    TO ITEM14O
  1395     END-IF
  1396
  1397     IF PI-COMPANY-ID  =  'NCL' OR 'LGX'
  1398         MOVE SCREEN-SELECT-11   TO ITEM11O
  1399         MOVE SCREEN-SELECT-13   TO ITEM14O
  1400         MOVE SPACES             TO ITEM15O ITEM16O
  1401                                    ITEM17O ITEM18O.
  1402
  1403     IF PI-COMPANY-ID  =  'DMD'
  1404         MOVE SCREEN-RESERVE-13  TO  ITEM14O
  1405         MOVE SCREEN-SELECT-14   TO  ITEM15O
  1406         MOVE SCREEN-SELECT-15   TO  ITEM16O
  1407         MOVE SCREEN-SELECT-16   TO  ITEM17O
  1408         MOVE SPACES             TO  ITEM18O.
  1409*        MOVE SCREEN-SELECT-17   TO  ITEM17O.
  1410
  1411     IF PI-COMPANY-ID  =  'NCB'
  1412         MOVE SCREEN-RESERVE-13  TO ITEM14O
  1413         MOVE SCREEN-RESERVE-14  TO ITEM15O
  1414         MOVE SCREEN-RESERVE-15  TO ITEM16O
  1415         MOVE SCREEN-RESERVE-16  TO ITEM17O
  1416         MOVE SCREEN-SELECT-18   TO ITEM18O.
  1417
  1418     MOVE -1                     TO SELECTL.
  1419
  1420
  1421* EXEC CICS SEND
  1422*        MAP     (MAP-EL601A)
  1423*        MAPSET  (MAPSET-EL601S)
  1424*        FROM    (EL601AO)
  1425*        ERASE
  1426*        CURSOR
  1427*    END-EXEC.
  1428     MOVE LENGTH OF
  1429      EL601AO
  1430       TO DFHEIV12
  1431     MOVE -1
  1432       TO DFHEIV11
  1433*    MOVE '8$     CT  E    H L F ,   #00001391' TO DFHEIV0
  1434     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1435     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1436     MOVE X'2020233030303031333931' TO DFHEIV0(25:11)
  1437     CALL 'kxdfhei1' USING DFHEIV0,
  1438           MAP-EL601A,
  1439           EL601AO,
  1440           DFHEIV12,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  32
* EL601.cbl
  1441           MAPSET-EL601S,
  1442           DFHEIV99,
  1443           DFHEIV99,
  1444           DFHEIV99,
  1445           DFHEIV11,
  1446           DFHEIV99,
  1447           DFHEIV99,
  1448           DFHEIV99
  1449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1450
  1451
  1452     GO TO 9100-RETURN-TRAN.
  1453
  1454 8200-SEND-DATAONLY.
  1455     MOVE SAVE-DATE              TO DATEO.
  1456     MOVE EIBTIME                TO TIME-IN.
  1457     MOVE TIME-OUT               TO TIMEO.
  1458     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  1459
  1460     MOVE SCREEN-RESERVE-11      TO ITEM11O.
  1461
  1462     MOVE SCREEN-SELECT-12       TO ITEM13O.
  1463
  1464     IF PI-COMPANY-ID  =  'NCL' OR 'LGX'
  1465         MOVE SCREEN-SELECT-11   TO  ITEM11O
  1466         MOVE SCREEN-SELECT-13   TO  ITEM14O
  1467         MOVE SPACES             TO ITEM15O ITEM16O
  1468                                    ITEM17O ITEM18O.
  1469
  1470     IF PI-COMPANY-ID  =  'DMD'
  1471         MOVE SCREEN-RESERVE-13  TO  ITEM14O
  1472         MOVE SCREEN-SELECT-14   TO  ITEM15O
  1473         MOVE SCREEN-SELECT-15   TO  ITEM16O
  1474         MOVE SCREEN-SELECT-16   TO  ITEM17O
  1475         MOVE SPACES             TO  ITEM18O.
  1476*        MOVE SCREEN-SELECT-17   TO  ITEM17O.
  1477
  1478     IF PI-COMPANY-ID  =  'NCB'
  1479         MOVE SCREEN-RESERVE-13  TO ITEM14O
  1480         MOVE SCREEN-RESERVE-14  TO ITEM15O
  1481         MOVE SCREEN-RESERVE-15  TO ITEM16O
  1482         MOVE SCREEN-RESERVE-16  TO ITEM17O
  1483         MOVE SCREEN-SELECT-18   TO ITEM18O.
  1484
  1485
  1486* EXEC CICS SEND
  1487*        MAP      (MAP-EL601A)
  1488*        MAPSET   (MAPSET-EL601S)
  1489*        FROM     (EL601AO)
  1490*        DATAONLY
  1491*        CURSOR
  1492*    END-EXEC.
  1493     MOVE LENGTH OF
  1494      EL601AO
  1495       TO DFHEIV12
  1496     MOVE -1
  1497       TO DFHEIV11
  1498*    MOVE '8$D    CT       H L F ,   #00001432' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  33
* EL601.cbl
  1499     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  1500     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1501     MOVE X'2020233030303031343332' TO DFHEIV0(25:11)
  1502     CALL 'kxdfhei1' USING DFHEIV0,
  1503           MAP-EL601A,
  1504           EL601AO,
  1505           DFHEIV12,
  1506           MAPSET-EL601S,
  1507           DFHEIV99,
  1508           DFHEIV99,
  1509           DFHEIV99,
  1510           DFHEIV11,
  1511           DFHEIV99,
  1512           DFHEIV99,
  1513           DFHEIV99
  1514     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1515
  1516
  1517     GO TO 9100-RETURN-TRAN.
  1518
  1519 8300-SEND-TEXT.
  1520
  1521* EXEC CICS SEND TEXT
  1522*        FROM     (LOGOFF-TEXT)
  1523*        LENGTH   (LOGOFF-LENGTH)
  1524*        ERASE
  1525*        FREEKB
  1526*    END-EXEC.
  1527*    MOVE '8&      T  E F  H   F -   #00001443' TO DFHEIV0
  1528     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  1529     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  1530     MOVE X'2020233030303031343433' TO DFHEIV0(25:11)
  1531     CALL 'kxdfhei1' USING DFHEIV0,
  1532           LOGOFF-TEXT,
  1533           LOGOFF-LENGTH,
  1534           DFHEIV99,
  1535           DFHEIV99,
  1536           DFHEIV99,
  1537           DFHEIV99,
  1538           DFHEIV99,
  1539           DFHEIV99,
  1540           DFHEIV99,
  1541           DFHEIV99,
  1542           DFHEIV99,
  1543           DFHEIV99
  1544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1545
  1546
  1547
  1548* EXEC CICS RETURN
  1549*    END-EXEC.
  1550*    MOVE '.(                    ''   #00001450' TO DFHEIV0
  1551     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1552     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1553     MOVE X'2020233030303031343530' TO DFHEIV0(25:11)
  1554     CALL 'kxdfhei1' USING DFHEIV0,
  1555           DFHEIV99,
  1556           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  34
* EL601.cbl
  1557           DFHEIV99,
  1558           DFHEIV99,
  1559           DFHEIV99,
  1560           DFHEIV99
  1561     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1562
  1563
  1564 8800-UNAUTHORIZED-ACCESS.
  1565     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  1566     GO TO 8300-SEND-TEXT.
  1567
  1568 8810-PF23.
  1569     MOVE DFHPF23                TO PI-ENTRY-CD-1.
  1570     MOVE XCTL-EL005             TO PGM-NAME.
  1571     GO TO 9300-XCTL.
  1572
  1573 9100-RETURN-TRAN.
  1574     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  1575     MOVE '601A'                 TO PI-CURRENT-SCREEN-NO.
  1576
  1577
  1578* EXEC CICS RETURN
  1579*        TRANSID   (TRANS-EXA1)
  1580*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  1581*        LENGTH    (PI-COMM-LENGTH)
  1582*    END-EXEC.
  1583*    MOVE '.(CT                  ''   #00001466' TO DFHEIV0
  1584     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1585     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1586     MOVE X'2020233030303031343636' TO DFHEIV0(25:11)
  1587     CALL 'kxdfhei1' USING DFHEIV0,
  1588           TRANS-EXA1,
  1589           PROGRAM-INTERFACE-BLOCK,
  1590           PI-COMM-LENGTH,
  1591           DFHEIV99,
  1592           DFHEIV99,
  1593           DFHEIV99
  1594     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1595
  1596
  1597 9200-PF24.
  1598     MOVE XCTL-EL626             TO PGM-NAME.
  1599     GO TO 9300-XCTL.
  1600
  1601 9300-XCTL.
  1602     MOVE SPACES                 TO PI-ENTRY-CD-2
  1603                                    PI-RETURN-CODES
  1604                                    PI-UPDATE-BY
  1605                                    PI-PROGRAM-WORK-AREA.
  1606     MOVE ZEROS                  TO PI-UPDATE-HHMMSS.
  1607
  1608
  1609* EXEC CICS XCTL
  1610*        PROGRAM    (PGM-NAME)
  1611*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  1612*        LENGTH     (PI-COMM-LENGTH)
  1613*    END-EXEC.
  1614*    MOVE '.$C                   %   #00001483' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  35
* EL601.cbl
  1615     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  1616     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1617     MOVE X'2020233030303031343833' TO DFHEIV0(25:11)
  1618     CALL 'kxdfhei1' USING DFHEIV0,
  1619           PGM-NAME,
  1620           PROGRAM-INTERFACE-BLOCK,
  1621           PI-COMM-LENGTH,
  1622           DFHEIV99
  1623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1624
  1625
  1626 9400-CLEAR.
  1627     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  1628     GO TO 9300-XCTL.
  1629
  1630 9500-HELP.
  1631     MOVE XCTL-EL010             TO PGM-NAME.
  1632     GO TO 9300-XCTL.
  1633
  1634 9600-PGMID-ERROR.
  1635     MOVE PGM-NAME               TO PROGO.
  1636     MOVE AL-UNBON               TO SELECTA.
  1637     MOVE ER-7003                TO EMI-ERROR.
  1638
  1639
  1640* EXEC CICS HANDLE CONDITION
  1641*        PGMIDERR  (8300-SEND-TEXT)
  1642*    END-EXEC.
  1643*    MOVE '"$L                   ! # #00001502' TO DFHEIV0
  1644     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  1645     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1646     MOVE X'2320233030303031353032' TO DFHEIV0(25:11)
  1647     CALL 'kxdfhei1' USING DFHEIV0
  1648     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1649
  1650
  1651     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  1652     MOVE ' '                    TO PI-ENTRY-CD-1.
  1653     MOVE XCTL-EL005             TO PGM-NAME.
  1654     MOVE PGM-NAME               TO LOGOFF-PGM.
  1655     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  1656     GO TO 9300-XCTL.
  1657
  1658 9700-LINK-DATE-CONVERT.
  1659
  1660* EXEC CICS LINK
  1661*        PROGRAM    (LINK-ELDATCV)
  1662*        COMMAREA   (DATE-CONVERSION-DATA)
  1663*        LENGTH     (DC-COMM-LENGTH)
  1664*    END-EXEC.
  1665*    MOVE '."C                   (   #00001514' TO DFHEIV0
  1666     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1667     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1668     MOVE X'2020233030303031353134' TO DFHEIV0(25:11)
  1669     CALL 'kxdfhei1' USING DFHEIV0,
  1670           LINK-ELDATCV,
  1671           DATE-CONVERSION-DATA,
  1672           DC-COMM-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  36
* EL601.cbl
  1673           DFHEIV99,
  1674           DFHEIV99,
  1675           DFHEIV99,
  1676           DFHEIV99
  1677     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1678
  1679
  1680 9700-EXIT.
  1681     EXIT.
  1682
  1683 9900-ERROR-FORMAT.
  1684     IF NOT EMI-ERRORS-COMPLETE
  1685         MOVE LINK-EL001         TO PGM-NAME
  1686
  1687* EXEC CICS LINK
  1688*            PROGRAM    (PGM-NAME)
  1689*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  1690*            LENGTH     (EMI-COMM-LENGTH)
  1691*        END-EXEC.
  1692*    MOVE '."C                   (   #00001526' TO DFHEIV0
  1693     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1694     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1695     MOVE X'2020233030303031353236' TO DFHEIV0(25:11)
  1696     CALL 'kxdfhei1' USING DFHEIV0,
  1697           PGM-NAME,
  1698           ERROR-MESSAGE-INTERFACE-BLOCK,
  1699           EMI-COMM-LENGTH,
  1700           DFHEIV99,
  1701           DFHEIV99,
  1702           DFHEIV99,
  1703           DFHEIV99
  1704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1705
  1706
  1707 9900-EXIT.
  1708     EXIT.
  1709
  1710 9990-ABEND.
  1711     MOVE LINK-EL004             TO PGM-NAME.
  1712     MOVE DFHEIBLK               TO EMI-LINE1.
  1713
  1714
  1715* EXEC CICS LINK
  1716*        PROGRAM   (PGM-NAME)
  1717*        COMMAREA  (EMI-LINE1)
  1718*        LENGTH    (72)
  1719*    END-EXEC.
  1720     MOVE 72
  1721       TO DFHEIV11
  1722*    MOVE '."C                   (   #00001539' TO DFHEIV0
  1723     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1724     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1725     MOVE X'2020233030303031353339' TO DFHEIV0(25:11)
  1726     CALL 'kxdfhei1' USING DFHEIV0,
  1727           PGM-NAME,
  1728           EMI-LINE1,
  1729           DFHEIV11,
  1730           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:28 Page  37
* EL601.cbl
  1731           DFHEIV99,
  1732           DFHEIV99,
  1733           DFHEIV99
  1734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1735
  1736
  1737     GO TO 8200-SEND-DATAONLY.
  1738
  1739
  1740 9999-DFHBACK SECTION.
  1741     MOVE '9%                    "   ' TO DFHEIV0
  1742     MOVE 'EL601' TO DFHEIV1
  1743     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1744     GOBACK.
  1745 9999-DFHEXIT.
  1746     IF DFHEIGDJ EQUAL 0001
  1747         NEXT SENTENCE
  1748     ELSE IF DFHEIGDJ EQUAL 2
  1749         GO TO 9600-PGMID-ERROR,
  1750               9990-ABEND
  1751         DEPENDING ON DFHEIGDI
  1752     ELSE IF DFHEIGDJ EQUAL 3
  1753         GO TO 8300-SEND-TEXT
  1754         DEPENDING ON DFHEIGDI.
  1755     MOVE '9%                    "   ' TO DFHEIV0
  1756     MOVE 'EL601' TO DFHEIV1
  1757     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1758     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4884     Code:        3946
