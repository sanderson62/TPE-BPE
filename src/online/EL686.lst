* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL686.cbl
* Options: int("EL686.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL686.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL686.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL686.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL686 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:57:46.
     7*                            VMOD=2.018
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL686.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.     TRANSACTION - EXG2
    25*
    26*        THIS PROGRAM IS USED TO INDICATE THE CHECKS BEING
    27*    RELEASED TO PRINT.  EACH RELEASE CONSTITUTES A CONTROL GROUP
    28*    THAT IS REFERENCED BY THE CHECK WRITER (EL687) AND THE CHECK
    29*    PRINT STARTER (EL686).
    30*
    31*    SCREENS     - EL686A - CHECK RELEASE
    32*
    33*    ENTERED BY  - EL671  - REPORT MENU
    34*
    35*    EXIT TO     - EL671  - RESULT OF CLEAR
    36*
    37*    INPUT FILES - ERPYAJ - PENDING PAYMENT AND ADJUSTMENTS
    38*                  ERCHEK - CHECK MAINTENANCE FILE
    39*                  ERCMCK - COMMISSION CHECK MAINTENANCE FILE
    40*                  ELCNTL - CONTROL FILE
    41*
    42*    OUTPUT FILES - ERPYAJ - PENDING PAYMENTS AND ADJUSTMENTS
    43*                   ERCHEK - CHECK MAINTENANCE FILE
    44*                   ELCNTL - CONTROL FILE
    45*                   ERCHKQ - CHECK QUEUE
    46*                   ERCMKQ - COMMISSION CHECK QUEUE
    47*
    48*    COMMAREA    - PASSED.
    49*
    50******************************************************************
    51*                   C H A N G E   L O G
    52*
    53* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    54*-----------------------------------------------------------------
    55*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    56* EFFECTIVE    NUMBER
    57*-----------------------------------------------------------------
    58* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    59******************************************************************
    60
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL686.cbl
    62 ENVIRONMENT DIVISION.
    63
    64 DATA DIVISION.
    65
    66 WORKING-STORAGE SECTION.
    67 01  DFH-START PIC X(04).
    68
    69 77  FILLER  PIC X(32)  VALUE '********************************'.
    70 77  FILLER  PIC X(32)  VALUE '*    EL686 WORKING STORAGE     *'.
    71 77  FILLER  PIC X(32)  VALUE '************ V/M 2.018 *********'.
    72
    73*    COPY ELCSCTM.
    74******************************************************************
    75*                                                                *
    76*                                                                *
    77*                            ELCSCTM                             *
    78*                            VMOD=2.001                          *
    79*                                                                *
    80*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    81*                                                                *
    82******************************************************************
    83 01  SECURITY-MESSAGE.
    84     12  FILLER                          PIC X(30)
    85            VALUE '** LOGIC SECURITY VIOLATION -'.
    86     12  SM-READ                         PIC X(6).
    87     12  FILLER                          PIC X(5)
    88            VALUE ' PGM='.
    89     12  SM-PGM                          PIC X(6).
    90     12  FILLER                          PIC X(5)
    91            VALUE ' OPR='.
    92     12  SM-PROCESSOR-ID                 PIC X(4).
    93     12  FILLER                          PIC X(6)
    94            VALUE ' TERM='.
    95     12  SM-TERMID                       PIC X(4).
    96     12  FILLER                          PIC XX   VALUE SPACE.
    97     12  SM-JUL-DATE                     PIC 9(5).
    98     12  FILLER                          PIC X    VALUE SPACE.
    99     12  SM-TIME                         PIC 99.99.
   100
   101*    COPY ELCSCRTY.
   102******************************************************************
   103*                                                                *
   104*                                                                *
   105*                            ELCSCRTY                            *
   106*                            VMOD=2.001                          *
   107*                                                                *
   108*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   109*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   110*        SAVED IN PI-SECURITY-ADDRESS.                           *
   111*                                                                *
   112******************************************************************
   113 01  SECURITY-CONTROL.
   114     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   115     12  FILLER                       PIC XX    VALUE 'SC'.
   116     12  SC-CREDIT-CODES.
   117         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   118             20  SC-CREDIT-DISPLAY    PIC X.
   119             20  SC-CREDIT-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL686.cbl
   120     12  SC-CLAIMS-CODES.
   121         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   122             20  SC-CLAIMS-DISPLAY    PIC X.
   123             20  SC-CLAIMS-UPDATE     PIC X.
   124 01  FILLER                          COMP-3.
   125     05  WS-NDX                      PIC S9(3)       VALUE ZERO.
   126     05  WS-SEQ-NO                   PIC S9(9)       VALUE ZERO.
   127
   128     05  WS-TIME-WORK                PIC S9(7)       VALUE ZERO.
   129     05  WS-TIME                     REDEFINES
   130         WS-TIME-WORK                PIC S9(3)V9(4).
   131     05  WS-HHMM                     REDEFINES
   132         WS-TIME-WORK                PIC S9(5)V99.
   133
   134     05  WS-ERPYAJ-BROWSE-SW         PIC S9          VALUE +0.
   135         88  WS-ERPYAJ-BROWSE-NOT-STARTED            VALUE +0.
   136         88  WS-ERPYAJ-BROWSE-STARTED                VALUE +1.
   137     05  WS-ERCHEK-BROWSE-SW         PIC S9          VALUE +0.
   138         88  WS-ERCHEK-BROWSE-NOT-STARTED            VALUE +0.
   139         88  WS-ERCHEK-BROWSE-STARTED                VALUE +1.
   140     05  WS-ERCMCK-BROWSE-SW         PIC S9          VALUE +0.
   141         88  WS-ERCMCK-BROWSE-NOT-STARTED            VALUE +0.
   142         88  WS-ERCMCK-BROWSE-STARTED                VALUE +1.
   143
   144     05  WS-RELEASED-COUNT           PIC S9(5)       VALUE ZERO.
   145     05  WS-RELEASED-AMOUNT          PIC S9(9)V99    VALUE ZERO.
   146
   147 01  FILLER                          COMP SYNC.
   148
   149     05  SC-ITEM                     PIC S9(4)       VALUE  +1.
   150     05  WS-INDEX                    PIC S9(4)       VALUE ZERO.
   151     05  WS-ERCHKQ-LENGTH            PIC S9(4)       VALUE +100.
   152     05  WS-ERCMKQ-LENGTH            PIC S9(4)       VALUE +1800.
   153     05  WS-TS-LENGTH                PIC S9(4)       VALUE +1920.
   154
   155     05  WS-CHECK-QUE-COUNTER        PIC S9(8)       VALUE ZERO.
   156     05  WS-CHECK-COUNTER            PIC S9(4)       VALUE +10.
   157
   158     05  WS-JOURNAL-FILE-ID          PIC S9(4)       VALUE +1.
   159     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)       VALUE +773.
   160
   161 01  FILLER.
   162
   163     05  WS-MAPSET-NAME              PIC X(8)      VALUE 'EL686S'.
   164     05  WS-MAP-NAME                 PIC X(8)      VALUE 'EL686A'.
   165
   166     05  FILLER                      REDEFINES
   167         WS-MAP-NAME.
   168         20  FILLER                  PIC XX.
   169         20  WS-MAP-NUMBER           PIC X(6).
   170
   171     05  DEEDIT-FIELD                PIC X(15).
   172     05  DEEDIT-FIELD-V0  REDEFINES
   173         DEEDIT-FIELD                PIC S9(15).
   174
   175     05  QID.
   176         10  QID-TERM                PIC X(4)   VALUE SPACES.
   177         10  FILLER                  PIC X(4)   VALUE '125D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL686.cbl
   178
   179     05  TIME-IN                     PIC S9(7).
   180     05  TIME-OUT-R   REDEFINES TIME-IN.
   181         10  FILLER                  PIC X.
   182         10  TIME-OUT                PIC 99V99.
   183         10  FILLER                  PIC X(2).
   184
   185     05  WS-CHECK-NUMBER.
   186         10  FILLER                  PIC X           VALUE ZERO.
   187         10  WS-CHECK-NO             PIC X(6)        VALUE ZERO.
   188
   189     05  WS-CONTROL-FILE-KEY.
   190         10  WS-CFK-COMPANY-ID       PIC X(3)        VALUE SPACES.
   191         10  WS-CFK-RECORD-TYPE      PIC X           VALUE SPACES.
   192         10  FILLER                  PIC XX          VALUE SPACES.
   193         10  WS-CFK-BENEFIT-NO       PIC XX          VALUE SPACES.
   194         10  WS-CFK-SEQUENCE-NO      PIC S9(4)       VALUE ZERO
   195                                     COMP.
   196
   197     05  WS-PENDING-PAYMENTS-KEY.
   198         10  WS-PPK-COMPANY-CD       PIC X.
   199         10  WS-PPK-CARRIER          PIC X.
   200         10  WS-PPK-GROUPING         PIC X(6).
   201         10  WS-PPK-FIN-RESP         PIC X(10).
   202         10  WS-PPK-ACCOUNT          PIC X(10).
   203         10  WS-PPK-FILE-SEQ-NO      PIC S9(8)
   204                                     COMP.
   205         10  WS-PPK-RECORD-TYPE      PIC X.
   206
   207     05  WS-COMCK-MAINT-KEY.
   208         10  WS-CMK-COMPANY-CD       PIC X.
   209         10  WS-CMK-CARRIER          PIC X.
   210         10  WS-CMK-GROUPING         PIC X(6).
   211         10  WS-CMK-PAYEE            PIC X(10).
   212         10  WS-CMK-PAYEE-SEQ        PIC S9(4)      COMP.
   213         10  WS-CMK-SEQUENCE-NO      PIC S9(4)      COMP.
   214
   215     05  WS-CHECK-MAINT-KEY.
   216         10  WS-CHK-COMPANY-CD       PIC X.
   217         10  WS-CHK-CARRIER          PIC X.
   218         10  WS-CHK-GROUPING         PIC X(6).
   219         10  WS-CHK-STATE            PIC XX.
   220         10  WS-CHK-ACCOUNT          PIC X(10).
   221         10  WS-CHK-CERT-EFF-DT      PIC XX.
   222         10  WS-CHK-CERT-NO.
   223             15  WS-CHK-CERT-PRIME   PIC X(10).
   224             15  WS-CHK-CERT-SFX     PIC X.
   225         10  WS-CHK-SEQ-NO           PIC S9(4)
   226                                     COMP.
   227
   228     05  THIS-PGM                    PIC X(8) VALUE 'EL686'.
   229
   230     05  EL001                       PIC X(8) VALUE 'EL001'.
   231     05  EL004                       PIC X(8) VALUE 'EL004'.
   232     05  EL005                       PIC X(8) VALUE 'EL005'.
   233     05  EL010                       PIC X(8) VALUE 'EL010'.
   234     05  EL126                       PIC X(8) VALUE 'EL126'.
   235     05  ELDATCV                     PIC X(8) VALUE 'ELDATCV'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL686.cbl
   236
   237     05  WS-ERCHKQ-DSID              PIC X(8) VALUE 'ERCHKQ'.
   238     05  WS-ERCHEK-DSID              PIC X(8) VALUE 'ERCHEK'.
   239     05  WS-ERCMKQ-DSID              PIC X(8) VALUE 'ERCMKQ'.
   240     05  WS-ERCMCK-DSID              PIC X(8) VALUE 'ERCMCK'.
   241     05  WS-ERPYAJ-DSID              PIC X(8) VALUE 'ERPYAJ'.
   242     05  WS-ELCNTL-DSID              PIC X(8) VALUE 'ELCNTL'.
   243
   244     05  WS-JOURNAL-TYPE-ID          PIC XX          VALUE 'EL'.
   245
   246     05  WS-SPACES                   PIC X           VALUE SPACES.
   247
   248     05  WS-TRANS-ID                 PIC X(4)        VALUE 'EXG2'.
   249     05  WS-PRINT-TRANS-ID           PIC X(4)        VALUE 'EXG9'.
   250
   251     05  WS-ERROR-FLAG-AREA.
   252         10  ER-0002                 PIC 9(4)        VALUE 0002.
   253         10  ER-0004                 PIC 9(4)        VALUE 0004.
   254         10  ER-0008                 PIC 9(4)        VALUE 0008.
   255         10  ER-0029                 PIC 9(4)        VALUE 0029.
   256         10  ER-0070                 PIC 9(4)        VALUE 0070.
   257         10  ER-0078                 PIC 9(4)        VALUE 0078.
   258         10  ER-0330                 PIC 9(4)        VALUE 0330.
   259         10  ER-0331                 PIC 9(4)        VALUE 0331.
   260         10  ER-0348                 PIC 9(4)        VALUE 0348.
   261         10  ER-0568                 PIC 9(4)        VALUE 0568.
   262         10  ER-0766                 PIC 9(4)        VALUE 0766.
   263         10  ER-3048                 PIC 9(4)        VALUE 3048.
   264
   265     05  WS-TEXT-MESSAGE-LENGTH      PIC S9(4)       VALUE +70
   266                                     COMP SYNC.
   267
   268     05  WS-TEXT-MESSAGE             PIC X(70)       VALUE SPACES.
   269
   270     05  WS-TOTAL-LINE1.
   271         10  FILLER                  PIC X(14)       VALUE
   272             'CONTROL GROUP'.
   273         10  WS-TL1-CONTROL-GROUP    PIC 9(7)-.
   274         10  WS-TL1-RELEASE          PIC X(20)       VALUE
   275             ' RELEASED'.
   276
   277     05  WS-TOTAL-LINE2.
   278         10  WS-TL1-COUNT            PIC ZZ,ZZ9.
   279         10  FILLER                  PIC X(6)        VALUE
   280             ' CHECK'.
   281         10  WS-TL1-PLURAL           PIC X           VALUE
   282             'S'.
   283         10  FILLER                  PIC X(18)       VALUE
   284             ' IN THE AMOUNT OF'.
   285         10  WS-TL1-AMOUNT           PIC Z,ZZZ,ZZ9.99.
   286
   287     05  WS-TEMP-STORAGE-KEY.
   288         10  WS-TS-TERM-ID           PIC X(4).
   289         10  FILLER                  PIC X(4)        VALUE '685'.
   290
   291     05  WS-TEMP-STORAGE-ITEM        PIC S9(4)       VALUE ZERO
   292                                     COMP SYNC.
   293
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL686.cbl
   295*    COPY ELCINTF.
   296******************************************************************
   297*                                                                *
   298*                                                                *
   299*                            ELCINTF.                            *
   300*                            VMOD=2.017                          *
   301*                                                                *
   302*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   303*                                                                *
   304*       LENGTH = 1024                                            *
   305*                                                                *
   306******************************************************************
   307 01  PROGRAM-INTERFACE-BLOCK.
   308     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   309     12  PI-CALLING-PROGRAM              PIC X(8).
   310     12  PI-SAVED-PROGRAM-1              PIC X(8).
   311     12  PI-SAVED-PROGRAM-2              PIC X(8).
   312     12  PI-SAVED-PROGRAM-3              PIC X(8).
   313     12  PI-SAVED-PROGRAM-4              PIC X(8).
   314     12  PI-SAVED-PROGRAM-5              PIC X(8).
   315     12  PI-SAVED-PROGRAM-6              PIC X(8).
   316     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   317     12  PI-COMPANY-ID                   PIC XXX.
   318     12  PI-COMPANY-CD                   PIC X.
   319
   320     12  PI-COMPANY-PASSWORD             PIC X(8).
   321
   322     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   323
   324     12  PI-CONTROL-IN-PROGRESS.
   325         16  PI-CARRIER                  PIC X.
   326         16  PI-GROUPING                 PIC X(6).
   327         16  PI-STATE                    PIC XX.
   328         16  PI-ACCOUNT                  PIC X(10).
   329         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   330                                         PIC X(10).
   331         16  PI-CLAIM-CERT-GRP.
   332             20  PI-CLAIM-NO             PIC X(7).
   333             20  PI-CERT-NO.
   334                 25  PI-CERT-PRIME       PIC X(10).
   335                 25  PI-CERT-SFX         PIC X.
   336             20  PI-CERT-EFF-DT          PIC XX.
   337         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   338             20  PI-PLAN-CODE            PIC X(2).
   339             20  PI-REVISION-NUMBER      PIC X(3).
   340             20  PI-PLAN-EFF-DT          PIC X(2).
   341             20  PI-PLAN-EXP-DT          PIC X(2).
   342             20  FILLER                  PIC X(11).
   343         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   344             20  PI-OE-REFERENCE-1.
   345                 25  PI-OE-REF-1-PRIME   PIC X(18).
   346                 25  PI-OE-REF-1-SUFF    PIC XX.
   347
   348     12  PI-SESSION-IN-PROGRESS          PIC X.
   349         88  CLAIM-SESSION                   VALUE '1'.
   350         88  CREDIT-SESSION                  VALUE '2'.
   351         88  WARRANTY-SESSION                VALUE '3'.
   352         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL686.cbl
   353         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   354
   355
   356*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   357
   358     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   359     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   360
   361     12  PI-CREDIT-USER                  PIC X.
   362         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   363         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   364
   365     12  PI-CLAIM-USER                   PIC X.
   366         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   367         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   368
   369     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   370         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   371         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   372         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   373         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   374         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   375
   376     12  PI-PROCESSOR-ID                 PIC X(4).
   377
   378     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   379
   380     12  PI-MEMBER-CAPTION               PIC X(10).
   381
   382     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   383         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   384
   385     12  PI-LIFE-OVERRIDE-L1             PIC X.
   386     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   387     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   388     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   389
   390     12  PI-AH-OVERRIDE-L1               PIC X.
   391     12  PI-AH-OVERRIDE-L2               PIC XX.
   392     12  PI-AH-OVERRIDE-L6               PIC X(6).
   393     12  PI-AH-OVERRIDE-L12              PIC X(12).
   394
   395     12  PI-NEW-SYSTEM                   PIC X(2).
   396
   397     12  PI-PRIMARY-CERT-NO              PIC X(11).
   398     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   399         88  PI-USES-PAID-TO                 VALUE '1'.
   400     12  PI-CRDTCRD-SYSTEM.
   401         16  PI-CRDTCRD-USER             PIC X.
   402             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   403             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   404         16  PI-CC-MONTH-END-DT          PIC XX.
   405     12  PI-PROCESSOR-PRINTER            PIC X(4).
   406
   407     12  PI-OE-REFERENCE-2.
   408         16  PI-OE-REF-2-PRIME           PIC X(10).
   409         16  PI-OE-REF-2-SUFF            PIC X.
   410
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL686.cbl
   411     12  PI-REM-TRM-CALC-OPTION          PIC X.
   412
   413     12  PI-LANGUAGE-TYPE                PIC X.
   414             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   415             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   416             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   417
   418     12  PI-POLICY-LINKAGE-IND           PIC X.
   419         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   420         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   421                                                   LOW-VALUES.
   422
   423     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   424     12  PI-CLAIM-PW-SESSION             PIC X(1).
   425         88  PI-CLAIM-CREDIT                 VALUE '1'.
   426         88  PI-CLAIM-CONVEN                 VALUE '2'.
   427     12  FILLER                          PIC X(4).
   428
   429     12  PI-SYSTEM-LEVEL                 PIC X(145).
   430
   431     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   432         PI-SYSTEM-LEVEL.
   433
   434         16  PI-ENTRY-CODES.
   435             20  PI-ENTRY-CD-1           PIC X.
   436             20  PI-ENTRY-CD-2           PIC X.
   437
   438         16  PI-RETURN-CODES.
   439             20  PI-RETURN-CD-1          PIC X.
   440             20  PI-RETURN-CD-2          PIC X.
   441
   442         16  PI-UPDATE-STATUS-SAVE.
   443             20  PI-UPDATE-BY            PIC X(4).
   444             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   445
   446         16  PI-LOWER-CASE-LETTERS       PIC X.
   447             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   448
   449*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   450*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   451*            88  CARRIER-CLM-CNTL            VALUE '2'.
   452
   453         16  PI-CERT-ACCESS-CONTROL      PIC X.
   454             88  ST-ACCNT-CNTL               VALUE ' '.
   455             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   456             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   457             88  ACCNT-CNTL                  VALUE '3'.
   458             88  CARR-ACCNT-CNTL             VALUE '4'.
   459
   460         16  PI-PROCESSOR-CAP-LIST.
   461             20  PI-SYSTEM-CONTROLS.
   462                24 PI-SYSTEM-DISPLAY     PIC X.
   463                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   464                24 PI-SYSTEM-MODIFY      PIC X.
   465                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   466             20  FILLER                  PIC XX.
   467             20  PI-DISPLAY-CAP          PIC X.
   468                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL686.cbl
   469             20  PI-MODIFY-CAP           PIC X.
   470                 88  MODIFY-CAP              VALUE 'Y'.
   471             20  PI-MSG-AT-LOGON-CAP     PIC X.
   472                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   473             20  PI-FORCE-CAP            PIC X.
   474                 88  FORCE-CAP               VALUE 'Y'.
   475
   476         16  PI-PROGRAM-CONTROLS.
   477             20  PI-PGM-PRINT-OPT        PIC X.
   478             20  PI-PGM-FORMAT-OPT       PIC X.
   479             20  PI-PGM-PROCESS-OPT      PIC X.
   480             20  PI-PGM-TOTALS-OPT       PIC X.
   481
   482         16  PI-HELP-INTERFACE.
   483             20  PI-LAST-ERROR-NO        PIC X(4).
   484             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   485
   486         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   487             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   488
   489         16  PI-CR-CONTROL-IN-PROGRESS.
   490             20  PI-CR-CARRIER           PIC X.
   491             20  PI-CR-GROUPING          PIC X(6).
   492             20  PI-CR-STATE             PIC XX.
   493             20  PI-CR-ACCOUNT           PIC X(10).
   494             20  PI-CR-FIN-RESP          PIC X(10).
   495             20  PI-CR-TYPE              PIC X.
   496
   497         16  PI-CR-BATCH-NUMBER          PIC X(6).
   498
   499         16  PI-CR-MONTH-END-DT          PIC XX.
   500
   501         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   502             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   503             88  PI-ZERO-CARRIER             VALUE '1'.
   504             88  PI-ZERO-GROUPING            VALUE '2'.
   505             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   506
   507         16  PI-CARRIER-SECURITY         PIC X.
   508             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   509
   510         16  PI-ACCOUNT-SECURITY         PIC X(10).
   511             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   512             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   513
   514         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   515             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   516                                         INDEXED BY PI-ACCESS-NDX
   517                                         PIC X.
   518
   519         16  PI-GA-BILLING-CONTROL       PIC X.
   520             88  PI-GA-BILLING               VALUE '1'.
   521
   522         16  PI-MAIL-PROCESSING          PIC X.
   523             88  PI-MAIL-YES                 VALUE 'Y'.
   524
   525         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   526
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL686.cbl
   527         16  PI-AR-SYSTEM.
   528             20  PI-AR-PROCESSING-CNTL   PIC X.
   529                 88  PI-AR-PROCESSING        VALUE 'Y'.
   530             20  PI-AR-SUMMARY-CODE      PIC X(6).
   531             20  PI-AR-MONTH-END-DT      PIC XX.
   532
   533         16  PI-MP-SYSTEM.
   534             20  PI-MORTGAGE-USER            PIC X.
   535                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   536                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   537             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   538                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   539                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   540                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   541                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   542                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   543             20  PI-MP-MONTH-END-DT          PIC XX.
   544             20  PI-MP-REFERENCE-NO.
   545                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   546                 24  PI-MP-REFERENCE-SFX     PIC XX.
   547
   548         16  PI-LABEL-CONTROL            PIC X(01).
   549             88  PI-CREATE-LABELS                    VALUE 'Y'.
   550             88  PI-BYPASS-LABELS                    VALUE 'N'.
   551
   552         16  PI-BILL-GROUPING-CODE       PIC X(01).
   553             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   554
   555         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   556             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   557             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   558
   559         16  FILLER                      PIC X(14).
   560
   561     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   562******************************************************************
   563
   564     12  FILLER                      REDEFINES
   565         PI-PROGRAM-WORK-AREA.
   566             16  FILLER              PIC X.
   567             16  PI-CK-CONTROL-NO    PIC S9(8)      COMP.
   568             16  PI-CURRENT-DATE     PIC X(8).
   569             16  PI-CURRENT-DATE-BIN PIC XX.
   570             16  PI-PROC-SW          PIC S9.
   571                 88  PI-SCREEN-PROCESSED        VALUE +1.
   572             16  PI-CERT-SW          PIC S9.
   573                 88  PI-CERT-NOT-MATCHED        VALUE +0.
   574                 88  PI-CERT-MATCHED            VALUE +1.
   575             16  PI-CHECK-AMOUNT     PIC S9(7)  COMP-3.
   576             16  BIN-EFFDT           PIC XX   OCCURS 15.
   577             16  FILLER              PIC X(589).
   578
   579*    COPY EL686S.
   580 01  EL686AI.
   581     05  FILLER            PIC  X(0012).
   582*    -------------------------------
   583     05  ADATEL PIC S9(0004) COMP.
   584     05  ADATEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL686.cbl
   585     05  FILLER REDEFINES ADATEF.
   586         10  ADATEA PIC  X(0001).
   587     05  ADATEI PIC  X(0008).
   588*    -------------------------------
   589     05  ATIMEL PIC S9(0004) COMP.
   590     05  ATIMEF PIC  X(0001).
   591     05  FILLER REDEFINES ATIMEF.
   592         10  ATIMEA PIC  X(0001).
   593     05  ATIMEI PIC  X(0005).
   594*    -------------------------------
   595     05  AOPTIONL PIC S9(0004) COMP.
   596     05  AOPTIONF PIC  X(0001).
   597     05  FILLER REDEFINES AOPTIONF.
   598         10  AOPTIONA PIC  X(0001).
   599     05  AOPTIONI PIC  X(0001).
   600*    -------------------------------
   601     05  AAMTL PIC S9(0004) COMP.
   602     05  AAMTF PIC  X(0001).
   603     05  FILLER REDEFINES AAMTF.
   604         10  AAMTA PIC  X(0001).
   605     05  AAMTI PIC  9(7).
   606*    -------------------------------
   607     05  ABYL PIC S9(0004) COMP.
   608     05  ABYF PIC  X(0001).
   609     05  FILLER REDEFINES ABYF.
   610         10  ABYA PIC  X(0001).
   611     05  ABYI PIC  X(0004).
   612*    -------------------------------
   613     05  ACARRL PIC S9(0004) COMP.
   614     05  ACARRF PIC  X(0001).
   615     05  FILLER REDEFINES ACARRF.
   616         10  ACARRA PIC  X(0001).
   617     05  ACARRI PIC  X(0001).
   618*    -------------------------------
   619     05  AGROUPL PIC S9(0004) COMP.
   620     05  AGROUPF PIC  X(0001).
   621     05  FILLER REDEFINES AGROUPF.
   622         10  AGROUPA PIC  X(0001).
   623     05  AGROUPI PIC  X(0006).
   624*    -------------------------------
   625     05  ASTATL PIC S9(0004) COMP.
   626     05  ASTATF PIC  X(0001).
   627     05  FILLER REDEFINES ASTATF.
   628         10  ASTATA PIC  X(0001).
   629     05  ASTATI PIC  X(0002).
   630*    -------------------------------
   631     05  AACCTL PIC S9(0004) COMP.
   632     05  AACCTF PIC  X(0001).
   633     05  FILLER REDEFINES AACCTF.
   634         10  AACCTA PIC  X(0001).
   635     05  AACCTI PIC  X(0010).
   636*    -------------------------------
   637     05  CERTO01L PIC S9(0004) COMP.
   638     05  CERTO01F PIC  X(0001).
   639     05  FILLER REDEFINES CERTO01F.
   640         10  CERTO01A PIC  X(0001).
   641     05  CERTO01I PIC  X(0011).
   642*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL686.cbl
   643     05  EFFDT01L PIC S9(0004) COMP.
   644     05  EFFDT01F PIC  X(0001).
   645     05  FILLER REDEFINES EFFDT01F.
   646         10  EFFDT01A PIC  X(0001).
   647     05  EFFDT01I PIC  X(0008).
   648*    -------------------------------
   649     05  CERTO02L PIC S9(0004) COMP.
   650     05  CERTO02F PIC  X(0001).
   651     05  FILLER REDEFINES CERTO02F.
   652         10  CERTO02A PIC  X(0001).
   653     05  CERTO02I PIC  X(0011).
   654*    -------------------------------
   655     05  EFFDT02L PIC S9(0004) COMP.
   656     05  EFFDT02F PIC  X(0001).
   657     05  FILLER REDEFINES EFFDT02F.
   658         10  EFFDT02A PIC  X(0001).
   659     05  EFFDT02I PIC  X(0008).
   660*    -------------------------------
   661     05  CERTO03L PIC S9(0004) COMP.
   662     05  CERTO03F PIC  X(0001).
   663     05  FILLER REDEFINES CERTO03F.
   664         10  CERTO03A PIC  X(0001).
   665     05  CERTO03I PIC  X(0011).
   666*    -------------------------------
   667     05  EFFDT03L PIC S9(0004) COMP.
   668     05  EFFDT03F PIC  X(0001).
   669     05  FILLER REDEFINES EFFDT03F.
   670         10  EFFDT03A PIC  X(0001).
   671     05  EFFDT03I PIC  X(0008).
   672*    -------------------------------
   673     05  CERTO04L PIC S9(0004) COMP.
   674     05  CERTO04F PIC  X(0001).
   675     05  FILLER REDEFINES CERTO04F.
   676         10  CERTO04A PIC  X(0001).
   677     05  CERTO04I PIC  X(0011).
   678*    -------------------------------
   679     05  EFFDT04L PIC S9(0004) COMP.
   680     05  EFFDT04F PIC  X(0001).
   681     05  FILLER REDEFINES EFFDT04F.
   682         10  EFFDT04A PIC  X(0001).
   683     05  EFFDT04I PIC  X(0008).
   684*    -------------------------------
   685     05  CERTO05L PIC S9(0004) COMP.
   686     05  CERTO05F PIC  X(0001).
   687     05  FILLER REDEFINES CERTO05F.
   688         10  CERTO05A PIC  X(0001).
   689     05  CERTO05I PIC  X(0011).
   690*    -------------------------------
   691     05  EFFDT05L PIC S9(0004) COMP.
   692     05  EFFDT05F PIC  X(0001).
   693     05  FILLER REDEFINES EFFDT05F.
   694         10  EFFDT05A PIC  X(0001).
   695     05  EFFDT05I PIC  X(0008).
   696*    -------------------------------
   697     05  CERTO06L PIC S9(0004) COMP.
   698     05  CERTO06F PIC  X(0001).
   699     05  FILLER REDEFINES CERTO06F.
   700         10  CERTO06A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL686.cbl
   701     05  CERTO06I PIC  X(0011).
   702*    -------------------------------
   703     05  EFFDT06L PIC S9(0004) COMP.
   704     05  EFFDT06F PIC  X(0001).
   705     05  FILLER REDEFINES EFFDT06F.
   706         10  EFFDT06A PIC  X(0001).
   707     05  EFFDT06I PIC  X(0008).
   708*    -------------------------------
   709     05  CERTO07L PIC S9(0004) COMP.
   710     05  CERTO07F PIC  X(0001).
   711     05  FILLER REDEFINES CERTO07F.
   712         10  CERTO07A PIC  X(0001).
   713     05  CERTO07I PIC  X(0011).
   714*    -------------------------------
   715     05  EFFDT07L PIC S9(0004) COMP.
   716     05  EFFDT07F PIC  X(0001).
   717     05  FILLER REDEFINES EFFDT07F.
   718         10  EFFDT07A PIC  X(0001).
   719     05  EFFDT07I PIC  X(0008).
   720*    -------------------------------
   721     05  CERTO08L PIC S9(0004) COMP.
   722     05  CERTO08F PIC  X(0001).
   723     05  FILLER REDEFINES CERTO08F.
   724         10  CERTO08A PIC  X(0001).
   725     05  CERTO08I PIC  X(0011).
   726*    -------------------------------
   727     05  EFFDT08L PIC S9(0004) COMP.
   728     05  EFFDT08F PIC  X(0001).
   729     05  FILLER REDEFINES EFFDT08F.
   730         10  EFFDT08A PIC  X(0001).
   731     05  EFFDT08I PIC  X(0008).
   732*    -------------------------------
   733     05  CERTO09L PIC S9(0004) COMP.
   734     05  CERTO09F PIC  X(0001).
   735     05  FILLER REDEFINES CERTO09F.
   736         10  CERTO09A PIC  X(0001).
   737     05  CERTO09I PIC  X(0011).
   738*    -------------------------------
   739     05  EFFDT09L PIC S9(0004) COMP.
   740     05  EFFDT09F PIC  X(0001).
   741     05  FILLER REDEFINES EFFDT09F.
   742         10  EFFDT09A PIC  X(0001).
   743     05  EFFDT09I PIC  X(0008).
   744*    -------------------------------
   745     05  CERTO10L PIC S9(0004) COMP.
   746     05  CERTO10F PIC  X(0001).
   747     05  FILLER REDEFINES CERTO10F.
   748         10  CERTO10A PIC  X(0001).
   749     05  CERTO10I PIC  X(0011).
   750*    -------------------------------
   751     05  EFFDT10L PIC S9(0004) COMP.
   752     05  EFFDT10F PIC  X(0001).
   753     05  FILLER REDEFINES EFFDT10F.
   754         10  EFFDT10A PIC  X(0001).
   755     05  EFFDT10I PIC  X(0008).
   756*    -------------------------------
   757     05  CERTO11L PIC S9(0004) COMP.
   758     05  CERTO11F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL686.cbl
   759     05  FILLER REDEFINES CERTO11F.
   760         10  CERTO11A PIC  X(0001).
   761     05  CERTO11I PIC  X(0011).
   762*    -------------------------------
   763     05  EFFDT11L PIC S9(0004) COMP.
   764     05  EFFDT11F PIC  X(0001).
   765     05  FILLER REDEFINES EFFDT11F.
   766         10  EFFDT11A PIC  X(0001).
   767     05  EFFDT11I PIC  X(0008).
   768*    -------------------------------
   769     05  CERTO12L PIC S9(0004) COMP.
   770     05  CERTO12F PIC  X(0001).
   771     05  FILLER REDEFINES CERTO12F.
   772         10  CERTO12A PIC  X(0001).
   773     05  CERTO12I PIC  X(0011).
   774*    -------------------------------
   775     05  EFFDT12L PIC S9(0004) COMP.
   776     05  EFFDT12F PIC  X(0001).
   777     05  FILLER REDEFINES EFFDT12F.
   778         10  EFFDT12A PIC  X(0001).
   779     05  EFFDT12I PIC  X(0008).
   780*    -------------------------------
   781     05  CERTO13L PIC S9(0004) COMP.
   782     05  CERTO13F PIC  X(0001).
   783     05  FILLER REDEFINES CERTO13F.
   784         10  CERTO13A PIC  X(0001).
   785     05  CERTO13I PIC  X(0011).
   786*    -------------------------------
   787     05  EFFDT13L PIC S9(0004) COMP.
   788     05  EFFDT13F PIC  X(0001).
   789     05  FILLER REDEFINES EFFDT13F.
   790         10  EFFDT13A PIC  X(0001).
   791     05  EFFDT13I PIC  X(0008).
   792*    -------------------------------
   793     05  CERTO14L PIC S9(0004) COMP.
   794     05  CERTO14F PIC  X(0001).
   795     05  FILLER REDEFINES CERTO14F.
   796         10  CERTO14A PIC  X(0001).
   797     05  CERTO14I PIC  X(0011).
   798*    -------------------------------
   799     05  EFFDT14L PIC S9(0004) COMP.
   800     05  EFFDT14F PIC  X(0001).
   801     05  FILLER REDEFINES EFFDT14F.
   802         10  EFFDT14A PIC  X(0001).
   803     05  EFFDT14I PIC  X(0008).
   804*    -------------------------------
   805     05  CERTO15L PIC S9(0004) COMP.
   806     05  CERTO15F PIC  X(0001).
   807     05  FILLER REDEFINES CERTO15F.
   808         10  CERTO15A PIC  X(0001).
   809     05  CERTO15I PIC  X(0011).
   810*    -------------------------------
   811     05  EFFDT15L PIC S9(0004) COMP.
   812     05  EFFDT15F PIC  X(0001).
   813     05  FILLER REDEFINES EFFDT15F.
   814         10  EFFDT15A PIC  X(0001).
   815     05  EFFDT15I PIC  X(0008).
   816*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL686.cbl
   817     05  AEMSG1L PIC S9(0004) COMP.
   818     05  AEMSG1F PIC  X(0001).
   819     05  FILLER REDEFINES AEMSG1F.
   820         10  AEMSG1A PIC  X(0001).
   821     05  AEMSG1I PIC  X(0079).
   822*    -------------------------------
   823     05  AEMSG2L PIC S9(0004) COMP.
   824     05  AEMSG2F PIC  X(0001).
   825     05  FILLER REDEFINES AEMSG2F.
   826         10  AEMSG2A PIC  X(0001).
   827     05  AEMSG2I PIC  X(0079).
   828*    -------------------------------
   829     05  APFKL PIC S9(0004) COMP.
   830     05  APFKF PIC  X(0001).
   831     05  FILLER REDEFINES APFKF.
   832         10  APFKA PIC  X(0001).
   833     05  APFKI PIC  9(2).
   834*    -------------------------------
   835     05  ACOMPL PIC S9(0004) COMP.
   836     05  ACOMPF PIC  X(0001).
   837     05  FILLER REDEFINES ACOMPF.
   838         10  ACOMPA PIC  X(0001).
   839     05  ACOMPI PIC  X(0014).
   840*    -------------------------------
   841     05  APF1L PIC S9(0004) COMP.
   842     05  APF1F PIC  X(0001).
   843     05  FILLER REDEFINES APF1F.
   844         10  APF1A PIC  X(0001).
   845     05  APF1I PIC  X(0028).
   846 01  EL686AO REDEFINES EL686AI.
   847     05  FILLER            PIC  X(0012).
   848*    -------------------------------
   849     05  FILLER            PIC  X(0003).
   850     05  ADATEO PIC  X(0008).
   851*    -------------------------------
   852     05  FILLER            PIC  X(0003).
   853     05  ATIMEO PIC  99.99.
   854*    -------------------------------
   855     05  FILLER            PIC  X(0003).
   856     05  AOPTIONO PIC  X(0001).
   857*    -------------------------------
   858     05  FILLER            PIC  X(0003).
   859     05  AAMTO PIC  ZZZ,ZZ9.
   860*    -------------------------------
   861     05  FILLER            PIC  X(0003).
   862     05  ABYO PIC  X(0004).
   863*    -------------------------------
   864     05  FILLER            PIC  X(0003).
   865     05  ACARRO PIC  X(0001).
   866*    -------------------------------
   867     05  FILLER            PIC  X(0003).
   868     05  AGROUPO PIC  X(0006).
   869*    -------------------------------
   870     05  FILLER            PIC  X(0003).
   871     05  ASTATO PIC  X(0002).
   872*    -------------------------------
   873     05  FILLER            PIC  X(0003).
   874     05  AACCTO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL686.cbl
   875*    -------------------------------
   876     05  FILLER            PIC  X(0003).
   877     05  CERTO01O PIC  X(0011).
   878*    -------------------------------
   879     05  FILLER            PIC  X(0003).
   880     05  EFFDT01O PIC  X(0008).
   881*    -------------------------------
   882     05  FILLER            PIC  X(0003).
   883     05  CERTO02O PIC  X(0011).
   884*    -------------------------------
   885     05  FILLER            PIC  X(0003).
   886     05  EFFDT02O PIC  X(0008).
   887*    -------------------------------
   888     05  FILLER            PIC  X(0003).
   889     05  CERTO03O PIC  X(0011).
   890*    -------------------------------
   891     05  FILLER            PIC  X(0003).
   892     05  EFFDT03O PIC  X(0008).
   893*    -------------------------------
   894     05  FILLER            PIC  X(0003).
   895     05  CERTO04O PIC  X(0011).
   896*    -------------------------------
   897     05  FILLER            PIC  X(0003).
   898     05  EFFDT04O PIC  X(0008).
   899*    -------------------------------
   900     05  FILLER            PIC  X(0003).
   901     05  CERTO05O PIC  X(0011).
   902*    -------------------------------
   903     05  FILLER            PIC  X(0003).
   904     05  EFFDT05O PIC  X(0008).
   905*    -------------------------------
   906     05  FILLER            PIC  X(0003).
   907     05  CERTO06O PIC  X(0011).
   908*    -------------------------------
   909     05  FILLER            PIC  X(0003).
   910     05  EFFDT06O PIC  X(0008).
   911*    -------------------------------
   912     05  FILLER            PIC  X(0003).
   913     05  CERTO07O PIC  X(0011).
   914*    -------------------------------
   915     05  FILLER            PIC  X(0003).
   916     05  EFFDT07O PIC  X(0008).
   917*    -------------------------------
   918     05  FILLER            PIC  X(0003).
   919     05  CERTO08O PIC  X(0011).
   920*    -------------------------------
   921     05  FILLER            PIC  X(0003).
   922     05  EFFDT08O PIC  X(0008).
   923*    -------------------------------
   924     05  FILLER            PIC  X(0003).
   925     05  CERTO09O PIC  X(0011).
   926*    -------------------------------
   927     05  FILLER            PIC  X(0003).
   928     05  EFFDT09O PIC  X(0008).
   929*    -------------------------------
   930     05  FILLER            PIC  X(0003).
   931     05  CERTO10O PIC  X(0011).
   932*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL686.cbl
   933     05  FILLER            PIC  X(0003).
   934     05  EFFDT10O PIC  X(0008).
   935*    -------------------------------
   936     05  FILLER            PIC  X(0003).
   937     05  CERTO11O PIC  X(0011).
   938*    -------------------------------
   939     05  FILLER            PIC  X(0003).
   940     05  EFFDT11O PIC  X(0008).
   941*    -------------------------------
   942     05  FILLER            PIC  X(0003).
   943     05  CERTO12O PIC  X(0011).
   944*    -------------------------------
   945     05  FILLER            PIC  X(0003).
   946     05  EFFDT12O PIC  X(0008).
   947*    -------------------------------
   948     05  FILLER            PIC  X(0003).
   949     05  CERTO13O PIC  X(0011).
   950*    -------------------------------
   951     05  FILLER            PIC  X(0003).
   952     05  EFFDT13O PIC  X(0008).
   953*    -------------------------------
   954     05  FILLER            PIC  X(0003).
   955     05  CERTO14O PIC  X(0011).
   956*    -------------------------------
   957     05  FILLER            PIC  X(0003).
   958     05  EFFDT14O PIC  X(0008).
   959*    -------------------------------
   960     05  FILLER            PIC  X(0003).
   961     05  CERTO15O PIC  X(0011).
   962*    -------------------------------
   963     05  FILLER            PIC  X(0003).
   964     05  EFFDT15O PIC  X(0008).
   965*    -------------------------------
   966     05  FILLER            PIC  X(0003).
   967     05  AEMSG1O PIC  X(0079).
   968*    -------------------------------
   969     05  FILLER            PIC  X(0003).
   970     05  AEMSG2O PIC  X(0079).
   971*    -------------------------------
   972     05  FILLER            PIC  X(0003).
   973     05  APFKO PIC  99.
   974*    -------------------------------
   975     05  FILLER            PIC  X(0003).
   976     05  ACOMPO PIC  X(0014).
   977*    -------------------------------
   978     05  FILLER            PIC  X(0003).
   979     05  APF1O PIC  X(0028).
   980*    -------------------------------
   981
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL686.cbl
   983*    COPY ELCJPFX.
   984******************************************************************
   985*                                                                *
   986*                                                                *
   987*                            ELCJPFX.                            *
   988*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   989*                            VMOD=2.002                          *
   990*                                                                *
   991*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   992*                                                                *
   993*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   994*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   995*        ELCNTL - CONTROL FILE                                   *
   996*        ELMSTR - CLAIM MASTERS                                  *
   997*        ELTRLR - ACTIVITY TRAILERS                              *
   998*        ELCHKQ - CHECK QUE                                      *
   999******************************************************************
  1000 01  JOURNAL-RECORD.
  1001     12  JP-USER-ID                  PIC X(4).
  1002     12  JP-FILE-ID                  PIC X(8).
  1003     12  JP-PROGRAM-ID               PIC X(8).
  1004     12  JP-RECORD-TYPE              PIC X.
  1005         88 JP-ADD              VALUE 'A'.
  1006         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1007         88 JP-AFTER-CHANGE     VALUE 'C'.
  1008         88 JP-DELETE           VALUE 'D'.
  1009         88 JP-GENERIC-DELETE   VALUE 'G'.
  1010         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1011         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1012     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1013     12  JP-RECORD-AREA
  1014
  1015
  1016                PIC X(750).
  1017
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL686.cbl
  1019*    COPY ELCEMIB.
  1020******************************************************************
  1021*                                                                *
  1022*                                                                *
  1023*                            ELCEMIB.                            *
  1024*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1025*                            VMOD=2.005                          *
  1026*                                                                *
  1027*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1028*                                                                *
  1029******************************************************************
  1030 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1031     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1032     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1033     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1034     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1035     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1036     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1037     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1038     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1039     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1040         88  EMI-NO-ERRORS                    VALUE '1'.
  1041         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1042         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1043     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1044         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1045     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1046         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1047         88  EMI-AREA1-FULL                   VALUE '2'.
  1048     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1049         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1050         88  EMI-AREA2-FULL                   VALUE '2'.
  1051     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1052         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1053         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1054         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1055         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1056         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1057     12  EMI-ERROR-LINES.
  1058         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1059         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1060         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1061         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1062             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1063                 24  EMI-ERR-NUM         PIC X(4).
  1064                 24  EMI-FILLER          PIC X.
  1065                 24  EMI-SEV             PIC X.
  1066                 24  FILLER              PIC X.
  1067             20  FILLER                  PIC X(02).
  1068     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1069         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1070             20  EMI-ERROR-NUMBER    PIC X(4).
  1071             20  EMI-FILL            PIC X.
  1072             20  EMI-SEVERITY        PIC X.
  1073             20  FILLER              PIC X.
  1074             20  EMI-ERROR-TEXT.
  1075                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1076                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL686.cbl
  1077     12  EMI-SEVERITY-SAVE           PIC X.
  1078         88  EMI-NOTE                    VALUE 'N'.
  1079         88  EMI-WARNING                 VALUE 'W'.
  1080         88  EMI-FORCABLE                VALUE 'F'.
  1081         88  EMI-FATAL                   VALUE 'X'.
  1082     12  EMI-MESSAGE-FLAG            PIC X.
  1083         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1084         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1085     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1086     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1087         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1088         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1089         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1090     12  FILLER                      PIC X(137)  VALUE SPACES.
  1091     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1092     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1093     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1094     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1095
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL686.cbl
  1097*    COPY ELCDATE.
  1098******************************************************************
  1099*                                                                *
  1100*                                                                *
  1101*                            ELCDATE.                            *
  1102*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1103*                            VMOD=2.003
  1104*                                                                *
  1105*                                                                *
  1106*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1107*                 LENGTH = 200                                   *
  1108******************************************************************
  1109
  1110 01  DATE-CONVERSION-DATA.
  1111     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1112     12  DC-OPTION-CODE                PIC X.
  1113         88  BIN-TO-GREG                VALUE ' '.
  1114         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1115         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1116         88  YMD-GREG-TO-BIN            VALUE '3'.
  1117         88  MDY-GREG-TO-BIN            VALUE '4'.
  1118         88  JULIAN-TO-BIN              VALUE '5'.
  1119         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1120         88  FIND-CENTURY               VALUE '7'.
  1121         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1122         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1123         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1124         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1125         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1126         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1127         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1128         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1129         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1130         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1131         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1132         88  BIN-3-TO-GREG              VALUE 'I'.
  1133         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1134         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1135         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1136         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1137         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1138         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1139         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1140         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1141         88  THREE-CHARACTER-BIN
  1142                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1143         88  GREGORIAN-TO-BIN
  1144                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1145         88  BIN-TO-GREGORIAN
  1146                  VALUES ' ' '1' 'I' '8' 'G'.
  1147         88  JULIAN-TO-BINARY
  1148                  VALUES '5' 'C' 'E' 'F'.
  1149     12  DC-ERROR-CODE                 PIC X.
  1150         88  NO-CONVERSION-ERROR        VALUE ' '.
  1151         88  DATE-CONVERSION-ERROR
  1152                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1153         88  DATE-IS-ZERO               VALUE '1'.
  1154         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL686.cbl
  1155         88  DATE-IS-INVALID            VALUE '3'.
  1156         88  DATE1-GREATER-DATE2        VALUE '4'.
  1157         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1158         88  DATE-INVALID-OPTION        VALUE '9'.
  1159         88  INVALID-CENTURY            VALUE 'A'.
  1160         88  ONLY-CENTURY               VALUE 'B'.
  1161         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1162         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1163     12  DC-END-OF-MONTH               PIC X.
  1164         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1165     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1166         88  USE-NORMAL-PROCESS         VALUE ' '.
  1167         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1168         88  ADJUST-UP-100-YRS          VALUE '2'.
  1169     12  FILLER                        PIC X.
  1170     12  DC-CONVERSION-DATES.
  1171         16  DC-BIN-DATE-1             PIC XX.
  1172         16  DC-BIN-DATE-2             PIC XX.
  1173         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1174         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1175                       DC-GREG-DATE-1-EDIT.
  1176             20  DC-EDIT1-MONTH        PIC 99.
  1177             20  SLASH1-1              PIC X.
  1178             20  DC-EDIT1-DAY          PIC 99.
  1179             20  SLASH1-2              PIC X.
  1180             20  DC-EDIT1-YEAR         PIC 99.
  1181         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1182         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1183                     DC-GREG-DATE-2-EDIT.
  1184             20  DC-EDIT2-MONTH        PIC 99.
  1185             20  SLASH2-1              PIC X.
  1186             20  DC-EDIT2-DAY          PIC 99.
  1187             20  SLASH2-2              PIC X.
  1188             20  DC-EDIT2-YEAR         PIC 99.
  1189         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1190         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1191                     DC-GREG-DATE-1-YMD.
  1192             20  DC-YMD-YEAR           PIC 99.
  1193             20  DC-YMD-MONTH          PIC 99.
  1194             20  DC-YMD-DAY            PIC 99.
  1195         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1196         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1197                      DC-GREG-DATE-1-MDY.
  1198             20  DC-MDY-MONTH          PIC 99.
  1199             20  DC-MDY-DAY            PIC 99.
  1200             20  DC-MDY-YEAR           PIC 99.
  1201         16  DC-GREG-DATE-1-ALPHA.
  1202             20  DC-ALPHA-MONTH        PIC X(10).
  1203             20  DC-ALPHA-DAY          PIC 99.
  1204             20  FILLER                PIC XX.
  1205             20  DC-ALPHA-CENTURY.
  1206                 24 DC-ALPHA-CEN-N     PIC 99.
  1207             20  DC-ALPHA-YEAR         PIC 99.
  1208         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1209         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1210         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1211         16  DC-JULIAN-DATE            PIC 9(05).
  1212         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL686.cbl
  1213                                       PIC 9(05).
  1214         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1215             20  DC-JULIAN-YEAR        PIC 99.
  1216             20  DC-JULIAN-DAYS        PIC 999.
  1217         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1218         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1219         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1220     12  DATE-CONVERSION-VARIBLES.
  1221         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1222         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1223             20  FILLER                PIC 9(3).
  1224             20  HOLD-CEN-1-CCYY.
  1225                 24  HOLD-CEN-1-CC     PIC 99.
  1226                 24  HOLD-CEN-1-YY     PIC 99.
  1227             20  HOLD-CEN-1-MO         PIC 99.
  1228             20  HOLD-CEN-1-DA         PIC 99.
  1229         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1230             20  HOLD-CEN-1-R-MO       PIC 99.
  1231             20  HOLD-CEN-1-R-DA       PIC 99.
  1232             20  HOLD-CEN-1-R-CCYY.
  1233                 24  HOLD-CEN-1-R-CC   PIC 99.
  1234                 24  HOLD-CEN-1-R-YY   PIC 99.
  1235             20  FILLER                PIC 9(3).
  1236         16  HOLD-CENTURY-1-X.
  1237             20  FILLER                PIC X(3)  VALUE SPACES.
  1238             20  HOLD-CEN-1-X-CCYY.
  1239                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1240                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1241             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1242             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1243         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1244             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1245             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1246             20  HOLD-CEN-1-R-X-CCYY.
  1247                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1248                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1249             20  FILLER                PIC XXX.
  1250         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1251         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1252         16  DC-JULIAN-DATE-1          PIC 9(07).
  1253         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1254             20  DC-JULIAN-1-CCYY.
  1255                 24  DC-JULIAN-1-CC    PIC 99.
  1256                 24  DC-JULIAN-1-YR    PIC 99.
  1257             20  DC-JULIAN-DA-1        PIC 999.
  1258         16  DC-JULIAN-DATE-2          PIC 9(07).
  1259         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1260             20  DC-JULIAN-2-CCYY.
  1261                 24  DC-JULIAN-2-CC    PIC 99.
  1262                 24  DC-JULIAN-2-YR    PIC 99.
  1263             20  DC-JULIAN-DA-2        PIC 999.
  1264         16  DC-GREG-DATE-A-EDIT.
  1265             20  DC-EDITA-MONTH        PIC 99.
  1266             20  SLASHA-1              PIC X VALUE '/'.
  1267             20  DC-EDITA-DAY          PIC 99.
  1268             20  SLASHA-2              PIC X VALUE '/'.
  1269             20  DC-EDITA-CCYY.
  1270                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL686.cbl
  1271                 24  DC-EDITA-YEAR     PIC 99.
  1272         16  DC-GREG-DATE-B-EDIT.
  1273             20  DC-EDITB-MONTH        PIC 99.
  1274             20  SLASHB-1              PIC X VALUE '/'.
  1275             20  DC-EDITB-DAY          PIC 99.
  1276             20  SLASHB-2              PIC X VALUE '/'.
  1277             20  DC-EDITB-CCYY.
  1278                 24  DC-EDITB-CENT     PIC 99.
  1279                 24  DC-EDITB-YEAR     PIC 99.
  1280         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1281         16  DC-GREG-DATE-CYMD-R REDEFINES
  1282                              DC-GREG-DATE-CYMD.
  1283             20  DC-CYMD-CEN           PIC 99.
  1284             20  DC-CYMD-YEAR          PIC 99.
  1285             20  DC-CYMD-MONTH         PIC 99.
  1286             20  DC-CYMD-DAY           PIC 99.
  1287         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1288         16  DC-GREG-DATE-MDCY-R REDEFINES
  1289                              DC-GREG-DATE-MDCY.
  1290             20  DC-MDCY-MONTH         PIC 99.
  1291             20  DC-MDCY-DAY           PIC 99.
  1292             20  DC-MDCY-CEN           PIC 99.
  1293             20  DC-MDCY-YEAR          PIC 99.
  1294    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1295        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1296    12  DC-EL310-DATE                  PIC X(21).
  1297    12  FILLER                         PIC X(28).
  1298
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL686.cbl
  1300*    COPY ELCLOGOF.
  1301******************************************************************
  1302*                                                                *
  1303*                                                                *
  1304*                            ELCLOGOF.                           *
  1305*                            VMOD=2.001                          *
  1306*                                                                *
  1307*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1308*                                                                *
  1309******************************************************************
  1310 01  CLASIC-LOGOFF.
  1311     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1312     12  LOGOFF-TEXT.
  1313         16  FILLER          PIC X(5)    VALUE SPACES.
  1314         16  LOGOFF-MSG.
  1315             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1316             20  FILLER      PIC X       VALUE SPACES.
  1317             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1318         16  FILLER          PIC X(80)
  1319           VALUE '* YOU ARE NOW LOGGED OFF'.
  1320         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1321         16  FILLER          PIC X       VALUE QUOTE.
  1322         16  LOGOFF-SYS-MSG  PIC X(17)
  1323           VALUE 'S CLAS-IC SYSTEM '.
  1324     12  TEXT-MESSAGES.
  1325         16  UNACCESS-MSG    PIC X(29)
  1326             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1327         16  PGMIDERR-MSG    PIC X(17)
  1328             VALUE 'PROGRAM NOT FOUND'.
  1329
  1330*    COPY ELCATTR.
  1331******************************************************************
  1332*                                                                *
  1333*                            ELCATTR.                            *
  1334*                            VMOD=2.001                          *
  1335*                                                                *
  1336*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1337*                                                                *
  1338*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1339*                                                                *
  1340*                   POS 1   P=PROTECTED                          *
  1341*                           U=UNPROTECTED                        *
  1342*                           S=ASKIP                              *
  1343*                   POS 2   A=ALPHA/NUMERIC                      *
  1344*                           N=NUMERIC                            *
  1345*                   POS 3   N=NORMAL                             *
  1346*                           B=BRIGHT                             *
  1347*                           D=DARK                               *
  1348*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1349*                           OF=MODIFIED DATA TAG OFF             *
  1350*                                                                *
  1351*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1352******************************************************************
  1353 01  ATTRIBUTE-LIST.
  1354     12  AL-PABOF            PIC X       VALUE 'Y'.
  1355     12  AL-PABON            PIC X       VALUE 'Z'.
  1356     12  AL-PADOF            PIC X       VALUE '%'.
  1357     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL686.cbl
  1358     12  AL-PANOF            PIC X       VALUE '-'.
  1359     12  AL-PANON            PIC X       VALUE '/'.
  1360     12  AL-SABOF            PIC X       VALUE '8'.
  1361     12  AL-SABON            PIC X       VALUE '9'.
  1362     12  AL-SADOF            PIC X       VALUE '@'.
  1363     12  AL-SADON            PIC X       VALUE QUOTE.
  1364     12  AL-SANOF            PIC X       VALUE '0'.
  1365     12  AL-SANON            PIC X       VALUE '1'.
  1366     12  AL-UABOF            PIC X       VALUE 'H'.
  1367     12  AL-UABON            PIC X       VALUE 'I'.
  1368     12  AL-UADOF            PIC X       VALUE '<'.
  1369     12  AL-UADON            PIC X       VALUE '('.
  1370     12  AL-UANOF            PIC X       VALUE ' '.
  1371     12  AL-UANON            PIC X       VALUE 'A'.
  1372     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1373     12  AL-UNBON            PIC X       VALUE 'R'.
  1374     12  AL-UNDOF            PIC X       VALUE '*'.
  1375     12  AL-UNDON            PIC X       VALUE ')'.
  1376     12  AL-UNNOF            PIC X       VALUE '&'.
  1377     12  AL-UNNON            PIC X       VALUE 'J'.
  1378
  1379*    COPY ELCAID.
  1380******************************************************************
  1381*                                                                *
  1382*                            ELCAID.                             *
  1383*                            VMOD=2.001                          *
  1384*                                                                *
  1385*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1386*                                                                *
  1387*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1388*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1389******************************************************************
  1390
  1391 01  DFHAID.
  1392   02  DFHNULL   PIC  X  VALUE  ' '.
  1393   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1394   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1395   02  DFHPEN    PIC  X  VALUE  '='.
  1396   02  DFHOPID   PIC  X  VALUE  'W'.
  1397   02  DFHPA1    PIC  X  VALUE  '%'.
  1398   02  DFHPA2    PIC  X  VALUE  '>'.
  1399   02  DFHPA3    PIC  X  VALUE  ','.
  1400   02  DFHPF1    PIC  X  VALUE  '1'.
  1401   02  DFHPF2    PIC  X  VALUE  '2'.
  1402   02  DFHPF3    PIC  X  VALUE  '3'.
  1403   02  DFHPF4    PIC  X  VALUE  '4'.
  1404   02  DFHPF5    PIC  X  VALUE  '5'.
  1405   02  DFHPF6    PIC  X  VALUE  '6'.
  1406   02  DFHPF7    PIC  X  VALUE  '7'.
  1407   02  DFHPF8    PIC  X  VALUE  '8'.
  1408   02  DFHPF9    PIC  X  VALUE  '9'.
  1409   02  DFHPF10   PIC  X  VALUE  ':'.
  1410   02  DFHPF11   PIC  X  VALUE  '#'.
  1411   02  DFHPF12   PIC  X  VALUE  '@'.
  1412   02  DFHPF13   PIC  X  VALUE  'A'.
  1413   02  DFHPF14   PIC  X  VALUE  'B'.
  1414   02  DFHPF15   PIC  X  VALUE  'C'.
  1415   02  DFHPF16   PIC  X  VALUE  'D'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL686.cbl
  1416   02  DFHPF17   PIC  X  VALUE  'E'.
  1417   02  DFHPF18   PIC  X  VALUE  'F'.
  1418   02  DFHPF19   PIC  X  VALUE  'G'.
  1419   02  DFHPF20   PIC  X  VALUE  'H'.
  1420   02  DFHPF21   PIC  X  VALUE  'I'.
  1421*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1422   02  DFHPF22   PIC  X  VALUE  '['.
  1423   02  DFHPF23   PIC  X  VALUE  '.'.
  1424   02  DFHPF24   PIC  X  VALUE  '<'.
  1425   02  DFHMSRE   PIC  X  VALUE  'X'.
  1426   02  DFHSTRF   PIC  X  VALUE  'h'.
  1427   02  DFHTRIG   PIC  X  VALUE  '"'.
  1428
  1429 01  FILLER                      REDEFINES
  1430     DFHAID.
  1431
  1432     05  FILLER                      PIC X(8).
  1433
  1434     05  PF-VALUES                   PIC X
  1435         OCCURS 24 TIMES.
  1436
  1437****************************************************************
  1438*
  1439* Copyright (c) 2007 by Clerity Solutions, Inc.
  1440* All rights reserved.
  1441*
  1442****************************************************************
  1443 01  DFHEIV.
  1444   02  DFHEIV0               PIC X(35).
  1445   02  DFHEIV1               PIC X(08).
  1446   02  DFHEIV2               PIC X(08).
  1447   02  DFHEIV3               PIC X(08).
  1448   02  DFHEIV4               PIC X(06).
  1449   02  DFHEIV5               PIC X(04).
  1450   02  DFHEIV6               PIC X(04).
  1451   02  DFHEIV7               PIC X(02).
  1452   02  DFHEIV8               PIC X(02).
  1453   02  DFHEIV9               PIC X(01).
  1454   02  DFHEIV10              PIC S9(7) COMP-3.
  1455   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1456   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1457   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1458   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1459   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1460   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1461   02  DFHEIV17              PIC X(04).
  1462   02  DFHEIV18              PIC X(04).
  1463   02  DFHEIV19              PIC X(04).
  1464   02  DFHEIV20              USAGE IS POINTER.
  1465   02  DFHEIV21              USAGE IS POINTER.
  1466   02  DFHEIV22              USAGE IS POINTER.
  1467   02  DFHEIV23              USAGE IS POINTER.
  1468   02  DFHEIV24              USAGE IS POINTER.
  1469   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1470   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1471   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1472   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1473   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL686.cbl
  1474   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1475   02  FILLER                PIC X(02).
  1476   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1477   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1478   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1479   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1480   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1481 LINKAGE  SECTION.
  1482*****************************************************************
  1483*                                                               *
  1484* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1485* All rights reserved.                                          *
  1486*                                                               *
  1487*****************************************************************
  1488 01  dfheiblk.
  1489     02  eibtime          pic s9(7) comp-3.
  1490     02  eibdate          pic s9(7) comp-3.
  1491     02  eibtrnid         pic x(4).
  1492     02  eibtaskn         pic s9(7) comp-3.
  1493     02  eibtrmid         pic x(4).
  1494     02  dfheigdi         pic s9(4) comp.
  1495     02  eibcposn         pic s9(4) comp.
  1496     02  eibcalen         pic s9(4) comp.
  1497     02  eibaid           pic x(1).
  1498     02  eibfiller1       pic x(1).
  1499     02  eibfn            pic x(2).
  1500     02  eibfiller2       pic x(2).
  1501     02  eibrcode         pic x(6).
  1502     02  eibfiller3       pic x(2).
  1503     02  eibds            pic x(8).
  1504     02  eibreqid         pic x(8).
  1505     02  eibrsrce         pic x(8).
  1506     02  eibsync          pic x(1).
  1507     02  eibfree          pic x(1).
  1508     02  eibrecv          pic x(1).
  1509     02  eibsend          pic x(1).
  1510     02  eibatt           pic x(1).
  1511     02  eibeoc           pic x(1).
  1512     02  eibfmh           pic x(1).
  1513     02  eibcompl         pic x(1).
  1514     02  eibsig           pic x(1).
  1515     02  eibconf          pic x(1).
  1516     02  eiberr           pic x(1).
  1517     02  eibrldbk         pic x(1).
  1518     02  eiberrcd         pic x(4).
  1519     02  eibsynrb         pic x(1).
  1520     02  eibnodat         pic x(1).
  1521     02  eibfiller5       pic x(2).
  1522     02  eibresp          pic 9(09) comp.
  1523     02  eibresp2         pic 9(09) comp.
  1524     02  dfheigdj         pic s9(4) comp.
  1525     02  dfheigdk         pic s9(4) comp.
  1526
  1527 01  DFHCOMMAREA                     PIC X(1024).
  1528
  1529*01 PARMLIST                         COMP SYNC.
  1530*    05  FILLER                      PIC S9(9).
  1531*    05  ERCHKQ-POINTER              PIC S9(9).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL686.cbl
  1532*    05  ELCNTL-POINTER              PIC S9(9).
  1533*    05  ERPYAJ-POINTER              PIC S9(9).
  1534*    05  ERCHEK-POINTER              PIC S9(9).
  1535*    05  ERCMCK-POINTER              PIC S9(9).
  1536*    05  ERCMKQ-POINTER              PIC S9(9).
  1537
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL686.cbl
  1539*    COPY ERCCHKQ.
  1540******************************************************************
  1541*                                                                *
  1542*                                                                *
  1543*                            ERCCHKQ                             *
  1544*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1545*                            VMOD=2.005                          *
  1546*                                                                *
  1547*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  1548*                                                                *
  1549*   FILE TYPE = VSAM,KSDS                                        *
  1550*   RECORD SIZE = 100  RECFORM = FIXED                           *
  1551*                                                                *
  1552*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  1553*       ALTERNATE PATH  = NONE                                   *
  1554*                                                                *
  1555*   LOG = YES                                                    *
  1556*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1557******************************************************************
  1558 01  CHECK-QUE.
  1559     12  CQ-RECORD-ID                PIC XX.
  1560         88  VALID-CQ-ID                     VALUE 'CQ'.
  1561
  1562     12  CQ-CONTROL-PRIMARY.
  1563         16  CQ-COMPANY-CD           PIC X.
  1564         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  1565         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  1566
  1567     12  CQ-ENTRY-TYPE               PIC X.
  1568             88  CHECK-ON-QUE           VALUE 'Q'.
  1569             88  ALIGNMENT-CHECK        VALUE 'A'.
  1570             88  MANUAL-CHECK           VALUE 'M'.
  1571             88  SPOILED-CHECK          VALUE 'S'.
  1572             88  VOIDED-CHECK           VALUE 'V'.
  1573             88  PAYMENT-ABORTED        VALUE 'X'.
  1574
  1575     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  1576
  1577     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  1578         CQ-CREDIT-MASTER-CNTL.
  1579         16  CQ-PYAJ-CARRIER         PIC X.
  1580         16  CQ-PYAJ-GROUPING        PIC X(6).
  1581         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  1582         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  1583         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  1584         16  CQ-PYAJ-REC-TYPE        PIC X.
  1585         16  FILLER                  PIC X(18).
  1586
  1587     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  1588         CQ-CREDIT-MASTER-CNTL.
  1589         16  CQ-CHEK-CARRIER         PIC X.
  1590         16  CQ-CHEK-GROUPING        PIC X(6).
  1591         16  CQ-CHEK-STATE           PIC XX.
  1592         16  CQ-CHEK-ACCOUNT         PIC X(10).
  1593         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  1594         16  CQ-CHEK-CERT-NO.
  1595             20  CQ-CHEK-CERT-PRIME  PIC X(10).
  1596             20  CQ-CHEK-CERT-SFX    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL686.cbl
  1597         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  1598         16  CQ-CHEK-FIN-RESP        PIC X(10).
  1599         16  FILLER                  PIC X(06).
  1600
  1601     12  CQ-CHECK-NUMBER             PIC X(7).
  1602     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  1603     12  CQ-PAYMENT-TYPE             PIC X.
  1604             88  CQ-BILLING-CREDIT         VALUE '1'.
  1605             88  CQ-REFUND-PMT             VALUE '2'.
  1606             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  1607     12  CQ-VOID-INDICATOR           PIC X.
  1608             88  CHECK-IS-VOID             VALUE 'V'.
  1609     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  1610     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  1611     12  CQ-CHECK-BY-USER            PIC X(4).
  1612     12  CQ-PRE-NUMBERING-SW         PIC X.
  1613       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  1614       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  1615
  1616     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  1617     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  1618     12  CQ-ACCOUNT-AGENT            PIC X(10).
  1619     12  CQ-CHECK-VOIDED-DT          PIC XX.
  1620
  1621     12  CQ-LETTERS-IND              PIC X.
  1622         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  1623
  1624******************************************************************
  1625
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL686.cbl
  1627*    COPY ELCCNTL.
  1628******************************************************************
  1629*                                                                *
  1630*                                                                *
  1631*                            ELCCNTL.                            *
  1632*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1633*                            VMOD=2.059                          *
  1634*                                                                *
  1635*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1636*                                                                *
  1637*   FILE TYPE = VSAM,KSDS                                        *
  1638*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1639*                                                                *
  1640*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1641*       ALTERNATE INDEX = NONE                                   *
  1642*                                                                *
  1643*   LOG = YES                                                    *
  1644*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1645******************************************************************
  1646*                   C H A N G E   L O G
  1647*
  1648* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1649*-----------------------------------------------------------------
  1650*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1651* EFFECTIVE    NUMBER
  1652*-----------------------------------------------------------------
  1653* 082503                   PEMA  ADD BENEFIT GROUP
  1654* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1655* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1656* 092705    2005050300006  PEMA  ADD SPP LEASES
  1657* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1658* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1659* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1660* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1661* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1662******************************************************************
  1663*
  1664 01  CONTROL-FILE.
  1665     12  CF-RECORD-ID                       PIC XX.
  1666         88  VALID-CF-ID                        VALUE 'CF'.
  1667
  1668     12  CF-CONTROL-PRIMARY.
  1669         16  CF-COMPANY-ID                  PIC XXX.
  1670         16  CF-RECORD-TYPE                 PIC X.
  1671             88  CF-COMPANY-MASTER              VALUE '1'.
  1672             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1673             88  CF-STATE-MASTER                VALUE '3'.
  1674             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1675             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1676             88  CF-CARRIER-MASTER              VALUE '6'.
  1677             88  CF-MORTALITY-MASTER            VALUE '7'.
  1678             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1679             88  CF-TERMINAL-MASTER             VALUE '9'.
  1680             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1681             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1682             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1683             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1684             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL686.cbl
  1685             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1686             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1687             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1688             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1689         16  CF-ACCESS-CD-GENL              PIC X(4).
  1690         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1691             20  CF-PROCESSOR               PIC X(4).
  1692         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1693             20  CF-STATE-CODE              PIC XX.
  1694             20  FILLER                     PIC XX.
  1695         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1696             20  FILLER                     PIC XX.
  1697             20  CF-HI-BEN-IN-REC           PIC XX.
  1698         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1699             20  FILLER                     PIC XXX.
  1700             20  CF-CARRIER-CNTL            PIC X.
  1701         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1702             20  FILLER                     PIC XX.
  1703             20  CF-HI-TYPE-IN-REC          PIC 99.
  1704         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1705             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1706                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1707             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1708             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1709         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1710             20  FILLER                     PIC X.
  1711             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1712         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1713             20  FILLER                     PIC XX.
  1714             20  CF-MORTGAGE-PLAN           PIC XX.
  1715         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1716
  1717     12  CF-LAST-MAINT-DT                   PIC XX.
  1718     12  CF-LAST-MAINT-BY                   PIC X(4).
  1719     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1720
  1721     12  CF-RECORD-BODY                     PIC X(728).
  1722
  1723
  1724****************************************************************
  1725*             COMPANY MASTER RECORD                            *
  1726****************************************************************
  1727
  1728     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1729         16  CF-COMPANY-ADDRESS.
  1730             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1731             20  CF-CL-IN-CARE-OF           PIC X(30).
  1732             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1733             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1734             20  CF-CL-CITY-STATE           PIC X(30).
  1735             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1736             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1737         16  CF-COMPANY-CD                  PIC X.
  1738         16  CF-COMPANY-PASSWORD            PIC X(8).
  1739         16  CF-SECURITY-OPTION             PIC X.
  1740             88  ALL-SECURITY                   VALUE '1'.
  1741             88  COMPANY-VERIFY                 VALUE '2'.
  1742             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL686.cbl
  1743             88  NO-SECURITY                    VALUE '4'.
  1744             88  ALL-BUT-TERM                   VALUE '5'.
  1745         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1746             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1747         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1748             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1749         16  CF-INFORCE-LOCATION            PIC X.
  1750             88  CERTS-ARE-ONLINE               VALUE '1'.
  1751             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1752             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1753         16  CF-LOWER-CASE-LETTERS          PIC X.
  1754         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1755             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1756             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1757             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1758             88  CF-ACCNT-CNTL                  VALUE '3'.
  1759             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1760
  1761         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1762         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1763
  1764         16  CF-LGX-CREDIT-USER             PIC X.
  1765             88  CO-IS-NOT-USER                 VALUE 'N'.
  1766             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1767
  1768         16 CF-CREDIT-CALC-CODES.
  1769             20  CF-CR-REM-TERM-CALC PIC X.
  1770               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1771               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1772               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1773               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1774               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1775               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1776               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1777             20  CF-CR-R78-METHOD           PIC X.
  1778               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1779               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1780
  1781         16  CF-CLAIM-CONTROL-COUNTS.
  1782             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1783                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1784
  1785             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1786                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1787
  1788             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1789                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1790
  1791             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1792                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1793
  1794         16  CF-CURRENT-MONTH-END           PIC XX.
  1795
  1796         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1797             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1798             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1799             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1800             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL686.cbl
  1801                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1802                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1803             20  CF-CO-PREM-REJECT-SW       PIC X.
  1804                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1805                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1806             20  CF-CO-REF-REJECT-SW        PIC X.
  1807                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1808                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1809
  1810         16  CF-CO-REPORTING-DT             PIC XX.
  1811         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1812         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1813           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1814           88  CF-CO-MONTH-END                  VALUE '1'.
  1815
  1816         16  CF-LGX-CLAIM-USER              PIC X.
  1817             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1818             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1819
  1820         16  CF-CREDIT-EDIT-CONTROLS.
  1821             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1822             20  CF-MIN-AGE                 PIC 99.
  1823             20  CF-DEFAULT-AGE             PIC 99.
  1824             20  CF-MIN-TERM                PIC S999      COMP-3.
  1825             20  CF-MAX-TERM                PIC S999      COMP-3.
  1826             20  CF-DEFAULT-SEX             PIC X.
  1827             20  CF-JOINT-AGE-INPUT         PIC X.
  1828                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1829             20  CF-BIRTH-DATE-INPUT        PIC X.
  1830                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1831             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1832                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1833                 88  CF-ZERO-CARRIER            VALUE '1'.
  1834                 88  CF-ZERO-GROUPING           VALUE '2'.
  1835                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1836             20  CF-EDIT-SW                 PIC X.
  1837                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1838             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1839             20  CF-CR-PR-METHOD            PIC X.
  1840               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1841               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1842             20  FILLER                     PIC X.
  1843
  1844         16  CF-CREDIT-MISC-CONTROLS.
  1845             20  CF-REIN-TABLE-SW           PIC X.
  1846                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1847             20  CF-COMP-TABLE-SW           PIC X.
  1848                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1849             20  CF-EXPERIENCE-RETENTION-AGE
  1850                                            PIC S9        COMP-3.
  1851             20  CF-CONVERSION-DT           PIC XX.
  1852             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1853             20  CF-RUN-FREQUENCY-SW        PIC X.
  1854                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1855                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1856
  1857             20  CF-CR-CHECK-NO-CONTROL.
  1858                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL686.cbl
  1859                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1860                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1861                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1862                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1863                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1864
  1865                 24  CF-CR-CHECK-COUNT       REDEFINES
  1866                     CF-CR-CHECK-COUNTER      PIC X(4).
  1867
  1868                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1869                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1870
  1871                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1872                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1873                 24  CF-MAIL-PROCESSING       PIC X.
  1874                     88  MAIL-PROCESSING          VALUE 'Y'.
  1875
  1876         16  CF-MISC-SYSTEM-CONTROL.
  1877             20  CF-SYSTEM-C                 PIC X.
  1878                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1879             20  CF-SYSTEM-D                 PIC X.
  1880                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1881             20  CF-SOC-SEC-NO-SW            PIC X.
  1882                 88  SOC-SEC-NO-USED             VALUE '1'.
  1883             20  CF-MEMBER-NO-SW             PIC X.
  1884                 88  MEMBER-NO-USED              VALUE '1'.
  1885             20  CF-TAX-ID-NUMBER            PIC X(11).
  1886             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1887             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1888                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1889                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1890                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1891                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1892             20  CF-SYSTEM-E                 PIC X.
  1893                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1894
  1895         16  CF-LGX-LIFE-USER               PIC X.
  1896             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1897             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1898
  1899         16  CF-CR-MONTH-END-DT             PIC XX.
  1900
  1901         16  CF-FILE-MAINT-DATES.
  1902             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1903                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1904             20  CF-LAST-BATCH       REDEFINES
  1905                 CF-LAST-BATCH-NO               PIC X(4).
  1906             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1907             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1908             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1909             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1910             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1911             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1912             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1913             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1914             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1915             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1916
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL686.cbl
  1917         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1918         16  FILLER                         PIC X.
  1919
  1920         16  CF-ALT-MORT-CODE               PIC X(4).
  1921         16  CF-MEMBER-CAPTION              PIC X(10).
  1922
  1923         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1924             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1925             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1926             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1927             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1928             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1929
  1930         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1931
  1932         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1933         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1934         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1935         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1936
  1937         16  CF-AH-OVERRIDE-L1              PIC X.
  1938         16  CF-AH-OVERRIDE-L2              PIC XX.
  1939         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1940         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1941
  1942         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1943         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1944
  1945         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1946         16  CF-AR-LAST-EL860-DT            PIC XX.
  1947         16  CF-MP-MONTH-END-DT             PIC XX.
  1948
  1949         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1950         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1951             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1952
  1953         16  CF-AR-MONTH-END-DT             PIC XX.
  1954
  1955         16  CF-CRDTCRD-USER                PIC X.
  1956             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1957             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1958
  1959         16  CF-CC-MONTH-END-DT             PIC XX.
  1960
  1961         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1962
  1963         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1964             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1965             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1966             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1967         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1968         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1969         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1970         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1971             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1972             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1973         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1974         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL686.cbl
  1975         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1976             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1977         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1978
  1979         16  CF-CL-ZIP-CODE.
  1980             20  CF-CL-ZIP-PRIME.
  1981                 24  CF-CL-ZIP-1ST          PIC X.
  1982                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1983                 24  FILLER                 PIC X(4).
  1984             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1985         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1986             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1987             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1988             20  FILLER                     PIC XXX.
  1989
  1990         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1991         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1992         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1993         16  CF-CO-OPTION-START-DATE        PIC XX.
  1994         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1995           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1996                                                      '3' '4'.
  1997           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1998           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1999           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2000           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2001           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2002           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2003
  2004         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2005
  2006         16  CF-PAYMENT-APPROVAL-LEVELS.
  2007             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2008             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2009             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2010             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2011             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2012             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2013
  2014         16  CF-END-USER-REPORTING-USER     PIC X.
  2015             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2016             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2017
  2018         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2019             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2020             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2021
  2022         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2023
  2024         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2025         16  FILLER                         PIC X.
  2026
  2027         16  CF-CREDIT-ARCHIVE-CNTL.
  2028             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2029             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2030             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2031
  2032         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL686.cbl
  2033
  2034         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2035             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2036             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2037
  2038         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2039             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2040             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2041
  2042         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2043
  2044         16  CF-CO-ACH-ID-CODE              PIC  X.
  2045             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2046             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2047             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2048         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2049         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2050         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2051         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2052         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2053         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2054         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2055         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2056         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2057                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2058         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2059                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2060
  2061         16  CF-CO-OVER-SHORT.
  2062             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2063             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2064
  2065*         16  FILLER                         PIC X(102).
  2066         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2067             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2068             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2069
  2070         16  CF-AH-APPROVAL-DAYS.
  2071             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2072             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2073             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2074             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2075
  2076         16  FILLER                         PIC X(82).
  2077****************************************************************
  2078*             PROCESSOR/USER RECORD                            *
  2079****************************************************************
  2080
  2081     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2082         16  CF-PROCESSOR-NAME              PIC X(30).
  2083         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2084         16  CF-PROCESSOR-TITLE             PIC X(26).
  2085         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2086                 88  MESSAGE-YES                VALUE 'Y'.
  2087                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2088
  2089*****************************************************
  2090****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL686.cbl
  2091****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2092****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2093****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2094*****************************************************
  2095
  2096         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2097             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2098             20  CF-APPLICATION-FORCE       PIC X.
  2099             20  CF-INDIVIDUAL-APP.
  2100                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2101                     28  CF-BROWSE-APP      PIC X.
  2102                     28  CF-UPDATE-APP      PIC X.
  2103
  2104         16  CF-CURRENT-TERM-ON             PIC X(4).
  2105         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2106             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2107             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2108             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2109             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2110             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2111             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2112             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2113         16  CF-PROCESSOR-CARRIER           PIC X.
  2114             88  NO-CARRIER-SECURITY            VALUE ' '.
  2115         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2116             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2117         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2118             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2119         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2120             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2121
  2122         16  CF-PROC-SYS-ACCESS-SW.
  2123             20  CF-PROC-CREDIT-CLAIMS-SW.
  2124                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2125                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2126                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2127                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2128             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2129                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2130                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2131             20  CF-PROC-LIFE-GNRLDGR-SW.
  2132                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2133                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2134                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2135                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2136             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2137                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2138                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2139         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2140             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2141             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2142         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2143
  2144         16  CF-APPROVAL-LEVEL                  PIC X.
  2145             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2146             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2147             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2148             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL686.cbl
  2149
  2150         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2151
  2152         16  CF-LANGUAGE-TYPE                   PIC X.
  2153             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2154             88  CF-LANG-IS-FR                      VALUE 'F'.
  2155         16  FILLER                             PIC  X(240).
  2156
  2157****************************************************************
  2158*             PROCESSOR/REMINDERS RECORD                       *
  2159****************************************************************
  2160
  2161     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2162         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2163             20  CF-START-REMIND-DT         PIC XX.
  2164             20  CF-END-REMIND-DT           PIC XX.
  2165             20  CF-REMINDER-TEXT           PIC X(50).
  2166         16  FILLER                         PIC X(296).
  2167
  2168
  2169****************************************************************
  2170*             STATE MASTER RECORD                              *
  2171****************************************************************
  2172
  2173     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2174         16  CF-STATE-ABBREVIATION          PIC XX.
  2175         16  CF-STATE-NAME                  PIC X(25).
  2176         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2177         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2178             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2179             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2180             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2181             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2182                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2183                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2184             20  CF-ST-PREM-REJECT-SW       PIC X.
  2185                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2186                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2187             20  CF-ST-REF-REJECT-SW        PIC X.
  2188                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2189                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2190         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2191         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2192         16  CF-ST-REFUND-RULES.
  2193             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2194             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2195             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2196         16  CF-ST-FST-PMT-EXTENSION.
  2197             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2198             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2199                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2200                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2201                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2202                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2203         16  CF-ST-STATE-CALL.
  2204             20  CF-ST-CALL-UNEARNED        PIC X.
  2205             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2206             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL686.cbl
  2207         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2208             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2209             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2210         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2211         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2212         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2213         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2214         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2215         16  FILLER                         PIC X.
  2216         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2217             20  CF-ST-BENEFIT-CD           PIC XX.
  2218             20  CF-ST-BENEFIT-KIND         PIC X.
  2219                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2220                 88  CF-ST-AH-KIND              VALUE 'A'.
  2221             20  CF-ST-REM-TERM-CALC        PIC X.
  2222                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2223                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2224                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2225                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2226                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2227                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2228                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2229                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2230
  2231             20  CF-ST-REFUND-CALC          PIC X.
  2232                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2233                 88  ST-REFD-BY-R78             VALUE '1'.
  2234                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2235                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2236                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2237                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2238                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2239                 88  ST-REFD-UTAH               VALUE '7'.
  2240                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2241                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2242                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2243
  2244             20  CF-ST-EARNING-CALC         PIC X.
  2245                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2246                 88  ST-EARN-BY-R78             VALUE '1'.
  2247                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2248                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2249                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2250                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2251                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2252                 88  ST-EARN-MEAN               VALUE '8'.
  2253                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2254
  2255             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2256                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2257                 88  ST-OVRD-BY-R78             VALUE '1'.
  2258                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2259                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2260                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2261                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2262                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2263                 88  ST-OVRD-MEAN               VALUE '8'.
  2264                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL686.cbl
  2265             20  FILLER                     PIC X.
  2266
  2267         16  CF-ST-COMMISSION-CAPS.
  2268             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2269             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2270             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2271             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2272         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2273                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2274
  2275         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2276
  2277         16  CF-ST-STATUTORY-INTEREST.
  2278             20  CF-ST-STAT-DATE-FROM       PIC X.
  2279                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2280                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2281             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2282             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2283             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2284             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2285             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2286
  2287         16  CF-ST-OVER-SHORT.
  2288             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2289             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2290
  2291         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2292
  2293         16  CF-ST-RT-CALC                  PIC X.
  2294
  2295         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2296         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2297         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2298         16  CF-ST-RF-LR-CALC               PIC X.
  2299         16  CF-ST-RF-LL-CALC               PIC X.
  2300         16  CF-ST-RF-LN-CALC               PIC X.
  2301         16  CF-ST-RF-AH-CALC               PIC X.
  2302         16  CF-ST-RF-CP-CALC               PIC X.
  2303*        16  FILLER                         PIC X(206).
  2304*CIDMOD         16  FILLER                         PIC X(192).
  2305         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2306             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2307         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2308         16  CF-ST-VFY-2ND-BENE             PIC X.
  2309         16  FILLER                         PIC X(186).
  2310
  2311****************************************************************
  2312*             BENEFIT MASTER RECORD                            *
  2313****************************************************************
  2314
  2315     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2316         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2317             20  CF-BENEFIT-CODE            PIC XX.
  2318             20  CF-BENEFIT-NUMERIC  REDEFINES
  2319                 CF-BENEFIT-CODE            PIC XX.
  2320             20  CF-BENEFIT-ALPHA           PIC XXX.
  2321             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2322             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL686.cbl
  2323
  2324             20  CF-LF-COVERAGE-TYPE        PIC X.
  2325                 88  CF-REDUCING                VALUE 'R'.
  2326                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2327
  2328             20  CF-SPECIAL-CALC-CD         PIC X.
  2329                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2330                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2331                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2332                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2333                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2334                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2335                 88  CF-FARM-PLAN               VALUE 'F'.
  2336                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2337                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2338                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2339                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2340                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2341                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2342                 88  CF-PRUDENTIAL              VALUE 'P'.
  2343                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2344                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2345                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2346                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2347                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2348                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2349
  2350             20  CF-JOINT-INDICATOR         PIC X.
  2351                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2352
  2353*            20  FILLER                     PIC X(12).
  2354             20  FILLER                     PIC X(11).
  2355             20  CF-BENEFIT-CATEGORY        PIC X.
  2356             20  CF-LOAN-TYPE               PIC X(8).
  2357
  2358             20  CF-CO-REM-TERM-CALC        PIC X.
  2359                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2360                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2361                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2362                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2363                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2364
  2365             20  CF-CO-EARNINGS-CALC        PIC X.
  2366                 88  CO-EARN-BY-R78             VALUE '1'.
  2367                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2368                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2369                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2370                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2371                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2372                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2373                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2374
  2375             20  CF-CO-REFUND-CALC          PIC X.
  2376                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2377                 88  CO-REFD-BY-R78             VALUE '1'.
  2378                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2379                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2380                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL686.cbl
  2381                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2382                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2383                 88  CO-REFD-MEAN               VALUE '8'.
  2384                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2385                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2386                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2387
  2388             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2389                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2390                 88  CO-OVRD-BY-R78             VALUE '1'.
  2391                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2392                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2393                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2394                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2395                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2396                 88  CO-OVRD-MEAN               VALUE '8'.
  2397                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2398
  2399             20  CF-CO-BEN-I-G-CD           PIC X.
  2400                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2401                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2402                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2403
  2404         16  FILLER                         PIC X(304).
  2405
  2406
  2407****************************************************************
  2408*             CARRIER MASTER RECORD                            *
  2409****************************************************************
  2410
  2411     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2412         16  CF-ADDRESS-DATA.
  2413             20  CF-MAIL-TO-NAME            PIC X(30).
  2414             20  CF-IN-CARE-OF              PIC X(30).
  2415             20  CF-ADDRESS-LINE-1          PIC X(30).
  2416             20  CF-ADDRESS-LINE-2          PIC X(30).
  2417             20  CF-CITY-STATE              PIC X(30).
  2418             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2419             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2420
  2421         16  CF-CLAIM-NO-CONTROL.
  2422             20  CF-CLAIM-NO-METHOD         PIC X.
  2423                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2424                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2425                 88  CLAIM-NO-SEQ               VALUE '3'.
  2426                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2427             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2428                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2429                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2430                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2431
  2432         16  CF-CHECK-NO-CONTROL.
  2433             20  CF-CHECK-NO-METHOD         PIC X.
  2434                 88  CHECK-NO-MANUAL            VALUE '1'.
  2435                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2436                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2437                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2438             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL686.cbl
  2439                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2440
  2441         16  CF-DOMICILE-STATE              PIC XX.
  2442
  2443         16  CF-EXPENSE-CONTROLS.
  2444             20  CF-EXPENSE-METHOD          PIC X.
  2445                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2446                 88  DOLLARS-PER-PMT            VALUE '2'.
  2447                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2448                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2449             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2450             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2451
  2452         16  CF-CORRESPONDENCE-CONTROL.
  2453             20  CF-LETTER-RESEND-OPT       PIC X.
  2454                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2455                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2456             20  FILLER                     PIC X(4).
  2457
  2458         16  CF-RESERVE-CONTROLS.
  2459             20  CF-MANUAL-SW               PIC X.
  2460                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2461             20  CF-FUTURE-SW               PIC X.
  2462                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2463             20  CF-PTC-SW                  PIC X.
  2464                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2465             20  CF-IBNR-SW                 PIC X.
  2466                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2467             20  CF-PTC-LF-SW               PIC X.
  2468                 88  CF-LF-PTC-USED             VALUE '1'.
  2469             20  CF-CDT-ACCESS-METHOD       PIC X.
  2470                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2471                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2472                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2473             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2474
  2475         16  CF-CLAIM-CALC-METHOD           PIC X.
  2476             88  360-PLUS-MONTHS                VALUE '1'.
  2477             88  365-PLUS-MONTHS                VALUE '2'.
  2478             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2479             88  360-DAILY                      VALUE '4'.
  2480             88  365-DAILY                      VALUE '5'.
  2481
  2482         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2483         16  FILLER                         PIC X(11).
  2484
  2485         16  CF-LIMIT-AMOUNTS.
  2486             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2487             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2488             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2489             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2490             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2491             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2492             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2493             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2494             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2495             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2496
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL686.cbl
  2497         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2498         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2499         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2500
  2501         16  CF-ZIP-CODE.
  2502             20  CF-ZIP-PRIME.
  2503                 24  CF-ZIP-1ST             PIC X.
  2504                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2505                 24  FILLER                 PIC X(4).
  2506             20  CF-ZIP-PLUS4               PIC X(4).
  2507         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2508             20  CF-CAN-POSTAL-1            PIC XXX.
  2509             20  CF-CAN-POSTAL-2            PIC XXX.
  2510             20  FILLER                     PIC XXX.
  2511
  2512         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2513         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2514         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2515
  2516         16  CF-RATING-SWITCH               PIC X.
  2517             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2518             88  CF-NO-RATING                   VALUE 'N'.
  2519
  2520         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2521
  2522         16  CF-CARRIER-OVER-SHORT.
  2523             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2524             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2525
  2526         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2527         16  CF-SECPAY-SWITCH               PIC X.
  2528             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2529             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2530         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2531         16  FILLER                         PIC X(448).
  2532*        16  FILLER                         PIC X(452).
  2533
  2534
  2535****************************************************************
  2536*             MORTALITY MASTER RECORD                          *
  2537****************************************************************
  2538
  2539     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2540         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2541                                INDEXED BY CF-MORT-NDX.
  2542             20  CF-MORT-TABLE              PIC X(5).
  2543             20  CF-MORT-TABLE-TYPE         PIC X.
  2544                 88  CF-MORT-JOINT              VALUE 'J'.
  2545                 88  CF-MORT-SINGLE             VALUE 'S'.
  2546                 88  CF-MORT-COMBINED           VALUE 'C'.
  2547                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2548                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2549             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2550             20  CF-MORT-AGE-METHOD         PIC XX.
  2551                 88  CF-AGE-LAST                VALUE 'AL'.
  2552                 88  CF-AGE-NEAR                VALUE 'AN'.
  2553             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2554             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL686.cbl
  2555                                            PIC X.
  2556                 88  CF-MINUS                   VALUE '-'.
  2557                 88  CF-PLUS                    VALUE '+'.
  2558             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2559             20  CF-MORT-JOINT-CODE         PIC X.
  2560                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2561             20  CF-MORT-PC-Q               PIC X.
  2562                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2563             20  CF-MORT-TABLE-CODE         PIC X(4).
  2564             20  CF-MORT-COMMENTS           PIC X(15).
  2565             20  FILLER                     PIC X(14).
  2566
  2567         16  FILLER                         PIC X(251).
  2568
  2569
  2570****************************************************************
  2571*             BUSSINESS TYPE MASTER RECORD                     *
  2572****************************************************************
  2573
  2574     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2575* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2576* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2577* AND RECORD 05 IS TYPES 81-99
  2578         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2579             20  CF-BUSINESS-TITLE          PIC  X(19).
  2580             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2581                                            PIC S9V9(4) COMP-3.
  2582             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2583             20  FILLER                     PIC  X.
  2584         16  FILLER                         PIC  X(248).
  2585
  2586
  2587****************************************************************
  2588*             TERMINAL MASTER RECORD                           *
  2589****************************************************************
  2590
  2591     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2592
  2593         16  CF-COMPANY-TERMINALS.
  2594             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2595                                  PIC X(4).
  2596         16  FILLER               PIC X(248).
  2597
  2598
  2599****************************************************************
  2600*             LIFE EDIT MASTER RECORD                          *
  2601****************************************************************
  2602
  2603     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2604         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2605             20  CF-LIFE-CODE-IN            PIC XX.
  2606             20  CF-LIFE-CODE-OUT           PIC XX.
  2607         16  FILLER                         PIC X(248).
  2608
  2609
  2610****************************************************************
  2611*             AH EDIT MASTER RECORD                            *
  2612****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL686.cbl
  2613
  2614     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2615         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2616             20  CF-AH-CODE-IN              PIC XXX.
  2617             20  CF-AH-CODE-OUT             PIC XX.
  2618         16  FILLER                         PIC X(248).
  2619
  2620
  2621****************************************************************
  2622*             CREDIBILITY TABLES                               *
  2623****************************************************************
  2624
  2625     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2626         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2627                             INDEXED BY CF-CRDB-NDX.
  2628             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2629             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2630             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2631         16  FILLER                         PIC  X(332).
  2632
  2633
  2634****************************************************************
  2635*             REPORT CUSTOMIZATION RECORD                      *
  2636****************************************************************
  2637
  2638     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2639         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2640             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2641             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2642             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2643**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2644****       A T-TRANSFER.                                   ****
  2645             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2646
  2647         16  FILLER                         PIC XX.
  2648
  2649         16  CF-CARRIER-CNTL-OPT.
  2650             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2651                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2652                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2653             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2654                                            PIC X.
  2655         16  CF-GROUP-CNTL-OPT.
  2656             20  CF-GROUP-OPT-SEQ           PIC 9.
  2657                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2658                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2659             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2660                                            PIC X(6).
  2661         16  CF-STATE-CNTL-OPT.
  2662             20  CF-STATE-OPT-SEQ           PIC 9.
  2663                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2664                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2665             20  CF-STATE-SELECT OCCURS 3 TIMES
  2666                                            PIC XX.
  2667         16  CF-ACCOUNT-CNTL-OPT.
  2668             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2669                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2670                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL686.cbl
  2671             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2672                                            PIC X(10).
  2673         16  CF-BUS-TYP-CNTL-OPT.
  2674             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2675                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2676                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2677             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2678                                            PIC XX.
  2679         16  CF-LF-TYP-CNTL-OPT.
  2680             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2681                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2682                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2683             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2684                                            PIC XX.
  2685         16  CF-AH-TYP-CNTL-OPT.
  2686             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2687                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2688                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2689             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2690                                            PIC XX.
  2691         16  CF-REPTCD1-CNTL-OPT.
  2692             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2693                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2694                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2695             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2696                                            PIC X(10).
  2697         16  CF-REPTCD2-CNTL-OPT.
  2698             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2699                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2700                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2701             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2702                                            PIC X(10).
  2703         16  CF-USER1-CNTL-OPT.
  2704             20  CF-USER1-OPT-SEQ           PIC 9.
  2705                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2706                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2707             20  CF-USER1-SELECT OCCURS 3 TIMES
  2708                                            PIC X(10).
  2709         16  CF-USER2-CNTL-OPT.
  2710             20  CF-USER2-OPT-SEQ           PIC 9.
  2711                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2712                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2713             20  CF-USER2-SELECT OCCURS 3 TIMES
  2714                                            PIC X(10).
  2715         16  CF-USER3-CNTL-OPT.
  2716             20  CF-USER3-OPT-SEQ           PIC 9.
  2717                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2718                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2719             20  CF-USER3-SELECT OCCURS 3 TIMES
  2720                                            PIC X(10).
  2721         16  CF-USER4-CNTL-OPT.
  2722             20  CF-USER4-OPT-SEQ           PIC 9.
  2723                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2724                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2725             20  CF-USER4-SELECT OCCURS 3 TIMES
  2726                                            PIC X(10).
  2727         16  CF-USER5-CNTL-OPT.
  2728             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL686.cbl
  2729                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2730                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2731             20  CF-USER5-SELECT OCCURS 3 TIMES
  2732                                            PIC X(10).
  2733         16  CF-REINS-CNTL-OPT.
  2734             20  CF-REINS-OPT-SEQ           PIC 9.
  2735                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2736                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2737             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2738                 24  CF-REINS-PRIME         PIC XXX.
  2739                 24  CF-REINS-SUB           PIC XXX.
  2740
  2741         16  CF-AGENT-CNTL-OPT.
  2742             20  CF-AGENT-OPT-SEQ           PIC 9.
  2743                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2744                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2745             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2746                                            PIC X(10).
  2747
  2748         16  FILLER                         PIC X(43).
  2749
  2750         16  CF-LOSS-RATIO-SELECT.
  2751             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2752             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2753         16  CF-ENTRY-DATE-SELECT.
  2754             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2755             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2756         16  CF-EFFECTIVE-DATE-SELECT.
  2757             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2758             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2759
  2760         16  CF-EXCEPTION-LIST-IND          PIC X.
  2761             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2762
  2763         16  FILLER                         PIC X(318).
  2764
  2765****************************************************************
  2766*                  EXCEPTION REPORTING RECORD                  *
  2767****************************************************************
  2768
  2769     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2770         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2771             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2772
  2773         16  CF-COMBINED-LIFE-AH-OPT.
  2774             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2775             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2776             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2777             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2778
  2779         16  CF-LIFE-OPT.
  2780             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2781             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2782             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2783             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2784             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2785             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2786             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL686.cbl
  2787             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2788             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2789             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2790
  2791         16  CF-AH-OPT.
  2792             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2793             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2794             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2795             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2796             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2797             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2798             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2799             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2800             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2801             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2802
  2803         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2804             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2805             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2806             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2807
  2808         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2809
  2810         16  FILLER                         PIC X(673).
  2811
  2812
  2813****************************************************************
  2814*             MORTGAGE SYSTEM PLAN RECORD                      *
  2815****************************************************************
  2816
  2817     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2818         16  CF-PLAN-TYPE                   PIC X.
  2819             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2820             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2821             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2822         16  CF-PLAN-ABBREV                 PIC XXX.
  2823         16  CF-PLAN-DESCRIPT               PIC X(10).
  2824         16  CF-PLAN-NOTES                  PIC X(20).
  2825         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2826         16  CF-PLAN-UNDERWRITING.
  2827             20  CF-PLAN-TERM-DATA.
  2828                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2829                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2830             20  CF-PLAN-AGE-DATA.
  2831                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2832                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2833                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2834             20  CF-PLAN-BENEFIT-DATA.
  2835                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2836                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2837                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2838                                            PIC S9(7)V99  COMP-3.
  2839         16  CF-PLAN-POLICY-FORMS.
  2840             20  CF-POLICY-FORM             PIC X(12).
  2841             20  CF-MASTER-APPLICATION      PIC X(12).
  2842             20  CF-MASTER-POLICY           PIC X(12).
  2843         16  CF-PLAN-RATING.
  2844             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL686.cbl
  2845             20  CF-SEX-RATING              PIC X.
  2846                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2847                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2848             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2849             20  CF-SUB-STD-TYPE            PIC X.
  2850                 88  CF-PCT-OF-PREM            VALUE '1'.
  2851                 88  CF-PCT-OF-BENE            VALUE '2'.
  2852         16  CF-PLAN-PREM-TOLERANCES.
  2853             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2854             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2855         16  CF-PLAN-PYMT-TOLERANCES.
  2856             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2857             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2858         16  CF-PLAN-MISC-DATA.
  2859             20  FILLER                     PIC X.
  2860             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2861             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2862         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2863         16  CF-PLAN-IND-GRP                PIC X.
  2864             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2865                                                     '1'.
  2866             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2867                                                     '2'.
  2868         16  CF-MIB-SEARCH-SW               PIC X.
  2869             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2870             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2871             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2872             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2873         16  CF-ALPHA-SEARCH-SW             PIC X.
  2874             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2875             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2876             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2877             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2878             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2879             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2880             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2881             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2882             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2883             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2884                                                     'A' 'B' 'C'
  2885                                                     'X' 'Y' 'Z'.
  2886         16  CF-EFF-DT-RULE-SW              PIC X.
  2887             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2888             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2889             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2890             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2891             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2892         16  FILLER                         PIC X(4).
  2893         16  CF-HEALTH-QUESTIONS            PIC X.
  2894             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2895         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2896         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2897         16  CF-PLAN-SNGL-JNT               PIC X.
  2898             88  CF-COMBINED-PLAN              VALUE 'C'.
  2899             88  CF-JNT-PLAN                   VALUE 'J'.
  2900             88  CF-SNGL-PLAN                  VALUE 'S'.
  2901         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2902         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL686.cbl
  2903         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2904         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2905         16  CF-RERATE-CNTL                 PIC  X.
  2906             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2907             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2908             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2909             88  CF-AUTO-RECALC                 VALUE '4'.
  2910         16  CF-BENEFIT-TYPE                PIC  X.
  2911             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2912             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2913         16  CF-POLICY-FEE                  PIC S999V99
  2914                                                    COMP-3.
  2915         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2916         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2917         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2918         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2919         16  FILLER                         PIC  X(32).
  2920         16  CF-TERMINATION-FORM            PIC  X(04).
  2921         16  FILLER                         PIC  X(08).
  2922         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2923                                                       COMP-3.
  2924         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2925         16  CF-ISSUE-LETTER                PIC  X(4).
  2926         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2927         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2928             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2929             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2930         16  CF-MP-REFUND-CALC              PIC X.
  2931             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2932             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2933             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2934             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2935             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2936             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2937             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2938             88  CF-MP-REFD-MEAN                VALUE '8'.
  2939         16  CF-ALT-RATE-CODE               PIC  X(5).
  2940
  2941
  2942         16  FILLER                         PIC X(498).
  2943****************************************************************
  2944*             MORTGAGE COMPANY MASTER RECORD                   *
  2945****************************************************************
  2946
  2947     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2948         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2949         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2950             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2951             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2952             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2953             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2954             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2955
  2956         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2957         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2958         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2959         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2960         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL686.cbl
  2961
  2962         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2963             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2964         16  CF-MP-RECON-USE-IND            PIC X(1).
  2965             88  CF-MP-USE-RECON             VALUE 'Y'.
  2966         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2967             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2968         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2969             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2970             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2971         16  FILLER                         PIC X(1).
  2972         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2973             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2974         16  CF-MORTG-MIB-VERSION           PIC X.
  2975             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2976             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2977             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2978         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2979             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2980                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2981             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2982                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2983             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2984                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2985             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2986                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2987             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2988                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2989             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2990                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2991         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2992         16  FILLER                         PIC X(7).
  2993         16  CF-MORTG-DESTINATION-SYMBOL.
  2994             20  CF-MORTG-MIB-COMM          PIC X(5).
  2995             20  CF-MORTG-MIB-TERM          PIC X(5).
  2996         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2997             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2998         16  FILLER                         PIC X(03).
  2999         16  CF-MP-CHECK-NO-CONTROL.
  3000             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3001                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3002                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3003                                                ' ' LOW-VALUES.
  3004                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3005                                               VALUE '3'.
  3006         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3007         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3008         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3009             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3010                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3011             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3012                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3013             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3014                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3015             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3016                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3017             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3018                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL686.cbl
  3019             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3020                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3021         16  CF-MORTG-BILLING-AREA.
  3022             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3023                                            PIC X.
  3024         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3025         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3026         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3027         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3028             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3029             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3030         16  FILLER                         PIC X.
  3031         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3032             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3033             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3034         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3035         16  FILLER                         PIC X(8).
  3036         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3037         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3038         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3039         16  CF-ACH-COMPANY-ID.
  3040             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3041                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3042                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3043                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3044             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3045         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3046             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3047         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3048             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3049             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3050         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3051         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3052         16  FILLER                         PIC X(536).
  3053
  3054****************************************************************
  3055*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3056****************************************************************
  3057
  3058     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3059         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3060             20  CF-FEMALE-HEIGHT.
  3061                 24  CF-FEMALE-FT           PIC 99.
  3062                 24  CF-FEMALE-IN           PIC 99.
  3063             20  CF-FEMALE-MIN-WT           PIC 999.
  3064             20  CF-FEMALE-MAX-WT           PIC 999.
  3065         16  FILLER                         PIC X(428).
  3066
  3067     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3068         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3069             20  CF-MALE-HEIGHT.
  3070                 24  CF-MALE-FT             PIC 99.
  3071                 24  CF-MALE-IN             PIC 99.
  3072             20  CF-MALE-MIN-WT             PIC 999.
  3073             20  CF-MALE-MAX-WT             PIC 999.
  3074         16  FILLER                         PIC X(428).
  3075******************************************************************
  3076*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL686.cbl
  3077******************************************************************
  3078     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3079         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3080             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3081             20  CF-SYS-LETTER-ID           PIC X(04).
  3082             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3083             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3084             20  CF-SYS-RESET-SW            PIC X(01).
  3085             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3086             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3087
  3088         16  FILLER                         PIC X(50).
  3089
  3090         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3091             20  CF-USER-ACTIVE-SW          PIC X(01).
  3092             20  CF-USER-LETTER-ID          PIC X(04).
  3093             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3094             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3095             20  CF-USER-RESET-SW           PIC X(01).
  3096             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3097             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3098             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3099
  3100         16  FILLER                         PIC X(246).
  3101
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL686.cbl
  3103*    COPY ERCPYAJ.
  3104******************************************************************
  3105*                                                                *
  3106*                            ERCPYAJ                             *
  3107*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3108*                            VMOD=2.015                          *
  3109*                                                                *
  3110*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  3111*                                                                *
  3112*                                                                *
  3113*   FILE TYPE = VSAM,KSDS                                        *
  3114*   RECORD SIZE = 200  RECFORM = FIXED                           *
  3115*                                                                *
  3116*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  3117*       ALTERNATE PATHS = NONE                                   *
  3118*                                                                *
  3119*   LOG = YES                                                    *
  3120*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3121******************************************************************
  3122******************************************************************
  3123*                   C H A N G E   L O G
  3124*
  3125* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3126*-----------------------------------------------------------------
  3127*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3128* EFFECTIVE    NUMBER
  3129*-----------------------------------------------------------------
  3130* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  3131* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  3132******************************************************************
  3133
  3134 01  PENDING-PAY-ADJ.
  3135     12  PY-RECORD-ID                     PIC XX.
  3136         88  VALID-PY-ID                        VALUE 'PY'.
  3137
  3138     12  PY-CONTROL-PRIMARY.
  3139         16  PY-COMPANY-CD                PIC X.
  3140         16  PY-CARRIER                   PIC X.
  3141         16  PY-GROUPING                  PIC X(6).
  3142         16  PY-FIN-RESP                  PIC X(10).
  3143         16  PY-ACCOUNT                   PIC X(10).
  3144         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  3145                                          PIC X(10).
  3146         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  3147         16  PY-RECORD-TYPE               PIC X.
  3148             88  PY-REMIT-RECEIVED            VALUE 'R'.
  3149             88  PY-DEPOSIT                   VALUE 'D'.
  3150             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  3151             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  3152             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  3153             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  3154             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  3155             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  3156             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  3157             88  PY-FICA-ENTRY                VALUE 'F'.
  3158             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  3159             88  PY-POLICY-FEE                VALUE 'W'.
  3160             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL686.cbl
  3161
  3162     12  PY-PYMT-TYPE                     PIC X.
  3163             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  3164             88  PY-REINS-PYMT                VALUE 'R'.
  3165             88  PY-EXP-PYMT                  VALUE 'E'.
  3166
  3167     12  PY-BIL-INV                       PIC X(6).
  3168     12  PY-REF-NO                        PIC X(12).
  3169
  3170     12  PY-LAST-MAINT-DT                 PIC XX.
  3171     12  PY-LAST-MAINT-BY                 PIC X(4).
  3172     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3173
  3174     12  PY-PYADJ-RECORD.
  3175         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  3176         16  PY-ENTRY-COMMENT             PIC X(30).
  3177         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  3178             20  PY-GL-ACCOUNT            PIC X(10).
  3179             20  PY-GL-STATE              PIC X(02).
  3180             20  PY-GL-CANC-SW            PIC X(01).
  3181                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  3182                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  3183             20  PY-GL-COMMENT            PIC X(10).
  3184             20  FILLER      REDEFINES PY-GL-COMMENT.
  3185                 24  PY-GL-CHECK-NO       PIC 9(06).
  3186                 24  FILLER               PIC X(04).
  3187             20  FILLER                   PIC X(07).
  3188         16  PY-SAVE-ACCOUNT              PIC X(10).
  3189         16  PY-SAVE-TYPE                 PIC X(01).
  3190
  3191         16  PY-LETTERS.
  3192             20  PY-LETTER OCCURS 3 TIMES
  3193                           INDEXED BY PY-LET-NDX
  3194                                          PIC X(04).
  3195
  3196         16  PY-ERCOMP-TYPE               PIC X.
  3197             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  3198             88  PY-GA-TYPE                   VALUE 'G'.
  3199             88  PY-BANK-TYPE                 VALUE 'B'.
  3200         16  FILLER                       PIC X(05).
  3201
  3202     12  PY-RECORD-STATUS.
  3203         16  PY-CREDIT-SELECT-DT          PIC XX.
  3204         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  3205         16  PY-BILLED-DATE               PIC XX.
  3206         16  PY-REPORTED-DT               PIC XX.
  3207         16  PY-PMT-APPLIED               PIC X.
  3208             88  PY-ACCOUNT-PMT               VALUE 'A'.
  3209             88  PY-GA-PMT                    VALUE 'G'.
  3210             88  PY-OVWRITE-PMT               VALUE 'O'.
  3211             88  PY-NON-AR-PMT                VALUE 'N'.
  3212         16  FILLER                       PIC X(5).
  3213         16  PY-INPUT-DT                  PIC XX.
  3214         16  PY-CHECK-NUMBER              PIC X(6).
  3215         16  PY-VOID-SW                   PIC X.
  3216             88  PY-CHECK-VOIDED              VALUE 'V'.
  3217         16  PY-CHECK-ORIGIN-SW           PIC X.
  3218             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL686.cbl
  3219             88  PY-REFUND-CHECK              VALUE 'R'.
  3220             88  PY-GA-CHECK                  VALUE 'G'.
  3221             88  PY-CHECK-WRITTEN             VALUE 'W'.
  3222             88  PY-CHECK-REVERSAL            VALUE 'V'.
  3223         16  PY-CHECK-WRITTEN-DT          PIC XX.
  3224         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  3225         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  3226         16  PY-BILL-FLAG                 PIC X.
  3227             88  PY-BILLED                    VALUE 'B'.
  3228         16  PY-AR-FLAG                   PIC X.
  3229             88  PY-AR-CYCLE                  VALUE 'C'.
  3230             88  PY-AR-MONTH-END              VALUE 'M'.
  3231         16  PY-AR-DATE                   PIC XX.
  3232
  3233     12  PY-GL-CODES.
  3234         16  PY-GL-DB                     PIC X(14).
  3235         16  PY-GL-CR                     PIC X(14).
  3236         16  PY-GL-FLAG                   PIC X.
  3237         16  PY-GL-DATE                   PIC XX.
  3238
  3239     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  3240     12  FILLER                           PIC X(3).
  3241******************************************************************
  3242
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL686.cbl
  3244*    COPY ERCCHEK.
  3245******************************************************************
  3246*                                                                *
  3247*                                                                *
  3248*                            ERCCHEK                             *
  3249*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3250*                            VMOD=2.008                          *
  3251*                                                                *
  3252*   FILE DESCRIPTION = CHECK RECORDS                             *
  3253*                                                                *
  3254*   FILE TYPE = VSAM,KSDS                                        *
  3255*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3256*                                                                *
  3257*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3258*       ALTERNATE INDEX = NONE                                   *
  3259*                                                                *
  3260*   LOG = YES                                                    *
  3261*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3262******************************************************************
  3263 01  CHECK-RECORDS.
  3264     12  CH-RECORD-ID                      PIC XX.
  3265         88  VALID-CH-ID                      VALUE 'CH'.
  3266
  3267     12  CH-CONTROL-PRIMARY.
  3268         16  CH-COMPANY-CD                 PIC X.
  3269         16  CH-CARRIER                    PIC X.
  3270         16  CH-GROUPING                   PIC X(6).
  3271         16  CH-STATE                      PIC XX.
  3272         16  CH-ACCOUNT                    PIC X(10).
  3273         16  CH-CERT-EFF-DT                PIC XX.
  3274         16  CH-CERT-NO.
  3275             20  CH-CERT-PRIME             PIC X(10).
  3276             20  CH-CERT-SFX               PIC X.
  3277         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3278
  3279     12  CH-RECORDED-DT                    PIC XX.
  3280     12  CH-RECORDED-BY                    PIC X(4).
  3281     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3282
  3283     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3284     12  CH-CHECK-NO                       PIC X(7).
  3285     12  CH-REASON-FOR-CHECK               PIC X(25).
  3286     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3287     12  CH-OFFLINE-CHECK-IND              PIC X.
  3288         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  3289
  3290     12  CH-PAYEE-INFO.
  3291         16  CH-PAYEE-NAME-1               PIC X(30).
  3292         16  CH-PAYEE-NAME-2               PIC X(30).
  3293         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3294         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3295         16  CH-PAYEE-CITY-ST              PIC X(30).
  3296         16  CH-PAYEE-ZIP-CODE.
  3297             20  CH-PAYEE-ZIP.
  3298                 24  CH-ZIP-PRI-1ST        PIC X.
  3299                     88  CH-CANADIAN-POST-CODE
  3300                                           VALUES 'A' THRU 'Z'.
  3301                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL686.cbl
  3302             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3303         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3304             20  CH-CAN-POSTAL-1           PIC XXX.
  3305             20  CH-CAN-POSTAL-2           PIC XXX.
  3306             20  FILLER                    PIC XXX.
  3307
  3308     12  CH-CHECK-STUB-TEXT.
  3309         16  CH-STUB-LINE-1                PIC X(50).
  3310         16  CH-STUB-LINE-2                PIC X(50).
  3311         16  CH-STUB-LINE-3                PIC X(50).
  3312         16  FILLER.
  3313           18  CH-STUB-LINE-4              PIC X(20).
  3314           18  CH-LIENHOLDER-NAME          PIC X(30).
  3315
  3316     12  CH-COMPENSATION-CONTROL.
  3317         16  CH-COMP-CARRIER               PIC X.
  3318         16  CH-COMP-GROUPING              PIC X(6).
  3319         16  CH-COMP-FIN-RESP              PIC X(10).
  3320         16  CH-COMP-ACCOUNT               PIC X(10).
  3321
  3322     12  CH-CREDIT-SELECT-DT               PIC XX.
  3323     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3324     12  CH-PAYEE-CODE                     PIC X(6).
  3325
  3326     12  CH-VOID-DATA.
  3327         20  CH-VOID-DT                    PIC XX.
  3328         20  CH-VOID-BY                    PIC X(4).
  3329         20  CH-VOID-REASON                PIC X(25).
  3330
  3331     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3332             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3333     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3334
  3335     12  CH-CHECK-REFERENCE                PIC X(12).
  3336     12  CH-CHECK-ORIGIN-SW                PIC X.
  3337             88  CH-REFUND-CHECK              VALUE 'R'.
  3338             88  CH-MAINT-CHECK               VALUE 'M'.
  3339
  3340     12  CH-CANC-DT                        PIC XX.
  3341     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3342     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3343
  3344     12  CH-INSURED-NAME                   PIC X(28).
  3345
  3346     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  3347     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  3348
  3349     12  CH-LETTER-TABLE.
  3350         16  CH-LETTERS OCCURS 3 TIMES
  3351                        INDEXED BY CH-LT-NDX
  3352                                           PIC X(04).
  3353
  3354     12  FILLER                            PIC X(07).
  3355
  3356
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL686.cbl
  3358*    COPY ERCCMCK.
  3359******************************************************************
  3360*                                                                *
  3361*                                                                *
  3362*                            ERCCMCK                             *
  3363*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3364*                            VMOD=2.012                          *
  3365*                                                                *
  3366*   FILE DESCRIPTION = COMMISSION CHECK RECORDS                  *
  3367*                                                                *
  3368*   FILE TYPE = VSAM,KSDS                                        *
  3369*   RECORD SIZE = 2000   RECFORM = FIXED                         *
  3370*                                                                *
  3371*   BASE CLUSTER NAME = ERCMCK             RKP=2,LEN=26          *
  3372*       ALTERNATE INDEX = NONE                                   *
  3373*                                                                *
  3374*   LOG = NO                                                     *
  3375*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3376******************************************************************
  3377 01  COMM-CHECK-RECORDS.
  3378     12  CK-RECORD-ID                      PIC XX.
  3379         88  VALID-CK-ID                      VALUE 'CK'.
  3380
  3381     12  CK-CONTROL-PRIMARY.
  3382         16  CK-COMPANY-CD                 PIC X.
  3383         16  CK-CSR                        PIC X(4).
  3384         16  CK-CARRIER                    PIC X.
  3385         16  CK-GROUPING                   PIC X(6).
  3386         16  CK-PAYEE                      PIC X(10).
  3387         16  CK-PAYEE-SEQ                  PIC S9(4)     COMP.
  3388         16  CK-SEQUENCE-NO                PIC S9(4)     COMP.
  3389
  3390     12  CK-RECORDED-DT                    PIC XX.
  3391     12  CK-RECORDED-BY                    PIC X(4).
  3392     12  CK-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3393
  3394     12  CK-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3395     12  CK-RECORD-TYPE                    PIC X.
  3396         88  CK-DETAIL                        VALUE 'D'.
  3397         88  CK-TEXT                          VALUE 'T'.
  3398     12  CK-CHECK-NO                       PIC X(6).
  3399     12  CK-CHECK-WRITTEN-DT               PIC XX.
  3400     12  CK-PAYEE-INFO.
  3401         16  CK-PAYEE-NAME                 PIC X(30).
  3402         16  CK-PAYEE-ADDRESS-1            PIC X(30).
  3403         16  CK-PAYEE-ADDRESS-2            PIC X(30).
  3404         16  CK-PAYEE-CITY-ST              PIC X(30).
  3405         16  CK-PAYEE-ZIP-CODE.
  3406             20  CK-PAYEE-ZIP              PIC X(5).
  3407             20  CK-PAYEE-ZIP-EXT          PIC X(4).
  3408
  3409     12  CK-CHECK-STUB-DATA.
  3410         16  CK-CHECK-STUB-INFO  OCCURS  15  TIMES.
  3411             20  CK-STUB-LINE.
  3412                 24  CK-STUB-COMMENT       PIC X(23).
  3413                 24  CK-ACCT-AGENT         PIC X(10).
  3414                 24  CK-INVOICE            PIC X(6).
  3415                 24  CK-REFERENCE          PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL686.cbl
  3416                 24  CK-LEDGER-NO          PIC X(14).
  3417                 24  CK-DETAIL-AMT         PIC S9(7)V99 COMP-3.
  3418                 24  CK-LAST-MAINT-APPLIED PIC X.
  3419                 24  CK-NON-AR-ITEM        PIC X.
  3420                 24  FILLER                PIC X(19).
  3421
  3422             20  CK-CHECK-WORK-CONTROL.
  3423                  24  CK-CKWK-CSR          PIC X(4).
  3424                  24  CK-CKWK-CARRIER      PIC X.
  3425                  24  CK-CKWK-GROUPING     PIC X(6).
  3426                  24  CK-CKWK-PAYEE        PIC X(10).
  3427                  24  CK-CKWK-PAYEE-SEQ    PIC S9(4) COMP.
  3428                  24  CK-CKWK-SEQ-NO       PIC S9(4) COMP.
  3429             20  CK-PAYMENT-TYPE           PIC X.
  3430             20  CK-PYAJ-PMT-APPLIED       PIC X.
  3431
  3432     12  CK-CHECK-STUB-TEXT  REDEFINES CK-CHECK-STUB-DATA.
  3433         16  CK-CHECK-TEXT-ITEMS OCCURS 3 TIMES.
  3434             20  CK-STUB-TEXT              PIC X(70).
  3435         16  CK-STUB-FILL-AREA             PIC X(1560).
  3436
  3437     12  CK-CHECK-QUE-CONTROL.
  3438         20  CK-QUE-CONTROL-NUMBER         PIC S9(8) COMP.
  3439         20  CK-QUE-SEQ-NO                 PIC S9(4) COMP.
  3440
  3441     12  CK-CREDIT-SELECT-DT               PIC XX.
  3442     12  CK-CREDIT-ACCEPT-DT               PIC XX.
  3443
  3444     12  CK-VOID-DATA.
  3445         20  CK-VOID-DT                    PIC XX.
  3446         20  CK-VOID-REASON                PIC X(25).
  3447
  3448     12  CK-AR-STATEMENT-DT                PIC XX.
  3449     12  CK-PMT-APPLIED                    PIC X.
  3450     12  CK-ACH-PAYMENT                    PIC X.
  3451          88 PAID-BY-ACH                   VALUE 'P'.
  3452          88 NOT-PAID-BY-ACH               VALUE 'N'.
  3453     12  FILLER                            PIC X(08).
  3454
  3455
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL686.cbl
  3457*    COPY ERCCMKQ.
  3458******************************************************************
  3459*                                                                *
  3460*                                                                *
  3461*                            ERCCMKQ                             *
  3462*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3463*                            VMOD=2.014                          *
  3464*                                                                *
  3465*   FILE DESCRIPTION = CHECK QUE FILE FOR THE COMMISSION         *
  3466*                      CHECK OF THE CREDIT SYSTEM                *
  3467*                                                                *
  3468*   FILE TYPE = VSAM,KSDS                                        *
  3469*   RECORD SIZE = 1800 RECFORM = FIXED                           *
  3470*                                                                *
  3471*   BASE CLUSTER = ERCMKQ                         RKP=2,LEN=7    *
  3472*       ALTERNATE PATH  = ERCMKQ2  (BY PAYEE CONTRO AND          *
  3473*                                      CONTROL NUMBER)           *
  3474*                                                 RKP=9,LEN=30   *
  3475*                                                                *
  3476*   LOG = NO                                                     *
  3477*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3478******************************************************************
  3479 01  COMMISSION-CHECK-QUE.
  3480     12  MQ-RECORD-ID                PIC XX.
  3481         88  VALID-MQ-ID                     VALUE 'MQ'.
  3482
  3483     12  MQ-CONTROL-PRIMARY.
  3484         16  MQ-COMPANY-CD           PIC X.
  3485         16  MQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  3486         16  MQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  3487
  3488     12  MQ-CONTROL-BY-PAYEE.
  3489         16  MQ-COMPANY-CD-A1        PIC X.
  3490         16  MQ-CSR-A1               PIC X(4).
  3491         16  MQ-CARRIER-A1           PIC X.
  3492         16  MQ-GROUPING-A1          PIC X(6).
  3493         16  MQ-PAYEE-A1             PIC X(10).
  3494         16  MQ-PAYEE-SEQ-A1         PIC S9(4)       COMP.
  3495         16  MQ-CONTROL-NUMBER-A1    PIC S9(8)       COMP.
  3496         16  MQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  3497
  3498     12  MQ-ENTRY-TYPE               PIC X.
  3499             88  CHECK-ON-QUE           VALUE 'Q'.
  3500             88  ALIGNMENT-CHECK        VALUE 'A'.
  3501             88  SPOILED-CHECK          VALUE 'S'.
  3502             88  PAYMENT-ABORTED        VALUE 'X'.
  3503             88  ACH-PAYMENT            VALUE 'P'.
  3504
  3505     12  FILLER                      PIC X(10).
  3506
  3507     12  MQ-CREDIT-CHEK-CNTL.
  3508         16  MQ-CHEK-CSR             PIC X(4).
  3509         16  MQ-CHEK-CARRIER         PIC X.
  3510         16  MQ-CHEK-GROUPING        PIC X(6).
  3511         16  MQ-CHEK-PAYEE           PIC X(10).
  3512         16  MQ-CHEK-PAYEE-SEQ       PIC S9(4)       COMP.
  3513         16  MQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  3514
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL686.cbl
  3515     12  FILLER                      PIC X(10).
  3516
  3517     12  MQ-PAYEE-INFO.
  3518         16  MQ-PAYEE-NAME           PIC X(30).
  3519         16  MQ-PAYEE-ADDRESS-1      PIC X(30).
  3520         16  MQ-PAYEE-ADDRESS-2      PIC X(30).
  3521         16  MQ-PAYEE-CITY-ST        PIC X(30).
  3522         16  MQ-PAYEE-ZIP-CODE.
  3523             20  MQ-PAYEE-ZIP.
  3524                 24  FILLER          PIC X(1).
  3525                     88 MQ-PAYEE-CANADIAN-POST-CODE
  3526                                     VALUE 'A' THRU 'Z'.
  3527                 24  FILLER          PIC X(4).
  3528             20  MQ-PAYEE-ZIP-EXT    PIC X(4).
  3529         16  MQ-PAYEE-CANADIAN-POSTAL-CODES
  3530                 REDEFINES MQ-PAYEE-ZIP-CODE.
  3531             20  MQ-PAY-CAN-POSTAL-CD-1
  3532                                     PIC X(3).
  3533             20  MQ-PAY-CAN-POSTAL-CD-2
  3534                                     PIC X(3).
  3535             20  FILLER              PIC X(3).
  3536
  3537     12  MQ-CREDIT-PYAJ-CNTL.
  3538         16  MQ-PYAJ-CARRIER         PIC X.
  3539         16  MQ-PYAJ-GROUPING        PIC X(6).
  3540         16  MQ-PYAJ-FIN-RESP        PIC X(10).
  3541         16  FILLER                  PIC X(6).
  3542
  3543     12  MQ-CHECK-NUMBER             PIC X(6).
  3544     12  MQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  3545     12  MQ-NUMBER-OF-CK-STUBS       PIC S9(3)       COMP-3.
  3546     12  MQ-VOID-DT                  PIC XX.
  3547     12  MQ-TIMES-PRINTED            PIC S9(4)       COMP.
  3548     12  MQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  3549     12  MQ-CHECK-BY-USER            PIC X(4).
  3550     12  MQ-PRE-NUMBERING-SW         PIC X.
  3551       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  3552       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  3553
  3554     12  MQ-CHECK-WRITTEN-DT         PIC XX.
  3555     12  MQ-ACH-WRITTEN-DT REDEFINES  MQ-CHECK-WRITTEN-DT
  3556                                     PIC XX.
  3557     12  MQ-LAST-MAINT-BY            PIC X(4).
  3558     12  MQ-LAST-MAINT-HHMMSS        PIC S9(6)       COMP-3.
  3559     12  MQ-LAST-MAINT-DT            PIC XX.
  3560     12  MQ-CHECK-RELEASE-DT         PIC XX.
  3561     12  MQ-RECORD-TYPE              PIC X.
  3562         88  MQ-DETAIL                     VALUE 'D'.
  3563         88  MQ-TEXT                       VALUE 'T'.
  3564
  3565     12  MQ-DETAIL-INFORMATION.
  3566         16  MQ-DETAIL-INFO        OCCURS 15 TIMES.
  3567             20  MQ-CHECK-STUB-LINE.
  3568                 24  MQ-STUB-COMMENT        PIC X(23).
  3569                 24  MQ-ACCT-AGENT          PIC X(10).
  3570                 24  MQ-INVOICE             PIC X(6).
  3571                 24  MQ-REFERENCE           PIC X(12).
  3572                 24  MQ-LEDGER-NO           PIC X(14).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL686.cbl
  3573                 24  MQ-PYAJ-AMT            PIC S9(7)V99 COMP-3.
  3574                 24  MQ-PYAJ-REC-TYPE       PIC X.
  3575                 24  MQ-PYAJ-SEQ            PIC S9(8)    COMP.
  3576                 24  MQ-PAYMENT-TYPE        PIC X.
  3577                 24  MQ-PYAJ-PMT-APPLIED    PIC X.
  3578                 24  MQ-LAST-MAINT-APPLIED  PIC X.
  3579                 24  MQ-NON-AR-ITEM         PIC X.
  3580                 24  FILLER                 PIC X(19).
  3581
  3582     12  MQ-CHECK-STUB-TEXT REDEFINES MQ-DETAIL-INFORMATION.
  3583         16  MQ-CHECK-TEXT-ITEMS   OCCURS 3 TIMES.
  3584             20  MQ-STUB-TEXT        PIC X(70).
  3585         16  MQ-STUB-FILLER          PIC X(1260).
  3586
  3587     12  MQ-CREDIT-SELECT-DATE       PIC XX.
  3588     12  MQ-CREDIT-ACCEPT-DATE       PIC XX.
  3589
  3590     12  MQ-AR-STATEMENT-DT          PIC XX.
  3591     12  MQ-CO-TYPE                  PIC X.
  3592
  3593     12  MQ-STARTING-CHECK-NUMBER    PIC X(06).
  3594     12  FILLER                      PIC X(41).
  3595******************************************************************
  3596
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL686.cbl
  3598 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3599                          CONTROL-FILE PENDING-PAY-ADJ
  3600                          CHECK-RECORDS COMM-CHECK-RECORDS
  3601                          COMMISSION-CHECK-QUE.
  3602 0000-DFHEXIT SECTION.
  3603     MOVE '9#                    $   ' TO DFHEIV0.
  3604     MOVE 'EL686' TO DFHEIV1.
  3605     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3606
  3607     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3608
  3609*    NOTE *******************************************************
  3610*         *                                                     *
  3611*         *      ACCESS TO THIS MODULE CAN BE ONLY FROM AN XCTL *
  3612*         *  FROM ANOTHER MODULE.                               *
  3613*         *                                                     *
  3614*         *******************************************************.
  3615
  3616     IF EIBCALEN NOT GREATER THAN ZERO
  3617         MOVE UNACCESS-MSG       TO  LOGOFF-MSG
  3618         GO TO 8300-SEND-TEXT.
  3619
  3620
  3621* EXEC CICS HANDLE CONDITION
  3622*        PGMIDERR   (9600-PGMIDERR)
  3623*        NOTFND     (0140-NOT-FOUND)
  3624*        ENDFILE    (0400-END-OF-SEARCH)
  3625*        ENQBUSY    (0910-ENQ-BUSY)
  3626*        TERMIDERR  (7010-TERMID-ERROR)
  3627*        TRANSIDERR (7020-TRANS-ERROR)
  3628*        ERROR      (9990-ERROR)
  3629*    END-EXEC.
  3630*    MOVE '"$LI'')[\.             ! " #00003616' TO DFHEIV0
  3631     MOVE X'22244C4927295B5C2E202020' TO DFHEIV0(1:12)
  3632     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3633     MOVE X'2220233030303033363136' TO DFHEIV0(25:11)
  3634     CALL 'kxdfhei1' USING DFHEIV0
  3635     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3636
  3637
  3638     MOVE EIBTRMID               TO  QID-TERM.
  3639     MOVE +2                     TO  EMI-NUMBER-OF-LINES
  3640                                     EMI-SWITCH2.
  3641
  3642     MOVE EIBTIME                TO  WS-TIME-WORK
  3643                                     TIME-IN.
  3644
  3645     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3646         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  3647             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  3648             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  3649             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  3650             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  3651             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  3652             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  3653             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  3654             MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  3655           ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL686.cbl
  3656             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  3657             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  3658             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  3659             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  3660             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  3661             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  3662             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  3663             MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  3664       ELSE
  3665         GO TO 0110-PROCESS-INPUT.
  3666
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL686.cbl
  3668 0100-INITIALIZE.
  3669
  3670*    NOTE *******************************************************
  3671*         *                                                     *
  3672*         *      INITALIZE THE WORK FIELDS FOR THE PROGRAM      *
  3673*         *  INTERFACE BLOCK FOR THIS MODULE.                   *
  3674*         *                                                     *
  3675*         *******************************************************.
  3676
  3677     MOVE SPACES                 TO  PI-PROGRAM-WORK-AREA.
  3678     MOVE ZERO                   TO  PI-PROC-SW.
  3679
  3680     MOVE LOW-VALUES             TO  EL686AI.
  3681     MOVE -1                     TO  AOPTIONL.
  3682
  3683     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  3684     MOVE '5'                    TO  DC-OPTION-CODE.
  3685     PERFORM 8500-DATE-CONVERSION.
  3686     MOVE DC-BIN-DATE-1          TO  PI-CURRENT-DATE-BIN.
  3687     MOVE DC-GREG-DATE-1-EDIT    TO  PI-CURRENT-DATE.
  3688
  3689     PERFORM 8100-SEND-INITIAL-MAP.
  3690
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL686.cbl
  3692 0110-PROCESS-INPUT.
  3693
  3694*    NOTE *******************************************************
  3695*         *                                                     *
  3696*         *      AFTER THE FIRST TIME THROUGH THE PROPER ATTEN- *
  3697*         *  TION KEY USAGE NEEDS TO BE CHECKED FOR VALIDITY    *
  3698*         *  BEFORE ANY FURTHER PROCESSING CAN BE DONE.         *
  3699*         *                                                     *
  3700*         *******************************************************.
  3701
  3702     IF EIBAID EQUAL TO DFHCLEAR
  3703         GO TO 9400-CLEAR.
  3704
  3705     IF EIBAID EQUAL TO (DFHPA1 OR
  3706                         DFHPA2 OR
  3707                         DFHPA3)
  3708         MOVE ER-0008            TO  EMI-ERROR
  3709         MOVE -1                 TO  APFKL
  3710         PERFORM 8200-SEND-DATAONLY.
  3711
  3712
  3713* EXEC CICS RECEIVE
  3714*        INTO   (EL686AI)
  3715*        MAPSET (WS-MAPSET-NAME)
  3716*        MAP    (WS-MAP-NAME) END-EXEC.
  3717     MOVE LENGTH OF
  3718      EL686AI
  3719       TO DFHEIV11
  3720*    MOVE '8"T I  L              ''   #00003700' TO DFHEIV0
  3721     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3722     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3723     MOVE X'2020233030303033373030' TO DFHEIV0(25:11)
  3724     CALL 'kxdfhei1' USING DFHEIV0,
  3725           WS-MAP-NAME,
  3726           EL686AI,
  3727           DFHEIV11,
  3728           WS-MAPSET-NAME,
  3729           DFHEIV99,
  3730           DFHEIV99
  3731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3732
  3733
  3734     IF APFKL IS GREATER THAN ZERO
  3735         IF EIBAID NOT = DFHENTER
  3736             MOVE ER-0004        TO  EMI-ERROR
  3737             MOVE AL-UNBOF       TO  APFKA
  3738             MOVE -1             TO  APFKL
  3739             PERFORM 8200-SEND-DATAONLY
  3740           ELSE
  3741             IF APFKO IS NUMERIC
  3742               AND APFKO IS GREATER THAN ZERO
  3743               AND APFKO IS LESS THAN '25'
  3744                 MOVE PF-VALUES (APFKI)  TO  EIBAID
  3745               ELSE
  3746                 MOVE ER-0029        TO  EMI-ERROR
  3747                 MOVE AL-UNBOF       TO  APFKA
  3748                 MOVE -1             TO  APFKL
  3749                 PERFORM 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL686.cbl
  3750
  3751     IF EIBAID IS EQUAL TO DFHPF12
  3752         MOVE EL010              TO  THIS-PGM
  3753         GO TO 9300-XCTL.
  3754
  3755     IF EIBAID IS EQUAL TO DFHPF23
  3756         GO TO 9000-RETURN-CICS.
  3757
  3758     IF EIBAID IS EQUAL TO DFHPF24
  3759         MOVE EL126              TO  THIS-PGM
  3760         GO TO 9300-XCTL.
  3761
  3762     IF EIBAID = DFHPF1 AND
  3763        PI-SCREEN-PROCESSED
  3764          GO TO 0200-PROCESS-CHECK-RELEASE.
  3765
  3766     IF EIBAID NOT = DFHENTER
  3767         MOVE ER-0008            TO  EMI-ERROR
  3768         MOVE -1                 TO  APFKL
  3769         PERFORM 8200-SEND-DATAONLY.
  3770
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL686.cbl
  3772
  3773*    NOTE *******************************************************
  3774*         *                                                     *
  3775*         *      OPTION          MEANING                        *
  3776*         *                                                     *
  3777*         *        1         OPTIONS 2 THRU 4                   *
  3778*         *        2         BILLING PAYMENTS                   *
  3779*         *        3         REFUND REIMBURSMENTS               *
  3780*         *        4         MAINTENANCE PAYMENTS               *
  3781*         *                  ACCOUNT RECEIVABLE PAYMENTS        *
  3782*         *                  5 = CHECKS   6 = ACH               *
  3783*         *                                                     *
  3784*         *******************************************************.
  3785
  3786     IF AOPTIONL GREATER ZERO  AND
  3787        AOPTIONI = '1' OR '2' OR '3' OR '4' OR '5' OR '6'
  3788         MOVE AL-UNNON           TO  AOPTIONA
  3789       ELSE
  3790         MOVE -1                 TO  AOPTIONL
  3791         MOVE AL-UNBON           TO  AOPTIONA
  3792         MOVE ER-0330            TO  EMI-ERROR
  3793         PERFORM 9900-ERROR-FORMAT.
  3794
  3795     IF PI-COMPANY-ID = 'POS'
  3796        AND ACARRL NOT GREATER ZERO
  3797             MOVE -1             TO  ACARRL
  3798             MOVE AL-UABOF       TO  ACARRA
  3799             MOVE ER-0568        TO  EMI-ERROR
  3800             PERFORM 9900-ERROR-FORMAT.
  3801
  3802     IF AAMTL GREATER ZERO
  3803
  3804* EXEC CICS BIF DEEDIT
  3805*            FIELD (AAMTI)
  3806*            LENGTH (7)
  3807*       END-EXEC
  3808     MOVE 7
  3809       TO DFHEIV11
  3810*    MOVE '@"L                   #   #00003774' TO DFHEIV0
  3811     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3812     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3813     MOVE X'2020233030303033373734' TO DFHEIV0(25:11)
  3814     CALL 'kxdfhei1' USING DFHEIV0,
  3815           AAMTI,
  3816           DFHEIV11
  3817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3818        IF AAMTI NOT NUMERIC
  3819            MOVE -1             TO  AAMTL
  3820            MOVE AL-UABON       TO  AAMTA
  3821            MOVE ER-0078        TO  EMI-ERROR
  3822            PERFORM 9900-ERROR-FORMAT
  3823         ELSE
  3824            MOVE AAMTI          TO  PI-CHECK-AMOUNT
  3825
  3826            MOVE AL-UANON       TO  AAMTA.
  3827
  3828*    NOTE *******************************************************
  3829*         *                                                     *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL686.cbl
  3830*         *  CHECK TO SEE THAT THE CERTIFICATE NUMBER HAS       *
  3831*         *  THE EFFECTIVE DATE ENTERED.                        *
  3832*         *                                                     *
  3833*         *******************************************************.
  3834
  3835     IF CERTO01I = SPACES
  3836          MOVE +0               TO CERTO01L.
  3837     IF EFFDT01I = SPACES
  3838          MOVE +0               TO EFFDT01L.
  3839     IF CERTO02I = SPACES
  3840          MOVE +0               TO CERTO02L.
  3841     IF EFFDT02I = SPACES
  3842          MOVE +0               TO EFFDT02L.
  3843     IF CERTO03I = SPACES
  3844          MOVE +0               TO CERTO03L.
  3845     IF EFFDT03I = SPACES
  3846          MOVE +0               TO EFFDT03L.
  3847     IF CERTO04I = SPACES
  3848          MOVE +0               TO CERTO04L.
  3849     IF EFFDT04I = SPACES
  3850          MOVE +0               TO EFFDT04L.
  3851     IF CERTO05I = SPACES
  3852          MOVE +0               TO CERTO05L.
  3853     IF EFFDT05I = SPACES
  3854          MOVE +0               TO EFFDT05L.
  3855     IF CERTO06I = SPACES
  3856          MOVE +0               TO CERTO06L.
  3857     IF EFFDT06I = SPACES
  3858          MOVE +0               TO EFFDT06L.
  3859     IF CERTO07I = SPACES
  3860          MOVE +0               TO CERTO07L.
  3861     IF EFFDT07I = SPACES
  3862          MOVE +0               TO EFFDT07L.
  3863     IF CERTO08I = SPACES
  3864          MOVE +0               TO CERTO08L.
  3865     IF EFFDT08I = SPACES
  3866          MOVE +0               TO EFFDT08L.
  3867     IF CERTO09I = SPACES
  3868          MOVE +0               TO CERTO09L.
  3869     IF EFFDT09I = SPACES
  3870          MOVE +0               TO EFFDT09L.
  3871     IF CERTO10I = SPACES
  3872          MOVE +0               TO CERTO10L.
  3873     IF EFFDT10I = SPACES
  3874          MOVE +0               TO EFFDT10L.
  3875     IF CERTO11I = SPACES
  3876          MOVE +0               TO CERTO11L.
  3877     IF EFFDT11I = SPACES
  3878          MOVE +0               TO EFFDT11L.
  3879     IF CERTO12I = SPACES
  3880          MOVE +0               TO CERTO12L.
  3881     IF EFFDT12I = SPACES
  3882          MOVE +0               TO EFFDT12L.
  3883     IF CERTO13I = SPACES
  3884          MOVE +0               TO CERTO13L.
  3885     IF EFFDT13I = SPACES
  3886          MOVE +0               TO EFFDT13L.
  3887     IF CERTO14I = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL686.cbl
  3888          MOVE +0               TO CERTO14L.
  3889     IF EFFDT14I = SPACES
  3890          MOVE +0               TO EFFDT14L.
  3891     IF CERTO15I = SPACES
  3892          MOVE +0               TO CERTO15L.
  3893     IF EFFDT15I = SPACES
  3894          MOVE +0               TO EFFDT15L.
  3895
  3896     IF (CERTO01L     > 0 AND EFFDT01L NOT > 0) OR
  3897        (CERTO01L NOT > 0 AND EFFDT01L     > 0) OR
  3898        (CERTO02L     > 0 AND EFFDT02L NOT > 0) OR
  3899        (CERTO02L NOT > 0 AND EFFDT02L     > 0) OR
  3900        (CERTO03L     > 0 AND EFFDT03L NOT > 0) OR
  3901        (CERTO03L NOT > 0 AND EFFDT03L     > 0) OR
  3902        (CERTO04L     > 0 AND EFFDT04L NOT > 0) OR
  3903        (CERTO04L NOT > 0 AND EFFDT04L     > 0) OR
  3904        (CERTO05L     > 0 AND EFFDT05L NOT > 0) OR
  3905        (CERTO05L NOT > 0 AND EFFDT05L     > 0) OR
  3906        (CERTO06L     > 0 AND EFFDT06L NOT > 0) OR
  3907        (CERTO06L NOT > 0 AND EFFDT06L     > 0) OR
  3908        (CERTO07L     > 0 AND EFFDT07L NOT > 0) OR
  3909        (CERTO07L NOT > 0 AND EFFDT07L     > 0) OR
  3910        (CERTO08L     > 0 AND EFFDT08L NOT > 0) OR
  3911        (CERTO08L NOT > 0 AND EFFDT08L     > 0) OR
  3912        (CERTO09L     > 0 AND EFFDT09L NOT > 0) OR
  3913        (CERTO09L NOT > 0 AND EFFDT09L     > 0) OR
  3914        (CERTO10L     > 0 AND EFFDT10L NOT > 0) OR
  3915        (CERTO10L NOT > 0 AND EFFDT10L     > 0) OR
  3916        (CERTO11L     > 0 AND EFFDT11L NOT > 0) OR
  3917        (CERTO11L NOT > 0 AND EFFDT11L     > 0) OR
  3918        (CERTO12L     > 0 AND EFFDT12L NOT > 0) OR
  3919        (CERTO12L NOT > 0 AND EFFDT12L     > 0) OR
  3920        (CERTO13L     > 0 AND EFFDT13L NOT > 0) OR
  3921        (CERTO13L NOT > 0 AND EFFDT13L     > 0) OR
  3922        (CERTO14L     > 0 AND EFFDT14L NOT > 0) OR
  3923        (CERTO14L NOT > 0 AND EFFDT14L     > 0) OR
  3924        (CERTO15L     > 0 AND EFFDT15L NOT > 0) OR
  3925        (CERTO15L NOT > 0 AND EFFDT15L     > 0)
  3926         MOVE ER-0766            TO EMI-ERROR
  3927         MOVE -1                 TO CERTO01L
  3928         PERFORM 9900-ERROR-FORMAT.
  3929
  3930     IF EFFDT01L GREATER ZERO
  3931         MOVE EFFDT01I                 TO  DEEDIT-FIELD
  3932         PERFORM 8600-DEEDIT
  3933         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  3934         MOVE '4'                      TO  DC-OPTION-CODE
  3935         PERFORM 8500-DATE-CONVERSION
  3936         IF DATE-CONVERSION-ERROR
  3937             MOVE ER-0348              TO  EMI-ERROR
  3938             MOVE -1                   TO  EFFDT01L
  3939             MOVE AL-UABON             TO  EFFDT01A
  3940             PERFORM 9900-ERROR-FORMAT
  3941           ELSE
  3942             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT01I
  3943             MOVE AL-UANON             TO  EFFDT01A
  3944             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (1).
  3945
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL686.cbl
  3946     IF EFFDT02L GREATER ZERO
  3947         MOVE EFFDT02I                 TO  DEEDIT-FIELD
  3948         PERFORM 8600-DEEDIT
  3949         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  3950         MOVE '4'                      TO  DC-OPTION-CODE
  3951         PERFORM 8500-DATE-CONVERSION
  3952         IF DATE-CONVERSION-ERROR
  3953             MOVE ER-0348              TO  EMI-ERROR
  3954             MOVE -1                   TO  EFFDT02L
  3955             MOVE AL-UABON             TO  EFFDT02A
  3956             PERFORM 9900-ERROR-FORMAT
  3957           ELSE
  3958             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT02I
  3959             MOVE AL-UANON             TO  EFFDT02A
  3960             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (2).
  3961
  3962     IF EFFDT03L GREATER ZERO
  3963         MOVE EFFDT03I                 TO  DEEDIT-FIELD
  3964         PERFORM 8600-DEEDIT
  3965         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  3966         MOVE '4'                      TO  DC-OPTION-CODE
  3967         PERFORM 8500-DATE-CONVERSION
  3968         IF DATE-CONVERSION-ERROR
  3969             MOVE ER-0348              TO  EMI-ERROR
  3970             MOVE -1                   TO  EFFDT03L
  3971             MOVE AL-UABON             TO  EFFDT03A
  3972             PERFORM 9900-ERROR-FORMAT
  3973           ELSE
  3974             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT03I
  3975             MOVE AL-UANON             TO  EFFDT03A
  3976             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (3).
  3977
  3978     IF EFFDT04L GREATER ZERO
  3979         MOVE EFFDT04I                 TO  DEEDIT-FIELD
  3980         PERFORM 8600-DEEDIT
  3981         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  3982         MOVE '4'                      TO  DC-OPTION-CODE
  3983         PERFORM 8500-DATE-CONVERSION
  3984         IF DATE-CONVERSION-ERROR
  3985             MOVE ER-0348              TO  EMI-ERROR
  3986             MOVE -1                   TO  EFFDT04L
  3987             MOVE AL-UABON             TO  EFFDT04A
  3988             PERFORM 9900-ERROR-FORMAT
  3989           ELSE
  3990             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT04I
  3991             MOVE AL-UANON             TO  EFFDT04A
  3992             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (4).
  3993
  3994     IF EFFDT05L GREATER ZERO
  3995         MOVE EFFDT05I                 TO  DEEDIT-FIELD
  3996         PERFORM 8600-DEEDIT
  3997         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  3998         MOVE '4'                      TO  DC-OPTION-CODE
  3999         PERFORM 8500-DATE-CONVERSION
  4000         IF DATE-CONVERSION-ERROR
  4001             MOVE ER-0348              TO  EMI-ERROR
  4002             MOVE -1                   TO  EFFDT05L
  4003             MOVE AL-UABON             TO  EFFDT05A
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL686.cbl
  4004             PERFORM 9900-ERROR-FORMAT
  4005           ELSE
  4006             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT05I
  4007             MOVE AL-UANON             TO  EFFDT05A
  4008             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (5).
  4009
  4010     IF EFFDT06L GREATER ZERO
  4011         MOVE EFFDT06I                 TO  DEEDIT-FIELD
  4012         PERFORM 8600-DEEDIT
  4013         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4014         MOVE '4'                      TO  DC-OPTION-CODE
  4015         PERFORM 8500-DATE-CONVERSION
  4016         IF DATE-CONVERSION-ERROR
  4017             MOVE ER-0348              TO  EMI-ERROR
  4018             MOVE -1                   TO  EFFDT06L
  4019             MOVE AL-UABON             TO  EFFDT06A
  4020             PERFORM 9900-ERROR-FORMAT
  4021           ELSE
  4022             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT06I
  4023             MOVE AL-UANON             TO  EFFDT06A
  4024             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (6).
  4025
  4026     IF EFFDT07L GREATER ZERO
  4027         MOVE EFFDT07I                 TO  DEEDIT-FIELD
  4028         PERFORM 8600-DEEDIT
  4029         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4030         MOVE '4'                      TO  DC-OPTION-CODE
  4031         PERFORM 8500-DATE-CONVERSION
  4032         IF DATE-CONVERSION-ERROR
  4033             MOVE ER-0348              TO  EMI-ERROR
  4034             MOVE -1                   TO  EFFDT07L
  4035             MOVE AL-UABON             TO  EFFDT07A
  4036             PERFORM 9900-ERROR-FORMAT
  4037           ELSE
  4038             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT07I
  4039             MOVE AL-UANON             TO  EFFDT07A
  4040             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (7).
  4041
  4042     IF EFFDT08L GREATER ZERO
  4043         MOVE EFFDT08I                 TO  DEEDIT-FIELD
  4044         PERFORM 8600-DEEDIT
  4045         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4046         MOVE '4'                      TO  DC-OPTION-CODE
  4047         PERFORM 8500-DATE-CONVERSION
  4048         IF DATE-CONVERSION-ERROR
  4049             MOVE ER-0348              TO  EMI-ERROR
  4050             MOVE -1                   TO  EFFDT08L
  4051             MOVE AL-UABON             TO  EFFDT08A
  4052             PERFORM 9900-ERROR-FORMAT
  4053           ELSE
  4054             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT08I
  4055             MOVE AL-UANON             TO  EFFDT08A
  4056             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (8).
  4057
  4058     IF EFFDT09L GREATER ZERO
  4059         MOVE EFFDT09I                 TO  DEEDIT-FIELD
  4060         PERFORM 8600-DEEDIT
  4061         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL686.cbl
  4062         MOVE '4'                      TO  DC-OPTION-CODE
  4063         PERFORM 8500-DATE-CONVERSION
  4064         IF DATE-CONVERSION-ERROR
  4065             MOVE ER-0348              TO  EMI-ERROR
  4066             MOVE -1                   TO  EFFDT09L
  4067             MOVE AL-UABON             TO  EFFDT09A
  4068             PERFORM 9900-ERROR-FORMAT
  4069           ELSE
  4070             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT09I
  4071             MOVE AL-UANON             TO  EFFDT09A
  4072             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (9).
  4073
  4074     IF EFFDT10L GREATER ZERO
  4075         MOVE EFFDT10I                 TO  DEEDIT-FIELD
  4076         PERFORM 8600-DEEDIT
  4077         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4078         MOVE '4'                      TO  DC-OPTION-CODE
  4079         PERFORM 8500-DATE-CONVERSION
  4080         IF DATE-CONVERSION-ERROR
  4081             MOVE ER-0348              TO  EMI-ERROR
  4082             MOVE -1                   TO  EFFDT10L
  4083             MOVE AL-UABON             TO  EFFDT10A
  4084             PERFORM 9900-ERROR-FORMAT
  4085           ELSE
  4086             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT10I
  4087             MOVE AL-UANON             TO  EFFDT10A
  4088             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (10).
  4089
  4090     IF EFFDT11L GREATER ZERO
  4091         MOVE EFFDT11I                 TO  DEEDIT-FIELD
  4092         PERFORM 8600-DEEDIT
  4093         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4094         MOVE '4'                      TO  DC-OPTION-CODE
  4095         PERFORM 8500-DATE-CONVERSION
  4096         IF DATE-CONVERSION-ERROR
  4097             MOVE ER-0348              TO  EMI-ERROR
  4098             MOVE -1                   TO  EFFDT11L
  4099             MOVE AL-UABON             TO  EFFDT11A
  4100             PERFORM 9900-ERROR-FORMAT
  4101           ELSE
  4102             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT11I
  4103             MOVE AL-UANON             TO  EFFDT11A
  4104             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (11).
  4105
  4106     IF EFFDT12L GREATER ZERO
  4107         MOVE EFFDT12I                 TO  DEEDIT-FIELD
  4108         PERFORM 8600-DEEDIT
  4109         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4110         MOVE '4'                      TO  DC-OPTION-CODE
  4111         PERFORM 8500-DATE-CONVERSION
  4112         IF DATE-CONVERSION-ERROR
  4113             MOVE ER-0348              TO  EMI-ERROR
  4114             MOVE -1                   TO  EFFDT12L
  4115             MOVE AL-UABON             TO  EFFDT12A
  4116             PERFORM 9900-ERROR-FORMAT
  4117           ELSE
  4118             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT12I
  4119             MOVE AL-UANON             TO  EFFDT12A
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL686.cbl
  4120             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (12).
  4121
  4122     IF EFFDT13L GREATER ZERO
  4123         MOVE EFFDT13I                 TO  DEEDIT-FIELD
  4124         PERFORM 8600-DEEDIT
  4125         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4126         MOVE '4'                      TO  DC-OPTION-CODE
  4127         PERFORM 8500-DATE-CONVERSION
  4128         IF DATE-CONVERSION-ERROR
  4129             MOVE ER-0348              TO  EMI-ERROR
  4130             MOVE -1                   TO  EFFDT13L
  4131             MOVE AL-UABON             TO  EFFDT13A
  4132             PERFORM 9900-ERROR-FORMAT
  4133           ELSE
  4134             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT13I
  4135             MOVE AL-UANON             TO  EFFDT13A
  4136             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (13).
  4137
  4138     IF EFFDT14L GREATER ZERO
  4139         MOVE EFFDT14I                 TO  DEEDIT-FIELD
  4140         PERFORM 8600-DEEDIT
  4141         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4142         MOVE '4'                      TO  DC-OPTION-CODE
  4143         PERFORM 8500-DATE-CONVERSION
  4144         IF DATE-CONVERSION-ERROR
  4145             MOVE ER-0348              TO  EMI-ERROR
  4146             MOVE -1                   TO  EFFDT14L
  4147             MOVE AL-UABON             TO  EFFDT14A
  4148             PERFORM 9900-ERROR-FORMAT
  4149           ELSE
  4150             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT14I
  4151             MOVE AL-UANON             TO  EFFDT14A
  4152             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (14).
  4153
  4154     IF EFFDT15L GREATER ZERO
  4155         MOVE EFFDT15I                 TO  DEEDIT-FIELD
  4156         PERFORM 8600-DEEDIT
  4157         MOVE DEEDIT-FIELD-V0          TO  DC-GREG-DATE-1-MDY
  4158         MOVE '4'                      TO  DC-OPTION-CODE
  4159         PERFORM 8500-DATE-CONVERSION
  4160         IF DATE-CONVERSION-ERROR
  4161             MOVE ER-0348              TO  EMI-ERROR
  4162             MOVE -1                   TO  EFFDT15L
  4163             MOVE AL-UABON             TO  EFFDT15A
  4164             PERFORM 9900-ERROR-FORMAT
  4165           ELSE
  4166             MOVE DC-GREG-DATE-1-EDIT  TO  EFFDT15I
  4167             MOVE AL-UANON             TO  EFFDT15A
  4168             MOVE DC-BIN-DATE-1        TO  BIN-EFFDT (15).
  4169
  4170     IF EMI-ERROR NOT = ZERO
  4171         MOVE +0                     TO PI-PROC-SW
  4172         PERFORM 8200-SEND-DATAONLY
  4173      ELSE
  4174         GO TO 0200-PROCESS-CHECK-RELEASE.
  4175
  4176 0140-NOT-FOUND.
  4177
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL686.cbl
  4178     MOVE ER-0331                TO  EMI-ERROR.
  4179     PERFORM 8200-SEND-DATAONLY.
  4180
  4181 0200-PROCESS-CHECK-RELEASE.
  4182
  4183*    NOTE *******************************************************
  4184*         *                                                     *
  4185*         *      OBTAIN EXCLUSIVE CONTROL OF THE CHECK QUEUE    *
  4186*         *  DATASET DURING THE GENERATION OF THE CHECK QUEUE   *
  4187*         *  RECORDS.                                           *
  4188*         *                                                     *
  4189*         *******************************************************.
  4190
  4191******  ACTUAL CHECK RELEASE WILL NOT TAKE PLACE
  4192******         UNLESS PF1 WAS PRESSED
  4193
  4194     IF EIBAID = DFHPF1
  4195
  4196* EXEC CICS ENQ
  4197*            RESOURCE (WS-ERCHKQ-DSID)
  4198*            LENGTH   (11)
  4199*        END-EXEC
  4200     MOVE 11
  4201       TO DFHEIV11
  4202*    MOVE '2$L                   $   #00004155' TO DFHEIV0
  4203     MOVE X'32244C202020202020202020' TO DFHEIV0(1:12)
  4204     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4205     MOVE X'2020233030303034313535' TO DFHEIV0(25:11)
  4206     CALL 'kxdfhei1' USING DFHEIV0,
  4207           WS-ERCHKQ-DSID,
  4208           DFHEIV11,
  4209           DFHEIV99
  4210     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4211
  4212* EXEC CICS ENQ
  4213*            RESOURCE (WS-ERCMKQ-DSID)
  4214*            LENGTH   (11)
  4215*        END-EXEC.
  4216     MOVE 11
  4217       TO DFHEIV11
  4218*    MOVE '2$L                   $   #00004159' TO DFHEIV0
  4219     MOVE X'32244C202020202020202020' TO DFHEIV0(1:12)
  4220     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4221     MOVE X'2020233030303034313539' TO DFHEIV0(25:11)
  4222     CALL 'kxdfhei1' USING DFHEIV0,
  4223           WS-ERCMKQ-DSID,
  4224           DFHEIV11,
  4225           DFHEIV99
  4226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4227
  4228
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL686.cbl
  4230*    NOTE *******************************************************
  4231*         *                                                     *
  4232*         *      GET THE CONTROL GROUP NUMBER FROM THE COMPANY  *
  4233*         *  CONTROL RECORD OF THE CONTROL FILE.                *
  4234*         *                                                     *
  4235*         *******************************************************.
  4236
  4237     MOVE SPACES                 TO  WS-CONTROL-FILE-KEY.
  4238
  4239     MOVE PI-COMPANY-ID          TO  WS-CFK-COMPANY-ID.
  4240     MOVE '1'                    TO  WS-CFK-RECORD-TYPE.
  4241     MOVE ZERO                   TO  WS-CFK-SEQUENCE-NO.
  4242
  4243     IF EIBAID = DFHPF1
  4244
  4245* EXEC CICS READ UPDATE
  4246*            DATASET (WS-ELCNTL-DSID)
  4247*            RIDFLD  (WS-CONTROL-FILE-KEY)
  4248*            SET     (ADDRESS OF CONTROL-FILE)
  4249*        END-EXEC
  4250*    MOVE '&"S        EU         (   #00004179' TO DFHEIV0
  4251     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4252     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4253     MOVE X'2020233030303034313739' TO DFHEIV0(25:11)
  4254     CALL 'kxdfhei1' USING DFHEIV0,
  4255           WS-ELCNTL-DSID,
  4256           DFHEIV20,
  4257           DFHEIV99,
  4258           WS-CONTROL-FILE-KEY,
  4259           DFHEIV99,
  4260           DFHEIV99,
  4261           DFHEIV99
  4262     SET ADDRESS OF CONTROL-FILE TO
  4263         DFHEIV20
  4264     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4265      ELSE
  4266
  4267* EXEC CICS READ
  4268*            DATASET (WS-ELCNTL-DSID)
  4269*            RIDFLD  (WS-CONTROL-FILE-KEY)
  4270*            SET     (ADDRESS OF CONTROL-FILE)
  4271*        END-EXEC.
  4272*    MOVE '&"S        E          (   #00004185' TO DFHEIV0
  4273     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4274     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4275     MOVE X'2020233030303034313835' TO DFHEIV0(25:11)
  4276     CALL 'kxdfhei1' USING DFHEIV0,
  4277           WS-ELCNTL-DSID,
  4278           DFHEIV20,
  4279           DFHEIV99,
  4280           WS-CONTROL-FILE-KEY,
  4281           DFHEIV99,
  4282           DFHEIV99,
  4283           DFHEIV99
  4284     SET ADDRESS OF CONTROL-FILE TO
  4285         DFHEIV20
  4286     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4287
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL686.cbl
  4288
  4289     ADD +1                      TO  CF-CR-CHECK-QUE-COUNTER.
  4290
  4291     IF CR-QUE-COUNT-RESET
  4292         MOVE +1                 TO  CF-CR-CHECK-QUE-COUNTER.
  4293
  4294     MOVE CF-CR-CHECK-QUE-COUNTER  TO  WS-CHECK-QUE-COUNTER
  4295                                       PI-CK-CONTROL-NO.
  4296
  4297     MOVE WS-ELCNTL-DSID         TO  JP-FILE-ID.
  4298     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4299     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  4300
  4301     IF EIBAID = DFHPF1
  4302
  4303* EXEC CICS REWRITE
  4304*            DATASET (WS-ELCNTL-DSID)
  4305*            FROM    (CONTROL-FILE)
  4306*        END-EXEC
  4307     MOVE LENGTH OF
  4308      CONTROL-FILE
  4309       TO DFHEIV11
  4310*    MOVE '&& L                  %   #00004204' TO DFHEIV0
  4311     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4312     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4313     MOVE X'2020233030303034323034' TO DFHEIV0(25:11)
  4314     CALL 'kxdfhei1' USING DFHEIV0,
  4315           WS-ELCNTL-DSID,
  4316           CONTROL-FILE,
  4317           DFHEIV11,
  4318           DFHEIV99
  4319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4320         PERFORM 8400-LOG-JOURNAL-RECORD.
  4321
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL686.cbl
  4323*    NOTE *******************************************************
  4324*         *                                                     *
  4325*         *      GET STORAGE FOR WRITING OF THE CHECK QUEUE     *
  4326*         *  RECORDS.                                           *
  4327*         *                                                     *
  4328*         *******************************************************.
  4329
  4330     IF  AOPTIONI     = '5' OR '6'
  4331
  4332* EXEC CICS GETMAIN
  4333*            SET (ADDRESS OF COMMISSION-CHECK-QUE)
  4334*            LENGTH (WS-ERCMKQ-LENGTH)
  4335*            INITIMG (WS-SPACES) END-EXEC
  4336*    MOVE ',"IL                  $   #00004219' TO DFHEIV0
  4337     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4338     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4339     MOVE X'2020233030303034323139' TO DFHEIV0(25:11)
  4340     CALL 'kxdfhei1' USING DFHEIV0,
  4341           DFHEIV20,
  4342           WS-ERCMKQ-LENGTH,
  4343           WS-SPACES
  4344     SET ADDRESS OF COMMISSION-CHECK-QUE TO
  4345         DFHEIV20
  4346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4347         COMPUTE WS-SEQ-NO = WS-TIME-WORK  *  10
  4348         MOVE AOPTIONI  TO  PI-PGM-PRINT-OPT
  4349         GO TO 0280-OPTION-5
  4350     ELSE
  4351
  4352* EXEC CICS GETMAIN
  4353*            SET (ADDRESS OF CHECK-QUE)
  4354*            LENGTH (WS-ERCHKQ-LENGTH)
  4355*            INITIMG (WS-SPACES) END-EXEC.
  4356*    MOVE ',"IL                  $   #00004227' TO DFHEIV0
  4357     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4358     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4359     MOVE X'2020233030303034323237' TO DFHEIV0(25:11)
  4360     CALL 'kxdfhei1' USING DFHEIV0,
  4361           DFHEIV20,
  4362           WS-ERCHKQ-LENGTH,
  4363           WS-SPACES
  4364     SET ADDRESS OF CHECK-QUE TO
  4365         DFHEIV20
  4366     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4367
  4368
  4369     IF AOPTIONI EQUAL '1' OR '2'
  4370         NEXT SENTENCE
  4371     ELSE
  4372         GO TO 0260-END-OF-ERPYAJ.
  4373
  4374*    NOTE *******************************************************
  4375*         *                                                     *
  4376*         *      BROWSE THE PENDING PAYMENTS AND ADJUSTMENTS    *
  4377*         *  FILE FOR PAYMENTS PENDING.                         *
  4378*         *                                                     *
  4379*         *      WHEN A PAYMENT IS PENDING, GENERATE A CHECK    *
  4380*         *  QUEUE RECORD FOR RELEASE.                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL686.cbl
  4381*         *                                                     *
  4382*         *******************************************************.
  4383
  4384     MOVE LOW-VALUES             TO  WS-PENDING-PAYMENTS-KEY.
  4385     MOVE PI-COMPANY-CD          TO  WS-PPK-COMPANY-CD.
  4386
  4387 0225-STARTBR-ERPYAJ.
  4388
  4389     IF WS-ERPYAJ-BROWSE-NOT-STARTED
  4390
  4391* EXEC CICS STARTBR
  4392*            DATASET (WS-ERPYAJ-DSID)
  4393*            RIDFLD  (WS-PENDING-PAYMENTS-KEY)
  4394*            GTEQ
  4395*            END-EXEC.
  4396     MOVE 0
  4397       TO DFHEIV11
  4398*    MOVE '&,         G          &   #00004253' TO DFHEIV0
  4399     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4400     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4401     MOVE X'2020233030303034323533' TO DFHEIV0(25:11)
  4402     CALL 'kxdfhei1' USING DFHEIV0,
  4403           WS-ERPYAJ-DSID,
  4404           WS-PENDING-PAYMENTS-KEY,
  4405           DFHEIV99,
  4406           DFHEIV11,
  4407           DFHEIV99
  4408     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4409
  4410
  4411     MOVE +1 TO WS-ERPYAJ-BROWSE-SW.
  4412
  4413
  4414* EXEC CICS HANDLE CONDITION
  4415*        ENDFILE    (0260-END-OF-ERPYAJ)
  4416*        END-EXEC.
  4417*    MOVE '"$''                   ! # #00004261' TO DFHEIV0
  4418     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  4419     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4420     MOVE X'2320233030303034323631' TO DFHEIV0(25:11)
  4421     CALL 'kxdfhei1' USING DFHEIV0
  4422     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4423
  4424
  4425 0250-READNEXT-ERPYAJ.
  4426
  4427
  4428* EXEC CICS READNEXT
  4429*        DATASET (WS-ERPYAJ-DSID)
  4430*        RIDFLD  (WS-PENDING-PAYMENTS-KEY)
  4431*        SET     (ADDRESS OF PENDING-PAY-ADJ) END-EXEC.
  4432     MOVE 0
  4433       TO DFHEIV11
  4434*    MOVE '&.S                   )   #00004267' TO DFHEIV0
  4435     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4436     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4437     MOVE X'2020233030303034323637' TO DFHEIV0(25:11)
  4438     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL686.cbl
  4439           WS-ERPYAJ-DSID,
  4440           DFHEIV20,
  4441           DFHEIV99,
  4442           WS-PENDING-PAYMENTS-KEY,
  4443           DFHEIV99,
  4444           DFHEIV11,
  4445           DFHEIV99,
  4446           DFHEIV99
  4447     SET ADDRESS OF PENDING-PAY-ADJ TO
  4448         DFHEIV20
  4449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4450
  4451
  4452     IF WS-PPK-COMPANY-CD EQUAL PI-COMPANY-CD
  4453         NEXT SENTENCE
  4454     ELSE
  4455         IF AOPTIONI EQUAL '1'
  4456             GO TO 0260-END-OF-ERPYAJ
  4457         ELSE
  4458             GO TO 0400-END-OF-SEARCH.
  4459
  4460     IF ACARRL GREATER ZERO
  4461         IF PY-CARRIER NOT = ACARRI
  4462            GO TO 0250-READNEXT-ERPYAJ.
  4463
  4464     IF AGROUPL GREATER ZERO
  4465        IF PY-GROUPING NOT = AGROUPI
  4466            GO TO 0250-READNEXT-ERPYAJ.
  4467
  4468     IF ABYL GREATER ZERO
  4469        IF PY-LAST-MAINT-BY NOT = ABYI
  4470            GO TO 0250-READNEXT-ERPYAJ.
  4471
  4472     IF AAMTL GREATER ZERO
  4473         IF PY-ENTRY-AMT LESS PI-CHECK-AMOUNT
  4474             NEXT SENTENCE
  4475           ELSE
  4476             GO TO 0250-READNEXT-ERPYAJ.
  4477
  4478     IF  PY-CHARGE-TO-AGENT
  4479          IF PY-BILLING-CHECK OR
  4480             PY-GA-CHECK
  4481             NEXT SENTENCE
  4482          ELSE
  4483             GO TO 0250-READNEXT-ERPYAJ
  4484     ELSE
  4485          GO TO 0250-READNEXT-ERPYAJ.
  4486
  4487     IF PY-CHECK-QUE-CONTROL  EQUAL ZEROS AND
  4488        PY-CHECK-QUE-SEQUENCE EQUAL ZEROS
  4489         NEXT SENTENCE
  4490     ELSE
  4491         GO TO 0250-READNEXT-ERPYAJ.
  4492
  4493*    NOTE *******************************************************
  4494*         *                                                     *
  4495*         *      THE PAYMENT TRAILER HAS MET ALL OF THE         *
  4496*         *  QUALIFICATIONS FOR THIS CHECK RELEASE, NOW         *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL686.cbl
  4497*         *  GENERATE A CHECK QUEUE RECORD.                     *
  4498*         *                                                     *
  4499*         *******************************************************.
  4500
  4501     ADD +1                      TO  WS-RELEASED-COUNT.
  4502     ADD PY-ENTRY-AMT            TO  WS-RELEASED-AMOUNT.
  4503
  4504     IF EIBAID NOT = DFHPF1
  4505         GO TO 0250-READNEXT-ERPYAJ.
  4506
  4507     IF WS-ERPYAJ-BROWSE-STARTED
  4508
  4509* EXEC CICS ENDBR
  4510*            DATASET (WS-ERPYAJ-DSID)
  4511*            END-EXEC
  4512     MOVE 0
  4513       TO DFHEIV11
  4514*    MOVE '&2                    $   #00004328' TO DFHEIV0
  4515     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4516     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4517     MOVE X'2020233030303034333238' TO DFHEIV0(25:11)
  4518     CALL 'kxdfhei1' USING DFHEIV0,
  4519           WS-ERPYAJ-DSID,
  4520           DFHEIV11,
  4521           DFHEIV99
  4522     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4523         MOVE +0 TO WS-ERPYAJ-BROWSE-SW.
  4524
  4525
  4526* EXEC CICS READ UPDATE
  4527*        DATASET (WS-ERPYAJ-DSID)
  4528*        RIDFLD  (WS-PENDING-PAYMENTS-KEY)
  4529*        SET     (ADDRESS OF PENDING-PAY-ADJ)
  4530*    END-EXEC.
  4531*    MOVE '&"S        EU         (   #00004333' TO DFHEIV0
  4532     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4533     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4534     MOVE X'2020233030303034333333' TO DFHEIV0(25:11)
  4535     CALL 'kxdfhei1' USING DFHEIV0,
  4536           WS-ERPYAJ-DSID,
  4537           DFHEIV20,
  4538           DFHEIV99,
  4539           WS-PENDING-PAYMENTS-KEY,
  4540           DFHEIV99,
  4541           DFHEIV99,
  4542           DFHEIV99
  4543     SET ADDRESS OF PENDING-PAY-ADJ TO
  4544         DFHEIV20
  4545     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4546
  4547
  4548     MOVE SPACES                 TO  CHECK-QUE.
  4549     MOVE 'CQ'                   TO  CQ-RECORD-ID.
  4550     MOVE PY-COMPANY-CD          TO  CQ-COMPANY-CD.
  4551     MOVE WS-CHECK-QUE-COUNTER   TO  CQ-CONTROL-NUMBER
  4552                                     PY-CHECK-QUE-CONTROL
  4553     MOVE WS-CHECK-COUNTER       TO  CQ-SEQUENCE-NUMBER
  4554                                     PY-CHECK-QUE-SEQUENCE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL686.cbl
  4555     ADD +1                      TO  WS-CHECK-COUNTER.
  4556     MOVE 'Q'                    TO  CQ-ENTRY-TYPE.
  4557     MOVE PY-CARRIER             TO  CQ-PYAJ-CARRIER.
  4558     MOVE PY-GROUPING            TO  CQ-PYAJ-GROUPING.
  4559     MOVE PY-FIN-RESP            TO  CQ-PYAJ-FIN-RESP.
  4560     MOVE PY-ACCOUNT             TO  CQ-PYAJ-ACCOUNT.
  4561     MOVE PY-FILE-SEQ-NO         TO  CQ-PYAJ-SEQ.
  4562     MOVE PY-RECORD-TYPE         TO  CQ-PYAJ-REC-TYPE.
  4563     MOVE PY-ENTRY-AMT           TO  CQ-CHECK-AMOUNT.
  4564     MOVE SPACES                 TO  WS-CHECK-NUMBER.
  4565     MOVE PY-CHECK-NUMBER        TO  WS-CHECK-NO.
  4566     MOVE WS-CHECK-NUMBER        TO  CQ-CHECK-NUMBER.
  4567     MOVE '1'                    TO  CQ-PAYMENT-TYPE.
  4568     MOVE ZERO                   TO  CQ-TIMES-PRINTED
  4569                                     CQ-PRINT-AT-HHMM.
  4570     MOVE PI-CURRENT-DATE-BIN    TO  CQ-CHECK-WRITTEN-DT.
  4571     MOVE PY-REPORTED-DT         TO  CQ-CHECK-BY-USER.
  4572     MOVE +6860                  TO  CQ-LAST-UPDATED-BY.
  4573     MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4574     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4575     MOVE WS-ERCHKQ-DSID         TO  JP-FILE-ID.
  4576
  4577
  4578* EXEC CICS WRITE
  4579*        DATASET (WS-ERCHKQ-DSID)
  4580*        FROM    (CHECK-QUE)
  4581*        RIDFLD  (CQ-CONTROL-PRIMARY) END-EXEC.
  4582     MOVE LENGTH OF
  4583      CHECK-QUE
  4584       TO DFHEIV11
  4585*    MOVE '&$ L                  ''   #00004368' TO DFHEIV0
  4586     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4587     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4588     MOVE X'2020233030303034333638' TO DFHEIV0(25:11)
  4589     CALL 'kxdfhei1' USING DFHEIV0,
  4590           WS-ERCHKQ-DSID,
  4591           CHECK-QUE,
  4592           DFHEIV11,
  4593           CQ-CONTROL-PRIMARY,
  4594           DFHEIV99,
  4595           DFHEIV99
  4596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4597
  4598
  4599     PERFORM 8400-LOG-JOURNAL-RECORD.
  4600
  4601     MOVE PI-PROCESSOR-ID        TO  PY-LAST-MAINT-BY.
  4602
  4603     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  4604     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4605     MOVE WS-ERPYAJ-DSID            TO  JP-FILE-ID.
  4606
  4607
  4608* EXEC CICS REWRITE
  4609*        DATASET (WS-ERPYAJ-DSID)
  4610*        FROM    (PENDING-PAY-ADJ) END-EXEC.
  4611     MOVE LENGTH OF
  4612      PENDING-PAY-ADJ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL686.cbl
  4613       TO DFHEIV11
  4614*    MOVE '&& L                  %   #00004381' TO DFHEIV0
  4615     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4616     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4617     MOVE X'2020233030303034333831' TO DFHEIV0(25:11)
  4618     CALL 'kxdfhei1' USING DFHEIV0,
  4619           WS-ERPYAJ-DSID,
  4620           PENDING-PAY-ADJ,
  4621           DFHEIV11,
  4622           DFHEIV99
  4623     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4624
  4625
  4626     PERFORM 8400-LOG-JOURNAL-RECORD.
  4627
  4628     GO TO 0225-STARTBR-ERPYAJ.
  4629
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL686.cbl
  4631
  4632 0260-END-OF-ERPYAJ.
  4633
  4634     IF AOPTIONI EQUAL '1' OR '3' OR '4'
  4635         NEXT SENTENCE
  4636     ELSE
  4637         GO TO 0400-END-OF-SEARCH.
  4638
  4639     IF WS-ERPYAJ-BROWSE-STARTED
  4640
  4641* EXEC CICS ENDBR
  4642*            DATASET (WS-ERPYAJ-DSID)
  4643*            END-EXEC
  4644     MOVE 0
  4645       TO DFHEIV11
  4646*    MOVE '&2                    $   #00004399' TO DFHEIV0
  4647     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4648     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4649     MOVE X'2020233030303034333939' TO DFHEIV0(25:11)
  4650     CALL 'kxdfhei1' USING DFHEIV0,
  4651           WS-ERPYAJ-DSID,
  4652           DFHEIV11,
  4653           DFHEIV99
  4654     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4655         MOVE +0 TO WS-ERPYAJ-BROWSE-SW.
  4656
  4657*    NOTE *******************************************************
  4658*         *                                                     *
  4659*         *      BROWSE THE CHECK-MAINTENANCE FILE FOR ANY      *
  4660*         *  PENDING PAYMENTS FOR RELEASE                       *
  4661*         *                                                     *
  4662*         *      WHEN A PAYMENT IS PENDING, GENERATE A CHECK    *
  4663*         *  QUEUE RECORD FOR RELEASE.                          *
  4664*         *                                                     *
  4665*         *******************************************************.
  4666
  4667     MOVE LOW-VALUES             TO  WS-CHECK-MAINT-KEY.
  4668     MOVE PI-COMPANY-CD          TO  WS-CHK-COMPANY-CD.
  4669
  4670 0265-STARTBR-ERCHEK.
  4671
  4672     IF WS-ERCHEK-BROWSE-NOT-STARTED
  4673
  4674* EXEC CICS STARTBR
  4675*            DATASET (WS-ERCHEK-DSID)
  4676*            RIDFLD  (WS-CHECK-MAINT-KEY)
  4677*            GTEQ
  4678*            END-EXEC.
  4679     MOVE 0
  4680       TO DFHEIV11
  4681*    MOVE '&,         G          &   #00004420' TO DFHEIV0
  4682     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4683     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4684     MOVE X'2020233030303034343230' TO DFHEIV0(25:11)
  4685     CALL 'kxdfhei1' USING DFHEIV0,
  4686           WS-ERCHEK-DSID,
  4687           WS-CHECK-MAINT-KEY,
  4688           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL686.cbl
  4689           DFHEIV11,
  4690           DFHEIV99
  4691     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4692
  4693
  4694     MOVE +1 TO WS-ERCHEK-BROWSE-SW.
  4695
  4696
  4697* EXEC CICS HANDLE CONDITION
  4698*        ENDFILE    (0400-END-OF-SEARCH)
  4699*        END-EXEC.
  4700*    MOVE '"$''                   ! $ #00004428' TO DFHEIV0
  4701     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  4702     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4703     MOVE X'2420233030303034343238' TO DFHEIV0(25:11)
  4704     CALL 'kxdfhei1' USING DFHEIV0
  4705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4706
  4707
  4708 0270-READNEXT-ERCHEK.
  4709
  4710
  4711* EXEC CICS READNEXT
  4712*        DATASET (WS-ERCHEK-DSID)
  4713*        RIDFLD  (WS-CHECK-MAINT-KEY)
  4714*        SET     (ADDRESS OF CHECK-RECORDS) END-EXEC.
  4715     MOVE 0
  4716       TO DFHEIV11
  4717*    MOVE '&.S                   )   #00004434' TO DFHEIV0
  4718     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4719     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4720     MOVE X'2020233030303034343334' TO DFHEIV0(25:11)
  4721     CALL 'kxdfhei1' USING DFHEIV0,
  4722           WS-ERCHEK-DSID,
  4723           DFHEIV20,
  4724           DFHEIV99,
  4725           WS-CHECK-MAINT-KEY,
  4726           DFHEIV99,
  4727           DFHEIV11,
  4728           DFHEIV99,
  4729           DFHEIV99
  4730     SET ADDRESS OF CHECK-RECORDS TO
  4731         DFHEIV20
  4732     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4733
  4734
  4735     IF WS-CHK-COMPANY-CD NOT = PI-COMPANY-CD
  4736         GO TO 0400-END-OF-SEARCH.
  4737
  4738     IF ACARRL GREATER ZERO
  4739         IF CH-CARRIER NOT = ACARRI
  4740             GO TO 0270-READNEXT-ERCHEK.
  4741
  4742     IF AGROUPL GREATER ZERO
  4743        IF CH-GROUPING NOT = AGROUPI
  4744            GO TO 0270-READNEXT-ERCHEK.
  4745
  4746     IF ASTATL GREATER ZERO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL686.cbl
  4747        IF CH-STATE NOT = ASTATI
  4748            GO TO 0270-READNEXT-ERCHEK.
  4749
  4750     IF AACCTL GREATER ZERO
  4751        IF CH-ACCOUNT NOT = AACCTI
  4752            GO TO 0270-READNEXT-ERCHEK.
  4753
  4754     IF ABYL  GREATER ZERO
  4755        IF CH-RECORDED-BY NOT = ABYI
  4756            GO TO 0270-READNEXT-ERCHEK.
  4757
  4758     IF AAMTL GREATER ZERO
  4759        IF CH-AMOUNT-PAID LESS PI-CHECK-AMOUNT
  4760             NEXT SENTENCE
  4761           ELSE
  4762             GO TO 0270-READNEXT-ERCHEK.
  4763
  4764     MOVE ZERO               TO PI-CERT-SW.
  4765
  4766     IF ZERO = CERTO01L AND CERTO02L AND CERTO03L AND
  4767               CERTO04L AND CERTO05L AND CERTO06L AND
  4768               CERTO07L AND CERTO08L AND CERTO09L AND
  4769               CERTO10L AND CERTO11L AND CERTO12L AND
  4770               CERTO13L AND CERTO14L AND CERTO15L
  4771          MOVE +1           TO PI-CERT-SW
  4772       ELSE
  4773     IF CERTO01I       = CH-CERT-NO     AND
  4774        BIN-EFFDT (1)  = CH-CERT-EFF-DT
  4775          MOVE +1           TO PI-CERT-SW
  4776      ELSE
  4777     IF CERTO02I       = CH-CERT-NO     AND
  4778        BIN-EFFDT (2)  = CH-CERT-EFF-DT
  4779          MOVE +1           TO PI-CERT-SW
  4780      ELSE
  4781     IF CERTO03I       = CH-CERT-NO     AND
  4782        BIN-EFFDT (3)  = CH-CERT-EFF-DT
  4783          MOVE +1           TO PI-CERT-SW
  4784      ELSE
  4785     IF CERTO04I       = CH-CERT-NO     AND
  4786        BIN-EFFDT (4)  = CH-CERT-EFF-DT
  4787          MOVE +1           TO PI-CERT-SW
  4788      ELSE
  4789     IF CERTO05I       = CH-CERT-NO     AND
  4790        BIN-EFFDT (5)  = CH-CERT-EFF-DT
  4791          MOVE +1           TO PI-CERT-SW
  4792      ELSE
  4793     IF CERTO06I       = CH-CERT-NO     AND
  4794        BIN-EFFDT (6)  = CH-CERT-EFF-DT
  4795          MOVE +1           TO PI-CERT-SW
  4796      ELSE
  4797     IF CERTO07I       = CH-CERT-NO     AND
  4798        BIN-EFFDT (7)  = CH-CERT-EFF-DT
  4799          MOVE +1           TO PI-CERT-SW
  4800      ELSE
  4801     IF CERTO08I       = CH-CERT-NO     AND
  4802        BIN-EFFDT (8)  = CH-CERT-EFF-DT
  4803          MOVE +1           TO PI-CERT-SW
  4804      ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL686.cbl
  4805     IF CERTO09I       = CH-CERT-NO     AND
  4806        BIN-EFFDT (9)  = CH-CERT-EFF-DT
  4807          MOVE +1           TO PI-CERT-SW
  4808      ELSE
  4809     IF CERTO10I       = CH-CERT-NO     AND
  4810        BIN-EFFDT (10) = CH-CERT-EFF-DT
  4811          MOVE +1           TO PI-CERT-SW
  4812      ELSE
  4813     IF CERTO11I       = CH-CERT-NO     AND
  4814        BIN-EFFDT (11) = CH-CERT-EFF-DT
  4815          MOVE +1           TO PI-CERT-SW
  4816      ELSE
  4817     IF CERTO12I       = CH-CERT-NO     AND
  4818        BIN-EFFDT (12) = CH-CERT-EFF-DT
  4819          MOVE +1           TO PI-CERT-SW
  4820      ELSE
  4821     IF CERTO13I       = CH-CERT-NO     AND
  4822        BIN-EFFDT (13) = CH-CERT-EFF-DT
  4823          MOVE +1           TO PI-CERT-SW
  4824      ELSE
  4825     IF CERTO14I       = CH-CERT-NO     AND
  4826        BIN-EFFDT (14) = CH-CERT-EFF-DT
  4827          MOVE +1           TO PI-CERT-SW
  4828      ELSE
  4829     IF CERTO15I       = CH-CERT-NO     AND
  4830        BIN-EFFDT (15) = CH-CERT-EFF-DT
  4831          MOVE +1           TO PI-CERT-SW.
  4832
  4833     IF PI-CERT-NOT-MATCHED
  4834         GO TO 0270-READNEXT-ERCHEK.
  4835
  4836     IF CH-MAINT-CHECK
  4837         IF AOPTIONI EQUAL '1' OR '4'
  4838             NEXT SENTENCE
  4839         ELSE
  4840             GO TO 0270-READNEXT-ERCHEK.
  4841
  4842     IF CH-REFUND-CHECK
  4843         IF AOPTIONI EQUAL '1' OR '3'
  4844             NEXT SENTENCE
  4845         ELSE
  4846             GO TO 0270-READNEXT-ERCHEK.
  4847
  4848     IF CH-CHECK-QUE-CONTROL  EQUAL ZEROS AND
  4849        CH-CHECK-QUE-SEQUENCE EQUAL ZEROS
  4850         NEXT SENTENCE
  4851     ELSE
  4852         GO TO 0270-READNEXT-ERCHEK.
  4853
  4854*    NOTE *******************************************************
  4855*         *                                                     *
  4856*         *      THE CHECK MAINT TRAILER HAS MET ALL OF THE     *
  4857*         *  QUALIFICATIONS FOR THIS CHECK RELEASE, NOW         *
  4858*         *  GENERATE A CHECK QUEUE RECORD.                     *
  4859*         *                                                     *
  4860*         *******************************************************.
  4861
  4862     IF CH-VOID-DT = LOW-VALUES  AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL686.cbl
  4863       NOT MANUAL-CHECK-WRITTEN
  4864         ADD +1                  TO  WS-RELEASED-COUNT
  4865         ADD CH-AMOUNT-PAID      TO  WS-RELEASED-AMOUNT.
  4866
  4867     IF EIBAID NOT = DFHPF1
  4868         GO TO 0270-READNEXT-ERCHEK.
  4869
  4870     IF WS-ERCHEK-BROWSE-STARTED
  4871
  4872* EXEC CICS ENDBR
  4873*            DATASET (WS-ERCHEK-DSID)
  4874*            END-EXEC
  4875     MOVE 0
  4876       TO DFHEIV11
  4877*    MOVE '&2                    $   #00004575' TO DFHEIV0
  4878     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4879     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4880     MOVE X'2020233030303034353735' TO DFHEIV0(25:11)
  4881     CALL 'kxdfhei1' USING DFHEIV0,
  4882           WS-ERCHEK-DSID,
  4883           DFHEIV11,
  4884           DFHEIV99
  4885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4886         MOVE +0 TO WS-ERCHEK-BROWSE-SW.
  4887
  4888
  4889* EXEC CICS READ UPDATE
  4890*        DATASET (WS-ERCHEK-DSID)
  4891*        RIDFLD  (WS-CHECK-MAINT-KEY)
  4892*        SET     (ADDRESS OF CHECK-RECORDS) END-EXEC.
  4893*    MOVE '&"S        EU         (   #00004580' TO DFHEIV0
  4894     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4895     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4896     MOVE X'2020233030303034353830' TO DFHEIV0(25:11)
  4897     CALL 'kxdfhei1' USING DFHEIV0,
  4898           WS-ERCHEK-DSID,
  4899           DFHEIV20,
  4900           DFHEIV99,
  4901           WS-CHECK-MAINT-KEY,
  4902           DFHEIV99,
  4903           DFHEIV99,
  4904           DFHEIV99
  4905     SET ADDRESS OF CHECK-RECORDS TO
  4906         DFHEIV20
  4907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4908
  4909
  4910     MOVE SPACES                 TO  CHECK-QUE.
  4911     MOVE 'CQ'                   TO  CQ-RECORD-ID.
  4912     MOVE CH-COMPANY-CD          TO  CQ-COMPANY-CD.
  4913     MOVE WS-CHECK-QUE-COUNTER   TO  CQ-CONTROL-NUMBER
  4914                                     CH-CHECK-QUE-CONTROL.
  4915     MOVE WS-CHECK-COUNTER       TO  CQ-SEQUENCE-NUMBER
  4916                                     CH-CHECK-QUE-SEQUENCE.
  4917     ADD +1                      TO  WS-CHECK-COUNTER.
  4918     MOVE 'Q'                    TO  CQ-ENTRY-TYPE.
  4919     MOVE ZERO                   TO  CQ-TIMES-PRINTED
  4920                                     CQ-PRINT-AT-HHMM.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL686.cbl
  4921     MOVE PI-CURRENT-DATE-BIN    TO  CQ-CHECK-WRITTEN-DT.
  4922     IF MANUAL-CHECK-WRITTEN
  4923         MOVE 'M'                TO  CQ-ENTRY-TYPE
  4924         MOVE +1                 TO  CQ-TIMES-PRINTED
  4925         MOVE CH-CHECK-NO        TO  CQ-CHECK-NUMBER
  4926         MOVE CH-CHECK-WRITTEN-DT TO CQ-CHECK-WRITTEN-DT.
  4927     MOVE LOW-VALUES             TO  CQ-CHECK-VOIDED-DT.
  4928     IF CH-VOID-DT NOT = LOW-VALUES
  4929         MOVE 'V'                TO  CQ-ENTRY-TYPE
  4930                                     CQ-VOID-INDICATOR
  4931         MOVE CH-VOID-DT         TO  CQ-CHECK-VOIDED-DT.
  4932     MOVE CH-CARRIER             TO  CQ-CHEK-CARRIER.
  4933     MOVE CH-GROUPING            TO  CQ-CHEK-GROUPING.
  4934     MOVE CH-STATE               TO  CQ-CHEK-STATE.
  4935     MOVE CH-ACCOUNT             TO  CQ-CHEK-ACCOUNT.
  4936     MOVE CH-SEQUENCE-NO         TO  CQ-CHEK-SEQ-NO.
  4937     MOVE CH-CERT-EFF-DT         TO  CQ-CHEK-CERT-EFF-DT.
  4938     MOVE CH-CERT-NO             TO  CQ-CHEK-CERT-NO.
  4939     MOVE CH-COMP-FIN-RESP       TO  CQ-CHEK-FIN-RESP.
  4940     MOVE CH-CHECK-NO            TO  CQ-CHECK-NUMBER.
  4941
  4942     IF CH-REFUND-CHECK
  4943         MOVE '2'                TO  CQ-PAYMENT-TYPE
  4944     ELSE
  4945         MOVE '3'                TO  CQ-PAYMENT-TYPE.
  4946
  4947     MOVE CH-AMOUNT-PAID         TO  CQ-CHECK-AMOUNT.
  4948     MOVE CH-RECORDED-BY         TO  CQ-CHECK-BY-USER.
  4949     MOVE +6860                  TO  CQ-LAST-UPDATED-BY.
  4950     MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  4951     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4952     MOVE WS-ERCHKQ-DSID         TO  JP-FILE-ID.
  4953
  4954
  4955* EXEC CICS WRITE
  4956*        DATASET (WS-ERCHKQ-DSID)
  4957*        FROM    (CHECK-QUE)
  4958*        RIDFLD  (CQ-CONTROL-PRIMARY) END-EXEC.
  4959     MOVE LENGTH OF
  4960      CHECK-QUE
  4961       TO DFHEIV11
  4962*    MOVE '&$ L                  ''   #00004629' TO DFHEIV0
  4963     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4964     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4965     MOVE X'2020233030303034363239' TO DFHEIV0(25:11)
  4966     CALL 'kxdfhei1' USING DFHEIV0,
  4967           WS-ERCHKQ-DSID,
  4968           CHECK-QUE,
  4969           DFHEIV11,
  4970           CQ-CONTROL-PRIMARY,
  4971           DFHEIV99,
  4972           DFHEIV99
  4973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4974
  4975
  4976     PERFORM 8400-LOG-JOURNAL-RECORD.
  4977
  4978     MOVE CHECK-RECORDS          TO  JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL686.cbl
  4979     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4980     MOVE WS-ERCHEK-DSID         TO  JP-FILE-ID.
  4981
  4982
  4983* EXEC CICS REWRITE
  4984*        DATASET (WS-ERCHEK-DSID)
  4985*        FROM    (CHECK-RECORDS) END-EXEC.
  4986     MOVE LENGTH OF
  4987      CHECK-RECORDS
  4988       TO DFHEIV11
  4989*    MOVE '&& L                  %   #00004640' TO DFHEIV0
  4990     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4991     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4992     MOVE X'2020233030303034363430' TO DFHEIV0(25:11)
  4993     CALL 'kxdfhei1' USING DFHEIV0,
  4994           WS-ERCHEK-DSID,
  4995           CHECK-RECORDS,
  4996           DFHEIV11,
  4997           DFHEIV99
  4998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4999
  5000
  5001     PERFORM 8400-LOG-JOURNAL-RECORD.
  5002
  5003     GO TO 0265-STARTBR-ERCHEK.
  5004
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL686.cbl
  5006
  5007 0280-OPTION-5.
  5008
  5009     IF PI-PROCESSOR-ID  =  'LGXX'
  5010         GO TO 0281-CONTINUE.
  5011
  5012
  5013* EXEC CICS READQ TS
  5014*        QUEUE  (QID)
  5015*        INTO   (SECURITY-CONTROL)
  5016*        LENGTH (SC-COMM-LENGTH)
  5017*        ITEM   (SC-ITEM)
  5018*    END-EXEC.
  5019*    MOVE '*$II   L              ''   #00004655' TO DFHEIV0
  5020     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  5021     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5022     MOVE X'2020233030303034363535' TO DFHEIV0(25:11)
  5023     CALL 'kxdfhei1' USING DFHEIV0,
  5024           QID,
  5025           SECURITY-CONTROL,
  5026           SC-COMM-LENGTH,
  5027           SC-ITEM,
  5028           DFHEIV99,
  5029           DFHEIV99
  5030     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5031
  5032
  5033     MOVE SC-CREDIT-DISPLAY (7)  TO PI-DISPLAY-CAP.
  5034     MOVE SC-CREDIT-UPDATE  (7)  TO PI-MODIFY-CAP.
  5035
  5036     IF NOT MODIFY-CAP
  5037         MOVE 'READ'             TO  SM-READ
  5038         PERFORM 9995-SECURITY-VIOLATION
  5039         MOVE ER-0070            TO EMI-ERROR
  5040         PERFORM 9900-ERROR-FORMAT
  5041         GO TO 8100-SEND-INITIAL-MAP.
  5042
  5043 0281-CONTINUE.
  5044     MOVE LOW-VALUES             TO  WS-COMCK-MAINT-KEY.
  5045     MOVE PI-COMPANY-CD          TO  WS-CMK-COMPANY-CD.
  5046
  5047 0285-STARTBR-ERCMCK.
  5048
  5049
  5050* EXEC CICS STARTBR
  5051*        DATASET (WS-ERCMCK-DSID)
  5052*        RIDFLD  (WS-COMCK-MAINT-KEY)
  5053*        GTEQ
  5054*    END-EXEC.
  5055     MOVE 0
  5056       TO DFHEIV11
  5057*    MOVE '&,         G          &   #00004678' TO DFHEIV0
  5058     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5059     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5060     MOVE X'2020233030303034363738' TO DFHEIV0(25:11)
  5061     CALL 'kxdfhei1' USING DFHEIV0,
  5062           WS-ERCMCK-DSID,
  5063           WS-COMCK-MAINT-KEY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL686.cbl
  5064           DFHEIV99,
  5065           DFHEIV11,
  5066           DFHEIV99
  5067     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5068
  5069
  5070     MOVE +1  TO  WS-ERCMCK-BROWSE-SW.
  5071
  5072
  5073* EXEC CICS HANDLE CONDITION
  5074*        ENDFILE    (0400-END-OF-SEARCH)
  5075*        END-EXEC.
  5076*    MOVE '"$''                   ! % #00004686' TO DFHEIV0
  5077     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  5078     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5079     MOVE X'2520233030303034363836' TO DFHEIV0(25:11)
  5080     CALL 'kxdfhei1' USING DFHEIV0
  5081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5082
  5083
  5084 0290-READNEXT-ERCMCK.
  5085
  5086
  5087* EXEC CICS READNEXT
  5088*        DATASET (WS-ERCMCK-DSID)
  5089*        RIDFLD  (WS-COMCK-MAINT-KEY)
  5090*        SET     (ADDRESS OF COMM-CHECK-RECORDS) END-EXEC.
  5091     MOVE 0
  5092       TO DFHEIV11
  5093*    MOVE '&.S                   )   #00004692' TO DFHEIV0
  5094     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  5095     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  5096     MOVE X'2020233030303034363932' TO DFHEIV0(25:11)
  5097     CALL 'kxdfhei1' USING DFHEIV0,
  5098           WS-ERCMCK-DSID,
  5099           DFHEIV20,
  5100           DFHEIV99,
  5101           WS-COMCK-MAINT-KEY,
  5102           DFHEIV99,
  5103           DFHEIV11,
  5104           DFHEIV99,
  5105           DFHEIV99
  5106     SET ADDRESS OF COMM-CHECK-RECORDS TO
  5107         DFHEIV20
  5108     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5109
  5110
  5111     IF WS-CMK-COMPANY-CD NOT = PI-COMPANY-CD
  5112         GO TO 0400-END-OF-SEARCH.
  5113
  5114     IF ACARRL GREATER ZERO
  5115         IF CK-CARRIER NOT = ACARRI
  5116             GO TO 0290-READNEXT-ERCMCK.
  5117
  5118     IF AGROUPL GREATER ZERO
  5119         IF CK-GROUPING NOT = AGROUPI
  5120             GO TO 0290-READNEXT-ERCMCK.
  5121
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL686.cbl
  5122     IF ABYL GREATER ZERO
  5123         IF CK-RECORDED-BY NOT = ABYI
  5124             GO TO 0290-READNEXT-ERCMCK.
  5125
  5126     IF AAMTL GREATER ZERO
  5127         IF CK-AMOUNT-PAID LESS PI-CHECK-AMOUNT
  5128             NEXT SENTENCE
  5129           ELSE
  5130             GO TO 0290-READNEXT-ERCMCK.
  5131
  5132     IF CK-VOID-DT NOT = LOW-VALUES
  5133         GO TO 0290-READNEXT-ERCMCK.
  5134
  5135     IF CK-QUE-CONTROL-NUMBER  EQUAL ZEROS AND
  5136        CK-QUE-SEQ-NO          EQUAL ZEROS
  5137            NEXT SENTENCE
  5138     ELSE
  5139         GO TO 0290-READNEXT-ERCMCK.
  5140
  5141*    NOTE *******************************************************
  5142*         *                                                     *
  5143*         *      THE CHECK MAINT TRAILER HAS MET ALL OF THE     *
  5144*         *  QUALIFICATIONS FOR THIS CHECK RELEASE, NOW         *
  5145*         *  GENERATE A CHECK QUEUE RECORD.                     *
  5146*         *                                                     *
  5147*         *******************************************************.
  5148
  5149     IF AOPTIONI  IS EQUAL TO '6'
  5150        IF CK-ACH-PAYMENT IS EQUAL TO 'P'
  5151           CONTINUE
  5152        ELSE
  5153           GO TO 0290-READNEXT-ERCMCK.
  5154
  5155     IF AOPTIONI  IS EQUAL TO '5'
  5156        IF CK-ACH-PAYMENT IS EQUAL TO 'P'
  5157           GO TO 0290-READNEXT-ERCMCK
  5158        ELSE
  5159           CONTINUE.
  5160
  5161     IF NOT CK-TEXT
  5162         ADD +1                  TO  WS-RELEASED-COUNT.
  5163     ADD CK-AMOUNT-PAID          TO  WS-RELEASED-AMOUNT.
  5164
  5165     IF EIBAID NOT = DFHPF1
  5166         GO TO 0290-READNEXT-ERCMCK.
  5167
  5168
  5169* EXEC CICS ENDBR
  5170*        DATASET (WS-ERCMCK-DSID)
  5171*        END-EXEC.
  5172     MOVE 0
  5173       TO DFHEIV11
  5174*    MOVE '&2                    $   #00004754' TO DFHEIV0
  5175     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5176     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5177     MOVE X'2020233030303034373534' TO DFHEIV0(25:11)
  5178     CALL 'kxdfhei1' USING DFHEIV0,
  5179           WS-ERCMCK-DSID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL686.cbl
  5180           DFHEIV11,
  5181           DFHEIV99
  5182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5183
  5184
  5185     MOVE +0  TO  WS-ERCMCK-BROWSE-SW.
  5186
  5187
  5188* EXEC CICS READ UPDATE
  5189*        DATASET (WS-ERCMCK-DSID)
  5190*        RIDFLD  (WS-COMCK-MAINT-KEY)
  5191*        SET     (ADDRESS OF COMM-CHECK-RECORDS) END-EXEC.
  5192*    MOVE '&"S        EU         (   #00004760' TO DFHEIV0
  5193     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5194     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5195     MOVE X'2020233030303034373630' TO DFHEIV0(25:11)
  5196     CALL 'kxdfhei1' USING DFHEIV0,
  5197           WS-ERCMCK-DSID,
  5198           DFHEIV20,
  5199           DFHEIV99,
  5200           WS-COMCK-MAINT-KEY,
  5201           DFHEIV99,
  5202           DFHEIV99,
  5203           DFHEIV99
  5204     SET ADDRESS OF COMM-CHECK-RECORDS TO
  5205         DFHEIV20
  5206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5207
  5208
  5209     MOVE SPACES                 TO  COMMISSION-CHECK-QUE.
  5210     MOVE 'MQ'                   TO  MQ-RECORD-ID.
  5211     MOVE CK-COMPANY-CD          TO  MQ-COMPANY-CD
  5212                                     MQ-COMPANY-CD-A1.
  5213     MOVE WS-CHECK-QUE-COUNTER   TO  MQ-CONTROL-NUMBER
  5214                                     CK-QUE-CONTROL-NUMBER
  5215                                     MQ-CONTROL-NUMBER-A1.
  5216     MOVE WS-CHECK-COUNTER       TO  MQ-SEQUENCE-NUMBER
  5217                                     CK-QUE-SEQ-NO
  5218                                     MQ-SEQUENCE-NUMBER-A1.
  5219     ADD +1                      TO  WS-CHECK-COUNTER.
  5220
  5221     IF AOPTIONI  IS EQUAL TO '6'
  5222        MOVE CK-ACH-PAYMENT      TO  MQ-ENTRY-TYPE
  5223     ELSE
  5224        MOVE 'Q'                 TO  MQ-ENTRY-TYPE.
  5225
  5226     MOVE CK-CSR                 TO  MQ-CHEK-CSR
  5227                                     MQ-CSR-A1.
  5228     MOVE CK-CARRIER             TO  MQ-CHEK-CARRIER
  5229                                     MQ-CARRIER-A1.
  5230     MOVE CK-GROUPING            TO  MQ-CHEK-GROUPING
  5231                                     MQ-GROUPING-A1.
  5232     MOVE CK-PAYEE               TO  MQ-CHEK-PAYEE
  5233                                     MQ-PAYEE-A1.
  5234     MOVE CK-PAYEE-SEQ           TO  MQ-CHEK-PAYEE-SEQ
  5235                                     MQ-PAYEE-SEQ-A1.
  5236     MOVE CK-SEQUENCE-NO         TO  MQ-CHEK-SEQ-NO.
  5237     MOVE CK-CHECK-NO            TO  MQ-CHECK-NUMBER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL686.cbl
  5238     MOVE CK-RECORD-TYPE         TO  MQ-RECORD-TYPE.
  5239     MOVE CK-PAYEE-INFO          TO  MQ-PAYEE-INFO.
  5240     MOVE ZERO                   TO  MQ-TIMES-PRINTED
  5241                                     MQ-PRINT-AT-HHMM.
  5242     MOVE CK-AMOUNT-PAID         TO  MQ-CHECK-AMOUNT.
  5243     MOVE PI-CURRENT-DATE-BIN    TO  MQ-CHECK-RELEASE-DT.
  5244     MOVE CK-RECORDED-BY         TO  MQ-CHECK-BY-USER.
  5245     MOVE EIBTIME                TO  MQ-LAST-MAINT-HHMMSS.
  5246     MOVE PI-CURRENT-DATE-BIN    TO  MQ-LAST-MAINT-DT.
  5247     MOVE 'E686'                 TO  MQ-LAST-MAINT-BY.
  5248     MOVE CK-AR-STATEMENT-DT     TO  MQ-AR-STATEMENT-DT.
  5249     MOVE LOW-VALUES             TO  MQ-CHECK-WRITTEN-DT
  5250                                     MQ-VOID-DT.
  5251     MOVE COMMISSION-CHECK-QUE   TO  JP-RECORD-AREA.
  5252     MOVE 'A'                    TO  JP-RECORD-TYPE.
  5253     MOVE WS-ERCMKQ-DSID         TO  JP-FILE-ID.
  5254     MOVE +1                     TO  WS-NDX.
  5255
  5256 0290-LOOP.
  5257
  5258     IF WS-NDX GREATER THAN 15
  5259         GO TO 0300-LOOP-EXIT.
  5260
  5261     IF CK-TEXT
  5262         MOVE CK-STUB-TEXT (WS-NDX)  TO   MQ-STUB-TEXT (WS-NDX)
  5263         ADD  +1                     TO   WS-NDX
  5264         GO TO 0290-LOOP.
  5265
  5266     IF CK-STUB-LINE (WS-NDX) = SPACES
  5267         MOVE SPACES TO MQ-CHECK-STUB-LINE (WS-NDX)
  5268         MOVE ZEROS TO MQ-PYAJ-AMT (WS-NDX)
  5269                       MQ-PYAJ-SEQ (WS-NDX)
  5270         ADD +1     TO WS-NDX
  5271         GO TO 0290-LOOP.
  5272
  5273     MOVE CK-STUB-COMMENT (WS-NDX)    TO
  5274                    MQ-STUB-COMMENT  (WS-NDX).
  5275     MOVE CK-ACCT-AGENT (WS-NDX)      TO
  5276                    MQ-ACCT-AGENT  (WS-NDX).
  5277     MOVE CK-INVOICE (WS-NDX)    TO   MQ-INVOICE (WS-NDX).
  5278     MOVE CK-REFERENCE (WS-NDX)  TO   MQ-REFERENCE (WS-NDX).
  5279     MOVE CK-LEDGER-NO (WS-NDX)  TO   MQ-LEDGER-NO (WS-NDX).
  5280     MOVE ZEROS                  TO   MQ-PYAJ-AMT (WS-NDX).
  5281     IF CK-DETAIL-AMT (WS-NDX) NUMERIC
  5282         MOVE CK-DETAIL-AMT (WS-NDX)
  5283                                 TO   MQ-PYAJ-AMT (WS-NDX).
  5284     MOVE CK-PAYMENT-TYPE (WS-NDX)
  5285                                 TO   MQ-PAYMENT-TYPE (WS-NDX).
  5286     MOVE CK-PAYMENT-TYPE (WS-NDX)
  5287                                 TO   MQ-PYAJ-REC-TYPE (WS-NDX).
  5288     MOVE CK-LAST-MAINT-APPLIED (WS-NDX)
  5289                            TO   MQ-LAST-MAINT-APPLIED (WS-NDX).
  5290
  5291     MOVE CK-NON-AR-ITEM (WS-NDX) TO  MQ-NON-AR-ITEM (WS-NDX).
  5292
  5293     MOVE 'C'                    TO   MQ-PYAJ-REC-TYPE (WS-NDX).
  5294
  5295     MOVE CK-PYAJ-PMT-APPLIED (WS-NDX)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL686.cbl
  5296                                 TO   MQ-PYAJ-PMT-APPLIED (WS-NDX)
  5297     MOVE WS-SEQ-NO              TO   MQ-PYAJ-SEQ (WS-NDX).
  5298     ADD  +1                     TO   WS-SEQ-NO
  5299                                      WS-NDX.
  5300
  5301     GO TO 0290-LOOP.
  5302
  5303 0300-LOOP-EXIT.
  5304
  5305
  5306* EXEC CICS WRITE
  5307*        DATASET (WS-ERCMKQ-DSID)
  5308*        FROM    (COMMISSION-CHECK-QUE)
  5309*        RIDFLD  (MQ-CONTROL-PRIMARY) END-EXEC.
  5310     MOVE LENGTH OF
  5311      COMMISSION-CHECK-QUE
  5312       TO DFHEIV11
  5313*    MOVE '&$ L                  ''   #00004861' TO DFHEIV0
  5314     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5315     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5316     MOVE X'2020233030303034383631' TO DFHEIV0(25:11)
  5317     CALL 'kxdfhei1' USING DFHEIV0,
  5318           WS-ERCMKQ-DSID,
  5319           COMMISSION-CHECK-QUE,
  5320           DFHEIV11,
  5321           MQ-CONTROL-PRIMARY,
  5322           DFHEIV99,
  5323           DFHEIV99
  5324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5325
  5326
  5327     PERFORM 8400-LOG-JOURNAL-RECORD.
  5328
  5329     MOVE COMM-CHECK-RECORDS        TO  JP-RECORD-AREA.
  5330     MOVE 'C'                       TO  JP-RECORD-TYPE.
  5331     MOVE WS-ERCMCK-DSID            TO  JP-FILE-ID.
  5332
  5333
  5334* EXEC CICS REWRITE
  5335*        DATASET (WS-ERCMCK-DSID)
  5336*        FROM    (COMM-CHECK-RECORDS) END-EXEC.
  5337     MOVE LENGTH OF
  5338      COMM-CHECK-RECORDS
  5339       TO DFHEIV11
  5340*    MOVE '&& L                  %   #00004872' TO DFHEIV0
  5341     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5342     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5343     MOVE X'2020233030303034383732' TO DFHEIV0(25:11)
  5344     CALL 'kxdfhei1' USING DFHEIV0,
  5345           WS-ERCMCK-DSID,
  5346           COMM-CHECK-RECORDS,
  5347           DFHEIV11,
  5348           DFHEIV99
  5349     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5350
  5351
  5352     PERFORM 8400-LOG-JOURNAL-RECORD.
  5353
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL686.cbl
  5354     GO TO 0285-STARTBR-ERCMCK.
  5355
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL686.cbl
  5357 0400-END-OF-SEARCH.
  5358
  5359     IF WS-ERPYAJ-BROWSE-STARTED
  5360
  5361* EXEC CICS ENDBR
  5362*            DATASET (WS-ERPYAJ-DSID)
  5363*            END-EXEC.
  5364     MOVE 0
  5365       TO DFHEIV11
  5366*    MOVE '&2                    $   #00004884' TO DFHEIV0
  5367     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5368     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5369     MOVE X'2020233030303034383834' TO DFHEIV0(25:11)
  5370     CALL 'kxdfhei1' USING DFHEIV0,
  5371           WS-ERPYAJ-DSID,
  5372           DFHEIV11,
  5373           DFHEIV99
  5374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5375
  5376
  5377     IF WS-ERCHEK-BROWSE-STARTED
  5378
  5379* EXEC CICS ENDBR
  5380*            DATASET (WS-ERCHEK-DSID)
  5381*            END-EXEC.
  5382     MOVE 0
  5383       TO DFHEIV11
  5384*    MOVE '&2                    $   #00004889' TO DFHEIV0
  5385     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5386     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5387     MOVE X'2020233030303034383839' TO DFHEIV0(25:11)
  5388     CALL 'kxdfhei1' USING DFHEIV0,
  5389           WS-ERCHEK-DSID,
  5390           DFHEIV11,
  5391           DFHEIV99
  5392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5393
  5394
  5395     IF WS-ERCMCK-BROWSE-STARTED
  5396
  5397* EXEC CICS ENDBR
  5398*            DATASET (WS-ERCMCK-DSID)
  5399*            END-EXEC.
  5400     MOVE 0
  5401       TO DFHEIV11
  5402*    MOVE '&2                    $   #00004894' TO DFHEIV0
  5403     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5404     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5405     MOVE X'2020233030303034383934' TO DFHEIV0(25:11)
  5406     CALL 'kxdfhei1' USING DFHEIV0,
  5407           WS-ERCMCK-DSID,
  5408           DFHEIV11,
  5409           DFHEIV99
  5410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5411
  5412
  5413     MOVE WS-CHECK-QUE-COUNTER   TO  WS-TL1-CONTROL-GROUP.
  5414     MOVE WS-RELEASED-COUNT      TO  WS-TL1-COUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL686.cbl
  5415     MOVE WS-RELEASED-AMOUNT     TO  WS-TL1-AMOUNT.
  5416
  5417     IF WS-RELEASED-COUNT GREATER 1
  5418         MOVE 'S'                TO  WS-TL1-PLURAL
  5419      ELSE
  5420         MOVE ' '                TO  WS-TL1-PLURAL.
  5421
  5422     IF EIBAID = DFHPF1
  5423         MOVE LOW-VALUES         TO EL686AI
  5424         MOVE 'RELEASED'         TO WS-TL1-RELEASE
  5425       ELSE
  5426        IF WS-RELEASED-COUNT GREATER ZERO
  5427            MOVE 'TO BE RELEASED'   TO WS-TL1-RELEASE
  5428          ELSE
  5429            MOVE +0                 TO PI-PROC-SW
  5430            MOVE -1                 TO AOPTIONL
  5431            MOVE ER-3048            TO EMI-ERROR
  5432            PERFORM 8200-SEND-DATAONLY.
  5433
  5434     MOVE WS-TOTAL-LINE1         TO  EMI-MESSAGE-AREA (1).
  5435     MOVE WS-TOTAL-LINE2         TO  EMI-MESSAGE-AREA (2).
  5436
  5437     IF EIBAID = DFHPF1
  5438         PERFORM 7000-PRINT-CHECKS-WAITING
  5439         GO TO 0100-INITIALIZE
  5440       ELSE
  5441         MOVE +1                 TO PI-PROC-SW
  5442         MOVE -1                 TO AOPTIONL
  5443         MOVE AL-UNBON           TO AOPTIONA
  5444                                    AAMTA
  5445         MOVE AL-UABON  TO ABYA ACARRA AGROUPA ASTATA AACCTA
  5446                           CERTO01A EFFDT01A CERTO02A EFFDT02A
  5447                           CERTO03A EFFDT03A CERTO04A EFFDT04A
  5448                           CERTO05A EFFDT05A CERTO06A EFFDT06A
  5449                           CERTO07A EFFDT07A CERTO08A EFFDT08A
  5450                           CERTO09A EFFDT09A CERTO10A EFFDT10A
  5451                           CERTO11A EFFDT11A CERTO12A EFFDT12A
  5452                           CERTO13A EFFDT13A CERTO14A EFFDT14A
  5453                           CERTO15A EFFDT15A
  5454         PERFORM 8200-SEND-DATAONLY.
  5455
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL686.cbl
  5457 0910-ENQ-BUSY.
  5458
  5459*    NOTE *******************************************************
  5460*         *                                                     *
  5461*         *      IF ONE OF THE OTHER PROGRAMS (EL176 OR EL177)  *
  5462*         *  HAS EXCLUSIVE CONTROL OF THE CHECK QUEUE DSID,     *
  5463*         *  SEND A MESSAGE TO THE OPERATOR TO WAIT A FEW       *
  5464*         *  MOMENTS AND TRY AGAIN.                             *
  5465*         *                                                     *
  5466*         *******************************************************.
  5467
  5468     MOVE +395                   TO  EMI-ERROR.
  5469     MOVE -1                     TO  AOPTIONL.
  5470     PERFORM 8200-SEND-DATAONLY.
  5471
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL686.cbl
  5473 7000-PRINT-CHECKS-WAITING SECTION.
  5474
  5475     MOVE SPACES                 TO  WS-CONTROL-FILE-KEY.
  5476
  5477     MOVE PI-COMPANY-ID          TO WS-CFK-COMPANY-ID.
  5478     MOVE '1'                    TO WS-CFK-RECORD-TYPE.
  5479     MOVE ZEROS                  TO WS-CFK-SEQUENCE-NO.
  5480
  5481
  5482* EXEC CICS READ
  5483*         DATASET   (WS-ELCNTL-DSID)
  5484*         SET       (ADDRESS OF CONTROL-FILE)
  5485*         RIDFLD    (WS-CONTROL-FILE-KEY) END-EXEC.
  5486*    MOVE '&"S        E          (   #00004966' TO DFHEIV0
  5487     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5488     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5489     MOVE X'2020233030303034393636' TO DFHEIV0(25:11)
  5490     CALL 'kxdfhei1' USING DFHEIV0,
  5491           WS-ELCNTL-DSID,
  5492           DFHEIV20,
  5493           DFHEIV99,
  5494           WS-CONTROL-FILE-KEY,
  5495           DFHEIV99,
  5496           DFHEIV99,
  5497           DFHEIV99
  5498     SET ADDRESS OF CONTROL-FILE TO
  5499         DFHEIV20
  5500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5501
  5502
  5503     IF PI-COMPANY-ID = 'DMD' OR 'CID' OR 'AHL'
  5504         MOVE CF-FORMS-PRINTER-ID  TO  PI-PROCESSOR-PRINTER
  5505*        MOVE EIBTRMID       TO CF-FORMS-PRINTER-ID
  5506
  5507* EXEC CICS START
  5508*             TRANSID    (WS-PRINT-TRANS-ID)
  5509*             FROM       (PROGRAM-INTERFACE-BLOCK)
  5510*             LENGTH     (PI-COMM-LENGTH)
  5511*             TERMID     (CF-FORMS-PRINTER-ID)
  5512*        END-EXEC
  5513*    MOVE '0( LF                 0   #00004974' TO DFHEIV0
  5514     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  5515     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  5516     MOVE X'2020233030303034393734' TO DFHEIV0(25:11)
  5517     CALL 'kxdfhei1' USING DFHEIV0,
  5518           DFHEIV99,
  5519           WS-PRINT-TRANS-ID,
  5520           DFHEIV99,
  5521           PROGRAM-INTERFACE-BLOCK,
  5522           PI-COMM-LENGTH,
  5523           DFHEIV99,
  5524           DFHEIV99,
  5525           DFHEIV99,
  5526           DFHEIV99,
  5527           DFHEIV99,
  5528           DFHEIV99,
  5529           DFHEIV99,
  5530           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL686.cbl
  5531           DFHEIV99,
  5532           DFHEIV99
  5533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5534     ELSE
  5535
  5536* EXEC CICS START
  5537*             TRANSID    (WS-PRINT-TRANS-ID)
  5538*             FROM       (PROGRAM-INTERFACE-BLOCK)
  5539*             LENGTH     (PI-COMM-LENGTH)
  5540*             TERMID     (CF-FORMS-PRINTER-ID)
  5541*        END-EXEC.
  5542*    MOVE '0( LFT                0   #00004981' TO DFHEIV0
  5543     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  5544     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  5545     MOVE X'2020233030303034393831' TO DFHEIV0(25:11)
  5546     CALL 'kxdfhei1' USING DFHEIV0,
  5547           DFHEIV99,
  5548           WS-PRINT-TRANS-ID,
  5549           DFHEIV99,
  5550           PROGRAM-INTERFACE-BLOCK,
  5551           PI-COMM-LENGTH,
  5552           CF-FORMS-PRINTER-ID,
  5553           DFHEIV99,
  5554           DFHEIV99,
  5555           DFHEIV99,
  5556           DFHEIV99,
  5557           DFHEIV99,
  5558           DFHEIV99,
  5559           DFHEIV99,
  5560           DFHEIV99,
  5561           DFHEIV99
  5562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5563
  5564
  5565     GO TO 7090-EXIT.
  5566
  5567 7010-TERMID-ERROR.
  5568
  5569     MOVE 0412                   TO EMI-ERROR.
  5570     MOVE -1                     TO APFKL.
  5571     PERFORM 8200-SEND-DATAONLY.
  5572
  5573 7020-TRANS-ERROR.
  5574
  5575     MOVE 0413                   TO EMI-ERROR.
  5576     MOVE -1                     TO APFKL.
  5577     PERFORM 8200-SEND-DATAONLY.
  5578
  5579 7090-EXIT.
  5580     EXIT.
  5581
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL686.cbl
  5583 8100-SEND-INITIAL-MAP SECTION.
  5584
  5585     MOVE EIBTIME                TO  WS-TIME-WORK.
  5586
  5587     MOVE PI-CURRENT-DATE        TO  ADATEO.
  5588     MOVE WS-TIME                TO  ATIMEO.
  5589     MOVE EMI-MESSAGE-AREA (1)   TO AEMSG1O.
  5590     MOVE EMI-MESSAGE-AREA (2)   TO AEMSG2O.
  5591
  5592
  5593* EXEC CICS SEND
  5594*        FROM   (EL686AI)
  5595*        MAPSET (WS-MAPSET-NAME)
  5596*        MAP    (WS-MAP-NAME)
  5597*        CURSOR ERASE END-EXEC.
  5598     MOVE LENGTH OF
  5599      EL686AI
  5600       TO DFHEIV12
  5601     MOVE -1
  5602       TO DFHEIV11
  5603*    MOVE '8$     CT  E    H L F ,   #00005015' TO DFHEIV0
  5604     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5605     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5606     MOVE X'2020233030303035303135' TO DFHEIV0(25:11)
  5607     CALL 'kxdfhei1' USING DFHEIV0,
  5608           WS-MAP-NAME,
  5609           EL686AI,
  5610           DFHEIV12,
  5611           WS-MAPSET-NAME,
  5612           DFHEIV99,
  5613           DFHEIV99,
  5614           DFHEIV99,
  5615           DFHEIV11,
  5616           DFHEIV99,
  5617           DFHEIV99,
  5618           DFHEIV99
  5619     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5620
  5621
  5622     PERFORM 9100-RETURN-TRAN.
  5623
  5624 8100-EXIT.
  5625     EXIT.
  5626
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL686.cbl
  5628 8200-SEND-DATAONLY SECTION.
  5629
  5630     IF EMI-ERROR = ZERO
  5631         MOVE AL-PABOF           TO APF1A
  5632         MOVE AL-PADOF           TO ACOMPA
  5633      ELSE
  5634         PERFORM 9900-ERROR-FORMAT
  5635         MOVE AL-PADOF           TO APF1A
  5636         MOVE AL-PABOF           TO ACOMPA.
  5637
  5638     MOVE EIBTIME                TO  WS-TIME-WORK.
  5639
  5640     MOVE PI-CURRENT-DATE        TO ADATEO.
  5641     MOVE WS-TIME                TO ATIMEO.
  5642     MOVE EMI-MESSAGE-AREA (1)   TO AEMSG1O.
  5643     MOVE EMI-MESSAGE-AREA (2)   TO AEMSG2O.
  5644
  5645
  5646* EXEC CICS SEND DATAONLY
  5647*        FROM   (EL686AI)
  5648*        MAPSET (WS-MAPSET-NAME)
  5649*        MAP    (WS-MAP-NAME)
  5650*        CURSOR END-EXEC.
  5651     MOVE LENGTH OF
  5652      EL686AI
  5653       TO DFHEIV12
  5654     MOVE -1
  5655       TO DFHEIV11
  5656*    MOVE '8$D    CT       H L F ,   #00005044' TO DFHEIV0
  5657     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5658     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5659     MOVE X'2020233030303035303434' TO DFHEIV0(25:11)
  5660     CALL 'kxdfhei1' USING DFHEIV0,
  5661           WS-MAP-NAME,
  5662           EL686AI,
  5663           DFHEIV12,
  5664           WS-MAPSET-NAME,
  5665           DFHEIV99,
  5666           DFHEIV99,
  5667           DFHEIV99,
  5668           DFHEIV11,
  5669           DFHEIV99,
  5670           DFHEIV99,
  5671           DFHEIV99
  5672     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5673
  5674
  5675     PERFORM 9100-RETURN-TRAN.
  5676
  5677 8200-EXIT.
  5678     EXIT.
  5679
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL686.cbl
  5681 8300-SEND-TEXT SECTION.
  5682
  5683
  5684* EXEC CICS SEND TEXT
  5685*        FROM   (LOGOFF-TEXT)
  5686*        LENGTH (LOGOFF-LENGTH)
  5687*        ERASE  FREEKB END-EXEC.
  5688*    MOVE '8&      T  E F  H   F -   #00005058' TO DFHEIV0
  5689     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5690     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5691     MOVE X'2020233030303035303538' TO DFHEIV0(25:11)
  5692     CALL 'kxdfhei1' USING DFHEIV0,
  5693           LOGOFF-TEXT,
  5694           LOGOFF-LENGTH,
  5695           DFHEIV99,
  5696           DFHEIV99,
  5697           DFHEIV99,
  5698           DFHEIV99,
  5699           DFHEIV99,
  5700           DFHEIV99,
  5701           DFHEIV99,
  5702           DFHEIV99,
  5703           DFHEIV99,
  5704           DFHEIV99
  5705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5706
  5707
  5708
  5709* EXEC CICS RETURN
  5710*        END-EXEC.
  5711*    MOVE '.(                    &   #00005063' TO DFHEIV0
  5712     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5713     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5714     MOVE X'2020233030303035303633' TO DFHEIV0(25:11)
  5715     CALL 'kxdfhei1' USING DFHEIV0,
  5716           DFHEIV99,
  5717           DFHEIV99,
  5718           DFHEIV99,
  5719           DFHEIV99,
  5720           DFHEIV99
  5721     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5722
  5723
  5724 8300-EXIT.
  5725     EXIT.
  5726
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL686.cbl
  5728 8400-LOG-JOURNAL-RECORD SECTION.
  5729
  5730     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5731     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  5732
  5733*    EXEC CICS JOURNAL
  5734*        JFILEID (PI-JOURNAL-FILE-ID)
  5735*        JTYPEID (WS-JOURNAL-TYPE-ID)
  5736*        FROM    (JOURNAL-RECORD)
  5737*        LENGTH  (WS-JOURNAL-RECORD-LENGTH) END-EXEC.
  5738
  5739 8400-EXIT.
  5740     EXIT.
  5741
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL686.cbl
  5743 8500-DATE-CONVERSION SECTION.
  5744
  5745
  5746* EXEC CICS LINK
  5747*        PROGRAM  (ELDATCV)
  5748*        COMMAREA (DATE-CONVERSION-DATA)
  5749*        LENGTH   (DC-COMM-LENGTH) END-EXEC.
  5750*    MOVE '."C                   ''   #00005087' TO DFHEIV0
  5751     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5752     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5753     MOVE X'2020233030303035303837' TO DFHEIV0(25:11)
  5754     CALL 'kxdfhei1' USING DFHEIV0,
  5755           ELDATCV,
  5756           DATE-CONVERSION-DATA,
  5757           DC-COMM-LENGTH,
  5758           DFHEIV99,
  5759           DFHEIV99,
  5760           DFHEIV99
  5761     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5762
  5763
  5764 8500-EXIT.
  5765     EXIT.
  5766
  5767 8600-DEEDIT  SECTION.
  5768
  5769* EXEC CICS  BIF DEEDIT
  5770*        FIELD   (DEEDIT-FIELD)
  5771*        LENGTH  (15)
  5772*    END-EXEC.
  5773     MOVE 15
  5774       TO DFHEIV11
  5775*    MOVE '@"L                   #   #00005096' TO DFHEIV0
  5776     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5777     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5778     MOVE X'2020233030303035303936' TO DFHEIV0(25:11)
  5779     CALL 'kxdfhei1' USING DFHEIV0,
  5780           DEEDIT-FIELD,
  5781           DFHEIV11
  5782     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5783
  5784
  5785 8600-EXIT.
  5786     EXIT.
  5787
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL686.cbl
  5789 9000-RETURN-CICS SECTION.
  5790
  5791     MOVE EL005                  TO  THIS-PGM.
  5792     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5793     PERFORM 9300-XCTL.
  5794
  5795 9000-EXIT.
  5796     EXIT.
  5797
  5798 9100-RETURN-TRAN SECTION.
  5799
  5800     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  5801     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5802
  5803
  5804* EXEC CICS RETURN
  5805*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  5806*        LENGTH   (PI-COMM-LENGTH)
  5807*        TRANSID  (WS-TRANS-ID) END-EXEC.
  5808*    MOVE '.(CT                  &   #00005119' TO DFHEIV0
  5809     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5810     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5811     MOVE X'2020233030303035313139' TO DFHEIV0(25:11)
  5812     CALL 'kxdfhei1' USING DFHEIV0,
  5813           WS-TRANS-ID,
  5814           PROGRAM-INTERFACE-BLOCK,
  5815           PI-COMM-LENGTH,
  5816           DFHEIV99,
  5817           DFHEIV99
  5818     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5819
  5820
  5821 9100-EXIT.
  5822     EXIT.
  5823
  5824 9300-XCTL SECTION.
  5825
  5826     MOVE DFHENTER               TO  EIBAID.
  5827
  5828
  5829* EXEC CICS XCTL
  5830*        PROGRAM  (THIS-PGM)
  5831*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  5832*        LENGTH   (PI-COMM-LENGTH) END-EXEC.
  5833*    MOVE '.$C                   $   #00005131' TO DFHEIV0
  5834     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5835     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5836     MOVE X'2020233030303035313331' TO DFHEIV0(25:11)
  5837     CALL 'kxdfhei1' USING DFHEIV0,
  5838           THIS-PGM,
  5839           PROGRAM-INTERFACE-BLOCK,
  5840           PI-COMM-LENGTH
  5841     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5842
  5843
  5844 9300-EXIT.
  5845     EXIT.
  5846
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL686.cbl
  5848 9400-CLEAR SECTION.
  5849
  5850     MOVE PI-RETURN-TO-PROGRAM  TO  THIS-PGM.
  5851     PERFORM 9300-XCTL.
  5852
  5853 9400-EXIT.
  5854     EXIT.
  5855
  5856 9600-PGMIDERR SECTION.
  5857
  5858
  5859* EXEC CICS HANDLE CONDITION
  5860*        PGMIDERR (8300-SEND-TEXT) END-EXEC.
  5861*    MOVE '"$L                   ! & #00005150' TO DFHEIV0
  5862     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5864     MOVE X'2620233030303035313530' TO DFHEIV0(25:11)
  5865     CALL 'kxdfhei1' USING DFHEIV0
  5866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5867
  5868
  5869     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM.
  5870
  5871     MOVE EL005                  TO  THIS-PGM
  5872                                     LOGOFF-PGM.
  5873     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5874
  5875     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  5876     PERFORM 9300-XCTL.
  5877
  5878 9600-EXIT.
  5879     EXIT.
  5880
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL686.cbl
  5882 9900-ERROR-FORMAT SECTION.
  5883
  5884
  5885* EXEC CICS LINK
  5886*        PROGRAM  (EL001)
  5887*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  5888*        LENGTH   (EMI-COMM-LENGTH) END-EXEC.
  5889*    MOVE '."C                   ''   #00005168' TO DFHEIV0
  5890     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5891     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5892     MOVE X'2020233030303035313638' TO DFHEIV0(25:11)
  5893     CALL 'kxdfhei1' USING DFHEIV0,
  5894           EL001,
  5895           ERROR-MESSAGE-INTERFACE-BLOCK,
  5896           EMI-COMM-LENGTH,
  5897           DFHEIV99,
  5898           DFHEIV99,
  5899           DFHEIV99
  5900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5901
  5902
  5903 9900-EXIT.
  5904     EXIT.
  5905
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL686.cbl
  5907 9990-ERROR SECTION.
  5908
  5909     MOVE DFHEIBLK TO EMI-LINE1.
  5910
  5911* EXEC CICS LINK
  5912*        PROGRAM  (EL004)
  5913*        COMMAREA (EMI-LINE1)
  5914*        LENGTH   (72) END-EXEC.
  5915     MOVE 72
  5916       TO DFHEIV11
  5917*    MOVE '."C                   ''   #00005180' TO DFHEIV0
  5918     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5919     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5920     MOVE X'2020233030303035313830' TO DFHEIV0(25:11)
  5921     CALL 'kxdfhei1' USING DFHEIV0,
  5922           EL004,
  5923           EMI-LINE1,
  5924           DFHEIV11,
  5925           DFHEIV99,
  5926           DFHEIV99,
  5927           DFHEIV99
  5928     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5929
  5930     MOVE -1 TO APFKL.
  5931     PERFORM 8200-SEND-DATAONLY.
  5932     GO TO 9100-RETURN-TRAN.
  5933
  5934 9990-EXIT.
  5935     EXIT.
  5936
  5937 9995-SECURITY-VIOLATION.
  5938*    COPY ELCSCTP.
  5939******************************************************************
  5940*                                                                *
  5941*                            ELCSCTP                             *
  5942*                            VMOD=2.001                          *
  5943*                                                                *
  5944*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5945******************************************************************
  5946
  5947
  5948     MOVE EIBDATE          TO SM-JUL-DATE.
  5949     MOVE EIBTRMID         TO SM-TERMID.
  5950     MOVE THIS-PGM         TO SM-PGM.
  5951     MOVE EIBTIME          TO TIME-IN.
  5952     MOVE TIME-OUT         TO SM-TIME.
  5953     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5954
  5955
  5956* EXEC CICS LINK
  5957*         PROGRAM  ('EL003')
  5958*         COMMAREA (SECURITY-MESSAGE)
  5959*         LENGTH   (80)
  5960*    END-EXEC.
  5961     MOVE 'EL003' TO DFHEIV1
  5962     MOVE 80
  5963       TO DFHEIV11
  5964*    MOVE '."C                   ''   #00005209' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL686.cbl
  5965     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5966     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5967     MOVE X'2020233030303035323039' TO DFHEIV0(25:11)
  5968     CALL 'kxdfhei1' USING DFHEIV0,
  5969           DFHEIV1,
  5970           SECURITY-MESSAGE,
  5971           DFHEIV11,
  5972           DFHEIV99,
  5973           DFHEIV99,
  5974           DFHEIV99
  5975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5976
  5977
  5978******************************************************************
  5979
  5980
  5981 9995-EXIT.
  5982     EXIT.
  5983
  5984 9999-LAST-PARAGRAPH SECTION.
  5985
  5986
  5987* GOBACK.
  5988     MOVE '9%                    "   ' TO DFHEIV0
  5989     MOVE 'EL686' TO DFHEIV1
  5990     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5991     GOBACK.
  5992
  5993
  5994 9999-DFHBACK SECTION.
  5995     MOVE '9%                    "   ' TO DFHEIV0
  5996     MOVE 'EL686' TO DFHEIV1
  5997     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5998     GOBACK.
  5999 9999-DFHEXIT.
  6000     IF DFHEIGDJ EQUAL 0001
  6001         NEXT SENTENCE
  6002     ELSE IF DFHEIGDJ EQUAL 2
  6003         GO TO 9600-PGMIDERR,
  6004               0140-NOT-FOUND,
  6005               0400-END-OF-SEARCH,
  6006               0910-ENQ-BUSY,
  6007               7010-TERMID-ERROR,
  6008               7020-TRANS-ERROR,
  6009               9990-ERROR
  6010         DEPENDING ON DFHEIGDI
  6011     ELSE IF DFHEIGDJ EQUAL 3
  6012         GO TO 0260-END-OF-ERPYAJ
  6013         DEPENDING ON DFHEIGDI
  6014     ELSE IF DFHEIGDJ EQUAL 4
  6015         GO TO 0400-END-OF-SEARCH
  6016         DEPENDING ON DFHEIGDI
  6017     ELSE IF DFHEIGDJ EQUAL 5
  6018         GO TO 0400-END-OF-SEARCH
  6019         DEPENDING ON DFHEIGDI
  6020     ELSE IF DFHEIGDJ EQUAL 6
  6021         GO TO 8300-SEND-TEXT
  6022         DEPENDING ON DFHEIGDI.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL686.cbl
  6023     MOVE '9%                    "   ' TO DFHEIV0
  6024     MOVE 'EL686' TO DFHEIV1
  6025     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6026     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5252     Code:       15323
