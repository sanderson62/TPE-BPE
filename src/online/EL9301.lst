* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL9301.cbl
* Options: int("EL9301.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL9301.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL9301.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL9301.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL9301.
     4*                            VMOD=2.006
     5
     6 AUTHOR.     LOGIC,INC.
     7             DALLAS, TEXAS.
     8
     9 DATE-COMPILED. 02-Nov-12 23:15.
    10 SECURITY.   *****************************************************
    11             *                                                   *
    12             *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    13             *                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL9301.cbl
    14             *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    15             *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    16             *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    17             *                                                   *
    18             *****************************************************
    19
    20 REMARKS. TRANSACTION - EXI2 - NEW BUSINESS - DATA ENTRY (ISSUES).
    21
    22 ENVIRONMENT DIVISION.
    23
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL9301.cbl
    25 DATA DIVISION.
    26 WORKING-STORAGE SECTION.
    27 01  DFH-START PIC X(04).
    28 77  FILLER  PIC X(32)  VALUE '*** PAN EL9301    PANLVL 012 ***'.
    29 77  FILLER  PIC X(32)  VALUE '********************************'.
    30 77  FILLER  PIC X(32)  VALUE '*    EL9301 WORKING STORAGE    *'.
    31 77  FILLER  PIC X(32)  VALUE '******VMOD=2.006****************'.
    32
    33*                            COPY ELCSCTM.
    34******************************************************************
    35*                                                                *
    36*                                                                *
    37*                            ELCSCTM                             *
    38*                            VMOD=2.001                          *
    39*                                                                *
    40*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    41*                                                                *
    42******************************************************************
    43 01  SECURITY-MESSAGE.
    44     12  FILLER                          PIC X(30)
    45            VALUE '** LOGIC SECURITY VIOLATION -'.
    46     12  SM-READ                         PIC X(6).
    47     12  FILLER                          PIC X(5)
    48            VALUE ' PGM='.
    49     12  SM-PGM                          PIC X(6).
    50     12  FILLER                          PIC X(5)
    51            VALUE ' OPR='.
    52     12  SM-PROCESSOR-ID                 PIC X(4).
    53     12  FILLER                          PIC X(6)
    54            VALUE ' TERM='.
    55     12  SM-TERMID                       PIC X(4).
    56     12  FILLER                          PIC XX   VALUE SPACE.
    57     12  SM-JUL-DATE                     PIC 9(5).
    58     12  FILLER                          PIC X    VALUE SPACE.
    59     12  SM-TIME                         PIC 99.99.
    60
    61
    62*                            COPY ELCSCRTY.
    63******************************************************************
    64*                                                                *
    65*                                                                *
    66*                            ELCSCRTY                            *
    67*                            VMOD=2.001                          *
    68*                                                                *
    69*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    70*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    71*        SAVED IN PI-SECURITY-ADDRESS.                           *
    72*                                                                *
    73******************************************************************
    74 01  SECURITY-CONTROL.
    75     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    76     12  FILLER                       PIC XX    VALUE 'SC'.
    77     12  SC-CREDIT-CODES.
    78         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    79             20  SC-CREDIT-DISPLAY    PIC X.
    80             20  SC-CREDIT-UPDATE     PIC X.
    81     12  SC-CLAIMS-CODES.
    82         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL9301.cbl
    83             20  SC-CLAIMS-DISPLAY    PIC X.
    84             20  SC-CLAIMS-UPDATE     PIC X.
    85
    86 01  STANDARD-AREAS.
    87     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
    88     12  EL930B              PIC X(8)    VALUE 'EL930B  '.
    89     12  EL930C              PIC X(8)    VALUE 'EL930C  '.
    90     12  MAPSET-EL9301S      PIC X(8)    VALUE 'EL9301S '.
    91     12  SCREEN-NUMBER       PIC X(6)    VALUE 'EL930B'.
    92     12  TRANS-EXI2          PIC X(4)    VALUE 'EXI2'.
    93     12  THIS-PGM            PIC X(8)    VALUE 'EL9301  '.
    94     12  PGM-NAME            PIC X(8).
    95     12  TIME-IN             PIC S9(7).
    96     12  TIME-OUT-R  REDEFINES TIME-IN.
    97         16  FILLER          PIC X.
    98         16  TIME-OUT        PIC 99V99.
    99         16  FILLER          PIC X(2).
   100     12  LINK-EL001          PIC X(8)    VALUE 'EL001   '.
   101     12  LINK-EL004          PIC X(8)    VALUE 'EL004   '.
   102     12  XCTL-EL005          PIC X(8)    VALUE 'EL005   '.
   103     12  XCTL-EL010          PIC X(8)    VALUE 'EL010   '.
   104     12  XCTL-EL626          PIC X(8)    VALUE 'EL626   '.
   105     12  XCTL-EL930          PIC X(8)    VALUE 'EL930   '.
   106     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV '.
   107     12  FILE-ID-ERPNDT      PIC X(8)    VALUE 'ERPNDT  '.
   108     12  FILE-ID-ERPNDM      PIC X(8)    VALUE 'ERPNDM  '.
   109     12  FILE-ID-ELCERT      PIC X(8)    VALUE 'ELCERT  '.
   110     12  FILE-ID-ELCNTL      PIC X(8)    VALUE 'ELCNTL  '.
   111     12  FILE-ID-ERACCT2     PIC X(8)    VALUE 'ERACCT2 '.
   112     12  WS-CURRENT-DT       PIC X(8)    VALUE SPACES.
   113     12  WS-CURRENT-BIN-DT   PIC XX      VALUE SPACES.
   114     12  WS-TERM-IN-DAYS-SW  PIC X.
   115         88  WS-TERM-IN-DAYS-FOUND       VALUE 'Y'.
   116     12  W-TEST-ZIP          PIC X.
   117         88  W-CANADIAN-POST-CODE   VALUE 'A' THRU 'Z'.
   118
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL9301.cbl
   120
   121 01  ERROR-MESSAGES.
   122     12  ER-0000                 PIC X(4)  VALUE '0000'.
   123     12  ER-0004                 PIC X(4)  VALUE '0004'.
   124     12  ER-0008                 PIC X(4)  VALUE '0008'.
   125     12  ER-0029                 PIC X(4)  VALUE '0029'.
   126     12  ER-0070                 PIC X(4)  VALUE '0070'.
   127     12  ER-0194                 PIC X(4)  VALUE '0194'.
   128     12  ER-0195                 PIC X(4)  VALUE '0195'.
   129     12  ER-0196                 PIC X(4)  VALUE '0196'.
   130     12  ER-0197                 PIC X(4)  VALUE '0197'.
   131     12  ER-2208                 PIC X(4)  VALUE '2208'.
   132     12  ER-2209                 PIC X(4)  VALUE '2209'.
   133     12  ER-2210                 PIC X(4)  VALUE '2210'.
   134     12  ER-2212                 PIC X(4)  VALUE '2212'.
   135     12  ER-2217                 PIC X(4)  VALUE '2217'.
   136     12  ER-2218                 PIC X(4)  VALUE '2218'.
   137     12  ER-2200                 PIC X(4)  VALUE '2200'.
   138     12  ER-2220                 PIC X(4)  VALUE '2220'.
   139     12  ER-2222                 PIC X(4)  VALUE '2222'.
   140     12  ER-2223                 PIC X(4)  VALUE '2223'.
   141     12  ER-2226                 PIC X(4)  VALUE '2226'.
   142     12  ER-2227                 PIC X(4)  VALUE '2227'.
   143     12  ER-2228                 PIC X(4)  VALUE '2228'.
   144     12  ER-2240                 PIC X(4)  VALUE '2240'.
   145     12  ER-2241                 PIC X(4)  VALUE '2241'.
   146     12  ER-2247                 PIC X(4)  VALUE '2247'.
   147     12  ER-2423                 PIC X(4)  VALUE '2423'.
   148     12  ER-2424                 PIC X(4)  VALUE '2424'.
   149     12  ER-2425                 PIC X(4)  VALUE '2425'.
   150     12  ER-2426                 PIC X(4)  VALUE '2426'.
   151     12  ER-2427                 PIC X(4)  VALUE '2427'.
   152     12  ER-2428                 PIC X(4)  VALUE '2428'.
   153     12  ER-2431                 PIC X(4)  VALUE '2431'.
   154     12  ER-2433                 PIC X(4)  VALUE '2433'.
   155     12  ER-2437                 PIC X(4)  VALUE '2437'.
   156     12  ER-2429                 PIC X(4)  VALUE '2429'.
   157     12  ER-2442                 PIC X(4)  VALUE '2442'.
   158     12  ER-2471                 PIC X(4)  VALUE '2471'.
   159     12  ER-2526                 PIC X(4)  VALUE '2526'.
   160     12  ER-2529                 PIC X(4)  VALUE '2529'.
   161     12  ER-2531                 PIC X(4)  VALUE '2531'.
   162     12  ER-2532                 PIC X(4)  VALUE '2532'.
   163     12  ER-2541                 PIC X(4)  VALUE '2541'.
   164     12  ER-2542                 PIC X(4)  VALUE '2542'.
   165     12  ER-2589                 PIC X(4)  VALUE '2589'.
   166     12  ER-2591                 PIC X(4)  VALUE '2591'.
   167     12  ER-2592                 PIC X(4)  VALUE '2592'.
   168     12  ER-2593                 PIC X(4)  VALUE '2593'.
   169     12  ER-2594                 PIC X(4)  VALUE '2594'.
   170     12  ER-2629                 PIC X(4)  VALUE '2629'.
   171     12  ER-2630                 PIC X(4)  VALUE '2630'.
   172     12  ER-2635                 PIC X(4)  VALUE '2635'.
   173     12  ER-2636                 PIC X(4)  VALUE '2636'.
   174     12  ER-2651                 PIC X(4)  VALUE '2651'.
   175     12  ER-2901                 PIC X(4)  VALUE '2901'.
   176     12  ER-7400                 PIC X(4)  VALUE '7400'.
   177     12  ER-7403                 PIC X(4)  VALUE '7403'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL9301.cbl
   178     12  ER-7404                 PIC X(4)  VALUE '7404'.
   179     12  ER-7405                 PIC X(4)  VALUE '7405'.
   180     12  ER-7423                 PIC X(4)  VALUE '7423'.
   181     12  ER-7424                 PIC X(4)  VALUE '7424'.
   182     12  ER-7530                 PIC X(4)  VALUE '7530'.
   183     12  ER-7632                 PIC X(4)  VALUE '7632'.
   184     12  ER-7573                 PIC X(4)  VALUE '7573'.
   185     12  ER-7630                 PIC X(4)  VALUE '7630'.
   186     12  ER-7631                 PIC X(4)  VALUE '7631'.
   187     12  ER-7633                 PIC X(4)  VALUE '7633'.
   188     12  ER-7997                 PIC X(4)  VALUE '7997'.
   189     12  ER-7998                 PIC X(4)  VALUE '7998'.
   190     12  ER-9999                 PIC X(4)  VALUE '9999'.
   191
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL9301.cbl
   193
   194
   195 01  ACCESS-KEYS.
   196
   197     12  ERPNDT-KEY.
   198         16  ERPNDT-COMP-CD          PIC X     VALUE SPACE.
   199         16  ERPNDT-ENTRY-BATCH      PIC X(6)  VALUE SPACES.
   200         16  ERPNDT-BATCH-SEQ        PIC S9(4) VALUE +1 COMP.
   201         16  ERPNDT-BATCH-CHG-SEQ    PIC S9(4) VALUE +0 COMP.
   202
   203     12  ERPNDT-RECORD-LENGTH        PIC S9(4) COMP VALUE +585.
   204     12  ERPNDT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +608.
   205
   206     12  ELCNTL-KEY.
   207         16  ELCNTL-COMPANY-ID       PIC X(3)  VALUE SPACES.
   208         16  ELCNTL-REC-TYPE         PIC X     VALUE SPACES.
   209         16  ELCNTL-ACCESS.
   210             20  FILLER              PIC XX.
   211             20  ELCNTL-HI-BEN       PIC XX.
   212         16  ELCNTL-ST-ACCESS REDEFINES ELCNTL-ACCESS.
   213             20  ELCNTL-STATE        PIC XX.
   214             20  FILLER              PIC X.
   215             20  ELCNTL-CARRIER        PIC X.
   216         16  ELCNTL-SEQ              PIC S9(4) VALUE +0 COMP.
   217
   218     12  ELCNTL-RECORD-LENGTH        PIC S9(4) COMP VALUE +504.
   219     12  ELCNTL-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +527.
   220
   221     12  ELCERT-KEY.
   222         16  ELCERT-COMPANY-CD       PIC X.
   223         16  ELCERT-CARRIER          PIC X.
   224         16  ELCERT-GROUPING         PIC X(6).
   225         16  ELCERT-STATE            PIC XX.
   226         16  ELCERT-ACCOUNT          PIC X(10).
   227         16  ELCERT-CERT-EFF-DT      PIC XX.
   228         16  ELCERT-CERT-NO.
   229             20  ELCERT-CERT-PRIME   PIC X(10).
   230             20  ELCERT-CERT-SFX     PIC X.
   231
   232     12  ELCERT-RECORD-LENGTH        PIC S9(4) COMP VALUE +450.
   233     12  ELCERT-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +473.
   234
   235     12  ERPNDM-KEY.
   236         16  ERPNDM-COMP-CD          PIC X     VALUE SPACE.
   237         16  ERPNDM-ENTRY-BATCH      PIC X(6)  VALUE SPACES.
   238         16  ERPNDM-BATCH-SEQ        PIC S9(4) VALUE +1 COMP.
   239         16  ERPNDM-BATCH-CHG-SEQ    PIC S9(4) VALUE +0 COMP.
   240
   241     12  ERPNDM-RECORD-LENGTH        PIC S9(4) COMP VALUE +250.
   242     12  ERPNDM-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +273.
   243
   244     12  ERACCT-KEY.
   245         16  ERACCT-COMP-KEY.
   246             20  ERACCT-CO       PIC X     VALUE SPACES.
   247             20  ERACCT-CARRIER  PIC X     VALUE SPACES.
   248             20  ERACCT-GROUPING PIC X(6)  VALUE SPACES.
   249             20  ERACCT-STATE    PIC XX    VALUE SPACES.
   250             20  ERACCT-ACCOUNT  PIC X(10) VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL9301.cbl
   251         16  ERACCT-EXP-DATE     PIC XX    VALUE SPACES.
   252         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   253     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   254
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL9301.cbl
   256
   257 01  WORK-AREA.
   258
   259     12  DEEDIT-FIELD            PIC X(15).
   260     12  FILLER REDEFINES DEEDIT-FIELD.
   261         16  FILLER              PIC X(4).
   262         16  DEEDIT-FIELD-X11    PIC X(11).
   263     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD PIC S9(15).
   264     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD PIC S9(13)V99.
   265     12  DEEDIT-FIELD-V3 REDEFINES DEEDIT-FIELD PIC S9(12)V9(3).
   266     12  DEEDIT-FIELD-V4 REDEFINES DEEDIT-FIELD PIC S9(11)V9(4).
   267     12  DEEDIT-FIELD-V5 REDEFINES DEEDIT-FIELD PIC S9(10)V9(5).
   268
   269     12  WS-SUB                  PIC S9(4) VALUE +0  COMP.
   270     12  WS-SUB1                 PIC S9(4) VALUE +0  COMP.
   271     12  WS-SUB2                 PIC S9(4) VALUE +0  COMP.
   272     12  WS-SUB3                 PIC S9(4) VALUE +0  COMP.
   273     12  WS-COV-SUB              PIC S9(4) VALUE +0  COMP.
   274     12  WS-EDIT-SUB             PIC S9(4) VALUE +0  COMP.
   275
   276     12  WS-CALC-TERM            PIC S999V9(5) VALUE ZEROS.
   277     12  WS-CALC-TERM-R REDEFINES WS-CALC-TERM.
   278         16  WS-CALC-TERM-WHOLE  PIC S999.
   279         16  WS-CALC-TERM-REMAIN PIC SV9(5).
   280
   281     12  ERROR-SW                PIC X     VALUE SPACE.
   282         88  NO-ERROR                VALUE SPACE.
   283         88  ERRORS                  VALUE 'Y'.
   284
   285     12  WS-BROWSE-SW            PIC X     VALUE SPACE.
   286         88  BROWSE-NOT-STARTED      VALUE SPACE.
   287         88  BROWSE-STARTED          VALUE 'Y'.
   288     12  WS-FIRST-TIME-SW        PIC X     VALUE SPACE.
   289         88 FIRST-TIME               VALUE '0'.
   290         88 NOT-FIRST-TIME           VALUE '1'.
   291     12  WS-DATA-KEYED-SW        PIC X     VALUE SPACE.
   292         88  WS-DATA-NOT-KEYED       VALUE SPACE.
   293         88  WS-DATA-KEYED           VALUE 'Y'.
   294
   295     12  WS-EDITED-LF-CODE       PIC XX   VALUE ZEROS.
   296     12  WS-LF-ABBR-DESC         PIC XXX  VALUE SPACES.
   297
   298     12  WS-EDITED-AH-CODE       PIC XX   VALUE ZEROS.
   299     12  WS-AH-ABBR-DESC         PIC XXX  VALUE SPACES.
   300
   301     12  WS-BEN-CD               PIC XX   VALUE SPACES.
   302
   303     12  WS-ENTRY-CODE           PIC X     VALUE SPACE.
   304         88  WS-ENTRY-CODE-VALID   VALUE ' ' 'E' 'R' 'P'.
   305
   306     12  WS-ALL-NINES            PIC S9(7)V99 VALUE +9999999.99.
   307
   308     12  WS-MODE-CODE            PIC X     VALUE SPACE.
   309         88 WS-MODE-CODE-VALID     VALUE ' ' 'M' 'W' 'S' 'B'.
   310
   311     12  WS-KIND                 PIC XX    VALUE SPACE.
   312         88 WS-KIND-LF             VALUE 'LF'.
   313         88 WS-KIND-AH             VALUE 'AH'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL9301.cbl
   314         88 WS-KIND-PR             VALUE 'PR'.
   315         88 WS-KIND-UE             VALUE 'UE'.
   316         88 WS-KIND-DI             VALUE 'DI'.
   317         88 WS-KIND-MONTHLY        VALUE 'AH' 'UE'.
   318
   319     12  WS-JOURNAL-RECORD-LENGTH   PIC S9(4) COMP VALUE +0000.
   320
   321     12  WS-EDIT-CODE            PIC X(4)  VALUE SPACES.
   322
   323     12  WS-SAVE-INPUT-FIELDS.
   324
   325         16  WS-BAGE                 PIC 99       VALUE ZERO.
   326         16  WS-BJNT-AGE             PIC 99       VALUE ZERO.
   327         16  WS-BDAYS                PIC 999      VALUE ZERO.
   328         16  WS-BLN-TERM             PIC 999      VALUE ZERO.
   329         16  WS-BFREQ                PIC 99       VALUE ZERO.
   330         16  WS-BPHONE               PIC 9(12)    VALUE 0 COMP-3.
   331         16  WS-BAPR                 PIC S99V9(4) VALUE +0 COMP-3.
   332         16  WS-BPMT                 PIC S9(6)V99 VALUE +0 COMP-3.
   333         16  WS-BPMTS                PIC S999     VALUE +0 COMP-3.
   334         16  WS-BLIVES               PIC 9(3)      COMP-3.
   335
   336         16  WS-B-COVERAGE OCCURS 2 TIMES.
   337             20  WS-BTERM            PIC 999       COMP-3.
   338             20  WS-BCRIT-PERD       PIC 99        COMP-3.
   339             20  WS-BBEN             PIC S9(10)V99 COMP-3.
   340             20  WS-BALT-BEN     PIC S9(10)V99 COMP-3.
   341             20  WS-BPREM        PIC S9(10)V99 COMP-3.
   342             20  WS-BALT-PREM    PIC S9(07)V99 COMP-3.
   343
   344         16  WS-C-FIELDS   OCCURS 4 TIMES.
   345             20  WS-CLIVES      PIC 9(3)          COMP-3.
   346             20  WS-CREFUND1    PIC S9(7)V99      COMP-3.
   347             20  WS-CREFUND2    PIC S9(7)V99      COMP-3.
   348
   349     12  WS-CONVERTED-BIRTH  PIC XX    VALUE SPACE.
   350     12  WS-CONVERTED-EFFDT      PIC XX    VALUE SPACES.
   351     12  WS-CONVERTED-1ST-PMT-DT PIC XX    VALUE SPACES.
   352     12  WS-CONVERTED-EXPIRDT      OCCURS 2 TIMES PIC XX.
   353     12  WS-CONVERTED-CANCEL-DATES OCCURS 4 TIMES.
   354         16  WS-CONVERTED-CANDT1 PIC XX.
   355         16  WS-CONVERTED-CANDT2 PIC XX.
   356
   357     12  WS-FIRST-NAME.
   358         16  WS-1ST-INIT         PIC X.
   359         16  FILLER              PIC X(9).
   360
   361     12  WS-INITIALS.
   362         16  WS-INITIAL-1        PIC X.
   363         16  WS-INITIAL-2        PIC X.
   364
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL9301.cbl
   366
   367 01  CLASIC-WARNING.
   368     12  WARNING-LENGTH              PIC S9(4)  VALUE +124 COMP.
   369     12  WARNING-TEXT.
   370         16  FILLER                  PIC X(80)  VALUE
   371             'THIS DATA MAY HAVE PREVIOUSLY BEEN PROCESSED'.
   372         16  FILLER                  PIC X(44)  VALUE
   373             'CONTACT LOGIC INC. FOR FURTHER INFORMATION'.
   374
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL9301.cbl
   376
   377*                            COPY ELCDATE.
   378******************************************************************
   379*                                                                *
   380*                                                                *
   381*                            ELCDATE.                            *
   382*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   383*                            VMOD=2.003
   384*                                                                *
   385*                                                                *
   386*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   387*                 LENGTH = 200                                   *
   388******************************************************************
   389
   390 01  DATE-CONVERSION-DATA.
   391     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   392     12  DC-OPTION-CODE                PIC X.
   393         88  BIN-TO-GREG                VALUE ' '.
   394         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   395         88  EDIT-GREG-TO-BIN           VALUE '2'.
   396         88  YMD-GREG-TO-BIN            VALUE '3'.
   397         88  MDY-GREG-TO-BIN            VALUE '4'.
   398         88  JULIAN-TO-BIN              VALUE '5'.
   399         88  BIN-PLUS-ELAPSED           VALUE '6'.
   400         88  FIND-CENTURY               VALUE '7'.
   401         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   402         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   403         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   404         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   405         88  JULIAN-TO-BIN-3            VALUE 'C'.
   406         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   407         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   408         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   409         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   410         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   411         88  CHECK-LEAP-YEAR            VALUE 'H'.
   412         88  BIN-3-TO-GREG              VALUE 'I'.
   413         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   414         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   415         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   416         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   417         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   418         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   419         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   420         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   421         88  THREE-CHARACTER-BIN
   422                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   423         88  GREGORIAN-TO-BIN
   424                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   425         88  BIN-TO-GREGORIAN
   426                  VALUES ' ' '1' 'I' '8' 'G'.
   427         88  JULIAN-TO-BINARY
   428                  VALUES '5' 'C' 'E' 'F'.
   429     12  DC-ERROR-CODE                 PIC X.
   430         88  NO-CONVERSION-ERROR        VALUE ' '.
   431         88  DATE-CONVERSION-ERROR
   432                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   433         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL9301.cbl
   434         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   435         88  DATE-IS-INVALID            VALUE '3'.
   436         88  DATE1-GREATER-DATE2        VALUE '4'.
   437         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   438         88  DATE-INVALID-OPTION        VALUE '9'.
   439         88  INVALID-CENTURY            VALUE 'A'.
   440         88  ONLY-CENTURY               VALUE 'B'.
   441         88  ONLY-LEAP-YEAR             VALUE 'C'.
   442         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   443     12  DC-END-OF-MONTH               PIC X.
   444         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   445     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   446         88  USE-NORMAL-PROCESS         VALUE ' '.
   447         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   448         88  ADJUST-UP-100-YRS          VALUE '2'.
   449     12  FILLER                        PIC X.
   450     12  DC-CONVERSION-DATES.
   451         16  DC-BIN-DATE-1             PIC XX.
   452         16  DC-BIN-DATE-2             PIC XX.
   453         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   454         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   455                       DC-GREG-DATE-1-EDIT.
   456             20  DC-EDIT1-MONTH        PIC 99.
   457             20  SLASH1-1              PIC X.
   458             20  DC-EDIT1-DAY          PIC 99.
   459             20  SLASH1-2              PIC X.
   460             20  DC-EDIT1-YEAR         PIC 99.
   461         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   462         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   463                     DC-GREG-DATE-2-EDIT.
   464             20  DC-EDIT2-MONTH        PIC 99.
   465             20  SLASH2-1              PIC X.
   466             20  DC-EDIT2-DAY          PIC 99.
   467             20  SLASH2-2              PIC X.
   468             20  DC-EDIT2-YEAR         PIC 99.
   469         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   470         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   471                     DC-GREG-DATE-1-YMD.
   472             20  DC-YMD-YEAR           PIC 99.
   473             20  DC-YMD-MONTH          PIC 99.
   474             20  DC-YMD-DAY            PIC 99.
   475         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   476         16  DC-GREG-DATE-1-MDY-R REDEFINES
   477                      DC-GREG-DATE-1-MDY.
   478             20  DC-MDY-MONTH          PIC 99.
   479             20  DC-MDY-DAY            PIC 99.
   480             20  DC-MDY-YEAR           PIC 99.
   481         16  DC-GREG-DATE-1-ALPHA.
   482             20  DC-ALPHA-MONTH        PIC X(10).
   483             20  DC-ALPHA-DAY          PIC 99.
   484             20  FILLER                PIC XX.
   485             20  DC-ALPHA-CENTURY.
   486                 24 DC-ALPHA-CEN-N     PIC 99.
   487             20  DC-ALPHA-YEAR         PIC 99.
   488         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   489         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   490         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   491         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL9301.cbl
   492         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   493                                       PIC 9(05).
   494         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   495             20  DC-JULIAN-YEAR        PIC 99.
   496             20  DC-JULIAN-DAYS        PIC 999.
   497         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   498         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   499         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   500     12  DATE-CONVERSION-VARIBLES.
   501         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   502         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   503             20  FILLER                PIC 9(3).
   504             20  HOLD-CEN-1-CCYY.
   505                 24  HOLD-CEN-1-CC     PIC 99.
   506                 24  HOLD-CEN-1-YY     PIC 99.
   507             20  HOLD-CEN-1-MO         PIC 99.
   508             20  HOLD-CEN-1-DA         PIC 99.
   509         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   510             20  HOLD-CEN-1-R-MO       PIC 99.
   511             20  HOLD-CEN-1-R-DA       PIC 99.
   512             20  HOLD-CEN-1-R-CCYY.
   513                 24  HOLD-CEN-1-R-CC   PIC 99.
   514                 24  HOLD-CEN-1-R-YY   PIC 99.
   515             20  FILLER                PIC 9(3).
   516         16  HOLD-CENTURY-1-X.
   517             20  FILLER                PIC X(3)  VALUE SPACES.
   518             20  HOLD-CEN-1-X-CCYY.
   519                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   520                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   521             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   522             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   523         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   524             20  HOLD-CEN-1-R-X-MO     PIC XX.
   525             20  HOLD-CEN-1-R-X-DA     PIC XX.
   526             20  HOLD-CEN-1-R-X-CCYY.
   527                 24  HOLD-CEN-1-R-X-CC PIC XX.
   528                 24  HOLD-CEN-1-R-X-YY PIC XX.
   529             20  FILLER                PIC XXX.
   530         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   531         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   532         16  DC-JULIAN-DATE-1          PIC 9(07).
   533         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   534             20  DC-JULIAN-1-CCYY.
   535                 24  DC-JULIAN-1-CC    PIC 99.
   536                 24  DC-JULIAN-1-YR    PIC 99.
   537             20  DC-JULIAN-DA-1        PIC 999.
   538         16  DC-JULIAN-DATE-2          PIC 9(07).
   539         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   540             20  DC-JULIAN-2-CCYY.
   541                 24  DC-JULIAN-2-CC    PIC 99.
   542                 24  DC-JULIAN-2-YR    PIC 99.
   543             20  DC-JULIAN-DA-2        PIC 999.
   544         16  DC-GREG-DATE-A-EDIT.
   545             20  DC-EDITA-MONTH        PIC 99.
   546             20  SLASHA-1              PIC X VALUE '/'.
   547             20  DC-EDITA-DAY          PIC 99.
   548             20  SLASHA-2              PIC X VALUE '/'.
   549             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL9301.cbl
   550                 24  DC-EDITA-CENT     PIC 99.
   551                 24  DC-EDITA-YEAR     PIC 99.
   552         16  DC-GREG-DATE-B-EDIT.
   553             20  DC-EDITB-MONTH        PIC 99.
   554             20  SLASHB-1              PIC X VALUE '/'.
   555             20  DC-EDITB-DAY          PIC 99.
   556             20  SLASHB-2              PIC X VALUE '/'.
   557             20  DC-EDITB-CCYY.
   558                 24  DC-EDITB-CENT     PIC 99.
   559                 24  DC-EDITB-YEAR     PIC 99.
   560         16  DC-GREG-DATE-CYMD         PIC 9(08).
   561         16  DC-GREG-DATE-CYMD-R REDEFINES
   562                              DC-GREG-DATE-CYMD.
   563             20  DC-CYMD-CEN           PIC 99.
   564             20  DC-CYMD-YEAR          PIC 99.
   565             20  DC-CYMD-MONTH         PIC 99.
   566             20  DC-CYMD-DAY           PIC 99.
   567         16  DC-GREG-DATE-MDCY         PIC 9(08).
   568         16  DC-GREG-DATE-MDCY-R REDEFINES
   569                              DC-GREG-DATE-MDCY.
   570             20  DC-MDCY-MONTH         PIC 99.
   571             20  DC-MDCY-DAY           PIC 99.
   572             20  DC-MDCY-CEN           PIC 99.
   573             20  DC-MDCY-YEAR          PIC 99.
   574    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   575        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   576    12  DC-EL310-DATE                  PIC X(21).
   577    12  FILLER                         PIC X(28).
   578
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL9301.cbl
   580*                            COPY ELCLOGOF.
   581******************************************************************
   582*                                                                *
   583*                                                                *
   584*                            ELCLOGOF.                           *
   585*                            VMOD=2.001                          *
   586*                                                                *
   587*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   588*                                                                *
   589******************************************************************
   590 01  CLASIC-LOGOFF.
   591     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   592     12  LOGOFF-TEXT.
   593         16  FILLER          PIC X(5)    VALUE SPACES.
   594         16  LOGOFF-MSG.
   595             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   596             20  FILLER      PIC X       VALUE SPACES.
   597             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   598         16  FILLER          PIC X(80)
   599           VALUE '* YOU ARE NOW LOGGED OFF'.
   600         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   601         16  FILLER          PIC X       VALUE QUOTE.
   602         16  LOGOFF-SYS-MSG  PIC X(17)
   603           VALUE 'S CLAS-IC SYSTEM '.
   604     12  TEXT-MESSAGES.
   605         16  UNACCESS-MSG    PIC X(29)
   606             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   607         16  PGMIDERR-MSG    PIC X(17)
   608             VALUE 'PROGRAM NOT FOUND'.
   609
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL9301.cbl
   611*                            COPY ELCATTR.
   612******************************************************************
   613*                                                                *
   614*                            ELCATTR.                            *
   615*                            VMOD=2.001                          *
   616*                                                                *
   617*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   618*                                                                *
   619*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   620*                                                                *
   621*                   POS 1   P=PROTECTED                          *
   622*                           U=UNPROTECTED                        *
   623*                           S=ASKIP                              *
   624*                   POS 2   A=ALPHA/NUMERIC                      *
   625*                           N=NUMERIC                            *
   626*                   POS 3   N=NORMAL                             *
   627*                           B=BRIGHT                             *
   628*                           D=DARK                               *
   629*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   630*                           OF=MODIFIED DATA TAG OFF             *
   631*                                                                *
   632*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   633******************************************************************
   634 01  ATTRIBUTE-LIST.
   635     12  AL-PABOF            PIC X       VALUE 'Y'.
   636     12  AL-PABON            PIC X       VALUE 'Z'.
   637     12  AL-PADOF            PIC X       VALUE '%'.
   638     12  AL-PADON            PIC X       VALUE '_'.
   639     12  AL-PANOF            PIC X       VALUE '-'.
   640     12  AL-PANON            PIC X       VALUE '/'.
   641     12  AL-SABOF            PIC X       VALUE '8'.
   642     12  AL-SABON            PIC X       VALUE '9'.
   643     12  AL-SADOF            PIC X       VALUE '@'.
   644     12  AL-SADON            PIC X       VALUE QUOTE.
   645     12  AL-SANOF            PIC X       VALUE '0'.
   646     12  AL-SANON            PIC X       VALUE '1'.
   647     12  AL-UABOF            PIC X       VALUE 'H'.
   648     12  AL-UABON            PIC X       VALUE 'I'.
   649     12  AL-UADOF            PIC X       VALUE '<'.
   650     12  AL-UADON            PIC X       VALUE '('.
   651     12  AL-UANOF            PIC X       VALUE ' '.
   652     12  AL-UANON            PIC X       VALUE 'A'.
   653     12  AL-UNBOF            PIC X       VALUE 'Q'.
   654     12  AL-UNBON            PIC X       VALUE 'R'.
   655     12  AL-UNDOF            PIC X       VALUE '*'.
   656     12  AL-UNDON            PIC X       VALUE ')'.
   657     12  AL-UNNOF            PIC X       VALUE '&'.
   658     12  AL-UNNON            PIC X       VALUE 'J'.
   659
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL9301.cbl
   661*                                  COPY ELCEMIB.
   662******************************************************************
   663*                                                                *
   664*                                                                *
   665*                            ELCEMIB.                            *
   666*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   667*                            VMOD=2.005                          *
   668*                                                                *
   669*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   670*                                                                *
   671******************************************************************
   672 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   673     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   674     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   675     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   676     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   677     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   678     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   679     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   680     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   681     12  EMI-SWITCH1             PIC X        VALUE '1'.
   682         88  EMI-NO-ERRORS                    VALUE '1'.
   683         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   684         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   685     12  EMI-SWITCH2             PIC X        VALUE '1'.
   686         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   687     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   688         88  EMI-AREA1-EMPTY                  VALUE '1'.
   689         88  EMI-AREA1-FULL                   VALUE '2'.
   690     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   691         88  EMI-AREA2-EMPTY                  VALUE '1'.
   692         88  EMI-AREA2-FULL                   VALUE '2'.
   693     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   694         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   695         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   696         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   697         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   698         88  EMI-BYPASS-FATALS                VALUE 'X'.
   699     12  EMI-ERROR-LINES.
   700         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   701         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   702         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   703         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   704             20  EMI-ERR-CODES OCCURS 10 TIMES.
   705                 24  EMI-ERR-NUM         PIC X(4).
   706                 24  EMI-FILLER          PIC X.
   707                 24  EMI-SEV             PIC X.
   708                 24  FILLER              PIC X.
   709             20  FILLER                  PIC X(02).
   710     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   711         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   712             20  EMI-ERROR-NUMBER    PIC X(4).
   713             20  EMI-FILL            PIC X.
   714             20  EMI-SEVERITY        PIC X.
   715             20  FILLER              PIC X.
   716             20  EMI-ERROR-TEXT.
   717                 24  EMI-TEXT-VARIABLE   PIC X(10).
   718                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL9301.cbl
   719     12  EMI-SEVERITY-SAVE           PIC X.
   720         88  EMI-NOTE                    VALUE 'N'.
   721         88  EMI-WARNING                 VALUE 'W'.
   722         88  EMI-FORCABLE                VALUE 'F'.
   723         88  EMI-FATAL                   VALUE 'X'.
   724     12  EMI-MESSAGE-FLAG            PIC X.
   725         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   726         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   727     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   728     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   729         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   730         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   731         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   732     12  FILLER                      PIC X(137)  VALUE SPACES.
   733     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   734     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   735     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   736     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   737
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL9301.cbl
   739*                            COPY ELCINTF.
   740******************************************************************
   741*                                                                *
   742*                                                                *
   743*                            ELCINTF.                            *
   744*                            VMOD=2.017                          *
   745*                                                                *
   746*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   747*                                                                *
   748*       LENGTH = 1024                                            *
   749*                                                                *
   750******************************************************************
   751 01  PROGRAM-INTERFACE-BLOCK.
   752     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   753     12  PI-CALLING-PROGRAM              PIC X(8).
   754     12  PI-SAVED-PROGRAM-1              PIC X(8).
   755     12  PI-SAVED-PROGRAM-2              PIC X(8).
   756     12  PI-SAVED-PROGRAM-3              PIC X(8).
   757     12  PI-SAVED-PROGRAM-4              PIC X(8).
   758     12  PI-SAVED-PROGRAM-5              PIC X(8).
   759     12  PI-SAVED-PROGRAM-6              PIC X(8).
   760     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   761     12  PI-COMPANY-ID                   PIC XXX.
   762     12  PI-COMPANY-CD                   PIC X.
   763
   764     12  PI-COMPANY-PASSWORD             PIC X(8).
   765
   766     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   767
   768     12  PI-CONTROL-IN-PROGRESS.
   769         16  PI-CARRIER                  PIC X.
   770         16  PI-GROUPING                 PIC X(6).
   771         16  PI-STATE                    PIC XX.
   772         16  PI-ACCOUNT                  PIC X(10).
   773         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   774                                         PIC X(10).
   775         16  PI-CLAIM-CERT-GRP.
   776             20  PI-CLAIM-NO             PIC X(7).
   777             20  PI-CERT-NO.
   778                 25  PI-CERT-PRIME       PIC X(10).
   779                 25  PI-CERT-SFX         PIC X.
   780             20  PI-CERT-EFF-DT          PIC XX.
   781         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   782             20  PI-PLAN-CODE            PIC X(2).
   783             20  PI-REVISION-NUMBER      PIC X(3).
   784             20  PI-PLAN-EFF-DT          PIC X(2).
   785             20  PI-PLAN-EXP-DT          PIC X(2).
   786             20  FILLER                  PIC X(11).
   787         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   788             20  PI-OE-REFERENCE-1.
   789                 25  PI-OE-REF-1-PRIME   PIC X(18).
   790                 25  PI-OE-REF-1-SUFF    PIC XX.
   791
   792     12  PI-SESSION-IN-PROGRESS          PIC X.
   793         88  CLAIM-SESSION                   VALUE '1'.
   794         88  CREDIT-SESSION                  VALUE '2'.
   795         88  WARRANTY-SESSION                VALUE '3'.
   796         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL9301.cbl
   797         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   798
   799
   800*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   801
   802     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   803     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   804
   805     12  PI-CREDIT-USER                  PIC X.
   806         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   807         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   808
   809     12  PI-CLAIM-USER                   PIC X.
   810         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   811         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   812
   813     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   814         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   815         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   816         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   817         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   818         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   819
   820     12  PI-PROCESSOR-ID                 PIC X(4).
   821
   822     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   823
   824     12  PI-MEMBER-CAPTION               PIC X(10).
   825
   826     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   827         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   828
   829     12  PI-LIFE-OVERRIDE-L1             PIC X.
   830     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   831     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   832     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   833
   834     12  PI-AH-OVERRIDE-L1               PIC X.
   835     12  PI-AH-OVERRIDE-L2               PIC XX.
   836     12  PI-AH-OVERRIDE-L6               PIC X(6).
   837     12  PI-AH-OVERRIDE-L12              PIC X(12).
   838
   839     12  PI-NEW-SYSTEM                   PIC X(2).
   840
   841     12  PI-PRIMARY-CERT-NO              PIC X(11).
   842     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   843         88  PI-USES-PAID-TO                 VALUE '1'.
   844     12  PI-CRDTCRD-SYSTEM.
   845         16  PI-CRDTCRD-USER             PIC X.
   846             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   847             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   848         16  PI-CC-MONTH-END-DT          PIC XX.
   849     12  PI-PROCESSOR-PRINTER            PIC X(4).
   850
   851     12  PI-OE-REFERENCE-2.
   852         16  PI-OE-REF-2-PRIME           PIC X(10).
   853         16  PI-OE-REF-2-SUFF            PIC X.
   854
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL9301.cbl
   855     12  PI-REM-TRM-CALC-OPTION          PIC X.
   856
   857     12  PI-LANGUAGE-TYPE                PIC X.
   858             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   859             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   860             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   861
   862     12  PI-POLICY-LINKAGE-IND           PIC X.
   863         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   864         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   865                                                   LOW-VALUES.
   866
   867     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   868     12  PI-CLAIM-PW-SESSION             PIC X(1).
   869         88  PI-CLAIM-CREDIT                 VALUE '1'.
   870         88  PI-CLAIM-CONVEN                 VALUE '2'.
   871     12  FILLER                          PIC X(4).
   872
   873     12  PI-SYSTEM-LEVEL                 PIC X(145).
   874
   875     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   876         PI-SYSTEM-LEVEL.
   877
   878         16  PI-ENTRY-CODES.
   879             20  PI-ENTRY-CD-1           PIC X.
   880             20  PI-ENTRY-CD-2           PIC X.
   881
   882         16  PI-RETURN-CODES.
   883             20  PI-RETURN-CD-1          PIC X.
   884             20  PI-RETURN-CD-2          PIC X.
   885
   886         16  PI-UPDATE-STATUS-SAVE.
   887             20  PI-UPDATE-BY            PIC X(4).
   888             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   889
   890         16  PI-LOWER-CASE-LETTERS       PIC X.
   891             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   892
   893*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   894*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   895*            88  CARRIER-CLM-CNTL            VALUE '2'.
   896
   897         16  PI-CERT-ACCESS-CONTROL      PIC X.
   898             88  ST-ACCNT-CNTL               VALUE ' '.
   899             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   900             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   901             88  ACCNT-CNTL                  VALUE '3'.
   902             88  CARR-ACCNT-CNTL             VALUE '4'.
   903
   904         16  PI-PROCESSOR-CAP-LIST.
   905             20  PI-SYSTEM-CONTROLS.
   906                24 PI-SYSTEM-DISPLAY     PIC X.
   907                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   908                24 PI-SYSTEM-MODIFY      PIC X.
   909                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   910             20  FILLER                  PIC XX.
   911             20  PI-DISPLAY-CAP          PIC X.
   912                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL9301.cbl
   913             20  PI-MODIFY-CAP           PIC X.
   914                 88  MODIFY-CAP              VALUE 'Y'.
   915             20  PI-MSG-AT-LOGON-CAP     PIC X.
   916                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   917             20  PI-FORCE-CAP            PIC X.
   918                 88  FORCE-CAP               VALUE 'Y'.
   919
   920         16  PI-PROGRAM-CONTROLS.
   921             20  PI-PGM-PRINT-OPT        PIC X.
   922             20  PI-PGM-FORMAT-OPT       PIC X.
   923             20  PI-PGM-PROCESS-OPT      PIC X.
   924             20  PI-PGM-TOTALS-OPT       PIC X.
   925
   926         16  PI-HELP-INTERFACE.
   927             20  PI-LAST-ERROR-NO        PIC X(4).
   928             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   929
   930         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   931             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   932
   933         16  PI-CR-CONTROL-IN-PROGRESS.
   934             20  PI-CR-CARRIER           PIC X.
   935             20  PI-CR-GROUPING          PIC X(6).
   936             20  PI-CR-STATE             PIC XX.
   937             20  PI-CR-ACCOUNT           PIC X(10).
   938             20  PI-CR-FIN-RESP          PIC X(10).
   939             20  PI-CR-TYPE              PIC X.
   940
   941         16  PI-CR-BATCH-NUMBER          PIC X(6).
   942
   943         16  PI-CR-MONTH-END-DT          PIC XX.
   944
   945         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   946             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   947             88  PI-ZERO-CARRIER             VALUE '1'.
   948             88  PI-ZERO-GROUPING            VALUE '2'.
   949             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   950
   951         16  PI-CARRIER-SECURITY         PIC X.
   952             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   953
   954         16  PI-ACCOUNT-SECURITY         PIC X(10).
   955             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   956             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   957
   958         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   959             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   960                                         INDEXED BY PI-ACCESS-NDX
   961                                         PIC X.
   962
   963         16  PI-GA-BILLING-CONTROL       PIC X.
   964             88  PI-GA-BILLING               VALUE '1'.
   965
   966         16  PI-MAIL-PROCESSING          PIC X.
   967             88  PI-MAIL-YES                 VALUE 'Y'.
   968
   969         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   970
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL9301.cbl
   971         16  PI-AR-SYSTEM.
   972             20  PI-AR-PROCESSING-CNTL   PIC X.
   973                 88  PI-AR-PROCESSING        VALUE 'Y'.
   974             20  PI-AR-SUMMARY-CODE      PIC X(6).
   975             20  PI-AR-MONTH-END-DT      PIC XX.
   976
   977         16  PI-MP-SYSTEM.
   978             20  PI-MORTGAGE-USER            PIC X.
   979                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   980                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   981             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   982                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   983                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   984                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   985                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   986                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   987             20  PI-MP-MONTH-END-DT          PIC XX.
   988             20  PI-MP-REFERENCE-NO.
   989                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   990                 24  PI-MP-REFERENCE-SFX     PIC XX.
   991
   992         16  PI-LABEL-CONTROL            PIC X(01).
   993             88  PI-CREATE-LABELS                    VALUE 'Y'.
   994             88  PI-BYPASS-LABELS                    VALUE 'N'.
   995
   996         16  PI-BILL-GROUPING-CODE       PIC X(01).
   997             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   998
   999         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1000             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1001             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1002
  1003         16  FILLER                      PIC X(14).
  1004
  1005     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1006******************************************************************
  1007*    COPY ELC930PI.
  1008
  1009******************************************************************
  1010*                            ELC930PI                            *
  1011*                            VMOD=2.001                          *
  1012*                                                                *
  1013*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE DATA  *
  1014*    ENTRY SUB-SYSTEM.                                           *
  1015*                                                                *
  1016*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK.                   *
  1017*                                                                *
  1018*               EL930 - EL9301 - EL9302                          *
  1019******************************************************************
  1020
  1021     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
  1022         16  PI-AM-NAME                  PIC X(30).
  1023         16  PI-MAP-NAME                 PIC X(8).
  1024         16  PI-BATCH-AMOUNTS    COMP-3.
  1025             20  PI-LF-ISS-REMITTED      PIC S9(8)V99.
  1026             20  PI-LF-ISS-ENTERED       PIC S9(8)V99.
  1027             20  PI-LF-CAN-REMITTED      PIC S9(8)V99.
  1028             20  PI-LF-CAN-ENTERED       PIC S9(8)V99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL9301.cbl
  1029             20  PI-AH-ISS-REMITTED      PIC S9(8)V99.
  1030             20  PI-AH-ISS-ENTERED       PIC S9(8)V99.
  1031             20  PI-AH-CAN-REMITTED      PIC S9(8)V99.
  1032             20  PI-AH-CAN-ENTERED       PIC S9(8)V99.
  1033             20  PI-ISS-CNT-REMITTED     PIC S9(5).
  1034             20  PI-ISS-CNT-ENTERED      PIC S9(5).
  1035             20  PI-CAN-CNT-REMITTED     PIC S9(5).
  1036             20  PI-CAN-CNT-ENTERED      PIC S9(5).
  1037         16  PI-MAINT-FUNC               PIC X.
  1038         16  PI-ERROR-SW                 PIC X.
  1039             88  PI-DATA-ERRORS              VALUE 'Y'.
  1040         16  PI-UPDATE-SW                PIC X.
  1041             88  PI-DATA-UPDATED             VALUE 'Y'.
  1042         16  PI-DISPLAY-SW               PIC X.
  1043             88  PI-LAST-FUNC-DISPLAY        VALUE 'Y'.
  1044         16  PI-SAVE-CALLING-PGM         PIC X(8).
  1045         16  PI-LAST-SEQ-NO-ADDED        PIC S9(4) COMP.
  1046         16  PI-NEXT-DISPLAY-SEQ-NO      PIC S9(4) COMP.
  1047         16  PI-SAV-CARRIER              PIC X.
  1048         16  PI-SAV-GROUPING             PIC X(6).
  1049         16  PI-SAV-STATE                PIC XX.
  1050         16  PI-SAV-ACCOUNT              PIC X(10).
  1051         16  PI-SAV-CERT-EFF-DT          PIC XX.
  1052         16  PI-SAV-CERT-NO.
  1053             20  PI-SAV-CERT-PRIME       PIC X(14).
  1054             20  PI-SAV-CERT-SFX         PIC X.
  1055         16  PI-SAV-ENDING-ERPNDT-KEY.
  1056             20  PI-SAV-COMP-CD          PIC X.
  1057             20  PI-SAV-ENTRY-BATCH      PIC X(6).
  1058             20  PI-SAV-BATCH-SEQ        PIC S9(4) COMP.
  1059             20  PI-SAV-BATCH-CHG-SEQ    PIC S9(4) COMP.
  1060         16  PI-VERIFY-DELETE-SW         PIC X.
  1061             88  PI-DELETE-IS-OK             VALUE 'Y'.
  1062         16  PI-EL930-FIRST-TIME-SW      PIC X.
  1063             88  PI-EL930-FIRST-TIME         VALUE SPACE.
  1064         16  PI-CREDIT-EDIT-CONTROLS.
  1065             20  PI-MIN-PREMIUM          PIC S9(3)V99  COMP-3.
  1066             20  PI-MIN-AGE              PIC 99.
  1067             20  PI-DEFAULT-AGE          PIC 99.
  1068             20  PI-MIN-TERM             PIC S9(3)     COMP-3.
  1069             20  PI-MAX-TERM             PIC S9(3)     COMP-3.
  1070             20  PI-DEFAULT-SEX          PIC X.
  1071             20  PI-JOINT-AGE-INPUT      PIC X.
  1072                 88 PI-JOINT-AGE-IS-INPUT       VALUE '1'.
  1073             20  PI-BIRTH-DATE-INPUT     PIC X.
  1074                 88 PI-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1075         16  PI-KEYED-SWITCHES.
  1076             20  PI-ISS-SUFFIX-KEYED-SW  PIC X.
  1077                 88  PI-ISS-SUFFIX-KEYED     VALUE 'Y'.
  1078             20  PI-CAN-SUFFIX-KEYED-SW  PIC X.
  1079                 88  PI-CAN-SUFFIX-KEYED     VALUE 'Y'.
  1080             20  PI-IG-KEYED-SW          PIC X.
  1081                 88  PI-IG-KEYED             VALUE 'Y'.
  1082             20  PI-APR-KEYED-SW         PIC X.
  1083                 88  PI-APR-KEYED            VALUE 'Y'.
  1084             20  PI-FREQ-KEYED-SW        PIC X.
  1085                 88  PI-FREQ-KEYED           VALUE 'Y'.
  1086             20  PI-SIG-KEYED-SW         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL9301.cbl
  1087                 88  PI-SIG-KEYED            VALUE 'Y'.
  1088             20  PI-LFRT-KEYED-SW        PIC X.
  1089                 88  PI-LFRT-KEYED           VALUE 'Y'.
  1090             20  PI-AHRT-KEYED-SW        PIC X.
  1091                 88  PI-AHRT-KEYED           VALUE 'Y'.
  1092             20  PI-SSNUM-KEYED-SW       PIC X.
  1093                 88  PI-SSNUM-KEYED          VALUE 'Y'.
  1094             20  PI-JNT-SSNUM-KEYED-SW   PIC X.
  1095                 88  PI-JNT-SSNUM-KEYED      VALUE 'Y'.
  1096             20  PI-MEMBER-KEYED-SW      PIC X.
  1097                 88  PI-MEMBER-KEYED         VALUE 'Y'.
  1098             20  PI-MODE-KEYED-SW        PIC X.
  1099                 88  PI-MODE-KEYED           VALUE 'Y'.
  1100             20  PI-PMTS-KEYED-SW        PIC X.
  1101                 88  PI-PMTS-KEYED           VALUE 'Y'.
  1102             20  PI-LN-OFFICER-KEYED-SW  PIC X.
  1103                 88  PI-LN-OFFICER-KEYED     VALUE 'Y'.
  1104             20  PI-ENTRY-KEYED-SW       PIC X.
  1105                 88  PI-ENTRY-KEYED          VALUE 'Y'.
  1106             20  PI-RINCD-KEYED-SW       PIC X.
  1107                 88  PI-RINCD-KEYED          VALUE 'Y'.
  1108             20  PI-RTCLS-KEYED-SW       PIC X.
  1109                 88  PI-RTCLS-KEYED          VALUE 'Y'.
  1110             20  PI-LNTRM-KEYED-SW       PIC X.
  1111                 88  PI-LNTRM-KEYED          VALUE 'Y'.
  1112             20  PI-EXPIR-KEYED-SW       PIC X.
  1113                 88  PI-EXPIR-KEYED          VALUE 'Y'.
  1114             20  PI-PMT-KEYED-SW         PIC X.
  1115                 88  PI-PMT-KEYED            VALUE 'Y'.
  1116             20  PI-1ST-PMT-KEYED-SW     PIC X.
  1117                 88  PI-1ST-PMT-KEYED        VALUE 'Y'.
  1118             20  PI-DAYS-KEYED-SW        PIC X.
  1119                 88  PI-DAYS-KEYED           VALUE 'Y'.
  1120             20  PI-SKPCD-KEYED-SW       PIC X.
  1121                 88  PI-SKPCD-KEYED          VALUE 'Y'.
  1122             20  PI-JNT-AGE-KEYED-SW     PIC X.
  1123                 88  PI-JNT-AGE-KEYED        VALUE 'Y'.
  1124             20  PI-JNT-NAME-KEYED-SW    PIC X.
  1125                 88  PI-JNT-NAME-KEYED       VALUE 'Y'.
  1126             20  PI-ISS-LIVES-KEYED-SW   PIC X.
  1127                 88  PI-ISS-LIVES-KEYED      VALUE 'Y'.
  1128             20  PI-CAN-LIVES-KEYED-SW   PIC X.
  1129                 88  PI-CAN-LIVES-KEYED      VALUE 'Y'.
  1130             20  PI-PAYEE-KEYED-SW       PIC X.
  1131                 88  PI-PAYEE-KEYED          VALUE 'Y'.
  1132             20  PI-CHK-REQ-KEYED-SW     PIC X.
  1133                 88  PI-CHK-REQ-KEYED        VALUE 'Y'.
  1134             20  PI-ZIP4-KEYED-SW        PIC X.
  1135                 88  PI-ZIP4-KEYED           VALUE 'Y'.
  1136             20  PI-POLICY-KEYED-SW      PIC X.
  1137                 88  PI-POLICY-KEYED         VALUE 'Y'.
  1138             20  PI-EXPIRE-KEYED-SW      PIC X.
  1139                 88  PI-EXPIRE-KEYED         VALUE 'Y'.
  1140             20  PI-CRIT-PERD-KEYED-SW    PIC X.
  1141                 88  PI-CRIT-PERD-KEYED      VALUE 'Y'.
  1142             20  PI-BENEFICIARY-KEYED-SW PIC X.
  1143                 88  PI-BENEFICIARY-KEYED    VALUE 'Y'.
  1144             20  PI-PHONE-KEYED-SW       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL9301.cbl
  1145                 88  PI-PHONE-KEYED          VALUE 'Y'.
  1146             20  PI-ALT-BEN-KEYED-SW     PIC X.
  1147                 88  PI-ALT-BEN-KEYED        VALUE 'Y'.
  1148             20  PI-ALT-PREM-KEYED-SW    PIC X.
  1149                 88  PI-ALT-PREM-KEYED       VALUE 'Y'.
  1150         16  PI-ACCT-LOW-EFF-DT          PIC XX.
  1151         16  PI-ACCT-HIGH-EXP-DT         PIC XX.
  1152         16  PI-BATCH-EOF-SW             PIC X.
  1153             88  PI-BATCH-EOF                VALUE 'Y'.
  1154         16  PI-NB-MONTH-END-DT          PIC XX.
  1155         16  PI-ISSUE-ADDED-SW           PIC X.
  1156             88  PI-ISSUE-ADDED              VALUE 'Y'.
  1157
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL9301.cbl
  1160*                            COPY ELCJPFX.
  1161******************************************************************
  1162*                                                                *
  1163*                                                                *
  1164*                            ELCJPFX.                            *
  1165*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1166*                            VMOD=2.002                          *
  1167*                                                                *
  1168*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1169*                                                                *
  1170*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1171*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1172*        ELCNTL - CONTROL FILE                                   *
  1173*        ELMSTR - CLAIM MASTERS                                  *
  1174*        ELTRLR - ACTIVITY TRAILERS                              *
  1175*        ELCHKQ - CHECK QUE                                      *
  1176******************************************************************
  1177 01  JOURNAL-RECORD.
  1178     12  JP-USER-ID                  PIC X(4).
  1179     12  JP-FILE-ID                  PIC X(8).
  1180     12  JP-PROGRAM-ID               PIC X(8).
  1181     12  JP-RECORD-TYPE              PIC X.
  1182         88 JP-ADD              VALUE 'A'.
  1183         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1184         88 JP-AFTER-CHANGE     VALUE 'C'.
  1185         88 JP-DELETE           VALUE 'D'.
  1186         88 JP-GENERIC-DELETE   VALUE 'G'.
  1187         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1188         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1189     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1190     12  JP-RECORD-AREA
  1191
  1192
  1193                             PIC X(608).
  1194
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL9301.cbl
  1196*                            COPY ELCAID.
  1197******************************************************************
  1198*                                                                *
  1199*                            ELCAID.                             *
  1200*                            VMOD=2.001                          *
  1201*                                                                *
  1202*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1203*                                                                *
  1204*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1205*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1206******************************************************************
  1207
  1208 01  DFHAID.
  1209   02  DFHNULL   PIC  X  VALUE  ' '.
  1210   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1211   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1212   02  DFHPEN    PIC  X  VALUE  '='.
  1213   02  DFHOPID   PIC  X  VALUE  'W'.
  1214   02  DFHPA1    PIC  X  VALUE  '%'.
  1215   02  DFHPA2    PIC  X  VALUE  '>'.
  1216   02  DFHPA3    PIC  X  VALUE  ','.
  1217   02  DFHPF1    PIC  X  VALUE  '1'.
  1218   02  DFHPF2    PIC  X  VALUE  '2'.
  1219   02  DFHPF3    PIC  X  VALUE  '3'.
  1220   02  DFHPF4    PIC  X  VALUE  '4'.
  1221   02  DFHPF5    PIC  X  VALUE  '5'.
  1222   02  DFHPF6    PIC  X  VALUE  '6'.
  1223   02  DFHPF7    PIC  X  VALUE  '7'.
  1224   02  DFHPF8    PIC  X  VALUE  '8'.
  1225   02  DFHPF9    PIC  X  VALUE  '9'.
  1226   02  DFHPF10   PIC  X  VALUE  ':'.
  1227   02  DFHPF11   PIC  X  VALUE  '#'.
  1228   02  DFHPF12   PIC  X  VALUE  '@'.
  1229   02  DFHPF13   PIC  X  VALUE  'A'.
  1230   02  DFHPF14   PIC  X  VALUE  'B'.
  1231   02  DFHPF15   PIC  X  VALUE  'C'.
  1232   02  DFHPF16   PIC  X  VALUE  'D'.
  1233   02  DFHPF17   PIC  X  VALUE  'E'.
  1234   02  DFHPF18   PIC  X  VALUE  'F'.
  1235   02  DFHPF19   PIC  X  VALUE  'G'.
  1236   02  DFHPF20   PIC  X  VALUE  'H'.
  1237   02  DFHPF21   PIC  X  VALUE  'I'.
  1238*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1239   02  DFHPF22   PIC  X  VALUE  '['.
  1240   02  DFHPF23   PIC  X  VALUE  '.'.
  1241   02  DFHPF24   PIC  X  VALUE  '<'.
  1242   02  DFHMSRE   PIC  X  VALUE  'X'.
  1243   02  DFHSTRF   PIC  X  VALUE  'h'.
  1244   02  DFHTRIG   PIC  X  VALUE  '"'.
  1245 01  FILLER    REDEFINES DFHAID.
  1246     12  FILLER              PIC X(8).
  1247     12  PF-VALUES           PIC X       OCCURS 2.
  1248
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL9301.cbl
  1250 01  DATA-ENTRY-MAP              PIC X(1116).
  1251*                                      COPY EL9301S.
  1252 01  EL930BI.
  1253     05  FILLER            PIC  X(0012).
  1254*    -------------------------------
  1255     05  BDATEL PIC S9(0004) COMP.
  1256     05  BDATEF PIC  X(0001).
  1257     05  FILLER REDEFINES BDATEF.
  1258         10  BDATEA PIC  X(0001).
  1259     05  BDATEI PIC  X(0008).
  1260*    -------------------------------
  1261     05  BTIMEL PIC S9(0004) COMP.
  1262     05  BTIMEF PIC  X(0001).
  1263     05  FILLER REDEFINES BTIMEF.
  1264         10  BTIMEA PIC  X(0001).
  1265     05  BTIMEI PIC  X(0005).
  1266*    -------------------------------
  1267     05  BBATCHL PIC S9(0004) COMP.
  1268     05  BBATCHF PIC  X(0001).
  1269     05  FILLER REDEFINES BBATCHF.
  1270         10  BBATCHA PIC  X(0001).
  1271     05  BBATCHI PIC  X(0008).
  1272*    -------------------------------
  1273     05  BSEQL PIC S9(0004) COMP.
  1274     05  BSEQF PIC  X(0001).
  1275     05  FILLER REDEFINES BSEQF.
  1276         10  BSEQA PIC  X(0001).
  1277     05  BSEQI PIC  X(0004).
  1278*    -------------------------------
  1279     05  BCARHDL PIC S9(0004) COMP.
  1280     05  BCARHDF PIC  X(0001).
  1281     05  FILLER REDEFINES BCARHDF.
  1282         10  BCARHDA PIC  X(0001).
  1283     05  BCARHDI PIC  X(0005).
  1284*    -------------------------------
  1285     05  BCARL PIC S9(0004) COMP.
  1286     05  BCARF PIC  X(0001).
  1287     05  FILLER REDEFINES BCARF.
  1288         10  BCARA PIC  X(0001).
  1289     05  BCARI PIC  X(0001).
  1290*    -------------------------------
  1291     05  BGRPHDL PIC S9(0004) COMP.
  1292     05  BGRPHDF PIC  X(0001).
  1293     05  FILLER REDEFINES BGRPHDF.
  1294         10  BGRPHDA PIC  X(0001).
  1295     05  BGRPHDI PIC  X(0005).
  1296*    -------------------------------
  1297     05  BGRPL PIC S9(0004) COMP.
  1298     05  BGRPF PIC  X(0001).
  1299     05  FILLER REDEFINES BGRPF.
  1300         10  BGRPA PIC  X(0001).
  1301     05  BGRPI PIC  X(0006).
  1302*    -------------------------------
  1303     05  BSTHDL PIC S9(0004) COMP.
  1304     05  BSTHDF PIC  X(0001).
  1305     05  FILLER REDEFINES BSTHDF.
  1306         10  BSTHDA PIC  X(0001).
  1307     05  BSTHDI PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL9301.cbl
  1308*    -------------------------------
  1309     05  BSTL PIC S9(0004) COMP.
  1310     05  BSTF PIC  X(0001).
  1311     05  FILLER REDEFINES BSTF.
  1312         10  BSTA PIC  X(0001).
  1313     05  BSTI PIC  X(0002).
  1314*    -------------------------------
  1315     05  BACCHDL PIC S9(0004) COMP.
  1316     05  BACCHDF PIC  X(0001).
  1317     05  FILLER REDEFINES BACCHDF.
  1318         10  BACCHDA PIC  X(0001).
  1319     05  BACCHDI PIC  X(0006).
  1320*    -------------------------------
  1321     05  BACCTL PIC S9(0004) COMP.
  1322     05  BACCTF PIC  X(0001).
  1323     05  FILLER REDEFINES BACCTF.
  1324         10  BACCTA PIC  X(0001).
  1325     05  BACCTI PIC  X(0010).
  1326*    -------------------------------
  1327     05  BCERTL PIC S9(0004) COMP.
  1328     05  BCERTF PIC  X(0001).
  1329     05  FILLER REDEFINES BCERTF.
  1330         10  BCERTA PIC  X(0001).
  1331     05  BCERTI PIC  X(0010).
  1332*    -------------------------------
  1333     05  BSFXL PIC S9(0004) COMP.
  1334     05  BSFXF PIC  X(0001).
  1335     05  FILLER REDEFINES BSFXF.
  1336         10  BSFXA PIC  X(0001).
  1337     05  BSFXI PIC  X(0001).
  1338*    -------------------------------
  1339     05  BEFFDTL PIC S9(0004) COMP.
  1340     05  BEFFDTF PIC  X(0001).
  1341     05  FILLER REDEFINES BEFFDTF.
  1342         10  BEFFDTA PIC  X(0001).
  1343     05  BEFFDTI PIC  X(0006).
  1344*    -------------------------------
  1345     05  BLASTNML PIC S9(0004) COMP.
  1346     05  BLASTNMF PIC  X(0001).
  1347     05  FILLER REDEFINES BLASTNMF.
  1348         10  BLASTNMA PIC  X(0001).
  1349     05  BLASTNMI PIC  X(0015).
  1350*    -------------------------------
  1351     05  B1STNML PIC S9(0004) COMP.
  1352     05  B1STNMF PIC  X(0001).
  1353     05  FILLER REDEFINES B1STNMF.
  1354         10  B1STNMA PIC  X(0001).
  1355     05  B1STNMI PIC  X(0010).
  1356*    -------------------------------
  1357     05  BINTL PIC S9(0004) COMP.
  1358     05  BINTF PIC  X(0001).
  1359     05  FILLER REDEFINES BINTF.
  1360         10  BINTA PIC  X(0001).
  1361     05  BINTI PIC  X(0001).
  1362*    -------------------------------
  1363     05  BSEXL PIC S9(0004) COMP.
  1364     05  BSEXF PIC  X(0001).
  1365     05  FILLER REDEFINES BSEXF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL9301.cbl
  1366         10  BSEXA PIC  X(0001).
  1367     05  BSEXI PIC  X(0001).
  1368*    -------------------------------
  1369     05  BAGEL PIC S9(0004) COMP.
  1370     05  BAGEF PIC  X(0001).
  1371     05  FILLER REDEFINES BAGEF.
  1372         10  BAGEA PIC  X(0001).
  1373     05  BAGEI PIC  X(0002).
  1374*    -------------------------------
  1375     05  BSSNL PIC S9(0004) COMP.
  1376     05  BSSNF PIC  X(0001).
  1377     05  FILLER REDEFINES BSSNF.
  1378         10  BSSNA PIC  X(0001).
  1379     05  BSSNI PIC  X(0011).
  1380*    -------------------------------
  1381     05  BKIND1L PIC S9(0004) COMP.
  1382     05  BKIND1F PIC  X(0001).
  1383     05  FILLER REDEFINES BKIND1F.
  1384         10  BKIND1A PIC  X(0001).
  1385     05  BKIND1I PIC  X(0002).
  1386*    -------------------------------
  1387     05  BTYPE1L PIC S9(0004) COMP.
  1388     05  BTYPE1F PIC  X(0001).
  1389     05  FILLER REDEFINES BTYPE1F.
  1390         10  BTYPE1A PIC  X(0001).
  1391     05  BTYPE1I PIC  X(0003).
  1392*    -------------------------------
  1393     05  BTRM1L PIC S9(0004) COMP.
  1394     05  BTRM1F PIC  X(0001).
  1395     05  FILLER REDEFINES BTRM1F.
  1396         10  BTRM1A PIC  X(0001).
  1397     05  BTRM1I PIC  X(0003).
  1398*    -------------------------------
  1399     05  BBEN1L PIC S9(0004) COMP.
  1400     05  BBEN1F PIC  X(0001).
  1401     05  FILLER REDEFINES BBEN1F.
  1402         10  BBEN1A PIC  X(0001).
  1403     05  BBEN1I PIC  X(0012).
  1404*    -------------------------------
  1405     05  BPRM1L PIC S9(0004) COMP.
  1406     05  BPRM1F PIC  X(0001).
  1407     05  FILLER REDEFINES BPRM1F.
  1408         10  BPRM1A PIC  X(0001).
  1409     05  BPRM1I PIC  X(0011).
  1410*    -------------------------------
  1411     05  BEXPIR1L PIC S9(0004) COMP.
  1412     05  BEXPIR1F PIC  X(0001).
  1413     05  FILLER REDEFINES BEXPIR1F.
  1414         10  BEXPIR1A PIC  X(0001).
  1415     05  BEXPIR1I PIC  X(0006).
  1416*    -------------------------------
  1417     05  BCP1L PIC S9(0004) COMP.
  1418     05  BCP1F PIC  X(0001).
  1419     05  FILLER REDEFINES BCP1F.
  1420         10  BCP1A PIC  X(0001).
  1421     05  BCP1I PIC  X(0002).
  1422*    -------------------------------
  1423     05  BALTBN1L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL9301.cbl
  1424     05  BALTBN1F PIC  X(0001).
  1425     05  FILLER REDEFINES BALTBN1F.
  1426         10  BALTBN1A PIC  X(0001).
  1427     05  BALTBN1I PIC  X(0012).
  1428*    -------------------------------
  1429     05  BALTPM1L PIC S9(0004) COMP.
  1430     05  BALTPM1F PIC  X(0001).
  1431     05  FILLER REDEFINES BALTPM1F.
  1432         10  BALTPM1A PIC  X(0001).
  1433     05  BALTPM1I PIC  X(0009).
  1434*    -------------------------------
  1435     05  BKIND2L PIC S9(0004) COMP.
  1436     05  BKIND2F PIC  X(0001).
  1437     05  FILLER REDEFINES BKIND2F.
  1438         10  BKIND2A PIC  X(0001).
  1439     05  BKIND2I PIC  X(0002).
  1440*    -------------------------------
  1441     05  BTYPE2L PIC S9(0004) COMP.
  1442     05  BTYPE2F PIC  X(0001).
  1443     05  FILLER REDEFINES BTYPE2F.
  1444         10  BTYPE2A PIC  X(0001).
  1445     05  BTYPE2I PIC  X(0003).
  1446*    -------------------------------
  1447     05  BTRM2L PIC S9(0004) COMP.
  1448     05  BTRM2F PIC  X(0001).
  1449     05  FILLER REDEFINES BTRM2F.
  1450         10  BTRM2A PIC  X(0001).
  1451     05  BTRM2I PIC  X(0003).
  1452*    -------------------------------
  1453     05  BBEN2L PIC S9(0004) COMP.
  1454     05  BBEN2F PIC  X(0001).
  1455     05  FILLER REDEFINES BBEN2F.
  1456         10  BBEN2A PIC  X(0001).
  1457     05  BBEN2I PIC  X(0012).
  1458*    -------------------------------
  1459     05  BPRM2L PIC S9(0004) COMP.
  1460     05  BPRM2F PIC  X(0001).
  1461     05  FILLER REDEFINES BPRM2F.
  1462         10  BPRM2A PIC  X(0001).
  1463     05  BPRM2I PIC  X(0011).
  1464*    -------------------------------
  1465     05  BEXPIR2L PIC S9(0004) COMP.
  1466     05  BEXPIR2F PIC  X(0001).
  1467     05  FILLER REDEFINES BEXPIR2F.
  1468         10  BEXPIR2A PIC  X(0001).
  1469     05  BEXPIR2I PIC  X(0006).
  1470*    -------------------------------
  1471     05  BCP2L PIC S9(0004) COMP.
  1472     05  BCP2F PIC  X(0001).
  1473     05  FILLER REDEFINES BCP2F.
  1474         10  BCP2A PIC  X(0001).
  1475     05  BCP2I PIC  X(0002).
  1476*    -------------------------------
  1477     05  BALTBN2L PIC S9(0004) COMP.
  1478     05  BALTBN2F PIC  X(0001).
  1479     05  FILLER REDEFINES BALTBN2F.
  1480         10  BALTBN2A PIC  X(0001).
  1481     05  BALTBN2I PIC  X(0012).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL9301.cbl
  1482*    -------------------------------
  1483     05  BALTPM2L PIC S9(0004) COMP.
  1484     05  BALTPM2F PIC  X(0001).
  1485     05  FILLER REDEFINES BALTPM2F.
  1486         10  BALTPM2A PIC  X(0001).
  1487     05  BALTPM2I PIC  X(0009).
  1488*    -------------------------------
  1489     05  BLIVSL PIC S9(0004) COMP.
  1490     05  BLIVSF PIC  X(0001).
  1491     05  FILLER REDEFINES BLIVSF.
  1492         10  BLIVSA PIC  X(0001).
  1493     05  BLIVSI PIC  X(0003).
  1494*    -------------------------------
  1495     05  BJNT1STL PIC S9(0004) COMP.
  1496     05  BJNT1STF PIC  X(0001).
  1497     05  FILLER REDEFINES BJNT1STF.
  1498         10  BJNT1STA PIC  X(0001).
  1499     05  BJNT1STI PIC  X(0010).
  1500*    -------------------------------
  1501     05  BJNTINTL PIC S9(0004) COMP.
  1502     05  BJNTINTF PIC  X(0001).
  1503     05  FILLER REDEFINES BJNTINTF.
  1504         10  BJNTINTA PIC  X(0001).
  1505     05  BJNTINTI PIC  X(0001).
  1506*    -------------------------------
  1507     05  BJNTNAML PIC S9(0004) COMP.
  1508     05  BJNTNAMF PIC  X(0001).
  1509     05  FILLER REDEFINES BJNTNAMF.
  1510         10  BJNTNAMA PIC  X(0001).
  1511     05  BJNTNAMI PIC  X(0015).
  1512*    -------------------------------
  1513     05  BJNTAGEL PIC S9(0004) COMP.
  1514     05  BJNTAGEF PIC  X(0001).
  1515     05  FILLER REDEFINES BJNTAGEF.
  1516         10  BJNTAGEA PIC  X(0001).
  1517     05  BJNTAGEI PIC  X(0002).
  1518*    -------------------------------
  1519     05  BNFICRYL PIC S9(0004) COMP.
  1520     05  BNFICRYF PIC  X(0001).
  1521     05  FILLER REDEFINES BNFICRYF.
  1522         10  BNFICRYA PIC  X(0001).
  1523     05  BNFICRYI PIC  X(0025).
  1524*    -------------------------------
  1525     05  B1STPMTL PIC S9(0004) COMP.
  1526     05  B1STPMTF PIC  X(0001).
  1527     05  FILLER REDEFINES B1STPMTF.
  1528         10  B1STPMTA PIC  X(0001).
  1529     05  B1STPMTI PIC  X(0006).
  1530*    -------------------------------
  1531     05  BDAYL PIC S9(0004) COMP.
  1532     05  BDAYF PIC  X(0001).
  1533     05  FILLER REDEFINES BDAYF.
  1534         10  BDAYA PIC  X(0001).
  1535     05  BDAYI PIC  X(0003).
  1536*    -------------------------------
  1537     05  BLNTRML PIC S9(0004) COMP.
  1538     05  BLNTRMF PIC  X(0001).
  1539     05  FILLER REDEFINES BLNTRMF.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL9301.cbl
  1540         10  BLNTRMA PIC  X(0001).
  1541     05  BLNTRMI PIC  X(0003).
  1542*    -------------------------------
  1543     05  BLONOFCL PIC S9(0004) COMP.
  1544     05  BLONOFCF PIC  X(0001).
  1545     05  FILLER REDEFINES BLONOFCF.
  1546         10  BLONOFCA PIC  X(0001).
  1547     05  BLONOFCI PIC  X(0003).
  1548*    -------------------------------
  1549     05  BMODEL PIC S9(0004) COMP.
  1550     05  BMODEF PIC  X(0001).
  1551     05  FILLER REDEFINES BMODEF.
  1552         10  BMODEA PIC  X(0001).
  1553     05  BMODEI PIC  X(0001).
  1554*    -------------------------------
  1555     05  BFRQL PIC S9(0004) COMP.
  1556     05  BFRQF PIC  X(0001).
  1557     05  FILLER REDEFINES BFRQF.
  1558         10  BFRQA PIC  X(0001).
  1559     05  BFRQI PIC  X(0002).
  1560*    -------------------------------
  1561     05  BPMTSL PIC S9(0004) COMP.
  1562     05  BPMTSF PIC  X(0001).
  1563     05  FILLER REDEFINES BPMTSF.
  1564         10  BPMTSA PIC  X(0001).
  1565     05  BPMTSI PIC  X(0003).
  1566*    -------------------------------
  1567     05  BPMTAMTL PIC S9(0004) COMP.
  1568     05  BPMTAMTF PIC  X(0001).
  1569     05  FILLER REDEFINES BPMTAMTF.
  1570         10  BPMTAMTA PIC  X(0001).
  1571     05  BPMTAMTI PIC  X(0009).
  1572*    -------------------------------
  1573     05  BCAPTNL PIC S9(0004) COMP.
  1574     05  BCAPTNF PIC  X(0001).
  1575     05  FILLER REDEFINES BCAPTNF.
  1576         10  BCAPTNA PIC  X(0001).
  1577     05  BCAPTNI PIC  X(0010).
  1578*    -------------------------------
  1579     05  BRCL PIC S9(0004) COMP.
  1580     05  BRCF PIC  X(0001).
  1581     05  FILLER REDEFINES BRCF.
  1582         10  BRCA PIC  X(0001).
  1583     05  BRCI PIC  X(0001).
  1584*    -------------------------------
  1585     05  BENTRYL PIC S9(0004) COMP.
  1586     05  BENTRYF PIC  X(0001).
  1587     05  FILLER REDEFINES BENTRYF.
  1588         10  BENTRYA PIC  X(0001).
  1589     05  BENTRYI PIC  X(0001).
  1590*    -------------------------------
  1591     05  BSKIPL PIC S9(0004) COMP.
  1592     05  BSKIPF PIC  X(0001).
  1593     05  FILLER REDEFINES BSKIPF.
  1594         10  BSKIPA PIC  X(0001).
  1595     05  BSKIPI PIC  X(0001).
  1596*    -------------------------------
  1597     05  BINDGRPL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL9301.cbl
  1598     05  BINDGRPF PIC  X(0001).
  1599     05  FILLER REDEFINES BINDGRPF.
  1600         10  BINDGRPA PIC  X(0001).
  1601     05  BINDGRPI PIC  X(0001).
  1602*    -------------------------------
  1603     05  BSIGL PIC S9(0004) COMP.
  1604     05  BSIGF PIC  X(0001).
  1605     05  FILLER REDEFINES BSIGF.
  1606         10  BSIGA PIC  X(0001).
  1607     05  BSIGI PIC  X(0001).
  1608*    -------------------------------
  1609     05  BPOLICYL PIC S9(0004) COMP.
  1610     05  BPOLICYF PIC  X(0001).
  1611     05  FILLER REDEFINES BPOLICYF.
  1612         10  BPOLICYA PIC  X(0001).
  1613     05  BPOLICYI PIC  X(0012).
  1614*    -------------------------------
  1615     05  BRTCLSL PIC S9(0004) COMP.
  1616     05  BRTCLSF PIC  X(0001).
  1617     05  FILLER REDEFINES BRTCLSF.
  1618         10  BRTCLSA PIC  X(0001).
  1619     05  BRTCLSI PIC  X(0002).
  1620*    -------------------------------
  1621     05  BAPRL PIC S9(0004) COMP.
  1622     05  BAPRF PIC  X(0001).
  1623     05  FILLER REDEFINES BAPRF.
  1624         10  BAPRA PIC  X(0001).
  1625     05  BAPRI PIC  9(3)V9999.
  1626*    -------------------------------
  1627     05  BBIRTHL PIC S9(0004) COMP.
  1628     05  BBIRTHF PIC  X(0001).
  1629     05  FILLER REDEFINES BBIRTHF.
  1630         10  BBIRTHA PIC  X(0001).
  1631     05  BBIRTHI PIC  X(0006).
  1632*    -------------------------------
  1633     05  BMEML PIC S9(0004) COMP.
  1634     05  BMEMF PIC  X(0001).
  1635     05  FILLER REDEFINES BMEMF.
  1636         10  BMEMA PIC  X(0001).
  1637     05  BMEMI PIC  X(0012).
  1638*    -------------------------------
  1639     05  BADDRS1L PIC S9(0004) COMP.
  1640     05  BADDRS1F PIC  X(0001).
  1641     05  FILLER REDEFINES BADDRS1F.
  1642         10  BADDRS1A PIC  X(0001).
  1643     05  BADDRS1I PIC  X(0030).
  1644*    -------------------------------
  1645     05  BADDRS2L PIC S9(0004) COMP.
  1646     05  BADDRS2F PIC  X(0001).
  1647     05  FILLER REDEFINES BADDRS2F.
  1648         10  BADDRS2A PIC  X(0001).
  1649     05  BADDRS2I PIC  X(0030).
  1650*    -------------------------------
  1651     05  BCITYSTL PIC S9(0004) COMP.
  1652     05  BCITYSTF PIC  X(0001).
  1653     05  FILLER REDEFINES BCITYSTF.
  1654         10  BCITYSTA PIC  X(0001).
  1655     05  BCITYSTI PIC  X(0030).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL9301.cbl
  1656*    -------------------------------
  1657     05  BZIP5L PIC S9(0004) COMP.
  1658     05  BZIP5F PIC  X(0001).
  1659     05  FILLER REDEFINES BZIP5F.
  1660         10  BZIP5A PIC  X(0001).
  1661     05  BZIP5I PIC  X(0005).
  1662*    -------------------------------
  1663     05  BDASHL PIC S9(0004) COMP.
  1664     05  BDASHF PIC  X(0001).
  1665     05  FILLER REDEFINES BDASHF.
  1666         10  BDASHA PIC  X(0001).
  1667     05  BDASHI PIC  X(0001).
  1668*    -------------------------------
  1669     05  BZIP4L PIC S9(0004) COMP.
  1670     05  BZIP4F PIC  X(0001).
  1671     05  FILLER REDEFINES BZIP4F.
  1672         10  BZIP4A PIC  X(0001).
  1673     05  BZIP4I PIC  X(0004).
  1674*    -------------------------------
  1675     05  BPHONEL PIC S9(0004) COMP.
  1676     05  BPHONEF PIC  X(0001).
  1677     05  FILLER REDEFINES BPHONEF.
  1678         10  BPHONEA PIC  X(0001).
  1679     05  BPHONEI PIC  X(0012).
  1680*    -------------------------------
  1681     05  BERMSG1L PIC S9(0004) COMP.
  1682     05  BERMSG1F PIC  X(0001).
  1683     05  FILLER REDEFINES BERMSG1F.
  1684         10  BERMSG1A PIC  X(0001).
  1685     05  BERMSG1I PIC  X(0079).
  1686*    -------------------------------
  1687     05  BERMSG2L PIC S9(0004) COMP.
  1688     05  BERMSG2F PIC  X(0001).
  1689     05  FILLER REDEFINES BERMSG2F.
  1690         10  BERMSG2A PIC  X(0001).
  1691     05  BERMSG2I PIC  X(0079).
  1692*    -------------------------------
  1693     05  BPFENTRL PIC S9(0004) COMP.
  1694     05  BPFENTRF PIC  X(0001).
  1695     05  FILLER REDEFINES BPFENTRF.
  1696         10  BPFENTRA PIC  X(0001).
  1697     05  BPFENTRI PIC  9(2).
  1698*    -------------------------------
  1699     05  BDELHDGL PIC S9(0004) COMP.
  1700     05  BDELHDGF PIC  X(0001).
  1701     05  FILLER REDEFINES BDELHDGF.
  1702         10  BDELHDGA PIC  X(0001).
  1703     05  BDELHDGI PIC  X(0017).
  1704 01  EL930BO REDEFINES EL930BI.
  1705     05  FILLER            PIC  X(0012).
  1706*    -------------------------------
  1707     05  FILLER            PIC  X(0003).
  1708     05  BDATEO PIC  X(0008).
  1709*    -------------------------------
  1710     05  FILLER            PIC  X(0003).
  1711     05  BTIMEO PIC  99.99.
  1712*    -------------------------------
  1713     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL9301.cbl
  1714     05  BBATCHO PIC  X(0008).
  1715*    -------------------------------
  1716     05  FILLER            PIC  X(0003).
  1717     05  BSEQO PIC  X(0004).
  1718*    -------------------------------
  1719     05  FILLER            PIC  X(0003).
  1720     05  BCARHDO PIC  X(0005).
  1721*    -------------------------------
  1722     05  FILLER            PIC  X(0003).
  1723     05  BCARO PIC  X(0001).
  1724*    -------------------------------
  1725     05  FILLER            PIC  X(0003).
  1726     05  BGRPHDO PIC  X(0005).
  1727*    -------------------------------
  1728     05  FILLER            PIC  X(0003).
  1729     05  BGRPO PIC  X(0006).
  1730*    -------------------------------
  1731     05  FILLER            PIC  X(0003).
  1732     05  BSTHDO PIC  X(0004).
  1733*    -------------------------------
  1734     05  FILLER            PIC  X(0003).
  1735     05  BSTO PIC  X(0002).
  1736*    -------------------------------
  1737     05  FILLER            PIC  X(0003).
  1738     05  BACCHDO PIC  X(0006).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  BACCTO PIC  X(0010).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  BCERTO PIC  X(0010).
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  BSFXO PIC  X(0001).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  BEFFDTO PIC  X(0006).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  BLASTNMO PIC  X(0015).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  B1STNMO PIC  X(0010).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  BINTO PIC  X(0001).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  BSEXO PIC  X(0001).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  BAGEO PIC  X(0002).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  BSSNO PIC  X(0011).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  BKIND1O PIC  X(0002).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL9301.cbl
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  BTYPE1O PIC  X(0003).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  BTRM1O PIC  X(0003).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  BBEN1O PIC  X(0012).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  BPRM1O PIC  X(0011).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  BEXPIR1O PIC  X(0006).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
  1789     05  BCP1O PIC  X(0002).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  BALTBN1O PIC  X(0012).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  BALTPM1O PIC  X(0009).
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  BKIND2O PIC  X(0002).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  BTYPE2O PIC  X(0003).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  BTRM2O PIC  X(0003).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  BBEN2O PIC  X(0012).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  BPRM2O PIC  X(0011).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  BEXPIR2O PIC  X(0006).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  BCP2O PIC  X(0002).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  BALTBN2O PIC  X(0012).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  BALTPM2O PIC  X(0009).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  BLIVSO PIC  X(0003).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  BJNT1STO PIC  X(0010).
  1829*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL9301.cbl
  1830     05  FILLER            PIC  X(0003).
  1831     05  BJNTINTO PIC  X(0001).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  BJNTNAMO PIC  X(0015).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  BJNTAGEO PIC  X(0002).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  BNFICRYO PIC  X(0025).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  B1STPMTO PIC  X(0006).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  BDAYO PIC  X(0003).
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  BLNTRMO PIC  X(0003).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  BLONOFCO PIC  X(0003).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  BMODEO PIC  X(0001).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  BFRQO PIC  X(0002).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  BPMTSO PIC  X(0003).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  BPMTAMTO PIC  X(0009).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  BCAPTNO PIC  X(0010).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  BRCO PIC  X(0001).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  BENTRYO PIC  X(0001).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  BSKIPO PIC  X(0001).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  BINDGRPO PIC  X(0001).
  1880*    -------------------------------
  1881     05  FILLER            PIC  X(0003).
  1882     05  BSIGO PIC  X(0001).
  1883*    -------------------------------
  1884     05  FILLER            PIC  X(0003).
  1885     05  BPOLICYO PIC  X(0012).
  1886*    -------------------------------
  1887     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL9301.cbl
  1888     05  BRTCLSO PIC  X(0002).
  1889*    -------------------------------
  1890     05  FILLER            PIC  X(0003).
  1891     05  BAPRO PIC  99.9999.
  1892*    -------------------------------
  1893     05  FILLER            PIC  X(0003).
  1894     05  BBIRTHO PIC  X(0006).
  1895*    -------------------------------
  1896     05  FILLER            PIC  X(0003).
  1897     05  BMEMO PIC  X(0012).
  1898*    -------------------------------
  1899     05  FILLER            PIC  X(0003).
  1900     05  BADDRS1O PIC  X(0030).
  1901*    -------------------------------
  1902     05  FILLER            PIC  X(0003).
  1903     05  BADDRS2O PIC  X(0030).
  1904*    -------------------------------
  1905     05  FILLER            PIC  X(0003).
  1906     05  BCITYSTO PIC  X(0030).
  1907*    -------------------------------
  1908     05  FILLER            PIC  X(0003).
  1909     05  BZIP5O PIC  X(0005).
  1910*    -------------------------------
  1911     05  FILLER            PIC  X(0003).
  1912     05  BDASHO PIC  X(0001).
  1913*    -------------------------------
  1914     05  FILLER            PIC  X(0003).
  1915     05  BZIP4O PIC  X(0004).
  1916*    -------------------------------
  1917     05  FILLER            PIC  X(0003).
  1918     05  BPHONEO PIC  X(0012).
  1919*    -------------------------------
  1920     05  FILLER            PIC  X(0003).
  1921     05  BERMSG1O PIC  X(0079).
  1922*    -------------------------------
  1923     05  FILLER            PIC  X(0003).
  1924     05  BERMSG2O PIC  X(0079).
  1925*    -------------------------------
  1926     05  FILLER            PIC  X(0003).
  1927     05  BPFENTRO PIC  99.
  1928*    -------------------------------
  1929     05  FILLER            PIC  X(0003).
  1930     05  BDELHDGO PIC  X(0017).
  1931*    -------------------------------
  1932 01  EL930CI REDEFINES EL930BI.
  1933     05  FILLER            PIC  X(0012).
  1934*    -------------------------------
  1935     05  CDATEL PIC S9(0004) COMP.
  1936     05  CDATEF PIC  X(0001).
  1937     05  FILLER REDEFINES CDATEF.
  1938         10  CDATEA PIC  X(0001).
  1939     05  CDATEI PIC  X(0008).
  1940*    -------------------------------
  1941     05  CTIMEL PIC S9(0004) COMP.
  1942     05  CTIMEF PIC  X(0001).
  1943     05  FILLER REDEFINES CTIMEF.
  1944         10  CTIMEA PIC  X(0001).
  1945     05  CTIMEI PIC  X(0005).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL9301.cbl
  1946*    -------------------------------
  1947     05  CBATCHL PIC S9(0004) COMP.
  1948     05  CBATCHF PIC  X(0001).
  1949     05  FILLER REDEFINES CBATCHF.
  1950         10  CBATCHA PIC  X(0001).
  1951     05  CBATCHI PIC  X(0008).
  1952*    -------------------------------
  1953     05  CSEQ1L PIC S9(0004) COMP.
  1954     05  CSEQ1F PIC  X(0001).
  1955     05  FILLER REDEFINES CSEQ1F.
  1956         10  CSEQ1A PIC  X(0001).
  1957     05  CSEQ1I PIC  X(0004).
  1958*    -------------------------------
  1959     05  CCARHD1L PIC S9(0004) COMP.
  1960     05  CCARHD1F PIC  X(0001).
  1961     05  FILLER REDEFINES CCARHD1F.
  1962         10  CCARHD1A PIC  X(0001).
  1963     05  CCARHD1I PIC  X(0005).
  1964*    -------------------------------
  1965     05  CCAR1L PIC S9(0004) COMP.
  1966     05  CCAR1F PIC  X(0001).
  1967     05  FILLER REDEFINES CCAR1F.
  1968         10  CCAR1A PIC  X(0001).
  1969     05  CCAR1I PIC  X(0001).
  1970*    -------------------------------
  1971     05  CGRPHD1L PIC S9(0004) COMP.
  1972     05  CGRPHD1F PIC  X(0001).
  1973     05  FILLER REDEFINES CGRPHD1F.
  1974         10  CGRPHD1A PIC  X(0001).
  1975     05  CGRPHD1I PIC  X(0005).
  1976*    -------------------------------
  1977     05  CGRP1L PIC S9(0004) COMP.
  1978     05  CGRP1F PIC  X(0001).
  1979     05  FILLER REDEFINES CGRP1F.
  1980         10  CGRP1A PIC  X(0001).
  1981     05  CGRP1I PIC  X(0006).
  1982*    -------------------------------
  1983     05  CSTHD1L PIC S9(0004) COMP.
  1984     05  CSTHD1F PIC  X(0001).
  1985     05  FILLER REDEFINES CSTHD1F.
  1986         10  CSTHD1A PIC  X(0001).
  1987     05  CSTHD1I PIC  X(0004).
  1988*    -------------------------------
  1989     05  CST1L PIC S9(0004) COMP.
  1990     05  CST1F PIC  X(0001).
  1991     05  FILLER REDEFINES CST1F.
  1992         10  CST1A PIC  X(0001).
  1993     05  CST1I PIC  X(0002).
  1994*    -------------------------------
  1995     05  CACCHD1L PIC S9(0004) COMP.
  1996     05  CACCHD1F PIC  X(0001).
  1997     05  FILLER REDEFINES CACCHD1F.
  1998         10  CACCHD1A PIC  X(0001).
  1999     05  CACCHD1I PIC  X(0006).
  2000*    -------------------------------
  2001     05  CACCT1L PIC S9(0004) COMP.
  2002     05  CACCT1F PIC  X(0001).
  2003     05  FILLER REDEFINES CACCT1F.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL9301.cbl
  2004         10  CACCT1A PIC  X(0001).
  2005     05  CACCT1I PIC  X(0010).
  2006*    -------------------------------
  2007     05  CCERT1L PIC S9(0004) COMP.
  2008     05  CCERT1F PIC  X(0001).
  2009     05  FILLER REDEFINES CCERT1F.
  2010         10  CCERT1A PIC  X(0001).
  2011     05  CCERT1I PIC  X(0010).
  2012*    -------------------------------
  2013     05  CSFX1L PIC S9(0004) COMP.
  2014     05  CSFX1F PIC  X(0001).
  2015     05  FILLER REDEFINES CSFX1F.
  2016         10  CSFX1A PIC  X(0001).
  2017     05  CSFX1I PIC  X(0001).
  2018*    -------------------------------
  2019     05  CEFFDT1L PIC S9(0004) COMP.
  2020     05  CEFFDT1F PIC  X(0001).
  2021     05  FILLER REDEFINES CEFFDT1F.
  2022         10  CEFFDT1A PIC  X(0001).
  2023     05  CEFFDT1I PIC  9(6).
  2024*    -------------------------------
  2025     05  CLSTNM1L PIC S9(0004) COMP.
  2026     05  CLSTNM1F PIC  X(0001).
  2027     05  FILLER REDEFINES CLSTNM1F.
  2028         10  CLSTNM1A PIC  X(0001).
  2029     05  CLSTNM1I PIC  X(0015).
  2030*    -------------------------------
  2031     05  CKIND1L PIC S9(0004) COMP.
  2032     05  CKIND1F PIC  X(0001).
  2033     05  FILLER REDEFINES CKIND1F.
  2034         10  CKIND1A PIC  X(0001).
  2035     05  CKIND1I PIC  X(0002).
  2036*    -------------------------------
  2037     05  CCANDT1L PIC S9(0004) COMP.
  2038     05  CCANDT1F PIC  X(0001).
  2039     05  FILLER REDEFINES CCANDT1F.
  2040         10  CCANDT1A PIC  X(0001).
  2041     05  CCANDT1I PIC  9(6).
  2042*    -------------------------------
  2043     05  CRFUND1L PIC S9(0004) COMP.
  2044     05  CRFUND1F PIC  X(0001).
  2045     05  FILLER REDEFINES CRFUND1F.
  2046         10  CRFUND1A PIC  X(0001).
  2047     05  CRFUND1I PIC  S9(9)V9(2).
  2048*    -------------------------------
  2049     05  CKIND2L PIC S9(0004) COMP.
  2050     05  CKIND2F PIC  X(0001).
  2051     05  FILLER REDEFINES CKIND2F.
  2052         10  CKIND2A PIC  X(0001).
  2053     05  CKIND2I PIC  X(0002).
  2054*    -------------------------------
  2055     05  CCANDT2L PIC S9(0004) COMP.
  2056     05  CCANDT2F PIC  X(0001).
  2057     05  FILLER REDEFINES CCANDT2F.
  2058         10  CCANDT2A PIC  X(0001).
  2059     05  CCANDT2I PIC  9(6).
  2060*    -------------------------------
  2061     05  CRFUND2L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL9301.cbl
  2062     05  CRFUND2F PIC  X(0001).
  2063     05  FILLER REDEFINES CRFUND2F.
  2064         10  CRFUND2A PIC  X(0001).
  2065     05  CRFUND2I PIC  S9(9)V9(2).
  2066*    -------------------------------
  2067     05  CCHK1L PIC S9(0004) COMP.
  2068     05  CCHK1F PIC  X(0001).
  2069     05  FILLER REDEFINES CCHK1F.
  2070         10  CCHK1A PIC  X(0001).
  2071     05  CCHK1I PIC  X(0001).
  2072*    -------------------------------
  2073     05  CPAYEE1L PIC S9(0004) COMP.
  2074     05  CPAYEE1F PIC  X(0001).
  2075     05  FILLER REDEFINES CPAYEE1F.
  2076         10  CPAYEE1A PIC  X(0001).
  2077     05  CPAYEE1I PIC  X(0006).
  2078*    -------------------------------
  2079     05  CLIVES1L PIC S9(0004) COMP.
  2080     05  CLIVES1F PIC  X(0001).
  2081     05  FILLER REDEFINES CLIVES1F.
  2082         10  CLIVES1A PIC  X(0001).
  2083     05  CLIVES1I PIC  9(3).
  2084*    -------------------------------
  2085     05  CSEQ2L PIC S9(0004) COMP.
  2086     05  CSEQ2F PIC  X(0001).
  2087     05  FILLER REDEFINES CSEQ2F.
  2088         10  CSEQ2A PIC  X(0001).
  2089     05  CSEQ2I PIC  X(0004).
  2090*    -------------------------------
  2091     05  CCARHD2L PIC S9(0004) COMP.
  2092     05  CCARHD2F PIC  X(0001).
  2093     05  FILLER REDEFINES CCARHD2F.
  2094         10  CCARHD2A PIC  X(0001).
  2095     05  CCARHD2I PIC  X(0005).
  2096*    -------------------------------
  2097     05  CCAR2L PIC S9(0004) COMP.
  2098     05  CCAR2F PIC  X(0001).
  2099     05  FILLER REDEFINES CCAR2F.
  2100         10  CCAR2A PIC  X(0001).
  2101     05  CCAR2I PIC  X(0001).
  2102*    -------------------------------
  2103     05  CGRPHD2L PIC S9(0004) COMP.
  2104     05  CGRPHD2F PIC  X(0001).
  2105     05  FILLER REDEFINES CGRPHD2F.
  2106         10  CGRPHD2A PIC  X(0001).
  2107     05  CGRPHD2I PIC  X(0005).
  2108*    -------------------------------
  2109     05  CGRP2L PIC S9(0004) COMP.
  2110     05  CGRP2F PIC  X(0001).
  2111     05  FILLER REDEFINES CGRP2F.
  2112         10  CGRP2A PIC  X(0001).
  2113     05  CGRP2I PIC  X(0006).
  2114*    -------------------------------
  2115     05  CSTHD2L PIC S9(0004) COMP.
  2116     05  CSTHD2F PIC  X(0001).
  2117     05  FILLER REDEFINES CSTHD2F.
  2118         10  CSTHD2A PIC  X(0001).
  2119     05  CSTHD2I PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL9301.cbl
  2120*    -------------------------------
  2121     05  CST2L PIC S9(0004) COMP.
  2122     05  CST2F PIC  X(0001).
  2123     05  FILLER REDEFINES CST2F.
  2124         10  CST2A PIC  X(0001).
  2125     05  CST2I PIC  X(0002).
  2126*    -------------------------------
  2127     05  CACCHD2L PIC S9(0004) COMP.
  2128     05  CACCHD2F PIC  X(0001).
  2129     05  FILLER REDEFINES CACCHD2F.
  2130         10  CACCHD2A PIC  X(0001).
  2131     05  CACCHD2I PIC  X(0006).
  2132*    -------------------------------
  2133     05  CACCT2L PIC S9(0004) COMP.
  2134     05  CACCT2F PIC  X(0001).
  2135     05  FILLER REDEFINES CACCT2F.
  2136         10  CACCT2A PIC  X(0001).
  2137     05  CACCT2I PIC  X(0010).
  2138*    -------------------------------
  2139     05  CCERT2L PIC S9(0004) COMP.
  2140     05  CCERT2F PIC  X(0001).
  2141     05  FILLER REDEFINES CCERT2F.
  2142         10  CCERT2A PIC  X(0001).
  2143     05  CCERT2I PIC  X(0010).
  2144*    -------------------------------
  2145     05  CSFX2L PIC S9(0004) COMP.
  2146     05  CSFX2F PIC  X(0001).
  2147     05  FILLER REDEFINES CSFX2F.
  2148         10  CSFX2A PIC  X(0001).
  2149     05  CSFX2I PIC  X(0001).
  2150*    -------------------------------
  2151     05  CEFFDT2L PIC S9(0004) COMP.
  2152     05  CEFFDT2F PIC  X(0001).
  2153     05  FILLER REDEFINES CEFFDT2F.
  2154         10  CEFFDT2A PIC  X(0001).
  2155     05  CEFFDT2I PIC  9(6).
  2156*    -------------------------------
  2157     05  CLSTNM2L PIC S9(0004) COMP.
  2158     05  CLSTNM2F PIC  X(0001).
  2159     05  FILLER REDEFINES CLSTNM2F.
  2160         10  CLSTNM2A PIC  X(0001).
  2161     05  CLSTNM2I PIC  X(0015).
  2162*    -------------------------------
  2163     05  CKIND3L PIC S9(0004) COMP.
  2164     05  CKIND3F PIC  X(0001).
  2165     05  FILLER REDEFINES CKIND3F.
  2166         10  CKIND3A PIC  X(0001).
  2167     05  CKIND3I PIC  X(0002).
  2168*    -------------------------------
  2169     05  CCANDT3L PIC S9(0004) COMP.
  2170     05  CCANDT3F PIC  X(0001).
  2171     05  FILLER REDEFINES CCANDT3F.
  2172         10  CCANDT3A PIC  X(0001).
  2173     05  CCANDT3I PIC  9(6).
  2174*    -------------------------------
  2175     05  CRFUND3L PIC S9(0004) COMP.
  2176     05  CRFUND3F PIC  X(0001).
  2177     05  FILLER REDEFINES CRFUND3F.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL9301.cbl
  2178         10  CRFUND3A PIC  X(0001).
  2179     05  CRFUND3I PIC  S9(9)V9(2).
  2180*    -------------------------------
  2181     05  CKIND4L PIC S9(0004) COMP.
  2182     05  CKIND4F PIC  X(0001).
  2183     05  FILLER REDEFINES CKIND4F.
  2184         10  CKIND4A PIC  X(0001).
  2185     05  CKIND4I PIC  X(0002).
  2186*    -------------------------------
  2187     05  CCANDT4L PIC S9(0004) COMP.
  2188     05  CCANDT4F PIC  X(0001).
  2189     05  FILLER REDEFINES CCANDT4F.
  2190         10  CCANDT4A PIC  X(0001).
  2191     05  CCANDT4I PIC  9(6).
  2192*    -------------------------------
  2193     05  CRFUND4L PIC S9(0004) COMP.
  2194     05  CRFUND4F PIC  X(0001).
  2195     05  FILLER REDEFINES CRFUND4F.
  2196         10  CRFUND4A PIC  X(0001).
  2197     05  CRFUND4I PIC  S9(9)V9(2).
  2198*    -------------------------------
  2199     05  CCHK2L PIC S9(0004) COMP.
  2200     05  CCHK2F PIC  X(0001).
  2201     05  FILLER REDEFINES CCHK2F.
  2202         10  CCHK2A PIC  X(0001).
  2203     05  CCHK2I PIC  X(0001).
  2204*    -------------------------------
  2205     05  CPAYEE2L PIC S9(0004) COMP.
  2206     05  CPAYEE2F PIC  X(0001).
  2207     05  FILLER REDEFINES CPAYEE2F.
  2208         10  CPAYEE2A PIC  X(0001).
  2209     05  CPAYEE2I PIC  X(0006).
  2210*    -------------------------------
  2211     05  CLIVES2L PIC S9(0004) COMP.
  2212     05  CLIVES2F PIC  X(0001).
  2213     05  FILLER REDEFINES CLIVES2F.
  2214         10  CLIVES2A PIC  X(0001).
  2215     05  CLIVES2I PIC  9(3).
  2216*    -------------------------------
  2217     05  CERMSG1L PIC S9(0004) COMP.
  2218     05  CERMSG1F PIC  X(0001).
  2219     05  FILLER REDEFINES CERMSG1F.
  2220         10  CERMSG1A PIC  X(0001).
  2221     05  CERMSG1I PIC  X(0079).
  2222*    -------------------------------
  2223     05  CERMSG2L PIC S9(0004) COMP.
  2224     05  CERMSG2F PIC  X(0001).
  2225     05  FILLER REDEFINES CERMSG2F.
  2226         10  CERMSG2A PIC  X(0001).
  2227     05  CERMSG2I PIC  X(0079).
  2228*    -------------------------------
  2229     05  CPFENTRL PIC S9(0004) COMP.
  2230     05  CPFENTRF PIC  X(0001).
  2231     05  FILLER REDEFINES CPFENTRF.
  2232         10  CPFENTRA PIC  X(0001).
  2233     05  CPFENTRI PIC  9(2).
  2234*    -------------------------------
  2235     05  CDELHDGL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL9301.cbl
  2236     05  CDELHDGF PIC  X(0001).
  2237     05  FILLER REDEFINES CDELHDGF.
  2238         10  CDELHDGA PIC  X(0001).
  2239     05  CDELHDGI PIC  X(0017).
  2240 01  EL930CO REDEFINES EL930BI.
  2241     05  FILLER            PIC  X(0012).
  2242*    -------------------------------
  2243     05  FILLER            PIC  X(0003).
  2244     05  CDATEO PIC  X(0008).
  2245*    -------------------------------
  2246     05  FILLER            PIC  X(0003).
  2247     05  CTIMEO PIC  99.99.
  2248*    -------------------------------
  2249     05  FILLER            PIC  X(0003).
  2250     05  CBATCHO PIC  X(0008).
  2251*    -------------------------------
  2252     05  FILLER            PIC  X(0003).
  2253     05  CSEQ1O PIC  X(0004).
  2254*    -------------------------------
  2255     05  FILLER            PIC  X(0003).
  2256     05  CCARHD1O PIC  X(0005).
  2257*    -------------------------------
  2258     05  FILLER            PIC  X(0003).
  2259     05  CCAR1O PIC  X(0001).
  2260*    -------------------------------
  2261     05  FILLER            PIC  X(0003).
  2262     05  CGRPHD1O PIC  X(0005).
  2263*    -------------------------------
  2264     05  FILLER            PIC  X(0003).
  2265     05  CGRP1O PIC  X(0006).
  2266*    -------------------------------
  2267     05  FILLER            PIC  X(0003).
  2268     05  CSTHD1O PIC  X(0004).
  2269*    -------------------------------
  2270     05  FILLER            PIC  X(0003).
  2271     05  CST1O PIC  X(0002).
  2272*    -------------------------------
  2273     05  FILLER            PIC  X(0003).
  2274     05  CACCHD1O PIC  X(0006).
  2275*    -------------------------------
  2276     05  FILLER            PIC  X(0003).
  2277     05  CACCT1O PIC  X(0010).
  2278*    -------------------------------
  2279     05  FILLER            PIC  X(0003).
  2280     05  CCERT1O PIC  X(0010).
  2281*    -------------------------------
  2282     05  FILLER            PIC  X(0003).
  2283     05  CSFX1O PIC  X(0001).
  2284*    -------------------------------
  2285     05  FILLER            PIC  X(0003).
  2286     05  CEFFDT1O PIC  999999.
  2287*    -------------------------------
  2288     05  FILLER            PIC  X(0003).
  2289     05  CLSTNM1O PIC  X(0015).
  2290*    -------------------------------
  2291     05  FILLER            PIC  X(0003).
  2292     05  CKIND1O PIC  X(0002).
  2293*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL9301.cbl
  2294     05  FILLER            PIC  X(0003).
  2295     05  CCANDT1O PIC  999999.
  2296*    -------------------------------
  2297     05  FILLER            PIC  X(0003).
  2298     05  CRFUND1O PIC  9999999.99-.
  2299*    -------------------------------
  2300     05  FILLER            PIC  X(0003).
  2301     05  CKIND2O PIC  X(0002).
  2302*    -------------------------------
  2303     05  FILLER            PIC  X(0003).
  2304     05  CCANDT2O PIC  999999.
  2305*    -------------------------------
  2306     05  FILLER            PIC  X(0003).
  2307     05  CRFUND2O PIC  9999999.99-.
  2308*    -------------------------------
  2309     05  FILLER            PIC  X(0003).
  2310     05  CCHK1O PIC  X(0001).
  2311*    -------------------------------
  2312     05  FILLER            PIC  X(0003).
  2313     05  CPAYEE1O PIC  X(0006).
  2314*    -------------------------------
  2315     05  FILLER            PIC  X(0003).
  2316     05  CLIVES1O PIC  999.
  2317*    -------------------------------
  2318     05  FILLER            PIC  X(0003).
  2319     05  CSEQ2O PIC  X(0004).
  2320*    -------------------------------
  2321     05  FILLER            PIC  X(0003).
  2322     05  CCARHD2O PIC  X(0005).
  2323*    -------------------------------
  2324     05  FILLER            PIC  X(0003).
  2325     05  CCAR2O PIC  X(0001).
  2326*    -------------------------------
  2327     05  FILLER            PIC  X(0003).
  2328     05  CGRPHD2O PIC  X(0005).
  2329*    -------------------------------
  2330     05  FILLER            PIC  X(0003).
  2331     05  CGRP2O PIC  X(0006).
  2332*    -------------------------------
  2333     05  FILLER            PIC  X(0003).
  2334     05  CSTHD2O PIC  X(0004).
  2335*    -------------------------------
  2336     05  FILLER            PIC  X(0003).
  2337     05  CST2O PIC  X(0002).
  2338*    -------------------------------
  2339     05  FILLER            PIC  X(0003).
  2340     05  CACCHD2O PIC  X(0006).
  2341*    -------------------------------
  2342     05  FILLER            PIC  X(0003).
  2343     05  CACCT2O PIC  X(0010).
  2344*    -------------------------------
  2345     05  FILLER            PIC  X(0003).
  2346     05  CCERT2O PIC  X(0010).
  2347*    -------------------------------
  2348     05  FILLER            PIC  X(0003).
  2349     05  CSFX2O PIC  X(0001).
  2350*    -------------------------------
  2351     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL9301.cbl
  2352     05  CEFFDT2O PIC  999999.
  2353*    -------------------------------
  2354     05  FILLER            PIC  X(0003).
  2355     05  CLSTNM2O PIC  X(0015).
  2356*    -------------------------------
  2357     05  FILLER            PIC  X(0003).
  2358     05  CKIND3O PIC  X(0002).
  2359*    -------------------------------
  2360     05  FILLER            PIC  X(0003).
  2361     05  CCANDT3O PIC  999999.
  2362*    -------------------------------
  2363     05  FILLER            PIC  X(0003).
  2364     05  CRFUND3O PIC  9999999.99-.
  2365*    -------------------------------
  2366     05  FILLER            PIC  X(0003).
  2367     05  CKIND4O PIC  X(0002).
  2368*    -------------------------------
  2369     05  FILLER            PIC  X(0003).
  2370     05  CCANDT4O PIC  999999.
  2371*    -------------------------------
  2372     05  FILLER            PIC  X(0003).
  2373     05  CRFUND4O PIC  9999999.99-.
  2374*    -------------------------------
  2375     05  FILLER            PIC  X(0003).
  2376     05  CCHK2O PIC  X(0001).
  2377*    -------------------------------
  2378     05  FILLER            PIC  X(0003).
  2379     05  CPAYEE2O PIC  X(0006).
  2380*    -------------------------------
  2381     05  FILLER            PIC  X(0003).
  2382     05  CLIVES2O PIC  999.
  2383*    -------------------------------
  2384     05  FILLER            PIC  X(0003).
  2385     05  CERMSG1O PIC  X(0079).
  2386*    -------------------------------
  2387     05  FILLER            PIC  X(0003).
  2388     05  CERMSG2O PIC  X(0079).
  2389*    -------------------------------
  2390     05  FILLER            PIC  X(0003).
  2391     05  CPFENTRO PIC  99.
  2392*    -------------------------------
  2393     05  FILLER            PIC  X(0003).
  2394     05  CDELHDGO PIC  X(0017).
  2395*    -------------------------------
  2396
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL9301.cbl
  2398
  2399 01  MAP-B REDEFINES EL930BI.
  2400     12  FILLER                      PIC X(42).
  2401     12  DATA-AREA-B.
  2402         16  BSEQ-LEN                PIC S9(4)  COMP.
  2403         16  BSEQ-ATTRB              PIC X.
  2404         16  BSEQ                    PIC 9(4).
  2405         16  FILLER                  PIC X(8).
  2406         16  BCAR-LEN                PIC S9(4)  COMP.
  2407         16  BCAR-ATTRB              PIC X.
  2408         16  BCAR                    PIC X.
  2409         16  FILLER                  PIC X(8).
  2410         16  BGRP-LEN                PIC S9(4)  COMP.
  2411         16  BGRP-ATTRB              PIC X.
  2412         16  BGRP                    PIC X(6).
  2413         16  FILLER                  PIC X(7).
  2414         16  BST-LEN                 PIC S9(4)  COMP.
  2415         16  BST-ATTRB               PIC X.
  2416         16  BST                     PIC XX.
  2417         16  FILLER                  PIC X(9).
  2418         16  BACCT-LEN               PIC S9(4)  COMP.
  2419         16  BACCT-ATTRB             PIC X.
  2420         16  BACCT                   PIC X(10).
  2421         16  BCERT-LEN               PIC S9(4)  COMP.
  2422         16  BCERT-ATTRB             PIC X.
  2423         16  BCERT                   PIC X(10).
  2424         16  BSFX-LEN                PIC S9(4)  COMP.
  2425         16  BSFX-ATTRB              PIC X.
  2426         16  BSFX                    PIC X.
  2427         16  BEFFDT-LEN              PIC S9(4)  COMP.
  2428         16  BEFFDT-ATTRB            PIC X.
  2429         16  BEFFDT                  PIC 9(6).
  2430         16  BLAST-NAME-LEN          PIC S9(4)  COMP.
  2431         16  BLAST-NAME-ATTRB        PIC X.
  2432         16  BLAST-NAME              PIC X(15).
  2433         16  B1ST-NAME-LEN           PIC S9(4)  COMP.
  2434         16  B1ST-NAME-ATTRB         PIC X.
  2435         16  B1ST-NAME               PIC X(10).
  2436         16  BINIT-LEN               PIC S9(4)  COMP.
  2437         16  BINIT-ATTRB             PIC X.
  2438         16  BINIT                   PIC X.
  2439         16  BSEX-LEN                PIC S9(4)  COMP.
  2440         16  BSEX-ATTRB              PIC X.
  2441         16  BSEX                    PIC X.
  2442         16  BAGE-LEN                PIC S9(4)  COMP.
  2443         16  BAGE-ATTRB              PIC X.
  2444         16  BAGE                    PIC 99.
  2445         16  BSSNUM-LEN              PIC S9(4)  COMP.
  2446         16  BSSNUM-ATTRB            PIC X.
  2447         16  BSSNUM                  PIC X(11).
  2448
  2449         16  MAP-B-COVERAGE OCCURS 2 TIMES.
  2450
  2451             20  BKIND-LEN           PIC S9(4)  COMP.
  2452             20  BKIND-ATTRB         PIC X.
  2453             20  BKIND               PIC XX.
  2454             20  BTYPE-LEN           PIC S9(4)  COMP.
  2455             20  BTYPE-ATTRB         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL9301.cbl
  2456             20  BTYPE               PIC X(3).
  2457             20  BTERM-LEN           PIC S9(4)  COMP.
  2458             20  BTERM-ATTRB         PIC X.
  2459             20  BTERMI              PIC 999.
  2460             20  BTERMO REDEFINES
  2461                            BTERMI   PIC ZZZ.
  2462             20  BBEN-LEN            PIC S9(4)  COMP.
  2463             20  BBEN-ATTRB          PIC X.
  2464             20  BBENI               PIC 9(12).
  2465             20  BBENO REDEFINES
  2466                               BBENI PIC Z(9).99.
  2467             20  BPREM-LEN           PIC S9(4)  COMP.
  2468             20  BPREM-ATTRB         PIC X.
  2469             20  BPREMI              PIC 9(11).
  2470             20  BPREMO REDEFINES
  2471                              BPREMI PIC Z(7).99-.
  2472             20  BEXPIRE-LEN         PIC S9(4)  COMP.
  2473             20  BEXPIRE-ATTRB       PIC X.
  2474             20  BEXPIRE             PIC 9(6).
  2475             20  BCRIT-PERD-LEN      PIC S9(4)  COMP.
  2476             20  BCRIT-PERD-ATTRB    PIC X.
  2477             20  BCRIT-PERDI         PIC 99.
  2478             20  BCRIT-PERDO REDEFINES
  2479                         BCRIT-PERDI PIC ZZ.
  2480             20  BALT-BEN-LEN        PIC S9(4)  COMP.
  2481             20  BALT-BEN-ATTRB      PIC X.
  2482             20  BALT-BENI           PIC 9(12).
  2483             20  BALT-BENO REDEFINES
  2484                               BALT-BENI PIC Z(9).ZZ.
  2485             20  BALT-PREM-LEN       PIC S9(4)  COMP.
  2486             20  BALT-PREM-ATTRB     PIC X.
  2487             20  BALT-PREMI          PIC 9(9).
  2488             20  BALT-PREMO REDEFINES
  2489                               BALT-PREMI PIC Z(6).ZZ.
  2490
  2491         16  BLIVES-LEN              PIC S9(4)  COMP.
  2492         16  BLIVES-ATTRB            PIC X.
  2493         16  BLIVESI                 PIC 9(3).
  2494         16  BLIVESO    REDEFINES
  2495                          BLIVESI    PIC Z(3).
  2496         16  BJNT-1ST-NAME-LEN       PIC S9(4)   COMP.
  2497         16  BJNT-1ST-NAME-ATTRB     PIC X.
  2498         16  BJNT-1ST-NAME           PIC X(10).
  2499         16  BJNT-INIT-LEN           PIC S9(4)   COMP.
  2500         16  BJNT-INIT-ATTRB         PIC X.
  2501         16  BJNT-INIT               PIC X.
  2502         16  BJNT-LST-NAME-LEN       PIC S9(4)   COMP.
  2503         16  BJNT-LST-NAME-ATTRB     PIC X.
  2504         16  BJNT-LST-NAME           PIC X(15).
  2505         16  BJNT-AGE-LEN            PIC S9(4)   COMP.
  2506         16  BJNT-AGE-ATTRB          PIC X.
  2507         16  BJNT-AGE                PIC 99.
  2508         16  BBENEFICIARY-LEN        PIC S9(4)   COMP.
  2509         16  BBENEFICIARY-ATTRB      PIC X.
  2510         16  BBENEFICIARY            PIC X(25).
  2511         16  B1ST-PMT-LEN            PIC S9(4)  COMP.
  2512         16  B1ST-PMT-ATTRB          PIC X.
  2513         16  B1ST-PMT                PIC 9(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL9301.cbl
  2514         16  BDAYS-LEN               PIC S9(4)  COMP.
  2515         16  BDAYS-ATTRB             PIC X.
  2516         16  BDAYSI                  PIC 9(3).
  2517         16  BDAYSO REDEFINES
  2518                          BDAYSI     PIC ZZZ.
  2519         16  BLN-TERM-LEN            PIC S9(4)  COMP.
  2520         16  BLN-TERM-ATTRB          PIC X.
  2521         16  BLN-TERMI               PIC 9(3).
  2522         16  BLN-TERMO REDEFINES
  2523                          BLN-TERMI  PIC ZZZ.
  2524         16  BLN-OFFICER-LEN         PIC S9(4)  COMP.
  2525         16  BLN-OFFICER-ATTRB       PIC X.
  2526         16  BLN-OFFICER             PIC XXX.
  2527         16  BMODE-LEN               PIC S9(4)  COMP.
  2528         16  BMODE-ATTRB             PIC X.
  2529         16  BMODE                   PIC X.
  2530         16  BFREQ-LEN               PIC S9(4)  COMP.
  2531         16  BFREQ-ATTRB             PIC X.
  2532         16  BFREQI                  PIC 99.
  2533         16  BFREQO REDEFINES BFREQI PIC ZZ.
  2534         16  BPMTS-LEN               PIC S9(4)  COMP.
  2535         16  BPMTS-ATTRB             PIC X.
  2536         16  BPMTS-IN                PIC 999.
  2537         16  BPMTS-OUT REDEFINES BPMTS-IN
  2538                                     PIC ZZZ.
  2539         16  BPMT-LEN                PIC S9(4)  COMP.
  2540         16  BPMT-ATTRB              PIC X.
  2541         16  BPMTI                   PIC 9(9).
  2542         16  BPMTO REDEFINES BPMTI   PIC Z(6).ZZ.
  2543         16  BCAPTN-LEN              PIC S9(4)  COMP.
  2544         16  BCAPTN-ATTRB            PIC X.
  2545         16  BCAPTN                  PIC X(10).
  2546         16  BRINCD-LEN              PIC S9(4)  COMP.
  2547         16  BRINCD-ATTRB            PIC X.
  2548         16  BRINCD                  PIC X.
  2549         16  BENTRY-LEN              PIC S9(4)  COMP.
  2550         16  BENTRY-ATTRB            PIC X.
  2551         16  BENTRY                  PIC X.
  2552         16  BSKPCD-LEN              PIC S9(4)  COMP.
  2553         16  BSKPCD-ATTRB            PIC X.
  2554         16  BSKPCD                  PIC X.
  2555         16  BIND-GRP-LEN            PIC S9(4)  COMP.
  2556         16  BIND-GRP-ATTRB          PIC X.
  2557         16  BIND-GRP                PIC X.
  2558         16  BSIG-LEN                PIC S9(4)  COMP.
  2559         16  BSIG-ATTRB              PIC X.
  2560         16  BSIG                    PIC X.
  2561         16  BPOLICY-LEN             PIC S9(4)  COMP.
  2562         16  BPOLICY-ATTRB           PIC X.
  2563         16  BPOLICY                 PIC X(12).
  2564         16  BRTCLS-LEN              PIC S9(4)  COMP.
  2565         16  BRTCLS-ATTRB            PIC X.
  2566         16  BRTCLS                  PIC XX.
  2567         16  BAPR-LEN                PIC S9(4)  COMP.
  2568         16  BAPR-ATTRB              PIC X.
  2569         16  BAPR-IN                 PIC 9(7).
  2570         16  BAPR-OUT REDEFINES BAPR-IN
  2571                                     PIC 99.9999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL9301.cbl
  2572         16  BBIRTH-LEN              PIC S9(4)  COMP.
  2573         16  BBIRTH-ATTRB            PIC X.
  2574         16  BBIRTH-DT               PIC 9(6).
  2575         16  BMEM-NO-LEN             PIC S9(4)   COMP.
  2576         16  BMEM-NO-ATTRB           PIC X.
  2577         16  BMEM-NO                 PIC X(12).
  2578         16  BADDRS1-LEN             PIC S9(4)  COMP.
  2579         16  BADDRS1-ATTRB           PIC X.
  2580         16  BADDRS1                 PIC X(30).
  2581         16  BADDRS2-LEN             PIC S9(4)  COMP.
  2582         16  BADDRS2-ATTRB           PIC X.
  2583         16  BADDRS2                 PIC X(30).
  2584         16  BCITYST-LEN             PIC S9(4)  COMP.
  2585         16  BCITYST-ATTRB           PIC X.
  2586         16  BCITYST                 PIC X(30).
  2587         16  BZIP5-LEN               PIC S9(4)  COMP.
  2588         16  BZIP5-ATTRB             PIC X.
  2589         16  BZIP5                   PIC X(5).
  2590         16  BDASH-LEN               PIC S9(4)  COMP.
  2591         16  BDASH-ATTRB             PIC X.
  2592         16  BDASH                   PIC X.
  2593         16  BZIP4-LEN               PIC S9(4)  COMP.
  2594         16  BZIP4-ATTRB             PIC X.
  2595         16  BZIP4                   PIC X(4).
  2596         16  BPHONE-LEN              PIC S9(4)  COMP.
  2597         16  BPHONE-ATTRB            PIC X.
  2598         16  BPHONE                  PIC 9(12).
  2599         16  BPHONE-NO REDEFINES
  2600                               BPHONE PIC 999B999B9999.
  2601
  2602
  2603 01  MAP-C REDEFINES EL930BI.
  2604     12  FILLER                  PIC X(42).
  2605     12  DATA-AREA-C             OCCURS 2 TIMES.
  2606         16  CSEQ-LEN                PIC S9(4)  COMP.
  2607         16  CSEQ-ATTRB              PIC X.
  2608         16  CSEQ                    PIC 9(4).
  2609         16  FILLER                  PIC X(8).
  2610         16  CCAR-LEN                PIC S9(4)  COMP.
  2611         16  CCAR-ATTRB              PIC X.
  2612         16  CCAR                    PIC X.
  2613         16  FILLER                  PIC X(8).
  2614         16  CGRP-LEN                PIC S9(4)  COMP.
  2615         16  CGRP-ATTRB              PIC X.
  2616         16  CGRP                    PIC X(6).
  2617         16  FILLER                  PIC X(7).
  2618         16  CST-LEN                 PIC S9(4)  COMP.
  2619         16  CST-ATTRB               PIC X.
  2620         16  CST                     PIC XX.
  2621         16  FILLER                  PIC X(9).
  2622         16  CACCT-LEN               PIC S9(4)  COMP.
  2623         16  CACCT-ATTRB             PIC X.
  2624         16  CACCT                   PIC X(10).
  2625         16  CCERT-LEN               PIC S9(4)  COMP.
  2626         16  CCERT-ATTRB             PIC X.
  2627         16  CCERT                   PIC X(10).
  2628         16  CSFX-LEN                PIC S9(4)  COMP.
  2629         16  CSFX-ATTRB              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL9301.cbl
  2630         16  CSFX                    PIC X.
  2631         16  CEFFDT-LEN              PIC S9(4)  COMP.
  2632         16  CEFFDT-ATTRB            PIC X.
  2633         16  CEFFDT                  PIC 9(6).
  2634         16  CLAST-NAME-LEN          PIC S9(4)  COMP.
  2635         16  CLAST-NAME-ATTRB        PIC X.
  2636         16  CLAST-NAME              PIC X(15).
  2637         16  CANCEL-INFO.
  2638             20  CKIND1-LEN          PIC S9(4)  COMP.
  2639             20  CKIND1-ATTRB        PIC X.
  2640             20  CKIND1              PIC XX.
  2641             20  CCANDT1-LEN         PIC S9(4)  COMP.
  2642             20  CCANDT1-ATTRB       PIC X.
  2643             20  CCANDT1             PIC 9(6).
  2644             20  CREFUND1-LEN        PIC S9(4)  COMP.
  2645             20  CREFUND1-ATTRB      PIC X.
  2646             20  CREFUND1I           PIC X(11).
  2647             20  CREFUND1O REDEFINES
  2648                           CREFUND1I PIC Z(7).99-.
  2649             20  CKIND2-LEN          PIC S9(4)  COMP.
  2650             20  CKIND2-ATTRB        PIC X.
  2651             20  CKIND2              PIC XX.
  2652             20  CCANDT2-LEN         PIC S9(4)  COMP.
  2653             20  CCANDT2-ATTRB       PIC X.
  2654             20  CCANDT2             PIC 9(6).
  2655             20  CREFUND2-LEN        PIC S9(4)  COMP.
  2656             20  CREFUND2-ATTRB      PIC X.
  2657             20  CREFUND2I           PIC X(11).
  2658             20  CREFUND2O REDEFINES
  2659                           CREFUND2I PIC Z(7).99-.
  2660             20  CCHK-LEN            PIC S9(4)  COMP.
  2661             20  CCHK-ATTRB          PIC X.
  2662             20  CCHK                PIC X.
  2663             20  CPAYEE-LEN          PIC S9(4)  COMP.
  2664             20  CPAYEE-ATTRB        PIC X.
  2665             20  CPAYEE              PIC X(6).
  2666             20  CLIVES-LEN          PIC S9(4)  COMP.
  2667             20  CLIVES-ATTRB        PIC X.
  2668             20  CLIVESI             PIC 999.
  2669             20  CLIVESO REDEFINES
  2670                          CLIVESI    PIC ZZZ.
  2671
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL9301.cbl
  2673****************************************************************
  2674*
  2675* Copyright (c) 2007 by Clerity Solutions, Inc.
  2676* All rights reserved.
  2677*
  2678****************************************************************
  2679 01  DFHEIV.
  2680   02  DFHEIV0               PIC X(35).
  2681   02  DFHEIV1               PIC X(08).
  2682   02  DFHEIV2               PIC X(08).
  2683   02  DFHEIV3               PIC X(08).
  2684   02  DFHEIV4               PIC X(06).
  2685   02  DFHEIV5               PIC X(04).
  2686   02  DFHEIV6               PIC X(04).
  2687   02  DFHEIV7               PIC X(02).
  2688   02  DFHEIV8               PIC X(02).
  2689   02  DFHEIV9               PIC X(01).
  2690   02  DFHEIV10              PIC S9(7) COMP-3.
  2691   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2692   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2693   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2694   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2695   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2696   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2697   02  DFHEIV17              PIC X(04).
  2698   02  DFHEIV18              PIC X(04).
  2699   02  DFHEIV19              PIC X(04).
  2700   02  DFHEIV20              USAGE IS POINTER.
  2701   02  DFHEIV21              USAGE IS POINTER.
  2702   02  DFHEIV22              USAGE IS POINTER.
  2703   02  DFHEIV23              USAGE IS POINTER.
  2704   02  DFHEIV24              USAGE IS POINTER.
  2705   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2706   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2707   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2708   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2709   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2710   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2711   02  FILLER                PIC X(02).
  2712   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2713   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2714   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2715   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2716   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2717 LINKAGE  SECTION.
  2718*****************************************************************
  2719*                                                               *
  2720* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2721* All rights reserved.                                          *
  2722*                                                               *
  2723*****************************************************************
  2724 01  dfheiblk.
  2725     02  eibtime          pic s9(7) comp-3.
  2726     02  eibdate          pic s9(7) comp-3.
  2727     02  eibtrnid         pic x(4).
  2728     02  eibtaskn         pic s9(7) comp-3.
  2729     02  eibtrmid         pic x(4).
  2730     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL9301.cbl
  2731     02  eibcposn         pic s9(4) comp.
  2732     02  eibcalen         pic s9(4) comp.
  2733     02  eibaid           pic x(1).
  2734     02  eibfiller1       pic x(1).
  2735     02  eibfn            pic x(2).
  2736     02  eibfiller2       pic x(2).
  2737     02  eibrcode         pic x(6).
  2738     02  eibfiller3       pic x(2).
  2739     02  eibds            pic x(8).
  2740     02  eibreqid         pic x(8).
  2741     02  eibrsrce         pic x(8).
  2742     02  eibsync          pic x(1).
  2743     02  eibfree          pic x(1).
  2744     02  eibrecv          pic x(1).
  2745     02  eibsend          pic x(1).
  2746     02  eibatt           pic x(1).
  2747     02  eibeoc           pic x(1).
  2748     02  eibfmh           pic x(1).
  2749     02  eibcompl         pic x(1).
  2750     02  eibsig           pic x(1).
  2751     02  eibconf          pic x(1).
  2752     02  eiberr           pic x(1).
  2753     02  eibrldbk         pic x(1).
  2754     02  eiberrcd         pic x(4).
  2755     02  eibsynrb         pic x(1).
  2756     02  eibnodat         pic x(1).
  2757     02  eibfiller5       pic x(2).
  2758     02  eibresp          pic 9(09) comp.
  2759     02  eibresp2         pic 9(09) comp.
  2760     02  dfheigdj         pic s9(4) comp.
  2761     02  dfheigdk         pic s9(4) comp.
  2762 01  DFHCOMMAREA             PIC X(1024).
  2763
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL9301.cbl
  2765 01  PARMLIST.
  2766     02  FILLER              PIC S9(8)   COMP.
  2767     02  ERPNDT-POINTER      PIC S9(8)   COMP.
  2768     02  ELCNTL-POINTER      PIC S9(8)   COMP.
  2769     02  ELCERT-POINTER      PIC S9(8)   COMP.
  2770     02  ERPNDM-POINTER      PIC S9(8)   COMP.
  2771     02  ERACCT-POINTER      PIC S9(8)   COMP.
  2772
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL9301.cbl
  2774
  2775*                                COPY ERCPNDB.
  2776******************************************************************
  2777*                                                                *
  2778*                                                                *
  2779*                            ERCPNDB.                            *
  2780*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2781*                            VMOD=2.025                          *
  2782*                                                                *
  2783*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  2784*                                                                *
  2785******************************************************************
  2786*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  2787*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  2788******************************************************************
  2789*                                                                *
  2790*                                                                *
  2791*   FILE TYPE = VSAM,KSDS                                        *
  2792*   RECORD SIZE = 585  RECFORM = FIXED                           *
  2793*                                                                *
  2794*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  2795*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  2796*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  2797*                                                 RKP=13,LEN=36  *
  2798*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  2799*                                      AND CHG-SEQ.)             *
  2800*                                                RKP=49,LEN=11   *
  2801*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  2802*                                      AND CHG-SEQ.)             *
  2803*                                                RKP=60,LEN=15   *
  2804*                                                                *
  2805*   LOG = NO                                                     *
  2806*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2807******************************************************************
  2808******************************************************************
  2809*                   C H A N G E   L O G
  2810*
  2811* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2812*-----------------------------------------------------------------
  2813*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2814* EFFECTIVE    NUMBER
  2815*-----------------------------------------------------------------
  2816* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  2817* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2818* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  2819* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  2820* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  2821* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  2822* 032306                   PEMA  ADD BOW LOAN NUMBER
  2823* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  2824* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  2825* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  2826* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  2827* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  2828* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  2829* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2830******************************************************************
  2831
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL9301.cbl
  2832 01  PENDING-BUSINESS.
  2833     12  PB-RECORD-ID                     PIC XX.
  2834         88  VALID-PB-ID                        VALUE 'PB'.
  2835
  2836     12  PB-CONTROL-PRIMARY.
  2837         16  PB-COMPANY-CD                PIC X.
  2838         16  PB-ENTRY-BATCH               PIC X(6).
  2839         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  2840         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  2841
  2842     12  PB-CONTROL-BY-ACCOUNT.
  2843         16  PB-COMPANY-CD-A1             PIC X.
  2844         16  PB-CARRIER                   PIC X.
  2845         16  PB-GROUPING.
  2846             20  PB-GROUPING-PREFIX       PIC XXX.
  2847             20  PB-GROUPING-PRIME        PIC XXX.
  2848         16  PB-STATE                     PIC XX.
  2849         16  PB-ACCOUNT.
  2850             20  PB-ACCOUNT-PREFIX        PIC X(4).
  2851             20  PB-ACCOUNT-PRIME         PIC X(6).
  2852         16  PB-CERT-EFF-DT               PIC XX.
  2853         16  PB-CERT-NO.
  2854             20  PB-CERT-PRIME            PIC X(10).
  2855             20  PB-CERT-SFX              PIC X.
  2856         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  2857
  2858         16  PB-RECORD-TYPE               PIC X.
  2859             88  PB-MAILING-DATA                VALUE '0'.
  2860             88  PB-ISSUE                       VALUE '1'.
  2861             88  PB-CANCELLATION                VALUE '2'.
  2862             88  PB-BATCH-TRAILER               VALUE '9'.
  2863
  2864     12  PB-CONTROL-BY-ORIG-BATCH.
  2865         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  2866         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  2867         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  2868         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  2869
  2870     12  PB-CONTROL-BY-CSR.
  2871         16  PB-CSR-COMPANY-CD            PIC X.
  2872         16  PB-CSR-ID                    PIC X(4).
  2873         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  2874         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  2875         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  2876******************************************************************
  2877*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  2878******************************************************************
  2879
  2880     12  PB-LAST-MAINT-DT                 PIC XX.
  2881     12  PB-LAST-MAINT-BY                 PIC X(4).
  2882     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  2883
  2884     12  PB-RECORD-BODY                   PIC X(375).
  2885
  2886     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  2887         16  PB-CERT-ORIGIN               PIC X.
  2888             88  CLASIC-CREATED-CERT         VALUE '1'.
  2889         16  PB-I-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL9301.cbl
  2890             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  2891             20  PB-I-INSURED-FIRST-NAME.
  2892                 24  PB-I-INSURED-1ST-INIT PIC X.
  2893                 24  FILLER                PIC X(9).
  2894             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  2895         16  PB-I-AGE                     PIC S99   COMP-3.
  2896         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  2897         16  PB-I-BIRTHDAY                PIC XX.
  2898         16  PB-I-INSURED-SEX             PIC X.
  2899             88  PB-SEX-MALE     VALUE 'M'.
  2900             88  PB-SEX-FEMALE   VALUE 'F'.
  2901
  2902         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  2903         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  2904         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  2905         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  2906         16  PB-I-SKIP-CODE               PIC X.
  2907             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  2908             88  PB-SKIP-JULY              VALUE '1'.
  2909             88  PB-SKIP-AUGUST            VALUE '2'.
  2910             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  2911             88  PB-SKIP-JULY-AUG          VALUE '4'.
  2912             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  2913             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  2914             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  2915             88  PB-SKIP-JUNE              VALUE '8'.
  2916             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  2917             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  2918             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  2919         16  PB-I-TERM-TYPE               PIC X.
  2920             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  2921             88  PB-PAID-WEEKLY            VALUE 'W'.
  2922             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  2923             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  2924             88  PB-PAID-13-YEARLY         VALUE 'T'.
  2925         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  2926         16  PB-I-POLICY-FORM-NO          PIC X(12).
  2927         16  PB-I-DATA-ENTRY-SW           PIC X.
  2928             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  2929             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  2930             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  2931             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  2932         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  2933         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  2934*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  2935         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  2936         16  FILLER                       PIC X.
  2937
  2938         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  2939             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  2940             88  PB-INVALID-LIFE             VALUE '  ' '00'
  2941                                                   '90' THRU '99'.
  2942         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  2943                                          PIC XX.
  2944         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  2945         16  PB-I-AMOUNT-FINANCED REDEFINES
  2946                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  2947         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL9301.cbl
  2948         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  2949                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  2950         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2951         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  2952         16  PB-I-CLP-AMOUNT REDEFINES
  2953                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  2954         16  PB-I-LF-CALC-FLAG            PIC X.
  2955             88 PB-COMP-LF-PREM               VALUE '?'.
  2956         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  2957         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  2958         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  2959         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  2960         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2961         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  2962         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  2963         16  PB-I-LF-ABBR                 PIC XXX.
  2964         16  PB-I-LF-INPUT-CD             PIC XX.
  2965
  2966         16  PB-I-AH-BENEFIT-CD           PIC XX.
  2967             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  2968             88  PB-INVALID-AH               VALUE '  ' '00'
  2969                                                   '90' THRU '99'.
  2970         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  2971         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  2972         16  PB-I-AH-CALC-FLAG            PIC X.
  2973             88 PB-COMP-AH-PREM                  VALUE '?'.
  2974         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  2975         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  2976         16  PB-I-AH-POLICY-FEE           PIC S9(3)V99   COMP-3.
  2977         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  2978         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  2979         16  PB-I-AH-ABBR                 PIC XXX.
  2980         16  PB-I-AH-INPUT-CD             PIC XXX.
  2981
  2982         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  2983         16  PB-I-REIN-TABLE              PIC XXX.
  2984         16  PB-I-BUSINESS-TYPE           PIC 99.
  2985         16  PB-I-INDV-GRP-CD             PIC X.
  2986         16  PB-I-MORT-CODE.
  2987             20  PB-I-TABLE               PIC X.
  2988             20  PB-I-INTEREST            PIC XX.
  2989             20  PB-I-MORT-TYP            PIC X.
  2990         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  2991         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  2992         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  2993         16  PB-I-INDV-GRP-OVRD           PIC X.
  2994         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  2995         16  PB-I-SIG-SW                  PIC X.
  2996             88  PB-POLICY-SIGNED             VALUE 'Y'.
  2997         16  PB-I-RATE-CLASS              PIC XX.
  2998         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  2999         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  3000         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  3001         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  3002         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  3003         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  3004         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  3005         16  PB-I-BENEFIT-TYPE            PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL9301.cbl
  3006         16  PB-I-OB-FLAG                 PIC X.
  3007             88  PB-I-OB                      VALUE 'B'.
  3008             88  PB-I-SUMMARY                 VALUE 'Z'.
  3009         16  PB-I-ENTRY-STATUS            PIC X.
  3010             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  3011                                              'M' '5' '9' '2'.
  3012             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  3013             88  PB-I-POLICY-PENDING          VALUE '2'.
  3014             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  3015             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  3016             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  3017             88  PB-I-REIN-ONLY               VALUE '9'.
  3018             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  3019             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  3020             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  3021             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  3022         16  PB-I-INT-CODE                PIC X.
  3023             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  3024             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  3025         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  3026         16  PB-I-SOC-SEC-NO              PIC X(11).
  3027         16  PB-I-MEMBER-NO               PIC X(12).
  3028         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  3029*        16  PB-I-LOAN-OFFICER            PIC XXX.
  3030         16  PB-I-OLD-LOF                 PIC XXX.
  3031         16  PB-I-LF-EXPIRE-DT            PIC XX.
  3032         16  PB-I-AH-EXPIRE-DT            PIC XX.
  3033         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  3034         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  3035         16  PB-I-LIFE-INDICATOR          PIC X.
  3036             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  3037         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  3038         16  PB-I-MAIL-ADDRS-SW           PIC X.
  3039             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  3040             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  3041         16  PB-I-1ST-PMT-DT              PIC XX.
  3042         16  PB-I-JOINT-INSURED.
  3043             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  3044             20 PB-I-JOINT-FIRST-NAME.
  3045                24  PB-I-JOINT-FIRST-INIT PIC X.
  3046                24  FILLER                PIC X(9).
  3047             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  3048*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  3049         16  PB-I-BENEFICIARY-NAME.
  3050             20  PB-I-BANK-NUMBER         PIC X(10).
  3051             20  FILLER                   PIC X(15).
  3052         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  3053         16  PB-I-REFERENCE               PIC X(12).
  3054         16  FILLER REDEFINES PB-I-REFERENCE.
  3055             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  3056             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  3057             20  PB-I-CLP-STATE           PIC XX.
  3058         16  PB-I-UNDERWRITING-STATUS     PIC X.
  3059             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  3060             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  3061             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  3062         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  3063         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL9301.cbl
  3064         16  PB-I-RESIDENT-STATE          PIC XX.
  3065         16  PB-I-RATE-CODE               PIC X(4).
  3066         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  3067         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3068         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3069         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  3070         16  PB-I-BANK-NOCHRGB            PIC 99.
  3071         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  3072         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  3073
  3074     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  3075         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  3076             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  3077         16  PB-C-CANCEL-ORIGIN           PIC X.
  3078             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  3079         16  PB-C-LF-CANCEL-DT            PIC XX.
  3080         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3081         16  PB-C-LF-CALC-REQ             PIC X.
  3082             88 PB-COMP-LF-CANCEL            VALUE '?'.
  3083         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  3084         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  3085         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  3086             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  3087         16  PB-C-AH-CANCEL-DT            PIC XX.
  3088         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  3089         16  PB-C-AH-CALC-REQ             PIC X.
  3090             88 PB-COMP-AH-CANCEL            VALUE '?'.
  3091         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  3092         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  3093         16  PB-C-LAST-NAME               PIC X(15).
  3094         16  PB-C-REFUND-SW               PIC X.
  3095             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  3096             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  3097         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  3098         16  PB-C-PAYEE-CODE              PIC X(6).
  3099         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  3100         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  3101         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  3102         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  3103         16  PB-C-REFERENCE               PIC X(12).
  3104         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  3105         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  3106         16  PB-C-POST-CARD-IND           PIC X.
  3107         16  PB-C-CANCEL-REASON           PIC X.
  3108         16  PB-C-REF-INTERFACE-SW        PIC X.
  3109         16  FILLER                       PIC X(09).
  3110*        16  FILLER                       PIC X(18).
  3111         16  PB-C-POLICY-FORM-NO          PIC X(12).
  3112*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  3113         16  PB-C-NH-INT-ON-REFS          PIC S9(7)V99   COMP-3.
  3114         16  PB-CANCELED-CERT-DATA.
  3115             20  PB-CI-INSURED-NAME.
  3116                 24  PB-CI-LAST-NAME      PIC X(15).
  3117                 24  PB-CI-INITIALS       PIC XX.
  3118             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  3119             20  PB-CI-INSURED-SEX        PIC X.
  3120             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  3121             20  PB-CI-LF-BENEFIT-CD      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL9301.cbl
  3122             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  3123             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  3124             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3125             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  3126             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  3127             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  3128             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  3129             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  3130             20  PB-CI-RATE-CLASS         PIC XX.
  3131             20  PB-CI-RATE-DEV-LF        PIC XXX.
  3132             20  PB-CI-RATE-DEV-AH        PIC XXX.
  3133             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  3134             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  3135             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  3136             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  3137             20  PB-CI-LF-ABBR            PIC X(3).
  3138             20  PB-CI-AH-ABBR            PIC X(3).
  3139             20  PB-CI-OB-FLAG            PIC X.
  3140                 88  PB-CI-OB                VALUE 'B'.
  3141             20  PB-CI-LF-POLICY-STATUS   PIC X.
  3142                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  3143                                           'M' '4' '5' '9' '2'.
  3144                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  3145                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  3146                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  3147                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  3148                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  3149                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  3150                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  3151                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  3152                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  3153                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  3154                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  3155                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  3156             20  PB-CI-AH-POLICY-STATUS   PIC X.
  3157                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  3158                                           'M' '4' '5' '9' '2'.
  3159                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  3160                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  3161                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  3162                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  3163                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  3164                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  3165                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  3166                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  3167                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  3168                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  3169                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  3170                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  3171             20  PB-CI-PAY-FREQUENCY      PIC 99.
  3172             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  3173             20  PB-CI-SOC-SEC-NO         PIC X(11).
  3174             20  PB-CI-MEMBER-NO          PIC X(12).
  3175             20  PB-CI-INT-CODE           PIC X.
  3176                 88  PB-CI-ADD-ON                  VALUE 'A'.
  3177                 88  PB-CI-SIMPLE                  VALUE 'S'.
  3178             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  3179             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL9301.cbl
  3180             20  PB-CI-COMP-EXCP-SW       PIC X.
  3181                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  3182                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  3183             20  PB-CI-ENTRY-STATUS       PIC X.
  3184             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  3185             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  3186             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  3187             20  PB-CI-DEATH-DT           PIC XX.
  3188             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  3189             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  3190             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3191             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  3192             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  3193             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  3194             20  PB-CI-ENTRY-DT              PIC XX.
  3195             20  PB-CI-ENTRY-BATCH           PIC X(6).
  3196             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  3197             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  3198             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  3199             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  3200             20  PB-CI-OLD-LOF               PIC XXX.
  3201*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  3202             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  3203             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  3204             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  3205             20  PB-CI-INDV-GRP-CD           PIC X.
  3206             20  PB-CI-BENEFICIARY-NAME.
  3207                 24  PB-CI-BANK-NUMBER       PIC X(10).
  3208                 24  FILLER                  PIC X(15).
  3209             20  PB-CI-NOTE-SW               PIC X.
  3210             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  3211             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  3212             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  3213             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  3214             20  PB-CI-LOAN-OFFICER          PIC X(5).
  3215             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  3216             20  PB-CI-FIRST-NAME            PIC X(10).
  3217
  3218         16  FILLER                       PIC X(17).
  3219*032306  16  FILLER                       PIC X(27).
  3220*        16  FILLER                       PIC X(46).
  3221
  3222     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  3223         16  FILLER                       PIC X(10).
  3224         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  3225         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  3226         16  PB-M-INSURED-MID-INIT        PIC X.
  3227         16  PB-M-INSURED-AGE             PIC 99.
  3228         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  3229         16  PB-M-INSURED-SEX             PIC X.
  3230         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  3231         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  3232         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  3233         16  PB-M-INSURED-CITY-STATE.
  3234             20  PB-M-INSURED-CITY        PIC X(28).
  3235             20  PB-M-INSURED-STATE       PIC XX.
  3236         16  PB-M-INSURED-ZIP-CODE.
  3237             20  PB-M-INSURED-ZIP-PRIME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL9301.cbl
  3238                 24  PB-M-INSURED-ZIP-1   PIC X.
  3239                     88  PB-M-CANADIAN-POST-CODE
  3240                                             VALUE 'A' THRU 'Z'.
  3241                 24  FILLER               PIC X(4).
  3242             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  3243         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  3244                                        PB-M-INSURED-ZIP-CODE.
  3245             20  PM-M-INS-CAN-POST1       PIC XXX.
  3246             20  PM-M-INS-CAN-POST2       PIC XXX.
  3247             20  FILLER                   PIC XXX.
  3248         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  3249         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  3250         16  PB-M-CRED-BENE-NAME          PIC X(30).
  3251         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  3252         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  3253         16  PB-M-CRED-BENE-CITYST.
  3254             20  PB-M-CRED-BENE-CITY      PIC X(28).
  3255             20  PB-M-CRED-BENE-STATE     PIC XX.
  3256         16  FILLER                       PIC X(92).
  3257
  3258     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  3259         16  FILLER                       PIC X(10).
  3260         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3261         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3262         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3263         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3264         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3265         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3266         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3267         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3268         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3269         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  3270         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  3271         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  3272         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  3273         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  3274         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  3275         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  3276         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  3277         16  PB-ACCOUNT-NAME              PIC X(30).
  3278         16  PB-PREM-REF-RPT-FLAG         PIC X.
  3279         16  PB-REFERENCE                 PIC X(12).
  3280         16  PB-B-RECEIVED-DT             PIC XX.
  3281         16  FILLER                       PIC X(234).
  3282
  3283     12  PB-RECORD-STATUS.
  3284         16  PB-CREDIT-SELECT-DT          PIC XX.
  3285         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  3286         16  PB-BILLED-DT                 PIC XX.
  3287         16  PB-BILLING-STATUS            PIC X.
  3288             88  PB-ENTRY-REVERSED            VALUE 'R'.
  3289             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  3290             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  3291         16  PB-RECORD-BILL               PIC X.
  3292             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  3293             88  PB-RECORD-RETURNED           VALUE 'R'.
  3294             88  PB-RECORD-ENDORSED           VALUE 'E'.
  3295             88  PB-OVERRIDE-LIFE             VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL9301.cbl
  3296             88  PB-OVERRIDE-AH               VALUE 'A'.
  3297             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  3298         16  PB-BATCH-ENTRY               PIC X.
  3299             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  3300             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  3301             88  PB-REISSUED-CERT             VALUE 'E'.
  3302             88  PB-MONTHLY-CERT              VALUE 'M'.
  3303             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  3304             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  3305             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  3306         16  PB-FORCE-CODE                PIC X.
  3307             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  3308             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  3309             88  PB-CANCEL-FORCE              VALUE '8'.
  3310             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  3311             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  3312             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  3313             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  3314             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  3315             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  3316             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  3317         16  PB-FATAL-FLAG                PIC X.
  3318             88  PB-FATAL-ERRORS              VALUE 'X'.
  3319         16  PB-FORCE-ER-CD               PIC X.
  3320             88  PB-FORCE-ERRORS              VALUE 'F'.
  3321             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  3322         16  PB-WARN-ER-CD                PIC X.
  3323             88  PB-WARNING-ERRORS            VALUE 'W'.
  3324         16  FILLER                       PIC X.
  3325         16  PB-OUT-BAL-CD                PIC X.
  3326             88  PB-OUT-OF-BAL                VALUE 'O'.
  3327         16  PB-LIFE-OVERRIDE-L1          PIC X.
  3328         16  PB-AH-OVERRIDE-L1            PIC X.
  3329         16  PB-INPUT-DT                  PIC XX.
  3330         16  PB-INPUT-BY                  PIC X(4).
  3331         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  3332         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  3333         16  PB-TOLERANCE-REJECT-SW       PIC X.
  3334         16  PB-LF-EARNING-METHOD         PIC X.
  3335         16  PB-AH-EARNING-METHOD         PIC X.
  3336         16  PB-LF-TERM-CALC-METHOD       PIC X.
  3337         16  PB-AH-TERM-CALC-METHOD       PIC X.
  3338         16  PB-REIN-CD                   PIC XXX.
  3339         16  PB-LF-REFUND-TYPE            PIC X.
  3340         16  PB-AH-REFUND-TYPE            PIC X.
  3341         16  PB-ACCT-EFF-DT               PIC XX.
  3342         16  PB-ACCT-EXP-DT               PIC XX.
  3343         16  PB-COMPANY-ID                PIC X(3).
  3344         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3345         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  3346         16  PB-SV-CARRIER                PIC X.
  3347         16  PB-SV-GROUPING               PIC X(6).
  3348         16  PB-SV-STATE                  PIC XX.
  3349         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  3350         16  PB-GA-BILLING-INFO.
  3351             20  PB-GA-BILL-DT OCCURS 5 TIMES
  3352                                          PIC XX.
  3353         16  PB-SV-REMIT-TO  REDEFINES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL9301.cbl
  3354             PB-GA-BILLING-INFO           PIC X(10).
  3355         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  3356         16  PB-I-LOAN-OFFICER            PIC X(5).
  3357         16  PB-I-VIN                     PIC X(17).
  3358
  3359         16  FILLER                       PIC X(04).
  3360         16  IMNET-BYPASS-SW              PIC X.
  3361
  3362******************************************************************
  3363*                COMMON EDIT ERRORS                              *
  3364******************************************************************
  3365
  3366     12  PB-COMMON-ERRORS.
  3367         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  3368                                           PIC S9(4)     COMP.
  3369
  3370******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL9301.cbl
  3372
  3373*                                COPY ELCCNTL.
  3374******************************************************************
  3375*                                                                *
  3376*                                                                *
  3377*                            ELCCNTL.                            *
  3378*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3379*                            VMOD=2.059                          *
  3380*                                                                *
  3381*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  3382*                                                                *
  3383*   FILE TYPE = VSAM,KSDS                                        *
  3384*   RECORD SIZE = 750  RECFORM = FIXED                           *
  3385*                                                                *
  3386*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  3387*       ALTERNATE INDEX = NONE                                   *
  3388*                                                                *
  3389*   LOG = YES                                                    *
  3390*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3391******************************************************************
  3392*                   C H A N G E   L O G
  3393*
  3394* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3395*-----------------------------------------------------------------
  3396*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3397* EFFECTIVE    NUMBER
  3398*-----------------------------------------------------------------
  3399* 082503                   PEMA  ADD BENEFIT GROUP
  3400* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3401* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  3402* 092705    2005050300006  PEMA  ADD SPP LEASES
  3403* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  3404* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  3405* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  3406* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  3407******************************************************************
  3408*
  3409 01  CONTROL-FILE.
  3410     12  CF-RECORD-ID                       PIC XX.
  3411         88  VALID-CF-ID                        VALUE 'CF'.
  3412
  3413     12  CF-CONTROL-PRIMARY.
  3414         16  CF-COMPANY-ID                  PIC XXX.
  3415         16  CF-RECORD-TYPE                 PIC X.
  3416             88  CF-COMPANY-MASTER              VALUE '1'.
  3417             88  CF-PROCESSOR-MASTER            VALUE '2'.
  3418             88  CF-STATE-MASTER                VALUE '3'.
  3419             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  3420             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  3421             88  CF-CARRIER-MASTER              VALUE '6'.
  3422             88  CF-MORTALITY-MASTER            VALUE '7'.
  3423             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  3424             88  CF-TERMINAL-MASTER             VALUE '9'.
  3425             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  3426             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  3427             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  3428             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  3429             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL9301.cbl
  3430             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  3431             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  3432             88  CF-REMINDERS-MASTER            VALUE 'R'.
  3433             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  3434         16  CF-ACCESS-CD-GENL              PIC X(4).
  3435         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  3436             20  CF-PROCESSOR               PIC X(4).
  3437         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  3438             20  CF-STATE-CODE              PIC XX.
  3439             20  FILLER                     PIC XX.
  3440         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  3441             20  FILLER                     PIC XX.
  3442             20  CF-HI-BEN-IN-REC           PIC XX.
  3443         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  3444             20  FILLER                     PIC XXX.
  3445             20  CF-CARRIER-CNTL            PIC X.
  3446         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  3447             20  FILLER                     PIC XX.
  3448             20  CF-HI-TYPE-IN-REC          PIC 99.
  3449         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  3450             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  3451                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  3452             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  3453             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  3454         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  3455             20  FILLER                     PIC X.
  3456             20  CF-CUSTOM-REPORT-NO        PIC 999.
  3457         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  3458             20  FILLER                     PIC XX.
  3459             20  CF-MORTGAGE-PLAN           PIC XX.
  3460         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  3461
  3462     12  CF-LAST-MAINT-DT                   PIC XX.
  3463     12  CF-LAST-MAINT-BY                   PIC X(4).
  3464     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  3465
  3466     12  CF-RECORD-BODY                     PIC X(728).
  3467
  3468
  3469****************************************************************
  3470*             COMPANY MASTER RECORD                            *
  3471****************************************************************
  3472
  3473     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3474         16  CF-COMPANY-ADDRESS.
  3475             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  3476             20  CF-CL-IN-CARE-OF           PIC X(30).
  3477             20  CF-CL-ADDR-LINE-1          PIC X(30).
  3478             20  CF-CL-ADDR-LINE-2          PIC X(30).
  3479             20  CF-CL-CITY-STATE           PIC X(30).
  3480             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  3481             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  3482         16  CF-COMPANY-CD                  PIC X.
  3483         16  CF-COMPANY-PASSWORD            PIC X(8).
  3484         16  CF-SECURITY-OPTION             PIC X.
  3485             88  ALL-SECURITY                   VALUE '1'.
  3486             88  COMPANY-VERIFY                 VALUE '2'.
  3487             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL9301.cbl
  3488             88  NO-SECURITY                    VALUE '4'.
  3489             88  ALL-BUT-TERM                   VALUE '5'.
  3490         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  3491             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  3492         16  CF-LGX-INTERFACE-CNTL          PIC X.
  3493             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  3494         16  CF-INFORCE-LOCATION            PIC X.
  3495             88  CERTS-ARE-ONLINE               VALUE '1'.
  3496             88  CERTS-ARE-OFFLINE              VALUE '2'.
  3497             88  NO-CERTS-AVAILABLE             VALUE '3'.
  3498         16  CF-LOWER-CASE-LETTERS          PIC X.
  3499         16  CF-CERT-ACCESS-CONTROL         PIC X.
  3500             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  3501             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  3502             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  3503             88  CF-ACCNT-CNTL                  VALUE '3'.
  3504             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  3505
  3506         16  CF-FORMS-PRINTER-ID            PIC X(4).
  3507         16  CF-CHECK-PRINTER-ID            PIC X(4).
  3508
  3509         16  CF-LGX-CREDIT-USER             PIC X.
  3510             88  CO-IS-NOT-USER                 VALUE 'N'.
  3511             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  3512
  3513         16 CF-CREDIT-CALC-CODES.
  3514             20  CF-CR-REM-TERM-CALC PIC X.
  3515               88  CR-EARN-AFTER-15TH           VALUE '1'.
  3516               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  3517               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  3518               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  3519               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  3520               88  CR-EARN-AFTER-14TH           VALUE '6'.
  3521               88  CR-EARN-AFTER-16TH           VALUE '7'.
  3522             20  CF-CR-R78-METHOD           PIC X.
  3523               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  3524               88  DONT-USE-PLUS-ONE            VALUE '1'.
  3525
  3526         16  CF-CLAIM-CONTROL-COUNTS.
  3527             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  3528                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  3529
  3530             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  3531                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  3532
  3533             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  3534                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  3535
  3536             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  3537                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  3538
  3539         16  CF-CURRENT-MONTH-END           PIC XX.
  3540
  3541         16  CF-CO-CALC-QUOTE-TOLERANCE.
  3542             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  3543             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  3544             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  3545             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL9301.cbl
  3546                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3547                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3548             20  CF-CO-PREM-REJECT-SW       PIC X.
  3549                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  3550                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  3551             20  CF-CO-REF-REJECT-SW        PIC X.
  3552                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  3553                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  3554
  3555         16  CF-CO-REPORTING-DT             PIC XX.
  3556         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  3557         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  3558           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  3559           88  CF-CO-MONTH-END                  VALUE '1'.
  3560
  3561         16  CF-LGX-CLAIM-USER              PIC X.
  3562             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  3563             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  3564
  3565         16  CF-CREDIT-EDIT-CONTROLS.
  3566             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  3567             20  CF-MIN-AGE                 PIC 99.
  3568             20  CF-DEFAULT-AGE             PIC 99.
  3569             20  CF-MIN-TERM                PIC S999      COMP-3.
  3570             20  CF-MAX-TERM                PIC S999      COMP-3.
  3571             20  CF-DEFAULT-SEX             PIC X.
  3572             20  CF-JOINT-AGE-INPUT         PIC X.
  3573                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  3574             20  CF-BIRTH-DATE-INPUT        PIC X.
  3575                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  3576             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  3577                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  3578                 88  CF-ZERO-CARRIER            VALUE '1'.
  3579                 88  CF-ZERO-GROUPING           VALUE '2'.
  3580                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  3581             20  CF-EDIT-SW                 PIC X.
  3582                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  3583             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  3584             20  CF-CR-PR-METHOD            PIC X.
  3585               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  3586               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  3587             20  FILLER                     PIC X.
  3588
  3589         16  CF-CREDIT-MISC-CONTROLS.
  3590             20  CF-REIN-TABLE-SW           PIC X.
  3591                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  3592             20  CF-COMP-TABLE-SW           PIC X.
  3593                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  3594             20  CF-EXPERIENCE-RETENTION-AGE
  3595                                            PIC S9        COMP-3.
  3596             20  CF-CONVERSION-DT           PIC XX.
  3597             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  3598             20  CF-RUN-FREQUENCY-SW        PIC X.
  3599                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  3600                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  3601
  3602             20  CF-CR-CHECK-NO-CONTROL.
  3603                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL9301.cbl
  3604                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  3605                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  3606                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  3607                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  3608                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  3609
  3610                 24  CF-CR-CHECK-COUNT       REDEFINES
  3611                     CF-CR-CHECK-COUNTER      PIC X(4).
  3612
  3613                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  3614                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  3615
  3616                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  3617                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  3618                 24  CF-MAIL-PROCESSING       PIC X.
  3619                     88  MAIL-PROCESSING          VALUE 'Y'.
  3620
  3621         16  CF-MISC-SYSTEM-CONTROL.
  3622             20  CF-SYSTEM-C                 PIC X.
  3623                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  3624             20  CF-SYSTEM-D                 PIC X.
  3625                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  3626             20  CF-SOC-SEC-NO-SW            PIC X.
  3627                 88  SOC-SEC-NO-USED             VALUE '1'.
  3628             20  CF-MEMBER-NO-SW             PIC X.
  3629                 88  MEMBER-NO-USED              VALUE '1'.
  3630             20  CF-TAX-ID-NUMBER            PIC X(11).
  3631             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  3632             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  3633                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  3634                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  3635                 88  CF-ALL-APPROVED             VALUE 'Y'.
  3636                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  3637             20  CF-SYSTEM-E                 PIC X.
  3638                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  3639
  3640         16  CF-LGX-LIFE-USER               PIC X.
  3641             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  3642             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  3643
  3644         16  CF-CR-MONTH-END-DT             PIC XX.
  3645
  3646         16  CF-FILE-MAINT-DATES.
  3647             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  3648                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  3649             20  CF-LAST-BATCH       REDEFINES
  3650                 CF-LAST-BATCH-NO               PIC X(4).
  3651             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  3652             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  3653             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  3654             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  3655             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  3656             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  3657             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  3658             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  3659             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  3660             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  3661
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL9301.cbl
  3662         16  CF-NEXT-COMPANY-ID             PIC XXX.
  3663         16  FILLER                         PIC X.
  3664
  3665         16  CF-ALT-MORT-CODE               PIC X(4).
  3666         16  CF-MEMBER-CAPTION              PIC X(10).
  3667
  3668         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  3669             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  3670             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  3671             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  3672             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  3673             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  3674
  3675         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  3676
  3677         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3678         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3679         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3680         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3681
  3682         16  CF-AH-OVERRIDE-L1              PIC X.
  3683         16  CF-AH-OVERRIDE-L2              PIC XX.
  3684         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3685         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3686
  3687         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3688         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3689
  3690         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3691         16  CF-AR-LAST-EL860-DT            PIC XX.
  3692         16  CF-MP-MONTH-END-DT             PIC XX.
  3693
  3694         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3695         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3696             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3697
  3698         16  CF-AR-MONTH-END-DT             PIC XX.
  3699
  3700         16  CF-CRDTCRD-USER                PIC X.
  3701             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3702             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3703
  3704         16  CF-CC-MONTH-END-DT             PIC XX.
  3705
  3706         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3707
  3708         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3709             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3710             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3711             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3712         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3713         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  3714         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3715         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3716             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3717             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3718         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3719         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL9301.cbl
  3720         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3721             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3722         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3723
  3724         16  CF-CL-ZIP-CODE.
  3725             20  CF-CL-ZIP-PRIME.
  3726                 24  CF-CL-ZIP-1ST          PIC X.
  3727                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3728                 24  FILLER                 PIC X(4).
  3729             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3730         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3731             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3732             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3733             20  FILLER                     PIC XXX.
  3734
  3735         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3736         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3737         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3738         16  CF-CO-OPTION-START-DATE        PIC XX.
  3739         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3740           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3741                                                      '3' '4'.
  3742           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3743           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3744           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3745           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3746           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3747           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3748
  3749         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3750
  3751         16  CF-PAYMENT-APPROVAL-LEVELS.
  3752             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3753             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3754             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3755             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3756             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3757             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3758
  3759         16  CF-END-USER-REPORTING-USER     PIC X.
  3760             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3761             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3762
  3763         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3764             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3765             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3766
  3767         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3768
  3769         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3770         16  FILLER                         PIC X.
  3771
  3772         16  CF-CREDIT-ARCHIVE-CNTL.
  3773             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3774             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3775             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3776
  3777         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL9301.cbl
  3778
  3779         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3780             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3781             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3782
  3783         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3784             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3785             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3786
  3787         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3788
  3789         16  CF-CO-ACH-ID-CODE              PIC  X.
  3790             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3791             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3792             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3793         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3794         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3795         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3796         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3797         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3798         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3799         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3800         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3801         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3802                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3803         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3804                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3805
  3806         16  CF-CO-OVER-SHORT.
  3807             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3808             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3809
  3810*         16  FILLER                         PIC X(102).
  3811         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3812             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3813             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3814
  3815         16  CF-AH-APPROVAL-DAYS.
  3816             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3817             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3818             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3819             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3820
  3821         16  FILLER                         PIC X(82).
  3822****************************************************************
  3823*             PROCESSOR/USER RECORD                            *
  3824****************************************************************
  3825
  3826     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3827         16  CF-PROCESSOR-NAME              PIC X(30).
  3828         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3829         16  CF-PROCESSOR-TITLE             PIC X(26).
  3830         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3831                 88  MESSAGE-YES                VALUE 'Y'.
  3832                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3833
  3834*****************************************************
  3835****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL9301.cbl
  3836****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3837****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3838****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3839*****************************************************
  3840
  3841         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3842             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3843             20  CF-APPLICATION-FORCE       PIC X.
  3844             20  CF-INDIVIDUAL-APP.
  3845                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3846                     28  CF-BROWSE-APP      PIC X.
  3847                     28  CF-UPDATE-APP      PIC X.
  3848
  3849         16  CF-CURRENT-TERM-ON             PIC X(4).
  3850         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3851             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3852             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3853             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3854             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3855             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3856             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3857             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3858         16  CF-PROCESSOR-CARRIER           PIC X.
  3859             88  NO-CARRIER-SECURITY            VALUE ' '.
  3860         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3861             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3862         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3863             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3864         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3865             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3866
  3867         16  CF-PROC-SYS-ACCESS-SW.
  3868             20  CF-PROC-CREDIT-CLAIMS-SW.
  3869                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3870                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3871                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3872                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3873             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3874                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3875                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3876             20  CF-PROC-LIFE-GNRLDGR-SW.
  3877                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3878                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3879                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3880                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3881             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3882                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3883                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3884         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3885             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3886             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3887         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3888
  3889         16  CF-APPROVAL-LEVEL                  PIC X.
  3890             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3891             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3892             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3893             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL9301.cbl
  3894
  3895         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3896
  3897         16  CF-LANGUAGE-TYPE                   PIC X.
  3898             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3899             88  CF-LANG-IS-FR                      VALUE 'F'.
  3900         16  FILLER                             PIC  X(240).
  3901
  3902****************************************************************
  3903*             PROCESSOR/REMINDERS RECORD                       *
  3904****************************************************************
  3905
  3906     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3907         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3908             20  CF-START-REMIND-DT         PIC XX.
  3909             20  CF-END-REMIND-DT           PIC XX.
  3910             20  CF-REMINDER-TEXT           PIC X(50).
  3911         16  FILLER                         PIC X(296).
  3912
  3913
  3914****************************************************************
  3915*             STATE MASTER RECORD                              *
  3916****************************************************************
  3917
  3918     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3919         16  CF-STATE-ABBREVIATION          PIC XX.
  3920         16  CF-STATE-NAME                  PIC X(25).
  3921         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3922         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3923             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3924             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3925             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3926             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3927                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3928                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3929             20  CF-ST-PREM-REJECT-SW       PIC X.
  3930                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3931                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3932             20  CF-ST-REF-REJECT-SW        PIC X.
  3933                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3934                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3935         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3936         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3937         16  CF-ST-REFUND-RULES.
  3938             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3939             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3940             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3941         16  CF-ST-FST-PMT-EXTENSION.
  3942             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3943             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3944                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3945                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3946                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3947                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3948         16  CF-ST-STATE-CALL.
  3949             20  CF-ST-CALL-UNEARNED        PIC X.
  3950             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3951             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL9301.cbl
  3952         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3953             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3954             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3955         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3956         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3957         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3958         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3959         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3960         16  FILLER                         PIC X.
  3961         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3962             20  CF-ST-BENEFIT-CD           PIC XX.
  3963             20  CF-ST-BENEFIT-KIND         PIC X.
  3964                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3965                 88  CF-ST-AH-KIND              VALUE 'A'.
  3966             20  CF-ST-REM-TERM-CALC        PIC X.
  3967                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3968                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3969                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3970                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3971                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3972                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3973                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3974                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3975
  3976             20  CF-ST-REFUND-CALC          PIC X.
  3977                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3978                 88  ST-REFD-BY-R78             VALUE '1'.
  3979                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3980                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3981                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3982                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3983                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3984                 88  ST-REFD-UTAH               VALUE '7'.
  3985                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3986                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3987                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3988
  3989             20  CF-ST-EARNING-CALC         PIC X.
  3990                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3991                 88  ST-EARN-BY-R78             VALUE '1'.
  3992                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3993                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3994                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3995                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3996                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3997                 88  ST-EARN-MEAN               VALUE '8'.
  3998                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3999
  4000             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  4001                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  4002                 88  ST-OVRD-BY-R78             VALUE '1'.
  4003                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  4004                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  4005                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  4006                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  4007                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  4008                 88  ST-OVRD-MEAN               VALUE '8'.
  4009                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL9301.cbl
  4010             20  FILLER                     PIC X.
  4011
  4012         16  CF-ST-COMMISSION-CAPS.
  4013             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  4014             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  4015             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  4016             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  4017         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  4018                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  4019
  4020         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  4021
  4022         16  CF-ST-STATUTORY-INTEREST.
  4023             20  CF-ST-STAT-DATE-FROM       PIC X.
  4024                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  4025                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  4026             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  4027             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  4028             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  4029             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  4030             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  4031
  4032         16  CF-ST-OVER-SHORT.
  4033             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  4034             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  4035
  4036         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  4037
  4038         16  CF-ST-RT-CALC                  PIC X.
  4039
  4040         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  4041         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  4042         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  4043         16  CF-ST-RF-LR-CALC               PIC X.
  4044         16  CF-ST-RF-LL-CALC               PIC X.
  4045         16  CF-ST-RF-LN-CALC               PIC X.
  4046         16  CF-ST-RF-AH-CALC               PIC X.
  4047         16  CF-ST-RF-CP-CALC               PIC X.
  4048*        16  FILLER                         PIC X(206).
  4049*CIDMOD         16  FILLER                         PIC X(192).
  4050         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  4051             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  4052         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  4053         16  FILLER                         PIC X(187).
  4054
  4055****************************************************************
  4056*             BENEFIT MASTER RECORD                            *
  4057****************************************************************
  4058
  4059     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4060         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  4061             20  CF-BENEFIT-CODE            PIC XX.
  4062             20  CF-BENEFIT-NUMERIC  REDEFINES
  4063                 CF-BENEFIT-CODE            PIC XX.
  4064             20  CF-BENEFIT-ALPHA           PIC XXX.
  4065             20  CF-BENEFIT-DESCRIP         PIC X(10).
  4066             20  CF-BENEFIT-COMMENT         PIC X(10).
  4067
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL9301.cbl
  4068             20  CF-LF-COVERAGE-TYPE        PIC X.
  4069                 88  CF-REDUCING                VALUE 'R'.
  4070                 88  CF-LEVEL                   VALUE 'L' 'P'.
  4071
  4072             20  CF-SPECIAL-CALC-CD         PIC X.
  4073                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  4074                 88  CF-NP-0-MO-INT             VALUE 'A'.
  4075                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  4076                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  4077                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  4078                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  4079                 88  CF-FARM-PLAN               VALUE 'F'.
  4080                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  4081                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  4082                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  4083                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  4084                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  4085                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  4086                 88  CF-PRUDENTIAL              VALUE 'P'.
  4087                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  4088                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  4089                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  4090                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  4091                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  4092                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  4093
  4094             20  CF-JOINT-INDICATOR         PIC X.
  4095                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  4096
  4097*            20  FILLER                     PIC X(12).
  4098             20  FILLER                     PIC X(11).
  4099             20  CF-BENEFIT-CATEGORY        PIC X.
  4100             20  CF-LOAN-TYPE               PIC X(8).
  4101
  4102             20  CF-CO-REM-TERM-CALC        PIC X.
  4103                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  4104                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  4105                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  4106                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  4107                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  4108
  4109             20  CF-CO-EARNINGS-CALC        PIC X.
  4110                 88  CO-EARN-BY-R78             VALUE '1'.
  4111                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  4112                 88  CO-EARN-AS-CALIF           VALUE '3'.
  4113                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  4114                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  4115                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  4116                 88  CO-EARN-AS-MEAN            VALUE '8'.
  4117                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  4118
  4119             20  CF-CO-REFUND-CALC          PIC X.
  4120                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  4121                 88  CO-REFD-BY-R78             VALUE '1'.
  4122                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  4123                 88  CO-REFD-AS-CALIF           VALUE '3'.
  4124                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  4125                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL9301.cbl
  4126                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  4127                 88  CO-REFD-MEAN               VALUE '8'.
  4128                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  4129                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  4130                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  4131
  4132             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  4133                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  4134                 88  CO-OVRD-BY-R78             VALUE '1'.
  4135                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  4136                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  4137                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  4138                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  4139                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  4140                 88  CO-OVRD-MEAN               VALUE '8'.
  4141                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  4142
  4143             20  CF-CO-BEN-I-G-CD           PIC X.
  4144                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  4145                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  4146                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  4147
  4148         16  FILLER                         PIC X(304).
  4149
  4150
  4151****************************************************************
  4152*             CARRIER MASTER RECORD                            *
  4153****************************************************************
  4154
  4155     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4156         16  CF-ADDRESS-DATA.
  4157             20  CF-MAIL-TO-NAME            PIC X(30).
  4158             20  CF-IN-CARE-OF              PIC X(30).
  4159             20  CF-ADDRESS-LINE-1          PIC X(30).
  4160             20  CF-ADDRESS-LINE-2          PIC X(30).
  4161             20  CF-CITY-STATE              PIC X(30).
  4162             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  4163             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  4164
  4165         16  CF-CLAIM-NO-CONTROL.
  4166             20  CF-CLAIM-NO-METHOD         PIC X.
  4167                 88  CLAIM-NO-MANUAL            VALUE '1'.
  4168                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  4169                 88  CLAIM-NO-SEQ               VALUE '3'.
  4170                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  4171             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  4172                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  4173                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  4174                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  4175
  4176         16  CF-CHECK-NO-CONTROL.
  4177             20  CF-CHECK-NO-METHOD         PIC X.
  4178                 88  CHECK-NO-MANUAL            VALUE '1'.
  4179                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  4180                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  4181                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  4182             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  4183                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL9301.cbl
  4184
  4185         16  CF-DOMICILE-STATE              PIC XX.
  4186
  4187         16  CF-EXPENSE-CONTROLS.
  4188             20  CF-EXPENSE-METHOD          PIC X.
  4189                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  4190                 88  DOLLARS-PER-PMT            VALUE '2'.
  4191                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  4192                 88  DOLLARS-PER-MONTH          VALUE '4'.
  4193             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  4194             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  4195
  4196         16  CF-CORRESPONDENCE-CONTROL.
  4197             20  CF-LETTER-RESEND-OPT       PIC X.
  4198                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  4199                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  4200             20  FILLER                     PIC X(4).
  4201
  4202         16  CF-RESERVE-CONTROLS.
  4203             20  CF-MANUAL-SW               PIC X.
  4204                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  4205             20  CF-FUTURE-SW               PIC X.
  4206                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  4207             20  CF-PTC-SW                  PIC X.
  4208                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  4209             20  CF-IBNR-SW                 PIC X.
  4210                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  4211             20  CF-PTC-LF-SW               PIC X.
  4212                 88  CF-LF-PTC-USED             VALUE '1'.
  4213             20  CF-CDT-ACCESS-METHOD       PIC X.
  4214                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  4215                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  4216                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  4217             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  4218
  4219         16  CF-CLAIM-CALC-METHOD           PIC X.
  4220             88  360-PLUS-MONTHS                VALUE '1'.
  4221             88  365-PLUS-MONTHS                VALUE '2'.
  4222             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  4223             88  360-DAILY                      VALUE '4'.
  4224             88  365-DAILY                      VALUE '5'.
  4225
  4226         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  4227         16  FILLER                         PIC X(11).
  4228
  4229         16  CF-LIMIT-AMOUNTS.
  4230             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  4231             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  4232             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  4233             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  4234             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  4235             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  4236             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  4237             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  4238             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  4239             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  4240
  4241         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL9301.cbl
  4242         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  4243         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  4244
  4245         16  CF-ZIP-CODE.
  4246             20  CF-ZIP-PRIME.
  4247                 24  CF-ZIP-1ST             PIC X.
  4248                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  4249                 24  FILLER                 PIC X(4).
  4250             20  CF-ZIP-PLUS4               PIC X(4).
  4251         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  4252             20  CF-CAN-POSTAL-1            PIC XXX.
  4253             20  CF-CAN-POSTAL-2            PIC XXX.
  4254             20  FILLER                     PIC XXX.
  4255
  4256         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  4257         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  4258         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  4259
  4260         16  CF-RATING-SWITCH               PIC X.
  4261             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  4262             88  CF-NO-RATING                   VALUE 'N'.
  4263
  4264         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  4265
  4266         16  CF-CARRIER-OVER-SHORT.
  4267             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  4268             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  4269
  4270         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  4271         16  CF-SECPAY-SWITCH               PIC X.
  4272             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  4273             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  4274         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  4275         16  FILLER                         PIC X(448).
  4276*        16  FILLER                         PIC X(452).
  4277
  4278
  4279****************************************************************
  4280*             MORTALITY MASTER RECORD                          *
  4281****************************************************************
  4282
  4283     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4284         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  4285                                INDEXED BY CF-MORT-NDX.
  4286             20  CF-MORT-TABLE              PIC X(5).
  4287             20  CF-MORT-TABLE-TYPE         PIC X.
  4288                 88  CF-MORT-JOINT              VALUE 'J'.
  4289                 88  CF-MORT-SINGLE             VALUE 'S'.
  4290                 88  CF-MORT-COMBINED           VALUE 'C'.
  4291                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  4292                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  4293             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  4294             20  CF-MORT-AGE-METHOD         PIC XX.
  4295                 88  CF-AGE-LAST                VALUE 'AL'.
  4296                 88  CF-AGE-NEAR                VALUE 'AN'.
  4297             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  4298             20  CF-MORT-ADJUSTMENT-DIRECTION
  4299                                            PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL9301.cbl
  4300                 88  CF-MINUS                   VALUE '-'.
  4301                 88  CF-PLUS                    VALUE '+'.
  4302             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  4303             20  CF-MORT-JOINT-CODE         PIC X.
  4304                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  4305             20  CF-MORT-PC-Q               PIC X.
  4306                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  4307             20  CF-MORT-TABLE-CODE         PIC X(4).
  4308             20  CF-MORT-COMMENTS           PIC X(15).
  4309             20  FILLER                     PIC X(14).
  4310
  4311         16  FILLER                         PIC X(251).
  4312
  4313
  4314****************************************************************
  4315*             BUSSINESS TYPE MASTER RECORD                     *
  4316****************************************************************
  4317
  4318     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4319* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  4320* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  4321* AND RECORD 05 IS TYPES 81-99
  4322         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  4323             20  CF-BUSINESS-TITLE          PIC  X(19).
  4324             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  4325                                            PIC S9V9(4) COMP-3.
  4326             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  4327             20  FILLER                     PIC  X.
  4328         16  FILLER                         PIC  X(248).
  4329
  4330
  4331****************************************************************
  4332*             TERMINAL MASTER RECORD                           *
  4333****************************************************************
  4334
  4335     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4336
  4337         16  CF-COMPANY-TERMINALS.
  4338             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  4339                                  PIC X(4).
  4340         16  FILLER               PIC X(248).
  4341
  4342
  4343****************************************************************
  4344*             LIFE EDIT MASTER RECORD                          *
  4345****************************************************************
  4346
  4347     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4348         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  4349             20  CF-LIFE-CODE-IN            PIC XX.
  4350             20  CF-LIFE-CODE-OUT           PIC XX.
  4351         16  FILLER                         PIC X(248).
  4352
  4353
  4354****************************************************************
  4355*             AH EDIT MASTER RECORD                            *
  4356****************************************************************
  4357
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL9301.cbl
  4358     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4359         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  4360             20  CF-AH-CODE-IN              PIC XXX.
  4361             20  CF-AH-CODE-OUT             PIC XX.
  4362         16  FILLER                         PIC X(248).
  4363
  4364
  4365****************************************************************
  4366*             CREDIBILITY TABLES                               *
  4367****************************************************************
  4368
  4369     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  4370         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  4371                             INDEXED BY CF-CRDB-NDX.
  4372             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  4373             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  4374             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  4375         16  FILLER                         PIC  X(332).
  4376
  4377
  4378****************************************************************
  4379*             REPORT CUSTOMIZATION RECORD                      *
  4380****************************************************************
  4381
  4382     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  4383         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  4384             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  4385             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  4386             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  4387**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  4388****       A T-TRANSFER.                                   ****
  4389             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  4390
  4391         16  FILLER                         PIC XX.
  4392
  4393         16  CF-CARRIER-CNTL-OPT.
  4394             20  CF-CARRIER-OPT-SEQ         PIC 9.
  4395                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  4396                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  4397             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  4398                                            PIC X.
  4399         16  CF-GROUP-CNTL-OPT.
  4400             20  CF-GROUP-OPT-SEQ           PIC 9.
  4401                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  4402                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  4403             20  CF-GROUP-SELECT OCCURS 3 TIMES
  4404                                            PIC X(6).
  4405         16  CF-STATE-CNTL-OPT.
  4406             20  CF-STATE-OPT-SEQ           PIC 9.
  4407                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  4408                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  4409             20  CF-STATE-SELECT OCCURS 3 TIMES
  4410                                            PIC XX.
  4411         16  CF-ACCOUNT-CNTL-OPT.
  4412             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  4413                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  4414                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  4415             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL9301.cbl
  4416                                            PIC X(10).
  4417         16  CF-BUS-TYP-CNTL-OPT.
  4418             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  4419                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  4420                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  4421             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  4422                                            PIC XX.
  4423         16  CF-LF-TYP-CNTL-OPT.
  4424             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  4425                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  4426                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  4427             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  4428                                            PIC XX.
  4429         16  CF-AH-TYP-CNTL-OPT.
  4430             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  4431                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  4432                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  4433             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  4434                                            PIC XX.
  4435         16  CF-REPTCD1-CNTL-OPT.
  4436             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  4437                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  4438                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  4439             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  4440                                            PIC X(10).
  4441         16  CF-REPTCD2-CNTL-OPT.
  4442             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  4443                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  4444                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  4445             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  4446                                            PIC X(10).
  4447         16  CF-USER1-CNTL-OPT.
  4448             20  CF-USER1-OPT-SEQ           PIC 9.
  4449                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  4450                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  4451             20  CF-USER1-SELECT OCCURS 3 TIMES
  4452                                            PIC X(10).
  4453         16  CF-USER2-CNTL-OPT.
  4454             20  CF-USER2-OPT-SEQ           PIC 9.
  4455                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  4456                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  4457             20  CF-USER2-SELECT OCCURS 3 TIMES
  4458                                            PIC X(10).
  4459         16  CF-USER3-CNTL-OPT.
  4460             20  CF-USER3-OPT-SEQ           PIC 9.
  4461                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  4462                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  4463             20  CF-USER3-SELECT OCCURS 3 TIMES
  4464                                            PIC X(10).
  4465         16  CF-USER4-CNTL-OPT.
  4466             20  CF-USER4-OPT-SEQ           PIC 9.
  4467                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  4468                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  4469             20  CF-USER4-SELECT OCCURS 3 TIMES
  4470                                            PIC X(10).
  4471         16  CF-USER5-CNTL-OPT.
  4472             20  CF-USER5-OPT-SEQ           PIC 9.
  4473                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL9301.cbl
  4474                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  4475             20  CF-USER5-SELECT OCCURS 3 TIMES
  4476                                            PIC X(10).
  4477         16  CF-REINS-CNTL-OPT.
  4478             20  CF-REINS-OPT-SEQ           PIC 9.
  4479                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  4480                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  4481             20  CF-REINS-SELECT OCCURS 3 TIMES.
  4482                 24  CF-REINS-PRIME         PIC XXX.
  4483                 24  CF-REINS-SUB           PIC XXX.
  4484
  4485         16  CF-AGENT-CNTL-OPT.
  4486             20  CF-AGENT-OPT-SEQ           PIC 9.
  4487                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  4488                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  4489             20  CF-AGENT-SELECT OCCURS 3 TIMES
  4490                                            PIC X(10).
  4491
  4492         16  FILLER                         PIC X(43).
  4493
  4494         16  CF-LOSS-RATIO-SELECT.
  4495             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  4496             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  4497         16  CF-ENTRY-DATE-SELECT.
  4498             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  4499             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  4500         16  CF-EFFECTIVE-DATE-SELECT.
  4501             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  4502             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  4503
  4504         16  CF-EXCEPTION-LIST-IND          PIC X.
  4505             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  4506
  4507         16  FILLER                         PIC X(318).
  4508
  4509****************************************************************
  4510*                  EXCEPTION REPORTING RECORD                  *
  4511****************************************************************
  4512
  4513     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  4514         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  4515             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  4516
  4517         16  CF-COMBINED-LIFE-AH-OPT.
  4518             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  4519             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  4520             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  4521             20  CF-CANCELLATION-RATIO      PIC S9(02).
  4522
  4523         16  CF-LIFE-OPT.
  4524             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4525             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4526             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4527             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4528             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4529             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4530             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4531             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL9301.cbl
  4532             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4533             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  4534
  4535         16  CF-AH-OPT.
  4536             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  4537             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  4538             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  4539             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  4540             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  4541             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  4542             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  4543             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  4544             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  4545             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  4546
  4547         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  4548             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  4549             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  4550             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  4551
  4552         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  4553
  4554         16  FILLER                         PIC X(673).
  4555
  4556
  4557****************************************************************
  4558*             MORTGAGE SYSTEM PLAN RECORD                      *
  4559****************************************************************
  4560
  4561     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  4562         16  CF-PLAN-TYPE                   PIC X.
  4563             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  4564             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  4565             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  4566         16  CF-PLAN-ABBREV                 PIC XXX.
  4567         16  CF-PLAN-DESCRIPT               PIC X(10).
  4568         16  CF-PLAN-NOTES                  PIC X(20).
  4569         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  4570         16  CF-PLAN-UNDERWRITING.
  4571             20  CF-PLAN-TERM-DATA.
  4572                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  4573                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  4574             20  CF-PLAN-AGE-DATA.
  4575                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  4576                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  4577                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  4578             20  CF-PLAN-BENEFIT-DATA.
  4579                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4580                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  4581                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  4582                                            PIC S9(7)V99  COMP-3.
  4583         16  CF-PLAN-POLICY-FORMS.
  4584             20  CF-POLICY-FORM             PIC X(12).
  4585             20  CF-MASTER-APPLICATION      PIC X(12).
  4586             20  CF-MASTER-POLICY           PIC X(12).
  4587         16  CF-PLAN-RATING.
  4588             20  CF-RATE-CODE               PIC X(5).
  4589             20  CF-SEX-RATING              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL9301.cbl
  4590                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  4591                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  4592             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  4593             20  CF-SUB-STD-TYPE            PIC X.
  4594                 88  CF-PCT-OF-PREM            VALUE '1'.
  4595                 88  CF-PCT-OF-BENE            VALUE '2'.
  4596         16  CF-PLAN-PREM-TOLERANCES.
  4597             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  4598             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  4599         16  CF-PLAN-PYMT-TOLERANCES.
  4600             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  4601             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  4602         16  CF-PLAN-MISC-DATA.
  4603             20  FILLER                     PIC X.
  4604             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  4605             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  4606         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  4607         16  CF-PLAN-IND-GRP                PIC X.
  4608             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  4609                                                     '1'.
  4610             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  4611                                                     '2'.
  4612         16  CF-MIB-SEARCH-SW               PIC X.
  4613             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  4614             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  4615             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  4616             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  4617         16  CF-ALPHA-SEARCH-SW             PIC X.
  4618             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  4619             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  4620             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  4621             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  4622             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  4623             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  4624             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  4625             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  4626             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  4627             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  4628                                                     'A' 'B' 'C'
  4629                                                     'X' 'Y' 'Z'.
  4630         16  CF-EFF-DT-RULE-SW              PIC X.
  4631             88  CF-EFF-DT-ENTER               VALUE 'E'.
  4632             88  CF-EFF-DT-MONTH               VALUE 'M'.
  4633             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  4634             88  CF-EFF-DT-SEMI                VALUE 'S'.
  4635             88  CF-EFF-DT-ANN                 VALUE 'A'.
  4636         16  FILLER                         PIC X(4).
  4637         16  CF-HEALTH-QUESTIONS            PIC X.
  4638             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  4639         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  4640         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  4641         16  CF-PLAN-SNGL-JNT               PIC X.
  4642             88  CF-COMBINED-PLAN              VALUE 'C'.
  4643             88  CF-JNT-PLAN                   VALUE 'J'.
  4644             88  CF-SNGL-PLAN                  VALUE 'S'.
  4645         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4646         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4647         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL9301.cbl
  4648         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4649         16  CF-RERATE-CNTL                 PIC  X.
  4650             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4651             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4652             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4653             88  CF-AUTO-RECALC                 VALUE '4'.
  4654         16  CF-BENEFIT-TYPE                PIC  X.
  4655             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4656             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4657         16  CF-POLICY-FEE                  PIC S999V99
  4658                                                    COMP-3.
  4659         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4660         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4661         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4662         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4663         16  FILLER                         PIC  X(32).
  4664         16  CF-TERMINATION-FORM            PIC  X(04).
  4665         16  FILLER                         PIC  X(08).
  4666         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4667                                                       COMP-3.
  4668         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4669         16  CF-ISSUE-LETTER                PIC  X(4).
  4670         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4671         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4672             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4673             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4674         16  CF-MP-REFUND-CALC              PIC X.
  4675             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4676             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4677             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4678             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4679             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4680             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4681             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4682             88  CF-MP-REFD-MEAN                VALUE '8'.
  4683         16  CF-ALT-RATE-CODE               PIC  X(5).
  4684
  4685
  4686         16  FILLER                         PIC X(498).
  4687****************************************************************
  4688*             MORTGAGE COMPANY MASTER RECORD                   *
  4689****************************************************************
  4690
  4691     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4692         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4693         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4694             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4695             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4696             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4697             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4698             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4699
  4700         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4701         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4702         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4703         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4704         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4705
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL9301.cbl
  4706         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4707             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4708         16  CF-MP-RECON-USE-IND            PIC X(1).
  4709             88  CF-MP-USE-RECON             VALUE 'Y'.
  4710         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4711             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4712         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4713             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4714             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4715         16  FILLER                         PIC X(1).
  4716         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4717             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4718         16  CF-MORTG-MIB-VERSION           PIC X.
  4719             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4720             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4721             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4722         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4723             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  4724                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4725             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4726                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4727             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4728                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4729             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4730                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4731             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4732                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4733             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4734                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4735         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4736         16  FILLER                         PIC X(7).
  4737         16  CF-MORTG-DESTINATION-SYMBOL.
  4738             20  CF-MORTG-MIB-COMM          PIC X(5).
  4739             20  CF-MORTG-MIB-TERM          PIC X(5).
  4740         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4741             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4742         16  FILLER                         PIC X(03).
  4743         16  CF-MP-CHECK-NO-CONTROL.
  4744             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4745                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4746                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4747                                                ' ' LOW-VALUES.
  4748                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4749                                               VALUE '3'.
  4750         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4751         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4752         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4753             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4754                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4755             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4756                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4757             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4758                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4759             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4760                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4761             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4762                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4763             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL9301.cbl
  4764                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4765         16  CF-MORTG-BILLING-AREA.
  4766             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4767                                            PIC X.
  4768         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4769         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4770         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4771         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4772             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4773             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4774         16  FILLER                         PIC X.
  4775         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4776             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4777             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4778         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4779         16  FILLER                         PIC X(8).
  4780         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4781         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  4782         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4783         16  CF-ACH-COMPANY-ID.
  4784             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4785                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4786                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4787                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4788             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4789         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4790             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4791         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4792             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4793             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4794         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4795         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4796         16  FILLER                         PIC X(536).
  4797
  4798****************************************************************
  4799*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4800****************************************************************
  4801
  4802     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4803         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4804             20  CF-FEMALE-HEIGHT.
  4805                 24  CF-FEMALE-FT           PIC 99.
  4806                 24  CF-FEMALE-IN           PIC 99.
  4807             20  CF-FEMALE-MIN-WT           PIC 999.
  4808             20  CF-FEMALE-MAX-WT           PIC 999.
  4809         16  FILLER                         PIC X(428).
  4810
  4811     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4812         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4813             20  CF-MALE-HEIGHT.
  4814                 24  CF-MALE-FT             PIC 99.
  4815                 24  CF-MALE-IN             PIC 99.
  4816             20  CF-MALE-MIN-WT             PIC 999.
  4817             20  CF-MALE-MAX-WT             PIC 999.
  4818         16  FILLER                         PIC X(428).
  4819******************************************************************
  4820*             AUTOMATIC ACTIVITY RECORD                          *
  4821******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL9301.cbl
  4822     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4823         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4824             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4825             20  CF-SYS-LETTER-ID           PIC X(04).
  4826             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4827             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4828             20  CF-SYS-RESET-SW            PIC X(01).
  4829             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4830             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4831
  4832         16  FILLER                         PIC X(50).
  4833
  4834         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4835             20  CF-USER-ACTIVE-SW          PIC X(01).
  4836             20  CF-USER-LETTER-ID          PIC X(04).
  4837             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4838             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4839             20  CF-USER-RESET-SW           PIC X(01).
  4840             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4841             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4842             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4843
  4844         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL9301.cbl
  4846
  4847*                                COPY ELCCERT.
  4848******************************************************************
  4849*                                                                *
  4850*                            ELCCERT.                            *
  4851*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4852*                            VMOD=2.013                          *
  4853*                                                                *
  4854*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4855*                                                                *
  4856*   FILE TYPE = VSAM,KSDS                                        *
  4857*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4858*                                                                *
  4859*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4860*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4861*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4862*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4863*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4864*                                                                *
  4865*   LOG = YES                                                    *
  4866*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4867******************************************************************
  4868*                   C H A N G E   L O G
  4869*
  4870* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4871*-----------------------------------------------------------------
  4872*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4873* EFFECTIVE    NUMBER
  4874*-----------------------------------------------------------------
  4875* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4876* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4877* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4878* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4879* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4880* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4881* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4882******************************************************************
  4883
  4884 01  CERTIFICATE-MASTER.
  4885     12  CM-RECORD-ID                      PIC XX.
  4886         88  VALID-CM-ID                      VALUE 'CM'.
  4887
  4888     12  CM-CONTROL-PRIMARY.
  4889         16  CM-COMPANY-CD                 PIC X.
  4890         16  CM-CARRIER                    PIC X.
  4891         16  CM-GROUPING.
  4892             20  CM-GROUPING-PREFIX        PIC X(3).
  4893             20  CM-GROUPING-PRIME         PIC X(3).
  4894         16  CM-STATE                      PIC XX.
  4895         16  CM-ACCOUNT.
  4896             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4897             20  CM-ACCOUNT-PRIME          PIC X(6).
  4898         16  CM-CERT-EFF-DT                PIC XX.
  4899         16  CM-CERT-NO.
  4900             20  CM-CERT-PRIME             PIC X(10).
  4901             20  CM-CERT-SFX               PIC X.
  4902
  4903     12  CM-CONTROL-BY-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL9301.cbl
  4904         16  CM-COMPANY-CD-A1              PIC X.
  4905         16  CM-INSURED-LAST-NAME          PIC X(15).
  4906         16  CM-INSURED-INITIALS.
  4907             20  CM-INSURED-INITIAL1       PIC X.
  4908             20  CM-INSURED-INITIAL2       PIC X.
  4909
  4910     12  CM-CONTROL-BY-SSN.
  4911         16  CM-COMPANY-CD-A2              PIC X.
  4912         16  CM-SOC-SEC-NO.
  4913             20  CM-SSN-STATE              PIC XX.
  4914             20  CM-SSN-ACCOUNT            PIC X(6).
  4915             20  CM-SSN-LN3.
  4916                 25  CM-INSURED-INITIALS-A2.
  4917                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4918                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4919                 25 CM-PART-LAST-NAME-A2         PIC X.
  4920
  4921     12  CM-CONTROL-BY-CERT-NO.
  4922         16  CM-COMPANY-CD-A4              PIC X.
  4923         16  CM-CERT-NO-A4                 PIC X(11).
  4924
  4925     12  CM-CONTROL-BY-MEMB.
  4926         16  CM-COMPANY-CD-A5              PIC X.
  4927         16  CM-MEMBER-NO.
  4928             20  CM-MEMB-STATE             PIC XX.
  4929             20  CM-MEMB-ACCOUNT           PIC X(6).
  4930             20  CM-MEMB-LN4.
  4931                 25  CM-INSURED-INITIALS-A5.
  4932                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4933                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4934                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4935
  4936     12  CM-INSURED-PROFILE-DATA.
  4937         16  CM-INSURED-FIRST-NAME.
  4938             20  CM-INSURED-1ST-INIT       PIC X.
  4939             20  FILLER                    PIC X(9).
  4940         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4941         16  CM-INSURED-SEX                PIC X.
  4942             88  CM-SEX-MALE                  VALUE 'M'.
  4943             88  CM-SEX-FEMAL                 VALUE 'F'.
  4944         16  CM-INSURED-JOINT-AGE          PIC 99.
  4945         16  CM-JOINT-INSURED-NAME.
  4946             20  CM-JT-LAST-NAME           PIC X(15).
  4947             20  CM-JT-FIRST-NAME.
  4948                 24  CM-JT-1ST-INIT        PIC X.
  4949                 24  FILLER                PIC X(9).
  4950             20  CM-JT-INITIAL             PIC X.
  4951
  4952     12  CM-LIFE-DATA.
  4953         16  CM-LF-BENEFIT-CD              PIC XX.
  4954         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4955         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4956         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4957         16  CM-LF-DEV-CODE                PIC XXX.
  4958         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4959         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4960         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4961         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL9301.cbl
  4962         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4963         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4964         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4965         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4966         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4967         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4968         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4969         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4970         16  FILLER                        PIC XX.
  4971
  4972     12  CM-AH-DATA.
  4973         16  CM-AH-BENEFIT-CD              PIC XX.
  4974         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4975         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4976         16  CM-AH-DEV-CODE                PIC XXX.
  4977         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4978         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4979         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4980         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4981         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4982         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4983         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4984         16  CM-AH-PAID-THRU-DT            PIC XX.
  4985             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4986         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4987         16  CM-AH-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4988         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4989         16  FILLER                        PIC X.
  4990
  4991     12  CM-LOAN-INFORMATION.
  4992         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4993         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4994         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4995         16  CM-PAY-FREQUENCY              PIC S99.
  4996         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4997         16  CM-RATE-CLASS                 PIC XX.
  4998         16  CM-BENEFICIARY                PIC X(25).
  4999         16  CM-POLICY-FORM-NO             PIC X(12).
  5000         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  5001         16  CM-LAST-ADD-ON-DT             PIC XX.
  5002         16  CM-DEDUCTIBLE-AMOUNTS.
  5003             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  5004             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  5005         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5006             20  CM-RESIDENT-STATE         PIC XX.
  5007             20  CM-RATE-CODE              PIC X(4).
  5008             20  FILLER                    PIC XX.
  5009         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  5010             20  CM-LOAN-OFFICER           PIC X(5).
  5011             20  FILLER                    PIC XXX.
  5012         16  CM-CSR-CODE                   PIC XXX.
  5013         16  CM-UNDERWRITING-CODE          PIC X.
  5014             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  5015         16  CM-POST-CARD-IND              PIC X.
  5016         16  CM-NH-INTERFACE-SW            PIC X.
  5017         16  CM-PREMIUM-TYPE               PIC X.
  5018             88  CM-SING-PRM                  VALUE '1'.
  5019             88  CM-O-B-COVERAGE              VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL9301.cbl
  5020             88  CM-OPEN-END                  VALUE '3'.
  5021         16  CM-IND-GRP-TYPE               PIC X.
  5022             88  CM-INDIVIDUAL                VALUE 'I'.
  5023             88  CM-GROUP                     VALUE 'G'.
  5024         16  CM-SKIP-CODE                  PIC X.
  5025             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  5026             88  SKIP-JULY                    VALUE '1'.
  5027             88  SKIP-AUGUST                  VALUE '2'.
  5028             88  SKIP-SEPTEMBER               VALUE '3'.
  5029             88  SKIP-JULY-AUG                VALUE '4'.
  5030             88  SKIP-AUG-SEPT                VALUE '5'.
  5031             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  5032             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  5033             88  SKIP-JUNE                    VALUE '8'.
  5034             88  SKIP-JUNE-JULY               VALUE '9'.
  5035             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  5036             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  5037         16  CM-PAYMENT-MODE               PIC X.
  5038             88  PAY-MONTHLY                  VALUE SPACE.
  5039             88  PAY-WEEKLY                   VALUE '1'.
  5040             88  PAY-SEMI-MONTHLY             VALUE '2'.
  5041             88  PAY-BI-WEEKLY                VALUE '3'.
  5042             88  PAY-SEMI-ANUALLY             VALUE '4'.
  5043         16  CM-LOAN-NUMBER                PIC X(8).
  5044         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  5045         16  CM-OLD-LOF                    PIC XXX.
  5046*        16  CM-LOAN-OFFICER               PIC XXX.
  5047         16  CM-REIN-TABLE                 PIC XXX.
  5048         16  CM-SPECIAL-REIN-CODE          PIC X.
  5049         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  5050         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  5051         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  5052
  5053     12  CM-STATUS-DATA.
  5054         16  CM-ENTRY-STATUS               PIC X.
  5055         16  CM-ENTRY-DT                   PIC XX.
  5056
  5057         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  5058         16  CM-LF-CANCEL-DT               PIC XX.
  5059         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  5060
  5061         16  CM-LF-STATUS-AT-DEATH         PIC X.
  5062         16  CM-LF-DEATH-DT                PIC XX.
  5063         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  5064
  5065         16  CM-LF-CURRENT-STATUS          PIC X.
  5066             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5067                                                'M' '4' '5' '9'.
  5068             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  5069             88  CM-LF-POLICY-PENDING         VALUE '2'.
  5070             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  5071             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  5072             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  5073             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  5074             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  5075             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  5076             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  5077             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL9301.cbl
  5078             88  CM-LF-DECLINED               VALUE 'D'.
  5079             88  CM-LF-VOIDED                 VALUE 'V'.
  5080
  5081         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  5082         16  CM-AH-CANCEL-DT               PIC XX.
  5083         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  5084
  5085         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  5086         16  CM-AH-SETTLEMENT-DT           PIC XX.
  5087         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  5088
  5089         16  CM-AH-CURRENT-STATUS          PIC X.
  5090             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  5091                                                'M' '4' '5' '9'.
  5092             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  5093             88  CM-AH-POLICY-PENDING         VALUE '2'.
  5094             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  5095             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  5096             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  5097             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  5098             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  5099             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  5100             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  5101             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  5102             88  CM-AH-DECLINED               VALUE 'D'.
  5103             88  CM-AH-VOIDED                 VALUE 'V'.
  5104
  5105         16  CM-CLAIM-INTERFACE-SW         PIC X.
  5106             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  5107             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  5108             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  5109         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  5110
  5111         16  CM-ENTRY-BATCH                PIC X(6).
  5112         16  CM-LF-EXIT-BATCH              PIC X(6).
  5113         16  CM-AH-EXIT-BATCH              PIC X(6).
  5114         16  CM-LAST-MONTH-END             PIC XX.
  5115
  5116     12  CM-NOTE-SW                        PIC X.
  5117         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  5118         88  CERT-NOTES-PRESENT               VALUE '1'.
  5119         88  BILLING-NOTES-PRESENT            VALUE '2'.
  5120         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  5121         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  5122         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  5123         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  5124         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  5125     12  CM-COMP-EXCP-SW                   PIC X.
  5126         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  5127         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  5128     12  CM-INSURED-ADDRESS-SW             PIC X.
  5129         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  5130         88  INSURED-ADDR-PRESENT             VALUE '1'.
  5131
  5132*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  5133     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  5134     12  FILLER                            PIC X.
  5135
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL9301.cbl
  5136*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  5137     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  5138     12  FILLER                            PIC X.
  5139*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  5140     12  CM-NH-INT-ON-REFS                 PIC S9(7)V99   COMP-3.
  5141
  5142     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  5143         88  CERT-ADDED-BATCH                 VALUE ' '.
  5144         88  CERT-ADDED-ONLINE                VALUE '1'.
  5145         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  5146         88  CERT-PURGED-OFFLINE              VALUE '3'.
  5147         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  5148     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  5149         88  CERT-AS-LOADED                   VALUE ' '.
  5150         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  5151         88  CERT-CLAIM-ONLINE                VALUE '2'.
  5152         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  5153         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  5154         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  5155         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  5156         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  5157
  5158     12  CM-ACCOUNT-COMM-PCTS.
  5159         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  5160         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5161
  5162     12  CM-USER-FIELD                     PIC X.
  5163     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  5164     12  CM-CLP-STATE                      PIC XX.
  5165     12  CM-USER-RESERVED                  PIC XXX.
  5166******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL9301.cbl
  5168
  5169*                                COPY ERCPNDM.
  5170******************************************************************
  5171*                                                                *
  5172*                                                                *
  5173*                            ERCPNDM                             *
  5174*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5175*                            VMOD=2.003                          *
  5176*                                                                *
  5177*   FILE DESCRIPTION = PENDING MAILING DATA                      *
  5178*                                                                *
  5179*   FILE TYPE = VSAM,KSDS                                        *
  5180*   RECORD SIZE = 374   RECFORM = FIX                            *
  5181*                                                                *
  5182*   BASE CLUSTER NAME = ERPNDM                 RKP=2,LEN=11      *
  5183*   ALTERNATE PATH    = NOT USED                                 *
  5184*                                                                *
  5185*   LOG = YES                                                    *
  5186*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5187******************************************************************
  5188*                   C H A N G E   L O G
  5189*
  5190* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5191*-----------------------------------------------------------------
  5192*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5193* EFFECTIVE    NUMBER
  5194*-----------------------------------------------------------------
  5195* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5196* 071108  CR2008040800002  PEMA  ADD CRED BENE INFORMATION
  5197* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5198******************************************************************
  5199
  5200 01  PENDING-MAILING-DATA.
  5201     12  PM-RECORD-ID                      PIC XX.
  5202         88  VALID-MA-ID                       VALUE 'PM'.
  5203
  5204     12  PM-CONTROL-PRIMARY.
  5205         16  PM-COMPANY-CD                 PIC X.
  5206         16  PM-ENTRY-BATCH                PIC X(6).
  5207         16  PM-BATCH-SEQ-NO               PIC S9(4)     COMP.
  5208         16  PM-BATCH-CHG-SEQ-NO           PIC S9(4)     COMP.
  5209
  5210     12  FILLER                            PIC X(14).
  5211
  5212     12  PM-ACCESS-CONTROL.
  5213         16  PM-SOURCE-SYSTEM              PIC XX.
  5214             88  PM-FROM-CREDIT                VALUE 'CR'.
  5215             88  PM-FROM-VSI                   VALUE 'VS'.
  5216             88  PM-FROM-WARRANTY              VALUE 'WA'.
  5217             88  PM-FROM-OTHER                 VALUE 'OT'.
  5218         16  PM-RECORD-ADD-DT              PIC XX.
  5219         16  PM-RECORD-ADDED-BY            PIC XXXX.
  5220         16  PM-LAST-MAINT-DT              PIC XX.
  5221         16  PM-LAST-MAINT-BY              PIC XXXX.
  5222         16  PM-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5223
  5224     12  PM-PROFILE-INFO.
  5225         16  PM-QUALIFY-CODE-1             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL9301.cbl
  5226         16  PM-QUALIFY-CODE-2             PIC XX.
  5227         16  PM-QUALIFY-CODE-3             PIC XX.
  5228         16  PM-QUALIFY-CODE-4             PIC XX.
  5229         16  PM-QUALIFY-CODE-5             PIC XX.
  5230
  5231         16  PM-INSURED-LAST-NAME          PIC X(15).
  5232         16  PM-INSURED-FIRST-NAME         PIC X(10).
  5233         16  PM-INSURED-MIDDLE-INIT        PIC X.
  5234         16  PM-INSURED-ISSUE-AGE          PIC 99.
  5235         16  PM-INSURED-BIRTH-DT           PIC XX.
  5236         16  PM-INSURED-SEX                PIC X.
  5237             88  PM-SEX-MALE                   VALUE 'M'.
  5238             88  PM-SEX-FEMALE                 VALUE 'F'.
  5239         16  PM-INSURED-SOC-SEC-NO         PIC X(11).
  5240
  5241         16  PM-ADDRESS-CORRECTED          PIC X.
  5242         16  PM-JOINT-BIRTH-DT             PIC XX.
  5243*        16  FILLER                        PIC X(12).
  5244
  5245         16  PM-ADDRESS-LINE-1             PIC X(30).
  5246         16  PM-ADDRESS-LINE-2             PIC X(30).
  5247         16  PM-CITY-STATE.
  5248             20  PM-CITY                   PIC X(28).
  5249             20  PM-STATE                  PIC XX.
  5250         16  PM-ZIP.
  5251             20  PM-ZIP-CODE.
  5252                 24  PM-ZIP-1              PIC X.
  5253                     88  PM-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5254                 24  FILLER                PIC X(4).
  5255             20  PM-ZIP-PLUS4              PIC X(4).
  5256         16  PM-CANADIAN-ZIP  REDEFINES  PM-ZIP.
  5257             20  PM-CAN-POST1              PIC XXX.
  5258             20  PM-CAN-POST2              PIC XXX.
  5259             20  FILLER                    PIC XXX.
  5260
  5261         16  PM-PHONE-NO                   PIC 9(11)       COMP-3.
  5262
  5263         16  FILLER                        PIC X(03).
  5264
  5265     12  PM-CRED-BENE-INFO.
  5266         16  PM-CRED-BENE-NAME             PIC X(25).
  5267         16  PM-CRED-BENE-ADDR             PIC X(30).
  5268         16  PM-CRED-BENE-ADDR2            PIC X(30).
  5269         16  PM-CRED-BENE-CTYST.
  5270             20  PM-CRED-BENE-CITY         PIC X(28).
  5271             20  PM-CRED-BENE-STATE        PIC XX.
  5272         16  PM-CRED-BENE-ZIP.
  5273             20  PM-CB-ZIP-CODE.
  5274                 24  PM-CB-ZIP-1           PIC X.
  5275                     88  PM-CB-CANADIAN-POST-CODE
  5276                                  VALUE 'A' THRU 'Z'.
  5277                 24  FILLER                PIC X(4).
  5278             20  PM-CB-ZIP-PLUS4           PIC X(4).
  5279         16  PM-CB-CANADIAN-ZIP  REDEFINES  PM-CRED-BENE-ZIP.
  5280             20  PM-CB-CAN-POST1           PIC XXX.
  5281             20  PM-CB-CAN-POST2           PIC XXX.
  5282             20  FILLER                    PIC XXX.
  5283     12  PM-POST-CARD-MAIL-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL9301.cbl
  5284         16  PM-MAIL-DATA OCCURS 7.
  5285             20  PM-MAIL-TYPE              PIC X.
  5286                 88  PM-12MO-MAILING           VALUE '1'.
  5287                 88  PM-EXP-MAILING            VALUE '2'.
  5288             20  PM-MAIL-STATUS            PIC X.
  5289                 88  PM-MAIL-ST-MAILED         VALUE '1'.
  5290                 88  PM-MAIL-ST-RETURNED       VALUE '2'.
  5291                 88  PM-MAIL-ST-NOT-MAILED     VALUE '3'.
  5292             20  PM-MAIL-DATE              PIC XX.
  5293     12  FILLER                            PIC XX.
  5294     12  FILLER                            PIC X(12).
  5295*    12  FILLER                            PIC X(30).
  5296
  5297******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL9301.cbl
  5299
  5300*                                COPY ERCACCT.
  5301******************************************************************
  5302*                                                                *
  5303*                                                                *
  5304*                            ERCACCT                             *
  5305*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5306*                            VMOD=2.031                          *
  5307*                                                                *
  5308*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  5309*                                                                *
  5310*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5311*   VSAM ACCOUNT MASTER FILES.                                   *
  5312*                                                                *
  5313*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  5314*                                                                *
  5315*   FILE TYPE = VSAM,KSDS                                        *
  5316*   RECORD SIZE = 2000  RECFORM = FIX                            *
  5317*                                                                *
  5318*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  5319*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  5320*                                                                *
  5321*   LOG = NO                                                     *
  5322*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5323*                                                                *
  5324*                                                                *
  5325******************************************************************
  5326*                   C H A N G E   L O G
  5327*
  5328* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5329*-----------------------------------------------------------------
  5330*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5331* EFFECTIVE    NUMBER
  5332*-----------------------------------------------------------------
  5333* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  5334* 092705    2005050300006  PEMA  ADD SPP LEASES
  5335* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  5336* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  5337******************************************************************
  5338
  5339 01  ACCOUNT-MASTER.
  5340     12  AM-RECORD-ID                      PIC XX.
  5341         88  VALID-AM-ID                      VALUE 'AM'.
  5342
  5343     12  AM-CONTROL-PRIMARY.
  5344         16  AM-COMPANY-CD                 PIC X.
  5345         16  AM-MSTR-CNTRL.
  5346             20  AM-CONTROL-A.
  5347                 24  AM-CARRIER            PIC X.
  5348                 24  AM-GROUPING.
  5349                     28 AM-GROUPING-PREFIX PIC XXX.
  5350                     28 AM-GROUPING-PRIME  PIC XXX.
  5351                 24  AM-STATE              PIC XX.
  5352                 24  AM-ACCOUNT.
  5353                     28  AM-ACCOUNT-PREFIX PIC X(4).
  5354                     28  AM-ACCOUNT-PRIME  PIC X(6).
  5355             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  5356                                           PIC X(19).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL9301.cbl
  5357             20  AM-CNTRL-B.
  5358                 24  AM-EXPIRATION-DT      PIC XX.
  5359                 24  FILLER                PIC X(4).
  5360             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  5361                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  5362
  5363     12  AM-CONTROL-BY-VAR-GRP.
  5364         16  AM-COMPANY-CD-A1              PIC X.
  5365         16  AM-VG-CARRIER                 PIC X.
  5366         16  AM-VG-GROUPING                PIC X(6).
  5367         16  AM-VG-STATE                   PIC XX.
  5368         16  AM-VG-ACCOUNT                 PIC X(10).
  5369         16  AM-VG-DATE.
  5370             20  AM-VG-EXPIRATION-DT       PIC XX.
  5371             20  FILLER                    PIC X(4).
  5372         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  5373                                           PIC 9(11)      COMP-3.
  5374     12  AM-MAINT-INFORMATION.
  5375         16  AM-LAST-MAINT-DT              PIC XX.
  5376         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5377         16  AM-LAST-MAINT-USER            PIC X(4).
  5378         16  FILLER                        PIC XX.
  5379
  5380     12  AM-EFFECTIVE-DT                   PIC XX.
  5381     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  5382
  5383     12  AM-PREV-DATES  COMP-3.
  5384         16  AM-PREV-EXP-DT                PIC 9(11).
  5385         16  AM-PREV-EFF-DT                PIC 9(11).
  5386
  5387     12  AM-REPORT-CODE-1                  PIC X(10).
  5388     12  AM-REPORT-CODE-2                  PIC X(10).
  5389
  5390     12  AM-CITY-CODE                      PIC X(4).
  5391     12  AM-COUNTY-PARISH                  PIC X(6).
  5392
  5393     12  AM-NAME                           PIC X(30).
  5394     12  AM-PERSON                         PIC X(30).
  5395     12  AM-ADDRS                          PIC X(30).
  5396     12  AM-CITY.
  5397         16  AM-ADDR-CITY                  PIC X(28).
  5398         16  AM-ADDR-STATE                 PIC XX.
  5399     12  AM-ZIP.
  5400         16  AM-ZIP-PRIME.
  5401             20  AM-ZIP-PRI-1ST            PIC X.
  5402                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  5403             20  FILLER                    PIC X(4).
  5404         16  AM-ZIP-PLUS4                  PIC X(4).
  5405     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  5406         16  AM-CAN-POSTAL-1               PIC XXX.
  5407         16  AM-CAN-POSTAL-2               PIC XXX.
  5408         16  FILLER                        PIC XXX.
  5409     12  AM-TEL-NO.
  5410         16  AM-AREA-CODE                  PIC 999.
  5411         16  AM-TEL-PRE                    PIC 999.
  5412         16  AM-TEL-NBR                    PIC 9(4).
  5413     12  AM-TEL-LOC                        PIC X.
  5414         88  AM-TEL-AT-HOME                   VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL9301.cbl
  5415         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  5416
  5417     12  AM-COMM-STRUCTURE.
  5418         16  AM-DEFN-1.
  5419             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  5420                 24  AM-AGT.
  5421                     28  AM-AGT-PREFIX     PIC X(4).
  5422                     28  AM-AGT-PRIME      PIC X(6).
  5423                 24  AM-COM-TYP            PIC X.
  5424                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  5425                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  5426                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  5427                 24  AM-RECALC-LV-INDIC    PIC X.
  5428                 24  AM-RETRO-LV-INDIC     PIC X.
  5429                 24  AM-GL-CODES           PIC X.
  5430                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  5431                 24  FILLER                PIC X(01).
  5432         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  5433             20  AM-COM-TBLS        OCCURS 10 TIMES.
  5434                 24  FILLER                PIC X(11).
  5435                 24  AM-L-COMA             PIC XXX.
  5436                 24  AM-J-COMA             PIC XXX.
  5437                 24  AM-A-COMA             PIC XXX.
  5438                 24  FILLER                PIC X(6).
  5439
  5440     12  AM-COMM-CHANGE-STATUS             PIC X.
  5441         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  5442
  5443     12  AM-CSR-CODE                       PIC X(4).
  5444
  5445     12  AM-BILLING-STATUS                 PIC X.
  5446         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  5447         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  5448     12  AM-AUTO-REFUND-SW                 PIC X.
  5449         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  5450         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  5451     12  AM-GPCD                           PIC 99.
  5452     12  AM-IG                             PIC X.
  5453         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  5454         88  AM-HAS-GROUP                     VALUE '2'.
  5455     12  AM-STATUS                         PIC X.
  5456         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  5457         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  5458         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  5459         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  5460         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  5461     12  AM-REMIT-TO                       PIC 99.
  5462     12  AM-ID-NO                          PIC X(11).
  5463
  5464     12  AM-CAL-TABLE                      PIC XX.
  5465     12  AM-LF-DEVIATION                   PIC XXX.
  5466     12  AM-AH-DEVIATION                   PIC XXX.
  5467     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5468     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  5469     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  5470     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  5471     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  5472     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL9301.cbl
  5473
  5474     12  AM-USER-FIELDS.
  5475         16  AM-FLD-1                      PIC XX.
  5476         16  AM-FLD-2                      PIC XX.
  5477         16  AM-FLD-3                      PIC XX.
  5478         16  AM-FLD-4                      PIC XX.
  5479         16  AM-FLD-5                      PIC XX.
  5480
  5481     12  AM-1ST-PROD-DATE.
  5482         16  AM-1ST-PROD-YR                PIC XX.
  5483         16  AM-1ST-PROD-MO                PIC XX.
  5484         16  AM-1ST-PROD-DA                PIC XX.
  5485     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  5486     12  AM-CERTS-PURGED-DATE.
  5487         16  AM-PUR-YR                     PIC XX.
  5488         16  AM-PUR-MO                     PIC XX.
  5489         16  AM-PUR-DA                     PIC XX.
  5490     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  5491     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  5492     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  5493     12  AM-INACTIVE-DATE.
  5494         16  AM-INA-MO                     PIC 99.
  5495         16  AM-INA-DA                     PIC 99.
  5496         16  AM-INA-YR                     PIC 99.
  5497     12  AM-AR-HI-CERT-DATE                PIC XX.
  5498
  5499     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5500     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  5501
  5502     12  AM-OB-PAYMENT-MODE                PIC X.
  5503         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  5504         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  5505         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  5506         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  5507
  5508     12  AM-AH-ONLY-INDICATOR              PIC X.
  5509         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  5510         88  AM-NO-AH-ONLY                    VALUE 'N'.
  5511
  5512     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  5513
  5514     12  AM-OVER-SHORT.
  5515         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  5516         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  5517
  5518     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  5519     12  AM-DCC-CLP-STATE                  PIC XX.
  5520
  5521     12  AM-RECALC-COMM                    PIC X.
  5522     12  AM-RECALC-REIN                    PIC X.
  5523
  5524     12  AM-REI-TABLE                      PIC XXX.
  5525     12  AM-REI-ET-LF                      PIC X.
  5526     12  AM-REI-ET-AH                      PIC X.
  5527     12  AM-REI-PE-LF                      PIC X.
  5528     12  AM-REI-PE-AH                      PIC X.
  5529     12  AM-REI-PRT-ST                     PIC X.
  5530     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL9301.cbl
  5531     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  5532     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  5533     12  AM-REI-GROUP-A                    PIC X(6).
  5534     12  AM-REI-MORT                       PIC X(4).
  5535     12  AM-REI-PRT-OW                     PIC X.
  5536     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  5537     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  5538     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  5539     12  AM-REI-GROUP-B                    PIC X(6).
  5540
  5541     12  AM-TRUST-TYPE                     PIC X(2).
  5542
  5543     12  AM-EMPLOYER-STMT-USED             PIC X.
  5544     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  5545
  5546     12  AM-STD-AH-TYPE                    PIC XX.
  5547     12  AM-EARN-METHODS.
  5548         16  AM-EARN-METHOD-R              PIC X.
  5549             88 AM-REF-RL-R78                 VALUE 'R'.
  5550             88 AM-REF-RL-PR                  VALUE 'P'.
  5551             88 AM-REF-RL-MEAN                VALUE 'M'.
  5552             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  5553         16  AM-EARN-METHOD-L              PIC X.
  5554             88 AM-REF-LL-R78                 VALUE 'R'.
  5555             88 AM-REF-LL-PR                  VALUE 'P'.
  5556             88 AM-REF-LL-MEAN                VALUE 'M'.
  5557             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  5558         16  AM-EARN-METHOD-A              PIC X.
  5559             88 AM-REF-AH-R78                 VALUE 'R'.
  5560             88 AM-REF-AH-PR                  VALUE 'P'.
  5561             88 AM-REF-AH-MEAN                VALUE 'M'.
  5562             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  5563             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  5564             88 AM-REF-AH-NET                 VALUE 'N'.
  5565
  5566     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  5567     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  5568     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  5569
  5570     12  AM-RET-Y-N                        PIC X.
  5571     12  AM-RET-P-E                        PIC X.
  5572     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  5573     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  5574     12  AM-RET-GRP                        PIC X(6).
  5575     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  5576         16  AM-POOL-PRIME                 PIC XXX.
  5577         16  AM-POOL-SUB                   PIC XXX.
  5578     12  AM-RETRO-EARNINGS.
  5579         16  AM-RET-EARN-R                 PIC X.
  5580         16  AM-RET-EARN-L                 PIC X.
  5581         16  AM-RET-EARN-A                 PIC X.
  5582     12  AM-RET-ST-TAX-USE                 PIC X.
  5583         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  5584         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  5585     12  AM-RETRO-BEG-EARNINGS.
  5586         16  AM-RET-BEG-EARN-R             PIC X.
  5587         16  AM-RET-BEG-EARN-L             PIC X.
  5588         16  AM-RET-BEG-EARN-A             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL9301.cbl
  5589     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  5590     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  5591
  5592     12  AM-USER-SELECT-OPTIONS.
  5593         16  AM-USER-SELECT-1              PIC X(10).
  5594         16  AM-USER-SELECT-2              PIC X(10).
  5595         16  AM-USER-SELECT-3              PIC X(10).
  5596         16  AM-USER-SELECT-4              PIC X(10).
  5597         16  AM-USER-SELECT-5              PIC X(10).
  5598
  5599     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5600
  5601     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  5602
  5603     12  AM-RPT045A-SWITCH                 PIC X.
  5604         88  RPT045A-OFF                   VALUE 'N'.
  5605
  5606     12  AM-INSURANCE-LIMITS.
  5607         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  5608         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  5609
  5610     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  5611         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  5612
  5613     12  AM-DISMBR-COVERAGE-SW             PIC X.
  5614         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  5615         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  5616
  5617     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  5618
  5619     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  5620     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  5621     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  5622     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  5623     12  FILLER                            PIC X(5).
  5624     12  AM-REPORT-CODE-3                  PIC X(10).
  5625*    12  FILLER                            PIC X(22).
  5626
  5627     12  AM-RESERVE-DATE.
  5628         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  5629         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  5630         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  5631
  5632     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  5633     12  AM-NOTIFICATION-TYPES.
  5634         16  AM-NOTIF-OF-LETTERS           PIC X.
  5635         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  5636         16  AM-NOTIF-OF-REPORTS           PIC X.
  5637         16  AM-NOTIF-OF-STATUS            PIC X.
  5638
  5639     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  5640         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  5641         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  5642         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  5643         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  5644
  5645     12  AM-BENEFIT-CONTROLS.
  5646         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL9301.cbl
  5647             20  AM-BENEFIT-CODE           PIC XX.
  5648             20  AM-BENEFIT-TYPE           PIC X.
  5649             20  AM-BENEFIT-REVISION       PIC XXX.
  5650             20  AM-BENEFIT-REM-TERM       PIC X.
  5651             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  5652             20  FILLER                    PIC XX.
  5653         16  FILLER                        PIC X(80).
  5654
  5655     12  AM-TRANSFER-DATA.
  5656         16  AM-TRANSFERRED-FROM.
  5657             20  AM-TRNFROM-CARRIER        PIC X.
  5658             20  AM-TRNFROM-GROUPING.
  5659                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  5660                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  5661             20  AM-TRNFROM-STATE          PIC XX.
  5662             20  AM-TRNFROM-ACCOUNT.
  5663                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  5664                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  5665             20  AM-TRNFROM-DTE            PIC XX.
  5666         16  AM-TRANSFERRED-TO.
  5667             20  AM-TRNTO-CARRIER          PIC X.
  5668             20  AM-TRNTO-GROUPING.
  5669                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  5670                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  5671             20  AM-TRNTO-STATE            PIC XX.
  5672             20  AM-TRNTO-ACCOUNT.
  5673                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  5674                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  5675             20  AM-TRNTO-DTE              PIC XX.
  5676         16  FILLER                        PIC X(10).
  5677
  5678     12  AM-SAVED-REMIT-TO                 PIC 99.
  5679
  5680     12  AM-COMM-STRUCTURE-SAVED.
  5681         16  AM-DEFN-1-SAVED.
  5682             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  5683                 24  AM-AGT-SV             PIC X(10).
  5684                 24  AM-COM-TYP-SV         PIC X.
  5685                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  5686                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  5687                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  5688                 24  AM-RECALC-LV-INDIC-SV PIC X.
  5689                 24  FILLER                PIC X.
  5690                 24  AM-GL-CODES-SV        PIC X.
  5691                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  5692                 24  FILLER                PIC X.
  5693         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  5694             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  5695                 24  FILLER                PIC X(11).
  5696                 24  AM-L-COMA-SV          PIC XXX.
  5697                 24  AM-J-COMA-SV          PIC XXX.
  5698                 24  AM-A-COMA-SV          PIC XXX.
  5699                 24  FILLER                PIC X(6).
  5700
  5701     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  5702         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  5703            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  5704            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL9301.cbl
  5705            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  5706
  5707     12  AM-ORIG-DEALER-NO                 PIC X(10).
  5708     12  FILLER                            PIC X(120).
  5709
  5710     12  AM-ACCOUNT-EXECUTIVE-DATA.
  5711         16  AM-CONTROL-NAME               PIC X(30).
  5712         16  AM-EXECUTIVE-ONE.
  5713             20  AM-EXEC1-NAME             PIC X(15).
  5714             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  5715                                                          COMP-3.
  5716             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  5717                                                          COMP-3.
  5718         16  AM-EXECUTIVE-TWO.
  5719             20  AM-EXEC2-NAME             PIC X(15).
  5720             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  5721                                                          COMP-3.
  5722             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  5723                                                          COMP-3.
  5724
  5725     12  AM-RETRO-ADDITIONAL-DATA.
  5726         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  5727         16  AM-RETRO-PREM-P-E             PIC X.
  5728         16  AM-RETRO-CLMS-P-I             PIC X.
  5729         16  AM-RETRO-RET-BRACKET-LF.
  5730             20  AM-RETRO-RET-METHOD-LF    PIC X.
  5731                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  5732                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  5733             20  AM-RETRO-RET-BASIS-LF     PIC X.
  5734                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  5735                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  5736             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  5737                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  5738                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  5739         16  AM-RETRO-RET-BRACKET-AH.
  5740             20  AM-RETRO-RET-METHOD-AH    PIC X.
  5741                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  5742                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  5743                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  5744             20  AM-RETRO-RET-BASIS-AH     PIC X.
  5745                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  5746                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  5747             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  5748                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  5749                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  5750
  5751     12  AM-COMMENTS.
  5752         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  5753
  5754     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  5755         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  5756         16  AM-FLI-BILLING-CODE           PIC X.
  5757         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  5758         16  AM-FLI-UNITED-IDENT           PIC X.
  5759         16  AM-FLI-INTEREST-LOST-DATA.
  5760             20  AM-FLI-BANK-NO            PIC X(5).
  5761             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  5762             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL9301.cbl
  5763             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  5764         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  5765             20  AM-FLI-AGT                PIC X(9).
  5766             20  AM-FLI-AGT-COMM-ACC       PIC X.
  5767             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  5768         16  FILLER                        PIC X(102).
  5769
  5770     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  5771         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  5772             20  AM-BENEFIT-DMD-CODE         PIC XX.
  5773             20  AM-BENEFIT-DMD-TYPE         PIC X.
  5774             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  5775             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  5776             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  5777         16  FILLER                          PIC X(10).
  5778******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL9301.cbl
  5780
  5781
  5782 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PARMLIST
  5783                          PENDING-BUSINESS CONTROL-FILE
  5784                          CERTIFICATE-MASTER
  5785                          PENDING-MAILING-DATA ACCOUNT-MASTER.
  5786 0000-DFHEXIT SECTION.
  5787     MOVE '9#                    $   ' TO DFHEIV0.
  5788     MOVE 'EL9301' TO DFHEIV1.
  5789     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5790
  5791     SERVICE RELOAD PARMLIST.
  5792
  5793     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  5794     MOVE PI-COMPANY-ID          TO ELCNTL-COMPANY-ID.
  5795
  5796     MOVE +2                     TO EMI-NUMBER-OF-LINES.
  5797
  5798     IF EIBCALEN = 0
  5799         GO TO 8800-UNAUTHORIZED-ACCESS.
  5800
  5801     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  5802     MOVE '5'                    TO DC-OPTION-CODE.
  5803     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  5804     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  5805     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT.
  5806
  5807     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5808         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5809             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5810             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5811             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5812             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5813             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5814             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5815             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5816             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5817         ELSE
  5818             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  5819             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  5820             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  5821             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  5822             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  5823             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  5824             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  5825             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  5826
  5827     MOVE LOW-VALUES             TO EL930BI.
  5828
  5829     IF EIBTRNID NOT = TRANS-EXI2
  5830         MOVE ZEROS              TO PI-LF-ISS-ENTERED
  5831                                    PI-LF-CAN-ENTERED
  5832                                    PI-AH-ISS-ENTERED
  5833                                    PI-AH-CAN-ENTERED
  5834                                    PI-ISS-CNT-ENTERED
  5835                                    PI-CAN-CNT-ENTERED
  5836         IF PI-MAINT-FUNC = 'N'
  5837            MOVE +0              TO PI-LAST-SEQ-NO-ADDED
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL9301.cbl
  5838            MOVE +1              TO PI-NEXT-DISPLAY-SEQ-NO
  5839            IF PI-MAP-NAME = EL930B
  5840               PERFORM 8550-SET-MAP-SEQ-NOS
  5841               GO TO 8100-SEND-INITIAL-MAP
  5842            ELSE
  5843               PERFORM 8550-SET-MAP-SEQ-NOS
  5844                       VARYING WS-SUB2 FROM 1 BY 1
  5845                       UNTIL WS-SUB2   GREATER THAN +2
  5846                 GO TO 8100-SEND-INITIAL-MAP
  5847         ELSE
  5848             GO TO 3000-CONTINUE-ENTRY.
  5849
  5850
  5851* EXEC CICS HANDLE CONDITION
  5852*        PGMIDERR  (9600-PGMID-ERROR)
  5853*        ERROR     (9990-ABEND)
  5854*        END-EXEC.
  5855*    MOVE '"$L.                  ! " #00005846' TO DFHEIV0
  5856     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  5857     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5858     MOVE X'2220233030303035383436' TO DFHEIV0(25:11)
  5859     CALL 'kxdfhei1' USING DFHEIV0
  5860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5861
  5862
  5863     IF EIBAID = DFHCLEAR
  5864         GO TO 9400-CLEAR.
  5865
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL9301.cbl
  5867
  5868******************************************************************
  5869*                                                                *
  5870*                R E C E I V E   M A P S                         *
  5871*                                                                *
  5872******************************************************************
  5873
  5874 0200-RECEIVE.
  5875
  5876     IF EIBAID = DFHPA1 OR
  5877                 DFHPA2 OR
  5878                 DFHPA3
  5879         MOVE ER-0008            TO EMI-ERROR
  5880         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5881         IF PI-MAP-NAME = EL930B
  5882             MOVE -1             TO BPFENTRL
  5883             GO TO 8200-SEND-DATAONLY
  5884         ELSE
  5885             MOVE -1             TO CPFENTRL
  5886             GO TO 8200-SEND-DATAONLY.
  5887
  5888
  5889* EXEC CICS RECEIVE
  5890*        MAP      (PI-MAP-NAME)
  5891*        MAPSET   (MAPSET-EL9301S)
  5892*        INTO     (DATA-ENTRY-MAP)
  5893*        END-EXEC.
  5894     MOVE LENGTH OF
  5895      DATA-ENTRY-MAP
  5896       TO DFHEIV11
  5897*    MOVE '8"T I  L              ''   #00005876' TO DFHEIV0
  5898     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5899     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5900     MOVE X'2020233030303035383736' TO DFHEIV0(25:11)
  5901     CALL 'kxdfhei1' USING DFHEIV0,
  5902           PI-MAP-NAME,
  5903           DATA-ENTRY-MAP,
  5904           DFHEIV11,
  5905           MAPSET-EL9301S,
  5906           DFHEIV99,
  5907           DFHEIV99
  5908     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5909
  5910
  5911*    TRANSFORM DATA-ENTRY-MAP FROM '_' TO ' '.
  5912     INSPECT DATA-ENTRY-MAP REPLACING ALL '_' BY ' '.
  5913
  5914     IF PI-MAP-NAME = EL930B
  5915         IF BPFENTRL GREATER THAN ZERO
  5916             IF EIBAID NOT = DFHENTER
  5917                 MOVE ER-0004    TO EMI-ERROR
  5918                 MOVE AL-UNBOF   TO BPFENTRA
  5919                 MOVE -1         TO BPFENTRL
  5920                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5921                 GO TO 8200-SEND-DATAONLY
  5922             ELSE
  5923                 IF BPFENTRI NUMERIC
  5924                   AND BPFENTRI GREATER THAN 0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL9301.cbl
  5925                   AND BPFENTRI LESS THAN 23
  5926                     MOVE PF-VALUES (BPFENTRI) TO EIBAID
  5927                 ELSE
  5928                     MOVE ER-0029  TO EMI-ERROR
  5929                     MOVE AL-UNBOF TO BPFENTRA
  5930                     MOVE -1       TO BPFENTRL
  5931                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5932                     GO TO 8200-SEND-DATAONLY
  5933         ELSE
  5934             NEXT SENTENCE
  5935
  5936     ELSE
  5937
  5938     IF PI-MAP-NAME = EL930C
  5939         IF CPFENTRL GREATER THAN ZERO
  5940             IF EIBAID NOT = DFHENTER
  5941                 MOVE ER-0004    TO EMI-ERROR
  5942                 MOVE AL-UNBOF   TO CPFENTRA
  5943                 MOVE -1         TO CPFENTRL
  5944                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5945                 GO TO 8200-SEND-DATAONLY
  5946             ELSE
  5947                 IF CPFENTRI NUMERIC
  5948                   AND CPFENTRI GREATER THAN 0
  5949                   AND CPFENTRI LESS THAN 23
  5950                     MOVE PF-VALUES (CPFENTRI) TO EIBAID
  5951                 ELSE
  5952                     MOVE ER-0029  TO EMI-ERROR
  5953                     MOVE AL-UNBOF TO BPFENTRA
  5954                     MOVE -1       TO BPFENTRL
  5955                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5956                     GO TO 8200-SEND-DATAONLY.
  5957
  5958
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL9301.cbl
  5960******************************************************************
  5961*                                                                *
  5962*                  C H E C K   PF   K E Y S                      *
  5963*                                                                *
  5964******************************************************************
  5965
  5966
  5967******************************************************************
  5968*                                                                *
  5969*   PF KEY FUNCTIONS:                                            *
  5970*                                                                *
  5971*   PF1 = BROWSE FOWARD                                          *
  5972*   PF2 = BROWSE BACKWARD                                        *
  5973*   PF3 = ADD ISSUE RECORD                                       *
  5974*   PF4 = ADD CANCEL RECORD                                      *
  5975*   PF5 = RESET TABS (OPEN PRTECTED FIELDS)                      *
  5976*   PF6 = DELETE ENTRY                                           *
  5977*                                                                *
  5978******************************************************************
  5979
  5980 0300-CHECK-PFKEYS.
  5981
  5982     IF EIBAID = DFHPF12
  5983         GO TO 9500-PF12.
  5984
  5985     IF EIBAID = DFHENTER
  5986         GO TO 1000-EDIT-MAPB.
  5987
  5988     IF EIBAID = DFHPF1
  5989         GO TO 2000-BROWSE-FWD.
  5990
  5991     IF EIBAID = DFHPF2
  5992         GO TO 2100-BROWSE-BKWD.
  5993
  5994     IF EIBAID = DFHPF3
  5995         MOVE SPACE              TO PI-DISPLAY-SW
  5996         MOVE LOW-VALUES         TO DATA-ENTRY-MAP
  5997         ADD +1, PI-LAST-SEQ-NO-ADDED
  5998               GIVING PI-NEXT-DISPLAY-SEQ-NO
  5999         MOVE PI-NEXT-DISPLAY-SEQ-NO TO PI-SAV-BATCH-SEQ
  6000         MOVE EL930B             TO PI-MAP-NAME
  6001         PERFORM 8550-SET-MAP-SEQ-NOS
  6002         GO TO 8100-SEND-INITIAL-MAP.
  6003
  6004     IF EIBAID = DFHPF4
  6005         MOVE SPACE              TO PI-DISPLAY-SW
  6006         MOVE LOW-VALUES         TO MAP-C
  6007         ADD +1, PI-LAST-SEQ-NO-ADDED
  6008               GIVING PI-NEXT-DISPLAY-SEQ-NO
  6009         MOVE PI-NEXT-DISPLAY-SEQ-NO TO PI-SAV-BATCH-SEQ
  6010         MOVE EL930C             TO PI-MAP-NAME
  6011         PERFORM 8550-SET-MAP-SEQ-NOS
  6012                VARYING WS-SUB2 FROM 1 BY 1
  6013                UNTIL WS-SUB2 GREATER THAN +2
  6014         GO TO 8100-SEND-INITIAL-MAP.
  6015
  6016     IF EIBAID = DFHPF5
  6017        IF PI-MAP-NAME = EL930B
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL9301.cbl
  6018           PERFORM 0610-UNPROTECT-FIELDS THRU 0610-EXIT
  6019           ADD +1, PI-LAST-SEQ-NO-ADDED
  6020                  GIVING PI-NEXT-DISPLAY-SEQ-NO
  6021           PERFORM 8550-SET-MAP-SEQ-NOS
  6022           MOVE -1             TO BCERTL
  6023           GO TO 8200-SEND-DATAONLY
  6024        ELSE
  6025           PERFORM 0710-UNPROTECT-FIELDS THRU 0710-EXIT
  6026           ADD +1, PI-LAST-SEQ-NO-ADDED
  6027                  GIVING PI-NEXT-DISPLAY-SEQ-NO
  6028           PERFORM 8550-SET-MAP-SEQ-NOS
  6029                   VARYING WS-SUB2 FROM +1 BY +1
  6030                   UNTIL WS-SUB2 GREATER THAN +2
  6031          MOVE -1             TO CCERT-LEN  (1)
  6032          GO TO 8200-SEND-DATAONLY.
  6033
  6034     IF EIBAID = DFHPF6
  6035         IF PI-LAST-FUNC-DISPLAY
  6036             GO TO 6000-DELETE-PEND-BUS-RECORD
  6037         ELSE
  6038             MOVE ER-2594        TO EMI-ERROR
  6039             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6040             IF PI-MAP-NAME = EL930B
  6041                 MOVE -1         TO BPFENTRL
  6042                 GO TO 8200-SEND-DATAONLY
  6043             ELSE
  6044                 MOVE -1         TO CPFENTRL
  6045                 GO TO 8200-SEND-DATAONLY.
  6046
  6047     MOVE ER-0008 TO EMI-ERROR.
  6048     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6049
  6050     IF PI-MAP-NAME = EL930B
  6051         MOVE -1                 TO BPFENTRL
  6052     ELSE
  6053         MOVE -1                 TO CPFENTRL.
  6054
  6055     GO TO 8200-SEND-DATAONLY.
  6056
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL9301.cbl
  6058
  6059
  6060******************************************************************
  6061*                                                                *
  6062*         P R O T E C T   I S S U E   F I E L D S                *
  6063*                                                                *
  6064******************************************************************
  6065
  6066 0600-PROTECT-FIELDS.
  6067
  6068     IF NOT PI-ISS-SUFFIX-KEYED
  6069         MOVE AL-SANOF           TO BSFX-ATTRB.
  6070
  6071     IF NOT PI-IG-KEYED
  6072         MOVE AL-SANOF           TO BIND-GRP-ATTRB.
  6073
  6074     IF NOT PI-1ST-PMT-KEYED
  6075         MOVE AL-SANOF           TO B1ST-PMT-ATTRB.
  6076
  6077     IF NOT PI-DAYS-KEYED
  6078         MOVE AL-SANOF           TO BDAYS-ATTRB.
  6079
  6080     IF NOT PI-APR-KEYED
  6081         MOVE AL-SANOF           TO BAPR-ATTRB.
  6082
  6083     IF NOT PI-FREQ-KEYED
  6084         MOVE AL-SANOF           TO BFREQ-ATTRB.
  6085
  6086     IF NOT PI-SIG-KEYED
  6087         MOVE AL-SANOF           TO BSIG-ATTRB.
  6088
  6089     IF NOT PI-ISS-LIVES-KEYED
  6090         MOVE AL-SANOF           TO BLIVES-ATTRB.
  6091
  6092     IF NOT PI-SSNUM-KEYED
  6093         MOVE AL-SANOF           TO BSSNUM-ATTRB.
  6094
  6095     IF NOT PI-MEMBER-KEYED
  6096         MOVE AL-SANOF           TO BMEM-NO-ATTRB.
  6097
  6098     IF NOT PI-MODE-KEYED
  6099         MOVE AL-SANOF           TO BMODE-ATTRB.
  6100
  6101     IF NOT PI-PMTS-KEYED
  6102         MOVE AL-SANOF           TO BPMTS-ATTRB.
  6103
  6104     IF NOT PI-LN-OFFICER-KEYED
  6105         MOVE AL-SANOF           TO BLN-OFFICER-ATTRB.
  6106
  6107     IF NOT PI-LNTRM-KEYED
  6108         MOVE AL-SANOF           TO BLN-TERM-ATTRB.
  6109
  6110     IF NOT PI-ENTRY-KEYED
  6111         MOVE AL-SANOF           TO BENTRY-ATTRB.
  6112
  6113*    IF NOT PI-ZIP4-KEYED
  6114*        MOVE AL-SANOF           TO BZIP4-ATTRB.
  6115
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL9301.cbl
  6116     IF NOT PI-POLICY-KEYED
  6117         MOVE AL-SANOF           TO BPOLICY-ATTRB.
  6118
  6119     IF NOT PI-RINCD-KEYED
  6120         MOVE AL-SANOF           TO BRINCD-ATTRB.
  6121
  6122     IF NOT PI-RTCLS-KEYED
  6123         MOVE AL-SANOF           TO BRTCLS-ATTRB.
  6124
  6125
  6126     IF NOT PI-EXPIRE-KEYED
  6127         MOVE AL-SANOF           TO BEXPIRE-ATTRB (1)
  6128                                    BEXPIRE-ATTRB (2).
  6129
  6130     IF NOT PI-CRIT-PERD-KEYED
  6131         MOVE AL-SANOF           TO BCRIT-PERD-ATTRB (1)
  6132                                    BCRIT-PERD-ATTRB (2).
  6133
  6134     IF NOT PI-PMT-KEYED
  6135         MOVE AL-SANOF           TO BPMT-ATTRB.
  6136
  6137     IF NOT PI-SKPCD-KEYED
  6138         MOVE AL-SANOF           TO BSKPCD-ATTRB.
  6139
  6140     IF PI-BIRTH-DATE-IS-INPUT
  6141         MOVE AL-SANOF           TO BAGE-ATTRB
  6142     ELSE
  6143         MOVE AL-SANOF           TO BBIRTH-ATTRB.
  6144
  6145     IF NOT PI-JNT-AGE-KEYED
  6146         MOVE AL-SANOF           TO BJNT-AGE-ATTRB.
  6147
  6148     IF NOT PI-JNT-NAME-KEYED
  6149         MOVE AL-SANOF           TO BJNT-INIT-ATTRB
  6150                                    BJNT-LST-NAME-ATTRB
  6151                                    BJNT-1ST-NAME-ATTRB.
  6152
  6153     IF NOT PI-BENEFICIARY-KEYED
  6154         MOVE AL-SANOF           TO BBENEFICIARY-ATTRB.
  6155
  6156     IF NOT PI-PHONE-KEYED
  6157         MOVE AL-SANOF           TO BPHONE-ATTRB.
  6158
  6159     IF NOT PI-ALT-BEN-KEYED
  6160         MOVE AL-SANOF           TO BALT-BEN-ATTRB (1).
  6161
  6162     IF NOT PI-ALT-PREM-KEYED
  6163         MOVE AL-SANOF           TO BALT-PREM-ATTRB (1).
  6164
  6165 0600-EXIT.
  6166     EXIT.
  6167
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL9301.cbl
  6169
  6170******************************************************************
  6171*                                                                *
  6172*         U N P R O T E C T   I S S U E   F I E L D S            *
  6173*                                                                *
  6174******************************************************************
  6175
  6176 0610-UNPROTECT-FIELDS.
  6177
  6178     IF NOT PI-ISS-SUFFIX-KEYED
  6179         MOVE AL-UANOF           TO BSFX-ATTRB.
  6180
  6181     IF NOT PI-IG-KEYED
  6182         MOVE AL-UANOF           TO BIND-GRP-ATTRB.
  6183
  6184     IF NOT PI-1ST-PMT-KEYED
  6185         MOVE AL-UANOF           TO B1ST-PMT-ATTRB.
  6186
  6187     IF NOT PI-DAYS-KEYED
  6188         MOVE AL-UANOF           TO BDAYS-ATTRB.
  6189
  6190     IF NOT PI-APR-KEYED
  6191         MOVE AL-UANOF           TO BAPR-ATTRB.
  6192
  6193     IF NOT PI-FREQ-KEYED
  6194         MOVE AL-UANOF           TO BFREQ-ATTRB.
  6195
  6196     IF NOT PI-SIG-KEYED
  6197         MOVE AL-UANOF           TO BSIG-ATTRB.
  6198
  6199     IF NOT PI-ISS-LIVES-KEYED
  6200         MOVE AL-UANOF           TO BLIVES-ATTRB.
  6201
  6202     IF NOT PI-SSNUM-KEYED
  6203         MOVE AL-UANOF           TO BSSNUM-ATTRB.
  6204
  6205     IF NOT PI-MEMBER-KEYED
  6206         MOVE AL-UANOF           TO BMEM-NO-ATTRB.
  6207
  6208     IF NOT PI-MODE-KEYED
  6209         MOVE AL-UANOF           TO BMODE-ATTRB.
  6210
  6211     IF NOT PI-PMTS-KEYED
  6212         MOVE AL-UANOF           TO BPMTS-ATTRB.
  6213
  6214     IF NOT PI-LN-OFFICER-KEYED
  6215         MOVE AL-UANOF           TO BLN-OFFICER-ATTRB.
  6216
  6217     IF NOT PI-ENTRY-KEYED
  6218         MOVE AL-UANOF           TO BENTRY-ATTRB.
  6219
  6220*    IF NOT PI-ZIP4-KEYED
  6221*        MOVE AL-UANOF           TO BZIP4-ATTRB.
  6222
  6223     IF NOT PI-POLICY-KEYED
  6224         MOVE AL-UANOF           TO BPOLICY-ATTRB.
  6225
  6226     IF NOT PI-RINCD-KEYED
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL9301.cbl
  6227         MOVE AL-UANOF           TO BRINCD-ATTRB.
  6228
  6229     IF NOT PI-RTCLS-KEYED
  6230         MOVE AL-UANOF           TO BRTCLS-ATTRB.
  6231
  6232
  6233     IF NOT PI-LNTRM-KEYED
  6234         MOVE AL-UANOF           TO BLN-TERM-ATTRB.
  6235
  6236
  6237     IF NOT PI-EXPIRE-KEYED
  6238         MOVE AL-UANOF           TO BEXPIRE-ATTRB (1)
  6239                                    BEXPIRE-ATTRB (2).
  6240
  6241     IF NOT PI-CRIT-PERD-KEYED
  6242         MOVE AL-UANOF           TO BCRIT-PERD-ATTRB (1)
  6243         MOVE AL-UANOF           TO BCRIT-PERD-ATTRB (2).
  6244
  6245     IF NOT PI-PMT-KEYED
  6246         MOVE AL-UANOF           TO BPMT-ATTRB.
  6247
  6248     IF NOT PI-SKPCD-KEYED
  6249         MOVE AL-UANOF           TO BSKPCD-ATTRB.
  6250
  6251     IF PI-BIRTH-DATE-IS-INPUT
  6252         MOVE AL-UANOF           TO BAGE-ATTRB
  6253     ELSE
  6254         MOVE AL-UANOF           TO BBIRTH-ATTRB.
  6255
  6256     IF NOT PI-JNT-AGE-KEYED
  6257         MOVE AL-UANOF           TO BJNT-AGE-ATTRB.
  6258
  6259     IF NOT PI-JNT-NAME-KEYED
  6260         MOVE AL-UANOF           TO BJNT-INIT-ATTRB
  6261                                    BJNT-LST-NAME-ATTRB
  6262                                    BJNT-1ST-NAME-ATTRB.
  6263
  6264     IF NOT PI-BENEFICIARY-KEYED
  6265         MOVE AL-UANOF           TO BBENEFICIARY-ATTRB.
  6266
  6267     IF NOT PI-PHONE-KEYED
  6268         MOVE AL-UANOF           TO BPHONE-ATTRB.
  6269
  6270     IF NOT PI-ALT-BEN-KEYED
  6271         MOVE AL-UANOF           TO BALT-BEN-ATTRB (1).
  6272
  6273     IF NOT PI-ALT-PREM-KEYED
  6274         MOVE AL-UANOF           TO BALT-PREM-ATTRB (1).
  6275
  6276 0610-EXIT.
  6277
  6278     EXIT.
  6279
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL9301.cbl
  6281
  6282******************************************************************
  6283*                                                                *
  6284*         P R O T E C T   C A N C E L   F I E L D S              *
  6285*                                                                *
  6286******************************************************************
  6287
  6288 0700-PROTECT-FIELDS.
  6289
  6290     IF NOT PI-CAN-SUFFIX-KEYED
  6291         MOVE AL-SANOF           TO CSFX-ATTRB (1)
  6292                                    CSFX-ATTRB (2)
  6293                                    CSFX-ATTRB (3)
  6294                                    CSFX-ATTRB (4).
  6295
  6296     IF NOT PI-CAN-LIVES-KEYED
  6297         MOVE AL-SANOF           TO CLIVES-ATTRB (1)
  6298                                    CLIVES-ATTRB (2)
  6299                                    CLIVES-ATTRB (3)
  6300                                    CLIVES-ATTRB (4).
  6301     IF NOT PI-PAYEE-KEYED
  6302         MOVE AL-SANOF           TO CPAYEE-ATTRB (1)
  6303                                    CPAYEE-ATTRB (2)
  6304                                    CPAYEE-ATTRB (3)
  6305                                    CPAYEE-ATTRB (4).
  6306     IF NOT PI-CHK-REQ-KEYED
  6307         MOVE AL-SANOF           TO CCHK-ATTRB   (1)
  6308                                    CCHK-ATTRB   (2)
  6309                                    CCHK-ATTRB   (3)
  6310                                    CCHK-ATTRB   (4).
  6311 0700-EXIT.
  6312     EXIT.
  6313
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL9301.cbl
  6315
  6316******************************************************************
  6317*                                                                *
  6318*         U N P R O T E C T   C A N C E L   F I E L D S          *
  6319*                                                                *
  6320******************************************************************
  6321
  6322 0710-UNPROTECT-FIELDS.
  6323
  6324     IF NOT PI-CAN-SUFFIX-KEYED
  6325         MOVE AL-UANOF           TO CSFX-ATTRB (1)
  6326                                    CSFX-ATTRB (2)
  6327                                    CSFX-ATTRB (3)
  6328                                    CSFX-ATTRB (4).
  6329
  6330     IF NOT PI-CAN-LIVES-KEYED
  6331         MOVE AL-UANOF           TO CLIVES-ATTRB (1)
  6332                                    CLIVES-ATTRB (2)
  6333                                    CLIVES-ATTRB (3)
  6334                                    CLIVES-ATTRB (4).
  6335     IF NOT PI-PAYEE-KEYED
  6336         MOVE AL-UANOF           TO CPAYEE-ATTRB (1)
  6337                                    CPAYEE-ATTRB (2)
  6338                                    CPAYEE-ATTRB (3)
  6339                                    CPAYEE-ATTRB (4).
  6340     IF NOT PI-CHK-REQ-KEYED
  6341         MOVE AL-UANOF           TO CCHK-ATTRB   (1)
  6342                                    CCHK-ATTRB   (2)
  6343                                    CCHK-ATTRB   (3)
  6344                                    CCHK-ATTRB   (4).
  6345 0710-EXIT.
  6346     EXIT.
  6347
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL9301.cbl
  6349
  6350******************************************************************
  6351*                                                                *
  6352*     E D I T   D A T A   E N T R Y   I S S U E    S C R E EN    *
  6353*                                                                *
  6354******************************************************************
  6355
  6356 1000-EDIT-MAPB.
  6357
  6358     IF PI-MAP-NAME NOT = EL930B
  6359         GO TO 1100-EDIT-MAPC.
  6360
  6361     IF PI-LAST-FUNC-DISPLAY
  6362       AND BSFX-LEN           = ZEROS
  6363       AND B1ST-NAME-LEN      = ZEROS
  6364       AND BLAST-NAME-LEN     = ZEROS
  6365       AND BINIT-LEN          = ZEROS
  6366       AND BJNT-1ST-NAME-LEN  = ZEROS
  6367       AND BJNT-INIT-LEN      = ZEROS
  6368       AND BJNT-LST-NAME-LEN  = ZEROS
  6369       AND BSEX-LEN           = ZEROS
  6370       AND BAGE-LEN           = ZEROS
  6371       AND BSSNUM-LEN         = ZEROS
  6372       AND BIND-GRP-LEN       = ZEROS
  6373       AND BAPR-LEN           = ZEROS
  6374       AND BFREQ-LEN          = ZEROS
  6375       AND BSIG-LEN           = ZEROS
  6376       AND BTERM-LEN     (1)  = ZEROS
  6377       AND BTERM-LEN     (2)  = ZEROS
  6378       AND BTYPE-LEN     (1)  = ZEROS
  6379       AND BTYPE-LEN     (2)  = ZEROS
  6380       AND BBEN-LEN      (1)  = ZEROS
  6381       AND BBEN-LEN      (2)  = ZEROS
  6382       AND BALT-BEN-LEN  (1)  = ZEROS
  6383       AND BPREM-LEN     (1)  = ZEROS
  6384       AND BPREM-LEN     (2)  = ZEROS
  6385       AND BALT-PREM-LEN (1)  = ZEROS
  6386       AND BLIVES-LEN         = ZEROS
  6387       AND BPOLICY-LEN        = ZEROS
  6388       AND BENTRY-LEN         = ZEROS
  6389       AND BRINCD-LEN         = ZEROS
  6390       AND BSSNUM-LEN         = ZEROS
  6391       AND BMEM-NO-LEN        = ZEROS
  6392       AND BJNT-AGE-LEN       = ZEROS
  6393       AND BBENEFICIARY-LEN   = ZEROS
  6394       AND BBIRTH-LEN         = ZEROS
  6395       AND BMODE-LEN          = ZEROS
  6396       AND BPMTS-LEN          = ZEROS
  6397       AND BLN-OFFICER-LEN    = ZEROS
  6398       AND BDAYS-LEN          = ZEROS
  6399       AND BLN-TERM-LEN       = ZEROS
  6400       AND BEXPIRE-LEN (1)    = ZEROS
  6401       AND BEXPIRE-LEN (2)    = ZEROS
  6402       AND BPMT-LEN           = ZEROS
  6403       AND B1ST-PMT-LEN       = ZEROS
  6404       AND BSKPCD-LEN         = ZEROS
  6405       AND BADDRS1-LEN        = ZEROS
  6406       AND BADDRS2-LEN        = ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL9301.cbl
  6407       AND BCITYST-LEN        = ZEROS
  6408       AND BZIP5-LEN          = ZEROS
  6409       AND BAGE-LEN           = ZEROS
  6410       AND BZIP4-LEN          = ZEROS
  6411       AND BPHONE-LEN         = ZEROS
  6412         MOVE SPACE              TO PI-DISPLAY-SW
  6413         GO TO 1030-NOTHING-TO-EDIT.
  6414
  6415 1010-EDIT-MAPB.
  6416
  6417     IF BCERT-LEN             = ZEROS
  6418       AND BLAST-NAME-LEN     = ZEROS
  6419       AND BEFFDT-LEN         = ZEROS
  6420       AND NOT PI-LAST-FUNC-DISPLAY
  6421         GO TO 1030-NOTHING-TO-EDIT.
  6422
  6423     MOVE AL-SABON               TO BSEQ-ATTRB.
  6424
  6425
  6426     IF NOT PI-LAST-FUNC-DISPLAY
  6427        IF BCAR-LEN GREATER THAN ZEROS
  6428           MOVE AL-UANON           TO BCAR-ATTRB
  6429           PERFORM 1500-VERIFY-CARRIER-ID THRU 1590-EXIT
  6430        ELSE
  6431           IF NOT ST-ACCNT-CNTL AND NOT ACCNT-CNTL
  6432               MOVE -1             TO BCAR-LEN
  6433               MOVE AL-UABON       TO BCAR-ATTRB
  6434               MOVE ER-0194        TO EMI-ERROR
  6435               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6436
  6437     IF NOT PI-LAST-FUNC-DISPLAY
  6438        IF BGRP-LEN GREATER THAN ZEROS
  6439           MOVE AL-UANON           TO BGRP-ATTRB
  6440        ELSE
  6441           IF CARR-GROUP-ST-ACCNT-CNTL
  6442               MOVE -1 TO          BGRP-LEN
  6443               MOVE AL-UABON       TO BGRP-ATTRB
  6444               MOVE ER-0195        TO EMI-ERROR
  6445               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6446
  6447     IF NOT PI-LAST-FUNC-DISPLAY
  6448       IF BST-LEN GREATER THAN ZEROS
  6449           MOVE AL-UANON           TO BST-ATTRB
  6450           PERFORM 1600-VERIFY-STATE-ID THRU 1690-EXIT
  6451       ELSE
  6452           IF NOT ACCNT-CNTL AND NOT CARR-ACCNT-CNTL
  6453               MOVE -1             TO BST-LEN
  6454               MOVE AL-UABON       TO BST-ATTRB
  6455               MOVE ER-0196        TO EMI-ERROR
  6456               PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6457
  6458     IF NOT PI-LAST-FUNC-DISPLAY
  6459        IF BACCT-LEN GREATER THAN ZEROS
  6460           MOVE AL-UANON           TO BACCT-ATTRB
  6461           PERFORM 1700-VERIFY-ACCOUNT THRU 1790-EXIT
  6462        ELSE
  6463           MOVE -1 TO BACCT-LEN
  6464           MOVE AL-UABON           TO BACCT-ATTRB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL9301.cbl
  6465           MOVE ER-0197            TO EMI-ERROR
  6466           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6467
  6468     IF BCERT-LEN  GREATER THAN ZEROS
  6469       AND PI-LAST-FUNC-DISPLAY
  6470         NEXT SENTENCE
  6471     ELSE
  6472         IF BCERT-LEN  GREATER THAN ZEROS
  6473             MOVE AL-UANON       TO BCERT-ATTRB
  6474         ELSE
  6475             MOVE -1             TO BCERT-LEN
  6476             MOVE ER-2218        TO EMI-ERROR
  6477             MOVE AL-UABON       TO BCERT-ATTRB
  6478             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6479
  6480     IF BSFX-LEN  NOT = ZEROS
  6481         MOVE 'Y'                TO PI-ISS-SUFFIX-KEYED-SW
  6482         MOVE AL-UANON           TO BSFX-ATTRB.
  6483
  6484     IF BEFFDT-LEN  = ZEROS
  6485       AND PI-LAST-FUNC-DISPLAY
  6486         NEXT SENTENCE
  6487     ELSE
  6488         IF BEFFDT-LEN   GREATER THAN ZEROS
  6489             MOVE AL-UNNON           TO BEFFDT-ATTRB
  6490             IF BEFFDT   NUMERIC
  6491                 MOVE 4              TO DC-OPTION-CODE
  6492                 MOVE BEFFDT    TO DC-GREG-DATE-1-MDY
  6493                 PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  6494                 MOVE DC-BIN-DATE-1  TO WS-CONVERTED-EFFDT
  6495                 IF NO-CONVERSION-ERROR
  6496                     IF WS-CONVERTED-EFFDT NOT LESS THAN
  6497                       PI-ACCT-LOW-EFF-DT  AND LESS THAN
  6498                       PI-ACCT-HIGH-EXP-DT
  6499                         NEXT SENTENCE
  6500                     ELSE
  6501                         MOVE -1       TO BEFFDT-LEN
  6502                         MOVE ER-2589  TO EMI-ERROR
  6503                         MOVE AL-UNBON TO BEFFDT-ATTRB
  6504                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6505                 ELSE
  6506                     MOVE -1         TO BEFFDT-LEN
  6507                     MOVE ER-2226    TO EMI-ERROR
  6508                     MOVE AL-UNBON   TO BEFFDT-ATTRB
  6509                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6510             ELSE
  6511                 MOVE -1             TO BEFFDT-LEN
  6512                 MOVE ER-2223        TO EMI-ERROR
  6513                 MOVE AL-UNBON       TO BEFFDT-ATTRB
  6514                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6515         ELSE
  6516             MOVE -1                 TO BEFFDT-LEN
  6517             MOVE ER-2220            TO EMI-ERROR
  6518             MOVE AL-UNBON           TO BEFFDT-ATTRB
  6519             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6520
  6521     IF BLAST-NAME-LEN   GREATER THAN ZEROS
  6522         MOVE AL-UANON           TO BLAST-NAME-ATTRB.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL9301.cbl
  6523
  6524     IF B1ST-NAME-LEN    GREATER THAN ZEROS
  6525         MOVE AL-UANON           TO B1ST-NAME-ATTRB.
  6526
  6527     IF BINIT-LEN        GREATER THAN ZEROS
  6528         MOVE AL-UANON           TO BINIT-ATTRB.
  6529
  6530     IF BSEX-LEN         GREATER THAN ZEROS
  6531         IF BSEX   = 'M' OR 'F'
  6532             MOVE AL-UANON       TO BSEX-ATTRB
  6533         ELSE
  6534             MOVE -1             TO BSEX-LEN
  6535             MOVE ER-2629        TO EMI-ERROR
  6536             MOVE AL-UABON       TO BSEX-ATTRB
  6537             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6538
  6539     IF BAGE-LEN        GREATER THAN ZEROS
  6540        IF BAGE NUMERIC
  6541           MOVE BAGE             TO WS-BAGE
  6542           MOVE AL-UNNON         TO BAGE-ATTRB
  6543        ELSE
  6544           MOVE -1             TO BAGE-LEN
  6545           MOVE ER-2223        TO EMI-ERROR
  6546           MOVE AL-UNBON       TO BAGE-ATTRB
  6547           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6548
  6549
  6550     IF BSSNUM-LEN          GREATER THAN ZEROS
  6551         MOVE 'Y'                TO PI-SSNUM-KEYED-SW
  6552         MOVE AL-UANON           TO BSSNUM-ATTRB.
  6553
  6554     MOVE +0                     TO WS-SUB1.
  6555
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL9301.cbl
  6557
  6558******************************************************************
  6559*                                                                *
  6560*           E D I T   I S S U E   C O V E R A G E S              *
  6561*                                                                *
  6562******************************************************************
  6563
  6564 1020-EDIT-COVERAGES.
  6565
  6566     IF NOT MODIFY-CAP
  6567           MOVE 'UPDATE'       TO SM-READ
  6568           PERFORM 9995-SECURITY-VIOLATION
  6569           MOVE ER-0070        TO EMI-ERROR
  6570           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6571           GO TO 8100-SEND-INITIAL-MAP.
  6572
  6573     ADD +1                      TO WS-SUB1.
  6574
  6575     IF WS-SUB1 GREATER THAN +2
  6576        GO TO 1025-CONT-EDIT.
  6577
  6578     IF BTYPE-LEN          (WS-SUB1)  GREATER THAN ZEROS
  6579        OR  BTERM-LEN      (WS-SUB1)  GREATER THAN ZEROS
  6580        OR  BBEN-LEN       (WS-SUB1)  GREATER THAN ZEROS
  6581        OR  BPREM-LEN      (WS-SUB1)  GREATER THAN ZEROS
  6582        OR  BCRIT-PERD-LEN (WS-SUB1)  GREATER THAN ZEROS
  6583        OR  BEXPIRE-LEN    (WS-SUB1)  GREATER THAN ZEROS
  6584        OR  BALT-PREM-LEN  (WS-SUB1)  GREATER THAN ZEROS
  6585        OR  BALT-BEN-LEN   (WS-SUB1)  GREATER THAN ZEROS
  6586            MOVE 'Y'             TO WS-DATA-KEYED-SW
  6587     ELSE
  6588            GO TO 1020-EDIT-COVERAGES.
  6589
  6590     IF NOT PI-LAST-FUNC-DISPLAY
  6591        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  6592             MOVE AL-UANON         TO BTYPE-ATTRB       (WS-SUB1)
  6593             PERFORM 1040-EDIT-INPUT-CODE THRU 1059-EXIT
  6594        ELSE
  6595           NEXT SENTENCE
  6596     ELSE
  6597        IF BTYPE-LEN  (WS-SUB1) GREATER THAN ZEROS
  6598           IF BTYPE   (WS-SUB1) = SPACES OR ZEROS
  6599              MOVE AL-UANON      TO BTYPE-ATTRB       (WS-SUB1)
  6600           ELSE
  6601              MOVE AL-UANON      TO BTYPE-ATTRB       (WS-SUB1)
  6602              PERFORM 1040-EDIT-INPUT-CODE THRU 1059-EXIT.
  6603
  6604     IF BPMTS-LEN           GREATER THAN ZEROS
  6605         MOVE 'Y'                TO PI-PMTS-KEYED-SW
  6606         MOVE BPMTS-IN           TO DEEDIT-FIELD
  6607         PERFORM 8600-DEEDIT
  6608         IF DEEDIT-FIELD-V0 NUMERIC
  6609            MOVE DEEDIT-FIELD-V0 TO WS-BPMTS
  6610            MOVE AL-UNNON        TO BPMTS-ATTRB.
  6611
  6612     IF BPMT-LEN              GREATER THAN ZEROS
  6613         MOVE 'Y'                TO PI-PMT-KEYED-SW
  6614         MOVE BPMTI              TO DEEDIT-FIELD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 130
* EL9301.cbl
  6615         PERFORM 8600-DEEDIT
  6616         IF DEEDIT-FIELD-V2     NUMERIC
  6617           MOVE DEEDIT-FIELD-V2 TO WS-BPMT
  6618           MOVE AL-UNNON           TO BPMT-ATTRB.
  6619
  6620     IF BTERM-LEN (WS-SUB1) GREATER THAN ZEROS
  6621        NEXT SENTENCE
  6622     ELSE
  6623        IF BLN-TERM-LEN GREATER THAN ZERO
  6624           AND WS-BLN-TERM NUMERIC
  6625           MOVE WS-BLN-TERM      TO BTERMI      (WS-SUB1)
  6626           MOVE +3               TO BTERM-LEN   (WS-SUB1).
  6627
  6628     IF  WS-TERM-IN-DAYS-FOUND
  6629         AND BMODE-LEN   GREATER THAN ZERO
  6630         PERFORM 1090-CALCULATE-MONTHLY-TERM THRU 1094-EXIT
  6631     ELSE
  6632         IF BMODE-LEN   GREATER THAN ZEROS
  6633            AND BPMTS-LEN   GREATER THAN ZEROS
  6634            PERFORM 1080-TERM-CONVERSION THRU 1089-EXIT.
  6635
  6636     IF PI-LAST-FUNC-DISPLAY
  6637        IF BTERM-LEN (WS-SUB1)  = ZEROS
  6638           NEXT SENTENCE
  6639        ELSE
  6640           MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  6641           PERFORM 8600-DEEDIT
  6642           IF DEEDIT-FIELD-V0 NUMERIC
  6643              MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  6644              IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  6645                    MOVE AL-UNNON     TO BTERM-ATTRB (WS-SUB1)
  6646              ELSE
  6647                    MOVE ER-2241      TO EMI-ERROR
  6648                    MOVE -1           TO BTERM-LEN   (WS-SUB1)
  6649                    MOVE AL-UNBOF     TO BTERM-ATTRB (WS-SUB1)
  6650                    PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6651           ELSE
  6652              MOVE ER-2223          TO EMI-ERROR
  6653              MOVE -1               TO BTERM-LEN   (WS-SUB1)
  6654              MOVE AL-UNBON         TO BTERM-ATTRB (WS-SUB1)
  6655              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6656     ELSE
  6657        IF  BTERM-LEN      (WS-SUB1)   GREATER THAN ZEROS
  6658            MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD
  6659            PERFORM 8600-DEEDIT
  6660            IF DEEDIT-FIELD-V0      NUMERIC
  6661               IF DEEDIT-FIELD-V0     GREATER THAN ZERO
  6662                  MOVE DEEDIT-FIELD-V0 TO WS-BTERM    (WS-SUB1)
  6663                  MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  6664               ELSE
  6665                  MOVE ER-2241         TO EMI-ERROR
  6666                  MOVE -1              TO BTERM-LEN   (WS-SUB1)
  6667                  MOVE AL-UNBOF        TO BTERM-ATTRB (WS-SUB1)
  6668                  PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6669            ELSE
  6670              MOVE ER-2223             TO EMI-ERROR
  6671              MOVE -1                  TO BTERM-LEN   (WS-SUB1)
  6672              MOVE AL-UNBON            TO BTERM-ATTRB (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 131
* EL9301.cbl
  6673              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6674        ELSE
  6675            MOVE ER-2240               TO EMI-ERROR
  6676            MOVE -1                    TO BTERM-LEN   (WS-SUB1)
  6677            MOVE AL-UNBOF              TO BTERM-ATTRB (WS-SUB1)
  6678            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6679
  6680     IF BBEN-LEN (WS-SUB1) = ZEROS
  6681        AND PI-LAST-FUNC-DISPLAY
  6682           NEXT SENTENCE
  6683     ELSE
  6684        IF BBEN-LEN (WS-SUB1) GREATER THAN ZEROS
  6685           MOVE AL-UNNON           TO BBEN-ATTRB (WS-SUB1)
  6686           MOVE BBENI (WS-SUB1)    TO DEEDIT-FIELD
  6687           PERFORM 8600-DEEDIT
  6688           IF DEEDIT-FIELD-V2  NUMERIC
  6689              IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  6690                 MOVE DEEDIT-FIELD-V2 TO WS-BBEN    (WS-SUB1)
  6691              ELSE
  6692                 MOVE ER-7632    TO EMI-ERROR
  6693                 MOVE -1         TO BBEN-LEN   (WS-SUB1)
  6694                 MOVE AL-UNBOF   TO BBEN-ATTRB (WS-SUB1)
  6695                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6696           ELSE
  6697              MOVE ER-2223         TO EMI-ERROR
  6698              MOVE AL-UNBON        TO BBEN-ATTRB (WS-SUB1)
  6699              MOVE -1              TO BBEN-LEN   (WS-SUB1)
  6700        ELSE
  6701           MOVE ER-7632    TO EMI-ERROR
  6702           MOVE -1         TO BBEN-LEN   (WS-SUB1)
  6703           MOVE AL-UNBOF   TO BBEN-ATTRB (WS-SUB1)
  6704           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6705
  6706     IF BPREM-LEN    (WS-SUB1) = ZEROS
  6707        AND PI-LAST-FUNC-DISPLAY
  6708           NEXT SENTENCE
  6709     ELSE
  6710        IF BPREM-LEN (WS-SUB1) GREATER THAN ZEROS
  6711           MOVE AL-UNNON           TO BPREM-ATTRB (WS-SUB1)
  6712           MOVE BPREMI (WS-SUB1)   TO DEEDIT-FIELD
  6713           PERFORM 8600-DEEDIT
  6714           IF DEEDIT-FIELD-V2  NUMERIC
  6715              IF DEEDIT-FIELD-V2 GREATER THAN ZEROS
  6716                 MOVE DEEDIT-FIELD-V2 TO WS-BPREM   (WS-SUB1)
  6717              ELSE
  6718                 MOVE ER-7633    TO EMI-ERROR
  6719                 MOVE -1         TO BPREM-LEN   (WS-SUB1)
  6720                 MOVE AL-UNBOF   TO BPREM-ATTRB (WS-SUB1)
  6721                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6722           ELSE
  6723              MOVE AL-UNBON   TO BPREM-ATTRB (WS-SUB1)
  6724              MOVE ER-2223         TO EMI-ERROR
  6725              MOVE -1              TO BPREM-LEN  (WS-SUB1)
  6726        ELSE
  6727           MOVE ER-7633    TO EMI-ERROR
  6728           MOVE -1         TO BPREM-LEN   (WS-SUB1)
  6729           MOVE AL-UNBOF   TO BPREM-ATTRB (WS-SUB1)
  6730           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 132
* EL9301.cbl
  6731
  6732     IF BEXPIRE-LEN (WS-SUB1)   GREATER THAN ZEROS
  6733        MOVE 'Y'                 TO PI-EXPIRE-KEYED-SW
  6734         IF BEXPIRE (WS-SUB1)    NUMERIC
  6735             MOVE AL-UNNON       TO BEXPIRE-ATTRB (WS-SUB1)
  6736             MOVE 4              TO DC-OPTION-CODE
  6737             MOVE BEXPIRE (WS-SUB1)   TO DC-GREG-DATE-1-MDY
  6738             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  6739             MOVE DC-BIN-DATE-1  TO WS-CONVERTED-EXPIRDT (WS-SUB1)
  6740             IF NO-CONVERSION-ERROR
  6741                 NEXT SENTENCE
  6742             ELSE
  6743                 MOVE -1         TO BEXPIRE-LEN   (WS-SUB1)
  6744                 MOVE ER-2531    TO EMI-ERROR
  6745                 MOVE AL-UNBON   TO BEXPIRE-ATTRB (WS-SUB1)
  6746                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6747         ELSE
  6748             MOVE -1             TO BEXPIRE-LEN   (WS-SUB1)
  6749             MOVE ER-2532        TO EMI-ERROR
  6750             MOVE AL-UNBON       TO BEXPIRE-ATTRB (WS-SUB1)
  6751             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6752
  6753     IF BCRIT-PERD-LEN  (WS-SUB1)    GREATER THAN ZEROS
  6754        MOVE 'Y'                     TO PI-CRIT-PERD-KEYED-SW
  6755        MOVE BCRIT-PERDI (WS-SUB1)   TO DEEDIT-FIELD
  6756        PERFORM 8600-DEEDIT
  6757        IF DEEDIT-FIELD-V0 NUMERIC
  6758           MOVE DEEDIT-FIELD-V0      TO WS-BCRIT-PERD    (WS-SUB1)
  6759           MOVE AL-UNNON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  6760         ELSE
  6761           MOVE -1                   TO BCRIT-PERD-LEN   (WS-SUB1)
  6762           MOVE AL-UNBON             TO BCRIT-PERD-ATTRB (WS-SUB1)
  6763           MOVE ER-2223              TO EMI-ERROR
  6764           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6765
  6766
  6767     IF BALT-BEN-LEN (WS-SUB1) = ZEROS
  6768        AND PI-LAST-FUNC-DISPLAY
  6769           NEXT SENTENCE
  6770     ELSE
  6771        IF BALT-BEN-LEN (WS-SUB1) GREATER THAN ZEROS
  6772           MOVE 'Y'              TO PI-ALT-BEN-KEYED-SW
  6773           MOVE AL-UNNON         TO BALT-BEN-ATTRB (WS-SUB1)
  6774           MOVE BALT-BENI (WS-SUB1)    TO DEEDIT-FIELD
  6775           PERFORM 8600-DEEDIT
  6776           IF DEEDIT-FIELD-V2  NUMERIC
  6777              MOVE DEEDIT-FIELD-V2 TO WS-BALT-BEN (WS-SUB1)
  6778           ELSE
  6779              MOVE ER-2223       TO EMI-ERROR
  6780              MOVE AL-UNBON      TO BALT-BEN-ATTRB (WS-SUB1)
  6781              MOVE -1            TO BALT-BEN-LEN   (WS-SUB1).
  6782
  6783     IF BALT-PREM-LEN    (WS-SUB1) = ZEROS
  6784        AND PI-LAST-FUNC-DISPLAY
  6785           NEXT SENTENCE
  6786     ELSE
  6787        IF BALT-PREM-LEN   (WS-SUB1) GREATER THAN ZEROS
  6788           MOVE 'Y'              TO PI-ALT-PREM-KEYED-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 133
* EL9301.cbl
  6789           MOVE AL-UNNON              TO BALT-PREM-ATTRB (WS-SUB1)
  6790           MOVE BALT-PREMI (WS-SUB1)  TO DEEDIT-FIELD
  6791           PERFORM 8600-DEEDIT
  6792           IF DEEDIT-FIELD-V2  NUMERIC
  6793              MOVE DEEDIT-FIELD-V2 TO WS-BALT-PREM   (WS-SUB1)
  6794           ELSE
  6795              MOVE AL-UNBON      TO BALT-PREM-ATTRB (WS-SUB1)
  6796              MOVE ER-2223       TO EMI-ERROR
  6797              MOVE -1            TO BALT-PREM-LEN  (WS-SUB1).
  6798
  6799     GO TO 1020-EDIT-COVERAGES.
  6800
  6801 1025-CONT-EDIT.
  6802
  6803     IF BLIVES-LEN               GREATER THAN ZEROS
  6804        MOVE 'Y'                   TO PI-ISS-LIVES-KEYED-SW
  6805        MOVE BLIVESI               TO DEEDIT-FIELD
  6806        PERFORM 8600-DEEDIT
  6807        IF DEEDIT-FIELD-V0 NUMERIC
  6808           MOVE DEEDIT-FIELD-V0    TO WS-BLIVES
  6809           MOVE AL-UNNON           TO BLIVES-ATTRB
  6810        ELSE
  6811           MOVE -1                 TO BLIVES-LEN
  6812           MOVE AL-UNBON           TO BLIVES-ATTRB
  6813           MOVE ER-2223            TO EMI-ERROR
  6814           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6815
  6816     IF BJNT-1ST-NAME-LEN     GREATER THAN ZEROS OR
  6817        BJNT-INIT-LEN         GREATER THAN ZEROS OR
  6818        BJNT-LST-NAME-LEN     GREATER THAN ZEROS
  6819         MOVE 'Y'                TO PI-JNT-NAME-KEYED-SW
  6820         MOVE AL-UANON           TO BJNT-1ST-NAME-ATTRB
  6821                                    BJNT-INIT-ATTRB
  6822                                    BJNT-LST-NAME-ATTRB.
  6823
  6824     IF BJNT-AGE-LEN        GREATER THAN ZEROS
  6825        MOVE 'Y'                 TO PI-JNT-AGE-KEYED-SW
  6826        IF BJNT-AGE NUMERIC
  6827           MOVE BJNT-AGE         TO WS-BJNT-AGE
  6828           MOVE AL-UNNON         TO BJNT-AGE-ATTRB
  6829        ELSE
  6830           MOVE -1             TO BJNT-AGE-LEN
  6831           MOVE ER-2223        TO EMI-ERROR
  6832           MOVE AL-UNBON       TO BJNT-AGE-ATTRB
  6833           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6834
  6835     IF BBENEFICIARY-LEN    GREATER THAN ZEROS
  6836         MOVE 'Y'                TO PI-BENEFICIARY-KEYED-SW
  6837         MOVE AL-UANON           TO BBENEFICIARY-ATTRB.
  6838
  6839     IF B1ST-PMT-LEN GREATER THAN ZEROS
  6840        MOVE 'Y'                     TO PI-1ST-PMT-KEYED-SW
  6841        IF B1ST-PMT = SPACES
  6842           MOVE LOW-VALUES           TO WS-CONVERTED-1ST-PMT-DT
  6843        ELSE
  6844           MOVE B1ST-PMT             TO DEEDIT-FIELD
  6845           PERFORM 8600-DEEDIT
  6846           MOVE DEEDIT-FIELD-V0      TO DC-GREG-DATE-1-MDY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 134
* EL9301.cbl
  6847           MOVE AL-UNNON             TO B1ST-PMT-ATTRB
  6848           MOVE 4                    TO DC-OPTION-CODE
  6849           PERFORM 8500-DATE-CONVERT
  6850           IF NO-CONVERSION-ERROR
  6851              MOVE DC-BIN-DATE-1     TO WS-CONVERTED-1ST-PMT-DT
  6852              MOVE AL-UANON          TO B1ST-PMT-ATTRB
  6853           ELSE
  6854              MOVE -1                TO B1ST-PMT-LEN
  6855              MOVE ER-2200           TO EMI-ERROR
  6856              MOVE AL-UNBON          TO B1ST-PMT-ATTRB
  6857              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6858
  6859     IF BDAYS-LEN       GREATER THAN ZEROS
  6860        MOVE 'Y'                TO PI-DAYS-KEYED-SW
  6861        MOVE BDAYSI             TO DEEDIT-FIELD
  6862        PERFORM 8600-DEEDIT
  6863        IF DEEDIT-FIELD-V0 NUMERIC
  6864           MOVE DEEDIT-FIELD-V0  TO WS-BDAYS
  6865           MOVE AL-UNNON        TO BDAYS-ATTRB
  6866        ELSE
  6867           MOVE -1              TO BDAYS-LEN
  6868           MOVE ER-7530         TO EMI-ERROR
  6869           MOVE AL-UNBON        TO BDAYS-ATTRB
  6870           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6871
  6872     IF BLN-TERM-LEN   = ZEROS
  6873         NEXT SENTENCE
  6874     ELSE
  6875        MOVE 'Y'                 TO PI-LNTRM-KEYED-SW
  6876        MOVE BLN-TERMI           TO DEEDIT-FIELD
  6877        PERFORM 8600-DEEDIT
  6878        IF DEEDIT-FIELD-V0 NUMERIC
  6879           MOVE DEEDIT-FIELD-V0  TO WS-BLN-TERM
  6880           IF WS-BLN-TERM  GREATER THAN ZERO
  6881              MOVE AL-UNNON TO BLN-TERM-ATTRB
  6882                 ELSE
  6883                     MOVE ER-2241  TO EMI-ERROR
  6884                     MOVE -1       TO BLN-TERM-LEN
  6885                     MOVE AL-UNBOF TO BLN-TERM-ATTRB
  6886                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6887             ELSE
  6888                 MOVE ER-2223      TO EMI-ERROR
  6889                 MOVE -1           TO BLN-TERM-LEN
  6890                 MOVE AL-UNBON     TO BLN-TERM-ATTRB
  6891                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6892
  6893     IF BLN-OFFICER-LEN      GREATER THAN ZEROS
  6894         MOVE 'Y'                TO PI-LN-OFFICER-KEYED-SW
  6895         MOVE AL-UANON           TO BLN-OFFICER-ATTRB.
  6896
  6897     IF BMODE-LEN            GREATER THAN ZEROS
  6898         MOVE BMODE              TO WS-MODE-CODE
  6899         MOVE 'Y'                TO PI-MODE-KEYED-SW
  6900         IF WS-MODE-CODE-VALID
  6901             MOVE AL-UANON       TO BMODE-ATTRB
  6902         ELSE
  6903             MOVE -1             TO BMODE-LEN
  6904             MOVE ER-2591        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 135
* EL9301.cbl
  6905             MOVE AL-UABON       TO BMODE-ATTRB
  6906             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6907
  6908     IF BFREQ-LEN             GREATER THAN ZEROS
  6909        MOVE 'Y'                 TO PI-FREQ-KEYED-SW
  6910        MOVE BFREQI              TO DEEDIT-FIELD
  6911        PERFORM 8600-DEEDIT
  6912        IF DEEDIT-FIELD-V0 NUMERIC
  6913           MOVE DEEDIT-FIELD-V0  TO WS-BFREQ
  6914           MOVE AL-UNNON         TO BFREQ-ATTRB
  6915        ELSE
  6916           MOVE -1             TO BFREQ-LEN
  6917           MOVE ER-2223        TO EMI-ERROR
  6918           MOVE AL-UNBON       TO BFREQ-ATTRB
  6919           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6920
  6921     IF BPMTS-LEN           GREATER THAN ZEROS
  6922         MOVE 'Y'                TO PI-PMTS-KEYED-SW
  6923         MOVE BPMTS-IN           TO DEEDIT-FIELD
  6924         PERFORM 8600-DEEDIT
  6925         IF DEEDIT-FIELD-V0 NUMERIC
  6926            MOVE DEEDIT-FIELD-V0 TO WS-BPMTS
  6927            MOVE AL-UNNON        TO BPMTS-ATTRB
  6928         ELSE
  6929             MOVE -1             TO BPMTS-LEN
  6930             MOVE ER-2592        TO EMI-ERROR
  6931             MOVE AL-UNBON       TO BPMTS-ATTRB
  6932             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6933
  6934     IF BPMT-LEN              GREATER THAN ZEROS
  6935         MOVE 'Y'                TO PI-PMT-KEYED-SW
  6936         MOVE BPMTI              TO DEEDIT-FIELD
  6937         PERFORM 8600-DEEDIT
  6938         IF DEEDIT-FIELD-V2     NUMERIC
  6939           MOVE DEEDIT-FIELD-V2 TO WS-BPMT
  6940           MOVE AL-UNNON           TO BPMT-ATTRB
  6941        ELSE
  6942           MOVE -1                 TO BPMT-LEN
  6943           MOVE ER-2529            TO EMI-ERROR
  6944           MOVE AL-UNBON           TO BPMT-ATTRB
  6945           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6946
  6947     IF BRINCD-LEN              GREATER THAN ZEROS
  6948         MOVE 'Y'                TO PI-RINCD-KEYED-SW
  6949         MOVE AL-UANON           TO BRINCD-ATTRB.
  6950
  6951     IF BENTRY-LEN           GREATER THAN ZEROS
  6952         MOVE 'Y'                TO PI-ENTRY-KEYED-SW
  6953         MOVE BENTRY             TO WS-ENTRY-CODE
  6954         IF WS-ENTRY-CODE-VALID
  6955            MOVE AL-UANON       TO BENTRY-ATTRB
  6956         ELSE
  6957            MOVE ER-7573        TO EMI-ERROR
  6958            MOVE -1             TO BENTRY-LEN
  6959            MOVE AL-UABON       TO BENTRY-ATTRB
  6960            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6961
  6962     IF  BSKPCD-LEN          GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 136
* EL9301.cbl
  6963         MOVE 'Y'                TO PI-SKPCD-KEYED-SW
  6964         MOVE AL-UANON           TO BSKPCD-ATTRB.
  6965
  6966     IF BIND-GRP-LEN        GREATER THAN ZEROS
  6967         MOVE 'Y'                TO PI-IG-KEYED-SW
  6968         MOVE AL-UANON           TO BIND-GRP-ATTRB.
  6969
  6970     IF BSIG-LEN            GREATER THAN ZEROS
  6971         MOVE 'Y'                TO PI-SIG-KEYED-SW
  6972         IF BSIG   = 'Y'
  6973             MOVE AL-UANON       TO BSIG-ATTRB
  6974         ELSE
  6975             MOVE -1             TO BSIG-LEN
  6976             MOVE ER-2651        TO EMI-ERROR
  6977             MOVE AL-UABON       TO BSIG-ATTRB
  6978             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6979
  6980     IF BPOLICY-LEN          GREATER THAN ZEROS
  6981         MOVE 'Y'                TO PI-POLICY-KEYED-SW
  6982         MOVE AL-UANON           TO BPOLICY-ATTRB.
  6983
  6984     IF BRTCLS-LEN           GREATER THAN ZEROS
  6985         MOVE 'Y'                TO PI-RTCLS-KEYED-SW
  6986         MOVE AL-UANON           TO BRTCLS-ATTRB.
  6987
  6988     IF BAPR-LEN            GREATER THAN ZEROS
  6989         MOVE 'Y'                TO PI-APR-KEYED-SW
  6990         MOVE BAPR-IN            TO DEEDIT-FIELD
  6991         PERFORM 8600-DEEDIT
  6992         IF DEEDIT-FIELD-V4  NUMERIC
  6993             MOVE AL-UNNON       TO BAPR-ATTRB
  6994             MOVE DEEDIT-FIELD-V4 TO WS-BAPR
  6995         ELSE
  6996             MOVE ER-2471        TO EMI-ERROR
  6997             MOVE -1             TO BAPR-LEN
  6998             MOVE AL-UNBON       TO BAPR-ATTRB
  6999             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7000
  7001     IF BBIRTH-LEN   GREATER THAN ZEROS
  7002         IF BBIRTH-DT  NUMERIC
  7003             MOVE AL-UNNON       TO BBIRTH-ATTRB
  7004             MOVE 4              TO DC-OPTION-CODE
  7005             MOVE BBIRTH-DT      TO DC-GREG-DATE-1-MDY
  7006             PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7007             MOVE DC-BIN-DATE-1  TO WS-CONVERTED-BIRTH
  7008             IF NO-CONVERSION-ERROR
  7009                 IF BAGE-LEN   = ZERO
  7010                     PERFORM 1095-CALC-AGE THRU 1099-EXIT
  7011                 ELSE
  7012                     NEXT SENTENCE
  7013             ELSE
  7014                 MOVE -1         TO BBIRTH-LEN
  7015                 MOVE ER-2228    TO EMI-ERROR
  7016                 MOVE AL-UNBON   TO BBIRTH-ATTRB
  7017                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7018         ELSE
  7019             MOVE -1             TO BBIRTH-LEN
  7020             MOVE ER-2223        TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 137
* EL9301.cbl
  7021             MOVE AL-UNBON       TO BBIRTH-ATTRB
  7022             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7023     ELSE
  7024         IF PI-LAST-FUNC-DISPLAY
  7025             NEXT SENTENCE
  7026         ELSE
  7027             IF PI-BIRTH-DATE-IS-INPUT
  7028                 MOVE ER-2442    TO EMI-ERROR
  7029                 MOVE -1         TO BBIRTH-LEN
  7030                 MOVE AL-UNBON   TO BBIRTH-ATTRB
  7031                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7032             ELSE
  7033                 MOVE AL-SANOF   TO BBIRTH-ATTRB.
  7034
  7035     IF BMEM-NO-LEN      GREATER THAN ZEROS
  7036         MOVE 'Y'                TO PI-MEMBER-KEYED-SW
  7037         MOVE AL-UANON           TO BMEM-NO-ATTRB.
  7038
  7039     IF  BADDRS1-LEN        GREATER THAN ZEROS
  7040         MOVE AL-UANON           TO BADDRS1-ATTRB.
  7041
  7042     IF  BADDRS2-LEN        GREATER THAN ZEROS
  7043         MOVE AL-UANON           TO BADDRS2-ATTRB.
  7044
  7045     IF  BCITYST-LEN        GREATER THAN ZEROS
  7046         MOVE AL-UANON           TO BCITYST-ATTRB.
  7047
  7048     IF  BZIP5-LEN          GREATER THAN ZEROS
  7049         MOVE AL-UANON           TO BZIP5-ATTRB.
  7050
  7051     IF  BZIP4-LEN          GREATER THAN ZEROS
  7052*        MOVE 'Y'                TO PI-ZIP4-KEYED-SW
  7053         MOVE AL-UANON           TO BZIP4-ATTRB.
  7054
  7055     IF  BPHONE-LEN         GREATER THAN ZERO
  7056         MOVE 'Y'                TO PI-PHONE-KEYED-SW
  7057         MOVE BPHONE             TO DEEDIT-FIELD
  7058         PERFORM 8600-DEEDIT
  7059         MOVE DEEDIT-FIELD-V0 TO WS-BPHONE
  7060         MOVE AL-UANON       TO BPHONE-ATTRB.
  7061
  7062     IF NOT PI-LAST-FUNC-DISPLAY
  7063        AND WS-DATA-NOT-KEYED
  7064        MOVE ER-7400             TO EMI-ERROR
  7065        MOVE -1                  TO BTYPE-LEN (1)
  7066        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7067        MOVE 'Y'                 TO PI-ERROR-SW.
  7068
  7069     IF EMI-ERROR = ZEROS
  7070         MOVE 'Y'                TO PI-UPDATE-SW
  7071         MOVE SPACE              TO PI-DISPLAY-SW
  7072         PERFORM 4000-BUILD-ISSUE-RECORD THRU 4900-EXIT
  7073     ELSE
  7074         MOVE ZEROS              TO EMI-ERROR
  7075         MOVE 'Y'                TO PI-ERROR-SW.
  7076
  7077 1030-NOTHING-TO-EDIT.
  7078
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 138
* EL9301.cbl
  7079     IF PI-DATA-ERRORS
  7080         MOVE AL-SABON           TO BSEQ-ATTRB
  7081         GO TO 8200-SEND-DATAONLY.
  7082
  7083
  7084     IF PI-SAV-BATCH-SEQ LESS THAN PI-LAST-SEQ-NO-ADDED
  7085         SUBTRACT 1 FROM PI-SAV-BATCH-SEQ
  7086         MOVE ER-0000        TO EMI-ERROR
  7087         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7088         GO TO 2000-BROWSE-FWD.
  7089
  7090     MOVE LOW-VALUES     TO DATA-ENTRY-MAP.
  7091     ADD +1, PI-LAST-SEQ-NO-ADDED
  7092                         GIVING PI-NEXT-DISPLAY-SEQ-NO.
  7093     MOVE PI-NEXT-DISPLAY-SEQ-NO TO PI-SAV-BATCH-SEQ.
  7094
  7095     PERFORM 8550-SET-MAP-SEQ-NOS.
  7096
  7097     MOVE ER-0000        TO EMI-ERROR.
  7098     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7099     GO TO 8100-SEND-INITIAL-MAP.
  7100
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 139
* EL9301.cbl
  7102
  7103******************************************************************
  7104*                                                                *
  7105*            E D I T   I N P U T   C O D E S                     *
  7106*                                                                *
  7107******************************************************************
  7108
  7109 1040-EDIT-INPUT-CODE.
  7110
  7111     IF WS-SUB1 = +2
  7112        GO TO 1050-EDIT-INPUT-AH-CODE.
  7113
  7114     MOVE SPACES                 TO ELCNTL-ACCESS.
  7115     MOVE 'L'                    TO ELCNTL-REC-TYPE.
  7116     PERFORM 1070-ELCNTL-READ THRU 1079-EXIT.
  7117
  7118     IF EMI-ERROR = 9999
  7119         GO TO 1048-NO-RECORD.
  7120
  7121     MOVE +1 TO WS-EDIT-SUB.
  7122
  7123 1041-SEARCH-LOOP.
  7124
  7125     IF CF-LIFE-CODE-OUT (WS-EDIT-SUB) = ZEROS
  7126         GO TO 1047-NO-MATCH-FOUND.
  7127
  7128     IF BTYPE (1) = CF-LIFE-CODE-IN (WS-EDIT-SUB)
  7129         MOVE CF-LIFE-CODE-OUT (WS-EDIT-SUB) TO WS-EDITED-LF-CODE
  7130         PERFORM 1060-BENEFIT-MASTER-READ THRU 1069-EXIT
  7131         GO TO 1059-EXIT.
  7132
  7133     ADD 1   TO WS-EDIT-SUB.
  7134
  7135     IF WS-EDIT-SUB GREATER THAN 120
  7136         GO TO 1047-NO-MATCH-FOUND.
  7137     GO TO 1041-SEARCH-LOOP.
  7138
  7139 1047-NO-MATCH-FOUND.
  7140
  7141     MOVE ER-2424                TO EMI-ERROR.
  7142     MOVE AL-UABON               TO BTYPE-ATTRB (1).
  7143     MOVE -1                     TO BTYPE-LEN   (1).
  7144     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7145     MOVE 'Y'                    TO ERROR-SW.
  7146     GO TO 1059-EXIT.
  7147
  7148 1048-NO-RECORD.
  7149
  7150     MOVE ER-2423                TO EMI-ERROR.
  7151     MOVE AL-UABON               TO BTYPE-ATTRB (1).
  7152     MOVE -1                     TO BTYPE-LEN   (1).
  7153     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7154     MOVE 'Y'                    TO ERROR-SW.
  7155     GO TO 1059-EXIT.
  7156
  7157
  7158 1050-EDIT-INPUT-AH-CODE.
  7159
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 140
* EL9301.cbl
  7160     MOVE SPACES                 TO ELCNTL-ACCESS.
  7161     MOVE 'A'                    TO ELCNTL-REC-TYPE.
  7162
  7163     PERFORM 1070-ELCNTL-READ THRU 1079-EXIT.
  7164
  7165     IF EMI-ERROR = 9999
  7166         GO TO 1058-NO-RECORD.
  7167
  7168     MOVE +1 TO WS-EDIT-SUB.
  7169
  7170 1051-SEARCH-LOOP.
  7171
  7172     IF CF-AH-CODE-OUT (WS-EDIT-SUB) = ZEROS
  7173         GO TO 1057-NO-MATCH-FOUND.
  7174
  7175     IF BTYPE (2) = CF-AH-CODE-IN (WS-EDIT-SUB)
  7176         MOVE CF-AH-CODE-OUT (WS-EDIT-SUB) TO WS-EDITED-AH-CODE
  7177         PERFORM 1060-BENEFIT-MASTER-READ THRU 1069-EXIT
  7178         GO TO 1059-EXIT.
  7179
  7180     ADD +1  TO WS-EDIT-SUB.
  7181
  7182     IF WS-EDIT-SUB GREATER THAN +96
  7183         GO TO 1057-NO-MATCH-FOUND.
  7184
  7185     GO TO 1051-SEARCH-LOOP.
  7186
  7187 1057-NO-MATCH-FOUND.
  7188
  7189     MOVE ER-2428                TO EMI-ERROR.
  7190     MOVE AL-UABON               TO BTYPE-ATTRB (2).
  7191     MOVE -1                     TO BTYPE-LEN   (2).
  7192     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7193     MOVE 'Y'                    TO ERROR-SW.
  7194     GO TO 1059-EXIT.
  7195
  7196 1058-NO-RECORD.
  7197
  7198     MOVE ER-2427                TO EMI-ERROR.
  7199     MOVE AL-UABON               TO BTYPE-ATTRB (2).
  7200     MOVE -1                     TO BTYPE-LEN   (2).
  7201     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7202     MOVE 'Y'                    TO ERROR-SW.
  7203
  7204 1059-EXIT.
  7205     EXIT.
  7206
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 141
* EL9301.cbl
  7208
  7209******************************************************************
  7210*                                                                *
  7211*         B E N E F I T   M A S T E R   R E A D                  *
  7212*                                                                *
  7213******************************************************************
  7214
  7215 1060-BENEFIT-MASTER-READ.
  7216
  7217     MOVE SPACES                 TO ELCNTL-ACCESS.
  7218
  7219     IF ELCNTL-REC-TYPE = 'L'
  7220         MOVE WS-EDITED-LF-CODE  TO WS-BEN-CD
  7221                                    ELCNTL-HI-BEN
  7222         MOVE '4'                TO ELCNTL-REC-TYPE
  7223     ELSE
  7224         MOVE WS-EDITED-AH-CODE  TO WS-BEN-CD
  7225                                    ELCNTL-HI-BEN
  7226         MOVE '5'                TO ELCNTL-REC-TYPE.
  7227
  7228     PERFORM 1070-ELCNTL-READ THRU 1079-EXIT.
  7229
  7230     IF EMI-ERROR = 9999
  7231         GO TO 1062-NO-RECORD.
  7232
  7233     IF (ELCNTL-COMPANY-ID NOT  = CF-COMPANY-ID) OR
  7234        (ELCNTL-REC-TYPE NOT = CF-RECORD-TYPE)
  7235           GO TO 1062-NO-RECORD.
  7236
  7237     PERFORM 1061-BENEFIT-DUMMY THRU 1061-DUMMY-EXIT
  7238         VARYING WS-SUB FROM +1 BY +1 UNTIL
  7239            ((WS-SUB GREATER +8) OR
  7240            (CF-BENEFIT-CODE (WS-SUB) = WS-BEN-CD)).
  7241
  7242     IF WS-SUB NOT = +9
  7243         IF ELCNTL-REC-TYPE = '4'
  7244             MOVE CF-BENEFIT-ALPHA (WS-SUB) TO WS-LF-ABBR-DESC
  7245         ELSE
  7246             MOVE CF-BENEFIT-ALPHA (WS-SUB) TO WS-AH-ABBR-DESC
  7247     ELSE
  7248         GO TO 1063-NO-MATCH-FOUND.
  7249
  7250     IF  CF-TERM-IN-DAYS (WS-SUB)
  7251         MOVE 'Y'                TO WS-TERM-IN-DAYS-SW.
  7252
  7253     GO TO 1069-EXIT.
  7254
  7255 1061-BENEFIT-DUMMY.
  7256
  7257 1061-DUMMY-EXIT.
  7258     EXIT.
  7259
  7260 1062-NO-RECORD.
  7261
  7262     MOVE ER-2426                TO EMI-ERROR.
  7263
  7264     IF ELCNTL-REC-TYPE = '4'
  7265         MOVE AL-UABON           TO BTYPE-ATTRB (1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 142
* EL9301.cbl
  7266         MOVE -1                 TO BTYPE-LEN   (1)
  7267     ELSE
  7268         MOVE AL-UABON           TO BTYPE-ATTRB (2)
  7269         MOVE -1                 TO BTYPE-LEN   (2).
  7270
  7271     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7272     MOVE 'Y'                    TO ERROR-SW.
  7273
  7274     GO TO 1069-EXIT.
  7275
  7276 1063-NO-MATCH-FOUND.
  7277
  7278     IF ELCNTL-REC-TYPE = '4'
  7279         MOVE ER-2425            TO EMI-ERROR
  7280         MOVE AL-UABON           TO BTYPE-ATTRB (1)
  7281         MOVE -1                 TO BTYPE-LEN   (1)
  7282     ELSE
  7283         MOVE ER-2429            TO EMI-ERROR
  7284         MOVE AL-UABON           TO BTYPE-ATTRB (2)
  7285         MOVE -1                 TO BTYPE-LEN   (2).
  7286
  7287     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7288     MOVE 'Y'                    TO ERROR-SW.
  7289     GO TO 1069-EXIT.
  7290
  7291 1069-EXIT.
  7292     EXIT.
  7293
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 143
* EL9301.cbl
  7295
  7296
  7297******************************************************************
  7298*                                                                *
  7299*             C O N T R O L   F I L E   R E A D                  *
  7300*                                                                *
  7301******************************************************************
  7302
  7303 1070-ELCNTL-READ.
  7304
  7305
  7306* EXEC CICS HANDLE CONDITION
  7307*        NOTFND  (1078-NO-RECORD)
  7308*        ENDFILE (1078-NO-RECORD)
  7309*        END-EXEC.
  7310*    MOVE '"$I''                  ! # #00007276' TO DFHEIV0
  7311     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7312     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7313     MOVE X'2320233030303037323736' TO DFHEIV0(25:11)
  7314     CALL 'kxdfhei1' USING DFHEIV0
  7315     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7316
  7317
  7318     IF ELCNTL-REC-TYPE = '1' OR '4' OR '5'
  7319
  7320* EXEC CICS READ
  7321*            DATASET (FILE-ID-ELCNTL)
  7322*            SET     (ELCNTL-POINTER)
  7323*            RIDFLD  (ELCNTL-KEY)
  7324*            GTEQ
  7325*            END-EXEC
  7326*    MOVE '&"S        G          (   #00007282' TO DFHEIV0
  7327     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7328     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7329     MOVE X'2020233030303037323832' TO DFHEIV0(25:11)
  7330     CALL 'kxdfhei1' USING DFHEIV0,
  7331           FILE-ID-ELCNTL,
  7332           ELCNTL-POINTER,
  7333           DFHEIV99,
  7334           ELCNTL-KEY,
  7335           DFHEIV99,
  7336           DFHEIV99,
  7337           DFHEIV99
  7338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7339     ELSE
  7340
  7341* EXEC CICS READ
  7342*            DATASET (FILE-ID-ELCNTL)
  7343*            SET     (ELCNTL-POINTER)
  7344*            RIDFLD  (ELCNTL-KEY)
  7345*            END-EXEC.
  7346*    MOVE '&"S        E          (   #00007289' TO DFHEIV0
  7347     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7348     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7349     MOVE X'2020233030303037323839' TO DFHEIV0(25:11)
  7350     CALL 'kxdfhei1' USING DFHEIV0,
  7351           FILE-ID-ELCNTL,
  7352           ELCNTL-POINTER,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 144
* EL9301.cbl
  7353           DFHEIV99,
  7354           ELCNTL-KEY,
  7355           DFHEIV99,
  7356           DFHEIV99,
  7357           DFHEIV99
  7358     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7359
  7360
  7361     SERVICE RELOAD CONTROL-FILE.
  7362
  7363     GO TO 1079-EXIT.
  7364
  7365 1078-NO-RECORD.
  7366
  7367     MOVE ER-9999                TO EMI-ERROR.
  7368
  7369 1079-EXIT.
  7370     EXIT.
  7371
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 145
* EL9301.cbl
  7373
  7374
  7375******************************************************************
  7376*                                                                *
  7377*   T E R M   C O N V E R S I O N   FOR   T E R M  IN  D A Y S   *
  7378*                                                                *
  7379******************************************************************
  7380
  7381 1080-TERM-CONVERSION.
  7382
  7383     IF BMODE   = ' ' OR 'M'
  7384         MOVE WS-BPMTS      TO WS-CALC-TERM-WHOLE
  7385         GO TO 1085-ROUND-TERM.
  7386
  7387     IF BMODE   = 'S'
  7388         COMPUTE WS-CALC-TERM = WS-BPMTS   / 2
  7389         GO TO 1085-ROUND-TERM.
  7390
  7391     IF BMODE   = 'W'
  7392         COMPUTE WS-CALC-TERM = WS-BPMTS   / 4.33333
  7393         GO TO 1085-ROUND-TERM.
  7394
  7395     IF BMODE   = 'B'
  7396         COMPUTE WS-CALC-TERM = WS-BPMTS   / 2.16667.
  7397
  7398 1085-ROUND-TERM.
  7399
  7400     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
  7401         ADD +1                  TO WS-CALC-TERM-WHOLE.
  7402     MOVE ZEROS                  TO WS-CALC-TERM-REMAIN.
  7403
  7404     IF  BTYPE-LEN       (WS-SUB1)  GREATER THAN ZEROS
  7405         IF  WS-KIND-MONTHLY
  7406             IF BTERM-LEN    (WS-SUB1)  EQUAL ZEROS
  7407                IF BPREM-LEN (WS-SUB1)  GREATER THAN ZEROS
  7408                   IF  BPMT-LEN   GREATER THAN ZEROS
  7409                       NEXT SENTENCE
  7410                   ELSE
  7411                       GO TO 1087-EDIT-TERM.
  7412
  7413     IF  BMODE   = 'M'
  7414         MOVE WS-BPMT            TO  BBENO      (WS-SUB1)
  7415                                     WS-BBEN    (WS-SUB1)
  7416         MOVE AL-UNNON           TO  BBEN-ATTRB (WS-SUB1)
  7417         MOVE +12                TO  BBEN-LEN   (WS-SUB1)
  7418         GO TO 1087-EDIT-TERM.
  7419
  7420     IF  BMODE   = 'W'
  7421         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = WS-BPMT * 4.33333
  7422         MOVE    WS-BBEN (WS-SUB1) TO BBENO       (WS-SUB1)
  7423         MOVE AL-UNNON             TO  BBEN-ATTRB (WS-SUB1)
  7424         MOVE +12                  TO  BBEN-LEN   (WS-SUB1)
  7425         GO TO 1087-EDIT-TERM.
  7426
  7427     IF  BMODE   = 'S'
  7428         COMPUTE WS-BBEN (WS-SUB1)  ROUNDED = WS-BPMT * 2
  7429         MOVE    WS-BBEN (WS-SUB1)  TO BBENO      (WS-SUB1)
  7430         MOVE AL-UNNON              TO BBEN-ATTRB (WS-SUB1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 146
* EL9301.cbl
  7431         MOVE +12                   TO BBEN-LEN   (WS-SUB1)
  7432         GO TO 1087-EDIT-TERM.
  7433
  7434     IF  BMODE   = 'B'
  7435         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = WS-BPMT * 2.16667
  7436         MOVE    WS-BBEN (WS-SUB1) TO BBENO       (WS-SUB1)
  7437         MOVE +12                  TO BBEN-LEN    (WS-SUB1)
  7438         MOVE AL-UNNON             TO BBEN-ATTRB  (WS-SUB1).
  7439
  7440 1087-EDIT-TERM.
  7441
  7442     IF BTERM-LEN (WS-SUB1)  = ZEROS
  7443         MOVE WS-CALC-TERM-WHOLE   TO BTERMI      (WS-SUB1)
  7444                                      WS-BTERM    (WS-SUB1)
  7445         MOVE +3                   TO BTERM-LEN   (WS-SUB1)
  7446         GO TO 1089-EXIT.
  7447
  7448     MOVE BTERMI    (WS-SUB1)   TO DEEDIT-FIELD.
  7449     PERFORM 8600-DEEDIT.
  7450     IF DEEDIT-FIELD-V0 NUMERIC
  7451        MOVE DEEDIT-FIELD-V0    TO WS-BTERM    (WS-SUB1)
  7452        IF WS-BTERM (WS-SUB1)  GREATER THAN ZERO
  7453           MOVE AL-UNNON        TO BTERM-ATTRB (WS-SUB1)
  7454        ELSE
  7455           MOVE ER-2241         TO EMI-ERROR
  7456           MOVE -1              TO BTERM-LEN   (WS-SUB1)
  7457           MOVE AL-UNBOF        TO BTERM-ATTRB (WS-SUB1)
  7458           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7459           GO TO 1089-EXIT.
  7460
  7461     IF WS-BTERM (WS-SUB1)   NOT = WS-CALC-TERM-WHOLE
  7462         MOVE -1                   TO BTERM-LEN   (WS-SUB1)
  7463         MOVE ER-2593              TO EMI-ERROR
  7464         MOVE AL-UNBON             TO BTERM-ATTRB (WS-SUB1)
  7465         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7466
  7467 1089-EXIT.
  7468     EXIT.
  7469
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 147
* EL9301.cbl
  7471
  7472******************************************************************
  7473*                                                                *
  7474*         CALCULATE MONTHLY TERM AND BENEFIT                     *
  7475*                                                                *
  7476******************************************************************
  7477
  7478 1090-CALCULATE-MONTHLY-TERM.
  7479
  7480     COMPUTE  WS-CALC-TERM = WS-BDAYS / 31.
  7481
  7482     IF WS-CALC-TERM-REMAIN GREATER THAN .00000
  7483        ADD +1 TO WS-CALC-TERM.
  7484
  7485     MOVE ZEROS                  TO  WS-CALC-TERM-REMAIN.
  7486     MOVE WS-CALC-TERM           TO  BTERMO    (2).
  7487     MOVE +3                     TO  BTERM-LEN (2).
  7488
  7489     IF  BTYPE-LEN  (2)  GREATER THAN ZEROS
  7490         IF BTERM-LEN (2)  EQUAL ZEROS
  7491            IF BPREM-LEN (2) GREATER THAN ZEROS
  7492               IF  BPMT-LEN   GREATER THAN ZEROS
  7493                   NEXT SENTENCE
  7494               ELSE
  7495                   GO TO 1094-EXIT.
  7496
  7497     IF  BMODE   = 'M'
  7498         MOVE WS-BPMT            TO  WS-BBEN     (2)
  7499                                     BBENO       (2)
  7500         MOVE AL-UNNON           TO  BBEN-ATTRB  (2)
  7501         MOVE +12                TO  BBEN-LEN    (2)
  7502         GO TO 1094-EXIT.
  7503
  7504     IF  BMODE   = 'W'
  7505         COMPUTE WS-BBEN (WS-SUB1) ROUNDED = WS-BPMT * 4.33333
  7506         MOVE WS-BBEN    (WS-SUB1)   TO BBENO       (WS-SUB1)
  7507         MOVE  AL-UNNON              TO  BBEN-ATTRB (WS-SUB1)
  7508         MOVE  +12                   TO  BBEN-LEN   (WS-SUB1)
  7509         GO TO 1094-EXIT.
  7510
  7511     IF  BMODE   = 'S'
  7512         COMPUTE WS-BBEN (2)        ROUNDED = WS-BPMT * 2
  7513         MOVE WS-BBEN    (2)         TO  BBENO      (2)
  7514         MOVE  AL-UNNON              TO  BBEN-ATTRB (2)
  7515         MOVE  +12                   TO  BBEN-LEN   (2)
  7516         GO TO 1094-EXIT.
  7517
  7518     IF  BMODE   = 'B'
  7519         COMPUTE WS-BBEN (2)       ROUNDED = WS-BPMT * 2.16667
  7520         MOVE WS-BBEN    (2)         TO  BBENO      (2)
  7521         MOVE +12                    TO  BBEN-LEN   (2)
  7522         MOVE AL-UNNON               TO  BBEN-ATTRB (2).
  7523
  7524
  7525 1094-EXIT.
  7526     EXIT.
  7527
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 148
* EL9301.cbl
  7529
  7530
  7531******************************************************************
  7532*                                                                *
  7533*               CALCULATE INSURED'S AGE                          *
  7534*                                                                *
  7535******************************************************************
  7536
  7537 1095-CALC-AGE.
  7538
  7539     MOVE WS-CONVERTED-BIRTH TO DC-BIN-DATE-1.
  7540     MOVE WS-CURRENT-BIN-DT TO  DC-BIN-DATE-2.
  7541     MOVE 1 TO DC-OPTION-CODE.
  7542     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  7543     IF NO-CONVERSION-ERROR
  7544         COMPUTE WS-BAGE = DC-ELAPSED-MONTHS / 12
  7545         MOVE WS-BAGE            TO BAGE
  7546         MOVE +2                 TO BAGE-LEN
  7547         MOVE AL-UNNON TO BAGE-ATTRB .
  7548
  7549 1099-EXIT.
  7550     EXIT.
  7551
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 149
* EL9301.cbl
  7553
  7554******************************************************************
  7555*                                                                *
  7556*    E D I T   D A T A   E N T R Y   C A N C E L   S C R E E N   *
  7557*                                                                *
  7558******************************************************************
  7559
  7560
  7561 1100-EDIT-MAPC.
  7562
  7563     MOVE +1                     TO WS-SUB2.
  7564
  7565     IF PI-LAST-FUNC-DISPLAY
  7566        AND CLAST-NAME-LEN (1)   = ZEROS
  7567        AND CLAST-NAME-LEN (2)   = ZEROS
  7568        AND CLAST-NAME-LEN (3)   = ZEROS
  7569        AND CLAST-NAME-LEN (4)   = ZEROS
  7570        AND CCANDT1-LEN     (1) = ZEROS
  7571        AND CCANDT2-LEN     (1) = ZEROS
  7572        AND CCANDT1-LEN     (2) = ZEROS
  7573        AND CCANDT2-LEN     (2) = ZEROS
  7574        AND CCANDT1-LEN     (3) = ZEROS
  7575        AND CCANDT2-LEN     (3) = ZEROS
  7576        AND CCANDT1-LEN     (4) = ZEROS
  7577        AND CCANDT2-LEN     (4) = ZEROS
  7578        AND CREFUND1-LEN    (1) = ZEROS
  7579        AND CREFUND2-LEN    (1) = ZEROS
  7580        AND CREFUND1-LEN    (2) = ZEROS
  7581        AND CREFUND2-LEN    (2) = ZEROS
  7582        AND CREFUND1-LEN    (3) = ZEROS
  7583        AND CREFUND2-LEN    (3) = ZEROS
  7584        AND CREFUND1-LEN    (4) = ZEROS
  7585        AND CREFUND2-LEN    (4) = ZEROS
  7586        AND CLIVES-LEN     (1) = ZEROS
  7587        AND CLIVES-LEN     (2) = ZEROS
  7588        AND CLIVES-LEN     (3) = ZEROS
  7589        AND CLIVES-LEN     (4) = ZEROS
  7590        AND CPAYEE-LEN     (1) = ZEROS
  7591        AND CPAYEE-LEN     (2) = ZEROS
  7592        AND CPAYEE-LEN     (3) = ZEROS
  7593        AND CPAYEE-LEN     (4) = ZEROS
  7594        AND CCHK-LEN       (1) = ZEROS
  7595        AND CCHK-LEN       (2) = ZEROS
  7596        AND CCHK-LEN       (3) = ZEROS
  7597        AND CCHK-LEN       (4) = ZEROS
  7598         GO TO 1130-NOTHING-TO-EDIT.
  7599
  7600 1110-EDIT-MAPC-LOOP.
  7601
  7602     IF CCERT-LEN       (WS-SUB2) = ZEROS
  7603       AND CEFFDT-LEN   (WS-SUB2) = ZEROS
  7604       AND CCANDT1-LEN  (WS-SUB2) = ZEROS
  7605       AND CCANDT2-LEN  (WS-SUB2) = ZEROS
  7606       AND CREFUND1-LEN (WS-SUB2) = ZEROS
  7607       AND CREFUND2-LEN (WS-SUB2) = ZEROS
  7608       AND NOT PI-LAST-FUNC-DISPLAY
  7609         GO TO 1120-INCREMENT-OCCURANCE.
  7610
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 150
* EL9301.cbl
  7611     MOVE 'Y'                    TO WS-DATA-KEYED-SW.
  7612
  7613     MOVE AL-SABON               TO CSEQ-ATTRB (WS-SUB2).
  7614
  7615     IF NOT PI-LAST-FUNC-DISPLAY
  7616        IF CCAR-LEN (WS-SUB2) GREATER THAN ZEROS
  7617           MOVE AL-UANON           TO CCAR-ATTRB (WS-SUB2)
  7618           PERFORM 1500-VERIFY-CARRIER-ID THRU 1590-EXIT
  7619        ELSE
  7620           IF NOT ST-ACCNT-CNTL AND NOT ACCNT-CNTL
  7621              MOVE -1             TO CCAR-LEN   (WS-SUB2)
  7622              MOVE AL-UABON       TO CCAR-ATTRB (WS-SUB2)
  7623              MOVE ER-0194        TO EMI-ERROR
  7624              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7625
  7626     IF NOT PI-LAST-FUNC-DISPLAY
  7627        IF CGRP-LEN (WS-SUB2) GREATER THAN ZEROS
  7628           MOVE AL-UANON           TO CGRP-ATTRB (WS-SUB2)
  7629        ELSE
  7630           IF CARR-GROUP-ST-ACCNT-CNTL
  7631              MOVE -1             TO CGRP-LEN      (WS-SUB2)
  7632              MOVE AL-UABON       TO CGRP-ATTRB    (WS-SUB2)
  7633              MOVE ER-0195        TO EMI-ERROR
  7634              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7635
  7636     IF NOT PI-LAST-FUNC-DISPLAY
  7637        IF CST-LEN (WS-SUB2) GREATER THAN ZEROS
  7638           MOVE AL-UANON           TO CST-ATTRB  (WS-SUB2)
  7639           PERFORM 1600-VERIFY-STATE-ID THRU 1690-EXIT
  7640        ELSE
  7641           IF NOT ACCNT-CNTL AND NOT CARR-ACCNT-CNTL
  7642              MOVE -1             TO CST-LEN    (WS-SUB2)
  7643              MOVE AL-UABON       TO CST-ATTRB  (WS-SUB2)
  7644              MOVE ER-0196        TO EMI-ERROR
  7645              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7646
  7647     IF NOT PI-LAST-FUNC-DISPLAY
  7648        IF CACCT-LEN (WS-SUB2) GREATER THAN ZEROS
  7649           MOVE AL-UANON           TO CACCT-ATTRB (WS-SUB2)
  7650           PERFORM 1700-VERIFY-ACCOUNT THRU 1790-EXIT
  7651        ELSE
  7652           MOVE -1 TO CACCT-LEN      (WS-SUB2)
  7653           MOVE AL-UABON           TO CACCT-ATTRB (WS-SUB2)
  7654           MOVE ER-0197            TO EMI-ERROR
  7655           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7656
  7657
  7658     IF CCERT-LEN (WS-SUB2) = ZEROS
  7659       AND PI-LAST-FUNC-DISPLAY
  7660         NEXT SENTENCE
  7661     ELSE
  7662         IF CCERT-LEN (WS-SUB2)  NOT = ZEROS
  7663             MOVE AL-UANON       TO CCERT-ATTRB (WS-SUB2)
  7664         ELSE
  7665             MOVE -1             TO CCERT-LEN   (WS-SUB2)
  7666             MOVE ER-2218        TO EMI-ERROR
  7667             MOVE AL-UABON       TO CCERT-ATTRB (WS-SUB2)
  7668             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 151
* EL9301.cbl
  7669
  7670     IF CSFX-LEN (WS-SUB1)      GREATER THAN ZEROS
  7671         MOVE 'Y'                TO PI-CAN-SUFFIX-KEYED-SW
  7672         MOVE AL-UANON           TO CSFX-ATTRB (WS-SUB2).
  7673
  7674     IF CEFFDT-LEN (WS-SUB2) = ZEROS
  7675       AND PI-LAST-FUNC-DISPLAY
  7676         NEXT SENTENCE
  7677     ELSE
  7678         IF CEFFDT-LEN (WS-SUB2) GREATER THAN ZEROS
  7679             MOVE AL-UNNON           TO CEFFDT-ATTRB (WS-SUB2)
  7680             IF CEFFDT (WS-SUB2) NUMERIC
  7681                 MOVE 4              TO DC-OPTION-CODE
  7682                 MOVE CEFFDT (WS-SUB2)  TO DC-GREG-DATE-1-MDY
  7683                 PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7684                 MOVE DC-BIN-DATE-1  TO WS-CONVERTED-EFFDT
  7685                 IF NO-CONVERSION-ERROR
  7686                     IF WS-CONVERTED-EFFDT NOT LESS THAN
  7687                       PI-ACCT-LOW-EFF-DT AND LESS THAN
  7688                       PI-ACCT-HIGH-EXP-DT
  7689                         NEXT SENTENCE
  7690                     ELSE
  7691                         MOVE -1       TO CEFFDT-LEN (WS-SUB2)
  7692                         MOVE ER-2589  TO EMI-ERROR
  7693                         MOVE AL-UNBON TO CEFFDT-ATTRB (WS-SUB2)
  7694                         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7695                 ELSE
  7696                     MOVE -1         TO CEFFDT-LEN (WS-SUB2)
  7697                     MOVE ER-2226    TO EMI-ERROR
  7698                     MOVE AL-UNBON   TO CEFFDT-ATTRB (WS-SUB2)
  7699                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7700             ELSE
  7701                 MOVE -1             TO CEFFDT-LEN (WS-SUB2)
  7702                 MOVE ER-2223        TO EMI-ERROR
  7703                 MOVE AL-UNBON       TO CEFFDT-ATTRB (WS-SUB2)
  7704                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7705         ELSE
  7706             MOVE -1                 TO CEFFDT-LEN (WS-SUB2)
  7707             MOVE ER-2220            TO EMI-ERROR
  7708             MOVE AL-UNBON           TO CEFFDT-ATTRB (WS-SUB2)
  7709             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7710
  7711     IF CLAST-NAME-LEN (WS-SUB2) GREATER THAN ZEROS
  7712         MOVE AL-UANON           TO CLAST-NAME-ATTRB (WS-SUB2).
  7713
  7714
  7715
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 152
* EL9301.cbl
  7717
  7718******************************************************************
  7719*                                                                *
  7720*           E D I T   C A N C E L   C O V E R A G E S            *
  7721*                                                                *
  7722******************************************************************
  7723
  7724 1115-EDIT-COVERAGES.
  7725
  7726     IF CCANDT1-LEN (WS-SUB2) = ZEROS
  7727       AND PI-LAST-FUNC-DISPLAY
  7728         NEXT SENTENCE
  7729     ELSE
  7730         IF CCANDT1-LEN (WS-SUB2) GREATER THAN ZEROS
  7731             MOVE AL-UNNON       TO CCANDT1-ATTRB (WS-SUB2)
  7732             IF PI-LAST-FUNC-DISPLAY AND
  7733                CCANDT1 (WS-SUB2) = SPACES
  7734                 MOVE LOW-VALUES TO WS-CONVERTED-CANDT1 (WS-SUB2)
  7735             ELSE
  7736                IF CCANDT1 (WS-SUB2) NUMERIC
  7737                   MOVE 4              TO DC-OPTION-CODE
  7738                   MOVE CCANDT1 (WS-SUB2) TO
  7739                                      DC-GREG-DATE-1-MDY
  7740                   PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7741                   MOVE DC-BIN-DATE-1  TO WS-CONVERTED-CANDT1
  7742                                                         (WS-SUB2)
  7743                   IF NO-CONVERSION-ERROR
  7744                      NEXT SENTENCE
  7745                   ELSE
  7746                      MOVE -1       TO CCANDT1-LEN   (WS-SUB2)
  7747                      MOVE ER-2227  TO EMI-ERROR
  7748                      MOVE AL-UNBON TO CCANDT1-ATTRB (WS-SUB2)
  7749                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7750                ELSE
  7751                   MOVE -1         TO CCANDT1-LEN   (WS-SUB2)
  7752                   MOVE ER-2223    TO EMI-ERROR
  7753                   MOVE AL-UNBON   TO CCANDT1-ATTRB (WS-SUB2)
  7754                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7755         ELSE
  7756             IF CREFUND1-LEN (WS-SUB2) GREATER THAN ZEROS
  7757                MOVE -1             TO CCANDT1-LEN   (WS-SUB2)
  7758                MOVE ER-2222        TO EMI-ERROR
  7759                MOVE AL-UNBOF       TO CCANDT1-ATTRB (WS-SUB2)
  7760                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7761
  7762
  7763     IF CREFUND1-LEN (WS-SUB2) = ZEROS
  7764       AND PI-LAST-FUNC-DISPLAY
  7765         NEXT SENTENCE
  7766     ELSE
  7767         IF CREFUND1-LEN (WS-SUB2) NOT = ZEROS
  7768            MOVE AL-UNNON       TO CREFUND1-ATTRB (WS-SUB2)
  7769            MOVE CREFUND1I (WS-SUB2) TO DEEDIT-FIELD-X11
  7770            PERFORM 8600-DEEDIT
  7771            MOVE DEEDIT-FIELD-V2  TO WS-CREFUND1 (WS-SUB2).
  7772
  7773     IF CCANDT2-LEN (WS-SUB2) = ZEROS
  7774       AND PI-LAST-FUNC-DISPLAY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 153
* EL9301.cbl
  7775         NEXT SENTENCE
  7776     ELSE
  7777         IF CCANDT2-LEN (WS-SUB2) GREATER THAN ZEROS
  7778             MOVE AL-UNNON       TO CCANDT2-ATTRB (WS-SUB2)
  7779             IF PI-LAST-FUNC-DISPLAY AND
  7780                CCANDT2 (WS-SUB2) = SPACES
  7781                 MOVE LOW-VALUES TO WS-CONVERTED-CANDT2 (WS-SUB2)
  7782             ELSE
  7783                IF CCANDT2 (WS-SUB2) NUMERIC
  7784                   MOVE 4              TO DC-OPTION-CODE
  7785                   MOVE CCANDT2 (WS-SUB2) TO
  7786                                      DC-GREG-DATE-1-MDY
  7787                   PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  7788                   MOVE DC-BIN-DATE-1  TO WS-CONVERTED-CANDT2
  7789                                                         (WS-SUB2)
  7790                   IF NO-CONVERSION-ERROR
  7791                      NEXT SENTENCE
  7792                   ELSE
  7793                      MOVE -1       TO CCANDT2-LEN   (WS-SUB2)
  7794                      MOVE ER-2227  TO EMI-ERROR
  7795                      MOVE AL-UNBON TO CCANDT2-ATTRB (WS-SUB2)
  7796                      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7797                ELSE
  7798                   MOVE -1         TO CCANDT2-LEN   (WS-SUB2)
  7799                   MOVE ER-2223    TO EMI-ERROR
  7800                   MOVE AL-UNBON   TO CCANDT2-ATTRB (WS-SUB2)
  7801                   PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7802         ELSE
  7803             IF CREFUND2-LEN (WS-SUB2) GREATER THAN ZEROS
  7804                MOVE -1             TO CCANDT2-LEN   (WS-SUB2)
  7805                MOVE ER-2222        TO EMI-ERROR
  7806                MOVE AL-UNBOF       TO CCANDT2-ATTRB (WS-SUB2)
  7807                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7808
  7809
  7810     IF CREFUND2-LEN (WS-SUB2) = ZEROS
  7811       AND PI-LAST-FUNC-DISPLAY
  7812         NEXT SENTENCE
  7813     ELSE
  7814         IF CREFUND2-LEN (WS-SUB2) NOT = ZEROS
  7815            MOVE AL-UNNON       TO CREFUND2-ATTRB (WS-SUB2)
  7816            MOVE CREFUND2I (WS-SUB2) TO DEEDIT-FIELD-X11
  7817            PERFORM 8600-DEEDIT
  7818            MOVE DEEDIT-FIELD-V2  TO WS-CREFUND2 (WS-SUB2).
  7819
  7820     IF CLIVES-LEN  (WS-SUB2)  GREATER THAN ZEROS
  7821         MOVE 'Y'                TO PI-CAN-LIVES-KEYED-SW
  7822         MOVE CLIVESI (WS-SUB2 ) TO DEEDIT-FIELD
  7823         PERFORM 8600-DEEDIT
  7824         IF DEEDIT-FIELD-V0 NUMERIC
  7825             MOVE DEEDIT-FIELD-V0 TO WS-CLIVES   (WS-SUB2)
  7826             MOVE AL-UNNON       TO CLIVES-ATTRB (WS-SUB2)
  7827         ELSE
  7828             MOVE -1             TO CLIVES-LEN   (WS-SUB2)
  7829             MOVE AL-UNBON       TO CLIVES-ATTRB (WS-SUB2)
  7830             MOVE ER-2223        TO EMI-ERROR
  7831             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7832
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 154
* EL9301.cbl
  7833     IF CPAYEE-LEN  (WS-SUB2)  GREATER THAN ZEROS
  7834        MOVE 'Y'                 TO PI-PAYEE-KEYED-SW.
  7835
  7836     IF CCHK-LEN    (WS-SUB2)  GREATER THAN ZEROS
  7837        MOVE 'Y'                 TO PI-CHK-REQ-KEYED-SW
  7838        IF  CCHK    (WS-SUB2)  = 'R' OR ' '
  7839            NEXT SENTENCE
  7840        ELSE
  7841            MOVE ER-7405         TO EMI-ERROR
  7842            MOVE -1              TO CCHK-LEN      (WS-SUB2)
  7843            MOVE AL-UABON        TO CCHK-ATTRB    (WS-SUB2)
  7844            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7845
  7846     IF PI-LAST-FUNC-DISPLAY
  7847        NEXT SENTENCE
  7848     ELSE
  7849        IF CCANDT1-LEN (WS-SUB2) GREATER THAN ZEROS OR
  7850           CCANDT2-LEN (WS-SUB2) GREATER THAN ZEROS
  7851           NEXT SENTENCE
  7852        ELSE
  7853           MOVE ER-2222          TO EMI-ERROR
  7854           MOVE -1               TO CCANDT1-LEN   (WS-SUB2)
  7855           MOVE AL-UNBOF         TO CCANDT1-ATTRB (WS-SUB2)
  7856           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7857
  7858
  7859     IF  EMI-ERROR = ZEROS
  7860         MOVE 'Y'                TO PI-UPDATE-SW
  7861         MOVE SPACE              TO PI-DISPLAY-SW
  7862         PERFORM 5000-BUILD-CANCEL-RECORD THRU 5900-EXIT
  7863     ELSE
  7864         MOVE ZEROS              TO EMI-ERROR
  7865         MOVE 'Y'                TO PI-ERROR-SW.
  7866
  7867 1120-INCREMENT-OCCURANCE.
  7868
  7869     ADD +1                      TO WS-SUB2.
  7870
  7871     IF WS-SUB2 GREATER THAN +2 OR PI-LAST-FUNC-DISPLAY
  7872         NEXT SENTENCE
  7873     ELSE
  7874         GO TO 1110-EDIT-MAPC-LOOP.
  7875
  7876
  7877 1130-NOTHING-TO-EDIT.
  7878
  7879
  7880     IF PI-DATA-ERRORS
  7881         MOVE AL-SABON           TO CSEQ-ATTRB (1) CSEQ-ATTRB (2)
  7882                                    CSEQ-ATTRB (3) CSEQ-ATTRB (4)
  7883        GO TO 8100-SEND-INITIAL-MAP.
  7884
  7885     IF NOT PI-LAST-FUNC-DISPLAY
  7886        AND WS-DATA-NOT-KEYED
  7887        MOVE ER-7400             TO EMI-ERROR
  7888        MOVE -1                  TO CCANDT1-LEN (1)
  7889        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7890        MOVE 'Y'                 TO PI-ERROR-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 155
* EL9301.cbl
  7891        GO TO 8200-SEND-DATAONLY.
  7892
  7893     IF PI-SAV-BATCH-SEQ LESS THAN PI-LAST-SEQ-NO-ADDED
  7894        SUBTRACT 1 FROM PI-SAV-BATCH-SEQ
  7895        MOVE ER-0000            TO EMI-ERROR
  7896        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7897        GO TO 2000-BROWSE-FWD.
  7898
  7899     MOVE LOW-VALUES     TO DATA-ENTRY-MAP.
  7900
  7901     ADD +1, PI-LAST-SEQ-NO-ADDED
  7902                            GIVING PI-NEXT-DISPLAY-SEQ-NO.
  7903
  7904     MOVE PI-NEXT-DISPLAY-SEQ-NO TO PI-SAV-BATCH-SEQ.
  7905
  7906     PERFORM 8550-SET-MAP-SEQ-NOS
  7907                  VARYING WS-SUB2 FROM +1 BY +1
  7908                  UNTIL WS-SUB2 GREATER THAN +2.
  7909
  7910     MOVE ER-0000            TO EMI-ERROR.
  7911     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7912     GO TO 8100-SEND-INITIAL-MAP.
  7913
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 156
* EL9301.cbl
  7915
  7916******************************************************************
  7917*                                                                *
  7918*           V E R I F Y   C A R R I E R   I D                    *
  7919*                                                                *
  7920******************************************************************
  7921
  7922 1500-VERIFY-CARRIER-ID.
  7923
  7924     MOVE SPACES                 TO ELCNTL-KEY.
  7925     MOVE PI-COMPANY-ID          TO ELCNTL-COMPANY-ID.
  7926     MOVE '6'                    TO ELCNTL-REC-TYPE.
  7927
  7928     IF PI-MAP-NAME = EL930B
  7929        MOVE BCAR                TO ELCNTL-CARRIER
  7930     ELSE
  7931        MOVE CCAR (WS-SUB2)      TO ELCNTL-CARRIER.
  7932
  7933     MOVE +0                     TO ELCNTL-SEQ.
  7934
  7935
  7936* EXEC CICS HANDLE CONDITION
  7937*        NOTFND   (1580-NO-CARRIER)
  7938*        END-EXEC.
  7939*    MOVE '"$I                   ! $ #00007869' TO DFHEIV0
  7940     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  7941     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7942     MOVE X'2420233030303037383639' TO DFHEIV0(25:11)
  7943     CALL 'kxdfhei1' USING DFHEIV0
  7944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7945
  7946
  7947
  7948* EXEC CICS READ
  7949*        DATASET   (FILE-ID-ELCNTL)
  7950*        SET       (ELCNTL-POINTER)
  7951*        RIDFLD    (ELCNTL-KEY)
  7952*        END-EXEC.
  7953*    MOVE '&"S        E          (   #00007873' TO DFHEIV0
  7954     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7955     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7956     MOVE X'2020233030303037383733' TO DFHEIV0(25:11)
  7957     CALL 'kxdfhei1' USING DFHEIV0,
  7958           FILE-ID-ELCNTL,
  7959           ELCNTL-POINTER,
  7960           DFHEIV99,
  7961           ELCNTL-KEY,
  7962           DFHEIV99,
  7963           DFHEIV99,
  7964           DFHEIV99
  7965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7966
  7967     SERVICE RELOAD CONTROL-FILE.
  7968     GO TO 1590-EXIT.
  7969
  7970 1580-NO-CARRIER.
  7971
  7972     IF PI-MAP-NAME = EL930B
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 157
* EL9301.cbl
  7973        MOVE -1                  TO BCARL
  7974        MOVE AL-UABON            TO BCARA
  7975     ELSE
  7976        MOVE AL-UABON            TO CCAR-ATTRB (WS-SUB2)
  7977        MOVE -1                  TO CCAR-LEN   (WS-SUB2).
  7978
  7979     MOVE ER-2208                TO EMI-ERROR.
  7980     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7981
  7982 1590-EXIT.
  7983     EXIT.
  7984
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 158
* EL9301.cbl
  7986
  7987******************************************************************
  7988*                                                                *
  7989*               V E R I F Y   S T A T E  I D                     *
  7990*                                                                *
  7991******************************************************************
  7992
  7993 1600-VERIFY-STATE-ID.
  7994
  7995     MOVE SPACES                 TO ELCNTL-KEY.
  7996     MOVE PI-COMPANY-ID          TO ELCNTL-COMPANY-ID.
  7997     MOVE '3'                    TO ELCNTL-REC-TYPE.
  7998
  7999     IF PI-MAP-NAME = EL930B
  8000        MOVE BST                 TO ELCNTL-STATE
  8001     ELSE
  8002        MOVE CST  (WS-SUB2)      TO ELCNTL-STATE.
  8003
  8004     MOVE +0                     TO ELCNTL-SEQ.
  8005
  8006
  8007* EXEC CICS HANDLE CONDITION
  8008*        NOTFND   (1680-NO-STATE)
  8009*        END-EXEC.
  8010*    MOVE '"$I                   ! % #00007917' TO DFHEIV0
  8011     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8012     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8013     MOVE X'2520233030303037393137' TO DFHEIV0(25:11)
  8014     CALL 'kxdfhei1' USING DFHEIV0
  8015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8016
  8017
  8018
  8019* EXEC CICS READ
  8020*        DATASET   (FILE-ID-ELCNTL)
  8021*        SET       (ELCNTL-POINTER)
  8022*        RIDFLD    (ELCNTL-KEY)
  8023*        END-EXEC.
  8024*    MOVE '&"S        E          (   #00007921' TO DFHEIV0
  8025     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8026     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8027     MOVE X'2020233030303037393231' TO DFHEIV0(25:11)
  8028     CALL 'kxdfhei1' USING DFHEIV0,
  8029           FILE-ID-ELCNTL,
  8030           ELCNTL-POINTER,
  8031           DFHEIV99,
  8032           ELCNTL-KEY,
  8033           DFHEIV99,
  8034           DFHEIV99,
  8035           DFHEIV99
  8036     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8037
  8038
  8039     SERVICE RELOAD CONTROL-FILE.
  8040
  8041     GO TO 1690-EXIT.
  8042
  8043 1680-NO-STATE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 159
* EL9301.cbl
  8044
  8045     IF PI-MAP-NAME = EL930B
  8046        MOVE -1                  TO BST-LEN
  8047        MOVE AL-UABON            TO BST-ATTRB
  8048     ELSE
  8049        MOVE AL-UABON            TO CST-LEN (WS-SUB2)
  8050        MOVE -1                  TO CST-LEN (WS-SUB2).
  8051
  8052     MOVE ER-2209                TO EMI-ERROR.
  8053     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8054
  8055 1690-EXIT.
  8056
  8057     EXIT.
  8058
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 160
* EL9301.cbl
  8060
  8061******************************************************************
  8062*                                                                *
  8063*               V E R I F Y   A C C O U N T                      *
  8064*                                                                *
  8065******************************************************************
  8066
  8067 1700-VERIFY-ACCOUNT.
  8068
  8069     IF PI-MAP-NAME NOT = EL930B
  8070        GO TO 1710-VERIFY-CANCEL-ACCOUNT.
  8071
  8072     IF BCAR-LEN GREATER THAN ZEROS
  8073        MOVE BCAR                TO ERACCT-CARRIER
  8074     ELSE
  8075         MOVE SPACES             TO ERACCT-CARRIER.
  8076
  8077     IF BGRP-LEN GREATER THAN ZEROS
  8078         MOVE BGRP               TO ERACCT-GROUPING
  8079     ELSE
  8080         MOVE SPACES             TO ERACCT-GROUPING.
  8081
  8082     IF BST-LEN GREATER THAN ZEROS
  8083         MOVE BST                TO ERACCT-STATE
  8084     ELSE
  8085         MOVE SPACES             TO ERACCT-STATE.
  8086
  8087     MOVE BACCT                  TO ERACCT-ACCOUNT.
  8088
  8089     GO TO 1720-READ-ACCOUNT.
  8090
  8091 1710-VERIFY-CANCEL-ACCOUNT.
  8092
  8093     IF CCAR-LEN  (WS-SUB2) GREATER THAN ZEROS
  8094        MOVE CCAR (WS-SUB2)      TO ERACCT-CARRIER
  8095     ELSE
  8096         MOVE SPACES             TO ERACCT-CARRIER.
  8097
  8098     IF CGRP-LEN   (WS-SUB2) GREATER THAN ZEROS
  8099         MOVE CGRP (WS-SUB2)     TO ERACCT-GROUPING
  8100     ELSE
  8101         MOVE SPACES             TO ERACCT-GROUPING.
  8102
  8103     IF CST-LEN    (WS-SUB2) GREATER THAN ZEROS
  8104         MOVE CST  (WS-SUB2)     TO ERACCT-STATE
  8105     ELSE
  8106         MOVE SPACES             TO ERACCT-STATE.
  8107
  8108     MOVE CACCT (WS-SUB2)        TO ERACCT-ACCOUNT.
  8109
  8110
  8111 1720-READ-ACCOUNT.
  8112
  8113     MOVE PI-COMPANY-CD          TO ERACCT-CO.
  8114     MOVE '0'                    TO WS-FIRST-TIME-SW.
  8115     MOVE LOW-VALUES             TO ERACCT-EXP-DATE
  8116                                    PI-ACCT-LOW-EFF-DT
  8117                                    PI-ACCT-HIGH-EXP-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 161
* EL9301.cbl
  8118
  8119
  8120* EXEC CICS HANDLE CONDITION
  8121*        NOTFND   (1780-ACCOUNT-INVALID)
  8122*        ENDFILE  (1780-ACCOUNT-INVALID)
  8123*        END-EXEC.
  8124*    MOVE '"$I''                  ! & #00008007' TO DFHEIV0
  8125     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8126     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8127     MOVE X'2620233030303038303037' TO DFHEIV0(25:11)
  8128     CALL 'kxdfhei1' USING DFHEIV0
  8129     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8130
  8131
  8132
  8133* EXEC CICS STARTBR
  8134*        DATASET (FILE-ID-ERACCT2)
  8135*        RIDFLD  (ERACCT-KEY)
  8136*        END-EXEC.
  8137     MOVE 0
  8138       TO DFHEIV11
  8139*    MOVE '&,         G          &   #00008012' TO DFHEIV0
  8140     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8141     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8142     MOVE X'2020233030303038303132' TO DFHEIV0(25:11)
  8143     CALL 'kxdfhei1' USING DFHEIV0,
  8144           FILE-ID-ERACCT2,
  8145           ERACCT-KEY,
  8146           DFHEIV99,
  8147           DFHEIV11,
  8148           DFHEIV99
  8149     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8150
  8151
  8152     MOVE 'Y'                    TO WS-BROWSE-SW.
  8153
  8154     MOVE ERACCT-KEY             TO ERACCT-SAVE-KEY.
  8155
  8156 1750-READ-LOOP.
  8157
  8158
  8159* EXEC CICS READNEXT
  8160*        DATASET   (FILE-ID-ERACCT2)
  8161*        SET       (ERACCT-POINTER)
  8162*        RIDFLD    (ERACCT-KEY)
  8163*        END-EXEC.
  8164     MOVE 0
  8165       TO DFHEIV11
  8166*    MOVE '&.S                   )   #00008023' TO DFHEIV0
  8167     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8168     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8169     MOVE X'2020233030303038303233' TO DFHEIV0(25:11)
  8170     CALL 'kxdfhei1' USING DFHEIV0,
  8171           FILE-ID-ERACCT2,
  8172           ERACCT-POINTER,
  8173           DFHEIV99,
  8174           ERACCT-KEY,
  8175           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 162
* EL9301.cbl
  8176           DFHEIV11,
  8177           DFHEIV99,
  8178           DFHEIV99
  8179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8180
  8181
  8182     SERVICE RELOAD ACCOUNT-MASTER.
  8183
  8184     IF ERACCT-COMP-KEY NOT = ERACCT-SAVE-KEY
  8185         GO TO 1780-ACCOUNT-INVALID.
  8186
  8187     IF FIRST-TIME
  8188         MOVE '1'                TO WS-FIRST-TIME-SW
  8189         MOVE AM-VG-CARRIER      TO PI-SAV-CARRIER
  8190         MOVE AM-VG-GROUPING     TO PI-SAV-GROUPING
  8191         MOVE AM-VG-STATE        TO PI-SAV-STATE
  8192         MOVE AM-VG-ACCOUNT      TO PI-SAV-ACCOUNT
  8193         MOVE AM-EFFECTIVE-DT    TO PI-ACCT-LOW-EFF-DT.
  8194
  8195     MOVE AM-EXPIRATION-DT       TO PI-ACCT-HIGH-EXP-DT.
  8196
  8197     GO TO 1750-READ-LOOP.
  8198
  8199 1780-ACCOUNT-INVALID.
  8200
  8201     IF BROWSE-STARTED
  8202        MOVE SPACE  TO WS-BROWSE-SW
  8203
  8204* EXEC CICS ENDBR
  8205*            DATASET (FILE-ID-ERACCT2)
  8206*            END-EXEC.
  8207     MOVE 0
  8208       TO DFHEIV11
  8209*    MOVE '&2                    $   #00008050' TO DFHEIV0
  8210     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8211     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8212     MOVE X'2020233030303038303530' TO DFHEIV0(25:11)
  8213     CALL 'kxdfhei1' USING DFHEIV0,
  8214           FILE-ID-ERACCT2,
  8215           DFHEIV11,
  8216           DFHEIV99
  8217     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8218
  8219
  8220     IF PI-ACCT-LOW-EFF-DT NOT = LOW-VALUES
  8221        GO TO 1790-EXIT.
  8222
  8223     IF PI-MAP-NAME NOT = EL930B
  8224        GO TO 1785-SET-CANCEL-CONTROL.
  8225
  8226     IF CARR-GROUP-ST-ACCNT-CNTL
  8227         MOVE -1                     TO BCAR-LEN
  8228         MOVE AL-UABON               TO BCAR-ATTRB
  8229                                        BGRP-ATTRB
  8230                                        BST-ATTRB
  8231                                        BACCT-ATTRB
  8232     ELSE
  8233         IF ST-ACCNT-CNTL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 163
* EL9301.cbl
  8234             MOVE -1                 TO BST-LEN
  8235             MOVE AL-UABON           TO BST-ATTRB
  8236                                        BACCT-ATTRB
  8237         ELSE
  8238             IF CARR-ST-ACCNT-CNTL
  8239                 MOVE -1             TO BCAR-LEN
  8240                 MOVE AL-UABON       TO BCAR-ATTRB
  8241                                        BST-ATTRB
  8242                                        BACCT-ATTRB
  8243             ELSE
  8244                 IF ACCNT-CNTL
  8245                     MOVE -1         TO BACCT-LEN
  8246                     MOVE AL-UABON   TO BACCT-ATTRB
  8247                 ELSE
  8248                     MOVE -1         TO BCAR-LEN
  8249                     MOVE AL-UABON   TO BCAR-ATTRB
  8250                                        BACCT-ATTRB.
  8251
  8252     MOVE ER-2210                TO EMI-ERROR.
  8253
  8254     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8255
  8256     GO TO 8200-SEND-DATAONLY.
  8257
  8258 1785-SET-CANCEL-CONTROL.
  8259
  8260     IF CARR-GROUP-ST-ACCNT-CNTL
  8261         MOVE -1                     TO CCAR-LEN       (WS-SUB2)
  8262         MOVE AL-UABON               TO CCAR-ATTRB     (WS-SUB2)
  8263                                        CGRP-ATTRB     (WS-SUB2)
  8264                                        CST-ATTRB      (WS-SUB2)
  8265                                        CACCT-ATTRB (WS-SUB2)
  8266     ELSE
  8267         IF ST-ACCNT-CNTL
  8268             MOVE -1                 TO CST-LEN        (WS-SUB2)
  8269             MOVE AL-UABON           TO CST-ATTRB      (WS-SUB2)
  8270                                        CACCT-ATTRB (WS-SUB2)
  8271         ELSE
  8272             IF CARR-ST-ACCNT-CNTL
  8273                 MOVE -1             TO CCAR-LEN       (WS-SUB2)
  8274                 MOVE AL-UABON       TO CCAR-ATTRB     (WS-SUB2)
  8275                                        CST-ATTRB      (WS-SUB2)
  8276                                        CACCT-ATTRB (WS-SUB2)
  8277             ELSE
  8278                 IF ACCNT-CNTL
  8279                     MOVE -1         TO CACCT-LEN      (WS-SUB2)
  8280                     MOVE AL-UABON   TO CACCT-ATTRB (WS-SUB2)
  8281                 ELSE
  8282                     MOVE -1         TO CCAR-LEN     (WS-SUB2)
  8283                     MOVE AL-UABON   TO CCAR-ATTRB     (WS-SUB2)
  8284                                        CACCT-ATTRB (WS-SUB2).
  8285
  8286     MOVE ER-2210                TO EMI-ERROR.
  8287
  8288     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8289
  8290     GO TO 8200-SEND-DATAONLY.
  8291
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 164
* EL9301.cbl
  8292 1790-EXIT.
  8293
  8294     EXIT.
  8295
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 165
* EL9301.cbl
  8297
  8298******************************************************************
  8299*                                                                *
  8300*                   B R O W S E   F O R W A R D                  *
  8301*                                                                *
  8302******************************************************************
  8303
  8304 2000-BROWSE-FWD.
  8305
  8306     MOVE LOW-VALUES             TO DATA-ENTRY-MAP.
  8307
  8308     ADD +1                      TO PI-SAV-BATCH-SEQ.
  8309
  8310
  8311* EXEC CICS HANDLE CONDITION
  8312*        NOTFND (2020-END-FILE)
  8313*        END-EXEC.
  8314*    MOVE '"$I                   ! '' #00008144' TO DFHEIV0
  8315     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8316     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8317     MOVE X'2720233030303038313434' TO DFHEIV0(25:11)
  8318     CALL 'kxdfhei1' USING DFHEIV0
  8319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8320
  8321
  8322
  8323* EXEC CICS READ
  8324*        SET     (ERPNDT-POINTER)
  8325*        DATASET (FILE-ID-ERPNDT)
  8326*        RIDFLD  (PI-SAV-ENDING-ERPNDT-KEY)
  8327*        GTEQ
  8328*        END-EXEC.
  8329*    MOVE '&"S        G          (   #00008148' TO DFHEIV0
  8330     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8331     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8332     MOVE X'2020233030303038313438' TO DFHEIV0(25:11)
  8333     CALL 'kxdfhei1' USING DFHEIV0,
  8334           FILE-ID-ERPNDT,
  8335           ERPNDT-POINTER,
  8336           DFHEIV99,
  8337           PI-SAV-ENDING-ERPNDT-KEY,
  8338           DFHEIV99,
  8339           DFHEIV99,
  8340           DFHEIV99
  8341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8342
  8343
  8344     SERVICE RELOAD PENDING-BUSINESS.
  8345
  8346     IF PB-COMPANY-CD = PI-SAV-COMP-CD
  8347       AND PB-ENTRY-BATCH = PI-SAV-ENTRY-BATCH
  8348         NEXT SENTENCE
  8349     ELSE
  8350         GO TO 2020-END-FILE.
  8351
  8352     IF PB-BATCH-TRAILER
  8353         GO TO 2020-END-FILE.
  8354
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 166
* EL9301.cbl
  8355     MOVE PB-BATCH-SEQ-NO        TO PI-SAV-BATCH-SEQ.
  8356
  8357     IF PB-ISSUE
  8358         MOVE EL930B             TO PI-MAP-NAME
  8359         MOVE AL-SANOF           TO BDELHDGA
  8360         PERFORM 7000-FORMAT-ISSUE-SCREEN THRU 7090-EXIT
  8361     ELSE
  8362         MOVE EL930C             TO PI-MAP-NAME
  8363         MOVE AL-SANOF           TO CDELHDGA
  8364         PERFORM 7100-FORMAT-CANCEL-SCREEN THRU 7190-EXIT.
  8365
  8366 2010-SEND-MAP.
  8367
  8368     GO TO 8100-SEND-INITIAL-MAP.
  8369
  8370 2020-END-FILE.
  8371
  8372     MOVE SPACE                  TO PI-DISPLAY-SW.
  8373
  8374     IF PI-MAP-NAME = EL930B
  8375         MOVE LOW-VALUES         TO DATA-ENTRY-MAP
  8376         MOVE -1                 TO BPFENTRL
  8377         ADD +1, PI-LAST-SEQ-NO-ADDED
  8378               GIVING PI-NEXT-DISPLAY-SEQ-NO
  8379         PERFORM 8550-SET-MAP-SEQ-NOS
  8380     ELSE
  8381         MOVE LOW-VALUES         TO DATA-ENTRY-MAP
  8382         MOVE -1                 TO CPFENTRL
  8383         ADD +1, PI-LAST-SEQ-NO-ADDED
  8384               GIVING PI-NEXT-DISPLAY-SEQ-NO
  8385         PERFORM 8550-SET-MAP-SEQ-NOS
  8386                 VARYING WS-SUB2 FROM +1 BY +1
  8387                 UNTIL WS-SUB2 GREATER THAN +2.
  8388
  8389     MOVE ER-2217                TO EMI-ERROR.
  8390     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8391     GO TO 2010-SEND-MAP.
  8392
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 167
* EL9301.cbl
  8394
  8395******************************************************************
  8396*                                                                *
  8397*                B R O W S E   B A C K W A R D                   *
  8398*                                                                *
  8399******************************************************************
  8400
  8401 2100-BROWSE-BKWD.
  8402
  8403     MOVE LOW-VALUES             TO DATA-ENTRY-MAP.
  8404
  8405     SUBTRACT +1             FROM PI-SAV-BATCH-SEQ.
  8406
  8407     IF PI-SAV-BATCH-SEQ NOT GREATER THAN +0
  8408         GO TO 2120-END-FILE.
  8409
  8410
  8411* EXEC CICS HANDLE CONDITION
  8412*        NOTFND (2100-BROWSE-BKWD)
  8413*        END-EXEC.
  8414*    MOVE '"$I                   ! ( #00008221' TO DFHEIV0
  8415     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8416     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8417     MOVE X'2820233030303038323231' TO DFHEIV0(25:11)
  8418     CALL 'kxdfhei1' USING DFHEIV0
  8419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8420
  8421
  8422
  8423* EXEC CICS READ
  8424*        SET     (ERPNDT-POINTER)
  8425*        DATASET (FILE-ID-ERPNDT)
  8426*        RIDFLD  (PI-SAV-ENDING-ERPNDT-KEY)
  8427*        END-EXEC.
  8428*    MOVE '&"S        E          (   #00008225' TO DFHEIV0
  8429     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8430     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8431     MOVE X'2020233030303038323235' TO DFHEIV0(25:11)
  8432     CALL 'kxdfhei1' USING DFHEIV0,
  8433           FILE-ID-ERPNDT,
  8434           ERPNDT-POINTER,
  8435           DFHEIV99,
  8436           PI-SAV-ENDING-ERPNDT-KEY,
  8437           DFHEIV99,
  8438           DFHEIV99,
  8439           DFHEIV99
  8440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8441
  8442
  8443     SERVICE RELOAD PENDING-BUSINESS.
  8444
  8445     IF PB-COMPANY-CD     = PI-SAV-COMP-CD
  8446       AND PB-ENTRY-BATCH = PI-SAV-ENTRY-BATCH
  8447         NEXT SENTENCE
  8448     ELSE
  8449         GO TO 2120-END-FILE.
  8450
  8451     IF PB-BATCH-TRAILER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 168
* EL9301.cbl
  8452         GO TO 2120-END-FILE.
  8453
  8454     IF PB-ISSUE
  8455         MOVE EL930B             TO PI-MAP-NAME
  8456         MOVE AL-SANOF           TO BDELHDGA
  8457         PERFORM 7000-FORMAT-ISSUE-SCREEN THRU 7090-EXIT
  8458     ELSE
  8459         MOVE EL930C             TO PI-MAP-NAME
  8460         MOVE AL-SANOF           TO CDELHDGA
  8461         PERFORM 7100-FORMAT-CANCEL-SCREEN THRU 7190-EXIT.
  8462
  8463 2110-SEND-MAP.
  8464     GO TO 8100-SEND-INITIAL-MAP.
  8465
  8466 2120-END-FILE.
  8467
  8468     MOVE ER-2431                TO EMI-ERROR.
  8469     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8470     MOVE ER-0000                TO EMI-ERROR.
  8471     MOVE ZEROS                  TO PI-SAV-BATCH-SEQ.
  8472     GO TO 2000-BROWSE-FWD.
  8473
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 169
* EL9301.cbl
  8475
  8476******************************************************************
  8477*                                                                *
  8478*            C O N T I U E   B A T C H   E N T R Y               *
  8479*                                                                *
  8480******************************************************************
  8481
  8482 3000-CONTINUE-ENTRY.
  8483
  8484     MOVE PI-SAV-ENDING-ERPNDT-KEY TO ERPNDT-KEY.
  8485
  8486
  8487* EXEC CICS HANDLE CONDITION
  8488*        NOTFND (3300-REC-NOT-FND)
  8489*        END-EXEC.
  8490*    MOVE '"$I                   ! ) #00008274' TO DFHEIV0
  8491     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8492     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8493     MOVE X'2920233030303038323734' TO DFHEIV0(25:11)
  8494     CALL 'kxdfhei1' USING DFHEIV0
  8495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8496
  8497
  8498
  8499* EXEC CICS STARTBR
  8500*        DATASET (FILE-ID-ERPNDT)
  8501*        RIDFLD  (ERPNDT-KEY)
  8502*        GTEQ
  8503*        END-EXEC.
  8504     MOVE 0
  8505       TO DFHEIV11
  8506*    MOVE '&,         G          &   #00008278' TO DFHEIV0
  8507     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  8508     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8509     MOVE X'2020233030303038323738' TO DFHEIV0(25:11)
  8510     CALL 'kxdfhei1' USING DFHEIV0,
  8511           FILE-ID-ERPNDT,
  8512           ERPNDT-KEY,
  8513           DFHEIV99,
  8514           DFHEIV11,
  8515           DFHEIV99
  8516     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8517
  8518
  8519 3100-READ-LOOP.
  8520
  8521
  8522* EXEC CICS HANDLE CONDITION
  8523*        ENDFILE (3200-END-BROWSE)
  8524*        END-EXEC.
  8525*    MOVE '"$''                   ! * #00008286' TO DFHEIV0
  8526     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  8527     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8528     MOVE X'2A20233030303038323836' TO DFHEIV0(25:11)
  8529     CALL 'kxdfhei1' USING DFHEIV0
  8530     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8531
  8532
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 170
* EL9301.cbl
  8533
  8534* EXEC CICS READNEXT
  8535*        SET     (ERPNDT-POINTER)
  8536*        DATASET (FILE-ID-ERPNDT)
  8537*        RIDFLD  (ERPNDT-KEY)
  8538*        END-EXEC.
  8539     MOVE 0
  8540       TO DFHEIV11
  8541*    MOVE '&.S                   )   #00008290' TO DFHEIV0
  8542     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8543     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8544     MOVE X'2020233030303038323930' TO DFHEIV0(25:11)
  8545     CALL 'kxdfhei1' USING DFHEIV0,
  8546           FILE-ID-ERPNDT,
  8547           ERPNDT-POINTER,
  8548           DFHEIV99,
  8549           ERPNDT-KEY,
  8550           DFHEIV99,
  8551           DFHEIV11,
  8552           DFHEIV99,
  8553           DFHEIV99
  8554     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8555
  8556
  8557     SERVICE RELOAD PENDING-BUSINESS.
  8558
  8559     IF PB-COMPANY-CD     = PI-SAV-COMP-CD
  8560       AND PB-ENTRY-BATCH = PI-SAV-ENTRY-BATCH
  8561         NEXT SENTENCE
  8562     ELSE
  8563         GO TO 3200-END-BROWSE.
  8564
  8565     IF NOT PB-BATCH-TRAILER
  8566         GO TO 3110-NOT-BATCH-TRAILER.
  8567
  8568 3105-PRIME-PI-COUNTS.
  8569
  8570     IF PI-LF-ISS-REMITTED = ZEROS
  8571         MOVE PB-B-LF-ISS-PRM-REMITTED  TO PI-LF-ISS-REMITTED.
  8572
  8573     IF PI-AH-ISS-REMITTED = ZEROS
  8574         MOVE PB-B-AH-ISS-PRM-REMITTED  TO PI-AH-ISS-REMITTED.
  8575
  8576     IF PI-ISS-CNT-REMITTED = ZEROS
  8577         MOVE PB-B-ISSUE-CNT-REMITTED   TO PI-ISS-CNT-REMITTED.
  8578
  8579     IF PI-CAN-CNT-REMITTED = ZEROS
  8580         MOVE PB-B-CANCEL-CNT-REMITTED  TO PI-CAN-CNT-REMITTED.
  8581
  8582     IF PI-LF-CAN-REMITTED = ZEROS
  8583         MOVE PB-B-LF-CAN-PRM-REMITTED  TO PI-LF-CAN-REMITTED.
  8584
  8585     IF PI-AH-CAN-REMITTED = ZEROS
  8586         MOVE PB-B-AH-CAN-PRM-REMITTED  TO PI-AH-CAN-REMITTED.
  8587
  8588     GO TO 3200-END-BROWSE.
  8589
  8590 3110-NOT-BATCH-TRAILER.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 171
* EL9301.cbl
  8591
  8592     IF PB-ISSUE
  8593         ADD PB-I-LF-PREMIUM-AMT     TO PI-LF-ISS-ENTERED
  8594         ADD PB-I-LF-ALT-PREMIUM-AMT TO PI-LF-ISS-ENTERED
  8595         ADD PB-I-AH-PREMIUM-AMT     TO PI-AH-ISS-ENTERED
  8596         ADD +1                      TO PI-ISS-CNT-ENTERED
  8597     ELSE
  8598         ADD PB-C-LF-CANCEL-AMT      TO PI-LF-CAN-ENTERED
  8599         ADD PB-C-AH-CANCEL-AMT      TO PI-AH-CAN-ENTERED
  8600         ADD +1                      TO PI-CAN-CNT-ENTERED.
  8601     MOVE PB-BATCH-SEQ-NO            TO PI-LAST-SEQ-NO-ADDED
  8602                                        PI-SAV-BATCH-SEQ.
  8603     GO TO 3100-READ-LOOP.
  8604
  8605 3200-END-BROWSE.
  8606
  8607
  8608* EXEC CICS ENDBR
  8609*        DATASET (FILE-ID-ERPNDT)
  8610*        END-EXEC.
  8611     MOVE 0
  8612       TO DFHEIV11
  8613*    MOVE '&2                    $   #00008346' TO DFHEIV0
  8614     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8615     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8616     MOVE X'2020233030303038333436' TO DFHEIV0(25:11)
  8617     CALL 'kxdfhei1' USING DFHEIV0,
  8618           FILE-ID-ERPNDT,
  8619           DFHEIV11,
  8620           DFHEIV99
  8621     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8622
  8623
  8624     ADD +1, PI-LAST-SEQ-NO-ADDED
  8625                            GIVING PI-NEXT-DISPLAY-SEQ-NO.
  8626
  8627     IF PI-MAINT-FUNC = 'B'
  8628         MOVE ZEROS              TO PI-SAV-BATCH-SEQ
  8629         GO TO 2000-BROWSE-FWD
  8630     ELSE
  8631         ADD +1                  TO PI-SAV-BATCH-SEQ.
  8632
  8633     IF PI-LF-ISS-REMITTED = ZEROS
  8634       AND PI-AH-ISS-REMITTED = ZEROS
  8635       AND PI-LF-CAN-REMITTED = ZEROS
  8636       AND PI-AH-CAN-REMITTED = ZEROS
  8637       AND PI-ISS-CNT-REMITTED = ZEROS
  8638       AND PI-CAN-CNT-REMITTED = ZEROS
  8639         MOVE  EL930B            TO PI-MAP-NAME
  8640     ELSE
  8641         IF PI-LF-ISS-REMITTED = ZEROS
  8642           AND PI-AH-ISS-REMITTED = ZEROS
  8643           AND PI-ISS-CNT-REMITTED = ZEROS
  8644             MOVE  EL930C        TO PI-MAP-NAME
  8645         ELSE
  8646             MOVE  EL930B        TO PI-MAP-NAME.
  8647
  8648     IF PI-MAP-NAME = EL930B
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 172
* EL9301.cbl
  8649         PERFORM 8550-SET-MAP-SEQ-NOS
  8650     ELSE
  8651         PERFORM 8550-SET-MAP-SEQ-NOS
  8652                 VARYING WS-SUB2 FROM +1 BY +1
  8653                 UNTIL WS-SUB2 GREATER THAN +2.
  8654
  8655     GO TO 8100-SEND-INITIAL-MAP.
  8656
  8657 3300-REC-NOT-FND.
  8658
  8659     MOVE ER-2212                TO EMI-ERROR.
  8660     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8661     GO TO 8100-SEND-INITIAL-MAP.
  8662
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 173
* EL9301.cbl
  8664
  8665******************************************************************
  8666*                                                                *
  8667*            B U I L D   I S S U E   R E C O R D                 *
  8668*                                                                *
  8669******************************************************************
  8670
  8671 4000-BUILD-ISSUE-RECORD.
  8672
  8673     IF BSEQ   GREATER THAN PI-LAST-SEQ-NO-ADDED
  8674         GO TO 4100-ADD-ISSUE-RECORD.
  8675
  8676******************************************************************
  8677*                                                                *
  8678*   THE DATA ENTRY SYSTEM ALLOWS BROWSING OF THE CURRENT BUS.    *
  8679*   FILE. THE DATA ENTRY SYS. DOES NOT HAVE A MAINT. FUNCTION.   *
  8680*   THE PROGRAM ASSUMES THAT IF A MATCH ON THE READ FOR UPDATE   *
  8681*   IS SUCCESSFUL, THE RECORD HAS PREVIOUSLY BEEN DISPLAYED      *
  8682*   THRUOUGH A BROWSE.  CHANGES ARE APPLIED AND THE PB-RECORD IS *
  8683*   REWRITTEN, ELSE A NEW PENDING BUS. RECORD IS ADDED.          *
  8684*                                                                *
  8685******************************************************************
  8686
  8687     MOVE PI-COMPANY-CD          TO ERPNDT-COMP-CD.
  8688     MOVE PI-SAV-ENTRY-BATCH     TO ERPNDT-ENTRY-BATCH.
  8689     MOVE BSEQ                   TO ERPNDT-BATCH-SEQ.
  8690
  8691
  8692* EXEC CICS HANDLE CONDITION
  8693*        NOTFND (4100-ADD-ISSUE-RECORD)
  8694*        END-EXEC.
  8695*    MOVE '"$I                   ! + #00008417' TO DFHEIV0
  8696     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  8697     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8698     MOVE X'2B20233030303038343137' TO DFHEIV0(25:11)
  8699     CALL 'kxdfhei1' USING DFHEIV0
  8700     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8701
  8702
  8703
  8704* EXEC CICS READ
  8705*        SET     (ERPNDT-POINTER)
  8706*        DATASET (FILE-ID-ERPNDT)
  8707*        RIDFLD  (ERPNDT-KEY)
  8708*        UPDATE
  8709*        END-EXEC.
  8710*    MOVE '&"S        EU         (   #00008421' TO DFHEIV0
  8711     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8712     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8713     MOVE X'2020233030303038343231' TO DFHEIV0(25:11)
  8714     CALL 'kxdfhei1' USING DFHEIV0,
  8715           FILE-ID-ERPNDT,
  8716           ERPNDT-POINTER,
  8717           DFHEIV99,
  8718           ERPNDT-KEY,
  8719           DFHEIV99,
  8720           DFHEIV99,
  8721           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 174
* EL9301.cbl
  8722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8723
  8724
  8725     SERVICE RELOAD PENDING-BUSINESS.
  8726
  8727     MOVE PB-CONTROL-PRIMARY     TO ERPNDM-KEY.
  8728
  8729     MOVE 'B'                    TO JP-RECORD-TYPE
  8730     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  8731     MOVE ERPNDT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  8732     MOVE FILE-ID-ERPNDT         TO JP-FILE-ID.
  8733     PERFORM 8400-LOG-JOURNAL-RECORD.
  8734
  8735     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  8736     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  8737     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
  8738
  8739     IF BLAST-NAME-LEN      GREATER THAN ZEROS
  8740         MOVE BLAST-NAME         TO PB-I-INSURED-LAST-NAME.
  8741
  8742     IF B1ST-NAME-LEN       GREATER THAN ZEROS
  8743         MOVE B1ST-NAME          TO PB-I-INSURED-FIRST-NAME.
  8744
  8745     IF BINIT-LEN           GREATER THAN ZEROS
  8746         MOVE BINIT              TO PB-I-INSURED-MIDDLE-INIT.
  8747
  8748     IF BAGE-LEN            GREATER THAN ZEROS
  8749         MOVE WS-BAGE            TO PB-I-AGE.
  8750
  8751     IF BJNT-AGE-LEN        GREATER THAN ZEROS
  8752         MOVE WS-BJNT-AGE        TO PB-I-JOINT-AGE.
  8753
  8754     IF BBIRTH-LEN          GREATER THAN ZEROS
  8755         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY.
  8756
  8757     IF BSEX-LEN            GREATER THAN ZEROS
  8758         MOVE BSEX               TO PB-I-INSURED-SEX.
  8759
  8760     IF BTERM-LEN  (1)      GREATER THAN ZEROS
  8761        MOVE WS-BTERM (1)        TO PB-I-LF-TERM.
  8762
  8763     IF BTERM-LEN  (2)      GREATER THAN ZEROS
  8764        MOVE WS-BTERM (2)         TO PB-I-AH-TERM.
  8765
  8766     IF BLN-TERM-LEN        GREATER THAN ZEROS
  8767         MOVE WS-BLN-TERM        TO PB-I-LOAN-TERM.
  8768
  8769     IF BFREQ-LEN           GREATER THAN ZEROS
  8770         MOVE WS-BFREQ           TO PB-I-PAY-FREQUENCY.
  8771
  8772     IF BSKPCD-LEN          GREATER THAN ZEROS
  8773         MOVE BSKPCD             TO PB-I-SKIP-CODE.
  8774
  8775     IF BMODE-LEN           GREATER THAN ZEROS
  8776         MOVE BMODE              TO PB-I-TERM-TYPE.
  8777
  8778     IF BPMTS-LEN           GREATER THAN ZEROS
  8779         MOVE WS-BPMTS           TO PB-I-NO-OF-PAYMENTS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 175
* EL9301.cbl
  8780
  8781     IF BPOLICY-LEN         GREATER THAN ZEROS
  8782         MOVE BPOLICY            TO PB-I-POLICY-FORM-NO.
  8783
  8784******************************************************************
  8785*          IF BTYPE = ZEROS DELETE LIFE COVERAGE.                *
  8786*                                                                *
  8787*          IF BTYPE = SPACES ZERO OUT BENEFIT CODE.              *
  8788******************************************************************
  8789
  8790     IF BTYPE-LEN     (1)   GREATER THAN ZEROS
  8791        IF BTYPE      (1)   NOT = SPACES AND ZEROS
  8792           MOVE BTYPE (1)         TO PB-I-LF-INPUT-CD
  8793           MOVE WS-EDITED-LF-CODE TO PB-I-LIFE-BENEFIT-CD
  8794           MOVE WS-LF-ABBR-DESC   TO PB-I-LF-ABBR
  8795        ELSE
  8796           IF BTYPE   (1) = SPACES
  8797              MOVE SPACES         TO PB-I-LF-INPUT-CD
  8798                                     PB-I-LF-ABBR
  8799              MOVE ZEROS          TO PB-I-LIFE-BENEFIT-CD
  8800           ELSE
  8801              SUBTRACT PB-I-LF-PREMIUM-AMT FROM PI-LF-ISS-ENTERED
  8802              SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM
  8803                       PI-LF-ISS-ENTERED
  8804              MOVE SPACES         TO PB-I-LF-INPUT-CD
  8805                                     PB-I-LF-ABBR
  8806              MOVE ZEROS          TO PB-I-LF-TERM
  8807                                     PB-I-LF-BENEFIT-AMT
  8808                                     PB-I-LF-PREMIUM-AMT
  8809                                     PB-I-LF-BENEFIT-CD
  8810                                     PB-I-LF-PREM-CALC
  8811                                     PB-I-LF-ALT-BENEFIT-AMT
  8812                                     PB-I-LF-ALT-PREMIUM-AMT
  8813                                     PB-I-LF-CRIT-PER
  8814              MOVE LOW-VALUES     TO PB-I-LF-EXPIRE-DT.
  8815
  8816     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
  8817         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT.
  8818
  8819     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
  8820         MOVE WS-BALT-BEN (1)       TO PB-I-LF-ALT-BENEFIT-AMT.
  8821
  8822     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
  8823         IF WS-BPREM   (1)  = WS-ALL-NINES OR
  8824            WS-BPREM   (1)  GREATER THAN WS-ALL-NINES
  8825            SUBTRACT PB-I-LF-PREMIUM-AMT FROM PI-LF-ISS-ENTERED
  8826            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
  8827            MOVE '?'             TO PB-I-LF-CALC-FLAG
  8828         ELSE
  8829            SUBTRACT PB-I-LF-PREMIUM-AMT FROM PI-LF-ISS-ENTERED
  8830            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
  8831            ADD  WS-BPREM (1)    TO PI-LF-ISS-ENTERED
  8832            MOVE SPACE           TO PB-I-LF-CALC-FLAG.
  8833
  8834     IF  BALT-PREM-LEN     (1) GREATER THAN ZEROS
  8835         SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM PI-LF-ISS-ENTERED
  8836         MOVE WS-BALT-PREM (1)   TO PB-I-LF-ALT-PREMIUM-AMT
  8837         ADD  WS-BALT-PREM (1)   TO PI-LF-ISS-ENTERED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 176
* EL9301.cbl
  8838
  8839******************************************************************
  8840*          IF BTYPE = ZEROS DELETE A&H COVERAGE.                 *
  8841*                                                                *
  8842*          IF BTYPE = SPACES ZERO OUT BENEFIT CODE.              *
  8843******************************************************************
  8844
  8845     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
  8846        IF BTYPE      (2)   NOT = SPACES AND ZEROS
  8847           MOVE BTYPE (2)         TO PB-I-AH-INPUT-CD
  8848           MOVE WS-EDITED-AH-CODE TO PB-I-AH-BENEFIT-CD
  8849           MOVE WS-AH-ABBR-DESC   TO PB-I-AH-ABBR
  8850        ELSE
  8851           IF BTYPE   (2) = SPACES
  8852              MOVE SPACES         TO PB-I-AH-INPUT-CD
  8853                                     PB-I-AH-ABBR
  8854              MOVE ZEROS          TO PB-I-AH-BENEFIT-CD
  8855           ELSE
  8856              SUBTRACT PB-I-AH-PREMIUM-AMT FROM PI-AH-ISS-ENTERED
  8857              MOVE SPACES         TO PB-I-AH-INPUT-CD
  8858                                     PB-I-AH-ABBR
  8859              MOVE ZEROS          TO PB-I-AH-TERM
  8860                                     PB-I-AH-BENEFIT-AMT
  8861                                     PB-I-AH-PREMIUM-AMT
  8862                                     PB-I-AH-BENEFIT-CD
  8863                                     PB-I-AH-PREM-CALC
  8864                                     PB-I-AH-CRIT-PER
  8865              MOVE LOW-VALUES     TO PB-I-AH-EXPIRE-DT.
  8866
  8867     IF  BBEN-LEN      (2)  GREATER THAN ZEROS
  8868         MOVE WS-BBEN  (2)       TO PB-I-AH-BENEFIT-AMT.
  8869
  8870
  8871     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
  8872         IF WS-BPREM   (2)  = WS-ALL-NINES OR
  8873            WS-BPREM   (2)  GREATER THAN WS-ALL-NINES
  8874            SUBTRACT PB-I-AH-PREMIUM-AMT FROM PI-AH-ISS-ENTERED
  8875            MOVE ZEROS              TO PB-I-AH-PREMIUM-AMT
  8876            MOVE '?'                TO PB-I-AH-CALC-FLAG
  8877         ELSE
  8878            SUBTRACT PB-I-AH-PREMIUM-AMT FROM PI-AH-ISS-ENTERED
  8879            MOVE WS-BPREM (2)    TO PB-I-AH-PREMIUM-AMT
  8880            ADD  WS-BPREM (2)    TO PI-AH-ISS-ENTERED
  8881            MOVE SPACE           TO PB-I-AH-CALC-FLAG.
  8882
  8883     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
  8884        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER.
  8885
  8886     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
  8887        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER.
  8888
  8889     IF BIND-GRP-LEN        GREATER THAN ZEROS
  8890         MOVE BIND-GRP           TO PB-I-INDV-GRP-OVRD.
  8891
  8892     IF BRTCLS-LEN          GREATER THAN ZEROS
  8893         MOVE BRTCLS             TO PB-I-RATE-CLASS-OVRD.
  8894
  8895     IF BSIG-LEN            GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 177
* EL9301.cbl
  8896         MOVE BSIG               TO PB-I-SIG-SW.
  8897
  8898     IF BAPR-LEN            GREATER THAN ZEROS
  8899         MOVE WS-BAPR            TO PB-I-LOAN-APR.
  8900
  8901     IF BSSNUM-LEN          GREATER THAN ZEROS
  8902         MOVE BSSNUM             TO PB-I-SOC-SEC-NO.
  8903
  8904     IF BMEM-NO-LEN         GREATER THAN ZEROS
  8905         MOVE BMEM-NO        TO PB-I-MEMBER-NO.
  8906
  8907     IF BLN-OFFICER-LEN     GREATER THAN ZEROS
  8908         MOVE BLN-OFFICER        TO PB-I-LOAN-OFFICER.
  8909
  8910     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
  8911        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT.
  8912
  8913     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
  8914        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT.
  8915
  8916     IF B1ST-PMT-LEN        GREATER THAN ZEROS
  8917        MOVE WS-CONVERTED-1ST-PMT-DT TO  PB-I-1ST-PMT-DT.
  8918
  8919     IF BDAYS-LEN           GREATER THAN ZEROS
  8920        MOVE WS-BDAYS            TO PB-I-TERM-IN-DAYS
  8921                                    PB-I-EXTENTION-DAYS.
  8922
  8923     IF BRINCD-LEN               GREATER THAN ZEROS
  8924        MOVE BRINCD              TO PB-I-SPECIAL-REIN-CODE.
  8925
  8926     IF BENTRY-LEN   NOT = ZEROS
  8927        IF BENTRY = 'E' OR 'R' OR 'P'
  8928           MOVE BENTRY           TO PB-BATCH-ENTRY
  8929     ELSE
  8930        IF BENTRY = 'H'
  8931           MOVE BENTRY           TO PB-RECORD-BILL
  8932        ELSE
  8933           MOVE BENTRY           TO PB-FORCE-CODE.
  8934
  8935     IF BLIVES-LEN          GREATER THAN ZEROS
  8936        MOVE WS-BLIVES           TO PB-I-LIVES.
  8937
  8938     IF BJNT-1ST-NAME-LEN   GREATER THAN ZEROS
  8939         MOVE BJNT-1ST-NAME      TO PB-I-JOINT-FIRST-NAME.
  8940
  8941     IF BJNT-INIT-LEN       GREATER THAN ZEROS
  8942         MOVE BJNT-INIT          TO PB-I-JOINT-MIDDLE-INIT.
  8943
  8944     IF BJNT-LST-NAME-LEN   GREATER THAN ZEROS
  8945         MOVE BJNT-LST-NAME      TO PB-I-JOINT-LAST-NAME.
  8946
  8947     IF BBENEFICIARY-LEN    GREATER THAN ZEROS
  8948         MOVE BBENEFICIARY       TO PB-I-BENEFICIARY-NAME.
  8949
  8950     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
  8951     MOVE PI-AH-OVERRIDE-L1      TO PB-LIFE-OVERRIDE-L1.
  8952
  8953     IF PI-MAIL-YES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 178
* EL9301.cbl
  8954        MOVE '1'                 TO PB-I-MAIL-ADDRS-SW.
  8955
  8956     MOVE 'C'                    TO JP-RECORD-TYPE.
  8957     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  8958     MOVE ERPNDT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  8959
  8960
  8961* EXEC CICS REWRITE
  8962*        DATASET (FILE-ID-ERPNDT)
  8963*        FROM    (PENDING-BUSINESS)
  8964*        END-EXEC.
  8965     MOVE LENGTH OF
  8966      PENDING-BUSINESS
  8967       TO DFHEIV11
  8968*    MOVE '&& L                  %   #00008663' TO DFHEIV0
  8969     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8970     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8971     MOVE X'2020233030303038363633' TO DFHEIV0(25:11)
  8972     CALL 'kxdfhei1' USING DFHEIV0,
  8973           FILE-ID-ERPNDT,
  8974           PENDING-BUSINESS,
  8975           DFHEIV11,
  8976           DFHEIV99
  8977     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8978
  8979
  8980     MOVE ERPNDT-KEY             TO PI-SAV-ENDING-ERPNDT-KEY.
  8981
  8982     PERFORM 8400-LOG-JOURNAL-RECORD.
  8983
  8984     IF EIBAID = DFHENTER
  8985         MOVE PI-NEXT-DISPLAY-SEQ-NO TO BSEQ
  8986         ADD +1                      TO PI-NEXT-DISPLAY-SEQ-NO
  8987         MOVE AL-SABON               TO BSEQ-ATTRB.
  8988
  8989     IF PI-MAIL-YES
  8990        NEXT SENTENCE
  8991     ELSE
  8992        GO TO 4900-EXIT.
  8993
  8994     IF BLAST-NAME-LEN = ZEROS AND
  8995        B1ST-NAME-LEN  = ZEROS AND
  8996        BINIT-LEN      = ZEROS AND
  8997        BADDRS1-LEN    = ZEROS AND
  8998        BADDRS2-LEN    = ZEROS AND
  8999        BCITYST-LEN    = ZEROS AND
  9000        BZIP5-LEN      = ZEROS AND
  9001        BZIP4-LEN      = ZEROS AND
  9002        BPHONE-LEN     = ZEROS AND
  9003        BSSNUM-LEN     = ZEROS
  9004        GO TO 4900-EXIT.
  9005
  9006
  9007* EXEC CICS HANDLE CONDITION
  9008*        NOTFND (4185-ADD-MAILING-RECORD)
  9009*        END-EXEC.
  9010*    MOVE '"$I                   ! , #00008694' TO DFHEIV0
  9011     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 179
* EL9301.cbl
  9012     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9013     MOVE X'2C20233030303038363934' TO DFHEIV0(25:11)
  9014     CALL 'kxdfhei1' USING DFHEIV0
  9015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9016
  9017
  9018
  9019* EXEC CICS READ
  9020*        SET     (ERPNDM-POINTER)
  9021*        DATASET (FILE-ID-ERPNDM)
  9022*        RIDFLD  (ERPNDM-KEY)
  9023*        UPDATE
  9024*        END-EXEC.
  9025*    MOVE '&"S        EU         (   #00008698' TO DFHEIV0
  9026     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9027     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9028     MOVE X'2020233030303038363938' TO DFHEIV0(25:11)
  9029     CALL 'kxdfhei1' USING DFHEIV0,
  9030           FILE-ID-ERPNDM,
  9031           ERPNDM-POINTER,
  9032           DFHEIV99,
  9033           ERPNDM-KEY,
  9034           DFHEIV99,
  9035           DFHEIV99,
  9036           DFHEIV99
  9037     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9038
  9039
  9040     SERVICE RELOAD PENDING-MAILING-DATA.
  9041
  9042     MOVE 'B'                    TO JP-RECORD-TYPE.
  9043     MOVE PENDING-MAILING-DATA   TO JP-RECORD-AREA.
  9044     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9045     MOVE FILE-ID-ERPNDM         TO JP-FILE-ID.
  9046     PERFORM 8400-LOG-JOURNAL-RECORD.
  9047
  9048     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY.
  9049     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
  9050     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT.
  9051
  9052     IF BLAST-NAME-LEN      GREATER THAN ZEROS
  9053         MOVE BLAST-NAME         TO PM-INSURED-LAST-NAME.
  9054
  9055     IF B1ST-NAME-LEN       GREATER THAN ZEROS
  9056         MOVE B1ST-NAME          TO PM-INSURED-FIRST-NAME.
  9057
  9058     IF BINIT-LEN           GREATER THAN ZEROS
  9059         MOVE BINIT              TO PM-INSURED-MIDDLE-INIT.
  9060
  9061     IF BAGE-LEN            GREATER THAN ZEROS
  9062         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE.
  9063
  9064     IF BBIRTH-LEN          GREATER THAN ZEROS
  9065        MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT.
  9066
  9067     IF BLAST-NAME-LEN      GREATER THAN ZEROS
  9068         MOVE BLAST-NAME         TO PM-INSURED-LAST-NAME.
  9069
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 180
* EL9301.cbl
  9070     IF BINIT-LEN           GREATER THAN ZEROS
  9071         MOVE BINIT              TO PM-INSURED-MIDDLE-INIT.
  9072
  9073     IF BADDRS1-LEN         GREATER THAN ZERO
  9074         MOVE BADDRS1            TO PM-ADDRESS-LINE-1.
  9075
  9076     IF BADDRS2-LEN         GREATER THAN ZERO
  9077         MOVE BADDRS2            TO PM-ADDRESS-LINE-2.
  9078
  9079     IF BCITYST-LEN         GREATER THAN ZERO
  9080         MOVE BCITYST            TO PM-CITY-STATE.
  9081
  9082     IF BZIP5-LEN           GREATER THAN ZERO
  9083         MOVE BZIP5              TO W-TEST-ZIP
  9084
  9085         IF  W-CANADIAN-POST-CODE
  9086             MOVE BZIP5          TO PM-CAN-POST1
  9087
  9088         ELSE
  9089             MOVE BZIP5          TO PM-ZIP-CODE.
  9090
  9091
  9092     IF BZIP4-LEN           GREATER THAN ZERO
  9093
  9094         IF  PM-CANADIAN-POST-CODE
  9095             MOVE BZIP4          TO PM-CAN-POST2
  9096
  9097         ELSE
  9098             MOVE BZIP4          TO PM-ZIP-PLUS4.
  9099
  9100     IF BPHONE-LEN          GREATER THAN ZERO
  9101         MOVE WS-BPHONE          TO PM-PHONE-NO.
  9102
  9103     IF BSSNUM-LEN          GREATER THAN ZEROS
  9104         MOVE BSSNUM             TO PM-INSURED-SOC-SEC-NO.
  9105
  9106     MOVE 'C'                    TO JP-RECORD-TYPE.
  9107     MOVE PENDING-MAILING-DATA   TO JP-RECORD-AREA.
  9108     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9109     MOVE FILE-ID-ERPNDM         TO JP-FILE-ID.
  9110
  9111
  9112* EXEC CICS REWRITE
  9113*        DATASET (FILE-ID-ERPNDM)
  9114*        FROM    (PENDING-MAILING-DATA)
  9115*        END-EXEC.
  9116     MOVE LENGTH OF
  9117      PENDING-MAILING-DATA
  9118       TO DFHEIV11
  9119*    MOVE '&& L                  %   #00008776' TO DFHEIV0
  9120     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9121     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9122     MOVE X'2020233030303038373736' TO DFHEIV0(25:11)
  9123     CALL 'kxdfhei1' USING DFHEIV0,
  9124           FILE-ID-ERPNDM,
  9125           PENDING-MAILING-DATA,
  9126           DFHEIV11,
  9127           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 181
* EL9301.cbl
  9128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9129
  9130
  9131     PERFORM 8400-LOG-JOURNAL-RECORD.
  9132
  9133     GO TO 4900-EXIT.
  9134
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 182
* EL9301.cbl
  9136
  9137******************************************************************
  9138*                                                                *
  9139*               A D D  I S S U E   R E C O R D                   *
  9140*                                                                *
  9141******************************************************************
  9142
  9143 4100-ADD-ISSUE-RECORD.
  9144
  9145
  9146* EXEC CICS GETMAIN
  9147*        SET     (ERPNDT-POINTER)
  9148*        LENGTH  (ERPNDT-RECORD-LENGTH)
  9149*        INITIMG (GETMAIN-SPACE)
  9150*        END-EXEC.
  9151*    MOVE ',"IL                  $   #00008795' TO DFHEIV0
  9152     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9153     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9154     MOVE X'2020233030303038373935' TO DFHEIV0(25:11)
  9155     CALL 'kxdfhei1' USING DFHEIV0,
  9156           ERPNDT-POINTER,
  9157           ERPNDT-RECORD-LENGTH,
  9158           GETMAIN-SPACE
  9159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9160
  9161
  9162     SERVICE RELOAD PENDING-BUSINESS.
  9163
  9164     MOVE 'PB'                   TO PB-RECORD-ID.
  9165     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD
  9166                                    PB-COMPANY-CD-A1.
  9167     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
  9168     MOVE PI-SAV-ENTRY-BATCH     TO PB-ENTRY-BATCH.
  9169     MOVE BSEQ                   TO PB-BATCH-SEQ-NO.
  9170
  9171     IF BSEQ   GREATER THAN PI-LAST-SEQ-NO-ADDED
  9172         MOVE BSEQ          TO PI-LAST-SEQ-NO-ADDED.
  9173
  9174     IF BCAR-LEN GREATER THAN ZEROS
  9175        MOVE BCAR                TO PB-CARRIER.
  9176
  9177     IF BGRP-LEN GREATER THAN ZEROS
  9178        MOVE BGRP                TO PB-GROUPING.
  9179
  9180     IF BST-LEN  GREATER THAN ZEROS
  9181        MOVE BST                 TO PB-STATE.
  9182
  9183     IF BACCT-LEN GREATER THAN ZEROS
  9184        MOVE BACCT               TO PB-ACCOUNT.
  9185
  9186     MOVE '1'                    TO PB-RECORD-TYPE.
  9187     MOVE BCERT                  TO PB-CERT-PRIME.
  9188     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
  9189     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
  9190                                    PB-ALT-CHG-SEQ-NO.
  9191
  9192     MOVE ZEROS                  TO PB-I-LOAN-TERM
  9193                                    PB-I-LF-PREM-CALC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 183
* EL9301.cbl
  9194                                    PB-I-LF-ALT-PREM-CALC
  9195                                    PB-I-LF-RATE
  9196                                    PB-I-LF-ALT-RATE
  9197                                    PB-I-LF-REI-RATE
  9198                                    PB-I-LF-ALT-REI-RATE
  9199                                    PB-I-RATE-DEV-PCT-LF
  9200                                    PB-I-AH-PREM-CALC
  9201                                    PB-I-AH-RATE
  9202                                    PB-I-AH-REI-RATE
  9203                                    PB-I-AH-RATE-TRM
  9204                                    PB-I-RATE-DEV-PCT-AH
  9205                                    PB-I-BUSINESS-TYPE
  9206                                    PB-I-LIFE-COMMISSION
  9207                                    PB-I-JOINT-COMMISSION
  9208                                    PB-I-AH-COMMISSION
  9209                                    PB-I-CURR-SEQ
  9210                                    PB-CHG-COUNT
  9211                                    PB-LF-BILLED-AMTS
  9212                                    PB-AH-BILLED-AMTS
  9213                                    PB-CALC-TOLERANCE
  9214                                    PB-I-EXTENTION-DAYS
  9215                                    PB-I-TERM-IN-DAYS.
  9216
  9217     MOVE LOW-VALUES             TO PB-CREDIT-ACCEPT-DT
  9218                                    PB-I-LF-EXPIRE-DT
  9219                                    PB-I-AH-EXPIRE-DT
  9220                                    PB-I-1ST-PMT-DT
  9221                                    PB-BILLED-DT
  9222                                    PB-ACCT-EFF-DT
  9223                                    PB-ACCT-EXP-DT.
  9224
  9225
  9226     MOVE 'X'                    TO PB-FATAL-FLAG.
  9227
  9228     IF PI-MAIL-YES
  9229        MOVE '1'                 TO PB-I-MAIL-ADDRS-SW.
  9230
  9231     IF PI-NB-MONTH-END-DT NOT = SPACES
  9232        MOVE PI-NB-MONTH-END-DT  TO PB-CREDIT-SELECT-DT
  9233       ELSE
  9234        MOVE PI-CR-MONTH-END-DT     TO PB-CREDIT-SELECT-DT.
  9235
  9236     IF BSFX-LEN            GREATER THAN ZEROS
  9237         MOVE BSFX               TO PB-CERT-SFX.
  9238
  9239     IF BLAST-NAME-LEN      GREATER THAN ZEROS
  9240         MOVE BLAST-NAME         TO PB-I-INSURED-LAST-NAME.
  9241
  9242     IF B1ST-NAME-LEN       GREATER THAN ZEROS
  9243         MOVE B1ST-NAME          TO PB-I-INSURED-FIRST-NAME.
  9244
  9245     IF BINIT-LEN           GREATER THAN ZEROS
  9246         MOVE BINIT              TO PB-I-INSURED-MIDDLE-INIT.
  9247
  9248     IF BAGE-LEN            GREATER THAN ZEROS
  9249         MOVE WS-BAGE            TO PB-I-AGE
  9250     ELSE
  9251         MOVE ZEROS              TO PB-I-AGE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 184
* EL9301.cbl
  9252
  9253
  9254     IF BJNT-AGE-LEN        GREATER THAN ZEROS
  9255         MOVE WS-BJNT-AGE        TO PB-I-JOINT-AGE
  9256     ELSE
  9257         MOVE ZEROS              TO PB-I-JOINT-AGE.
  9258
  9259     IF BBIRTH-LEN          GREATER THAN ZEROS
  9260         MOVE WS-CONVERTED-BIRTH TO PB-I-BIRTHDAY
  9261     ELSE
  9262         MOVE LOW-VALUES          TO PB-I-BIRTHDAY.
  9263
  9264     IF BSEX-LEN            GREATER THAN ZEROS
  9265         MOVE BSEX               TO PB-I-INSURED-SEX.
  9266
  9267     IF BTERM-LEN  (1)      GREATER THAN ZEROS
  9268        MOVE WS-BTERM (1)           TO PB-I-LF-TERM
  9269     ELSE
  9270        MOVE ZEROS               TO PB-I-LF-TERM.
  9271
  9272     IF BTERM-LEN  (2)      GREATER THAN ZEROS
  9273        MOVE WS-BTERM (2)           TO PB-I-AH-TERM
  9274     ELSE
  9275        MOVE ZEROS              TO PB-I-AH-TERM.
  9276
  9277     IF BLN-TERM-LEN        GREATER THAN ZEROS
  9278         MOVE WS-BLN-TERM        TO PB-I-LOAN-TERM
  9279     ELSE
  9280         MOVE ZEROS              TO PB-I-LOAN-TERM.
  9281
  9282     IF BFREQ-LEN           GREATER THAN ZEROS
  9283         MOVE WS-BFREQ           TO PB-I-PAY-FREQUENCY
  9284     ELSE
  9285         MOVE ZEROS              TO PB-I-PAY-FREQUENCY.
  9286
  9287     IF BSKPCD-LEN          GREATER THAN ZEROS
  9288         MOVE BSKPCD             TO PB-I-SKIP-CODE.
  9289
  9290     IF BMODE-LEN           GREATER THAN ZEROS
  9291         MOVE BMODE              TO PB-I-TERM-TYPE.
  9292
  9293     IF BPMTS-LEN           GREATER THAN ZEROS
  9294         MOVE WS-BPMTS           TO PB-I-NO-OF-PAYMENTS
  9295     ELSE
  9296         MOVE ZEROS              TO PB-I-NO-OF-PAYMENTS.
  9297
  9298     IF BPOLICY-LEN         GREATER THAN ZEROS
  9299         MOVE BPOLICY            TO PB-I-POLICY-FORM-NO.
  9300
  9301     IF BTYPE-LEN     (1)   GREATER THAN ZEROS
  9302        IF BTYPE      (1)   NOT = ZEROS  AND  SPACES
  9303           MOVE BTYPE (1)         TO PB-I-LF-INPUT-CD
  9304           MOVE WS-EDITED-LF-CODE TO PB-I-LIFE-BENEFIT-CD
  9305           MOVE WS-LF-ABBR-DESC  TO PB-I-LF-ABBR
  9306        ELSE
  9307           MOVE ZEROS             TO PB-I-LIFE-BENEFIT-CD
  9308     ELSE
  9309           MOVE ZEROS             TO PB-I-LIFE-BENEFIT-CD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 185
* EL9301.cbl
  9310
  9311     IF  BBEN-LEN      (1)  GREATER THAN ZEROS
  9312         MOVE WS-BBEN  (1)       TO PB-I-LF-BENEFIT-AMT
  9313     ELSE
  9314         MOVE ZEROS              TO PB-I-LF-BENEFIT-AMT.
  9315
  9316     IF  BALT-BEN-LEN     (1)  GREATER THAN ZEROS
  9317         MOVE WS-BALT-BEN (1)    TO PB-I-LF-ALT-BENEFIT-AMT
  9318     ELSE
  9319         MOVE ZEROS              TO PB-I-LF-ALT-BENEFIT-AMT.
  9320
  9321     IF  BPREM-LEN     (1)  GREATER THAN ZEROS
  9322         IF WS-BPREM   (1) = WS-ALL-NINES OR
  9323            WS-BPREM   (1) GREATER THAN WS-ALL-NINES
  9324            MOVE ZEROS           TO PB-I-LF-PREMIUM-AMT
  9325            MOVE '?'             TO PB-I-LF-CALC-FLAG
  9326         ELSE
  9327            ADD  WS-BPREM (1)    TO PI-LF-ISS-ENTERED
  9328            MOVE WS-BPREM (1)    TO PB-I-LF-PREMIUM-AMT
  9329     ELSE
  9330         MOVE ZEROS              TO PB-I-LF-PREMIUM-AMT.
  9331
  9332     IF  BALT-PREM-LEN     (1) GREATER THAN ZEROS
  9333         MOVE WS-BALT-PREM (1)   TO PB-I-LF-ALT-PREMIUM-AMT
  9334         ADD  WS-BALT-PREM (1)   TO PI-LF-ISS-ENTERED
  9335     ELSE
  9336         MOVE ZEROS              TO PB-I-LF-ALT-PREMIUM-AMT.
  9337
  9338     IF BTYPE-LEN     (2)   GREATER THAN ZEROS
  9339        IF BTYPE      (2)   NOT = ZEROS  AND  SPACES
  9340           MOVE BTYPE (2)         TO PB-I-AH-INPUT-CD
  9341           MOVE WS-EDITED-AH-CODE TO PB-I-AH-BENEFIT-CD
  9342           MOVE WS-AH-ABBR-DESC   TO PB-I-AH-ABBR
  9343        ELSE
  9344           MOVE ZEROS             TO PB-I-AH-BENEFIT-CD
  9345     ELSE
  9346           MOVE ZEROS             TO PB-I-AH-BENEFIT-CD.
  9347
  9348     IF  BBEN-LEN         (2)  GREATER THAN ZEROS
  9349         MOVE WS-BBEN     (2)    TO PB-I-AH-BENEFIT-AMT
  9350     ELSE
  9351         MOVE ZEROS              TO PB-I-AH-BENEFIT-AMT.
  9352
  9353
  9354     IF  BPREM-LEN     (2)  GREATER THAN ZEROS
  9355         IF WS-BPREM   (2) = WS-ALL-NINES OR
  9356            WS-BPREM   (2) GREATER THAN WS-ALL-NINES
  9357            MOVE ZEROS            TO PB-I-AH-PREMIUM-AMT
  9358            MOVE '?'              TO PB-I-AH-CALC-FLAG
  9359         ELSE
  9360            ADD  WS-BPREM (2)     TO PI-AH-ISS-ENTERED
  9361            MOVE WS-BPREM (2)     TO PB-I-AH-PREMIUM-AMT
  9362     ELSE
  9363         MOVE ZEROS               TO PB-I-AH-PREMIUM-AMT.
  9364
  9365     IF BCRIT-PERD-LEN      (1)   GREATER THAN ZEROS
  9366        MOVE WS-BCRIT-PERD  (1)   TO PB-I-LF-CRIT-PER
  9367     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 186
* EL9301.cbl
  9368        MOVE ZEROS                TO PB-I-LF-CRIT-PER.
  9369
  9370     IF BCRIT-PERD-LEN      (2)   GREATER THAN ZEROS
  9371        MOVE WS-BCRIT-PERD  (2)   TO PB-I-AH-CRIT-PER
  9372     ELSE
  9373        MOVE ZEROS                TO PB-I-AH-CRIT-PER.
  9374     IF BIND-GRP-LEN        GREATER THAN ZEROS
  9375         MOVE BIND-GRP           TO PB-I-INDV-GRP-OVRD.
  9376
  9377     IF BRTCLS-LEN          GREATER THAN ZEROS
  9378         MOVE BRTCLS             TO PB-I-RATE-CLASS-OVRD.
  9379
  9380     IF BSIG-LEN            GREATER THAN ZEROS
  9381         MOVE BSIG               TO PB-I-SIG-SW.
  9382
  9383     IF BAPR-LEN            GREATER THAN ZEROS
  9384         MOVE WS-BAPR            TO PB-I-LOAN-APR
  9385     ELSE
  9386         MOVE ZEROS              TO PB-I-LOAN-APR.
  9387
  9388     IF BSSNUM-LEN          GREATER THAN ZEROS
  9389         MOVE BSSNUM             TO PB-I-SOC-SEC-NO.
  9390
  9391     IF BMEM-NO-LEN         GREATER THAN ZEROS
  9392         MOVE BMEM-NO        TO PB-I-MEMBER-NO.
  9393
  9394     IF BLN-OFFICER-LEN     GREATER THAN ZEROS
  9395         MOVE BLN-OFFICER        TO PB-I-LOAN-OFFICER.
  9396
  9397     IF BEXPIRE-LEN    (1)  GREATER THAN ZEROS
  9398        MOVE WS-CONVERTED-EXPIRDT (1) TO PB-I-LF-EXPIRE-DT
  9399     ELSE
  9400        MOVE LOW-VALUES               TO PB-I-LF-EXPIRE-DT.
  9401
  9402     IF BEXPIRE-LEN    (2)  GREATER THAN ZEROS
  9403        MOVE WS-CONVERTED-EXPIRDT (2) TO PB-I-AH-EXPIRE-DT
  9404     ELSE
  9405        MOVE LOW-VALUES               TO PB-I-AH-EXPIRE-DT.
  9406
  9407     IF B1ST-PMT-LEN        GREATER THAN ZEROS
  9408        MOVE WS-CONVERTED-1ST-PMT-DT TO  PB-I-1ST-PMT-DT.
  9409
  9410     IF BDAYS-LEN           GREATER THAN ZEROS
  9411        MOVE WS-BDAYS            TO PB-I-TERM-IN-DAYS
  9412                                    PB-I-EXTENTION-DAYS
  9413     ELSE
  9414        MOVE ZEROS               TO PB-I-TERM-IN-DAYS
  9415                                    PB-I-EXTENTION-DAYS.
  9416
  9417     IF BRINCD-LEN               GREATER THAN ZEROS
  9418        MOVE BRINCD              TO PB-I-SPECIAL-REIN-CODE.
  9419
  9420     IF BENTRY-LEN   NOT = ZEROS
  9421        IF BENTRY = 'E' OR 'R' OR 'P'
  9422           MOVE BENTRY           TO PB-BATCH-ENTRY
  9423     ELSE
  9424        IF BENTRY = 'H'
  9425           MOVE BENTRY           TO PB-RECORD-BILL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 187
* EL9301.cbl
  9426        ELSE
  9427           MOVE BENTRY           TO PB-FORCE-CODE.
  9428
  9429     IF BLIVES-LEN          GREATER THAN ZEROS
  9430        MOVE WS-BLIVES           TO PB-I-LIVES
  9431     ELSE
  9432        MOVE ZEROS               TO PB-I-LIVES.
  9433
  9434     IF BJNT-1ST-NAME-LEN   GREATER THAN ZEROS
  9435         MOVE BJNT-1ST-NAME      TO PB-I-JOINT-FIRST-NAME.
  9436
  9437     IF BJNT-INIT-LEN       GREATER THAN ZEROS
  9438         MOVE BJNT-INIT          TO PB-I-JOINT-MIDDLE-INIT.
  9439
  9440     IF BJNT-LST-NAME-LEN   GREATER THAN ZEROS
  9441         MOVE BJNT-LST-NAME      TO PB-I-JOINT-LAST-NAME.
  9442
  9443     IF BBENEFICIARY-LEN    GREATER THAN ZEROS
  9444         MOVE BBENEFICIARY       TO PB-I-BENEFICIARY-NAME.
  9445
  9446     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
  9447     MOVE PI-AH-OVERRIDE-L1      TO PB-LIFE-OVERRIDE-L1.
  9448
  9449
  9450 4175-WRITE-PB-RECORD.
  9451
  9452     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
  9453                                    PB-INPUT-BY.
  9454     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  9455     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
  9456                                    PB-INPUT-DT.
  9457     MOVE 'A'                    TO JP-RECORD-TYPE.
  9458     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  9459     MOVE PB-CONTROL-PRIMARY     TO PI-SAV-ENDING-ERPNDT-KEY
  9460                                    ERPNDM-KEY.
  9461
  9462     ADD +1                      TO PI-SAV-BATCH-SEQ.
  9463
  9464
  9465* EXEC CICS HANDLE CONDITION
  9466*        DUPREC (4200-DUPLICATE-ALT-INDEX)
  9467*        END-EXEC.
  9468*    MOVE '"$%                   ! - #00009103' TO DFHEIV0
  9469     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
  9470     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9471     MOVE X'2D20233030303039313033' TO DFHEIV0(25:11)
  9472     CALL 'kxdfhei1' USING DFHEIV0
  9473     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9474
  9475
  9476
  9477* EXEC CICS WRITE
  9478*        DATASET (FILE-ID-ERPNDT)
  9479*        FROM    (PENDING-BUSINESS)
  9480*        RIDFLD  (PB-CONTROL-PRIMARY)
  9481*        END-EXEC.
  9482     MOVE LENGTH OF
  9483      PENDING-BUSINESS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 188
* EL9301.cbl
  9484       TO DFHEIV11
  9485*    MOVE '&$ L                  ''   #00009107' TO DFHEIV0
  9486     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9487     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9488     MOVE X'2020233030303039313037' TO DFHEIV0(25:11)
  9489     CALL 'kxdfhei1' USING DFHEIV0,
  9490           FILE-ID-ERPNDT,
  9491           PENDING-BUSINESS,
  9492           DFHEIV11,
  9493           PB-CONTROL-PRIMARY,
  9494           DFHEIV99,
  9495           DFHEIV99
  9496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9497
  9498
  9499     ADD +1                      TO PI-ISS-CNT-ENTERED.
  9500
  9501     MOVE ERPNDT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9502     MOVE FILE-ID-ERPNDT         TO JP-FILE-ID.
  9503     PERFORM 8400-LOG-JOURNAL-RECORD.
  9504
  9505     MOVE PI-NEXT-DISPLAY-SEQ-NO TO BSEQ.
  9506     MOVE AL-SABON               TO BSEQ-ATTRB.
  9507
  9508     ADD +1                      TO PI-NEXT-DISPLAY-SEQ-NO.
  9509
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 189
* EL9301.cbl
  9511
  9512******************************************************************
  9513*                                                                *
  9514*    CHECK THE FIRST ISSUE RECORD IN EVERY NEW BATCH.  VERIFY    *
  9515*    THAT THE CERTIFICATE DOES NOT EXIST ON THE CERT. MASTER     *
  9516*    FILE.  IF IT DOES DISPLAY WARNING MESSAGE ON BLANK SCREEN.  *
  9517*                                                                *
  9518******************************************************************
  9519
  9520
  9521     IF  PI-MAINT-FUNC = 'N' NEXT SENTENCE
  9522        ELSE
  9523         GO TO 4185-ADD-MAILING-RECORD.
  9524
  9525     IF  PI-ISSUE-ADDED
  9526         GO TO 4185-ADD-MAILING-RECORD.
  9527
  9528     MOVE 'Y'                    TO  PI-ISSUE-ADDED-SW.
  9529
  9530
  9531* EXEC CICS HANDLE CONDITION
  9532*        NOTFND (4185-ADD-MAILING-RECORD)
  9533*        END-EXEC.
  9534*    MOVE '"$I                   ! . #00009144' TO DFHEIV0
  9535     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9536     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9537     MOVE X'2E20233030303039313434' TO DFHEIV0(25:11)
  9538     CALL 'kxdfhei1' USING DFHEIV0
  9539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9540
  9541
  9542     MOVE PB-CONTROL-BY-ACCOUNT  TO  ELCERT-KEY.
  9543
  9544
  9545* EXEC CICS READ
  9546*        SET     (ELCERT-POINTER)
  9547*        DATASET (FILE-ID-ELCERT)
  9548*        RIDFLD  (ELCERT-KEY)
  9549*        LENGTH  (ELCERT-RECORD-LENGTH)
  9550*        UPDATE
  9551*        END-EXEC.
  9552*    MOVE '&"SL       EU         (   #00009150' TO DFHEIV0
  9553     MOVE X'2622534C2020202020202045' TO DFHEIV0(1:12)
  9554     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9555     MOVE X'2020233030303039313530' TO DFHEIV0(25:11)
  9556     CALL 'kxdfhei1' USING DFHEIV0,
  9557           FILE-ID-ELCERT,
  9558           ELCERT-POINTER,
  9559           ELCERT-RECORD-LENGTH,
  9560           ELCERT-KEY,
  9561           DFHEIV99,
  9562           DFHEIV99,
  9563           DFHEIV99
  9564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9565
  9566
  9567     SERVICE RELOAD CERTIFICATE-MASTER.
  9568
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 190
* EL9301.cbl
  9569     IF  CERT-WAS-CREATED-FOR-CLAIM
  9570         GO TO 4185-ADD-MAILING-RECORD.
  9571
  9572     GO TO 8350-SEND-WARNING.
  9573
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 191
* EL9301.cbl
  9575
  9576******************************************************************
  9577*                                                                *
  9578*          A D D   M A I L I N G   R E C O R D                   *
  9579*                                                                *
  9580******************************************************************
  9581
  9582 4185-ADD-MAILING-RECORD.
  9583
  9584     IF PI-MAIL-YES
  9585        NEXT SENTENCE
  9586     ELSE
  9587        GO TO 4900-EXIT.
  9588
  9589
  9590* EXEC CICS GETMAIN
  9591*        SET     (ERPNDM-POINTER)
  9592*        LENGTH  (ERPNDM-RECORD-LENGTH)
  9593*        INITIMG (GETMAIN-SPACE)
  9594*        END-EXEC.
  9595*    MOVE ',"IL                  $   #00009180' TO DFHEIV0
  9596     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9597     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9598     MOVE X'2020233030303039313830' TO DFHEIV0(25:11)
  9599     CALL 'kxdfhei1' USING DFHEIV0,
  9600           ERPNDM-POINTER,
  9601           ERPNDM-RECORD-LENGTH,
  9602           GETMAIN-SPACE
  9603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9604
  9605
  9606     SERVICE RELOAD PENDING-MAILING-DATA.
  9607
  9608     MOVE 'PM'                   TO PM-RECORD-ID.
  9609     MOVE 'ER'                   TO PM-SOURCE-SYSTEM.
  9610
  9611     MOVE PI-PROCESSOR-ID        TO PM-LAST-MAINT-BY
  9612                                    PM-RECORD-ADDED-BY.
  9613     MOVE EIBTIME                TO PM-LAST-MAINT-HHMMSS.
  9614     MOVE WS-CURRENT-BIN-DT      TO PM-LAST-MAINT-DT
  9615                                    PM-RECORD-ADD-DT.
  9616
  9617     MOVE ERPNDM-KEY             TO PM-CONTROL-PRIMARY.
  9618
  9619     IF BLAST-NAME-LEN      GREATER THAN ZEROS
  9620         MOVE BLAST-NAME         TO PM-INSURED-LAST-NAME.
  9621
  9622     IF B1ST-NAME-LEN       GREATER THAN ZEROS
  9623         MOVE B1ST-NAME          TO PM-INSURED-FIRST-NAME.
  9624
  9625     IF BINIT-LEN           GREATER THAN ZEROS
  9626         MOVE BINIT              TO PM-INSURED-MIDDLE-INIT.
  9627
  9628
  9629     IF BAGE-LEN            GREATER THAN ZEROS
  9630         MOVE WS-BAGE            TO PM-INSURED-ISSUE-AGE
  9631     ELSE
  9632         MOVE ZEROS              TO PM-INSURED-ISSUE-AGE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 192
* EL9301.cbl
  9633
  9634     IF BBIRTH-LEN          GREATER THAN ZEROS
  9635        MOVE  WS-CONVERTED-BIRTH TO PM-INSURED-BIRTH-DT
  9636     ELSE
  9637        MOVE LOW-VALUES          TO PM-INSURED-BIRTH-DT.
  9638
  9639     IF BLAST-NAME-LEN      GREATER THAN ZEROS
  9640         MOVE BLAST-NAME         TO PM-INSURED-LAST-NAME.
  9641
  9642     IF BINIT-LEN           GREATER THAN ZEROS
  9643         MOVE BINIT              TO PM-INSURED-MIDDLE-INIT.
  9644
  9645     IF BADDRS1-LEN         GREATER THAN ZERO
  9646         MOVE BADDRS1            TO PM-ADDRESS-LINE-1.
  9647
  9648     IF BADDRS2-LEN         GREATER THAN ZERO
  9649         MOVE BADDRS2            TO PM-ADDRESS-LINE-2.
  9650
  9651     IF BCITYST-LEN         GREATER THAN ZERO
  9652         MOVE BCITYST            TO PM-CITY-STATE.
  9653
  9654     IF BZIP5-LEN           GREATER THAN ZERO
  9655         MOVE BZIP5              TO W-TEST-ZIP
  9656
  9657         IF  W-CANADIAN-POST-CODE
  9658             MOVE BZIP5          TO PM-CAN-POST1
  9659
  9660         ELSE
  9661             MOVE BZIP5          TO PM-ZIP-CODE.
  9662
  9663     IF BZIP4-LEN           GREATER THAN ZERO
  9664
  9665         IF  PM-CANADIAN-POST-CODE
  9666             MOVE BZIP4          TO PM-CAN-POST2
  9667
  9668         ELSE
  9669             MOVE BZIP4          TO PM-ZIP-PLUS4.
  9670
  9671     IF BPHONE-LEN          GREATER THAN ZERO
  9672         MOVE WS-BPHONE          TO PM-PHONE-NO
  9673     ELSE
  9674         MOVE ZEROS              TO PM-PHONE-NO.
  9675
  9676     IF BSSNUM-LEN          GREATER THAN ZEROS
  9677         MOVE BSSNUM             TO PM-INSURED-SOC-SEC-NO.
  9678
  9679     MOVE 'A'                    TO JP-RECORD-TYPE.
  9680     MOVE PENDING-MAILING-DATA   TO JP-RECORD-AREA.
  9681     MOVE ERPNDM-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9682     MOVE FILE-ID-ERPNDM         TO JP-FILE-ID.
  9683
  9684
  9685* EXEC CICS WRITE
  9686*        DATASET (FILE-ID-ERPNDM)
  9687*        FROM    (PENDING-MAILING-DATA)
  9688*        RIDFLD  (PM-CONTROL-PRIMARY)
  9689*        END-EXEC.
  9690     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 193
* EL9301.cbl
  9691      PENDING-MAILING-DATA
  9692       TO DFHEIV11
  9693*    MOVE '&$ L                  ''   #00009264' TO DFHEIV0
  9694     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  9695     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9696     MOVE X'2020233030303039323634' TO DFHEIV0(25:11)
  9697     CALL 'kxdfhei1' USING DFHEIV0,
  9698           FILE-ID-ERPNDM,
  9699           PENDING-MAILING-DATA,
  9700           DFHEIV11,
  9701           PM-CONTROL-PRIMARY,
  9702           DFHEIV99,
  9703           DFHEIV99
  9704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9705
  9706
  9707     PERFORM 8400-LOG-JOURNAL-RECORD.
  9708
  9709     MOVE LOW-VALUES             TO MAP-B.
  9710
  9711     GO TO 4900-EXIT.
  9712
  9713 4200-DUPLICATE-ALT-INDEX.
  9714
  9715     MOVE ER-2247                TO EMI-ERROR.
  9716     MOVE -1                     TO BCERT-LEN.
  9717     MOVE AL-UABON               TO BCERT-ATTRB.
  9718     MOVE AL-UNBON               TO BEFFDT-ATTRB.
  9719     MOVE 'Y'                    TO PI-ERROR-SW.
  9720
  9721     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9722
  9723     IF BPREM-LEN (1) GREATER THAN ZEROS
  9724         SUBTRACT WS-BPREM (1)
  9725                                 FROM PI-LF-ISS-ENTERED.
  9726
  9727     IF BALT-PREM-LEN (1) GREATER THAN ZEROS
  9728         SUBTRACT WS-BALT-PREM (1)
  9729                                 FROM PI-LF-ISS-ENTERED.
  9730
  9731     IF BPREM-LEN (2) GREATER THAN ZEROS
  9732         SUBTRACT WS-BPREM (2)
  9733                                 FROM PI-AH-ISS-ENTERED.
  9734
  9735     SUBTRACT +1                 FROM PI-LAST-SEQ-NO-ADDED.
  9736     SUBTRACT +1                 FROM PI-SAV-BATCH-SEQ.
  9737
  9738 4900-EXIT.
  9739     EXIT.
  9740
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 194
* EL9301.cbl
  9742
  9743******************************************************************
  9744*                                                                *
  9745*            B U I L D   C A N C E L   R E C O R D               *
  9746*                                                                *
  9747******************************************************************
  9748
  9749 5000-BUILD-CANCEL-RECORD.
  9750
  9751     IF CSEQ (WS-SUB2) GREATER THAN PI-LAST-SEQ-NO-ADDED
  9752         GO TO 5100-ADD-CANCEL-RECORD.
  9753
  9754******************************************************************
  9755*                                                                *
  9756*   THE DATA ENTRY SYSTEM ALLOWS BROWSING OF THE CURRENT BUS.    *
  9757*   FILE. THE DATA ENTRY SYS. DOES NOT HAVE A MAINT. FUNCTION.   *
  9758*   THE PROGRAM ASSUMES THAT IF A MATCH ON THE READ FOR UPDATE   *
  9759*   IS SUCCESSFUL, THE RECORD HAS PREVIOUSLY BEEN DISPLAYED      *
  9760*   THRUOUGH A BROWSE.  CHANGES ARE APPLIED AND THE PB-RECORD IS *
  9761*   REWRITEN, ELSE A NEW PB-RECORD IS ADDED.                     *
  9762*                                                                *
  9763******************************************************************
  9764
  9765     MOVE PI-COMPANY-CD          TO ERPNDT-COMP-CD.
  9766     MOVE PI-SAV-ENTRY-BATCH     TO ERPNDT-ENTRY-BATCH.
  9767     MOVE CSEQ (WS-SUB2)         TO ERPNDT-BATCH-SEQ.
  9768
  9769
  9770* EXEC CICS HANDLE CONDITION
  9771*        NOTFND (5100-ADD-CANCEL-RECORD)
  9772*        END-EXEC.
  9773*    MOVE '"$I                   ! / #00009332' TO DFHEIV0
  9774     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  9775     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9776     MOVE X'2F20233030303039333332' TO DFHEIV0(25:11)
  9777     CALL 'kxdfhei1' USING DFHEIV0
  9778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9779
  9780
  9781
  9782* EXEC CICS READ
  9783*        SET     (ERPNDT-POINTER)
  9784*        DATASET (FILE-ID-ERPNDT)
  9785*        RIDFLD  (ERPNDT-KEY)
  9786*        UPDATE
  9787*        END-EXEC.
  9788*    MOVE '&"S        EU         (   #00009336' TO DFHEIV0
  9789     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  9790     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  9791     MOVE X'2020233030303039333336' TO DFHEIV0(25:11)
  9792     CALL 'kxdfhei1' USING DFHEIV0,
  9793           FILE-ID-ERPNDT,
  9794           ERPNDT-POINTER,
  9795           DFHEIV99,
  9796           ERPNDT-KEY,
  9797           DFHEIV99,
  9798           DFHEIV99,
  9799           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 195
* EL9301.cbl
  9800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9801
  9802
  9803     SERVICE RELOAD PENDING-BUSINESS.
  9804
  9805     MOVE 'B'                    TO JP-RECORD-TYPE
  9806     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  9807     MOVE ERPNDT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9808     MOVE FILE-ID-ERPNDT         TO JP-FILE-ID.
  9809
  9810     PERFORM 8400-LOG-JOURNAL-RECORD.
  9811
  9812     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY.
  9813     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
  9814     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT.
  9815
  9816     IF CSFX-LEN  (WS-SUB2) GREATER THAN ZEROS
  9817        MOVE CSFX (WS-SUB2)      TO PB-CERT-SFX.
  9818
  9819     IF CLAST-NAME-LEN (WS-SUB2) GREATER THAN ZEROS
  9820         MOVE CLAST-NAME (WS-SUB2)  TO PB-C-LAST-NAME.
  9821
  9822     IF CREFUND1-LEN   (WS-SUB2) GREATER THAN ZEROS
  9823         IF WS-CREFUND1 (WS-SUB2) = WS-ALL-NINES OR
  9824            WS-CREFUND1 (WS-SUB2) GREATER THAN WS-ALL-NINES
  9825            SUBTRACT PB-C-LF-CANCEL-AMT FROM PI-LF-CAN-ENTERED
  9826            MOVE ZEROS            TO PB-C-LF-CANCEL-AMT
  9827            MOVE '?'              TO PB-C-LF-CALC-REQ
  9828         ELSE
  9829            SUBTRACT PB-C-LF-CANCEL-AMT FROM PI-LF-CAN-ENTERED
  9830            ADD WS-CREFUND1  (WS-SUB2) TO PI-LF-CAN-ENTERED
  9831            MOVE WS-CREFUND1 (WS-SUB2) TO PB-C-LF-CANCEL-AMT
  9832            MOVE SPACE                 TO PB-C-LF-CALC-REQ.
  9833
  9834     IF CREFUND2-LEN   (WS-SUB2) GREATER THAN ZEROS
  9835         IF WS-CREFUND2 (WS-SUB2) = WS-ALL-NINES OR
  9836            WS-CREFUND2 (WS-SUB2) GREATER THAN WS-ALL-NINES
  9837            SUBTRACT PB-C-AH-CANCEL-AMT FROM PI-AH-CAN-ENTERED
  9838            MOVE ZEROS            TO PB-C-AH-CANCEL-AMT
  9839            MOVE '?'              TO PB-C-AH-CALC-REQ
  9840         ELSE
  9841            SUBTRACT PB-C-AH-CANCEL-AMT FROM PI-AH-CAN-ENTERED
  9842            ADD WS-CREFUND2  (WS-SUB2) TO PI-AH-CAN-ENTERED
  9843            MOVE WS-CREFUND2 (WS-SUB2) TO PB-C-AH-CANCEL-AMT
  9844            MOVE SPACE                 TO PB-C-AH-CALC-REQ.
  9845
  9846******************************************************************
  9847*      IF CANCEL DATE = SPACES (LOW-VALUES) DELETE COVERAGE.     *
  9848******************************************************************
  9849
  9850     IF CCANDT1-LEN (WS-SUB2) GREATER THAN ZEROS
  9851        MOVE WS-CONVERTED-CANDT1 (WS-SUB2) TO PB-C-LF-CANCEL-DT
  9852        IF   WS-CONVERTED-CANDT1 (WS-SUB2) = LOW-VALUES
  9853             SUBTRACT PB-C-LF-CANCEL-AMT FROM PI-LF-CAN-ENTERED
  9854             MOVE ZEROS          TO PB-C-LF-REF-CALC
  9855                                    PB-C-LF-CANCEL-AMT.
  9856
  9857     IF CCANDT2-LEN (WS-SUB2) GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 196
* EL9301.cbl
  9858        MOVE WS-CONVERTED-CANDT2 (WS-SUB2) TO PB-C-AH-CANCEL-DT
  9859        IF   WS-CONVERTED-CANDT2 (WS-SUB2) = LOW-VALUES
  9860             SUBTRACT PB-C-AH-CANCEL-AMT FROM PI-AH-CAN-ENTERED
  9861             MOVE ZEROS          TO PB-C-AH-REF-CALC
  9862                                    PB-C-AH-CANCEL-AMT.
  9863
  9864     IF CLIVES-LEN  (WS-SUB2) GREATER THAN ZEROS
  9865        MOVE WS-CLIVES (WS-SUB2) TO PB-C-LIVES.
  9866
  9867     IF CPAYEE-LEN  (WS-SUB2) GREATER THAN ZEROS
  9868        MOVE CPAYEE (WS-SUB2)    TO PB-C-PAYEE-CODE.
  9869
  9870     IF CCHK-LEN    (WS-SUB2) GREATER THAN ZEROS
  9871        MOVE CCHK   (WS-SUB2)    TO PB-C-REFUND-SW.
  9872     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
  9873     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
  9874
  9875     MOVE 'C'                    TO JP-RECORD-TYPE.
  9876     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
  9877     MOVE ERPNDT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
  9878     MOVE FILE-ID-ERPNDT         TO JP-FILE-ID.
  9879
  9880
  9881* EXEC CICS REWRITE
  9882*        DATASET (FILE-ID-ERPNDT)
  9883*        FROM    (PENDING-BUSINESS)
  9884*        END-EXEC.
  9885     MOVE LENGTH OF
  9886      PENDING-BUSINESS
  9887       TO DFHEIV11
  9888*    MOVE '&& L                  %   #00009420' TO DFHEIV0
  9889     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  9890     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9891     MOVE X'2020233030303039343230' TO DFHEIV0(25:11)
  9892     CALL 'kxdfhei1' USING DFHEIV0,
  9893           FILE-ID-ERPNDT,
  9894           PENDING-BUSINESS,
  9895           DFHEIV11,
  9896           DFHEIV99
  9897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9898
  9899
  9900     MOVE ERPNDT-KEY             TO PI-SAV-ENDING-ERPNDT-KEY.
  9901
  9902     PERFORM 8400-LOG-JOURNAL-RECORD.
  9903
  9904     MOVE LOW-VALUES             TO DATA-AREA-C (WS-SUB2).
  9905
  9906     IF EIBAID = DFHENTER
  9907         MOVE PI-NEXT-DISPLAY-SEQ-NO TO CSEQ (WS-SUB2)
  9908         ADD +1 TO               PI-NEXT-DISPLAY-SEQ-NO
  9909         MOVE AL-SABON               TO CSEQ-ATTRB (WS-SUB2).
  9910
  9911     GO TO 5900-EXIT.
  9912
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 197
* EL9301.cbl
  9914
  9915******************************************************************
  9916*                                                                *
  9917*            B U I L D   C A N C E L   R E C O R D               *
  9918*                                                                *
  9919******************************************************************
  9920
  9921 5100-ADD-CANCEL-RECORD.
  9922
  9923
  9924* EXEC CICS GETMAIN
  9925*        SET     (ERPNDT-POINTER)
  9926*        LENGTH  (ERPNDT-RECORD-LENGTH)
  9927*        INITIMG (GETMAIN-SPACE)
  9928*        END-EXEC.
  9929*    MOVE ',"IL                  $   #00009448' TO DFHEIV0
  9930     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  9931     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  9932     MOVE X'2020233030303039343438' TO DFHEIV0(25:11)
  9933     CALL 'kxdfhei1' USING DFHEIV0,
  9934           ERPNDT-POINTER,
  9935           ERPNDT-RECORD-LENGTH,
  9936           GETMAIN-SPACE
  9937     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9938
  9939
  9940     SERVICE RELOAD PENDING-BUSINESS.
  9941
  9942     MOVE 'PB'                   TO PB-RECORD-ID.
  9943     MOVE PI-COMPANY-CD          TO PB-COMPANY-CD
  9944                                    PB-COMPANY-CD-A1.
  9945     MOVE PI-COMPANY-ID          TO PB-COMPANY-ID.
  9946     MOVE PI-SAV-ENTRY-BATCH     TO PB-ENTRY-BATCH.
  9947     MOVE CSEQ (WS-SUB2)            TO PB-BATCH-SEQ-NO.
  9948
  9949     IF CSEQ (WS-SUB2) GREATER THAN PI-LAST-SEQ-NO-ADDED
  9950        MOVE CSEQ (WS-SUB2)      TO PI-LAST-SEQ-NO-ADDED.
  9951
  9952     IF CCAR-LEN  (WS-SUB2) GREATER THAN ZEROS
  9953        MOVE CCAR (WS-SUB2)      TO PB-CARRIER.
  9954
  9955     IF CGRP-LEN  (WS-SUB2) GREATER THAN ZEROS
  9956        MOVE CGRP (WS-SUB2)      TO PB-GROUPING.
  9957
  9958     IF CST-LEN  (WS-SUB2) GREATER THAN ZEROS
  9959        MOVE CST (WS-SUB2)       TO PB-STATE.
  9960
  9961     IF CACCT-LEN     (WS-SUB2) GREATER THAN ZEROS
  9962        MOVE CACCT    (WS-SUB2)  TO PB-ACCOUNT.
  9963
  9964     MOVE '2'                    TO PB-RECORD-TYPE.
  9965     MOVE CCERT (WS-SUB2)        TO PB-CERT-PRIME.
  9966     MOVE WS-CONVERTED-EFFDT     TO PB-CERT-EFF-DT.
  9967
  9968     MOVE ZEROS                  TO PB-BATCH-CHG-SEQ-NO
  9969                                    PB-ALT-CHG-SEQ-NO.
  9970
  9971
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 198
* EL9301.cbl
  9972     MOVE ZEROS                  TO PB-C-LF-REF-CALC
  9973                                    PB-C-AH-REF-CALC
  9974                                    PB-CI-INSURED-AGE
  9975                                    PB-CI-LF-TERM
  9976                                    PB-CI-AH-TERM
  9977                                    PB-CI-LF-BENEFIT-CD
  9978                                    PB-CI-LF-BENEFIT-AMT
  9979                                    PB-CI-LF-ALT-BENEFIT-AMT
  9980                                    PB-CI-LF-PREMIUM-AMT
  9981                                    PB-CI-LF-ALT-PREMIUM-AMT
  9982                                    PB-CI-AH-BENEFIT-CD
  9983                                    PB-CI-AH-BENEFIT-AMT
  9984                                    PB-CI-AH-PREMIUM-AMT
  9985                                    PB-CI-PAY-FREQUENCY
  9986                                    PB-CI-LOAN-APR
  9987                                    PB-CI-LOAN-TERM
  9988                                    PB-CI-LIFE-COMMISSION
  9989                                    PB-CI-AH-COMMISSION
  9990                                    PB-CI-CURR-SEQ
  9991                                    PB-CI-AH-CANCEL-AMT
  9992                                    PB-CI-LF-CANCEL-AMT
  9993                                    PB-CI-RATE-DEV-PCT-LF
  9994                                    PB-CI-RATE-DEV-PCT-AH
  9995                                    PB-CI-EXTENTION-DAYS
  9996                                    PB-CI-TERM-IN-DAYS
  9997                                    PB-CI-LIVES
  9998                                    PB-CI-LF-CRIT-PER
  9999                                    PB-CI-AH-CRIT-PER
 10000                                    PB-C-LF-REM-TERM
 10001                                    PB-C-AH-REM-TERM
 10002                                    PB-CHG-COUNT
 10003                                    PB-LF-BILLED-AMTS
 10004                                    PB-AH-BILLED-AMTS
 10005                                    PB-CALC-TOLERANCE.
 10006
 10007     MOVE LOW-VALUES             TO PB-CI-AH-PAID-THRU-DT
 10008                                    PB-CI-AH-SETTLEMENT-DT
 10009                                    PB-CI-DEATH-DT
 10010                                    PB-CI-LF-PRIOR-CANCEL-DT
 10011                                    PB-CI-AH-PRIOR-CANCEL-DT
 10012                                    PB-CI-ENTRY-DT
 10013                                    PB-CI-LF-EXPIRE-DT
 10014                                    PB-CI-AH-EXPIRE-DT
 10015                                    PB-CI-LOAN-1ST-PMT-DT
 10016                                    PB-C-LF-CANCEL-DT
 10017                                    PB-C-AH-CANCEL-DT
 10018                                    PB-CREDIT-ACCEPT-DT
 10019                                    PB-BILLED-DT
 10020                                    PB-ACCT-EFF-DT
 10021                                    PB-ACCT-EXP-DT.
 10022
 10023     IF PI-NB-MONTH-END-DT NOT = SPACES
 10024        MOVE PI-NB-MONTH-END-DT  TO PB-CREDIT-SELECT-DT
 10025       ELSE
 10026        MOVE PI-CR-MONTH-END-DT  TO PB-CREDIT-SELECT-DT.
 10027
 10028     MOVE 'X'                    TO PB-FATAL-FLAG.
 10029
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 199
* EL9301.cbl
 10030
 10031     IF CSFX-LEN  (WS-SUB2) GREATER THAN ZEROS
 10032        MOVE CSFX (WS-SUB2)      TO PB-CERT-SFX.
 10033
 10034     IF CLAST-NAME-LEN (WS-SUB2) GREATER THAN ZEROS
 10035         MOVE CLAST-NAME (WS-SUB2)  TO PB-C-LAST-NAME.
 10036
 10037     IF CCANDT1-LEN (WS-SUB2) GREATER THAN ZEROS
 10038        MOVE WS-CONVERTED-CANDT1 (WS-SUB2) TO PB-C-LF-CANCEL-DT.
 10039
 10040     IF CCANDT2-LEN (WS-SUB2) GREATER THAN ZEROS
 10041        MOVE WS-CONVERTED-CANDT2 (WS-SUB2) TO PB-C-AH-CANCEL-DT.
 10042
 10043     IF CREFUND1-LEN   (WS-SUB2) GREATER THAN ZEROS
 10044         IF WS-CREFUND1 (WS-SUB2) = WS-ALL-NINES OR
 10045            WS-CREFUND1 (WS-SUB2) GREATER THAN WS-ALL-NINES
 10046            MOVE ZEROS            TO PB-C-LF-CANCEL-AMT
 10047            MOVE '?'              TO PB-C-LF-CALC-REQ
 10048         ELSE
 10049            ADD  WS-CREFUND1  (WS-SUB2) TO PI-LF-CAN-ENTERED
 10050            MOVE WS-CREFUND1  (WS-SUB2) TO PB-C-LF-CANCEL-AMT
 10051     ELSE
 10052         MOVE ZEROS            TO PB-C-LF-CANCEL-AMT.
 10053
 10054     IF CREFUND2-LEN   (WS-SUB2) GREATER THAN ZEROS
 10055         IF WS-CREFUND2 (WS-SUB2) = WS-ALL-NINES OR
 10056            WS-CREFUND2 (WS-SUB2) GREATER THAN WS-ALL-NINES
 10057            MOVE ZEROS            TO PB-C-AH-CANCEL-AMT
 10058            MOVE '?'              TO PB-C-AH-CALC-REQ
 10059         ELSE
 10060            ADD  WS-CREFUND2  (WS-SUB2) TO PI-AH-CAN-ENTERED
 10061            MOVE WS-CREFUND2  (WS-SUB2) TO PB-C-AH-CANCEL-AMT
 10062     ELSE
 10063         MOVE ZEROS              TO PB-C-AH-CANCEL-AMT.
 10064
 10065
 10066     IF CLIVES-LEN  (WS-SUB2) GREATER THAN ZEROS
 10067        MOVE WS-CLIVES (WS-SUB2) TO PB-C-LIVES
 10068     ELSE
 10069        MOVE ZEROS               TO PB-C-LIVES.
 10070
 10071     IF CPAYEE-LEN  (WS-SUB2) GREATER THAN ZEROS
 10072        MOVE CPAYEE (WS-SUB2)    TO PB-C-PAYEE-CODE.
 10073
 10074     IF CCHK-LEN    (WS-SUB2) GREATER THAN ZEROS
 10075        MOVE CCHK   (WS-SUB2)    TO PB-C-REFUND-SW.
 10076
 10077     MOVE PI-LIFE-OVERRIDE-L1    TO PB-LIFE-OVERRIDE-L1.
 10078     MOVE PI-AH-OVERRIDE-L1      TO PB-AH-OVERRIDE-L1.
 10079
 10080     MOVE PI-PROCESSOR-ID        TO PB-LAST-MAINT-BY
 10081                                    PB-INPUT-BY.
 10082     MOVE EIBTIME                TO PB-LAST-MAINT-HHMMSS.
 10083     MOVE WS-CURRENT-BIN-DT      TO PB-LAST-MAINT-DT
 10084                                    PB-INPUT-DT.
 10085     MOVE 'A'                    TO JP-RECORD-TYPE.
 10086     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10087     MOVE ERPNDT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 200
* EL9301.cbl
 10088     MOVE FILE-ID-ERPNDT         TO JP-FILE-ID.
 10089     MOVE PB-CONTROL-PRIMARY     TO PI-SAV-ENDING-ERPNDT-KEY.
 10090     ADD +1                      TO PI-SAV-BATCH-SEQ.
 10091
 10092
 10093* EXEC CICS HANDLE CONDITION
 10094*        DUPREC (5200-DUPLICATE-ALT-INDEX)
 10095*        END-EXEC.
 10096*    MOVE '"$%                   ! 0 #00009606' TO DFHEIV0
 10097     MOVE X'222425202020202020202020' TO DFHEIV0(1:12)
 10098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10099     MOVE X'3020233030303039363036' TO DFHEIV0(25:11)
 10100     CALL 'kxdfhei1' USING DFHEIV0
 10101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10102
 10103
 10104
 10105* EXEC CICS WRITE
 10106*        DATASET (FILE-ID-ERPNDT)
 10107*        FROM    (PENDING-BUSINESS)
 10108*        RIDFLD  (PB-CONTROL-PRIMARY)
 10109*        END-EXEC.
 10110     MOVE LENGTH OF
 10111      PENDING-BUSINESS
 10112       TO DFHEIV11
 10113*    MOVE '&$ L                  ''   #00009610' TO DFHEIV0
 10114     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
 10115     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 10116     MOVE X'2020233030303039363130' TO DFHEIV0(25:11)
 10117     CALL 'kxdfhei1' USING DFHEIV0,
 10118           FILE-ID-ERPNDT,
 10119           PENDING-BUSINESS,
 10120           DFHEIV11,
 10121           PB-CONTROL-PRIMARY,
 10122           DFHEIV99,
 10123           DFHEIV99
 10124     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10125
 10126
 10127     ADD +1                      TO PI-CAN-CNT-ENTERED.
 10128
 10129     PERFORM 8400-LOG-JOURNAL-RECORD.
 10130
 10131     MOVE LOW-VALUES             TO DATA-AREA-C (WS-SUB2).
 10132     MOVE PI-NEXT-DISPLAY-SEQ-NO TO CSEQ        (WS-SUB2).
 10133     MOVE AL-SABON               TO CSEQ-ATTRB  (WS-SUB2).
 10134
 10135     ADD +1 TO                   PI-NEXT-DISPLAY-SEQ-NO.
 10136
 10137     GO TO 5900-EXIT.
 10138
 10139 5200-DUPLICATE-ALT-INDEX.
 10140
 10141     MOVE ER-2247                TO EMI-ERROR.
 10142     MOVE -1                     TO CCERT-LEN    (WS-SUB2).
 10143     MOVE AL-UABON               TO CCERT-ATTRB  (WS-SUB2).
 10144     MOVE AL-UNBON               TO CEFFDT-ATTRB (WS-SUB2).
 10145     MOVE 'Y'                    TO PI-ERROR-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 201
* EL9301.cbl
 10146
 10147     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10148
 10149     IF CREFUND1-LEN (WS-SUB2) GREATER THAN ZEROS
 10150         SUBTRACT WS-CREFUND1 (WS-SUB2) FROM PI-LF-CAN-ENTERED.
 10151
 10152     IF CREFUND2-LEN (WS-SUB2) GREATER THAN ZEROS
 10153         SUBTRACT WS-CREFUND2 (WS-SUB2) FROM PI-AH-CAN-ENTERED.
 10154
 10155 5900-EXIT.
 10156
 10157     EXIT.
 10158
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 202
* EL9301.cbl
 10160
 10161******************************************************************
 10162*                                                                *
 10163*   D E L E T E  P E N D I N G   B U S I N E S S    R E C O R D  *
 10164*                                                                *
 10165******************************************************************
 10166
 10167 6000-DELETE-PEND-BUS-RECORD.
 10168
 10169     MOVE PI-COMPANY-CD          TO ERPNDT-COMP-CD.
 10170     MOVE PI-SAV-ENTRY-BATCH     TO ERPNDT-ENTRY-BATCH.
 10171
 10172     IF PI-MAP-NAME = EL930B
 10173         MOVE BSEQ               TO ERPNDT-BATCH-SEQ
 10174     ELSE
 10175         MOVE CSEQ (1)           TO ERPNDT-BATCH-SEQ.
 10176
 10177
 10178* EXEC CICS HANDLE CONDITION
 10179*        NOTFND (6990-REC-NOTFND)
 10180*        END-EXEC.
 10181*    MOVE '"$I                   ! 1 #00009666' TO DFHEIV0
 10182     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10183     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10184     MOVE X'3120233030303039363636' TO DFHEIV0(25:11)
 10185     CALL 'kxdfhei1' USING DFHEIV0
 10186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10187
 10188
 10189
 10190* EXEC CICS READ
 10191*        SET     (ERPNDT-POINTER)
 10192*        DATASET (FILE-ID-ERPNDT)
 10193*        RIDFLD  (ERPNDT-KEY)
 10194*        UPDATE
 10195*        END-EXEC.
 10196*    MOVE '&"S        EU         (   #00009670' TO DFHEIV0
 10197     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10198     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10199     MOVE X'2020233030303039363730' TO DFHEIV0(25:11)
 10200     CALL 'kxdfhei1' USING DFHEIV0,
 10201           FILE-ID-ERPNDT,
 10202           ERPNDT-POINTER,
 10203           DFHEIV99,
 10204           ERPNDT-KEY,
 10205           DFHEIV99,
 10206           DFHEIV99,
 10207           DFHEIV99
 10208     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10209
 10210
 10211     SERVICE RELOAD PENDING-BUSINESS.
 10212
 10213******************************************************************
 10214*                                                                *
 10215*    PENDING BUSINESS RECORD CAN NOT BE DELETED THROUGH DATA     *
 10216*    ENTRY IF THE RECORD HAS BEEN EDITED.  IF THE RECORD HAS     *
 10217*    BEEN EDITED, THE CURRENT BUSINESS RECORD CAN ONLY BE DELETED*
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 203
* EL9301.cbl
 10218*    THRUOUGH REVIEW AND CORRECTION.                             *
 10219*                                                                *
 10220******************************************************************
 10221
 10222     IF  PB-ACCT-EFF-DT = LOW-VALUES NEXT SENTENCE
 10223        ELSE
 10224         GO TO 6880-DELETE-ERROR.
 10225
 10226     IF PB-ISSUE
 10227         SUBTRACT PB-I-LF-PREMIUM-AMT     FROM PI-LF-ISS-ENTERED
 10228         SUBTRACT PB-I-LF-ALT-PREMIUM-AMT FROM PI-LF-ISS-ENTERED
 10229         SUBTRACT PB-I-AH-PREMIUM-AMT     FROM PI-AH-ISS-ENTERED
 10230         SUBTRACT +1 FROM PI-ISS-CNT-ENTERED
 10231     ELSE
 10232         SUBTRACT PB-C-LF-CANCEL-AMT FROM PI-LF-CAN-ENTERED
 10233         SUBTRACT PB-C-AH-CANCEL-AMT FROM PI-AH-CAN-ENTERED
 10234         SUBTRACT +1 FROM PI-CAN-CNT-ENTERED.
 10235
 10236
 10237 6300-DELETE-PB-RECORD.
 10238
 10239     MOVE 'D'                    TO JP-RECORD-TYPE.
 10240     MOVE PENDING-BUSINESS       TO JP-RECORD-AREA.
 10241     MOVE ERPNDT-JOURNAL-LENGTH  TO WS-JOURNAL-RECORD-LENGTH.
 10242     MOVE FILE-ID-ERPNDT         TO JP-FILE-ID.
 10243
 10244
 10245* EXEC CICS DELETE
 10246*        DATASET (FILE-ID-ERPNDT)
 10247*        END-EXEC.
 10248*    MOVE '&(                    &   #00009710' TO DFHEIV0
 10249     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
 10250     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 10251     MOVE X'2020233030303039373130' TO DFHEIV0(25:11)
 10252     CALL 'kxdfhei1' USING DFHEIV0,
 10253           FILE-ID-ERPNDT,
 10254           DFHEIV99,
 10255           DFHEIV99,
 10256           DFHEIV99,
 10257           DFHEIV99
 10258     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10259
 10260
 10261     PERFORM 8400-LOG-JOURNAL-RECORD.
 10262
 10263     MOVE 'Y'                    TO PI-UPDATE-SW.
 10264     MOVE ER-0000                TO EMI-ERROR
 10265
 10266     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10267
 10268     ADD +1, PI-LAST-SEQ-NO-ADDED
 10269                     GIVING PI-NEXT-DISPLAY-SEQ-NO.
 10270
 10271     IF PI-MAP-NAME = EL930B
 10272         MOVE LOW-VALUES         TO MAP-B
 10273         PERFORM 8550-SET-MAP-SEQ-NOS
 10274     ELSE
 10275         MOVE LOW-VALUES         TO MAP-C
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 204
* EL9301.cbl
 10276         PERFORM 8550-SET-MAP-SEQ-NOS
 10277                 VARYING WS-SUB2 FROM +1 BY +1
 10278                 UNTIL WS-SUB2 GREATER THAN +2.
 10279
 10280     GO TO 8100-SEND-INITIAL-MAP.
 10281
 10282 6880-DELETE-ERROR.
 10283
 10284
 10285* EXEC CICS UNLOCK
 10286*         DATASET (FILE-ID-ERPNDT)
 10287*         END-EXEC.
 10288*    MOVE '&*                    #   #00009737' TO DFHEIV0
 10289     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
 10290     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 10291     MOVE X'2020233030303039373337' TO DFHEIV0(25:11)
 10292     CALL 'kxdfhei1' USING DFHEIV0,
 10293           FILE-ID-ERPNDT,
 10294           DFHEIV99
 10295     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10296
 10297
 10298     MOVE ER-2901        TO EMI-ERROR.
 10299     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10300     IF PI-MAP-NAME = EL930B
 10301         MOVE -1                 TO BPFENTRL
 10302     ELSE
 10303         MOVE -1                 TO CPFENTRL.
 10304
 10305     GO TO 8200-SEND-DATAONLY.
 10306
 10307 6990-REC-NOTFND.
 10308
 10309     MOVE ER-2433                TO EMI-ERROR
 10310
 10311     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
 10312
 10313     IF PI-MAP-NAME = EL930B
 10314         MOVE -1                 TO BPFENTRL
 10315     ELSE
 10316         MOVE -1                 TO CPFENTRL.
 10317
 10318     GO TO 8200-SEND-DATAONLY.
 10319
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 205
* EL9301.cbl
 10321
 10322******************************************************************
 10323*                                                                *
 10324*           F O R M A T   I S S U E   S C R E E N                *
 10325*                                                                *
 10326******************************************************************
 10327
 10328 7000-FORMAT-ISSUE-SCREEN.
 10329
 10330     MOVE 'Y'                        TO PI-DISPLAY-SW.
 10331     MOVE LOW-VALUES                 TO DATA-AREA-B.
 10332     MOVE -1                         TO BPFENTRL.
 10333     MOVE PB-BATCH-SEQ-NO            TO BSEQ.
 10334     MOVE AL-SABON                   TO BSEQ-ATTRB.
 10335
 10336     MOVE PB-CARRIER                 TO BCAR.
 10337     MOVE AL-SANOF                   TO BCAR-ATTRB.
 10338     MOVE PB-GROUPING                TO BGRP.
 10339     MOVE AL-SANOF                   TO BGRP-ATTRB.
 10340     MOVE PB-STATE                   TO BST.
 10341     MOVE AL-SANOF                   TO BST-ATTRB.
 10342     MOVE PB-ACCOUNT                 TO BACCT.
 10343     MOVE AL-SANOF                   TO BACCT-ATTRB.
 10344
 10345     MOVE PB-CERT-PRIME              TO BCERT.
 10346     MOVE AL-SANON                   TO BCERT-ATTRB.
 10347     MOVE PB-CERT-SFX                TO BSFX.
 10348     MOVE AL-SANOF                   TO BSFX-ATTRB.
 10349     MOVE PB-CERT-EFF-DT             TO DC-BIN-DATE-1.
 10350     MOVE SPACE                      TO DC-OPTION-CODE.
 10351     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10352     MOVE DC-GREG-DATE-1-MDY         TO BEFFDT.
 10353     MOVE AL-SANOF                   TO BEFFDT-ATTRB.
 10354
 10355     MOVE PI-LIFE-OVERRIDE-L2        TO BKIND (1).
 10356     MOVE PI-AH-OVERRIDE-L2          TO BKIND(2).
 10357
 10358     IF PB-I-INSURED-LAST-NAME GREATER THAN SPACES
 10359        MOVE PB-I-INSURED-LAST-NAME  TO BLAST-NAME.
 10360
 10361     IF PB-I-INSURED-FIRST-NAME GREATER THAN SPACES
 10362        MOVE PB-I-INSURED-FIRST-NAME TO B1ST-NAME.
 10363
 10364     IF PB-I-INSURED-MIDDLE-INIT GREATER THAN SPACES
 10365        MOVE PB-I-INSURED-MIDDLE-INIT TO BINIT.
 10366
 10367     IF PB-I-AGE GREATER THAN ZEROS
 10368        MOVE PB-I-AGE                TO BAGE.
 10369
 10370     IF PB-I-JOINT-AGE GREATER THAN ZEROS
 10371        MOVE PB-I-JOINT-AGE          TO BJNT-AGE.
 10372
 10373     IF PB-I-BIRTHDAY NOT = LOW-VALUES
 10374        MOVE PB-I-BIRTHDAY           TO DC-BIN-DATE-1
 10375        MOVE SPACE                   TO DC-OPTION-CODE
 10376        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10377        MOVE DC-GREG-DATE-1-MDY      TO BBIRTH-DT.
 10378
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 206
* EL9301.cbl
 10379     IF PB-I-INSURED-SEX GREATER THAN SPACES
 10380        MOVE PB-I-INSURED-SEX        TO BSEX.
 10381
 10382     IF PB-I-LF-TERM GREATER THAN ZEROS
 10383        MOVE PB-I-LF-TERM            TO BTERMO (1).
 10384
 10385     IF PB-I-AH-TERM GREATER THAN ZEROS
 10386        MOVE PB-I-AH-TERM            TO BTERMO (2).
 10387
 10388     IF PB-I-LOAN-TERM GREATER THAN ZEROS
 10389        MOVE PB-I-LOAN-TERM          TO BLN-TERMO.
 10390
 10391     IF PB-I-PAY-FREQUENCY GREATER THAN ZEROS
 10392        MOVE PB-I-PAY-FREQUENCY      TO BFREQO.
 10393
 10394     IF PB-I-SKIP-CODE GREATER THAN SPACES
 10395        MOVE PB-I-SKIP-CODE          TO BSKPCD.
 10396
 10397     IF PB-I-TERM-TYPE GREATER THAN SPACES
 10398        MOVE PB-I-TERM-TYPE          TO BMODE.
 10399
 10400     IF PB-I-NO-OF-PAYMENTS GREATER THAN ZEROS
 10401        MOVE PB-I-NO-OF-PAYMENTS     TO BPMTS-OUT.
 10402
 10403     IF PB-I-POLICY-FORM-NO GREATER THAN SPACES
 10404        MOVE PB-I-POLICY-FORM-NO     TO BPOLICY.
 10405
 10406     IF PB-I-LF-INPUT-CD GREATER THAN SPACES
 10407        MOVE PB-I-LF-INPUT-CD        TO BTYPE (1).
 10408
 10409     IF PB-I-LF-BENEFIT-AMT GREATER THAN ZEROS
 10410        MOVE PB-I-LF-BENEFIT-AMT     TO BBENO (1).
 10411
 10412     IF PB-I-LF-ALT-BENEFIT-AMT GREATER THAN ZEROS
 10413        MOVE PB-I-LF-ALT-BENEFIT-AMT TO BALT-BENO (1).
 10414
 10415     IF PB-I-LF-PREMIUM-AMT GREATER THAN ZEROS
 10416        MOVE PB-I-LF-PREMIUM-AMT     TO BPREMO (1).
 10417
 10418     IF PB-I-LF-ALT-PREMIUM-AMT GREATER THAN ZEROS
 10419        MOVE PB-I-LF-ALT-PREMIUM-AMT TO BALT-PREMO (1).
 10420
 10421     IF PB-I-AH-INPUT-CD GREATER THAN SPACES
 10422        MOVE PB-I-AH-INPUT-CD        TO BTYPE (2).
 10423
 10424     IF PB-I-AH-BENEFIT-AMT GREATER THAN ZEROS
 10425        MOVE PB-I-AH-BENEFIT-AMT     TO BBENO (2).
 10426
 10427     IF PB-I-AH-PREMIUM-AMT GREATER THAN ZEROS
 10428        MOVE PB-I-AH-PREMIUM-AMT     TO BPREMO (2).
 10429
 10430     IF PB-I-LF-CRIT-PER GREATER THAN ZEROS
 10431        MOVE PB-I-LF-CRIT-PER        TO BCRIT-PERDO (1).
 10432
 10433     IF PB-I-AH-CRIT-PER GREATER THAN ZEROS
 10434        MOVE PB-I-AH-CRIT-PER           TO BCRIT-PERDO (2).
 10435
 10436     IF PB-BATCH-ENTRY GREATER THAN SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 207
* EL9301.cbl
 10437        MOVE PB-BATCH-ENTRY          TO BENTRY.
 10438
 10439     IF PB-I-SPECIAL-REIN-CODE GREATER THAN SPACE
 10440       MOVE PB-I-SPECIAL-REIN-CODE   TO BRINCD.
 10441
 10442     IF PB-I-INDV-GRP-OVRD GREATER THAN SPACES
 10443        MOVE PB-I-INDV-GRP-OVRD      TO BIND-GRP.
 10444
 10445     IF PB-I-RATE-CLASS-OVRD GREATER THAN SPACES
 10446        MOVE PB-I-RATE-CLASS-OVRD    TO BRTCLS.
 10447
 10448     IF PB-I-SIG-SW GREATER THAN SPACES
 10449         MOVE PB-I-SIG-SW            TO BSIG.
 10450
 10451     IF PB-I-LOAN-APR GREATER THAN ZEROS
 10452        MOVE PB-I-LOAN-APR           TO BAPR-OUT.
 10453
 10454     IF PB-I-SOC-SEC-NO GREATER THAN SPACES
 10455        MOVE PB-I-SOC-SEC-NO         TO BSSNUM.
 10456
 10457     IF PB-I-MEMBER-NO GREATER THAN SPACES
 10458        MOVE PB-I-MEMBER-NO          TO BMEM-NO.
 10459
 10460     IF PB-I-LOAN-OFFICER GREATER THAN SPACES
 10461        MOVE PB-I-LOAN-OFFICER       TO BLN-OFFICER.
 10462
 10463     IF PB-I-LF-EXPIRE-DT NOT = LOW-VALUES
 10464        MOVE PB-I-LF-EXPIRE-DT   TO DC-BIN-DATE-1
 10465        MOVE SPACE               TO DC-OPTION-CODE
 10466        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10467        MOVE DC-GREG-DATE-1-MDY  TO BEXPIRE (1).
 10468
 10469     IF PB-I-AH-EXPIRE-DT NOT = LOW-VALUES
 10470        MOVE PB-I-AH-EXPIRE-DT   TO DC-BIN-DATE-1
 10471        MOVE SPACE               TO DC-OPTION-CODE
 10472        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10473        MOVE DC-GREG-DATE-1-MDY  TO BEXPIRE (2).
 10474
 10475     IF PB-I-1ST-PMT-DT GREATER THAN LOW-VALUES
 10476        MOVE PB-I-1ST-PMT-DT     TO DC-BIN-DATE-1
 10477        MOVE SPACE               TO DC-OPTION-CODE
 10478        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10479        MOVE DC-GREG-DATE-1-MDY  TO B1ST-PMT.
 10480
 10481     IF PB-I-EXTENTION-DAYS NUMERIC
 10482        IF PB-I-EXTENTION-DAYS NOT = ZEROS
 10483           MOVE PB-I-EXTENTION-DAYS  TO BDAYSO
 10484        ELSE
 10485           IF PB-I-TERM-IN-DAYS NUMERIC
 10486              IF PB-I-TERM-IN-DAYS NOT = ZEROS
 10487                 MOVE PB-I-TERM-IN-DAYS TO BDAYSO.
 10488
 10489     IF PB-I-LIVES GREATER THAN ZEROS
 10490        MOVE PB-I-LIVES              TO BLIVESO.
 10491
 10492     IF PB-I-JOINT-FIRST-NAME GREATER THAN SPACES
 10493        MOVE PB-I-JOINT-FIRST-NAME   TO BJNT-1ST-NAME.
 10494
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 208
* EL9301.cbl
 10495     IF PB-I-JOINT-MIDDLE-INIT GREATER THAN SPACES
 10496        MOVE PB-I-JOINT-MIDDLE-INIT  TO BJNT-INIT.
 10497
 10498     IF PB-I-JOINT-LAST-NAME GREATER THAN SPACES
 10499        MOVE PB-I-JOINT-LAST-NAME    TO BJNT-LST-NAME.
 10500
 10501     IF PB-I-BENEFICIARY-NAME GREATER THAN SPACES
 10502        MOVE PB-I-BENEFICIARY-NAME   TO BBENEFICIARY.
 10503
 10504     MOVE PB-CONTROL-PRIMARY         TO ERPNDM-KEY.
 10505
 10506
 10507* EXEC CICS HANDLE CONDITION
 10508*        NOTFND (7090-EXIT)
 10509*        END-EXEC.
 10510*    MOVE '"$I                   ! 2 #00009949' TO DFHEIV0
 10511     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
 10512     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 10513     MOVE X'3220233030303039393439' TO DFHEIV0(25:11)
 10514     CALL 'kxdfhei1' USING DFHEIV0
 10515     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10516
 10517
 10518
 10519* EXEC CICS READ
 10520*        SET     (ERPNDM-POINTER)
 10521*        DATASET (FILE-ID-ERPNDM)
 10522*        RIDFLD  (ERPNDM-KEY)
 10523*        UPDATE
 10524*        END-EXEC.
 10525*    MOVE '&"S        EU         (   #00009953' TO DFHEIV0
 10526     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
 10527     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
 10528     MOVE X'2020233030303039393533' TO DFHEIV0(25:11)
 10529     CALL 'kxdfhei1' USING DFHEIV0,
 10530           FILE-ID-ERPNDM,
 10531           ERPNDM-POINTER,
 10532           DFHEIV99,
 10533           ERPNDM-KEY,
 10534           DFHEIV99,
 10535           DFHEIV99,
 10536           DFHEIV99
 10537     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10538
 10539
 10540     SERVICE RELOAD PENDING-MAILING-DATA.
 10541
 10542     IF PM-ADDRESS-LINE-1 GREATER THAN SPACES
 10543        MOVE PM-ADDRESS-LINE-1       TO BADDRS1.
 10544
 10545     IF PM-ADDRESS-LINE-2 GREATER THAN SPACES
 10546        MOVE PM-ADDRESS-LINE-2       TO BADDRS2.
 10547
 10548     IF PM-CITY-STATE GREATER THAN SPACES
 10549        MOVE PM-CITY-STATE           TO BCITYST.
 10550
 10551     IF PM-CANADIAN-POST-CODE
 10552        MOVE PM-CAN-POST1            TO BZIP5
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 209
* EL9301.cbl
 10553        MOVE PM-CAN-POST2            TO BZIP4
 10554        MOVE SPACES                  TO BDASH
 10555
 10556     ELSE
 10557         IF PM-ZIP-CODE GREATER THAN SPACES
 10558            MOVE PM-ZIP-CODE         TO BZIP5
 10559
 10560            IF  PM-ZIP-PLUS4 GREATER THAN SPACES
 10561                MOVE '-'             TO BDASH
 10562                MOVE PM-ZIP-PLUS4    TO BZIP4
 10563
 10564            ELSE
 10565                MOVE SPACES          TO BDASH
 10566                                        BZIP4
 10567
 10568        ELSE
 10569            MOVE SPACES              TO BDASH
 10570                                        BZIP4
 10571                                        BZIP5.
 10572
 10573     IF PM-PHONE-NO NUMERIC
 10574        IF PM-PHONE-NO GREATER THAN ZEROS
 10575           MOVE PM-PHONE-NO          TO  BPHONE-NO
 10576*          TRANSFORM BPHONE-NO FROM ' ' TO '-'.
 10577           INSPECT BPHONE-NO REPLACING ALL ' ' BY '-'.
 10578
 10579 7090-EXIT.
 10580
 10581     EXIT.
 10582
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 210
* EL9301.cbl
 10584
 10585******************************************************************
 10586*                                                                *
 10587*           F O R M A T   C A N C E L   S C R E E N              *
 10588*                                                                *
 10589******************************************************************
 10590
 10591 7100-FORMAT-CANCEL-SCREEN.
 10592
 10593     MOVE 'Y'                    TO PI-DISPLAY-SW.
 10594
 10595     MOVE LOW-VALUES             TO DATA-AREA-C (2)
 10596*                                TO DATA-AREA-C (3).
 10597                                    DATA-AREA-C (3).
 10598
 10599     MOVE -1                     TO CPFENTRL.
 10600
 10601     MOVE PB-BATCH-SEQ-NO        TO CSEQ        (1).
 10602     MOVE AL-SABON               TO CSEQ-ATTRB  (1).
 10603
 10604     MOVE PB-CARRIER             TO CCAR        (1).
 10605     MOVE AL-SANOF               TO CCAR-ATTRB  (1).
 10606     MOVE PB-GROUPING            TO CGRP        (1).
 10607     MOVE AL-SANOF               TO CGRP-ATTRB  (1).
 10608     MOVE PB-STATE               TO CST         (1).
 10609     MOVE AL-SANOF               TO CST-ATTRB   (1).
 10610     MOVE PB-ACCOUNT             TO CACCT       (1).
 10611     MOVE AL-SANOF               TO CACCT-ATTRB (1).
 10612
 10613     MOVE PB-CERT-PRIME          TO CCERT       (1).
 10614     MOVE AL-SANON               TO CCERT-ATTRB (1).
 10615     MOVE PB-CERT-SFX            TO CSFX        (1).
 10616     MOVE AL-SANON               TO CSFX-ATTRB  (1).
 10617
 10618     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1.
 10619     MOVE SPACE                  TO DC-OPTION-CODE.
 10620     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
 10621     MOVE AL-SANON               TO CEFFDT-ATTRB (1).
 10622     MOVE DC-GREG-DATE-1-MDY     TO CEFFDT       (1).
 10623     MOVE PB-C-LAST-NAME         TO CLAST-NAME   (1).
 10624
 10625
 10626     IF PB-C-LF-CANCEL-DT NOT = LOW-VALUES
 10627        MOVE PB-C-LF-CANCEL-DT   TO DC-BIN-DATE-1
 10628        MOVE SPACE               TO DC-OPTION-CODE
 10629        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10630        MOVE DC-GREG-DATE-1-MDY  TO CCANDT1 (1)
 10631        MOVE AL-UANON            TO CCANDT1-ATTRB (1).
 10632
 10633     IF PB-C-AH-CANCEL-DT NOT = LOW-VALUES
 10634        MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-1
 10635        MOVE SPACE               TO DC-OPTION-CODE
 10636        PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
 10637        MOVE DC-GREG-DATE-1-MDY  TO CCANDT2 (1)
 10638        MOVE AL-UANON            TO CCANDT2-ATTRB (1).
 10639
 10640     IF PB-C-LF-CANCEL-AMT NOT =  ZEROS
 10641        MOVE PB-C-LF-CANCEL-AMT  TO CREFUND1O (1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 211
* EL9301.cbl
 10642        MOVE AL-UNNON            TO CREFUND1-ATTRB (1).
 10643
 10644     IF PB-C-AH-CANCEL-AMT NOT =  ZEROS
 10645        MOVE PB-C-AH-CANCEL-AMT  TO CREFUND2O      (1)
 10646        MOVE AL-UNNON            TO CREFUND2-ATTRB (1).
 10647
 10648     IF PB-C-LIVES GREATER THAN ZEROS
 10649        MOVE PB-C-LIVES          TO CLIVESO      (1)
 10650        MOVE AL-UNNON            TO CLIVES-ATTRB (1).
 10651
 10652     IF PB-C-PAYEE-CODE GREATER THAN SPACES
 10653        MOVE PB-C-PAYEE-CODE     TO CPAYEE       (1)
 10654        MOVE AL-UANON            TO CPAYEE-ATTRB (1).
 10655
 10656     IF PB-C-REFUND-SW  GREATER THAN SPACES
 10657        MOVE PB-C-REFUND-SW      TO CCHK         (1)
 10658        MOVE AL-UANON            TO CCHK-ATTRB   (1).
 10659
 10660     IF PB-C-LAST-NAME GREATER THAN SPACES
 10661        MOVE PB-C-LAST-NAME      TO CLAST-NAME       (1)
 10662        MOVE AL-UANON            TO CLAST-NAME-ATTRB (1).
 10663
 10664     PERFORM 7180-PROTECT-FIELDS VARYING WS-SUB2 FROM +2 BY +1
 10665                                 UNTIL WS-SUB2 GREATER THAN +2.
 10666
 10667     GO TO 7190-EXIT.
 10668
 10669
 10670 7180-PROTECT-FIELDS.
 10671
 10672     MOVE AL-SANOF               TO CCERT-ATTRB      (WS-SUB2)
 10673                                    CSFX-ATTRB       (WS-SUB2)
 10674                                    CEFFDT-ATTRB     (WS-SUB2)
 10675                                    CLAST-NAME-ATTRB (WS-SUB2)
 10676                                    CCANDT1-ATTRB    (WS-SUB2)
 10677                                    CCANDT2-ATTRB    (WS-SUB2)
 10678                                    CREFUND1-ATTRB   (WS-SUB2)
 10679                                    CREFUND2-ATTRB   (WS-SUB2)
 10680                                    CLIVES-ATTRB     (WS-SUB2).
 10681
 10682 7190-EXIT.
 10683
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 212
* EL9301.cbl
 10685
 10686******************************************************************
 10687*                                                                *
 10688*    S  E N D    I N I T I A L   M A P   FOR    I S S U E S      *
 10689*                                                                *
 10690******************************************************************
 10691
 10692 8100-SEND-INITIAL-MAP.
 10693     IF PI-MAP-NAME = EL930B
 10694         NEXT SENTENCE
 10695     ELSE
 10696         GO TO 8110-SEND-INITIAL-CANCEL-MAP.
 10697
 10698     MOVE PI-MEMBER-CAPTION        TO BCAPTNO.
 10699
 10700     IF EIBAID NOT = DFHPF5
 10701       AND EIBAID NOT = DFHPF1
 10702       AND EIBAID NOT = DFHPF2
 10703       AND PI-MAINT-FUNC NOT = 'B'
 10704         PERFORM 0600-PROTECT-FIELDS THRU 0600-EXIT.
 10705
 10706     MOVE PI-SAV-ENTRY-BATCH     TO BBATCHO.
 10707     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
 10708     MOVE SPACE                  TO DC-OPTION-CODE.
 10709     PERFORM 8500-DATE-CONVERT.
 10710     MOVE WS-CURRENT-DT          TO BDATEO.
 10711     MOVE EIBTIME                TO TIME-IN.
 10712     MOVE TIME-OUT               TO BTIMEO.
 10713
 10714     MOVE PI-LIFE-OVERRIDE-L2    TO BKIND (1).
 10715     MOVE AL-SABOF               TO BKIND-ATTRB (1).
 10716     MOVE PI-AH-OVERRIDE-L2      TO BKIND (2).
 10717     MOVE AL-SABOF               TO BKIND-ATTRB (2).
 10718
 10719     IF PI-DATA-ERRORS
 10720         MOVE SPACE              TO PI-ERROR-SW
 10721     ELSE
 10722         IF EIBAID = DFHPF1 OR DFHPF2
 10723             NEXT SENTENCE
 10724         ELSE
 10725             IF CARR-GROUP-ST-ACCNT-CNTL
 10726                 MOVE -1                     TO BCAR-LEN
 10727             ELSE
 10728                 IF ST-ACCNT-CNTL
 10729                    MOVE -1                  TO BST-LEN
 10730                    MOVE AL-SADOF            TO BCARHDA
 10731                                                BGRPHDA
 10732                    MOVE AL-SANOF            TO BCARA
 10733                                                BGRPA
 10734                 ELSE
 10735                    IF CARR-ST-ACCNT-CNTL
 10736                       MOVE -1               TO BCAR-LEN
 10737                       MOVE AL-SADOF         TO BGRPHDA
 10738                       MOVE AL-SANOF         TO BGRPA
 10739                    ELSE
 10740                       IF ACCNT-CNTL
 10741                          MOVE -1            TO BACCT-LEN
 10742                          MOVE AL-SADOF      TO BCARHDA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 213
* EL9301.cbl
 10743                                                BGRPHDA
 10744                                                BSTHDA
 10745                          MOVE AL-SANOF      TO BCARA
 10746                                                BGRPA
 10747                                                BSTA
 10748                       ELSE
 10749                          IF CARR-ACCNT-CNTL
 10750                             MOVE AL-SADOF   TO BGRPHDA
 10751                                                BSTHDA
 10752                             MOVE AL-SANOF   TO BGRPA
 10753                                                BSTA
 10754                             MOVE -1         TO BCAR-LEN.
 10755
 10756
 10757     MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O.
 10758     MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O.
 10759
 10760
 10761* EXEC CICS SEND
 10762*        MAP      (PI-MAP-NAME)
 10763*        MAPSET   (MAPSET-EL9301S)
 10764*        FROM     (DATA-ENTRY-MAP)
 10765*        ERASE
 10766*        CURSOR
 10767*        END-EXEC.
 10768     MOVE LENGTH OF
 10769      DATA-ENTRY-MAP
 10770       TO DFHEIV12
 10771     MOVE -1
 10772       TO DFHEIV11
 10773*    MOVE '8$     CT  E    H L F ,   #00010180' TO DFHEIV0
 10774     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10775     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10776     MOVE X'2020233030303130313830' TO DFHEIV0(25:11)
 10777     CALL 'kxdfhei1' USING DFHEIV0,
 10778           PI-MAP-NAME,
 10779           DATA-ENTRY-MAP,
 10780           DFHEIV12,
 10781           MAPSET-EL9301S,
 10782           DFHEIV99,
 10783           DFHEIV99,
 10784           DFHEIV99,
 10785           DFHEIV11,
 10786           DFHEIV99,
 10787           DFHEIV99,
 10788           DFHEIV99
 10789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10790
 10791
 10792     GO TO 9100-RETURN-TRAN.
 10793
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 214
* EL9301.cbl
 10795
 10796******************************************************************
 10797*                                                                *
 10798*    S  E N D    I N I T I A L   M A P   FOR    C A N C E L S    *
 10799*                                                                *
 10800******************************************************************
 10801
 10802 8110-SEND-INITIAL-CANCEL-MAP.
 10803
 10804     IF EIBAID NOT = DFHPF5
 10805       AND EIBAID NOT = DFHPF1
 10806       AND EIBAID NOT = DFHPF2
 10807       AND PI-MAINT-FUNC NOT = 'B'
 10808         PERFORM 0700-PROTECT-FIELDS THRU 0700-EXIT.
 10809
 10810     MOVE PI-SAV-ENTRY-BATCH     TO CBATCHO.
 10811     MOVE PI-CR-MONTH-END-DT     TO DC-BIN-DATE-1.
 10812     MOVE SPACE                  TO DC-OPTION-CODE.
 10813     PERFORM 8500-DATE-CONVERT.
 10814     MOVE WS-CURRENT-DT          TO CDATEO.
 10815     MOVE EIBTIME                TO TIME-IN.
 10816     MOVE TIME-OUT               TO CTIMEO.
 10817
 10818     MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1 (1).
 10819     MOVE AL-SABOF               TO CKIND1-ATTRB (1).
 10820     MOVE PI-AH-OVERRIDE-L2      TO CKIND2 (1).
 10821     MOVE AL-SABOF               TO CKIND2-ATTRB (1).
 10822     MOVE PI-LIFE-OVERRIDE-L2    TO CKIND1 (2).
 10823     MOVE AL-SABOF               TO CKIND1-ATTRB (2).
 10824     MOVE PI-AH-OVERRIDE-L2      TO CKIND2 (2).
 10825     MOVE AL-SABOF               TO CKIND2-ATTRB (2).
 10826
 10827     IF PI-DATA-ERRORS
 10828         MOVE SPACE              TO PI-ERROR-SW
 10829     ELSE
 10830         IF EIBAID = DFHPF1 OR DFHPF2
 10831             NEXT SENTENCE
 10832         ELSE
 10833             IF CARR-GROUP-ST-ACCNT-CNTL
 10834                 MOVE -1                     TO CCAR1L
 10835             ELSE
 10836                 IF ST-ACCNT-CNTL
 10837                    MOVE -1                  TO CST1L
 10838                    MOVE AL-SADOF            TO CCARHD1A
 10839                                                CGRPHD1A
 10840                    MOVE AL-SANOF            TO CCAR1A
 10841                                                CGRP1A
 10842                    MOVE AL-SADOF            TO CCARHD2A
 10843                                                CGRPHD2A
 10844                    MOVE AL-SANOF            TO CCAR2A
 10845                                                CGRP2A
 10846                 ELSE
 10847                    IF CARR-ST-ACCNT-CNTL
 10848                       MOVE -1               TO CCAR1L
 10849                       MOVE AL-SADOF         TO CGRPHD1A
 10850                       MOVE AL-SANOF         TO CGRP1A
 10851                       MOVE AL-SADOF         TO CGRPHD2A
 10852                       MOVE AL-SANOF         TO CGRP2A
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 215
* EL9301.cbl
 10853                    ELSE
 10854                       IF ACCNT-CNTL
 10855                          MOVE -1            TO CACCT1L
 10856                          MOVE AL-SADOF      TO CCARHD1A
 10857                                                CGRPHD1A
 10858                                                CSTHD1A
 10859                          MOVE AL-SANOF      TO CCAR1A
 10860                          MOVE AL-SADOF      TO CCARHD2A
 10861                                                CGRPHD2A
 10862                                                CSTHD2A
 10863                          MOVE AL-SANOF      TO CCAR2A
 10864                                                CGRP2A
 10865                                                CST2A
 10866                       ELSE
 10867                          IF CARR-ACCNT-CNTL
 10868                             MOVE AL-SADOF   TO CGRPHD1A
 10869                                                CSTHD1A
 10870                             MOVE AL-SANOF   TO CGRP1A
 10871                                                CST1A
 10872                             MOVE AL-SADOF   TO CGRPHD2A
 10873                                                CSTHD2A
 10874                             MOVE AL-SANOF   TO CGRP2A
 10875                                                CST2A
 10876                             MOVE -1         TO CCAR1L.
 10877
 10878
 10879
 10880     MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O.
 10881     MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O.
 10882
 10883
 10884* EXEC CICS SEND
 10885*        MAP      (PI-MAP-NAME)
 10886*        MAPSET   (MAPSET-EL9301S)
 10887*        FROM     (DATA-ENTRY-MAP)
 10888*        ERASE
 10889*        CURSOR
 10890*        END-EXEC.
 10891     MOVE LENGTH OF
 10892      DATA-ENTRY-MAP
 10893       TO DFHEIV12
 10894     MOVE -1
 10895       TO DFHEIV11
 10896*    MOVE '8$     CT  E    H L F ,   #00010279' TO DFHEIV0
 10897     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
 10898     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10899     MOVE X'2020233030303130323739' TO DFHEIV0(25:11)
 10900     CALL 'kxdfhei1' USING DFHEIV0,
 10901           PI-MAP-NAME,
 10902           DATA-ENTRY-MAP,
 10903           DFHEIV12,
 10904           MAPSET-EL9301S,
 10905           DFHEIV99,
 10906           DFHEIV99,
 10907           DFHEIV99,
 10908           DFHEIV11,
 10909           DFHEIV99,
 10910           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 216
* EL9301.cbl
 10911           DFHEIV99
 10912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 10913
 10914
 10915     GO TO 9100-RETURN-TRAN.
 10916
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 217
* EL9301.cbl
 10918
 10919******************************************************************
 10920*                                                                *
 10921*              S E N D    D A T A O N L Y                        *
 10922*                                                                *
 10923******************************************************************
 10924
 10925 8200-SEND-DATAONLY.
 10926
 10927     MOVE SPACE              TO PI-ERROR-SW.
 10928
 10929     IF PI-MAP-NAME = EL930B
 10930         MOVE PI-MEMBER-CAPTION      TO BCAPTNO
 10931         MOVE WS-CURRENT-DT          TO BDATEO
 10932         MOVE EIBTIME                TO TIME-IN
 10933         MOVE TIME-OUT               TO BTIMEO
 10934         MOVE EMI-MESSAGE-AREA (1)   TO BERMSG1O
 10935         MOVE EMI-MESSAGE-AREA (2)   TO BERMSG2O
 10936
 10937* EXEC CICS SEND
 10938*            MAP      (PI-MAP-NAME)
 10939*            MAPSET   (MAPSET-EL9301S)
 10940*            FROM     (DATA-ENTRY-MAP)
 10941*            DATAONLY
 10942*            CURSOR
 10943*            END-EXEC
 10944     MOVE LENGTH OF
 10945      DATA-ENTRY-MAP
 10946       TO DFHEIV12
 10947     MOVE -1
 10948       TO DFHEIV11
 10949*    MOVE '8$D    CT       H L F ,   #00010308' TO DFHEIV0
 10950     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10951     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10952     MOVE X'2020233030303130333038' TO DFHEIV0(25:11)
 10953     CALL 'kxdfhei1' USING DFHEIV0,
 10954           PI-MAP-NAME,
 10955           DATA-ENTRY-MAP,
 10956           DFHEIV12,
 10957           MAPSET-EL9301S,
 10958           DFHEIV99,
 10959           DFHEIV99,
 10960           DFHEIV99,
 10961           DFHEIV11,
 10962           DFHEIV99,
 10963           DFHEIV99,
 10964           DFHEIV99
 10965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
 10966     ELSE
 10967         MOVE WS-CURRENT-DT          TO CDATEO
 10968         MOVE EIBTIME                TO TIME-IN
 10969         MOVE TIME-OUT               TO CTIMEO
 10970         MOVE EMI-MESSAGE-AREA (1)   TO CERMSG1O
 10971         MOVE EMI-MESSAGE-AREA (2)   TO CERMSG2O
 10972
 10973* EXEC CICS SEND
 10974*            MAP      (PI-MAP-NAME)
 10975*            MAPSET   (MAPSET-EL9301S)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 218
* EL9301.cbl
 10976*            FROM     (DATA-ENTRY-MAP)
 10977*            DATAONLY
 10978*            CURSOR
 10979*            END-EXEC.
 10980     MOVE LENGTH OF
 10981      DATA-ENTRY-MAP
 10982       TO DFHEIV12
 10983     MOVE -1
 10984       TO DFHEIV11
 10985*    MOVE '8$D    CT       H L F ,   #00010321' TO DFHEIV0
 10986     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
 10987     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
 10988     MOVE X'2020233030303130333231' TO DFHEIV0(25:11)
 10989     CALL 'kxdfhei1' USING DFHEIV0,
 10990           PI-MAP-NAME,
 10991           DATA-ENTRY-MAP,
 10992           DFHEIV12,
 10993           MAPSET-EL9301S,
 10994           DFHEIV99,
 10995           DFHEIV99,
 10996           DFHEIV99,
 10997           DFHEIV11,
 10998           DFHEIV99,
 10999           DFHEIV99,
 11000           DFHEIV99
 11001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11002
 11003
 11004     GO TO 9100-RETURN-TRAN.
 11005
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 219
* EL9301.cbl
 11007
 11008******************************************************************
 11009*                                                                *
 11010*                U T I L I T Y   R O U T I N E S                 *
 11011*                                                                *
 11012******************************************************************
 11013
 11014 8300-SEND-TEXT.
 11015
 11016* EXEC CICS SEND TEXT
 11017*        FROM     (LOGOFF-TEXT)
 11018*        LENGTH   (LOGOFF-LENGTH)
 11019*        ERASE
 11020*        FREEKB
 11021*        END-EXEC.
 11022*    MOVE '8&      T  E F  H   F -   #00010340' TO DFHEIV0
 11023     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 11024     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 11025     MOVE X'2020233030303130333430' TO DFHEIV0(25:11)
 11026     CALL 'kxdfhei1' USING DFHEIV0,
 11027           LOGOFF-TEXT,
 11028           LOGOFF-LENGTH,
 11029           DFHEIV99,
 11030           DFHEIV99,
 11031           DFHEIV99,
 11032           DFHEIV99,
 11033           DFHEIV99,
 11034           DFHEIV99,
 11035           DFHEIV99,
 11036           DFHEIV99,
 11037           DFHEIV99,
 11038           DFHEIV99
 11039     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11040
 11041
 11042* EXEC CICS RETURN
 11043*        END-EXEC.
 11044*    MOVE '.(                    &   #00010346' TO DFHEIV0
 11045     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 11046     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11047     MOVE X'2020233030303130333436' TO DFHEIV0(25:11)
 11048     CALL 'kxdfhei1' USING DFHEIV0,
 11049           DFHEIV99,
 11050           DFHEIV99,
 11051           DFHEIV99,
 11052           DFHEIV99,
 11053           DFHEIV99
 11054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11055
 11056
 11057 8350-SEND-WARNING.
 11058
 11059* EXEC CICS SEND TEXT
 11060*        FROM     (WARNING-TEXT)
 11061*        LENGTH   (WARNING-LENGTH)
 11062*        ERASE
 11063*        FREEKB
 11064*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 220
* EL9301.cbl
 11065*    MOVE '8&      T  E F  H   F -   #00010350' TO DFHEIV0
 11066     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
 11067     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
 11068     MOVE X'2020233030303130333530' TO DFHEIV0(25:11)
 11069     CALL 'kxdfhei1' USING DFHEIV0,
 11070           WARNING-TEXT,
 11071           WARNING-LENGTH,
 11072           DFHEIV99,
 11073           DFHEIV99,
 11074           DFHEIV99,
 11075           DFHEIV99,
 11076           DFHEIV99,
 11077           DFHEIV99,
 11078           DFHEIV99,
 11079           DFHEIV99,
 11080           DFHEIV99,
 11081           DFHEIV99
 11082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11083
 11084
 11085     GO TO 9100-RETURN-TRAN.
 11086
 11087
 11088 8400-LOG-JOURNAL-RECORD.
 11089     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
 11090     MOVE THIS-PGM                TO JP-PROGRAM-ID.
 11091
 11092*    EXEC CICS JOURNAL
 11093*        JFILEID     (PI-JOURNAL-FILE-ID)
 11094*        JTYPEID     ('EL')
 11095*        FROM        (JOURNAL-RECORD)
 11096*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
 11097*        END-EXEC.
 11098
 11099 8500-DATE-CONVERT.
 11100
 11101
 11102* EXEC CICS LINK
 11103*        PROGRAM  (LINK-ELDATCV)
 11104*        COMMAREA (DATE-CONVERSION-DATA)
 11105*        LENGTH   (DC-COMM-LENGTH) END-EXEC.
 11106*    MOVE '."C                   ''   #00010373' TO DFHEIV0
 11107     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11108     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11109     MOVE X'2020233030303130333733' TO DFHEIV0(25:11)
 11110     CALL 'kxdfhei1' USING DFHEIV0,
 11111           LINK-ELDATCV,
 11112           DATE-CONVERSION-DATA,
 11113           DC-COMM-LENGTH,
 11114           DFHEIV99,
 11115           DFHEIV99,
 11116           DFHEIV99
 11117     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11118
 11119
 11120 8500-EXIT.
 11121     EXIT.
 11122
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 221
* EL9301.cbl
 11124
 11125 8550-SET-MAP-SEQ-NOS.
 11126
 11127     IF PI-MAP-NAME = EL930B
 11128         MOVE PI-NEXT-DISPLAY-SEQ-NO TO BSEQ
 11129         MOVE AL-SABON               TO BSEQ-ATTRB
 11130     ELSE
 11131         MOVE PI-NEXT-DISPLAY-SEQ-NO TO CSEQ (WS-SUB2)
 11132         MOVE AL-SABON               TO CSEQ-ATTRB (WS-SUB2).
 11133
 11134     ADD +1  TO PI-NEXT-DISPLAY-SEQ-NO.
 11135
 11136 8555-EXIT.
 11137     EXIT.
 11138
 11139 8600-DEEDIT.
 11140
 11141
 11142* EXEC CICS BIF DEEDIT
 11143*        FIELD   (DEEDIT-FIELD)
 11144*        LENGTH  (15)
 11145*        END-EXEC.
 11146     MOVE 15
 11147       TO DFHEIV11
 11148*    MOVE '@"L                   #   #00010399' TO DFHEIV0
 11149     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
 11150     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
 11151     MOVE X'2020233030303130333939' TO DFHEIV0(25:11)
 11152     CALL 'kxdfhei1' USING DFHEIV0,
 11153           DEEDIT-FIELD,
 11154           DFHEIV11
 11155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11156
 11157
 11158 8600-EXIT.
 11159     EXIT.
 11160
 11161 8800-UNAUTHORIZED-ACCESS.
 11162     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
 11163     GO TO 8300-SEND-TEXT.
 11164
 11165 9000-RETURN-CICS.
 11166
 11167* EXEC CICS RETURN
 11168*        END-EXEC.
 11169*    MOVE '.(                    &   #00010412' TO DFHEIV0
 11170     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
 11171     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11172     MOVE X'2020233030303130343132' TO DFHEIV0(25:11)
 11173     CALL 'kxdfhei1' USING DFHEIV0,
 11174           DFHEIV99,
 11175           DFHEIV99,
 11176           DFHEIV99,
 11177           DFHEIV99,
 11178           DFHEIV99
 11179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11180
 11181
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 222
* EL9301.cbl
 11182 9100-RETURN-TRAN.
 11183     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
 11184     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
 11185
 11186* EXEC CICS RETURN
 11187*        TRANSID    (TRANS-EXI2)
 11188*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 11189*        LENGTH     (PI-COMM-LENGTH)
 11190*        END-EXEC.
 11191*    MOVE '.(CT                  &   #00010418' TO DFHEIV0
 11192     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
 11193     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
 11194     MOVE X'2020233030303130343138' TO DFHEIV0(25:11)
 11195     CALL 'kxdfhei1' USING DFHEIV0,
 11196           TRANS-EXI2,
 11197           PROGRAM-INTERFACE-BLOCK,
 11198           PI-COMM-LENGTH,
 11199           DFHEIV99,
 11200           DFHEIV99
 11201     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11202
 11203
 11204 9300-XCTL.
 11205
 11206
 11207* EXEC CICS XCTL
 11208*        PROGRAM    (PGM-NAME)
 11209*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
 11210*        LENGTH     (PI-COMM-LENGTH)
 11211*        END-EXEC.
 11212*    MOVE '.$C                   $   #00010426' TO DFHEIV0
 11213     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
 11214     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
 11215     MOVE X'2020233030303130343236' TO DFHEIV0(25:11)
 11216     CALL 'kxdfhei1' USING DFHEIV0,
 11217           PGM-NAME,
 11218           PROGRAM-INTERFACE-BLOCK,
 11219           PI-COMM-LENGTH
 11220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11221
 11222
 11223 9400-CLEAR.
 11224
 11225     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
 11226     GO TO 9300-XCTL.
 11227
 11228 9500-PF12.
 11229
 11230     MOVE XCTL-EL010             TO PGM-NAME.
 11231     GO TO 9300-XCTL.
 11232
 11233 9600-PGMID-ERROR.
 11234
 11235
 11236* EXEC CICS HANDLE CONDITION
 11237*        PGMIDERR    (8300-SEND-TEXT)
 11238*        END-EXEC.
 11239*    MOVE '"$L                   ! 3 #00010444' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 223
* EL9301.cbl
 11240     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
 11241     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
 11242     MOVE X'3320233030303130343434' TO DFHEIV0(25:11)
 11243     CALL 'kxdfhei1' USING DFHEIV0
 11244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11245
 11246     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
 11247     MOVE ' '                    TO PI-ENTRY-CD-1.
 11248     MOVE XCTL-EL005            TO PGM-NAME.
 11249     MOVE PGM-NAME               TO LOGOFF-PGM.
 11250     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
 11251     GO TO 9300-XCTL.
 11252
 11253 9900-ERROR-FORMAT.
 11254
 11255     IF PI-MAP-NAME = EL930B
 11256        MOVE 2                   TO EMI-NUMBER-OF-LINES
 11257       ELSE
 11258        MOVE 1                   TO EMI-NUMBER-OF-LINES.
 11259
 11260     IF NOT EMI-ERRORS-COMPLETE
 11261         MOVE LINK-EL001         TO PGM-NAME
 11262
 11263* EXEC CICS LINK
 11264*            PROGRAM    (PGM-NAME)
 11265*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
 11266*            LENGTH     (EMI-COMM-LENGTH)
 11267*            END-EXEC.
 11268*    MOVE '."C                   ''   #00010463' TO DFHEIV0
 11269     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11270     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11271     MOVE X'2020233030303130343633' TO DFHEIV0(25:11)
 11272     CALL 'kxdfhei1' USING DFHEIV0,
 11273           PGM-NAME,
 11274           ERROR-MESSAGE-INTERFACE-BLOCK,
 11275           EMI-COMM-LENGTH,
 11276           DFHEIV99,
 11277           DFHEIV99,
 11278           DFHEIV99
 11279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11280
 11281 9900-EXIT.
 11282     EXIT.
 11283
 11284 9990-ABEND.
 11285
 11286     MOVE LINK-EL004             TO PGM-NAME.
 11287     MOVE DFHEIBLK               TO EMI-LINE1
 11288
 11289* EXEC CICS LINK
 11290*        PROGRAM   (PGM-NAME)
 11291*        COMMAREA  (EMI-LINE1)
 11292*        LENGTH    (72)
 11293*        END-EXEC.
 11294     MOVE 72
 11295       TO DFHEIV11
 11296*    MOVE '."C                   ''   #00010475' TO DFHEIV0
 11297     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 224
* EL9301.cbl
 11298     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11299     MOVE X'2020233030303130343735' TO DFHEIV0(25:11)
 11300     CALL 'kxdfhei1' USING DFHEIV0,
 11301           PGM-NAME,
 11302           EMI-LINE1,
 11303           DFHEIV11,
 11304           DFHEIV99,
 11305           DFHEIV99,
 11306           DFHEIV99
 11307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11308
 11309     IF PI-MAP-NAME = EL930B
 11310         MOVE -1 TO BPFENTRL
 11311     ELSE
 11312         MOVE -1 TO CPFENTRL.
 11313     GO TO 8200-SEND-DATAONLY.
 11314
 11315* GOBACK.
 11316     MOVE '9%                    "   ' TO DFHEIV0
 11317     MOVE 'EL9301' TO DFHEIV1
 11318     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11319     GOBACK.
 11320
 11321 9995-SECURITY-VIOLATION.
 11322*                            COPY ELCSCTP.
 11323******************************************************************
 11324*                                                                *
 11325*                            ELCSCTP                             *
 11326*                            VMOD=2.001                          *
 11327*                                                                *
 11328*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
 11329******************************************************************
 11330
 11331
 11332     MOVE EIBDATE          TO SM-JUL-DATE.
 11333     MOVE EIBTRMID         TO SM-TERMID.
 11334     MOVE THIS-PGM         TO SM-PGM.
 11335     MOVE EIBTIME          TO TIME-IN.
 11336     MOVE TIME-OUT         TO SM-TIME.
 11337     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
 11338
 11339
 11340* EXEC CICS LINK
 11341*         PROGRAM  ('EL003')
 11342*         COMMAREA (SECURITY-MESSAGE)
 11343*         LENGTH   (80)
 11344*    END-EXEC.
 11345     MOVE 'EL003' TO DFHEIV1
 11346     MOVE 80
 11347       TO DFHEIV11
 11348*    MOVE '."C                   ''   #00010505' TO DFHEIV0
 11349     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
 11350     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
 11351     MOVE X'2020233030303130353035' TO DFHEIV0(25:11)
 11352     CALL 'kxdfhei1' USING DFHEIV0,
 11353           DFHEIV1,
 11354           SECURITY-MESSAGE,
 11355           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 225
* EL9301.cbl
 11356           DFHEIV99,
 11357           DFHEIV99,
 11358           DFHEIV99
 11359     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
 11360
 11361
 11362******************************************************************
 11363
 11364
 11365 9995-EXIT.
 11366     EXIT.
 11367
 11368
 11369 9999-DFHBACK SECTION.
 11370     MOVE '9%                    "   ' TO DFHEIV0
 11371     MOVE 'EL9301' TO DFHEIV1
 11372     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11373     GOBACK.
 11374 9999-DFHEXIT.
 11375     IF DFHEIGDJ EQUAL 0001
 11376         NEXT SENTENCE
 11377     ELSE IF DFHEIGDJ EQUAL 2
 11378         GO TO 9600-PGMID-ERROR,
 11379               9990-ABEND
 11380         DEPENDING ON DFHEIGDI
 11381     ELSE IF DFHEIGDJ EQUAL 3
 11382         GO TO 1078-NO-RECORD,
 11383               1078-NO-RECORD
 11384         DEPENDING ON DFHEIGDI
 11385     ELSE IF DFHEIGDJ EQUAL 4
 11386         GO TO 1580-NO-CARRIER
 11387         DEPENDING ON DFHEIGDI
 11388     ELSE IF DFHEIGDJ EQUAL 5
 11389         GO TO 1680-NO-STATE
 11390         DEPENDING ON DFHEIGDI
 11391     ELSE IF DFHEIGDJ EQUAL 6
 11392         GO TO 1780-ACCOUNT-INVALID,
 11393               1780-ACCOUNT-INVALID
 11394         DEPENDING ON DFHEIGDI
 11395     ELSE IF DFHEIGDJ EQUAL 7
 11396         GO TO 2020-END-FILE
 11397         DEPENDING ON DFHEIGDI
 11398     ELSE IF DFHEIGDJ EQUAL 8
 11399         GO TO 2100-BROWSE-BKWD
 11400         DEPENDING ON DFHEIGDI
 11401     ELSE IF DFHEIGDJ EQUAL 9
 11402         GO TO 3300-REC-NOT-FND
 11403         DEPENDING ON DFHEIGDI
 11404     ELSE IF DFHEIGDJ EQUAL 10
 11405         GO TO 3200-END-BROWSE
 11406         DEPENDING ON DFHEIGDI
 11407     ELSE IF DFHEIGDJ EQUAL 11
 11408         GO TO 4100-ADD-ISSUE-RECORD
 11409         DEPENDING ON DFHEIGDI
 11410     ELSE IF DFHEIGDJ EQUAL 12
 11411         GO TO 4185-ADD-MAILING-RECORD
 11412         DEPENDING ON DFHEIGDI
 11413     ELSE IF DFHEIGDJ EQUAL 13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 226
* EL9301.cbl
 11414         GO TO 4200-DUPLICATE-ALT-INDEX
 11415         DEPENDING ON DFHEIGDI
 11416     ELSE IF DFHEIGDJ EQUAL 14
 11417         GO TO 4185-ADD-MAILING-RECORD
 11418         DEPENDING ON DFHEIGDI
 11419     ELSE IF DFHEIGDJ EQUAL 15
 11420         GO TO 5100-ADD-CANCEL-RECORD
 11421         DEPENDING ON DFHEIGDI
 11422     ELSE IF DFHEIGDJ EQUAL 16
 11423         GO TO 5200-DUPLICATE-ALT-INDEX
 11424         DEPENDING ON DFHEIGDI
 11425     ELSE IF DFHEIGDJ EQUAL 17
 11426         GO TO 6990-REC-NOTFND
 11427         DEPENDING ON DFHEIGDI
 11428     ELSE IF DFHEIGDJ EQUAL 18
 11429         GO TO 7090-EXIT
 11430         DEPENDING ON DFHEIGDI
 11431     ELSE IF DFHEIGDJ EQUAL 19
 11432         GO TO 8300-SEND-TEXT
 11433         DEPENDING ON DFHEIGDI.
 11434     MOVE '9%                    "   ' TO DFHEIV0
 11435     MOVE 'EL9301' TO DFHEIV1
 11436     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
 11437     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6900     Code:       33985
