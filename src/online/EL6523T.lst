* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6523T.cbl
* Options: int("EL6523T.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6523T.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6523T.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6523T.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6523.
     3*              PROGRAM CONVERTED BY
     4*              COBOL CONVERSION AID PO 5785-ABJ
     5*              CONVERSION DATE 02/14/96 11:58:19.
     6*                            VMOD=2.005
     7*
     8*AUTHOR.     LOGIC,INC.
     9*            DALLAS, TEXAS.
    10*DATE-COMPILED.
    11*SECURITY.   *****************************************************
    12*            *                                                   *
    13*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6523T.cbl
    14*            *                                                   *
    15*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    17*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    18*            *                                                   *
    19*            *****************************************************
    20*REMARKS.    TRANSACTION - EXDD - DISPLAY BANK
    21*                                 CROSS REFERENCE RECORDS.
    22 ENVIRONMENT DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6523T.cbl
    24 DATA DIVISION.
    25 WORKING-STORAGE SECTION.
    26 01  DFH-START PIC X(04).
    27 77  FILLER  PIC X(32)  VALUE '********************************'.
    28 77  FILLER  PIC X(32)  VALUE '*    EL6523 WORKING STORAGE    *'.
    29 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    30 77  NDX     PIC S9(5)  COMP-3 VALUE +1.
    31 77  WSUB1   PIC S9(5)  COMP-3 VALUE +0.
    32 77  WSUB2   PIC S9(5)  COMP-3 VALUE +0.
    33 77  WSUB3   PIC S9(5)  COMP-3 VALUE +0.
    34 01  WS-WORK-ACCT-TABLE.
    35     12  WS-BANKS OCCURS 725.
    36         16  WS-AM-ACCOUNT       PIC X(10).
    37         16  WS-AM-EXP-DT        PIC XX.
    38         16  WS-AM-EFF-DT        PIC XX.
    39         16  WS-AM-STATE         PIC XX.
    40         16  FILLER              PIC X(20).
    41 01  WS-DATE-AREA.
    42     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    43     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
    44 01  WS-CONTROL-PRIMARY.
    45     05  WS-COMPANY-CD       PIC X.
    46     05  WS-CARRIER          PIC X.
    47     05  WS-GROUPING         PIC X(6).
    48     05  WS-BANK             PIC X(10).
    49     05  WS-OPEN-COUNT       PIC S9(4)    COMP-3 VALUE ZEROS.
    50*                            COPY ELCATTR SUPPRESS.
    51******************************************************************
    52*                                                                *
    53*                            ELCATTR.                            *
    54*                            VMOD=2.001                          *
    55*                                                                *
    56*             LIST OF STANDARD ATTRIBUTE VALUES                  *
    57*                                                                *
    58*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
    59*                                                                *
    60*                   POS 1   P=PROTECTED                          *
    61*                           U=UNPROTECTED                        *
    62*                           S=ASKIP                              *
    63*                   POS 2   A=ALPHA/NUMERIC                      *
    64*                           N=NUMERIC                            *
    65*                   POS 3   N=NORMAL                             *
    66*                           B=BRIGHT                             *
    67*                           D=DARK                               *
    68*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
    69*                           OF=MODIFIED DATA TAG OFF             *
    70*                                                                *
    71*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
    72******************************************************************
    73 01  ATTRIBUTE-LIST.
    74     12  AL-PABOF            PIC X       VALUE 'Y'.
    75     12  AL-PABON            PIC X       VALUE 'Z'.
    76     12  AL-PADOF            PIC X       VALUE '%'.
    77     12  AL-PADON            PIC X       VALUE '_'.
    78     12  AL-PANOF            PIC X       VALUE '-'.
    79     12  AL-PANON            PIC X       VALUE '/'.
    80     12  AL-SABOF            PIC X       VALUE '8'.
    81     12  AL-SABON            PIC X       VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6523T.cbl
    82     12  AL-SADOF            PIC X       VALUE '@'.
    83     12  AL-SADON            PIC X       VALUE QUOTE.
    84     12  AL-SANOF            PIC X       VALUE '0'.
    85     12  AL-SANON            PIC X       VALUE '1'.
    86     12  AL-UABOF            PIC X       VALUE 'H'.
    87     12  AL-UABON            PIC X       VALUE 'I'.
    88     12  AL-UADOF            PIC X       VALUE '<'.
    89     12  AL-UADON            PIC X       VALUE '('.
    90     12  AL-UANOF            PIC X       VALUE ' '.
    91     12  AL-UANON            PIC X       VALUE 'A'.
    92     12  AL-UNBOF            PIC X       VALUE 'Q'.
    93     12  AL-UNBON            PIC X       VALUE 'R'.
    94     12  AL-UNDOF            PIC X       VALUE '*'.
    95     12  AL-UNDON            PIC X       VALUE ')'.
    96     12  AL-UNNOF            PIC X       VALUE '&'.
    97     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6523T.cbl
    99 01  ERROR-MESSAGES.
   100     12  ER-0000                 PIC X(4)  VALUE '0000'.
   101     12  ER-0004                 PIC X(4)  VALUE '0004'.
   102     12  ER-0029                 PIC X(4)  VALUE '0029'.
   103     12  ER-0033                 PIC X(4)  VALUE '0033'.
   104     12  ER-0034                 PIC X(4)  VALUE '0034'.
   105     12  ER-0068                 PIC X(4)  VALUE '0068'.
   106     12  ER-0070                 PIC X(4)  VALUE '0070'.
   107     12  ER-0130                 PIC X(4)  VALUE '0130'.
   108     12  ER-0131                 PIC X(4)  VALUE '0131'.
   109     12  ER-0142                 PIC X(4)  VALUE '0142'.
   110     12  ER-0193                 PIC X(4)  VALUE '0193'.
   111     12  ER-0226                 PIC X(4)  VALUE '0226'.
   112     12  ER-0234                 PIC X(4)  VALUE '0234'.
   113     12  ER-0235                 PIC X(4)  VALUE '0235'.
   114     12  ER-0348                 PIC X(4)  VALUE '0348'.
   115     12  ER-0454                 PIC X(4)  VALUE '0454'.
   116     12  ER-1162                 PIC X(4)  VALUE '1162'.
   117     12  ER-1164                 PIC X(4)  VALUE '1164'.
   118     12  ER-2039                 PIC X(4)  VALUE '2039'.
   119     12  ER-2056                 PIC X(4)  VALUE '2056'.
   120     12  ER-2057                 PIC X(4)  VALUE '2057'.
   121     12  ER-2237                 PIC X(4)  VALUE '2237'.
   122     12  ER-2238                 PIC X(4)  VALUE '2238'.
   123     12  ER-2339                 PIC X(4)  VALUE '2339'.
   124     12  ER-2370                 PIC X(4)  VALUE '2370'.
   125     12  ER-2947                 PIC X(4)  VALUE '2947'.
   126     12  ER-3112                 PIC X(4)  VALUE '3112'.
   127     12  ER-5004                 PIC X(4)  VALUE '5004'.
   128     12  ER-5005                 PIC X(4)  VALUE '5005'.
   129     12  ER-6508                 PIC X(4)  VALUE '6508'.
   130*                          COPY ELCSCTM.
   131******************************************************************
   132*                                                                *
   133*                                                                *
   134*                            ELCSCTM                             *
   135*                            VMOD=2.001                          *
   136*                                                                *
   137*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   138*                                                                *
   139******************************************************************
   140 01  SECURITY-MESSAGE.
   141     12  FILLER                          PIC X(30)
   142            VALUE '** LOGIC SECURITY VIOLATION -'.
   143     12  SM-READ                         PIC X(6).
   144     12  FILLER                          PIC X(5)
   145            VALUE ' PGM='.
   146     12  SM-PGM                          PIC X(6).
   147     12  FILLER                          PIC X(5)
   148            VALUE ' OPR='.
   149     12  SM-PROCESSOR-ID                 PIC X(4).
   150     12  FILLER                          PIC X(6)
   151            VALUE ' TERM='.
   152     12  SM-TERMID                       PIC X(4).
   153     12  FILLER                          PIC XX   VALUE SPACE.
   154     12  SM-JUL-DATE                     PIC 9(5).
   155     12  FILLER                          PIC X    VALUE SPACE.
   156     12  SM-TIME                         PIC 99.99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6523T.cbl
   157
   158*                          COPY ELCSCRTY.
   159******************************************************************
   160*                                                                *
   161*                                                                *
   162*                            ELCSCRTY                            *
   163*                            VMOD=2.001                          *
   164*                                                                *
   165*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   166*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   167*        SAVED IN PI-SECURITY-ADDRESS.                           *
   168*                                                                *
   169******************************************************************
   170 01  SECURITY-CONTROL.
   171     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   172     12  FILLER                       PIC XX    VALUE 'SC'.
   173     12  SC-CREDIT-CODES.
   174         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   175             20  SC-CREDIT-DISPLAY    PIC X.
   176             20  SC-CREDIT-UPDATE     PIC X.
   177     12  SC-CLAIMS-CODES.
   178         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   179             20  SC-CLAIMS-DISPLAY    PIC X.
   180             20  SC-CLAIMS-UPDATE     PIC X.
   181 01  STANDARD-AREAS.
   182     12  WS-ERACCT-KEY.
   183         16  WS-ERACCT-COMP-CD   PIC X.
   184         16  WS-ERACCT-CARRIER   PIC X.
   185         16  WS-ERACCT-GROUPING  PIC X(6).
   186         16  WS-ERACCT-STATE     PIC XX.
   187         16  WS-ERACCT-ACCOUNT   PIC X(10).
   188         16  WS-ERACCT-EXP-DT    PIC XX.
   189         16  FILLER              PIC X(4).
   190     12  WS-RESPONSE             PIC S9(8)   COMP.
   191         88  RESP-NORMAL                  VALUE +00.
   192         88  RESP-NOTFND                  VALUE +13.
   193         88  RESP-NOTOPEN                 VALUE +19.
   194         88  RESP-ENDFILE                 VALUE +20.
   195     12  WS-CHANGE-SW            PIC X  VALUE ' '.
   196         88  CHANGES-MADE               VALUE 'Y'.
   197         88  NO-CHANGES-MADE            VALUE 'N'.
   198     12  WS-LINE-CHANGE-SW       PIC X  VALUE ' '.
   199         88  LINE-CHANGES               VALUE 'Y'.
   200         88  NO-LINE-CHANGES            VALUE 'N'.
   201     12  GETMAIN-SPACE           PIC X     VALUE SPACE.
   202     12  WS-DEEDIT-FIELD         PIC X(10) VALUE SPACES.
   203     12  WS-DT-DEEDIT-FIELD REDEFINES WS-DEEDIT-FIELD
   204                                      PIC X(10).
   205     12  WS-DEEDIT-FIELD-DATE REDEFINES WS-DT-DEEDIT-FIELD.
   206         16  FILLER                   PIC X(4).
   207         16  WS-DEEDIT-FIELD-DATE-OUT PIC X(6).
   208     12  SC-ITEM-CL-CR       PIC S9(4)         VALUE +1   COMP.
   209     12  WS-ACCESS.
   210         16  FILLER          PIC  X(3)         VALUE SPACES.
   211         16  WS-ACARRIER     PIC  X.
   212     12  ELCNTL-KEY.
   213         16  CNTL-COMP-ID    PIC  X(3)         VALUE SPACES.
   214         16  CNTL-REC-TYPE   PIC  X            VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6523T.cbl
   215         16  CNTL-ACCESS     PIC  X(4)         VALUE SPACES.
   216         16  CNTL-SEQ-NO     PIC S9(4)         VALUE +0   COMP.
   217     12  QID.
   218         16  QID-TERM        PIC X(4).
   219         16  FILLER          PIC X(4)    VALUE '652D'.
   220     12  RETURNED-FROM       PIC X(8)    VALUE SPACES.
   221     12  QID-MAP-LENGTH      PIC S9(4)   VALUE +1376   COMP.
   222     12  MAP-NAME                PIC X(8)    VALUE 'EL652D'.
   223     12  MAPSET-NAME             PIC X(8)    VALUE 'EL6523S'.
   224     12  TRANS-ID                PIC X(4)    VALUE 'EXDD'.
   225     12  EL652-TRANS-ID          PIC X(4)    VALUE 'EXD4'.
   226     12  EL650-TRANS-ID          PIC X(4)    VALUE 'EXC4'.
   227     12  PGM-NAME                PIC X(8)    VALUE SPACES.
   228     12  THIS-PGM                PIC X(8)    VALUE 'EL6523'.
   229     12  XCTL-650                PIC X(8)    VALUE 'EL650'.
   230     12  BXRF-FILE-ID            PIC X(8)    VALUE 'ERBXRF'.
   231     12  CNTL-FILE-ID            PIC X(8)    VALUE 'ELCNTL'.
   232     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   233     12  LINK-001                PIC X(8)    VALUE 'EL001'.
   234     12  LINK-004                PIC X(8)    VALUE 'EL004'.
   235     12  XCTL-005                PIC X(8)    VALUE 'EL005'.
   236     12  XCTL-010                PIC X(8)    VALUE 'EL010'.
   237     12  XCTL-626                PIC X(8)    VALUE 'EL626'.
   238     12  TIME-IN                 PIC S9(7).
   239     12  TIME-OUT-R   REDEFINES TIME-IN.
   240         16  FILLER              PIC X.
   241         16  TIME-OUT            PIC 99V99.
   242         16  FILLER              PIC X(2).
   243     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   244         88  BROWSE-STARTED      VALUE 'Y'.
   245 01  WS-RECORD-LENGTH COMP       SYNCHRONIZED.
   246     12  BXRF-MAX-REC-LENGTH     PIC S9(8)    VALUE +26178.
   247     12  BXRF-REC-LENGTH         PIC S9(4)    VALUE +0.
   248*                                COPY ELCDATE.
   249******************************************************************
   250*                                                                *
   251*                                                                *
   252*                            ELCDATE.                            *
   253*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   254*                            VMOD=2.003
   255*                                                                *
   256*                                                                *
   257*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   258*                 LENGTH = 200                                   *
   259******************************************************************
   260
   261 01  DATE-CONVERSION-DATA.
   262     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   263     12  DC-OPTION-CODE                PIC X.
   264         88  BIN-TO-GREG                VALUE ' '.
   265         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   266         88  EDIT-GREG-TO-BIN           VALUE '2'.
   267         88  YMD-GREG-TO-BIN            VALUE '3'.
   268         88  MDY-GREG-TO-BIN            VALUE '4'.
   269         88  JULIAN-TO-BIN              VALUE '5'.
   270         88  BIN-PLUS-ELAPSED           VALUE '6'.
   271         88  FIND-CENTURY               VALUE '7'.
   272         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6523T.cbl
   273         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   274         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   275         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   276         88  JULIAN-TO-BIN-3            VALUE 'C'.
   277         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   278         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   279         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   280         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   281         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   282         88  CHECK-LEAP-YEAR            VALUE 'H'.
   283         88  BIN-3-TO-GREG              VALUE 'I'.
   284         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   285         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   286         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   287         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   288         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   289         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   290         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   291         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   292         88  THREE-CHARACTER-BIN
   293                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   294         88  GREGORIAN-TO-BIN
   295                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   296         88  BIN-TO-GREGORIAN
   297                  VALUES ' ' '1' 'I' '8' 'G'.
   298         88  JULIAN-TO-BINARY
   299                  VALUES '5' 'C' 'E' 'F'.
   300     12  DC-ERROR-CODE                 PIC X.
   301         88  NO-CONVERSION-ERROR        VALUE ' '.
   302         88  DATE-CONVERSION-ERROR
   303                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   304         88  DATE-IS-ZERO               VALUE '1'.
   305         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   306         88  DATE-IS-INVALID            VALUE '3'.
   307         88  DATE1-GREATER-DATE2        VALUE '4'.
   308         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   309         88  DATE-INVALID-OPTION        VALUE '9'.
   310         88  INVALID-CENTURY            VALUE 'A'.
   311         88  ONLY-CENTURY               VALUE 'B'.
   312         88  ONLY-LEAP-YEAR             VALUE 'C'.
   313         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   314     12  DC-END-OF-MONTH               PIC X.
   315         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   316     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   317         88  USE-NORMAL-PROCESS         VALUE ' '.
   318         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   319         88  ADJUST-UP-100-YRS          VALUE '2'.
   320     12  FILLER                        PIC X.
   321     12  DC-CONVERSION-DATES.
   322         16  DC-BIN-DATE-1             PIC XX.
   323         16  DC-BIN-DATE-2             PIC XX.
   324         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   325         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   326                       DC-GREG-DATE-1-EDIT.
   327             20  DC-EDIT1-MONTH        PIC 99.
   328             20  SLASH1-1              PIC X.
   329             20  DC-EDIT1-DAY          PIC 99.
   330             20  SLASH1-2              PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6523T.cbl
   331             20  DC-EDIT1-YEAR         PIC 99.
   332         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   333         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   334                     DC-GREG-DATE-2-EDIT.
   335             20  DC-EDIT2-MONTH        PIC 99.
   336             20  SLASH2-1              PIC X.
   337             20  DC-EDIT2-DAY          PIC 99.
   338             20  SLASH2-2              PIC X.
   339             20  DC-EDIT2-YEAR         PIC 99.
   340         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   341         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   342                     DC-GREG-DATE-1-YMD.
   343             20  DC-YMD-YEAR           PIC 99.
   344             20  DC-YMD-MONTH          PIC 99.
   345             20  DC-YMD-DAY            PIC 99.
   346         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   347         16  DC-GREG-DATE-1-MDY-R REDEFINES
   348                      DC-GREG-DATE-1-MDY.
   349             20  DC-MDY-MONTH          PIC 99.
   350             20  DC-MDY-DAY            PIC 99.
   351             20  DC-MDY-YEAR           PIC 99.
   352         16  DC-GREG-DATE-1-ALPHA.
   353             20  DC-ALPHA-MONTH        PIC X(10).
   354             20  DC-ALPHA-DAY          PIC 99.
   355             20  FILLER                PIC XX.
   356             20  DC-ALPHA-CENTURY.
   357                 24 DC-ALPHA-CEN-N     PIC 99.
   358             20  DC-ALPHA-YEAR         PIC 99.
   359         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   360         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   361         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   362         16  DC-JULIAN-DATE            PIC 9(05).
   363         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   364                                       PIC 9(05).
   365         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   366             20  DC-JULIAN-YEAR        PIC 99.
   367             20  DC-JULIAN-DAYS        PIC 999.
   368         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   369         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   370         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   371     12  DATE-CONVERSION-VARIBLES.
   372         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   373         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   374             20  FILLER                PIC 9(3).
   375             20  HOLD-CEN-1-CCYY.
   376                 24  HOLD-CEN-1-CC     PIC 99.
   377                 24  HOLD-CEN-1-YY     PIC 99.
   378             20  HOLD-CEN-1-MO         PIC 99.
   379             20  HOLD-CEN-1-DA         PIC 99.
   380         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   381             20  HOLD-CEN-1-R-MO       PIC 99.
   382             20  HOLD-CEN-1-R-DA       PIC 99.
   383             20  HOLD-CEN-1-R-CCYY.
   384                 24  HOLD-CEN-1-R-CC   PIC 99.
   385                 24  HOLD-CEN-1-R-YY   PIC 99.
   386             20  FILLER                PIC 9(3).
   387         16  HOLD-CENTURY-1-X.
   388             20  FILLER                PIC X(3)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6523T.cbl
   389             20  HOLD-CEN-1-X-CCYY.
   390                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   391                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   392             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   393             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   394         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   395             20  HOLD-CEN-1-R-X-MO     PIC XX.
   396             20  HOLD-CEN-1-R-X-DA     PIC XX.
   397             20  HOLD-CEN-1-R-X-CCYY.
   398                 24  HOLD-CEN-1-R-X-CC PIC XX.
   399                 24  HOLD-CEN-1-R-X-YY PIC XX.
   400             20  FILLER                PIC XXX.
   401         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   402         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   403         16  DC-JULIAN-DATE-1          PIC 9(07).
   404         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   405             20  DC-JULIAN-1-CCYY.
   406                 24  DC-JULIAN-1-CC    PIC 99.
   407                 24  DC-JULIAN-1-YR    PIC 99.
   408             20  DC-JULIAN-DA-1        PIC 999.
   409         16  DC-JULIAN-DATE-2          PIC 9(07).
   410         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   411             20  DC-JULIAN-2-CCYY.
   412                 24  DC-JULIAN-2-CC    PIC 99.
   413                 24  DC-JULIAN-2-YR    PIC 99.
   414             20  DC-JULIAN-DA-2        PIC 999.
   415         16  DC-GREG-DATE-A-EDIT.
   416             20  DC-EDITA-MONTH        PIC 99.
   417             20  SLASHA-1              PIC X VALUE '/'.
   418             20  DC-EDITA-DAY          PIC 99.
   419             20  SLASHA-2              PIC X VALUE '/'.
   420             20  DC-EDITA-CCYY.
   421                 24  DC-EDITA-CENT     PIC 99.
   422                 24  DC-EDITA-YEAR     PIC 99.
   423         16  DC-GREG-DATE-B-EDIT.
   424             20  DC-EDITB-MONTH        PIC 99.
   425             20  SLASHB-1              PIC X VALUE '/'.
   426             20  DC-EDITB-DAY          PIC 99.
   427             20  SLASHB-2              PIC X VALUE '/'.
   428             20  DC-EDITB-CCYY.
   429                 24  DC-EDITB-CENT     PIC 99.
   430                 24  DC-EDITB-YEAR     PIC 99.
   431         16  DC-GREG-DATE-CYMD         PIC 9(08).
   432         16  DC-GREG-DATE-CYMD-R REDEFINES
   433                              DC-GREG-DATE-CYMD.
   434             20  DC-CYMD-CEN           PIC 99.
   435             20  DC-CYMD-YEAR          PIC 99.
   436             20  DC-CYMD-MONTH         PIC 99.
   437             20  DC-CYMD-DAY           PIC 99.
   438         16  DC-GREG-DATE-MDCY         PIC 9(08).
   439         16  DC-GREG-DATE-MDCY-R REDEFINES
   440                              DC-GREG-DATE-MDCY.
   441             20  DC-MDCY-MONTH         PIC 99.
   442             20  DC-MDCY-DAY           PIC 99.
   443             20  DC-MDCY-CEN           PIC 99.
   444             20  DC-MDCY-YEAR          PIC 99.
   445    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   446        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6523T.cbl
   447    12  DC-EL310-DATE                  PIC X(21).
   448    12  FILLER                         PIC X(28).
   449*                                COPY ELCEMIB SUPPRESS.
   450******************************************************************
   451*                                                                *
   452*                                                                *
   453*                            ELCEMIB.                            *
   454*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   455*                            VMOD=2.005                          *
   456*                                                                *
   457*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   458*                                                                *
   459******************************************************************
   460 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   461     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   462     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   463     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   464     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   465     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   466     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   467     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   468     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   469     12  EMI-SWITCH1             PIC X        VALUE '1'.
   470         88  EMI-NO-ERRORS                    VALUE '1'.
   471         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   472         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   473     12  EMI-SWITCH2             PIC X        VALUE '1'.
   474         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   475     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   476         88  EMI-AREA1-EMPTY                  VALUE '1'.
   477         88  EMI-AREA1-FULL                   VALUE '2'.
   478     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   479         88  EMI-AREA2-EMPTY                  VALUE '1'.
   480         88  EMI-AREA2-FULL                   VALUE '2'.
   481     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   482         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   483         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   484         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   485         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   486         88  EMI-BYPASS-FATALS                VALUE 'X'.
   487     12  EMI-ERROR-LINES.
   488         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   489         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   490         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   491         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   492             20  EMI-ERR-CODES OCCURS 10 TIMES.
   493                 24  EMI-ERR-NUM         PIC X(4).
   494                 24  EMI-FILLER          PIC X.
   495                 24  EMI-SEV             PIC X.
   496                 24  FILLER              PIC X.
   497             20  FILLER                  PIC X(02).
   498     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   499         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   500             20  EMI-ERROR-NUMBER    PIC X(4).
   501             20  EMI-FILL            PIC X.
   502             20  EMI-SEVERITY        PIC X.
   503             20  FILLER              PIC X.
   504             20  EMI-ERROR-TEXT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6523T.cbl
   505                 24  EMI-TEXT-VARIABLE   PIC X(10).
   506                 24  FILLER          PIC X(55).
   507     12  EMI-SEVERITY-SAVE           PIC X.
   508         88  EMI-NOTE                    VALUE 'N'.
   509         88  EMI-WARNING                 VALUE 'W'.
   510         88  EMI-FORCABLE                VALUE 'F'.
   511         88  EMI-FATAL                   VALUE 'X'.
   512     12  EMI-MESSAGE-FLAG            PIC X.
   513         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   514         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   515     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   516     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   517         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   518         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   519         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   520     12  FILLER                      PIC X(137)  VALUE SPACES.
   521     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   522     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   523     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   524     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   525*                  COPY ELCLOGOF SUPPRESS.
   526******************************************************************
   527*                                                                *
   528*                                                                *
   529*                            ELCLOGOF.                           *
   530*                            VMOD=2.001                          *
   531*                                                                *
   532*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   533*                                                                *
   534******************************************************************
   535 01  CLASIC-LOGOFF.
   536     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   537     12  LOGOFF-TEXT.
   538         16  FILLER          PIC X(5)    VALUE SPACES.
   539         16  LOGOFF-MSG.
   540             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   541             20  FILLER      PIC X       VALUE SPACES.
   542             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   543         16  FILLER          PIC X(80)
   544           VALUE '* YOU ARE NOW LOGGED OFF'.
   545         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   546         16  FILLER          PIC X       VALUE QUOTE.
   547         16  LOGOFF-SYS-MSG  PIC X(17)
   548           VALUE 'S CLAS-IC SYSTEM '.
   549     12  TEXT-MESSAGES.
   550         16  UNACCESS-MSG    PIC X(29)
   551             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   552         16  PGMIDERR-MSG    PIC X(17)
   553             VALUE 'PROGRAM NOT FOUND'.
   554*                                COPY ELCINTF.
   555******************************************************************
   556*                                                                *
   557*                                                                *
   558*                            ELCINTF.                            *
   559*                            VMOD=2.017                          *
   560*                                                                *
   561*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   562*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6523T.cbl
   563*       LENGTH = 1024                                            *
   564*                                                                *
   565******************************************************************
   566 01  PROGRAM-INTERFACE-BLOCK.
   567     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   568     12  PI-CALLING-PROGRAM              PIC X(8).
   569     12  PI-SAVED-PROGRAM-1              PIC X(8).
   570     12  PI-SAVED-PROGRAM-2              PIC X(8).
   571     12  PI-SAVED-PROGRAM-3              PIC X(8).
   572     12  PI-SAVED-PROGRAM-4              PIC X(8).
   573     12  PI-SAVED-PROGRAM-5              PIC X(8).
   574     12  PI-SAVED-PROGRAM-6              PIC X(8).
   575     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   576     12  PI-COMPANY-ID                   PIC XXX.
   577     12  PI-COMPANY-CD                   PIC X.
   578
   579     12  PI-COMPANY-PASSWORD             PIC X(8).
   580
   581     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   582
   583     12  PI-CONTROL-IN-PROGRESS.
   584         16  PI-CARRIER                  PIC X.
   585         16  PI-GROUPING                 PIC X(6).
   586         16  PI-STATE                    PIC XX.
   587         16  PI-ACCOUNT                  PIC X(10).
   588         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   589                                         PIC X(10).
   590         16  PI-CLAIM-CERT-GRP.
   591             20  PI-CLAIM-NO             PIC X(7).
   592             20  PI-CERT-NO.
   593                 25  PI-CERT-PRIME       PIC X(10).
   594                 25  PI-CERT-SFX         PIC X.
   595             20  PI-CERT-EFF-DT          PIC XX.
   596         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   597             20  PI-PLAN-CODE            PIC X(2).
   598             20  PI-REVISION-NUMBER      PIC X(3).
   599             20  PI-PLAN-EFF-DT          PIC X(2).
   600             20  PI-PLAN-EXP-DT          PIC X(2).
   601             20  FILLER                  PIC X(11).
   602         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   603             20  PI-OE-REFERENCE-1.
   604                 25  PI-OE-REF-1-PRIME   PIC X(18).
   605                 25  PI-OE-REF-1-SUFF    PIC XX.
   606
   607     12  PI-SESSION-IN-PROGRESS          PIC X.
   608         88  CLAIM-SESSION                   VALUE '1'.
   609         88  CREDIT-SESSION                  VALUE '2'.
   610         88  WARRANTY-SESSION                VALUE '3'.
   611         88  MORTGAGE-SESSION                VALUE '4'.
   612         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   613
   614
   615*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   616
   617     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   618     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   619
   620     12  PI-CREDIT-USER                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6523T.cbl
   621         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   622         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   623
   624     12  PI-CLAIM-USER                   PIC X.
   625         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   626         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   627
   628     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   629         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   630         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   631         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   632         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   633         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   634
   635     12  PI-PROCESSOR-ID                 PIC X(4).
   636
   637     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   638
   639     12  PI-MEMBER-CAPTION               PIC X(10).
   640
   641     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   642         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   643
   644     12  PI-LIFE-OVERRIDE-L1             PIC X.
   645     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   646     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   647     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   648
   649     12  PI-AH-OVERRIDE-L1               PIC X.
   650     12  PI-AH-OVERRIDE-L2               PIC XX.
   651     12  PI-AH-OVERRIDE-L6               PIC X(6).
   652     12  PI-AH-OVERRIDE-L12              PIC X(12).
   653
   654     12  PI-NEW-SYSTEM                   PIC X(2).
   655
   656     12  PI-PRIMARY-CERT-NO              PIC X(11).
   657     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   658         88  PI-USES-PAID-TO                 VALUE '1'.
   659     12  PI-CRDTCRD-SYSTEM.
   660         16  PI-CRDTCRD-USER             PIC X.
   661             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   662             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   663         16  PI-CC-MONTH-END-DT          PIC XX.
   664     12  PI-PROCESSOR-PRINTER            PIC X(4).
   665
   666     12  PI-OE-REFERENCE-2.
   667         16  PI-OE-REF-2-PRIME           PIC X(10).
   668         16  PI-OE-REF-2-SUFF            PIC X.
   669
   670     12  PI-REM-TRM-CALC-OPTION          PIC X.
   671
   672     12  PI-LANGUAGE-TYPE                PIC X.
   673             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   674             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   675             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   676
   677     12  PI-POLICY-LINKAGE-IND           PIC X.
   678         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6523T.cbl
   679         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   680                                                   LOW-VALUES.
   681
   682     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   683     12  PI-CLAIM-PW-SESSION             PIC X(1).
   684         88  PI-CLAIM-CREDIT                 VALUE '1'.
   685         88  PI-CLAIM-CONVEN                 VALUE '2'.
   686     12  FILLER                          PIC X(4).
   687
   688     12  PI-SYSTEM-LEVEL                 PIC X(145).
   689
   690     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   691         PI-SYSTEM-LEVEL.
   692
   693         16  PI-ENTRY-CODES.
   694             20  PI-ENTRY-CD-1           PIC X.
   695             20  PI-ENTRY-CD-2           PIC X.
   696
   697         16  PI-RETURN-CODES.
   698             20  PI-RETURN-CD-1          PIC X.
   699             20  PI-RETURN-CD-2          PIC X.
   700
   701         16  PI-UPDATE-STATUS-SAVE.
   702             20  PI-UPDATE-BY            PIC X(4).
   703             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   704
   705         16  PI-LOWER-CASE-LETTERS       PIC X.
   706             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   707
   708*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   709*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   710*            88  CARRIER-CLM-CNTL            VALUE '2'.
   711
   712         16  PI-CERT-ACCESS-CONTROL      PIC X.
   713             88  ST-ACCNT-CNTL               VALUE ' '.
   714             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   715             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   716             88  ACCNT-CNTL                  VALUE '3'.
   717             88  CARR-ACCNT-CNTL             VALUE '4'.
   718
   719         16  PI-PROCESSOR-CAP-LIST.
   720             20  PI-SYSTEM-CONTROLS.
   721                24 PI-SYSTEM-DISPLAY     PIC X.
   722                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   723                24 PI-SYSTEM-MODIFY      PIC X.
   724                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   725             20  FILLER                  PIC XX.
   726             20  PI-DISPLAY-CAP          PIC X.
   727                 88  DISPLAY-CAP             VALUE 'Y'.
   728             20  PI-MODIFY-CAP           PIC X.
   729                 88  MODIFY-CAP              VALUE 'Y'.
   730             20  PI-MSG-AT-LOGON-CAP     PIC X.
   731                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   732             20  PI-FORCE-CAP            PIC X.
   733                 88  FORCE-CAP               VALUE 'Y'.
   734
   735         16  PI-PROGRAM-CONTROLS.
   736             20  PI-PGM-PRINT-OPT        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6523T.cbl
   737             20  PI-PGM-FORMAT-OPT       PIC X.
   738             20  PI-PGM-PROCESS-OPT      PIC X.
   739             20  PI-PGM-TOTALS-OPT       PIC X.
   740
   741         16  PI-HELP-INTERFACE.
   742             20  PI-LAST-ERROR-NO        PIC X(4).
   743             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   744
   745         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   746             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   747
   748         16  PI-CR-CONTROL-IN-PROGRESS.
   749             20  PI-CR-CARRIER           PIC X.
   750             20  PI-CR-GROUPING          PIC X(6).
   751             20  PI-CR-STATE             PIC XX.
   752             20  PI-CR-ACCOUNT           PIC X(10).
   753             20  PI-CR-FIN-RESP          PIC X(10).
   754             20  PI-CR-TYPE              PIC X.
   755
   756         16  PI-CR-BATCH-NUMBER          PIC X(6).
   757
   758         16  PI-CR-MONTH-END-DT          PIC XX.
   759
   760         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   761             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   762             88  PI-ZERO-CARRIER             VALUE '1'.
   763             88  PI-ZERO-GROUPING            VALUE '2'.
   764             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   765
   766         16  PI-CARRIER-SECURITY         PIC X.
   767             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   768
   769         16  PI-ACCOUNT-SECURITY         PIC X(10).
   770             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   771             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   772
   773         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   774             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   775                                         INDEXED BY PI-ACCESS-NDX
   776                                         PIC X.
   777
   778         16  PI-GA-BILLING-CONTROL       PIC X.
   779             88  PI-GA-BILLING               VALUE '1'.
   780
   781         16  PI-MAIL-PROCESSING          PIC X.
   782             88  PI-MAIL-YES                 VALUE 'Y'.
   783
   784         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   785
   786         16  PI-AR-SYSTEM.
   787             20  PI-AR-PROCESSING-CNTL   PIC X.
   788                 88  PI-AR-PROCESSING        VALUE 'Y'.
   789             20  PI-AR-SUMMARY-CODE      PIC X(6).
   790             20  PI-AR-MONTH-END-DT      PIC XX.
   791
   792         16  PI-MP-SYSTEM.
   793             20  PI-MORTGAGE-USER            PIC X.
   794                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6523T.cbl
   795                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   796             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   797                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   798                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   799                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   800                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   801                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   802             20  PI-MP-MONTH-END-DT          PIC XX.
   803             20  PI-MP-REFERENCE-NO.
   804                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   805                 24  PI-MP-REFERENCE-SFX     PIC XX.
   806
   807         16  PI-LABEL-CONTROL            PIC X(01).
   808             88  PI-CREATE-LABELS                    VALUE 'Y'.
   809             88  PI-BYPASS-LABELS                    VALUE 'N'.
   810
   811         16  PI-BILL-GROUPING-CODE       PIC X(01).
   812             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   813
   814         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   815             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   816             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   817
   818         16  FILLER                      PIC X(14).
   819
   820     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   821******************************************************************
   822     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   823         16  PI-ERBXRF-KEY.
   824             20  PI-BXRF-COMP-CD     PIC X.
   825             20  PI-BXRF-CARRIER     PIC X.
   826             20  PI-BXRF-GROUPING    PIC X(6).
   827             20  PI-BXRF-BANK        PIC X(10).
   828         16  PI-TOP-NDX              PIC S9(5)  COMP-3.
   829         16  PI-NDX                  PIC S9(5)  COMP-3.
   830         16  PI-EOF-SW               PIC X.
   831             88  PI-FILE-EOF             VALUE 'Y'.
   832         16  PI-CHECK-MAINT-TYPE     PIC  X.
   833             88  VALID-MAINT-TYPE            VALUE 'S' 'A'
   834                                                   'C' 'D'.
   835             88  ADD-FUNCTION                VALUE 'A'.
   836             88  SHOW-FUNCTION               VALUE 'S'.
   837             88  DELETE-FUNCTION             VALUE 'D'.
   838             88  CHANGE-FUNCTION             VALUE 'C'.
   839         16  PI-ERC-KEY.
   840             20  PI-ERC-COMPANY-CD   PIC  X.
   841             20  PI-ERC-CARRIER      PIC  X.
   842             20  PI-ERC-GROUP        PIC  X(6).
   843             20  PI-ERC-BANK         PIC  X(10).
   844         16  PI-SAVE-ERBXRF-KEY      PIC  X(18).
   845         16  FILLER                  PIC X(617).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6523T.cbl
   847*                            COPY ELCAID SUPPRESS.
   848******************************************************************
   849*                                                                *
   850*                            ELCAID.                             *
   851*                            VMOD=2.001                          *
   852*                                                                *
   853*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   854*                                                                *
   855*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   856*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   857******************************************************************
   858
   859 01  DFHAID.
   860   02  DFHNULL   PIC  X  VALUE  ' '.
   861   02  DFHENTER  PIC  X  VALUE  QUOTE.
   862   02  DFHCLEAR  PIC  X  VALUE  '_'.
   863   02  DFHPEN    PIC  X  VALUE  '='.
   864   02  DFHOPID   PIC  X  VALUE  'W'.
   865   02  DFHPA1    PIC  X  VALUE  '%'.
   866   02  DFHPA2    PIC  X  VALUE  '>'.
   867   02  DFHPA3    PIC  X  VALUE  ','.
   868   02  DFHPF1    PIC  X  VALUE  '1'.
   869   02  DFHPF2    PIC  X  VALUE  '2'.
   870   02  DFHPF3    PIC  X  VALUE  '3'.
   871   02  DFHPF4    PIC  X  VALUE  '4'.
   872   02  DFHPF5    PIC  X  VALUE  '5'.
   873   02  DFHPF6    PIC  X  VALUE  '6'.
   874   02  DFHPF7    PIC  X  VALUE  '7'.
   875   02  DFHPF8    PIC  X  VALUE  '8'.
   876   02  DFHPF9    PIC  X  VALUE  '9'.
   877   02  DFHPF10   PIC  X  VALUE  ':'.
   878   02  DFHPF11   PIC  X  VALUE  '#'.
   879   02  DFHPF12   PIC  X  VALUE  '@'.
   880   02  DFHPF13   PIC  X  VALUE  'A'.
   881   02  DFHPF14   PIC  X  VALUE  'B'.
   882   02  DFHPF15   PIC  X  VALUE  'C'.
   883   02  DFHPF16   PIC  X  VALUE  'D'.
   884   02  DFHPF17   PIC  X  VALUE  'E'.
   885   02  DFHPF18   PIC  X  VALUE  'F'.
   886   02  DFHPF19   PIC  X  VALUE  'G'.
   887   02  DFHPF20   PIC  X  VALUE  'H'.
   888   02  DFHPF21   PIC  X  VALUE  'I'.
   889*00039    02  DFHPF22   PIC  X  VALUE  ''.
   890   02  DFHPF22   PIC  X  VALUE  '['.
   891   02  DFHPF23   PIC  X  VALUE  '.'.
   892   02  DFHPF24   PIC  X  VALUE  '<'.
   893   02  DFHMSRE   PIC  X  VALUE  'X'.
   894   02  DFHSTRF   PIC  X  VALUE  'h'.
   895   02  DFHTRIG   PIC  X  VALUE  '"'.
   896 01  FILLER    REDEFINES DFHAID.
   897     12  FILLER              PIC X(8).
   898     12  PF-VALUES           PIC X       OCCURS 24.
   899*                            COPY EL6523S.
   900 01  EL652DI.
   901     05  FILLER            PIC  X(0012).
   902*    -------------------------------
   903     05  TIMEL PIC S9(0004) COMP.
   904     05  TIMEF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6523T.cbl
   905     05  FILLER REDEFINES TIMEF.
   906         10  TIMEA PIC  X(0001).
   907     05  TIMEI PIC  X(0005).
   908*    -------------------------------
   909     05  DATEL PIC S9(0004) COMP.
   910     05  DATEF PIC  X(0001).
   911     05  FILLER REDEFINES DATEF.
   912         10  DATEA PIC  X(0001).
   913     05  DATEI PIC  X(0008).
   914*    -------------------------------
   915     05  MAINTYPL PIC S9(0004) COMP.
   916     05  MAINTYPF PIC  X(0001).
   917     05  FILLER REDEFINES MAINTYPF.
   918         10  MAINTYPA PIC  X(0001).
   919     05  MAINTYPI PIC  X(0001).
   920*    -------------------------------
   921     05  CARRIERL PIC S9(0004) COMP.
   922     05  CARRIERF PIC  X(0001).
   923     05  FILLER REDEFINES CARRIERF.
   924         10  CARRIERA PIC  X(0001).
   925     05  CARRIERI PIC  X(0001).
   926*    -------------------------------
   927     05  GROUPL PIC S9(0004) COMP.
   928     05  GROUPF PIC  X(0001).
   929     05  FILLER REDEFINES GROUPF.
   930         10  GROUPA PIC  X(0001).
   931     05  GROUPI PIC  X(0006).
   932*    -------------------------------
   933     05  BANKL PIC S9(0004) COMP.
   934     05  BANKF PIC  X(0001).
   935     05  FILLER REDEFINES BANKF.
   936         10  BANKA PIC  X(0001).
   937     05  BANKI PIC  X(0010).
   938*    -------------------------------
   939     05  MAINTDTL PIC S9(0004) COMP.
   940     05  MAINTDTF PIC  X(0001).
   941     05  FILLER REDEFINES MAINTDTF.
   942         10  MAINTDTA PIC  X(0001).
   943     05  MAINTDTI PIC  X(0008).
   944*    -------------------------------
   945     05  TOTOPNL PIC S9(0004) COMP.
   946     05  TOTOPNF PIC  X(0001).
   947     05  FILLER REDEFINES TOTOPNF.
   948         10  TOTOPNA PIC  X(0001).
   949     05  TOTOPNI PIC  X(0005).
   950*    -------------------------------
   951     05  TOTOCCL PIC S9(0004) COMP.
   952     05  TOTOCCF PIC  X(0001).
   953     05  FILLER REDEFINES TOTOCCF.
   954         10  TOTOCCA PIC  X(0001).
   955     05  TOTOCCI PIC  X(0005).
   956*    -------------------------------
   957     05  ACCT01L PIC S9(0004) COMP.
   958     05  ACCT01F PIC  X(0001).
   959     05  FILLER REDEFINES ACCT01F.
   960         10  ACCT01A PIC  X(0001).
   961     05  ACCT01I PIC  X(0010).
   962*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6523T.cbl
   963     05  EFFDT01L PIC S9(0004) COMP.
   964     05  EFFDT01F PIC  X(0001).
   965     05  FILLER REDEFINES EFFDT01F.
   966         10  EFFDT01A PIC  X(0001).
   967     05  EFFDT01I PIC  X(0008).
   968*    -------------------------------
   969     05  EXPDT01L PIC S9(0004) COMP.
   970     05  EXPDT01F PIC  X(0001).
   971     05  FILLER REDEFINES EXPDT01F.
   972         10  EXPDT01A PIC  X(0001).
   973     05  EXPDT01I PIC  X(0008).
   974*    -------------------------------
   975     05  STATE01L PIC S9(0004) COMP.
   976     05  STATE01F PIC  X(0001).
   977     05  FILLER REDEFINES STATE01F.
   978         10  STATE01A PIC  X(0001).
   979     05  STATE01I PIC  X(0002).
   980*    -------------------------------
   981     05  ACCT02L PIC S9(0004) COMP.
   982     05  ACCT02F PIC  X(0001).
   983     05  FILLER REDEFINES ACCT02F.
   984         10  ACCT02A PIC  X(0001).
   985     05  ACCT02I PIC  X(0010).
   986*    -------------------------------
   987     05  EFFDT02L PIC S9(0004) COMP.
   988     05  EFFDT02F PIC  X(0001).
   989     05  FILLER REDEFINES EFFDT02F.
   990         10  EFFDT02A PIC  X(0001).
   991     05  EFFDT02I PIC  X(0008).
   992*    -------------------------------
   993     05  EXPDT02L PIC S9(0004) COMP.
   994     05  EXPDT02F PIC  X(0001).
   995     05  FILLER REDEFINES EXPDT02F.
   996         10  EXPDT02A PIC  X(0001).
   997     05  EXPDT02I PIC  X(0008).
   998*    -------------------------------
   999     05  STATE02L PIC S9(0004) COMP.
  1000     05  STATE02F PIC  X(0001).
  1001     05  FILLER REDEFINES STATE02F.
  1002         10  STATE02A PIC  X(0001).
  1003     05  STATE02I PIC  X(0002).
  1004*    -------------------------------
  1005     05  ACCT03L PIC S9(0004) COMP.
  1006     05  ACCT03F PIC  X(0001).
  1007     05  FILLER REDEFINES ACCT03F.
  1008         10  ACCT03A PIC  X(0001).
  1009     05  ACCT03I PIC  X(0010).
  1010*    -------------------------------
  1011     05  EFFDT03L PIC S9(0004) COMP.
  1012     05  EFFDT03F PIC  X(0001).
  1013     05  FILLER REDEFINES EFFDT03F.
  1014         10  EFFDT03A PIC  X(0001).
  1015     05  EFFDT03I PIC  X(0008).
  1016*    -------------------------------
  1017     05  EXPDT03L PIC S9(0004) COMP.
  1018     05  EXPDT03F PIC  X(0001).
  1019     05  FILLER REDEFINES EXPDT03F.
  1020         10  EXPDT03A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6523T.cbl
  1021     05  EXPDT03I PIC  X(0008).
  1022*    -------------------------------
  1023     05  STATE03L PIC S9(0004) COMP.
  1024     05  STATE03F PIC  X(0001).
  1025     05  FILLER REDEFINES STATE03F.
  1026         10  STATE03A PIC  X(0001).
  1027     05  STATE03I PIC  X(0002).
  1028*    -------------------------------
  1029     05  ACCT04L PIC S9(0004) COMP.
  1030     05  ACCT04F PIC  X(0001).
  1031     05  FILLER REDEFINES ACCT04F.
  1032         10  ACCT04A PIC  X(0001).
  1033     05  ACCT04I PIC  X(0010).
  1034*    -------------------------------
  1035     05  EFFDT04L PIC S9(0004) COMP.
  1036     05  EFFDT04F PIC  X(0001).
  1037     05  FILLER REDEFINES EFFDT04F.
  1038         10  EFFDT04A PIC  X(0001).
  1039     05  EFFDT04I PIC  X(0008).
  1040*    -------------------------------
  1041     05  EXPDT04L PIC S9(0004) COMP.
  1042     05  EXPDT04F PIC  X(0001).
  1043     05  FILLER REDEFINES EXPDT04F.
  1044         10  EXPDT04A PIC  X(0001).
  1045     05  EXPDT04I PIC  X(0008).
  1046*    -------------------------------
  1047     05  STATE04L PIC S9(0004) COMP.
  1048     05  STATE04F PIC  X(0001).
  1049     05  FILLER REDEFINES STATE04F.
  1050         10  STATE04A PIC  X(0001).
  1051     05  STATE04I PIC  X(0002).
  1052*    -------------------------------
  1053     05  ACCT05L PIC S9(0004) COMP.
  1054     05  ACCT05F PIC  X(0001).
  1055     05  FILLER REDEFINES ACCT05F.
  1056         10  ACCT05A PIC  X(0001).
  1057     05  ACCT05I PIC  X(0010).
  1058*    -------------------------------
  1059     05  EFFDT05L PIC S9(0004) COMP.
  1060     05  EFFDT05F PIC  X(0001).
  1061     05  FILLER REDEFINES EFFDT05F.
  1062         10  EFFDT05A PIC  X(0001).
  1063     05  EFFDT05I PIC  X(0008).
  1064*    -------------------------------
  1065     05  EXPDT05L PIC S9(0004) COMP.
  1066     05  EXPDT05F PIC  X(0001).
  1067     05  FILLER REDEFINES EXPDT05F.
  1068         10  EXPDT05A PIC  X(0001).
  1069     05  EXPDT05I PIC  X(0008).
  1070*    -------------------------------
  1071     05  STATE05L PIC S9(0004) COMP.
  1072     05  STATE05F PIC  X(0001).
  1073     05  FILLER REDEFINES STATE05F.
  1074         10  STATE05A PIC  X(0001).
  1075     05  STATE05I PIC  X(0002).
  1076*    -------------------------------
  1077     05  ACCT06L PIC S9(0004) COMP.
  1078     05  ACCT06F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6523T.cbl
  1079     05  FILLER REDEFINES ACCT06F.
  1080         10  ACCT06A PIC  X(0001).
  1081     05  ACCT06I PIC  X(0010).
  1082*    -------------------------------
  1083     05  EFFDT06L PIC S9(0004) COMP.
  1084     05  EFFDT06F PIC  X(0001).
  1085     05  FILLER REDEFINES EFFDT06F.
  1086         10  EFFDT06A PIC  X(0001).
  1087     05  EFFDT06I PIC  X(0008).
  1088*    -------------------------------
  1089     05  EXPDT06L PIC S9(0004) COMP.
  1090     05  EXPDT06F PIC  X(0001).
  1091     05  FILLER REDEFINES EXPDT06F.
  1092         10  EXPDT06A PIC  X(0001).
  1093     05  EXPDT06I PIC  X(0008).
  1094*    -------------------------------
  1095     05  STATE06L PIC S9(0004) COMP.
  1096     05  STATE06F PIC  X(0001).
  1097     05  FILLER REDEFINES STATE06F.
  1098         10  STATE06A PIC  X(0001).
  1099     05  STATE06I PIC  X(0002).
  1100*    -------------------------------
  1101     05  ACCT07L PIC S9(0004) COMP.
  1102     05  ACCT07F PIC  X(0001).
  1103     05  FILLER REDEFINES ACCT07F.
  1104         10  ACCT07A PIC  X(0001).
  1105     05  ACCT07I PIC  X(0010).
  1106*    -------------------------------
  1107     05  EFFDT07L PIC S9(0004) COMP.
  1108     05  EFFDT07F PIC  X(0001).
  1109     05  FILLER REDEFINES EFFDT07F.
  1110         10  EFFDT07A PIC  X(0001).
  1111     05  EFFDT07I PIC  X(0008).
  1112*    -------------------------------
  1113     05  EXPDT07L PIC S9(0004) COMP.
  1114     05  EXPDT07F PIC  X(0001).
  1115     05  FILLER REDEFINES EXPDT07F.
  1116         10  EXPDT07A PIC  X(0001).
  1117     05  EXPDT07I PIC  X(0008).
  1118*    -------------------------------
  1119     05  STATE07L PIC S9(0004) COMP.
  1120     05  STATE07F PIC  X(0001).
  1121     05  FILLER REDEFINES STATE07F.
  1122         10  STATE07A PIC  X(0001).
  1123     05  STATE07I PIC  X(0002).
  1124*    -------------------------------
  1125     05  ACCT08L PIC S9(0004) COMP.
  1126     05  ACCT08F PIC  X(0001).
  1127     05  FILLER REDEFINES ACCT08F.
  1128         10  ACCT08A PIC  X(0001).
  1129     05  ACCT08I PIC  X(0010).
  1130*    -------------------------------
  1131     05  EFFDT08L PIC S9(0004) COMP.
  1132     05  EFFDT08F PIC  X(0001).
  1133     05  FILLER REDEFINES EFFDT08F.
  1134         10  EFFDT08A PIC  X(0001).
  1135     05  EFFDT08I PIC  X(0008).
  1136*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6523T.cbl
  1137     05  EXPDT08L PIC S9(0004) COMP.
  1138     05  EXPDT08F PIC  X(0001).
  1139     05  FILLER REDEFINES EXPDT08F.
  1140         10  EXPDT08A PIC  X(0001).
  1141     05  EXPDT08I PIC  X(0008).
  1142*    -------------------------------
  1143     05  STATE08L PIC S9(0004) COMP.
  1144     05  STATE08F PIC  X(0001).
  1145     05  FILLER REDEFINES STATE08F.
  1146         10  STATE08A PIC  X(0001).
  1147     05  STATE08I PIC  X(0002).
  1148*    -------------------------------
  1149     05  ACCT09L PIC S9(0004) COMP.
  1150     05  ACCT09F PIC  X(0001).
  1151     05  FILLER REDEFINES ACCT09F.
  1152         10  ACCT09A PIC  X(0001).
  1153     05  ACCT09I PIC  X(0010).
  1154*    -------------------------------
  1155     05  EFFDT09L PIC S9(0004) COMP.
  1156     05  EFFDT09F PIC  X(0001).
  1157     05  FILLER REDEFINES EFFDT09F.
  1158         10  EFFDT09A PIC  X(0001).
  1159     05  EFFDT09I PIC  X(0008).
  1160*    -------------------------------
  1161     05  EXPDT09L PIC S9(0004) COMP.
  1162     05  EXPDT09F PIC  X(0001).
  1163     05  FILLER REDEFINES EXPDT09F.
  1164         10  EXPDT09A PIC  X(0001).
  1165     05  EXPDT09I PIC  X(0008).
  1166*    -------------------------------
  1167     05  STATE09L PIC S9(0004) COMP.
  1168     05  STATE09F PIC  X(0001).
  1169     05  FILLER REDEFINES STATE09F.
  1170         10  STATE09A PIC  X(0001).
  1171     05  STATE09I PIC  X(0002).
  1172*    -------------------------------
  1173     05  ACCT10L PIC S9(0004) COMP.
  1174     05  ACCT10F PIC  X(0001).
  1175     05  FILLER REDEFINES ACCT10F.
  1176         10  ACCT10A PIC  X(0001).
  1177     05  ACCT10I PIC  X(0010).
  1178*    -------------------------------
  1179     05  EFFDT10L PIC S9(0004) COMP.
  1180     05  EFFDT10F PIC  X(0001).
  1181     05  FILLER REDEFINES EFFDT10F.
  1182         10  EFFDT10A PIC  X(0001).
  1183     05  EFFDT10I PIC  X(0008).
  1184*    -------------------------------
  1185     05  EXPDT10L PIC S9(0004) COMP.
  1186     05  EXPDT10F PIC  X(0001).
  1187     05  FILLER REDEFINES EXPDT10F.
  1188         10  EXPDT10A PIC  X(0001).
  1189     05  EXPDT10I PIC  X(0008).
  1190*    -------------------------------
  1191     05  STATE10L PIC S9(0004) COMP.
  1192     05  STATE10F PIC  X(0001).
  1193     05  FILLER REDEFINES STATE10F.
  1194         10  STATE10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6523T.cbl
  1195     05  STATE10I PIC  X(0002).
  1196*    -------------------------------
  1197     05  ACCT11L PIC S9(0004) COMP.
  1198     05  ACCT11F PIC  X(0001).
  1199     05  FILLER REDEFINES ACCT11F.
  1200         10  ACCT11A PIC  X(0001).
  1201     05  ACCT11I PIC  X(0010).
  1202*    -------------------------------
  1203     05  EFFDT11L PIC S9(0004) COMP.
  1204     05  EFFDT11F PIC  X(0001).
  1205     05  FILLER REDEFINES EFFDT11F.
  1206         10  EFFDT11A PIC  X(0001).
  1207     05  EFFDT11I PIC  X(0008).
  1208*    -------------------------------
  1209     05  EXPDT11L PIC S9(0004) COMP.
  1210     05  EXPDT11F PIC  X(0001).
  1211     05  FILLER REDEFINES EXPDT11F.
  1212         10  EXPDT11A PIC  X(0001).
  1213     05  EXPDT11I PIC  X(0008).
  1214*    -------------------------------
  1215     05  STATE11L PIC S9(0004) COMP.
  1216     05  STATE11F PIC  X(0001).
  1217     05  FILLER REDEFINES STATE11F.
  1218         10  STATE11A PIC  X(0001).
  1219     05  STATE11I PIC  X(0002).
  1220*    -------------------------------
  1221     05  ACCT12L PIC S9(0004) COMP.
  1222     05  ACCT12F PIC  X(0001).
  1223     05  FILLER REDEFINES ACCT12F.
  1224         10  ACCT12A PIC  X(0001).
  1225     05  ACCT12I PIC  X(0010).
  1226*    -------------------------------
  1227     05  EFFDT12L PIC S9(0004) COMP.
  1228     05  EFFDT12F PIC  X(0001).
  1229     05  FILLER REDEFINES EFFDT12F.
  1230         10  EFFDT12A PIC  X(0001).
  1231     05  EFFDT12I PIC  X(0008).
  1232*    -------------------------------
  1233     05  EXPDT12L PIC S9(0004) COMP.
  1234     05  EXPDT12F PIC  X(0001).
  1235     05  FILLER REDEFINES EXPDT12F.
  1236         10  EXPDT12A PIC  X(0001).
  1237     05  EXPDT12I PIC  X(0008).
  1238*    -------------------------------
  1239     05  STATE12L PIC S9(0004) COMP.
  1240     05  STATE12F PIC  X(0001).
  1241     05  FILLER REDEFINES STATE12F.
  1242         10  STATE12A PIC  X(0001).
  1243     05  STATE12I PIC  X(0002).
  1244*    -------------------------------
  1245     05  ACCT13L PIC S9(0004) COMP.
  1246     05  ACCT13F PIC  X(0001).
  1247     05  FILLER REDEFINES ACCT13F.
  1248         10  ACCT13A PIC  X(0001).
  1249     05  ACCT13I PIC  X(0010).
  1250*    -------------------------------
  1251     05  EFFDT13L PIC S9(0004) COMP.
  1252     05  EFFDT13F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6523T.cbl
  1253     05  FILLER REDEFINES EFFDT13F.
  1254         10  EFFDT13A PIC  X(0001).
  1255     05  EFFDT13I PIC  X(0008).
  1256*    -------------------------------
  1257     05  EXPDT13L PIC S9(0004) COMP.
  1258     05  EXPDT13F PIC  X(0001).
  1259     05  FILLER REDEFINES EXPDT13F.
  1260         10  EXPDT13A PIC  X(0001).
  1261     05  EXPDT13I PIC  X(0008).
  1262*    -------------------------------
  1263     05  STATE13L PIC S9(0004) COMP.
  1264     05  STATE13F PIC  X(0001).
  1265     05  FILLER REDEFINES STATE13F.
  1266         10  STATE13A PIC  X(0001).
  1267     05  STATE13I PIC  X(0002).
  1268*    -------------------------------
  1269     05  ACCOCCL PIC S9(0004) COMP.
  1270     05  ACCOCCF PIC  X(0001).
  1271     05  FILLER REDEFINES ACCOCCF.
  1272         10  ACCOCCA PIC  X(0001).
  1273     05  ACCOCCI PIC  9(4).
  1274*    -------------------------------
  1275     05  ERRMSGL PIC S9(0004) COMP.
  1276     05  ERRMSGF PIC  X(0001).
  1277     05  FILLER REDEFINES ERRMSGF.
  1278         10  ERRMSGA PIC  X(0001).
  1279     05  ERRMSGI PIC  X(0076).
  1280*    -------------------------------
  1281     05  PFENTERL PIC S9(0004) COMP.
  1282     05  PFENTERF PIC  X(0001).
  1283     05  FILLER REDEFINES PFENTERF.
  1284         10  PFENTERA PIC  X(0001).
  1285     05  PFENTERI PIC  9(2).
  1286 01  EL652DO REDEFINES EL652DI.
  1287     05  FILLER            PIC  X(0012).
  1288*    -------------------------------
  1289     05  FILLER            PIC  X(0003).
  1290     05  TIMEO PIC  99.99.
  1291*    -------------------------------
  1292     05  FILLER            PIC  X(0003).
  1293     05  DATEO PIC  X(0008).
  1294*    -------------------------------
  1295     05  FILLER            PIC  X(0003).
  1296     05  MAINTYPO PIC  X(0001).
  1297*    -------------------------------
  1298     05  FILLER            PIC  X(0003).
  1299     05  CARRIERO PIC  X(0001).
  1300*    -------------------------------
  1301     05  FILLER            PIC  X(0003).
  1302     05  GROUPO PIC  X(0006).
  1303*    -------------------------------
  1304     05  FILLER            PIC  X(0003).
  1305     05  BANKO PIC  X(0010).
  1306*    -------------------------------
  1307     05  FILLER            PIC  X(0003).
  1308     05  MAINTDTO PIC  X(0008).
  1309*    -------------------------------
  1310     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6523T.cbl
  1311     05  TOTOPNO PIC  Z,ZZ9.
  1312*    -------------------------------
  1313     05  FILLER            PIC  X(0003).
  1314     05  TOTOCCO PIC  Z,ZZ9.
  1315*    -------------------------------
  1316     05  FILLER            PIC  X(0003).
  1317     05  ACCT01O PIC  X(0010).
  1318*    -------------------------------
  1319     05  FILLER            PIC  X(0003).
  1320     05  EFFDT01O PIC  X(0008).
  1321*    -------------------------------
  1322     05  FILLER            PIC  X(0003).
  1323     05  EXPDT01O PIC  X(0008).
  1324*    -------------------------------
  1325     05  FILLER            PIC  X(0003).
  1326     05  STATE01O PIC  X(0002).
  1327*    -------------------------------
  1328     05  FILLER            PIC  X(0003).
  1329     05  ACCT02O PIC  X(0010).
  1330*    -------------------------------
  1331     05  FILLER            PIC  X(0003).
  1332     05  EFFDT02O PIC  X(0008).
  1333*    -------------------------------
  1334     05  FILLER            PIC  X(0003).
  1335     05  EXPDT02O PIC  X(0008).
  1336*    -------------------------------
  1337     05  FILLER            PIC  X(0003).
  1338     05  STATE02O PIC  X(0002).
  1339*    -------------------------------
  1340     05  FILLER            PIC  X(0003).
  1341     05  ACCT03O PIC  X(0010).
  1342*    -------------------------------
  1343     05  FILLER            PIC  X(0003).
  1344     05  EFFDT03O PIC  X(0008).
  1345*    -------------------------------
  1346     05  FILLER            PIC  X(0003).
  1347     05  EXPDT03O PIC  X(0008).
  1348*    -------------------------------
  1349     05  FILLER            PIC  X(0003).
  1350     05  STATE03O PIC  X(0002).
  1351*    -------------------------------
  1352     05  FILLER            PIC  X(0003).
  1353     05  ACCT04O PIC  X(0010).
  1354*    -------------------------------
  1355     05  FILLER            PIC  X(0003).
  1356     05  EFFDT04O PIC  X(0008).
  1357*    -------------------------------
  1358     05  FILLER            PIC  X(0003).
  1359     05  EXPDT04O PIC  X(0008).
  1360*    -------------------------------
  1361     05  FILLER            PIC  X(0003).
  1362     05  STATE04O PIC  X(0002).
  1363*    -------------------------------
  1364     05  FILLER            PIC  X(0003).
  1365     05  ACCT05O PIC  X(0010).
  1366*    -------------------------------
  1367     05  FILLER            PIC  X(0003).
  1368     05  EFFDT05O PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6523T.cbl
  1369*    -------------------------------
  1370     05  FILLER            PIC  X(0003).
  1371     05  EXPDT05O PIC  X(0008).
  1372*    -------------------------------
  1373     05  FILLER            PIC  X(0003).
  1374     05  STATE05O PIC  X(0002).
  1375*    -------------------------------
  1376     05  FILLER            PIC  X(0003).
  1377     05  ACCT06O PIC  X(0010).
  1378*    -------------------------------
  1379     05  FILLER            PIC  X(0003).
  1380     05  EFFDT06O PIC  X(0008).
  1381*    -------------------------------
  1382     05  FILLER            PIC  X(0003).
  1383     05  EXPDT06O PIC  X(0008).
  1384*    -------------------------------
  1385     05  FILLER            PIC  X(0003).
  1386     05  STATE06O PIC  X(0002).
  1387*    -------------------------------
  1388     05  FILLER            PIC  X(0003).
  1389     05  ACCT07O PIC  X(0010).
  1390*    -------------------------------
  1391     05  FILLER            PIC  X(0003).
  1392     05  EFFDT07O PIC  X(0008).
  1393*    -------------------------------
  1394     05  FILLER            PIC  X(0003).
  1395     05  EXPDT07O PIC  X(0008).
  1396*    -------------------------------
  1397     05  FILLER            PIC  X(0003).
  1398     05  STATE07O PIC  X(0002).
  1399*    -------------------------------
  1400     05  FILLER            PIC  X(0003).
  1401     05  ACCT08O PIC  X(0010).
  1402*    -------------------------------
  1403     05  FILLER            PIC  X(0003).
  1404     05  EFFDT08O PIC  X(0008).
  1405*    -------------------------------
  1406     05  FILLER            PIC  X(0003).
  1407     05  EXPDT08O PIC  X(0008).
  1408*    -------------------------------
  1409     05  FILLER            PIC  X(0003).
  1410     05  STATE08O PIC  X(0002).
  1411*    -------------------------------
  1412     05  FILLER            PIC  X(0003).
  1413     05  ACCT09O PIC  X(0010).
  1414*    -------------------------------
  1415     05  FILLER            PIC  X(0003).
  1416     05  EFFDT09O PIC  X(0008).
  1417*    -------------------------------
  1418     05  FILLER            PIC  X(0003).
  1419     05  EXPDT09O PIC  X(0008).
  1420*    -------------------------------
  1421     05  FILLER            PIC  X(0003).
  1422     05  STATE09O PIC  X(0002).
  1423*    -------------------------------
  1424     05  FILLER            PIC  X(0003).
  1425     05  ACCT10O PIC  X(0010).
  1426*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6523T.cbl
  1427     05  FILLER            PIC  X(0003).
  1428     05  EFFDT10O PIC  X(0008).
  1429*    -------------------------------
  1430     05  FILLER            PIC  X(0003).
  1431     05  EXPDT10O PIC  X(0008).
  1432*    -------------------------------
  1433     05  FILLER            PIC  X(0003).
  1434     05  STATE10O PIC  X(0002).
  1435*    -------------------------------
  1436     05  FILLER            PIC  X(0003).
  1437     05  ACCT11O PIC  X(0010).
  1438*    -------------------------------
  1439     05  FILLER            PIC  X(0003).
  1440     05  EFFDT11O PIC  X(0008).
  1441*    -------------------------------
  1442     05  FILLER            PIC  X(0003).
  1443     05  EXPDT11O PIC  X(0008).
  1444*    -------------------------------
  1445     05  FILLER            PIC  X(0003).
  1446     05  STATE11O PIC  X(0002).
  1447*    -------------------------------
  1448     05  FILLER            PIC  X(0003).
  1449     05  ACCT12O PIC  X(0010).
  1450*    -------------------------------
  1451     05  FILLER            PIC  X(0003).
  1452     05  EFFDT12O PIC  X(0008).
  1453*    -------------------------------
  1454     05  FILLER            PIC  X(0003).
  1455     05  EXPDT12O PIC  X(0008).
  1456*    -------------------------------
  1457     05  FILLER            PIC  X(0003).
  1458     05  STATE12O PIC  X(0002).
  1459*    -------------------------------
  1460     05  FILLER            PIC  X(0003).
  1461     05  ACCT13O PIC  X(0010).
  1462*    -------------------------------
  1463     05  FILLER            PIC  X(0003).
  1464     05  EFFDT13O PIC  X(0008).
  1465*    -------------------------------
  1466     05  FILLER            PIC  X(0003).
  1467     05  EXPDT13O PIC  X(0008).
  1468*    -------------------------------
  1469     05  FILLER            PIC  X(0003).
  1470     05  STATE13O PIC  X(0002).
  1471*    -------------------------------
  1472     05  FILLER            PIC  X(0003).
  1473     05  ACCOCCO PIC  Z(4).
  1474*    -------------------------------
  1475     05  FILLER            PIC  X(0003).
  1476     05  ERRMSGO PIC  X(0076).
  1477*    -------------------------------
  1478     05  FILLER            PIC  X(0003).
  1479     05  PFENTERO PIC  X(0002).
  1480*    -------------------------------
  1481 01  FILLER REDEFINES EL652DI.
  1482     12  FILLER                  PIC X(88).
  1483     12  BLD-LINE OCCURS 13.
  1484         16  BL-ACCOUNTL         PIC S9(4) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6523T.cbl
  1485         16  BL-ACCOUNTA         PIC X.
  1486         16  BL-ACCOUNT          PIC X(10).
  1487         16  BL-EFFECTL          PIC S9(4) COMP.
  1488         16  BL-EFFECTA          PIC X.
  1489         16  BL-EFFECT           PIC X(8).
  1490         16  BL-EXPIREL          PIC S9(4) COMP.
  1491         16  BL-EXPIREA          PIC X.
  1492         16  BL-EXPIRE           PIC X(8).
  1493         16  BL-STATEL           PIC S9(4) COMP.
  1494         16  BL-STATEA           PIC X.
  1495         16  BL-STATE            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6523T.cbl
  1497****************************************************************
  1498*
  1499* Copyright (c) 2007 by Clerity Solutions, Inc.
  1500* All rights reserved.
  1501*
  1502****************************************************************
  1503 01  DFHEIV.
  1504   02  DFHEIV0               PIC X(35).
  1505   02  DFHEIV1               PIC X(08).
  1506   02  DFHEIV2               PIC X(08).
  1507   02  DFHEIV3               PIC X(08).
  1508   02  DFHEIV4               PIC X(06).
  1509   02  DFHEIV5               PIC X(04).
  1510   02  DFHEIV6               PIC X(04).
  1511   02  DFHEIV7               PIC X(02).
  1512   02  DFHEIV8               PIC X(02).
  1513   02  DFHEIV9               PIC X(01).
  1514   02  DFHEIV10              PIC S9(7) COMP-3.
  1515   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1516   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1517   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1518   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1519   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1520   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1521   02  DFHEIV17              PIC X(04).
  1522   02  DFHEIV18              PIC X(04).
  1523   02  DFHEIV19              PIC X(04).
  1524   02  DFHEIV20              USAGE IS POINTER.
  1525   02  DFHEIV21              USAGE IS POINTER.
  1526   02  DFHEIV22              USAGE IS POINTER.
  1527   02  DFHEIV23              USAGE IS POINTER.
  1528   02  DFHEIV24              USAGE IS POINTER.
  1529   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1530   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1531   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1532   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1533   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1534   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1535   02  FILLER                PIC X(02).
  1536   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1537   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1538   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1539   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1540   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1541 LINKAGE  SECTION.
  1542*****************************************************************
  1543*                                                               *
  1544* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1545* All rights reserved.                                          *
  1546*                                                               *
  1547*****************************************************************
  1548 01  dfheiblk.
  1549     02  eibtime          pic s9(7) comp-3.
  1550     02  eibdate          pic s9(7) comp-3.
  1551     02  eibtrnid         pic x(4).
  1552     02  eibtaskn         pic s9(7) comp-3.
  1553     02  eibtrmid         pic x(4).
  1554     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6523T.cbl
  1555     02  eibcposn         pic s9(4) comp.
  1556     02  eibcalen         pic s9(4) comp.
  1557     02  eibaid           pic x(1).
  1558     02  eibfiller1       pic x(1).
  1559     02  eibfn            pic x(2).
  1560     02  eibfiller2       pic x(2).
  1561     02  eibrcode         pic x(6).
  1562     02  eibfiller3       pic x(2).
  1563     02  eibds            pic x(8).
  1564     02  eibreqid         pic x(8).
  1565     02  eibrsrce         pic x(8).
  1566     02  eibsync          pic x(1).
  1567     02  eibfree          pic x(1).
  1568     02  eibrecv          pic x(1).
  1569     02  eibsend          pic x(1).
  1570     02  eibatt           pic x(1).
  1571     02  eibeoc           pic x(1).
  1572     02  eibfmh           pic x(1).
  1573     02  eibcompl         pic x(1).
  1574     02  eibsig           pic x(1).
  1575     02  eibconf          pic x(1).
  1576     02  eiberr           pic x(1).
  1577     02  eibrldbk         pic x(1).
  1578     02  eiberrcd         pic x(4).
  1579     02  eibsynrb         pic x(1).
  1580     02  eibnodat         pic x(1).
  1581     02  eibfiller5       pic x(2).
  1582     02  eibresp          pic 9(09) comp.
  1583     02  eibresp2         pic 9(09) comp.
  1584     02  dfheigdj         pic s9(4) comp.
  1585     02  dfheigdk         pic s9(4) comp.
  1586 01  DFHCOMMAREA                 PIC X(1024).
  1587*                                COPY ELCCNTL.
  1588*                                COPY ERCBXRF.
  1589******************************************************************
  1590*                                                                *
  1591*                                                                *
  1592*                            ERCBXRF                             *
  1593*                                                                *
  1594*   ONLINE CREDIT SYSTEM                                         *
  1595*                                                                *
  1596*   FILE DESCRIPTION = BANK CROSS REFERENCE                      *
  1597*                                                                *
  1598*   FILE TYPE = VSAM,KSDS                                        *
  1599*   RECORD SIZE = 62 - 32,062   RECFORM = VARIABLE
  1600*                                                                *
  1601*   BASE CLUSTER NAME = ERBKRF                   RKP=2,LEN=18    *
  1602*       ALTERNATE PATH = NONE                                    *
  1603*                                                                *
  1604*   LOG = NO                                                     *
  1605*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1606*                                                                *
  1607******************************************************************
  1608
  1609 01  BANK-CROSS-REFERENCE.
  1610     12  BK-RECORD-ID                PIC XX.
  1611         88  VALID-BK-ID             VALUE 'BK'.
  1612
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6523T.cbl
  1613     12  BK-CONTROL-PRIMARY.
  1614         16  BK-COMPANY-CD           PIC X.
  1615         16  BK-CARRIER              PIC X.
  1616         16  BK-GROUPING             PIC X(6).
  1617         16  BK-BANK-NO              PIC X(10).
  1618
  1619     12  BK-MAINT-INFORMATION.
  1620         16  BK-LAST-MAINT-DT        PIC XX.
  1621         16  BK-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1622         16  BK-LAST-MAINT-USER      PIC X(4).
  1623         16  FILLER                  PIC X(9).
  1624
  1625     12  FILLER                      PIC X(37).
  1626
  1627     12  BK-BANK-POINTER-CNT         PIC S9(4)  COMP.
  1628
  1629     12  BK-BANK-POINTER   OCCURS 1 TO 725 TIMES
  1630                            DEPENDING ON BK-BANK-POINTER-CNT.
  1631         16  BK-AM-ACCOUNT           PIC X(10).
  1632         16  BK-AM-EXP-DT            PIC XX.
  1633         16  BK-AM-EFF-DT            PIC XX.
  1634         16  BK-AM-STATE             PIC XX.
  1635         16  FILLER                  PIC X(20).
  1636
  1637******************************************************************
  1638*                                COPY ERCACCT.
  1639 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1640                          BANK-CROSS-REFERENCE.
  1641 0000-DFHEXIT SECTION.
  1642     MOVE '9#                    $   ' TO DFHEIV0.
  1643     MOVE 'EL6523' TO DFHEIV1.
  1644     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1645     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  1646     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1647     MOVE '5'                   TO DC-OPTION-CODE.
  1648     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  1649     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1650     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1651     MOVE EIBTRMID              TO QID-TERM.
  1652
  1653* EXEC CICS HANDLE CONDITION
  1654*        ERROR     (9990-ABEND)
  1655*        MAPFAIL   (8100-SEND-INITIAL-MAP)
  1656*    END-EXEC.
  1657*    MOVE '"$.?                  ! " #00001648' TO DFHEIV0
  1658     MOVE X'22242E3F2020202020202020' TO DFHEIV0(1:12)
  1659     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1660     MOVE X'2220233030303031363438' TO DFHEIV0(25:11)
  1661     CALL 'kxdfhei1' USING DFHEIV0
  1662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1663
  1664     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1665         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1666*  THIS IS THE FIRST TIME THRU
  1667             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1668             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1669             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1670             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6523T.cbl
  1671             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1672             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1673             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1674             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1675             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  1676         ELSE
  1677* THIS IS WHEN I COME BACK FROM WHERE I XCTL'D TO
  1678             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1679             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1680             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1681             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1682             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1683             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1684             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1685             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  1686         END-IF
  1687* ALL SUBSEQUENT TIMES
  1688     END-IF
  1689     IF EIBTRNID = TRANS-ID
  1690         IF EIBAID = DFHCLEAR
  1691             GO TO 9400-CLEAR
  1692         ELSE
  1693             GO TO 0200-RECEIVE-MAP.
  1694     IF EIBTRNID  = EL652-TRANS-ID
  1695* THIS IS WHEN I CAME FROM COMP MAINT
  1696         MOVE DFHENTER       TO EIBAID
  1697         MOVE PI-CR-CARRIER  TO CARRIERI
  1698         MOVE PI-CR-GROUPING TO GROUPI
  1699         MOVE PI-CR-FIN-RESP TO BANKI
  1700         MOVE 'S'            TO MAINTYPI
  1701         MOVE 1              TO CARRIERL
  1702         MOVE 6              TO GROUPL
  1703         MOVE 10             TO BANKL
  1704         MOVE 1              TO MAINTYPL
  1705         MOVE AL-UANON       TO CARRIERA GROUPA BANKA MAINTYPA
  1706         GO TO 4000-EDIT-MAINT
  1707     END-IF
  1708     MOVE LOW-VALUES       TO PI-ERBXRF-KEY    EL652DI.
  1709     MOVE PI-COMPANY-CD    TO PI-BXRF-COMP-CD  WS-COMPANY-CD.
  1710     IF EIBTRNID  = EL650-TRANS-ID
  1711* THIS IS WHEN I CAME FROM ACCOUNT MAINT
  1712         GO TO 0600-RECOVER-TEMP-STORAGE.
  1713     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6523T.cbl
  1715 0200-RECEIVE-MAP.
  1716     MOVE LOW-VALUES             TO EL652DI
  1717
  1718* EXEC CICS RECEIVE
  1719*        MAP (MAP-NAME)
  1720*        MAPSET (MAPSET-NAME)
  1721*        INTO (EL652DI)
  1722*    END-EXEC
  1723     MOVE LENGTH OF
  1724      EL652DI
  1725       TO DFHEIV11
  1726*    MOVE '8"T I  L              ''   #00001705' TO DFHEIV0
  1727     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1728     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1729     MOVE X'2020233030303031373035' TO DFHEIV0(25:11)
  1730     CALL 'kxdfhei1' USING DFHEIV0,
  1731           MAP-NAME,
  1732           EL652DI,
  1733           DFHEIV11,
  1734           MAPSET-NAME,
  1735           DFHEIV99,
  1736           DFHEIV99
  1737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1738     IF PFENTERL = 0
  1739        GO TO 0300-CHECK-PFKEYS
  1740     END-IF
  1741     IF EIBAID NOT = DFHENTER
  1742        MOVE ER-0004             TO EMI-ERROR
  1743        GO TO 0320-INPUT-ERROR
  1744     END-IF
  1745     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  1746        MOVE PF-VALUES (PFENTERI)
  1747                                 TO EIBAID
  1748     ELSE
  1749        MOVE ER-0029             TO EMI-ERROR
  1750        GO TO 0320-INPUT-ERROR
  1751     END-IF
  1752     .
  1753 0300-CHECK-PFKEYS.
  1754     IF EIBAID = DFHPF23
  1755         GO TO 8810-PF23.
  1756     IF EIBAID = DFHPF24
  1757         GO TO 9200-RETURN-MAIN-MENU.
  1758     IF EIBAID = DFHPF12
  1759         GO TO 9500-PF12.
  1760     IF EIBAID = DFHPF1 OR DFHPF2
  1761        GO TO 5000-BROWSE-FILE
  1762     END-IF
  1763     IF EIBAID = DFHPF3 OR DFHPF4
  1764         GO TO 6000-OCCURRENCE.
  1765     IF EIBAID = DFHPF5
  1766         GO TO 4000-ACCT-MAINT.
  1767     IF EIBAID = DFHENTER
  1768        GO TO 4000-EDIT-MAINT
  1769     END-IF
  1770     MOVE ER-0029                TO EMI-ERROR
  1771     .
  1772 0320-INPUT-ERROR.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6523T.cbl
  1773     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1774     MOVE -1                     TO CARRIERL.
  1775     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6523T.cbl
  1777 0500-CREATE-TEMP-STORAGE.
  1778
  1779* EXEC CICS WRITEQ TS
  1780*        QUEUE   (QID)
  1781*        FROM    (EL652DI)
  1782*        LENGTH  (QID-MAP-LENGTH)
  1783*        END-EXEC.
  1784*    MOVE '*"                    ''   #00001750' TO DFHEIV0
  1785     MOVE X'2A2220202020202020202020' TO DFHEIV0(1:12)
  1786     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1787     MOVE X'2020233030303031373530' TO DFHEIV0(25:11)
  1788     CALL 'kxdfhei1' USING DFHEIV0,
  1789           QID,
  1790           EL652DI,
  1791           QID-MAP-LENGTH,
  1792           DFHEIV99,
  1793           DFHEIV99,
  1794           DFHEIV99
  1795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1796
  1797 0599-EXIT.
  1798      EXIT.
  1799 0600-RECOVER-TEMP-STORAGE.
  1800
  1801* EXEC CICS HANDLE CONDITION
  1802*        NOTFND  (1500-BXRF-NOT-FOUND)
  1803*        QIDERR  (0690-QIDERR)
  1804*        END-EXEC.
  1805*    MOVE '"$IN                  ! # #00001758' TO DFHEIV0
  1806     MOVE X'2224494E2020202020202020' TO DFHEIV0(1:12)
  1807     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1808     MOVE X'2320233030303031373538' TO DFHEIV0(25:11)
  1809     CALL 'kxdfhei1' USING DFHEIV0
  1810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1811
  1812
  1813* EXEC CICS READQ TS
  1814*        QUEUE    (QID)
  1815*        INTO     (EL652DI)
  1816*        LENGTH   (QID-MAP-LENGTH)
  1817*        END-EXEC.
  1818*    MOVE '*$I    L              ''   #00001762' TO DFHEIV0
  1819     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  1820     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1821     MOVE X'2020233030303031373632' TO DFHEIV0(25:11)
  1822     CALL 'kxdfhei1' USING DFHEIV0,
  1823           QID,
  1824           EL652DI,
  1825           QID-MAP-LENGTH,
  1826           DFHEIV99,
  1827           DFHEIV99,
  1828           DFHEIV99
  1829     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1830
  1831
  1832* EXEC CICS DELETEQ TS
  1833*        QUEUE   (QID)
  1834*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6523T.cbl
  1835*    MOVE '*&                    #   #00001767' TO DFHEIV0
  1836     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  1837     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1838     MOVE X'2020233030303031373637' TO DFHEIV0(25:11)
  1839     CALL 'kxdfhei1' USING DFHEIV0,
  1840           QID,
  1841           DFHEIV99
  1842     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1843     IF CARRIERL NOT = 0
  1844         MOVE AL-UANON TO CARRIERA.
  1845     IF GROUPL NOT = 0
  1846         MOVE AL-UANON TO GROUPA.
  1847     IF BANKL NOT = 0
  1848         MOVE AL-UANON TO BANKA.
  1849     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD.
  1850     MOVE CARRIERO               TO WS-CARRIER.
  1851     MOVE GROUPO                 TO WS-GROUPING.
  1852     MOVE BANKO                  TO WS-BANK.
  1853     GO TO 1050-READ-BANK.
  1854 0690-QIDERR.
  1855     MOVE ER-0033                TO EMI-ERROR
  1856     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  1857     GO TO 8100-SEND-INITIAL-MAP
  1858     .
  1859 4000-EDIT-MAINT.
  1860     IF MAINTYPL > ZERO
  1861        MOVE MAINTYPI            TO PI-CHECK-MAINT-TYPE
  1862        IF VALID-MAINT-TYPE
  1863           MOVE AL-UANON         TO MAINTYPA
  1864        ELSE
  1865           MOVE -1               TO MAINTYPL
  1866           MOVE AL-UABON         TO MAINTYPA
  1867           MOVE ER-2039          TO EMI-ERROR
  1868           PERFORM 9900-ERROR-FORMAT
  1869                                 THRU  9900-EXIT
  1870        END-IF
  1871     ELSE
  1872        MOVE -1                  TO MAINTYPL
  1873        MOVE AL-UABON            TO MAINTYPA
  1874        MOVE ER-2039             TO EMI-ERROR
  1875        PERFORM 9900-ERROR-FORMAT
  1876                                 THRU 9900-EXIT
  1877     END-IF
  1878     MOVE PI-COMPANY-CD          TO PI-ERC-COMPANY-CD
  1879     IF (NOT MODIFY-CAP)
  1880        AND (NOT SHOW-FUNCTION)
  1881        MOVE 'UPDATE'            TO SM-READ
  1882        PERFORM 9995-SECURITY-VIOLATION
  1883                                 THRU 9995-EXIT
  1884        MOVE ER-0070             TO EMI-ERROR
  1885        PERFORM 9900-ERROR-FORMAT
  1886                                 THRU 9900-EXIT
  1887        GO TO 8100-SEND-INITIAL-MAP
  1888     END-IF
  1889     IF CARRIERL > ZERO
  1890        IF PI-CARRIER-SECURITY > SPACES
  1891           IF CARRIERI = PI-CARRIER-SECURITY
  1892              CONTINUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6523T.cbl
  1893           ELSE
  1894              MOVE -1            TO CARRIERL
  1895              MOVE ER-2370       TO EMI-ERROR
  1896              PERFORM 9900-ERROR-FORMAT
  1897                                 THRU 9900-EXIT
  1898              MOVE AL-UABON      TO CARRIERA
  1899              GO TO 8200-SEND-DATAONLY
  1900           END-IF
  1901        END-IF
  1902     END-IF
  1903     IF CARRIERL > ZERO
  1904         IF ADD-FUNCTION
  1905             IF PI-ZERO-CARRIER
  1906               OR PI-ZERO-CAR-GROUP
  1907                 MOVE ZEROS      TO  PI-ERC-CARRIER
  1908                                     CARRIERI
  1909                 MOVE AL-UANON   TO  CARRIERA
  1910             ELSE
  1911                 MOVE CARRIERI   TO  WS-ACARRIER
  1912                                     PI-ERC-CARRIER
  1913                 MOVE '6'        TO  CNTL-REC-TYPE
  1914                 PERFORM 7400-READ-CONTROL-FILE  THRU  7499-EXIT
  1915         ELSE
  1916             IF PI-ZERO-CARRIER
  1917               OR PI-ZERO-CAR-GROUP
  1918                 MOVE ZEROS      TO  PI-ERC-CARRIER
  1919                                     CARRIERI
  1920                 MOVE AL-UANON   TO  CARRIERA
  1921             ELSE
  1922                 MOVE AL-UANON   TO  CARRIERA
  1923                 MOVE CARRIERI   TO  PI-ERC-CARRIER
  1924     ELSE
  1925         IF ADD-FUNCTION
  1926             IF PI-ZERO-CARRIER
  1927               OR PI-ZERO-CAR-GROUP
  1928                 MOVE ZEROS      TO  PI-ERC-CARRIER
  1929                                     CARRIERI
  1930                 MOVE AL-UANON   TO  CARRIERA
  1931             ELSE
  1932                 MOVE -1         TO  CARRIERL
  1933                 MOVE AL-UABON   TO  CARRIERA
  1934                 MOVE ER-0193    TO  EMI-ERROR
  1935                 PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  1936         ELSE
  1937             MOVE -1             TO  CARRIERL
  1938             MOVE AL-UABON       TO  CARRIERA
  1939             MOVE ER-0193        TO  EMI-ERROR
  1940             PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  1941     IF GROUPL > ZERO
  1942         IF PI-ZERO-GROUPING
  1943           OR PI-ZERO-CAR-GROUP
  1944             MOVE ZEROS          TO  PI-ERC-GROUP
  1945                                     GROUPI
  1946             MOVE AL-UANON       TO  GROUPA
  1947         ELSE
  1948             MOVE AL-UANON       TO  GROUPA
  1949             MOVE GROUPI         TO  PI-ERC-GROUP
  1950     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6523T.cbl
  1951         IF ADD-FUNCTION
  1952             IF PI-ZERO-GROUPING
  1953               OR PI-ZERO-CAR-GROUP
  1954                 MOVE ZEROS      TO  PI-ERC-GROUP
  1955                                     GROUPI
  1956                 MOVE AL-UANON   TO  GROUPA
  1957             ELSE
  1958                 MOVE LOW-VALUES  TO  PI-ERC-GROUP
  1959         ELSE
  1960             MOVE LOW-VALUES     TO  PI-ERC-GROUP.
  1961     IF BANKL > ZERO
  1962         MOVE AL-UANON           TO BANKA
  1963         MOVE BANKI              TO PI-ERC-BANK
  1964     ELSE
  1965         MOVE LOW-VALUES         TO PI-ERC-BANK
  1966     END-IF
  1967     IF NOT MODIFY-CAP
  1968         IF SHOW-FUNCTION
  1969             GO TO 1000-EDIT-INPUT
  1970         ELSE
  1971             MOVE 'UPDATE'       TO SM-READ
  1972             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1973             MOVE ER-0070        TO  EMI-ERROR
  1974             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1975             GO TO 8100-SEND-INITIAL-MAP.
  1976     IF EMI-NO-ERRORS
  1977        CONTINUE
  1978     ELSE
  1979        IF EIBTRNID NOT = TRANS-ID
  1980           GO TO 8100-SEND-INITIAL-MAP
  1981        ELSE
  1982           GO TO 8200-SEND-DATAONLY
  1983        END-IF
  1984     END-IF
  1985     IF CHANGE-FUNCTION
  1986        GO TO 4400-CHANGE
  1987     END-IF
  1988     IF DELETE-FUNCTION
  1989        GO TO 4600-DELETE
  1990     END-IF
  1991     IF SHOW-FUNCTION
  1992        GO TO 1000-EDIT-INPUT
  1993     END-IF
  1994     IF EMI-NO-ERRORS
  1995        CONTINUE
  1996     ELSE
  1997        GO TO 8200-SEND-DATAONLY
  1998     END-IF
  1999     IF ADD-FUNCTION
  2000        GO TO 4200-ADD
  2001     END-IF
  2002     MOVE -1                     TO MAINTYPL
  2003     MOVE ER-2056                TO EMI-ERROR
  2004     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  2005     GO TO 8200-SEND-DATAONLY
  2006     .
  2007 4000-EXIT.
  2008     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6523T.cbl
  2010 1000-EDIT-INPUT.
  2011     IF CARRIERL NOT = ZEROS
  2012        MOVE CARRIERI            TO WS-CARRIER
  2013     ELSE
  2014        MOVE ER-0234             TO EMI-ERROR
  2015        MOVE -1                  TO CARRIERL
  2016        MOVE AL-UABON            TO CARRIERA
  2017        PERFORM 9900-ERROR-FORMAT
  2018                                 THRU 9900-EXIT
  2019     END-IF
  2020     IF GROUPL NOT = ZEROS
  2021        MOVE GROUPI              TO WS-GROUPING
  2022     ELSE
  2023        MOVE ER-0235             TO EMI-ERROR
  2024        MOVE -1                  TO GROUPL
  2025        MOVE AL-UABON            TO GROUPA
  2026        PERFORM 9900-ERROR-FORMAT
  2027                                 THRU 9900-EXIT
  2028     END-IF
  2029     IF BANKL  NOT = ZEROS
  2030        MOVE BANKI               TO WS-BANK
  2031     ELSE
  2032        MOVE ER-6508             TO EMI-ERROR
  2033        MOVE -1                  TO BANKL
  2034        MOVE AL-UABON            TO BANKA
  2035        PERFORM 9900-ERROR-FORMAT
  2036                                 THRU 9900-EXIT
  2037     END-IF
  2038     IF NOT EMI-NO-ERRORS
  2039        GO TO 8200-SEND-DATAONLY
  2040     END-IF
  2041     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  2042     .
  2043 1050-READ-BANK.
  2044
  2045* EXEC CICS HANDLE CONDITION
  2046*         NOTFND (1500-BXRF-NOT-FOUND)
  2047*    END-EXEC
  2048*    MOVE '"$I                   ! $ #00001971' TO DFHEIV0
  2049     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2050     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2051     MOVE X'2420233030303031393731' TO DFHEIV0(25:11)
  2052     CALL 'kxdfhei1' USING DFHEIV0
  2053     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2054     PERFORM 7050-READ-ERBXRF    THRU 7050-EXIT
  2055     MOVE BK-LAST-MAINT-USER     TO PI-UPDATE-BY
  2056     IF BK-LAST-MAINT-HHMMSS NUMERIC
  2057        MOVE BK-LAST-MAINT-HHMMSS
  2058                                 TO PI-UPDATE-HHMMSS
  2059     ELSE
  2060        MOVE ZEROS               TO PI-UPDATE-HHMMSS
  2061     END-IF
  2062     MOVE WS-CONTROL-PRIMARY     TO PI-SAVE-ERBXRF-KEY
  2063     MOVE +1                     TO PI-NDX
  2064                                    PI-TOP-NDX
  2065     MOVE ER-0000                TO EMI-ERROR
  2066     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  2067     GO TO 5200-FORMAT-SCREEN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6523T.cbl
  2068     .
  2069 1500-BXRF-NOT-FOUND.
  2070     MOVE ER-0142                TO EMI-ERROR
  2071     MOVE -1                     TO CARRIERL
  2072     MOVE AL-UABON               TO CARRIERA
  2073     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  2074     IF EIBTRNID  = EL652-TRANS-ID
  2075        GO TO 8100-SEND-INITIAL-MAP
  2076     ELSE
  2077        GO TO 8200-SEND-DATAONLY
  2078     END-IF
  2079     .
  2080 3000-BLD-LINE.
  2081     MOVE 1                      TO NDX
  2082     .
  2083 3000-BLD-LINE-LOOP.
  2084     IF PI-NDX > BK-BANK-POINTER-CNT
  2085        GO TO 3000-XIT
  2086     END-IF
  2087     MOVE BK-AM-ACCOUNT (PI-NDX) TO BL-ACCOUNT (NDX)
  2088     IF BK-AM-EFF-DT (PI-NDX) NOT = SPACES AND LOW-VALUES
  2089        MOVE BK-AM-EFF-DT (PI-NDX)
  2090                                 TO DC-BIN-DATE-1
  2091        MOVE SPACE               TO DC-OPTION-CODE
  2092        PERFORM 8500-DATE-CONVERT
  2093                                 THRU 8500-EXIT
  2094        MOVE DC-GREG-DATE-1-EDIT TO BL-EFFECT (NDX)
  2095     END-IF
  2096     IF BK-AM-EXP-DT (PI-NDX) NOT = SPACES AND LOW-VALUES
  2097        AND HIGH-VALUES
  2098        MOVE BK-AM-EXP-DT (PI-NDX)
  2099                                 TO DC-BIN-DATE-1
  2100        MOVE SPACE               TO DC-OPTION-CODE
  2101        PERFORM 8500-DATE-CONVERT
  2102                                 THRU 8500-EXIT
  2103        MOVE DC-GREG-DATE-1-EDIT TO BL-EXPIRE (NDX)
  2104     END-IF
  2105     IF BK-AM-EXP-DT (PI-NDX) = HIGH-VALUES
  2106        MOVE '99/99/99'          TO BL-EXPIRE (NDX)
  2107      END-IF
  2108*    MOVE BK-AM-LEVEL-NO (PI-NDX)       TO BL-LEVEL.
  2109     MOVE BK-AM-STATE (PI-NDX)   TO BL-STATE (NDX)
  2110     IF (PI-NDX = BK-BANK-POINTER-CNT)  OR  (NDX = 13)
  2111         GO TO 3000-XIT
  2112     END-IF
  2113     ADD 1                       TO PI-NDX NDX
  2114     GO TO 3000-BLD-LINE-LOOP
  2115     .
  2116 3000-XIT.
  2117     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6523T.cbl
  2119 4000-ACCT-MAINT.
  2120     IF (CARRIERI    NOT = PI-BXRF-CARRIER)
  2121        OR (GROUPI   NOT = PI-BXRF-GROUPING)
  2122        OR (BANKI    NOT = PI-BXRF-BANK)
  2123        MOVE ER-5005             TO EMI-ERROR
  2124        GO TO 4050-ERR
  2125     END-IF
  2126     IF ACCOCCI NOT NUMERIC
  2127        GO TO 4010-ERROR
  2128     END-IF
  2129     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  2130     MOVE CARRIERI               TO WS-CARRIER
  2131     MOVE GROUPI                 TO WS-GROUPING
  2132     MOVE BANKI                  TO WS-BANK
  2133
  2134* EXEC CICS HANDLE CONDITION
  2135*         NOTFND (4010-ERROR)
  2136*    END-EXEC
  2137*    MOVE '"$I                   ! % #00002053' TO DFHEIV0
  2138     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2139     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2140     MOVE X'2520233030303032303533' TO DFHEIV0(25:11)
  2141     CALL 'kxdfhei1' USING DFHEIV0
  2142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2143     PERFORM 7050-READ-ERBXRF    THRU 7050-EXIT
  2144     MOVE ACCOCCI                TO NDX
  2145     COMPUTE NDX = PI-TOP-NDX + NDX - 1
  2146     IF NDX  NOT > BK-BANK-POINTER-CNT
  2147        MOVE BK-CARRIER          TO PI-CR-CARRIER
  2148        MOVE BK-GROUPING         TO PI-CR-GROUPING
  2149        MOVE BK-AM-STATE (NDX)   TO PI-CR-STATE
  2150        MOVE BK-AM-ACCOUNT (NDX) TO PI-CR-ACCOUNT
  2151        PERFORM 0500-CREATE-TEMP-STORAGE
  2152                                 THRU 0599-EXIT
  2153        MOVE XCTL-650            TO PGM-NAME
  2154        GO TO 9300-XCTL
  2155     END-IF
  2156     .
  2157 4010-ERROR.
  2158      MOVE ER-5004 TO EMI-ERROR.
  2159 4050-ERR.
  2160      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2161      MOVE -1                     TO ACCOCCL.
  2162      MOVE AL-UNBON               TO ACCOCCA.
  2163      GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6523T.cbl
  2165 4200-ADD.
  2166*    PERFORM 7000-EDIT           THRU 7000-EXIT
  2167     IF EMI-NO-ERRORS
  2168        CONTINUE
  2169     ELSE
  2170        GO TO 8200-SEND-DATAONLY
  2171     END-IF
  2172
  2173* EXEC CICS HANDLE CONDITION
  2174*        NOTOPEN  (9990-ABEND)
  2175*        NOTFND   (4250-CONT)
  2176*    END-EXEC.
  2177*    MOVE '"$JI                  ! & #00002085' TO DFHEIV0
  2178     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  2179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2180     MOVE X'2620233030303032303835' TO DFHEIV0(25:11)
  2181     CALL 'kxdfhei1' USING DFHEIV0
  2182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2183
  2184     MOVE PI-ERC-KEY             TO WS-CONTROL-PRIMARY
  2185     PERFORM 7050-READ-ERBXRF    THRU 7050-EXIT
  2186     MOVE ER-2057                TO EMI-ERROR
  2187     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  2188     MOVE LOW-VALUES             TO PI-SAVE-ERBXRF-KEY
  2189     MOVE -1                     TO  MAINTYPL
  2190     GO TO 8200-SEND-DATAONLY
  2191     .
  2192 4250-CONT.
  2193
  2194* EXEC CICS GETMAIN
  2195*        SET      (ADDRESS OF BANK-CROSS-REFERENCE)
  2196*        LENGTH   (BXRF-REC-LENGTH)
  2197*        INITIMG  (GETMAIN-SPACE)
  2198*    END-EXEC
  2199*    MOVE ',"IL                  $   #00002098' TO DFHEIV0
  2200     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  2201     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2202     MOVE X'2020233030303032303938' TO DFHEIV0(25:11)
  2203     CALL 'kxdfhei1' USING DFHEIV0,
  2204           DFHEIV20,
  2205           BXRF-REC-LENGTH,
  2206           GETMAIN-SPACE
  2207     SET ADDRESS OF BANK-CROSS-REFERENCE TO
  2208         DFHEIV20
  2209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2210     MOVE SPACES                 TO BANK-CROSS-REFERENCE
  2211     MOVE PI-COMPANY-CD          TO BK-COMPANY-CD
  2212     MOVE 'BK'                   TO BK-RECORD-ID
  2213     MOVE PI-ERC-KEY             TO BK-CONTROL-PRIMARY
  2214     MOVE +1                     TO PI-NDX
  2215     SET NO-CHANGES-MADE         TO TRUE
  2216     PERFORM 7300-EDIT-DATA      THRU 7300-EXIT
  2217     IF EMI-NO-ERRORS
  2218        CONTINUE
  2219     ELSE
  2220
  2221* EXEC CICS UNLOCK
  2222*            DATASET  (BXRF-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6523T.cbl
  2223*       END-EXEC
  2224*    MOVE '&*                    #   #00002113' TO DFHEIV0
  2225     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  2226     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2227     MOVE X'2020233030303032313133' TO DFHEIV0(25:11)
  2228     CALL 'kxdfhei1' USING DFHEIV0,
  2229           BXRF-FILE-ID,
  2230           DFHEIV99
  2231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2232        GO TO 8200-SEND-DATAONLY
  2233     END-IF
  2234     PERFORM 7325-COMPRESS       THRU 7325-EXIT
  2235     MOVE PI-NDX                 TO BK-BANK-POINTER-CNT
  2236     PERFORM 7510-SORT-ACCOUNTS  THRU 7599-EXIT
  2237     MOVE PI-PROCESSOR-ID        TO BK-LAST-MAINT-USER
  2238     MOVE EIBTIME                TO BK-LAST-MAINT-HHMMSS
  2239     MOVE SAVE-BIN-DATE          TO BK-LAST-MAINT-DT
  2240
  2241* EXEC CICS WRITE
  2242*        DATASET  (BXRF-FILE-ID)
  2243*        FROM     (BANK-CROSS-REFERENCE)
  2244*        RIDFLD   (BK-CONTROL-PRIMARY)
  2245*    END-EXEC
  2246     MOVE LENGTH OF
  2247      BANK-CROSS-REFERENCE
  2248       TO DFHEIV11
  2249*    MOVE '&$ L                  ''   #00002124' TO DFHEIV0
  2250     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2251     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2252     MOVE X'2020233030303032313234' TO DFHEIV0(25:11)
  2253     CALL 'kxdfhei1' USING DFHEIV0,
  2254           BXRF-FILE-ID,
  2255           BANK-CROSS-REFERENCE,
  2256           DFHEIV11,
  2257           BK-CONTROL-PRIMARY,
  2258           DFHEIV99,
  2259           DFHEIV99
  2260     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2261     MOVE LOW-VALUES             TO EL652DO
  2262     MOVE 'S'                    TO MAINTYPO
  2263     MOVE +1                     TO MAINTYPL
  2264     MOVE AL-UANON               TO MAINTYPA
  2265     MOVE PI-ERC-CARRIER         TO CARRIERO
  2266     MOVE AL-UANON               TO CARRIERA
  2267     MOVE +1                     TO CARRIERL
  2268     IF PI-ERC-GROUP NOT = SPACES
  2269         MOVE PI-ERC-GROUP       TO GROUPO
  2270         MOVE AL-UANON           TO GROUPA
  2271         MOVE +6                 TO GROUPL
  2272     END-IF
  2273     IF PI-ERC-BANK NOT = SPACES
  2274        MOVE PI-ERC-BANK         TO BANKO
  2275        MOVE AL-UANON            TO BANKA
  2276        MOVE +10                 TO BANKL
  2277     END-IF
  2278     GO TO 1000-EDIT-INPUT
  2279     .
  2280 4200-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6523T.cbl
  2281     EXIT.
  2282 4400-CHANGE.
  2283     IF PI-ERC-KEY = PI-SAVE-ERBXRF-KEY
  2284        CONTINUE
  2285     ELSE
  2286        MOVE ER-2056             TO EMI-ERROR
  2287        PERFORM 9900-ERROR-FORMAT
  2288                                 THRU 9900-EXIT
  2289        MOVE -1                  TO MAINTYPL
  2290        GO TO 8200-SEND-DATAONLY
  2291     END-IF
  2292     MOVE PI-ERC-KEY             TO WS-CONTROL-PRIMARY
  2293     PERFORM 7200-READ-ERBXRF-UPDATE
  2294                                 THRU 7200-EXIT
  2295     IF (BK-LAST-MAINT-USER = PI-UPDATE-BY)
  2296        AND (BK-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS)
  2297        CONTINUE
  2298     ELSE
  2299
  2300* EXEC CICS UNLOCK
  2301*            DATASET  (BXRF-FILE-ID)
  2302*       END-EXEC
  2303*    MOVE '&*                    #   #00002167' TO DFHEIV0
  2304     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  2305     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2306     MOVE X'2020233030303032313637' TO DFHEIV0(25:11)
  2307     CALL 'kxdfhei1' USING DFHEIV0,
  2308           BXRF-FILE-ID,
  2309           DFHEIV99
  2310     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2311        MOVE ER-0068             TO EMI-ERROR
  2312        PERFORM 9900-ERROR-FORMAT
  2313                                 THRU  9900-EXIT
  2314        GO TO 8200-SEND-DATAONLY
  2315     END-IF
  2316     MOVE PI-TOP-NDX             TO PI-NDX
  2317     SET NO-CHANGES-MADE         TO TRUE
  2318     PERFORM 7300-EDIT-DATA      THRU 7300-EXIT
  2319     IF EMI-NO-ERRORS
  2320        CONTINUE
  2321     ELSE
  2322
  2323* EXEC CICS UNLOCK
  2324*            DATASET  (BXRF-FILE-ID)
  2325*       END-EXEC
  2326*    MOVE '&*                    #   #00002181' TO DFHEIV0
  2327     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  2328     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2329     MOVE X'2020233030303032313831' TO DFHEIV0(25:11)
  2330     CALL 'kxdfhei1' USING DFHEIV0,
  2331           BXRF-FILE-ID,
  2332           DFHEIV99
  2333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2334        GO TO 8200-SEND-DATAONLY
  2335     END-IF
  2336     IF NO-CHANGES-MADE
  2337        MOVE ER-3112             TO EMI-ERROR
  2338        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6523T.cbl
  2339                                 THRU 9900-EXIT
  2340        MOVE -1                  TO MAINTYPL
  2341        GO TO 8200-SEND-DATAONLY
  2342     END-IF
  2343     COMPUTE PI-NDX = BK-BANK-POINTER-CNT + +13
  2344     PERFORM 7325-COMPRESS       THRU 7325-EXIT
  2345     MOVE PI-NDX                 TO BK-BANK-POINTER-CNT
  2346     PERFORM 7510-SORT-ACCOUNTS  THRU 7599-EXIT
  2347     MOVE PI-PROCESSOR-ID        TO BK-LAST-MAINT-USER
  2348     MOVE EIBTIME                TO BK-LAST-MAINT-HHMMSS
  2349     MOVE SAVE-BIN-DATE          TO BK-LAST-MAINT-DT
  2350
  2351* EXEC CICS REWRITE
  2352*        DATASET  (BXRF-FILE-ID)
  2353*        FROM     (BANK-CROSS-REFERENCE)
  2354*    END-EXEC
  2355     MOVE LENGTH OF
  2356      BANK-CROSS-REFERENCE
  2357       TO DFHEIV11
  2358*    MOVE '&& L                  %   #00002200' TO DFHEIV0
  2359     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2360     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2361     MOVE X'2020233030303032323030' TO DFHEIV0(25:11)
  2362     CALL 'kxdfhei1' USING DFHEIV0,
  2363           BXRF-FILE-ID,
  2364           BANK-CROSS-REFERENCE,
  2365           DFHEIV11,
  2366           DFHEIV99
  2367     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2368     GO TO 1000-EDIT-INPUT
  2369     .
  2370 4600-DELETE.
  2371     IF PI-ERC-KEY = PI-SAVE-ERBXRF-KEY
  2372        CONTINUE
  2373     ELSE
  2374        MOVE ER-2056             TO EMI-ERROR
  2375        PERFORM 9900-ERROR-FORMAT
  2376                                 THRU 9900-EXIT
  2377        MOVE -1                  TO MAINTYPL
  2378        GO TO 8200-SEND-DATAONLY
  2379     END-IF
  2380     MOVE PI-ERC-KEY             TO WS-CONTROL-PRIMARY
  2381     PERFORM 7200-READ-ERBXRF-UPDATE
  2382                                 THRU 7200-EXIT
  2383     IF (BK-LAST-MAINT-USER = PI-UPDATE-BY)
  2384        AND (BK-LAST-MAINT-HHMMSS = PI-UPDATE-HHMMSS)
  2385        CONTINUE
  2386     ELSE
  2387
  2388* EXEC CICS UNLOCK
  2389*            DATASET  (BXRF-FILE-ID)
  2390*       END-EXEC
  2391*    MOVE '&*                    #   #00002223' TO DFHEIV0
  2392     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  2393     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2394     MOVE X'2020233030303032323233' TO DFHEIV0(25:11)
  2395     CALL 'kxdfhei1' USING DFHEIV0,
  2396           BXRF-FILE-ID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6523T.cbl
  2397           DFHEIV99
  2398     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2399        MOVE ER-0068             TO EMI-ERROR
  2400        PERFORM 9900-ERROR-FORMAT
  2401                                 THRU  9900-EXIT
  2402        GO TO 8200-SEND-DATAONLY
  2403     END-IF
  2404
  2405* EXEC CICS DELETE
  2406*        DATASET  (BXRF-FILE-ID)
  2407*    END-EXEC
  2408*    MOVE '&(                    &   #00002231' TO DFHEIV0
  2409     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2410     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2411     MOVE X'2020233030303032323331' TO DFHEIV0(25:11)
  2412     CALL 'kxdfhei1' USING DFHEIV0,
  2413           BXRF-FILE-ID,
  2414           DFHEIV99,
  2415           DFHEIV99,
  2416           DFHEIV99,
  2417           DFHEIV99
  2418     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2419     MOVE ER-0000                TO  EMI-ERROR
  2420     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT
  2421     MOVE LOW-VALUES             TO  EL652DO
  2422     MOVE PI-ERC-CARRIER         TO  CARRIERO
  2423     MOVE AL-UANON               TO  CARRIERA
  2424     IF PI-ERC-GROUP NOT = SPACES
  2425         MOVE PI-ERC-GROUP       TO  GROUPO
  2426         MOVE AL-UANON           TO  GROUPA
  2427     END-IF
  2428     IF PI-ERC-BANK NOT = SPACES
  2429        MOVE PI-ERC-BANK        TO  BANKO
  2430        MOVE AL-UANON           TO  BANKA
  2431     END-IF
  2432     MOVE LOW-VALUES             TO  PI-SAVE-ERBXRF-KEY
  2433     GO TO 8100-SEND-INITIAL-MAP
  2434     .
  2435 4600-EXIT.
  2436     EXIT.
  2437 5000-BROWSE-FILE.
  2438     MOVE SPACE                  TO BROWSE-STARTED-SW
  2439
  2440* EXEC CICS HANDLE CONDITION
  2441*        NOTFND (5800-NO-RECORD)
  2442*        ENDFILE (5900-END-OF-FILE)
  2443*    END-EXEC
  2444*    MOVE '"$I''                  ! '' #00002254' TO DFHEIV0
  2445     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  2446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2447     MOVE X'2720233030303032323534' TO DFHEIV0(25:11)
  2448     CALL 'kxdfhei1' USING DFHEIV0
  2449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2450     MOVE PI-SAVE-ERBXRF-KEY     TO WS-CONTROL-PRIMARY
  2451
  2452* EXEC CICS STARTBR
  2453*        DATASET (BXRF-FILE-ID)
  2454*        RIDFLD (WS-CONTROL-PRIMARY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6523T.cbl
  2455*    END-EXEC
  2456     MOVE 0
  2457       TO DFHEIV11
  2458*    MOVE '&,         G          &   #00002259' TO DFHEIV0
  2459     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2460     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2461     MOVE X'2020233030303032323539' TO DFHEIV0(25:11)
  2462     CALL 'kxdfhei1' USING DFHEIV0,
  2463           BXRF-FILE-ID,
  2464           WS-CONTROL-PRIMARY,
  2465           DFHEIV99,
  2466           DFHEIV11,
  2467           DFHEIV99
  2468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2469     MOVE 'Y'                    TO BROWSE-STARTED-SW
  2470     IF EIBAID = DFHPF2
  2471        GO TO 5100-BROWSE-BKWD
  2472     END-IF
  2473     .
  2474 5010-READ-LOOP.
  2475     MOVE BXRF-MAX-REC-LENGTH    TO BXRF-REC-LENGTH
  2476
  2477* EXEC CICS READNEXT
  2478*        DATASET (BXRF-FILE-ID)
  2479*        SET     (ADDRESS OF BANK-CROSS-REFERENCE)
  2480*        RIDFLD  (WS-CONTROL-PRIMARY)
  2481*        LENGTH  (BXRF-REC-LENGTH)
  2482*    END-EXEC
  2483     MOVE 0
  2484       TO DFHEIV11
  2485*    MOVE '&.SL                  )   #00002270' TO DFHEIV0
  2486     MOVE X'262E534C2020202020202020' TO DFHEIV0(1:12)
  2487     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2488     MOVE X'2020233030303032323730' TO DFHEIV0(25:11)
  2489     CALL 'kxdfhei1' USING DFHEIV0,
  2490           BXRF-FILE-ID,
  2491           DFHEIV20,
  2492           BXRF-REC-LENGTH,
  2493           WS-CONTROL-PRIMARY,
  2494           DFHEIV99,
  2495           DFHEIV11,
  2496           DFHEIV99,
  2497           DFHEIV99
  2498     SET ADDRESS OF BANK-CROSS-REFERENCE TO
  2499         DFHEIV20
  2500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2501     MOVE BK-BANK-POINTER-CNT    TO BK-BANK-POINTER-CNT
  2502     MOVE +1                     TO PI-NDX
  2503     IF BK-COMPANY-CD NOT = PI-COMPANY-CD
  2504        GO TO 5900-END-OF-FILE
  2505     END-IF
  2506     IF EIBAID = DFHPF1
  2507        IF CARRIERO     = BK-CARRIER
  2508           AND GROUPO   = BK-GROUPING
  2509           AND BANKO    = BK-BANK-NO
  2510           GO TO 5010-READ-LOOP
  2511        END-IF
  2512     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6523T.cbl
  2513     MOVE BK-LAST-MAINT-USER     TO PI-UPDATE-BY
  2514     IF BK-LAST-MAINT-HHMMSS NUMERIC
  2515        MOVE BK-LAST-MAINT-HHMMSS
  2516                                 TO PI-UPDATE-HHMMSS
  2517     ELSE
  2518        MOVE ZEROS               TO PI-UPDATE-HHMMSS
  2519     END-IF
  2520     MOVE BK-CONTROL-PRIMARY     TO PI-SAVE-ERBXRF-KEY
  2521     GO TO 5200-FORMAT-SCREEN
  2522     .
  2523 5100-BROWSE-BKWD.
  2524
  2525* EXEC CICS HANDLE CONDITION
  2526*         NOTFND (5900-END-OF-FILE)
  2527*    END-EXEC
  2528*    MOVE '"$I                   ! ( #00002299' TO DFHEIV0
  2529     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2530     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2531     MOVE X'2820233030303032323939' TO DFHEIV0(25:11)
  2532     CALL 'kxdfhei1' USING DFHEIV0
  2533     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2534     MOVE BXRF-MAX-REC-LENGTH    TO BXRF-REC-LENGTH
  2535
  2536* EXEC CICS READPREV
  2537*        DATASET (BXRF-FILE-ID)
  2538*        SET     (ADDRESS OF BANK-CROSS-REFERENCE)
  2539*        LENGTH  (BXRF-REC-LENGTH)
  2540*        RIDFLD  (WS-CONTROL-PRIMARY)
  2541*    END-EXEC
  2542     MOVE 0
  2543       TO DFHEIV11
  2544*    MOVE '&0SL                  )   #00002303' TO DFHEIV0
  2545     MOVE X'2630534C2020202020202020' TO DFHEIV0(1:12)
  2546     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2547     MOVE X'2020233030303032333033' TO DFHEIV0(25:11)
  2548     CALL 'kxdfhei1' USING DFHEIV0,
  2549           BXRF-FILE-ID,
  2550           DFHEIV20,
  2551           BXRF-REC-LENGTH,
  2552           WS-CONTROL-PRIMARY,
  2553           DFHEIV99,
  2554           DFHEIV11,
  2555           DFHEIV99,
  2556           DFHEIV99
  2557     SET ADDRESS OF BANK-CROSS-REFERENCE TO
  2558         DFHEIV20
  2559     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2560     MOVE BXRF-MAX-REC-LENGTH    TO BXRF-REC-LENGTH
  2561     IF PI-FILE-EOF
  2562        MOVE SPACE               TO PI-EOF-SW
  2563     ELSE
  2564
  2565* EXEC CICS READPREV
  2566*            DATASET (BXRF-FILE-ID)
  2567*            SET     (ADDRESS OF BANK-CROSS-REFERENCE)
  2568*            LENGTH  (BXRF-REC-LENGTH)
  2569*            RIDFLD  (WS-CONTROL-PRIMARY)
  2570*       END-EXEC
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6523T.cbl
  2571     MOVE 0
  2572       TO DFHEIV11
  2573*    MOVE '&0SL                  )   #00002313' TO DFHEIV0
  2574     MOVE X'2630534C2020202020202020' TO DFHEIV0(1:12)
  2575     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2576     MOVE X'2020233030303032333133' TO DFHEIV0(25:11)
  2577     CALL 'kxdfhei1' USING DFHEIV0,
  2578           BXRF-FILE-ID,
  2579           DFHEIV20,
  2580           BXRF-REC-LENGTH,
  2581           WS-CONTROL-PRIMARY,
  2582           DFHEIV99,
  2583           DFHEIV11,
  2584           DFHEIV99,
  2585           DFHEIV99
  2586     SET ADDRESS OF BANK-CROSS-REFERENCE TO
  2587         DFHEIV20
  2588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2589     END-IF
  2590     MOVE BK-BANK-POINTER-CNT TO BK-BANK-POINTER-CNT
  2591     MOVE +1                     TO PI-NDX
  2592     IF BK-COMPANY-CD NOT = PI-COMPANY-CD
  2593        GO TO 5900-END-OF-FILE
  2594     END-IF
  2595     MOVE BK-LAST-MAINT-USER     TO PI-UPDATE-BY
  2596     IF BK-LAST-MAINT-HHMMSS NUMERIC
  2597        MOVE BK-LAST-MAINT-HHMMSS
  2598                                 TO PI-UPDATE-HHMMSS
  2599     ELSE
  2600        MOVE ZEROS               TO PI-UPDATE-HHMMSS
  2601     END-IF
  2602     MOVE BK-CONTROL-PRIMARY     TO PI-SAVE-ERBXRF-KEY
  2603     GO TO 5200-FORMAT-SCREEN
  2604     .
  2605 5200-FORMAT-SCREEN.
  2606     MOVE LOW-VALUES             TO EL652DI
  2607     MOVE BK-CONTROL-PRIMARY     TO PI-ERBXRF-KEY
  2608     MOVE BK-CARRIER             TO CARRIERO
  2609     MOVE BK-GROUPING            TO GROUPO
  2610     MOVE BK-BANK-NO             TO BANKO
  2611     MOVE BK-BANK-POINTER-CNT    TO TOTOCCO
  2612     PERFORM 7500-COUNT-OPEN-RANGES
  2613                                 THRU 7500-EXIT
  2614     MOVE WS-OPEN-COUNT          TO TOTOPNO
  2615     IF BK-LAST-MAINT-DT NOT = SPACES AND LOW-VALUES AND ZEROS
  2616        MOVE BK-LAST-MAINT-DT    TO DC-BIN-DATE-1
  2617        MOVE SPACE               TO DC-OPTION-CODE
  2618        PERFORM 8500-DATE-CONVERT
  2619                                 THRU 8500-EXIT
  2620        MOVE DC-GREG-DATE-1-EDIT TO MAINTDTO
  2621     ELSE
  2622        MOVE '00/00/00'          TO MAINTDTO
  2623      END-IF
  2624     PERFORM 3000-BLD-LINE       THRU 3000-XIT
  2625     MOVE AL-UANON               TO CARRIERA GROUPA
  2626                                    BANKA
  2627     GO TO 8100-SEND-INITIAL-MAP
  2628     .
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6523T.cbl
  2629 5800-NO-RECORD.
  2630     MOVE -1                     TO CARRIERL.
  2631     MOVE AL-UANON               TO CARRIERA   GROUPA
  2632                                     BANKA
  2633     MOVE ER-1164                TO EMI-ERROR.
  2634     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2635     IF BROWSE-STARTED
  2636
  2637* EXEC CICS ENDBR
  2638*           DATASET  (BXRF-FILE-ID)
  2639*           END-EXEC.
  2640     MOVE 0
  2641       TO DFHEIV11
  2642*    MOVE '&2                    $   #00002366' TO DFHEIV0
  2643     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2644     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2645     MOVE X'2020233030303032333636' TO DFHEIV0(25:11)
  2646     CALL 'kxdfhei1' USING DFHEIV0,
  2647           BXRF-FILE-ID,
  2648           DFHEIV11,
  2649           DFHEIV99
  2650     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2651
  2652     GO TO 8200-SEND-DATAONLY.
  2653 5900-END-OF-FILE.
  2654     IF EIBAID = DFHPF1
  2655         MOVE 'Y'                TO PI-EOF-SW
  2656         MOVE ER-2237            TO EMI-ERROR
  2657     ELSE
  2658         MOVE LOW-VALUES         TO PI-ERBXRF-KEY
  2659         MOVE PI-COMPANY-CD      TO PI-BXRF-COMP-CD
  2660         MOVE ER-2238            TO EMI-ERROR.
  2661     MOVE -1            TO CARRIERL.
  2662     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2663     IF BROWSE-STARTED
  2664
  2665* EXEC CICS ENDBR
  2666*           DATASET  (BXRF-FILE-ID)
  2667*           END-EXEC.
  2668     MOVE 0
  2669       TO DFHEIV11
  2670*    MOVE '&2                    $   #00002381' TO DFHEIV0
  2671     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2672     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2673     MOVE X'2020233030303032333831' TO DFHEIV0(25:11)
  2674     CALL 'kxdfhei1' USING DFHEIV0,
  2675           BXRF-FILE-ID,
  2676           DFHEIV11,
  2677           DFHEIV99
  2678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2679
  2680     MOVE SPACE TO BROWSE-STARTED-SW.
  2681     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6523T.cbl
  2683 6000-OCCURRENCE.
  2684     MOVE PI-ERBXRF-KEY          TO WS-CONTROL-PRIMARY
  2685
  2686* EXEC CICS HANDLE CONDITION
  2687*        NOTFND (1500-BXRF-NOT-FOUND)
  2688*    END-EXEC
  2689*    MOVE '"$I                   ! ) #00002389' TO DFHEIV0
  2690     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2691     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2692     MOVE X'2920233030303032333839' TO DFHEIV0(25:11)
  2693     CALL 'kxdfhei1' USING DFHEIV0
  2694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2695     PERFORM 7050-READ-ERBXRF    THRU 7050-EXIT
  2696     IF EIBAID = DFHPF3
  2697        GO TO 6500-NEXT-OCC
  2698     ELSE
  2699        GO TO 7000-PRIOR-OCC
  2700     END-IF
  2701     .
  2702 6500-NEXT-OCC.
  2703*    IF PI-NDX = BK-BANK-POINTER-CNT
  2704*       MOVE -1                  TO CARRIERL
  2705*       MOVE ER-0130             TO EMI-ERROR
  2706*       PERFORM 9900-ERROR-FORMAT
  2707*                                THRU 9900-EXIT
  2708*       GO TO 8200-SEND-DATAONLY
  2709*    END-IF
  2710     ADD +1                      TO PI-NDX
  2711     MOVE PI-NDX                 TO PI-TOP-NDX
  2712     GO TO 5200-FORMAT-SCREEN
  2713     .
  2714 7000-PRIOR-OCC.
  2715     IF PI-NDX LESS 14
  2716        MOVE -1                  TO CARRIERL
  2717        MOVE ER-0131             TO EMI-ERROR
  2718        PERFORM 9900-ERROR-FORMAT
  2719                                 THRU 9900-EXIT
  2720        GO TO 8200-SEND-DATAONLY
  2721     END-IF
  2722     COMPUTE PI-NDX = (PI-NDX - 1) / 13
  2723     IF PI-NDX NOT = 1
  2724        COMPUTE PI-NDX = PI-NDX * 13
  2725        COMPUTE PI-NDX = PI-NDX - 12
  2726     END-IF
  2727     MOVE PI-NDX                 TO PI-TOP-NDX
  2728     GO TO 5200-FORMAT-SCREEN
  2729     .
  2730 7050-READ-ERBXRF.
  2731     MOVE BXRF-MAX-REC-LENGTH    TO BXRF-REC-LENGTH
  2732
  2733* EXEC CICS READ
  2734*         SET     (ADDRESS OF BANK-CROSS-REFERENCE)
  2735*         DATASET ('ERBXRF')
  2736*         LENGTH  (BXRF-REC-LENGTH)
  2737*         RIDFLD  (WS-CONTROL-PRIMARY)
  2738*    END-EXEC
  2739     MOVE 'ERBXRF' TO DFHEIV1
  2740*    MOVE '&"SL       E          (   #00002429' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6523T.cbl
  2741     MOVE X'2622534C2020202020202045' TO DFHEIV0(1:12)
  2742     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2743     MOVE X'2020233030303032343239' TO DFHEIV0(25:11)
  2744     CALL 'kxdfhei1' USING DFHEIV0,
  2745           DFHEIV1,
  2746           DFHEIV20,
  2747           BXRF-REC-LENGTH,
  2748           WS-CONTROL-PRIMARY,
  2749           DFHEIV99,
  2750           DFHEIV99,
  2751           DFHEIV99
  2752     SET ADDRESS OF BANK-CROSS-REFERENCE TO
  2753         DFHEIV20
  2754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2755     MOVE BK-BANK-POINTER-CNT    TO BK-BANK-POINTER-CNT
  2756     .
  2757 7050-EXIT.
  2758     EXIT.
  2759 7200-READ-ERBXRF-UPDATE.
  2760
  2761* EXEC CICS HANDLE CONDITION
  2762*        NOTFND (7200-BXRF-NOT-FOUND)
  2763*    END-EXEC
  2764*    MOVE '"$I                   ! * #00002440' TO DFHEIV0
  2765     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2766     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2767     MOVE X'2A20233030303032343430' TO DFHEIV0(25:11)
  2768     CALL 'kxdfhei1' USING DFHEIV0
  2769     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2770     MOVE BXRF-MAX-REC-LENGTH    TO BXRF-REC-LENGTH
  2771
  2772* EXEC CICS READ
  2773*         SET     (ADDRESS OF BANK-CROSS-REFERENCE)
  2774*         DATASET ('ERBXRF')
  2775*         LENGTH  (BXRF-REC-LENGTH)
  2776*         RIDFLD  (WS-CONTROL-PRIMARY)
  2777*         UPDATE
  2778*    END-EXEC
  2779     MOVE 'ERBXRF' TO DFHEIV1
  2780*    MOVE '&"SL       EU         (   #00002444' TO DFHEIV0
  2781     MOVE X'2622534C2020202020202045' TO DFHEIV0(1:12)
  2782     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2783     MOVE X'2020233030303032343434' TO DFHEIV0(25:11)
  2784     CALL 'kxdfhei1' USING DFHEIV0,
  2785           DFHEIV1,
  2786           DFHEIV20,
  2787           BXRF-REC-LENGTH,
  2788           WS-CONTROL-PRIMARY,
  2789           DFHEIV99,
  2790           DFHEIV99,
  2791           DFHEIV99
  2792     SET ADDRESS OF BANK-CROSS-REFERENCE TO
  2793         DFHEIV20
  2794     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2795     MOVE BK-BANK-POINTER-CNT    TO BK-BANK-POINTER-CNT
  2796     .
  2797 7200-EXIT.
  2798     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6523T.cbl
  2799     .
  2800 7200-BXRF-NOT-FOUND.
  2801     MOVE ER-0142                TO EMI-ERROR
  2802     MOVE -1                     TO CARRIERL
  2803     MOVE AL-UABON               TO CARRIERA
  2804     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  2805     IF EIBTRNID  = EL652-TRANS-ID
  2806        GO TO 8100-SEND-INITIAL-MAP
  2807     ELSE
  2808        GO TO 8200-SEND-DATAONLY
  2809     END-IF
  2810     .
  2811 7300-EDIT-DATA.
  2812     SET NO-LINE-CHANGES         TO TRUE
  2813     PERFORM VARYING NDX FROM +1 BY +1 UNTIL
  2814        (NDX > +13)
  2815        IF BL-ACCOUNTL (NDX) > +0
  2816           SET LINE-CHANGES      TO TRUE
  2817           MOVE BL-ACCOUNT (NDX) TO BK-AM-ACCOUNT (PI-NDX)
  2818        END-IF
  2819        IF BL-STATEL (NDX) > +0
  2820           SET LINE-CHANGES      TO TRUE
  2821           MOVE BL-STATE (NDX)   TO BK-AM-STATE (PI-NDX)
  2822        END-IF
  2823        IF BL-EFFECTL (NDX) > +0
  2824           SET LINE-CHANGES      TO TRUE
  2825           MOVE BL-EFFECT (NDX)  TO WS-DEEDIT-FIELD
  2826           PERFORM 8600-DEEDIT   THRU 8600-EXIT
  2827           MOVE WS-DEEDIT-FIELD-DATE-OUT
  2828                                 TO  DC-GREG-DATE-1-MDY
  2829           MOVE '4'              TO  DC-OPTION-CODE
  2830           PERFORM 9700-DATE-CONVERSION
  2831           IF DATE-CONVERSION-ERROR
  2832              MOVE ER-0348              TO EMI-ERROR
  2833              MOVE -1                   TO BL-EFFECTL (NDX)
  2834              MOVE AL-UABON             TO BL-EFFECTA (NDX)
  2835              PERFORM 9900-ERROR-FORMAT THRU  9900-EXIT
  2836           ELSE
  2837              MOVE DC-GREG-DATE-1-EDIT  TO BL-EFFECT (NDX)
  2838              MOVE AL-UANON             TO BL-EFFECTA (NDX)
  2839              MOVE DC-BIN-DATE-1        TO BK-AM-EFF-DT (PI-NDX)
  2840           END-IF
  2841        END-IF
  2842        IF BL-EXPIREL (NDX) > +0
  2843           SET LINE-CHANGES      TO TRUE
  2844           MOVE BL-EXPIRE (NDX)  TO WS-DEEDIT-FIELD
  2845           PERFORM 8600-DEEDIT   THRU 8600-EXIT
  2846           IF WS-DEEDIT-FIELD-DATE-OUT = 999999
  2847              MOVE HIGH-VALUES   TO BK-AM-EXP-DT (PI-NDX)
  2848              MOVE '99/99/99'    TO BL-EXPIRE (NDX)
  2849              MOVE AL-UANON      TO BL-EXPIREA (NDX)
  2850           ELSE
  2851              MOVE WS-DEEDIT-FIELD-DATE-OUT
  2852                                 TO DC-GREG-DATE-1-MDY
  2853              MOVE '4'           TO DC-OPTION-CODE
  2854              PERFORM 9700-DATE-CONVERSION
  2855              IF DATE-CONVERSION-ERROR
  2856                 MOVE ER-0454    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6523T.cbl
  2857                 MOVE -1         TO BL-EXPIREL (NDX)
  2858                 MOVE AL-UABON   TO BL-EXPIREA (NDX)
  2859                 PERFORM 9900-ERROR-FORMAT
  2860                                 THRU 9900-EXIT
  2861              ELSE
  2862                 MOVE DC-GREG-DATE-1-EDIT
  2863                                 TO BL-EXPIRE (NDX)
  2864                 MOVE AL-UANON   TO BL-EXPIREA (NDX)
  2865                 MOVE DC-BIN-DATE-1
  2866                                 TO BK-AM-EXP-DT (PI-NDX)
  2867              END-IF
  2868           END-IF
  2869        END-IF
  2870        IF LINE-CHANGES
  2871           SET CHANGES-MADE      TO TRUE
  2872           IF BK-AM-EXP-DT (PI-NDX) NOT > BK-AM-EFF-DT (PI-NDX)
  2873              MOVE ER-2339       TO EMI-ERROR
  2874              MOVE -1            TO BL-EXPIREL (NDX)
  2875              MOVE AL-UABON      TO BL-EXPIREA (NDX)
  2876              PERFORM 9900-ERROR-FORMAT
  2877                                 THRU 9900-EXIT
  2878           END-IF
  2879           PERFORM 7350-VERIFY-ACCOUNT
  2880                                 THRU 7350-EXIT
  2881        END-IF
  2882        ADD +1                   TO PI-NDX
  2883        SET NO-LINE-CHANGES      TO TRUE
  2884     END-PERFORM
  2885     .
  2886 7300-EXIT.
  2887     EXIT.
  2888 7325-COMPRESS.
  2889     PERFORM VARYING WSUB1 FROM +1 BY +1 UNTIL
  2890        (WSUB1 > PI-NDX)
  2891        IF BK-AM-ACCOUNT (WSUB1) = SPACES OR LOW-VALUES OR ZEROS
  2892           PERFORM VARYING WSUB2 FROM WSUB1 BY +1 UNTIL
  2893              (BK-AM-ACCOUNT (WSUB2) NOT = SPACES AND LOW-VALUES
  2894                                       AND ZEROS)
  2895              OR (WSUB2 > PI-NDX)
  2896           END-PERFORM
  2897           IF WSUB2 NOT > PI-NDX
  2898              MOVE BK-AM-ACCOUNT (WSUB2)
  2899                                 TO BK-AM-ACCOUNT (WSUB1)
  2900              MOVE BK-AM-EFF-DT (WSUB2)
  2901                                 TO BK-AM-EFF-DT (WSUB1)
  2902              MOVE BK-AM-EXP-DT (WSUB2)
  2903                                 TO BK-AM-EXP-DT (WSUB1)
  2904              MOVE BK-AM-STATE (WSUB2)
  2905                                 TO BK-AM-STATE (WSUB1)
  2906              MOVE LOW-VALUES    TO BK-AM-ACCOUNT (WSUB2)
  2907                                    BK-AM-EFF-DT  (WSUB2)
  2908                                    BK-AM-EXP-DT  (WSUB2)
  2909                                    BK-AM-STATE   (WSUB2)
  2910           END-IF
  2911        END-IF
  2912     END-PERFORM
  2913     PERFORM VARYING WSUB1 FROM +1 BY +1 UNTIL
  2914        BK-AM-ACCOUNT (WSUB1) = SPACES OR LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6523T.cbl
  2915     END-PERFORM
  2916     COMPUTE PI-NDX = WSUB1 - +1
  2917     .
  2918 7325-EXIT.
  2919     EXIT.
  2920 7350-VERIFY-ACCOUNT.
  2921     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  2922     MOVE BK-COMPANY-CD          TO WS-ERACCT-COMP-CD
  2923     MOVE BK-CARRIER             TO WS-ERACCT-CARRIER
  2924     MOVE BK-GROUPING            TO WS-ERACCT-GROUPING
  2925     MOVE BK-AM-STATE (PI-NDX)   TO WS-ERACCT-STATE
  2926     MOVE BK-AM-ACCOUNT (PI-NDX) TO WS-ERACCT-ACCOUNT
  2927     MOVE BK-AM-EXP-DT (PI-NDX)  TO WS-ERACCT-EXP-DT
  2928     IF BK-AM-ACCOUNT (PI-NDX) NOT = SPACES AND ZEROS
  2929
  2930* EXEC CICS READ
  2931*          DATASET  ('ERACCT')
  2932*          SET      (ADDRESS OF ACCOUNT-MASTER)
  2933*          RIDFLD   (WS-ERACCT-KEY)
  2934*          RESP     (WS-RESPONSE)
  2935*       END-EXEC
  2936     MOVE 'ERACCT' TO DFHEIV1
  2937*    MOVE '&"S        E          (  N#00002585' TO DFHEIV0
  2938     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2939     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2940     MOVE X'204E233030303032353835' TO DFHEIV0(25:11)
  2941     CALL 'kxdfhei1' USING DFHEIV0,
  2942           DFHEIV1,
  2943           DFHEIV20,
  2944           DFHEIV99,
  2945           WS-ERACCT-KEY,
  2946           DFHEIV99,
  2947           DFHEIV99,
  2948           DFHEIV99
  2949     SET ADDRESS OF ACCOUNT-MASTER TO
*  12-S*********************************                               (   0)**
**    Operand ACCOUNT-MASTER is not declared
  2950         DFHEIV20
  2951     MOVE EIBRESP  TO WS-RESPONSE
  2952     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2953        IF (RESP-NORMAL)
  2954           AND (BK-AM-EFF-DT (PI-NDX) = AM-EFFECTIVE-DT)
*  12-S******************************************************          (  56)**
**    Operand AM-EFFECTIVE-DT is not declared
  2955           CONTINUE
  2956        ELSE
  2957           MOVE ER-0226          TO EMI-ERROR
  2958           MOVE -1               TO BL-ACCOUNTL (NDX)
  2959           MOVE AL-UABON         TO BL-ACCOUNTA (NDX)
  2960           PERFORM 9900-ERROR-FORMAT
  2961                                 THRU 9900-EXIT
  2962        END-IF
  2963     END-IF
* 564-S**********                                                      (  56)**
**    A scope-delimiter did not have a matching verb and was discarded.
  2964     .
  2965 7350-EXIT.
  2966     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6523T.cbl
  2967 7400-READ-CONTROL-FILE.
  2968     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  2969     MOVE WS-ACCESS              TO CNTL-ACCESS
  2970
  2971* EXEC CICS HANDLE CONDITION
  2972*        NOTFND  (7490-NOT-FOUND)
  2973*        ERROR   (9990-ABEND)
  2974*    END-EXEC
  2975*    MOVE '"$I.                  ! + #00002608' TO DFHEIV0
  2976     MOVE X'2224492E2020202020202020' TO DFHEIV0(1:12)
  2977     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2978     MOVE X'2B20233030303032363038' TO DFHEIV0(25:11)
  2979     CALL 'kxdfhei1' USING DFHEIV0
  2980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2981
  2982* EXEC CICS READ
  2983*        DATASET  (CNTL-FILE-ID)
  2984*        SET      (ADDRESS OF CONTROL-FILE)
  2985*        RIDFLD   (ELCNTL-KEY)
  2986*    END-EXEC
  2987*    MOVE '&"S        E          (   #00002612' TO DFHEIV0
  2988     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2989     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2990     MOVE X'2020233030303032363132' TO DFHEIV0(25:11)
  2991     CALL 'kxdfhei1' USING DFHEIV0,
  2992           CNTL-FILE-ID,
  2993           DFHEIV20,
  2994           DFHEIV99,
  2995           ELCNTL-KEY,
  2996           DFHEIV99,
  2997           DFHEIV99,
  2998           DFHEIV99
  2999     SET ADDRESS OF CONTROL-FILE TO
*  12-S*******************************                                 (  56)**
**    Operand CONTROL-FILE is not declared
  3000         DFHEIV20
  3001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3002     IF CNTL-REC-TYPE = '6'
  3003        MOVE AL-UANON           TO CARRIERA
  3004        MOVE CARRIERI           TO PI-ERC-CARRIER
  3005        GO TO 7499-EXIT
  3006     END-IF
  3007     .
  3008 7490-NOT-FOUND.
  3009     IF CNTL-REC-TYPE = '6'
  3010        MOVE -1                  TO CARRIERL
  3011        MOVE AL-UABON            TO CARRIERA
  3012        MOVE ER-0193             TO EMI-ERROR
  3013     END-IF
  3014     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  3015     .
  3016 7499-EXIT.
  3017     EXIT.
  3018 7500-COUNT-OPEN-RANGES.
  3019     MOVE +1                     TO NDX
  3020     MOVE +0                     TO WS-OPEN-COUNT.
  3021 7500-LOOP.
  3022     IF NDX GREATER THAN BK-BANK-POINTER-CNT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6523T.cbl
  3023          MOVE +1                TO NDX
  3024          GO TO 7500-EXIT.
  3025     IF BK-AM-EXP-DT (NDX) = HIGH-VALUES
  3026         ADD +1 TO WS-OPEN-COUNT.
  3027     ADD +1 TO NDX
  3028     GO TO 7500-LOOP.
  3029 7500-EXIT.
  3030     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6523T.cbl
  3032 7510-SORT-ACCOUNTS.
  3033     IF BK-BANK-POINTER-CNT NOT > +1
  3034        GO TO 7599-EXIT
  3035     END-IF
  3036     MOVE +1                     TO WSUB1
  3037                                    WSUB2
  3038     MOVE HIGH-VALUES            TO WS-WORK-ACCT-TABLE
  3039     .
  3040 7520-CONTINUE-SORT.
  3041     IF WSUB2 > BK-BANK-POINTER-CNT
  3042        GO TO 7540-RID-OF-HIGH-VALUES
  3043     END-IF
  3044     IF (BK-AM-ACCOUNT (WSUB1) < WS-AM-ACCOUNT (WSUB2))
  3045        AND (BK-AM-ACCOUNT (WSUB1) NOT = SPACES)
  3046        MOVE BK-BANK-POINTER (WSUB1)
  3047                                 TO WS-BANKS (WSUB2)
  3048        MOVE WSUB1               TO WSUB3
  3049     END-IF
  3050     ADD +1 TO WSUB1
  3051     IF WSUB1 NOT > BK-BANK-POINTER-CNT
  3052        GO TO 7520-CONTINUE-SORT
  3053     END-IF
  3054     MOVE HIGH-VALUES            TO BK-BANK-POINTER (WSUB3)
  3055     ADD +1                      TO WSUB2
  3056     MOVE +1                     TO WSUB1
  3057     GO TO 7520-CONTINUE-SORT
  3058     .
  3059 7540-RID-OF-HIGH-VALUES.
  3060     IF WS-BANKS (WSUB1) = HIGH-VALUES
  3061        MOVE SPACES              TO WS-BANKS (WSUB1)
  3062     END-IF
  3063     ADD +1 TO WSUB1
  3064     IF WSUB1 NOT > BK-BANK-POINTER-CNT
  3065        GO TO 7540-RID-OF-HIGH-VALUES
  3066     END-IF
  3067     MOVE +1                     TO WSUB1
  3068     MOVE +2                     TO WSUB2
  3069     .
  3070 7550-CHECK-DUPS.
  3071     IF (WS-AM-ACCOUNT (WSUB1) = WS-AM-ACCOUNT (WSUB2))
  3072        AND (WS-AM-STATE (WSUB1) = WS-AM-STATE (WSUB2))
  3073        AND (WS-AM-EXP-DT (WSUB1) NOT = SPACES)
  3074        MOVE ER-2947             TO  EMI-ERROR
  3075        PERFORM 9900-ERROR-FORMAT
  3076                                 THRU 9900-EXIT
  3077        MOVE -1                  TO  MAINTYPL
  3078        GO TO 8200-SEND-DATAONLY
  3079     END-IF
  3080     ADD +1 TO WSUB2
  3081     IF WSUB2 NOT > BK-BANK-POINTER-CNT
  3082        GO TO 7550-CHECK-DUPS
  3083     END-IF
  3084     ADD +1                      TO WSUB1
  3085     MOVE WSUB1                  TO WSUB2
  3086     ADD +1                      TO WSUB2
  3087     IF WSUB1 NOT > BK-BANK-POINTER-CNT
  3088        GO TO 7550-CHECK-DUPS
  3089     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6523T.cbl
  3090     PERFORM VARYING WSUB1 FROM +1 BY +1 UNTIL
  3091        (WSUB1 > BK-BANK-POINTER-CNT)
  3092        MOVE WS-BANKS (WSUB1)    TO BK-BANK-POINTER (WSUB1)
  3093     END-PERFORM
  3094     .
  3095 7599-EXIT.
  3096     EXIT.
  3097 8100-SEND-INITIAL-MAP.
  3098     MOVE SAVE-DATE              TO DATEO.
  3099     MOVE EIBTIME                TO TIME-IN.
  3100     MOVE TIME-OUT               TO TIMEO.
  3101     MOVE -1                     TO MAINTYPL
  3102     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  3103
  3104* EXEC CICS SEND
  3105*        MAP    (MAP-NAME)
  3106*        MAPSET (MAPSET-NAME)
  3107*        FROM   (EL652DO)
  3108*        ERASE
  3109*        CURSOR
  3110*        END-EXEC.
  3111     MOVE LENGTH OF
  3112      EL652DO
  3113       TO DFHEIV12
  3114     MOVE -1
  3115       TO DFHEIV11
  3116*    MOVE '8$     CT  E    H L F ,   #00002718' TO DFHEIV0
  3117     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3118     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3119     MOVE X'2020233030303032373138' TO DFHEIV0(25:11)
  3120     CALL 'kxdfhei1' USING DFHEIV0,
  3121           MAP-NAME,
  3122           EL652DO,
  3123           DFHEIV12,
  3124           MAPSET-NAME,
  3125           DFHEIV99,
  3126           DFHEIV99,
  3127           DFHEIV99,
  3128           DFHEIV11,
  3129           DFHEIV99,
  3130           DFHEIV99,
  3131           DFHEIV99
  3132     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3133
  3134     GO TO 9100-RETURN-TRAN.
  3135 8200-SEND-DATAONLY.
  3136     MOVE SAVE-DATE              TO DATEO.
  3137     MOVE EIBTIME                TO TIME-IN.
  3138     MOVE TIME-OUT               TO TIMEO.
  3139     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  3140
  3141* EXEC CICS SEND
  3142*        MAP    (MAP-NAME)
  3143*        MAPSET (MAPSET-NAME)
  3144*        FROM   (EL652DO)
  3145*        DATAONLY
  3146*        CURSOR
  3147*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6523T.cbl
  3148     MOVE LENGTH OF
  3149      EL652DO
  3150       TO DFHEIV12
  3151     MOVE -1
  3152       TO DFHEIV11
  3153*    MOVE '8$D    CT       H L F ,   #00002731' TO DFHEIV0
  3154     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3155     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3156     MOVE X'2020233030303032373331' TO DFHEIV0(25:11)
  3157     CALL 'kxdfhei1' USING DFHEIV0,
  3158           MAP-NAME,
  3159           EL652DO,
  3160           DFHEIV12,
  3161           MAPSET-NAME,
  3162           DFHEIV99,
  3163           DFHEIV99,
  3164           DFHEIV99,
  3165           DFHEIV11,
  3166           DFHEIV99,
  3167           DFHEIV99,
  3168           DFHEIV99
  3169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3170
  3171     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6523T.cbl
  3173 8500-DATE-CONVERT.
  3174     MOVE LINK-ELDATCV           TO PGM-NAME.
  3175
  3176* EXEC CICS LINK
  3177*        PROGRAM    (PGM-NAME)
  3178*        COMMAREA   (DATE-CONVERSION-DATA)
  3179*        LENGTH     (DC-COMM-LENGTH)
  3180*        END-EXEC.
  3181*    MOVE '."C                   ''   #00002742' TO DFHEIV0
  3182     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3183     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3184     MOVE X'2020233030303032373432' TO DFHEIV0(25:11)
  3185     CALL 'kxdfhei1' USING DFHEIV0,
  3186           PGM-NAME,
  3187           DATE-CONVERSION-DATA,
  3188           DC-COMM-LENGTH,
  3189           DFHEIV99,
  3190           DFHEIV99,
  3191           DFHEIV99
  3192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3193
  3194 8500-EXIT.
  3195     EXIT.
  3196 8600-DEEDIT.
  3197
  3198* EXEC CICS  BIF DEEDIT
  3199*        FIELD   (WS-DEEDIT-FIELD)
  3200*        LENGTH  (10)
  3201*    END-EXEC.
  3202     MOVE 10
  3203       TO DFHEIV11
  3204*    MOVE '@"L                   #   #00002750' TO DFHEIV0
  3205     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3206     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3207     MOVE X'2020233030303032373530' TO DFHEIV0(25:11)
  3208     CALL 'kxdfhei1' USING DFHEIV0,
  3209           WS-DEEDIT-FIELD,
  3210           DFHEIV11
  3211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3212
  3213 8600-EXIT.
  3214      EXIT.
  3215 8810-PF23.
  3216     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3217     MOVE XCTL-005               TO PGM-NAME.
  3218     GO TO 9300-XCTL.
  3219 9100-RETURN-TRAN.
  3220     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  3221     MOVE '652D'               TO PI-CURRENT-SCREEN-NO.
  3222
  3223* EXEC CICS RETURN
  3224*        TRANSID(TRANS-ID)
  3225*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  3226*        LENGTH(PI-COMM-LENGTH)
  3227*        END-EXEC.
  3228*    MOVE '.(CT                  &   #00002763' TO DFHEIV0
  3229     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3230     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6523T.cbl
  3231     MOVE X'2020233030303032373633' TO DFHEIV0(25:11)
  3232     CALL 'kxdfhei1' USING DFHEIV0,
  3233           TRANS-ID,
  3234           PROGRAM-INTERFACE-BLOCK,
  3235           PI-COMM-LENGTH,
  3236           DFHEIV99,
  3237           DFHEIV99
  3238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3239
  3240
  3241* GOBACK.
  3242     MOVE '9%                    "   ' TO DFHEIV0
  3243     MOVE 'EL6523' TO DFHEIV1
  3244     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3245     GOBACK.
  3246 9910-INITIALIZE-SECURITY.
  3247******************************************************************
  3248*                                                                *
  3249*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  3250*       USER SECURITY RECORD SET UP BY EL125.  THIS PROGRAM      *
  3251*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  3252*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  3253*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  3254*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  3255*                                                                *
  3256******************************************************************
  3257     IF PI-PROCESSOR-ID NOT = 'LGXX'
  3258
  3259* EXEC CICS    READQ TS
  3260*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  3261*            INTO    (SECURITY-CONTROL)
  3262*            LENGTH  (SC-COMM-LENGTH)
  3263*            ITEM    (SC-ITEM-CL-CR)
  3264*       END-EXEC
  3265*    MOVE '*$II   L              ''   #00002781' TO DFHEIV0
  3266     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3267     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3268     MOVE X'2020233030303032373831' TO DFHEIV0(25:11)
  3269     CALL 'kxdfhei1' USING DFHEIV0,
  3270           PI-SECURITY-TEMP-STORE-ID,
  3271           SECURITY-CONTROL,
  3272           SC-COMM-LENGTH,
  3273           SC-ITEM-CL-CR,
  3274           DFHEIV99,
  3275           DFHEIV99
  3276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3277        MOVE SC-CREDIT-DISPLAY (05)
  3278                                 TO PI-DISPLAY-CAP
  3279        MOVE SC-CREDIT-UPDATE  (05)
  3280                                 TO PI-MODIFY-CAP
  3281        IF  NOT DISPLAY-CAP
  3282            MOVE 'READ'          TO SM-READ
  3283            PERFORM 9995-SECURITY-VIOLATION
  3284                                 THRU 9995-EXIT
  3285            MOVE ER-0070         TO EMI-ERROR
  3286            PERFORM 9900-ERROR-FORMAT
  3287                                 THRU 9900-EXIT
  3288            GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6523T.cbl
  3289        END-IF
  3290     END-IF
  3291     .
  3292 9910-EXIT.
  3293     EXIT.
  3294 9200-RETURN-MAIN-MENU.
  3295     MOVE XCTL-626               TO PGM-NAME.
  3296     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6523T.cbl
  3298 9300-XCTL.
  3299
  3300* EXEC CICS XCTL
  3301*        PROGRAM    (PGM-NAME)
  3302*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3303*        LENGTH     (PI-COMM-LENGTH)
  3304*        END-EXEC.
  3305*    MOVE '.$C                   $   #00002809' TO DFHEIV0
  3306     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3307     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3308     MOVE X'2020233030303032383039' TO DFHEIV0(25:11)
  3309     CALL 'kxdfhei1' USING DFHEIV0,
  3310           PGM-NAME,
  3311           PROGRAM-INTERFACE-BLOCK,
  3312           PI-COMM-LENGTH
  3313     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3314
  3315 9400-CLEAR.
  3316     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  3317     GO TO 9300-XCTL.
  3318 9500-PF12.
  3319     MOVE XCTL-010               TO PGM-NAME.
  3320     GO TO 9300-XCTL.
  3321 9700-DATE-CONVERSION.
  3322
  3323* EXEC CICS LINK
  3324*        PROGRAM   ('ELDATCV')
  3325*        COMMAREA  (DATE-CONVERSION-DATA)
  3326*        LENGTH    (DC-COMM-LENGTH)
  3327*    END-EXEC.
  3328     MOVE 'ELDATCV' TO DFHEIV1
  3329*    MOVE '."C                   ''   #00002821' TO DFHEIV0
  3330     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3331     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3332     MOVE X'2020233030303032383231' TO DFHEIV0(25:11)
  3333     CALL 'kxdfhei1' USING DFHEIV0,
  3334           DFHEIV1,
  3335           DATE-CONVERSION-DATA,
  3336           DC-COMM-LENGTH,
  3337           DFHEIV99,
  3338           DFHEIV99,
  3339           DFHEIV99
  3340     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3341
  3342 9700-EXIT.
  3343     EXIT.
  3344 9900-ERROR-FORMAT.
  3345     IF NOT EMI-ERRORS-COMPLETE
  3346         MOVE LINK-001 TO PGM-NAME
  3347
  3348* EXEC CICS LINK
  3349*            PROGRAM(PGM-NAME)
  3350*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  3351*            LENGTH(EMI-COMM-LENGTH)
  3352*            END-EXEC.
  3353*    MOVE '."C                   ''   #00002831' TO DFHEIV0
  3354     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3355     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6523T.cbl
  3356     MOVE X'2020233030303032383331' TO DFHEIV0(25:11)
  3357     CALL 'kxdfhei1' USING DFHEIV0,
  3358           PGM-NAME,
  3359           ERROR-MESSAGE-INTERFACE-BLOCK,
  3360           EMI-COMM-LENGTH,
  3361           DFHEIV99,
  3362           DFHEIV99,
  3363           DFHEIV99
  3364     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3365
  3366 9900-EXIT.
  3367     EXIT.
  3368 9990-ABEND.
  3369     MOVE LINK-004 TO PGM-NAME.
  3370     MOVE DFHEIBLK TO EMI-LINE1.
  3371
  3372* EXEC CICS LINK
  3373*        PROGRAM   (PGM-NAME)
  3374*        COMMAREA  (EMI-LINE1)
  3375*        LENGTH    (72)
  3376*        END-EXEC.
  3377     MOVE 72
  3378       TO DFHEIV11
  3379*    MOVE '."C                   ''   #00002841' TO DFHEIV0
  3380     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3381     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3382     MOVE X'2020233030303032383431' TO DFHEIV0(25:11)
  3383     CALL 'kxdfhei1' USING DFHEIV0,
  3384           PGM-NAME,
  3385           EMI-LINE1,
  3386           DFHEIV11,
  3387           DFHEIV99,
  3388           DFHEIV99,
  3389           DFHEIV99
  3390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3391
  3392     GO TO 8200-SEND-DATAONLY.
  3393 9995-SECURITY-VIOLATION.
  3394*                                COPY ELCSCTP.
  3395******************************************************************
  3396*                                                                *
  3397*                            ELCSCTP                             *
  3398*                            VMOD=2.001                          *
  3399*                                                                *
  3400*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3401******************************************************************
  3402
  3403
  3404     MOVE EIBDATE          TO SM-JUL-DATE.
  3405     MOVE EIBTRMID         TO SM-TERMID.
  3406     MOVE THIS-PGM         TO SM-PGM.
  3407     MOVE EIBTIME          TO TIME-IN.
  3408     MOVE TIME-OUT         TO SM-TIME.
  3409     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3410
  3411
  3412* EXEC CICS LINK
  3413*         PROGRAM  ('EL003')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6523T.cbl
  3414*         COMMAREA (SECURITY-MESSAGE)
  3415*         LENGTH   (80)
  3416*    END-EXEC.
  3417     MOVE 'EL003' TO DFHEIV1
  3418     MOVE 80
  3419       TO DFHEIV11
  3420*    MOVE '."C                   ''   #00002865' TO DFHEIV0
  3421     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3422     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3423     MOVE X'2020233030303032383635' TO DFHEIV0(25:11)
  3424     CALL 'kxdfhei1' USING DFHEIV0,
  3425           DFHEIV1,
  3426           SECURITY-MESSAGE,
  3427           DFHEIV11,
  3428           DFHEIV99,
  3429           DFHEIV99,
  3430           DFHEIV99
  3431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3432
  3433
  3434******************************************************************
  3435
  3436 9995-EXIT.
  3437      EXIT.
  3438
  3439 9999-DFHBACK SECTION.
  3440     MOVE '9%                    "   ' TO DFHEIV0
  3441     MOVE 'EL6523' TO DFHEIV1
  3442     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3443     GOBACK.
  3444 9999-DFHEXIT.
  3445     IF DFHEIGDJ EQUAL 0001
  3446         NEXT SENTENCE
  3447     ELSE IF DFHEIGDJ EQUAL 2
  3448         GO TO 9990-ABEND,
  3449               8100-SEND-INITIAL-MAP
  3450         DEPENDING ON DFHEIGDI
  3451     ELSE IF DFHEIGDJ EQUAL 3
  3452         GO TO 1500-BXRF-NOT-FOUND,
  3453               0690-QIDERR
  3454         DEPENDING ON DFHEIGDI
  3455     ELSE IF DFHEIGDJ EQUAL 4
  3456         GO TO 1500-BXRF-NOT-FOUND
  3457         DEPENDING ON DFHEIGDI
  3458     ELSE IF DFHEIGDJ EQUAL 5
  3459         GO TO 4010-ERROR
  3460         DEPENDING ON DFHEIGDI
  3461     ELSE IF DFHEIGDJ EQUAL 6
  3462         GO TO 9990-ABEND,
  3463               4250-CONT
  3464         DEPENDING ON DFHEIGDI
  3465     ELSE IF DFHEIGDJ EQUAL 7
  3466         GO TO 5800-NO-RECORD,
  3467               5900-END-OF-FILE
  3468         DEPENDING ON DFHEIGDI
  3469     ELSE IF DFHEIGDJ EQUAL 8
  3470         GO TO 5900-END-OF-FILE
  3471         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6523T.cbl
  3472     ELSE IF DFHEIGDJ EQUAL 9
  3473         GO TO 1500-BXRF-NOT-FOUND
  3474         DEPENDING ON DFHEIGDI
  3475     ELSE IF DFHEIGDJ EQUAL 10
  3476         GO TO 7200-BXRF-NOT-FOUND
  3477         DEPENDING ON DFHEIGDI
  3478     ELSE IF DFHEIGDJ EQUAL 11
  3479         GO TO 7490-NOT-FOUND,
  3480               9990-ABEND
  3481         DEPENDING ON DFHEIGDI.
  3482     MOVE '9%                    "   ' TO DFHEIV0
  3483     MOVE 'EL6523' TO DFHEIV1
  3484     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3485     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Last message on page:   57
* Total Messages:     4
* Unrecoverable :     0                    Severe  :     4
* Errors        :     0                    Warnings:     0
* Informational :     0                    Flags   :     0
* Data:       30317     Code:           0
