* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL108.cbl
* Options: int("EL108.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL108.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL108.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL108.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL108 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:45:26.
     7*                            VMOD=2.011.
     8*
     9*
    10*AUTHOR.        LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL108.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        TRANSACTION EX13 - PROGRAM OPTION MAINTENANCE.
    27*
    28 ENVIRONMENT DIVISION.
    29 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL108.cbl
    31 WORKING-STORAGE SECTION.
    32 01  DFH-START PIC X(04).
    33 77  FILLER  PIC X(32)  VALUE '********************************'.
    34 77  FILLER  PIC X(32)  VALUE '*    EL108 WORKING STORAGE     *'.
    35 77  FILLER  PIC X(32)  VALUE '************VMOD=2.011 *********'.
    36
    37 01  FILE-PGMO-KEY.
    38     12  PROGRAM-NUMBER          PIC X(5).
    39     12  OPTION-TYPE             PIC X.
    40     12  OPTION-CODE             PIC X.
    41
    42 01  PROGRAM-OPT-HOLD.
    43     12  HOLD-PROGRAM-OPT OCCURS 4 TIMES.
    44         16  FREQ-CODE           PIC X(4).
    45         16  PRINT-OPT           PIC X.
    46         16  FORMAT-OPT          PIC X.
    47         16  PROCESS-OPT         PIC X.
    48         16  TOTAL-OPT           PIC X.
    49
    50*    COPY ELCSCTM.
    51******************************************************************
    52*                                                                *
    53*                                                                *
    54*                            ELCSCTM                             *
    55*                            VMOD=2.001                          *
    56*                                                                *
    57*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    58*                                                                *
    59******************************************************************
    60 01  SECURITY-MESSAGE.
    61     12  FILLER                          PIC X(30)
    62            VALUE '** LOGIC SECURITY VIOLATION -'.
    63     12  SM-READ                         PIC X(6).
    64     12  FILLER                          PIC X(5)
    65            VALUE ' PGM='.
    66     12  SM-PGM                          PIC X(6).
    67     12  FILLER                          PIC X(5)
    68            VALUE ' OPR='.
    69     12  SM-PROCESSOR-ID                 PIC X(4).
    70     12  FILLER                          PIC X(6)
    71            VALUE ' TERM='.
    72     12  SM-TERMID                       PIC X(4).
    73     12  FILLER                          PIC XX   VALUE SPACE.
    74     12  SM-JUL-DATE                     PIC 9(5).
    75     12  FILLER                          PIC X    VALUE SPACE.
    76     12  SM-TIME                         PIC 99.99.
    77
    78*    COPY ELCSCRTY.
    79******************************************************************
    80*                                                                *
    81*                                                                *
    82*                            ELCSCRTY                            *
    83*                            VMOD=2.001                          *
    84*                                                                *
    85*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    86*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    87*        SAVED IN PI-SECURITY-ADDRESS.                           *
    88*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL108.cbl
    89******************************************************************
    90 01  SECURITY-CONTROL.
    91     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    92     12  FILLER                       PIC XX    VALUE 'SC'.
    93     12  SC-CREDIT-CODES.
    94         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    95             20  SC-CREDIT-DISPLAY    PIC X.
    96             20  SC-CREDIT-UPDATE     PIC X.
    97     12  SC-CLAIMS-CODES.
    98         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    99             20  SC-CLAIMS-DISPLAY    PIC X.
   100             20  SC-CLAIMS-UPDATE     PIC X.
   101
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL108.cbl
   103
   104 01  WS-DATE-AREA.
   105     12  SAVE-DATE           PIC X(8)    VALUE SPACES.
   106     12  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
   107
   108 01  WS-AREA.
   109     12  TIME-IN                 PIC S9(7).
   110     12  FILLER REDEFINES TIME-IN.
   111        16  FILLER               PIC X.
   112        16  TIME-OUT             PIC 99V99.
   113        16  FILLER               PIC XX.
   114     12  SC-ITEM                 PIC S9(4) COMP VALUE +1.
   115     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   116     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   117     12  XCTL-EL126              PIC X(8)    VALUE 'EL126'.
   118     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   119     12  XCTL-EM626              PIC X(8)    VALUE 'EM626'.
   120     12  XCTL-GL800              PIC X(8)    VALUE 'GL800'.
   121     12  THIS-PGM                PIC X(8)    VALUE 'EL108'.
   122     12  LIT-EX13                PIC X(4)    VALUE 'EX13'.
   123     12  LIT-MAP                 PIC X(4)    VALUE '108A'.
   124     12  LIT-SPACE               PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL108.cbl
   126 01  EDIT-WORK-AREA.
   127     12  COUNT-1                 PIC 9.
   128     12  CALL-PGM                PIC X(8).
   129     12  TRANS-ID                PIC X(4).
   130     12  CHECK-PFKEYS            PIC 99.
   131     12  CHECK-MAINT             PIC X.
   132         88  SHOW-OPTION                     VALUE 'S'.
   133         88  CHANGE-OPTION                   VALUE 'C'.
   134         88  VALID-CODE                      VALUE 'C' 'S'.
   135     12  CHECK-FREQ              PIC X(4).
   136         88  OPTION-ALWAYS-SET               VALUE 'NONE'.
   137*        88  SET-ON-IF-EDIT                  VALUE 'ED=Y'.
   138*        88  SET-ON-IF-NOT-EDIT              VALUE 'ED=N'.
   139*        88  SET-ON-IF-UPDATE                VALUE 'UP=Y'.
   140*        88  SET-ON-IF-NOT-UPDATE            VALUE 'UP=N'.
   141         88  SET-ON-IF-YEAR-END              VALUE 'MO=Y'.
   142         88  SET-ON-IF-NOT-YEAR-END          VALUE 'MO/Y'.
   143         88  SET-ON-IF-MO-3-6-9-12           VALUE 'MO=Q'.
   144         88  SET-ON-IF-NOT-QTR-MO            VALUE 'MO/Q'.
   145         88  SET-ON-IF-JAN                   VALUE 'MO=1'.
   146         88  SET-ON-IF-FEB                   VALUE 'MO=2'.
   147         88  SET-ON-IF-MARCH                 VALUE 'MO=3'.
   148         88  SET-ON-IF-APRIL                 VALUE 'MO=4'.
   149         88  SET-ON-IF-MAY                   VALUE 'MO=5'.
   150         88  SET-ON-IF-JUNE                  VALUE 'MO=6'.
   151         88  SET-ON-IF-JULY                  VALUE 'MO=7'.
   152         88  SET-ON-IF-AUG                   VALUE 'MO=8'.
   153         88  SET-ON-IF-SEPT                  VALUE 'MO=9'.
   154         88  SET-ON-IF-OCT                   VALUE 'MO=A'.
   155         88  SET-ON-IF-NOV                   VALUE 'MO=B'.
   156         88  SET-ON-IF-DEC                   VALUE 'MO=C'.
   157     12  CHECK-PRINT             PIC X.
   158         88  PRINT-TO-HARDCOPY               VALUE 'P'.
   159         88  PRINT-TO-FICHE-TAPE             VALUE 'F'.
   160         88  PRINT-TO-BOTH-MEDIA             VALUE 'B'.
   161         88  SAVE-REPORT-ONLINE-NO-PRINT     VALUE 'S'.
   162         88  SAVE-REPORT-ONLINE-AND-PRINT    VALUE 'T'.
   163     12  HOLD-PROGRAM            PIC X(5).
   164     12  HOLD-TYPE               PIC X.
   165     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
   166         88  BROWSE-STARTED                  VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL108.cbl
   168 01  ERROR-NUMBERS.
   169     12  ER-0000                 PIC X(4)    VALUE '0000'.
   170     12  ER-0023                 PIC X(4)    VALUE '0023'.
   171     12  ER-0029                 PIC X(4)    VALUE '0029'.
   172     12  ER-0050                 PIC X(4)    VALUE '0050'.
   173     12  ER-0066                 PIC X(4)    VALUE '0066'.
   174     12  ER-0067                 PIC X(4)    VALUE '0067'.
   175     12  ER-0070                 PIC X(4)    VALUE '0070'.
   176     12  ER-0162                 PIC X(4)    VALUE '0162'.
   177     12  ER-0163                 PIC X(4)    VALUE '0163'.
   178     12  ER-0164                 PIC X(4)    VALUE '0164'.
   179     12  ER-0165                 PIC X(4)    VALUE '0165'.
   180     12  ER-0166                 PIC X(4)    VALUE '0166'.
   181     12  ER-0167                 PIC X(4)    VALUE '0167'.
   182     12  ER-0267                 PIC X(4)    VALUE '0267'.
   183     12  ER-0269                 PIC X(4)    VALUE '0269'.
   184     12  ER-0486                 PIC X(4)    VALUE '0486'.
   185     12  ER-0599                 PIC X(4)    VALUE '0599'.
   186     12  ER-7008                 PIC X(4)    VALUE '7008'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL108.cbl
   188 01  ERROR-SWITCHES.
   189     12  ERROR-SWITCH            PIC X.
   190         88  SCREEN-ERROR                    VALUE 'X'.
   191     12  TYPE-SWITCH             PIC X.
   192         88  END-OF-TYPE                     VALUE 'X'.
   193
   194 01  FILE-PGMS-KEY.
   195     12  COMPANY-CD              PIC X.
   196     12  PROGRAM-NO.
   197         16  PROGRAM-LIT         PIC XX.
   198         16  PROGRAM-SEQ         PIC XXX.
   199
   200 01  COMP-LENGTHS.
   201     12  PGMS-LENGTH             PIC S9(4)   COMP VALUE +250.
   202     12  GENERIC-LENGTH          PIC S9(4)   COMP VALUE +5.
   203
   204 01  PROGRAM-OPT-DESC.
   205     12  DESC-PROGRAM-OPT OCCURS 9 TIMES.
   206         16  FILLER              PIC XXX.
   207         16  OPT-NO              PIC X.
   208         16  FILLER              PIC X.
   209         16  CONST-FILL          PIC X.
   210         16  FILLER              PIC X.
   211         16  PGMO-DESC           PIC X(40).
   212         16  FILLER              PIC X(32).
   213
   214 01  FREQUENCY-OPTIONS.
   215     12  FILLER                  PIC X(76)
   216         VALUE 'NONE - OPTION ALWAYS SET'.
   217*    12  FILLER                  PIC X(76)
   218*        VALUE 'ED=Y RUN WHEN EDIT = YES'.
   219*    12  FILLER                  PIC X(76)
   220*        VALUE 'ED=N RUN WHEN EDIT = NO'.
   221*    12  FILLER                  PIC X(76)
   222*        VALUE 'UP=Y RUN WHEN UPDATE = YES'.
   223*    12  FILLER                  PIC X(76)
   224*        VALUE 'UP=N RUN WHEN UPDATE = NO'.
   225     12  FILLER                  PIC X(76)
   226         VALUE 'MO=Y RUN WHEN YEARLY'.
   227     12  FILLER                  PIC X(35)
   228         VALUE 'MO=X RUN WHEN MONTH = X. '.
   229     12  FILLER                  PIC X(41)
   230         VALUE 'X MAY BE 1 THRU C WHERE 1=JAN,A=OCT,C=DEC'.
   231     12  FILLER                  PIC X(76)
   232         VALUE 'MO=Q RUN AT QUARTER END (MAR,JUNE,SEPT,DEC)'.
   233
   234 01  OPTIONS-FOR-FEQUENCY REDEFINES FREQUENCY-OPTIONS.
   235     12  OPTIONS-FREQ OCCURS 4 TIMES.
   236         16  FILLER              PIC X(76).
   237
   238 01  PRINT-OPTIONS.
   239     12  FILLER                  PIC X(36)
   240         VALUE '   P = PRINT TO HARD COPY'.
   241     12  FILLER                  PIC X(36)
   242         VALUE '   F = PRINT TO FICHE TAPE'.
   243     12  FILLER                  PIC X(36)
   244         VALUE '   B = PRINT TO BOTH MEDIA'.
   245     12  FILLER                  PIC X(36)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL108.cbl
   246         VALUE '   S = SAVE REPORT ONLINE - NO PRINT'.
   247     12  FILLER                  PIC X(36)
   248         VALUE '   T = SAVE REPORT ONLINE AND PRINT'.
   249
   250 01  OPTIONS-TO-PRINT REDEFINES PRINT-OPTIONS.
   251     12  OPTIONS-PRINT OCCURS 5 TIMES.
   252         16  FILLER              PIC X(36).
   253
   254 01  DO-NOT-RUN                  PIC X(36)
   255         VALUE '   X = DO NOT RUN'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL108.cbl
   257*    COPY ELCLOGOF.
   258******************************************************************
   259*                                                                *
   260*                                                                *
   261*                            ELCLOGOF.                           *
   262*                            VMOD=2.001                          *
   263*                                                                *
   264*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   265*                                                                *
   266******************************************************************
   267 01  CLASIC-LOGOFF.
   268     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   269     12  LOGOFF-TEXT.
   270         16  FILLER          PIC X(5)    VALUE SPACES.
   271         16  LOGOFF-MSG.
   272             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   273             20  FILLER      PIC X       VALUE SPACES.
   274             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   275         16  FILLER          PIC X(80)
   276           VALUE '* YOU ARE NOW LOGGED OFF'.
   277         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   278         16  FILLER          PIC X       VALUE QUOTE.
   279         16  LOGOFF-SYS-MSG  PIC X(17)
   280           VALUE 'S CLAS-IC SYSTEM '.
   281     12  TEXT-MESSAGES.
   282         16  UNACCESS-MSG    PIC X(29)
   283             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   284         16  PGMIDERR-MSG    PIC X(17)
   285             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL108.cbl
   287*    COPY ELCDATE.
   288******************************************************************
   289*                                                                *
   290*                                                                *
   291*                            ELCDATE.                            *
   292*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   293*                            VMOD=2.003
   294*                                                                *
   295*                                                                *
   296*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   297*                 LENGTH = 200                                   *
   298******************************************************************
   299
   300 01  DATE-CONVERSION-DATA.
   301     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   302     12  DC-OPTION-CODE                PIC X.
   303         88  BIN-TO-GREG                VALUE ' '.
   304         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   305         88  EDIT-GREG-TO-BIN           VALUE '2'.
   306         88  YMD-GREG-TO-BIN            VALUE '3'.
   307         88  MDY-GREG-TO-BIN            VALUE '4'.
   308         88  JULIAN-TO-BIN              VALUE '5'.
   309         88  BIN-PLUS-ELAPSED           VALUE '6'.
   310         88  FIND-CENTURY               VALUE '7'.
   311         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   312         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   313         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   314         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   315         88  JULIAN-TO-BIN-3            VALUE 'C'.
   316         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   317         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   318         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   319         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   320         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   321         88  CHECK-LEAP-YEAR            VALUE 'H'.
   322         88  BIN-3-TO-GREG              VALUE 'I'.
   323         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   324         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   325         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   326         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   327         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   328         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   329         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   330         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   331         88  THREE-CHARACTER-BIN
   332                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   333         88  GREGORIAN-TO-BIN
   334                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   335         88  BIN-TO-GREGORIAN
   336                  VALUES ' ' '1' 'I' '8' 'G'.
   337         88  JULIAN-TO-BINARY
   338                  VALUES '5' 'C' 'E' 'F'.
   339     12  DC-ERROR-CODE                 PIC X.
   340         88  NO-CONVERSION-ERROR        VALUE ' '.
   341         88  DATE-CONVERSION-ERROR
   342                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   343         88  DATE-IS-ZERO               VALUE '1'.
   344         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL108.cbl
   345         88  DATE-IS-INVALID            VALUE '3'.
   346         88  DATE1-GREATER-DATE2        VALUE '4'.
   347         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   348         88  DATE-INVALID-OPTION        VALUE '9'.
   349         88  INVALID-CENTURY            VALUE 'A'.
   350         88  ONLY-CENTURY               VALUE 'B'.
   351         88  ONLY-LEAP-YEAR             VALUE 'C'.
   352         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   353     12  DC-END-OF-MONTH               PIC X.
   354         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   355     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   356         88  USE-NORMAL-PROCESS         VALUE ' '.
   357         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   358         88  ADJUST-UP-100-YRS          VALUE '2'.
   359     12  FILLER                        PIC X.
   360     12  DC-CONVERSION-DATES.
   361         16  DC-BIN-DATE-1             PIC XX.
   362         16  DC-BIN-DATE-2             PIC XX.
   363         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   364         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   365                       DC-GREG-DATE-1-EDIT.
   366             20  DC-EDIT1-MONTH        PIC 99.
   367             20  SLASH1-1              PIC X.
   368             20  DC-EDIT1-DAY          PIC 99.
   369             20  SLASH1-2              PIC X.
   370             20  DC-EDIT1-YEAR         PIC 99.
   371         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   372         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   373                     DC-GREG-DATE-2-EDIT.
   374             20  DC-EDIT2-MONTH        PIC 99.
   375             20  SLASH2-1              PIC X.
   376             20  DC-EDIT2-DAY          PIC 99.
   377             20  SLASH2-2              PIC X.
   378             20  DC-EDIT2-YEAR         PIC 99.
   379         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   380         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   381                     DC-GREG-DATE-1-YMD.
   382             20  DC-YMD-YEAR           PIC 99.
   383             20  DC-YMD-MONTH          PIC 99.
   384             20  DC-YMD-DAY            PIC 99.
   385         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   386         16  DC-GREG-DATE-1-MDY-R REDEFINES
   387                      DC-GREG-DATE-1-MDY.
   388             20  DC-MDY-MONTH          PIC 99.
   389             20  DC-MDY-DAY            PIC 99.
   390             20  DC-MDY-YEAR           PIC 99.
   391         16  DC-GREG-DATE-1-ALPHA.
   392             20  DC-ALPHA-MONTH        PIC X(10).
   393             20  DC-ALPHA-DAY          PIC 99.
   394             20  FILLER                PIC XX.
   395             20  DC-ALPHA-CENTURY.
   396                 24 DC-ALPHA-CEN-N     PIC 99.
   397             20  DC-ALPHA-YEAR         PIC 99.
   398         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   399         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   400         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   401         16  DC-JULIAN-DATE            PIC 9(05).
   402         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL108.cbl
   403                                       PIC 9(05).
   404         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   405             20  DC-JULIAN-YEAR        PIC 99.
   406             20  DC-JULIAN-DAYS        PIC 999.
   407         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   408         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   409         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   410     12  DATE-CONVERSION-VARIBLES.
   411         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   412         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   413             20  FILLER                PIC 9(3).
   414             20  HOLD-CEN-1-CCYY.
   415                 24  HOLD-CEN-1-CC     PIC 99.
   416                 24  HOLD-CEN-1-YY     PIC 99.
   417             20  HOLD-CEN-1-MO         PIC 99.
   418             20  HOLD-CEN-1-DA         PIC 99.
   419         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   420             20  HOLD-CEN-1-R-MO       PIC 99.
   421             20  HOLD-CEN-1-R-DA       PIC 99.
   422             20  HOLD-CEN-1-R-CCYY.
   423                 24  HOLD-CEN-1-R-CC   PIC 99.
   424                 24  HOLD-CEN-1-R-YY   PIC 99.
   425             20  FILLER                PIC 9(3).
   426         16  HOLD-CENTURY-1-X.
   427             20  FILLER                PIC X(3)  VALUE SPACES.
   428             20  HOLD-CEN-1-X-CCYY.
   429                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   430                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   431             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   432             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   433         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   434             20  HOLD-CEN-1-R-X-MO     PIC XX.
   435             20  HOLD-CEN-1-R-X-DA     PIC XX.
   436             20  HOLD-CEN-1-R-X-CCYY.
   437                 24  HOLD-CEN-1-R-X-CC PIC XX.
   438                 24  HOLD-CEN-1-R-X-YY PIC XX.
   439             20  FILLER                PIC XXX.
   440         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   441         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   442         16  DC-JULIAN-DATE-1          PIC 9(07).
   443         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   444             20  DC-JULIAN-1-CCYY.
   445                 24  DC-JULIAN-1-CC    PIC 99.
   446                 24  DC-JULIAN-1-YR    PIC 99.
   447             20  DC-JULIAN-DA-1        PIC 999.
   448         16  DC-JULIAN-DATE-2          PIC 9(07).
   449         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   450             20  DC-JULIAN-2-CCYY.
   451                 24  DC-JULIAN-2-CC    PIC 99.
   452                 24  DC-JULIAN-2-YR    PIC 99.
   453             20  DC-JULIAN-DA-2        PIC 999.
   454         16  DC-GREG-DATE-A-EDIT.
   455             20  DC-EDITA-MONTH        PIC 99.
   456             20  SLASHA-1              PIC X VALUE '/'.
   457             20  DC-EDITA-DAY          PIC 99.
   458             20  SLASHA-2              PIC X VALUE '/'.
   459             20  DC-EDITA-CCYY.
   460                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL108.cbl
   461                 24  DC-EDITA-YEAR     PIC 99.
   462         16  DC-GREG-DATE-B-EDIT.
   463             20  DC-EDITB-MONTH        PIC 99.
   464             20  SLASHB-1              PIC X VALUE '/'.
   465             20  DC-EDITB-DAY          PIC 99.
   466             20  SLASHB-2              PIC X VALUE '/'.
   467             20  DC-EDITB-CCYY.
   468                 24  DC-EDITB-CENT     PIC 99.
   469                 24  DC-EDITB-YEAR     PIC 99.
   470         16  DC-GREG-DATE-CYMD         PIC 9(08).
   471         16  DC-GREG-DATE-CYMD-R REDEFINES
   472                              DC-GREG-DATE-CYMD.
   473             20  DC-CYMD-CEN           PIC 99.
   474             20  DC-CYMD-YEAR          PIC 99.
   475             20  DC-CYMD-MONTH         PIC 99.
   476             20  DC-CYMD-DAY           PIC 99.
   477         16  DC-GREG-DATE-MDCY         PIC 9(08).
   478         16  DC-GREG-DATE-MDCY-R REDEFINES
   479                              DC-GREG-DATE-MDCY.
   480             20  DC-MDCY-MONTH         PIC 99.
   481             20  DC-MDCY-DAY           PIC 99.
   482             20  DC-MDCY-CEN           PIC 99.
   483             20  DC-MDCY-YEAR          PIC 99.
   484    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   485        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   486    12  DC-EL310-DATE                  PIC X(21).
   487    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL108.cbl
   489*    COPY ELCATTR.
   490******************************************************************
   491*                                                                *
   492*                            ELCATTR.                            *
   493*                            VMOD=2.001                          *
   494*                                                                *
   495*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   496*                                                                *
   497*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   498*                                                                *
   499*                   POS 1   P=PROTECTED                          *
   500*                           U=UNPROTECTED                        *
   501*                           S=ASKIP                              *
   502*                   POS 2   A=ALPHA/NUMERIC                      *
   503*                           N=NUMERIC                            *
   504*                   POS 3   N=NORMAL                             *
   505*                           B=BRIGHT                             *
   506*                           D=DARK                               *
   507*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   508*                           OF=MODIFIED DATA TAG OFF             *
   509*                                                                *
   510*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   511******************************************************************
   512 01  ATTRIBUTE-LIST.
   513     12  AL-PABOF            PIC X       VALUE 'Y'.
   514     12  AL-PABON            PIC X       VALUE 'Z'.
   515     12  AL-PADOF            PIC X       VALUE '%'.
   516     12  AL-PADON            PIC X       VALUE '_'.
   517     12  AL-PANOF            PIC X       VALUE '-'.
   518     12  AL-PANON            PIC X       VALUE '/'.
   519     12  AL-SABOF            PIC X       VALUE '8'.
   520     12  AL-SABON            PIC X       VALUE '9'.
   521     12  AL-SADOF            PIC X       VALUE '@'.
   522     12  AL-SADON            PIC X       VALUE QUOTE.
   523     12  AL-SANOF            PIC X       VALUE '0'.
   524     12  AL-SANON            PIC X       VALUE '1'.
   525     12  AL-UABOF            PIC X       VALUE 'H'.
   526     12  AL-UABON            PIC X       VALUE 'I'.
   527     12  AL-UADOF            PIC X       VALUE '<'.
   528     12  AL-UADON            PIC X       VALUE '('.
   529     12  AL-UANOF            PIC X       VALUE ' '.
   530     12  AL-UANON            PIC X       VALUE 'A'.
   531     12  AL-UNBOF            PIC X       VALUE 'Q'.
   532     12  AL-UNBON            PIC X       VALUE 'R'.
   533     12  AL-UNDOF            PIC X       VALUE '*'.
   534     12  AL-UNDON            PIC X       VALUE ')'.
   535     12  AL-UNNOF            PIC X       VALUE '&'.
   536     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL108.cbl
   538*    COPY ELCAID.
   539******************************************************************
   540*                                                                *
   541*                            ELCAID.                             *
   542*                            VMOD=2.001                          *
   543*                                                                *
   544*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   545*                                                                *
   546*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   547*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   548******************************************************************
   549
   550 01  DFHAID.
   551   02  DFHNULL   PIC  X  VALUE  ' '.
   552   02  DFHENTER  PIC  X  VALUE  QUOTE.
   553   02  DFHCLEAR  PIC  X  VALUE  '_'.
   554   02  DFHPEN    PIC  X  VALUE  '='.
   555   02  DFHOPID   PIC  X  VALUE  'W'.
   556   02  DFHPA1    PIC  X  VALUE  '%'.
   557   02  DFHPA2    PIC  X  VALUE  '>'.
   558   02  DFHPA3    PIC  X  VALUE  ','.
   559   02  DFHPF1    PIC  X  VALUE  '1'.
   560   02  DFHPF2    PIC  X  VALUE  '2'.
   561   02  DFHPF3    PIC  X  VALUE  '3'.
   562   02  DFHPF4    PIC  X  VALUE  '4'.
   563   02  DFHPF5    PIC  X  VALUE  '5'.
   564   02  DFHPF6    PIC  X  VALUE  '6'.
   565   02  DFHPF7    PIC  X  VALUE  '7'.
   566   02  DFHPF8    PIC  X  VALUE  '8'.
   567   02  DFHPF9    PIC  X  VALUE  '9'.
   568   02  DFHPF10   PIC  X  VALUE  ':'.
   569   02  DFHPF11   PIC  X  VALUE  '#'.
   570   02  DFHPF12   PIC  X  VALUE  '@'.
   571   02  DFHPF13   PIC  X  VALUE  'A'.
   572   02  DFHPF14   PIC  X  VALUE  'B'.
   573   02  DFHPF15   PIC  X  VALUE  'C'.
   574   02  DFHPF16   PIC  X  VALUE  'D'.
   575   02  DFHPF17   PIC  X  VALUE  'E'.
   576   02  DFHPF18   PIC  X  VALUE  'F'.
   577   02  DFHPF19   PIC  X  VALUE  'G'.
   578   02  DFHPF20   PIC  X  VALUE  'H'.
   579   02  DFHPF21   PIC  X  VALUE  'I'.
   580*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   581   02  DFHPF22   PIC  X  VALUE  '['.
   582   02  DFHPF23   PIC  X  VALUE  '.'.
   583   02  DFHPF24   PIC  X  VALUE  '<'.
   584   02  DFHMSRE   PIC  X  VALUE  'X'.
   585   02  DFHSTRF   PIC  X  VALUE  'h'.
   586   02  DFHTRIG   PIC  X  VALUE  '"'.
   587
   588 01  FILLER REDEFINES DFHAID.
   589     12  FILLER                  PIC X(8).
   590     12  AID-KEYS OCCURS 24 TIMES.
   591         16  FILLER              PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL108.cbl
   593*    COPY ELCINTF.
   594******************************************************************
   595*                                                                *
   596*                                                                *
   597*                            ELCINTF.                            *
   598*                            VMOD=2.017                          *
   599*                                                                *
   600*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   601*                                                                *
   602*       LENGTH = 1024                                            *
   603*                                                                *
   604******************************************************************
   605 01  PROGRAM-INTERFACE-BLOCK.
   606     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   607     12  PI-CALLING-PROGRAM              PIC X(8).
   608     12  PI-SAVED-PROGRAM-1              PIC X(8).
   609     12  PI-SAVED-PROGRAM-2              PIC X(8).
   610     12  PI-SAVED-PROGRAM-3              PIC X(8).
   611     12  PI-SAVED-PROGRAM-4              PIC X(8).
   612     12  PI-SAVED-PROGRAM-5              PIC X(8).
   613     12  PI-SAVED-PROGRAM-6              PIC X(8).
   614     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   615     12  PI-COMPANY-ID                   PIC XXX.
   616     12  PI-COMPANY-CD                   PIC X.
   617
   618     12  PI-COMPANY-PASSWORD             PIC X(8).
   619
   620     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   621
   622     12  PI-CONTROL-IN-PROGRESS.
   623         16  PI-CARRIER                  PIC X.
   624         16  PI-GROUPING                 PIC X(6).
   625         16  PI-STATE                    PIC XX.
   626         16  PI-ACCOUNT                  PIC X(10).
   627         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   628                                         PIC X(10).
   629         16  PI-CLAIM-CERT-GRP.
   630             20  PI-CLAIM-NO             PIC X(7).
   631             20  PI-CERT-NO.
   632                 25  PI-CERT-PRIME       PIC X(10).
   633                 25  PI-CERT-SFX         PIC X.
   634             20  PI-CERT-EFF-DT          PIC XX.
   635         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   636             20  PI-PLAN-CODE            PIC X(2).
   637             20  PI-REVISION-NUMBER      PIC X(3).
   638             20  PI-PLAN-EFF-DT          PIC X(2).
   639             20  PI-PLAN-EXP-DT          PIC X(2).
   640             20  FILLER                  PIC X(11).
   641         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   642             20  PI-OE-REFERENCE-1.
   643                 25  PI-OE-REF-1-PRIME   PIC X(18).
   644                 25  PI-OE-REF-1-SUFF    PIC XX.
   645
   646     12  PI-SESSION-IN-PROGRESS          PIC X.
   647         88  CLAIM-SESSION                   VALUE '1'.
   648         88  CREDIT-SESSION                  VALUE '2'.
   649         88  WARRANTY-SESSION                VALUE '3'.
   650         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL108.cbl
   651         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   652
   653
   654*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   655
   656     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   657     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   658
   659     12  PI-CREDIT-USER                  PIC X.
   660         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   661         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   662
   663     12  PI-CLAIM-USER                   PIC X.
   664         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   665         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   666
   667     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   668         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   669         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   670         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   671         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   672         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   673
   674     12  PI-PROCESSOR-ID                 PIC X(4).
   675
   676     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   677
   678     12  PI-MEMBER-CAPTION               PIC X(10).
   679
   680     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   681         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   682
   683     12  PI-LIFE-OVERRIDE-L1             PIC X.
   684     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   685     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   686     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   687
   688     12  PI-AH-OVERRIDE-L1               PIC X.
   689     12  PI-AH-OVERRIDE-L2               PIC XX.
   690     12  PI-AH-OVERRIDE-L6               PIC X(6).
   691     12  PI-AH-OVERRIDE-L12              PIC X(12).
   692
   693     12  PI-NEW-SYSTEM                   PIC X(2).
   694
   695     12  PI-PRIMARY-CERT-NO              PIC X(11).
   696     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   697         88  PI-USES-PAID-TO                 VALUE '1'.
   698     12  PI-CRDTCRD-SYSTEM.
   699         16  PI-CRDTCRD-USER             PIC X.
   700             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   701             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   702         16  PI-CC-MONTH-END-DT          PIC XX.
   703     12  PI-PROCESSOR-PRINTER            PIC X(4).
   704
   705     12  PI-OE-REFERENCE-2.
   706         16  PI-OE-REF-2-PRIME           PIC X(10).
   707         16  PI-OE-REF-2-SUFF            PIC X.
   708
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL108.cbl
   709     12  PI-REM-TRM-CALC-OPTION          PIC X.
   710
   711     12  PI-LANGUAGE-TYPE                PIC X.
   712             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   713             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   714             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   715
   716     12  PI-POLICY-LINKAGE-IND           PIC X.
   717         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   718         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   719                                                   LOW-VALUES.
   720
   721     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   722     12  PI-CLAIM-PW-SESSION             PIC X(1).
   723         88  PI-CLAIM-CREDIT                 VALUE '1'.
   724         88  PI-CLAIM-CONVEN                 VALUE '2'.
   725     12  FILLER                          PIC X(4).
   726
   727     12  PI-SYSTEM-LEVEL                 PIC X(145).
   728
   729     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   730         PI-SYSTEM-LEVEL.
   731
   732         16  PI-ENTRY-CODES.
   733             20  PI-ENTRY-CD-1           PIC X.
   734             20  PI-ENTRY-CD-2           PIC X.
   735
   736         16  PI-RETURN-CODES.
   737             20  PI-RETURN-CD-1          PIC X.
   738             20  PI-RETURN-CD-2          PIC X.
   739
   740         16  PI-UPDATE-STATUS-SAVE.
   741             20  PI-UPDATE-BY            PIC X(4).
   742             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   743
   744         16  PI-LOWER-CASE-LETTERS       PIC X.
   745             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   746
   747*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   748*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   749*            88  CARRIER-CLM-CNTL            VALUE '2'.
   750
   751         16  PI-CERT-ACCESS-CONTROL      PIC X.
   752             88  ST-ACCNT-CNTL               VALUE ' '.
   753             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   754             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   755             88  ACCNT-CNTL                  VALUE '3'.
   756             88  CARR-ACCNT-CNTL             VALUE '4'.
   757
   758         16  PI-PROCESSOR-CAP-LIST.
   759             20  PI-SYSTEM-CONTROLS.
   760                24 PI-SYSTEM-DISPLAY     PIC X.
   761                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   762                24 PI-SYSTEM-MODIFY      PIC X.
   763                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   764             20  FILLER                  PIC XX.
   765             20  PI-DISPLAY-CAP          PIC X.
   766                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL108.cbl
   767             20  PI-MODIFY-CAP           PIC X.
   768                 88  MODIFY-CAP              VALUE 'Y'.
   769             20  PI-MSG-AT-LOGON-CAP     PIC X.
   770                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   771             20  PI-FORCE-CAP            PIC X.
   772                 88  FORCE-CAP               VALUE 'Y'.
   773
   774         16  PI-PROGRAM-CONTROLS.
   775             20  PI-PGM-PRINT-OPT        PIC X.
   776             20  PI-PGM-FORMAT-OPT       PIC X.
   777             20  PI-PGM-PROCESS-OPT      PIC X.
   778             20  PI-PGM-TOTALS-OPT       PIC X.
   779
   780         16  PI-HELP-INTERFACE.
   781             20  PI-LAST-ERROR-NO        PIC X(4).
   782             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   783
   784         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   785             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   786
   787         16  PI-CR-CONTROL-IN-PROGRESS.
   788             20  PI-CR-CARRIER           PIC X.
   789             20  PI-CR-GROUPING          PIC X(6).
   790             20  PI-CR-STATE             PIC XX.
   791             20  PI-CR-ACCOUNT           PIC X(10).
   792             20  PI-CR-FIN-RESP          PIC X(10).
   793             20  PI-CR-TYPE              PIC X.
   794
   795         16  PI-CR-BATCH-NUMBER          PIC X(6).
   796
   797         16  PI-CR-MONTH-END-DT          PIC XX.
   798
   799         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   800             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   801             88  PI-ZERO-CARRIER             VALUE '1'.
   802             88  PI-ZERO-GROUPING            VALUE '2'.
   803             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   804
   805         16  PI-CARRIER-SECURITY         PIC X.
   806             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   807
   808         16  PI-ACCOUNT-SECURITY         PIC X(10).
   809             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   810             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   811
   812         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   813             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   814                                         INDEXED BY PI-ACCESS-NDX
   815                                         PIC X.
   816
   817         16  PI-GA-BILLING-CONTROL       PIC X.
   818             88  PI-GA-BILLING               VALUE '1'.
   819
   820         16  PI-MAIL-PROCESSING          PIC X.
   821             88  PI-MAIL-YES                 VALUE 'Y'.
   822
   823         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   824
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL108.cbl
   825         16  PI-AR-SYSTEM.
   826             20  PI-AR-PROCESSING-CNTL   PIC X.
   827                 88  PI-AR-PROCESSING        VALUE 'Y'.
   828             20  PI-AR-SUMMARY-CODE      PIC X(6).
   829             20  PI-AR-MONTH-END-DT      PIC XX.
   830
   831         16  PI-MP-SYSTEM.
   832             20  PI-MORTGAGE-USER            PIC X.
   833                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   834                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   835             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   836                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   837                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   838                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   839                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   840                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   841             20  PI-MP-MONTH-END-DT          PIC XX.
   842             20  PI-MP-REFERENCE-NO.
   843                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   844                 24  PI-MP-REFERENCE-SFX     PIC XX.
   845
   846         16  PI-LABEL-CONTROL            PIC X(01).
   847             88  PI-CREATE-LABELS                    VALUE 'Y'.
   848             88  PI-BYPASS-LABELS                    VALUE 'N'.
   849
   850         16  PI-BILL-GROUPING-CODE       PIC X(01).
   851             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   852
   853         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   854             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   855             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   856
   857         16  FILLER                      PIC X(14).
   858
   859     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   860******************************************************************
   861
   862     12  PI-PRG-WRK-AREA REDEFINES PI-PROGRAM-WORK-AREA.
   863         16  PI-PROGRAM-NO   PIC X(5).
   864         16  FILLER          PIC X(635).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL108.cbl
   866*    COPY ELCEMIB.
   867******************************************************************
   868*                                                                *
   869*                                                                *
   870*                            ELCEMIB.                            *
   871*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   872*                            VMOD=2.005                          *
   873*                                                                *
   874*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   875*                                                                *
   876******************************************************************
   877 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   878     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   879     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   880     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   881     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   882     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   883     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   884     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   885     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   886     12  EMI-SWITCH1             PIC X        VALUE '1'.
   887         88  EMI-NO-ERRORS                    VALUE '1'.
   888         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   889         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   890     12  EMI-SWITCH2             PIC X        VALUE '1'.
   891         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   892     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   893         88  EMI-AREA1-EMPTY                  VALUE '1'.
   894         88  EMI-AREA1-FULL                   VALUE '2'.
   895     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   896         88  EMI-AREA2-EMPTY                  VALUE '1'.
   897         88  EMI-AREA2-FULL                   VALUE '2'.
   898     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   899         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   900         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   901         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   902         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   903         88  EMI-BYPASS-FATALS                VALUE 'X'.
   904     12  EMI-ERROR-LINES.
   905         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   906         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   907         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   908         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   909             20  EMI-ERR-CODES OCCURS 10 TIMES.
   910                 24  EMI-ERR-NUM         PIC X(4).
   911                 24  EMI-FILLER          PIC X.
   912                 24  EMI-SEV             PIC X.
   913                 24  FILLER              PIC X.
   914             20  FILLER                  PIC X(02).
   915     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   916         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   917             20  EMI-ERROR-NUMBER    PIC X(4).
   918             20  EMI-FILL            PIC X.
   919             20  EMI-SEVERITY        PIC X.
   920             20  FILLER              PIC X.
   921             20  EMI-ERROR-TEXT.
   922                 24  EMI-TEXT-VARIABLE   PIC X(10).
   923                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL108.cbl
   924     12  EMI-SEVERITY-SAVE           PIC X.
   925         88  EMI-NOTE                    VALUE 'N'.
   926         88  EMI-WARNING                 VALUE 'W'.
   927         88  EMI-FORCABLE                VALUE 'F'.
   928         88  EMI-FATAL                   VALUE 'X'.
   929     12  EMI-MESSAGE-FLAG            PIC X.
   930         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   931         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   932     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   933     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   934         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   935         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   936         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   937     12  FILLER                      PIC X(137)  VALUE SPACES.
   938     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   939     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   940     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   941     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL108.cbl
   943*    COPY ELCJPFX.
   944******************************************************************
   945*                                                                *
   946*                                                                *
   947*                            ELCJPFX.                            *
   948*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   949*                            VMOD=2.002                          *
   950*                                                                *
   951*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   952*                                                                *
   953*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   954*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   955*        ELCNTL - CONTROL FILE                                   *
   956*        ELMSTR - CLAIM MASTERS                                  *
   957*        ELTRLR - ACTIVITY TRAILERS                              *
   958*        ELCHKQ - CHECK QUE                                      *
   959******************************************************************
   960 01  JOURNAL-RECORD.
   961     12  JP-USER-ID                  PIC X(4).
   962     12  JP-FILE-ID                  PIC X(8).
   963     12  JP-PROGRAM-ID               PIC X(8).
   964     12  JP-RECORD-TYPE              PIC X.
   965         88 JP-ADD              VALUE 'A'.
   966         88 JP-BEFORE-CHANGE    VALUE 'B'.
   967         88 JP-AFTER-CHANGE     VALUE 'C'.
   968         88 JP-DELETE           VALUE 'D'.
   969         88 JP-GENERIC-DELETE   VALUE 'G'.
   970         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   971         88 JP-KEY-CHG-ADD      VALUE 'N'.
   972     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   973     12  JP-RECORD-AREA
   974
   975
   976                                 PIC X(259).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL108.cbl
   978*    COPY EL108S.
   979 01  EL108AI.
   980     05  FILLER            PIC  X(0012).
   981*    -------------------------------
   982     05  DATEL PIC S9(0004) COMP.
   983     05  DATEF PIC  X(0001).
   984     05  FILLER REDEFINES DATEF.
   985         10  DATEA PIC  X(0001).
   986     05  DATEI PIC  X(0008).
   987*    -------------------------------
   988     05  TIMEL PIC S9(0004) COMP.
   989     05  TIMEF PIC  X(0001).
   990     05  FILLER REDEFINES TIMEF.
   991         10  TIMEA PIC  X(0001).
   992     05  TIMEI PIC  X(0005).
   993*    -------------------------------
   994     05  MAINTL PIC S9(0004) COMP.
   995     05  MAINTF PIC  X(0001).
   996     05  FILLER REDEFINES MAINTF.
   997         10  MAINTA PIC  X(0001).
   998     05  MAINTI PIC  X(0001).
   999*    -------------------------------
  1000     05  PGRML PIC S9(0004) COMP.
  1001     05  PGRMF PIC  X(0001).
  1002     05  FILLER REDEFINES PGRMF.
  1003         10  PGRMA PIC  X(0001).
  1004     05  PGRMI PIC  X(0005).
  1005*    -------------------------------
  1006     05  LSTUSRL PIC S9(0004) COMP.
  1007     05  LSTUSRF PIC  X(0001).
  1008     05  FILLER REDEFINES LSTUSRF.
  1009         10  LSTUSRA PIC  X(0001).
  1010     05  LSTUSRI PIC  X(0004).
  1011*    -------------------------------
  1012     05  LSTDTEL PIC S9(0004) COMP.
  1013     05  LSTDTEF PIC  X(0001).
  1014     05  FILLER REDEFINES LSTDTEF.
  1015         10  LSTDTEA PIC  X(0001).
  1016     05  LSTDTEI PIC  X(0008).
  1017*    -------------------------------
  1018     05  LSTTIMEL PIC S9(0004) COMP.
  1019     05  LSTTIMEF PIC  X(0001).
  1020     05  FILLER REDEFINES LSTTIMEF.
  1021         10  LSTTIMEA PIC  X(0001).
  1022     05  LSTTIMEI PIC  X(0005).
  1023*    -------------------------------
  1024     05  FREQ1L PIC S9(0004) COMP.
  1025     05  FREQ1F PIC  X(0001).
  1026     05  FILLER REDEFINES FREQ1F.
  1027         10  FREQ1A PIC  X(0001).
  1028     05  FREQ1I PIC  X(0004).
  1029*    -------------------------------
  1030     05  PRT1L PIC S9(0004) COMP.
  1031     05  PRT1F PIC  X(0001).
  1032     05  FILLER REDEFINES PRT1F.
  1033         10  PRT1A PIC  X(0001).
  1034     05  PRT1I PIC  X(0001).
  1035*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL108.cbl
  1036     05  FMT1L PIC S9(0004) COMP.
  1037     05  FMT1F PIC  X(0001).
  1038     05  FILLER REDEFINES FMT1F.
  1039         10  FMT1A PIC  X(0001).
  1040     05  FMT1I PIC  X(0001).
  1041*    -------------------------------
  1042     05  PROC1L PIC S9(0004) COMP.
  1043     05  PROC1F PIC  X(0001).
  1044     05  FILLER REDEFINES PROC1F.
  1045         10  PROC1A PIC  X(0001).
  1046     05  PROC1I PIC  X(0001).
  1047*    -------------------------------
  1048     05  TOT1L PIC S9(0004) COMP.
  1049     05  TOT1F PIC  X(0001).
  1050     05  FILLER REDEFINES TOT1F.
  1051         10  TOT1A PIC  X(0001).
  1052     05  TOT1I PIC  X(0001).
  1053*    -------------------------------
  1054     05  FREQ2L PIC S9(0004) COMP.
  1055     05  FREQ2F PIC  X(0001).
  1056     05  FILLER REDEFINES FREQ2F.
  1057         10  FREQ2A PIC  X(0001).
  1058     05  FREQ2I PIC  X(0004).
  1059*    -------------------------------
  1060     05  PRT2L PIC S9(0004) COMP.
  1061     05  PRT2F PIC  X(0001).
  1062     05  FILLER REDEFINES PRT2F.
  1063         10  PRT2A PIC  X(0001).
  1064     05  PRT2I PIC  X(0001).
  1065*    -------------------------------
  1066     05  FMT2L PIC S9(0004) COMP.
  1067     05  FMT2F PIC  X(0001).
  1068     05  FILLER REDEFINES FMT2F.
  1069         10  FMT2A PIC  X(0001).
  1070     05  FMT2I PIC  X(0001).
  1071*    -------------------------------
  1072     05  PROC2L PIC S9(0004) COMP.
  1073     05  PROC2F PIC  X(0001).
  1074     05  FILLER REDEFINES PROC2F.
  1075         10  PROC2A PIC  X(0001).
  1076     05  PROC2I PIC  X(0001).
  1077*    -------------------------------
  1078     05  TOT2L PIC S9(0004) COMP.
  1079     05  TOT2F PIC  X(0001).
  1080     05  FILLER REDEFINES TOT2F.
  1081         10  TOT2A PIC  X(0001).
  1082     05  TOT2I PIC  X(0001).
  1083*    -------------------------------
  1084     05  FREQ3L PIC S9(0004) COMP.
  1085     05  FREQ3F PIC  X(0001).
  1086     05  FILLER REDEFINES FREQ3F.
  1087         10  FREQ3A PIC  X(0001).
  1088     05  FREQ3I PIC  X(0004).
  1089*    -------------------------------
  1090     05  PRT3L PIC S9(0004) COMP.
  1091     05  PRT3F PIC  X(0001).
  1092     05  FILLER REDEFINES PRT3F.
  1093         10  PRT3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL108.cbl
  1094     05  PRT3I PIC  X(0001).
  1095*    -------------------------------
  1096     05  FMT3L PIC S9(0004) COMP.
  1097     05  FMT3F PIC  X(0001).
  1098     05  FILLER REDEFINES FMT3F.
  1099         10  FMT3A PIC  X(0001).
  1100     05  FMT3I PIC  X(0001).
  1101*    -------------------------------
  1102     05  PROC3L PIC S9(0004) COMP.
  1103     05  PROC3F PIC  X(0001).
  1104     05  FILLER REDEFINES PROC3F.
  1105         10  PROC3A PIC  X(0001).
  1106     05  PROC3I PIC  X(0001).
  1107*    -------------------------------
  1108     05  TOT3L PIC S9(0004) COMP.
  1109     05  TOT3F PIC  X(0001).
  1110     05  FILLER REDEFINES TOT3F.
  1111         10  TOT3A PIC  X(0001).
  1112     05  TOT3I PIC  X(0001).
  1113*    -------------------------------
  1114     05  FREQ4L PIC S9(0004) COMP.
  1115     05  FREQ4F PIC  X(0001).
  1116     05  FILLER REDEFINES FREQ4F.
  1117         10  FREQ4A PIC  X(0001).
  1118     05  FREQ4I PIC  X(0004).
  1119*    -------------------------------
  1120     05  PRT4L PIC S9(0004) COMP.
  1121     05  PRT4F PIC  X(0001).
  1122     05  FILLER REDEFINES PRT4F.
  1123         10  PRT4A PIC  X(0001).
  1124     05  PRT4I PIC  X(0001).
  1125*    -------------------------------
  1126     05  FMT4L PIC S9(0004) COMP.
  1127     05  FMT4F PIC  X(0001).
  1128     05  FILLER REDEFINES FMT4F.
  1129         10  FMT4A PIC  X(0001).
  1130     05  FMT4I PIC  X(0001).
  1131*    -------------------------------
  1132     05  PROC4L PIC S9(0004) COMP.
  1133     05  PROC4F PIC  X(0001).
  1134     05  FILLER REDEFINES PROC4F.
  1135         10  PROC4A PIC  X(0001).
  1136     05  PROC4I PIC  X(0001).
  1137*    -------------------------------
  1138     05  TOT4L PIC S9(0004) COMP.
  1139     05  TOT4F PIC  X(0001).
  1140     05  FILLER REDEFINES TOT4F.
  1141         10  TOT4A PIC  X(0001).
  1142     05  TOT4I PIC  X(0001).
  1143*    -------------------------------
  1144     05  VARDESCL PIC S9(0004) COMP.
  1145     05  VARDESCF PIC  X(0001).
  1146     05  FILLER REDEFINES VARDESCF.
  1147         10  VARDESCA PIC  X(0001).
  1148     05  VARDESCI PIC  X(0009).
  1149     05  OPTD OCCURS 9  TIMES.
  1150*    -------------------------------
  1151         10  OPTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL108.cbl
  1152         10  OPTF PIC  X(0001).
  1153         10  FILLER REDEFINES OPTF.
  1154             15  OPTA PIC  X(0001).
  1155         10  OPTI PIC  X(0079).
  1156*    -------------------------------
  1157     05  MSGL PIC S9(0004) COMP.
  1158     05  MSGF PIC  X(0001).
  1159     05  FILLER REDEFINES MSGF.
  1160         10  MSGA PIC  X(0001).
  1161     05  MSGI PIC  X(0075).
  1162*    -------------------------------
  1163     05  PFKEYL PIC S9(0004) COMP.
  1164     05  PFKEYF PIC  X(0001).
  1165     05  FILLER REDEFINES PFKEYF.
  1166         10  PFKEYA PIC  X(0001).
  1167     05  PFKEYI PIC  X(0002).
  1168 01  EL108AO REDEFINES EL108AI.
  1169     05  FILLER            PIC  X(0012).
  1170*    -------------------------------
  1171     05  FILLER            PIC  X(0003).
  1172     05  DATEO PIC  X(0008).
  1173*    -------------------------------
  1174     05  FILLER            PIC  X(0003).
  1175     05  TIMEO PIC  99.99.
  1176*    -------------------------------
  1177     05  FILLER            PIC  X(0003).
  1178     05  MAINTO PIC  X(0001).
  1179*    -------------------------------
  1180     05  FILLER            PIC  X(0003).
  1181     05  PGRMO PIC  X(0005).
  1182*    -------------------------------
  1183     05  FILLER            PIC  X(0003).
  1184     05  LSTUSRO PIC  X(0004).
  1185*    -------------------------------
  1186     05  FILLER            PIC  X(0003).
  1187     05  LSTDTEO PIC  X(0008).
  1188*    -------------------------------
  1189     05  FILLER            PIC  X(0003).
  1190     05  LSTTIMEO PIC  99.99.
  1191*    -------------------------------
  1192     05  FILLER            PIC  X(0003).
  1193     05  FREQ1O PIC  X(0004).
  1194*    -------------------------------
  1195     05  FILLER            PIC  X(0003).
  1196     05  PRT1O PIC  X(0001).
  1197*    -------------------------------
  1198     05  FILLER            PIC  X(0003).
  1199     05  FMT1O PIC  X(0001).
  1200*    -------------------------------
  1201     05  FILLER            PIC  X(0003).
  1202     05  PROC1O PIC  X(0001).
  1203*    -------------------------------
  1204     05  FILLER            PIC  X(0003).
  1205     05  TOT1O PIC  X(0001).
  1206*    -------------------------------
  1207     05  FILLER            PIC  X(0003).
  1208     05  FREQ2O PIC  X(0004).
  1209*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL108.cbl
  1210     05  FILLER            PIC  X(0003).
  1211     05  PRT2O PIC  X(0001).
  1212*    -------------------------------
  1213     05  FILLER            PIC  X(0003).
  1214     05  FMT2O PIC  X(0001).
  1215*    -------------------------------
  1216     05  FILLER            PIC  X(0003).
  1217     05  PROC2O PIC  X(0001).
  1218*    -------------------------------
  1219     05  FILLER            PIC  X(0003).
  1220     05  TOT2O PIC  X(0001).
  1221*    -------------------------------
  1222     05  FILLER            PIC  X(0003).
  1223     05  FREQ3O PIC  X(0004).
  1224*    -------------------------------
  1225     05  FILLER            PIC  X(0003).
  1226     05  PRT3O PIC  X(0001).
  1227*    -------------------------------
  1228     05  FILLER            PIC  X(0003).
  1229     05  FMT3O PIC  X(0001).
  1230*    -------------------------------
  1231     05  FILLER            PIC  X(0003).
  1232     05  PROC3O PIC  X(0001).
  1233*    -------------------------------
  1234     05  FILLER            PIC  X(0003).
  1235     05  TOT3O PIC  X(0001).
  1236*    -------------------------------
  1237     05  FILLER            PIC  X(0003).
  1238     05  FREQ4O PIC  X(0004).
  1239*    -------------------------------
  1240     05  FILLER            PIC  X(0003).
  1241     05  PRT4O PIC  X(0001).
  1242*    -------------------------------
  1243     05  FILLER            PIC  X(0003).
  1244     05  FMT4O PIC  X(0001).
  1245*    -------------------------------
  1246     05  FILLER            PIC  X(0003).
  1247     05  PROC4O PIC  X(0001).
  1248*    -------------------------------
  1249     05  FILLER            PIC  X(0003).
  1250     05  TOT4O PIC  X(0001).
  1251*    -------------------------------
  1252     05  FILLER            PIC  X(0003).
  1253     05  VARDESCO PIC  X(0009).
  1254*    -------------------------------
  1255     05  OPTD OCCURS 9  TIMES.
  1256         10  FILLER        PIC  X(0003).
  1257         10  OPTO PIC  X(0079).
  1258*    -------------------------------
  1259     05  FILLER            PIC  X(0003).
  1260     05  MSGO PIC  X(0075).
  1261*    -------------------------------
  1262     05  FILLER            PIC  X(0003).
  1263     05  PFKEYO PIC  X(0002).
  1264*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL108.cbl
  1266****************************************************************
  1267*
  1268* Copyright (c) 2007 by Clerity Solutions, Inc.
  1269* All rights reserved.
  1270*
  1271****************************************************************
  1272 01  DFHEIV.
  1273   02  DFHEIV0               PIC X(35).
  1274   02  DFHEIV1               PIC X(08).
  1275   02  DFHEIV2               PIC X(08).
  1276   02  DFHEIV3               PIC X(08).
  1277   02  DFHEIV4               PIC X(06).
  1278   02  DFHEIV5               PIC X(04).
  1279   02  DFHEIV6               PIC X(04).
  1280   02  DFHEIV7               PIC X(02).
  1281   02  DFHEIV8               PIC X(02).
  1282   02  DFHEIV9               PIC X(01).
  1283   02  DFHEIV10              PIC S9(7) COMP-3.
  1284   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1285   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1286   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1287   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1288   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1289   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1290   02  DFHEIV17              PIC X(04).
  1291   02  DFHEIV18              PIC X(04).
  1292   02  DFHEIV19              PIC X(04).
  1293   02  DFHEIV20              USAGE IS POINTER.
  1294   02  DFHEIV21              USAGE IS POINTER.
  1295   02  DFHEIV22              USAGE IS POINTER.
  1296   02  DFHEIV23              USAGE IS POINTER.
  1297   02  DFHEIV24              USAGE IS POINTER.
  1298   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1299   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1300   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1301   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1302   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1303   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1304   02  FILLER                PIC X(02).
  1305   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1306   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1307   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1308   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1309   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1310 LINKAGE  SECTION.
  1311*****************************************************************
  1312*                                                               *
  1313* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1314* All rights reserved.                                          *
  1315*                                                               *
  1316*****************************************************************
  1317 01  dfheiblk.
  1318     02  eibtime          pic s9(7) comp-3.
  1319     02  eibdate          pic s9(7) comp-3.
  1320     02  eibtrnid         pic x(4).
  1321     02  eibtaskn         pic s9(7) comp-3.
  1322     02  eibtrmid         pic x(4).
  1323     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL108.cbl
  1324     02  eibcposn         pic s9(4) comp.
  1325     02  eibcalen         pic s9(4) comp.
  1326     02  eibaid           pic x(1).
  1327     02  eibfiller1       pic x(1).
  1328     02  eibfn            pic x(2).
  1329     02  eibfiller2       pic x(2).
  1330     02  eibrcode         pic x(6).
  1331     02  eibfiller3       pic x(2).
  1332     02  eibds            pic x(8).
  1333     02  eibreqid         pic x(8).
  1334     02  eibrsrce         pic x(8).
  1335     02  eibsync          pic x(1).
  1336     02  eibfree          pic x(1).
  1337     02  eibrecv          pic x(1).
  1338     02  eibsend          pic x(1).
  1339     02  eibatt           pic x(1).
  1340     02  eibeoc           pic x(1).
  1341     02  eibfmh           pic x(1).
  1342     02  eibcompl         pic x(1).
  1343     02  eibsig           pic x(1).
  1344     02  eibconf          pic x(1).
  1345     02  eiberr           pic x(1).
  1346     02  eibrldbk         pic x(1).
  1347     02  eiberrcd         pic x(4).
  1348     02  eibsynrb         pic x(1).
  1349     02  eibnodat         pic x(1).
  1350     02  eibfiller5       pic x(2).
  1351     02  eibresp          pic 9(09) comp.
  1352     02  eibresp2         pic 9(09) comp.
  1353     02  dfheigdj         pic s9(4) comp.
  1354     02  dfheigdk         pic s9(4) comp.
  1355 01  DFHCOMMAREA                 PIC X(1024).
  1356
  1357*01 PARM-LIST .
  1358*    12  FILLER                  PIC S9(8)   COMP.
  1359*    12  PGMS-PNT                PIC S9(8)   COMP.
  1360*    12  PGMO-PNT                PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL108.cbl
  1362*    COPY ELCPGMS.
  1363******************************************************************
  1364*                                                                *
  1365*                                                                *
  1366*                            ELCPGMS.                            *
  1367*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1368*                            VMOD=2.003                          *
  1369*                                                                *
  1370*   FILE DESCRIPTION = PROGRAM OPTIONS SELECTED BY COMPANY       *
  1371*                                                                *
  1372*   FILE TYPE = VSAM,KSDS                                        *
  1373*   RECORD SIZE = 250   RECFORM = FIX                            *
  1374*                                                                *
  1375*   BASE CLUSTER NAME = ELPGMS                   RKP=2,LEN=6     *
  1376*       ALTERNATE PATH  = NOT USED                               *
  1377*                                                                *
  1378*   LOG = NO                                                     *
  1379*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1380******************************************************************
  1381 01  PROGRAM-OPTIONS-SELECTED.
  1382     12  PS-RECORD-ID                PIC XX.
  1383         88  VALID-PS-ID                VALUE 'PS'.
  1384
  1385     12  PS-CONTROL-PRIMARY.
  1386         16  PS-COMPANY-CD           PIC X.
  1387         16  PS-PROGRAM-NUMBER.
  1388             20  PS-SYSTEM-CODE      PIC XX.
  1389                 88 CLAS-IC-ONLINE      VALUE 'EL'.
  1390                 88 CLAS-IC-REPORT      VALUE 'EC'.
  1391                 88 CLAS-GL-BATCH       VALUE 'GL'.
  1392             20  PS-PROGRAM-SEQUENCE PIC 999.
  1393
  1394     12  PS-PROGRAM-OPTIONS    OCCURS 4 TIMES.
  1395         16  PS-FREQUENCY-CODE       PIC X(4).
  1396*            88  OPTION-ALWAYS-SET      VALUE 'NONE'.
  1397*            88  SET-ON-IF-EDIT         VALUE 'ED=Y'.
  1398*            88  SET-ON-IF-NOT-EDIT     VALUE 'ED=N'.
  1399*            88  SET-ON-IF-UPDATE       VALUE 'UP=Y'.
  1400*            88  SET-ON-IF-NOT-UPDATE   VALUE 'UP=N'.
  1401*            88  SET-ON-IF-YEAR-END     VALUE 'MO=Y'.
  1402*            88  SET-ON-IF-NOT-YEAR-END VALUE 'MO/Y'.
  1403*            88  SET-ON-IF-MO-3-6-9-12  VALUE 'MO=Q'.
  1404*            88  SET-ON-IF-NOT-QTR-MO   VALUE 'MO/Q'.
  1405*            88  SET-ON-IF-JAN          VALUE 'MO=1'.
  1406*            88  SET-ON-IF-FEB          VALUE 'MO=2'.
  1407*            88  SET-ON-IF-MARCH        VALUE 'MO=3'.
  1408*            88  SET-ON-IF-APRIL        VALUE 'MO=4'.
  1409*            88  SET-ON-IF-MAY          VALUE 'MO=5'.
  1410*            88  SET-ON-IF-JUNE         VALUE 'MO=6'.
  1411*            88  SET-ON-IF-JULY         VALUE 'MO=7'.
  1412*            88  SET-ON-IF-AUG          VALUE 'MO=8'.
  1413*            88  SET-ON-IF-SEPT         VALUE 'MO=9'.
  1414*            88  SET-ON-IF-OCT          VALUE 'MO=A'.
  1415*            88  SET-ON-IF-NOV          VALUE 'MO=B'.
  1416*            88  SET-ON-IF-DEC          VALUE 'MO=C'.
  1417         16  PS-PRINT-OPTION         PIC X.
  1418*            88  PRINT-TO-HARDCOPY      VALUE 'P'.
  1419*            88  PRINT-TO-FICHE-TAPE    VALUE 'F'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL108.cbl
  1420*            88  PRINT-TO-BOTH-MEDIA    VALUE 'B'.
  1421         16  PS-FORMAT-OPTION        PIC X.
  1422         16  PS-PROCESS-OPTION       PIC X.
  1423         16  PS-TOTAL-OPTION         PIC X.
  1424
  1425     12  PS-PARAMETER-INPUTS.
  1426         16  PS-INPUT-1              PIC X(80).
  1427         16  PS-INPUT-2              PIC X(80).
  1428
  1429     12  PS-MAINT-INFORMATION.
  1430         16  PS-LAST-MAINT-DT        PIC XX.
  1431         16  PS-LAST-MAINT-HHMMSS    PIC S9(7)    COMP-3.
  1432         16  PS-LAST-MAINT-USER      PIC X(4).
  1433         16  FILLER                  PIC XX.
  1434
  1435     12  FILLER                      PIC X(38).
  1436
  1437******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL108.cbl
  1439*    COPY ELCPGMO.
  1440******************************************************************
  1441*                                                                *
  1442*                                                                *
  1443*                            ELCPGMO.                            *
  1444*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1445*                            VMOD=2.002                          *
  1446*                                                                *
  1447*   FILE DESCRIPTION = AVAILABLE PROGRAM OPTIONS                 *
  1448*                                                                *
  1449*   FILE TYPE = VSAM,KSDS                                        *
  1450*   RECORD SIZE = 49    RECFORM = FIX                            *
  1451*                                                                *
  1452*   BASE CLUSTER NAME = ELPGMO                RKP=2,LEN=7        *
  1453*       ALTERNATE PATH  = NOT USED                               *
  1454*                                                                *
  1455*   LOG = NO                                                     *
  1456*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1457******************************************************************
  1458 01  PROGRAM-OPTIONS-AVAILABLE.
  1459     12  PO-RECORD-ID                PIC XX.
  1460         88  VALID-PO-ID                VALUE 'PO'.
  1461
  1462     12  PO-CONTROL-PRIMARY.
  1463         16  PO-PROGRAM-NUMBER.
  1464             20  PO-SYSTEM-CODE      PIC XX.
  1465                 88  CLAS-IC-ONLINE     VALUE 'EL'.
  1466                 88  CLAS-IC-REPORT     VALUE 'EC'.
  1467                 88  CLAS-GL-BATCH      VALUE 'GL'.
  1468             20  PO-PROGRAM-SEQUENCE PIC 999.
  1469         16  PO-OPTION-TYPE          PIC X.
  1470             88  PO-FORMAT-OPTION       VALUE 'F'.
  1471             88  PO-PROCESS-OPTION      VALUE 'P'.
  1472             88  PO-TOTAL-OPTION        VALUE 'T'.
  1473         16  PO-PGM-OPTION-CD        PIC X.
  1474
  1475     12  PO-OPTION-DESCRIPTION       PIC X(40).
  1476
  1477******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL108.cbl
  1479 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1480                          PROGRAM-OPTIONS-SELECTED
  1481                          PROGRAM-OPTIONS-AVAILABLE.
  1482 0000-DFHEXIT SECTION.
  1483     MOVE '9#                    $   ' TO DFHEIV0.
  1484     MOVE 'EL108' TO DFHEIV1.
  1485     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1486
  1487     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1488     MOVE '5'                   TO DC-OPTION-CODE.
  1489     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  1490     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1491     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1492
  1493     IF EIBCALEN = ZERO
  1494         GO TO 8800-UNAUTHORIZED-ACCESS.
  1495
  1496
  1497* EXEC CICS HANDLE CONDITION
  1498*        PGMIDERR (8820-XCTL-ERROR)
  1499*        ERROR    (9990-ABEND)
  1500*    END-EXEC.
  1501*    MOVE '"$L.                  ! " #00001492' TO DFHEIV0
  1502     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1503     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1504     MOVE X'2220233030303031343932' TO DFHEIV0(25:11)
  1505     CALL 'kxdfhei1' USING DFHEIV0
  1506     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1507
  1508
  1509     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  1510     MOVE SPACES      TO ERROR-SWITCHES MSGO.
  1511     MOVE LIT-EX13    TO TRANS-ID.
  1512
  1513     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1514         MOVE LOW-VALUES TO EL108AO
  1515         MOVE ER-7008    TO EMI-ERROR
  1516         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1517         MOVE -1         TO MAINTL
  1518         GO TO 8110-SEND-DATA.
  1519
  1520     IF THIS-PGM = PI-CALLING-PROGRAM
  1521         GO TO 0050-CHECK-CLEAR.
  1522
  1523     IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1524         MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1525         MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1526         MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1527         MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1528         MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1529         MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1530         MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1531         MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1532       ELSE
  1533         MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1534         MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1535         MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1536         MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL108.cbl
  1537         MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1538         MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1539         MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1540         MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  1541
  1542     MOVE LOW-VALUES           TO EL108AO.
  1543     MOVE ZEROS                TO COUNT-1.
  1544     PERFORM 5130-SPACE-SCREEN THRU 5140-EXIT 9 TIMES.
  1545     MOVE -1                   TO MAINTL.
  1546     GO TO 8100-SEND-INITIAL-MAP.
  1547
  1548 0050-CHECK-CLEAR.
  1549     IF EIBAID = DFHCLEAR
  1550         GO TO 8200-RETURN-PRIOR.
  1551
  1552     IF PI-PROCESSOR-ID = 'LGXX'
  1553         GO TO 0200-RECEIVE.
  1554
  1555
  1556* EXEC CICS READQ TS
  1557*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  1558*        INTO   (SECURITY-CONTROL)
  1559*        LENGTH (SC-COMM-LENGTH)
  1560*        ITEM   (SC-ITEM)
  1561*    END-EXEC.
  1562*    MOVE '*$II   L              ''   #00001543' TO DFHEIV0
  1563     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1564     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1565     MOVE X'2020233030303031353433' TO DFHEIV0(25:11)
  1566     CALL 'kxdfhei1' USING DFHEIV0,
  1567           PI-SECURITY-TEMP-STORE-ID,
  1568           SECURITY-CONTROL,
  1569           SC-COMM-LENGTH,
  1570           SC-ITEM,
  1571           DFHEIV99,
  1572           DFHEIV99
  1573     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1574
  1575
  1576     MOVE SC-CREDIT-DISPLAY (02)  TO PI-DISPLAY-CAP.
  1577     MOVE SC-CREDIT-UPDATE  (02)  TO PI-MODIFY-CAP.
  1578
  1579     IF NOT DISPLAY-CAP
  1580         MOVE 'READ'          TO SM-READ
  1581         PERFORM 9995-SECURITY-VIOLATION
  1582         MOVE ER-0070         TO  EMI-ERROR
  1583         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1584         GO TO 8100-SEND-INITIAL-MAP.
  1585
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL108.cbl
  1587 0200-RECEIVE.
  1588
  1589* EXEC CICS RECEIVE
  1590*        MAP    ('EL108A')
  1591*        MAPSET ('EL108S')
  1592*    END-EXEC.
  1593     MOVE 'EL108A' TO DFHEIV1
  1594     MOVE 'EL108S' TO DFHEIV2
  1595*    MOVE '8"T                   ''   #00001562' TO DFHEIV0
  1596     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  1597     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1598     MOVE X'2020233030303031353632' TO DFHEIV0(25:11)
  1599     CALL 'kxdfhei1' USING DFHEIV0,
  1600           DFHEIV1,
  1601           EL108AI,
  1602           DFHEIV99,
  1603           DFHEIV2,
  1604           DFHEIV99,
  1605           DFHEIV99
  1606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1607
  1608
  1609     IF PFKEYL GREATER THAN ZERO
  1610         PERFORM 0200-TRANS-PF THRU 0210-EXIT.
  1611
  1612     IF EIBAID = DFHPF1
  1613         PERFORM 0300-RESET-ATTRB THRU 0310-EXIT
  1614         GO TO 5000-SHOW-FREQ.
  1615
  1616     IF EIBAID = DFHPF2
  1617         PERFORM 0300-RESET-ATTRB THRU 0310-EXIT
  1618         GO TO 5100-SHOW-PRINT.
  1619
  1620     IF EIBAID = DFHPF3
  1621         PERFORM 0300-RESET-ATTRB THRU 0310-EXIT
  1622         GO TO 5400-SHOW-FORMAT.
  1623
  1624     IF EIBAID = DFHPF4
  1625         PERFORM 0300-RESET-ATTRB THRU 0310-EXIT
  1626         GO TO 5300-SHOW-PROCESS.
  1627
  1628     IF EIBAID = DFHPF5
  1629         PERFORM 0300-RESET-ATTRB THRU 0310-EXIT
  1630         GO TO 5200-SHOW-TOTAL.
  1631
  1632     MOVE SPACES                 TO  VARDESCO.
  1633     MOVE ZEROS                  TO  COUNT-1.
  1634
  1635     PERFORM 5130-SPACE-SCREEN  THRU  5140-EXIT  9  TIMES.
  1636
  1637     IF EIBAID = DFHPF6
  1638         PERFORM 0300-RESET-ATTRB THRU 0310-EXIT
  1639         GO TO 3100-SHOW-OPTIONS.
  1640
  1641     IF EIBAID = DFHPF7
  1642         PERFORM 0300-RESET-ATTRB THRU 0310-EXIT
  1643         GO TO 3100-SHOW-OPTIONS.
  1644
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL108.cbl
  1645     IF EIBAID = DFHPF12
  1646         GO TO 8300-GET-HELP.
  1647     IF EIBAID = DFHPF23
  1648         GO TO 8810-PF23-ENTERED.
  1649     IF EIBAID = DFHPF24
  1650         GO TO 8400-RETURN-MASTER.
  1651
  1652     IF EIBAID NOT = DFHENTER
  1653         MOVE ER-0029 TO EMI-ERROR
  1654         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1655         MOVE -1 TO MAINTL
  1656         GO TO 8110-SEND-DATA.
  1657
  1658     PERFORM 0300-RESET-ATTRB THRU 0310-EXIT.
  1659     PERFORM 1000-EDIT-SCREEN THRU 1010-EXIT.
  1660
  1661     IF SCREEN-ERROR
  1662         GO TO 8110-SEND-DATA.
  1663
  1664     MOVE SPACES TO PROGRAM-OPT-HOLD.
  1665
  1666     IF  CHANGE-OPTION
  1667         PERFORM 2000-CHANGE-OPTIONS THRU 2040-EXIT
  1668
  1669         IF  NOT EMI-NO-ERRORS
  1670             GO TO 8110-SEND-DATA
  1671
  1672         ELSE
  1673             PERFORM 4000-SHOW-OPTIONS THRU 4020-EXIT
  1674             MOVE ER-0000 TO EMI-ERROR
  1675             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1676
  1677     IF SHOW-OPTION
  1678         PERFORM 4000-SHOW-OPTIONS THRU 4020-EXIT.
  1679
  1680     MOVE -1    TO MAINTL.
  1681     MOVE SPACE TO MAINTO.
  1682     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL108.cbl
  1684
  1685 0200-TRANS-PF.
  1686     IF PFKEYI NOT NUMERIC
  1687         MOVE ER-7008         TO EMI-ERROR
  1688         GO TO 0205-ERROR.
  1689
  1690     MOVE PFKEYI TO CHECK-PFKEYS.
  1691
  1692     IF CHECK-PFKEYS LESS 1 OR GREATER 24
  1693         MOVE ER-7008         TO EMI-ERROR
  1694         GO TO 0205-ERROR.
  1695
  1696     MOVE AID-KEYS (CHECK-PFKEYS) TO EIBAID.
  1697
  1698     GO TO 0210-EXIT.
  1699
  1700 0205-ERROR.
  1701     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1702     MOVE -1                     TO MAINTL.
  1703     GO TO 8110-SEND-DATA.
  1704
  1705 0210-EXIT.
  1706     EXIT.
  1707
  1708 0300-RESET-ATTRB.
  1709     MOVE AL-UANON TO MAINTA
  1710                      PGRMA.
  1711 0310-EXIT.
  1712     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL108.cbl
  1714 1000-EDIT-SCREEN.
  1715     MOVE MAINTI TO CHECK-MAINT.
  1716     IF NOT VALID-CODE
  1717         MOVE AL-UABON TO MAINTA
  1718         MOVE -1       TO MAINTL
  1719         MOVE 'X'      TO ERROR-SWITCH
  1720         MOVE ER-0023  TO EMI-ERROR
  1721         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1722
  1723     IF PGRMI = ZEROS OR LOW-VALUES
  1724         MOVE -1       TO PGRML
  1725         MOVE AL-UABON TO PGRMA
  1726         MOVE 'X'      TO ERROR-SWITCH
  1727         MOVE ER-0162  TO EMI-ERROR
  1728         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1729         GO TO 1010-EXIT.
  1730
  1731     MOVE PGRMI TO PROGRAM-NO.
  1732
  1733     IF PROGRAM-LIT NOT = 'EL' AND 'EC' AND 'GL' AND 'EM'
  1734         MOVE -1       TO PGRML
  1735         MOVE AL-UABON TO PGRMA
  1736         MOVE 'X'      TO ERROR-SWITCH
  1737         MOVE ER-0162  TO EMI-ERROR
  1738         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1739         GO TO 1010-EXIT.
  1740
  1741     IF CHANGE-OPTION
  1742        IF NOT MODIFY-CAP
  1743            MOVE 'UPDATE'       TO SM-READ
  1744            PERFORM 9995-SECURITY-VIOLATION
  1745            MOVE 'X'        TO ERROR-SWITCH
  1746            MOVE AL-UABON   TO MAINTA
  1747            MOVE ER-0070    TO EMI-ERROR
  1748            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1749
  1750     MOVE PI-COMPANY-CD TO COMPANY-CD.
  1751     MOVE PGRMI         TO PROGRAM-NUMBER.
  1752
  1753 1010-EXIT.
  1754     EXIT.
  1755
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL108.cbl
  1757 2000-CHANGE-OPTIONS.
  1758     MOVE ZEROS TO COUNT-1.
  1759     PERFORM 2100-VERIFY-FREQ THRU 2110-EXIT.
  1760
  1761     MOVE ZEROS TO COUNT-1.
  1762     PERFORM 2200-VERIFY-PRINT THRU 2210-EXIT.
  1763
  1764     MOVE ZEROS TO COUNT-1.
  1765     PERFORM 2300-VERIFY-FORMAT THRU 2310-EXIT.
  1766
  1767     MOVE ZEROS TO COUNT-1.
  1768     PERFORM 2400-VERIFY-PROCESS THRU 2410-EXIT.
  1769
  1770     MOVE ZEROS TO COUNT-1.
  1771     PERFORM 2500-VERIFY-TOTAL THRU 2510-EXIT.
  1772
  1773     PERFORM 2600-CHECK-REQUIRE THRU 2650-EXIT.
  1774
  1775     IF NOT EMI-NO-ERRORS
  1776        GO TO 2040-EXIT.
  1777
  1778
  1779* EXEC CICS HANDLE CONDITION
  1780*        NOTFND (2010-PGMS-NOT-FOUND)
  1781*    END-EXEC.
  1782*    MOVE '"$I                   ! # #00001736' TO DFHEIV0
  1783     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  1784     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1785     MOVE X'2320233030303031373336' TO DFHEIV0(25:11)
  1786     CALL 'kxdfhei1' USING DFHEIV0
  1787     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1788
  1789
  1790
  1791* EXEC CICS READ
  1792*        SET     (ADDRESS OF PROGRAM-OPTIONS-SELECTED)
  1793*        DATASET ('ELPGMS')
  1794*        RIDFLD  (FILE-PGMS-KEY)
  1795*        UPDATE
  1796*    END-EXEC.
  1797     MOVE 'ELPGMS' TO DFHEIV1
  1798*    MOVE '&"S        EU         (   #00001740' TO DFHEIV0
  1799     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1800     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1801     MOVE X'2020233030303031373430' TO DFHEIV0(25:11)
  1802     CALL 'kxdfhei1' USING DFHEIV0,
  1803           DFHEIV1,
  1804           DFHEIV20,
  1805           DFHEIV99,
  1806           FILE-PGMS-KEY,
  1807           DFHEIV99,
  1808           DFHEIV99,
  1809           DFHEIV99
  1810     SET ADDRESS OF PROGRAM-OPTIONS-SELECTED TO
  1811         DFHEIV20
  1812     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1813
  1814
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL108.cbl
  1815     MOVE SAVE-BIN-DATE          TO  PS-LAST-MAINT-DT.
  1816     MOVE EIBTIME                TO  PS-LAST-MAINT-HHMMSS.
  1817     MOVE PI-PROCESSOR-ID        TO  PS-LAST-MAINT-USER.
  1818
  1819     MOVE ZEROS TO COUNT-1.
  1820     PERFORM 3000-FORMAT-RECORD THRU 3010-EXIT 4 TIMES.
  1821
  1822
  1823* EXEC CICS ASKTIME END-EXEC.
  1824*    MOVE '0"                    "   #00001754' TO DFHEIV0
  1825     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  1826     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  1827     MOVE X'2020233030303031373534' TO DFHEIV0(25:11)
  1828     CALL 'kxdfhei1' USING DFHEIV0,
  1829           DFHEIV99
  1830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1831
  1832
  1833
  1834* EXEC CICS REWRITE
  1835*        FROM (PROGRAM-OPTIONS-SELECTED)
  1836*        DATASET ('ELPGMS')
  1837*    END-EXEC.
  1838     MOVE LENGTH OF
  1839      PROGRAM-OPTIONS-SELECTED
  1840       TO DFHEIV11
  1841     MOVE 'ELPGMS' TO DFHEIV1
  1842*    MOVE '&& L                  %   #00001756' TO DFHEIV0
  1843     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1844     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1845     MOVE X'2020233030303031373536' TO DFHEIV0(25:11)
  1846     CALL 'kxdfhei1' USING DFHEIV0,
  1847           DFHEIV1,
  1848           PROGRAM-OPTIONS-SELECTED,
  1849           DFHEIV11,
  1850           DFHEIV99
  1851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1852
  1853
  1854     GO TO 2040-EXIT.
  1855
  1856 2010-PGMS-NOT-FOUND.
  1857
  1858* EXEC CICS GETMAIN
  1859*        SET     (ADDRESS OF PROGRAM-OPTIONS-SELECTED)
  1860*        LENGTH  (PGMS-LENGTH)
  1861*        INITIMG (LIT-SPACE)
  1862*    END-EXEC.
  1863*    MOVE ',"IL                  $   #00001764' TO DFHEIV0
  1864     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  1865     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1866     MOVE X'2020233030303031373634' TO DFHEIV0(25:11)
  1867     CALL 'kxdfhei1' USING DFHEIV0,
  1868           DFHEIV20,
  1869           PGMS-LENGTH,
  1870           LIT-SPACE
  1871     SET ADDRESS OF PROGRAM-OPTIONS-SELECTED TO
  1872         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL108.cbl
  1873     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1874
  1875
  1876     MOVE 'PS'          TO PS-RECORD-ID.
  1877     MOVE FILE-PGMS-KEY TO PS-CONTROL-PRIMARY.
  1878
  1879     MOVE SAVE-BIN-DATE          TO  PS-LAST-MAINT-DT.
  1880     MOVE EIBTIME                TO  PS-LAST-MAINT-HHMMSS.
  1881     MOVE PI-PROCESSOR-ID        TO  PS-LAST-MAINT-USER.
  1882
  1883     MOVE ZEROS TO COUNT-1.
  1884     PERFORM 3000-FORMAT-RECORD THRU 3010-EXIT 4 TIMES.
  1885
  1886
  1887* EXEC CICS WRITE
  1888*        FROM (PROGRAM-OPTIONS-SELECTED)
  1889*        DATASET ('ELPGMS')
  1890*        RIDFLD (FILE-PGMS-KEY)
  1891*    END-EXEC.
  1892     MOVE LENGTH OF
  1893      PROGRAM-OPTIONS-SELECTED
  1894       TO DFHEIV11
  1895     MOVE 'ELPGMS' TO DFHEIV1
  1896*    MOVE '&$ L                  ''   #00001780' TO DFHEIV0
  1897     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  1898     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1899     MOVE X'2020233030303031373830' TO DFHEIV0(25:11)
  1900     CALL 'kxdfhei1' USING DFHEIV0,
  1901           DFHEIV1,
  1902           PROGRAM-OPTIONS-SELECTED,
  1903           DFHEIV11,
  1904           FILE-PGMS-KEY,
  1905           DFHEIV99,
  1906           DFHEIV99
  1907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1908
  1909
  1910 2040-EXIT.
  1911     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL108.cbl
  1913 2100-VERIFY-FREQ.
  1914     MOVE FREQ1I TO CHECK-FREQ.
  1915     PERFORM 2140-FREQ-CHECK THRU 2150-EXIT.
  1916
  1917     IF SCREEN-ERROR
  1918         MOVE AL-UABON TO FREQ1A
  1919         MOVE -1       TO FREQ1L
  1920         MOVE SPACE    TO ERROR-SWITCH
  1921     ELSE
  1922         MOVE AL-UANON TO FREQ1A
  1923         PERFORM 2120-MOVE-FREQ THRU 2130-EXIT.
  1924
  1925     MOVE FREQ2I TO CHECK-FREQ.
  1926     PERFORM 2140-FREQ-CHECK THRU 2150-EXIT.
  1927
  1928     IF SCREEN-ERROR
  1929         MOVE AL-UABON TO FREQ2A
  1930         MOVE -1       TO FREQ2L
  1931         MOVE SPACE    TO ERROR-SWITCH
  1932     ELSE
  1933         MOVE AL-UANON TO FREQ2A
  1934         PERFORM 2120-MOVE-FREQ THRU 2130-EXIT.
  1935
  1936     MOVE FREQ3I TO CHECK-FREQ.
  1937     PERFORM 2140-FREQ-CHECK THRU 2150-EXIT.
  1938
  1939     IF SCREEN-ERROR
  1940         MOVE AL-UABON TO FREQ3A
  1941         MOVE -1       TO FREQ3L
  1942         MOVE SPACE    TO ERROR-SWITCH
  1943     ELSE
  1944         MOVE AL-UANON TO FREQ3A
  1945         PERFORM 2120-MOVE-FREQ THRU 2130-EXIT.
  1946
  1947     MOVE FREQ4I TO CHECK-FREQ.
  1948     PERFORM 2140-FREQ-CHECK THRU 2150-EXIT
  1949
  1950     IF SCREEN-ERROR
  1951         MOVE SPACE    TO ERROR-SWITCH
  1952         MOVE -1       TO FREQ4L
  1953         MOVE AL-UABON TO FREQ4A
  1954     ELSE
  1955         MOVE AL-UANON TO FREQ4A
  1956         PERFORM 2120-MOVE-FREQ THRU 2130-EXIT.
  1957
  1958 2110-EXIT.
  1959     EXIT.
  1960
  1961 2120-MOVE-FREQ.
  1962     ADD 1 TO COUNT-1.
  1963     MOVE CHECK-FREQ TO FREQ-CODE (COUNT-1).
  1964
  1965 2130-EXIT.
  1966     EXIT.
  1967
  1968 2140-FREQ-CHECK.
  1969     IF CHECK-FREQ = SPACES OR = LOW-VALUES
  1970        OR OPTION-ALWAYS-SET
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL108.cbl
  1971*       OR SET-ON-IF-EDIT
  1972*       OR SET-ON-IF-NOT-EDIT
  1973*       OR SET-ON-IF-UPDATE
  1974*       OR SET-ON-IF-NOT-UPDATE
  1975        OR SET-ON-IF-YEAR-END
  1976        OR SET-ON-IF-NOT-YEAR-END
  1977        OR SET-ON-IF-MO-3-6-9-12
  1978        OR SET-ON-IF-NOT-QTR-MO
  1979        OR SET-ON-IF-JAN
  1980        OR SET-ON-IF-FEB
  1981        OR SET-ON-IF-MARCH
  1982        OR SET-ON-IF-APRIL
  1983        OR SET-ON-IF-MAY
  1984        OR SET-ON-IF-JUNE
  1985        OR SET-ON-IF-JULY
  1986        OR SET-ON-IF-AUG
  1987        OR SET-ON-IF-SEPT
  1988        OR SET-ON-IF-OCT
  1989        OR SET-ON-IF-NOV
  1990        OR SET-ON-IF-DEC
  1991         GO TO 2150-EXIT.
  1992
  1993     MOVE 'X' TO ERROR-SWITCH.
  1994     MOVE ER-0163 TO EMI-ERROR.
  1995     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1996
  1997 2150-EXIT.
  1998     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL108.cbl
  2000 2200-VERIFY-PRINT.
  2001     MOVE PRT1I TO CHECK-PRINT.
  2002     PERFORM 2240-PRT-CHECK THRU 2250-EXIT.
  2003
  2004     IF SCREEN-ERROR
  2005         MOVE SPACE    TO ERROR-SWITCH
  2006         MOVE -1       TO PRT1L
  2007         MOVE AL-UABON TO PRT1A
  2008     ELSE
  2009         MOVE AL-UANON TO PRT1A
  2010         PERFORM 2220-MOVE-PRT THRU 2230-EXIT.
  2011
  2012     MOVE PRT2I TO CHECK-PRINT.
  2013     PERFORM 2240-PRT-CHECK THRU 2250-EXIT.
  2014
  2015     IF SCREEN-ERROR
  2016         MOVE SPACE    TO ERROR-SWITCH
  2017         MOVE -1       TO PRT2L
  2018         MOVE AL-UABON TO PRT2A
  2019     ELSE
  2020         MOVE AL-UANON TO PRT2A
  2021         PERFORM 2220-MOVE-PRT THRU 2230-EXIT.
  2022
  2023     MOVE PRT3I TO CHECK-PRINT.
  2024     PERFORM 2240-PRT-CHECK THRU 2250-EXIT.
  2025
  2026     IF SCREEN-ERROR
  2027         MOVE AL-UABON TO PRT3A
  2028         MOVE -1       TO PRT3L
  2029         MOVE SPACE    TO ERROR-SWITCH
  2030     ELSE
  2031         MOVE AL-UANON TO PRT3A
  2032         PERFORM 2220-MOVE-PRT THRU 2230-EXIT.
  2033
  2034     MOVE PRT4I TO CHECK-PRINT.
  2035     PERFORM 2240-PRT-CHECK THRU 2250-EXIT.
  2036
  2037     IF SCREEN-ERROR
  2038         MOVE AL-UABON TO PRT4A
  2039         MOVE -1       TO PRT4L
  2040         MOVE SPACE    TO ERROR-SWITCH
  2041     ELSE
  2042         MOVE AL-UANON TO PRT4A
  2043         PERFORM 2220-MOVE-PRT THRU 2230-EXIT.
  2044
  2045 2210-EXIT.
  2046     EXIT.
  2047
  2048 2220-MOVE-PRT.
  2049     ADD 1 TO COUNT-1.
  2050     MOVE CHECK-PRINT TO PRINT-OPT (COUNT-1).
  2051
  2052 2230-EXIT.
  2053     EXIT.
  2054
  2055 2240-PRT-CHECK.
  2056     IF CHECK-PRINT = SPACES OR LOW-VALUES
  2057        OR PRINT-TO-HARDCOPY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL108.cbl
  2058        OR PRINT-TO-FICHE-TAPE
  2059        OR PRINT-TO-BOTH-MEDIA
  2060        OR SAVE-REPORT-ONLINE-NO-PRINT
  2061        OR SAVE-REPORT-ONLINE-AND-PRINT
  2062         GO TO 2250-EXIT.
  2063
  2064     MOVE 'X'     TO ERROR-SWITCH.
  2065     MOVE ER-0164 TO EMI-ERROR.
  2066     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2067
  2068 2250-EXIT.
  2069     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL108.cbl
  2071
  2072 2300-VERIFY-FORMAT.
  2073     MOVE FMT1I TO OPTION-CODE.
  2074     PERFORM 2340-FMT-CHECK THRU 2360-EXIT.
  2075
  2076     IF SCREEN-ERROR
  2077         MOVE AL-UABON TO FMT1A
  2078         MOVE -1       TO FMT1L
  2079         MOVE SPACE    TO ERROR-SWITCH
  2080     ELSE
  2081         MOVE AL-UANON TO FMT1A
  2082         PERFORM 2320-MOVE-FMT THRU 2330-EXIT.
  2083
  2084
  2085     MOVE FMT2I TO OPTION-CODE.
  2086     PERFORM 2340-FMT-CHECK THRU 2360-EXIT.
  2087
  2088     IF SCREEN-ERROR
  2089         MOVE AL-UABON TO FMT2A
  2090         MOVE -1       TO FMT2L
  2091         MOVE SPACE    TO ERROR-SWITCH
  2092     ELSE
  2093         MOVE AL-UANON TO FMT2A
  2094         PERFORM 2320-MOVE-FMT THRU 2330-EXIT.
  2095
  2096
  2097     MOVE FMT3I TO OPTION-CODE.
  2098     PERFORM 2340-FMT-CHECK THRU 2360-EXIT.
  2099
  2100     IF SCREEN-ERROR
  2101         MOVE AL-UABON TO FMT3A
  2102         MOVE -1       TO FMT3L
  2103         MOVE SPACE    TO ERROR-SWITCH
  2104     ELSE
  2105         MOVE AL-UANON TO FMT3A
  2106         PERFORM 2320-MOVE-FMT THRU 2330-EXIT.
  2107
  2108     MOVE FMT4I TO OPTION-CODE.
  2109     PERFORM 2340-FMT-CHECK THRU 2360-EXIT.
  2110
  2111     IF SCREEN-ERROR
  2112         MOVE AL-UABON TO FMT4A
  2113         MOVE -1       TO FMT4L
  2114         MOVE SPACE    TO ERROR-SWITCH
  2115     ELSE
  2116         MOVE AL-UANON TO FMT4A
  2117         PERFORM 2320-MOVE-FMT THRU 2330-EXIT.
  2118
  2119 2310-EXIT.
  2120     EXIT.
  2121
  2122 2320-MOVE-FMT.
  2123     ADD 1 TO COUNT-1.
  2124     MOVE OPTION-CODE TO FORMAT-OPT (COUNT-1).
  2125
  2126 2330-EXIT.
  2127     EXIT.
  2128
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL108.cbl
  2129 2340-FMT-CHECK.
  2130     IF OPTION-CODE = SPACE OR LOW-VALUES
  2131         GO TO 2360-EXIT.
  2132
  2133     MOVE PGRMI TO PROGRAM-NUMBER.
  2134     MOVE 'F'   TO OPTION-TYPE.
  2135
  2136
  2137* EXEC CICS HANDLE CONDITION
  2138*        NOTFND (2350-FMT-NOT-FOUND)
  2139*    END-EXEC.
  2140*    MOVE '"$I                   ! $ #00002012' TO DFHEIV0
  2141     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2142     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2143     MOVE X'2420233030303032303132' TO DFHEIV0(25:11)
  2144     CALL 'kxdfhei1' USING DFHEIV0
  2145     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2146
  2147
  2148
  2149* EXEC CICS READ
  2150*        SET     (ADDRESS OF PROGRAM-OPTIONS-AVAILABLE)
  2151*        DATASET ('ELPGMO')
  2152*        RIDFLD  (FILE-PGMO-KEY)
  2153*    END-EXEC.
  2154     MOVE 'ELPGMO' TO DFHEIV1
  2155*    MOVE '&"S        E          (   #00002016' TO DFHEIV0
  2156     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2157     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2158     MOVE X'2020233030303032303136' TO DFHEIV0(25:11)
  2159     CALL 'kxdfhei1' USING DFHEIV0,
  2160           DFHEIV1,
  2161           DFHEIV20,
  2162           DFHEIV99,
  2163           FILE-PGMO-KEY,
  2164           DFHEIV99,
  2165           DFHEIV99,
  2166           DFHEIV99
  2167     SET ADDRESS OF PROGRAM-OPTIONS-AVAILABLE TO
  2168         DFHEIV20
  2169     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2170
  2171
  2172     GO TO 2360-EXIT.
  2173
  2174 2350-FMT-NOT-FOUND.
  2175     MOVE 'X'     TO ERROR-SWITCH.
  2176     MOVE ER-0165 TO EMI-ERROR.
  2177     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2178
  2179 2360-EXIT.
  2180     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL108.cbl
  2182 2400-VERIFY-PROCESS.
  2183     MOVE PROC1I TO OPTION-CODE.
  2184     PERFORM 2440-PROC-CHECK THRU 2460-EXIT.
  2185
  2186     IF SCREEN-ERROR
  2187         MOVE AL-UABON TO PROC1A
  2188         MOVE -1       TO PROC1L
  2189         MOVE SPACE    TO ERROR-SWITCH
  2190     ELSE
  2191         MOVE AL-UANON TO PROC1A
  2192         PERFORM 2420-MOVE-PROC THRU 2430-EXIT.
  2193
  2194     MOVE PROC2I TO OPTION-CODE.
  2195     PERFORM 2440-PROC-CHECK THRU 2460-EXIT.
  2196
  2197     IF SCREEN-ERROR
  2198         MOVE AL-UABON TO PROC2A
  2199         MOVE -1       TO PROC2L
  2200         MOVE SPACE    TO ERROR-SWITCH
  2201     ELSE
  2202         MOVE AL-UANON TO PROC2A
  2203         PERFORM 2420-MOVE-PROC THRU 2430-EXIT.
  2204
  2205     MOVE PROC3I TO OPTION-CODE.
  2206     PERFORM 2440-PROC-CHECK THRU 2460-EXIT.
  2207
  2208     IF SCREEN-ERROR
  2209         MOVE AL-UABON TO PROC3A
  2210         MOVE -1       TO PROC3L
  2211         MOVE SPACE    TO ERROR-SWITCH
  2212     ELSE
  2213         MOVE AL-UANON TO PROC3A
  2214         PERFORM 2420-MOVE-PROC THRU 2430-EXIT.
  2215
  2216     MOVE PROC4I TO OPTION-CODE.
  2217     PERFORM 2440-PROC-CHECK THRU 2460-EXIT.
  2218
  2219     IF SCREEN-ERROR
  2220         MOVE AL-UABON TO PROC4A
  2221         MOVE -1       TO PROC4L
  2222         MOVE SPACE    TO ERROR-SWITCH
  2223     ELSE
  2224         MOVE AL-UANON TO PROC4A
  2225         PERFORM 2420-MOVE-PROC THRU 2430-EXIT.
  2226
  2227 2410-EXIT.
  2228     EXIT.
  2229
  2230 2420-MOVE-PROC.
  2231     ADD 1 TO COUNT-1.
  2232     MOVE OPTION-CODE TO PROCESS-OPT (COUNT-1).
  2233
  2234 2430-EXIT.
  2235     EXIT.
  2236
  2237 2440-PROC-CHECK.
  2238     IF OPTION-CODE = SPACE OR LOW-VALUES OR  'X'
  2239         GO TO 2460-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL108.cbl
  2240
  2241     MOVE PGRMI TO PROGRAM-NUMBER.
  2242     MOVE 'P'   TO OPTION-TYPE.
  2243
  2244
  2245* EXEC CICS HANDLE CONDITION
  2246*        NOTFND (2450-PROC-NOT-FOUND)
  2247*    END-EXEC.
  2248*    MOVE '"$I                   ! % #00002094' TO DFHEIV0
  2249     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2250     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2251     MOVE X'2520233030303032303934' TO DFHEIV0(25:11)
  2252     CALL 'kxdfhei1' USING DFHEIV0
  2253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2254
  2255
  2256
  2257* EXEC CICS READ
  2258*        SET     (ADDRESS OF PROGRAM-OPTIONS-AVAILABLE)
  2259*        DATASET ('ELPGMO')
  2260*        RIDFLD  (FILE-PGMO-KEY)
  2261*    END-EXEC.
  2262     MOVE 'ELPGMO' TO DFHEIV1
  2263*    MOVE '&"S        E          (   #00002098' TO DFHEIV0
  2264     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2265     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2266     MOVE X'2020233030303032303938' TO DFHEIV0(25:11)
  2267     CALL 'kxdfhei1' USING DFHEIV0,
  2268           DFHEIV1,
  2269           DFHEIV20,
  2270           DFHEIV99,
  2271           FILE-PGMO-KEY,
  2272           DFHEIV99,
  2273           DFHEIV99,
  2274           DFHEIV99
  2275     SET ADDRESS OF PROGRAM-OPTIONS-AVAILABLE TO
  2276         DFHEIV20
  2277     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2278
  2279
  2280     GO TO 2460-EXIT.
  2281
  2282 2450-PROC-NOT-FOUND.
  2283     MOVE 'X'     TO ERROR-SWITCH.
  2284     MOVE ER-0166 TO EMI-ERROR.
  2285     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2286
  2287 2460-EXIT.
  2288     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL108.cbl
  2290 2500-VERIFY-TOTAL.
  2291     MOVE TOT1I TO OPTION-CODE.
  2292     PERFORM 2540-TOTAL-CHECK THRU 2560-EXIT.
  2293
  2294     IF SCREEN-ERROR
  2295         MOVE AL-UABON TO TOT1A
  2296         MOVE -1       TO TOT1L
  2297         MOVE SPACE    TO ERROR-SWITCH
  2298     ELSE
  2299         MOVE AL-UANON TO TOT1A
  2300         PERFORM 2520-MOVE-TOTAL THRU 2530-EXIT.
  2301
  2302     MOVE TOT2I TO OPTION-CODE.
  2303     PERFORM 2540-TOTAL-CHECK THRU 2560-EXIT.
  2304
  2305     IF SCREEN-ERROR
  2306         MOVE AL-UABON TO TOT2A
  2307         MOVE -1       TO TOT2L
  2308         MOVE SPACE    TO ERROR-SWITCH
  2309     ELSE
  2310         MOVE AL-UANON TO TOT2A
  2311         PERFORM 2520-MOVE-TOTAL THRU 2530-EXIT.
  2312
  2313     MOVE TOT3I TO OPTION-CODE.
  2314     PERFORM 2540-TOTAL-CHECK THRU 2560-EXIT.
  2315
  2316     IF SCREEN-ERROR
  2317         MOVE AL-UABON TO TOT3A
  2318         MOVE -1       TO TOT3L
  2319         MOVE SPACE    TO ERROR-SWITCH
  2320     ELSE
  2321         MOVE AL-UANON TO TOT3A
  2322         PERFORM 2520-MOVE-TOTAL THRU 2530-EXIT.
  2323
  2324     MOVE TOT4I TO OPTION-CODE.
  2325     PERFORM 2540-TOTAL-CHECK THRU 2560-EXIT.
  2326
  2327     IF SCREEN-ERROR
  2328         MOVE AL-UABON TO TOT4A
  2329         MOVE -1       TO TOT4L
  2330         MOVE SPACE    TO ERROR-SWITCH
  2331     ELSE
  2332         MOVE AL-UANON TO TOT4A
  2333         PERFORM 2520-MOVE-TOTAL THRU 2530-EXIT.
  2334
  2335 2510-EXIT.
  2336     EXIT.
  2337
  2338 2520-MOVE-TOTAL.
  2339     ADD 1 TO COUNT-1.
  2340     MOVE OPTION-CODE TO TOTAL-OPT (COUNT-1).
  2341
  2342 2530-EXIT.
  2343     EXIT.
  2344
  2345 2540-TOTAL-CHECK.
  2346     IF OPTION-CODE = SPACE OR LOW-VALUES
  2347         GO TO 2560-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL108.cbl
  2348
  2349     MOVE PGRMI TO PROGRAM-NUMBER.
  2350     MOVE 'T'   TO OPTION-TYPE.
  2351
  2352
  2353* EXEC CICS HANDLE CONDITION
  2354*        NOTFND (2550-TOT-NOT-FOUND)
  2355*    END-EXEC.
  2356*    MOVE '"$I                   ! & #00002176' TO DFHEIV0
  2357     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2358     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2359     MOVE X'2620233030303032313736' TO DFHEIV0(25:11)
  2360     CALL 'kxdfhei1' USING DFHEIV0
  2361     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2362
  2363
  2364
  2365* EXEC CICS READ
  2366*        SET     (ADDRESS OF PROGRAM-OPTIONS-AVAILABLE)
  2367*        DATASET ('ELPGMO')
  2368*        RIDFLD  (FILE-PGMO-KEY)
  2369*    END-EXEC.
  2370     MOVE 'ELPGMO' TO DFHEIV1
  2371*    MOVE '&"S        E          (   #00002180' TO DFHEIV0
  2372     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2373     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2374     MOVE X'2020233030303032313830' TO DFHEIV0(25:11)
  2375     CALL 'kxdfhei1' USING DFHEIV0,
  2376           DFHEIV1,
  2377           DFHEIV20,
  2378           DFHEIV99,
  2379           FILE-PGMO-KEY,
  2380           DFHEIV99,
  2381           DFHEIV99,
  2382           DFHEIV99
  2383     SET ADDRESS OF PROGRAM-OPTIONS-AVAILABLE TO
  2384         DFHEIV20
  2385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2386
  2387
  2388     GO TO 2560-EXIT.
  2389
  2390 2550-TOT-NOT-FOUND.
  2391     MOVE 'X'     TO ERROR-SWITCH.
  2392     MOVE ER-0167 TO EMI-ERROR.
  2393     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2394
  2395 2560-EXIT.
  2396     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL108.cbl
  2398 2600-CHECK-REQUIRE.
  2399     IF (FREQ1I    = SPACES OR LOW-VALUES)
  2400        IF (PRT1I  = SPACES OR LOW-VALUES) AND
  2401           (FMT1I  = SPACES OR LOW-VALUES) AND
  2402           (PROC1I = SPACES OR LOW-VALUES) AND
  2403           (TOT1I  = SPACES OR LOW-VALUES)
  2404           NEXT SENTENCE
  2405          ELSE
  2406           MOVE AL-UABON TO FREQ1A
  2407           MOVE -1       TO FREQ1L
  2408           MOVE 'X'      TO ERROR-SWITCH
  2409       ELSE
  2410        IF (PRT1I  = SPACES OR = LOW-VALUES)
  2411           MOVE AL-UABON TO PRT1A
  2412           MOVE -1       TO PRT1L
  2413           MOVE 'X'      TO ERROR-SWITCH.
  2414
  2415     IF (FREQ2I    = SPACES OR LOW-VALUES)
  2416        IF (PRT2I  = SPACES OR LOW-VALUES) AND
  2417           (FMT2I  = SPACES OR LOW-VALUES) AND
  2418           (PROC2I = SPACES OR LOW-VALUES) AND
  2419           (TOT2I  = SPACES OR LOW-VALUES)
  2420           NEXT SENTENCE
  2421          ELSE
  2422           MOVE AL-UABON TO FREQ2A
  2423           MOVE -1       TO FREQ2L
  2424           MOVE 'X'      TO ERROR-SWITCH
  2425       ELSE
  2426        IF (PRT2I  = SPACES OR LOW-VALUES)
  2427           MOVE AL-UABON TO PRT2A
  2428           MOVE -1       TO PRT2L
  2429           MOVE 'X'      TO ERROR-SWITCH.
  2430
  2431     IF (FREQ3I    = SPACES OR LOW-VALUES)
  2432        IF (PRT3I  = SPACES OR LOW-VALUES) AND
  2433           (FMT3I  = SPACES OR LOW-VALUES) AND
  2434           (PROC3I = SPACES OR LOW-VALUES) AND
  2435           (TOT3I  = SPACES OR LOW-VALUES)
  2436           NEXT SENTENCE
  2437          ELSE
  2438           MOVE AL-UABON TO FREQ3A
  2439           MOVE -1       TO FREQ3L
  2440           MOVE 'X'      TO ERROR-SWITCH
  2441       ELSE
  2442        IF (PRT3I  = SPACES OR LOW-VALUES)
  2443           MOVE AL-UABON TO PRT3A
  2444           MOVE -1       TO PRT3L
  2445           MOVE 'X'      TO ERROR-SWITCH.
  2446
  2447     IF (FREQ4I    = SPACES OR LOW-VALUES)
  2448        IF (PRT4I  = SPACES OR LOW-VALUES) AND
  2449           (FMT4I  = SPACES OR LOW-VALUES) AND
  2450           (PROC4I = SPACES OR LOW-VALUES) AND
  2451           (TOT4I  = SPACES OR LOW-VALUES)
  2452           NEXT SENTENCE
  2453          ELSE
  2454           MOVE AL-UABON TO FREQ4A
  2455           MOVE -1       TO FREQ4L
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL108.cbl
  2456           MOVE 'X'      TO ERROR-SWITCH
  2457       ELSE
  2458        IF (PRT4I  = SPACES OR LOW-VALUES)
  2459           MOVE AL-UABON TO PRT4A
  2460           MOVE -1       TO PRT4L
  2461           MOVE 'X'      TO ERROR-SWITCH.
  2462
  2463     IF SCREEN-ERROR
  2464        MOVE ER-0486          TO EMI-ERROR
  2465         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2466
  2467 2650-EXIT.
  2468     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL108.cbl
  2470 3000-FORMAT-RECORD.
  2471     ADD 1 TO COUNT-1.
  2472     MOVE HOLD-PROGRAM-OPT (COUNT-1)
  2473             TO PS-PROGRAM-OPTIONS (COUNT-1).
  2474
  2475 3010-EXIT.
  2476     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL108.cbl
  2478 3100-SHOW-OPTIONS.
  2479     MOVE PI-COMPANY-CD TO COMPANY-CD.
  2480
  2481     IF PGRML = ZERO
  2482         MOVE LOW-VALUES  TO  PROGRAM-NO
  2483     ELSE
  2484         MOVE PGRMI       TO  PROGRAM-NO.
  2485
  2486     IF EIBAID      = DFHPF7   AND
  2487        PROGRAM-NO  = LOW-VALUES
  2488         GO TO 8700-ENDFILE.
  2489
  2490
  2491* EXEC CICS HANDLE CONDITION
  2492*        NOTFND    (8700-ENDFILE)
  2493*        ENDFILE   (8700-ENDFILE)
  2494*    END-EXEC.
  2495*    MOVE '"$I''                  ! '' #00002288' TO DFHEIV0
  2496     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  2497     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2498     MOVE X'2720233030303032323838' TO DFHEIV0(25:11)
  2499     CALL 'kxdfhei1' USING DFHEIV0
  2500     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2501
  2502
  2503
  2504* EXEC CICS STARTBR
  2505*        DATASET    ('ELPGMS')
  2506*        RIDFLD     (FILE-PGMS-KEY)
  2507*    END-EXEC.
  2508     MOVE 'ELPGMS' TO DFHEIV1
  2509     MOVE 0
  2510       TO DFHEIV11
  2511*    MOVE '&,         G          &   #00002293' TO DFHEIV0
  2512     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2513     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2514     MOVE X'2020233030303032323933' TO DFHEIV0(25:11)
  2515     CALL 'kxdfhei1' USING DFHEIV0,
  2516           DFHEIV1,
  2517           FILE-PGMS-KEY,
  2518           DFHEIV99,
  2519           DFHEIV11,
  2520           DFHEIV99
  2521     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2522
  2523
  2524     MOVE '1'  TO  BROWSE-STARTED-SW.
  2525
  2526 3110-READ-NEXT.
  2527     IF EIBAID  = DFHPF7
  2528
  2529* EXEC CICS READPREV
  2530*            DATASET    ('ELPGMS')
  2531*            SET        (ADDRESS OF PROGRAM-OPTIONS-SELECTED)
  2532*            RIDFLD     (FILE-PGMS-KEY)
  2533*        END-EXEC
  2534     MOVE 'ELPGMS' TO DFHEIV1
  2535     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL108.cbl
  2536       TO DFHEIV11
  2537*    MOVE '&0S                   )   #00002302' TO DFHEIV0
  2538     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  2539     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2540     MOVE X'2020233030303032333032' TO DFHEIV0(25:11)
  2541     CALL 'kxdfhei1' USING DFHEIV0,
  2542           DFHEIV1,
  2543           DFHEIV20,
  2544           DFHEIV99,
  2545           FILE-PGMS-KEY,
  2546           DFHEIV99,
  2547           DFHEIV11,
  2548           DFHEIV99,
  2549           DFHEIV99
  2550     SET ADDRESS OF PROGRAM-OPTIONS-SELECTED TO
  2551         DFHEIV20
  2552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2553     ELSE
  2554
  2555* EXEC CICS READNEXT
  2556*            DATASET    ('ELPGMS')
  2557*            SET        (ADDRESS OF PROGRAM-OPTIONS-SELECTED)
  2558*            RIDFLD     (FILE-PGMS-KEY)
  2559*        END-EXEC.
  2560     MOVE 'ELPGMS' TO DFHEIV1
  2561     MOVE 0
  2562       TO DFHEIV11
  2563*    MOVE '&.S                   )   #00002308' TO DFHEIV0
  2564     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2565     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2566     MOVE X'2020233030303032333038' TO DFHEIV0(25:11)
  2567     CALL 'kxdfhei1' USING DFHEIV0,
  2568           DFHEIV1,
  2569           DFHEIV20,
  2570           DFHEIV99,
  2571           FILE-PGMS-KEY,
  2572           DFHEIV99,
  2573           DFHEIV11,
  2574           DFHEIV99,
  2575           DFHEIV99
  2576     SET ADDRESS OF PROGRAM-OPTIONS-SELECTED TO
  2577         DFHEIV20
  2578     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2579
  2580
  2581     IF PS-COMPANY-CD  NOT = PI-COMPANY-CD
  2582         GO TO 8700-ENDFILE.
  2583
  2584     IF PS-PROGRAM-NUMBER  = PI-PROGRAM-NO
  2585         GO TO 3110-READ-NEXT.
  2586
  2587     MOVE ZEROS   TO  COUNT-1.
  2588
  2589     PERFORM 4100-FORMAT-WS THRU 4110-EXIT 4 TIMES.
  2590
  2591     MOVE ZEROS   TO  COUNT-1.
  2592
  2593     PERFORM 4200-FORMAT-SCREEN  THRU  4210-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL108.cbl
  2594
  2595     MOVE -1                 TO  MAINTL.
  2596     MOVE SPACE              TO  MAINTO.
  2597     MOVE AL-UANON           TO  PGRMA.
  2598     MOVE PS-PROGRAM-NUMBER  TO  PGRMO  PI-PROGRAM-NO.
  2599
  2600     IF BROWSE-STARTED
  2601         MOVE ' '  TO  BROWSE-STARTED-SW
  2602         PERFORM 3200-END-BROWSE  THRU  3299-EXIT.
  2603
  2604     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL108.cbl
  2606 3200-END-BROWSE.
  2607
  2608* EXEC CICS ENDBR
  2609*        DATASET    ('ELPGMS')
  2610*    END-EXEC.
  2611     MOVE 'ELPGMS' TO DFHEIV1
  2612     MOVE 0
  2613       TO DFHEIV11
  2614*    MOVE '&2                    $   #00002340' TO DFHEIV0
  2615     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2616     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2617     MOVE X'2020233030303032333430' TO DFHEIV0(25:11)
  2618     CALL 'kxdfhei1' USING DFHEIV0,
  2619           DFHEIV1,
  2620           DFHEIV11,
  2621           DFHEIV99
  2622     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2623
  2624
  2625 3299-EXIT.
  2626     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL108.cbl
  2628 4000-SHOW-OPTIONS.
  2629     MOVE PI-COMPANY-CD TO COMPANY-CD.
  2630     MOVE PGRMI         TO PROGRAM-NO.
  2631
  2632
  2633* EXEC CICS HANDLE CONDITION
  2634*        NOTFND (4010-FORMAT-OPTIONS)
  2635*    END-EXEC.
  2636*    MOVE '"$I                   ! ( #00002351' TO DFHEIV0
  2637     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  2638     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2639     MOVE X'2820233030303032333531' TO DFHEIV0(25:11)
  2640     CALL 'kxdfhei1' USING DFHEIV0
  2641     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2642
  2643
  2644
  2645* EXEC CICS READ
  2646*        SET     (ADDRESS OF PROGRAM-OPTIONS-SELECTED)
  2647*        DATASET ('ELPGMS')
  2648*        RIDFLD  (FILE-PGMS-KEY)
  2649*    END-EXEC.
  2650     MOVE 'ELPGMS' TO DFHEIV1
  2651*    MOVE '&"S        E          (   #00002355' TO DFHEIV0
  2652     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2653     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2654     MOVE X'2020233030303032333535' TO DFHEIV0(25:11)
  2655     CALL 'kxdfhei1' USING DFHEIV0,
  2656           DFHEIV1,
  2657           DFHEIV20,
  2658           DFHEIV99,
  2659           FILE-PGMS-KEY,
  2660           DFHEIV99,
  2661           DFHEIV99,
  2662           DFHEIV99
  2663     SET ADDRESS OF PROGRAM-OPTIONS-SELECTED TO
  2664         DFHEIV20
  2665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2666
  2667
  2668     MOVE ZEROS TO COUNT-1.
  2669     PERFORM 4100-FORMAT-WS THRU 4110-EXIT 4 TIMES.
  2670
  2671 4010-FORMAT-OPTIONS.
  2672     IF PROGRAM-OPT-HOLD = SPACES
  2673         MOVE ER-0269 TO EMI-ERROR
  2674         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2675         MOVE -1                 TO  MAINTL
  2676         GO TO 8110-SEND-DATA.
  2677
  2678     MOVE ZEROS TO COUNT-1.
  2679     PERFORM 4200-FORMAT-SCREEN THRU 4210-EXIT.
  2680
  2681 4020-EXIT.
  2682     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL108.cbl
  2684 4100-FORMAT-WS.
  2685     ADD 1 TO COUNT-1.
  2686     MOVE PS-PROGRAM-OPTIONS (COUNT-1)
  2687             TO HOLD-PROGRAM-OPT (COUNT-1).
  2688
  2689 4110-EXIT.
  2690     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL108.cbl
  2692 4200-FORMAT-SCREEN.
  2693     MOVE ' '                    TO  DC-OPTION-CODE.
  2694
  2695     IF PS-LAST-MAINT-DT  IS EQUAL TO  SPACES
  2696         MOVE LOW-VALUES         TO  PS-LAST-MAINT-DT.
  2697
  2698     MOVE PS-LAST-MAINT-DT       TO  DC-BIN-DATE-1.
  2699
  2700     PERFORM 9700-LINK-DATE-CONVERT  THRU  9700-EXIT.
  2701
  2702     IF NO-CONVERSION-ERROR
  2703         MOVE DC-GREG-DATE-1-EDIT
  2704                                 TO  LSTDTEO
  2705     ELSE
  2706         MOVE '00/00/00'         TO  LSTDTEO.
  2707
  2708     IF PS-LAST-MAINT-HHMMSS  IS NUMERIC
  2709         MOVE PS-LAST-MAINT-HHMMSS
  2710                                 TO  TIME-IN
  2711         MOVE TIME-OUT           TO  LSTTIMEO
  2712     ELSE
  2713         MOVE ZEROS              TO  TIME-IN
  2714         MOVE TIME-OUT           TO  LSTTIMEO.
  2715
  2716     MOVE PS-LAST-MAINT-USER     TO  LSTUSRO.
  2717
  2718     ADD 1 TO COUNT-1.
  2719     MOVE FREQ-CODE (COUNT-1)   TO FREQ1O.
  2720     MOVE PRINT-OPT (COUNT-1)   TO PRT1O.
  2721     MOVE FORMAT-OPT (COUNT-1)  TO FMT1O.
  2722     MOVE PROCESS-OPT (COUNT-1) TO PROC1O.
  2723     MOVE TOTAL-OPT (COUNT-1)   TO TOT1O.
  2724     MOVE AL-UANON              TO FREQ1A
  2725                                   PRT1A
  2726                                   FMT1A
  2727                                   PROC1A
  2728                                   TOT1A.
  2729     ADD 1 TO COUNT-1.
  2730     MOVE FREQ-CODE (COUNT-1)   TO FREQ2O.
  2731     MOVE PRINT-OPT (COUNT-1)   TO PRT2O.
  2732     MOVE FORMAT-OPT (COUNT-1)  TO FMT2O.
  2733     MOVE PROCESS-OPT (COUNT-1) TO PROC2O.
  2734     MOVE TOTAL-OPT (COUNT-1)   TO TOT2O.
  2735     MOVE AL-UANON              TO FREQ2A
  2736                                   PRT2A
  2737                                   FMT2A
  2738                                   PROC2A
  2739                                   TOT2A.
  2740     ADD 1 TO COUNT-1.
  2741     MOVE FREQ-CODE (COUNT-1)   TO FREQ3O.
  2742     MOVE PRINT-OPT (COUNT-1)   TO PRT3O.
  2743     MOVE FORMAT-OPT (COUNT-1)  TO FMT3O.
  2744     MOVE PROCESS-OPT (COUNT-1) TO PROC3O.
  2745     MOVE TOTAL-OPT (COUNT-1)   TO TOT3O.
  2746     MOVE AL-UANON              TO FREQ3A
  2747                                   PRT3A
  2748                                   FMT3A
  2749                                   PROC3A
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL108.cbl
  2750                                   TOT3A.
  2751     ADD 1 TO COUNT-1.
  2752     MOVE FREQ-CODE (COUNT-1)   TO FREQ4O.
  2753     MOVE PRINT-OPT (COUNT-1)   TO PRT4O.
  2754     MOVE FORMAT-OPT (COUNT-1)  TO FMT4O.
  2755     MOVE PROCESS-OPT (COUNT-1) TO PROC4O.
  2756     MOVE TOTAL-OPT (COUNT-1)   TO TOT4O.
  2757     MOVE AL-UANON              TO FREQ4A
  2758                                   PRT4A
  2759                                   FMT4A
  2760                                   PROC4A
  2761                                   TOT4A.
  2762
  2763 4210-EXIT.
  2764     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL108.cbl
  2766 5000-SHOW-FREQ.
  2767     MOVE SPACE TO ERROR-SWITCH.
  2768     MOVE ZEROS TO COUNT-1.
  2769     PERFORM 5010-FREQ-OPTION THRU 5020-EXIT 4 TIMES.
  2770
  2771     PERFORM 5130-SPACE-SCREEN THRU 5140-EXIT 5 TIMES.
  2772
  2773     MOVE 'FREQUENCY' TO VARDESCO.
  2774     MOVE -1          TO MAINTL.
  2775     GO TO 8110-SEND-DATA.
  2776
  2777 5010-FREQ-OPTION.
  2778     ADD 1 TO COUNT-1.
  2779     MOVE OPTIONS-FREQ (COUNT-1) TO OPTO (COUNT-1).
  2780
  2781 5020-EXIT.
  2782     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL108.cbl
  2784 5100-SHOW-PRINT.
  2785     MOVE SPACES TO ERROR-SWITCH.
  2786     MOVE ZEROS  TO COUNT-1.
  2787     PERFORM 5110-PRINT-OPTION THRU 5120-EXIT 5 TIMES.
  2788
  2789     PERFORM 5130-SPACE-SCREEN THRU 5140-EXIT 4 TIMES.
  2790
  2791     MOVE 'PRINT' TO VARDESCO.
  2792     MOVE -1      TO MAINTL.
  2793     GO TO 8110-SEND-DATA.
  2794
  2795 5110-PRINT-OPTION.
  2796     ADD 1 TO COUNT-1.
  2797     MOVE OPTIONS-PRINT (COUNT-1) TO OPTO (COUNT-1).
  2798
  2799 5120-EXIT.
  2800     EXIT.
  2801
  2802 5130-SPACE-SCREEN.
  2803     ADD 1 TO COUNT-1.
  2804     MOVE SPACES TO OPTO (COUNT-1).
  2805
  2806 5140-EXIT.
  2807     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL108.cbl
  2809 5200-SHOW-TOTAL.
  2810     MOVE SPACE TO ERROR-SWITCH.
  2811
  2812* EXEC CICS HANDLE CONDITION
  2813*        NOTFND (5210-TOTAL-NOTFND)
  2814*        ENDFILE (6030-END-OF-FILE)
  2815*    END-EXEC.
  2816*    MOVE '"$I''                  ! ) #00002504' TO DFHEIV0
  2817     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  2818     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2819     MOVE X'2920233030303032353034' TO DFHEIV0(25:11)
  2820     CALL 'kxdfhei1' USING DFHEIV0
  2821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2822
  2823
  2824     MOVE PGRMI  TO PROGRAM-NUMBER HOLD-PROGRAM.
  2825     MOVE 'T'    TO OPTION-TYPE HOLD-TYPE.
  2826     MOVE SPACES TO OPTION-CODE TYPE-SWITCH PROGRAM-OPT-DESC.
  2827
  2828     PERFORM 6000-START-BROWSE THRU 6010-EXIT.
  2829
  2830     PERFORM 6020-READ-FILE THRU 6040-EXIT
  2831         UNTIL END-OF-TYPE.
  2832
  2833     PERFORM 6050-END-BROWSE THRU 6080-EXIT.
  2834
  2835 5210-TOTAL-NOTFND.
  2836     IF PROGRAM-OPT-DESC = SPACES
  2837         MOVE ER-0267 TO EMI-ERROR
  2838         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2839
  2840     MOVE ZEROS TO COUNT-1.
  2841     PERFORM 5500-FORMAT-SCREEN THRU 5510-EXIT 8 TIMES.
  2842
  2843     PERFORM 5130-SPACE-SCREEN THRU 5140-EXIT.
  2844
  2845     MOVE 'TOTAL' TO VARDESCO.
  2846     MOVE -1      TO MAINTL.
  2847     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL108.cbl
  2849 5300-SHOW-PROCESS.
  2850     MOVE SPACE TO ERROR-SWITCH.
  2851
  2852* EXEC CICS HANDLE CONDITION
  2853*        NOTFND  (5310-PROCESS-NOTFND)
  2854*        ENDFILE (6030-END-OF-FILE)
  2855*    END-EXEC.
  2856*    MOVE '"$I''                  ! * #00002536' TO DFHEIV0
  2857     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  2858     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2859     MOVE X'2A20233030303032353336' TO DFHEIV0(25:11)
  2860     CALL 'kxdfhei1' USING DFHEIV0
  2861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2862
  2863
  2864     MOVE PGRMI  TO PROGRAM-NUMBER HOLD-PROGRAM.
  2865     MOVE 'P'    TO OPTION-TYPE HOLD-TYPE.
  2866     MOVE SPACES TO OPTION-CODE TYPE-SWITCH PROGRAM-OPT-DESC.
  2867
  2868     PERFORM 6000-START-BROWSE THRU 6010-EXIT.
  2869
  2870     PERFORM 6020-READ-FILE THRU 6040-EXIT
  2871         UNTIL END-OF-TYPE.
  2872
  2873     PERFORM 6050-END-BROWSE THRU 6080-EXIT.
  2874
  2875 5310-PROCESS-NOTFND.
  2876     IF PROGRAM-OPT-DESC = SPACES
  2877         MOVE ER-0267 TO EMI-ERROR
  2878         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2879
  2880     MOVE ZEROS TO COUNT-1.
  2881     PERFORM 5500-FORMAT-SCREEN THRU 5510-EXIT 8 TIMES.
  2882
  2883     ADD 1                       TO COUNT-1.
  2884     MOVE DO-NOT-RUN             TO OPTO (COUNT-1).
  2885     MOVE 'PROCESS' TO VARDESCO.
  2886     MOVE -1        TO MAINTL.
  2887     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL108.cbl
  2889 5400-SHOW-FORMAT.
  2890     MOVE SPACE TO ERROR-SWITCH.
  2891
  2892* EXEC CICS HANDLE CONDITION
  2893*        NOTFND  (5410-FORMAT-NOTFND)
  2894*        ENDFILE (6030-END-OF-FILE)
  2895*    END-EXEC.
  2896*    MOVE '"$I''                  ! + #00002568' TO DFHEIV0
  2897     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  2898     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2899     MOVE X'2B20233030303032353638' TO DFHEIV0(25:11)
  2900     CALL 'kxdfhei1' USING DFHEIV0
  2901     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2902
  2903
  2904     MOVE PGRMI  TO PROGRAM-NUMBER HOLD-PROGRAM.
  2905     MOVE 'F'    TO OPTION-TYPE HOLD-TYPE.
  2906     MOVE SPACES TO OPTION-CODE TYPE-SWITCH PROGRAM-OPT-DESC.
  2907
  2908     PERFORM 6000-START-BROWSE THRU 6010-EXIT.
  2909
  2910     PERFORM 6020-READ-FILE THRU 6040-EXIT
  2911         UNTIL END-OF-TYPE.
  2912
  2913     PERFORM 6050-END-BROWSE THRU 6080-EXIT.
  2914
  2915 5410-FORMAT-NOTFND.
  2916     IF PROGRAM-OPT-DESC = SPACES
  2917         MOVE ER-0267 TO EMI-ERROR
  2918         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2919
  2920     MOVE ZEROS TO COUNT-1.
  2921     PERFORM 5500-FORMAT-SCREEN THRU 5510-EXIT 8 TIMES.
  2922
  2923     PERFORM 5130-SPACE-SCREEN THRU 5140-EXIT.
  2924
  2925     MOVE 'FORMAT' TO VARDESCO.
  2926     MOVE -1       TO MAINTL.
  2927     GO TO 8110-SEND-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL108.cbl
  2929 5500-FORMAT-SCREEN.
  2930     ADD 1 TO COUNT-1.
  2931     MOVE COUNT-1 TO OPT-NO (COUNT-1).
  2932     MOVE '='     TO CONST-FILL (COUNT-1).
  2933     MOVE DESC-PROGRAM-OPT (COUNT-1) TO OPTO (COUNT-1).
  2934
  2935 5510-EXIT.
  2936     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL108.cbl
  2938 6000-START-BROWSE.
  2939
  2940* EXEC CICS STARTBR
  2941*        DATASET ('ELPGMO')
  2942*        RIDFLD (FILE-PGMO-KEY)
  2943*    END-EXEC.
  2944     MOVE 'ELPGMO' TO DFHEIV1
  2945     MOVE 0
  2946       TO DFHEIV11
  2947*    MOVE '&,         G          &   #00002608' TO DFHEIV0
  2948     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2949     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2950     MOVE X'2020233030303032363038' TO DFHEIV0(25:11)
  2951     CALL 'kxdfhei1' USING DFHEIV0,
  2952           DFHEIV1,
  2953           FILE-PGMO-KEY,
  2954           DFHEIV99,
  2955           DFHEIV11,
  2956           DFHEIV99
  2957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2958
  2959
  2960 6010-EXIT.
  2961     EXIT.
  2962
  2963 6020-READ-FILE.
  2964
  2965* EXEC CICS READNEXT
  2966*        SET     (ADDRESS OF PROGRAM-OPTIONS-AVAILABLE)
  2967*        DATASET ('ELPGMO')
  2968*        RIDFLD  (FILE-PGMO-KEY)
  2969*    END-EXEC.
  2970     MOVE 'ELPGMO' TO DFHEIV1
  2971     MOVE 0
  2972       TO DFHEIV11
  2973*    MOVE '&.S                   )   #00002617' TO DFHEIV0
  2974     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2975     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2976     MOVE X'2020233030303032363137' TO DFHEIV0(25:11)
  2977     CALL 'kxdfhei1' USING DFHEIV0,
  2978           DFHEIV1,
  2979           DFHEIV20,
  2980           DFHEIV99,
  2981           FILE-PGMO-KEY,
  2982           DFHEIV99,
  2983           DFHEIV11,
  2984           DFHEIV99,
  2985           DFHEIV99
  2986     SET ADDRESS OF PROGRAM-OPTIONS-AVAILABLE TO
  2987         DFHEIV20
  2988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2989
  2990
  2991     IF PO-PROGRAM-NUMBER NOT = HOLD-PROGRAM OR
  2992        PO-OPTION-TYPE NOT = HOLD-TYPE
  2993         GO TO 6030-END-OF-FILE.
  2994
  2995     MOVE PO-PGM-OPTION-CD      TO COUNT-1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL108.cbl
  2996     MOVE PO-OPTION-DESCRIPTION TO PGMO-DESC (COUNT-1).
  2997     GO TO 6040-EXIT.
  2998
  2999 6030-END-OF-FILE.
  3000     MOVE 'X' TO TYPE-SWITCH.
  3001
  3002 6040-EXIT.
  3003     EXIT.
  3004
  3005 6050-END-BROWSE.
  3006
  3007* EXEC CICS ENDBR
  3008*        DATASET ('ELPGMO')
  3009*    END-EXEC.
  3010     MOVE 'ELPGMO' TO DFHEIV1
  3011     MOVE 0
  3012       TO DFHEIV11
  3013*    MOVE '&2                    $   #00002638' TO DFHEIV0
  3014     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3015     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3016     MOVE X'2020233030303032363338' TO DFHEIV0(25:11)
  3017     CALL 'kxdfhei1' USING DFHEIV0,
  3018           DFHEIV1,
  3019           DFHEIV11,
  3020           DFHEIV99
  3021     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3022
  3023
  3024 6080-EXIT.
  3025     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL108.cbl
  3027 8100-SEND-INITIAL-MAP.
  3028     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
  3029
  3030
  3031* EXEC CICS SEND
  3032*        MAP    ('EL108A')
  3033*        MAPSET ('EL108S')
  3034*        ERASE
  3035*        FREEKB
  3036*        CURSOR
  3037*    END-EXEC.
  3038     MOVE 'EL108A' TO DFHEIV1
  3039     MOVE -1
  3040       TO DFHEIV11
  3041     MOVE 'EL108S' TO DFHEIV2
  3042*    MOVE '8$     CT  E F  H     ,   #00002648' TO DFHEIV0
  3043     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3044     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  3045     MOVE X'2020233030303032363438' TO DFHEIV0(25:11)
  3046     CALL 'kxdfhei1' USING DFHEIV0,
  3047           DFHEIV1,
  3048           EL108AO,
  3049           DFHEIV99,
  3050           DFHEIV2,
  3051           DFHEIV99,
  3052           DFHEIV99,
  3053           DFHEIV99,
  3054           DFHEIV11,
  3055           DFHEIV99,
  3056           DFHEIV99,
  3057           DFHEIV99
  3058     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3059
  3060
  3061     GO TO 9000-RETURN-TRANS.
  3062
  3063 8110-SEND-DATA.
  3064     PERFORM 8120-FORMAT-TIME-DATE THRU 8130-EXIT.
  3065
  3066
  3067* EXEC CICS SEND
  3068*        MAP    ('EL108A')
  3069*        MAPSET ('EL108S')
  3070*        DATAONLY
  3071*        FREEKB
  3072*        CURSOR
  3073*    END-EXEC.
  3074     MOVE 'EL108A' TO DFHEIV1
  3075     MOVE -1
  3076       TO DFHEIV11
  3077     MOVE 'EL108S' TO DFHEIV2
  3078*    MOVE '8$D    CT    F  H     ,   #00002661' TO DFHEIV0
  3079     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3080     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  3081     MOVE X'2020233030303032363631' TO DFHEIV0(25:11)
  3082     CALL 'kxdfhei1' USING DFHEIV0,
  3083           DFHEIV1,
  3084           EL108AO,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL108.cbl
  3085           DFHEIV99,
  3086           DFHEIV2,
  3087           DFHEIV99,
  3088           DFHEIV99,
  3089           DFHEIV99,
  3090           DFHEIV11,
  3091           DFHEIV99,
  3092           DFHEIV99,
  3093           DFHEIV99
  3094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3095
  3096
  3097     GO TO 9000-RETURN-TRANS.
  3098
  3099 8120-FORMAT-TIME-DATE.
  3100     MOVE SAVE-DATE            TO DATEO.
  3101     MOVE EIBTIME              TO TIME-IN.
  3102     MOVE TIME-OUT             TO TIMEO.
  3103     MOVE LIT-MAP              TO PI-CURRENT-SCREEN-NO.
  3104     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  3105     MOVE EMI-MESSAGE-AREA (1) TO MSGO.
  3106
  3107 8130-EXIT.
  3108     EXIT.
  3109
  3110 8200-RETURN-PRIOR.
  3111     MOVE PI-RETURN-TO-PROGRAM TO CALL-PGM.
  3112     GO TO 9200-XCTL.
  3113
  3114 8300-GET-HELP.
  3115     MOVE XCTL-EL010 TO CALL-PGM.
  3116     GO TO 9200-XCTL.
  3117
  3118 8400-RETURN-MASTER.
  3119
  3120     IF  CREDIT-SESSION
  3121         MOVE XCTL-EL626         TO CALL-PGM
  3122
  3123     ELSE
  3124         IF  CLAIM-SESSION
  3125             MOVE XCTL-EL126     TO CALL-PGM
  3126
  3127         ELSE
  3128             IF  MORTGAGE-SESSION
  3129                 MOVE XCTL-EM626 TO CALL-PGM
  3130
  3131             ELSE
  3132                 IF  GENERAL-LEDGER-SESSION
  3133                     MOVE XCTL-GL800
  3134                                 TO CALL-PGM.
  3135
  3136     GO TO 9200-XCTL.
  3137
  3138 8700-ENDFILE.
  3139     IF BROWSE-STARTED
  3140         MOVE ' '  TO  BROWSE-STARTED-SW
  3141         PERFORM 3200-END-BROWSE  THRU  3299-EXIT.
  3142
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL108.cbl
  3143     IF EIBAID  = DFHPF7
  3144         MOVE ER-0067  TO  EMI-ERROR
  3145     ELSE
  3146         MOVE ER-0066  TO  EMI-ERROR.
  3147
  3148     PERFORM 9900-ERROR-FORMAT  THRU  9900-EXIT.
  3149
  3150     MOVE -1      TO  MAINTL.
  3151     MOVE SPACE   TO  MAINTO.
  3152
  3153     GO TO 8110-SEND-DATA.
  3154
  3155 8800-UNAUTHORIZED-ACCESS.
  3156     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  3157     GO TO 8990-SEND-TEXT.
  3158
  3159 8810-PF23-ENTERED.
  3160     MOVE EIBAID     TO PI-ENTRY-CD-1.
  3161     MOVE XCTL-EL005 TO CALL-PGM.
  3162     GO TO 9200-XCTL.
  3163
  3164 8820-XCTL-ERROR.
  3165
  3166* EXEC CICS HANDLE CONDITION
  3167*        PGMIDERR (8990-SEND-TEXT)
  3168*    END-EXEC.
  3169*    MOVE '"$L                   ! , #00002737' TO DFHEIV0
  3170     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3171     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3172     MOVE X'2C20233030303032373337' TO DFHEIV0(25:11)
  3173     CALL 'kxdfhei1' USING DFHEIV0
  3174     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3175
  3176
  3177     MOVE SPACE      TO PI-ENTRY-CD-1.
  3178     MOVE CALL-PGM   TO PI-CALLING-PROGRAM.
  3179     MOVE XCTL-EL005 TO CALL-PGM
  3180                        LOGOFF-PGM.
  3181     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  3182     GO TO 9200-XCTL.
  3183
  3184 8990-SEND-TEXT.
  3185
  3186* EXEC CICS SEND TEXT
  3187*        FROM   (LOGOFF-TEXT)
  3188*        LENGTH (LOGOFF-LENGTH)
  3189*        ERASE
  3190*        FREEKB
  3191*    END-EXEC.
  3192*    MOVE '8&      T  E F  H   F -   #00002749' TO DFHEIV0
  3193     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3194     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3195     MOVE X'2020233030303032373439' TO DFHEIV0(25:11)
  3196     CALL 'kxdfhei1' USING DFHEIV0,
  3197           LOGOFF-TEXT,
  3198           LOGOFF-LENGTH,
  3199           DFHEIV99,
  3200           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL108.cbl
  3201           DFHEIV99,
  3202           DFHEIV99,
  3203           DFHEIV99,
  3204           DFHEIV99,
  3205           DFHEIV99,
  3206           DFHEIV99,
  3207           DFHEIV99,
  3208           DFHEIV99
  3209     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3210
  3211
  3212     GO TO 9100-RETURN-CICS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL108.cbl
  3214 9000-RETURN-TRANS.
  3215
  3216* EXEC CICS RETURN
  3217*        TRANSID (TRANS-ID)
  3218*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3219*        LENGTH (PI-COMM-LENGTH)
  3220*    END-EXEC.
  3221*    MOVE '.(CT                  &   #00002759' TO DFHEIV0
  3222     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3223     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3224     MOVE X'2020233030303032373539' TO DFHEIV0(25:11)
  3225     CALL 'kxdfhei1' USING DFHEIV0,
  3226           TRANS-ID,
  3227           PROGRAM-INTERFACE-BLOCK,
  3228           PI-COMM-LENGTH,
  3229           DFHEIV99,
  3230           DFHEIV99
  3231     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3232
  3233
  3234
  3235* GOBACK.
  3236     MOVE '9%                    "   ' TO DFHEIV0
  3237     MOVE 'EL108' TO DFHEIV1
  3238     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3239     GOBACK.
  3240
  3241 9100-RETURN-CICS.
  3242
  3243* EXEC CICS RETURN
  3244*    END-EXEC.
  3245*    MOVE '.(                    &   #00002768' TO DFHEIV0
  3246     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3247     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3248     MOVE X'2020233030303032373638' TO DFHEIV0(25:11)
  3249     CALL 'kxdfhei1' USING DFHEIV0,
  3250           DFHEIV99,
  3251           DFHEIV99,
  3252           DFHEIV99,
  3253           DFHEIV99,
  3254           DFHEIV99
  3255     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3256
  3257
  3258* GOBACK.
  3259     MOVE '9%                    "   ' TO DFHEIV0
  3260     MOVE 'EL108' TO DFHEIV1
  3261     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3262     GOBACK.
  3263
  3264 9200-XCTL.
  3265
  3266* EXEC CICS XCTL
  3267*        PROGRAM (CALL-PGM)
  3268*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3269*        LENGTH (PI-COMM-LENGTH)
  3270*    END-EXEC.
  3271*    MOVE '.$C                   $   #00002773' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL108.cbl
  3272     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3273     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3274     MOVE X'2020233030303032373733' TO DFHEIV0(25:11)
  3275     CALL 'kxdfhei1' USING DFHEIV0,
  3276           CALL-PGM,
  3277           PROGRAM-INTERFACE-BLOCK,
  3278           PI-COMM-LENGTH
  3279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3280
  3281
  3282 9700-LINK-DATE-CONVERT.
  3283
  3284* EXEC CICS LINK
  3285*        PROGRAM    ('ELDATCV')
  3286*        COMMAREA   (DATE-CONVERSION-DATA)
  3287*        LENGTH     (DC-COMM-LENGTH)
  3288*        END-EXEC.
  3289     MOVE 'ELDATCV' TO DFHEIV1
  3290*    MOVE '."C                   ''   #00002780' TO DFHEIV0
  3291     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3292     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3293     MOVE X'2020233030303032373830' TO DFHEIV0(25:11)
  3294     CALL 'kxdfhei1' USING DFHEIV0,
  3295           DFHEIV1,
  3296           DATE-CONVERSION-DATA,
  3297           DC-COMM-LENGTH,
  3298           DFHEIV99,
  3299           DFHEIV99,
  3300           DFHEIV99
  3301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3302
  3303
  3304 9700-EXIT.
  3305     EXIT.
  3306
  3307 9900-ERROR-FORMAT.
  3308     IF NOT EMI-ERRORS-COMPLETE
  3309
  3310* EXEC CICS LINK
  3311*            PROGRAM ('EL001')
  3312*            COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  3313*            LENGTH (EMI-COMM-LENGTH)
  3314*        END-EXEC.
  3315     MOVE 'EL001' TO DFHEIV1
  3316*    MOVE '."C                   ''   #00002791' TO DFHEIV0
  3317     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3318     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3319     MOVE X'2020233030303032373931' TO DFHEIV0(25:11)
  3320     CALL 'kxdfhei1' USING DFHEIV0,
  3321           DFHEIV1,
  3322           ERROR-MESSAGE-INTERFACE-BLOCK,
  3323           EMI-COMM-LENGTH,
  3324           DFHEIV99,
  3325           DFHEIV99,
  3326           DFHEIV99
  3327     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3328
  3329
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL108.cbl
  3330 9900-EXIT.
  3331     EXIT.
  3332
  3333 9990-ABEND.
  3334     MOVE DFHEIBLK               TO EMI-LINE1
  3335     MOVE -1                     TO MAINTL.
  3336
  3337* EXEC CICS LINK
  3338*        PROGRAM   ('EL004')
  3339*        COMMAREA  (EMI-LINE1)
  3340*        LENGTH    (72)
  3341*        END-EXEC.
  3342     MOVE 'EL004' TO DFHEIV1
  3343     MOVE 72
  3344       TO DFHEIV11
  3345*    MOVE '."C                   ''   #00002803' TO DFHEIV0
  3346     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3347     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3348     MOVE X'2020233030303032383033' TO DFHEIV0(25:11)
  3349     CALL 'kxdfhei1' USING DFHEIV0,
  3350           DFHEIV1,
  3351           EMI-LINE1,
  3352           DFHEIV11,
  3353           DFHEIV99,
  3354           DFHEIV99,
  3355           DFHEIV99
  3356     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3357
  3358
  3359     GO TO 8110-SEND-DATA.
  3360
  3361 9995-SECURITY-VIOLATION.
  3362*                            COPY ELCSCTP.
  3363******************************************************************
  3364*                                                                *
  3365*                            ELCSCTP                             *
  3366*                            VMOD=2.001                          *
  3367*                                                                *
  3368*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3369******************************************************************
  3370
  3371
  3372     MOVE EIBDATE          TO SM-JUL-DATE.
  3373     MOVE EIBTRMID         TO SM-TERMID.
  3374     MOVE THIS-PGM         TO SM-PGM.
  3375     MOVE EIBTIME          TO TIME-IN.
  3376     MOVE TIME-OUT         TO SM-TIME.
  3377     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3378
  3379
  3380* EXEC CICS LINK
  3381*         PROGRAM  ('EL003')
  3382*         COMMAREA (SECURITY-MESSAGE)
  3383*         LENGTH   (80)
  3384*    END-EXEC.
  3385     MOVE 'EL003' TO DFHEIV1
  3386     MOVE 80
  3387       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL108.cbl
  3388*    MOVE '."C                   ''   #00002829' TO DFHEIV0
  3389     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3390     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3391     MOVE X'2020233030303032383239' TO DFHEIV0(25:11)
  3392     CALL 'kxdfhei1' USING DFHEIV0,
  3393           DFHEIV1,
  3394           SECURITY-MESSAGE,
  3395           DFHEIV11,
  3396           DFHEIV99,
  3397           DFHEIV99,
  3398           DFHEIV99
  3399     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3400
  3401
  3402******************************************************************
  3403
  3404
  3405 9995-EXIT.
  3406     EXIT.
  3407
  3408
  3409 9999-DFHBACK SECTION.
  3410     MOVE '9%                    "   ' TO DFHEIV0
  3411     MOVE 'EL108' TO DFHEIV1
  3412     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3413     GOBACK.
  3414 9999-DFHEXIT.
  3415     IF DFHEIGDJ EQUAL 0001
  3416         NEXT SENTENCE
  3417     ELSE IF DFHEIGDJ EQUAL 2
  3418         GO TO 8820-XCTL-ERROR,
  3419               9990-ABEND
  3420         DEPENDING ON DFHEIGDI
  3421     ELSE IF DFHEIGDJ EQUAL 3
  3422         GO TO 2010-PGMS-NOT-FOUND
  3423         DEPENDING ON DFHEIGDI
  3424     ELSE IF DFHEIGDJ EQUAL 4
  3425         GO TO 2350-FMT-NOT-FOUND
  3426         DEPENDING ON DFHEIGDI
  3427     ELSE IF DFHEIGDJ EQUAL 5
  3428         GO TO 2450-PROC-NOT-FOUND
  3429         DEPENDING ON DFHEIGDI
  3430     ELSE IF DFHEIGDJ EQUAL 6
  3431         GO TO 2550-TOT-NOT-FOUND
  3432         DEPENDING ON DFHEIGDI
  3433     ELSE IF DFHEIGDJ EQUAL 7
  3434         GO TO 8700-ENDFILE,
  3435               8700-ENDFILE
  3436         DEPENDING ON DFHEIGDI
  3437     ELSE IF DFHEIGDJ EQUAL 8
  3438         GO TO 4010-FORMAT-OPTIONS
  3439         DEPENDING ON DFHEIGDI
  3440     ELSE IF DFHEIGDJ EQUAL 9
  3441         GO TO 5210-TOTAL-NOTFND,
  3442               6030-END-OF-FILE
  3443         DEPENDING ON DFHEIGDI
  3444     ELSE IF DFHEIGDJ EQUAL 10
  3445         GO TO 5310-PROCESS-NOTFND,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL108.cbl
  3446               6030-END-OF-FILE
  3447         DEPENDING ON DFHEIGDI
  3448     ELSE IF DFHEIGDJ EQUAL 11
  3449         GO TO 5410-FORMAT-NOTFND,
  3450               6030-END-OF-FILE
  3451         DEPENDING ON DFHEIGDI
  3452     ELSE IF DFHEIGDJ EQUAL 12
  3453         GO TO 8990-SEND-TEXT
  3454         DEPENDING ON DFHEIGDI.
  3455     MOVE '9%                    "   ' TO DFHEIV0
  3456     MOVE 'EL108' TO DFHEIV1
  3457     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3458     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        6056     Code:       11244
