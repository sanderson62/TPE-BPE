* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page   1
* EL6521.cbl
* Options: int("EL6521.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6521.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6521.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6521.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6521.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 11/18/94 10:26:25.
     7*                            VMOD=2.004
     8*
     9*AUTHOR.     LOGIC,INC.
    10*            DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13*SECURITY.   *****************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page   2
* EL6521.cbl
    14*            *                                                   *
    15*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    16*            *                                                   *
    17*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    18*                                                                *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23*
    24*REMARKS.    TRANSACTION - EXD8 - COMPENSATION GA STATUS DATA.
    25*
    26******************************************************************
    27*                   C H A N G E   L O G
    28*
    29* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    30*-----------------------------------------------------------------
    31*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    32* EFFECTIVE    NUMBER
    33*-----------------------------------------------------------------
    34* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    35* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
    36* 092707    2004020600003  PEMA  ADD DELIVER TO MEL SWITCH
    37* 030211    2010012100001  PEMA  ADD RDS EMAILS TO LOGIC
    38* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    39* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    40* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    41******************************************************************
    42 ENVIRONMENT DIVISION.
    43
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page   3
* EL6521.cbl
    45 DATA DIVISION.
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*    EL6521 WORKING STORAGE    *'.
    50 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.004 *********'.
    51
    52 01  WS-DATE-AREA.
    53     05  WS-SAVE-DATE                PIC X(8) VALUE SPACES.
    54     05  WS-SAVE-BIN-DT              PIC XX   VALUE SPACES.
    55     05  WS-EFF-YMD                  PIC X(6).
    56     05  WS-SAVE-BIN-EFFDT           PIC XX   VALUE SPACES.
    57     05  WS-TRM-YMD                  PIC X(6).
    58     05  WS-SAVE-BIN-TRMDT           PIC XX   VALUE SPACES.
    59     05  WS-ACH-SW                   PIC X    VALUE 'N'.
    60         88  ACH-HAS-CHANGED             VALUE 'Y'.
    61         88  NO-ACH-CHANGE               VALUE 'N'.
    62     05  SUPPRESS-MAP-SW             PIC X    VALUE SPACE.
    63         88  DO-NOT-MOVE-TO-MAP          VALUE 'N'.
    64         88  MOVE-TO-MAP                 VALUE 'Y'.
    65     05  MAP-CHANGED-SW              PIC X    VALUE 'N'.
    66         88  MAP-NOT-CHANGED             VALUE 'N'.
    67         88  MAP-CHANGED                 VALUE 'Y'.
    68     05  BILL-INST-SW                PIC X.
    69         88  BILL-INST-CHANGED           VALUE 'Y'.
    70
    71 01  WS-RESPONSE                 PIC S9(8)   COMP.
    72     88  RESP-NORMAL                  VALUE +00.
    73     88  RESP-NOTFND                  VALUE +13.
    74     88  RESP-NOTOPEN                 VALUE +19.
    75     88  RESP-ENDFILE                 VALUE +20.
    76 01  STANDARD-AREAS.
    77     12  RETURNED-FROM               PIC X(8)    VALUE SPACES.
    78     12  WS-COMM-LENGTH              PIC S9(4) COMP VALUE +1024.
    79     12  WS-SUB                      PIC S9(4) COMP VALUE +0.
    80     12  MAP-NAME                    PIC X(8) VALUE 'EL6521A'.
    81     12  MAPSET-NAME                 PIC X(8) VALUE 'EL6521S'.
    82     12  SCREEN-NUMBER               PIC X(4) VALUE '652B'.
    83     12  TRANS-ID                    PIC X(4) VALUE 'EXD8'.
    84     12  EL611-TRANS-ID              PIC X(4) VALUE 'EXL3'.
    85     12  EL6525-TRANS-ID             PIC X(4) VALUE 'EXDF'.
    86     12  EL6526-TRANS-ID             PIC X(4) VALUE 'EXDG'.
    87     12  THIS-PGM                    PIC X(8) VALUE 'EL6521'.
    88     12  PGM-NAME                    PIC X(8).
    89     12  TIME-IN                     PIC S9(7).
    90     12  TIME-OUT-R  REDEFINES TIME-IN.
    91         16  FILLER                  PIC X.
    92         16  TIME-OUT                PIC 99V99.
    93         16  FILLER                  PIC XX.
    94     12  XCTL-005                    PIC X(8) VALUE 'EL005'.
    95     12  XCTL-010                    PIC X(8) VALUE 'EL010'.
    96     12  XCTL-626                    PIC X(8) VALUE 'EL626'.
    97     12  XCTL-611                    PIC X(8) VALUE 'EL611'.
    98     12  XCTL-6525                   PIC X(8) VALUE 'EL6525'.
    99     12  XCTL-6526                   PIC X(8) VALUE 'EL6526'.
   100     12  XCTL-652                    PIC X(8) VALUE 'EL652'.
   101     12  LINK-001                    PIC X(8) VALUE 'EL001'.
   102     12  LINK-004                    PIC X(8) VALUE 'EL004'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page   4
* EL6521.cbl
   103     12  QID.
   104         16  QID-TERM                PIC X(4) VALUE SPACES.
   105         16  FILLER                  PIC X(4) VALUE '521A'.
   106     12  MAP-LENGTH                  PIC S9(4) VALUE +600  COMP.
   107     12  ERCOBI-FILE-ID              PIC X(8) VALUE 'ERCOBI'.
   108     12  ERCOMP-FILE-ID              PIC X(8) VALUE 'ERCOMP'.
   109     12  ELACHP-FILE-ID              PIC X(8) VALUE 'ELACHP'.
   110     12  ELBANK-FILE-ID              PIC X(8) VALUE 'ELBANK'.
   111     12  WS-AGENT-BANK-DESC.
   112         16 FILLER                   PIC X(7) VALUE '  AGENT'.
   113         16 FILLER                   PIC X(1) VALUE X'7D'.
   114         16 FILLER                   PIC X(15)
   115                                      VALUE 'S BANK ACCOUNT:'.
   116
   117     12  DEEDIT-FIELD                PIC X(15).
   118     12  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD PIC S9(15).
   119
   120     12  ERCOBI-KEY.
   121         16  ERCOBI-COMPANY-CD      PIC X.
   122         16  ERCOBI-STMT-OWNER      PIC X(4).
   123         16  ERCOBI-RGID            PIC X(12).
   124     12  WS-BILL-INST-SW            PIC X  VALUE SPACES.
   125         88  BILLING-INSTRUCTIONS-FOUND  VALUE 'Y'.
   126     12  ERROR-MESSAGES.
   127         16  ER-0000                 PIC X(4) VALUE '0000'.
   128         16  ER-0004                 PIC X(4) VALUE '0004'.
   129         16  ER-0008                 PIC X(4) VALUE '0008'.
   130         16  ER-0029                 PIC X(4) VALUE '0029'.
   131         16  ER-0068                 PIC X(4) VALUE '0068'.
   132         16  ER-0070                 PIC X(4) VALUE '0070'.
   133         16  ER-0348                 PIC X(4) VALUE '0348'.
   134         16  ER-0454                 PIC X(4) VALUE '0454'.
   135         16  ER-0876                 PIC X(4) VALUE '0876'.
   136         16  ER-1228                 PIC X(4) VALUE '1228'.
   137         16  ER-1626                 PIC X(4) VALUE '1626'.
   138         16  ER-1629                 PIC X(4) VALUE '1629'.
   139         16  ER-2039                 PIC X(4) VALUE '2039'.
   140         16  ER-2233                 PIC X(4) VALUE '2233'.
   141         16  ER-2797                 PIC X(4) VALUE '2797'.
   142         16  ER-7430                 PIC X(4) VALUE '7430'.
   143         16  ER-7431                 PIC X(4) VALUE '7431'.
   144         16  ER-7432                 PIC X(4) VALUE '7432'.
   145         16  ER-7434                 PIC X(4) VALUE '7434'.
   146         16  ER-7435                 PIC X(4) VALUE '7435'.
   147         16  ER-7436                 PIC X(4) VALUE '7436'.
   148         16  ER-7438                 PIC X(4) VALUE '7438'.
   149         16  ER-7440                 PIC X(4) VALUE '7440'.
   150         16  ER-7447                 PIC X(4) VALUE '7447'.
   151         16  ER-7449                 PIC X(4) VALUE '7449'.
   152         16  ER-7462                 PIC X(4) VALUE '7462'.
   153         16  ER-7465                 PIC X(4) VALUE '7465'.
   154         16  ER-7468                 PIC X(4) VALUE '7468'.
   155         16  ER-7469                 PIC X(4) VALUE '7469'.
   156         16  ER-8799                 PIC X(4) VALUE '8799'.
   157         16  ER-9388                 PIC X(4) VALUE '9388'.
   158         16  ER-9399                 PIC X(4) VALUE '9399'.
   159         16  ER-9999                 PIC X(4) VALUE '9999'.
   160
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page   5
* EL6521.cbl
   161     12  ELCNTL-KEY.
   162         16  CNTL-COMP-ID            PIC X(3) VALUE SPACES.
   163         16  CNTL-REC-TYPE           PIC X    VALUE SPACES.
   164         16  CNTL-ACCESS             PIC X(4) VALUE SPACES.
   165         16  CNTL-SEQ-NO             PIC S9(4) VALUE +0  COMP.
   166
   167     12  WS-BANK-INFORMATION.
   168         16 WS-BANK-DATA.
   169             20 WS-TRANSIT1              PIC X(4).
   170             20 WS-TRANSIT2              PIC X(4).
   171             20 WS-BKACCTI               PIC X(17).
   172         16 WS-ACTCDI                    PIC X(1).
   173
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page   6
* EL6521.cbl
   175*    COPY ELCLOGOF.
   176******************************************************************
   177*                                                                *
   178*                                                                *
   179*                            ELCLOGOF.                           *
   180*                            VMOD=2.001                          *
   181*                                                                *
   182*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   183*                                                                *
   184******************************************************************
   185 01  CLASIC-LOGOFF.
   186     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   187     12  LOGOFF-TEXT.
   188         16  FILLER          PIC X(5)    VALUE SPACES.
   189         16  LOGOFF-MSG.
   190             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   191             20  FILLER      PIC X       VALUE SPACES.
   192             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   193         16  FILLER          PIC X(80)
   194           VALUE '* YOU ARE NOW LOGGED OFF'.
   195         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   196         16  FILLER          PIC X       VALUE QUOTE.
   197         16  LOGOFF-SYS-MSG  PIC X(17)
   198           VALUE 'S CLAS-IC SYSTEM '.
   199     12  TEXT-MESSAGES.
   200         16  UNACCESS-MSG    PIC X(29)
   201             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   202         16  PGMIDERR-MSG    PIC X(17)
   203             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page   7
* EL6521.cbl
   205*    COPY ELCDATE.
   206******************************************************************
   207*                                                                *
   208*                                                                *
   209*                            ELCDATE.                            *
   210*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   211*                            VMOD=2.003
   212*                                                                *
   213*                                                                *
   214*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   215*                 LENGTH = 200                                   *
   216******************************************************************
   217
   218 01  DATE-CONVERSION-DATA.
   219     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   220     12  DC-OPTION-CODE                PIC X.
   221         88  BIN-TO-GREG                VALUE ' '.
   222         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   223         88  EDIT-GREG-TO-BIN           VALUE '2'.
   224         88  YMD-GREG-TO-BIN            VALUE '3'.
   225         88  MDY-GREG-TO-BIN            VALUE '4'.
   226         88  JULIAN-TO-BIN              VALUE '5'.
   227         88  BIN-PLUS-ELAPSED           VALUE '6'.
   228         88  FIND-CENTURY               VALUE '7'.
   229         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   230         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   231         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   232         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   233         88  JULIAN-TO-BIN-3            VALUE 'C'.
   234         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   235         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   236         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   237         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   238         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   239         88  CHECK-LEAP-YEAR            VALUE 'H'.
   240         88  BIN-3-TO-GREG              VALUE 'I'.
   241         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   242         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   243         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   244         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   245         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   246         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   247         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   248         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   249         88  THREE-CHARACTER-BIN
   250                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   251         88  GREGORIAN-TO-BIN
   252                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   253         88  BIN-TO-GREGORIAN
   254                  VALUES ' ' '1' 'I' '8' 'G'.
   255         88  JULIAN-TO-BINARY
   256                  VALUES '5' 'C' 'E' 'F'.
   257     12  DC-ERROR-CODE                 PIC X.
   258         88  NO-CONVERSION-ERROR        VALUE ' '.
   259         88  DATE-CONVERSION-ERROR
   260                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   261         88  DATE-IS-ZERO               VALUE '1'.
   262         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page   8
* EL6521.cbl
   263         88  DATE-IS-INVALID            VALUE '3'.
   264         88  DATE1-GREATER-DATE2        VALUE '4'.
   265         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   266         88  DATE-INVALID-OPTION        VALUE '9'.
   267         88  INVALID-CENTURY            VALUE 'A'.
   268         88  ONLY-CENTURY               VALUE 'B'.
   269         88  ONLY-LEAP-YEAR             VALUE 'C'.
   270         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   271     12  DC-END-OF-MONTH               PIC X.
   272         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   273     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   274         88  USE-NORMAL-PROCESS         VALUE ' '.
   275         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   276         88  ADJUST-UP-100-YRS          VALUE '2'.
   277     12  FILLER                        PIC X.
   278     12  DC-CONVERSION-DATES.
   279         16  DC-BIN-DATE-1             PIC XX.
   280         16  DC-BIN-DATE-2             PIC XX.
   281         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   282         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   283                       DC-GREG-DATE-1-EDIT.
   284             20  DC-EDIT1-MONTH        PIC 99.
   285             20  SLASH1-1              PIC X.
   286             20  DC-EDIT1-DAY          PIC 99.
   287             20  SLASH1-2              PIC X.
   288             20  DC-EDIT1-YEAR         PIC 99.
   289         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   290         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   291                     DC-GREG-DATE-2-EDIT.
   292             20  DC-EDIT2-MONTH        PIC 99.
   293             20  SLASH2-1              PIC X.
   294             20  DC-EDIT2-DAY          PIC 99.
   295             20  SLASH2-2              PIC X.
   296             20  DC-EDIT2-YEAR         PIC 99.
   297         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   298         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   299                     DC-GREG-DATE-1-YMD.
   300             20  DC-YMD-YEAR           PIC 99.
   301             20  DC-YMD-MONTH          PIC 99.
   302             20  DC-YMD-DAY            PIC 99.
   303         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   304         16  DC-GREG-DATE-1-MDY-R REDEFINES
   305                      DC-GREG-DATE-1-MDY.
   306             20  DC-MDY-MONTH          PIC 99.
   307             20  DC-MDY-DAY            PIC 99.
   308             20  DC-MDY-YEAR           PIC 99.
   309         16  DC-GREG-DATE-1-ALPHA.
   310             20  DC-ALPHA-MONTH        PIC X(10).
   311             20  DC-ALPHA-DAY          PIC 99.
   312             20  FILLER                PIC XX.
   313             20  DC-ALPHA-CENTURY.
   314                 24 DC-ALPHA-CEN-N     PIC 99.
   315             20  DC-ALPHA-YEAR         PIC 99.
   316         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   317         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   318         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   319         16  DC-JULIAN-DATE            PIC 9(05).
   320         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page   9
* EL6521.cbl
   321                                       PIC 9(05).
   322         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   323             20  DC-JULIAN-YEAR        PIC 99.
   324             20  DC-JULIAN-DAYS        PIC 999.
   325         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   326         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   327         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   328     12  DATE-CONVERSION-VARIBLES.
   329         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   330         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   331             20  FILLER                PIC 9(3).
   332             20  HOLD-CEN-1-CCYY.
   333                 24  HOLD-CEN-1-CC     PIC 99.
   334                 24  HOLD-CEN-1-YY     PIC 99.
   335             20  HOLD-CEN-1-MO         PIC 99.
   336             20  HOLD-CEN-1-DA         PIC 99.
   337         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   338             20  HOLD-CEN-1-R-MO       PIC 99.
   339             20  HOLD-CEN-1-R-DA       PIC 99.
   340             20  HOLD-CEN-1-R-CCYY.
   341                 24  HOLD-CEN-1-R-CC   PIC 99.
   342                 24  HOLD-CEN-1-R-YY   PIC 99.
   343             20  FILLER                PIC 9(3).
   344         16  HOLD-CENTURY-1-X.
   345             20  FILLER                PIC X(3)  VALUE SPACES.
   346             20  HOLD-CEN-1-X-CCYY.
   347                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   348                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   349             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   350             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   351         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   352             20  HOLD-CEN-1-R-X-MO     PIC XX.
   353             20  HOLD-CEN-1-R-X-DA     PIC XX.
   354             20  HOLD-CEN-1-R-X-CCYY.
   355                 24  HOLD-CEN-1-R-X-CC PIC XX.
   356                 24  HOLD-CEN-1-R-X-YY PIC XX.
   357             20  FILLER                PIC XXX.
   358         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   359         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   360         16  DC-JULIAN-DATE-1          PIC 9(07).
   361         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   362             20  DC-JULIAN-1-CCYY.
   363                 24  DC-JULIAN-1-CC    PIC 99.
   364                 24  DC-JULIAN-1-YR    PIC 99.
   365             20  DC-JULIAN-DA-1        PIC 999.
   366         16  DC-JULIAN-DATE-2          PIC 9(07).
   367         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   368             20  DC-JULIAN-2-CCYY.
   369                 24  DC-JULIAN-2-CC    PIC 99.
   370                 24  DC-JULIAN-2-YR    PIC 99.
   371             20  DC-JULIAN-DA-2        PIC 999.
   372         16  DC-GREG-DATE-A-EDIT.
   373             20  DC-EDITA-MONTH        PIC 99.
   374             20  SLASHA-1              PIC X VALUE '/'.
   375             20  DC-EDITA-DAY          PIC 99.
   376             20  SLASHA-2              PIC X VALUE '/'.
   377             20  DC-EDITA-CCYY.
   378                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  10
* EL6521.cbl
   379                 24  DC-EDITA-YEAR     PIC 99.
   380         16  DC-GREG-DATE-B-EDIT.
   381             20  DC-EDITB-MONTH        PIC 99.
   382             20  SLASHB-1              PIC X VALUE '/'.
   383             20  DC-EDITB-DAY          PIC 99.
   384             20  SLASHB-2              PIC X VALUE '/'.
   385             20  DC-EDITB-CCYY.
   386                 24  DC-EDITB-CENT     PIC 99.
   387                 24  DC-EDITB-YEAR     PIC 99.
   388         16  DC-GREG-DATE-CYMD         PIC 9(08).
   389         16  DC-GREG-DATE-CYMD-R REDEFINES
   390                              DC-GREG-DATE-CYMD.
   391             20  DC-CYMD-CEN           PIC 99.
   392             20  DC-CYMD-YEAR          PIC 99.
   393             20  DC-CYMD-MONTH         PIC 99.
   394             20  DC-CYMD-DAY           PIC 99.
   395         16  DC-GREG-DATE-MDCY         PIC 9(08).
   396         16  DC-GREG-DATE-MDCY-R REDEFINES
   397                              DC-GREG-DATE-MDCY.
   398             20  DC-MDCY-MONTH         PIC 99.
   399             20  DC-MDCY-DAY           PIC 99.
   400             20  DC-MDCY-CEN           PIC 99.
   401             20  DC-MDCY-YEAR          PIC 99.
   402    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   403        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   404    12  DC-EL310-DATE                  PIC X(21).
   405    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  11
* EL6521.cbl
   407*    COPY ELCATTR.
   408******************************************************************
   409*                                                                *
   410*                            ELCATTR.                            *
   411*                            VMOD=2.001                          *
   412*                                                                *
   413*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   414*                                                                *
   415*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   416*                                                                *
   417*                   POS 1   P=PROTECTED                          *
   418*                           U=UNPROTECTED                        *
   419*                           S=ASKIP                              *
   420*                   POS 2   A=ALPHA/NUMERIC                      *
   421*                           N=NUMERIC                            *
   422*                   POS 3   N=NORMAL                             *
   423*                           B=BRIGHT                             *
   424*                           D=DARK                               *
   425*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   426*                           OF=MODIFIED DATA TAG OFF             *
   427*                                                                *
   428*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   429******************************************************************
   430 01  ATTRIBUTE-LIST.
   431     12  AL-PABOF            PIC X       VALUE 'Y'.
   432     12  AL-PABON            PIC X       VALUE 'Z'.
   433     12  AL-PADOF            PIC X       VALUE '%'.
   434     12  AL-PADON            PIC X       VALUE '_'.
   435     12  AL-PANOF            PIC X       VALUE '-'.
   436     12  AL-PANON            PIC X       VALUE '/'.
   437     12  AL-SABOF            PIC X       VALUE '8'.
   438     12  AL-SABON            PIC X       VALUE '9'.
   439     12  AL-SADOF            PIC X       VALUE '@'.
   440     12  AL-SADON            PIC X       VALUE QUOTE.
   441     12  AL-SANOF            PIC X       VALUE '0'.
   442     12  AL-SANON            PIC X       VALUE '1'.
   443     12  AL-UABOF            PIC X       VALUE 'H'.
   444     12  AL-UABON            PIC X       VALUE 'I'.
   445     12  AL-UADOF            PIC X       VALUE '<'.
   446     12  AL-UADON            PIC X       VALUE '('.
   447     12  AL-UANOF            PIC X       VALUE ' '.
   448     12  AL-UANON            PIC X       VALUE 'A'.
   449     12  AL-UNBOF            PIC X       VALUE 'Q'.
   450     12  AL-UNBON            PIC X       VALUE 'R'.
   451     12  AL-UNDOF            PIC X       VALUE '*'.
   452     12  AL-UNDON            PIC X       VALUE ')'.
   453     12  AL-UNNOF            PIC X       VALUE '&'.
   454     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  12
* EL6521.cbl
   456*    COPY ELCEMIB.
   457******************************************************************
   458*                                                                *
   459*                                                                *
   460*                            ELCEMIB.                            *
   461*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   462*                            VMOD=2.005                          *
   463*                                                                *
   464*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   465*                                                                *
   466******************************************************************
   467 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   468     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   469     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   470     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   471     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   472     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   473     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   474     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   475     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   476     12  EMI-SWITCH1             PIC X        VALUE '1'.
   477         88  EMI-NO-ERRORS                    VALUE '1'.
   478         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   479         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   480     12  EMI-SWITCH2             PIC X        VALUE '1'.
   481         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   482     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   483         88  EMI-AREA1-EMPTY                  VALUE '1'.
   484         88  EMI-AREA1-FULL                   VALUE '2'.
   485     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   486         88  EMI-AREA2-EMPTY                  VALUE '1'.
   487         88  EMI-AREA2-FULL                   VALUE '2'.
   488     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   489         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   490         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   491         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   492         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   493         88  EMI-BYPASS-FATALS                VALUE 'X'.
   494     12  EMI-ERROR-LINES.
   495         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   496         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   497         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   498         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   499             20  EMI-ERR-CODES OCCURS 10 TIMES.
   500                 24  EMI-ERR-NUM         PIC X(4).
   501                 24  EMI-FILLER          PIC X.
   502                 24  EMI-SEV             PIC X.
   503                 24  FILLER              PIC X.
   504             20  FILLER                  PIC X(02).
   505     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   506         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   507             20  EMI-ERROR-NUMBER    PIC X(4).
   508             20  EMI-FILL            PIC X.
   509             20  EMI-SEVERITY        PIC X.
   510             20  FILLER              PIC X.
   511             20  EMI-ERROR-TEXT.
   512                 24  EMI-TEXT-VARIABLE   PIC X(10).
   513                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  13
* EL6521.cbl
   514     12  EMI-SEVERITY-SAVE           PIC X.
   515         88  EMI-NOTE                    VALUE 'N'.
   516         88  EMI-WARNING                 VALUE 'W'.
   517         88  EMI-FORCABLE                VALUE 'F'.
   518         88  EMI-FATAL                   VALUE 'X'.
   519     12  EMI-MESSAGE-FLAG            PIC X.
   520         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   521         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   522     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   523     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   524         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   525         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   526         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   527     12  emi-claim-no                pic x(7).
   528     12  emi-claim-type              pic x(6).
   529     12  FILLER                      PIC X(124)  VALUE SPACES.
   530     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   531     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   532     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   533     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  14
* EL6521.cbl
   535*    COPY ELCSCTM.
   536******************************************************************
   537*                                                                *
   538*                                                                *
   539*                            ELCSCTM                             *
   540*                            VMOD=2.001                          *
   541*                                                                *
   542*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   543*                                                                *
   544******************************************************************
   545 01  SECURITY-MESSAGE.
   546     12  FILLER                          PIC X(30)
   547            VALUE '** LOGIC SECURITY VIOLATION -'.
   548     12  SM-READ                         PIC X(6).
   549     12  FILLER                          PIC X(5)
   550            VALUE ' PGM='.
   551     12  SM-PGM                          PIC X(6).
   552     12  FILLER                          PIC X(5)
   553            VALUE ' OPR='.
   554     12  SM-PROCESSOR-ID                 PIC X(4).
   555     12  FILLER                          PIC X(6)
   556            VALUE ' TERM='.
   557     12  SM-TERMID                       PIC X(4).
   558     12  FILLER                          PIC XX   VALUE SPACE.
   559     12  SM-JUL-DATE                     PIC 9(5).
   560     12  FILLER                          PIC X    VALUE SPACE.
   561     12  SM-TIME                         PIC 99.99.
   562
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  15
* EL6521.cbl
   564*    COPY ELCSCRTY.
   565******************************************************************
   566*                                                                *
   567*                                                                *
   568*                            ELCSCRTY                            *
   569*                            VMOD=2.001                          *
   570*                                                                *
   571*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   572*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   573*        SAVED IN PI-SECURITY-ADDRESS.                           *
   574*                                                                *
   575******************************************************************
   576 01  SECURITY-CONTROL.
   577     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   578     12  FILLER                       PIC XX    VALUE 'SC'.
   579     12  SC-CREDIT-CODES.
   580         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   581             20  SC-CREDIT-DISPLAY    PIC X.
   582             20  SC-CREDIT-UPDATE     PIC X.
   583     12  SC-CLAIMS-CODES.
   584         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   585             20  SC-CLAIMS-DISPLAY    PIC X.
   586             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  16
* EL6521.cbl
   588*    COPY ELCINTF.
   589******************************************************************
   590*                                                                *
   591*                                                                *
   592*                            ELCINTF.                            *
   593*                            VMOD=2.017                          *
   594*                                                                *
   595*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   596*                                                                *
   597*       LENGTH = 1024                                            *
   598*                                                                *
   599******************************************************************
   600*                   C H A N G E   L O G
   601*
   602* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   603*-----------------------------------------------------------------
   604*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   605* EFFECTIVE    NUMBER
   606*-----------------------------------------------------------------
   607* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   608******************************************************************
   609 01  PROGRAM-INTERFACE-BLOCK.
   610     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   611     12  PI-CALLING-PROGRAM              PIC X(8).
   612     12  PI-SAVED-PROGRAM-1              PIC X(8).
   613     12  PI-SAVED-PROGRAM-2              PIC X(8).
   614     12  PI-SAVED-PROGRAM-3              PIC X(8).
   615     12  PI-SAVED-PROGRAM-4              PIC X(8).
   616     12  PI-SAVED-PROGRAM-5              PIC X(8).
   617     12  PI-SAVED-PROGRAM-6              PIC X(8).
   618     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   619     12  PI-COMPANY-ID                   PIC XXX.
   620     12  PI-COMPANY-CD                   PIC X.
   621
   622     12  PI-COMPANY-PASSWORD             PIC X(8).
   623
   624     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   625
   626     12  PI-CONTROL-IN-PROGRESS.
   627         16  PI-CARRIER                  PIC X.
   628         16  PI-GROUPING                 PIC X(6).
   629         16  PI-STATE                    PIC XX.
   630         16  PI-ACCOUNT                  PIC X(10).
   631         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   632                                         PIC X(10).
   633         16  PI-CLAIM-CERT-GRP.
   634             20  PI-CLAIM-NO             PIC X(7).
   635             20  PI-CERT-NO.
   636                 25  PI-CERT-PRIME       PIC X(10).
   637                 25  PI-CERT-SFX         PIC X.
   638             20  PI-CERT-EFF-DT          PIC XX.
   639         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   640             20  PI-PLAN-CODE            PIC X(2).
   641             20  PI-REVISION-NUMBER      PIC X(3).
   642             20  PI-PLAN-EFF-DT          PIC X(2).
   643             20  PI-PLAN-EXP-DT          PIC X(2).
   644             20  FILLER                  PIC X(11).
   645         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  17
* EL6521.cbl
   646             20  PI-OE-REFERENCE-1.
   647                 25  PI-OE-REF-1-PRIME   PIC X(18).
   648                 25  PI-OE-REF-1-SUFF    PIC XX.
   649
   650     12  PI-SESSION-IN-PROGRESS          PIC X.
   651         88  CLAIM-SESSION                   VALUE '1'.
   652         88  CREDIT-SESSION                  VALUE '2'.
   653         88  WARRANTY-SESSION                VALUE '3'.
   654         88  MORTGAGE-SESSION                VALUE '4'.
   655         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   656
   657
   658*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   659
   660     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   661     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   662
   663     12  PI-CREDIT-USER                  PIC X.
   664         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   665         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   666
   667     12  PI-CLAIM-USER                   PIC X.
   668         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   669         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   670
   671     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   672         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   673         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   674         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   675         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   676         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   677
   678     12  PI-PROCESSOR-ID                 PIC X(4).
   679
   680     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   681
   682     12  PI-MEMBER-CAPTION               PIC X(10).
   683
   684     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   685         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   686
   687     12  PI-LIFE-OVERRIDE-L1             PIC X.
   688     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   689     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   690     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   691
   692     12  PI-AH-OVERRIDE-L1               PIC X.
   693     12  PI-AH-OVERRIDE-L2               PIC XX.
   694     12  PI-AH-OVERRIDE-L6               PIC X(6).
   695     12  PI-AH-OVERRIDE-L12              PIC X(12).
   696
   697     12  PI-NEW-SYSTEM                   PIC X(2).
   698
   699     12  PI-PRIMARY-CERT-NO              PIC X(11).
   700     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   701         88  PI-USES-PAID-TO                 VALUE '1'.
   702     12  PI-CRDTCRD-SYSTEM.
   703         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  18
* EL6521.cbl
   704             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   705             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   706         16  PI-CC-MONTH-END-DT          PIC XX.
   707     12  PI-PROCESSOR-PRINTER            PIC X(4).
   708
   709     12  PI-OE-REFERENCE-2.
   710         16  PI-OE-REF-2-PRIME           PIC X(10).
   711         16  PI-OE-REF-2-SUFF            PIC X.
   712
   713     12  PI-REM-TRM-CALC-OPTION          PIC X.
   714
   715     12  PI-LANGUAGE-TYPE                PIC X.
   716             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   717             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   718             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   719
   720     12  PI-POLICY-LINKAGE-IND           PIC X.
   721         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   722         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   723                                                   LOW-VALUES.
   724
   725     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   726     12  PI-CLAIM-PW-SESSION             PIC X(1).
   727         88  PI-CLAIM-CREDIT                 VALUE '1'.
   728         88  PI-CLAIM-CONVEN                 VALUE '2'.
   729
   730     12  PI-PROCESSOR-CSR-IND            PIC X.
   731         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   732         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   733
   734     12  FILLER                          PIC X(3).
   735
   736     12  PI-SYSTEM-LEVEL                 PIC X(145).
   737
   738     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   739         PI-SYSTEM-LEVEL.
   740
   741         16  PI-ENTRY-CODES.
   742             20  PI-ENTRY-CD-1           PIC X.
   743             20  PI-ENTRY-CD-2           PIC X.
   744
   745         16  PI-RETURN-CODES.
   746             20  PI-RETURN-CD-1          PIC X.
   747             20  PI-RETURN-CD-2          PIC X.
   748
   749         16  PI-UPDATE-STATUS-SAVE.
   750             20  PI-UPDATE-BY            PIC X(4).
   751             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   752
   753         16  PI-LOWER-CASE-LETTERS       PIC X.
   754             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   755
   756*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   757*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   758*            88  CARRIER-CLM-CNTL            VALUE '2'.
   759
   760         16  PI-CERT-ACCESS-CONTROL      PIC X.
   761             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  19
* EL6521.cbl
   762             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   763             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   764             88  ACCNT-CNTL                  VALUE '3'.
   765             88  CARR-ACCNT-CNTL             VALUE '4'.
   766
   767         16  PI-PROCESSOR-CAP-LIST.
   768             20  PI-SYSTEM-CONTROLS.
   769                24 PI-SYSTEM-DISPLAY     PIC X.
   770                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   771                24 PI-SYSTEM-MODIFY      PIC X.
   772                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   773             20  FILLER                  PIC XX.
   774             20  PI-DISPLAY-CAP          PIC X.
   775                 88  DISPLAY-CAP             VALUE 'Y'.
   776             20  PI-MODIFY-CAP           PIC X.
   777                 88  MODIFY-CAP              VALUE 'Y'.
   778             20  PI-MSG-AT-LOGON-CAP     PIC X.
   779                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   780             20  PI-FORCE-CAP            PIC X.
   781                 88  FORCE-CAP               VALUE 'Y'.
   782
   783         16  PI-PROGRAM-CONTROLS.
   784             20  PI-PGM-PRINT-OPT        PIC X.
   785             20  PI-PGM-FORMAT-OPT       PIC X.
   786             20  PI-PGM-PROCESS-OPT      PIC X.
   787             20  PI-PGM-TOTALS-OPT       PIC X.
   788
   789         16  PI-HELP-INTERFACE.
   790             20  PI-LAST-ERROR-NO        PIC X(4).
   791             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   792
   793         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   794             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   795
   796         16  PI-CR-CONTROL-IN-PROGRESS.
   797             20  PI-CR-CARRIER           PIC X.
   798             20  PI-CR-GROUPING          PIC X(6).
   799             20  PI-CR-STATE             PIC XX.
   800             20  PI-CR-ACCOUNT           PIC X(10).
   801             20  PI-CR-FIN-RESP          PIC X(10).
   802             20  PI-CR-TYPE              PIC X.
   803
   804         16  PI-CR-BATCH-NUMBER          PIC X(6).
   805
   806         16  PI-CR-MONTH-END-DT          PIC XX.
   807
   808         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   809             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   810             88  PI-ZERO-CARRIER             VALUE '1'.
   811             88  PI-ZERO-GROUPING            VALUE '2'.
   812             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   813
   814         16  PI-CARRIER-SECURITY         PIC X.
   815             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   816
   817         16  PI-ACCOUNT-SECURITY         PIC X(10).
   818             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   819             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  20
* EL6521.cbl
   820
   821         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   822             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   823                                         INDEXED BY PI-ACCESS-NDX
   824                                         PIC X.
   825
   826         16  PI-GA-BILLING-CONTROL       PIC X.
   827             88  PI-GA-BILLING               VALUE '1'.
   828
   829         16  PI-MAIL-PROCESSING          PIC X.
   830             88  PI-MAIL-YES                 VALUE 'Y'.
   831
   832         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   833
   834         16  PI-AR-SYSTEM.
   835             20  PI-AR-PROCESSING-CNTL   PIC X.
   836                 88  PI-AR-PROCESSING        VALUE 'Y'.
   837             20  PI-AR-SUMMARY-CODE      PIC X(6).
   838             20  PI-AR-MONTH-END-DT      PIC XX.
   839
   840         16  PI-MP-SYSTEM.
   841             20  PI-MORTGAGE-USER            PIC X.
   842                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   843                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   844             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   845                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   846                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   847                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   848                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   849                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   850             20  PI-MP-MONTH-END-DT          PIC XX.
   851             20  PI-MP-REFERENCE-NO.
   852                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   853                 24  PI-MP-REFERENCE-SFX     PIC XX.
   854
   855         16  PI-LABEL-CONTROL            PIC X(01).
   856             88  PI-CREATE-LABELS                    VALUE 'Y'.
   857             88  PI-BYPASS-LABELS                    VALUE 'N'.
   858
   859         16  PI-BILL-GROUPING-CODE       PIC X(01).
   860             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   861
   862         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   863             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   864             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   865
   866         16  FILLER                      PIC X(14).
   867
   868     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   869******************************************************************
   870     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
   871         16  PI-MAINT                PIC  X.
   872         16  PI-CHECK-TYPE           PIC  X.
   873         16  PI-CHECK-CARRY-BAL      PIC  X.
   874         16  PI-FIRST-TIME-SW        PIC  X.
   875             88  FIRST-TIME                  VALUE 'Y'.
   876         16  PI-ERCOMP-EOF-SW        PIC  X.
   877             88  ERCOMP-EOF                  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  21
* EL6521.cbl
   878         16  PI-SAVE-PHONE           PIC  X(10).
   879         16  PI-SAVE-PHONE-RED REDEFINES PI-SAVE-PHONE  PIC 9(10).
   880         16  PI-ERC-END-BAL          PIC S9(9)V99       COMP-3.
   881         16  PI-ERCOMP-KEY.
   882             20  PI-ERC-GROUP-CD     PIC  X.
   883             20  PI-ERC-CARRIER      PIC  X.
   884             20  PI-ERC-GROUP        PIC  X(6).
   885             20  PI-ERC-RESP         PIC  X(10).
   886             20  PI-ERC-ACCT         PIC  X(10).
   887             20  PI-ERC-TYPE         PIC  X.
   888         16  PI-SAVE-ERCOMP-KEY      PIC  X(29).
   889         16  PI-BANK-TRANSIT-NUMBER.
   890             20  PI-BANK-COMPANY-CD  PIC X.
   891             20  PI-FEDERAL-NUMBER   PIC X(4).
   892             20  PI-BANK-NUMBER      PIC X(4).
   893         16  PI-BANK-ACCOUNT-NO      PIC X(17).
   894         16  PI-BANK-ACTION-CODE     PIC X.
   895         16  PI-ERCOBI-KEY.
   896             20  PI-ERCOBI-COMPANY-CD PIC X.
   897             20  PI-ERCOBI-STMT-OWNER PIC X(4).
   898             20  PI-ERCOBI-RGID      PIC X(12).
   899         16  PI-SAVE-ERCOBI-KEY      PIC X(17).
   900         16  FILLER                  PIC  X(500).
   901
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  22
* EL6521.cbl
   903*    COPY ELCAID.
   904******************************************************************
   905*                                                                *
   906*                            ELCAID.                             *
   907*                            VMOD=2.001                          *
   908*                                                                *
   909*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   910*                                                                *
   911*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   912*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   913******************************************************************
   914
   915 01  DFHAID.
   916   02  DFHNULL   PIC  X  VALUE  ' '.
   917   02  DFHENTER  PIC  X  VALUE  QUOTE.
   918   02  DFHCLEAR  PIC  X  VALUE  '_'.
   919   02  DFHPEN    PIC  X  VALUE  '='.
   920   02  DFHOPID   PIC  X  VALUE  'W'.
   921   02  DFHPA1    PIC  X  VALUE  '%'.
   922   02  DFHPA2    PIC  X  VALUE  '>'.
   923   02  DFHPA3    PIC  X  VALUE  ','.
   924   02  DFHPF1    PIC  X  VALUE  '1'.
   925   02  DFHPF2    PIC  X  VALUE  '2'.
   926   02  DFHPF3    PIC  X  VALUE  '3'.
   927   02  DFHPF4    PIC  X  VALUE  '4'.
   928   02  DFHPF5    PIC  X  VALUE  '5'.
   929   02  DFHPF6    PIC  X  VALUE  '6'.
   930   02  DFHPF7    PIC  X  VALUE  '7'.
   931   02  DFHPF8    PIC  X  VALUE  '8'.
   932   02  DFHPF9    PIC  X  VALUE  '9'.
   933   02  DFHPF10   PIC  X  VALUE  ':'.
   934   02  DFHPF11   PIC  X  VALUE  '#'.
   935   02  DFHPF12   PIC  X  VALUE  '@'.
   936   02  DFHPF13   PIC  X  VALUE  'A'.
   937   02  DFHPF14   PIC  X  VALUE  'B'.
   938   02  DFHPF15   PIC  X  VALUE  'C'.
   939   02  DFHPF16   PIC  X  VALUE  'D'.
   940   02  DFHPF17   PIC  X  VALUE  'E'.
   941   02  DFHPF18   PIC  X  VALUE  'F'.
   942   02  DFHPF19   PIC  X  VALUE  'G'.
   943   02  DFHPF20   PIC  X  VALUE  'H'.
   944   02  DFHPF21   PIC  X  VALUE  'I'.
   945*00039    02  DFHPF22   PIC  X  VALUE  ''.
   946   02  DFHPF22   PIC  X  VALUE  '['.
   947   02  DFHPF23   PIC  X  VALUE  '.'.
   948   02  DFHPF24   PIC  X  VALUE  '<'.
   949   02  DFHMSRE   PIC  X  VALUE  'X'.
   950   02  DFHSTRF   PIC  X  VALUE  'h'.
   951   02  DFHTRIG   PIC  X  VALUE  '"'.
   952 01  FILLER    REDEFINES DFHAID.
   953     12  FILLER                      PIC X(8).
   954     12  PF-VALUES                   PIC X       OCCURS 2.
   955
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  23
* EL6521.cbl
   957*    COPY EL6521S.
   958 01  EL6521AI.
   959     05  FILLER            PIC  X(0012).
   960*    -------------------------------
   961     05  DATEL PIC S9(0004) COMP.
   962     05  DATEF PIC  X(0001).
   963     05  FILLER REDEFINES DATEF.
   964         10  DATEA PIC  X(0001).
   965     05  DATEI PIC  X(0008).
   966*    -------------------------------
   967     05  TIMEL PIC S9(0004) COMP.
   968     05  TIMEF PIC  X(0001).
   969     05  FILLER REDEFINES TIMEF.
   970         10  TIMEA PIC  X(0001).
   971     05  TIMEI PIC  X(0005).
   972*    -------------------------------
   973     05  CMPNYIDL PIC S9(0004) COMP.
   974     05  CMPNYIDF PIC  X(0001).
   975     05  FILLER REDEFINES CMPNYIDF.
   976         10  CMPNYIDA PIC  X(0001).
   977     05  CMPNYIDI PIC  X(0003).
   978*    -------------------------------
   979     05  USERIDL PIC S9(0004) COMP.
   980     05  USERIDF PIC  X(0001).
   981     05  FILLER REDEFINES USERIDF.
   982         10  USERIDA PIC  X(0001).
   983     05  USERIDI PIC  X(0004).
   984*    -------------------------------
   985     05  MAINTYPL PIC S9(0004) COMP.
   986     05  MAINTYPF PIC  X(0001).
   987     05  FILLER REDEFINES MAINTYPF.
   988         10  MAINTYPA PIC  X(0001).
   989     05  MAINTYPI PIC  X(0001).
   990*    -------------------------------
   991     05  CARRIERL PIC S9(0004) COMP.
   992     05  CARRIERF PIC  X(0001).
   993     05  FILLER REDEFINES CARRIERF.
   994         10  CARRIERA PIC  X(0001).
   995     05  CARRIERI PIC  X(0001).
   996*    -------------------------------
   997     05  GROUPL PIC S9(0004) COMP.
   998     05  GROUPF PIC  X(0001).
   999     05  FILLER REDEFINES GROUPF.
  1000         10  GROUPA PIC  X(0001).
  1001     05  GROUPI PIC  X(0006).
  1002*    -------------------------------
  1003     05  TYPEL PIC S9(0004) COMP.
  1004     05  TYPEF PIC  X(0001).
  1005     05  FILLER REDEFINES TYPEF.
  1006         10  TYPEA PIC  X(0001).
  1007     05  TYPEI PIC  X(0001).
  1008*    -------------------------------
  1009     05  FINRESPL PIC S9(0004) COMP.
  1010     05  FINRESPF PIC  X(0001).
  1011     05  FILLER REDEFINES FINRESPF.
  1012         10  FINRESPA PIC  X(0001).
  1013     05  FINRESPI PIC  X(0010).
  1014*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  24
* EL6521.cbl
  1015     05  COACCTL PIC S9(0004) COMP.
  1016     05  COACCTF PIC  X(0001).
  1017     05  FILLER REDEFINES COACCTF.
  1018         10  COACCTA PIC  X(0001).
  1019     05  COACCTI PIC  X(0010).
  1020*    -------------------------------
  1021     05  EFFDTL PIC S9(0004) COMP.
  1022     05  EFFDTF PIC  X(0001).
  1023     05  FILLER REDEFINES EFFDTF.
  1024         10  EFFDTA PIC  X(0001).
  1025     05  EFFDTI PIC  X(0008).
  1026*    -------------------------------
  1027     05  TRMDTL PIC S9(0004) COMP.
  1028     05  TRMDTF PIC  X(0001).
  1029     05  FILLER REDEFINES TRMDTF.
  1030         10  TRMDTA PIC  X(0001).
  1031     05  TRMDTI PIC  X(0008).
  1032*    -------------------------------
  1033     05  STATL PIC S9(0004) COMP.
  1034     05  STATF PIC  X(0001).
  1035     05  FILLER REDEFINES STATF.
  1036         10  STATA PIC  X(0001).
  1037     05  STATI PIC  X(0001).
  1038*    -------------------------------
  1039     05  WTHLDL PIC S9(0004) COMP.
  1040     05  WTHLDF PIC  X(0001).
  1041     05  FILLER REDEFINES WTHLDF.
  1042         10  WTHLDA PIC  X(0001).
  1043     05  WTHLDI PIC  S99V9999.
  1044*    -------------------------------
  1045     05  GADDL PIC S9(0004) COMP.
  1046     05  GADDF PIC  X(0001).
  1047     05  FILLER REDEFINES GADDF.
  1048         10  GADDA PIC  X(0001).
  1049     05  GADDI PIC  X(0001).
  1050*    -------------------------------
  1051     05  APCHKL PIC S9(0004) COMP.
  1052     05  APCHKF PIC  X(0001).
  1053     05  FILLER REDEFINES APCHKF.
  1054         10  APCHKA PIC  X(0001).
  1055     05  APCHKI PIC  X(0001).
  1056*    -------------------------------
  1057     05  MELSWL PIC S9(0004) COMP.
  1058     05  MELSWF PIC  X(0001).
  1059     05  FILLER REDEFINES MELSWF.
  1060         10  MELSWA PIC  X(0001).
  1061     05  MELSWI PIC  X(0001).
  1062*    -------------------------------
  1063     05  MDACTL PIC S9(0004) COMP.
  1064     05  MDACTF PIC  X(0001).
  1065     05  FILLER REDEFINES MDACTF.
  1066         10  MDACTA PIC  X(0001).
  1067     05  MDACTI PIC  X(0010).
  1068*    -------------------------------
  1069     05  MDDIVL PIC S9(0004) COMP.
  1070     05  MDDIVF PIC  X(0001).
  1071     05  FILLER REDEFINES MDDIVF.
  1072         10  MDDIVA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  25
* EL6521.cbl
  1073     05  MDDIVI PIC  X(0002).
  1074*    -------------------------------
  1075     05  MDCNTRL PIC S9(0004) COMP.
  1076     05  MDCNTRF PIC  X(0001).
  1077     05  FILLER REDEFINES MDCNTRF.
  1078         10  MDCNTRA PIC  X(0001).
  1079     05  MDCNTRI PIC  X(0004).
  1080*    -------------------------------
  1081     05  MDLOBL PIC S9(0004) COMP.
  1082     05  MDLOBF PIC  X(0001).
  1083     05  FILLER REDEFINES MDLOBF.
  1084         10  MDLOBA PIC  X(0001).
  1085     05  MDLOBI PIC  X(0006).
  1086*    -------------------------------
  1087     05  MDSTL PIC S9(0004) COMP.
  1088     05  MDSTF PIC  X(0001).
  1089     05  FILLER REDEFINES MDSTF.
  1090         10  MDSTA PIC  X(0001).
  1091     05  MDSTI PIC  X(0002).
  1092*    -------------------------------
  1093     05  MDAMTL PIC S9(0004) COMP.
  1094     05  MDAMTF PIC  X(0001).
  1095     05  FILLER REDEFINES MDAMTF.
  1096         10  MDAMTA PIC  X(0001).
  1097     05  MDAMTI PIC  S999999V99.
  1098*    -------------------------------
  1099     05  DELTOL PIC S9(0004) COMP.
  1100     05  DELTOF PIC  X(0001).
  1101     05  FILLER REDEFINES DELTOF.
  1102         10  DELTOA PIC  X(0001).
  1103     05  DELTOI PIC  X(0004).
  1104*    -------------------------------
  1105     05  RGIDL PIC S9(0004) COMP.
  1106     05  RGIDF PIC  X(0001).
  1107     05  FILLER REDEFINES RGIDF.
  1108         10  RGIDA PIC  X(0001).
  1109     05  RGIDI PIC  X(0012).
  1110*    -------------------------------
  1111     05  COMM1L PIC S9(0004) COMP.
  1112     05  COMM1F PIC  X(0001).
  1113     05  FILLER REDEFINES COMM1F.
  1114         10  COMM1A PIC  X(0001).
  1115     05  COMM1I PIC  X(0040).
  1116*    -------------------------------
  1117     05  COMM2L PIC S9(0004) COMP.
  1118     05  COMM2F PIC  X(0001).
  1119     05  FILLER REDEFINES COMM2F.
  1120         10  COMM2A PIC  X(0001).
  1121     05  COMM2I PIC  X(0040).
  1122*    -------------------------------
  1123     05  COMM3L PIC S9(0004) COMP.
  1124     05  COMM3F PIC  X(0001).
  1125     05  FILLER REDEFINES COMM3F.
  1126         10  COMM3A PIC  X(0001).
  1127     05  COMM3I PIC  X(0040).
  1128*    -------------------------------
  1129     05  COMM4L PIC S9(0004) COMP.
  1130     05  COMM4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  26
* EL6521.cbl
  1131     05  FILLER REDEFINES COMM4F.
  1132         10  COMM4A PIC  X(0001).
  1133     05  COMM4I PIC  X(0040).
  1134*    -------------------------------
  1135     05  BKLITL PIC S9(0004) COMP.
  1136     05  BKLITF PIC  X(0001).
  1137     05  FILLER REDEFINES BKLITF.
  1138         10  BKLITA PIC  X(0001).
  1139     05  BKLITI PIC  X(0023).
  1140*    -------------------------------
  1141     05  TRNSIT1L PIC S9(0004) COMP.
  1142     05  TRNSIT1F PIC  X(0001).
  1143     05  FILLER REDEFINES TRNSIT1F.
  1144         10  TRNSIT1A PIC  X(0001).
  1145     05  TRNSIT1I PIC  X(0004).
  1146*    -------------------------------
  1147     05  TRDASHL PIC S9(0004) COMP.
  1148     05  TRDASHF PIC  X(0001).
  1149     05  FILLER REDEFINES TRDASHF.
  1150         10  TRDASHA PIC  X(0001).
  1151     05  TRDASHI PIC  X(0001).
  1152*    -------------------------------
  1153     05  TRNSIT2L PIC S9(0004) COMP.
  1154     05  TRNSIT2F PIC  X(0001).
  1155     05  FILLER REDEFINES TRNSIT2F.
  1156         10  TRNSIT2A PIC  X(0001).
  1157     05  TRNSIT2I PIC  X(0004).
  1158*    -------------------------------
  1159     05  BKDESCL PIC S9(0004) COMP.
  1160     05  BKDESCF PIC  X(0001).
  1161     05  FILLER REDEFINES BKDESCF.
  1162         10  BKDESCA PIC  X(0001).
  1163     05  BKDESCI PIC  X(0023).
  1164*    -------------------------------
  1165     05  BKACCTL PIC S9(0004) COMP.
  1166     05  BKACCTF PIC  X(0001).
  1167     05  FILLER REDEFINES BKACCTF.
  1168         10  BKACCTA PIC  X(0001).
  1169     05  BKACCTI PIC  X(0017).
  1170*    -------------------------------
  1171     05  ACTLITL PIC S9(0004) COMP.
  1172     05  ACTLITF PIC  X(0001).
  1173     05  FILLER REDEFINES ACTLITF.
  1174         10  ACTLITA PIC  X(0001).
  1175     05  ACTLITI PIC  X(0023).
  1176*    -------------------------------
  1177     05  ACTCDL PIC S9(0004) COMP.
  1178     05  ACTCDF PIC  X(0001).
  1179     05  FILLER REDEFINES ACTCDF.
  1180         10  ACTCDA PIC  X(0001).
  1181     05  ACTCDI PIC  X(0001).
  1182*    -------------------------------
  1183     05  CRSLITL PIC S9(0004) COMP.
  1184     05  CRSLITF PIC  X(0001).
  1185     05  FILLER REDEFINES CRSLITF.
  1186         10  CRSLITA PIC  X(0001).
  1187     05  CRSLITI PIC  X(0017).
  1188*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  27
* EL6521.cbl
  1189     05  CRSTATL PIC S9(0004) COMP.
  1190     05  CRSTATF PIC  X(0001).
  1191     05  FILLER REDEFINES CRSTATF.
  1192         10  CRSTATA PIC  X(0001).
  1193     05  CRSTATI PIC  X(0010).
  1194*    -------------------------------
  1195     05  ERRMSG1L PIC S9(0004) COMP.
  1196     05  ERRMSG1F PIC  X(0001).
  1197     05  FILLER REDEFINES ERRMSG1F.
  1198         10  ERRMSG1A PIC  X(0001).
  1199     05  ERRMSG1I PIC  X(0071).
  1200*    -------------------------------
  1201     05  ERRMSG2L PIC S9(0004) COMP.
  1202     05  ERRMSG2F PIC  X(0001).
  1203     05  FILLER REDEFINES ERRMSG2F.
  1204         10  ERRMSG2A PIC  X(0001).
  1205     05  ERRMSG2I PIC  X(0071).
  1206*    -------------------------------
  1207     05  PFENTERL PIC S9(0004) COMP.
  1208     05  PFENTERF PIC  X(0001).
  1209     05  FILLER REDEFINES PFENTERF.
  1210         10  PFENTERA PIC  X(0001).
  1211     05  PFENTERI PIC  99.
  1212*    -------------------------------
  1213     05  ACHPF1L PIC S9(0004) COMP.
  1214     05  ACHPF1F PIC  X(0001).
  1215     05  FILLER REDEFINES ACHPF1F.
  1216         10  ACHPF1A PIC  X(0001).
  1217     05  ACHPF1I PIC  X(0015).
  1218 01  EL6521AO REDEFINES EL6521AI.
  1219     05  FILLER            PIC  X(0012).
  1220*    -------------------------------
  1221     05  FILLER            PIC  X(0003).
  1222     05  DATEO PIC  X(0008).
  1223*    -------------------------------
  1224     05  FILLER            PIC  X(0003).
  1225     05  TIMEO PIC  99.99.
  1226*    -------------------------------
  1227     05  FILLER            PIC  X(0003).
  1228     05  CMPNYIDO PIC  X(0003).
  1229*    -------------------------------
  1230     05  FILLER            PIC  X(0003).
  1231     05  USERIDO PIC  X(0004).
  1232*    -------------------------------
  1233     05  FILLER            PIC  X(0003).
  1234     05  MAINTYPO PIC  X(0001).
  1235*    -------------------------------
  1236     05  FILLER            PIC  X(0003).
  1237     05  CARRIERO PIC  X(0001).
  1238*    -------------------------------
  1239     05  FILLER            PIC  X(0003).
  1240     05  GROUPO PIC  X(0006).
  1241*    -------------------------------
  1242     05  FILLER            PIC  X(0003).
  1243     05  TYPEO PIC  X(0001).
  1244*    -------------------------------
  1245     05  FILLER            PIC  X(0003).
  1246     05  FINRESPO PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  28
* EL6521.cbl
  1247*    -------------------------------
  1248     05  FILLER            PIC  X(0003).
  1249     05  COACCTO PIC  X(0010).
  1250*    -------------------------------
  1251     05  FILLER            PIC  X(0003).
  1252     05  EFFDTO PIC  X(0008).
  1253*    -------------------------------
  1254     05  FILLER            PIC  X(0003).
  1255     05  TRMDTO PIC  X(0008).
  1256*    -------------------------------
  1257     05  FILLER            PIC  X(0003).
  1258     05  STATO PIC  X(0001).
  1259*    -------------------------------
  1260     05  FILLER            PIC  X(0003).
  1261     05  WTHLDO PIC  Z.9999.
  1262*    -------------------------------
  1263     05  FILLER            PIC  X(0003).
  1264     05  GADDO PIC  X(0001).
  1265*    -------------------------------
  1266     05  FILLER            PIC  X(0003).
  1267     05  APCHKO PIC  X(0001).
  1268*    -------------------------------
  1269     05  FILLER            PIC  X(0003).
  1270     05  MELSWO PIC  X(0001).
  1271*    -------------------------------
  1272     05  FILLER            PIC  X(0003).
  1273     05  MDACTO PIC  X(0010).
  1274*    -------------------------------
  1275     05  FILLER            PIC  X(0003).
  1276     05  MDDIVO PIC  X(0002).
  1277*    -------------------------------
  1278     05  FILLER            PIC  X(0003).
  1279     05  MDCNTRO PIC  X(0004).
  1280*    -------------------------------
  1281     05  FILLER            PIC  X(0003).
  1282     05  MDLOBO PIC  X(0006).
  1283*    -------------------------------
  1284     05  FILLER            PIC  X(0003).
  1285     05  MDSTO PIC  X(0002).
  1286*    -------------------------------
  1287     05  FILLER            PIC  X(0003).
  1288     05  MDAMTO PIC  ZZZZZ.99.
  1289*    -------------------------------
  1290     05  FILLER            PIC  X(0003).
  1291     05  DELTOO PIC  X(0004).
  1292*    -------------------------------
  1293     05  FILLER            PIC  X(0003).
  1294     05  RGIDO PIC  X(0012).
  1295*    -------------------------------
  1296     05  FILLER            PIC  X(0003).
  1297     05  COMM1O PIC  X(0040).
  1298*    -------------------------------
  1299     05  FILLER            PIC  X(0003).
  1300     05  COMM2O PIC  X(0040).
  1301*    -------------------------------
  1302     05  FILLER            PIC  X(0003).
  1303     05  COMM3O PIC  X(0040).
  1304*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  29
* EL6521.cbl
  1305     05  FILLER            PIC  X(0003).
  1306     05  COMM4O PIC  X(0040).
  1307*    -------------------------------
  1308     05  FILLER            PIC  X(0003).
  1309     05  BKLITO PIC  X(0023).
  1310*    -------------------------------
  1311     05  FILLER            PIC  X(0003).
  1312     05  TRNSIT1O PIC  X(0004).
  1313*    -------------------------------
  1314     05  FILLER            PIC  X(0003).
  1315     05  TRDASHO PIC  X(0001).
  1316*    -------------------------------
  1317     05  FILLER            PIC  X(0003).
  1318     05  TRNSIT2O PIC  X(0004).
  1319*    -------------------------------
  1320     05  FILLER            PIC  X(0003).
  1321     05  BKDESCO PIC  X(0023).
  1322*    -------------------------------
  1323     05  FILLER            PIC  X(0003).
  1324     05  BKACCTO PIC  X(0017).
  1325*    -------------------------------
  1326     05  FILLER            PIC  X(0003).
  1327     05  ACTLITO PIC  X(0023).
  1328*    -------------------------------
  1329     05  FILLER            PIC  X(0003).
  1330     05  ACTCDO PIC  X(0001).
  1331*    -------------------------------
  1332     05  FILLER            PIC  X(0003).
  1333     05  CRSLITO PIC  X(0017).
  1334*    -------------------------------
  1335     05  FILLER            PIC  X(0003).
  1336     05  CRSTATO PIC  X(0010).
  1337*    -------------------------------
  1338     05  FILLER            PIC  X(0003).
  1339     05  ERRMSG1O PIC  X(0071).
  1340*    -------------------------------
  1341     05  FILLER            PIC  X(0003).
  1342     05  ERRMSG2O PIC  X(0071).
  1343*    -------------------------------
  1344     05  FILLER            PIC  X(0003).
  1345     05  PFENTERO PIC  99.
  1346*    -------------------------------
  1347     05  FILLER            PIC  X(0003).
  1348     05  ACHPF1O PIC  X(0015).
  1349*    -------------------------------
  1350
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  30
* EL6521.cbl
  1352****************************************************************
  1353*
  1354* Copyright (c) 2007-2013 Dell Inc.
  1355* All rights reserved.
  1356*
  1357****************************************************************
  1358 01  DFHEIV.
  1359   02  DFHEIV0               PIC X(35).
  1360   02  DFHEIV1               PIC X(08).
  1361   02  DFHEIV2               PIC X(08).
  1362   02  DFHEIV3               PIC X(08).
  1363   02  DFHEIV4               PIC X(06).
  1364   02  DFHEIV5               PIC X(04).
  1365   02  DFHEIV6               PIC X(04).
  1366   02  DFHEIV7               PIC X(02).
  1367   02  DFHEIV8               PIC X(02).
  1368   02  DFHEIV9               PIC X(01).
  1369   02  DFHEIV10              PIC S9(7) COMP-3.
  1370   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1371   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1372   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1373   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1374   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1375   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1376   02  DFHEIV17              PIC X(04).
  1377   02  DFHEIV18              PIC X(04).
  1378   02  DFHEIV19              PIC X(04).
  1379   02  DFHEIV20              USAGE IS POINTER.
  1380   02  DFHEIV21              USAGE IS POINTER.
  1381   02  DFHEIV22              USAGE IS POINTER.
  1382   02  DFHEIV23              USAGE IS POINTER.
  1383   02  DFHEIV24              USAGE IS POINTER.
  1384   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1385   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1386   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1387   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1388   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1389   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1390   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1391   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1392   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1393   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1394   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1395   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1396   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1397   02  FILLER                PIC X(02).
  1398   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1399   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1400   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1401   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1402   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1403   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1404   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1405 LINKAGE  SECTION.
  1406*****************************************************************
  1407*                                                               *
  1408* Copyright (c) 2007-2013 Dell Inc.                             *
  1409* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  31
* EL6521.cbl
  1410*                                                               *
  1411*****************************************************************
  1412 01  dfheiblk.
  1413     02  eibtime          pic s9(7) comp-3.
  1414     02  eibdate          pic s9(7) comp-3.
  1415     02  eibtrnid         pic x(4).
  1416     02  eibtaskn         pic s9(7) comp-3.
  1417     02  eibtrmid         pic x(4).
  1418     02  dfheigdi         pic s9(4) comp.
  1419     02  eibcposn         pic s9(4) comp.
  1420     02  eibcalen         pic s9(4) comp.
  1421     02  eibaid           pic x(1).
  1422     02  eibfiller1       pic x(1).
  1423     02  eibfn            pic x(2).
  1424     02  eibfiller2       pic x(2).
  1425     02  eibrcode         pic x(6).
  1426     02  eibfiller3       pic x(2).
  1427     02  eibds            pic x(8).
  1428     02  eibreqid         pic x(8).
  1429     02  eibrsrce         pic x(8).
  1430     02  eibsync          pic x(1).
  1431     02  eibfree          pic x(1).
  1432     02  eibrecv          pic x(1).
  1433     02  eibsend          pic x(1).
  1434     02  eibatt           pic x(1).
  1435     02  eibeoc           pic x(1).
  1436     02  eibfmh           pic x(1).
  1437     02  eibcompl         pic x(1).
  1438     02  eibsig           pic x(1).
  1439     02  eibconf          pic x(1).
  1440     02  eiberr           pic x(1).
  1441     02  eibrldbk         pic x(1).
  1442     02  eiberrcd         pic x(4).
  1443     02  eibsynrb         pic x(1).
  1444     02  eibnodat         pic x(1).
  1445     02  eibfiller5       pic x(2).
  1446     02  eibresp          pic s9(8) comp.
  1447     02  eibresp2         pic s9(8) comp.
  1448     02  dfheigdj         pic s9(4) comp.
  1449     02  dfheigdk         pic s9(4) comp.
  1450 01  DFHCOMMAREA                     PIC X(1024).
  1451
  1452*    COPY ERCCOMP.
  1453******************************************************************
  1454*                                                                *
  1455*                                                                *
  1456*                            ERCCOMP                             *
  1457*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1458*                            VMOD=2.019                          *
  1459*                                                                *
  1460*   ONLINE CREDIT SYSTEM                                         *
  1461*                                                                *
  1462*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1463*                                                                *
  1464*   FILE TYPE = VSAM,KSDS                                        *
  1465*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1466*                                                                *
  1467*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  32
* EL6521.cbl
  1468*       ALTERNATE PATH = NONE                                    *
  1469*                                                                *
  1470*   LOG = NO                                                     *
  1471*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1472*                                                                *
  1473******************************************************************
  1474*                   C H A N G E   L O G
  1475*
  1476* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1477*-----------------------------------------------------------------
  1478*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1479* EFFECTIVE    NUMBER
  1480*-----------------------------------------------------------------
  1481* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1482* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1483* 092205    2005050300006  PEMA  ADD LEASE FEE
  1484* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1485* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1486* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1487* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1488* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1489* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1490******************************************************************
  1491
  1492 01  COMPENSATION-MASTER.
  1493     12  CO-RECORD-ID                          PIC XX.
  1494         88  VALID-CO-ID                          VALUE 'CO'.
  1495
  1496     12  CO-CONTROL-PRIMARY.
  1497         16  CO-COMPANY-CD                     PIC X.
  1498         16  CO-CONTROL.
  1499             20  CO-CTL-1.
  1500                 24  CO-CARR-GROUP.
  1501                     28  CO-CARRIER            PIC X.
  1502                     28  CO-GROUPING.
  1503                         32  CO-GROUP-PREFIX   PIC XXX.
  1504                         32  CO-GROUP-PRIME    PIC XXX.
  1505                 24  CO-RESP-NO.
  1506                     28  CO-RESP-PREFIX        PIC X(4).
  1507                     28  CO-RESP-PRIME         PIC X(6).
  1508             20  CO-CTL-2.
  1509                 24  CO-ACCOUNT.
  1510                     28  CO-ACCT-PREFIX        PIC X(4).
  1511                     28  CO-ACCT-PRIME         PIC X(6).
  1512         16  CO-TYPE                           PIC X.
  1513             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1514             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1515             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1516
  1517     12  CO-MAINT-INFORMATION.
  1518         16  CO-LAST-MAINT-DT                  PIC XX.
  1519         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1520         16  CO-LAST-MAINT-USER                PIC X(4).
  1521     12  FILLER                                PIC XX.
  1522     12  CO-STMT-TYPE                          PIC XXX.
  1523     12  CO-COMP-TYPE                          PIC X.
  1524         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1525     12  CO-STMT-OWNER                         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  33
* EL6521.cbl
  1526     12  CO-BALANCE-CONTROL                    PIC X.
  1527         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1528         88  CO-NO-BALANCE                        VALUE 'N'.
  1529
  1530     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1531         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1532         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1533         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1534
  1535     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1536         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1537         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1538
  1539     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1540     12  CO-GA-DIRECT-DEP                      PIC X.
  1541     12  CO-FUTURE-SPACE                       PIC X.
  1542         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1543
  1544     12  CO-ACCT-NAME                          PIC X(30).
  1545     12  CO-MAIL-NAME                          PIC X(30).
  1546     12  CO-ADDR-1                             PIC X(30).
  1547     12  CO-ADDR-2                             PIC X(30).
  1548     12  CO-ADDR-3.
  1549         16  CO-ADDR-CITY                      PIC X(27).
  1550         16  CO-ADDR-STATE                     PIC XX.
  1551     12  CO-CSO-1099                           PIC X.
  1552     12  CO-ZIP.
  1553         16  CO-ZIP-PRIME.
  1554             20  CO-ZIP-PRI-1ST                PIC X.
  1555                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1556             20  FILLER                        PIC X(4).
  1557         16  CO-ZIP-PLUS4                      PIC X(4).
  1558     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1559         16  CO-CAN-POSTAL-1                   PIC XXX.
  1560         16  CO-CAN-POSTAL-2                   PIC XXX.
  1561         16  FILLER                            PIC XXX.
  1562     12  CO-SOC-SEC                            PIC X(13).
  1563     12  CO-TELEPHONE.
  1564         16  CO-AREA-CODE                      PIC XXX.
  1565         16  CO-PREFIX                         PIC XXX.
  1566         16  CO-PHONE                          PIC X(4).
  1567
  1568     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1569
  1570     12  CO-AR-BAL-LEVEL                       PIC X.
  1571         88  CO-AR-REF-LVL                        VALUE '1'.
  1572         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1573         88  CO-AR-BILL-LVL                       VALUE '2'.
  1574         88  CO-AR-AGT-LVL                        VALUE '3'.
  1575         88  CO-AR-FR-LVL                         VALUE '4'.
  1576
  1577     12  CO-AR-NORMAL-PRINT                    PIC X.
  1578         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1579         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1580
  1581     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1582
  1583     12  CO-AR-REPORTING                       PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  34
* EL6521.cbl
  1584         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1585         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1586
  1587     12  CO-AR-PULL-CHECK                      PIC X.
  1588         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1589         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1590
  1591     12  CO-AR-BALANCE-PRINT                   PIC X.
  1592         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1593
  1594     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1595         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1596         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1597         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1598
  1599     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1600
  1601     12  CO-USER-CODE                          PIC X.
  1602     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1603
  1604******************************************************************
  1605*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1606*    THE LAST MONTH END RUN.
  1607******************************************************************
  1608
  1609     12  CO-LAST-ACTIVITY-DATE.
  1610         16  CO-ACT-YEAR                       PIC 99.
  1611         16  CO-ACT-MONTH                      PIC 99.
  1612         16  CO-ACT-DAY                        PIC 99.
  1613
  1614     12  CO-LAST-STMT-DT.
  1615         16  CO-LAST-STMT-YEAR                 PIC 99.
  1616         16  CO-LAST-STMT-MONTH                PIC 99.
  1617         16  CO-LAST-STMT-DAY                  PIC 99.
  1618
  1619     12  CO-MO-END-TOTALS.
  1620         16  CO-MONTHLY-TOTALS.
  1621             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1622             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1623             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1624             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1625             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1626
  1627         16  CO-AGING-TOTALS.
  1628             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1629             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1630             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1631             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1632
  1633         16  CO-YTD-TOTALS.
  1634             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1635             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1636
  1637         16  CO-OVER-UNDER-TOTALS.
  1638             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1639             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1640
  1641     12  CO-MISCELLANEOUS-TOTALS.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  35
* EL6521.cbl
  1642         16  CO-FICA-TOTALS.
  1643             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1644             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1645
  1646         16  CO-CLAIM-TOTALS.
  1647             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1648             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1649
  1650******************************************************************
  1651*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1652*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1653******************************************************************
  1654
  1655     12  CO-CURRENT-TOTALS.
  1656         16  CO-CURRENT-LAST-STMT-DT.
  1657             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1658             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1659             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1660
  1661         16  CO-CURRENT-MONTHLY-TOTALS.
  1662             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1663             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1664             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1665             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1666             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1667
  1668         16  CO-CURRENT-AGING-TOTALS.
  1669             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1670             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1671             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1672             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1673
  1674         16  CO-CURRENT-YTD-TOTALS.
  1675             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1676             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1677
  1678     12  CO-PAID-COMM-TOTALS.
  1679         16  CO-YTD-PAID-COMMS.
  1680             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1681             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1682
  1683     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1684         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1685         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1686
  1687     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1688         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1689         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1690         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1691         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1692         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1693         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1694         88  CO-FINAL-LETTER                  VALUE 'F'.
  1695         88  CO-RECONCILING                   VALUE 'R'.
  1696         88  CO-PHONE-CALL                    VALUE 'P'.
  1697         88  CO-LEGAL                         VALUE 'L'.
  1698         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1699         88  CO-WRITE-OFF                     VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  36
* EL6521.cbl
  1700         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1701
  1702     12  CO-CSR-CODE                       PIC X(4).
  1703
  1704     12  CO-GA-STATUS-INFO.
  1705         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1706         16  CO-GA-TERMINATION-DT          PIC XX.
  1707         16  CO-GA-STATUS-CODE             PIC X.
  1708             88  CO-GA-ACTIVE                 VALUE 'A'.
  1709             88  CO-GA-INACTIVE               VALUE 'I'.
  1710             88  CO-GA-PENDING                VALUE 'P'.
  1711         16  CO-GA-COMMENTS.
  1712             20  CO-GA-COMMENT-1           PIC X(40).
  1713             20  CO-GA-COMMENT-2           PIC X(40).
  1714             20  CO-GA-COMMENT-3           PIC X(40).
  1715             20  CO-GA-COMMENT-4           PIC X(40).
  1716
  1717     12  CO-RPTCD2                         PIC X(10).
  1718     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1719         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1720         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1721
  1722     12  CO-TYPE-AGENT                     PIC X(01).
  1723         88  CO-CORPORATION                   VALUE 'C'.
  1724         88  CO-PARTNERSHIP                   VALUE 'P'.
  1725         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1726         88  CO-TRUST                         VALUE 'T'.
  1727         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1728
  1729     12  CO-FAXNO.
  1730         16  CO-FAX-AREA-CODE                  PIC XXX.
  1731         16  CO-FAX-PREFIX                     PIC XXX.
  1732         16  CO-FAX-PHONE                      PIC X(4).
  1733
  1734     12  CO-BANK-INFORMATION.
  1735         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1736         16  CO-BANK-TRANSIT-NON REDEFINES
  1737             CO-BANK-TRANSIT-NO                PIC 9(8).
  1738
  1739         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1740     12  CO-MISC-DEDUCT-INFO REDEFINES
  1741                  CO-BANK-INFORMATION.
  1742         16  CO-MD-GL-ACCT                     PIC X(10).
  1743         16  CO-MD-DIV                         PIC XX.
  1744         16  CO-MD-CENTER                      PIC X(4).
  1745         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1746         16  CO-CREATE-AP-CHECK                PIC X.
  1747         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1748         16  FILLER                            PIC XXX.
  1749     12  CO-ACH-STATUS                         PIC X.
  1750         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1751         88  CO-ACH-PENDING                        VALUE 'P'.
  1752
  1753     12  CO-BILL-SW                            PIC X.
  1754     12  CO-CONTROL-NAME                       PIC X(30).
  1755     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1756     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1757     12  CO-CLP-STATE                          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  37
* EL6521.cbl
  1758     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1759     12  CO-SPP-REFUND-EDIT                    PIC X.
  1760
  1761******************************************************************
  1762*    COPY ERCCOBI.
  1763******************************************************************
  1764*                                                                *
  1765*                                                                *
  1766*                            ERCCOBI                             *
  1767*                                                                *
  1768*   ONLINE CREDIT SYSTEM                                         *
  1769*                                                                *
  1770*   FILE DESCRIPTION = COMPENSATION MASTER BILLING INSTRUCTIONS  *
  1771*                                                                *
  1772*   FILE TYPE = VSAM,KSDS                                        *
  1773*   RECORD SIZE = 620   RECFORM = FIXED                          *
  1774*                                                                *
  1775*   BASE CLUSTER NAME = ERCOBI                   RKP=2,LEN=17    *
  1776*       ALTERNATE PATH = NONE                                    *
  1777*                                                                *
  1778*   LOG = NO                                                     *
  1779*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1780*                                                                *
  1781******************************************************************
  1782*                   C H A N G E   L O G
  1783*
  1784* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1785*-----------------------------------------------------------------
  1786*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1787* EFFECTIVE    NUMBER
  1788*-----------------------------------------------------------------
  1789* 081808    2008061100001  PEMA  NEW FILE FOR BILLING INSTRUCTIONS
  1790******************************************************************
  1791 01  COMP-BILLING-INSTRUCTIONS.
  1792     12  BL-RECORD-ID                          PIC XX.
  1793         88  VALID-BL-ID                          VALUE 'BL'.
  1794     12  BL-CONTROL-PRIMARY.
  1795         16  BL-COMPANY-CD                     PIC X.
  1796         16  BL-STMT-OWNER                     PIC X(4).
  1797         16  BL-REPORT-GROUP-ID                PIC X(12).
  1798     12  BL-MAINT-INFORMATION.
  1799         16  BL-LAST-MAINT-DT                  PIC XX.
  1800         16  BL-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1801         16  BL-LAST-MAINT-USER                PIC X(4).
  1802         16  FILLER                            PIC X(10).
  1803     12  BL-ACCOUNT-NAME                       PIC X(35).
  1804     12  BL-CONTACT-NAME                       PIC X(35).
  1805     12  BL-ADDR1                              PIC X(30).
  1806     12  BL-ADDR2                              PIC X(30).
  1807     12  BL-CITY                               PIC X(30).
  1808     12  BL-STATE                              PIC XX.
  1809     12  BL-ZIP.
  1810         16  BL-ZIP-PRIME.
  1811             20  BL-ZIP-PRI-1ST                PIC X.
  1812                 88  BL-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1813             20  FILLER                        PIC X(4).
  1814         16  BL-ZIP-PLUS4                      PIC X(4).
  1815     12  BL-CANADIAN-POSTAL-CODE  REDEFINES  BL-ZIP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  38
* EL6521.cbl
  1816         16  BL-CAN-POSTAL-1                   PIC XXX.
  1817         16  BL-CAN-POSTAL-2                   PIC XXX.
  1818         16  FILLER                            PIC XXX.
  1819*    12  FILLER                                PIC X(30).
  1820     12  BL-CHECK-HANDLING                     PIC X.
  1821         88  BL-CHECKS-NET                VALUE '1' ' '.
  1822         88  BL-CHECKS-SEPARATE           VALUE '2'.
  1823     12  BL-SPECIAL-INSTRUCTIONS.
  1824         16  BL-SI-LINE-1                      PIC X(70).
  1825         16  BL-SI-LINE-2                      PIC X(70).
  1826         16  BL-SI-LINE-3                      PIC X(70).
  1827         16  BL-SI-LINE-4                      PIC X(70).
  1828         16  BL-SI-LINE-5                      PIC X(70).
  1829     12  FILLER                                PIC X(59).
  1830
  1831******************************************************************
  1832*    COPY ELCACHP.
  1833******************************************************************
  1834*                                                                *
  1835*                           ELCACHP                              *
  1836*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1837*                            VMOD=2.002                          *
  1838*                                                                *
  1839*   FILE DESCRIPTION = ACH PRE-NOTIFICATION                      *
  1840*                                                                *
  1841*   FILE TYPE = VSAM,KSDS                                        *
  1842*   RECORD SIZE = 120  RECFORM = FIXED                           *
  1843*                                                                *
  1844*   BASE CLUSTER = ELACHP                         RKP=2,LEN=29   *
  1845*       ALTERNATE (NONE)                                         *
  1846*                                                                *
  1847*   LOG = YES                                                    *
  1848*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1849*                                                                *
  1850*  NO  CID  MODS  IN  COPYBOOK  ELCACHP                          *
  1851******************************************************************
  1852
  1853 01  ACH-PRENOTIFICATION.
  1854     12  AP-RECORD-ID                      PIC XX.
  1855         88  VALID-AP-ID                      VALUE 'AP'.
  1856
  1857******************************************************************
  1858*   BASE CLUSTER = ELACHP         (BASE KEY)      RKP=2,LEN=29   *
  1859******************************************************************
  1860
  1861     12  AP-CONTROL-PRIMARY.
  1862         16  AP-CONTROL-CD                 PIC X.
  1863         16  AP-CARRIER                    PIC X.
  1864         16  AP-GROUPING                   PIC X(6).
  1865         16  AP-FIN-RESP                   PIC X(10).
  1866         16  AP-ACCT-AGENT                 PIC X(10).
  1867         16  AP-CO-TYPE                    PIC X.
  1868
  1869     12  AP-CONTROL-ALT   REDEFINES  AP-CONTROL-PRIMARY.
  1870         16  AP-COMPANY-CD-ALT             PIC X.
  1871         16  AP-BENEFICIARY                PIC X(10).
  1872         16  FILLER                        PIC X(18).
  1873
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  39
* EL6521.cbl
  1874******************************************************************
  1875*                 FILE SYNCHRONIZATION DATA                      *
  1876******************************************************************
  1877
  1878     12  AP-FILE-SYNCH-DATA.
  1879         16  AP-LAST-CHANGE-DT             PIC XX.
  1880         16  AP-LAST-CHANGE-TIME           PIC S9(7)  COMP-3.
  1881         16  AP-LAST-CHANGE-PROCESSOR      PIC X(4).
  1882
  1883******************************************************************
  1884*                     PRENOTE INFORMATION
  1885******************************************************************
  1886
  1887     12  AP-BANK-INFORMATION.
  1888         16  AP-TRANSIT-NUMBER             PIC X(8).
  1889         16  AP-BANK-ACCOUNT-NO            PIC X(17).
  1890         16  AP-BANK-NAME                  PIC X(23).
  1891
  1892     12  FILLER                            PIC X(31).
  1893
  1894******************************************************************
  1895*    COPY ELCBANK.
  1896******************************************************************
  1897*                                                                *
  1898*                           ELCBANK                              *
  1899*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1900*                            VMOD=2.002                          *
  1901*                                                                *
  1902*   FILE DESCRIPTION = BANK MASTER FILE                          *
  1903*                                                                *
  1904*   FILE TYPE = VSAM,KSDS                                        *
  1905*   RECORD SIZE = 210  RECFORM = FIXED                           *
  1906*                                                                *
  1907*   BASE CLUSTER = ELBANK                         RKP=2,LEN=9    *
  1908*       ALTERNATE (NONE)                                         *
  1909*                                                                *
  1910*   LOG = YES                                                    *
  1911*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1912*                                                                *
  1913*  NO  CID  MODS  IN  COPYBOOK  ELCBANK                          *
  1914******************************************************************
  1915
  1916 01  BANK-MASTER.
  1917     12  BM-RECORD-ID                      PIC XX.
  1918         88  VALID-BM-ID                      VALUE 'BM'.
  1919
  1920******************************************************************
  1921*   BASE CLUSTER = MPBANK         (BASE KEY)      RKP=2,LEN=9    *
  1922******************************************************************
  1923
  1924     12  BM-CONTROL-PRIMARY.
  1925         16  BM-COMPANY-CD                 PIC X.
  1926         16  BM-TRANSIT-NUMBER.
  1927             20  BM-FEDERAL-NUMBER         PIC X(4).
  1928             20  BM-BANK-NUMBER            PIC X(4).
  1929     12  FILLER                            PIC X(20).
  1930
  1931******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  40
* EL6521.cbl
  1932*                 FILE SYNCHRONIZATION DATA                      *
  1933******************************************************************
  1934
  1935     12  BM-FILE-SYNCH-DATA.
  1936         16  BM-LAST-CHANGE-DT             PIC XX.
  1937         16  BM-LAST-CHANGE-TIME           PIC S9(7)  COMP-3.
  1938         16  BM-LAST-CHANGE-PROCESSOR      PIC X(4).
  1939
  1940******************************************************************
  1941*                       BANK INFORMATION                         *
  1942******************************************************************
  1943
  1944     12  BM-BANK-INFORMATION.
  1945         16  BM-NAME                       PIC X(30).
  1946         16  BM-ADDRESS1                   PIC X(30).
  1947         16  BM-ADDRESS2                   PIC X(30).
  1948         16  BM-CITY                       PIC X(25).
  1949         16  BM-STATE                      PIC X(25).
  1950         16  BM-ZIP.
  1951             20  BM-ZIP1                   PIC X(5).
  1952             20  BM-ZIP2                   PIC X(4).
  1953     12  FILLER                            PIC X(20).
  1954
  1955******************************************************************
  1956 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1957                          COMPENSATION-MASTER
  1958                          COMP-BILLING-INSTRUCTIONS
  1959                          ACH-PRENOTIFICATION BANK-MASTER.
  1960 0000-DFHEXIT SECTION.
  1961     MOVE '9#                    $   ' TO DFHEIV0.
  1962     MOVE 'EL6521' TO DFHEIV1.
  1963     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1964
  1965     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1966     MOVE '5'                    TO DC-OPTION-CODE.
  1967     PERFORM 9700-DATE-CONVERT THRU 9700-EXIT.
  1968     MOVE DC-GREG-DATE-1-EDIT    TO WS-SAVE-DATE.
  1969     MOVE DC-BIN-DATE-1          TO WS-SAVE-BIN-DT.
  1970
  1971     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1972     MOVE EIBTRMID               TO QID-TERM.
  1973     MOVE +2                     TO EMI-NUMBER-OF-LINES.
  1974     MOVE SPACE                  TO SUPPRESS-MAP-SW.
  1975
  1976     IF EIBCALEN = 0
  1977        GO TO 8800-UNAUTHORIZED-ACCESS
  1978     END-IF
  1979     IF PI-RETURN-TO-PROGRAM = THIS-PGM
  1980        MOVE PI-CALLING-PROGRAM  TO RETURNED-FROM
  1981     END-IF
  1982     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1983        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1984           MOVE PI-SAVED-PROGRAM-5    TO PI-SAVED-PROGRAM-6
  1985           MOVE PI-SAVED-PROGRAM-4    TO PI-SAVED-PROGRAM-5
  1986           MOVE PI-SAVED-PROGRAM-3    TO PI-SAVED-PROGRAM-4
  1987           MOVE PI-SAVED-PROGRAM-2    TO PI-SAVED-PROGRAM-3
  1988           MOVE PI-SAVED-PROGRAM-1    TO PI-SAVED-PROGRAM-2
  1989           MOVE PI-RETURN-TO-PROGRAM  TO PI-SAVED-PROGRAM-1
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  41
* EL6521.cbl
  1990           MOVE PI-CALLING-PROGRAM    TO PI-RETURN-TO-PROGRAM
  1991           MOVE THIS-PGM              TO PI-CALLING-PROGRAM
  1992        ELSE
  1993           MOVE PI-RETURN-TO-PROGRAM  TO PI-CALLING-PROGRAM
  1994           MOVE PI-SAVED-PROGRAM-1    TO PI-RETURN-TO-PROGRAM
  1995           MOVE PI-SAVED-PROGRAM-2    TO PI-SAVED-PROGRAM-1
  1996           MOVE PI-SAVED-PROGRAM-3    TO PI-SAVED-PROGRAM-2
  1997           MOVE PI-SAVED-PROGRAM-4    TO PI-SAVED-PROGRAM-3
  1998           MOVE PI-SAVED-PROGRAM-5    TO PI-SAVED-PROGRAM-4
  1999           MOVE PI-SAVED-PROGRAM-6    TO PI-SAVED-PROGRAM-5
  2000           MOVE SPACES                TO PI-SAVED-PROGRAM-6
  2001        END-IF
  2002     END-IF
  2003     MOVE LOW-VALUES             TO EL6521AI
  2004     IF EIBTRNID = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  2005           EL6526-TRANS-ID
  2006        CONTINUE
  2007     ELSE
  2008        GO TO 0100-NOT-EL611-RETURN
  2009     END-IF
  2010
  2011     PERFORM 0600-RECOVER-TS  THRU  0600-EXIT.
  2012     MOVE XCTL-652           TO PI-RETURN-TO-PROGRAM.
  2013
  2014     MOVE PI-FEDERAL-NUMBER      TO TRNSIT1O.
  2015     MOVE PI-BANK-NUMBER         TO TRNSIT2O.
  2016     MOVE PI-BANK-ACCOUNT-NO     TO BKACCTO.
  2017
  2018     IF PI-BANK-ACTION-CODE EQUAL   'P'
  2019        MOVE 'PENDING'           TO CRSTATO.
  2020
  2021     IF PI-BANK-ACTION-CODE EQUAL   'A'
  2022        MOVE 'ACTIVE '           TO CRSTATO.
  2023
  2024     IF MAINTYPL GREATER THAN ZERO
  2025         MOVE AL-UABON           TO MAINTYPA.
  2026
  2027     IF STATL    GREATER THAN ZERO
  2028         MOVE 'Y'                TO MAP-CHANGED-SW
  2029         MOVE AL-UANON           TO STATA.
  2030
  2031     IF WTHLDL > ZERO
  2032        MOVE 'Y'                 TO MAP-CHANGED-SW
  2033        MOVE AL-UNNON            TO WTHLDA
  2034     END-IF
  2035     IF GADDL > ZERO
  2036        MOVE 'Y'                 TO MAP-CHANGED-SW
  2037        MOVE AL-UANON            TO GADDA
  2038     END-IF
  2039     IF MELSWL > ZERO
  2040        MOVE 'Y'                 TO MAP-CHANGED-SW
  2041        MOVE AL-UANON            TO MELSWA
  2042     END-IF
  2043     IF APCHKL > ZERO
  2044        MOVE 'Y'                 TO MAP-CHANGED-SW
  2045        MOVE AL-UANON            TO APCHKA
  2046     END-IF
  2047     IF MDACTL > ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  42
* EL6521.cbl
  2048        MOVE 'Y'                 TO MAP-CHANGED-SW
  2049        MOVE AL-UANON            TO MDACTA
  2050     END-IF
  2051     IF MDDIVL > ZERO
  2052        MOVE 'Y'                 TO MAP-CHANGED-SW
  2053        MOVE AL-UANON            TO MDDIVA
  2054     END-IF
  2055     IF MDCNTRL > ZERO
  2056        MOVE 'Y'                 TO MAP-CHANGED-SW
  2057        MOVE AL-UANON            TO MDCNTRA
  2058     END-IF
  2059     IF MDAMTL > ZERO
  2060        MOVE 'Y'                 TO MAP-CHANGED-SW
  2061        MOVE AL-UNNON            TO MDAMTA
  2062     END-IF
  2063     IF EFFDTL   GREATER THAN ZERO
  2064         MOVE 'Y'                TO MAP-CHANGED-SW
  2065         MOVE AL-UANON           TO EFFDTA.
  2066
  2067     IF TRMDTL   GREATER THAN ZERO
  2068         MOVE 'Y'                TO MAP-CHANGED-SW
  2069         MOVE AL-UANON           TO TRMDTA.
  2070
  2071     IF COMM1L   GREATER THAN ZERO
  2072         MOVE 'Y'                TO MAP-CHANGED-SW
  2073         MOVE AL-UANON           TO COMM1A.
  2074
  2075     IF COMM2L   GREATER THAN ZERO
  2076         MOVE 'Y'                TO MAP-CHANGED-SW
  2077         MOVE AL-UANON           TO COMM2A.
  2078
  2079     IF COMM3L   GREATER THAN ZERO
  2080         MOVE 'Y'                TO MAP-CHANGED-SW
  2081         MOVE AL-UANON           TO COMM3A.
  2082
  2083     IF COMM4L   GREATER THAN ZERO
  2084         MOVE 'Y'                TO MAP-CHANGED-SW
  2085         MOVE AL-UANON           TO COMM4A.
  2086
  2087     IF TRNSIT1L GREATER THAN ZERO
  2088         MOVE 'Y'                TO MAP-CHANGED-SW
  2089         MOVE AL-UABON           TO TRNSIT1A.
  2090
  2091     IF TRNSIT2L GREATER THAN ZERO
  2092         MOVE 'Y'                TO MAP-CHANGED-SW
  2093         MOVE AL-UABON           TO TRNSIT2A.
  2094
  2095     IF BKACCTL  GREATER THAN ZERO
  2096         MOVE 'Y'                TO MAP-CHANGED-SW
  2097         MOVE AL-UABON           TO BKACCTA.
  2098
  2099     IF ACTCDL   GREATER THAN ZERO
  2100         MOVE 'Y'                TO MAP-CHANGED-SW
  2101         MOVE AL-UABON           TO ACTCDA.
  2102
  2103     IF DELTOL > 0
  2104        MOVE 'Y'                 TO MAP-CHANGED-SW
  2105        MOVE AL-UANON            TO DELTOA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  43
* EL6521.cbl
  2106     END-IF
  2107     IF RGIDL > 0
  2108        MOVE 'Y'                 TO MAP-CHANGED-SW
  2109        MOVE AL-UANON            TO RGIDA
  2110     END-IF
  2111     IF MAP-NOT-CHANGED
  2112         GO TO 0100-NOT-EL611-RETURN.
  2113
  2114     GO TO 8100-SEND-INITIAL-MAP.
  2115
  2116 0100-NOT-EL611-RETURN.
  2117
  2118     IF EIBTRNID NOT = TRANS-ID
  2119         MOVE PI-MAINT           TO MAINTYPO
  2120         MOVE AL-UANON           TO MAINTYPA
  2121         MOVE -1                 TO MAINTYPL
  2122         IF PI-MAINT = 'S' OR 'C'
  2123             GO TO 4000-SHOW
  2124         ELSE
  2125             GO TO 8100-SEND-INITIAL-MAP.
  2126
  2127
  2128* EXEC CICS HANDLE CONDITION
  2129*        PGMIDERR  (9600-PGMID-ERROR)
  2130*        ERROR     (9990-ABEND)
  2131*    END-EXEC.
  2132*    MOVE '"$L.                  ! " #00002123' TO DFHEIV0
  2133     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2134     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2135     MOVE X'2220233030303032313233' TO DFHEIV0(25:11)
  2136     CALL 'kxdfhei1' USING DFHEIV0
  2137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2138
  2139
  2140     IF EIBAID = DFHCLEAR
  2141         GO TO 9400-CLEAR.
  2142
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  44
* EL6521.cbl
  2144 0200-RECEIVE.
  2145     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2146         MOVE ER-0008            TO EMI-ERROR
  2147         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2148         MOVE -1                 TO PFENTERL
  2149         GO TO 8200-SEND-DATAONLY.
  2150
  2151
  2152* EXEC CICS RECEIVE
  2153*        MAP      (MAP-NAME)
  2154*        MAPSET   (MAPSET-NAME)
  2155*        INTO     (EL6521AI)
  2156*    END-EXEC.
  2157     MOVE LENGTH OF
  2158      EL6521AI
  2159       TO DFHEIV11
  2160*    MOVE '8"T I  L              ''   #00002139' TO DFHEIV0
  2161     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2162     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2163     MOVE X'2020233030303032313339' TO DFHEIV0(25:11)
  2164     CALL 'kxdfhei1' USING DFHEIV0,
  2165           MAP-NAME,
  2166           EL6521AI,
  2167           DFHEIV11,
  2168           MAPSET-NAME,
  2169           DFHEIV99,
  2170           DFHEIV99
  2171     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2172
  2173
  2174     IF PFENTERL = 0
  2175         GO TO 0300-CHECK-PFKEYS.
  2176
  2177     IF EIBAID NOT = DFHENTER
  2178         MOVE ER-0004            TO EMI-ERROR
  2179         GO TO 0320-INPUT-ERROR.
  2180
  2181     IF (PFENTERI NUMERIC) AND (PFENTERI GREATER 0 AND LESS 25)
  2182         MOVE PF-VALUES (PFENTERI) TO EIBAID
  2183     ELSE
  2184         MOVE ER-0029              TO EMI-ERROR
  2185         GO TO 0320-INPUT-ERROR.
  2186
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  45
* EL6521.cbl
  2188
  2189 0300-CHECK-PFKEYS.
  2190     IF PI-AR-PROCESSING
  2191        IF EIBAID = DFHPF1
  2192             PERFORM 0500-WRITE-TS  THRU  0500-EXIT
  2193             MOVE XCTL-611       TO PGM-NAME
  2194             GO TO 9300-XCTL.
  2195     IF EIBAID = DFHPF2
  2196        MOVE PI-COMPANY-CD       TO PI-ERCOBI-COMPANY-CD
  2197        MOVE DELTOI              TO PI-ERCOBI-STMT-OWNER
  2198        MOVE RGIDI               TO PI-ERCOBI-RGID
  2199        PERFORM 0500-WRITE-TS    THRU 0500-EXIT
  2200        MOVE XCTL-6525           TO PGM-NAME
  2201        GO TO 9300-XCTL
  2202     END-IF
  2203     IF EIBAID = DFHPF3
  2204        PERFORM 0500-WRITE-TS    THRU 0500-EXIT
  2205        MOVE XCTL-6526           TO PGM-NAME
  2206        GO TO 9300-XCTL
  2207     END-IF
  2208     IF EIBAID = DFHPF23
  2209         GO TO 8810-PF23.
  2210     IF EIBAID = DFHPF24
  2211         GO TO 9200-RETURN-MAIN-MENU.
  2212     IF EIBAID = DFHPF12
  2213         GO TO 9500-PF12.
  2214     IF EIBAID = DFHENTER
  2215         GO TO 0330-CHECK-MAINTYP.
  2216
  2217     MOVE ER-0029                TO EMI-ERROR.
  2218 0320-INPUT-ERROR.
  2219     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2220     MOVE AL-UNBON               TO PFENTERA.
  2221     MOVE -1                     TO PFENTERL.
  2222     GO TO 8200-SEND-DATAONLY.
  2223
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  46
* EL6521.cbl
  2225 0330-CHECK-MAINTYP.
  2226
  2227     IF MAINTYPL GREATER ZERO
  2228         IF MAINTYPI = 'S' OR 'C'
  2229             MOVE AL-UANON       TO MAINTYPA
  2230             MOVE MAINTYPI       TO PI-MAINT
  2231         ELSE
  2232             MOVE -1             TO MAINTYPL
  2233             MOVE AL-UABON       TO MAINTYPA
  2234             MOVE ER-2039        TO EMI-ERROR
  2235             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2236             GO TO 8200-SEND-DATAONLY
  2237     ELSE
  2238         MOVE -1                 TO MAINTYPL
  2239         MOVE AL-UABON           TO MAINTYPA
  2240         MOVE ER-2039            TO EMI-ERROR
  2241         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2242         GO TO 8200-SEND-DATAONLY.
  2243
  2244     IF PI-MAINT = 'S'
  2245         GO TO 4000-SHOW.
  2246
  2247     GO TO 4200-MAINT.
  2248
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  47
* EL6521.cbl
  2250
  2251 0500-WRITE-TS.
  2252
  2253* EXEC CICS WRITEQ TS
  2254*         QUEUE  (QID)
  2255*         FROM   (EL6521AO)
  2256*         LENGTH (MAP-LENGTH)
  2257*    END-EXEC.
  2258*    MOVE '*"     L              ''   #00002223' TO DFHEIV0
  2259     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  2260     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2261     MOVE X'2020233030303032323233' TO DFHEIV0(25:11)
  2262     CALL 'kxdfhei1' USING DFHEIV0,
  2263           QID,
  2264           EL6521AO,
  2265           MAP-LENGTH,
  2266           DFHEIV99,
  2267           DFHEIV99,
  2268           DFHEIV99
  2269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2270
  2271
  2272 0500-EXIT.
  2273      EXIT.
  2274
  2275 0600-RECOVER-TS.
  2276
  2277* EXEC CICS READQ TS
  2278*         QUEUE  (QID)
  2279*         INTO (EL6521AO)
  2280*         LENGTH (MAP-LENGTH)
  2281*    END-EXEC.
  2282*    MOVE '*$I    L              ''   #00002233' TO DFHEIV0
  2283     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  2284     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2285     MOVE X'2020233030303032323333' TO DFHEIV0(25:11)
  2286     CALL 'kxdfhei1' USING DFHEIV0,
  2287           QID,
  2288           EL6521AO,
  2289           MAP-LENGTH,
  2290           DFHEIV99,
  2291           DFHEIV99,
  2292           DFHEIV99
  2293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2294
  2295
  2296     PERFORM 0700-DELETE-TS  THRU  0700-EXIT.
  2297
  2298 0600-EXIT.
  2299      EXIT.
  2300
  2301 0700-DELETE-TS.
  2302
  2303* EXEC CICS HANDLE CONDITION
  2304*        QIDERR (0700-EXIT)
  2305*    END-EXEC.
  2306*    MOVE '"$N                   ! # #00002245' TO DFHEIV0
  2307     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  48
* EL6521.cbl
  2308     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2309     MOVE X'2320233030303032323435' TO DFHEIV0(25:11)
  2310     CALL 'kxdfhei1' USING DFHEIV0
  2311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2312
  2313
  2314
  2315* EXEC CICS DELETEQ TS
  2316*        QUEUE (QID)
  2317*    END-EXEC.
  2318*    MOVE '*&                    #   #00002249' TO DFHEIV0
  2319     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  2320     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2321     MOVE X'2020233030303032323439' TO DFHEIV0(25:11)
  2322     CALL 'kxdfhei1' USING DFHEIV0,
  2323           QID,
  2324           DFHEIV99
  2325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2326
  2327
  2328 0700-EXIT.
  2329      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  49
* EL6521.cbl
  2331
  2332 4000-SHOW.
  2333
  2334     PERFORM 7100-READ-ERCOMP THRU 7100-EXIT.
  2335
  2336     IF EIBTRNID     = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  2337           EL6526-TRANS-ID
  2338         NEXT SENTENCE
  2339     ELSE
  2340         MOVE LOW-VALUES         TO EL6521AO.
  2341
  2342     GO TO 5000-BUILD-INITIAL-SCREEN.
  2343
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  50
* EL6521.cbl
  2345 4200-MAINT.
  2346     IF NOT MODIFY-CAP
  2347         MOVE 'UPDATE'           TO SM-READ
  2348         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  2349         MOVE ER-0070            TO EMI-ERROR
  2350         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2351         GO TO 8100-SEND-INITIAL-MAP.
  2352
  2353     MOVE 'N'                     TO SUPPRESS-MAP-SW.
  2354     PERFORM 7100-READ-ERCOMP THRU 7100-EXIT.
  2355
  2356     IF EMI-NO-ERRORS
  2357         NEXT SENTENCE
  2358     ELSE
  2359       IF EIBTRNID     = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  2360              EL6526-TRANS-ID
  2361           GO TO 8100-SEND-INITIAL-MAP
  2362       ELSE
  2363           GO TO 8200-SEND-DATAONLY.
  2364
  2365     PERFORM 7000-EDIT THRU 7099-EXIT.
  2366
  2367     IF EMI-NO-ERRORS
  2368         NEXT SENTENCE
  2369     ELSE
  2370       IF EIBTRNID     = EL611-TRANS-ID OR EL6525-TRANS-ID OR
  2371             EL6526-TRANS-ID
  2372           GO TO 8100-SEND-INITIAL-MAP
  2373       ELSE
  2374           GO TO 8200-SEND-DATAONLY.
  2375
  2376     MOVE ER-0000               TO EMI-ERROR
  2377     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2378
  2379     PERFORM 7300-READ-ERCOMP-UPDATE THRU 7300-EXIT.
  2380
  2381     PERFORM 6000-CHECK-FOR-UPDATE   THRU 6049-EXIT.
  2382
  2383     MOVE PI-PROCESSOR-ID        TO CO-LAST-MAINT-USER.
  2384     MOVE EIBTIME                TO CO-LAST-MAINT-HHMMSS.
  2385     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2386     MOVE '5'                    TO DC-OPTION-CODE.
  2387     PERFORM 9700-DATE-CONVERT THRU 9700-EXIT.
  2388
  2389     MOVE DC-BIN-DATE-1          TO CO-LAST-MAINT-DT.
  2390
  2391     PERFORM 5500-PROCESS-ELACHP THRU 5599-PROCESS-EXIT
  2392     PERFORM 6100-CHECK-BILL-INSTR
  2393                                 THRU 6100-EXIT
  2394
  2395
  2396* EXEC CICS REWRITE
  2397*        DATASET  (ERCOMP-FILE-ID)
  2398*        FROM     (COMPENSATION-MASTER)
  2399*    END-EXEC.
  2400     MOVE LENGTH OF
  2401      COMPENSATION-MASTER
  2402       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  51
* EL6521.cbl
  2403*    MOVE '&& L                  %   #00002320' TO DFHEIV0
  2404     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2405     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2406     MOVE X'2020233030303032333230' TO DFHEIV0(25:11)
  2407     CALL 'kxdfhei1' USING DFHEIV0,
  2408           ERCOMP-FILE-ID,
  2409           COMPENSATION-MASTER,
  2410           DFHEIV11,
  2411           DFHEIV99
  2412     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2413
  2414
  2415     PERFORM 7100-READ-ERCOMP THRU 7100-EXIT.
  2416     MOVE LOW-VALUES             TO EL6521AO.
  2417     MOVE 'C'                    TO PI-MAINT.
  2418
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  52
* EL6521.cbl
  2420
  2421 5000-BUILD-INITIAL-SCREEN.
  2422     MOVE CO-CARRIER             TO CARRIERO.
  2423     MOVE CO-GROUPING            TO GROUPO.
  2424     MOVE CO-TYPE                TO TYPEO.
  2425     MOVE CO-RESP-NO             TO FINRESPO.
  2426     MOVE CO-CTL-2               TO COACCTO.
  2427     MOVE CO-GA-STATUS-CODE      TO STATO.
  2428     IF CO-GA-STATUS-CODE = 'A' OR 'I' OR 'P'
  2429         MOVE CO-GA-STATUS-CODE  TO STATO
  2430         MOVE AL-UANON           TO STATA
  2431         MOVE +1                 TO STATL
  2432     ELSE
  2433         MOVE AL-UANOF           TO STATA
  2434     END-IF
  2435     IF CO-GA-WITHOLD-PCT NOT NUMERIC
  2436        MOVE ZEROS               TO CO-GA-WITHOLD-PCT
  2437     END-IF
  2438     MOVE CO-GA-WITHOLD-PCT      TO WTHLDO
  2439     IF CO-GA-WITHOLD-PCT NOT = ZEROS
  2440        MOVE +3                  TO WTHLDL
  2441        MOVE AL-UANON            TO WTHLDA
  2442     END-IF
  2443     IF CO-GA-DIRECT-DEP = 'Y'
  2444        MOVE 'Y'                 TO GADDO
  2445        MOVE AL-UANON            TO GADDA
  2446        MOVE +1                  TO GADDL
  2447     ELSE
  2448        MOVE 'N'                 TO GADDO
  2449        MOVE AL-UANON            TO GADDA
  2450        MOVE +1                  TO GADDL
  2451     END-IF
  2452     IF CO-DELIVER-CK-TO-MEL = 'Y'
  2453        MOVE 'Y'                 TO MELSWO
  2454        MOVE AL-UANON            TO MELSWA
  2455        MOVE +1                  TO MELSWL
  2456     ELSE
  2457        MOVE 'N'                 TO MELSWO
  2458        MOVE AL-UANON            TO MELSWA
  2459        MOVE +1                  TO MELSWL
  2460     END-IF
  2461     IF CO-CREATE-AP-CHECK = 'Y'
  2462        MOVE 'Y'                 TO APCHKO
  2463        MOVE AL-UANON            TO APCHKA
  2464        MOVE +1                  TO APCHKL
  2465     ELSE
  2466        MOVE 'N'                 TO APCHKO
  2467        MOVE AL-UANON            TO APCHKA
  2468        MOVE +1                  TO APCHKL
  2469     END-IF
  2470     IF CO-MD-GL-ACCT = SPACES OR LOW-VALUES
  2471        MOVE AL-UANOF            TO MDACTA
  2472     ELSE
  2473        MOVE CO-MD-GL-ACCT       TO MDACTO
  2474        MOVE +2                  TO MDACTL
  2475        MOVE AL-UANON            TO MDACTA
  2476     END-IF
  2477     IF CO-MD-DIV = SPACES OR LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  53
* EL6521.cbl
  2478        MOVE AL-UANOF            TO MDDIVA
  2479     ELSE
  2480        MOVE CO-MD-DIV           TO MDDIVO
  2481        MOVE AL-UANON            TO MDDIVA
  2482     END-IF
  2483     IF CO-MD-CENTER = SPACES OR LOW-VALUES
  2484        MOVE AL-UANOF            TO MDCNTRA
  2485     ELSE
  2486        MOVE CO-MD-CENTER        TO MDCNTRO
  2487        MOVE +2                  TO MDCNTRL
  2488        MOVE AL-UANON            TO MDCNTRA
  2489     END-IF
  2490     IF CO-MD-AMT NOT NUMERIC
  2491        MOVE ZEROS               TO CO-MD-AMT
  2492     END-IF
  2493     MOVE CO-MD-AMT              TO MDAMTO
  2494     IF CO-MD-AMT NOT = ZEROS
  2495        MOVE +3                  TO MDAMTL
  2496        MOVE AL-UANON            TO MDAMTA
  2497     END-IF
  2498     MOVE ZEROS                  TO MDLOBO
  2499                                    MDSTO
  2500     IF CO-GA-EFFECTIVE-DT = LOW-VALUES OR SPACES
  2501         MOVE AL-UANOF           TO EFFDTA
  2502     ELSE
  2503         MOVE CO-GA-EFFECTIVE-DT TO DC-BIN-DATE-1
  2504         MOVE ' '                TO DC-OPTION-CODE
  2505         PERFORM 9700-DATE-CONVERT THRU 9700-EXIT
  2506         MOVE DC-GREG-DATE-1-EDIT
  2507                                 TO EFFDTO
  2508         MOVE AL-UANON           TO EFFDTA
  2509         MOVE +8                 TO EFFDTL.
  2510
  2511     IF CO-GA-TERMINATION-DT = HIGH-VALUES
  2512        MOVE '99/99/99'          TO TRMDTO
  2513        MOVE AL-UANON            TO TRMDTA
  2514     ELSE
  2515        IF CO-GA-TERMINATION-DT = LOW-VALUES OR SPACES
  2516            MOVE AL-UANOF        TO TRMDTA
  2517        ELSE
  2518           MOVE CO-GA-TERMINATION-DT
  2519                                 TO DC-BIN-DATE-1
  2520           MOVE ' '              TO DC-OPTION-CODE
  2521           PERFORM 9700-DATE-CONVERT
  2522                                 THRU 9700-EXIT
  2523           MOVE DC-GREG-DATE-1-EDIT
  2524                                 TO TRMDTO
  2525           MOVE AL-UANON         TO TRMDTA
  2526           MOVE +8               TO TRMDTL
  2527        END-IF
  2528     END-IF
  2529
  2530     IF CO-GA-COMMENT-1 = LOW-VALUES OR SPACES
  2531         MOVE AL-UANOF            TO COMM1A
  2532     ELSE
  2533         MOVE CO-GA-COMMENT-1    TO COMM1O
  2534         MOVE AL-UANON           TO COMM1A
  2535         MOVE +40                TO COMM1L.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  54
* EL6521.cbl
  2536
  2537     IF CO-GA-COMMENT-2 = LOW-VALUES OR SPACES
  2538         MOVE AL-UANOF            TO COMM2A
  2539     ELSE
  2540         MOVE CO-GA-COMMENT-2    TO COMM2O
  2541         MOVE AL-UANON           TO COMM2A
  2542         MOVE +40                TO COMM2L.
  2543
  2544     IF CO-GA-COMMENT-3 = LOW-VALUES OR SPACES
  2545         MOVE AL-UANOF           TO COMM3A
  2546     ELSE
  2547         MOVE CO-GA-COMMENT-3    TO COMM3O
  2548         MOVE AL-UANON           TO COMM3A
  2549         MOVE +40                TO COMM3L.
  2550
  2551     IF CO-GA-COMMENT-4 = LOW-VALUES OR SPACES
  2552         MOVE AL-UANOF           TO COMM4A
  2553     ELSE
  2554         MOVE CO-GA-COMMENT-4    TO COMM4O
  2555         MOVE AL-UANON           TO COMM4A
  2556         MOVE +40                TO COMM4L.
  2557
  2558     IF PI-COMPANY-ID = 'CID' OR 'DCC' OR 'AHL' or 'VPP'
  2559           or 'FNL'
  2560        CONTINUE
  2561     ELSE
  2562        IF (CO-BANK-TRANSIT-NO (1:4) = LOW-VALUES OR SPACES) AND
  2563           (CO-BANK-TRANSIT-NO (5:4) = LOW-VALUES OR SPACES)
  2564            MOVE AL-UANOF        TO TRNSIT1A
  2565            MOVE AL-UANOF        TO TRNSIT2A
  2566        ELSE
  2567           MOVE CO-BANK-TRANSIT-NO (1:4)
  2568                                 TO PI-BANK-TRANSIT-NUMBER (2:4)
  2569                                    TRNSIT1O
  2570           MOVE CO-BANK-TRANSIT-NO (5:4)
  2571                                 TO PI-BANK-TRANSIT-NUMBER (6:4)
  2572                                    TRNSIT2O
  2573        END-IF
  2574        IF CO-BANK-ACCOUNT-NUMBER = LOW-VALUES OR SPACES
  2575           MOVE AL-UANOF         TO BKACCTA
  2576        ELSE
  2577           MOVE CO-BANK-ACCOUNT-NUMBER
  2578                                 TO PI-BANK-ACCOUNT-NO
  2579                                    BKACCTO
  2580        END-IF
  2581     END-IF
  2582     MOVE    '       '           TO CRSTATO.
  2583
  2584     MOVE CO-ACH-STATUS          TO PI-BANK-ACTION-CODE.
  2585
  2586     IF CO-ACH-STATUS IS EQUAL      'P'
  2587        MOVE 'PENDING'           TO CRSTATO.
  2588
  2589     IF CO-ACH-STATUS IS EQUAL      'A'
  2590        MOVE 'ACTIVE '           TO CRSTATO.
  2591     IF CO-STMT-OWNER NOT = SPACES AND LOW-VALUES
  2592        MOVE CO-STMT-OWNER       TO DELTOO
  2593        MOVE AL-UANON            TO DELTOA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  55
* EL6521.cbl
  2594        MOVE +4                  TO DELTOL
  2595     ELSE
  2596        MOVE AL-UANOF            TO DELTOA
  2597     END-IF
  2598     IF CO-REPORT-GROUP-ID NOT = SPACES AND LOW-VALUES
  2599        MOVE CO-REPORT-GROUP-ID  TO RGIDO
  2600        MOVE AL-UANON            TO RGIDA
  2601        MOVE +12                 TO RGIDL
  2602     ELSE
  2603        MOVE AL-UANOF            TO RGIDA
  2604     END-IF
  2605     MOVE PI-MAINT               TO MAINTYPO.
  2606     MOVE AL-UANOF               TO MAINTYPA.
  2607     MOVE -1                     TO MAINTYPL.
  2608
  2609     GO TO 8100-SEND-INITIAL-MAP.
  2610
  2611 5099-EXIT.
  2612     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  56
* EL6521.cbl
  2614 5500-PROCESS-ELACHP.
  2615
  2616     IF ACTCDI = 'D'
  2617        PERFORM 7400-DELETE-PRE-NOTE THRU 7499-EXIT
  2618        MOVE SPACES              TO CO-BANK-INFORMATION
  2619                                    CO-ACH-STATUS
  2620        GO TO 5599-PROCESS-EXIT.
  2621
  2622     IF ACTCDI = 'C'
  2623         PERFORM 7400-DELETE-PRE-NOTE THRU 7499-EXIT
  2624         PERFORM 7600-WRITE-ELACHP THRU 7620-WRITE-EXIT
  2625         MOVE WS-BANK-DATA       TO CO-BANK-INFORMATION
  2626         MOVE WS-BKACCTI         TO CO-BANK-ACCOUNT-NUMBER
  2627         MOVE 'P'                TO CO-ACH-STATUS
  2628         GO TO 5599-PROCESS-EXIT.
  2629
  2630     IF ACTCDI =  'N'
  2631         PERFORM 7600-WRITE-ELACHP THRU 7620-WRITE-EXIT
  2632         MOVE WS-BANK-DATA       TO CO-BANK-INFORMATION
  2633         MOVE WS-BKACCTI         TO CO-BANK-ACCOUNT-NUMBER
  2634         MOVE 'P'                TO CO-ACH-STATUS  WS-ACTCDI
  2635         GO TO 5599-PROCESS-EXIT.
  2636
  2637     IF ACTCDI = 'A'
  2638         MOVE 'A'                TO CO-ACH-STATUS  WS-ACTCDI
  2639         GO TO 5599-PROCESS-EXIT.
  2640
  2641 5599-PROCESS-EXIT.
  2642
  2643     EXIT.
  2644 6000-CHECK-FOR-UPDATE.
  2645     IF STATL GREATER ZERO
  2646        MOVE STATI               TO CO-GA-STATUS-CODE.
  2647
  2648     IF EFFDTL GREATER ZERO
  2649        MOVE WS-SAVE-BIN-EFFDT   TO CO-GA-EFFECTIVE-DT.
  2650
  2651     IF TRMDTL GREATER ZERO
  2652        MOVE WS-SAVE-BIN-TRMDT   TO CO-GA-TERMINATION-DT.
  2653
  2654     IF GADDL > ZERO
  2655        MOVE GADDI               TO CO-GA-DIRECT-DEP
  2656     END-IF
  2657     IF MELSWL > ZERO
  2658        MOVE MELSWI              TO CO-DELIVER-CK-TO-MEL
  2659     END-IF
  2660     IF APCHKL > ZERO
  2661        MOVE APCHKI              TO CO-CREATE-AP-CHECK
  2662     END-IF
  2663     IF MDACTL > ZERO
  2664        MOVE MDACTI              TO CO-MD-GL-ACCT
  2665     END-IF
  2666     IF MDDIVL > ZERO
  2667        MOVE MDDIVI              TO CO-MD-DIV
  2668     END-IF
  2669     IF MDCNTRL > ZERO
  2670        MOVE MDCNTRI             TO CO-MD-CENTER
  2671     END-IF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  57
* EL6521.cbl
  2672     IF WTHLDL > ZERO
  2673        MOVE WTHLDI              TO CO-GA-WITHOLD-PCT
  2674     END-IF
  2675     IF MDAMTL > ZERO
  2676        MOVE MDAMTI              TO CO-MD-AMT
  2677     END-IF
  2678     IF DELTOL > ZERO
  2679        MOVE DELTOI              TO CO-STMT-OWNER
  2680     END-IF
  2681     IF RGIDL > ZERO
  2682        MOVE RGIDI               TO CO-REPORT-GROUP-ID
  2683     END-IF
  2684     IF COMM1L GREATER ZERO
  2685        MOVE COMM1I              TO CO-GA-COMMENT-1.
  2686
  2687     IF COMM2L GREATER ZERO
  2688        MOVE COMM2I              TO CO-GA-COMMENT-2.
  2689
  2690     IF COMM3L GREATER ZERO
  2691        MOVE COMM3I              TO CO-GA-COMMENT-3.
  2692
  2693     IF COMM4L GREATER ZERO
  2694        MOVE COMM4I              TO CO-GA-COMMENT-4.
  2695
  2696 6049-EXIT.
  2697     EXIT.
  2698 6100-CHECK-BILL-INSTR.
  2699     MOVE PI-COMPANY-CD          TO ERCOBI-COMPANY-CD
  2700     MOVE DELTOI                 TO ERCOBI-STMT-OWNER
  2701     MOVE RGIDI                  TO ERCOBI-RGID
  2702
  2703* EXEC CICS READ
  2704*       DATASET (ERCOBI-FILE-ID)
  2705*       SET     (ADDRESS OF COMP-BILLING-INSTRUCTIONS)
  2706*       RIDFLD  (ERCOBI-KEY)
  2707*       RESP    (WS-RESPONSE)
  2708*       UPDATE
  2709*    END-EXEC
  2710*    MOVE '&"S        EU         (  N#00002612' TO DFHEIV0
  2711     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2712     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2713     MOVE X'204E233030303032363132' TO DFHEIV0(25:11)
  2714     CALL 'kxdfhei1' USING DFHEIV0,
  2715           ERCOBI-FILE-ID,
  2716           DFHEIV20,
  2717           DFHEIV99,
  2718           ERCOBI-KEY,
  2719           DFHEIV99,
  2720           DFHEIV99,
  2721           DFHEIV99
  2722     SET ADDRESS OF COMP-BILLING-INSTRUCTIONS TO
  2723         DFHEIV20
  2724     MOVE EIBRESP  TO WS-RESPONSE
  2725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2726     IF NOT RESP-NORMAL
  2727        MOVE AL-UABON            TO DELTOA
  2728                                    RGIDA
  2729        MOVE ER-2797             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  58
* EL6521.cbl
  2730        MOVE -1                  TO DELTOL
  2731        PERFORM 9900-ERROR-FORMAT
  2732                                 THRU 9900-EXIT
  2733     END-IF
  2734     .
  2735 6100-EXIT.
  2736     EXIT.
  2737
  2738 7000-EDIT.
  2739     IF STATL GREATER ZERO
  2740         IF STATI = 'A' OR 'I' OR 'P'
  2741             NEXT SENTENCE
  2742          ELSE
  2743             MOVE -1             TO STATL
  2744             MOVE AL-UABON       TO STATA
  2745             MOVE ER-7438        TO EMI-ERROR
  2746             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2747
  2748     MOVE LOW-VALUES             TO WS-SAVE-BIN-EFFDT.
  2749     MOVE LOW-VALUES             TO WS-SAVE-BIN-TRMDT.
  2750
  2751     IF EFFDTL NOT = ZERO
  2752         MOVE EFFDTI             TO DEEDIT-FIELD
  2753         PERFORM 8600-DEEDIT
  2754         MOVE DEEDIT-FIELD-V0    TO DC-GREG-DATE-1-MDY
  2755         MOVE '4'                TO DC-OPTION-CODE
  2756         PERFORM 9700-DATE-CONVERT THRU 9700-EXIT
  2757         IF DATE-CONVERSION-ERROR
  2758             MOVE ER-0348        TO EMI-ERROR
  2759             MOVE -1             TO EFFDTL
  2760             MOVE AL-UABON       TO EFFDTA
  2761             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2762         ELSE
  2763             MOVE DC-GREG-DATE-1-EDIT  TO EFFDTI
  2764             MOVE AL-UANON             TO EFFDTA
  2765             MOVE DC-BIN-DATE-1        TO WS-SAVE-BIN-EFFDT.
  2766
  2767     IF TRMDTL NOT = ZERO
  2768        MOVE TRMDTI              TO DEEDIT-FIELD
  2769        PERFORM 8600-DEEDIT
  2770        MOVE DEEDIT-FIELD-V0     TO DC-GREG-DATE-1-MDY
  2771        IF DC-GREG-DATE-1-MDY = 999999
  2772           MOVE HIGH-VALUES      TO WS-SAVE-BIN-TRMDT
  2773        ELSE
  2774           MOVE '4'              TO DC-OPTION-CODE
  2775           PERFORM 9700-DATE-CONVERT
  2776                                 THRU 9700-EXIT
  2777           IF DATE-CONVERSION-ERROR
  2778              MOVE ER-0454       TO EMI-ERROR
  2779              MOVE -1            TO TRMDTL
  2780              MOVE AL-UABON      TO TRMDTA
  2781              PERFORM 9900-ERROR-FORMAT
  2782                                 THRU 9900-EXIT
  2783           ELSE
  2784              MOVE DC-GREG-DATE-1-EDIT
  2785                                 TO TRMDTI
  2786              MOVE AL-UANON      TO TRMDTA
  2787              MOVE DC-BIN-DATE-1 TO WS-SAVE-BIN-TRMDT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  59
* EL6521.cbl
  2788           END-IF
  2789        END-IF
  2790     END-IF
  2791     IF GADDL > ZERO
  2792        IF GADDI = 'Y' OR 'N' OR ' '
  2793           MOVE AL-UANON         TO GADDA
  2794        ELSE
  2795           MOVE AL-UABON         TO GADDA
  2796           MOVE ER-0876          TO EMI-ERROR
  2797           MOVE -1               TO GADDL
  2798           PERFORM 9900-ERROR-FORMAT
  2799                                 THRU 9900-EXIT
  2800        END-IF
  2801     END-IF
  2802     IF MELSWL > ZERO
  2803        IF MELSWI = 'Y' OR 'N' OR ' '
  2804           MOVE AL-UANON         TO MELSWA
  2805        ELSE
  2806           MOVE AL-UABON         TO MELSWA
  2807           MOVE ER-0876          TO EMI-ERROR
  2808           MOVE -1               TO MELSWL
  2809           PERFORM 9900-ERROR-FORMAT
  2810                                 THRU 9900-EXIT
  2811        END-IF
  2812     END-IF
  2813     IF APCHKL > ZERO
  2814        IF APCHKI = 'Y' OR 'N' OR ' '
  2815           MOVE AL-UANON         TO APCHKA
  2816        ELSE
  2817           MOVE AL-UABON         TO APCHKA
  2818           MOVE ER-0876          TO EMI-ERROR
  2819           MOVE -1               TO APCHKL
  2820           PERFORM 9900-ERROR-FORMAT
  2821                                 THRU 9900-EXIT
  2822        END-IF
  2823     END-IF
  2824     IF WTHLDL  > ZERO
  2825
  2826* EXEC CICS BIF
  2827*          DEEDIT
  2828*          FIELD   (WTHLDI)
  2829*          LENGTH  (6)
  2830*       END-EXEC
  2831     MOVE 6
  2832       TO DFHEIV11
  2833*    MOVE '@"L                   #   #00002718' TO DFHEIV0
  2834     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2835     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2836     MOVE X'2020233030303032373138' TO DFHEIV0(25:11)
  2837     CALL 'kxdfhei1' USING DFHEIV0,
  2838           WTHLDI,
  2839           DFHEIV11
  2840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2841        IF WTHLDI NUMERIC
  2842           MOVE AL-UNNON         TO WTHLDA
  2843        ELSE
  2844           MOVE -1               TO WTHLDL
  2845           MOVE AL-UABON         TO WTHLDA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  60
* EL6521.cbl
  2846           MOVE ER-8799          TO EMI-ERROR
  2847           PERFORM 9900-ERROR-FORMAT
  2848                                 THRU  9900-EXIT
  2849        END-IF
  2850     END-IF
  2851     IF MDAMTL  > ZERO
  2852
  2853* EXEC CICS BIF
  2854*          DEEDIT
  2855*          FIELD   (MDAMTI)
  2856*          LENGTH  (8)
  2857*       END-EXEC
  2858     MOVE 8
  2859       TO DFHEIV11
  2860*    MOVE '@"L                   #   #00002734' TO DFHEIV0
  2861     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2862     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2863     MOVE X'2020233030303032373334' TO DFHEIV0(25:11)
  2864     CALL 'kxdfhei1' USING DFHEIV0,
  2865           MDAMTI,
  2866           DFHEIV11
  2867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2868        IF MDAMTI NUMERIC
  2869           MOVE AL-UNNON         TO MDAMTA
  2870        ELSE
  2871           MOVE -1               TO MDAMTL
  2872           MOVE AL-UABON         TO MDAMTA
  2873           MOVE ER-8799          TO EMI-ERROR
  2874           PERFORM 9900-ERROR-FORMAT
  2875                                 THRU  9900-EXIT
  2876        END-IF
  2877     END-IF
  2878     IF WS-SAVE-BIN-EFFDT = LOW-VALUES OR
  2879        WS-SAVE-BIN-TRMDT = LOW-VALUES
  2880         NEXT SENTENCE
  2881       ELSE
  2882         IF WS-SAVE-BIN-TRMDT LESS THAN WS-SAVE-BIN-EFFDT
  2883             MOVE ER-1228        TO EMI-ERROR
  2884             MOVE -1             TO EFFDTL
  2885             MOVE AL-UABON       TO EFFDTA
  2886             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2887
  2888      IF ((DELTOL > +0)
  2889         OR (RGIDL > +0))
  2890         AND ((DELTOI NOT = SPACES)
  2891         AND (RGIDI NOT = SPACES))
  2892         PERFORM 6100-CHECK-BILL-INSTR
  2893                                 THRU 6100-EXIT
  2894      END-IF
  2895     MOVE SPACES                 TO WS-BANK-INFORMATION.
  2896
  2897     IF PI-AR-PROCESSING
  2898        NEXT SENTENCE
  2899     ELSE
  2900        MOVE ZEROS               TO ACTCDL, TRNSIT1L TRNSIT2L
  2901                                    BKACCTL
  2902        GO TO 7099-EXIT.
  2903
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  61
* EL6521.cbl
  2904     IF (TRNSIT1L NOT = ZERO) OR
  2905        (TRNSIT2L NOT = ZERO) OR
  2906        (BKACCTL  NOT = ZERO) OR
  2907        (ACTCDL   NOT = ZERO)
  2908         MOVE 'Y'                TO WS-ACH-SW
  2909     ELSE
  2910         GO TO 7099-EXIT.
  2911
  2912     IF (ACTCDL = ZERO) OR
  2913        (ACTCDI NOT = 'N' AND 'C' AND 'A' AND 'D')
  2914         MOVE -1                 TO ACTCDL
  2915         MOVE AL-UABON           TO ACTCDA
  2916         MOVE ER-7436            TO EMI-ERROR
  2917         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2918         GO TO 7099-EXIT.
  2919
  2920     IF ACTCDI = 'N'
  2921         GO TO 7020-NEW-ACH.
  2922
  2923     IF ACTCDI = 'C'
  2924         GO TO 7040-CHANGE-ACH.
  2925
  2926     IF ACTCDI = 'A'
  2927         GO TO 7060-ACTIVATE-ACH.
  2928
  2929****   ACH DELETE PROCESSING EDITS
  2930
  2931     IF TRNSIT1L NOT = ZERO OR
  2932        TRNSIT2L NOT = ZERO OR
  2933        BKACCTL  NOT = ZERO
  2934         MOVE -1                 TO ACTCDL
  2935         MOVE AL-UABON           TO ACTCDA
  2936         MOVE ER-7430            TO EMI-ERROR
  2937         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2938
  2939     GO TO 7099-EXIT.
  2940
  2941****   ACH NEW ENTRY PROCESSING EDITS
  2942 7020-NEW-ACH.
  2943
  2944     IF CO-ACH-STATUS = 'A' OR 'P'
  2945         MOVE -1                 TO ACTCDL
  2946         MOVE AL-UABON           TO ACTCDA
  2947         MOVE ER-7434            TO EMI-ERROR
  2948         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2949         GO TO 7099-EXIT.
  2950
  2951     IF TRNSIT1L = ZERO OR
  2952        TRNSIT2L = ZERO OR
  2953        BKACCTL = ZERO
  2954         MOVE -1                 TO TRNSIT1L
  2955         MOVE ER-7431            TO EMI-ERROR
  2956         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2957         GO TO 7099-EXIT.
  2958
  2959     IF TRNSIT1L GREATER THAN ZERO
  2960         IF TRNSIT1I = SPACES
  2961             MOVE -1             TO TRNSIT1L
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  62
* EL6521.cbl
  2962             MOVE ER-7435        TO EMI-ERROR
  2963             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2964             GO TO 7099-EXIT
  2965         ELSE
  2966             MOVE TRNSIT1I       TO WS-TRANSIT1.
  2967
  2968     IF TRNSIT2L GREATER THAN ZERO
  2969         IF TRNSIT2I = SPACES
  2970             MOVE -1             TO TRNSIT2L
  2971             MOVE ER-7435        TO EMI-ERROR
  2972             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2973             GO TO 7099-EXIT
  2974         ELSE
  2975             MOVE TRNSIT2I       TO WS-TRANSIT2.
  2976
  2977     IF BKACCTL GREATER THAN ZERO
  2978         IF BKACCTI = SPACES
  2979             MOVE -1             TO BKACCTL
  2980             MOVE ER-7435        TO EMI-ERROR
  2981             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2982             GO TO 7099-EXIT
  2983         ELSE
  2984             MOVE BKACCTI        TO WS-BKACCTI.
  2985         MOVE BKACCTI            TO WS-BKACCTI.
  2986
  2987     PERFORM 7500-VALIDATE-TRANSIT  THRU  7500-VALIDATE-EXIT.
  2988
  2989     GO TO 7099-EXIT.
  2990
  2991****   ACH CHANGE ENTRY PROCESSING EDITS
  2992 7040-CHANGE-ACH.
  2993
  2994     IF (TRNSIT1L = ZERO) AND
  2995        (TRNSIT2L = ZERO) AND
  2996        (BKACCTL = ZERO)
  2997         MOVE -1                 TO TRNSIT1L
  2998         MOVE ER-7435            TO EMI-ERROR
  2999         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3000         GO TO 7099-EXIT.
  3001
  3002     IF CO-BANK-INFORMATION = SPACES OR LOW-VALUES
  3003         MOVE -1                 TO ACTCDL
  3004         MOVE ER-7432            TO EMI-ERROR
  3005         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3006         GO TO 7099-EXIT.
  3007
  3008     MOVE CO-BANK-INFORMATION    TO WS-BANK-INFORMATION.
  3009
  3010     IF TRNSIT1L GREATER THAN ZERO
  3011         IF TRNSIT1I = SPACES
  3012             MOVE -1             TO TRNSIT1L
  3013             MOVE ER-7435        TO EMI-ERROR
  3014             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3015             GO TO 7099-EXIT
  3016         ELSE
  3017             MOVE TRNSIT1I       TO WS-TRANSIT1.
  3018
  3019     IF TRNSIT2L GREATER THAN ZERO
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  63
* EL6521.cbl
  3020         IF TRNSIT2I = SPACES
  3021             MOVE -1             TO TRNSIT2L
  3022             MOVE ER-7435        TO EMI-ERROR
  3023             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3024             GO TO 7099-EXIT
  3025         ELSE
  3026             MOVE TRNSIT2I       TO WS-TRANSIT2.
  3027
  3028     IF BKACCTL GREATER THAN ZERO
  3029         IF BKACCTI = SPACES
  3030             MOVE -1             TO BKACCTL
  3031             MOVE ER-7435        TO EMI-ERROR
  3032             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3033             GO TO 7099-EXIT
  3034         ELSE
  3035             MOVE BKACCTI        TO WS-BKACCTI.
  3036
  3037     IF CO-BANK-INFORMATION = WS-BANK-INFORMATION
  3038         MOVE -1                 TO ACTCDL
  3039         MOVE ER-7449            TO EMI-ERROR
  3040         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3041         GO TO 7099-EXIT.
  3042
  3043     IF TRNSIT1L GREATER THAN ZERO OR
  3044        TRNSIT2L GREATER THAN ZERO
  3045         PERFORM 7500-VALIDATE-TRANSIT  THRU  7500-VALIDATE-EXIT.
  3046
  3047     GO TO 7099-EXIT.
  3048
  3049****   ACH ACTIVATE ENTRY PROCESSING EDITS
  3050 7060-ACTIVATE-ACH.
  3051
  3052     IF NOT CO-ACH-PENDING
  3053         MOVE -1                 TO ACTCDL
  3054         MOVE ER-7465            TO EMI-ERROR
  3055         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3056         GO TO 7099-EXIT.
  3057
  3058     IF TRNSIT1L NOT = ZERO OR
  3059        TRNSIT2L NOT = ZERO OR
  3060        BKACCTL  NOT = ZERO
  3061         MOVE -1                 TO ACTCDL
  3062         MOVE ER-7440            TO EMI-ERROR
  3063         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3064         GO TO 7099-EXIT.
  3065
  3066 7099-EXIT.
  3067     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  64
* EL6521.cbl
  3069
  3070 7100-READ-ERCOMP.
  3071
  3072
  3073* EXEC CICS HANDLE CONDITION
  3074*        NOTOPEN (7100-NOTOPEN)
  3075*        NOTFND  (7100-NOTFND)
  3076*    END-EXEC.
  3077*    MOVE '"$JI                  ! $ #00002943' TO DFHEIV0
  3078     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  3079     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3080     MOVE X'2420233030303032393433' TO DFHEIV0(25:11)
  3081     CALL 'kxdfhei1' USING DFHEIV0
  3082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3083
  3084
  3085
  3086* EXEC CICS READ
  3087*         DATASET  (ERCOMP-FILE-ID)
  3088*         SET      (ADDRESS OF COMPENSATION-MASTER)
  3089*         RIDFLD   (PI-ERCOMP-KEY)
  3090*    END-EXEC.
  3091*    MOVE '&"S        E          (   #00002948' TO DFHEIV0
  3092     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3093     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3094     MOVE X'2020233030303032393438' TO DFHEIV0(25:11)
  3095     CALL 'kxdfhei1' USING DFHEIV0,
  3096           ERCOMP-FILE-ID,
  3097           DFHEIV20,
  3098           DFHEIV99,
  3099           PI-ERCOMP-KEY,
  3100           DFHEIV99,
  3101           DFHEIV99,
  3102           DFHEIV99
  3103     SET ADDRESS OF COMPENSATION-MASTER TO
  3104         DFHEIV20
  3105     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3106
  3107
  3108*    PERFORM 7200-READ-ERCOBI    THRU 7200-EXIT
  3109     IF DO-NOT-MOVE-TO-MAP
  3110        MOVE 'Y'                 TO SUPPRESS-MAP-SW
  3111        GO TO 7100-EXIT.
  3112
  3113     MOVE CO-LAST-MAINT-USER     TO PI-UPDATE-BY.
  3114     MOVE CO-LAST-MAINT-HHMMSS   TO PI-UPDATE-HHMMSS.
  3115     MOVE CO-CONTROL-PRIMARY     TO PI-ERCOMP-KEY.
  3116     MOVE CO-CARRIER             TO CARRIERO.
  3117     MOVE CO-GROUPING            TO GROUPO.
  3118     MOVE CO-TYPE                TO TYPEO.
  3119     MOVE CO-RESP-NO             TO FINRESPO.
  3120     MOVE CO-CTL-2               TO COACCTO.
  3121     MOVE CO-BANK-INFORMATION    TO PI-BANK-TRANSIT-NUMBER (2:8)
  3122     MOVE PI-FEDERAL-NUMBER      TO TRNSIT1O.
  3123     MOVE PI-BANK-NUMBER         TO TRNSIT2O.
  3124     GO TO 7100-EXIT.
  3125
  3126 7100-NOTFND.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  65
* EL6521.cbl
  3127     MOVE ER-7462               TO EMI-ERROR
  3128     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3129     GO TO 7100-EXIT.
  3130
  3131 7100-NOTOPEN.
  3132     MOVE ER-2233               TO EMI-ERROR
  3133     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3134     GO TO 7100-EXIT.
  3135
  3136 7100-EXIT.
  3137     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  66
* EL6521.cbl
  3139
  3140 7200-READ-ERCOBI.
  3141     MOVE CO-CONTROL-PRIMARY     TO ERCOBI-KEY
  3142
  3143* EXEC CICS READ
  3144*       DATASET (ERCOBI-FILE-ID)
  3145*       SET     (ADDRESS OF COMP-BILLING-INSTRUCTIONS)
  3146*       RIDFLD  (ERCOBI-KEY)
  3147*       RESP    (WS-RESPONSE)
  3148*    END-EXEC
  3149*    MOVE '&"S        E          (  N#00002988' TO DFHEIV0
  3150     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3151     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3152     MOVE X'204E233030303032393838' TO DFHEIV0(25:11)
  3153     CALL 'kxdfhei1' USING DFHEIV0,
  3154           ERCOBI-FILE-ID,
  3155           DFHEIV20,
  3156           DFHEIV99,
  3157           ERCOBI-KEY,
  3158           DFHEIV99,
  3159           DFHEIV99,
  3160           DFHEIV99
  3161     SET ADDRESS OF COMP-BILLING-INSTRUCTIONS TO
  3162         DFHEIV20
  3163     MOVE EIBRESP  TO WS-RESPONSE
  3164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3165     IF RESP-NORMAL
  3166        SET BILLING-INSTRUCTIONS-FOUND TO TRUE
  3167     END-IF
  3168     .
  3169 7200-EXIT.
  3170     EXIT.
  3171 7300-READ-ERCOMP-UPDATE.
  3172
  3173* EXEC CICS HANDLE CONDITION
  3174*        NOTFND  (7300-NOTFND)
  3175*        NOTOPEN (7300-NOTOPEN)
  3176*    END-EXEC.
  3177*    MOVE '"$IJ                  ! % #00003001' TO DFHEIV0
  3178     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3179     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3180     MOVE X'2520233030303033303031' TO DFHEIV0(25:11)
  3181     CALL 'kxdfhei1' USING DFHEIV0
  3182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3183
  3184
  3185
  3186* EXEC CICS READ
  3187*         DATASET  (ERCOMP-FILE-ID)
  3188*         SET      (ADDRESS OF COMPENSATION-MASTER)
  3189*         RIDFLD   (PI-ERCOMP-KEY)
  3190*         UPDATE
  3191*    END-EXEC.
  3192*    MOVE '&"S        EU         (   #00003006' TO DFHEIV0
  3193     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3194     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3195     MOVE X'2020233030303033303036' TO DFHEIV0(25:11)
  3196     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  67
* EL6521.cbl
  3197           ERCOMP-FILE-ID,
  3198           DFHEIV20,
  3199           DFHEIV99,
  3200           PI-ERCOMP-KEY,
  3201           DFHEIV99,
  3202           DFHEIV99,
  3203           DFHEIV99
  3204     SET ADDRESS OF COMPENSATION-MASTER TO
  3205         DFHEIV20
  3206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3207
  3208     GO TO 7300-EXIT.
  3209
  3210 7300-NOTOPEN.
  3211
  3212     MOVE ER-2233               TO EMI-ERROR
  3213     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3214     GO TO 7300-EXIT.
  3215 7300-NOTFND.
  3216
  3217     MOVE ER-7462               TO EMI-ERROR
  3218     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3219     GO TO 7300-EXIT.
  3220
  3221 7300-EXIT.
  3222     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  68
* EL6521.cbl
  3224
  3225 7400-DELETE-PRE-NOTE.
  3226
  3227
  3228* EXEC CICS HANDLE CONDITION
  3229*        NOTFND  (7499-EXIT)
  3230*        NOTOPEN (7450-NOTOPEN)
  3231*    END-EXEC.
  3232*    MOVE '"$IJ                  ! & #00003031' TO DFHEIV0
  3233     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3234     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3235     MOVE X'2620233030303033303331' TO DFHEIV0(25:11)
  3236     CALL 'kxdfhei1' USING DFHEIV0
  3237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3238
  3239
  3240
  3241* EXEC CICS READ
  3242*         DATASET  (ELACHP-FILE-ID)
  3243*         SET     (ADDRESS OF ACH-PRENOTIFICATION)
  3244*         RIDFLD   (CO-CONTROL-PRIMARY)
  3245*         UPDATE
  3246*    END-EXEC.
  3247*    MOVE '&"S        EU         (   #00003036' TO DFHEIV0
  3248     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3249     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  3250     MOVE X'2020233030303033303336' TO DFHEIV0(25:11)
  3251     CALL 'kxdfhei1' USING DFHEIV0,
  3252           ELACHP-FILE-ID,
  3253           DFHEIV20,
  3254           DFHEIV99,
  3255           CO-CONTROL-PRIMARY,
  3256           DFHEIV99,
  3257           DFHEIV99,
  3258           DFHEIV99
  3259     SET ADDRESS OF ACH-PRENOTIFICATION TO
  3260         DFHEIV20
  3261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3262
  3263
  3264
  3265* EXEC CICS DELETE
  3266*        DATASET   (ELACHP-FILE-ID)
  3267*    END-EXEC.
  3268*    MOVE '&(                    &   #00003043' TO DFHEIV0
  3269     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  3270     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3271     MOVE X'2020233030303033303433' TO DFHEIV0(25:11)
  3272     CALL 'kxdfhei1' USING DFHEIV0,
  3273           ELACHP-FILE-ID,
  3274           DFHEIV99,
  3275           DFHEIV99,
  3276           DFHEIV99,
  3277           DFHEIV99
  3278     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3279
  3280
  3281     GO TO 7499-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  69
* EL6521.cbl
  3282
  3283 7450-NOTOPEN.
  3284     MOVE ER-7469               TO EMI-ERROR
  3285     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3286
  3287 7499-EXIT.
  3288     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  70
* EL6521.cbl
  3290
  3291******************************************************************
  3292*             V A L I D T E  T R A N S I T  N U M B E R
  3293******************************************************************
  3294 7500-VALIDATE-TRANSIT.
  3295
  3296
  3297* EXEC CICS HANDLE CONDITION
  3298*        NOTFND   (7500-NOT-FOUND)
  3299*        NOTOPEN  (7500-NOT-OPEN)
  3300*    END-EXEC.
  3301*    MOVE '"$IJ                  ! '' #00003062' TO DFHEIV0
  3302     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  3303     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3304     MOVE X'2720233030303033303632' TO DFHEIV0(25:11)
  3305     CALL 'kxdfhei1' USING DFHEIV0
  3306     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3307
  3308
  3309     MOVE WS-TRANSIT1          TO PI-FEDERAL-NUMBER.
  3310     MOVE WS-TRANSIT2          TO PI-BANK-NUMBER.
  3311     MOVE PI-COMPANY-CD        TO PI-BANK-COMPANY-CD.
  3312
  3313
  3314* EXEC CICS READ
  3315*        EQUAL
  3316*        DATASET   (ELBANK-FILE-ID)
  3317*        SET       (ADDRESS OF BANK-MASTER)
  3318*        RIDFLD    (PI-BANK-TRANSIT-NUMBER)
  3319*    END-EXEC.
  3320*    MOVE '&"S        E          (   #00003071' TO DFHEIV0
  3321     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3322     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3323     MOVE X'2020233030303033303731' TO DFHEIV0(25:11)
  3324     CALL 'kxdfhei1' USING DFHEIV0,
  3325           ELBANK-FILE-ID,
  3326           DFHEIV20,
  3327           DFHEIV99,
  3328           PI-BANK-TRANSIT-NUMBER,
  3329           DFHEIV99,
  3330           DFHEIV99,
  3331           DFHEIV99
  3332     SET ADDRESS OF BANK-MASTER TO
  3333         DFHEIV20
  3334     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3335
  3336
  3337     GO TO 7500-VALIDATE-EXIT.
  3338
  3339 7500-NOT-OPEN.
  3340
  3341     MOVE -1                    TO TRNSIT1L
  3342     MOVE AL-UABON              TO TRNSIT1A
  3343     MOVE AL-UABON              TO TRNSIT2A
  3344     MOVE ER-7468               TO EMI-ERROR .
  3345     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3346     GO TO 7500-VALIDATE-EXIT.
  3347
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  71
* EL6521.cbl
  3348 7500-NOT-FOUND.
  3349
  3350     MOVE -1                    TO TRNSIT1L
  3351     MOVE AL-UABON              TO TRNSIT1A
  3352     MOVE AL-UABON              TO TRNSIT2A
  3353     MOVE ER-9388               TO EMI-ERROR .
  3354     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3355     GO TO 7500-VALIDATE-EXIT.
  3356
  3357 7500-VALIDATE-EXIT.
  3358     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  72
* EL6521.cbl
  3360
  3361 7600-WRITE-ELACHP.
  3362
  3363* EXEC CICS HANDLE CONDITION
  3364*        NOTOPEN (7450-NOTOPEN)
  3365*        DUPREC   (7610-DUPREC)
  3366*    END-EXEC.
  3367*    MOVE '"$J%                  ! ( #00003103' TO DFHEIV0
  3368     MOVE X'22244A252020202020202020' TO DFHEIV0(1:12)
  3369     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3370     MOVE X'2820233030303033313033' TO DFHEIV0(25:11)
  3371     CALL 'kxdfhei1' USING DFHEIV0
  3372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3373
  3374
  3375
  3376* EXEC CICS GETMAIN
  3377*        SET      (ADDRESS OF ACH-PRENOTIFICATION)
  3378*        LENGTH   (210)
  3379*    END-EXEC.
  3380     MOVE 210
  3381       TO DFHEIV11
  3382*    MOVE '," L                  $   #00003108' TO DFHEIV0
  3383     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  3384     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3385     MOVE X'2020233030303033313038' TO DFHEIV0(25:11)
  3386     CALL 'kxdfhei1' USING DFHEIV0,
  3387           DFHEIV20,
  3388           DFHEIV11,
  3389           DFHEIV99
  3390     SET ADDRESS OF ACH-PRENOTIFICATION TO
  3391         DFHEIV20
  3392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3393
  3394
  3395     INITIALIZE  ACH-PRENOTIFICATION.
  3396
  3397     MOVE  'AP'                  TO AP-RECORD-ID.
  3398
  3399     MOVE PI-PROCESSOR-ID        TO AP-LAST-CHANGE-PROCESSOR
  3400     MOVE CO-CONTROL-PRIMARY     TO AP-CONTROL-PRIMARY
  3401     MOVE EIBTIME                TO AP-LAST-CHANGE-TIME
  3402     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  3403     MOVE '5'                    TO DC-OPTION-CODE.
  3404     PERFORM 9700-DATE-CONVERT THRU 9700-EXIT.
  3405
  3406     MOVE DC-BIN-DATE-1          TO AP-LAST-CHANGE-DT.
  3407     MOVE WS-BANK-DATA           TO AP-BANK-INFORMATION.
  3408     MOVE BM-NAME                TO AP-BANK-NAME.
  3409
  3410
  3411* EXEC CICS WRITE
  3412*        FROM      (ACH-PRENOTIFICATION)
  3413*        DATASET   (ELACHP-FILE-ID)
  3414*        RIDFLD    (CO-CONTROL-PRIMARY)
  3415*    END-EXEC.
  3416     MOVE LENGTH OF
  3417      ACH-PRENOTIFICATION
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  73
* EL6521.cbl
  3418       TO DFHEIV11
  3419*    MOVE '&$ L                  ''   #00003128' TO DFHEIV0
  3420     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  3421     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3422     MOVE X'2020233030303033313238' TO DFHEIV0(25:11)
  3423     CALL 'kxdfhei1' USING DFHEIV0,
  3424           ELACHP-FILE-ID,
  3425           ACH-PRENOTIFICATION,
  3426           DFHEIV11,
  3427           CO-CONTROL-PRIMARY,
  3428           DFHEIV99,
  3429           DFHEIV99
  3430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3431
  3432
  3433     GO TO 7620-WRITE-EXIT.
  3434
  3435 7610-DUPREC.
  3436
  3437     MOVE    ER-7447            TO EMI-ERROR
  3438     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3439     GO TO 7620-WRITE-EXIT.
  3440
  3441 7620-WRITE-EXIT.
  3442      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  74
* EL6521.cbl
  3444******************************************************************
  3445 8100-SEND-INITIAL-MAP.
  3446     MOVE WS-SAVE-DATE           TO DATEO.
  3447     MOVE EIBTIME                TO TIME-IN.
  3448     MOVE TIME-OUT               TO TIMEO.
  3449     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3450     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3451     MOVE -1                     TO MAINTYPL.
  3452     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  3453     MOVE WS-AGENT-BANK-DESC    TO BKDESCO.
  3454
  3455* HIDE ACH FIELDS IF NOT AR PROCESSING
  3456     IF PI-AR-PROCESSING
  3457        NEXT SENTENCE
  3458     ELSE
  3459        MOVE AL-SADOF             TO BKLITA, BKDESCA  CRSTATA
  3460                                     ACTLITA CRSLITA ACHPF1A
  3461                                     TRNSIT1A TRNSIT2A TRDASHA
  3462                                     BKACCTA, ACTCDA.
  3463
  3464* EXEC CICS SEND
  3465*        MAP      (MAP-NAME)
  3466*        MAPSET   (MAPSET-NAME)
  3467*        FROM     (EL6521AO)
  3468*        ERASE
  3469*        CURSOR
  3470*    END-EXEC.
  3471     MOVE LENGTH OF
  3472      EL6521AO
  3473       TO DFHEIV12
  3474     MOVE -1
  3475       TO DFHEIV11
  3476*    MOVE '8$     CT  E    H L F ,   #00003164' TO DFHEIV0
  3477     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3478     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3479     MOVE X'2020233030303033313634' TO DFHEIV0(25:11)
  3480     CALL 'kxdfhei1' USING DFHEIV0,
  3481           MAP-NAME,
  3482           EL6521AO,
  3483           DFHEIV12,
  3484           MAPSET-NAME,
  3485           DFHEIV99,
  3486           DFHEIV99,
  3487           DFHEIV99,
  3488           DFHEIV11,
  3489           DFHEIV99,
  3490           DFHEIV99,
  3491           DFHEIV99
  3492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3493
  3494
  3495     GO TO 9100-RETURN-TRAN.
  3496
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  75
* EL6521.cbl
  3498 8200-SEND-DATAONLY.
  3499     MOVE WS-SAVE-DATE           TO DATEO.
  3500     MOVE EIBTIME                TO TIME-IN.
  3501     MOVE TIME-OUT               TO TIMEO.
  3502     MOVE PI-COMPANY-ID          TO CMPNYIDO.
  3503     MOVE PI-PROCESSOR-ID        TO USERIDO.
  3504     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  3505     MOVE WS-AGENT-BANK-DESC     TO BKDESCO.
  3506
  3507* HIDE ACH FIELDS IF NOT AR PROCESSING
  3508     IF PI-AR-PROCESSING
  3509        NEXT SENTENCE
  3510     ELSE
  3511        MOVE AL-SADOF             TO BKLITA, BKDESCA  CRSTATA
  3512                                     ACTLITA CRSLITA ACHPF1A
  3513                                     TRNSIT1A TRNSIT2A TRDASHA
  3514                                     BKACCTA, ACTCDA.
  3515
  3516* EXEC CICS SEND
  3517*        MAP      (MAP-NAME)
  3518*        MAPSET   (MAPSET-NAME)
  3519*        FROM     (EL6521AO)
  3520*        DATAONLY
  3521*        CURSOR
  3522*    END-EXEC.
  3523     MOVE LENGTH OF
  3524      EL6521AO
  3525       TO DFHEIV12
  3526     MOVE -1
  3527       TO DFHEIV11
  3528*    MOVE '8$D    CT       H L F ,   #00003192' TO DFHEIV0
  3529     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3530     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3531     MOVE X'2020233030303033313932' TO DFHEIV0(25:11)
  3532     CALL 'kxdfhei1' USING DFHEIV0,
  3533           MAP-NAME,
  3534           EL6521AO,
  3535           DFHEIV12,
  3536           MAPSET-NAME,
  3537           DFHEIV99,
  3538           DFHEIV99,
  3539           DFHEIV99,
  3540           DFHEIV11,
  3541           DFHEIV99,
  3542           DFHEIV99,
  3543           DFHEIV99
  3544     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3545
  3546
  3547     GO TO 9100-RETURN-TRAN.
  3548
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  76
* EL6521.cbl
  3550 8300-SEND-TEXT.
  3551
  3552* EXEC CICS SEND TEXT
  3553*        FROM     (LOGOFF-TEXT)
  3554*        LENGTH   (LOGOFF-LENGTH)
  3555*        ERASE
  3556*        FREEKB
  3557*    END-EXEC.
  3558*    MOVE '8&      T  E F  H   F -   #00003204' TO DFHEIV0
  3559     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3560     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3561     MOVE X'2020233030303033323034' TO DFHEIV0(25:11)
  3562     CALL 'kxdfhei1' USING DFHEIV0,
  3563           LOGOFF-TEXT,
  3564           LOGOFF-LENGTH,
  3565           DFHEIV99,
  3566           DFHEIV99,
  3567           DFHEIV99,
  3568           DFHEIV99,
  3569           DFHEIV99,
  3570           DFHEIV99,
  3571           DFHEIV99,
  3572           DFHEIV99,
  3573           DFHEIV99,
  3574           DFHEIV99
  3575     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3576
  3577
  3578
  3579* EXEC CICS RETURN
  3580*    END-EXEC.
  3581*    MOVE '.(                    ''   #00003211' TO DFHEIV0
  3582     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3583     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3584     MOVE X'2020233030303033323131' TO DFHEIV0(25:11)
  3585     CALL 'kxdfhei1' USING DFHEIV0,
  3586           DFHEIV99,
  3587           DFHEIV99,
  3588           DFHEIV99,
  3589           DFHEIV99,
  3590           DFHEIV99,
  3591           DFHEIV99
  3592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3593
  3594
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  77
* EL6521.cbl
  3596 8600-DEEDIT.
  3597
  3598* EXEC CICS BIF DEEDIT
  3599*         FIELD(DEEDIT-FIELD)
  3600*         LENGTH(15)
  3601*    END-EXEC.
  3602     MOVE 15
  3603       TO DFHEIV11
  3604*    MOVE '@"L                   #   #00003216' TO DFHEIV0
  3605     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3606     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3607     MOVE X'2020233030303033323136' TO DFHEIV0(25:11)
  3608     CALL 'kxdfhei1' USING DFHEIV0,
  3609           DEEDIT-FIELD,
  3610           DFHEIV11
  3611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3612
  3613
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  78
* EL6521.cbl
  3615 8800-UNAUTHORIZED-ACCESS.
  3616     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3617     GO TO 8300-SEND-TEXT.
  3618
  3619 8810-PF23.
  3620     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3621     MOVE XCTL-005               TO PGM-NAME.
  3622     GO TO 9300-XCTL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  79
* EL6521.cbl
  3624
  3625 9100-RETURN-TRAN.
  3626     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  3627     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  3628
  3629* EXEC CICS RETURN
  3630*        TRANSID    (TRANS-ID)
  3631*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3632*        LENGTH     (WS-COMM-LENGTH)
  3633*    END-EXEC.
  3634*    MOVE '.(CT                  ''   #00003235' TO DFHEIV0
  3635     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3636     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3637     MOVE X'2020233030303033323335' TO DFHEIV0(25:11)
  3638     CALL 'kxdfhei1' USING DFHEIV0,
  3639           TRANS-ID,
  3640           PROGRAM-INTERFACE-BLOCK,
  3641           WS-COMM-LENGTH,
  3642           DFHEIV99,
  3643           DFHEIV99,
  3644           DFHEIV99
  3645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3646
  3647
  3648 9200-RETURN-MAIN-MENU.
  3649     MOVE XCTL-626               TO PGM-NAME.
  3650     GO TO 9300-XCTL.
  3651
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  80
* EL6521.cbl
  3653 9300-XCTL.
  3654
  3655* EXEC CICS XCTL
  3656*        PROGRAM    (PGM-NAME)
  3657*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  3658*        LENGTH     (WS-COMM-LENGTH)
  3659*    END-EXEC.
  3660*    MOVE '.$C                   %   #00003247' TO DFHEIV0
  3661     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3662     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3663     MOVE X'2020233030303033323437' TO DFHEIV0(25:11)
  3664     CALL 'kxdfhei1' USING DFHEIV0,
  3665           PGM-NAME,
  3666           PROGRAM-INTERFACE-BLOCK,
  3667           WS-COMM-LENGTH,
  3668           DFHEIV99
  3669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3670
  3671
  3672 9400-CLEAR.
  3673     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  3674     GO TO 9300-XCTL.
  3675
  3676 9500-PF12.
  3677     MOVE XCTL-010               TO PGM-NAME.
  3678     GO TO 9300-XCTL.
  3679
  3680 9600-PGMID-ERROR.
  3681
  3682* EXEC CICS HANDLE CONDITION
  3683*        PGMIDERR    (8300-SEND-TEXT)
  3684*    END-EXEC.
  3685*    MOVE '"$L                   ! ) #00003262' TO DFHEIV0
  3686     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3687     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3688     MOVE X'2920233030303033323632' TO DFHEIV0(25:11)
  3689     CALL 'kxdfhei1' USING DFHEIV0
  3690     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3691
  3692
  3693     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  3694     MOVE ' '                    TO PI-ENTRY-CD-1.
  3695     MOVE XCTL-005               TO PGM-NAME.
  3696     MOVE PGM-NAME               TO LOGOFF-PGM.
  3697     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  3698     GO TO 9300-XCTL.
  3699
  3700 9700-DATE-CONVERT.
  3701
  3702* EXEC CICS LINK
  3703*        PROGRAM    ('ELDATCV')
  3704*        COMMAREA   (DATE-CONVERSION-DATA)
  3705*        LENGTH     (DC-COMM-LENGTH)
  3706*    END-EXEC.
  3707     MOVE 'ELDATCV' TO DFHEIV1
  3708*    MOVE '."C                   (   #00003274' TO DFHEIV0
  3709     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3710     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  81
* EL6521.cbl
  3711     MOVE X'2020233030303033323734' TO DFHEIV0(25:11)
  3712     CALL 'kxdfhei1' USING DFHEIV0,
  3713           DFHEIV1,
  3714           DATE-CONVERSION-DATA,
  3715           DC-COMM-LENGTH,
  3716           DFHEIV99,
  3717           DFHEIV99,
  3718           DFHEIV99,
  3719           DFHEIV99
  3720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3721
  3722
  3723 9700-EXIT.
  3724     EXIT.
  3725
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  82
* EL6521.cbl
  3727 9900-ERROR-FORMAT.
  3728
  3729     IF NOT EMI-ERRORS-COMPLETE
  3730         MOVE LINK-001           TO PGM-NAME
  3731
  3732* EXEC CICS LINK
  3733*            PROGRAM    (PGM-NAME)
  3734*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  3735*            LENGTH     (EMI-COMM-LENGTH)
  3736*        END-EXEC.
  3737*    MOVE '."C                   (   #00003288' TO DFHEIV0
  3738     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3739     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3740     MOVE X'2020233030303033323838' TO DFHEIV0(25:11)
  3741     CALL 'kxdfhei1' USING DFHEIV0,
  3742           PGM-NAME,
  3743           ERROR-MESSAGE-INTERFACE-BLOCK,
  3744           EMI-COMM-LENGTH,
  3745           DFHEIV99,
  3746           DFHEIV99,
  3747           DFHEIV99,
  3748           DFHEIV99
  3749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3750
  3751
  3752 9900-EXIT.
  3753     EXIT.
  3754
  3755 9990-ABEND.
  3756     MOVE LINK-004               TO PGM-NAME.
  3757     MOVE DFHEIBLK               TO EMI-LINE1.
  3758
  3759* EXEC CICS LINK
  3760*        PROGRAM   (PGM-NAME)
  3761*        COMMAREA  (EMI-LINE1)
  3762*        LENGTH    (72)
  3763*    END-EXEC.
  3764     MOVE 72
  3765       TO DFHEIV11
  3766*    MOVE '."C                   (   #00003300' TO DFHEIV0
  3767     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3768     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3769     MOVE X'2020233030303033333030' TO DFHEIV0(25:11)
  3770     CALL 'kxdfhei1' USING DFHEIV0,
  3771           PGM-NAME,
  3772           EMI-LINE1,
  3773           DFHEIV11,
  3774           DFHEIV99,
  3775           DFHEIV99,
  3776           DFHEIV99,
  3777           DFHEIV99
  3778     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3779
  3780
  3781     GO TO 8200-SEND-DATAONLY.
  3782
  3783 9995-SECURITY-VIOLATION.
  3784*           COPY ELCSCTP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  83
* EL6521.cbl
  3785******************************************************************
  3786*                                                                *
  3787*                            ELCSCTP                             *
  3788*                            VMOD=2.001                          *
  3789*                                                                *
  3790*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3791******************************************************************
  3792
  3793
  3794     MOVE EIBDATE          TO SM-JUL-DATE.
  3795     MOVE EIBTRMID         TO SM-TERMID.
  3796     MOVE THIS-PGM         TO SM-PGM.
  3797     MOVE EIBTIME          TO TIME-IN.
  3798     MOVE TIME-OUT         TO SM-TIME.
  3799     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3800
  3801
  3802* EXEC CICS LINK
  3803*         PROGRAM  ('EL003')
  3804*         COMMAREA (SECURITY-MESSAGE)
  3805*         LENGTH   (80)
  3806*    END-EXEC.
  3807     MOVE 'EL003' TO DFHEIV1
  3808     MOVE 80
  3809       TO DFHEIV11
  3810*    MOVE '."C                   (   #00003326' TO DFHEIV0
  3811     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3812     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3813     MOVE X'2020233030303033333236' TO DFHEIV0(25:11)
  3814     CALL 'kxdfhei1' USING DFHEIV0,
  3815           DFHEIV1,
  3816           SECURITY-MESSAGE,
  3817           DFHEIV11,
  3818           DFHEIV99,
  3819           DFHEIV99,
  3820           DFHEIV99,
  3821           DFHEIV99
  3822     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3823
  3824
  3825******************************************************************
  3826
  3827
  3828 9995-EXIT.
  3829      EXIT.
  3830
  3831 9999-DFHBACK SECTION.
  3832     MOVE '9%                    "   ' TO DFHEIV0
  3833     MOVE 'EL6521' TO DFHEIV1
  3834     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3835     GOBACK.
  3836 9999-DFHEXIT.
  3837     IF DFHEIGDJ EQUAL 0001
  3838         NEXT SENTENCE
  3839     ELSE IF DFHEIGDJ EQUAL 2
  3840         GO TO 9600-PGMID-ERROR,
  3841               9990-ABEND
  3842         DEPENDING ON DFHEIGDI
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:40 Page  84
* EL6521.cbl
  3843     ELSE IF DFHEIGDJ EQUAL 3
  3844         GO TO 0700-EXIT
  3845         DEPENDING ON DFHEIGDI
  3846     ELSE IF DFHEIGDJ EQUAL 4
  3847         GO TO 7100-NOTOPEN,
  3848               7100-NOTFND
  3849         DEPENDING ON DFHEIGDI
  3850     ELSE IF DFHEIGDJ EQUAL 5
  3851         GO TO 7300-NOTFND,
  3852               7300-NOTOPEN
  3853         DEPENDING ON DFHEIGDI
  3854     ELSE IF DFHEIGDJ EQUAL 6
  3855         GO TO 7499-EXIT,
  3856               7450-NOTOPEN
  3857         DEPENDING ON DFHEIGDI
  3858     ELSE IF DFHEIGDJ EQUAL 7
  3859         GO TO 7500-NOT-FOUND,
  3860               7500-NOT-OPEN
  3861         DEPENDING ON DFHEIGDI
  3862     ELSE IF DFHEIGDJ EQUAL 8
  3863         GO TO 7450-NOTOPEN,
  3864               7610-DUPREC
  3865         DEPENDING ON DFHEIGDI
  3866     ELSE IF DFHEIGDJ EQUAL 9
  3867         GO TO 8300-SEND-TEXT
  3868         DEPENDING ON DFHEIGDI.
  3869     MOVE '9%                    "   ' TO DFHEIV0
  3870     MOVE 'EL6521' TO DFHEIV1
  3871     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3872     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4924     Code:       11019
