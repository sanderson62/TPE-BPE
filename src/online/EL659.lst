* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL659.cbl
* Options: int("EL659.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL659.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL659.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL659.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL659 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/14/96 12:01:56.
     7*                            VMOD=2.007
     8*
     9*AUTHOR.
    10*               LOGIC, INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL659.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*        THIS PROGRAM PROVIDES THE QUALIFICATION NECESSARY FOR
    27*    THE ACCOUNT MASTER (ACCOUNT NAME AND/OR MAIL TO NAME),
    28*    COMPENSATION MASTER (ACCOUNT NAME AND/OR MAIL TO NAME),
    29*    AND REINSURANCE COMPANY NAME (WITH LEVEL NUMBERS) LOOK-UP.
    30
    31*    SCREENS     - EL659A - ACCOUNT/COMPANY NAME REFERENCE
    32
    33*    ENTERED BY  - EL601 - SYSTEM ADMINISTRATION MENU
    34*                  EL650 - ACCOUNT MAINTENANCE
    35*                  EL652 - COMPENSATION MAINTENANCE
    36*                  EL651 - REINSURANCE TABLE MAINTENANCE
    37
    38*    EXIT TO     - CALLING PROGRAM
    39*                  EL6592 - ACCOUNT/COMPANY NAME LOOK-UP
    40
    41*    INPUT FILE  - ERNAME - ACCOUNT/COMPANY NAME XREF FILE
    42
    43*    OUTPUT FILE - NONE
    44
    45*    COMMAREA    - PASSED.  IF AN ACCOUNT/COMPANY IS SELECTED,
    46*                  THE CONTROL OF THAT ACCOUNT/COMPANY IS PLACED
    47*                  IN THE APPROPRIATE FIELDS OF THE COMMAREA FOR
    48*                  REFERENCE BY SUCCESSIVE PROGRAMS.  THE PROGRAM
    49*                  WORK AREA OF THE COMMAREA IS USED TO PASS THE
    50*                  RECORD KEY INFORMATION NEEDED BY EL6592.
    51
    52*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL601.  ON
    53*                  FIRST ENTRY, A SKELETON SCREEN IS SENT AND THE
    54*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    55*                  ENTRIES (XCTL FROM CICS VIA EX65) THE SCREEN
    56*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    57*                  OPTION INDICATED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL659.cbl
    59******************************************************************
    60*                   C H A N G E   L O G
    61*
    62* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    63*-----------------------------------------------------------------
    64*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    65* EFFECTIVE    NUMBER
    66*-----------------------------------------------------------------
    67* 081905  IR2005041400004  PEMA  ADD DELETE OF TEMP STORAGE ID'S
    68******************************************************************
    69 ENVIRONMENT DIVISION.
    70 DATA DIVISION.
    71 WORKING-STORAGE SECTION.
    72 01  DFH-START PIC X(04).
    73
    74 77  FILLER  PIC  X(32) VALUE '********************************'.
    75 77  FILLER  PIC  X(32) VALUE '*    EL659 WORKING STORAGE     *'.
    76 77  FILLER  PIC  X(32) VALUE '*********** VMOD=2.007 *********'.
    77
    78*    COPY ELCSCTM.
    79******************************************************************
    80*                                                                *
    81*                                                                *
    82*                            ELCSCTM                             *
    83*                            VMOD=2.001                          *
    84*                                                                *
    85*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    86*                                                                *
    87******************************************************************
    88 01  SECURITY-MESSAGE.
    89     12  FILLER                          PIC X(30)
    90            VALUE '** LOGIC SECURITY VIOLATION -'.
    91     12  SM-READ                         PIC X(6).
    92     12  FILLER                          PIC X(5)
    93            VALUE ' PGM='.
    94     12  SM-PGM                          PIC X(6).
    95     12  FILLER                          PIC X(5)
    96            VALUE ' OPR='.
    97     12  SM-PROCESSOR-ID                 PIC X(4).
    98     12  FILLER                          PIC X(6)
    99            VALUE ' TERM='.
   100     12  SM-TERMID                       PIC X(4).
   101     12  FILLER                          PIC XX   VALUE SPACE.
   102     12  SM-JUL-DATE                     PIC 9(5).
   103     12  FILLER                          PIC X    VALUE SPACE.
   104     12  SM-TIME                         PIC 99.99.
   105
   106
   107*    COPY ELCSCRTY.
   108******************************************************************
   109*                                                                *
   110*                                                                *
   111*                            ELCSCRTY                            *
   112*                            VMOD=2.001                          *
   113*                                                                *
   114*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   115*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   116*        SAVED IN PI-SECURITY-ADDRESS.                           *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL659.cbl
   117*                                                                *
   118******************************************************************
   119 01  SECURITY-CONTROL.
   120     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   121     12  FILLER                       PIC XX    VALUE 'SC'.
   122     12  SC-CREDIT-CODES.
   123         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   124             20  SC-CREDIT-DISPLAY    PIC X.
   125             20  SC-CREDIT-UPDATE     PIC X.
   126     12  SC-CLAIMS-CODES.
   127         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   128             20  SC-CLAIMS-DISPLAY    PIC X.
   129             20  SC-CLAIMS-UPDATE     PIC X.
   130
   131 01  WS-DATE-AREA.
   132     12  SAVE-DATE               PIC  X(08)      VALUE SPACES.
   133     12  SAVE-BIN-DATE           PIC  X(02)      VALUE SPACES.
   134
   135 01  FILLER                  COMP-3.
   136     12  TIME-IN                     PIC S9(07)  VALUE ZERO.
   137     12  TIME-OUT  REDEFINES
   138         TIME-IN                     PIC S9(03)V9(4).
   139
   140 01  FILLER                  COMP SYNC.
   141     12  SC-ITEM                 PIC S9(04)      VALUE +0001.
   142
   143 01  FILLER.
   144     12  WS-RESPONSE             PIC S9(8)   COMP.
   145         88  RESP-NORMAL                  VALUE +00.
   146         88  RESP-NOTFND                  VALUE +13.
   147         88  RESP-NOTOPEN                 VALUE +19.
   148         88  RESP-ENDFILE                 VALUE +20.
   149     12  WS-MAPSET-NAME          PIC  X(08)      VALUE 'EL659S'.
   150     12  WS-MAP-NAME             PIC  X(08)      VALUE 'EL659A'.
   151     12  FILLER  REDEFINES  WS-MAP-NAME.
   152         16  FILLER              PIC  X(02).
   153         16  WS-MAP-NUMBER       PIC  X(04).
   154         16  FILLER              PIC  X(02).
   155     12  THIS-PGM                PIC  X(08)      VALUE 'EL659'.
   156     12  WS-ERNAME-DSID          PIC  X(08)      VALUE 'ERNAME'.
   157     12  WS-TRANS-ID             PIC  X(04)      VALUE 'EX65'.
   158     12  WS-INPUT-FIELD          PIC  X(50)      VALUE SPACES.
   159     12  WS-INPUT-CHAR  REDEFINES
   160         WS-INPUT-FIELD          PIC  X(01)
   161             OCCURS  50  TIMES       INDEXED  BY  INPUT-INDEX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL659.cbl
   163     12  WS-TEMP-STORAGE-KEY.
   164         16  WS-TSK-TERM-ID          PIC  X(04)  VALUE 'XXXX'.
   165         16  FILLER                  PIC  X(04)  VALUE '6592'.
   166     12  WS-TEMP-STORAGE-KEY1.
   167         16  WS-TSK-TERM-ID1         PIC  X(04)  VALUE 'XXXX'.
   168         16  FILLER                  PIC  X(04)  VALUE '659P'.
   169     12  ERROR-MESSAGES.
   170         16  ER-0004             PIC  X(04)      VALUE '0004'.
   171         16  ER-0008             PIC  X(04)      VALUE '0008'.
   172         16  ER-0029             PIC  X(04)      VALUE '0029'.
   173         16  ER-0070             PIC  X(04)      VALUE '0070'.
   174         16  ER-0647             PIC  X(04)      VALUE '0647'.
   175         16  ER-0671             PIC  X(04)      VALUE '0671'.
   176         16  ER-0673             PIC  X(04)      VALUE '0673'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL659.cbl
   178*    COPY ELCINTF.
   179******************************************************************
   180*                                                                *
   181*                                                                *
   182*                            ELCINTF.                            *
   183*                            VMOD=2.017                          *
   184*                                                                *
   185*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   186*                                                                *
   187*       LENGTH = 1024                                            *
   188*                                                                *
   189******************************************************************
   190 01  PROGRAM-INTERFACE-BLOCK.
   191     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   192     12  PI-CALLING-PROGRAM              PIC X(8).
   193     12  PI-SAVED-PROGRAM-1              PIC X(8).
   194     12  PI-SAVED-PROGRAM-2              PIC X(8).
   195     12  PI-SAVED-PROGRAM-3              PIC X(8).
   196     12  PI-SAVED-PROGRAM-4              PIC X(8).
   197     12  PI-SAVED-PROGRAM-5              PIC X(8).
   198     12  PI-SAVED-PROGRAM-6              PIC X(8).
   199     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   200     12  PI-COMPANY-ID                   PIC XXX.
   201     12  PI-COMPANY-CD                   PIC X.
   202
   203     12  PI-COMPANY-PASSWORD             PIC X(8).
   204
   205     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   206
   207     12  PI-CONTROL-IN-PROGRESS.
   208         16  PI-CARRIER                  PIC X.
   209         16  PI-GROUPING                 PIC X(6).
   210         16  PI-STATE                    PIC XX.
   211         16  PI-ACCOUNT                  PIC X(10).
   212         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   213                                         PIC X(10).
   214         16  PI-CLAIM-CERT-GRP.
   215             20  PI-CLAIM-NO             PIC X(7).
   216             20  PI-CERT-NO.
   217                 25  PI-CERT-PRIME       PIC X(10).
   218                 25  PI-CERT-SFX         PIC X.
   219             20  PI-CERT-EFF-DT          PIC XX.
   220         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   221             20  PI-PLAN-CODE            PIC X(2).
   222             20  PI-REVISION-NUMBER      PIC X(3).
   223             20  PI-PLAN-EFF-DT          PIC X(2).
   224             20  PI-PLAN-EXP-DT          PIC X(2).
   225             20  FILLER                  PIC X(11).
   226         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   227             20  PI-OE-REFERENCE-1.
   228                 25  PI-OE-REF-1-PRIME   PIC X(18).
   229                 25  PI-OE-REF-1-SUFF    PIC XX.
   230
   231     12  PI-SESSION-IN-PROGRESS          PIC X.
   232         88  CLAIM-SESSION                   VALUE '1'.
   233         88  CREDIT-SESSION                  VALUE '2'.
   234         88  WARRANTY-SESSION                VALUE '3'.
   235         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL659.cbl
   236         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   237
   238
   239*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   240
   241     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   242     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   243
   244     12  PI-CREDIT-USER                  PIC X.
   245         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   246         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   247
   248     12  PI-CLAIM-USER                   PIC X.
   249         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   250         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   251
   252     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   253         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   254         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   255         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   256         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   257         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   258
   259     12  PI-PROCESSOR-ID                 PIC X(4).
   260
   261     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   262
   263     12  PI-MEMBER-CAPTION               PIC X(10).
   264
   265     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   266         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   267
   268     12  PI-LIFE-OVERRIDE-L1             PIC X.
   269     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   270     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   271     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   272
   273     12  PI-AH-OVERRIDE-L1               PIC X.
   274     12  PI-AH-OVERRIDE-L2               PIC XX.
   275     12  PI-AH-OVERRIDE-L6               PIC X(6).
   276     12  PI-AH-OVERRIDE-L12              PIC X(12).
   277
   278     12  PI-NEW-SYSTEM                   PIC X(2).
   279
   280     12  PI-PRIMARY-CERT-NO              PIC X(11).
   281     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   282         88  PI-USES-PAID-TO                 VALUE '1'.
   283     12  PI-CRDTCRD-SYSTEM.
   284         16  PI-CRDTCRD-USER             PIC X.
   285             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   286             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   287         16  PI-CC-MONTH-END-DT          PIC XX.
   288     12  PI-PROCESSOR-PRINTER            PIC X(4).
   289
   290     12  PI-OE-REFERENCE-2.
   291         16  PI-OE-REF-2-PRIME           PIC X(10).
   292         16  PI-OE-REF-2-SUFF            PIC X.
   293
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL659.cbl
   294     12  PI-REM-TRM-CALC-OPTION          PIC X.
   295
   296     12  PI-LANGUAGE-TYPE                PIC X.
   297             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   298             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   299             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   300
   301     12  PI-POLICY-LINKAGE-IND           PIC X.
   302         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   303         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   304                                                   LOW-VALUES.
   305
   306     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   307     12  PI-CLAIM-PW-SESSION             PIC X(1).
   308         88  PI-CLAIM-CREDIT                 VALUE '1'.
   309         88  PI-CLAIM-CONVEN                 VALUE '2'.
   310     12  FILLER                          PIC X(4).
   311
   312     12  PI-SYSTEM-LEVEL                 PIC X(145).
   313
   314     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   315         PI-SYSTEM-LEVEL.
   316
   317         16  PI-ENTRY-CODES.
   318             20  PI-ENTRY-CD-1           PIC X.
   319             20  PI-ENTRY-CD-2           PIC X.
   320
   321         16  PI-RETURN-CODES.
   322             20  PI-RETURN-CD-1          PIC X.
   323             20  PI-RETURN-CD-2          PIC X.
   324
   325         16  PI-UPDATE-STATUS-SAVE.
   326             20  PI-UPDATE-BY            PIC X(4).
   327             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   328
   329         16  PI-LOWER-CASE-LETTERS       PIC X.
   330             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   331
   332*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   333*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   334*            88  CARRIER-CLM-CNTL            VALUE '2'.
   335
   336         16  PI-CERT-ACCESS-CONTROL      PIC X.
   337             88  ST-ACCNT-CNTL               VALUE ' '.
   338             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   339             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   340             88  ACCNT-CNTL                  VALUE '3'.
   341             88  CARR-ACCNT-CNTL             VALUE '4'.
   342
   343         16  PI-PROCESSOR-CAP-LIST.
   344             20  PI-SYSTEM-CONTROLS.
   345                24 PI-SYSTEM-DISPLAY     PIC X.
   346                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   347                24 PI-SYSTEM-MODIFY      PIC X.
   348                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   349             20  FILLER                  PIC XX.
   350             20  PI-DISPLAY-CAP          PIC X.
   351                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL659.cbl
   352             20  PI-MODIFY-CAP           PIC X.
   353                 88  MODIFY-CAP              VALUE 'Y'.
   354             20  PI-MSG-AT-LOGON-CAP     PIC X.
   355                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   356             20  PI-FORCE-CAP            PIC X.
   357                 88  FORCE-CAP               VALUE 'Y'.
   358
   359         16  PI-PROGRAM-CONTROLS.
   360             20  PI-PGM-PRINT-OPT        PIC X.
   361             20  PI-PGM-FORMAT-OPT       PIC X.
   362             20  PI-PGM-PROCESS-OPT      PIC X.
   363             20  PI-PGM-TOTALS-OPT       PIC X.
   364
   365         16  PI-HELP-INTERFACE.
   366             20  PI-LAST-ERROR-NO        PIC X(4).
   367             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   368
   369         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   370             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   371
   372         16  PI-CR-CONTROL-IN-PROGRESS.
   373             20  PI-CR-CARRIER           PIC X.
   374             20  PI-CR-GROUPING          PIC X(6).
   375             20  PI-CR-STATE             PIC XX.
   376             20  PI-CR-ACCOUNT           PIC X(10).
   377             20  PI-CR-FIN-RESP          PIC X(10).
   378             20  PI-CR-TYPE              PIC X.
   379
   380         16  PI-CR-BATCH-NUMBER          PIC X(6).
   381
   382         16  PI-CR-MONTH-END-DT          PIC XX.
   383
   384         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   385             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   386             88  PI-ZERO-CARRIER             VALUE '1'.
   387             88  PI-ZERO-GROUPING            VALUE '2'.
   388             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   389
   390         16  PI-CARRIER-SECURITY         PIC X.
   391             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   392
   393         16  PI-ACCOUNT-SECURITY         PIC X(10).
   394             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   395             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   396
   397         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   398             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   399                                         INDEXED BY PI-ACCESS-NDX
   400                                         PIC X.
   401
   402         16  PI-GA-BILLING-CONTROL       PIC X.
   403             88  PI-GA-BILLING               VALUE '1'.
   404
   405         16  PI-MAIL-PROCESSING          PIC X.
   406             88  PI-MAIL-YES                 VALUE 'Y'.
   407
   408         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   409
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL659.cbl
   410         16  PI-AR-SYSTEM.
   411             20  PI-AR-PROCESSING-CNTL   PIC X.
   412                 88  PI-AR-PROCESSING        VALUE 'Y'.
   413             20  PI-AR-SUMMARY-CODE      PIC X(6).
   414             20  PI-AR-MONTH-END-DT      PIC XX.
   415
   416         16  PI-MP-SYSTEM.
   417             20  PI-MORTGAGE-USER            PIC X.
   418                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   419                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   420             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   421                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   422                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   423                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   424                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   425                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   426             20  PI-MP-MONTH-END-DT          PIC XX.
   427             20  PI-MP-REFERENCE-NO.
   428                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   429                 24  PI-MP-REFERENCE-SFX     PIC XX.
   430
   431         16  PI-LABEL-CONTROL            PIC X(01).
   432             88  PI-CREATE-LABELS                    VALUE 'Y'.
   433             88  PI-BYPASS-LABELS                    VALUE 'N'.
   434
   435         16  PI-BILL-GROUPING-CODE       PIC X(01).
   436             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   437
   438         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   439             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   440             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   441
   442         16  FILLER                      PIC X(14).
   443
   444     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   445******************************************************************
   446
   447*    COPY ELC659PI.
   448******************************************************************
   449*                                                                *
   450*                            ELC659PI                            *
   451*                            VMOD=2.002                          *
   452*                                                                *
   453******************************************************************
   454
   455     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
   456         16  FILLER                      PIC  X(02).
   457         16  PI-ERREIN-KEY.
   458             20  PI-ERR-COMPANY-CD       PIC  X(01).
   459             20  PI-ERR-CODE             PIC  X(01).
   460             20  PI-ERR-TABLE            PIC  X(03).
   461             20  PI-ERR-SUB              PIC  X(03).
   462         16  PI-ERR-LEVEL                PIC  9(02).
   463         16  PI-1ST-TIME-SW              PIC S9(01)  COMP-3.
   464         16  PI-LINE-COUNT               PIC S9(03)  COMP-3.
   465         16  PI-AIX-RECORD-COUNT         PIC S9(04)  COMP SYNC.
   466         16  PI-START-SW                 PIC S9(01)  COMP-3.
   467         16  PI-BROWSE-SW                PIC S9(01)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL659.cbl
   468         16  PI-END-OF-FILE              PIC S9(01)  COMP-3.
   469         16  PI-DSID                     PIC  X(08).
   470         16  PI-OPTION                   PIC  X(01).
   471             88  NO-OPTION-SELECTED              VALUE ZERO.
   472             88  OPTION-ONE-SELECTED             VALUE '1'.
   473             88  OPTION-TWO-SELECTED             VALUE '2'.
   474             88  OPTION-THREE-SELECTED           VALUE '3'.
   475         16  PI-SELECTION-CRITERIA.
   476             20  PI-SC-COMPANY-CD        PIC  X(01).
   477             20  PI-SC-NAME              PIC  X(30).
   478             20  PI-SC-RECORD-TYPE       PIC  X(01).
   479             20  FILLER                  PIC  X(29).
   480         16  PI-NAME-LOOKUP-KEY.
   481             20  PI-NLK-COMPANY-CD       PIC  X(01).
   482             20  PI-NLK-NAME             PIC  X(30).
   483             20  PI-NLK-RECORD-TYPE      PIC  X(01).
   484             20  FILLER                  PIC  X(29).
   485         16  PI-PREV-NAME-LOOKUP-KEY.
   486             20  PI-PREV-NLK-COMPANY-CD  PIC  X(01).
   487             20  PI-PREV-NLK-NAME        PIC  X(30).
   488             20  PI-PREV-NLK-RECORD-TYPE
   489                                         PIC  X(01).
   490             20  FILLERV-CK-STATE        PIC  X(29).
   491         16  PI-CITY                     PIC  X(15).
   492         16  PI-ST                       PIC  XX.
   493         16  PI-CITY-LENGTH              PIC S9(04)  COMP SYNC.
   494         16  PI-KEY-LENGTH               PIC S9(04)  COMP SYNC.
   495         16  PI-TS-ITEM                  PIC S9(04)  COMP SYNC.
   496         16  PI-1ST-KEY                  PIC  X(61).
   497         16  FILLER                      PIC  X(43).
   498         16  PI-PREV-AID                 PIC  X(01).
   499         16  PI-START-NAME-LOOKUP-KEY.
   500             20  PI-START-COMPANY-CD     PIC  X(01).
   501             20  PI-START-NAME           PIC  X(30).
   502             20  PI-START-RECORD-TYPE    PIC  X(01).
   503             20  FILLER                  PIC  X(29).
   504         16  PI-END-NAME-LOOKUP-KEY.
   505             20  PI-END-COMPANY-CD       PIC  X(01).
   506             20  PI-END-NAME             PIC  X(30).
   507             20  PI-END-RECORD-TYPE      PIC  X(01).
   508             20  FILLER                  PIC  X(29).
   509         16  PI-LIN1-NAME-LOOKUP-KEY     PIC  X(61).
   510         16  PI-SCREEN-COUNT             PIC S9(08)  COMP.
   511         16  PI-SUB                      PIC S9(02).
   512         16  PI-FIRST-TIME-SW            PIC  X(01).
   513
   514******************************************************************
   515         16  PI-EL659-TO-EL130-CNTRL.
   516             20  PI-EL659-CARRIER    PIC X.
   517             20  PI-EL659-GROUPING   PIC X(6).
   518             20  PI-EL659-STATE      PIC XX.
   519             20  PI-EL659-ACCOUNT    PIC X(10).
   520         16  FILLER                  PIC X(90).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL659.cbl
   522*    COPY ELCEMIB.
   523******************************************************************
   524*                                                                *
   525*                                                                *
   526*                            ELCEMIB.                            *
   527*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   528*                            VMOD=2.005                          *
   529*                                                                *
   530*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   531*                                                                *
   532******************************************************************
   533 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   534     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   535     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   536     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   537     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   538     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   539     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   540     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   541     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   542     12  EMI-SWITCH1             PIC X        VALUE '1'.
   543         88  EMI-NO-ERRORS                    VALUE '1'.
   544         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   545         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   546     12  EMI-SWITCH2             PIC X        VALUE '1'.
   547         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   548     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   549         88  EMI-AREA1-EMPTY                  VALUE '1'.
   550         88  EMI-AREA1-FULL                   VALUE '2'.
   551     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   552         88  EMI-AREA2-EMPTY                  VALUE '1'.
   553         88  EMI-AREA2-FULL                   VALUE '2'.
   554     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   555         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   556         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   557         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   558         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   559         88  EMI-BYPASS-FATALS                VALUE 'X'.
   560     12  EMI-ERROR-LINES.
   561         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   562         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   563         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   564         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   565             20  EMI-ERR-CODES OCCURS 10 TIMES.
   566                 24  EMI-ERR-NUM         PIC X(4).
   567                 24  EMI-FILLER          PIC X.
   568                 24  EMI-SEV             PIC X.
   569                 24  FILLER              PIC X.
   570             20  FILLER                  PIC X(02).
   571     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   572         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   573             20  EMI-ERROR-NUMBER    PIC X(4).
   574             20  EMI-FILL            PIC X.
   575             20  EMI-SEVERITY        PIC X.
   576             20  FILLER              PIC X.
   577             20  EMI-ERROR-TEXT.
   578                 24  EMI-TEXT-VARIABLE   PIC X(10).
   579                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL659.cbl
   580     12  EMI-SEVERITY-SAVE           PIC X.
   581         88  EMI-NOTE                    VALUE 'N'.
   582         88  EMI-WARNING                 VALUE 'W'.
   583         88  EMI-FORCABLE                VALUE 'F'.
   584         88  EMI-FATAL                   VALUE 'X'.
   585     12  EMI-MESSAGE-FLAG            PIC X.
   586         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   587         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   588     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   589     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   590         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   591         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   592         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   593     12  FILLER                      PIC X(137)  VALUE SPACES.
   594     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   595     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   596     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   597     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL659.cbl
   599*    COPY ELCDATE.
   600******************************************************************
   601*                                                                *
   602*                                                                *
   603*                            ELCDATE.                            *
   604*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   605*                            VMOD=2.003
   606*                                                                *
   607*                                                                *
   608*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   609*                 LENGTH = 200                                   *
   610******************************************************************
   611
   612 01  DATE-CONVERSION-DATA.
   613     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   614     12  DC-OPTION-CODE                PIC X.
   615         88  BIN-TO-GREG                VALUE ' '.
   616         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   617         88  EDIT-GREG-TO-BIN           VALUE '2'.
   618         88  YMD-GREG-TO-BIN            VALUE '3'.
   619         88  MDY-GREG-TO-BIN            VALUE '4'.
   620         88  JULIAN-TO-BIN              VALUE '5'.
   621         88  BIN-PLUS-ELAPSED           VALUE '6'.
   622         88  FIND-CENTURY               VALUE '7'.
   623         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   624         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   625         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   626         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   627         88  JULIAN-TO-BIN-3            VALUE 'C'.
   628         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   629         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   630         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   631         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   632         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   633         88  CHECK-LEAP-YEAR            VALUE 'H'.
   634         88  BIN-3-TO-GREG              VALUE 'I'.
   635         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   636         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   637         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   638         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   639         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   640         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   641         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   642         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   643         88  THREE-CHARACTER-BIN
   644                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   645         88  GREGORIAN-TO-BIN
   646                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   647         88  BIN-TO-GREGORIAN
   648                  VALUES ' ' '1' 'I' '8' 'G'.
   649         88  JULIAN-TO-BINARY
   650                  VALUES '5' 'C' 'E' 'F'.
   651     12  DC-ERROR-CODE                 PIC X.
   652         88  NO-CONVERSION-ERROR        VALUE ' '.
   653         88  DATE-CONVERSION-ERROR
   654                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   655         88  DATE-IS-ZERO               VALUE '1'.
   656         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL659.cbl
   657         88  DATE-IS-INVALID            VALUE '3'.
   658         88  DATE1-GREATER-DATE2        VALUE '4'.
   659         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   660         88  DATE-INVALID-OPTION        VALUE '9'.
   661         88  INVALID-CENTURY            VALUE 'A'.
   662         88  ONLY-CENTURY               VALUE 'B'.
   663         88  ONLY-LEAP-YEAR             VALUE 'C'.
   664         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   665     12  DC-END-OF-MONTH               PIC X.
   666         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   667     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   668         88  USE-NORMAL-PROCESS         VALUE ' '.
   669         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   670         88  ADJUST-UP-100-YRS          VALUE '2'.
   671     12  FILLER                        PIC X.
   672     12  DC-CONVERSION-DATES.
   673         16  DC-BIN-DATE-1             PIC XX.
   674         16  DC-BIN-DATE-2             PIC XX.
   675         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   676         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   677                       DC-GREG-DATE-1-EDIT.
   678             20  DC-EDIT1-MONTH        PIC 99.
   679             20  SLASH1-1              PIC X.
   680             20  DC-EDIT1-DAY          PIC 99.
   681             20  SLASH1-2              PIC X.
   682             20  DC-EDIT1-YEAR         PIC 99.
   683         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   684         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   685                     DC-GREG-DATE-2-EDIT.
   686             20  DC-EDIT2-MONTH        PIC 99.
   687             20  SLASH2-1              PIC X.
   688             20  DC-EDIT2-DAY          PIC 99.
   689             20  SLASH2-2              PIC X.
   690             20  DC-EDIT2-YEAR         PIC 99.
   691         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   692         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   693                     DC-GREG-DATE-1-YMD.
   694             20  DC-YMD-YEAR           PIC 99.
   695             20  DC-YMD-MONTH          PIC 99.
   696             20  DC-YMD-DAY            PIC 99.
   697         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   698         16  DC-GREG-DATE-1-MDY-R REDEFINES
   699                      DC-GREG-DATE-1-MDY.
   700             20  DC-MDY-MONTH          PIC 99.
   701             20  DC-MDY-DAY            PIC 99.
   702             20  DC-MDY-YEAR           PIC 99.
   703         16  DC-GREG-DATE-1-ALPHA.
   704             20  DC-ALPHA-MONTH        PIC X(10).
   705             20  DC-ALPHA-DAY          PIC 99.
   706             20  FILLER                PIC XX.
   707             20  DC-ALPHA-CENTURY.
   708                 24 DC-ALPHA-CEN-N     PIC 99.
   709             20  DC-ALPHA-YEAR         PIC 99.
   710         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   711         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   712         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   713         16  DC-JULIAN-DATE            PIC 9(05).
   714         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL659.cbl
   715                                       PIC 9(05).
   716         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   717             20  DC-JULIAN-YEAR        PIC 99.
   718             20  DC-JULIAN-DAYS        PIC 999.
   719         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   720         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   721         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   722     12  DATE-CONVERSION-VARIBLES.
   723         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   724         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   725             20  FILLER                PIC 9(3).
   726             20  HOLD-CEN-1-CCYY.
   727                 24  HOLD-CEN-1-CC     PIC 99.
   728                 24  HOLD-CEN-1-YY     PIC 99.
   729             20  HOLD-CEN-1-MO         PIC 99.
   730             20  HOLD-CEN-1-DA         PIC 99.
   731         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   732             20  HOLD-CEN-1-R-MO       PIC 99.
   733             20  HOLD-CEN-1-R-DA       PIC 99.
   734             20  HOLD-CEN-1-R-CCYY.
   735                 24  HOLD-CEN-1-R-CC   PIC 99.
   736                 24  HOLD-CEN-1-R-YY   PIC 99.
   737             20  FILLER                PIC 9(3).
   738         16  HOLD-CENTURY-1-X.
   739             20  FILLER                PIC X(3)  VALUE SPACES.
   740             20  HOLD-CEN-1-X-CCYY.
   741                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   742                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   743             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   744             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   745         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   746             20  HOLD-CEN-1-R-X-MO     PIC XX.
   747             20  HOLD-CEN-1-R-X-DA     PIC XX.
   748             20  HOLD-CEN-1-R-X-CCYY.
   749                 24  HOLD-CEN-1-R-X-CC PIC XX.
   750                 24  HOLD-CEN-1-R-X-YY PIC XX.
   751             20  FILLER                PIC XXX.
   752         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   753         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   754         16  DC-JULIAN-DATE-1          PIC 9(07).
   755         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   756             20  DC-JULIAN-1-CCYY.
   757                 24  DC-JULIAN-1-CC    PIC 99.
   758                 24  DC-JULIAN-1-YR    PIC 99.
   759             20  DC-JULIAN-DA-1        PIC 999.
   760         16  DC-JULIAN-DATE-2          PIC 9(07).
   761         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   762             20  DC-JULIAN-2-CCYY.
   763                 24  DC-JULIAN-2-CC    PIC 99.
   764                 24  DC-JULIAN-2-YR    PIC 99.
   765             20  DC-JULIAN-DA-2        PIC 999.
   766         16  DC-GREG-DATE-A-EDIT.
   767             20  DC-EDITA-MONTH        PIC 99.
   768             20  SLASHA-1              PIC X VALUE '/'.
   769             20  DC-EDITA-DAY          PIC 99.
   770             20  SLASHA-2              PIC X VALUE '/'.
   771             20  DC-EDITA-CCYY.
   772                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL659.cbl
   773                 24  DC-EDITA-YEAR     PIC 99.
   774         16  DC-GREG-DATE-B-EDIT.
   775             20  DC-EDITB-MONTH        PIC 99.
   776             20  SLASHB-1              PIC X VALUE '/'.
   777             20  DC-EDITB-DAY          PIC 99.
   778             20  SLASHB-2              PIC X VALUE '/'.
   779             20  DC-EDITB-CCYY.
   780                 24  DC-EDITB-CENT     PIC 99.
   781                 24  DC-EDITB-YEAR     PIC 99.
   782         16  DC-GREG-DATE-CYMD         PIC 9(08).
   783         16  DC-GREG-DATE-CYMD-R REDEFINES
   784                              DC-GREG-DATE-CYMD.
   785             20  DC-CYMD-CEN           PIC 99.
   786             20  DC-CYMD-YEAR          PIC 99.
   787             20  DC-CYMD-MONTH         PIC 99.
   788             20  DC-CYMD-DAY           PIC 99.
   789         16  DC-GREG-DATE-MDCY         PIC 9(08).
   790         16  DC-GREG-DATE-MDCY-R REDEFINES
   791                              DC-GREG-DATE-MDCY.
   792             20  DC-MDCY-MONTH         PIC 99.
   793             20  DC-MDCY-DAY           PIC 99.
   794             20  DC-MDCY-CEN           PIC 99.
   795             20  DC-MDCY-YEAR          PIC 99.
   796    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   797        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   798    12  DC-EL310-DATE                  PIC X(21).
   799    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL659.cbl
   801*    COPY ELCLOGOF.
   802******************************************************************
   803*                                                                *
   804*                                                                *
   805*                            ELCLOGOF.                           *
   806*                            VMOD=2.001                          *
   807*                                                                *
   808*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   809*                                                                *
   810******************************************************************
   811 01  CLASIC-LOGOFF.
   812     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   813     12  LOGOFF-TEXT.
   814         16  FILLER          PIC X(5)    VALUE SPACES.
   815         16  LOGOFF-MSG.
   816             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   817             20  FILLER      PIC X       VALUE SPACES.
   818             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   819         16  FILLER          PIC X(80)
   820           VALUE '* YOU ARE NOW LOGGED OFF'.
   821         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   822         16  FILLER          PIC X       VALUE QUOTE.
   823         16  LOGOFF-SYS-MSG  PIC X(17)
   824           VALUE 'S CLAS-IC SYSTEM '.
   825     12  TEXT-MESSAGES.
   826         16  UNACCESS-MSG    PIC X(29)
   827             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   828         16  PGMIDERR-MSG    PIC X(17)
   829             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL659.cbl
   831*    COPY EL659S.
   832 01  EL659AI.
   833     05  FILLER            PIC  X(0012).
   834*    -------------------------------
   835     05  ADATEL PIC S9(0004) COMP.
   836     05  ADATEF PIC  X(0001).
   837     05  FILLER REDEFINES ADATEF.
   838         10  ADATEA PIC  X(0001).
   839     05  ADATEI PIC  X(0008).
   840*    -------------------------------
   841     05  ATIMEL PIC S9(0004) COMP.
   842     05  ATIMEF PIC  X(0001).
   843     05  FILLER REDEFINES ATIMEF.
   844         10  ATIMEA PIC  X(0001).
   845     05  ATIMEI PIC  X(0005).
   846*    -------------------------------
   847     05  ANAMEL PIC S9(0004) COMP.
   848     05  ANAMEF PIC  X(0001).
   849     05  FILLER REDEFINES ANAMEF.
   850         10  ANAMEA PIC  X(0001).
   851     05  ANAMEI PIC  X(0030).
   852*    -------------------------------
   853     05  ARTYPL PIC S9(0004) COMP.
   854     05  ARTYPF PIC  X(0001).
   855     05  FILLER REDEFINES ARTYPF.
   856         10  ARTYPA PIC  X(0001).
   857     05  ARTYPI PIC  X(0001).
   858*    -------------------------------
   859     05  CITYL PIC S9(0004) COMP.
   860     05  CITYF PIC  X(0001).
   861     05  FILLER REDEFINES CITYF.
   862         10  CITYA PIC  X(0001).
   863     05  CITYI PIC  X(0015).
   864*    -------------------------------
   865     05  STL PIC S9(0004) COMP.
   866     05  STF PIC  X(0001).
   867     05  FILLER REDEFINES STF.
   868         10  STA PIC  X(0001).
   869     05  STI PIC  X(0002).
   870*    -------------------------------
   871     05  AEMSG1L PIC S9(0004) COMP.
   872     05  AEMSG1F PIC  X(0001).
   873     05  FILLER REDEFINES AEMSG1F.
   874         10  AEMSG1A PIC  X(0001).
   875     05  AEMSG1I PIC  X(0079).
   876*    -------------------------------
   877     05  AEMSG2L PIC S9(0004) COMP.
   878     05  AEMSG2F PIC  X(0001).
   879     05  FILLER REDEFINES AEMSG2F.
   880         10  AEMSG2A PIC  X(0001).
   881     05  AEMSG2I PIC  X(0079).
   882*    -------------------------------
   883     05  APFKL PIC S9(0004) COMP.
   884     05  APFKF PIC  X(0001).
   885     05  FILLER REDEFINES APFKF.
   886         10  APFKA PIC  X(0001).
   887     05  APFKI PIC  99.
   888 01  EL659AO REDEFINES EL659AI.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL659.cbl
   889     05  FILLER            PIC  X(0012).
   890*    -------------------------------
   891     05  FILLER            PIC  X(0003).
   892     05  ADATEO PIC  X(0008).
   893*    -------------------------------
   894     05  FILLER            PIC  X(0003).
   895     05  ATIMEO PIC  99.99.
   896*    -------------------------------
   897     05  FILLER            PIC  X(0003).
   898     05  ANAMEO PIC  X(0030).
   899*    -------------------------------
   900     05  FILLER            PIC  X(0003).
   901     05  ARTYPO PIC  X(0001).
   902*    -------------------------------
   903     05  FILLER            PIC  X(0003).
   904     05  CITYO PIC  X(0015).
   905*    -------------------------------
   906     05  FILLER            PIC  X(0003).
   907     05  STO PIC  X(0002).
   908*    -------------------------------
   909     05  FILLER            PIC  X(0003).
   910     05  AEMSG1O PIC  X(0079).
   911*    -------------------------------
   912     05  FILLER            PIC  X(0003).
   913     05  AEMSG2O PIC  X(0079).
   914*    -------------------------------
   915     05  FILLER            PIC  X(0003).
   916     05  APFKO PIC  99.
   917*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL659.cbl
   919*    COPY ELCATTR.
   920******************************************************************
   921*                                                                *
   922*                            ELCATTR.                            *
   923*                            VMOD=2.001                          *
   924*                                                                *
   925*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   926*                                                                *
   927*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   928*                                                                *
   929*                   POS 1   P=PROTECTED                          *
   930*                           U=UNPROTECTED                        *
   931*                           S=ASKIP                              *
   932*                   POS 2   A=ALPHA/NUMERIC                      *
   933*                           N=NUMERIC                            *
   934*                   POS 3   N=NORMAL                             *
   935*                           B=BRIGHT                             *
   936*                           D=DARK                               *
   937*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   938*                           OF=MODIFIED DATA TAG OFF             *
   939*                                                                *
   940*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   941******************************************************************
   942 01  ATTRIBUTE-LIST.
   943     12  AL-PABOF            PIC X       VALUE 'Y'.
   944     12  AL-PABON            PIC X       VALUE 'Z'.
   945     12  AL-PADOF            PIC X       VALUE '%'.
   946     12  AL-PADON            PIC X       VALUE '_'.
   947     12  AL-PANOF            PIC X       VALUE '-'.
   948     12  AL-PANON            PIC X       VALUE '/'.
   949     12  AL-SABOF            PIC X       VALUE '8'.
   950     12  AL-SABON            PIC X       VALUE '9'.
   951     12  AL-SADOF            PIC X       VALUE '@'.
   952     12  AL-SADON            PIC X       VALUE QUOTE.
   953     12  AL-SANOF            PIC X       VALUE '0'.
   954     12  AL-SANON            PIC X       VALUE '1'.
   955     12  AL-UABOF            PIC X       VALUE 'H'.
   956     12  AL-UABON            PIC X       VALUE 'I'.
   957     12  AL-UADOF            PIC X       VALUE '<'.
   958     12  AL-UADON            PIC X       VALUE '('.
   959     12  AL-UANOF            PIC X       VALUE ' '.
   960     12  AL-UANON            PIC X       VALUE 'A'.
   961     12  AL-UNBOF            PIC X       VALUE 'Q'.
   962     12  AL-UNBON            PIC X       VALUE 'R'.
   963     12  AL-UNDOF            PIC X       VALUE '*'.
   964     12  AL-UNDON            PIC X       VALUE ')'.
   965     12  AL-UNNOF            PIC X       VALUE '&'.
   966     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL659.cbl
   968*    COPY ELCAID.
   969******************************************************************
   970*                                                                *
   971*                            ELCAID.                             *
   972*                            VMOD=2.001                          *
   973*                                                                *
   974*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   975*                                                                *
   976*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   977*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   978******************************************************************
   979
   980 01  DFHAID.
   981   02  DFHNULL   PIC  X  VALUE  ' '.
   982   02  DFHENTER  PIC  X  VALUE  QUOTE.
   983   02  DFHCLEAR  PIC  X  VALUE  '_'.
   984   02  DFHPEN    PIC  X  VALUE  '='.
   985   02  DFHOPID   PIC  X  VALUE  'W'.
   986   02  DFHPA1    PIC  X  VALUE  '%'.
   987   02  DFHPA2    PIC  X  VALUE  '>'.
   988   02  DFHPA3    PIC  X  VALUE  ','.
   989   02  DFHPF1    PIC  X  VALUE  '1'.
   990   02  DFHPF2    PIC  X  VALUE  '2'.
   991   02  DFHPF3    PIC  X  VALUE  '3'.
   992   02  DFHPF4    PIC  X  VALUE  '4'.
   993   02  DFHPF5    PIC  X  VALUE  '5'.
   994   02  DFHPF6    PIC  X  VALUE  '6'.
   995   02  DFHPF7    PIC  X  VALUE  '7'.
   996   02  DFHPF8    PIC  X  VALUE  '8'.
   997   02  DFHPF9    PIC  X  VALUE  '9'.
   998   02  DFHPF10   PIC  X  VALUE  ':'.
   999   02  DFHPF11   PIC  X  VALUE  '#'.
  1000   02  DFHPF12   PIC  X  VALUE  '@'.
  1001   02  DFHPF13   PIC  X  VALUE  'A'.
  1002   02  DFHPF14   PIC  X  VALUE  'B'.
  1003   02  DFHPF15   PIC  X  VALUE  'C'.
  1004   02  DFHPF16   PIC  X  VALUE  'D'.
  1005   02  DFHPF17   PIC  X  VALUE  'E'.
  1006   02  DFHPF18   PIC  X  VALUE  'F'.
  1007   02  DFHPF19   PIC  X  VALUE  'G'.
  1008   02  DFHPF20   PIC  X  VALUE  'H'.
  1009   02  DFHPF21   PIC  X  VALUE  'I'.
  1010*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1011   02  DFHPF22   PIC  X  VALUE  '['.
  1012   02  DFHPF23   PIC  X  VALUE  '.'.
  1013   02  DFHPF24   PIC  X  VALUE  '<'.
  1014   02  DFHMSRE   PIC  X  VALUE  'X'.
  1015   02  DFHSTRF   PIC  X  VALUE  'h'.
  1016   02  DFHTRIG   PIC  X  VALUE  '"'.
  1017
  1018 01  FILLER  REDEFINES  DFHAID.
  1019     12  FILLER                      PIC  X(08).
  1020     12  PF-VALUES                   PIC  X(01)
  1021             OCCURS  24  TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL659.cbl
  1023****************************************************************
  1024*
  1025* Copyright (c) 2007 by Clerity Solutions, Inc.
  1026* All rights reserved.
  1027*
  1028****************************************************************
  1029 01  DFHEIV.
  1030   02  DFHEIV0               PIC X(35).
  1031   02  DFHEIV1               PIC X(08).
  1032   02  DFHEIV2               PIC X(08).
  1033   02  DFHEIV3               PIC X(08).
  1034   02  DFHEIV4               PIC X(06).
  1035   02  DFHEIV5               PIC X(04).
  1036   02  DFHEIV6               PIC X(04).
  1037   02  DFHEIV7               PIC X(02).
  1038   02  DFHEIV8               PIC X(02).
  1039   02  DFHEIV9               PIC X(01).
  1040   02  DFHEIV10              PIC S9(7) COMP-3.
  1041   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1042   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1043   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1044   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1045   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1046   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1047   02  DFHEIV17              PIC X(04).
  1048   02  DFHEIV18              PIC X(04).
  1049   02  DFHEIV19              PIC X(04).
  1050   02  DFHEIV20              USAGE IS POINTER.
  1051   02  DFHEIV21              USAGE IS POINTER.
  1052   02  DFHEIV22              USAGE IS POINTER.
  1053   02  DFHEIV23              USAGE IS POINTER.
  1054   02  DFHEIV24              USAGE IS POINTER.
  1055   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1056   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1057   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1058   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1059   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1060   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1061   02  FILLER                PIC X(02).
  1062   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1063   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1064   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1065   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1066   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1067 LINKAGE  SECTION.
  1068*****************************************************************
  1069*                                                               *
  1070* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1071* All rights reserved.                                          *
  1072*                                                               *
  1073*****************************************************************
  1074 01  dfheiblk.
  1075     02  eibtime          pic s9(7) comp-3.
  1076     02  eibdate          pic s9(7) comp-3.
  1077     02  eibtrnid         pic x(4).
  1078     02  eibtaskn         pic s9(7) comp-3.
  1079     02  eibtrmid         pic x(4).
  1080     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL659.cbl
  1081     02  eibcposn         pic s9(4) comp.
  1082     02  eibcalen         pic s9(4) comp.
  1083     02  eibaid           pic x(1).
  1084     02  eibfiller1       pic x(1).
  1085     02  eibfn            pic x(2).
  1086     02  eibfiller2       pic x(2).
  1087     02  eibrcode         pic x(6).
  1088     02  eibfiller3       pic x(2).
  1089     02  eibds            pic x(8).
  1090     02  eibreqid         pic x(8).
  1091     02  eibrsrce         pic x(8).
  1092     02  eibsync          pic x(1).
  1093     02  eibfree          pic x(1).
  1094     02  eibrecv          pic x(1).
  1095     02  eibsend          pic x(1).
  1096     02  eibatt           pic x(1).
  1097     02  eibeoc           pic x(1).
  1098     02  eibfmh           pic x(1).
  1099     02  eibcompl         pic x(1).
  1100     02  eibsig           pic x(1).
  1101     02  eibconf          pic x(1).
  1102     02  eiberr           pic x(1).
  1103     02  eibrldbk         pic x(1).
  1104     02  eiberrcd         pic x(4).
  1105     02  eibsynrb         pic x(1).
  1106     02  eibnodat         pic x(1).
  1107     02  eibfiller5       pic x(2).
  1108     02  eibresp          pic 9(09) comp.
  1109     02  eibresp2         pic 9(09) comp.
  1110     02  dfheigdj         pic s9(4) comp.
  1111     02  dfheigdk         pic s9(4) comp.
  1112
  1113 01  DFHCOMMAREA                     PIC  X(1024).
  1114
  1115*01 PARMLIST             COMP  SYNC.
  1116*    12  FILLER                      PIC S9(09).
  1117*    12  ERNAME-POINTER              PIC S9(09).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL659.cbl
  1119*    COPY ERCNAME.
  1120******************************************************************
  1121*                                                                *
  1122*                                                                *
  1123*                            ERCNAME                             *
  1124*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1125*                            VMOD=2.003                          *
  1126*                                                                *
  1127*   CREDIT SYSTEM ACCOUNT MASTER NAME, COMPENSATION MASTER       *
  1128*       NAME, REINSURANCE COMPANY NAME LOOKUP FILE.              *
  1129*                                                                *
  1130*   FILE DESCRIPTION = NAME LOOKUP FILE                          *
  1131*                                                                *
  1132*   FILE TYPE = VSAM,KSDS                                        *
  1133*   RECORD SIZE = 160   RECFORM = FIX                            *
  1134*                                                                *
  1135*   BASE CLUSTER NAME = ERNAME                    RKP=2,LEN=61   *
  1136*                                                                *
  1137*   LOG = NO                                                     *
  1138*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1139*                                                                *
  1140*                                                                *
  1141******************************************************************
  1142
  1143 01  NAME-LOOKUP-MASTER.
  1144     12  NL-RECORD-ID                PIC  X(02).
  1145         88  VALID-NL-ID                         VALUE 'NL'.
  1146
  1147     12  NL-RECORD-KEY.
  1148         16  NL-CONTROL-PRIMARY.
  1149             20  NL-COMPANY-CD       PIC  X(01).
  1150             20  NL-NAME             PIC  X(30).
  1151             20  NL-RECORD-TYPE      PIC  X(01).
  1152                 88  NL-ACCOUNT-TYPE             VALUE 'A'.
  1153                 88  NL-COMPENSATION-TYPE        VALUE 'C'.
  1154                 88  NL-REINSURANCE-TYPE         VALUE 'R'.
  1155
  1156         16  NL-ACCOUNT-MASTER.
  1157             20  NL-AM-COMPANY-CD    PIC  X(01).
  1158             20  NL-AM-CARRIER       PIC  X(01).
  1159             20  NL-AM-GROUPING      PIC  X(06).
  1160             20  NL-AM-STATE         PIC  X(02).
  1161             20  NL-AM-ACCOUNT       PIC  X(10).
  1162             20  FILLER              PIC  X(09).
  1163
  1164         16  NL-COMPENSATION-MASTER
  1165                                 REDEFINES  NL-ACCOUNT-MASTER.
  1166             20  NL-CO-COMPANY-CD    PIC  X(01).
  1167             20  NL-CO-CARRIER       PIC  X(01).
  1168             20  NL-CO-GROUPING      PIC  X(06).
  1169             20  NL-CO-RESP-NO       PIC  X(10).
  1170             20  NL-CO-ACCOUNT       PIC  X(10).
  1171             20  NL-CO-TYPE          PIC  X(01).
  1172
  1173         16  NL-REINSURANCE-RECORD
  1174                                 REDEFINES  NL-ACCOUNT-MASTER.
  1175             20  NL-RE-COMPANY-CD    PIC  X(01).
  1176             20  NL-RE-CODE          PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL659.cbl
  1177             20  NL-RE-COMPANY.
  1178                 24  NL-RE-COMP      PIC  X(03).
  1179                 24  NL-RE-CO-SUB    PIC  X(03).
  1180             20  NL-RE-TABLE         PIC  X(03).
  1181             20  FILLER              PIC  X(18).
  1182
  1183     12  NL-MAINT-INFORMATION.
  1184         16  NL-LAST-MAINT-DT        PIC  X(02).
  1185         16  NL-LAST-MAINT-HHMMSS    PIC S9(07)  COMP-3.
  1186         16  NL-LAST-MAINT-USER      PIC  X(04).
  1187         16  FILLER                  PIC  X(10).
  1188
  1189     12  NL-RE-LEVELS  OCCURS  30  TIMES.
  1190         16  NL-RE-LEVEL             PIC  9(02).
  1191
  1192     12  NL-CITY                     PIC  X(15).
  1193     12  NL-ST                       PIC  XX.
  1194
  1195******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL659.cbl
  1197 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  1198                          NAME-LOOKUP-MASTER.
  1199 0000-DFHEXIT SECTION.
  1200     MOVE '9#                    $   ' TO DFHEIV0.
  1201     MOVE 'EL659' TO DFHEIV1.
  1202     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1203
  1204     MOVE EIBDATE                TO  DC-JULIAN-YYDDD.
  1205     MOVE '5'                    TO  DC-OPTION-CODE.
  1206
  1207     PERFORM 7000-DATE-CONVERSION.
  1208
  1209     MOVE DC-GREG-DATE-1-EDIT    TO  SAVE-DATE.
  1210     MOVE DC-BIN-DATE-1          TO  SAVE-BIN-DATE.
  1211     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  1212     MOVE +2                     TO  EMI-NUMBER-OF-LINES
  1213                                     EMI-SWITCH2.
  1214
  1215*    NOTE *******************************************************
  1216*         *                                                     *
  1217*         *      ACCESS TO THIS MODULE CAN BE ONLY FROM AN XCTL *
  1218*         *  FROM ANOTHER MODULE.                               *
  1219*         *                                                     *
  1220*         *******************************************************.
  1221
  1222     IF EIBCALEN  IS NOT GREATER THAN  ZERO
  1223         MOVE UNACCESS-MSG       TO  LOGOFF-MSG
  1224         GO TO 6000-SEND-TEXT.
  1225
  1226
  1227* EXEC CICS HANDLE CONDITION
  1228*        PGMIDERR  (9400-PGMIDERR)
  1229*        NOTFND    (1020-NOTFND)
  1230*        ENDFILE   (1020-NOTFND)
  1231*        ERROR     (9600-ERROR)
  1232*    END-EXEC.
  1233*    MOVE '"$LI''.                ! " #00001222' TO DFHEIV0
  1234     MOVE X'22244C49272E202020202020' TO DFHEIV0(1:12)
  1235     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1236     MOVE X'2220233030303031323232' TO DFHEIV0(25:11)
  1237     CALL 'kxdfhei1' USING DFHEIV0
  1238     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1239
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL659.cbl
  1241 0100-MAIN-LOGIC.
  1242     IF PI-CALLING-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  1243         IF PI-RETURN-TO-PROGRAM  IS NOT EQUAL TO  THIS-PGM
  1244             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-6
  1245             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-5
  1246             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-4
  1247             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-3
  1248             MOVE PI-SAVED-PROGRAM-1    TO  PI-SAVED-PROGRAM-2
  1249             MOVE PI-RETURN-TO-PROGRAM  TO  PI-SAVED-PROGRAM-1
  1250             MOVE PI-CALLING-PROGRAM    TO  PI-RETURN-TO-PROGRAM
  1251             MOVE THIS-PGM              TO  PI-CALLING-PROGRAM
  1252         ELSE
  1253             MOVE PI-RETURN-TO-PROGRAM  TO  PI-CALLING-PROGRAM
  1254             MOVE PI-SAVED-PROGRAM-1    TO  PI-RETURN-TO-PROGRAM
  1255             MOVE PI-SAVED-PROGRAM-2    TO  PI-SAVED-PROGRAM-1
  1256             MOVE PI-SAVED-PROGRAM-3    TO  PI-SAVED-PROGRAM-2
  1257             MOVE PI-SAVED-PROGRAM-4    TO  PI-SAVED-PROGRAM-3
  1258             MOVE PI-SAVED-PROGRAM-5    TO  PI-SAVED-PROGRAM-4
  1259             MOVE PI-SAVED-PROGRAM-6    TO  PI-SAVED-PROGRAM-5
  1260             MOVE SPACES                TO  PI-SAVED-PROGRAM-6
  1261             PERFORM 3000-BUILD-SCREEN
  1262     ELSE
  1263         GO TO 0120-MAIN-LOGIC.
  1264
  1265 0110-MAIN-LOGIC.
  1266*    NOTE *******************************************************
  1267*         *      INITALIZE THE WORK FIELDS FOR THE PROGRAM      *
  1268*         *  INTERFACE BLOCK FOR THIS MODULE.                   *
  1269*         *******************************************************.
  1270
  1271     MOVE SPACES                 TO  PI-PROGRAM-WORK-AREA
  1272                                     PI-CONTROL-IN-PROGRESS.
  1273     MOVE ZERO                   TO  PI-1ST-TIME-SW
  1274                                     PI-LINE-COUNT
  1275                                     PI-BROWSE-SW
  1276                                     PI-KEY-LENGTH
  1277                                     PI-TS-ITEM
  1278                                     PI-END-OF-FILE
  1279                                     PI-START-SW.
  1280
  1281*    NOTE *******************************************************
  1282*         *      I ADDED THE DELETES TO SEE IF THIS WILL FIX    *
  1283*         *  THE IR 2005041400004. IT APPEARS THAT THE ONLY     *
  1284*         *  TIME IT HAPPENS IS IN THIS PROGRAM AND EL6592      *
  1285*         *  IT SEEMS LIKE EL6592 CLEANS UP AFTER ITSELF OKAY   *
  1286*         *******************************************************
  1287         MOVE EIBTRMID           TO  WS-TSK-TERM-ID
  1288                                     WS-TSK-TERM-ID1
  1289
  1290* EXEC CICS DELETEQ TS
  1291*            QUEUE  (WS-TEMP-STORAGE-KEY)
  1292*            RESP   (WS-RESPONSE)
  1293*        END-EXEC
  1294*    MOVE '*&                    #  N#00001277' TO DFHEIV0
  1295     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  1296     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1297     MOVE X'204E233030303031323737' TO DFHEIV0(25:11)
  1298     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL659.cbl
  1299           WS-TEMP-STORAGE-KEY,
  1300           DFHEIV99
  1301     MOVE EIBRESP  TO WS-RESPONSE
  1302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1303
  1304* EXEC CICS DELETEQ TS
  1305*            QUEUE  (WS-TEMP-STORAGE-KEY1)
  1306*            RESP   (WS-RESPONSE)
  1307*        END-EXEC
  1308*    MOVE '*&                    #  N#00001281' TO DFHEIV0
  1309     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  1310     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1311     MOVE X'204E233030303031323831' TO DFHEIV0(25:11)
  1312     CALL 'kxdfhei1' USING DFHEIV0,
  1313           WS-TEMP-STORAGE-KEY1,
  1314           DFHEIV99
  1315     MOVE EIBRESP  TO WS-RESPONSE
  1316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1317*    NOTE *******************************************************
  1318*         *      SEND THE INITIAL MAP OUT TO BEGIN PROCESSING   *
  1319*         *  FOR EL659.                                         *
  1320*         *******************************************************.
  1321
  1322     MOVE LOW-VALUES             TO  EL659AO.
  1323
  1324     PERFORM 4000-SEND-INITIAL-MAP.
  1325
  1326     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL659.cbl
  1328 0120-MAIN-LOGIC.
  1329     IF PI-1ST-TIME-SW  IS NOT EQUAL TO  ZERO
  1330         GO TO 0110-MAIN-LOGIC.
  1331
  1332*    NOTE *******************************************************
  1333*         *      AFTER THE FIRST TIME THROUGH THE PROPER ATTEN- *
  1334*         *  TION KEY USAGE NEEDS TO BE CHECKED FOR VALIDITY    *
  1335*         *  BEFORE ANY FURTHER PROCESSING CAN BE DONE.         *
  1336*         *******************************************************.
  1337
  1338     IF EIBAID  IS EQUAL TO  DFHCLEAR
  1339         GO TO 9300-CLEAR.
  1340
  1341     IF EIBAID  IS EQUAL TO  DFHPA1  OR  DFHPA2  OR  DFHPA3
  1342         MOVE LOW-VALUES         TO  EL659AO
  1343         MOVE -1                 TO  APFKL
  1344         MOVE ER-0008            TO  EMI-ERROR
  1345         PERFORM 5000-SEND-DATA-ONLY
  1346         GO TO 9100-RETURN-TRAN.
  1347
  1348
  1349* EXEC CICS RECEIVE
  1350*        INTO    (EL659AI)
  1351*        MAPSET  (WS-MAPSET-NAME)
  1352*        MAP     (WS-MAP-NAME)
  1353*    END-EXEC.
  1354     MOVE LENGTH OF
  1355      EL659AI
  1356       TO DFHEIV11
  1357*    MOVE '8"T I  L              ''   #00001316' TO DFHEIV0
  1358     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1359     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1360     MOVE X'2020233030303031333136' TO DFHEIV0(25:11)
  1361     CALL 'kxdfhei1' USING DFHEIV0,
  1362           WS-MAP-NAME,
  1363           EL659AI,
  1364           DFHEIV11,
  1365           WS-MAPSET-NAME,
  1366           DFHEIV99,
  1367           DFHEIV99
  1368     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1369
  1370
  1371     IF APFKL  IS GREATER THAN  ZERO
  1372         IF EIBAID  IS NOT EQUAL TO  DFHENTER
  1373             MOVE ER-0004        TO  EMI-ERROR
  1374             MOVE AL-UNBOF       TO  APFKA
  1375             MOVE -1             TO  APFKL
  1376             PERFORM 5000-SEND-DATA-ONLY
  1377             GO TO 9100-RETURN-TRAN
  1378         ELSE
  1379             IF APFKO  IS NUMERIC
  1380                 IF APFKO  IS GREATER THAN  0
  1381                   AND APFKO  IS LESS THAN  25
  1382                     MOVE PF-VALUES (APFKI)
  1383                                 TO  EIBAID
  1384                 ELSE
  1385                     MOVE ER-0029
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL659.cbl
  1386                                 TO  EMI-ERROR
  1387                     MOVE AL-UNBOF
  1388                                 TO  APFKA
  1389                     MOVE -1     TO  APFKL
  1390                     PERFORM 5000-SEND-DATA-ONLY
  1391                     GO TO 9100-RETURN-TRAN.
  1392
  1393     IF EIBAID  IS EQUAL TO  DFHPF12
  1394         MOVE 'EL010'            TO  THIS-PGM
  1395         GO TO 9200-XCTL.
  1396
  1397     IF EIBAID  IS EQUAL TO  DFHPF23
  1398         GO TO 9000-RETURN-CICS.
  1399
  1400     IF EIBAID  IS EQUAL TO  DFHPF24
  1401         MOVE 'EL126'            TO  THIS-PGM
  1402         GO TO 9200-XCTL.
  1403
  1404     IF EIBAID  IS EQUAL TO  DFHENTER
  1405         NEXT SENTENCE
  1406     ELSE
  1407         MOVE ER-0008            TO  EMI-ERROR
  1408         MOVE -1                 TO  APFKL
  1409         PERFORM 5000-SEND-DATA-ONLY
  1410         GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL659.cbl
  1412 0130-MAIN-LOGIC.
  1413     MOVE SPACES                 TO  PI-SELECTION-CRITERIA
  1414                                     PI-NAME-LOOKUP-KEY
  1415                                     PI-CITY
  1416                                     PI-ST.
  1417     MOVE PI-COMPANY-CD          TO  PI-SC-COMPANY-CD
  1418                                     PI-NLK-COMPANY-CD.
  1419
  1420     IF PI-PROCESSOR-ID  IS EQUAL TO  'LGXX'
  1421         NEXT SENTENCE
  1422     ELSE
  1423
  1424* EXEC CICS READQ TS
  1425*            QUEUE   (PI-SECURITY-TEMP-STORE-ID)
  1426*            INTO    (SECURITY-CONTROL)
  1427*            LENGTH  (SC-COMM-LENGTH)
  1428*            ITEM    (SC-ITEM)
  1429*        END-EXEC
  1430*    MOVE '*$II   L              ''   #00001374' TO DFHEIV0
  1431     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1432     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1433     MOVE X'2020233030303031333734' TO DFHEIV0(25:11)
  1434     CALL 'kxdfhei1' USING DFHEIV0,
  1435           PI-SECURITY-TEMP-STORE-ID,
  1436           SECURITY-CONTROL,
  1437           SC-COMM-LENGTH,
  1438           SC-ITEM,
  1439           DFHEIV99,
  1440           DFHEIV99
  1441     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1442         MOVE SC-CREDIT-DISPLAY (31)
  1443                                 TO  PI-DISPLAY-CAP
  1444         MOVE SC-CREDIT-UPDATE  (31)
  1445                                 TO  PI-MODIFY-CAP
  1446         IF NOT DISPLAY-CAP
  1447             MOVE 'READ'         TO  SM-READ
  1448             PERFORM 9700-SECURITY-VIOLATION
  1449             MOVE ER-0070        TO  EMI-ERROR
  1450             PERFORM 4000-SEND-INITIAL-MAP
  1451             GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL659.cbl
  1453 0200-DETERMINE-OPTION.
  1454     MOVE ZERO                   TO  PI-OPTION.
  1455     MOVE WS-ERNAME-DSID         TO  PI-DSID.
  1456     MOVE +1                     TO  PI-KEY-LENGTH.
  1457     MOVE +0                     TO  PI-CITY-LENGTH.
  1458
  1459     IF ANAMEL GREATER ZERO
  1460         MOVE ANAMEI             TO  PI-SC-NAME
  1461                                     WS-INPUT-FIELD
  1462         PERFORM 0220-GET-KEY-LENGTH THRU 0229-EXIT
  1463             VARYING INPUT-INDEX FROM ANAMEL BY -1
  1464                 UNTIL WS-INPUT-CHAR (INPUT-INDEX)
  1465                  NOT = SPACE
  1466         ADD ANAMEL              TO  PI-KEY-LENGTH
  1467         MOVE -1                 TO  ANAMEL
  1468         MOVE '1'                TO  PI-OPTION.
  1469
  1470     IF ARTYPL GREATER ZERO
  1471       IF ARTYPI = 'A' OR 'C' OR 'R'
  1472           MOVE ARTYPI           TO  PI-SC-RECORD-TYPE
  1473           IF PI-SC-NAME NOT = SPACES
  1474               MOVE '2'          TO  PI-OPTION
  1475             ELSE
  1476               MOVE '3'          TO  PI-OPTION
  1477         ELSE
  1478           MOVE ER-0647          TO  EMI-ERROR
  1479           MOVE ZERO             TO  ANAMEL
  1480           MOVE -1               TO  ARTYPL
  1481           PERFORM 5000-SEND-DATA-ONLY
  1482           GO TO 9100-RETURN-TRAN.
  1483
  1484     IF CITYL GREATER ZERO
  1485         MOVE CITYI              TO  PI-CITY
  1486                                     WS-INPUT-FIELD
  1487         PERFORM 0230-GET-CITY-LENGTH THRU 0239-EXIT
  1488             VARYING INPUT-INDEX FROM CITYL BY -1
  1489                 UNTIL WS-INPUT-CHAR (INPUT-INDEX)
  1490                  NOT = SPACE
  1491         ADD CITYL               TO  PI-CITY-LENGTH.
  1492
  1493     IF STL GREATER ZERO
  1494         MOVE STI                TO  PI-ST.
  1495
  1496     MOVE PI-SELECTION-CRITERIA  TO  PI-NAME-LOOKUP-KEY.
  1497
  1498     GO TO 1000-READ-NAME-LOOKUP.
  1499
  1500 0220-GET-KEY-LENGTH.
  1501     SUBTRACT +1                 FROM  ANAMEL.
  1502
  1503 0229-EXIT.
  1504      EXIT.
  1505
  1506 0230-GET-CITY-LENGTH.
  1507     SUBTRACT +1                 FROM  CITYL.
  1508
  1509 0239-EXIT.
  1510      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL659.cbl
  1511
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL659.cbl
  1513 1000-READ-NAME-LOOKUP  SECTION.
  1514
  1515* EXEC CICS HANDLE CONDITION
  1516*        DUPKEY   (9200-XCTL)
  1517*        NOTFND   (1020-NOTFND)
  1518*        DSIDERR  (1010-DSIDERR)
  1519*    END-EXEC.
  1520*    MOVE '"$$I"                 ! # #00001452' TO DFHEIV0
  1521     MOVE X'222424492220202020202020' TO DFHEIV0(1:12)
  1522     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1523     MOVE X'2320233030303031343532' TO DFHEIV0(25:11)
  1524     CALL 'kxdfhei1' USING DFHEIV0
  1525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1526
  1527
  1528     MOVE +1                     TO  PI-START-SW.
  1529
  1530
  1531* EXEC CICS READ
  1532*        DATASET    (PI-DSID)
  1533*        RIDFLD     (PI-NAME-LOOKUP-KEY)
  1534*        SET        (ADDRESS OF NAME-LOOKUP-MASTER)
  1535*        GENERIC
  1536*        EQUAL
  1537*        KEYLENGTH  (PI-KEY-LENGTH)
  1538*    END-EXEC.
  1539*    MOVE '&"S  KG    E          (   #00001460' TO DFHEIV0
  1540     MOVE X'26225320204B472020202045' TO DFHEIV0(1:12)
  1541     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1542     MOVE X'2020233030303031343630' TO DFHEIV0(25:11)
  1543     CALL 'kxdfhei1' USING DFHEIV0,
  1544           PI-DSID,
  1545           DFHEIV20,
  1546           DFHEIV99,
  1547           PI-NAME-LOOKUP-KEY,
  1548           PI-KEY-LENGTH,
  1549           DFHEIV99,
  1550           DFHEIV99
  1551     SET ADDRESS OF NAME-LOOKUP-MASTER TO
  1552         DFHEIV20
  1553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1554
  1555
  1556     IF NL-COMPANY-CD  IS EQUAL TO  PI-COMPANY-CD
  1557         NEXT SENTENCE
  1558     ELSE
  1559         GO TO 1020-NOTFND.
  1560
  1561     MOVE 'EL6592'               TO  THIS-PGM.
  1562
  1563     GO TO 9200-XCTL.
  1564
  1565 1010-DSIDERR.
  1566     MOVE ER-0671                TO  EMI-ERROR.
  1567
  1568     PERFORM 5000-SEND-DATA-ONLY.
  1569
  1570     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL659.cbl
  1571
  1572 1020-NOTFND.
  1573     MOVE ER-0673                TO  EMI-ERROR.
  1574
  1575     PERFORM 5000-SEND-DATA-ONLY.
  1576
  1577     GO TO 9100-RETURN-TRAN.
  1578
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL659.cbl
  1580 3000-BUILD-SCREEN  SECTION.
  1581******************************************************************
  1582*          REBUILD ORIGNAL SCREEN AND ERROR MESSAGE IF EL6592    *
  1583*          DID NOT FIND ANY CERTIFICATES DURING BROWSE OF FILE.  *
  1584******************************************************************
  1585
  1586     IF EIBTRNID  IS EQUAL TO  WS-TRANS-ID
  1587         NEXT SENTENCE
  1588     ELSE
  1589         GO TO 3099-EXIT.
  1590
  1591     IF PI-BROWSE-SW  IS EQUAL TO  +9
  1592         NEXT SENTENCE
  1593     ELSE
  1594         GO TO 3099-EXIT.
  1595
  1596     MOVE LOW-VALUES             TO  EL659AO.
  1597     MOVE ER-0673                TO  EMI-ERROR.
  1598
  1599     IF PI-ST GREATER SPACES
  1600         MOVE PI-ST              TO  STO
  1601         MOVE AL-UABON           TO  STA
  1602         MOVE -1                 TO  STL.
  1603
  1604     IF PI-CITY GREATER SPACES
  1605         MOVE PI-CITY            TO  CITYO
  1606         MOVE AL-UABON           TO  CITYA
  1607         MOVE -1                 TO  CITYL.
  1608
  1609     IF PI-SC-RECORD-TYPE GREATER SPACES
  1610         MOVE PI-SC-RECORD-TYPE  TO  ARTYPO
  1611         MOVE AL-UABON           TO  ARTYPA
  1612         MOVE -1                 TO  ARTYPL.
  1613
  1614     IF PI-SC-NAME GREATER SPACES
  1615         MOVE PI-SC-NAME         TO  ANAMEO
  1616         MOVE AL-UABON           TO  ANAMEA
  1617         MOVE -1                 TO  ANAMEL.
  1618
  1619 3040-INITIALIZE-WORK-AREAS.
  1620     MOVE SPACES                 TO  PI-PROGRAM-WORK-AREA
  1621                                     PI-CONTROL-IN-PROGRESS.
  1622     MOVE ZERO                   TO  PI-1ST-TIME-SW
  1623                                     PI-LINE-COUNT
  1624                                     PI-BROWSE-SW
  1625                                     PI-KEY-LENGTH
  1626                                     PI-TS-ITEM
  1627                                     PI-END-OF-FILE
  1628                                     PI-START-SW.
  1629
  1630     PERFORM 5000-SEND-DATA-ONLY.
  1631
  1632     GO TO 9100-RETURN-TRAN.
  1633
  1634 3099-EXIT.
  1635     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL659.cbl
  1637 4000-SEND-INITIAL-MAP  SECTION.
  1638     MOVE -1                     TO  ANAMEL.
  1639     MOVE SAVE-DATE              TO  ADATEO.
  1640     MOVE EIBTIME                TO  TIME-IN.
  1641     MOVE TIME-OUT               TO  ATIMEO.
  1642
  1643     IF EMI-ERROR  IS NOT EQUAL TO  ZERO
  1644         PERFORM 9500-ERROR-FORMAT.
  1645
  1646     MOVE EMI-MESSAGE-AREA (1)   TO  AEMSG1O.
  1647     MOVE EMI-MESSAGE-AREA (2)   TO  AEMSG2O.
  1648
  1649
  1650* EXEC CICS SEND
  1651*        FROM    (EL659AO)
  1652*        MAPSET  (WS-MAPSET-NAME)
  1653*        MAP     (WS-MAP-NAME)
  1654*        CURSOR
  1655*        ERASE
  1656*    END-EXEC.
  1657     MOVE LENGTH OF
  1658      EL659AO
  1659       TO DFHEIV12
  1660     MOVE -1
  1661       TO DFHEIV11
  1662*    MOVE '8$     CT  E    H L F ,   #00001562' TO DFHEIV0
  1663     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1664     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1665     MOVE X'2020233030303031353632' TO DFHEIV0(25:11)
  1666     CALL 'kxdfhei1' USING DFHEIV0,
  1667           WS-MAP-NAME,
  1668           EL659AO,
  1669           DFHEIV12,
  1670           WS-MAPSET-NAME,
  1671           DFHEIV99,
  1672           DFHEIV99,
  1673           DFHEIV99,
  1674           DFHEIV11,
  1675           DFHEIV99,
  1676           DFHEIV99,
  1677           DFHEIV99
  1678     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1679
  1680
  1681 4099-EXIT.
  1682     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL659.cbl
  1684 5000-SEND-DATA-ONLY SECTION.
  1685     MOVE SAVE-DATE              TO  ADATEO.
  1686     MOVE EIBTIME                TO  TIME-IN.
  1687     MOVE TIME-OUT               TO  ATIMEO.
  1688
  1689     IF EMI-ERROR  IS NOT EQUAL TO  ZERO
  1690         PERFORM 9500-ERROR-FORMAT.
  1691
  1692     MOVE EMI-MESSAGE-AREA (1)   TO  AEMSG1O.
  1693     MOVE EMI-MESSAGE-AREA (2)   TO  AEMSG2O.
  1694
  1695
  1696* EXEC CICS SEND DATAONLY
  1697*        FROM    (EL659AO)
  1698*        MAPSET  (WS-MAPSET-NAME)
  1699*        MAP     (WS-MAP-NAME)
  1700*        CURSOR
  1701*    END-EXEC.
  1702     MOVE LENGTH OF
  1703      EL659AO
  1704       TO DFHEIV12
  1705     MOVE -1
  1706       TO DFHEIV11
  1707*    MOVE '8$D    CT       H L F ,   #00001584' TO DFHEIV0
  1708     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  1709     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1710     MOVE X'2020233030303031353834' TO DFHEIV0(25:11)
  1711     CALL 'kxdfhei1' USING DFHEIV0,
  1712           WS-MAP-NAME,
  1713           EL659AO,
  1714           DFHEIV12,
  1715           WS-MAPSET-NAME,
  1716           DFHEIV99,
  1717           DFHEIV99,
  1718           DFHEIV99,
  1719           DFHEIV11,
  1720           DFHEIV99,
  1721           DFHEIV99,
  1722           DFHEIV99
  1723     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1724
  1725
  1726 5099-EXIT.
  1727     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL659.cbl
  1729 6000-SEND-TEXT  SECTION.
  1730
  1731* EXEC CICS SEND TEXT
  1732*        FROM    (LOGOFF-TEXT)
  1733*        LENGTH  (LOGOFF-LENGTH)
  1734*        ERASE
  1735*        FREEKB
  1736*    END-EXEC.
  1737*    MOVE '8&      T  E F  H   F -   #00001595' TO DFHEIV0
  1738     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  1739     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  1740     MOVE X'2020233030303031353935' TO DFHEIV0(25:11)
  1741     CALL 'kxdfhei1' USING DFHEIV0,
  1742           LOGOFF-TEXT,
  1743           LOGOFF-LENGTH,
  1744           DFHEIV99,
  1745           DFHEIV99,
  1746           DFHEIV99,
  1747           DFHEIV99,
  1748           DFHEIV99,
  1749           DFHEIV99,
  1750           DFHEIV99,
  1751           DFHEIV99,
  1752           DFHEIV99,
  1753           DFHEIV99
  1754     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1755
  1756
  1757
  1758* EXEC CICS RETURN
  1759*        END-EXEC.
  1760*    MOVE '.(                    &   #00001602' TO DFHEIV0
  1761     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1762     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1763     MOVE X'2020233030303031363032' TO DFHEIV0(25:11)
  1764     CALL 'kxdfhei1' USING DFHEIV0,
  1765           DFHEIV99,
  1766           DFHEIV99,
  1767           DFHEIV99,
  1768           DFHEIV99,
  1769           DFHEIV99
  1770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1771
  1772
  1773 6099-EXIT.
  1774     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL659.cbl
  1776 7000-DATE-CONVERSION  SECTION.
  1777
  1778* EXEC CICS LINK
  1779*        PROGRAM   ('ELDATCV')
  1780*        COMMAREA  (DATE-CONVERSION-DATA)
  1781*        LENGTH    (DC-COMM-LENGTH)
  1782*    END-EXEC.
  1783     MOVE 'ELDATCV' TO DFHEIV1
  1784*    MOVE '."C                   ''   #00001609' TO DFHEIV0
  1785     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1786     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1787     MOVE X'2020233030303031363039' TO DFHEIV0(25:11)
  1788     CALL 'kxdfhei1' USING DFHEIV0,
  1789           DFHEIV1,
  1790           DATE-CONVERSION-DATA,
  1791           DC-COMM-LENGTH,
  1792           DFHEIV99,
  1793           DFHEIV99,
  1794           DFHEIV99
  1795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1796
  1797
  1798 7099-EXIT.
  1799     EXIT.
  1800
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL659.cbl
  1802 9000-RETURN-CICS  SECTION.
  1803     MOVE 'EL005'                TO  THIS-PGM.
  1804     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  1805
  1806     GO TO 9200-XCTL.
  1807
  1808 9099-EXIT.
  1809     EXIT.
  1810
  1811 9100-RETURN-TRAN  SECTION.
  1812     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  1813     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  1814
  1815
  1816* EXEC CICS RETURN
  1817*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  1818*        LENGTH    (PI-COMM-LENGTH)
  1819*        TRANSID   (WS-TRANS-ID)
  1820*    END-EXEC.
  1821*    MOVE '.(CT                  &   #00001632' TO DFHEIV0
  1822     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1823     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1824     MOVE X'2020233030303031363332' TO DFHEIV0(25:11)
  1825     CALL 'kxdfhei1' USING DFHEIV0,
  1826           WS-TRANS-ID,
  1827           PROGRAM-INTERFACE-BLOCK,
  1828           PI-COMM-LENGTH,
  1829           DFHEIV99,
  1830           DFHEIV99
  1831     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1832
  1833
  1834 9199-EXIT.
  1835     EXIT.
  1836
  1837 9200-XCTL  SECTION.
  1838     MOVE DFHENTER               TO  EIBAID.
  1839
  1840
  1841* EXEC CICS XCTL
  1842*        PROGRAM   (THIS-PGM)
  1843*        COMMAREA  (PROGRAM-INTERFACE-BLOCK)
  1844*        LENGTH    (PI-COMM-LENGTH)
  1845*    END-EXEC.
  1846*    MOVE '.$C                   $   #00001644' TO DFHEIV0
  1847     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  1848     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1849     MOVE X'2020233030303031363434' TO DFHEIV0(25:11)
  1850     CALL 'kxdfhei1' USING DFHEIV0,
  1851           THIS-PGM,
  1852           PROGRAM-INTERFACE-BLOCK,
  1853           PI-COMM-LENGTH
  1854     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1855
  1856
  1857 9299-EXIT.
  1858     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL659.cbl
  1860 9300-CLEAR  SECTION.
  1861     MOVE PI-RETURN-TO-PROGRAM   TO  THIS-PGM.
  1862
  1863     GO TO 9200-XCTL.
  1864
  1865 9399-EXIT.
  1866     EXIT.
  1867
  1868 9400-PGMIDERR  SECTION.
  1869
  1870* EXEC CICS HANDLE CONDITION
  1871*        PGMIDERR  (6000-SEND-TEXT)
  1872*    END-EXEC.
  1873*    MOVE '"$L                   ! $ #00001662' TO DFHEIV0
  1874     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  1875     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1876     MOVE X'2420233030303031363632' TO DFHEIV0(25:11)
  1877     CALL 'kxdfhei1' USING DFHEIV0
  1878     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1879
  1880
  1881     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  1882                                     LOGOFF-PGM.
  1883     MOVE 'EL005'                TO  THIS-PGM.
  1884     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  1885     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  1886
  1887     GO TO 9200-XCTL.
  1888
  1889 9499-EXIT.
  1890     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL659.cbl
  1892 9500-ERROR-FORMAT  SECTION.
  1893
  1894* EXEC CICS LINK
  1895*        PROGRAM   ('EL001')
  1896*        COMMAREA  (ERROR-MESSAGE-INTERFACE-BLOCK)
  1897*        LENGTH    (EMI-COMM-LENGTH)
  1898*    END-EXEC.
  1899     MOVE 'EL001' TO DFHEIV1
  1900*    MOVE '."C                   ''   #00001678' TO DFHEIV0
  1901     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1902     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1903     MOVE X'2020233030303031363738' TO DFHEIV0(25:11)
  1904     CALL 'kxdfhei1' USING DFHEIV0,
  1905           DFHEIV1,
  1906           ERROR-MESSAGE-INTERFACE-BLOCK,
  1907           EMI-COMM-LENGTH,
  1908           DFHEIV99,
  1909           DFHEIV99,
  1910           DFHEIV99
  1911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1912
  1913
  1914 9599-EXIT.
  1915     EXIT.
  1916
  1917 9600-ERROR  SECTION.
  1918     MOVE DFHEIBLK               TO  EMI-LINE1.
  1919
  1920
  1921* EXEC CICS LINK
  1922*        PROGRAM   ('EL004')
  1923*        COMMAREA  (EMI-LINE1)
  1924*        LENGTH    (72)
  1925*    END-EXEC.
  1926     MOVE 'EL004' TO DFHEIV1
  1927     MOVE 72
  1928       TO DFHEIV11
  1929*    MOVE '."C                   ''   #00001690' TO DFHEIV0
  1930     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1931     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1932     MOVE X'2020233030303031363930' TO DFHEIV0(25:11)
  1933     CALL 'kxdfhei1' USING DFHEIV0,
  1934           DFHEIV1,
  1935           EMI-LINE1,
  1936           DFHEIV11,
  1937           DFHEIV99,
  1938           DFHEIV99,
  1939           DFHEIV99
  1940     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1941
  1942
  1943     PERFORM 5000-SEND-DATA-ONLY.
  1944
  1945     GO TO 9100-RETURN-TRAN.
  1946
  1947 9699-EXIT.
  1948     EXIT.
  1949
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL659.cbl
  1950 9700-SECURITY-VIOLATION.
  1951*                                COPY ELCSCTP.
  1952******************************************************************
  1953*                                                                *
  1954*                            ELCSCTP                             *
  1955*                            VMOD=2.001                          *
  1956*                                                                *
  1957*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  1958******************************************************************
  1959
  1960
  1961     MOVE EIBDATE          TO SM-JUL-DATE.
  1962     MOVE EIBTRMID         TO SM-TERMID.
  1963     MOVE THIS-PGM         TO SM-PGM.
  1964     MOVE EIBTIME          TO TIME-IN.
  1965     MOVE TIME-OUT         TO SM-TIME.
  1966     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  1967
  1968
  1969* EXEC CICS LINK
  1970*         PROGRAM  ('EL003')
  1971*         COMMAREA (SECURITY-MESSAGE)
  1972*         LENGTH   (80)
  1973*    END-EXEC.
  1974     MOVE 'EL003' TO DFHEIV1
  1975     MOVE 80
  1976       TO DFHEIV11
  1977*    MOVE '."C                   ''   #00001721' TO DFHEIV0
  1978     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1979     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1980     MOVE X'2020233030303031373231' TO DFHEIV0(25:11)
  1981     CALL 'kxdfhei1' USING DFHEIV0,
  1982           DFHEIV1,
  1983           SECURITY-MESSAGE,
  1984           DFHEIV11,
  1985           DFHEIV99,
  1986           DFHEIV99,
  1987           DFHEIV99
  1988     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1989
  1990
  1991******************************************************************
  1992
  1993
  1994 9799-EXIT.
  1995     EXIT.
  1996
  1997 9999-LAST-PARAGRAPH  SECTION.
  1998
  1999* GOBACK.
  2000     MOVE '9%                    "   ' TO DFHEIV0
  2001     MOVE 'EL659' TO DFHEIV1
  2002     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2003     GOBACK.
  2004
  2005 9999-DFHBACK SECTION.
  2006     MOVE '9%                    "   ' TO DFHEIV0
  2007     MOVE 'EL659' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL659.cbl
  2008     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2009     GOBACK.
  2010 9999-DFHEXIT.
  2011     IF DFHEIGDJ EQUAL 0001
  2012         NEXT SENTENCE
  2013     ELSE IF DFHEIGDJ EQUAL 2
  2014         GO TO 9400-PGMIDERR,
  2015               1020-NOTFND,
  2016               1020-NOTFND,
  2017               9600-ERROR
  2018         DEPENDING ON DFHEIGDI
  2019     ELSE IF DFHEIGDJ EQUAL 3
  2020         GO TO 9200-XCTL,
  2021               1020-NOTFND,
  2022               1010-DSIDERR
  2023         DEPENDING ON DFHEIGDI
  2024     ELSE IF DFHEIGDJ EQUAL 4
  2025         GO TO 6000-SEND-TEXT
  2026         DEPENDING ON DFHEIGDI.
  2027     MOVE '9%                    "   ' TO DFHEIV0
  2028     MOVE 'EL659' TO DFHEIV1
  2029     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2030     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3656     Code:        4429
