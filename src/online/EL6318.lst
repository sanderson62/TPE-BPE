* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   1
* EL6318.cbl
* Options: int("EL6318.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6318.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6318.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6318.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6318.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   2
* EL6318.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 060612   2011022800001  AJRA  NAPERSOFT
    27* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 102212   2012101700002  AJRA  SCREEN ID
    30* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    31* 110612   2012101700002  AJRA  ADD NEW FIELDS
    32* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    33* 121012   2012101700002  AJRA  HIGHLIGHT REASON CODES
    34* 121112   2012101700002  AJRA  CHANGE PF1, PF2 TO PF3, PF4
    35* 121212   2012101700002  AJRA  CHG LAST 2 CERT NOTES TO BILLING N
    36* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    37* 122712   2012122700001  AJRA  FIX CERT PRINT FLAG
    38* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    39* 091913   2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
    40* 120313   2013090300001  AJRA  NAPERSOFT PHASE 2
    41* 121713   2013090300001  AJRA  ADD ENCLOSURE CODE TO SCREEN
    42* 091615 CR2015082000001  PEMA  ADD XFR TO EL677
    43* 020218 CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
    44* 041320 CR2020030500002  PEMA  Issue, cancel billing notes
    45*-----------------------------------------------------------------
    46*REMARKS.
    47*        TRANSACTION - EXBE - GENERAL CHANGE ENDORSEMENT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   3
* EL6318.cbl
    49 ENVIRONMENT DIVISION.
    50 DATA DIVISION.
    51 WORKING-STORAGE SECTION.
    52 01  DFH-START PIC X(04).
    53 77  FILLER  PIC X(32)  VALUE '********************************'.
    54 77  FILLER  PIC X(32)  VALUE '*    EL6318 WORKING STORAGE    *'.
    55 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    56 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    57 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    58 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    59 77  s1                          pic s999 comp-3 value +0.
    60 77  s2                          pic s999 comp-3 value +0.
    61 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    62 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    63     88  ACCT-FOUND                 VALUE 'Y'.
    64 77  WS-CHGBACK                 PIC 99  VALUE ZEROS.
    65 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    66 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    67 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    68 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    69 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    70 77  WS-REASON-SW                PIC X  VALUE ' '.
    71     88  REASONS-FOUND                  VALUE 'Y'.
    72     88  REASONS-NOT-FOUND              VALUE 'N'.
    73 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    74     88  NO-CERT-RW                 VALUE 'N'.
    75     88  CERT-RW                    VALUE 'Y'.
    76 77  ws-el677-check-cut         pic x value 'N'.
    77 77  ws-el677-check-type        pic x value 'N'.
    78 77  ws-elcrtt-update-sw        pic x value ' '.
    79     88  update-elcrtt             value 'Y'.
    80 01  P pointer.
    81 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    82 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    83 01  var-ptr pointer.
    84 01  env-var-len                 pic 9(4)  binary.
    85 01  rc                          pic 9(9)  binary.
    86 01  WS-KIXHOST                  PIC X(10).
    87 01  WS-KIXSYS.
    88     05  WS-KIX-FIL1             PIC X(10).
    89     05  WS-KIX-APPS             PIC X(10).
    90     05  WS-KIX-ENV              PIC X(10).
    91     05  WS-KIX-MYENV            PIC X(10).
    92     05  WS-KIX-SYS              PIC X(10).
    93*                                COPY ELCSCTM.
    94******************************************************************
    95*                                                                *
    96*                                                                *
    97*                            ELCSCTM                             *
    98*                            VMOD=2.001                          *
    99*                                                                *
   100*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   101*                                                                *
   102******************************************************************
   103 01  SECURITY-MESSAGE.
   104     12  FILLER                          PIC X(30)
   105            VALUE '** LOGIC SECURITY VIOLATION -'.
   106     12  SM-READ                         PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   4
* EL6318.cbl
   107     12  FILLER                          PIC X(5)
   108            VALUE ' PGM='.
   109     12  SM-PGM                          PIC X(6).
   110     12  FILLER                          PIC X(5)
   111            VALUE ' OPR='.
   112     12  SM-PROCESSOR-ID                 PIC X(4).
   113     12  FILLER                          PIC X(6)
   114            VALUE ' TERM='.
   115     12  SM-TERMID                       PIC X(4).
   116     12  FILLER                          PIC XX   VALUE SPACE.
   117     12  SM-JUL-DATE                     PIC 9(5).
   118     12  FILLER                          PIC X    VALUE SPACE.
   119     12  SM-TIME                         PIC 99.99.
   120
   121*                                COPY ELCSCRTY.
   122******************************************************************
   123*                                                                *
   124*                                                                *
   125*                            ELCSCRTY                            *
   126*                            VMOD=2.001                          *
   127*                                                                *
   128*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   129*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   130*        SAVED IN PI-SECURITY-ADDRESS.                           *
   131*                                                                *
   132******************************************************************
   133 01  SECURITY-CONTROL.
   134     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   135     12  FILLER                       PIC XX    VALUE 'SC'.
   136     12  SC-CREDIT-CODES.
   137         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   138             20  SC-CREDIT-DISPLAY    PIC X.
   139             20  SC-CREDIT-UPDATE     PIC X.
   140     12  SC-CLAIMS-CODES.
   141         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   142             20  SC-CLAIMS-DISPLAY    PIC X.
   143             20  SC-CLAIMS-UPDATE     PIC X.
   144 01 srch-commarea.
   145*                                copy ELCADLTRSPI.
   146******************************************************************
   147*                   C H A N G E   L O G
   148*
   149* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   150*-----------------------------------------------------------------
   151*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   152* EFFECTIVE    NUMBER
   153*-----------------------------------------------------------------
   154* 060611    2011022800001  PEMA  NEW COPYBOOK
   155* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   156* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   157******************************************************************
   158****************************************
   159*  commarea for NaperSoft On Demand Admin services letters
   160*  (business logic input & output)
   161****************************************
   162     03  BL-INPUT.
   163         05  BL-DATA-SRCE        PIC X.
   164         05  BL-LETTER-ID        PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   5
* EL6318.cbl
   165         05  BL-CARRIER          PIC X.
   166         05  BL-GROUP            PIC X(6).
   167         05  BL-STATE            PIC XX.
   168         05  BL-ACCOUNT          PIC X(10).
   169         05  BL-EFF-DT           PIC X(10).
   170         05  BL-CERT-NO          PIC X(11).
   171         05  BL-BATCH-NO         PIC X(6).
   172         05  BL-BATCH-SEQ        PIC 9(8).
   173         05  BL-RESP-NO          PIC X(10).
   174         05  BL-NO-OF-COPIES     PIC 99.
   175         05  BL-PROC-ID          PIC XXXX.
   176         05  BL-COMP-ID          PIC XXX.
   177         05  BL-PRINT-NOW-SW     PIC X.
   178         05  BL-ENC-CD           PIC XXX.
   179         05  BL-RESEND-DT        PIC X(10).
   180         05  BL-FOLLOW-UP-DT     PIC X(10).
   181         05  BL-ARCHIVE-NO       PIC 9(8).
   182         05  BL-FUNC             PIC X(8).
   183         05  BL-COMMENTS         PIC X(100).
   184         05  FILLER REDEFINES BL-COMMENTS.
   185             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   186             10  BL-LETTER-TO-ACCT PIC X.
   187             10  BL-LETTER-TO-BENE PIC X.
   188             10  BL-WRITE-ERARCH   PIC X.
   189                 88  ERARCH-QWS      VALUE 'Q'.
   190                 88  ERARCH-BATCH    VALUE 'B'.
   191                 88  ERARCH-TEMP     VALUE 'T'.
   192             10  BL-PROCESS-TYPE PIC X(07).
   193             10  BL-CERT-FORM-ID PIC X(05).
   194             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   195             10  BL-SOURCE-SCREEN PIC X(8).
   196             10  FILLER          PIC X(25).
   197     03  BL-OUTPUT.
   198         05  BL-STATUS                   PIC X.
   199             88  BL-OK                      VALUE "P".
   200             88  BL-FAIL                  VALUE "F".
   201         05  BL-MESSAGE          PIC X(50).
   202     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   203     03  FILLER                  PIC X(31).
   204
   205*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   206*                                COPY ELCZREC.
   207******************************************************************
   208*                                                                *
   209*                                                                *
   210*                            ELCZREC.                            *
   211*                                                                *
   212*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   213*                                                                *
   214******************************************************************
   215*-----------------------------------------------------------------
   216*                   C H A N G E   L O G
   217*
   218* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   219*-----------------------------------------------------------------
   220*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   221* EFFECTIVE    NUMBER
   222*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   6
* EL6318.cbl
   223* 122011    2011022800001  AJRA  NEW FILE
   224* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   225* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   226* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   227* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   228*-----------------------------------------------------------------
   229 01  W-Z-CONTROL-DATA.
   230     05  W-NUMBER-OF-COPIES      PIC  9.
   231     05  FILLER                  PIC  X.
   232     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   233     05  FILLER                  PIC  X.
   234     05  W-DAYS-TO-RESEND        PIC  999.
   235     05  FILLER                  PIC  X.
   236     05  W-FORM-TO-RESEND        PIC  X(4).
   237     05  W-ADD-BAR-CODE          PIC  X.
   238     05  W-PROMPT-LETTER         PIC  X.
   239     05  W-HAS-RETURN-ENV        PIC  X.
   240     05  W-ENCLOSURE-CD          PIC  XXX.
   241     05  W-SIG-FLAG-DEFAULT      PIC  X.
   242     05  W-AUTO-CLOSE-IND        PIC  X.
   243     05  FILLER                  PIC  X.
   244     05  W-LETTER-TO-BENE        PIC  X.
   245     05  FILLER                  PIC  X.
   246     05  W-LETTER-TO-ACCT        PIC  X.
   247     05  FILLER                  PIC  X.
   248     05  W-LETTER-TYPE           PIC  X.
   249     05  FILLER                  PIC  X.
   250     05  W-PRINT-CERTIFICATE     PIC  X.
   251     05  FILLER                  PIC  X.
   252     05  W-REFUND-REQUIRED       PIC  X.
   253     05  FILLER                  PIC  X.
   254     05  W-ONBASE-CODE           PIC  XX.
   255     05  FILLER                  PIC  X.
   256     05  W-ACCT-SUMM             PIC  X.
   257     05  FILLER                  PIC  X.
   258     05  W-CSO-SUMM              PIC  X.
   259     05  FILLER                  PIC  X.
   260     05  W-REASONS-REQUIRED      PIC  X.
   261     05  FILLER                  PIC  X(29).
   262 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   263 01  STANDARD-AREAS.
   264     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   265     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   266                                 PIC  X(08).
   267     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   268     12  QID.
   269         16  QID-TERM        PIC X(4)    VALUE SPACES.
   270         16  FILLER          PIC X(4)    VALUE '631K'.
   271     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   272     12  TIME-MT                 PIC S9(7).
   273     12  TIME-MT-R  REDEFINES TIME-MT.
   274         16  FILLER              PIC X.
   275         16  TIME-LMT            PIC 99V99.
   276         16  FILLER              PIC X(2).
   277     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   278     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   279     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   280     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   7
* EL6318.cbl
   281     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   282     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   283     12  ELCRTT-LENGTH           PIC S9(4) COMP VALUE +552.
   284     12  ELENCC-LENGTH           PIC S9(04) VALUE +400 COMP.
   285     12  W-CNTL-KEY.
   286         16  W-CNTL-COMPANY-ID   PIC  X(03).
   287         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   288         16  W-CNTL-GENL.
   289             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   290             20  W-CNTL-GEN2.
   291                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   292                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   293         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
   294     12  WS-ELCERT-KEY.
   295         16  W-CERT-COMPANY-CD   PIC X.
   296         16  W-CERT-CARRIER      PIC X.
   297         16  W-CERT-GROUPING     PIC X(6).
   298         16  W-CERT-STATE        PIC XX.
   299         16  W-CERT-ACCOUNT      PIC X(10).
   300         16  W-CERT-CERT-EFF-DT  PIC XX.
   301         16  W-CERT-CERT-PRIME   PIC X(10).
   302         16  W-CERT-CERT-SFX     PIC X.
   303     12  WS-ELEOBC-KEY.
   304         16  WS-EOBC-COMPANY-CD  PIC X.
   305         16  WS-EOBC-REC-TYPE    PIC X.
   306         16  WS-EOBC-CODE        PIC X(4).
   307         16  FILLER              PIC X(9).
   308     12  WS-ERNOTE-KEY.
   309         16  W-NOTE-COMPANY-CD   PIC X.
   310         16  W-NOTE-CARRIER      PIC X.
   311         16  W-NOTE-GROUPING     PIC X(6).
   312         16  W-NOTE-STATE        PIC XX.
   313         16  W-NOTE-ACCOUNT      PIC X(10).
   314         16  W-NOTE-CERT-EFF-DT  PIC XX.
   315         16  W-NOTE-CERT-PRIME   PIC X(10).
   316         16  W-NOTE-CERT-SFX     PIC X.
   317         16  w-note-record-type  pic x.
   318     12  ELLETR-KEY.
   319         16  LETR-PART-KEY.
   320             20  LETR-COMPANY-CD PIC X.
   321             20  LETR-LETTER-ID  PIC X(4).
   322         16  LETR-FILLER         PIC X(8).
   323         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   324     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   325     12  ERPNDB2-KEY.
   326         16  PNDB2-COMPANY-CD    PIC X.
   327         16  PNDB2-CARRIER       PIC X.
   328         16  PNDB2-GROUPING      PIC X(6).
   329         16  PNDB2-STATE         PIC XX.
   330         16  PNDB2-ACCOUNT       PIC X(10).
   331         16  PNDB2-CERT-EFF-DT   PIC XX.
   332         16  PNDB2-CERT-PRIME    PIC X(10).
   333         16  PNDB2-CERT-SFX      PIC X.
   334         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   335         16  PNDB2-RECORD-TYPE   PIC X.
   336     12  ERPNDB-KEY.
   337         16  PNDB-COMPANY-CD     PIC X.
   338         16  PNDB-BATCH-NO       PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   8
* EL6318.cbl
   339         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   340         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   341     12  ERENDT-KEY.
   342         16  ENDT-COMPANY-CD       PIC X.
   343         16  ENDT-CARRIER          PIC X.
   344         16  ENDT-GROUPING         PIC X(6).
   345         16  ENDT-STATE            PIC XX.
   346         16  ENDT-ACCOUNT          PIC X(10).
   347         16  ENDT-CERT-EFF-DT      PIC XX.
   348         16  ENDT-CERT-PRIME       PIC X(10).
   349         16  ENDT-CERT-SFX         PIC X.
   350         16  ENDT-RECORD-TYPE      PIC X.
   351         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   352     12  ELCRTO-KEY.
   353         16  CRTO-COMPANY-CD     PIC X.
   354         16  CRTO-CARRIER        PIC X.
   355         16  CRTO-GROUPING       PIC X(6).
   356         16  CRTO-STATE          PIC XX.
   357         16  CRTO-ACCOUNT        PIC X(10).
   358         16  CRTO-CERT-EFF-DT    PIC XX.
   359         16  CRTO-CERT-PRIME     PIC X(10).
   360         16  CRTO-CERT-SFX       PIC X.
   361         16  CRTO-RECORD-TYPE    PIC X.
   362         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   363     12  WS-ELCRTT-KEY.
   364         16  WS-ELCRTT-PRIMARY   PIC X(33).
   365         16  WS-ELCRTT-REC-TYPE  PIC X(1).
   366     12  WS-ERMAIL-KEY.
   367         16  MAIL-COMPANY-CD     PIC X.
   368         16  MAIL-CARRIER        PIC X.
   369         16  MAIL-GROUPING       PIC X(6).
   370         16  MAIL-STATE          PIC XX.
   371         16  MAIL-ACCOUNT        PIC X(10).
   372         16  MAIL-CERT-EFF-DT    PIC XX.
   373         16  MAIL-CERT-PRIME     PIC X(10).
   374         16  MAIL-CERT-SFX       PIC X.
   375
   376     12  WS-ELENCC-KEY.
   377         16  WS-ENCC-COMPANY-CD  PIC X.
   378         16  WS-ENCC-REC-TYPE    PIC X.
   379         16  WS-ENCC-ENC-CODE    PIC X(5).
   380         16  FILLER              PIC X(09).
   381
   382     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   383     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   384     12  WS-CURRENT-DT.
   385         16  FILLER              PIC X(6)    VALUE SPACES.
   386         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   387     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   388     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   389         88  CANCEL-REC            VALUE 'C'.
   390         88  ISSUE-REC             VALUE 'I'.
   391     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   392     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   393     12  ELCNTL-KEY.
   394         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   395         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   396         16  CNTL-ACCESS.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   9
* EL6318.cbl
   397             20  CNTL-STATE      PIC XX    VALUE SPACES.
   398             20  FILLER          PIC X     VALUE SPACES.
   399             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   400         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   401     12  WS-ERACCT-KEY.
   402         16  ACCT-COMPANY-CD     PIC X.
   403         16  ACCT-CARRIER        PIC X.
   404         16  ACCT-GROUPING       PIC X(6).
   405         16  ACCT-STATE          PIC XX.
   406         16  ACCT-ACCOUNT        PIC X(10).
   407         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   408         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   409     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   410     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   411     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   412     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   413     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   414     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   415     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   416     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   417     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   418     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   419     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   420     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   421     12  WS-ELENCC-FILE-ID       PIC X(8) VALUE 'ELENCC'.
   422     12  WS-RESPONSE             PIC S9(8)   COMP.
   423         88  RESP-NORMAL                  VALUE +00.
   424         88  RESP-NOTFND                  VALUE +13.
   425         88  RESP-DUPREC                  VALUE +14.
   426         88  RESP-DUPKEY                  VALUE +15.
   427         88  RESP-NOTOPEN                 VALUE +19.
   428         88  RESP-ENDFILE                 VALUE +20.
   429     12  MAP-NAME            PIC X(8)    VALUE 'EL631K'.
   430     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6318S'.
   431     12  SCREEN-NUMBER       PIC X(4)    VALUE '631K'.
   432     12  TRANS-ID            PIC X(4)    VALUE 'EXBE'.
   433     12  THIS-PGM            PIC X(8)    VALUE 'EL6318'.
   434     12  PGM-NAME            PIC X(8).
   435     12  TIME-IN             PIC S9(7).
   436     12  TIME-OUT-R  REDEFINES TIME-IN.
   437         16  FILLER          PIC X.
   438         16  TIME-OUT        PIC 99V99.
   439         16  FILLER          PIC X(2).
   440     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   441     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   442     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   443     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   444     12  XCTL-677            PIC X(8)    VALUE 'EL677'.
   445     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   446     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   447     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   448     12  WS-PHONE.
   449         16  WS-PH1              PIC XXX.
   450         16  WS-PH2              PIC XXX.
   451         16  WS-PH3              PIC XXXX.
   452     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   453     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   454
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  10
* EL6318.cbl
   455     12  WS-BILLING-NOTE.
   456         16  WS-BN-NOTE          PIC X(25).
   457         16  WS-BN-LTRID         PIC X(4).
   458         16  FILLER              PIC X(3).
   459         16  WS-BN-DATE          PIC X(8).
   460         16  FILLER              PIC X(3).
   461         16  WS-BN-USERID        PIC X(4).
   462         16  FILLER              PIC X(30).
   463     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   464         16  WS-MAN-BN-NOTE      PIC X(63).
   465         16  FILLER              PIC X(14).
   466     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   467
   468     12  WS-SAVE-REASON-CODE-IND PIC X(26).
   469
   470 01  NEW-ELCRTO-REC.
   471     12  NEW-ELCRTO-KEY.
   472         16  NCRTO-COMPANY-CD      PIC X.
   473         16  NCRTO-CARRIER         PIC X.
   474         16  NCRTO-GROUPING        PIC X(6).
   475         16  NCRTO-STATE           PIC XX.
   476         16  NCRTO-ACCOUNT         PIC X(10).
   477         16  NCRTO-CERT-EFF-DT     PIC XX.
   478         16  NCRTO-CERT-PRIME      PIC X(10).
   479         16  NCRTO-CERT-SFX        PIC X.
   480         16  NCRTO-RECORD-TYPE     PIC X.
   481         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   482     12  NEW-ORIG-REC.
   483         16  NCRTO-INS-LAST-NAME   PIC X(15).
   484         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   485         16  NCRTO-INS-MIDDLE-INIT PIC X.
   486         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   487         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   488         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   489         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   490         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   491         16  NCRTO-LF-BENCD        PIC XX.
   492         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   493         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   494         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   495         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   496         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   497         16  NCRTO-LF-EXP-DT       PIC XX.
   498         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   499         16  NCRTO-LF-CANCEL-DT    PIC XX.
   500         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   501         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   502         16  NCRTO-AH-BENCD        PIC XX.
   503         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   504         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   505         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   506         16  NCRTO-AH-EXP-DT       PIC XX.
   507         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   508         16  NCRTO-AH-CP           PIC 99.
   509         16  NCRTO-AH-CANCEL-DT    PIC XX.
   510         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   511         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   512         16  NCRTO-CRED-BENE-NAME  PIC X(25).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  11
* EL6318.cbl
   513         16  NCRTO-1ST-PMT-DT      PIC XX.
   514         16  NCRTO-INS-AGE-DEFAULT-FLAG PIC X.
   515         16  NCRTO-JNT-AGE-DEFAULT-FLAG PIC X.
   516         16  NCRTO-ISSUE-TRAN-IND  PIC X.
   517         16  NCRTO-CANCEL-TRAN-IND PIC X.
   518         16  FILLER                PIC X(235).
   519
   520 01  CERT-NOTE-ENTRIES.
   521     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   522         16  CERT-NT-TEXT                PIC X(63).
   523         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   524         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   525         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   526
   527 01  ERCNOT-AREA.
   528     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   529     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   530     12  ERCNOT-KEY.
   531         16  ERCNOT-PARTIAL-KEY.
   532             20 ERCNOT-COMPANY-CD    PIC X.
   533             20 ERCNOT-CARRIER       PIC X.
   534             20 ERCNOT-GROUPING      PIC X(06).
   535             20 ERCNOT-STATE         PIC XX.
   536             20 ERCNOT-ACCOUNT       PIC X(10).
   537             20 ERCNOT-EFF-DT        PIC XX.
   538             20 ERCNOT-CERT-NO.
   539                25 ERCNOT-CERT-PRIME PIC X(10).
   540                25 ERCNOT-CERT-SFX   PIC X.
   541             20 ERCNOT-REC-TYP       PIC X.
   542         16 ERCNOT-SEQ           PIC S9(4) COMP.
   543     12  SV-PARTIAL-KEY.
   544         20 SV-COMPANY-CD            PIC X.
   545         20 SV-CARRIER               PIC X.
   546         20 SV-GROUPING              PIC X(06).
   547         20 SV-STATE                 PIC XX.
   548         20 SV-ACCOUNT               PIC X(10).
   549         20 SV-EFF-DT                PIC XX.
   550         20 SV-CERT-NO.
   551            25 SV-CERT-PRIME         PIC X(10).
   552            25 SV-CERT-SFX           PIC X(1).
   553         20 SV-REC-TYP               PIC X.
   554 01  ERROR-MESSAGES.
   555     12  ER-0000                 PIC X(4)  VALUE '0000'.
   556     12  ER-0004                 PIC X(4)  VALUE '0004'.
   557     12  ER-0008                 PIC X(4)  VALUE '0008'.
   558     12  ER-0023                 PIC X(4)  VALUE '0023'.
   559     12  ER-0029                 PIC X(4)  VALUE '0029'.
   560     12  ER-0068                 PIC X(4)  VALUE '0068'.
   561     12  ER-0132                 PIC X(4)  VALUE '0132'.
   562     12  ER-0142                 PIC X(4)  VALUE '0142'.
   563     12  ER-0148                 PIC X(4)  VALUE '0148'.
   564     12  ER-0215                 PIC X(4)  VALUE '0215'.
   565     12  ER-0280                 PIC X(4)  VALUE '0280'.
   566     12  ER-0348                 PIC X(4)  VALUE '0348'.
   567     12  ER-0419                 PIC X(4)  VALUE '0419'.
   568     12  ER-0715                 PIC X(4)  VALUE '0715'.
   569     12  ER-0894                 PIC X(4)  VALUE '0894'.
   570     12  ER-1101                 PIC X(4)  VALUE '1101'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  12
* EL6318.cbl
   571     12  ER-1236                 PIC X(4)  VALUE '1236'.
   572     12  ER-1560                 PIC X(4)  VALUE '1560'.
   573     12  ER-1664                 PIC X(4)  VALUE '1664'.
   574     12  ER-1778                 PIC X(4)  VALUE '1778'.
   575     12  ER-1818                 PIC X(4)  VALUE '1818'.
   576     12  ER-1820                 PIC X(4)  VALUE '1820'.
   577     12  ER-1821                 PIC X(4)  VALUE '1821'.
   578     12  ER-2056                 PIC X(4)  VALUE '2056'.
   579     12  ER-2079                 PIC X(4)  VALUE '2079'.
   580     12  ER-2208                 PIC X(4)  VALUE '2208'.
   581     12  ER-2209                 PIC X(4)  VALUE '2209'.
   582     12  ER-2237                 PIC X(4)  VALUE '2237'.
   583     12  ER-2238                 PIC X(4)  VALUE '2238'.
   584     12  ER-2253                 PIC X(4)  VALUE '2253'.
   585     12  ER-2619                 PIC X(4)  VALUE '2619'.
   586     12  ER-2651                 PIC X(4)  VALUE '2651'.
   587     12  ER-2784                 PIC X(4)  VALUE '2784'.
   588     12  ER-2785                 PIC X(4)  VALUE '2785'.
   589     12  ER-2786                 PIC X(4)  VALUE '2786'.
   590     12  ER-2791                 PIC X(4)  VALUE '2791'.
   591     12  ER-2845                 PIC X(4)  VALUE '2845'.
   592     12  ER-2848                 PIC X(4)  VALUE '2848'.
   593     12  ER-2851                 PIC X(4)  VALUE '2851'.
   594     12  ER-3830                 PIC X(4)  VALUE '3830'.
   595     12  ER-3833                 PIC X(4)  VALUE '3833'.
   596     12  ER-3844                 PIC X(4)  VALUE '3844'.
   597     12  ER-3845                 PIC X(4)  VALUE '3845'.
   598     12  ER-7345                 PIC X(4)  VALUE '7345'.
   599     12  ER-7638                 PIC X(4)  VALUE '7638'.
   600     12  ER-8888                 PIC X(4)  VALUE '8888'.
   601     12  ER-9999                 PIC X(4)  VALUE '9999'.
   602*    COPY ELCDATE.
   603******************************************************************
   604*                                                                *
   605*                                                                *
   606*                            ELCDATE.                            *
   607*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   608*                            VMOD=2.003
   609*                                                                *
   610*                                                                *
   611*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   612*                 LENGTH = 200                                   *
   613******************************************************************
   614
   615 01  DATE-CONVERSION-DATA.
   616     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   617     12  DC-OPTION-CODE                PIC X.
   618         88  BIN-TO-GREG                VALUE ' '.
   619         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   620         88  EDIT-GREG-TO-BIN           VALUE '2'.
   621         88  YMD-GREG-TO-BIN            VALUE '3'.
   622         88  MDY-GREG-TO-BIN            VALUE '4'.
   623         88  JULIAN-TO-BIN              VALUE '5'.
   624         88  BIN-PLUS-ELAPSED           VALUE '6'.
   625         88  FIND-CENTURY               VALUE '7'.
   626         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   627         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   628         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  13
* EL6318.cbl
   629         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   630         88  JULIAN-TO-BIN-3            VALUE 'C'.
   631         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   632         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   633         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   634         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   635         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   636         88  CHECK-LEAP-YEAR            VALUE 'H'.
   637         88  BIN-3-TO-GREG              VALUE 'I'.
   638         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   639         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   640         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   641         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   642         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   643         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   644         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   645         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   646         88  THREE-CHARACTER-BIN
   647                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   648         88  GREGORIAN-TO-BIN
   649                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   650         88  BIN-TO-GREGORIAN
   651                  VALUES ' ' '1' 'I' '8' 'G'.
   652         88  JULIAN-TO-BINARY
   653                  VALUES '5' 'C' 'E' 'F'.
   654     12  DC-ERROR-CODE                 PIC X.
   655         88  NO-CONVERSION-ERROR        VALUE ' '.
   656         88  DATE-CONVERSION-ERROR
   657                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   658         88  DATE-IS-ZERO               VALUE '1'.
   659         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   660         88  DATE-IS-INVALID            VALUE '3'.
   661         88  DATE1-GREATER-DATE2        VALUE '4'.
   662         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   663         88  DATE-INVALID-OPTION        VALUE '9'.
   664         88  INVALID-CENTURY            VALUE 'A'.
   665         88  ONLY-CENTURY               VALUE 'B'.
   666         88  ONLY-LEAP-YEAR             VALUE 'C'.
   667         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   668     12  DC-END-OF-MONTH               PIC X.
   669         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   670     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   671         88  USE-NORMAL-PROCESS         VALUE ' '.
   672         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   673         88  ADJUST-UP-100-YRS          VALUE '2'.
   674     12  FILLER                        PIC X.
   675     12  DC-CONVERSION-DATES.
   676         16  DC-BIN-DATE-1             PIC XX.
   677         16  DC-BIN-DATE-2             PIC XX.
   678         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   679         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   680                       DC-GREG-DATE-1-EDIT.
   681             20  DC-EDIT1-MONTH        PIC 99.
   682             20  SLASH1-1              PIC X.
   683             20  DC-EDIT1-DAY          PIC 99.
   684             20  SLASH1-2              PIC X.
   685             20  DC-EDIT1-YEAR         PIC 99.
   686         16  DC-GREG-DATE-2-EDIT       PIC X(08).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  14
* EL6318.cbl
   687         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   688                     DC-GREG-DATE-2-EDIT.
   689             20  DC-EDIT2-MONTH        PIC 99.
   690             20  SLASH2-1              PIC X.
   691             20  DC-EDIT2-DAY          PIC 99.
   692             20  SLASH2-2              PIC X.
   693             20  DC-EDIT2-YEAR         PIC 99.
   694         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   695         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   696                     DC-GREG-DATE-1-YMD.
   697             20  DC-YMD-YEAR           PIC 99.
   698             20  DC-YMD-MONTH          PIC 99.
   699             20  DC-YMD-DAY            PIC 99.
   700         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   701         16  DC-GREG-DATE-1-MDY-R REDEFINES
   702                      DC-GREG-DATE-1-MDY.
   703             20  DC-MDY-MONTH          PIC 99.
   704             20  DC-MDY-DAY            PIC 99.
   705             20  DC-MDY-YEAR           PIC 99.
   706         16  DC-GREG-DATE-1-ALPHA.
   707             20  DC-ALPHA-MONTH        PIC X(10).
   708             20  DC-ALPHA-DAY          PIC 99.
   709             20  FILLER                PIC XX.
   710             20  DC-ALPHA-CENTURY.
   711                 24 DC-ALPHA-CEN-N     PIC 99.
   712             20  DC-ALPHA-YEAR         PIC 99.
   713         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   714         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   715         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   716         16  DC-JULIAN-DATE            PIC 9(05).
   717         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   718                                       PIC 9(05).
   719         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   720             20  DC-JULIAN-YEAR        PIC 99.
   721             20  DC-JULIAN-DAYS        PIC 999.
   722         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   723         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   724         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   725     12  DATE-CONVERSION-VARIBLES.
   726         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   727         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   728             20  FILLER                PIC 9(3).
   729             20  HOLD-CEN-1-CCYY.
   730                 24  HOLD-CEN-1-CC     PIC 99.
   731                 24  HOLD-CEN-1-YY     PIC 99.
   732             20  HOLD-CEN-1-MO         PIC 99.
   733             20  HOLD-CEN-1-DA         PIC 99.
   734         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   735             20  HOLD-CEN-1-R-MO       PIC 99.
   736             20  HOLD-CEN-1-R-DA       PIC 99.
   737             20  HOLD-CEN-1-R-CCYY.
   738                 24  HOLD-CEN-1-R-CC   PIC 99.
   739                 24  HOLD-CEN-1-R-YY   PIC 99.
   740             20  FILLER                PIC 9(3).
   741         16  HOLD-CENTURY-1-X.
   742             20  FILLER                PIC X(3)  VALUE SPACES.
   743             20  HOLD-CEN-1-X-CCYY.
   744                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  15
* EL6318.cbl
   745                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   746             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   747             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   748         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   749             20  HOLD-CEN-1-R-X-MO     PIC XX.
   750             20  HOLD-CEN-1-R-X-DA     PIC XX.
   751             20  HOLD-CEN-1-R-X-CCYY.
   752                 24  HOLD-CEN-1-R-X-CC PIC XX.
   753                 24  HOLD-CEN-1-R-X-YY PIC XX.
   754             20  FILLER                PIC XXX.
   755         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   756         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   757         16  DC-JULIAN-DATE-1          PIC 9(07).
   758         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   759             20  DC-JULIAN-1-CCYY.
   760                 24  DC-JULIAN-1-CC    PIC 99.
   761                 24  DC-JULIAN-1-YR    PIC 99.
   762             20  DC-JULIAN-DA-1        PIC 999.
   763         16  DC-JULIAN-DATE-2          PIC 9(07).
   764         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   765             20  DC-JULIAN-2-CCYY.
   766                 24  DC-JULIAN-2-CC    PIC 99.
   767                 24  DC-JULIAN-2-YR    PIC 99.
   768             20  DC-JULIAN-DA-2        PIC 999.
   769         16  DC-GREG-DATE-A-EDIT.
   770             20  DC-EDITA-MONTH        PIC 99.
   771             20  SLASHA-1              PIC X VALUE '/'.
   772             20  DC-EDITA-DAY          PIC 99.
   773             20  SLASHA-2              PIC X VALUE '/'.
   774             20  DC-EDITA-CCYY.
   775                 24  DC-EDITA-CENT     PIC 99.
   776                 24  DC-EDITA-YEAR     PIC 99.
   777         16  DC-GREG-DATE-B-EDIT.
   778             20  DC-EDITB-MONTH        PIC 99.
   779             20  SLASHB-1              PIC X VALUE '/'.
   780             20  DC-EDITB-DAY          PIC 99.
   781             20  SLASHB-2              PIC X VALUE '/'.
   782             20  DC-EDITB-CCYY.
   783                 24  DC-EDITB-CENT     PIC 99.
   784                 24  DC-EDITB-YEAR     PIC 99.
   785         16  DC-GREG-DATE-CYMD         PIC 9(08).
   786         16  DC-GREG-DATE-CYMD-R REDEFINES
   787                              DC-GREG-DATE-CYMD.
   788             20  DC-CYMD-CEN           PIC 99.
   789             20  DC-CYMD-YEAR          PIC 99.
   790             20  DC-CYMD-MONTH         PIC 99.
   791             20  DC-CYMD-DAY           PIC 99.
   792         16  DC-GREG-DATE-MDCY         PIC 9(08).
   793         16  DC-GREG-DATE-MDCY-R REDEFINES
   794                              DC-GREG-DATE-MDCY.
   795             20  DC-MDCY-MONTH         PIC 99.
   796             20  DC-MDCY-DAY           PIC 99.
   797             20  DC-MDCY-CEN           PIC 99.
   798             20  DC-MDCY-YEAR          PIC 99.
   799    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   800        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   801    12  DC-EL310-DATE                  PIC X(21).
   802    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  16
* EL6318.cbl
   803*    COPY ELCTEXT.
   804******************************************************************
   805*                                                                *
   806*                                                                *
   807*                            ELCTEXT.                            *
   808*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   809*                            VMOD=2.008                          *
   810*                                                                *
   811*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   812*                                     FORM LETTERS,              *
   813*                                     CERT FORM DISPLAY.
   814*                                                                *
   815*   FILE TYPE = VSAM,KSDS                                        *
   816*   RECORD SIZE = 100   RECFORM = FIXED                          *
   817*                                                                *
   818*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   819*       ALTERNATE INDEX = NONE                                   *
   820*                                                                *
   821*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   822*       ALTERNATE INDEX = NONE                                   *
   823*                                                                *
   824*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   825*       ALTERNATE INDEX = NONE                                   *
   826*                                                                *
   827*   LOG = NO                                                     *
   828*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   829******************************************************************
   830 01  TEXT-FILES.
   831     12  TEXT-FILE-ID                PIC XX.
   832         88  FORMS-FILE-TEXT            VALUE 'TF'.
   833         88  LETTER-FILE-TEXT           VALUE 'TL'.
   834         88  HELP-FILE-TEXT             VALUE 'TH'.
   835
   836     12  TX-CONTROL-PRIMARY.
   837         16  TX-COMPANY-CD           PIC X.
   838             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   839         16  TX-ACCESS-CD-GENL       PIC X(12).
   840
   841         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   842             20  TX-LETTER-NO        PIC X(4).
   843             20  FILLER              PIC X(8).
   844
   845         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   846             20  TX-FORM-NO          PIC X(12).
   847
   848         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   849             20  TX-HELP-TYPE        PIC X.
   850                 88  HELP-FOR-GENERAL   VALUE ' '.
   851                 88  HELP-BY-SCREEN     VALUE 'S'.
   852                 88  HELP-BY-ERROR      VALUE 'E'.
   853             20  TX-SCREEN-OR-ERROR  PIC X(4).
   854                 88  GENERAL-INFO-HELP  VALUE '0000'.
   855             20  TX-HELP-FOR-COMPANY  PIC XXX.
   856                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   857             20  FILLER              PIC X(4).
   858
   859         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   860
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  17
* EL6318.cbl
   861     12  TX-PROCESS-CONTROL          PIC XX.
   862         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   863
   864     12  TX-TEXT-LINE                PIC X(70).
   865
   866     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   867         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   868         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   869         88  TX-VALID-FORM-SQUEEZE-VALUE
   870                                        VALUE 'Y' ' '.
   871
   872     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   873         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   874         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   875         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   876         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   877         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   878         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   879         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   880                                              'K' 'N' ' '
   881                                              'Z'.
   882
   883     12  TX-ARCHIVE-SW               PIC X.
   884         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   885         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   886         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   887
   888     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   889     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   890
   891     12  TX-BSR-CODE                 PIC X.
   892         88  TX-BSR-LETTER              VALUE 'B'.
   893         88  TX-NON-BSR-LETTER          VALUE ' '.
   894
   895     12  FILLER                      PIC X.
   896*****************************************************************
   897*    COPY ELCLOGOF.
   898******************************************************************
   899*                                                                *
   900*                                                                *
   901*                            ELCLOGOF.                           *
   902*                            VMOD=2.001                          *
   903*                                                                *
   904*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   905*                                                                *
   906******************************************************************
   907 01  CLASIC-LOGOFF.
   908     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   909     12  LOGOFF-TEXT.
   910         16  FILLER          PIC X(5)    VALUE SPACES.
   911         16  LOGOFF-MSG.
   912             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   913             20  FILLER      PIC X       VALUE SPACES.
   914             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   915         16  FILLER          PIC X(80)
   916           VALUE '* YOU ARE NOW LOGGED OFF'.
   917         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   918         16  FILLER          PIC X       VALUE QUOTE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  18
* EL6318.cbl
   919         16  LOGOFF-SYS-MSG  PIC X(17)
   920           VALUE 'S CLAS-IC SYSTEM '.
   921     12  TEXT-MESSAGES.
   922         16  UNACCESS-MSG    PIC X(29)
   923             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   924         16  PGMIDERR-MSG    PIC X(17)
   925             VALUE 'PROGRAM NOT FOUND'.
   926*    COPY ELCATTR.
   927******************************************************************
   928*                                                                *
   929*                            ELCATTR.                            *
   930*                            VMOD=2.001                          *
   931*                                                                *
   932*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   933*                                                                *
   934*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   935*                                                                *
   936*                   POS 1   P=PROTECTED                          *
   937*                           U=UNPROTECTED                        *
   938*                           S=ASKIP                              *
   939*                   POS 2   A=ALPHA/NUMERIC                      *
   940*                           N=NUMERIC                            *
   941*                   POS 3   N=NORMAL                             *
   942*                           B=BRIGHT                             *
   943*                           D=DARK                               *
   944*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   945*                           OF=MODIFIED DATA TAG OFF             *
   946*                                                                *
   947*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   948******************************************************************
   949 01  ATTRIBUTE-LIST.
   950     12  AL-PABOF            PIC X       VALUE 'Y'.
   951     12  AL-PABON            PIC X       VALUE 'Z'.
   952     12  AL-PADOF            PIC X       VALUE '%'.
   953     12  AL-PADON            PIC X       VALUE '_'.
   954     12  AL-PANOF            PIC X       VALUE '-'.
   955     12  AL-PANON            PIC X       VALUE '/'.
   956     12  AL-SABOF            PIC X       VALUE '8'.
   957     12  AL-SABON            PIC X       VALUE '9'.
   958     12  AL-SADOF            PIC X       VALUE '@'.
   959     12  AL-SADON            PIC X       VALUE QUOTE.
   960     12  AL-SANOF            PIC X       VALUE '0'.
   961     12  AL-SANON            PIC X       VALUE '1'.
   962     12  AL-UABOF            PIC X       VALUE 'H'.
   963     12  AL-UABON            PIC X       VALUE 'I'.
   964     12  AL-UADOF            PIC X       VALUE '<'.
   965     12  AL-UADON            PIC X       VALUE '('.
   966     12  AL-UANOF            PIC X       VALUE ' '.
   967     12  AL-UANON            PIC X       VALUE 'A'.
   968     12  AL-UNBOF            PIC X       VALUE 'Q'.
   969     12  AL-UNBON            PIC X       VALUE 'R'.
   970     12  AL-UNDOF            PIC X       VALUE '*'.
   971     12  AL-UNDON            PIC X       VALUE ')'.
   972     12  AL-UNNOF            PIC X       VALUE '&'.
   973     12  AL-UNNON            PIC X       VALUE 'J'.
   974*    COPY ELCEMIB.
   975******************************************************************
   976*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  19
* EL6318.cbl
   977*                                                                *
   978*                            ELCEMIB.                            *
   979*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   980*                            VMOD=2.005                          *
   981*                                                                *
   982*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   983*                                                                *
   984******************************************************************
   985 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   986     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   987     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   988     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   989     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   990     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   991     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   992     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   993     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   994     12  EMI-SWITCH1             PIC X        VALUE '1'.
   995         88  EMI-NO-ERRORS                    VALUE '1'.
   996         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   997         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   998     12  EMI-SWITCH2             PIC X        VALUE '1'.
   999         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1000     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1001         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1002         88  EMI-AREA1-FULL                   VALUE '2'.
  1003     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1004         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1005         88  EMI-AREA2-FULL                   VALUE '2'.
  1006     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1007         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1008         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1009         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1010         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1011         88  EMI-BYPASS-FATALS                VALUE 'X'.
  1012     12  EMI-ERROR-LINES.
  1013         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1014         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1015         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1016         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1017             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1018                 24  EMI-ERR-NUM         PIC X(4).
  1019                 24  EMI-FILLER          PIC X.
  1020                 24  EMI-SEV             PIC X.
  1021                 24  FILLER              PIC X.
  1022             20  FILLER                  PIC X(02).
  1023     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1024         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1025             20  EMI-ERROR-NUMBER    PIC X(4).
  1026             20  EMI-FILL            PIC X.
  1027             20  EMI-SEVERITY        PIC X.
  1028             20  FILLER              PIC X.
  1029             20  EMI-ERROR-TEXT.
  1030                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1031                 24  FILLER          PIC X(55).
  1032     12  EMI-SEVERITY-SAVE           PIC X.
  1033         88  EMI-NOTE                    VALUE 'N'.
  1034         88  EMI-WARNING                 VALUE 'W'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  20
* EL6318.cbl
  1035         88  EMI-FORCABLE                VALUE 'F'.
  1036         88  EMI-FATAL                   VALUE 'X'.
  1037     12  EMI-MESSAGE-FLAG            PIC X.
  1038         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1039         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1040     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1041     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1042         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1043         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1044         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1045     12  emi-claim-no                pic x(7).
  1046     12  emi-claim-type              pic x(6).
  1047     12  FILLER                      PIC X(124)  VALUE SPACES.
  1048     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1049     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1050     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1051     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1052*    COPY ELCINTF.
  1053******************************************************************
  1054*                                                                *
  1055*                                                                *
  1056*                            ELCINTF.                            *
  1057*                            VMOD=2.017                          *
  1058*                                                                *
  1059*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1060*                                                                *
  1061*       LENGTH = 1024                                            *
  1062*                                                                *
  1063******************************************************************
  1064*                   C H A N G E   L O G
  1065*
  1066* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1067*-----------------------------------------------------------------
  1068*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1069* EFFECTIVE    NUMBER
  1070*-----------------------------------------------------------------
  1071* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1072******************************************************************
  1073 01  PROGRAM-INTERFACE-BLOCK.
  1074     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1075     12  PI-CALLING-PROGRAM              PIC X(8).
  1076     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1077     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1078     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1079     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1080     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1081     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1082     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1083     12  PI-COMPANY-ID                   PIC XXX.
  1084     12  PI-COMPANY-CD                   PIC X.
  1085
  1086     12  PI-COMPANY-PASSWORD             PIC X(8).
  1087
  1088     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1089
  1090     12  PI-CONTROL-IN-PROGRESS.
  1091         16  PI-CARRIER                  PIC X.
  1092         16  PI-GROUPING                 PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  21
* EL6318.cbl
  1093         16  PI-STATE                    PIC XX.
  1094         16  PI-ACCOUNT                  PIC X(10).
  1095         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1096                                         PIC X(10).
  1097         16  PI-CLAIM-CERT-GRP.
  1098             20  PI-CLAIM-NO             PIC X(7).
  1099             20  PI-CERT-NO.
  1100                 25  PI-CERT-PRIME       PIC X(10).
  1101                 25  PI-CERT-SFX         PIC X.
  1102             20  PI-CERT-EFF-DT          PIC XX.
  1103         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1104             20  PI-PLAN-CODE            PIC X(2).
  1105             20  PI-REVISION-NUMBER      PIC X(3).
  1106             20  PI-PLAN-EFF-DT          PIC X(2).
  1107             20  PI-PLAN-EXP-DT          PIC X(2).
  1108             20  FILLER                  PIC X(11).
  1109         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1110             20  PI-OE-REFERENCE-1.
  1111                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1112                 25  PI-OE-REF-1-SUFF    PIC XX.
  1113
  1114     12  PI-SESSION-IN-PROGRESS          PIC X.
  1115         88  CLAIM-SESSION                   VALUE '1'.
  1116         88  CREDIT-SESSION                  VALUE '2'.
  1117         88  WARRANTY-SESSION                VALUE '3'.
  1118         88  MORTGAGE-SESSION                VALUE '4'.
  1119         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1120
  1121
  1122*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1123
  1124     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1125     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1126
  1127     12  PI-CREDIT-USER                  PIC X.
  1128         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1129         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1130
  1131     12  PI-CLAIM-USER                   PIC X.
  1132         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1133         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1134
  1135     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1136         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1137         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1138         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1139         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1140         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1141
  1142     12  PI-PROCESSOR-ID                 PIC X(4).
  1143
  1144     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1145
  1146     12  PI-MEMBER-CAPTION               PIC X(10).
  1147
  1148     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1149         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1150
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  22
* EL6318.cbl
  1151     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1152     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1153     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1154     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1155
  1156     12  PI-AH-OVERRIDE-L1               PIC X.
  1157     12  PI-AH-OVERRIDE-L2               PIC XX.
  1158     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1159     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1160
  1161     12  PI-NEW-SYSTEM                   PIC X(2).
  1162
  1163     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1164     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1165         88  PI-USES-PAID-TO                 VALUE '1'.
  1166     12  PI-CRDTCRD-SYSTEM.
  1167         16  PI-CRDTCRD-USER             PIC X.
  1168             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1169             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1170         16  PI-CC-MONTH-END-DT          PIC XX.
  1171     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1172
  1173     12  PI-OE-REFERENCE-2.
  1174         16  PI-OE-REF-2-PRIME           PIC X(10).
  1175         16  PI-OE-REF-2-SUFF            PIC X.
  1176
  1177     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1178
  1179     12  PI-LANGUAGE-TYPE                PIC X.
  1180             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1181             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1182             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1183
  1184     12  PI-POLICY-LINKAGE-IND           PIC X.
  1185         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1186         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1187                                                   LOW-VALUES.
  1188
  1189     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1190     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1191         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1192         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1193
  1194     12  PI-PROCESSOR-CSR-IND            PIC X.
  1195         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1196         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1197
  1198     12  FILLER                          PIC X(3).
  1199
  1200     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1201
  1202     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1203         PI-SYSTEM-LEVEL.
  1204
  1205         16  PI-ENTRY-CODES.
  1206             20  PI-ENTRY-CD-1           PIC X.
  1207             20  PI-ENTRY-CD-2           PIC X.
  1208
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  23
* EL6318.cbl
  1209         16  PI-RETURN-CODES.
  1210             20  PI-RETURN-CD-1          PIC X.
  1211             20  PI-RETURN-CD-2          PIC X.
  1212
  1213         16  PI-UPDATE-STATUS-SAVE.
  1214             20  PI-UPDATE-BY            PIC X(4).
  1215             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1216
  1217         16  PI-LOWER-CASE-LETTERS       PIC X.
  1218             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1219
  1220*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1221*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1222*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1223
  1224         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1225             88  ST-ACCNT-CNTL               VALUE ' '.
  1226             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1227             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1228             88  ACCNT-CNTL                  VALUE '3'.
  1229             88  CARR-ACCNT-CNTL             VALUE '4'.
  1230
  1231         16  PI-PROCESSOR-CAP-LIST.
  1232             20  PI-SYSTEM-CONTROLS.
  1233                24 PI-SYSTEM-DISPLAY     PIC X.
  1234                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1235                24 PI-SYSTEM-MODIFY      PIC X.
  1236                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1237             20  FILLER                  PIC XX.
  1238             20  PI-DISPLAY-CAP          PIC X.
  1239                 88  DISPLAY-CAP             VALUE 'Y'.
  1240             20  PI-MODIFY-CAP           PIC X.
  1241                 88  MODIFY-CAP              VALUE 'Y'.
  1242             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1243                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1244             20  PI-FORCE-CAP            PIC X.
  1245                 88  FORCE-CAP               VALUE 'Y'.
  1246
  1247         16  PI-PROGRAM-CONTROLS.
  1248             20  PI-PGM-PRINT-OPT        PIC X.
  1249             20  PI-PGM-FORMAT-OPT       PIC X.
  1250             20  PI-PGM-PROCESS-OPT      PIC X.
  1251             20  PI-PGM-TOTALS-OPT       PIC X.
  1252
  1253         16  PI-HELP-INTERFACE.
  1254             20  PI-LAST-ERROR-NO        PIC X(4).
  1255             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1256
  1257         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1258             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1259
  1260         16  PI-CR-CONTROL-IN-PROGRESS.
  1261             20  PI-CR-CARRIER           PIC X.
  1262             20  PI-CR-GROUPING          PIC X(6).
  1263             20  PI-CR-STATE             PIC XX.
  1264             20  PI-CR-ACCOUNT           PIC X(10).
  1265             20  PI-CR-FIN-RESP          PIC X(10).
  1266             20  PI-CR-TYPE              PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  24
* EL6318.cbl
  1267
  1268         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1269
  1270         16  PI-CR-MONTH-END-DT          PIC XX.
  1271
  1272         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1273             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1274             88  PI-ZERO-CARRIER             VALUE '1'.
  1275             88  PI-ZERO-GROUPING            VALUE '2'.
  1276             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1277
  1278         16  PI-CARRIER-SECURITY         PIC X.
  1279             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1280
  1281         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1282             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1283             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1284
  1285         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1286             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1287                                         INDEXED BY PI-ACCESS-NDX
  1288                                         PIC X.
  1289
  1290         16  PI-GA-BILLING-CONTROL       PIC X.
  1291             88  PI-GA-BILLING               VALUE '1'.
  1292
  1293         16  PI-MAIL-PROCESSING          PIC X.
  1294             88  PI-MAIL-YES                 VALUE 'Y'.
  1295
  1296         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1297
  1298         16  PI-AR-SYSTEM.
  1299             20  PI-AR-PROCESSING-CNTL   PIC X.
  1300                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1301             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1302             20  PI-AR-MONTH-END-DT      PIC XX.
  1303
  1304         16  PI-MP-SYSTEM.
  1305             20  PI-MORTGAGE-USER            PIC X.
  1306                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1307                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1308             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1309                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1310                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1311                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1312                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1313                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1314             20  PI-MP-MONTH-END-DT          PIC XX.
  1315             20  PI-MP-REFERENCE-NO.
  1316                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1317                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1318
  1319         16  PI-LABEL-CONTROL            PIC X(01).
  1320             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1321             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1322
  1323         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1324             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  25
* EL6318.cbl
  1325
  1326         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1327             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1328             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1329
  1330         16  FILLER                      PIC X(14).
  1331
  1332     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1333******************************************************************
  1334     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1335        16  PI-ISS-CAN-SW           PIC X.
  1336        16  PI-ERENDT-KEY.  *>  36
  1337            20  PI-ENDT-COMPANY-CD  PIC X.
  1338            20  PI-ENDT-CARRIER     PIC X.
  1339            20  PI-ENDT-GROUPING    PIC X(6).
  1340            20  PI-ENDT-STATE       PIC XX.
  1341            20  PI-ENDT-ACCOUNT     PIC X(10).
  1342            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1343            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1344            20  PI-ENDT-CERT-SFX    PIC X.
  1345            20  PI-ENDT-RECORD-TYPE PIC X.
  1346            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1347        16  PI-ELCRTO-KEY.  *> 36
  1348            20  PI-CRTO-COMPANY-CD  PIC X.
  1349            20  PI-CRTO-CARRIER     PIC X.
  1350            20  PI-CRTO-GROUPING    PIC X(6).
  1351            20  PI-CRTO-STATE       PIC XX.
  1352            20  PI-CRTO-ACCOUNT     PIC X(10).
  1353            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1354            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1355            20  PI-CRTO-CERT-SFX    PIC X.
  1356            20  PI-CRTO-RECORD-TYPE PIC X.
  1357            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1358        16  PI-ERPNDB-KEY           PIC X(11).
  1359        16  PI-DOCUMENT-PROCESSED   PIC X.
  1360            88  PI-VERI-PROCESSED      VALUE 'V'.
  1361            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1362        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1363        16  PI-RES-REF-CLM-TYPE     PIC X.
  1364        16  PI-CLM-REFORM-IND       PIC X.
  1365            88  PI-CLAIM-REFORMATION   VALUE 'Y'.
  1366        16  PI-CLEAR-ERROR-SW       PIC X.
  1367            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1368        16  PI-PRINT-CERTIFICATE    PIC X.
  1369        16  PI-ENTERED.  *> 233
  1370            20  PI-PRTSW-ENTERED    PIC X.
  1371            20  PI-SIGREQ-ENTERED   PIC X.
  1372            20  PI-LTRID-ENTERED    PIC X(4).
  1373            20  PI-VOUCHER-ENTERED  PIC X.
  1374            20  PI-HLTHAPP-ENTERED  PIC X.
  1375            20  PI-PAYEE-ENTERED    PIC X(10).
  1376            20  PI-CERTID-ENTERED   PIC X(5).
  1377            20  PI-REASONS-ENTERED  PIC X(84).
  1378            20  PI-CERTNT1-ENTERED  PIC X(63).
  1379            20  PI-CERTNT2-ENTERED  PIC X(63).
  1380        16  PI-FINALIZED-IND        PIC X.
  1381        16  PI-CERTNT3-ENTERED      PIC X(63).
  1382        16  PI-CERTNT4-ENTERED      PIC X(63).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  26
* EL6318.cbl
  1383        16  PI-BILLNT1-ENTERED      PIC X(63).
  1384        16  PI-BILLNT2-ENTERED      PIC X(63).
  1385        16  PI-REASON-CODE-IND      PIC X(26).
  1386        16  PI-ENCCODE              PIC X(3).
  1387    12  pi-el677-work-area redefines pi-program-work-area.
  1388        16  filler                  pic x(318).
  1389        16  pi-el677-prm-diff       pic s9(7)v99 comp-3.
  1390        16  pi-el677-com-diff       pic s9(5)v99 comp-3.
  1391        16  pi-el677-check-type     pic x.
  1392        16  pi-el677-check-cut      pic x.
  1393        16  filler                  pic x(311).
  1394    12  pi-endt-prm-diff            pic s9(7)v99 comp-3.
  1395    12  pi-endt-com-diff            pic s9(5)v99 comp-3.
  1396    12  pi-check-cut                pic x.
  1397    12  pi-check-type               pic x.
  1398    12  FILLER                      PIC X(265). *> was 276
  1399*    COPY ELCAID.
  1400******************************************************************
  1401*                                                                *
  1402*                            ELCAID.                             *
  1403*                            VMOD=2.001                          *
  1404*                                                                *
  1405*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1406*                                                                *
  1407*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1408*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1409******************************************************************
  1410
  1411 01  DFHAID.
  1412   02  DFHNULL   PIC  X  VALUE  ' '.
  1413   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1414   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1415   02  DFHPEN    PIC  X  VALUE  '='.
  1416   02  DFHOPID   PIC  X  VALUE  'W'.
  1417   02  DFHPA1    PIC  X  VALUE  '%'.
  1418   02  DFHPA2    PIC  X  VALUE  '>'.
  1419   02  DFHPA3    PIC  X  VALUE  ','.
  1420   02  DFHPF1    PIC  X  VALUE  '1'.
  1421   02  DFHPF2    PIC  X  VALUE  '2'.
  1422   02  DFHPF3    PIC  X  VALUE  '3'.
  1423   02  DFHPF4    PIC  X  VALUE  '4'.
  1424   02  DFHPF5    PIC  X  VALUE  '5'.
  1425   02  DFHPF6    PIC  X  VALUE  '6'.
  1426   02  DFHPF7    PIC  X  VALUE  '7'.
  1427   02  DFHPF8    PIC  X  VALUE  '8'.
  1428   02  DFHPF9    PIC  X  VALUE  '9'.
  1429   02  DFHPF10   PIC  X  VALUE  ':'.
  1430   02  DFHPF11   PIC  X  VALUE  '#'.
  1431   02  DFHPF12   PIC  X  VALUE  '@'.
  1432   02  DFHPF13   PIC  X  VALUE  'A'.
  1433   02  DFHPF14   PIC  X  VALUE  'B'.
  1434   02  DFHPF15   PIC  X  VALUE  'C'.
  1435   02  DFHPF16   PIC  X  VALUE  'D'.
  1436   02  DFHPF17   PIC  X  VALUE  'E'.
  1437   02  DFHPF18   PIC  X  VALUE  'F'.
  1438   02  DFHPF19   PIC  X  VALUE  'G'.
  1439   02  DFHPF20   PIC  X  VALUE  'H'.
  1440   02  DFHPF21   PIC  X  VALUE  'I'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  27
* EL6318.cbl
  1441*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1442   02  DFHPF22   PIC  X  VALUE  '['.
  1443   02  DFHPF23   PIC  X  VALUE  '.'.
  1444   02  DFHPF24   PIC  X  VALUE  '<'.
  1445   02  DFHMSRE   PIC  X  VALUE  'X'.
  1446   02  DFHSTRF   PIC  X  VALUE  'h'.
  1447   02  DFHTRIG   PIC  X  VALUE  '"'.
  1448 01  FILLER    REDEFINES DFHAID.
  1449     12  FILLER              PIC X(8).
  1450     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1451     12  FILLER              PIC X(3).
  1452*   COPY EL6318S.
  1453 01  EL631KI.
  1454     05  FILLER            PIC  X(0012).
  1455*    -------------------------------
  1456     05  DATEL PIC S9(0004) COMP.
  1457     05  DATEF PIC  X(0001).
  1458     05  FILLER REDEFINES DATEF.
  1459         10  DATEA PIC  X(0001).
  1460     05  DATEI PIC  X(0008).
  1461*    -------------------------------
  1462     05  TIMEL PIC S9(0004) COMP.
  1463     05  TIMEF PIC  X(0001).
  1464     05  FILLER REDEFINES TIMEF.
  1465         10  TIMEA PIC  X(0001).
  1466     05  TIMEI PIC  X(0005).
  1467*    -------------------------------
  1468     05  PROCIDL PIC S9(0004) COMP.
  1469     05  PROCIDF PIC  X(0001).
  1470     05  FILLER REDEFINES PROCIDF.
  1471         10  PROCIDA PIC  X(0001).
  1472     05  PROCIDI PIC  X(0004).
  1473*    -------------------------------
  1474     05  HOSTL PIC S9(0004) COMP.
  1475     05  HOSTF PIC  X(0001).
  1476     05  FILLER REDEFINES HOSTF.
  1477         10  HOSTA PIC  X(0001).
  1478     05  HOSTI PIC  X(0009).
  1479*    -------------------------------
  1480     05  SYSL PIC S9(0004) COMP.
  1481     05  SYSF PIC  X(0001).
  1482     05  FILLER REDEFINES SYSF.
  1483         10  SYSA PIC  X(0001).
  1484     05  SYSI PIC  X(0005).
  1485*    -------------------------------
  1486     05  COMPANYL PIC S9(0004) COMP.
  1487     05  COMPANYF PIC  X(0001).
  1488     05  FILLER REDEFINES COMPANYF.
  1489         10  COMPANYA PIC  X(0001).
  1490     05  COMPANYI PIC  X(0003).
  1491*    -------------------------------
  1492     05  DATASORL PIC S9(0004) COMP.
  1493     05  DATASORF PIC  X(0001).
  1494     05  FILLER REDEFINES DATASORF.
  1495         10  DATASORA PIC  X(0001).
  1496     05  DATASORI PIC  X(0001).
  1497*    -------------------------------
  1498     05  BATCHNOL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  28
* EL6318.cbl
  1499     05  BATCHNOF PIC  X(0001).
  1500     05  FILLER REDEFINES BATCHNOF.
  1501         10  BATCHNOA PIC  X(0001).
  1502     05  BATCHNOI PIC  X(0006).
  1503*    -------------------------------
  1504     05  BSEQNOL PIC S9(0004) COMP.
  1505     05  BSEQNOF PIC  X(0001).
  1506     05  FILLER REDEFINES BSEQNOF.
  1507         10  BSEQNOA PIC  X(0001).
  1508     05  BSEQNOI PIC  X(0008).
  1509*    -------------------------------
  1510     05  ARCHNOL PIC S9(0004) COMP.
  1511     05  ARCHNOF PIC  X(0001).
  1512     05  FILLER REDEFINES ARCHNOF.
  1513         10  ARCHNOA PIC  X(0001).
  1514     05  ARCHNOI PIC  X(0008).
  1515*    -------------------------------
  1516     05  PRTSWL PIC S9(0004) COMP.
  1517     05  PRTSWF PIC  X(0001).
  1518     05  FILLER REDEFINES PRTSWF.
  1519         10  PRTSWA PIC  X(0001).
  1520     05  PRTSWI PIC  X(0001).
  1521*    -------------------------------
  1522     05  CARRL PIC S9(0004) COMP.
  1523     05  CARRF PIC  X(0001).
  1524     05  FILLER REDEFINES CARRF.
  1525         10  CARRA PIC  X(0001).
  1526     05  CARRI PIC  X(0001).
  1527*    -------------------------------
  1528     05  GROUPL PIC S9(0004) COMP.
  1529     05  GROUPF PIC  X(0001).
  1530     05  FILLER REDEFINES GROUPF.
  1531         10  GROUPA PIC  X(0001).
  1532     05  GROUPI PIC  X(0006).
  1533*    -------------------------------
  1534     05  STATEL PIC S9(0004) COMP.
  1535     05  STATEF PIC  X(0001).
  1536     05  FILLER REDEFINES STATEF.
  1537         10  STATEA PIC  X(0001).
  1538     05  STATEI PIC  X(0002).
  1539*    -------------------------------
  1540     05  ACCTL PIC S9(0004) COMP.
  1541     05  ACCTF PIC  X(0001).
  1542     05  FILLER REDEFINES ACCTF.
  1543         10  ACCTA PIC  X(0001).
  1544     05  ACCTI PIC  X(0010).
  1545*    -------------------------------
  1546     05  EFFDTL PIC S9(0004) COMP.
  1547     05  EFFDTF PIC  X(0001).
  1548     05  FILLER REDEFINES EFFDTF.
  1549         10  EFFDTA PIC  X(0001).
  1550     05  EFFDTI PIC  X(0008).
  1551*    -------------------------------
  1552     05  CERTNOL PIC S9(0004) COMP.
  1553     05  CERTNOF PIC  X(0001).
  1554     05  FILLER REDEFINES CERTNOF.
  1555         10  CERTNOA PIC  X(0001).
  1556     05  CERTNOI PIC  X(0010).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  29
* EL6318.cbl
  1557*    -------------------------------
  1558     05  CRTSFXL PIC S9(0004) COMP.
  1559     05  CRTSFXF PIC  X(0001).
  1560     05  FILLER REDEFINES CRTSFXF.
  1561         10  CRTSFXA PIC  X(0001).
  1562     05  CRTSFXI PIC  X(0001).
  1563*    -------------------------------
  1564     05  SEQNOL PIC S9(0004) COMP.
  1565     05  SEQNOF PIC  X(0001).
  1566     05  FILLER REDEFINES SEQNOF.
  1567         10  SEQNOA PIC  X(0001).
  1568     05  SEQNOI PIC  X(0006).
  1569*    -------------------------------
  1570     05  SIGREQL PIC S9(0004) COMP.
  1571     05  SIGREQF PIC  X(0001).
  1572     05  FILLER REDEFINES SIGREQF.
  1573         10  SIGREQA PIC  X(0001).
  1574     05  SIGREQI PIC  X(0001).
  1575*    -------------------------------
  1576     05  LTRIDL PIC S9(0004) COMP.
  1577     05  LTRIDF PIC  X(0001).
  1578     05  FILLER REDEFINES LTRIDF.
  1579         10  LTRIDA PIC  X(0001).
  1580     05  LTRIDI PIC  X(0004).
  1581*    -------------------------------
  1582     05  HLTHAPPL PIC S9(0004) COMP.
  1583     05  HLTHAPPF PIC  X(0001).
  1584     05  FILLER REDEFINES HLTHAPPF.
  1585         10  HLTHAPPA PIC  X(0001).
  1586     05  HLTHAPPI PIC  X(0001).
  1587*    -------------------------------
  1588     05  VOUCHL PIC S9(0004) COMP.
  1589     05  VOUCHF PIC  X(0001).
  1590     05  FILLER REDEFINES VOUCHF.
  1591         10  VOUCHA PIC  X(0001).
  1592     05  VOUCHI PIC  X(0001).
  1593*    -------------------------------
  1594     05  PAYEEL PIC S9(0004) COMP.
  1595     05  PAYEEF PIC  X(0001).
  1596     05  FILLER REDEFINES PAYEEF.
  1597         10  PAYEEA PIC  X(0001).
  1598     05  PAYEEI PIC  X(0010).
  1599*    -------------------------------
  1600     05  CERTIDL PIC S9(0004) COMP.
  1601     05  CERTIDF PIC  X(0001).
  1602     05  FILLER REDEFINES CERTIDF.
  1603         10  CERTIDA PIC  X(0001).
  1604     05  CERTIDI PIC  X(0005).
  1605*    -------------------------------
  1606     05  ENCCODEL PIC S9(0004) COMP.
  1607     05  ENCCODEF PIC  X(0001).
  1608     05  FILLER REDEFINES ENCCODEF.
  1609         10  ENCCODEA PIC  X(0001).
  1610     05  ENCCODEI PIC  X(0003).
  1611*    -------------------------------
  1612     05  RCD01L PIC S9(0004) COMP.
  1613     05  RCD01F PIC  X(0001).
  1614     05  FILLER REDEFINES RCD01F.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  30
* EL6318.cbl
  1615         10  RCD01A PIC  X(0001).
  1616     05  RCD01I PIC  X(0004).
  1617*    -------------------------------
  1618     05  RCD02L PIC S9(0004) COMP.
  1619     05  RCD02F PIC  X(0001).
  1620     05  FILLER REDEFINES RCD02F.
  1621         10  RCD02A PIC  X(0001).
  1622     05  RCD02I PIC  X(0004).
  1623*    -------------------------------
  1624     05  RCD03L PIC S9(0004) COMP.
  1625     05  RCD03F PIC  X(0001).
  1626     05  FILLER REDEFINES RCD03F.
  1627         10  RCD03A PIC  X(0001).
  1628     05  RCD03I PIC  X(0004).
  1629*    -------------------------------
  1630     05  RCD04L PIC S9(0004) COMP.
  1631     05  RCD04F PIC  X(0001).
  1632     05  FILLER REDEFINES RCD04F.
  1633         10  RCD04A PIC  X(0001).
  1634     05  RCD04I PIC  X(0004).
  1635*    -------------------------------
  1636     05  RCD05L PIC S9(0004) COMP.
  1637     05  RCD05F PIC  X(0001).
  1638     05  FILLER REDEFINES RCD05F.
  1639         10  RCD05A PIC  X(0001).
  1640     05  RCD05I PIC  X(0004).
  1641*    -------------------------------
  1642     05  RCD06L PIC S9(0004) COMP.
  1643     05  RCD06F PIC  X(0001).
  1644     05  FILLER REDEFINES RCD06F.
  1645         10  RCD06A PIC  X(0001).
  1646     05  RCD06I PIC  X(0004).
  1647*    -------------------------------
  1648     05  RCD07L PIC S9(0004) COMP.
  1649     05  RCD07F PIC  X(0001).
  1650     05  FILLER REDEFINES RCD07F.
  1651         10  RCD07A PIC  X(0001).
  1652     05  RCD07I PIC  X(0004).
  1653*    -------------------------------
  1654     05  RCD08L PIC S9(0004) COMP.
  1655     05  RCD08F PIC  X(0001).
  1656     05  FILLER REDEFINES RCD08F.
  1657         10  RCD08A PIC  X(0001).
  1658     05  RCD08I PIC  X(0004).
  1659*    -------------------------------
  1660     05  RCD09L PIC S9(0004) COMP.
  1661     05  RCD09F PIC  X(0001).
  1662     05  FILLER REDEFINES RCD09F.
  1663         10  RCD09A PIC  X(0001).
  1664     05  RCD09I PIC  X(0004).
  1665*    -------------------------------
  1666     05  RCD10L PIC S9(0004) COMP.
  1667     05  RCD10F PIC  X(0001).
  1668     05  FILLER REDEFINES RCD10F.
  1669         10  RCD10A PIC  X(0001).
  1670     05  RCD10I PIC  X(0004).
  1671*    -------------------------------
  1672     05  RCD11L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  31
* EL6318.cbl
  1673     05  RCD11F PIC  X(0001).
  1674     05  FILLER REDEFINES RCD11F.
  1675         10  RCD11A PIC  X(0001).
  1676     05  RCD11I PIC  X(0004).
  1677*    -------------------------------
  1678     05  RCD12L PIC S9(0004) COMP.
  1679     05  RCD12F PIC  X(0001).
  1680     05  FILLER REDEFINES RCD12F.
  1681         10  RCD12A PIC  X(0001).
  1682     05  RCD12I PIC  X(0004).
  1683*    -------------------------------
  1684     05  CRTNT1L PIC S9(0004) COMP.
  1685     05  CRTNT1F PIC  X(0001).
  1686     05  FILLER REDEFINES CRTNT1F.
  1687         10  CRTNT1A PIC  X(0001).
  1688     05  CRTNT1I PIC  X(0063).
  1689*    -------------------------------
  1690     05  CRTNT2L PIC S9(0004) COMP.
  1691     05  CRTNT2F PIC  X(0001).
  1692     05  FILLER REDEFINES CRTNT2F.
  1693         10  CRTNT2A PIC  X(0001).
  1694     05  CRTNT2I PIC  X(0063).
  1695*    -------------------------------
  1696     05  CRTNT3L PIC S9(0004) COMP.
  1697     05  CRTNT3F PIC  X(0001).
  1698     05  FILLER REDEFINES CRTNT3F.
  1699         10  CRTNT3A PIC  X(0001).
  1700     05  CRTNT3I PIC  X(0063).
  1701*    -------------------------------
  1702     05  CRTNT4L PIC S9(0004) COMP.
  1703     05  CRTNT4F PIC  X(0001).
  1704     05  FILLER REDEFINES CRTNT4F.
  1705         10  CRTNT4A PIC  X(0001).
  1706     05  CRTNT4I PIC  X(0063).
  1707*    -------------------------------
  1708     05  BILNT1L PIC S9(0004) COMP.
  1709     05  BILNT1F PIC  X(0001).
  1710     05  FILLER REDEFINES BILNT1F.
  1711         10  BILNT1A PIC  X(0001).
  1712     05  BILNT1I PIC  X(0063).
  1713*    -------------------------------
  1714     05  BILNT2L PIC S9(0004) COMP.
  1715     05  BILNT2F PIC  X(0001).
  1716     05  FILLER REDEFINES BILNT2F.
  1717         10  BILNT2A PIC  X(0001).
  1718     05  BILNT2I PIC  X(0063).
  1719*    -------------------------------
  1720     05  ERRMSG1L PIC S9(0004) COMP.
  1721     05  ERRMSG1F PIC  X(0001).
  1722     05  FILLER REDEFINES ERRMSG1F.
  1723         10  ERRMSG1A PIC  X(0001).
  1724     05  ERRMSG1I PIC  X(0075).
  1725*    -------------------------------
  1726     05  ERRMSG2L PIC S9(0004) COMP.
  1727     05  ERRMSG2F PIC  X(0001).
  1728     05  FILLER REDEFINES ERRMSG2F.
  1729         10  ERRMSG2A PIC  X(0001).
  1730     05  ERRMSG2I PIC  X(0075).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  32
* EL6318.cbl
  1731*    -------------------------------
  1732     05  PFENTRL PIC S9(0004) COMP.
  1733     05  PFENTRF PIC  X(0001).
  1734     05  FILLER REDEFINES PFENTRF.
  1735         10  PFENTRA PIC  X(0001).
  1736     05  PFENTRI PIC  9(2).
  1737 01  EL631KO REDEFINES EL631KI.
  1738     05  FILLER            PIC  X(0012).
  1739*    -------------------------------
  1740     05  FILLER            PIC  X(0003).
  1741     05  DATEO PIC  X(0008).
  1742*    -------------------------------
  1743     05  FILLER            PIC  X(0003).
  1744     05  TIMEO PIC  99.99.
  1745*    -------------------------------
  1746     05  FILLER            PIC  X(0003).
  1747     05  PROCIDO PIC  X(0004).
  1748*    -------------------------------
  1749     05  FILLER            PIC  X(0003).
  1750     05  HOSTO PIC  X(0009).
  1751*    -------------------------------
  1752     05  FILLER            PIC  X(0003).
  1753     05  SYSO PIC  X(0005).
  1754*    -------------------------------
  1755     05  FILLER            PIC  X(0003).
  1756     05  COMPANYO PIC  X(0003).
  1757*    -------------------------------
  1758     05  FILLER            PIC  X(0003).
  1759     05  DATASORO PIC  X(0001).
  1760*    -------------------------------
  1761     05  FILLER            PIC  X(0003).
  1762     05  BATCHNOO PIC  X(0006).
  1763*    -------------------------------
  1764     05  FILLER            PIC  X(0003).
  1765     05  BSEQNOO PIC  X(0008).
  1766*    -------------------------------
  1767     05  FILLER            PIC  X(0003).
  1768     05  ARCHNOO PIC  X(0008).
  1769*    -------------------------------
  1770     05  FILLER            PIC  X(0003).
  1771     05  PRTSWO PIC  X(0001).
  1772*    -------------------------------
  1773     05  FILLER            PIC  X(0003).
  1774     05  CARRO PIC  X(0001).
  1775*    -------------------------------
  1776     05  FILLER            PIC  X(0003).
  1777     05  GROUPO PIC  X(0006).
  1778*    -------------------------------
  1779     05  FILLER            PIC  X(0003).
  1780     05  STATEO PIC  X(0002).
  1781*    -------------------------------
  1782     05  FILLER            PIC  X(0003).
  1783     05  ACCTO PIC  X(0010).
  1784*    -------------------------------
  1785     05  FILLER            PIC  X(0003).
  1786     05  EFFDTO PIC  X(0008).
  1787*    -------------------------------
  1788     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  33
* EL6318.cbl
  1789     05  CERTNOO PIC  X(0010).
  1790*    -------------------------------
  1791     05  FILLER            PIC  X(0003).
  1792     05  CRTSFXO PIC  X(0001).
  1793*    -------------------------------
  1794     05  FILLER            PIC  X(0003).
  1795     05  SEQNOO PIC  999999.
  1796*    -------------------------------
  1797     05  FILLER            PIC  X(0003).
  1798     05  SIGREQO PIC  X(0001).
  1799*    -------------------------------
  1800     05  FILLER            PIC  X(0003).
  1801     05  LTRIDO PIC  X(0004).
  1802*    -------------------------------
  1803     05  FILLER            PIC  X(0003).
  1804     05  HLTHAPPO PIC  X(0001).
  1805*    -------------------------------
  1806     05  FILLER            PIC  X(0003).
  1807     05  VOUCHO PIC  X(0001).
  1808*    -------------------------------
  1809     05  FILLER            PIC  X(0003).
  1810     05  PAYEEO PIC  X(0010).
  1811*    -------------------------------
  1812     05  FILLER            PIC  X(0003).
  1813     05  CERTIDO PIC  X(0005).
  1814*    -------------------------------
  1815     05  FILLER            PIC  X(0003).
  1816     05  ENCCODEO PIC  X(0003).
  1817*    -------------------------------
  1818     05  FILLER            PIC  X(0003).
  1819     05  RCD01O PIC  X(0004).
  1820*    -------------------------------
  1821     05  FILLER            PIC  X(0003).
  1822     05  RCD02O PIC  X(0004).
  1823*    -------------------------------
  1824     05  FILLER            PIC  X(0003).
  1825     05  RCD03O PIC  X(0004).
  1826*    -------------------------------
  1827     05  FILLER            PIC  X(0003).
  1828     05  RCD04O PIC  X(0004).
  1829*    -------------------------------
  1830     05  FILLER            PIC  X(0003).
  1831     05  RCD05O PIC  X(0004).
  1832*    -------------------------------
  1833     05  FILLER            PIC  X(0003).
  1834     05  RCD06O PIC  X(0004).
  1835*    -------------------------------
  1836     05  FILLER            PIC  X(0003).
  1837     05  RCD07O PIC  X(0004).
  1838*    -------------------------------
  1839     05  FILLER            PIC  X(0003).
  1840     05  RCD08O PIC  X(0004).
  1841*    -------------------------------
  1842     05  FILLER            PIC  X(0003).
  1843     05  RCD09O PIC  X(0004).
  1844*    -------------------------------
  1845     05  FILLER            PIC  X(0003).
  1846     05  RCD10O PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  34
* EL6318.cbl
  1847*    -------------------------------
  1848     05  FILLER            PIC  X(0003).
  1849     05  RCD11O PIC  X(0004).
  1850*    -------------------------------
  1851     05  FILLER            PIC  X(0003).
  1852     05  RCD12O PIC  X(0004).
  1853*    -------------------------------
  1854     05  FILLER            PIC  X(0003).
  1855     05  CRTNT1O PIC  X(0063).
  1856*    -------------------------------
  1857     05  FILLER            PIC  X(0003).
  1858     05  CRTNT2O PIC  X(0063).
  1859*    -------------------------------
  1860     05  FILLER            PIC  X(0003).
  1861     05  CRTNT3O PIC  X(0063).
  1862*    -------------------------------
  1863     05  FILLER            PIC  X(0003).
  1864     05  CRTNT4O PIC  X(0063).
  1865*    -------------------------------
  1866     05  FILLER            PIC  X(0003).
  1867     05  BILNT1O PIC  X(0063).
  1868*    -------------------------------
  1869     05  FILLER            PIC  X(0003).
  1870     05  BILNT2O PIC  X(0063).
  1871*    -------------------------------
  1872     05  FILLER            PIC  X(0003).
  1873     05  ERRMSG1O PIC  X(0075).
  1874*    -------------------------------
  1875     05  FILLER            PIC  X(0003).
  1876     05  ERRMSG2O PIC  X(0075).
  1877*    -------------------------------
  1878     05  FILLER            PIC  X(0003).
  1879     05  PFENTRO PIC  X(0002).
  1880*    -------------------------------
  1881 01  FILLER REDEFINES EL631KI.
  1882     12  FILLER             PIC X(217).
  1883     12  REASONCDS.
  1884         16  FILLER OCCURS 12.
  1885           20  REACDL       PIC S9(4) COMP.
  1886           20  REACDA       PIC X.
  1887           20  REACD-IN     PIC X(4).
  1888     12  FILLER             PIC X(557).
  1889****************************************************************
  1890*
  1891* Copyright (c) 2007-2013 Dell Inc.
  1892* All rights reserved.
  1893*
  1894****************************************************************
  1895 01  DFHEIV.
  1896   02  DFHEIV0               PIC X(35).
  1897   02  DFHEIV1               PIC X(08).
  1898   02  DFHEIV2               PIC X(08).
  1899   02  DFHEIV3               PIC X(08).
  1900   02  DFHEIV4               PIC X(06).
  1901   02  DFHEIV5               PIC X(04).
  1902   02  DFHEIV6               PIC X(04).
  1903   02  DFHEIV7               PIC X(02).
  1904   02  DFHEIV8               PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  35
* EL6318.cbl
  1905   02  DFHEIV9               PIC X(01).
  1906   02  DFHEIV10              PIC S9(7) COMP-3.
  1907   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1908   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1909   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1910   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1911   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1912   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1913   02  DFHEIV17              PIC X(04).
  1914   02  DFHEIV18              PIC X(04).
  1915   02  DFHEIV19              PIC X(04).
  1916   02  DFHEIV20              USAGE IS POINTER.
  1917   02  DFHEIV21              USAGE IS POINTER.
  1918   02  DFHEIV22              USAGE IS POINTER.
  1919   02  DFHEIV23              USAGE IS POINTER.
  1920   02  DFHEIV24              USAGE IS POINTER.
  1921   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1922   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1923   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1924   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1925   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1926   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1927   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1928   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1929   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1930   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1931   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1932   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1933   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1934   02  FILLER                PIC X(02).
  1935   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1936   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1937   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1938   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1939   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1940   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1941   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1942 LINKAGE  SECTION.
  1943*****************************************************************
  1944*                                                               *
  1945* Copyright (c) 2007-2013 Dell Inc.                             *
  1946* All rights reserved.                                          *
  1947*                                                               *
  1948*****************************************************************
  1949 01  dfheiblk.
  1950     02  eibtime          pic s9(7) comp-3.
  1951     02  eibdate          pic s9(7) comp-3.
  1952     02  eibtrnid         pic x(4).
  1953     02  eibtaskn         pic s9(7) comp-3.
  1954     02  eibtrmid         pic x(4).
  1955     02  dfheigdi         pic s9(4) comp.
  1956     02  eibcposn         pic s9(4) comp.
  1957     02  eibcalen         pic s9(4) comp.
  1958     02  eibaid           pic x(1).
  1959     02  eibfiller1       pic x(1).
  1960     02  eibfn            pic x(2).
  1961     02  eibfiller2       pic x(2).
  1962     02  eibrcode         pic x(6).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  36
* EL6318.cbl
  1963     02  eibfiller3       pic x(2).
  1964     02  eibds            pic x(8).
  1965     02  eibreqid         pic x(8).
  1966     02  eibrsrce         pic x(8).
  1967     02  eibsync          pic x(1).
  1968     02  eibfree          pic x(1).
  1969     02  eibrecv          pic x(1).
  1970     02  eibsend          pic x(1).
  1971     02  eibatt           pic x(1).
  1972     02  eibeoc           pic x(1).
  1973     02  eibfmh           pic x(1).
  1974     02  eibcompl         pic x(1).
  1975     02  eibsig           pic x(1).
  1976     02  eibconf          pic x(1).
  1977     02  eiberr           pic x(1).
  1978     02  eibrldbk         pic x(1).
  1979     02  eiberrcd         pic x(4).
  1980     02  eibsynrb         pic x(1).
  1981     02  eibnodat         pic x(1).
  1982     02  eibfiller5       pic x(2).
  1983     02  eibresp          pic s9(8) comp.
  1984     02  eibresp2         pic s9(8) comp.
  1985     02  dfheigdj         pic s9(4) comp.
  1986     02  dfheigdk         pic s9(4) comp.
  1987 01  DFHCOMMAREA                 PIC X(1300).
  1988 01  var  pic x(30).
  1989*                                COPY ERCACCT.
  1990******************************************************************
  1991*                                                                *
  1992*                                                                *
  1993*                            ERCACCT                             *
  1994*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1995*                            VMOD=2.031                          *
  1996*                                                                *
  1997*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1998*                                                                *
  1999*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  2000*   VSAM ACCOUNT MASTER FILES.                                   *
  2001*                                                                *
  2002*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2003*                                                                *
  2004*   FILE TYPE = VSAM,KSDS                                        *
  2005*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2006*                                                                *
  2007*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2008*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2009*                                                                *
  2010*   LOG = NO                                                     *
  2011*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2012*                                                                *
  2013*                                                                *
  2014******************************************************************
  2015*                   C H A N G E   L O G
  2016*
  2017* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2018*-----------------------------------------------------------------
  2019*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2020* EFFECTIVE    NUMBER
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  37
* EL6318.cbl
  2021*-----------------------------------------------------------------
  2022* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2023* 092705    2005050300006  PEMA  ADD SPP LEASES
  2024* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2025* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2026* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2027* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2028* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2029* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2030******************************************************************
  2031
  2032 01  ACCOUNT-MASTER.
  2033     12  AM-RECORD-ID                      PIC XX.
  2034         88  VALID-AM-ID                      VALUE 'AM'.
  2035
  2036     12  AM-CONTROL-PRIMARY.
  2037         16  AM-COMPANY-CD                 PIC X.
  2038         16  AM-MSTR-CNTRL.
  2039             20  AM-CONTROL-A.
  2040                 24  AM-CARRIER            PIC X.
  2041                 24  AM-GROUPING.
  2042                     28 AM-GROUPING-PREFIX PIC XXX.
  2043                     28 AM-GROUPING-PRIME  PIC XXX.
  2044                 24  AM-STATE              PIC XX.
  2045                 24  AM-ACCOUNT.
  2046                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2047                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2048             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2049                                           PIC X(19).
  2050             20  AM-CNTRL-B.
  2051                 24  AM-EXPIRATION-DT      PIC XX.
  2052                 24  FILLER                PIC X(4).
  2053             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2054                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2055
  2056     12  AM-CONTROL-BY-VAR-GRP.
  2057         16  AM-COMPANY-CD-A1              PIC X.
  2058         16  AM-VG-CARRIER                 PIC X.
  2059         16  AM-VG-GROUPING                PIC X(6).
  2060         16  AM-VG-STATE                   PIC XX.
  2061         16  AM-VG-ACCOUNT                 PIC X(10).
  2062         16  AM-VG-DATE.
  2063             20  AM-VG-EXPIRATION-DT       PIC XX.
  2064             20  FILLER                    PIC X(4).
  2065         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2066                                           PIC 9(11)      COMP-3.
  2067     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2068         16  FILLER                        PIC X(10).
  2069         16  AM-VG-KEY3.
  2070             20  AM-VG3-ACCOUNT            PIC X(10).
  2071             20  AM-VG3-EXP-DT             PIC XX.
  2072         16  FILLER                        PIC X(4).
  2073     12  AM-MAINT-INFORMATION.
  2074         16  AM-LAST-MAINT-DT              PIC XX.
  2075         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2076         16  AM-LAST-MAINT-USER            PIC X(4).
  2077         16  FILLER                        PIC XX.
  2078
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  38
* EL6318.cbl
  2079     12  AM-EFFECTIVE-DT                   PIC XX.
  2080     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2081
  2082     12  AM-PREV-DATES  COMP-3.
  2083         16  AM-PREV-EXP-DT                PIC 9(11).
  2084         16  AM-PREV-EFF-DT                PIC 9(11).
  2085
  2086     12  AM-REPORT-CODE-1                  PIC X(10).
  2087     12  AM-REPORT-CODE-2                  PIC X(10).
  2088
  2089     12  AM-CITY-CODE                      PIC X(4).
  2090     12  AM-COUNTY-PARISH                  PIC X(6).
  2091
  2092     12  AM-NAME                           PIC X(30).
  2093     12  AM-PERSON                         PIC X(30).
  2094     12  AM-ADDRS                          PIC X(30).
  2095     12  AM-CITY.
  2096         16  AM-ADDR-CITY                  PIC X(28).
  2097         16  AM-ADDR-STATE                 PIC XX.
  2098     12  AM-ZIP.
  2099         16  AM-ZIP-PRIME.
  2100             20  AM-ZIP-PRI-1ST            PIC X.
  2101                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2102             20  FILLER                    PIC X(4).
  2103         16  AM-ZIP-PLUS4                  PIC X(4).
  2104     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2105         16  AM-CAN-POSTAL-1               PIC XXX.
  2106         16  AM-CAN-POSTAL-2               PIC XXX.
  2107         16  FILLER                        PIC XXX.
  2108     12  AM-TEL-NO.
  2109         16  AM-AREA-CODE                  PIC 999.
  2110         16  AM-TEL-PRE                    PIC 999.
  2111         16  AM-TEL-NBR                    PIC 9(4).
  2112     12  AM-TEL-LOC                        PIC X.
  2113         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2114         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2115
  2116     12  AM-COMM-STRUCTURE.
  2117         16  AM-DEFN-1.
  2118             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2119                 24  AM-AGT.
  2120                     28  AM-AGT-PREFIX     PIC X(4).
  2121                     28  AM-AGT-PRIME      PIC X(6).
  2122                 24  AM-COM-TYP            PIC X.
  2123                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2124                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2125                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2126                 24  AM-RECALC-LV-INDIC    PIC X.
  2127                 24  AM-RETRO-LV-INDIC     PIC X.
  2128                 24  AM-GL-CODES           PIC X.
  2129                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2130                 24  FILLER                PIC X(01).
  2131         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2132             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2133                 24  FILLER                PIC X(11).
  2134                 24  AM-L-COMA             PIC XXX.
  2135                 24  AM-J-COMA             PIC XXX.
  2136                 24  AM-A-COMA             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  39
* EL6318.cbl
  2137                 24  FILLER                PIC X(6).
  2138
  2139     12  AM-COMM-CHANGE-STATUS             PIC X.
  2140         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2141
  2142     12  AM-CSR-CODE                       PIC X(4).
  2143
  2144     12  AM-BILLING-STATUS                 PIC X.
  2145         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2146         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2147     12  AM-AUTO-REFUND-SW                 PIC X.
  2148         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2149         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2150     12  AM-GPCD                           PIC 99.
  2151     12  AM-IG                             PIC X.
  2152         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2153         88  AM-HAS-GROUP                     VALUE '2'.
  2154     12  AM-STATUS                         PIC X.
  2155         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2156         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2157         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2158         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2159         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2160         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2161         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2162         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2163         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2164         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2165     12  AM-REMIT-TO                       PIC 99.
  2166     12  AM-ID-NO                          PIC X(11).
  2167
  2168     12  AM-CAL-TABLE                      PIC XX.
  2169     12  AM-LF-DEVIATION                   PIC XXX.
  2170     12  AM-AH-DEVIATION                   PIC XXX.
  2171     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2172     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2173     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2174     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2175     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2176     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2177
  2178     12  AM-USER-FIELDS.
  2179         16  AM-FLD-1                      PIC XX.
  2180         16  AM-FLD-2                      PIC XX.
  2181         16  AM-FLD-3                      PIC XX.
  2182         16  AM-FLD-4                      PIC XX.
  2183         16  AM-FLD-5                      PIC XX.
  2184
  2185     12  AM-1ST-PROD-DATE.
  2186         16  AM-1ST-PROD-YR                PIC XX.
  2187         16  AM-1ST-PROD-MO                PIC XX.
  2188         16  AM-1ST-PROD-DA                PIC XX.
  2189     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2190     12  AM-CERTS-PURGED-DATE.
  2191         16  AM-PUR-YR                     PIC XX.
  2192         16  AM-PUR-MO                     PIC XX.
  2193         16  AM-PUR-DA                     PIC XX.
  2194     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  40
* EL6318.cbl
  2195     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2196     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2197     12  AM-INACTIVE-DATE.
  2198         16  AM-INA-MO                     PIC 99.
  2199         16  AM-INA-DA                     PIC 99.
  2200         16  AM-INA-YR                     PIC 99.
  2201     12  AM-AR-HI-CERT-DATE                PIC XX.
  2202
  2203     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2204     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2205
  2206     12  AM-OB-PAYMENT-MODE                PIC X.
  2207         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2208         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2209         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2210         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2211
  2212     12  AM-AH-ONLY-INDICATOR              PIC X.
  2213         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2214         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2215
  2216     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2217
  2218     12  AM-OVER-SHORT.
  2219         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2220         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2221
  2222     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2223     12  AM-DCC-CLP-STATE                  PIC XX.
  2224
  2225     12  AM-RECALC-COMM                    PIC X.
  2226     12  AM-RECALC-REIN                    PIC X.
  2227
  2228     12  AM-REI-TABLE                      PIC XXX.
  2229     12  AM-REI-ET-LF                      PIC X.
  2230     12  AM-REI-ET-AH                      PIC X.
  2231     12  AM-REI-PE-LF                      PIC X.
  2232     12  AM-REI-PE-AH                      PIC X.
  2233     12  AM-REI-PRT-ST                     PIC X.
  2234     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2235     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2236     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2237     12  AM-REI-GROUP-A                    PIC X(6).
  2238     12  AM-REI-MORT                       PIC X(4).
  2239     12  AM-REI-PRT-OW                     PIC X.
  2240     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2241     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2242     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2243     12  AM-REI-GROUP-B                    PIC X(6).
  2244
  2245     12  AM-TRUST-TYPE                     PIC X(2).
  2246
  2247     12  AM-EMPLOYER-STMT-USED             PIC X.
  2248     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2249
  2250     12  AM-STD-AH-TYPE                    PIC XX.
  2251     12  AM-EARN-METHODS.
  2252         16  AM-EARN-METHOD-R              PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  41
* EL6318.cbl
  2253             88 AM-REF-RL-R78                 VALUE 'R'.
  2254             88 AM-REF-RL-PR                  VALUE 'P'.
  2255             88 AM-REF-RL-MEAN                VALUE 'M'.
  2256             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2257         16  AM-EARN-METHOD-L              PIC X.
  2258             88 AM-REF-LL-R78                 VALUE 'R'.
  2259             88 AM-REF-LL-PR                  VALUE 'P'.
  2260             88 AM-REF-LL-MEAN                VALUE 'M'.
  2261             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2262         16  AM-EARN-METHOD-A              PIC X.
  2263             88 AM-REF-AH-R78                 VALUE 'R'.
  2264             88 AM-REF-AH-PR                  VALUE 'P'.
  2265             88 AM-REF-AH-MEAN                VALUE 'M'.
  2266             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2267             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2268             88 AM-REF-AH-NET                 VALUE 'N'.
  2269
  2270     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2271     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2272     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2273
  2274     12  AM-RET-Y-N                        PIC X.
  2275     12  AM-RET-P-E                        PIC X.
  2276     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2277     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2278     12  AM-RET-GRP                        PIC X(6).
  2279     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2280         16  AM-POOL-PRIME                 PIC XXX.
  2281         16  AM-POOL-SUB                   PIC XXX.
  2282     12  AM-RETRO-EARNINGS.
  2283         16  AM-RET-EARN-R                 PIC X.
  2284         16  AM-RET-EARN-L                 PIC X.
  2285         16  AM-RET-EARN-A                 PIC X.
  2286     12  AM-RET-ST-TAX-USE                 PIC X.
  2287         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2288         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2289     12  AM-RETRO-BEG-EARNINGS.
  2290         16  AM-RET-BEG-EARN-R             PIC X.
  2291         16  AM-RET-BEG-EARN-L             PIC X.
  2292         16  AM-RET-BEG-EARN-A             PIC X.
  2293     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2294     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2295
  2296     12  AM-USER-SELECT-OPTIONS.
  2297         16  AM-USER-SELECT-1              PIC X(10).
  2298         16  AM-USER-SELECT-2              PIC X(10).
  2299         16  AM-USER-SELECT-3              PIC X(10).
  2300         16  AM-USER-SELECT-4              PIC X(10).
  2301         16  AM-USER-SELECT-5              PIC X(10).
  2302
  2303     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2304
  2305     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2306
  2307     12  AM-RPT045A-SWITCH                 PIC X.
  2308         88  RPT045A-OFF                   VALUE 'N'.
  2309
  2310     12  AM-INSURANCE-LIMITS.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  42
* EL6318.cbl
  2311         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2312         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2313
  2314     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2315         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2316
  2317     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2318         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2319         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2320
  2321     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2322
  2323     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2324     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2325     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2326     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2327     12  AM-DCC-UEF-STATE                  PIC XX.
  2328     12  FILLER                            PIC XXX.
  2329     12  AM-REPORT-CODE-3                  PIC X(10).
  2330*    12  FILLER                            PIC X(22).
  2331
  2332     12  AM-RESERVE-DATE.
  2333         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2334         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2335         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2336
  2337     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2338     12  AM-NOTIFICATION-TYPES.
  2339         16  AM-NOTIF-OF-LETTERS           PIC X.
  2340         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2341         16  AM-NOTIF-OF-REPORTS           PIC X.
  2342         16  AM-NOTIF-OF-STATUS            PIC X.
  2343
  2344     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2345         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2346         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2347         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2348         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2349
  2350     12  AM-BENEFIT-CONTROLS.
  2351         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2352             20  AM-BENEFIT-CODE           PIC XX.
  2353             20  AM-BENEFIT-TYPE           PIC X.
  2354             20  AM-BENEFIT-REVISION       PIC XXX.
  2355             20  AM-BENEFIT-REM-TERM       PIC X.
  2356             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2357             20  FILLER                    PIC XX.
  2358         16  FILLER                        PIC X(80).
  2359
  2360     12  AM-TRANSFER-DATA.
  2361         16  AM-TRANSFERRED-FROM.
  2362             20  AM-TRNFROM-CARRIER        PIC X.
  2363             20  AM-TRNFROM-GROUPING.
  2364                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2365                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2366             20  AM-TRNFROM-STATE          PIC XX.
  2367             20  AM-TRNFROM-ACCOUNT.
  2368                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  43
* EL6318.cbl
  2369                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2370             20  AM-TRNFROM-DTE            PIC XX.
  2371         16  AM-TRANSFERRED-TO.
  2372             20  AM-TRNTO-CARRIER          PIC X.
  2373             20  AM-TRNTO-GROUPING.
  2374                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2375                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2376             20  AM-TRNTO-STATE            PIC XX.
  2377             20  AM-TRNTO-ACCOUNT.
  2378                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2379                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2380             20  AM-TRNTO-DTE              PIC XX.
  2381         16  FILLER                        PIC X(10).
  2382
  2383     12  AM-SAVED-REMIT-TO                 PIC 99.
  2384
  2385     12  AM-COMM-STRUCTURE-SAVED.
  2386         16  AM-DEFN-1-SAVED.
  2387             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2388                 24  AM-AGT-SV             PIC X(10).
  2389                 24  AM-COM-TYP-SV         PIC X.
  2390                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2391                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2392                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2393                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2394                 24  FILLER                PIC X.
  2395                 24  AM-GL-CODES-SV        PIC X.
  2396                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2397                 24  FILLER                PIC X.
  2398         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2399             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2400                 24  FILLER                PIC X(11).
  2401                 24  AM-L-COMA-SV          PIC XXX.
  2402                 24  AM-J-COMA-SV          PIC XXX.
  2403                 24  AM-A-COMA-SV          PIC XXX.
  2404                 24  FILLER                PIC X(6).
  2405
  2406     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2407         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2408            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2409            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2410            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2411
  2412     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2413     12  FILLER                            PIC X(120).
  2414
  2415     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2416         16  AM-CONTROL-NAME               PIC X(30).
  2417         16  AM-EXECUTIVE-ONE.
  2418             20  AM-EXEC1-NAME             PIC X(15).
  2419             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2420                                                          COMP-3.
  2421             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2422                                                          COMP-3.
  2423         16  AM-EXECUTIVE-TWO.
  2424             20  AM-EXEC2-NAME             PIC X(15).
  2425             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2426                                                          COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  44
* EL6318.cbl
  2427             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2428                                                          COMP-3.
  2429
  2430     12  AM-RETRO-ADDITIONAL-DATA.
  2431         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2432         16  AM-RETRO-PREM-P-E             PIC X.
  2433         16  AM-RETRO-CLMS-P-I             PIC X.
  2434         16  AM-RETRO-RET-BRACKET-LF.
  2435             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2436                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2437                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2438             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2439                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2440                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2441             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2442                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2443                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2444         16  AM-RETRO-RET-BRACKET-AH.
  2445             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2446                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2447                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2448                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2449             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2450                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2451                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2452             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2453                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2454                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2455
  2456     12  AM-COMMENTS.
  2457         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2458
  2459     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2460         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2461         16  AM-FLI-BILLING-CODE           PIC X.
  2462         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2463         16  AM-FLI-UNITED-IDENT           PIC X.
  2464         16  AM-FLI-INTEREST-LOST-DATA.
  2465             20  AM-FLI-BANK-NO            PIC X(5).
  2466             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2467             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2468             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2469         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2470             20  AM-FLI-AGT                PIC X(9).
  2471             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2472             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2473         16  FILLER                        PIC X(102).
  2474
  2475     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2476         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2477             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2478             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2479             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2480             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2481             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2482         16  FILLER                          PIC X(10).
  2483******************************************************************
  2484*                                COPY ELCCNTL.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  45
* EL6318.cbl
  2485******************************************************************
  2486*                                                                *
  2487*                                                                *
  2488*                            ELCCNTL.                            *
  2489*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2490*                            VMOD=2.059                          *
  2491*                                                                *
  2492*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2493*                                                                *
  2494*   FILE TYPE = VSAM,KSDS                                        *
  2495*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2496*                                                                *
  2497*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2498*       ALTERNATE INDEX = NONE                                   *
  2499*                                                                *
  2500*   LOG = YES                                                    *
  2501*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2502******************************************************************
  2503*                   C H A N G E   L O G
  2504*
  2505* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2506*-----------------------------------------------------------------
  2507*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2508* EFFECTIVE    NUMBER
  2509*-----------------------------------------------------------------
  2510* 082503                   PEMA  ADD BENEFIT GROUP
  2511* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2512* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2513* 092705    2005050300006  PEMA  ADD SPP LEASES
  2514* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2515* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2516* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2517* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2518* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2519* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2520* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2521* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2522* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2523* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2524* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2525******************************************************************
  2526*
  2527 01  CONTROL-FILE.
  2528     12  CF-RECORD-ID                       PIC XX.
  2529         88  VALID-CF-ID                        VALUE 'CF'.
  2530
  2531     12  CF-CONTROL-PRIMARY.
  2532         16  CF-COMPANY-ID                  PIC XXX.
  2533         16  CF-RECORD-TYPE                 PIC X.
  2534             88  CF-COMPANY-MASTER              VALUE '1'.
  2535             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2536             88  CF-STATE-MASTER                VALUE '3'.
  2537             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2538             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2539             88  CF-CARRIER-MASTER              VALUE '6'.
  2540             88  CF-MORTALITY-MASTER            VALUE '7'.
  2541             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2542             88  CF-TERMINAL-MASTER             VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  46
* EL6318.cbl
  2543             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2544             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2545             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2546             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2547             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2548             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2549             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2550             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2551             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2552         16  CF-ACCESS-CD-GENL              PIC X(4).
  2553         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2554             20  CF-PROCESSOR               PIC X(4).
  2555         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2556             20  CF-STATE-CODE              PIC XX.
  2557             20  FILLER                     PIC XX.
  2558         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2559             20  FILLER                     PIC XX.
  2560             20  CF-HI-BEN-IN-REC           PIC XX.
  2561         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2562             20  FILLER                     PIC XXX.
  2563             20  CF-CARRIER-CNTL            PIC X.
  2564         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2565             20  FILLER                     PIC XX.
  2566             20  CF-HI-TYPE-IN-REC          PIC 99.
  2567         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2568             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2569                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2570             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2571             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2572         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2573             20  FILLER                     PIC X.
  2574             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2575         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2576             20  FILLER                     PIC XX.
  2577             20  CF-MORTGAGE-PLAN           PIC XX.
  2578         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2579
  2580     12  CF-LAST-MAINT-DT                   PIC XX.
  2581     12  CF-LAST-MAINT-BY                   PIC X(4).
  2582     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2583
  2584     12  CF-RECORD-BODY                     PIC X(728).
  2585
  2586
  2587****************************************************************
  2588*             COMPANY MASTER RECORD                            *
  2589****************************************************************
  2590
  2591     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2592         16  CF-COMPANY-ADDRESS.
  2593             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2594             20  CF-CL-IN-CARE-OF           PIC X(30).
  2595             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2596             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2597             20  CF-CL-CITY-STATE           PIC X(30).
  2598             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2599             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2600         16  CF-COMPANY-CD                  PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  47
* EL6318.cbl
  2601         16  CF-COMPANY-PASSWORD            PIC X(8).
  2602         16  CF-SECURITY-OPTION             PIC X.
  2603             88  ALL-SECURITY                   VALUE '1'.
  2604             88  COMPANY-VERIFY                 VALUE '2'.
  2605             88  PROCESSOR-VERIFY               VALUE '3'.
  2606             88  NO-SECURITY                    VALUE '4'.
  2607             88  ALL-BUT-TERM                   VALUE '5'.
  2608         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2609             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2610         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2611             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2612         16  CF-INFORCE-LOCATION            PIC X.
  2613             88  CERTS-ARE-ONLINE               VALUE '1'.
  2614             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2615             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2616         16  CF-LOWER-CASE-LETTERS          PIC X.
  2617         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2618             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2619             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2620             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2621             88  CF-ACCNT-CNTL                  VALUE '3'.
  2622             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2623
  2624         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2625         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2626
  2627         16  CF-LGX-CREDIT-USER             PIC X.
  2628             88  CO-IS-NOT-USER                 VALUE 'N'.
  2629             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2630
  2631         16 CF-CREDIT-CALC-CODES.
  2632             20  CF-CR-REM-TERM-CALC PIC X.
  2633               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2634               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2635               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2636               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2637               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2638               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2639               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2640             20  CF-CR-R78-METHOD           PIC X.
  2641               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2642               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2643
  2644         16  CF-CLAIM-CONTROL-COUNTS.
  2645             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2646                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2647
  2648             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2649                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2650
  2651             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2652                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2653
  2654             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2655                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2656
  2657         16  CF-CURRENT-MONTH-END           PIC XX.
  2658
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  48
* EL6318.cbl
  2659         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2660             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2661             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2662             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2663             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2664                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2665                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2666             20  CF-CO-PREM-REJECT-SW       PIC X.
  2667                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2668                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2669             20  CF-CO-REF-REJECT-SW        PIC X.
  2670                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2671                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2672
  2673         16  CF-CO-REPORTING-DT             PIC XX.
  2674         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2675         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2676           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2677           88  CF-CO-MONTH-END                  VALUE '1'.
  2678
  2679         16  CF-LGX-CLAIM-USER              PIC X.
  2680             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2681             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2682
  2683         16  CF-CREDIT-EDIT-CONTROLS.
  2684             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2685             20  CF-MIN-AGE                 PIC 99.
  2686             20  CF-DEFAULT-AGE             PIC 99.
  2687             20  CF-MIN-TERM                PIC S999      COMP-3.
  2688             20  CF-MAX-TERM                PIC S999      COMP-3.
  2689             20  CF-DEFAULT-SEX             PIC X.
  2690             20  CF-JOINT-AGE-INPUT         PIC X.
  2691                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2692             20  CF-BIRTH-DATE-INPUT        PIC X.
  2693                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2694             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2695                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2696                 88  CF-ZERO-CARRIER            VALUE '1'.
  2697                 88  CF-ZERO-GROUPING           VALUE '2'.
  2698                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2699             20  CF-EDIT-SW                 PIC X.
  2700                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2701             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2702             20  CF-CR-PR-METHOD            PIC X.
  2703               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2704               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2705             20  FILLER                     PIC X.
  2706
  2707         16  CF-CREDIT-MISC-CONTROLS.
  2708             20  CF-REIN-TABLE-SW           PIC X.
  2709                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2710             20  CF-COMP-TABLE-SW           PIC X.
  2711                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2712             20  CF-EXPERIENCE-RETENTION-AGE
  2713                                            PIC S9        COMP-3.
  2714             20  CF-CONVERSION-DT           PIC XX.
  2715             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2716             20  CF-RUN-FREQUENCY-SW        PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  49
* EL6318.cbl
  2717                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2718                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2719
  2720             20  CF-CR-CHECK-NO-CONTROL.
  2721                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2722                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2723                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2724                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2725                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2726                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2727
  2728                 24  CF-CR-CHECK-COUNT       REDEFINES
  2729                     CF-CR-CHECK-COUNTER      PIC X(4).
  2730
  2731                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2732                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2733
  2734                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2735                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2736                 24  CF-MAIL-PROCESSING       PIC X.
  2737                     88  MAIL-PROCESSING          VALUE 'Y'.
  2738
  2739         16  CF-MISC-SYSTEM-CONTROL.
  2740             20  CF-SYSTEM-C                 PIC X.
  2741                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2742             20  CF-SYSTEM-D                 PIC X.
  2743                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2744             20  CF-SOC-SEC-NO-SW            PIC X.
  2745                 88  SOC-SEC-NO-USED             VALUE '1'.
  2746             20  CF-MEMBER-NO-SW             PIC X.
  2747                 88  MEMBER-NO-USED              VALUE '1'.
  2748             20  CF-TAX-ID-NUMBER            PIC X(11).
  2749             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2750             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2751                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2752                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2753                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2754                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2755             20  CF-SYSTEM-E                 PIC X.
  2756                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2757
  2758         16  CF-LGX-LIFE-USER               PIC X.
  2759             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2760             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2761
  2762         16  CF-CR-MONTH-END-DT             PIC XX.
  2763
  2764         16  CF-FILE-MAINT-DATES.
  2765             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2766                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2767             20  CF-LAST-BATCH       REDEFINES
  2768                 CF-LAST-BATCH-NO               PIC X(4).
  2769             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2770             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2771             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2772             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2773             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2774             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  50
* EL6318.cbl
  2775             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2776             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2777             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2778             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2779
  2780         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2781         16  FILLER                         PIC X.
  2782
  2783         16  CF-ALT-MORT-CODE               PIC X(4).
  2784         16  CF-MEMBER-CAPTION              PIC X(10).
  2785
  2786         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2787             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2788             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2789             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2790             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2791             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2792
  2793         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2794
  2795         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2796         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2797         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2798         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2799
  2800         16  CF-AH-OVERRIDE-L1              PIC X.
  2801         16  CF-AH-OVERRIDE-L2              PIC XX.
  2802         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2803         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2804
  2805         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2806         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2807
  2808         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2809         16  CF-AR-LAST-EL860-DT            PIC XX.
  2810         16  CF-MP-MONTH-END-DT             PIC XX.
  2811
  2812         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2813         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2814             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2815
  2816         16  CF-AR-MONTH-END-DT             PIC XX.
  2817
  2818         16  CF-CRDTCRD-USER                PIC X.
  2819             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2820             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2821
  2822         16  CF-CC-MONTH-END-DT             PIC XX.
  2823
  2824         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2825
  2826         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2827             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2828             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2829             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2830         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2831         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2832         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  51
* EL6318.cbl
  2833         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2834             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2835             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2836         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2837         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2838         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2839             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2840         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2841
  2842         16  CF-CL-ZIP-CODE.
  2843             20  CF-CL-ZIP-PRIME.
  2844                 24  CF-CL-ZIP-1ST          PIC X.
  2845                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2846                 24  FILLER                 PIC X(4).
  2847             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2848         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2849             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2850             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2851             20  FILLER                     PIC XXX.
  2852
  2853         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2854         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2855         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2856         16  CF-CO-OPTION-START-DATE        PIC XX.
  2857         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2858           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2859                                                      '3' '4'.
  2860           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2861           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2862           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2863           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2864           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2865           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2866
  2867         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2868
  2869         16  CF-PAYMENT-APPROVAL-LEVELS.
  2870             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2871             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2872             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2873             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2874             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2875             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2876
  2877         16  CF-END-USER-REPORTING-USER     PIC X.
  2878             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2879             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2880
  2881         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2882             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2883             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2884
  2885         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2886
  2887         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2888         16  FILLER                         PIC X.
  2889
  2890         16  CF-CREDIT-ARCHIVE-CNTL.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  52
* EL6318.cbl
  2891             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2892             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2893             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2894
  2895         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2896
  2897         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2898             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2899             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2900
  2901         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2902             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2903             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2904
  2905         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2906
  2907         16  CF-CO-ACH-ID-CODE              PIC  X.
  2908             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2909             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2910             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2911         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2912         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2913         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2914         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2915         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2916         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2917         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2918         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2919         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2920                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2921         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2922                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2923
  2924         16  CF-CO-OVER-SHORT.
  2925             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2926             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2927
  2928*         16  FILLER                         PIC X(102).
  2929         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2930             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2931             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2932
  2933         16  CF-AH-APPROVAL-DAYS.
  2934             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2935             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2936             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2937             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2938
  2939         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2940
  2941         16  CF-APPROV-LEV-5.
  2942             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2943             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2944             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2945
  2946         16  FILLER                         PIC X(68).
  2947****************************************************************
  2948*             PROCESSOR/USER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  53
* EL6318.cbl
  2949****************************************************************
  2950
  2951     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2952         16  CF-PROCESSOR-NAME              PIC X(30).
  2953         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2954         16  CF-PROCESSOR-TITLE             PIC X(26).
  2955         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2956                 88  MESSAGE-YES                VALUE 'Y'.
  2957                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2958
  2959*****************************************************
  2960****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2961****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2962****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2963****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2964*****************************************************
  2965
  2966         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2967             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2968             20  CF-APPLICATION-FORCE       PIC X.
  2969             20  CF-INDIVIDUAL-APP.
  2970                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2971                     28  CF-BROWSE-APP      PIC X.
  2972                     28  CF-UPDATE-APP      PIC X.
  2973
  2974         16  CF-CURRENT-TERM-ON             PIC X(4).
  2975         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2976             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2977             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2978             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2979             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2980             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2981             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2982             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2983         16  CF-PROCESSOR-CARRIER           PIC X.
  2984             88  NO-CARRIER-SECURITY            VALUE ' '.
  2985         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2986             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2987         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2988             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2989         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2990             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2991
  2992         16  CF-PROC-SYS-ACCESS-SW.
  2993             20  CF-PROC-CREDIT-CLAIMS-SW.
  2994                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2995                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2996                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2997                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2998             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2999                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3000                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3001             20  CF-PROC-LIFE-GNRLDGR-SW.
  3002                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3003                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3004                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3005                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3006             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  54
* EL6318.cbl
  3007                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3008                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3009         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3010             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3011             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3012         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3013
  3014         16  CF-APPROVAL-LEVEL                  PIC X.
  3015             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3016             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3017             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3018             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3019             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3020
  3021         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3022
  3023         16  CF-LANGUAGE-TYPE                   PIC X.
  3024             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3025             88  CF-LANG-IS-FR                      VALUE 'F'.
  3026
  3027         16  CF-CSR-IND                         PIC X.
  3028         16  FILLER                             PIC X(239).
  3029
  3030****************************************************************
  3031*             PROCESSOR/REMINDERS RECORD                       *
  3032****************************************************************
  3033
  3034     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3035         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3036             20  CF-START-REMIND-DT         PIC XX.
  3037             20  CF-END-REMIND-DT           PIC XX.
  3038             20  CF-REMINDER-TEXT           PIC X(50).
  3039         16  FILLER                         PIC X(296).
  3040
  3041
  3042****************************************************************
  3043*             STATE MASTER RECORD                              *
  3044****************************************************************
  3045
  3046     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3047         16  CF-STATE-ABBREVIATION          PIC XX.
  3048         16  CF-STATE-NAME                  PIC X(25).
  3049         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3050         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3051             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3052             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3053             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3054             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3055                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3056                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3057             20  CF-ST-PREM-REJECT-SW       PIC X.
  3058                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3059                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3060             20  CF-ST-REF-REJECT-SW        PIC X.
  3061                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3062                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3063         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3064         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  55
* EL6318.cbl
  3065         16  CF-ST-REFUND-RULES.
  3066             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3067             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3068             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3069         16  CF-ST-FST-PMT-EXTENSION.
  3070             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3071             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3072                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3073                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3074                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3075                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3076         16  CF-ST-STATE-CALL.
  3077             20  CF-ST-CALL-UNEARNED        PIC X.
  3078             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3079             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3080         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3081             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3082             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3083         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3084         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3085         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3086         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3087         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3088         16  FILLER                         PIC X.
  3089         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3090             20  CF-ST-BENEFIT-CD           PIC XX.
  3091             20  CF-ST-BENEFIT-KIND         PIC X.
  3092                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3093                 88  CF-ST-AH-KIND              VALUE 'A'.
  3094             20  CF-ST-REM-TERM-CALC        PIC X.
  3095                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3096                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3097                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3098                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3099                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3100                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3101                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3102                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3103
  3104             20  CF-ST-REFUND-CALC          PIC X.
  3105                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3106                 88  ST-REFD-BY-R78             VALUE '1'.
  3107                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3108                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3109                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3110                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3111                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3112                 88  ST-REFD-UTAH               VALUE '7'.
  3113                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3114                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3115                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3116
  3117             20  CF-ST-EARNING-CALC         PIC X.
  3118                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3119                 88  ST-EARN-BY-R78             VALUE '1'.
  3120                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3121                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3122                 88  ST-EARN-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  56
* EL6318.cbl
  3123                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3124                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3125                 88  ST-EARN-MEAN               VALUE '8'.
  3126                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3127
  3128             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3129                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3130                 88  ST-OVRD-BY-R78             VALUE '1'.
  3131                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3132                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3133                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3134                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3135                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3136                 88  ST-OVRD-MEAN               VALUE '8'.
  3137                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3138             20  cf-st-extra-periods        pic 9.
  3139*            20  FILLER                     PIC X.
  3140
  3141         16  CF-ST-COMMISSION-CAPS.
  3142             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3143             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3144             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3145             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3146         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3147                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3148                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  3149                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  3150
  3151         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3152
  3153         16  CF-ST-STATUTORY-INTEREST.
  3154             20  CF-ST-STAT-DATE-FROM       PIC X.
  3155                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3156                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3157             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3158             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3159             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3160             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3161             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3162
  3163         16  CF-ST-OVER-SHORT.
  3164             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3165             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3166
  3167         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3168
  3169         16  CF-ST-RT-CALC                  PIC X.
  3170
  3171         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3172         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3173         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3174         16  CF-ST-RF-LR-CALC               PIC X.
  3175         16  CF-ST-RF-LL-CALC               PIC X.
  3176         16  CF-ST-RF-LN-CALC               PIC X.
  3177         16  CF-ST-RF-AH-CALC               PIC X.
  3178         16  CF-ST-RF-CP-CALC               PIC X.
  3179*        16  FILLER                         PIC X(206).
  3180*CIDMOD         16  FILLER                         PIC X(192).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  57
* EL6318.cbl
  3181         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3182             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3183         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3184         16  CF-ST-VFY-2ND-BENE             PIC X.
  3185         16  CF-ST-CAUSAL-STATE             PIC X.
  3186         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3187         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3188         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3189             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3190         16  CF-ST-NET-ONLY-STATE           PIC X.
  3191             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3192         16  cf-commission-cap-required     pic x.
  3193         16  CF-ST-GA-COMMISSION-CAPS.
  3194             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  3195             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  3196             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  3197             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  3198         16  CF-ST-TOT-COMMISSION-CAPS.
  3199             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  3200             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  3201             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  3202             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  3203         16  FILLER                         PIC X(156).
  3204
  3205****************************************************************
  3206*             BENEFIT MASTER RECORD                            *
  3207****************************************************************
  3208
  3209     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3210         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3211             20  CF-BENEFIT-CODE            PIC XX.
  3212             20  CF-BENEFIT-NUMERIC  REDEFINES
  3213                 CF-BENEFIT-CODE            PIC XX.
  3214             20  CF-BENEFIT-ALPHA           PIC XXX.
  3215             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3216             20  CF-BENEFIT-COMMENT         PIC X(10).
  3217
  3218             20  CF-LF-COVERAGE-TYPE        PIC X.
  3219                 88  CF-REDUCING                VALUE 'R'.
  3220                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3221
  3222             20  CF-SPECIAL-CALC-CD         PIC X.
  3223                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3224                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3225                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3226                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3227                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3228                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3229                 88  CF-FARM-PLAN               VALUE 'F'.
  3230                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3231                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3232                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3233                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3234                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3235                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3236                 88  CF-PRUDENTIAL              VALUE 'P'.
  3237                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3238                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  58
* EL6318.cbl
  3239                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3240                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3241                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3242                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3243
  3244             20  CF-JOINT-INDICATOR         PIC X.
  3245                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3246
  3247*            20  FILLER                     PIC X(12).
  3248             20  cf-maximum-benefits        pic s999 comp-3.
  3249             20  FILLER                     PIC X(09).
  3250             20  CF-BENEFIT-CATEGORY        PIC X.
  3251             20  CF-LOAN-TYPE               PIC X(8).
  3252
  3253             20  CF-CO-REM-TERM-CALC        PIC X.
  3254                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3255                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3256                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3257                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3258                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3259
  3260             20  CF-CO-EARNINGS-CALC        PIC X.
  3261                 88  CO-EARN-BY-R78             VALUE '1'.
  3262                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3263                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3264                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3265                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3266                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3267                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3268                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3269
  3270             20  CF-CO-REFUND-CALC          PIC X.
  3271                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3272                 88  CO-REFD-BY-R78             VALUE '1'.
  3273                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3274                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3275                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3276                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3277                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3278                 88  CO-REFD-MEAN               VALUE '8'.
  3279                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3280                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3281                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3282
  3283             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3284                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3285                 88  CO-OVRD-BY-R78             VALUE '1'.
  3286                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3287                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3288                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3289                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3290                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3291                 88  CO-OVRD-MEAN               VALUE '8'.
  3292                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3293
  3294             20  CF-CO-BEN-I-G-CD           PIC X.
  3295                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3296                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  59
* EL6318.cbl
  3297                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3298
  3299         16  FILLER                         PIC X(304).
  3300
  3301
  3302****************************************************************
  3303*             CARRIER MASTER RECORD                            *
  3304****************************************************************
  3305
  3306     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3307         16  CF-ADDRESS-DATA.
  3308             20  CF-MAIL-TO-NAME            PIC X(30).
  3309             20  CF-IN-CARE-OF              PIC X(30).
  3310             20  CF-ADDRESS-LINE-1          PIC X(30).
  3311             20  CF-ADDRESS-LINE-2          PIC X(30).
  3312             20  CF-CITY-STATE              PIC X(30).
  3313             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3314             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3315
  3316         16  CF-CLAIM-NO-CONTROL.
  3317             20  CF-CLAIM-NO-METHOD         PIC X.
  3318                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3319                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3320                 88  CLAIM-NO-SEQ               VALUE '3'.
  3321                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3322             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3323                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3324                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3325                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3326
  3327         16  CF-CHECK-NO-CONTROL.
  3328             20  CF-CHECK-NO-METHOD         PIC X.
  3329                 88  CHECK-NO-MANUAL            VALUE '1'.
  3330                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3331                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3332                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3333             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3334                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3335
  3336         16  CF-DOMICILE-STATE              PIC XX.
  3337
  3338         16  CF-EXPENSE-CONTROLS.
  3339             20  CF-EXPENSE-METHOD          PIC X.
  3340                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3341                 88  DOLLARS-PER-PMT            VALUE '2'.
  3342                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3343                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3344             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3345             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3346
  3347         16  CF-CORRESPONDENCE-CONTROL.
  3348             20  CF-LETTER-RESEND-OPT       PIC X.
  3349                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3350                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3351             20  FILLER                     PIC X(4).
  3352
  3353         16  CF-RESERVE-CONTROLS.
  3354             20  CF-MANUAL-SW               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  60
* EL6318.cbl
  3355                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3356             20  CF-FUTURE-SW               PIC X.
  3357                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3358             20  CF-PTC-SW                  PIC X.
  3359                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3360             20  CF-IBNR-SW                 PIC X.
  3361                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3362             20  CF-PTC-LF-SW               PIC X.
  3363                 88  CF-LF-PTC-USED             VALUE '1'.
  3364             20  CF-CDT-ACCESS-METHOD       PIC X.
  3365                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3366                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3367                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3368             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3369
  3370         16  CF-CLAIM-CALC-METHOD           PIC X.
  3371             88  360-PLUS-MONTHS                VALUE '1'.
  3372             88  365-PLUS-MONTHS                VALUE '2'.
  3373             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3374             88  360-DAILY                      VALUE '4'.
  3375             88  365-DAILY                      VALUE '5'.
  3376
  3377         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3378         16  FILLER                         PIC X(11).
  3379
  3380         16  CF-LIMIT-AMOUNTS.
  3381             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3382             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3383             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3384             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3385             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3386             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3387             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3388             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3389             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3390             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3391
  3392         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3393         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3394         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3395
  3396         16  CF-ZIP-CODE.
  3397             20  CF-ZIP-PRIME.
  3398                 24  CF-ZIP-1ST             PIC X.
  3399                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3400                 24  FILLER                 PIC X(4).
  3401             20  CF-ZIP-PLUS4               PIC X(4).
  3402         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3403             20  CF-CAN-POSTAL-1            PIC XXX.
  3404             20  CF-CAN-POSTAL-2            PIC XXX.
  3405             20  FILLER                     PIC XXX.
  3406
  3407         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3408         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3409         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3410
  3411         16  CF-RATING-SWITCH               PIC X.
  3412             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  61
* EL6318.cbl
  3413             88  CF-NO-RATING                   VALUE 'N'.
  3414
  3415         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3416
  3417         16  CF-CARRIER-OVER-SHORT.
  3418             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3419             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3420
  3421         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3422         16  CF-SECPAY-SWITCH               PIC X.
  3423             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3424             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3425         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3426         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3427         16  FILLER                         PIC X(444).
  3428*        16  FILLER                         PIC X(452).
  3429
  3430
  3431****************************************************************
  3432*             MORTALITY MASTER RECORD                          *
  3433****************************************************************
  3434
  3435     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3436         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3437                                INDEXED BY CF-MORT-NDX.
  3438             20  CF-MORT-TABLE              PIC X(5).
  3439             20  CF-MORT-TABLE-TYPE         PIC X.
  3440                 88  CF-MORT-JOINT              VALUE 'J'.
  3441                 88  CF-MORT-SINGLE             VALUE 'S'.
  3442                 88  CF-MORT-COMBINED           VALUE 'C'.
  3443                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3444                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3445             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3446             20  CF-MORT-AGE-METHOD         PIC XX.
  3447                 88  CF-AGE-LAST                VALUE 'AL'.
  3448                 88  CF-AGE-NEAR                VALUE 'AN'.
  3449             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3450             20  CF-MORT-ADJUSTMENT-DIRECTION
  3451                                            PIC X.
  3452                 88  CF-MINUS                   VALUE '-'.
  3453                 88  CF-PLUS                    VALUE '+'.
  3454             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3455             20  CF-MORT-JOINT-CODE         PIC X.
  3456                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3457             20  CF-MORT-PC-Q               PIC X.
  3458                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3459             20  CF-MORT-TABLE-CODE         PIC X(4).
  3460             20  CF-MORT-COMMENTS           PIC X(15).
  3461             20  FILLER                     PIC X(14).
  3462
  3463         16  FILLER                         PIC X(251).
  3464
  3465
  3466****************************************************************
  3467*             BUSSINESS TYPE MASTER RECORD                     *
  3468****************************************************************
  3469
  3470     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  62
* EL6318.cbl
  3471* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3472* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3473* AND RECORD 05 IS TYPES 81-99
  3474         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3475             20  CF-BUSINESS-TITLE          PIC  X(19).
  3476             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3477                                            PIC S9V9(4) COMP-3.
  3478             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3479             20  FILLER                     PIC  X.
  3480         16  FILLER                         PIC  X(248).
  3481
  3482
  3483****************************************************************
  3484*             TERMINAL MASTER RECORD                           *
  3485****************************************************************
  3486
  3487     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3488
  3489         16  CF-COMPANY-TERMINALS.
  3490             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3491                                  PIC X(4).
  3492         16  FILLER               PIC X(248).
  3493
  3494
  3495****************************************************************
  3496*             LIFE EDIT MASTER RECORD                          *
  3497****************************************************************
  3498
  3499     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3500         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3501             20  CF-LIFE-CODE-IN            PIC XX.
  3502             20  CF-LIFE-CODE-OUT           PIC XX.
  3503         16  FILLER                         PIC X(248).
  3504
  3505
  3506****************************************************************
  3507*             AH EDIT MASTER RECORD                            *
  3508****************************************************************
  3509
  3510     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3511         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3512             20  CF-AH-CODE-IN              PIC XXX.
  3513             20  CF-AH-CODE-OUT             PIC XX.
  3514         16  FILLER                         PIC X(248).
  3515
  3516
  3517****************************************************************
  3518*             CREDIBILITY TABLES                               *
  3519****************************************************************
  3520
  3521     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3522         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3523                             INDEXED BY CF-CRDB-NDX.
  3524             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3525             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3526             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3527         16  FILLER                         PIC  X(332).
  3528
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  63
* EL6318.cbl
  3529
  3530****************************************************************
  3531*             REPORT CUSTOMIZATION RECORD                      *
  3532****************************************************************
  3533
  3534     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3535         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3536             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3537             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3538             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3539**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3540****       A T-TRANSFER.                                   ****
  3541             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3542
  3543         16  FILLER                         PIC XX.
  3544
  3545         16  CF-CARRIER-CNTL-OPT.
  3546             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3547                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3548                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3549             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3550                                            PIC X.
  3551         16  CF-GROUP-CNTL-OPT.
  3552             20  CF-GROUP-OPT-SEQ           PIC 9.
  3553                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3554                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3555             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3556                                            PIC X(6).
  3557         16  CF-STATE-CNTL-OPT.
  3558             20  CF-STATE-OPT-SEQ           PIC 9.
  3559                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3560                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3561             20  CF-STATE-SELECT OCCURS 3 TIMES
  3562                                            PIC XX.
  3563         16  CF-ACCOUNT-CNTL-OPT.
  3564             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3565                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3566                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3567             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3568                                            PIC X(10).
  3569         16  CF-BUS-TYP-CNTL-OPT.
  3570             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3571                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3572                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3573             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3574                                            PIC XX.
  3575         16  CF-LF-TYP-CNTL-OPT.
  3576             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3577                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3578                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3579             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3580                                            PIC XX.
  3581         16  CF-AH-TYP-CNTL-OPT.
  3582             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3583                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3584                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3585             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3586                                            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  64
* EL6318.cbl
  3587         16  CF-REPTCD1-CNTL-OPT.
  3588             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3589                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3590                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3591             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3592                                            PIC X(10).
  3593         16  CF-REPTCD2-CNTL-OPT.
  3594             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3595                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3596                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3597             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3598                                            PIC X(10).
  3599         16  CF-USER1-CNTL-OPT.
  3600             20  CF-USER1-OPT-SEQ           PIC 9.
  3601                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3602                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3603             20  CF-USER1-SELECT OCCURS 3 TIMES
  3604                                            PIC X(10).
  3605         16  CF-USER2-CNTL-OPT.
  3606             20  CF-USER2-OPT-SEQ           PIC 9.
  3607                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3608                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3609             20  CF-USER2-SELECT OCCURS 3 TIMES
  3610                                            PIC X(10).
  3611         16  CF-USER3-CNTL-OPT.
  3612             20  CF-USER3-OPT-SEQ           PIC 9.
  3613                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3614                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3615             20  CF-USER3-SELECT OCCURS 3 TIMES
  3616                                            PIC X(10).
  3617         16  CF-USER4-CNTL-OPT.
  3618             20  CF-USER4-OPT-SEQ           PIC 9.
  3619                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3620                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3621             20  CF-USER4-SELECT OCCURS 3 TIMES
  3622                                            PIC X(10).
  3623         16  CF-USER5-CNTL-OPT.
  3624             20  CF-USER5-OPT-SEQ           PIC 9.
  3625                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3626                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3627             20  CF-USER5-SELECT OCCURS 3 TIMES
  3628                                            PIC X(10).
  3629         16  CF-REINS-CNTL-OPT.
  3630             20  CF-REINS-OPT-SEQ           PIC 9.
  3631                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3632                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3633             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3634                 24  CF-REINS-PRIME         PIC XXX.
  3635                 24  CF-REINS-SUB           PIC XXX.
  3636
  3637         16  CF-AGENT-CNTL-OPT.
  3638             20  CF-AGENT-OPT-SEQ           PIC 9.
  3639                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3640                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3641             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3642                                            PIC X(10).
  3643
  3644         16  FILLER                         PIC X(43).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  65
* EL6318.cbl
  3645
  3646         16  CF-LOSS-RATIO-SELECT.
  3647             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3648             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3649         16  CF-ENTRY-DATE-SELECT.
  3650             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3651             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3652         16  CF-EFFECTIVE-DATE-SELECT.
  3653             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3654             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3655
  3656         16  CF-EXCEPTION-LIST-IND          PIC X.
  3657             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3658
  3659         16  FILLER                         PIC X(318).
  3660
  3661****************************************************************
  3662*                  EXCEPTION REPORTING RECORD                  *
  3663****************************************************************
  3664
  3665     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3666         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3667             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3668
  3669         16  CF-COMBINED-LIFE-AH-OPT.
  3670             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3671             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3672             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3673             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3674
  3675         16  CF-LIFE-OPT.
  3676             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3677             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3678             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3679             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3680             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3681             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3682             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3683             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3684             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3685             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3686
  3687         16  CF-AH-OPT.
  3688             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3689             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3690             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3691             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3692             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3693             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3694             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3695             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3696             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3697             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3698
  3699         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3700             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3701             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3702             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  66
* EL6318.cbl
  3703
  3704         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3705
  3706         16  FILLER                         PIC X(673).
  3707
  3708
  3709****************************************************************
  3710*             MORTGAGE SYSTEM PLAN RECORD                      *
  3711****************************************************************
  3712
  3713     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3714         16  CF-PLAN-TYPE                   PIC X.
  3715             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3716             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3717             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3718         16  CF-PLAN-ABBREV                 PIC XXX.
  3719         16  CF-PLAN-DESCRIPT               PIC X(10).
  3720         16  CF-PLAN-NOTES                  PIC X(20).
  3721         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3722         16  CF-PLAN-UNDERWRITING.
  3723             20  CF-PLAN-TERM-DATA.
  3724                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3725                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3726             20  CF-PLAN-AGE-DATA.
  3727                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3728                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3729                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3730             20  CF-PLAN-BENEFIT-DATA.
  3731                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3732                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3733                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3734                                            PIC S9(7)V99  COMP-3.
  3735         16  CF-PLAN-POLICY-FORMS.
  3736             20  CF-POLICY-FORM             PIC X(12).
  3737             20  CF-MASTER-APPLICATION      PIC X(12).
  3738             20  CF-MASTER-POLICY           PIC X(12).
  3739         16  CF-PLAN-RATING.
  3740             20  CF-RATE-CODE               PIC X(5).
  3741             20  CF-SEX-RATING              PIC X.
  3742                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3743                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3744             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3745             20  CF-SUB-STD-TYPE            PIC X.
  3746                 88  CF-PCT-OF-PREM            VALUE '1'.
  3747                 88  CF-PCT-OF-BENE            VALUE '2'.
  3748         16  CF-PLAN-PREM-TOLERANCES.
  3749             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3750             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3751         16  CF-PLAN-PYMT-TOLERANCES.
  3752             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3753             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3754         16  CF-PLAN-MISC-DATA.
  3755             20  FILLER                     PIC X.
  3756             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3757             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3758         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3759         16  CF-PLAN-IND-GRP                PIC X.
  3760             88  CF-MORT-INDIV-PLAN            VALUE 'I'
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  67
* EL6318.cbl
  3761                                                     '1'.
  3762             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3763                                                     '2'.
  3764         16  CF-MIB-SEARCH-SW               PIC X.
  3765             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3766             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3767             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3768             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3769         16  CF-ALPHA-SEARCH-SW             PIC X.
  3770             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3771             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3772             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3773             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3774             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3775             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3776             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3777             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3778             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3779             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3780                                                     'A' 'B' 'C'
  3781                                                     'X' 'Y' 'Z'.
  3782         16  CF-EFF-DT-RULE-SW              PIC X.
  3783             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3784             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3785             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3786             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3787             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3788         16  FILLER                         PIC X(4).
  3789         16  CF-HEALTH-QUESTIONS            PIC X.
  3790             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3791         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3792         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3793         16  CF-PLAN-SNGL-JNT               PIC X.
  3794             88  CF-COMBINED-PLAN              VALUE 'C'.
  3795             88  CF-JNT-PLAN                   VALUE 'J'.
  3796             88  CF-SNGL-PLAN                  VALUE 'S'.
  3797         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3798         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3799         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3800         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3801         16  CF-RERATE-CNTL                 PIC  X.
  3802             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3803             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3804             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3805             88  CF-AUTO-RECALC                 VALUE '4'.
  3806         16  CF-BENEFIT-TYPE                PIC  X.
  3807             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3808             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3809         16  CF-POLICY-FEE                  PIC S999V99
  3810                                                    COMP-3.
  3811         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3812         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3813         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3814         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3815         16  FILLER                         PIC  X(32).
  3816         16  CF-TERMINATION-FORM            PIC  X(04).
  3817         16  FILLER                         PIC  X(08).
  3818         16  CF-CLAIM-CAP                   PIC S9(7)V99
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  68
* EL6318.cbl
  3819                                                       COMP-3.
  3820         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3821         16  CF-ISSUE-LETTER                PIC  X(4).
  3822         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3823         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3824             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3825             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3826         16  CF-MP-REFUND-CALC              PIC X.
  3827             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3828             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3829             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3830             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3831             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3832             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3833             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3834             88  CF-MP-REFD-MEAN                VALUE '8'.
  3835         16  CF-ALT-RATE-CODE               PIC  X(5).
  3836
  3837
  3838         16  FILLER                         PIC X(498).
  3839****************************************************************
  3840*             MORTGAGE COMPANY MASTER RECORD                   *
  3841****************************************************************
  3842
  3843     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3844         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3845         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3846             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3847             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3848             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3849             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3850             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3851
  3852         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3853         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3854         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3855         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3856         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3857
  3858         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3859             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3860         16  CF-MP-RECON-USE-IND            PIC X(1).
  3861             88  CF-MP-USE-RECON             VALUE 'Y'.
  3862         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3863             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3864         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3865             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3866             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3867         16  FILLER                         PIC X(1).
  3868         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3869             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3870         16  CF-MORTG-MIB-VERSION           PIC X.
  3871             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3872             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3873             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3874         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3875             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3876                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  69
* EL6318.cbl
  3877             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3878                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3879             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3880                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3881             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3882                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3883             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3884                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3885             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3886                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3887         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3888         16  FILLER                         PIC X(7).
  3889         16  CF-MORTG-DESTINATION-SYMBOL.
  3890             20  CF-MORTG-MIB-COMM          PIC X(5).
  3891             20  CF-MORTG-MIB-TERM          PIC X(5).
  3892         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3893             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3894         16  FILLER                         PIC X(03).
  3895         16  CF-MP-CHECK-NO-CONTROL.
  3896             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3897                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3898                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3899                                                ' ' LOW-VALUES.
  3900                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3901                                               VALUE '3'.
  3902         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3903         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3904         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3905             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3906                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3907             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3908                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3909             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3910                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3911             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3912                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3913             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3914                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3915             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3916                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3917         16  CF-MORTG-BILLING-AREA.
  3918             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3919                                            PIC X.
  3920         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3921         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3922         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3923         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3924             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3925             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3926         16  FILLER                         PIC X.
  3927         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3928             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3929             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3930         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3931         16  FILLER                         PIC X(8).
  3932         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3933         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3934         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  70
* EL6318.cbl
  3935         16  CF-ACH-COMPANY-ID.
  3936             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3937                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3938                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3939                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3940             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3941         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3942             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3943         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3944             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3945             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3946         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3947         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3948         16  FILLER                         PIC X(536).
  3949
  3950****************************************************************
  3951*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3952****************************************************************
  3953
  3954     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3955         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3956             20  CF-FEMALE-HEIGHT.
  3957                 24  CF-FEMALE-FT           PIC 99.
  3958                 24  CF-FEMALE-IN           PIC 99.
  3959             20  CF-FEMALE-MIN-WT           PIC 999.
  3960             20  CF-FEMALE-MAX-WT           PIC 999.
  3961         16  FILLER                         PIC X(428).
  3962
  3963     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3964         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3965             20  CF-MALE-HEIGHT.
  3966                 24  CF-MALE-FT             PIC 99.
  3967                 24  CF-MALE-IN             PIC 99.
  3968             20  CF-MALE-MIN-WT             PIC 999.
  3969             20  CF-MALE-MAX-WT             PIC 999.
  3970         16  FILLER                         PIC X(428).
  3971******************************************************************
  3972*             AUTOMATIC ACTIVITY RECORD                          *
  3973******************************************************************
  3974     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3975         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3976             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3977             20  CF-SYS-LETTER-ID           PIC X(04).
  3978             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3979             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3980             20  CF-SYS-RESET-SW            PIC X(01).
  3981             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3982             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3983
  3984         16  FILLER                         PIC X(50).
  3985
  3986         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3987             20  CF-USER-ACTIVE-SW          PIC X(01).
  3988             20  CF-USER-LETTER-ID          PIC X(04).
  3989             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3990             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3991             20  CF-USER-RESET-SW           PIC X(01).
  3992             20  CF-USER-REPORT-DAYS        PIC 9(03).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  71
* EL6318.cbl
  3993             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3994             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3995
  3996         16  FILLER                         PIC X(246).
  3997*                                COPY ERCPNDB.
  3998******************************************************************
  3999*                                                                *
  4000*                                                                *
  4001*                            ERCPNDB.                            *
  4002*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4003*                            VMOD=2.025                          *
  4004*                                                                *
  4005*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4006*                                                                *
  4007******************************************************************
  4008*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4009*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4010******************************************************************
  4011*                                                                *
  4012*                                                                *
  4013*   FILE TYPE = VSAM,KSDS                                        *
  4014*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4015*                                                                *
  4016*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4017*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4018*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4019*                                                 RKP=13,LEN=36  *
  4020*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4021*                                      AND CHG-SEQ.)             *
  4022*                                                RKP=49,LEN=11   *
  4023*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4024*                                      AND CHG-SEQ.)             *
  4025*                                                RKP=60,LEN=15   *
  4026*                                                                *
  4027*   LOG = NO                                                     *
  4028*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4029******************************************************************
  4030******************************************************************
  4031*                   C H A N G E   L O G
  4032*
  4033* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4034*-----------------------------------------------------------------
  4035*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4036* EFFECTIVE    NUMBER
  4037*-----------------------------------------------------------------
  4038* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4039* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4040* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4041* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4042* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4043* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4044* 032306                   PEMA  ADD BOW LOAN NUMBER
  4045* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4046* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4047* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4048* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4049* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4050* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  72
* EL6318.cbl
  4051* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4052* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4053* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4054* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4055* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4056* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4057* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  4058******************************************************************
  4059
  4060 01  PENDING-BUSINESS.
  4061     12  PB-RECORD-ID                     PIC XX.
  4062         88  VALID-PB-ID                        VALUE 'PB'.
  4063
  4064     12  PB-CONTROL-PRIMARY.
  4065         16  PB-COMPANY-CD                PIC X.
  4066         16  PB-ENTRY-BATCH               PIC X(6).
  4067         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4068         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4069
  4070     12  PB-CONTROL-BY-ACCOUNT.
  4071         16  PB-COMPANY-CD-A1             PIC X.
  4072         16  PB-CARRIER                   PIC X.
  4073         16  PB-GROUPING.
  4074             20  PB-GROUPING-PREFIX       PIC XXX.
  4075             20  PB-GROUPING-PRIME        PIC XXX.
  4076         16  PB-STATE                     PIC XX.
  4077         16  PB-ACCOUNT.
  4078             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4079             20  PB-ACCOUNT-PRIME         PIC X(6).
  4080         16  PB-CERT-EFF-DT               PIC XX.
  4081         16  PB-CERT-NO.
  4082             20  PB-CERT-PRIME            PIC X(10).
  4083             20  PB-CERT-SFX              PIC X.
  4084         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4085
  4086         16  PB-RECORD-TYPE               PIC X.
  4087             88  PB-MAILING-DATA                VALUE '0'.
  4088             88  PB-ISSUE                       VALUE '1'.
  4089             88  PB-CANCELLATION                VALUE '2'.
  4090             88  PB-BATCH-TRAILER               VALUE '9'.
  4091
  4092     12  PB-CONTROL-BY-ORIG-BATCH.
  4093         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4094         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4095         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4096         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4097
  4098     12  PB-CONTROL-BY-CSR.
  4099         16  PB-CSR-COMPANY-CD            PIC X.
  4100         16  PB-CSR-ID                    PIC X(4).
  4101         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4102         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4103         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4104******************************************************************
  4105*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4106******************************************************************
  4107
  4108     12  PB-LAST-MAINT-DT                 PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  73
* EL6318.cbl
  4109     12  PB-LAST-MAINT-BY                 PIC X(4).
  4110     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4111
  4112     12  PB-RECORD-BODY                   PIC X(375).
  4113
  4114     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4115         16  PB-CERT-ORIGIN               PIC X.
  4116             88  CLASIC-CREATED-CERT         VALUE '1'.
  4117         16  PB-I-NAME.
  4118             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4119             20  PB-I-INSURED-FIRST-NAME.
  4120                 24  PB-I-INSURED-1ST-INIT PIC X.
  4121                 24  FILLER                PIC X(9).
  4122             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4123         16  PB-I-AGE                     PIC S99   COMP-3.
  4124         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4125         16  PB-I-BIRTHDAY                PIC XX.
  4126         16  PB-I-INSURED-SEX             PIC X.
  4127             88  PB-SEX-MALE     VALUE 'M'.
  4128             88  PB-SEX-FEMALE   VALUE 'F'.
  4129
  4130         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4131         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4132         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4133         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4134         16  PB-I-SKIP-CODE               PIC X.
  4135             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4136             88  PB-SKIP-JULY              VALUE '1'.
  4137             88  PB-SKIP-AUGUST            VALUE '2'.
  4138             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4139             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4140             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4141             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4142             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4143             88  PB-SKIP-JUNE              VALUE '8'.
  4144             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4145             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4146             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4147         16  PB-I-TERM-TYPE               PIC X.
  4148             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4149             88  PB-PAID-WEEKLY            VALUE 'W'.
  4150             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4151             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4152             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4153         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4154         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4155         16  PB-I-DATA-ENTRY-SW           PIC X.
  4156             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4157             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4158             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4159             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4160         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4161         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4162*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4163         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4164         16  PB-I-LETTER-REQD             PIC X.
  4165
  4166         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  74
* EL6318.cbl
  4167             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4168             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4169                                                   '90' THRU '99'.
  4170         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4171                                          PIC XX.
  4172         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4173         16  PB-I-AMOUNT-FINANCED REDEFINES
  4174                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4175         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4176         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4177                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4178         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4179         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4180         16  PB-I-CLP-AMOUNT REDEFINES
  4181                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4182         16  PB-I-LF-CALC-FLAG            PIC X.
  4183             88 PB-COMP-LF-PREM               VALUE '?'.
  4184         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4185         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4186         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4187         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4188         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4189         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4190         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4191         16  PB-I-LF-ABBR                 PIC XXX.
  4192         16  PB-I-LF-INPUT-CD             PIC XX.
  4193
  4194         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4195             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4196             88  PB-INVALID-AH               VALUE '  ' '00'
  4197                                                   '90' THRU '99'.
  4198         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4199         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4200         16  PB-I-AH-CALC-FLAG            PIC X.
  4201             88 PB-COMP-AH-PREM                  VALUE '?'.
  4202         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4203         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4204         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4205         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4206         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4207         16  PB-I-AH-ABBR                 PIC XXX.
  4208         16  PB-I-AH-INPUT-CD             PIC XXX.
  4209
  4210         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4211         16  PB-I-REIN-TABLE              PIC XXX.
  4212         16  PB-I-BUSINESS-TYPE           PIC 99.
  4213         16  PB-I-INDV-GRP-CD             PIC X.
  4214         16  PB-I-MORT-CODE.
  4215             20  PB-I-TABLE               PIC X.
  4216             20  PB-I-INTEREST            PIC XX.
  4217             20  PB-I-MORT-TYP            PIC X.
  4218         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4219         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4220         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4221         16  PB-I-INDV-GRP-OVRD           PIC X.
  4222         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4223         16  PB-I-SIG-SW                  PIC X.
  4224             88  PB-POLICY-SIGNED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  75
* EL6318.cbl
  4225         16  PB-I-RATE-CLASS              PIC XX.
  4226         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4227         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4228         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4229         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4230         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4231         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4232         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4233         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4234         16  PB-I-OB-FLAG                 PIC X.
  4235             88  PB-I-OB                      VALUE 'B'.
  4236             88  PB-I-SUMMARY                 VALUE 'Z'.
  4237         16  PB-I-ENTRY-STATUS            PIC X.
  4238             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4239                                              'M' '5' '9' '2'.
  4240             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4241             88  PB-I-POLICY-PENDING          VALUE '2'.
  4242             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4243             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4244             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4245             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4246             88  PB-I-REIN-ONLY               VALUE '9'.
  4247             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4248             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4249             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4250             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4251         16  PB-I-INT-CODE                PIC X.
  4252             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4253             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4254         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4255         16  PB-I-SOC-SEC-NO              PIC X(11).
  4256         16  PB-I-MEMBER-NO               PIC X(12).
  4257         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4258*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4259         16  PB-I-OLD-LOF                 PIC XXX.
  4260         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4261         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4262         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4263         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4264         16  PB-I-LIFE-INDICATOR          PIC X.
  4265             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4266         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4267         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4268                                          PIC S9(5)V99    COMP-3.
  4269         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4270             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4271             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4272         16  PB-I-1ST-PMT-DT              PIC XX.
  4273         16  PB-I-JOINT-INSURED.
  4274             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4275             20 PB-I-JOINT-FIRST-NAME.
  4276                24  PB-I-JOINT-FIRST-INIT PIC X.
  4277                24  FILLER                PIC X(9).
  4278             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4279*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4280         16  PB-I-BENEFICIARY-NAME.
  4281             20  PB-I-BANK-NUMBER         PIC X(10).
  4282             20  FILLER                   PIC X(15).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  76
* EL6318.cbl
  4283         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4284         16  PB-I-REFERENCE               PIC X(12).
  4285         16  FILLER REDEFINES PB-I-REFERENCE.
  4286             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4287             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4288             20  PB-I-CLP-STATE           PIC XX.
  4289         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4290             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4291             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4292             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4293         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4294         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4295         16  PB-I-RESIDENT-STATE          PIC XX.
  4296         16  PB-I-RATE-CODE               PIC X(4).
  4297         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4298         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4299         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4300         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4301         16  PB-I-BANK-NOCHRGB            PIC 99.
  4302         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4303         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4304
  4305     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4306         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4307             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4308         16  PB-C-CANCEL-ORIGIN           PIC X.
  4309             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4310         16  PB-C-LF-CANCEL-DT            PIC XX.
  4311         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4312         16  PB-C-LF-CALC-REQ             PIC X.
  4313             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4314         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4315         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4316         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4317             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4318         16  PB-C-AH-CANCEL-DT            PIC XX.
  4319         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4320         16  PB-C-AH-CALC-REQ             PIC X.
  4321             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4322         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4323         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4324         16  PB-C-LAST-NAME               PIC X(15).
  4325         16  PB-C-REFUND-SW               PIC X.
  4326             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4327             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4328         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4329         16  PB-C-PAYEE-CODE              PIC X(6).
  4330         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4331         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4332         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4333         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4334         16  PB-C-REFERENCE               PIC X(12).
  4335         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4336         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4337         16  PB-C-POST-CARD-IND           PIC X.
  4338         16  PB-C-CANCEL-REASON           PIC X.
  4339         16  PB-C-REF-INTERFACE-SW        PIC X.
  4340         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  77
* EL6318.cbl
  4341         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4342         16  FILLER                       PIC X(01).
  4343*        16  FILLER                       PIC X(18).
  4344         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4345*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4346         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4347         16  PB-CANCELED-CERT-DATA.
  4348             20  PB-CI-INSURED-NAME.
  4349                 24  PB-CI-LAST-NAME      PIC X(15).
  4350                 24  PB-CI-INITIALS       PIC XX.
  4351             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4352             20  PB-CI-INSURED-SEX        PIC X.
  4353             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4354             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4355             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4356             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4357             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4358             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4359             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4360             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4361             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4362             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4363             20  PB-CI-RATE-CLASS         PIC XX.
  4364             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4365             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4366             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4367             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4368             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4369             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4370             20  PB-CI-LF-ABBR            PIC X(3).
  4371             20  PB-CI-AH-ABBR            PIC X(3).
  4372             20  PB-CI-OB-FLAG            PIC X.
  4373                 88  PB-CI-OB                VALUE 'B'.
  4374             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4375                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4376                                           'M' '4' '5' '9' '2'.
  4377                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4378                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4379                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4380                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4381                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4382                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4383                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4384                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4385                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4386                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4387                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4388                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4389                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4390             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4391                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4392                                           'M' '4' '5' '9' '2'.
  4393                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4394                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4395                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4396                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4397                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4398                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  78
* EL6318.cbl
  4399                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4400                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4401                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4402                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4403                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4404                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4405                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4406             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4407             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4408             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4409             20  PB-CI-MEMBER-NO          PIC X(12).
  4410             20  PB-CI-INT-CODE           PIC X.
  4411                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4412                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4413             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4414             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4415             20  PB-CI-COMP-EXCP-SW       PIC X.
  4416                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4417                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4418             20  PB-CI-ENTRY-STATUS       PIC X.
  4419             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4420             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4421             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4422             20  PB-CI-DEATH-DT           PIC XX.
  4423             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4424             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4425             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4426             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4427             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4428             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4429             20  PB-CI-ENTRY-DT              PIC XX.
  4430             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4431             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4432             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4433             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4434             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4435             20  PB-CI-OLD-LOF               PIC XXX.
  4436*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4437             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4438             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4439             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4440             20  PB-CI-INDV-GRP-CD           PIC X.
  4441             20  PB-CI-BENEFICIARY-NAME.
  4442                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4443                 24  FILLER                  PIC X(15).
  4444             20  PB-CI-NOTE-SW               PIC X.
  4445             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4446             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4447             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4448             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4449             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4450             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4451             20  PB-CI-FIRST-NAME            PIC X(10).
  4452             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4453
  4454         16  FILLER                       PIC X(13).
  4455*032306  16  FILLER                       PIC X(27).
  4456*        16  FILLER                       PIC X(46).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  79
* EL6318.cbl
  4457
  4458     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4459         16  FILLER                       PIC X(10).
  4460         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4461         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4462         16  PB-M-INSURED-MID-INIT        PIC X.
  4463         16  PB-M-INSURED-AGE             PIC 99.
  4464         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4465         16  PB-M-INSURED-SEX             PIC X.
  4466         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4467         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4468         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4469         16  PB-M-INSURED-CITY-STATE.
  4470             20  PB-M-INSURED-CITY        PIC X(28).
  4471             20  PB-M-INSURED-STATE       PIC XX.
  4472         16  PB-M-INSURED-ZIP-CODE.
  4473             20  PB-M-INSURED-ZIP-PRIME.
  4474                 24  PB-M-INSURED-ZIP-1   PIC X.
  4475                     88  PB-M-CANADIAN-POST-CODE
  4476                                             VALUE 'A' THRU 'Z'.
  4477                 24  FILLER               PIC X(4).
  4478             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4479         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4480                                        PB-M-INSURED-ZIP-CODE.
  4481             20  PM-M-INS-CAN-POST1       PIC XXX.
  4482             20  PM-M-INS-CAN-POST2       PIC XXX.
  4483             20  FILLER                   PIC XXX.
  4484         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4485         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4486         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4487         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4488         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4489         16  PB-M-CRED-BENE-CITYST.
  4490             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4491             20  PB-M-CRED-BENE-STATE     PIC XX.
  4492         16  FILLER                       PIC X(92).
  4493
  4494     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4495         16  FILLER                       PIC X(10).
  4496         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4497         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4498         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4499         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4500         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4501         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4502         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4503         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4504         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4505         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4506         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4507         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4508         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4509         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4510         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4511         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4512         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4513         16  PB-ACCOUNT-NAME              PIC X(30).
  4514         16  PB-PREM-REF-RPT-FLAG         PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  80
* EL6318.cbl
  4515         16  PB-REFERENCE                 PIC X(12).
  4516         16  PB-B-RECEIVED-DT             PIC XX.
  4517         16  FILLER                       PIC X(234).
  4518
  4519     12  PB-RECORD-STATUS.
  4520         16  PB-CREDIT-SELECT-DT          PIC XX.
  4521         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4522         16  PB-BILLED-DT                 PIC XX.
  4523         16  PB-BILLING-STATUS            PIC X.
  4524             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4525             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4526             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4527         16  PB-RECORD-BILL               PIC X.
  4528             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4529             88  PB-RECORD-RETURNED           VALUE 'R'.
  4530             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4531             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4532             88  PB-OVERRIDE-AH               VALUE 'A'.
  4533             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4534         16  PB-BATCH-ENTRY               PIC X.
  4535             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4536             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4537             88  PB-REISSUED-CERT             VALUE 'E'.
  4538             88  PB-CASH-CERT                 VALUE 'C'.
  4539             88  PB-MONTHLY-CERT              VALUE 'M'.
  4540             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4541             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4542             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4543         16  PB-FORCE-CODE                PIC X.
  4544             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4545             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4546             88  PB-CANCEL-FORCE              VALUE '8'.
  4547             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4548             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4549             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4550             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4551             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4552             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4553             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4554             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4555         16  PB-FATAL-FLAG                PIC X.
  4556             88  PB-FATAL-ERRORS              VALUE 'X'.
  4557         16  PB-FORCE-ER-CD               PIC X.
  4558             88  PB-FORCE-ERRORS              VALUE 'F'.
  4559             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4560         16  PB-WARN-ER-CD                PIC X.
  4561             88  PB-WARNING-ERRORS            VALUE 'W'.
  4562         16  FILLER                       PIC X.
  4563         16  PB-OUT-BAL-CD                PIC X.
  4564             88  PB-OUT-OF-BAL                VALUE 'O'.
  4565         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4566         16  PB-AH-OVERRIDE-L1            PIC X.
  4567         16  PB-INPUT-DT                  PIC XX.
  4568         16  PB-INPUT-BY                  PIC X(4).
  4569         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4570         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4571         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4572         16  PB-LF-EARNING-METHOD         PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  81
* EL6318.cbl
  4573         16  PB-AH-EARNING-METHOD         PIC X.
  4574         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4575         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4576         16  PB-REIN-CD                   PIC XXX.
  4577         16  PB-LF-REFUND-TYPE            PIC X.
  4578         16  PB-AH-REFUND-TYPE            PIC X.
  4579         16  PB-ACCT-EFF-DT               PIC XX.
  4580         16  PB-ACCT-EXP-DT               PIC XX.
  4581         16  PB-COMPANY-ID                PIC X(3).
  4582         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4583         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4584         16  PB-SV-CARRIER                PIC X.
  4585         16  PB-SV-GROUPING               PIC X(6).
  4586         16  PB-SV-STATE                  PIC XX.
  4587         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4588         16  PB-GA-BILLING-INFO.
  4589             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4590                                          PIC XX.
  4591         16  PB-SV-REMIT-TO  REDEFINES
  4592             PB-GA-BILLING-INFO           PIC X(10).
  4593         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4594         16  PB-I-LOAN-OFFICER            PIC X(5).
  4595         16  PB-I-VIN                     PIC X(17).
  4596
  4597         16  FILLER                       PIC X(04).
  4598         16  IMNET-BYPASS-SW              PIC X.
  4599
  4600******************************************************************
  4601*                COMMON EDIT ERRORS                              *
  4602******************************************************************
  4603
  4604     12  PB-COMMON-ERRORS.
  4605         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4606                                           PIC S9(4)     COMP.
  4607
  4608******************************************************************
  4609*                                COPY ELCCERT.
  4610******************************************************************
  4611*                                                                *
  4612*                            ELCCERT.                            *
  4613*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4614*                            VMOD=2.013                          *
  4615*                                                                *
  4616*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4617*                                                                *
  4618*   FILE TYPE = VSAM,KSDS                                        *
  4619*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4620*                                                                *
  4621*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4622*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4623*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4624*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4625*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4626*                                                                *
  4627*   LOG = YES                                                    *
  4628*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4629******************************************************************
  4630*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  82
* EL6318.cbl
  4631*
  4632* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4633*-----------------------------------------------------------------
  4634*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4635* EFFECTIVE    NUMBER
  4636*-----------------------------------------------------------------
  4637* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4638* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4639* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4640* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4641* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4642* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4643* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4644* 032612  CR2011110200001  PEMA  AHL CHANGES
  4645* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4646* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4647* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4648******************************************************************
  4649
  4650 01  CERTIFICATE-MASTER.
  4651     12  CM-RECORD-ID                      PIC XX.
  4652         88  VALID-CM-ID                      VALUE 'CM'.
  4653
  4654     12  CM-CONTROL-PRIMARY.
  4655         16  CM-COMPANY-CD                 PIC X.
  4656         16  CM-CARRIER                    PIC X.
  4657         16  CM-GROUPING.
  4658             20  CM-GROUPING-PREFIX        PIC X(3).
  4659             20  CM-GROUPING-PRIME         PIC X(3).
  4660         16  CM-STATE                      PIC XX.
  4661         16  CM-ACCOUNT.
  4662             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4663             20  CM-ACCOUNT-PRIME          PIC X(6).
  4664         16  CM-CERT-EFF-DT                PIC XX.
  4665         16  CM-CERT-NO.
  4666             20  CM-CERT-PRIME             PIC X(10).
  4667             20  CM-CERT-SFX               PIC X.
  4668
  4669     12  CM-CONTROL-BY-NAME.
  4670         16  CM-COMPANY-CD-A1              PIC X.
  4671         16  CM-INSURED-LAST-NAME          PIC X(15).
  4672         16  CM-INSURED-INITIALS.
  4673             20  CM-INSURED-INITIAL1       PIC X.
  4674             20  CM-INSURED-INITIAL2       PIC X.
  4675
  4676     12  CM-CONTROL-BY-SSN.
  4677         16  CM-COMPANY-CD-A2              PIC X.
  4678         16  CM-SOC-SEC-NO.
  4679             20  CM-SSN-STATE              PIC XX.
  4680             20  CM-SSN-ACCOUNT            PIC X(6).
  4681             20  CM-SSN-LN3.
  4682                 25  CM-INSURED-INITIALS-A2.
  4683                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4684                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4685                 25 CM-PART-LAST-NAME-A2         PIC X.
  4686
  4687     12  CM-CONTROL-BY-CERT-NO.
  4688         16  CM-COMPANY-CD-A4              PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  83
* EL6318.cbl
  4689         16  CM-CERT-NO-A4                 PIC X(11).
  4690
  4691     12  CM-CONTROL-BY-MEMB.
  4692         16  CM-COMPANY-CD-A5              PIC X.
  4693         16  CM-MEMBER-NO.
  4694             20  CM-MEMB-STATE             PIC XX.
  4695             20  CM-MEMB-ACCOUNT           PIC X(6).
  4696             20  CM-MEMB-LN4.
  4697                 25  CM-INSURED-INITIALS-A5.
  4698                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4699                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4700                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4701
  4702     12  CM-INSURED-PROFILE-DATA.
  4703         16  CM-INSURED-FIRST-NAME.
  4704             20  CM-INSURED-1ST-INIT       PIC X.
  4705             20  FILLER                    PIC X(9).
  4706         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4707         16  CM-INSURED-SEX                PIC X.
  4708             88  CM-SEX-MALE                  VALUE 'M'.
  4709             88  CM-SEX-FEMAL                 VALUE 'F'.
  4710         16  CM-INSURED-JOINT-AGE          PIC 99.
  4711         16  CM-JOINT-INSURED-NAME.
  4712             20  CM-JT-LAST-NAME           PIC X(15).
  4713             20  CM-JT-FIRST-NAME.
  4714                 24  CM-JT-1ST-INIT        PIC X.
  4715                 24  FILLER                PIC X(9).
  4716             20  CM-JT-INITIAL             PIC X.
  4717
  4718     12  CM-LIFE-DATA.
  4719         16  CM-LF-BENEFIT-CD              PIC XX.
  4720         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4721         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4722         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4723         16  CM-LF-DEV-CODE                PIC XXX.
  4724         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4725         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4726         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4727         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4728         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4729         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4730         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4731         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4732         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4733         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4734         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4735         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4736         16  cm-temp-epiq                  pic xx.
  4737             88  EPIQ-CLASS                  value 'EQ'.
  4738*        16  FILLER                        PIC XX.
  4739
  4740     12  CM-AH-DATA.
  4741         16  CM-AH-BENEFIT-CD              PIC XX.
  4742         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4743         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4744         16  CM-AH-DEV-CODE                PIC XXX.
  4745         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4746         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  84
* EL6318.cbl
  4747         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4748         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4749         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4750         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4751         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4752         16  CM-AH-PAID-THRU-DT            PIC XX.
  4753             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4754         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4755         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4756         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4757         16  FILLER                        PIC X.
  4758
  4759     12  CM-LOAN-INFORMATION.
  4760         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4761         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4762                                           PIC S9(5)V99  COMP-3.
  4763         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4764         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4765         16  CM-PAY-FREQUENCY              PIC S99.
  4766         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4767         16  CM-RATE-CLASS                 PIC XX.
  4768         16  CM-BENEFICIARY                PIC X(25).
  4769         16  CM-POLICY-FORM-NO             PIC X(12).
  4770         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4771         16  CM-LAST-ADD-ON-DT             PIC XX.
  4772         16  CM-DEDUCTIBLE-AMOUNTS.
  4773             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4774             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4775         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4776             20  CM-RESIDENT-STATE         PIC XX.
  4777             20  CM-RATE-CODE              PIC X(4).
  4778             20  FILLER                    PIC XX.
  4779         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4780             20  CM-LOAN-OFFICER           PIC X(5).
  4781             20  FILLER                    PIC XXX.
  4782         16  CM-CSR-CODE                   PIC XXX.
  4783         16  CM-UNDERWRITING-CODE          PIC X.
  4784             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4785         16  CM-POST-CARD-IND              PIC X.
  4786         16  CM-REF-INTERFACE-SW           PIC X.
  4787         16  CM-PREMIUM-TYPE               PIC X.
  4788             88  CM-SING-PRM                  VALUE '1'.
  4789             88  CM-O-B-COVERAGE              VALUE '2'.
  4790             88  CM-OPEN-END                  VALUE '3'.
  4791         16  CM-IND-GRP-TYPE               PIC X.
  4792             88  CM-INDIVIDUAL                VALUE 'I'.
  4793             88  CM-GROUP                     VALUE 'G'.
  4794         16  CM-SKIP-CODE                  PIC X.
  4795             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4796             88  SKIP-JULY                    VALUE '1'.
  4797             88  SKIP-AUGUST                  VALUE '2'.
  4798             88  SKIP-SEPTEMBER               VALUE '3'.
  4799             88  SKIP-JULY-AUG                VALUE '4'.
  4800             88  SKIP-AUG-SEPT                VALUE '5'.
  4801             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4802             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4803             88  SKIP-JUNE                    VALUE '8'.
  4804             88  SKIP-JUNE-JULY               VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  85
* EL6318.cbl
  4805             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4806             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4807         16  CM-PAYMENT-MODE               PIC X.
  4808             88  PAY-MONTHLY                  VALUE SPACE.
  4809             88  PAY-WEEKLY                   VALUE '1'.
  4810             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4811             88  PAY-BI-WEEKLY                VALUE '3'.
  4812             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4813         16  CM-LOAN-NUMBER                PIC X(8).
  4814         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4815         16  CM-OLD-LOF                    PIC XXX.
  4816*        16  CM-LOAN-OFFICER               PIC XXX.
  4817         16  CM-REIN-TABLE                 PIC XXX.
  4818         16  CM-SPECIAL-REIN-CODE          PIC X.
  4819         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4820         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4821         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4822
  4823     12  CM-STATUS-DATA.
  4824         16  CM-ENTRY-STATUS               PIC X.
  4825         16  CM-ENTRY-DT                   PIC XX.
  4826
  4827         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4828         16  CM-LF-CANCEL-DT               PIC XX.
  4829         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4830
  4831         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4832         16  CM-LF-DEATH-DT                PIC XX.
  4833         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4834
  4835         16  CM-LF-CURRENT-STATUS          PIC X.
  4836             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4837                                                'M' '4' '5' '9'.
  4838             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4839             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4840             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4841             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4842             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4843             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4844             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4845             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4846             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4847             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4848             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4849             88  CM-LF-DECLINED               VALUE 'D'.
  4850             88  CM-LF-VOIDED                 VALUE 'V'.
  4851
  4852         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4853         16  CM-AH-CANCEL-DT               PIC XX.
  4854         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4855
  4856         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4857         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4858         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4859
  4860         16  CM-AH-CURRENT-STATUS          PIC X.
  4861             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4862                                                'M' '4' '5' '9'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  86
* EL6318.cbl
  4863             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4864             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4865             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4866             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4867             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4868             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4869             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4870             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4871             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4872             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4873             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4874             88  CM-AH-DECLINED               VALUE 'D'.
  4875             88  CM-AH-VOIDED                 VALUE 'V'.
  4876
  4877         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4878             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4879             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4880             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4881         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4882
  4883         16  CM-ENTRY-BATCH                PIC X(6).
  4884         16  CM-LF-EXIT-BATCH              PIC X(6).
  4885         16  CM-AH-EXIT-BATCH              PIC X(6).
  4886         16  CM-LAST-MONTH-END             PIC XX.
  4887
  4888     12  CM-NOTE-SW                        PIC X.
  4889         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4890         88  CERT-NOTES-PRESENT               VALUE '1'.
  4891         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4892         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4893         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4894         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4895         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4896         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4897     12  CM-COMP-EXCP-SW                   PIC X.
  4898         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4899         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4900     12  CM-INSURED-ADDRESS-SW             PIC X.
  4901         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4902         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4903
  4904*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4905     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4906     12  FILLER                            PIC X.
  4907
  4908*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4909     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4910     12  FILLER                            PIC X.
  4911*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4912     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  4913
  4914     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4915         88  CERT-ADDED-BATCH                 VALUE ' '.
  4916         88  CERT-ADDED-ONLINE                VALUE '1'.
  4917         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4918         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4919         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4920     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  87
* EL6318.cbl
  4921         88  CERT-AS-LOADED                   VALUE ' '.
  4922         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4923         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4924         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4925         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4926         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4927         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4928         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4929
  4930     12  CM-ACCOUNT-COMM-PCTS.
  4931         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4932         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4933
  4934     12  CM-USER-FIELD                     PIC X.
  4935     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4936     12  CM-CLP-STATE                      PIC XX.
  4937     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4938     12  CM-USER-RESERVED                  PIC XXX.
  4939     12  FILLER REDEFINES CM-USER-RESERVED.
  4940         16  CM-AH-CLASS-CD                PIC XX.
  4941         16  F                             PIC X.
  4942******************************************************************
  4943*                                COPY ELCCRTO.
  4944******************************************************************
  4945*                                                                *
  4946*                            ELCCRTO.                            *
  4947*                                                                *
  4948*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4949*                                                                *
  4950*   FILE TYPE = VSAM,KSDS                                        *
  4951*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4952*                                                                *
  4953*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4954*                                                                *
  4955*   LOG = YES                                                    *
  4956*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4957******************************************************************
  4958*                   C H A N G E   L O G
  4959*
  4960* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4961*-----------------------------------------------------------------
  4962*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4963* EFFECTIVE    NUMBER
  4964*-----------------------------------------------------------------
  4965* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4966* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4967* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4968* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4969* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4970******************************************************************
  4971 01  ORIGINAL-CERTIFICATE.
  4972     12  OC-RECORD-ID                      PIC XX.
  4973         88  VALID-OC-ID                      VALUE 'OC'.
  4974     12  OC-CONTROL-PRIMARY.
  4975         16  OC-COMPANY-CD                 PIC X.
  4976         16  OC-CARRIER                    PIC X.
  4977         16  OC-GROUPING                   PIC X(6).
  4978         16  OC-STATE                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  88
* EL6318.cbl
  4979         16  OC-ACCOUNT                    PIC X(10).
  4980         16  OC-CERT-EFF-DT                PIC XX.
  4981         16  OC-CERT-NO.
  4982             20  OC-CERT-PRIME             PIC X(10).
  4983             20  OC-CERT-SFX               PIC X.
  4984         16  OC-RECORD-TYPE                PIC X.
  4985         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4986     12  OC-LAST-MAINT-DT                  PIC XX.
  4987     12  OC-LAST-MAINT-BY                  PIC X(4).
  4988     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4989     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4990     12  FILLER                            PIC X(49).
  4991     12  OC-ORIG-REC.
  4992         16  OC-INS-LAST-NAME              PIC X(15).
  4993         16  OC-INS-FIRST-NAME             PIC X(10).
  4994         16  OC-INS-MIDDLE-INIT            PIC X.
  4995         16  OC-INS-AGE                    PIC S999     COMP-3.
  4996         16  OC-JNT-LAST-NAME              PIC X(15).
  4997         16  OC-JNT-FIRST-NAME             PIC X(10).
  4998         16  OC-JNT-MIDDLE-INIT            PIC X.
  4999         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5000         16  OC-LF-BENCD                   PIC XX.
  5001         16  OC-LF-TERM                    PIC S999      COMP-3.
  5002         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5003         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5004         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5005         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5006         16  OC-LF-EXP-DT                  PIC XX.
  5007         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5008         16  OC-LF-CANCEL-DT               PIC XX.
  5009         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5010         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5011         16  OC-AH-BENCD                   PIC XX.
  5012         16  OC-AH-TERM                    PIC S999      COMP-3.
  5013         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5014         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5015         16  OC-AH-EXP-DT                  PIC XX.
  5016         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5017         16  OC-AH-CP                      PIC 99.
  5018         16  OC-AH-CANCEL-DT               PIC XX.
  5019         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5020         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5021         16  OC-CRED-BENE-NAME             PIC X(25).
  5022         16  OC-1ST-PMT-DT                 PIC XX.
  5023         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5024         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5025         16  OC-ISSUE-TRAN-IND             PIC X.
  5026         16  OC-CANCEL-TRAN-IND            PIC X.
  5027         16  FILLER                        PIC X(211).
  5028
  5029     12  FILLER                            PIC X(50).
  5030******************************************************************
  5031*                                COPY ERCENDT.
  5032******************************************************************
  5033*                                                                *
  5034*                                                                *
  5035*                            ERCENDT.                            *
  5036*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  89
* EL6318.cbl
  5037*                                                                *
  5038*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  5039*                                                                *
  5040*   FILE TYPE = VSAM,KSDS                                        *
  5041*   RECORD SIZE = 579  RECFORM = FIXED                           *
  5042*                                                                *
  5043*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  5044*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  5045*                                                                *
  5046*   LOG = NO                                                     *
  5047*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5048******************************************************************
  5049*-----------------------------------------------------------------
  5050*                   C H A N G E   L O G
  5051*
  5052* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5053*-----------------------------------------------------------------
  5054*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5055* EFFECTIVE    NUMBER
  5056*-----------------------------------------------------------------
  5057* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  5058*                                WITH OPEN CLAIMS
  5059* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  5060* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5061* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5062* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  5063*-----------------------------------------------------------------
  5064 01  ENDORSEMENT-RECORD.
  5065     12  EN-RECORD-ID                PIC XX.
  5066         88  VALID-EN-ID                VALUE 'EN'.
  5067     12  EN-CONTROL-PRIMARY.
  5068         16  EN-COMPANY-CD           PIC X.
  5069         16  EN-CARRIER              PIC X.
  5070         16  EN-GROUPING             PIC X(6).
  5071         16  EN-STATE                PIC XX.
  5072         16  EN-ACCOUNT              PIC X(10).
  5073         16  EN-CERT-EFF-DT          PIC XX.
  5074         16  EN-CERT-NO.
  5075             20  EN-CERT-PRIME       PIC X(10).
  5076             20  EN-CERT-SFX         PIC X.
  5077         16  EN-REC-TYPE             PIC X.
  5078             88  EN-ISSUE               VALUE 'I'.
  5079             88  EN-CANCELLATION        VALUE 'C'.
  5080         16  EN-SEQ-NO               PIC 9(04) BINARY.
  5081     12  EN-CONTROL-BY-ARCH-NO.
  5082         16  EN-COMPANY-CD-A1              PIC X.
  5083         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  5084     12  EN-LAST-MAINT-DT            PIC XX.
  5085     12  EN-LAST-MAINT-BY            PIC X(4).
  5086     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  5087     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  5088     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5089         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  5090         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  5091         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  5092         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  5093         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  5094         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  90
* EL6318.cbl
  5095         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  5096         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  5097         16  EN-LF-ORIG-BENCD        PIC XX.
  5098         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  5099         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5100         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5101         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  5102         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  5103         16  EN-LF-ORIG-EXP-DT       PIC XX.
  5104*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  5105         16  EN-ORIG-CRED-BENE       PIC X(25).
  5106         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5107         16  FILLER                  PIC X.
  5108         16  EN-AH-ORIG-BENCD        PIC XX.
  5109         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  5110         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5111         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5112         16  EN-AH-ORIG-EXP-DT       PIC XX.
  5113*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  5114*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  5115         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5116         16  F                       PIC X(09).
  5117         16  EN-AH-ORIG-CP           PIC 99.
  5118         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  5119         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  5120         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  5121         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5122         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5123         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5124         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  5125         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5126         16  EN-LF-NEW-BENCD         PIC XX.
  5127         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5128         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5129         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5130         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5131         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5132         16  EN-LF-NEW-EXP-DT        PIC XX.
  5133         16  EN-NEW-CRED-BENE        PIC X(25).
  5134         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5135         16  FILLER                  PIC X.
  5136         16  EN-AH-NEW-BENCD         PIC XX.
  5137         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5138         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5139         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5140         16  EN-AH-NEW-EXP-DT        PIC XX.
  5141*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5142*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5143*        16  F                       PIC X(12).
  5144         16  EN-AH-NEW-CP            PIC 99.
  5145         16  EN-SIG-SW               PIC X.
  5146         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5147         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5148         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5149         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5150         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5151         16  FILLER                  PIC X(33).
  5152     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  91
* EL6318.cbl
  5153         16  EN-LF-ORIG-REF-DT       PIC XX.
  5154         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5155         16  EN-AH-ORIG-REF-DT       PIC XX.
  5156         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5157         16  EN-LF-NEW-REF-DT        PIC XX.
  5158         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5159         16  EN-AH-NEW-REF-DT        PIC XX.
  5160         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5161         16  EN-FLAG-CERT            PIC X.
  5162         16  EN-INS-LAST-NAME        PIC X(15).
  5163         16  EN-INS-FIRST-NAME       PIC X(10).
  5164         16  EN-INS-MIDDLE-INIT      PIC X.
  5165         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5166         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5167         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5168         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5169         16  FILLER                  PIC X(262).
  5170     12  EN-MONEY-SW             PIC X.
  5171     12  EN-HEALTH-APP           PIC X.
  5172     12  EN-VOUCHER-SW           PIC X.
  5173     12  EN-PAYEE                PIC X(14).
  5174     12  EN-INPUT-DT             PIC XX.
  5175     12  EN-PROCESS-DT           PIC XX.
  5176     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5177     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5178     12  EN-REASON-CODES.
  5179         16  F OCCURS 12.
  5180             20  EN-REASON-CODE  PIC X(4).
  5181     12  EN-TEMPLATE-USED        PIC X(8).
  5182     12  EN-DOCU-TYPE            PIC X.
  5183         88  EN-VERI-DOCU          VALUE 'V'.
  5184         88  EN-GCE-DOCU           VALUE 'G'.
  5185         88  EN-CANC-DOCU          VALUE 'C'.
  5186     12  EN-COMMENTS1            PIC X(13).
  5187     12  EN-COMMENTS2            PIC X(70).
  5188     12  EN-COMM-CHGBK           PIC X.
  5189         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5190         88  EN-CHG-ACCT           VALUE 'Y'.
  5191     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5192     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5193     12  EN-BATCH-NUMBER         PIC X(6).
  5194     12  EN-ACCT-SUMM            PIC X.
  5195     12  EN-CSO-SUMM             PIC X.
  5196     12  en-check-type           pic x.
  5197     12  FILLER                  PIC X(12).
  5198******************************************************************
  5199*                                COPY ERCNOTE.
  5200******************************************************************
  5201*                                                                *
  5202*                                                                *
  5203*                            ERCNOTE                             *
  5204*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5205*                            VMOD=2.003                          *
  5206*                                                                *
  5207*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5208*                                                                *
  5209*        FILE TYPE= VSAM,KSDS                                    *
  5210*        RECORD SIZE = 825    RECFORM = FIXED                    *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  92
* EL6318.cbl
  5211*                                                                *
  5212*        BASE CLUSTER = ERNOTE        RKP=2,LEN=34               *
  5213*                                                                *
  5214*        LOG = YES                                               *
  5215*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5216*                                                                *
  5217******************************************************************
  5218*                   C H A N G E   L O G
  5219*
  5220* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5221*-----------------------------------------------------------------
  5222*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5223* EFFECTIVE    NUMBER
  5224*-----------------------------------------------------------------
  5225* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5226*                                FILE WILL CONTAIN BILLING NOTES O
  5227* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
  5228******************************************************************
  5229
  5230 01  CERTIFICATE-NOTE.
  5231     12  CN-RECORD-ID                PIC  XX.
  5232         88  VALID-CN-ID                  VALUE 'CN'.
  5233
  5234     12  CN-CONTROL-PRIMARY.
  5235         16  CN-COMPANY-CD           PIC X.
  5236         16  CN-CARRIER              PIC X.
  5237         16  CN-GROUPING.
  5238             20 CN-GROUPING-PREFIX   PIC XXX.
  5239             20 CN-GROUPING-PRIME    PIC XXX.
  5240         16  CN-STATE                PIC XX.
  5241         16  CN-ACCOUNT.
  5242             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5243             20 CN-ACCOUNT-PRIME     PIC X(6).
  5244         16  CN-CERT-EFF-DT          PIC XX.
  5245         16  CN-CERT-NO.
  5246             20  CN-CERT-PRIME       PIC X(10).
  5247             20  CN-CERT-SFX         PIC X.
  5248         16  CN-RECORD-TYPE          PIC X.
  5249             88  CN-ISSUE-BILLING-NOTE    VALUE '1'.
  5250             88  CN-CANCEL-BILLING-NOTE   VALUE '2'.
  5251     12  CN-BILLING-START-LINE-NO    PIC 99.
  5252     12  CN-BILLING-END-LINE-NO      PIC 99.
  5253
  5254     12  CN-LINES.
  5255         16  CN-LINE OCCURS 10       PIC X(77).
  5256
  5257     12  CN-LAST-MAINT-DT            PIC XX.
  5258     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5259     12  CN-LAST-MAINT-USER          PIC X(4).
  5260     12  FILLER                      PIC X(5).
  5261******************************************************************
  5262*                                COPY ERCMAIL.
  5263******************************************************************
  5264*                                                                *
  5265*                                                                *
  5266*                            ERCMAIL                             *
  5267*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5268*                            VMOD=2.003                          *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  93
* EL6318.cbl
  5269*                                                                *
  5270*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5271*                                                                *
  5272*   FILE TYPE = VSAM,KSDS                                        *
  5273*   RECORD SIZE = 374   RECFORM = FIX                            *
  5274*                                                                *
  5275*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5276*   ALTERNATE PATH    = NOT USED                                 *
  5277*                                                                *
  5278*   LOG = YES                                                    *
  5279*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5280******************************************************************
  5281*                   C H A N G E   L O G
  5282*
  5283* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5284*-----------------------------------------------------------------
  5285*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5286* EFFECTIVE    NUMBER
  5287*-----------------------------------------------------------------
  5288* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5289* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5290* 111108                   PEMA  ADD CRED BENE ADDR2
  5291******************************************************************
  5292
  5293 01  MAILING-DATA.
  5294     12  MA-RECORD-ID                      PIC XX.
  5295         88  VALID-MA-ID                       VALUE 'MA'.
  5296
  5297     12  MA-CONTROL-PRIMARY.
  5298         16  MA-COMPANY-CD                 PIC X.
  5299         16  MA-CARRIER                    PIC X.
  5300         16  MA-GROUPING.
  5301             20  MA-GROUPING-PREFIX        PIC XXX.
  5302             20  MA-GROUPING-PRIME         PIC XXX.
  5303         16  MA-STATE                      PIC XX.
  5304         16  MA-ACCOUNT.
  5305             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5306             20  MA-ACCOUNT-PRIME          PIC X(6).
  5307         16  MA-CERT-EFF-DT                PIC XX.
  5308         16  MA-CERT-NO.
  5309             20  MA-CERT-PRIME             PIC X(10).
  5310             20  MA-CERT-SFX               PIC X.
  5311
  5312     12  FILLER                            PIC XX.
  5313
  5314     12  MA-ACCESS-CONTROL.
  5315         16  MA-SOURCE-SYSTEM              PIC XX.
  5316             88  MA-FROM-CREDIT                VALUE 'CR'.
  5317             88  MA-FROM-VSI                   VALUE 'VS'.
  5318             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5319             88  MA-FROM-OTHER                 VALUE 'OT'.
  5320         16  MA-RECORD-ADD-DT              PIC XX.
  5321         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5322         16  MA-LAST-MAINT-DT              PIC XX.
  5323         16  MA-LAST-MAINT-BY              PIC XXXX.
  5324         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5325
  5326     12  MA-PROFILE-INFO.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  94
* EL6318.cbl
  5327         16  MA-QUALIFY-CODE-1             PIC XX.
  5328         16  MA-QUALIFY-CODE-2             PIC XX.
  5329         16  MA-QUALIFY-CODE-3             PIC XX.
  5330         16  MA-QUALIFY-CODE-4             PIC XX.
  5331         16  MA-QUALIFY-CODE-5             PIC XX.
  5332
  5333         16  MA-INSURED-LAST-NAME          PIC X(15).
  5334         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5335         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5336         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5337         16  MA-INSURED-BIRTH-DT           PIC XX.
  5338         16  MA-INSURED-SEX                PIC X.
  5339             88  MA-SEX-MALE                   VALUE 'M'.
  5340             88  MA-SEX-FEMALE                 VALUE 'F'.
  5341         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5342
  5343         16  MA-ADDRESS-CORRECTED          PIC X.
  5344         16  MA-JOINT-BIRTH-DT             PIC XX.
  5345*        16  FILLER                        PIC X(12).
  5346
  5347         16  MA-ADDRESS-LINE-1             PIC X(30).
  5348         16  MA-ADDRESS-LINE-2             PIC X(30).
  5349         16  MA-CITY-STATE.
  5350             20  MA-CITY                   PIC X(28).
  5351             20  MA-ADDR-STATE             PIC XX.
  5352         16  MA-ZIP.
  5353             20  MA-ZIP-CODE.
  5354                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5355                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5356                 24  FILLER                PIC X(4).
  5357             20  MA-ZIP-PLUS4              PIC X(4).
  5358         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5359             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5360             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5361             20  FILLER                    PIC X(3).
  5362
  5363         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5364
  5365         16  FILLER                        PIC XXX.
  5366*        16  FILLER                        PIC X(10).
  5367
  5368     12  MA-CRED-BENE-INFO.
  5369         16  MA-CRED-BENE-NAME                 PIC X(25).
  5370         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5371         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5372         16  MA-CRED-BENE-CTYST.
  5373             20  MA-CRED-BENE-CITY             PIC X(28).
  5374             20  MA-CRED-BENE-STATE            PIC XX.
  5375         16  MA-CRED-BENE-ZIP.
  5376             20  MA-CB-ZIP-CODE.
  5377                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5378                     88  MA-CB-CANADIAN-POST-CODE
  5379                                           VALUE 'A' THRU 'Z'.
  5380                 24  FILLER                    PIC X(4).
  5381             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5382         16  MA-CB-CANADIAN-POSTAL-CODE
  5383                            REDEFINES MA-CRED-BENE-ZIP.
  5384             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  95
* EL6318.cbl
  5385             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5386             20  FILLER                        PIC X(3).
  5387     12  MA-POST-CARD-MAIL-DATA.
  5388         16  MA-MAIL-DATA OCCURS 7.
  5389             20  MA-MAIL-TYPE              PIC X.
  5390                 88  MA-12MO-MAILING           VALUE '1'.
  5391                 88  MA-EXP-MAILING            VALUE '2'.
  5392             20  MA-MAIL-STATUS            PIC X.
  5393                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5394                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5395                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5396             20  MA-MAIL-DATE              PIC XX.
  5397     12  FILLER                            PIC XX.
  5398     12  FILLER                            PIC XX.
  5399*    12  FILLER                            PIC X(30).
  5400******************************************************************
  5401*                                COPY ERCARCH.
  5402******************************************************************
  5403*                                                                *
  5404*                            ERCARCH.                            *
  5405*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5406*                            VMOD=2.002                          *
  5407*                                                                *
  5408*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5409*                                                                *
  5410*   FILE TYPE = VSAM,KSDS                                        *
  5411*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5412*                                                                *
  5413*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5414*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  5415*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5416*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5417*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5418*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5419*                                                                *
  5420*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5421******************************************************************
  5422*                   C H A N G E   L O G
  5423*
  5424* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5425*-----------------------------------------------------------------
  5426*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5427* EFFECTIVE    NUMBER
  5428*-----------------------------------------------------------------
  5429* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5430* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5431* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5432* 102918  CR2018080300002  PEMA  ADD ONBASE STUFF
  5433******************************************************************
  5434 01  LETTER-ARCHIVE.
  5435     12  LA-RECORD-ID                PIC  X(02).
  5436         88  LA-VALID-ID                VALUE 'LA'.
  5437
  5438     12  LA-CONTROL-PRIMARY.
  5439         16  LA-COMPANY-CD           PIC  X(01).
  5440         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5441
  5442     12  LA-CONTROL-BY-CERT-RESP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  96
* EL6318.cbl
  5443         16  LA-COMPANY-CD-A2        PIC  X(01).
  5444         16  LA-CERT-NO-A2.
  5445             20  LA-CERT-PRIME-A2    PIC  X(10).
  5446             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5447         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5448             20  LA-RESP-PERSON-A2   PIC  X(10).
  5449             20  LA-TYPE-A2          PIC  X(01).
  5450         16  LA-CARRIER-A2           PIC  X(01).
  5451         16  LA-GROUPING-A2          PIC  X(06).
  5452         16  LA-STATE-A2             PIC  X(02).
  5453         16  LA-ACCOUNT-A2           PIC  X(10).
  5454         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5455         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5456
  5457     12  LA-CONTROL-BY-FORM.
  5458         16  LA-COMPANY-CD-A3        PIC  X(01).
  5459         16  LA-FORM-A3              PIC  X(04).
  5460         16  LA-CARRIER-A3           PIC  X(01).
  5461         16  LA-GROUPING-A3          PIC  X(06).
  5462         16  LA-STATE-A3             PIC  X(02).
  5463         16  LA-ACCOUNT-A3           PIC  X(10).
  5464         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5465
  5466     12  LA-CONTROL-BY-PROCESSOR.
  5467         16  LA-COMPANY-CD-A4        PIC  X(01).
  5468         16  LA-PROCESSOR-CD         PIC  X(04).
  5469         16  LA-CARRIER-A4           PIC  X(01).
  5470         16  LA-GROUPING-A4          PIC  X(06).
  5471         16  LA-STATE-A4             PIC  X(02).
  5472         16  LA-ACCOUNT-A4           PIC  X(10).
  5473         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5474
  5475     12  LA-CONTROL-BY-KEY-FIELDS.
  5476         16  LA-COMPANY-CD-A5        PIC  X(01).
  5477         16  LA-CARRIER-A5           PIC  X(01).
  5478         16  LA-GROUPING-A5          PIC  X(06).
  5479         16  LA-STATE-A5             PIC  X(02).
  5480         16  LA-ACCOUNT-A5           PIC  X(10).
  5481         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5482
  5483     12  LA-CONTROL-BY-GROUP-CODE.
  5484         16  LA-COMPANY-CD-A6        PIC  X(01).
  5485         16  LA-ENTRY-A6.
  5486             20  LA-FILLER           PIC  X(02).
  5487             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5488         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5489
  5490     12  FILLER                      PIC  X(09).
  5491
  5492     12  LA-HEADER-RECORD.
  5493         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5494         16  LA-CREATION-DATE        PIC  X(02).
  5495         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5496         16  LA-FINAL-ACT-DATE       REDEFINES
  5497               LA-FOLLOW-UP-DATE     PIC  X(02).
  5498         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5499         16  LA-NO-OF-COPIES         PIC S9(01).
  5500         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  97
* EL6318.cbl
  5501         16  LA-REPLY-DATE           PIC  X(02).
  5502         16  LA-RESEND-DATES.
  5503             20  LA-RESEND-DATE      PIC  X(02).
  5504             20  LA-SENT-DATE        PIC  X(02).
  5505             20  FILLER              PIC  X(08).
  5506         16  LA-SOURCE-INFORMATION.
  5507             20  LA-DATA-SOURCE      PIC  X(01).
  5508             20  LA-ADDR-SOURCE      PIC  X(01).
  5509         16  LA-STATUS               PIC  X(01).
  5510             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5511             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5512             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5513             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5514             88  LA-STATUS-PURGED         VALUE 'P'.
  5515             88  LA-STATUS-VOIDED         VALUE 'V'.
  5516         16  LA-LAST-RESENT-PRINT-DATE
  5517                                     PIC  X(02).
  5518         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5519             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5520                                          VALUE 'C'.
  5521             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5522                                          VALUE 'F'.
  5523             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5524                                          VALUE 'P'.
  5525         16  LA-PURGED-DATE          PIC  X(02).
  5526         16  LA-VOIDED-DATE          PIC  X(02).
  5527         16  LA-RESEND-LETR          PIC  X(4).
  5528         16  LA-VOID-ONBASE-YN       PIC  X.
  5529         16  LA-ONBASE-UNIQUE-ID     PIC S9(5) COMP-3.
  5530         16  FILLER                  PIC  X(04).
  5531*        16  LA-RESEND-LETR-2        PIC  X(4).
  5532*        16  LA-RESEND-LETR-3        PIC  X(4).
  5533*        16  FILLER                  PIC  X(59).
  5534         16  LA-ARCHIVE-STATUS       PIC  X.
  5535             88  LA-TEMP                VALUE 'T'.
  5536             88  LA-QWS                 VALUE 'Q'.
  5537             88  LA-BATCH               VALUE 'B'.
  5538         16  LA-FINAL-ACT-IND        PIC  X(1).
  5539         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5540         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5541         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5542                                     PIC X(4).
  5543         16  FILLER                  PIC  X(42).
  5544*        16  FILLER                  PIC  X(71).
  5545         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5546         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5547         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5548                                     PIC  X(4).
  5549         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5550
  5551******************************************************************
  5552*                                COPY ERCCNOT.
  5553******************************************************************
  5554*                                                                *
  5555*                            ERCCNOT                             *
  5556*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5557*                            VMOD=2.003                          *
  5558*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  98
* EL6318.cbl
  5559*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5560*                                                                *
  5561*        FILE TYPE= VSAM,KSDS                                    *
  5562*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5563*                                                                *
  5564*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5565*                                                                *
  5566*        LOG = YES                                               *
  5567*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5568*                                                                *
  5569******************************************************************
  5570*                   C H A N G E   L O G
  5571*
  5572* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5573*-----------------------------------------------------------------
  5574*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5575* EFFECTIVE    NUMBER
  5576*-----------------------------------------------------------------
  5577* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5578******************************************************************
  5579
  5580 01  CERT-NOTE-FILE.
  5581     12  CZ-RECORD-ID                PIC  XX.
  5582         88  VALID-CZ-ID                  VALUE 'CZ'.
  5583
  5584     12  CZ-CONTROL-PRIMARY.
  5585         16  CZ-COMPANY-CD           PIC X.
  5586         16  CZ-CARRIER              PIC X.
  5587         16  CZ-GROUPING.
  5588             20 CZ-GROUPING-PREFIX   PIC XXX.
  5589             20 CZ-GROUPING-PRIME    PIC XXX.
  5590         16  CZ-STATE                PIC XX.
  5591         16  CZ-ACCOUNT.
  5592             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5593             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5594         16  CZ-CERT-EFF-DT          PIC XX.
  5595         16  CZ-CERT-NO.
  5596             20  CZ-CERT-PRIME       PIC X(10).
  5597             20  CZ-CERT-SFX         PIC X.
  5598         16  CZ-RECORD-TYPE          PIC X.
  5599             88  CERT-NOTE           VALUE '1'.
  5600             88  CLAIM-CERT-NOTE     VALUE '2'.
  5601         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5602
  5603     12  CZ-LAST-MAINT-DT            PIC XX.
  5604     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5605     12  CZ-LAST-MAINT-USER          PIC X(4).
  5606
  5607     12  CZ-NOTE-INFORMATION.
  5608         16  CZ-NOTE                 PIC X(63).
  5609         16  FILLER                  PIC X(39).
  5610******************************************************************
  5611*                                COPY ELCEOBC.
  5612******************************************************************
  5613*                                                                *
  5614*                                                                *
  5615*                            ELCEOBC                             *
  5616*                            VMOD=2.001                          *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  99
* EL6318.cbl
  5617*                                                                *
  5618*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5619*                                                                *
  5620*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5621*   VSAM EOB CODE TABLE                                          *
  5622*                                                                *
  5623*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5624*                                                                *
  5625*   FILE TYPE = VSAM,KSDS                                        *
  5626*   RECORD SIZE = 350   RECFORM = FIX                            *
  5627*                                                                *
  5628*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5629*                                                                *
  5630*   LOG = NO                                                     *
  5631*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5632*                                                                *
  5633*                                                                *
  5634******************************************************************
  5635*                   C H A N G E   L O G
  5636*
  5637* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5638*-----------------------------------------------------------------
  5639*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5640* EFFECTIVE    NUMBER
  5641*-----------------------------------------------------------------
  5642* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5643* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5644* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  5645******************************************************************
  5646 01  EOB-CODES.
  5647     12  EO-RECORD-ID                      PIC XX.
  5648         88  VALID-DN-ID                      VALUE 'EO'.
  5649     12  EO-CONTROL-PRIMARY.
  5650         16  EO-COMPANY-CD                 PIC X.
  5651         16  EO-RECORD-TYPE                PIC X.
  5652             88  EO-EOB-RECS                  VALUE '1'.
  5653             88  EO-VERIF-RECS                VALUE '2'.
  5654             88  EO-GCE-RECS                  VALUE '3'.
  5655             88  EO-CANC-RECS                 VALUE '4'.
  5656             88  EO-BILL-NOTE-RECS            VALUE '5'.
  5657         16  EO-EOB-CODE                   PIC X(4).
  5658         16  FILLER                        PIC X(9).
  5659     12  EO-MAINT-INFORMATION.
  5660         16  EO-LAST-MAINT-DT              PIC XX.
  5661         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5662         16  EO-LAST-MAINT-USER            PIC X(4).
  5663         16  FILLER                        PIC XX.
  5664     12  EO-DESCRIPTION                    PIC X(275).
  5665     12  FILLER                            PIC X(46).
  5666******************************************************************
  5667*                                COPY ELCCRTT.
  5668******************************************************************
  5669*                                                                *
  5670*                            ELCCRTT.                            *
  5671*                                                                *
  5672*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5673*                                                                *
  5674*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 100
* EL6318.cbl
  5675*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5676*                                                                *
  5677*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5678*                                                                *
  5679*   LOG = YES                                                    *
  5680*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5681******************************************************************
  5682*                   C H A N G E   L O G
  5683*
  5684* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5685*-----------------------------------------------------------------
  5686*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5687* EFFECTIVE    NUMBER
  5688*-----------------------------------------------------------------
  5689* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5690* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5691* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5692* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5693* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5694* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5695* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5696* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5697* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5698* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  5699* 091318  CR2018073000001  PEMA  ADD Refund methods
  5700* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  5701******************************************************************
  5702
  5703 01  CERTIFICATE-TRAILERS.
  5704     12  CS-RECORD-ID                      PIC XX.
  5705         88  VALID-CS-ID                      VALUE 'CS'.
  5706
  5707     12  CS-CONTROL-PRIMARY.
  5708         16  CS-COMPANY-CD                 PIC X.
  5709         16  CS-CARRIER                    PIC X.
  5710         16  CS-GROUPING                   PIC X(6).
  5711         16  CS-STATE                      PIC XX.
  5712         16  CS-ACCOUNT                    PIC X(10).
  5713         16  CS-CERT-EFF-DT                PIC XX.
  5714         16  CS-CERT-NO.
  5715             20  CS-CERT-PRIME             PIC X(10).
  5716             20  CS-CERT-SFX               PIC X.
  5717         16  CS-TRAILER-TYPE               PIC X.
  5718             88  COMM-TRLR           VALUE 'A'.
  5719             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5720             88  CERT-DATA-TRLR      VALUE 'C'.
  5721
  5722     12  CS-DATA-AREA                      PIC X(516).
  5723
  5724     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5725         16  CS-BANK-COMMISSION-AREA.
  5726             20  CS-BANK-COMMS       OCCURS 10.
  5727                 24  CS-AGT                PIC X(10).
  5728                 24  CS-COM-TYP            PIC X.
  5729                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5730                 24  CS-RECALC-LV-INDIC    PIC X.
  5731                 24  FILLER                PIC X(10).
  5732         16  FILLER                        PIC X(256).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 101
* EL6318.cbl
  5733
  5734     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5735****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5736         16  CS-MB-CLAIM-DATA OCCURS 24.
  5737             20  CS-CLAIM-NO               PIC X(7).
  5738             20  CS-CLAIM-TYPE             PIC X.
  5739                 88  CS-AH-CLM               VALUE 'A'.
  5740                 88  CS-IU-CLM               VALUE 'I'.
  5741                 88  CS-GP-CLM               VALUE 'G'.
  5742                 88  CS-LF-CLM               VALUE 'L'.
  5743                 88  CS-PR-CLM               VALUE 'P'.
  5744                 88  CS-FL-CLM               VALUE 'F'.
  5745                 88  CS-OT-CLM               VALUE 'O'.
  5746             20  CS-INSURED-TYPE           PIC X.
  5747                 88  CS-PRIM-INSURED          VALUE 'P'.
  5748                 88  CS-CO-BORROWER           VALUE 'C'.
  5749             20  CS-BENEFIT-PERIOD         PIC 99.
  5750             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5751             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5752             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5753         16  FILLER                        PIC X(12).
  5754     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5755         16  CS-VIN-NUMBER                 PIC X(17).
  5756         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5757         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5758         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5759         16  cs-agent-name.
  5760             20  cs-agent-fname            pic x(20).
  5761             20  cs-agent-mi               pic x.
  5762             20  cs-agent-lname            pic x(25).
  5763         16  cs-license-no                 pic x(15).
  5764         16  cs-npn-number                 pic x(10).
  5765         16  cs-agent-edit-status          pic x.
  5766             88  cs-ae-refer-to-manager      value 'M'.
  5767             88  cs-ae-cover-sheet           value 'C'.
  5768             88  cs-ae-sig-form              value 'S'.
  5769             88  cs-ae-verified              value 'V'.
  5770             88  cs-unidentified-signature   value 'U'.
  5771             88  cs-cert-returned            value 'R'.
  5772             88  cs-accept-no-commission     value 'N'.
  5773         16  cs-year                       pic 9999.
  5774         16  cs-make                       pic x(20).
  5775         16  cs-model                      pic x(20).
  5776         16  cs-future                     pic x(20).
  5777         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5778         16  cs-claim-verification-status  pic x.
  5779             88  cs-clm-ver-eligible         value 'A'.
  5780             88  cs-clm-ver-partial-elig     value 'B'.
  5781             88  cs-clm-ver-not-eligible     value 'C'.
  5782             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  5783             88  cs-clm-ver-not-part-elig-rw value 'E'.
  5784             88  cs-clm-ver-ND-CERT          value 'F'.
  5785             88  cs-clm-ver-spec-other       value 'G'.
  5786             88  cs-clam-ver-pratial-corrected
  5787                                             value 'H'.
  5788             88  cs-clm-ver-no-matches       value 'I'.
  5789             88  cs-clm-ver-not-elig-corrected
  5790                                             value 'J'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 102
* EL6318.cbl
  5791             88  cs-clm-ver-needs-review     value 'R'.
  5792             88  cs-clm-ver-sent-to-claims   value 'W'.
  5793         16  CS-LF-REFUND-METHOD           PIC X.
  5794         16  CS-AH-REFUND-METHOD           PIC X.
  5795         16  FILLER                        PIC X(353). *> was 420
  5796*        16  FILLER                        PIC X(496).
  5797*                                COPY ELCENCC.
  5798******************************************************************
  5799*                                                                *
  5800*                                                                *
  5801*                            ELCENCC                             *
  5802*                            VMOD=2.001                          *
  5803*                                                                *
  5804*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5805*                                                                *
  5806*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5807*   A NAPERSOFT DOCUMENT                                         *
  5808*                                                                *
  5809*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5810*                                                                *
  5811*   FILE TYPE = VSAM,KSDS                                        *
  5812*   RECORD SIZE = 400   RECFORM = FIX                            *
  5813*                                                                *
  5814*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5815*                                                                *
  5816*   LOG = NO                                                     *
  5817*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5818*                                                                *
  5819*                                                                *
  5820******************************************************************
  5821*                   C H A N G E   L O G
  5822*
  5823* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5824*-----------------------------------------------------------------
  5825*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5826* EFFECTIVE    NUMBER
  5827*-----------------------------------------------------------------
  5828* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5829* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  5830******************************************************************
  5831 01  ENCLOSURE-CODES.
  5832     12  NC-RECORD-ID                      PIC XX.
  5833         88  VALID-NC-ID                      VALUE 'NC'.
  5834     12  NC-CONTROL-PRIMARY.
  5835         16  NC-COMPANY-CD                 PIC X.
  5836         16  NC-REC-TYPE                   PIC X.
  5837             88  NC-CLAIMS                   VALUE '1'.
  5838             88  NC-ADMIN                    VALUE '2'.
  5839         16  NC-ENC-CODE                   PIC X(5).
  5840         16  FILLER                        PIC X(09).
  5841     12  NC-MAINT-INFORMATION.
  5842         16  NC-LAST-MAINT-DT              PIC XX.
  5843         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5844         16  NC-LAST-MAINT-USER            PIC X(4).
  5845         16  FILLER                        PIC XX.
  5846     12  NC-OUTPUT-STACK                   PIC XXX.
  5847     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5848     12  NC-ATTACHMENTS                    PIC X(255).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 103
* EL6318.cbl
  5849     12  NC-FUTURE                         PIC X(12).
  5850******************************************************************
  5851 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5852                          ACCOUNT-MASTER CONTROL-FILE
  5853                          PENDING-BUSINESS CERTIFICATE-MASTER
  5854                          ORIGINAL-CERTIFICATE
  5855                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5856                          MAILING-DATA LETTER-ARCHIVE
  5857                          CERT-NOTE-FILE EOB-CODES
  5858                          CERTIFICATE-TRAILERS ENCLOSURE-CODES.
  5859 0000-DFHEXIT SECTION.
  5860     MOVE '9#                    $   ' TO DFHEIV0.
  5861     MOVE 'EL6318' TO DFHEIV1.
  5862     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5863     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5864     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5865     MOVE '5'                    TO DC-OPTION-CODE
  5866     PERFORM 9700-DATE-LINK
  5867     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5868     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5869     MOVE EIBTRMID               TO QID-TERM
  5870     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5871     IF EIBCALEN = 0
  5872        GO TO 8800-UNAUTHORIZED-ACCESS
  5873     END-IF
  5874     MOVE FUNCTION LENGTH(EL631KI) TO MAP-LENGTH
  5875     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5876        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5877           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5878           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5879           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5880           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5881           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5882           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5883           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5884           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5885           MOVE LOW-VALUES           TO EL631KI
  5886           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5887           GO TO 0350-BUILD-INIT-MAP
  5888        END-IF
  5889     END-IF
  5890     IF PI-CALLING-PROGRAM = 'EL614'
  5891        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5892                                 TO WS-PASSED-REASON-CODES
  5893        IF WS-PASSED-REASON-CODES NOT = SPACES
  5894           MOVE 'Y'                TO WS-SET-CODES-MDT
  5895        ELSE
  5896           MOVE 'N'                TO WS-SET-CODES-MDT
  5897        END-IF
  5898        PERFORM 0600-RECOVER-TEMP-STORAGE
  5899                                 THRU 0600-EXIT
  5900        GO TO 0350-BUILD-INIT-MAP
  5901     END-IF
  5902     IF PI-CALLING-PROGRAM = 'EL677'
  5903        move pi-el677-check-cut  to ws-el677-check-cut
  5904        move pi-el677-check-type to ws-el677-check-type
  5905        PERFORM 0600-RECOVER-TEMP-STORAGE
  5906                                 THRU 0600-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 104
* EL6318.cbl
  5907        move ws-el677-check-cut  to pi-check-cut
  5908        move ws-el677-check-type to pi-check-type
  5909        GO TO 0350-BUILD-INIT-MAP
  5910     END-IF
  5911     if (eibaid = dfhclear or dfhpf23 or dfhpf24)
  5912        and (pi-check-cut = 'Y')
  5913        MOVE ER-3844             TO EMI-ERROR
  5914        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5915        GO TO 0350-BUILD-INIT-MAP
  5916     end-if
  5917     IF EIBAID = DFHCLEAR
  5918        IF PI-CLEAR-ERROR
  5919           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5920           MOVE ER-3833           TO EMI-ERROR
  5921           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5922           GO TO 0350-BUILD-INIT-MAP
  5923        ELSE
  5924           GO TO 9400-CLEAR
  5925        END-IF
  5926     END-IF
  5927     .
  5928 0200-RECEIVE.
  5929     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5930        MOVE ER-0008             TO EMI-ERROR
  5931        PERFORM 9900-ERROR-FORMAT
  5932                                 THRU 9900-EXIT
  5933        MOVE -1                  TO PFENTRL
  5934        GO TO 8100-SEND-INITIAL-MAP
  5935     END-IF
  5936
  5937* EXEC CICS RECEIVE
  5938*        MAP      (MAP-NAME)
  5939*        MAPSET   (MAPSET-NAME)
  5940*        INTO     (EL631KI)
  5941*    END-EXEC
  5942     MOVE LENGTH OF
  5943      EL631KI
  5944       TO DFHEIV11
  5945*    MOVE '8"T I  L              ''   #00005932' TO DFHEIV0
  5946     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5947     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5948     MOVE X'2020233030303035393332' TO DFHEIV0(25:11)
  5949     CALL 'kxdfhei1' USING DFHEIV0,
  5950           MAP-NAME,
  5951           EL631KI,
  5952           DFHEIV11,
  5953           MAPSET-NAME,
  5954           DFHEIV99,
  5955           DFHEIV99
  5956     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5957     IF PFENTRL = 0
  5958         GO TO 0300-CHECK-PFKEYS
  5959     END-IF
  5960     IF EIBAID NOT = DFHENTER
  5961         MOVE ER-0004            TO EMI-ERROR
  5962         GO TO 0320-INPUT-ERROR
  5963     END-IF
  5964     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 105
* EL6318.cbl
  5965        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5966     ELSE
  5967        MOVE ER-0029            TO EMI-ERROR
  5968        GO TO 0320-INPUT-ERROR
  5969     END-IF
  5970     .
  5971 0300-CHECK-PFKEYS.
  5972     IF EIBAID = DFHPF3
  5973        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5974        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5975        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5976        MOVE 'EL614'             TO PGM-NAME
  5977        MOVE PI-REASON-CODE-IND  TO WS-SAVE-REASON-CODE-IND
  5978        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5979        move +1                  to s2
  5980        perform varying s1 from +1 by +1 until s1 > +12
  5981           if reacd-in (s1) not = spaces and low-values
  5982              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5983              add +5 to s2
  5984           end-if
  5985        END-perform
  5986        MOVE WS-SAVE-REASON-CODE-IND TO PI-REASON-CODE-IND
  5987        GO TO 9300-XCTL
  5988     END-IF
  5989     IF (EIBAID = DFHPF4 OR DFHPF8)
  5990        and (vouchi = 'Y')
  5991        and (pi-check-cut not = 'Y')
  5992        MOVE ER-3845             TO EMI-ERROR
  5993        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5994        GO TO 0350-BUILD-INIT-MAP
  5995     end-if
  5996     IF EIBAID = DFHPF4 OR DFHPF8
  5997        GO TO 0360-FINALIZE
  5998     END-IF
  5999     IF (EIBAID = DFHPF5)
  6000        and (pi-endt-prm-diff > zeros)
  6001        PERFORM 0500-CREATE-TEMP-STORAGE
  6002                                 THRU 0500-EXIT
  6003        MOVE 'EL677'             TO PGM-NAME
  6004        move pi-endt-prm-diff    to pi-el677-prm-diff
  6005        move pi-endt-com-diff    to pi-el677-com-diff
  6006        move pi-check-cut        to pi-el677-check-cut
  6007        GO TO 9300-XCTL
  6008     END-IF
  6009     IF EIBAID = DFHPF23
  6010        IF PI-CLEAR-ERROR
  6011           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  6012           MOVE ER-3833           TO EMI-ERROR
  6013           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6014           GO TO 0350-BUILD-INIT-MAP
  6015        ELSE
  6016           GO TO 8810-PF23
  6017        END-IF
  6018     END-IF
  6019     IF EIBAID = DFHPF24
  6020        IF PI-CLEAR-ERROR
  6021           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  6022           MOVE ER-3833           TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 106
* EL6318.cbl
  6023           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6024           GO TO 0350-BUILD-INIT-MAP
  6025        ELSE
  6026           GO TO 9200-RETURN-MAIN-MENU
  6027        END-IF
  6028     END-IF
  6029     IF EIBAID = DFHPF12
  6030        GO TO 9500-PF12
  6031     END-IF
  6032     IF EIBAID = DFHENTER
  6033        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  6034        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  6035        GO TO 0330-CHECK-ERRORS
  6036     END-IF
  6037     MOVE ER-0029                TO EMI-ERROR
  6038     .
  6039 0320-INPUT-ERROR.
  6040     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6041     MOVE AL-UNBON               TO PFENTRA
  6042     MOVE -1                     TO PFENTRL
  6043     GO TO 8200-SEND-DATAONLY
  6044     .
  6045 0325-EDIT-SCREEN.
  6046     IF PRTSWL > ZEROS
  6047       IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  6048*          MOVE AL-UANON       TO PRTSWA
  6049*          IF PRTSWI = ' '
  6050*             MOVE 'N'         TO PRTSWI
  6051              MOVE 'P'         TO PRTSWI
  6052*          END-IF
  6053*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  6054        END-IF
  6055     END-IF
  6056     IF LTRIDL > ZEROS
  6057        AND LTRIDI > SPACES
  6058        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  6059        MOVE LTRIDI              TO LETR-LETTER-ID
  6060                                    PI-LTRID-ENTERED
  6061        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  6062        MOVE SPACES              TO LETR-FILLER
  6063        MOVE 0                   TO LETR-SEQ-NO
  6064        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  6065     ELSE
  6066        MOVE ER-1236          TO EMI-ERROR
  6067        MOVE -1               TO LTRIDL
  6068        MOVE AL-UABON         TO LTRIDA
  6069        PERFORM 9900-ERROR-FORMAT
  6070                                 THRU 9900-EXIT
  6071     END-IF
  6072
  6073     IF W-SIG-FLAG-DEFAULT > ' '
  6074        IF (SIGREQL > ZERO AND SIGREQI <> W-SIG-FLAG-DEFAULT)
  6075             MOVE W-SIG-FLAG-DEFAULT TO SIGREQI
  6076             MOVE +1 TO SIGREQL
  6077             MOVE ER-1664     TO EMI-ERROR
  6078             MOVE AL-UABON    TO SIGREQA
  6079             PERFORM 9900-ERROR-FORMAT
  6080                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 107
* EL6318.cbl
  6081        ELSE
  6082             MOVE W-SIG-FLAG-DEFAULT TO SIGREQI
  6083             MOVE +1 TO SIGREQL
  6084             MOVE AL-UANON    TO SIGREQA
  6085        END-IF
  6086     END-IF
  6087
  6088     IF (SIGREQL > ZEROS)
  6089        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  6090        MOVE AL-UANON         TO SIGREQA
  6091        IF SIGREQI = ' '
  6092           MOVE 'N'           TO SIGREQI
  6093        END-IF
  6094        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  6095     ELSE
  6096        MOVE ER-2651          TO EMI-ERROR
  6097        MOVE -1               TO SIGREQL
  6098        MOVE AL-UABON         TO SIGREQA
  6099        PERFORM 9900-ERROR-FORMAT
  6100                                 THRU 9900-EXIT
  6101     END-IF
  6102
  6103     IF W-PROMPT-LETTER EQUAL 'Y'
  6104         MOVE ER-0894            TO EMI-ERROR
  6105         MOVE -1                 TO LTRIDL
  6106         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6107     END-IF
  6108     IF VOUCHL > ZEROS
  6109        IF VOUCHI = 'Y' OR 'N'
  6110           MOVE AL-UANON         TO VOUCHA
  6111           MOVE VOUCHI           TO PI-VOUCHER-ENTERED
  6112        ELSE
  6113           MOVE ER-9999          TO EMI-ERROR
  6114           MOVE -1               TO VOUCHL
  6115           MOVE AL-UABON         TO VOUCHA
  6116           PERFORM 9900-ERROR-FORMAT
  6117                                 THRU 9900-EXIT
  6118        END-IF
  6119     END-IF
  6120     IF HLTHAPPL > ZEROS
  6121        IF HLTHAPPI = 'Y' OR 'N'
  6122           MOVE AL-UANON         TO HLTHAPPA
  6123           MOVE HLTHAPPI         TO PI-HLTHAPP-ENTERED
  6124        ELSE
  6125           MOVE ER-9999          TO EMI-ERROR
  6126           MOVE -1               TO HLTHAPPL
  6127           MOVE AL-UABON         TO HLTHAPPA
  6128           PERFORM 9900-ERROR-FORMAT
  6129                                 THRU 9900-EXIT
  6130        END-IF
  6131     END-IF
  6132     IF PAYEEL > ZEROS
  6133        IF PAYEEI > SPACES
  6134           MOVE AL-UANON         TO PAYEEA
  6135           MOVE PAYEEI           TO PI-PAYEE-ENTERED
  6136        ELSE
  6137           MOVE ER-9999          TO EMI-ERROR
  6138           MOVE -1               TO PAYEEL
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 108
* EL6318.cbl
  6139           MOVE AL-UABON         TO PAYEEA
  6140           PERFORM 9900-ERROR-FORMAT
  6141                                 THRU 9900-EXIT
  6142        END-IF
  6143     END-IF
  6144     IF CERTIDL > ZEROS
  6145         IF CERTIDI NUMERIC
  6146            MOVE AL-UANON      TO CERTIDA
  6147            MOVE CERTIDI       TO PI-CERTID-ENTERED
  6148         ELSE
  6149            MOVE ER-1778       TO EMI-ERROR
  6150            MOVE -1            TO CERTIDL
  6151            MOVE AL-UABON      TO CERTIDA
  6152            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6153        END-IF
  6154     ELSE
  6155        IF PI-PRINT-CERTIFICATE = 'Y'
  6156            MOVE ER-0715       TO EMI-ERROR
  6157            MOVE -1            TO CERTIDL
  6158            MOVE AL-UABON      TO CERTIDA
  6159            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6160        END-IF
  6161     END-IF
  6162
  6163     IF ENCCODEL > ZEROS
  6164        MOVE FUNCTION UPPER-CASE(ENCCODEI) TO ENCCODEI
  6165                                              PI-ENCCODE
  6166        MOVE SPACES             TO WS-ELENCC-KEY
  6167        MOVE PI-COMPANY-CD      TO WS-ENCC-COMPANY-CD
  6168        MOVE '2'                TO WS-ENCC-REC-TYPE
  6169        MOVE ENCCODEI           TO WS-ENCC-ENC-CODE
  6170
  6171
  6172* EXEC CICS READ
  6173*           DATASET    (WS-ELENCC-FILE-ID)
  6174*           SET        (ADDRESS OF ENCLOSURE-CODES)
  6175*           RIDFLD     (WS-ELENCC-KEY)
  6176*           RESP       (WS-RESPONSE)
  6177*       END-EXEC
  6178*    MOVE '&"S        E          (  N#00006151' TO DFHEIV0
  6179     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6181     MOVE X'204E233030303036313531' TO DFHEIV0(25:11)
  6182     CALL 'kxdfhei1' USING DFHEIV0,
  6183           WS-ELENCC-FILE-ID,
  6184           DFHEIV20,
  6185           DFHEIV99,
  6186           WS-ELENCC-KEY,
  6187           DFHEIV99,
  6188           DFHEIV99,
  6189           DFHEIV99
  6190     SET ADDRESS OF ENCLOSURE-CODES TO
  6191         DFHEIV20
  6192     MOVE EIBRESP  TO WS-RESPONSE
  6193     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6194
  6195        IF RESP-NORMAL
  6196           MOVE ENCCODEI         TO PI-ENCCODE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 109
* EL6318.cbl
  6197                                    W-ENCLOSURE-CD
  6198           MOVE AL-UANON         TO ENCCODEA
  6199        ELSE
  6200           MOVE ER-1560          TO EMI-ERROR
  6201           MOVE -1               TO ENCCODEL
  6202           MOVE AL-UABON         TO ENCCODEA
  6203           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6204        END-IF
  6205     END-IF
  6206
  6207     SET REASONS-NOT-FOUND TO TRUE
  6208     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6209        IF REACDL (S1) = +4 OR
  6210          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6211              MOVE AL-SANON     TO REACDA (S1)
  6212              SET REASONS-FOUND TO TRUE
  6213        END-IF
  6214     END-PERFORM
  6215
  6216     IF REASONS-NOT-FOUND
  6217        MOVE ER-1820             TO EMI-ERROR
  6218        MOVE -1                  TO PFENTRL
  6219        PERFORM 9900-ERROR-FORMAT
  6220                                 THRU 9900-EXIT
  6221     ELSE
  6222        MOVE REASONCDS           TO PI-REASONS-ENTERED
  6223     END-IF
  6224
  6225     IF CRTNT1L > ZEROS
  6226        IF CRTNT1I > SPACES
  6227           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  6228        END-IF
  6229     END-IF
  6230
  6231     IF CRTNT2L > ZEROS
  6232        IF CRTNT2I > SPACES
  6233           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  6234        END-IF
  6235     END-IF
  6236
  6237     IF CRTNT3L > ZEROS
  6238        IF CRTNT3I > SPACES
  6239           MOVE CRTNT3I          TO PI-CERTNT3-ENTERED
  6240        END-IF
  6241     END-IF
  6242
  6243     IF CRTNT4L > ZEROS
  6244        IF CRTNT4I > SPACES
  6245           MOVE CRTNT4I          TO PI-CERTNT4-ENTERED
  6246        END-IF
  6247     END-IF
  6248
  6249     IF BILNT1L > ZEROS
  6250        IF BILNT1I > SPACES
  6251           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  6252        END-IF
  6253     END-IF
  6254
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 110
* EL6318.cbl
  6255     IF BILNT2L > ZEROS
  6256        IF BILNT2I > SPACES
  6257           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  6258        END-IF
  6259     END-IF
  6260
  6261     .
  6262 0325-EXIT.
  6263     EXIT.
  6264
  6265 0326-GET-Z-RECORD.
  6266
  6267     MOVE SPACES  TO W-Z-CONTROL-DATA
  6268
  6269
  6270* EXEC CICS STARTBR
  6271*         DATASET    ('ELLETR')
  6272*         RIDFLD     (ELLETR-KEY)
  6273*         GTEQ
  6274*         RESP      (WS-RESPONSE)
  6275*    END-EXEC.
  6276     MOVE 'ELLETR' TO DFHEIV1
  6277     MOVE 0
  6278       TO DFHEIV11
  6279*    MOVE '&,         G          &  N#00006232' TO DFHEIV0
  6280     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6281     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6282     MOVE X'204E233030303036323332' TO DFHEIV0(25:11)
  6283     CALL 'kxdfhei1' USING DFHEIV0,
  6284           DFHEIV1,
  6285           ELLETR-KEY,
  6286           DFHEIV99,
  6287           DFHEIV11,
  6288           DFHEIV99
  6289     MOVE EIBRESP  TO WS-RESPONSE
  6290     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6291
  6292     IF NOT RESP-NORMAL
  6293         MOVE ER-1236          TO EMI-ERROR
  6294         MOVE -1               TO LTRIDL
  6295         MOVE AL-UABON         TO LTRIDA
  6296         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6297         GO TO 0326-ENDBR
  6298     END-IF.
  6299
  6300 0326-READNEXT.
  6301
  6302
  6303* EXEC CICS READNEXT
  6304*        DATASET   ('ELLETR')
  6305*        INTO      (TEXT-FILES)
  6306*        RIDFLD    (ELLETR-KEY)
  6307*        RESP      (WS-RESPONSE)
  6308*    END-EXEC
  6309     MOVE LENGTH OF
  6310      TEXT-FILES
  6311       TO DFHEIV12
  6312     MOVE 'ELLETR' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 111
* EL6318.cbl
  6313     MOVE 0
  6314       TO DFHEIV11
  6315*    MOVE '&.IL                  )  N#00006248' TO DFHEIV0
  6316     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6317     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6318     MOVE X'204E233030303036323438' TO DFHEIV0(25:11)
  6319     CALL 'kxdfhei1' USING DFHEIV0,
  6320           DFHEIV1,
  6321           TEXT-FILES,
  6322           DFHEIV12,
  6323           ELLETR-KEY,
  6324           DFHEIV99,
  6325           DFHEIV11,
  6326           DFHEIV99,
  6327           DFHEIV99
  6328     MOVE EIBRESP  TO WS-RESPONSE
  6329     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6330     IF RESP-NORMAL
  6331        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  6332           MOVE ER-1236          TO EMI-ERROR
  6333           MOVE -1               TO LTRIDL
  6334           MOVE AL-UABON         TO LTRIDA
  6335           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6336           GO TO 0326-ENDBR
  6337        END-IF
  6338
  6339        MOVE AL-UANON         TO LTRIDA
  6340        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  6341           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  6342        ELSE
  6343           GO TO 0326-READNEXT
  6344        END-IF
  6345     ELSE
  6346        MOVE ER-1236          TO EMI-ERROR
  6347        MOVE -1               TO LTRIDL
  6348        MOVE AL-UABON         TO LTRIDA
  6349        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6350        GO TO 0326-ENDBR
  6351     END-IF.
  6352
  6353     MOVE W-PRINT-CERTIFICATE TO PI-PRINT-CERTIFICATE.
  6354     IF PI-ENCCODE NOT GREATER THAN SPACES
  6355         MOVE W-ENCLOSURE-CD            TO PI-ENCCODE
  6356                                           ENCCODEO
  6357         MOVE AL-UANON                  TO ENCCODEA
  6358         MOVE +3                        TO ENCCODEL
  6359     END-IF.
  6360
  6361 0326-ENDBR.
  6362
  6363
  6364* EXEC CICS ENDBR
  6365*        DATASET     ('ELLETR')
  6366*    END-EXEC.
  6367     MOVE 'ELLETR' TO DFHEIV1
  6368     MOVE 0
  6369       TO DFHEIV11
  6370*    MOVE '&2                    $   #00006287' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 112
* EL6318.cbl
  6371     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6372     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6373     MOVE X'2020233030303036323837' TO DFHEIV0(25:11)
  6374     CALL 'kxdfhei1' USING DFHEIV0,
  6375           DFHEIV1,
  6376           DFHEIV11,
  6377           DFHEIV99
  6378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6379
  6380
  6381 0326-EXIT.
  6382      EXIT.
  6383 0330-CHECK-ERRORS.
  6384     IF EMI-NO-ERRORS
  6385        GO TO 0350-BUILD-INIT-MAP
  6386     ELSE
  6387        GO TO 8200-SEND-DATAONLY
  6388     END-IF
  6389     .
  6390 0330-EXIT.
  6391     EXIT.
  6392 0350-BUILD-INIT-MAP.
  6393     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6394        MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  6395        MOVE PI-CARRIER             TO CRTO-CARRIER
  6396        MOVE PI-GROUPING            TO CRTO-GROUPING
  6397        MOVE PI-STATE               TO CRTO-STATE
  6398        MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  6399        MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  6400        MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  6401        MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  6402        MOVE 'I'                    TO CRTO-RECORD-TYPE
  6403        MOVE ZEROS                  TO CRTO-SEQ-NO
  6404        MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  6405                                       PI-ERENDT-KEY
  6406     END-IF
  6407     MOVE PI-CRTO-CARRIER        TO CARRO
  6408     MOVE PI-CRTO-GROUPING       TO GROUPO
  6409     MOVE PI-CRTO-STATE          TO STATEO
  6410     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  6411     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  6412     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  6413     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  6414     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  6415     MOVE ' '                    TO DC-OPTION-CODE
  6416     PERFORM 9700-DATE-LINK
  6417     IF NO-CONVERSION-ERROR
  6418        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6419     END-IF
  6420*     IF PI-PRTSW-ENTERED > SPACES
  6421*        MOVE PI-PRTSW-ENTERED    TO PRTSWI
  6422*        MOVE AL-UANON            TO PRTSWA
  6423*        MOVE +1                  TO PRTSWL
  6424*     END-IF
  6425
  6426     IF PI-SIGREQ-ENTERED > SPACES
  6427        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  6428        MOVE AL-UANON            TO SIGREQA
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 113
* EL6318.cbl
  6429        MOVE +1                  TO SIGREQL
  6430     ELSE
  6431        IF PI-CLAIM-REFORMATION
  6432            MOVE 'Y'             TO SIGREQI
  6433            MOVE AL-UANON        TO SIGREQA
  6434            MOVE +1              TO SIGREQL
  6435        END-IF
  6436     END-IF
  6437
  6438     IF PI-LTRID-ENTERED > SPACES
  6439        MOVE PI-LTRID-ENTERED    TO LTRIDI
  6440        MOVE AL-UANON            TO LTRIDA
  6441        MOVE +4                  TO LTRIDL
  6442     ELSE
  6443        IF PI-CLAIM-REFORMATION
  6444            MOVE 'CLRF'          TO LTRIDI
  6445            MOVE AL-UANON        TO LTRIDA
  6446            MOVE +4              TO LTRIDL
  6447        END-IF
  6448     END-IF
  6449
  6450     if pi-endt-prm-diff > zeros
  6451        move 'Y'                 to vouchi
  6452        MOVE AL-UANON            TO VOUCHA
  6453        MOVE +1                  TO VOUCHL
  6454     END-IF
  6455     IF PI-VOUCHER-ENTERED > SPACES
  6456        MOVE PI-VOUCHER-ENTERED  TO VOUCHI
  6457        MOVE AL-UANON            TO VOUCHA
  6458        MOVE +1                  TO VOUCHL
  6459     END-IF
  6460     IF PI-HLTHAPP-ENTERED > SPACES
  6461        MOVE PI-HLTHAPP-ENTERED  TO HLTHAPPI
  6462        MOVE AL-UANON            TO HLTHAPPA
  6463        MOVE +1                  TO HLTHAPPL
  6464     END-IF
  6465
  6466     IF PI-PAYEE-ENTERED > SPACES
  6467        MOVE PI-PAYEE-ENTERED    TO PAYEEI
  6468        MOVE AL-UANON            TO PAYEEA
  6469        MOVE +10                 TO PAYEEL
  6470     END-IF
  6471
  6472     IF PI-CERTID-ENTERED > SPACES
  6473        MOVE PI-CERTID-ENTERED   TO CERTIDI
  6474        MOVE AL-UANON            TO CERTIDA
  6475        MOVE +5                  TO CERTIDL
  6476     END-IF
  6477
  6478     IF PI-ENCCODE > SPACES
  6479        MOVE PI-ENCCODE          TO ENCCODEI
  6480        MOVE AL-UANON            TO ENCCODEA
  6481        MOVE +3                  TO ENCCODEL
  6482     END-IF
  6483
  6484     SET REASONS-NOT-FOUND TO TRUE
  6485     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6486     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 114
* EL6318.cbl
  6487        IF REACDL (S1) = +4 OR
  6488          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6489              MOVE AL-SANON      TO REACDA (S1)
  6490              MOVE +4            TO REACDL (S1)
  6491              SET REASONS-FOUND  TO TRUE
  6492        END-IF
  6493     END-PERFORM
  6494
  6495     IF REASONS-NOT-FOUND
  6496         IF PI-CLAIM-REFORMATION
  6497            MOVE 'CRNA'          TO REACD-IN (1)
  6498            MOVE AL-SANON        TO REACDA (1)
  6499            MOVE +4              TO REACDL (1)
  6500            SET REASONS-FOUND    TO TRUE
  6501        END-IF
  6502     END-IF
  6503
  6504     IF PI-CERTNT1-ENTERED > SPACES
  6505        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6506        MOVE AL-UANON            TO CRTNT1A
  6507        MOVE +63                 TO CRTNT1L
  6508     END-IF
  6509
  6510     IF PI-CERTNT2-ENTERED > SPACES
  6511        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6512        MOVE AL-UANON            TO CRTNT2A
  6513        MOVE +63                 TO CRTNT2L
  6514     END-IF
  6515
  6516     IF PI-CERTNT3-ENTERED > SPACES
  6517        MOVE PI-CERTNT3-ENTERED  TO CRTNT3I
  6518        MOVE AL-UANON            TO CRTNT3A
  6519        MOVE +63                 TO CRTNT3L
  6520     END-IF
  6521
  6522     IF PI-CERTNT4-ENTERED > SPACES
  6523        MOVE PI-CERTNT4-ENTERED  TO CRTNT4I
  6524        MOVE AL-UANON            TO CRTNT4A
  6525        MOVE +63                 TO CRTNT4L
  6526     END-IF
  6527
  6528     IF PI-BILLNT1-ENTERED > SPACES
  6529        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6530        MOVE AL-UANON            TO BILNT1A
  6531        MOVE +63                 TO BILNT1L
  6532     END-IF
  6533
  6534     IF PI-BILLNT2-ENTERED > SPACES
  6535        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  6536        MOVE AL-UANON            TO BILNT2A
  6537        MOVE +63                 TO BILNT2L
  6538     END-IF
  6539
  6540     GO TO 8100-SEND-INITIAL-MAP
  6541     .
  6542 0360-FINALIZE.
  6543     set P to address of KIXSYS
  6544     CALL "getenv" using by value P returning var-ptr
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 115
* EL6318.cbl
  6545     if var-ptr = null then
  6546        display ' kixsys not set '
  6547     else
  6548        set address of var to var-ptr
  6549        move 0 to env-var-len
  6550        inspect var tallying env-var-len
  6551          for characters before X'00'
  6552*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6553        unstring var (1:env-var-len) delimited by '/'
  6554           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6555              WS-KIX-SYS
  6556        end-unstring
  6557*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  6558*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6559     end-if
  6560     set P to address of KIXHOST
  6561     CALL "getenv" using by value P returning var-ptr
  6562     if var-ptr = null then
  6563        display ' kixhost not set '
  6564     else
  6565        set address of var to var-ptr
  6566        move 0 to env-var-len
  6567        inspect var tallying env-var-len
  6568          for characters before X'00'
  6569*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6570        MOVE var(1:env-var-len)  to ws-kixhost
  6571        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6572     end-if
  6573     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  6574     IF NOT EMI-NO-ERRORS
  6575       AND EIBAID = DFHPF4
  6576        GO TO 8200-SEND-DATAONLY
  6577     END-IF
  6578     MOVE LOW-VALUES             TO NEW-ELCRTO-REC
  6579     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6580                                    NEW-ELCRTO-KEY
  6581     SUBTRACT +1               FROM NCRTO-SEQ-NO
  6582     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6583     IF RESP-NORMAL
  6584       AND (PI-ELCRTO-KEY (1:33) = OC-CONTROL-PRIMARY (1:33))
  6585        MOVE OC-KEY-SEQ-NO       TO CRTO-SEQ-NO
  6586                                    PI-CRTO-SEQ-NO
  6587        MOVE LOW-VALUES          TO NEW-ELCRTO-REC
  6588        MOVE PI-ELCRTO-KEY       TO NEW-ELCRTO-KEY
  6589        SUBTRACT +1              FROM NCRTO-SEQ-NO
  6590        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6591*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6592        PERFORM 1100-CALL-NS-BUS-LOGIC
  6593                                 THRU 1100-EXIT
  6594        IF BL-OK
  6595           CONTINUE
  6596        ELSE
  6597           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6598           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6599           MOVE -1               TO SIGREQL
  6600        END-IF
  6601        IF EIBAID = DFHPF4
  6602           move ' '              to ws-elcrtt-update-sw
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 116
* EL6318.cbl
  6603           move pi-elcrto-key(1:33)
  6604                                 to ws-elcrtt-primary
  6605           move 'C'              to ws-elcrtt-rec-type
  6606
  6607* EXEC CICS READ UPDATE
  6608*             DATASET  (WS-ELCRTT-FILE-ID)
  6609*             RIDFLD   (WS-ELCRTT-KEY)
  6610*             SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  6611*             RESP     (WS-RESPONSE)
  6612*          END-EXEC
  6613*    MOVE '&"S        EU         (  N#00006516' TO DFHEIV0
  6614     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6615     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6616     MOVE X'204E233030303036353136' TO DFHEIV0(25:11)
  6617     CALL 'kxdfhei1' USING DFHEIV0,
  6618           WS-ELCRTT-FILE-ID,
  6619           DFHEIV20,
  6620           DFHEIV99,
  6621           WS-ELCRTT-KEY,
  6622           DFHEIV99,
  6623           DFHEIV99,
  6624           DFHEIV99
  6625     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  6626         DFHEIV20
  6627     MOVE EIBRESP  TO WS-RESPONSE
  6628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6629           if resp-normal
  6630              if cs-claim-verification-status = 'B' or 'C'
  6631                 or 'D' or 'E' or 'F' or 'G'
  6632                 move 'H'        to cs-claim-verification-status
  6633                 set update-elcrtt to true
  6634              end-if
  6635              if update-elcrtt
  6636
  6637* EXEC CICS REWRITE
  6638*                   DATASET    (ws-elcrtt-FILE-ID)
  6639*                   FROM       (CERTIFICATE-TRAILERS)
  6640*                END-EXEC
  6641     MOVE LENGTH OF
  6642      CERTIFICATE-TRAILERS
  6643       TO DFHEIV11
  6644*    MOVE '&& L                  %   #00006529' TO DFHEIV0
  6645     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6646     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6647     MOVE X'2020233030303036353239' TO DFHEIV0(25:11)
  6648     CALL 'kxdfhei1' USING DFHEIV0,
  6649           ws-elcrtt-FILE-ID,
  6650           CERTIFICATE-TRAILERS,
  6651           DFHEIV11,
  6652           DFHEIV99
  6653     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6654              else
  6655
  6656* exec cics unlock
  6657*                   dataset    (ws-elcrtt-FILE-ID)
  6658*                end-exec
  6659*    MOVE '&*                    #   #00006534' TO DFHEIV0
  6660     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 117
* EL6318.cbl
  6661     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  6662     MOVE X'2020233030303036353334' TO DFHEIV0(25:11)
  6663     CALL 'kxdfhei1' USING DFHEIV0,
  6664           ws-elcrtt-FILE-ID,
  6665           DFHEIV99
  6666     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6667              end-if
  6668           end-if
  6669        end-if
  6670     ELSE
  6671        MOVE ER-9999             TO EMI-ERROR
  6672        PERFORM 9900-ERROR-FORMAT
  6673                                 THRU 9900-EXIT
  6674        MOVE -1                  TO SIGREQL
  6675        GO TO 8100-SEND-INITIAL-MAP
  6676     END-IF
  6677     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6678                                 TO SYSO
  6679     MOVE WS-KIXHOST             TO HOSTO
  6680     MOVE PI-COMPANY-ID          TO COMPANYO
  6681     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  6682         MOVE '2'                TO DATASORO
  6683     ELSE
  6684         MOVE '4'                TO DATASORO
  6685     END-IF
  6686     MOVE BL-BATCH-NO            TO BATCHNOO
  6687     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6688     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6689     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6690*    MOVE 'N'                    TO PRTSWO
  6691*    MOVE -1                     TO PRTSWL
  6692*    MOVE AL-UANON               TO PRTSWA
  6693     MOVE -1                     TO SIGREQL
  6694     MOVE AL-UANON               TO SIGREQA
  6695     IF EIBAID = DFHPF4
  6696        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6697        MOVE ER-0280             TO EMI-ERROR
  6698        PERFORM 9900-ERROR-FORMAT
  6699                                 THRU 9900-EXIT
  6700        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6701        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6702        MOVE 'Y'                 TO PI-FINALIZED-IND
  6703        GO TO 9400-CLEAR
  6704     ELSE
  6705        MOVE ER-1818             TO EMI-ERROR
  6706        PERFORM 9900-ERROR-FORMAT
  6707                                 THRU 9900-EXIT
  6708     END-IF
  6709     GO TO 0350-BUILD-INIT-MAP
  6710     .
  6711 0360-EXIT.
  6712     EXIT.
  6713 0362-READ-ELCRTO.
  6714
  6715* EXEC CICS READ
  6716*        DATASET   (WS-ELCRTO-FILE-ID)
  6717*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6718*        RIDFLD    (ELCRTO-KEY)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 118
* EL6318.cbl
  6719*        GTEQ
  6720*        RESP      (WS-RESPONSE)
  6721*    END-EXEC
  6722*    MOVE '&"S        G          (  N#00006584' TO DFHEIV0
  6723     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6724     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6725     MOVE X'204E233030303036353834' TO DFHEIV0(25:11)
  6726     CALL 'kxdfhei1' USING DFHEIV0,
  6727           WS-ELCRTO-FILE-ID,
  6728           DFHEIV20,
  6729           DFHEIV99,
  6730           ELCRTO-KEY,
  6731           DFHEIV99,
  6732           DFHEIV99,
  6733           DFHEIV99
  6734     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6735         DFHEIV20
  6736     MOVE EIBRESP  TO WS-RESPONSE
  6737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6738     .
  6739 0362-EXIT.
  6740     EXIT.
  6741 0363-READ-ELCRTO-UPD.
  6742
  6743* EXEC CICS READ
  6744*        DATASET   (WS-ELCRTO-FILE-ID)
  6745*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6746*        RIDFLD    (ELCRTO-KEY)
  6747*        UPDATE
  6748*        RESP      (WS-RESPONSE)
  6749*    END-EXEC
  6750*    MOVE '&"S        EU         (  N#00006595' TO DFHEIV0
  6751     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6752     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6753     MOVE X'204E233030303036353935' TO DFHEIV0(25:11)
  6754     CALL 'kxdfhei1' USING DFHEIV0,
  6755           WS-ELCRTO-FILE-ID,
  6756           DFHEIV20,
  6757           DFHEIV99,
  6758           ELCRTO-KEY,
  6759           DFHEIV99,
  6760           DFHEIV99,
  6761           DFHEIV99
  6762     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6763         DFHEIV20
  6764     MOVE EIBRESP  TO WS-RESPONSE
  6765     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6766     .
  6767 0363-EXIT.
  6768     EXIT.
  6769 0365-READ-ERENDT.
  6770
  6771* EXEC CICS READ
  6772*        DATASET   (WS-ERENDT-FILE-ID)
  6773*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6774*        RIDFLD    (ERENDT-KEY)
  6775*        RESP      (WS-RESPONSE)
  6776*    END-EXEC
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 119
* EL6318.cbl
  6777*    MOVE '&"S        E          (  N#00006606' TO DFHEIV0
  6778     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6779     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6780     MOVE X'204E233030303036363036' TO DFHEIV0(25:11)
  6781     CALL 'kxdfhei1' USING DFHEIV0,
  6782           WS-ERENDT-FILE-ID,
  6783           DFHEIV20,
  6784           DFHEIV99,
  6785           ERENDT-KEY,
  6786           DFHEIV99,
  6787           DFHEIV99,
  6788           DFHEIV99
  6789     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6790         DFHEIV20
  6791     MOVE EIBRESP  TO WS-RESPONSE
  6792     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6793     .
  6794 0365-EXIT.
  6795     EXIT.
  6796 0400-ADD-ERENDT.
  6797     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6798
  6799* EXEC CICS GETMAIN
  6800*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6801*         LENGTH   (ERENDT-LENGTH)
  6802*         INITIMG  (GETMAIN-SPACE)
  6803*    END-EXEC
  6804*    MOVE ',"IL                  $   #00006617' TO DFHEIV0
  6805     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6806     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6807     MOVE X'2020233030303036363137' TO DFHEIV0(25:11)
  6808     CALL 'kxdfhei1' USING DFHEIV0,
  6809           DFHEIV20,
  6810           ERENDT-LENGTH,
  6811           GETMAIN-SPACE
  6812     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6813         DFHEIV20
  6814     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6815     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6816     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6817     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6818     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6819                                    EN-INPUT-DT
  6820                                    EN-PROCESS-DT
  6821
  6822     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6823     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6824     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6825     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6826     MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-ORIG-AGE-DEF-FLAG
  6827     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6828     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6829     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6830     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6831     MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-ORIG-AGE-DEF-FLAG
  6832     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6833     IF OC-LF-BENCD NOT = '00' AND '  '
  6834        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 120
* EL6318.cbl
  6835        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6836        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6837        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6838        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6839        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6840        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6841     END-IF
  6842     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6843     IF OC-AH-BENCD NOT = '00' AND '  '
  6844        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6845        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6846        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6847        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6848        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6849        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6850     END-IF
  6851     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6852
  6853     IF PI-RETURN-TO-PROGRAM EQUAL 'EL6314'
  6854
  6855         MOVE PI-COMPANY-CD       TO  W-CERT-COMPANY-CD
  6856         MOVE PI-CRTO-CARRIER     TO  W-CERT-CARRIER
  6857         MOVE PI-CRTO-GROUPING    TO  W-CERT-GROUPING
  6858         MOVE PI-CRTO-STATE       TO  W-CERT-STATE
  6859         MOVE PI-CRTO-ACCOUNT     TO  W-CERT-ACCOUNT
  6860         MOVE PI-CRTO-CERT-EFF-DT TO  W-CERT-CERT-EFF-DT
  6861         MOVE PI-CRTO-CERT-PRIME  TO  W-CERT-CERT-PRIME
  6862         MOVE PI-CRTO-CERT-SFX    TO  W-CERT-CERT-SFX
  6863
  6864
  6865* EXEC CICS READ
  6866*            DATASET  (WS-ELCERT-FILE-ID)
  6867*            RIDFLD   (WS-ELCERT-KEY)
  6868*            SET      (ADDRESS OF CERTIFICATE-MASTER)
  6869*            RESP     (WS-RESPONSE)
  6870*        END-EXEC
  6871*    MOVE '&"S        E          (  N#00006671' TO DFHEIV0
  6872     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6873     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6874     MOVE X'204E233030303036363731' TO DFHEIV0(25:11)
  6875     CALL 'kxdfhei1' USING DFHEIV0,
  6876           WS-ELCERT-FILE-ID,
  6877           DFHEIV20,
  6878           DFHEIV99,
  6879           WS-ELCERT-KEY,
  6880           DFHEIV99,
  6881           DFHEIV99,
  6882           DFHEIV99
  6883     SET ADDRESS OF CERTIFICATE-MASTER TO
  6884         DFHEIV20
  6885     MOVE EIBRESP  TO WS-RESPONSE
  6886     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6887         IF NOT RESP-NORMAL
  6888            GO TO 0400-EXIT
  6889         END-IF
  6890
  6891         MOVE CM-INSURED-FIRST-NAME TO EN-INS-NEW-FIRST-NAME
  6892                                       NCRTO-INS-FIRST-NAME
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 121
* EL6318.cbl
  6893         MOVE CM-INSURED-INITIAL2   TO EN-INS-NEW-MIDDLE-INIT
  6894                                       NCRTO-INS-MIDDLE-INIT
  6895         MOVE CM-INSURED-LAST-NAME  TO EN-INS-NEW-LAST-NAME
  6896                                       NCRTO-INS-LAST-NAME
  6897         MOVE CM-INSURED-ISSUE-AGE  TO EN-INS-NEW-AGE
  6898                                       NCRTO-INS-AGE
  6899         MOVE CM-JT-FIRST-NAME      TO EN-JNT-NEW-FIRST-NAME
  6900                                       NCRTO-JNT-FIRST-NAME
  6901         MOVE CM-JT-INITIAL         TO EN-JNT-NEW-MIDDLE-INIT
  6902                                       NCRTO-JNT-MIDDLE-INIT
  6903         MOVE CM-JT-LAST-NAME       TO EN-JNT-NEW-LAST-NAME
  6904                                       NCRTO-JNT-LAST-NAME
  6905         MOVE CM-INSURED-JOINT-AGE  TO EN-JNT-NEW-AGE
  6906                                       NCRTO-JNT-AGE
  6907
  6908         MOVE CM-LF-BENEFIT-CD      TO EN-LF-NEW-BENCD
  6909                                       NCRTO-LF-BENCD
  6910         IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  6911            MOVE CM-LF-BENEFIT-AMT  TO EN-LF-NEW-BEN-AMT
  6912                                       NCRTO-LF-BEN-AMT
  6913            MOVE CM-LF-PREMIUM-AMT  TO EN-LF-NEW-PRM-AMT
  6914                                       NCRTO-LF-PRM-AMT
  6915            MOVE CM-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6916                                       NCRTO-LF-ALT-BEN-AMT
  6917            MOVE CM-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6918                                       NCRTO-LF-ALT-PRM-AMT
  6919            MOVE CM-LF-ORIG-TERM    TO EN-LF-NEW-TERM
  6920                                       NCRTO-LF-TERM
  6921            MOVE CM-LF-LOAN-EXPIRE-DT TO EN-LF-NEW-EXP-DT
  6922                                       NCRTO-LF-EXP-DT
  6923            MOVE CM-LIFE-COMM-PCT   TO EN-LF-NEW-COMM-PCT
  6924                                       NCRTO-LF-COMM-PCT
  6925         END-IF
  6926
  6927         MOVE CM-AH-BENEFIT-CD      TO EN-AH-NEW-BENCD
  6928                                       NCRTO-AH-BENCD
  6929         IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  6930            MOVE CM-AH-BENEFIT-AMT  TO EN-AH-NEW-BEN-AMT
  6931                                       NCRTO-AH-BEN-AMT
  6932            MOVE CM-AH-PREMIUM-AMT  TO EN-AH-NEW-PRM-AMT
  6933                                       NCRTO-AH-PRM-AMT
  6934            MOVE CM-AH-ORIG-TERM    TO EN-AH-NEW-TERM
  6935                                       NCRTO-AH-TERM
  6936            MOVE CM-AH-LOAN-EXPIRE-DT TO EN-AH-NEW-EXP-DT
  6937                                       NCRTO-AH-EXP-DT
  6938            MOVE CM-AH-CRITICAL-PERIOD TO EN-AH-NEW-CP
  6939                                       NCRTO-AH-CP
  6940            MOVE CM-AH-COMM-PCT     TO EN-AH-NEW-COMM-PCT
  6941                                       NCRTO-AH-COMM-PCT
  6942         END-IF
  6943
  6944         MOVE CM-LOAN-1ST-PMT-DT    TO NCRTO-1ST-PMT-DT
  6945         MOVE CM-ENTRY-BATCH        TO EN-BATCH-NUMBER
  6946
  6947         GO TO 0400-CONTINUE
  6948     END-IF.
  6949
  6950
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 122
* EL6318.cbl
  6951* EXEC CICS GETMAIN
  6952*         SET      (ADDRESS OF PENDING-BUSINESS)
  6953*         LENGTH   (ERPNDB-LENGTH)
  6954*         INITIMG  (GETMAIN-SPACE)
  6955*    END-EXEC
  6956*    MOVE ',"IL                  $   #00006740' TO DFHEIV0
  6957     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6958     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6959     MOVE X'2020233030303036373430' TO DFHEIV0(25:11)
  6960     CALL 'kxdfhei1' USING DFHEIV0,
  6961           DFHEIV20,
  6962           ERPNDB-LENGTH,
  6963           GETMAIN-SPACE
  6964     SET ADDRESS OF PENDING-BUSINESS TO
  6965         DFHEIV20
  6966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6967     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6968
  6969* EXEC CICS READ
  6970*        DATASET   (WS-ERPNDB-FILE-ID)
  6971*        INTO      (PENDING-BUSINESS)
  6972*        RIDFLD    (ERPNDB-KEY)
  6973*        RESP      (WS-RESPONSE)
  6974*    END-EXEC
  6975     MOVE LENGTH OF
  6976      PENDING-BUSINESS
  6977       TO DFHEIV11
  6978*    MOVE '&"IL       E          (  N#00006746' TO DFHEIV0
  6979     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6980     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6981     MOVE X'204E233030303036373436' TO DFHEIV0(25:11)
  6982     CALL 'kxdfhei1' USING DFHEIV0,
  6983           WS-ERPNDB-FILE-ID,
  6984           PENDING-BUSINESS,
  6985           DFHEIV11,
  6986           ERPNDB-KEY,
  6987           DFHEIV99,
  6988           DFHEIV99,
  6989           DFHEIV99
  6990     MOVE EIBRESP  TO WS-RESPONSE
  6991     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6992     IF NOT RESP-NORMAL
  6993        GO TO 0400-EXIT
  6994     END-IF
  6995*    set found-pndb to true
  6996     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6997                                      NCRTO-INS-FIRST-NAME
  6998     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6999                                      NCRTO-INS-MIDDLE-INIT
  7000     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  7001                                      NCRTO-INS-LAST-NAME
  7002     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  7003                                      NCRTO-INS-AGE
  7004     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  7005                                      NCRTO-JNT-FIRST-NAME
  7006     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  7007                                      NCRTO-JNT-MIDDLE-INIT
  7008     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 123
* EL6318.cbl
  7009                                      NCRTO-JNT-LAST-NAME
  7010     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  7011                                      NCRTO-JNT-AGE
  7012     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  7013                                      NCRTO-LF-BENCD
  7014     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
  7015        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  7016                                      NCRTO-LF-BEN-AMT
  7017        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  7018                                      NCRTO-LF-PRM-AMT
  7019        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  7020                                      NCRTO-LF-ALT-BEN-AMT
  7021        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  7022                                      NCRTO-LF-ALT-PRM-AMT
  7023        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  7024                                      NCRTO-LF-TERM
  7025        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  7026                                      NCRTO-LF-EXP-DT
  7027        IF PB-I-JOINT-COMMISSION > +0
  7028           MOVE PB-I-JOINT-COMMISSION
  7029                                   TO EN-LF-NEW-COMM-PCT
  7030                                      NCRTO-LF-COMM-PCT
  7031        ELSE
  7032           MOVE PB-I-LIFE-COMMISSION
  7033                                   TO EN-LF-NEW-COMM-PCT
  7034                                      NCRTO-LF-COMM-PCT
  7035        END-IF
  7036     END-IF
  7037     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  7038                                      NCRTO-AH-BENCD
  7039     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  7040        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  7041                                      NCRTO-AH-BEN-AMT
  7042        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  7043                                      NCRTO-AH-PRM-AMT
  7044        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  7045                                      NCRTO-AH-TERM
  7046        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  7047                                      NCRTO-AH-EXP-DT
  7048        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  7049                                      NCRTO-AH-CP
  7050        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  7051                                      NCRTO-AH-COMM-PCT
  7052     END-IF
  7053     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  7054     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  7055     .
  7056 0400-CONTINUE.
  7057
  7058     MOVE W-ACCT-SUMM              TO EN-ACCT-SUMM
  7059     MOVE W-CSO-SUMM               TO EN-CSO-SUMM
  7060*     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  7061     MOVE 'Y'                    TO EN-COMM-CHGBK
  7062
  7063     COMPUTE WS-DUE-BORROWER = (EN-LF-ORIG-PRM-AMT
  7064        + EN-LF-ORIG-ALT-PRM-AMT + EN-AH-ORIG-PRM-AMT) -
  7065        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT +
  7066        EN-AH-NEW-PRM-AMT)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 124
* EL6318.cbl
  7067     COMPUTE EN-ACCT-PORTION ROUNDED =
  7068        (((EN-LF-ORIG-PRM-AMT + EN-LF-ORIG-ALT-PRM-AMT) -
  7069        (EN-LF-NEW-PRM-AMT + EN-LF-NEW-ALT-PRM-AMT))
  7070        * EN-LF-NEW-COMM-PCT)
  7071                       +
  7072        ((EN-AH-ORIG-PRM-AMT - EN-AH-NEW-PRM-AMT)
  7073        * EN-AH-NEW-COMM-PCT)
  7074     COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER -
  7075        EN-ACCT-PORTION
  7076     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  7077         MOVE CM-CONTROL-PRIMARY TO WS-ERMAIL-KEY
  7078     ELSE
  7079     move pb-control-by-account (1:33)
  7080                                 to ws-ermail-key
  7081     END-IF
  7082
  7083
  7084* EXEC CICS READ
  7085*        DATASET   ('ERMAIL')
  7086*        SET       (ADDRESS OF MAILING-DATA)
  7087*        RIDFLD    (WS-ERMAIL-KEY)
  7088*        RESP      (WS-RESPONSE)
  7089*    END-EXEC
  7090     MOVE 'ERMAIL' TO DFHEIV1
  7091*    MOVE '&"S        E          (  N#00006843' TO DFHEIV0
  7092     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7093     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7094     MOVE X'204E233030303036383433' TO DFHEIV0(25:11)
  7095     CALL 'kxdfhei1' USING DFHEIV0,
  7096           DFHEIV1,
  7097           DFHEIV20,
  7098           DFHEIV99,
  7099           WS-ERMAIL-KEY,
  7100           DFHEIV99,
  7101           DFHEIV99,
  7102           DFHEIV99
  7103     SET ADDRESS OF MAILING-DATA TO
  7104         DFHEIV20
  7105     MOVE EIBRESP  TO WS-RESPONSE
  7106     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7107     IF RESP-NORMAL
  7108        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  7109                                    NCRTO-CRED-BENE-NAME
  7110     ELSE
  7111        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  7112     END-IF
  7113
  7114     IF PI-RETURN-TO-PROGRAM = 'EL6314'
  7115         MOVE CM-CONTROL-PRIMARY TO WS-ELCRTT-PRIMARY
  7116     ELSE
  7117     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
  7118     END-IF
  7119
  7120     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  7121
  7122
  7123* EXEC CICS READ
  7124*         DATASET  (WS-ELCRTT-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 125
* EL6318.cbl
  7125*         RIDFLD   (WS-ELCRTT-KEY)
  7126*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  7127*         RESP     (WS-RESPONSE)
  7128*    END-EXEC
  7129*    MOVE '&"S        E          (  N#00006864' TO DFHEIV0
  7130     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7131     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7132     MOVE X'204E233030303036383634' TO DFHEIV0(25:11)
  7133     CALL 'kxdfhei1' USING DFHEIV0,
  7134           WS-ELCRTT-FILE-ID,
  7135           DFHEIV20,
  7136           DFHEIV99,
  7137           WS-ELCRTT-KEY,
  7138           DFHEIV99,
  7139           DFHEIV99,
  7140           DFHEIV99
  7141     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  7142         DFHEIV20
  7143     MOVE EIBRESP  TO WS-RESPONSE
  7144     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7145
  7146     IF RESP-NORMAL
  7147        MOVE CS-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  7148                                     NCRTO-INS-AGE-DEFAULT-FLAG
  7149        MOVE CS-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  7150                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  7151     END-IF.
  7152     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7153        IF REACD-IN (S1) NOT = LOW-VALUES
  7154           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  7155        END-IF
  7156     END-PERFORM
  7157     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  7158     MOVE 'G'                    TO EN-DOCU-TYPE
  7159     MOVE 'Y'                    TO EN-MONEY-SW
  7160     MOVE SIGREQI                TO EN-SIG-SW
  7161     MOVE VOUCHI                 TO EN-VOUCHER-SW
  7162     MOVE PAYEEI                 TO EN-PAYEE
  7163     MOVE HLTHAPPI               TO EN-HEALTH-APP
  7164     if pi-check-cut = 'Y' and pi-check-type = 'C'
  7165        move 'C'                 to en-check-type
  7166     end-if
  7167     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  7168     .
  7169 0400-EXIT.
  7170     EXIT.
  7171 0410-INIT-ERENDT.
  7172     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  7173     MOVE ZEROS                  TO ENDT-SEQ-NO
  7174
  7175* EXEC CICS READ
  7176*        DATASET    (WS-ERENDT-FILE-ID)
  7177*        RIDFLD     (ERENDT-KEY)
  7178*        INTO       (ENDORSEMENT-RECORD)
  7179*        RESP       (WS-RESPONSE)
  7180*        GTEQ
  7181*    END-EXEC
  7182     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 126
* EL6318.cbl
  7183      ENDORSEMENT-RECORD
  7184       TO DFHEIV11
  7185*    MOVE '&"IL       G          (  N#00006899' TO DFHEIV0
  7186     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  7187     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7188     MOVE X'204E233030303036383939' TO DFHEIV0(25:11)
  7189     CALL 'kxdfhei1' USING DFHEIV0,
  7190           WS-ERENDT-FILE-ID,
  7191           ENDORSEMENT-RECORD,
  7192           DFHEIV11,
  7193           ERENDT-KEY,
  7194           DFHEIV99,
  7195           DFHEIV99,
  7196           DFHEIV99
  7197     MOVE EIBRESP  TO WS-RESPONSE
  7198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7199     IF RESP-NORMAL
  7200        AND (EN-CONTROL-PRIMARY (1:34) =
  7201           OC-CONTROL-PRIMARY (1:34))
  7202        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  7203     ELSE
  7204        MOVE +4096               TO WS-SEQ-NO
  7205     END-IF
  7206     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  7207     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  7208     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  7209     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  7210     INITIALIZE EN-ISSUE-RECORD
  7211     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  7212                                    EN-AH-ORIG-EXP-DT
  7213                                    EN-LF-NEW-EXP-DT
  7214                                    EN-AH-NEW-EXP-DT
  7215                                    EN-PROCESS-DT
  7216     .
  7217 0410-EXIT.
  7218     EXIT.
  7219 0420-UPDATE-ELCRTO.
  7220     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  7221     IF RESP-NORMAL
  7222        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  7223                                    OC-LAST-MAINT-DT
  7224        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  7225        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  7226
  7227* EXEC CICS REWRITE
  7228*          FROM     (ORIGINAL-CERTIFICATE)
  7229*          DATASET  ('ELCRTO')
  7230*       END-EXEC
  7231     MOVE LENGTH OF
  7232      ORIGINAL-CERTIFICATE
  7233       TO DFHEIV11
  7234     MOVE 'ELCRTO' TO DFHEIV1
  7235*    MOVE '&& L                  %   #00006933' TO DFHEIV0
  7236     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7237     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7238     MOVE X'2020233030303036393333' TO DFHEIV0(25:11)
  7239     CALL 'kxdfhei1' USING DFHEIV0,
  7240           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 127
* EL6318.cbl
  7241           ORIGINAL-CERTIFICATE,
  7242           DFHEIV11,
  7243           DFHEIV99
  7244     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7245     END-IF
  7246     .
  7247 0420-EXIT.
  7248     EXIT.
  7249
  7250 0425-ADD-NEW-ELCRTO.
  7251     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  7252     MOVE 'OC'                   TO OC-RECORD-ID
  7253     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  7254     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  7255     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  7256     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  7257     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  7258     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  7259     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  7260     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  7261     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  7262     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  7263     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  7264     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
  7265     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  7266     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  7267     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  7268     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  7269     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  7270     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  7271     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  7272     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  7273     MOVE LOW-VALUES             TO OC-LF-CANCEL-DT
  7274     MOVE +0                     TO OC-LF-CANCEL-AMT
  7275                                    OC-LF-ITD-CANCEL-AMT
  7276     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  7277     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  7278     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  7279     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  7280     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  7281     MOVE NCRTO-AH-CP            TO OC-AH-CP
  7282     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  7283     MOVE LOW-VALUES             TO OC-AH-CANCEL-DT
  7284     MOVE +0                     TO OC-AH-CANCEL-AMT
  7285                                    OC-AH-ITD-CANCEL-AMT
  7286     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  7287     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  7288     MOVE NCRTO-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  7289     MOVE NCRTO-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  7290     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
  7291     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
  7292     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  7293     .
  7294 0425-WRITE-ELCRTO.
  7295
  7296
  7297* EXEC CICS WRITE
  7298*       DATASET   ('ELCRTO')
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 128
* EL6318.cbl
  7299*       FROM      (ORIGINAL-CERTIFICATE)
  7300*       RIDFLD    (OC-CONTROL-PRIMARY)
  7301*       RESP      (WS-RESPONSE)
  7302*    END-EXEC
  7303     MOVE LENGTH OF
  7304      ORIGINAL-CERTIFICATE
  7305       TO DFHEIV11
  7306     MOVE 'ELCRTO' TO DFHEIV1
  7307*    MOVE '&$ L                  ''  N#00006988' TO DFHEIV0
  7308     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7309     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7310     MOVE X'204E233030303036393838' TO DFHEIV0(25:11)
  7311     CALL 'kxdfhei1' USING DFHEIV0,
  7312           DFHEIV1,
  7313           ORIGINAL-CERTIFICATE,
  7314           DFHEIV11,
  7315           OC-CONTROL-PRIMARY,
  7316           DFHEIV99,
  7317           DFHEIV99
  7318     MOVE EIBRESP  TO WS-RESPONSE
  7319     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7320
  7321     IF RESP-DUPKEY
  7322        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  7323        GO TO 0425-WRITE-ELCRTO
  7324     ELSE
  7325        IF NOT RESP-NORMAL
  7326           MOVE -1               TO SIGREQL
  7327           MOVE ER-3830          TO EMI-ERROR
  7328           PERFORM 9900-ERROR-FORMAT
  7329                                 THRU 9900-EXIT
  7330        ELSE
  7331           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  7332        END-IF
  7333     END-IF
  7334
  7335     .
  7336 0425-EXIT.
  7337     EXIT.
  7338
  7339 0426-ADD-CERT-NOTES.
  7340
  7341     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  7342     SET TB-INDX TO 1
  7343
  7344     IF PI-CERTNT1-ENTERED > SPACES
  7345         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7346         MOVE PI-PROCESSOR-ID    TO
  7347                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7348         MOVE EIBTIME            TO
  7349                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7350         MOVE WS-CURRENT-BIN-DT  TO
  7351                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7352         SET TB-INDX UP BY +1
  7353     END-IF
  7354
  7355     IF PI-CERTNT2-ENTERED > SPACES
  7356         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 129
* EL6318.cbl
  7357         MOVE PI-PROCESSOR-ID    TO
  7358                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7359         MOVE EIBTIME            TO
  7360                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7361         MOVE WS-CURRENT-BIN-DT  TO
  7362                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7363         SET TB-INDX UP BY +1
  7364     END-IF
  7365
  7366     IF PI-CERTNT3-ENTERED > SPACES
  7367         MOVE PI-CERTNT3-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7368         MOVE PI-PROCESSOR-ID    TO
  7369                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7370         MOVE EIBTIME            TO
  7371                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7372         MOVE WS-CURRENT-BIN-DT  TO
  7373                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7374         SET TB-INDX UP BY +1
  7375     END-IF
  7376
  7377     IF PI-CERTNT4-ENTERED > SPACES
  7378         MOVE PI-CERTNT4-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7379         MOVE PI-PROCESSOR-ID    TO
  7380                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7381         MOVE EIBTIME            TO
  7382                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7383         MOVE WS-CURRENT-BIN-DT  TO
  7384                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7385         SET TB-INDX UP BY +1
  7386     END-IF
  7387
  7388     IF CERT-NOTE-ENTRIES > SPACES
  7389         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  7390         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  7391     END-IF
  7392
  7393     IF PI-BILLNT1-ENTERED > SPACES
  7394         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  7395         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  7396         MOVE +63 TO WS-LEN
  7397         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7398     END-IF
  7399
  7400     IF PI-BILLNT2-ENTERED > SPACES
  7401         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  7402         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  7403         MOVE +63 TO WS-LEN
  7404         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7405     END-IF
  7406
  7407     .
  7408 0426-EXIT.
  7409     EXIT.
  7410
  7411 0427-LOAD-CURRENT-CERT-NOTES.
  7412
  7413     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  7414     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 130
* EL6318.cbl
  7415     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  7416     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  7417     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  7418     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  7419     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  7420     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  7421     MOVE '1'                 TO ERCNOT-REC-TYP
  7422     MOVE +0                  TO ERCNOT-SEQ
  7423     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  7424
  7425
  7426* EXEC CICS STARTBR
  7427*         DATASET(WS-ERCNOT-FILE-ID)
  7428*         RIDFLD(ERCNOT-KEY)
  7429*         KEYLENGTH(ERCNOT-START-LENGTH)
  7430*         RESP      (WS-RESPONSE)
  7431*         GENERIC
  7432*         GTEQ
  7433*    END-EXEC.
  7434     MOVE 0
  7435       TO DFHEIV11
  7436*    MOVE '&,   KG    G          &  N#00007099' TO DFHEIV0
  7437     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  7438     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7439     MOVE X'204E233030303037303939' TO DFHEIV0(25:11)
  7440     CALL 'kxdfhei1' USING DFHEIV0,
  7441           WS-ERCNOT-FILE-ID,
  7442           ERCNOT-KEY,
  7443           ERCNOT-START-LENGTH,
  7444           DFHEIV11,
  7445           DFHEIV99
  7446     MOVE EIBRESP  TO WS-RESPONSE
  7447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7448
  7449
  7450     IF NOT RESP-NORMAL
  7451        GO TO 0427-ENDBR
  7452     END-IF.
  7453
  7454 0427-LOOP.
  7455
  7456* EXEC CICS READNEXT
  7457*         SET(ADDRESS OF CERT-NOTE-FILE)
  7458*         DATASET(WS-ERCNOT-FILE-ID)
  7459*         RIDFLD(ERCNOT-KEY)
  7460*    END-EXEC.
  7461     MOVE 0
  7462       TO DFHEIV11
  7463*    MOVE '&.S                   )   #00007113' TO DFHEIV0
  7464     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7465     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7466     MOVE X'2020233030303037313133' TO DFHEIV0(25:11)
  7467     CALL 'kxdfhei1' USING DFHEIV0,
  7468           WS-ERCNOT-FILE-ID,
  7469           DFHEIV20,
  7470           DFHEIV99,
  7471           ERCNOT-KEY,
  7472           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 131
* EL6318.cbl
  7473           DFHEIV11,
  7474           DFHEIV99,
  7475           DFHEIV99
  7476     SET ADDRESS OF CERT-NOTE-FILE TO
  7477         DFHEIV20
  7478     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7479
  7480
  7481     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  7482         GO TO 0427-ENDBR
  7483     END-IF.
  7484
  7485     IF (CZ-CARRIER = SV-CARRIER)
  7486        AND (CZ-GROUPING = SV-GROUPING)
  7487        AND (CZ-STATE = SV-STATE)
  7488        AND (CZ-ACCOUNT = SV-ACCOUNT)
  7489        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  7490        AND (CZ-CERT-NO = SV-CERT-NO)
  7491        AND (CZ-RECORD-TYPE = '1')
  7492          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  7493          MOVE CZ-LAST-MAINT-USER TO
  7494                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7495          MOVE CZ-LAST-MAINT-DT TO
  7496                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7497          MOVE CZ-LAST-MAINT-HHMMSS TO
  7498                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7499          SET TB-INDX UP BY 1
  7500          GO TO 0427-LOOP
  7501     END-IF.
  7502
  7503 0427-ENDBR.
  7504
  7505
  7506* EXEC CICS ENDBR
  7507*         DATASET(WS-ERCNOT-FILE-ID)
  7508*    END-EXEC.
  7509     MOVE 0
  7510       TO DFHEIV11
  7511*    MOVE '&2                    $   #00007143' TO DFHEIV0
  7512     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7513     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7514     MOVE X'2020233030303037313433' TO DFHEIV0(25:11)
  7515     CALL 'kxdfhei1' USING DFHEIV0,
  7516           WS-ERCNOT-FILE-ID,
  7517           DFHEIV11,
  7518           DFHEIV99
  7519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7520
  7521
  7522     .
  7523 0427-EXIT.
  7524     EXIT.
  7525
  7526 0430-WRITE-ERENDT.
  7527     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  7528     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  7529
  7530* EXEC CICS WRITE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 132
* EL6318.cbl
  7531*         DATASET   (WS-ERENDT-FILE-ID)
  7532*         FROM      (ENDORSEMENT-RECORD)
  7533*         RIDFLD    (EN-CONTROL-PRIMARY)
  7534*         RESP      (WS-RESPONSE)
  7535*    END-EXEC
  7536     MOVE LENGTH OF
  7537      ENDORSEMENT-RECORD
  7538       TO DFHEIV11
  7539*    MOVE '&$ L                  ''  N#00007154' TO DFHEIV0
  7540     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7541     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7542     MOVE X'204E233030303037313534' TO DFHEIV0(25:11)
  7543     CALL 'kxdfhei1' USING DFHEIV0,
  7544           WS-ERENDT-FILE-ID,
  7545           ENDORSEMENT-RECORD,
  7546           DFHEIV11,
  7547           EN-CONTROL-PRIMARY,
  7548           DFHEIV99,
  7549           DFHEIV99
  7550     MOVE EIBRESP  TO WS-RESPONSE
  7551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7552     IF RESP-NORMAL
  7553        MOVE 'G'                 TO PI-DOCUMENT-PROCESSED
  7554        IF EIBAID = DFHPF4
  7555           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  7556           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  7557           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  7558           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  7559        END-IF
  7560     ELSE
  7561        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  7562        MOVE -1                  TO SIGREQL
  7563        MOVE ER-0132             TO EMI-ERROR
  7564        MOVE AL-UABON            TO SIGREQA
  7565        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7566     END-IF
  7567     .
  7568 0430-EXIT.
  7569     EXIT.
  7570
  7571
  7572 0440-ADD-BILLING-NOTE.
  7573
  7574* EXEC CICS GETMAIN
  7575*         SET      (ADDRESS OF EOB-CODES)
  7576*         LENGTH   (ELEOBC-LENGTH)
  7577*         INITIMG  (GETMAIN-SPACE)
  7578*    END-EXEC
  7579*    MOVE ',"IL                  $   #00007181' TO DFHEIV0
  7580     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7581     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7582     MOVE X'2020233030303037313831' TO DFHEIV0(25:11)
  7583     CALL 'kxdfhei1' USING DFHEIV0,
  7584           DFHEIV20,
  7585           ELEOBC-LENGTH,
  7586           GETMAIN-SPACE
  7587     SET ADDRESS OF EOB-CODES TO
  7588         DFHEIV20
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 133
* EL6318.cbl
  7589     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7590
  7591     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  7592     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  7593     MOVE '5'                    TO WS-EOBC-REC-TYPE
  7594
  7595
  7596* EXEC CICS STARTBR
  7597*        DATASET   ('ELEOBC')
  7598*        RIDFLD    (WS-ELEOBC-KEY)
  7599*        GTEQ
  7600*        RESP      (WS-RESPONSE)
  7601*    END-EXEC
  7602     MOVE 'ELEOBC' TO DFHEIV1
  7603     MOVE 0
  7604       TO DFHEIV11
  7605*    MOVE '&,         G          &  N#00007191' TO DFHEIV0
  7606     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7607     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7608     MOVE X'204E233030303037313931' TO DFHEIV0(25:11)
  7609     CALL 'kxdfhei1' USING DFHEIV0,
  7610           DFHEIV1,
  7611           WS-ELEOBC-KEY,
  7612           DFHEIV99,
  7613           DFHEIV11,
  7614           DFHEIV99
  7615     MOVE EIBRESP  TO WS-RESPONSE
  7616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7617
  7618     IF NOT RESP-NORMAL
  7619        GO TO 0440-EXIT
  7620     END-IF
  7621      .
  7622 0440-READNEXT-ELEOBC.
  7623
  7624
  7625* EXEC CICS READNEXT
  7626*       INTO    (EOB-CODES)
  7627*       DATASET ('ELEOBC')
  7628*       RIDFLD  (WS-ELEOBC-KEY)
  7629*       RESP    (WS-RESPONSE)
  7630*    END-EXEC
  7631     MOVE LENGTH OF
  7632      EOB-CODES
  7633       TO DFHEIV12
  7634     MOVE 'ELEOBC' TO DFHEIV1
  7635     MOVE 0
  7636       TO DFHEIV11
  7637*    MOVE '&.IL                  )  N#00007204' TO DFHEIV0
  7638     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7639     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7640     MOVE X'204E233030303037323034' TO DFHEIV0(25:11)
  7641     CALL 'kxdfhei1' USING DFHEIV0,
  7642           DFHEIV1,
  7643           EOB-CODES,
  7644           DFHEIV12,
  7645           WS-ELEOBC-KEY,
  7646           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 134
* EL6318.cbl
  7647           DFHEIV11,
  7648           DFHEIV99,
  7649           DFHEIV99
  7650     MOVE EIBRESP  TO WS-RESPONSE
  7651     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7652
  7653     IF RESP-NORMAL
  7654         IF EO-RECORD-TYPE NOT = '5'
  7655             GO TO 0440-EXIT
  7656         END-IF
  7657     ELSE
  7658         GO TO 0440-EXIT
  7659     END-IF
  7660
  7661     IF EO-RECORD-TYPE = '5' AND
  7662        EO-EOB-CODE = PI-LTRID-ENTERED
  7663           CONTINUE
  7664     ELSE
  7665         GO TO 0440-READNEXT-ELEOBC
  7666     END-IF
  7667
  7668     MOVE SPACES TO WS-BILLING-NOTE
  7669     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  7670     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  7671     MOVE WS-CURRENT-DT TO WS-BN-DATE
  7672     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  7673     MOVE +25 TO WS-LEN
  7674
  7675     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7676     .
  7677 0440-EXIT.
  7678     EXIT.
  7679
  7680 0441-UPDATE-BILLING-NOTE.
  7681
  7682* EXEC CICS GETMAIN
  7683*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7684*         LENGTH   (ERNOTE-LENGTH)
  7685*         INITIMG  (GETMAIN-SPACE)
  7686*    END-EXEC
  7687*    MOVE ',"IL                  $   #00007239' TO DFHEIV0
  7688     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7689     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7690     MOVE X'2020233030303037323339' TO DFHEIV0(25:11)
  7691     CALL 'kxdfhei1' USING DFHEIV0,
  7692           DFHEIV20,
  7693           ERNOTE-LENGTH,
  7694           GETMAIN-SPACE
  7695     SET ADDRESS OF CERTIFICATE-NOTE TO
  7696         DFHEIV20
  7697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7698
  7699     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7700     move '1'                    to w-note-record-type
  7701
  7702
  7703* EXEC CICS READ
  7704*       DATASET    (WS-ERNOTE-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 135
* EL6318.cbl
  7705*       RIDFLD     (WS-ERNOTE-KEY)
  7706*       INTO       (CERTIFICATE-NOTE)
  7707*       RESP       (WS-RESPONSE)
  7708*       UPDATE
  7709*    END-EXEC
  7710     MOVE LENGTH OF
  7711      CERTIFICATE-NOTE
  7712       TO DFHEIV11
  7713*    MOVE '&"IL       EU         (  N#00007248' TO DFHEIV0
  7714     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7715     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7716     MOVE X'204E233030303037323438' TO DFHEIV0(25:11)
  7717     CALL 'kxdfhei1' USING DFHEIV0,
  7718           WS-ERNOTE-FILE-ID,
  7719           CERTIFICATE-NOTE,
  7720           DFHEIV11,
  7721           WS-ERNOTE-KEY,
  7722           DFHEIV99,
  7723           DFHEIV99,
  7724           DFHEIV99
  7725     MOVE EIBRESP  TO WS-RESPONSE
  7726     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7727
  7728     IF RESP-NORMAL
  7729       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7730          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7731       END-IF
  7732       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7733          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7734       END-IF
  7735       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7736           (NOTE-SUB > +10) OR
  7737           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7738                             WS-BILLING-NOTE (1:WS-LEN))
  7739       END-PERFORM
  7740       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7741                              WS-BILLING-NOTE (1:WS-LEN)
  7742
  7743* EXEC CICS UNLOCK
  7744*           DATASET    (WS-ERNOTE-FILE-ID)
  7745*        END-EXEC
  7746*    MOVE '&*                    #   #00007270' TO DFHEIV0
  7747     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7748     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7749     MOVE X'2020233030303037323730' TO DFHEIV0(25:11)
  7750     CALL 'kxdfhei1' USING DFHEIV0,
  7751           WS-ERNOTE-FILE-ID,
  7752           DFHEIV99
  7753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7754       ELSE
  7755         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7756           (NOTE-SUB > +10) OR
  7757           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7758         END-PERFORM
  7759         IF (NOTE-SUB < +11)
  7760           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7761              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7762                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 136
* EL6318.cbl
  7763           ELSE
  7764             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7765              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7766                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7767                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7768             ELSE
  7769               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7770                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7771                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7772                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7773               ELSE
  7774                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7775                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7776                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7777                                       CN-BILLING-START-LINE-NO
  7778                 ELSE
  7779                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7780                 END-IF
  7781               END-IF
  7782             END-IF
  7783           END-IF
  7784           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7785           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7786           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7787
  7788* EXEC CICS REWRITE
  7789*             DATASET    (WS-ERNOTE-FILE-ID)
  7790*             FROM       (CERTIFICATE-NOTE)
  7791*             RESP       (WS-RESPONSE)
  7792*          END-EXEC
  7793     MOVE LENGTH OF
  7794      CERTIFICATE-NOTE
  7795       TO DFHEIV11
  7796*    MOVE '&& L                  %  N#00007306' TO DFHEIV0
  7797     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7798     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7799     MOVE X'204E233030303037333036' TO DFHEIV0(25:11)
  7800     CALL 'kxdfhei1' USING DFHEIV0,
  7801           WS-ERNOTE-FILE-ID,
  7802           CERTIFICATE-NOTE,
  7803           DFHEIV11,
  7804           DFHEIV99
  7805     MOVE EIBRESP  TO WS-RESPONSE
  7806     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7807           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7808         END-IF
  7809       END-IF
  7810     ELSE
  7811        MOVE SPACES              TO CERTIFICATE-NOTE
  7812        MOVE 'CN'                TO CN-RECORD-ID
  7813        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7814                                     WS-ERNOTE-KEY
  7815        move '1'                 to cn-record-type
  7816                                    w-note-record-type
  7817        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7818                                    CN-BILLING-END-LINE-NO
  7819        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7820        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 137
* EL6318.cbl
  7821        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7822        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7823
  7824* EXEC CICS WRITE
  7825*          DATASET    (WS-ERNOTE-FILE-ID)
  7826*          FROM       (CERTIFICATE-NOTE)
  7827*          RIDFLD     (WS-ERNOTE-KEY)
  7828*          RESP       (WS-RESPONSE)
  7829*       END-EXEC
  7830     MOVE LENGTH OF
  7831      CERTIFICATE-NOTE
  7832       TO DFHEIV11
  7833*    MOVE '&$ L                  ''  N#00007327' TO DFHEIV0
  7834     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7835     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7836     MOVE X'204E233030303037333237' TO DFHEIV0(25:11)
  7837     CALL 'kxdfhei1' USING DFHEIV0,
  7838           WS-ERNOTE-FILE-ID,
  7839           CERTIFICATE-NOTE,
  7840           DFHEIV11,
  7841           WS-ERNOTE-KEY,
  7842           DFHEIV99,
  7843           DFHEIV99
  7844     MOVE EIBRESP  TO WS-RESPONSE
  7845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7846
  7847        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7848     END-IF
  7849
  7850     .
  7851 0441-EXIT.
  7852     EXIT.
  7853
  7854
  7855 0442-SQUEEZE-IT-IN.
  7856
  7857     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7858        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7859           NOTE-SUB = +10
  7860           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7861           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7862             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7863             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7864             MOVE +9 TO NOTE-SUB
  7865           END-IF
  7866        END-PERFORM
  7867     ELSE
  7868        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7869           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7870             UNTIL NOTE-SUB = +1
  7871             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7872             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7873                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7874                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7875                MOVE +2          TO NOTE-SUB
  7876             END-IF
  7877           END-PERFORM
  7878        END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 138
* EL6318.cbl
  7879     END-IF
  7880
  7881     .
  7882 0442-EXIT.
  7883     EXIT.
  7884
  7885 0445-CERTIFICATE-UPDATE.
  7886     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7887     IF RESP-NORMAL
  7888        EVALUATE CM-NOTE-SW
  7889           WHEN '2'
  7890           WHEN '3'
  7891           WHEN '6'
  7892           WHEN '7'
  7893              SET NO-CERT-RW     TO TRUE
  7894           WHEN ' '
  7895              MOVE '2'           TO CM-NOTE-SW
  7896           WHEN '1'
  7897              MOVE '3'           TO CM-NOTE-SW
  7898           WHEN '4'
  7899              MOVE '6'           TO CM-NOTE-SW
  7900           WHEN '5'
  7901              MOVE '7'           TO CM-NOTE-SW
  7902        END-EVALUATE
  7903     END-IF
  7904     IF NOT NO-CERT-RW
  7905        PERFORM 1810-REWRITE-ELCERT
  7906                                 THRU 1810-EXIT
  7907     ELSE
  7908
  7909* EXEC CICS UNLOCK
  7910*          DATASET    (WS-ELCERT-FILE-ID)
  7911*       END-EXEC
  7912*    MOVE '&*                    #   #00007395' TO DFHEIV0
  7913     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7914     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7915     MOVE X'2020233030303037333935' TO DFHEIV0(25:11)
  7916     CALL 'kxdfhei1' USING DFHEIV0,
  7917           WS-ELCERT-FILE-ID,
  7918           DFHEIV99
  7919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7920     END-IF
  7921
  7922     .
  7923 0445-EXIT.
  7924     EXIT.
  7925
  7926 0450-GET-ERACCT.
  7927     MOVE ' '                    TO WS-ERACCT-SW
  7928     MOVE ZEROS                  TO WS-CHGBACK
  7929                                    WS-CSO-PORTION
  7930                                    WS-ACCT-PORTION
  7931                                    WS-DIFF
  7932     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7933     IF RESP-NORMAL
  7934        PERFORM 0470-READNEXT-ERACCT
  7935                                 THRU 0470-EXIT
  7936     END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 139
* EL6318.cbl
  7937     IF RESP-NORMAL
  7938        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7939           IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7940              AND >= AM-EFFECTIVE-DT
  7941              SET ACCT-FOUND TO TRUE
  7942           ELSE
  7943              PERFORM 0470-READNEXT-ERACCT
  7944                                 THRU 0470-EXIT
  7945              IF RESP-NORMAL
  7946                 IF AM-CONTROL-PRIMARY (1:20)
  7947                    = EN-CONTROL-PRIMARY (1:20)
  7948                    IF EN-CERT-EFF-DT < AM-EXPIRATION-DT
  7949                       AND >= AM-EFFECTIVE-DT
  7950                       SET ACCT-FOUND TO TRUE
  7951                    END-IF
  7952                 END-IF
  7953              END-IF
  7954           END-IF
  7955        END-IF
  7956     END-IF
  7957     IF ACCT-FOUND
  7958        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7959           (AM-COM-TYP (S1) = 'C' OR 'D')
  7960           OR (S1 > +10)
  7961        END-PERFORM
  7962        IF S1 < +11
  7963           MOVE AM-COMM-CHARGEBACK (S1)
  7964                                 TO WS-CHGBACK
  7965        END-IF
  7966     END-IF
  7967    .
  7968 0450-EXIT.
  7969     EXIT.
  7970 0460-STARTBR-ERACCT.
  7971     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7972     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7973     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7974
  7975* EXEC CICS STARTBR
  7976*        DATASET   ('ERACCT')
  7977*        RIDFLD    (WS-ERACCT-KEY)
  7978*        GTEQ
  7979*        RESP      (WS-RESPONSE)
  7980*    END-EXEC
  7981     MOVE 'ERACCT' TO DFHEIV1
  7982     MOVE 0
  7983       TO DFHEIV11
  7984*    MOVE '&,         G          &  N#00007452' TO DFHEIV0
  7985     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7986     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7987     MOVE X'204E233030303037343532' TO DFHEIV0(25:11)
  7988     CALL 'kxdfhei1' USING DFHEIV0,
  7989           DFHEIV1,
  7990           WS-ERACCT-KEY,
  7991           DFHEIV99,
  7992           DFHEIV11,
  7993           DFHEIV99
  7994     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 140
* EL6318.cbl
  7995     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7996     .
  7997 0460-EXIT.
  7998     EXIT.
  7999 0470-READNEXT-ERACCT.
  8000
  8001* EXEC CICS READNEXT
  8002*       INTO    (ACCOUNT-MASTER)
  8003*       DATASET ('ERACCT')
  8004*       RIDFLD  (WS-ERACCT-KEY)
  8005*       RESP    (WS-RESPONSE)
  8006*    END-EXEC
  8007     MOVE LENGTH OF
  8008      ACCOUNT-MASTER
  8009       TO DFHEIV12
  8010     MOVE 'ERACCT' TO DFHEIV1
  8011     MOVE 0
  8012       TO DFHEIV11
  8013*    MOVE '&.IL                  )  N#00007462' TO DFHEIV0
  8014     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  8015     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8016     MOVE X'204E233030303037343632' TO DFHEIV0(25:11)
  8017     CALL 'kxdfhei1' USING DFHEIV0,
  8018           DFHEIV1,
  8019           ACCOUNT-MASTER,
  8020           DFHEIV12,
  8021           WS-ERACCT-KEY,
  8022           DFHEIV99,
  8023           DFHEIV11,
  8024           DFHEIV99,
  8025           DFHEIV99
  8026     MOVE EIBRESP  TO WS-RESPONSE
  8027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8028     .
  8029 0470-EXIT.
  8030     EXIT.
  8031 0500-CREATE-TEMP-STORAGE.
  8032*    display ' about to write pi ' program-interface-block
  8033
  8034* EXEC CICS WRITEQ TS
  8035*        QUEUE (QID)
  8036*        FROM  (PROGRAM-INTERFACE-BLOCK)
  8037*        LENGTH(1300)
  8038*    END-EXEC
  8039     MOVE 1300
  8040       TO DFHEIV11
  8041*    MOVE '*"     L              ''   #00007473' TO DFHEIV0
  8042     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8043     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8044     MOVE X'2020233030303037343733' TO DFHEIV0(25:11)
  8045     CALL 'kxdfhei1' USING DFHEIV0,
  8046           QID,
  8047           PROGRAM-INTERFACE-BLOCK,
  8048           DFHEIV11,
  8049           DFHEIV99,
  8050           DFHEIV99,
  8051           DFHEIV99
  8052     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 141
* EL6318.cbl
  8053*    display ' about to write map ' el631ki
  8054
  8055* EXEC CICS WRITEQ TS
  8056*        QUEUE (QID)
  8057*        FROM  (EL631KI)
  8058*        LENGTH(MAP-LENGTH)
  8059*    END-EXEC.
  8060*    MOVE '*"     L              ''   #00007479' TO DFHEIV0
  8061     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  8062     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8063     MOVE X'2020233030303037343739' TO DFHEIV0(25:11)
  8064     CALL 'kxdfhei1' USING DFHEIV0,
  8065           QID,
  8066           EL631KI,
  8067           MAP-LENGTH,
  8068           DFHEIV99,
  8069           DFHEIV99,
  8070           DFHEIV99
  8071     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8072
  8073 0500-EXIT.
  8074      EXIT.
  8075 0600-RECOVER-TEMP-STORAGE.
  8076
  8077* EXEC CICS READQ TS
  8078*        QUEUE (QID)
  8079*        INTO  (PROGRAM-INTERFACE-BLOCK)
  8080*        LENGTH(1300)
  8081*    END-EXEC
  8082     MOVE 1300
  8083       TO DFHEIV11
  8084*    MOVE '*$I    L              ''   #00007487' TO DFHEIV0
  8085     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8086     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8087     MOVE X'2020233030303037343837' TO DFHEIV0(25:11)
  8088     CALL 'kxdfhei1' USING DFHEIV0,
  8089           QID,
  8090           PROGRAM-INTERFACE-BLOCK,
  8091           DFHEIV11,
  8092           DFHEIV99,
  8093           DFHEIV99,
  8094           DFHEIV99
  8095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8096
  8097* EXEC CICS READQ TS
  8098*        QUEUE (QID)
  8099*        INTO  (EL631KI)
  8100*        LENGTH(MAP-LENGTH)
  8101*    END-EXEC
  8102*    MOVE '*$I    L              ''   #00007492' TO DFHEIV0
  8103     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  8104     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8105     MOVE X'2020233030303037343932' TO DFHEIV0(25:11)
  8106     CALL 'kxdfhei1' USING DFHEIV0,
  8107           QID,
  8108           EL631KI,
  8109           MAP-LENGTH,
  8110           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 142
* EL6318.cbl
  8111           DFHEIV99,
  8112           DFHEIV99
  8113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8114     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  8115     MOVE AL-UANON            TO SIGREQA
  8116     MOVE AL-UANON            TO LTRIDA
  8117     MOVE AL-UANON            TO VOUCHA
  8118     MOVE AL-UANON            TO HLTHAPPA
  8119     MOVE AL-UANON            TO PAYEEA
  8120     IF WS-SET-CODES-MDT = 'Y'
  8121        move +1                  to s2
  8122        perform varying s1 from +1 by +5 until s1 > +60
  8123           MOVE WS-PASSED-REASON-CODES (s1:4)
  8124                                 TO reacd-in (s2)
  8125           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  8126               MOVE AL-SANON     TO REACDA (S2)
  8127               MOVE +4           TO REACDL (S2)
  8128           END-IF
  8129           add +1                to s2
  8130        end-perform
  8131        MOVE REASONCDS       TO PI-REASONS-ENTERED
  8132     END-IF
  8133     IF CERTIDI > SPACES
  8134         MOVE AL-UANON       TO CERTIDA
  8135     END-IF
  8136
  8137     IF ENCCODEI > SPACES
  8138         MOVE AL-UANON       TO ENCCODEA
  8139     END-IF
  8140
  8141     IF CRTNT1I > SPACES
  8142         MOVE AL-UANON       TO CRTNT1A
  8143     END-IF
  8144
  8145     IF CRTNT2I > SPACES
  8146         MOVE AL-UANON       TO CRTNT2A
  8147     END-IF
  8148
  8149     IF CRTNT3I > SPACES
  8150         MOVE AL-UANON       TO CRTNT3A
  8151     END-IF
  8152
  8153     IF CRTNT4I > SPACES
  8154         MOVE AL-UANON       TO CRTNT4A
  8155     END-IF
  8156
  8157     IF BILNT1I > SPACES
  8158         MOVE AL-UANON       TO BILNT1A
  8159     END-IF
  8160
  8161     IF BILNT2I > SPACES
  8162         MOVE AL-UANON       TO BILNT2A
  8163     END-IF
  8164     .
  8165 0600-EXIT.
  8166      EXIT.
  8167 0800-DELETE-TS.
  8168
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 143
* EL6318.cbl
  8169* EXEC CICS DELETEQ TS
  8170*        QUEUE(QID)
  8171*    END-EXEC
  8172*    MOVE '*&                    #   #00007551' TO DFHEIV0
  8173     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8174     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8175     MOVE X'2020233030303037353531' TO DFHEIV0(25:11)
  8176     CALL 'kxdfhei1' USING DFHEIV0,
  8177           QID,
  8178           DFHEIV99
  8179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8180     .
  8181 0800-EXIT.
  8182      EXIT.
  8183 1000-BUILD-ERARCH.
  8184     MOVE SPACES                 TO W-CNTL-KEY
  8185     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  8186     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  8187     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  8188
  8189* EXEC CICS READ
  8190*         DATASET    (WS-ELCNTL-FILE-ID)
  8191*         SET        (ADDRESS OF CONTROL-FILE)
  8192*         RIDFLD     (W-CNTL-KEY)
  8193*         UPDATE
  8194*         RESP       (WS-RESPONSE)
  8195*    END-EXEC
  8196*    MOVE '&"S        EU         (  N#00007562' TO DFHEIV0
  8197     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8198     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8199     MOVE X'204E233030303037353632' TO DFHEIV0(25:11)
  8200     CALL 'kxdfhei1' USING DFHEIV0,
  8201           WS-ELCNTL-FILE-ID,
  8202           DFHEIV20,
  8203           DFHEIV99,
  8204           W-CNTL-KEY,
  8205           DFHEIV99,
  8206           DFHEIV99,
  8207           DFHEIV99
  8208     SET ADDRESS OF CONTROL-FILE TO
  8209         DFHEIV20
  8210     MOVE EIBRESP  TO WS-RESPONSE
  8211     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8212     IF RESP-NORMAL
  8213        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  8214           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  8215        END-IF
  8216        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  8217        MOVE CF-CREDIT-LAST-ARCH-NUM
  8218                                 TO W-ARCH-NUMBER
  8219
  8220* EXEC CICS REWRITE
  8221*          FROM      (CONTROL-FILE)
  8222*          DATASET   (WS-ELCNTL-FILE-ID)
  8223*       END-EXEC
  8224     MOVE LENGTH OF
  8225      CONTROL-FILE
  8226       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 144
* EL6318.cbl
  8227*    MOVE '&& L                  %   #00007576' TO DFHEIV0
  8228     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8229     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8230     MOVE X'2020233030303037353736' TO DFHEIV0(25:11)
  8231     CALL 'kxdfhei1' USING DFHEIV0,
  8232           WS-ELCNTL-FILE-ID,
  8233           CONTROL-FILE,
  8234           DFHEIV11,
  8235           DFHEIV99
  8236     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8237     END-IF
  8238
  8239* EXEC CICS GETMAIN
  8240*       SET      (ADDRESS OF LETTER-ARCHIVE)
  8241*       LENGTH   (W-ARCH-LENGTH)
  8242*    END-EXEC
  8243*    MOVE '," L                  $   #00007581' TO DFHEIV0
  8244     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  8245     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8246     MOVE X'2020233030303037353831' TO DFHEIV0(25:11)
  8247     CALL 'kxdfhei1' USING DFHEIV0,
  8248           DFHEIV20,
  8249           W-ARCH-LENGTH,
  8250           DFHEIV99
  8251     SET ADDRESS OF LETTER-ARCHIVE TO
  8252         DFHEIV20
  8253     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8254     MOVE 'LA'                   TO LETTER-ARCHIVE
  8255     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  8256                                    LA-ARCHIVE-NO-A2
  8257                                    LA-ARCHIVE-NO-A3
  8258                                    LA-ARCHIVE-NO-A4
  8259                                    LA-ARCHIVE-NO-A5
  8260                                    LA-ARCHIVE-NO-A6
  8261     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  8262                                    LA-COMPANY-CD-A2
  8263                                    LA-COMPANY-CD-A3
  8264                                    LA-COMPANY-CD-A4
  8265                                    LA-COMPANY-CD-A5
  8266                                    LA-COMPANY-CD-A6
  8267     MOVE PB-CARRIER             TO LA-CARRIER-A2
  8268                                    LA-CARRIER-A3
  8269                                    LA-CARRIER-A4
  8270                                    LA-CARRIER-A5
  8271     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  8272     MOVE PB-GROUPING            TO LA-GROUPING-A2
  8273                                    LA-GROUPING-A3
  8274                                    LA-GROUPING-A4
  8275                                    LA-GROUPING-A5
  8276     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  8277                                    LA-ACCOUNT-A3
  8278                                    LA-ACCOUNT-A4
  8279                                    LA-ACCOUNT-A5
  8280     MOVE PB-STATE               TO LA-STATE-A2
  8281                                    LA-STATE-A3
  8282                                    LA-STATE-A4
  8283                                    LA-STATE-A5
  8284     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 145
* EL6318.cbl
  8285     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  8286     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  8287     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  8288     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  8289                                    LA-INITIAL-PRINT-DATE
  8290                                    LA-SENT-DATE
  8291                                    LA-REPLY-DATE
  8292                                    LA-RESEND-DATE
  8293                                    LA-FOLLOW-UP-DATE
  8294     MOVE 'A'                    TO LA-STATUS
  8295     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  8296     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  8297     MOVE LTRIDI                 TO LA-FORM-A3
  8298     MOVE '4'                    TO LA-DATA-SOURCE
  8299     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  8300     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  8301                                    LA-NO-OF-TEXT-RECORDS
  8302
  8303* EXEC CICS WRITE
  8304*         DATASET   ('ERARCH')
  8305*         FROM      (LETTER-ARCHIVE)
  8306*         RIDFLD    (LA-CONTROL-PRIMARY)
  8307*         RESP      (WS-RESPONSE)
  8308*    END-EXEC
  8309     MOVE LENGTH OF
  8310      LETTER-ARCHIVE
  8311       TO DFHEIV11
  8312     MOVE 'ERARCH' TO DFHEIV1
  8313*    MOVE '&$ L                  ''  N#00007633' TO DFHEIV0
  8314     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8315     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8316     MOVE X'204E233030303037363333' TO DFHEIV0(25:11)
  8317     CALL 'kxdfhei1' USING DFHEIV0,
  8318           DFHEIV1,
  8319           LETTER-ARCHIVE,
  8320           DFHEIV11,
  8321           LA-CONTROL-PRIMARY,
  8322           DFHEIV99,
  8323           DFHEIV99
  8324     MOVE EIBRESP  TO WS-RESPONSE
  8325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8326     IF RESP-NORMAL
  8327        MOVE ER-0280             TO EMI-ERROR
  8328        MOVE -1                  TO SIGREQL
  8329        PERFORM 9900-ERROR-FORMAT
  8330                                 THRU 9900-EXIT
  8331        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
  8332        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  8333     ELSE
  8334        MOVE ER-7345             TO EMI-ERROR
  8335        MOVE -1                  TO SIGREQL
  8336        PERFORM 9900-ERROR-FORMAT
  8337                                 THRU 9900-EXIT
  8338     END-IF
  8339     .
  8340 1000-EXIT.
  8341     EXIT.
  8342 1100-CALL-NS-BUS-LOGIC.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 146
* EL6318.cbl
  8343     MOVE SPACES                 TO BL-INPUT
  8344     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  8345     IF PI-RETURN-TO-PROGRAM EQUAL 'EL6314'
  8346         MOVE '2'                TO BL-DATA-SRCE
  8347         MOVE SPACES             TO BL-BATCH-NO
  8348         MOVE ZEROS              TO BL-BATCH-SEQ
  8349     ELSE
  8350         MOVE '4'                TO BL-DATA-SRCE
  8351         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  8352         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  8353     END-IF
  8354     MOVE PI-CARRIER             TO BL-CARRIER
  8355     MOVE PI-GROUPING            TO BL-GROUP
  8356     MOVE PI-STATE               TO BL-STATE
  8357     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  8358     IF PI-CERT-EFF-DT NOT = LOW-VALUES
  8359        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  8360        MOVE ' '                 TO DC-OPTION-CODE
  8361        PERFORM 9700-date-link
  8362        IF NO-CONVERSION-ERROR
  8363           MOVE DC-GREG-DATE-B-EDIT
  8364                                 TO BL-EFF-DT
  8365        END-IF
  8366     END-IF
  8367     MOVE PI-CERT-NO             TO BL-CERT-NO
  8368     MOVE SPACES                 TO BL-RESP-NO
  8369     MOVE LTRIDI                 TO BL-LETTER-ID
  8370     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  8371     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  8372*    MOVE 'ALWA'                 TO BL-PROC-ID
  8373     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  8374*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  8375*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  8376     MOVE PI-ENCCODE             TO BL-ENC-CD
  8377     IF EIBAID = DFHPF4
  8378        MOVE 'B'                 TO BL-WRITE-ERARCH
  8379     ELSE
  8380        MOVE 'T'                 TO BL-WRITE-ERARCH
  8381     END-IF
  8382     MOVE CERTIDI                TO BL-CERT-FORM-ID
  8383     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  8384     MOVE 'ISS ENDT'             TO BL-SOURCE-SCREEN
  8385     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  8386        IF REACD-IN (S1) NOT = LOW-VALUES
  8387           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  8388        END-IF
  8389     END-PERFORM
  8390*****************************************
  8391* Invoke the LETTER business logic
  8392*****************************************
  8393
  8394* exec cics link
  8395*       program('NSRASBL')
  8396*       commarea(srch-commarea)
  8397*    end-exec.
  8398     MOVE LENGTH OF
  8399      srch-commarea
  8400       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 147
* EL6318.cbl
  8401     MOVE 'NSRASBL' TO DFHEIV1
  8402*    MOVE '."C                   (   #00007706' TO DFHEIV0
  8403     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8404     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8405     MOVE X'2020233030303037373036' TO DFHEIV0(25:11)
  8406     CALL 'kxdfhei1' USING DFHEIV0,
  8407           DFHEIV1,
  8408           srch-commarea,
  8409           DFHEIV11,
  8410           DFHEIV99,
  8411           DFHEIV99,
  8412           DFHEIV99,
  8413           DFHEIV99
  8414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8415
  8416     .
  8417 1100-EXIT.
  8418     EXIT.
  8419 1500-GET-ARCH-NO.
  8420     MOVE SPACES                 TO ELCNTL-KEY
  8421     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  8422     MOVE '1'                    TO CNTL-REC-TYPE
  8423     MOVE ZEROS                  TO CNTL-SEQ
  8424
  8425* EXEC CICS READ
  8426*         DATASET    (WS-ELCNTL-FILE-ID)
  8427*         SET        (ADDRESS OF CONTROL-FILE)
  8428*         RIDFLD     (ELCNTL-KEY)
  8429*         UPDATE
  8430*         RESP       (WS-RESPONSE)
  8431*    END-EXEC
  8432*    MOVE '&"S        EU         (  N#00007718' TO DFHEIV0
  8433     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8434     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8435     MOVE X'204E233030303037373138' TO DFHEIV0(25:11)
  8436     CALL 'kxdfhei1' USING DFHEIV0,
  8437           WS-ELCNTL-FILE-ID,
  8438           DFHEIV20,
  8439           DFHEIV99,
  8440           ELCNTL-KEY,
  8441           DFHEIV99,
  8442           DFHEIV99,
  8443           DFHEIV99
  8444     SET ADDRESS OF CONTROL-FILE TO
  8445         DFHEIV20
  8446     MOVE EIBRESP  TO WS-RESPONSE
  8447     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8448     IF RESP-NORMAL
  8449        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  8450           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  8451        END-IF
  8452        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  8453        MOVE CF-CREDIT-LAST-ARCH-NUM
  8454                                 TO W-ARCH-NUMBER
  8455
  8456* EXEC CICS REWRITE
  8457*          FROM      (CONTROL-FILE)
  8458*          DATASET   (WS-ELCNTL-FILE-ID)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 148
* EL6318.cbl
  8459*       END-EXEC
  8460     MOVE LENGTH OF
  8461      CONTROL-FILE
  8462       TO DFHEIV11
  8463*    MOVE '&& L                  %   #00007732' TO DFHEIV0
  8464     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8465     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8466     MOVE X'2020233030303037373332' TO DFHEIV0(25:11)
  8467     CALL 'kxdfhei1' USING DFHEIV0,
  8468           WS-ELCNTL-FILE-ID,
  8469           CONTROL-FILE,
  8470           DFHEIV11,
  8471           DFHEIV99
  8472     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8473     END-IF
  8474     .
  8475 1500-EXIT.
  8476     EXIT.
  8477
  8478
  8479 1700-WRITE-CERT-NOTE      SECTION.
  8480
  8481     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  8482     MOVE ZERO           TO ERCNOT-SEQ.
  8483     SET TB-INDX         DOWN BY 1.
  8484     SET TB-INDX1        TO TB-INDX.
  8485
  8486****DELETE CURRENT CERT NOTES
  8487 1700-LOOP.
  8488
  8489* EXEC CICS READ
  8490*        DATASET (WS-ERCNOT-FILE-ID)
  8491*        RIDFLD  (ERCNOT-KEY)
  8492*        SET     (ADDRESS OF CERT-NOTE-FILE)
  8493*        RESP    (WS-RESPONSE)
  8494*        GTEQ
  8495*    END-EXEC.
  8496*    MOVE '&"S        G          (  N#00007751' TO DFHEIV0
  8497     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8498     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8499     MOVE X'204E233030303037373531' TO DFHEIV0(25:11)
  8500     CALL 'kxdfhei1' USING DFHEIV0,
  8501           WS-ERCNOT-FILE-ID,
  8502           DFHEIV20,
  8503           DFHEIV99,
  8504           ERCNOT-KEY,
  8505           DFHEIV99,
  8506           DFHEIV99,
  8507           DFHEIV99
  8508     SET ADDRESS OF CERT-NOTE-FILE TO
  8509         DFHEIV20
  8510     MOVE EIBRESP  TO WS-RESPONSE
  8511     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8512
  8513
  8514     IF NOT RESP-NORMAL
  8515        GO TO 1700-ENDDEL
  8516     END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 149
* EL6318.cbl
  8517
  8518     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  8519
  8520     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  8521         GO TO 1700-ENDDEL
  8522     END-IF.
  8523
  8524
  8525* EXEC CICS DELETE
  8526*        DATASET (WS-ERCNOT-FILE-ID)
  8527*        RIDFLD  (ERCNOT-KEY)
  8528*    END-EXEC.
  8529*    MOVE '&(  R                 &   #00007769' TO DFHEIV0
  8530     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8531     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8532     MOVE X'2020233030303037373639' TO DFHEIV0(25:11)
  8533     CALL 'kxdfhei1' USING DFHEIV0,
  8534           WS-ERCNOT-FILE-ID,
  8535           ERCNOT-KEY,
  8536           DFHEIV99,
  8537           DFHEIV99,
  8538           DFHEIV99
  8539     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8540
  8541
  8542     GO TO 1700-LOOP.
  8543
  8544 1700-ENDDEL.
  8545
  8546
  8547* EXEC CICS GETMAIN
  8548*         LENGTH(ERCNOT-LENGTH)
  8549*         SET(ADDRESS OF CERT-NOTE-FILE)
  8550*         INITIMG(GETMAIN-SPACE)
  8551*    END-EXEC.
  8552*    MOVE ',"IL                  $   #00007778' TO DFHEIV0
  8553     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8554     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8555     MOVE X'2020233030303037373738' TO DFHEIV0(25:11)
  8556     CALL 'kxdfhei1' USING DFHEIV0,
  8557           DFHEIV20,
  8558           ERCNOT-LENGTH,
  8559           GETMAIN-SPACE
  8560     SET ADDRESS OF CERT-NOTE-FILE TO
  8561         DFHEIV20
  8562     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8563
  8564
  8565     SET TB-INDX TO 1.
  8566     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  8567     MOVE +0             TO ERCNOT-SEQ
  8568
  8569     PERFORM VARYING TB-INDX FROM 1 BY 1
  8570             UNTIL TB-INDX > TB-INDX1
  8571        MOVE SPACES                 TO  CERT-NOTE-FILE
  8572        ADD 1                       TO  ERCNOT-SEQ
  8573        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  8574        MOVE  'CZ'                  TO  CZ-RECORD-ID
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 150
* EL6318.cbl
  8575        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  8576        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  8577                                    TO  CZ-LAST-MAINT-USER
  8578        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  8579                                    TO  CZ-LAST-MAINT-HHMMSS
  8580        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  8581                                    TO  CZ-LAST-MAINT-DT
  8582
  8583
  8584* EXEC CICS WRITE
  8585*            DATASET(WS-ERCNOT-FILE-ID)
  8586*            FROM(CERT-NOTE-FILE)
  8587*            RIDFLD(ERCNOT-KEY)
  8588*       END-EXEC
  8589     MOVE LENGTH OF
  8590      CERT-NOTE-FILE
  8591       TO DFHEIV11
  8592*    MOVE '&$ L                  ''   #00007802' TO DFHEIV0
  8593     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8594     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8595     MOVE X'2020233030303037383032' TO DFHEIV0(25:11)
  8596     CALL 'kxdfhei1' USING DFHEIV0,
  8597           WS-ERCNOT-FILE-ID,
  8598           CERT-NOTE-FILE,
  8599           DFHEIV11,
  8600           ERCNOT-KEY,
  8601           DFHEIV99,
  8602           DFHEIV99
  8603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8604     END-PERFORM
  8605
  8606     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8607     IF RESP-NORMAL
  8608        EVALUATE CM-NOTE-SW
  8609           WHEN '1'
  8610           WHEN '3'
  8611           WHEN '5'
  8612           WHEN '7'
  8613              SET NO-CERT-RW     TO TRUE
  8614           WHEN ' '
  8615              MOVE '1'           TO CM-NOTE-SW
  8616           WHEN '2'
  8617              MOVE '3'           TO CM-NOTE-SW
  8618           WHEN '4'
  8619              MOVE '5'           TO CM-NOTE-SW
  8620           WHEN '6'
  8621              MOVE '7'           TO CM-NOTE-SW
  8622        END-EVALUATE
  8623     END-IF
  8624     IF NOT NO-CERT-RW
  8625        PERFORM 1810-REWRITE-ELCERT
  8626                                 THRU 1810-EXIT
  8627     ELSE
  8628
  8629* EXEC CICS UNLOCK
  8630*          DATASET    (WS-ELCERT-FILE-ID)
  8631*       END-EXEC
  8632*    MOVE '&*                    #   #00007831' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 151
* EL6318.cbl
  8633     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8634     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8635     MOVE X'2020233030303037383331' TO DFHEIV0(25:11)
  8636     CALL 'kxdfhei1' USING DFHEIV0,
  8637           WS-ELCERT-FILE-ID,
  8638           DFHEIV99
  8639     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8640     END-IF
  8641
  8642     .
  8643 1799-EXIT.
  8644     EXIT.
  8645
  8646 1800-READ-ELCERT-UPDATE.
  8647
  8648     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  8649     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  8650     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  8651     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  8652     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  8653     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  8654     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  8655     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  8656
  8657
  8658* EXEC CICS READ
  8659*        UPDATE
  8660*        DATASET  (WS-ELCERT-FILE-ID)
  8661*        RIDFLD   (WS-ELCERT-KEY)
  8662*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8663*        RESP     (WS-RESPONSE)
  8664*    END-EXEC
  8665*    MOVE '&"S        EU         (  N#00007851' TO DFHEIV0
  8666     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8667     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8668     MOVE X'204E233030303037383531' TO DFHEIV0(25:11)
  8669     CALL 'kxdfhei1' USING DFHEIV0,
  8670           WS-ELCERT-FILE-ID,
  8671           DFHEIV20,
  8672           DFHEIV99,
  8673           WS-ELCERT-KEY,
  8674           DFHEIV99,
  8675           DFHEIV99,
  8676           DFHEIV99
  8677     SET ADDRESS OF CERTIFICATE-MASTER TO
  8678         DFHEIV20
  8679     MOVE EIBRESP  TO WS-RESPONSE
  8680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8681
  8682     .
  8683 1800-EXIT.
  8684     EXIT.
  8685
  8686 1810-REWRITE-ELCERT.
  8687
  8688
  8689* EXEC CICS REWRITE
  8690*        FROM     (CERTIFICATE-MASTER)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 152
* EL6318.cbl
  8691*        DATASET  (WS-ELCERT-FILE-ID)
  8692*        RESP     (WS-RESPONSE)
  8693*    END-EXEC.
  8694     MOVE LENGTH OF
  8695      CERTIFICATE-MASTER
  8696       TO DFHEIV11
  8697*    MOVE '&& L                  %  N#00007865' TO DFHEIV0
  8698     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8699     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8700     MOVE X'204E233030303037383635' TO DFHEIV0(25:11)
  8701     CALL 'kxdfhei1' USING DFHEIV0,
  8702           WS-ELCERT-FILE-ID,
  8703           CERTIFICATE-MASTER,
  8704           DFHEIV11,
  8705           DFHEIV99
  8706     MOVE EIBRESP  TO WS-RESPONSE
  8707     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8708
  8709
  8710     .
  8711 1810-EXIT.
  8712     EXIT.
  8713
  8714 8100-SEND-INITIAL-MAP.
  8715     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8716     MOVE '5'                    TO DC-OPTION-CODE.
  8717     PERFORM 9700-DATE-LINK.
  8718     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8719     MOVE EIBTIME                TO TIME-IN.
  8720     MOVE TIME-OUT               TO TIMEO.
  8721     MOVE -1                     TO SIGREQL
  8722     IF PI-PROCESSOR-IS-CSR-SUPER
  8723        perform varying s1 from +1 by +1 until
  8724           s1 > +12
  8725           MOVE AL-UANON            TO reacda (s1)
  8726        end-perform
  8727     END-IF
  8728     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8729     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  8730
  8731* EXEC CICS SEND
  8732*        MAP      (MAP-NAME)
  8733*        MAPSET   (MAPSET-NAME)
  8734*        FROM     (EL631KO)
  8735*        ERASE
  8736*        CURSOR
  8737*    END-EXEC.
  8738     MOVE LENGTH OF
  8739      EL631KO
  8740       TO DFHEIV12
  8741     MOVE -1
  8742       TO DFHEIV11
  8743*    MOVE '8$     CT  E    H L F ,   #00007891' TO DFHEIV0
  8744     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8745     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8746     MOVE X'2020233030303037383931' TO DFHEIV0(25:11)
  8747     CALL 'kxdfhei1' USING DFHEIV0,
  8748           MAP-NAME,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 153
* EL6318.cbl
  8749           EL631KO,
  8750           DFHEIV12,
  8751           MAPSET-NAME,
  8752           DFHEIV99,
  8753           DFHEIV99,
  8754           DFHEIV99,
  8755           DFHEIV11,
  8756           DFHEIV99,
  8757           DFHEIV99,
  8758           DFHEIV99
  8759     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8760
  8761     GO TO 9100-RETURN-TRAN.
  8762 8200-SEND-DATAONLY.
  8763     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8764     MOVE '5'                    TO DC-OPTION-CODE.
  8765     PERFORM 9700-DATE-LINK.
  8766     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8767     MOVE EIBTIME                TO TIME-IN.
  8768     MOVE TIME-OUT               TO TIMEO.
  8769     MOVE -1                     TO PFENTRL
  8770     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8771     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8772
  8773* EXEC CICS SEND
  8774*        MAP      (MAP-NAME)
  8775*        MAPSET   (MAPSET-NAME)
  8776*        FROM     (EL631KO)
  8777*        DATAONLY
  8778*        ERASEAUP
  8779*        CURSOR
  8780*    END-EXEC.
  8781     MOVE LENGTH OF
  8782      EL631KO
  8783       TO DFHEIV12
  8784     MOVE -1
  8785       TO DFHEIV11
  8786*    MOVE '8$D    CT  A    H L F ,   #00007909' TO DFHEIV0
  8787     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8788     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8789     MOVE X'2020233030303037393039' TO DFHEIV0(25:11)
  8790     CALL 'kxdfhei1' USING DFHEIV0,
  8791           MAP-NAME,
  8792           EL631KO,
  8793           DFHEIV12,
  8794           MAPSET-NAME,
  8795           DFHEIV99,
  8796           DFHEIV99,
  8797           DFHEIV99,
  8798           DFHEIV11,
  8799           DFHEIV99,
  8800           DFHEIV99,
  8801           DFHEIV99
  8802     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8803
  8804     GO TO 9100-RETURN-TRAN.
  8805 8300-SEND-TEXT.
  8806
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 154
* EL6318.cbl
  8807* EXEC CICS SEND TEXT
  8808*        FROM     (LOGOFF-TEXT)
  8809*        LENGTH   (LOGOFF-LENGTH)
  8810*        ERASE
  8811*        FREEKB
  8812*    END-EXEC.
  8813*    MOVE '8&      T  E F  H   F -   #00007919' TO DFHEIV0
  8814     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8815     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8816     MOVE X'2020233030303037393139' TO DFHEIV0(25:11)
  8817     CALL 'kxdfhei1' USING DFHEIV0,
  8818           LOGOFF-TEXT,
  8819           LOGOFF-LENGTH,
  8820           DFHEIV99,
  8821           DFHEIV99,
  8822           DFHEIV99,
  8823           DFHEIV99,
  8824           DFHEIV99,
  8825           DFHEIV99,
  8826           DFHEIV99,
  8827           DFHEIV99,
  8828           DFHEIV99,
  8829           DFHEIV99
  8830     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8831
  8832
  8833* EXEC CICS RETURN
  8834*    END-EXEC.
  8835*    MOVE '.(                    ''   #00007925' TO DFHEIV0
  8836     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8837     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8838     MOVE X'2020233030303037393235' TO DFHEIV0(25:11)
  8839     CALL 'kxdfhei1' USING DFHEIV0,
  8840           DFHEIV99,
  8841           DFHEIV99,
  8842           DFHEIV99,
  8843           DFHEIV99,
  8844           DFHEIV99,
  8845           DFHEIV99
  8846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8847
  8848 8800-UNAUTHORIZED-ACCESS.
  8849     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8850     GO TO 8300-SEND-TEXT.
  8851 8810-PF23.
  8852     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8853     MOVE XCTL-005               TO PGM-NAME.
  8854     GO TO 9300-XCTL.
  8855 9000-RETURN-CICS.
  8856
  8857* EXEC CICS RETURN
  8858*    END-EXEC.
  8859*    MOVE '.(                    ''   #00007935' TO DFHEIV0
  8860     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8861     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8862     MOVE X'2020233030303037393335' TO DFHEIV0(25:11)
  8863     CALL 'kxdfhei1' USING DFHEIV0,
  8864           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 155
* EL6318.cbl
  8865           DFHEIV99,
  8866           DFHEIV99,
  8867           DFHEIV99,
  8868           DFHEIV99,
  8869           DFHEIV99
  8870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8871
  8872 9100-RETURN-TRAN.
  8873     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8874     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8875
  8876* EXEC CICS RETURN
  8877*        TRANSID    (TRANS-ID)
  8878*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8879*        LENGTH     (1300)
  8880*        LENGTH     (PI-COMM-LENGTH)
  8881*    END-EXEC.
  8882     MOVE 1300
  8883       TO DFHEIV11
  8884*    MOVE '.(CT                  ''   #00007940' TO DFHEIV0
  8885     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8886     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8887     MOVE X'2020233030303037393430' TO DFHEIV0(25:11)
  8888     CALL 'kxdfhei1' USING DFHEIV0,
  8889           TRANS-ID,
  8890           PROGRAM-INTERFACE-BLOCK,
  8891           DFHEIV11,
  8892           DFHEIV99,
  8893           DFHEIV99,
  8894           DFHEIV99
  8895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8896
  8897 9200-RETURN-MAIN-MENU.
  8898     MOVE XCTL-626               TO PGM-NAME.
  8899     GO TO 9300-XCTL.
  8900 9300-XCTL.
  8901
  8902* EXEC CICS XCTL
  8903*        PROGRAM    (PGM-NAME)
  8904*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8905*        LENGTH     (PI-COMM-LENGTH)
  8906*    END-EXEC.
  8907*    MOVE '.$C                   %   #00007950' TO DFHEIV0
  8908     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8909     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8910     MOVE X'2020233030303037393530' TO DFHEIV0(25:11)
  8911     CALL 'kxdfhei1' USING DFHEIV0,
  8912           PGM-NAME,
  8913           PROGRAM-INTERFACE-BLOCK,
  8914           PI-COMM-LENGTH,
  8915           DFHEIV99
  8916     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8917
  8918 9400-CLEAR.
  8919     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8920
  8921* EXEC CICS XCTL
  8922*        PROGRAM    (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 156
* EL6318.cbl
  8923*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8924*        LENGTH     (PI-COMM-LENGTH)
  8925*    END-EXEC.
  8926*    MOVE '.$C                   %   #00007957' TO DFHEIV0
  8927     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8928     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8929     MOVE X'2020233030303037393537' TO DFHEIV0(25:11)
  8930     CALL 'kxdfhei1' USING DFHEIV0,
  8931           PGM-NAME,
  8932           PROGRAM-INTERFACE-BLOCK,
  8933           PI-COMM-LENGTH,
  8934           DFHEIV99
  8935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8936
  8937 9500-PF12.
  8938     MOVE XCTL-010               TO PGM-NAME.
  8939     GO TO 9300-XCTL.
  8940 9600-PGMID-ERROR.
  8941
  8942* EXEC CICS HANDLE CONDITION
  8943*        PGMIDERR    (8300-SEND-TEXT)
  8944*    END-EXEC.
  8945*    MOVE '"$L                   ! " #00007966' TO DFHEIV0
  8946     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8947     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8948     MOVE X'2220233030303037393636' TO DFHEIV0(25:11)
  8949     CALL 'kxdfhei1' USING DFHEIV0
  8950     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8951
  8952     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8953     MOVE ' '                    TO PI-ENTRY-CD-1.
  8954     MOVE XCTL-005               TO PGM-NAME.
  8955     MOVE PGM-NAME               TO LOGOFF-PGM.
  8956     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8957     GO TO 9300-XCTL.
  8958 9700-DATE-LINK.
  8959     MOVE LINK-ELDATCV           TO PGM-NAME.
  8960
  8961* EXEC CICS LINK
  8962*        PROGRAM    (PGM-NAME)
  8963*        COMMAREA   (DATE-CONVERSION-DATA)
  8964*        LENGTH     (DC-COMM-LENGTH)
  8965*    END-EXEC.
  8966*    MOVE '."C                   (   #00007977' TO DFHEIV0
  8967     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8968     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8969     MOVE X'2020233030303037393737' TO DFHEIV0(25:11)
  8970     CALL 'kxdfhei1' USING DFHEIV0,
  8971           PGM-NAME,
  8972           DATE-CONVERSION-DATA,
  8973           DC-COMM-LENGTH,
  8974           DFHEIV99,
  8975           DFHEIV99,
  8976           DFHEIV99,
  8977           DFHEIV99
  8978     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8979
  8980 9900-ERROR-FORMAT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 157
* EL6318.cbl
  8981     IF NOT EMI-ERRORS-COMPLETE
  8982        MOVE LINK-001            TO PGM-NAME
  8983
  8984* EXEC CICS LINK
  8985*           PROGRAM    (PGM-NAME)
  8986*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8987*           LENGTH     (EMI-COMM-LENGTH)
  8988*       END-EXEC
  8989*    MOVE '."C                   (   #00007985' TO DFHEIV0
  8990     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8991     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8992     MOVE X'2020233030303037393835' TO DFHEIV0(25:11)
  8993     CALL 'kxdfhei1' USING DFHEIV0,
  8994           PGM-NAME,
  8995           ERROR-MESSAGE-INTERFACE-BLOCK,
  8996           EMI-COMM-LENGTH,
  8997           DFHEIV99,
  8998           DFHEIV99,
  8999           DFHEIV99,
  9000           DFHEIV99
  9001     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9002     END-IF
  9003     .
  9004 9900-EXIT.
  9005     EXIT.
  9006 9990-ABEND.
  9007     MOVE LINK-004               TO PGM-NAME.
  9008     MOVE DFHEIBLK               TO EMI-LINE1.
  9009
  9010* EXEC CICS LINK
  9011*        PROGRAM   (PGM-NAME)
  9012*        COMMAREA  (EMI-LINE1)
  9013*        LENGTH    (72)
  9014*    END-EXEC.
  9015     MOVE 72
  9016       TO DFHEIV11
  9017*    MOVE '."C                   (   #00007997' TO DFHEIV0
  9018     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9019     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9020     MOVE X'2020233030303037393937' TO DFHEIV0(25:11)
  9021     CALL 'kxdfhei1' USING DFHEIV0,
  9022           PGM-NAME,
  9023           EMI-LINE1,
  9024           DFHEIV11,
  9025           DFHEIV99,
  9026           DFHEIV99,
  9027           DFHEIV99,
  9028           DFHEIV99
  9029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9030
  9031     GO TO 8200-SEND-DATAONLY.
  9032
  9033* GOBACK.
  9034     MOVE '9%                    "   ' TO DFHEIV0
  9035     MOVE 'EL6318' TO DFHEIV1
  9036     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9037     GOBACK.
  9038 9995-SECURITY-VIOLATION.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 158
* EL6318.cbl
  9039*                            COPY ELCSCTP.
  9040******************************************************************
  9041*                                                                *
  9042*                            ELCSCTP                             *
  9043*                            VMOD=2.001                          *
  9044*                                                                *
  9045*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9046******************************************************************
  9047
  9048
  9049     MOVE EIBDATE          TO SM-JUL-DATE.
  9050     MOVE EIBTRMID         TO SM-TERMID.
  9051     MOVE THIS-PGM         TO SM-PGM.
  9052     MOVE EIBTIME          TO TIME-IN.
  9053     MOVE TIME-OUT         TO SM-TIME.
  9054     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9055
  9056
  9057* EXEC CICS LINK
  9058*         PROGRAM  ('EL003')
  9059*         COMMAREA (SECURITY-MESSAGE)
  9060*         LENGTH   (80)
  9061*    END-EXEC.
  9062     MOVE 'EL003' TO DFHEIV1
  9063     MOVE 80
  9064       TO DFHEIV11
  9065*    MOVE '."C                   (   #00008022' TO DFHEIV0
  9066     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9067     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9068     MOVE X'2020233030303038303232' TO DFHEIV0(25:11)
  9069     CALL 'kxdfhei1' USING DFHEIV0,
  9070           DFHEIV1,
  9071           SECURITY-MESSAGE,
  9072           DFHEIV11,
  9073           DFHEIV99,
  9074           DFHEIV99,
  9075           DFHEIV99,
  9076           DFHEIV99
  9077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9078
  9079
  9080******************************************************************
  9081
  9082 9995-EXIT.
  9083     EXIT.
  9084
  9085 9999-DFHBACK SECTION.
  9086     MOVE '9%                    "   ' TO DFHEIV0
  9087     MOVE 'EL6318' TO DFHEIV1
  9088     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9089     GOBACK.
  9090 9999-DFHEXIT.
  9091     IF DFHEIGDJ EQUAL 0001
  9092         NEXT SENTENCE
  9093     ELSE IF DFHEIGDJ EQUAL 2
  9094         GO TO 8300-SEND-TEXT
  9095         DEPENDING ON DFHEIGDI.
  9096     MOVE '9%                    "   ' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 159
* EL6318.cbl
  9097     MOVE 'EL6318' TO DFHEIV1
  9098     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9099     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       35428     Code:       20882
