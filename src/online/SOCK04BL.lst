* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page   1
* SOCK04BL.cbl
* Options: int("SOCK04BL.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("SOCK04BL.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"SOCK04BL.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST
*          "SOCK04BL.lst" LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0"
*          NOMAPNAME NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT
*          NOMOVELENCHECK NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT
*          NONCHAR NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1*****************************************************************
     2*                                                               *
     3* Copyright (c) 2015 by Central States Health and Life          *
     4* All rights reserved.                                          *
     5*                                                               *
     6*****************************************************************
     7 identification division.
     8 program-id. SOCK04BL.
     9*
    10*AUTHOR.    Cowtown.
    11*           Colleyville, TEXAS.
    12*REMARKS.
    13***-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_***
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page   2
* SOCK04BL.cbl
    14***                                                            ***
    15***  This program acts as a Socket Server and expects a key    ***
    16***  to read an account master and a compensation master and   ***
    17***  will pass back a few items. It currently is designed to   ***
    18***  work with the Agent Signature Verification process.       ***
    19***                                                            ***
    20***_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-_-***
    21******************************************************************
    22*                   C H A N G E   L O G
    23*
    24* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    25*-----------------------------------------------------------------
    26*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    27* EFFECTIVE    NUMBER
    28*-----------------------------------------------------------------
    29* 031115  CR               PEMA  NEW PROGRAM
    30* 020816  CR2015082500001  PEMA  ADD PROCESSING FOR NEW COMP VPP
    31* 092118  CR2018091700001  PEMA  ADD "HOME OFFICE" OPTION
    32* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    33*-----------------------------------------------------------------
    34 environment division.
    35 data division.
    36 working-storage section.
    37 01  DFH-START PIC X(04).
    38 77  WS-COMP-CD                   PIC X  VALUE LOW-VALUES.
    39 77  WS-COMP-ID                   PIC XXX VALUE 'CID'.
    40 77  WS-SAVE-ACCOUNT              PIC X(10)  VALUE SPACES.
    41 77  WS-BIN-ORIG-EFF-DT           PIC XX  VALUE LOW-VALUES.
    42 77  WS-ORIG-EFF-DT               PIC X(10)  VALUE SPACES.
    43 77  WS-EFF-DATE                  PIC X(10)  VALUE SPACES.
    44 77  WS-EXP-DATE                  PIC X(10)  VALUE SPACES.
    45 77  a1                           PIC S999 COMP-3 VALUE +0.
    46 77  c1                           PIC S999 COMP-3 VALUE +0.
    47 77  WS-BUILD-SW                  PIC X.
    48     88  TIME-TO-BUILD               VALUE 'Y'.
    49 77  WS-SAVE-ERACCT               PIC X(2000).
    50 77  WS-DIS-RESP                  PIC 9(05) VALUE ZEROS.
    51 77  ws-bin-eff-dt                pic xx  value low-values.
    52 77  ws-bin-1st-pay-dt            pic xx  value low-values.
    53 77  WS-DISP-AMT                  PIC Z,ZZZ,Z99.99.
    54 77  ws-disp-rate                 pic z9.99999.
    55 77  WS-ERACCT-SW                PIC X VALUE ' '.
    56     88  END-OF-ERACCT                 VALUE 'Y'.
    57 77  WS-ERCTBL-SW                PIC X VALUE ' '.
    58     88  END-OF-ERCTBL                 VALUE 'Y'.
    59 77  WS-STATUS                   PIC X.
    60 77  ws-bin-cert-eff-dt          pic xx   value low-values.
    61 77  ws-current-bin-dt           pic xx   value low-values.
    62 77  ws-cert-note-generic-key-len pic s9(4) comp value +34.
    63 77  note-count                  pic s999 comp-3 value +0.
    64 77  ws-build-note-sw            pic x value ' '.
    65     88  finished-with-notes      value 'Y'.
    66 77  ws-ercnot-sw                pic x  value spaces.
    67     88  ercnot-startbr            value 'Y'.
    68 01  ws-work-date.
    69     05  ws-work-ccyy            pic x(4).
    70     05  ws-work-mm              pic xx.
    71     05  ws-work-dd              pic xx.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page   3
* SOCK04BL.cbl
    72 01  ws-work-date-num redefines ws-work-date
    73                                 pic 9(8).
    74 01  cert-note-records-holder.
    75     05  cert-note-record occurs 300.
    76         10  filler              pic x(48).
    77         10  cnr-rest            pic x(102).
    78 01  WS-AM-KEY.
    79     05  WS-AM-COMPANY-CD        PIC X.
    80     05  WS-AM-CARRIER           PIC X.
    81     05  WS-AM-GROUP             PIC X(6).
    82     05  WS-AM-STATE             PIC XX.
    83     05  WS-AM-ACCOUNT           PIC X(10).
    84     05  WS-AM-EXP-DT            PIC XX.
    85     05  FILLER                  PIC X(4).
    86 01  WS-CO-KEY.
    87     05  WS-CO-COMPANY-CD        PIC X.
    88     05  WS-CO-CARRIER           PIC X.
    89     05  WS-CO-GROUP             PIC X(6).
    90     05  WS-CO-FIN-RESP          PIC X(10).
    91     05  WS-CO-ACCOUNT           PIC X(10).
    92     05  WS-CO-TYPE              PIC X.
    93 01  WS-CM-KEY.
    94     05  WS-CM-COMPANY-CD        PIC X.
    95     05  WS-CM-CARRIER           PIC X.
    96     05  WS-CM-GROUP             PIC X(6).
    97     05  WS-CM-STATE             PIC XX.
    98     05  WS-CM-ACCOUNT           PIC X(10).
    99     05  WS-CM-EFF-DT            PIC XX.
   100     05  WS-CM-CERT-NO           PIC X(11).
   101 01  WS-CZ-KEY.
   102     05  WS-CZ-COMPANY-CD        PIC X.
   103     05  WS-CZ-CARRIER           PIC X.
   104     05  WS-CZ-GROUP             PIC X(6).
   105     05  WS-CZ-STATE             PIC XX.
   106     05  WS-CZ-ACCOUNT           PIC X(10).
   107     05  WS-CZ-EFF-DT            PIC XX.
   108     05  WS-CZ-CERT-NO           PIC X(11).
   109     05  WS-CZ-REC-TYPE          PIC X.
   110     05  ws-cz-note-seq          pic s9(4) comp.
   111 01  WS-CS-KEY.
   112     05  WS-CS-COMPANY-CD        PIC X.
   113     05  WS-CS-CARRIER           PIC X.
   114     05  WS-CS-GROUP             PIC X(6).
   115     05  WS-CS-STATE             PIC XX.
   116     05  WS-CS-ACCOUNT           PIC X(10).
   117     05  WS-CS-EFF-DT            PIC XX.
   118     05  WS-CS-CERT-NO           PIC X(11).
   119     05  WS-CS-TRLR-TYPE         PIC X.
   120 01  ws-return-stuff.
   121     05  ws-am-name              pic x(30).
   122     05  ws-am-person            pic x(30).
   123     05  ws-am-control-name      pic x(30).
   124     05  ws-am-phone             pic x(10).
   125     05  ws-co-fax               pic x(10).
   126     05  ws-co-contact           pic x(30).
   127 01  WS-CID-NO                   PIC X(8).
   128 01  WS-DISP-RESP                PIC 9(5).
   129 01  WS-RESPONSE                 PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page   4
* SOCK04BL.cbl
   130     88  RESP-NORMAL                  VALUE +00.
   131     88  RESP-NOTFND                  VALUE +13.
   132     88  RESP-NOTOPEN                 VALUE +19.
   133     88  RESP-ENDFILE                 VALUE +20.
   134*                                 COPY ELCCERT.
   135******************************************************************
   136*                                                                *
   137*                            ELCCERT.                            *
   138*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   139*                            VMOD=2.013                          *
   140*                                                                *
   141*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
   142*                                                                *
   143*   FILE TYPE = VSAM,KSDS                                        *
   144*   RECORD SIZE = 450  RECFORM = FIXED                           *
   145*                                                                *
   146*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
   147*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
   148*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
   149*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
   150*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
   151*                                                                *
   152*   LOG = YES                                                    *
   153*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   154******************************************************************
   155*                   C H A N G E   L O G
   156*
   157* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   158*-----------------------------------------------------------------
   159*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   160* EFFECTIVE    NUMBER
   161*-----------------------------------------------------------------
   162* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
   163* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
   164* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
   165* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
   166* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
   167* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
   168* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   169* 032612  CR2011110200001  PEMA  AHL CHANGES
   170* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
   171* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
   172* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
   173******************************************************************
   174
   175 01  CERTIFICATE-MASTER.
   176     12  CM-RECORD-ID                      PIC XX.
   177         88  VALID-CM-ID                      VALUE 'CM'.
   178
   179     12  CM-CONTROL-PRIMARY.
   180         16  CM-COMPANY-CD                 PIC X.
   181         16  CM-CARRIER                    PIC X.
   182         16  CM-GROUPING.
   183             20  CM-GROUPING-PREFIX        PIC X(3).
   184             20  CM-GROUPING-PRIME         PIC X(3).
   185         16  CM-STATE                      PIC XX.
   186         16  CM-ACCOUNT.
   187             20  CM-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page   5
* SOCK04BL.cbl
   188             20  CM-ACCOUNT-PRIME          PIC X(6).
   189         16  CM-CERT-EFF-DT                PIC XX.
   190         16  CM-CERT-NO.
   191             20  CM-CERT-PRIME             PIC X(10).
   192             20  CM-CERT-SFX               PIC X.
   193
   194     12  CM-CONTROL-BY-NAME.
   195         16  CM-COMPANY-CD-A1              PIC X.
   196         16  CM-INSURED-LAST-NAME          PIC X(15).
   197         16  CM-INSURED-INITIALS.
   198             20  CM-INSURED-INITIAL1       PIC X.
   199             20  CM-INSURED-INITIAL2       PIC X.
   200
   201     12  CM-CONTROL-BY-SSN.
   202         16  CM-COMPANY-CD-A2              PIC X.
   203         16  CM-SOC-SEC-NO.
   204             20  CM-SSN-STATE              PIC XX.
   205             20  CM-SSN-ACCOUNT            PIC X(6).
   206             20  CM-SSN-LN3.
   207                 25  CM-INSURED-INITIALS-A2.
   208                     30 CM-INSURED-INITIAL1-A2   PIC X.
   209                     30 CM-INSURED-INITIAL2-A2   PIC X.
   210                 25 CM-PART-LAST-NAME-A2         PIC X.
   211
   212     12  CM-CONTROL-BY-CERT-NO.
   213         16  CM-COMPANY-CD-A4              PIC X.
   214         16  CM-CERT-NO-A4                 PIC X(11).
   215
   216     12  CM-CONTROL-BY-MEMB.
   217         16  CM-COMPANY-CD-A5              PIC X.
   218         16  CM-MEMBER-NO.
   219             20  CM-MEMB-STATE             PIC XX.
   220             20  CM-MEMB-ACCOUNT           PIC X(6).
   221             20  CM-MEMB-LN4.
   222                 25  CM-INSURED-INITIALS-A5.
   223                     30 CM-INSURED-INITIAL1-A5   PIC X.
   224                     30 CM-INSURED-INITIAL2-A5   PIC X.
   225                 25 CM-PART-LAST-NAME-A5         PIC XX.
   226
   227     12  CM-INSURED-PROFILE-DATA.
   228         16  CM-INSURED-FIRST-NAME.
   229             20  CM-INSURED-1ST-INIT       PIC X.
   230             20  FILLER                    PIC X(9).
   231         16  CM-INSURED-ISSUE-AGE          PIC 99.
   232         16  CM-INSURED-SEX                PIC X.
   233             88  CM-SEX-MALE                  VALUE 'M'.
   234             88  CM-SEX-FEMAL                 VALUE 'F'.
   235         16  CM-INSURED-JOINT-AGE          PIC 99.
   236         16  CM-JOINT-INSURED-NAME.
   237             20  CM-JT-LAST-NAME           PIC X(15).
   238             20  CM-JT-FIRST-NAME.
   239                 24  CM-JT-1ST-INIT        PIC X.
   240                 24  FILLER                PIC X(9).
   241             20  CM-JT-INITIAL             PIC X.
   242
   243     12  CM-LIFE-DATA.
   244         16  CM-LF-BENEFIT-CD              PIC XX.
   245         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page   6
* SOCK04BL.cbl
   246         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
   247         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
   248         16  CM-LF-DEV-CODE                PIC XXX.
   249         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
   250         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
   251         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   252         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
   253         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   254         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   255         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
   256         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   257         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
   258         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   259         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
   260         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
   261         16  cm-temp-epiq                  pic xx.
   262             88  EPIQ-CLASS                  value 'EQ'.
   263*        16  FILLER                        PIC XX.
   264
   265     12  CM-AH-DATA.
   266         16  CM-AH-BENEFIT-CD              PIC XX.
   267         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
   268         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
   269         16  CM-AH-DEV-CODE                PIC XXX.
   270         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
   271         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
   272         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
   273         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
   274         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
   275         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
   276         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
   277         16  CM-AH-PAID-THRU-DT            PIC XX.
   278             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
   279         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
   280         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
   281         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
   282         16  FILLER                        PIC X.
   283
   284     12  CM-LOAN-INFORMATION.
   285         16  CM-LIVES                      PIC S9(7)     COMP-3.
   286         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
   287                                           PIC S9(5)V99  COMP-3.
   288         16  CM-BILLED                     PIC S9(7)     COMP-3.
   289         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
   290         16  CM-PAY-FREQUENCY              PIC S99.
   291         16  CM-LOAN-TERM                  PIC S999      COMP-3.
   292         16  CM-RATE-CLASS                 PIC XX.
   293         16  CM-BENEFICIARY                PIC X(25).
   294         16  CM-POLICY-FORM-NO             PIC X(12).
   295         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
   296         16  CM-LAST-ADD-ON-DT             PIC XX.
   297         16  CM-DEDUCTIBLE-AMOUNTS.
   298             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
   299             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
   300         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   301             20  CM-RESIDENT-STATE         PIC XX.
   302             20  CM-RATE-CODE              PIC X(4).
   303             20  FILLER                    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page   7
* SOCK04BL.cbl
   304         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
   305             20  CM-LOAN-OFFICER           PIC X(5).
   306             20  FILLER                    PIC XXX.
   307         16  CM-CSR-CODE                   PIC XXX.
   308         16  CM-UNDERWRITING-CODE          PIC X.
   309             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
   310         16  CM-POST-CARD-IND              PIC X.
   311         16  CM-REF-INTERFACE-SW           PIC X.
   312         16  CM-PREMIUM-TYPE               PIC X.
   313             88  CM-SING-PRM                  VALUE '1'.
   314             88  CM-O-B-COVERAGE              VALUE '2'.
   315             88  CM-OPEN-END                  VALUE '3'.
   316         16  CM-IND-GRP-TYPE               PIC X.
   317             88  CM-INDIVIDUAL                VALUE 'I'.
   318             88  CM-GROUP                     VALUE 'G'.
   319         16  CM-SKIP-CODE                  PIC X.
   320             88  NO-MONTHS-SKIPPED            VALUE SPACE.
   321             88  SKIP-JULY                    VALUE '1'.
   322             88  SKIP-AUGUST                  VALUE '2'.
   323             88  SKIP-SEPTEMBER               VALUE '3'.
   324             88  SKIP-JULY-AUG                VALUE '4'.
   325             88  SKIP-AUG-SEPT                VALUE '5'.
   326             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
   327             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
   328             88  SKIP-JUNE                    VALUE '8'.
   329             88  SKIP-JUNE-JULY               VALUE '9'.
   330             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
   331             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
   332         16  CM-PAYMENT-MODE               PIC X.
   333             88  PAY-MONTHLY                  VALUE SPACE.
   334             88  PAY-WEEKLY                   VALUE '1'.
   335             88  PAY-SEMI-MONTHLY             VALUE '2'.
   336             88  PAY-BI-WEEKLY                VALUE '3'.
   337             88  PAY-SEMI-ANUALLY             VALUE '4'.
   338         16  CM-LOAN-NUMBER                PIC X(8).
   339         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
   340         16  CM-OLD-LOF                    PIC XXX.
   341*        16  CM-LOAN-OFFICER               PIC XXX.
   342         16  CM-REIN-TABLE                 PIC XXX.
   343         16  CM-SPECIAL-REIN-CODE          PIC X.
   344         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
   345         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
   346         16  CM-LOAN-1ST-PMT-DT            PIC XX.
   347
   348     12  CM-STATUS-DATA.
   349         16  CM-ENTRY-STATUS               PIC X.
   350         16  CM-ENTRY-DT                   PIC XX.
   351
   352         16  CM-LF-STATUS-AT-CANCEL        PIC X.
   353         16  CM-LF-CANCEL-DT               PIC XX.
   354         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
   355
   356         16  CM-LF-STATUS-AT-DEATH         PIC X.
   357         16  CM-LF-DEATH-DT                PIC XX.
   358         16  CM-LF-DEATH-EXIT-DT           PIC XX.
   359
   360         16  CM-LF-CURRENT-STATUS          PIC X.
   361             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page   8
* SOCK04BL.cbl
   362                                                'M' '4' '5' '9'.
   363             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
   364             88  CM-LF-POLICY-PENDING         VALUE '2'.
   365             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
   366             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
   367             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
   368             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
   369             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
   370             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
   371             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
   372             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
   373             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
   374             88  CM-LF-DECLINED               VALUE 'D'.
   375             88  CM-LF-VOIDED                 VALUE 'V'.
   376
   377         16  CM-AH-STATUS-AT-CANCEL        PIC X.
   378         16  CM-AH-CANCEL-DT               PIC XX.
   379         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
   380
   381         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
   382         16  CM-AH-SETTLEMENT-DT           PIC XX.
   383         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
   384
   385         16  CM-AH-CURRENT-STATUS          PIC X.
   386             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
   387                                                'M' '4' '5' '9'.
   388             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
   389             88  CM-AH-POLICY-PENDING         VALUE '2'.
   390             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
   391             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
   392             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
   393             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
   394             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
   395             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
   396             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
   397             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
   398             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
   399             88  CM-AH-DECLINED               VALUE 'D'.
   400             88  CM-AH-VOIDED                 VALUE 'V'.
   401
   402         16  CM-CLAIM-INTERFACE-SW         PIC X.
   403             88  NO-CLAIM-ATTACHED            VALUE SPACE.
   404             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
   405             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
   406         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
   407
   408         16  CM-ENTRY-BATCH                PIC X(6).
   409         16  CM-LF-EXIT-BATCH              PIC X(6).
   410         16  CM-AH-EXIT-BATCH              PIC X(6).
   411         16  CM-LAST-MONTH-END             PIC XX.
   412
   413     12  CM-NOTE-SW                        PIC X.
   414         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
   415         88  CERT-NOTES-PRESENT               VALUE '1'.
   416         88  BILLING-NOTES-PRESENT            VALUE '2'.
   417         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
   418         88  CLAIM-NOTES-PRESENT              VALUE '4'.
   419         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page   9
* SOCK04BL.cbl
   420         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
   421         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
   422     12  CM-COMP-EXCP-SW                   PIC X.
   423         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
   424         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
   425     12  CM-INSURED-ADDRESS-SW             PIC X.
   426         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
   427         88  INSURED-ADDR-PRESENT             VALUE '1'.
   428
   429*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
   430     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
   431     12  FILLER                            PIC X.
   432
   433*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
   434     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
   435     12  FILLER                            PIC X.
   436*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
   437     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
   438
   439     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
   440         88  CERT-ADDED-BATCH                 VALUE ' '.
   441         88  CERT-ADDED-ONLINE                VALUE '1'.
   442         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
   443         88  CERT-PURGED-OFFLINE              VALUE '3'.
   444         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
   445     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
   446         88  CERT-AS-LOADED                   VALUE ' '.
   447         88  CERT-CANCELLED-ONLINE            VALUE '1'.
   448         88  CERT-CLAIM-ONLINE                VALUE '2'.
   449         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
   450         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
   451         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
   452         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
   453         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
   454
   455     12  CM-ACCOUNT-COMM-PCTS.
   456         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
   457         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
   458
   459     12  CM-USER-FIELD                     PIC X.
   460     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
   461     12  CM-CLP-STATE                      PIC XX.
   462     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
   463     12  CM-USER-RESERVED                  PIC XXX.
   464     12  FILLER REDEFINES CM-USER-RESERVED.
   465         16  CM-AH-CLASS-CD                PIC XX.
   466         16  F                             PIC X.
   467******************************************************************
   468*                                 COPY ELCCRTT.
   469******************************************************************
   470*                                                                *
   471*                            ELCCRTT.                            *
   472*                                                                *
   473*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
   474*                                                                *
   475*   FILE TYPE = VSAM,KSDS                                        *
   476*   RECORD SIZE = 552  RECFORM = FIXED                           *
   477*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  10
* SOCK04BL.cbl
   478*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
   479*                                                                *
   480*   LOG = YES                                                    *
   481*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   482******************************************************************
   483*                   C H A N G E   L O G
   484*
   485* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   486*-----------------------------------------------------------------
   487*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   488* EFFECTIVE    NUMBER
   489*-----------------------------------------------------------------
   490* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
   491* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
   492* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
   493* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
   494* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
   495* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
   496* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
   497* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
   498* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
   499* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
   500* 091318  CR2018073000001  PEMA  ADD Refund methods
   501* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
   502******************************************************************
   503
   504 01  CERTIFICATE-TRAILERS.
   505     12  CS-RECORD-ID                      PIC XX.
   506         88  VALID-CS-ID                      VALUE 'CS'.
   507
   508     12  CS-CONTROL-PRIMARY.
   509         16  CS-COMPANY-CD                 PIC X.
   510         16  CS-CARRIER                    PIC X.
   511         16  CS-GROUPING                   PIC X(6).
   512         16  CS-STATE                      PIC XX.
   513         16  CS-ACCOUNT                    PIC X(10).
   514         16  CS-CERT-EFF-DT                PIC XX.
   515         16  CS-CERT-NO.
   516             20  CS-CERT-PRIME             PIC X(10).
   517             20  CS-CERT-SFX               PIC X.
   518         16  CS-TRAILER-TYPE               PIC X.
   519             88  COMM-TRLR           VALUE 'A'.
   520             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
   521             88  CERT-DATA-TRLR      VALUE 'C'.
   522
   523     12  CS-DATA-AREA                      PIC X(516).
   524
   525     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
   526         16  CS-BANK-COMMISSION-AREA.
   527             20  CS-BANK-COMMS       OCCURS 10.
   528                 24  CS-AGT                PIC X(10).
   529                 24  CS-COM-TYP            PIC X.
   530                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
   531                 24  CS-RECALC-LV-INDIC    PIC X.
   532                 24  FILLER                PIC X(10).
   533         16  FILLER                        PIC X(256).
   534
   535     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  11
* SOCK04BL.cbl
   536****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
   537         16  CS-MB-CLAIM-DATA OCCURS 24.
   538             20  CS-CLAIM-NO               PIC X(7).
   539             20  CS-CLAIM-TYPE             PIC X.
   540                 88  CS-AH-CLM               VALUE 'A'.
   541                 88  CS-IU-CLM               VALUE 'I'.
   542                 88  CS-GP-CLM               VALUE 'G'.
   543                 88  CS-LF-CLM               VALUE 'L'.
   544                 88  CS-PR-CLM               VALUE 'P'.
   545                 88  CS-FL-CLM               VALUE 'F'.
   546                 88  CS-OT-CLM               VALUE 'O'.
   547             20  CS-INSURED-TYPE           PIC X.
   548                 88  CS-PRIM-INSURED          VALUE 'P'.
   549                 88  CS-CO-BORROWER           VALUE 'C'.
   550             20  CS-BENEFIT-PERIOD         PIC 99.
   551             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
   552             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
   553             20  CS-REMAINING-BENS         PIC S999 COMP-3.
   554         16  FILLER                        PIC X(12).
   555     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
   556         16  CS-VIN-NUMBER                 PIC X(17).
   557         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
   558         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
   559         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
   560         16  cs-agent-name.
   561             20  cs-agent-fname            pic x(20).
   562             20  cs-agent-mi               pic x.
   563             20  cs-agent-lname            pic x(25).
   564         16  cs-license-no                 pic x(15).
   565         16  cs-npn-number                 pic x(10).
   566         16  cs-agent-edit-status          pic x.
   567             88  cs-ae-refer-to-manager      value 'M'.
   568             88  cs-ae-cover-sheet           value 'C'.
   569             88  cs-ae-sig-form              value 'S'.
   570             88  cs-ae-verified              value 'V'.
   571             88  cs-unidentified-signature   value 'U'.
   572             88  cs-cert-returned            value 'R'.
   573             88  cs-accept-no-commission     value 'N'.
   574         16  cs-year                       pic 9999.
   575         16  cs-make                       pic x(20).
   576         16  cs-model                      pic x(20).
   577         16  cs-future                     pic x(20).
   578         16  cs-vehicle-odometer           pic s9(7) comp-3.
   579         16  cs-claim-verification-status  pic x.
   580             88  cs-clm-ver-eligible         value 'A'.
   581             88  cs-clm-ver-partial-elig     value 'B'.
   582             88  cs-clm-ver-not-eligible     value 'C'.
   583             88  cs-clm-ver-not-elig-opn-clm value 'D'.
   584             88  cs-clm-ver-not-part-elig-rw value 'E'.
   585             88  cs-clm-ver-ND-CERT          value 'F'.
   586             88  cs-clm-ver-spec-other       value 'G'.
   587             88  cs-clam-ver-pratial-corrected
   588                                             value 'H'.
   589             88  cs-clm-ver-no-matches       value 'I'.
   590             88  cs-clm-ver-not-elig-corrected
   591                                             value 'J'.
   592             88  cs-clm-ver-needs-review     value 'R'.
   593             88  cs-clm-ver-sent-to-claims   value 'W'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  12
* SOCK04BL.cbl
   594         16  CS-LF-REFUND-METHOD           PIC X.
   595         16  CS-AH-REFUND-METHOD           PIC X.
   596         16  FILLER                        PIC X(353). *> was 420
   597*        16  FILLER                        PIC X(496).
   598*                                 COPY ERCACCT.
   599******************************************************************
   600*                                                                *
   601*                                                                *
   602*                            ERCACCT                             *
   603*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   604*                            VMOD=2.031                          *
   605*                                                                *
   606*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
   607*                                                                *
   608*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
   609*   VSAM ACCOUNT MASTER FILES.                                   *
   610*                                                                *
   611*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
   612*                                                                *
   613*   FILE TYPE = VSAM,KSDS                                        *
   614*   RECORD SIZE = 2000  RECFORM = FIX                            *
   615*                                                                *
   616*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
   617*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
   618*                                                                *
   619*   LOG = NO                                                     *
   620*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   621*                                                                *
   622*                                                                *
   623******************************************************************
   624*                   C H A N G E   L O G
   625*
   626* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   627*-----------------------------------------------------------------
   628*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   629* EFFECTIVE    NUMBER
   630*-----------------------------------------------------------------
   631* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
   632* 092705    2005050300006  PEMA  ADD SPP LEASES
   633* 022808    2007083100002  PEMA  ADD FREEZE STATUS
   634* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
   635* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
   636* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
   637* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
   638* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
   639******************************************************************
   640
   641 01  ACCOUNT-MASTER.
   642     12  AM-RECORD-ID                      PIC XX.
   643         88  VALID-AM-ID                      VALUE 'AM'.
   644
   645     12  AM-CONTROL-PRIMARY.
   646         16  AM-COMPANY-CD                 PIC X.
   647         16  AM-MSTR-CNTRL.
   648             20  AM-CONTROL-A.
   649                 24  AM-CARRIER            PIC X.
   650                 24  AM-GROUPING.
   651                     28 AM-GROUPING-PREFIX PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  13
* SOCK04BL.cbl
   652                     28 AM-GROUPING-PRIME  PIC XXX.
   653                 24  AM-STATE              PIC XX.
   654                 24  AM-ACCOUNT.
   655                     28  AM-ACCOUNT-PREFIX PIC X(4).
   656                     28  AM-ACCOUNT-PRIME  PIC X(6).
   657             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
   658                                           PIC X(19).
   659             20  AM-CNTRL-B.
   660                 24  AM-EXPIRATION-DT      PIC XX.
   661                 24  FILLER                PIC X(4).
   662             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
   663                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
   664
   665     12  AM-CONTROL-BY-VAR-GRP.
   666         16  AM-COMPANY-CD-A1              PIC X.
   667         16  AM-VG-CARRIER                 PIC X.
   668         16  AM-VG-GROUPING                PIC X(6).
   669         16  AM-VG-STATE                   PIC XX.
   670         16  AM-VG-ACCOUNT                 PIC X(10).
   671         16  AM-VG-DATE.
   672             20  AM-VG-EXPIRATION-DT       PIC XX.
   673             20  FILLER                    PIC X(4).
   674         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
   675                                           PIC 9(11)      COMP-3.
   676     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
   677         16  FILLER                        PIC X(10).
   678         16  AM-VG-KEY3.
   679             20  AM-VG3-ACCOUNT            PIC X(10).
   680             20  AM-VG3-EXP-DT             PIC XX.
   681         16  FILLER                        PIC X(4).
   682     12  AM-MAINT-INFORMATION.
   683         16  AM-LAST-MAINT-DT              PIC XX.
   684         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
   685         16  AM-LAST-MAINT-USER            PIC X(4).
   686         16  FILLER                        PIC XX.
   687
   688     12  AM-EFFECTIVE-DT                   PIC XX.
   689     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
   690
   691     12  AM-PREV-DATES  COMP-3.
   692         16  AM-PREV-EXP-DT                PIC 9(11).
   693         16  AM-PREV-EFF-DT                PIC 9(11).
   694
   695     12  AM-REPORT-CODE-1                  PIC X(10).
   696     12  AM-REPORT-CODE-2                  PIC X(10).
   697
   698     12  AM-CITY-CODE                      PIC X(4).
   699     12  AM-COUNTY-PARISH                  PIC X(6).
   700
   701     12  AM-NAME                           PIC X(30).
   702     12  AM-PERSON                         PIC X(30).
   703     12  AM-ADDRS                          PIC X(30).
   704     12  AM-CITY.
   705         16  AM-ADDR-CITY                  PIC X(28).
   706         16  AM-ADDR-STATE                 PIC XX.
   707     12  AM-ZIP.
   708         16  AM-ZIP-PRIME.
   709             20  AM-ZIP-PRI-1ST            PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  14
* SOCK04BL.cbl
   710                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
   711             20  FILLER                    PIC X(4).
   712         16  AM-ZIP-PLUS4                  PIC X(4).
   713     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
   714         16  AM-CAN-POSTAL-1               PIC XXX.
   715         16  AM-CAN-POSTAL-2               PIC XXX.
   716         16  FILLER                        PIC XXX.
   717     12  AM-TEL-NO.
   718         16  AM-AREA-CODE                  PIC 999.
   719         16  AM-TEL-PRE                    PIC 999.
   720         16  AM-TEL-NBR                    PIC 9(4).
   721     12  AM-TEL-LOC                        PIC X.
   722         88  AM-TEL-AT-HOME                   VALUE 'H'.
   723         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
   724
   725     12  AM-COMM-STRUCTURE.
   726         16  AM-DEFN-1.
   727             20  AM-AGT-COMMS       OCCURS 10 TIMES.
   728                 24  AM-AGT.
   729                     28  AM-AGT-PREFIX     PIC X(4).
   730                     28  AM-AGT-PRIME      PIC X(6).
   731                 24  AM-COM-TYP            PIC X.
   732                 24  AM-L-COM              PIC SV9(5)     COMP-3.
   733                 24  AM-J-COM              PIC SV9(5)     COMP-3.
   734                 24  AM-A-COM              PIC SV9(5)     COMP-3.
   735                 24  AM-RECALC-LV-INDIC    PIC X.
   736                 24  AM-RETRO-LV-INDIC     PIC X.
   737                 24  AM-GL-CODES           PIC X.
   738                 24  AM-COMM-CHARGEBACK    PIC 9(02).
   739                 24  FILLER                PIC X(01).
   740         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
   741             20  AM-COM-TBLS        OCCURS 10 TIMES.
   742                 24  FILLER                PIC X(11).
   743                 24  AM-L-COMA             PIC XXX.
   744                 24  AM-J-COMA             PIC XXX.
   745                 24  AM-A-COMA             PIC XXX.
   746                 24  FILLER                PIC X(6).
   747
   748     12  AM-COMM-CHANGE-STATUS             PIC X.
   749         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
   750
   751     12  AM-CSR-CODE                       PIC X(4).
   752
   753     12  AM-BILLING-STATUS                 PIC X.
   754         88  AM-ACCOUNT-BILLED                VALUE 'B'.
   755         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
   756     12  AM-AUTO-REFUND-SW                 PIC X.
   757         88  AUTO-REFUNDS-USED                VALUE 'Y'.
   758         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
   759     12  AM-GPCD                           PIC 99.
   760     12  AM-IG                             PIC X.
   761         88  AM-HAS-INDIVIDUAL                VALUE '1'.
   762         88  AM-HAS-GROUP                     VALUE '2'.
   763     12  AM-STATUS                         PIC X.
   764         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
   765         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
   766         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
   767         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  15
* SOCK04BL.cbl
   768         88  AM-ACCOUNT-FROZEN                VALUE '4'.
   769         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
   770         88  AM-ACCOUNT-DROPPED               VALUE '6'.
   771         88  AM-ACCOUNT-LAPSED                VALUE '7'.
   772         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
   773         88  AM-ACCOUNT-PENDING               VALUE '9'.
   774     12  AM-REMIT-TO                       PIC 99.
   775     12  AM-ID-NO                          PIC X(11).
   776
   777     12  AM-CAL-TABLE                      PIC XX.
   778     12  AM-LF-DEVIATION                   PIC XXX.
   779     12  AM-AH-DEVIATION                   PIC XXX.
   780     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   781     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
   782     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
   783     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
   784     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   785     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
   786
   787     12  AM-USER-FIELDS.
   788         16  AM-FLD-1                      PIC XX.
   789         16  AM-FLD-2                      PIC XX.
   790         16  AM-FLD-3                      PIC XX.
   791         16  AM-FLD-4                      PIC XX.
   792         16  AM-FLD-5                      PIC XX.
   793
   794     12  AM-1ST-PROD-DATE.
   795         16  AM-1ST-PROD-YR                PIC XX.
   796         16  AM-1ST-PROD-MO                PIC XX.
   797         16  AM-1ST-PROD-DA                PIC XX.
   798     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
   799     12  AM-CERTS-PURGED-DATE.
   800         16  AM-PUR-YR                     PIC XX.
   801         16  AM-PUR-MO                     PIC XX.
   802         16  AM-PUR-DA                     PIC XX.
   803     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
   804     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
   805     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
   806     12  AM-INACTIVE-DATE.
   807         16  AM-INA-MO                     PIC 99.
   808         16  AM-INA-DA                     PIC 99.
   809         16  AM-INA-YR                     PIC 99.
   810     12  AM-AR-HI-CERT-DATE                PIC XX.
   811
   812     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   813     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
   814
   815     12  AM-OB-PAYMENT-MODE                PIC X.
   816         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
   817         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
   818         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
   819         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
   820
   821     12  AM-AH-ONLY-INDICATOR              PIC X.
   822         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
   823         88  AM-NO-AH-ONLY                    VALUE 'N'.
   824
   825     12  AM-EDIT-LOAN-OFC                  PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  16
* SOCK04BL.cbl
   826
   827     12  AM-OVER-SHORT.
   828         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
   829         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
   830
   831     12  AM-DCC-PRODUCT-CODE               PIC XXX.
   832     12  AM-DCC-CLP-STATE                  PIC XX.
   833
   834     12  AM-RECALC-COMM                    PIC X.
   835     12  AM-RECALC-REIN                    PIC X.
   836
   837     12  AM-REI-TABLE                      PIC XXX.
   838     12  AM-REI-ET-LF                      PIC X.
   839     12  AM-REI-ET-AH                      PIC X.
   840     12  AM-REI-PE-LF                      PIC X.
   841     12  AM-REI-PE-AH                      PIC X.
   842     12  AM-REI-PRT-ST                     PIC X.
   843     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
   844     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
   845     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
   846     12  AM-REI-GROUP-A                    PIC X(6).
   847     12  AM-REI-MORT                       PIC X(4).
   848     12  AM-REI-PRT-OW                     PIC X.
   849     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
   850     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
   851     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
   852     12  AM-REI-GROUP-B                    PIC X(6).
   853
   854     12  AM-TRUST-TYPE                     PIC X(2).
   855
   856     12  AM-EMPLOYER-STMT-USED             PIC X.
   857     12  AM-GROUPED-CHECKS-Y-N             PIC X.
   858
   859     12  AM-STD-AH-TYPE                    PIC XX.
   860     12  AM-EARN-METHODS.
   861         16  AM-EARN-METHOD-R              PIC X.
   862             88 AM-REF-RL-R78                 VALUE 'R'.
   863             88 AM-REF-RL-PR                  VALUE 'P'.
   864             88 AM-REF-RL-MEAN                VALUE 'M'.
   865             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
   866         16  AM-EARN-METHOD-L              PIC X.
   867             88 AM-REF-LL-R78                 VALUE 'R'.
   868             88 AM-REF-LL-PR                  VALUE 'P'.
   869             88 AM-REF-LL-MEAN                VALUE 'M'.
   870             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
   871         16  AM-EARN-METHOD-A              PIC X.
   872             88 AM-REF-AH-R78                 VALUE 'R'.
   873             88 AM-REF-AH-PR                  VALUE 'P'.
   874             88 AM-REF-AH-MEAN                VALUE 'M'.
   875             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
   876             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
   877             88 AM-REF-AH-NET                 VALUE 'N'.
   878
   879     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
   880     12  AM-TOL-REF                        PIC S999V99    COMP-3.
   881     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
   882
   883     12  AM-RET-Y-N                        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  17
* SOCK04BL.cbl
   884     12  AM-RET-P-E                        PIC X.
   885     12  AM-LF-RET                         PIC S9V9999    COMP-3.
   886     12  AM-AH-RET                         PIC S9V9999    COMP-3.
   887     12  AM-RET-GRP                        PIC X(6).
   888     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
   889         16  AM-POOL-PRIME                 PIC XXX.
   890         16  AM-POOL-SUB                   PIC XXX.
   891     12  AM-RETRO-EARNINGS.
   892         16  AM-RET-EARN-R                 PIC X.
   893         16  AM-RET-EARN-L                 PIC X.
   894         16  AM-RET-EARN-A                 PIC X.
   895     12  AM-RET-ST-TAX-USE                 PIC X.
   896         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
   897         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
   898     12  AM-RETRO-BEG-EARNINGS.
   899         16  AM-RET-BEG-EARN-R             PIC X.
   900         16  AM-RET-BEG-EARN-L             PIC X.
   901         16  AM-RET-BEG-EARN-A             PIC X.
   902     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
   903     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
   904
   905     12  AM-USER-SELECT-OPTIONS.
   906         16  AM-USER-SELECT-1              PIC X(10).
   907         16  AM-USER-SELECT-2              PIC X(10).
   908         16  AM-USER-SELECT-3              PIC X(10).
   909         16  AM-USER-SELECT-4              PIC X(10).
   910         16  AM-USER-SELECT-5              PIC X(10).
   911
   912     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   913
   914     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
   915
   916     12  AM-RPT045A-SWITCH                 PIC X.
   917         88  RPT045A-OFF                   VALUE 'N'.
   918
   919     12  AM-INSURANCE-LIMITS.
   920         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
   921         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
   922
   923     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
   924         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
   925
   926     12  AM-DISMBR-COVERAGE-SW             PIC X.
   927         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
   928         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
   929
   930     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
   931
   932     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
   933     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
   934     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
   935     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
   936     12  AM-DCC-UEF-STATE                  PIC XX.
   937     12  FILLER                            PIC XXX.
   938     12  AM-REPORT-CODE-3                  PIC X(10).
   939*    12  FILLER                            PIC X(22).
   940
   941     12  AM-RESERVE-DATE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  18
* SOCK04BL.cbl
   942         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
   943         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
   944         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
   945
   946     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
   947     12  AM-NOTIFICATION-TYPES.
   948         16  AM-NOTIF-OF-LETTERS           PIC X.
   949         16  AM-NOTIF-OF-PAYMENTS          PIC X.
   950         16  AM-NOTIF-OF-REPORTS           PIC X.
   951         16  AM-NOTIF-OF-STATUS            PIC X.
   952
   953     12  AM-BENEFIT-TABLE-USAGE            PIC X.
   954         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
   955         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
   956         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
   957         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
   958
   959     12  AM-BENEFIT-CONTROLS.
   960         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
   961             20  AM-BENEFIT-CODE           PIC XX.
   962             20  AM-BENEFIT-TYPE           PIC X.
   963             20  AM-BENEFIT-REVISION       PIC XXX.
   964             20  AM-BENEFIT-REM-TERM       PIC X.
   965             20  AM-BENEFIT-RETRO-Y-N      PIC X.
   966             20  FILLER                    PIC XX.
   967         16  FILLER                        PIC X(80).
   968
   969     12  AM-TRANSFER-DATA.
   970         16  AM-TRANSFERRED-FROM.
   971             20  AM-TRNFROM-CARRIER        PIC X.
   972             20  AM-TRNFROM-GROUPING.
   973                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
   974                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
   975             20  AM-TRNFROM-STATE          PIC XX.
   976             20  AM-TRNFROM-ACCOUNT.
   977                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
   978                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
   979             20  AM-TRNFROM-DTE            PIC XX.
   980         16  AM-TRANSFERRED-TO.
   981             20  AM-TRNTO-CARRIER          PIC X.
   982             20  AM-TRNTO-GROUPING.
   983                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
   984                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
   985             20  AM-TRNTO-STATE            PIC XX.
   986             20  AM-TRNTO-ACCOUNT.
   987                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
   988                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
   989             20  AM-TRNTO-DTE              PIC XX.
   990         16  FILLER                        PIC X(10).
   991
   992     12  AM-SAVED-REMIT-TO                 PIC 99.
   993
   994     12  AM-COMM-STRUCTURE-SAVED.
   995         16  AM-DEFN-1-SAVED.
   996             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
   997                 24  AM-AGT-SV             PIC X(10).
   998                 24  AM-COM-TYP-SV         PIC X.
   999                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  19
* SOCK04BL.cbl
  1000                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1001                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1002                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1003                 24  FILLER                PIC X.
  1004                 24  AM-GL-CODES-SV        PIC X.
  1005                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1006                 24  FILLER                PIC X.
  1007         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1008             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1009                 24  FILLER                PIC X(11).
  1010                 24  AM-L-COMA-SV          PIC XXX.
  1011                 24  AM-J-COMA-SV          PIC XXX.
  1012                 24  AM-A-COMA-SV          PIC XXX.
  1013                 24  FILLER                PIC X(6).
  1014
  1015     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1016         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1017            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1018            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1019            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  1020
  1021     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1022     12  FILLER                            PIC X(120).
  1023
  1024     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1025         16  AM-CONTROL-NAME               PIC X(30).
  1026         16  AM-EXECUTIVE-ONE.
  1027             20  AM-EXEC1-NAME             PIC X(15).
  1028             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1029                                                          COMP-3.
  1030             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1031                                                          COMP-3.
  1032         16  AM-EXECUTIVE-TWO.
  1033             20  AM-EXEC2-NAME             PIC X(15).
  1034             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1035                                                          COMP-3.
  1036             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1037                                                          COMP-3.
  1038
  1039     12  AM-RETRO-ADDITIONAL-DATA.
  1040         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1041         16  AM-RETRO-PREM-P-E             PIC X.
  1042         16  AM-RETRO-CLMS-P-I             PIC X.
  1043         16  AM-RETRO-RET-BRACKET-LF.
  1044             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1045                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1046                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1047             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1048                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1049                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1050             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1051                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1052                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1053         16  AM-RETRO-RET-BRACKET-AH.
  1054             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1055                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1056                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1057                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  20
* SOCK04BL.cbl
  1058             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1059                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1060                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1061             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1062                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1063                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1064
  1065     12  AM-COMMENTS.
  1066         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1067
  1068     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1069         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1070         16  AM-FLI-BILLING-CODE           PIC X.
  1071         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1072         16  AM-FLI-UNITED-IDENT           PIC X.
  1073         16  AM-FLI-INTEREST-LOST-DATA.
  1074             20  AM-FLI-BANK-NO            PIC X(5).
  1075             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1076             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1077             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  1078         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1079             20  AM-FLI-AGT                PIC X(9).
  1080             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1081             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1082         16  FILLER                        PIC X(102).
  1083
  1084     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1085         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1086             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1087             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1088             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1089             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1090             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1091         16  FILLER                          PIC X(10).
  1092******************************************************************
  1093*                                 COPY ERCCOMP.
  1094******************************************************************
  1095*                                                                *
  1096*                                                                *
  1097*                            ERCCOMP                             *
  1098*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1099*                            VMOD=2.019                          *
  1100*                                                                *
  1101*   ONLINE CREDIT SYSTEM                                         *
  1102*                                                                *
  1103*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1104*                                                                *
  1105*   FILE TYPE = VSAM,KSDS                                        *
  1106*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1107*                                                                *
  1108*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1109*       ALTERNATE PATH = NONE                                    *
  1110*                                                                *
  1111*   LOG = NO                                                     *
  1112*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1113*                                                                *
  1114******************************************************************
  1115*                   C H A N G E   L O G
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  21
* SOCK04BL.cbl
  1116*
  1117* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1118*-----------------------------------------------------------------
  1119*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1120* EFFECTIVE    NUMBER
  1121*-----------------------------------------------------------------
  1122* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1123* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1124* 092205    2005050300006  PEMA  ADD LEASE FEE
  1125* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1126* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1127* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1128* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1129* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1130* 071712  CR2012042700005  PEMA  ADD OVER 120 FOR AHL ONLY
  1131******************************************************************
  1132
  1133 01  COMPENSATION-MASTER.
  1134     12  CO-RECORD-ID                          PIC XX.
  1135         88  VALID-CO-ID                          VALUE 'CO'.
  1136
  1137     12  CO-CONTROL-PRIMARY.
  1138         16  CO-COMPANY-CD                     PIC X.
  1139         16  CO-CONTROL.
  1140             20  CO-CTL-1.
  1141                 24  CO-CARR-GROUP.
  1142                     28  CO-CARRIER            PIC X.
  1143                     28  CO-GROUPING.
  1144                         32  CO-GROUP-PREFIX   PIC XXX.
  1145                         32  CO-GROUP-PRIME    PIC XXX.
  1146                 24  CO-RESP-NO.
  1147                     28  CO-RESP-PREFIX        PIC X(4).
  1148                     28  CO-RESP-PRIME         PIC X(6).
  1149             20  CO-CTL-2.
  1150                 24  CO-ACCOUNT.
  1151                     28  CO-ACCT-PREFIX        PIC X(4).
  1152                     28  CO-ACCT-PRIME         PIC X(6).
  1153         16  CO-TYPE                           PIC X.
  1154             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1155             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1156             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1157
  1158     12  CO-MAINT-INFORMATION.
  1159         16  CO-LAST-MAINT-DT                  PIC XX.
  1160         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1161         16  CO-LAST-MAINT-USER                PIC X(4).
  1162     12  FILLER                                PIC XX.
  1163     12  CO-STMT-TYPE                          PIC XXX.
  1164     12  CO-COMP-TYPE                          PIC X.
  1165         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1166     12  CO-STMT-OWNER                         PIC X(4).
  1167     12  CO-BALANCE-CONTROL                    PIC X.
  1168         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1169         88  CO-NO-BALANCE                        VALUE 'N'.
  1170
  1171     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1172         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1173         88  CO-AUTO-GENERATED                    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  22
* SOCK04BL.cbl
  1174         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1175
  1176     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1177         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1178         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1179
  1180     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1181     12  CO-GA-DIRECT-DEP                      PIC X.
  1182     12  CO-FUTURE-SPACE                       PIC X.
  1183         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1184
  1185     12  CO-ACCT-NAME                          PIC X(30).
  1186     12  CO-MAIL-NAME                          PIC X(30).
  1187     12  CO-ADDR-1                             PIC X(30).
  1188     12  CO-ADDR-2                             PIC X(30).
  1189     12  CO-ADDR-3.
  1190         16  CO-ADDR-CITY                      PIC X(27).
  1191         16  CO-ADDR-STATE                     PIC XX.
  1192     12  CO-CSO-1099                           PIC X.
  1193     12  CO-ZIP.
  1194         16  CO-ZIP-PRIME.
  1195             20  CO-ZIP-PRI-1ST                PIC X.
  1196                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1197             20  FILLER                        PIC X(4).
  1198         16  CO-ZIP-PLUS4                      PIC X(4).
  1199     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1200         16  CO-CAN-POSTAL-1                   PIC XXX.
  1201         16  CO-CAN-POSTAL-2                   PIC XXX.
  1202         16  FILLER                            PIC XXX.
  1203     12  CO-SOC-SEC                            PIC X(13).
  1204     12  CO-TELEPHONE.
  1205         16  CO-AREA-CODE                      PIC XXX.
  1206         16  CO-PREFIX                         PIC XXX.
  1207         16  CO-PHONE                          PIC X(4).
  1208
  1209     12  CO-ROLADEX-PRINT-DT                   PIC XX.
  1210
  1211     12  CO-AR-BAL-LEVEL                       PIC X.
  1212         88  CO-AR-REF-LVL                        VALUE '1'.
  1213         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1214         88  CO-AR-BILL-LVL                       VALUE '2'.
  1215         88  CO-AR-AGT-LVL                        VALUE '3'.
  1216         88  CO-AR-FR-LVL                         VALUE '4'.
  1217
  1218     12  CO-AR-NORMAL-PRINT                    PIC X.
  1219         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1220         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1221
  1222     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1223
  1224     12  CO-AR-REPORTING                       PIC X.
  1225         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1226         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1227
  1228     12  CO-AR-PULL-CHECK                      PIC X.
  1229         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1230         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1231
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  23
* SOCK04BL.cbl
  1232     12  CO-AR-BALANCE-PRINT                   PIC X.
  1233         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1234
  1235     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1236         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1237         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1238         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1239
  1240     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1241
  1242     12  CO-USER-CODE                          PIC X.
  1243     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1244
  1245******************************************************************
  1246*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1247*    THE LAST MONTH END RUN.
  1248******************************************************************
  1249
  1250     12  CO-LAST-ACTIVITY-DATE.
  1251         16  CO-ACT-YEAR                       PIC 99.
  1252         16  CO-ACT-MONTH                      PIC 99.
  1253         16  CO-ACT-DAY                        PIC 99.
  1254
  1255     12  CO-LAST-STMT-DT.
  1256         16  CO-LAST-STMT-YEAR                 PIC 99.
  1257         16  CO-LAST-STMT-MONTH                PIC 99.
  1258         16  CO-LAST-STMT-DAY                  PIC 99.
  1259
  1260     12  CO-MO-END-TOTALS.
  1261         16  CO-MONTHLY-TOTALS.
  1262             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1263             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1264             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1265             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1266             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1267
  1268         16  CO-AGING-TOTALS.
  1269             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1270             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1271             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1272             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1273
  1274         16  CO-YTD-TOTALS.
  1275             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1276             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1277
  1278         16  CO-OVER-UNDER-TOTALS.
  1279             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1280             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1281
  1282     12  CO-MISCELLANEOUS-TOTALS.
  1283         16  CO-FICA-TOTALS.
  1284             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1285             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1286
  1287         16  CO-CLAIM-TOTALS.
  1288             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1289             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  24
* SOCK04BL.cbl
  1290
  1291******************************************************************
  1292*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1293*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1294******************************************************************
  1295
  1296     12  CO-CURRENT-TOTALS.
  1297         16  CO-CURRENT-LAST-STMT-DT.
  1298             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1299             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1300             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1301
  1302         16  CO-CURRENT-MONTHLY-TOTALS.
  1303             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1304             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1305             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1306             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1307             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1308
  1309         16  CO-CURRENT-AGING-TOTALS.
  1310             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1311             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1312             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1313             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1314
  1315         16  CO-CURRENT-YTD-TOTALS.
  1316             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1317             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1318
  1319     12  CO-PAID-COMM-TOTALS.
  1320         16  CO-YTD-PAID-COMMS.
  1321             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1322             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1323
  1324     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1325         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
  1326         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1327
  1328     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1329         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1330         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1331         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1332         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1333         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1334         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1335         88  CO-FINAL-LETTER                  VALUE 'F'.
  1336         88  CO-RECONCILING                   VALUE 'R'.
  1337         88  CO-PHONE-CALL                    VALUE 'P'.
  1338         88  CO-LEGAL                         VALUE 'L'.
  1339         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1340         88  CO-WRITE-OFF                     VALUE 'W'.
  1341         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1342
  1343     12  CO-CSR-CODE                       PIC X(4).
  1344
  1345     12  CO-GA-STATUS-INFO.
  1346         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1347         16  CO-GA-TERMINATION-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  25
* SOCK04BL.cbl
  1348         16  CO-GA-STATUS-CODE             PIC X.
  1349             88  CO-GA-ACTIVE                 VALUE 'A'.
  1350             88  CO-GA-INACTIVE               VALUE 'I'.
  1351             88  CO-GA-PENDING                VALUE 'P'.
  1352         16  CO-GA-COMMENTS.
  1353             20  CO-GA-COMMENT-1           PIC X(40).
  1354             20  CO-GA-COMMENT-2           PIC X(40).
  1355             20  CO-GA-COMMENT-3           PIC X(40).
  1356             20  CO-GA-COMMENT-4           PIC X(40).
  1357
  1358     12  CO-RPTCD2                         PIC X(10).
  1359     12  CO-AHL-OVER120-DATA REDEFINES CO-RPTCD2.
  1360         16  CO-OV120                      PIC S9(7)V99   COMP-3.
  1361         16  CO-CURRENT-OV120              PIC S9(7)V99   COMP-3.
  1362
  1363     12  CO-TYPE-AGENT                     PIC X(01).
  1364         88  CO-CORPORATION                   VALUE 'C'.
  1365         88  CO-PARTNERSHIP                   VALUE 'P'.
  1366         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1367         88  CO-TRUST                         VALUE 'T'.
  1368         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1369
  1370     12  CO-FAXNO.
  1371         16  CO-FAX-AREA-CODE                  PIC XXX.
  1372         16  CO-FAX-PREFIX                     PIC XXX.
  1373         16  CO-FAX-PHONE                      PIC X(4).
  1374
  1375     12  CO-BANK-INFORMATION.
  1376         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1377         16  CO-BANK-TRANSIT-NON REDEFINES
  1378             CO-BANK-TRANSIT-NO                PIC 9(8).
  1379
  1380         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1381     12  CO-MISC-DEDUCT-INFO REDEFINES
  1382                  CO-BANK-INFORMATION.
  1383         16  CO-MD-GL-ACCT                     PIC X(10).
  1384         16  CO-MD-DIV                         PIC XX.
  1385         16  CO-MD-CENTER                      PIC X(4).
  1386         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
  1387         16  CO-CREATE-AP-CHECK                PIC X.
  1388         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1389         16  FILLER                            PIC XXX.
  1390     12  CO-ACH-STATUS                         PIC X.
  1391         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1392         88  CO-ACH-PENDING                        VALUE 'P'.
  1393
  1394     12  CO-BILL-SW                            PIC X.
  1395     12  CO-CONTROL-NAME                       PIC X(30).
  1396     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1397     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1398     12  CO-CLP-STATE                          PIC XX.
  1399     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1400     12  CO-SPP-REFUND-EDIT                    PIC X.
  1401
  1402******************************************************************
  1403*                                 COPY ERCCNOT.
  1404******************************************************************
  1405*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  26
* SOCK04BL.cbl
  1406*                            ERCCNOT                             *
  1407*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1408*                            VMOD=2.003                          *
  1409*                                                                *
  1410*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  1411*                                                                *
  1412*        FILE TYPE= VSAM,KSDS                                    *
  1413*        RECORD SIZE = 150    RECFORM = FIXED                    *
  1414*                                                                *
  1415*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  1416*                                                                *
  1417*        LOG = YES                                               *
  1418*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  1419*                                                                *
  1420******************************************************************
  1421*                   C H A N G E   L O G
  1422*
  1423* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1424*-----------------------------------------------------------------
  1425*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1426* EFFECTIVE    NUMBER
  1427*-----------------------------------------------------------------
  1428* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  1429******************************************************************
  1430
  1431 01  CERT-NOTE-FILE.
  1432     12  CZ-RECORD-ID                PIC  XX.
  1433         88  VALID-CZ-ID                  VALUE 'CZ'.
  1434
  1435     12  CZ-CONTROL-PRIMARY.
  1436         16  CZ-COMPANY-CD           PIC X.
  1437         16  CZ-CARRIER              PIC X.
  1438         16  CZ-GROUPING.
  1439             20 CZ-GROUPING-PREFIX   PIC XXX.
  1440             20 CZ-GROUPING-PRIME    PIC XXX.
  1441         16  CZ-STATE                PIC XX.
  1442         16  CZ-ACCOUNT.
  1443             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  1444             20 CZ-ACCOUNT-PRIME     PIC X(6).
  1445         16  CZ-CERT-EFF-DT          PIC XX.
  1446         16  CZ-CERT-NO.
  1447             20  CZ-CERT-PRIME       PIC X(10).
  1448             20  CZ-CERT-SFX         PIC X.
  1449         16  CZ-RECORD-TYPE          PIC X.
  1450             88  CERT-NOTE           VALUE '1'.
  1451             88  CLAIM-CERT-NOTE     VALUE '2'.
  1452         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  1453
  1454     12  CZ-LAST-MAINT-DT            PIC XX.
  1455     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  1456     12  CZ-LAST-MAINT-USER          PIC X(4).
  1457
  1458     12  CZ-NOTE-INFORMATION.
  1459         16  CZ-NOTE                 PIC X(63).
  1460         16  FILLER                  PIC X(39).
  1461******************************************************************
  1462*                                 COPY ELCDATE.
  1463******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  27
* SOCK04BL.cbl
  1464*                                                                *
  1465*                                                                *
  1466*                            ELCDATE.                            *
  1467*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1468*                            VMOD=2.003
  1469*                                                                *
  1470*                                                                *
  1471*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1472*                 LENGTH = 200                                   *
  1473******************************************************************
  1474
  1475 01  DATE-CONVERSION-DATA.
  1476     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1477     12  DC-OPTION-CODE                PIC X.
  1478         88  BIN-TO-GREG                VALUE ' '.
  1479         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1480         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1481         88  YMD-GREG-TO-BIN            VALUE '3'.
  1482         88  MDY-GREG-TO-BIN            VALUE '4'.
  1483         88  JULIAN-TO-BIN              VALUE '5'.
  1484         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1485         88  FIND-CENTURY               VALUE '7'.
  1486         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1487         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1488         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1489         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1490         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1491         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1492         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1493         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1494         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1495         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1496         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1497         88  BIN-3-TO-GREG              VALUE 'I'.
  1498         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1499         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1500         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1501         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1502         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1503         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1504         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1505         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1506         88  THREE-CHARACTER-BIN
  1507                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1508         88  GREGORIAN-TO-BIN
  1509                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1510         88  BIN-TO-GREGORIAN
  1511                  VALUES ' ' '1' 'I' '8' 'G'.
  1512         88  JULIAN-TO-BINARY
  1513                  VALUES '5' 'C' 'E' 'F'.
  1514     12  DC-ERROR-CODE                 PIC X.
  1515         88  NO-CONVERSION-ERROR        VALUE ' '.
  1516         88  DATE-CONVERSION-ERROR
  1517                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1518         88  DATE-IS-ZERO               VALUE '1'.
  1519         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1520         88  DATE-IS-INVALID            VALUE '3'.
  1521         88  DATE1-GREATER-DATE2        VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  28
* SOCK04BL.cbl
  1522         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1523         88  DATE-INVALID-OPTION        VALUE '9'.
  1524         88  INVALID-CENTURY            VALUE 'A'.
  1525         88  ONLY-CENTURY               VALUE 'B'.
  1526         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1527         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1528     12  DC-END-OF-MONTH               PIC X.
  1529         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1530     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1531         88  USE-NORMAL-PROCESS         VALUE ' '.
  1532         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1533         88  ADJUST-UP-100-YRS          VALUE '2'.
  1534     12  FILLER                        PIC X.
  1535     12  DC-CONVERSION-DATES.
  1536         16  DC-BIN-DATE-1             PIC XX.
  1537         16  DC-BIN-DATE-2             PIC XX.
  1538         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1539         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1540                       DC-GREG-DATE-1-EDIT.
  1541             20  DC-EDIT1-MONTH        PIC 99.
  1542             20  SLASH1-1              PIC X.
  1543             20  DC-EDIT1-DAY          PIC 99.
  1544             20  SLASH1-2              PIC X.
  1545             20  DC-EDIT1-YEAR         PIC 99.
  1546         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1547         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1548                     DC-GREG-DATE-2-EDIT.
  1549             20  DC-EDIT2-MONTH        PIC 99.
  1550             20  SLASH2-1              PIC X.
  1551             20  DC-EDIT2-DAY          PIC 99.
  1552             20  SLASH2-2              PIC X.
  1553             20  DC-EDIT2-YEAR         PIC 99.
  1554         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1555         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1556                     DC-GREG-DATE-1-YMD.
  1557             20  DC-YMD-YEAR           PIC 99.
  1558             20  DC-YMD-MONTH          PIC 99.
  1559             20  DC-YMD-DAY            PIC 99.
  1560         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1561         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1562                      DC-GREG-DATE-1-MDY.
  1563             20  DC-MDY-MONTH          PIC 99.
  1564             20  DC-MDY-DAY            PIC 99.
  1565             20  DC-MDY-YEAR           PIC 99.
  1566         16  DC-GREG-DATE-1-ALPHA.
  1567             20  DC-ALPHA-MONTH        PIC X(10).
  1568             20  DC-ALPHA-DAY          PIC 99.
  1569             20  FILLER                PIC XX.
  1570             20  DC-ALPHA-CENTURY.
  1571                 24 DC-ALPHA-CEN-N     PIC 99.
  1572             20  DC-ALPHA-YEAR         PIC 99.
  1573         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1574         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1575         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1576         16  DC-JULIAN-DATE            PIC 9(05).
  1577         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1578                                       PIC 9(05).
  1579         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  29
* SOCK04BL.cbl
  1580             20  DC-JULIAN-YEAR        PIC 99.
  1581             20  DC-JULIAN-DAYS        PIC 999.
  1582         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1583         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1584         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1585     12  DATE-CONVERSION-VARIBLES.
  1586         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1587         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1588             20  FILLER                PIC 9(3).
  1589             20  HOLD-CEN-1-CCYY.
  1590                 24  HOLD-CEN-1-CC     PIC 99.
  1591                 24  HOLD-CEN-1-YY     PIC 99.
  1592             20  HOLD-CEN-1-MO         PIC 99.
  1593             20  HOLD-CEN-1-DA         PIC 99.
  1594         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1595             20  HOLD-CEN-1-R-MO       PIC 99.
  1596             20  HOLD-CEN-1-R-DA       PIC 99.
  1597             20  HOLD-CEN-1-R-CCYY.
  1598                 24  HOLD-CEN-1-R-CC   PIC 99.
  1599                 24  HOLD-CEN-1-R-YY   PIC 99.
  1600             20  FILLER                PIC 9(3).
  1601         16  HOLD-CENTURY-1-X.
  1602             20  FILLER                PIC X(3)  VALUE SPACES.
  1603             20  HOLD-CEN-1-X-CCYY.
  1604                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1605                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1606             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1607             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1608         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1609             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1610             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1611             20  HOLD-CEN-1-R-X-CCYY.
  1612                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1613                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1614             20  FILLER                PIC XXX.
  1615         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1616         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1617         16  DC-JULIAN-DATE-1          PIC 9(07).
  1618         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1619             20  DC-JULIAN-1-CCYY.
  1620                 24  DC-JULIAN-1-CC    PIC 99.
  1621                 24  DC-JULIAN-1-YR    PIC 99.
  1622             20  DC-JULIAN-DA-1        PIC 999.
  1623         16  DC-JULIAN-DATE-2          PIC 9(07).
  1624         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1625             20  DC-JULIAN-2-CCYY.
  1626                 24  DC-JULIAN-2-CC    PIC 99.
  1627                 24  DC-JULIAN-2-YR    PIC 99.
  1628             20  DC-JULIAN-DA-2        PIC 999.
  1629         16  DC-GREG-DATE-A-EDIT.
  1630             20  DC-EDITA-MONTH        PIC 99.
  1631             20  SLASHA-1              PIC X VALUE '/'.
  1632             20  DC-EDITA-DAY          PIC 99.
  1633             20  SLASHA-2              PIC X VALUE '/'.
  1634             20  DC-EDITA-CCYY.
  1635                 24  DC-EDITA-CENT     PIC 99.
  1636                 24  DC-EDITA-YEAR     PIC 99.
  1637         16  DC-GREG-DATE-B-EDIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  30
* SOCK04BL.cbl
  1638             20  DC-EDITB-MONTH        PIC 99.
  1639             20  SLASHB-1              PIC X VALUE '/'.
  1640             20  DC-EDITB-DAY          PIC 99.
  1641             20  SLASHB-2              PIC X VALUE '/'.
  1642             20  DC-EDITB-CCYY.
  1643                 24  DC-EDITB-CENT     PIC 99.
  1644                 24  DC-EDITB-YEAR     PIC 99.
  1645         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1646         16  DC-GREG-DATE-CYMD-R REDEFINES
  1647                              DC-GREG-DATE-CYMD.
  1648             20  DC-CYMD-CEN           PIC 99.
  1649             20  DC-CYMD-YEAR          PIC 99.
  1650             20  DC-CYMD-MONTH         PIC 99.
  1651             20  DC-CYMD-DAY           PIC 99.
  1652         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1653         16  DC-GREG-DATE-MDCY-R REDEFINES
  1654                              DC-GREG-DATE-MDCY.
  1655             20  DC-MDCY-MONTH         PIC 99.
  1656             20  DC-MDCY-DAY           PIC 99.
  1657             20  DC-MDCY-CEN           PIC 99.
  1658             20  DC-MDCY-YEAR          PIC 99.
  1659    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1660        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1661    12  DC-EL310-DATE                  PIC X(21).
  1662    12  FILLER                         PIC X(28).
  1663****************************************************************
  1664*
  1665* Copyright (c) 2007-2013 Dell Inc.
  1666* All rights reserved.
  1667*
  1668****************************************************************
  1669 01  DFHEIV.
  1670   02  DFHEIV0               PIC X(35).
  1671   02  DFHEIV1               PIC X(08).
  1672   02  DFHEIV2               PIC X(08).
  1673   02  DFHEIV3               PIC X(08).
  1674   02  DFHEIV4               PIC X(06).
  1675   02  DFHEIV5               PIC X(04).
  1676   02  DFHEIV6               PIC X(04).
  1677   02  DFHEIV7               PIC X(02).
  1678   02  DFHEIV8               PIC X(02).
  1679   02  DFHEIV9               PIC X(01).
  1680   02  DFHEIV10              PIC S9(7) COMP-3.
  1681   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1682   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1683   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1684   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1685   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1686   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1687   02  DFHEIV17              PIC X(04).
  1688   02  DFHEIV18              PIC X(04).
  1689   02  DFHEIV19              PIC X(04).
  1690   02  DFHEIV20              USAGE IS POINTER.
  1691   02  DFHEIV21              USAGE IS POINTER.
  1692   02  DFHEIV22              USAGE IS POINTER.
  1693   02  DFHEIV23              USAGE IS POINTER.
  1694   02  DFHEIV24              USAGE IS POINTER.
  1695   02  DFHEIV25              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  31
* SOCK04BL.cbl
  1696   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1697   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1698   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1699   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1700   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1701   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1702   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1703   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1704   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1705   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1706   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1707   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1708   02  FILLER                PIC X(02).
  1709   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1710   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1711   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1712   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1713   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1714   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1715   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1716 LINKAGE  SECTION.
  1717*****************************************************************
  1718*                                                               *
  1719* Copyright (c) 2007-2013 Dell Inc.                             *
  1720* All rights reserved.                                          *
  1721*                                                               *
  1722*****************************************************************
  1723 01  dfheiblk.
  1724     02  eibtime          pic s9(7) comp-3.
  1725     02  eibdate          pic s9(7) comp-3.
  1726     02  eibtrnid         pic x(4).
  1727     02  eibtaskn         pic s9(7) comp-3.
  1728     02  eibtrmid         pic x(4).
  1729     02  dfheigdi         pic s9(4) comp.
  1730     02  eibcposn         pic s9(4) comp.
  1731     02  eibcalen         pic s9(4) comp.
  1732     02  eibaid           pic x(1).
  1733     02  eibfiller1       pic x(1).
  1734     02  eibfn            pic x(2).
  1735     02  eibfiller2       pic x(2).
  1736     02  eibrcode         pic x(6).
  1737     02  eibfiller3       pic x(2).
  1738     02  eibds            pic x(8).
  1739     02  eibreqid         pic x(8).
  1740     02  eibrsrce         pic x(8).
  1741     02  eibsync          pic x(1).
  1742     02  eibfree          pic x(1).
  1743     02  eibrecv          pic x(1).
  1744     02  eibsend          pic x(1).
  1745     02  eibatt           pic x(1).
  1746     02  eibeoc           pic x(1).
  1747     02  eibfmh           pic x(1).
  1748     02  eibcompl         pic x(1).
  1749     02  eibsig           pic x(1).
  1750     02  eibconf          pic x(1).
  1751     02  eiberr           pic x(1).
  1752     02  eibrldbk         pic x(1).
  1753     02  eiberrcd         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  32
* SOCK04BL.cbl
  1754     02  eibsynrb         pic x(1).
  1755     02  eibnodat         pic x(1).
  1756     02  eibfiller5       pic x(2).
  1757     02  eibresp          pic s9(8) comp.
  1758     02  eibresp2         pic s9(8) comp.
  1759     02  dfheigdj         pic s9(4) comp.
  1760     02  dfheigdk         pic s9(4) comp.
  1761 01  DFHCOMMAREA.
  1762*                                copy SOCK04-COMMAREA.
  1763*****************************************************************
  1764*                                                               *
  1765* Copyright (c) 2015 by CSO.                                    *
  1766* All rights reserved.                                          *
  1767*                                                               *
  1768*****************************************************************
  1769****************************************
  1770*  commarea for SOCK04.cl2
  1771*  (business logic input & output)
  1772****************************************
  1773 03  socket-commarea.
  1774     05 sock-IN-DATA.
  1775         10  sock-CAR          PIC X.
  1776         10  sock-GRP          PIC X(6).
  1777         10  sock-ST           PIC XX.
  1778         10  sock-ACT          PIC X(10).
  1779         10  sock-EFF-DT       PIC X(8).
  1780         10  sock-cert-no      pic x(11).
  1781         10  sock-ID           PIC XXX.
  1782         10  sock-proc-id      pic x(4).
  1783         10  sock-ACTION-TAKEN PIC X.
  1784         10  FILLER              PIC X(9).
  1785     05  sock-return-area.
  1786         10  sock-am-name        pic x(30).
  1787         10  sock-am-person      pic x(30).
  1788         10  sock-am-cntrl-name  pic x(30).
  1789         10  sock-am-phone       pic x(10).
  1790         10  sock-co-fax         pic x(10).
  1791         10  sock-co-contact     pic x(30).
  1792 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1793 0000-DFHEXIT SECTION.
  1794     MOVE '9#                    $   ' TO DFHEIV0.
  1795     MOVE 'SOCK04BL' TO DFHEIV1.
  1796     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1797     display ' Begin SOCK04BL =' SOCK-IN-DATA '='
  1798     perform 0010-init           thru 0010-exit
  1799     perform 0100-process-request thru 0100-exit
  1800     GO TO cics-return
  1801     .
  1802 0010-init.
  1803
  1804* exec cics
  1805*       asktime
  1806*    end-exec
  1807*    MOVE '0"                    "   #00001799' TO DFHEIV0
  1808     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  1809     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  1810     MOVE X'2020233030303031373939' TO DFHEIV0(25:11)
  1811     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  33
* SOCK04BL.cbl
  1812           DFHEIV99
  1813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1814     display ' eibtime ' eibtime
  1815     display ' eibdate ' eibdate
  1816     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  1817     MOVE '5'                    TO DC-OPTION-CODE
  1818     perform 9700-date-link      thru 9700-exit
  1819     IF DATE-CONVERSION-ERROR
  1820        display ' error converting eibdate '
  1821        MOVE LOW-VALUES          TO ws-current-bin-dt
  1822     ELSE
  1823        MOVE DC-BIN-DATE-1       TO ws-current-bin-dt
  1824     end-if
  1825     move sock-id                to ws-comp-id
  1826     evaluate true
  1827        when ws-comp-id = 'AHL'
  1828           MOVE X'06'            TO ws-comp-cd
  1829        when ws-comp-id = 'DCC'
  1830           move X'05'            to ws-comp-cd
  1831        when ws-comp-id = 'VPP'
  1832           move X'07'            to ws-comp-cd
  1833        when ws-comp-id = 'FNL'
  1834           move X'08'            to ws-comp-cd
  1835        when other
  1836           move X'04'            to ws-comp-cd
  1837     end-evaluate
  1838     move sock-eff-dt            to dc-greg-date-1-edit
  1839     move '2'                    to dc-option-code
  1840     perform 9700-date-link      thru 9700-exit
  1841     if not no-conversion-error
  1842        display ' error converting eff date '
  1843        go to cics-return
  1844     end-if
  1845     move dc-bin-date-1          to ws-bin-cert-eff-dt
  1846     .
  1847 0010-exit.
  1848     exit.
  1849 0100-process-request.
  1850     perform 0110-get-elcert     thru 0110-exit
  1851     if resp-normal
  1852        perform 0120-process-cert-trailer
  1853                                 thru 0120-exit
  1854        perform 0150-process-cert-notes
  1855                                 thru 0150-exit
  1856        perform 0200-process-acct-comp
  1857                                 thru 0200-exit
  1858     end-if
  1859     .
  1860 0100-exit.
  1861     exit.
  1862 0110-get-elcert.
  1863     move low-values             to ws-cm-key
  1864     move ws-comp-cd             to ws-cm-company-cd
  1865     move sock-car               to ws-cm-carrier
  1866     move sock-grp               to ws-cm-group
  1867     move sock-st                to ws-cm-state
  1868     move sock-act               to ws-cm-account
  1869     move ws-bin-cert-eff-dt     to ws-cm-eff-dt
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  34
* SOCK04BL.cbl
  1870     move sock-cert-no           to ws-cm-cert-no
  1871
  1872* EXEC CICS READ
  1873*         INTO    (CERTIFICATE-MASTER)
  1874*         DATASET ('ELCERT')
  1875*         RIDFLD  (WS-CM-KEY)
  1876*         RESP    (WS-RESPONSE)
  1877*    END-EXEC
  1878     MOVE LENGTH OF
  1879      CERTIFICATE-MASTER
  1880       TO DFHEIV11
  1881     MOVE 'ELCERT' TO DFHEIV1
  1882*    MOVE '&"IL       E          (  N#00001860' TO DFHEIV0
  1883     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1884     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1885     MOVE X'204E233030303031383630' TO DFHEIV0(25:11)
  1886     CALL 'kxdfhei1' USING DFHEIV0,
  1887           DFHEIV1,
  1888           CERTIFICATE-MASTER,
  1889           DFHEIV11,
  1890           WS-CM-KEY,
  1891           DFHEIV99,
  1892           DFHEIV99,
  1893           DFHEIV99
  1894     MOVE EIBRESP  TO WS-RESPONSE
  1895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1896     .
  1897 0110-exit.
  1898     exit.
  1899 0120-process-cert-trailer.
  1900     perform 0121-read-elcrtt    thru 0121-exit
  1901     evaluate true
  1902        when resp-normal
  1903           perform 0122-upd-elcrtt
  1904                                 thru 0122-exit
  1905        when resp-notfnd
  1906           perform 0123-add-elcrtt
  1907                                 thru 0123-exit
  1908        when other
  1909           display ' error cert trlr ' ws-response
  1910           go to cics-return
  1911     end-evaluate
  1912     .
  1913 0120-exit.
  1914     exit.
  1915 0121-read-elcrtt.
  1916     move cm-control-primary     to ws-cs-key
  1917     move 'C'                    to ws-cs-trlr-type
  1918
  1919* EXEC CICS READ
  1920*       UPDATE
  1921*       INTO    (CERTIFICATE-TRAILERS)
  1922*       DATASET ('ELCRTT')
  1923*       RIDFLD  (WS-CS-KEY)
  1924*       RESP    (WS-RESPONSE)
  1925*    END-EXEC
  1926     MOVE LENGTH OF
  1927      CERTIFICATE-TRAILERS
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  35
* SOCK04BL.cbl
  1928       TO DFHEIV11
  1929     MOVE 'ELCRTT' TO DFHEIV1
  1930*    MOVE '&"IL       EU         (  N#00001890' TO DFHEIV0
  1931     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  1932     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1933     MOVE X'204E233030303031383930' TO DFHEIV0(25:11)
  1934     CALL 'kxdfhei1' USING DFHEIV0,
  1935           DFHEIV1,
  1936           CERTIFICATE-TRAILERS,
  1937           DFHEIV11,
  1938           WS-CS-KEY,
  1939           DFHEIV99,
  1940           DFHEIV99,
  1941           DFHEIV99
  1942     MOVE EIBRESP  TO WS-RESPONSE
  1943     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1944     .
  1945 0121-exit.
  1946     exit.
  1947 0122-upd-elcrtt.
  1948     move sock-action-taken      to cs-agent-edit-status
  1949     if cs-agent-edit-status = 'C' or 'S' or 'U' or 'R' or
  1950                               'M' or 'N' or 'H'
  1951        move spaces              to cs-agent-name
  1952                                    cs-license-no
  1953                                    cs-npn-number
  1954     end-if
  1955     evaluate cs-agent-edit-status
  1956        when 'U'
  1957           move 'Unidentified'   to cs-agent-name
  1958        when 'R'
  1959           move 'Returned'       to cs-agent-name
  1960        when 'N'
  1961           move 'Accept with no commission'
  1962                                 to cs-agent-name
  1963        when 'H'
  1964           move 'Home Office'    to cs-agent-name
  1965     end-evaluate
  1966
  1967* EXEC CICS REWRITE
  1968*       DATASET ('ELCRTT')
  1969*       FROM    (CERTIFICATE-TRAILERS)
  1970*       RESP    (WS-RESPONSE)
  1971*    END-EXEC
  1972     MOVE LENGTH OF
  1973      CERTIFICATE-TRAILERS
  1974       TO DFHEIV11
  1975     MOVE 'ELCRTT' TO DFHEIV1
  1976*    MOVE '&& L                  %  N#00001920' TO DFHEIV0
  1977     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1978     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1979     MOVE X'204E233030303031393230' TO DFHEIV0(25:11)
  1980     CALL 'kxdfhei1' USING DFHEIV0,
  1981           DFHEIV1,
  1982           CERTIFICATE-TRAILERS,
  1983           DFHEIV11,
  1984           DFHEIV99
  1985     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  36
* SOCK04BL.cbl
  1986     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1987     .
  1988 0122-exit.
  1989     exit.
  1990 0123-add-elcrtt.
  1991     move 'CS'                   to certificate-trailers
  1992     move cm-control-primary     to cs-control-primary
  1993     move 'C'                    to cs-trailer-type
  1994     move sock-action-taken    to cs-agent-edit-status
  1995     evaluate cs-agent-edit-status
  1996        when 'U'
  1997           move 'Unidentified'   to cs-agent-name
  1998        when 'R'
  1999           move 'Returned'       to cs-agent-name
  2000        when 'N'
  2001           move 'Accept with no commission'
  2002                                 to cs-agent-name
  2003        when 'H'
  2004           move 'Home Office'    to cs-agent-name
  2005     end-evaluate
  2006
  2007* EXEC CICS WRITE
  2008*       DATASET ('ELCRTT')
  2009*       FROM    (CERTIFICATE-TRAILERS)
  2010*       RIDFLD  (cs-control-primary)
  2011*       RESP    (WS-RESPONSE)
  2012*    END-EXEC
  2013     MOVE LENGTH OF
  2014      CERTIFICATE-TRAILERS
  2015       TO DFHEIV11
  2016     MOVE 'ELCRTT' TO DFHEIV1
  2017*    MOVE '&$ L                  ''  N#00001945' TO DFHEIV0
  2018     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2019     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2020     MOVE X'204E233030303031393435' TO DFHEIV0(25:11)
  2021     CALL 'kxdfhei1' USING DFHEIV0,
  2022           DFHEIV1,
  2023           CERTIFICATE-TRAILERS,
  2024           DFHEIV11,
  2025           cs-control-primary,
  2026           DFHEIV99,
  2027           DFHEIV99
  2028     MOVE EIBRESP  TO WS-RESPONSE
  2029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2030     .
  2031 0123-exit.
  2032     exit.
  2033 0150-process-cert-notes.
  2034     move spaces                 to cert-note-records-holder
  2035                                    ws-build-note-sw
  2036                                    ws-ercnot-sw
  2037     move cm-control-primary     to ws-cz-key
  2038     move '1'                    to ws-cz-rec-type
  2039     move +0                     to ws-cz-note-seq
  2040                                    c1
  2041
  2042* EXEC CICS STARTBR
  2043*         DATASET    ('ERCNOT')
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  37
* SOCK04BL.cbl
  2044*         RIDFLD     (WS-CZ-KEY)
  2045*         GTEQ
  2046*         RESP       (WS-RESPONSE)
  2047*    END-EXEC
  2048     MOVE 'ERCNOT' TO DFHEIV1
  2049     MOVE 0
  2050       TO DFHEIV11
  2051*    MOVE '&,         G          &  N#00001963' TO DFHEIV0
  2052     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2053     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2054     MOVE X'204E233030303031393633' TO DFHEIV0(25:11)
  2055     CALL 'kxdfhei1' USING DFHEIV0,
  2056           DFHEIV1,
  2057           WS-CZ-KEY,
  2058           DFHEIV99,
  2059           DFHEIV11,
  2060           DFHEIV99
  2061     MOVE EIBRESP  TO WS-RESPONSE
  2062     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2063     IF RESP-NORMAL
  2064        set ercnot-startbr to true
  2065        perform until finished-with-notes
  2066
  2067* EXEC CICS READNEXT
  2068*             DATASET    ('ERCNOT')
  2069*             RIDFLD     (WS-CZ-KEY)
  2070*             INTO       (cert-note-file)
  2071*             resp       (ws-response)
  2072*          end-exec
  2073     MOVE LENGTH OF
  2074      cert-note-file
  2075       TO DFHEIV12
  2076     MOVE 'ERCNOT' TO DFHEIV1
  2077     MOVE 0
  2078       TO DFHEIV11
  2079*    MOVE '&.IL                  )  N#00001973' TO DFHEIV0
  2080     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2081     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2082     MOVE X'204E233030303031393733' TO DFHEIV0(25:11)
  2083     CALL 'kxdfhei1' USING DFHEIV0,
  2084           DFHEIV1,
  2085           cert-note-file,
  2086           DFHEIV12,
  2087           WS-CZ-KEY,
  2088           DFHEIV99,
  2089           DFHEIV11,
  2090           DFHEIV99,
  2091           DFHEIV99
  2092     MOVE EIBRESP  TO ws-response
  2093     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2094           if (resp-normal)
  2095              and (cz-control-primary (1:33) =
  2096                 cm-control-primary (1:33))
  2097              if cz-record-type = '1'
  2098                 add +1 to c1
  2099                 move cert-note-file
  2100                                 to cert-note-record (c1)
  2101              end-if
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  38
* SOCK04BL.cbl
  2102           else
  2103              set finished-with-notes to true
  2104           end-if
  2105        end-perform
  2106     end-if
  2107     if ercnot-startbr
  2108
  2109* exec cics endbr
  2110*          dataset    ('ERCNOT')
  2111*       end-exec
  2112     MOVE 'ERCNOT' TO DFHEIV1
  2113     MOVE 0
  2114       TO DFHEIV11
  2115*    MOVE '&2                    $   #00001994' TO DFHEIV0
  2116     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2117     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2118     MOVE X'2020233030303031393934' TO DFHEIV0(25:11)
  2119     CALL 'kxdfhei1' USING DFHEIV0,
  2120           DFHEIV1,
  2121           DFHEIV11,
  2122           DFHEIV99
  2123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2124     end-if
  2125     move c1                     to note-count
  2126     if c1 = +0
  2127        perform 0151-add-verify-agent-sig-note
  2128                                 thru 0151-exit
  2129     else
  2130        if ((cnr-rest (1) (1:21) = 'AGENT CHECK SIGNATURE')
  2131           and (sock-action-taken = 'C'))
  2132                         or
  2133           ((cnr-rest (1) (1:23) = 'MISSING AGENT SIGNATURE')
  2134           and (sock-action-taken = 'S'))
  2135                         or
  2136           ((cnr-rest (1) (1:22) = 'UNIDENTIFIED SIGNATURE')
  2137           and (sock-action-taken = 'U'))
  2138                         or
  2139           ((cnr-rest (1) (1:20) = 'CERTIFICATE RETURNED')
  2140           and (sock-action-taken = 'R'))
  2141                         or
  2142           ((cnr-rest (1) (1:19) = 'REFERRED TO MANAGER')
  2143           and (sock-action-taken = 'M'))
  2144                         or
  2145           ((cnr-rest (1) (1:25) = 'ACCEPT WITH NO COMMISSION')
  2146           and (sock-action-taken = 'N'))
  2147                         or
  2148           ((cnr-rest (1) (1:17) = 'HOME OFFICE ISSUE')
  2149           and (sock-action-taken = 'H'))
  2150           go to 0150-exit
  2151        else
  2152           perform 0152-delete-cert-notes
  2153                                 thru 0152-exit
  2154           if resp-normal
  2155              perform 0151-add-verify-agent-sig-note
  2156                                 thru 0151-exit
  2157              if resp-normal
  2158                 perform 0153-put-back-cert-notes
  2159                                 thru 0153-exit
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  39
* SOCK04BL.cbl
  2160                 if resp-normal
  2161                    continue
  2162                 else
  2163                    display ' something wrong with put back '
  2164                       cm-cert-no
  2165                 end-if
  2166              else
  2167                 display ' something went wrong with adding note '
  2168                    cm-cert-no
  2169              end-if
  2170           else
  2171              display ' something went wrong with generic delete '
  2172                 cm-cert-no
  2173           end-if
  2174        end-if
  2175     end-if
  2176     .
  2177 0150-exit.
  2178     exit.
  2179 0151-add-verify-agent-sig-note.
  2180     move 'CZ'                to cert-note-file
  2181     move cm-control-primary  to cz-control-primary
  2182     move '1'                 to cz-record-type
  2183     move +1                  to cz-note-sequence
  2184     move ws-current-bin-dt   to cz-last-maint-dt
  2185     move eibtime             to cz-last-maint-hhmmss
  2186     move sock-proc-id        to cz-last-maint-user
  2187     evaluate true
  2188        when sock-action-taken = 'C'
  2189           MOVE 'AGENT CHECK SIGNATURE COVER SHEET GENERATED'
  2190                              to cz-note
  2191        when sock-action-taken = 'S'
  2192           move 'MISSING AGENT SIGNATURE FORM GENERATED'
  2193                              to cz-note
  2194        when sock-action-taken = 'U'
  2195           move 'UNIDENTIFIED SIGNATURE'
  2196                              to cz-note
  2197        when sock-action-taken = 'R'
  2198           move 'CERTIFICATE RETURNED'
  2199                              to cz-note
  2200        when sock-action-taken = 'N'
  2201           move 'ACCEPTED WITH NO COMMISSION'
  2202                              to cz-note
  2203        when sock-action-taken = 'H'
  2204           move 'HOME OFFICE ISSUE'
  2205                              to cz-note
  2206        when other
  2207           move 'REFERRED TO MANAGER'
  2208                              to cz-note
  2209     end-evaluate
  2210
  2211* exec cics write
  2212*       dataset   ('ERCNOT')
  2213*       from      (cert-note-file)
  2214*       ridfld    (cz-control-primary)
  2215*       resp      (ws-response)
  2216*    end-exec
  2217     MOVE LENGTH OF
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  40
* SOCK04BL.cbl
  2218      cert-note-file
  2219       TO DFHEIV11
  2220     MOVE 'ERCNOT' TO DFHEIV1
  2221*    MOVE '&$ L                  ''  N#00002084' TO DFHEIV0
  2222     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2223     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2224     MOVE X'204E233030303032303834' TO DFHEIV0(25:11)
  2225     CALL 'kxdfhei1' USING DFHEIV0,
  2226           DFHEIV1,
  2227           cert-note-file,
  2228           DFHEIV11,
  2229           cz-control-primary,
  2230           DFHEIV99,
  2231           DFHEIV99
  2232     MOVE EIBRESP  TO ws-response
  2233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2234     if not resp-normal
  2235        display ' error-ercnot-write ' ws-response ' '
  2236           cz-control-primary (2:33)
  2237     end-if
  2238     .
  2239 0151-exit.
  2240     exit.
  2241 0152-delete-cert-notes.
  2242     move cm-control-primary     to ws-cz-key
  2243     move '1'                    to ws-cz-rec-type
  2244     move +0                     to ws-cz-note-seq
  2245*       ws-cz-key (23:11)
  2246
  2247* EXEC CICS STARTBR
  2248*         DATASET    ('ERCNOT')
  2249*         RIDFLD     (WS-CZ-KEY)
  2250*         GTEQ
  2251*         RESP       (WS-RESPONSE)
  2252*    END-EXEC
  2253     MOVE 'ERCNOT' TO DFHEIV1
  2254     MOVE 0
  2255       TO DFHEIV11
  2256*    MOVE '&,         G          &  N#00002104' TO DFHEIV0
  2257     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2258     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2259     MOVE X'204E233030303032313034' TO DFHEIV0(25:11)
  2260     CALL 'kxdfhei1' USING DFHEIV0,
  2261           DFHEIV1,
  2262           WS-CZ-KEY,
  2263           DFHEIV99,
  2264           DFHEIV11,
  2265           DFHEIV99
  2266     MOVE EIBRESP  TO WS-RESPONSE
  2267     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2268     IF not RESP-NORMAL
  2269        display ' error startbr for delete ' ws-response
  2270        go to 0152-exit
  2271     end-if
  2272     .
  2273 0152-read-next.
  2274
  2275* EXEC CICS READNEXT
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  41
* SOCK04BL.cbl
  2276*       DATASET    ('ERCNOT')
  2277*       RIDFLD     (WS-CZ-KEY)
  2278*       INTO       (cert-note-file)
  2279*       resp       (ws-response)
  2280*    end-exec
  2281     MOVE LENGTH OF
  2282      cert-note-file
  2283       TO DFHEIV12
  2284     MOVE 'ERCNOT' TO DFHEIV1
  2285     MOVE 0
  2286       TO DFHEIV11
  2287*    MOVE '&.IL                  )  N#00002117' TO DFHEIV0
  2288     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2289     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2290     MOVE X'204E233030303032313137' TO DFHEIV0(25:11)
  2291     CALL 'kxdfhei1' USING DFHEIV0,
  2292           DFHEIV1,
  2293           cert-note-file,
  2294           DFHEIV12,
  2295           WS-CZ-KEY,
  2296           DFHEIV99,
  2297           DFHEIV11,
  2298           DFHEIV99,
  2299           DFHEIV99
  2300     MOVE EIBRESP  TO ws-response
  2301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2302     if resp-normal
  2303        if cz-control-primary (1:33) = cm-control-primary (1:33)
  2304           if cz-record-type = '1'
  2305
  2306* exec cics endbr
  2307*                dataset    ('ERCNOT')
  2308*                resp       (ws-response)
  2309*             end-exec
  2310     MOVE 'ERCNOT' TO DFHEIV1
  2311     MOVE 0
  2312       TO DFHEIV11
  2313*    MOVE '&2                    $  N#00002129' TO DFHEIV0
  2314     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2315     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2316     MOVE X'204E233030303032313239' TO DFHEIV0(25:11)
  2317     CALL 'kxdfhei1' USING DFHEIV0,
  2318           DFHEIV1,
  2319           DFHEIV11,
  2320           DFHEIV99
  2321     MOVE EIBRESP  TO ws-response
  2322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2323              if not resp-normal
  2324                 display ' bad endbr ' ws-response
  2325                 go to 0152-exit
  2326              else
  2327
  2328* EXEC CICS READ
  2329*                   UPDATE
  2330*                   DATASET    ('ERCNOT')
  2331*                   RIDFLD     (WS-CZ-KEY)
  2332*                   INTO       (cert-note-file)
  2333*                   resp       (ws-response)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  42
* SOCK04BL.cbl
  2334*                end-exec
  2335     MOVE LENGTH OF
  2336      cert-note-file
  2337       TO DFHEIV11
  2338     MOVE 'ERCNOT' TO DFHEIV1
  2339*    MOVE '&"IL       EU         (  N#00002138' TO DFHEIV0
  2340     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2341     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2342     MOVE X'204E233030303032313338' TO DFHEIV0(25:11)
  2343     CALL 'kxdfhei1' USING DFHEIV0,
  2344           DFHEIV1,
  2345           cert-note-file,
  2346           DFHEIV11,
  2347           WS-CZ-KEY,
  2348           DFHEIV99,
  2349           DFHEIV99,
  2350           DFHEIV99
  2351     MOVE EIBRESP  TO ws-response
  2352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2353                 if not resp-normal
  2354                    display ' bad read update ' ws-response
  2355                    go to 0152-exit
  2356                 end-if
  2357
  2358* exec cics delete
  2359*                   dataset   ('ERCNOT')
  2360*                   RIDFLD     (WS-CZ-KEY)
  2361*                   resp      (ws-response)
  2362*                end-exec
  2363     MOVE 'ERCNOT' TO DFHEIV1
  2364*    MOVE '&(                    &  N#00002150' TO DFHEIV0
  2365     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  2366     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2367     MOVE X'204E233030303032313530' TO DFHEIV0(25:11)
  2368     CALL 'kxdfhei1' USING DFHEIV0,
  2369           DFHEIV1,
  2370           DFHEIV99,
  2371           DFHEIV99,
  2372           DFHEIV99,
  2373           DFHEIV99
  2374     MOVE EIBRESP  TO ws-response
  2375     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2376                 if not resp-normal
  2377                    display ' bad delete ercnot ' ws-response
  2378                    go to 0152-exit
  2379                 else
  2380                    display ' good delete '
  2381                 end-if
  2382              end-if
  2383           else
  2384              display ' rec type not = 1 '
  2385           end-if
  2386           go to 0152-delete-cert-notes
  2387        else
  2388           display ' primary not = '
  2389        end-if
  2390     else
  2391        display ' error ercnot readnext delete ' ws-response
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  43
* SOCK04BL.cbl
  2392     end-if
  2393
  2394* exec cics endbr
  2395*       dataset    ('ERCNOT')
  2396*       resp       (ws-response)
  2397*    end-exec
  2398     MOVE 'ERCNOT' TO DFHEIV1
  2399     MOVE 0
  2400       TO DFHEIV11
  2401*    MOVE '&2                    $  N#00002173' TO DFHEIV0
  2402     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2403     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2404     MOVE X'204E233030303032313733' TO DFHEIV0(25:11)
  2405     CALL 'kxdfhei1' USING DFHEIV0,
  2406           DFHEIV1,
  2407           DFHEIV11,
  2408           DFHEIV99
  2409     MOVE EIBRESP  TO ws-response
  2410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2411     if not resp-normal
  2412        display ' bad resp endbr ercnot ' ws-response
  2413     else
  2414        display ' good endbr '
  2415     end-if
  2416     .
  2417 0152-exit.
  2418     exit.
  2419*0152-delete-cert-notes.
  2420*
  2421*    move cm-control-primary     to ws-cz-key
  2422*    move '1'                    to ws-cz-rec-type
  2423*    move +0                     to ws-cz-note-seq
  2424*       ws-cz-key (23:11)
  2425*    exec cics delete
  2426*       dataset    ('ERCNOT')
  2427*       keylength  (ws-cert-note-generic-key-len)
  2428*       ridfld     (ws-cz-key (1:34))
  2429*       generic
  2430*       resp       (ws-response)
  2431*    end-exec
  2432*
  2433*    display ' made it back from generic delete ' ws-response
  2434*
  2435*    .
  2436*0152-exit.
  2437*    exit.
  2438 0153-put-back-cert-notes.
  2439*    display ' made it to 0153 ' note-count
  2440     perform varying c1 from +1 by +1 until
  2441        c1 > note-count
  2442        move cert-note-record (c1)
  2443                                 to cert-note-file
  2444        add +1                   to cz-note-sequence
  2445*           cz-record-type ' ' cz-note-information
  2446
  2447* exec cics write
  2448*          dataset ('ERCNOT')
  2449*          FROM    (cert-note-file)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  44
* SOCK04BL.cbl
  2450*          ridfld  (cz-control-primary)
  2451*          resp    (ws-response)
  2452*       end-exec
  2453     MOVE LENGTH OF
  2454      cert-note-file
  2455       TO DFHEIV11
  2456     MOVE 'ERCNOT' TO DFHEIV1
  2457*    MOVE '&$ L                  ''  N#00002216' TO DFHEIV0
  2458     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2459     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2460     MOVE X'204E233030303032323136' TO DFHEIV0(25:11)
  2461     CALL 'kxdfhei1' USING DFHEIV0,
  2462           DFHEIV1,
  2463           cert-note-file,
  2464           DFHEIV11,
  2465           cz-control-primary,
  2466           DFHEIV99,
  2467           DFHEIV99
  2468     MOVE EIBRESP  TO ws-response
  2469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2470        if not resp-normal
  2471           display ' error-ercnot-write subsequ ' ws-response ' '
  2472              cz-control-primary (2:33)
  2473           move +999             to c1
  2474        else
  2475           display ' good ercnot write ' c1
  2476        end-if
  2477     end-perform
  2478    .
  2479 0153-exit.
  2480     exit.
  2481 0200-process-acct-comp.
  2482     move low-values             to ws-am-key
  2483     move ws-comp-cd             to ws-am-company-cd
  2484     move sock-car               to ws-am-carrier
  2485     move sock-grp               to ws-am-group
  2486     move sock-st                to ws-am-state
  2487     move sock-act               to ws-am-account
  2488     move ws-bin-cert-eff-dt     to ws-am-exp-dt
  2489
  2490* EXEC CICS STARTBR
  2491*         DATASET    ('ERACCT')
  2492*         RIDFLD     (WS-AM-KEY)
  2493*         GTEQ
  2494*         RESP       (WS-RESPONSE)
  2495*    END-EXEC
  2496     MOVE 'ERACCT' TO DFHEIV1
  2497     MOVE 0
  2498       TO DFHEIV11
  2499*    MOVE '&,         G          &  N#00002242' TO DFHEIV0
  2500     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2501     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2502     MOVE X'204E233030303032323432' TO DFHEIV0(25:11)
  2503     CALL 'kxdfhei1' USING DFHEIV0,
  2504           DFHEIV1,
  2505           WS-AM-KEY,
  2506           DFHEIV99,
  2507           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  45
* SOCK04BL.cbl
  2508           DFHEIV99
  2509     MOVE EIBRESP  TO WS-RESPONSE
  2510     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2511     if not resp-normal
  2512        display ' bad startbr ' ws-response
  2513        go to 0200-exit
  2514     end-if
  2515
  2516* EXEC CICS READNEXT
  2517*         INTO    (ACCOUNT-MASTER)
  2518*         DATASET ('ERACCT')
  2519*         RIDFLD  (WS-AM-KEY)
  2520*         RESP    (WS-RESPONSE)
  2521*    END-EXEC
  2522     MOVE LENGTH OF
  2523      ACCOUNT-MASTER
  2524       TO DFHEIV12
  2525     MOVE 'ERACCT' TO DFHEIV1
  2526     MOVE 0
  2527       TO DFHEIV11
  2528*    MOVE '&.IL                  )  N#00002252' TO DFHEIV0
  2529     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2530     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2531     MOVE X'204E233030303032323532' TO DFHEIV0(25:11)
  2532     CALL 'kxdfhei1' USING DFHEIV0,
  2533           DFHEIV1,
  2534           ACCOUNT-MASTER,
  2535           DFHEIV12,
  2536           WS-AM-KEY,
  2537           DFHEIV99,
  2538           DFHEIV11,
  2539           DFHEIV99,
  2540           DFHEIV99
  2541     MOVE EIBRESP  TO WS-RESPONSE
  2542     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2543     if (resp-normal)
  2544        and (ws-am-company-cd = ws-comp-cd)
  2545        and (ws-am-carrier    = sock-car)
  2546        and (ws-am-state      = sock-st)
  2547        and (ws-am-account    = sock-act)
  2548        continue
  2549     else
  2550        display ' account not found '
  2551        go to 0200-exit
  2552     end-if
  2553     move spaces                 to ws-return-stuff
  2554     move am-name                to sock-am-name
  2555     move am-person              to sock-am-person
  2556     move am-control-name        to sock-am-cntrl-name
  2557     move am-tel-no              to sock-am-phone
  2558     MOVE LOW-VALUES             TO WS-CO-KEY
  2559     MOVE AM-COMPANY-CD          TO WS-CO-COMPANY-CD
  2560     MOVE AM-CARRIER             TO WS-CO-CARRIER
  2561     MOVE AM-GROUPING            TO WS-CO-GROUP
  2562     MOVE 'A'                    TO WS-CO-TYPE
  2563     if am-remit-to not numeric
  2564        move zeros               to am-remit-to
  2565     end-if
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  46
* SOCK04BL.cbl
  2566     if am-remit-to = zeros
  2567        move 01                  to am-remit-to
  2568     end-if
  2569     move am-agt (am-remit-to)   to ws-co-fin-resp
  2570     perform varying a1 from +1 by +1 until
  2571        (a1 > +10)
  2572        or (am-com-typ (a1) = 'C' or 'D')
  2573     end-perform
  2574     if a1 < +11
  2575        move am-agt (a1)         to ws-co-account
  2576     else
  2577        move am-account          to ws-co-account
  2578     end-if
  2579
  2580* EXEC CICS READ
  2581*         INTO    (COMPENSATION-MASTER)
  2582*         DATASET ('ERCOMP')
  2583*         RIDFLD  (WS-CO-KEY)
  2584*         RESP    (WS-RESPONSE)
  2585*    END-EXEC
  2586     MOVE LENGTH OF
  2587      COMPENSATION-MASTER
  2588       TO DFHEIV11
  2589     MOVE 'ERCOMP' TO DFHEIV1
  2590*    MOVE '&"IL       E          (  N#00002294' TO DFHEIV0
  2591     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  2592     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2593     MOVE X'204E233030303032323934' TO DFHEIV0(25:11)
  2594     CALL 'kxdfhei1' USING DFHEIV0,
  2595           DFHEIV1,
  2596           COMPENSATION-MASTER,
  2597           DFHEIV11,
  2598           WS-CO-KEY,
  2599           DFHEIV99,
  2600           DFHEIV99,
  2601           DFHEIV99
  2602     MOVE EIBRESP  TO WS-RESPONSE
  2603     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2604     IF RESP-NORMAL
  2605        MOVE CO-CONTROL-NAME     TO sock-co-contact
  2606        MOVE CO-faxno            TO sock-co-fax
  2607     ELSE
  2608        MOVE ' unknown     '     TO sock-co-contact
  2609     END-IF
  2610     .
  2611 0200-exit.
  2612     exit.
  2613 cics-return.
  2614     display 'SOCK04BL Finished ' sock-return-area
  2615
  2616* exec cics
  2617*       return
  2618*    end-exec
  2619*    MOVE '.(                    ''   #00002311' TO DFHEIV0
  2620     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2621     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2622     MOVE X'2020233030303032333131' TO DFHEIV0(25:11)
  2623     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:47 Page  47
* SOCK04BL.cbl
  2624           DFHEIV99,
  2625           DFHEIV99,
  2626           DFHEIV99,
  2627           DFHEIV99,
  2628           DFHEIV99,
  2629           DFHEIV99
  2630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2631
  2632* goback
  2633
  2634     MOVE '9%                    "   ' TO DFHEIV0
  2635     MOVE 'SOCK04BL' TO DFHEIV1
  2636     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2637     goback
  2638     .
  2639 9700-DATE-LINK.
  2640
  2641* EXEC CICS LINK
  2642*         PROGRAM  ('ELDATCV')
  2643*         COMMAREA (DATE-CONVERSION-DATA)
  2644*         LENGTH   (DC-COMM-LENGTH)
  2645*    END-EXEC.
  2646     MOVE 'ELDATCV' TO DFHEIV1
  2647*    MOVE '."C                   (   #00002317' TO DFHEIV0
  2648     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2649     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2650     MOVE X'2020233030303032333137' TO DFHEIV0(25:11)
  2651     CALL 'kxdfhei1' USING DFHEIV0,
  2652           DFHEIV1,
  2653           DATE-CONVERSION-DATA,
  2654           DC-COMM-LENGTH,
  2655           DFHEIV99,
  2656           DFHEIV99,
  2657           DFHEIV99,
  2658           DFHEIV99
  2659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2660
  2661 9700-EXIT.
  2662      EXIT.
  2663
  2664 9999-DFHBACK SECTION.
  2665     MOVE '9%                    "   ' TO DFHEIV0
  2666     MOVE 'SOCK04BL' TO DFHEIV1
  2667     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2668     GOBACK.
  2669 9999-DFHEXIT.
  2670     IF DFHEIGDJ EQUAL 0001
  2671         NEXT SENTENCE.
  2672     MOVE '9%                    "   ' TO DFHEIV0
  2673     MOVE 'SOCK04BL' TO DFHEIV1
  2674     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2675     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       53132     Code:        6573
