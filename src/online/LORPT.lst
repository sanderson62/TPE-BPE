* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* LORPT.cbl
* Options: int("LORPT.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("LORPT.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"LORPT.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"LORPT.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.   LORPT.
     3*AUTHOR.     PABLO
     4*            COLLEYVILLE, TEXAS.
     5*REMARKS.    EXECUTED FROM /LOANOFFICER/INDEX.HTML
     6******************************************************************
     7*                   C H A N G E   L O G
     8*
     9* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    10*-----------------------------------------------------------------
    11*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    12* EFFECTIVE    NUMBER
    13*-----------------------------------------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* LORPT.cbl
    14* 111810                   PEMA  NEW PROGRAM
    15******************************************************************
    16 ENVIRONMENT DIVISION.
    17 DATA DIVISION.
    18 working-storage section.
    19 01  DFH-START PIC X(04).
    20 77  SAVE-DATE                   PIC X(8)    VALUE SPACES.
    21 77  WS-SAVE-EDIT-A-DATE         PIC X(10)   VALUE SPACES.
    22 77  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
    23 01  S1                          PIC S999 VALUE +0 COMP-3.
    24 01  P pointer.
    25 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    26 01  var-ptr pointer.
    27 01  env-var-len                 pic 9(4)  binary.
    28 01  rc                          pic 9(9)  binary.
    29 01  WS-KIXSYS.
    30     05  WS-KIX-FIL1             PIC X(10).
    31     05  WS-KIX-APPS             PIC X(10).
    32     05  WS-KIX-ENV              PIC X(10).
    33     05  WS-KIX-MYENV            PIC X(10).
    34     05  WS-KIX-SYS              PIC X(10).
    35************************************************
    36* commarea passed to the business logic
    37************************************************
    38 01  BL-COMMAREA.
    39     03  BL-OUTPUT OCCURS 200.
    40         05  BL-CARRIER          PIC X.
    41         05  BL-STATE            PIC XX.
    42         05  BL-ACCOUNT          PIC X(10).
    43         05  BL-EFF-DT           PIC X(10).
    44         05  BL-CERT-NO          PIC X(11).
    45         05  BL-ISS-CAN          PIC X(10).
    46         05  BL-LOAN-OFF         PIC X(5).
    47         05  BL-BATCH-NO         PIC X(6).
    48         05  BL-ACCT-NAME        PIC X(30).
    49     03  BL-COUNT                PIC 999.
    50     03  BL-STATUS.
    51         88  BL-OK                          VALUE "P".
    52         88  BL-FAIL                      VALUE "F".
    53         05  BL-MESSAGE          PIC X(50).
    54************************************
    55* fields used to read web data
    56************************************
    57 01  w-form-name       pic x(80).
    58 01  w-form-value      pic x(80).
    59 01  w-form-name-len   pic s9(8) comp.
    60 01  w-form-value-len  pic s9(8) comp.
    61 01  w-resp            pic s9(8) comp.
    62 01  w-doctoken        pic x(16).
    63* COMP ID TPE REGION   GROUP NAME       HOST          HTTP PORT
    64*
    65*  CID      CID1P      BatchClaims     ntcso3            7001
    66*  CID      MDOFF      BatchClaims     ntnapersofttst    7003
    67*  CID      CID1T      BatchClaims     ntnapersofttst    6002
    68*  CID      PAUL       BatchClaims     ntnapersofttst    5002
    69*  DCC      CID1P      BatchDCCClaims  ntcso3            7001
    70*  DCC      MDOFF      BatchDCCClaims  ntnapersofttst    7003
    71*  DCC      CID1T      BatchDCCClaims  ntnapersofttst    6002
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* LORPT.cbl
    72*  DCC      PAUL       BatchDCCClaims  ntnapersofttst    5002
    73******************************************
    74* symbol list text for LOHDR template
    75******************************************
    76 01  WS-PROD-LOHDR.
    77     05  F                       PIC X(7)  VALUE "PGMDT=".
    78     05  LOHDR-DT                PIC X(10) VALUE ' '.
    79******************************************
    80* symbol list text for LOBOD template
    81******************************************
    82 01 WS-PROD-LOBOD.
    83    05 FILLER              PIC X(8) VALUE "CARRIER=".
    84    05 OUT-CARR            PIC X.
    85    05 FILLER              PIC X(7) VALUE "&STATE=".
    86    05 OUT-STATE           PIC XX.
    87    05 FILLER              PIC X(9) VALUE "&ACCOUNT=".
    88    05 OUT-ACCT            PIC X(10).
    89    05 FILLER              PIC X(7) VALUE "&EFFDT=".
    90    05 OUT-EFFDT           PIC X(10).
    91    05 FILLER              PIC X(8) VALUE "&CERTNO=".
    92    05 OUT-CERTNO          PIC X(11).
    93    05 FILLER              PIC X(8) VALUE "&ISSCAN=".
    94    05 OUT-ISSCAN          PIC X(10).
    95    05 FILLER              PIC X(9) VALUE "&LOANOFF=".
    96    05 OUT-LOANOFF         PIC X(5).
    97    05 FILLER              PIC X(9) VALUE "&BATCHNO=".
    98    05 OUT-BATCHNO         PIC X(6).
    99    05 FILLER              PIC X(10) VALUE "&ACCTNAME=".
   100    05 OUT-ACCTNAME        PIC X(30).
   101******************************************
   102* symbol list text for LOFTR template
   103******************************************
   104 01  WS-PROD-LOFTR.
   105     05  F                       PIC X(7)  VALUE "MSG=".
   106     05  LOFTR-MSG               PIC X(50) VALUE ' '.
   107 01  WS-VAR-SLUNIKIX.
   108     05  FILLER                  PIC X(09) VALUE "HOSTINFO=".
   109     05  WS-SL-HOST-INFO         PIC X(09) VALUE 'slunikix:'.
   110     05  WS-SL-PORT              PIC XXXX  VALUE '7001'.
   111     05  WS-SL-REST              PIC X(145) VALUE SPACES.
   112 01  WS-VAR-LOGICTEST.
   113     05  FILLER                  PIC X(09) VALUE "HOSTINFO=".
   114     05  WS-LT-HOST-INFO         PIC X(10) VALUE 'logictest:'.
   115     05  WS-LT-PORT              PIC XXXX  VALUE '6002'.
   116     05  WS-LT-REST              PIC X(145) VALUE SPACES.
   117 01  MISC.
   118     12  WS-RESPONSE             PIC S9(8)   COMP.
   119         88  RESP-NORMAL                  VALUE +00.
   120         88  RESP-NOTFND                  VALUE +13.
   121         88  RESP-DUPREC                  VALUE +14.
   122         88  RESP-DUPKEY                  VALUE +15.
   123         88  RESP-NOTOPEN                 VALUE +19.
   124         88  RESP-ENDFILE                 VALUE +20.
   125*                                COPY ELCDATE.
   126******************************************************************
   127*                                                                *
   128*                                                                *
   129*                            ELCDATE.                            *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* LORPT.cbl
   130*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   131*                            VMOD=2.003
   132*                                                                *
   133*                                                                *
   134*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   135*                 LENGTH = 200                                   *
   136******************************************************************
   137
   138 01  DATE-CONVERSION-DATA.
   139     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   140     12  DC-OPTION-CODE                PIC X.
   141         88  BIN-TO-GREG                VALUE ' '.
   142         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   143         88  EDIT-GREG-TO-BIN           VALUE '2'.
   144         88  YMD-GREG-TO-BIN            VALUE '3'.
   145         88  MDY-GREG-TO-BIN            VALUE '4'.
   146         88  JULIAN-TO-BIN              VALUE '5'.
   147         88  BIN-PLUS-ELAPSED           VALUE '6'.
   148         88  FIND-CENTURY               VALUE '7'.
   149         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   150         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   151         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   152         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   153         88  JULIAN-TO-BIN-3            VALUE 'C'.
   154         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   155         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   156         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   157         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   158         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   159         88  CHECK-LEAP-YEAR            VALUE 'H'.
   160         88  BIN-3-TO-GREG              VALUE 'I'.
   161         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   162         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   163         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   164         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   165         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   166         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   167         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   168         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   169         88  THREE-CHARACTER-BIN
   170                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   171         88  GREGORIAN-TO-BIN
   172                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   173         88  BIN-TO-GREGORIAN
   174                  VALUES ' ' '1' 'I' '8' 'G'.
   175         88  JULIAN-TO-BINARY
   176                  VALUES '5' 'C' 'E' 'F'.
   177     12  DC-ERROR-CODE                 PIC X.
   178         88  NO-CONVERSION-ERROR        VALUE ' '.
   179         88  DATE-CONVERSION-ERROR
   180                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   181         88  DATE-IS-ZERO               VALUE '1'.
   182         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   183         88  DATE-IS-INVALID            VALUE '3'.
   184         88  DATE1-GREATER-DATE2        VALUE '4'.
   185         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   186         88  DATE-INVALID-OPTION        VALUE '9'.
   187         88  INVALID-CENTURY            VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* LORPT.cbl
   188         88  ONLY-CENTURY               VALUE 'B'.
   189         88  ONLY-LEAP-YEAR             VALUE 'C'.
   190         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   191     12  DC-END-OF-MONTH               PIC X.
   192         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   193     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   194         88  USE-NORMAL-PROCESS         VALUE ' '.
   195         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   196         88  ADJUST-UP-100-YRS          VALUE '2'.
   197     12  FILLER                        PIC X.
   198     12  DC-CONVERSION-DATES.
   199         16  DC-BIN-DATE-1             PIC XX.
   200         16  DC-BIN-DATE-2             PIC XX.
   201         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   202         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   203                       DC-GREG-DATE-1-EDIT.
   204             20  DC-EDIT1-MONTH        PIC 99.
   205             20  SLASH1-1              PIC X.
   206             20  DC-EDIT1-DAY          PIC 99.
   207             20  SLASH1-2              PIC X.
   208             20  DC-EDIT1-YEAR         PIC 99.
   209         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   210         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   211                     DC-GREG-DATE-2-EDIT.
   212             20  DC-EDIT2-MONTH        PIC 99.
   213             20  SLASH2-1              PIC X.
   214             20  DC-EDIT2-DAY          PIC 99.
   215             20  SLASH2-2              PIC X.
   216             20  DC-EDIT2-YEAR         PIC 99.
   217         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   218         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   219                     DC-GREG-DATE-1-YMD.
   220             20  DC-YMD-YEAR           PIC 99.
   221             20  DC-YMD-MONTH          PIC 99.
   222             20  DC-YMD-DAY            PIC 99.
   223         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   224         16  DC-GREG-DATE-1-MDY-R REDEFINES
   225                      DC-GREG-DATE-1-MDY.
   226             20  DC-MDY-MONTH          PIC 99.
   227             20  DC-MDY-DAY            PIC 99.
   228             20  DC-MDY-YEAR           PIC 99.
   229         16  DC-GREG-DATE-1-ALPHA.
   230             20  DC-ALPHA-MONTH        PIC X(10).
   231             20  DC-ALPHA-DAY          PIC 99.
   232             20  FILLER                PIC XX.
   233             20  DC-ALPHA-CENTURY.
   234                 24 DC-ALPHA-CEN-N     PIC 99.
   235             20  DC-ALPHA-YEAR         PIC 99.
   236         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   237         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   238         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   239         16  DC-JULIAN-DATE            PIC 9(05).
   240         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   241                                       PIC 9(05).
   242         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   243             20  DC-JULIAN-YEAR        PIC 99.
   244             20  DC-JULIAN-DAYS        PIC 999.
   245         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* LORPT.cbl
   246         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   247         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   248     12  DATE-CONVERSION-VARIBLES.
   249         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   250         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   251             20  FILLER                PIC 9(3).
   252             20  HOLD-CEN-1-CCYY.
   253                 24  HOLD-CEN-1-CC     PIC 99.
   254                 24  HOLD-CEN-1-YY     PIC 99.
   255             20  HOLD-CEN-1-MO         PIC 99.
   256             20  HOLD-CEN-1-DA         PIC 99.
   257         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   258             20  HOLD-CEN-1-R-MO       PIC 99.
   259             20  HOLD-CEN-1-R-DA       PIC 99.
   260             20  HOLD-CEN-1-R-CCYY.
   261                 24  HOLD-CEN-1-R-CC   PIC 99.
   262                 24  HOLD-CEN-1-R-YY   PIC 99.
   263             20  FILLER                PIC 9(3).
   264         16  HOLD-CENTURY-1-X.
   265             20  FILLER                PIC X(3)  VALUE SPACES.
   266             20  HOLD-CEN-1-X-CCYY.
   267                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   268                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   269             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   270             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   271         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   272             20  HOLD-CEN-1-R-X-MO     PIC XX.
   273             20  HOLD-CEN-1-R-X-DA     PIC XX.
   274             20  HOLD-CEN-1-R-X-CCYY.
   275                 24  HOLD-CEN-1-R-X-CC PIC XX.
   276                 24  HOLD-CEN-1-R-X-YY PIC XX.
   277             20  FILLER                PIC XXX.
   278         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   279         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   280         16  DC-JULIAN-DATE-1          PIC 9(07).
   281         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   282             20  DC-JULIAN-1-CCYY.
   283                 24  DC-JULIAN-1-CC    PIC 99.
   284                 24  DC-JULIAN-1-YR    PIC 99.
   285             20  DC-JULIAN-DA-1        PIC 999.
   286         16  DC-JULIAN-DATE-2          PIC 9(07).
   287         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   288             20  DC-JULIAN-2-CCYY.
   289                 24  DC-JULIAN-2-CC    PIC 99.
   290                 24  DC-JULIAN-2-YR    PIC 99.
   291             20  DC-JULIAN-DA-2        PIC 999.
   292         16  DC-GREG-DATE-A-EDIT.
   293             20  DC-EDITA-MONTH        PIC 99.
   294             20  SLASHA-1              PIC X VALUE '/'.
   295             20  DC-EDITA-DAY          PIC 99.
   296             20  SLASHA-2              PIC X VALUE '/'.
   297             20  DC-EDITA-CCYY.
   298                 24  DC-EDITA-CENT     PIC 99.
   299                 24  DC-EDITA-YEAR     PIC 99.
   300         16  DC-GREG-DATE-B-EDIT.
   301             20  DC-EDITB-MONTH        PIC 99.
   302             20  SLASHB-1              PIC X VALUE '/'.
   303             20  DC-EDITB-DAY          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* LORPT.cbl
   304             20  SLASHB-2              PIC X VALUE '/'.
   305             20  DC-EDITB-CCYY.
   306                 24  DC-EDITB-CENT     PIC 99.
   307                 24  DC-EDITB-YEAR     PIC 99.
   308         16  DC-GREG-DATE-CYMD         PIC 9(08).
   309         16  DC-GREG-DATE-CYMD-R REDEFINES
   310                              DC-GREG-DATE-CYMD.
   311             20  DC-CYMD-CEN           PIC 99.
   312             20  DC-CYMD-YEAR          PIC 99.
   313             20  DC-CYMD-MONTH         PIC 99.
   314             20  DC-CYMD-DAY           PIC 99.
   315         16  DC-GREG-DATE-MDCY         PIC 9(08).
   316         16  DC-GREG-DATE-MDCY-R REDEFINES
   317                              DC-GREG-DATE-MDCY.
   318             20  DC-MDCY-MONTH         PIC 99.
   319             20  DC-MDCY-DAY           PIC 99.
   320             20  DC-MDCY-CEN           PIC 99.
   321             20  DC-MDCY-YEAR          PIC 99.
   322    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   323        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   324    12  DC-EL310-DATE                  PIC X(21).
   325    12  FILLER                         PIC X(28).
   326****************************************************************
   327*
   328* Copyright (c) 2007 by Clerity Solutions, Inc.
   329* All rights reserved.
   330*
   331****************************************************************
   332 01  DFHEIV.
   333   02  DFHEIV0               PIC X(35).
   334   02  DFHEIV1               PIC X(08).
   335   02  DFHEIV2               PIC X(08).
   336   02  DFHEIV3               PIC X(08).
   337   02  DFHEIV4               PIC X(06).
   338   02  DFHEIV5               PIC X(04).
   339   02  DFHEIV6               PIC X(04).
   340   02  DFHEIV7               PIC X(02).
   341   02  DFHEIV8               PIC X(02).
   342   02  DFHEIV9               PIC X(01).
   343   02  DFHEIV10              PIC S9(7) COMP-3.
   344   02  DFHEIV11              PIC S9(4) COMP SYNC.
   345   02  DFHEIV12              PIC S9(4) COMP SYNC.
   346   02  DFHEIV13              PIC S9(4) COMP SYNC.
   347   02  DFHEIV14              PIC S9(4) COMP SYNC.
   348   02  DFHEIV15              PIC S9(4) COMP SYNC.
   349   02  DFHEIV16              PIC S9(9) COMP SYNC.
   350   02  DFHEIV17              PIC X(04).
   351   02  DFHEIV18              PIC X(04).
   352   02  DFHEIV19              PIC X(04).
   353   02  DFHEIV20              USAGE IS POINTER.
   354   02  DFHEIV21              USAGE IS POINTER.
   355   02  DFHEIV22              USAGE IS POINTER.
   356   02  DFHEIV23              USAGE IS POINTER.
   357   02  DFHEIV24              USAGE IS POINTER.
   358   02  DFHEIV25              PIC S9(9) COMP SYNC.
   359   02  DFHEIV26              PIC S9(9) COMP SYNC.
   360   02  DFHEIV27              PIC S9(9) COMP SYNC.
   361   02  DFHEIV28              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* LORPT.cbl
   362   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   363   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   364   02  FILLER                PIC X(02).
   365   02  DFHEIV99              PIC X(08) VALUE SPACE.
   366   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   367   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   368   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   369   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   370 LINKAGE  SECTION.
   371*****************************************************************
   372*                                                               *
   373* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   374* All rights reserved.                                          *
   375*                                                               *
   376*****************************************************************
   377 01  dfheiblk.
   378     02  eibtime          pic s9(7) comp-3.
   379     02  eibdate          pic s9(7) comp-3.
   380     02  eibtrnid         pic x(4).
   381     02  eibtaskn         pic s9(7) comp-3.
   382     02  eibtrmid         pic x(4).
   383     02  dfheigdi         pic s9(4) comp.
   384     02  eibcposn         pic s9(4) comp.
   385     02  eibcalen         pic s9(4) comp.
   386     02  eibaid           pic x(1).
   387     02  eibfiller1       pic x(1).
   388     02  eibfn            pic x(2).
   389     02  eibfiller2       pic x(2).
   390     02  eibrcode         pic x(6).
   391     02  eibfiller3       pic x(2).
   392     02  eibds            pic x(8).
   393     02  eibreqid         pic x(8).
   394     02  eibrsrce         pic x(8).
   395     02  eibsync          pic x(1).
   396     02  eibfree          pic x(1).
   397     02  eibrecv          pic x(1).
   398     02  eibsend          pic x(1).
   399     02  eibatt           pic x(1).
   400     02  eibeoc           pic x(1).
   401     02  eibfmh           pic x(1).
   402     02  eibcompl         pic x(1).
   403     02  eibsig           pic x(1).
   404     02  eibconf          pic x(1).
   405     02  eiberr           pic x(1).
   406     02  eibrldbk         pic x(1).
   407     02  eiberrcd         pic x(4).
   408     02  eibsynrb         pic x(1).
   409     02  eibnodat         pic x(1).
   410     02  eibfiller5       pic x(2).
   411     02  eibresp          pic 9(09) comp.
   412     02  eibresp2         pic 9(09) comp.
   413     02  dfheigdj         pic s9(4) comp.
   414     02  dfheigdk         pic s9(4) comp.
   415 01  DFHCOMMAREA       PIC X(01).
   416 01  var  pic x(30).
   417 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR.
   418 0000-DFHEXIT SECTION.
   419     MOVE '9#                    $   ' TO DFHEIV0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* LORPT.cbl
   420     MOVE 'LORPT' TO DFHEIV1.
   421     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   422*    DISPLAY ' ENTERING LORPT '
   423     set P to address of KIXSYS
   424     CALL "getenv" using by value P returning var-ptr
   425     if var-ptr = null then
   426        display ' kixsys not set '
   427     else
   428        set address of var to var-ptr
   429        move 0 to env-var-len
   430        inspect var tallying env-var-len
   431          for characters before X'00'
   432*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
   433        unstring var (1:env-var-len) delimited by '/'
   434           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
   435              WS-KIX-SYS
   436        end-unstring
   437*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
   438*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
   439     end-if
   440     MOVE EIBDATE                TO DC-JULIAN-YYDDD
   441     MOVE '5'                    TO DC-OPTION-CODE
   442     PERFORM 9700-DATE-LINK      THRU 9700-EXIT
   443     MOVE DC-GREG-DATE-1-EDIT    TO SAVE-DATE
   444     MOVE DC-GREG-DATE-A-EDIT    TO LOHDR-DT
   445     MOVE DC-BIN-DATE-1          TO SAVE-BIN-DATE
   446*********************
   447* Receive web input
   448*********************
   449* NO WEB INPUT FROM THIS PROJECT YET
   450*    exec cics web
   451*       startbr formfield resp(w-resp)
   452*     end-exec.
   453*
   454*     perform read-form thru read-form-exit
   455*        until w-resp not = dfhresp(normal).
   456*
   457*     exec cics web
   458*       endbr formfield
   459*     end-exec.
   460*    MOVE IFF-CARRIER             TO OT-CARRIER
   461*    MOVE IFF-CLAIM-NO            TO OT-CLMNO
   462*    MOVE IFF-CERT-NO             TO OT-CRTNO
   463*    MOVE IFF-LETTER-ID           TO OT-LETTER-ID
   464*    MOVE IFF-FOLLOW-UP-DT        TO OT-FOLLOW-UP-DT
   465*    MOVE IFF-RESEND-DT           TO OT-RESEND-DT
   466*    MOVE IFF-NO-OF-COPIES        TO OT-NO-OF-COPIES
   467*    MOVE IFF-PROC-ID             TO OT-PROC-ID
   468*    MOVE IFF-COMP-ID             TO OT-COMP-ID
   469*    MOVE IFF-PRINT-NOW-SW        TO OT-PRINT-NOW-SW
   470*    MOVE IFF-ENC-CD              TO OT-ENC-CD
   471*    MOVE ZEROS                   TO OT-ARCHIVE-NO
   472*    MOVE IFF-REGARDING           TO OT-REGARDING
   473*    DISPLAY ' INPUT FORM ' WS-KEY
   474*****************************************
   475* Invoke the report business logic
   476*****************************************
   477     MOVE SPACES                 TO BL-COMMAREA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* LORPT.cbl
   478*    DISPLAY ' ABOUT TO LINK TO LORPTBL '
   479
   480* exec cics link
   481*       program('LORPTBL')
   482*       commarea(BL-COMMAREA)
   483*    end-exec.
   484     MOVE LENGTH OF
   485      BL-COMMAREA
   486       TO DFHEIV11
   487     MOVE 'LORPTBL' TO DFHEIV1
   488*    MOVE '."C                   ''   #00000475' TO DFHEIV0
   489     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
   490     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   491     MOVE X'2020233030303030343735' TO DFHEIV0(25:11)
   492     CALL 'kxdfhei1' USING DFHEIV0,
   493           DFHEIV1,
   494           BL-COMMAREA,
   495           DFHEIV11,
   496           DFHEIV99,
   497           DFHEIV99,
   498           DFHEIV99
   499     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   500
   501*    DISPLAY ' MADE IT BACK FROM LORPTBL '
   502*    IF BL-OK
   503*       DISPLAY ' BL OK ' BL-COUNT
   504*    END-IF
   505*    PERFORM VARYING S1 FROM +1 BY +1 UNTIL
   506*       S1 > 5
   507*       MOVE 'X'                 TO BL-CARRIER  (S1)
   508*       MOVE 'TX'                TO BL-STATE    (S1)
   509*       MOVE '123'               TO BL-ACCOUNT  (S1)
   510*       MOVE '11/17/2010'        TO BL-EFF-DT   (S1)
   511*       MOVE S1                  TO BL-CERT-NO  (S1)
   512*       MOVE 'ISS'               TO BL-ISS-CAN  (S1)
   513*       MOVE 'LOAN'              TO BL-LOAN-OFF (S1)
   514*    END-PERFORM
   515***********************************************************
   516* Build output document.  There are three templates used
   517* for this document.  LOHDR  and  LOFTR are the header
   518* and footer, respectively.   LOBOD is used for the
   519* actual data.  For each array entry in the business
   520* logic output, set the symbol list from the array
   521* entry and insert into the document using the  LOBOD
   522* template.
   523***********************************************************
   524*    move ' testing testing ' to bl-message
   525     move bl-MESSAGE        to LOFTR-MSG
   526
   527* exec cics document create
   528*       doctoken   (w-doctoken)
   529*       template   ('LOHDR')
   530*       symbollist (WS-PROD-LOHDR)
   531*       resp       (WS-RESPONSE)
   532*    end-exec
   533     MOVE LENGTH OF
   534      WS-PROD-LOHDR
   535       TO DFHEIV16
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* LORPT.cbl
   536     MOVE 'LOHDR'
   537      TO DFHEIVL0
   538*    MOVE '\"D tSL               )  N#00000504' TO DFHEIV0
   539     MOVE X'5C22442074534C2020202020' TO DFHEIV0(1:12)
   540     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
   541     MOVE X'204E233030303030353034' TO DFHEIV0(25:11)
   542     CALL 'kxdfhei1' USING DFHEIV0,
   543           w-doctoken,
   544           DFHEIV99,
   545           DFHEIVL0,
   546           WS-PROD-LOHDR,
   547           DFHEIV16,
   548           DFHEIV99,
   549           DFHEIV99,
   550           DFHEIV99
   551     MOVE EIBRESP  TO WS-RESPONSE
   552     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   553*    DISPLAY '  LOHDR DOC CREATE ' WS-RESPONSE
   554     move 1 to S1
   555*    MOVE 5 TO BL-COUNT
   556     perform bl-COUNT times
   557        MOVE BL-CARRIER   (S1)   TO OUT-CARR
   558        MOVE BL-STATE     (S1)   TO OUT-STATE
   559        MOVE BL-ACCOUNT   (S1)   TO OUT-ACCT
   560        MOVE BL-EFF-DT    (S1)   TO OUT-EFFDT
   561        MOVE BL-CERT-NO   (S1)   TO OUT-CERTNO
   562        MOVE BL-ISS-CAN   (S1)   TO OUT-ISSCAN
   563        MOVE BL-LOAN-OFF  (S1)   TO OUT-LOANOFF
   564        MOVE BL-BATCH-NO  (S1)   TO OUT-BATCHNO
   565        MOVE BL-ACCT-NAME (S1)   TO OUT-ACCTNAME
   566*       display ' ws-prod-lobod ' ws-prod-lobod
   567
   568* exec cics document set
   569*          doctoken   (w-doctoken)
   570*          symbollist (WS-PROD-LOBOD)
   571*          length     (length of WS-PROD-LOBOD)
   572*                      resp       (WS-RESPONSE)
   573*       end-exec
   574     MOVE LENGTH OF
   575      WS-PROD-LOBOD TO DFHEIV16
   576*    MOVE '\(Ds L                ''  N#00000524' TO DFHEIV0
   577     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
   578     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   579     MOVE X'204E233030303030353234' TO DFHEIV0(25:11)
   580     CALL 'kxdfhei1' USING DFHEIV0,
   581           w-doctoken,
   582           WS-PROD-LOBOD,
   583           DFHEIV99,
   584           DFHEIV16,
   585           DFHEIV99,
   586           DFHEIV99
   587     MOVE EIBRESP  TO WS-RESPONSE
   588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   589*       DISPLAY ' DOC SET    ' WS-RESPONSE
   590
   591* exec cics document insert
   592*          doctoken(w-doctoken)
   593*          template('LOBOD')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* LORPT.cbl
   594*                      resp   (WS-RESPONSE)
   595*       end-exec
   596     MOVE 'LOBOD'
   597      TO DFHEIVL0
   598*    MOVE '\$Dt                  (  N#00000531' TO DFHEIV0
   599     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
   600     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
   601     MOVE X'204E233030303030353331' TO DFHEIV0(25:11)
   602     CALL 'kxdfhei1' USING DFHEIV0,
   603           w-doctoken,
   604           DFHEIVL0,
   605           DFHEIV99,
   606           DFHEIV99,
   607           DFHEIV99,
   608           DFHEIV99,
   609           DFHEIV99
   610     MOVE EIBRESP  TO WS-RESPONSE
   611     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   612*       DISPLAY ' LOBOD DOC INSERT ' WS-RESPONSE
   613        add 1 to S1
   614     end-perform
   615
   616* exec cics document set
   617*       doctoken   (w-doctoken)
   618*       symbollist (WS-PROD-LOFTR)
   619*       length     (length of WS-PROD-LOFTR)
   620*                   resp       (WS-RESPONSE)
   621*    end-exec
   622     MOVE LENGTH OF
   623      WS-PROD-LOFTR TO DFHEIV16
   624*    MOVE '\(Ds L                ''  N#00000539' TO DFHEIV0
   625     MOVE X'5C284473204C202020202020' TO DFHEIV0(1:12)
   626     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   627     MOVE X'204E233030303030353339' TO DFHEIV0(25:11)
   628     CALL 'kxdfhei1' USING DFHEIV0,
   629           w-doctoken,
   630           WS-PROD-LOFTR,
   631           DFHEIV99,
   632           DFHEIV16,
   633           DFHEIV99,
   634           DFHEIV99
   635     MOVE EIBRESP  TO WS-RESPONSE
   636     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   637*   DISPLAY ' LOFTR DOC SET ' WS-RESPONSE
   638
   639* exec cics document insert
   640*       doctoken(w-doctoken)
   641*       template('LOFTR')
   642*                   resp   (WS-RESPONSE)
   643*    end-exec
   644     MOVE 'LOFTR'
   645      TO DFHEIVL0
   646*    MOVE '\$Dt                  (  N#00000546' TO DFHEIV0
   647     MOVE X'5C2444742020202020202020' TO DFHEIV0(1:12)
   648     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
   649     MOVE X'204E233030303030353436' TO DFHEIV0(25:11)
   650     CALL 'kxdfhei1' USING DFHEIV0,
   651           w-doctoken,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* LORPT.cbl
   652           DFHEIVL0,
   653           DFHEIV99,
   654           DFHEIV99,
   655           DFHEIV99,
   656           DFHEIV99,
   657           DFHEIV99
   658     MOVE EIBRESP  TO WS-RESPONSE
   659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
   660*    DISPLAY '  LOFTR DOC INSERT ' WS-RESPONSE
   661****************************************
   662* Send the document and return.
   663****************************************
   664
   665* exec cics web send
   666*       doctoken(w-doctoken)
   667*                   resp   (WS-RESPONSE)
   668*    end-exec.
   669*    MOVE 'X$D                   &  N#00000555' TO DFHEIV0
   670     MOVE X'582444202020202020202020' TO DFHEIV0(1:12)
   671     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   672     MOVE X'204E233030303030353535' TO DFHEIV0(25:11)
   673     CALL 'kxdfhei1' USING DFHEIV0,
   674           w-doctoken,
   675           DFHEIV99,
   676           DFHEIV99,
   677           DFHEIV99,
   678           DFHEIV99
   679     MOVE EIBRESP  TO WS-RESPONSE
   680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   681
   682*    DISPLAY ' WEB SEND  ' WS-RESPONSE
   683*    DISPLAY ' ABOUT TO RETURN '
   684
   685* exec cics
   686*       return
   687*    end-exec.
   688*    MOVE '.(                    &   #00000561' TO DFHEIV0
   689     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
   690     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   691     MOVE X'2020233030303030353631' TO DFHEIV0(25:11)
   692     CALL 'kxdfhei1' USING DFHEIV0,
   693           DFHEIV99,
   694           DFHEIV99,
   695           DFHEIV99,
   696           DFHEIV99,
   697           DFHEIV99
   698     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   699
   700******************************************************
   701* Read all fields of the incoming form, moving
   702* each to the corresponding field of the commarea
   703* (business logic input fields).
   704******************************************************
   705*read-form.
   706*    move spaces to w-form-name.
   707*    move length of w-form-name to w-form-name-len.
   708*    move spaces to w-form-value.
   709*    move length of w-form-value to w-form-value-len.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* LORPT.cbl
   710*    exec cics web readnext
   711*                  formfield(w-form-name)
   712*                  namelength(w-form-name-len)
   713*                  value(w-form-value)
   714*                  valuelength(w-form-value-len)
   715*                  resp(w-resp)
   716*    end-exec.
   717*    evaluate w-resp
   718*       when dfhresp(normal)
   719*          evaluate w-form-name(1:w-form-name-len)
   720*             when 'carrier'
   721*                if w-form-value-len not = 0
   722*                   move w-form-value(1:w-form-value-len)
   723*                                to IFF-CARRIER
   724*                                BL-CARRIER
   725*                else
   726*                 move spaces to IFF-CARRIER
   727*                end-if
   728*             when 'claim_no'
   729*              if w-form-value-len not = 0
   730*                   move w-form-value(1:w-form-value-len)
   731*                             to IFF-CLAIM-NO
   732*                                BL-CLAIM-NO
   733*                else
   734*                 move spaces  to IFF-CLAIM-NO
   735*                end-if
   736*             when 'cert_no'
   737*              if w-form-value-len not = 0
   738*                   move w-form-value(1:w-form-value-len)
   739*                                to IFF-CERT-NO
   740*                                   BL-CERT-NO
   741*                else
   742*                 move spaces  to IFF-CERT-NO
   743*                end-if
   744*             when 'letter_id'
   745*              if w-form-value-len not = 0
   746*                   move w-form-value(1:w-form-value-len)
   747*                                to IFF-LETTER-ID
   748*                                   BL-LETTER-ID
   749*                else
   750*                   move spaces  to IFF-LETTER-ID
   751*                end-if
   752*             when 'fu_date'
   753*              if w-form-value-len not = 0
   754*                   move w-form-value(1:w-form-value-len)
   755*                                to IFF-FOLLOW-UP-DT
   756*                                   BL-FOLLOW-UP-DT
   757*                else
   758*                 move spaces  to IFF-FOLLOW-UP-DT
   759*                end-if
   760*             when 'rs_date'
   761*              if w-form-value-len not = 0
   762*                   move w-form-value(1:w-form-value-len)
   763*                                to IFF-RESEND-DT
   764*                                   BL-RESEND-DT
   765*                else
   766*                 move spaces  to IFF-RESEND-DT
   767*                end-if
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* LORPT.cbl
   768*             when 'no_copies'
   769*              if w-form-value-len not = 0
   770*                   move w-form-value(1:w-form-value-len)
   771*                                to IFF-NO-OF-COPIES
   772*                                   BL-NO-OF-COPIES
   773*                else
   774*                   move zeros   to IFF-NO-OF-COPIES
   775*                end-if
   776*             when 'proc_id'
   777*              if w-form-value-len not = 0
   778*                   move w-form-value(1:w-form-value-len)
   779*                                to IFF-PROC-ID
   780*                                   BL-PROC-ID
   781*                else
   782*                   move 'KMSB'  to IFF-PROC-ID
   783*                end-if
   784*             when 'comp_id'
   785*              if w-form-value-len not = 0
   786*                   move w-form-value(1:w-form-value-len)
   787*                                to IFF-COMP-ID
   788*                                   BL-COMP-ID
   789*                else
   790*                   move 'CID'   to IFF-COMP-ID
   791*                end-if
   792*             when 'prt_now'
   793*              if w-form-value-len not = 0
   794*                   move w-form-value(1:w-form-value-len)
   795*                                to IFF-PRINT-NOW-SW
   796*                                   BL-PRINT-NOW-SW
   797*                else
   798*                   move 'N'     to IFF-PRINT-NOW-SW
   799*                end-if
   800*             when 'enc_cd'
   801*              if w-form-value-len not = 0
   802*                   move w-form-value(1:w-form-value-len)
   803*                                to IFF-ENC-CD
   804*                                   BL-ENC-CD
   805*                else
   806*                   move '0'     to IFF-ENC-CD
   807*                end-if
   808*             when 'regarding'
   809*              if w-form-value-len not = 0
   810*                   move w-form-value(1:w-form-value-len)
   811*                                to IFF-REGARDING
   812*                                   BL-REGARDING
   813*                else
   814*                   move SPACES  to IFF-REGARDING BL-REGARDING
   815*                end-if
   816*          end-evaluate
   817*       when other
   818*          continue
   819*    end-evaluate.
   820*read-form-exit.
   821 9700-DATE-LINK.
   822
   823* EXEC CICS LINK
   824*        PROGRAM   ('ELDATCV')
   825*        COMMAREA  (DATE-CONVERSION-DATA)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* LORPT.cbl
   826*        LENGTH    (DC-COMM-LENGTH)
   827*    END-EXEC.
   828     MOVE 'ELDATCV' TO DFHEIV1
   829*    MOVE '."C                   ''   #00000686' TO DFHEIV0
   830     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
   831     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
   832     MOVE X'2020233030303030363836' TO DFHEIV0(25:11)
   833     CALL 'kxdfhei1' USING DFHEIV0,
   834           DFHEIV1,
   835           DATE-CONVERSION-DATA,
   836           DC-COMM-LENGTH,
   837           DFHEIV99,
   838           DFHEIV99,
   839           DFHEIV99
   840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   841
   842 9700-EXIT.
   843      EXIT.
   844
   845 9999-DFHBACK SECTION.
   846     MOVE '9%                    "   ' TO DFHEIV0
   847     MOVE 'LORPT' TO DFHEIV1
   848     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
   849     GOBACK.
   850 9999-DFHEXIT.
   851     IF DFHEIGDJ EQUAL 0001
   852         NEXT SENTENCE.
   853     MOVE '9%                    "   ' TO DFHEIV0
   854     MOVE 'LORPT' TO DFHEIV1
   855     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
   856     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       19152     Code:        1944
