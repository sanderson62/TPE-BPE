* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL613.cbl
* Options: int("EL613.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL613.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL613.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL613.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL613 .
     3*                            VMOD=2.001.
     4*
     5*
     6*AUTHOR.    PABLO.
     7*           COLLEYVILLE TX.
     8*DATE-COMPILED.
     9*SECURITY.   *****************************************************
    10*            *                                                   *
    11*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    12*            *                                                   *
    13*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL613.cbl
    14*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
    15*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    16*            *                                                   *
    17*            *****************************************************
    18*REMARKS.
    19*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    20*    FOR THE DENIAL CODES IN THE CLAIM SYSTE.
    21*
    22*    SCREENS     - EL613A - DENIAL CODE MAINTENANCE
    23*
    24*    ENTERED BY  - EL101 - SYSTEM ADMINISTRATION MENU
    25*
    26*    EXIT TO     - EL101 - SYSTEM ADMINISTRATION MENU
    27*
    28*    COMMAREA    - PASSED
    29*
    30*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL101.  ON
    31*                  FIRST ENTRY, A SKELETON SCREEN IS SENT AND THE
    32*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    33*                  ENTRIES (XCTL FROM CICS VIA EX  ) THE SCREEN
    34*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    35*                  MAINTENANCE TYPE INDICATED.
    36******************************************************************
    37*                   C H A N G E   L O G
    38*
    39* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    40*-----------------------------------------------------------------
    41*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    42* EFFECTIVE    NUMBER
    43*-----------------------------------------------------------------
    44* 120808    2008100900001  PEMA  NEW PROGRAM
    45******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL613.cbl
    47 ENVIRONMENT DIVISION.
    48 DATA DIVISION.
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51 77  FILLER  PIC X(32)  VALUE '********************************'.
    52 77  FILLER  PIC X(32)  VALUE '*   EL613  WORKING STORAGE     *'.
    53 77  FILLER  PIC X(32)  VALUE '***********VMOD=2.001 **********'.
    54 77  CI1                PIC S999  COMP-3 VALUE +0.
    55 77  B1                 PIC S999  COMP-3 VALUE +0.
    56*    COPY ELCSCTM.
    57******************************************************************
    58*                                                                *
    59*                                                                *
    60*                            ELCSCTM                             *
    61*                            VMOD=2.001                          *
    62*                                                                *
    63*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    64*                                                                *
    65******************************************************************
    66 01  SECURITY-MESSAGE.
    67     12  FILLER                          PIC X(30)
    68            VALUE '** LOGIC SECURITY VIOLATION -'.
    69     12  SM-READ                         PIC X(6).
    70     12  FILLER                          PIC X(5)
    71            VALUE ' PGM='.
    72     12  SM-PGM                          PIC X(6).
    73     12  FILLER                          PIC X(5)
    74            VALUE ' OPR='.
    75     12  SM-PROCESSOR-ID                 PIC X(4).
    76     12  FILLER                          PIC X(6)
    77            VALUE ' TERM='.
    78     12  SM-TERMID                       PIC X(4).
    79     12  FILLER                          PIC XX   VALUE SPACE.
    80     12  SM-JUL-DATE                     PIC 9(5).
    81     12  FILLER                          PIC X    VALUE SPACE.
    82     12  SM-TIME                         PIC 99.99.
    83
    84*    COPY ELCSCRTY.
    85******************************************************************
    86*                                                                *
    87*                                                                *
    88*                            ELCSCRTY                            *
    89*                            VMOD=2.001                          *
    90*                                                                *
    91*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    92*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    93*        SAVED IN PI-SECURITY-ADDRESS.                           *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-CONTROL.
    97     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    98     12  FILLER                       PIC XX    VALUE 'SC'.
    99     12  SC-CREDIT-CODES.
   100         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   101             20  SC-CREDIT-DISPLAY    PIC X.
   102             20  SC-CREDIT-UPDATE     PIC X.
   103     12  SC-CLAIMS-CODES.
   104         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL613.cbl
   105             20  SC-CLAIMS-DISPLAY    PIC X.
   106             20  SC-CLAIMS-UPDATE     PIC X.
   107 01  WS-DATE-AREA.
   108     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   109    05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   110 01  FILLER                          COMP-3.
   111     05  WS-RECORD-COUNT             PIC S9(3)   VALUE ZERO.
   112     05  WS-READNEXT-SW              PIC S9      VALUE ZERO.
   113     05  WS-LAST-ERROR-COUNT         PIC S9(3)   VALUE ZERO.
   114     05  WS-UPDATE-SW                PIC S9      VALUE ZERO.
   115     05  WS-COMPLETED-SUCCESSFUL     PIC S9      VALUE ZERO.
   116       88  TRANSACTION-SUCCESSFUL                    VALUE +1.
   117       88  INITIAL-TRANSACTION                       VALUE +2.
   118       88  CHANGE-SUCCESSFUL                         VALUE +3.
   119     05  TIME-IN                     PIC S9(7)   VALUE ZERO.
   120     05  TIME-OUT                    REDEFINES
   121         TIME-IN                     PIC S9(3)V9(4).
   122 01  FILLER                          COMP SYNC.
   123     05  WS-INDEX                    PIC S9(4)   VALUE ZERO.
   124     05  WS-JOURNAL-FILE-ID          PIC S9(4)   VALUE +1.
   125     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +773.
   126     05  ELDENY-LENGTH               PIC S9(4)   VALUE +125.
   127     05  GETMAIN-SPACE               PIC  X      VALUE SPACE.
   128 01  FILLER.
   129     05  SC-ITEM             PIC S9(4) COMP VALUE +1.
   130     05  DEEDIT-FIELD        PIC  X(10).
   131     05  DEEDIT-FIELD-V0  REDEFINES
   132         DEEDIT-FIELD        PIC S9(10).
   133     05  WS-RESPONSE             PIC S9(8)   COMP.
   134         88  RESP-NORMAL              VALUE +00.
   135         88  RESP-ERROR               VALUE +01.
   136         88  RESP-NOTFND              VALUE +13.
   137         88  RESP-NOTOPEN             VALUE +19.
   138         88  RESP-ENDFILE             VALUE +20.
   139     05  WS-ELDENY-KEY.
   140         10  WS-COMPANY-CD           PIC X      VALUE LOW-VALUES.
   141         10  WS-DENIAL-CODE          PIC X(4)   VALUE LOW-VALUES.
   142         10  FILLER                  PIC X(10)  VALUE LOW-VALUES.
   143     05  WS-ELDENY2-KEY.
   144         10  WS-COMPANY-CD-A1        PIC X      VALUE LOW-VALUES.
   145         10  WS-DENIAL-TYPE          PIC X      VALUE LOW-VALUES.
   146         10  WS-DENIAL-CODE-A1       PIC X(4)   VALUE LOW-VALUES.
   147         10  FILLER                  PIC X(10)  VALUE LOW-VALUES.
   148     05  WS-MAPSET-NAME              PIC X(8)  VALUE 'EL613S'.
   149     05  WS-MAP-NAME                 PIC X(8)  VALUE 'EL613A'.
   150     05  FILLER                      REDEFINES
   151         WS-MAP-NAME.
   152         10  FILLER                  PIC XX.
   153         10  WS-MAP-NUMBER           PIC X(4).
   154         10  FILLER                  PIC XX.
   155     05  THIS-PGM                    PIC X(8)  VALUE 'EL613'.
   156     05  WS-JOURNAL-TYPE-ID          PIC XX      VALUE 'EL'.
   157     05  WS-LOW-VALUES               PIC X VALUE LOW-VALUES.
   158     05  WS-SPACE                    PIC X       VALUE SPACE.
   159     05  WS-TRANS-ID                 PIC X(4)    VALUE 'EXAH'.
   160     05  WS-TEMP-STORAGE-KEY.
   161         10  WS-TS-TERM-ID           PIC X(4)    VALUE 'XXXX'.
   162         10  FILLER                  PIC X(4)    VALUE '613'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL613.cbl
   163     05  WS-ERROR-MESSAGE-AREA.
   164         10  ER-0000                 PIC 9(4)   VALUE 0000.
   165         10  ER-0004                 PIC 9(4)   VALUE 0004.
   166         10  ER-0006                 PIC 9(4)   VALUE 0006.
   167         10  ER-0008                 PIC 9(4)   VALUE 0008.
   168         10  ER-0023                 PIC 9(4)   VALUE 0023.
   169         10  ER-0029                 PIC 9(4)   VALUE 0029.
   170         10  ER-0070                 PIC 9(4)   VALUE 0070.
   171         10  ER-0150                 PIC 9(4)   VALUE 0150.
   172         10  ER-0491                 PIC 9(4)   VALUE 0491.
   173         10  ER-1079                 PIC 9(4)   VALUE 1079.
   174         10  ER-1257                 PIC 9(4)   VALUE 1257.
   175         10  ER-1258                 PIC 9(4)   VALUE 1258.
   176         10  ER-2261                 PIC 9(4)   VALUE 2261.
   177         10  ER-3800                 PIC 9(4)   VALUE 3800.
   178         10  ER-3801                 PIC 9(4)   VALUE 3801.
   179         10  ER-3802                 PIC 9(4)   VALUE 3802.
   180         10  ER-3803                 PIC 9(4)   VALUE 3803.
   181         10  ER-3804                 PIC 9(4)   VALUE 3804.
   182         10  ER-3805                 PIC 9(4)   VALUE 3805.
   183         10  ER-3806                 PIC 9(4)   VALUE 3806.
   184         10  ER-3807                 PIC 9(4)   VALUE 3807.
   185         10  ER-3840                 PIC 9(4)   VALUE 3840.
   186         10  ER-3841                 PIC 9(4)   VALUE 3841.
   187         10  ER-3842                 PIC 9(4)   VALUE 3842.
   188         10  ER-7220                 PIC 9(4)   VALUE 7220.
   189         10  ER-7698                 PIC 9(4)   VALUE 7698.
   190         10  ER-9999                 PIC 9(4)   VALUE 9999.
   191*    COPY ELCINTF.
   192******************************************************************
   193*                                                                *
   194*                                                                *
   195*                            ELCINTF.                            *
   196*                            VMOD=2.017                          *
   197*                                                                *
   198*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   199*                                                                *
   200*       LENGTH = 1024                                            *
   201*                                                                *
   202******************************************************************
   203 01  PROGRAM-INTERFACE-BLOCK.
   204     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   205     12  PI-CALLING-PROGRAM              PIC X(8).
   206     12  PI-SAVED-PROGRAM-1              PIC X(8).
   207     12  PI-SAVED-PROGRAM-2              PIC X(8).
   208     12  PI-SAVED-PROGRAM-3              PIC X(8).
   209     12  PI-SAVED-PROGRAM-4              PIC X(8).
   210     12  PI-SAVED-PROGRAM-5              PIC X(8).
   211     12  PI-SAVED-PROGRAM-6              PIC X(8).
   212     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   213     12  PI-COMPANY-ID                   PIC XXX.
   214     12  PI-COMPANY-CD                   PIC X.
   215
   216     12  PI-COMPANY-PASSWORD             PIC X(8).
   217
   218     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   219
   220     12  PI-CONTROL-IN-PROGRESS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL613.cbl
   221         16  PI-CARRIER                  PIC X.
   222         16  PI-GROUPING                 PIC X(6).
   223         16  PI-STATE                    PIC XX.
   224         16  PI-ACCOUNT                  PIC X(10).
   225         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   226                                         PIC X(10).
   227         16  PI-CLAIM-CERT-GRP.
   228             20  PI-CLAIM-NO             PIC X(7).
   229             20  PI-CERT-NO.
   230                 25  PI-CERT-PRIME       PIC X(10).
   231                 25  PI-CERT-SFX         PIC X.
   232             20  PI-CERT-EFF-DT          PIC XX.
   233         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   234             20  PI-PLAN-CODE            PIC X(2).
   235             20  PI-REVISION-NUMBER      PIC X(3).
   236             20  PI-PLAN-EFF-DT          PIC X(2).
   237             20  PI-PLAN-EXP-DT          PIC X(2).
   238             20  FILLER                  PIC X(11).
   239         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   240             20  PI-OE-REFERENCE-1.
   241                 25  PI-OE-REF-1-PRIME   PIC X(18).
   242                 25  PI-OE-REF-1-SUFF    PIC XX.
   243
   244     12  PI-SESSION-IN-PROGRESS          PIC X.
   245         88  CLAIM-SESSION                   VALUE '1'.
   246         88  CREDIT-SESSION                  VALUE '2'.
   247         88  WARRANTY-SESSION                VALUE '3'.
   248         88  MORTGAGE-SESSION                VALUE '4'.
   249         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   250
   251
   252*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   253
   254     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   255     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   256
   257     12  PI-CREDIT-USER                  PIC X.
   258         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   259         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   260
   261     12  PI-CLAIM-USER                   PIC X.
   262         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   263         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   264
   265     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   266         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   267         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   268         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   269         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   270         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   271
   272     12  PI-PROCESSOR-ID                 PIC X(4).
   273
   274     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   275
   276     12  PI-MEMBER-CAPTION               PIC X(10).
   277
   278     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL613.cbl
   279         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   280
   281     12  PI-LIFE-OVERRIDE-L1             PIC X.
   282     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   283     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   284     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   285
   286     12  PI-AH-OVERRIDE-L1               PIC X.
   287     12  PI-AH-OVERRIDE-L2               PIC XX.
   288     12  PI-AH-OVERRIDE-L6               PIC X(6).
   289     12  PI-AH-OVERRIDE-L12              PIC X(12).
   290
   291     12  PI-NEW-SYSTEM                   PIC X(2).
   292
   293     12  PI-PRIMARY-CERT-NO              PIC X(11).
   294     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   295         88  PI-USES-PAID-TO                 VALUE '1'.
   296     12  PI-CRDTCRD-SYSTEM.
   297         16  PI-CRDTCRD-USER             PIC X.
   298             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   299             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   300         16  PI-CC-MONTH-END-DT          PIC XX.
   301     12  PI-PROCESSOR-PRINTER            PIC X(4).
   302
   303     12  PI-OE-REFERENCE-2.
   304         16  PI-OE-REF-2-PRIME           PIC X(10).
   305         16  PI-OE-REF-2-SUFF            PIC X.
   306
   307     12  PI-REM-TRM-CALC-OPTION          PIC X.
   308
   309     12  PI-LANGUAGE-TYPE                PIC X.
   310             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   311             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   312             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   313
   314     12  PI-POLICY-LINKAGE-IND           PIC X.
   315         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   316         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   317                                                   LOW-VALUES.
   318
   319     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   320     12  PI-CLAIM-PW-SESSION             PIC X(1).
   321         88  PI-CLAIM-CREDIT                 VALUE '1'.
   322         88  PI-CLAIM-CONVEN                 VALUE '2'.
   323     12  FILLER                          PIC X(4).
   324
   325     12  PI-SYSTEM-LEVEL                 PIC X(145).
   326
   327     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   328         PI-SYSTEM-LEVEL.
   329
   330         16  PI-ENTRY-CODES.
   331             20  PI-ENTRY-CD-1           PIC X.
   332             20  PI-ENTRY-CD-2           PIC X.
   333
   334         16  PI-RETURN-CODES.
   335             20  PI-RETURN-CD-1          PIC X.
   336             20  PI-RETURN-CD-2          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL613.cbl
   337
   338         16  PI-UPDATE-STATUS-SAVE.
   339             20  PI-UPDATE-BY            PIC X(4).
   340             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   341
   342         16  PI-LOWER-CASE-LETTERS       PIC X.
   343             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   344
   345*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   346*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   347*            88  CARRIER-CLM-CNTL            VALUE '2'.
   348
   349         16  PI-CERT-ACCESS-CONTROL      PIC X.
   350             88  ST-ACCNT-CNTL               VALUE ' '.
   351             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   352             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   353             88  ACCNT-CNTL                  VALUE '3'.
   354             88  CARR-ACCNT-CNTL             VALUE '4'.
   355
   356         16  PI-PROCESSOR-CAP-LIST.
   357             20  PI-SYSTEM-CONTROLS.
   358                24 PI-SYSTEM-DISPLAY     PIC X.
   359                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   360                24 PI-SYSTEM-MODIFY      PIC X.
   361                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   362             20  FILLER                  PIC XX.
   363             20  PI-DISPLAY-CAP          PIC X.
   364                 88  DISPLAY-CAP             VALUE 'Y'.
   365             20  PI-MODIFY-CAP           PIC X.
   366                 88  MODIFY-CAP              VALUE 'Y'.
   367             20  PI-MSG-AT-LOGON-CAP     PIC X.
   368                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   369             20  PI-FORCE-CAP            PIC X.
   370                 88  FORCE-CAP               VALUE 'Y'.
   371
   372         16  PI-PROGRAM-CONTROLS.
   373             20  PI-PGM-PRINT-OPT        PIC X.
   374             20  PI-PGM-FORMAT-OPT       PIC X.
   375             20  PI-PGM-PROCESS-OPT      PIC X.
   376             20  PI-PGM-TOTALS-OPT       PIC X.
   377
   378         16  PI-HELP-INTERFACE.
   379             20  PI-LAST-ERROR-NO        PIC X(4).
   380             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   381
   382         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   383             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   384
   385         16  PI-CR-CONTROL-IN-PROGRESS.
   386             20  PI-CR-CARRIER           PIC X.
   387             20  PI-CR-GROUPING          PIC X(6).
   388             20  PI-CR-STATE             PIC XX.
   389             20  PI-CR-ACCOUNT           PIC X(10).
   390             20  PI-CR-FIN-RESP          PIC X(10).
   391             20  PI-CR-TYPE              PIC X.
   392
   393         16  PI-CR-BATCH-NUMBER          PIC X(6).
   394
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL613.cbl
   395         16  PI-CR-MONTH-END-DT          PIC XX.
   396
   397         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   398             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   399             88  PI-ZERO-CARRIER             VALUE '1'.
   400             88  PI-ZERO-GROUPING            VALUE '2'.
   401             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   402
   403         16  PI-CARRIER-SECURITY         PIC X.
   404             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   405
   406         16  PI-ACCOUNT-SECURITY         PIC X(10).
   407             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   408             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   409
   410         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   411             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   412                                         INDEXED BY PI-ACCESS-NDX
   413                                         PIC X.
   414
   415         16  PI-GA-BILLING-CONTROL       PIC X.
   416             88  PI-GA-BILLING               VALUE '1'.
   417
   418         16  PI-MAIL-PROCESSING          PIC X.
   419             88  PI-MAIL-YES                 VALUE 'Y'.
   420
   421         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   422
   423         16  PI-AR-SYSTEM.
   424             20  PI-AR-PROCESSING-CNTL   PIC X.
   425                 88  PI-AR-PROCESSING        VALUE 'Y'.
   426             20  PI-AR-SUMMARY-CODE      PIC X(6).
   427             20  PI-AR-MONTH-END-DT      PIC XX.
   428
   429         16  PI-MP-SYSTEM.
   430             20  PI-MORTGAGE-USER            PIC X.
   431                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   432                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   433             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   434                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   435                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   436                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   437                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   438                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   439             20  PI-MP-MONTH-END-DT          PIC XX.
   440             20  PI-MP-REFERENCE-NO.
   441                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   442                 24  PI-MP-REFERENCE-SFX     PIC XX.
   443
   444         16  PI-LABEL-CONTROL            PIC X(01).
   445             88  PI-CREATE-LABELS                    VALUE 'Y'.
   446             88  PI-BYPASS-LABELS                    VALUE 'N'.
   447
   448         16  PI-BILL-GROUPING-CODE       PIC X(01).
   449             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   450
   451         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   452             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL613.cbl
   453             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   454
   455         16  FILLER                      PIC X(14).
   456
   457     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   458******************************************************************
   459     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   460         16  PI-1ST-TIME-SW          PIC S9     COMP-3.
   461         16  PI-MODE                 PIC X.
   462             88  ADD-FUNCTION         VALUE 'A'.
   463         16  PI-DN-RCODE             PIC XXXX.
   464         16  PI-DN-TOP-KEY           PIC X(16).
   465         16  PI-DN-BOT-KEY           PIC X(16).
   466         16  PI-DN-KEYS OCCURS 10.
   467             20  PI-DN-KEY           PIC X(15).
   468         16  PI-DN-KEYS-ALT OCCURS 10.
   469             20  PI-DN-KEY-ALT       PIC X(16).
   470         16  PI-LINE-COUNT           PIC S9(3)  COMP-3.
   471         16  PI-BROWSE-SW            PIC S9     COMP-3.
   472         16  PI-SHOW-SW              PIC S9     COMP-3.
   473         16  PI-CHANGE-SW            PIC S9     COMP-3.
   474         16  PI-WHAT-FILE-SW         PIC X.
   475             88  PI-BASE-FILE          VALUE '1'.
   476             88  PI-ALT-FILE           VALUE '2'.
   477         16  FILLER                  PIC X(350).
   478*    COPY EL613S.
   479 01  EL613AI.
   480     05  FILLER            PIC  X(0012).
   481*    -------------------------------
   482     05  ADATEL PIC S9(0004) COMP.
   483     05  ADATEF PIC  X(0001).
   484     05  FILLER REDEFINES ADATEF.
   485         10  ADATEA PIC  X(0001).
   486     05  ADATEI PIC  X(0008).
   487*    -------------------------------
   488     05  ATIMEL PIC S9(0004) COMP.
   489     05  ATIMEF PIC  X(0001).
   490     05  FILLER REDEFINES ATIMEF.
   491         10  ATIMEA PIC  X(0001).
   492     05  ATIMEI PIC  X(0005).
   493*    -------------------------------
   494     05  AMAINTL PIC S9(0004) COMP.
   495     05  AMAINTF PIC  X(0001).
   496     05  FILLER REDEFINES AMAINTF.
   497         10  AMAINTA PIC  X(0001).
   498     05  AMAINTI PIC  X(0001).
   499*    -------------------------------
   500     05  RCODE01L PIC S9(0004) COMP.
   501     05  RCODE01F PIC  X(0001).
   502     05  FILLER REDEFINES RCODE01F.
   503         10  RCODE01A PIC  X(0001).
   504     05  RCODE01I PIC  X(0004).
   505*    -------------------------------
   506     05  TYPE01L PIC S9(0004) COMP.
   507     05  TYPE01F PIC  X(0001).
   508     05  FILLER REDEFINES TYPE01F.
   509         10  TYPE01A PIC  X(0001).
   510     05  TYPE01I PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL613.cbl
   511*    -------------------------------
   512     05  DESC01L PIC S9(0004) COMP.
   513     05  DESC01F PIC  X(0001).
   514     05  FILLER REDEFINES DESC01F.
   515         10  DESC01A PIC  X(0001).
   516     05  DESC01I PIC  X(0050).
   517*    -------------------------------
   518     05  RCODE02L PIC S9(0004) COMP.
   519     05  RCODE02F PIC  X(0001).
   520     05  FILLER REDEFINES RCODE02F.
   521         10  RCODE02A PIC  X(0001).
   522     05  RCODE02I PIC  X(0004).
   523*    -------------------------------
   524     05  TYPE02L PIC S9(0004) COMP.
   525     05  TYPE02F PIC  X(0001).
   526     05  FILLER REDEFINES TYPE02F.
   527         10  TYPE02A PIC  X(0001).
   528     05  TYPE02I PIC  X(0001).
   529*    -------------------------------
   530     05  DESC02L PIC S9(0004) COMP.
   531     05  DESC02F PIC  X(0001).
   532     05  FILLER REDEFINES DESC02F.
   533         10  DESC02A PIC  X(0001).
   534     05  DESC02I PIC  X(0050).
   535*    -------------------------------
   536     05  RCODE03L PIC S9(0004) COMP.
   537     05  RCODE03F PIC  X(0001).
   538     05  FILLER REDEFINES RCODE03F.
   539         10  RCODE03A PIC  X(0001).
   540     05  RCODE03I PIC  X(0004).
   541*    -------------------------------
   542     05  TYPE03L PIC S9(0004) COMP.
   543     05  TYPE03F PIC  X(0001).
   544     05  FILLER REDEFINES TYPE03F.
   545         10  TYPE03A PIC  X(0001).
   546     05  TYPE03I PIC  X(0001).
   547*    -------------------------------
   548     05  DESC03L PIC S9(0004) COMP.
   549     05  DESC03F PIC  X(0001).
   550     05  FILLER REDEFINES DESC03F.
   551         10  DESC03A PIC  X(0001).
   552     05  DESC03I PIC  X(0050).
   553*    -------------------------------
   554     05  RCODE04L PIC S9(0004) COMP.
   555     05  RCODE04F PIC  X(0001).
   556     05  FILLER REDEFINES RCODE04F.
   557         10  RCODE04A PIC  X(0001).
   558     05  RCODE04I PIC  X(0004).
   559*    -------------------------------
   560     05  TYPE04L PIC S9(0004) COMP.
   561     05  TYPE04F PIC  X(0001).
   562     05  FILLER REDEFINES TYPE04F.
   563         10  TYPE04A PIC  X(0001).
   564     05  TYPE04I PIC  X(0001).
   565*    -------------------------------
   566     05  DESC04L PIC S9(0004) COMP.
   567     05  DESC04F PIC  X(0001).
   568     05  FILLER REDEFINES DESC04F.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL613.cbl
   569         10  DESC04A PIC  X(0001).
   570     05  DESC04I PIC  X(0050).
   571*    -------------------------------
   572     05  RCODE05L PIC S9(0004) COMP.
   573     05  RCODE05F PIC  X(0001).
   574     05  FILLER REDEFINES RCODE05F.
   575         10  RCODE05A PIC  X(0001).
   576     05  RCODE05I PIC  X(0004).
   577*    -------------------------------
   578     05  TYPE05L PIC S9(0004) COMP.
   579     05  TYPE05F PIC  X(0001).
   580     05  FILLER REDEFINES TYPE05F.
   581         10  TYPE05A PIC  X(0001).
   582     05  TYPE05I PIC  X(0001).
   583*    -------------------------------
   584     05  DESC05L PIC S9(0004) COMP.
   585     05  DESC05F PIC  X(0001).
   586     05  FILLER REDEFINES DESC05F.
   587         10  DESC05A PIC  X(0001).
   588     05  DESC05I PIC  X(0050).
   589*    -------------------------------
   590     05  RCODE06L PIC S9(0004) COMP.
   591     05  RCODE06F PIC  X(0001).
   592     05  FILLER REDEFINES RCODE06F.
   593         10  RCODE06A PIC  X(0001).
   594     05  RCODE06I PIC  X(0004).
   595*    -------------------------------
   596     05  TYPE06L PIC S9(0004) COMP.
   597     05  TYPE06F PIC  X(0001).
   598     05  FILLER REDEFINES TYPE06F.
   599         10  TYPE06A PIC  X(0001).
   600     05  TYPE06I PIC  X(0001).
   601*    -------------------------------
   602     05  DESC06L PIC S9(0004) COMP.
   603     05  DESC06F PIC  X(0001).
   604     05  FILLER REDEFINES DESC06F.
   605         10  DESC06A PIC  X(0001).
   606     05  DESC06I PIC  X(0050).
   607*    -------------------------------
   608     05  RCODE07L PIC S9(0004) COMP.
   609     05  RCODE07F PIC  X(0001).
   610     05  FILLER REDEFINES RCODE07F.
   611         10  RCODE07A PIC  X(0001).
   612     05  RCODE07I PIC  X(0004).
   613*    -------------------------------
   614     05  TYPE07L PIC S9(0004) COMP.
   615     05  TYPE07F PIC  X(0001).
   616     05  FILLER REDEFINES TYPE07F.
   617         10  TYPE07A PIC  X(0001).
   618     05  TYPE07I PIC  X(0001).
   619*    -------------------------------
   620     05  DESC07L PIC S9(0004) COMP.
   621     05  DESC07F PIC  X(0001).
   622     05  FILLER REDEFINES DESC07F.
   623         10  DESC07A PIC  X(0001).
   624     05  DESC07I PIC  X(0050).
   625*    -------------------------------
   626     05  RCODE08L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL613.cbl
   627     05  RCODE08F PIC  X(0001).
   628     05  FILLER REDEFINES RCODE08F.
   629         10  RCODE08A PIC  X(0001).
   630     05  RCODE08I PIC  X(0004).
   631*    -------------------------------
   632     05  TYPE08L PIC S9(0004) COMP.
   633     05  TYPE08F PIC  X(0001).
   634     05  FILLER REDEFINES TYPE08F.
   635         10  TYPE08A PIC  X(0001).
   636     05  TYPE08I PIC  X(0001).
   637*    -------------------------------
   638     05  DESC08L PIC S9(0004) COMP.
   639     05  DESC08F PIC  X(0001).
   640     05  FILLER REDEFINES DESC08F.
   641         10  DESC08A PIC  X(0001).
   642     05  DESC08I PIC  X(0050).
   643*    -------------------------------
   644     05  RCODE09L PIC S9(0004) COMP.
   645     05  RCODE09F PIC  X(0001).
   646     05  FILLER REDEFINES RCODE09F.
   647         10  RCODE09A PIC  X(0001).
   648     05  RCODE09I PIC  X(0004).
   649*    -------------------------------
   650     05  TYPE09L PIC S9(0004) COMP.
   651     05  TYPE09F PIC  X(0001).
   652     05  FILLER REDEFINES TYPE09F.
   653         10  TYPE09A PIC  X(0001).
   654     05  TYPE09I PIC  X(0001).
   655*    -------------------------------
   656     05  DESC09L PIC S9(0004) COMP.
   657     05  DESC09F PIC  X(0001).
   658     05  FILLER REDEFINES DESC09F.
   659         10  DESC09A PIC  X(0001).
   660     05  DESC09I PIC  X(0050).
   661*    -------------------------------
   662     05  RCODE10L PIC S9(0004) COMP.
   663     05  RCODE10F PIC  X(0001).
   664     05  FILLER REDEFINES RCODE10F.
   665         10  RCODE10A PIC  X(0001).
   666     05  RCODE10I PIC  X(0004).
   667*    -------------------------------
   668     05  TYPE10L PIC S9(0004) COMP.
   669     05  TYPE10F PIC  X(0001).
   670     05  FILLER REDEFINES TYPE10F.
   671         10  TYPE10A PIC  X(0001).
   672     05  TYPE10I PIC  X(0001).
   673*    -------------------------------
   674     05  DESC10L PIC S9(0004) COMP.
   675     05  DESC10F PIC  X(0001).
   676     05  FILLER REDEFINES DESC10F.
   677         10  DESC10A PIC  X(0001).
   678     05  DESC10I PIC  X(0050).
   679*    -------------------------------
   680     05  AEMSG1L PIC S9(0004) COMP.
   681     05  AEMSG1F PIC  X(0001).
   682     05  FILLER REDEFINES AEMSG1F.
   683         10  AEMSG1A PIC  X(0001).
   684     05  AEMSG1I PIC  X(0079).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL613.cbl
   685*    -------------------------------
   686     05  AEMSG2L PIC S9(0004) COMP.
   687     05  AEMSG2F PIC  X(0001).
   688     05  FILLER REDEFINES AEMSG2F.
   689         10  AEMSG2A PIC  X(0001).
   690     05  AEMSG2I PIC  X(0079).
   691*    -------------------------------
   692     05  APFKL PIC S9(0004) COMP.
   693     05  APFKF PIC  X(0001).
   694     05  FILLER REDEFINES APFKF.
   695         10  APFKA PIC  X(0001).
   696     05  APFKI PIC  S99.
   697*    -------------------------------
   698     05  F3KEYL PIC S9(0004) COMP.
   699     05  F3KEYF PIC  X(0001).
   700     05  FILLER REDEFINES F3KEYF.
   701         10  F3KEYA PIC  X(0001).
   702     05  F3KEYI PIC  X(0017).
   703 01  EL613AO REDEFINES EL613AI.
   704     05  FILLER            PIC  X(0012).
   705*    -------------------------------
   706     05  FILLER            PIC  X(0003).
   707     05  ADATEO PIC  X(0008).
   708*    -------------------------------
   709     05  FILLER            PIC  X(0003).
   710     05  ATIMEO PIC  99.99.
   711*    -------------------------------
   712     05  FILLER            PIC  X(0003).
   713     05  AMAINTO PIC  X(0001).
   714*    -------------------------------
   715     05  FILLER            PIC  X(0003).
   716     05  RCODE01O PIC  X(0004).
   717*    -------------------------------
   718     05  FILLER            PIC  X(0003).
   719     05  TYPE01O PIC  X(0001).
   720*    -------------------------------
   721     05  FILLER            PIC  X(0003).
   722     05  DESC01O PIC  X(0050).
   723*    -------------------------------
   724     05  FILLER            PIC  X(0003).
   725     05  RCODE02O PIC  X(0004).
   726*    -------------------------------
   727     05  FILLER            PIC  X(0003).
   728     05  TYPE02O PIC  X(0001).
   729*    -------------------------------
   730     05  FILLER            PIC  X(0003).
   731     05  DESC02O PIC  X(0050).
   732*    -------------------------------
   733     05  FILLER            PIC  X(0003).
   734     05  RCODE03O PIC  X(0004).
   735*    -------------------------------
   736     05  FILLER            PIC  X(0003).
   737     05  TYPE03O PIC  X(0001).
   738*    -------------------------------
   739     05  FILLER            PIC  X(0003).
   740     05  DESC03O PIC  X(0050).
   741*    -------------------------------
   742     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL613.cbl
   743     05  RCODE04O PIC  X(0004).
   744*    -------------------------------
   745     05  FILLER            PIC  X(0003).
   746     05  TYPE04O PIC  X(0001).
   747*    -------------------------------
   748     05  FILLER            PIC  X(0003).
   749     05  DESC04O PIC  X(0050).
   750*    -------------------------------
   751     05  FILLER            PIC  X(0003).
   752     05  RCODE05O PIC  X(0004).
   753*    -------------------------------
   754     05  FILLER            PIC  X(0003).
   755     05  TYPE05O PIC  X(0001).
   756*    -------------------------------
   757     05  FILLER            PIC  X(0003).
   758     05  DESC05O PIC  X(0050).
   759*    -------------------------------
   760     05  FILLER            PIC  X(0003).
   761     05  RCODE06O PIC  X(0004).
   762*    -------------------------------
   763     05  FILLER            PIC  X(0003).
   764     05  TYPE06O PIC  X(0001).
   765*    -------------------------------
   766     05  FILLER            PIC  X(0003).
   767     05  DESC06O PIC  X(0050).
   768*    -------------------------------
   769     05  FILLER            PIC  X(0003).
   770     05  RCODE07O PIC  X(0004).
   771*    -------------------------------
   772     05  FILLER            PIC  X(0003).
   773     05  TYPE07O PIC  X(0001).
   774*    -------------------------------
   775     05  FILLER            PIC  X(0003).
   776     05  DESC07O PIC  X(0050).
   777*    -------------------------------
   778     05  FILLER            PIC  X(0003).
   779     05  RCODE08O PIC  X(0004).
   780*    -------------------------------
   781     05  FILLER            PIC  X(0003).
   782     05  TYPE08O PIC  X(0001).
   783*    -------------------------------
   784     05  FILLER            PIC  X(0003).
   785     05  DESC08O PIC  X(0050).
   786*    -------------------------------
   787     05  FILLER            PIC  X(0003).
   788     05  RCODE09O PIC  X(0004).
   789*    -------------------------------
   790     05  FILLER            PIC  X(0003).
   791     05  TYPE09O PIC  X(0001).
   792*    -------------------------------
   793     05  FILLER            PIC  X(0003).
   794     05  DESC09O PIC  X(0050).
   795*    -------------------------------
   796     05  FILLER            PIC  X(0003).
   797     05  RCODE10O PIC  X(0004).
   798*    -------------------------------
   799     05  FILLER            PIC  X(0003).
   800     05  TYPE10O PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL613.cbl
   801*    -------------------------------
   802     05  FILLER            PIC  X(0003).
   803     05  DESC10O PIC  X(0050).
   804*    -------------------------------
   805     05  FILLER            PIC  X(0003).
   806     05  AEMSG1O PIC  X(0079).
   807*    -------------------------------
   808     05  FILLER            PIC  X(0003).
   809     05  AEMSG2O PIC  X(0079).
   810*    -------------------------------
   811     05  FILLER            PIC  X(0003).
   812     05  APFKO PIC  X(0002).
   813*    -------------------------------
   814     05  FILLER            PIC  X(0003).
   815     05  F3KEYO PIC  X(0017).
   816*    -------------------------------
   817 01  EL613AO-R REDEFINES EL613AI.
   818     05  FILLER                      PIC X(35).
   819     05  WS-MAP-LINE                 OCCURS 10
   820                                     INDEXED BY M1.
   821         10  RCODEL                  PIC S9(4)  COMP.
   822         10  RCODEA                  PIC X.
   823         10  RCODEO                  PIC XXXX.
   824         10  RCODEI                  REDEFINES
   825             RCODEO                  PIC XXXX.
   826         10  TYPEL                   PIC S9(4)   COMP.
   827         10  TYPEA                   PIC X.
   828         10  TYPEO                   PIC X.
   829         10  TYPEI                   REDEFINES
   830             TYPEO                   PIC X.
   831         10  DESCL                   PIC S9(4)   COMP.
   832         10  DESCA                   PIC X.
   833         10  DESCO                   PIC X(50).
   834         10  DESCI                   REDEFINES
   835             DESCO                   PIC X(50).
   836*    COPY ELCJPFX.
   837******************************************************************
   838*                                                                *
   839*                                                                *
   840*                            ELCJPFX.                            *
   841*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   842*                            VMOD=2.002                          *
   843*                                                                *
   844*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   845*                                                                *
   846*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   847*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   848*        ELCNTL - CONTROL FILE                                   *
   849*        ELMSTR - CLAIM MASTERS                                  *
   850*        ELTRLR - ACTIVITY TRAILERS                              *
   851*        ELCHKQ - CHECK QUE                                      *
   852******************************************************************
   853 01  JOURNAL-RECORD.
   854     12  JP-USER-ID                  PIC X(4).
   855     12  JP-FILE-ID                  PIC X(8).
   856     12  JP-PROGRAM-ID               PIC X(8).
   857     12  JP-RECORD-TYPE              PIC X.
   858         88 JP-ADD              VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL613.cbl
   859         88 JP-BEFORE-CHANGE    VALUE 'B'.
   860         88 JP-AFTER-CHANGE     VALUE 'C'.
   861         88 JP-DELETE           VALUE 'D'.
   862         88 JP-GENERIC-DELETE   VALUE 'G'.
   863         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   864         88 JP-KEY-CHG-ADD      VALUE 'N'.
   865     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   866     12  JP-RECORD-AREA
   867
   868
   869                                     PIC X(750).
   870*    COPY ELCEMIB.
   871******************************************************************
   872*                                                                *
   873*                                                                *
   874*                            ELCEMIB.                            *
   875*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   876*                            VMOD=2.005                          *
   877*                                                                *
   878*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   879*                                                                *
   880******************************************************************
   881 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   882     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   883     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   884     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   885     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   886     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   887     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   888     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   889     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   890     12  EMI-SWITCH1             PIC X        VALUE '1'.
   891         88  EMI-NO-ERRORS                    VALUE '1'.
   892         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   893         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   894     12  EMI-SWITCH2             PIC X        VALUE '1'.
   895         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   896     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   897         88  EMI-AREA1-EMPTY                  VALUE '1'.
   898         88  EMI-AREA1-FULL                   VALUE '2'.
   899     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   900         88  EMI-AREA2-EMPTY                  VALUE '1'.
   901         88  EMI-AREA2-FULL                   VALUE '2'.
   902     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   903         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   904         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   905         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   906         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   907         88  EMI-BYPASS-FATALS                VALUE 'X'.
   908     12  EMI-ERROR-LINES.
   909         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   910         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   911         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   912         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   913             20  EMI-ERR-CODES OCCURS 10 TIMES.
   914                 24  EMI-ERR-NUM         PIC X(4).
   915                 24  EMI-FILLER          PIC X.
   916                 24  EMI-SEV             PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL613.cbl
   917                 24  FILLER              PIC X.
   918             20  FILLER                  PIC X(02).
   919     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   920         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   921             20  EMI-ERROR-NUMBER    PIC X(4).
   922             20  EMI-FILL            PIC X.
   923             20  EMI-SEVERITY        PIC X.
   924             20  FILLER              PIC X.
   925             20  EMI-ERROR-TEXT.
   926                 24  EMI-TEXT-VARIABLE   PIC X(10).
   927                 24  FILLER          PIC X(55).
   928     12  EMI-SEVERITY-SAVE           PIC X.
   929         88  EMI-NOTE                    VALUE 'N'.
   930         88  EMI-WARNING                 VALUE 'W'.
   931         88  EMI-FORCABLE                VALUE 'F'.
   932         88  EMI-FATAL                   VALUE 'X'.
   933     12  EMI-MESSAGE-FLAG            PIC X.
   934         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   935         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   936     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   937     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   938         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   939         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   940         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   941     12  FILLER                      PIC X(137)  VALUE SPACES.
   942     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   943     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   944     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   945     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   946*    COPY ELCDATE.
   947******************************************************************
   948*                                                                *
   949*                                                                *
   950*                            ELCDATE.                            *
   951*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   952*                            VMOD=2.003
   953*                                                                *
   954*                                                                *
   955*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   956*                 LENGTH = 200                                   *
   957******************************************************************
   958
   959 01  DATE-CONVERSION-DATA.
   960     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   961     12  DC-OPTION-CODE                PIC X.
   962         88  BIN-TO-GREG                VALUE ' '.
   963         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   964         88  EDIT-GREG-TO-BIN           VALUE '2'.
   965         88  YMD-GREG-TO-BIN            VALUE '3'.
   966         88  MDY-GREG-TO-BIN            VALUE '4'.
   967         88  JULIAN-TO-BIN              VALUE '5'.
   968         88  BIN-PLUS-ELAPSED           VALUE '6'.
   969         88  FIND-CENTURY               VALUE '7'.
   970         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   971         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   972         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   973         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   974         88  JULIAN-TO-BIN-3            VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL613.cbl
   975         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   976         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   977         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   978         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   979         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   980         88  CHECK-LEAP-YEAR            VALUE 'H'.
   981         88  BIN-3-TO-GREG              VALUE 'I'.
   982         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   983         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   984         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   985         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   986         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   987         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   988         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   989         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   990         88  THREE-CHARACTER-BIN
   991                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   992         88  GREGORIAN-TO-BIN
   993                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   994         88  BIN-TO-GREGORIAN
   995                  VALUES ' ' '1' 'I' '8' 'G'.
   996         88  JULIAN-TO-BINARY
   997                  VALUES '5' 'C' 'E' 'F'.
   998     12  DC-ERROR-CODE                 PIC X.
   999         88  NO-CONVERSION-ERROR        VALUE ' '.
  1000         88  DATE-CONVERSION-ERROR
  1001                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1002         88  DATE-IS-ZERO               VALUE '1'.
  1003         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1004         88  DATE-IS-INVALID            VALUE '3'.
  1005         88  DATE1-GREATER-DATE2        VALUE '4'.
  1006         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1007         88  DATE-INVALID-OPTION        VALUE '9'.
  1008         88  INVALID-CENTURY            VALUE 'A'.
  1009         88  ONLY-CENTURY               VALUE 'B'.
  1010         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1011         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1012     12  DC-END-OF-MONTH               PIC X.
  1013         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1014     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1015         88  USE-NORMAL-PROCESS         VALUE ' '.
  1016         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1017         88  ADJUST-UP-100-YRS          VALUE '2'.
  1018     12  FILLER                        PIC X.
  1019     12  DC-CONVERSION-DATES.
  1020         16  DC-BIN-DATE-1             PIC XX.
  1021         16  DC-BIN-DATE-2             PIC XX.
  1022         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1023         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1024                       DC-GREG-DATE-1-EDIT.
  1025             20  DC-EDIT1-MONTH        PIC 99.
  1026             20  SLASH1-1              PIC X.
  1027             20  DC-EDIT1-DAY          PIC 99.
  1028             20  SLASH1-2              PIC X.
  1029             20  DC-EDIT1-YEAR         PIC 99.
  1030         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1031         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1032                     DC-GREG-DATE-2-EDIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL613.cbl
  1033             20  DC-EDIT2-MONTH        PIC 99.
  1034             20  SLASH2-1              PIC X.
  1035             20  DC-EDIT2-DAY          PIC 99.
  1036             20  SLASH2-2              PIC X.
  1037             20  DC-EDIT2-YEAR         PIC 99.
  1038         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1039         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1040                     DC-GREG-DATE-1-YMD.
  1041             20  DC-YMD-YEAR           PIC 99.
  1042             20  DC-YMD-MONTH          PIC 99.
  1043             20  DC-YMD-DAY            PIC 99.
  1044         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1045         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1046                      DC-GREG-DATE-1-MDY.
  1047             20  DC-MDY-MONTH          PIC 99.
  1048             20  DC-MDY-DAY            PIC 99.
  1049             20  DC-MDY-YEAR           PIC 99.
  1050         16  DC-GREG-DATE-1-ALPHA.
  1051             20  DC-ALPHA-MONTH        PIC X(10).
  1052             20  DC-ALPHA-DAY          PIC 99.
  1053             20  FILLER                PIC XX.
  1054             20  DC-ALPHA-CENTURY.
  1055                 24 DC-ALPHA-CEN-N     PIC 99.
  1056             20  DC-ALPHA-YEAR         PIC 99.
  1057         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1058         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1059         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1060         16  DC-JULIAN-DATE            PIC 9(05).
  1061         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1062                                       PIC 9(05).
  1063         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1064             20  DC-JULIAN-YEAR        PIC 99.
  1065             20  DC-JULIAN-DAYS        PIC 999.
  1066         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1067         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1068         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1069     12  DATE-CONVERSION-VARIBLES.
  1070         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1071         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1072             20  FILLER                PIC 9(3).
  1073             20  HOLD-CEN-1-CCYY.
  1074                 24  HOLD-CEN-1-CC     PIC 99.
  1075                 24  HOLD-CEN-1-YY     PIC 99.
  1076             20  HOLD-CEN-1-MO         PIC 99.
  1077             20  HOLD-CEN-1-DA         PIC 99.
  1078         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1079             20  HOLD-CEN-1-R-MO       PIC 99.
  1080             20  HOLD-CEN-1-R-DA       PIC 99.
  1081             20  HOLD-CEN-1-R-CCYY.
  1082                 24  HOLD-CEN-1-R-CC   PIC 99.
  1083                 24  HOLD-CEN-1-R-YY   PIC 99.
  1084             20  FILLER                PIC 9(3).
  1085         16  HOLD-CENTURY-1-X.
  1086             20  FILLER                PIC X(3)  VALUE SPACES.
  1087             20  HOLD-CEN-1-X-CCYY.
  1088                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1089                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1090             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL613.cbl
  1091             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1092         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1093             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1094             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1095             20  HOLD-CEN-1-R-X-CCYY.
  1096                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1097                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1098             20  FILLER                PIC XXX.
  1099         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1100         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1101         16  DC-JULIAN-DATE-1          PIC 9(07).
  1102         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1103             20  DC-JULIAN-1-CCYY.
  1104                 24  DC-JULIAN-1-CC    PIC 99.
  1105                 24  DC-JULIAN-1-YR    PIC 99.
  1106             20  DC-JULIAN-DA-1        PIC 999.
  1107         16  DC-JULIAN-DATE-2          PIC 9(07).
  1108         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1109             20  DC-JULIAN-2-CCYY.
  1110                 24  DC-JULIAN-2-CC    PIC 99.
  1111                 24  DC-JULIAN-2-YR    PIC 99.
  1112             20  DC-JULIAN-DA-2        PIC 999.
  1113         16  DC-GREG-DATE-A-EDIT.
  1114             20  DC-EDITA-MONTH        PIC 99.
  1115             20  SLASHA-1              PIC X VALUE '/'.
  1116             20  DC-EDITA-DAY          PIC 99.
  1117             20  SLASHA-2              PIC X VALUE '/'.
  1118             20  DC-EDITA-CCYY.
  1119                 24  DC-EDITA-CENT     PIC 99.
  1120                 24  DC-EDITA-YEAR     PIC 99.
  1121         16  DC-GREG-DATE-B-EDIT.
  1122             20  DC-EDITB-MONTH        PIC 99.
  1123             20  SLASHB-1              PIC X VALUE '/'.
  1124             20  DC-EDITB-DAY          PIC 99.
  1125             20  SLASHB-2              PIC X VALUE '/'.
  1126             20  DC-EDITB-CCYY.
  1127                 24  DC-EDITB-CENT     PIC 99.
  1128                 24  DC-EDITB-YEAR     PIC 99.
  1129         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1130         16  DC-GREG-DATE-CYMD-R REDEFINES
  1131                              DC-GREG-DATE-CYMD.
  1132             20  DC-CYMD-CEN           PIC 99.
  1133             20  DC-CYMD-YEAR          PIC 99.
  1134             20  DC-CYMD-MONTH         PIC 99.
  1135             20  DC-CYMD-DAY           PIC 99.
  1136         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1137         16  DC-GREG-DATE-MDCY-R REDEFINES
  1138                              DC-GREG-DATE-MDCY.
  1139             20  DC-MDCY-MONTH         PIC 99.
  1140             20  DC-MDCY-DAY           PIC 99.
  1141             20  DC-MDCY-CEN           PIC 99.
  1142             20  DC-MDCY-YEAR          PIC 99.
  1143    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1144        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1145    12  DC-EL310-DATE                  PIC X(21).
  1146    12  FILLER                         PIC X(28).
  1147*    COPY ELCLOGOF.
  1148******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL613.cbl
  1149*                                                                *
  1150*                                                                *
  1151*                            ELCLOGOF.                           *
  1152*                            VMOD=2.001                          *
  1153*                                                                *
  1154*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1155*                                                                *
  1156******************************************************************
  1157 01  CLASIC-LOGOFF.
  1158     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1159     12  LOGOFF-TEXT.
  1160         16  FILLER          PIC X(5)    VALUE SPACES.
  1161         16  LOGOFF-MSG.
  1162             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1163             20  FILLER      PIC X       VALUE SPACES.
  1164             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1165         16  FILLER          PIC X(80)
  1166           VALUE '* YOU ARE NOW LOGGED OFF'.
  1167         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1168         16  FILLER          PIC X       VALUE QUOTE.
  1169         16  LOGOFF-SYS-MSG  PIC X(17)
  1170           VALUE 'S CLAS-IC SYSTEM '.
  1171     12  TEXT-MESSAGES.
  1172         16  UNACCESS-MSG    PIC X(29)
  1173             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1174         16  PGMIDERR-MSG    PIC X(17)
  1175             VALUE 'PROGRAM NOT FOUND'.
  1176*    COPY ELCATTR.
  1177******************************************************************
  1178*                                                                *
  1179*                            ELCATTR.                            *
  1180*                            VMOD=2.001                          *
  1181*                                                                *
  1182*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1183*                                                                *
  1184*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1185*                                                                *
  1186*                   POS 1   P=PROTECTED                          *
  1187*                           U=UNPROTECTED                        *
  1188*                           S=ASKIP                              *
  1189*                   POS 2   A=ALPHA/NUMERIC                      *
  1190*                           N=NUMERIC                            *
  1191*                   POS 3   N=NORMAL                             *
  1192*                           B=BRIGHT                             *
  1193*                           D=DARK                               *
  1194*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1195*                           OF=MODIFIED DATA TAG OFF             *
  1196*                                                                *
  1197*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1198******************************************************************
  1199 01  ATTRIBUTE-LIST.
  1200     12  AL-PABOF            PIC X       VALUE 'Y'.
  1201     12  AL-PABON            PIC X       VALUE 'Z'.
  1202     12  AL-PADOF            PIC X       VALUE '%'.
  1203     12  AL-PADON            PIC X       VALUE '_'.
  1204     12  AL-PANOF            PIC X       VALUE '-'.
  1205     12  AL-PANON            PIC X       VALUE '/'.
  1206     12  AL-SABOF            PIC X       VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL613.cbl
  1207     12  AL-SABON            PIC X       VALUE '9'.
  1208     12  AL-SADOF            PIC X       VALUE '@'.
  1209     12  AL-SADON            PIC X       VALUE QUOTE.
  1210     12  AL-SANOF            PIC X       VALUE '0'.
  1211     12  AL-SANON            PIC X       VALUE '1'.
  1212     12  AL-UABOF            PIC X       VALUE 'H'.
  1213     12  AL-UABON            PIC X       VALUE 'I'.
  1214     12  AL-UADOF            PIC X       VALUE '<'.
  1215     12  AL-UADON            PIC X       VALUE '('.
  1216     12  AL-UANOF            PIC X       VALUE ' '.
  1217     12  AL-UANON            PIC X       VALUE 'A'.
  1218     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1219     12  AL-UNBON            PIC X       VALUE 'R'.
  1220     12  AL-UNDOF            PIC X       VALUE '*'.
  1221     12  AL-UNDON            PIC X       VALUE ')'.
  1222     12  AL-UNNOF            PIC X       VALUE '&'.
  1223     12  AL-UNNON            PIC X       VALUE 'J'.
  1224*    COPY ELCAID.
  1225******************************************************************
  1226*                                                                *
  1227*                            ELCAID.                             *
  1228*                            VMOD=2.001                          *
  1229*                                                                *
  1230*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1231*                                                                *
  1232*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1233*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1234******************************************************************
  1235
  1236 01  DFHAID.
  1237   02  DFHNULL   PIC  X  VALUE  ' '.
  1238   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1239   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1240   02  DFHPEN    PIC  X  VALUE  '='.
  1241   02  DFHOPID   PIC  X  VALUE  'W'.
  1242   02  DFHPA1    PIC  X  VALUE  '%'.
  1243   02  DFHPA2    PIC  X  VALUE  '>'.
  1244   02  DFHPA3    PIC  X  VALUE  ','.
  1245   02  DFHPF1    PIC  X  VALUE  '1'.
  1246   02  DFHPF2    PIC  X  VALUE  '2'.
  1247   02  DFHPF3    PIC  X  VALUE  '3'.
  1248   02  DFHPF4    PIC  X  VALUE  '4'.
  1249   02  DFHPF5    PIC  X  VALUE  '5'.
  1250   02  DFHPF6    PIC  X  VALUE  '6'.
  1251   02  DFHPF7    PIC  X  VALUE  '7'.
  1252   02  DFHPF8    PIC  X  VALUE  '8'.
  1253   02  DFHPF9    PIC  X  VALUE  '9'.
  1254   02  DFHPF10   PIC  X  VALUE  ':'.
  1255   02  DFHPF11   PIC  X  VALUE  '#'.
  1256   02  DFHPF12   PIC  X  VALUE  '@'.
  1257   02  DFHPF13   PIC  X  VALUE  'A'.
  1258   02  DFHPF14   PIC  X  VALUE  'B'.
  1259   02  DFHPF15   PIC  X  VALUE  'C'.
  1260   02  DFHPF16   PIC  X  VALUE  'D'.
  1261   02  DFHPF17   PIC  X  VALUE  'E'.
  1262   02  DFHPF18   PIC  X  VALUE  'F'.
  1263   02  DFHPF19   PIC  X  VALUE  'G'.
  1264   02  DFHPF20   PIC  X  VALUE  'H'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL613.cbl
  1265   02  DFHPF21   PIC  X  VALUE  'I'.
  1266*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1267   02  DFHPF22   PIC  X  VALUE  '['.
  1268   02  DFHPF23   PIC  X  VALUE  '.'.
  1269   02  DFHPF24   PIC  X  VALUE  '<'.
  1270   02  DFHMSRE   PIC  X  VALUE  'X'.
  1271   02  DFHSTRF   PIC  X  VALUE  'h'.
  1272   02  DFHTRIG   PIC  X  VALUE  '"'.
  1273 01  FILLER    REDEFINES DFHAID.
  1274     05  FILLER                      PIC X(8).
  1275     05  PF-VALUES                   PIC X
  1276         OCCURS 24 TIMES.
  1277****************************************************************
  1278*
  1279* Copyright (c) 2007 by Clerity Solutions, Inc.
  1280* All rights reserved.
  1281*
  1282****************************************************************
  1283 01  DFHEIV.
  1284   02  DFHEIV0               PIC X(35).
  1285   02  DFHEIV1               PIC X(08).
  1286   02  DFHEIV2               PIC X(08).
  1287   02  DFHEIV3               PIC X(08).
  1288   02  DFHEIV4               PIC X(06).
  1289   02  DFHEIV5               PIC X(04).
  1290   02  DFHEIV6               PIC X(04).
  1291   02  DFHEIV7               PIC X(02).
  1292   02  DFHEIV8               PIC X(02).
  1293   02  DFHEIV9               PIC X(01).
  1294   02  DFHEIV10              PIC S9(7) COMP-3.
  1295   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1296   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1297   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1298   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1299   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1300   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1301   02  DFHEIV17              PIC X(04).
  1302   02  DFHEIV18              PIC X(04).
  1303   02  DFHEIV19              PIC X(04).
  1304   02  DFHEIV20              USAGE IS POINTER.
  1305   02  DFHEIV21              USAGE IS POINTER.
  1306   02  DFHEIV22              USAGE IS POINTER.
  1307   02  DFHEIV23              USAGE IS POINTER.
  1308   02  DFHEIV24              USAGE IS POINTER.
  1309   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1310   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1311   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1312   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1313   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1314   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1315   02  FILLER                PIC X(02).
  1316   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1317   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1318   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1319   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1320   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1321 LINKAGE  SECTION.
  1322*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL613.cbl
  1323*                                                               *
  1324* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1325* All rights reserved.                                          *
  1326*                                                               *
  1327*****************************************************************
  1328 01  dfheiblk.
  1329     02  eibtime          pic s9(7) comp-3.
  1330     02  eibdate          pic s9(7) comp-3.
  1331     02  eibtrnid         pic x(4).
  1332     02  eibtaskn         pic s9(7) comp-3.
  1333     02  eibtrmid         pic x(4).
  1334     02  dfheigdi         pic s9(4) comp.
  1335     02  eibcposn         pic s9(4) comp.
  1336     02  eibcalen         pic s9(4) comp.
  1337     02  eibaid           pic x(1).
  1338     02  eibfiller1       pic x(1).
  1339     02  eibfn            pic x(2).
  1340     02  eibfiller2       pic x(2).
  1341     02  eibrcode         pic x(6).
  1342     02  eibfiller3       pic x(2).
  1343     02  eibds            pic x(8).
  1344     02  eibreqid         pic x(8).
  1345     02  eibrsrce         pic x(8).
  1346     02  eibsync          pic x(1).
  1347     02  eibfree          pic x(1).
  1348     02  eibrecv          pic x(1).
  1349     02  eibsend          pic x(1).
  1350     02  eibatt           pic x(1).
  1351     02  eibeoc           pic x(1).
  1352     02  eibfmh           pic x(1).
  1353     02  eibcompl         pic x(1).
  1354     02  eibsig           pic x(1).
  1355     02  eibconf          pic x(1).
  1356     02  eiberr           pic x(1).
  1357     02  eibrldbk         pic x(1).
  1358     02  eiberrcd         pic x(4).
  1359     02  eibsynrb         pic x(1).
  1360     02  eibnodat         pic x(1).
  1361     02  eibfiller5       pic x(2).
  1362     02  eibresp          pic 9(09) comp.
  1363     02  eibresp2         pic 9(09) comp.
  1364     02  dfheigdj         pic s9(4) comp.
  1365     02  dfheigdk         pic s9(4) comp.
  1366 01  DFHCOMMAREA                     PIC X(1024).
  1367*    COPY ELCDENY.
  1368******************************************************************
  1369*                                                                *
  1370*                                                                *
  1371*                            ELCDENY                             *
  1372*                            VMOD=2.001                          *
  1373*                                                                *
  1374*   CLAIM SYSTEM DENIAL/RECESSION/REFORMATION TABLE              *
  1375*                                                                *
  1376*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1377*   VSAM DENIAL TABLE                                            *
  1378*                                                                *
  1379*   FILE DESCRIPTION = DENIAL CODE TABLE                         *
  1380*                                                                *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL613.cbl
  1381*   FILE TYPE = VSAM,KSDS                                        *
  1382*   RECORD SIZE = 125   RECFORM = FIX                            *
  1383*                                                                *
  1384*   BASE CLUSTER NAME = ELCDENY                   RKP=2,LEN=15   *
  1385*       ALTERNATE PATH1 = ELDENY2 (ALT GROUPING) RKP=17,LEN=16   *
  1386*                                                                *
  1387*   LOG = NO                                                     *
  1388*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1389*                                                                *
  1390*                                                                *
  1391******************************************************************
  1392*                   C H A N G E   L O G
  1393*
  1394* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1395*-----------------------------------------------------------------
  1396*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1397* EFFECTIVE    NUMBER
  1398*-----------------------------------------------------------------
  1399* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  1400******************************************************************
  1401 01  DENIAL-CODES.
  1402     12  DN-RECORD-ID                      PIC XX.
  1403         88  VALID-DN-ID                      VALUE 'DN'.
  1404     12  DN-CONTROL-PRIMARY.
  1405         16  DN-COMPANY-CD                 PIC X.
  1406         16  DN-DENIAL-CODE                PIC X(4).
  1407         16  FILLER                        PIC X(10).
  1408     12  DN-CONTROL-BY-TYPE.
  1409         16  DN-COMPANY-CD-A1              PIC X.
  1410         16  DN-RECORD-TYPE                PIC X.
  1411         16  DN-DENIAL-CODE-A1             PIC X(4).
  1412         16  FILLER                        PIC X(10).
  1413     12  DN-MAINT-INFORMATION.
  1414         16  DN-LAST-MAINT-DT              PIC XX.
  1415         16  DN-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1416         16  DN-LAST-MAINT-USER            PIC X(4).
  1417         16  FILLER                        PIC XX.
  1418     12  DN-DESCRIPTION                    PIC X(50).
  1419     12  FILLER                            PIC X(30).
  1420******************************************************************
  1421 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA DENIAL-CODES.
  1422 0000-DFHEXIT SECTION.
  1423     MOVE '9#                    $   ' TO DFHEIV0.
  1424     MOVE 'EL613' TO DFHEIV1.
  1425     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1426     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1427     MOVE '5'                   TO DC-OPTION-CODE.
  1428     PERFORM 8500-DATE-CONVERSION
  1429                                THRU 8500-EXIT
  1430     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1431     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1432     MOVE DFHCOMMAREA           TO  PROGRAM-INTERFACE-BLOCK.
  1433     MOVE +2                    TO  EMI-NUMBER-OF-LINES
  1434                                    EMI-SWITCH2.
  1435     IF EIBCALEN NOT > ZERO
  1436        MOVE UNACCESS-MSG        TO LOGOFF-MSG
  1437        GO TO 8300-SEND-TEXT
  1438     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL613.cbl
  1439
  1440* EXEC CICS HANDLE CONDITION
  1441*        PGMIDERR (9600-PGMIDERR)
  1442*        ERROR    (9990-ERROR)
  1443*    END-EXEC
  1444*    MOVE '"$L.                  ! " #00001435' TO DFHEIV0
  1445     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1446     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1447     MOVE X'2220233030303031343335' TO DFHEIV0(25:11)
  1448     CALL 'kxdfhei1' USING DFHEIV0
  1449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1450     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1451        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1452           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1453           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1454           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1455           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1456           MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1457           MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1458           MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1459           MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  1460        ELSE
  1461           MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  1462           MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  1463           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  1464           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  1465           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  1466           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  1467           MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  1468           MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  1469        END-IF
  1470     END-IF
  1471     IF EIBTRNID NOT = WS-TRANS-ID
  1472        GO TO 1000-INITIAL-SCREEN
  1473     END-IF
  1474     IF EIBAID = DFHCLEAR
  1475        GO TO 9400-CLEAR
  1476     END-IF
  1477
  1478* EXEC CICS READQ TS
  1479*        QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  1480*        INTO   (SECURITY-CONTROL)
  1481*        LENGTH (SC-COMM-LENGTH)
  1482*        ITEM   (SC-ITEM)
  1483*    END-EXEC
  1484*    MOVE '*$II   L              ''   #00001466' TO DFHEIV0
  1485     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1486     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1487     MOVE X'2020233030303031343636' TO DFHEIV0(25:11)
  1488     CALL 'kxdfhei1' USING DFHEIV0,
  1489           PI-SECURITY-TEMP-STORE-ID,
  1490           SECURITY-CONTROL,
  1491           SC-COMM-LENGTH,
  1492           SC-ITEM,
  1493           DFHEIV99,
  1494           DFHEIV99
  1495     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1496     MOVE SC-CLAIMS-DISPLAY (29) TO PI-DISPLAY-CAP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL613.cbl
  1497     MOVE SC-CLAIMS-UPDATE  (29) TO PI-MODIFY-CAP
  1498     IF NOT DISPLAY-CAP
  1499        MOVE 'READ'              TO SM-READ
  1500        PERFORM 9995-SECURITY-VIOLATION
  1501        MOVE ER-0070             TO EMI-ERROR
  1502        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1503        GO TO 8100-SEND-INITIAL-MAP
  1504     END-IF
  1505     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1506        MOVE LOW-VALUES          TO EL613AO
  1507        MOVE -1                  TO APFKL
  1508        MOVE ER-0008             TO EMI-ERROR
  1509        GO TO 8200-SEND-DATAONLY
  1510     END-IF
  1511
  1512* EXEC CICS RECEIVE
  1513*        INTO   (EL613AO)
  1514*        MAPSET (WS-MAPSET-NAME)
  1515*        MAP    (WS-MAP-NAME)
  1516*    END-EXEC
  1517     MOVE LENGTH OF
  1518      EL613AO
  1519       TO DFHEIV11
  1520*    MOVE '8"T I  L              ''   #00001487' TO DFHEIV0
  1521     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1522     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1523     MOVE X'2020233030303031343837' TO DFHEIV0(25:11)
  1524     CALL 'kxdfhei1' USING DFHEIV0,
  1525           WS-MAP-NAME,
  1526           EL613AO,
  1527           DFHEIV11,
  1528           WS-MAPSET-NAME,
  1529           DFHEIV99,
  1530           DFHEIV99
  1531     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1532     IF APFKL > ZERO
  1533        IF EIBAID NOT = DFHENTER
  1534           MOVE ER-0004          TO EMI-ERROR
  1535           MOVE AL-UNBOF         TO APFKA
  1536           MOVE -1               TO APFKL
  1537           GO TO 8200-SEND-DATAONLY
  1538        ELSE
  1539           IF APFKO NUMERIC AND
  1540              (APFKO > ZERO AND LESS '25')
  1541              MOVE PF-VALUES (APFKI)
  1542                                 TO  EIBAID
  1543           ELSE
  1544              MOVE ER-0029       TO  EMI-ERROR
  1545              MOVE AL-UNBOF      TO  APFKA
  1546              MOVE -1            TO  APFKL
  1547              GO TO 8200-SEND-DATAONLY
  1548           END-IF
  1549        END-IF
  1550     END-IF
  1551     IF EIBAID = DFHPF12
  1552        MOVE 'EL010'             TO THIS-PGM
  1553        GO TO 9300-XCTL
  1554     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL613.cbl
  1555     IF EIBAID = DFHPF23
  1556        GO TO 9000-RETURN-CICS
  1557     END-IF
  1558     IF EIBAID = DFHPF24
  1559        IF CREDIT-SESSION
  1560           MOVE 'EL626'          TO THIS-PGM
  1561           GO TO 9300-XCTL
  1562        ELSE
  1563           MOVE 'EL126'          TO THIS-PGM
  1564           GO TO 9300-XCTL
  1565        END-IF
  1566     END-IF
  1567     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2
  1568        OR DFHPF3
  1569        CONTINUE
  1570     ELSE
  1571        MOVE ER-0008             TO EMI-ERROR
  1572        MOVE -1                  TO APFKL
  1573        GO TO 8200-SEND-DATAONLY
  1574     END-IF
  1575     IF AMAINTL > ZERO
  1576        IF AMAINTI = 'A' OR 'C' OR 'D' OR 'S'
  1577           MOVE AL-UANON         TO AMAINTA
  1578           MOVE AMAINTI          TO PI-MODE
  1579        ELSE
  1580           MOVE AL-UABOF         TO AMAINTA
  1581           MOVE -1               TO AMAINTL
  1582           MOVE ER-0023          TO EMI-ERROR
  1583           PERFORM 9900-ERROR-FORMAT
  1584        END-IF
  1585     ELSE
  1586        IF EIBAID = DFHPF1 OR DFHPF2 OR DFHPF3
  1587           MOVE 'S'              TO PI-MODE
  1588        ELSE
  1589           MOVE AL-UABOF         TO AMAINTA
  1590           MOVE -1               TO AMAINTL
  1591           MOVE ER-0023          TO EMI-ERROR
  1592           PERFORM 9900-ERROR-FORMAT
  1593        END-IF
  1594     END-IF
  1595     IF MODIFY-CAP
  1596        CONTINUE
  1597     ELSE
  1598        IF AMAINTI = 'A' OR 'C' OR 'D'
  1599           MOVE 'UPDATE'         TO SM-READ
  1600           PERFORM 9995-SECURITY-VIOLATION
  1601           MOVE ER-0070          TO EMI-ERROR
  1602           MOVE -1               TO  AMAINTL
  1603           MOVE AL-UABON         TO  AMAINTA
  1604           GO TO 8200-SEND-DATAONLY
  1605        END-IF
  1606     END-IF
  1607     IF EMI-FATAL-CTR > ZERO
  1608        GO TO 8200-SEND-DATAONLY
  1609     END-IF
  1610     IF PI-MODE EQUAL 'S'
  1611        GO TO 2000-PROCESS-SHOW
  1612     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL613.cbl
  1613     IF PI-MODE EQUAL 'C'
  1614        GO TO 3000-PROCESS-CHANGE
  1615     END-IF
  1616     IF PI-MODE EQUAL 'A'
  1617        GO TO 5000-PROCESS-ADD
  1618     END-IF
  1619     IF PI-MODE EQUAL 'D'
  1620        GO TO 6000-PROCESS-DELETE
  1621     END-IF
  1622     MOVE 'LOGIC ERROR HAS OCCURRED - PROGRAM EL613'
  1623                                 TO  LOGOFF-MSG.
  1624     GO TO 8300-SEND-TEXT.
  1625     .
  1626 1000-INITIAL-SCREEN.
  1627     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA
  1628     MOVE PI-COMPANY-CD          TO PI-DN-TOP-KEY (1:1)
  1629                                    PI-DN-BOT-KEY (1:1)
  1630     MOVE ZERO                   TO PI-1ST-TIME-SW
  1631                                    PI-LINE-COUNT
  1632                                    PI-BROWSE-SW
  1633                                    PI-SHOW-SW
  1634                                    PI-CHANGE-SW
  1635     SET PI-BASE-FILE            TO TRUE
  1636     MOVE LOW-VALUES             TO EL613AO
  1637     MOVE -1                     TO AMAINTL
  1638     MOVE +2                     TO WS-COMPLETED-SUCCESSFUL
  1639     GO TO 8100-SEND-INITIAL-MAP
  1640     .
  1641 2000-PROCESS-SHOW.
  1642*IF THE USER PRIMED THE FIRST DENIALCODE THEN USE IT TO BROWSE
  1643     IF RCODEL (1) > +0
  1644        MOVE RCODEI (1)          TO PI-DN-BOT-KEY (2:4)
  1645                                    PI-DN-TOP-KEY (2:4)
  1646     END-IF
  1647     EVALUATE TRUE
  1648        WHEN EIBAID = DFHPF2
  1649           MOVE PI-DN-TOP-KEY    TO WS-ELDENY-KEY
  1650                                    WS-ELDENY2-KEY
  1651           GO TO 8000-BROWSE-BWD
  1652        WHEN EIBAID = DFHPF1
  1653           MOVE PI-DN-BOT-KEY    TO WS-ELDENY-KEY
  1654                                    WS-ELDENY2-KEY
  1655           GO TO 7000-BROWSE-FWD
  1656        WHEN (EIBAID = DFHPF3) AND (PI-ALT-FILE)
  1657           SET PI-BASE-FILE      TO TRUE
  1658           MOVE LOW-VALUES       TO WS-ELDENY-KEY
  1659           MOVE PI-COMPANY-CD    TO WS-COMPANY-CD
  1660           GO TO 7000-BROWSE-FWD
  1661        WHEN EIBAID = DFHPF3
  1662           SET PI-ALT-FILE       TO TRUE
  1663           MOVE LOW-VALUES       TO WS-ELDENY2-KEY
  1664           MOVE PI-COMPANY-CD    TO WS-COMPANY-CD-A1
  1665           GO TO 7000-BROWSE-FWD
  1666        WHEN OTHER
  1667           MOVE PI-COMPANY-CD    TO WS-ELDENY-KEY
  1668           GO TO 7000-BROWSE-FWD
  1669     END-EVALUATE
  1670     MOVE +1                     TO  PI-SHOW-SW
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL613.cbl
  1671     GO TO 7000-BROWSE-FWD
  1672     .
  1673*****************************************************************
  1674 3000-PROCESS-CHANGE.
  1675*****************************************************************
  1676     SET M1                      TO +1
  1677     PERFORM UNTIL
  1678        M1 > +10
  1679        IF (DESCL (M1) > +0)
  1680           OR (TYPEL (M1) > +0)
  1681           PERFORM 6010-EDIT-DATA
  1682                                 THRU 6010-EXIT
  1683        END-IF
  1684        SET M1                   UP BY +1
  1685     END-PERFORM
  1686     IF NOT EMI-NO-ERRORS
  1687        GO TO 8200-SEND-DATAONLY
  1688     END-IF
  1689     SET M1                      TO +1
  1690     PERFORM UNTIL
  1691        M1 > +10
  1692        IF (DESCL (M1) > +0)
  1693           OR (TYPEL (M1) > +0)
  1694           PERFORM 6030-UPDATE-RECORD
  1695                                 THRU 6030-EXIT
  1696        END-IF
  1697        SET M1                   UP BY +1
  1698     END-PERFORM
  1699     MOVE PI-DN-TOP-KEY          TO WS-ELDENY-KEY
  1700     GO TO 7000-BROWSE-FWD
  1701     .
  1702*****************************************************************
  1703 5000-PROCESS-ADD.
  1704*****************************************************************
  1705     SET M1                      TO +1
  1706     PERFORM UNTIL
  1707        M1 > +10
  1708        IF (RCODEL    (M1) > +0)
  1709           PERFORM 6020-EDIT-KEY-DATA
  1710                                 THRU 6020-EXIT
  1711           PERFORM 6010-EDIT-DATA
  1712                                 THRU 6010-EXIT
  1713        END-IF
  1714        SET M1                   UP BY +1
  1715     END-PERFORM
  1716     IF NOT EMI-NO-ERRORS
  1717        GO TO 8200-SEND-DATAONLY
  1718     END-IF
  1719     SET M1                      TO +1
  1720     PERFORM UNTIL
  1721        M1 > +10
  1722        IF RCODEL (M1) > +0
  1723           PERFORM 6060-ADD-RECORD
  1724                                 THRU 6060-EXIT
  1725        END-IF
  1726        SET M1                   UP BY +1
  1727        ADD +1                   TO CI1
  1728     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL613.cbl
  1729     SET M1                      TO +1
  1730     MOVE +1                     TO CI1
  1731     MOVE PI-DN-TOP-KEY          TO WS-ELDENY-KEY
  1732     GO TO 7000-BROWSE-FWD
  1733     .
  1734*****************************************************************
  1735 6000-PROCESS-DELETE.
  1736*****************************************************************
  1737     SET M1                      TO +1
  1738** THE WAY THIS WORKS IS YOU HAVE TO SPACE OUT THE RATE  CODE
  1739** FOR THE DELETE TO WORK
  1740     PERFORM UNTIL
  1741        M1 > +10
  1742        IF ((RCODEL   (M1) > +0)
  1743           AND(RCODEI (M1) = SPACES))
  1744           PERFORM 6050-DELETE-RECORD
  1745                                 THRU 6050-EXIT
  1746        END-IF
  1747        SET M1                   UP BY +1
  1748     END-PERFORM
  1749     MOVE PI-DN-TOP-KEY          TO WS-ELDENY-KEY
  1750     GO TO 7000-BROWSE-FWD
  1751     .
  1752 6010-EDIT-DATA.
  1753     IF TYPEL (M1) > +0
  1754        IF TYPEI (M1) = '1' OR '2' OR '3'
  1755           CONTINUE
  1756        ELSE
  1757           MOVE ER-3841          TO EMI-ERROR
  1758           PERFORM 9900-ERROR-FORMAT
  1759           MOVE AL-UABON         TO TYPEA (M1)
  1760           MOVE -1               TO TYPEL (M1)
  1761        END-IF
  1762     END-IF
  1763     IF (PI-MODE = 'A')
  1764        IF (DESCL (M1) > +0)
  1765           AND (DESCI (M1) NOT = SPACES)
  1766           CONTINUE
  1767        ELSE
  1768           MOVE ER-3842          TO EMI-ERROR
  1769           PERFORM 9900-ERROR-FORMAT
  1770           MOVE AL-UABON         TO DESCA (M1)
  1771           MOVE -1               TO DESCL (M1)
  1772        END-IF
  1773     END-IF
  1774     .
  1775 6010-EXIT.
  1776     EXIT.
  1777 6020-EDIT-KEY-DATA.
  1778     IF (RCODEL (M1) > +0)
  1779        CONTINUE
  1780     ELSE
  1781        MOVE ER-3840          TO EMI-ERROR
  1782        PERFORM 9900-ERROR-FORMAT
  1783        MOVE AL-UABON            TO RCODEA (M1)
  1784        MOVE -1                  TO RCODEL (M1)
  1785        GO TO 6020-EXIT
  1786     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL613.cbl
  1787     IF (TYPEL (M1) > +0)
  1788        CONTINUE
  1789     ELSE
  1790        MOVE ER-3841          TO EMI-ERROR
  1791        PERFORM 9900-ERROR-FORMAT
  1792        MOVE AL-UABON            TO TYPEA (M1)
  1793        MOVE -1                  TO TYPEL (M1)
  1794        GO TO 6020-EXIT
  1795     END-IF
  1796     .
  1797 6020-EXIT.
  1798     EXIT.
  1799 6030-UPDATE-RECORD.
  1800     SET CI1                     TO M1
  1801     MOVE PI-DN-KEY (CI1)        TO WS-ELDENY-KEY
  1802
  1803* EXEC CICS READ
  1804*       UPDATE
  1805*       DATASET ('ELDENY')
  1806*       SET     (ADDRESS OF DENIAL-CODES)
  1807*       RIDFLD  (WS-ELDENY-KEY)
  1808*       RESP    (WS-RESPONSE)
  1809*    END-EXEC
  1810     MOVE 'ELDENY' TO DFHEIV1
  1811*    MOVE '&"S        EU         (  N#00001762' TO DFHEIV0
  1812     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1813     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1814     MOVE X'204E233030303031373632' TO DFHEIV0(25:11)
  1815     CALL 'kxdfhei1' USING DFHEIV0,
  1816           DFHEIV1,
  1817           DFHEIV20,
  1818           DFHEIV99,
  1819           WS-ELDENY-KEY,
  1820           DFHEIV99,
  1821           DFHEIV99,
  1822           DFHEIV99
  1823     SET ADDRESS OF DENIAL-CODES TO
  1824         DFHEIV20
  1825     MOVE EIBRESP  TO WS-RESPONSE
  1826     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1827     IF NOT RESP-NORMAL
  1828        GO TO 6030-UPDATE-ERROR
  1829     END-IF
  1830     IF DESCL (M1) > +0
  1831        MOVE DESCI (M1)          TO DN-DESCRIPTION
  1832     END-IF
  1833     IF TYPEL (M1) > +0
  1834        MOVE TYPEI (M1)          TO DN-RECORD-TYPE
  1835     END-IF
  1836     MOVE PI-PROCESSOR-ID        TO DN-LAST-MAINT-USER
  1837     MOVE EIBTIME                TO DN-LAST-MAINT-HHMMSS
  1838     MOVE SAVE-BIN-DATE          TO DN-LAST-MAINT-DT
  1839     IF DN-RECORD-ID NOT = 'DN'
  1840        MOVE 'DN'                TO DN-RECORD-ID
  1841     END-IF
  1842
  1843* EXEC CICS REWRITE
  1844*       DATASET    ('ELDENY')
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL613.cbl
  1845*       FROM       (DENIAL-CODES)
  1846*       RESP       (WS-RESPONSE)
  1847*    END-EXEC
  1848     MOVE LENGTH OF
  1849      DENIAL-CODES
  1850       TO DFHEIV11
  1851     MOVE 'ELDENY' TO DFHEIV1
  1852*    MOVE '&& L                  %  N#00001784' TO DFHEIV0
  1853     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  1854     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  1855     MOVE X'204E233030303031373834' TO DFHEIV0(25:11)
  1856     CALL 'kxdfhei1' USING DFHEIV0,
  1857           DFHEIV1,
  1858           DENIAL-CODES,
  1859           DFHEIV11,
  1860           DFHEIV99
  1861     MOVE EIBRESP  TO WS-RESPONSE
  1862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1863     IF RESP-NORMAL
  1864        GO TO 6030-EXIT
  1865     END-IF
  1866     .
  1867 6030-UPDATE-ERROR.
  1868     MOVE ER-3807                TO EMI-ERROR
  1869     PERFORM 9900-ERROR-FORMAT
  1870     MOVE AL-UABON               TO RCODEA (M1)
  1871     MOVE -1                     TO RCODEL (M1)
  1872     GO TO 8200-SEND-DATAONLY
  1873     .
  1874 6030-EXIT.
  1875     EXIT.
  1876 6050-DELETE-RECORD.
  1877     SET CI1                     TO M1
  1878     MOVE PI-DN-KEY (CI1)        TO WS-ELDENY-KEY
  1879
  1880* EXEC CICS READ
  1881*       UPDATE
  1882*       DATASET ('ELDENY')
  1883*       SET     (ADDRESS OF DENIAL-CODES)
  1884*       RIDFLD  (WS-ELDENY-KEY)
  1885*       RESP    (WS-RESPONSE)
  1886*    END-EXEC
  1887     MOVE 'ELDENY' TO DFHEIV1
  1888*    MOVE '&"S        EU         (  N#00001805' TO DFHEIV0
  1889     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1890     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  1891     MOVE X'204E233030303031383035' TO DFHEIV0(25:11)
  1892     CALL 'kxdfhei1' USING DFHEIV0,
  1893           DFHEIV1,
  1894           DFHEIV20,
  1895           DFHEIV99,
  1896           WS-ELDENY-KEY,
  1897           DFHEIV99,
  1898           DFHEIV99,
  1899           DFHEIV99
  1900     SET ADDRESS OF DENIAL-CODES TO
  1901         DFHEIV20
  1902     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL613.cbl
  1903     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1904     IF NOT RESP-NORMAL
  1905        GO TO 6050-DELETE-ERROR
  1906     END-IF
  1907
  1908* EXEC CICS DELETE
  1909*       DATASET ('ELDENY')
  1910*       RESP    (WS-RESPONSE)
  1911*    END-EXEC
  1912     MOVE 'ELDENY' TO DFHEIV1
  1913*    MOVE '&(                    &  N#00001815' TO DFHEIV0
  1914     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  1915     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1916     MOVE X'204E233030303031383135' TO DFHEIV0(25:11)
  1917     CALL 'kxdfhei1' USING DFHEIV0,
  1918           DFHEIV1,
  1919           DFHEIV99,
  1920           DFHEIV99,
  1921           DFHEIV99,
  1922           DFHEIV99
  1923     MOVE EIBRESP  TO WS-RESPONSE
  1924     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1925     IF RESP-NORMAL
  1926        GO TO 6050-EXIT
  1927     END-IF
  1928     .
  1929 6050-DELETE-ERROR.
  1930     MOVE ER-1079                TO EMI-ERROR
  1931     PERFORM 9900-ERROR-FORMAT
  1932     MOVE AL-UABON               TO RCODEA (M1)
  1933     MOVE -1                     TO RCODEL (M1)
  1934     .
  1935 6050-EXIT.
  1936     EXIT.
  1937 6060-ADD-RECORD.
  1938     SET CI1                     TO M1
  1939     MOVE LOW-VALUES             TO WS-ELDENY-KEY
  1940     MOVE PI-COMPANY-CD          TO WS-COMPANY-CD
  1941     MOVE RCODEI (M1)            TO WS-DENIAL-CODE
  1942
  1943* EXEC CICS READ
  1944*       DATASET ('ELDENY')
  1945*       SET     (ADDRESS OF DENIAL-CODES)
  1946*       RIDFLD  (WS-ELDENY-KEY)
  1947*       RESP    (WS-RESPONSE)
  1948*    END-EXEC
  1949     MOVE 'ELDENY' TO DFHEIV1
  1950*    MOVE '&"S        E          (  N#00001836' TO DFHEIV0
  1951     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1952     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1953     MOVE X'204E233030303031383336' TO DFHEIV0(25:11)
  1954     CALL 'kxdfhei1' USING DFHEIV0,
  1955           DFHEIV1,
  1956           DFHEIV20,
  1957           DFHEIV99,
  1958           WS-ELDENY-KEY,
  1959           DFHEIV99,
  1960           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL613.cbl
  1961           DFHEIV99
  1962     SET ADDRESS OF DENIAL-CODES TO
  1963         DFHEIV20
  1964     MOVE EIBRESP  TO WS-RESPONSE
  1965     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1966     IF RESP-NORMAL
  1967        GO TO 6060-ADD-ERROR
  1968     END-IF
  1969
  1970* EXEC CICS GETMAIN
  1971*       LENGTH   (ELDENY-LENGTH)
  1972*       SET      (ADDRESS OF DENIAL-CODES)
  1973*       INITIMG  (GETMAIN-SPACE)
  1974*    END-EXEC
  1975*    MOVE ',"IL                  $   #00001845' TO DFHEIV0
  1976     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  1977     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1978     MOVE X'2020233030303031383435' TO DFHEIV0(25:11)
  1979     CALL 'kxdfhei1' USING DFHEIV0,
  1980           DFHEIV20,
  1981           ELDENY-LENGTH,
  1982           GETMAIN-SPACE
  1983     SET ADDRESS OF DENIAL-CODES TO
  1984         DFHEIV20
  1985     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1986     MOVE LOW-VALUES             TO DN-CONTROL-PRIMARY
  1987     MOVE PI-COMPANY-CD          TO DN-COMPANY-CD
  1988                                    DN-COMPANY-CD-A1
  1989     MOVE 'DN'                   TO DN-RECORD-ID
  1990     MOVE RCODEI (M1)            TO DN-DENIAL-CODE
  1991                                    DN-DENIAL-CODE-A1
  1992     IF DESCL (M1) > +0
  1993        MOVE DESCI (M1)          TO DN-DESCRIPTION
  1994     END-IF
  1995     MOVE TYPEI  (M1)            TO DN-RECORD-TYPE
  1996     MOVE PI-PROCESSOR-ID        TO DN-LAST-MAINT-USER
  1997     MOVE EIBTIME                TO DN-LAST-MAINT-HHMMSS
  1998     MOVE SAVE-BIN-DATE          TO DN-LAST-MAINT-DT
  1999
  2000* EXEC CICS WRITE
  2001*       DATASET    ('ELDENY')
  2002*       FROM       (DENIAL-CODES)
  2003*       RIDFLD     (DN-CONTROL-PRIMARY)
  2004*       RESP       (WS-RESPONSE)
  2005*    END-EXEC
  2006     MOVE LENGTH OF
  2007      DENIAL-CODES
  2008       TO DFHEIV11
  2009     MOVE 'ELDENY' TO DFHEIV1
  2010*    MOVE '&$ L                  ''  N#00001863' TO DFHEIV0
  2011     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2012     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2013     MOVE X'204E233030303031383633' TO DFHEIV0(25:11)
  2014     CALL 'kxdfhei1' USING DFHEIV0,
  2015           DFHEIV1,
  2016           DENIAL-CODES,
  2017           DFHEIV11,
  2018           DN-CONTROL-PRIMARY,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL613.cbl
  2019           DFHEIV99,
  2020           DFHEIV99
  2021     MOVE EIBRESP  TO WS-RESPONSE
  2022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2023     IF RESP-NORMAL
  2024        GO TO 6060-EXIT
  2025     END-IF
  2026     .
  2027 6060-ADD-ERROR.
  2028     MOVE ER-3806                TO EMI-ERROR
  2029     PERFORM 9900-ERROR-FORMAT
  2030     MOVE AL-UABON               TO RCODEA (M1)
  2031     MOVE -1                     TO RCODEL (M1)
  2032     .
  2033 6060-EXIT.
  2034     EXIT.
  2035 7000-BROWSE-FWD.
  2036     SET M1  TO +1
  2037     IF PI-ALT-FILE
  2038
  2039* EXEC CICS STARTBR
  2040*           DATASET   ('ELDENY2')
  2041*           RIDFLD    (WS-ELDENY2-KEY)
  2042*           GTEQ
  2043*           RESP      (WS-RESPONSE)
  2044*       END-EXEC
  2045     MOVE 'ELDENY2' TO DFHEIV1
  2046     MOVE 0
  2047       TO DFHEIV11
  2048*    MOVE '&,         G          &  N#00001884' TO DFHEIV0
  2049     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2050     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2051     MOVE X'204E233030303031383834' TO DFHEIV0(25:11)
  2052     CALL 'kxdfhei1' USING DFHEIV0,
  2053           DFHEIV1,
  2054           WS-ELDENY2-KEY,
  2055           DFHEIV99,
  2056           DFHEIV11,
  2057           DFHEIV99
  2058     MOVE EIBRESP  TO WS-RESPONSE
  2059     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2060     ELSE
  2061
  2062* EXEC CICS STARTBR
  2063*           DATASET   ('ELDENY')
  2064*           RIDFLD    (WS-ELDENY-KEY)
  2065*           GTEQ
  2066*           RESP      (WS-RESPONSE)
  2067*       END-EXEC
  2068     MOVE 'ELDENY' TO DFHEIV1
  2069     MOVE 0
  2070       TO DFHEIV11
  2071*    MOVE '&,         G          &  N#00001891' TO DFHEIV0
  2072     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2073     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2074     MOVE X'204E233030303031383931' TO DFHEIV0(25:11)
  2075     CALL 'kxdfhei1' USING DFHEIV0,
  2076           DFHEIV1,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL613.cbl
  2077           WS-ELDENY-KEY,
  2078           DFHEIV99,
  2079           DFHEIV11,
  2080           DFHEIV99
  2081     MOVE EIBRESP  TO WS-RESPONSE
  2082     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2083     END-IF
  2084     EVALUATE TRUE
  2085        WHEN RESP-ENDFILE
  2086           GO TO 7030-END-FILE
  2087        WHEN RESP-NORMAL
  2088           CONTINUE
  2089        WHEN RESP-NOTFND
  2090           GO TO 7040-NOT-FOUND
  2091     END-EVALUATE
  2092     MOVE LOW-VALUES             TO EL613AO
  2093     MOVE ZERO                   TO PI-LINE-COUNT
  2094     MOVE +1                     TO PI-BROWSE-SW
  2095     MOVE +0                     TO CI1
  2096     .
  2097 7010-READ-NEXT.
  2098     IF PI-ALT-FILE
  2099
  2100* EXEC CICS READNEXT
  2101*           SET     (ADDRESS OF DENIAL-CODES)
  2102*           DATASET ('ELDENY2')
  2103*           RIDFLD  (WS-ELDENY2-KEY)
  2104*           RESP    (WS-RESPONSE)
  2105*       END-EXEC
  2106     MOVE 'ELDENY2' TO DFHEIV1
  2107     MOVE 0
  2108       TO DFHEIV11
  2109*    MOVE '&.S                   )  N#00001913' TO DFHEIV0
  2110     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2111     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2112     MOVE X'204E233030303031393133' TO DFHEIV0(25:11)
  2113     CALL 'kxdfhei1' USING DFHEIV0,
  2114           DFHEIV1,
  2115           DFHEIV20,
  2116           DFHEIV99,
  2117           WS-ELDENY2-KEY,
  2118           DFHEIV99,
  2119           DFHEIV11,
  2120           DFHEIV99,
  2121           DFHEIV99
  2122     SET ADDRESS OF DENIAL-CODES TO
  2123         DFHEIV20
  2124     MOVE EIBRESP  TO WS-RESPONSE
  2125     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2126     ELSE
  2127
  2128* EXEC CICS READNEXT
  2129*           SET     (ADDRESS OF DENIAL-CODES)
  2130*           DATASET ('ELDENY')
  2131*           RIDFLD  (WS-ELDENY-KEY)
  2132*           RESP    (WS-RESPONSE)
  2133*       END-EXEC
  2134     MOVE 'ELDENY' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL613.cbl
  2135     MOVE 0
  2136       TO DFHEIV11
  2137*    MOVE '&.S                   )  N#00001920' TO DFHEIV0
  2138     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2139     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2140     MOVE X'204E233030303031393230' TO DFHEIV0(25:11)
  2141     CALL 'kxdfhei1' USING DFHEIV0,
  2142           DFHEIV1,
  2143           DFHEIV20,
  2144           DFHEIV99,
  2145           WS-ELDENY-KEY,
  2146           DFHEIV99,
  2147           DFHEIV11,
  2148           DFHEIV99,
  2149           DFHEIV99
  2150     SET ADDRESS OF DENIAL-CODES TO
  2151         DFHEIV20
  2152     MOVE EIBRESP  TO WS-RESPONSE
  2153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2154     END-IF
  2155     EVALUATE TRUE
  2156        WHEN RESP-ENDFILE
  2157           GO TO 7030-END-FILE
  2158        WHEN PI-ALT-FILE
  2159           AND (PI-COMPANY-CD NOT = WS-COMPANY-CD-A1)
  2160           GO TO 7030-END-FILE
  2161        WHEN NOT PI-ALT-FILE
  2162           AND (PI-COMPANY-CD NOT = WS-COMPANY-CD)
  2163           GO TO 7030-END-FILE
  2164        WHEN RESP-NORMAL
  2165           CONTINUE
  2166        WHEN RESP-NOTFND
  2167           GO TO 7040-NOT-FOUND
  2168        WHEN DN-COMPANY-CD NOT = PI-COMPANY-CD
  2169           GO TO 7030-END-FILE
  2170     END-EVALUATE
  2171     ADD +1                      TO WS-RECORD-COUNT
  2172                                    CI1
  2173     IF PI-ALT-FILE
  2174        MOVE DN-CONTROL-BY-TYPE  TO PI-DN-BOT-KEY
  2175     ELSE
  2176        MOVE DN-CONTROL-PRIMARY  TO PI-DN-BOT-KEY
  2177     END-IF
  2178     MOVE DN-CONTROL-PRIMARY     TO PI-DN-KEY (CI1)
  2179     MOVE DN-DENIAL-CODE         TO RCODEO (M1)
  2180     MOVE DN-DESCRIPTION         TO DESCO (M1)
  2181     MOVE DN-RECORD-TYPE         TO TYPEO (M1)
  2182     IF M1 = +1
  2183        IF PI-ALT-FILE
  2184           MOVE DN-CONTROL-BY-TYPE
  2185                                 TO PI-DN-TOP-KEY
  2186        ELSE
  2187           MOVE DN-CONTROL-PRIMARY
  2188                                 TO PI-DN-TOP-KEY
  2189        END-IF
  2190     END-IF
  2191     IF M1 < +10
  2192        SET M1 UP BY +1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL613.cbl
  2193        GO TO 7010-READ-NEXT
  2194     END-IF
  2195     IF PI-BROWSE-SW = +1
  2196        IF PI-ALT-FILE
  2197
  2198* EXEC CICS ENDBR
  2199*             DATASET ('ELDENY2')
  2200*          END-EXEC
  2201     MOVE 'ELDENY2' TO DFHEIV1
  2202     MOVE 0
  2203       TO DFHEIV11
  2204*    MOVE '&2                    $   #00001969' TO DFHEIV0
  2205     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2206     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2207     MOVE X'2020233030303031393639' TO DFHEIV0(25:11)
  2208     CALL 'kxdfhei1' USING DFHEIV0,
  2209           DFHEIV1,
  2210           DFHEIV11,
  2211           DFHEIV99
  2212     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2213        ELSE
  2214
  2215* EXEC CICS ENDBR
  2216*             DATASET ('ELDENY')
  2217*          END-EXEC
  2218     MOVE 'ELDENY' TO DFHEIV1
  2219     MOVE 0
  2220       TO DFHEIV11
  2221*    MOVE '&2                    $   #00001973' TO DFHEIV0
  2222     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2223     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2224     MOVE X'2020233030303031393733' TO DFHEIV0(25:11)
  2225     CALL 'kxdfhei1' USING DFHEIV0,
  2226           DFHEIV1,
  2227           DFHEIV11,
  2228           DFHEIV99
  2229     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2230        END-IF
  2231        MOVE +0                  TO PI-BROWSE-SW
  2232     END-IF
  2233     MOVE ER-0000                TO EMI-ERROR
  2234     GO TO 8100-SEND-INITIAL-MAP
  2235     .
  2236 7030-END-FILE.
  2237     IF EMI-ERROR = ER-1257
  2238        MOVE ER-7220             TO  EMI-ERROR
  2239     ELSE
  2240        MOVE ER-1258             TO  EMI-ERROR
  2241     END-IF
  2242     MOVE -1                     TO  AMAINTL
  2243     MOVE AL-UABOF               TO  AMAINTA
  2244     GO TO 8100-SEND-INITIAL-MAP
  2245     .
  2246 7040-NOT-FOUND.
  2247     MOVE ER-0006                TO  EMI-ERROR
  2248     MOVE -1                     TO  AMAINTL
  2249     MOVE AL-UABOF               TO  AMAINTA
  2250     GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL613.cbl
  2251     .
  2252*****************************************************************
  2253 8000-BROWSE-BWD.
  2254*****************************************************************
  2255     SET M1                      TO +10
  2256     MOVE +11                    TO CI1
  2257     IF PI-ALT-FILE
  2258
  2259* EXEC CICS STARTBR
  2260*          DATASET ('ELDENY2')
  2261*          RIDFLD  (WS-ELDENY2-KEY)
  2262*          GTEQ
  2263*          RESP    (WS-RESPONSE)
  2264*       END-EXEC
  2265     MOVE 'ELDENY2' TO DFHEIV1
  2266     MOVE 0
  2267       TO DFHEIV11
  2268*    MOVE '&,         G          &  N#00002004' TO DFHEIV0
  2269     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2270     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2271     MOVE X'204E233030303032303034' TO DFHEIV0(25:11)
  2272     CALL 'kxdfhei1' USING DFHEIV0,
  2273           DFHEIV1,
  2274           WS-ELDENY2-KEY,
  2275           DFHEIV99,
  2276           DFHEIV11,
  2277           DFHEIV99
  2278     MOVE EIBRESP  TO WS-RESPONSE
  2279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2280     ELSE
  2281
  2282* EXEC CICS STARTBR
  2283*          DATASET ('ELDENY')
  2284*          RIDFLD  (WS-ELDENY-KEY)
  2285*          GTEQ
  2286*          RESP    (WS-RESPONSE)
  2287*       END-EXEC
  2288     MOVE 'ELDENY' TO DFHEIV1
  2289     MOVE 0
  2290       TO DFHEIV11
  2291*    MOVE '&,         G          &  N#00002011' TO DFHEIV0
  2292     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2293     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2294     MOVE X'204E233030303032303131' TO DFHEIV0(25:11)
  2295     CALL 'kxdfhei1' USING DFHEIV0,
  2296           DFHEIV1,
  2297           WS-ELDENY-KEY,
  2298           DFHEIV99,
  2299           DFHEIV11,
  2300           DFHEIV99
  2301     MOVE EIBRESP  TO WS-RESPONSE
  2302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2303     END-IF
  2304     EVALUATE TRUE
  2305        WHEN RESP-ENDFILE
  2306           GO TO 8020-END-FILE
  2307        WHEN RESP-NORMAL
  2308           CONTINUE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL613.cbl
  2309        WHEN RESP-NOTFND
  2310           GO TO 8030-NOT-FOUND
  2311     END-EVALUATE
  2312     MOVE LOW-VALUES             TO EL613AO
  2313     MOVE ZERO                   TO PI-LINE-COUNT
  2314     MOVE +1                     TO PI-BROWSE-SW
  2315     .
  2316 8010-READ-PREV.
  2317     IF PI-ALT-FILE
  2318
  2319* EXEC CICS READPREV
  2320*          SET     (ADDRESS OF DENIAL-CODES)
  2321*          DATASET ('ELDENY2')
  2322*          RIDFLD  (WS-ELDENY2-KEY)
  2323*          RESP    (WS-RESPONSE)
  2324*       END-EXEC
  2325     MOVE 'ELDENY2' TO DFHEIV1
  2326     MOVE 0
  2327       TO DFHEIV11
  2328*    MOVE '&0S                   )  N#00002032' TO DFHEIV0
  2329     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  2330     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2331     MOVE X'204E233030303032303332' TO DFHEIV0(25:11)
  2332     CALL 'kxdfhei1' USING DFHEIV0,
  2333           DFHEIV1,
  2334           DFHEIV20,
  2335           DFHEIV99,
  2336           WS-ELDENY2-KEY,
  2337           DFHEIV99,
  2338           DFHEIV11,
  2339           DFHEIV99,
  2340           DFHEIV99
  2341     SET ADDRESS OF DENIAL-CODES TO
  2342         DFHEIV20
  2343     MOVE EIBRESP  TO WS-RESPONSE
  2344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2345     ELSE
  2346
  2347* EXEC CICS READPREV
  2348*          SET     (ADDRESS OF DENIAL-CODES)
  2349*          DATASET ('ELDENY')
  2350*          RIDFLD  (WS-ELDENY-KEY)
  2351*          RESP    (WS-RESPONSE)
  2352*       END-EXEC
  2353     MOVE 'ELDENY' TO DFHEIV1
  2354     MOVE 0
  2355       TO DFHEIV11
  2356*    MOVE '&0S                   )  N#00002039' TO DFHEIV0
  2357     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  2358     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2359     MOVE X'204E233030303032303339' TO DFHEIV0(25:11)
  2360     CALL 'kxdfhei1' USING DFHEIV0,
  2361           DFHEIV1,
  2362           DFHEIV20,
  2363           DFHEIV99,
  2364           WS-ELDENY-KEY,
  2365           DFHEIV99,
  2366           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL613.cbl
  2367           DFHEIV99,
  2368           DFHEIV99
  2369     SET ADDRESS OF DENIAL-CODES TO
  2370         DFHEIV20
  2371     MOVE EIBRESP  TO WS-RESPONSE
  2372     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2373     END-IF
  2374     EVALUATE TRUE
  2375        WHEN RESP-ENDFILE
  2376           GO TO 8020-END-FILE
  2377        WHEN PI-ALT-FILE
  2378           AND (PI-COMPANY-CD NOT = WS-COMPANY-CD-A1)
  2379           GO TO 8020-END-FILE
  2380        WHEN NOT PI-ALT-FILE
  2381           AND (PI-COMPANY-CD NOT = WS-COMPANY-CD)
  2382           GO TO 8020-END-FILE
  2383        WHEN RESP-NORMAL
  2384           CONTINUE
  2385        WHEN RESP-NOTFND
  2386           GO TO 8030-NOT-FOUND
  2387     END-EVALUATE
  2388     IF DN-COMPANY-CD NOT = PI-COMPANY-CD
  2389        GO TO 8020-END-FILE
  2390     END-IF
  2391     ADD +1                      TO WS-RECORD-COUNT
  2392     SUBTRACT +1                 FROM CI1
  2393     IF PI-ALT-FILE
  2394        MOVE DN-CONTROL-BY-TYPE  TO PI-DN-TOP-KEY
  2395     ELSE
  2396        MOVE DN-CONTROL-PRIMARY  TO PI-DN-TOP-KEY
  2397     END-IF
  2398     MOVE DN-CONTROL-PRIMARY     TO PI-DN-KEY (CI1)
  2399     MOVE DN-DENIAL-CODE         TO RCODEO (M1)
  2400     MOVE DN-DESCRIPTION         TO DESCO  (M1)
  2401     MOVE DN-RECORD-TYPE         TO TYPEO  (M1)
  2402     IF M1 = +10
  2403        IF PI-ALT-FILE
  2404           MOVE DN-CONTROL-BY-TYPE
  2405                                 TO PI-DN-BOT-KEY
  2406        ELSE
  2407           MOVE DN-CONTROL-PRIMARY
  2408                                 TO PI-DN-BOT-KEY
  2409        END-IF
  2410     END-IF
  2411     IF M1 > +1
  2412        SET M1                   DOWN BY +1
  2413        GO TO 8010-READ-PREV
  2414     END-IF
  2415     IF PI-BROWSE-SW = +1
  2416        IF PI-ALT-FILE
  2417
  2418* EXEC CICS ENDBR
  2419*             DATASET ('ELDENY2')
  2420*          END-EXEC
  2421     MOVE 'ELDENY2' TO DFHEIV1
  2422     MOVE 0
  2423       TO DFHEIV11
  2424*    MOVE '&2                    $   #00002089' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL613.cbl
  2425     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2426     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2427     MOVE X'2020233030303032303839' TO DFHEIV0(25:11)
  2428     CALL 'kxdfhei1' USING DFHEIV0,
  2429           DFHEIV1,
  2430           DFHEIV11,
  2431           DFHEIV99
  2432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2433        ELSE
  2434
  2435* EXEC CICS ENDBR
  2436*             DATASET ('ELDENY')
  2437*          END-EXEC
  2438     MOVE 'ELDENY' TO DFHEIV1
  2439     MOVE 0
  2440       TO DFHEIV11
  2441*    MOVE '&2                    $   #00002093' TO DFHEIV0
  2442     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2443     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2444     MOVE X'2020233030303032303933' TO DFHEIV0(25:11)
  2445     CALL 'kxdfhei1' USING DFHEIV0,
  2446           DFHEIV1,
  2447           DFHEIV11,
  2448           DFHEIV99
  2449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2450        END-IF
  2451        MOVE +0                  TO PI-BROWSE-SW
  2452     END-IF
  2453     MOVE ER-0000                TO EMI-ERROR
  2454     GO TO 8100-SEND-INITIAL-MAP
  2455     .
  2456 8020-END-FILE.
  2457     IF M1 > +1
  2458        MOVE PI-DN-TOP-KEY       TO WS-ELDENY-KEY
  2459        MOVE ER-1257             TO EMI-ERROR
  2460        GO TO 7000-BROWSE-FWD
  2461     END-IF
  2462     MOVE ER-1257                TO EMI-ERROR
  2463     MOVE -1                     TO  AMAINTL
  2464     MOVE AL-UABOF               TO  AMAINTA
  2465     GO TO 8100-SEND-INITIAL-MAP
  2466     .
  2467 8030-NOT-FOUND.
  2468     MOVE ER-0006                TO  EMI-ERROR
  2469     MOVE -1                     TO  AMAINTL
  2470     MOVE AL-UABOF               TO  AMAINTA
  2471     GO TO 8200-SEND-DATAONLY
  2472     .
  2473*****************************************************************
  2474 8100-SEND-INITIAL-MAP.
  2475*****************************************************************
  2476     MOVE -1                     TO  AMAINTL.
  2477     MOVE ZERO                   TO  PI-BROWSE-SW.
  2478     MOVE SAVE-DATE              TO  ADATEO.
  2479     MOVE EIBTIME                TO  TIME-IN.
  2480     MOVE TIME-OUT               TO  ATIMEO.
  2481     IF PI-ALT-FILE
  2482        MOVE 'PF3=BRWSE BY CODE' TO F3KEYO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL613.cbl
  2483     END-IF
  2484     IF EMI-ERROR NOT = ZERO
  2485         PERFORM 9900-ERROR-FORMAT
  2486     END-IF
  2487     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSG1O.
  2488     MOVE EMI-MESSAGE-AREA (2)    TO  AEMSG2O.
  2489
  2490* EXEC CICS SEND
  2491*        FROM   (EL613AO)
  2492*        MAPSET (WS-MAPSET-NAME)
  2493*        MAP    (WS-MAP-NAME)
  2494*        CURSOR ERASE
  2495*    END-EXEC.
  2496     MOVE LENGTH OF
  2497      EL613AO
  2498       TO DFHEIV12
  2499     MOVE -1
  2500       TO DFHEIV11
  2501*    MOVE '8$     CT  E    H L F ,   #00002135' TO DFHEIV0
  2502     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2503     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2504     MOVE X'2020233030303032313335' TO DFHEIV0(25:11)
  2505     CALL 'kxdfhei1' USING DFHEIV0,
  2506           WS-MAP-NAME,
  2507           EL613AO,
  2508           DFHEIV12,
  2509           WS-MAPSET-NAME,
  2510           DFHEIV99,
  2511           DFHEIV99,
  2512           DFHEIV99,
  2513           DFHEIV11,
  2514           DFHEIV99,
  2515           DFHEIV99,
  2516           DFHEIV99
  2517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2518
  2519     GO TO 9100-RETURN-TRAN
  2520     .
  2521 8100-EXIT.
  2522      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL613.cbl
  2524*****************************************************************
  2525 8200-SEND-DATAONLY.
  2526*****************************************************************
  2527     MOVE SAVE-DATE              TO  ADATEO.
  2528     MOVE EIBTIME                TO  TIME-IN.
  2529     MOVE TIME-OUT               TO  ATIMEO.
  2530     IF EMI-ERROR NOT = ZERO
  2531         PERFORM 9900-ERROR-FORMAT.
  2532     IF PI-ALT-FILE
  2533        MOVE 'PF3=BRWSE BY CODE' TO F3KEYO
  2534     END-IF
  2535     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSG1O.
  2536     MOVE EMI-MESSAGE-AREA (2)    TO  AEMSG2O.
  2537
  2538* EXEC CICS SEND DATAONLY
  2539*        FROM   (EL613AO)
  2540*        MAPSET (WS-MAPSET-NAME)
  2541*        MAP    (WS-MAP-NAME)
  2542*        CURSOR
  2543*    END-EXEC.
  2544     MOVE LENGTH OF
  2545      EL613AO
  2546       TO DFHEIV12
  2547     MOVE -1
  2548       TO DFHEIV11
  2549*    MOVE '8$D    CT       H L F ,   #00002159' TO DFHEIV0
  2550     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2551     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2552     MOVE X'2020233030303032313539' TO DFHEIV0(25:11)
  2553     CALL 'kxdfhei1' USING DFHEIV0,
  2554           WS-MAP-NAME,
  2555           EL613AO,
  2556           DFHEIV12,
  2557           WS-MAPSET-NAME,
  2558           DFHEIV99,
  2559           DFHEIV99,
  2560           DFHEIV99,
  2561           DFHEIV11,
  2562           DFHEIV99,
  2563           DFHEIV99,
  2564           DFHEIV99
  2565     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2566
  2567     GO TO 9100-RETURN-TRAN
  2568     .
  2569 8200-EXIT.
  2570      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL613.cbl
  2572*****************************************************************
  2573 8300-SEND-TEXT.
  2574*****************************************************************
  2575
  2576* EXEC CICS SEND TEXT
  2577*        FROM   (LOGOFF-TEXT)
  2578*        LENGTH (LOGOFF-LENGTH)
  2579*        ERASE  FREEKB
  2580*    END-EXEC.
  2581*    MOVE '8&      T  E F  H   F -   #00002173' TO DFHEIV0
  2582     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2583     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2584     MOVE X'2020233030303032313733' TO DFHEIV0(25:11)
  2585     CALL 'kxdfhei1' USING DFHEIV0,
  2586           LOGOFF-TEXT,
  2587           LOGOFF-LENGTH,
  2588           DFHEIV99,
  2589           DFHEIV99,
  2590           DFHEIV99,
  2591           DFHEIV99,
  2592           DFHEIV99,
  2593           DFHEIV99,
  2594           DFHEIV99,
  2595           DFHEIV99,
  2596           DFHEIV99,
  2597           DFHEIV99
  2598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2599
  2600
  2601* EXEC CICS RETURN
  2602*    END-EXEC.
  2603*    MOVE '.(                    &   #00002178' TO DFHEIV0
  2604     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2605     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2606     MOVE X'2020233030303032313738' TO DFHEIV0(25:11)
  2607     CALL 'kxdfhei1' USING DFHEIV0,
  2608           DFHEIV99,
  2609           DFHEIV99,
  2610           DFHEIV99,
  2611           DFHEIV99,
  2612           DFHEIV99
  2613     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2614
  2615 8300-EXIT.
  2616      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL613.cbl
  2618*****************************************************************
  2619 8400-LOG-JOURNAL-RECORD.
  2620*****************************************************************
  2621     IF PI-JOURNAL-FILE-ID = 0
  2622         GO TO 8400-EXIT.
  2623     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  2624     MOVE 'ELCNTL'               TO  JP-FILE-ID.
  2625     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  2626*    EXEC CICS JOURNAL
  2627*        JFILEID (PI-JOURNAL-FILE-ID)
  2628*        JTYPEID (WS-JOURNAL-TYPE-ID)
  2629*        FROM    (JOURNAL-RECORD)
  2630*        LENGTH  (WS-JOURNAL-RECORD-LENGTH)
  2631*    END-EXEC.
  2632 8400-EXIT.
  2633      EXIT.
  2634*****************************************************************
  2635 8500-DATE-CONVERSION.
  2636*****************************************************************
  2637
  2638* EXEC CICS LINK
  2639*        PROGRAM  ('ELDATCV')
  2640*        COMMAREA (DATE-CONVERSION-DATA)
  2641*        LENGTH   (DC-COMM-LENGTH)
  2642*    END-EXEC.
  2643     MOVE 'ELDATCV' TO DFHEIV1
  2644*    MOVE '."C                   ''   #00002202' TO DFHEIV0
  2645     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2646     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2647     MOVE X'2020233030303032323032' TO DFHEIV0(25:11)
  2648     CALL 'kxdfhei1' USING DFHEIV0,
  2649           DFHEIV1,
  2650           DATE-CONVERSION-DATA,
  2651           DC-COMM-LENGTH,
  2652           DFHEIV99,
  2653           DFHEIV99,
  2654           DFHEIV99
  2655     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2656
  2657 8500-EXIT.
  2658      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL613.cbl
  2660*****************************************************************
  2661 9000-RETURN-CICS.
  2662*****************************************************************
  2663     MOVE 'EL005'                TO  THIS-PGM.
  2664     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2665     PERFORM 9300-XCTL.
  2666 9000-EXIT.
  2667      EXIT.
  2668*****************************************************************
  2669 9100-RETURN-TRAN.
  2670*****************************************************************
  2671     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  2672     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  2673
  2674* EXEC CICS RETURN
  2675*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2676*        LENGTH   (PI-COMM-LENGTH)
  2677*        TRANSID  (WS-TRANS-ID)
  2678*    END-EXEC.
  2679*    MOVE '.(CT                  &   #00002223' TO DFHEIV0
  2680     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2681     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2682     MOVE X'2020233030303032323233' TO DFHEIV0(25:11)
  2683     CALL 'kxdfhei1' USING DFHEIV0,
  2684           WS-TRANS-ID,
  2685           PROGRAM-INTERFACE-BLOCK,
  2686           PI-COMM-LENGTH,
  2687           DFHEIV99,
  2688           DFHEIV99
  2689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2690
  2691 9100-EXIT.
  2692      EXIT.
  2693*****************************************************************
  2694 9300-XCTL.
  2695*****************************************************************
  2696     MOVE DFHENTER               TO  EIBAID.
  2697
  2698* EXEC CICS XCTL
  2699*        PROGRAM  (THIS-PGM)
  2700*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2701*        LENGTH   (PI-COMM-LENGTH)
  2702*    END-EXEC.
  2703*    MOVE '.$C                   $   #00002234' TO DFHEIV0
  2704     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2705     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2706     MOVE X'2020233030303032323334' TO DFHEIV0(25:11)
  2707     CALL 'kxdfhei1' USING DFHEIV0,
  2708           THIS-PGM,
  2709           PROGRAM-INTERFACE-BLOCK,
  2710           PI-COMM-LENGTH
  2711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2712
  2713 9300-EXIT.
  2714      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL613.cbl
  2716*****************************************************************
  2717 9400-CLEAR.
  2718*****************************************************************
  2719     MOVE PI-RETURN-TO-PROGRAM  TO  THIS-PGM.
  2720     PERFORM 9300-XCTL.
  2721 9400-EXIT.
  2722      EXIT.
  2723*****************************************************************
  2724 9600-PGMIDERR.
  2725*****************************************************************
  2726
  2727* EXEC CICS HANDLE CONDITION
  2728*        PGMIDERR (8300-SEND-TEXT)
  2729*    END-EXEC.
  2730*    MOVE '"$L                   ! # #00002252' TO DFHEIV0
  2731     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2732     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2733     MOVE X'2320233030303032323532' TO DFHEIV0(25:11)
  2734     CALL 'kxdfhei1' USING DFHEIV0
  2735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2736
  2737     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  2738                                     LOGOFF-PGM.
  2739     MOVE 'EL005'                TO  THIS-PGM.
  2740     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  2741     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  2742     PERFORM 9300-XCTL.
  2743 9600-EXIT.
  2744      EXIT.
  2745*****************************************************************
  2746 9900-ERROR-FORMAT.
  2747*****************************************************************
  2748     IF EMI-ERRORS-COMPLETE
  2749         ADD +1             TO  EMI-FATAL-CTR
  2750         MOVE ZERO          TO  EMI-ERROR
  2751         GO TO 9900-EXIT.
  2752
  2753* EXEC CICS LINK
  2754*        PROGRAM  ('EL001')
  2755*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  2756*        LENGTH   (EMI-COMM-LENGTH)
  2757*    END-EXEC.
  2758     MOVE 'EL001' TO DFHEIV1
  2759*    MOVE '."C                   ''   #00002270' TO DFHEIV0
  2760     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2761     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2762     MOVE X'2020233030303032323730' TO DFHEIV0(25:11)
  2763     CALL 'kxdfhei1' USING DFHEIV0,
  2764           DFHEIV1,
  2765           ERROR-MESSAGE-INTERFACE-BLOCK,
  2766           EMI-COMM-LENGTH,
  2767           DFHEIV99,
  2768           DFHEIV99,
  2769           DFHEIV99
  2770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2771
  2772     MOVE ZERO              TO  EMI-ERROR.
  2773 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL613.cbl
  2774      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL613.cbl
  2776*****************************************************************
  2777 9990-ERROR.
  2778*****************************************************************
  2779     MOVE DFHEIBLK               TO EMI-LINE1.
  2780
  2781* EXEC CICS LINK
  2782*        PROGRAM   ('EL004')
  2783*        COMMAREA  (EMI-LINE1)
  2784*        LENGTH    (72)
  2785*    END-EXEC.
  2786     MOVE 'EL004' TO DFHEIV1
  2787     MOVE 72
  2788       TO DFHEIV11
  2789*    MOVE '."C                   ''   #00002283' TO DFHEIV0
  2790     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2791     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2792     MOVE X'2020233030303032323833' TO DFHEIV0(25:11)
  2793     CALL 'kxdfhei1' USING DFHEIV0,
  2794           DFHEIV1,
  2795           EMI-LINE1,
  2796           DFHEIV11,
  2797           DFHEIV99,
  2798           DFHEIV99,
  2799           DFHEIV99
  2800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2801
  2802     PERFORM 8200-SEND-DATAONLY.
  2803     GO TO 9100-RETURN-TRAN.
  2804 9990-EXIT.
  2805      EXIT.
  2806*****************************************************************
  2807 9995-SECURITY-VIOLATION.
  2808*****************************************************************
  2809*           COPY ELCSCTP.
  2810******************************************************************
  2811*                                                                *
  2812*                            ELCSCTP                             *
  2813*                            VMOD=2.001                          *
  2814*                                                                *
  2815*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2816******************************************************************
  2817
  2818
  2819     MOVE EIBDATE          TO SM-JUL-DATE.
  2820     MOVE EIBTRMID         TO SM-TERMID.
  2821     MOVE THIS-PGM         TO SM-PGM.
  2822     MOVE EIBTIME          TO TIME-IN.
  2823     MOVE TIME-OUT         TO SM-TIME.
  2824     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2825
  2826
  2827* EXEC CICS LINK
  2828*         PROGRAM  ('EL003')
  2829*         COMMAREA (SECURITY-MESSAGE)
  2830*         LENGTH   (80)
  2831*    END-EXEC.
  2832     MOVE 'EL003' TO DFHEIV1
  2833     MOVE 80
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL613.cbl
  2834       TO DFHEIV11
  2835*    MOVE '."C                   ''   #00002312' TO DFHEIV0
  2836     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2837     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2838     MOVE X'2020233030303032333132' TO DFHEIV0(25:11)
  2839     CALL 'kxdfhei1' USING DFHEIV0,
  2840           DFHEIV1,
  2841           SECURITY-MESSAGE,
  2842           DFHEIV11,
  2843           DFHEIV99,
  2844           DFHEIV99,
  2845           DFHEIV99
  2846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2847
  2848
  2849******************************************************************
  2850
  2851 9995-EXIT.
  2852      EXIT.
  2853 9999-LAST-PARAGRAPH SECTION.
  2854
  2855* GOBACK.
  2856     MOVE '9%                    "   ' TO DFHEIV0
  2857     MOVE 'EL613' TO DFHEIV1
  2858     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2859     GOBACK.
  2860
  2861 9999-DFHBACK SECTION.
  2862     MOVE '9%                    "   ' TO DFHEIV0
  2863     MOVE 'EL613' TO DFHEIV1
  2864     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2865     GOBACK.
  2866 9999-DFHEXIT.
  2867     IF DFHEIGDJ EQUAL 0001
  2868         NEXT SENTENCE
  2869     ELSE IF DFHEIGDJ EQUAL 2
  2870         GO TO 9600-PGMIDERR,
  2871               9990-ERROR
  2872         DEPENDING ON DFHEIGDI
  2873     ELSE IF DFHEIGDJ EQUAL 3
  2874         GO TO 8300-SEND-TEXT
  2875         DEPENDING ON DFHEIGDI.
  2876     MOVE '9%                    "   ' TO DFHEIV0
  2877     MOVE 'EL613' TO DFHEIV1
  2878     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2879     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5192     Code:        8985
