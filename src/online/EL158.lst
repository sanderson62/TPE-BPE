* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL158.cbl
* Options: int("EL158.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL158.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL158.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL158.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL158.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/13/96 09:56:35.
     7*                            VMOD=2.004.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL158.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26
    27*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    28*    FOR THE POLICY FORM FILE RECORDS.
    29
    30*    SCREENS     - EL158A - FORM MAINTENANCE
    31
    32*    ENTERED BY  - EL601 - MAINTENANCE MENU
    33
    34*    EXIT TO     - EL601 - MAINTENANCE MENU
    35
    36*    INPUT FILE  - ERFORM -              - POLICY FORM FILE
    37
    38*    OUTPUT FILE - ERFORM -              - POLICY FORM FILE
    39
    40*    COMMAREA    - PASSED
    41
    42*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL101.  ON
    43*                  FIRST ENTRY, A SKELETON SCREEN IS SENT AND THE
    44*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    45*                  ENTRIES (XCTL FROM CICS VIA EX39) THE SCREEN
    46*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    47*                  MAINTENANCE TYPE INDICATED.
    48
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL158.cbl
    50 ENVIRONMENT DIVISION.
    51 DATA DIVISION.
    52 WORKING-STORAGE SECTION.
    53 01  DFH-START PIC X(04).
    54 77  FILLER  PIC X(32)  VALUE '********************************'.
    55 77  FILLER  PIC X(32)  VALUE '*    EL158 WORKING STORAGE     *'.
    56 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.004 *********'.
    57
    58 77  FIRST-READ-PREV-SW              PIC X(01)   VALUE SPACES.
    59     88  FIRST-READ-PREV                         VALUE 'Y'.
    60
    61 01  ACCESS-KEYS.
    62     12  ERFORM-KEY.
    63         16  ERFORM-COMPANY-CD       PIC X(01).
    64         16  ERFORM-STATE            PIC X(02).
    65         16  ERFORM-FORM-ID          PIC X(12).
    66         16  ERFORM-EXP-DT           PIC X(02).
    67
    68     12  ELCNTL-KEY.
    69         16  ELCNTL-COMPANY-ID       PIC X(03).
    70         16  ELCNTL-RECORD-TYPE      PIC X(01).
    71         16  ELCNTL-ACCESS           PIC X(04).
    72         16  ELCNTL-STATE-ACCESS REDEFINES ELCNTL-ACCESS.
    73             20  ELCNTL-STATE-CD     PIC  X(02).
    74             20  FILLER              PIC  X(02).
    75         16  ELCNTL-BENEFIT-ACCESS REDEFINES ELCNTL-ACCESS.
    76             20  FILLER              PIC  X(02).
    77             20  ELCNTL-BENE-CD      PIC  X(02).
    78         16  ELCNTL-SEQUENCE-NO      PIC S9(04)      COMP.
    79
    80 01  WS-DATE-AREA.
    81     05  SAVE-DATE                   PIC X(08)   VALUE SPACES.
    82     05  SAVE-BIN-DATE               PIC X(02)   VALUE SPACES.
    83
    84 01  MISC-WORK-AREAS.
    85
    86     12  DEEDIT-FIELD                PIC X(15).
    87     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD
    88                                     PIC S9(15).
    89     12  DEEDIT-FIELD-V2 REDEFINES DEEDIT-FIELD
    90                                     PIC S9(13)V99.
    91
    92     12  WS-BENEFIT-FIELD.
    93         16  WS-BENE-TYPE            PIC X(01).
    94         16  WS-BENE-CODE            PIC X(02).
    95
    96     12  WS-EXP-DT                   PIC X(02)   VALUE LOW-VALUES.
    97
    98 01  STANDARD-AREAS.
    99     12  SC-ITEM                     PIC S9(4)   VALUE +1  COMP.
   100     12  TRANS-ID                    PIC X(04)   VALUE 'E030'.
   101     12  EL150-TRANS-ID              PIC X(04)   VALUE 'EX23'.
   102     12  PGM-NAME                    PIC X(08).
   103     12  TIME-IN                     PIC S9(07).
   104     12  TIME-OUT-R  REDEFINES TIME-IN.
   105         16  FILLER                  PIC X(01).
   106         16  TIME-OUT                PIC 99V99.
   107         16  FILLER                  PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL158.cbl
   108     12  XCTL-005                    PIC X(08)   VALUE 'EL005'.
   109     12  XCTL-010                    PIC X(08)   VALUE 'EL010'.
   110     12  XCTL-155                    PIC X(08)   VALUE 'EL155'.
   111     12  XCTL-626                    PIC X(08)   VALUE 'EL626'.
   112     12  LINK-001                    PIC X(08)   VALUE 'EL001'.
   113     12  LINK-004                    PIC X(08)   VALUE 'EL004'.
   114     12  LINK-ELDATCV                PIC X(08)   VALUE 'ELDATCV'.
   115     12  THIS-PGM                    PIC X(08)   VALUE 'EL158'.
   116     12  ERFORM-FILE-ID              PIC X(08)   VALUE 'ERFORM'.
   117     12  ELCNTL-FILE-ID              PIC X(08)   VALUE 'ELCNTL'.
   118     12  ERFORM-LENGTH               PIC S9(04)  VALUE +500  COMP.
   119     12  SUB                         PIC 9(02).
   120     12  SUB-1                       PIC 9(02).
   121     12  SUB2                        PIC 9(02).
   122     12  GETMAIN-SPACE               PIC X(01)   VALUE SPACE.
   123     12  MAPSET-NAME                 PIC X(08)   VALUE 'EL158S'.
   124     12  WS-MAP-NAME                 PIC X(08)   VALUE 'EL158A'.
   125     12  WS-PF-KEY                   PIC 9(02)   VALUE ZEROS.
   126
   127     12  WS-CNTL-REC-FOUND-SW        PIC X(01)   VALUE 'N'.
   128         88  CNTL-RECORD-FOUND                   VALUE 'Y'.
   129
   130     12  WS-PRE-EXIST-CODES          PIC X(02)   VALUE ZEROS.
   131         88  VALID-PRE-EXIST-CODE                VALUES ARE '00'
   132                                                       THRU '99'.
   133
   134     12  WS-SUICIDE-CODES            PIC X(02)   VALUE ZEROS.
   135         88  VALID-SUICIDE-CODE                  VALUES ARE '00'
   136                                                       THRU '99'.
   137
   138     12  WS-DISABILITY-CODES         PIC X(02)   VALUE ZEROS.
   139         88  VALID-DISABILITY-CODE               VALUES ARE '00'
   140                                                       THRU '99'.
   141
   142     12  WS-REFUND-METHOD            PIC X       VALUE ZEROS.
   143         88  VALID-REFUND-METHOD                 VALUES ARE ' ',
   144                                                   '1' THRU '9'.
   145
   146     12  WS-BENEFIT-SW               PIC X       VALUE SPACE.
   147         88  BENEFIT-FOUND                       VALUE 'Y'.
   148         88  BENEFIT-NOT-FOUND                   VALUE 'N'.
   149
   150     12  WS-LFAMT                    PIC S9(9)V99 VALUE +0 COMP-3.
   151     12  WS-AHAMT                    PIC S9(9)V99 VALUE +0 COMP-3.
   152     12  WS-LFMIN                    PIC 9(3)     VALUE  0 COMP-3.
   153     12  WS-AHMIN                    PIC 9(3)     VALUE  0 COMP-3.
   154     12  WS-LFMAX                    PIC 9(3)     VALUE  0 COMP-3.
   155     12  WS-AHMAX                    PIC 9(3)     VALUE  0 COMP-3.
   156     12  WS-LFTRM                    PIC 9(3)     VALUE  0 COMP-3.
   157     12  WS-AHTRM                    PIC 9(3)     VALUE  0 COMP-3.
   158     12  WS-DEFTYP                   PIC 99       VALUE  0.
   159     12  WS-LFPRE                    PIC 99       VALUE  0.
   160     12  WS-AHPRE                    PIC 99       VALUE  0.
   161     12  WS-SUICIDE                  PIC 99       VALUE  0.
   162     12  WS-INIT-TABLE.
   163         16  FILLER                  PIC X(03)  VALUE '01.'.
   164         16  FILLER                  PIC X(03)  VALUE '02.'.
   165         16  FILLER                  PIC X(03)  VALUE '03.'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL158.cbl
   166         16  FILLER                  PIC X(03)  VALUE '04.'.
   167         16  FILLER                  PIC X(03)  VALUE '05.'.
   168         16  FILLER                  PIC X(03)  VALUE '06.'.
   169         16  FILLER                  PIC X(03)  VALUE '07.'.
   170         16  FILLER                  PIC X(03)  VALUE '08.'.
   171         16  FILLER                  PIC X(03)  VALUE '09.'.
   172         16  FILLER                  PIC X(03)  VALUE '10.'.
   173         16  FILLER                  PIC X(03)  VALUE '11.'.
   174         16  FILLER                  PIC X(03)  VALUE '12.'.
   175         16  FILLER                  PIC X(03)  VALUE '13.'.
   176         16  FILLER                  PIC X(03)  VALUE '14.'.
   177         16  FILLER                  PIC X(03)  VALUE '15.'.
   178         16  FILLER                  PIC X(03)  VALUE '16.'.
   179         16  FILLER                  PIC X(03)  VALUE '17.'.
   180         16  FILLER                  PIC X(03)  VALUE '18.'.
   181         16  FILLER                  PIC X(03)  VALUE '19.'.
   182         16  FILLER                  PIC X(03)  VALUE '20.'.
   183         16  FILLER                  PIC X(03)  VALUE '21.'.
   184         16  FILLER                  PIC X(03)  VALUE '22.'.
   185         16  FILLER                  PIC X(03)  VALUE '23.'.
   186         16  FILLER                  PIC X(03)  VALUE '24.'.
   187         16  FILLER                  PIC X(03)  VALUE '25.'.
   188         16  FILLER                  PIC X(03)  VALUE '26.'.
   189         16  FILLER                  PIC X(03)  VALUE '27.'.
   190         16  FILLER                  PIC X(03)  VALUE '28.'.
   191         16  FILLER                  PIC X(03)  VALUE '29.'.
   192         16  FILLER                  PIC X(03)  VALUE '30.'.
   193         16  FILLER                  PIC X(03)  VALUE '31.'.
   194         16  FILLER                  PIC X(03)  VALUE '32.'.
   195         16  FILLER                  PIC X(03)  VALUE '33.'.
   196         16  FILLER                  PIC X(03)  VALUE '34.'.
   197         16  FILLER                  PIC X(03)  VALUE '35.'.
   198         16  FILLER                  PIC X(03)  VALUE '36.'.
   199         16  FILLER                  PIC X(03)  VALUE '37.'.
   200         16  FILLER                  PIC X(03)  VALUE '38.'.
   201         16  FILLER                  PIC X(03)  VALUE '39.'.
   202         16  FILLER                  PIC X(03)  VALUE '40.'.
   203     12  WS-INIT-VALUE REDEFINES WS-INIT-TABLE OCCURS 40 TIMES
   204                                     PIC X(03).
   205     12  WS158-BENE-INIT             PIC X(03) VALUE '01.'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL158.cbl
   207*                                    COPY ELCSCTM.
   208******************************************************************
   209*                                                                *
   210*                                                                *
   211*                            ELCSCTM                             *
   212*                            VMOD=2.001                          *
   213*                                                                *
   214*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   215*                                                                *
   216******************************************************************
   217 01  SECURITY-MESSAGE.
   218     12  FILLER                          PIC X(30)
   219            VALUE '** LOGIC SECURITY VIOLATION -'.
   220     12  SM-READ                         PIC X(6).
   221     12  FILLER                          PIC X(5)
   222            VALUE ' PGM='.
   223     12  SM-PGM                          PIC X(6).
   224     12  FILLER                          PIC X(5)
   225            VALUE ' OPR='.
   226     12  SM-PROCESSOR-ID                 PIC X(4).
   227     12  FILLER                          PIC X(6)
   228            VALUE ' TERM='.
   229     12  SM-TERMID                       PIC X(4).
   230     12  FILLER                          PIC XX   VALUE SPACE.
   231     12  SM-JUL-DATE                     PIC 9(5).
   232     12  FILLER                          PIC X    VALUE SPACE.
   233     12  SM-TIME                         PIC 99.99.
   234
   235*                                    COPY ELCSCRTY.
   236******************************************************************
   237*                                                                *
   238*                                                                *
   239*                            ELCSCRTY                            *
   240*                            VMOD=2.001                          *
   241*                                                                *
   242*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   243*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   244*        SAVED IN PI-SECURITY-ADDRESS.                           *
   245*                                                                *
   246******************************************************************
   247 01  SECURITY-CONTROL.
   248     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   249     12  FILLER                       PIC XX    VALUE 'SC'.
   250     12  SC-CREDIT-CODES.
   251         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   252             20  SC-CREDIT-DISPLAY    PIC X.
   253             20  SC-CREDIT-UPDATE     PIC X.
   254     12  SC-CLAIMS-CODES.
   255         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   256             20  SC-CLAIMS-DISPLAY    PIC X.
   257             20  SC-CLAIMS-UPDATE     PIC X.
   258
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL158.cbl
   260 01  ERROR-MESSAGES.
   261     12  ER-0000                     PIC X(04)   VALUE '0000'.
   262     12  ER-0023                     PIC X(04)   VALUE '0023'.
   263     12  ER-0029                     PIC X(04)   VALUE '0029'.
   264     12  ER-0050                     PIC X(04)   VALUE '0050'.
   265     12  ER-0068                     PIC X(04)   VALUE '0068'.
   266     12  ER-0070                     PIC X(04)   VALUE '0070'.
   267     12  ER-0130                     PIC X(04)   VALUE '0130'.
   268     12  ER-0131                     PIC X(04)   VALUE '0131'.
   269     12  ER-0132                     PIC X(04)   VALUE '0132'.
   270     12  ER-0138                     PIC X(04)   VALUE '0138'.
   271     12  ER-0144                     PIC X(04)   VALUE '0144'.
   272     12  ER-0418                     PIC X(04)   VALUE '0418'.
   273     12  ER-0582                     PIC X(04)   VALUE '0582'.
   274     12  ER-0701                     PIC X(04)   VALUE '0701'.
   275     12  ER-0702                     PIC X(04)   VALUE '0702'.
   276     12  ER-0703                     PIC X(04)   VALUE '0703'.
   277     12  ER-0704                     PIC X(04)   VALUE '0704'.
   278     12  ER-0705                     PIC X(04)   VALUE '0705'.
   279     12  ER-0706                     PIC X(04)   VALUE '0706'.
   280     12  ER-0707                     PIC X(04)   VALUE '0707'.
   281     12  ER-0708                     PIC X(04)   VALUE '0708'.
   282     12  ER-0709                     PIC X(04)   VALUE '0709'.
   283     12  ER-0710                     PIC X(04)   VALUE '0710'.
   284     12  ER-0711                     PIC X(04)   VALUE '0711'.
   285     12  ER-0712                     PIC X(04)   VALUE '0712'.
   286     12  ER-0713                     PIC X(04)   VALUE '0713'.
   287     12  ER-0717                     PIC X(04)   VALUE '0717'.
   288     12  ER-0718                     PIC X(04)   VALUE '0718'.
   289     12  ER-0719                     PIC X(04)   VALUE '0719'.
   290     12  ER-0720                     PIC X(04)   VALUE '0720'.
   291     12  ER-0721                     PIC X(04)   VALUE '0721'.
   292     12  ER-0722                     PIC X(04)   VALUE '0722'.
   293     12  ER-0723                     PIC X(04)   VALUE '0723'.
   294     12  ER-0724                     PIC X(04)   VALUE '0724'.
   295     12  ER-0725                     PIC X(04)   VALUE '0725'.
   296     12  ER-0726                     PIC X(04)   VALUE '0726'.
   297     12  ER-0727                     PIC X(04)   VALUE '0727'.
   298     12  ER-0729                     PIC X(04)   VALUE '0729'.
   299     12  ER-0754                     PIC X(04)   VALUE '0754'.
   300     12  ER-2241                     PIC X(04)   VALUE '2241'.
   301     12  ER-2276                     PIC X(04)   VALUE '2276'.
   302     12  ER-7008                     PIC X(04)   VALUE '7008'.
   303     12  ER-7031                     PIC X(04)   VALUE '7031'.
   304     12  ER-7123                     PIC X(04)   VALUE '7123'.
   305     12  ER-8150                     PIC X(04)   VALUE '8150'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL158.cbl
   307*                                    COPY ELCDATE.
   308******************************************************************
   309*                                                                *
   310*                                                                *
   311*                            ELCDATE.                            *
   312*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   313*                            VMOD=2.003
   314*                                                                *
   315*                                                                *
   316*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   317*                 LENGTH = 200                                   *
   318******************************************************************
   319
   320 01  DATE-CONVERSION-DATA.
   321     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   322     12  DC-OPTION-CODE                PIC X.
   323         88  BIN-TO-GREG                VALUE ' '.
   324         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   325         88  EDIT-GREG-TO-BIN           VALUE '2'.
   326         88  YMD-GREG-TO-BIN            VALUE '3'.
   327         88  MDY-GREG-TO-BIN            VALUE '4'.
   328         88  JULIAN-TO-BIN              VALUE '5'.
   329         88  BIN-PLUS-ELAPSED           VALUE '6'.
   330         88  FIND-CENTURY               VALUE '7'.
   331         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   332         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   333         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   334         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   335         88  JULIAN-TO-BIN-3            VALUE 'C'.
   336         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   337         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   338         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   339         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   340         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   341         88  CHECK-LEAP-YEAR            VALUE 'H'.
   342         88  BIN-3-TO-GREG              VALUE 'I'.
   343         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   344         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   345         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   346         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   347         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   348         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   349         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   350         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   351         88  THREE-CHARACTER-BIN
   352                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   353         88  GREGORIAN-TO-BIN
   354                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   355         88  BIN-TO-GREGORIAN
   356                  VALUES ' ' '1' 'I' '8' 'G'.
   357         88  JULIAN-TO-BINARY
   358                  VALUES '5' 'C' 'E' 'F'.
   359     12  DC-ERROR-CODE                 PIC X.
   360         88  NO-CONVERSION-ERROR        VALUE ' '.
   361         88  DATE-CONVERSION-ERROR
   362                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   363         88  DATE-IS-ZERO               VALUE '1'.
   364         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL158.cbl
   365         88  DATE-IS-INVALID            VALUE '3'.
   366         88  DATE1-GREATER-DATE2        VALUE '4'.
   367         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   368         88  DATE-INVALID-OPTION        VALUE '9'.
   369         88  INVALID-CENTURY            VALUE 'A'.
   370         88  ONLY-CENTURY               VALUE 'B'.
   371         88  ONLY-LEAP-YEAR             VALUE 'C'.
   372         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   373     12  DC-END-OF-MONTH               PIC X.
   374         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   375     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   376         88  USE-NORMAL-PROCESS         VALUE ' '.
   377         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   378         88  ADJUST-UP-100-YRS          VALUE '2'.
   379     12  FILLER                        PIC X.
   380     12  DC-CONVERSION-DATES.
   381         16  DC-BIN-DATE-1             PIC XX.
   382         16  DC-BIN-DATE-2             PIC XX.
   383         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   384         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   385                       DC-GREG-DATE-1-EDIT.
   386             20  DC-EDIT1-MONTH        PIC 99.
   387             20  SLASH1-1              PIC X.
   388             20  DC-EDIT1-DAY          PIC 99.
   389             20  SLASH1-2              PIC X.
   390             20  DC-EDIT1-YEAR         PIC 99.
   391         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   392         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   393                     DC-GREG-DATE-2-EDIT.
   394             20  DC-EDIT2-MONTH        PIC 99.
   395             20  SLASH2-1              PIC X.
   396             20  DC-EDIT2-DAY          PIC 99.
   397             20  SLASH2-2              PIC X.
   398             20  DC-EDIT2-YEAR         PIC 99.
   399         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   400         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   401                     DC-GREG-DATE-1-YMD.
   402             20  DC-YMD-YEAR           PIC 99.
   403             20  DC-YMD-MONTH          PIC 99.
   404             20  DC-YMD-DAY            PIC 99.
   405         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   406         16  DC-GREG-DATE-1-MDY-R REDEFINES
   407                      DC-GREG-DATE-1-MDY.
   408             20  DC-MDY-MONTH          PIC 99.
   409             20  DC-MDY-DAY            PIC 99.
   410             20  DC-MDY-YEAR           PIC 99.
   411         16  DC-GREG-DATE-1-ALPHA.
   412             20  DC-ALPHA-MONTH        PIC X(10).
   413             20  DC-ALPHA-DAY          PIC 99.
   414             20  FILLER                PIC XX.
   415             20  DC-ALPHA-CENTURY.
   416                 24 DC-ALPHA-CEN-N     PIC 99.
   417             20  DC-ALPHA-YEAR         PIC 99.
   418         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   419         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   420         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   421         16  DC-JULIAN-DATE            PIC 9(05).
   422         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL158.cbl
   423                                       PIC 9(05).
   424         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   425             20  DC-JULIAN-YEAR        PIC 99.
   426             20  DC-JULIAN-DAYS        PIC 999.
   427         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   428         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   429         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   430     12  DATE-CONVERSION-VARIBLES.
   431         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   432         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   433             20  FILLER                PIC 9(3).
   434             20  HOLD-CEN-1-CCYY.
   435                 24  HOLD-CEN-1-CC     PIC 99.
   436                 24  HOLD-CEN-1-YY     PIC 99.
   437             20  HOLD-CEN-1-MO         PIC 99.
   438             20  HOLD-CEN-1-DA         PIC 99.
   439         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   440             20  HOLD-CEN-1-R-MO       PIC 99.
   441             20  HOLD-CEN-1-R-DA       PIC 99.
   442             20  HOLD-CEN-1-R-CCYY.
   443                 24  HOLD-CEN-1-R-CC   PIC 99.
   444                 24  HOLD-CEN-1-R-YY   PIC 99.
   445             20  FILLER                PIC 9(3).
   446         16  HOLD-CENTURY-1-X.
   447             20  FILLER                PIC X(3)  VALUE SPACES.
   448             20  HOLD-CEN-1-X-CCYY.
   449                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   450                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   451             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   452             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   453         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   454             20  HOLD-CEN-1-R-X-MO     PIC XX.
   455             20  HOLD-CEN-1-R-X-DA     PIC XX.
   456             20  HOLD-CEN-1-R-X-CCYY.
   457                 24  HOLD-CEN-1-R-X-CC PIC XX.
   458                 24  HOLD-CEN-1-R-X-YY PIC XX.
   459             20  FILLER                PIC XXX.
   460         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   461         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   462         16  DC-JULIAN-DATE-1          PIC 9(07).
   463         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   464             20  DC-JULIAN-1-CCYY.
   465                 24  DC-JULIAN-1-CC    PIC 99.
   466                 24  DC-JULIAN-1-YR    PIC 99.
   467             20  DC-JULIAN-DA-1        PIC 999.
   468         16  DC-JULIAN-DATE-2          PIC 9(07).
   469         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   470             20  DC-JULIAN-2-CCYY.
   471                 24  DC-JULIAN-2-CC    PIC 99.
   472                 24  DC-JULIAN-2-YR    PIC 99.
   473             20  DC-JULIAN-DA-2        PIC 999.
   474         16  DC-GREG-DATE-A-EDIT.
   475             20  DC-EDITA-MONTH        PIC 99.
   476             20  SLASHA-1              PIC X VALUE '/'.
   477             20  DC-EDITA-DAY          PIC 99.
   478             20  SLASHA-2              PIC X VALUE '/'.
   479             20  DC-EDITA-CCYY.
   480                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL158.cbl
   481                 24  DC-EDITA-YEAR     PIC 99.
   482         16  DC-GREG-DATE-B-EDIT.
   483             20  DC-EDITB-MONTH        PIC 99.
   484             20  SLASHB-1              PIC X VALUE '/'.
   485             20  DC-EDITB-DAY          PIC 99.
   486             20  SLASHB-2              PIC X VALUE '/'.
   487             20  DC-EDITB-CCYY.
   488                 24  DC-EDITB-CENT     PIC 99.
   489                 24  DC-EDITB-YEAR     PIC 99.
   490         16  DC-GREG-DATE-CYMD         PIC 9(08).
   491         16  DC-GREG-DATE-CYMD-R REDEFINES
   492                              DC-GREG-DATE-CYMD.
   493             20  DC-CYMD-CEN           PIC 99.
   494             20  DC-CYMD-YEAR          PIC 99.
   495             20  DC-CYMD-MONTH         PIC 99.
   496             20  DC-CYMD-DAY           PIC 99.
   497         16  DC-GREG-DATE-MDCY         PIC 9(08).
   498         16  DC-GREG-DATE-MDCY-R REDEFINES
   499                              DC-GREG-DATE-MDCY.
   500             20  DC-MDCY-MONTH         PIC 99.
   501             20  DC-MDCY-DAY           PIC 99.
   502             20  DC-MDCY-CEN           PIC 99.
   503             20  DC-MDCY-YEAR          PIC 99.
   504    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   505        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   506    12  DC-EL310-DATE                  PIC X(21).
   507    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL158.cbl
   509*                                    COPY ELCLOGOF.
   510******************************************************************
   511*                                                                *
   512*                                                                *
   513*                            ELCLOGOF.                           *
   514*                            VMOD=2.001                          *
   515*                                                                *
   516*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   517*                                                                *
   518******************************************************************
   519 01  CLASIC-LOGOFF.
   520     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   521     12  LOGOFF-TEXT.
   522         16  FILLER          PIC X(5)    VALUE SPACES.
   523         16  LOGOFF-MSG.
   524             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   525             20  FILLER      PIC X       VALUE SPACES.
   526             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   527         16  FILLER          PIC X(80)
   528           VALUE '* YOU ARE NOW LOGGED OFF'.
   529         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   530         16  FILLER          PIC X       VALUE QUOTE.
   531         16  LOGOFF-SYS-MSG  PIC X(17)
   532           VALUE 'S CLAS-IC SYSTEM '.
   533     12  TEXT-MESSAGES.
   534         16  UNACCESS-MSG    PIC X(29)
   535             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   536         16  PGMIDERR-MSG    PIC X(17)
   537             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL158.cbl
   539*                                    COPY ELCATTR.
   540******************************************************************
   541*                                                                *
   542*                            ELCATTR.                            *
   543*                            VMOD=2.001                          *
   544*                                                                *
   545*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   546*                                                                *
   547*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   548*                                                                *
   549*                   POS 1   P=PROTECTED                          *
   550*                           U=UNPROTECTED                        *
   551*                           S=ASKIP                              *
   552*                   POS 2   A=ALPHA/NUMERIC                      *
   553*                           N=NUMERIC                            *
   554*                   POS 3   N=NORMAL                             *
   555*                           B=BRIGHT                             *
   556*                           D=DARK                               *
   557*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   558*                           OF=MODIFIED DATA TAG OFF             *
   559*                                                                *
   560*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   561******************************************************************
   562 01  ATTRIBUTE-LIST.
   563     12  AL-PABOF            PIC X       VALUE 'Y'.
   564     12  AL-PABON            PIC X       VALUE 'Z'.
   565     12  AL-PADOF            PIC X       VALUE '%'.
   566     12  AL-PADON            PIC X       VALUE '_'.
   567     12  AL-PANOF            PIC X       VALUE '-'.
   568     12  AL-PANON            PIC X       VALUE '/'.
   569     12  AL-SABOF            PIC X       VALUE '8'.
   570     12  AL-SABON            PIC X       VALUE '9'.
   571     12  AL-SADOF            PIC X       VALUE '@'.
   572     12  AL-SADON            PIC X       VALUE QUOTE.
   573     12  AL-SANOF            PIC X       VALUE '0'.
   574     12  AL-SANON            PIC X       VALUE '1'.
   575     12  AL-UABOF            PIC X       VALUE 'H'.
   576     12  AL-UABON            PIC X       VALUE 'I'.
   577     12  AL-UADOF            PIC X       VALUE '<'.
   578     12  AL-UADON            PIC X       VALUE '('.
   579     12  AL-UANOF            PIC X       VALUE ' '.
   580     12  AL-UANON            PIC X       VALUE 'A'.
   581     12  AL-UNBOF            PIC X       VALUE 'Q'.
   582     12  AL-UNBON            PIC X       VALUE 'R'.
   583     12  AL-UNDOF            PIC X       VALUE '*'.
   584     12  AL-UNDON            PIC X       VALUE ')'.
   585     12  AL-UNNOF            PIC X       VALUE '&'.
   586     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL158.cbl
   588*                                    COPY ELCEMIB.
   589******************************************************************
   590*                                                                *
   591*                                                                *
   592*                            ELCEMIB.                            *
   593*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   594*                            VMOD=2.005                          *
   595*                                                                *
   596*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   597*                                                                *
   598******************************************************************
   599 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   600     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   601     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   602     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   603     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   604     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   605     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   606     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   607     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   608     12  EMI-SWITCH1             PIC X        VALUE '1'.
   609         88  EMI-NO-ERRORS                    VALUE '1'.
   610         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   611         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   612     12  EMI-SWITCH2             PIC X        VALUE '1'.
   613         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   614     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   615         88  EMI-AREA1-EMPTY                  VALUE '1'.
   616         88  EMI-AREA1-FULL                   VALUE '2'.
   617     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   618         88  EMI-AREA2-EMPTY                  VALUE '1'.
   619         88  EMI-AREA2-FULL                   VALUE '2'.
   620     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   621         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   622         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   623         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   624         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   625         88  EMI-BYPASS-FATALS                VALUE 'X'.
   626     12  EMI-ERROR-LINES.
   627         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   628         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   629         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   630         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   631             20  EMI-ERR-CODES OCCURS 10 TIMES.
   632                 24  EMI-ERR-NUM         PIC X(4).
   633                 24  EMI-FILLER          PIC X.
   634                 24  EMI-SEV             PIC X.
   635                 24  FILLER              PIC X.
   636             20  FILLER                  PIC X(02).
   637     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   638         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   639             20  EMI-ERROR-NUMBER    PIC X(4).
   640             20  EMI-FILL            PIC X.
   641             20  EMI-SEVERITY        PIC X.
   642             20  FILLER              PIC X.
   643             20  EMI-ERROR-TEXT.
   644                 24  EMI-TEXT-VARIABLE   PIC X(10).
   645                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL158.cbl
   646     12  EMI-SEVERITY-SAVE           PIC X.
   647         88  EMI-NOTE                    VALUE 'N'.
   648         88  EMI-WARNING                 VALUE 'W'.
   649         88  EMI-FORCABLE                VALUE 'F'.
   650         88  EMI-FATAL                   VALUE 'X'.
   651     12  EMI-MESSAGE-FLAG            PIC X.
   652         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   653         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   654     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   655     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   656         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   657         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   658         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   659     12  FILLER                      PIC X(137)  VALUE SPACES.
   660     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   661     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   662     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   663     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL158.cbl
   665*                                    COPY ELCJPFX.
   666******************************************************************
   667*                                                                *
   668*                                                                *
   669*                            ELCJPFX.                            *
   670*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   671*                            VMOD=2.002                          *
   672*                                                                *
   673*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   674*                                                                *
   675*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   676*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   677*        ELCNTL - CONTROL FILE                                   *
   678*        ELMSTR - CLAIM MASTERS                                  *
   679*        ELTRLR - ACTIVITY TRAILERS                              *
   680*        ELCHKQ - CHECK QUE                                      *
   681******************************************************************
   682 01  JOURNAL-RECORD.
   683     12  JP-USER-ID                  PIC X(4).
   684     12  JP-FILE-ID                  PIC X(8).
   685     12  JP-PROGRAM-ID               PIC X(8).
   686     12  JP-RECORD-TYPE              PIC X.
   687         88 JP-ADD              VALUE 'A'.
   688         88 JP-BEFORE-CHANGE    VALUE 'B'.
   689         88 JP-AFTER-CHANGE     VALUE 'C'.
   690         88 JP-DELETE           VALUE 'D'.
   691         88 JP-GENERIC-DELETE   VALUE 'G'.
   692         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   693         88 JP-KEY-CHG-ADD      VALUE 'N'.
   694     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   695     12  JP-RECORD-AREA
   696
   697
   698                                     PIC X(530).
   699
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL158.cbl
   701*                                    COPY ELCINTF.
   702******************************************************************
   703*                                                                *
   704*                                                                *
   705*                            ELCINTF.                            *
   706*                            VMOD=2.017                          *
   707*                                                                *
   708*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   709*                                                                *
   710*       LENGTH = 1024                                            *
   711*                                                                *
   712******************************************************************
   713 01  PROGRAM-INTERFACE-BLOCK.
   714     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   715     12  PI-CALLING-PROGRAM              PIC X(8).
   716     12  PI-SAVED-PROGRAM-1              PIC X(8).
   717     12  PI-SAVED-PROGRAM-2              PIC X(8).
   718     12  PI-SAVED-PROGRAM-3              PIC X(8).
   719     12  PI-SAVED-PROGRAM-4              PIC X(8).
   720     12  PI-SAVED-PROGRAM-5              PIC X(8).
   721     12  PI-SAVED-PROGRAM-6              PIC X(8).
   722     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   723     12  PI-COMPANY-ID                   PIC XXX.
   724     12  PI-COMPANY-CD                   PIC X.
   725
   726     12  PI-COMPANY-PASSWORD             PIC X(8).
   727
   728     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   729
   730     12  PI-CONTROL-IN-PROGRESS.
   731         16  PI-CARRIER                  PIC X.
   732         16  PI-GROUPING                 PIC X(6).
   733         16  PI-STATE                    PIC XX.
   734         16  PI-ACCOUNT                  PIC X(10).
   735         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   736                                         PIC X(10).
   737         16  PI-CLAIM-CERT-GRP.
   738             20  PI-CLAIM-NO             PIC X(7).
   739             20  PI-CERT-NO.
   740                 25  PI-CERT-PRIME       PIC X(10).
   741                 25  PI-CERT-SFX         PIC X.
   742             20  PI-CERT-EFF-DT          PIC XX.
   743         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   744             20  PI-PLAN-CODE            PIC X(2).
   745             20  PI-REVISION-NUMBER      PIC X(3).
   746             20  PI-PLAN-EFF-DT          PIC X(2).
   747             20  PI-PLAN-EXP-DT          PIC X(2).
   748             20  FILLER                  PIC X(11).
   749         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   750             20  PI-OE-REFERENCE-1.
   751                 25  PI-OE-REF-1-PRIME   PIC X(18).
   752                 25  PI-OE-REF-1-SUFF    PIC XX.
   753
   754     12  PI-SESSION-IN-PROGRESS          PIC X.
   755         88  CLAIM-SESSION                   VALUE '1'.
   756         88  CREDIT-SESSION                  VALUE '2'.
   757         88  WARRANTY-SESSION                VALUE '3'.
   758         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL158.cbl
   759         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   760
   761
   762*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   763
   764     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   765     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   766
   767     12  PI-CREDIT-USER                  PIC X.
   768         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   769         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   770
   771     12  PI-CLAIM-USER                   PIC X.
   772         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   773         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   774
   775     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   776         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   777         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   778         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   779         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   780         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   781
   782     12  PI-PROCESSOR-ID                 PIC X(4).
   783
   784     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   785
   786     12  PI-MEMBER-CAPTION               PIC X(10).
   787
   788     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   789         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   790
   791     12  PI-LIFE-OVERRIDE-L1             PIC X.
   792     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   793     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   794     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   795
   796     12  PI-AH-OVERRIDE-L1               PIC X.
   797     12  PI-AH-OVERRIDE-L2               PIC XX.
   798     12  PI-AH-OVERRIDE-L6               PIC X(6).
   799     12  PI-AH-OVERRIDE-L12              PIC X(12).
   800
   801     12  PI-NEW-SYSTEM                   PIC X(2).
   802
   803     12  PI-PRIMARY-CERT-NO              PIC X(11).
   804     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   805         88  PI-USES-PAID-TO                 VALUE '1'.
   806     12  PI-CRDTCRD-SYSTEM.
   807         16  PI-CRDTCRD-USER             PIC X.
   808             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   809             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   810         16  PI-CC-MONTH-END-DT          PIC XX.
   811     12  PI-PROCESSOR-PRINTER            PIC X(4).
   812
   813     12  PI-OE-REFERENCE-2.
   814         16  PI-OE-REF-2-PRIME           PIC X(10).
   815         16  PI-OE-REF-2-SUFF            PIC X.
   816
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL158.cbl
   817     12  PI-REM-TRM-CALC-OPTION          PIC X.
   818
   819     12  PI-LANGUAGE-TYPE                PIC X.
   820             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   821             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   822             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   823
   824     12  PI-POLICY-LINKAGE-IND           PIC X.
   825         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   826         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   827                                                   LOW-VALUES.
   828
   829     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   830     12  PI-CLAIM-PW-SESSION             PIC X(1).
   831         88  PI-CLAIM-CREDIT                 VALUE '1'.
   832         88  PI-CLAIM-CONVEN                 VALUE '2'.
   833     12  FILLER                          PIC X(4).
   834
   835     12  PI-SYSTEM-LEVEL                 PIC X(145).
   836
   837     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   838         PI-SYSTEM-LEVEL.
   839
   840         16  PI-ENTRY-CODES.
   841             20  PI-ENTRY-CD-1           PIC X.
   842             20  PI-ENTRY-CD-2           PIC X.
   843
   844         16  PI-RETURN-CODES.
   845             20  PI-RETURN-CD-1          PIC X.
   846             20  PI-RETURN-CD-2          PIC X.
   847
   848         16  PI-UPDATE-STATUS-SAVE.
   849             20  PI-UPDATE-BY            PIC X(4).
   850             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   851
   852         16  PI-LOWER-CASE-LETTERS       PIC X.
   853             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   854
   855*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   856*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   857*            88  CARRIER-CLM-CNTL            VALUE '2'.
   858
   859         16  PI-CERT-ACCESS-CONTROL      PIC X.
   860             88  ST-ACCNT-CNTL               VALUE ' '.
   861             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   862             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   863             88  ACCNT-CNTL                  VALUE '3'.
   864             88  CARR-ACCNT-CNTL             VALUE '4'.
   865
   866         16  PI-PROCESSOR-CAP-LIST.
   867             20  PI-SYSTEM-CONTROLS.
   868                24 PI-SYSTEM-DISPLAY     PIC X.
   869                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   870                24 PI-SYSTEM-MODIFY      PIC X.
   871                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   872             20  FILLER                  PIC XX.
   873             20  PI-DISPLAY-CAP          PIC X.
   874                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL158.cbl
   875             20  PI-MODIFY-CAP           PIC X.
   876                 88  MODIFY-CAP              VALUE 'Y'.
   877             20  PI-MSG-AT-LOGON-CAP     PIC X.
   878                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   879             20  PI-FORCE-CAP            PIC X.
   880                 88  FORCE-CAP               VALUE 'Y'.
   881
   882         16  PI-PROGRAM-CONTROLS.
   883             20  PI-PGM-PRINT-OPT        PIC X.
   884             20  PI-PGM-FORMAT-OPT       PIC X.
   885             20  PI-PGM-PROCESS-OPT      PIC X.
   886             20  PI-PGM-TOTALS-OPT       PIC X.
   887
   888         16  PI-HELP-INTERFACE.
   889             20  PI-LAST-ERROR-NO        PIC X(4).
   890             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   891
   892         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   893             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   894
   895         16  PI-CR-CONTROL-IN-PROGRESS.
   896             20  PI-CR-CARRIER           PIC X.
   897             20  PI-CR-GROUPING          PIC X(6).
   898             20  PI-CR-STATE             PIC XX.
   899             20  PI-CR-ACCOUNT           PIC X(10).
   900             20  PI-CR-FIN-RESP          PIC X(10).
   901             20  PI-CR-TYPE              PIC X.
   902
   903         16  PI-CR-BATCH-NUMBER          PIC X(6).
   904
   905         16  PI-CR-MONTH-END-DT          PIC XX.
   906
   907         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   908             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   909             88  PI-ZERO-CARRIER             VALUE '1'.
   910             88  PI-ZERO-GROUPING            VALUE '2'.
   911             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   912
   913         16  PI-CARRIER-SECURITY         PIC X.
   914             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   915
   916         16  PI-ACCOUNT-SECURITY         PIC X(10).
   917             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   918             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   919
   920         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   921             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   922                                         INDEXED BY PI-ACCESS-NDX
   923                                         PIC X.
   924
   925         16  PI-GA-BILLING-CONTROL       PIC X.
   926             88  PI-GA-BILLING               VALUE '1'.
   927
   928         16  PI-MAIL-PROCESSING          PIC X.
   929             88  PI-MAIL-YES                 VALUE 'Y'.
   930
   931         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   932
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL158.cbl
   933         16  PI-AR-SYSTEM.
   934             20  PI-AR-PROCESSING-CNTL   PIC X.
   935                 88  PI-AR-PROCESSING        VALUE 'Y'.
   936             20  PI-AR-SUMMARY-CODE      PIC X(6).
   937             20  PI-AR-MONTH-END-DT      PIC XX.
   938
   939         16  PI-MP-SYSTEM.
   940             20  PI-MORTGAGE-USER            PIC X.
   941                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   942                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   943             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   944                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   945                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   946                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   947                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   948                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   949             20  PI-MP-MONTH-END-DT          PIC XX.
   950             20  PI-MP-REFERENCE-NO.
   951                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   952                 24  PI-MP-REFERENCE-SFX     PIC XX.
   953
   954         16  PI-LABEL-CONTROL            PIC X(01).
   955             88  PI-CREATE-LABELS                    VALUE 'Y'.
   956             88  PI-BYPASS-LABELS                    VALUE 'N'.
   957
   958         16  PI-BILL-GROUPING-CODE       PIC X(01).
   959             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   960
   961         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   962             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   963             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   964
   965         16  FILLER                      PIC X(14).
   966
   967     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   968******************************************************************
   969     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   970
   971         16  PI-FORM-NUMBER          PIC X(12).
   972
   973         16  PI-PREV-FORM-KEY.
   974             20  PI-PREV-COMPANY-CD  PIC X(01).
   975             20  PI-PREV-STATE       PIC X(02).
   976             20  PI-PREV-FORM-ID     PIC X(12).
   977             20  PI-PREV-EXP-DT      PIC X(02).
   978
   979         16  PI-FORM-KEY.
   980             20  PI-STATE-CODE       PIC X(02).
   981             20  PI-FORM-ID          PIC X(12).
   982             20  PI-EXP-DT           PIC X(08).
   983         16  FILLER                  PIC X(589).
   984
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL158.cbl
   986*                                    COPY ELCAID.
   987******************************************************************
   988*                                                                *
   989*                            ELCAID.                             *
   990*                            VMOD=2.001                          *
   991*                                                                *
   992*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   993*                                                                *
   994*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   995*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   996******************************************************************
   997
   998 01  DFHAID.
   999   02  DFHNULL   PIC  X  VALUE  ' '.
  1000   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1001   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1002   02  DFHPEN    PIC  X  VALUE  '='.
  1003   02  DFHOPID   PIC  X  VALUE  'W'.
  1004   02  DFHPA1    PIC  X  VALUE  '%'.
  1005   02  DFHPA2    PIC  X  VALUE  '>'.
  1006   02  DFHPA3    PIC  X  VALUE  ','.
  1007   02  DFHPF1    PIC  X  VALUE  '1'.
  1008   02  DFHPF2    PIC  X  VALUE  '2'.
  1009   02  DFHPF3    PIC  X  VALUE  '3'.
  1010   02  DFHPF4    PIC  X  VALUE  '4'.
  1011   02  DFHPF5    PIC  X  VALUE  '5'.
  1012   02  DFHPF6    PIC  X  VALUE  '6'.
  1013   02  DFHPF7    PIC  X  VALUE  '7'.
  1014   02  DFHPF8    PIC  X  VALUE  '8'.
  1015   02  DFHPF9    PIC  X  VALUE  '9'.
  1016   02  DFHPF10   PIC  X  VALUE  ':'.
  1017   02  DFHPF11   PIC  X  VALUE  '#'.
  1018   02  DFHPF12   PIC  X  VALUE  '@'.
  1019   02  DFHPF13   PIC  X  VALUE  'A'.
  1020   02  DFHPF14   PIC  X  VALUE  'B'.
  1021   02  DFHPF15   PIC  X  VALUE  'C'.
  1022   02  DFHPF16   PIC  X  VALUE  'D'.
  1023   02  DFHPF17   PIC  X  VALUE  'E'.
  1024   02  DFHPF18   PIC  X  VALUE  'F'.
  1025   02  DFHPF19   PIC  X  VALUE  'G'.
  1026   02  DFHPF20   PIC  X  VALUE  'H'.
  1027   02  DFHPF21   PIC  X  VALUE  'I'.
  1028*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1029   02  DFHPF22   PIC  X  VALUE  '['.
  1030   02  DFHPF23   PIC  X  VALUE  '.'.
  1031   02  DFHPF24   PIC  X  VALUE  '<'.
  1032   02  DFHMSRE   PIC  X  VALUE  'X'.
  1033   02  DFHSTRF   PIC  X  VALUE  'h'.
  1034   02  DFHTRIG   PIC  X  VALUE  '"'.
  1035 01  FILLER    REDEFINES DFHAID.
  1036     12  FILLER                      PIC X(08).
  1037     12  PF-VALUES                   PIC X         OCCURS 24.
  1038
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL158.cbl
  1040*                                    COPY EL158S.
  1041 01  EL158AI.
  1042     05  FILLER            PIC  X(0012).
  1043*    -------------------------------
  1044     05  DATEL PIC S9(0004) COMP.
  1045     05  DATEF PIC  X(0001).
  1046     05  FILLER REDEFINES DATEF.
  1047         10  DATEA PIC  X(0001).
  1048     05  DATEI PIC  X(0008).
  1049*    -------------------------------
  1050     05  TIMEL PIC S9(0004) COMP.
  1051     05  TIMEF PIC  X(0001).
  1052     05  FILLER REDEFINES TIMEF.
  1053         10  TIMEA PIC  X(0001).
  1054     05  TIMEI PIC  X(0005).
  1055*    -------------------------------
  1056     05  MAINTL PIC S9(0004) COMP.
  1057     05  MAINTF PIC  X(0001).
  1058     05  FILLER REDEFINES MAINTF.
  1059         10  MAINTA PIC  X(0001).
  1060     05  MAINTI PIC  X(0001).
  1061*    -------------------------------
  1062     05  MAINTBYL PIC S9(0004) COMP.
  1063     05  MAINTBYF PIC  X(0001).
  1064     05  FILLER REDEFINES MAINTBYF.
  1065         10  MAINTBYA PIC  X(0001).
  1066     05  MAINTBYI PIC  X(0004).
  1067*    -------------------------------
  1068     05  MAINTONL PIC S9(0004) COMP.
  1069     05  MAINTONF PIC  X(0001).
  1070     05  FILLER REDEFINES MAINTONF.
  1071         10  MAINTONA PIC  X(0001).
  1072     05  MAINTONI PIC  X(0008).
  1073*    -------------------------------
  1074     05  MAINTATL PIC S9(0004) COMP.
  1075     05  MAINTATF PIC  X(0001).
  1076     05  FILLER REDEFINES MAINTATF.
  1077         10  MAINTATA PIC  X(0001).
  1078     05  MAINTATI PIC  X(0005).
  1079*    -------------------------------
  1080     05  STATEL PIC S9(0004) COMP.
  1081     05  STATEF PIC  X(0001).
  1082     05  FILLER REDEFINES STATEF.
  1083         10  STATEA PIC  X(0001).
  1084     05  STATEI PIC  X(0002).
  1085*    -------------------------------
  1086     05  FORML PIC S9(0004) COMP.
  1087     05  FORMF PIC  X(0001).
  1088     05  FILLER REDEFINES FORMF.
  1089         10  FORMA PIC  X(0001).
  1090     05  FORMI PIC  X(0012).
  1091*    -------------------------------
  1092     05  EXPDTL PIC S9(0004) COMP.
  1093     05  EXPDTF PIC  X(0001).
  1094     05  FILLER REDEFINES EXPDTF.
  1095         10  EXPDTA PIC  X(0001).
  1096     05  EXPDTI PIC  X(0008).
  1097*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL158.cbl
  1098     05  INDGRPL PIC S9(0004) COMP.
  1099     05  INDGRPF PIC  X(0001).
  1100     05  FILLER REDEFINES INDGRPF.
  1101         10  INDGRPA PIC  X(0001).
  1102     05  INDGRPI PIC  X(0001).
  1103*    -------------------------------
  1104     05  MAXATTL PIC S9(0004) COMP.
  1105     05  MAXATTF PIC  X(0001).
  1106     05  FILLER REDEFINES MAXATTF.
  1107         10  MAXATTA PIC  X(0001).
  1108     05  MAXATTI PIC  99.
  1109*    -------------------------------
  1110     05  DEFTYPL PIC S9(0004) COMP.
  1111     05  DEFTYPF PIC  X(0001).
  1112     05  FILLER REDEFINES DEFTYPF.
  1113         10  DEFTYPA PIC  X(0001).
  1114     05  DEFTYPI PIC  X(0002).
  1115*    -------------------------------
  1116     05  DISMCDL PIC S9(0004) COMP.
  1117     05  DISMCDF PIC  X(0001).
  1118     05  FILLER REDEFINES DISMCDF.
  1119         10  DISMCDA PIC  X(0001).
  1120     05  DISMCDI PIC  X(0001).
  1121*    -------------------------------
  1122     05  CRTAPPL PIC S9(0004) COMP.
  1123     05  CRTAPPF PIC  X(0001).
  1124     05  FILLER REDEFINES CRTAPPF.
  1125         10  CRTAPPA PIC  X(0001).
  1126     05  CRTAPPI PIC  X(0001).
  1127*    -------------------------------
  1128     05  LFHDGL PIC S9(0004) COMP.
  1129     05  LFHDGF PIC  X(0001).
  1130     05  FILLER REDEFINES LFHDGF.
  1131         10  LFHDGA PIC  X(0001).
  1132     05  LFHDGI PIC  X(0002).
  1133*    -------------------------------
  1134     05  LFMINL PIC S9(0004) COMP.
  1135     05  LFMINF PIC  X(0001).
  1136     05  FILLER REDEFINES LFMINF.
  1137         10  LFMINA PIC  X(0001).
  1138     05  LFMINI PIC  99.
  1139*    -------------------------------
  1140     05  LFMAXL PIC S9(0004) COMP.
  1141     05  LFMAXF PIC  X(0001).
  1142     05  FILLER REDEFINES LFMAXF.
  1143         10  LFMAXA PIC  X(0001).
  1144     05  LFMAXI PIC  99.
  1145*    -------------------------------
  1146     05  LFTRML PIC S9(0004) COMP.
  1147     05  LFTRMF PIC  X(0001).
  1148     05  FILLER REDEFINES LFTRMF.
  1149         10  LFTRMA PIC  X(0001).
  1150     05  LFTRMI PIC  999.
  1151*    -------------------------------
  1152     05  LFAMTL PIC S9(0004) COMP.
  1153     05  LFAMTF PIC  X(0001).
  1154     05  FILLER REDEFINES LFAMTF.
  1155         10  LFAMTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL158.cbl
  1156     05  LFAMTI PIC  9(8)V99.
  1157*    -------------------------------
  1158     05  LFPREL PIC S9(0004) COMP.
  1159     05  LFPREF PIC  X(0001).
  1160     05  FILLER REDEFINES LFPREF.
  1161         10  LFPREA PIC  X(0001).
  1162     05  LFPREI PIC  99.
  1163*    -------------------------------
  1164     05  SUICIDEL PIC S9(0004) COMP.
  1165     05  SUICIDEF PIC  X(0001).
  1166     05  FILLER REDEFINES SUICIDEF.
  1167         10  SUICIDEA PIC  X(0001).
  1168     05  SUICIDEI PIC  99.
  1169*    -------------------------------
  1170     05  AHHDGL PIC S9(0004) COMP.
  1171     05  AHHDGF PIC  X(0001).
  1172     05  FILLER REDEFINES AHHDGF.
  1173         10  AHHDGA PIC  X(0001).
  1174     05  AHHDGI PIC  X(0002).
  1175*    -------------------------------
  1176     05  AHMINL PIC S9(0004) COMP.
  1177     05  AHMINF PIC  X(0001).
  1178     05  FILLER REDEFINES AHMINF.
  1179         10  AHMINA PIC  X(0001).
  1180     05  AHMINI PIC  99.
  1181*    -------------------------------
  1182     05  AHMAXL PIC S9(0004) COMP.
  1183     05  AHMAXF PIC  X(0001).
  1184     05  FILLER REDEFINES AHMAXF.
  1185         10  AHMAXA PIC  X(0001).
  1186     05  AHMAXI PIC  99.
  1187*    -------------------------------
  1188     05  AHTRML PIC S9(0004) COMP.
  1189     05  AHTRMF PIC  X(0001).
  1190     05  FILLER REDEFINES AHTRMF.
  1191         10  AHTRMA PIC  X(0001).
  1192     05  AHTRMI PIC  999.
  1193*    -------------------------------
  1194     05  AHAMTL PIC S9(0004) COMP.
  1195     05  AHAMTF PIC  X(0001).
  1196     05  FILLER REDEFINES AHAMTF.
  1197         10  AHAMTA PIC  X(0001).
  1198     05  AHAMTI PIC  9(6)V99.
  1199*    -------------------------------
  1200     05  AHPREL PIC S9(0004) COMP.
  1201     05  AHPREF PIC  X(0001).
  1202     05  FILLER REDEFINES AHPREF.
  1203         10  AHPREA PIC  X(0001).
  1204     05  AHPREI PIC  99.
  1205*    -------------------------------
  1206     05  INIT1L PIC S9(0004) COMP.
  1207     05  INIT1F PIC  X(0001).
  1208     05  FILLER REDEFINES INIT1F.
  1209         10  INIT1A PIC  X(0001).
  1210     05  INIT1I PIC  X(0003).
  1211*    -------------------------------
  1212     05  BENE1L PIC S9(0004) COMP.
  1213     05  BENE1F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL158.cbl
  1214     05  FILLER REDEFINES BENE1F.
  1215         10  BENE1A PIC  X(0001).
  1216     05  BENE1I PIC  X(0003).
  1217*    -------------------------------
  1218     05  TERM1L PIC S9(0004) COMP.
  1219     05  TERM1F PIC  X(0001).
  1220     05  FILLER REDEFINES TERM1F.
  1221         10  TERM1A PIC  X(0001).
  1222     05  TERM1I PIC  999.
  1223*    -------------------------------
  1224     05  REFM1L PIC S9(0004) COMP.
  1225     05  REFM1F PIC  X(0001).
  1226     05  FILLER REDEFINES REFM1F.
  1227         10  REFM1A PIC  X(0001).
  1228     05  REFM1I PIC  X(0001).
  1229*    -------------------------------
  1230     05  INIT2L PIC S9(0004) COMP.
  1231     05  INIT2F PIC  X(0001).
  1232     05  FILLER REDEFINES INIT2F.
  1233         10  INIT2A PIC  X(0001).
  1234     05  INIT2I PIC  X(0003).
  1235*    -------------------------------
  1236     05  BENE2L PIC S9(0004) COMP.
  1237     05  BENE2F PIC  X(0001).
  1238     05  FILLER REDEFINES BENE2F.
  1239         10  BENE2A PIC  X(0001).
  1240     05  BENE2I PIC  X(0003).
  1241*    -------------------------------
  1242     05  TERM2L PIC S9(0004) COMP.
  1243     05  TERM2F PIC  X(0001).
  1244     05  FILLER REDEFINES TERM2F.
  1245         10  TERM2A PIC  X(0001).
  1246     05  TERM2I PIC  999.
  1247*    -------------------------------
  1248     05  REFM2L PIC S9(0004) COMP.
  1249     05  REFM2F PIC  X(0001).
  1250     05  FILLER REDEFINES REFM2F.
  1251         10  REFM2A PIC  X(0001).
  1252     05  REFM2I PIC  X(0001).
  1253*    -------------------------------
  1254     05  INIT3L PIC S9(0004) COMP.
  1255     05  INIT3F PIC  X(0001).
  1256     05  FILLER REDEFINES INIT3F.
  1257         10  INIT3A PIC  X(0001).
  1258     05  INIT3I PIC  X(0003).
  1259*    -------------------------------
  1260     05  BENE3L PIC S9(0004) COMP.
  1261     05  BENE3F PIC  X(0001).
  1262     05  FILLER REDEFINES BENE3F.
  1263         10  BENE3A PIC  X(0001).
  1264     05  BENE3I PIC  X(0003).
  1265*    -------------------------------
  1266     05  TERM3L PIC S9(0004) COMP.
  1267     05  TERM3F PIC  X(0001).
  1268     05  FILLER REDEFINES TERM3F.
  1269         10  TERM3A PIC  X(0001).
  1270     05  TERM3I PIC  999.
  1271*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL158.cbl
  1272     05  REFM3L PIC S9(0004) COMP.
  1273     05  REFM3F PIC  X(0001).
  1274     05  FILLER REDEFINES REFM3F.
  1275         10  REFM3A PIC  X(0001).
  1276     05  REFM3I PIC  X(0001).
  1277*    -------------------------------
  1278     05  INIT4L PIC S9(0004) COMP.
  1279     05  INIT4F PIC  X(0001).
  1280     05  FILLER REDEFINES INIT4F.
  1281         10  INIT4A PIC  X(0001).
  1282     05  INIT4I PIC  X(0003).
  1283*    -------------------------------
  1284     05  BENE4L PIC S9(0004) COMP.
  1285     05  BENE4F PIC  X(0001).
  1286     05  FILLER REDEFINES BENE4F.
  1287         10  BENE4A PIC  X(0001).
  1288     05  BENE4I PIC  X(0003).
  1289*    -------------------------------
  1290     05  TERM4L PIC S9(0004) COMP.
  1291     05  TERM4F PIC  X(0001).
  1292     05  FILLER REDEFINES TERM4F.
  1293         10  TERM4A PIC  X(0001).
  1294     05  TERM4I PIC  999.
  1295*    -------------------------------
  1296     05  REFM4L PIC S9(0004) COMP.
  1297     05  REFM4F PIC  X(0001).
  1298     05  FILLER REDEFINES REFM4F.
  1299         10  REFM4A PIC  X(0001).
  1300     05  REFM4I PIC  X(0001).
  1301*    -------------------------------
  1302     05  INIT5L PIC S9(0004) COMP.
  1303     05  INIT5F PIC  X(0001).
  1304     05  FILLER REDEFINES INIT5F.
  1305         10  INIT5A PIC  X(0001).
  1306     05  INIT5I PIC  X(0003).
  1307*    -------------------------------
  1308     05  BENE5L PIC S9(0004) COMP.
  1309     05  BENE5F PIC  X(0001).
  1310     05  FILLER REDEFINES BENE5F.
  1311         10  BENE5A PIC  X(0001).
  1312     05  BENE5I PIC  X(0003).
  1313*    -------------------------------
  1314     05  TERM5L PIC S9(0004) COMP.
  1315     05  TERM5F PIC  X(0001).
  1316     05  FILLER REDEFINES TERM5F.
  1317         10  TERM5A PIC  X(0001).
  1318     05  TERM5I PIC  999.
  1319*    -------------------------------
  1320     05  REFM5L PIC S9(0004) COMP.
  1321     05  REFM5F PIC  X(0001).
  1322     05  FILLER REDEFINES REFM5F.
  1323         10  REFM5A PIC  X(0001).
  1324     05  REFM5I PIC  X(0001).
  1325*    -------------------------------
  1326     05  INIT6L PIC S9(0004) COMP.
  1327     05  INIT6F PIC  X(0001).
  1328     05  FILLER REDEFINES INIT6F.
  1329         10  INIT6A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL158.cbl
  1330     05  INIT6I PIC  X(0003).
  1331*    -------------------------------
  1332     05  BENE6L PIC S9(0004) COMP.
  1333     05  BENE6F PIC  X(0001).
  1334     05  FILLER REDEFINES BENE6F.
  1335         10  BENE6A PIC  X(0001).
  1336     05  BENE6I PIC  X(0003).
  1337*    -------------------------------
  1338     05  TERM6L PIC S9(0004) COMP.
  1339     05  TERM6F PIC  X(0001).
  1340     05  FILLER REDEFINES TERM6F.
  1341         10  TERM6A PIC  X(0001).
  1342     05  TERM6I PIC  999.
  1343*    -------------------------------
  1344     05  REFM6L PIC S9(0004) COMP.
  1345     05  REFM6F PIC  X(0001).
  1346     05  FILLER REDEFINES REFM6F.
  1347         10  REFM6A PIC  X(0001).
  1348     05  REFM6I PIC  X(0001).
  1349*    -------------------------------
  1350     05  INIT7L PIC S9(0004) COMP.
  1351     05  INIT7F PIC  X(0001).
  1352     05  FILLER REDEFINES INIT7F.
  1353         10  INIT7A PIC  X(0001).
  1354     05  INIT7I PIC  X(0003).
  1355*    -------------------------------
  1356     05  BENE7L PIC S9(0004) COMP.
  1357     05  BENE7F PIC  X(0001).
  1358     05  FILLER REDEFINES BENE7F.
  1359         10  BENE7A PIC  X(0001).
  1360     05  BENE7I PIC  X(0003).
  1361*    -------------------------------
  1362     05  TERM7L PIC S9(0004) COMP.
  1363     05  TERM7F PIC  X(0001).
  1364     05  FILLER REDEFINES TERM7F.
  1365         10  TERM7A PIC  X(0001).
  1366     05  TERM7I PIC  999.
  1367*    -------------------------------
  1368     05  REFM7L PIC S9(0004) COMP.
  1369     05  REFM7F PIC  X(0001).
  1370     05  FILLER REDEFINES REFM7F.
  1371         10  REFM7A PIC  X(0001).
  1372     05  REFM7I PIC  X(0001).
  1373*    -------------------------------
  1374     05  INIT8L PIC S9(0004) COMP.
  1375     05  INIT8F PIC  X(0001).
  1376     05  FILLER REDEFINES INIT8F.
  1377         10  INIT8A PIC  X(0001).
  1378     05  INIT8I PIC  X(0003).
  1379*    -------------------------------
  1380     05  BENE8L PIC S9(0004) COMP.
  1381     05  BENE8F PIC  X(0001).
  1382     05  FILLER REDEFINES BENE8F.
  1383         10  BENE8A PIC  X(0001).
  1384     05  BENE8I PIC  X(0003).
  1385*    -------------------------------
  1386     05  TERM8L PIC S9(0004) COMP.
  1387     05  TERM8F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL158.cbl
  1388     05  FILLER REDEFINES TERM8F.
  1389         10  TERM8A PIC  X(0001).
  1390     05  TERM8I PIC  999.
  1391*    -------------------------------
  1392     05  REFM8L PIC S9(0004) COMP.
  1393     05  REFM8F PIC  X(0001).
  1394     05  FILLER REDEFINES REFM8F.
  1395         10  REFM8A PIC  X(0001).
  1396     05  REFM8I PIC  X(0001).
  1397*    -------------------------------
  1398     05  INIT9L PIC S9(0004) COMP.
  1399     05  INIT9F PIC  X(0001).
  1400     05  FILLER REDEFINES INIT9F.
  1401         10  INIT9A PIC  X(0001).
  1402     05  INIT9I PIC  X(0003).
  1403*    -------------------------------
  1404     05  BENE9L PIC S9(0004) COMP.
  1405     05  BENE9F PIC  X(0001).
  1406     05  FILLER REDEFINES BENE9F.
  1407         10  BENE9A PIC  X(0001).
  1408     05  BENE9I PIC  X(0003).
  1409*    -------------------------------
  1410     05  TERM9L PIC S9(0004) COMP.
  1411     05  TERM9F PIC  X(0001).
  1412     05  FILLER REDEFINES TERM9F.
  1413         10  TERM9A PIC  X(0001).
  1414     05  TERM9I PIC  999.
  1415*    -------------------------------
  1416     05  REFM9L PIC S9(0004) COMP.
  1417     05  REFM9F PIC  X(0001).
  1418     05  FILLER REDEFINES REFM9F.
  1419         10  REFM9A PIC  X(0001).
  1420     05  REFM9I PIC  X(0001).
  1421*    -------------------------------
  1422     05  INIT10L PIC S9(0004) COMP.
  1423     05  INIT10F PIC  X(0001).
  1424     05  FILLER REDEFINES INIT10F.
  1425         10  INIT10A PIC  X(0001).
  1426     05  INIT10I PIC  X(0003).
  1427*    -------------------------------
  1428     05  BENE10L PIC S9(0004) COMP.
  1429     05  BENE10F PIC  X(0001).
  1430     05  FILLER REDEFINES BENE10F.
  1431         10  BENE10A PIC  X(0001).
  1432     05  BENE10I PIC  X(0003).
  1433*    -------------------------------
  1434     05  TERM10L PIC S9(0004) COMP.
  1435     05  TERM10F PIC  X(0001).
  1436     05  FILLER REDEFINES TERM10F.
  1437         10  TERM10A PIC  X(0001).
  1438     05  TERM10I PIC  999.
  1439*    -------------------------------
  1440     05  REFM10L PIC S9(0004) COMP.
  1441     05  REFM10F PIC  X(0001).
  1442     05  FILLER REDEFINES REFM10F.
  1443         10  REFM10A PIC  X(0001).
  1444     05  REFM10I PIC  X(0001).
  1445*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL158.cbl
  1446     05  INIT11L PIC S9(0004) COMP.
  1447     05  INIT11F PIC  X(0001).
  1448     05  FILLER REDEFINES INIT11F.
  1449         10  INIT11A PIC  X(0001).
  1450     05  INIT11I PIC  X(0003).
  1451*    -------------------------------
  1452     05  BENE11L PIC S9(0004) COMP.
  1453     05  BENE11F PIC  X(0001).
  1454     05  FILLER REDEFINES BENE11F.
  1455         10  BENE11A PIC  X(0001).
  1456     05  BENE11I PIC  X(0003).
  1457*    -------------------------------
  1458     05  TERM11L PIC S9(0004) COMP.
  1459     05  TERM11F PIC  X(0001).
  1460     05  FILLER REDEFINES TERM11F.
  1461         10  TERM11A PIC  X(0001).
  1462     05  TERM11I PIC  999.
  1463*    -------------------------------
  1464     05  REFM11L PIC S9(0004) COMP.
  1465     05  REFM11F PIC  X(0001).
  1466     05  FILLER REDEFINES REFM11F.
  1467         10  REFM11A PIC  X(0001).
  1468     05  REFM11I PIC  X(0001).
  1469*    -------------------------------
  1470     05  INIT12L PIC S9(0004) COMP.
  1471     05  INIT12F PIC  X(0001).
  1472     05  FILLER REDEFINES INIT12F.
  1473         10  INIT12A PIC  X(0001).
  1474     05  INIT12I PIC  X(0003).
  1475*    -------------------------------
  1476     05  BENE12L PIC S9(0004) COMP.
  1477     05  BENE12F PIC  X(0001).
  1478     05  FILLER REDEFINES BENE12F.
  1479         10  BENE12A PIC  X(0001).
  1480     05  BENE12I PIC  X(0003).
  1481*    -------------------------------
  1482     05  TERM12L PIC S9(0004) COMP.
  1483     05  TERM12F PIC  X(0001).
  1484     05  FILLER REDEFINES TERM12F.
  1485         10  TERM12A PIC  X(0001).
  1486     05  TERM12I PIC  999.
  1487*    -------------------------------
  1488     05  REFM12L PIC S9(0004) COMP.
  1489     05  REFM12F PIC  X(0001).
  1490     05  FILLER REDEFINES REFM12F.
  1491         10  REFM12A PIC  X(0001).
  1492     05  REFM12I PIC  X(0001).
  1493*    -------------------------------
  1494     05  INIT13L PIC S9(0004) COMP.
  1495     05  INIT13F PIC  X(0001).
  1496     05  FILLER REDEFINES INIT13F.
  1497         10  INIT13A PIC  X(0001).
  1498     05  INIT13I PIC  X(0003).
  1499*    -------------------------------
  1500     05  BENE13L PIC S9(0004) COMP.
  1501     05  BENE13F PIC  X(0001).
  1502     05  FILLER REDEFINES BENE13F.
  1503         10  BENE13A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL158.cbl
  1504     05  BENE13I PIC  X(0003).
  1505*    -------------------------------
  1506     05  TERM13L PIC S9(0004) COMP.
  1507     05  TERM13F PIC  X(0001).
  1508     05  FILLER REDEFINES TERM13F.
  1509         10  TERM13A PIC  X(0001).
  1510     05  TERM13I PIC  999.
  1511*    -------------------------------
  1512     05  REFM13L PIC S9(0004) COMP.
  1513     05  REFM13F PIC  X(0001).
  1514     05  FILLER REDEFINES REFM13F.
  1515         10  REFM13A PIC  X(0001).
  1516     05  REFM13I PIC  X(0001).
  1517*    -------------------------------
  1518     05  INIT14L PIC S9(0004) COMP.
  1519     05  INIT14F PIC  X(0001).
  1520     05  FILLER REDEFINES INIT14F.
  1521         10  INIT14A PIC  X(0001).
  1522     05  INIT14I PIC  X(0003).
  1523*    -------------------------------
  1524     05  BENE14L PIC S9(0004) COMP.
  1525     05  BENE14F PIC  X(0001).
  1526     05  FILLER REDEFINES BENE14F.
  1527         10  BENE14A PIC  X(0001).
  1528     05  BENE14I PIC  X(0003).
  1529*    -------------------------------
  1530     05  TERM14L PIC S9(0004) COMP.
  1531     05  TERM14F PIC  X(0001).
  1532     05  FILLER REDEFINES TERM14F.
  1533         10  TERM14A PIC  X(0001).
  1534     05  TERM14I PIC  999.
  1535*    -------------------------------
  1536     05  REFM14L PIC S9(0004) COMP.
  1537     05  REFM14F PIC  X(0001).
  1538     05  FILLER REDEFINES REFM14F.
  1539         10  REFM14A PIC  X(0001).
  1540     05  REFM14I PIC  X(0001).
  1541*    -------------------------------
  1542     05  INIT15L PIC S9(0004) COMP.
  1543     05  INIT15F PIC  X(0001).
  1544     05  FILLER REDEFINES INIT15F.
  1545         10  INIT15A PIC  X(0001).
  1546     05  INIT15I PIC  X(0003).
  1547*    -------------------------------
  1548     05  BENE15L PIC S9(0004) COMP.
  1549     05  BENE15F PIC  X(0001).
  1550     05  FILLER REDEFINES BENE15F.
  1551         10  BENE15A PIC  X(0001).
  1552     05  BENE15I PIC  X(0003).
  1553*    -------------------------------
  1554     05  TERM15L PIC S9(0004) COMP.
  1555     05  TERM15F PIC  X(0001).
  1556     05  FILLER REDEFINES TERM15F.
  1557         10  TERM15A PIC  X(0001).
  1558     05  TERM15I PIC  999.
  1559*    -------------------------------
  1560     05  REFM15L PIC S9(0004) COMP.
  1561     05  REFM15F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL158.cbl
  1562     05  FILLER REDEFINES REFM15F.
  1563         10  REFM15A PIC  X(0001).
  1564     05  REFM15I PIC  X(0001).
  1565*    -------------------------------
  1566     05  INIT16L PIC S9(0004) COMP.
  1567     05  INIT16F PIC  X(0001).
  1568     05  FILLER REDEFINES INIT16F.
  1569         10  INIT16A PIC  X(0001).
  1570     05  INIT16I PIC  X(0003).
  1571*    -------------------------------
  1572     05  BENE16L PIC S9(0004) COMP.
  1573     05  BENE16F PIC  X(0001).
  1574     05  FILLER REDEFINES BENE16F.
  1575         10  BENE16A PIC  X(0001).
  1576     05  BENE16I PIC  X(0003).
  1577*    -------------------------------
  1578     05  TERM16L PIC S9(0004) COMP.
  1579     05  TERM16F PIC  X(0001).
  1580     05  FILLER REDEFINES TERM16F.
  1581         10  TERM16A PIC  X(0001).
  1582     05  TERM16I PIC  999.
  1583*    -------------------------------
  1584     05  REFM16L PIC S9(0004) COMP.
  1585     05  REFM16F PIC  X(0001).
  1586     05  FILLER REDEFINES REFM16F.
  1587         10  REFM16A PIC  X(0001).
  1588     05  REFM16I PIC  X(0001).
  1589*    -------------------------------
  1590     05  INIT17L PIC S9(0004) COMP.
  1591     05  INIT17F PIC  X(0001).
  1592     05  FILLER REDEFINES INIT17F.
  1593         10  INIT17A PIC  X(0001).
  1594     05  INIT17I PIC  X(0003).
  1595*    -------------------------------
  1596     05  BENE17L PIC S9(0004) COMP.
  1597     05  BENE17F PIC  X(0001).
  1598     05  FILLER REDEFINES BENE17F.
  1599         10  BENE17A PIC  X(0001).
  1600     05  BENE17I PIC  X(0003).
  1601*    -------------------------------
  1602     05  TERM17L PIC S9(0004) COMP.
  1603     05  TERM17F PIC  X(0001).
  1604     05  FILLER REDEFINES TERM17F.
  1605         10  TERM17A PIC  X(0001).
  1606     05  TERM17I PIC  999.
  1607*    -------------------------------
  1608     05  REFM17L PIC S9(0004) COMP.
  1609     05  REFM17F PIC  X(0001).
  1610     05  FILLER REDEFINES REFM17F.
  1611         10  REFM17A PIC  X(0001).
  1612     05  REFM17I PIC  X(0001).
  1613*    -------------------------------
  1614     05  INIT18L PIC S9(0004) COMP.
  1615     05  INIT18F PIC  X(0001).
  1616     05  FILLER REDEFINES INIT18F.
  1617         10  INIT18A PIC  X(0001).
  1618     05  INIT18I PIC  X(0003).
  1619*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL158.cbl
  1620     05  BENE18L PIC S9(0004) COMP.
  1621     05  BENE18F PIC  X(0001).
  1622     05  FILLER REDEFINES BENE18F.
  1623         10  BENE18A PIC  X(0001).
  1624     05  BENE18I PIC  X(0003).
  1625*    -------------------------------
  1626     05  TERM18L PIC S9(0004) COMP.
  1627     05  TERM18F PIC  X(0001).
  1628     05  FILLER REDEFINES TERM18F.
  1629         10  TERM18A PIC  X(0001).
  1630     05  TERM18I PIC  999.
  1631*    -------------------------------
  1632     05  REFM18L PIC S9(0004) COMP.
  1633     05  REFM18F PIC  X(0001).
  1634     05  FILLER REDEFINES REFM18F.
  1635         10  REFM18A PIC  X(0001).
  1636     05  REFM18I PIC  X(0001).
  1637*    -------------------------------
  1638     05  INIT19L PIC S9(0004) COMP.
  1639     05  INIT19F PIC  X(0001).
  1640     05  FILLER REDEFINES INIT19F.
  1641         10  INIT19A PIC  X(0001).
  1642     05  INIT19I PIC  X(0003).
  1643*    -------------------------------
  1644     05  BENE19L PIC S9(0004) COMP.
  1645     05  BENE19F PIC  X(0001).
  1646     05  FILLER REDEFINES BENE19F.
  1647         10  BENE19A PIC  X(0001).
  1648     05  BENE19I PIC  X(0003).
  1649*    -------------------------------
  1650     05  TERM19L PIC S9(0004) COMP.
  1651     05  TERM19F PIC  X(0001).
  1652     05  FILLER REDEFINES TERM19F.
  1653         10  TERM19A PIC  X(0001).
  1654     05  TERM19I PIC  999.
  1655*    -------------------------------
  1656     05  REFM19L PIC S9(0004) COMP.
  1657     05  REFM19F PIC  X(0001).
  1658     05  FILLER REDEFINES REFM19F.
  1659         10  REFM19A PIC  X(0001).
  1660     05  REFM19I PIC  X(0001).
  1661*    -------------------------------
  1662     05  INIT20L PIC S9(0004) COMP.
  1663     05  INIT20F PIC  X(0001).
  1664     05  FILLER REDEFINES INIT20F.
  1665         10  INIT20A PIC  X(0001).
  1666     05  INIT20I PIC  X(0003).
  1667*    -------------------------------
  1668     05  BENE20L PIC S9(0004) COMP.
  1669     05  BENE20F PIC  X(0001).
  1670     05  FILLER REDEFINES BENE20F.
  1671         10  BENE20A PIC  X(0001).
  1672     05  BENE20I PIC  X(0003).
  1673*    -------------------------------
  1674     05  TERM20L PIC S9(0004) COMP.
  1675     05  TERM20F PIC  X(0001).
  1676     05  FILLER REDEFINES TERM20F.
  1677         10  TERM20A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL158.cbl
  1678     05  TERM20I PIC  999.
  1679*    -------------------------------
  1680     05  REFM20L PIC S9(0004) COMP.
  1681     05  REFM20F PIC  X(0001).
  1682     05  FILLER REDEFINES REFM20F.
  1683         10  REFM20A PIC  X(0001).
  1684     05  REFM20I PIC  X(0001).
  1685*    -------------------------------
  1686     05  DESCL PIC S9(0004) COMP.
  1687     05  DESCF PIC  X(0001).
  1688     05  FILLER REDEFINES DESCF.
  1689         10  DESCA PIC  X(0001).
  1690     05  DESCI PIC  X(0076).
  1691*    -------------------------------
  1692     05  ERRMSG1L PIC S9(0004) COMP.
  1693     05  ERRMSG1F PIC  X(0001).
  1694     05  FILLER REDEFINES ERRMSG1F.
  1695         10  ERRMSG1A PIC  X(0001).
  1696     05  ERRMSG1I PIC  X(0079).
  1697*    -------------------------------
  1698     05  PFKEYL PIC S9(0004) COMP.
  1699     05  PFKEYF PIC  X(0001).
  1700     05  FILLER REDEFINES PFKEYF.
  1701         10  PFKEYA PIC  X(0001).
  1702     05  PFKEYI PIC  99.
  1703 01  EL158AO REDEFINES EL158AI.
  1704     05  FILLER            PIC  X(0012).
  1705*    -------------------------------
  1706     05  FILLER            PIC  X(0003).
  1707     05  DATEO PIC  X(0008).
  1708*    -------------------------------
  1709     05  FILLER            PIC  X(0003).
  1710     05  TIMEO PIC  99.99.
  1711*    -------------------------------
  1712     05  FILLER            PIC  X(0003).
  1713     05  MAINTO PIC  X(0001).
  1714*    -------------------------------
  1715     05  FILLER            PIC  X(0003).
  1716     05  MAINTBYO PIC  X(0004).
  1717*    -------------------------------
  1718     05  FILLER            PIC  X(0003).
  1719     05  MAINTONO PIC  X(0008).
  1720*    -------------------------------
  1721     05  FILLER            PIC  X(0003).
  1722     05  MAINTATO PIC  99.99.
  1723*    -------------------------------
  1724     05  FILLER            PIC  X(0003).
  1725     05  STATEO PIC  X(0002).
  1726*    -------------------------------
  1727     05  FILLER            PIC  X(0003).
  1728     05  FORMO PIC  X(0012).
  1729*    -------------------------------
  1730     05  FILLER            PIC  X(0003).
  1731     05  EXPDTO PIC  X(0008).
  1732*    -------------------------------
  1733     05  FILLER            PIC  X(0003).
  1734     05  INDGRPO PIC  X(0001).
  1735*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL158.cbl
  1736     05  FILLER            PIC  X(0003).
  1737     05  MAXATTO PIC  99.
  1738*    -------------------------------
  1739     05  FILLER            PIC  X(0003).
  1740     05  DEFTYPO PIC  X(0002).
  1741*    -------------------------------
  1742     05  FILLER            PIC  X(0003).
  1743     05  DISMCDO PIC  X(0001).
  1744*    -------------------------------
  1745     05  FILLER            PIC  X(0003).
  1746     05  CRTAPPO PIC  X(0001).
  1747*    -------------------------------
  1748     05  FILLER            PIC  X(0003).
  1749     05  LFHDGO PIC  X(0002).
  1750*    -------------------------------
  1751     05  FILLER            PIC  X(0003).
  1752     05  LFMINO PIC  99.
  1753*    -------------------------------
  1754     05  FILLER            PIC  X(0003).
  1755     05  LFMAXO PIC  99.
  1756*    -------------------------------
  1757     05  FILLER            PIC  X(0003).
  1758     05  LFTRMO PIC  999.
  1759*    -------------------------------
  1760     05  FILLER            PIC  X(0003).
  1761     05  LFAMTO PIC  Z(7).99.
  1762*    -------------------------------
  1763     05  FILLER            PIC  X(0003).
  1764     05  LFPREO PIC  99.
  1765*    -------------------------------
  1766     05  FILLER            PIC  X(0003).
  1767     05  SUICIDEO PIC  99.
  1768*    -------------------------------
  1769     05  FILLER            PIC  X(0003).
  1770     05  AHHDGO PIC  X(0002).
  1771*    -------------------------------
  1772     05  FILLER            PIC  X(0003).
  1773     05  AHMINO PIC  99.
  1774*    -------------------------------
  1775     05  FILLER            PIC  X(0003).
  1776     05  AHMAXO PIC  99.
  1777*    -------------------------------
  1778     05  FILLER            PIC  X(0003).
  1779     05  AHTRMO PIC  999.
  1780*    -------------------------------
  1781     05  FILLER            PIC  X(0003).
  1782     05  AHAMTO PIC  Z(5).99.
  1783*    -------------------------------
  1784     05  FILLER            PIC  X(0003).
  1785     05  AHPREO PIC  99.
  1786*    -------------------------------
  1787     05  FILLER            PIC  X(0003).
  1788     05  INIT1O PIC  X(0003).
  1789*    -------------------------------
  1790     05  FILLER            PIC  X(0003).
  1791     05  BENE1O PIC  X(0003).
  1792*    -------------------------------
  1793     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL158.cbl
  1794     05  TERM1O PIC  999.
  1795*    -------------------------------
  1796     05  FILLER            PIC  X(0003).
  1797     05  REFM1O PIC  X(0001).
  1798*    -------------------------------
  1799     05  FILLER            PIC  X(0003).
  1800     05  INIT2O PIC  X(0003).
  1801*    -------------------------------
  1802     05  FILLER            PIC  X(0003).
  1803     05  BENE2O PIC  X(0003).
  1804*    -------------------------------
  1805     05  FILLER            PIC  X(0003).
  1806     05  TERM2O PIC  999.
  1807*    -------------------------------
  1808     05  FILLER            PIC  X(0003).
  1809     05  REFM2O PIC  X(0001).
  1810*    -------------------------------
  1811     05  FILLER            PIC  X(0003).
  1812     05  INIT3O PIC  X(0003).
  1813*    -------------------------------
  1814     05  FILLER            PIC  X(0003).
  1815     05  BENE3O PIC  X(0003).
  1816*    -------------------------------
  1817     05  FILLER            PIC  X(0003).
  1818     05  TERM3O PIC  999.
  1819*    -------------------------------
  1820     05  FILLER            PIC  X(0003).
  1821     05  REFM3O PIC  X(0001).
  1822*    -------------------------------
  1823     05  FILLER            PIC  X(0003).
  1824     05  INIT4O PIC  X(0003).
  1825*    -------------------------------
  1826     05  FILLER            PIC  X(0003).
  1827     05  BENE4O PIC  X(0003).
  1828*    -------------------------------
  1829     05  FILLER            PIC  X(0003).
  1830     05  TERM4O PIC  999.
  1831*    -------------------------------
  1832     05  FILLER            PIC  X(0003).
  1833     05  REFM4O PIC  X(0001).
  1834*    -------------------------------
  1835     05  FILLER            PIC  X(0003).
  1836     05  INIT5O PIC  X(0003).
  1837*    -------------------------------
  1838     05  FILLER            PIC  X(0003).
  1839     05  BENE5O PIC  X(0003).
  1840*    -------------------------------
  1841     05  FILLER            PIC  X(0003).
  1842     05  TERM5O PIC  999.
  1843*    -------------------------------
  1844     05  FILLER            PIC  X(0003).
  1845     05  REFM5O PIC  X(0001).
  1846*    -------------------------------
  1847     05  FILLER            PIC  X(0003).
  1848     05  INIT6O PIC  X(0003).
  1849*    -------------------------------
  1850     05  FILLER            PIC  X(0003).
  1851     05  BENE6O PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL158.cbl
  1852*    -------------------------------
  1853     05  FILLER            PIC  X(0003).
  1854     05  TERM6O PIC  999.
  1855*    -------------------------------
  1856     05  FILLER            PIC  X(0003).
  1857     05  REFM6O PIC  X(0001).
  1858*    -------------------------------
  1859     05  FILLER            PIC  X(0003).
  1860     05  INIT7O PIC  X(0003).
  1861*    -------------------------------
  1862     05  FILLER            PIC  X(0003).
  1863     05  BENE7O PIC  X(0003).
  1864*    -------------------------------
  1865     05  FILLER            PIC  X(0003).
  1866     05  TERM7O PIC  999.
  1867*    -------------------------------
  1868     05  FILLER            PIC  X(0003).
  1869     05  REFM7O PIC  X(0001).
  1870*    -------------------------------
  1871     05  FILLER            PIC  X(0003).
  1872     05  INIT8O PIC  X(0003).
  1873*    -------------------------------
  1874     05  FILLER            PIC  X(0003).
  1875     05  BENE8O PIC  X(0003).
  1876*    -------------------------------
  1877     05  FILLER            PIC  X(0003).
  1878     05  TERM8O PIC  999.
  1879*    -------------------------------
  1880     05  FILLER            PIC  X(0003).
  1881     05  REFM8O PIC  X(0001).
  1882*    -------------------------------
  1883     05  FILLER            PIC  X(0003).
  1884     05  INIT9O PIC  X(0003).
  1885*    -------------------------------
  1886     05  FILLER            PIC  X(0003).
  1887     05  BENE9O PIC  X(0003).
  1888*    -------------------------------
  1889     05  FILLER            PIC  X(0003).
  1890     05  TERM9O PIC  999.
  1891*    -------------------------------
  1892     05  FILLER            PIC  X(0003).
  1893     05  REFM9O PIC  X(0001).
  1894*    -------------------------------
  1895     05  FILLER            PIC  X(0003).
  1896     05  INIT10O PIC  X(0003).
  1897*    -------------------------------
  1898     05  FILLER            PIC  X(0003).
  1899     05  BENE10O PIC  X(0003).
  1900*    -------------------------------
  1901     05  FILLER            PIC  X(0003).
  1902     05  TERM10O PIC  999.
  1903*    -------------------------------
  1904     05  FILLER            PIC  X(0003).
  1905     05  REFM10O PIC  X(0001).
  1906*    -------------------------------
  1907     05  FILLER            PIC  X(0003).
  1908     05  INIT11O PIC  X(0003).
  1909*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL158.cbl
  1910     05  FILLER            PIC  X(0003).
  1911     05  BENE11O PIC  X(0003).
  1912*    -------------------------------
  1913     05  FILLER            PIC  X(0003).
  1914     05  TERM11O PIC  999.
  1915*    -------------------------------
  1916     05  FILLER            PIC  X(0003).
  1917     05  REFM11O PIC  X(0001).
  1918*    -------------------------------
  1919     05  FILLER            PIC  X(0003).
  1920     05  INIT12O PIC  X(0003).
  1921*    -------------------------------
  1922     05  FILLER            PIC  X(0003).
  1923     05  BENE12O PIC  X(0003).
  1924*    -------------------------------
  1925     05  FILLER            PIC  X(0003).
  1926     05  TERM12O PIC  999.
  1927*    -------------------------------
  1928     05  FILLER            PIC  X(0003).
  1929     05  REFM12O PIC  X(0001).
  1930*    -------------------------------
  1931     05  FILLER            PIC  X(0003).
  1932     05  INIT13O PIC  X(0003).
  1933*    -------------------------------
  1934     05  FILLER            PIC  X(0003).
  1935     05  BENE13O PIC  X(0003).
  1936*    -------------------------------
  1937     05  FILLER            PIC  X(0003).
  1938     05  TERM13O PIC  999.
  1939*    -------------------------------
  1940     05  FILLER            PIC  X(0003).
  1941     05  REFM13O PIC  X(0001).
  1942*    -------------------------------
  1943     05  FILLER            PIC  X(0003).
  1944     05  INIT14O PIC  X(0003).
  1945*    -------------------------------
  1946     05  FILLER            PIC  X(0003).
  1947     05  BENE14O PIC  X(0003).
  1948*    -------------------------------
  1949     05  FILLER            PIC  X(0003).
  1950     05  TERM14O PIC  999.
  1951*    -------------------------------
  1952     05  FILLER            PIC  X(0003).
  1953     05  REFM14O PIC  X(0001).
  1954*    -------------------------------
  1955     05  FILLER            PIC  X(0003).
  1956     05  INIT15O PIC  X(0003).
  1957*    -------------------------------
  1958     05  FILLER            PIC  X(0003).
  1959     05  BENE15O PIC  X(0003).
  1960*    -------------------------------
  1961     05  FILLER            PIC  X(0003).
  1962     05  TERM15O PIC  999.
  1963*    -------------------------------
  1964     05  FILLER            PIC  X(0003).
  1965     05  REFM15O PIC  X(0001).
  1966*    -------------------------------
  1967     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL158.cbl
  1968     05  INIT16O PIC  X(0003).
  1969*    -------------------------------
  1970     05  FILLER            PIC  X(0003).
  1971     05  BENE16O PIC  X(0003).
  1972*    -------------------------------
  1973     05  FILLER            PIC  X(0003).
  1974     05  TERM16O PIC  999.
  1975*    -------------------------------
  1976     05  FILLER            PIC  X(0003).
  1977     05  REFM16O PIC  X(0001).
  1978*    -------------------------------
  1979     05  FILLER            PIC  X(0003).
  1980     05  INIT17O PIC  X(0003).
  1981*    -------------------------------
  1982     05  FILLER            PIC  X(0003).
  1983     05  BENE17O PIC  X(0003).
  1984*    -------------------------------
  1985     05  FILLER            PIC  X(0003).
  1986     05  TERM17O PIC  999.
  1987*    -------------------------------
  1988     05  FILLER            PIC  X(0003).
  1989     05  REFM17O PIC  X(0001).
  1990*    -------------------------------
  1991     05  FILLER            PIC  X(0003).
  1992     05  INIT18O PIC  X(0003).
  1993*    -------------------------------
  1994     05  FILLER            PIC  X(0003).
  1995     05  BENE18O PIC  X(0003).
  1996*    -------------------------------
  1997     05  FILLER            PIC  X(0003).
  1998     05  TERM18O PIC  999.
  1999*    -------------------------------
  2000     05  FILLER            PIC  X(0003).
  2001     05  REFM18O PIC  X(0001).
  2002*    -------------------------------
  2003     05  FILLER            PIC  X(0003).
  2004     05  INIT19O PIC  X(0003).
  2005*    -------------------------------
  2006     05  FILLER            PIC  X(0003).
  2007     05  BENE19O PIC  X(0003).
  2008*    -------------------------------
  2009     05  FILLER            PIC  X(0003).
  2010     05  TERM19O PIC  999.
  2011*    -------------------------------
  2012     05  FILLER            PIC  X(0003).
  2013     05  REFM19O PIC  X(0001).
  2014*    -------------------------------
  2015     05  FILLER            PIC  X(0003).
  2016     05  INIT20O PIC  X(0003).
  2017*    -------------------------------
  2018     05  FILLER            PIC  X(0003).
  2019     05  BENE20O PIC  X(0003).
  2020*    -------------------------------
  2021     05  FILLER            PIC  X(0003).
  2022     05  TERM20O PIC  999.
  2023*    -------------------------------
  2024     05  FILLER            PIC  X(0003).
  2025     05  REFM20O PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL158.cbl
  2026*    -------------------------------
  2027     05  FILLER            PIC  X(0003).
  2028     05  DESCO PIC  X(0076).
  2029*    -------------------------------
  2030     05  FILLER            PIC  X(0003).
  2031     05  ERRMSG1O PIC  X(0079).
  2032*    -------------------------------
  2033     05  FILLER            PIC  X(0003).
  2034     05  PFKEYO PIC  99.
  2035*    -------------------------------
  2036 01  EL158AI-R REDEFINES EL158AI.
  2037     12  FILLER                      PIC X(195).
  2038     12  EL158-BENE-TABLE OCCURS 20 TIMES.
  2039         16  EL158-BENE-INIT-LENGTH  PIC S9(04)  COMP.
  2040         16  EL158-BENE-INIT-ATTRB   PIC X(01).
  2041         16  EL158-BENE-INIT         PIC X(03).
  2042         16  EL158-BENE-LENGTH       PIC S9(04)  COMP.
  2043         16  EL158-BENE-ATTRB        PIC X(01).
  2044         16  EL158-BENE.
  2045             20  EL158-BENE-TYPE     PIC X(01).
  2046             20  EL158-BENE-ID       PIC X(02).
  2047         16  EL158-BENE-TERM-LENGTH  PIC S9(04)  COMP.
  2048         16  EL158-BENE-TERM-ATTRB   PIC X(01).
  2049         16  EL158-BENE-TERM         PIC 9(03).
  2050         16  EL158-BENE-TERM-R REDEFINES EL158-BENE-TERM
  2051                                     PIC X(03).
  2052         16  EL158-BENE-REFM-LENGTH  PIC S9(04)  COMP.
  2053         16  EL158-BENE-REFM-ATTRB   PIC X(01).
  2054         16  EL158-BENE-REFM         PIC X.
  2055
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL158.cbl
  2057****************************************************************
  2058*
  2059* Copyright (c) 2007 by Clerity Solutions, Inc.
  2060* All rights reserved.
  2061*
  2062****************************************************************
  2063 01  DFHEIV.
  2064   02  DFHEIV0               PIC X(35).
  2065   02  DFHEIV1               PIC X(08).
  2066   02  DFHEIV2               PIC X(08).
  2067   02  DFHEIV3               PIC X(08).
  2068   02  DFHEIV4               PIC X(06).
  2069   02  DFHEIV5               PIC X(04).
  2070   02  DFHEIV6               PIC X(04).
  2071   02  DFHEIV7               PIC X(02).
  2072   02  DFHEIV8               PIC X(02).
  2073   02  DFHEIV9               PIC X(01).
  2074   02  DFHEIV10              PIC S9(7) COMP-3.
  2075   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2076   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2077   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2078   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2079   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2080   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2081   02  DFHEIV17              PIC X(04).
  2082   02  DFHEIV18              PIC X(04).
  2083   02  DFHEIV19              PIC X(04).
  2084   02  DFHEIV20              USAGE IS POINTER.
  2085   02  DFHEIV21              USAGE IS POINTER.
  2086   02  DFHEIV22              USAGE IS POINTER.
  2087   02  DFHEIV23              USAGE IS POINTER.
  2088   02  DFHEIV24              USAGE IS POINTER.
  2089   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2090   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2091   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2092   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2093   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2094   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2095   02  FILLER                PIC X(02).
  2096   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2097   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2098   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2099   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2100   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2101 LINKAGE  SECTION.
  2102*****************************************************************
  2103*                                                               *
  2104* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  2105* All rights reserved.                                          *
  2106*                                                               *
  2107*****************************************************************
  2108 01  dfheiblk.
  2109     02  eibtime          pic s9(7) comp-3.
  2110     02  eibdate          pic s9(7) comp-3.
  2111     02  eibtrnid         pic x(4).
  2112     02  eibtaskn         pic s9(7) comp-3.
  2113     02  eibtrmid         pic x(4).
  2114     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL158.cbl
  2115     02  eibcposn         pic s9(4) comp.
  2116     02  eibcalen         pic s9(4) comp.
  2117     02  eibaid           pic x(1).
  2118     02  eibfiller1       pic x(1).
  2119     02  eibfn            pic x(2).
  2120     02  eibfiller2       pic x(2).
  2121     02  eibrcode         pic x(6).
  2122     02  eibfiller3       pic x(2).
  2123     02  eibds            pic x(8).
  2124     02  eibreqid         pic x(8).
  2125     02  eibrsrce         pic x(8).
  2126     02  eibsync          pic x(1).
  2127     02  eibfree          pic x(1).
  2128     02  eibrecv          pic x(1).
  2129     02  eibsend          pic x(1).
  2130     02  eibatt           pic x(1).
  2131     02  eibeoc           pic x(1).
  2132     02  eibfmh           pic x(1).
  2133     02  eibcompl         pic x(1).
  2134     02  eibsig           pic x(1).
  2135     02  eibconf          pic x(1).
  2136     02  eiberr           pic x(1).
  2137     02  eibrldbk         pic x(1).
  2138     02  eiberrcd         pic x(4).
  2139     02  eibsynrb         pic x(1).
  2140     02  eibnodat         pic x(1).
  2141     02  eibfiller5       pic x(2).
  2142     02  eibresp          pic 9(09) comp.
  2143     02  eibresp2         pic 9(09) comp.
  2144     02  dfheigdj         pic s9(4) comp.
  2145     02  dfheigdk         pic s9(4) comp.
  2146
  2147 01  DFHCOMMAREA                     PIC X(1024).
  2148
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL158.cbl
  2150*                                    COPY ERCFORM.
  2151******************************************************************
  2152*                                                                *
  2153*                                                                *
  2154*                            ERCFORM.                            *
  2155*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2156*                            VMOD=2.003                          *
  2157*                                                                *
  2158*    FILE DESCRIPTION = POLICY FORM MASTER FILE                  *
  2159*                                                                *
  2160*    FILE TYPE = VSAM,KSDS                                       *
  2161*    RECORD SIZE = 500  RECFORM = FIXED                          *
  2162*                                                                *
  2163*    BASE CLUSTER = ERFORM                      RKP=02,LEN=20    *
  2164*                                                                *
  2165*    LOG = YES                                                   *
  2166*    SEVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2167******************************************************************
  2168 01  FORM-MASTER.
  2169    12  FO-RECORD-ID                 PIC X(02).
  2170        88  VALID-FO-ID                  VALUE 'FO'.
  2171
  2172    12  FO-CONTROL-PRIMARY.
  2173        16  FO-COMPANY-CD            PIC X(01).
  2174        16  FO-STATE                 PIC X(02).
  2175        16  FO-FORM-ID               PIC X(12).
  2176        16  FO-FORM-EXP-DT           PIC X(02).
  2177
  2178    12  FO-POLICY-FORM-DATA.
  2179        16  FO-IND-GRP-CD            PIC X(01).
  2180        16  FO-MAX-ATT-AGE           PIC S9(03)      COMP-3.
  2181        16  FO-LF-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  2182        16  FO-AH-MIN-ISSUE-AGE      PIC S9(03)      COMP-3.
  2183        16  FO-LF-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  2184        16  FO-AH-MAX-ISSUE-AGE      PIC S9(03)      COMP-3.
  2185        16  FO-LF-MAX-TERM           PIC S9(03)      COMP-3.
  2186        16  FO-AH-MAX-TERM           PIC S9(03)      COMP-3.
  2187        16  FO-MAX-LF-AMT            PIC S9(07)V99   COMP-3.
  2188        16  FO-MAX-AH-AMT            PIC S9(05)V99   COMP-3.
  2189        16  FO-SUICIDE-EXCL-TYPE     PIC 9(02).
  2190        16  FO-LF-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  2191        16  FO-AH-PRE-EXIST-EXCL-TYPE    PIC 9(02).
  2192        16  FO-DIS-DEF-TYPE          PIC 9(02).
  2193        16  FO-DISMEMBERMENT-CD      PIC X(01).
  2194        16  FO-APP-CERT-USE-CD       PIC X(01).
  2195
  2196    12  FILLER                       PIC X(29).
  2197
  2198    12  FO-FORM-PLAN-TABLE.
  2199        16  FO-FORM-PLANS     OCCURS 40 TIMES.
  2200            20  FO-PLAN-TYPE         PIC X(01).
  2201            20  FO-PLAN-ID           PIC X(02).
  2202            20  FO-PLAN-TERM         PIC 9(03).
  2203            20  FO-PLAN-REFUND-METHOD
  2204                                     PIC X.
  2205
  2206    12  FILLER                       PIC X(30).
  2207
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL158.cbl
  2208    12  FO-COMMENTS-AREA.
  2209        16  FO-COMMENT-LINE-1        PIC X(78).
  2210
  2211    12  FILLER                       PIC X(20).
  2212
  2213    12  FO-MAINT-INFORMATION.
  2214        16  FO-LAST-MAINT-DT         PIC X(02).
  2215        16  FO-LAST-MAINT-HHMMSS     PIC S9(07)      COMP-3.
  2216        16  FO-LAST-MAINT-BY         PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL158.cbl
  2218*                                    COPY ELCCNTL.
  2219******************************************************************
  2220*                                                                *
  2221*                                                                *
  2222*                            ELCCNTL.                            *
  2223*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2224*                            VMOD=2.059                          *
  2225*                                                                *
  2226*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2227*                                                                *
  2228*   FILE TYPE = VSAM,KSDS                                        *
  2229*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2230*                                                                *
  2231*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2232*       ALTERNATE INDEX = NONE                                   *
  2233*                                                                *
  2234*   LOG = YES                                                    *
  2235*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2236******************************************************************
  2237*                   C H A N G E   L O G
  2238*
  2239* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2240*-----------------------------------------------------------------
  2241*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2242* EFFECTIVE    NUMBER
  2243*-----------------------------------------------------------------
  2244* 082503                   PEMA  ADD BENEFIT GROUP
  2245* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2246* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2247* 092705    2005050300006  PEMA  ADD SPP LEASES
  2248* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2249* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2250* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2251* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2252******************************************************************
  2253*
  2254 01  CONTROL-FILE.
  2255     12  CF-RECORD-ID                       PIC XX.
  2256         88  VALID-CF-ID                        VALUE 'CF'.
  2257
  2258     12  CF-CONTROL-PRIMARY.
  2259         16  CF-COMPANY-ID                  PIC XXX.
  2260         16  CF-RECORD-TYPE                 PIC X.
  2261             88  CF-COMPANY-MASTER              VALUE '1'.
  2262             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2263             88  CF-STATE-MASTER                VALUE '3'.
  2264             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2265             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2266             88  CF-CARRIER-MASTER              VALUE '6'.
  2267             88  CF-MORTALITY-MASTER            VALUE '7'.
  2268             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2269             88  CF-TERMINAL-MASTER             VALUE '9'.
  2270             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2271             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2272             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2273             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2274             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2275             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL158.cbl
  2276             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2277             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2278             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2279         16  CF-ACCESS-CD-GENL              PIC X(4).
  2280         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2281             20  CF-PROCESSOR               PIC X(4).
  2282         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2283             20  CF-STATE-CODE              PIC XX.
  2284             20  FILLER                     PIC XX.
  2285         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2286             20  FILLER                     PIC XX.
  2287             20  CF-HI-BEN-IN-REC           PIC XX.
  2288         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2289             20  FILLER                     PIC XXX.
  2290             20  CF-CARRIER-CNTL            PIC X.
  2291         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2292             20  FILLER                     PIC XX.
  2293             20  CF-HI-TYPE-IN-REC          PIC 99.
  2294         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2295             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2296                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2297             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2298             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2299         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2300             20  FILLER                     PIC X.
  2301             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2302         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2303             20  FILLER                     PIC XX.
  2304             20  CF-MORTGAGE-PLAN           PIC XX.
  2305         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2306
  2307     12  CF-LAST-MAINT-DT                   PIC XX.
  2308     12  CF-LAST-MAINT-BY                   PIC X(4).
  2309     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2310
  2311     12  CF-RECORD-BODY                     PIC X(728).
  2312
  2313
  2314****************************************************************
  2315*             COMPANY MASTER RECORD                            *
  2316****************************************************************
  2317
  2318     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2319         16  CF-COMPANY-ADDRESS.
  2320             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2321             20  CF-CL-IN-CARE-OF           PIC X(30).
  2322             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2323             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2324             20  CF-CL-CITY-STATE           PIC X(30).
  2325             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2326             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2327         16  CF-COMPANY-CD                  PIC X.
  2328         16  CF-COMPANY-PASSWORD            PIC X(8).
  2329         16  CF-SECURITY-OPTION             PIC X.
  2330             88  ALL-SECURITY                   VALUE '1'.
  2331             88  COMPANY-VERIFY                 VALUE '2'.
  2332             88  PROCESSOR-VERIFY               VALUE '3'.
  2333             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL158.cbl
  2334             88  ALL-BUT-TERM                   VALUE '5'.
  2335         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2336             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2337         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2338             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2339         16  CF-INFORCE-LOCATION            PIC X.
  2340             88  CERTS-ARE-ONLINE               VALUE '1'.
  2341             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2342             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2343         16  CF-LOWER-CASE-LETTERS          PIC X.
  2344         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2345             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2346             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2347             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2348             88  CF-ACCNT-CNTL                  VALUE '3'.
  2349             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2350
  2351         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2352         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2353
  2354         16  CF-LGX-CREDIT-USER             PIC X.
  2355             88  CO-IS-NOT-USER                 VALUE 'N'.
  2356             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2357
  2358         16 CF-CREDIT-CALC-CODES.
  2359             20  CF-CR-REM-TERM-CALC PIC X.
  2360               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2361               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2362               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2363               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2364               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2365               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2366               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2367             20  CF-CR-R78-METHOD           PIC X.
  2368               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2369               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2370
  2371         16  CF-CLAIM-CONTROL-COUNTS.
  2372             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2373                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2374
  2375             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2376                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2377
  2378             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2379                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2380
  2381             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2382                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2383
  2384         16  CF-CURRENT-MONTH-END           PIC XX.
  2385
  2386         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2387             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2388             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2389             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2390             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2391                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL158.cbl
  2392                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2393             20  CF-CO-PREM-REJECT-SW       PIC X.
  2394                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2395                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2396             20  CF-CO-REF-REJECT-SW        PIC X.
  2397                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2398                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2399
  2400         16  CF-CO-REPORTING-DT             PIC XX.
  2401         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2402         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2403           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2404           88  CF-CO-MONTH-END                  VALUE '1'.
  2405
  2406         16  CF-LGX-CLAIM-USER              PIC X.
  2407             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2408             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2409
  2410         16  CF-CREDIT-EDIT-CONTROLS.
  2411             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2412             20  CF-MIN-AGE                 PIC 99.
  2413             20  CF-DEFAULT-AGE             PIC 99.
  2414             20  CF-MIN-TERM                PIC S999      COMP-3.
  2415             20  CF-MAX-TERM                PIC S999      COMP-3.
  2416             20  CF-DEFAULT-SEX             PIC X.
  2417             20  CF-JOINT-AGE-INPUT         PIC X.
  2418                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2419             20  CF-BIRTH-DATE-INPUT        PIC X.
  2420                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2421             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2422                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2423                 88  CF-ZERO-CARRIER            VALUE '1'.
  2424                 88  CF-ZERO-GROUPING           VALUE '2'.
  2425                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2426             20  CF-EDIT-SW                 PIC X.
  2427                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2428             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2429             20  CF-CR-PR-METHOD            PIC X.
  2430               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2431               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2432             20  FILLER                     PIC X.
  2433
  2434         16  CF-CREDIT-MISC-CONTROLS.
  2435             20  CF-REIN-TABLE-SW           PIC X.
  2436                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2437             20  CF-COMP-TABLE-SW           PIC X.
  2438                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2439             20  CF-EXPERIENCE-RETENTION-AGE
  2440                                            PIC S9        COMP-3.
  2441             20  CF-CONVERSION-DT           PIC XX.
  2442             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2443             20  CF-RUN-FREQUENCY-SW        PIC X.
  2444                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2445                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2446
  2447             20  CF-CR-CHECK-NO-CONTROL.
  2448                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2449                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL158.cbl
  2450                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2451                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2452                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2453                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2454
  2455                 24  CF-CR-CHECK-COUNT       REDEFINES
  2456                     CF-CR-CHECK-COUNTER      PIC X(4).
  2457
  2458                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2459                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2460
  2461                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2462                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2463                 24  CF-MAIL-PROCESSING       PIC X.
  2464                     88  MAIL-PROCESSING          VALUE 'Y'.
  2465
  2466         16  CF-MISC-SYSTEM-CONTROL.
  2467             20  CF-SYSTEM-C                 PIC X.
  2468                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2469             20  CF-SYSTEM-D                 PIC X.
  2470                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2471             20  CF-SOC-SEC-NO-SW            PIC X.
  2472                 88  SOC-SEC-NO-USED             VALUE '1'.
  2473             20  CF-MEMBER-NO-SW             PIC X.
  2474                 88  MEMBER-NO-USED              VALUE '1'.
  2475             20  CF-TAX-ID-NUMBER            PIC X(11).
  2476             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2477             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2478                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2479                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2480                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2481                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2482             20  CF-SYSTEM-E                 PIC X.
  2483                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2484
  2485         16  CF-LGX-LIFE-USER               PIC X.
  2486             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2487             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2488
  2489         16  CF-CR-MONTH-END-DT             PIC XX.
  2490
  2491         16  CF-FILE-MAINT-DATES.
  2492             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2493                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2494             20  CF-LAST-BATCH       REDEFINES
  2495                 CF-LAST-BATCH-NO               PIC X(4).
  2496             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2497             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2498             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2499             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2500             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2501             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2502             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2503             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2504             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2505             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2506
  2507         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL158.cbl
  2508         16  FILLER                         PIC X.
  2509
  2510         16  CF-ALT-MORT-CODE               PIC X(4).
  2511         16  CF-MEMBER-CAPTION              PIC X(10).
  2512
  2513         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2514             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2515             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2516             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2517             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2518             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2519
  2520         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2521
  2522         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2523         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2524         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2525         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2526
  2527         16  CF-AH-OVERRIDE-L1              PIC X.
  2528         16  CF-AH-OVERRIDE-L2              PIC XX.
  2529         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2530         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2531
  2532         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2533         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2534
  2535         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2536         16  CF-AR-LAST-EL860-DT            PIC XX.
  2537         16  CF-MP-MONTH-END-DT             PIC XX.
  2538
  2539         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2540         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2541             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2542
  2543         16  CF-AR-MONTH-END-DT             PIC XX.
  2544
  2545         16  CF-CRDTCRD-USER                PIC X.
  2546             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2547             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2548
  2549         16  CF-CC-MONTH-END-DT             PIC XX.
  2550
  2551         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2552
  2553         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2554             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2555             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2556             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2557         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2558         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2559         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2560         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2561             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2562             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2563         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2564         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2565         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL158.cbl
  2566             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2567         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2568
  2569         16  CF-CL-ZIP-CODE.
  2570             20  CF-CL-ZIP-PRIME.
  2571                 24  CF-CL-ZIP-1ST          PIC X.
  2572                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2573                 24  FILLER                 PIC X(4).
  2574             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2575         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2576             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2577             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2578             20  FILLER                     PIC XXX.
  2579
  2580         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2581         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2582         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2583         16  CF-CO-OPTION-START-DATE        PIC XX.
  2584         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2585           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2586                                                      '3' '4'.
  2587           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2588           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2589           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2590           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2591           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2592           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2593
  2594         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2595
  2596         16  CF-PAYMENT-APPROVAL-LEVELS.
  2597             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2598             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2599             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2600             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2601             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2602             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2603
  2604         16  CF-END-USER-REPORTING-USER     PIC X.
  2605             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2606             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2607
  2608         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2609             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2610             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2611
  2612         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2613
  2614         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2615         16  FILLER                         PIC X.
  2616
  2617         16  CF-CREDIT-ARCHIVE-CNTL.
  2618             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2619             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2620             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2621
  2622         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2623
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL158.cbl
  2624         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2625             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2626             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2627
  2628         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2629             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2630             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2631
  2632         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2633
  2634         16  CF-CO-ACH-ID-CODE              PIC  X.
  2635             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2636             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2637             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2638         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2639         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2640         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2641         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2642         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2643         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2644         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2645         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2646         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2647                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2648         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2649                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2650
  2651         16  CF-CO-OVER-SHORT.
  2652             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2653             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2654
  2655*         16  FILLER                         PIC X(102).
  2656         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2657             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2658             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2659
  2660         16  CF-AH-APPROVAL-DAYS.
  2661             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2662             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2663             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2664             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2665
  2666         16  FILLER                         PIC X(82).
  2667****************************************************************
  2668*             PROCESSOR/USER RECORD                            *
  2669****************************************************************
  2670
  2671     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2672         16  CF-PROCESSOR-NAME              PIC X(30).
  2673         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2674         16  CF-PROCESSOR-TITLE             PIC X(26).
  2675         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2676                 88  MESSAGE-YES                VALUE 'Y'.
  2677                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2678
  2679*****************************************************
  2680****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2681****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL158.cbl
  2682****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2683****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2684*****************************************************
  2685
  2686         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2687             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2688             20  CF-APPLICATION-FORCE       PIC X.
  2689             20  CF-INDIVIDUAL-APP.
  2690                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2691                     28  CF-BROWSE-APP      PIC X.
  2692                     28  CF-UPDATE-APP      PIC X.
  2693
  2694         16  CF-CURRENT-TERM-ON             PIC X(4).
  2695         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2696             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2697             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2698             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2699             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2700             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2701             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2702             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2703         16  CF-PROCESSOR-CARRIER           PIC X.
  2704             88  NO-CARRIER-SECURITY            VALUE ' '.
  2705         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2706             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2707         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2708             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2709         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2710             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2711
  2712         16  CF-PROC-SYS-ACCESS-SW.
  2713             20  CF-PROC-CREDIT-CLAIMS-SW.
  2714                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2715                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2716                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2717                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2718             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2719                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2720                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2721             20  CF-PROC-LIFE-GNRLDGR-SW.
  2722                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2723                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2724                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2725                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2726             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2727                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2728                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2729         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2730             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2731             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2732         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2733
  2734         16  CF-APPROVAL-LEVEL                  PIC X.
  2735             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2736             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2737             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2738             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2739
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL158.cbl
  2740         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2741
  2742         16  CF-LANGUAGE-TYPE                   PIC X.
  2743             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2744             88  CF-LANG-IS-FR                      VALUE 'F'.
  2745         16  FILLER                             PIC  X(240).
  2746
  2747****************************************************************
  2748*             PROCESSOR/REMINDERS RECORD                       *
  2749****************************************************************
  2750
  2751     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2752         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2753             20  CF-START-REMIND-DT         PIC XX.
  2754             20  CF-END-REMIND-DT           PIC XX.
  2755             20  CF-REMINDER-TEXT           PIC X(50).
  2756         16  FILLER                         PIC X(296).
  2757
  2758
  2759****************************************************************
  2760*             STATE MASTER RECORD                              *
  2761****************************************************************
  2762
  2763     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2764         16  CF-STATE-ABBREVIATION          PIC XX.
  2765         16  CF-STATE-NAME                  PIC X(25).
  2766         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2767         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2768             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2769             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2770             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2771             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2772                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2773                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2774             20  CF-ST-PREM-REJECT-SW       PIC X.
  2775                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2776                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2777             20  CF-ST-REF-REJECT-SW        PIC X.
  2778                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2779                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2780         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2781         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2782         16  CF-ST-REFUND-RULES.
  2783             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2784             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2785             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2786         16  CF-ST-FST-PMT-EXTENSION.
  2787             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2788             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2789                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2790                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2791                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2792                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2793         16  CF-ST-STATE-CALL.
  2794             20  CF-ST-CALL-UNEARNED        PIC X.
  2795             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2796             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2797         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL158.cbl
  2798             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2799             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2800         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2801         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2802         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2803         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2804         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2805         16  FILLER                         PIC X.
  2806         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2807             20  CF-ST-BENEFIT-CD           PIC XX.
  2808             20  CF-ST-BENEFIT-KIND         PIC X.
  2809                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2810                 88  CF-ST-AH-KIND              VALUE 'A'.
  2811             20  CF-ST-REM-TERM-CALC        PIC X.
  2812                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2813                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2814                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2815                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2816                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2817                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2818                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2819                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2820
  2821             20  CF-ST-REFUND-CALC          PIC X.
  2822                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2823                 88  ST-REFD-BY-R78             VALUE '1'.
  2824                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2825                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2826                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2827                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2828                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2829                 88  ST-REFD-UTAH               VALUE '7'.
  2830                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2831                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2832                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2833
  2834             20  CF-ST-EARNING-CALC         PIC X.
  2835                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2836                 88  ST-EARN-BY-R78             VALUE '1'.
  2837                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2838                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2839                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2840                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2841                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2842                 88  ST-EARN-MEAN               VALUE '8'.
  2843                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2844
  2845             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2846                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2847                 88  ST-OVRD-BY-R78             VALUE '1'.
  2848                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2849                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2850                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2851                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2852                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2853                 88  ST-OVRD-MEAN               VALUE '8'.
  2854                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2855             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL158.cbl
  2856
  2857         16  CF-ST-COMMISSION-CAPS.
  2858             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2859             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2860             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2861             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2862         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2863                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2864
  2865         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2866
  2867         16  CF-ST-STATUTORY-INTEREST.
  2868             20  CF-ST-STAT-DATE-FROM       PIC X.
  2869                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2870                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2871             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2872             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2873             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2874             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2875             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2876
  2877         16  CF-ST-OVER-SHORT.
  2878             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2879             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2880
  2881         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2882
  2883         16  CF-ST-RT-CALC                  PIC X.
  2884
  2885         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2886         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2887         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2888         16  CF-ST-RF-LR-CALC               PIC X.
  2889         16  CF-ST-RF-LL-CALC               PIC X.
  2890         16  CF-ST-RF-LN-CALC               PIC X.
  2891         16  CF-ST-RF-AH-CALC               PIC X.
  2892         16  CF-ST-RF-CP-CALC               PIC X.
  2893*        16  FILLER                         PIC X(206).
  2894*CIDMOD         16  FILLER                         PIC X(192).
  2895         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2896             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2897         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2898         16  FILLER                         PIC X(187).
  2899
  2900****************************************************************
  2901*             BENEFIT MASTER RECORD                            *
  2902****************************************************************
  2903
  2904     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2905         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2906             20  CF-BENEFIT-CODE            PIC XX.
  2907             20  CF-BENEFIT-NUMERIC  REDEFINES
  2908                 CF-BENEFIT-CODE            PIC XX.
  2909             20  CF-BENEFIT-ALPHA           PIC XXX.
  2910             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2911             20  CF-BENEFIT-COMMENT         PIC X(10).
  2912
  2913             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL158.cbl
  2914                 88  CF-REDUCING                VALUE 'R'.
  2915                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2916
  2917             20  CF-SPECIAL-CALC-CD         PIC X.
  2918                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2919                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2920                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2921                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2922                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2923                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2924                 88  CF-FARM-PLAN               VALUE 'F'.
  2925                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2926                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2927                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2928                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2929                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2930                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2931                 88  CF-PRUDENTIAL              VALUE 'P'.
  2932                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2933                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2934                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2935                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2936                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2937                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2938
  2939             20  CF-JOINT-INDICATOR         PIC X.
  2940                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2941
  2942*            20  FILLER                     PIC X(12).
  2943             20  FILLER                     PIC X(11).
  2944             20  CF-BENEFIT-CATEGORY        PIC X.
  2945             20  CF-LOAN-TYPE               PIC X(8).
  2946
  2947             20  CF-CO-REM-TERM-CALC        PIC X.
  2948                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2949                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2950                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2951                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2952                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2953
  2954             20  CF-CO-EARNINGS-CALC        PIC X.
  2955                 88  CO-EARN-BY-R78             VALUE '1'.
  2956                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2957                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2958                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2959                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2960                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2961                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2962                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2963
  2964             20  CF-CO-REFUND-CALC          PIC X.
  2965                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2966                 88  CO-REFD-BY-R78             VALUE '1'.
  2967                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2968                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2969                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2970                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2971                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL158.cbl
  2972                 88  CO-REFD-MEAN               VALUE '8'.
  2973                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2974                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2975                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2976
  2977             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2978                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2979                 88  CO-OVRD-BY-R78             VALUE '1'.
  2980                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2981                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2982                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2983                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2984                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2985                 88  CO-OVRD-MEAN               VALUE '8'.
  2986                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2987
  2988             20  CF-CO-BEN-I-G-CD           PIC X.
  2989                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2990                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2991                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2992
  2993         16  FILLER                         PIC X(304).
  2994
  2995
  2996****************************************************************
  2997*             CARRIER MASTER RECORD                            *
  2998****************************************************************
  2999
  3000     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3001         16  CF-ADDRESS-DATA.
  3002             20  CF-MAIL-TO-NAME            PIC X(30).
  3003             20  CF-IN-CARE-OF              PIC X(30).
  3004             20  CF-ADDRESS-LINE-1          PIC X(30).
  3005             20  CF-ADDRESS-LINE-2          PIC X(30).
  3006             20  CF-CITY-STATE              PIC X(30).
  3007             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3008             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3009
  3010         16  CF-CLAIM-NO-CONTROL.
  3011             20  CF-CLAIM-NO-METHOD         PIC X.
  3012                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3013                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3014                 88  CLAIM-NO-SEQ               VALUE '3'.
  3015                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3016             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3017                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3018                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3019                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3020
  3021         16  CF-CHECK-NO-CONTROL.
  3022             20  CF-CHECK-NO-METHOD         PIC X.
  3023                 88  CHECK-NO-MANUAL            VALUE '1'.
  3024                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3025                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3026                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3027             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3028                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3029
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL158.cbl
  3030         16  CF-DOMICILE-STATE              PIC XX.
  3031
  3032         16  CF-EXPENSE-CONTROLS.
  3033             20  CF-EXPENSE-METHOD          PIC X.
  3034                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3035                 88  DOLLARS-PER-PMT            VALUE '2'.
  3036                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3037                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3038             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3039             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3040
  3041         16  CF-CORRESPONDENCE-CONTROL.
  3042             20  CF-LETTER-RESEND-OPT       PIC X.
  3043                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3044                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3045             20  FILLER                     PIC X(4).
  3046
  3047         16  CF-RESERVE-CONTROLS.
  3048             20  CF-MANUAL-SW               PIC X.
  3049                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3050             20  CF-FUTURE-SW               PIC X.
  3051                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3052             20  CF-PTC-SW                  PIC X.
  3053                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3054             20  CF-IBNR-SW                 PIC X.
  3055                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3056             20  CF-PTC-LF-SW               PIC X.
  3057                 88  CF-LF-PTC-USED             VALUE '1'.
  3058             20  CF-CDT-ACCESS-METHOD       PIC X.
  3059                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3060                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3061                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3062             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3063
  3064         16  CF-CLAIM-CALC-METHOD           PIC X.
  3065             88  360-PLUS-MONTHS                VALUE '1'.
  3066             88  365-PLUS-MONTHS                VALUE '2'.
  3067             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3068             88  360-DAILY                      VALUE '4'.
  3069             88  365-DAILY                      VALUE '5'.
  3070
  3071         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3072         16  FILLER                         PIC X(11).
  3073
  3074         16  CF-LIMIT-AMOUNTS.
  3075             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3076             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3077             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3078             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3079             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3080             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3081             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3082             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3083             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3084             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3085
  3086         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3087         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL158.cbl
  3088         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3089
  3090         16  CF-ZIP-CODE.
  3091             20  CF-ZIP-PRIME.
  3092                 24  CF-ZIP-1ST             PIC X.
  3093                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3094                 24  FILLER                 PIC X(4).
  3095             20  CF-ZIP-PLUS4               PIC X(4).
  3096         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3097             20  CF-CAN-POSTAL-1            PIC XXX.
  3098             20  CF-CAN-POSTAL-2            PIC XXX.
  3099             20  FILLER                     PIC XXX.
  3100
  3101         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3102         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3103         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3104
  3105         16  CF-RATING-SWITCH               PIC X.
  3106             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3107             88  CF-NO-RATING                   VALUE 'N'.
  3108
  3109         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3110
  3111         16  CF-CARRIER-OVER-SHORT.
  3112             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3113             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3114
  3115         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3116         16  CF-SECPAY-SWITCH               PIC X.
  3117             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3118             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3119         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3120         16  FILLER                         PIC X(448).
  3121*        16  FILLER                         PIC X(452).
  3122
  3123
  3124****************************************************************
  3125*             MORTALITY MASTER RECORD                          *
  3126****************************************************************
  3127
  3128     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3129         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3130                                INDEXED BY CF-MORT-NDX.
  3131             20  CF-MORT-TABLE              PIC X(5).
  3132             20  CF-MORT-TABLE-TYPE         PIC X.
  3133                 88  CF-MORT-JOINT              VALUE 'J'.
  3134                 88  CF-MORT-SINGLE             VALUE 'S'.
  3135                 88  CF-MORT-COMBINED           VALUE 'C'.
  3136                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3137                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3138             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3139             20  CF-MORT-AGE-METHOD         PIC XX.
  3140                 88  CF-AGE-LAST                VALUE 'AL'.
  3141                 88  CF-AGE-NEAR                VALUE 'AN'.
  3142             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3143             20  CF-MORT-ADJUSTMENT-DIRECTION
  3144                                            PIC X.
  3145                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL158.cbl
  3146                 88  CF-PLUS                    VALUE '+'.
  3147             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3148             20  CF-MORT-JOINT-CODE         PIC X.
  3149                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3150             20  CF-MORT-PC-Q               PIC X.
  3151                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3152             20  CF-MORT-TABLE-CODE         PIC X(4).
  3153             20  CF-MORT-COMMENTS           PIC X(15).
  3154             20  FILLER                     PIC X(14).
  3155
  3156         16  FILLER                         PIC X(251).
  3157
  3158
  3159****************************************************************
  3160*             BUSSINESS TYPE MASTER RECORD                     *
  3161****************************************************************
  3162
  3163     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3164* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3165* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3166* AND RECORD 05 IS TYPES 81-99
  3167         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3168             20  CF-BUSINESS-TITLE          PIC  X(19).
  3169             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3170                                            PIC S9V9(4) COMP-3.
  3171             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3172             20  FILLER                     PIC  X.
  3173         16  FILLER                         PIC  X(248).
  3174
  3175
  3176****************************************************************
  3177*             TERMINAL MASTER RECORD                           *
  3178****************************************************************
  3179
  3180     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3181
  3182         16  CF-COMPANY-TERMINALS.
  3183             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3184                                  PIC X(4).
  3185         16  FILLER               PIC X(248).
  3186
  3187
  3188****************************************************************
  3189*             LIFE EDIT MASTER RECORD                          *
  3190****************************************************************
  3191
  3192     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3193         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3194             20  CF-LIFE-CODE-IN            PIC XX.
  3195             20  CF-LIFE-CODE-OUT           PIC XX.
  3196         16  FILLER                         PIC X(248).
  3197
  3198
  3199****************************************************************
  3200*             AH EDIT MASTER RECORD                            *
  3201****************************************************************
  3202
  3203     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL158.cbl
  3204         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3205             20  CF-AH-CODE-IN              PIC XXX.
  3206             20  CF-AH-CODE-OUT             PIC XX.
  3207         16  FILLER                         PIC X(248).
  3208
  3209
  3210****************************************************************
  3211*             CREDIBILITY TABLES                               *
  3212****************************************************************
  3213
  3214     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3215         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3216                             INDEXED BY CF-CRDB-NDX.
  3217             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3218             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3219             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3220         16  FILLER                         PIC  X(332).
  3221
  3222
  3223****************************************************************
  3224*             REPORT CUSTOMIZATION RECORD                      *
  3225****************************************************************
  3226
  3227     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3228         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3229             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3230             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3231             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3232**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3233****       A T-TRANSFER.                                   ****
  3234             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3235
  3236         16  FILLER                         PIC XX.
  3237
  3238         16  CF-CARRIER-CNTL-OPT.
  3239             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3240                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3241                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3242             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3243                                            PIC X.
  3244         16  CF-GROUP-CNTL-OPT.
  3245             20  CF-GROUP-OPT-SEQ           PIC 9.
  3246                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3247                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3248             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3249                                            PIC X(6).
  3250         16  CF-STATE-CNTL-OPT.
  3251             20  CF-STATE-OPT-SEQ           PIC 9.
  3252                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3253                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3254             20  CF-STATE-SELECT OCCURS 3 TIMES
  3255                                            PIC XX.
  3256         16  CF-ACCOUNT-CNTL-OPT.
  3257             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3258                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3259                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3260             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3261                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL158.cbl
  3262         16  CF-BUS-TYP-CNTL-OPT.
  3263             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3264                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3265                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3266             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3267                                            PIC XX.
  3268         16  CF-LF-TYP-CNTL-OPT.
  3269             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3270                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3271                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3272             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3273                                            PIC XX.
  3274         16  CF-AH-TYP-CNTL-OPT.
  3275             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3276                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3277                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3278             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3279                                            PIC XX.
  3280         16  CF-REPTCD1-CNTL-OPT.
  3281             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3282                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3283                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3284             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3285                                            PIC X(10).
  3286         16  CF-REPTCD2-CNTL-OPT.
  3287             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3288                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3289                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3290             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3291                                            PIC X(10).
  3292         16  CF-USER1-CNTL-OPT.
  3293             20  CF-USER1-OPT-SEQ           PIC 9.
  3294                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3295                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3296             20  CF-USER1-SELECT OCCURS 3 TIMES
  3297                                            PIC X(10).
  3298         16  CF-USER2-CNTL-OPT.
  3299             20  CF-USER2-OPT-SEQ           PIC 9.
  3300                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3301                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3302             20  CF-USER2-SELECT OCCURS 3 TIMES
  3303                                            PIC X(10).
  3304         16  CF-USER3-CNTL-OPT.
  3305             20  CF-USER3-OPT-SEQ           PIC 9.
  3306                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3307                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3308             20  CF-USER3-SELECT OCCURS 3 TIMES
  3309                                            PIC X(10).
  3310         16  CF-USER4-CNTL-OPT.
  3311             20  CF-USER4-OPT-SEQ           PIC 9.
  3312                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3313                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3314             20  CF-USER4-SELECT OCCURS 3 TIMES
  3315                                            PIC X(10).
  3316         16  CF-USER5-CNTL-OPT.
  3317             20  CF-USER5-OPT-SEQ           PIC 9.
  3318                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3319                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL158.cbl
  3320             20  CF-USER5-SELECT OCCURS 3 TIMES
  3321                                            PIC X(10).
  3322         16  CF-REINS-CNTL-OPT.
  3323             20  CF-REINS-OPT-SEQ           PIC 9.
  3324                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3325                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3326             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3327                 24  CF-REINS-PRIME         PIC XXX.
  3328                 24  CF-REINS-SUB           PIC XXX.
  3329
  3330         16  CF-AGENT-CNTL-OPT.
  3331             20  CF-AGENT-OPT-SEQ           PIC 9.
  3332                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3333                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3334             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3335                                            PIC X(10).
  3336
  3337         16  FILLER                         PIC X(43).
  3338
  3339         16  CF-LOSS-RATIO-SELECT.
  3340             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3341             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3342         16  CF-ENTRY-DATE-SELECT.
  3343             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3344             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3345         16  CF-EFFECTIVE-DATE-SELECT.
  3346             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3347             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3348
  3349         16  CF-EXCEPTION-LIST-IND          PIC X.
  3350             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3351
  3352         16  FILLER                         PIC X(318).
  3353
  3354****************************************************************
  3355*                  EXCEPTION REPORTING RECORD                  *
  3356****************************************************************
  3357
  3358     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3359         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3360             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3361
  3362         16  CF-COMBINED-LIFE-AH-OPT.
  3363             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3364             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3365             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3366             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3367
  3368         16  CF-LIFE-OPT.
  3369             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3370             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3371             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3372             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3373             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3374             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3375             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3376             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3377             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL158.cbl
  3378             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3379
  3380         16  CF-AH-OPT.
  3381             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3382             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3383             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3384             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3385             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3386             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3387             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3388             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3389             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3390             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3391
  3392         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3393             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3394             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3395             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3396
  3397         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3398
  3399         16  FILLER                         PIC X(673).
  3400
  3401
  3402****************************************************************
  3403*             MORTGAGE SYSTEM PLAN RECORD                      *
  3404****************************************************************
  3405
  3406     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3407         16  CF-PLAN-TYPE                   PIC X.
  3408             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3409             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3410             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3411         16  CF-PLAN-ABBREV                 PIC XXX.
  3412         16  CF-PLAN-DESCRIPT               PIC X(10).
  3413         16  CF-PLAN-NOTES                  PIC X(20).
  3414         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3415         16  CF-PLAN-UNDERWRITING.
  3416             20  CF-PLAN-TERM-DATA.
  3417                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3418                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3419             20  CF-PLAN-AGE-DATA.
  3420                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3421                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3422                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3423             20  CF-PLAN-BENEFIT-DATA.
  3424                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3425                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3426                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3427                                            PIC S9(7)V99  COMP-3.
  3428         16  CF-PLAN-POLICY-FORMS.
  3429             20  CF-POLICY-FORM             PIC X(12).
  3430             20  CF-MASTER-APPLICATION      PIC X(12).
  3431             20  CF-MASTER-POLICY           PIC X(12).
  3432         16  CF-PLAN-RATING.
  3433             20  CF-RATE-CODE               PIC X(5).
  3434             20  CF-SEX-RATING              PIC X.
  3435                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL158.cbl
  3436                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3437             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3438             20  CF-SUB-STD-TYPE            PIC X.
  3439                 88  CF-PCT-OF-PREM            VALUE '1'.
  3440                 88  CF-PCT-OF-BENE            VALUE '2'.
  3441         16  CF-PLAN-PREM-TOLERANCES.
  3442             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3443             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3444         16  CF-PLAN-PYMT-TOLERANCES.
  3445             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3446             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3447         16  CF-PLAN-MISC-DATA.
  3448             20  FILLER                     PIC X.
  3449             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3450             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3451         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3452         16  CF-PLAN-IND-GRP                PIC X.
  3453             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3454                                                     '1'.
  3455             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3456                                                     '2'.
  3457         16  CF-MIB-SEARCH-SW               PIC X.
  3458             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3459             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3460             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3461             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3462         16  CF-ALPHA-SEARCH-SW             PIC X.
  3463             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3464             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3465             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3466             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3467             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3468             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3469             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3470             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3471             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3472             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3473                                                     'A' 'B' 'C'
  3474                                                     'X' 'Y' 'Z'.
  3475         16  CF-EFF-DT-RULE-SW              PIC X.
  3476             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3477             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3478             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3479             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3480             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3481         16  FILLER                         PIC X(4).
  3482         16  CF-HEALTH-QUESTIONS            PIC X.
  3483             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3484         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3485         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3486         16  CF-PLAN-SNGL-JNT               PIC X.
  3487             88  CF-COMBINED-PLAN              VALUE 'C'.
  3488             88  CF-JNT-PLAN                   VALUE 'J'.
  3489             88  CF-SNGL-PLAN                  VALUE 'S'.
  3490         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3491         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3492         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3493         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL158.cbl
  3494         16  CF-RERATE-CNTL                 PIC  X.
  3495             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3496             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3497             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3498             88  CF-AUTO-RECALC                 VALUE '4'.
  3499         16  CF-BENEFIT-TYPE                PIC  X.
  3500             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3501             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3502         16  CF-POLICY-FEE                  PIC S999V99
  3503                                                    COMP-3.
  3504         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3505         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3506         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3507         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3508         16  FILLER                         PIC  X(32).
  3509         16  CF-TERMINATION-FORM            PIC  X(04).
  3510         16  FILLER                         PIC  X(08).
  3511         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3512                                                       COMP-3.
  3513         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3514         16  CF-ISSUE-LETTER                PIC  X(4).
  3515         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3516         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3517             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3518             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3519         16  CF-MP-REFUND-CALC              PIC X.
  3520             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3521             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3522             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3523             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3524             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3525             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3526             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3527             88  CF-MP-REFD-MEAN                VALUE '8'.
  3528         16  CF-ALT-RATE-CODE               PIC  X(5).
  3529
  3530
  3531         16  FILLER                         PIC X(498).
  3532****************************************************************
  3533*             MORTGAGE COMPANY MASTER RECORD                   *
  3534****************************************************************
  3535
  3536     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3537         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3538         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3539             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3540             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3541             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3542             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3543             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3544
  3545         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3546         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3547         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3548         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3549         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3550
  3551         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL158.cbl
  3552             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3553         16  CF-MP-RECON-USE-IND            PIC X(1).
  3554             88  CF-MP-USE-RECON             VALUE 'Y'.
  3555         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3556             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3557         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3558             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3559             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3560         16  FILLER                         PIC X(1).
  3561         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3562             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3563         16  CF-MORTG-MIB-VERSION           PIC X.
  3564             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3565             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3566             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3567         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3568             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3569                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3570             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3571                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3572             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3573                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3574             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3575                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3576             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3577                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3578             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3579                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3580         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3581         16  FILLER                         PIC X(7).
  3582         16  CF-MORTG-DESTINATION-SYMBOL.
  3583             20  CF-MORTG-MIB-COMM          PIC X(5).
  3584             20  CF-MORTG-MIB-TERM          PIC X(5).
  3585         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3586             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3587         16  FILLER                         PIC X(03).
  3588         16  CF-MP-CHECK-NO-CONTROL.
  3589             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3590                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3591                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3592                                                ' ' LOW-VALUES.
  3593                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3594                                               VALUE '3'.
  3595         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3596         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3597         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3598             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3599                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3600             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3601                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3602             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3603                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3604             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3605                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3606             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3607                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3608             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3609                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL158.cbl
  3610         16  CF-MORTG-BILLING-AREA.
  3611             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3612                                            PIC X.
  3613         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3614         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3615         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3616         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3617             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3618             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3619         16  FILLER                         PIC X.
  3620         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3621             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3622             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3623         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3624         16  FILLER                         PIC X(8).
  3625         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3626         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3627         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3628         16  CF-ACH-COMPANY-ID.
  3629             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3630                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3631                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3632                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3633             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3634         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3635             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3636         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3637             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3638             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3639         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3640         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3641         16  FILLER                         PIC X(536).
  3642
  3643****************************************************************
  3644*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3645****************************************************************
  3646
  3647     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3648         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3649             20  CF-FEMALE-HEIGHT.
  3650                 24  CF-FEMALE-FT           PIC 99.
  3651                 24  CF-FEMALE-IN           PIC 99.
  3652             20  CF-FEMALE-MIN-WT           PIC 999.
  3653             20  CF-FEMALE-MAX-WT           PIC 999.
  3654         16  FILLER                         PIC X(428).
  3655
  3656     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3657         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3658             20  CF-MALE-HEIGHT.
  3659                 24  CF-MALE-FT             PIC 99.
  3660                 24  CF-MALE-IN             PIC 99.
  3661             20  CF-MALE-MIN-WT             PIC 999.
  3662             20  CF-MALE-MAX-WT             PIC 999.
  3663         16  FILLER                         PIC X(428).
  3664******************************************************************
  3665*             AUTOMATIC ACTIVITY RECORD                          *
  3666******************************************************************
  3667     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL158.cbl
  3668         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3669             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3670             20  CF-SYS-LETTER-ID           PIC X(04).
  3671             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3672             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3673             20  CF-SYS-RESET-SW            PIC X(01).
  3674             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3675             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3676
  3677         16  FILLER                         PIC X(50).
  3678
  3679         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3680             20  CF-USER-ACTIVE-SW          PIC X(01).
  3681             20  CF-USER-LETTER-ID          PIC X(04).
  3682             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3683             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3684             20  CF-USER-RESET-SW           PIC X(01).
  3685             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3686             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3687             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3688
  3689         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL158.cbl
  3691 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA FORM-MASTER
  3692                          CONTROL-FILE.
  3693 0000-DFHEXIT SECTION.
  3694     MOVE '9#                    $   ' TO DFHEIV0.
  3695     MOVE 'EL158' TO DFHEIV1.
  3696     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3697
  3698     MOVE EIBDATE                    TO  DC-JULIAN-YYDDD.
  3699     MOVE '5'                        TO  DC-OPTION-CODE.
  3700     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  3701     MOVE DC-GREG-DATE-1-EDIT        TO  SAVE-DATE.
  3702     MOVE DC-BIN-DATE-1              TO  SAVE-BIN-DATE.
  3703
  3704     MOVE DFHCOMMAREA                TO  PROGRAM-INTERFACE-BLOCK.
  3705     IF EIBCALEN EQUAL 0
  3706         GO TO 8800-UNAUTHORIZED-ACCESS.
  3707
  3708     MOVE PI-LIFE-OVERRIDE-L6        TO  EMI-LIFE-OVERRIDE-L6.
  3709     MOVE PI-AH-OVERRIDE-L6          TO  EMI-AH-OVERRIDE-L6.
  3710
  3711
  3712* EXEC CICS HANDLE CONDITION
  3713*        DUPREC     (8850-DUPREC)
  3714*        NOTOPEN    (8870-NOTOPEN)
  3715*        NOTFND     (8880-NOT-FOUND)
  3716*        PGMIDERR   (9600-PGMID-ERROR)
  3717*        ERROR      (9990-ABEND)
  3718*    END-EXEC.
  3719*    MOVE '"$%JIL.               ! " #00003707' TO DFHEIV0
  3720     MOVE X'2224254A494C2E2020202020' TO DFHEIV0(1:12)
  3721     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3722     MOVE X'2220233030303033373037' TO DFHEIV0(25:11)
  3723     CALL 'kxdfhei1' USING DFHEIV0
  3724     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3725
  3726
  3727     IF EIBTRNID NOT = EL150-TRANS-ID
  3728        GO TO 0150-SET-PROGRAM-SAVES.
  3729
  3730     MOVE PI-COMPANY-CD              TO ERFORM-COMPANY-CD.
  3731     MOVE PI-FORM-NUMBER             TO ERFORM-FORM-ID.
  3732     MOVE PI-STATE                   TO ERFORM-STATE.
  3733     MOVE PI-CERT-EFF-DT             TO ERFORM-EXP-DT.
  3734
  3735
  3736* EXEC CICS HANDLE CONDITION
  3737*        NOTFND     (0100-FORM-NOTFND)
  3738*    END-EXEC.
  3739*    MOVE '"$I                   ! # #00003723' TO DFHEIV0
  3740     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  3741     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3742     MOVE X'2320233030303033373233' TO DFHEIV0(25:11)
  3743     CALL 'kxdfhei1' USING DFHEIV0
  3744     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3745
  3746
  3747
  3748* EXEC CICS READ
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL158.cbl
  3749*        DATASET    (ERFORM-FILE-ID)
  3750*        SET        (ADDRESS OF FORM-MASTER)
  3751*        RIDFLD     (ERFORM-KEY)
  3752*        GTEQ
  3753*    END-EXEC.
  3754*    MOVE '&"S        G          (   #00003727' TO DFHEIV0
  3755     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3756     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3757     MOVE X'2020233030303033373237' TO DFHEIV0(25:11)
  3758     CALL 'kxdfhei1' USING DFHEIV0,
  3759           ERFORM-FILE-ID,
  3760           DFHEIV20,
  3761           DFHEIV99,
  3762           ERFORM-KEY,
  3763           DFHEIV99,
  3764           DFHEIV99,
  3765           DFHEIV99
  3766     SET ADDRESS OF FORM-MASTER TO
  3767         DFHEIV20
  3768     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3769
  3770
  3771     IF PI-COMPANY-CD       =  FO-COMPANY-CD
  3772        AND FO-STATE        =  FO-STATE
  3773        AND FO-FORM-ID      =  ERFORM-FORM-ID
  3774        GO TO 0150-SET-PROGRAM-SAVES.
  3775
  3776 0100-FORM-NOTFND.
  3777
  3778     MOVE XCTL-155                   TO  PGM-NAME.
  3779     GO TO 9300-XCTL.
  3780
  3781 0150-SET-PROGRAM-SAVES.
  3782
  3783     IF PI-CALLING-PROGRAM NOT EQUAL THIS-PGM
  3784         IF PI-RETURN-TO-PROGRAM NOT EQUAL THIS-PGM
  3785             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  3786             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  3787             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  3788             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  3789             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  3790             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  3791             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  3792             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  3793         ELSE
  3794             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  3795             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  3796             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  3797             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  3798             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  3799             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  3800             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  3801             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  3802     ELSE
  3803         GO TO 0200-RECEIVE.
  3804
  3805     IF EIBTRNID = EL150-TRANS-ID
  3806        MOVE 'I'                     TO MAINTI
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL158.cbl
  3807        MOVE +1                      TO MAINTL
  3808        MOVE DFHENTER                TO EIBAID
  3809        MOVE PI-STATE                TO STATEI
  3810        MOVE +2                      TO STATEL
  3811        MOVE PI-FORM-NUMBER          TO FORMI
  3812        MOVE +12                     TO FORML
  3813        MOVE FO-FORM-EXP-DT          TO DC-BIN-DATE-1
  3814        MOVE ' '                     TO DC-OPTION-CODE
  3815        MOVE +0                      TO DC-ELAPSED-DAYS
  3816                                        DC-ELAPSED-MONTHS
  3817        PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  3818        IF NO-CONVERSION-ERROR
  3819           MOVE DC-GREG-DATE-1-EDIT  TO EXPDTO
  3820           GO TO 1000-SHOW-FORM-RECORD
  3821        ELSE
  3822           MOVE LOW-VALUES           TO EXPDTO
  3823           GO TO 1000-SHOW-FORM-RECORD.
  3824
  3825     MOVE SPACES                     TO  PI-PROGRAM-WORK-AREA.
  3826     MOVE LOW-VALUES                 TO  EL158AO.
  3827     MOVE -1                         TO  MAINTL.
  3828     GO TO 8100-SEND-INITIAL-MAP.
  3829
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL158.cbl
  3831 0200-RECEIVE.
  3832
  3833     IF EIBAID IS EQUAL TO DFHCLEAR
  3834         GO TO 9400-CLEAR.
  3835
  3836     IF EIBAID EQUAL DFHPA1 OR DFHPA2 OR DFHPA3
  3837         MOVE LOW-VALUES             TO  EL158AI
  3838         MOVE ER-7008                TO  EMI-ERROR
  3839         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3840         MOVE -1                     TO  MAINTL
  3841         GO TO 8200-SEND-DATAONLY.
  3842
  3843     IF PI-PROCESSOR-ID EQUAL 'LGXX'
  3844         NEXT SENTENCE
  3845     ELSE
  3846
  3847* EXEC CICS READQ TS
  3848*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  3849*            INTO   (SECURITY-CONTROL)
  3850*            LENGTH (SC-COMM-LENGTH)
  3851*            ITEM   (SC-ITEM)
  3852*        END-EXEC
  3853*    MOVE '*$II   L              ''   #00003809' TO DFHEIV0
  3854     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  3855     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3856     MOVE X'2020233030303033383039' TO DFHEIV0(25:11)
  3857     CALL 'kxdfhei1' USING DFHEIV0,
  3858           PI-SECURITY-TEMP-STORE-ID,
  3859           SECURITY-CONTROL,
  3860           SC-COMM-LENGTH,
  3861           SC-ITEM,
  3862           DFHEIV99,
  3863           DFHEIV99
  3864     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3865         MOVE SC-CLAIMS-DISPLAY (4)  TO  PI-DISPLAY-CAP
  3866         MOVE SC-CLAIMS-UPDATE  (4)  TO  PI-MODIFY-CAP.
  3867
  3868
  3869* EXEC CICS RECEIVE
  3870*        MAP      (WS-MAP-NAME)
  3871*        MAPSET   (MAPSET-NAME)
  3872*        INTO     (EL158AI)
  3873*    END-EXEC.
  3874     MOVE LENGTH OF
  3875      EL158AI
  3876       TO DFHEIV11
  3877*    MOVE '8"T I  L              ''   #00003818' TO DFHEIV0
  3878     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3879     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3880     MOVE X'2020233030303033383138' TO DFHEIV0(25:11)
  3881     CALL 'kxdfhei1' USING DFHEIV0,
  3882           WS-MAP-NAME,
  3883           EL158AI,
  3884           DFHEIV11,
  3885           MAPSET-NAME,
  3886           DFHEIV99,
  3887           DFHEIV99
  3888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL158.cbl
  3889
  3890
  3891     IF PFKEYL IS EQUAL TO +0
  3892         GO TO 0300-CHECK-PFKEYS.
  3893
  3894     IF (PFKEYI NUMERIC) AND (PFKEYI GREATER 0 AND LESS 25)
  3895         MOVE PF-VALUES (PFKEYI)     TO  EIBAID
  3896     ELSE
  3897         MOVE ER-0029                TO  EMI-ERROR
  3898         GO TO 0320-INPUT-ERROR.
  3899
  3900
  3901 0300-CHECK-PFKEYS.
  3902
  3903     IF EIBAID EQUAL DFHPF23
  3904         GO TO 8810-PF23.
  3905
  3906     IF EIBAID EQUAL DFHPF24
  3907         GO TO 9200-RETURN-MAIN-MENU.
  3908
  3909     IF EIBAID EQUAL DFHPF12
  3910         GO TO 9500-PF12.
  3911
  3912     IF (MAINTL NOT EQUAL 0) AND (EIBAID NOT EQUAL DFHENTER)
  3913         MOVE ER-0050            TO EMI-ERROR
  3914         GO TO 0320-INPUT-ERROR.
  3915
  3916     IF EIBAID EQUAL DFHPF1
  3917         GO TO 5000-FIND-NEXT-FORM-RECORD.
  3918
  3919     IF EIBAID EQUAL DFHPF2
  3920         GO TO 5100-FIND-PREV-FORM-RECORD.
  3921
  3922     IF EIBAID EQUAL DFHPF3
  3923         GO TO 5200-FIND-NEXT-BENEFIT.
  3924
  3925     IF EIBAID EQUAL DFHPF4
  3926         GO TO 5200-FIND-PREV-BENEFIT.
  3927
  3928     IF EIBAID EQUAL DFHENTER
  3929         GO TO 0330-EDIT-DATA.
  3930
  3931     MOVE ER-0029                    TO  EMI-ERROR.
  3932
  3933 0320-INPUT-ERROR.
  3934
  3935     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3936     MOVE AL-UNBON                   TO  PFKEYA.
  3937     MOVE -1                         TO  PFKEYL.
  3938     GO TO 8200-SEND-DATAONLY.
  3939
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL158.cbl
  3941 0330-EDIT-DATA.
  3942
  3943     IF NOT DISPLAY-CAP
  3944         MOVE 'READ'                 TO  SM-READ
  3945         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3946         MOVE ER-0070                TO  EMI-ERROR
  3947         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3948         MOVE -1                     TO  MAINTL
  3949         GO TO 8100-SEND-INITIAL-MAP.
  3950
  3951     IF (STATEL GREATER THAN +0 AND
  3952         FORML  GREATER THAN +0 AND
  3953         EXPDTL GREATER THAN +0)
  3954         NEXT SENTENCE
  3955     ELSE
  3956         IF (MAINTI    EQUAL   'S'   AND
  3957             EXPDTL    EQUAL   +0)
  3958             GO TO 1000-SHOW-FORM-RECORD
  3959         ELSE
  3960             MOVE ER-0754                TO  EMI-ERROR
  3961             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3962             MOVE -1                     TO  STATEL
  3963             MOVE AL-UABON               TO  STATEA
  3964                                         FORMA
  3965                                         EXPDTA
  3966             GO TO 8200-SEND-DATAONLY.
  3967
  3968
  3969     IF MAINTI EQUAL 'S'
  3970         GO TO 1000-SHOW-FORM-RECORD.
  3971
  3972     IF MAINTI EQUAL 'A' OR 'C' OR 'D'
  3973        IF NOT MODIFY-CAP
  3974            PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3975            MOVE ER-0070             TO  EMI-ERROR
  3976            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3977            MOVE LOW-VALUES          TO  EL158AO
  3978            MOVE -1                  TO  MAINTL
  3979            GO TO 8100-SEND-INITIAL-MAP.
  3980
  3981     IF MAINTI EQUAL 'C'
  3982         GO TO 2000-CHANGE-FORM-RECORD.
  3983
  3984     IF MAINTI EQUAL 'A'
  3985         GO TO 3000-ADD-FORM-RECORD.
  3986
  3987     IF MAINTI EQUAL 'D'
  3988         GO TO 4000-DELETE-FORM-RECORD.
  3989
  3990     MOVE ER-0023                    TO  EMI-ERROR.
  3991     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3992     MOVE -1                         TO  MAINTL.
  3993     MOVE AL-UABON                   TO  MAINTA.
  3994     GO TO 8200-SEND-DATAONLY.
  3995
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL158.cbl
  3997 1000-SHOW-FORM-RECORD.
  3998
  3999     MOVE PI-COMPANY-CD              TO  ERFORM-COMPANY-CD.
  4000     MOVE STATEI                     TO  ERFORM-STATE.
  4001     MOVE FORMI                      TO  ERFORM-FORM-ID.
  4002
  4003     IF (MAINTI    EQUAL   'S'  AND
  4004         EXPDTL    EQUAL   +0)
  4005         MOVE  HIGH-VALUES           TO  ERFORM-EXP-DT
  4006         GO TO 1000-CONTINUE.
  4007
  4008     MOVE EXPDTI                     TO  DEEDIT-FIELD.
  4009     PERFORM 8600-DEEDIT THRU 8600-EXIT.
  4010     IF DEEDIT-FIELD-V0 IS NOT LESS THAN 999999
  4011         MOVE HIGH-VALUES            TO  ERFORM-EXP-DT
  4012     ELSE
  4013         MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY
  4014         MOVE '4'                    TO  DC-OPTION-CODE
  4015         MOVE +0                     TO  DC-ELAPSED-DAYS
  4016                                         DC-ELAPSED-MONTHS
  4017         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4018         IF NO-CONVERSION-ERROR
  4019             MOVE DC-BIN-DATE-1      TO  ERFORM-EXP-DT
  4020         ELSE
  4021             MOVE LOW-VALUES         TO  ERFORM-EXP-DT.
  4022
  4023 1000-CONTINUE.
  4024
  4025
  4026* EXEC CICS HANDLE CONDITION
  4027*        NOTFND     (1000-FORM-NOTFND)
  4028*    END-EXEC.
  4029*    MOVE '"$I                   ! $ #00003958' TO DFHEIV0
  4030     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4031     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4032     MOVE X'2420233030303033393538' TO DFHEIV0(25:11)
  4033     CALL 'kxdfhei1' USING DFHEIV0
  4034     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4035
  4036
  4037
  4038* EXEC CICS READ
  4039*        DATASET    (ERFORM-FILE-ID)
  4040*        SET        (ADDRESS OF FORM-MASTER)
  4041*        RIDFLD     (ERFORM-KEY)
  4042*    END-EXEC.
  4043*    MOVE '&"S        E          (   #00003962' TO DFHEIV0
  4044     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4045     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4046     MOVE X'2020233030303033393632' TO DFHEIV0(25:11)
  4047     CALL 'kxdfhei1' USING DFHEIV0,
  4048           ERFORM-FILE-ID,
  4049           DFHEIV20,
  4050           DFHEIV99,
  4051           ERFORM-KEY,
  4052           DFHEIV99,
  4053           DFHEIV99,
  4054           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL158.cbl
  4055     SET ADDRESS OF FORM-MASTER TO
  4056         DFHEIV20
  4057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4058
  4059
  4060     GO TO 7000-BUILD-OUTPUT-MAP.
  4061
  4062 1000-FORM-NOTFND.
  4063
  4064      MOVE ER-0418                   TO  EMI-ERROR.
  4065      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4066      MOVE -1                        TO  MAINTL.
  4067      MOVE AL-UABON                  TO  STATEA
  4068                                         FORMA
  4069                                         EXPDTA.
  4070
  4071     IF EIBTRNID = EL150-TRANS-ID
  4072        GO TO 8100-SEND-INITIAL-MAP
  4073     ELSE
  4074        GO TO 8200-SEND-DATAONLY.
  4075
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL158.cbl
  4077 2000-CHANGE-FORM-RECORD.
  4078
  4079     MOVE EXPDTI                     TO  DEEDIT-FIELD.
  4080     PERFORM 8600-DEEDIT THRU 8600-EXIT.
  4081     IF DEEDIT-FIELD-V0 IS NOT LESS THAN 999999
  4082         MOVE HIGH-VALUES            TO  WS-EXP-DT
  4083     ELSE
  4084         MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY
  4085         MOVE '4'                    TO  DC-OPTION-CODE
  4086         MOVE +0                     TO  DC-ELAPSED-DAYS
  4087                                         DC-ELAPSED-MONTHS
  4088         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4089         MOVE DC-BIN-DATE-1          TO  WS-EXP-DT.
  4090
  4091     IF MAINTI = 'C'
  4092        IF (STATEI IS EQUAL TO PI-PREV-STATE AND
  4093           FORMI  IS EQUAL TO PI-PREV-FORM-ID) AND
  4094           (WS-EXP-DT NOT EQUAL TO PI-PREV-EXP-DT)
  4095            MOVE ER-0717                TO  EMI-ERROR
  4096            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4097            MOVE -1                     TO  MAINTL
  4098            MOVE AL-UABON               TO  STATEA
  4099                                         FORMA
  4100                                         EXPDTA
  4101            GO TO 8200-SEND-DATAONLY.
  4102
  4103     IF STATEI IS EQUAL TO PI-PREV-STATE AND
  4104        FORMI  IS EQUAL TO PI-PREV-FORM-ID AND
  4105        WS-EXP-DT IS EQUAL TO PI-PREV-EXP-DT
  4106         NEXT SENTENCE
  4107     ELSE
  4108         MOVE ER-0138                TO  EMI-ERROR
  4109         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4110         MOVE -1                     TO  MAINTL
  4111         MOVE AL-UABON               TO  STATEA
  4112                                         FORMA
  4113                                         EXPDTA
  4114         GO TO 8200-SEND-DATAONLY.
  4115
  4116     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT.
  4117
  4118     IF NOT EMI-NO-ERRORS
  4119         GO TO 8200-SEND-DATAONLY.
  4120
  4121     MOVE PI-COMPANY-CD              TO  ERFORM-COMPANY-CD.
  4122     MOVE STATEI                     TO  ERFORM-STATE
  4123                                         PI-STATE-CODE.
  4124     MOVE FORMI                      TO  ERFORM-FORM-ID
  4125                                         PI-FORM-ID.
  4126     MOVE EXPDTI                     TO  DEEDIT-FIELD.
  4127     PERFORM 8600-DEEDIT THRU 8600-EXIT.
  4128     IF DEEDIT-FIELD-V0 IS NOT LESS THAN 999999
  4129         MOVE HIGH-VALUES            TO  ERFORM-EXP-DT
  4130         MOVE '99/99/99'             TO  PI-EXP-DT
  4131     ELSE
  4132         MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY
  4133         MOVE '4'                    TO  DC-OPTION-CODE
  4134         MOVE +0                     TO  DC-ELAPSED-DAYS
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL158.cbl
  4135                                         DC-ELAPSED-MONTHS
  4136         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4137         IF NO-CONVERSION-ERROR
  4138             MOVE DC-BIN-DATE-1      TO  ERFORM-EXP-DT
  4139             MOVE DC-GREG-DATE-1-EDIT TO PI-EXP-DT
  4140         ELSE
  4141             MOVE LOW-VALUES         TO  ERFORM-EXP-DT
  4142                                         PI-EXP-DT.
  4143
  4144
  4145* EXEC CICS READ
  4146*        DATASET    (ERFORM-FILE-ID)
  4147*        SET        (ADDRESS OF FORM-MASTER)
  4148*        RIDFLD     (ERFORM-KEY)
  4149*        UPDATE
  4150*    END-EXEC.
  4151*    MOVE '&"S        EU         (   #00004052' TO DFHEIV0
  4152     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4153     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4154     MOVE X'2020233030303034303532' TO DFHEIV0(25:11)
  4155     CALL 'kxdfhei1' USING DFHEIV0,
  4156           ERFORM-FILE-ID,
  4157           DFHEIV20,
  4158           DFHEIV99,
  4159           ERFORM-KEY,
  4160           DFHEIV99,
  4161           DFHEIV99,
  4162           DFHEIV99
  4163     SET ADDRESS OF FORM-MASTER TO
  4164         DFHEIV20
  4165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4166
  4167
  4168     IF FO-LAST-MAINT-BY     NOT EQUAL PI-UPDATE-BY OR
  4169        FO-LAST-MAINT-HHMMSS NOT EQUAL PI-UPDATE-HHMMSS
  4170
  4171* EXEC CICS UNLOCK
  4172*            DATASET   (ERFORM-FILE-ID)
  4173*        END-EXEC
  4174*    MOVE '&*                    #   #00004061' TO DFHEIV0
  4175     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4176     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4177     MOVE X'2020233030303034303631' TO DFHEIV0(25:11)
  4178     CALL 'kxdfhei1' USING DFHEIV0,
  4179           ERFORM-FILE-ID,
  4180           DFHEIV99
  4181     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4182         MOVE ER-0068                TO  EMI-ERROR
  4183         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4184         GO TO 1000-SHOW-FORM-RECORD.
  4185
  4186*    MOVE 'B'                        TO  JP-RECORD-TYPE.
  4187*    MOVE FORM-MASTER                TO  JP-RECORD-AREA.
  4188*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4189
  4190     MOVE PI-PROCESSOR-ID            TO  FO-LAST-MAINT-BY.
  4191     MOVE EIBTIME                    TO  FO-LAST-MAINT-HHMMSS.
  4192     MOVE SAVE-BIN-DATE              TO  FO-LAST-MAINT-DT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL158.cbl
  4193
  4194     IF INDGRPL IS GREATER THAN +0
  4195         MOVE INDGRPI                TO  FO-IND-GRP-CD.
  4196
  4197     IF MAXATTL IS GREATER THAN +0
  4198         MOVE MAXATTI                TO  FO-MAX-ATT-AGE.
  4199
  4200     IF LFMINL IS GREATER THAN +0
  4201         MOVE LFMINI                 TO  FO-LF-MIN-ISSUE-AGE.
  4202
  4203     IF LFMAXL IS GREATER THAN +0
  4204         MOVE LFMAXI                 TO  FO-LF-MAX-ISSUE-AGE.
  4205
  4206     IF LFTRML IS GREATER THAN +0
  4207         MOVE LFTRMI                 TO  FO-LF-MAX-TERM.
  4208
  4209     IF LFAMTL IS GREATER THAN +0
  4210         MOVE LFAMTI                 TO  DEEDIT-FIELD-V2
  4211         PERFORM 8600-DEEDIT THRU 8600-EXIT
  4212         MOVE DEEDIT-FIELD-V2        TO  FO-MAX-LF-AMT.
  4213
  4214     IF FO-MAX-LF-AMT = +0
  4215        MOVE +0                      TO  FO-LF-MIN-ISSUE-AGE
  4216                                         FO-LF-MAX-ISSUE-AGE
  4217                                         FO-LF-MAX-TERM.
  4218
  4219     IF LFPREL IS GREATER THAN +0
  4220         MOVE LFPREI                 TO FO-LF-PRE-EXIST-EXCL-TYPE.
  4221
  4222     IF SUICIDEL IS GREATER THAN +0
  4223         MOVE SUICIDEI               TO  FO-SUICIDE-EXCL-TYPE.
  4224
  4225     IF DEFTYPL IS GREATER THAN +0
  4226         MOVE DEFTYPI                TO  FO-DIS-DEF-TYPE.
  4227
  4228     IF DISMCDL IS GREATER THAN +0
  4229         MOVE DISMCDI                TO  FO-DISMEMBERMENT-CD.
  4230
  4231     IF CRTAPPL IS GREATER THAN +0
  4232         MOVE CRTAPPI                TO  FO-APP-CERT-USE-CD.
  4233
  4234     IF AHMINL IS GREATER THAN +0
  4235         MOVE AHMINI                 TO  FO-AH-MIN-ISSUE-AGE.
  4236
  4237     IF AHMAXL IS GREATER THAN +0
  4238         MOVE AHMAXI                 TO  FO-AH-MAX-ISSUE-AGE.
  4239
  4240     IF AHTRML IS GREATER THAN +0
  4241         MOVE AHTRMI                 TO  FO-AH-MAX-TERM.
  4242
  4243     IF AHAMTL IS GREATER THAN +0
  4244         MOVE AHAMTI                 TO  DEEDIT-FIELD-V2
  4245         PERFORM 8600-DEEDIT THRU 8600-EXIT
  4246         MOVE DEEDIT-FIELD-V2        TO  FO-MAX-AH-AMT.
  4247
  4248     IF FO-MAX-AH-AMT = +0
  4249        MOVE +0                      TO  FO-AH-MIN-ISSUE-AGE
  4250                                         FO-AH-MAX-ISSUE-AGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL158.cbl
  4251                                         FO-AH-MAX-TERM.
  4252
  4253     IF AHPREL IS GREATER THAN +0
  4254         MOVE AHPREI                 TO FO-AH-PRE-EXIST-EXCL-TYPE.
  4255
  4256     IF DESCL IS GREATER THAN +0
  4257         MOVE DESCI                  TO  FO-COMMENT-LINE-1.
  4258
  4259         MOVE +0                     TO  SUB.
  4260     IF EL158-BENE-INIT (1) EQUAL TO WS-INIT-VALUE (21)
  4261         MOVE EL158-BENE-INIT (1) TO WS158-BENE-INIT
  4262         MOVE +20                    TO SUB2
  4263     ELSE
  4264         MOVE +0                     TO SUB2.
  4265
  4266 2000-CHANGE-BENEFIT-LOOP.
  4267
  4268     ADD +1                          TO  SUB.
  4269     ADD +1                          TO  SUB2.
  4270     IF SUB IS GREATER THAN +20
  4271         GO TO 2000-CONTINUE-CHANGE.
  4272
  4273     IF EL158-BENE-LENGTH (SUB) IS GREATER THAN +0
  4274         MOVE EL158-BENE-TYPE (SUB)  TO  FO-PLAN-TYPE (SUB2)
  4275         MOVE EL158-BENE-ID   (SUB)  TO  FO-PLAN-ID   (SUB2).
  4276
  4277     IF EL158-BENE-TERM-LENGTH (SUB) IS GREATER THAN +0
  4278         MOVE EL158-BENE-TERM (SUB)  TO  FO-PLAN-TERM (SUB2).
  4279
  4280     IF EL158-BENE-REFM-LENGTH (SUB) IS GREATER THAN +0
  4281         MOVE EL158-BENE-REFM (SUB)
  4282                              TO FO-PLAN-REFUND-METHOD (SUB2).
  4283
  4284     GO TO 2000-CHANGE-BENEFIT-LOOP.
  4285
  4286 2000-CONTINUE-CHANGE.
  4287*    MOVE 'C'                        TO  JP-RECORD-TYPE.
  4288*    MOVE FORM-MASTER                TO  JP-RECORD-AREA.
  4289
  4290
  4291* EXEC CICS REWRITE
  4292*        DATASET   (ERFORM-FILE-ID)
  4293*        FROM      (FORM-MASTER)
  4294*    END-EXEC.
  4295     MOVE LENGTH OF
  4296      FORM-MASTER
  4297       TO DFHEIV11
  4298*    MOVE '&& L                  %   #00004172' TO DFHEIV0
  4299     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4300     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4301     MOVE X'2020233030303034313732' TO DFHEIV0(25:11)
  4302     CALL 'kxdfhei1' USING DFHEIV0,
  4303           ERFORM-FILE-ID,
  4304           FORM-MASTER,
  4305           DFHEIV11,
  4306           DFHEIV99
  4307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4308
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL158.cbl
  4309
  4310*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4311     MOVE ER-0000                    TO  EMI-ERROR.
  4312     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4313     MOVE LOW-VALUES                 TO  EL158AO.
  4314     MOVE -1                         TO  MAINTL.
  4315     MOVE PI-STATE-CODE              TO  STATEI.
  4316     MOVE PI-FORM-ID                 TO  FORMI.
  4317     MOVE PI-EXP-DT                  TO  EXPDTI.
  4318     GO TO 1000-SHOW-FORM-RECORD.
  4319
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL158.cbl
  4321 3000-ADD-FORM-RECORD.
  4322
  4323     PERFORM 6000-EDIT-INPUT-DATA THRU 6000-EXIT.
  4324
  4325     IF NOT EMI-NO-ERRORS
  4326         GO TO 8200-SEND-DATAONLY.
  4327
  4328
  4329* EXEC CICS GETMAIN
  4330*        SET       (ADDRESS OF FORM-MASTER)
  4331*        LENGTH    (ERFORM-LENGTH)
  4332*        INITIMG   (GETMAIN-SPACE)
  4333*    END-EXEC.
  4334*    MOVE ',"IL                  $   #00004195' TO DFHEIV0
  4335     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4336     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4337     MOVE X'2020233030303034313935' TO DFHEIV0(25:11)
  4338     CALL 'kxdfhei1' USING DFHEIV0,
  4339           DFHEIV20,
  4340           ERFORM-LENGTH,
  4341           GETMAIN-SPACE
  4342     SET ADDRESS OF FORM-MASTER TO
  4343         DFHEIV20
  4344     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4345
  4346
  4347     MOVE SPACES                     TO  FORM-MASTER.
  4348
  4349     MOVE 'FO'                       TO  FO-RECORD-ID.
  4350     MOVE PI-COMPANY-CD              TO  FO-COMPANY-CD.
  4351     MOVE STATEI                     TO  FO-STATE
  4352                                         PI-STATE-CODE.
  4353     MOVE FORMI                      TO  FO-FORM-ID
  4354                                         PI-FORM-ID.
  4355
  4356     MOVE EXPDTI                     TO  DEEDIT-FIELD.
  4357     PERFORM 8600-DEEDIT THRU 8600-EXIT.
  4358     IF DEEDIT-FIELD-V0 IS NOT LESS THAN 999999
  4359         MOVE HIGH-VALUES            TO  FO-FORM-EXP-DT
  4360         MOVE '99/99/99'             TO  PI-EXP-DT
  4361     ELSE
  4362         MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY
  4363         MOVE '4'                    TO  DC-OPTION-CODE
  4364         MOVE +0                     TO  DC-ELAPSED-DAYS
  4365                                         DC-ELAPSED-MONTHS
  4366         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4367         IF NO-CONVERSION-ERROR
  4368             MOVE DC-BIN-DATE-1      TO  FO-FORM-EXP-DT
  4369             MOVE DC-GREG-DATE-1-EDIT TO PI-EXP-DT
  4370          ELSE
  4371             MOVE LOW-VALUES         TO  FO-FORM-EXP-DT
  4372                                         PI-EXP-DT.
  4373
  4374     IF INDGRPL IS GREATER THAN +0
  4375         MOVE INDGRPI                TO  FO-IND-GRP-CD.
  4376
  4377     IF MAXATTL IS GREATER THAN +0
  4378         MOVE MAXATTI                TO  FO-MAX-ATT-AGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL158.cbl
  4379     ELSE
  4380         MOVE +0                     TO  FO-MAX-ATT-AGE.
  4381
  4382     IF LFMINL IS GREATER THAN +0
  4383         MOVE LFMINI                 TO  FO-LF-MIN-ISSUE-AGE
  4384     ELSE
  4385         MOVE ZEROS                  TO  FO-LF-MIN-ISSUE-AGE.
  4386
  4387     IF LFMAXL IS GREATER THAN +0
  4388         MOVE LFMAXI                 TO  FO-LF-MAX-ISSUE-AGE
  4389     ELSE
  4390         MOVE +0                     TO  FO-LF-MAX-ISSUE-AGE.
  4391
  4392     IF LFTRML IS GREATER THAN +0
  4393         MOVE LFTRMI                 TO  FO-LF-MAX-TERM
  4394     ELSE
  4395         MOVE +0                     TO  FO-LF-MAX-TERM.
  4396
  4397     IF LFAMTL IS GREATER THAN +0
  4398         MOVE LFAMTI                 TO  DEEDIT-FIELD-V2
  4399         PERFORM 8600-DEEDIT THRU 8600-EXIT
  4400         MOVE DEEDIT-FIELD-V2        TO  FO-MAX-LF-AMT
  4401     ELSE
  4402         MOVE +0                     TO  FO-MAX-LF-AMT.
  4403
  4404     IF LFPREL IS GREATER THAN +0
  4405         MOVE LFPREI                 TO FO-LF-PRE-EXIST-EXCL-TYPE
  4406     ELSE
  4407         MOVE ZEROS                  TO FO-LF-PRE-EXIST-EXCL-TYPE.
  4408
  4409     IF SUICIDEL IS GREATER THAN +0
  4410         MOVE SUICIDEI               TO  FO-SUICIDE-EXCL-TYPE
  4411     ELSE
  4412         MOVE +0                     TO  FO-SUICIDE-EXCL-TYPE.
  4413
  4414     IF DEFTYPL IS GREATER THAN +0
  4415         MOVE DEFTYPI                TO  FO-DIS-DEF-TYPE
  4416     ELSE
  4417         MOVE ZEROS                  TO  FO-DIS-DEF-TYPE.
  4418
  4419     IF DISMCDL IS GREATER THAN +0
  4420         MOVE DISMCDI                TO  FO-DISMEMBERMENT-CD
  4421     ELSE
  4422         MOVE 'N'                    TO  FO-DISMEMBERMENT-CD.
  4423
  4424     IF CRTAPPL IS GREATER THAN +0
  4425         MOVE CRTAPPI                TO  FO-APP-CERT-USE-CD
  4426     ELSE
  4427         MOVE 'N'                    TO  FO-APP-CERT-USE-CD.
  4428
  4429     IF AHMINL IS GREATER THAN +0
  4430         MOVE AHMINI                 TO  FO-AH-MIN-ISSUE-AGE
  4431     ELSE
  4432         MOVE ZEROS                  TO  FO-AH-MIN-ISSUE-AGE.
  4433
  4434     IF AHMAXL IS GREATER THAN +0
  4435         MOVE AHMAXI                 TO  FO-AH-MAX-ISSUE-AGE
  4436     ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL158.cbl
  4437         MOVE +0                     TO  FO-AH-MAX-ISSUE-AGE.
  4438
  4439     IF AHTRML IS GREATER THAN +0
  4440         MOVE AHTRMI                 TO  FO-AH-MAX-TERM
  4441     ELSE
  4442         MOVE +0                     TO  FO-AH-MAX-TERM.
  4443
  4444     IF AHPREL IS GREATER THAN +0
  4445         MOVE AHPREI                 TO FO-AH-PRE-EXIST-EXCL-TYPE
  4446     ELSE
  4447         MOVE ZEROS                  TO FO-AH-PRE-EXIST-EXCL-TYPE.
  4448
  4449     IF AHAMTL IS GREATER THAN +0
  4450         MOVE AHAMTI                 TO  DEEDIT-FIELD-V2
  4451         PERFORM 8600-DEEDIT THRU 8600-EXIT
  4452         MOVE DEEDIT-FIELD-V2        TO  FO-MAX-AH-AMT
  4453     ELSE
  4454         MOVE +0                     TO  FO-MAX-AH-AMT.
  4455
  4456     IF DESCL IS GREATER THAN +0
  4457         MOVE DESCI                  TO  FO-COMMENT-LINE-1.
  4458
  4459     MOVE +0                         TO  SUB.
  4460
  4461 3000-ADD-BENEFIT-LOOP.
  4462
  4463     ADD +1                          TO  SUB.
  4464     IF SUB IS GREATER THAN +20
  4465         PERFORM 3010-ADD-BENEFIT-INIT THRU 3010-ABI-EXIT 20 TIMES
  4466         GO TO 3000-ADD-CONTINUE.
  4467
  4468     IF EL158-BENE-LENGTH (SUB) IS GREATER THAN +0
  4469         MOVE EL158-BENE-TYPE (SUB)  TO  FO-PLAN-TYPE  (SUB)
  4470         MOVE EL158-BENE-ID   (SUB)  TO  FO-PLAN-ID    (SUB)
  4471     ELSE
  4472         MOVE SPACES                 TO  FO-PLAN-TYPE  (SUB)
  4473         MOVE SPACES                 TO  FO-PLAN-ID    (SUB).
  4474
  4475     IF EL158-BENE-TERM-LENGTH (SUB) IS GREATER THAN +0
  4476         MOVE EL158-BENE-TERM (SUB)  TO  DEEDIT-FIELD-V0
  4477         PERFORM 8600-DEEDIT THRU 8600-EXIT
  4478         MOVE DEEDIT-FIELD-V0        TO  FO-PLAN-TERM (SUB)
  4479     ELSE
  4480         MOVE ZEROES                 TO  FO-PLAN-TERM  (SUB).
  4481
  4482     IF EL158-BENE-REFM-LENGTH (SUB) IS GREATER THAN +0
  4483         MOVE EL158-BENE-REFM (SUB)
  4484                              TO  FO-PLAN-REFUND-METHOD (SUB)
  4485     ELSE
  4486         MOVE SPACES          TO  FO-PLAN-REFUND-METHOD (SUB).
  4487
  4488
  4489     GO TO 3000-ADD-BENEFIT-LOOP.
  4490
  4491 3000-ADD-CONTINUE.
  4492
  4493*    IF DATE-CONVERSION-ERROR
  4494*        MOVE LOW-VALUES             TO  FO-LAST-MAINT-DT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL158.cbl
  4495*    ELSE
  4496*        MOVE DC-BIN-DATE-1          TO  FO-LAST-MAINT-DT.
  4497
  4498     MOVE SAVE-BIN-DATE              TO  FO-LAST-MAINT-DT.
  4499     MOVE PI-PROCESSOR-ID            TO  FO-LAST-MAINT-BY.
  4500     MOVE EIBTIME                    TO  FO-LAST-MAINT-HHMMSS.
  4501
  4502*    MOVE 'A'                        TO  JP-RECORD-TYPE.
  4503*    MOVE FORM-MASTER                TO  JP-RECORD-AREA.
  4504
  4505 3005-WRITE-ERFORM-FILE.
  4506
  4507
  4508* EXEC CICS WRITE
  4509*        DATASET    (ERFORM-FILE-ID)
  4510*        FROM       (FORM-MASTER)
  4511*        RIDFLD     (FO-CONTROL-PRIMARY)
  4512*    END-EXEC.
  4513     MOVE LENGTH OF
  4514      FORM-MASTER
  4515       TO DFHEIV11
  4516*    MOVE '&$ L                  ''   #00004361' TO DFHEIV0
  4517     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4518     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4519     MOVE X'2020233030303034333631' TO DFHEIV0(25:11)
  4520     CALL 'kxdfhei1' USING DFHEIV0,
  4521           ERFORM-FILE-ID,
  4522           FORM-MASTER,
  4523           DFHEIV11,
  4524           FO-CONTROL-PRIMARY,
  4525           DFHEIV99,
  4526           DFHEIV99
  4527     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4528
  4529
  4530*    PERFORM 8400-LOG-JOURNAL-RECORD.
  4531     MOVE ER-0000                    TO  EMI-ERROR.
  4532     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4533     MOVE LOW-VALUES                 TO  EL158AO.
  4534     MOVE -1                         TO  MAINTL.
  4535     MOVE PI-STATE-CODE              TO  STATEI.
  4536     MOVE PI-FORM-ID                 TO  FORMI.
  4537     MOVE PI-EXP-DT                  TO  EXPDTI.
  4538     GO TO 1000-SHOW-FORM-RECORD.
  4539
  4540 3010-ADD-BENEFIT-INIT.
  4541     MOVE ZEROES                 TO  FO-PLAN-TERM  (SUB).
  4542     ADD +1                      TO  SUB.
  4543 3010-ABI-EXIT.
  4544     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL158.cbl
  4546 4000-DELETE-FORM-RECORD.
  4547
  4548     MOVE PI-COMPANY-CD              TO  ERFORM-COMPANY-CD.
  4549     MOVE STATEI                     TO  ERFORM-STATE.
  4550     MOVE FORMI                      TO  ERFORM-FORM-ID.
  4551
  4552     MOVE EXPDTI                     TO  DEEDIT-FIELD.
  4553     PERFORM 8600-DEEDIT THRU 8600-EXIT.
  4554     IF DEEDIT-FIELD-V0 IS NOT LESS THAN 999999
  4555         MOVE HIGH-VALUES            TO  ERFORM-EXP-DT
  4556     ELSE
  4557         MOVE DEEDIT-FIELD-V0        TO  DC-GREG-DATE-1-MDY
  4558         MOVE '4'                    TO  DC-OPTION-CODE
  4559         MOVE +0                     TO  DC-ELAPSED-DAYS
  4560                                         DC-ELAPSED-MONTHS
  4561         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4562         IF NO-CONVERSION-ERROR
  4563             MOVE DC-BIN-DATE-1      TO  ERFORM-EXP-DT
  4564         ELSE
  4565             MOVE LOW-VALUES         TO  ERFORM-EXP-DT.
  4566
  4567
  4568* EXEC CICS READ
  4569*        DATASET   (ERFORM-FILE-ID)
  4570*        SET       (ADDRESS OF FORM-MASTER)
  4571*        RIDFLD    (ERFORM-KEY)
  4572*        UPDATE
  4573*    END-EXEC.
  4574*    MOVE '&"S        EU         (   #00004404' TO DFHEIV0
  4575     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4576     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4577     MOVE X'2020233030303034343034' TO DFHEIV0(25:11)
  4578     CALL 'kxdfhei1' USING DFHEIV0,
  4579           ERFORM-FILE-ID,
  4580           DFHEIV20,
  4581           DFHEIV99,
  4582           ERFORM-KEY,
  4583           DFHEIV99,
  4584           DFHEIV99,
  4585           DFHEIV99
  4586     SET ADDRESS OF FORM-MASTER TO
  4587         DFHEIV20
  4588     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4589
  4590
  4591     IF FO-LAST-MAINT-BY     NOT EQUAL PI-UPDATE-BY OR
  4592        FO-LAST-MAINT-HHMMSS NOT EQUAL PI-UPDATE-HHMMSS
  4593
  4594* EXEC CICS UNLOCK
  4595*            DATASET   (ERFORM-FILE-ID)
  4596*            END-EXEC
  4597*    MOVE '&*                    #   #00004413' TO DFHEIV0
  4598     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  4599     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4600     MOVE X'2020233030303034343133' TO DFHEIV0(25:11)
  4601     CALL 'kxdfhei1' USING DFHEIV0,
  4602           ERFORM-FILE-ID,
  4603           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL158.cbl
  4604     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4605         MOVE ER-0068                TO  EMI-ERROR
  4606         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4607         GO TO 1000-SHOW-FORM-RECORD.
  4608
  4609*    MOVE 'D'                        TO  JP-RECORD-TYPE.
  4610*    MOVE FORM-MASTER                TO  JP-RECORD-AREA.
  4611
  4612* EXEC CICS DELETE
  4613*        DATASET   (ERFORM-FILE-ID)
  4614*        END-EXEC.
  4615*    MOVE '&(                    &   #00004422' TO DFHEIV0
  4616     MOVE X'262820202020202020202020' TO DFHEIV0(1:12)
  4617     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4618     MOVE X'2020233030303034343232' TO DFHEIV0(25:11)
  4619     CALL 'kxdfhei1' USING DFHEIV0,
  4620           ERFORM-FILE-ID,
  4621           DFHEIV99,
  4622           DFHEIV99,
  4623           DFHEIV99,
  4624           DFHEIV99
  4625     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4626
  4627
  4628*    PERFORM 8400-LOG-JOURNAL-RECORD
  4629     MOVE ER-0000                    TO  EMI-ERROR.
  4630     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4631     MOVE LOW-VALUES                 TO  EL158AO.
  4632     MOVE -1                         TO  MAINTL.
  4633     GO TO 8100-SEND-INITIAL-MAP.
  4634
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL158.cbl
  4636 5000-FIND-NEXT-FORM-RECORD.
  4637
  4638     MOVE LOW-VALUES                 TO  ERFORM-KEY.
  4639     MOVE PI-COMPANY-CD              TO  ERFORM-COMPANY-CD.
  4640
  4641     IF STATEL IS GREATER THAN +0
  4642         MOVE STATEI                 TO  ERFORM-STATE.
  4643     IF FORML IS GREATER THAN +0
  4644         MOVE FORMI                  TO  ERFORM-FORM-ID.
  4645     IF EXPDTL IS GREATER THAN +0
  4646         MOVE EXPDTI                 TO  DEEDIT-FIELD
  4647         PERFORM 8600-DEEDIT THRU 8600-EXIT
  4648         IF DEEDIT-FIELD-V0 IS NOT LESS THAN 999999
  4649             MOVE HIGH-VALUES        TO  ERFORM-EXP-DT
  4650         ELSE
  4651             MOVE DEEDIT-FIELD-V0    TO  DC-GREG-DATE-1-MDY
  4652             MOVE '4'                TO  DC-OPTION-CODE
  4653             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4654             IF NO-CONVERSION-ERROR
  4655                 MOVE DC-BIN-DATE-1  TO  ERFORM-EXP-DT
  4656             ELSE
  4657                 MOVE LOW-VALUES     TO  ERFORM-EXP-DT.
  4658
  4659
  4660* EXEC CICS HANDLE CONDITION
  4661*        ENDFILE (5000-UNSUCCESSFUL-SEARCH)
  4662*    END-EXEC.
  4663*    MOVE '"$''                   ! % #00004457' TO DFHEIV0
  4664     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  4665     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4666     MOVE X'2520233030303034343537' TO DFHEIV0(25:11)
  4667     CALL 'kxdfhei1' USING DFHEIV0
  4668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4669
  4670
  4671
  4672* EXEC CICS STARTBR
  4673*        DATASET   (ERFORM-FILE-ID)
  4674*        RIDFLD    (ERFORM-KEY)
  4675*        GTEQ
  4676*    END-EXEC.
  4677     MOVE 0
  4678       TO DFHEIV11
  4679*    MOVE '&,         G          &   #00004461' TO DFHEIV0
  4680     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4681     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4682     MOVE X'2020233030303034343631' TO DFHEIV0(25:11)
  4683     CALL 'kxdfhei1' USING DFHEIV0,
  4684           ERFORM-FILE-ID,
  4685           ERFORM-KEY,
  4686           DFHEIV99,
  4687           DFHEIV11,
  4688           DFHEIV99
  4689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4690
  4691
  4692 5000-READNEXT-LOOP.
  4693
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL158.cbl
  4694* EXEC CICS READNEXT
  4695*        DATASET   (ERFORM-FILE-ID)
  4696*        SET       (ADDRESS OF FORM-MASTER)
  4697*        RIDFLD    (ERFORM-KEY)
  4698*    END-EXEC.
  4699     MOVE 0
  4700       TO DFHEIV11
  4701*    MOVE '&.S                   )   #00004468' TO DFHEIV0
  4702     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4703     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4704     MOVE X'2020233030303034343638' TO DFHEIV0(25:11)
  4705     CALL 'kxdfhei1' USING DFHEIV0,
  4706           ERFORM-FILE-ID,
  4707           DFHEIV20,
  4708           DFHEIV99,
  4709           ERFORM-KEY,
  4710           DFHEIV99,
  4711           DFHEIV11,
  4712           DFHEIV99,
  4713           DFHEIV99
  4714     SET ADDRESS OF FORM-MASTER TO
  4715         DFHEIV20
  4716     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4717
  4718
  4719     IF FO-COMPANY-CD  NOT EQUAL PI-COMPANY-CD
  4720         GO TO 5000-UNSUCCESSFUL-SEARCH.
  4721
  4722     IF ERFORM-KEY IS EQUAL TO PI-PREV-FORM-KEY
  4723         GO TO 5000-READNEXT-LOOP.
  4724
  4725     GO TO 7000-BUILD-OUTPUT-MAP.
  4726
  4727 5000-END-BROWSE.
  4728
  4729
  4730* EXEC CICS ENDBR
  4731*        DATASET   (ERFORM-FILE-ID)
  4732*    END-EXEC.
  4733     MOVE 0
  4734       TO DFHEIV11
  4735*    MOVE '&2                    $   #00004484' TO DFHEIV0
  4736     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4737     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4738     MOVE X'2020233030303034343834' TO DFHEIV0(25:11)
  4739     CALL 'kxdfhei1' USING DFHEIV0,
  4740           ERFORM-FILE-ID,
  4741           DFHEIV11,
  4742           DFHEIV99
  4743     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4744
  4745
  4746 5000-UNSUCCESSFUL-SEARCH.
  4747
  4748     PERFORM 5000-END-BROWSE.
  4749     MOVE -1                         TO  PFKEYL.
  4750     MOVE ER-0130                    TO  EMI-ERROR.
  4751     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL158.cbl
  4752     GO TO 1000-SHOW-FORM-RECORD.
  4753
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL158.cbl
  4755 5100-FIND-PREV-FORM-RECORD.
  4756
  4757     MOVE LOW-VALUES                 TO  ERFORM-KEY.
  4758     MOVE PI-COMPANY-CD              TO  ERFORM-COMPANY-CD.
  4759     MOVE PI-PREV-FORM-KEY           TO  ERFORM-KEY.
  4760
  4761     IF STATEL IS GREATER THAN +0
  4762         MOVE STATEI                 TO  ERFORM-STATE.
  4763     IF FORML IS GREATER THAN +0
  4764         MOVE FORMI                  TO  ERFORM-FORM-ID.
  4765     IF EXPDTL IS GREATER THAN +0
  4766         MOVE EXPDTI                 TO  DEEDIT-FIELD
  4767         PERFORM 8600-DEEDIT THRU 8600-EXIT
  4768         IF DEEDIT-FIELD-V0 IS NOT LESS THAN 999999
  4769             MOVE HIGH-VALUES        TO  ERFORM-EXP-DT
  4770         ELSE
  4771             MOVE DEEDIT-FIELD-V0    TO  DC-GREG-DATE-1-MDY
  4772             MOVE '4'                TO  DC-OPTION-CODE
  4773             PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4774             IF NO-CONVERSION-ERROR
  4775                 MOVE DC-BIN-DATE-1  TO  ERFORM-EXP-DT
  4776             ELSE
  4777                 MOVE LOW-VALUES     TO  ERFORM-EXP-DT.
  4778
  4779
  4780* EXEC CICS HANDLE CONDITION
  4781*        ENDFILE (5100-UNSUCCESSFUL-SEARCH)
  4782*    END-EXEC.
  4783*    MOVE '"$''                   ! & #00004521' TO DFHEIV0
  4784     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  4785     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4786     MOVE X'2620233030303034353231' TO DFHEIV0(25:11)
  4787     CALL 'kxdfhei1' USING DFHEIV0
  4788     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4789
  4790
  4791
  4792* EXEC CICS STARTBR
  4793*        DATASET   (ERFORM-FILE-ID)
  4794*        RIDFLD    (ERFORM-KEY)
  4795*        GTEQ
  4796*    END-EXEC.
  4797     MOVE 0
  4798       TO DFHEIV11
  4799*    MOVE '&,         G          &   #00004525' TO DFHEIV0
  4800     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4801     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4802     MOVE X'2020233030303034353235' TO DFHEIV0(25:11)
  4803     CALL 'kxdfhei1' USING DFHEIV0,
  4804           ERFORM-FILE-ID,
  4805           ERFORM-KEY,
  4806           DFHEIV99,
  4807           DFHEIV11,
  4808           DFHEIV99
  4809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4810
  4811
  4812 5100-READPREV-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL158.cbl
  4813
  4814* EXEC CICS READPREV
  4815*        DATASET   (ERFORM-FILE-ID)
  4816*        SET       (ADDRESS OF FORM-MASTER)
  4817*        RIDFLD    (ERFORM-KEY)
  4818*    END-EXEC.
  4819     MOVE 0
  4820       TO DFHEIV11
  4821*    MOVE '&0S                   )   #00004532' TO DFHEIV0
  4822     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  4823     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4824     MOVE X'2020233030303034353332' TO DFHEIV0(25:11)
  4825     CALL 'kxdfhei1' USING DFHEIV0,
  4826           ERFORM-FILE-ID,
  4827           DFHEIV20,
  4828           DFHEIV99,
  4829           ERFORM-KEY,
  4830           DFHEIV99,
  4831           DFHEIV11,
  4832           DFHEIV99,
  4833           DFHEIV99
  4834     SET ADDRESS OF FORM-MASTER TO
  4835         DFHEIV20
  4836     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4837
  4838
  4839     IF FO-COMPANY-CD  NOT EQUAL PI-COMPANY-CD
  4840         GO TO 5100-UNSUCCESSFUL-SEARCH.
  4841
  4842     IF ERFORM-KEY IS EQUAL TO PI-PREV-FORM-KEY
  4843         GO TO 5100-READPREV-LOOP.
  4844
  4845     GO TO 7000-BUILD-OUTPUT-MAP.
  4846
  4847 5100-END-BROWSE.
  4848
  4849* EXEC CICS ENDBR
  4850*        DATASET   (ERFORM-FILE-ID)
  4851*    END-EXEC.
  4852     MOVE 0
  4853       TO DFHEIV11
  4854*    MOVE '&2                    $   #00004547' TO DFHEIV0
  4855     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4856     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4857     MOVE X'2020233030303034353437' TO DFHEIV0(25:11)
  4858     CALL 'kxdfhei1' USING DFHEIV0,
  4859           ERFORM-FILE-ID,
  4860           DFHEIV11,
  4861           DFHEIV99
  4862     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4863
  4864
  4865 5100-UNSUCCESSFUL-SEARCH.
  4866
  4867     PERFORM 5100-END-BROWSE.
  4868     MOVE -1                         TO  PFKEYL.
  4869     MOVE ER-0131                    TO  EMI-ERROR.
  4870     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL158.cbl
  4871     GO TO 1000-SHOW-FORM-RECORD.
  4872
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL158.cbl
  4874 5200-FIND-NEXT-BENEFIT.
  4875
  4876     IF EL158-BENE-INIT (1)  EQUAL WS-INIT-VALUE (1)
  4877         MOVE WS-INIT-VALUE  (21) TO WS158-BENE-INIT
  4878     ELSE
  4879         MOVE WS-INIT-VALUE  (21) TO WS158-BENE-INIT
  4880         MOVE ER-8150             TO EMI-ERROR
  4881         MOVE -1                  TO  PFKEYL
  4882         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4883
  4884     GO TO 1000-SHOW-FORM-RECORD.
  4885
  4886
  4887 5200-FIND-PREV-BENEFIT.
  4888
  4889     IF EL158-BENE-INIT (1)  EQUAL WS-INIT-VALUE (21)
  4890         MOVE WS-INIT-VALUE  (1)  TO WS158-BENE-INIT
  4891     ELSE
  4892         MOVE WS-INIT-VALUE  (1)  TO WS158-BENE-INIT
  4893         MOVE ER-8150             TO EMI-ERROR
  4894         MOVE -1                  TO  PFKEYL
  4895         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4896
  4897     GO TO 1000-SHOW-FORM-RECORD.
  4898
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL158.cbl
  4900 6000-EDIT-INPUT-DATA.
  4901
  4902     IF MAINTI IS EQUAL TO 'A'
  4903         IF STATEL IS EQUAL TO +0
  4904             MOVE ER-0144            TO  EMI-ERROR
  4905             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4906             MOVE -1                 TO  STATEL
  4907             MOVE AL-UABON           TO  STATEA
  4908         ELSE
  4909             MOVE SPACES             TO  ELCNTL-KEY
  4910             MOVE PI-COMPANY-ID      TO  ELCNTL-COMPANY-ID
  4911             MOVE '3'                TO  ELCNTL-RECORD-TYPE
  4912             MOVE STATEI             TO  ELCNTL-STATE-CD
  4913             MOVE +0                 TO  ELCNTL-SEQUENCE-NO
  4914             PERFORM 8000-READ-CNTL THRU 8010-EXIT
  4915             IF CNTL-RECORD-FOUND
  4916                 MOVE AL-UANON       TO  STATEA
  4917             ELSE
  4918                 MOVE ER-0144        TO  EMI-ERROR
  4919                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4920                 MOVE -1             TO  STATEL
  4921                 MOVE AL-UABON       TO  STATEA.
  4922
  4923     IF MAINTI IS EQUAL TO 'A'
  4924         IF FORML IS EQUAL TO +0
  4925             MOVE ER-0703            TO  EMI-ERROR
  4926             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4927             MOVE -1                 TO  FORML
  4928             MOVE AL-UABON           TO  FORMA
  4929         ELSE
  4930             MOVE AL-UANON           TO  FORMA.
  4931
  4932     IF MAINTI IS EQUAL TO 'A'
  4933         IF EXPDTL IS EQUAL TO +0
  4934             MOVE ER-0704            TO  EMI-ERROR
  4935             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4936             MOVE -1                 TO  EXPDTL
  4937             MOVE AL-UABON           TO  EXPDTA
  4938         ELSE
  4939             MOVE EXPDTI             TO  DEEDIT-FIELD
  4940             PERFORM 8600-DEEDIT THRU 8600-EXIT
  4941             IF DEEDIT-FIELD-V0 IS NOT LESS THAN 999999
  4942                 MOVE '99/99/99'     TO  EXPDTO
  4943                 MOVE AL-UANON       TO  EXPDTA
  4944             ELSE
  4945                 MOVE DEEDIT-FIELD-V0 TO DC-GREG-DATE-1-MDY
  4946                 MOVE '4'            TO  DC-OPTION-CODE
  4947                 MOVE +0             TO  DC-ELAPSED-DAYS
  4948                                         DC-ELAPSED-MONTHS
  4949                 PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4950                 IF NO-CONVERSION-ERROR
  4951                     MOVE DC-GREG-DATE-1-EDIT TO  EXPDTO
  4952                     MOVE AL-UANON   TO  EXPDTA
  4953                 ELSE
  4954                     MOVE ER-0705    TO  EMI-ERROR
  4955                     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  4956                     MOVE -1         TO  EXPDTL
  4957                     MOVE AL-UABON   TO  EXPDTA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL158.cbl
  4958
  4959     IF MAINTI = 'C'
  4960        IF INDGRPL IS GREATER THAN +0
  4961            IF INDGRPI IS EQUAL TO 'I' OR 'G'
  4962                MOVE AL-UANON        TO  INDGRPA
  4963            ELSE
  4964                MOVE ER-7031         TO  EMI-ERROR
  4965                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4966                MOVE -1              TO  INDGRPL
  4967                MOVE AL-UABON        TO  INDGRPA.
  4968
  4969     IF MAINTI = 'A'
  4970        IF INDGRPL IS GREATER THAN +0
  4971            IF INDGRPI IS EQUAL TO 'I' OR 'G'
  4972                MOVE AL-UANON        TO  INDGRPA
  4973            ELSE
  4974                MOVE ER-7031         TO  EMI-ERROR
  4975                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4976                MOVE -1              TO  INDGRPL
  4977                MOVE AL-UABON        TO  INDGRPA
  4978        ELSE
  4979            MOVE ER-7031         TO  EMI-ERROR
  4980            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4981            MOVE -1              TO  INDGRPL
  4982            MOVE AL-UABON        TO  INDGRPA.
  4983
  4984     IF MAXATTL IS GREATER THAN +0
  4985         MOVE MAXATTI                TO  DEEDIT-FIELD
  4986         PERFORM 8600-DEEDIT THRU 8600-EXIT
  4987         MOVE DEEDIT-FIELD-V0        TO  MAXATTI
  4988         MOVE AL-UNNON               TO  MAXATTA.
  4989
  4990     IF DEFTYPL IS GREATER THAN +0
  4991*       MOVE DEFTYPI                TO  DEEDIT-FIELD
  4992*       PERFORM 8600-DEEDIT THRU 8600-EXIT
  4993*       MOVE DEEDIT-FIELD-V0        TO  WS-DISABILITY-CODES
  4994        MOVE DEFTYPI                TO  WS-DISABILITY-CODES
  4995        IF VALID-DISABILITY-CODE
  4996*          MOVE DEEDIT-FIELD-V0     TO  WS-DEFTYP
  4997           MOVE AL-UNNON            TO  DEFTYPA
  4998        ELSE
  4999           MOVE ER-0706             TO  EMI-ERROR
  5000           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5001           MOVE -1                  TO  DEFTYPL
  5002           MOVE AL-UNBON            TO  DEFTYPA.
  5003
  5004     IF DISMCDL IS GREATER THAN +0
  5005        IF DISMCDI IS EQUAL TO 'Y' OR 'N'
  5006           MOVE AL-UANON            TO  DISMCDA
  5007         ELSE
  5008           MOVE ER-0707             TO  EMI-ERROR
  5009           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5010           MOVE -1                  TO  DISMCDL
  5011           MOVE AL-UABON            TO  DISMCDA.
  5012
  5013     IF CRTAPPL IS GREATER THAN +0
  5014       IF CRTAPPI IS EQUAL TO 'Y' OR 'N'
  5015           MOVE AL-UANON           TO  CRTAPPA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL158.cbl
  5016       ELSE
  5017           MOVE ER-0708            TO  EMI-ERROR
  5018           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5019           MOVE -1                 TO  CRTAPPL
  5020           MOVE AL-UABON           TO  CRTAPPA.
  5021
  5022     IF LFMINL IS GREATER THAN +0
  5023         MOVE LFMINI                 TO  DEEDIT-FIELD
  5024         PERFORM 8600-DEEDIT THRU 8600-EXIT
  5025         MOVE DEEDIT-FIELD-V0        TO  LFMINI
  5026                                         WS-LFMIN
  5027         MOVE AL-UNNON               TO  LFMINA.
  5028
  5029     IF MAINTI = 'A'
  5030        IF MAXATTL NOT GREATER THAN +0
  5031           MOVE ER-0718              TO  EMI-ERROR
  5032           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5033           MOVE -1                   TO  MAXATTL
  5034           MOVE AL-UABON             TO  MAXATTA.
  5035
  5036     IF LFMAXL IS GREATER THAN +0
  5037         MOVE LFMAXI                 TO  DEEDIT-FIELD
  5038         PERFORM 8600-DEEDIT THRU 8600-EXIT
  5039         MOVE DEEDIT-FIELD-V0        TO  LFMAXI
  5040                                         WS-LFMAX
  5041         MOVE AL-UNNON               TO  LFMAXA.
  5042
  5043     IF LFTRML IS GREATER THAN +0
  5044         MOVE LFTRMI                 TO  DEEDIT-FIELD
  5045         PERFORM 8600-DEEDIT THRU 8600-EXIT
  5046         MOVE DEEDIT-FIELD-V0        TO  LFTRMI
  5047                                         WS-LFTRM
  5048         MOVE AL-UNNON               TO  LFTRMA.
  5049
  5050     IF LFAMTL IS GREATER THAN +0
  5051         MOVE LFAMTI                 TO  DEEDIT-FIELD-V2
  5052         PERFORM 8600-DEEDIT THRU 8600-EXIT
  5053         IF DEEDIT-FIELD-V0 IS GREATER THAN +999999999
  5054             MOVE ER-0709            TO  EMI-ERROR
  5055             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5056             MOVE -1                 TO  LFAMTL
  5057             MOVE AL-UNBON           TO  LFAMTA
  5058         ELSE
  5059             MOVE DEEDIT-FIELD-V2    TO  LFAMTI
  5060                                         WS-LFAMT
  5061             MOVE AL-UNNON           TO  LFAMTA.
  5062
  5063     IF LFMINL = +0 AND
  5064        LFMAXL = +0 AND
  5065        LFTRML = +0 AND
  5066        LFAMTL = +0 AND
  5067        AHMINL = +0 AND
  5068        AHMAXL = +0 AND
  5069        AHTRML = +0 AND
  5070        AHAMTL = +0
  5071        MOVE ER-0729                 TO  EMI-ERROR
  5072        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5073        MOVE -1                      TO  LFMINL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL158.cbl
  5074
  5075     IF LFMINL = +0 AND
  5076        LFMAXL = +0 AND
  5077        LFTRML = +0 AND
  5078        LFAMTL = +0
  5079        GO TO 6000-EDIT-LF-PREEXS.
  5080
  5081     IF MAINTI = 'A'
  5082        IF LFMINL NOT GREATER THAN +0
  5083           MOVE ER-0719              TO  EMI-ERROR
  5084           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5085           MOVE -1                   TO  LFMINL
  5086           MOVE AL-UABON             TO  LFMINA.
  5087
  5088     IF MAINTI = 'A'
  5089        IF LFMAXL NOT GREATER THAN +0
  5090           MOVE ER-0720              TO  EMI-ERROR
  5091           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5092           MOVE -1                   TO  LFMAXL
  5093           MOVE AL-UABON             TO  LFMAXA.
  5094
  5095     IF MAINTI = 'A'
  5096        IF LFTRML NOT GREATER THAN +0
  5097           MOVE ER-0721              TO  EMI-ERROR
  5098           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5099           MOVE -1                   TO  LFTRML
  5100           MOVE AL-UABON             TO  LFTRMA.
  5101
  5102     IF MAINTI = 'A'
  5103        IF LFAMTL NOT GREATER THAN +0
  5104           MOVE ER-0722              TO  EMI-ERROR
  5105           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5106           MOVE -1                   TO  LFAMTL
  5107           MOVE AL-UABON             TO  LFAMTA.
  5108
  5109 6000-EDIT-LF-PREEXS.
  5110
  5111     IF LFPREL IS GREATER THAN +0
  5112*       MOVE LFPREI                 TO  DEEDIT-FIELD
  5113*       PERFORM 8600-DEEDIT THRU 8600-EXIT
  5114*       MOVE DEEDIT-FIELD-V0       TO  WS-PRE-EXIST-CODES
  5115        MOVE LFPREI                TO  WS-PRE-EXIST-CODES
  5116        IF VALID-PRE-EXIST-CODE
  5117*          MOVE DEEDIT-FIELD-V0    TO  WS-LFPRE
  5118           MOVE AL-UNNON           TO  LFPREA
  5119        ELSE
  5120           MOVE ER-0710            TO  EMI-ERROR
  5121           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5122           MOVE -1                 TO  LFPREL
  5123           MOVE AL-UNBON           TO  LFPREA.
  5124
  5125     IF SUICIDEL IS GREATER THAN +0
  5126*        MOVE SUICIDEI               TO  DEEDIT-FIELD
  5127*        PERFORM 8600-DEEDIT THRU 8600-EXIT
  5128*        MOVE DEEDIT-FIELD-V0        TO  WS-SUICIDE-CODES
  5129         MOVE SUICIDEI               TO  WS-SUICIDE-CODES
  5130         IF VALID-SUICIDE-CODE
  5131             MOVE AL-UANON           TO  SUICIDEA
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL158.cbl
  5132*            MOVE DEEDIT-FIELD-V0    TO  WS-SUICIDE
  5133         ELSE
  5134             MOVE ER-0711            TO  EMI-ERROR
  5135             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5136             MOVE -1                 TO  SUICIDEL
  5137             MOVE AL-UABON           TO  SUICIDEA.
  5138
  5139
  5140     IF AHMINL IS GREATER THAN +0
  5141         MOVE AHMINI                 TO  DEEDIT-FIELD
  5142         PERFORM 8600-DEEDIT THRU 8600-EXIT
  5143         MOVE DEEDIT-FIELD-V0        TO  AHMINI
  5144                                         WS-AHMIN
  5145         MOVE AL-UNNON               TO  AHMINA.
  5146
  5147
  5148     IF AHMAXL IS GREATER THAN +0
  5149         MOVE AHMAXI                 TO  DEEDIT-FIELD
  5150         PERFORM 8600-DEEDIT THRU 8600-EXIT
  5151         MOVE DEEDIT-FIELD-V0        TO  AHMAXI
  5152                                         WS-AHMAX
  5153         MOVE AL-UNNON               TO  AHMAXA.
  5154
  5155     IF AHTRML IS GREATER THAN +0
  5156         MOVE AHTRMI                 TO  DEEDIT-FIELD
  5157         PERFORM 8600-DEEDIT THRU 8600-EXIT
  5158         MOVE DEEDIT-FIELD-V0        TO  AHTRMI
  5159                                         WS-AHTRM
  5160         MOVE AL-UNNON               TO  AHTRMA.
  5161
  5162     IF AHAMTL IS GREATER THAN +0
  5163         MOVE AHAMTI                 TO  DEEDIT-FIELD-V2
  5164         PERFORM 8600-DEEDIT THRU 8600-EXIT
  5165         IF DEEDIT-FIELD-V0 IS GREATER THAN +9999999
  5166             MOVE ER-0712            TO  EMI-ERROR
  5167             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5168             MOVE -1                 TO  AHAMTL
  5169             MOVE AL-UNBON           TO  AHAMTA
  5170         ELSE
  5171             MOVE DEEDIT-FIELD-V2    TO  AHAMTO
  5172                                         WS-AHAMT
  5173             MOVE AL-UNNON           TO  AHAMTA.
  5174
  5175     IF AHMINL = +0 AND
  5176        AHMAXL = +0 AND
  5177        AHTRML = +0 AND
  5178        AHAMTL = +0
  5179        GO TO 6000-EDIT-AH-PREEXS.
  5180
  5181     IF MAINTI = 'A'
  5182        IF AHMINL NOT GREATER THAN +0
  5183           MOVE ER-0723              TO  EMI-ERROR
  5184           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5185           MOVE -1                   TO  AHMINL
  5186           MOVE AL-UABON             TO  AHMINA.
  5187
  5188     IF MAINTI = 'A'
  5189        IF AHMAXL NOT GREATER THAN +0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL158.cbl
  5190           MOVE ER-0724              TO  EMI-ERROR
  5191           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5192           MOVE -1                   TO  AHMAXL
  5193           MOVE AL-UABON             TO  AHMAXA.
  5194
  5195     IF MAINTI = 'A'
  5196        IF AHTRML NOT GREATER THAN +0
  5197           MOVE ER-0725              TO  EMI-ERROR
  5198           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5199           MOVE -1                   TO  AHTRML
  5200           MOVE AL-UABON             TO  AHTRMA.
  5201
  5202     IF MAINTI = 'A'
  5203        IF AHAMTL NOT GREATER THAN +0
  5204           MOVE ER-0726              TO  EMI-ERROR
  5205           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5206           MOVE -1                   TO  AHAMTL
  5207           MOVE AL-UABON             TO  AHAMTA.
  5208
  5209 6000-EDIT-AH-PREEXS.
  5210
  5211     IF AHPREL IS GREATER THAN +0
  5212*        MOVE AHPREI                 TO  DEEDIT-FIELD
  5213*        PERFORM 8600-DEEDIT THRU 8600-EXIT
  5214*        MOVE DEEDIT-FIELD-V0        TO  WS-PRE-EXIST-CODES
  5215         MOVE AHPREI                 TO  WS-PRE-EXIST-CODES
  5216         IF VALID-PRE-EXIST-CODE
  5217             MOVE AL-UNNON           TO  AHPREA
  5218*            MOVE DEEDIT-FIELD-V0    TO  WS-AHPRE
  5219         ELSE
  5220             MOVE ER-0710            TO  EMI-ERROR
  5221             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5222             MOVE -1                 TO  AHPREL
  5223             MOVE AL-UNBON           TO  AHPREA.
  5224     MOVE +0                         TO  SUB.
  5225
  5226     MOVE 'N'                        TO WS-BENEFIT-SW.
  5227
  5228     IF EL158-BENE-INIT (1) EQUAL TO '21.'
  5229         MOVE 'Y'                    TO  WS-BENEFIT-SW.
  5230
  5231 6000-EDIT-BENEFIT-LOOP.
  5232
  5233
  5234     ADD +1                          TO  SUB.
  5235     IF SUB IS GREATER THAN +20
  5236         GO TO 6000-EDIT-FINISHED.
  5237
  5238     IF (EL158-BENE-LENGTH (SUB) IS GREATER THAN +0
  5239         OR EL158-BENE-TERM-LENGTH (SUB) IS GREATER THAN +0
  5240         OR EL158-BENE-REFM-LENGTH (SUB) IS GREATER THAN +0)
  5241         MOVE EL158-BENE (SUB)       TO  WS-BENEFIT-FIELD
  5242         MOVE 'Y'                    TO  WS-BENEFIT-SW
  5243     ELSE
  5244         GO TO 6000-EDIT-BENEFIT-LOOP.
  5245
  5246     IF EL158-BENE (SUB) IS EQUAL TO SPACES
  5247                     AND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL158.cbl
  5248       (EL158-BENE-TERM (SUB) IS GREATER THAN +0
  5249        OR EL158-BENE-REFM (SUB) IS GREATER THAN +0)
  5250         MOVE ER-0713                TO  EMI-ERROR
  5251         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5252         MOVE -1               TO  EL158-BENE-LENGTH (SUB)
  5253         MOVE AL-UABON         TO  EL158-BENE-ATTRB  (SUB)
  5254         GO TO 6000-EDIT-BENEFIT-LOOP.
  5255
  5256     IF MAINTI IS EQUAL TO 'C'
  5257         IF EL158-BENE (SUB) IS EQUAL TO SPACES
  5258             GO TO 6000-EDIT-BENEFIT-LOOP.
  5259
  5260     IF WS-BENE-TYPE IS EQUAL TO PI-LIFE-OVERRIDE-L1 OR
  5261        WS-BENE-TYPE IS EQUAL TO PI-AH-OVERRIDE-L1
  5262         NEXT SENTENCE
  5263     ELSE
  5264         MOVE ER-0713                TO  EMI-ERROR
  5265         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5266         MOVE -1                     TO  EL158-BENE-LENGTH (SUB)
  5267         MOVE AL-UABON               TO  EL158-BENE-ATTRB  (SUB)
  5268         GO TO 6000-EDIT-BENEFIT-LOOP.
  5269
  5270     IF WS-BENE-TYPE IS EQUAL TO PI-LIFE-OVERRIDE-L1
  5271         MOVE SPACES                 TO  ELCNTL-KEY
  5272         MOVE '4'                    TO  ELCNTL-RECORD-TYPE
  5273         MOVE WS-BENE-CODE           TO  ELCNTL-BENE-CD
  5274         MOVE PI-COMPANY-ID          TO  ELCNTL-COMPANY-ID
  5275         MOVE ZEROS                  TO  ELCNTL-SEQUENCE-NO
  5276         PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
  5277         IF CNTL-RECORD-FOUND
  5278             MOVE AL-UANON           TO  EL158-BENE-ATTRB (SUB)
  5279         ELSE
  5280             MOVE ER-7123            TO  EMI-ERROR
  5281             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5282             MOVE -1                 TO  EL158-BENE-LENGTH (SUB)
  5283             MOVE AL-UABON           TO  EL158-BENE-ATTRB  (SUB).
  5284
  5285     IF WS-BENE-TYPE IS EQUAL TO PI-AH-OVERRIDE-L1
  5286         MOVE SPACES                 TO  ELCNTL-KEY
  5287         MOVE '5'                    TO  ELCNTL-RECORD-TYPE
  5288         MOVE WS-BENE-CODE           TO  ELCNTL-BENE-CD
  5289         MOVE PI-COMPANY-ID          TO  ELCNTL-COMPANY-ID
  5290         MOVE ZEROS                  TO  ELCNTL-SEQUENCE-NO
  5291         PERFORM 7100-READ-BENEFIT THRU 7199-EXIT
  5292         IF CNTL-RECORD-FOUND
  5293             MOVE AL-UANON           TO  EL158-BENE-ATTRB (SUB)
  5294         ELSE
  5295             MOVE ER-7123            TO  EMI-ERROR
  5296             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5297             MOVE -1                 TO  EL158-BENE-LENGTH (SUB)
  5298             MOVE AL-UABON           TO  EL158-BENE-ATTRB  (SUB).
  5299
  5300     IF EL158-BENE-TERM-LENGTH (SUB) IS GREATER THAN +0
  5301         MOVE EL158-BENE-TERM (SUB)  TO  DEEDIT-FIELD
  5302         PERFORM 8600-DEEDIT THRU 8600-EXIT
  5303         MOVE DEEDIT-FIELD-V0        TO  EL158-BENE-TERM (SUB)
  5304         IF (EL158-BENE-TERM (SUB) > 360)  OR
  5305            (EL158-BENE-TERM (SUB) < 001)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL158.cbl
  5306             MOVE ER-2241            TO  EMI-ERROR
  5307             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5308             MOVE -1            TO  EL158-BENE-TERM-LENGTH (SUB)
  5309             MOVE AL-UNBON      TO  EL158-BENE-TERM-ATTRB  (SUB)
  5310         ELSE
  5311             MOVE AL-UNNON      TO  EL158-BENE-TERM-ATTRB (SUB).
  5312
  5313     IF EL158-BENE (SUB) NOT EQUAL TO (SPACES AND LOW-VALUES)
  5314                     AND
  5315        EL158-BENE-TERM (SUB) IS NOT NUMERIC
  5316         MOVE ER-2276          TO  EMI-ERROR
  5317         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5318         MOVE -1            TO  EL158-BENE-TERM-LENGTH (SUB)
  5319         MOVE AL-UNBON      TO  EL158-BENE-TERM-ATTRB  (SUB).
  5320
  5321     IF EL158-BENE-REFM-LENGTH (SUB) IS GREATER THAN +0
  5322         MOVE EL158-BENE-REFM (SUB) TO WS-REFUND-METHOD
  5323         IF VALID-REFUND-METHOD
  5324             MOVE AL-UANON      TO  EL158-BENE-REFM-ATTRB (SUB)
  5325         ELSE
  5326             MOVE ER-0582            TO  EMI-ERROR
  5327             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5328             MOVE -1            TO  EL158-BENE-REFM-LENGTH (SUB)
  5329             MOVE AL-UABON      TO  EL158-BENE-REFM-ATTRB  (SUB).
  5330
  5331     GO TO 6000-EDIT-BENEFIT-LOOP.
  5332
  5333 6000-EDIT-FINISHED.
  5334
  5335     IF LFAMTL GREATER THAN +0 AND
  5336        WS-LFAMT =  +0         AND
  5337        AHAMTL GREATER THAN +0 AND
  5338        WS-AHAMT = +0
  5339        MOVE ER-0729                TO  EMI-ERROR
  5340        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5341        MOVE -1                     TO  LFAMTL
  5342        MOVE AL-UNBON               TO  LFAMTA.
  5343
  5344     IF (WS-LFMIN GREATER THAN +0 OR
  5345         WS-LFMAX GREATER THAN +0 OR
  5346         WS-LFTRM GREATER THAN +0 OR
  5347         WS-LFAMT GREATER THAN +0)
  5348         AND
  5349         WS-LFMIN = +0
  5350         MOVE ER-0729               TO  EMI-ERROR
  5351         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5352         MOVE -1                    TO  LFMINL
  5353         MOVE AL-UNBON              TO  LFMINA.
  5354
  5355     IF (WS-LFMIN GREATER THAN +0 OR
  5356         WS-LFMAX GREATER THAN +0 OR
  5357         WS-LFTRM GREATER THAN +0 OR
  5358         WS-LFAMT GREATER THAN +0)
  5359         AND
  5360         WS-LFMAX = +0
  5361         MOVE ER-0729               TO  EMI-ERROR
  5362         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5363         MOVE -1                    TO  LFMAXL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL158.cbl
  5364         MOVE AL-UNBON              TO  LFMAXA.
  5365
  5366     IF (WS-LFMIN GREATER THAN +0 OR
  5367         WS-LFMAX GREATER THAN +0 OR
  5368         WS-LFTRM GREATER THAN +0 OR
  5369         WS-LFAMT GREATER THAN +0)
  5370         AND
  5371         WS-LFTRM = +0
  5372         MOVE ER-0729               TO  EMI-ERROR
  5373         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5374         MOVE -1                    TO  LFTRML
  5375         MOVE AL-UNBON              TO  LFTRMA.
  5376
  5377     IF (WS-AHMIN GREATER THAN +0 OR
  5378         WS-AHMAX GREATER THAN +0 OR
  5379         WS-AHTRM GREATER THAN +0 OR
  5380         WS-AHAMT GREATER THAN +0)
  5381         AND
  5382         WS-AHMIN = +0
  5383         MOVE ER-0729               TO  EMI-ERROR
  5384         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5385         MOVE -1                    TO  AHMINL
  5386         MOVE AL-UNBON              TO  AHMINA.
  5387
  5388     IF (WS-AHMIN GREATER THAN +0 OR
  5389         WS-AHMAX GREATER THAN +0 OR
  5390         WS-AHTRM GREATER THAN +0 OR
  5391         WS-AHAMT GREATER THAN +0)
  5392         AND
  5393         WS-AHMAX = +0
  5394         MOVE ER-0729               TO  EMI-ERROR
  5395         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5396         MOVE -1                    TO  AHMAXL
  5397         MOVE AL-UNBON              TO  AHMAXA.
  5398
  5399     IF (WS-AHMIN GREATER THAN +0 OR
  5400         WS-AHMAX GREATER THAN +0 OR
  5401         WS-AHTRM GREATER THAN +0 OR
  5402         WS-AHAMT GREATER THAN +0)
  5403         AND
  5404         WS-AHTRM = +0
  5405         MOVE ER-0729               TO  EMI-ERROR
  5406         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5407         MOVE -1                    TO  AHTRML
  5408         MOVE AL-UNBON              TO  AHTRMA.
  5409
  5410     IF BENEFIT-NOT-FOUND
  5411        MOVE ER-0727                 TO  EMI-ERROR
  5412        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5413        MOVE -1                      TO  EL158-BENE-LENGTH (1)
  5414        MOVE AL-UABON                TO  EL158-BENE-ATTRB  (1).
  5415
  5416 6000-EXIT.
  5417     EXIT.
  5418
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL158.cbl
  5420 7000-BUILD-OUTPUT-MAP.
  5421
  5422     MOVE LOW-VALUES                 TO  EL158AO.
  5423     MOVE PI-COMPANY-CD              TO  PI-PREV-COMPANY-CD.
  5424     MOVE FO-STATE                   TO  STATEO
  5425                                         PI-PREV-STATE.
  5426     MOVE FO-FORM-ID                 TO  FORMO
  5427                                         PI-PREV-FORM-ID.
  5428     IF FO-FORM-EXP-DT IS EQUAL TO HIGH-VALUES
  5429         MOVE '99/99/99'             TO  EXPDTO
  5430         MOVE HIGH-VALUES            TO  PI-PREV-EXP-DT
  5431     ELSE
  5432         MOVE FO-FORM-EXP-DT         TO  DC-BIN-DATE-1
  5433                                         PI-PREV-EXP-DT
  5434         MOVE ' '                    TO  DC-OPTION-CODE
  5435         MOVE +0                     TO  DC-ELAPSED-DAYS
  5436                                         DC-ELAPSED-MONTHS
  5437         PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT
  5438         IF NO-CONVERSION-ERROR
  5439             MOVE DC-GREG-DATE-1-EDIT TO EXPDTO
  5440         ELSE
  5441             MOVE LOW-VALUES         TO  EXPDTO.
  5442
  5443     MOVE FO-IND-GRP-CD              TO  INDGRPO.
  5444     MOVE AL-UANON                   TO  INDGRPA.
  5445     MOVE FO-MAX-ATT-AGE             TO  MAXATTO.
  5446     MOVE AL-UNNON                   TO  MAXATTA.
  5447
  5448     MOVE FO-LF-MIN-ISSUE-AGE        TO  LFMINO.
  5449     MOVE AL-UNNON                   TO  LFMINA.
  5450     MOVE FO-LF-MAX-ISSUE-AGE        TO  LFMAXO.
  5451     MOVE AL-UNNON                   TO  LFMAXA.
  5452     MOVE FO-LF-MAX-TERM             TO  LFTRMO.
  5453     MOVE AL-UNNON                   TO  LFTRMA.
  5454     MOVE FO-MAX-LF-AMT              TO  LFAMTO.
  5455     MOVE AL-UNNON                   TO  LFAMTA.
  5456     MOVE FO-LF-PRE-EXIST-EXCL-TYPE  TO  LFPREO.
  5457     MOVE AL-UNNON                   TO  LFPREA.
  5458     MOVE FO-SUICIDE-EXCL-TYPE       TO  SUICIDEO.
  5459     MOVE AL-UNNON                   TO  SUICIDEA.
  5460     MOVE FO-DIS-DEF-TYPE            TO  DEFTYPO.
  5461     MOVE AL-UANON                   TO  DEFTYPA.
  5462     MOVE FO-DISMEMBERMENT-CD        TO  DISMCDO.
  5463     MOVE AL-UANON                   TO  DISMCDA.
  5464     MOVE FO-APP-CERT-USE-CD         TO  CRTAPPO.
  5465     MOVE AL-UANON                   TO  CRTAPPA.
  5466
  5467     MOVE FO-AH-MIN-ISSUE-AGE        TO  AHMINO.
  5468     MOVE AL-UNNON                   TO  AHMINA.
  5469     MOVE FO-AH-MAX-ISSUE-AGE        TO  AHMAXO.
  5470     MOVE AL-UNNON                   TO  AHMAXA.
  5471     MOVE FO-AH-MAX-TERM             TO  AHTRMO.
  5472     MOVE AL-UNNON                   TO  AHTRMA.
  5473     MOVE FO-MAX-AH-AMT              TO  AHAMTO.
  5474     MOVE AL-UNNON                   TO  AHAMTA.
  5475     MOVE FO-AH-PRE-EXIST-EXCL-TYPE  TO  AHPREO.
  5476     MOVE AL-UNNON                   TO  AHPREA.
  5477
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL158.cbl
  5478     MOVE FO-LAST-MAINT-BY           TO  MAINTBYO
  5479                                         PI-UPDATE-BY.
  5480     MOVE FO-LAST-MAINT-HHMMSS       TO  TIME-IN
  5481                                         PI-UPDATE-HHMMSS.
  5482     MOVE TIME-OUT                   TO  MAINTATO.
  5483     MOVE FO-LAST-MAINT-DT           TO  DC-BIN-DATE-1.
  5484     MOVE ' '                        TO  DC-OPTION-CODE.
  5485     MOVE +0                         TO  DC-ELAPSED-DAYS
  5486                                         DC-ELAPSED-MONTHS.
  5487     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  5488     IF NO-CONVERSION-ERROR
  5489         MOVE DC-GREG-DATE-1-EDIT    TO  MAINTONO
  5490     ELSE
  5491         MOVE LOW-VALUES             TO  MAINTONO.
  5492
  5493     MOVE +0                         TO  SUB.
  5494
  5495     IF WS158-BENE-INIT     EQUAL WS-INIT-VALUE (21)
  5496         MOVE +20 TO SUB2
  5497     ELSE
  5498         MOVE +0  TO SUB2.
  5499
  5500 7000-BUILD-BENEFIT-LOOP.
  5501
  5502     ADD +1                          TO  SUB.
  5503     ADD +1                          TO  SUB2.
  5504     IF SUB IS GREATER THAN +20
  5505         GO TO 7000-FINISH-BUILD.
  5506
  5507     MOVE WS-INIT-VALUE (SUB2) TO EL158-BENE-INIT( SUB).
  5508     MOVE AL-SANON             TO EL158-BENE-INIT-ATTRB (SUB).
  5509     MOVE FO-PLAN-TYPE  (SUB2)        TO  EL158-BENE-TYPE  (SUB).
  5510     MOVE FO-PLAN-ID    (SUB2)        TO  EL158-BENE-ID    (SUB).
  5511     IF FO-PLAN-TYPE (SUB2) GREATER THAN SPACES
  5512         MOVE FO-PLAN-TERM  (SUB2)    TO  EL158-BENE-TERM  (SUB)
  5513     ELSE
  5514         MOVE SPACES                  TO  EL158-BENE-TERM-R(SUB).
  5515     MOVE FO-PLAN-REFUND-METHOD(SUB2) TO  EL158-BENE-REFM  (SUB).
  5516
  5517     IF FO-PLAN-TYPE   (SUB2) GREATER THAN SPACES
  5518        MOVE AL-UANON         TO  EL158-BENE-ATTRB      (SUB)
  5519        MOVE AL-UNNON         TO  EL158-BENE-TERM-ATTRB (SUB)
  5520        MOVE AL-UANON         TO  EL158-BENE-REFM-ATTRB (SUB).
  5521
  5522     GO TO 7000-BUILD-BENEFIT-LOOP.
  5523
  5524 7000-FINISH-BUILD.
  5525
  5526     MOVE FO-COMMENT-LINE-1          TO  DESCO.
  5527
  5528     MOVE -1                         TO  MAINTL.
  5529     MOVE AL-UANON                   TO  STATEA
  5530                                         FORMA
  5531                                         EXPDTA.
  5532     GO TO 8100-SEND-INITIAL-MAP.
  5533
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL158.cbl
  5535 7100-READ-BENEFIT.
  5536
  5537
  5538* EXEC CICS HANDLE CONDITION
  5539*        NOTFND   (7120-NOT-FOUND)
  5540*    END-EXEC.
  5541*    MOVE '"$I                   ! '' #00005223' TO DFHEIV0
  5542     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5543     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5544     MOVE X'2720233030303035323233' TO DFHEIV0(25:11)
  5545     CALL 'kxdfhei1' USING DFHEIV0
  5546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5547
  5548
  5549
  5550* EXEC CICS READ
  5551*        DATASET   (ELCNTL-FILE-ID)
  5552*        RIDFLD    (ELCNTL-KEY)
  5553*        SET       (ADDRESS OF CONTROL-FILE)
  5554*        GTEQ
  5555*    END-EXEC.
  5556*    MOVE '&"S        G          (   #00005227' TO DFHEIV0
  5557     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  5558     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5559     MOVE X'2020233030303035323237' TO DFHEIV0(25:11)
  5560     CALL 'kxdfhei1' USING DFHEIV0,
  5561           ELCNTL-FILE-ID,
  5562           DFHEIV20,
  5563           DFHEIV99,
  5564           ELCNTL-KEY,
  5565           DFHEIV99,
  5566           DFHEIV99,
  5567           DFHEIV99
  5568     SET ADDRESS OF CONTROL-FILE TO
  5569         DFHEIV20
  5570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5571
  5572
  5573     IF PI-COMPANY-ID IS NOT EQUAL TO CF-COMPANY-ID OR
  5574        ELCNTL-RECORD-TYPE IS NOT EQUAL TO CF-RECORD-TYPE
  5575         GO TO 7120-NOT-FOUND.
  5576
  5577     MOVE +1                         TO  SUB-1.
  5578
  5579 7110-LOOP.
  5580
  5581     IF SUB-1 IS EQUAL TO +9
  5582         GO TO 7120-NOT-FOUND.
  5583
  5584     IF WS-BENE-CODE IS NOT EQUAL TO CF-BENEFIT-CODE (SUB-1)
  5585         ADD +1                      TO  SUB-1
  5586         GO TO 7110-LOOP.
  5587
  5588     MOVE 'Y'                        TO  WS-CNTL-REC-FOUND-SW.
  5589     GO TO 7199-EXIT.
  5590
  5591 7120-NOT-FOUND.
  5592     MOVE 'N'                        TO  WS-CNTL-REC-FOUND-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL158.cbl
  5593
  5594 7199-EXIT.
  5595     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL158.cbl
  5597 8000-READ-CNTL.
  5598
  5599
  5600* EXEC CICS HANDLE CONDITION
  5601*        NOTFND   (8009-NOTFND)
  5602*    END-EXEC.
  5603*    MOVE '"$I                   ! ( #00005260' TO DFHEIV0
  5604     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5605     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5606     MOVE X'2820233030303035323630' TO DFHEIV0(25:11)
  5607     CALL 'kxdfhei1' USING DFHEIV0
  5608     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5609
  5610
  5611
  5612* EXEC CICS READ
  5613*        DATASET   (ELCNTL-FILE-ID)
  5614*        RIDFLD    (ELCNTL-KEY)
  5615*        SET       (ADDRESS OF CONTROL-FILE)
  5616*    END-EXEC.
  5617*    MOVE '&"S        E          (   #00005264' TO DFHEIV0
  5618     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5619     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5620     MOVE X'2020233030303035323634' TO DFHEIV0(25:11)
  5621     CALL 'kxdfhei1' USING DFHEIV0,
  5622           ELCNTL-FILE-ID,
  5623           DFHEIV20,
  5624           DFHEIV99,
  5625           ELCNTL-KEY,
  5626           DFHEIV99,
  5627           DFHEIV99,
  5628           DFHEIV99
  5629     SET ADDRESS OF CONTROL-FILE TO
  5630         DFHEIV20
  5631     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5632
  5633
  5634     MOVE 'Y'                         TO  WS-CNTL-REC-FOUND-SW.
  5635     GO TO 8010-EXIT.
  5636
  5637 8009-NOTFND.
  5638     MOVE 'N'                         TO  WS-CNTL-REC-FOUND-SW.
  5639
  5640 8010-EXIT.
  5641     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL158.cbl
  5643 8100-SEND-INITIAL-MAP.
  5644
  5645     MOVE PI-LIFE-OVERRIDE-L2        TO  LFHDGO.
  5646     MOVE PI-AH-OVERRIDE-L2          TO  AHHDGO.
  5647     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSG1O.
  5648     MOVE EIBTIME                    TO  TIME-IN.
  5649     MOVE SAVE-DATE                  TO  DATEO.
  5650     MOVE TIME-OUT                   TO  TIMEO.
  5651
  5652
  5653* EXEC CICS SEND
  5654*        MAP      (WS-MAP-NAME)
  5655*        MAPSET   (MAPSET-NAME)
  5656*        FROM     (EL158AO)
  5657*        ERASE
  5658*        CURSOR
  5659*    END-EXEC.
  5660     MOVE LENGTH OF
  5661      EL158AO
  5662       TO DFHEIV12
  5663     MOVE -1
  5664       TO DFHEIV11
  5665*    MOVE '8$     CT  E    H L F ,   #00005288' TO DFHEIV0
  5666     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  5667     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5668     MOVE X'2020233030303035323838' TO DFHEIV0(25:11)
  5669     CALL 'kxdfhei1' USING DFHEIV0,
  5670           WS-MAP-NAME,
  5671           EL158AO,
  5672           DFHEIV12,
  5673           MAPSET-NAME,
  5674           DFHEIV99,
  5675           DFHEIV99,
  5676           DFHEIV99,
  5677           DFHEIV11,
  5678           DFHEIV99,
  5679           DFHEIV99,
  5680           DFHEIV99
  5681     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5682
  5683
  5684     GO TO 9100-RETURN-TRAN.
  5685
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL158.cbl
  5687 8200-SEND-DATAONLY.
  5688
  5689     MOVE PI-LIFE-OVERRIDE-L2        TO  LFHDGO.
  5690     MOVE PI-AH-OVERRIDE-L2          TO  AHHDGO.
  5691     MOVE EMI-MESSAGE-AREA (1)       TO  ERRMSG1O.
  5692     MOVE EIBTIME                    TO  TIME-IN.
  5693     MOVE SAVE-DATE                  TO  DATEO.
  5694     MOVE TIME-OUT                   TO  TIMEO.
  5695
  5696
  5697* EXEC CICS SEND
  5698*        MAP      (WS-MAP-NAME)
  5699*        MAPSET   (MAPSET-NAME)
  5700*        FROM     (EL158AO)
  5701*        DATAONLY
  5702*        CURSOR
  5703*    END-EXEC.
  5704     MOVE LENGTH OF
  5705      EL158AO
  5706       TO DFHEIV12
  5707     MOVE -1
  5708       TO DFHEIV11
  5709*    MOVE '8$D    CT       H L F ,   #00005308' TO DFHEIV0
  5710     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  5711     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5712     MOVE X'2020233030303035333038' TO DFHEIV0(25:11)
  5713     CALL 'kxdfhei1' USING DFHEIV0,
  5714           WS-MAP-NAME,
  5715           EL158AO,
  5716           DFHEIV12,
  5717           MAPSET-NAME,
  5718           DFHEIV99,
  5719           DFHEIV99,
  5720           DFHEIV99,
  5721           DFHEIV11,
  5722           DFHEIV99,
  5723           DFHEIV99,
  5724           DFHEIV99
  5725     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5726
  5727
  5728     GO TO 9100-RETURN-TRAN.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL158.cbl
  5730 8300-SEND-TEXT.
  5731
  5732
  5733* EXEC CICS SEND TEXT
  5734*        FROM  (LOGOFF-TEXT)
  5735*        LENGTH(LOGOFF-LENGTH)
  5736*        ERASE
  5737*        FREEKB
  5738*    END-EXEC.
  5739*    MOVE '8&      T  E F  H   F -   #00005320' TO DFHEIV0
  5740     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5741     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5742     MOVE X'2020233030303035333230' TO DFHEIV0(25:11)
  5743     CALL 'kxdfhei1' USING DFHEIV0,
  5744           LOGOFF-TEXT,
  5745           LOGOFF-LENGTH,
  5746           DFHEIV99,
  5747           DFHEIV99,
  5748           DFHEIV99,
  5749           DFHEIV99,
  5750           DFHEIV99,
  5751           DFHEIV99,
  5752           DFHEIV99,
  5753           DFHEIV99,
  5754           DFHEIV99,
  5755           DFHEIV99
  5756     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5757
  5758
  5759
  5760* EXEC CICS RETURN
  5761*        END-EXEC.
  5762*    MOVE '.(                    &   #00005327' TO DFHEIV0
  5763     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5764     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5765     MOVE X'2020233030303035333237' TO DFHEIV0(25:11)
  5766     CALL 'kxdfhei1' USING DFHEIV0,
  5767           DFHEIV99,
  5768           DFHEIV99,
  5769           DFHEIV99,
  5770           DFHEIV99,
  5771           DFHEIV99
  5772     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5773
  5774
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL158.cbl
  5776*8400-LOG-JOURNAL-RECORD.
  5777*    MOVE PI-PROCESSOR-ID            TO  JP-USER-ID.
  5778*    MOVE ELBENE-FILE-ID             TO  JP-FILE-ID.
  5779*    MOVE THIS-PGM                   TO  JP-PROGRAM-ID.
  5780*    EXEC CICS JOURNAL
  5781*         JFILEID   (PI-JOURNAL-FILE-ID)
  5782*         JTYPEID   ('EL')
  5783*         FROM      (JOURNAL-RECORD)
  5784*         LENGTH    (527)
  5785*         END-EXEC.
  5786
  5787 8600-DEEDIT.
  5788
  5789
  5790* EXEC CICS BIF DEEDIT
  5791*        FIELD    (DEEDIT-FIELD)
  5792*        LENGTH   (15)
  5793*    END-EXEC.
  5794     MOVE 15
  5795       TO DFHEIV11
  5796*    MOVE '@"L                   #   #00005344' TO DFHEIV0
  5797     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5798     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5799     MOVE X'2020233030303035333434' TO DFHEIV0(25:11)
  5800     CALL 'kxdfhei1' USING DFHEIV0,
  5801           DEEDIT-FIELD,
  5802           DFHEIV11
  5803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5804
  5805
  5806 8600-EXIT.
  5807     EXIT.
  5808
  5809 8800-UNAUTHORIZED-ACCESS.
  5810     MOVE UNACCESS-MSG               TO  LOGOFF-MSG.
  5811     GO TO 8300-SEND-TEXT.
  5812
  5813 8810-PF23.
  5814     MOVE EIBAID                     TO  PI-ENTRY-CD-1.
  5815     MOVE XCTL-005                   TO  PGM-NAME.
  5816     GO TO 9300-XCTL.
  5817
  5818 8850-DUPREC.
  5819     MOVE ER-0132                    TO  EMI-ERROR.
  5820     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5821     MOVE -1                         TO  STATEL.
  5822     MOVE AL-UABON                   TO  STATEA  FORMA  EXPDTA.
  5823     GO TO 8100-SEND-INITIAL-MAP.
  5824
  5825 8870-NOTOPEN.
  5826
  5827     MOVE LOW-VALUES                 TO  EL158AO.
  5828     MOVE -1                         TO  MAINTL.
  5829     MOVE ER-0701                    TO  EMI-ERROR.
  5830     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5831     GO TO 8100-SEND-INITIAL-MAP.
  5832
  5833 8880-NOT-FOUND.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL158.cbl
  5834     MOVE ER-0702                    TO  EMI-ERROR.
  5835     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5836     MOVE -1                         TO  STATEL.
  5837     MOVE AL-UABON                   TO  STATEA  FORMA EXPDTA.
  5838     GO TO 8100-SEND-INITIAL-MAP.
  5839
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL158.cbl
  5841 9100-RETURN-TRAN.
  5842     MOVE EMI-ERROR-NUMBER (1)       TO  PI-LAST-ERROR-NO.
  5843     MOVE '158A'                     TO  PI-CURRENT-SCREEN-NO.
  5844
  5845
  5846* EXEC CICS RETURN
  5847*        TRANSID    (TRANS-ID)
  5848*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  5849*        LENGTH     (PI-COMM-LENGTH)
  5850*    END-EXEC.
  5851*    MOVE '.(CT                  &   #00005388' TO DFHEIV0
  5852     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5853     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5854     MOVE X'2020233030303035333838' TO DFHEIV0(25:11)
  5855     CALL 'kxdfhei1' USING DFHEIV0,
  5856           TRANS-ID,
  5857           PROGRAM-INTERFACE-BLOCK,
  5858           PI-COMM-LENGTH,
  5859           DFHEIV99,
  5860           DFHEIV99
  5861     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5862
  5863
  5864 9200-RETURN-MAIN-MENU.
  5865
  5866     MOVE XCTL-626                   TO  PGM-NAME.
  5867     GO TO 9300-XCTL.
  5868
  5869 9300-XCTL.
  5870
  5871* EXEC CICS XCTL
  5872*        PROGRAM    (PGM-NAME)
  5873*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  5874*        LENGTH     (PI-COMM-LENGTH)
  5875*    END-EXEC.
  5876*    MOVE '.$C                   $   #00005400' TO DFHEIV0
  5877     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5878     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5879     MOVE X'2020233030303035343030' TO DFHEIV0(25:11)
  5880     CALL 'kxdfhei1' USING DFHEIV0,
  5881           PGM-NAME,
  5882           PROGRAM-INTERFACE-BLOCK,
  5883           PI-COMM-LENGTH
  5884     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5885
  5886
  5887 9400-CLEAR.
  5888     MOVE PI-RETURN-TO-PROGRAM       TO  PGM-NAME.
  5889     GO TO 9300-XCTL.
  5890
  5891 9500-PF12.
  5892     MOVE XCTL-010                   TO  PGM-NAME.
  5893     GO TO 9300-XCTL.
  5894
  5895 9600-PGMID-ERROR.
  5896
  5897* EXEC CICS HANDLE CONDITION
  5898*        PGMIDERR   (8300-SEND-TEXT)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL158.cbl
  5899*    END-EXEC.
  5900*    MOVE '"$L                   ! ) #00005415' TO DFHEIV0
  5901     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5902     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5903     MOVE X'2920233030303035343135' TO DFHEIV0(25:11)
  5904     CALL 'kxdfhei1' USING DFHEIV0
  5905     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5906
  5907
  5908     MOVE PGM-NAME                   TO  PI-CALLING-PROGRAM.
  5909     MOVE ' '                        TO  PI-ENTRY-CD-1.
  5910     MOVE XCTL-005                   TO  PGM-NAME.
  5911     MOVE PGM-NAME                   TO  LOGOFF-PGM.
  5912     MOVE PGMIDERR-MSG               TO  LOGOFF-FILL.
  5913     GO TO 9300-XCTL.
  5914
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL158.cbl
  5916 9700-LINK-DATE-CONVERT.
  5917
  5918* EXEC CICS LINK
  5919*        PROGRAM    ('ELDATCV')
  5920*        COMMAREA   (DATE-CONVERSION-DATA)
  5921*        LENGTH     (DC-COMM-LENGTH)
  5922*    END-EXEC.
  5923     MOVE 'ELDATCV' TO DFHEIV1
  5924*    MOVE '."C                   ''   #00005428' TO DFHEIV0
  5925     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5926     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5927     MOVE X'2020233030303035343238' TO DFHEIV0(25:11)
  5928     CALL 'kxdfhei1' USING DFHEIV0,
  5929           DFHEIV1,
  5930           DATE-CONVERSION-DATA,
  5931           DC-COMM-LENGTH,
  5932           DFHEIV99,
  5933           DFHEIV99,
  5934           DFHEIV99
  5935     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5936
  5937
  5938 9700-EXIT.
  5939     EXIT.
  5940
  5941 9900-ERROR-FORMAT.
  5942     IF NOT EMI-ERRORS-COMPLETE
  5943         MOVE LINK-001               TO  PGM-NAME
  5944
  5945* EXEC CICS LINK
  5946*            PROGRAM    (PGM-NAME)
  5947*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  5948*            LENGTH     (EMI-COMM-LENGTH)
  5949*        END-EXEC.
  5950*    MOVE '."C                   ''   #00005440' TO DFHEIV0
  5951     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5952     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5953     MOVE X'2020233030303035343430' TO DFHEIV0(25:11)
  5954     CALL 'kxdfhei1' USING DFHEIV0,
  5955           PGM-NAME,
  5956           ERROR-MESSAGE-INTERFACE-BLOCK,
  5957           EMI-COMM-LENGTH,
  5958           DFHEIV99,
  5959           DFHEIV99,
  5960           DFHEIV99
  5961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5962
  5963
  5964 9900-EXIT.
  5965     EXIT.
  5966
  5967 9990-ABEND.
  5968     MOVE LINK-004                   TO  PGM-NAME.
  5969     MOVE DFHEIBLK                   TO  EMI-LINE1.
  5970
  5971* EXEC CICS LINK
  5972*        PROGRAM   (PGM-NAME)
  5973*        COMMAREA  (EMI-LINE1)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL158.cbl
  5974*        LENGTH    (72)
  5975*    END-EXEC.
  5976     MOVE 72
  5977       TO DFHEIV11
  5978*    MOVE '."C                   ''   #00005452' TO DFHEIV0
  5979     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5980     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5981     MOVE X'2020233030303035343532' TO DFHEIV0(25:11)
  5982     CALL 'kxdfhei1' USING DFHEIV0,
  5983           PGM-NAME,
  5984           EMI-LINE1,
  5985           DFHEIV11,
  5986           DFHEIV99,
  5987           DFHEIV99,
  5988           DFHEIV99
  5989     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5990
  5991
  5992     GO TO 8100-SEND-INITIAL-MAP.
  5993
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL158.cbl
  5995 9995-SECURITY-VIOLATION.
  5996*                            COPY ELCSCTP.
  5997******************************************************************
  5998*                                                                *
  5999*                            ELCSCTP                             *
  6000*                            VMOD=2.001                          *
  6001*                                                                *
  6002*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  6003******************************************************************
  6004
  6005
  6006     MOVE EIBDATE          TO SM-JUL-DATE.
  6007     MOVE EIBTRMID         TO SM-TERMID.
  6008     MOVE THIS-PGM         TO SM-PGM.
  6009     MOVE EIBTIME          TO TIME-IN.
  6010     MOVE TIME-OUT         TO SM-TIME.
  6011     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  6012
  6013
  6014* EXEC CICS LINK
  6015*         PROGRAM  ('EL003')
  6016*         COMMAREA (SECURITY-MESSAGE)
  6017*         LENGTH   (80)
  6018*    END-EXEC.
  6019     MOVE 'EL003' TO DFHEIV1
  6020     MOVE 80
  6021       TO DFHEIV11
  6022*    MOVE '."C                   ''   #00005479' TO DFHEIV0
  6023     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  6024     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6025     MOVE X'2020233030303035343739' TO DFHEIV0(25:11)
  6026     CALL 'kxdfhei1' USING DFHEIV0,
  6027           DFHEIV1,
  6028           SECURITY-MESSAGE,
  6029           DFHEIV11,
  6030           DFHEIV99,
  6031           DFHEIV99,
  6032           DFHEIV99
  6033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6034
  6035
  6036******************************************************************
  6037
  6038
  6039 9995-EXIT.
  6040     EXIT.
  6041
  6042
  6043 9999-DFHBACK SECTION.
  6044     MOVE '9%                    "   ' TO DFHEIV0
  6045     MOVE 'EL158' TO DFHEIV1
  6046     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6047     GOBACK.
  6048 9999-DFHEXIT.
  6049     IF DFHEIGDJ EQUAL 0001
  6050         NEXT SENTENCE
  6051     ELSE IF DFHEIGDJ EQUAL 2
  6052         GO TO 8850-DUPREC,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL158.cbl
  6053               8870-NOTOPEN,
  6054               8880-NOT-FOUND,
  6055               9600-PGMID-ERROR,
  6056               9990-ABEND
  6057         DEPENDING ON DFHEIGDI
  6058     ELSE IF DFHEIGDJ EQUAL 3
  6059         GO TO 0100-FORM-NOTFND
  6060         DEPENDING ON DFHEIGDI
  6061     ELSE IF DFHEIGDJ EQUAL 4
  6062         GO TO 1000-FORM-NOTFND
  6063         DEPENDING ON DFHEIGDI
  6064     ELSE IF DFHEIGDJ EQUAL 5
  6065         GO TO 5000-UNSUCCESSFUL-SEARCH
  6066         DEPENDING ON DFHEIGDI
  6067     ELSE IF DFHEIGDJ EQUAL 6
  6068         GO TO 5100-UNSUCCESSFUL-SEARCH
  6069         DEPENDING ON DFHEIGDI
  6070     ELSE IF DFHEIGDJ EQUAL 7
  6071         GO TO 7120-NOT-FOUND
  6072         DEPENDING ON DFHEIGDI
  6073     ELSE IF DFHEIGDJ EQUAL 8
  6074         GO TO 8009-NOTFND
  6075         DEPENDING ON DFHEIGDI
  6076     ELSE IF DFHEIGDJ EQUAL 9
  6077         GO TO 8300-SEND-TEXT
  6078         DEPENDING ON DFHEIGDI.
  6079     MOVE '9%                    "   ' TO DFHEIV0
  6080     MOVE 'EL158' TO DFHEIV1
  6081     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6082     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5160     Code:       14189
