* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL679.cbl
* Options: int("EL679.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL679.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL679.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL679.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL679.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/14/96 07:57:55.
     7*                            VMOD=2.003
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL679.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION - EXF5 - BILLING STATUS REPORT.
    25*            PAYMENT SCREEN.
    26 ENVIRONMENT DIVISION.
    27
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL679.cbl
    29 DATA DIVISION.
    30 WORKING-STORAGE SECTION.
    31 01  DFH-START PIC X(04).
    32 77  FILLER  PIC X(32)  VALUE '********************************'.
    33 77  FILLER  PIC X(32)  VALUE '*     EL679 WORKING STORAGE    *'.
    34 77  FILLER  PIC X(32)  VALUE '************ V/M 2.003 *********'.
    35
    36 01  WS-DATE-AREA.
    37     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    38     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
    39
    40 01  STANDARD-AREAS.
    41     12  MAP-NAME            PIC X(8)    VALUE 'EL679A'.
    42     12  MAPSET-NAME         PIC X(8)    VALUE 'EL679S'.
    43     12  SCREEN-NUMBER       PIC X(4)    VALUE '640C'.
    44     12  TRANS-ID            PIC X(4)    VALUE 'EXF5'.
    45     12  TRANS-6791          PIC X(4)    VALUE 'EXG5'.
    46     12  THIS-PGM            PIC X(8)    VALUE 'EL679'.
    47     12  PGM-NAME            PIC X(8).
    48     12  TIME-IN             PIC S9(7).
    49     12  TIME-OUT-R  REDEFINES TIME-IN.
    50         16  FILLER          PIC X.
    51         16  TIME-OUT        PIC 99V99.
    52         16  FILLER          PIC X(2).
    53     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
    54     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
    55     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
    56     12  LINK-001            PIC X(8)    VALUE 'EL001'.
    57     12  LINK-004            PIC X(8)    VALUE 'EL004'.
    58     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
    59     12  ERBILL-FILE-ID      PIC X(8)    VALUE 'ERBILL'.
    60     12  ELCNTL-FILE-ID      PIC X(8)    VALUE 'ELCNTL'.
    61
    62 01  WORK-AREAS.
    63     12  TEXT-SUB            PIC 99      VALUE ZEROS.
    64     12  NDX                 PIC 99      VALUE ZEROS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL679.cbl
    66 01  ACCESS-KEYS.
    67     12  ERBILL-KEY.
    68         16  ERBILL-CO-CD        PIC X       VALUE SPACE.
    69         16  ERBILL-COMPARE.
    70             20  ERBILL-CARRIER  PIC X       VALUE SPACE.
    71             20  ERBILL-GROUP    PIC X(6)    VALUE SPACES.
    72             20  ERBILL-ACCT     PIC X(10)   VALUE SPACES.
    73             20  ERBILL-FIN-RESP PIC X(10)   VALUE SPACES.
    74         16  ERBILL-REC-TYPE     PIC X       VALUE SPACE.
    75         16  ERBILL-LINE-SEQ-NO  PIC S9(4)   COMP VALUE ZEROS.
    76
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL679.cbl
    78*    COPY ELCDATE.
    79******************************************************************
    80*                                                                *
    81*                                                                *
    82*                            ELCDATE.                            *
    83*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    84*                            VMOD=2.003
    85*                                                                *
    86*                                                                *
    87*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
    88*                 LENGTH = 200                                   *
    89******************************************************************
    90
    91 01  DATE-CONVERSION-DATA.
    92     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
    93     12  DC-OPTION-CODE                PIC X.
    94         88  BIN-TO-GREG                VALUE ' '.
    95         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
    96         88  EDIT-GREG-TO-BIN           VALUE '2'.
    97         88  YMD-GREG-TO-BIN            VALUE '3'.
    98         88  MDY-GREG-TO-BIN            VALUE '4'.
    99         88  JULIAN-TO-BIN              VALUE '5'.
   100         88  BIN-PLUS-ELAPSED           VALUE '6'.
   101         88  FIND-CENTURY               VALUE '7'.
   102         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   103         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   104         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   105         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   106         88  JULIAN-TO-BIN-3            VALUE 'C'.
   107         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   108         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   109         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   110         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   111         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   112         88  CHECK-LEAP-YEAR            VALUE 'H'.
   113         88  BIN-3-TO-GREG              VALUE 'I'.
   114         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   115         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   116         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   117         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   118         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   119         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   120         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   121         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   122         88  THREE-CHARACTER-BIN
   123                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   124         88  GREGORIAN-TO-BIN
   125                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   126         88  BIN-TO-GREGORIAN
   127                  VALUES ' ' '1' 'I' '8' 'G'.
   128         88  JULIAN-TO-BINARY
   129                  VALUES '5' 'C' 'E' 'F'.
   130     12  DC-ERROR-CODE                 PIC X.
   131         88  NO-CONVERSION-ERROR        VALUE ' '.
   132         88  DATE-CONVERSION-ERROR
   133                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   134         88  DATE-IS-ZERO               VALUE '1'.
   135         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL679.cbl
   136         88  DATE-IS-INVALID            VALUE '3'.
   137         88  DATE1-GREATER-DATE2        VALUE '4'.
   138         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   139         88  DATE-INVALID-OPTION        VALUE '9'.
   140         88  INVALID-CENTURY            VALUE 'A'.
   141         88  ONLY-CENTURY               VALUE 'B'.
   142         88  ONLY-LEAP-YEAR             VALUE 'C'.
   143         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   144     12  DC-END-OF-MONTH               PIC X.
   145         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   146     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   147         88  USE-NORMAL-PROCESS         VALUE ' '.
   148         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   149         88  ADJUST-UP-100-YRS          VALUE '2'.
   150     12  FILLER                        PIC X.
   151     12  DC-CONVERSION-DATES.
   152         16  DC-BIN-DATE-1             PIC XX.
   153         16  DC-BIN-DATE-2             PIC XX.
   154         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   155         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   156                       DC-GREG-DATE-1-EDIT.
   157             20  DC-EDIT1-MONTH        PIC 99.
   158             20  SLASH1-1              PIC X.
   159             20  DC-EDIT1-DAY          PIC 99.
   160             20  SLASH1-2              PIC X.
   161             20  DC-EDIT1-YEAR         PIC 99.
   162         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   163         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   164                     DC-GREG-DATE-2-EDIT.
   165             20  DC-EDIT2-MONTH        PIC 99.
   166             20  SLASH2-1              PIC X.
   167             20  DC-EDIT2-DAY          PIC 99.
   168             20  SLASH2-2              PIC X.
   169             20  DC-EDIT2-YEAR         PIC 99.
   170         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   171         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   172                     DC-GREG-DATE-1-YMD.
   173             20  DC-YMD-YEAR           PIC 99.
   174             20  DC-YMD-MONTH          PIC 99.
   175             20  DC-YMD-DAY            PIC 99.
   176         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   177         16  DC-GREG-DATE-1-MDY-R REDEFINES
   178                      DC-GREG-DATE-1-MDY.
   179             20  DC-MDY-MONTH          PIC 99.
   180             20  DC-MDY-DAY            PIC 99.
   181             20  DC-MDY-YEAR           PIC 99.
   182         16  DC-GREG-DATE-1-ALPHA.
   183             20  DC-ALPHA-MONTH        PIC X(10).
   184             20  DC-ALPHA-DAY          PIC 99.
   185             20  FILLER                PIC XX.
   186             20  DC-ALPHA-CENTURY.
   187                 24 DC-ALPHA-CEN-N     PIC 99.
   188             20  DC-ALPHA-YEAR         PIC 99.
   189         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   190         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   191         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   192         16  DC-JULIAN-DATE            PIC 9(05).
   193         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL679.cbl
   194                                       PIC 9(05).
   195         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   196             20  DC-JULIAN-YEAR        PIC 99.
   197             20  DC-JULIAN-DAYS        PIC 999.
   198         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   199         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   200         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   201     12  DATE-CONVERSION-VARIBLES.
   202         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   203         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   204             20  FILLER                PIC 9(3).
   205             20  HOLD-CEN-1-CCYY.
   206                 24  HOLD-CEN-1-CC     PIC 99.
   207                 24  HOLD-CEN-1-YY     PIC 99.
   208             20  HOLD-CEN-1-MO         PIC 99.
   209             20  HOLD-CEN-1-DA         PIC 99.
   210         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   211             20  HOLD-CEN-1-R-MO       PIC 99.
   212             20  HOLD-CEN-1-R-DA       PIC 99.
   213             20  HOLD-CEN-1-R-CCYY.
   214                 24  HOLD-CEN-1-R-CC   PIC 99.
   215                 24  HOLD-CEN-1-R-YY   PIC 99.
   216             20  FILLER                PIC 9(3).
   217         16  HOLD-CENTURY-1-X.
   218             20  FILLER                PIC X(3)  VALUE SPACES.
   219             20  HOLD-CEN-1-X-CCYY.
   220                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   221                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   222             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   223             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   224         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   225             20  HOLD-CEN-1-R-X-MO     PIC XX.
   226             20  HOLD-CEN-1-R-X-DA     PIC XX.
   227             20  HOLD-CEN-1-R-X-CCYY.
   228                 24  HOLD-CEN-1-R-X-CC PIC XX.
   229                 24  HOLD-CEN-1-R-X-YY PIC XX.
   230             20  FILLER                PIC XXX.
   231         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   232         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   233         16  DC-JULIAN-DATE-1          PIC 9(07).
   234         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   235             20  DC-JULIAN-1-CCYY.
   236                 24  DC-JULIAN-1-CC    PIC 99.
   237                 24  DC-JULIAN-1-YR    PIC 99.
   238             20  DC-JULIAN-DA-1        PIC 999.
   239         16  DC-JULIAN-DATE-2          PIC 9(07).
   240         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   241             20  DC-JULIAN-2-CCYY.
   242                 24  DC-JULIAN-2-CC    PIC 99.
   243                 24  DC-JULIAN-2-YR    PIC 99.
   244             20  DC-JULIAN-DA-2        PIC 999.
   245         16  DC-GREG-DATE-A-EDIT.
   246             20  DC-EDITA-MONTH        PIC 99.
   247             20  SLASHA-1              PIC X VALUE '/'.
   248             20  DC-EDITA-DAY          PIC 99.
   249             20  SLASHA-2              PIC X VALUE '/'.
   250             20  DC-EDITA-CCYY.
   251                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL679.cbl
   252                 24  DC-EDITA-YEAR     PIC 99.
   253         16  DC-GREG-DATE-B-EDIT.
   254             20  DC-EDITB-MONTH        PIC 99.
   255             20  SLASHB-1              PIC X VALUE '/'.
   256             20  DC-EDITB-DAY          PIC 99.
   257             20  SLASHB-2              PIC X VALUE '/'.
   258             20  DC-EDITB-CCYY.
   259                 24  DC-EDITB-CENT     PIC 99.
   260                 24  DC-EDITB-YEAR     PIC 99.
   261         16  DC-GREG-DATE-CYMD         PIC 9(08).
   262         16  DC-GREG-DATE-CYMD-R REDEFINES
   263                              DC-GREG-DATE-CYMD.
   264             20  DC-CYMD-CEN           PIC 99.
   265             20  DC-CYMD-YEAR          PIC 99.
   266             20  DC-CYMD-MONTH         PIC 99.
   267             20  DC-CYMD-DAY           PIC 99.
   268         16  DC-GREG-DATE-MDCY         PIC 9(08).
   269         16  DC-GREG-DATE-MDCY-R REDEFINES
   270                              DC-GREG-DATE-MDCY.
   271             20  DC-MDCY-MONTH         PIC 99.
   272             20  DC-MDCY-DAY           PIC 99.
   273             20  DC-MDCY-CEN           PIC 99.
   274             20  DC-MDCY-YEAR          PIC 99.
   275    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   276        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   277    12  DC-EL310-DATE                  PIC X(21).
   278    12  FILLER                         PIC X(28).
   279
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL679.cbl
   281*    COPY ELCLOGOF.
   282******************************************************************
   283*                                                                *
   284*                                                                *
   285*                            ELCLOGOF.                           *
   286*                            VMOD=2.001                          *
   287*                                                                *
   288*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   289*                                                                *
   290******************************************************************
   291 01  CLASIC-LOGOFF.
   292     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   293     12  LOGOFF-TEXT.
   294         16  FILLER          PIC X(5)    VALUE SPACES.
   295         16  LOGOFF-MSG.
   296             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   297             20  FILLER      PIC X       VALUE SPACES.
   298             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   299         16  FILLER          PIC X(80)
   300           VALUE '* YOU ARE NOW LOGGED OFF'.
   301         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   302         16  FILLER          PIC X       VALUE QUOTE.
   303         16  LOGOFF-SYS-MSG  PIC X(17)
   304           VALUE 'S CLAS-IC SYSTEM '.
   305     12  TEXT-MESSAGES.
   306         16  UNACCESS-MSG    PIC X(29)
   307             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   308         16  PGMIDERR-MSG    PIC X(17)
   309             VALUE 'PROGRAM NOT FOUND'.
   310
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL679.cbl
   312*    COPY ELCATTR.
   313******************************************************************
   314*                                                                *
   315*                            ELCATTR.                            *
   316*                            VMOD=2.001                          *
   317*                                                                *
   318*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   319*                                                                *
   320*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   321*                                                                *
   322*                   POS 1   P=PROTECTED                          *
   323*                           U=UNPROTECTED                        *
   324*                           S=ASKIP                              *
   325*                   POS 2   A=ALPHA/NUMERIC                      *
   326*                           N=NUMERIC                            *
   327*                   POS 3   N=NORMAL                             *
   328*                           B=BRIGHT                             *
   329*                           D=DARK                               *
   330*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   331*                           OF=MODIFIED DATA TAG OFF             *
   332*                                                                *
   333*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   334******************************************************************
   335 01  ATTRIBUTE-LIST.
   336     12  AL-PABOF            PIC X       VALUE 'Y'.
   337     12  AL-PABON            PIC X       VALUE 'Z'.
   338     12  AL-PADOF            PIC X       VALUE '%'.
   339     12  AL-PADON            PIC X       VALUE '_'.
   340     12  AL-PANOF            PIC X       VALUE '-'.
   341     12  AL-PANON            PIC X       VALUE '/'.
   342     12  AL-SABOF            PIC X       VALUE '8'.
   343     12  AL-SABON            PIC X       VALUE '9'.
   344     12  AL-SADOF            PIC X       VALUE '@'.
   345     12  AL-SADON            PIC X       VALUE QUOTE.
   346     12  AL-SANOF            PIC X       VALUE '0'.
   347     12  AL-SANON            PIC X       VALUE '1'.
   348     12  AL-UABOF            PIC X       VALUE 'H'.
   349     12  AL-UABON            PIC X       VALUE 'I'.
   350     12  AL-UADOF            PIC X       VALUE '<'.
   351     12  AL-UADON            PIC X       VALUE '('.
   352     12  AL-UANOF            PIC X       VALUE ' '.
   353     12  AL-UANON            PIC X       VALUE 'A'.
   354     12  AL-UNBOF            PIC X       VALUE 'Q'.
   355     12  AL-UNBON            PIC X       VALUE 'R'.
   356     12  AL-UNDOF            PIC X       VALUE '*'.
   357     12  AL-UNDON            PIC X       VALUE ')'.
   358     12  AL-UNNOF            PIC X       VALUE '&'.
   359     12  AL-UNNON            PIC X       VALUE 'J'.
   360
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL679.cbl
   362*    COPY ELCEMIB.
   363******************************************************************
   364*                                                                *
   365*                                                                *
   366*                            ELCEMIB.                            *
   367*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   368*                            VMOD=2.005                          *
   369*                                                                *
   370*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   371*                                                                *
   372******************************************************************
   373 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   374     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   375     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   376     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   377     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   378     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   379     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   380     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   381     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   382     12  EMI-SWITCH1             PIC X        VALUE '1'.
   383         88  EMI-NO-ERRORS                    VALUE '1'.
   384         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   385         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   386     12  EMI-SWITCH2             PIC X        VALUE '1'.
   387         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   388     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   389         88  EMI-AREA1-EMPTY                  VALUE '1'.
   390         88  EMI-AREA1-FULL                   VALUE '2'.
   391     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   392         88  EMI-AREA2-EMPTY                  VALUE '1'.
   393         88  EMI-AREA2-FULL                   VALUE '2'.
   394     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   395         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   396         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   397         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   398         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   399         88  EMI-BYPASS-FATALS                VALUE 'X'.
   400     12  EMI-ERROR-LINES.
   401         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   402         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   403         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   404         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   405             20  EMI-ERR-CODES OCCURS 10 TIMES.
   406                 24  EMI-ERR-NUM         PIC X(4).
   407                 24  EMI-FILLER          PIC X.
   408                 24  EMI-SEV             PIC X.
   409                 24  FILLER              PIC X.
   410             20  FILLER                  PIC X(02).
   411     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   412         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   413             20  EMI-ERROR-NUMBER    PIC X(4).
   414             20  EMI-FILL            PIC X.
   415             20  EMI-SEVERITY        PIC X.
   416             20  FILLER              PIC X.
   417             20  EMI-ERROR-TEXT.
   418                 24  EMI-TEXT-VARIABLE   PIC X(10).
   419                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL679.cbl
   420     12  EMI-SEVERITY-SAVE           PIC X.
   421         88  EMI-NOTE                    VALUE 'N'.
   422         88  EMI-WARNING                 VALUE 'W'.
   423         88  EMI-FORCABLE                VALUE 'F'.
   424         88  EMI-FATAL                   VALUE 'X'.
   425     12  EMI-MESSAGE-FLAG            PIC X.
   426         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   427         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   428     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   429     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   430         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   431         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   432         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   433     12  FILLER                      PIC X(137)  VALUE SPACES.
   434     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   435     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   436     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   437     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   438
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL679.cbl
   440*    COPY ELCINTF.
   441******************************************************************
   442*                                                                *
   443*                                                                *
   444*                            ELCINTF.                            *
   445*                            VMOD=2.017                          *
   446*                                                                *
   447*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   448*                                                                *
   449*       LENGTH = 1024                                            *
   450*                                                                *
   451******************************************************************
   452 01  PROGRAM-INTERFACE-BLOCK.
   453     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   454     12  PI-CALLING-PROGRAM              PIC X(8).
   455     12  PI-SAVED-PROGRAM-1              PIC X(8).
   456     12  PI-SAVED-PROGRAM-2              PIC X(8).
   457     12  PI-SAVED-PROGRAM-3              PIC X(8).
   458     12  PI-SAVED-PROGRAM-4              PIC X(8).
   459     12  PI-SAVED-PROGRAM-5              PIC X(8).
   460     12  PI-SAVED-PROGRAM-6              PIC X(8).
   461     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   462     12  PI-COMPANY-ID                   PIC XXX.
   463     12  PI-COMPANY-CD                   PIC X.
   464
   465     12  PI-COMPANY-PASSWORD             PIC X(8).
   466
   467     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   468
   469     12  PI-CONTROL-IN-PROGRESS.
   470         16  PI-CARRIER                  PIC X.
   471         16  PI-GROUPING                 PIC X(6).
   472         16  PI-STATE                    PIC XX.
   473         16  PI-ACCOUNT                  PIC X(10).
   474         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   475                                         PIC X(10).
   476         16  PI-CLAIM-CERT-GRP.
   477             20  PI-CLAIM-NO             PIC X(7).
   478             20  PI-CERT-NO.
   479                 25  PI-CERT-PRIME       PIC X(10).
   480                 25  PI-CERT-SFX         PIC X.
   481             20  PI-CERT-EFF-DT          PIC XX.
   482         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   483             20  PI-PLAN-CODE            PIC X(2).
   484             20  PI-REVISION-NUMBER      PIC X(3).
   485             20  PI-PLAN-EFF-DT          PIC X(2).
   486             20  PI-PLAN-EXP-DT          PIC X(2).
   487             20  FILLER                  PIC X(11).
   488         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   489             20  PI-OE-REFERENCE-1.
   490                 25  PI-OE-REF-1-PRIME   PIC X(18).
   491                 25  PI-OE-REF-1-SUFF    PIC XX.
   492
   493     12  PI-SESSION-IN-PROGRESS          PIC X.
   494         88  CLAIM-SESSION                   VALUE '1'.
   495         88  CREDIT-SESSION                  VALUE '2'.
   496         88  WARRANTY-SESSION                VALUE '3'.
   497         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL679.cbl
   498         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   499
   500
   501*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   502
   503     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   504     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   505
   506     12  PI-CREDIT-USER                  PIC X.
   507         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   508         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   509
   510     12  PI-CLAIM-USER                   PIC X.
   511         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   512         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   513
   514     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   515         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   516         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   517         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   518         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   519         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   520
   521     12  PI-PROCESSOR-ID                 PIC X(4).
   522
   523     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   524
   525     12  PI-MEMBER-CAPTION               PIC X(10).
   526
   527     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   528         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   529
   530     12  PI-LIFE-OVERRIDE-L1             PIC X.
   531     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   532     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   533     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   534
   535     12  PI-AH-OVERRIDE-L1               PIC X.
   536     12  PI-AH-OVERRIDE-L2               PIC XX.
   537     12  PI-AH-OVERRIDE-L6               PIC X(6).
   538     12  PI-AH-OVERRIDE-L12              PIC X(12).
   539
   540     12  PI-NEW-SYSTEM                   PIC X(2).
   541
   542     12  PI-PRIMARY-CERT-NO              PIC X(11).
   543     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   544         88  PI-USES-PAID-TO                 VALUE '1'.
   545     12  PI-CRDTCRD-SYSTEM.
   546         16  PI-CRDTCRD-USER             PIC X.
   547             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   548             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   549         16  PI-CC-MONTH-END-DT          PIC XX.
   550     12  PI-PROCESSOR-PRINTER            PIC X(4).
   551
   552     12  PI-OE-REFERENCE-2.
   553         16  PI-OE-REF-2-PRIME           PIC X(10).
   554         16  PI-OE-REF-2-SUFF            PIC X.
   555
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL679.cbl
   556     12  PI-REM-TRM-CALC-OPTION          PIC X.
   557
   558     12  PI-LANGUAGE-TYPE                PIC X.
   559             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   560             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   561             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   562
   563     12  PI-POLICY-LINKAGE-IND           PIC X.
   564         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   565         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   566                                                   LOW-VALUES.
   567
   568     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   569     12  PI-CLAIM-PW-SESSION             PIC X(1).
   570         88  PI-CLAIM-CREDIT                 VALUE '1'.
   571         88  PI-CLAIM-CONVEN                 VALUE '2'.
   572     12  FILLER                          PIC X(4).
   573
   574     12  PI-SYSTEM-LEVEL                 PIC X(145).
   575
   576     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   577         PI-SYSTEM-LEVEL.
   578
   579         16  PI-ENTRY-CODES.
   580             20  PI-ENTRY-CD-1           PIC X.
   581             20  PI-ENTRY-CD-2           PIC X.
   582
   583         16  PI-RETURN-CODES.
   584             20  PI-RETURN-CD-1          PIC X.
   585             20  PI-RETURN-CD-2          PIC X.
   586
   587         16  PI-UPDATE-STATUS-SAVE.
   588             20  PI-UPDATE-BY            PIC X(4).
   589             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   590
   591         16  PI-LOWER-CASE-LETTERS       PIC X.
   592             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   593
   594*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   595*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   596*            88  CARRIER-CLM-CNTL            VALUE '2'.
   597
   598         16  PI-CERT-ACCESS-CONTROL      PIC X.
   599             88  ST-ACCNT-CNTL               VALUE ' '.
   600             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   601             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   602             88  ACCNT-CNTL                  VALUE '3'.
   603             88  CARR-ACCNT-CNTL             VALUE '4'.
   604
   605         16  PI-PROCESSOR-CAP-LIST.
   606             20  PI-SYSTEM-CONTROLS.
   607                24 PI-SYSTEM-DISPLAY     PIC X.
   608                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   609                24 PI-SYSTEM-MODIFY      PIC X.
   610                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   611             20  FILLER                  PIC XX.
   612             20  PI-DISPLAY-CAP          PIC X.
   613                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL679.cbl
   614             20  PI-MODIFY-CAP           PIC X.
   615                 88  MODIFY-CAP              VALUE 'Y'.
   616             20  PI-MSG-AT-LOGON-CAP     PIC X.
   617                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   618             20  PI-FORCE-CAP            PIC X.
   619                 88  FORCE-CAP               VALUE 'Y'.
   620
   621         16  PI-PROGRAM-CONTROLS.
   622             20  PI-PGM-PRINT-OPT        PIC X.
   623             20  PI-PGM-FORMAT-OPT       PIC X.
   624             20  PI-PGM-PROCESS-OPT      PIC X.
   625             20  PI-PGM-TOTALS-OPT       PIC X.
   626
   627         16  PI-HELP-INTERFACE.
   628             20  PI-LAST-ERROR-NO        PIC X(4).
   629             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   630
   631         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   632             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   633
   634         16  PI-CR-CONTROL-IN-PROGRESS.
   635             20  PI-CR-CARRIER           PIC X.
   636             20  PI-CR-GROUPING          PIC X(6).
   637             20  PI-CR-STATE             PIC XX.
   638             20  PI-CR-ACCOUNT           PIC X(10).
   639             20  PI-CR-FIN-RESP          PIC X(10).
   640             20  PI-CR-TYPE              PIC X.
   641
   642         16  PI-CR-BATCH-NUMBER          PIC X(6).
   643
   644         16  PI-CR-MONTH-END-DT          PIC XX.
   645
   646         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   647             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   648             88  PI-ZERO-CARRIER             VALUE '1'.
   649             88  PI-ZERO-GROUPING            VALUE '2'.
   650             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   651
   652         16  PI-CARRIER-SECURITY         PIC X.
   653             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   654
   655         16  PI-ACCOUNT-SECURITY         PIC X(10).
   656             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   657             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   658
   659         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   660             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   661                                         INDEXED BY PI-ACCESS-NDX
   662                                         PIC X.
   663
   664         16  PI-GA-BILLING-CONTROL       PIC X.
   665             88  PI-GA-BILLING               VALUE '1'.
   666
   667         16  PI-MAIL-PROCESSING          PIC X.
   668             88  PI-MAIL-YES                 VALUE 'Y'.
   669
   670         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   671
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL679.cbl
   672         16  PI-AR-SYSTEM.
   673             20  PI-AR-PROCESSING-CNTL   PIC X.
   674                 88  PI-AR-PROCESSING        VALUE 'Y'.
   675             20  PI-AR-SUMMARY-CODE      PIC X(6).
   676             20  PI-AR-MONTH-END-DT      PIC XX.
   677
   678         16  PI-MP-SYSTEM.
   679             20  PI-MORTGAGE-USER            PIC X.
   680                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   681                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   682             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   683                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   684                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   685                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   686                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   687                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   688             20  PI-MP-MONTH-END-DT          PIC XX.
   689             20  PI-MP-REFERENCE-NO.
   690                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   691                 24  PI-MP-REFERENCE-SFX     PIC XX.
   692
   693         16  PI-LABEL-CONTROL            PIC X(01).
   694             88  PI-CREATE-LABELS                    VALUE 'Y'.
   695             88  PI-BYPASS-LABELS                    VALUE 'N'.
   696
   697         16  PI-BILL-GROUPING-CODE       PIC X(01).
   698             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   699
   700         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   701             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   702             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   703
   704         16  FILLER                      PIC X(14).
   705
   706     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   707******************************************************************
   708     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   709         16  PI-SAV-ERBILL-KEY.
   710             20  PI-SAV-CO-CD            PIC X.
   711             20  PI-SAV-CARRIER          PIC X.
   712             20  PI-SAV-GROUP            PIC X(6).
   713             20  PI-SAV-ACCOUNT          PIC X(10).
   714             20  PI-SAV-FIN-RESP         PIC X(10).
   715             20  PI-SAV-REC-TYPE         PIC X.
   716             20  PI-SAV-LINE-SEQ-NO      PIC S9(4)   COMP.
   717         16  PI-PREV-ERBILL-KEY.
   718             20  PI-PREV-CO-CD           PIC X.
   719             20  PI-PREV-CARRIER         PIC X.
   720             20  PI-PREV-GROUP           PIC X(6).
   721             20  PI-PREV-ACCOUNT         PIC X(10).
   722             20  PI-PREV-FIN-RESP        PIC X(10).
   723             20  PI-PREV-REC-TYPE        PIC X.
   724             20  PI-PREV-LINE-SEQ-NO     PIC S9(4)   COMP.
   725         16  PI-ACCT-EOF-SW              PIC X.
   726             88  PI-ACCT-EOF           VALUE 'Y'.
   727         16  FILLER                      PIC X(577).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL679.cbl
   729*    COPY ELCJPFX.
   730******************************************************************
   731*                                                                *
   732*                                                                *
   733*                            ELCJPFX.                            *
   734*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   735*                            VMOD=2.002                          *
   736*                                                                *
   737*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   738*                                                                *
   739*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   740*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   741*        ELCNTL - CONTROL FILE                                   *
   742*        ELMSTR - CLAIM MASTERS                                  *
   743*        ELTRLR - ACTIVITY TRAILERS                              *
   744*        ELCHKQ - CHECK QUE                                      *
   745******************************************************************
   746 01  JOURNAL-RECORD.
   747     12  JP-USER-ID                  PIC X(4).
   748     12  JP-FILE-ID                  PIC X(8).
   749     12  JP-PROGRAM-ID               PIC X(8).
   750     12  JP-RECORD-TYPE              PIC X.
   751         88 JP-ADD              VALUE 'A'.
   752         88 JP-BEFORE-CHANGE    VALUE 'B'.
   753         88 JP-AFTER-CHANGE     VALUE 'C'.
   754         88 JP-DELETE           VALUE 'D'.
   755         88 JP-GENERIC-DELETE   VALUE 'G'.
   756         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   757         88 JP-KEY-CHG-ADD      VALUE 'N'.
   758     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   759     12  JP-RECORD-AREA
   760
   761
   762                             PIC X(750).
   763
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL679.cbl
   765*    COPY ELCAID.
   766******************************************************************
   767*                                                                *
   768*                            ELCAID.                             *
   769*                            VMOD=2.001                          *
   770*                                                                *
   771*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   772*                                                                *
   773*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   774*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   775******************************************************************
   776
   777 01  DFHAID.
   778   02  DFHNULL   PIC  X  VALUE  ' '.
   779   02  DFHENTER  PIC  X  VALUE  QUOTE.
   780   02  DFHCLEAR  PIC  X  VALUE  '_'.
   781   02  DFHPEN    PIC  X  VALUE  '='.
   782   02  DFHOPID   PIC  X  VALUE  'W'.
   783   02  DFHPA1    PIC  X  VALUE  '%'.
   784   02  DFHPA2    PIC  X  VALUE  '>'.
   785   02  DFHPA3    PIC  X  VALUE  ','.
   786   02  DFHPF1    PIC  X  VALUE  '1'.
   787   02  DFHPF2    PIC  X  VALUE  '2'.
   788   02  DFHPF3    PIC  X  VALUE  '3'.
   789   02  DFHPF4    PIC  X  VALUE  '4'.
   790   02  DFHPF5    PIC  X  VALUE  '5'.
   791   02  DFHPF6    PIC  X  VALUE  '6'.
   792   02  DFHPF7    PIC  X  VALUE  '7'.
   793   02  DFHPF8    PIC  X  VALUE  '8'.
   794   02  DFHPF9    PIC  X  VALUE  '9'.
   795   02  DFHPF10   PIC  X  VALUE  ':'.
   796   02  DFHPF11   PIC  X  VALUE  '#'.
   797   02  DFHPF12   PIC  X  VALUE  '@'.
   798   02  DFHPF13   PIC  X  VALUE  'A'.
   799   02  DFHPF14   PIC  X  VALUE  'B'.
   800   02  DFHPF15   PIC  X  VALUE  'C'.
   801   02  DFHPF16   PIC  X  VALUE  'D'.
   802   02  DFHPF17   PIC  X  VALUE  'E'.
   803   02  DFHPF18   PIC  X  VALUE  'F'.
   804   02  DFHPF19   PIC  X  VALUE  'G'.
   805   02  DFHPF20   PIC  X  VALUE  'H'.
   806   02  DFHPF21   PIC  X  VALUE  'I'.
   807*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   808   02  DFHPF22   PIC  X  VALUE  '['.
   809   02  DFHPF23   PIC  X  VALUE  '.'.
   810   02  DFHPF24   PIC  X  VALUE  '<'.
   811   02  DFHMSRE   PIC  X  VALUE  'X'.
   812   02  DFHSTRF   PIC  X  VALUE  'h'.
   813   02  DFHTRIG   PIC  X  VALUE  '"'.
   814 01  FILLER    REDEFINES DFHAID.
   815     12  FILLER              PIC X(8).
   816     12  PF-VALUES           PIC X       OCCURS 2.
   817
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL679.cbl
   819*    COPY EL679S.
   820 01  EL679AI.
   821     05  FILLER            PIC  X(0012).
   822*    -------------------------------
   823     05  DATEL PIC S9(0004) COMP.
   824     05  DATEF PIC  X(0001).
   825     05  FILLER REDEFINES DATEF.
   826         10  DATEA PIC  X(0001).
   827     05  DATEI PIC  X(0008).
   828*    -------------------------------
   829     05  TIMEL PIC S9(0004) COMP.
   830     05  TIMEF PIC  X(0001).
   831     05  FILLER REDEFINES TIMEF.
   832         10  TIMEA PIC  X(0001).
   833     05  TIMEI PIC  X(0005).
   834*    -------------------------------
   835     05  CARR1L PIC S9(0004) COMP.
   836     05  CARR1F PIC  X(0001).
   837     05  FILLER REDEFINES CARR1F.
   838         10  CARR1A PIC  X(0001).
   839     05  CARR1I PIC  X(0001).
   840*    -------------------------------
   841     05  GROUP1L PIC S9(0004) COMP.
   842     05  GROUP1F PIC  X(0001).
   843     05  FILLER REDEFINES GROUP1F.
   844         10  GROUP1A PIC  X(0001).
   845     05  GROUP1I PIC  X(0006).
   846*    -------------------------------
   847     05  ACCT1L PIC S9(0004) COMP.
   848     05  ACCT1F PIC  X(0001).
   849     05  FILLER REDEFINES ACCT1F.
   850         10  ACCT1A PIC  X(0001).
   851     05  ACCT1I PIC  X(0010).
   852*    -------------------------------
   853     05  FINRSP1L PIC S9(0004) COMP.
   854     05  FINRSP1F PIC  X(0001).
   855     05  FILLER REDEFINES FINRSP1F.
   856         10  FINRSP1A PIC  X(0001).
   857     05  FINRSP1I PIC  X(0010).
   858*    -------------------------------
   859     05  BALFWD1L PIC S9(0004) COMP.
   860     05  BALFWD1F PIC  X(0001).
   861     05  FILLER REDEFINES BALFWD1F.
   862         10  BALFWD1A PIC  X(0001).
   863     05  BALFWD1I PIC  X(0013).
   864*    -------------------------------
   865     05  NAME1L PIC S9(0004) COMP.
   866     05  NAME1F PIC  X(0001).
   867     05  FILLER REDEFINES NAME1F.
   868         10  NAME1A PIC  X(0001).
   869     05  NAME1I PIC  X(0028).
   870*    -------------------------------
   871     05  PREM1L PIC S9(0004) COMP.
   872     05  PREM1F PIC  X(0001).
   873     05  FILLER REDEFINES PREM1F.
   874         10  PREM1A PIC  X(0001).
   875     05  PREM1I PIC  X(0013).
   876*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL679.cbl
   877     05  BILLDT1L PIC S9(0004) COMP.
   878     05  BILLDT1F PIC  X(0001).
   879     05  FILLER REDEFINES BILLDT1F.
   880         10  BILLDT1A PIC  X(0001).
   881     05  BILLDT1I PIC  X(0008).
   882*    -------------------------------
   883     05  REMIT1L PIC S9(0004) COMP.
   884     05  REMIT1F PIC  X(0001).
   885     05  FILLER REDEFINES REMIT1F.
   886         10  REMIT1A PIC  X(0001).
   887     05  REMIT1I PIC  X(0013).
   888*    -------------------------------
   889     05  PRTDT1L PIC S9(0004) COMP.
   890     05  PRTDT1F PIC  X(0001).
   891     05  FILLER REDEFINES PRTDT1F.
   892         10  PRTDT1A PIC  X(0001).
   893     05  PRTDT1I PIC  X(0008).
   894*    -------------------------------
   895     05  ICOMP1L PIC S9(0004) COMP.
   896     05  ICOMP1F PIC  X(0001).
   897     05  FILLER REDEFINES ICOMP1F.
   898         10  ICOMP1A PIC  X(0001).
   899     05  ICOMP1I PIC  X(0013).
   900*    -------------------------------
   901     05  CCOMP1L PIC S9(0004) COMP.
   902     05  CCOMP1F PIC  X(0001).
   903     05  FILLER REDEFINES CCOMP1F.
   904         10  CCOMP1A PIC  X(0001).
   905     05  CCOMP1I PIC  X(0013).
   906*    -------------------------------
   907     05  ADJMNT1L PIC S9(0004) COMP.
   908     05  ADJMNT1F PIC  X(0001).
   909     05  FILLER REDEFINES ADJMNT1F.
   910         10  ADJMNT1A PIC  X(0001).
   911     05  ADJMNT1I PIC  X(0013).
   912*    -------------------------------
   913     05  DISBUR1L PIC S9(0004) COMP.
   914     05  DISBUR1F PIC  X(0001).
   915     05  FILLER REDEFINES DISBUR1F.
   916         10  DISBUR1A PIC  X(0001).
   917     05  DISBUR1I PIC  X(0013).
   918*    -------------------------------
   919     05  ENDBAL1L PIC S9(0004) COMP.
   920     05  ENDBAL1F PIC  X(0001).
   921     05  FILLER REDEFINES ENDBAL1F.
   922         10  ENDBAL1A PIC  X(0001).
   923     05  ENDBAL1I PIC  X(0013).
   924*    -------------------------------
   925     05  CARR2L PIC S9(0004) COMP.
   926     05  CARR2F PIC  X(0001).
   927     05  FILLER REDEFINES CARR2F.
   928         10  CARR2A PIC  X(0001).
   929     05  CARR2I PIC  X(0001).
   930*    -------------------------------
   931     05  GROUP2L PIC S9(0004) COMP.
   932     05  GROUP2F PIC  X(0001).
   933     05  FILLER REDEFINES GROUP2F.
   934         10  GROUP2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL679.cbl
   935     05  GROUP2I PIC  X(0006).
   936*    -------------------------------
   937     05  ACCT2L PIC S9(0004) COMP.
   938     05  ACCT2F PIC  X(0001).
   939     05  FILLER REDEFINES ACCT2F.
   940         10  ACCT2A PIC  X(0001).
   941     05  ACCT2I PIC  X(0010).
   942*    -------------------------------
   943     05  FINRSP2L PIC S9(0004) COMP.
   944     05  FINRSP2F PIC  X(0001).
   945     05  FILLER REDEFINES FINRSP2F.
   946         10  FINRSP2A PIC  X(0001).
   947     05  FINRSP2I PIC  X(0010).
   948*    -------------------------------
   949     05  BALFWD2L PIC S9(0004) COMP.
   950     05  BALFWD2F PIC  X(0001).
   951     05  FILLER REDEFINES BALFWD2F.
   952         10  BALFWD2A PIC  X(0001).
   953     05  BALFWD2I PIC  X(0013).
   954*    -------------------------------
   955     05  NAME2L PIC S9(0004) COMP.
   956     05  NAME2F PIC  X(0001).
   957     05  FILLER REDEFINES NAME2F.
   958         10  NAME2A PIC  X(0001).
   959     05  NAME2I PIC  X(0028).
   960*    -------------------------------
   961     05  PREM2L PIC S9(0004) COMP.
   962     05  PREM2F PIC  X(0001).
   963     05  FILLER REDEFINES PREM2F.
   964         10  PREM2A PIC  X(0001).
   965     05  PREM2I PIC  X(0013).
   966*    -------------------------------
   967     05  BILLDT2L PIC S9(0004) COMP.
   968     05  BILLDT2F PIC  X(0001).
   969     05  FILLER REDEFINES BILLDT2F.
   970         10  BILLDT2A PIC  X(0001).
   971     05  BILLDT2I PIC  X(0008).
   972*    -------------------------------
   973     05  REMIT2L PIC S9(0004) COMP.
   974     05  REMIT2F PIC  X(0001).
   975     05  FILLER REDEFINES REMIT2F.
   976         10  REMIT2A PIC  X(0001).
   977     05  REMIT2I PIC  X(0013).
   978*    -------------------------------
   979     05  PRTDT2L PIC S9(0004) COMP.
   980     05  PRTDT2F PIC  X(0001).
   981     05  FILLER REDEFINES PRTDT2F.
   982         10  PRTDT2A PIC  X(0001).
   983     05  PRTDT2I PIC  X(0008).
   984*    -------------------------------
   985     05  ICOMP2L PIC S9(0004) COMP.
   986     05  ICOMP2F PIC  X(0001).
   987     05  FILLER REDEFINES ICOMP2F.
   988         10  ICOMP2A PIC  X(0001).
   989     05  ICOMP2I PIC  X(0013).
   990*    -------------------------------
   991     05  CCOMP2L PIC S9(0004) COMP.
   992     05  CCOMP2F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL679.cbl
   993     05  FILLER REDEFINES CCOMP2F.
   994         10  CCOMP2A PIC  X(0001).
   995     05  CCOMP2I PIC  X(0013).
   996*    -------------------------------
   997     05  ADJMNT2L PIC S9(0004) COMP.
   998     05  ADJMNT2F PIC  X(0001).
   999     05  FILLER REDEFINES ADJMNT2F.
  1000         10  ADJMNT2A PIC  X(0001).
  1001     05  ADJMNT2I PIC  X(0013).
  1002*    -------------------------------
  1003     05  DISPUR2L PIC S9(0004) COMP.
  1004     05  DISPUR2F PIC  X(0001).
  1005     05  FILLER REDEFINES DISPUR2F.
  1006         10  DISPUR2A PIC  X(0001).
  1007     05  DISPUR2I PIC  X(0013).
  1008*    -------------------------------
  1009     05  ENDBAL2L PIC S9(0004) COMP.
  1010     05  ENDBAL2F PIC  X(0001).
  1011     05  FILLER REDEFINES ENDBAL2F.
  1012         10  ENDBAL2A PIC  X(0001).
  1013     05  ENDBAL2I PIC  X(0013).
  1014*    -------------------------------
  1015     05  ERRMSGL PIC S9(0004) COMP.
  1016     05  ERRMSGF PIC  X(0001).
  1017     05  FILLER REDEFINES ERRMSGF.
  1018         10  ERRMSGA PIC  X(0001).
  1019     05  ERRMSGI PIC  X(0078).
  1020*    -------------------------------
  1021     05  PFENTERL PIC S9(0004) COMP.
  1022     05  PFENTERF PIC  X(0001).
  1023     05  FILLER REDEFINES PFENTERF.
  1024         10  PFENTERA PIC  X(0001).
  1025     05  PFENTERI PIC  9(2).
  1026 01  EL679AO REDEFINES EL679AI.
  1027     05  FILLER            PIC  X(0012).
  1028*    -------------------------------
  1029     05  FILLER            PIC  X(0003).
  1030     05  DATEO PIC  X(0008).
  1031*    -------------------------------
  1032     05  FILLER            PIC  X(0003).
  1033     05  TIMEO PIC  99.99.
  1034*    -------------------------------
  1035     05  FILLER            PIC  X(0003).
  1036     05  CARR1O PIC  X(0001).
  1037*    -------------------------------
  1038     05  FILLER            PIC  X(0003).
  1039     05  GROUP1O PIC  X(0006).
  1040*    -------------------------------
  1041     05  FILLER            PIC  X(0003).
  1042     05  ACCT1O PIC  X(0010).
  1043*    -------------------------------
  1044     05  FILLER            PIC  X(0003).
  1045     05  FINRSP1O PIC  X(0010).
  1046*    -------------------------------
  1047     05  FILLER            PIC  X(0003).
  1048     05  BALFWD1O PIC  Z,ZZZ,ZZ9.99-.
  1049*    -------------------------------
  1050     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL679.cbl
  1051     05  NAME1O PIC  X(0028).
  1052*    -------------------------------
  1053     05  FILLER            PIC  X(0003).
  1054     05  PREM1O PIC  Z,ZZZ,ZZ9.99-.
  1055*    -------------------------------
  1056     05  FILLER            PIC  X(0003).
  1057     05  BILLDT1O PIC  X(0008).
  1058*    -------------------------------
  1059     05  FILLER            PIC  X(0003).
  1060     05  REMIT1O PIC  Z,ZZZ,ZZ9.99-.
  1061*    -------------------------------
  1062     05  FILLER            PIC  X(0003).
  1063     05  PRTDT1O PIC  X(0008).
  1064*    -------------------------------
  1065     05  FILLER            PIC  X(0003).
  1066     05  ICOMP1O PIC  Z,ZZZ,ZZ9.99-.
  1067*    -------------------------------
  1068     05  FILLER            PIC  X(0003).
  1069     05  CCOMP1O PIC  Z,ZZZ,ZZ9.99-.
  1070*    -------------------------------
  1071     05  FILLER            PIC  X(0003).
  1072     05  ADJMNT1O PIC  Z,ZZZ,ZZ9.99-.
  1073*    -------------------------------
  1074     05  FILLER            PIC  X(0003).
  1075     05  DISBUR1O PIC  Z,ZZZ,ZZ9.99-.
  1076*    -------------------------------
  1077     05  FILLER            PIC  X(0003).
  1078     05  ENDBAL1O PIC  Z,ZZZ,ZZ9.99-.
  1079*    -------------------------------
  1080     05  FILLER            PIC  X(0003).
  1081     05  CARR2O PIC  X(0001).
  1082*    -------------------------------
  1083     05  FILLER            PIC  X(0003).
  1084     05  GROUP2O PIC  X(0006).
  1085*    -------------------------------
  1086     05  FILLER            PIC  X(0003).
  1087     05  ACCT2O PIC  X(0010).
  1088*    -------------------------------
  1089     05  FILLER            PIC  X(0003).
  1090     05  FINRSP2O PIC  X(0010).
  1091*    -------------------------------
  1092     05  FILLER            PIC  X(0003).
  1093     05  BALFWD2O PIC  Z,ZZZ,ZZ9.99-.
  1094*    -------------------------------
  1095     05  FILLER            PIC  X(0003).
  1096     05  NAME2O PIC  X(0028).
  1097*    -------------------------------
  1098     05  FILLER            PIC  X(0003).
  1099     05  PREM2O PIC  Z,ZZZ,ZZ9.99-.
  1100*    -------------------------------
  1101     05  FILLER            PIC  X(0003).
  1102     05  BILLDT2O PIC  X(0008).
  1103*    -------------------------------
  1104     05  FILLER            PIC  X(0003).
  1105     05  REMIT2O PIC  Z,ZZZ,ZZ9.99-.
  1106*    -------------------------------
  1107     05  FILLER            PIC  X(0003).
  1108     05  PRTDT2O PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL679.cbl
  1109*    -------------------------------
  1110     05  FILLER            PIC  X(0003).
  1111     05  ICOMP2O PIC  Z,ZZZ,ZZ9.99-.
  1112*    -------------------------------
  1113     05  FILLER            PIC  X(0003).
  1114     05  CCOMP2O PIC  Z,ZZZ,ZZ9.99-.
  1115*    -------------------------------
  1116     05  FILLER            PIC  X(0003).
  1117     05  ADJMNT2O PIC  Z,ZZZ,ZZ9.99-.
  1118*    -------------------------------
  1119     05  FILLER            PIC  X(0003).
  1120     05  DISPUR2O PIC  Z,ZZZ,ZZ9.99-.
  1121*    -------------------------------
  1122     05  FILLER            PIC  X(0003).
  1123     05  ENDBAL2O PIC  Z,ZZZ,ZZ9.99-.
  1124*    -------------------------------
  1125     05  FILLER            PIC  X(0003).
  1126     05  ERRMSGO PIC  X(0078).
  1127*    -------------------------------
  1128     05  FILLER            PIC  X(0003).
  1129     05  PFENTERO PIC  99.
  1130*    -------------------------------
  1131 01  MAP-A REDEFINES EL679AO.
  1132     12  FILLER                  PIC X(31).
  1133     12  FILLER   OCCURS 2 TIMES.
  1134         16  FILLER              PIC X(3).
  1135         16  CARRIER             PIC X.
  1136         16  FILLER              PIC X(3).
  1137         16  GROUPING            PIC X(6).
  1138         16  FILLER              PIC X(3).
  1139         16  ACCOUNT             PIC X(10).
  1140         16  FILLER              PIC X(3).
  1141         16  FINRESP             PIC X(10).
  1142         16  FILLER              PIC X(3).
  1143         16  BALFRWD             PIC Z,ZZZ,ZZ9.99-.
  1144         16  FILLER              PIC X(3).
  1145*        16  NAME                PIC X(28).
  1146         16  NAMEX               PIC X(28).
  1147         16  FILLER              PIC X(3).
  1148         16  PREMIUM             PIC Z,ZZZ,ZZ9.99-.
  1149         16  FILLER              PIC X(3).
  1150         16  BILL-DATE           PIC X(8).
  1151         16  FILLER              PIC X(3).
  1152         16  REMITTED            PIC Z,ZZZ,ZZ9.99-.
  1153         16  FILLER              PIC X(3).
  1154         16  PRT-DATE            PIC X(8).
  1155         16  FILLER              PIC X(3).
  1156         16  ISSUE-COMP          PIC Z,ZZZ,ZZ9.99-.
  1157         16  FILLER              PIC X(3).
  1158         16  CANCEL-COMP         PIC Z,ZZZ,ZZ9.99-.
  1159         16  FILLER              PIC X(3).
  1160         16  ADJUSTMENTS         PIC Z,ZZZ,ZZ9.99-.
  1161         16  FILLER              PIC X(3).
  1162         16  DISBURSED           PIC Z,ZZZ,ZZ9.99-.
  1163         16  FILLER              PIC X(3).
  1164         16  END-BAL             PIC Z,ZZZ,ZZ9.99-.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL679.cbl
  1166****************************************************************
  1167*
  1168* Copyright (c) 2007 by Clerity Solutions, Inc.
  1169* All rights reserved.
  1170*
  1171****************************************************************
  1172 01  DFHEIV.
  1173   02  DFHEIV0               PIC X(35).
  1174   02  DFHEIV1               PIC X(08).
  1175   02  DFHEIV2               PIC X(08).
  1176   02  DFHEIV3               PIC X(08).
  1177   02  DFHEIV4               PIC X(06).
  1178   02  DFHEIV5               PIC X(04).
  1179   02  DFHEIV6               PIC X(04).
  1180   02  DFHEIV7               PIC X(02).
  1181   02  DFHEIV8               PIC X(02).
  1182   02  DFHEIV9               PIC X(01).
  1183   02  DFHEIV10              PIC S9(7) COMP-3.
  1184   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1185   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1186   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1187   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1188   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1189   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1190   02  DFHEIV17              PIC X(04).
  1191   02  DFHEIV18              PIC X(04).
  1192   02  DFHEIV19              PIC X(04).
  1193   02  DFHEIV20              USAGE IS POINTER.
  1194   02  DFHEIV21              USAGE IS POINTER.
  1195   02  DFHEIV22              USAGE IS POINTER.
  1196   02  DFHEIV23              USAGE IS POINTER.
  1197   02  DFHEIV24              USAGE IS POINTER.
  1198   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1199   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1200   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1201   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1202   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1203   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1204   02  FILLER                PIC X(02).
  1205   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1206   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1207   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1208   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1209   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1210 LINKAGE  SECTION.
  1211*****************************************************************
  1212*                                                               *
  1213* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1214* All rights reserved.                                          *
  1215*                                                               *
  1216*****************************************************************
  1217 01  dfheiblk.
  1218     02  eibtime          pic s9(7) comp-3.
  1219     02  eibdate          pic s9(7) comp-3.
  1220     02  eibtrnid         pic x(4).
  1221     02  eibtaskn         pic s9(7) comp-3.
  1222     02  eibtrmid         pic x(4).
  1223     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL679.cbl
  1224     02  eibcposn         pic s9(4) comp.
  1225     02  eibcalen         pic s9(4) comp.
  1226     02  eibaid           pic x(1).
  1227     02  eibfiller1       pic x(1).
  1228     02  eibfn            pic x(2).
  1229     02  eibfiller2       pic x(2).
  1230     02  eibrcode         pic x(6).
  1231     02  eibfiller3       pic x(2).
  1232     02  eibds            pic x(8).
  1233     02  eibreqid         pic x(8).
  1234     02  eibrsrce         pic x(8).
  1235     02  eibsync          pic x(1).
  1236     02  eibfree          pic x(1).
  1237     02  eibrecv          pic x(1).
  1238     02  eibsend          pic x(1).
  1239     02  eibatt           pic x(1).
  1240     02  eibeoc           pic x(1).
  1241     02  eibfmh           pic x(1).
  1242     02  eibcompl         pic x(1).
  1243     02  eibsig           pic x(1).
  1244     02  eibconf          pic x(1).
  1245     02  eiberr           pic x(1).
  1246     02  eibrldbk         pic x(1).
  1247     02  eiberrcd         pic x(4).
  1248     02  eibsynrb         pic x(1).
  1249     02  eibnodat         pic x(1).
  1250     02  eibfiller5       pic x(2).
  1251     02  eibresp          pic 9(09) comp.
  1252     02  eibresp2         pic 9(09) comp.
  1253     02  dfheigdj         pic s9(4) comp.
  1254     02  dfheigdk         pic s9(4) comp.
  1255 01  DFHCOMMAREA             PIC X(1024).
  1256
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL679.cbl
  1258*01 PARMLIST .
  1259*    02  FILLER              PIC S9(8)   COMP.
  1260*    02  ERBILL-POINTER      PIC S9(8)   COMP.
  1261
  1262*    COPY ERCBILL.
  1263******************************************************************
  1264*                                                                *
  1265*                                                                *
  1266*                            ERCBILL                             *
  1267*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1268*                            VMOD=2.007                          *
  1269*                                                                *
  1270*   FILE DESCRIPTION = BILLING STATEMENTS FOR PRINTING           *
  1271*                                                                *
  1272*   FILE TYPE = VSAM,KSDS                                        *
  1273*   RECORD SIZE = 210  RECFORM = FIXED                           *
  1274*                                                                *
  1275*   BASE CLUSTER = ERBILL                        RKP=2,LEN=31    *
  1276*                                                                *
  1277*   LOG = NO                                                     *
  1278*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1279******************************************************************
  1280 01  BILLING-STATEMENT.
  1281     02 BILLING-STATEMENT-FILE.
  1282     12  BI-RECORD-ID                PIC XX.
  1283         88  VALID-BI-ID                VALUE 'BI'.
  1284
  1285     12  BI-CONTROL-PRIMARY.
  1286         16  BI-COMPANY-CD           PIC X.
  1287         16  BI-CARRIER              PIC X.
  1288         16  BI-GROUPING             PIC X(6).
  1289         16  BI-ACCOUNT              PIC X(10).
  1290         16  BI-FIN-RESP             PIC X(10).
  1291         16  BI-RECORD-TYPE          PIC X.
  1292             88  BI-HEADER-DATA         VALUE '1'.
  1293             88  BI-ADDRESS-DATA        VALUE '2'.
  1294             88  BI-TEXT-DATA           VALUE '3'.
  1295         16  BI-LINE-SEQ-NO          PIC S9(4)     COMP.
  1296
  1297     12  BI-TEXT-RECORD.
  1298         16  BI-SKIP-CONTROL         PIC X.
  1299         16  BI-TEXT-LINE            PIC X(157).
  1300         16  BI-TEXT-LINE-1 REDEFINES BI-TEXT-LINE.
  1301             20  BI-ADDR-LIT         PIC X(14).
  1302             20  BI-CO               PIC X(7).
  1303             20  BI-DASH             PIC X.
  1304             20  BI-ACCT             PIC X(10).
  1305             20  FILLER              PIC XX.
  1306             20  BI-ACCT-ADDR        PIC X(30).
  1307             20  FILLER              PIC X.
  1308             20  BI-REMIT-LIT        PIC X(11).
  1309             20  FILLER              PIC XX.
  1310             20  BI-REMIT-ADDR       PIC X(30).
  1311             20  FILLER              PIC X(49).
  1312         16  BI-TEXT-LINE-2 REDEFINES BI-TEXT-LINE.
  1313             20  BI-INS-LAST-NAME    PIC X(15).
  1314             20  FILLER              PIC X.
  1315             20  BI-INS-1ST-NAME     PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL679.cbl
  1316             20  FILLER REDEFINES BI-INS-1ST-NAME.
  1317                 24  BI-INS-INITS    PIC XX.
  1318                 24  FILLER          PIC X(8).
  1319             20  FILLER              PIC X.
  1320             20  BI-UNDRWRTR.
  1321                 24  BI-INS-INIT     PIC X.
  1322                 24  FILLER          PIC XXX.
  1323             20  BI-CERT             PIC X(11).
  1324             20  FILLER              PIC XX.
  1325             20  BI-EFF-DT           PIC X(8).
  1326             20  FILLER              PIC XX.
  1327             20  BI-CAN-DT           PIC X(8).
  1328             20  FILLER              PIC XX.
  1329             20  BI-ED-TERM          PIC ZZZ.
  1330             20  FILLER              PIC XX.
  1331             20  BI-TYPE             PIC XXXX.
  1332             20  FILLER              PIC X.
  1333             20  BI-PREM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  1334             20  FILLER              PIC X(3).
  1335             20  BI-ED-RATE          PIC ZZZ.ZZZ.
  1336             20  FILLER              PIC XX.
  1337             20  BI-COMM             PIC ZZ,ZZZ,ZZZ.ZZ-.
  1338             20  FILLER              PIC XX.
  1339             20  BI-FACE-AMT         PIC ZZZ,ZZZ,ZZZ.ZZ-.
  1340             20  FILLER              PIC X(26).
  1341         16  BI-TEXT-LINE-3 REDEFINES BI-TEXT-LINE.
  1342             20  FILLER              PIC X(42).
  1343             20  BI-TOT-DESC         PIC X(20).
  1344             20  FILLER REDEFINES BI-TOT-DESC.
  1345                 24  BI-TOT-LIT      PIC X(6).
  1346                 24  BI-OVERRIDE-L6  PIC X(14).
  1347             20  FILLER              PIC X(11).
  1348             20  BI-TOT-PREM         PIC ZZZ,ZZZ,ZZZ.99-.
  1349             20  BI-TOT-DASH REDEFINES
  1350                 BI-TOT-PREM         PIC X(15).
  1351             20  FILLER              PIC X(11).
  1352             20  BI-COM-TOT          PIC ZZZ,ZZZ,ZZZ.99-.
  1353             20  FILLER              PIC XX.
  1354             20  BI-FACE-TOT         PIC ZZZ,ZZZ,ZZZ.99-.
  1355             20  FILLER              PIC X(26).
  1356         16  BI-TEXT-LINE-4 REDEFINES BI-TEXT-LINE.
  1357             20  BI-ENTRY-DESC       PIC X(30).
  1358             20  FILLER              PIC X(11).
  1359             20  BI-ENTRY-AMT        PIC ZZZZ,ZZZ,ZZZ.99-.
  1360             20  FILLER              PIC X(31).
  1361             20  BI-ACCTG-COMMENT    PIC X(30).
  1362             20  FILLER              PIC X(39).
  1363         16  BI-TEXT-LINE-5 REDEFINES BI-TEXT-LINE.
  1364             20  FILLER              PIC X(42).
  1365             20  BI-TOT-DESC5        PIC X(20).
  1366             20  FILLER              PIC X(11).
  1367             20  BI-TOT-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  1368             20  BI-COM-TOT5         PIC ZZZ,ZZZ,ZZZ.99-.
  1369             20  BI-NON-PREM5        PIC ZZZ,ZZZ,ZZZ.99-.
  1370             20  BI-NON-COMM5        PIC ZZZ,ZZZ,ZZZ.99-.
  1371             20  FILLER              PIC X(24).
  1372         16  BI-TEXT-FIRST REDEFINES BI-TEXT-LINE.
  1373             20  BI-TEXT-2-81        PIC X(80).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL679.cbl
  1374             20  FILLER              PIC X(77).
  1375         16  BI-TEXT-LAST REDEFINES BI-TEXT-LINE.
  1376             20  FILLER              PIC X(53).
  1377             20  BI-TEXT-55-133      PIC X(79).
  1378             20  FILLER              PIC X(25).
  1379         16  BI-TEXT-TYPE            PIC X.
  1380             88 DETAIL-LINE              VALUE 'D'.
  1381         16  BI-TERM                 PIC S999.
  1382         16  BI-BENEFIT-AMT          PIC S9(9)V99 COMP-3.
  1383         16  BI-PREMIUM-AMT          PIC S9(7)V99 COMP-3.
  1384         16  BI-RATE                 PIC S99V9(5) COMP-3.
  1385
  1386     12  BI-ADDRESS-RECORD  REDEFINES  BI-TEXT-RECORD.
  1387         16  FILLER                  PIC X.
  1388         16  BI-ACCT-ADDRESS-LINE    PIC X(30).
  1389         16  FILLER                  PIC X(10).
  1390         16  BI-REMIT-ADDRESS-LINE   PIC X(30).
  1391         16  FILLER                  PIC X(106).
  1392
  1393     12  BI-HEADER-RECORD  REDEFINES  BI-TEXT-RECORD.
  1394         16  BI-PROCESSOR-CD         PIC X(4).
  1395         16  BI-STATEMENT-TYPE       PIC X.
  1396             88  BI-PREVIEW-ONLY         VALUE 'P'.
  1397         16  BI-NO-OF-COPIES         PIC S9.
  1398         16  BI-CREATION-DT          PIC XX.
  1399         16  BI-INITIAL-PRINT-DATE   PIC XX.
  1400         16  BI-ACCOUNT-TOTALS.
  1401             20  BI-BAL-FRWD         PIC S9(9)V99     COMP-3.
  1402             20  BI-PREMIUM          PIC S9(9)V99     COMP-3.
  1403             20  BI-REMITTED         PIC S9(9)V99     COMP-3.
  1404             20  BI-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  1405             20  BI-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  1406             20  BI-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  1407             20  BI-DISBURSED        PIC S9(9)V99     COMP-3.
  1408             20  BI-END-BAL          PIC S9(9)V99     COMP-3.
  1409         16  BI-FIN-RESP-ACCT        PIC X(10).
  1410         16  BI-FIN-RESP-NAME        PIC X(30).
  1411         16  FILLER                  PIC X(79).
  1412
  1413
  1414     02 GA-BILLING-STATEMENT REDEFINES BILLING-STATEMENT-FILE.
  1415     12  FILLER                      PIC XX.
  1416
  1417     12  GA-CONTROL-PRIMARY.
  1418         16  FILLER                  PIC X(31).
  1419
  1420     12  GA-TEXT-RECORD.
  1421         16  GA-SKIP-CONTROL         PIC X.
  1422         16  GA-TEXT-LINE            PIC X(132).
  1423         16  GA-TEXT-LINE-1 REDEFINES GA-TEXT-LINE.
  1424             20  FILLER              PIC X.
  1425             20  GA-CARRIER          PIC X.
  1426             20  GA-GROUPING         PIC X(6).
  1427             20  GA-DASH             PIC X.
  1428             20  GA-AGENT            PIC X(10).
  1429             20  FILLER              PIC X.
  1430             20  GA-AGENT-ADDR       PIC X(30).
  1431             20  FILLER              PIC X(82).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL679.cbl
  1432         16  GA-TEXT-LINE-2 REDEFINES GA-TEXT-LINE.
  1433             20  GA-ACCT             PIC X(10).
  1434             20  FILLER              PIC X.
  1435             20  GA-ACCT-NAME        PIC X(30).
  1436             20  GA-BEG-BAL          PIC ZZZZ,ZZZ.99-.
  1437             20  GA-NET-PREM         PIC ZZZZ,ZZZ.ZZ-.
  1438             20  GA-ACCT-COMP        PIC ZZZZ,ZZZ.ZZ-.
  1439             20  GA-PMTS-ADJS        PIC ZZZZ,ZZZ.ZZ-.
  1440             20  GA-UNPAID-NET-PREM  PIC ZZZZ,ZZZ.ZZ-.
  1441             20  GA-BEN-OVERRIDE-L6  PIC X(6).
  1442             20  FILLER              PIC X.
  1443             20  GA-OVERWRITE        PIC ZZZZ,ZZZ.ZZ-.
  1444             20  GA-AMT-DUE          PIC ZZZ,ZZZ.99-.
  1445             20  FILLER              PIC X.
  1446         16  GA-TEXT-LINE-3 REDEFINES GA-TEXT-LINE.
  1447             20  FILLER              PIC X(11).
  1448             20  GA-ENTRY-DESC       PIC X(30).
  1449             20  FILLER              PIC X(60).
  1450             20  GA-ENTRY-COMMENT    PIC X(30).
  1451             20  FILLER              PIC X.
  1452         16  FILLER.
  1453             20  GA-BENEFIT-CD       PIC XX.
  1454             20  GA-BEG-BAL-AMT      PIC S9(7)V99 COMP-3.
  1455             20  GA-END-BAL-AMT      PIC S9(7)V99 COMP-3.
  1456             20  GA-NET-PREM-AMT     PIC S9(7)V99 COMP-3.
  1457             20  GA-ACCT-COMP-AMT    PIC S9(7)V99 COMP-3.
  1458             20  GA-PMTS-ADJS-AMT    PIC S9(7)V99 COMP-3.
  1459             20  GA-UNPAID-NET-AMT   PIC S9(7)V99 COMP-3.
  1460             20  GA-OVERWRITE-AMT    PIC S9(7)V99 COMP-3.
  1461             20  GA-AMT-DUE-AMT      PIC S9(7)V99 COMP-3.
  1462
  1463     12  GA-ADDRESS-RECORD  REDEFINES  GA-TEXT-RECORD.
  1464         16  FILLER                  PIC X.
  1465         16  GA-ACCT-ADDRESS-LINE    PIC X(30).
  1466         16  FILLER                  PIC X(144).
  1467
  1468     12  GA-HEADER-RECORD  REDEFINES  GA-TEXT-RECORD.
  1469         16  GA-PROCESSOR-CD         PIC X(4).
  1470         16  GA-STATEMENT-TYPE       PIC X.
  1471             88  GA-PREVIEW-ONLY         VALUE 'P'.
  1472         16  GA-NO-OF-COPIES         PIC S9.
  1473         16  GA-CREATION-DT          PIC XX.
  1474         16  GA-INITIAL-PRINT-DATE   PIC XX.
  1475         16  GA-AGENT-TOTALS.
  1476             20  GA-NET-UNPD         PIC S9(9)V99     COMP-3.
  1477             20  GA-COMP-UNPD-PREM   PIC S9(9)V99     COMP-3.
  1478             20  GA-PREMIUM          PIC S9(9)V99     COMP-3.
  1479             20  GA-REMITTED         PIC S9(9)V99     COMP-3.
  1480             20  GA-TOT-ISS-COMP     PIC S9(9)V99     COMP-3.
  1481             20  GA-TOT-CAN-COMP     PIC S9(9)V99     COMP-3.
  1482             20  GA-ADJUSTMNTS       PIC S9(9)V99     COMP-3.
  1483             20  GA-DISBURSED        PIC S9(9)V99     COMP-3.
  1484             20  GA-END-BALANCE      PIC S9(9)V99     COMP-3.
  1485         16  GA-AGENTS-NAME          PIC X(30).
  1486         16  FILLER                  PIC X(81).
  1487     12  FILLER                      PIC XX.
  1488
  1489
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL679.cbl
  1490
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL679.cbl
  1492 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA BILLING-STATEMENT.
  1493 0000-DFHEXIT SECTION.
  1494     MOVE '9#                    $   ' TO DFHEIV0.
  1495     MOVE 'EL679' TO DFHEIV1.
  1496     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1497
  1498     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1499     MOVE '5'                   TO DC-OPTION-CODE.
  1500     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  1501     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1502     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1503
  1504     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1505     IF EIBCALEN = 0
  1506         GO TO 8800-UNAUTHORIZED-ACCESS.
  1507
  1508     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1509         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1510             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1511             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1512             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1513             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1514             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1515             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1516             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1517             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1518           ELSE
  1519             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1520             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1521             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1522             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1523             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1524             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1525             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1526             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  1527
  1528     MOVE LOW-VALUES             TO EL679AI.
  1529     MOVE PI-COMPANY-CD          TO PI-SAV-CO-CD
  1530                                    PI-PREV-CO-CD.
  1531     IF EIBTRNID NOT = TRANS-ID
  1532         MOVE '1'                TO PI-SAV-REC-TYPE
  1533         MOVE +0                 TO PI-SAV-LINE-SEQ-NO
  1534         MOVE DFHENTER           TO EIBAID
  1535         GO TO 1000-BROWSE-FORWARD.
  1536
  1537
  1538* EXEC CICS HANDLE CONDITION
  1539*        PGMIDERR  (9600-PGMID-ERROR)
  1540*        ERROR     (9990-ABEND)
  1541*        END-EXEC.
  1542*    MOVE '"$L.                  ! " #00001533' TO DFHEIV0
  1543     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1544     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1545     MOVE X'2220233030303031353333' TO DFHEIV0(25:11)
  1546     CALL 'kxdfhei1' USING DFHEIV0
  1547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1548
  1549
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL679.cbl
  1550     IF EIBAID = DFHCLEAR
  1551         GO TO 9400-CLEAR.
  1552
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL679.cbl
  1554 0200-RECEIVE.
  1555     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1556         MOVE 0008               TO EMI-ERROR
  1557         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1558         MOVE -1                 TO PFENTERL
  1559         GO TO 8200-SEND-DATAONLY.
  1560
  1561
  1562* EXEC CICS RECEIVE
  1563*        MAP      (MAP-NAME)
  1564*        MAPSET   (MAPSET-NAME)
  1565*        INTO     (EL679AI)
  1566*        END-EXEC.
  1567     MOVE LENGTH OF
  1568      EL679AI
  1569       TO DFHEIV11
  1570*    MOVE '8"T I  L              ''   #00001549' TO DFHEIV0
  1571     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1572     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1573     MOVE X'2020233030303031353439' TO DFHEIV0(25:11)
  1574     CALL 'kxdfhei1' USING DFHEIV0,
  1575           MAP-NAME,
  1576           EL679AI,
  1577           DFHEIV11,
  1578           MAPSET-NAME,
  1579           DFHEIV99,
  1580           DFHEIV99
  1581     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1582
  1583
  1584     IF PFENTERL = 0
  1585         GO TO 0300-CHECK-PFKEYS.
  1586     IF EIBAID NOT = DFHENTER
  1587         MOVE 0004               TO EMI-ERROR
  1588         GO TO 0320-INPUT-ERROR.
  1589     IF (PFENTERI NUMERIC) AND (PFENTERI > 0 AND < 25)
  1590         MOVE PF-VALUES (PFENTERI) TO EIBAID
  1591     ELSE
  1592         MOVE 0029               TO EMI-ERROR
  1593         GO TO 0320-INPUT-ERROR.
  1594
  1595 0300-CHECK-PFKEYS.
  1596     IF EIBAID = DFHPF23
  1597         GO TO 8810-PF23.
  1598     IF EIBAID = DFHPF24
  1599         GO TO 9200-RETURN-MAIN-MENU.
  1600     IF EIBAID = DFHPF12
  1601         GO TO 9500-PF12.
  1602
  1603     IF EIBAID = DFHENTER
  1604       OR DFHPF1
  1605         GO TO 1000-BROWSE-FORWARD.
  1606
  1607     IF EIBAID = DFHPF2
  1608         GO TO 2000-BROWSE-BACKWARD.
  1609     IF EIBAID = DFHPF3
  1610         GO TO 4000-START-REPORT-TRANSACTION.
  1611
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL679.cbl
  1612 0320-INPUT-ERROR.
  1613     MOVE 0029                   TO EMI-ERROR.
  1614     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1615     MOVE AL-UNBON               TO PFENTERA.
  1616     MOVE -1                     TO PFENTERL.
  1617     GO TO 8200-SEND-DATAONLY.
  1618
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL679.cbl
  1620 1000-BROWSE-FORWARD.
  1621     MOVE PI-SAV-ERBILL-KEY      TO ERBILL-KEY.
  1622     PERFORM 5000-START-BROWSE THRU 5099-EXIT.
  1623
  1624     IF EMI-ERROR NOT = ZEROS
  1625         GO TO 8200-SEND-DATAONLY.
  1626
  1627     PERFORM 1100-BROWSE-LOOP THRU 1100-EXIT
  1628         VARYING NDX FROM 1 BY 1
  1629         UNTIL NDX GREATER THAN 2.
  1630
  1631     IF EMI-ERROR NOT = ZEROS
  1632         GO TO 8200-SEND-DATAONLY.
  1633
  1634     GO TO 8100-SEND-INITIAL-MAP.
  1635
  1636 1100-BROWSE-LOOP.
  1637     IF EIBTRNID = TRANS-ID
  1638       OR NDX GREATER THAN 1
  1639         MOVE '3'                TO ERBILL-REC-TYPE
  1640         MOVE 9999               TO ERBILL-LINE-SEQ-NO.
  1641
  1642     PERFORM 5100-READ-NEXT-RECORD THRU 5199-EXIT.
  1643
  1644     IF EMI-ERROR NOT = ZEROS
  1645         MOVE 3                  TO NDX
  1646         IF EMI-ERROR = 2558
  1647             MOVE ZEROS          TO EMI-ERROR
  1648             GO TO 1100-EXIT
  1649         ELSE
  1650             GO TO 1100-EXIT.
  1651
  1652     IF NDX = 1
  1653         MOVE BI-CONTROL-PRIMARY TO PI-PREV-ERBILL-KEY
  1654     ELSE
  1655         MOVE BI-CONTROL-PRIMARY TO PI-SAV-ERBILL-KEY.
  1656
  1657     PERFORM 3000-FORMAT-SCREEN THRU 3099-EXIT.
  1658
  1659 1100-EXIT.
  1660     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL679.cbl
  1662 2000-BROWSE-BACKWARD.
  1663     MOVE 2                      TO NDX.
  1664 2100-BROWSE-LOOP.
  1665     MOVE PI-PREV-ERBILL-KEY     TO ERBILL-KEY.
  1666     PERFORM 5000-START-BROWSE THRU 5099-EXIT.
  1667
  1668     IF EMI-ERROR NOT = ZEROS
  1669         GO TO 8200-SEND-DATAONLY.
  1670
  1671     PERFORM 5200-READPREV THRU 5299-EXIT 2 TIMES
  1672
  1673     IF EMI-ERROR NOT = ZEROS
  1674         GO TO 8200-SEND-DATAONLY.
  1675
  1676     MOVE BI-CONTROL-PRIMARY     TO PI-PREV-ERBILL-KEY.
  1677     MOVE '1'                    TO PI-PREV-REC-TYPE.
  1678     MOVE ZEROS                  TO PI-PREV-LINE-SEQ-NO.
  1679
  1680     PERFORM 5400-END-BROWSE THRU 5499-EXIT.
  1681     PERFORM 5300-READ-RECORD THRU 5399-EXIT.
  1682
  1683     IF EMI-ERROR NOT = ZEROS
  1684         GO TO 8200-SEND-DATAONLY.
  1685     IF NDX = 2
  1686         MOVE BI-CONTROL-PRIMARY TO PI-SAV-ERBILL-KEY.
  1687
  1688     PERFORM 3000-FORMAT-SCREEN THRU 3099-EXIT.
  1689
  1690     SUBTRACT 1 FROM NDX.
  1691     IF NDX LESS THAN 1
  1692         GO TO 8100-SEND-INITIAL-MAP.
  1693
  1694     GO TO 2100-BROWSE-LOOP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL679.cbl
  1696 3000-FORMAT-SCREEN.
  1697     MOVE BI-CARRIER             TO CARRIER (NDX).
  1698     MOVE BI-GROUPING            TO GROUPING (NDX).
  1699     MOVE BI-ACCOUNT             TO ACCOUNT (NDX).
  1700     MOVE BI-FIN-RESP            TO FINRESP (NDX).
  1701     MOVE BI-BAL-FRWD            TO BALFRWD (NDX).
  1702     MOVE BI-PREMIUM             TO PREMIUM (NDX).
  1703     MOVE BI-REMITTED            TO REMITTED (NDX).
  1704     MOVE BI-TOT-ISS-COMP        TO ISSUE-COMP (NDX).
  1705     MOVE BI-TOT-CAN-COMP        TO CANCEL-COMP (NDX).
  1706     MOVE BI-ADJUSTMNTS          TO ADJUSTMENTS (NDX).
  1707     MOVE BI-DISBURSED           TO DISBURSED (NDX).
  1708     MOVE BI-END-BAL             TO END-BAL (NDX).
  1709*    MOVE BI-FIN-RESP-NAME       TO NAME (NDX).
  1710     MOVE BI-FIN-RESP-NAME       TO NAMEX (NDX).
  1711
  1712     MOVE BI-CREATION-DT         TO DC-BIN-DATE-1
  1713     MOVE SPACE                  TO DC-OPTION-CODE.
  1714     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  1715     MOVE DC-GREG-DATE-1-EDIT    TO BILL-DATE (NDX).
  1716
  1717     IF BI-INITIAL-PRINT-DATE NOT = LOW-VALUES
  1718         MOVE BI-INITIAL-PRINT-DATE  TO DC-BIN-DATE-1
  1719         MOVE SPACE                  TO DC-OPTION-CODE
  1720         PERFORM 8500-DATE-CONVERT THRU 8500-EXIT
  1721         MOVE DC-GREG-DATE-1-EDIT    TO PRT-DATE (NDX).
  1722
  1723 3099-EXIT.
  1724     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL679.cbl
  1726 4000-START-REPORT-TRANSACTION.
  1727
  1728* EXEC CICS START
  1729*         TRANSID       (TRANS-6791)
  1730*         FROM          (PROGRAM-INTERFACE-BLOCK)
  1731*         LENGTH        (PI-COMM-LENGTH)
  1732*    END-EXEC.
  1733*    MOVE '0( LF                 0   #00001698' TO DFHEIV0
  1734     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  1735     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  1736     MOVE X'2020233030303031363938' TO DFHEIV0(25:11)
  1737     CALL 'kxdfhei1' USING DFHEIV0,
  1738           DFHEIV99,
  1739           TRANS-6791,
  1740           DFHEIV99,
  1741           PROGRAM-INTERFACE-BLOCK,
  1742           PI-COMM-LENGTH,
  1743           DFHEIV99,
  1744           DFHEIV99,
  1745           DFHEIV99,
  1746           DFHEIV99,
  1747           DFHEIV99,
  1748           DFHEIV99,
  1749           DFHEIV99,
  1750           DFHEIV99,
  1751           DFHEIV99,
  1752           DFHEIV99
  1753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1754
  1755
  1756     MOVE 2559 TO EMI-ERROR.
  1757     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1758     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL679.cbl
  1760 5000-START-BROWSE.
  1761
  1762* EXEC CICS HANDLE CONDITION
  1763*        NOTFND (5010-REC-NOT-FND)
  1764*        END-EXEC.
  1765*    MOVE '"$I                   ! # #00001709' TO DFHEIV0
  1766     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  1767     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1768     MOVE X'2320233030303031373039' TO DFHEIV0(25:11)
  1769     CALL 'kxdfhei1' USING DFHEIV0
  1770     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1771
  1772
  1773
  1774* EXEC CICS STARTBR
  1775*        DATASET(ERBILL-FILE-ID)
  1776*        RIDFLD(ERBILL-KEY)
  1777*        END-EXEC.
  1778     MOVE 0
  1779       TO DFHEIV11
  1780*    MOVE '&,         G          &   #00001713' TO DFHEIV0
  1781     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1782     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1783     MOVE X'2020233030303031373133' TO DFHEIV0(25:11)
  1784     CALL 'kxdfhei1' USING DFHEIV0,
  1785           ERBILL-FILE-ID,
  1786           ERBILL-KEY,
  1787           DFHEIV99,
  1788           DFHEIV11,
  1789           DFHEIV99
  1790     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1791
  1792
  1793     GO TO 5099-EXIT.
  1794
  1795 5010-REC-NOT-FND.
  1796     MOVE 2212                   TO EMI-ERROR.
  1797     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1798 5099-EXIT.
  1799     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL679.cbl
  1801 5100-READ-NEXT-RECORD.
  1802
  1803* EXEC CICS HANDLE CONDITION
  1804*        ENDFILE (5110-END-OF-FILE)
  1805*        END-EXEC.
  1806*    MOVE '"$''                   ! $ #00001727' TO DFHEIV0
  1807     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  1808     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1809     MOVE X'2420233030303031373237' TO DFHEIV0(25:11)
  1810     CALL 'kxdfhei1' USING DFHEIV0
  1811     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1812
  1813
  1814
  1815* EXEC CICS READNEXT
  1816*        SET (ADDRESS OF BILLING-STATEMENT)
  1817*        DATASET (ERBILL-FILE-ID)
  1818*        RIDFLD (ERBILL-KEY)
  1819*        END-EXEC.
  1820     MOVE 0
  1821       TO DFHEIV11
  1822*    MOVE '&.S                   )   #00001731' TO DFHEIV0
  1823     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1824     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1825     MOVE X'2020233030303031373331' TO DFHEIV0(25:11)
  1826     CALL 'kxdfhei1' USING DFHEIV0,
  1827           ERBILL-FILE-ID,
  1828           DFHEIV20,
  1829           DFHEIV99,
  1830           ERBILL-KEY,
  1831           DFHEIV99,
  1832           DFHEIV11,
  1833           DFHEIV99,
  1834           DFHEIV99
  1835     SET ADDRESS OF BILLING-STATEMENT TO
  1836         DFHEIV20
  1837     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1838
  1839
  1840     IF BI-COMPANY-CD NOT = PI-SAV-CO-CD
  1841         GO TO 5110-END-OF-FILE.
  1842
  1843     IF NOT BI-HEADER-DATA
  1844         GO TO 5100-READ-NEXT-RECORD.
  1845
  1846     IF BI-ACCOUNT = LOW-VALUES
  1847         GO TO 5100-READ-NEXT-RECORD.
  1848
  1849     GO TO 5199-EXIT.
  1850
  1851 5110-END-OF-FILE.
  1852     IF NDX = 2
  1853         MOVE 2558               TO EMI-ERROR
  1854     ELSE
  1855         MOVE 2237               TO EMI-ERROR.
  1856
  1857     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1858
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL679.cbl
  1859 5199-EXIT.
  1860     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL679.cbl
  1862 5200-READPREV.
  1863
  1864* EXEC CICS HANDLE CONDITION
  1865*        ENDFILE (5210-END-OF-FILE)
  1866*        END-EXEC.
  1867*    MOVE '"$''                   ! % #00001760' TO DFHEIV0
  1868     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  1869     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1870     MOVE X'2520233030303031373630' TO DFHEIV0(25:11)
  1871     CALL 'kxdfhei1' USING DFHEIV0
  1872     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1873
  1874
  1875
  1876* EXEC CICS READPREV
  1877*        DATASET (ERBILL-FILE-ID)
  1878*        SET (ADDRESS OF BILLING-STATEMENT)
  1879*        RIDFLD (ERBILL-KEY)
  1880*        END-EXEC.
  1881     MOVE 0
  1882       TO DFHEIV11
  1883*    MOVE '&0S                   )   #00001764' TO DFHEIV0
  1884     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  1885     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1886     MOVE X'2020233030303031373634' TO DFHEIV0(25:11)
  1887     CALL 'kxdfhei1' USING DFHEIV0,
  1888           ERBILL-FILE-ID,
  1889           DFHEIV20,
  1890           DFHEIV99,
  1891           ERBILL-KEY,
  1892           DFHEIV99,
  1893           DFHEIV11,
  1894           DFHEIV99,
  1895           DFHEIV99
  1896     SET ADDRESS OF BILLING-STATEMENT TO
  1897         DFHEIV20
  1898     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1899
  1900
  1901     IF BI-COMPANY-CD NOT = PI-PREV-CO-CD
  1902         GO TO 5210-END-OF-FILE.
  1903
  1904     GO TO 5299-EXIT.
  1905
  1906 5210-END-OF-FILE.
  1907     MOVE 2238                   TO EMI-ERROR
  1908     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1909
  1910 5299-EXIT.
  1911     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL679.cbl
  1913 5300-READ-RECORD.
  1914
  1915* EXEC CICS HANDLE CONDITION
  1916*        NOTFND (5310-NOT-FOUND)
  1917*        END-EXEC.
  1918*    MOVE '"$I                   ! & #00001783' TO DFHEIV0
  1919     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  1920     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1921     MOVE X'2620233030303031373833' TO DFHEIV0(25:11)
  1922     CALL 'kxdfhei1' USING DFHEIV0
  1923     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1924
  1925
  1926
  1927* EXEC CICS READ
  1928*        SET (ADDRESS OF BILLING-STATEMENT)
  1929*        DATASET (ERBILL-FILE-ID)
  1930*        RIDFLD (PI-PREV-ERBILL-KEY)
  1931*        END-EXEC.
  1932*    MOVE '&"S        E          (   #00001787' TO DFHEIV0
  1933     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1934     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1935     MOVE X'2020233030303031373837' TO DFHEIV0(25:11)
  1936     CALL 'kxdfhei1' USING DFHEIV0,
  1937           ERBILL-FILE-ID,
  1938           DFHEIV20,
  1939           DFHEIV99,
  1940           PI-PREV-ERBILL-KEY,
  1941           DFHEIV99,
  1942           DFHEIV99,
  1943           DFHEIV99
  1944     SET ADDRESS OF BILLING-STATEMENT TO
  1945         DFHEIV20
  1946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1947
  1948
  1949     GO TO 5399-EXIT.
  1950
  1951 5310-NOT-FOUND.
  1952     MOVE 2212                   TO EMI-ERROR
  1953     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1954
  1955 5399-EXIT.
  1956     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL679.cbl
  1958 5400-END-BROWSE.
  1959
  1960* EXEC CICS ENDBR
  1961*        DATASET (ERBILL-FILE-ID)
  1962*        END-EXEC.
  1963     MOVE 0
  1964       TO DFHEIV11
  1965*    MOVE '&2                    $   #00001803' TO DFHEIV0
  1966     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1967     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1968     MOVE X'2020233030303031383033' TO DFHEIV0(25:11)
  1969     CALL 'kxdfhei1' USING DFHEIV0,
  1970           ERBILL-FILE-ID,
  1971           DFHEIV11,
  1972           DFHEIV99
  1973     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1974
  1975
  1976 5499-EXIT.
  1977     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL679.cbl
  1980 8100-SEND-INITIAL-MAP.
  1981     MOVE SAVE-DATE              TO DATEO.
  1982     MOVE EIBTIME                TO TIME-IN.
  1983     MOVE TIME-OUT               TO TIMEO.
  1984     MOVE -1                     TO PFENTERL.
  1985     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  1986
  1987
  1988* EXEC CICS SEND
  1989*        MAP      (MAP-NAME)
  1990*        MAPSET   (MAPSET-NAME)
  1991*        FROM     (EL679AO)
  1992*        ERASE
  1993*        CURSOR
  1994*        END-EXEC.
  1995     MOVE LENGTH OF
  1996      EL679AO
  1997       TO DFHEIV12
  1998     MOVE -1
  1999       TO DFHEIV11
  2000*    MOVE '8$     CT  E    H L F ,   #00001818' TO DFHEIV0
  2001     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2002     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2003     MOVE X'2020233030303031383138' TO DFHEIV0(25:11)
  2004     CALL 'kxdfhei1' USING DFHEIV0,
  2005           MAP-NAME,
  2006           EL679AO,
  2007           DFHEIV12,
  2008           MAPSET-NAME,
  2009           DFHEIV99,
  2010           DFHEIV99,
  2011           DFHEIV99,
  2012           DFHEIV11,
  2013           DFHEIV99,
  2014           DFHEIV99,
  2015           DFHEIV99
  2016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2017
  2018
  2019     GO TO 9100-RETURN-TRAN.
  2020
  2021 8200-SEND-DATAONLY.
  2022     IF EIBTRNID NOT = TRANS-ID
  2023         GO TO 8100-SEND-INITIAL-MAP.
  2024
  2025     MOVE SAVE-DATE              TO DATEO.
  2026     MOVE EIBTIME                TO TIME-IN.
  2027     MOVE TIME-OUT               TO TIMEO.
  2028     MOVE -1                     TO PFENTERL.
  2029     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  2030
  2031
  2032* EXEC CICS SEND
  2033*        MAP      (MAP-NAME)
  2034*        MAPSET   (MAPSET-NAME)
  2035*        FROM     (EL679AO)
  2036*        DATAONLY
  2037*        ERASEAUP
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL679.cbl
  2038*        CURSOR
  2039*        END-EXEC.
  2040     MOVE LENGTH OF
  2041      EL679AO
  2042       TO DFHEIV12
  2043     MOVE -1
  2044       TO DFHEIV11
  2045*    MOVE '8$D    CT  A    H L F ,   #00001838' TO DFHEIV0
  2046     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  2047     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2048     MOVE X'2020233030303031383338' TO DFHEIV0(25:11)
  2049     CALL 'kxdfhei1' USING DFHEIV0,
  2050           MAP-NAME,
  2051           EL679AO,
  2052           DFHEIV12,
  2053           MAPSET-NAME,
  2054           DFHEIV99,
  2055           DFHEIV99,
  2056           DFHEIV99,
  2057           DFHEIV11,
  2058           DFHEIV99,
  2059           DFHEIV99,
  2060           DFHEIV99
  2061     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2062
  2063
  2064     GO TO 9100-RETURN-TRAN.
  2065
  2066 8300-SEND-TEXT.
  2067
  2068* EXEC CICS SEND TEXT
  2069*        FROM     (LOGOFF-TEXT)
  2070*        LENGTH   (LOGOFF-LENGTH)
  2071*        ERASE
  2072*        FREEKB
  2073*        END-EXEC.
  2074*    MOVE '8&      T  E F  H   F -   #00001850' TO DFHEIV0
  2075     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2076     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2077     MOVE X'2020233030303031383530' TO DFHEIV0(25:11)
  2078     CALL 'kxdfhei1' USING DFHEIV0,
  2079           LOGOFF-TEXT,
  2080           LOGOFF-LENGTH,
  2081           DFHEIV99,
  2082           DFHEIV99,
  2083           DFHEIV99,
  2084           DFHEIV99,
  2085           DFHEIV99,
  2086           DFHEIV99,
  2087           DFHEIV99,
  2088           DFHEIV99,
  2089           DFHEIV99,
  2090           DFHEIV99
  2091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2092
  2093
  2094
  2095* EXEC CICS RETURN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL679.cbl
  2096*        END-EXEC.
  2097*    MOVE '.(                    &   #00001857' TO DFHEIV0
  2098     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2099     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2100     MOVE X'2020233030303031383537' TO DFHEIV0(25:11)
  2101     CALL 'kxdfhei1' USING DFHEIV0,
  2102           DFHEIV99,
  2103           DFHEIV99,
  2104           DFHEIV99,
  2105           DFHEIV99,
  2106           DFHEIV99
  2107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2108
  2109
  2110 8400-LOG-JOURNAL-RECORD.
  2111     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
  2112     MOVE ERBILL-FILE-ID         TO JP-FILE-ID.
  2113     MOVE THIS-PGM               TO JP-PROGRAM-ID.
  2114
  2115*    EXEC CICS JOURNAL
  2116*        JFILEID     (PI-JOURNAL-FILE-ID)
  2117*        JTYPEID     ('CL')
  2118*        FROM        (JOURNAL-RECORD)
  2119*        LENGTH      (773)
  2120*        END-EXEC.
  2121
  2122 8500-DATE-CONVERT.
  2123     MOVE LINK-ELDATCV           TO PGM-NAME.
  2124
  2125* EXEC CICS LINK
  2126*        PROGRAM    (PGM-NAME)
  2127*        COMMAREA   (DATE-CONVERSION-DATA)
  2128*        LENGTH     (DC-COMM-LENGTH)
  2129*        END-EXEC.
  2130*    MOVE '."C                   ''   #00001874' TO DFHEIV0
  2131     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2132     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2133     MOVE X'2020233030303031383734' TO DFHEIV0(25:11)
  2134     CALL 'kxdfhei1' USING DFHEIV0,
  2135           PGM-NAME,
  2136           DATE-CONVERSION-DATA,
  2137           DC-COMM-LENGTH,
  2138           DFHEIV99,
  2139           DFHEIV99,
  2140           DFHEIV99
  2141     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2142
  2143
  2144 8500-EXIT.
  2145     EXIT.
  2146
  2147 8800-UNAUTHORIZED-ACCESS.
  2148     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  2149     GO TO 8300-SEND-TEXT.
  2150
  2151 8810-PF23.
  2152     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  2153     MOVE XCTL-005               TO PGM-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL679.cbl
  2154     GO TO 9300-XCTL.
  2155
  2156 9000-RETURN-CICS.
  2157
  2158* EXEC CICS RETURN
  2159*        END-EXEC.
  2160*    MOVE '.(                    &   #00001893' TO DFHEIV0
  2161     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2162     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2163     MOVE X'2020233030303031383933' TO DFHEIV0(25:11)
  2164     CALL 'kxdfhei1' USING DFHEIV0,
  2165           DFHEIV99,
  2166           DFHEIV99,
  2167           DFHEIV99,
  2168           DFHEIV99,
  2169           DFHEIV99
  2170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2171
  2172
  2173 9100-RETURN-TRAN.
  2174     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  2175     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  2176
  2177* EXEC CICS RETURN
  2178*        TRANSID    (TRANS-ID)
  2179*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2180*        LENGTH     (PI-COMM-LENGTH)
  2181*        END-EXEC.
  2182*    MOVE '.(CT                  &   #00001899' TO DFHEIV0
  2183     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2184     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2185     MOVE X'2020233030303031383939' TO DFHEIV0(25:11)
  2186     CALL 'kxdfhei1' USING DFHEIV0,
  2187           TRANS-ID,
  2188           PROGRAM-INTERFACE-BLOCK,
  2189           PI-COMM-LENGTH,
  2190           DFHEIV99,
  2191           DFHEIV99
  2192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2193
  2194
  2195 9200-RETURN-MAIN-MENU.
  2196     MOVE XCTL-626               TO PGM-NAME.
  2197     GO TO 9300-XCTL.
  2198
  2199 9300-XCTL.
  2200
  2201* EXEC CICS XCTL
  2202*        PROGRAM    (PGM-NAME)
  2203*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2204*        LENGTH     (PI-COMM-LENGTH)
  2205*        END-EXEC.
  2206*    MOVE '.$C                   $   #00001910' TO DFHEIV0
  2207     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2208     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2209     MOVE X'2020233030303031393130' TO DFHEIV0(25:11)
  2210     CALL 'kxdfhei1' USING DFHEIV0,
  2211           PGM-NAME,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL679.cbl
  2212           PROGRAM-INTERFACE-BLOCK,
  2213           PI-COMM-LENGTH
  2214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2215
  2216
  2217 9400-CLEAR.
  2218     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
  2219     GO TO 9300-XCTL.
  2220
  2221 9500-PF12.
  2222     MOVE XCTL-010               TO PGM-NAME.
  2223     GO TO 9300-XCTL.
  2224
  2225 9600-PGMID-ERROR.
  2226
  2227* EXEC CICS HANDLE CONDITION
  2228*        PGMIDERR    (8300-SEND-TEXT)
  2229*        END-EXEC.
  2230*    MOVE '"$L                   ! '' #00001925' TO DFHEIV0
  2231     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2232     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2233     MOVE X'2720233030303031393235' TO DFHEIV0(25:11)
  2234     CALL 'kxdfhei1' USING DFHEIV0
  2235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2236
  2237
  2238     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  2239     MOVE ' '                    TO PI-ENTRY-CD-1.
  2240     MOVE XCTL-005               TO PGM-NAME.
  2241     MOVE PGM-NAME               TO LOGOFF-PGM.
  2242     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  2243     GO TO 9300-XCTL.
  2244
  2245 9900-ERROR-FORMAT.
  2246     IF NOT EMI-ERRORS-COMPLETE
  2247         MOVE LINK-001           TO PGM-NAME
  2248
  2249* EXEC CICS LINK
  2250*            PROGRAM    (PGM-NAME)
  2251*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2252*            LENGTH     (EMI-COMM-LENGTH)
  2253*            END-EXEC.
  2254*    MOVE '."C                   ''   #00001939' TO DFHEIV0
  2255     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2256     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2257     MOVE X'2020233030303031393339' TO DFHEIV0(25:11)
  2258     CALL 'kxdfhei1' USING DFHEIV0,
  2259           PGM-NAME,
  2260           ERROR-MESSAGE-INTERFACE-BLOCK,
  2261           EMI-COMM-LENGTH,
  2262           DFHEIV99,
  2263           DFHEIV99,
  2264           DFHEIV99
  2265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2266
  2267 9900-EXIT.
  2268     EXIT.
  2269
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL679.cbl
  2270 9990-ABEND.
  2271     MOVE LINK-004               TO PGM-NAME.
  2272     MOVE DFHEIBLK               TO EMI-LINE1
  2273
  2274
  2275* EXEC CICS LINK
  2276*        PROGRAM   (PGM-NAME)
  2277*        COMMAREA  (EMI-LINE1)
  2278*        LENGTH    (72)
  2279*        END-EXEC.
  2280     MOVE 72
  2281       TO DFHEIV11
  2282*    MOVE '."C                   ''   #00001951' TO DFHEIV0
  2283     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2284     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2285     MOVE X'2020233030303031393531' TO DFHEIV0(25:11)
  2286     CALL 'kxdfhei1' USING DFHEIV0,
  2287           PGM-NAME,
  2288           EMI-LINE1,
  2289           DFHEIV11,
  2290           DFHEIV99,
  2291           DFHEIV99,
  2292           DFHEIV99
  2293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2294
  2295
  2296     GO TO 8200-SEND-DATAONLY.
  2297
  2298
  2299* GOBACK.
  2300     MOVE '9%                    "   ' TO DFHEIV0
  2301     MOVE 'EL679' TO DFHEIV1
  2302     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2303     GOBACK.
  2304
  2305 9999-DFHBACK SECTION.
  2306     MOVE '9%                    "   ' TO DFHEIV0
  2307     MOVE 'EL679' TO DFHEIV1
  2308     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2309     GOBACK.
  2310 9999-DFHEXIT.
  2311     IF DFHEIGDJ EQUAL 0001
  2312         NEXT SENTENCE
  2313     ELSE IF DFHEIGDJ EQUAL 2
  2314         GO TO 9600-PGMID-ERROR,
  2315               9990-ABEND
  2316         DEPENDING ON DFHEIGDI
  2317     ELSE IF DFHEIGDJ EQUAL 3
  2318         GO TO 5010-REC-NOT-FND
  2319         DEPENDING ON DFHEIGDI
  2320     ELSE IF DFHEIGDJ EQUAL 4
  2321         GO TO 5110-END-OF-FILE
  2322         DEPENDING ON DFHEIGDI
  2323     ELSE IF DFHEIGDJ EQUAL 5
  2324         GO TO 5210-END-OF-FILE
  2325         DEPENDING ON DFHEIGDI
  2326     ELSE IF DFHEIGDJ EQUAL 6
  2327         GO TO 5310-NOT-FOUND
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL679.cbl
  2328         DEPENDING ON DFHEIGDI
  2329     ELSE IF DFHEIGDJ EQUAL 7
  2330         GO TO 8300-SEND-TEXT
  2331         DEPENDING ON DFHEIGDI.
  2332     MOVE '9%                    "   ' TO DFHEIV0
  2333     MOVE 'EL679' TO DFHEIV1
  2334     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2335     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4500     Code:        4966
