* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL850.cbl
* Options: int("EL850.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL850.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL850.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL850.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL850 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/03/95 09:37:46.
     7*                            VMOD=2.018.
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL850.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION - EXJ1 - ACCOUNTS RECEIVABLE MASTER MENU
    25
    26
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL850.cbl
    28 ENVIRONMENT DIVISION.
    29 DATA DIVISION.
    30 WORKING-STORAGE SECTION.
    31 01  DFH-START PIC X(04).
    32 77  FILLER  PIC X(32)  VALUE '********************************'.
    33 77  FILLER  PIC X(32)  VALUE '*    EL850 WORKING STORAGE     *'.
    34 77  FILLER  PIC X(32)  VALUE '************VMOD=2.018 *********'.
    35
    36*                            COPY ELCSCTM.
    37******************************************************************
    38*                                                                *
    39*                                                                *
    40*                            ELCSCTM                             *
    41*                            VMOD=2.001                          *
    42*                                                                *
    43*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    44*                                                                *
    45******************************************************************
    46 01  SECURITY-MESSAGE.
    47     12  FILLER                          PIC X(30)
    48            VALUE '** LOGIC SECURITY VIOLATION -'.
    49     12  SM-READ                         PIC X(6).
    50     12  FILLER                          PIC X(5)
    51            VALUE ' PGM='.
    52     12  SM-PGM                          PIC X(6).
    53     12  FILLER                          PIC X(5)
    54            VALUE ' OPR='.
    55     12  SM-PROCESSOR-ID                 PIC X(4).
    56     12  FILLER                          PIC X(6)
    57            VALUE ' TERM='.
    58     12  SM-TERMID                       PIC X(4).
    59     12  FILLER                          PIC XX   VALUE SPACE.
    60     12  SM-JUL-DATE                     PIC 9(5).
    61     12  FILLER                          PIC X    VALUE SPACE.
    62     12  SM-TIME                         PIC 99.99.
    63
    64*                            COPY ELCSCRT4.
    65******************************************************************
    66*                                                                *
    67*                                                                *
    68*                            ELCSCRT4                            *
    69*                            VMOD=2.001                          *
    70*                                                                *
    71*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    72*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    73*        SAVED IN PI-SECURITY-ADDRESS. (AR SYSTEM SECURITY)      *
    74*                                                                *
    75******************************************************************
    76 01  SECURITY-CONTROL-D.
    77     12  SC-COMM-LENGTH-D             PIC S9(4) VALUE +144 COMP.
    78     12  FILLER                       PIC XX    VALUE 'SC'.
    79     12  SC-AR-CODES.
    80         16  SC-AR-AUTHORIZATION OCCURS 44 TIMES.
    81             20  SC-AR-DISPLAY        PIC X.
    82             20  SC-AR-UPDATE         PIC X.
    83     12  FILLER                       PIC X(52).
    84*                            COPY MPCSCRT.
    85******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL850.cbl
    86*                                                                *
    87*                            MPCSCRT                             *
    88*                            VMOD=1.001                          *
    89*                                                                *
    90*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    91*        ACQUIRED BY SIGN-ON PROGRAM EL125.                      *
    92*                                      (MP MORTGAGE PROTECTION)  *
    93*                                                                *
    94******************************************************************
    95*
    96 01  SECURITY-CONTROL-E.
    97     12  SC-COMM-LENGTH-E             PIC S9(04) VALUE +144 COMP.
    98     12  FILLER                       PIC  X(02) VALUE 'SC'.
    99     12  SC-QUID-KEY.
   100         16  SC-QUID-TERMINAL         PIC  X(04).
   101         16  SC-QUID-SYSTEM           PIC  X(04).
   102     12  SC-ITEM                      PIC S9(04) VALUE +1   COMP.
   103     12  SC-SECURITY-ACCESS-CODE      PIC  X(01).
   104     12  SC-PRODUCER-AUTHORIZED-SW    PIC  X(01).
   105         88 SC-PRODUCER-AUTHORIZED               VALUE ' '.
   106         88 SC-PRODUCER-NOT-AUTHORIZED           VALUE 'N'.
   107     12  SC-MP-CODES.
   108         16  SC-MP-AUTHORIZATION OCCURS 44 TIMES.
   109             20  SC-MP-DISPLAY        PIC  X(01).
   110             20  SC-MP-UPDATE         PIC  X(01).
   111     12  FILLER                       PIC  X(40).
   112
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL850.cbl
   114
   115 01  MISC-WORK-AREAS.
   116     12  W-APPL-SCRTY-NDX    PIC S9(4) COMP VALUE +37.
   117     12  MAP-NAMEA           PIC X(8)    VALUE 'EL850A'.
   118     12  MAPSET-NAME         PIC X(8)    VALUE 'EL850S'.
   119     12  TRANS-ID            PIC X(4)    VALUE 'EXJ1'.
   120     12  PGM-NAME            PIC X(8).
   121     12  PASS-AREA-LEN       PIC S9(4)   COMP VALUE +16.
   122     12  TIME-IN             PIC 9(7).
   123     12  TIME-OUT-R    REDEFINES TIME-IN.
   124         16  FILLER          PIC X.
   125         16  TIME-OUT        PIC 99V99.
   126         16  FILLER          PIC X(2).
   127     12  THIS-PGM            PIC X(8)    VALUE 'EL850'.
   128     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   129     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   130     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   131     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   132     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   133     12  XCTL-636            PIC X(8)    VALUE 'EL636'.
   134     12  XCTL-637            PIC X(8)    VALUE 'EL637'.
   135     12  XCTL-685            PIC X(8)    VALUE 'EL685'.
   136     12  XCTL-686            PIC X(8)    VALUE 'EL686'.
   137     12  XCTL-687            PIC X(8)    VALUE 'EL687'.
   138     12  XCTL-696            PIC X(8)    VALUE 'EL696'.
   139     12  XCTL-697            PIC X(8)    VALUE 'EL697'.
   140     12  XCTL-852            PIC X(8)    VALUE 'EL852'.
   141     12  XCTL-856            PIC X(8)    VALUE 'EL856'.
   142     12  XCTL-EL880          PIC X(8)    VALUE 'EL880'.
   143     12  XCTL-EM880          PIC X(8)    VALUE 'EM880'.
   144     12  XCTL-850            PIC X(8)    VALUE 'EL850'.
   145     12  XCTL-882            PIC X(8)    VALUE 'EL882'.
   146     12  LINK-CLDATCV        PIC X(8)    VALUE 'ELDATCV'.
   147     12  SV-TODAY            PIC XX.
   148     12  WS-CURRENT-DATE     PIC X(8).
   149     12  WS-SYSID            PIC X(4).
   150     12  QID.
   151         16  QID-TERM            PIC X(4)      VALUE SPACES.
   152         16  FILLER              PIC X(4)      VALUE '125D'.
   153     12  QID-ITEM                PIC S9(4)     VALUE +1  COMP.
   154
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL850.cbl
   156     12  ER-0004                 PIC X(4)  VALUE '0004'.
   157     12  ER-0008                 PIC X(4)  VALUE '0008'.
   158     12  ER-0029                 PIC X(4)  VALUE '0029'.
   159     12  ER-0070                 PIC X(4)  VALUE '0070'.
   160     12  ER-1999                 PIC X(4)  VALUE '1999'.
   161     12  ER-9097                 PIC X(4)  VALUE '9097'.
   162
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL850.cbl
   164
   165 01  BATCH-TO-PROCESS.
   166     05  EDIT-COMPANY-CD         PIC X.
   167     05  EDIT-BATCH              PIC X(6).
   168     05  EDIT-COMPANY-ID         PIC XXX.
   169     05  EDIT-RESTART-BATCH      PIC X(6).
   170
   171 01  MISC-COMP.
   172     12  WS-IC               PIC S9(4)   VALUE -1  COMP.
   173     12  SUB1                PIC S9(4)   VALUE +0  COMP.
   174     12  SUB2                PIC S9(4)   VALUE +0  COMP.
   175
   176 01  ACCESS-KEYS.
   177     12  ELCNTL-KEY.
   178         16  CK-COMP-ID      PIC X(3).
   179         16  FILLER          PIC X       VALUE 'R'.
   180         16  CK-PROC-ID      PIC X(4).
   181         16  FILLER          PIC S9(4)   VALUE +0  COMP.
   182
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL850.cbl
   184*                            COPY ELCDATE.
   185******************************************************************
   186*                                                                *
   187*                                                                *
   188*                            ELCDATE.                            *
   189*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   190*                            VMOD=2.003
   191*                                                                *
   192*                                                                *
   193*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   194*                 LENGTH = 200                                   *
   195******************************************************************
   196
   197 01  DATE-CONVERSION-DATA.
   198     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   199     12  DC-OPTION-CODE                PIC X.
   200         88  BIN-TO-GREG                VALUE ' '.
   201         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   202         88  EDIT-GREG-TO-BIN           VALUE '2'.
   203         88  YMD-GREG-TO-BIN            VALUE '3'.
   204         88  MDY-GREG-TO-BIN            VALUE '4'.
   205         88  JULIAN-TO-BIN              VALUE '5'.
   206         88  BIN-PLUS-ELAPSED           VALUE '6'.
   207         88  FIND-CENTURY               VALUE '7'.
   208         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   209         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   210         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   211         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   212         88  JULIAN-TO-BIN-3            VALUE 'C'.
   213         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   214         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   215         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   216         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   217         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   218         88  CHECK-LEAP-YEAR            VALUE 'H'.
   219         88  BIN-3-TO-GREG              VALUE 'I'.
   220         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   221         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   222         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   223         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   224         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   225         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   226         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   227         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   228         88  THREE-CHARACTER-BIN
   229                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   230         88  GREGORIAN-TO-BIN
   231                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   232         88  BIN-TO-GREGORIAN
   233                  VALUES ' ' '1' 'I' '8' 'G'.
   234         88  JULIAN-TO-BINARY
   235                  VALUES '5' 'C' 'E' 'F'.
   236     12  DC-ERROR-CODE                 PIC X.
   237         88  NO-CONVERSION-ERROR        VALUE ' '.
   238         88  DATE-CONVERSION-ERROR
   239                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   240         88  DATE-IS-ZERO               VALUE '1'.
   241         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL850.cbl
   242         88  DATE-IS-INVALID            VALUE '3'.
   243         88  DATE1-GREATER-DATE2        VALUE '4'.
   244         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   245         88  DATE-INVALID-OPTION        VALUE '9'.
   246         88  INVALID-CENTURY            VALUE 'A'.
   247         88  ONLY-CENTURY               VALUE 'B'.
   248         88  ONLY-LEAP-YEAR             VALUE 'C'.
   249         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   250     12  DC-END-OF-MONTH               PIC X.
   251         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   252     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   253         88  USE-NORMAL-PROCESS         VALUE ' '.
   254         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   255         88  ADJUST-UP-100-YRS          VALUE '2'.
   256     12  FILLER                        PIC X.
   257     12  DC-CONVERSION-DATES.
   258         16  DC-BIN-DATE-1             PIC XX.
   259         16  DC-BIN-DATE-2             PIC XX.
   260         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   261         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   262                       DC-GREG-DATE-1-EDIT.
   263             20  DC-EDIT1-MONTH        PIC 99.
   264             20  SLASH1-1              PIC X.
   265             20  DC-EDIT1-DAY          PIC 99.
   266             20  SLASH1-2              PIC X.
   267             20  DC-EDIT1-YEAR         PIC 99.
   268         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   269         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   270                     DC-GREG-DATE-2-EDIT.
   271             20  DC-EDIT2-MONTH        PIC 99.
   272             20  SLASH2-1              PIC X.
   273             20  DC-EDIT2-DAY          PIC 99.
   274             20  SLASH2-2              PIC X.
   275             20  DC-EDIT2-YEAR         PIC 99.
   276         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   277         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   278                     DC-GREG-DATE-1-YMD.
   279             20  DC-YMD-YEAR           PIC 99.
   280             20  DC-YMD-MONTH          PIC 99.
   281             20  DC-YMD-DAY            PIC 99.
   282         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   283         16  DC-GREG-DATE-1-MDY-R REDEFINES
   284                      DC-GREG-DATE-1-MDY.
   285             20  DC-MDY-MONTH          PIC 99.
   286             20  DC-MDY-DAY            PIC 99.
   287             20  DC-MDY-YEAR           PIC 99.
   288         16  DC-GREG-DATE-1-ALPHA.
   289             20  DC-ALPHA-MONTH        PIC X(10).
   290             20  DC-ALPHA-DAY          PIC 99.
   291             20  FILLER                PIC XX.
   292             20  DC-ALPHA-CENTURY.
   293                 24 DC-ALPHA-CEN-N     PIC 99.
   294             20  DC-ALPHA-YEAR         PIC 99.
   295         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   296         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   297         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   298         16  DC-JULIAN-DATE            PIC 9(05).
   299         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL850.cbl
   300                                       PIC 9(05).
   301         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   302             20  DC-JULIAN-YEAR        PIC 99.
   303             20  DC-JULIAN-DAYS        PIC 999.
   304         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   305         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   306         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   307     12  DATE-CONVERSION-VARIBLES.
   308         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   309         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   310             20  FILLER                PIC 9(3).
   311             20  HOLD-CEN-1-CCYY.
   312                 24  HOLD-CEN-1-CC     PIC 99.
   313                 24  HOLD-CEN-1-YY     PIC 99.
   314             20  HOLD-CEN-1-MO         PIC 99.
   315             20  HOLD-CEN-1-DA         PIC 99.
   316         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   317             20  HOLD-CEN-1-R-MO       PIC 99.
   318             20  HOLD-CEN-1-R-DA       PIC 99.
   319             20  HOLD-CEN-1-R-CCYY.
   320                 24  HOLD-CEN-1-R-CC   PIC 99.
   321                 24  HOLD-CEN-1-R-YY   PIC 99.
   322             20  FILLER                PIC 9(3).
   323         16  HOLD-CENTURY-1-X.
   324             20  FILLER                PIC X(3)  VALUE SPACES.
   325             20  HOLD-CEN-1-X-CCYY.
   326                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   327                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   328             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   329             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   330         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   331             20  HOLD-CEN-1-R-X-MO     PIC XX.
   332             20  HOLD-CEN-1-R-X-DA     PIC XX.
   333             20  HOLD-CEN-1-R-X-CCYY.
   334                 24  HOLD-CEN-1-R-X-CC PIC XX.
   335                 24  HOLD-CEN-1-R-X-YY PIC XX.
   336             20  FILLER                PIC XXX.
   337         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   338         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   339         16  DC-JULIAN-DATE-1          PIC 9(07).
   340         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   341             20  DC-JULIAN-1-CCYY.
   342                 24  DC-JULIAN-1-CC    PIC 99.
   343                 24  DC-JULIAN-1-YR    PIC 99.
   344             20  DC-JULIAN-DA-1        PIC 999.
   345         16  DC-JULIAN-DATE-2          PIC 9(07).
   346         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   347             20  DC-JULIAN-2-CCYY.
   348                 24  DC-JULIAN-2-CC    PIC 99.
   349                 24  DC-JULIAN-2-YR    PIC 99.
   350             20  DC-JULIAN-DA-2        PIC 999.
   351         16  DC-GREG-DATE-A-EDIT.
   352             20  DC-EDITA-MONTH        PIC 99.
   353             20  SLASHA-1              PIC X VALUE '/'.
   354             20  DC-EDITA-DAY          PIC 99.
   355             20  SLASHA-2              PIC X VALUE '/'.
   356             20  DC-EDITA-CCYY.
   357                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL850.cbl
   358                 24  DC-EDITA-YEAR     PIC 99.
   359         16  DC-GREG-DATE-B-EDIT.
   360             20  DC-EDITB-MONTH        PIC 99.
   361             20  SLASHB-1              PIC X VALUE '/'.
   362             20  DC-EDITB-DAY          PIC 99.
   363             20  SLASHB-2              PIC X VALUE '/'.
   364             20  DC-EDITB-CCYY.
   365                 24  DC-EDITB-CENT     PIC 99.
   366                 24  DC-EDITB-YEAR     PIC 99.
   367         16  DC-GREG-DATE-CYMD         PIC 9(08).
   368         16  DC-GREG-DATE-CYMD-R REDEFINES
   369                              DC-GREG-DATE-CYMD.
   370             20  DC-CYMD-CEN           PIC 99.
   371             20  DC-CYMD-YEAR          PIC 99.
   372             20  DC-CYMD-MONTH         PIC 99.
   373             20  DC-CYMD-DAY           PIC 99.
   374         16  DC-GREG-DATE-MDCY         PIC 9(08).
   375         16  DC-GREG-DATE-MDCY-R REDEFINES
   376                              DC-GREG-DATE-MDCY.
   377             20  DC-MDCY-MONTH         PIC 99.
   378             20  DC-MDCY-DAY           PIC 99.
   379             20  DC-MDCY-CEN           PIC 99.
   380             20  DC-MDCY-YEAR          PIC 99.
   381    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   382        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   383    12  DC-EL310-DATE                  PIC X(21).
   384    12  FILLER                         PIC X(28).
   385
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL850.cbl
   387*                            COPY ELCLOGOF.
   388******************************************************************
   389*                                                                *
   390*                                                                *
   391*                            ELCLOGOF.                           *
   392*                            VMOD=2.001                          *
   393*                                                                *
   394*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   395*                                                                *
   396******************************************************************
   397 01  CLASIC-LOGOFF.
   398     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   399     12  LOGOFF-TEXT.
   400         16  FILLER          PIC X(5)    VALUE SPACES.
   401         16  LOGOFF-MSG.
   402             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   403             20  FILLER      PIC X       VALUE SPACES.
   404             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   405         16  FILLER          PIC X(80)
   406           VALUE '* YOU ARE NOW LOGGED OFF'.
   407         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   408         16  FILLER          PIC X       VALUE QUOTE.
   409         16  LOGOFF-SYS-MSG  PIC X(17)
   410           VALUE 'S CLAS-IC SYSTEM '.
   411     12  TEXT-MESSAGES.
   412         16  UNACCESS-MSG    PIC X(29)
   413             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   414         16  PGMIDERR-MSG    PIC X(17)
   415             VALUE 'PROGRAM NOT FOUND'.
   416
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL850.cbl
   418*                            COPY ELCATTR.
   419******************************************************************
   420*                                                                *
   421*                            ELCATTR.                            *
   422*                            VMOD=2.001                          *
   423*                                                                *
   424*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   425*                                                                *
   426*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   427*                                                                *
   428*                   POS 1   P=PROTECTED                          *
   429*                           U=UNPROTECTED                        *
   430*                           S=ASKIP                              *
   431*                   POS 2   A=ALPHA/NUMERIC                      *
   432*                           N=NUMERIC                            *
   433*                   POS 3   N=NORMAL                             *
   434*                           B=BRIGHT                             *
   435*                           D=DARK                               *
   436*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   437*                           OF=MODIFIED DATA TAG OFF             *
   438*                                                                *
   439*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   440******************************************************************
   441 01  ATTRIBUTE-LIST.
   442     12  AL-PABOF            PIC X       VALUE 'Y'.
   443     12  AL-PABON            PIC X       VALUE 'Z'.
   444     12  AL-PADOF            PIC X       VALUE '%'.
   445     12  AL-PADON            PIC X       VALUE '_'.
   446     12  AL-PANOF            PIC X       VALUE '-'.
   447     12  AL-PANON            PIC X       VALUE '/'.
   448     12  AL-SABOF            PIC X       VALUE '8'.
   449     12  AL-SABON            PIC X       VALUE '9'.
   450     12  AL-SADOF            PIC X       VALUE '@'.
   451     12  AL-SADON            PIC X       VALUE QUOTE.
   452     12  AL-SANOF            PIC X       VALUE '0'.
   453     12  AL-SANON            PIC X       VALUE '1'.
   454     12  AL-UABOF            PIC X       VALUE 'H'.
   455     12  AL-UABON            PIC X       VALUE 'I'.
   456     12  AL-UADOF            PIC X       VALUE '<'.
   457     12  AL-UADON            PIC X       VALUE '('.
   458     12  AL-UANOF            PIC X       VALUE ' '.
   459     12  AL-UANON            PIC X       VALUE 'A'.
   460     12  AL-UNBOF            PIC X       VALUE 'Q'.
   461     12  AL-UNBON            PIC X       VALUE 'R'.
   462     12  AL-UNDOF            PIC X       VALUE '*'.
   463     12  AL-UNDON            PIC X       VALUE ')'.
   464     12  AL-UNNOF            PIC X       VALUE '&'.
   465     12  AL-UNNON            PIC X       VALUE 'J'.
   466
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL850.cbl
   468*                            COPY ELCEMIB.
   469******************************************************************
   470*                                                                *
   471*                                                                *
   472*                            ELCEMIB.                            *
   473*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   474*                            VMOD=2.005                          *
   475*                                                                *
   476*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   477*                                                                *
   478******************************************************************
   479 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   480     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   481     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   482     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   483     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   484     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   485     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   486     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   487     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   488     12  EMI-SWITCH1             PIC X        VALUE '1'.
   489         88  EMI-NO-ERRORS                    VALUE '1'.
   490         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   491         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   492     12  EMI-SWITCH2             PIC X        VALUE '1'.
   493         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   494     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   495         88  EMI-AREA1-EMPTY                  VALUE '1'.
   496         88  EMI-AREA1-FULL                   VALUE '2'.
   497     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   498         88  EMI-AREA2-EMPTY                  VALUE '1'.
   499         88  EMI-AREA2-FULL                   VALUE '2'.
   500     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   501         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   502         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   503         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   504         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   505         88  EMI-BYPASS-FATALS                VALUE 'X'.
   506     12  EMI-ERROR-LINES.
   507         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   508         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   509         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   510         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   511             20  EMI-ERR-CODES OCCURS 10 TIMES.
   512                 24  EMI-ERR-NUM         PIC X(4).
   513                 24  EMI-FILLER          PIC X.
   514                 24  EMI-SEV             PIC X.
   515                 24  FILLER              PIC X.
   516             20  FILLER                  PIC X(02).
   517     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   518         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   519             20  EMI-ERROR-NUMBER    PIC X(4).
   520             20  EMI-FILL            PIC X.
   521             20  EMI-SEVERITY        PIC X.
   522             20  FILLER              PIC X.
   523             20  EMI-ERROR-TEXT.
   524                 24  EMI-TEXT-VARIABLE   PIC X(10).
   525                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL850.cbl
   526     12  EMI-SEVERITY-SAVE           PIC X.
   527         88  EMI-NOTE                    VALUE 'N'.
   528         88  EMI-WARNING                 VALUE 'W'.
   529         88  EMI-FORCABLE                VALUE 'F'.
   530         88  EMI-FATAL                   VALUE 'X'.
   531     12  EMI-MESSAGE-FLAG            PIC X.
   532         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   533         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   534     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   535     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   536         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   537         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   538         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   539     12  FILLER                      PIC X(137)  VALUE SPACES.
   540     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   541     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   542     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   543     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   544
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL850.cbl
   546*                            COPY ELCINTF.
   547******************************************************************
   548*                                                                *
   549*                                                                *
   550*                            ELCINTF.                            *
   551*                            VMOD=2.017                          *
   552*                                                                *
   553*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   554*                                                                *
   555*       LENGTH = 1024                                            *
   556*                                                                *
   557******************************************************************
   558 01  PROGRAM-INTERFACE-BLOCK.
   559     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   560     12  PI-CALLING-PROGRAM              PIC X(8).
   561     12  PI-SAVED-PROGRAM-1              PIC X(8).
   562     12  PI-SAVED-PROGRAM-2              PIC X(8).
   563     12  PI-SAVED-PROGRAM-3              PIC X(8).
   564     12  PI-SAVED-PROGRAM-4              PIC X(8).
   565     12  PI-SAVED-PROGRAM-5              PIC X(8).
   566     12  PI-SAVED-PROGRAM-6              PIC X(8).
   567     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   568     12  PI-COMPANY-ID                   PIC XXX.
   569     12  PI-COMPANY-CD                   PIC X.
   570
   571     12  PI-COMPANY-PASSWORD             PIC X(8).
   572
   573     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   574
   575     12  PI-CONTROL-IN-PROGRESS.
   576         16  PI-CARRIER                  PIC X.
   577         16  PI-GROUPING                 PIC X(6).
   578         16  PI-STATE                    PIC XX.
   579         16  PI-ACCOUNT                  PIC X(10).
   580         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   581                                         PIC X(10).
   582         16  PI-CLAIM-CERT-GRP.
   583             20  PI-CLAIM-NO             PIC X(7).
   584             20  PI-CERT-NO.
   585                 25  PI-CERT-PRIME       PIC X(10).
   586                 25  PI-CERT-SFX         PIC X.
   587             20  PI-CERT-EFF-DT          PIC XX.
   588         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   589             20  PI-PLAN-CODE            PIC X(2).
   590             20  PI-REVISION-NUMBER      PIC X(3).
   591             20  PI-PLAN-EFF-DT          PIC X(2).
   592             20  PI-PLAN-EXP-DT          PIC X(2).
   593             20  FILLER                  PIC X(11).
   594         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   595             20  PI-OE-REFERENCE-1.
   596                 25  PI-OE-REF-1-PRIME   PIC X(18).
   597                 25  PI-OE-REF-1-SUFF    PIC XX.
   598
   599     12  PI-SESSION-IN-PROGRESS          PIC X.
   600         88  CLAIM-SESSION                   VALUE '1'.
   601         88  CREDIT-SESSION                  VALUE '2'.
   602         88  WARRANTY-SESSION                VALUE '3'.
   603         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL850.cbl
   604         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   605
   606
   607*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   608
   609     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   610     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   611
   612     12  PI-CREDIT-USER                  PIC X.
   613         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   614         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   615
   616     12  PI-CLAIM-USER                   PIC X.
   617         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   618         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   619
   620     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   621         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   622         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   623         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   624         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   625         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   626
   627     12  PI-PROCESSOR-ID                 PIC X(4).
   628
   629     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   630
   631     12  PI-MEMBER-CAPTION               PIC X(10).
   632
   633     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   634         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   635
   636     12  PI-LIFE-OVERRIDE-L1             PIC X.
   637     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   638     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   639     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   640
   641     12  PI-AH-OVERRIDE-L1               PIC X.
   642     12  PI-AH-OVERRIDE-L2               PIC XX.
   643     12  PI-AH-OVERRIDE-L6               PIC X(6).
   644     12  PI-AH-OVERRIDE-L12              PIC X(12).
   645
   646     12  PI-NEW-SYSTEM                   PIC X(2).
   647
   648     12  PI-PRIMARY-CERT-NO              PIC X(11).
   649     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   650         88  PI-USES-PAID-TO                 VALUE '1'.
   651     12  PI-CRDTCRD-SYSTEM.
   652         16  PI-CRDTCRD-USER             PIC X.
   653             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   654             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   655         16  PI-CC-MONTH-END-DT          PIC XX.
   656     12  PI-PROCESSOR-PRINTER            PIC X(4).
   657
   658     12  PI-OE-REFERENCE-2.
   659         16  PI-OE-REF-2-PRIME           PIC X(10).
   660         16  PI-OE-REF-2-SUFF            PIC X.
   661
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL850.cbl
   662     12  PI-REM-TRM-CALC-OPTION          PIC X.
   663
   664     12  PI-LANGUAGE-TYPE                PIC X.
   665             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   666             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   667             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   668
   669     12  PI-POLICY-LINKAGE-IND           PIC X.
   670         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   671         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   672                                                   LOW-VALUES.
   673
   674     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   675     12  PI-CLAIM-PW-SESSION             PIC X(1).
   676         88  PI-CLAIM-CREDIT                 VALUE '1'.
   677         88  PI-CLAIM-CONVEN                 VALUE '2'.
   678     12  FILLER                          PIC X(4).
   679
   680     12  PI-SYSTEM-LEVEL                 PIC X(145).
   681
   682     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   683         PI-SYSTEM-LEVEL.
   684
   685         16  PI-ENTRY-CODES.
   686             20  PI-ENTRY-CD-1           PIC X.
   687             20  PI-ENTRY-CD-2           PIC X.
   688
   689         16  PI-RETURN-CODES.
   690             20  PI-RETURN-CD-1          PIC X.
   691             20  PI-RETURN-CD-2          PIC X.
   692
   693         16  PI-UPDATE-STATUS-SAVE.
   694             20  PI-UPDATE-BY            PIC X(4).
   695             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   696
   697         16  PI-LOWER-CASE-LETTERS       PIC X.
   698             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   699
   700*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   701*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   702*            88  CARRIER-CLM-CNTL            VALUE '2'.
   703
   704         16  PI-CERT-ACCESS-CONTROL      PIC X.
   705             88  ST-ACCNT-CNTL               VALUE ' '.
   706             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   707             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   708             88  ACCNT-CNTL                  VALUE '3'.
   709             88  CARR-ACCNT-CNTL             VALUE '4'.
   710
   711         16  PI-PROCESSOR-CAP-LIST.
   712             20  PI-SYSTEM-CONTROLS.
   713                24 PI-SYSTEM-DISPLAY     PIC X.
   714                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   715                24 PI-SYSTEM-MODIFY      PIC X.
   716                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   717             20  FILLER                  PIC XX.
   718             20  PI-DISPLAY-CAP          PIC X.
   719                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL850.cbl
   720             20  PI-MODIFY-CAP           PIC X.
   721                 88  MODIFY-CAP              VALUE 'Y'.
   722             20  PI-MSG-AT-LOGON-CAP     PIC X.
   723                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   724             20  PI-FORCE-CAP            PIC X.
   725                 88  FORCE-CAP               VALUE 'Y'.
   726
   727         16  PI-PROGRAM-CONTROLS.
   728             20  PI-PGM-PRINT-OPT        PIC X.
   729             20  PI-PGM-FORMAT-OPT       PIC X.
   730             20  PI-PGM-PROCESS-OPT      PIC X.
   731             20  PI-PGM-TOTALS-OPT       PIC X.
   732
   733         16  PI-HELP-INTERFACE.
   734             20  PI-LAST-ERROR-NO        PIC X(4).
   735             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   736
   737         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   738             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   739
   740         16  PI-CR-CONTROL-IN-PROGRESS.
   741             20  PI-CR-CARRIER           PIC X.
   742             20  PI-CR-GROUPING          PIC X(6).
   743             20  PI-CR-STATE             PIC XX.
   744             20  PI-CR-ACCOUNT           PIC X(10).
   745             20  PI-CR-FIN-RESP          PIC X(10).
   746             20  PI-CR-TYPE              PIC X.
   747
   748         16  PI-CR-BATCH-NUMBER          PIC X(6).
   749
   750         16  PI-CR-MONTH-END-DT          PIC XX.
   751
   752         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   753             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   754             88  PI-ZERO-CARRIER             VALUE '1'.
   755             88  PI-ZERO-GROUPING            VALUE '2'.
   756             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   757
   758         16  PI-CARRIER-SECURITY         PIC X.
   759             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   760
   761         16  PI-ACCOUNT-SECURITY         PIC X(10).
   762             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   763             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   764
   765         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   766             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   767                                         INDEXED BY PI-ACCESS-NDX
   768                                         PIC X.
   769
   770         16  PI-GA-BILLING-CONTROL       PIC X.
   771             88  PI-GA-BILLING               VALUE '1'.
   772
   773         16  PI-MAIL-PROCESSING          PIC X.
   774             88  PI-MAIL-YES                 VALUE 'Y'.
   775
   776         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   777
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL850.cbl
   778         16  PI-AR-SYSTEM.
   779             20  PI-AR-PROCESSING-CNTL   PIC X.
   780                 88  PI-AR-PROCESSING        VALUE 'Y'.
   781             20  PI-AR-SUMMARY-CODE      PIC X(6).
   782             20  PI-AR-MONTH-END-DT      PIC XX.
   783
   784         16  PI-MP-SYSTEM.
   785             20  PI-MORTGAGE-USER            PIC X.
   786                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   787                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   788             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   789                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   790                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   791                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   792                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   793                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   794             20  PI-MP-MONTH-END-DT          PIC XX.
   795             20  PI-MP-REFERENCE-NO.
   796                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   797                 24  PI-MP-REFERENCE-SFX     PIC XX.
   798
   799         16  PI-LABEL-CONTROL            PIC X(01).
   800             88  PI-CREATE-LABELS                    VALUE 'Y'.
   801             88  PI-BYPASS-LABELS                    VALUE 'N'.
   802
   803         16  PI-BILL-GROUPING-CODE       PIC X(01).
   804             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   805
   806         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   807             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   808             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   809
   810         16  FILLER                      PIC X(14).
   811
   812     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   813******************************************************************
   814
   815     12  FILLER                      REDEFINES
   816         PI-PROGRAM-WORK-AREA.
   817         16  FILLER                  PIC X(45).
   818         16  PI-AR-MODE              PIC X.
   819         16  FILLER                  PIC X(594).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL850.cbl
   821
   822*                            COPY ELCAID.
   823******************************************************************
   824*                                                                *
   825*                            ELCAID.                             *
   826*                            VMOD=2.001                          *
   827*                                                                *
   828*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   829*                                                                *
   830*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   831*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   832******************************************************************
   833
   834 01  DFHAID.
   835   02  DFHNULL   PIC  X  VALUE  ' '.
   836   02  DFHENTER  PIC  X  VALUE  QUOTE.
   837   02  DFHCLEAR  PIC  X  VALUE  '_'.
   838   02  DFHPEN    PIC  X  VALUE  '='.
   839   02  DFHOPID   PIC  X  VALUE  'W'.
   840   02  DFHPA1    PIC  X  VALUE  '%'.
   841   02  DFHPA2    PIC  X  VALUE  '>'.
   842   02  DFHPA3    PIC  X  VALUE  ','.
   843   02  DFHPF1    PIC  X  VALUE  '1'.
   844   02  DFHPF2    PIC  X  VALUE  '2'.
   845   02  DFHPF3    PIC  X  VALUE  '3'.
   846   02  DFHPF4    PIC  X  VALUE  '4'.
   847   02  DFHPF5    PIC  X  VALUE  '5'.
   848   02  DFHPF6    PIC  X  VALUE  '6'.
   849   02  DFHPF7    PIC  X  VALUE  '7'.
   850   02  DFHPF8    PIC  X  VALUE  '8'.
   851   02  DFHPF9    PIC  X  VALUE  '9'.
   852   02  DFHPF10   PIC  X  VALUE  ':'.
   853   02  DFHPF11   PIC  X  VALUE  '#'.
   854   02  DFHPF12   PIC  X  VALUE  '@'.
   855   02  DFHPF13   PIC  X  VALUE  'A'.
   856   02  DFHPF14   PIC  X  VALUE  'B'.
   857   02  DFHPF15   PIC  X  VALUE  'C'.
   858   02  DFHPF16   PIC  X  VALUE  'D'.
   859   02  DFHPF17   PIC  X  VALUE  'E'.
   860   02  DFHPF18   PIC  X  VALUE  'F'.
   861   02  DFHPF19   PIC  X  VALUE  'G'.
   862   02  DFHPF20   PIC  X  VALUE  'H'.
   863   02  DFHPF21   PIC  X  VALUE  'I'.
   864*00039    02  DFHPF22   PIC  X  VALUE  ''.
   865   02  DFHPF22   PIC  X  VALUE  '['.
   866   02  DFHPF23   PIC  X  VALUE  '.'.
   867   02  DFHPF24   PIC  X  VALUE  '<'.
   868   02  DFHMSRE   PIC  X  VALUE  'X'.
   869   02  DFHSTRF   PIC  X  VALUE  'h'.
   870   02  DFHTRIG   PIC  X  VALUE  '"'.
   871
   872 01  FILLER    REDEFINES DFHAID.
   873     12  FILLER              PIC X(8).
   874     12  PF-VALUES           PIC X       OCCURS 2.
   875
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL850.cbl
   877
   878*                            COPY EL850S.
   879 01  EL850AI.
   880     05  FILLER            PIC  X(0012).
   881*    -------------------------------
   882     05  DATEL PIC S9(0004) COMP.
   883     05  DATEF PIC  X(0001).
   884     05  FILLER REDEFINES DATEF.
   885         10  DATEA PIC  X(0001).
   886     05  DATEI PIC  X(0008).
   887*    -------------------------------
   888     05  TIMEL PIC S9(0004) COMP.
   889     05  TIMEF PIC  X(0001).
   890     05  FILLER REDEFINES TIMEF.
   891         10  TIMEA PIC  X(0001).
   892     05  TIMEI PIC  X(0005).
   893*    -------------------------------
   894     05  ERRMSGL PIC S9(0004) COMP.
   895     05  ERRMSGF PIC  X(0001).
   896     05  FILLER REDEFINES ERRMSGF.
   897         10  ERRMSGA PIC  X(0001).
   898     05  ERRMSGI PIC  X(0072).
   899*    -------------------------------
   900     05  SELECTL PIC S9(0004) COMP.
   901     05  SELECTF PIC  X(0001).
   902     05  FILLER REDEFINES SELECTF.
   903         10  SELECTA PIC  X(0001).
   904     05  SELECTI PIC  X(0002).
   905*    -------------------------------
   906     05  PFENTERL PIC S9(0004) COMP.
   907     05  PFENTERF PIC  X(0001).
   908     05  FILLER REDEFINES PFENTERF.
   909         10  PFENTERA PIC  X(0001).
   910     05  PFENTERI PIC  9(2).
   911 01  EL850AO REDEFINES EL850AI.
   912     05  FILLER            PIC  X(0012).
   913*    -------------------------------
   914     05  FILLER            PIC  X(0003).
   915     05  DATEO PIC  X(0008).
   916*    -------------------------------
   917     05  FILLER            PIC  X(0003).
   918     05  TIMEO PIC  99.99.
   919*    -------------------------------
   920     05  FILLER            PIC  X(0003).
   921     05  ERRMSGO PIC  X(0072).
   922*    -------------------------------
   923     05  FILLER            PIC  X(0003).
   924     05  SELECTO PIC  X(0002).
   925*    -------------------------------
   926     05  FILLER            PIC  X(0003).
   927     05  PFENTERO PIC  X(0002).
   928*    -------------------------------
   929
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL850.cbl
   931****************************************************************
   932*
   933* Copyright (c) 2007 by Clerity Solutions, Inc.
   934* All rights reserved.
   935*
   936****************************************************************
   937 01  DFHEIV.
   938   02  DFHEIV0               PIC X(35).
   939   02  DFHEIV1               PIC X(08).
   940   02  DFHEIV2               PIC X(08).
   941   02  DFHEIV3               PIC X(08).
   942   02  DFHEIV4               PIC X(06).
   943   02  DFHEIV5               PIC X(04).
   944   02  DFHEIV6               PIC X(04).
   945   02  DFHEIV7               PIC X(02).
   946   02  DFHEIV8               PIC X(02).
   947   02  DFHEIV9               PIC X(01).
   948   02  DFHEIV10              PIC S9(7) COMP-3.
   949   02  DFHEIV11              PIC S9(4) COMP SYNC.
   950   02  DFHEIV12              PIC S9(4) COMP SYNC.
   951   02  DFHEIV13              PIC S9(4) COMP SYNC.
   952   02  DFHEIV14              PIC S9(4) COMP SYNC.
   953   02  DFHEIV15              PIC S9(4) COMP SYNC.
   954   02  DFHEIV16              PIC S9(9) COMP SYNC.
   955   02  DFHEIV17              PIC X(04).
   956   02  DFHEIV18              PIC X(04).
   957   02  DFHEIV19              PIC X(04).
   958   02  DFHEIV20              USAGE IS POINTER.
   959   02  DFHEIV21              USAGE IS POINTER.
   960   02  DFHEIV22              USAGE IS POINTER.
   961   02  DFHEIV23              USAGE IS POINTER.
   962   02  DFHEIV24              USAGE IS POINTER.
   963   02  DFHEIV25              PIC S9(9) COMP SYNC.
   964   02  DFHEIV26              PIC S9(9) COMP SYNC.
   965   02  DFHEIV27              PIC S9(9) COMP SYNC.
   966   02  DFHEIV28              PIC S9(9) COMP SYNC.
   967   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   968   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   969   02  FILLER                PIC X(02).
   970   02  DFHEIV99              PIC X(08) VALUE SPACE.
   971   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   972   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   973   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   974   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   975 LINKAGE  SECTION.
   976*****************************************************************
   977*                                                               *
   978* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   979* All rights reserved.                                          *
   980*                                                               *
   981*****************************************************************
   982 01  dfheiblk.
   983     02  eibtime          pic s9(7) comp-3.
   984     02  eibdate          pic s9(7) comp-3.
   985     02  eibtrnid         pic x(4).
   986     02  eibtaskn         pic s9(7) comp-3.
   987     02  eibtrmid         pic x(4).
   988     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL850.cbl
   989     02  eibcposn         pic s9(4) comp.
   990     02  eibcalen         pic s9(4) comp.
   991     02  eibaid           pic x(1).
   992     02  eibfiller1       pic x(1).
   993     02  eibfn            pic x(2).
   994     02  eibfiller2       pic x(2).
   995     02  eibrcode         pic x(6).
   996     02  eibfiller3       pic x(2).
   997     02  eibds            pic x(8).
   998     02  eibreqid         pic x(8).
   999     02  eibrsrce         pic x(8).
  1000     02  eibsync          pic x(1).
  1001     02  eibfree          pic x(1).
  1002     02  eibrecv          pic x(1).
  1003     02  eibsend          pic x(1).
  1004     02  eibatt           pic x(1).
  1005     02  eibeoc           pic x(1).
  1006     02  eibfmh           pic x(1).
  1007     02  eibcompl         pic x(1).
  1008     02  eibsig           pic x(1).
  1009     02  eibconf          pic x(1).
  1010     02  eiberr           pic x(1).
  1011     02  eibrldbk         pic x(1).
  1012     02  eiberrcd         pic x(4).
  1013     02  eibsynrb         pic x(1).
  1014     02  eibnodat         pic x(1).
  1015     02  eibfiller5       pic x(2).
  1016     02  eibresp          pic 9(09) comp.
  1017     02  eibresp2         pic 9(09) comp.
  1018     02  dfheigdj         pic s9(4) comp.
  1019     02  dfheigdk         pic s9(4) comp.
  1020 01  DFHCOMMAREA             PIC X(1024).
  1021
  1022
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL850.cbl
  1024 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1025 0000-DFHEXIT SECTION.
  1026     MOVE '9#                    $   ' TO DFHEIV0.
  1027     MOVE 'EL850' TO DFHEIV1.
  1028     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1029
  1030
  1031     MOVE DFHCOMMAREA         TO PROGRAM-INTERFACE-BLOCK.
  1032
  1033     IF EIBCALEN = 0
  1034        GO TO 8800-UNAUTHORIZED-ACCESS.
  1035
  1036     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1037     MOVE '5'                    TO DC-OPTION-CODE.
  1038     MOVE LINK-CLDATCV           TO PGM-NAME.
  1039
  1040
  1041* EXEC CICS LINK
  1042*        PROGRAM  (PGM-NAME)
  1043*        COMMAREA (DATE-CONVERSION-DATA)
  1044*        LENGTH   (DC-COMM-LENGTH)
  1045*    END-EXEC.
  1046*    MOVE '."C                   ''   #00001036' TO DFHEIV0
  1047     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1048     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1049     MOVE X'2020233030303031303336' TO DFHEIV0(25:11)
  1050     CALL 'kxdfhei1' USING DFHEIV0,
  1051           PGM-NAME,
  1052           DATE-CONVERSION-DATA,
  1053           DC-COMM-LENGTH,
  1054           DFHEIV99,
  1055           DFHEIV99,
  1056           DFHEIV99
  1057     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1058
  1059
  1060     MOVE EIBTRMID               TO QID-TERM.
  1061     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DATE.
  1062     MOVE DC-BIN-DATE-1          TO SV-TODAY.
  1063
  1064     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1065         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1066             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1067             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1068             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1069             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1070             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1071             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1072             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1073             MOVE THIS-PGM TO PI-CALLING-PROGRAM
  1074             PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  1075         ELSE
  1076             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1077             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1078             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1079             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1080             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1081             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL850.cbl
  1082             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1083             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  1084
  1085
  1086* EXEC CICS HANDLE CONDITION
  1087*        NOTFND   (8830-NOT-FOUND)
  1088*        PGMIDERR (9600-PGMID-ERROR)
  1089*        ERROR    (9990-ABEND)
  1090*    END-EXEC.
  1091*    MOVE '"$IL.                 ! " #00001067' TO DFHEIV0
  1092     MOVE X'2224494C2E20202020202020' TO DFHEIV0(1:12)
  1093     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1094     MOVE X'2220233030303031303637' TO DFHEIV0(25:11)
  1095     CALL 'kxdfhei1' USING DFHEIV0
  1096     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1097
  1098
  1099     IF (EIBTRNID NOT = TRANS-ID) OR (EIBCALEN = 0)
  1100         GO TO 8100-SEND-INITIAL-MAP.
  1101
  1102     IF  EIBAID = DFHCLEAR
  1103             OR
  1104         NOT DISPLAY-CAP
  1105         GO TO 9400-CLEAR.
  1106
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL850.cbl
  1108
  1109 0200-RECEIVE.
  1110     MOVE LOW-VALUES             TO EL850AI.
  1111
  1112     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1113         MOVE ER-0008            TO EMI-ERROR
  1114         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1115         MOVE -1                 TO SELECTL
  1116         GO TO 8200-SEND-DATAONLY.
  1117
  1118
  1119* EXEC CICS RECEIVE
  1120*        MAP    (MAP-NAMEA)
  1121*        MAPSET (MAPSET-NAME)
  1122*        INTO   (EL850AI)
  1123*    END-EXEC.
  1124     MOVE LENGTH OF
  1125      EL850AI
  1126       TO DFHEIV11
  1127*    MOVE '8"T I  L              ''   #00001092' TO DFHEIV0
  1128     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1129     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1130     MOVE X'2020233030303031303932' TO DFHEIV0(25:11)
  1131     CALL 'kxdfhei1' USING DFHEIV0,
  1132           MAP-NAMEA,
  1133           EL850AI,
  1134           DFHEIV11,
  1135           MAPSET-NAME,
  1136           DFHEIV99,
  1137           DFHEIV99
  1138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1139
  1140
  1141     IF PFENTERL = ZERO
  1142         GO TO 250-CHECK-PFKEYS.
  1143
  1144     IF EIBAID NOT = DFHENTER
  1145         MOVE ER-0004           TO EMI-ERROR
  1146         GO TO 0320-INPUT-ERROR.
  1147
  1148     IF (PFENTERI IS NUMERIC)
  1149       AND (PFENTERI IS GREATER THAN ZERO
  1150       AND  IS LESS THAN 25)
  1151         MOVE PF-VALUES (PFENTERI) TO  EIBAID
  1152     ELSE
  1153         MOVE ER-0029            TO EMI-ERROR
  1154         GO TO 0320-INPUT-ERROR.
  1155
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL850.cbl
  1157
  1158 250-CHECK-PFKEYS.
  1159
  1160     IF EIBAID = DFHPF23
  1161         GO TO 8810-PF23.
  1162
  1163     IF EIBAID = DFHPF24
  1164         GO TO 9200-RETURN-MAIN-MENU.
  1165
  1166     IF EIBAID = DFHPF12
  1167         GO TO 9500-PF12.
  1168
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL850.cbl
  1170
  1171 310-CHECK-SELECTION.
  1172     IF SELECTI = '01'
  1173         MOVE XCTL-852 TO PGM-NAME
  1174         GO TO 9300-XCTL.
  1175
  1176     IF SELECTI = '02'
  1177         MOVE XCTL-856           TO PGM-NAME
  1178         GO TO 9300-XCTL.
  1179
  1180     IF SELECTI = '03'
  1181        IF MORTGAGE-SESSION
  1182            MOVE XCTL-EM880      TO PGM-NAME
  1183            GO TO 9300-XCTL
  1184        ELSE
  1185            MOVE XCTL-EL880      TO PGM-NAME
  1186            GO TO 9300-XCTL.
  1187
  1188     IF SELECTI = '04'
  1189         MOVE XCTL-636           TO PGM-NAME
  1190         GO TO 9300-XCTL.
  1191
  1192     IF SELECTI = '05'
  1193         MOVE XCTL-686           TO PGM-NAME
  1194         GO TO 9300-XCTL.
  1195
  1196     IF SELECTI = '06'
  1197         IF PI-COMPANY-ID = 'LGX' OR 'HER' OR 'CVL' OR 'CNL'
  1198             MOVE XCTL-697           TO PGM-NAME
  1199             GO TO 9300-XCTL
  1200         ELSE
  1201             IF PI-COMPANY-ID = 'NSL'
  1202                 MOVE XCTL-696       TO PGM-NAME
  1203                 GO TO 9300-XCTL
  1204             ELSE
  1205                 MOVE ER-1999        TO EMI-ERROR
  1206                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1207                 MOVE AL-UNBON       TO SELECTA
  1208                 MOVE -1             TO SELECTL
  1209                 GO TO 8200-SEND-DATAONLY.
  1210
  1211     IF SELECTI = '07'
  1212         MOVE XCTL-637           TO PGM-NAME
  1213         GO TO 9300-XCTL.
  1214
  1215     IF SELECTI = '08'
  1216         MOVE 'A'                TO PI-AR-MODE
  1217         MOVE XCTL-685           TO PGM-NAME
  1218         GO TO 9300-XCTL.
  1219
  1220     MOVE ER-0029                TO EMI-ERROR.
  1221
  1222 0320-INPUT-ERROR.
  1223     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1224     MOVE AL-UNBON               TO SELECTA.
  1225     MOVE -1                     TO SELECTL.
  1226     GO TO 8200-SEND-DATAONLY.
  1227
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL850.cbl
  1229
  1230 8100-SEND-INITIAL-MAP.
  1231     MOVE LOW-VALUES             TO EL850AO.
  1232     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  1233
  1234     MOVE EIBTIME                TO TIME-IN.
  1235     MOVE TIME-OUT               TO TIMEO.
  1236     MOVE WS-CURRENT-DATE        TO DATEO.
  1237     MOVE -1                     TO SELECTL.
  1238
  1239
  1240* EXEC CICS SEND
  1241*        MAP    (MAP-NAMEA)
  1242*        MAPSET (MAPSET-NAME)
  1243*        FROM   (EL850AO)
  1244*        ERASE
  1245*        CURSOR
  1246*    END-EXEC.
  1247     MOVE LENGTH OF
  1248      EL850AO
  1249       TO DFHEIV12
  1250     MOVE -1
  1251       TO DFHEIV11
  1252*    MOVE '8$     CT  E    H L F ,   #00001196' TO DFHEIV0
  1253     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1254     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1255     MOVE X'2020233030303031313936' TO DFHEIV0(25:11)
  1256     CALL 'kxdfhei1' USING DFHEIV0,
  1257           MAP-NAMEA,
  1258           EL850AO,
  1259           DFHEIV12,
  1260           MAPSET-NAME,
  1261           DFHEIV99,
  1262           DFHEIV99,
  1263           DFHEIV99,
  1264           DFHEIV11,
  1265           DFHEIV99,
  1266           DFHEIV99,
  1267           DFHEIV99
  1268     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1269
  1270
  1271     MOVE 'EL850'                TO PI-CALLING-PROGRAM.
  1272
  1273     GO TO 9100-RETURN-TRAN.
  1274
  1275 8200-SEND-DATAONLY.
  1276
  1277     MOVE EIBTIME                TO TIME-IN.
  1278     MOVE TIME-OUT               TO TIMEO.
  1279     MOVE WS-CURRENT-DATE        TO DATEO.
  1280     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  1281
  1282
  1283* EXEC CICS SEND
  1284*        MAP    (MAP-NAMEA)
  1285*        MAPSET (MAPSET-NAME)
  1286*        FROM   (EL850AO)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL850.cbl
  1287*        DATAONLY
  1288*        CURSOR
  1289*    END-EXEC.
  1290     MOVE LENGTH OF
  1291      EL850AO
  1292       TO DFHEIV12
  1293     MOVE -1
  1294       TO DFHEIV11
  1295*    MOVE '8$D    CT       H L F ,   #00001215' TO DFHEIV0
  1296     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  1297     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1298     MOVE X'2020233030303031323135' TO DFHEIV0(25:11)
  1299     CALL 'kxdfhei1' USING DFHEIV0,
  1300           MAP-NAMEA,
  1301           EL850AO,
  1302           DFHEIV12,
  1303           MAPSET-NAME,
  1304           DFHEIV99,
  1305           DFHEIV99,
  1306           DFHEIV99,
  1307           DFHEIV11,
  1308           DFHEIV99,
  1309           DFHEIV99,
  1310           DFHEIV99
  1311     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1312
  1313
  1314     GO TO 9100-RETURN-TRAN.
  1315
  1316 8300-SEND-TEXT.
  1317
  1318* EXEC CICS SEND TEXT
  1319*        FROM   (LOGOFF-TEXT)
  1320*        LENGTH (LOGOFF-LENGTH)
  1321*        ERASE
  1322*        FREEKB
  1323*    END-EXEC.
  1324*    MOVE '8&      T  E F  H   F -   #00001226' TO DFHEIV0
  1325     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  1326     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  1327     MOVE X'2020233030303031323236' TO DFHEIV0(25:11)
  1328     CALL 'kxdfhei1' USING DFHEIV0,
  1329           LOGOFF-TEXT,
  1330           LOGOFF-LENGTH,
  1331           DFHEIV99,
  1332           DFHEIV99,
  1333           DFHEIV99,
  1334           DFHEIV99,
  1335           DFHEIV99,
  1336           DFHEIV99,
  1337           DFHEIV99,
  1338           DFHEIV99,
  1339           DFHEIV99,
  1340           DFHEIV99
  1341     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1342
  1343
  1344
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL850.cbl
  1345* EXEC CICS RETURN
  1346*    END-EXEC.
  1347*    MOVE '.(                    &   #00001233' TO DFHEIV0
  1348     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1349     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1350     MOVE X'2020233030303031323333' TO DFHEIV0(25:11)
  1351     CALL 'kxdfhei1' USING DFHEIV0,
  1352           DFHEIV99,
  1353           DFHEIV99,
  1354           DFHEIV99,
  1355           DFHEIV99,
  1356           DFHEIV99
  1357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1358
  1359
  1360 8800-UNAUTHORIZED-ACCESS.
  1361     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  1362     GO TO 8300-SEND-TEXT.
  1363
  1364 8810-PF23.
  1365     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  1366     MOVE XCTL-005               TO PGM-NAME.
  1367     GO TO 9300-XCTL.
  1368
  1369 8830-NOT-FOUND.
  1370     MOVE 'USER RECORD NOT FOUND' TO LOGOFF-MSG.
  1371     GO TO 8300-SEND-TEXT.
  1372
  1373 9100-RETURN-TRAN.
  1374     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  1375     MOVE '850A'               TO PI-CURRENT-SCREEN-NO.
  1376
  1377* EXEC CICS RETURN
  1378*        TRANSID  (TRANS-ID)
  1379*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  1380*        LENGTH   (PI-COMM-LENGTH)
  1381*    END-EXEC.
  1382*    MOVE '.(CT                  &   #00001252' TO DFHEIV0
  1383     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1384     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1385     MOVE X'2020233030303031323532' TO DFHEIV0(25:11)
  1386     CALL 'kxdfhei1' USING DFHEIV0,
  1387           TRANS-ID,
  1388           PROGRAM-INTERFACE-BLOCK,
  1389           PI-COMM-LENGTH,
  1390           DFHEIV99,
  1391           DFHEIV99
  1392     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1393
  1394
  1395 9200-RETURN-MAIN-MENU.
  1396     MOVE XCTL-626               TO PGM-NAME.
  1397     GO TO 9300-XCTL.
  1398
  1399 9300-XCTL.
  1400
  1401* EXEC CICS XCTL
  1402*        PROGRAM  (PGM-NAME)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL850.cbl
  1403*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  1404*        LENGTH   (PI-COMM-LENGTH)
  1405*    END-EXEC.
  1406*    MOVE '.$C                   $   #00001263' TO DFHEIV0
  1407     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  1408     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1409     MOVE X'2020233030303031323633' TO DFHEIV0(25:11)
  1410     CALL 'kxdfhei1' USING DFHEIV0,
  1411           PGM-NAME,
  1412           PROGRAM-INTERFACE-BLOCK,
  1413           PI-COMM-LENGTH
  1414     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1415
  1416
  1417 9400-CLEAR.
  1418     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  1419     GO TO 9300-XCTL.
  1420
  1421 9500-PF12.
  1422     MOVE XCTL-010               TO PGM-NAME.
  1423     GO TO 9300-XCTL.
  1424
  1425 9600-PGMID-ERROR.
  1426
  1427* EXEC CICS HANDLE CONDITION
  1428*        PGMIDERR (8300-SEND-TEXT)
  1429*    END-EXEC.
  1430*    MOVE '"$L                   ! # #00001278' TO DFHEIV0
  1431     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  1432     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1433     MOVE X'2320233030303031323738' TO DFHEIV0(25:11)
  1434     CALL 'kxdfhei1' USING DFHEIV0
  1435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1436
  1437
  1438     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  1439     MOVE ' '                    TO PI-ENTRY-CD-1.
  1440     MOVE XCTL-005               TO PGM-NAME.
  1441     MOVE PGM-NAME               TO LOGOFF-PGM.
  1442     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  1443     GO TO 9300-XCTL.
  1444
  1445 9900-ERROR-FORMAT.
  1446     IF NOT EMI-ERRORS-COMPLETE
  1447         MOVE LINK-001           TO PGM-NAME
  1448
  1449* EXEC CICS LINK
  1450*            PROGRAM  (PGM-NAME)
  1451*            COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  1452*            LENGTH   (EMI-COMM-LENGTH)
  1453*        END-EXEC.
  1454*    MOVE '."C                   ''   #00001292' TO DFHEIV0
  1455     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1456     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1457     MOVE X'2020233030303031323932' TO DFHEIV0(25:11)
  1458     CALL 'kxdfhei1' USING DFHEIV0,
  1459           PGM-NAME,
  1460           ERROR-MESSAGE-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL850.cbl
  1461           EMI-COMM-LENGTH,
  1462           DFHEIV99,
  1463           DFHEIV99,
  1464           DFHEIV99
  1465     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1466
  1467
  1468 9900-EXIT.
  1469     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL850.cbl
  1471 9910-INITIALIZE-SECURITY.
  1472******************************************************************
  1473*                                                                *
  1474*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  1475*       USER SECURITY RECORD SET UP BY EL125.  IT THEN           *
  1476*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  1477*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  1478*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  1479*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  1480*                                                                *
  1481******************************************************************
  1482
  1483     IF  PI-PROCESSOR-ID NOT EQUAL 'LGXX'
  1484
  1485         IF  MORTGAGE-SESSION
  1486             MOVE '125E'             TO SC-QUID-SYSTEM
  1487             MOVE EIBTRMID           TO SC-QUID-TERMINAL
  1488
  1489
  1490* EXEC CICS READQ TS
  1491*                QUEUE  (SC-QUID-KEY)
  1492*                INTO   (SECURITY-CONTROL-E)
  1493*                LENGTH (SC-COMM-LENGTH-E)
  1494*                ITEM   (SC-ITEM)
  1495*            END-EXEC
  1496*    MOVE '*$II   L              ''   #00001319' TO DFHEIV0
  1497     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1498     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1499     MOVE X'2020233030303031333139' TO DFHEIV0(25:11)
  1500     CALL 'kxdfhei1' USING DFHEIV0,
  1501           SC-QUID-KEY,
  1502           SECURITY-CONTROL-E,
  1503           SC-COMM-LENGTH-E,
  1504           SC-ITEM,
  1505           DFHEIV99,
  1506           DFHEIV99
  1507     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1508
  1509             MOVE SC-MP-DISPLAY (W-APPL-SCRTY-NDX)
  1510                                     TO PI-DISPLAY-CAP
  1511             MOVE SC-MP-UPDATE (W-APPL-SCRTY-NDX)
  1512                                     TO PI-MODIFY-CAP
  1513
  1514             IF  NOT DISPLAY-CAP
  1515                 MOVE 'READ'         TO SM-READ
  1516                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1517                 MOVE ER-9097        TO EMI-ERROR
  1518                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1519                 GO TO 8100-SEND-INITIAL-MAP
  1520
  1521             ELSE
  1522                 GO TO 9910-EXIT
  1523
  1524         ELSE
  1525
  1526* EXEC CICS  READQ TS
  1527*                QUEUE   (QID)
  1528*                INTO    (SECURITY-CONTROL-D)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL850.cbl
  1529*                LENGTH  (SC-COMM-LENGTH-D)
  1530*                ITEM    (QID-ITEM)
  1531*                END-EXEC
  1532*    MOVE '*$II   L              ''   #00001342' TO DFHEIV0
  1533     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1534     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1535     MOVE X'2020233030303031333432' TO DFHEIV0(25:11)
  1536     CALL 'kxdfhei1' USING DFHEIV0,
  1537           QID,
  1538           SECURITY-CONTROL-D,
  1539           SC-COMM-LENGTH-D,
  1540           QID-ITEM,
  1541           DFHEIV99,
  1542           DFHEIV99
  1543     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1544
  1545             MOVE SC-AR-DISPLAY (01)
  1546                                 TO PI-DISPLAY-CAP
  1547             MOVE SC-AR-UPDATE  (01)
  1548                                 TO PI-MODIFY-CAP
  1549
  1550             IF  NOT DISPLAY-CAP
  1551                 MOVE 'READ'     TO SM-READ
  1552                 PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  1553                 MOVE ER-0070    TO  EMI-ERROR
  1554                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1555                 GO TO 8100-SEND-INITIAL-MAP.
  1556
  1557 9910-EXIT.
  1558     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL850.cbl
  1560 9990-ABEND.
  1561     MOVE LINK-004               TO PGM-NAME.
  1562     MOVE DFHEIBLK               TO EMI-LINE1.
  1563
  1564* EXEC CICS LINK
  1565*        PROGRAM  ('EL004')
  1566*        COMMAREA (EMI-LINE1)
  1567*        LENGTH   (72)
  1568*    END-EXEC.
  1569     MOVE 'EL004' TO DFHEIV1
  1570     MOVE 72
  1571       TO DFHEIV11
  1572*    MOVE '."C                   ''   #00001367' TO DFHEIV0
  1573     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1574     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1575     MOVE X'2020233030303031333637' TO DFHEIV0(25:11)
  1576     CALL 'kxdfhei1' USING DFHEIV0,
  1577           DFHEIV1,
  1578           EMI-LINE1,
  1579           DFHEIV11,
  1580           DFHEIV99,
  1581           DFHEIV99,
  1582           DFHEIV99
  1583     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1584
  1585
  1586     GO TO 8200-SEND-DATAONLY.
  1587
  1588* GOBACK.
  1589     MOVE '9%                    "   ' TO DFHEIV0
  1590     MOVE 'EL850' TO DFHEIV1
  1591     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1592     GOBACK.
  1593
  1594 9995-SECURITY-VIOLATION.
  1595*                            COPY ELCSCTP.
  1596******************************************************************
  1597*                                                                *
  1598*                            ELCSCTP                             *
  1599*                            VMOD=2.001                          *
  1600*                                                                *
  1601*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  1602******************************************************************
  1603
  1604
  1605     MOVE EIBDATE          TO SM-JUL-DATE.
  1606     MOVE EIBTRMID         TO SM-TERMID.
  1607     MOVE THIS-PGM         TO SM-PGM.
  1608     MOVE EIBTIME          TO TIME-IN.
  1609     MOVE TIME-OUT         TO SM-TIME.
  1610     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  1611
  1612
  1613* EXEC CICS LINK
  1614*         PROGRAM  ('EL003')
  1615*         COMMAREA (SECURITY-MESSAGE)
  1616*         LENGTH   (80)
  1617*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL850.cbl
  1618     MOVE 'EL003' TO DFHEIV1
  1619     MOVE 80
  1620       TO DFHEIV11
  1621*    MOVE '."C                   ''   #00001394' TO DFHEIV0
  1622     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1623     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1624     MOVE X'2020233030303031333934' TO DFHEIV0(25:11)
  1625     CALL 'kxdfhei1' USING DFHEIV0,
  1626           DFHEIV1,
  1627           SECURITY-MESSAGE,
  1628           DFHEIV11,
  1629           DFHEIV99,
  1630           DFHEIV99,
  1631           DFHEIV99
  1632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1633
  1634
  1635******************************************************************
  1636
  1637
  1638 9995-EXIT.
  1639     EXIT.
  1640
  1641
  1642 9999-DFHBACK SECTION.
  1643     MOVE '9%                    "   ' TO DFHEIV0
  1644     MOVE 'EL850' TO DFHEIV1
  1645     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1646     GOBACK.
  1647 9999-DFHEXIT.
  1648     IF DFHEIGDJ EQUAL 0001
  1649         NEXT SENTENCE
  1650     ELSE IF DFHEIGDJ EQUAL 2
  1651         GO TO 8830-NOT-FOUND,
  1652               9600-PGMID-ERROR,
  1653               9990-ABEND
  1654         DEPENDING ON DFHEIGDI
  1655     ELSE IF DFHEIGDJ EQUAL 3
  1656         GO TO 8300-SEND-TEXT
  1657         DEPENDING ON DFHEIGDI.
  1658     MOVE '9%                    "   ' TO DFHEIV0
  1659     MOVE 'EL850' TO DFHEIV1
  1660     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1661     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        3756     Code:        3503
