* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6851.cbl
* Options: int("EL6851.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6851.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6851.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6851.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6851.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:56:47.
     7*                            VMOD=2.013
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6851.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.
    25*        THIS PROGRAM WILL PRINT ONE OF THREE REPORTS
    26*          1)  CHECKS WAITING TO BE PRINTED
    27*          2)  CHECKS PRINTED
    28*          3)  CHECKS RELEASED REPORT
    29*
    30*    ENTERED BY  - EL685  - CHECKS TO BE PRINTED REPORT
    31*                           CHECKS PRINTED REPORT
    32*                  EL686  - A/R CHECKS RELEASED REPORT
    33
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6851.cbl
    35 ENVIRONMENT DIVISION.
    36
    37 DATA DIVISION.
    38
    39 WORKING-STORAGE SECTION.
    40 01  DFH-START PIC X(04).
    41
    42 77  THIS-PGM PIC X(6)  VALUE 'EL6851'.
    43 77  FILLER  PIC X(32)  VALUE '********************************'.
    44 77  FILLER  PIC X(32)  VALUE '*   EL6851 WORKING STORAGE     *'.
    45 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.013 *********'.
    46
    47 01  WS-DATE-AREA.
    48     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    49     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
    50
    51 01  FILLER   COMP-3.
    52     05  WS-READNEXT-SW              PIC S9          VALUE ZERO.
    53     05  WS-TIME-WORK                PIC S9(7)       VALUE ZERO.
    54     05  WS-TIME                     REDEFINES
    55         WS-TIME-WORK                PIC S9(3)V9(4).
    56
    57 01  FILLER.
    58     05  ERROR-LINE                 PIC X(80).
    59     05  WS-CHECK-QUEUE-DSID        PIC X(8) VALUE 'ERCHKQ'.
    60     05  WS-COMCK-QUEUE-DSID        PIC X(8) VALUE 'ERCMKQ'.
    61     05  WS-PENDING-PAYMENTS-DSID   PIC X(8) VALUE 'ERPYAJ'.
    62     05  WS-NO-CHECKS               PIC S9(4) VALUE +0.
    63
    64 01  FILLER.
    65     05  WS-TO-BE-PRINTED-DESC      PIC X(28)        VALUE
    66         '-   CHECKS TO BE PRINTED   -'.
    67
    68     05  WS-CHECKS-PRINTED-DESC     PIC X(28)        VALUE
    69         '-      PRINTED CHECKS      -'.
    70
    71     05  WS-AR-TO-BE-PRINTED-DESC   PIC X(28)        VALUE
    72         '- A/R CHECKS TO BE PRINTED -'.
    73
    74     05  WS-AR-CHECKS-PRINTED-DESC  PIC X(28)        VALUE
    75         '-    A/R PRINTED CHECKS    -'.
    76
    77     05  WS-AR-CHECKS-RELEASED-DESC PIC X(28)        VALUE
    78         '-   A/R CHECKS RELEASED   - '.
    79
    80*                            COPY ELCDMD34.
    81******************************************************************
    82*                                                                *
    83*                                                                *
    84*                            ELCDMD34.                           *
    85*                            VMOD=2.001                          *
    86*                                                                *
    87*   FILE DESCRIPTION = DMD DLO034 PARAMETER AREA                 *
    88*                                                                *
    89*    LENGTH = 272    RECFRM = FIXED                              *
    90*                                                                *
    91******************************************************************
    92 01  DLO034-COMMUNICATION-AREA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6851.cbl
    93     12  DL34-PROCESS-TYPE             PIC X.
    94     12  DL34-COMPANY-ID               PIC XXX.
    95     12  DL34-PRINT-PROGRAM-ID         PIC X(8).
    96     12  DL34-USERID                   PIC X(4).
    97     12  DL34-PRINT-LINE               PIC X(250).
    98     12  DL34-OVERRIDE-PRINTER-ID      PIC X(4).
    99     12  DL34-RETURN-CODE              PIC XX.
   100 01  DLO034-REC-LENGTH                 PIC S9(4) COMP VALUE +272.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6851.cbl
   102*                            COPY ELCINTF.
   103******************************************************************
   104*                                                                *
   105*                                                                *
   106*                            ELCINTF.                            *
   107*                            VMOD=2.017                          *
   108*                                                                *
   109*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   110*                                                                *
   111*       LENGTH = 1024                                            *
   112*                                                                *
   113******************************************************************
   114 01  PROGRAM-INTERFACE-BLOCK.
   115     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   116     12  PI-CALLING-PROGRAM              PIC X(8).
   117     12  PI-SAVED-PROGRAM-1              PIC X(8).
   118     12  PI-SAVED-PROGRAM-2              PIC X(8).
   119     12  PI-SAVED-PROGRAM-3              PIC X(8).
   120     12  PI-SAVED-PROGRAM-4              PIC X(8).
   121     12  PI-SAVED-PROGRAM-5              PIC X(8).
   122     12  PI-SAVED-PROGRAM-6              PIC X(8).
   123     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   124     12  PI-COMPANY-ID                   PIC XXX.
   125     12  PI-COMPANY-CD                   PIC X.
   126
   127     12  PI-COMPANY-PASSWORD             PIC X(8).
   128
   129     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   130
   131     12  PI-CONTROL-IN-PROGRESS.
   132         16  PI-CARRIER                  PIC X.
   133         16  PI-GROUPING                 PIC X(6).
   134         16  PI-STATE                    PIC XX.
   135         16  PI-ACCOUNT                  PIC X(10).
   136         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   137                                         PIC X(10).
   138         16  PI-CLAIM-CERT-GRP.
   139             20  PI-CLAIM-NO             PIC X(7).
   140             20  PI-CERT-NO.
   141                 25  PI-CERT-PRIME       PIC X(10).
   142                 25  PI-CERT-SFX         PIC X.
   143             20  PI-CERT-EFF-DT          PIC XX.
   144         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   145             20  PI-PLAN-CODE            PIC X(2).
   146             20  PI-REVISION-NUMBER      PIC X(3).
   147             20  PI-PLAN-EFF-DT          PIC X(2).
   148             20  PI-PLAN-EXP-DT          PIC X(2).
   149             20  FILLER                  PIC X(11).
   150         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   151             20  PI-OE-REFERENCE-1.
   152                 25  PI-OE-REF-1-PRIME   PIC X(18).
   153                 25  PI-OE-REF-1-SUFF    PIC XX.
   154
   155     12  PI-SESSION-IN-PROGRESS          PIC X.
   156         88  CLAIM-SESSION                   VALUE '1'.
   157         88  CREDIT-SESSION                  VALUE '2'.
   158         88  WARRANTY-SESSION                VALUE '3'.
   159         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6851.cbl
   160         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   161
   162
   163*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   164
   165     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   166     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   167
   168     12  PI-CREDIT-USER                  PIC X.
   169         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   170         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   171
   172     12  PI-CLAIM-USER                   PIC X.
   173         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   174         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   175
   176     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   177         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   178         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   179         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   180         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   181         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   182
   183     12  PI-PROCESSOR-ID                 PIC X(4).
   184
   185     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   186
   187     12  PI-MEMBER-CAPTION               PIC X(10).
   188
   189     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   190         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   191
   192     12  PI-LIFE-OVERRIDE-L1             PIC X.
   193     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   194     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   195     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   196
   197     12  PI-AH-OVERRIDE-L1               PIC X.
   198     12  PI-AH-OVERRIDE-L2               PIC XX.
   199     12  PI-AH-OVERRIDE-L6               PIC X(6).
   200     12  PI-AH-OVERRIDE-L12              PIC X(12).
   201
   202     12  PI-NEW-SYSTEM                   PIC X(2).
   203
   204     12  PI-PRIMARY-CERT-NO              PIC X(11).
   205     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   206         88  PI-USES-PAID-TO                 VALUE '1'.
   207     12  PI-CRDTCRD-SYSTEM.
   208         16  PI-CRDTCRD-USER             PIC X.
   209             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   210             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   211         16  PI-CC-MONTH-END-DT          PIC XX.
   212     12  PI-PROCESSOR-PRINTER            PIC X(4).
   213
   214     12  PI-OE-REFERENCE-2.
   215         16  PI-OE-REF-2-PRIME           PIC X(10).
   216         16  PI-OE-REF-2-SUFF            PIC X.
   217
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6851.cbl
   218     12  PI-REM-TRM-CALC-OPTION          PIC X.
   219
   220     12  PI-LANGUAGE-TYPE                PIC X.
   221             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   222             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   223             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   224
   225     12  PI-POLICY-LINKAGE-IND           PIC X.
   226         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   227         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   228                                                   LOW-VALUES.
   229
   230     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   231     12  PI-CLAIM-PW-SESSION             PIC X(1).
   232         88  PI-CLAIM-CREDIT                 VALUE '1'.
   233         88  PI-CLAIM-CONVEN                 VALUE '2'.
   234     12  FILLER                          PIC X(4).
   235
   236     12  PI-SYSTEM-LEVEL                 PIC X(145).
   237
   238     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   239         PI-SYSTEM-LEVEL.
   240
   241         16  PI-ENTRY-CODES.
   242             20  PI-ENTRY-CD-1           PIC X.
   243             20  PI-ENTRY-CD-2           PIC X.
   244
   245         16  PI-RETURN-CODES.
   246             20  PI-RETURN-CD-1          PIC X.
   247             20  PI-RETURN-CD-2          PIC X.
   248
   249         16  PI-UPDATE-STATUS-SAVE.
   250             20  PI-UPDATE-BY            PIC X(4).
   251             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   252
   253         16  PI-LOWER-CASE-LETTERS       PIC X.
   254             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   255
   256*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   257*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   258*            88  CARRIER-CLM-CNTL            VALUE '2'.
   259
   260         16  PI-CERT-ACCESS-CONTROL      PIC X.
   261             88  ST-ACCNT-CNTL               VALUE ' '.
   262             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   263             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   264             88  ACCNT-CNTL                  VALUE '3'.
   265             88  CARR-ACCNT-CNTL             VALUE '4'.
   266
   267         16  PI-PROCESSOR-CAP-LIST.
   268             20  PI-SYSTEM-CONTROLS.
   269                24 PI-SYSTEM-DISPLAY     PIC X.
   270                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   271                24 PI-SYSTEM-MODIFY      PIC X.
   272                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   273             20  FILLER                  PIC XX.
   274             20  PI-DISPLAY-CAP          PIC X.
   275                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6851.cbl
   276             20  PI-MODIFY-CAP           PIC X.
   277                 88  MODIFY-CAP              VALUE 'Y'.
   278             20  PI-MSG-AT-LOGON-CAP     PIC X.
   279                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   280             20  PI-FORCE-CAP            PIC X.
   281                 88  FORCE-CAP               VALUE 'Y'.
   282
   283         16  PI-PROGRAM-CONTROLS.
   284             20  PI-PGM-PRINT-OPT        PIC X.
   285             20  PI-PGM-FORMAT-OPT       PIC X.
   286             20  PI-PGM-PROCESS-OPT      PIC X.
   287             20  PI-PGM-TOTALS-OPT       PIC X.
   288
   289         16  PI-HELP-INTERFACE.
   290             20  PI-LAST-ERROR-NO        PIC X(4).
   291             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   292
   293         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   294             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   295
   296         16  PI-CR-CONTROL-IN-PROGRESS.
   297             20  PI-CR-CARRIER           PIC X.
   298             20  PI-CR-GROUPING          PIC X(6).
   299             20  PI-CR-STATE             PIC XX.
   300             20  PI-CR-ACCOUNT           PIC X(10).
   301             20  PI-CR-FIN-RESP          PIC X(10).
   302             20  PI-CR-TYPE              PIC X.
   303
   304         16  PI-CR-BATCH-NUMBER          PIC X(6).
   305
   306         16  PI-CR-MONTH-END-DT          PIC XX.
   307
   308         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   309             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   310             88  PI-ZERO-CARRIER             VALUE '1'.
   311             88  PI-ZERO-GROUPING            VALUE '2'.
   312             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   313
   314         16  PI-CARRIER-SECURITY         PIC X.
   315             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   316
   317         16  PI-ACCOUNT-SECURITY         PIC X(10).
   318             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   319             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   320
   321         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   322             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   323                                         INDEXED BY PI-ACCESS-NDX
   324                                         PIC X.
   325
   326         16  PI-GA-BILLING-CONTROL       PIC X.
   327             88  PI-GA-BILLING               VALUE '1'.
   328
   329         16  PI-MAIL-PROCESSING          PIC X.
   330             88  PI-MAIL-YES                 VALUE 'Y'.
   331
   332         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   333
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6851.cbl
   334         16  PI-AR-SYSTEM.
   335             20  PI-AR-PROCESSING-CNTL   PIC X.
   336                 88  PI-AR-PROCESSING        VALUE 'Y'.
   337             20  PI-AR-SUMMARY-CODE      PIC X(6).
   338             20  PI-AR-MONTH-END-DT      PIC XX.
   339
   340         16  PI-MP-SYSTEM.
   341             20  PI-MORTGAGE-USER            PIC X.
   342                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   343                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   344             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   345                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   346                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   347                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   348                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   349                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   350             20  PI-MP-MONTH-END-DT          PIC XX.
   351             20  PI-MP-REFERENCE-NO.
   352                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   353                 24  PI-MP-REFERENCE-SFX     PIC XX.
   354
   355         16  PI-LABEL-CONTROL            PIC X(01).
   356             88  PI-CREATE-LABELS                    VALUE 'Y'.
   357             88  PI-BYPASS-LABELS                    VALUE 'N'.
   358
   359         16  PI-BILL-GROUPING-CODE       PIC X(01).
   360             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   361
   362         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   363             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   364             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   365
   366         16  FILLER                      PIC X(14).
   367
   368     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   369******************************************************************
   370     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   371         16  PI-CHECK-QUE-KEY.
   372             20  PI-CK-COMPANY-CODE     PIC X.
   373             20  PI-CK-CONTROL-NO       PIC S9(8)          COMP.
   374             20  PI-CK-SEQUENCE-NO      PIC S9(4)          COMP.
   375
   376         16  PI-PREV-CHECK-QUE-KEY.
   377             20  PI-PREV-CK-COMPANY-CODE     PIC X.
   378             20  PI-PREV-CK-CONTROL-NO       PIC S9(8) COMP.
   379             20  PI-PREV-CK-SEQUENCE-NO      PIC S9(4) COMP.
   380
   381         16  FILLER                          PIC X(03).
   382
   383         16  PI-CONTROL-TOTALS.
   384             20  PI-CONTROL-TOT              PIC S9(7)V99 COMP-3.
   385             20  PI-CONTROL-GRAND-TOT        PIC S9(7)V99 COMP-3.
   386             20  PI-CONTROL-SAVE-CONTROL     PIC S9(8) COMP.
   387
   388         16  PI-FIRST-TIME-SWT               PIC X.
   389             88  PI-FIRST-TIME                  VALUE 'Y'.
   390             88  PI-NOT-FIRST-TIME              VALUE 'N'.
   391
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6851.cbl
   392         16  FILLER                          PIC X(02).
   393         16  PI-CHECK-MODE                   PIC X.
   394             88 CHECKS-PRINTED                  VALUE 'Y'.
   395             88 CHECKS-TO-BE-PRINTED            VALUE SPACE.
   396
   397         16  FILLER                          PIC X(10).
   398
   399         16  PI-AR-MODE                      PIC X.
   400             88 PI-ORIG-CALL-AR-MENU            VALUE 'A'.
   401
   402         16  FILLER                          PIC X(01).
   403
   404         16  PI-START-CONTROL-NO             PIC S9(08)  COMP.
   405
   406         16  PI-PAGE                         PIC S999    COMP-3.
   407         16  PI-LINE-COUNT                   PIC S999    COMP-3.
   408         16  PI-TOT-CHECKS                   PIC S9(4).
   409         16  FILLER                          PIC X(581).
   410
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6851.cbl
   412 01  HEADING-1.
   413     12  FILLER                  PIC XX      VALUE SPACES.
   414     12  ADATE                   PIC X(8).
   415     12  FILLER                  PIC XX      VALUE SPACES.
   416     12  ATIME                   PIC 99.99.
   417     12  FILLER                  PIC X(8)    VALUE SPACES.
   418     12  ACOMP                   PIC XXX.
   419     12  FILLER                  PIC X       VALUE SPACES.
   420     12  ATITLEO                 PIC X(28).
   421     12  FILLER                  PIC X(14)   VALUE SPACES.
   422     12  FILLER                  PIC X(5)    VALUE 'PAGE'.
   423     12  PAGE-NO                 PIC ZZ9.
   424
   425 01  HEADING-2.
   426     12  FILLER                  PIC XX      VALUE SPACES.
   427     12  FILLER                  PIC X(42)   VALUE
   428         'CONTROL CHECK NO  PMT TYPE   CAR  GROUP   '.
   429     12  HD2-DESC-1              PIC X(08)   VALUE 'FIN.RESP'.
   430     12  FILLER                  PIC X(03)   VALUE SPACES.
   431     12  HD2-DESC-2              PIC X(08)   VALUE ' ACCOUNT'.
   432     12  FILLER                  PIC X(17)   VALUE
   433         '       PMT AMOUNT'.
   434
   435 01  HEADING-2B.
   436     12  FILLER                  PIC XX      VALUE SPACES.
   437     12  FILLER                  PIC X(36)   VALUE
   438         'CONTROL  CHK NO   CHK DT  CAR  GRP  '.
   439     12  FILLER                  PIC X(08)   VALUE '   PAYEE'.
   440     12  FILLER                  PIC X(04)   VALUE SPACES.
   441     12  FILLER                  PIC X(04)   VALUE 'SEQ '.
   442     12  FILLER                  PIC X(11)   VALUE
   443         ' PAYEE NAME'.
   444     12  FILLER                  PIC X(05)   VALUE SPACES.
   445     12  FILLER                  PIC X(10)   VALUE
   446         'PMT AMOUNT'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6851.cbl
   448
   449 01  DETAIL-LINE.
   450     15  FILLER                      PIC X.
   451     15  EL685A-CONTROL              PIC 9(7).
   452     15  FILLER                      PIC XX.
   453     15  EL685A-CHECK-NO             PIC X(7).
   454     15  FILLER                      PIC X.
   455     15  EL685A-PMT-TYPE             PIC X(11).
   456     15  FILLER                      PIC X(3).
   457     15  EL685A-CARRIER              PIC X.
   458     15  FILLER                      PIC XX.
   459     15  EL685A-GROUP                PIC X(6).
   460     15  FILLER                      PIC XX.
   461     15  EL685A-FIN-RESP             PIC X(10).
   462     15  FILLER                      PIC X.
   463     15  EL685A-ACCOUNT              PIC X(11).
   464     15  FILLER                      PIC X.
   465     15  EL685A-AMT                  PIC Z,ZZZ,ZZ9.99-.
   466     15  FILLER                      PIC XX.
   467
   468 01  DETAIL-LINEB                    REDEFINES
   469     DETAIL-LINE.
   470     15  FILLER                      PIC XX.
   471     15  EL685B-CONTROL              PIC 9(7).
   472     15  FILLER                      PIC XX.
   473     15  EL685B-CHECK-NO             PIC X(6).
   474     15  FILLER                      PIC XX.
   475     15  EL685B-CHK-DT               PIC X(08).
   476     15  FILLER                      PIC X(2).
   477     15  EL685B-CARRIER              PIC X.
   478     15  FILLER                      PIC X.
   479     15  EL685B-GROUP                PIC X(6).
   480     15  FILLER                      PIC XX.
   481     15  EL685B-PAYEE                PIC X(10).
   482     15  FILLER                      PIC X.
   483     15  EL685B-PAYEE-SEQ            PIC ZZZ9.
   484     15  FILLER                      PIC X.
   485     15  EL685B-PAYEE-NA             PIC X(12).
   486     15  FILLER                      PIC X.
   487     15  EL685B-AMT                  PIC Z,ZZZ,ZZ9.99-.
   488
   489 01  TOTAL-LINE                      REDEFINES
   490     DETAIL-LINE.
   491     15  FILLER                      PIC X(19).
   492     15  EL685A-NO-CHECKS-DESC       PIC X(11).
   493     15  EL685A-NO-CHECKS            PIC ZZZ9.
   494     15  FILLER                      PIC X(12).
   495     15  EL685A-CNTL-DESC            PIC X(12).
   496     15  FILLER                      PIC X(8).
   497     15  EL685A-CNTL-TOTAL           PIC Z,ZZZ,ZZ9.99-.
   498     15  FILLER                      PIC XX.
   499
   500 01  TOTAL-LINE2                     REDEFINES
   501     DETAIL-LINE.
   502     15  FILLER                      PIC X(19).
   503     15  EL685B-NO-CHECKS-DESC       PIC X(11).
   504     15  EL685B-NO-CHECKS            PIC ZZZ9.
   505     15  FILLER                      PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6851.cbl
   506     15  EL685B-CNTL-DESC            PIC X(12).
   507     15  FILLER                      PIC X(8).
   508     15  EL685B-CNTL-TOTAL           PIC Z,ZZZ,ZZ9.99-.
   509     15  FILLER                      PIC XX.
   510
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6851.cbl
   512*                                COPY ELPRTCVD.
   513*****************************************************************
   514*                                                               *
   515*                            ELPRTCVD.                          *
   516*                            VMOD=2.001                         *
   517*****************************************************************.
   518
   519******************************************************************
   520***   WORK AREAS  FOR TERMINAL ONLINE PRINT ROUTINE
   521***                 -ELPRTCVD-
   522***   TO BE USED WITH PROCEDURE COPY MEMBER -ELPRTCVP-
   523******************************************************************
   524
   525 01  S-WORK-AREA                     SYNC.
   526     12  WS-LINE-LEN                 PIC S9(4)       VALUE +80
   527                                     COMP.
   528
   529     12  WS-LINE-LENGTH              PIC S9(4)       VALUE ZERO
   530                                     COMP.
   531
   532     12  WS-BUFFER-SIZE              PIC S9(4)       VALUE +1916
   533                                     COMP.
   534
   535     12  WS-BUFFER-LENGTH            PIC S9(4)       VALUE ZERO
   536                                     COMP.
   537
   538     12  WS-PROG-END                 PIC X           VALUE SPACES.
   539
   540     12  WS-PRINT-AREA.
   541         16  WS-PASSED-CNTL-CHAR     PIC X           VALUE SPACES.
   542           88  SINGLE-SPACE                          VALUE ' '.
   543           88  DOUBLE-SPACE                          VALUE '0'.
   544           88  TRIPLE-SPACE                          VALUE '-'.
   545           88  TOP-PAGE                              VALUE '1'.
   546
   547         16  WS-PASSED-DATA.
   548             20  WS-PRINT-BYTE       PIC X
   549                 OCCURS 132 TIMES    INDEXED BY PRT-INDEX.
   550
   551     12  WS-LINE-CNT                 PIC S9(3)        VALUE ZERO
   552                                     COMP-3.
   553     12  WS-WCC-CNTL                 PIC X(1)         VALUE 'H'.
   554
   555     12  WS-EM                       PIC S9(4)        VALUE +25
   556                                     COMP.
   557     12  FILLER   REDEFINES WS-EM.
   558         16  FILLER                  PIC X.
   559         16  T-EM                    PIC X.
   560
   561*    12  WS-SS                       PIC S9(4)        VALUE +21
   562     12  WS-SS                       PIC S9(4)        VALUE +10
   563                                     COMP.
   564     12  FILLER   REDEFINES WS-SS.
   565         16  FILLER                  PIC X.
   566         16  T-SS                    PIC X.
   567
   568     12  WS-TP                       PIC S9(4)      VALUE +12
   569                                     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6851.cbl
   570     12  FILLER   REDEFINES WS-TP.
   571         16  FILLER                  PIC X.
   572         16  T-TP                    PIC X.
   573
   574     12  WS-FIRST-TIME-SW            PIC X           VALUE '1'.
   575         88  FIRST-TIME                              VALUE '1'.
   576         88  FIRST-LINE-NEXT-BUFFER                  VALUE '2'.
   577
   578     12  WS-BUFFER-AREA.
   579         16  WS-BUFFER-BYTE          PIC X
   580             OCCURS 1920 TIMES       INDEXED BY BUFFER-INDEX
   581                                                BUFFER-INDEX2.
   582
   583******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6851.cbl
   585*                                COPY ELCDATE.
   586******************************************************************
   587*                                                                *
   588*                                                                *
   589*                            ELCDATE.                            *
   590*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   591*                            VMOD=2.003
   592*                                                                *
   593*                                                                *
   594*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   595*                 LENGTH = 200                                   *
   596******************************************************************
   597
   598 01  DATE-CONVERSION-DATA.
   599     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   600     12  DC-OPTION-CODE                PIC X.
   601         88  BIN-TO-GREG                VALUE ' '.
   602         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   603         88  EDIT-GREG-TO-BIN           VALUE '2'.
   604         88  YMD-GREG-TO-BIN            VALUE '3'.
   605         88  MDY-GREG-TO-BIN            VALUE '4'.
   606         88  JULIAN-TO-BIN              VALUE '5'.
   607         88  BIN-PLUS-ELAPSED           VALUE '6'.
   608         88  FIND-CENTURY               VALUE '7'.
   609         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   610         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   611         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   612         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   613         88  JULIAN-TO-BIN-3            VALUE 'C'.
   614         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   615         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   616         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   617         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   618         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   619         88  CHECK-LEAP-YEAR            VALUE 'H'.
   620         88  BIN-3-TO-GREG              VALUE 'I'.
   621         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   622         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   623         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   624         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   625         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   626         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   627         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   628         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   629         88  THREE-CHARACTER-BIN
   630                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   631         88  GREGORIAN-TO-BIN
   632                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   633         88  BIN-TO-GREGORIAN
   634                  VALUES ' ' '1' 'I' '8' 'G'.
   635         88  JULIAN-TO-BINARY
   636                  VALUES '5' 'C' 'E' 'F'.
   637     12  DC-ERROR-CODE                 PIC X.
   638         88  NO-CONVERSION-ERROR        VALUE ' '.
   639         88  DATE-CONVERSION-ERROR
   640                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   641         88  DATE-IS-ZERO               VALUE '1'.
   642         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6851.cbl
   643         88  DATE-IS-INVALID            VALUE '3'.
   644         88  DATE1-GREATER-DATE2        VALUE '4'.
   645         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   646         88  DATE-INVALID-OPTION        VALUE '9'.
   647         88  INVALID-CENTURY            VALUE 'A'.
   648         88  ONLY-CENTURY               VALUE 'B'.
   649         88  ONLY-LEAP-YEAR             VALUE 'C'.
   650         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   651     12  DC-END-OF-MONTH               PIC X.
   652         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   653     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   654         88  USE-NORMAL-PROCESS         VALUE ' '.
   655         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   656         88  ADJUST-UP-100-YRS          VALUE '2'.
   657     12  FILLER                        PIC X.
   658     12  DC-CONVERSION-DATES.
   659         16  DC-BIN-DATE-1             PIC XX.
   660         16  DC-BIN-DATE-2             PIC XX.
   661         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   662         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   663                       DC-GREG-DATE-1-EDIT.
   664             20  DC-EDIT1-MONTH        PIC 99.
   665             20  SLASH1-1              PIC X.
   666             20  DC-EDIT1-DAY          PIC 99.
   667             20  SLASH1-2              PIC X.
   668             20  DC-EDIT1-YEAR         PIC 99.
   669         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   670         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   671                     DC-GREG-DATE-2-EDIT.
   672             20  DC-EDIT2-MONTH        PIC 99.
   673             20  SLASH2-1              PIC X.
   674             20  DC-EDIT2-DAY          PIC 99.
   675             20  SLASH2-2              PIC X.
   676             20  DC-EDIT2-YEAR         PIC 99.
   677         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   678         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   679                     DC-GREG-DATE-1-YMD.
   680             20  DC-YMD-YEAR           PIC 99.
   681             20  DC-YMD-MONTH          PIC 99.
   682             20  DC-YMD-DAY            PIC 99.
   683         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   684         16  DC-GREG-DATE-1-MDY-R REDEFINES
   685                      DC-GREG-DATE-1-MDY.
   686             20  DC-MDY-MONTH          PIC 99.
   687             20  DC-MDY-DAY            PIC 99.
   688             20  DC-MDY-YEAR           PIC 99.
   689         16  DC-GREG-DATE-1-ALPHA.
   690             20  DC-ALPHA-MONTH        PIC X(10).
   691             20  DC-ALPHA-DAY          PIC 99.
   692             20  FILLER                PIC XX.
   693             20  DC-ALPHA-CENTURY.
   694                 24 DC-ALPHA-CEN-N     PIC 99.
   695             20  DC-ALPHA-YEAR         PIC 99.
   696         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   697         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   698         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   699         16  DC-JULIAN-DATE            PIC 9(05).
   700         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6851.cbl
   701                                       PIC 9(05).
   702         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   703             20  DC-JULIAN-YEAR        PIC 99.
   704             20  DC-JULIAN-DAYS        PIC 999.
   705         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   706         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   707         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   708     12  DATE-CONVERSION-VARIBLES.
   709         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   710         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   711             20  FILLER                PIC 9(3).
   712             20  HOLD-CEN-1-CCYY.
   713                 24  HOLD-CEN-1-CC     PIC 99.
   714                 24  HOLD-CEN-1-YY     PIC 99.
   715             20  HOLD-CEN-1-MO         PIC 99.
   716             20  HOLD-CEN-1-DA         PIC 99.
   717         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   718             20  HOLD-CEN-1-R-MO       PIC 99.
   719             20  HOLD-CEN-1-R-DA       PIC 99.
   720             20  HOLD-CEN-1-R-CCYY.
   721                 24  HOLD-CEN-1-R-CC   PIC 99.
   722                 24  HOLD-CEN-1-R-YY   PIC 99.
   723             20  FILLER                PIC 9(3).
   724         16  HOLD-CENTURY-1-X.
   725             20  FILLER                PIC X(3)  VALUE SPACES.
   726             20  HOLD-CEN-1-X-CCYY.
   727                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   728                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   729             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   730             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   731         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   732             20  HOLD-CEN-1-R-X-MO     PIC XX.
   733             20  HOLD-CEN-1-R-X-DA     PIC XX.
   734             20  HOLD-CEN-1-R-X-CCYY.
   735                 24  HOLD-CEN-1-R-X-CC PIC XX.
   736                 24  HOLD-CEN-1-R-X-YY PIC XX.
   737             20  FILLER                PIC XXX.
   738         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   739         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   740         16  DC-JULIAN-DATE-1          PIC 9(07).
   741         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   742             20  DC-JULIAN-1-CCYY.
   743                 24  DC-JULIAN-1-CC    PIC 99.
   744                 24  DC-JULIAN-1-YR    PIC 99.
   745             20  DC-JULIAN-DA-1        PIC 999.
   746         16  DC-JULIAN-DATE-2          PIC 9(07).
   747         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   748             20  DC-JULIAN-2-CCYY.
   749                 24  DC-JULIAN-2-CC    PIC 99.
   750                 24  DC-JULIAN-2-YR    PIC 99.
   751             20  DC-JULIAN-DA-2        PIC 999.
   752         16  DC-GREG-DATE-A-EDIT.
   753             20  DC-EDITA-MONTH        PIC 99.
   754             20  SLASHA-1              PIC X VALUE '/'.
   755             20  DC-EDITA-DAY          PIC 99.
   756             20  SLASHA-2              PIC X VALUE '/'.
   757             20  DC-EDITA-CCYY.
   758                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6851.cbl
   759                 24  DC-EDITA-YEAR     PIC 99.
   760         16  DC-GREG-DATE-B-EDIT.
   761             20  DC-EDITB-MONTH        PIC 99.
   762             20  SLASHB-1              PIC X VALUE '/'.
   763             20  DC-EDITB-DAY          PIC 99.
   764             20  SLASHB-2              PIC X VALUE '/'.
   765             20  DC-EDITB-CCYY.
   766                 24  DC-EDITB-CENT     PIC 99.
   767                 24  DC-EDITB-YEAR     PIC 99.
   768         16  DC-GREG-DATE-CYMD         PIC 9(08).
   769         16  DC-GREG-DATE-CYMD-R REDEFINES
   770                              DC-GREG-DATE-CYMD.
   771             20  DC-CYMD-CEN           PIC 99.
   772             20  DC-CYMD-YEAR          PIC 99.
   773             20  DC-CYMD-MONTH         PIC 99.
   774             20  DC-CYMD-DAY           PIC 99.
   775         16  DC-GREG-DATE-MDCY         PIC 9(08).
   776         16  DC-GREG-DATE-MDCY-R REDEFINES
   777                              DC-GREG-DATE-MDCY.
   778             20  DC-MDCY-MONTH         PIC 99.
   779             20  DC-MDCY-DAY           PIC 99.
   780             20  DC-MDCY-CEN           PIC 99.
   781             20  DC-MDCY-YEAR          PIC 99.
   782    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   783        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   784    12  DC-EL310-DATE                  PIC X(21).
   785    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6851.cbl
   787****************************************************************
   788*
   789* Copyright (c) 2007 by Clerity Solutions, Inc.
   790* All rights reserved.
   791*
   792****************************************************************
   793 01  DFHEIV.
   794   02  DFHEIV0               PIC X(35).
   795   02  DFHEIV1               PIC X(08).
   796   02  DFHEIV2               PIC X(08).
   797   02  DFHEIV3               PIC X(08).
   798   02  DFHEIV4               PIC X(06).
   799   02  DFHEIV5               PIC X(04).
   800   02  DFHEIV6               PIC X(04).
   801   02  DFHEIV7               PIC X(02).
   802   02  DFHEIV8               PIC X(02).
   803   02  DFHEIV9               PIC X(01).
   804   02  DFHEIV10              PIC S9(7) COMP-3.
   805   02  DFHEIV11              PIC S9(4) COMP SYNC.
   806   02  DFHEIV12              PIC S9(4) COMP SYNC.
   807   02  DFHEIV13              PIC S9(4) COMP SYNC.
   808   02  DFHEIV14              PIC S9(4) COMP SYNC.
   809   02  DFHEIV15              PIC S9(4) COMP SYNC.
   810   02  DFHEIV16              PIC S9(9) COMP SYNC.
   811   02  DFHEIV17              PIC X(04).
   812   02  DFHEIV18              PIC X(04).
   813   02  DFHEIV19              PIC X(04).
   814   02  DFHEIV20              USAGE IS POINTER.
   815   02  DFHEIV21              USAGE IS POINTER.
   816   02  DFHEIV22              USAGE IS POINTER.
   817   02  DFHEIV23              USAGE IS POINTER.
   818   02  DFHEIV24              USAGE IS POINTER.
   819   02  DFHEIV25              PIC S9(9) COMP SYNC.
   820   02  DFHEIV26              PIC S9(9) COMP SYNC.
   821   02  DFHEIV27              PIC S9(9) COMP SYNC.
   822   02  DFHEIV28              PIC S9(9) COMP SYNC.
   823   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   824   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   825   02  FILLER                PIC X(02).
   826   02  DFHEIV99              PIC X(08) VALUE SPACE.
   827   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   828   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   829   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   830   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   831 LINKAGE  SECTION.
   832*****************************************************************
   833*                                                               *
   834* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   835* All rights reserved.                                          *
   836*                                                               *
   837*****************************************************************
   838 01  dfheiblk.
   839     02  eibtime          pic s9(7) comp-3.
   840     02  eibdate          pic s9(7) comp-3.
   841     02  eibtrnid         pic x(4).
   842     02  eibtaskn         pic s9(7) comp-3.
   843     02  eibtrmid         pic x(4).
   844     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6851.cbl
   845     02  eibcposn         pic s9(4) comp.
   846     02  eibcalen         pic s9(4) comp.
   847     02  eibaid           pic x(1).
   848     02  eibfiller1       pic x(1).
   849     02  eibfn            pic x(2).
   850     02  eibfiller2       pic x(2).
   851     02  eibrcode         pic x(6).
   852     02  eibfiller3       pic x(2).
   853     02  eibds            pic x(8).
   854     02  eibreqid         pic x(8).
   855     02  eibrsrce         pic x(8).
   856     02  eibsync          pic x(1).
   857     02  eibfree          pic x(1).
   858     02  eibrecv          pic x(1).
   859     02  eibsend          pic x(1).
   860     02  eibatt           pic x(1).
   861     02  eibeoc           pic x(1).
   862     02  eibfmh           pic x(1).
   863     02  eibcompl         pic x(1).
   864     02  eibsig           pic x(1).
   865     02  eibconf          pic x(1).
   866     02  eiberr           pic x(1).
   867     02  eibrldbk         pic x(1).
   868     02  eiberrcd         pic x(4).
   869     02  eibsynrb         pic x(1).
   870     02  eibnodat         pic x(1).
   871     02  eibfiller5       pic x(2).
   872     02  eibresp          pic 9(09) comp.
   873     02  eibresp2         pic 9(09) comp.
   874     02  dfheigdj         pic s9(4) comp.
   875     02  dfheigdk         pic s9(4) comp.
   876
   877*01 DFHBLLDS  COMP SYNC.
   878*    05  BLLCBAR                     PIC S9(9).
   879*    05  CQFCBAR                     PIC S9(9).
   880*    05  CMFCBAR                     PIC S9(9).
   881*    05  PPFCBAR                     PIC S9(9).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6851.cbl
   883*                                COPY ERCCHKQ.
   884******************************************************************
   885*                                                                *
   886*                                                                *
   887*                            ERCCHKQ                             *
   888*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   889*                            VMOD=2.005                          *
   890*                                                                *
   891*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
   892*                                                                *
   893*   FILE TYPE = VSAM,KSDS                                        *
   894*   RECORD SIZE = 100  RECFORM = FIXED                           *
   895*                                                                *
   896*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
   897*       ALTERNATE PATH  = NONE                                   *
   898*                                                                *
   899*   LOG = YES                                                    *
   900*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   901******************************************************************
   902 01  DFHCOMMAREA       PIC X(01).
   903 01  CHECK-QUE.
   904     12  CQ-RECORD-ID                PIC XX.
   905         88  VALID-CQ-ID                     VALUE 'CQ'.
   906
   907     12  CQ-CONTROL-PRIMARY.
   908         16  CQ-COMPANY-CD           PIC X.
   909         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
   910         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
   911
   912     12  CQ-ENTRY-TYPE               PIC X.
   913             88  CHECK-ON-QUE           VALUE 'Q'.
   914             88  ALIGNMENT-CHECK        VALUE 'A'.
   915             88  MANUAL-CHECK           VALUE 'M'.
   916             88  SPOILED-CHECK          VALUE 'S'.
   917             88  VOIDED-CHECK           VALUE 'V'.
   918             88  PAYMENT-ABORTED        VALUE 'X'.
   919
   920     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
   921
   922     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
   923         CQ-CREDIT-MASTER-CNTL.
   924         16  CQ-PYAJ-CARRIER         PIC X.
   925         16  CQ-PYAJ-GROUPING        PIC X(6).
   926         16  CQ-PYAJ-FIN-RESP        PIC X(10).
   927         16  CQ-PYAJ-ACCOUNT         PIC X(10).
   928         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
   929         16  CQ-PYAJ-REC-TYPE        PIC X.
   930         16  FILLER                  PIC X(18).
   931
   932     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
   933         CQ-CREDIT-MASTER-CNTL.
   934         16  CQ-CHEK-CARRIER         PIC X.
   935         16  CQ-CHEK-GROUPING        PIC X(6).
   936         16  CQ-CHEK-STATE           PIC XX.
   937         16  CQ-CHEK-ACCOUNT         PIC X(10).
   938         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
   939         16  CQ-CHEK-CERT-NO.
   940             20  CQ-CHEK-CERT-PRIME  PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6851.cbl
   941             20  CQ-CHEK-CERT-SFX    PIC X.
   942         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
   943         16  CQ-CHEK-FIN-RESP        PIC X(10).
   944         16  FILLER                  PIC X(06).
   945
   946     12  CQ-CHECK-NUMBER             PIC X(7).
   947     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
   948     12  CQ-PAYMENT-TYPE             PIC X.
   949             88  CQ-BILLING-CREDIT         VALUE '1'.
   950             88  CQ-REFUND-PMT             VALUE '2'.
   951             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
   952     12  CQ-VOID-INDICATOR           PIC X.
   953             88  CHECK-IS-VOID             VALUE 'V'.
   954     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
   955     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
   956     12  CQ-CHECK-BY-USER            PIC X(4).
   957     12  CQ-PRE-NUMBERING-SW         PIC X.
   958       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
   959       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
   960
   961     12  CQ-CHECK-WRITTEN-DT         PIC XX.
   962     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
   963     12  CQ-ACCOUNT-AGENT            PIC X(10).
   964     12  CQ-CHECK-VOIDED-DT          PIC XX.
   965
   966     12  CQ-LETTERS-IND              PIC X.
   967         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
   968
   969******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6851.cbl
   971*                                COPY ERCCMKQ.
   972******************************************************************
   973*                                                                *
   974*                                                                *
   975*                            ERCCMKQ                             *
   976*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   977*                            VMOD=2.014                          *
   978*                                                                *
   979*   FILE DESCRIPTION = CHECK QUE FILE FOR THE COMMISSION         *
   980*                      CHECK OF THE CREDIT SYSTEM                *
   981*                                                                *
   982*   FILE TYPE = VSAM,KSDS                                        *
   983*   RECORD SIZE = 1800 RECFORM = FIXED                           *
   984*                                                                *
   985*   BASE CLUSTER = ERCMKQ                         RKP=2,LEN=7    *
   986*       ALTERNATE PATH  = ERCMKQ2  (BY PAYEE CONTRO AND          *
   987*                                      CONTROL NUMBER)           *
   988*                                                 RKP=9,LEN=30   *
   989*                                                                *
   990*   LOG = NO                                                     *
   991*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   992******************************************************************
   993 01  COMMISSION-CHECK-QUE.
   994     12  MQ-RECORD-ID                PIC XX.
   995         88  VALID-MQ-ID                     VALUE 'MQ'.
   996
   997     12  MQ-CONTROL-PRIMARY.
   998         16  MQ-COMPANY-CD           PIC X.
   999         16  MQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  1000         16  MQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  1001
  1002     12  MQ-CONTROL-BY-PAYEE.
  1003         16  MQ-COMPANY-CD-A1        PIC X.
  1004         16  MQ-CSR-A1               PIC X(4).
  1005         16  MQ-CARRIER-A1           PIC X.
  1006         16  MQ-GROUPING-A1          PIC X(6).
  1007         16  MQ-PAYEE-A1             PIC X(10).
  1008         16  MQ-PAYEE-SEQ-A1         PIC S9(4)       COMP.
  1009         16  MQ-CONTROL-NUMBER-A1    PIC S9(8)       COMP.
  1010         16  MQ-SEQUENCE-NUMBER-A1   PIC S9(4)       COMP.
  1011
  1012     12  MQ-ENTRY-TYPE               PIC X.
  1013             88  CHECK-ON-QUE           VALUE 'Q'.
  1014             88  ALIGNMENT-CHECK        VALUE 'A'.
  1015             88  SPOILED-CHECK          VALUE 'S'.
  1016             88  PAYMENT-ABORTED        VALUE 'X'.
  1017             88  ACH-PAYMENT            VALUE 'P'.
  1018
  1019     12  FILLER                      PIC X(10).
  1020
  1021     12  MQ-CREDIT-CHEK-CNTL.
  1022         16  MQ-CHEK-CSR             PIC X(4).
  1023         16  MQ-CHEK-CARRIER         PIC X.
  1024         16  MQ-CHEK-GROUPING        PIC X(6).
  1025         16  MQ-CHEK-PAYEE           PIC X(10).
  1026         16  MQ-CHEK-PAYEE-SEQ       PIC S9(4)       COMP.
  1027         16  MQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  1028
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6851.cbl
  1029     12  FILLER                      PIC X(10).
  1030
  1031     12  MQ-PAYEE-INFO.
  1032         16  MQ-PAYEE-NAME           PIC X(30).
  1033         16  MQ-PAYEE-ADDRESS-1      PIC X(30).
  1034         16  MQ-PAYEE-ADDRESS-2      PIC X(30).
  1035         16  MQ-PAYEE-CITY-ST        PIC X(30).
  1036         16  MQ-PAYEE-ZIP-CODE.
  1037             20  MQ-PAYEE-ZIP.
  1038                 24  FILLER          PIC X(1).
  1039                     88 MQ-PAYEE-CANADIAN-POST-CODE
  1040                                     VALUE 'A' THRU 'Z'.
  1041                 24  FILLER          PIC X(4).
  1042             20  MQ-PAYEE-ZIP-EXT    PIC X(4).
  1043         16  MQ-PAYEE-CANADIAN-POSTAL-CODES
  1044                 REDEFINES MQ-PAYEE-ZIP-CODE.
  1045             20  MQ-PAY-CAN-POSTAL-CD-1
  1046                                     PIC X(3).
  1047             20  MQ-PAY-CAN-POSTAL-CD-2
  1048                                     PIC X(3).
  1049             20  FILLER              PIC X(3).
  1050
  1051     12  MQ-CREDIT-PYAJ-CNTL.
  1052         16  MQ-PYAJ-CARRIER         PIC X.
  1053         16  MQ-PYAJ-GROUPING        PIC X(6).
  1054         16  MQ-PYAJ-FIN-RESP        PIC X(10).
  1055         16  FILLER                  PIC X(6).
  1056
  1057     12  MQ-CHECK-NUMBER             PIC X(6).
  1058     12  MQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  1059     12  MQ-NUMBER-OF-CK-STUBS       PIC S9(3)       COMP-3.
  1060     12  MQ-VOID-DT                  PIC XX.
  1061     12  MQ-TIMES-PRINTED            PIC S9(4)       COMP.
  1062     12  MQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  1063     12  MQ-CHECK-BY-USER            PIC X(4).
  1064     12  MQ-PRE-NUMBERING-SW         PIC X.
  1065       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  1066       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  1067
  1068     12  MQ-CHECK-WRITTEN-DT         PIC XX.
  1069     12  MQ-ACH-WRITTEN-DT REDEFINES  MQ-CHECK-WRITTEN-DT
  1070                                     PIC XX.
  1071     12  MQ-LAST-MAINT-BY            PIC X(4).
  1072     12  MQ-LAST-MAINT-HHMMSS        PIC S9(6)       COMP-3.
  1073     12  MQ-LAST-MAINT-DT            PIC XX.
  1074     12  MQ-CHECK-RELEASE-DT         PIC XX.
  1075     12  MQ-RECORD-TYPE              PIC X.
  1076         88  MQ-DETAIL                     VALUE 'D'.
  1077         88  MQ-TEXT                       VALUE 'T'.
  1078
  1079     12  MQ-DETAIL-INFORMATION.
  1080         16  MQ-DETAIL-INFO        OCCURS 15 TIMES.
  1081             20  MQ-CHECK-STUB-LINE.
  1082                 24  MQ-STUB-COMMENT        PIC X(23).
  1083                 24  MQ-ACCT-AGENT          PIC X(10).
  1084                 24  MQ-INVOICE             PIC X(6).
  1085                 24  MQ-REFERENCE           PIC X(12).
  1086                 24  MQ-LEDGER-NO           PIC X(14).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6851.cbl
  1087                 24  MQ-PYAJ-AMT            PIC S9(7)V99 COMP-3.
  1088                 24  MQ-PYAJ-REC-TYPE       PIC X.
  1089                 24  MQ-PYAJ-SEQ            PIC S9(8)    COMP.
  1090                 24  MQ-PAYMENT-TYPE        PIC X.
  1091                 24  MQ-PYAJ-PMT-APPLIED    PIC X.
  1092                 24  MQ-LAST-MAINT-APPLIED  PIC X.
  1093                 24  MQ-NON-AR-ITEM         PIC X.
  1094                 24  FILLER                 PIC X(19).
  1095
  1096     12  MQ-CHECK-STUB-TEXT REDEFINES MQ-DETAIL-INFORMATION.
  1097         16  MQ-CHECK-TEXT-ITEMS   OCCURS 3 TIMES.
  1098             20  MQ-STUB-TEXT        PIC X(70).
  1099         16  MQ-STUB-FILLER          PIC X(1260).
  1100
  1101     12  MQ-CREDIT-SELECT-DATE       PIC XX.
  1102     12  MQ-CREDIT-ACCEPT-DATE       PIC XX.
  1103
  1104     12  MQ-AR-STATEMENT-DT          PIC XX.
  1105     12  MQ-CO-TYPE                  PIC X.
  1106
  1107     12  MQ-STARTING-CHECK-NUMBER    PIC X(06).
  1108     12  FILLER                      PIC X(41).
  1109******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6851.cbl
  1111*                                COPY ERCPYAJ.
  1112******************************************************************
  1113*                                                                *
  1114*                            ERCPYAJ                             *
  1115*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1116*                            VMOD=2.015                          *
  1117*                                                                *
  1118*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  1119*                                                                *
  1120*                                                                *
  1121*   FILE TYPE = VSAM,KSDS                                        *
  1122*   RECORD SIZE = 200  RECFORM = FIXED                           *
  1123*                                                                *
  1124*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  1125*       ALTERNATE PATHS = NONE                                   *
  1126*                                                                *
  1127*   LOG = YES                                                    *
  1128*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1129******************************************************************
  1130******************************************************************
  1131*                   C H A N G E   L O G
  1132*
  1133* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1134*-----------------------------------------------------------------
  1135*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1136* EFFECTIVE    NUMBER
  1137*-----------------------------------------------------------------
  1138* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  1139* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  1140******************************************************************
  1141
  1142 01  PENDING-PAY-ADJ.
  1143     12  PY-RECORD-ID                     PIC XX.
  1144         88  VALID-PY-ID                        VALUE 'PY'.
  1145
  1146     12  PY-CONTROL-PRIMARY.
  1147         16  PY-COMPANY-CD                PIC X.
  1148         16  PY-CARRIER                   PIC X.
  1149         16  PY-GROUPING                  PIC X(6).
  1150         16  PY-FIN-RESP                  PIC X(10).
  1151         16  PY-ACCOUNT                   PIC X(10).
  1152         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  1153                                          PIC X(10).
  1154         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  1155         16  PY-RECORD-TYPE               PIC X.
  1156             88  PY-REMIT-RECEIVED            VALUE 'R'.
  1157             88  PY-DEPOSIT                   VALUE 'D'.
  1158             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  1159             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  1160             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  1161             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  1162             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  1163             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  1164             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  1165             88  PY-FICA-ENTRY                VALUE 'F'.
  1166             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  1167             88  PY-POLICY-FEE                VALUE 'W'.
  1168             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6851.cbl
  1169
  1170     12  PY-PYMT-TYPE                     PIC X.
  1171             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  1172             88  PY-REINS-PYMT                VALUE 'R'.
  1173             88  PY-EXP-PYMT                  VALUE 'E'.
  1174
  1175     12  PY-BIL-INV                       PIC X(6).
  1176     12  PY-REF-NO                        PIC X(12).
  1177
  1178     12  PY-LAST-MAINT-DT                 PIC XX.
  1179     12  PY-LAST-MAINT-BY                 PIC X(4).
  1180     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  1181
  1182     12  PY-PYADJ-RECORD.
  1183         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  1184         16  PY-ENTRY-COMMENT             PIC X(30).
  1185         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  1186             20  PY-GL-ACCOUNT            PIC X(10).
  1187             20  PY-GL-STATE              PIC X(02).
  1188             20  PY-GL-CANC-SW            PIC X(01).
  1189                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  1190                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  1191             20  PY-GL-COMMENT            PIC X(10).
  1192             20  FILLER      REDEFINES PY-GL-COMMENT.
  1193                 24  PY-GL-CHECK-NO       PIC 9(06).
  1194                 24  FILLER               PIC X(04).
  1195             20  FILLER                   PIC X(07).
  1196         16  PY-SAVE-ACCOUNT              PIC X(10).
  1197         16  PY-SAVE-TYPE                 PIC X(01).
  1198
  1199         16  PY-LETTERS.
  1200             20  PY-LETTER OCCURS 3 TIMES
  1201                           INDEXED BY PY-LET-NDX
  1202                                          PIC X(04).
  1203
  1204         16  PY-ERCOMP-TYPE               PIC X.
  1205             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  1206             88  PY-GA-TYPE                   VALUE 'G'.
  1207             88  PY-BANK-TYPE                 VALUE 'B'.
  1208         16  FILLER                       PIC X(05).
  1209
  1210     12  PY-RECORD-STATUS.
  1211         16  PY-CREDIT-SELECT-DT          PIC XX.
  1212         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  1213         16  PY-BILLED-DATE               PIC XX.
  1214         16  PY-REPORTED-DT               PIC XX.
  1215         16  PY-PMT-APPLIED               PIC X.
  1216             88  PY-ACCOUNT-PMT               VALUE 'A'.
  1217             88  PY-GA-PMT                    VALUE 'G'.
  1218             88  PY-OVWRITE-PMT               VALUE 'O'.
  1219             88  PY-NON-AR-PMT                VALUE 'N'.
  1220         16  FILLER                       PIC X(5).
  1221         16  PY-INPUT-DT                  PIC XX.
  1222         16  PY-CHECK-NUMBER              PIC X(6).
  1223         16  PY-VOID-SW                   PIC X.
  1224             88  PY-CHECK-VOIDED              VALUE 'V'.
  1225         16  PY-CHECK-ORIGIN-SW           PIC X.
  1226             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6851.cbl
  1227             88  PY-REFUND-CHECK              VALUE 'R'.
  1228             88  PY-GA-CHECK                  VALUE 'G'.
  1229             88  PY-CHECK-WRITTEN             VALUE 'W'.
  1230             88  PY-CHECK-REVERSAL            VALUE 'V'.
  1231         16  PY-CHECK-WRITTEN-DT          PIC XX.
  1232         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  1233         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  1234         16  PY-BILL-FLAG                 PIC X.
  1235             88  PY-BILLED                    VALUE 'B'.
  1236         16  PY-AR-FLAG                   PIC X.
  1237             88  PY-AR-CYCLE                  VALUE 'C'.
  1238             88  PY-AR-MONTH-END              VALUE 'M'.
  1239         16  PY-AR-DATE                   PIC XX.
  1240
  1241     12  PY-GL-CODES.
  1242         16  PY-GL-DB                     PIC X(14).
  1243         16  PY-GL-CR                     PIC X(14).
  1244         16  PY-GL-FLAG                   PIC X.
  1245         16  PY-GL-DATE                   PIC XX.
  1246
  1247     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  1248     12  FILLER                           PIC X(3).
  1249******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6851.cbl
  1251 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  1252                          COMMISSION-CHECK-QUE PENDING-PAY-ADJ.
  1253 0000-DFHEXIT SECTION.
  1254     MOVE '9#                    $   ' TO DFHEIV0.
  1255     MOVE 'EL6851' TO DFHEIV1.
  1256     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1257
  1258     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1259     MOVE '5'                   TO DC-OPTION-CODE.
  1260     PERFORM 9950-LINK-DATE-CONVERT THRU 9950-EXIT.
  1261     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1262     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1263     MOVE SPACES                TO DL34-PROCESS-TYPE
  1264
  1265     MOVE 80                     TO WS-LINE-LEN.
  1266*    MOVE 'N'                    TO CSO-PRINT-STARTED-SW.
  1267 0100-RETRIEVE-LOOP.
  1268
  1269* EXEC CICS HANDLE CONDITION
  1270*         ENDDATA (200-END-DATA)
  1271*         ENDFILE (4800-END-OF-FILE)
  1272*         NOTFND  (300-NOT-FOUND)
  1273*    END-EXEC.
  1274*    MOVE '"$&''I                 ! " #00001264' TO DFHEIV0
  1275     MOVE X'222426274920202020202020' TO DFHEIV0(1:12)
  1276     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1277     MOVE X'2220233030303031323634' TO DFHEIV0(25:11)
  1278     CALL 'kxdfhei1' USING DFHEIV0
  1279     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1280
  1281
  1282
  1283* EXEC CICS RETRIEVE
  1284*         INTO   (PROGRAM-INTERFACE-BLOCK)
  1285*         LENGTH (PI-COMM-LENGTH)
  1286*    END-EXEC.
  1287*    MOVE '0*I L                 &   #00001270' TO DFHEIV0
  1288     MOVE X'302A49204C20202020202020' TO DFHEIV0(1:12)
  1289     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1290     MOVE X'2020233030303031323730' TO DFHEIV0(25:11)
  1291     CALL 'kxdfhei1' USING DFHEIV0,
  1292           PROGRAM-INTERFACE-BLOCK,
  1293           PI-COMM-LENGTH,
  1294           DFHEIV99,
  1295           DFHEIV99,
  1296           DFHEIV99
  1297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1298
  1299
  1300* DLO034 OPEN WHEN DMD OR CID
  1301     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  1302         IF DL34-PROCESS-TYPE IS EQUAL TO SPACES
  1303             MOVE 'O'                TO DL34-PROCESS-TYPE
  1304             MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1305             MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1306             MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1307             MOVE SPACES             TO DL34-PRINT-LINE
  1308             MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6851.cbl
  1309
  1310
  1311* EXEC CICS LINK
  1312*                PROGRAM    ('DLO034')
  1313*                COMMAREA   (DLO034-COMMUNICATION-AREA)
  1314*                LENGTH     (DLO034-REC-LENGTH)
  1315*            END-EXEC
  1316     MOVE 'DLO034' TO DFHEIV1
  1317*    MOVE '."C                   ''   #00001285' TO DFHEIV0
  1318     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1319     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1320     MOVE X'2020233030303031323835' TO DFHEIV0(25:11)
  1321     CALL 'kxdfhei1' USING DFHEIV0,
  1322           DFHEIV1,
  1323           DLO034-COMMUNICATION-AREA,
  1324           DLO034-REC-LENGTH,
  1325           DFHEIV99,
  1326           DFHEIV99,
  1327           DFHEIV99
  1328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1329
  1330             IF DL34-RETURN-CODE NOT = 'OK'
  1331                 MOVE  '**DLO034 OPEN ERROR - ABORT**'
  1332                                     TO ERROR-LINE
  1333                 PERFORM 400-SEND-TEXT
  1334
  1335* EXEC CICS RETURN
  1336*                END-EXEC.
  1337*    MOVE '.(                    &   #00001295' TO DFHEIV0
  1338     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1339     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1340     MOVE X'2020233030303031323935' TO DFHEIV0(25:11)
  1341     CALL 'kxdfhei1' USING DFHEIV0,
  1342           DFHEIV99,
  1343           DFHEIV99,
  1344           DFHEIV99,
  1345           DFHEIV99,
  1346           DFHEIV99
  1347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1348
  1349
  1350*    MOVE PI-PROCESSOR-PRINTER TO CSO-PRINT-ID.
  1351*    MOVE 'F'                TO  DRS-SW.
  1352*    PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1353*    MOVE ' '                TO  DRS-SW.
  1354*
  1355     PERFORM 1000-INITIALIZE.
  1356
  1357     PERFORM 4000-BROWSE-CHECK-QUEUE-FILE.
  1358
  1359     MOVE SPACES                 TO TOTAL-LINE
  1360                                    TOTAL-LINE2.
  1361     MOVE 'CONTL TOTAL'          TO EL685A-CNTL-DESC
  1362                                    EL685B-CNTL-DESC.
  1363     MOVE PI-CONTROL-TOT         TO EL685A-CNTL-TOTAL
  1364                                    EL685B-CNTL-TOTAL.
  1365     MOVE 'NO. CHECKS '          TO EL685A-NO-CHECKS-DESC
  1366                                    EL685B-NO-CHECKS-DESC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6851.cbl
  1367     MOVE WS-NO-CHECKS           TO EL685A-NO-CHECKS
  1368                                    EL685B-NO-CHECKS.
  1369
  1370     IF (PI-CALLING-PROGRAM = 'EL686   '  AND
  1371          PI-PGM-PRINT-OPT = '5')         OR
  1372         PI-ORIG-CALL-AR-MENU
  1373         MOVE TOTAL-LINE2        TO WS-PASSED-DATA
  1374     ELSE
  1375         MOVE TOTAL-LINE         TO WS-PASSED-DATA.
  1376
  1377     MOVE ' '                    TO WS-PASSED-CNTL-CHAR.
  1378     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1379     PERFORM 3000-BUMP-LINE-COUNT.
  1380
  1381     MOVE PI-CONTROL-GRAND-TOT   TO EL685A-CNTL-TOTAL
  1382                                    EL685B-CNTL-TOTAL.
  1383     MOVE 'GRAND TOTAL'          TO EL685A-CNTL-DESC
  1384                                    EL685B-CNTL-DESC.
  1385     MOVE 'NO. CHECKS '          TO EL685A-NO-CHECKS-DESC
  1386                                    EL685B-NO-CHECKS-DESC.
  1387     MOVE PI-TOT-CHECKS          TO EL685A-NO-CHECKS
  1388                                    EL685B-NO-CHECKS.
  1389
  1390     IF (PI-CALLING-PROGRAM = 'EL686   '  AND
  1391          PI-PGM-PRINT-OPT = '5')         OR
  1392         PI-ORIG-CALL-AR-MENU
  1393         MOVE TOTAL-LINE2        TO WS-PASSED-DATA
  1394     ELSE
  1395         MOVE TOTAL-LINE         TO WS-PASSED-DATA.
  1396
  1397     MOVE '0'                    TO WS-PASSED-CNTL-CHAR.
  1398     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1399     MOVE 'X'                    TO WS-PROG-END.
  1400*    MOVE 'L'                    TO DRS-SW.
  1401*    MOVE SPACES                 TO WS-PASSED-DATA.
  1402*    MOVE SPACES                 TO WS-PASSED-CNTL-CHAR.
  1403     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1404     GO TO 0100-RETRIEVE-LOOP.
  1405
  1406 200-END-DATA.
  1407
  1408* DLO034 CLOSE
  1409     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  1410        IF DL34-PROCESS-TYPE NOT EQUAL TO SPACES
  1411             MOVE 'C'                TO DL34-PROCESS-TYPE
  1412             MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1413             MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1414             MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1415             MOVE SPACES             TO DL34-PRINT-LINE
  1416                                        DL34-OVERRIDE-PRINTER-ID
  1417
  1418* EXEC CICS LINK
  1419*                PROGRAM    ('DLO034')
  1420*                COMMAREA   (DLO034-COMMUNICATION-AREA)
  1421*                LENGTH     (DLO034-REC-LENGTH)
  1422*            END-EXEC
  1423     MOVE 'DLO034' TO DFHEIV1
  1424*    MOVE '."C                   ''   #00001365' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6851.cbl
  1425     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1426     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1427     MOVE X'2020233030303031333635' TO DFHEIV0(25:11)
  1428     CALL 'kxdfhei1' USING DFHEIV0,
  1429           DFHEIV1,
  1430           DLO034-COMMUNICATION-AREA,
  1431           DLO034-REC-LENGTH,
  1432           DFHEIV99,
  1433           DFHEIV99,
  1434           DFHEIV99
  1435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1436
  1437             IF DL34-RETURN-CODE NOT = 'OK'
  1438                 MOVE  '**DLO034 CLOSE ERROR - ABORT**'
  1439                                     TO ERROR-LINE
  1440                 PERFORM 400-SEND-TEXT.
  1441
  1442*    MOVE 'L'  TO  DRS-SW.
  1443*    PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1444
  1445* EXEC CICS RETURN
  1446*    END-EXEC.
  1447*    MOVE '.(                    &   #00001378' TO DFHEIV0
  1448     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  1449     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1450     MOVE X'2020233030303031333738' TO DFHEIV0(25:11)
  1451     CALL 'kxdfhei1' USING DFHEIV0,
  1452           DFHEIV99,
  1453           DFHEIV99,
  1454           DFHEIV99,
  1455           DFHEIV99,
  1456           DFHEIV99
  1457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1458
  1459
  1460 300-NOT-FOUND.
  1461     MOVE 'NO COMMUNICATION AREA FOUND' TO ERROR-LINE.
  1462     PERFORM 400-SEND-TEXT.
  1463     GO TO 200-END-DATA.
  1464
  1465 400-SEND-TEXT.
  1466
  1467* EXEC CICS SEND TEXT
  1468*         FROM   (ERROR-LINE)
  1469*         LENGTH (70)
  1470*    END-EXEC.
  1471     MOVE 70
  1472       TO DFHEIV11
  1473*    MOVE '8&      T       H   F -   #00001387' TO DFHEIV0
  1474     MOVE X'382620202020202054202020' TO DFHEIV0(1:12)
  1475     MOVE X'202020204820202046202D20' TO DFHEIV0(13:12)
  1476     MOVE X'2020233030303031333837' TO DFHEIV0(25:11)
  1477     CALL 'kxdfhei1' USING DFHEIV0,
  1478           ERROR-LINE,
  1479           DFHEIV11,
  1480           DFHEIV99,
  1481           DFHEIV99,
  1482           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6851.cbl
  1483           DFHEIV99,
  1484           DFHEIV99,
  1485           DFHEIV99,
  1486           DFHEIV99,
  1487           DFHEIV99,
  1488           DFHEIV99,
  1489           DFHEIV99
  1490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1491
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6851.cbl
  1493 1000-INITIALIZE    SECTION.
  1494
  1495*    NOTE *******************************************************
  1496*         *                                                     *
  1497*         *      INITALIZE THE WORK FIELDS FOR THE PROGRAM      *
  1498*         *  INTERFACE BLOCK FOR THIS MODULE.                   *
  1499*         *                                                     *
  1500*         *******************************************************.
  1501
  1502     IF PI-CALLING-PROGRAM = 'EL686   '
  1503         MOVE LOW-VALUES               TO  PI-CK-COMPANY-CODE
  1504         MOVE ZEROS                    TO  PI-CK-SEQUENCE-NO
  1505     ELSE
  1506         IF CHECKS-PRINTED
  1507             MOVE LOW-VALUES           TO  PI-CHECK-QUE-KEY
  1508             MOVE PI-START-CONTROL-NO  TO  PI-CK-CONTROL-NO
  1509         ELSE
  1510             MOVE LOW-VALUES           TO  PI-CHECK-QUE-KEY.
  1511
  1512     MOVE LOW-VALUES             TO  PI-PREV-CHECK-QUE-KEY.
  1513
  1514     MOVE ZEROS                  TO  PI-CONTROL-TOT
  1515                                     PI-CONTROL-SAVE-CONTROL
  1516                                     PI-CONTROL-GRAND-TOT
  1517                                     PI-TOT-CHECKS
  1518                                     WS-NO-CHECKS.
  1519
  1520     MOVE 1                      TO  PI-PAGE
  1521                                     PI-LINE-COUNT.
  1522
  1523     MOVE PI-COMPANY-CD          TO  PI-CK-COMPANY-CODE.
  1524     MOVE 'Y'                    TO  PI-FIRST-TIME-SWT.
  1525
  1526     MOVE EIBTIME                TO  WS-TIME-WORK.
  1527
  1528     MOVE SAVE-DATE              TO  ADATE.
  1529     MOVE WS-TIME                TO  ATIME.
  1530     MOVE PI-COMPANY-ID          TO  ACOMP.
  1531
  1532     PERFORM 2000-PRINT-HEADING.
  1533
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6851.cbl
  1535 2000-PRINT-HEADING   SECTION.
  1536
  1537     IF (PI-CALLING-PROGRAM = 'EL686   '  AND
  1538          PI-PGM-PRINT-OPT = '5')
  1539             MOVE WS-AR-CHECKS-RELEASED-DESC  TO ATITLEO
  1540             GO TO 2000-CONTINUE.
  1541
  1542     IF CHECKS-TO-BE-PRINTED
  1543         IF PI-ORIG-CALL-AR-MENU
  1544             MOVE WS-AR-TO-BE-PRINTED-DESC    TO ATITLEO
  1545         ELSE
  1546             MOVE WS-TO-BE-PRINTED-DESC       TO ATITLEO
  1547     ELSE
  1548         IF PI-ORIG-CALL-AR-MENU
  1549             MOVE WS-AR-CHECKS-PRINTED-DESC   TO ATITLEO
  1550         ELSE
  1551             MOVE WS-CHECKS-PRINTED-DESC      TO ATITLEO.
  1552
  1553 2000-CONTINUE.
  1554     MOVE PI-PAGE                TO PAGE-NO.
  1555     MOVE HEADING-1              TO WS-PASSED-DATA.
  1556     MOVE '1'                    TO WS-PASSED-CNTL-CHAR.
  1557     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1558     MOVE 1                      TO PI-LINE-COUNT.
  1559
  1560     IF PI-COMPANY-ID = 'LAP'  OR  'RMC'
  1561         MOVE ' ACCOUNT'         TO HD2-DESC-1
  1562         MOVE 'CERT NO.'         TO HD2-DESC-2.
  1563
  1564     IF (PI-CALLING-PROGRAM = 'EL686   '  AND
  1565          PI-PGM-PRINT-OPT = '5')         OR
  1566         PI-ORIG-CALL-AR-MENU
  1567     MOVE HEADING-2B             TO WS-PASSED-DATA
  1568     ELSE
  1569     MOVE HEADING-2              TO WS-PASSED-DATA.
  1570
  1571     MOVE '0'                    TO WS-PASSED-CNTL-CHAR.
  1572     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1573     ADD 2                       TO PI-LINE-COUNT.
  1574
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6851.cbl
  1576 3000-BUMP-LINE-COUNT   SECTION.
  1577     IF WS-PASSED-CNTL-CHAR = SPACES
  1578        ADD 1                    TO PI-LINE-COUNT
  1579       ELSE
  1580        ADD  2                   TO PI-LINE-COUNT.
  1581
  1582     IF PI-LINE-COUNT GREATER 60
  1583        MOVE ZEROS TO PI-LINE-COUNT
  1584        ADD 1   TO PI-PAGE
  1585        PERFORM 2000-PRINT-HEADING.
  1586
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6851.cbl
  1588
  1589 4000-BROWSE-CHECK-QUEUE-FILE SECTION.
  1590
  1591     IF (PI-CALLING-PROGRAM = 'EL686   '  AND
  1592          PI-PGM-PRINT-OPT = '5')         OR
  1593         PI-ORIG-CALL-AR-MENU
  1594              PERFORM 5000-BROWSE-COMM-CHECK-QUEUE
  1595              GO TO 4990-EXIT.
  1596
  1597
  1598* EXEC CICS STARTBR
  1599*        DATASET (WS-CHECK-QUEUE-DSID)
  1600*        RIDFLD  (PI-CHECK-QUE-KEY)
  1601*        GTEQ
  1602*    END-EXEC.
  1603     MOVE 0
  1604       TO DFHEIV11
  1605*    MOVE '&,         G          &   #00001496' TO DFHEIV0
  1606     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1607     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1608     MOVE X'2020233030303031343936' TO DFHEIV0(25:11)
  1609     CALL 'kxdfhei1' USING DFHEIV0,
  1610           WS-CHECK-QUEUE-DSID,
  1611           PI-CHECK-QUE-KEY,
  1612           DFHEIV99,
  1613           DFHEIV11,
  1614           DFHEIV99
  1615     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1616
  1617
  1618 4100-READNEXT.
  1619     MOVE PI-CHECK-QUE-KEY        TO  PI-PREV-CHECK-QUE-KEY.
  1620
  1621
  1622* EXEC CICS READNEXT
  1623*        DATASET (WS-CHECK-QUEUE-DSID)
  1624*        RIDFLD  (PI-CHECK-QUE-KEY)
  1625*        SET     (ADDRESS OF CHECK-QUE)
  1626*    END-EXEC.
  1627     MOVE 0
  1628       TO DFHEIV11
  1629*    MOVE '&.S                   )   #00001505' TO DFHEIV0
  1630     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1631     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1632     MOVE X'2020233030303031353035' TO DFHEIV0(25:11)
  1633     CALL 'kxdfhei1' USING DFHEIV0,
  1634           WS-CHECK-QUEUE-DSID,
  1635           DFHEIV20,
  1636           DFHEIV99,
  1637           PI-CHECK-QUE-KEY,
  1638           DFHEIV99,
  1639           DFHEIV11,
  1640           DFHEIV99,
  1641           DFHEIV99
  1642     SET ADDRESS OF CHECK-QUE TO
  1643         DFHEIV20
  1644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1645
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6851.cbl
  1646
  1647     IF CQ-COMPANY-CD NOT = PI-COMPANY-CD
  1648         GO TO 4800-END-OF-FILE.
  1649
  1650     IF CQ-ENTRY-TYPE NOT = 'Q'
  1651         GO TO 4100-READNEXT.
  1652
  1653     IF CQ-VOID-INDICATOR = 'V'
  1654         GO TO 4100-READNEXT.
  1655
  1656     IF CQ-CHECK-AMOUNT = ZEROS
  1657         GO TO 4100-READNEXT.
  1658
  1659     IF PI-CALLING-PROGRAM IS EQUAL TO 'EL686   '
  1660         IF PI-CONTROL-SAVE-CONTROL NOT EQUAL CQ-CONTROL-NUMBER
  1661             IF NOT PI-FIRST-TIME
  1662                 GO TO 4800-END-OF-FILE.
  1663
  1664     IF CQ-TIMES-PRINTED NOT = ZERO
  1665         IF CHECKS-PRINTED
  1666             NEXT SENTENCE
  1667         ELSE
  1668             GO TO 4100-READNEXT
  1669     ELSE
  1670         IF CHECKS-TO-BE-PRINTED
  1671             NEXT SENTENCE
  1672         ELSE
  1673             GO TO 4100-READNEXT.
  1674
  1675     IF PI-CONTROL-SAVE-CONTROL NOT = CQ-CONTROL-NUMBER
  1676        IF PI-FIRST-TIME
  1677           NEXT SENTENCE
  1678        ELSE
  1679           MOVE SPACES           TO  TOTAL-LINE
  1680           MOVE 'CONTL TOTAL'    TO EL685A-CNTL-DESC
  1681           MOVE PI-CONTROL-TOT   TO EL685A-CNTL-TOTAL
  1682           MOVE 'NO. CHECKS '    TO EL685A-NO-CHECKS-DESC
  1683           MOVE WS-NO-CHECKS     TO EL685A-NO-CHECKS
  1684           MOVE TOTAL-LINE       TO WS-PASSED-DATA
  1685           MOVE ' '              TO WS-PASSED-CNTL-CHAR
  1686           PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  1687           PERFORM 3000-BUMP-LINE-COUNT
  1688           MOVE SPACES           TO WS-PASSED-DATA
  1689           MOVE ' '              TO WS-PASSED-CNTL-CHAR
  1690           PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  1691           PERFORM 3000-BUMP-LINE-COUNT
  1692           MOVE ZEROS            TO PI-CONTROL-TOT
  1693                                    WS-NO-CHECKS.
  1694
  1695     MOVE CQ-CONTROL-NUMBER      TO PI-CONTROL-SAVE-CONTROL.
  1696     MOVE 'N'                    TO PI-FIRST-TIME-SWT.
  1697
  1698     ADD +1                      TO WS-NO-CHECKS
  1699                                    PI-TOT-CHECKS.
  1700     MOVE SPACES                 TO DETAIL-LINE.
  1701     ADD CQ-CHECK-AMOUNT         TO PI-CONTROL-TOT
  1702                                    PI-CONTROL-GRAND-TOT.
  1703     MOVE CQ-CONTROL-NUMBER      TO EL685A-CONTROL.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6851.cbl
  1704     MOVE CQ-CHECK-NUMBER        TO EL685A-CHECK-NO.
  1705
  1706     IF CQ-BILLING-CREDIT
  1707         MOVE 'BILL CREDIT'      TO EL685A-PMT-TYPE
  1708     ELSE
  1709         IF CQ-REFUND-PMT
  1710             MOVE 'REFUND PMT '  TO EL685A-PMT-TYPE
  1711         ELSE
  1712             MOVE 'CHECK MAINT'  TO EL685A-PMT-TYPE.
  1713
  1714     IF CQ-CHECK-MAINT-PMT OR CQ-REFUND-PMT
  1715         IF PI-COMPANY-ID = 'LAP'  OR  'RMC'
  1716             MOVE CQ-CHEK-CARRIER    TO  EL685A-CARRIER
  1717             MOVE CQ-CHEK-GROUPING   TO  EL685A-GROUP
  1718             MOVE CQ-CHEK-ACCOUNT    TO  EL685A-FIN-RESP
  1719             MOVE CQ-CHEK-CERT-NO    TO  EL685A-ACCOUNT
  1720         ELSE
  1721             MOVE CQ-CHEK-CARRIER    TO  EL685A-CARRIER
  1722             MOVE CQ-CHEK-GROUPING   TO  EL685A-GROUP
  1723             MOVE CQ-CHEK-FIN-RESP   TO  EL685A-FIN-RESP
  1724             MOVE CQ-CHEK-ACCOUNT    TO  EL685A-ACCOUNT
  1725     ELSE
  1726         MOVE CQ-PYAJ-CARRIER    TO  EL685A-CARRIER
  1727         MOVE CQ-PYAJ-GROUPING   TO  EL685A-GROUP
  1728         MOVE CQ-PYAJ-FIN-RESP   TO  EL685A-FIN-RESP
  1729         MOVE CQ-PYAJ-ACCOUNT    TO  EL685A-ACCOUNT.
  1730
  1731     MOVE CQ-CHECK-AMOUNT        TO  EL685A-AMT.
  1732     MOVE DETAIL-LINE            TO WS-PASSED-DATA.
  1733     MOVE ' '                    TO WS-PASSED-CNTL-CHAR.
  1734     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1735     PERFORM 3000-BUMP-LINE-COUNT.
  1736
  1737     GO TO 4100-READNEXT.
  1738
  1739 4800-END-OF-FILE.
  1740     IF PI-PREV-CHECK-QUE-KEY  = LOW-VALUES
  1741        GO TO 4990-EXIT.
  1742
  1743
  1744* EXEC CICS ENDBR
  1745*        DATASET (WS-CHECK-QUEUE-DSID)
  1746*    END-EXEC.
  1747     MOVE 0
  1748       TO DFHEIV11
  1749*    MOVE '&2                    $   #00001607' TO DFHEIV0
  1750     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1751     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1752     MOVE X'2020233030303031363037' TO DFHEIV0(25:11)
  1753     CALL 'kxdfhei1' USING DFHEIV0,
  1754           WS-CHECK-QUEUE-DSID,
  1755           DFHEIV11,
  1756           DFHEIV99
  1757     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1758
  1759
  1760 4990-EXIT.
  1761     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6851.cbl
  1763 5000-BROWSE-COMM-CHECK-QUEUE SECTION.
  1764
  1765
  1766* EXEC CICS STARTBR
  1767*        DATASET (WS-COMCK-QUEUE-DSID)
  1768*        RIDFLD  (PI-CHECK-QUE-KEY)
  1769*        GTEQ
  1770*    END-EXEC.
  1771     MOVE 0
  1772       TO DFHEIV11
  1773*    MOVE '&,         G          &   #00001616' TO DFHEIV0
  1774     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1775     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1776     MOVE X'2020233030303031363136' TO DFHEIV0(25:11)
  1777     CALL 'kxdfhei1' USING DFHEIV0,
  1778           WS-COMCK-QUEUE-DSID,
  1779           PI-CHECK-QUE-KEY,
  1780           DFHEIV99,
  1781           DFHEIV11,
  1782           DFHEIV99
  1783     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1784
  1785
  1786
  1787* EXEC CICS HANDLE CONDITION
  1788*         ENDFILE (5800-END-OF-FILE)
  1789*    END-EXEC.
  1790*    MOVE '"$''                   ! # #00001622' TO DFHEIV0
  1791     MOVE X'222427202020202020202020' TO DFHEIV0(1:12)
  1792     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1793     MOVE X'2320233030303031363232' TO DFHEIV0(25:11)
  1794     CALL 'kxdfhei1' USING DFHEIV0
  1795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1796
  1797
  1798 5100-READNEXT.
  1799     MOVE PI-CHECK-QUE-KEY        TO  PI-PREV-CHECK-QUE-KEY.
  1800
  1801
  1802* EXEC CICS READNEXT
  1803*        DATASET (WS-COMCK-QUEUE-DSID)
  1804*        RIDFLD  (PI-CHECK-QUE-KEY)
  1805*        SET     (ADDRESS OF COMMISSION-CHECK-QUE)
  1806*    END-EXEC.
  1807     MOVE 0
  1808       TO DFHEIV11
  1809*    MOVE '&.S                   )   #00001629' TO DFHEIV0
  1810     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1811     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1812     MOVE X'2020233030303031363239' TO DFHEIV0(25:11)
  1813     CALL 'kxdfhei1' USING DFHEIV0,
  1814           WS-COMCK-QUEUE-DSID,
  1815           DFHEIV20,
  1816           DFHEIV99,
  1817           PI-CHECK-QUE-KEY,
  1818           DFHEIV99,
  1819           DFHEIV11,
  1820           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6851.cbl
  1821           DFHEIV99
  1822     SET ADDRESS OF COMMISSION-CHECK-QUE TO
  1823         DFHEIV20
  1824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1825
  1826
  1827     IF MQ-COMPANY-CD NOT = PI-COMPANY-CD
  1828         GO TO 5800-END-OF-FILE.
  1829
  1830     IF MQ-TEXT
  1831         GO TO 5100-READNEXT.
  1832
  1833     IF MQ-ENTRY-TYPE NOT = 'Q'
  1834         GO TO 5100-READNEXT.
  1835
  1836     IF MQ-VOID-DT NOT = LOW-VALUES
  1837         GO TO 5100-READNEXT.
  1838
  1839     IF PI-CALLING-PROGRAM IS EQUAL TO 'EL686   '
  1840         IF PI-CONTROL-SAVE-CONTROL NOT EQUAL MQ-CONTROL-NUMBER
  1841             IF NOT PI-FIRST-TIME
  1842                 GO TO 5800-END-OF-FILE.
  1843
  1844     IF PI-CALLING-PROGRAM = 'EL686   '   AND
  1845          PI-PGM-PRINT-OPT = '5'          AND
  1846          MQ-TIMES-PRINTED NOT = ZERO
  1847            GO TO 5100-READNEXT.
  1848
  1849     IF MQ-TIMES-PRINTED NOT = ZERO
  1850         IF CHECKS-PRINTED
  1851            NEXT SENTENCE
  1852         ELSE
  1853            GO TO 5100-READNEXT
  1854     ELSE
  1855         IF CHECKS-TO-BE-PRINTED
  1856            NEXT SENTENCE
  1857         ELSE
  1858            GO TO 5100-READNEXT.
  1859
  1860     IF PI-CONTROL-SAVE-CONTROL NOT = MQ-CONTROL-NUMBER
  1861        IF PI-FIRST-TIME
  1862           NEXT SENTENCE
  1863        ELSE
  1864           MOVE SPACES           TO  TOTAL-LINE2
  1865           MOVE 'CONTL TOTAL'    TO EL685B-CNTL-DESC
  1866           MOVE PI-CONTROL-TOT   TO EL685B-CNTL-TOTAL
  1867           MOVE 'NO. CHECKS '    TO EL685B-NO-CHECKS-DESC
  1868           MOVE WS-NO-CHECKS     TO EL685B-NO-CHECKS
  1869           MOVE TOTAL-LINE2      TO WS-PASSED-DATA
  1870           MOVE ' '              TO WS-PASSED-CNTL-CHAR
  1871           PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  1872           PERFORM 3000-BUMP-LINE-COUNT
  1873           MOVE SPACES           TO WS-PASSED-DATA
  1874           MOVE ' '              TO WS-PASSED-CNTL-CHAR
  1875           PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  1876           PERFORM 3000-BUMP-LINE-COUNT
  1877           MOVE ZEROS            TO PI-CONTROL-TOT
  1878                                    WS-NO-CHECKS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6851.cbl
  1879
  1880     MOVE MQ-CONTROL-NUMBER      TO PI-CONTROL-SAVE-CONTROL.
  1881     MOVE 'N'                    TO PI-FIRST-TIME-SWT.
  1882
  1883     ADD +1                      TO WS-NO-CHECKS
  1884                                    PI-TOT-CHECKS.
  1885     MOVE SPACES                 TO DETAIL-LINE.
  1886     ADD MQ-CHECK-AMOUNT         TO PI-CONTROL-TOT
  1887                                    PI-CONTROL-GRAND-TOT.
  1888     MOVE MQ-CONTROL-NUMBER      TO EL685B-CONTROL.
  1889     MOVE MQ-CHECK-NUMBER        TO EL685B-CHECK-NO.
  1890     MOVE MQ-CHECK-AMOUNT        TO  EL685B-AMT.
  1891     MOVE MQ-CHEK-CARRIER        TO  EL685B-CARRIER.
  1892     MOVE MQ-CHEK-GROUPING       TO  EL685B-GROUP.
  1893     MOVE MQ-CHEK-PAYEE          TO  EL685B-PAYEE.
  1894     MOVE MQ-PAYEE-NAME          TO  EL685B-PAYEE-NA.
  1895     MOVE MQ-PAYEE-SEQ-A1        TO  EL685B-PAYEE-SEQ.
  1896
  1897     MOVE MQ-CHECK-WRITTEN-DT    TO  DC-BIN-DATE-1.
  1898     MOVE ' '                    TO  DC-OPTION-CODE.
  1899     PERFORM 9950-LINK-DATE-CONVERT THRU 9950-EXIT.
  1900     MOVE DC-GREG-DATE-1-EDIT    TO  EL685B-CHK-DT.
  1901
  1902     MOVE DETAIL-LINEB           TO WS-PASSED-DATA.
  1903     MOVE ' '                    TO WS-PASSED-CNTL-CHAR.
  1904     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  1905     PERFORM 3000-BUMP-LINE-COUNT
  1906
  1907     GO TO 5100-READNEXT.
  1908
  1909 5800-END-OF-FILE.
  1910     IF PI-PREV-CHECK-QUE-KEY  = LOW-VALUES
  1911        GO TO 5990-EXIT.
  1912
  1913
  1914* EXEC CICS ENDBR
  1915*        DATASET (WS-COMCK-QUEUE-DSID) END-EXEC.
  1916     MOVE 0
  1917       TO DFHEIV11
  1918*    MOVE '&2                    $   #00001721' TO DFHEIV0
  1919     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1920     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1921     MOVE X'2020233030303031373231' TO DFHEIV0(25:11)
  1922     CALL 'kxdfhei1' USING DFHEIV0,
  1923           WS-COMCK-QUEUE-DSID,
  1924           DFHEIV11,
  1925           DFHEIV99
  1926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1927
  1928
  1929 5990-EXIT.
  1930     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6851.cbl
  1932 9500-PRINT-ROUTINE SECTION.
  1933*                             COPY ELPRTCVP.
  1934******************************************************************
  1935***                                                              *
  1936***                          ELPRTCVP.                           *
  1937***                          VMOD=2.003                          *
  1938***                                                              *
  1939***     COPY MEMBER FOR TERMINAL ONLINE PRINT ROUTINE.           *
  1940***     THIS ROUTINE WILL ACCOMODATE PRINTING TO A 3270          *
  1941***     TERMINAL PRINTER. A BUFFER OF UP TO 1920 CHARACTERS      *
  1942***     IS ACCUMULATED AND PRINTED COLLECTIVELY.                 *
  1943***                                                              *
  1944***     THIS ROUTINE TO BE USED ONLY WITH ACCOMPANIMENT          *
  1945***      OF THE WORKING-STORAGE COPY MEMBER ( ELPRTCVD )         *
  1946***     THE HOST PROGRAM MUST INITIALIZE THE FOLLOWING 3 FIELDS  *
  1947***      FROM THE ABOVE COPY MEMBER FOR THIS PROCEDURE TO BE     *
  1948***      SUCCESSFUL.                                             *
  1949***      05  WS-LINE-LEN    PIC  S9(4)  COMP  VALUE +80.         *
  1950***                         LENGTH OF THE LINE TO BE PRINTED     *
  1951***                         DEFAULT IS 80, YOU CAN USE ANY NUMBER*
  1952***                         UP TO 132.  THIS FIELD IS ONLY ACCEP-*
  1953***                         TED THE FIRST TIME THRU THE ROUTINE. *
  1954***      05  WS-PROG-END    PIC  X  VALUE SPACES.                *
  1955***                         PROGRAM END SWITCH. INITIALIZED      *
  1956***                         TO SPACE-     MOVE IN ANY NONBLANK   *
  1957***                         TO IT WHEN PROGRAM IS FINISHED.      *
  1958***      05  WS-PRINT-AREA.                                      *
  1959***          10  WS-PASSED-CNTL-CHAR     PIC X.                  *
  1960***          10  WS-PASSED-DATA          PIC X(132).             *
  1961***                         USE THE DATA TO BE PRINTED IN THE    *
  1962***                         WS-PASSED-DATA.                      *
  1963***                         USE THE STANDARD CARRIAGE CONTROL    *
  1964***                         CHARACTER IN THE WS-PASSED-CNTL-CHAR *
  1965***                           SINGLE-SPACE            VALUE ' '  *
  1966***                           DOUBLE-SPACE            VALUE '0'  *
  1967***                           TRIPLE-SPACE            VALUE '-'  *
  1968***                           TOP-PAGE                VALUE '1'  *
  1969***      NOTE: A LINE COUNT IS PROVIDED IN FIELDNAME -WS-LINE-CNT*
  1970***            THE USE OF THIS FIELD IS OPTIONAL.                *
  1971***            THIS ROUTINE WILL ONLY ADD 1, 2, OR 3             *
  1972***            TO THIS COUNT DEPENDING ON THE WS-PASSED-CNTL-CHAR*
  1973***            AND RESET THE COUNT TO ZERO WHEN TOP-PAGE         *
  1974***            CONDITION.                                        *
  1975***                                                              *
  1976******************************************************************
  1977
  1978 ELPRTCVP.
  1979
  1980*    IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'CID'
  1981     IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'XXX'
  1982         MOVE 'P'                TO DL34-PROCESS-TYPE
  1983         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  1984         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  1985         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  1986         MOVE WS-PRINT-AREA      TO DL34-PRINT-LINE
  1987         MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
  1988
  1989
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6851.cbl
  1990* EXEC CICS LINK
  1991*            PROGRAM    ('DLO034')
  1992*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  1993*            LENGTH     (DLO034-REC-LENGTH)
  1994*        END-EXEC
  1995     MOVE 'DLO034' TO DFHEIV1
  1996*    MOVE '."C                   ''   #00001784' TO DFHEIV0
  1997     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1998     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1999     MOVE X'2020233030303031373834' TO DFHEIV0(25:11)
  2000     CALL 'kxdfhei1' USING DFHEIV0,
  2001           DFHEIV1,
  2002           DLO034-COMMUNICATION-AREA,
  2003           DLO034-REC-LENGTH,
  2004           DFHEIV99,
  2005           DFHEIV99,
  2006           DFHEIV99
  2007     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2008
  2009            IF DL34-RETURN-CODE = 'OK'
  2010                GO TO ELPRTCVP-EXIT
  2011            ELSE
  2012*               MOVE '8339'     TO EMI-ERROR ?????ERROR MESSAGE???
  2013                GO TO ELPRTCVP-EXIT.
  2014
  2015     IF NOT FIRST-TIME
  2016         GO TO ELPRTCVP-020.
  2017
  2018     IF WS-LINE-LEN NOT GREATER ZERO
  2019         GO TO ELPRTCVP-EXIT.
  2020
  2021     MOVE '2'                    TO WS-FIRST-TIME-SW.
  2022     MOVE LOW-VALUES             TO WS-BUFFER-AREA.
  2023
  2024     SET BUFFER-INDEX TO +1
  2025
  2026     IF EIBTRMID IS EQUAL TO 'AFLP'
  2027         NEXT SENTENCE
  2028     ELSE
  2029         IF NOT TOP-PAGE
  2030             MOVE T-TP           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2031             SET BUFFER-INDEX UP BY +1.
  2032
  2033 ELPRTCVP-020.
  2034     IF WS-PROG-END = SPACES
  2035         GO TO ELPRTCVP-030.
  2036
  2037     MOVE SPACES                 TO WS-PROG-END.
  2038
  2039     IF BUFFER-INDEX GREATER +1
  2040         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  2041
  2042     MOVE '1'                    TO WS-FIRST-TIME-SW.
  2043
  2044     GO TO ELPRTCVP-EXIT.
  2045
  2046 ELPRTCVP-030.
  2047     IF WS-PASSED-DATA = SPACES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6851.cbl
  2048         SET PRT-INDEX TO +1
  2049         GO TO ELPRTCVP-050.
  2050
  2051     SET PRT-INDEX TO WS-LINE-LEN.
  2052
  2053 ELPRTCVP-040.
  2054     IF WS-PRINT-BYTE (PRT-INDEX) NOT = SPACES
  2055         GO TO ELPRTCVP-050.
  2056
  2057     IF PRT-INDEX GREATER +1
  2058         SET PRT-INDEX DOWN BY +1
  2059         GO TO ELPRTCVP-040.
  2060
  2061 ELPRTCVP-050.
  2062     SET WS-LINE-LENGTH TO PRT-INDEX.
  2063     SET BUFFER-INDEX2 TO BUFFER-INDEX.
  2064     SET BUFFER-INDEX2 UP BY WS-LINE-LENGTH.
  2065
  2066     IF BUFFER-INDEX2 NOT LESS WS-BUFFER-SIZE
  2067         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  2068
  2069     IF TRIPLE-SPACE
  2070          ADD +2  TO  WS-LINE-CNT
  2071          MOVE T-SS           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2072                                 WS-BUFFER-BYTE (BUFFER-INDEX + 1)
  2073          SET BUFFER-INDEX UP BY +2.
  2074
  2075     IF DOUBLE-SPACE
  2076          ADD +1  TO  WS-LINE-CNT
  2077          MOVE T-SS             TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2078          SET BUFFER-INDEX UP BY +1.
  2079
  2080     ADD +1 TO WS-LINE-CNT
  2081************************************************************
  2082*     BYPASS NEW LINE SYMBOL                               *
  2083*        IF FIRST BUFFER SENT AND TOP-OF-FORM SET.         *
  2084*     OR IF FIRST LINE OF SUBSEQUENT BUFFERS.              *
  2085************************************************************
  2086
  2087     IF (BUFFER-INDEX GREATER +1 AND
  2088         WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-TP)  OR
  2089         FIRST-LINE-NEXT-BUFFER
  2090         MOVE ZERO               TO WS-FIRST-TIME-SW
  2091     ELSE
  2092         MOVE T-SS               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2093         SET BUFFER-INDEX UP BY +1.
  2094
  2095**   NOTE, SINGLE SPACE IS REQUIRED BEFORE TOP PAGE CHAR
  2096
  2097     IF TOP-PAGE
  2098         MOVE +1                TO WS-LINE-CNT
  2099         MOVE T-TP              TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2100         SET BUFFER-INDEX UP BY +1.
  2101
  2102     SET PRT-INDEX TO +1.
  2103
  2104 ELPRTCVP-060.
  2105     MOVE WS-PRINT-BYTE (PRT-INDEX)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6851.cbl
  2106                                 TO WS-BUFFER-BYTE (BUFFER-INDEX).
  2107     SET BUFFER-INDEX UP BY +1.
  2108
  2109     IF PRT-INDEX LESS WS-LINE-LENGTH
  2110         SET PRT-INDEX UP BY +1
  2111         GO TO ELPRTCVP-060.
  2112
  2113 ELPRTCVP-EXIT.
  2114     EXIT.
  2115
  2116 ELPRTCVP-PRINT-BUFFER.
  2117     IF WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-SS
  2118        MOVE SPACE               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  2119        SET BUFFER-INDEX UP BY 1.
  2120
  2121     MOVE  T-EM                  TO  WS-BUFFER-BYTE (BUFFER-INDEX)
  2122     SET WS-BUFFER-LENGTH TO BUFFER-INDEX.
  2123
  2124
  2125* EXEC CICS SEND
  2126*        FROM    (WS-BUFFER-AREA)
  2127*        LENGTH  (WS-BUFFER-LENGTH)
  2128*        CTLCHAR (WS-WCC-CNTL)
  2129*        ERASE
  2130*    END-EXEC.
  2131*    MOVE '$$    C E         L F ,   #00001905' TO DFHEIV0
  2132     MOVE X'242420202020432045202020' TO DFHEIV0(1:12)
  2133     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
  2134     MOVE X'2020233030303031393035' TO DFHEIV0(25:11)
  2135     CALL 'kxdfhei1' USING DFHEIV0,
  2136           WS-BUFFER-AREA,
  2137           WS-BUFFER-LENGTH,
  2138           DFHEIV99,
  2139           DFHEIV99,
  2140           WS-WCC-CNTL,
  2141           DFHEIV99,
  2142           DFHEIV99,
  2143           DFHEIV99,
  2144           DFHEIV99,
  2145           DFHEIV99,
  2146           DFHEIV99
  2147     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2148
  2149
  2150     SET BUFFER-INDEX TO +1.
  2151     MOVE '2'                    TO WS-FIRST-TIME-SW.
  2152
  2153 ELPRTCVP-PRINT-EXIT.
  2154     EXIT.
  2155
  2156
  2157
  2158 9900-LAST-PARAGRAPH SECTION.
  2159
  2160* GOBACK.
  2161     MOVE '9%                    "   ' TO DFHEIV0
  2162     MOVE 'EL6851' TO DFHEIV1
  2163     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6851.cbl
  2164     GOBACK.
  2165
  2166 9950-LINK-DATE-CONVERT.
  2167
  2168
  2169* EXEC CICS LINK
  2170*        PROGRAM    ('ELDATCV')
  2171*        COMMAREA   (DATE-CONVERSION-DATA)
  2172*        LENGTH     (DC-COMM-LENGTH)
  2173*        END-EXEC.
  2174     MOVE 'ELDATCV' TO DFHEIV1
  2175*    MOVE '."C                   ''   #00001925' TO DFHEIV0
  2176     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2177     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2178     MOVE X'2020233030303031393235' TO DFHEIV0(25:11)
  2179     CALL 'kxdfhei1' USING DFHEIV0,
  2180           DFHEIV1,
  2181           DATE-CONVERSION-DATA,
  2182           DC-COMM-LENGTH,
  2183           DFHEIV99,
  2184           DFHEIV99,
  2185           DFHEIV99
  2186     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2187
  2188 9950-EXIT.
  2189     EXIT.
  2190
  2191
  2192 9999-DFHBACK SECTION.
  2193     MOVE '9%                    "   ' TO DFHEIV0
  2194     MOVE 'EL6851' TO DFHEIV1
  2195     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2196     GOBACK.
  2197 9999-DFHEXIT.
  2198     IF DFHEIGDJ EQUAL 0001
  2199         NEXT SENTENCE
  2200     ELSE IF DFHEIGDJ EQUAL 2
  2201         GO TO 200-END-DATA,
  2202               4800-END-OF-FILE,
  2203               300-NOT-FOUND
  2204         DEPENDING ON DFHEIGDI
  2205     ELSE IF DFHEIGDJ EQUAL 3
  2206         GO TO 5800-END-OF-FILE
  2207         DEPENDING ON DFHEIGDI.
  2208     MOVE '9%                    "   ' TO DFHEIV0
  2209     MOVE 'EL6851' TO DFHEIV1
  2210     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2211     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5296     Code:        5770
