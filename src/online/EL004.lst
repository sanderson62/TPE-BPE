* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL004.cbl
* Options: int("EL004.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL004.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL004.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL004.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL004.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:23:08.
     7*                            VMOD=2.004
     8*
     9*
    10*AUTHOR.           LOGIC,INC.
    11*                  DALLAS,TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL004.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.  COMMON ABEND ROUTINE.
    25*        THIS PROGRAM IS LINK'D TO WHENEVER AN ERROR OCCURS THAT
    26*        IS NOT CONTROLLED THROUGH A HANDLE CONDITION.
    27
    28
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL004.cbl
    30 ENVIRONMENT DIVISION.
    31
    32 DATA DIVISION.
    33
    34 WORKING-STORAGE SECTION.
    35 01  DFH-START PIC X(04).
    36
    37 77  FILLER  PIC X(32)  VALUE '********************************'.
    38 77  FILLER  PIC X(32)  VALUE '*    EL004 WORKING STORAGE     *'.
    39 77  FILLER  PIC X(32)  VALUE '********* V/M 2.004 ************'.
    40
    41 77  WS-DUMP-SW    COMP-3        PIC S9              VALUE ZERO.
    42 77  WS-INDEX      COMP-3        PIC S9(3)           VALUE ZERO.
    43 77  WS-INDEX2     COMP-3        PIC S9(3)           VALUE ZERO.
    44
    45 01  TERMINAL-MESSAGE.
    46     05  TM-SBA                  PIC X.
    47     05  TM-FADDR                PIC XX.
    48     05  TM-SF                   PIC X.
    49     05  TM-ATTRB                PIC X.
    50     05  TM-MESG                 PIC X(72)   VALUE SPACES.
    51     05  FILLER REDEFINES TM-MESG.
    52         10  TMR1-A              PIC X(19).
    53         10  TMR1-B              PIC X(53).
    54     05  FILLER REDEFINES TM-MESG.
    55         10  TMR2-A              PIC X(9).
    56         10  TMR2-B              PIC X(10).
    57         10  TMR2-C              PIC X(53).
    58     05  FILLER REDEFINES TM-MESG.
    59         10  FILLER              PIC X(68).
    60         10  TMR3-A              PIC X(4).
    61
    62     05  FILLER                  PIC X               VALUE SPACES.
    63
    64     05  TM-EIBFN                PIC X(4)            VALUE SPACES.
    65     05  TM-EIBFN-CHAR           REDEFINES
    66         TM-EIBFN                PIC X           OCCURS 4 TIMES.
    67
    68     05  FILLER                  PIC X               VALUE SPACES.
    69
    70     05  TM-EIBRCODE             PIC X(12)           VALUE SPACES.
    71     05  TM-EIBRCODE-CHAR        REDEFINES
    72         TM-EIBRCODE             PIC X           OCCURS 12 TIMES.
    73
    74
    75 01  EIB-BREAK-DOWN.
    76     05  EBD-FN.
    77         10  EBD-FN1             PIC X.
    78         10  EBD-FN2             PIC X.
    79     05  EIBFN-CHAR              REDEFINES
    80         EBD-FN                  PIC X    OCCURS 2 TIMES.
    81
    82     05  EBD-RCODE.
    83         10  EBD-RC1             PIC X.
    84         10  EBD-RC2A.
    85             15  EBD-RC2         PIC X.
    86             15  EBD-RC3         PIC X.
    87             15  EBD-RC4         PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL004.cbl
    88             15  EBD-RC5         PIC X.
    89             15  EBD-RC6         PIC X.
    90*
    91     05  EIBRCODE-CHAR           REDEFINES
    92         EBD-RCODE               PIC X    OCCURS 6 TIMES.
    93
    94     05  WS-NUMBER                   PIC S9(4)       VALUE ZERO
    95                                     COMP.
    96
    97     05  FILLER                      REDEFINES
    98         WS-NUMBER.
    99         10  FILLER                  PIC X.
   100         10  WS-CHAR                 PIC X.
   101
   102     05  WS-REMAINDER                PIC S9(3)       VALUE ZERO
   103                                     COMP-3.
   104
   105     05  WS-HEX-VALUES               PIC X(15)       VALUE
   106         '123456789ABCDEF'.
   107
   108     05  WS-HEX-CHAR                 REDEFINES
   109         WS-HEX-VALUES               PIC X
   110         OCCURS 15 TIMES.
   111
   112     05  WS-CHARACTERS               PIC X(10)       VALUE SPACES.
   113     05  WS-CHARACTER                REDEFINES
   114         WS-CHARACTERS               PIC X
   115         OCCURS 10 TIMES.
   116
   117     05  WS-ZONE                     PIC X
   118         OCCURS 10 TIMES.
   119
   120     05  WS-DIGIT                    PIC X
   121         OCCURS 10 TIMES.
   122
   123 01  HEX-BREAK-DOWN.
   124     05  HEX-BD                  PIC 9(4)    COMP VALUE ZEROS.
   125     05  HEX-1  REDEFINES HEX-BD.
   126         10  FILLER              PIC X.
   127         10  HEX-NBR             PIC X.
   128
   129 01  HEX-NX                      PIC XX      VALUE '*0'.
   130*    HEX-NX IS FOR LINE 24
   131
   132 01  HEX-L21                     PIC XX      VALUE 'R '.
   133*    HEX-L21 IS FOR LINE 21
   134
   135 01  SAVE-DS                     PIC X(8).
   136
   137 01  WORK-EIB                    PIC X(80).
   138
   139 01  FILLER  REDEFINES  WORK-EIB.
   140     05  FILLER                  PIC S9(7)   COMP-3.
   141     05  FILLER                  PIC S9(7)   COMP-3.
   142     05  FILLER                  PIC X(4).
   143     05  FILLER                  PIC S9(7)   COMP-3.
   144     05  FILLER                  PIC X(4).
   145     05  FILLER                  PIC S9(4)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL004.cbl
   146     05  FILLER                  PIC S9(4)   COMP.
   147     05  FILLER                  PIC S9(4)   COMP.
   148     05  FILLER                  PIC XX.
   149     05  W-EIBFN                 PIC XX.
   150     05  FILLER                  PIC XX.
   151     05  W-EIBRCODE              PIC X(6).
   152     05  FILLER                  PIC XX.
   153     05  W-EIBDS                 PIC X(8).
   154     05  W-EIBREQID              PIC X(8).
   155     05  W-EIBRSRCE              PIC X(8).
   156
   157****************************************************************
   158*
   159* Copyright (c) 2007 by Clerity Solutions, Inc.
   160* All rights reserved.
   161*
   162****************************************************************
   163 01  DFHEIV.
   164   02  DFHEIV0               PIC X(35).
   165   02  DFHEIV1               PIC X(08).
   166   02  DFHEIV2               PIC X(08).
   167   02  DFHEIV3               PIC X(08).
   168   02  DFHEIV4               PIC X(06).
   169   02  DFHEIV5               PIC X(04).
   170   02  DFHEIV6               PIC X(04).
   171   02  DFHEIV7               PIC X(02).
   172   02  DFHEIV8               PIC X(02).
   173   02  DFHEIV9               PIC X(01).
   174   02  DFHEIV10              PIC S9(7) COMP-3.
   175   02  DFHEIV11              PIC S9(4) COMP SYNC.
   176   02  DFHEIV12              PIC S9(4) COMP SYNC.
   177   02  DFHEIV13              PIC S9(4) COMP SYNC.
   178   02  DFHEIV14              PIC S9(4) COMP SYNC.
   179   02  DFHEIV15              PIC S9(4) COMP SYNC.
   180   02  DFHEIV16              PIC S9(9) COMP SYNC.
   181   02  DFHEIV17              PIC X(04).
   182   02  DFHEIV18              PIC X(04).
   183   02  DFHEIV19              PIC X(04).
   184   02  DFHEIV20              USAGE IS POINTER.
   185   02  DFHEIV21              USAGE IS POINTER.
   186   02  DFHEIV22              USAGE IS POINTER.
   187   02  DFHEIV23              USAGE IS POINTER.
   188   02  DFHEIV24              USAGE IS POINTER.
   189   02  DFHEIV25              PIC S9(9) COMP SYNC.
   190   02  DFHEIV26              PIC S9(9) COMP SYNC.
   191   02  DFHEIV27              PIC S9(9) COMP SYNC.
   192   02  DFHEIV28              PIC S9(9) COMP SYNC.
   193   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
   194   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
   195   02  FILLER                PIC X(02).
   196   02  DFHEIV99              PIC X(08) VALUE SPACE.
   197   02  DFHEIVL0              PIC X(48) VALUE SPACE.
   198   02  DFHEIVL1              PIC X(48) VALUE SPACE.
   199   02  DFHEIVL2              PIC X(48) VALUE SPACE.
   200   02  DFHEIVL3              PIC X(48) VALUE SPACE.
   201 LINKAGE  SECTION.
   202*****************************************************************
   203*                                                               *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL004.cbl
   204* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
   205* All rights reserved.                                          *
   206*                                                               *
   207*****************************************************************
   208 01  dfheiblk.
   209     02  eibtime          pic s9(7) comp-3.
   210     02  eibdate          pic s9(7) comp-3.
   211     02  eibtrnid         pic x(4).
   212     02  eibtaskn         pic s9(7) comp-3.
   213     02  eibtrmid         pic x(4).
   214     02  dfheigdi         pic s9(4) comp.
   215     02  eibcposn         pic s9(4) comp.
   216     02  eibcalen         pic s9(4) comp.
   217     02  eibaid           pic x(1).
   218     02  eibfiller1       pic x(1).
   219     02  eibfn            pic x(2).
   220     02  eibfiller2       pic x(2).
   221     02  eibrcode         pic x(6).
   222     02  eibfiller3       pic x(2).
   223     02  eibds            pic x(8).
   224     02  eibreqid         pic x(8).
   225     02  eibrsrce         pic x(8).
   226     02  eibsync          pic x(1).
   227     02  eibfree          pic x(1).
   228     02  eibrecv          pic x(1).
   229     02  eibsend          pic x(1).
   230     02  eibatt           pic x(1).
   231     02  eibeoc           pic x(1).
   232     02  eibfmh           pic x(1).
   233     02  eibcompl         pic x(1).
   234     02  eibsig           pic x(1).
   235     02  eibconf          pic x(1).
   236     02  eiberr           pic x(1).
   237     02  eibrldbk         pic x(1).
   238     02  eiberrcd         pic x(4).
   239     02  eibsynrb         pic x(1).
   240     02  eibnodat         pic x(1).
   241     02  eibfiller5       pic x(2).
   242     02  eibresp          pic 9(09) comp.
   243     02  eibresp2         pic 9(09) comp.
   244     02  dfheigdj         pic s9(4) comp.
   245     02  dfheigdk         pic s9(4) comp.
   246
   247 01  DFHCOMMAREA                 PIC X(72).
   248
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL004.cbl
   250 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
   251 0000-DFHEXIT SECTION.
   252     MOVE '9#                    $   ' TO DFHEIV0.
   253     MOVE 'EL004' TO DFHEIV1.
   254     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
   255
   256 000-MAIN-LOGIC SECTION.
   257
   258 000-MLS-10-NOTES.
   259*
   260*    THIS SECTION CONTROLS ALL OTHER SECTIONS
   261*
   262*    CHECK EIBFN CODES TO PERFORM CORRECT
   263*    OPERATION
   264*
   265     MOVE DFHCOMMAREA            TO WORK-EIB.
   266     MOVE W-EIBFN                TO EBD-FN
   267                                 WS-CHARACTERS.
   268
   269     PERFORM 1000-CONVERT-HEX-CHARACTERS
   270         VARYING WS-INDEX FROM +1 BY +1
   271             UNTIL WS-INDEX GREATER THAN +2.
   272
   273     MOVE WS-ZONE (1)            TO  TM-EIBFN-CHAR (1).
   274     MOVE WS-DIGIT (1)           TO  TM-EIBFN-CHAR (2).
   275     MOVE WS-ZONE (2)            TO  TM-EIBFN-CHAR (3).
   276     MOVE WS-DIGIT (2)           TO  TM-EIBFN-CHAR (4).
   277
   278     MOVE W-EIBRCODE             TO EBD-RCODE
   279                                 WS-CHARACTERS.
   280
   281     PERFORM 1000-CONVERT-HEX-CHARACTERS
   282         VARYING WS-INDEX FROM +1 BY +1
   283             UNTIL WS-INDEX GREATER THAN +6.
   284
   285     MOVE WS-ZONE  (1)           TO  TM-EIBRCODE-CHAR (1).
   286     MOVE WS-DIGIT (1)           TO  TM-EIBRCODE-CHAR (2).
   287     MOVE WS-ZONE  (2)           TO  TM-EIBRCODE-CHAR (3).
   288     MOVE WS-DIGIT (2)           TO  TM-EIBRCODE-CHAR (4).
   289     MOVE WS-ZONE  (3)           TO  TM-EIBRCODE-CHAR (5).
   290     MOVE WS-DIGIT (3)           TO  TM-EIBRCODE-CHAR (6).
   291     MOVE WS-ZONE  (4)           TO  TM-EIBRCODE-CHAR (7).
   292     MOVE WS-DIGIT (4)           TO  TM-EIBRCODE-CHAR (8).
   293     MOVE WS-ZONE  (5)           TO  TM-EIBRCODE-CHAR (9).
   294     MOVE WS-DIGIT (5)           TO  TM-EIBRCODE-CHAR (10).
   295     MOVE WS-ZONE  (6)           TO  TM-EIBRCODE-CHAR (11).
   296     MOVE WS-DIGIT (6)           TO  TM-EIBRCODE-CHAR (12).
   297
   298     MOVE W-EIBDS                TO SAVE-DS.
   299     MOVE DFHEIBLK               TO WORK-EIB.
   300
   301     MOVE 02 TO HEX-BD.
   302     IF HEX-NBR = EBD-FN1
   303         PERFORM 100-CICS-ERROR
   304         GO TO 000-MLS-100.
   305
   306     MOVE 04 TO HEX-BD.
   307     IF HEX-NBR = EBD-FN1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL004.cbl
   308         PERFORM 125-ISSUE
   309         GO TO 000-MLS-100.
   310
   311     MOVE 06 TO HEX-BD.
   312     IF HEX-NBR = EBD-FN1
   313         PERFORM 150-FILE
   314         GO TO 000-MLS-100.
   315
   316     MOVE 08 TO HEX-BD.
   317     IF HEX-NBR = EBD-FN1
   318         PERFORM 175-TD
   319         GO TO 000-MLS-100.
   320
   321     MOVE 10 TO HEX-BD.
   322     IF HEX-NBR = EBD-FN1
   323         PERFORM 200-TS
   324         GO TO 000-MLS-100.
   325
   326     MOVE 12 TO HEX-BD.
   327     IF HEX-NBR = EBD-FN1
   328         PERFORM 225-CORE
   329         GO TO 000-MLS-100.
   330
   331     MOVE 14 TO HEX-BD.
   332     IF HEX-NBR = EBD-FN1
   333         PERFORM 250-ABEND
   334         GO TO 000-MLS-100.
   335
   336     MOVE 16 TO HEX-BD.
   337     IF HEX-NBR = EBD-FN1
   338         PERFORM 275-POST
   339         GO TO 000-MLS-100.
   340
   341     MOVE 18 TO HEX-BD.
   342     IF HEX-NBR = EBD-FN1
   343         PERFORM 300-ENQ
   344         GO TO 000-MLS-100.
   345
   346     MOVE 20 TO HEX-BD.
   347     IF HEX-NBR = EBD-FN1
   348         PERFORM 325-JOURNAL
   349         GO TO 000-MLS-100.
   350
   351     MOVE 24 TO HEX-BD.
   352     IF HEX-NBR = EBD-FN1
   353         PERFORM 350-MAP
   354         GO TO 000-MLS-100.
   355
   356     MOVE 30 TO HEX-BD.
   357     IF HEX-NBR = EBD-FN1
   358         PERFORM 375-ISS-QUERY
   359         GO TO 000-MLS-100.
   360
   361     MOVE 'UNDETERMINED ERROR' TO TM-MESG.
   362
   363 000-MLS-100.
   364     MOVE 17                     TO HEX-BD.
   365     MOVE HEX-NBR                TO TM-SBA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL004.cbl
   366*    MOVE HEX-NX                 TO HEX-1.
   367     MOVE HEX-L21                TO HEX-1.
   368     MOVE HEX-1                  TO TM-FADDR.
   369     MOVE 29                     TO HEX-BD.
   370     MOVE HEX-NBR                TO TM-SF.
   371     MOVE '8'                    TO TM-ATTRB.
   372
   373     MOVE EIBTRMID               TO TMR3-A.
   374
   375
   376* EXEC CICS WRITEQ TD
   377*         QUEUE   ('CSMT')
   378*         FROM    (TM-MESG)
   379*         LENGTH  (90)
   380*         END-EXEC.
   381     MOVE 90
   382       TO DFHEIV11
   383     MOVE 'CSMT' TO DFHEIV5
   384*    MOVE '(" L                  &   #00000371' TO DFHEIV0
   385     MOVE X'2822204C2020202020202020' TO DFHEIV0(1:12)
   386     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   387     MOVE X'2020233030303030333731' TO DFHEIV0(25:11)
   388     CALL 'kxdfhei1' USING DFHEIV0,
   389           DFHEIV5,
   390           TM-MESG,
   391           DFHEIV11,
   392           DFHEIV99,
   393           DFHEIV99
   394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   395
   396
   397
   398* EXEC CICS SYNCPOINT
   399*         ROLLBACK
   400*    END-EXEC.
   401*    MOVE '6"R                   !   #00000377' TO DFHEIV0
   402     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
   403     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
   404     MOVE X'2020233030303030333737' TO DFHEIV0(25:11)
   405     CALL 'kxdfhei1' USING DFHEIV0
   406     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   407
   408
   409     MOVE W-EIBFN                TO EBD-FN.
   410     MOVE 14                     TO HEX-BD.
   411     IF HEX-NBR = EBD-FN1
   412        PERFORM 050-CK-SEND.
   413
   414
   415* EXEC CICS SEND
   416*        FROM   (TERMINAL-MESSAGE)
   417*        LENGTH (77) END-EXEC.
   418     MOVE 77
   419       TO DFHEIV11
   420*    MOVE '$$                L F ,   #00000386' TO DFHEIV0
   421     MOVE X'242420202020202020202020' TO DFHEIV0(1:12)
   422     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
   423     MOVE X'2020233030303030333836' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL004.cbl
   424     CALL 'kxdfhei1' USING DFHEIV0,
   425           TERMINAL-MESSAGE,
   426           DFHEIV11,
   427           DFHEIV99,
   428           DFHEIV99,
   429           DFHEIV99,
   430           DFHEIV99,
   431           DFHEIV99,
   432           DFHEIV99,
   433           DFHEIV99,
   434           DFHEIV99,
   435           DFHEIV99
   436     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   437
   438
   439*    IF WS-DUMP-SW NOT = ZERO
   440*        EXEC CICS DUMP
   441*            DUMPCODE  ('LGXX') TASK END-EXEC.
   442
   443
   444* EXEC CICS RETURN END-EXEC.
   445*    MOVE '.(                    &   #00000394' TO DFHEIV0
   446     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
   447     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   448     MOVE X'2020233030303030333934' TO DFHEIV0(25:11)
   449     CALL 'kxdfhei1' USING DFHEIV0,
   450           DFHEIV99,
   451           DFHEIV99,
   452           DFHEIV99,
   453           DFHEIV99,
   454           DFHEIV99
   455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   456
   457
   458* GOBACK.
   459     MOVE '9%                    "   ' TO DFHEIV0
   460     MOVE 'EL004' TO DFHEIV1
   461     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
   462     GOBACK.
   463
   464 000-MLS-900-EXIT.
   465     EXIT.
   466
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL004.cbl
   468 050-CK-SEND SECTION.
   469
   470 050-CKS-10-NOTES.
   471     MOVE 02                     TO HEX-BD.
   472
   473*    IF WS-DUMP-SW NOT = ZERO
   474*        MOVE ZERO               TO WS-DUMP-SW
   475*        EXEC CICS DUMP DUMPCODE('LGXX') TASK END-EXEC.
   476
   477     IF HEX-NBR = EBD-FN2
   478        MOVE TM-MESG             TO DFHCOMMAREA
   479
   480* EXEC CICS RETURN END-EXEC.
   481*    MOVE '.(                    &   #00000412' TO DFHEIV0
   482     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
   483     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
   484     MOVE X'2020233030303030343132' TO DFHEIV0(25:11)
   485     CALL 'kxdfhei1' USING DFHEIV0,
   486           DFHEIV99,
   487           DFHEIV99,
   488           DFHEIV99,
   489           DFHEIV99,
   490           DFHEIV99
   491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
   492
   493
   494 050-CKS-900-EXIT.
   495     EXIT.
   496
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL004.cbl
   498 100-CICS-ERROR SECTION.
   499
   500 100-CES-10-NOTES.
   501*
   502*    THIS SECTION HANDLES THE ADDRESS OR ASSIGN ERROR
   503*
   504     MOVE 'INVREQ FOR ADDRESS ASSIGN OR HANDLE CONDITION'
   505         TO TM-MESG.
   506
   507 100-CES-900-EXIT.
   508     EXIT.
   509
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL004.cbl
   511 125-ISSUE SECTION.
   512
   513 125-ISS-10-NOTES.
   514
   515*
   516*    THIS SECTION HANDLES CLASS 04 ERRORS
   517*
   518     MOVE 02                     TO HEX-BD.
   519     IF HEX-NBR = EBD-FN2
   520         MOVE 'RECEIVE'          TO TMR1-A.
   521
   522     MOVE 04                     TO HEX-BD.
   523     IF HEX-NBR = EBD-FN2
   524         MOVE 'SEND'             TO TMR1-A.
   525
   526     MOVE 06                     TO HEX-BD.
   527     IF HEX-NBR = EBD-FN2
   528         MOVE 'CONVERSE'         TO TMR1-A.
   529
   530     MOVE 08                     TO HEX-BD.
   531     IF HEX-NBR = EBD-FN2
   532         MOVE 'ISSUE EODS'       TO TMR1-A.
   533
   534     MOVE 10                     TO HEX-BD.
   535     IF HEX-NBR = EBD-FN2
   536         MOVE 'ISSUE COPY'       TO TMR1-A.
   537
   538     MOVE 12                     TO HEX-BD.
   539     IF HEX-NBR = EBD-FN2
   540         MOVE 'WAIT TERMINAL'    TO TMR1-A.
   541
   542     MOVE 14                     TO HEX-BD.
   543     IF HEX-NBR = EBD-FN2
   544         MOVE 'ISSUE LOAD'       TO TMR1-A.
   545
   546     MOVE 16                     TO HEX-BD.
   547     IF HEX-NBR = EBD-FN2
   548         MOVE 'WAIT SIGNAL'      TO TMR1-A.
   549
   550     MOVE 18                     TO HEX-BD.
   551     IF HEX-NBR = EBD-FN2
   552         MOVE 'ISSUE RESET'      TO TMR1-A.
   553
   554     MOVE 20                     TO HEX-BD.
   555     IF HEX-NBR = EBD-FN2
   556         MOVE 'ISSUE DISCONNECT' TO TMR1-A.
   557
   558     MOVE 22                     TO HEX-BD.
   559     IF HEX-NBR = EBD-FN2
   560         MOVE 'ISSUE ENDOUTPUT'  TO TMR1-A.
   561
   562     MOVE 24                     TO HEX-BD.
   563     IF HEX-NBR = EBD-FN2
   564         MOVE 'ISSUE ERASEAUP'   TO TMR1-A.
   565
   566     MOVE 26                     TO HEX-BD.
   567     IF HEX-NBR = EBD-FN2
   568         MOVE 'ISSUE ENDFILE'    TO TMR1-A.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL004.cbl
   569
   570     MOVE 28                     TO HEX-BD.
   571     IF HEX-NBR = EBD-FN2
   572         MOVE 'ISSUE PRINT'      TO TMR1-A.
   573
   574     MOVE 04                     TO HEX-BD.
   575     IF HEX-NBR = EBD-RC1
   576         MOVE 'EOF ERROR'        TO TMR1-B.
   577
   578     MOVE 16                     TO HEX-BD.
   579     IF HEX-NBR = EBD-RC1
   580         MOVE 'EODS ERROR'       TO TMR1-B.
   581
   582     MOVE 193                    TO HEX-BD.
   583     IF HEX-NBR = EBD-RC1
   584         MOVE 'EOF ERROR'        TO TMR1-B.
   585
   586     MOVE 194                    TO HEX-BD.
   587     IF HEX-NBR = EBD-RC1
   588         MOVE 'ENDINPT'          TO TMR1-B.
   589
   590     MOVE 225                    TO HEX-BD.
   591     IF HEX-NBR = EBD-RC1
   592         MOVE 'LENGERR'          TO TMR1-B.
   593
   594     MOVE 227                    TO HEX-BD.
   595     IF HEX-NBR = EBD-RC1
   596         MOVE 'WRBRK ERROR'      TO TMR1-B.
   597
   598     MOVE 228                    TO HEX-BD.
   599     IF HEX-NBR = EBD-RC1
   600         MOVE 'RDATT ERROR'      TO TMR1-B.
   601
   602     MOVE 229                    TO HEX-BD.
   603     IF HEX-NBR = EBD-RC1
   604         MOVE 'SIGNAL ERROR'     TO TMR1-B.
   605
   606     MOVE 230                    TO HEX-BD.
   607     IF HEX-NBR = EBD-RC1
   608         MOVE 'TERMIDERR'        TO TMR1-B.
   609
   610     MOVE 231                    TO HEX-BD.
   611     IF HEX-NBR = EBD-RC1
   612         MOVE 'NOPASSBKRD'       TO TMR1-B.
   613
   614     MOVE 232                    TO HEX-BD.
   615     IF HEX-NBR = EBD-RC1
   616         MOVE 'NOPASSBKWR'       TO TMR1-B.
   617
   618     MOVE 32                     TO HEX-BD.
   619     IF HEX-NBR = EBD-RC1
   620         MOVE 'EOC ERROR'        TO TMR1-B.
   621
   622     MOVE 64                     TO HEX-BD.
   623     IF HEX-NBR = EBD-RC1
   624         MOVE 'INBFMH ERROR'     TO TMR1-B.
   625
   626     MOVE 246                    TO HEX-BD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL004.cbl
   627     IF HEX-NBR = EBD-RC1
   628         MOVE 'NOSTART ERROR'    TO TMR1-B.
   629
   630     MOVE 247                    TO HEX-BD.
   631     IF HEX-NBR = EBD-RC1
   632         MOVE 'NONVAL ERROR'     TO TMR1-B.
   633
   634 125-ISS-900-EXIT.
   635
   636     EXIT.
   637
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL004.cbl
   639 150-FILE SECTION.
   640
   641 150-FLE-10-NOTES.
   642*
   643*    THIS SECTION HANDLES FILE ERRORS
   644*
   645     MOVE SAVE-DS                TO TMR2-A.
   646
   647     MOVE 02                     TO HEX-BD.
   648     IF HEX-NBR = EBD-FN2 MOVE 'READ' TO TMR2-B.
   649
   650     MOVE 04                     TO HEX-BD.
   651     IF HEX-NBR = EBD-FN2 MOVE 'WRITE' TO TMR2-B.
   652
   653     MOVE 06                     TO HEX-BD.
   654     IF HEX-NBR = EBD-FN2 MOVE 'REWRITE' TO TMR2-B.
   655
   656     MOVE 08                     TO HEX-BD.
   657     IF HEX-NBR = EBD-FN2 MOVE 'DELETE' TO TMR2-B.
   658
   659     MOVE 10                     TO HEX-BD.
   660     IF HEX-NBR = EBD-FN2 MOVE 'UNLOCK' TO TMR2-B.
   661
   662     MOVE 12                     TO HEX-BD.
   663     IF HEX-NBR = EBD-FN2 MOVE 'STARTBR' TO TMR2-B.
   664
   665     MOVE 14                     TO HEX-BD.
   666     IF HEX-NBR = EBD-FN2 MOVE 'READNEXT' TO TMR2-B.
   667
   668     MOVE 16                     TO HEX-BD.
   669     IF HEX-NBR = EBD-FN2 MOVE 'READPREV' TO TMR2-B.
   670
   671     MOVE 18                     TO HEX-BD.
   672     IF HEX-NBR = EBD-FN2 MOVE 'ENDBR' TO TMR2-B.
   673
   674     MOVE 20                     TO HEX-BD.
   675     IF HEX-NBR = EBD-FN2 MOVE 'RESETBR' TO TMR2-B.
   676
   677     MOVE 01                     TO HEX-BD.
   678     IF HEX-NBR = EBD-RC1 MOVE 'DSIDERR' TO TMR2-C.
   679
   680     MOVE 02                     TO HEX-BD.
   681     IF HEX-NBR = EBD-RC1 MOVE 'ILLOGIC' TO TMR2-C.
   682
   683     MOVE 04                     TO HEX-BD.
   684     IF HEX-NBR = EBD-RC1 MOVE 'SEGIDERR' TO TMR2-C.
   685
   686     MOVE 08                     TO HEX-BD.
   687     IF HEX-NBR = EBD-RC1 MOVE 'INVREQ'  TO TMR2-C.
   688
   689     MOVE 12                     TO HEX-BD.
   690     IF HEX-NBR = EBD-RC1 MOVE 'NOTOPEN' TO TMR2-C
   691        GO TO 150-FLE-900-EXIT.
   692
   693     MOVE 13                     TO HEX-BD.
   694     IF HEX-NBR = EBD-RC1 MOVE 'DISABLED' TO TMR2-C
   695        GO TO 150-FLE-900-EXIT.
   696
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL004.cbl
   697     MOVE 15                     TO HEX-BD.
   698     IF HEX-NBR = EBD-RC1 MOVE 'ENDFILE' TO TMR2-C.
   699
   700     MOVE 128                    TO HEX-BD.
   701     IF HEX-NBR = EBD-RC1 MOVE 'IOERR'   TO TMR2-C.
   702
   703     MOVE 129                    TO HEX-BD.
   704     IF HEX-NBR = EBD-RC1 MOVE 'NOTFND'  TO TMR2-C.
   705
   706     MOVE 130                    TO HEX-BD.
   707     IF HEX-NBR = EBD-RC1 MOVE 'DUPREC'  TO TMR2-C.
   708
   709     MOVE 131                    TO HEX-BD.
   710     IF HEX-NBR = EBD-RC1 MOVE 'NOSPACE' TO TMR2-C.
   711
   712     MOVE 132                    TO HEX-BD.
   713     IF HEX-NBR = EBD-RC1 MOVE 'DUPREC'  TO TMR2-C.
   714
   715     MOVE 208                    TO HEX-BD.
   716     IF HEX-NBR = EBD-RC1 MOVE 'SYSIDERR' TO TMR2-C.
   717
   718     MOVE 209                    TO HEX-BD.
   719     IF HEX-NBR = EBD-RC1 MOVE 'ISCINVREQ' TO TMR2-C.
   720
   721     MOVE 225                    TO HEX-BD.
   722     IF HEX-NBR = EBD-RC1 MOVE 'LENGERR' TO TMR2-C.
   723
   724     MOVE +1                     TO  WS-DUMP-SW.
   725
   726 150-FLE-900-EXIT.
   727     EXIT.
   728
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL004.cbl
   730 175-TD SECTION.
   731
   732 175-TD-10-NOTES.
   733*
   734*    THIS SECTION HANDLES TRANSIENT DATA ERRORS
   735*
   736     MOVE 02                     TO HEX-BD.
   737     IF HEX-NBR = EBD-FN2 MOVE 'WRITEQ TD' TO TMR1-A.
   738     MOVE 04                     TO HEX-BD.
   739     IF HEX-NBR = EBD-FN2 MOVE 'READQ TD' TO TMR1-A.
   740
   741     MOVE 06                     TO HEX-BD.
   742     IF HEX-NBR = EBD-FN2 MOVE 'DELETEQ TD' TO TMR1-A.
   743
   744     MOVE 01                     TO HEX-BD.
   745     IF HEX-NBR = EBD-RC1 MOVE 'QZERO' TO TMR1-B.
   746
   747     MOVE 02                     TO HEX-BD.
   748     IF HEX-NBR = EBD-RC1 MOVE 'QIDERR' TO TMR1-B.
   749
   750     MOVE 04                     TO HEX-BD.
   751     IF HEX-NBR = EBD-RC1 MOVE 'IOERR' TO TMR1-B.
   752
   753     MOVE 08                     TO HEX-BD.
   754     IF HEX-NBR = EBD-RC1 MOVE 'NOTOPEN' TO TMR1-B.
   755
   756     MOVE 16                     TO HEX-BD.
   757     IF HEX-NBR = EBD-RC1 MOVE 'NOSPACE' TO TMR1-B.
   758
   759     MOVE 192                    TO HEX-BD.
   760     IF HEX-NBR = EBD-RC1 MOVE 'QBUSY' TO TMR1-B.
   761
   762     MOVE 208                    TO HEX-BD.
   763     IF HEX-NBR = EBD-RC1 MOVE 'SYSIDERR' TO TMR1-B.
   764
   765     MOVE 209                    TO HEX-BD.
   766     IF HEX-NBR = EBD-RC1 MOVE 'ISCINVREQ' TO TMR1-B.
   767
   768     MOVE 225                    TO HEX-BD.
   769     IF HEX-NBR = EBD-RC1 MOVE 'LENGERR' TO TMR1-B.
   770
   771 175-TDS-900-EXIT.
   772     EXIT.
   773
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL004.cbl
   775 200-TS SECTION.
   776
   777 200-TSS-10-NOTES.
   778*
   779*    THIS SECTION HANDLES TEMP STORAGE
   780*
   781     MOVE 02                     TO HEX-BD.
   782     IF HEX-NBR = EBD-FN2 MOVE 'WRITEQ TS' TO TMR1-A.
   783
   784     MOVE 04                     TO HEX-BD.
   785     IF HEX-NBR = EBD-FN2 MOVE 'READQ TS' TO TMR1-A.
   786
   787     MOVE 06                     TO HEX-BD.
   788     IF HEX-NBR = EBD-FN2 MOVE 'DELETEQ TS' TO TMR1-A.
   789
   790     MOVE 01                     TO HEX-BD.
   791     IF HEX-NBR = EBD-RC1 MOVE 'ITEMERR' TO TMR1-B.
   792
   793     MOVE 02                     TO HEX-BD.
   794     IF HEX-NBR = EBD-RC1 MOVE 'QIDERR'  TO TMR1-B.
   795
   796     MOVE 04                     TO HEX-BD.
   797     IF HEX-NBR = EBD-RC1 MOVE 'IOERR'   TO TMR1-B.
   798
   799     MOVE 08                     TO HEX-BD.
   800     IF HEX-NBR = EBD-RC1 MOVE 'NOSPACE' TO TMR1-B.
   801
   802     MOVE 32                     TO HEX-BD.
   803     IF HEX-NBR = EBD-RC1 MOVE 'INVREQ'  TO TMR1-B.
   804
   805     MOVE 208                    TO HEX-BD.
   806     IF HEX-NBR = EBD-RC1 MOVE 'SYSIDERR' TO TMR1-B.
   807
   808     MOVE 209                    TO HEX-BD.
   809     IF HEX-NBR = EBD-RC1 MOVE 'ISCINVREQ' TO TMR1-B.
   810
   811     MOVE 225                    TO HEX-BD.
   812     IF HEX-NBR = EBD-RC1 MOVE 'LENGERR' TO TMR1-B.
   813
   814 200-TSS-900-EXIT.
   815     EXIT.
   816
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL004.cbl
   818 225-CORE SECTION.
   819
   820 225-CES-10-NOTES.
   821*
   822*    THIS SECTION HANDLES GETMAIN AND FREEMAIN
   823*
   824     MOVE 02                     TO HEX-BD.
   825     IF HEX-NBR = EBD-FN2 MOVE 'GETMAIN' TO TMR1-A.
   826
   827     MOVE 04                     TO HEX-BD.
   828     IF HEX-NBR = EBD-FN2 MOVE 'FREEMAIN' TO TMR1-A.
   829
   830     MOVE 226                    TO HEX-BD.
   831     IF HEX-NBR = EBD-RC1 MOVE 'NOSTG  ' TO TMR1-B.
   832
   833 225-CDS-900-EXIT.
   834     EXIT.
   835
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL004.cbl
   837 250-ABEND SECTION.
   838
   839 250-ABS-10-NOTES.
   840*
   841*    THIS SECTION HANDLES ABEND CODES
   842*
   843     MOVE 02                     TO HEX-BD.
   844     IF HEX-NBR = EBD-FN2 MOVE 'LINK' TO TMR1-A
   845     MOVE W-EIBRSRCE TO TMR2-B.
   846
   847     MOVE 04                     TO HEX-BD.
   848     IF HEX-NBR = EBD-FN2 MOVE 'XCTL' TO TMR1-A.
   849
   850     MOVE 06                     TO HEX-BD.
   851     IF HEX-NBR = EBD-FN2 MOVE 'LOAD' TO TMR1-A.
   852
   853     MOVE 08                     TO HEX-BD.
   854     IF HEX-NBR = EBD-FN2 MOVE 'RETURN' TO TMR1-A.
   855
   856     MOVE 10                     TO HEX-BD.
   857     IF HEX-NBR = EBD-FN2 MOVE 'RELEASE' TO TMR1-A.
   858
   859     MOVE 12                     TO HEX-BD.
   860     IF HEX-NBR = EBD-FN2 MOVE 'ABEND' TO TMR1-A.
   861
   862     MOVE 14                     TO HEX-BD.
   863     IF HEX-NBR = EBD-FN2 MOVE 'HANDLE ABEND' TO TMR1-A.
   864
   865     MOVE 01                     TO HEX-BD.
   866     IF HEX-NBR = EBD-RC1 MOVE 'PGMIDERR' TO TMR1-B.
   867
   868     MOVE 214                    TO HEX-BD.
   869     IF HEX-NBR = EBD-RC1 MOVE 'NOTAUTH ' TO TMR1-B.
   870
   871     MOVE 224                    TO HEX-BD.
   872     IF HEX-NBR = EBD-RC1 MOVE 'INVREQ' TO TMR1-B.
   873
   874 250-ABS-900-EXIT.
   875     EXIT.
   876
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL004.cbl
   878 275-POST SECTION.
   879
   880 275-PTS-10-NOTES.
   881*
   882*    THIS SECTION HANDLES TIME RELATED CONDITIONS
   883*
   884     MOVE 02                     TO HEX-BD.
   885     IF HEX-NBR = EBD-FN2 MOVE 'ASKTIME' TO TMR1-A.
   886
   887     MOVE 04                     TO HEX-BD.
   888     IF HEX-NBR = EBD-FN2 MOVE 'DELAY' TO TMR1-A.
   889
   890     MOVE 06                     TO HEX-BD.
   891     IF HEX-NBR = EBD-FN2 MOVE 'POST' TO TMR1-A.
   892
   893     MOVE 08                     TO HEX-BD.
   894     IF HEX-NBR = EBD-FN2 MOVE 'START' TO TMR1-A.
   895
   896     MOVE 10                     TO HEX-BD.
   897     IF HEX-NBR = EBD-FN2 MOVE 'RETRIEVE' TO TMR1-A.
   898
   899     MOVE 12                     TO HEX-BD.
   900     IF HEX-NBR = EBD-FN2 MOVE 'CANCEL'  TO TMR1-A.
   901
   902     MOVE 01                     TO HEX-BD.
   903     IF HEX-NBR = EBD-RC1 MOVE 'ENDDATA' TO TMR1-B.
   904
   905     MOVE 04                     TO HEX-BD.
   906     IF HEX-NBR = EBD-RC1 MOVE 'IOERR'   TO TMR1-B.
   907
   908     MOVE 17                     TO HEX-BD.
   909     IF HEX-NBR = EBD-RC1 MOVE 'TRANSIDERR' TO TMR1-B.
   910
   911     MOVE 18                     TO HEX-BD.
   912     IF HEX-NBR = EBD-RC1 MOVE 'TERMIDERR' TO TMR1-B.
   913
   914     MOVE 20                     TO HEX-BD.
   915     IF HEX-NBR = EBD-RC1 MOVE 'INVTSREQ' TO TMR1-B.
   916
   917     MOVE 32                     TO HEX-BD.
   918     IF HEX-NBR = EBD-RC1 MOVE 'EXPIRED' TO TMR1-B.
   919
   920     MOVE 129                    TO HEX-BD.
   921     IF HEX-NBR = EBD-RC1 MOVE 'NOTFND'  TO TMR1-B.
   922
   923     MOVE 208                    TO HEX-BD.
   924     IF HEX-NBR = EBD-RC1 MOVE 'SYSIDERR' TO TMR1-B.
   925
   926     MOVE 209                    TO HEX-BD.
   927     IF HEX-NBR = EBD-RC1 MOVE 'ISCINVRER' TO TMR1-B.
   928
   929     MOVE 225                    TO HEX-BD.
   930     IF HEX-NBR = EBD-RC1 MOVE 'LENGERR' TO TMR1-B.
   931
   932     MOVE 233                    TO HEX-BD.
   933     IF HEX-NBR = EBD-RC1 MOVE 'ENVDEFERR' TO TMR1-B.
   934
   935     MOVE 255                    TO HEX-BD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL004.cbl
   936     IF HEX-NBR = EBD-RC1 MOVE 'INVREQ'  TO TMR1-B.
   937
   938 275-PTS-900-EXIT.
   939     EXIT.
   940
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL004.cbl
   942 300-ENQ SECTION.
   943
   944 300-ENQ-10-NOTES.
   945*
   946*    THIS SECTION HANDLES WAIT EVENT, ENQ, DEQ, AND SUSPEND
   947*
   948     MOVE 02                     TO HEX-BD.
   949     IF HEX-NBR = EBD-FN2 MOVE 'WAIT EVENT' TO TMR1-A.
   950
   951     MOVE 04                     TO HEX-BD.
   952     IF HEX-NBR = EBD-FN2 MOVE 'ENQ' TO TMR1-A.
   953
   954     MOVE 06                     TO HEX-BD.
   955     IF HEX-NBR = EBD-FN2 MOVE 'DEQ' TO TMR1-A.
   956
   957     MOVE 08                     TO HEX-BD.
   958     IF HEX-NBR = EBD-FN2 MOVE 'SUSPEND' TO TMR1-A.
   959
   960     MOVE 50                     TO HEX-BD.
   961     IF HEX-NBR = EBD-RC1 MOVE 'ENQBUSY' TO TMR1-B.
   962
   963 300-ENQ-900-EXIT.
   964     EXIT.
   965
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL004.cbl
   967 325-JOURNAL SECTION.
   968
   969 325-JUS-10-NOTES.
   970*
   971*    THIS SECTION HANDLES ALL JOURNAL ABENDS
   972*
   973     MOVE 02                     TO HEX-BD.
   974     IF HEX-NBR = EBD-FN2 MOVE 'JOURNAL' TO TMR1-A.
   975
   976     MOVE 04                     TO HEX-BD.
   977     IF HEX-NBR = EBD-FN2 MOVE 'WAIT JOURNAL' TO TMR1-A.
   978
   979     MOVE 01                     TO HEX-BD.
   980     IF HEX-NBR = EBD-RC1 MOVE 'JIDERR' TO TMR1-B.
   981
   982     MOVE 02                     TO HEX-BD.
   983     IF HEX-NBR = EBD-RC1 MOVE 'INVREQ' TO TMR1-B.
   984
   985     MOVE 05                     TO HEX-BD.
   986     IF HEX-NBR = EBD-RC1 MOVE 'NOTOPEN' TO TMR1-B.
   987
   988     MOVE 06                     TO HEX-BD.
   989     IF HEX-NBR = EBD-RC1 MOVE 'LENGERR' TO TMR1-B.
   990
   991     MOVE 07                     TO HEX-BD.
   992     IF HEX-NBR = EBD-RC1 MOVE 'IOERR' TO TMR1-B.
   993
   994     MOVE 09                     TO HEX-BD.
   995     IF HEX-NBR = EBD-RC1 MOVE 'NOJBUFSP' TO TMR1-B.
   996
   997 325-JUS-900-EXIT.
   998     EXIT.
   999
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL004.cbl
  1001 350-MAP SECTION.
  1002
  1003 350-MPS-10-NOTES.
  1004*
  1005*    THIS SECTION HANDLES ALL MAP ERRORS
  1006*
  1007     MOVE 02                     TO HEX-BD.
  1008     IF HEX-NBR = EBD-FN2 MOVE 'RECEIVE MAP' TO TMR1-A.
  1009
  1010     MOVE 04                     TO HEX-BD.
  1011     IF HEX-NBR = EBD-FN2 MOVE 'SEND MAP' TO TMR1-A.
  1012
  1013     MOVE 06                     TO HEX-BD.
  1014     IF HEX-NBR = EBD-FN2 MOVE 'SEND TEXT' TO TMR1-A.
  1015
  1016     MOVE 08                     TO HEX-BD.
  1017     IF HEX-NBR = EBD-FN2 MOVE 'SEND PAGE' TO TMR1-A.
  1018
  1019     MOVE 10                     TO HEX-BD.
  1020     IF HEX-NBR = EBD-FN2 MOVE 'PURGE MESSAGE' TO TMR1-A.
  1021
  1022     MOVE 12                     TO HEX-BD.
  1023     IF HEX-NBR = EBD-FN2 MOVE 'ROUTE' TO TMR1-A.
  1024
  1025     MOVE 01                     TO HEX-BD.
  1026     IF HEX-NBR = EBD-RC1 MOVE 'INVREQ' TO TMR1-B.
  1027
  1028     MOVE 02                     TO HEX-BD.
  1029     IF HEX-NBR = EBD-RC1 MOVE 'RETPAGE' TO TMR1-B.
  1030
  1031     MOVE 04                     TO HEX-BD.
  1032     IF HEX-NBR = EBD-RC1 MOVE 'MAPFAIL' TO TMR1-B.
  1033
  1034     MOVE 08                     TO HEX-BD.
  1035     IF HEX-NBR = EBD-RC1 MOVE 'INVMPSZ' TO TMR1-B.
  1036
  1037     MOVE 32                     TO HEX-BD.
  1038     IF HEX-NBR = EBD-RC1 MOVE 'INVERRTERM' TO TMR1-B.
  1039
  1040     MOVE 64                     TO HEX-BD.
  1041     IF HEX-NBR = EBD-RC1 MOVE 'RTESOME' TO TMR1-B.
  1042
  1043     MOVE 128                    TO HEX-BD.
  1044     IF HEX-NBR = EBD-RC1 MOVE 'RTEFAIL' TO TMR1-B.
  1045
  1046     MOVE 227                    TO HEX-BD.
  1047     IF HEX-NBR = EBD-RC1 MOVE 'WRBRK'  TO TMR1-B.
  1048
  1049     MOVE 228                    TO HEX-BD.
  1050     IF HEX-NBR = EBD-RC1 MOVE 'RDATT' TO TMR1-B.
  1051
  1052     MOVE 16                     TO HEX-BD.
  1053     IF HEX-NBR = EBD-RC2 MOVE 'INVLDC' TO TMR1-B.
  1054
  1055     MOVE 128                    TO HEX-BD.
  1056     IF HEX-NBR = EBD-RC2 MOVE 'TSIOERR' TO TMR1-B.
  1057
  1058     MOVE 01                     TO HEX-BD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL004.cbl
  1059     IF HEX-NBR = EBD-RC3 MOVE 'OVERFLOW' TO TMR1-B.
  1060
  1061 350-MPS-900-EXIT.
  1062     EXIT.
  1063
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL004.cbl
  1065 375-ISS-QUERY SECTION.
  1066
  1067 375-ISS-10-NOTES.
  1068*
  1069*    THIS SECTION HANDLES ALL ISSUE ERRORS
  1070*
  1071     MOVE 02                     TO HEX-BD.
  1072     IF HEX-NBR = EBD-FN2 MOVE 'ISSUE ADD' TO TMR1-A.
  1073
  1074     MOVE 04                     TO HEX-BD.
  1075     IF HEX-NBR = EBD-FN2 MOVE 'ISSUE ERASE' TO TMR1-A.
  1076
  1077     MOVE 06                     TO HEX-BD.
  1078     IF HEX-NBR = EBD-FN2 MOVE 'ISSUE REPLACE' TO TMR1-A.
  1079
  1080     MOVE 08                     TO HEX-BD.
  1081     IF HEX-NBR = EBD-FN2 MOVE 'ISSUE ABORT' TO TMR1-A.
  1082
  1083     MOVE 10                     TO HEX-BD.
  1084     IF HEX-NBR = EBD-FN2 MOVE 'ISSUE QUERY' TO TMR1-A.
  1085
  1086     MOVE 12                     TO HEX-BD.
  1087     IF HEX-NBR = EBD-FN2 MOVE 'ISSUE END' TO TMR1-A.
  1088
  1089     MOVE 14                     TO HEX-BD.
  1090     IF HEX-NBR = EBD-FN2 MOVE 'ISSUE RECEIVE' TO TMR1-A.
  1091
  1092     MOVE 16                     TO HEX-BD.
  1093     IF HEX-NBR = EBD-FN2 MOVE 'ISSUE NOTE' TO TMR1-A.
  1094
  1095     MOVE 18                     TO HEX-BD.
  1096     IF HEX-NBR = EBD-FN2 MOVE 'ISSUE WAIT' TO TMR1-A.
  1097
  1098     MOVE 04                     TO HEX-BD.
  1099     IF HEX-NBR = EBD-RC3 MOVE 'EDOS' TO TMR1-B.
  1100
  1101     MOVE 08                     TO HEX-BD.
  1102     IF HEX-NBR = EBD-RC3 MOVE 'EOC' TO TMR1-B.
  1103
  1104     MOVE 16                     TO HEX-BD.
  1105     IF HEX-NBR = EBD-RC3 MOVE 'IGREQID' TO TMR1-B.
  1106
  1107     MOVE 04                     TO HEX-BD.
  1108     IF HEX-NBR = EBD-RC1 MOVE 'DSSTAT' TO TMR1-B.
  1109
  1110     MOVE 08                     TO HEX-BD.
  1111     IF HEX-NBR = EBD-RC1 MOVE 'FUNCERR' TO TMR1-B.
  1112
  1113     MOVE 12                     TO HEX-BD.
  1114     IF HEX-NBR = EBD-RC1 MOVE 'SELNERR' TO TMR1-B.
  1115
  1116     MOVE 16                     TO HEX-BD.
  1117     IF HEX-NBR = EBD-RC1 MOVE 'UNEXPIN' TO TMR1-B.
  1118
  1119     MOVE 225                    TO HEX-BD.
  1120     IF HEX-NBR = EBD-RC1 MOVE 'LENGERR' TO TMR1-B.
  1121
  1122     MOVE 17                     TO HEX-BD.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL004.cbl
  1123     IF HEX-NBR = EBD-RC2 MOVE 'EDOS' TO TMR1-B.
  1124
  1125     MOVE 32                     TO HEX-BD.
  1126     IF HEX-NBR = EBD-RC3 MOVE 'EOC' TO TMR1-B.
  1127
  1128 375-ISS-900-EXIT.
  1129     EXIT.
  1130
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL004.cbl
  1132 1000-CONVERT-HEX-CHARACTERS SECTION.
  1133     IF WS-INDEX GREATER THAN +1
  1134         MULTIPLY WS-INDEX BY +2 GIVING WS-INDEX2
  1135       ELSE
  1136         MOVE +1                 TO  WS-INDEX2.
  1137
  1138     MOVE WS-CHARACTER (WS-INDEX) TO WS-CHAR
  1139
  1140     IF WS-NUMBER = ZERO
  1141         MOVE ZERO               TO  WS-ZONE (WS-INDEX)
  1142                                     WS-DIGIT (WS-INDEX)
  1143         GO TO 1099-EXIT.
  1144
  1145     DIVIDE WS-NUMBER BY +16 GIVING WS-NUMBER
  1146         REMAINDER WS-REMAINDER
  1147
  1148     IF WS-NUMBER NOT = ZERO
  1149         MOVE WS-HEX-CHAR (WS-NUMBER) TO  WS-ZONE (WS-INDEX)
  1150       ELSE
  1151         MOVE ZERO               TO  WS-ZONE (WS-INDEX).
  1152
  1153     IF WS-REMAINDER NOT = ZERO
  1154         MOVE WS-HEX-CHAR (WS-REMAINDER) TO  WS-DIGIT (WS-INDEX)
  1155       ELSE
  1156         MOVE ZERO               TO  WS-DIGIT (WS-INDEX).
  1157
  1158 1099-EXIT.
  1159     EXIT.
  1160
  1161
  1162 9999-DFHBACK SECTION.
  1163     MOVE '9%                    "   ' TO DFHEIV0
  1164     MOVE 'EL004' TO DFHEIV1
  1165     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1166     GOBACK.
  1167 9999-DFHEXIT.
  1168     IF DFHEIGDJ EQUAL 0001
  1169         NEXT SENTENCE.
  1170     MOVE '9%                    "   ' TO DFHEIV0
  1171     MOVE 'EL004' TO DFHEIV1
  1172     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  1173     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        1332     Code:        6479
