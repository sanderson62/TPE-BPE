* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6522.cbl
* Options: int("EL6522.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6522.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6522.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6522.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6522.
     4*AUTHOR.                     SUZAN VUKOV.
     5*
     6*REMARKS.     TRANSACTION - EXDC - COMPENSATION NOTE MAINTENANCE.
     7*
     8******************************************************************
     9*                   C H A N G E   L O G
    10*
    11* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    12*-----------------------------------------------------------------
    13*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6522.cbl
    14* EFFECTIVE    NUMBER
    15*-----------------------------------------------------------------
    16* 022803    2002032200002  SMVA  NEW ONLINE PROGRAM
    17* 021511  IR2011021400003  AJRA  FIX ACCOUNT NAME
    18******************************************************************
    19 ENVIRONMENT DIVISION.
    20
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6522.cbl
    22 DATA DIVISION.
    23 WORKING-STORAGE SECTION.
    24 01  DFH-START PIC X(04).
    25 77  FILLER  PIC X(32)  VALUE '********************************'.
    26 77  FILLER  PIC X(32)  VALUE '*     EL6522 WORKING STORAGE   *'.
    27 77  FILLER  PIC X(32)  VALUE '********* VMOD=2.005 ***********'.
    28
    29*    COPY ELCSCTM.
    30******************************************************************
    31*                                                                *
    32*                                                                *
    33*                            ELCSCTM                             *
    34*                            VMOD=2.001                          *
    35*                                                                *
    36*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    37*                                                                *
    38******************************************************************
    39 01  SECURITY-MESSAGE.
    40     12  FILLER                          PIC X(30)
    41            VALUE '** LOGIC SECURITY VIOLATION -'.
    42     12  SM-READ                         PIC X(6).
    43     12  FILLER                          PIC X(5)
    44            VALUE ' PGM='.
    45     12  SM-PGM                          PIC X(6).
    46     12  FILLER                          PIC X(5)
    47            VALUE ' OPR='.
    48     12  SM-PROCESSOR-ID                 PIC X(4).
    49     12  FILLER                          PIC X(6)
    50            VALUE ' TERM='.
    51     12  SM-TERMID                       PIC X(4).
    52     12  FILLER                          PIC XX   VALUE SPACE.
    53     12  SM-JUL-DATE                     PIC 9(5).
    54     12  FILLER                          PIC X    VALUE SPACE.
    55     12  SM-TIME                         PIC 99.99.
    56
    57*    COPY ELCSCRTY.
    58******************************************************************
    59*                                                                *
    60*                                                                *
    61*                            ELCSCRTY                            *
    62*                            VMOD=2.001                          *
    63*                                                                *
    64*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    65*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    66*        SAVED IN PI-SECURITY-ADDRESS.                           *
    67*                                                                *
    68******************************************************************
    69 01  SECURITY-CONTROL.
    70     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    71     12  FILLER                       PIC XX    VALUE 'SC'.
    72     12  SC-CREDIT-CODES.
    73         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    74             20  SC-CREDIT-DISPLAY    PIC X.
    75             20  SC-CREDIT-UPDATE     PIC X.
    76     12  SC-CLAIMS-CODES.
    77         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    78             20  SC-CLAIMS-DISPLAY    PIC X.
    79             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6522.cbl
    80
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6522.cbl
    82 01  STANDARD-AREAS.
    83     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
    84     12  MAP-NAME                    PIC X(8)    VALUE 'EL6522A'.
    85     12  MAPSET-NAME                 PIC X(8)    VALUE 'EL6522S '.
    86     12  SCRN-NUMBER                 PIC X(4)    VALUE '652C'.
    87     12  TRANS-ID                    PIC X(4)    VALUE 'EXDC'.
    88     12  W-PRINT-TRANS               PIC X(4)    VALUE 'EXDD'.
    89     12  THIS-PGM                    PIC X(8)    VALUE 'EL6522'.
    90     12  PGM-NAME                    PIC X(8).
    91     12  PGM-EL652                   PIC X(8)    VALUE 'EL652'.
    92
    93     12  ERCONT-FILE-ID              PIC X(8)    VALUE 'ERCONT'.
    94     12  ELCNTL-FILE-ID              PIC X(8)    VALUE 'ELCNTL'.
    95     12  QID.
    96         16  QID-TERM                PIC X(4).
    97         16  FILLER                  PIC X(4)    VALUE '652C'.
    98     12  QID-ITEM                    PIC S9(4)   COMP VALUE +0.
    99     12  SC-ITEM                     PIC S9(4)   COMP VALUE +1.
   100
   101 01  WORK-AREA.
   102     12  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   103     12  SAVE-BIN-DATE               PIC X(2)    VALUE SPACES.
   104
   105     12  FN-CONVERT                  PIC XX.
   106     12  FN-BIN REDEFINES FN-CONVERT PIC S9(4)  COMP.
   107
   108     12  ERCONT-LENGTH               PIC S9(4)   COMP VALUE +128.
   109     12  ERCONT-KEY-LENGTH           PIC S9(4)   COMP VALUE +31.
   110     12  ERCONT-START-LENGTH         PIC S9(4)   COMP VALUE +29.
   111     12  ERCONT-KEY.
   112         16  ERCONT-PARTIAL-KEY.
   113             20 ERCONT-COMPANY-CD    PIC X.
   114             20 ERCONT-CARRIER       PIC X.
   115             20 ERCONT-GROUPING      PIC X(06).
   116             20 ERCONT-FINRESP       PIC X(10).
   117             20 ERCONT-ACCOUNT       PIC X(10).
   118             20 ERCONT-REC-TYP       PIC X(01).
   119         16 ERCONT-SEQ               PIC S9(4) COMP.
   120     12  SV-PRIOR-KEY.
   121         20 SV-COMPANY-CD            PIC X.
   122         20 SV-CARRIER               PIC X.
   123         20 SV-GROUPING              PIC X(06).
   124         20 SV-FINRESP               PIC X(10).
   125         20 SV-ACCOUNT               PIC X(10).
   126         20 SV-REC-TYP               PIC X.
   127         20 SV-SEQ                   PIC S9(4) COMP.
   128     12  ELCNTL-KEY.
   129         16  ELCNTL-COMPANY          PIC XXX.
   130         16  ELCNTL-REC-TYPE         PIC X.
   131         16  FILLER                  PIC X(4).
   132         16  ELCNTL-SEQ-NO           PIC S9(4)   COMP.
   133     12  TIME-IN                     PIC S9(7).
   134     12  TIME-SPLIT REDEFINES TIME-IN.
   135         16  FILLER                  PIC X.
   136         16  TIME-OUT                PIC 99V99.
   137         16  FILLER                  PIC 9(2).
   138     12  XCTL-005                    PIC X(8)    VALUE 'EL005'.
   139     12  XCTL-126                    PIC X(8)    VALUE 'EL126'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6522.cbl
   140     12  LINK-001                    PIC X(8)    VALUE 'EL001'.
   141     12  LINK-004                    PIC X(8)    VALUE 'EL004'.
   142     12  LINK-ELDATCV                PIC X(8)    VALUE 'ELDATCV'.
   143     12  MAX-LINES                   PIC 9(03)   VALUE 300.
   144     12  NUM-LINES-PER-SCREEN        PIC 9(02)   VALUE 12.
   145     12  TS-NUM-REC-IN-GROUP         PIC 9(02)   VALUE 50.
   146     12  TS-GROUP-WORK               PIC 9(5)    VALUE 0  COMP-3.
   147     12  TS-LENGTH                   PIC S9(4)   VALUE +3600 COMP.
   148     12  ROLL-COUNTER                PIC S999    VALUE +0 COMP-3.
   149     12  TEMP-CURR-LINE              PIC S9(3)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6522.cbl
   151 01  ERROR-MESSAGES.
   152     12  ER-0000                     PIC X(04)       VALUE '0000'.
   153     12  ER-0004                     PIC X(04)       VALUE '0004'.
   154     12  ER-0006                     PIC X(04)       VALUE '0006'.
   155     12  ER-0008                     PIC X(04)       VALUE '0008'.
   156     12  ER-0023                     PIC X(04)       VALUE '0023'.
   157     12  ER-0029                     PIC X(04)       VALUE '0029'.
   158     12  ER-0030                     PIC X(04)       VALUE '0030'.
   159     12  ER-0031                     PIC X(04)       VALUE '0031'.
   160     12  ER-0032                     PIC X(04)       VALUE '0032'.
   161     12  ER-0033                     PIC X(04)       VALUE '0033'.
   162     12  ER-0041                     PIC X(04)       VALUE '0041'.
   163     12  ER-0044                     PIC X(04)       VALUE '0044'.
   164     12  ER-0045                     PIC X(04)       VALUE '0045'.
   165     12  ER-0047                     PIC X(04)       VALUE '0047'.
   166     12  ER-0048                     PIC X(04)       VALUE '0048'.
   167     12  ER-0049                     PIC X(04)       VALUE '0049'.
   168     12  ER-0050                     PIC X(04)       VALUE '0050'.
   169     12  ER-0051                     PIC X(04)       VALUE '0051'.
   170     12  ER-0066                     PIC X(04)       VALUE '0066'.
   171     12  ER-0067                     PIC X(04)       VALUE '0067'.
   172     12  ER-0069                     PIC X(04)       VALUE '0069'.
   173     12  ER-0070                     PIC X(04)       VALUE '0070'.
   174     12  ER-0140                     PIC X(04)       VALUE '0140'.
   175     12  ER-0412                     PIC X(04)       VALUE '0412'.
   176     12  ER-0413                     PIC X(04)       VALUE '0413'.
   177     12  ER-3784                     PIC X(04)       VALUE '3784'.
   178     12  ER-3786                     PIC X(04)       VALUE '3786'.
   179     12  ER-3787                     PIC X(04)       VALUE '3787'.
   180     12  ER-3788                     PIC X(04)       VALUE '3788'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6522.cbl
   182*                       COPY ELCLOGOF.
   183******************************************************************
   184*                                                                *
   185*                                                                *
   186*                            ELCLOGOF.                           *
   187*                            VMOD=2.001                          *
   188*                                                                *
   189*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   190*                                                                *
   191******************************************************************
   192 01  CLASIC-LOGOFF.
   193     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   194     12  LOGOFF-TEXT.
   195         16  FILLER          PIC X(5)    VALUE SPACES.
   196         16  LOGOFF-MSG.
   197             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   198             20  FILLER      PIC X       VALUE SPACES.
   199             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   200         16  FILLER          PIC X(80)
   201           VALUE '* YOU ARE NOW LOGGED OFF'.
   202         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   203         16  FILLER          PIC X       VALUE QUOTE.
   204         16  LOGOFF-SYS-MSG  PIC X(17)
   205           VALUE 'S CLAS-IC SYSTEM '.
   206     12  TEXT-MESSAGES.
   207         16  UNACCESS-MSG    PIC X(29)
   208             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   209         16  PGMIDERR-MSG    PIC X(17)
   210             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6522.cbl
   212*                       COPY ELCAID.
   213******************************************************************
   214*                                                                *
   215*                            ELCAID.                             *
   216*                            VMOD=2.001                          *
   217*                                                                *
   218*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   219*                                                                *
   220*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   221*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   222******************************************************************
   223
   224 01  DFHAID.
   225   02  DFHNULL   PIC  X  VALUE  ' '.
   226   02  DFHENTER  PIC  X  VALUE  QUOTE.
   227   02  DFHCLEAR  PIC  X  VALUE  '_'.
   228   02  DFHPEN    PIC  X  VALUE  '='.
   229   02  DFHOPID   PIC  X  VALUE  'W'.
   230   02  DFHPA1    PIC  X  VALUE  '%'.
   231   02  DFHPA2    PIC  X  VALUE  '>'.
   232   02  DFHPA3    PIC  X  VALUE  ','.
   233   02  DFHPF1    PIC  X  VALUE  '1'.
   234   02  DFHPF2    PIC  X  VALUE  '2'.
   235   02  DFHPF3    PIC  X  VALUE  '3'.
   236   02  DFHPF4    PIC  X  VALUE  '4'.
   237   02  DFHPF5    PIC  X  VALUE  '5'.
   238   02  DFHPF6    PIC  X  VALUE  '6'.
   239   02  DFHPF7    PIC  X  VALUE  '7'.
   240   02  DFHPF8    PIC  X  VALUE  '8'.
   241   02  DFHPF9    PIC  X  VALUE  '9'.
   242   02  DFHPF10   PIC  X  VALUE  ':'.
   243   02  DFHPF11   PIC  X  VALUE  '#'.
   244   02  DFHPF12   PIC  X  VALUE  '@'.
   245   02  DFHPF13   PIC  X  VALUE  'A'.
   246   02  DFHPF14   PIC  X  VALUE  'B'.
   247   02  DFHPF15   PIC  X  VALUE  'C'.
   248   02  DFHPF16   PIC  X  VALUE  'D'.
   249   02  DFHPF17   PIC  X  VALUE  'E'.
   250   02  DFHPF18   PIC  X  VALUE  'F'.
   251   02  DFHPF19   PIC  X  VALUE  'G'.
   252   02  DFHPF20   PIC  X  VALUE  'H'.
   253   02  DFHPF21   PIC  X  VALUE  'I'.
   254*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   255   02  DFHPF22   PIC  X  VALUE  '['.
   256   02  DFHPF23   PIC  X  VALUE  '.'.
   257   02  DFHPF24   PIC  X  VALUE  '<'.
   258   02  DFHMSRE   PIC  X  VALUE  'X'.
   259   02  DFHSTRF   PIC  X  VALUE  'h'.
   260   02  DFHTRIG   PIC  X  VALUE  '"'.
   261 01  FILLER  REDEFINES DFHAID.
   262     12  FILLER                      PIC X(8).
   263     12  PF-VALUES OCCURS 24 TIMES   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6522.cbl
   265*                       COPY ELCEMIB.
   266******************************************************************
   267*                                                                *
   268*                                                                *
   269*                            ELCEMIB.                            *
   270*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   271*                            VMOD=2.005                          *
   272*                                                                *
   273*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   274*                                                                *
   275******************************************************************
   276 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   277     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   278     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   279     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   280     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   281     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   282     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   283     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   284     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   285     12  EMI-SWITCH1             PIC X        VALUE '1'.
   286         88  EMI-NO-ERRORS                    VALUE '1'.
   287         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   288         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   289     12  EMI-SWITCH2             PIC X        VALUE '1'.
   290         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   291     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   292         88  EMI-AREA1-EMPTY                  VALUE '1'.
   293         88  EMI-AREA1-FULL                   VALUE '2'.
   294     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   295         88  EMI-AREA2-EMPTY                  VALUE '1'.
   296         88  EMI-AREA2-FULL                   VALUE '2'.
   297     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   298         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   299         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   300         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   301         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   302         88  EMI-BYPASS-FATALS                VALUE 'X'.
   303     12  EMI-ERROR-LINES.
   304         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   305         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   306         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   307         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   308             20  EMI-ERR-CODES OCCURS 10 TIMES.
   309                 24  EMI-ERR-NUM         PIC X(4).
   310                 24  EMI-FILLER          PIC X.
   311                 24  EMI-SEV             PIC X.
   312                 24  FILLER              PIC X.
   313             20  FILLER                  PIC X(02).
   314     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   315         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   316             20  EMI-ERROR-NUMBER    PIC X(4).
   317             20  EMI-FILL            PIC X.
   318             20  EMI-SEVERITY        PIC X.
   319             20  FILLER              PIC X.
   320             20  EMI-ERROR-TEXT.
   321                 24  EMI-TEXT-VARIABLE   PIC X(10).
   322                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6522.cbl
   323     12  EMI-SEVERITY-SAVE           PIC X.
   324         88  EMI-NOTE                    VALUE 'N'.
   325         88  EMI-WARNING                 VALUE 'W'.
   326         88  EMI-FORCABLE                VALUE 'F'.
   327         88  EMI-FATAL                   VALUE 'X'.
   328     12  EMI-MESSAGE-FLAG            PIC X.
   329         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   330         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   331     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   332     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   333         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   334         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   335         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   336     12  FILLER                      PIC X(137)  VALUE SPACES.
   337     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   338     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   339     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   340     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6522.cbl
   342*                       COPY ELCINTF.
   343******************************************************************
   344*                                                                *
   345*                                                                *
   346*                            ELCINTF.                            *
   347*                            VMOD=2.017                          *
   348*                                                                *
   349*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   350*                                                                *
   351*       LENGTH = 1024                                            *
   352*                                                                *
   353******************************************************************
   354 01  PROGRAM-INTERFACE-BLOCK.
   355     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   356     12  PI-CALLING-PROGRAM              PIC X(8).
   357     12  PI-SAVED-PROGRAM-1              PIC X(8).
   358     12  PI-SAVED-PROGRAM-2              PIC X(8).
   359     12  PI-SAVED-PROGRAM-3              PIC X(8).
   360     12  PI-SAVED-PROGRAM-4              PIC X(8).
   361     12  PI-SAVED-PROGRAM-5              PIC X(8).
   362     12  PI-SAVED-PROGRAM-6              PIC X(8).
   363     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   364     12  PI-COMPANY-ID                   PIC XXX.
   365     12  PI-COMPANY-CD                   PIC X.
   366
   367     12  PI-COMPANY-PASSWORD             PIC X(8).
   368
   369     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   370
   371     12  PI-CONTROL-IN-PROGRESS.
   372         16  PI-CARRIER                  PIC X.
   373         16  PI-GROUPING                 PIC X(6).
   374         16  PI-STATE                    PIC XX.
   375         16  PI-ACCOUNT                  PIC X(10).
   376         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   377                                         PIC X(10).
   378         16  PI-CLAIM-CERT-GRP.
   379             20  PI-CLAIM-NO             PIC X(7).
   380             20  PI-CERT-NO.
   381                 25  PI-CERT-PRIME       PIC X(10).
   382                 25  PI-CERT-SFX         PIC X.
   383             20  PI-CERT-EFF-DT          PIC XX.
   384         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   385             20  PI-PLAN-CODE            PIC X(2).
   386             20  PI-REVISION-NUMBER      PIC X(3).
   387             20  PI-PLAN-EFF-DT          PIC X(2).
   388             20  PI-PLAN-EXP-DT          PIC X(2).
   389             20  FILLER                  PIC X(11).
   390         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   391             20  PI-OE-REFERENCE-1.
   392                 25  PI-OE-REF-1-PRIME   PIC X(18).
   393                 25  PI-OE-REF-1-SUFF    PIC XX.
   394
   395     12  PI-SESSION-IN-PROGRESS          PIC X.
   396         88  CLAIM-SESSION                   VALUE '1'.
   397         88  CREDIT-SESSION                  VALUE '2'.
   398         88  WARRANTY-SESSION                VALUE '3'.
   399         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6522.cbl
   400         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   401
   402
   403*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   404
   405     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   406     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   407
   408     12  PI-CREDIT-USER                  PIC X.
   409         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   410         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   411
   412     12  PI-CLAIM-USER                   PIC X.
   413         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   414         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   415
   416     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   417         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   418         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   419         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   420         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   421         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   422
   423     12  PI-PROCESSOR-ID                 PIC X(4).
   424
   425     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   426
   427     12  PI-MEMBER-CAPTION               PIC X(10).
   428
   429     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   430         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   431
   432     12  PI-LIFE-OVERRIDE-L1             PIC X.
   433     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   434     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   435     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   436
   437     12  PI-AH-OVERRIDE-L1               PIC X.
   438     12  PI-AH-OVERRIDE-L2               PIC XX.
   439     12  PI-AH-OVERRIDE-L6               PIC X(6).
   440     12  PI-AH-OVERRIDE-L12              PIC X(12).
   441
   442     12  PI-NEW-SYSTEM                   PIC X(2).
   443
   444     12  PI-PRIMARY-CERT-NO              PIC X(11).
   445     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   446         88  PI-USES-PAID-TO                 VALUE '1'.
   447     12  PI-CRDTCRD-SYSTEM.
   448         16  PI-CRDTCRD-USER             PIC X.
   449             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   450             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   451         16  PI-CC-MONTH-END-DT          PIC XX.
   452     12  PI-PROCESSOR-PRINTER            PIC X(4).
   453
   454     12  PI-OE-REFERENCE-2.
   455         16  PI-OE-REF-2-PRIME           PIC X(10).
   456         16  PI-OE-REF-2-SUFF            PIC X.
   457
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6522.cbl
   458     12  PI-REM-TRM-CALC-OPTION          PIC X.
   459
   460     12  PI-LANGUAGE-TYPE                PIC X.
   461             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   462             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   463             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   464
   465     12  PI-POLICY-LINKAGE-IND           PIC X.
   466         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   467         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   468                                                   LOW-VALUES.
   469
   470     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   471     12  PI-CLAIM-PW-SESSION             PIC X(1).
   472         88  PI-CLAIM-CREDIT                 VALUE '1'.
   473         88  PI-CLAIM-CONVEN                 VALUE '2'.
   474     12  FILLER                          PIC X(4).
   475
   476     12  PI-SYSTEM-LEVEL                 PIC X(145).
   477
   478     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   479         PI-SYSTEM-LEVEL.
   480
   481         16  PI-ENTRY-CODES.
   482             20  PI-ENTRY-CD-1           PIC X.
   483             20  PI-ENTRY-CD-2           PIC X.
   484
   485         16  PI-RETURN-CODES.
   486             20  PI-RETURN-CD-1          PIC X.
   487             20  PI-RETURN-CD-2          PIC X.
   488
   489         16  PI-UPDATE-STATUS-SAVE.
   490             20  PI-UPDATE-BY            PIC X(4).
   491             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   492
   493         16  PI-LOWER-CASE-LETTERS       PIC X.
   494             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   495
   496*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   497*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   498*            88  CARRIER-CLM-CNTL            VALUE '2'.
   499
   500         16  PI-CERT-ACCESS-CONTROL      PIC X.
   501             88  ST-ACCNT-CNTL               VALUE ' '.
   502             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   503             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   504             88  ACCNT-CNTL                  VALUE '3'.
   505             88  CARR-ACCNT-CNTL             VALUE '4'.
   506
   507         16  PI-PROCESSOR-CAP-LIST.
   508             20  PI-SYSTEM-CONTROLS.
   509                24 PI-SYSTEM-DISPLAY     PIC X.
   510                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   511                24 PI-SYSTEM-MODIFY      PIC X.
   512                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   513             20  FILLER                  PIC XX.
   514             20  PI-DISPLAY-CAP          PIC X.
   515                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6522.cbl
   516             20  PI-MODIFY-CAP           PIC X.
   517                 88  MODIFY-CAP              VALUE 'Y'.
   518             20  PI-MSG-AT-LOGON-CAP     PIC X.
   519                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   520             20  PI-FORCE-CAP            PIC X.
   521                 88  FORCE-CAP               VALUE 'Y'.
   522
   523         16  PI-PROGRAM-CONTROLS.
   524             20  PI-PGM-PRINT-OPT        PIC X.
   525             20  PI-PGM-FORMAT-OPT       PIC X.
   526             20  PI-PGM-PROCESS-OPT      PIC X.
   527             20  PI-PGM-TOTALS-OPT       PIC X.
   528
   529         16  PI-HELP-INTERFACE.
   530             20  PI-LAST-ERROR-NO        PIC X(4).
   531             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   532
   533         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   534             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   535
   536         16  PI-CR-CONTROL-IN-PROGRESS.
   537             20  PI-CR-CARRIER           PIC X.
   538             20  PI-CR-GROUPING          PIC X(6).
   539             20  PI-CR-STATE             PIC XX.
   540             20  PI-CR-ACCOUNT           PIC X(10).
   541             20  PI-CR-FIN-RESP          PIC X(10).
   542             20  PI-CR-TYPE              PIC X.
   543
   544         16  PI-CR-BATCH-NUMBER          PIC X(6).
   545
   546         16  PI-CR-MONTH-END-DT          PIC XX.
   547
   548         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   549             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   550             88  PI-ZERO-CARRIER             VALUE '1'.
   551             88  PI-ZERO-GROUPING            VALUE '2'.
   552             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   553
   554         16  PI-CARRIER-SECURITY         PIC X.
   555             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   556
   557         16  PI-ACCOUNT-SECURITY         PIC X(10).
   558             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   559             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   560
   561         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   562             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   563                                         INDEXED BY PI-ACCESS-NDX
   564                                         PIC X.
   565
   566         16  PI-GA-BILLING-CONTROL       PIC X.
   567             88  PI-GA-BILLING               VALUE '1'.
   568
   569         16  PI-MAIL-PROCESSING          PIC X.
   570             88  PI-MAIL-YES                 VALUE 'Y'.
   571
   572         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   573
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6522.cbl
   574         16  PI-AR-SYSTEM.
   575             20  PI-AR-PROCESSING-CNTL   PIC X.
   576                 88  PI-AR-PROCESSING        VALUE 'Y'.
   577             20  PI-AR-SUMMARY-CODE      PIC X(6).
   578             20  PI-AR-MONTH-END-DT      PIC XX.
   579
   580         16  PI-MP-SYSTEM.
   581             20  PI-MORTGAGE-USER            PIC X.
   582                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   583                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   584             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   585                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   586                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   587                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   588                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   589                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   590             20  PI-MP-MONTH-END-DT          PIC XX.
   591             20  PI-MP-REFERENCE-NO.
   592                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   593                 24  PI-MP-REFERENCE-SFX     PIC XX.
   594
   595         16  PI-LABEL-CONTROL            PIC X(01).
   596             88  PI-CREATE-LABELS                    VALUE 'Y'.
   597             88  PI-BYPASS-LABELS                    VALUE 'N'.
   598
   599         16  PI-BILL-GROUPING-CODE       PIC X(01).
   600             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   601
   602         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   603             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   604             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   605
   606         16  FILLER                      PIC X(14).
   607
   608     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   609******************************************************************
   610     12  PI-WORK-AREA  REDEFINES  PI-PROGRAM-WORK-AREA.
   611         16  PI-CHECK-MAINT-TYPE     PIC X.
   612             88  VALID-MAINT-TYPE            VALUE 'S' 'A'
   613                                                   'C' 'D'.
   614             88  ADD-FUNCTION                VALUE 'A'.
   615             88  SHOW-FUNCTION               VALUE 'S'.
   616             88  DELETE-FUNCTION             VALUE 'D'.
   617             88  CHANGE-FUNCTION             VALUE 'C'.
   618         16  PI-CHECK-TYPE           PIC X.
   619             88  VALID-TYPE                  VALUE 'A' 'G'
   620                                                   'C'.
   621         16  PI-CHECK-CARRY-BAL      PIC X.
   622             88  VALID-CARRY-BAL             VALUE 'Y' 'N'.
   623         16  PI-FIRST-TIME-SW        PIC X.
   624         16  PI-ERCOMP-EOF-SW        PIC X.
   625             88  ERCOMP-EOF                  VALUE 'Y'.
   626         16  PI-SAVE-PHONE           PIC X(10).
   627         16  PI-SAVE-PHONE-RED REDEFINES
   628                               PI-SAVE-PHONE  PIC 9(10).
   629         16  PI-ERC-END-BAL          PIC S9(9)V99   COMP-3.
   630         16  PI-ERCOMP-KEY.
   631             20  PI-ERC-COMPANY-CD   PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6522.cbl
   632             20  PI-ERC-CARRIER      PIC X.
   633             20  PI-ERC-GROUP        PIC X(6).
   634             20  PI-ERC-RESP         PIC X(10).
   635             20  PI-ERC-ACCT         PIC X(10).
   636             20  PI-ERC-TYPE         PIC X.
   637         16  PI-SAVE-ERCOMP-KEY      PIC X(29).
   638         16  PI-SAVE-FAXNO           PIC X(10).
   639         16  PI-SAVE-FAXNO-RED REDEFINES
   640                               PI-SAVE-FAXNO  PIC 9(10).
   641         16  PI-SAVE-ADDR2           PIC X(30).
   642         16  PI-SAVE-CITYST.
   643             20 PI-SAVE-CITY         PIC X(28).
   644             20  PI-SAVE-STATE       PIC XX.
   645         16  PI-SAVE-ACCT-NAME       PIC X(30).
   646         16  PI-EL652-DEL-SW         PIC X.
   647         16  PI-UPDATE-SW            PIC X.
   648             88  PI-CHANGES-MADE                 VALUE '1'.
   649         16  PI-TOTAL-LINES          PIC S99.
   650         16  PI-CURRENT-LINE         PIC S9(3)   COMP-3.
   651         16  PI-TEMP-STOR-ITEMS      PIC S9(4)   COMP.
   652         16  FILLER                  PIC X(453).
   653*                       COPY ELCATTR.
   654******************************************************************
   655*                                                                *
   656*                            ELCATTR.                            *
   657*                            VMOD=2.001                          *
   658*                                                                *
   659*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   660*                                                                *
   661*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   662*                                                                *
   663*                   POS 1   P=PROTECTED                          *
   664*                           U=UNPROTECTED                        *
   665*                           S=ASKIP                              *
   666*                   POS 2   A=ALPHA/NUMERIC                      *
   667*                           N=NUMERIC                            *
   668*                   POS 3   N=NORMAL                             *
   669*                           B=BRIGHT                             *
   670*                           D=DARK                               *
   671*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   672*                           OF=MODIFIED DATA TAG OFF             *
   673*                                                                *
   674*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   675******************************************************************
   676 01  ATTRIBUTE-LIST.
   677     12  AL-PABOF            PIC X       VALUE 'Y'.
   678     12  AL-PABON            PIC X       VALUE 'Z'.
   679     12  AL-PADOF            PIC X       VALUE '%'.
   680     12  AL-PADON            PIC X       VALUE '_'.
   681     12  AL-PANOF            PIC X       VALUE '-'.
   682     12  AL-PANON            PIC X       VALUE '/'.
   683     12  AL-SABOF            PIC X       VALUE '8'.
   684     12  AL-SABON            PIC X       VALUE '9'.
   685     12  AL-SADOF            PIC X       VALUE '@'.
   686     12  AL-SADON            PIC X       VALUE QUOTE.
   687     12  AL-SANOF            PIC X       VALUE '0'.
   688     12  AL-SANON            PIC X       VALUE '1'.
   689     12  AL-UABOF            PIC X       VALUE 'H'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6522.cbl
   690     12  AL-UABON            PIC X       VALUE 'I'.
   691     12  AL-UADOF            PIC X       VALUE '<'.
   692     12  AL-UADON            PIC X       VALUE '('.
   693     12  AL-UANOF            PIC X       VALUE ' '.
   694     12  AL-UANON            PIC X       VALUE 'A'.
   695     12  AL-UNBOF            PIC X       VALUE 'Q'.
   696     12  AL-UNBON            PIC X       VALUE 'R'.
   697     12  AL-UNDOF            PIC X       VALUE '*'.
   698     12  AL-UNDON            PIC X       VALUE ')'.
   699     12  AL-UNNOF            PIC X       VALUE '&'.
   700     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6522.cbl
   702*                       COPY ELCDATE.
   703******************************************************************
   704*                                                                *
   705*                                                                *
   706*                            ELCDATE.                            *
   707*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   708*                            VMOD=2.003
   709*                                                                *
   710*                                                                *
   711*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   712*                 LENGTH = 200                                   *
   713******************************************************************
   714
   715 01  DATE-CONVERSION-DATA.
   716     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   717     12  DC-OPTION-CODE                PIC X.
   718         88  BIN-TO-GREG                VALUE ' '.
   719         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   720         88  EDIT-GREG-TO-BIN           VALUE '2'.
   721         88  YMD-GREG-TO-BIN            VALUE '3'.
   722         88  MDY-GREG-TO-BIN            VALUE '4'.
   723         88  JULIAN-TO-BIN              VALUE '5'.
   724         88  BIN-PLUS-ELAPSED           VALUE '6'.
   725         88  FIND-CENTURY               VALUE '7'.
   726         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   727         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   728         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   729         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   730         88  JULIAN-TO-BIN-3            VALUE 'C'.
   731         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   732         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   733         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   734         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   735         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   736         88  CHECK-LEAP-YEAR            VALUE 'H'.
   737         88  BIN-3-TO-GREG              VALUE 'I'.
   738         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   739         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   740         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   741         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   742         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   743         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   744         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   745         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   746         88  THREE-CHARACTER-BIN
   747                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   748         88  GREGORIAN-TO-BIN
   749                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   750         88  BIN-TO-GREGORIAN
   751                  VALUES ' ' '1' 'I' '8' 'G'.
   752         88  JULIAN-TO-BINARY
   753                  VALUES '5' 'C' 'E' 'F'.
   754     12  DC-ERROR-CODE                 PIC X.
   755         88  NO-CONVERSION-ERROR        VALUE ' '.
   756         88  DATE-CONVERSION-ERROR
   757                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   758         88  DATE-IS-ZERO               VALUE '1'.
   759         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6522.cbl
   760         88  DATE-IS-INVALID            VALUE '3'.
   761         88  DATE1-GREATER-DATE2        VALUE '4'.
   762         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   763         88  DATE-INVALID-OPTION        VALUE '9'.
   764         88  INVALID-CENTURY            VALUE 'A'.
   765         88  ONLY-CENTURY               VALUE 'B'.
   766         88  ONLY-LEAP-YEAR             VALUE 'C'.
   767         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   768     12  DC-END-OF-MONTH               PIC X.
   769         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   770     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   771         88  USE-NORMAL-PROCESS         VALUE ' '.
   772         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   773         88  ADJUST-UP-100-YRS          VALUE '2'.
   774     12  FILLER                        PIC X.
   775     12  DC-CONVERSION-DATES.
   776         16  DC-BIN-DATE-1             PIC XX.
   777         16  DC-BIN-DATE-2             PIC XX.
   778         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   779         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   780                       DC-GREG-DATE-1-EDIT.
   781             20  DC-EDIT1-MONTH        PIC 99.
   782             20  SLASH1-1              PIC X.
   783             20  DC-EDIT1-DAY          PIC 99.
   784             20  SLASH1-2              PIC X.
   785             20  DC-EDIT1-YEAR         PIC 99.
   786         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   787         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   788                     DC-GREG-DATE-2-EDIT.
   789             20  DC-EDIT2-MONTH        PIC 99.
   790             20  SLASH2-1              PIC X.
   791             20  DC-EDIT2-DAY          PIC 99.
   792             20  SLASH2-2              PIC X.
   793             20  DC-EDIT2-YEAR         PIC 99.
   794         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   795         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   796                     DC-GREG-DATE-1-YMD.
   797             20  DC-YMD-YEAR           PIC 99.
   798             20  DC-YMD-MONTH          PIC 99.
   799             20  DC-YMD-DAY            PIC 99.
   800         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   801         16  DC-GREG-DATE-1-MDY-R REDEFINES
   802                      DC-GREG-DATE-1-MDY.
   803             20  DC-MDY-MONTH          PIC 99.
   804             20  DC-MDY-DAY            PIC 99.
   805             20  DC-MDY-YEAR           PIC 99.
   806         16  DC-GREG-DATE-1-ALPHA.
   807             20  DC-ALPHA-MONTH        PIC X(10).
   808             20  DC-ALPHA-DAY          PIC 99.
   809             20  FILLER                PIC XX.
   810             20  DC-ALPHA-CENTURY.
   811                 24 DC-ALPHA-CEN-N     PIC 99.
   812             20  DC-ALPHA-YEAR         PIC 99.
   813         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   814         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   815         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   816         16  DC-JULIAN-DATE            PIC 9(05).
   817         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6522.cbl
   818                                       PIC 9(05).
   819         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   820             20  DC-JULIAN-YEAR        PIC 99.
   821             20  DC-JULIAN-DAYS        PIC 999.
   822         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   823         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   824         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   825     12  DATE-CONVERSION-VARIBLES.
   826         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   827         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   828             20  FILLER                PIC 9(3).
   829             20  HOLD-CEN-1-CCYY.
   830                 24  HOLD-CEN-1-CC     PIC 99.
   831                 24  HOLD-CEN-1-YY     PIC 99.
   832             20  HOLD-CEN-1-MO         PIC 99.
   833             20  HOLD-CEN-1-DA         PIC 99.
   834         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   835             20  HOLD-CEN-1-R-MO       PIC 99.
   836             20  HOLD-CEN-1-R-DA       PIC 99.
   837             20  HOLD-CEN-1-R-CCYY.
   838                 24  HOLD-CEN-1-R-CC   PIC 99.
   839                 24  HOLD-CEN-1-R-YY   PIC 99.
   840             20  FILLER                PIC 9(3).
   841         16  HOLD-CENTURY-1-X.
   842             20  FILLER                PIC X(3)  VALUE SPACES.
   843             20  HOLD-CEN-1-X-CCYY.
   844                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   845                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   846             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   847             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   848         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   849             20  HOLD-CEN-1-R-X-MO     PIC XX.
   850             20  HOLD-CEN-1-R-X-DA     PIC XX.
   851             20  HOLD-CEN-1-R-X-CCYY.
   852                 24  HOLD-CEN-1-R-X-CC PIC XX.
   853                 24  HOLD-CEN-1-R-X-YY PIC XX.
   854             20  FILLER                PIC XXX.
   855         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   856         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   857         16  DC-JULIAN-DATE-1          PIC 9(07).
   858         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   859             20  DC-JULIAN-1-CCYY.
   860                 24  DC-JULIAN-1-CC    PIC 99.
   861                 24  DC-JULIAN-1-YR    PIC 99.
   862             20  DC-JULIAN-DA-1        PIC 999.
   863         16  DC-JULIAN-DATE-2          PIC 9(07).
   864         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   865             20  DC-JULIAN-2-CCYY.
   866                 24  DC-JULIAN-2-CC    PIC 99.
   867                 24  DC-JULIAN-2-YR    PIC 99.
   868             20  DC-JULIAN-DA-2        PIC 999.
   869         16  DC-GREG-DATE-A-EDIT.
   870             20  DC-EDITA-MONTH        PIC 99.
   871             20  SLASHA-1              PIC X VALUE '/'.
   872             20  DC-EDITA-DAY          PIC 99.
   873             20  SLASHA-2              PIC X VALUE '/'.
   874             20  DC-EDITA-CCYY.
   875                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6522.cbl
   876                 24  DC-EDITA-YEAR     PIC 99.
   877         16  DC-GREG-DATE-B-EDIT.
   878             20  DC-EDITB-MONTH        PIC 99.
   879             20  SLASHB-1              PIC X VALUE '/'.
   880             20  DC-EDITB-DAY          PIC 99.
   881             20  SLASHB-2              PIC X VALUE '/'.
   882             20  DC-EDITB-CCYY.
   883                 24  DC-EDITB-CENT     PIC 99.
   884                 24  DC-EDITB-YEAR     PIC 99.
   885         16  DC-GREG-DATE-CYMD         PIC 9(08).
   886         16  DC-GREG-DATE-CYMD-R REDEFINES
   887                              DC-GREG-DATE-CYMD.
   888             20  DC-CYMD-CEN           PIC 99.
   889             20  DC-CYMD-YEAR          PIC 99.
   890             20  DC-CYMD-MONTH         PIC 99.
   891             20  DC-CYMD-DAY           PIC 99.
   892         16  DC-GREG-DATE-MDCY         PIC 9(08).
   893         16  DC-GREG-DATE-MDCY-R REDEFINES
   894                              DC-GREG-DATE-MDCY.
   895             20  DC-MDCY-MONTH         PIC 99.
   896             20  DC-MDCY-DAY           PIC 99.
   897             20  DC-MDCY-CEN           PIC 99.
   898             20  DC-MDCY-YEAR          PIC 99.
   899    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   900        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   901    12  DC-EL310-DATE                  PIC X(21).
   902    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6522.cbl
   904*                       COPY EL6522S.
   905 01  EL6522AI.
   906     05  FILLER            PIC  X(0012).
   907*    -------------------------------
   908     05  DATEL PIC S9(0004) COMP.
   909     05  DATEF PIC  X(0001).
   910     05  FILLER REDEFINES DATEF.
   911         10  DATEA PIC  X(0001).
   912     05  DATEI PIC  X(0008).
   913*    -------------------------------
   914     05  TIMEL PIC S9(0004) COMP.
   915     05  TIMEF PIC  X(0001).
   916     05  FILLER REDEFINES TIMEF.
   917         10  TIMEA PIC  X(0001).
   918     05  TIMEI PIC  X(0005).
   919*    -------------------------------
   920     05  CMPNYIDL PIC S9(0004) COMP.
   921     05  CMPNYIDF PIC  X(0001).
   922     05  FILLER REDEFINES CMPNYIDF.
   923         10  CMPNYIDA PIC  X(0001).
   924     05  CMPNYIDI PIC  X(0003).
   925*    -------------------------------
   926     05  USERIDL PIC S9(0004) COMP.
   927     05  USERIDF PIC  X(0001).
   928     05  FILLER REDEFINES USERIDF.
   929         10  USERIDA PIC  X(0001).
   930     05  USERIDI PIC  X(0004).
   931*    -------------------------------
   932     05  CARRL PIC S9(0004) COMP.
   933     05  CARRF PIC  X(0001).
   934     05  FILLER REDEFINES CARRF.
   935         10  CARRA PIC  X(0001).
   936     05  CARRI PIC  X(0001).
   937*    -------------------------------
   938     05  GROUPL PIC S9(0004) COMP.
   939     05  GROUPF PIC  X(0001).
   940     05  FILLER REDEFINES GROUPF.
   941         10  GROUPA PIC  X(0001).
   942     05  GROUPI PIC  X(0006).
   943*    -------------------------------
   944     05  TYPEL PIC S9(0004) COMP.
   945     05  TYPEF PIC  X(0001).
   946     05  FILLER REDEFINES TYPEF.
   947         10  TYPEA PIC  X(0001).
   948     05  TYPEI PIC  X(0001).
   949*    -------------------------------
   950     05  FINRESPL PIC S9(0004) COMP.
   951     05  FINRESPF PIC  X(0001).
   952     05  FILLER REDEFINES FINRESPF.
   953         10  FINRESPA PIC  X(0001).
   954     05  FINRESPI PIC  X(0010).
   955*    -------------------------------
   956     05  ACCTL PIC S9(0004) COMP.
   957     05  ACCTF PIC  X(0001).
   958     05  FILLER REDEFINES ACCTF.
   959         10  ACCTA PIC  X(0001).
   960     05  ACCTI PIC  X(0010).
   961*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6522.cbl
   962     05  NAMEL PIC S9(0004) COMP.
   963     05  NAMEF PIC  X(0001).
   964     05  FILLER REDEFINES NAMEF.
   965         10  NAMEA PIC  X(0001).
   966     05  NAMEI PIC  X(0030).
   967*    -------------------------------
   968     05  TOTL PIC S9(0004) COMP.
   969     05  TOTF PIC  X(0001).
   970     05  FILLER REDEFINES TOTF.
   971         10  TOTA PIC  X(0001).
   972     05  TOTI PIC  999.
   973*    -------------------------------
   974     05  L1L PIC S9(0004) COMP.
   975     05  L1F PIC  X(0001).
   976     05  FILLER REDEFINES L1F.
   977         10  L1A PIC  X(0001).
   978     05  L1I PIC  X(0003).
   979*    -------------------------------
   980     05  TEXT1L PIC S9(0004) COMP.
   981     05  TEXT1F PIC  X(0001).
   982     05  FILLER REDEFINES TEXT1F.
   983         10  TEXT1A PIC  X(0001).
   984     05  TEXT1I PIC  X(0060).
   985*    -------------------------------
   986     05  MTBY1L PIC S9(0004) COMP.
   987     05  MTBY1F PIC  X(0001).
   988     05  FILLER REDEFINES MTBY1F.
   989         10  MTBY1A PIC  X(0001).
   990     05  MTBY1I PIC  X(0004).
   991*    -------------------------------
   992     05  MTDT1L PIC S9(0004) COMP.
   993     05  MTDT1F PIC  X(0001).
   994     05  FILLER REDEFINES MTDT1F.
   995         10  MTDT1A PIC  X(0001).
   996     05  MTDT1I PIC  X(0006).
   997*    -------------------------------
   998     05  L2L PIC S9(0004) COMP.
   999     05  L2F PIC  X(0001).
  1000     05  FILLER REDEFINES L2F.
  1001         10  L2A PIC  X(0001).
  1002     05  L2I PIC  X(0003).
  1003*    -------------------------------
  1004     05  TEXT2L PIC S9(0004) COMP.
  1005     05  TEXT2F PIC  X(0001).
  1006     05  FILLER REDEFINES TEXT2F.
  1007         10  TEXT2A PIC  X(0001).
  1008     05  TEXT2I PIC  X(0060).
  1009*    -------------------------------
  1010     05  MTBY2L PIC S9(0004) COMP.
  1011     05  MTBY2F PIC  X(0001).
  1012     05  FILLER REDEFINES MTBY2F.
  1013         10  MTBY2A PIC  X(0001).
  1014     05  MTBY2I PIC  X(0004).
  1015*    -------------------------------
  1016     05  MTDT2L PIC S9(0004) COMP.
  1017     05  MTDT2F PIC  X(0001).
  1018     05  FILLER REDEFINES MTDT2F.
  1019         10  MTDT2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6522.cbl
  1020     05  MTDT2I PIC  X(0006).
  1021*    -------------------------------
  1022     05  L3L PIC S9(0004) COMP.
  1023     05  L3F PIC  X(0001).
  1024     05  FILLER REDEFINES L3F.
  1025         10  L3A PIC  X(0001).
  1026     05  L3I PIC  X(0003).
  1027*    -------------------------------
  1028     05  TEXT3L PIC S9(0004) COMP.
  1029     05  TEXT3F PIC  X(0001).
  1030     05  FILLER REDEFINES TEXT3F.
  1031         10  TEXT3A PIC  X(0001).
  1032     05  TEXT3I PIC  X(0060).
  1033*    -------------------------------
  1034     05  MTBY3L PIC S9(0004) COMP.
  1035     05  MTBY3F PIC  X(0001).
  1036     05  FILLER REDEFINES MTBY3F.
  1037         10  MTBY3A PIC  X(0001).
  1038     05  MTBY3I PIC  X(0004).
  1039*    -------------------------------
  1040     05  MTDT3L PIC S9(0004) COMP.
  1041     05  MTDT3F PIC  X(0001).
  1042     05  FILLER REDEFINES MTDT3F.
  1043         10  MTDT3A PIC  X(0001).
  1044     05  MTDT3I PIC  X(0006).
  1045*    -------------------------------
  1046     05  L4L PIC S9(0004) COMP.
  1047     05  L4F PIC  X(0001).
  1048     05  FILLER REDEFINES L4F.
  1049         10  L4A PIC  X(0001).
  1050     05  L4I PIC  X(0003).
  1051*    -------------------------------
  1052     05  TEXT4L PIC S9(0004) COMP.
  1053     05  TEXT4F PIC  X(0001).
  1054     05  FILLER REDEFINES TEXT4F.
  1055         10  TEXT4A PIC  X(0001).
  1056     05  TEXT4I PIC  X(0060).
  1057*    -------------------------------
  1058     05  MTBY4L PIC S9(0004) COMP.
  1059     05  MTBY4F PIC  X(0001).
  1060     05  FILLER REDEFINES MTBY4F.
  1061         10  MTBY4A PIC  X(0001).
  1062     05  MTBY4I PIC  X(0004).
  1063*    -------------------------------
  1064     05  MTDT4L PIC S9(0004) COMP.
  1065     05  MTDT4F PIC  X(0001).
  1066     05  FILLER REDEFINES MTDT4F.
  1067         10  MTDT4A PIC  X(0001).
  1068     05  MTDT4I PIC  X(0006).
  1069*    -------------------------------
  1070     05  L5L PIC S9(0004) COMP.
  1071     05  L5F PIC  X(0001).
  1072     05  FILLER REDEFINES L5F.
  1073         10  L5A PIC  X(0001).
  1074     05  L5I PIC  X(0003).
  1075*    -------------------------------
  1076     05  TEXT5L PIC S9(0004) COMP.
  1077     05  TEXT5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6522.cbl
  1078     05  FILLER REDEFINES TEXT5F.
  1079         10  TEXT5A PIC  X(0001).
  1080     05  TEXT5I PIC  X(0060).
  1081*    -------------------------------
  1082     05  MTBY5L PIC S9(0004) COMP.
  1083     05  MTBY5F PIC  X(0001).
  1084     05  FILLER REDEFINES MTBY5F.
  1085         10  MTBY5A PIC  X(0001).
  1086     05  MTBY5I PIC  X(0004).
  1087*    -------------------------------
  1088     05  MTDT5L PIC S9(0004) COMP.
  1089     05  MTDT5F PIC  X(0001).
  1090     05  FILLER REDEFINES MTDT5F.
  1091         10  MTDT5A PIC  X(0001).
  1092     05  MTDT5I PIC  X(0006).
  1093*    -------------------------------
  1094     05  L6L PIC S9(0004) COMP.
  1095     05  L6F PIC  X(0001).
  1096     05  FILLER REDEFINES L6F.
  1097         10  L6A PIC  X(0001).
  1098     05  L6I PIC  X(0003).
  1099*    -------------------------------
  1100     05  TEXT6L PIC S9(0004) COMP.
  1101     05  TEXT6F PIC  X(0001).
  1102     05  FILLER REDEFINES TEXT6F.
  1103         10  TEXT6A PIC  X(0001).
  1104     05  TEXT6I PIC  X(0060).
  1105*    -------------------------------
  1106     05  MTBY6L PIC S9(0004) COMP.
  1107     05  MTBY6F PIC  X(0001).
  1108     05  FILLER REDEFINES MTBY6F.
  1109         10  MTBY6A PIC  X(0001).
  1110     05  MTBY6I PIC  X(0004).
  1111*    -------------------------------
  1112     05  MTDT6L PIC S9(0004) COMP.
  1113     05  MTDT6F PIC  X(0001).
  1114     05  FILLER REDEFINES MTDT6F.
  1115         10  MTDT6A PIC  X(0001).
  1116     05  MTDT6I PIC  X(0006).
  1117*    -------------------------------
  1118     05  L7L PIC S9(0004) COMP.
  1119     05  L7F PIC  X(0001).
  1120     05  FILLER REDEFINES L7F.
  1121         10  L7A PIC  X(0001).
  1122     05  L7I PIC  X(0003).
  1123*    -------------------------------
  1124     05  TEXT7L PIC S9(0004) COMP.
  1125     05  TEXT7F PIC  X(0001).
  1126     05  FILLER REDEFINES TEXT7F.
  1127         10  TEXT7A PIC  X(0001).
  1128     05  TEXT7I PIC  X(0060).
  1129*    -------------------------------
  1130     05  MTBY7L PIC S9(0004) COMP.
  1131     05  MTBY7F PIC  X(0001).
  1132     05  FILLER REDEFINES MTBY7F.
  1133         10  MTBY7A PIC  X(0001).
  1134     05  MTBY7I PIC  X(0004).
  1135*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6522.cbl
  1136     05  MTDT7L PIC S9(0004) COMP.
  1137     05  MTDT7F PIC  X(0001).
  1138     05  FILLER REDEFINES MTDT7F.
  1139         10  MTDT7A PIC  X(0001).
  1140     05  MTDT7I PIC  X(0006).
  1141*    -------------------------------
  1142     05  L8L PIC S9(0004) COMP.
  1143     05  L8F PIC  X(0001).
  1144     05  FILLER REDEFINES L8F.
  1145         10  L8A PIC  X(0001).
  1146     05  L8I PIC  X(0003).
  1147*    -------------------------------
  1148     05  TEXT8L PIC S9(0004) COMP.
  1149     05  TEXT8F PIC  X(0001).
  1150     05  FILLER REDEFINES TEXT8F.
  1151         10  TEXT8A PIC  X(0001).
  1152     05  TEXT8I PIC  X(0060).
  1153*    -------------------------------
  1154     05  MTBY8L PIC S9(0004) COMP.
  1155     05  MTBY8F PIC  X(0001).
  1156     05  FILLER REDEFINES MTBY8F.
  1157         10  MTBY8A PIC  X(0001).
  1158     05  MTBY8I PIC  X(0004).
  1159*    -------------------------------
  1160     05  MTDT8L PIC S9(0004) COMP.
  1161     05  MTDT8F PIC  X(0001).
  1162     05  FILLER REDEFINES MTDT8F.
  1163         10  MTDT8A PIC  X(0001).
  1164     05  MTDT8I PIC  X(0006).
  1165*    -------------------------------
  1166     05  L9L PIC S9(0004) COMP.
  1167     05  L9F PIC  X(0001).
  1168     05  FILLER REDEFINES L9F.
  1169         10  L9A PIC  X(0001).
  1170     05  L9I PIC  X(0003).
  1171*    -------------------------------
  1172     05  TEXT9L PIC S9(0004) COMP.
  1173     05  TEXT9F PIC  X(0001).
  1174     05  FILLER REDEFINES TEXT9F.
  1175         10  TEXT9A PIC  X(0001).
  1176     05  TEXT9I PIC  X(0060).
  1177*    -------------------------------
  1178     05  MTBY9L PIC S9(0004) COMP.
  1179     05  MTBY9F PIC  X(0001).
  1180     05  FILLER REDEFINES MTBY9F.
  1181         10  MTBY9A PIC  X(0001).
  1182     05  MTBY9I PIC  X(0004).
  1183*    -------------------------------
  1184     05  MTDT9L PIC S9(0004) COMP.
  1185     05  MTDT9F PIC  X(0001).
  1186     05  FILLER REDEFINES MTDT9F.
  1187         10  MTDT9A PIC  X(0001).
  1188     05  MTDT9I PIC  X(0006).
  1189*    -------------------------------
  1190     05  L10L PIC S9(0004) COMP.
  1191     05  L10F PIC  X(0001).
  1192     05  FILLER REDEFINES L10F.
  1193         10  L10A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6522.cbl
  1194     05  L10I PIC  X(0003).
  1195*    -------------------------------
  1196     05  TEXT10L PIC S9(0004) COMP.
  1197     05  TEXT10F PIC  X(0001).
  1198     05  FILLER REDEFINES TEXT10F.
  1199         10  TEXT10A PIC  X(0001).
  1200     05  TEXT10I PIC  X(0060).
  1201*    -------------------------------
  1202     05  MTBY10L PIC S9(0004) COMP.
  1203     05  MTBY10F PIC  X(0001).
  1204     05  FILLER REDEFINES MTBY10F.
  1205         10  MTBY10A PIC  X(0001).
  1206     05  MTBY10I PIC  X(0004).
  1207*    -------------------------------
  1208     05  MTDT10L PIC S9(0004) COMP.
  1209     05  MTDT10F PIC  X(0001).
  1210     05  FILLER REDEFINES MTDT10F.
  1211         10  MTDT10A PIC  X(0001).
  1212     05  MTDT10I PIC  X(0006).
  1213*    -------------------------------
  1214     05  L11L PIC S9(0004) COMP.
  1215     05  L11F PIC  X(0001).
  1216     05  FILLER REDEFINES L11F.
  1217         10  L11A PIC  X(0001).
  1218     05  L11I PIC  X(0003).
  1219*    -------------------------------
  1220     05  TEXT11L PIC S9(0004) COMP.
  1221     05  TEXT11F PIC  X(0001).
  1222     05  FILLER REDEFINES TEXT11F.
  1223         10  TEXT11A PIC  X(0001).
  1224     05  TEXT11I PIC  X(0060).
  1225*    -------------------------------
  1226     05  MTBY11L PIC S9(0004) COMP.
  1227     05  MTBY11F PIC  X(0001).
  1228     05  FILLER REDEFINES MTBY11F.
  1229         10  MTBY11A PIC  X(0001).
  1230     05  MTBY11I PIC  X(0004).
  1231*    -------------------------------
  1232     05  MTDT11L PIC S9(0004) COMP.
  1233     05  MTDT11F PIC  X(0001).
  1234     05  FILLER REDEFINES MTDT11F.
  1235         10  MTDT11A PIC  X(0001).
  1236     05  MTDT11I PIC  X(0006).
  1237*    -------------------------------
  1238     05  L12L PIC S9(0004) COMP.
  1239     05  L12F PIC  X(0001).
  1240     05  FILLER REDEFINES L12F.
  1241         10  L12A PIC  X(0001).
  1242     05  L12I PIC  X(0003).
  1243*    -------------------------------
  1244     05  TEXT12L PIC S9(0004) COMP.
  1245     05  TEXT12F PIC  X(0001).
  1246     05  FILLER REDEFINES TEXT12F.
  1247         10  TEXT12A PIC  X(0001).
  1248     05  TEXT12I PIC  X(0060).
  1249*    -------------------------------
  1250     05  MTBY12L PIC S9(0004) COMP.
  1251     05  MTBY12F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6522.cbl
  1252     05  FILLER REDEFINES MTBY12F.
  1253         10  MTBY12A PIC  X(0001).
  1254     05  MTBY12I PIC  X(0004).
  1255*    -------------------------------
  1256     05  MTDT12L PIC S9(0004) COMP.
  1257     05  MTDT12F PIC  X(0001).
  1258     05  FILLER REDEFINES MTDT12F.
  1259         10  MTDT12A PIC  X(0001).
  1260     05  MTDT12I PIC  X(0006).
  1261*    -------------------------------
  1262     05  ERRMSGBL PIC S9(0004) COMP.
  1263     05  ERRMSGBF PIC  X(0001).
  1264     05  FILLER REDEFINES ERRMSGBF.
  1265         10  ERRMSGBA PIC  X(0001).
  1266     05  ERRMSGBI PIC  X(0072).
  1267*    -------------------------------
  1268     05  FUNCTL PIC S9(0004) COMP.
  1269     05  FUNCTF PIC  X(0001).
  1270     05  FILLER REDEFINES FUNCTF.
  1271         10  FUNCTA PIC  X(0001).
  1272     05  FUNCTI PIC  X(0001).
  1273*    -------------------------------
  1274     05  LINE1L PIC S9(0004) COMP.
  1275     05  LINE1F PIC  X(0001).
  1276     05  FILLER REDEFINES LINE1F.
  1277         10  LINE1A PIC  X(0001).
  1278     05  LINE1I PIC  999.
  1279*    -------------------------------
  1280     05  LINE2L PIC S9(0004) COMP.
  1281     05  LINE2F PIC  X(0001).
  1282     05  FILLER REDEFINES LINE2F.
  1283         10  LINE2A PIC  X(0001).
  1284     05  LINE2I PIC  999.
  1285*    -------------------------------
  1286     05  PFENTERL PIC S9(0004) COMP.
  1287     05  PFENTERF PIC  X(0001).
  1288     05  FILLER REDEFINES PFENTERF.
  1289         10  PFENTERA PIC  X(0001).
  1290     05  PFENTERI PIC  99.
  1291 01  EL6522AO REDEFINES EL6522AI.
  1292     05  FILLER            PIC  X(0012).
  1293*    -------------------------------
  1294     05  FILLER            PIC  X(0003).
  1295     05  DATEO PIC  X(0008).
  1296*    -------------------------------
  1297     05  FILLER            PIC  X(0003).
  1298     05  TIMEO PIC  99.99.
  1299*    -------------------------------
  1300     05  FILLER            PIC  X(0003).
  1301     05  CMPNYIDO PIC  X(0003).
  1302*    -------------------------------
  1303     05  FILLER            PIC  X(0003).
  1304     05  USERIDO PIC  X(0004).
  1305*    -------------------------------
  1306     05  FILLER            PIC  X(0003).
  1307     05  CARRO PIC  X(0001).
  1308*    -------------------------------
  1309     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6522.cbl
  1310     05  GROUPO PIC  X(0006).
  1311*    -------------------------------
  1312     05  FILLER            PIC  X(0003).
  1313     05  TYPEO PIC  X(0001).
  1314*    -------------------------------
  1315     05  FILLER            PIC  X(0003).
  1316     05  FINRESPO PIC  X(0010).
  1317*    -------------------------------
  1318     05  FILLER            PIC  X(0003).
  1319     05  ACCTO PIC  X(0010).
  1320*    -------------------------------
  1321     05  FILLER            PIC  X(0003).
  1322     05  NAMEO PIC  X(0030).
  1323*    -------------------------------
  1324     05  FILLER            PIC  X(0003).
  1325     05  TOTO PIC  X(0003).
  1326*    -------------------------------
  1327     05  FILLER            PIC  X(0003).
  1328     05  L1O PIC  X(0003).
  1329*    -------------------------------
  1330     05  FILLER            PIC  X(0003).
  1331     05  TEXT1O PIC  X(0060).
  1332*    -------------------------------
  1333     05  FILLER            PIC  X(0003).
  1334     05  MTBY1O PIC  X(0004).
  1335*    -------------------------------
  1336     05  FILLER            PIC  X(0003).
  1337     05  MTDT1O PIC  X(0006).
  1338*    -------------------------------
  1339     05  FILLER            PIC  X(0003).
  1340     05  L2O PIC  X(0003).
  1341*    -------------------------------
  1342     05  FILLER            PIC  X(0003).
  1343     05  TEXT2O PIC  X(0060).
  1344*    -------------------------------
  1345     05  FILLER            PIC  X(0003).
  1346     05  MTBY2O PIC  X(0004).
  1347*    -------------------------------
  1348     05  FILLER            PIC  X(0003).
  1349     05  MTDT2O PIC  X(0006).
  1350*    -------------------------------
  1351     05  FILLER            PIC  X(0003).
  1352     05  L3O PIC  X(0003).
  1353*    -------------------------------
  1354     05  FILLER            PIC  X(0003).
  1355     05  TEXT3O PIC  X(0060).
  1356*    -------------------------------
  1357     05  FILLER            PIC  X(0003).
  1358     05  MTBY3O PIC  X(0004).
  1359*    -------------------------------
  1360     05  FILLER            PIC  X(0003).
  1361     05  MTDT3O PIC  X(0006).
  1362*    -------------------------------
  1363     05  FILLER            PIC  X(0003).
  1364     05  L4O PIC  X(0003).
  1365*    -------------------------------
  1366     05  FILLER            PIC  X(0003).
  1367     05  TEXT4O PIC  X(0060).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6522.cbl
  1368*    -------------------------------
  1369     05  FILLER            PIC  X(0003).
  1370     05  MTBY4O PIC  X(0004).
  1371*    -------------------------------
  1372     05  FILLER            PIC  X(0003).
  1373     05  MTDT4O PIC  X(0006).
  1374*    -------------------------------
  1375     05  FILLER            PIC  X(0003).
  1376     05  L5O PIC  X(0003).
  1377*    -------------------------------
  1378     05  FILLER            PIC  X(0003).
  1379     05  TEXT5O PIC  X(0060).
  1380*    -------------------------------
  1381     05  FILLER            PIC  X(0003).
  1382     05  MTBY5O PIC  X(0004).
  1383*    -------------------------------
  1384     05  FILLER            PIC  X(0003).
  1385     05  MTDT5O PIC  X(0006).
  1386*    -------------------------------
  1387     05  FILLER            PIC  X(0003).
  1388     05  L6O PIC  X(0003).
  1389*    -------------------------------
  1390     05  FILLER            PIC  X(0003).
  1391     05  TEXT6O PIC  X(0060).
  1392*    -------------------------------
  1393     05  FILLER            PIC  X(0003).
  1394     05  MTBY6O PIC  X(0004).
  1395*    -------------------------------
  1396     05  FILLER            PIC  X(0003).
  1397     05  MTDT6O PIC  X(0006).
  1398*    -------------------------------
  1399     05  FILLER            PIC  X(0003).
  1400     05  L7O PIC  X(0003).
  1401*    -------------------------------
  1402     05  FILLER            PIC  X(0003).
  1403     05  TEXT7O PIC  X(0060).
  1404*    -------------------------------
  1405     05  FILLER            PIC  X(0003).
  1406     05  MTBY7O PIC  X(0004).
  1407*    -------------------------------
  1408     05  FILLER            PIC  X(0003).
  1409     05  MTDT7O PIC  X(0006).
  1410*    -------------------------------
  1411     05  FILLER            PIC  X(0003).
  1412     05  L8O PIC  X(0003).
  1413*    -------------------------------
  1414     05  FILLER            PIC  X(0003).
  1415     05  TEXT8O PIC  X(0060).
  1416*    -------------------------------
  1417     05  FILLER            PIC  X(0003).
  1418     05  MTBY8O PIC  X(0004).
  1419*    -------------------------------
  1420     05  FILLER            PIC  X(0003).
  1421     05  MTDT8O PIC  X(0006).
  1422*    -------------------------------
  1423     05  FILLER            PIC  X(0003).
  1424     05  L9O PIC  X(0003).
  1425*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6522.cbl
  1426     05  FILLER            PIC  X(0003).
  1427     05  TEXT9O PIC  X(0060).
  1428*    -------------------------------
  1429     05  FILLER            PIC  X(0003).
  1430     05  MTBY9O PIC  X(0004).
  1431*    -------------------------------
  1432     05  FILLER            PIC  X(0003).
  1433     05  MTDT9O PIC  X(0006).
  1434*    -------------------------------
  1435     05  FILLER            PIC  X(0003).
  1436     05  L10O PIC  X(0003).
  1437*    -------------------------------
  1438     05  FILLER            PIC  X(0003).
  1439     05  TEXT10O PIC  X(0060).
  1440*    -------------------------------
  1441     05  FILLER            PIC  X(0003).
  1442     05  MTBY10O PIC  X(0004).
  1443*    -------------------------------
  1444     05  FILLER            PIC  X(0003).
  1445     05  MTDT10O PIC  X(0006).
  1446*    -------------------------------
  1447     05  FILLER            PIC  X(0003).
  1448     05  L11O PIC  X(0003).
  1449*    -------------------------------
  1450     05  FILLER            PIC  X(0003).
  1451     05  TEXT11O PIC  X(0060).
  1452*    -------------------------------
  1453     05  FILLER            PIC  X(0003).
  1454     05  MTBY11O PIC  X(0004).
  1455*    -------------------------------
  1456     05  FILLER            PIC  X(0003).
  1457     05  MTDT11O PIC  X(0006).
  1458*    -------------------------------
  1459     05  FILLER            PIC  X(0003).
  1460     05  L12O PIC  X(0003).
  1461*    -------------------------------
  1462     05  FILLER            PIC  X(0003).
  1463     05  TEXT12O PIC  X(0060).
  1464*    -------------------------------
  1465     05  FILLER            PIC  X(0003).
  1466     05  MTBY12O PIC  X(0004).
  1467*    -------------------------------
  1468     05  FILLER            PIC  X(0003).
  1469     05  MTDT12O PIC  X(0006).
  1470*    -------------------------------
  1471     05  FILLER            PIC  X(0003).
  1472     05  ERRMSGBO PIC  X(0072).
  1473*    -------------------------------
  1474     05  FILLER            PIC  X(0003).
  1475     05  FUNCTO PIC  X(0001).
  1476*    -------------------------------
  1477     05  FILLER            PIC  X(0003).
  1478     05  LINE1O PIC  X(0003).
  1479*    -------------------------------
  1480     05  FILLER            PIC  X(0003).
  1481     05  LINE2O PIC  X(0003).
  1482*    -------------------------------
  1483     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6522.cbl
  1484     05  PFENTERO PIC  X(0002).
  1485*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6522.cbl
  1487 01  EL6522R REDEFINES EL6522AI.
  1488     12  FILLER                      PIC X(126).
  1489     12  SC-ALL-LINES.
  1490      14 SC-LINES OCCURS 12 TIMES INDEXED BY SC-INDX.
  1491         16  SC-LINL                 PIC S9(4)   COMP.
  1492         16  SC-LINA                 PIC X.
  1493         16  SC-LIN                  PIC Z99.
  1494         16  SC-TEXTL                PIC S9(4)   COMP.
  1495         16  SC-TEXTA                PIC X.
  1496         16  SC-TEXT                 PIC X(60).
  1497         16  SC-MAINT-BYL            PIC S9(4)   COMP.
  1498         16  SC-MAINT-BYA            PIC X.
  1499         16  SC-MAINT-BY             PIC XXXX.
  1500         16  SC-MAINT-DTL            PIC S9(4)   COMP.
  1501         16  SC-MAINT-DTA            PIC X.
  1502         16  SC-MAINT-DT             PIC X(6).
  1503     12  FILLER                      PIC X(23).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6522.cbl
  1505 01  RECORD-TABLE                    PIC X(21600) VALUE SPACES.
  1506 01  REC-TABLE  REDEFINES RECORD-TABLE.
  1507     12  TS-GROUP OCCURS 6 TIMES INDEXED BY TS-INDX PIC X(3600).
  1508 01  REC-ENTRIES REDEFINES RECORD-TABLE.
  1509     12  REC-ENT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
  1510         16  REC-TEXT                PIC X(60).
  1511         16  REC-LAST-MAINT-BY       PIC XXXX.
  1512         16  REC-LAST-MAINT-DT       PIC XX.
  1513         16  REC-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
  1514         16  REC-PC                  PIC X(2).
  1515
  1516 01  TS-WORK-AREA                    PIC X(3600).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6522.cbl
  1518
  1519****************************************************************
  1520*
  1521* Copyright (c) 2007 by Clerity Solutions, Inc.
  1522* All rights reserved.
  1523*
  1524****************************************************************
  1525 01  DFHEIV.
  1526   02  DFHEIV0               PIC X(35).
  1527   02  DFHEIV1               PIC X(08).
  1528   02  DFHEIV2               PIC X(08).
  1529   02  DFHEIV3               PIC X(08).
  1530   02  DFHEIV4               PIC X(06).
  1531   02  DFHEIV5               PIC X(04).
  1532   02  DFHEIV6               PIC X(04).
  1533   02  DFHEIV7               PIC X(02).
  1534   02  DFHEIV8               PIC X(02).
  1535   02  DFHEIV9               PIC X(01).
  1536   02  DFHEIV10              PIC S9(7) COMP-3.
  1537   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1538   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1539   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1540   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1541   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1542   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1543   02  DFHEIV17              PIC X(04).
  1544   02  DFHEIV18              PIC X(04).
  1545   02  DFHEIV19              PIC X(04).
  1546   02  DFHEIV20              USAGE IS POINTER.
  1547   02  DFHEIV21              USAGE IS POINTER.
  1548   02  DFHEIV22              USAGE IS POINTER.
  1549   02  DFHEIV23              USAGE IS POINTER.
  1550   02  DFHEIV24              USAGE IS POINTER.
  1551   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1552   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1553   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1554   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1555   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1556   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1557   02  FILLER                PIC X(02).
  1558   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1559   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1560   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1561   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1562   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1563 LINKAGE  SECTION.
  1564*****************************************************************
  1565*                                                               *
  1566* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1567* All rights reserved.                                          *
  1568*                                                               *
  1569*****************************************************************
  1570 01  dfheiblk.
  1571     02  eibtime          pic s9(7) comp-3.
  1572     02  eibdate          pic s9(7) comp-3.
  1573     02  eibtrnid         pic x(4).
  1574     02  eibtaskn         pic s9(7) comp-3.
  1575     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6522.cbl
  1576     02  dfheigdi         pic s9(4) comp.
  1577     02  eibcposn         pic s9(4) comp.
  1578     02  eibcalen         pic s9(4) comp.
  1579     02  eibaid           pic x(1).
  1580     02  eibfiller1       pic x(1).
  1581     02  eibfn            pic x(2).
  1582     02  eibfiller2       pic x(2).
  1583     02  eibrcode         pic x(6).
  1584     02  eibfiller3       pic x(2).
  1585     02  eibds            pic x(8).
  1586     02  eibreqid         pic x(8).
  1587     02  eibrsrce         pic x(8).
  1588     02  eibsync          pic x(1).
  1589     02  eibfree          pic x(1).
  1590     02  eibrecv          pic x(1).
  1591     02  eibsend          pic x(1).
  1592     02  eibatt           pic x(1).
  1593     02  eibeoc           pic x(1).
  1594     02  eibfmh           pic x(1).
  1595     02  eibcompl         pic x(1).
  1596     02  eibsig           pic x(1).
  1597     02  eibconf          pic x(1).
  1598     02  eiberr           pic x(1).
  1599     02  eibrldbk         pic x(1).
  1600     02  eiberrcd         pic x(4).
  1601     02  eibsynrb         pic x(1).
  1602     02  eibnodat         pic x(1).
  1603     02  eibfiller5       pic x(2).
  1604     02  eibresp          pic 9(09) comp.
  1605     02  eibresp2         pic 9(09) comp.
  1606     02  dfheigdj         pic s9(4) comp.
  1607     02  dfheigdk         pic s9(4) comp.
  1608 01  DFHCOMMAREA                     PIC X(1500).
  1609
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6522.cbl
  1611*                       COPY ERCCOMP.
  1612******************************************************************
  1613*                                                                *
  1614*                                                                *
  1615*                            ERCCOMP                             *
  1616*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1617*                            VMOD=2.019                          *
  1618*                                                                *
  1619*   ONLINE CREDIT SYSTEM                                         *
  1620*                                                                *
  1621*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  1622*                                                                *
  1623*   FILE TYPE = VSAM,KSDS                                        *
  1624*   RECORD SIZE = 700   RECFORM = FIXED                          *
  1625*                                                                *
  1626*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  1627*       ALTERNATE PATH = NONE                                    *
  1628*                                                                *
  1629*   LOG = NO                                                     *
  1630*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1631*                                                                *
  1632******************************************************************
  1633*                   C H A N G E   L O G
  1634*
  1635* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1636*-----------------------------------------------------------------
  1637*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1638* EFFECTIVE    NUMBER
  1639*-----------------------------------------------------------------
  1640* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1641* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  1642* 092205    2005050300006  PEMA  ADD LEASE FEE
  1643* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  1644* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  1645* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  1646* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1647* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  1648******************************************************************
  1649
  1650 01  COMPENSATION-MASTER.
  1651     12  CO-RECORD-ID                          PIC XX.
  1652         88  VALID-CO-ID                          VALUE 'CO'.
  1653
  1654     12  CO-CONTROL-PRIMARY.
  1655         16  CO-COMPANY-CD                     PIC X.
  1656         16  CO-CONTROL.
  1657             20  CO-CTL-1.
  1658                 24  CO-CARR-GROUP.
  1659                     28  CO-CARRIER            PIC X.
  1660                     28  CO-GROUPING.
  1661                         32  CO-GROUP-PREFIX   PIC XXX.
  1662                         32  CO-GROUP-PRIME    PIC XXX.
  1663                 24  CO-RESP-NO.
  1664                     28  CO-RESP-PREFIX        PIC X(4).
  1665                     28  CO-RESP-PRIME         PIC X(6).
  1666             20  CO-CTL-2.
  1667                 24  CO-ACCOUNT.
  1668                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6522.cbl
  1669                     28  CO-ACCT-PRIME         PIC X(6).
  1670         16  CO-TYPE                           PIC X.
  1671             88  CO-COMPANY-TYPE                  VALUE 'C'.
  1672             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  1673             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  1674
  1675     12  CO-MAINT-INFORMATION.
  1676         16  CO-LAST-MAINT-DT                  PIC XX.
  1677         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  1678         16  CO-LAST-MAINT-USER                PIC X(4).
  1679     12  FILLER                                PIC XX.
  1680     12  CO-STMT-TYPE                          PIC XXX.
  1681     12  CO-COMP-TYPE                          PIC X.
  1682         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  1683     12  CO-STMT-OWNER                         PIC X(4).
  1684     12  CO-BALANCE-CONTROL                    PIC X.
  1685         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  1686         88  CO-NO-BALANCE                        VALUE 'N'.
  1687
  1688     12  CO-INTERNAL-CONTROL-1                 PIC X.
  1689         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  1690         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  1691         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  1692
  1693     12  CO-INTERNAL-CONTROL-2                 PIC X.
  1694         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  1695         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  1696
  1697     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  1698     12  CO-GA-DIRECT-DEP                      PIC X.
  1699     12  CO-FUTURE-SPACE                       PIC X.
  1700         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  1701
  1702     12  CO-ACCT-NAME                          PIC X(30).
  1703     12  CO-MAIL-NAME                          PIC X(30).
  1704     12  CO-ADDR-1                             PIC X(30).
  1705     12  CO-ADDR-2                             PIC X(30).
  1706     12  CO-ADDR-3.
  1707         16  CO-ADDR-CITY                      PIC X(27).
  1708         16  CO-ADDR-STATE                     PIC XX.
  1709     12  CO-CSO-1099                           PIC X.
  1710     12  CO-ZIP.
  1711         16  CO-ZIP-PRIME.
  1712             20  CO-ZIP-PRI-1ST                PIC X.
  1713                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1714             20  FILLER                        PIC X(4).
  1715         16  CO-ZIP-PLUS4                      PIC X(4).
  1716     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  1717         16  CO-CAN-POSTAL-1                   PIC XXX.
  1718         16  CO-CAN-POSTAL-2                   PIC XXX.
  1719         16  FILLER                            PIC XXX.
  1720     12  CO-SOC-SEC                            PIC X(13).
  1721     12  CO-TELEPHONE.
  1722         16  CO-AREA-CODE                      PIC XXX.
  1723         16  CO-PREFIX                         PIC XXX.
  1724         16  CO-PHONE                          PIC X(4).
  1725
  1726     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6522.cbl
  1727
  1728     12  CO-AR-BAL-LEVEL                       PIC X.
  1729         88  CO-AR-REF-LVL                        VALUE '1'.
  1730         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  1731         88  CO-AR-BILL-LVL                       VALUE '2'.
  1732         88  CO-AR-AGT-LVL                        VALUE '3'.
  1733         88  CO-AR-FR-LVL                         VALUE '4'.
  1734
  1735     12  CO-AR-NORMAL-PRINT                    PIC X.
  1736         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  1737         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  1738
  1739     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  1740
  1741     12  CO-AR-REPORTING                       PIC X.
  1742         88  CO-AR-NET-REPORT                     VALUE 'N'.
  1743         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  1744
  1745     12  CO-AR-PULL-CHECK                      PIC X.
  1746         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  1747         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  1748
  1749     12  CO-AR-BALANCE-PRINT                   PIC X.
  1750         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  1751
  1752     12  CO-AR-LAST-RUN-CODE                   PIC X.
  1753         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  1754         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  1755         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  1756
  1757     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  1758
  1759     12  CO-USER-CODE                          PIC X.
  1760     12  CO-REPORT-GROUP-ID                    PIC X(12).
  1761
  1762******************************************************************
  1763*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  1764*    THE LAST MONTH END RUN.
  1765******************************************************************
  1766
  1767     12  CO-LAST-ACTIVITY-DATE.
  1768         16  CO-ACT-YEAR                       PIC 99.
  1769         16  CO-ACT-MONTH                      PIC 99.
  1770         16  CO-ACT-DAY                        PIC 99.
  1771
  1772     12  CO-LAST-STMT-DT.
  1773         16  CO-LAST-STMT-YEAR                 PIC 99.
  1774         16  CO-LAST-STMT-MONTH                PIC 99.
  1775         16  CO-LAST-STMT-DAY                  PIC 99.
  1776
  1777     12  CO-MO-END-TOTALS.
  1778         16  CO-MONTHLY-TOTALS.
  1779             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  1780             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  1781             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  1782             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  1783             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  1784
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6522.cbl
  1785         16  CO-AGING-TOTALS.
  1786             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  1787             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  1788             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  1789             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  1790
  1791         16  CO-YTD-TOTALS.
  1792             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  1793             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  1794
  1795         16  CO-OVER-UNDER-TOTALS.
  1796             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1797             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  1798
  1799     12  CO-MISCELLANEOUS-TOTALS.
  1800         16  CO-FICA-TOTALS.
  1801             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  1802             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  1803
  1804         16  CO-CLAIM-TOTALS.
  1805             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  1806             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  1807
  1808******************************************************************
  1809*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  1810*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  1811******************************************************************
  1812
  1813     12  CO-CURRENT-TOTALS.
  1814         16  CO-CURRENT-LAST-STMT-DT.
  1815             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  1816             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  1817             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  1818
  1819         16  CO-CURRENT-MONTHLY-TOTALS.
  1820             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  1821             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  1822             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  1823             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  1824             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  1825
  1826         16  CO-CURRENT-AGING-TOTALS.
  1827             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  1828             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  1829             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  1830             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  1831
  1832         16  CO-CURRENT-YTD-TOTALS.
  1833             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  1834             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  1835
  1836     12  CO-PAID-COMM-TOTALS.
  1837         16  CO-YTD-PAID-COMMS.
  1838             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  1839             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  1840
  1841     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  1842         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6522.cbl
  1843         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  1844
  1845     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  1846         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  1847         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  1848         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  1849         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  1850         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  1851         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  1852         88  CO-FINAL-LETTER                  VALUE 'F'.
  1853         88  CO-RECONCILING                   VALUE 'R'.
  1854         88  CO-PHONE-CALL                    VALUE 'P'.
  1855         88  CO-LEGAL                         VALUE 'L'.
  1856         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  1857         88  CO-WRITE-OFF                     VALUE 'W'.
  1858         88  CO-NO-ACTION                     VALUE 'N' ' '.
  1859
  1860     12  CO-CSR-CODE                       PIC X(4).
  1861
  1862     12  CO-GA-STATUS-INFO.
  1863         16  CO-GA-EFFECTIVE-DT            PIC XX.
  1864         16  CO-GA-TERMINATION-DT          PIC XX.
  1865         16  CO-GA-STATUS-CODE             PIC X.
  1866             88  CO-GA-ACTIVE                 VALUE 'A'.
  1867             88  CO-GA-INACTIVE               VALUE 'I'.
  1868             88  CO-GA-PENDING                VALUE 'P'.
  1869         16  CO-GA-COMMENTS.
  1870             20  CO-GA-COMMENT-1           PIC X(40).
  1871             20  CO-GA-COMMENT-2           PIC X(40).
  1872             20  CO-GA-COMMENT-3           PIC X(40).
  1873             20  CO-GA-COMMENT-4           PIC X(40).
  1874
  1875     12  CO-RPTCD2                         PIC X(10).
  1876
  1877     12  CO-TYPE-AGENT                     PIC X(01).
  1878         88  CO-CORPORATION                   VALUE 'C'.
  1879         88  CO-PARTNERSHIP                   VALUE 'P'.
  1880         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  1881         88  CO-TRUST                         VALUE 'T'.
  1882         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  1883
  1884     12  CO-FAXNO.
  1885         16  CO-FAX-AREA-CODE                  PIC XXX.
  1886         16  CO-FAX-PREFIX                     PIC XXX.
  1887         16  CO-FAX-PHONE                      PIC X(4).
  1888
  1889     12  CO-BANK-INFORMATION.
  1890         16  CO-BANK-TRANSIT-NO                PIC X(8).
  1891         16  CO-BANK-TRANSIT-NON REDEFINES
  1892             CO-BANK-TRANSIT-NO                PIC 9(8).
  1893
  1894         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  1895     12  CO-MISC-DEDUCT-INFO REDEFINES
  1896                  CO-BANK-INFORMATION.
  1897         16  CO-MD-GL-ACCT                     PIC X(10).
  1898         16  CO-MD-DIV                         PIC XX.
  1899         16  CO-MD-CENTER                      PIC X(4).
  1900         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6522.cbl
  1901         16  CO-CREATE-AP-CHECK                PIC X.
  1902         16  CO-DELIVER-CK-TO-MEL              PIC X.
  1903         16  FILLER                            PIC XXX.
  1904     12  CO-ACH-STATUS                         PIC X.
  1905         88  CO-ACH-ACTIVE                         VALUE 'A'.
  1906         88  CO-ACH-PENDING                        VALUE 'P'.
  1907
  1908     12  CO-BILL-SW                            PIC X.
  1909     12  CO-CONTROL-NAME                       PIC X(30).
  1910     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  1911     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  1912     12  CO-CLP-STATE                          PIC XX.
  1913     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  1914     12  CO-SPP-REFUND-EDIT                    PIC X.
  1915
  1916******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6522.cbl
  1918*                       COPY ERCCONT.
  1919******************************************************************
  1920*                                                                *
  1921*                                                                *
  1922*                            ERCCONT.
  1923*                                                                *
  1924*   FILE DESCRIPTION = NOTE FILE FOR COMPENSATION MASTER
  1925*                                                                *
  1926*   FILE TYPE = VSAM,KSDS                                        *
  1927*   RECORD SIZE = 128   RECFORM = FIXED                          *
  1928*                                                                *
  1929*   BASE CLUSTER NAME = ERCONT             RKP=2,LEN=31          *
  1930*       ALTERNATE INDEX = NONE                                   *
  1931*                                                                *
  1932*                                                                *
  1933*   LOG = YES                                                    *
  1934*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1935******************************************************************
  1936 01  COMP-NOTE-FILE.
  1937     12  NF-FILE-ID                  PIC X(02).
  1938         88  VALID-NOTE-ID                       VALUE 'NF'.
  1939
  1940     12  NF-CONTROL-PRIMARY.
  1941         16  NF-COMPANY-CD           PIC X(01).
  1942         16  NF-COMP-NOTE-KEY.
  1943             18  NF-CARRIER          PIC X(01).
  1944             18  NF-GROUPING         PIC X(06).
  1945             18  NF-FIN-RESP-NO      PIC X(10).
  1946             18  NF-ACCOUNT          PIC X(10).
  1947         16  NF-RECORD-TYPE          PIC X(01).
  1948             88  GA-NOTE                         VALUE 'G'.
  1949             88  ACCT-NOTE                       VALUE 'A'.
  1950         16  NF-LINE-SEQUENCE        PIC S9(04)  COMP.
  1951
  1952     12  NF-LAST-MAINT-DT            PIC X(02).
  1953     12  NF-LAST-MAINT-BY            PIC X(04).
  1954     12  NF-LAST-MAINT-HHMMSS        PIC S9(07)  COMP-3.
  1955
  1956     12  NF-NOTE-LINE                PIC X(60).
  1957
  1958     12  FILLER                      PIC X(25).
  1959*****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6522.cbl
  1961*                       COPY ELCCNTL.
  1962******************************************************************
  1963*                                                                *
  1964*                                                                *
  1965*                            ELCCNTL.                            *
  1966*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1967*                            VMOD=2.059                          *
  1968*                                                                *
  1969*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1970*                                                                *
  1971*   FILE TYPE = VSAM,KSDS                                        *
  1972*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1973*                                                                *
  1974*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1975*       ALTERNATE INDEX = NONE                                   *
  1976*                                                                *
  1977*   LOG = YES                                                    *
  1978*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1979******************************************************************
  1980*                   C H A N G E   L O G
  1981*
  1982* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1983*-----------------------------------------------------------------
  1984*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1985* EFFECTIVE    NUMBER
  1986*-----------------------------------------------------------------
  1987* 082503                   PEMA  ADD BENEFIT GROUP
  1988* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1989* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1990* 092705    2005050300006  PEMA  ADD SPP LEASES
  1991* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1992* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1993* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1994* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1995******************************************************************
  1996*
  1997 01  CONTROL-FILE.
  1998     12  CF-RECORD-ID                       PIC XX.
  1999         88  VALID-CF-ID                        VALUE 'CF'.
  2000
  2001     12  CF-CONTROL-PRIMARY.
  2002         16  CF-COMPANY-ID                  PIC XXX.
  2003         16  CF-RECORD-TYPE                 PIC X.
  2004             88  CF-COMPANY-MASTER              VALUE '1'.
  2005             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2006             88  CF-STATE-MASTER                VALUE '3'.
  2007             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2008             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2009             88  CF-CARRIER-MASTER              VALUE '6'.
  2010             88  CF-MORTALITY-MASTER            VALUE '7'.
  2011             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2012             88  CF-TERMINAL-MASTER             VALUE '9'.
  2013             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2014             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2015             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2016             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2017             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2018             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6522.cbl
  2019             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2020             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2021             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2022         16  CF-ACCESS-CD-GENL              PIC X(4).
  2023         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2024             20  CF-PROCESSOR               PIC X(4).
  2025         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2026             20  CF-STATE-CODE              PIC XX.
  2027             20  FILLER                     PIC XX.
  2028         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2029             20  FILLER                     PIC XX.
  2030             20  CF-HI-BEN-IN-REC           PIC XX.
  2031         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2032             20  FILLER                     PIC XXX.
  2033             20  CF-CARRIER-CNTL            PIC X.
  2034         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2035             20  FILLER                     PIC XX.
  2036             20  CF-HI-TYPE-IN-REC          PIC 99.
  2037         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2038             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2039                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2040             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2041             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2042         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2043             20  FILLER                     PIC X.
  2044             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2045         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2046             20  FILLER                     PIC XX.
  2047             20  CF-MORTGAGE-PLAN           PIC XX.
  2048         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2049
  2050     12  CF-LAST-MAINT-DT                   PIC XX.
  2051     12  CF-LAST-MAINT-BY                   PIC X(4).
  2052     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2053
  2054     12  CF-RECORD-BODY                     PIC X(728).
  2055
  2056
  2057****************************************************************
  2058*             COMPANY MASTER RECORD                            *
  2059****************************************************************
  2060
  2061     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2062         16  CF-COMPANY-ADDRESS.
  2063             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2064             20  CF-CL-IN-CARE-OF           PIC X(30).
  2065             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2066             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2067             20  CF-CL-CITY-STATE           PIC X(30).
  2068             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2069             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2070         16  CF-COMPANY-CD                  PIC X.
  2071         16  CF-COMPANY-PASSWORD            PIC X(8).
  2072         16  CF-SECURITY-OPTION             PIC X.
  2073             88  ALL-SECURITY                   VALUE '1'.
  2074             88  COMPANY-VERIFY                 VALUE '2'.
  2075             88  PROCESSOR-VERIFY               VALUE '3'.
  2076             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6522.cbl
  2077             88  ALL-BUT-TERM                   VALUE '5'.
  2078         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2079             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2080         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2081             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2082         16  CF-INFORCE-LOCATION            PIC X.
  2083             88  CERTS-ARE-ONLINE               VALUE '1'.
  2084             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2085             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2086         16  CF-LOWER-CASE-LETTERS          PIC X.
  2087         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2088             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2089             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2090             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2091             88  CF-ACCNT-CNTL                  VALUE '3'.
  2092             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2093
  2094         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2095         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2096
  2097         16  CF-LGX-CREDIT-USER             PIC X.
  2098             88  CO-IS-NOT-USER                 VALUE 'N'.
  2099             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2100
  2101         16 CF-CREDIT-CALC-CODES.
  2102             20  CF-CR-REM-TERM-CALC PIC X.
  2103               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2104               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2105               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2106               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2107               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2108               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2109               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2110             20  CF-CR-R78-METHOD           PIC X.
  2111               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2112               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2113
  2114         16  CF-CLAIM-CONTROL-COUNTS.
  2115             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2116                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2117
  2118             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2119                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2120
  2121             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2122                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2123
  2124             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2125                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2126
  2127         16  CF-CURRENT-MONTH-END           PIC XX.
  2128
  2129         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2130             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2131             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2132             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2133             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2134                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6522.cbl
  2135                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2136             20  CF-CO-PREM-REJECT-SW       PIC X.
  2137                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2138                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2139             20  CF-CO-REF-REJECT-SW        PIC X.
  2140                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2141                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2142
  2143         16  CF-CO-REPORTING-DT             PIC XX.
  2144         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2145         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2146           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2147           88  CF-CO-MONTH-END                  VALUE '1'.
  2148
  2149         16  CF-LGX-CLAIM-USER              PIC X.
  2150             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2151             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2152
  2153         16  CF-CREDIT-EDIT-CONTROLS.
  2154             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2155             20  CF-MIN-AGE                 PIC 99.
  2156             20  CF-DEFAULT-AGE             PIC 99.
  2157             20  CF-MIN-TERM                PIC S999      COMP-3.
  2158             20  CF-MAX-TERM                PIC S999      COMP-3.
  2159             20  CF-DEFAULT-SEX             PIC X.
  2160             20  CF-JOINT-AGE-INPUT         PIC X.
  2161                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2162             20  CF-BIRTH-DATE-INPUT        PIC X.
  2163                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2164             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2165                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2166                 88  CF-ZERO-CARRIER            VALUE '1'.
  2167                 88  CF-ZERO-GROUPING           VALUE '2'.
  2168                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2169             20  CF-EDIT-SW                 PIC X.
  2170                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2171             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2172             20  CF-CR-PR-METHOD            PIC X.
  2173               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2174               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2175             20  FILLER                     PIC X.
  2176
  2177         16  CF-CREDIT-MISC-CONTROLS.
  2178             20  CF-REIN-TABLE-SW           PIC X.
  2179                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2180             20  CF-COMP-TABLE-SW           PIC X.
  2181                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2182             20  CF-EXPERIENCE-RETENTION-AGE
  2183                                            PIC S9        COMP-3.
  2184             20  CF-CONVERSION-DT           PIC XX.
  2185             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2186             20  CF-RUN-FREQUENCY-SW        PIC X.
  2187                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2188                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2189
  2190             20  CF-CR-CHECK-NO-CONTROL.
  2191                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2192                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6522.cbl
  2193                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2194                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2195                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2196                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2197
  2198                 24  CF-CR-CHECK-COUNT       REDEFINES
  2199                     CF-CR-CHECK-COUNTER      PIC X(4).
  2200
  2201                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2202                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2203
  2204                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2205                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2206                 24  CF-MAIL-PROCESSING       PIC X.
  2207                     88  MAIL-PROCESSING          VALUE 'Y'.
  2208
  2209         16  CF-MISC-SYSTEM-CONTROL.
  2210             20  CF-SYSTEM-C                 PIC X.
  2211                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2212             20  CF-SYSTEM-D                 PIC X.
  2213                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2214             20  CF-SOC-SEC-NO-SW            PIC X.
  2215                 88  SOC-SEC-NO-USED             VALUE '1'.
  2216             20  CF-MEMBER-NO-SW             PIC X.
  2217                 88  MEMBER-NO-USED              VALUE '1'.
  2218             20  CF-TAX-ID-NUMBER            PIC X(11).
  2219             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2220             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2221                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2222                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2223                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2224                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2225             20  CF-SYSTEM-E                 PIC X.
  2226                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2227
  2228         16  CF-LGX-LIFE-USER               PIC X.
  2229             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2230             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2231
  2232         16  CF-CR-MONTH-END-DT             PIC XX.
  2233
  2234         16  CF-FILE-MAINT-DATES.
  2235             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2236                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2237             20  CF-LAST-BATCH       REDEFINES
  2238                 CF-LAST-BATCH-NO               PIC X(4).
  2239             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2240             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2241             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2242             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2243             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2244             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2245             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2246             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2247             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2248             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2249
  2250         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6522.cbl
  2251         16  FILLER                         PIC X.
  2252
  2253         16  CF-ALT-MORT-CODE               PIC X(4).
  2254         16  CF-MEMBER-CAPTION              PIC X(10).
  2255
  2256         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2257             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2258             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2259             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2260             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2261             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2262
  2263         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2264
  2265         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2266         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2267         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2268         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2269
  2270         16  CF-AH-OVERRIDE-L1              PIC X.
  2271         16  CF-AH-OVERRIDE-L2              PIC XX.
  2272         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2273         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2274
  2275         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2276         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2277
  2278         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2279         16  CF-AR-LAST-EL860-DT            PIC XX.
  2280         16  CF-MP-MONTH-END-DT             PIC XX.
  2281
  2282         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2283         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2284             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2285
  2286         16  CF-AR-MONTH-END-DT             PIC XX.
  2287
  2288         16  CF-CRDTCRD-USER                PIC X.
  2289             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2290             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2291
  2292         16  CF-CC-MONTH-END-DT             PIC XX.
  2293
  2294         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2295
  2296         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2297             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2298             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2299             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2300         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2301         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2302         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2303         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2304             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2305             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2306         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2307         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2308         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6522.cbl
  2309             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2310         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2311
  2312         16  CF-CL-ZIP-CODE.
  2313             20  CF-CL-ZIP-PRIME.
  2314                 24  CF-CL-ZIP-1ST          PIC X.
  2315                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2316                 24  FILLER                 PIC X(4).
  2317             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2318         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2319             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2320             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2321             20  FILLER                     PIC XXX.
  2322
  2323         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2324         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2325         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2326         16  CF-CO-OPTION-START-DATE        PIC XX.
  2327         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2328           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2329                                                      '3' '4'.
  2330           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2331           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2332           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2333           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2334           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2335           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2336
  2337         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2338
  2339         16  CF-PAYMENT-APPROVAL-LEVELS.
  2340             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2341             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2342             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2343             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2344             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2345             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2346
  2347         16  CF-END-USER-REPORTING-USER     PIC X.
  2348             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2349             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2350
  2351         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2352             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2353             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2354
  2355         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2356
  2357         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2358         16  FILLER                         PIC X.
  2359
  2360         16  CF-CREDIT-ARCHIVE-CNTL.
  2361             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2362             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2363             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2364
  2365         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2366
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6522.cbl
  2367         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2368             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2369             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2370
  2371         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2372             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2373             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2374
  2375         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2376
  2377         16  CF-CO-ACH-ID-CODE              PIC  X.
  2378             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2379             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2380             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2381         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2382         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2383         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2384         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2385         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2386         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2387         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2388         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2389         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2390                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2391         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2392                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2393
  2394         16  CF-CO-OVER-SHORT.
  2395             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2396             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2397
  2398*         16  FILLER                         PIC X(102).
  2399         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2400             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2401             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2402
  2403         16  CF-AH-APPROVAL-DAYS.
  2404             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2405             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2406             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2407             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2408
  2409         16  FILLER                         PIC X(82).
  2410****************************************************************
  2411*             PROCESSOR/USER RECORD                            *
  2412****************************************************************
  2413
  2414     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2415         16  CF-PROCESSOR-NAME              PIC X(30).
  2416         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2417         16  CF-PROCESSOR-TITLE             PIC X(26).
  2418         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2419                 88  MESSAGE-YES                VALUE 'Y'.
  2420                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2421
  2422*****************************************************
  2423****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2424****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6522.cbl
  2425****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2426****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2427*****************************************************
  2428
  2429         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2430             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2431             20  CF-APPLICATION-FORCE       PIC X.
  2432             20  CF-INDIVIDUAL-APP.
  2433                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2434                     28  CF-BROWSE-APP      PIC X.
  2435                     28  CF-UPDATE-APP      PIC X.
  2436
  2437         16  CF-CURRENT-TERM-ON             PIC X(4).
  2438         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2439             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2440             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2441             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2442             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2443             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2444             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2445             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2446         16  CF-PROCESSOR-CARRIER           PIC X.
  2447             88  NO-CARRIER-SECURITY            VALUE ' '.
  2448         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2449             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2450         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2451             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2452         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2453             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2454
  2455         16  CF-PROC-SYS-ACCESS-SW.
  2456             20  CF-PROC-CREDIT-CLAIMS-SW.
  2457                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2458                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2459                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2460                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2461             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2462                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2463                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2464             20  CF-PROC-LIFE-GNRLDGR-SW.
  2465                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2466                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2467                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2468                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2469             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2470                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2471                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2472         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2473             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2474             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2475         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2476
  2477         16  CF-APPROVAL-LEVEL                  PIC X.
  2478             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2479             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2480             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2481             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2482
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6522.cbl
  2483         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2484
  2485         16  CF-LANGUAGE-TYPE                   PIC X.
  2486             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2487             88  CF-LANG-IS-FR                      VALUE 'F'.
  2488         16  FILLER                             PIC  X(240).
  2489
  2490****************************************************************
  2491*             PROCESSOR/REMINDERS RECORD                       *
  2492****************************************************************
  2493
  2494     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2495         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2496             20  CF-START-REMIND-DT         PIC XX.
  2497             20  CF-END-REMIND-DT           PIC XX.
  2498             20  CF-REMINDER-TEXT           PIC X(50).
  2499         16  FILLER                         PIC X(296).
  2500
  2501
  2502****************************************************************
  2503*             STATE MASTER RECORD                              *
  2504****************************************************************
  2505
  2506     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2507         16  CF-STATE-ABBREVIATION          PIC XX.
  2508         16  CF-STATE-NAME                  PIC X(25).
  2509         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2510         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2511             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2512             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2513             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2514             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2515                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2516                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2517             20  CF-ST-PREM-REJECT-SW       PIC X.
  2518                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2519                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2520             20  CF-ST-REF-REJECT-SW        PIC X.
  2521                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2522                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2523         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2524         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2525         16  CF-ST-REFUND-RULES.
  2526             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2527             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2528             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2529         16  CF-ST-FST-PMT-EXTENSION.
  2530             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2531             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2532                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2533                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2534                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2535                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2536         16  CF-ST-STATE-CALL.
  2537             20  CF-ST-CALL-UNEARNED        PIC X.
  2538             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2539             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2540         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6522.cbl
  2541             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2542             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2543         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2544         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2545         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2546         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2547         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2548         16  FILLER                         PIC X.
  2549         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2550             20  CF-ST-BENEFIT-CD           PIC XX.
  2551             20  CF-ST-BENEFIT-KIND         PIC X.
  2552                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2553                 88  CF-ST-AH-KIND              VALUE 'A'.
  2554             20  CF-ST-REM-TERM-CALC        PIC X.
  2555                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2556                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2557                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2558                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2559                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2560                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2561                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2562                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2563
  2564             20  CF-ST-REFUND-CALC          PIC X.
  2565                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2566                 88  ST-REFD-BY-R78             VALUE '1'.
  2567                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2568                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2569                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2570                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2571                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2572                 88  ST-REFD-UTAH               VALUE '7'.
  2573                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2574                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2575                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2576
  2577             20  CF-ST-EARNING-CALC         PIC X.
  2578                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2579                 88  ST-EARN-BY-R78             VALUE '1'.
  2580                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2581                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2582                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2583                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2584                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2585                 88  ST-EARN-MEAN               VALUE '8'.
  2586                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2587
  2588             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2589                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2590                 88  ST-OVRD-BY-R78             VALUE '1'.
  2591                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2592                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2593                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2594                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2595                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2596                 88  ST-OVRD-MEAN               VALUE '8'.
  2597                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  2598             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6522.cbl
  2599
  2600         16  CF-ST-COMMISSION-CAPS.
  2601             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2602             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2603             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2604             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2605         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2606                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2607
  2608         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2609
  2610         16  CF-ST-STATUTORY-INTEREST.
  2611             20  CF-ST-STAT-DATE-FROM       PIC X.
  2612                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2613                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2614             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2615             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2616             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2617             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2618             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2619
  2620         16  CF-ST-OVER-SHORT.
  2621             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2622             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2623
  2624         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2625
  2626         16  CF-ST-RT-CALC                  PIC X.
  2627
  2628         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2629         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2630         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2631         16  CF-ST-RF-LR-CALC               PIC X.
  2632         16  CF-ST-RF-LL-CALC               PIC X.
  2633         16  CF-ST-RF-LN-CALC               PIC X.
  2634         16  CF-ST-RF-AH-CALC               PIC X.
  2635         16  CF-ST-RF-CP-CALC               PIC X.
  2636*        16  FILLER                         PIC X(206).
  2637*CIDMOD         16  FILLER                         PIC X(192).
  2638         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2639             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2640         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2641         16  FILLER                         PIC X(187).
  2642
  2643****************************************************************
  2644*             BENEFIT MASTER RECORD                            *
  2645****************************************************************
  2646
  2647     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2648         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2649             20  CF-BENEFIT-CODE            PIC XX.
  2650             20  CF-BENEFIT-NUMERIC  REDEFINES
  2651                 CF-BENEFIT-CODE            PIC XX.
  2652             20  CF-BENEFIT-ALPHA           PIC XXX.
  2653             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2654             20  CF-BENEFIT-COMMENT         PIC X(10).
  2655
  2656             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6522.cbl
  2657                 88  CF-REDUCING                VALUE 'R'.
  2658                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2659
  2660             20  CF-SPECIAL-CALC-CD         PIC X.
  2661                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2662                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2663                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2664                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2665                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2666                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2667                 88  CF-FARM-PLAN               VALUE 'F'.
  2668                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2669                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2670                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2671                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2672                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2673                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2674                 88  CF-PRUDENTIAL              VALUE 'P'.
  2675                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2676                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2677                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2678                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2679                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2680                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2681
  2682             20  CF-JOINT-INDICATOR         PIC X.
  2683                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2684
  2685*            20  FILLER                     PIC X(12).
  2686             20  FILLER                     PIC X(11).
  2687             20  CF-BENEFIT-CATEGORY        PIC X.
  2688             20  CF-LOAN-TYPE               PIC X(8).
  2689
  2690             20  CF-CO-REM-TERM-CALC        PIC X.
  2691                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2692                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2693                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2694                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2695                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2696
  2697             20  CF-CO-EARNINGS-CALC        PIC X.
  2698                 88  CO-EARN-BY-R78             VALUE '1'.
  2699                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2700                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2701                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2702                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2703                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2704                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2705                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2706
  2707             20  CF-CO-REFUND-CALC          PIC X.
  2708                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2709                 88  CO-REFD-BY-R78             VALUE '1'.
  2710                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2711                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2712                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2713                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2714                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6522.cbl
  2715                 88  CO-REFD-MEAN               VALUE '8'.
  2716                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2717                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2718                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2719
  2720             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2721                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2722                 88  CO-OVRD-BY-R78             VALUE '1'.
  2723                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2724                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2725                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2726                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2727                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2728                 88  CO-OVRD-MEAN               VALUE '8'.
  2729                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2730
  2731             20  CF-CO-BEN-I-G-CD           PIC X.
  2732                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2733                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2734                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2735
  2736         16  FILLER                         PIC X(304).
  2737
  2738
  2739****************************************************************
  2740*             CARRIER MASTER RECORD                            *
  2741****************************************************************
  2742
  2743     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2744         16  CF-ADDRESS-DATA.
  2745             20  CF-MAIL-TO-NAME            PIC X(30).
  2746             20  CF-IN-CARE-OF              PIC X(30).
  2747             20  CF-ADDRESS-LINE-1          PIC X(30).
  2748             20  CF-ADDRESS-LINE-2          PIC X(30).
  2749             20  CF-CITY-STATE              PIC X(30).
  2750             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2751             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2752
  2753         16  CF-CLAIM-NO-CONTROL.
  2754             20  CF-CLAIM-NO-METHOD         PIC X.
  2755                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2756                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2757                 88  CLAIM-NO-SEQ               VALUE '3'.
  2758                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2759             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2760                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2761                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2762                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2763
  2764         16  CF-CHECK-NO-CONTROL.
  2765             20  CF-CHECK-NO-METHOD         PIC X.
  2766                 88  CHECK-NO-MANUAL            VALUE '1'.
  2767                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2768                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2769                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2770             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2771                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2772
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6522.cbl
  2773         16  CF-DOMICILE-STATE              PIC XX.
  2774
  2775         16  CF-EXPENSE-CONTROLS.
  2776             20  CF-EXPENSE-METHOD          PIC X.
  2777                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2778                 88  DOLLARS-PER-PMT            VALUE '2'.
  2779                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2780                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2781             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2782             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2783
  2784         16  CF-CORRESPONDENCE-CONTROL.
  2785             20  CF-LETTER-RESEND-OPT       PIC X.
  2786                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2787                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2788             20  FILLER                     PIC X(4).
  2789
  2790         16  CF-RESERVE-CONTROLS.
  2791             20  CF-MANUAL-SW               PIC X.
  2792                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2793             20  CF-FUTURE-SW               PIC X.
  2794                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2795             20  CF-PTC-SW                  PIC X.
  2796                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2797             20  CF-IBNR-SW                 PIC X.
  2798                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2799             20  CF-PTC-LF-SW               PIC X.
  2800                 88  CF-LF-PTC-USED             VALUE '1'.
  2801             20  CF-CDT-ACCESS-METHOD       PIC X.
  2802                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2803                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2804                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2805             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2806
  2807         16  CF-CLAIM-CALC-METHOD           PIC X.
  2808             88  360-PLUS-MONTHS                VALUE '1'.
  2809             88  365-PLUS-MONTHS                VALUE '2'.
  2810             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2811             88  360-DAILY                      VALUE '4'.
  2812             88  365-DAILY                      VALUE '5'.
  2813
  2814         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2815         16  FILLER                         PIC X(11).
  2816
  2817         16  CF-LIMIT-AMOUNTS.
  2818             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2819             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2820             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2821             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2822             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2823             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2824             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2825             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2826             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2827             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2828
  2829         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2830         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6522.cbl
  2831         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2832
  2833         16  CF-ZIP-CODE.
  2834             20  CF-ZIP-PRIME.
  2835                 24  CF-ZIP-1ST             PIC X.
  2836                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2837                 24  FILLER                 PIC X(4).
  2838             20  CF-ZIP-PLUS4               PIC X(4).
  2839         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2840             20  CF-CAN-POSTAL-1            PIC XXX.
  2841             20  CF-CAN-POSTAL-2            PIC XXX.
  2842             20  FILLER                     PIC XXX.
  2843
  2844         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2845         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2846         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2847
  2848         16  CF-RATING-SWITCH               PIC X.
  2849             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2850             88  CF-NO-RATING                   VALUE 'N'.
  2851
  2852         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2853
  2854         16  CF-CARRIER-OVER-SHORT.
  2855             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2856             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2857
  2858         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2859         16  CF-SECPAY-SWITCH               PIC X.
  2860             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2861             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2862         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2863         16  FILLER                         PIC X(448).
  2864*        16  FILLER                         PIC X(452).
  2865
  2866
  2867****************************************************************
  2868*             MORTALITY MASTER RECORD                          *
  2869****************************************************************
  2870
  2871     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2872         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2873                                INDEXED BY CF-MORT-NDX.
  2874             20  CF-MORT-TABLE              PIC X(5).
  2875             20  CF-MORT-TABLE-TYPE         PIC X.
  2876                 88  CF-MORT-JOINT              VALUE 'J'.
  2877                 88  CF-MORT-SINGLE             VALUE 'S'.
  2878                 88  CF-MORT-COMBINED           VALUE 'C'.
  2879                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2880                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2881             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2882             20  CF-MORT-AGE-METHOD         PIC XX.
  2883                 88  CF-AGE-LAST                VALUE 'AL'.
  2884                 88  CF-AGE-NEAR                VALUE 'AN'.
  2885             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2886             20  CF-MORT-ADJUSTMENT-DIRECTION
  2887                                            PIC X.
  2888                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6522.cbl
  2889                 88  CF-PLUS                    VALUE '+'.
  2890             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2891             20  CF-MORT-JOINT-CODE         PIC X.
  2892                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2893             20  CF-MORT-PC-Q               PIC X.
  2894                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2895             20  CF-MORT-TABLE-CODE         PIC X(4).
  2896             20  CF-MORT-COMMENTS           PIC X(15).
  2897             20  FILLER                     PIC X(14).
  2898
  2899         16  FILLER                         PIC X(251).
  2900
  2901
  2902****************************************************************
  2903*             BUSSINESS TYPE MASTER RECORD                     *
  2904****************************************************************
  2905
  2906     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2907* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2908* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2909* AND RECORD 05 IS TYPES 81-99
  2910         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2911             20  CF-BUSINESS-TITLE          PIC  X(19).
  2912             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2913                                            PIC S9V9(4) COMP-3.
  2914             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2915             20  FILLER                     PIC  X.
  2916         16  FILLER                         PIC  X(248).
  2917
  2918
  2919****************************************************************
  2920*             TERMINAL MASTER RECORD                           *
  2921****************************************************************
  2922
  2923     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2924
  2925         16  CF-COMPANY-TERMINALS.
  2926             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2927                                  PIC X(4).
  2928         16  FILLER               PIC X(248).
  2929
  2930
  2931****************************************************************
  2932*             LIFE EDIT MASTER RECORD                          *
  2933****************************************************************
  2934
  2935     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2936         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2937             20  CF-LIFE-CODE-IN            PIC XX.
  2938             20  CF-LIFE-CODE-OUT           PIC XX.
  2939         16  FILLER                         PIC X(248).
  2940
  2941
  2942****************************************************************
  2943*             AH EDIT MASTER RECORD                            *
  2944****************************************************************
  2945
  2946     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6522.cbl
  2947         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2948             20  CF-AH-CODE-IN              PIC XXX.
  2949             20  CF-AH-CODE-OUT             PIC XX.
  2950         16  FILLER                         PIC X(248).
  2951
  2952
  2953****************************************************************
  2954*             CREDIBILITY TABLES                               *
  2955****************************************************************
  2956
  2957     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2958         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2959                             INDEXED BY CF-CRDB-NDX.
  2960             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2961             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2962             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2963         16  FILLER                         PIC  X(332).
  2964
  2965
  2966****************************************************************
  2967*             REPORT CUSTOMIZATION RECORD                      *
  2968****************************************************************
  2969
  2970     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2971         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2972             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2973             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2974             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2975**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2976****       A T-TRANSFER.                                   ****
  2977             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2978
  2979         16  FILLER                         PIC XX.
  2980
  2981         16  CF-CARRIER-CNTL-OPT.
  2982             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2983                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2984                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2985             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2986                                            PIC X.
  2987         16  CF-GROUP-CNTL-OPT.
  2988             20  CF-GROUP-OPT-SEQ           PIC 9.
  2989                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2990                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2991             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2992                                            PIC X(6).
  2993         16  CF-STATE-CNTL-OPT.
  2994             20  CF-STATE-OPT-SEQ           PIC 9.
  2995                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2996                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2997             20  CF-STATE-SELECT OCCURS 3 TIMES
  2998                                            PIC XX.
  2999         16  CF-ACCOUNT-CNTL-OPT.
  3000             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3001                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3002                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3003             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3004                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6522.cbl
  3005         16  CF-BUS-TYP-CNTL-OPT.
  3006             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3007                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3008                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3009             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3010                                            PIC XX.
  3011         16  CF-LF-TYP-CNTL-OPT.
  3012             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3013                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3014                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3015             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3016                                            PIC XX.
  3017         16  CF-AH-TYP-CNTL-OPT.
  3018             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3019                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3020                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3021             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3022                                            PIC XX.
  3023         16  CF-REPTCD1-CNTL-OPT.
  3024             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3025                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3026                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3027             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3028                                            PIC X(10).
  3029         16  CF-REPTCD2-CNTL-OPT.
  3030             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3031                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3032                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3033             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3034                                            PIC X(10).
  3035         16  CF-USER1-CNTL-OPT.
  3036             20  CF-USER1-OPT-SEQ           PIC 9.
  3037                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3038                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3039             20  CF-USER1-SELECT OCCURS 3 TIMES
  3040                                            PIC X(10).
  3041         16  CF-USER2-CNTL-OPT.
  3042             20  CF-USER2-OPT-SEQ           PIC 9.
  3043                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3044                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3045             20  CF-USER2-SELECT OCCURS 3 TIMES
  3046                                            PIC X(10).
  3047         16  CF-USER3-CNTL-OPT.
  3048             20  CF-USER3-OPT-SEQ           PIC 9.
  3049                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3050                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3051             20  CF-USER3-SELECT OCCURS 3 TIMES
  3052                                            PIC X(10).
  3053         16  CF-USER4-CNTL-OPT.
  3054             20  CF-USER4-OPT-SEQ           PIC 9.
  3055                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3056                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3057             20  CF-USER4-SELECT OCCURS 3 TIMES
  3058                                            PIC X(10).
  3059         16  CF-USER5-CNTL-OPT.
  3060             20  CF-USER5-OPT-SEQ           PIC 9.
  3061                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3062                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6522.cbl
  3063             20  CF-USER5-SELECT OCCURS 3 TIMES
  3064                                            PIC X(10).
  3065         16  CF-REINS-CNTL-OPT.
  3066             20  CF-REINS-OPT-SEQ           PIC 9.
  3067                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3068                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3069             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3070                 24  CF-REINS-PRIME         PIC XXX.
  3071                 24  CF-REINS-SUB           PIC XXX.
  3072
  3073         16  CF-AGENT-CNTL-OPT.
  3074             20  CF-AGENT-OPT-SEQ           PIC 9.
  3075                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3076                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3077             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3078                                            PIC X(10).
  3079
  3080         16  FILLER                         PIC X(43).
  3081
  3082         16  CF-LOSS-RATIO-SELECT.
  3083             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3084             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3085         16  CF-ENTRY-DATE-SELECT.
  3086             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3087             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3088         16  CF-EFFECTIVE-DATE-SELECT.
  3089             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3090             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3091
  3092         16  CF-EXCEPTION-LIST-IND          PIC X.
  3093             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3094
  3095         16  FILLER                         PIC X(318).
  3096
  3097****************************************************************
  3098*                  EXCEPTION REPORTING RECORD                  *
  3099****************************************************************
  3100
  3101     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3102         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3103             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3104
  3105         16  CF-COMBINED-LIFE-AH-OPT.
  3106             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3107             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3108             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3109             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3110
  3111         16  CF-LIFE-OPT.
  3112             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3113             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3114             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3115             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3116             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3117             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3118             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3119             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3120             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6522.cbl
  3121             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3122
  3123         16  CF-AH-OPT.
  3124             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3125             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3126             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3127             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3128             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3129             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3130             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3131             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3132             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3133             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3134
  3135         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3136             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3137             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3138             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3139
  3140         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3141
  3142         16  FILLER                         PIC X(673).
  3143
  3144
  3145****************************************************************
  3146*             MORTGAGE SYSTEM PLAN RECORD                      *
  3147****************************************************************
  3148
  3149     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3150         16  CF-PLAN-TYPE                   PIC X.
  3151             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3152             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3153             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3154         16  CF-PLAN-ABBREV                 PIC XXX.
  3155         16  CF-PLAN-DESCRIPT               PIC X(10).
  3156         16  CF-PLAN-NOTES                  PIC X(20).
  3157         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3158         16  CF-PLAN-UNDERWRITING.
  3159             20  CF-PLAN-TERM-DATA.
  3160                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3161                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3162             20  CF-PLAN-AGE-DATA.
  3163                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3164                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3165                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3166             20  CF-PLAN-BENEFIT-DATA.
  3167                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3168                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3169                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3170                                            PIC S9(7)V99  COMP-3.
  3171         16  CF-PLAN-POLICY-FORMS.
  3172             20  CF-POLICY-FORM             PIC X(12).
  3173             20  CF-MASTER-APPLICATION      PIC X(12).
  3174             20  CF-MASTER-POLICY           PIC X(12).
  3175         16  CF-PLAN-RATING.
  3176             20  CF-RATE-CODE               PIC X(5).
  3177             20  CF-SEX-RATING              PIC X.
  3178                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6522.cbl
  3179                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3180             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3181             20  CF-SUB-STD-TYPE            PIC X.
  3182                 88  CF-PCT-OF-PREM            VALUE '1'.
  3183                 88  CF-PCT-OF-BENE            VALUE '2'.
  3184         16  CF-PLAN-PREM-TOLERANCES.
  3185             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3186             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3187         16  CF-PLAN-PYMT-TOLERANCES.
  3188             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3189             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3190         16  CF-PLAN-MISC-DATA.
  3191             20  FILLER                     PIC X.
  3192             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3193             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3194         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3195         16  CF-PLAN-IND-GRP                PIC X.
  3196             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3197                                                     '1'.
  3198             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3199                                                     '2'.
  3200         16  CF-MIB-SEARCH-SW               PIC X.
  3201             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3202             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3203             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3204             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3205         16  CF-ALPHA-SEARCH-SW             PIC X.
  3206             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3207             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3208             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3209             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3210             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3211             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3212             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3213             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3214             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3215             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3216                                                     'A' 'B' 'C'
  3217                                                     'X' 'Y' 'Z'.
  3218         16  CF-EFF-DT-RULE-SW              PIC X.
  3219             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3220             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3221             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3222             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3223             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3224         16  FILLER                         PIC X(4).
  3225         16  CF-HEALTH-QUESTIONS            PIC X.
  3226             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3227         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3228         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3229         16  CF-PLAN-SNGL-JNT               PIC X.
  3230             88  CF-COMBINED-PLAN              VALUE 'C'.
  3231             88  CF-JNT-PLAN                   VALUE 'J'.
  3232             88  CF-SNGL-PLAN                  VALUE 'S'.
  3233         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3234         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3235         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3236         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6522.cbl
  3237         16  CF-RERATE-CNTL                 PIC  X.
  3238             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3239             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3240             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3241             88  CF-AUTO-RECALC                 VALUE '4'.
  3242         16  CF-BENEFIT-TYPE                PIC  X.
  3243             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3244             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3245         16  CF-POLICY-FEE                  PIC S999V99
  3246                                                    COMP-3.
  3247         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3248         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3249         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3250         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3251         16  FILLER                         PIC  X(32).
  3252         16  CF-TERMINATION-FORM            PIC  X(04).
  3253         16  FILLER                         PIC  X(08).
  3254         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3255                                                       COMP-3.
  3256         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3257         16  CF-ISSUE-LETTER                PIC  X(4).
  3258         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3259         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3260             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3261             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3262         16  CF-MP-REFUND-CALC              PIC X.
  3263             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3264             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3265             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3266             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3267             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3268             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3269             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3270             88  CF-MP-REFD-MEAN                VALUE '8'.
  3271         16  CF-ALT-RATE-CODE               PIC  X(5).
  3272
  3273
  3274         16  FILLER                         PIC X(498).
  3275****************************************************************
  3276*             MORTGAGE COMPANY MASTER RECORD                   *
  3277****************************************************************
  3278
  3279     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3280         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3281         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3282             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3283             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3284             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3285             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3286             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3287
  3288         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3289         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3290         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3291         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3292         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3293
  3294         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6522.cbl
  3295             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3296         16  CF-MP-RECON-USE-IND            PIC X(1).
  3297             88  CF-MP-USE-RECON             VALUE 'Y'.
  3298         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3299             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3300         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3301             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3302             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3303         16  FILLER                         PIC X(1).
  3304         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3305             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3306         16  CF-MORTG-MIB-VERSION           PIC X.
  3307             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3308             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3309             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3310         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3311             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3312                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3313             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3314                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3315             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3316                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3317             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3318                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3319             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3320                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3321             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3322                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3323         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3324         16  FILLER                         PIC X(7).
  3325         16  CF-MORTG-DESTINATION-SYMBOL.
  3326             20  CF-MORTG-MIB-COMM          PIC X(5).
  3327             20  CF-MORTG-MIB-TERM          PIC X(5).
  3328         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3329             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3330         16  FILLER                         PIC X(03).
  3331         16  CF-MP-CHECK-NO-CONTROL.
  3332             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3333                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3334                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3335                                                ' ' LOW-VALUES.
  3336                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3337                                               VALUE '3'.
  3338         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3339         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3340         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3341             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3342                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3343             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3344                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3345             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3346                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3347             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3348                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3349             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3350                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3351             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3352                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL6522.cbl
  3353         16  CF-MORTG-BILLING-AREA.
  3354             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3355                                            PIC X.
  3356         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3357         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3358         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3359         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3360             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3361             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3362         16  FILLER                         PIC X.
  3363         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3364             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3365             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3366         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3367         16  FILLER                         PIC X(8).
  3368         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3369         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3370         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3371         16  CF-ACH-COMPANY-ID.
  3372             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3373                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3374                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3375                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3376             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3377         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3378             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3379         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3380             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3381             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3382         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3383         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3384         16  FILLER                         PIC X(536).
  3385
  3386****************************************************************
  3387*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3388****************************************************************
  3389
  3390     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3391         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3392             20  CF-FEMALE-HEIGHT.
  3393                 24  CF-FEMALE-FT           PIC 99.
  3394                 24  CF-FEMALE-IN           PIC 99.
  3395             20  CF-FEMALE-MIN-WT           PIC 999.
  3396             20  CF-FEMALE-MAX-WT           PIC 999.
  3397         16  FILLER                         PIC X(428).
  3398
  3399     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3400         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3401             20  CF-MALE-HEIGHT.
  3402                 24  CF-MALE-FT             PIC 99.
  3403                 24  CF-MALE-IN             PIC 99.
  3404             20  CF-MALE-MIN-WT             PIC 999.
  3405             20  CF-MALE-MAX-WT             PIC 999.
  3406         16  FILLER                         PIC X(428).
  3407******************************************************************
  3408*             AUTOMATIC ACTIVITY RECORD                          *
  3409******************************************************************
  3410     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL6522.cbl
  3411         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3412             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3413             20  CF-SYS-LETTER-ID           PIC X(04).
  3414             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3415             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3416             20  CF-SYS-RESET-SW            PIC X(01).
  3417             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3418             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3419
  3420         16  FILLER                         PIC X(50).
  3421
  3422         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3423             20  CF-USER-ACTIVE-SW          PIC X(01).
  3424             20  CF-USER-LETTER-ID          PIC X(04).
  3425             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3426             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3427             20  CF-USER-RESET-SW           PIC X(01).
  3428             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3429             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3430             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3431
  3432         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL6522.cbl
  3434 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA
  3435                          COMPENSATION-MASTER COMP-NOTE-FILE
  3436                          CONTROL-FILE.
  3437 0000-DFHEXIT SECTION.
  3438     MOVE '9#                    $   ' TO DFHEIV0.
  3439     MOVE 'EL6522' TO DFHEIV1.
  3440     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3441
  3442     MOVE EIBDATE                     TO DC-JULIAN-YYDDD
  3443     MOVE '5'                         TO DC-OPTION-CODE
  3444     PERFORM 9700-LINK-DATE-CONVERT   THRU 9700-EXIT
  3445     MOVE DC-GREG-DATE-1-EDIT         TO SAVE-DATE
  3446     MOVE DC-BIN-DATE-1               TO SAVE-BIN-DATE
  3447
  3448     MOVE DFHCOMMAREA                 TO PROGRAM-INTERFACE-BLOCK
  3449     MOVE EIBTRMID                    TO QID-TERM
  3450     IF EIBCALEN = ZEROS
  3451         GO TO 8800-UNAUTHORIZED-ACCESS
  3452     END-IF
  3453
  3454     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  3455         MOVE PI-SAVED-PROGRAM-5         TO PI-SAVED-PROGRAM-6
  3456         MOVE PI-SAVED-PROGRAM-4         TO PI-SAVED-PROGRAM-5
  3457         MOVE PI-SAVED-PROGRAM-3         TO PI-SAVED-PROGRAM-4
  3458         MOVE PI-SAVED-PROGRAM-2         TO PI-SAVED-PROGRAM-3
  3459         MOVE PI-SAVED-PROGRAM-1         TO PI-SAVED-PROGRAM-2
  3460         MOVE PI-RETURN-TO-PROGRAM       TO PI-SAVED-PROGRAM-1
  3461         MOVE PI-CALLING-PROGRAM         TO PI-RETURN-TO-PROGRAM
  3462         MOVE THIS-PGM                   TO PI-CALLING-PROGRAM
  3463     END-IF
  3464
  3465     MOVE LOW-VALUES                     TO EL6522AI
  3466     MOVE SPACES                         TO ERCONT-KEY
  3467
  3468     MOVE PI-CR-CARRIER                  TO ERCONT-CARRIER
  3469     MOVE PI-CR-GROUPING                 TO ERCONT-GROUPING
  3470     MOVE PI-CR-FIN-RESP                 TO ERCONT-FINRESP
  3471     IF PI-CR-ACCOUNT = SPACES OR LOW-VALUES
  3472         MOVE PI-CR-FIN-RESP             TO ERCONT-ACCOUNT
  3473     ELSE
  3474         MOVE PI-CR-ACCOUNT              TO ERCONT-ACCOUNT
  3475     END-IF
  3476     MOVE PI-CR-TYPE                     TO ERCONT-REC-TYP
  3477     MOVE PI-COMPANY-CD                  TO ERCONT-COMPANY-CD
  3478     MOVE ZEROS                          TO ERCONT-SEQ
  3479     MOVE ERCONT-PARTIAL-KEY             TO SV-PRIOR-KEY
  3480
  3481     IF EIBTRNID NOT = TRANS-ID
  3482         MOVE '0'                        TO PI-UPDATE-SW
  3483
  3484* EXEC CICS READQ TS
  3485*             QUEUE (PI-SECURITY-TEMP-STORE-ID)
  3486*             INTO (SECURITY-CONTROL)
  3487*             LENGTH (SC-COMM-LENGTH)
  3488*             ITEM (SC-ITEM)
  3489*        END-EXEC
  3490*    MOVE '*$II   L              ''   #00003479' TO DFHEIV0
  3491     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL6522.cbl
  3492     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3493     MOVE X'2020233030303033343739' TO DFHEIV0(25:11)
  3494     CALL 'kxdfhei1' USING DFHEIV0,
  3495           PI-SECURITY-TEMP-STORE-ID,
  3496           SECURITY-CONTROL,
  3497           SC-COMM-LENGTH,
  3498           SC-ITEM,
  3499           DFHEIV99,
  3500           DFHEIV99
  3501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3502         MOVE SC-CREDIT-DISPLAY (05)  TO PI-DISPLAY-CAP
  3503         MOVE SC-CREDIT-UPDATE (05)   TO PI-MODIFY-CAP
  3504     END-IF
  3505
  3506     IF NOT DISPLAY-CAP
  3507         MOVE 'READ'                     TO SM-READ
  3508         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3509         MOVE ER-0070                    TO EMI-ERROR
  3510         PERFORM 9900-ERROR-FORMAT       THRU 9900-EXIT
  3511         GO TO 8100-SEND-INITIAL-MAP
  3512     END-IF
  3513
  3514
  3515* EXEC CICS HANDLE AID
  3516*         CLEAR (9400-CLEAR)
  3517*    END-EXEC
  3518*    MOVE '"&=                  V! " #00003497' TO DFHEIV0
  3519     MOVE X'22263D202020202020202020' TO DFHEIV0(1:12)
  3520     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  3521     MOVE X'2220233030303033343937' TO DFHEIV0(25:11)
  3522     CALL 'kxdfhei1' USING DFHEIV0
  3523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3524
  3525
  3526* EXEC CICS HANDLE CONDITION
  3527*         ERROR (9990-ABEND)
  3528*         PGMIDERR (9600-PGMID-ERROR)
  3529*    END-EXEC
  3530*    MOVE '"$.L                  ! # #00003501' TO DFHEIV0
  3531     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  3532     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3533     MOVE X'2320233030303033353031' TO DFHEIV0(25:11)
  3534     CALL 'kxdfhei1' USING DFHEIV0
  3535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3536
  3537     IF EIBTRNID NOT = TRANS-ID
  3538         GO TO 7000-BUILD-TABLE
  3539     END-IF
  3540     .
  3541 2000-RECEIVE.
  3542     IF EIBAID = DFHPA1 OR
  3543        EIBAID = DFHPA2 OR
  3544        EIBAID = DFHPA3
  3545         MOVE ER-0008                  TO EMI-ERROR
  3546         PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT
  3547         GO TO 8200-SEND-DATAONLY
  3548     END-IF
  3549
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL6522.cbl
  3550
  3551* EXEC CICS RECEIVE
  3552*         MAP(MAP-NAME)
  3553*         MAPSET(MAPSET-NAME)
  3554*         INTO(EL6522AI)
  3555*    END-EXEC
  3556     MOVE LENGTH OF
  3557      EL6522AI
  3558       TO DFHEIV11
  3559*    MOVE '8"T I  L              ''   #00003519' TO DFHEIV0
  3560     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3561     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3562     MOVE X'2020233030303033353139' TO DFHEIV0(25:11)
  3563     CALL 'kxdfhei1' USING DFHEIV0,
  3564           MAP-NAME,
  3565           EL6522AI,
  3566           DFHEIV11,
  3567           MAPSET-NAME,
  3568           DFHEIV99,
  3569           DFHEIV99
  3570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3571
  3572     IF PFENTERL = ZEROS
  3573         GO TO 2001-CHECK-PFKEYS
  3574     END-IF
  3575
  3576     IF EIBAID NOT = DFHENTER
  3577         MOVE ER-0004                  TO EMI-ERROR
  3578         GO TO 2002-INPUT-ERROR
  3579     END-IF
  3580
  3581     IF PFENTERI NUMERIC AND
  3582        (PFENTERI > 00 AND  < 25)
  3583         MOVE PF-VALUES (PFENTERI)     TO EIBAID
  3584     ELSE
  3585         MOVE ER-0029                  TO EMI-ERROR
  3586         GO TO 2002-INPUT-ERROR
  3587     END-IF
  3588
  3589     .
  3590 2001-CHECK-PFKEYS.
  3591     IF EIBAID = DFHPF23
  3592         GO TO 9000-RETURN-CICS
  3593     END-IF
  3594
  3595     IF EIBAID = DFHPF24
  3596         GO TO 9200-RETURN-MAIN-MENU
  3597     END-IF
  3598
  3599     IF EIBAID = DFHPF12
  3600         GO TO 9500-PF12
  3601     END-IF
  3602
  3603     IF FUNCTL NOT = ZEROS AND
  3604        EIBAID NOT = DFHENTER
  3605         IF FUNCTI = 'A' OR = SPACES
  3606             CONTINUE
  3607         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL6522.cbl
  3608             MOVE ER-0050              TO EMI-ERROR
  3609             MOVE -1 TO FUNCTL
  3610             MOVE AL-UABON             TO FUNCTA PFENTERA
  3611             GO TO 2002-INPUT-ERROR
  3612         END-IF
  3613     END-IF
  3614
  3615     IF EIBAID = DFHPF1
  3616         MOVE NUM-LINES-PER-SCREEN     TO ROLL-COUNTER
  3617         GO TO 7400-PAGE-ROUTINE
  3618     END-IF
  3619
  3620     IF EIBAID = DFHPF2
  3621         SUBTRACT NUM-LINES-PER-SCREEN FROM ROLL-COUNTER
  3622         GO TO 7400-PAGE-ROUTINE
  3623     END-IF
  3624
  3625     IF EIBAID = DFHPF3
  3626         MOVE 5                        TO ROLL-COUNTER
  3627         GO TO 7400-PAGE-ROUTINE
  3628     END-IF
  3629
  3630     IF EIBAID = DFHPF4
  3631         MOVE -5                       TO ROLL-COUNTER
  3632         GO TO 7400-PAGE-ROUTINE
  3633     END-IF
  3634
  3635     IF EIBAID = DFHENTER
  3636         GO TO 2003-EDIT-DATA
  3637     END-IF
  3638
  3639     MOVE ER-0029                      TO EMI-ERROR
  3640     .
  3641
  3642 2002-INPUT-ERROR.
  3643     MOVE -1                           TO PFENTERL
  3644     MOVE AL-UNBON                     TO PFENTERA
  3645     PERFORM 9900-ERROR-FORMAT         THRU 9900-EXIT
  3646     GO TO 8200-SEND-DATAONLY
  3647     .
  3648
  3649 2003-EDIT-DATA.
  3650
  3651     IF FUNCTI = 'L'
  3652         CONTINUE
  3653     ELSE
  3654         IF NOT MODIFY-CAP
  3655             MOVE 'UPDATE'                   TO SM-READ
  3656             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  3657             MOVE ER-0070                    TO EMI-ERROR
  3658             PERFORM 9900-ERROR-FORMAT       THRU 9900-EXIT
  3659             GO TO 8100-SEND-INITIAL-MAP
  3660         END-IF
  3661     END-IF
  3662
  3663     IF FUNCTL = ZEROS OR FUNCTI = SPACES
  3664         GO TO 4000-CHANGE-ROUTINE
  3665     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL6522.cbl
  3666
  3667     IF (FUNCTI = 'S' OR = 'D' OR = 'Q' OR
  3668                = 'I' OR = 'A' OR = 'L')
  3669         CONTINUE
  3670     ELSE
  3671         MOVE ER-0023                  TO EMI-ERROR
  3672         PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT
  3673         MOVE AL-UABON                 TO FUNCTA
  3674         MOVE -1                       TO FUNCTL
  3675         GO TO 8200-SEND-DATAONLY
  3676     END-IF
  3677
  3678     IF FUNCTI = 'D'  OR = 'I' OR = 'L'
  3679         PERFORM 2500-LINE-CHECK       THRU 2599-EXIT
  3680     ELSE
  3681         IF (LINE1L NOT = ZEROS OR
  3682             LINE2L NOT = ZEROS)
  3683             MOVE ER-0030              TO EMI-ERROR
  3684             MOVE -1                   TO LINE1L
  3685             MOVE AL-UNBON             TO LINE1A LINE2A
  3686             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3687             GO TO 8200-SEND-DATAONLY
  3688         END-IF
  3689     END-IF
  3690
  3691     IF FUNCTI = 'A'
  3692         GO TO 5000-ADD-NEW-LINES
  3693     END-IF
  3694     IF FUNCTI = 'Q'
  3695         GO TO 9410-RETURN
  3696     END-IF
  3697     IF FUNCTI = 'S'
  3698         GO TO 4500-SAVE-DATA
  3699     END-IF
  3700     IF PI-TOTAL-LINES = 0
  3701         MOVE ER-0048                 TO EMI-ERROR
  3702         MOVE -1                      TO FUNCTL
  3703         MOVE AL-UNBON                TO FUNCTA
  3704         PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
  3705         GO TO 8200-SEND-DATAONLY
  3706     END-IF
  3707     IF FUNCTI = 'L'
  3708         GO TO 5500-LOOKUP
  3709     END-IF
  3710     IF FUNCTI = 'D'
  3711         GO TO 3000-DELETE-LINES
  3712     END-IF
  3713
  3714     GO TO 3500-INSERT-LINES
  3715     .
  3716 2500-LINE-CHECK.
  3717     IF (LINE1L = ZEROS AND
  3718         LINE2L = ZEROS)
  3719         MOVE ER-0069                 TO EMI-ERROR
  3720         PERFORM 9900-ERROR-FORMAT    THRU 9900-EXIT
  3721         MOVE -1                      TO LINE1L
  3722         GO TO 8200-SEND-DATAONLY
  3723     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL6522.cbl
  3724
  3725     IF LINE1L NOT = ZEROS
  3726         IF (LINE1I NOT NUMERIC OR
  3727             LINE1I > PI-TOTAL-LINES)
  3728             MOVE ER-0031              TO EMI-ERROR
  3729             MOVE AL-UNBON             TO LINE1A
  3730             MOVE -1                   TO LINE1L
  3731             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3732             GO TO 8200-SEND-DATAONLY
  3733         ELSE
  3734             IF LINE2L = ZEROS
  3735                 MOVE 1                TO LINE2I
  3736             END-IF
  3737             IF FUNCTI = 'I'
  3738                 GO TO 2510-MAX-CHECK
  3739             END-IF
  3740             IF LINE2I NOT NUMERIC
  3741                 MOVE AL-UNBON             TO LINE2A
  3742                 MOVE ER-0032              TO EMI-ERROR
  3743                 MOVE -1                   TO LINE2L
  3744                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3745                 GO TO 8200-SEND-DATAONLY
  3746             ELSE
  3747                 CONTINUE
  3748             END-IF
  3749         END-IF
  3750     ELSE
  3751         IF LINE2L = ZEROS
  3752             CONTINUE
  3753         ELSE
  3754             MOVE -1                   TO LINE2L
  3755             MOVE ER-0041              TO EMI-ERROR
  3756             MOVE AL-UNBON             TO LINE2A
  3757             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3758             GO TO 8200-SEND-DATAONLY
  3759         END-IF
  3760     END-IF
  3761     GO TO 2599-EXIT
  3762     .
  3763 2510-MAX-CHECK.
  3764     IF LINE2I NOT NUMERIC
  3765         MOVE -1                       TO LINE2L
  3766         MOVE ER-0032                  TO EMI-ERROR
  3767         MOVE AL-UNBON                 TO LINE2A
  3768         PERFORM 9900-ERROR-FORMAT     THRU 9900-EXIT
  3769         GO TO 8200-SEND-DATAONLY
  3770     ELSE
  3771         COMPUTE ROLL-COUNTER = LINE2I + PI-TOTAL-LINES
  3772         IF ROLL-COUNTER > MAX-LINES
  3773             MOVE -1                   TO LINE2L
  3774             MOVE ER-0044              TO EMI-ERROR
  3775             MOVE AL-UNBON             TO LINE2A
  3776             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3777             GO TO 8200-SEND-DATAONLY
  3778         END-IF
  3779     END-IF
  3780     .
  3781 2599-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL6522.cbl
  3782     EXIT.
  3783 3000-DELETE-LINES.
  3784     IF LINE2L = ZEROS AND LINE2I = 1
  3785         MOVE LINE1I                 TO LINE2I
  3786     END-IF
  3787
  3788     IF LINE2I > PI-TOTAL-LINES OR < LINE1I
  3789         MOVE ER-0049                TO EMI-ERROR
  3790         MOVE AL-UNBON               TO LINE2A
  3791         MOVE -1                     TO LINE2L
  3792         PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  3793         GO TO 8200-SEND-DATAONLY
  3794     END-IF
  3795
  3796     PERFORM 7450-SET-INDX           THRU 7450-EXIT
  3797     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3798             VARYING SC-INDX FROM 1
  3799             BY 1
  3800             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  3801     SET TB-INDX TO LINE1I
  3802
  3803     PERFORM 3050-CHECK-FOR-CURRENT-DATE
  3804             UNTIL TB-INDX > LINE2I
  3805
  3806     IF NOT EMI-NO-ERRORS
  3807         GO TO 8200-SEND-DATAONLY
  3808     END-IF
  3809
  3810     SET TB-INDX TO LINE1I
  3811     COMPUTE ROLL-COUNTER = LINE2I - LINE1I + 1
  3812
  3813     IF LINE2I NOT = PI-TOTAL-LINES
  3814         SET TB-INDX1 TO LINE2I
  3815         SET TB-INDX1 UP BY 1
  3816         PERFORM 3100-DELETE-TABLE-ENTRIES
  3817                 UNTIL TB-INDX1 > PI-TOTAL-LINES
  3818     END-IF
  3819
  3820     PERFORM 3150-BLANK-TABLE-ENTRIES
  3821             ROLL-COUNTER TIMES
  3822     SUBTRACT ROLL-COUNTER FROM PI-TOTAL-LINES
  3823
  3824     IF PI-CURRENT-LINE > PI-TOTAL-LINES
  3825         MOVE PI-TOTAL-LINES         TO PI-CURRENT-LINE
  3826         SUBTRACT 1 FROM PI-CURRENT-LINE
  3827     END-IF
  3828
  3829     SET TB-INDX                     TO PI-CURRENT-LINE
  3830     MOVE LOW-VALUES                 TO EL6522AI
  3831
  3832     IF PI-CURRENT-LINE > ZERO
  3833         PERFORM 7100-FORMAT-SCREEN  THRU 7100-EXIT
  3834                 VARYING SC-INDX FROM 1
  3835                 BY 1
  3836                 UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  3837         PERFORM 7200-PUT-TEMP-STOR  THRU 7249-EXIT
  3838     END-IF
  3839
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL6522.cbl
  3840     MOVE '1'                        TO PI-UPDATE-SW
  3841     IF PI-TOTAL-LINES = ZEROS
  3842         MOVE ZEROS                  TO PI-CURRENT-LINE
  3843     END-IF
  3844     GO TO 8100-SEND-INITIAL-MAP
  3845     .
  3846
  3847 3050-CHECK-FOR-CURRENT-DATE.
  3848     IF REC-LAST-MAINT-DT (TB-INDX) = SAVE-BIN-DATE
  3849         CONTINUE
  3850     ELSE
  3851         MOVE ER-3786                TO EMI-ERROR
  3852         MOVE AL-UNBON               TO FUNCTA
  3853         MOVE -1                     TO FUNCTL
  3854         PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  3855         GO TO 8200-SEND-DATAONLY
  3856     END-IF
  3857
  3858     IF REC-LAST-MAINT-BY (TB-INDX) = PI-PROCESSOR-ID
  3859         CONTINUE
  3860     ELSE
  3861         MOVE ER-3787                TO EMI-ERROR
  3862         MOVE AL-UNBON               TO FUNCTA
  3863         MOVE -1                     TO FUNCTL
  3864         PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  3865         GO TO 8200-SEND-DATAONLY
  3866     END-IF
  3867
  3868     SET TB-INDX TB-INDX1 UP BY 1
  3869     .
  3870
  3871 3100-DELETE-TABLE-ENTRIES.
  3872     MOVE REC-ENT (TB-INDX1)         TO REC-ENT (TB-INDX)
  3873     SET TB-INDX TB-INDX1 UP BY 1
  3874     .
  3875
  3876 3150-BLANK-TABLE-ENTRIES.
  3877     MOVE SPACES               TO REC-ENT (TB-INDX)
  3878     MOVE LOW-VALUES           TO REC-LAST-MAINT-DT (TB-INDX)
  3879     MOVE ZERO                 TO REC-LAST-MAINT-HHMMSS (TB-INDX)
  3880     SET TB-INDX UP BY 1
  3881     .
  3882 3500-INSERT-LINES.
  3883
  3884     PERFORM 7450-SET-INDX                 THRU 7450-EXIT
  3885     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3886             VARYING SC-INDX FROM 1
  3887             BY 1
  3888             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  3889
  3890     IF NOT EMI-NO-ERRORS
  3891         GO TO 8200-SEND-DATAONLY
  3892     END-IF
  3893
  3894     SET TB-INDX TO PI-TOTAL-LINES
  3895     ADD LINE2I TO PI-TOTAL-LINES
  3896     SET TB-INDX1 TO PI-TOTAL-LINES
  3897     PERFORM 3600-INSERT-TABLE-ENTRIES
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL6522.cbl
  3898             UNTIL TB-INDX = LINE1I
  3899     SET TB-INDX UP BY 1
  3900
  3901     COMPUTE ROLL-COUNTER = PI-CURRENT-LINE +
  3902                            NUM-LINES-PER-SCREEN
  3903     IF TB-INDX NOT < ROLL-COUNTER OR
  3904                    < PI-CURRENT-LINE
  3905         SET SC-INDX TO 1
  3906         SET SC-INDX DOWN BY 1
  3907     ELSE
  3908         SET ROLL-COUNTER TO TB-INDX
  3909         COMPUTE ROLL-COUNTER = ROLL-COUNTER - PI-CURRENT-LINE
  3910                  + 1
  3911         SET SC-INDX TO ROLL-COUNTER
  3912     END-IF
  3913
  3914     PERFORM 3150-BLANK-TABLE-ENTRIES
  3915             LINE2I TIMES
  3916     SET TB-INDX TO PI-CURRENT-LINE
  3917     MOVE LOW-VALUES                 TO EL6522AI
  3918
  3919     IF SC-INDX NOT = ZERO
  3920        MOVE -1                      TO SC-TEXTL (SC-INDX)
  3921     END-IF
  3922
  3923     PERFORM 7100-FORMAT-SCREEN      THRU 7100-EXIT
  3924            VARYING SC-INDX FROM 1
  3925            BY 1
  3926            UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  3927     PERFORM 7200-PUT-TEMP-STOR      THRU 7249-EXIT
  3928     MOVE '1'                        TO PI-UPDATE-SW
  3929     GO TO 8100-SEND-INITIAL-MAP
  3930     .
  3931
  3932 3600-INSERT-TABLE-ENTRIES.
  3933     MOVE REC-ENT (TB-INDX)          TO REC-ENT (TB-INDX1)
  3934     SET TB-INDX TB-INDX1 DOWN BY 1
  3935     .
  3936
  3937 4000-CHANGE-ROUTINE.
  3938     PERFORM 7450-SET-INDX                 THRU 7450-EXIT
  3939     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  3940             VARYING SC-INDX FROM 1
  3941             BY 1
  3942             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  3943
  3944     IF NOT EMI-NO-ERRORS
  3945         GO TO 8200-SEND-DATAONLY
  3946     END-IF
  3947
  3948     PERFORM 7200-PUT-TEMP-STOR      THRU 7249-EXIT
  3949     MOVE SPACES                     TO ERRMSGBO
  3950     GO TO 8200-SEND-DATAONLY
  3951     .
  3952
  3953 4500-SAVE-DATA.
  3954     PERFORM 7450-SET-INDX                 THRU 7450-EXIT
  3955     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL6522.cbl
  3956             VARYING SC-INDX FROM 1
  3957             BY 1
  3958             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  3959     IF NOT EMI-NO-ERRORS
  3960         GO TO 8200-SEND-DATAONLY
  3961     END-IF
  3962
  3963
  3964* EXEC CICS HANDLE CONDITION
  3965*         NOTFND(4610-ENDBR)
  3966*         NOTOPEN(6000-NOT-OPEN)
  3967*         ENDFILE(4610-ENDBR)
  3968*    END-EXEC
  3969*    MOVE '"$IJ''                 ! $ #00003916' TO DFHEIV0
  3970     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  3971     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3972     MOVE X'2420233030303033393136' TO DFHEIV0(25:11)
  3973     CALL 'kxdfhei1' USING DFHEIV0
  3974     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3975     .
  3976
  3977 4610-LOOP.
  3978
  3979* EXEC CICS READ
  3980*         DATASET (ERCONT-FILE-ID)
  3981*         RIDFLD (ERCONT-KEY)
  3982*         SET (ADDRESS OF COMP-NOTE-FILE)
  3983*         GTEQ
  3984*    END-EXEC
  3985*    MOVE '&"S        G          (   #00003924' TO DFHEIV0
  3986     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3987     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3988     MOVE X'2020233030303033393234' TO DFHEIV0(25:11)
  3989     CALL 'kxdfhei1' USING DFHEIV0,
  3990           ERCONT-FILE-ID,
  3991           DFHEIV20,
  3992           DFHEIV99,
  3993           ERCONT-KEY,
  3994           DFHEIV99,
  3995           DFHEIV99,
  3996           DFHEIV99
  3997     SET ADDRESS OF COMP-NOTE-FILE TO
  3998         DFHEIV20
  3999     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4000
  4001     MOVE NF-CONTROL-PRIMARY         TO ERCONT-KEY
  4002
  4003     IF ERCONT-PARTIAL-KEY NOT = SV-PRIOR-KEY
  4004         MOVE SV-PRIOR-KEY           TO ERCONT-PARTIAL-KEY
  4005         GO TO 4610-ENDBR
  4006     END-IF
  4007
  4008
  4009* EXEC CICS DELETE
  4010*        DATASET (ERCONT-FILE-ID)
  4011*        RIDFLD (ERCONT-KEY)
  4012*    END-EXEC
  4013*    MOVE '&(  R                 &   #00003938' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL6522.cbl
  4014     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  4015     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4016     MOVE X'2020233030303033393338' TO DFHEIV0(25:11)
  4017     CALL 'kxdfhei1' USING DFHEIV0,
  4018           ERCONT-FILE-ID,
  4019           ERCONT-KEY,
  4020           DFHEIV99,
  4021           DFHEIV99,
  4022           DFHEIV99
  4023     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4024
  4025     GO TO 4610-LOOP
  4026     .
  4027 4610-ENDBR.
  4028
  4029* EXEC CICS GETMAIN
  4030*         LENGTH(ERCONT-LENGTH)
  4031*         SET(ADDRESS OF COMP-NOTE-FILE)
  4032*         INITIMG(GETMAIN-SPACE)
  4033*    END-EXEC
  4034*    MOVE ',"IL                  $   #00003946' TO DFHEIV0
  4035     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4036     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4037     MOVE X'2020233030303033393436' TO DFHEIV0(25:11)
  4038     CALL 'kxdfhei1' USING DFHEIV0,
  4039           DFHEIV20,
  4040           ERCONT-LENGTH,
  4041           GETMAIN-SPACE
  4042     SET ADDRESS OF COMP-NOTE-FILE TO
  4043         DFHEIV20
  4044     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4045
  4046     PERFORM 4700-WRITE-FILE         THRU 4799-EXIT
  4047             VARYING TB-INDX FROM 1
  4048             BY 1
  4049             UNTIL TB-INDX > PI-TOTAL-LINES
  4050
  4051     GO TO 9410-RETURN
  4052     .
  4053
  4054 4700-WRITE-FILE.
  4055     MOVE SPACES                     TO COMP-NOTE-FILE
  4056     ADD 1                           TO ERCONT-SEQ
  4057     MOVE ERCONT-KEY                 TO NF-CONTROL-PRIMARY
  4058     MOVE  'NF'                      TO NF-FILE-ID
  4059     MOVE REC-TEXT (TB-INDX)         TO NF-NOTE-LINE
  4060     MOVE REC-LAST-MAINT-BY (TB-INDX)
  4061                                     TO NF-LAST-MAINT-BY
  4062     MOVE REC-LAST-MAINT-HHMMSS (TB-INDX)
  4063                                     TO NF-LAST-MAINT-HHMMSS
  4064     MOVE REC-LAST-MAINT-DT (TB-INDX)
  4065                                     TO NF-LAST-MAINT-DT
  4066
  4067
  4068* EXEC CICS WRITE
  4069*         DATASET(ERCONT-FILE-ID)
  4070*         FROM(COMP-NOTE-FILE)
  4071*         RIDFLD(ERCONT-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL6522.cbl
  4072*    END-EXEC
  4073     MOVE LENGTH OF
  4074      COMP-NOTE-FILE
  4075       TO DFHEIV11
  4076*    MOVE '&$ L                  ''   #00003973' TO DFHEIV0
  4077     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4078     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4079     MOVE X'2020233030303033393733' TO DFHEIV0(25:11)
  4080     CALL 'kxdfhei1' USING DFHEIV0,
  4081           ERCONT-FILE-ID,
  4082           COMP-NOTE-FILE,
  4083           DFHEIV11,
  4084           ERCONT-KEY,
  4085           DFHEIV99,
  4086           DFHEIV99
  4087     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4088     .
  4089 4799-EXIT.
  4090      EXIT.
  4091
  4092 5000-ADD-NEW-LINES.
  4093     PERFORM 7450-SET-INDX                 THRU 7450-EXIT
  4094     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  4095             VARYING SC-INDX FROM 1
  4096             BY 1
  4097             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  4098
  4099     IF NOT EMI-NO-ERRORS
  4100         GO TO 8200-SEND-DATAONLY
  4101     END-IF
  4102
  4103     MOVE PI-TOTAL-LINES             TO PI-CURRENT-LINE
  4104     PERFORM 7200-PUT-TEMP-STOR      THRU 7249-EXIT
  4105     MOVE LOW-VALUES                 TO EL6522AI
  4106     SET TB-INDX                     TO PI-CURRENT-LINE
  4107     MOVE 'A'                        TO FUNCTI
  4108     MOVE -1                         TO SC-TEXTL (2)
  4109     MOVE AL-UANON                   TO FUNCTA
  4110     PERFORM 7100-FORMAT-SCREEN THRU 7100-EXIT
  4111             VARYING SC-INDX FROM 1
  4112             BY 1
  4113             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  4114     MOVE '1'                        TO PI-UPDATE-SW
  4115     GO TO 8100-SEND-INITIAL-MAP
  4116     .
  4117 5500-LOOKUP.
  4118     PERFORM 7500-READ-TS            THRU 7599-EXIT
  4119     SET TB-INDX                     TO PI-CURRENT-LINE
  4120     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  4121             VARYING SC-INDX FROM 1
  4122             BY 1
  4123             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  4124
  4125     IF NOT EMI-NO-ERRORS
  4126         GO TO 8200-SEND-DATAONLY
  4127     END-IF
  4128
  4129     MOVE LINE1I                     TO PI-CURRENT-LINE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL6522.cbl
  4130     SET TB-INDX                     TO PI-CURRENT-LINE
  4131     MOVE LOW-VALUES                 TO EL6522AI
  4132     PERFORM 7100-FORMAT-SCREEN      THRU 7100-EXIT
  4133             VARYING SC-INDX FROM 1
  4134             BY 1
  4135             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  4136     PERFORM 7200-PUT-TEMP-STOR      THRU 7249-EXIT
  4137     GO TO 8100-SEND-INITIAL-MAP
  4138     .
  4139 6000-NOT-OPEN.
  4140     MOVE ER-3788                    TO EMI-ERROR
  4141     PERFORM 9900-ERROR-FORMAT       THRU 9900-EXIT
  4142
  4143     IF EIBAID = DFHCLEAR
  4144         GO TO 9410-RETURN
  4145     ELSE
  4146         GO TO 8100-SEND-INITIAL-MAP
  4147     END-IF
  4148     .
  4149 7000-BUILD-TABLE.
  4150
  4151     SET TB-INDX                     TO 1
  4152     MOVE ZEROS                      TO PI-TOTAL-LINES
  4153                                        PI-CURRENT-LINE
  4154                                        PI-TEMP-STOR-ITEMS
  4155                                        PI-UPDATE-SW
  4156     MOVE LOW-VALUES                 TO EL6522AI
  4157     PERFORM 7500-READ-TS            THRU 7599-EXIT
  4158
  4159     IF PI-TEMP-STOR-ITEMS NOT = ZERO
  4160         MOVE ER-0140                TO EMI-ERROR
  4161         PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  4162         MULTIPLY PI-TEMP-STOR-ITEMS BY TS-NUM-REC-IN-GROUP
  4163              GIVING PI-TOTAL-LINES
  4164         MOVE 1                      TO PI-CURRENT-LINE
  4165         SET TB-INDX TO 1
  4166         PERFORM 7100-FORMAT-SCREEN  THRU 7100-EXIT
  4167                 VARYING SC-INDX FROM 1
  4168                 BY 1
  4169                 UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  4170         GO TO 8100-SEND-INITIAL-MAP
  4171     END-IF
  4172
  4173
  4174* EXEC CICS HANDLE CONDITION
  4175*         NOTFND(7010-ENDBR)
  4176*         NOTOPEN(6000-NOT-OPEN)
  4177*         ENDFILE(7010-ENDBR)
  4178*    END-EXEC
  4179*    MOVE '"$IJ''                 ! % #00004063' TO DFHEIV0
  4180     MOVE X'2224494A2720202020202020' TO DFHEIV0(1:12)
  4181     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4182     MOVE X'2520233030303034303633' TO DFHEIV0(25:11)
  4183     CALL 'kxdfhei1' USING DFHEIV0
  4184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4185
  4186
  4187* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL6522.cbl
  4188*         DATASET(ERCONT-FILE-ID)
  4189*         RIDFLD(ERCONT-KEY)
  4190*         KEYLENGTH(ERCONT-START-LENGTH)
  4191*         GENERIC
  4192*         GTEQ
  4193*    END-EXEC
  4194     MOVE 0
  4195       TO DFHEIV11
  4196*    MOVE '&,   KG    G          &   #00004069' TO DFHEIV0
  4197     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  4198     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4199     MOVE X'2020233030303034303639' TO DFHEIV0(25:11)
  4200     CALL 'kxdfhei1' USING DFHEIV0,
  4201           ERCONT-FILE-ID,
  4202           ERCONT-KEY,
  4203           ERCONT-START-LENGTH,
  4204           DFHEIV11,
  4205           DFHEIV99
  4206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4207     .
  4208
  4209 7001-LOOP.
  4210
  4211* EXEC CICS READNEXT
  4212*         SET(ADDRESS OF COMP-NOTE-FILE)
  4213*         DATASET(ERCONT-FILE-ID)
  4214*         RIDFLD(ERCONT-KEY)
  4215*    END-EXEC
  4216     MOVE 0
  4217       TO DFHEIV11
  4218*    MOVE '&.S                   )   #00004079' TO DFHEIV0
  4219     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4220     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4221     MOVE X'2020233030303034303739' TO DFHEIV0(25:11)
  4222     CALL 'kxdfhei1' USING DFHEIV0,
  4223           ERCONT-FILE-ID,
  4224           DFHEIV20,
  4225           DFHEIV99,
  4226           ERCONT-KEY,
  4227           DFHEIV99,
  4228           DFHEIV11,
  4229           DFHEIV99,
  4230           DFHEIV99
  4231     SET ADDRESS OF COMP-NOTE-FILE TO
  4232         DFHEIV20
  4233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4234
  4235     IF NF-COMPANY-CD NOT = SV-COMPANY-CD
  4236         GO TO 7010-ENDBR
  4237     END-IF
  4238
  4239     IF (NF-CARRIER = SV-CARRIER) AND
  4240        (NF-GROUPING = SV-GROUPING) AND
  4241        (NF-FIN-RESP-NO = SV-FINRESP) AND
  4242        (NF-ACCOUNT = SV-ACCOUNT)
  4243         MOVE NF-NOTE-LINE         TO REC-TEXT (TB-INDX)
  4244         MOVE NF-LAST-MAINT-BY     TO REC-LAST-MAINT-BY (TB-INDX)
  4245         MOVE NF-LAST-MAINT-DT     TO REC-LAST-MAINT-DT (TB-INDX)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL6522.cbl
  4246         MOVE NF-LAST-MAINT-HHMMSS TO
  4247                                  REC-LAST-MAINT-HHMMSS (TB-INDX)
  4248         SET TB-INDX UP BY 1
  4249         GO TO 7001-LOOP
  4250     END-IF
  4251     .
  4252 7010-ENDBR.
  4253     IF TB-INDX = 1
  4254         MOVE ER-0006                TO EMI-ERROR
  4255         MOVE 'A'                    TO FUNCTI
  4256         MOVE -1                     TO SC-TEXTL (1)
  4257         MOVE AL-UANON               TO FUNCTA
  4258         PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  4259         MOVE ZEROS                  TO PI-TOTAL-LINES
  4260         GO TO 8100-SEND-INITIAL-MAP
  4261     END-IF
  4262
  4263* EXEC CICS ENDBR
  4264*         DATASET(ERCONT-FILE-ID)
  4265*    END-EXEC
  4266     MOVE 0
  4267       TO DFHEIV11
  4268*    MOVE '&2                    $   #00004112' TO DFHEIV0
  4269     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4270     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4271     MOVE X'2020233030303034313132' TO DFHEIV0(25:11)
  4272     CALL 'kxdfhei1' USING DFHEIV0,
  4273           ERCONT-FILE-ID,
  4274           DFHEIV11,
  4275           DFHEIV99
  4276     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4277
  4278     SET TB-INDX DOWN BY 1
  4279     SET PI-TOTAL-LINES              TO TB-INDX
  4280     MOVE 1                          TO PI-CURRENT-LINE
  4281     .
  4282
  4283 7050-FORMAT-LINES.
  4284     SET TB-INDX                     TO PI-CURRENT-LINE
  4285     PERFORM 7100-FORMAT-SCREEN      THRU 7100-EXIT
  4286             VARYING SC-INDX FROM 1
  4287             BY 1
  4288             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  4289     PERFORM 7200-PUT-TEMP-STOR      THRU 7249-EXIT
  4290     GO TO 8100-SEND-INITIAL-MAP
  4291     .
  4292 7100-FORMAT-SCREEN.
  4293     IF TB-INDX > PI-TOTAL-LINES
  4294         IF FUNCTI NOT = 'A'
  4295             MOVE AL-PANON           TO SC-TEXTA (SC-INDX)
  4296         END-IF
  4297     END-IF
  4298
  4299     IF TB-INDX > PI-TOTAL-LINES
  4300         GO TO 7100-EXIT
  4301     END-IF
  4302
  4303     MOVE REC-TEXT (TB-INDX)          TO SC-TEXT (SC-INDX)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL6522.cbl
  4304     MOVE REC-LAST-MAINT-BY (TB-INDX) TO SC-MAINT-BY (SC-INDX)
  4305     PERFORM 7110-FORMAT-DATE         THRU 7110-EXIT
  4306     SET ROLL-COUNTER                 TO TB-INDX
  4307     MOVE ROLL-COUNTER                TO SC-LIN (SC-INDX)
  4308
  4309     IF NOT MODIFY-CAP
  4310         MOVE AL-PANOF                TO SC-TEXTA (SC-INDX)
  4311         SET TB-INDX UP BY 1
  4312         GO TO 7100-EXIT
  4313     END-IF
  4314
  4315     IF (REC-LAST-MAINT-BY (TB-INDX) NOT = SPACES AND LOW-VALUES)
  4316          AND
  4317        (REC-LAST-MAINT-BY (TB-INDX) NOT EQUAL PI-PROCESSOR-ID)
  4318         MOVE AL-PANOF                TO SC-TEXTA (SC-INDX)
  4319         SET TB-INDX UP BY 1
  4320         GO TO 7100-EXIT
  4321     END-IF
  4322
  4323     IF (REC-LAST-MAINT-DT (TB-INDX) = SAVE-BIN-DATE OR
  4324                              LOW-VALUES OR SPACES)
  4325         SET TB-INDX UP BY 1
  4326     ELSE
  4327         MOVE AL-PANOF                TO SC-TEXTA (SC-INDX)
  4328         SET TB-INDX UP BY 1
  4329     END-IF
  4330     .
  4331 7100-EXIT.
  4332      EXIT.
  4333
  4334 7110-FORMAT-DATE.
  4335     IF REC-LAST-MAINT-DT (TB-INDX) = LOW-VALUES OR SPACES
  4336         CONTINUE
  4337     ELSE
  4338         MOVE REC-LAST-MAINT-DT (TB-INDX) TO DC-BIN-DATE-1
  4339         MOVE SPACES                      TO DC-OPTION-CODE
  4340         PERFORM 9700-LINK-DATE-CONVERT   THRU 9700-EXIT
  4341         MOVE DC-GREG-DATE-1-MDY          TO
  4342                                          SC-MAINT-DT (SC-INDX)
  4343     END-IF
  4344     .
  4345 7110-EXIT.
  4346     EXIT.
  4347
  4348 7200-PUT-TEMP-STOR.
  4349     PERFORM 7250-DELETE-TEMP-STOR    THRU 7299-EXIT
  4350     SET TS-INDX                      TO 1
  4351     MOVE 0                           TO PI-TEMP-STOR-ITEMS
  4352     PERFORM 7300-WRITE-TS            THRU 7399-EXIT
  4353             VARYING TS-GROUP-WORK FROM 0
  4354             BY TS-NUM-REC-IN-GROUP
  4355             UNTIL TS-GROUP-WORK NOT LESS THAN PI-TOTAL-LINES
  4356     .
  4357 7249-EXIT.
  4358     EXIT.
  4359 7250-DELETE-TEMP-STOR.
  4360
  4361* EXEC CICS HANDLE CONDITION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL6522.cbl
  4362*         QIDERR(7299-EXIT)
  4363*    END-EXEC
  4364*    MOVE '"$N                   ! & #00004198' TO DFHEIV0
  4365     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  4366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4367     MOVE X'2620233030303034313938' TO DFHEIV0(25:11)
  4368     CALL 'kxdfhei1' USING DFHEIV0
  4369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4370
  4371* EXEC CICS DELETEQ TS
  4372*         QUEUE(QID)
  4373*    END-EXEC
  4374*    MOVE '*&                    #   #00004201' TO DFHEIV0
  4375     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  4376     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  4377     MOVE X'2020233030303034323031' TO DFHEIV0(25:11)
  4378     CALL 'kxdfhei1' USING DFHEIV0,
  4379           QID,
  4380           DFHEIV99
  4381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4382     .
  4383 7299-EXIT.
  4384     EXIT.
  4385 7300-WRITE-TS.
  4386     MOVE TS-GROUP (TS-INDX)          TO TS-WORK-AREA
  4387     SET TS-INDX UP BY 1
  4388     ADD 1                            TO PI-TEMP-STOR-ITEMS
  4389
  4390* EXEC CICS WRITEQ TS
  4391*         FROM(TS-WORK-AREA)
  4392*         QUEUE(QID)
  4393*         LENGTH(TS-LENGTH)
  4394*         ITEM(PI-TEMP-STOR-ITEMS)
  4395*    END-EXEC
  4396*    MOVE '*" I                  ''   #00004211' TO DFHEIV0
  4397     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  4398     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4399     MOVE X'2020233030303034323131' TO DFHEIV0(25:11)
  4400     CALL 'kxdfhei1' USING DFHEIV0,
  4401           QID,
  4402           TS-WORK-AREA,
  4403           TS-LENGTH,
  4404           PI-TEMP-STOR-ITEMS,
  4405           DFHEIV99,
  4406           DFHEIV99
  4407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4408     .
  4409 7399-EXIT.
  4410     EXIT.
  4411 7400-PAGE-ROUTINE.
  4412
  4413     IF PFENTERL NOT = ZEROS
  4414         MOVE -1                           TO PFENTERL
  4415     ELSE
  4416         MOVE -1                           TO FUNCTL
  4417     END-IF
  4418
  4419     IF PI-TOTAL-LINES = 0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL6522.cbl
  4420         MOVE ER-0047                      TO EMI-ERROR
  4421         MOVE -1                           TO FUNCTL
  4422         PERFORM 9900-ERROR-FORMAT         THRU 9900-EXIT
  4423         GO TO 8200-SEND-DATAONLY
  4424     END-IF
  4425
  4426     COMPUTE TEMP-CURR-LINE = PI-CURRENT-LINE + ROLL-COUNTER
  4427
  4428     IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  4429         MOVE ER-0067                      TO EMI-ERROR
  4430         PERFORM 9900-ERROR-FORMAT         THRU 9900-EXIT
  4431         MOVE 1                            TO TEMP-CURR-LINE
  4432     END-IF
  4433
  4434     IF TEMP-CURR-LINE > PI-TOTAL-LINES
  4435         MOVE ER-0066                      TO EMI-ERROR
  4436         PERFORM 9900-ERROR-FORMAT         THRU 9900-EXIT
  4437         COMPUTE TEMP-CURR-LINE = PI-TOTAL-LINES + 1
  4438                               - NUM-LINES-PER-SCREEN
  4439         IF TEMP-CURR-LINE NEGATIVE OR TEMP-CURR-LINE = ZEROS
  4440             MOVE 1                        TO TEMP-CURR-LINE
  4441         END-IF
  4442     END-IF
  4443
  4444     PERFORM 7450-SET-INDX                 THRU 7450-EXIT
  4445     PERFORM 7600-UPDATE-TABLE-FROM-SCREEN THRU 7699-EXIT
  4446             VARYING SC-INDX FROM 1
  4447             BY 1
  4448             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  4449
  4450     IF EMI-ERROR = ER-0066 OR = ER-0067 OR = ZEROS
  4451         CONTINUE
  4452     ELSE
  4453         GO TO 8200-SEND-DATAONLY
  4454     END-IF
  4455
  4456     MOVE TEMP-CURR-LINE                   TO PI-CURRENT-LINE
  4457     SET TB-INDX                           TO PI-CURRENT-LINE
  4458     MOVE LOW-VALUES                       TO EL6522AI
  4459     PERFORM 7100-FORMAT-SCREEN            THRU 7100-EXIT
  4460             VARYING SC-INDX FROM 1
  4461             BY 1
  4462             UNTIL SC-INDX > NUM-LINES-PER-SCREEN
  4463     PERFORM 7200-PUT-TEMP-STOR            THRU 7249-EXIT
  4464     GO TO 8100-SEND-INITIAL-MAP
  4465     .
  4466
  4467 7450-SET-INDX.
  4468     IF PI-CURRENT-LINE = 0 AND PI-TOTAL-LINES = 0
  4469         SET TB-INDX                       TO 1
  4470     ELSE
  4471         PERFORM 7500-READ-TS              THRU 7599-EXIT
  4472         IF PI-CURRENT-LINE = 0
  4473             SET TB-INDX                   TO 1
  4474         ELSE
  4475             SET TB-INDX                   TO PI-CURRENT-LINE
  4476         END-IF
  4477     END-IF
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL6522.cbl
  4478     .
  4479 7450-EXIT.
  4480     EXIT.
  4481 7500-READ-TS.
  4482
  4483* EXEC CICS HANDLE CONDITION
  4484*         QIDERR(7590-TS-QIDERR)
  4485*         ITEMERR(7585-QID-ITEMERR)
  4486*    END-EXEC
  4487*    MOVE '"$N<                  ! '' #00004291' TO DFHEIV0
  4488     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  4489     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4490     MOVE X'2720233030303034323931' TO DFHEIV0(25:11)
  4491     CALL 'kxdfhei1' USING DFHEIV0
  4492     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4493     SET TS-INDX                           TO 1
  4494     MOVE 1                                TO QID-ITEM
  4495     PERFORM 7501-LOOP THRU 7501-EXIT
  4496             VARYING TS-GROUP-WORK FROM 0
  4497             BY TS-NUM-REC-IN-GROUP
  4498             UNTIL TS-GROUP-WORK NOT < PI-TOTAL-LINES
  4499     IF EIBTRNID NOT = TRANS-ID
  4500         SUBTRACT +1 FROM QID-ITEM
  4501         MOVE QID-ITEM                     TO PI-TEMP-STOR-ITEMS
  4502     END-IF
  4503     GO TO 7599-EXIT
  4504     .
  4505 7500-EXIT.
  4506     EXIT.
  4507 7501-LOOP.
  4508
  4509* EXEC CICS READQ TS
  4510*         INTO (TS-WORK-AREA)
  4511*         QUEUE (QID)
  4512*         LENGTH (TS-LENGTH)
  4513*         ITEM (QID-ITEM)
  4514*    END-EXEC
  4515*    MOVE '*$II   L              ''   #00004310' TO DFHEIV0
  4516     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  4517     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4518     MOVE X'2020233030303034333130' TO DFHEIV0(25:11)
  4519     CALL 'kxdfhei1' USING DFHEIV0,
  4520           QID,
  4521           TS-WORK-AREA,
  4522           TS-LENGTH,
  4523           QID-ITEM,
  4524           DFHEIV99,
  4525           DFHEIV99
  4526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4527     MOVE TS-WORK-AREA                     TO TS-GROUP (TS-INDX)
  4528     SET TS-INDX UP BY 1
  4529     ADD +1                                TO QID-ITEM
  4530     .
  4531 7501-EXIT.
  4532     EXIT.
  4533
  4534 7585-QID-ITEMERR.
  4535     IF EIBTRNID NOT = TRANS-ID
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL6522.cbl
  4536         SUBTRACT 1 FROM QID-ITEM
  4537         MOVE QID-ITEM                     TO PI-TEMP-STOR-ITEMS
  4538         GO TO 7599-EXIT
  4539     END-IF
  4540
  4541     .
  4542 7590-TS-QIDERR.
  4543     IF EIBTRNID = TRANS-ID
  4544         AND EIBAID = DFHCLEAR
  4545         GO TO 9410-RETURN
  4546     END-IF
  4547     IF EIBTRNID = TRANS-ID
  4548         MOVE ER-0033                      TO EMI-ERROR
  4549         PERFORM 9900-ERROR-FORMAT         THRU 9900-EXIT
  4550         GO TO 8100-SEND-INITIAL-MAP
  4551     END-IF
  4552     .
  4553 7599-EXIT.
  4554     EXIT.
  4555
  4556 7600-UPDATE-TABLE-FROM-SCREEN.
  4557
  4558     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  4559         IF TB-INDX NOT > PI-TOTAL-LINES
  4560             PERFORM 7700-MOVE-DATA        THRU 7700-EXIT
  4561             SET TB-INDX UP BY 1
  4562         ELSE
  4563             IF PI-TOTAL-LINES = MAX-LINES
  4564                 MOVE ER-0051              TO EMI-ERROR
  4565                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4566                 GO TO 8200-SEND-DATAONLY
  4567             ELSE
  4568                 PERFORM 7700-MOVE-DATA    THRU 7700-EXIT
  4569                 SET TB-INDX UP BY 1
  4570                 ADD 1                     TO PI-TOTAL-LINES
  4571             END-IF
  4572         END-IF
  4573     ELSE
  4574         IF TB-INDX NOT > PI-TOTAL-LINES
  4575             SET TB-INDX UP BY 1
  4576         END-IF
  4577     END-IF
  4578     .
  4579 7699-EXIT.
  4580     EXIT.
  4581
  4582 7700-MOVE-DATA.
  4583     MOVE '1'                              TO PI-UPDATE-SW
  4584
  4585     IF SC-TEXTL (SC-INDX) NOT = ZEROS
  4586         MOVE SC-TEXT (SC-INDX)            TO REC-TEXT (TB-INDX)
  4587     END-IF
  4588
  4589     IF REC-LAST-MAINT-DT (TB-INDX) = LOW-VALUES OR SPACES
  4590         MOVE PI-PROCESSOR-ID  TO REC-LAST-MAINT-BY (TB-INDX)
  4591                                  SC-MAINT-BY (SC-INDX)
  4592         MOVE EIBTIME          TO REC-LAST-MAINT-HHMMSS (TB-INDX)
  4593         MOVE SAVE-BIN-DATE    TO REC-LAST-MAINT-DT (TB-INDX)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL6522.cbl
  4594     END-IF
  4595
  4596     PERFORM 7110-FORMAT-DATE
  4597     .
  4598 7700-EXIT.
  4599     EXIT.
  4600 8100-SEND-INITIAL-MAP.
  4601     MOVE SAVE-DATE                        TO DATEO
  4602     MOVE EIBTIME                          TO TIME-IN
  4603     MOVE TIME-OUT                         TO TIMEO
  4604     MOVE PI-COMPANY-ID                    TO CMPNYIDO
  4605     MOVE PI-PROCESSOR-ID                  TO USERIDO
  4606     MOVE EMI-MESSAGE-AREA (1)             TO ERRMSGBO
  4607     MOVE PI-CR-CARRIER                    TO CARRO
  4608     MOVE PI-CR-GROUPING                   TO GROUPO
  4609     MOVE PI-CR-TYPE                       TO TYPEO
  4610     MOVE PI-CR-FIN-RESP                   TO FINRESPO
  4611     MOVE PI-CR-ACCOUNT                    TO ACCTO
  4612     MOVE PI-SAVE-ACCT-NAME                TO NAMEO
  4613     MOVE PI-TOTAL-LINES                   TO TOTO
  4614     MOVE -1                               TO FUNCTL
  4615
  4616
  4617* EXEC CICS SEND
  4618*         MAP(MAP-NAME)
  4619*         MAPSET(MAPSET-NAME)
  4620*         FROM(EL6522AO)
  4621*         ERASE
  4622*         CURSOR
  4623*    END-EXEC
  4624     MOVE LENGTH OF
  4625      EL6522AO
  4626       TO DFHEIV12
  4627     MOVE -1
  4628       TO DFHEIV11
  4629*    MOVE '8$     CT  E    H L F ,   #00004405' TO DFHEIV0
  4630     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  4631     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4632     MOVE X'2020233030303034343035' TO DFHEIV0(25:11)
  4633     CALL 'kxdfhei1' USING DFHEIV0,
  4634           MAP-NAME,
  4635           EL6522AO,
  4636           DFHEIV12,
  4637           MAPSET-NAME,
  4638           DFHEIV99,
  4639           DFHEIV99,
  4640           DFHEIV99,
  4641           DFHEIV11,
  4642           DFHEIV99,
  4643           DFHEIV99,
  4644           DFHEIV99
  4645     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4646
  4647     GO TO 9100-RETURN-TRAN
  4648     .
  4649
  4650 8200-SEND-DATAONLY.
  4651     MOVE EIBTIME                          TO TIME-IN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL6522.cbl
  4652     MOVE TIME-OUT                         TO TIMEO
  4653     MOVE PI-COMPANY-ID                    TO CMPNYIDO
  4654     MOVE PI-PROCESSOR-ID                  TO USERIDO
  4655     MOVE PI-TOTAL-LINES                   TO TOTO
  4656
  4657     IF NOT EMI-NO-ERRORS
  4658         MOVE EMI-MESSAGE-AREA (1)         TO ERRMSGBO
  4659     ELSE
  4660         MOVE -1                           TO FUNCTL
  4661     END-IF
  4662
  4663
  4664* EXEC CICS SEND
  4665*         MAP(MAP-NAME)
  4666*         MAPSET(MAPSET-NAME)
  4667*         FROM(EL6522AO)
  4668*         DATAONLY
  4669*         CURSOR
  4670*    END-EXEC
  4671     MOVE LENGTH OF
  4672      EL6522AO
  4673       TO DFHEIV12
  4674     MOVE -1
  4675       TO DFHEIV11
  4676*    MOVE '8$D    CT       H L F ,   #00004429' TO DFHEIV0
  4677     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  4678     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  4679     MOVE X'2020233030303034343239' TO DFHEIV0(25:11)
  4680     CALL 'kxdfhei1' USING DFHEIV0,
  4681           MAP-NAME,
  4682           EL6522AO,
  4683           DFHEIV12,
  4684           MAPSET-NAME,
  4685           DFHEIV99,
  4686           DFHEIV99,
  4687           DFHEIV99,
  4688           DFHEIV11,
  4689           DFHEIV99,
  4690           DFHEIV99,
  4691           DFHEIV99
  4692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4693
  4694     GO TO 9100-RETURN-TRAN
  4695     .
  4696
  4697 8300-SEND-TEXT.
  4698
  4699* EXEC CICS SEND TEXT
  4700*         FROM(LOGOFF-TEXT)
  4701*         ERASE
  4702*         FREEKB
  4703*         LENGTH(LOGOFF-LENGTH)
  4704*    END-EXEC
  4705*    MOVE '8&      T  E F  H   F -   #00004441' TO DFHEIV0
  4706     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  4707     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  4708     MOVE X'2020233030303034343431' TO DFHEIV0(25:11)
  4709     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL6522.cbl
  4710           LOGOFF-TEXT,
  4711           LOGOFF-LENGTH,
  4712           DFHEIV99,
  4713           DFHEIV99,
  4714           DFHEIV99,
  4715           DFHEIV99,
  4716           DFHEIV99,
  4717           DFHEIV99,
  4718           DFHEIV99,
  4719           DFHEIV99,
  4720           DFHEIV99,
  4721           DFHEIV99
  4722     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4723
  4724     PERFORM 7250-DELETE-TEMP-STOR         THRU 7299-EXIT
  4725
  4726
  4727* EXEC CICS RETURN
  4728*    END-EXEC
  4729*    MOVE '.(                    &   #00004450' TO DFHEIV0
  4730     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  4731     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4732     MOVE X'2020233030303034343530' TO DFHEIV0(25:11)
  4733     CALL 'kxdfhei1' USING DFHEIV0,
  4734           DFHEIV99,
  4735           DFHEIV99,
  4736           DFHEIV99,
  4737           DFHEIV99,
  4738           DFHEIV99
  4739     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4740     .
  4741
  4742 8800-UNAUTHORIZED-ACCESS.
  4743     MOVE UNACCESS-MSG                     TO LOGOFF-MSG
  4744     GO TO 8300-SEND-TEXT
  4745     .
  4746
  4747 9000-RETURN-CICS.
  4748     IF PI-CHANGES-MADE
  4749         MOVE ER-0045                      TO EMI-ERROR
  4750         MOVE -1                           TO FUNCTL
  4751         MOVE SPACES                       TO PFENTERO
  4752         MOVE AL-UNNOF                     TO PFENTERA
  4753         PERFORM 9900-ERROR-FORMAT         THRU 9900-EXIT
  4754         GO TO 8200-SEND-DATAONLY
  4755     END-IF
  4756
  4757     MOVE EIBAID                           TO PI-ENTRY-CD-1
  4758     MOVE XCTL-005                         TO PGM-NAME
  4759     GO TO 9300-XCTL
  4760     .
  4761
  4762 9100-RETURN-TRAN.
  4763     MOVE SCRN-NUMBER                    TO PI-CURRENT-SCREEN-NO
  4764     MOVE EMI-ERROR-NUMBER (1)           TO PI-LAST-ERROR-NO
  4765
  4766* EXEC CICS RETURN
  4767*         TRANSID(TRANS-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL6522.cbl
  4768*         COMMAREA(PROGRAM-INTERFACE-BLOCK)
  4769*         LENGTH(PI-COMM-LENGTH)
  4770*    END-EXEC
  4771*    MOVE '.(CT                  &   #00004477' TO DFHEIV0
  4772     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4773     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4774     MOVE X'2020233030303034343737' TO DFHEIV0(25:11)
  4775     CALL 'kxdfhei1' USING DFHEIV0,
  4776           TRANS-ID,
  4777           PROGRAM-INTERFACE-BLOCK,
  4778           PI-COMM-LENGTH,
  4779           DFHEIV99,
  4780           DFHEIV99
  4781     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4782
  4783     .
  4784 9200-RETURN-MAIN-MENU.
  4785     IF PI-CHANGES-MADE
  4786         MOVE -1                         TO FUNCTL
  4787         MOVE SPACES                     TO PFENTERO
  4788         MOVE AL-UNNOF                   TO PFENTERA
  4789         MOVE ER-0045                    TO EMI-ERROR
  4790         PERFORM 9900-ERROR-FORMAT       THRU 9900-EXIT
  4791         GO TO 8200-SEND-DATAONLY
  4792     END-IF
  4793
  4794     MOVE XCTL-126                       TO PGM-NAME
  4795     .
  4796
  4797 9300-XCTL.
  4798     PERFORM 7250-DELETE-TEMP-STOR       THRU 7299-EXIT
  4799
  4800* EXEC CICS XCTL
  4801*         PROGRAM  (PGM-NAME)
  4802*         COMMAREA (PROGRAM-INTERFACE-BLOCK)
  4803*         LENGTH   (PI-COMM-LENGTH)
  4804*    END-EXEC
  4805*    MOVE '.$C                   $   #00004499' TO DFHEIV0
  4806     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4807     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4808     MOVE X'2020233030303034343939' TO DFHEIV0(25:11)
  4809     CALL 'kxdfhei1' USING DFHEIV0,
  4810           PGM-NAME,
  4811           PROGRAM-INTERFACE-BLOCK,
  4812           PI-COMM-LENGTH
  4813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4814     .
  4815
  4816 9400-CLEAR.
  4817
  4818     IF PI-CHANGES-MADE
  4819         MOVE ER-0045                    TO EMI-ERROR
  4820         PERFORM 9900-ERROR-FORMAT       THRU 9900-EXIT
  4821         IF PI-CURRENT-LINE > ZERO
  4822             PERFORM 7500-READ-TS        THRU 7599-EXIT
  4823             SET TB-INDX                 TO PI-CURRENT-LINE
  4824             PERFORM 7100-FORMAT-SCREEN  THRU 7100-EXIT
  4825                     VARYING SC-INDX FROM 1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL6522.cbl
  4826                     BY 1
  4827                     UNTIL SC-INDX GREATER NUM-LINES-PER-SCREEN
  4828         END-IF
  4829         GO TO 8100-SEND-INITIAL-MAP
  4830     END-IF
  4831     .
  4832
  4833 9410-RETURN.
  4834     MOVE PI-RETURN-TO-PROGRAM           TO PGM-NAME
  4835     GO TO 9300-XCTL
  4836     .
  4837
  4838 9500-PF12.
  4839     IF PI-CHANGES-MADE
  4840         MOVE -1                         TO FUNCTL
  4841         MOVE SPACES                     TO PFENTERO
  4842         MOVE AL-UNNOF                   TO PFENTERA
  4843         MOVE ER-0045                    TO EMI-ERROR
  4844         PERFORM 9900-ERROR-FORMAT       THRU 9900-EXIT
  4845         GO TO 8200-SEND-DATAONLY
  4846     END-IF
  4847
  4848     MOVE 'EL010'                        TO PGM-NAME
  4849     GO TO 9300-XCTL
  4850     .
  4851
  4852 9550-START-PRINT.
  4853     PERFORM 7200-PUT-TEMP-STOR          THRU 7249-EXIT
  4854
  4855     MOVE SPACES                         TO ELCNTL-KEY
  4856     MOVE PI-COMPANY-ID                  TO ELCNTL-COMPANY
  4857     MOVE '1'                            TO ELCNTL-REC-TYPE
  4858     MOVE ZEROS                          TO ELCNTL-SEQ-NO
  4859
  4860
  4861* EXEC CICS HANDLE CONDITION
  4862*         NOTFND(9410-RETURN)
  4863*    END-EXEC
  4864*    MOVE '"$I                   ! ( #00004550' TO DFHEIV0
  4865     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  4866     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4867     MOVE X'2820233030303034353530' TO DFHEIV0(25:11)
  4868     CALL 'kxdfhei1' USING DFHEIV0
  4869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4870
  4871
  4872* EXEC CICS READ DATASET (ELCNTL-FILE-ID)
  4873*         SET (ADDRESS OF CONTROL-FILE)
  4874*         RIDFLD (ELCNTL-KEY)
  4875*    END-EXEC
  4876*    MOVE '&"S        E          (   #00004554' TO DFHEIV0
  4877     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4878     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4879     MOVE X'2020233030303034353534' TO DFHEIV0(25:11)
  4880     CALL 'kxdfhei1' USING DFHEIV0,
  4881           ELCNTL-FILE-ID,
  4882           DFHEIV20,
  4883           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL6522.cbl
  4884           ELCNTL-KEY,
  4885           DFHEIV99,
  4886           DFHEIV99,
  4887           DFHEIV99
  4888     SET ADDRESS OF CONTROL-FILE TO
  4889         DFHEIV20
  4890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4891
  4892
  4893* EXEC CICS HANDLE CONDITION
  4894*         TERMIDERR (9560-BAD-TERMID)
  4895*         TRANSIDERR (9570-BAD-TRANSID)
  4896*    END-EXEC
  4897*    MOVE '"$[\                  ! ) #00004559' TO DFHEIV0
  4898     MOVE X'22245B5C2020202020202020' TO DFHEIV0(1:12)
  4899     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4900     MOVE X'2920233030303034353539' TO DFHEIV0(25:11)
  4901     CALL 'kxdfhei1' USING DFHEIV0
  4902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4903
  4904
  4905* EXEC CICS START
  4906*         TRANSID (W-PRINT-TRANS)
  4907*         TERMID (CF-FORMS-PRINTER-ID)
  4908*         FROM (PROGRAM-INTERFACE-BLOCK)
  4909*         LENGTH (PI-COMM-LENGTH)
  4910*    END-EXEC
  4911*    MOVE '0( LFT                0   #00004564' TO DFHEIV0
  4912     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  4913     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  4914     MOVE X'2020233030303034353634' TO DFHEIV0(25:11)
  4915     CALL 'kxdfhei1' USING DFHEIV0,
  4916           DFHEIV99,
  4917           W-PRINT-TRANS,
  4918           DFHEIV99,
  4919           PROGRAM-INTERFACE-BLOCK,
  4920           PI-COMM-LENGTH,
  4921           CF-FORMS-PRINTER-ID,
  4922           DFHEIV99,
  4923           DFHEIV99,
  4924           DFHEIV99,
  4925           DFHEIV99,
  4926           DFHEIV99,
  4927           DFHEIV99,
  4928           DFHEIV99,
  4929           DFHEIV99,
  4930           DFHEIV99
  4931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4932
  4933     MOVE -1                             TO LINE1L
  4934     MOVE ER-3784                        TO EMI-ERROR
  4935     PERFORM 9900-ERROR-FORMAT           THRU 9900-EXIT
  4936     GO TO 8200-SEND-DATAONLY
  4937     .
  4938
  4939 9560-BAD-TERMID.
  4940     MOVE ER-0412                        TO EMI-ERROR
  4941     PERFORM 9900-ERROR-FORMAT           THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL6522.cbl
  4942     GO TO 8200-SEND-DATAONLY
  4943     .
  4944
  4945 9570-BAD-TRANSID.
  4946     MOVE ER-0413                        TO EMI-ERROR
  4947     PERFORM 9900-ERROR-FORMAT           THRU 9900-EXIT
  4948     GO TO 8200-SEND-DATAONLY
  4949     .
  4950
  4951 9600-PGMID-ERROR.
  4952
  4953* EXEC CICS HANDLE CONDITION
  4954*         PGMIDERR (8300-SEND-TEXT)
  4955*    END-EXEC
  4956*    MOVE '"$L                   ! * #00004590' TO DFHEIV0
  4957     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4958     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4959     MOVE X'2A20233030303034353930' TO DFHEIV0(25:11)
  4960     CALL 'kxdfhei1' USING DFHEIV0
  4961     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4962
  4963     MOVE PGM-NAME                       TO PI-CALLING-PROGRAM
  4964     MOVE SPACES                         TO PI-ENTRY-CD-1
  4965     MOVE XCTL-005                       TO PGM-NAME
  4966     MOVE PGM-NAME                       TO LOGOFF-PGM
  4967     MOVE PGMIDERR-MSG                   TO LOGOFF-FILL
  4968
  4969     GO TO 9300-XCTL
  4970     .
  4971
  4972 9700-LINK-DATE-CONVERT.
  4973
  4974     MOVE LINK-ELDATCV                   TO PGM-NAME
  4975
  4976* EXEC CICS LINK
  4977*         PROGRAM (PGM-NAME)
  4978*         COMMAREA (DATE-CONVERSION-DATA)
  4979*         LENGTH (DC-COMM-LENGTH)
  4980*    END-EXEC
  4981*    MOVE '."C                   ''   #00004606' TO DFHEIV0
  4982     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4983     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4984     MOVE X'2020233030303034363036' TO DFHEIV0(25:11)
  4985     CALL 'kxdfhei1' USING DFHEIV0,
  4986           PGM-NAME,
  4987           DATE-CONVERSION-DATA,
  4988           DC-COMM-LENGTH,
  4989           DFHEIV99,
  4990           DFHEIV99,
  4991           DFHEIV99
  4992     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4993     .
  4994 9700-EXIT.
  4995     EXIT.
  4996
  4997 9900-ERROR-FORMAT.
  4998     IF NOT EMI-ERRORS-COMPLETE
  4999         MOVE LINK-001                   TO PGM-NAME
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL6522.cbl
  5000
  5001* EXEC CICS LINK
  5002*             PROGRAM (PGM-NAME)
  5003*             COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  5004*             LENGTH (EMI-COMM-LENGTH)
  5005*        END-EXEC
  5006*    MOVE '."C                   ''   #00004618' TO DFHEIV0
  5007     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5008     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5009     MOVE X'2020233030303034363138' TO DFHEIV0(25:11)
  5010     CALL 'kxdfhei1' USING DFHEIV0,
  5011           PGM-NAME,
  5012           ERROR-MESSAGE-INTERFACE-BLOCK,
  5013           EMI-COMM-LENGTH,
  5014           DFHEIV99,
  5015           DFHEIV99,
  5016           DFHEIV99
  5017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5018     END-IF
  5019     .
  5020 9900-EXIT.
  5021     EXIT.
  5022
  5023 9990-ABEND.
  5024     MOVE LINK-004                       TO PGM-NAME
  5025     MOVE DFHEIBLK                       TO EMI-LINE1
  5026
  5027
  5028* EXEC CICS LINK
  5029*         PROGRAM (PGM-NAME)
  5030*         COMMAREA (EMI-LINE1)
  5031*         LENGTH (72)
  5032*    END-EXEC
  5033     MOVE 72
  5034       TO DFHEIV11
  5035*    MOVE '."C                   ''   #00004632' TO DFHEIV0
  5036     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5037     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5038     MOVE X'2020233030303034363332' TO DFHEIV0(25:11)
  5039     CALL 'kxdfhei1' USING DFHEIV0,
  5040           PGM-NAME,
  5041           EMI-LINE1,
  5042           DFHEIV11,
  5043           DFHEIV99,
  5044           DFHEIV99,
  5045           DFHEIV99
  5046     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5047
  5048     MOVE EMI-MESSAGE-AREA (1)           TO ERRMSGBO
  5049     MOVE -1                             TO FUNCTL
  5050
  5051     GO TO 8100-SEND-INITIAL-MAP
  5052
  5053
  5054* GOBACK
  5055
  5056     MOVE '9%                    "   ' TO DFHEIV0
  5057     MOVE 'EL6522' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL6522.cbl
  5058     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5059     GOBACK
  5060     .
  5061
  5062 9995-SECURITY-VIOLATION.
  5063*                                COPY ELCSCTP.
  5064******************************************************************
  5065*                                                                *
  5066*                            ELCSCTP                             *
  5067*                            VMOD=2.001                          *
  5068*                                                                *
  5069*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  5070******************************************************************
  5071
  5072
  5073     MOVE EIBDATE          TO SM-JUL-DATE.
  5074     MOVE EIBTRMID         TO SM-TERMID.
  5075     MOVE THIS-PGM         TO SM-PGM.
  5076     MOVE EIBTIME          TO TIME-IN.
  5077     MOVE TIME-OUT         TO SM-TIME.
  5078     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  5079
  5080
  5081* EXEC CICS LINK
  5082*         PROGRAM  ('EL003')
  5083*         COMMAREA (SECURITY-MESSAGE)
  5084*         LENGTH   (80)
  5085*    END-EXEC.
  5086     MOVE 'EL003' TO DFHEIV1
  5087     MOVE 80
  5088       TO DFHEIV11
  5089*    MOVE '."C                   ''   #00004664' TO DFHEIV0
  5090     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5091     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5092     MOVE X'2020233030303034363634' TO DFHEIV0(25:11)
  5093     CALL 'kxdfhei1' USING DFHEIV0,
  5094           DFHEIV1,
  5095           SECURITY-MESSAGE,
  5096           DFHEIV11,
  5097           DFHEIV99,
  5098           DFHEIV99,
  5099           DFHEIV99
  5100     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5101
  5102
  5103******************************************************************
  5104
  5105
  5106 9995-EXIT.
  5107     EXIT.
  5108
  5109 9999-DFHBACK SECTION.
  5110     MOVE '9%                    "   ' TO DFHEIV0
  5111     MOVE 'EL6522' TO DFHEIV1
  5112     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5113     GOBACK.
  5114 9999-DFHEXIT.
  5115     IF DFHEIGDJ EQUAL 0001
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL6522.cbl
  5116         NEXT SENTENCE
  5117     ELSE IF DFHEIGDJ EQUAL 2
  5118         GO TO 9400-CLEAR
  5119         DEPENDING ON DFHEIGDI
  5120     ELSE IF DFHEIGDJ EQUAL 3
  5121         GO TO 9990-ABEND,
  5122               9600-PGMID-ERROR
  5123         DEPENDING ON DFHEIGDI
  5124     ELSE IF DFHEIGDJ EQUAL 4
  5125         GO TO 4610-ENDBR,
  5126               6000-NOT-OPEN,
  5127               4610-ENDBR
  5128         DEPENDING ON DFHEIGDI
  5129     ELSE IF DFHEIGDJ EQUAL 5
  5130         GO TO 7010-ENDBR,
  5131               6000-NOT-OPEN,
  5132               7010-ENDBR
  5133         DEPENDING ON DFHEIGDI
  5134     ELSE IF DFHEIGDJ EQUAL 6
  5135         GO TO 7299-EXIT
  5136         DEPENDING ON DFHEIGDI
  5137     ELSE IF DFHEIGDJ EQUAL 7
  5138         GO TO 7590-TS-QIDERR,
  5139               7585-QID-ITEMERR
  5140         DEPENDING ON DFHEIGDI
  5141     ELSE IF DFHEIGDJ EQUAL 8
  5142         GO TO 9410-RETURN
  5143         DEPENDING ON DFHEIGDI
  5144     ELSE IF DFHEIGDJ EQUAL 9
  5145         GO TO 9560-BAD-TERMID,
  5146               9570-BAD-TRANSID
  5147         DEPENDING ON DFHEIGDI
  5148     ELSE IF DFHEIGDJ EQUAL 10
  5149         GO TO 8300-SEND-TEXT
  5150         DEPENDING ON DFHEIGDI.
  5151     MOVE '9%                    "   ' TO DFHEIV0
  5152     MOVE 'EL6522' TO DFHEIV1
  5153     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5154     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       30108     Code:       11303
