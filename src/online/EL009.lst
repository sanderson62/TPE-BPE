* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL009.cbl
* Options: int("EL009.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL009.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL009.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL009.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL009 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 09:25:21.
     7*            PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.006
     9*
    10*
    11*AUTHOR.     LOGIC,INC.
    12*            DALLAS, TEXAS.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL009.cbl
    14*DATE-COMPILED.
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.    TRANSACTION - EXDT - DATE CONVERSION WORKSHEET
    26*        THIS PROGRAM IS USED TO REVIEW THE DATE CONVERSIONS
    27*        DONE BY THE SUBROUTINE ELDATCV.
    28
    29
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL009.cbl
    31 ENVIRONMENT DIVISION.
    32 DATA DIVISION.
    33 WORKING-STORAGE SECTION.
    34 01  DFH-START PIC X(04).
    35 01  LCP-TIME-OF-DAY-XX.
    36     05  LCP-TIME-OF-DAY-68        PIC 9(6).
    37     05  FILLER                    PIC 99.
    38 01  LCP-CICS-TIME                 PIC 9(15).
    39 77  FILLER  PIC X(32)  VALUE '********************************'.
    40 77  FILLER  PIC X(32)  VALUE '*    EL009 WORKING STORAGE     *'.
    41 77  FILLER  PIC X(32)  VALUE '************ VMOD=2.006 ********'.
    42
    43 01  WS-DATE-AREA.
    44     12  SAVE-DATE           PIC X(8).
    45
    46     12  W-CURRENT-DATE      PIC 9(7)      VALUE 0.
    47     12  FILLER REDEFINES W-CURRENT-DATE.
    48         16 FILLER           PIC 9(1).
    49         16 W-CD-CCYY        PIC 9(3).
    50         16 W-CD-CCYY-R REDEFINES W-CD-CCYY.
    51            20 W-JULIAN-CEN  PIC 9(1).
    52            20 W-CD-YEAR     PIC 9(2).
    53         16 FILLER           PIC 9(3).
    54     12  W-CURRENT-DT REDEFINES W-CURRENT-DATE
    55                             PIC 9(07).
    56     12  W-CURRENT-DT-R REDEFINES W-CURRENT-DATE.
    57         16  W-CD-YEAR-CD        PIC  9.
    58         16  W-CURRENT-YEAR-YY   PIC  99.
    59         16  W-CURRENT-MONTH     PIC  99.
    60         16  W-CURRENT-DAY       PIC  99.
    61
    62     12  W-FLOAT-YEAR        PIC  9(3).
    63     12  W-FLOAT-YY REDEFINES W-FLOAT-YEAR.
    64         16  W-FLOAT-YEAR-CD         PIC  9.
    65         16  W-FLOAT-YEAR-YY         PIC  99.
    66     12  SAVE-BIN-DATE       PIC  X(2)   VALUE SPACES.
    67
    68*    COPY ELCDATE.
    69******************************************************************
    70*                                                                *
    71*                                                                *
    72*                            ELCDATE.                            *
    73*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
    74*                            VMOD=2.003
    75*                                                                *
    76*                                                                *
    77*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
    78*                 LENGTH = 200                                   *
    79******************************************************************
    80
    81 01  DATE-CONVERSION-DATA.
    82     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
    83     12  DC-OPTION-CODE                PIC X.
    84         88  BIN-TO-GREG                VALUE ' '.
    85         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
    86         88  EDIT-GREG-TO-BIN           VALUE '2'.
    87         88  YMD-GREG-TO-BIN            VALUE '3'.
    88         88  MDY-GREG-TO-BIN            VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL009.cbl
    89         88  JULIAN-TO-BIN              VALUE '5'.
    90         88  BIN-PLUS-ELAPSED           VALUE '6'.
    91         88  FIND-CENTURY               VALUE '7'.
    92         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
    93         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
    94         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
    95         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
    96         88  JULIAN-TO-BIN-3            VALUE 'C'.
    97         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
    98         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
    99         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   100         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   101         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   102         88  CHECK-LEAP-YEAR            VALUE 'H'.
   103         88  BIN-3-TO-GREG              VALUE 'I'.
   104         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   105         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   106         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   107         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   108         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   109         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   110         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   111         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   112         88  THREE-CHARACTER-BIN
   113                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   114         88  GREGORIAN-TO-BIN
   115                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   116         88  BIN-TO-GREGORIAN
   117                  VALUES ' ' '1' 'I' '8' 'G'.
   118         88  JULIAN-TO-BINARY
   119                  VALUES '5' 'C' 'E' 'F'.
   120     12  DC-ERROR-CODE                 PIC X.
   121         88  NO-CONVERSION-ERROR        VALUE ' '.
   122         88  DATE-CONVERSION-ERROR
   123                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   124         88  DATE-IS-ZERO               VALUE '1'.
   125         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   126         88  DATE-IS-INVALID            VALUE '3'.
   127         88  DATE1-GREATER-DATE2        VALUE '4'.
   128         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   129         88  DATE-INVALID-OPTION        VALUE '9'.
   130         88  INVALID-CENTURY            VALUE 'A'.
   131         88  ONLY-CENTURY               VALUE 'B'.
   132         88  ONLY-LEAP-YEAR             VALUE 'C'.
   133         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   134     12  DC-END-OF-MONTH               PIC X.
   135         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   136     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   137         88  USE-NORMAL-PROCESS         VALUE ' '.
   138         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   139         88  ADJUST-UP-100-YRS          VALUE '2'.
   140     12  FILLER                        PIC X.
   141     12  DC-CONVERSION-DATES.
   142         16  DC-BIN-DATE-1             PIC XX.
   143         16  DC-BIN-DATE-2             PIC XX.
   144         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   145         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   146                       DC-GREG-DATE-1-EDIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL009.cbl
   147             20  DC-EDIT1-MONTH        PIC 99.
   148             20  SLASH1-1              PIC X.
   149             20  DC-EDIT1-DAY          PIC 99.
   150             20  SLASH1-2              PIC X.
   151             20  DC-EDIT1-YEAR         PIC 99.
   152         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   153         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   154                     DC-GREG-DATE-2-EDIT.
   155             20  DC-EDIT2-MONTH        PIC 99.
   156             20  SLASH2-1              PIC X.
   157             20  DC-EDIT2-DAY          PIC 99.
   158             20  SLASH2-2              PIC X.
   159             20  DC-EDIT2-YEAR         PIC 99.
   160         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   161         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   162                     DC-GREG-DATE-1-YMD.
   163             20  DC-YMD-YEAR           PIC 99.
   164             20  DC-YMD-MONTH          PIC 99.
   165             20  DC-YMD-DAY            PIC 99.
   166         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   167         16  DC-GREG-DATE-1-MDY-R REDEFINES
   168                      DC-GREG-DATE-1-MDY.
   169             20  DC-MDY-MONTH          PIC 99.
   170             20  DC-MDY-DAY            PIC 99.
   171             20  DC-MDY-YEAR           PIC 99.
   172         16  DC-GREG-DATE-1-ALPHA.
   173             20  DC-ALPHA-MONTH        PIC X(10).
   174             20  DC-ALPHA-DAY          PIC 99.
   175             20  FILLER                PIC XX.
   176             20  DC-ALPHA-CENTURY.
   177                 24 DC-ALPHA-CEN-N     PIC 99.
   178             20  DC-ALPHA-YEAR         PIC 99.
   179         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   180         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   181         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   182         16  DC-JULIAN-DATE            PIC 9(05).
   183         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   184                                       PIC 9(05).
   185         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   186             20  DC-JULIAN-YEAR        PIC 99.
   187             20  DC-JULIAN-DAYS        PIC 999.
   188         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   189         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   190         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   191     12  DATE-CONVERSION-VARIBLES.
   192         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   193         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   194             20  FILLER                PIC 9(3).
   195             20  HOLD-CEN-1-CCYY.
   196                 24  HOLD-CEN-1-CC     PIC 99.
   197                 24  HOLD-CEN-1-YY     PIC 99.
   198             20  HOLD-CEN-1-MO         PIC 99.
   199             20  HOLD-CEN-1-DA         PIC 99.
   200         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   201             20  HOLD-CEN-1-R-MO       PIC 99.
   202             20  HOLD-CEN-1-R-DA       PIC 99.
   203             20  HOLD-CEN-1-R-CCYY.
   204                 24  HOLD-CEN-1-R-CC   PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL009.cbl
   205                 24  HOLD-CEN-1-R-YY   PIC 99.
   206             20  FILLER                PIC 9(3).
   207         16  HOLD-CENTURY-1-X.
   208             20  FILLER                PIC X(3)  VALUE SPACES.
   209             20  HOLD-CEN-1-X-CCYY.
   210                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   211                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   212             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   213             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   214         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   215             20  HOLD-CEN-1-R-X-MO     PIC XX.
   216             20  HOLD-CEN-1-R-X-DA     PIC XX.
   217             20  HOLD-CEN-1-R-X-CCYY.
   218                 24  HOLD-CEN-1-R-X-CC PIC XX.
   219                 24  HOLD-CEN-1-R-X-YY PIC XX.
   220             20  FILLER                PIC XXX.
   221         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   222         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   223         16  DC-JULIAN-DATE-1          PIC 9(07).
   224         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   225             20  DC-JULIAN-1-CCYY.
   226                 24  DC-JULIAN-1-CC    PIC 99.
   227                 24  DC-JULIAN-1-YR    PIC 99.
   228             20  DC-JULIAN-DA-1        PIC 999.
   229         16  DC-JULIAN-DATE-2          PIC 9(07).
   230         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   231             20  DC-JULIAN-2-CCYY.
   232                 24  DC-JULIAN-2-CC    PIC 99.
   233                 24  DC-JULIAN-2-YR    PIC 99.
   234             20  DC-JULIAN-DA-2        PIC 999.
   235         16  DC-GREG-DATE-A-EDIT.
   236             20  DC-EDITA-MONTH        PIC 99.
   237             20  SLASHA-1              PIC X VALUE '/'.
   238             20  DC-EDITA-DAY          PIC 99.
   239             20  SLASHA-2              PIC X VALUE '/'.
   240             20  DC-EDITA-CCYY.
   241                 24  DC-EDITA-CENT     PIC 99.
   242                 24  DC-EDITA-YEAR     PIC 99.
   243         16  DC-GREG-DATE-B-EDIT.
   244             20  DC-EDITB-MONTH        PIC 99.
   245             20  SLASHB-1              PIC X VALUE '/'.
   246             20  DC-EDITB-DAY          PIC 99.
   247             20  SLASHB-2              PIC X VALUE '/'.
   248             20  DC-EDITB-CCYY.
   249                 24  DC-EDITB-CENT     PIC 99.
   250                 24  DC-EDITB-YEAR     PIC 99.
   251         16  DC-GREG-DATE-CYMD         PIC 9(08).
   252         16  DC-GREG-DATE-CYMD-R REDEFINES
   253                              DC-GREG-DATE-CYMD.
   254             20  DC-CYMD-CEN           PIC 99.
   255             20  DC-CYMD-YEAR          PIC 99.
   256             20  DC-CYMD-MONTH         PIC 99.
   257             20  DC-CYMD-DAY           PIC 99.
   258         16  DC-GREG-DATE-MDCY         PIC 9(08).
   259         16  DC-GREG-DATE-MDCY-R REDEFINES
   260                              DC-GREG-DATE-MDCY.
   261             20  DC-MDCY-MONTH         PIC 99.
   262             20  DC-MDCY-DAY           PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL009.cbl
   263             20  DC-MDCY-CEN           PIC 99.
   264             20  DC-MDCY-YEAR          PIC 99.
   265    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   266        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   267    12  DC-EL310-DATE                  PIC X(21).
   268    12  FILLER                         PIC X(28).
   269
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL009.cbl
   271*    COPY ELCDATW1.
   272******************************************************************
   273*                                                                *
   274*                                                                *
   275*                            ELCDATW1.                           *
   276*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   277*                            VMOD=2.003                          *
   278*                                                                *
   279*   DESCRIPTION:  WORKING STORAGE AREA FOR DATE CONVERSION RTN.  *
   280*
   281******************************************************************
   282
   283 01  WS-DATE-WORK-AREA.
   284     05  WS-BINARY-DATE-1             PIC S9(9)      VALUE ZERO.
   285     05  WS-BINARY-DATE-2             PIC S9(9)      VALUE ZERO.
   286     05  WS-ELAPSED-DAYS              PIC S9(5)      VALUE ZERO.
   287     05  WS-ELAPSED-MONTHS            PIC S9(5)      VALUE ZERO.
   288     05  DAYS-REMAINING               PIC S999       VALUE ZERO.
   289     05  CHECK-YEAR                   PIC S999       VALUE ZERO.
   290     05  DAYS-ELAPSED                 PIC S9(5)      VALUE ZERO.
   291     05  DAYS-NEEDED                  PIC S9(5)      VALUE ZERO.
   292     05  WS-DAY-OF-CENTURY            PIC S9(5)      VALUE ZERO.
   293     05  DAY-OF-WEEK-X                PIC S9         VALUE ZERO.
   294     05  WORK-JULIAN.
   295         10  JULIAN-YEAR              PIC S9(3)      VALUE ZERO.
   296         10  JULIAN-DAY               PIC S9(3)      VALUE ZERO.
   297     05  WORK-JULIAN-1.
   298         10  JULIAN-YEAR1             PIC S9(3)      VALUE ZERO.
   299         10  JULIAN-DAY1              PIC S9(3)      VALUE ZERO.
   300     05  WORK-JULIAN-2.
   301         10  JULIAN-YEAR2             PIC S9(3)      VALUE ZERO.
   302         10  JULIAN-DAY2              PIC S9(3)      VALUE ZERO.
   303
   304 01  LEAP-YEAR-FIELDS.
   305     05  DIVIDE-LEAP-YEAR             PIC 999V99     VALUE ZERO.
   306     05  DIVIDE-LEAP-YEAR-R REDEFINES DIVIDE-LEAP-YEAR.
   307         10  DIVIDE-RESULT            PIC 999.
   308         10  DIVIDE-REMAINDER         PIC V99.
   309             88  A-LEAP-YEAR                         VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL009.cbl
   310/
   311 01  FILLER.
   312     05  BIN-DATE            COMP    PIC S9(9)       VALUE ZERO.
   313
   314     05  FILLER                      REDEFINES
   315         BIN-DATE.
   316         10  FILLER                  PIC XX.
   317         10  BIN-DATE-WORK           PIC XX.
   318
   319     05  BIN-DATE-3                  REDEFINES
   320         BIN-DATE.
   321         10  FILLER                  PIC X.
   322         10  BIN-DATE-3-WORK         PIC XXX.
   323
   324      05  GREG-ALPHA-MASK         PIC X(18)
   325                        VALUE '            , 0000'.
   326
   327      05  WORK-DATE-1.
   328          10  YEAR1                   PIC S9(3)     VALUE ZERO.
   329          10  MONTH1                  PIC S9(3)     VALUE ZERO.
   330          10  DAY1                    PIC S9(3)     VALUE ZERO.
   331
   332     05  WORK-DATE-2.
   333         10  YEAR2                    PIC S9(3)     VALUE ZERO.
   334         10  MONTH2                   PIC S9(3)     VALUE ZERO.
   335         10  DAY2                     PIC S9(3)     VALUE ZERO.
   336
   337 01  YR-2                        PIC 9(3).
   338 01  YR-2-R REDEFINES YR-2.
   339     05  YEAR2-CEN-CD            PIC 9.
   340     05  YEAR2-YR                PIC 99.
   341
   342 01  MONTH-AND-DAYS-TABLE.
   343     05  FILLER             PIC X(10)  VALUE ' JANUARY  '.
   344     05  FILLER             PIC 9(3)   VALUE ZERO.
   345     05  FILLER             PIC 9(3)   VALUE ZERO.
   346     05  FILLER             PIC 9(3)   VALUE 31.
   347     05  FILLER             PIC X(10)  VALUE 'FEBRUARY  '.
   348     05  FILLER             PIC 9(3)   VALUE 31.
   349     05  FILLER             PIC 9(3)   VALUE 31.
   350     05  FILLER             PIC 9(3)   VALUE 28.
   351     05  FILLER             PIC X(10)  VALUE '  MARCH   '.
   352     05  FILLER             PIC 9(3)   VALUE 59.
   353     05  FILLER             PIC 9(3)   VALUE 60.
   354     05  FILLER             PIC 9(3)   VALUE 31.
   355     05  FILLER             PIC X(10)  VALUE '  APRIL   '.
   356     05  FILLER             PIC 9(3)   VALUE 90.
   357     05  FILLER             PIC 9(3)   VALUE 91.
   358     05  FILLER             PIC 9(3)   VALUE 30.
   359     05  FILLER             PIC X(10)  VALUE '   MAY    '.
   360     05  FILLER             PIC 9(3)   VALUE 120.
   361     05  FILLER             PIC 9(3)   VALUE 121.
   362     05  FILLER             PIC 9(3)   VALUE 31.
   363     05  FILLER             PIC X(10)  VALUE '  JUNE    '.
   364     05  FILLER             PIC 9(3)   VALUE 151.
   365     05  FILLER             PIC 9(3)   VALUE 152.
   366     05  FILLER             PIC 9(3)   VALUE 30.
   367     05  FILLER             PIC X(10)  VALUE '  JULY    '.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL009.cbl
   368     05  FILLER             PIC 9(3)   VALUE 181.
   369     05  FILLER             PIC 9(3)   VALUE 182.
   370     05  FILLER             PIC 9(3)   VALUE 31.
   371     05  FILLER             PIC X(10)  VALUE ' AUGUST   '.
   372     05  FILLER             PIC 9(3)   VALUE 212.
   373     05  FILLER             PIC 9(3)   VALUE 213.
   374     05  FILLER             PIC 9(3)   VALUE 31.
   375     05  FILLER             PIC X(10)  VALUE 'SEPTEMBER '.
   376     05  FILLER             PIC 9(3)   VALUE 243.
   377     05  FILLER             PIC 9(3)   VALUE 244.
   378     05  FILLER             PIC 9(3)   VALUE 30.
   379     05  FILLER             PIC X(10)  VALUE ' OCTOBER  '.
   380     05  FILLER             PIC 9(3)   VALUE 273.
   381     05  FILLER             PIC 9(3)   VALUE 274.
   382     05  FILLER             PIC 9(3)   VALUE 31.
   383     05  FILLER             PIC X(10)  VALUE 'NOVEMBER  '.
   384     05  FILLER             PIC 9(3)   VALUE 304.
   385     05  FILLER             PIC 9(3)   VALUE 305.
   386     05  FILLER             PIC 9(3)   VALUE 30.
   387     05  FILLER             PIC X(10)  VALUE 'DECEMBER  '.
   388     05  FILLER             PIC 9(3)   VALUE 334.
   389     05  FILLER             PIC 9(3)   VALUE 335.
   390     05  FILLER             PIC 9(3)   VALUE 31.
   391     05  FILLER             PIC X(10)  VALUE 'XXXXXXXX  '.
   392     05  FILLER             PIC 9(3)   VALUE 365.
   393     05  FILLER             PIC 9(3)   VALUE 366.
   394     05  FILLER             PIC 9(3)   VALUE ZERO.
   395
   396 01  TABLE-OF-MONTHS-AND-DAYS  REDEFINES  MONTH-AND-DAYS-TABLE.
   397     05  MONTHS-AND-DAYS
   398         OCCURS 13 TIMES             INDEXED BY MTHX
   399                                                SUB1.
   400         10  NAME-OF-MONTH            PIC X(10).
   401         10  REGULAR-DAYS             PIC 999.
   402         10  LEAP-YR-DAYS             PIC 999.
   403         10  DAYS-IN-MONTH            PIC 999.
   404
   405 01  CENTURY-CONVERSION-TABLE.
   406     05  FILLER                      PIC 9(4)  VALUE 0019.
   407     05  FILLER                      PIC 9(4)  VALUE 0120.
   408     05  FILLER                      PIC 9(4)  VALUE 0221.
   409     05  FILLER                      PIC 9(4)  VALUE 0322.
   410     05  FILLER                      PIC 9(4)  VALUE 0423.
   411     05  FILLER                      PIC 9(4)  VALUE 0524.
   412     05  FILLER                      PIC 9(4)  VALUE 0625.
   413     05  FILLER                      PIC 9(4)  VALUE 0726.
   414     05  FILLER                      PIC 9(4)  VALUE 0827.
   415     05  FILLER                      PIC 9(4)  VALUE 0928.
   416 01  TABLE-CENTURY  REDEFINES CENTURY-CONVERSION-TABLE.
   417     05  CENTURY-TBL OCCURS 10 TIMES INDEXED BY CNTRY-NDX.
   418         10  CENTURY-CODE            PIC 99.
   419         10  CENTURY                 PIC 99.
   420
   421 01  CENTURY-SEARCH-VARIABLES.
   422     05  FIND-CENTURY-FLAG       PIC  X.
   423     05  SEARCH-CENTURY.
   424         10  SEARCH-CENTURY-N    PIC  99.
   425     05  SEARCH-CENTURY-CODE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL009.cbl
   426         10  SEARCH-CENTURY-CD-N PIC  99.
   427     05  FOUND-CENTURY.
   428         10  FOUND-CENTURY-N     PIC  99.
   429     05  FOUND-CENTURY-CODE.
   430         10  FOUND-CENTURY-CD-N  PIC  99.
   431     05  CURRENT-CENTURY-1.
   432         10  CURRENT-CENTURY-1-N PIC 99     VALUE 19.
   433     05  CONTROL-YEAR            PIC 9(03)  VALUE 070.
   434     05  CONTROL-YR REDEFINES CONTROL-YEAR.
   435         10 CONTROL-YEAR-CD      PIC  9.
   436         10 CONTROL-YEAR-YY      PIC  99.
   437     05  W-PRESENT-YEAR          PIC  9(03) VALUE ZEROS.
   438     05  PREVIOUS-CENTURY        PIC  99    VALUE ZEROS.
   439     05  NEXT-CENTURY            PIC  99    VALUE ZEROS.
   440     05  CENTURY-MARK            PIC  9(03) VALUE 100.
   441     05  CHECK-CCYY              PIC  9(04) VALUE ZEROES.
   442     05  CHECK-CCYY-R REDEFINES CHECK-CCYY.
   443         10  CHECK-CCYY-CC       PIC 99.
   444         10  CHECK-CCYY-YY       PIC 99.
   445     05  BREAK-PERIOD            PIC  9(03) VALUE 0.
   446
   447
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL009.cbl
   449 01  MISC-SWITCHS.
   450     12  EDIT-ERROR-FLAG     PIC X       VALUE 'N'.
   451         88  EDIT-ERROR          VALUE 'Y'.
   452
   453 01  FILLER.
   454     05  WS-DAY-OF-WEEK-ARRAY.
   455         10  FILLER              PICTURE X(9) VALUE 'SUNDAY'.
   456         10  FILLER              PICTURE X(9) VALUE 'MONDAY'.
   457         10  FILLER              PICTURE X(9) VALUE 'TUESDAY'.
   458         10  FILLER              PICTURE X(9) VALUE 'WEDNESDAY'.
   459         10  FILLER              PICTURE X(9) VALUE 'THURSDAY'.
   460         10  FILLER              PICTURE X(9) VALUE 'FRIDAY'.
   461         10  FILLER              PICTURE X(9) VALUE 'SATURDAY'.
   462
   463     05  WS-DAY-OF-WEEK          REDEFINES
   464         WS-DAY-OF-WEEK-ARRAY    PICTURE X(9)
   465         OCCURS 7 TIMES.
   466
   467 01  BINARY-WORK             PIC 9(8)     COMP.
   468 01  WORK-BINARY  REDEFINES BINARY-WORK.
   469     12  FILLER              PIC XX.
   470     12  BINARY-DTE          PIC XX.
   471
   472 01  HEXADECIMAL-DAYS.
   473     05  HEX-CHARACTER               PIC X
   474                       OCCURS 4 TIMES  INDEXED BY U.
   475
   476 01  CONVERSION-TABLE.
   477     05  FILLER          PIC X(21)  VALUE '104096002560001600001'.
   478     05  FILLER          PIC X(21)  VALUE '208192005120003200002'.
   479     05  FILLER          PIC X(21)  VALUE '312288007680004800003'.
   480     05  FILLER          PIC X(21)  VALUE '416384010240006400004'.
   481     05  FILLER          PIC X(21)  VALUE '520480012800008000005'.
   482     05  FILLER          PIC X(21)  VALUE '624576015360009600006'.
   483     05  FILLER          PIC X(21)  VALUE '728672017920011200007'.
   484     05  FILLER          PIC X(21)  VALUE '832768020480012800008'.
   485     05  FILLER          PIC X(21)  VALUE '936864023040014400009'.
   486     05  FILLER          PIC X(21)  VALUE 'A40960025600016000010'.
   487     05  FILLER          PIC X(21)  VALUE 'B45056028160017600011'.
   488     05  FILLER          PIC X(21)  VALUE 'C49152030720019200012'.
   489     05  FILLER          PIC X(21)  VALUE 'D53248033280020800013'.
   490     05  FILLER          PIC X(21)  VALUE 'E57344035840022400014'.
   491     05  FILLER          PIC X(21)  VALUE 'F61440038400024000015'.
   492
   493 01  HEXADECIMAL-TABLE  REDEFINES  CONVERSION-TABLE.
   494     05  HEXADECIMAL-VALUES  OCCURS 15 TIMES  INDEXED BY V.
   495         10  HEX-VALUE               PIC X.
   496         10  DECIMAL-NUMBERS  OCCURS 4 TIMES  INDEXED BY W.
   497             15  DECIMAL-VALUE       PIC 9(5).
   498
   499 01  MISC-WORK-AREAS.
   500     12  TIME-IN             PIC 9(6).
   501     12  TIME-WRK  REDEFINES TIME-IN.
   502         16  TIME-HHMM       PIC 99V99.
   503         16  FILLER          PIC XX.
   504     12  TIME-OUT            PIC 99.99.
   505     12  TEXT-AREA           PIC X(66).
   506
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL009.cbl
   507 01  MISC-COMP        COMP.
   508     12  WS-IC               PIC S9(4)   VALUE -1.
   509     12  TEXT-LENGTH         PIC S9(4)   VALUE +66.
   510     12  BLANK-TEXT          PIC S9(4)   VALUE +1.
   511
   512 01  TEXT-MESSAGES.
   513     12  MAPFAIL-MSG.
   514         16  FILLER          PIC X(40)
   515           VALUE '     MAPFAIL ENCOUNTERED - TRANSACTION A'.
   516         16  FILLER          PIC X(6)
   517           VALUE 'BORTED'.
   518     12  TRAN-COMPLETE-MSG.
   519         16  FILLER          PIC X(45)
   520           VALUE '     CLEAR ENTERED - SESSION ENDED          '.
   521
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL009.cbl
   523*    COPY ELCDATE REPLACING
   524*    DATE-CONVERSION-DATA        BY  DATE-CONVERSION-DATA-INIT
   525*    DC-COMM-LENGTH              BY  INIT-DC-COMM-LENGTH
   526*    DC-OPTION-CODE              BY  INIT-OPTION-CODE
   527*    BIN-TO-GREG                 BY  INIT-BIN-TO-GREG
   528*    ELAPSED-BETWEEN-BIN         BY  INIT-ELAPSED-BETWEEN-BIN
   529*    ELAPSED-BETWEEN-BIN-30      BY  INIT-ELAPSED-BETWEEN-BIN-30
   530*    EDIT-GREG-TO-BIN            BY  INIT-EDIT-GREG-TO-BIN
   531*    YMD-GREG-TO-BIN             BY  INIT-YMD-GREG-TO-BIN
   532*    MDY-GREG-TO-BIN             BY  INIT-MDY-GREG-TO-BIN
   533*    JULIAN-TO-BIN               BY  INIT-JULIAN-TO-BIN
   534*    BIN-PLUS-ELAPSED            BY  INIT-BIN-PLUS-ELAPSED
   535*    FIND-CENTURY                BY  INIT-FIND-CENTURY
   536*    ELAPSED-BETWEEN-BIN-3       BY  INIT-ELAPSED-BETWEEN-BIN-3
   537*    EDIT-GREG-TO-BIN-3          BY  INIT-EDIT-GREG-TO-BIN-3
   538*    YMD-GREG-TO-BIN-3           BY  INIT-YMD-GREG-TO-BIN-3
   539*    MDY-GREG-TO-BIN-3           BY  INIT-MDY-GREG-TO-BIN-3
   540*    JULIAN-TO-BIN-3             BY  INIT-JULIAN-TO-BIN-3
   541*    BIN-PLUS-ELAPSED-3          BY  INIT-BIN-PLUS-ELAPSED-3
   542*    JULIAN-EXPANDED-TO-BIN      BY  INIT-JULIAN-EXPANDED-TO-BIN
   543*    JULIAN-EXPANDED-TO-BIN-3    BY  INIT-JULIAN-EXPANDED-TO-BIN-3
   544*    BIN-TO-JULIAN-EXPANDED      BY  INIT-BIN-TO-JULIAN-EXPANDED
   545*    JULIAN-EXPANDED             BY  INIT-JULIAN-EXPANDED
   546*    CHECK-LEAP-YEAR             BY  INIT-CHECK-LEAP-YEAR
   547*    BIN-3-TO-GREG               BY  INIT-BIN-3-TO-GREG
   548*    CYMD-GREG-TO-BIN-3          BY  INIT-CYMD-GREG-TO-BIN-3
   549*    MDCY-GREG-TO-BIN-3          BY  INIT-MDCY-GREG-TO-BIN-3
   550*    CYMD-GREG-TO-BIN            BY  INIT-CYMD-GREG-TO-BIN
   551*    MDCY-GREG-TO-BIN            BY  INIT-MDCY-GREG-TO-BIN
   552*    MDY-GREG-TO-JULIAN          BY  INIT-MDY-GREG-TO-JULIAN
   553*    MDCY-GREG-TO-JULIAN         BY  INIT-MDCY-GREG-TO-JULIAN
   554*    YMD-GREG-TO-JULIAN          BY  INIT-YMD-GREG-TO-JULIAN
   555*    CYMD-GREG-TO-JULIAN         BY  INIT-CYMD-GREG-TO-JULIAN
   556*    THREE-CHARACTER-BIN         BY  INIT-THREE-CHARACTER-BIN
   557*    GREGORIAN-TO-BIN            BY  INIT-GREGORIAN-TO-BIN
   558*    BIN-TO-GREGORIAN            BY  INIT-BIN-TO-GREGORIAN
   559*    JULIAN-TO-BINARY            BY  INIT-JULIAN-TO-BINARY
   560*    DC-ERROR-CODE               BY  INIT-DC-ERROR-CODE
   561*    NO-CONVERSION-ERROR         BY  INIT-NO-CONVERSION-ERROR
   562*    DATE-CONVERSION-ERROR       BY  INIT-DATE-CONVERSION-ERROR
   563*    DATE-IS-ZERO                BY  INIT-DATE-IS-ZERO
   564*    DATE-IS-NON-NUMERIC         BY  INIT-DATE-IS-NON-NUMERIC
   565*    DATE-IS-INVALID             BY  INIT-DATE-IS-INVALID
   566*    DATE1-GREATER-DATE2         BY  INIT-DATE1-GREATER-DATE2
   567*    ELAPSED-PLUS-NEGATIVE       BY  INIT-ELAPSED-PLUS-NEGATIVE
   568*    DATE-INVALID-OPTION         BY  INIT-DATE-INVALID-OPTION
   569*    INVALID-CENTURY             BY  INIT-INVALID-CENTURY
   570*    ONLY-CENTURY                BY  INIT-ONLY-CENTURY
   571*    ONLY-LEAP-YEAR              BY  INIT-ONLY-LEAP-YEAR
   572*    VALID-CENTURY-LEAP-YEAR     BY  INIT-VALID-CENTURY-LEAP-YEAR
   573*    DC-END-OF-MONTH             BY  INIT-DC-END-OF-MONTH
   574*    CALCULATE-END-OF-MONTH      BY  INIT-CALCULATE-END-OF-MONTH
   575*    DC-CENTURY-ADJUSTMENT       BY  INIT-DC-CENTURY-ADJUSTMENT
   576*    USE-NORMAL-PROCESS          BY  INIT-USE-NORMAL-PROCESS
   577*    ADJUST-DOWN-100-YRS         BY  INIT-ADJUST-DOWN-100-YRS
   578*    ADJUST-UP-100-YRS           BY  INIT-ADJUST-UP-100-YRS
   579*    DC-CONVERSION-DATES         BY  INIT-DC-CONVERSION-DATES
   580*    DC-BIN-DATE-1               BY  INIT-DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL009.cbl
   581*    DC-BIN-DATE-2               BY  INIT-DC-BIN-DATE-2
   582*    DC-GREG-DATE-1-EDIT         BY  INIT-DC-GREG-DATE-1-EDIT
   583*    DC-GREG-DATE-1-EDIT-R       BY  INIT-DC-GREG-DATE-1-EDIT-R
   584*    DC-EDIT1-MONTH              BY  INIT-DC-EDIT1-MONTH
   585*    SLASH1-1                    BY  INIT-SLASH1-1
   586*    DC-EDIT1-DAY                BY  INIT-DC-EDIT1-DAY
   587*    SLASH1-2                    BY  INIT-SLASH1-2
   588*    DC-EDIT1-YEAR               BY  INIT-DC-EDIT1-YEAR
   589*    DC-GREG-DATE-2-EDIT         BY  INIT-DC-GREG-DATE-2-EDIT
   590*    DC-GREG-DATE-2-EDIT-R       BY  INIT-DC-GREG-DATE-2-EDIT-R
   591*    DC-EDIT2-MONTH              BY  INIT-DC-EDIT2-MONTH
   592*    SLASH2-1                    BY  INIT-SLASH2-1
   593*    DC-EDIT2-DAY                BY  INIT-DC-EDIT2-DAY
   594*    SLASH2-2                    BY  INIT-SLASH2-2
   595*    DC-EDIT2-YEAR               BY  INIT-DC-EDIT2-YEAR
   596*    DC-GREG-DATE-1-YMD          BY  INIT-DC-GREG-DATE-1-YMD
   597*    DC-GREG-DATE-1-YMD-R        BY  INIT-DC-GREG-DATE-1-YMD-R
   598*    DC-YMD-YEAR                 BY  INIT-DC-YMD-YEAR
   599*    DC-YMD-MONTH                BY  INIT-DC-YMD-MONTH
   600*    DC-YMD-DAY                  BY  INIT-DC-YMD-DAY
   601*    DC-GREG-DATE-1-MDY          BY  INIT-DC-GREG-DATE-1-MDY
   602*    DC-GREG-DATE-1-MDY-R        BY  INIT-DC-GREG-DATE-1-MDY-R
   603*    DC-MDY-MONTH                BY  INIT-DC-MDY-MONTH
   604*    DC-MDY-DAY                  BY  INIT-DC-MDY-DAY
   605*    DC-MDY-YEAR                 BY  INIT-DC-MDY-YEAR
   606*    DC-GREG-DATE-1-ALPHA        BY  INIT-DC-GREG-DATE-1-ALPHA
   607*    DC-ALPHA-MONTH              BY  INIT-DC-ALPHA-MONTH
   608*    DC-ALPHA-DAY                BY  INIT-DC-ALPHA-DAY
   609*    DC-ALPHA-CENTURY            BY  INIT-DC-ALPHA-CENTURY
   610*    DC-ALPHA-CEN-N              BY  INIT-DC-ALPHA-CEN-N
   611*    DC-ALPHA-YEAR               BY  INIT-DC-ALPHA-YEAR
   612*    DC-ELAPSED-MONTHS           BY  INIT-DC-ELAPSED-MONTHS
   613*    DC-ODD-DAYS-OVER            BY  INIT-DC-ODD-DAYS-OVER
   614*    DC-ELAPSED-DAYS             BY  INIT-DC-ELAPSED-DAYS
   615*    DC-JULIAN-YYDDD             BY  INIT-DC-JULIAN-YYDDD
   616*    DC-JULIAN-DT                BY  INIT-DC-JULIAN-DT
   617*    DC-JULIAN-YEAR              BY  INIT-DC-JULIAN-YEAR
   618*    DC-JULIAN-DAYS              BY  INIT-DC-JULIAN-DAYS
   619*    DC-DAYS-IN-MONTH            BY  INIT-DC-DAYS-IN-MONTH
   620*    DC-DAY-OF-WEEK              BY  INIT-DC-DAY-OF-WEEK
   621*    DC-DAY-OF-WEEK2             BY  INIT-DC-DAY-OF-WEEK2
   622*    DATE-CONVERSION-VARIBLES
   623*                       BY  INIT-DATE-CONVERSION-VARIBLES
   624*    HOLD-CENTURY-1              BY  INIT-HOLD-CENTURY-1
   625*    HOLD-CENTURY-1-SPLIT        BY  INIT-HOLD-CENTURY-1-SPLIT
   626*    HOLD-CEN-1-CCYY             BY  INIT-HOLD-CEN-1-CCYY
   627*    HOLD-CEN-1-CC               BY  INIT-HOLD-CEN-1-CC
   628*    HOLD-CEN-1-YY               BY  INIT-HOLD-CEN-1-YY
   629*    HOLD-CEN-1-MO               BY  INIT-HOLD-CEN-1-MO
   630*    HOLD-CEN-1-DA               BY  INIT-HOLD-CEN-1-DA
   631*    HOLD-CENTURY-1-R            BY  INIT-HOLD-CENTURY-1-R
   632*    HOLD-CEN-1-R-MO             BY  INIT-HOLD-CEN-1-R-MO
   633*    HOLD-CEN-1-R-DA             BY  INIT-HOLD-CEN-1-R-DA
   634*    HOLD-CEN-1-R-CCYY           BY  INIT-HOLD-CEN-1-R-CCYY
   635*    HOLD-CEN-1-R-C              BY  INIT-HOLD-CEN-1-R-C
   636*    HOLD-CEN-1-R-Y              BY  INIT-HOLD-CEN-1-R-Y
   637*    HOLD-CENTURY-1-X            BY  INIT-HOLD-CENTURY-1-X
   638*    HOLD-CEN-1-X-CCYY           BY  INIT-HOLD-CEN-1-X-CCYY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL009.cbl
   639*    HOLD-CEN-1-X-CC             BY  INIT-HOLD-CEN-1-X-CC
   640*    HOLD-CEN-1-X-YY             BY  INIT-HOLD-CEN-1-X-YY
   641*    HOLD-CEN-1-X-MO             BY  INIT-HOLD-CEN-1-X-MO
   642*    HOLD-CEN-1-X-DA             BY  INIT-HOLD-CEN-1-X-DA
   643*    HOLD-CENTURY-1-R-X          BY  INIT-HOLD-CENTURY-1-R-X
   644*    HOLD-CEN-1-R-X-MO           BY  INIT-HOLD-CEN-1-R-X-MO
   645*    HOLD-CEN-1-R-X-DA           BY  INIT-HOLD-CEN-1-R-X-DA
   646*    HOLD-CEN-1-R-X-CCYY         BY  INIT-HOLD-CEN-1-R-X-CCYY
   647*    HOLD-CEN-1-R-X-CC           BY  INIT-HOLD-CEN-1-R-X-CC
   648*    HOLD-CEN-1-R-X-YY           BY  INIT-HOLD-CEN-1-R-X-YY
   649*    DC-BIN-DATE-EXPAND-1        BY  INIT-DC-BIN-DATE-EXPAND-1
   650*    DC-BIN-DATE-EXPAND-2        BY  INIT-DC-BIN-DATE-EXPAND-2
   651*    DC-JULIAN-DATE-1            BY  INIT-DC-JULIAN-DATE-1
   652*    DC-JULIAN-DATE-1-R          BY  INIT-DC-JULIAN-DATE-1-R
   653*    DC-JULIAN-1-CCYY            BY  INIT-DC-JULIAN-1-CCYY
   654*    DC-JULIAN-1-CC              BY  INIT-DC-JULIAN-1-CC
   655*    DC-JULIAN-1-YR              BY  INIT-DC-JULIAN-1-YR
   656*    DC-JULIAN-DA-1              BY  INIT-DC-JULIAN-DA-1
   657*    DC-JULIAN-DATE-2            BY  INIT-DC-JULIAN-DATE-2
   658*    DC-JULIAN-DATE-2-R          BY  INIT-DC-JULIAN-DATE-2-R
   659*    DC-JULIAN-2-CCYY            BY  INIT-DC-JULIAN-2-CCYY
   660*    DC-JULIAN-2-CC              BY  INIT-DC-JULIAN-2-CC
   661*    DC-JULIAN-2-YR              BY  INIT-DC-JULIAN-2-YR
   662*    DC-JULIAN-DA-2              BY  INIT-DC-JULIAN-DA-2
   663*    DC-GREG-DATE-A-EDIT         BY  INIT-DC-GREG-DATE-A-EDIT
   664*    DC-EDITA-MONTH              BY  INIT-DC-EDITA-MONTH
   665*    SLASHA-1                    BY  INIT-SLASHA-1
   666*    DC-EDITA-DAY                BY  INIT-DC-EDITA-DAY
   667*    SLASHA-2                    BY  INIT-SLASHA-2
   668*    DC-EDITA-CCYY               BY  INIT-DC-EDITA-CCYY
   669*    DC-EDITA-CENT               BY  INIT-DC-EDITA-CENT
   670*    DC-EDITA-YEAR               BY  INIT-DC-EDITA-YEAR
   671*    DC-GREG-DATE-B-EDIT         BY  INIT-DC-GREG-DATE-B-EDIT
   672*    DC-EDITB-MONTH              BY  INIT-DC-EDITB-MONTH
   673*    SLASHB-1                    BY  INIT-SLASHA-1
   674*    DC-EDITB-DAY                BY  INIT-DC-EDITA-DAY
   675*    SLASHB-2                    BY  INIT-SLASHB-2
   676*    DC-EDITB-CCYY               BY  INIT-DC-EDITB-CCYY
   677*    DC-EDITB-CENT               BY  INIT-DC-EDITB-CENT
   678*    DC-EDITB-YEAR               BY  INIT-DC-EDITB-YEAR
   679*    DC-GREG-DATE-CYMD           BY  INIT-DC-GREG-DATE-CYMD
   680*    DC-GREG-DATE-CYMD-R         BY  INIT-DC-GREG-DATE-CYMD-R
   681*    DC-CYMD-CEN                 BY  INIT-DC-CYMD-CEN
   682*    DC-CYMD-YEAR                BY  INIT-DC-CYMD-YEAR
   683*    DC-CYMD-MONTH               BY  INIT-DC-CYMD-MONTH
   684*    DC-CYMD-DAY                 BY  INIT-DC-CYMD-DAY
   685*    DC-GREG-DATE-MDCY           BY  INIT-DC-GREG-DATE-MDCY
   686*    DC-GREG-DATE-MDCY-R         BY  INIT-DC-GREG-DATE-MDCY-R
   687*    DC-MDCY-MONTH               BY  INIT-DC-MDCY-MONTH
   688*    DC-MDCY-DAY                 BY  INIT-DC-MDCY-DAY
   689*    DC-MDCY-CEN                 BY  INIT-DC-MDCY-CEN
   690*    DC-MDCY-YEAR                BY  INIT-DC-MDCY-YEAR.
   691******************************************************************
   692*                                                                *
   693*                                                                *
   694*                            ELCDATE.                            *
   695*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   696*                            VMOD=2.003
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL009.cbl
   697*                                                                *
   698*                                                                *
   699*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   700*                 LENGTH = 200                                   *
   701******************************************************************
   702
   703 01  DATE-CONVERSION-DATA-INIT.
   704     12  INIT-DC-COMM-LENGTH                PIC S9(4) COMP VALUE
   705     +200.
   706     12  INIT-OPTION-CODE                PIC X.
   707         88  INIT-BIN-TO-GREG                VALUE ' '.
   708         88  INIT-ELAPSED-BETWEEN-BIN        VALUE '1'.
   709         88  INIT-EDIT-GREG-TO-BIN           VALUE '2'.
   710         88  INIT-YMD-GREG-TO-BIN            VALUE '3'.
   711         88  INIT-MDY-GREG-TO-BIN            VALUE '4'.
   712         88  INIT-JULIAN-TO-BIN              VALUE '5'.
   713         88  INIT-BIN-PLUS-ELAPSED           VALUE '6'.
   714         88  INIT-FIND-CENTURY               VALUE '7'.
   715         88  INIT-ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   716         88  INIT-EDIT-GREG-TO-BIN-3         VALUE '9'.
   717         88  INIT-YMD-GREG-TO-BIN-3          VALUE 'A'.
   718         88  INIT-MDY-GREG-TO-BIN-3          VALUE 'B'.
   719         88  INIT-JULIAN-TO-BIN-3            VALUE 'C'.
   720         88  INIT-BIN-PLUS-ELAPSED-3         VALUE 'D'.
   721         88  INIT-JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   722         88  INIT-JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   723         88  INIT-BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   724         88  INIT-JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   725         88  INIT-CHECK-LEAP-YEAR            VALUE 'H'.
   726         88  INIT-BIN-3-TO-GREG              VALUE 'I'.
   727         88  INIT-CYMD-GREG-TO-BIN-3         VALUE 'J'.
   728         88  INIT-MDCY-GREG-TO-BIN-3         VALUE 'K'.
   729         88  INIT-CYMD-GREG-TO-BIN           VALUE 'L'.
   730         88  INIT-MDCY-GREG-TO-BIN           VALUE 'M'.
   731         88  INIT-MDY-GREG-TO-JULIAN         VALUE 'N'.
   732         88  INIT-MDCY-GREG-TO-JULIAN        VALUE 'O'.
   733         88  INIT-YMD-GREG-TO-JULIAN         VALUE 'P'.
   734         88  INIT-CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   735         88  INIT-THREE-CHARACTER-BIN
   736                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   737         88  INIT-GREGORIAN-TO-BIN
   738                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   739         88  INIT-BIN-TO-GREGORIAN
   740                  VALUES ' ' '1' 'I' '8' 'G'.
   741         88  INIT-JULIAN-TO-BINARY
   742                  VALUES '5' 'C' 'E' 'F'.
   743     12  INIT-DC-ERROR-CODE                 PIC X.
   744         88  INIT-NO-CONVERSION-ERROR        VALUE ' '.
   745         88  INIT-DATE-CONVERSION-ERROR
   746                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   747         88  INIT-DATE-IS-ZERO               VALUE '1'.
   748         88  INIT-DATE-IS-NON-NUMERIC        VALUE '2'.
   749         88  INIT-DATE-IS-INVALID            VALUE '3'.
   750         88  INIT-DATE1-GREATER-DATE2        VALUE '4'.
   751         88  INIT-ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   752         88  INIT-DATE-INVALID-OPTION        VALUE '9'.
   753         88  INIT-INVALID-CENTURY            VALUE 'A'.
   754         88  INIT-ONLY-CENTURY               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL009.cbl
   755         88  INIT-ONLY-LEAP-YEAR             VALUE 'C'.
   756         88  INIT-VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   757     12  INIT-DC-END-OF-MONTH               PIC X.
   758         88  INIT-CALCULATE-END-OF-MONTH     VALUE '1'.
   759     12  INIT-DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   760         88  INIT-USE-NORMAL-PROCESS         VALUE ' '.
   761         88  INIT-ADJUST-DOWN-100-YRS        VALUE '1'.
   762         88  INIT-ADJUST-UP-100-YRS          VALUE '2'.
   763     12  FILLER                        PIC X.
   764     12  INIT-DC-CONVERSION-DATES.
   765         16  INIT-DC-BIN-DATE-1             PIC XX.
   766         16  INIT-DC-BIN-DATE-2             PIC XX.
   767         16  INIT-DC-GREG-DATE-1-EDIT       PIC X(08).
   768         16  INIT-DC-GREG-DATE-1-EDIT-R REDEFINES
   769                       INIT-DC-GREG-DATE-1-EDIT.
   770             20  INIT-DC-EDIT1-MONTH        PIC 99.
   771             20  INIT-SLASH1-1              PIC X.
   772             20  INIT-DC-EDIT1-DAY          PIC 99.
   773             20  INIT-SLASH1-2              PIC X.
   774             20  INIT-DC-EDIT1-YEAR         PIC 99.
   775         16  INIT-DC-GREG-DATE-2-EDIT       PIC X(08).
   776         16  INIT-DC-GREG-DATE-2-EDIT-R REDEFINES
   777                     INIT-DC-GREG-DATE-2-EDIT.
   778             20  INIT-DC-EDIT2-MONTH        PIC 99.
   779             20  INIT-SLASH2-1              PIC X.
   780             20  INIT-DC-EDIT2-DAY          PIC 99.
   781             20  INIT-SLASH2-2              PIC X.
   782             20  INIT-DC-EDIT2-YEAR         PIC 99.
   783         16  INIT-DC-GREG-DATE-1-YMD        PIC 9(06).
   784         16  INIT-DC-GREG-DATE-1-YMD-R  REDEFINES
   785                     INIT-DC-GREG-DATE-1-YMD.
   786             20  INIT-DC-YMD-YEAR           PIC 99.
   787             20  INIT-DC-YMD-MONTH          PIC 99.
   788             20  INIT-DC-YMD-DAY            PIC 99.
   789         16  INIT-DC-GREG-DATE-1-MDY        PIC 9(06).
   790         16  INIT-DC-GREG-DATE-1-MDY-R REDEFINES
   791                      INIT-DC-GREG-DATE-1-MDY.
   792             20  INIT-DC-MDY-MONTH          PIC 99.
   793             20  INIT-DC-MDY-DAY            PIC 99.
   794             20  INIT-DC-MDY-YEAR           PIC 99.
   795         16  INIT-DC-GREG-DATE-1-ALPHA.
   796             20  INIT-DC-ALPHA-MONTH        PIC X(10).
   797             20  INIT-DC-ALPHA-DAY          PIC 99.
   798             20  FILLER                PIC XX.
   799             20  INIT-DC-ALPHA-CENTURY.
   800                 24 INIT-DC-ALPHA-CEN-N     PIC 99.
   801             20  INIT-DC-ALPHA-YEAR         PIC 99.
   802         16  INIT-DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   803         16  INIT-DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   804         16  INIT-DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   805         16  DC-JULIAN-DATE            PIC 9(05).
   806         16  INIT-DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   807                                       PIC 9(05).
   808         16  INIT-DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   809             20  INIT-DC-JULIAN-YEAR        PIC 99.
   810             20  INIT-DC-JULIAN-DAYS        PIC 999.
   811         16  INIT-DC-DAYS-IN-MONTH          PIC S9(3)
   812     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL009.cbl
   813         16  INIT-DC-DAY-OF-WEEK            PIC S9  VALUE ZERO
   814     COMP-3.
   815         16  INIT-DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO
   816     COMP-3.
   817     12  INIT-DATE-CONVERSION-VARIBLES.
   818         16  INIT-HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   819         16  INIT-HOLD-CENTURY-1-SPLIT REDEFINES
   820     INIT-HOLD-CENTURY-1.
   821             20  FILLER                PIC 9(3).
   822             20  INIT-HOLD-CEN-1-CCYY.
   823                 24  INIT-HOLD-CEN-1-CC     PIC 99.
   824                 24  INIT-HOLD-CEN-1-YY     PIC 99.
   825             20  INIT-HOLD-CEN-1-MO         PIC 99.
   826             20  INIT-HOLD-CEN-1-DA         PIC 99.
   827         16  INIT-HOLD-CENTURY-1-R   REDEFINES
   828     INIT-HOLD-CENTURY-1.
   829             20  INIT-HOLD-CEN-1-R-MO       PIC 99.
   830             20  INIT-HOLD-CEN-1-R-DA       PIC 99.
   831             20  INIT-HOLD-CEN-1-R-CCYY.
   832                 24  HOLD-CEN-1-R-CC   PIC 99.
   833                 24  HOLD-CEN-1-R-YY   PIC 99.
   834             20  FILLER                PIC 9(3).
   835         16  INIT-HOLD-CENTURY-1-X.
   836             20  FILLER                PIC X(3)  VALUE SPACES.
   837             20  INIT-HOLD-CEN-1-X-CCYY.
   838                 24  INIT-HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   839                 24  INIT-HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   840             20  INIT-HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   841             20  INIT-HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   842         16  INIT-HOLD-CENTURY-1-R-X REDEFINES
   843     INIT-HOLD-CENTURY-1-X.
   844             20  INIT-HOLD-CEN-1-R-X-MO     PIC XX.
   845             20  INIT-HOLD-CEN-1-R-X-DA     PIC XX.
   846             20  INIT-HOLD-CEN-1-R-X-CCYY.
   847                 24  INIT-HOLD-CEN-1-R-X-CC PIC XX.
   848                 24  INIT-HOLD-CEN-1-R-X-YY PIC XX.
   849             20  FILLER                PIC XXX.
   850         16  INIT-DC-BIN-DATE-EXPAND-1      PIC XXX.
   851         16  INIT-DC-BIN-DATE-EXPAND-2      PIC XXX.
   852         16  INIT-DC-JULIAN-DATE-1          PIC 9(07).
   853         16  INIT-DC-JULIAN-DATE-1-R REDEFINES
   854     INIT-DC-JULIAN-DATE-1.
   855             20  INIT-DC-JULIAN-1-CCYY.
   856                 24  INIT-DC-JULIAN-1-CC    PIC 99.
   857                 24  INIT-DC-JULIAN-1-YR    PIC 99.
   858             20  INIT-DC-JULIAN-DA-1        PIC 999.
   859         16  INIT-DC-JULIAN-DATE-2          PIC 9(07).
   860         16  INIT-DC-JULIAN-DATE-2-R REDEFINES
   861     INIT-DC-JULIAN-DATE-2.
   862             20  INIT-DC-JULIAN-2-CCYY.
   863                 24  INIT-DC-JULIAN-2-CC    PIC 99.
   864                 24  INIT-DC-JULIAN-2-YR    PIC 99.
   865             20  INIT-DC-JULIAN-DA-2        PIC 999.
   866         16  INIT-DC-GREG-DATE-A-EDIT.
   867             20  INIT-DC-EDITA-MONTH        PIC 99.
   868             20  INIT-SLASHA-1              PIC X VALUE '/'.
   869             20  INIT-DC-EDITA-DAY          PIC 99.
   870             20  INIT-SLASHA-2              PIC X VALUE '/'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL009.cbl
   871             20  INIT-DC-EDITA-CCYY.
   872                 24  INIT-DC-EDITA-CENT     PIC 99.
   873                 24  INIT-DC-EDITA-YEAR     PIC 99.
   874         16  INIT-DC-GREG-DATE-B-EDIT.
   875             20  INIT-DC-EDITB-MONTH        PIC 99.
   876             20  INIT-SLASHA-1              PIC X VALUE '/'.
   877             20  INIT-DC-EDITA-DAY          PIC 99.
   878             20  INIT-SLASHB-2              PIC X VALUE '/'.
   879             20  INIT-DC-EDITB-CCYY.
   880                 24  INIT-DC-EDITB-CENT     PIC 99.
   881                 24  INIT-DC-EDITB-YEAR     PIC 99.
   882         16  INIT-DC-GREG-DATE-CYMD         PIC 9(08).
   883         16  INIT-DC-GREG-DATE-CYMD-R REDEFINES
   884                              INIT-DC-GREG-DATE-CYMD.
   885             20  INIT-DC-CYMD-CEN           PIC 99.
   886             20  INIT-DC-CYMD-YEAR          PIC 99.
   887             20  INIT-DC-CYMD-MONTH         PIC 99.
   888             20  INIT-DC-CYMD-DAY           PIC 99.
   889         16  INIT-DC-GREG-DATE-MDCY         PIC 9(08).
   890         16  INIT-DC-GREG-DATE-MDCY-R REDEFINES
   891                              INIT-DC-GREG-DATE-MDCY.
   892             20  INIT-DC-MDCY-MONTH         PIC 99.
   893             20  INIT-DC-MDCY-DAY           PIC 99.
   894             20  INIT-DC-MDCY-CEN           PIC 99.
   895             20  INIT-DC-MDCY-YEAR          PIC 99.
   896    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   897        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   898    12  DC-EL310-DATE                  PIC X(21).
   899    12  FILLER                         PIC X(28).
   900
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL009.cbl
   902*    COPY ELCATTR.
   903******************************************************************
   904*                                                                *
   905*                            ELCATTR.                            *
   906*                            VMOD=2.001                          *
   907*                                                                *
   908*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   909*                                                                *
   910*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   911*                                                                *
   912*                   POS 1   P=PROTECTED                          *
   913*                           U=UNPROTECTED                        *
   914*                           S=ASKIP                              *
   915*                   POS 2   A=ALPHA/NUMERIC                      *
   916*                           N=NUMERIC                            *
   917*                   POS 3   N=NORMAL                             *
   918*                           B=BRIGHT                             *
   919*                           D=DARK                               *
   920*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   921*                           OF=MODIFIED DATA TAG OFF             *
   922*                                                                *
   923*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   924******************************************************************
   925 01  ATTRIBUTE-LIST.
   926     12  AL-PABOF            PIC X       VALUE 'Y'.
   927     12  AL-PABON            PIC X       VALUE 'Z'.
   928     12  AL-PADOF            PIC X       VALUE '%'.
   929     12  AL-PADON            PIC X       VALUE '_'.
   930     12  AL-PANOF            PIC X       VALUE '-'.
   931     12  AL-PANON            PIC X       VALUE '/'.
   932     12  AL-SABOF            PIC X       VALUE '8'.
   933     12  AL-SABON            PIC X       VALUE '9'.
   934     12  AL-SADOF            PIC X       VALUE '@'.
   935     12  AL-SADON            PIC X       VALUE QUOTE.
   936     12  AL-SANOF            PIC X       VALUE '0'.
   937     12  AL-SANON            PIC X       VALUE '1'.
   938     12  AL-UABOF            PIC X       VALUE 'H'.
   939     12  AL-UABON            PIC X       VALUE 'I'.
   940     12  AL-UADOF            PIC X       VALUE '<'.
   941     12  AL-UADON            PIC X       VALUE '('.
   942     12  AL-UANOF            PIC X       VALUE ' '.
   943     12  AL-UANON            PIC X       VALUE 'A'.
   944     12  AL-UNBOF            PIC X       VALUE 'Q'.
   945     12  AL-UNBON            PIC X       VALUE 'R'.
   946     12  AL-UNDOF            PIC X       VALUE '*'.
   947     12  AL-UNDON            PIC X       VALUE ')'.
   948     12  AL-UNNOF            PIC X       VALUE '&'.
   949     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL009.cbl
   951*    COPY ELCAID.
   952******************************************************************
   953*                                                                *
   954*                            ELCAID.                             *
   955*                            VMOD=2.001                          *
   956*                                                                *
   957*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   958*                                                                *
   959*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   960*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   961******************************************************************
   962
   963 01  DFHAID.
   964   02  DFHNULL   PIC  X  VALUE  ' '.
   965   02  DFHENTER  PIC  X  VALUE  QUOTE.
   966   02  DFHCLEAR  PIC  X  VALUE  '_'.
   967   02  DFHPEN    PIC  X  VALUE  '='.
   968   02  DFHOPID   PIC  X  VALUE  'W'.
   969   02  DFHPA1    PIC  X  VALUE  '%'.
   970   02  DFHPA2    PIC  X  VALUE  '>'.
   971   02  DFHPA3    PIC  X  VALUE  ','.
   972   02  DFHPF1    PIC  X  VALUE  '1'.
   973   02  DFHPF2    PIC  X  VALUE  '2'.
   974   02  DFHPF3    PIC  X  VALUE  '3'.
   975   02  DFHPF4    PIC  X  VALUE  '4'.
   976   02  DFHPF5    PIC  X  VALUE  '5'.
   977   02  DFHPF6    PIC  X  VALUE  '6'.
   978   02  DFHPF7    PIC  X  VALUE  '7'.
   979   02  DFHPF8    PIC  X  VALUE  '8'.
   980   02  DFHPF9    PIC  X  VALUE  '9'.
   981   02  DFHPF10   PIC  X  VALUE  ':'.
   982   02  DFHPF11   PIC  X  VALUE  '#'.
   983   02  DFHPF12   PIC  X  VALUE  '@'.
   984   02  DFHPF13   PIC  X  VALUE  'A'.
   985   02  DFHPF14   PIC  X  VALUE  'B'.
   986   02  DFHPF15   PIC  X  VALUE  'C'.
   987   02  DFHPF16   PIC  X  VALUE  'D'.
   988   02  DFHPF17   PIC  X  VALUE  'E'.
   989   02  DFHPF18   PIC  X  VALUE  'F'.
   990   02  DFHPF19   PIC  X  VALUE  'G'.
   991   02  DFHPF20   PIC  X  VALUE  'H'.
   992   02  DFHPF21   PIC  X  VALUE  'I'.
   993*00039    02  DFHPF22   PIC  X  VALUE  ''.
   994   02  DFHPF22   PIC  X  VALUE  '['.
   995   02  DFHPF23   PIC  X  VALUE  '.'.
   996   02  DFHPF24   PIC  X  VALUE  '<'.
   997   02  DFHMSRE   PIC  X  VALUE  'X'.
   998   02  DFHSTRF   PIC  X  VALUE  'h'.
   999   02  DFHTRIG   PIC  X  VALUE  '"'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL009.cbl
  1001*    COPY EL009S.
  1002 01  EL009AI.
  1003     05  FILLER            PIC  X(0012).
  1004*    -------------------------------
  1005     05  SDATEL PIC S9(0004) COMP.
  1006     05  SDATEF PIC  X(0001).
  1007     05  FILLER REDEFINES SDATEF.
  1008         10  SDATEA PIC  X(0001).
  1009     05  SDATEI PIC  X(0009).
  1010*    -------------------------------
  1011     05  STIMEL PIC S9(0004) COMP.
  1012     05  STIMEF PIC  X(0001).
  1013     05  FILLER REDEFINES STIMEF.
  1014         10  STIMEA PIC  X(0001).
  1015     05  STIMEI PIC  X(0005).
  1016*    -------------------------------
  1017     05  BSTRINL PIC S9(0004) COMP.
  1018     05  BSTRINF PIC  X(0001).
  1019     05  FILLER REDEFINES BSTRINF.
  1020         10  BSTRINA PIC  X(0001).
  1021     05  BSTRINI PIC  X(0004).
  1022*    -------------------------------
  1023     05  BENDINL PIC S9(0004) COMP.
  1024     05  BENDINF PIC  X(0001).
  1025     05  FILLER REDEFINES BENDINF.
  1026         10  BENDINA PIC  X(0001).
  1027     05  BENDINI PIC  X(0004).
  1028*    -------------------------------
  1029     05  JINL PIC S9(0004) COMP.
  1030     05  JINF PIC  X(0001).
  1031     05  FILLER REDEFINES JINF.
  1032         10  JINA PIC  X(0001).
  1033     05  JINI PIC  X(0005).
  1034*    -------------------------------
  1035     05  GEDTINL PIC S9(0004) COMP.
  1036     05  GEDTINF PIC  X(0001).
  1037     05  FILLER REDEFINES GEDTINF.
  1038         10  GEDTINA PIC  X(0001).
  1039     05  GEDTINI PIC  X(0008).
  1040*    -------------------------------
  1041     05  GMDYINL PIC S9(0004) COMP.
  1042     05  GMDYINF PIC  X(0001).
  1043     05  FILLER REDEFINES GMDYINF.
  1044         10  GMDYINA PIC  X(0001).
  1045     05  GMDYINI PIC  X(0006).
  1046*    -------------------------------
  1047     05  GYMDINL PIC S9(0004) COMP.
  1048     05  GYMDINF PIC  X(0001).
  1049     05  FILLER REDEFINES GYMDINF.
  1050         10  GYMDINA PIC  X(0001).
  1051     05  GYMDINI PIC  X(0006).
  1052*    -------------------------------
  1053     05  EMOSINL PIC S9(0004) COMP.
  1054     05  EMOSINF PIC  X(0001).
  1055     05  FILLER REDEFINES EMOSINF.
  1056         10  EMOSINA PIC  X(0001).
  1057     05  EMOSINI PIC  S9(6).
  1058*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL009.cbl
  1059     05  MONENDL PIC S9(0004) COMP.
  1060     05  MONENDF PIC  X(0001).
  1061     05  FILLER REDEFINES MONENDF.
  1062         10  MONENDA PIC  X(0001).
  1063     05  MONENDI PIC  X(0001).
  1064*    -------------------------------
  1065     05  EDAYINL PIC S9(0004) COMP.
  1066     05  EDAYINF PIC  X(0001).
  1067     05  FILLER REDEFINES EDAYINF.
  1068         10  EDAYINA PIC  X(0001).
  1069     05  EDAYINI PIC  S9(6).
  1070*    -------------------------------
  1071     05  CENTURYL PIC S9(0004) COMP.
  1072     05  CENTURYF PIC  X(0001).
  1073     05  FILLER REDEFINES CENTURYF.
  1074         10  CENTURYA PIC  X(0001).
  1075     05  CENTURYI PIC  X(0001).
  1076*    -------------------------------
  1077     05  BOUTL PIC S9(0004) COMP.
  1078     05  BOUTF PIC  X(0001).
  1079     05  FILLER REDEFINES BOUTF.
  1080         10  BOUTA PIC  X(0001).
  1081     05  BOUTI PIC  X(0004).
  1082*    -------------------------------
  1083     05  BOUT2L PIC S9(0004) COMP.
  1084     05  BOUT2F PIC  X(0001).
  1085     05  FILLER REDEFINES BOUT2F.
  1086         10  BOUT2A PIC  X(0001).
  1087     05  BOUT2I PIC  X(0004).
  1088*    -------------------------------
  1089     05  DAY1L PIC S9(0004) COMP.
  1090     05  DAY1F PIC  X(0001).
  1091     05  FILLER REDEFINES DAY1F.
  1092         10  DAY1A PIC  X(0001).
  1093     05  DAY1I PIC  X(0009).
  1094*    -------------------------------
  1095     05  DAY2L PIC S9(0004) COMP.
  1096     05  DAY2F PIC  X(0001).
  1097     05  FILLER REDEFINES DAY2F.
  1098         10  DAY2A PIC  X(0001).
  1099     05  DAY2I PIC  X(0009).
  1100*    -------------------------------
  1101     05  GEDTOUTL PIC S9(0004) COMP.
  1102     05  GEDTOUTF PIC  X(0001).
  1103     05  FILLER REDEFINES GEDTOUTF.
  1104         10  GEDTOUTA PIC  X(0001).
  1105     05  GEDTOUTI PIC  X(0008).
  1106*    -------------------------------
  1107     05  GEDOUT2L PIC S9(0004) COMP.
  1108     05  GEDOUT2F PIC  X(0001).
  1109     05  FILLER REDEFINES GEDOUT2F.
  1110         10  GEDOUT2A PIC  X(0001).
  1111     05  GEDOUT2I PIC  X(0008).
  1112*    -------------------------------
  1113     05  JOUTL PIC S9(0004) COMP.
  1114     05  JOUTF PIC  X(0001).
  1115     05  FILLER REDEFINES JOUTF.
  1116         10  JOUTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL009.cbl
  1117     05  JOUTI PIC  X(0005).
  1118*    -------------------------------
  1119     05  ALFOUTL PIC S9(0004) COMP.
  1120     05  ALFOUTF PIC  X(0001).
  1121     05  FILLER REDEFINES ALFOUTF.
  1122         10  ALFOUTA PIC  X(0001).
  1123     05  ALFOUTI PIC  X(0025).
  1124*    -------------------------------
  1125     05  EMOSOUTL PIC S9(0004) COMP.
  1126     05  EMOSOUTF PIC  X(0001).
  1127     05  FILLER REDEFINES EMOSOUTF.
  1128         10  EMOSOUTA PIC  X(0001).
  1129     05  EMOSOUTI PIC  X(0006).
  1130*    -------------------------------
  1131     05  ODDOUTL PIC S9(0004) COMP.
  1132     05  ODDOUTF PIC  X(0001).
  1133     05  FILLER REDEFINES ODDOUTF.
  1134         10  ODDOUTA PIC  X(0001).
  1135     05  ODDOUTI PIC  X(0006).
  1136*    -------------------------------
  1137     05  EDAYOUTL PIC S9(0004) COMP.
  1138     05  EDAYOUTF PIC  X(0001).
  1139     05  FILLER REDEFINES EDAYOUTF.
  1140         10  EDAYOUTA PIC  X(0001).
  1141     05  EDAYOUTI PIC  X(0006).
  1142*    -------------------------------
  1143     05  EDAYMONL PIC S9(0004) COMP.
  1144     05  EDAYMONF PIC  X(0001).
  1145     05  FILLER REDEFINES EDAYMONF.
  1146         10  EDAYMONA PIC  X(0001).
  1147     05  EDAYMONI PIC  X(0002).
  1148*    -------------------------------
  1149     05  ERROUTL PIC S9(0004) COMP.
  1150     05  ERROUTF PIC  X(0001).
  1151     05  FILLER REDEFINES ERROUTF.
  1152         10  ERROUTA PIC  X(0001).
  1153     05  ERROUTI PIC  X(0071).
  1154 01  EL009AO REDEFINES EL009AI.
  1155     05  FILLER            PIC  X(0012).
  1156*    -------------------------------
  1157     05  FILLER            PIC  X(0003).
  1158     05  SDATEO PIC  X(0009).
  1159*    -------------------------------
  1160     05  FILLER            PIC  X(0003).
  1161     05  STIMEO PIC  X(0005).
  1162*    -------------------------------
  1163     05  FILLER            PIC  X(0003).
  1164     05  BSTRINO PIC  X(0004).
  1165*    -------------------------------
  1166     05  FILLER            PIC  X(0003).
  1167     05  BENDINO PIC  X(0004).
  1168*    -------------------------------
  1169     05  FILLER            PIC  X(0003).
  1170     05  JINO PIC  X(0005).
  1171*    -------------------------------
  1172     05  FILLER            PIC  X(0003).
  1173     05  GEDTINO PIC  X(0008).
  1174*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL009.cbl
  1175     05  FILLER            PIC  X(0003).
  1176     05  GMDYINO PIC  X(0006).
  1177*    -------------------------------
  1178     05  FILLER            PIC  X(0003).
  1179     05  GYMDINO PIC  X(0006).
  1180*    -------------------------------
  1181     05  FILLER            PIC  X(0003).
  1182     05  EMOSINO PIC  9(5)-.
  1183*    -------------------------------
  1184     05  FILLER            PIC  X(0003).
  1185     05  MONENDO PIC  X(0001).
  1186*    -------------------------------
  1187     05  FILLER            PIC  X(0003).
  1188     05  EDAYINO PIC  9(5)-.
  1189*    -------------------------------
  1190     05  FILLER            PIC  X(0003).
  1191     05  CENTURYO PIC  X(0001).
  1192*    -------------------------------
  1193     05  FILLER            PIC  X(0003).
  1194     05  BOUTO PIC  X(0004).
  1195*    -------------------------------
  1196     05  FILLER            PIC  X(0003).
  1197     05  BOUT2O PIC  X(0004).
  1198*    -------------------------------
  1199     05  FILLER            PIC  X(0003).
  1200     05  DAY1O PIC  X(0009).
  1201*    -------------------------------
  1202     05  FILLER            PIC  X(0003).
  1203     05  DAY2O PIC  X(0009).
  1204*    -------------------------------
  1205     05  FILLER            PIC  X(0003).
  1206     05  GEDTOUTO PIC  X(0008).
  1207*    -------------------------------
  1208     05  FILLER            PIC  X(0003).
  1209     05  GEDOUT2O PIC  X(0008).
  1210*    -------------------------------
  1211     05  FILLER            PIC  X(0003).
  1212     05  JOUTO PIC  9(5).
  1213*    -------------------------------
  1214     05  FILLER            PIC  X(0003).
  1215     05  ALFOUTO PIC  X(0025).
  1216*    -------------------------------
  1217     05  FILLER            PIC  X(0003).
  1218     05  EMOSOUTO PIC  9(5)-.
  1219*    -------------------------------
  1220     05  FILLER            PIC  X(0003).
  1221     05  ODDOUTO PIC  9(5)-.
  1222*    -------------------------------
  1223     05  FILLER            PIC  X(0003).
  1224     05  EDAYOUTO PIC  9(5)-.
  1225*    -------------------------------
  1226     05  FILLER            PIC  X(0003).
  1227     05  EDAYMONO PIC  99.
  1228*    -------------------------------
  1229     05  FILLER            PIC  X(0003).
  1230     05  ERROUTO PIC  X(0071).
  1231*    -------------------------------
  1232
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL009.cbl
  1233/
  1234****************************************************************
  1235*
  1236* Copyright (c) 2007 by Clerity Solutions, Inc.
  1237* All rights reserved.
  1238*
  1239****************************************************************
  1240 01  DFHEIV.
  1241   02  DFHEIV0               PIC X(35).
  1242   02  DFHEIV1               PIC X(08).
  1243   02  DFHEIV2               PIC X(08).
  1244   02  DFHEIV3               PIC X(08).
  1245   02  DFHEIV4               PIC X(06).
  1246   02  DFHEIV5               PIC X(04).
  1247   02  DFHEIV6               PIC X(04).
  1248   02  DFHEIV7               PIC X(02).
  1249   02  DFHEIV8               PIC X(02).
  1250   02  DFHEIV9               PIC X(01).
  1251   02  DFHEIV10              PIC S9(7) COMP-3.
  1252   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1253   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1254   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1255   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1256   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1257   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1258   02  DFHEIV17              PIC X(04).
  1259   02  DFHEIV18              PIC X(04).
  1260   02  DFHEIV19              PIC X(04).
  1261   02  DFHEIV20              USAGE IS POINTER.
  1262   02  DFHEIV21              USAGE IS POINTER.
  1263   02  DFHEIV22              USAGE IS POINTER.
  1264   02  DFHEIV23              USAGE IS POINTER.
  1265   02  DFHEIV24              USAGE IS POINTER.
  1266   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1267   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1268   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1269   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1270   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1271   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1272   02  FILLER                PIC X(02).
  1273   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1274   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1275   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1276   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1277   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1278 LINKAGE  SECTION.
  1279*****************************************************************
  1280*                                                               *
  1281* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1282* All rights reserved.                                          *
  1283*                                                               *
  1284*****************************************************************
  1285 01  dfheiblk.
  1286     02  eibtime          pic s9(7) comp-3.
  1287     02  eibdate          pic s9(7) comp-3.
  1288     02  eibtrnid         pic x(4).
  1289     02  eibtaskn         pic s9(7) comp-3.
  1290     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL009.cbl
  1291     02  dfheigdi         pic s9(4) comp.
  1292     02  eibcposn         pic s9(4) comp.
  1293     02  eibcalen         pic s9(4) comp.
  1294     02  eibaid           pic x(1).
  1295     02  eibfiller1       pic x(1).
  1296     02  eibfn            pic x(2).
  1297     02  eibfiller2       pic x(2).
  1298     02  eibrcode         pic x(6).
  1299     02  eibfiller3       pic x(2).
  1300     02  eibds            pic x(8).
  1301     02  eibreqid         pic x(8).
  1302     02  eibrsrce         pic x(8).
  1303     02  eibsync          pic x(1).
  1304     02  eibfree          pic x(1).
  1305     02  eibrecv          pic x(1).
  1306     02  eibsend          pic x(1).
  1307     02  eibatt           pic x(1).
  1308     02  eibeoc           pic x(1).
  1309     02  eibfmh           pic x(1).
  1310     02  eibcompl         pic x(1).
  1311     02  eibsig           pic x(1).
  1312     02  eibconf          pic x(1).
  1313     02  eiberr           pic x(1).
  1314     02  eibrldbk         pic x(1).
  1315     02  eiberrcd         pic x(4).
  1316     02  eibsynrb         pic x(1).
  1317     02  eibnodat         pic x(1).
  1318     02  eibfiller5       pic x(2).
  1319     02  eibresp          pic 9(09) comp.
  1320     02  eibresp2         pic 9(09) comp.
  1321     02  dfheigdj         pic s9(4) comp.
  1322     02  dfheigdk         pic s9(4) comp.
  1323 01  DFHCOMMAREA       PIC X(01).
  1324 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1325 0000-DFHEXIT SECTION.
  1326     MOVE '9#                    $   ' TO DFHEIV0.
  1327     MOVE 'EL009' TO DFHEIV1.
  1328     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1329***  Y2K, PROJ 7744
  1330     INITIALIZE  DATE-CONVERSION-DATA-INIT
  1331                 BINARY-WORK
  1332                 HEXADECIMAL-DAYS
  1333
  1334     MOVE +200                  TO INIT-DC-COMM-LENGTH
  1335
  1336     MOVE SPACES                TO DC-ERROR-CODE.
  1337
  1338     MOVE ZEROS                 TO DC-ELAPSED-MONTHS
  1339                                   DC-ODD-DAYS-OVER
  1340                                   DC-ELAPSED-DAYS
  1341                                   DC-JULIAN-YEAR
  1342                                   DC-JULIAN-DAYS
  1343                                   DC-DAYS-IN-MONTH.
  1344
  1345     MOVE LOW-VALUES            TO DC-BIN-DATE-1
  1346                                   DC-BIN-DATE-2
  1347                                   INIT-DC-BIN-DATE-1
  1348                                   INIT-DC-BIN-DATE-2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL009.cbl
  1349***  Y2K, PROJ 7744
  1350
  1351     MOVE EIBDATE               TO W-CURRENT-DATE.
  1352*    ACCEPT W-CURRENT-DATE FROM DATE.
  1353***  Y2K, PROJ 7744
  1354     MOVE '1'                  TO FIND-CENTURY-FLAG
  1355     MOVE W-JULIAN-CEN         TO SEARCH-CENTURY-CD-N
  1356                                  W-FLOAT-YEAR-CD.
  1357     PERFORM 0800-FIND-CENTURY
  1358     IF NO-CONVERSION-ERROR
  1359         MOVE FOUND-CENTURY-N  TO CURRENT-CENTURY-1-N
  1360     END-IF.
  1361***  Y2K, PROJ 7744
  1362     COMPUTE W-FLOAT-YEAR = W-CD-CCYY -
  1363                           ((W-JULIAN-CEN*100)+ 70)
  1364
  1365     MOVE W-CURRENT-DATE        TO DC-JULIAN-YYDDD.
  1366     MOVE '5'                   TO DC-OPTION-CODE.
  1367     PERFORM 8500-DATE-CONVERSION.
  1368     MOVE DC-GREG-DATE-1-EDIT   TO SAVE-DATE.
  1369     MOVE DC-BIN-DATE-1         TO SAVE-BIN-DATE.
  1370
  1371     MOVE DATE-CONVERSION-DATA-INIT  TO  DATE-CONVERSION-DATA
  1372
  1373
  1374* EXEC CICS HANDLE AID
  1375*        CLEAR   (8950-CLEAR-RETURN)
  1376*        PF1     (4010-BIN-TO-GREG)
  1377*        PF2     (4020-COMPUTE-ELAPSED)
  1378*        PF6     (4020-COMPUTE-ELAPSED)
  1379*        PF3     (4030-GREG-TO-BIN)
  1380*        PF4     (4040-JULIAN-TO-OTHER)
  1381*        PF5     (4050-BINARY-PLUS-ELAPSED)
  1382*        ANYKEY  (4060-UNSUPPORTED)
  1383*        END-EXEC.
  1384*    MOVE '"&=$&*''()@           V! " #00001369' TO DFHEIV0
  1385     MOVE X'22263D24262A272829402020' TO DFHEIV0(1:12)
  1386     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  1387     MOVE X'2220233030303031333639' TO DFHEIV0(25:11)
  1388     CALL 'kxdfhei1' USING DFHEIV0
  1389     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1390
  1391
  1392
  1393* EXEC CICS HANDLE CONDITION
  1394*        MAPFAIL (8900-MAPFAIL)
  1395*        END-EXEC.
  1396*    MOVE '"$?                   ! # #00001380' TO DFHEIV0
  1397     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  1398     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1399     MOVE X'2320233030303031333830' TO DFHEIV0(25:11)
  1400     CALL 'kxdfhei1' USING DFHEIV0
  1401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1402
  1403
  1404     IF EIBCALEN GREATER THAN ZERO
  1405         GO TO 0300-RECEIVE-MAP.
  1406
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL009.cbl
  1407     MOVE LOW-VALUES             TO EL009AO.
  1408
  1409* EXEC CICS ASKTIME ABSTIME(LCP-CICS-TIME)
  1410*    END-EXEC
  1411*    MOVE '0"A                   "   #00001388' TO DFHEIV0
  1412     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
  1413     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  1414     MOVE X'2020233030303031333838' TO DFHEIV0(25:11)
  1415     CALL 'kxdfhei1' USING DFHEIV0,
  1416           LCP-CICS-TIME
  1417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1418
  1419* EXEC CICS FORMATTIME
  1420*              ABSTIME(LCP-CICS-TIME)
  1421*              TIME(LCP-TIME-OF-DAY-XX)
  1422*    END-EXEC
  1423*    MOVE 'j$(     (             #   #00001390' TO DFHEIV0
  1424     MOVE X'6A2428202020202028202020' TO DFHEIV0(1:12)
  1425     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1426     MOVE X'2020233030303031333930' TO DFHEIV0(25:11)
  1427     CALL 'kxdfhei1' USING DFHEIV0,
  1428           LCP-CICS-TIME,
  1429           LCP-TIME-OF-DAY-XX
  1430     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1431     MOVE  LCP-TIME-OF-DAY-68 TO TIME-IN.
  1432     MOVE TIME-HHMM              TO TIME-OUT.
  1433     MOVE TIME-OUT               TO STIMEO.
  1434     MOVE SAVE-DATE              TO SDATEO.
  1435
  1436 0100-SEND-INITIAL-MAP.
  1437     MOVE WS-IC                  TO BSTRINL.
  1438
  1439
  1440* EXEC CICS SEND
  1441*        MAP     ('EL009A')
  1442*        MAPSET  ('EL009S')
  1443*        ERASE
  1444*        FREEKB
  1445*        CURSOR
  1446*        END-EXEC.
  1447     MOVE 'EL009A' TO DFHEIV1
  1448     MOVE -1
  1449       TO DFHEIV11
  1450     MOVE 'EL009S' TO DFHEIV2
  1451*    MOVE '8$     CT  E F  H     ,   #00001402' TO DFHEIV0
  1452     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1453     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  1454     MOVE X'2020233030303031343032' TO DFHEIV0(25:11)
  1455     CALL 'kxdfhei1' USING DFHEIV0,
  1456           DFHEIV1,
  1457           EL009AO,
  1458           DFHEIV99,
  1459           DFHEIV2,
  1460           DFHEIV99,
  1461           DFHEIV99,
  1462           DFHEIV99,
  1463           DFHEIV11,
  1464           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL009.cbl
  1465           DFHEIV99,
  1466           DFHEIV99
  1467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1468
  1469
  1470     GO TO 0250-RETURN.
  1471
  1472 0200-SEND-MAP-DATAONLY.
  1473     MOVE WS-IC                  TO BSTRINL.
  1474
  1475
  1476* EXEC CICS SEND
  1477*        MAP     ('EL009A')
  1478*        MAPSET  ('EL009S')
  1479*        DATAONLY
  1480*        FREEKB
  1481*        CURSOR
  1482*        END-EXEC.
  1483     MOVE 'EL009A' TO DFHEIV1
  1484     MOVE -1
  1485       TO DFHEIV11
  1486     MOVE 'EL009S' TO DFHEIV2
  1487*    MOVE '8$D    CT    F  H     ,   #00001415' TO DFHEIV0
  1488     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  1489     MOVE X'204620204820202020202C20' TO DFHEIV0(13:12)
  1490     MOVE X'2020233030303031343135' TO DFHEIV0(25:11)
  1491     CALL 'kxdfhei1' USING DFHEIV0,
  1492           DFHEIV1,
  1493           EL009AO,
  1494           DFHEIV99,
  1495           DFHEIV2,
  1496           DFHEIV99,
  1497           DFHEIV99,
  1498           DFHEIV99,
  1499           DFHEIV11,
  1500           DFHEIV99,
  1501           DFHEIV99,
  1502           DFHEIV99
  1503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1504
  1505     MOVE LOW-VALUES             TO EL009AO.
  1506
  1507 0250-RETURN.
  1508
  1509* EXEC CICS RETURN
  1510*        TRANSID  (EIBTRNID)
  1511*        COMMAREA (DATE-CONVERSION-DATA)
  1512*        LENGTH   (DC-COMM-LENGTH) END-EXEC.
  1513*    MOVE '.(CT                  &   #00001425' TO DFHEIV0
  1514     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  1515     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1516     MOVE X'2020233030303031343235' TO DFHEIV0(25:11)
  1517     CALL 'kxdfhei1' USING DFHEIV0,
  1518           EIBTRNID,
  1519           DATE-CONVERSION-DATA,
  1520           DC-COMM-LENGTH,
  1521           DFHEIV99,
  1522           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL009.cbl
  1523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1524
  1525
  1526
  1527 0300-RECEIVE-MAP.
  1528
  1529* EXEC CICS RECEIVE
  1530*        MAP     ('EL009A')
  1531*        MAPSET  ('EL009S')
  1532*        END-EXEC.
  1533     MOVE 'EL009A' TO DFHEIV1
  1534     MOVE 'EL009S' TO DFHEIV2
  1535*    MOVE '8"T                   ''   #00001432' TO DFHEIV0
  1536     MOVE X'382254202020202020202020' TO DFHEIV0(1:12)
  1537     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1538     MOVE X'2020233030303031343332' TO DFHEIV0(25:11)
  1539     CALL 'kxdfhei1' USING DFHEIV0,
  1540           DFHEIV1,
  1541           EL009AI,
  1542           DFHEIV99,
  1543           DFHEIV2,
  1544           DFHEIV99,
  1545           DFHEIV99
  1546     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1547
  1548
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL009.cbl
  1550 4010-BIN-TO-GREG.
  1551
  1552     IF  CENTURYL GREATER THAN ZERO
  1553         IF  CENTURYI EQUAL '1' OR '2' OR ' '
  1554             MOVE CENTURYI       TO  DC-CENTURY-ADJUSTMENT
  1555         ELSE
  1556             GO TO 6000-INPUT-ERROR.
  1557
  1558     IF BSTRINL NOT = ZERO
  1559         MOVE BSTRINI            TO HEXADECIMAL-DAYS
  1560         MOVE ZERO               TO BINARY-WORK
  1561         SET U, V, W TO 1
  1562         PERFORM 7500-FIND-HEX-CHAR THRU 7999-EXIT
  1563         MOVE BINARY-DTE         TO DC-BIN-DATE-1
  1564         MOVE SPACE              TO DC-OPTION-CODE
  1565         GO TO 5000-FORMAT-OUTPUT
  1566     ELSE
  1567         GO TO 6000-INPUT-ERROR.
  1568
  1569 4020-COMPUTE-ELAPSED.
  1570     IF BSTRINL = ZERO OR
  1571        BENDINL = ZERO
  1572         GO TO 6000-INPUT-ERROR.
  1573
  1574     IF  CENTURYL GREATER THAN ZERO
  1575
  1576         IF  CENTURYI EQUAL '1' OR '2' OR ' '
  1577             MOVE CENTURYI       TO  DC-CENTURY-ADJUSTMENT
  1578
  1579         ELSE
  1580             GO TO 6000-INPUT-ERROR.
  1581
  1582     MOVE BSTRINI                TO HEXADECIMAL-DAYS.
  1583     MOVE ZERO                   TO BINARY-WORK.
  1584     SET U, V, W TO 1.
  1585     PERFORM 7500-FIND-HEX-CHAR THRU 7999-EXIT.
  1586     MOVE BINARY-DTE             TO DC-BIN-DATE-1.
  1587     MOVE BENDINI                TO HEXADECIMAL-DAYS.
  1588     MOVE ZERO                   TO BINARY-WORK.
  1589     SET U, V, W TO 1.
  1590     PERFORM 7500-FIND-HEX-CHAR THRU 7999-EXIT.
  1591     MOVE BINARY-DTE             TO DC-BIN-DATE-2.
  1592
  1593     IF EIBAID = DFHPF6
  1594         MOVE '7'                TO DC-OPTION-CODE
  1595     ELSE
  1596         MOVE '1'                TO DC-OPTION-CODE.
  1597
  1598     GO TO 5000-FORMAT-OUTPUT.
  1599
  1600 4030-GREG-TO-BIN.
  1601
  1602     IF  CENTURYL GREATER THAN ZERO
  1603
  1604         IF  CENTURYI EQUAL '1' OR '2' OR ' '
  1605             MOVE CENTURYI       TO  DC-CENTURY-ADJUSTMENT
  1606
  1607         ELSE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL009.cbl
  1608             GO TO 6000-INPUT-ERROR.
  1609
  1610     IF GEDTINL = 8
  1611         MOVE GEDTINI            TO DC-GREG-DATE-1-EDIT
  1612         MOVE '2'                TO DC-OPTION-CODE
  1613         GO TO 5000-FORMAT-OUTPUT.
  1614
  1615     IF GMDYINL = 6
  1616         MOVE GMDYINI            TO DC-GREG-DATE-1-MDY
  1617         MOVE '4'                TO DC-OPTION-CODE
  1618         GO TO 5000-FORMAT-OUTPUT.
  1619
  1620     IF GYMDINL = 6
  1621         MOVE GYMDINI            TO DC-GREG-DATE-1-YMD
  1622         MOVE '3'                TO DC-OPTION-CODE
  1623         GO TO 5000-FORMAT-OUTPUT.
  1624
  1625     GO TO 6000-INPUT-ERROR.
  1626
  1627 4040-JULIAN-TO-OTHER.
  1628     IF JINL = ZERO
  1629         GO TO 6000-INPUT-ERROR
  1630     ELSE
  1631         MOVE JINI               TO DC-JULIAN-YYDDD
  1632         MOVE '5'                TO DC-OPTION-CODE.
  1633
  1634     IF  CENTURYL GREATER THAN ZERO
  1635
  1636         IF  CENTURYI EQUAL '1' OR '2' OR ' '
  1637             MOVE CENTURYI       TO  DC-CENTURY-ADJUSTMENT
  1638
  1639         ELSE
  1640             GO TO 6000-INPUT-ERROR.
  1641
  1642     GO TO 5000-FORMAT-OUTPUT.
  1643
  1644 4050-BINARY-PLUS-ELAPSED.
  1645     IF BSTRINL = ZERO
  1646         GO TO 6000-INPUT-ERROR.
  1647
  1648     IF MONENDL GREATER THAN ZERO
  1649         MOVE '1'                TO  DC-END-OF-MONTH.
  1650
  1651     IF  CENTURYL GREATER THAN ZERO
  1652         MOVE '1'                TO  DC-CENTURY-ADJUSTMENT.
  1653
  1654     IF EMOSINL GREATER THAN ZERO
  1655
  1656* EXEC CICS BIF DEEDIT
  1657*            FIELD  (EMOSINI)
  1658*            LENGTH (6) END-EXEC
  1659     MOVE 6
  1660       TO DFHEIV11
  1661*    MOVE '@"L                   #   #00001543' TO DFHEIV0
  1662     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  1663     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1664     MOVE X'2020233030303031353433' TO DFHEIV0(25:11)
  1665     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL009.cbl
  1666           EMOSINI,
  1667           DFHEIV11
  1668     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1669         IF EMOSINI IS NOT NUMERIC
  1670             GO TO 6200-NON-NUMERIC-DATA
  1671         ELSE
  1672             MOVE EMOSINI        TO  DC-ELAPSED-MONTHS
  1673                                     EMOSINO.
  1674
  1675     IF EDAYINL GREATER THAN ZERO
  1676
  1677* EXEC CICS BIF DEEDIT
  1678*            FIELD  (EDAYINI)
  1679*            LENGTH (6) END-EXEC
  1680     MOVE 6
  1681       TO DFHEIV11
  1682*    MOVE '@"L                   #   #00001553' TO DFHEIV0
  1683     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  1684     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1685     MOVE X'2020233030303031353533' TO DFHEIV0(25:11)
  1686     CALL 'kxdfhei1' USING DFHEIV0,
  1687           EDAYINI,
  1688           DFHEIV11
  1689     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1690         IF EDAYINI IS NOT NUMERIC
  1691             GO TO 6200-NON-NUMERIC-DATA
  1692         ELSE
  1693             MOVE EDAYINI        TO  DC-ELAPSED-DAYS
  1694                                     EDAYINO.
  1695
  1696     MOVE BSTRINI                TO HEXADECIMAL-DAYS.
  1697     MOVE ZERO                   TO BINARY-WORK.
  1698     SET U V W TO 1.
  1699     PERFORM 7500-FIND-HEX-CHAR THRU 7999-EXIT.
  1700     MOVE BINARY-DTE             TO DC-BIN-DATE-1.
  1701     MOVE '6'                    TO DC-OPTION-CODE.
  1702     GO TO 5000-FORMAT-OUTPUT.
  1703
  1704 4060-UNSUPPORTED.
  1705     MOVE 'KEY PRESSED IS NOT SUPPORTED - PF1 THRU PF4 OR CLEAR'
  1706                                 TO ERROUTO.
  1707     GO TO 0200-SEND-MAP-DATAONLY.
  1708
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL009.cbl
  1710 5000-FORMAT-OUTPUT.
  1711     PERFORM 8500-DATE-CONVERSION
  1712
  1713***  Y2K, PROJ 7744
  1714     MOVE DC-GREG-DATE-1-EDIT    TO GEDTOUTO.
  1715     MOVE DC-GREG-DATE-2-EDIT    TO GEDOUT2O.
  1716
  1717     IF GEDOUT2O = '  /  /  ' OR '00/00/00'
  1718         MOVE '        '         TO GEDOUT2O
  1719     END-IF.
  1720
  1721     MOVE DC-JULIAN-YYDDD        TO JOUTO.
  1722     MOVE DC-GREG-DATE-1-ALPHA   TO ALFOUTO.
  1723
  1724     MOVE DC-ELAPSED-MONTHS      TO EMOSOUTO.
  1725     MOVE DC-ODD-DAYS-OVER       TO ODDOUTO.
  1726     MOVE DC-ELAPSED-DAYS        TO EDAYOUTO.
  1727     MOVE DC-DAYS-IN-MONTH       TO EDAYMONO.
  1728
  1729     IF DC-DAY-OF-WEEK NOT = ZERO
  1730         MOVE WS-DAY-OF-WEEK (DC-DAY-OF-WEEK)  TO  DAY1O
  1731     ELSE
  1732         MOVE SPACES                           TO  DAY1O
  1733     END-IF
  1734
  1735     IF DC-DAY-OF-WEEK2 NOT = ZERO
  1736         MOVE WS-DAY-OF-WEEK (DC-DAY-OF-WEEK2) TO  DAY2O
  1737     ELSE
  1738         MOVE SPACES                           TO  DAY2O
  1739     END-IF
  1740
  1741     MOVE ZERO                   TO HEXADECIMAL-DAYS BINARY-WORK.
  1742     MOVE DC-BIN-DATE-1          TO BINARY-DTE.
  1743     SET V W TO 1.
  1744     PERFORM 7000-GENERATE-HEX-CHARACTERS THRU 7499-EXIT.
  1745
  1746     IF HEXADECIMAL-DAYS NOT = ZEROS
  1747         MOVE HEXADECIMAL-DAYS   TO BOUTO
  1748     ELSE
  1749         MOVE SPACES             TO BOUTO
  1750     END-IF
  1751
  1752     MOVE ZERO                   TO HEXADECIMAL-DAYS BINARY-WORK.
  1753     MOVE DC-BIN-DATE-2          TO BINARY-DTE.
  1754     SET V W TO 1.
  1755     PERFORM 7000-GENERATE-HEX-CHARACTERS THRU 7499-EXIT.
  1756
  1757     IF HEXADECIMAL-DAYS NOT = ZEROS
  1758         MOVE HEXADECIMAL-DAYS   TO BOUT2O
  1759     ELSE
  1760         MOVE SPACES             TO BOUT2O
  1761     END-IF
  1762***  Y2K, PROJ 7744
  1763
  1764     IF DC-ERROR-CODE = SPACE
  1765         MOVE 'DATE CONVERSION SUCCESSFUL   RETURN CODE SPACE'
  1766                                 TO ERROUTO.
  1767
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL009.cbl
  1768     IF DC-ERROR-CODE = '1'
  1769         MOVE 'DATE CONVERSION ERROR (DATE IS ZEROCODE = 1)'
  1770                                 TO ERROUTO.
  1771
  1772     IF DC-ERROR-CODE = '2'
  1773         MOVE 'DATE CONVERSION ERROR (DATE NOT NUMERICCODE = 2)'
  1774                                 TO ERROUTO.
  1775
  1776     IF DC-ERROR-CODE = '3'
  1777         MOVE 'DATE CONVERSION ERROR (DATE IS INVALIDCODE = 3)'
  1778                                 TO ERROUTO.
  1779
  1780     IF DC-ERROR-CODE = '4'
  1781         MOVE 'DATE CONVERSION ERROR (DATE1 IS AFTER DATE2 = 4)'
  1782                                 TO ERROUTO.
  1783
  1784     IF DC-ERROR-CODE = '5'
  1785         MOVE 'DATE CONVERSION ERROR (BIN PLUS ELAPSED NEG = 5)'
  1786                                 TO ERROUTO.
  1787
  1788     IF DC-ERROR-CODE = '9'
  1789         MOVE 'DATE CONVERSION ERROR = 9)'
  1790                                 TO ERROUTO.
  1791
  1792     GO TO 0200-SEND-MAP-DATAONLY.
  1793
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL009.cbl
  1795 6000-INPUT-ERROR.
  1796     MOVE 'DATA GIVEN IS NOT CONSISTENT WITH REQUEST - RE-ENTER'
  1797         TO ERROUTO.
  1798     INSPECT GEDTINI CONVERTING ' ' TO LOW-VALUES
  1799     INSPECT GMDYINI CONVERTING ' ' TO LOW-VALUES
  1800     INSPECT GYMDINI CONVERTING ' ' TO LOW-VALUES
  1801     GO TO 0200-SEND-MAP-DATAONLY.
  1802
  1803
  1804 6200-NON-NUMERIC-DATA.
  1805     MOVE 'ELAPSED MONTHS OR DAYS IS NON-NUMERIC - RE-ENTER'
  1806         TO ERROUTO.
  1807     GO TO 0200-SEND-MAP-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL009.cbl
  1809
  1810 7000-GENERATE-HEX-CHARACTERS.
  1811     IF BINARY-WORK LESS THAN DECIMAL-VALUE (V, W)
  1812         IF W LESS THAN 4
  1813             SET W UP BY 1
  1814             GO TO 7000-GENERATE-HEX-CHARACTERS
  1815         ELSE
  1816             GO TO 7499-EXIT.
  1817
  1818     SET V TO 15.
  1819
  1820 7050-GET-HEXADECIMAL-DIGIT.
  1821     IF BINARY-WORK NOT LESS THAN DECIMAL-VALUE (V, W)
  1822         SET U TO W
  1823         MOVE HEX-VALUE (V)      TO HEX-CHARACTER (U)
  1824         COMPUTE BINARY-WORK =
  1825                       BINARY-WORK - DECIMAL-VALUE (V, W)
  1826         SET V TO 1
  1827         GO TO 7000-GENERATE-HEX-CHARACTERS.
  1828
  1829     SET V DOWN BY 1.
  1830     GO TO 7050-GET-HEXADECIMAL-DIGIT.
  1831
  1832 7499-EXIT.
  1833     EXIT.
  1834
  1835 7500-FIND-HEX-CHAR.
  1836     IF U = 5
  1837         GO TO 7999-EXIT.
  1838
  1839     IF HEX-CHARACTER (U) = HEX-VALUE (V)
  1840         GO TO 7550-ADD-VALUE-IN.
  1841
  1842     IF V LESS 15
  1843         SET V UP BY 1
  1844         GO TO 7500-FIND-HEX-CHAR
  1845     ELSE
  1846         SET U, W UP BY 1
  1847         SET V TO 1
  1848         GO TO 7500-FIND-HEX-CHAR.
  1849
  1850 7550-ADD-VALUE-IN.
  1851     COMPUTE BINARY-WORK = BINARY-WORK + DECIMAL-VALUE (V, W).
  1852     SET U, W UP BY 1.
  1853     SET V TO 1.
  1854     GO TO 7500-FIND-HEX-CHAR.
  1855
  1856 7999-EXIT.
  1857     EXIT.
  1858
  1859 8500-DATE-CONVERSION SECTION.
  1860
  1861* EXEC CICS ASKTIME
  1862*        END-EXEC.
  1863*    MOVE '0"                    "   #00001726' TO DFHEIV0
  1864     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  1865     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  1866     MOVE X'2020233030303031373236' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL009.cbl
  1867     CALL 'kxdfhei1' USING DFHEIV0,
  1868           DFHEIV99
  1869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1870
  1871
  1872*8510-DATE-CONVERSION. COPY ELCDATP1.
  1873 8510-DATE-CONVERSION.
  1874*    COPY ELCDATP1.
  1875*****************************************************************
  1876*                                                               *
  1877*                                                               *
  1878*                            ELCDATP1.                          *
  1879*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1880*                            VMOD=2.002                         *
  1881*                                                               *
  1882*****************************************************************
  1883
  1884     IF NOT FIND-CENTURY
  1885        MOVE GREG-ALPHA-MASK   TO DC-GREG-DATE-1-ALPHA
  1886     END-IF
  1887
  1888     MOVE 2                    TO FIND-CENTURY-FLAG.
  1889     MOVE CURRENT-CENTURY-1-N  TO SEARCH-CENTURY-N
  1890     PERFORM 0800-FIND-CENTURY.
  1891
  1892     MOVE FOUND-CENTURY-CD-N   TO CONTROL-YEAR-CD
  1893                                  W-CD-YEAR-CD.
  1894*Y2K
  1895*                                 W-FLOAT-YEAR-CD.
  1896
  1897     COMPUTE BREAK-PERIOD = (FOUND-CENTURY-CD-N * 100) + 69
  1898
  1899     EVALUATE TRUE
  1900        WHEN W-CD-CCYY < BREAK-PERIOD
  1901           COMPUTE CONTROL-YEAR-CD = FOUND-CENTURY-CD-N - 1
  1902           ADD +1 TO CURRENT-CENTURY-1-N
  1903                            GIVING NEXT-CENTURY
  1904           SUBTRACT +1 FROM CURRENT-CENTURY-1-N
  1905                            GIVING PREVIOUS-CENTURY
  1906        WHEN OTHER
  1907           MOVE FOUND-CENTURY-CD-N TO CONTROL-YEAR-CD
  1908           COMPUTE CENTURY-MARK = 100 +
  1909                           (FOUND-CENTURY-CD-N * 100)
  1910           ADD +1 TO CURRENT-CENTURY-1-N
  1911                            GIVING NEXT-CENTURY
  1912           SUBTRACT +1 FROM CURRENT-CENTURY-1-N
  1913                            GIVING PREVIOUS-CENTURY
  1914     END-EVALUATE.
  1915
  1916     MOVE SPACES                 TO DC-ERROR-CODE.
  1917
  1918     MOVE ZERO                   TO  BIN-DATE.
  1919
  1920     EVALUATE TRUE
  1921        WHEN BIN-TO-GREG
  1922             OR ELAPSED-BETWEEN-BIN
  1923             OR BIN-PLUS-ELAPSED
  1924           MOVE DC-BIN-DATE-1    TO  BIN-DATE-WORK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL009.cbl
  1925        WHEN BIN-3-TO-GREG
  1926             OR ELAPSED-BETWEEN-BIN-3
  1927             OR BIN-TO-JULIAN-EXPANDED
  1928             OR BIN-PLUS-ELAPSED-3
  1929           MOVE DC-BIN-DATE-EXPAND-1 TO BIN-DATE-3-WORK
  1930     END-EVALUATE.
  1931
  1932     MOVE BIN-DATE               TO  WS-BINARY-DATE-1.
  1933
  1934     MOVE ZERO                   TO  BIN-DATE.
  1935
  1936     EVALUATE TRUE
  1937        WHEN ELAPSED-BETWEEN-BIN
  1938           MOVE DC-BIN-DATE-2          TO  BIN-DATE-WORK
  1939        WHEN ELAPSED-BETWEEN-BIN-3
  1940           MOVE DC-BIN-DATE-EXPAND-2 TO BIN-DATE-3-WORK
  1941     END-EVALUATE.
  1942
  1943     MOVE BIN-DATE               TO  WS-BINARY-DATE-2.
  1944
  1945     MOVE DC-ELAPSED-MONTHS      TO  WS-ELAPSED-MONTHS.
  1946     MOVE DC-ELAPSED-DAYS        TO  WS-ELAPSED-DAYS.
  1947
  1948     EVALUATE TRUE
  1949        WHEN JULIAN-TO-BIN OR
  1950             JULIAN-TO-BIN-3
  1951           MOVE DC-JULIAN-YEAR   TO  JULIAN-YEAR1
  1952           MOVE DC-JULIAN-DAYS   TO  JULIAN-DAY1
  1953        WHEN JULIAN-EXPANDED-TO-BIN OR
  1954             JULIAN-EXPANDED-TO-BIN-3
  1955           MOVE DC-JULIAN-1-CC   TO DC-ALPHA-CEN-N
  1956           MOVE DC-JULIAN-1-YR   TO JULIAN-YEAR1
  1957           MOVE DC-JULIAN-DA-1   TO JULIAN-DAY1
  1958     END-EVALUATE.
  1959
  1960     EVALUATE TRUE
  1961        WHEN BIN-PLUS-ELAPSED OR
  1962             BIN-PLUS-ELAPSED-3
  1963           PERFORM 0700-CALCULATE-END-DATE
  1964        WHEN BIN-TO-GREGORIAN
  1965           PERFORM 0300-REFORMAT-BINARY-DAYS
  1966        WHEN GREGORIAN-TO-BIN
  1967           PERFORM 0400-REFORMAT-GREGORIAN-DATE
  1968        WHEN JULIAN-TO-BINARY
  1969           PERFORM 0500-REFORMAT-JULIAN-DATE
  1970        WHEN FIND-CENTURY
  1971           MOVE SPACE         TO DC-ERROR-CODE
  1972           MOVE 0             TO YEAR1
  1973           MOVE 3             TO FIND-CENTURY-FLAG
  1974           MOVE DC-ALPHA-YEAR TO YEAR1
  1975*          display ' cpdbebug task prior if ' eibtaskn
  1976           IF YEAR1 < W-FLOAT-YEAR
  1977*             display ' cpdebug task inside if ' eibtaskn
  1978              ADD 100 TO YEAR1
  1979           END-IF
  1980*          display ' cpdebug task prior  ' eibtaskn
  1981           PERFORM 0800-FIND-CENTURY
  1982*          display ' cpdebug task after  ' eibtaskn
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL009.cbl
  1983           IF NO-CONVERSION-ERROR
  1984              MOVE 'B'        TO DC-ERROR-CODE
  1985           END-IF
  1986        WHEN CHECK-LEAP-YEAR
  1987           MOVE HOLD-CEN-1-YY TO CHECK-YEAR
  1988           MOVE HOLD-CEN-1-CC TO SEARCH-CENTURY
  1989           MOVE 2             TO FIND-CENTURY-FLAG
  1990           PERFORM 0800-FIND-CENTURY
  1991           IF NO-CONVERSION-ERROR
  1992              PERFORM 0900-CHECK-FOR-LEAP-YEAR THRU 0900-EXIT
  1993              IF A-LEAP-YEAR
  1994                 MOVE LEAP-YR-DAYS (2) TO HOLD-CEN-1-DA
  1995              ELSE
  1996                 MOVE REGULAR-DAYS (2) TO HOLD-CEN-1-DA
  1997              END-IF
  1998              MOVE 'C'        TO DC-ERROR-CODE
  1999           END-IF
  2000        WHEN OTHER
  2001           MOVE '9'           TO DC-ERROR-CODE
  2002     END-EVALUATE.
  2003
  2004     IF NO-CONVERSION-ERROR
  2005         PERFORM 0200-DATE-CONVERSION-ROUTINES.
  2006
  2007
  2008* EXEC CICS ASKTIME
  2009*        END-EXEC.
  2010*    MOVE '0"                    "   #00001864' TO DFHEIV0
  2011     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  2012     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  2013     MOVE X'2020233030303031383634' TO DFHEIV0(25:11)
  2014     CALL 'kxdfhei1' USING DFHEIV0,
  2015           DFHEIV99
  2016     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2017
  2018
  2019 8590-EXIT.
  2020     EXIT.
  2021
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL009.cbl
  2023*0200-DATE-CONVERSION-ROUTINES SECTION. COPY ELCDATP2 REPLACING
  2024 0200-DATE-CONVERSION-ROUTINES SECTION.
  2025*    COPY ELCDATP2 REPLACING
  2026*    DC-JULIAN-DATE              BY  DC-JULIAN-YYDDD.
  2027* 11-16-98: JJPA -  ADDED CODE TO FIX Y2K ERROR -
  2028* 11-16-98: JJPA -  MOVE CCYY TO DC-EDITB-CENT/-YEAR
  2029******************************************************************
  2030*                                                                *
  2031*                                                                *
  2032*                            ELCDATP2.                           *
  2033*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2034*                            VMOD=2.005                          *
  2035*                                                                *
  2036*                       DATE CONVERSION ROUTINE                  *
  2037*                                                                *
  2038******************************************************************
  2039
  2040     IF BIN-PLUS-ELAPSED  OR
  2041        BIN-PLUS-ELAPSED-3
  2042         COMPUTE WS-BINARY-DATE-2 = (((YEAR1 * 12) +
  2043                                    (MONTH1 - 1)) * 32) + DAY1
  2044         MOVE WS-BINARY-DATE-2   TO  BIN-DATE
  2045         MOVE BIN-DATE-WORK      TO  DC-BIN-DATE-2
  2046         MOVE BIN-DATE-3-WORK    TO  DC-BIN-DATE-EXPAND-2
  2047     ELSE
  2048         COMPUTE WS-BINARY-DATE-1 = (((YEAR1 * 12) +
  2049                                    (MONTH1 - 1)) * 32) + DAY1
  2050         MOVE WS-BINARY-DATE-1   TO  BIN-DATE
  2051         MOVE BIN-DATE-WORK      TO  DC-BIN-DATE-1
  2052         MOVE BIN-DATE-3-WORK    TO  DC-BIN-DATE-EXPAND-1.
  2053
  2054     SET MTHX TO MONTH1.
  2055
  2056*    MOVE GREG-ALPHA-MASK        TO  DC-GREG-DATE-1-ALPHA.
  2057
  2058     MOVE '/'                    TO  SLASH1-1  SLASH1-2
  2059                                     SLASH2-1  SLASH2-2
  2060                                     SLASHA-1  SLASHA-2
  2061                                     SLASHB-1  SLASHB-2.
  2062
  2063     EVALUATE TRUE
  2064        WHEN ADJUST-DOWN-100-YRS
  2065           IF CURRENT-CENTURY-1-N = 19
  2066              MOVE 19               TO DC-ALPHA-CEN-N
  2067           ELSE
  2068              MOVE PREVIOUS-CENTURY TO DC-ALPHA-CEN-N
  2069           END-IF
  2070        WHEN ADJUST-UP-100-YRS
  2071           MOVE NEXT-CENTURY TO DC-ALPHA-CEN-N
  2072        WHEN DC-ALPHA-CEN-N > 0
  2073           CONTINUE
  2074        WHEN OTHER
  2075           MOVE 3 TO FIND-CENTURY-FLAG
  2076           PERFORM 0800-FIND-CENTURY
  2077     END-EVALUATE.
  2078
  2079     MOVE MONTH1                TO DC-EDIT1-MONTH
  2080                                   DC-YMD-MONTH
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL009.cbl
  2081                                   DC-MDY-MONTH
  2082                                   DC-CYMD-MONTH
  2083                                   DC-MDCY-MONTH
  2084                                   DC-EDITA-MONTH
  2085                                   DC-EDITB-MONTH.
  2086
  2087     MOVE NAME-OF-MONTH (MTHX)  TO DC-ALPHA-MONTH.
  2088
  2089     MOVE DAYS-IN-MONTH (MTHX)  TO DC-DAYS-IN-MONTH.
  2090
  2091     MOVE DAY1                  TO DC-EDIT1-DAY
  2092                                   DC-YMD-DAY
  2093                                   DC-MDY-DAY
  2094                                   DC-CYMD-DAY
  2095                                   DC-MDCY-DAY
  2096                                   DC-ALPHA-DAY
  2097                                   DC-EDITA-DAY
  2098                                   DC-EDITB-DAY.
  2099
  2100     MOVE YEAR1                 TO DC-EDIT1-YEAR
  2101                                   DC-YMD-YEAR
  2102                                   DC-MDY-YEAR
  2103                                   DC-CYMD-YEAR
  2104                                   DC-MDCY-YEAR
  2105                                   DC-ALPHA-YEAR
  2106                                   DC-EDITA-YEAR
  2107                                   DC-EDITB-YEAR.
  2108
  2109     MOVE DC-ALPHA-CEN-N        TO DC-EDITA-CENT
  2110                                   DC-EDITB-CENT
  2111                                   DC-CYMD-CEN
  2112                                   DC-MDCY-CEN.
  2113
  2114     IF JULIAN-TO-BIN
  2115         MOVE WORK-JULIAN-1     TO WORK-JULIAN
  2116         PERFORM 0250-CALCULATE-DAY-OF-WEEK
  2117         MOVE DAY-OF-WEEK-X     TO DC-DAY-OF-WEEK
  2118         GO TO 0200-EXIT.
  2119
  2120     MOVE YEAR1                 TO JULIAN-YEAR1.
  2121
  2122     IF A-LEAP-YEAR
  2123         MOVE LEAP-YR-DAYS (MTHX) TO JULIAN-DAY1
  2124       ELSE
  2125         MOVE REGULAR-DAYS (MTHX) TO JULIAN-DAY1.
  2126
  2127     ADD DAY1 TO JULIAN-DAY1.
  2128
  2129     MOVE JULIAN-YEAR1           TO DC-JULIAN-YEAR
  2130                                    DC-JULIAN-1-YR.
  2131     MOVE JULIAN-DAY1            TO DC-JULIAN-DAYS
  2132                                    DC-JULIAN-DA-1.
  2133     MOVE DC-ALPHA-CEN-N         TO DC-JULIAN-1-CC.
  2134
  2135
  2136     MOVE WORK-JULIAN-1          TO WORK-JULIAN.
  2137     PERFORM 0250-CALCULATE-DAY-OF-WEEK.
  2138     MOVE DAY-OF-WEEK-X          TO DC-DAY-OF-WEEK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL009.cbl
  2139
  2140     IF ELAPSED-BETWEEN-BIN OR
  2141        ELAPSED-BETWEEN-BIN-3
  2142         MOVE YEAR2              TO YR-2
  2143         MOVE MONTH2             TO DC-EDIT2-MONTH
  2144         MOVE DAY2               TO DC-EDIT2-DAY
  2145         MOVE YEAR2-YR           TO DC-EDIT2-YEAR
  2146                                    DC-EDITB-YEAR
  2147         MOVE YEAR2-CEN-CD       TO SEARCH-CENTURY-CD-N
  2148         MOVE 1                  TO FIND-CENTURY-FLAG
  2149         PERFORM 0800-FIND-CENTURY
  2150         IF NO-CONVERSION-ERROR
  2151            MOVE FOUND-CENTURY-N TO DC-EDITB-CENT
  2152         ELSE
  2153            GO TO 0200-EXIT
  2154         END-IF
  2155         PERFORM 0600-ELAPSED-TIME-CALCULATIONS.
  2156
  2157     IF ELAPSED-BETWEEN-BIN   OR
  2158        ELAPSED-BETWEEN-BIN-3 OR
  2159        BIN-PLUS-ELAPSED      OR
  2160        BIN-PLUS-ELAPSED-3
  2161         MOVE WORK-JULIAN-2      TO WORK-JULIAN
  2162         PERFORM 0250-CALCULATE-DAY-OF-WEEK
  2163         MOVE DAY-OF-WEEK-X      TO DC-DAY-OF-WEEK2
  2164       ELSE
  2165         MOVE ZERO               TO DC-DAY-OF-WEEK2.
  2166
  2167 0200-EXIT.
  2168     EXIT.
  2169
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL009.cbl
  2171 0250-CALCULATE-DAY-OF-WEEK SECTION.
  2172
  2173     COMPUTE WS-DAY-OF-CENTURY =
  2174             (JULIAN-YEAR * +365.25) + JULIAN-DAY.
  2175
  2176     DIVIDE WS-DAY-OF-CENTURY BY +7 GIVING DIVIDE-RESULT
  2177             REMAINDER DAY-OF-WEEK-X.
  2178
  2179     MOVE JULIAN-YEAR        TO  CHECK-YEAR.
  2180
  2181     PERFORM 0900-CHECK-FOR-LEAP-YEAR.
  2182
  2183     IF NOT A-LEAP-YEAR
  2184         ADD +1  TO  DAY-OF-WEEK-X
  2185       ELSE
  2186         IF DAY-OF-WEEK-X NOT > ZERO
  2187             MOVE +7  TO  DAY-OF-WEEK-X.
  2188
  2189 0250-EXIT.
  2190     EXIT.
  2191
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL009.cbl
  2193 0300-REFORMAT-BINARY-DAYS SECTION.
  2194
  2195     MOVE '00/00/00'             TO  DC-GREG-DATE-1-EDIT
  2196                                     DC-GREG-DATE-2-EDIT.
  2197     MOVE '00/00/0000'           TO  DC-GREG-DATE-A-EDIT
  2198                                     DC-GREG-DATE-B-EDIT.
  2199
  2200     MOVE ZERO                   TO  DC-GREG-DATE-1-YMD
  2201                                     DC-GREG-DATE-1-MDY
  2202                                     DC-GREG-DATE-CYMD
  2203                                     DC-GREG-DATE-MDCY
  2204                                     DC-JULIAN-YYDDD
  2205                                     DC-ELAPSED-MONTHS
  2206                                     DC-ODD-DAYS-OVER
  2207                                     DC-ELAPSED-DAYS
  2208                                     DC-DAY-OF-WEEK
  2209                                     DC-DAY-OF-WEEK2.
  2210
  2211     IF (ELAPSED-BETWEEN-BIN AND
  2212         WS-BINARY-DATE-1 > WS-BINARY-DATE-2)
  2213                    OR
  2214        (ELAPSED-BETWEEN-BIN-3 AND
  2215         WS-BINARY-DATE-1 > WS-BINARY-DATE-2)
  2216           MOVE '4'               TO DC-ERROR-CODE
  2217           GO TO 0300-EXIT.
  2218
  2219     IF WS-BINARY-DATE-1 = ZERO
  2220         MOVE '1'                TO DC-ERROR-CODE
  2221         MOVE ZERO               TO DC-GREG-DATE-1-EDIT
  2222         GO TO 0300-EXIT.
  2223
  2224     DIVIDE WS-BINARY-DATE-1 BY +384 GIVING YEAR1
  2225               REMAINDER DAYS-REMAINING.
  2226
  2227     DIVIDE DAYS-REMAINING BY +32 GIVING MONTH1
  2228               REMAINDER DAY1.
  2229
  2230***  Y2K, PROJ 7744
  2231     IF DAY1 = ZEROS
  2232         MOVE '3'                TO DC-ERROR-CODE
  2233         GO TO 0300-EXIT
  2234     END-IF
  2235***  Y2K, PROJ 7744
  2236
  2237     ADD +1 TO MONTH1.
  2238
  2239     MOVE YEAR1              TO CHECK-YEAR.
  2240     PERFORM 0900-CHECK-FOR-LEAP-YEAR.
  2241
  2242     IF ELAPSED-BETWEEN-BIN OR
  2243        ELAPSED-BETWEEN-BIN-3
  2244        CONTINUE
  2245     ELSE
  2246        GO TO 0300-EXIT.
  2247
  2248     IF WS-BINARY-DATE-2 = ZERO
  2249         MOVE '1'               TO DC-ERROR-CODE
  2250         GO TO 0300-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL009.cbl
  2251
  2252     DIVIDE WS-BINARY-DATE-2 BY +384 GIVING YEAR2
  2253                                 REMAINDER DAYS-REMAINING.
  2254
  2255     DIVIDE DAYS-REMAINING BY +32 GIVING MONTH2
  2256                                 REMAINDER DAY2.
  2257
  2258     ADD +1 TO MONTH2.
  2259
  2260 0300-EXIT.
  2261     EXIT.
  2262
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL009.cbl
  2264 0400-REFORMAT-GREGORIAN-DATE SECTION.
  2265
  2266     MOVE LOW-VALUES             TO  DC-BIN-DATE-1
  2267                                     DC-BIN-DATE-2.
  2268
  2269     EVALUATE TRUE
  2270        WHEN EDIT-GREG-TO-BIN OR
  2271             EDIT-GREG-TO-BIN-3
  2272           IF (DC-EDIT1-MONTH NOT NUMERIC) OR
  2273              (DC-EDIT1-DAY   NOT NUMERIC) OR
  2274              (DC-EDIT1-YEAR  NOT NUMERIC)
  2275             MOVE '2'            TO DC-ERROR-CODE
  2276             GO TO 0400-EXIT
  2277           END-IF
  2278           MOVE DC-EDIT1-MONTH   TO MONTH1
  2279           MOVE DC-EDIT1-DAY     TO DAY1
  2280           MOVE DC-EDIT1-YEAR    TO YEAR1
  2281        WHEN YMD-GREG-TO-BIN OR
  2282             YMD-GREG-TO-BIN-3
  2283           IF DC-GREG-DATE-1-YMD NOT NUMERIC
  2284              MOVE '2'           TO DC-ERROR-CODE
  2285              GO TO 0400-EXIT
  2286           END-IF
  2287           MOVE DC-YMD-YEAR      TO YEAR1
  2288           MOVE DC-YMD-MONTH     TO MONTH1
  2289           MOVE DC-YMD-DAY       TO DAY1
  2290           MOVE 0                TO DC-ALPHA-CEN-N
  2291        WHEN MDY-GREG-TO-BIN OR
  2292             MDY-GREG-TO-BIN-3
  2293           IF DC-GREG-DATE-1-MDY NOT NUMERIC
  2294              MOVE '2'           TO DC-ERROR-CODE
  2295              GO TO 0400-EXIT
  2296           END-IF
  2297           MOVE DC-MDY-MONTH     TO MONTH1
  2298           MOVE DC-MDY-DAY       TO DAY1
  2299           MOVE DC-MDY-YEAR      TO YEAR1
  2300           MOVE 0                TO DC-ALPHA-CEN-N
  2301        WHEN MDCY-GREG-TO-BIN OR
  2302             MDCY-GREG-TO-BIN-3
  2303           IF DC-GREG-DATE-MDCY NOT NUMERIC
  2304              MOVE '2'           TO DC-ERROR-CODE
  2305              GO TO 0400-EXIT
  2306           END-IF
  2307           MOVE DC-MDCY-MONTH    TO MONTH1
  2308           MOVE DC-MDCY-DAY      TO DAY1
  2309           MOVE DC-MDCY-YEAR     TO YEAR1
  2310           MOVE DC-MDCY-CEN      TO DC-ALPHA-CEN-N
  2311        WHEN CYMD-GREG-TO-BIN OR
  2312             CYMD-GREG-TO-BIN-3
  2313           IF DC-GREG-DATE-CYMD NOT NUMERIC
  2314              MOVE '2'           TO DC-ERROR-CODE
  2315              GO TO 0400-EXIT
  2316           END-IF
  2317           MOVE DC-CYMD-CEN      TO DC-ALPHA-CEN-N
  2318           MOVE DC-CYMD-YEAR     TO YEAR1
  2319           MOVE DC-CYMD-MONTH    TO MONTH1
  2320           MOVE DC-CYMD-DAY      TO DAY1
  2321     END-EVALUATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL009.cbl
  2322
  2323     EVALUATE TRUE
  2324        WHEN MONTH1 NOT NUMERIC OR
  2325             DAY1   NOT NUMERIC OR
  2326             YEAR1  NOT NUMERIC
  2327              MOVE '3'           TO DC-ERROR-CODE
  2328              GO TO 0400-EXIT
  2329        WHEN MONTH1 = ZERO  AND
  2330             DAY1   = ZERO  AND
  2331             YEAR1  = ZERO
  2332              MOVE '1'           TO DC-ERROR-CODE
  2333              GO TO 0400-EXIT
  2334        WHEN MONTH1 < 1 OR > 12
  2335              MOVE '3'           TO DC-ERROR-CODE
  2336              GO TO 0400-EXIT
  2337        WHEN DAY1 < 1 OR > 31
  2338              MOVE '3'           TO DC-ERROR-CODE
  2339              GO TO 0400-EXIT
  2340     END-EVALUATE
  2341
  2342     EVALUATE TRUE
  2343        WHEN ADJUST-DOWN-100-YRS
  2344           IF CURRENT-CENTURY-1-N = 19
  2345              CONTINUE
  2346           ELSE
  2347              MOVE '2'              TO FIND-CENTURY-FLAG
  2348              MOVE PREVIOUS-CENTURY TO SEARCH-CENTURY-N
  2349              PERFORM 0800-FIND-CENTURY
  2350              IF NO-CONVERSION-ERROR
  2351                 COMPUTE YEAR1 = YEAR1 +
  2352                                    (FOUND-CENTURY-CD-N * 100)
  2353              ELSE
  2354                 GO TO 0400-EXIT
  2355              END-IF
  2356           END-IF
  2357        WHEN ADJUST-UP-100-YRS
  2358           MOVE '2'              TO FIND-CENTURY-FLAG
  2359           MOVE NEXT-CENTURY TO SEARCH-CENTURY-N
  2360           PERFORM 0800-FIND-CENTURY
  2361           IF NO-CONVERSION-ERROR
  2362              COMPUTE YEAR1 = YEAR1 +
  2363                                 (FOUND-CENTURY-CD-N * 100)
  2364           ELSE
  2365              GO TO 0400-EXIT
  2366           END-IF
  2367        WHEN DC-ALPHA-CEN-N > 0
  2368           MOVE '2'              TO FIND-CENTURY-FLAG
  2369           MOVE DC-ALPHA-CEN-N   TO SEARCH-CENTURY-N
  2370           PERFORM 0800-FIND-CENTURY
  2371           IF NO-CONVERSION-ERROR
  2372              COMPUTE YEAR1 = YEAR1 + (FOUND-CENTURY-CD-N * 100)
  2373           ELSE
  2374              GO TO 0400-EXIT
  2375           END-IF
  2376        WHEN YEAR1 < W-FLOAT-YEAR
  2377           COMPUTE YEAR1 = YEAR1 + CENTURY-MARK
  2378     END-EVALUATE.
  2379
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL009.cbl
  2380     MOVE YEAR1                  TO CHECK-YEAR.
  2381     PERFORM 0900-CHECK-FOR-LEAP-YEAR THRU 0900-EXIT.
  2382
  2383     IF DAY1 > DAYS-IN-MONTH (MONTH1)
  2384         MOVE '3'                TO DC-ERROR-CODE
  2385         GO TO 0400-EXIT.
  2386
  2387 0400-EXIT.
  2388     EXIT.
  2389
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL009.cbl
  2391 0500-REFORMAT-JULIAN-DATE SECTION.
  2392
  2393     MOVE '00/00/00'             TO  DC-GREG-DATE-1-EDIT
  2394                                     DC-GREG-DATE-2-EDIT.
  2395
  2396*    MOVE GREG-ALPHA-MASK        TO  DC-GREG-DATE-1-ALPHA.
  2397
  2398     MOVE ZERO                   TO  DC-GREG-DATE-1-YMD
  2399                                     DC-GREG-DATE-1-MDY
  2400                                     DC-GREG-DATE-CYMD
  2401                                     DC-GREG-DATE-MDCY
  2402                                     DC-ELAPSED-MONTHS
  2403                                     DC-ODD-DAYS-OVER
  2404                                     DC-ALPHA-CEN-N
  2405                                     DC-ELAPSED-DAYS.
  2406
  2407     MOVE LOW-VALUES             TO  DC-BIN-DATE-1
  2408                                     DC-BIN-DATE-2.
  2409
  2410     IF DC-JULIAN-YYDDD = ZERO
  2411         MOVE '1'             TO DC-ERROR-CODE
  2412         GO TO 0500-EXIT.
  2413
  2414     IF DC-JULIAN-DAYS = ZERO
  2415         MOVE '3'             TO DC-ERROR-CODE
  2416         GO TO 0500-EXIT.
  2417
  2418     IF JULIAN-EXPANDED-TO-BIN OR
  2419        JULIAN-EXPANDED-TO-BIN-3
  2420          MOVE DC-JULIAN-1-CC   TO DC-ALPHA-CEN-N.
  2421
  2422     EVALUATE TRUE
  2423        WHEN ADJUST-DOWN-100-YRS
  2424           IF CURRENT-CENTURY-1-N = 19
  2425              CONTINUE
  2426           ELSE
  2427              MOVE '2'              TO FIND-CENTURY-FLAG
  2428              MOVE PREVIOUS-CENTURY TO SEARCH-CENTURY-N
  2429              PERFORM 0800-FIND-CENTURY
  2430              IF NO-CONVERSION-ERROR
  2431                 COMPUTE JULIAN-YEAR1 = JULIAN-YEAR1 +
  2432                                    (FOUND-CENTURY-CD-N * 100)
  2433              ELSE
  2434                 GO TO 0500-EXIT
  2435              END-IF
  2436           END-IF
  2437        WHEN ADJUST-UP-100-YRS
  2438           MOVE '2'              TO FIND-CENTURY-FLAG
  2439           MOVE NEXT-CENTURY     TO SEARCH-CENTURY-N
  2440           PERFORM 0800-FIND-CENTURY
  2441           IF NO-CONVERSION-ERROR
  2442              COMPUTE JULIAN-YEAR1 = JULIAN-YEAR1 +
  2443                                 (FOUND-CENTURY-CD-N * 100)
  2444           ELSE
  2445              GO TO 0500-EXIT
  2446           END-IF
  2447        WHEN DC-ALPHA-CEN-N > 0
  2448           MOVE DC-ALPHA-CEN-N        TO SEARCH-CENTURY-N
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL009.cbl
  2449           MOVE 2                     TO FIND-CENTURY-FLAG
  2450           PERFORM 0800-FIND-CENTURY
  2451           IF NO-CONVERSION-ERROR
  2452              COMPUTE JULIAN-YEAR1 =
  2453                      JULIAN-YEAR1 + (FOUND-CENTURY-CD-N * 100)
  2454           ELSE
  2455              GO TO 0500-EXIT
  2456           END-IF
  2457         WHEN JULIAN-YEAR1 NOT > W-FLOAT-YEAR
  2458                 COMPUTE JULIAN-YEAR1 =
  2459                            JULIAN-YEAR1 + 100
  2460     END-EVALUATE.
  2461
  2462     MOVE JULIAN-YEAR1           TO YEAR1
  2463                                    CHECK-YEAR.
  2464
  2465     PERFORM 0900-CHECK-FOR-LEAP-YEAR THRU 0900-EXIT.
  2466
  2467     IF (A-LEAP-YEAR AND JULIAN-DAY1 > LEAP-YR-DAYS (13))
  2468                       OR
  2469        (NOT A-LEAP-YEAR AND DC-JULIAN-DAYS > REGULAR-DAYS (13))
  2470           MOVE '3'              TO DC-ERROR-CODE
  2471           GO TO 0500-EXIT.
  2472
  2473     SET MTHX TO +1.
  2474
  2475     IF A-LEAP-YEAR
  2476         PERFORM 0550-JULIAN-LEAP-YEAR
  2477     ELSE
  2478         PERFORM 0575-JULIAN-REGULAR-YEAR
  2479     END-IF
  2480     .
  2481 0500-EXIT.
  2482     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL009.cbl
  2483/
  2484
  2485 0550-JULIAN-LEAP-YEAR SECTION.
  2486
  2487     IF JULIAN-DAY1 NOT > LEAP-YR-DAYS (MTHX)
  2488         SET MTHX DOWN BY +1
  2489         SET MONTH1 TO MTHX
  2490         SUBTRACT LEAP-YR-DAYS (MTHX) FROM JULIAN-DAY1
  2491                                      GIVING DAY1
  2492         MOVE JULIAN-YEAR1       TO  YEAR1
  2493       ELSE
  2494         SET MTHX UP BY +1
  2495         GO TO 0550-JULIAN-LEAP-YEAR.
  2496
  2497 0550-EXIT.
  2498     EXIT.
  2499
  2500
  2501 0575-JULIAN-REGULAR-YEAR SECTION.
  2502
  2503     IF JULIAN-DAY1 NOT > REGULAR-DAYS (MTHX)
  2504         SET MTHX DOWN BY +1
  2505         SET MONTH1 TO MTHX
  2506         SUBTRACT REGULAR-DAYS (MTHX) FROM JULIAN-DAY1
  2507                                      GIVING DAY1
  2508         MOVE JULIAN-YEAR1       TO  YEAR1
  2509       ELSE
  2510         SET MTHX UP BY +1
  2511         GO TO 0575-JULIAN-REGULAR-YEAR.
  2512
  2513 0575-EXIT.
  2514     EXIT.
  2515
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL009.cbl
  2517 0600-ELAPSED-TIME-CALCULATIONS SECTION.
  2518
  2519     MOVE YEAR2                 TO JULIAN-YEAR2
  2520                                   CHECK-YEAR.
  2521     PERFORM 0900-CHECK-FOR-LEAP-YEAR.
  2522
  2523     SET MTHX TO MONTH2.
  2524
  2525     IF A-LEAP-YEAR
  2526         MOVE LEAP-YR-DAYS (MTHX) TO JULIAN-DAY2
  2527       ELSE
  2528         MOVE REGULAR-DAYS (MTHX) TO JULIAN-DAY2.
  2529
  2530     ADD DAY2 TO JULIAN-DAY2.
  2531
  2532     MOVE ZERO                   TO WS-ELAPSED-DAYS.
  2533     MOVE YEAR1                  TO CHECK-YEAR.
  2534
  2535 0600-LOOP.
  2536     IF CHECK-YEAR = JULIAN-YEAR2
  2537         GO TO 0600-COMPUTE.
  2538
  2539     PERFORM 0900-CHECK-FOR-LEAP-YEAR.
  2540
  2541     IF A-LEAP-YEAR
  2542         ADD +366 TO WS-ELAPSED-DAYS
  2543       ELSE
  2544         ADD +365 TO WS-ELAPSED-DAYS.
  2545
  2546     ADD +1  TO  CHECK-YEAR.
  2547
  2548     GO TO 0600-LOOP.
  2549
  2550 0600-COMPUTE.
  2551     ADD JULIAN-DAY2        TO WS-ELAPSED-DAYS.
  2552
  2553     SUBTRACT JULIAN-DAY1 FROM WS-ELAPSED-DAYS.
  2554
  2555     COMPUTE WS-ELAPSED-MONTHS =
  2556         ((YEAR2 - YEAR1) * 12) + (MONTH2 - MONTH1)
  2557
  2558     IF DAY2 = DAY1
  2559         MOVE ZERO               TO  DC-ODD-DAYS-OVER
  2560       ELSE
  2561     IF DAY1 NOT < DAYS-IN-MONTH (MONTH1)
  2562         MOVE DAY2               TO  DC-ODD-DAYS-OVER
  2563         SUBTRACT +1 FROM WS-ELAPSED-MONTHS
  2564       ELSE
  2565     IF DAY2 > DAY1
  2566         SUBTRACT DAY1 FROM DAY2 GIVING DC-ODD-DAYS-OVER
  2567       ELSE
  2568         COMPUTE DC-ODD-DAYS-OVER =
  2569              (DAYS-IN-MONTH (MONTH1) - DAY1) + DAY2
  2570         SUBTRACT +1 FROM WS-ELAPSED-MONTHS.
  2571
  2572     MOVE YEAR2                  TO CHECK-YEAR.
  2573     PERFORM 0900-CHECK-FOR-LEAP-YEAR.
  2574
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL009.cbl
  2575     IF DC-ODD-DAYS-OVER NOT < DAYS-IN-MONTH (MONTH2) AND
  2576        DAY2 = DAYS-IN-MONTH (MONTH2)
  2577         MOVE ZERO               TO  DC-ODD-DAYS-OVER
  2578         ADD +1 TO WS-ELAPSED-MONTHS.
  2579
  2580 0600-MOVE.
  2581     MOVE WS-ELAPSED-MONTHS      TO  DC-ELAPSED-MONTHS.
  2582     MOVE WS-ELAPSED-DAYS        TO  DC-ELAPSED-DAYS.
  2583
  2584 0600-EXIT.
  2585     EXIT.
  2586
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL009.cbl
  2588 0700-CALCULATE-END-DATE SECTION.
  2589
  2590     IF NOT CALCULATE-END-OF-MONTH
  2591         GO TO 0700-CONTINUE.
  2592
  2593     IF WS-ELAPSED-MONTHS = ZERO  OR
  2594        WS-ELAPSED-DAYS NOT = ZERO
  2595         MOVE '2'                TO  DC-END-OF-MONTH
  2596         GO TO 0700-CONTINUE.
  2597
  2598     DIVIDE WS-BINARY-DATE-1 BY +384 GIVING YEAR1
  2599             REMAINDER DAYS-REMAINING.
  2600
  2601     DIVIDE DAYS-REMAINING BY +32 GIVING MONTH1
  2602             REMAINDER DAY1.
  2603
  2604     ADD +1  TO  MONTH1.
  2605
  2606     SET MTHX TO MONTH1.
  2607
  2608     MOVE YEAR1                 TO CHECK-YEAR.
  2609     PERFORM 0900-CHECK-FOR-LEAP-YEAR.
  2610
  2611     IF DAY1 < DAYS-IN-MONTH (MTHX)
  2612         MOVE '3'            TO  DC-END-OF-MONTH.
  2613
  2614 0700-CONTINUE.
  2615     COMPUTE WS-BINARY-DATE-2 = WS-BINARY-DATE-1 +
  2616             (WS-ELAPSED-MONTHS * 32).
  2617
  2618     IF WS-BINARY-DATE-2 NOT > ZERO
  2619         MOVE '5'                TO  DC-ERROR-CODE
  2620         GO TO 0700-EXIT.
  2621
  2622     DIVIDE WS-BINARY-DATE-2 BY +384 GIVING YEAR2
  2623             REMAINDER DAYS-REMAINING.
  2624
  2625     DIVIDE DAYS-REMAINING BY +32 GIVING MONTH2
  2626             REMAINDER DAY2.
  2627
  2628     ADD +1 TO MONTH2.
  2629
  2630     SET MTHX TO MONTH2.
  2631
  2632     MOVE YEAR2 TO YEAR1
  2633                   CHECK-YEAR
  2634                   JULIAN-YEAR2.
  2635
  2636     PERFORM 0900-CHECK-FOR-LEAP-YEAR.
  2637
  2638     IF A-LEAP-YEAR
  2639         MOVE LEAP-YR-DAYS (MTHX) TO JULIAN-DAY2
  2640       ELSE
  2641         MOVE REGULAR-DAYS (MTHX) TO JULIAN-DAY2.
  2642
  2643     IF DAY2 NOT < DAYS-IN-MONTH (MTHX)
  2644         MOVE DAYS-IN-MONTH (MTHX) TO DAY2.
  2645
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL009.cbl
  2646     ADD DAY2 TO JULIAN-DAY2.
  2647
  2648 0700-ADD-DAYS.
  2649     IF WS-ELAPSED-DAYS = ZERO
  2650         GO TO 0700-CONVERT-NEW-DATE.
  2651
  2652     MOVE WS-ELAPSED-DAYS TO DAYS-ELAPSED.
  2653
  2654     IF WS-ELAPSED-DAYS < ZERO
  2655         MULTIPLY -1  BY  WS-ELAPSED-DAYS
  2656         GO TO 0700-SUBTRACT-DAYS.
  2657
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL009.cbl
  2659 0700-ADD-DAYS-LOOP.
  2660     IF A-LEAP-YEAR
  2661         MOVE 366 TO DAYS-NEEDED
  2662       ELSE
  2663         MOVE 365 TO DAYS-NEEDED.
  2664
  2665     SUBTRACT JULIAN-DAY2 FROM DAYS-NEEDED.
  2666
  2667     IF DAYS-ELAPSED NOT > DAYS-NEEDED
  2668         GO TO 0700-ADD-REMAINING-DAYS.
  2669
  2670     IF DAYS-ELAPSED > ZERO
  2671         SUBTRACT +1  FROM DAYS-ELAPSED.
  2672
  2673     SUBTRACT DAYS-NEEDED FROM DAYS-ELAPSED.
  2674
  2675     ADD +1 TO JULIAN-YEAR2.
  2676
  2677     MOVE +1                     TO JULIAN-DAY2.
  2678
  2679     MOVE JULIAN-YEAR2           TO CHECK-YEAR.
  2680
  2681     PERFORM 0900-CHECK-FOR-LEAP-YEAR.
  2682
  2683     GO TO 0700-ADD-DAYS-LOOP.
  2684
  2685 0700-ADD-REMAINING-DAYS.
  2686     ADD DAYS-ELAPSED TO JULIAN-DAY2.
  2687
  2688     GO TO 0700-CALCULATE-JULIAN-DATE.
  2689
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL009.cbl
  2691 0700-SUBTRACT-DAYS.
  2692     IF WS-ELAPSED-DAYS < JULIAN-DAY2
  2693         SUBTRACT WS-ELAPSED-DAYS FROM JULIAN-DAY2
  2694         GO TO 0700-CALCULATE-JULIAN-DATE.
  2695
  2696     SUBTRACT JULIAN-DAY2 FROM WS-ELAPSED-DAYS.
  2697
  2698     SUBTRACT +1  FROM JULIAN-YEAR2.
  2699
  2700     MOVE JULIAN-YEAR2           TO  CHECK-YEAR.
  2701     PERFORM 0900-CHECK-FOR-LEAP-YEAR.
  2702
  2703     IF A-LEAP-YEAR
  2704         MOVE +366               TO  JULIAN-DAY2
  2705       ELSE
  2706         MOVE +365               TO  JULIAN-DAY2.
  2707
  2708     GO TO 0700-SUBTRACT-DAYS.
  2709
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL009.cbl
  2711 0700-CALCULATE-JULIAN-DATE.
  2712     MOVE WORK-JULIAN-2          TO  WORK-JULIAN-1.
  2713     SET MTHX TO +1.
  2714
  2715     IF A-LEAP-YEAR
  2716         PERFORM 0550-JULIAN-LEAP-YEAR
  2717       ELSE
  2718         PERFORM 0575-JULIAN-REGULAR-YEAR.
  2719
  2720     MOVE WORK-DATE-1 TO WORK-DATE-2.
  2721
  2722 0700-CONVERT-NEW-DATE.
  2723     IF CALCULATE-END-OF-MONTH
  2724         SET MTHX TO MONTH2
  2725         IF DAY2 < DAYS-IN-MONTH (MTHX)
  2726             MOVE DAYS-IN-MONTH (MTHX) TO  DAY2.
  2727
  2728     MOVE WORK-DATE-2 TO WORK-DATE-1.
  2729
  2730 0700-EXIT.
  2731     EXIT.
  2732
  2733*0800-FIND-CENTURY.
  2734 0800-FIND-CENTURY section.
  2735
  2736     SET CNTRY-NDX TO +1.
  2737     EVALUATE FIND-CENTURY-FLAG
  2738        WHEN 1
  2739           SEARCH  CENTURY-TBL
  2740             AT END
  2741               MOVE 'A' TO DC-ERROR-CODE
  2742           WHEN CENTURY-CODE(CNTRY-NDX) = SEARCH-CENTURY-CD-N
  2743              MOVE CENTURY(CNTRY-NDX) TO FOUND-CENTURY-N
  2744           END-SEARCH
  2745        WHEN 2
  2746           SEARCH  CENTURY-TBL
  2747              AT END
  2748                 MOVE 'A' TO DC-ERROR-CODE
  2749           WHEN CENTURY(CNTRY-NDX) = SEARCH-CENTURY-N
  2750              MOVE CENTURY-CODE(CNTRY-NDX) TO FOUND-CENTURY-CD-N
  2751           END-SEARCH
  2752        WHEN 3
  2753***  Y2K
  2754*          IF YEAR1 <= CENTURY-MARK
  2755           EVALUATE YEAR1 < CENTURY-MARK
  2756                    ALSO W-FLOAT-YEAR-YY > 34
  2757                WHEN TRUE ALSO TRUE
  2758                    MOVE PREVIOUS-CENTURY TO
  2759                                   DC-ALPHA-CEN-N
  2760                WHEN TRUE ALSO FALSE
  2761                 IF W-FLOAT-YEAR-YY < 30
  2762                    MOVE CURRENT-CENTURY-1-N TO
  2763                                   DC-ALPHA-CEN-N
  2764                 ELSE
  2765                    MOVE NEXT-CENTURY TO DC-ALPHA-CEN-N
  2766                 END-IF
  2767                WHEN FALSE ALSO FALSE
  2768                 IF YEAR1 > BREAK-PERIOD
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL009.cbl
  2769                    MOVE NEXT-CENTURY TO DC-ALPHA-CEN-N
  2770                 ELSE
  2771                    MOVE PREVIOUS-CENTURY TO DC-ALPHA-CEN-N
  2772                 END-IF
  2773                WHEN  OTHER
  2774                 IF YEAR1 > BREAK-PERIOD
  2775                    MOVE PREVIOUS-CENTURY TO DC-ALPHA-CEN-N
  2776                 ELSE
  2777                    MOVE CURRENT-CENTURY-1-N
  2778                                         TO DC-ALPHA-CEN-N
  2779                 END-IF
  2780           END-EVALUATE
  2781     END-EVALUATE.
  2782***  Y2K
  2783
  2784 0800-EXIT.
  2785     EXIT.
  2786
  2787 0900-CHECK-FOR-LEAP-YEAR SECTION.
  2788
  2789     MOVE CHECK-YEAR TO CHECK-CCYY.
  2790
  2791***  Y2K, PROJ 7744
  2792     IF CHECK-CCYY-YY > 00
  2793         COMPUTE DIVIDE-LEAP-YEAR = CHECK-CCYY / 4
  2794     ELSE
  2795         MOVE CHECK-CCYY-CC      TO SEARCH-CENTURY-CD-N
  2796         MOVE 1                  TO FIND-CENTURY-FLAG
  2797         PERFORM 0800-FIND-CENTURY
  2798         IF NO-CONVERSION-ERROR
  2799             MOVE FOUND-CENTURY-N TO CHECK-CCYY-CC
  2800             COMPUTE DIVIDE-LEAP-YEAR = CHECK-CCYY / 400
  2801         END-IF
  2802     END-IF
  2803***  Y2K, PROJ 7744
  2804
  2805     IF A-LEAP-YEAR
  2806         MOVE +29                TO  DAYS-IN-MONTH (2)
  2807     ELSE
  2808         MOVE +28                TO  DAYS-IN-MONTH (2).
  2809
  2810 0900-EXIT.
  2811     EXIT.
  2812
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL009.cbl
  2814 8900-MAPFAIL SECTION.
  2815     MOVE MAPFAIL-MSG            TO TEXT-AREA.
  2816     GO TO 8990-SEND-TEXT.
  2817
  2818 8950-CLEAR-RETURN.
  2819     MOVE TRAN-COMPLETE-MSG      TO TEXT-AREA.
  2820
  2821 8990-SEND-TEXT.
  2822
  2823* EXEC CICS SEND TEXT
  2824*        FROM    (TEXT-AREA)
  2825*        LENGTH  (TEXT-LENGTH)
  2826*        ERASE
  2827*        FREEKB
  2828*        END-EXEC.
  2829*    MOVE '8&      T  E F  H   F -   #00002670' TO DFHEIV0
  2830     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2831     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2832     MOVE X'2020233030303032363730' TO DFHEIV0(25:11)
  2833     CALL 'kxdfhei1' USING DFHEIV0,
  2834           TEXT-AREA,
  2835           TEXT-LENGTH,
  2836           DFHEIV99,
  2837           DFHEIV99,
  2838           DFHEIV99,
  2839           DFHEIV99,
  2840           DFHEIV99,
  2841           DFHEIV99,
  2842           DFHEIV99,
  2843           DFHEIV99,
  2844           DFHEIV99,
  2845           DFHEIV99
  2846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2847
  2848
  2849 9000-RETURN-TO-CICS.
  2850
  2851* EXEC CICS RETURN
  2852*        END-EXEC.
  2853*    MOVE '.(                    &   #00002678' TO DFHEIV0
  2854     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2855     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2856     MOVE X'2020233030303032363738' TO DFHEIV0(25:11)
  2857     CALL 'kxdfhei1' USING DFHEIV0,
  2858           DFHEIV99,
  2859           DFHEIV99,
  2860           DFHEIV99,
  2861           DFHEIV99,
  2862           DFHEIV99
  2863     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2864
  2865
  2866
  2867* GOBACK.
  2868     MOVE '9%                    "   ' TO DFHEIV0
  2869     MOVE 'EL009' TO DFHEIV1
  2870     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2871     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL009.cbl
  2872
  2873
  2874 9999-DFHBACK SECTION.
  2875     MOVE '9%                    "   ' TO DFHEIV0
  2876     MOVE 'EL009' TO DFHEIV1
  2877     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2878     GOBACK.
  2879 9999-DFHEXIT.
  2880     IF DFHEIGDJ EQUAL 0001
  2881         NEXT SENTENCE
  2882     ELSE IF DFHEIGDJ EQUAL 2
  2883         GO TO 8950-CLEAR-RETURN,
  2884               4010-BIN-TO-GREG,
  2885               4020-COMPUTE-ELAPSED,
  2886               4020-COMPUTE-ELAPSED,
  2887               4030-GREG-TO-BIN,
  2888               4040-JULIAN-TO-OTHER,
  2889               4050-BINARY-PLUS-ELAPSED,
  2890               4060-UNSUPPORTED
  2891         DEPENDING ON DFHEIGDI
  2892     ELSE IF DFHEIGDJ EQUAL 3
  2893         GO TO 8900-MAPFAIL
  2894         DEPENDING ON DFHEIGDI.
  2895     MOVE '9%                    "   ' TO DFHEIV0
  2896     MOVE 'EL009' TO DFHEIV1
  2897     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2898     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        2956     Code:       10022
