* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL687.cbl
* Options: int("EL687.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL687.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL687.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL687.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL687 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 09/20/95 08:42:38.
     7*                            VMOD=2.019
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL687.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.   TRANSACTION - EXG3
    25
    26*        IN ORDER TO START THE PRINTING OF CHECKS, THIS FUNCTION
    27*    IS USED TO QUALIFY THE CONTROL BATCHES TO BE PRINTED AND
    28*    SPECIFY A PRINT TIME.  THE CHECK WRITER PROGRAM (EL688) IS
    29*    STARTED BY THIS PROGRAM.
    30
    31*    SCREENS     - EL687A - CHECK WRITER
    32
    33*    ENTERED BY  - EL671  - REPORT MENU
    34
    35*    EXIT TO     - EL671  - RESULT OF CLEAR
    36
    37*    INPUT FILES - ERCHKQ - CHECK QUEUE
    38*                  ERPYAJ - PENDING PAYMENTS AND ADJUSTMENTS
    39*                  ELCNTL - CONTROL FILE
    40
    41*    OUTPUT FILES - ERPYAJ - PENDING PAYMENTS AND ADJUSTMENTS
    42*                   ERCHEK - CHECK MAINTENANCE
    43*                   ERCHKQ - CHECK QUEUE
    44
    45*    COMMAREA    - PASSED.  PRINT TIME PASSED TO CHECK WRITER AS
    46*                  A 2 BYTE COMP NUMBER IN THE FIRST TWO BYTES OF
    47*                  THE WORK AREA.  FORM TYPE IS PASSED AS
    48*                  ENTRY-CD-1.
    49******************************************************************
    50*                   C H A N G E   L O G
    51*
    52* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    53*-----------------------------------------------------------------
    54*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    55* EFFECTIVE    NUMBER
    56*-----------------------------------------------------------------
    57* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    58******************************************************************
    59
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL687.cbl
    61 ENVIRONMENT DIVISION.
    62
    63 DATA DIVISION.
    64
    65 WORKING-STORAGE SECTION.
    66 01  DFH-START PIC X(04).
    67 77  LCP-WS-ADDR-COMP              PIC S9(8) COMP.
    68 77  LCP-WS-ADDR-PNTR              REDEFINES LCP-WS-ADDR-COMP
    69                                   USAGE POINTER.
    70 77  LCP-ONCTR-01                  PIC S9(8) COMP-3 VALUE ZERO.
    71 01  LCP-CURRENT-DATE-68.
    72     05  LCP-MONTH                 PIC X(2).
    73     05  FILLER                    PIC X VALUE '/'.
    74     05  LCP-DAY1                  PIC X(2).
    75     05  FILLER                    PIC X VALUE '/'.
    76     05  LCP-YEAR                  PIC X(2).
    77 01  LCP-CICS-DATE                 PIC 9(15).
    78
    79 77  FILLER  PIC X(32)  VALUE '********************************'.
    80 77  FILLER  PIC X(32)  VALUE '*    EL687 WORKING STORAGE     *'.
    81 77  FILLER  PIC X(32)  VALUE '************ V/M 2.019 *********'.
    82
    83 01  FILLER                          COMP-3.
    84     05  WS-NOT-FOUND                PIC S9          VALUE ZERO.
    85     05  WS-PRINTER-STARTED-SW       PIC S9          VALUE ZERO.
    86     05  WS-READNEXT-SW              PIC S9          VALUE ZERO.
    87     05  WS-LAST-ERROR-COUNT         PIC S9(3)       VALUE ZERO.
    88     05  WS-COMPLETED-SUCCESSFUL     PIC S9          VALUE ZERO.
    89       88  TRANSACTION-SUCCESSFUL                    VALUE +1 +2.
    90       88  CHECKS-WITHOUT-ADDRESSES                  VALUE +2.
    91
    92     05  WS-TIME-WORK                PIC S9(7)       VALUE ZERO.
    93     05  WS-TIME                     REDEFINES
    94         WS-TIME-WORK                PIC S9(3)V9(4).
    95     05  WS-HHMM                     REDEFINES
    96         WS-TIME-WORK                PIC S9(5)V99.
    97
    98     05  WS-PENDING-PAYMENTS-BROWSE-SW  PIC S9       VALUE ZERO.
    99     05  WS-CHECK-QUEUE-BROWSE-SW    PIC S9          VALUE ZERO.
   100     05  WS-CHECK-MAINT-BROWSE-SW    PIC S9          VALUE ZERO.
   101
   102     05  WS-NOT-RELEASED-COUNT       PIC S9(5)       VALUE ZERO.
   103     05  WS-NOT-RELEASED-AMOUNT      PIC S9(9)V99 VALUE ZERO.
   104     05  WS-RELEASED-COUNT           PIC S9(5)       VALUE ZERO.
   105     05  WS-RELEASED-AMOUNT          PIC S9(9)V99 VALUE ZERO.
   106
   107
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL687.cbl
   109 01  FILLER                          COMP SYNC.
   110     05  WS-TS-LENGTH                PIC S9(4)       VALUE +750.
   111     05  WS-ERCHKQ-LENGTH            PIC S9(4)       VALUE +100.
   112     05  WS-KEY-LENGTH               PIC S9(4)       VALUE ZERO.
   113
   114     05  WS-CHECK-QUE-COUNTER        PIC S9(8)       VALUE ZERO.
   115     05  WS-CHECK-COUNTER            PIC S9(4)       VALUE +10.
   116
   117     05  WS-LAST-CONTROL-GROUP       PIC S9(8)       VALUE ZERO.
   118     05  WS-TIMES-PRINTED            PIC S9(4)       VALUE ZERO.
   119
   120     05  WS-JOURNAL-FILE-ID          PIC S9(4)       VALUE +1.
   121     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)       VALUE +773.
   122
   123     05  WS-SEQUENCE-NUMBER          PIC S9(4)       VALUE ZERO.
   124     05  WS-BEGIN-NUMBER             PIC S9(4)       VALUE ZERO.
   125
   126     05  WS-CQFCBAR                  PIC S9(9)       VALUE ZERO.
   127     05  WS-INDEX                    PIC S9(4)       VALUE ZERO.
   128
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL687.cbl
   130 01  FILLER.
   131
   132     05  WS-CONTROL-FILE-KEY.
   133         10  WS-CFK-COMPANY-ID       PIC X(3)        VALUE SPACES.
   134         10  WS-CFK-RECORD-TYPE      PIC X           VALUE SPACES.
   135         10  FILLER                  PIC XX          VALUE SPACES.
   136         10  WS-CFK-BENEFIT-NO       PIC XX          VALUE SPACES.
   137         10  WS-CFK-SEQUENCE-NO      PIC S9(4)       VALUE ZERO
   138                                     COMP.
   139
   140     05  WS-PENDING-PAYMENTS-KEY.
   141         10  WS-PPK-COMPANY-CD       PIC X.
   142         10  WS-PPK-CARRIER          PIC X.
   143         10  WS-PPK-GROUPING         PIC X(6).
   144         10  WS-PPK-FIN-RESP         PIC X(10).
   145         10  WS-PPK-ACCOUNT          PIC X(10).
   146         10  WS-PPK-FILE-SEQ-NO      PIC S9(8)      COMP.
   147         10  WS-PPK-RECORD-TYPE      PIC X.
   148
   149     05  WS-CHECK-MAINT-KEY.
   150         10  WS-CMK-COMPANY-CD       PIC X.
   151         10  WS-CMK-CARRIER          PIC X.
   152         10  WS-CMK-GROUPING         PIC X(6).
   153         10  WS-CMK-STATE            PIC X(2).
   154         10  WS-CMK-ACCOUNT          PIC X(10).
   155         10  WS-CMK-CERT-EFF-DT      PIC X(2).
   156         10  WS-CMK-CERT-NO          PIC X(11).
   157         10  WS-CMK-SEQ-NO           PIC S9(4)      COMP.
   158
   159     05  WS-CHECK-QUEUE-KEY.
   160         10  WS-CQK-COMPANY-CD       PIC X.
   161         10  WS-CQK-CONTROL-NUMBER   PIC S9(8)
   162                                     COMP.
   163         10  WS-CQK-SEQUENCE-NUMBER  PIC S9(4)
   164                                     COMP.
   165
   166     05  WS-LAST-CHECK-QUEUE-KEY     PIC X(7) VALUE LOW-VALUE.
   167
   168     05  WS-COMPENSATION-MASTER-KEY.
   169         10  WS-CM-COMPANY-CD        PIC X.
   170         10  WS-CM-CARRIER           PIC X.
   171         10  WS-CM-GROUPING          PIC X(6).
   172         10  WS-CM-FIN-RESP          PIC X(10).
   173         10  WS-CM-ACCOUNT           PIC X(10).
   174         10  WS-CM-TYPE              PIC X.
   175
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL687.cbl
   177     05  WS-MAPSET-NAME              PIC X(8)      VALUE 'EL687S'.
   178     05  WS-MAP-NAME                 PIC X(8)      VALUE 'EL687A'.
   179
   180     05  FILLER                      REDEFINES
   181         WS-MAP-NAME.
   182         20  FILLER                  PIC XX.
   183         20  WS-MAP-NUMBER           PIC X(6).
   184
   185     05  WS-PROGRAM-ID               PIC X(8)      VALUE 'EL687'.
   186     05  WS-CHECK-QUEUE-DSID         PIC X(8)      VALUE 'ERCHKQ'.
   187     05  WS-ENQ-COMPANY-ID           PIC X(3)      VALUE  ZERO.
   188     05  WS-PENDING-PAYMENTS-DSID    PIC X(8)      VALUE 'ERPYAJ'.
   189     05  WS-CONTROL-FILE-DSID        PIC X(8)      VALUE 'ELCNTL'.
   190     05  WS-COMPENSATION-MASTER-DSID PIC X(8)      VALUE 'ERCOMP'.
   191     05  WS-CHECK-MAINT-DSID         PIC X(8)      VALUE 'ERCHEK'.
   192     05  WS-JOURNAL-TYPE-ID          PIC XX        VALUE 'ER'.
   193
   194     05  WS-LOW-VALUES               PIC X VALUE LOW-VALUES.
   195     05  WS-SPACES                   PIC X           VALUE SPACES.
   196
   197     05  WS-CURRENT-DATE             PIC XX VALUE LOW-VALUES.
   198
   199     05  WS-TRANS-ID                 PIC X(4)        VALUE 'EXG3'.
   200     05  WS-CHECK-WRITER-TRANS-ID    PIC X(4)        VALUE 'EXG4'.
   201
   202     05  WS-BENEFIT-NO               PIC XX          VALUE SPACES.
   203     05  WS-KIND.
   204         10  WS-RETRO-DAYS           PIC 99.
   205         10  WS-RETRO-ELIM           PIC X.
   206     05  WS-TEXT-MESSAGE-LENGTH      PIC S9(4)       VALUE +70
   207                                     COMP SYNC.
   208     05  WS-TEXT-MESSAGE             PIC X(70)       VALUE SPACES.
   209     05  WS-TEMP-STORAGE-ITEM        PIC S9(4)       VALUE ZERO
   210                                     COMP SYNC.
   211     05  WS-TEMP-STORAGE-KEY.
   212         10  WS-TSK-TERM-ID          PIC X(4)        VALUE SPACES.
   213         10  WS-TSK-TIME             PIC S9(7)       VALUE ZERO
   214                                     COMP-3.
   215     05  WS-MINUTES                  PIC S99         VALUE ZERO.
   216     05  WS-GREATEST-CHECK-NUMBER    PIC 9(7)        VALUE ZERO.
   217     05  WS-GREATEST-CHECK-NUMBER-X  REDEFINES
   218         WS-GREATEST-CHECK-NUMBER    PIC X(7).
   219     05  WS-CHECK-NUMBER             PIC 9(7)        VALUE ZERO.
   220     05  WS-CHECK-NUMBER-X           REDEFINES
   221         WS-CHECK-NUMBER             PIC X(7).
   222     05  WS-CHECK-NO.
   223         10  FILLER                  PIC X           VALUE ZERO.
   224         10  WS-CHECK-WORK           PIC X(6).
   225     05  WS-ACKNO                    PIC 9(7)        VALUE ZERO.
   226     05  WS-ACKNO-X                  REDEFINES
   227         WS-ACKNO                    PIC X(7).
   228     05  WS-PAYMENT-TYPE             PIC X           VALUE ZERO.
   229     05  WS-PAYEE-TYPE-CD            PIC X           VALUE ZERO.
   230
   231     05  WS-INIT-CONTROL-GROUP.
   232         10  FILLER              PIC X               VALUE SPACES.
   233         10  FILLER              PIC X(7) VALUE LOW-VALUES.
   234
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL687.cbl
   235     05  WS-SSN.
   236         10  WS-SSN-STATE            PIC XX.
   237         10  WS-SSN-ACCOUNT          PIC X(6).
   238         10  WS-SSN-LN3              PIC X(3).
   239
   240     05  WS-MEMBER-NUMBER.
   241         10  WS-MEMBER-STATE         PIC XX.
   242         10  WS-MEMBER-ACCOUNT       PIC X(6).
   243         10  WS-MEMBER-LN4           PIC X(4).
   244
   245     05  WS-OLD-CHECK-QUEUE-RECORD   PIC X(100)      VALUE SPACES.
   246     05  WS-NEW-CHECK-QUEUE-RECORD   PIC X(100)      VALUE SPACES.
   247
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL687.cbl
   249     05  WS-ERROR-NUMBERS.
   250         10  ER-0002                 PIC 9(4)        VALUE 0002.
   251         10  ER-0004                 PIC 9(4)        VALUE 0004.
   252         10  ER-0008                 PIC 9(4)        VALUE 0008.
   253         10  ER-0029                 PIC 9(4)        VALUE 0029.
   254         10  ER-0330                 PIC 9(4)        VALUE 0330.
   255         10  ER-0361                 PIC 9(4)        VALUE 0361.
   256         10  ER-0362                 PIC 9(4)        VALUE 0362.
   257         10  ER-0363                 PIC 9(4)        VALUE 0363.
   258         10  ER-0364                 PIC 9(4)        VALUE 0364.
   259         10  ER-0365                 PIC 9(4)        VALUE 0365.
   260         10  ER-0366                 PIC 9(4)        VALUE 0366.
   261         10  ER-0367                 PIC 9(4)        VALUE 0367.
   262         10  ER-0368                 PIC 9(4)        VALUE 0368.
   263         10  ER-0369                 PIC 9(4)        VALUE 0369.
   264         10  ER-0370                 PIC 9(4)        VALUE 0370.
   265         10  ER-0371                 PIC 9(4)        VALUE 0371.
   266         10  ER-0379                 PIC 9(4)        VALUE 0379.
   267         10  ER-0380                 PIC 9(4)        VALUE 0380.
   268         10  ER-0381                 PIC 9(4)        VALUE 0381.
   269         10  ER-0382                 PIC 9(4)        VALUE 0382.
   270         10  ER-0383                 PIC 9(4)        VALUE 0383.
   271         10  ER-0385                 PIC 9(4)        VALUE 0385.
   272         10  ER-0387                 PIC 9(4)        VALUE 0387.
   273         10  ER-0389                 PIC 9(4)        VALUE 0389.
   274         10  ER-0390                 PIC 9(4)        VALUE 0390.
   275         10  ER-0391                 PIC 9(4)        VALUE 0391.
   276         10  ER-0392                 PIC 9(4)        VALUE 0392.
   277         10  ER-0393                 PIC 9(4)        VALUE 0393.
   278         10  ER-0394                 PIC 9(4)        VALUE 0394.
   279         10  ER-0395                 PIC 9(4)        VALUE 0395.
   280         10  ER-0490                 PIC 9(4)        VALUE 0490.
   281         10  ER-3130                 PIC 9(4)        VALUE 3130.
   282
   283
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL687.cbl
   285*                            COPY ELCINTF.
   286******************************************************************
   287*                                                                *
   288*                                                                *
   289*                            ELCINTF.                            *
   290*                            VMOD=2.017                          *
   291*                                                                *
   292*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   293*                                                                *
   294*       LENGTH = 1024                                            *
   295*                                                                *
   296******************************************************************
   297 01  PROGRAM-INTERFACE-BLOCK.
   298     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   299     12  PI-CALLING-PROGRAM              PIC X(8).
   300     12  PI-SAVED-PROGRAM-1              PIC X(8).
   301     12  PI-SAVED-PROGRAM-2              PIC X(8).
   302     12  PI-SAVED-PROGRAM-3              PIC X(8).
   303     12  PI-SAVED-PROGRAM-4              PIC X(8).
   304     12  PI-SAVED-PROGRAM-5              PIC X(8).
   305     12  PI-SAVED-PROGRAM-6              PIC X(8).
   306     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   307     12  PI-COMPANY-ID                   PIC XXX.
   308     12  PI-COMPANY-CD                   PIC X.
   309
   310     12  PI-COMPANY-PASSWORD             PIC X(8).
   311
   312     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   313
   314     12  PI-CONTROL-IN-PROGRESS.
   315         16  PI-CARRIER                  PIC X.
   316         16  PI-GROUPING                 PIC X(6).
   317         16  PI-STATE                    PIC XX.
   318         16  PI-ACCOUNT                  PIC X(10).
   319         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   320                                         PIC X(10).
   321         16  PI-CLAIM-CERT-GRP.
   322             20  PI-CLAIM-NO             PIC X(7).
   323             20  PI-CERT-NO.
   324                 25  PI-CERT-PRIME       PIC X(10).
   325                 25  PI-CERT-SFX         PIC X.
   326             20  PI-CERT-EFF-DT          PIC XX.
   327         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   328             20  PI-PLAN-CODE            PIC X(2).
   329             20  PI-REVISION-NUMBER      PIC X(3).
   330             20  PI-PLAN-EFF-DT          PIC X(2).
   331             20  PI-PLAN-EXP-DT          PIC X(2).
   332             20  FILLER                  PIC X(11).
   333         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   334             20  PI-OE-REFERENCE-1.
   335                 25  PI-OE-REF-1-PRIME   PIC X(18).
   336                 25  PI-OE-REF-1-SUFF    PIC XX.
   337
   338     12  PI-SESSION-IN-PROGRESS          PIC X.
   339         88  CLAIM-SESSION                   VALUE '1'.
   340         88  CREDIT-SESSION                  VALUE '2'.
   341         88  WARRANTY-SESSION                VALUE '3'.
   342         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL687.cbl
   343         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   344
   345
   346*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   347
   348     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   349     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   350
   351     12  PI-CREDIT-USER                  PIC X.
   352         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   353         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   354
   355     12  PI-CLAIM-USER                   PIC X.
   356         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   357         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   358
   359     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   360         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   361         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   362         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   363         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   364         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   365
   366     12  PI-PROCESSOR-ID                 PIC X(4).
   367
   368     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   369
   370     12  PI-MEMBER-CAPTION               PIC X(10).
   371
   372     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   373         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   374
   375     12  PI-LIFE-OVERRIDE-L1             PIC X.
   376     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   377     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   378     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   379
   380     12  PI-AH-OVERRIDE-L1               PIC X.
   381     12  PI-AH-OVERRIDE-L2               PIC XX.
   382     12  PI-AH-OVERRIDE-L6               PIC X(6).
   383     12  PI-AH-OVERRIDE-L12              PIC X(12).
   384
   385     12  PI-NEW-SYSTEM                   PIC X(2).
   386
   387     12  PI-PRIMARY-CERT-NO              PIC X(11).
   388     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   389         88  PI-USES-PAID-TO                 VALUE '1'.
   390     12  PI-CRDTCRD-SYSTEM.
   391         16  PI-CRDTCRD-USER             PIC X.
   392             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   393             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   394         16  PI-CC-MONTH-END-DT          PIC XX.
   395     12  PI-PROCESSOR-PRINTER            PIC X(4).
   396
   397     12  PI-OE-REFERENCE-2.
   398         16  PI-OE-REF-2-PRIME           PIC X(10).
   399         16  PI-OE-REF-2-SUFF            PIC X.
   400
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL687.cbl
   401     12  PI-REM-TRM-CALC-OPTION          PIC X.
   402
   403     12  PI-LANGUAGE-TYPE                PIC X.
   404             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   405             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   406             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   407
   408     12  PI-POLICY-LINKAGE-IND           PIC X.
   409         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   410         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   411                                                   LOW-VALUES.
   412
   413     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   414     12  PI-CLAIM-PW-SESSION             PIC X(1).
   415         88  PI-CLAIM-CREDIT                 VALUE '1'.
   416         88  PI-CLAIM-CONVEN                 VALUE '2'.
   417     12  FILLER                          PIC X(4).
   418
   419     12  PI-SYSTEM-LEVEL                 PIC X(145).
   420
   421     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   422         PI-SYSTEM-LEVEL.
   423
   424         16  PI-ENTRY-CODES.
   425             20  PI-ENTRY-CD-1           PIC X.
   426             20  PI-ENTRY-CD-2           PIC X.
   427
   428         16  PI-RETURN-CODES.
   429             20  PI-RETURN-CD-1          PIC X.
   430             20  PI-RETURN-CD-2          PIC X.
   431
   432         16  PI-UPDATE-STATUS-SAVE.
   433             20  PI-UPDATE-BY            PIC X(4).
   434             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   435
   436         16  PI-LOWER-CASE-LETTERS       PIC X.
   437             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   438
   439*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   440*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   441*            88  CARRIER-CLM-CNTL            VALUE '2'.
   442
   443         16  PI-CERT-ACCESS-CONTROL      PIC X.
   444             88  ST-ACCNT-CNTL               VALUE ' '.
   445             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   446             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   447             88  ACCNT-CNTL                  VALUE '3'.
   448             88  CARR-ACCNT-CNTL             VALUE '4'.
   449
   450         16  PI-PROCESSOR-CAP-LIST.
   451             20  PI-SYSTEM-CONTROLS.
   452                24 PI-SYSTEM-DISPLAY     PIC X.
   453                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   454                24 PI-SYSTEM-MODIFY      PIC X.
   455                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   456             20  FILLER                  PIC XX.
   457             20  PI-DISPLAY-CAP          PIC X.
   458                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL687.cbl
   459             20  PI-MODIFY-CAP           PIC X.
   460                 88  MODIFY-CAP              VALUE 'Y'.
   461             20  PI-MSG-AT-LOGON-CAP     PIC X.
   462                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   463             20  PI-FORCE-CAP            PIC X.
   464                 88  FORCE-CAP               VALUE 'Y'.
   465
   466         16  PI-PROGRAM-CONTROLS.
   467             20  PI-PGM-PRINT-OPT        PIC X.
   468             20  PI-PGM-FORMAT-OPT       PIC X.
   469             20  PI-PGM-PROCESS-OPT      PIC X.
   470             20  PI-PGM-TOTALS-OPT       PIC X.
   471
   472         16  PI-HELP-INTERFACE.
   473             20  PI-LAST-ERROR-NO        PIC X(4).
   474             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   475
   476         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   477             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   478
   479         16  PI-CR-CONTROL-IN-PROGRESS.
   480             20  PI-CR-CARRIER           PIC X.
   481             20  PI-CR-GROUPING          PIC X(6).
   482             20  PI-CR-STATE             PIC XX.
   483             20  PI-CR-ACCOUNT           PIC X(10).
   484             20  PI-CR-FIN-RESP          PIC X(10).
   485             20  PI-CR-TYPE              PIC X.
   486
   487         16  PI-CR-BATCH-NUMBER          PIC X(6).
   488
   489         16  PI-CR-MONTH-END-DT          PIC XX.
   490
   491         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   492             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   493             88  PI-ZERO-CARRIER             VALUE '1'.
   494             88  PI-ZERO-GROUPING            VALUE '2'.
   495             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   496
   497         16  PI-CARRIER-SECURITY         PIC X.
   498             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   499
   500         16  PI-ACCOUNT-SECURITY         PIC X(10).
   501             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   502             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   503
   504         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   505             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   506                                         INDEXED BY PI-ACCESS-NDX
   507                                         PIC X.
   508
   509         16  PI-GA-BILLING-CONTROL       PIC X.
   510             88  PI-GA-BILLING               VALUE '1'.
   511
   512         16  PI-MAIL-PROCESSING          PIC X.
   513             88  PI-MAIL-YES                 VALUE 'Y'.
   514
   515         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   516
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL687.cbl
   517         16  PI-AR-SYSTEM.
   518             20  PI-AR-PROCESSING-CNTL   PIC X.
   519                 88  PI-AR-PROCESSING        VALUE 'Y'.
   520             20  PI-AR-SUMMARY-CODE      PIC X(6).
   521             20  PI-AR-MONTH-END-DT      PIC XX.
   522
   523         16  PI-MP-SYSTEM.
   524             20  PI-MORTGAGE-USER            PIC X.
   525                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   526                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   527             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   528                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   529                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   530                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   531                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   532                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   533             20  PI-MP-MONTH-END-DT          PIC XX.
   534             20  PI-MP-REFERENCE-NO.
   535                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   536                 24  PI-MP-REFERENCE-SFX     PIC XX.
   537
   538         16  PI-LABEL-CONTROL            PIC X(01).
   539             88  PI-CREATE-LABELS                    VALUE 'Y'.
   540             88  PI-BYPASS-LABELS                    VALUE 'N'.
   541
   542         16  PI-BILL-GROUPING-CODE       PIC X(01).
   543             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   544
   545         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   546             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   547             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   548
   549         16  FILLER                      PIC X(14).
   550
   551     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   552******************************************************************
   553*                            COPY ERC687PI.
   554*****************************************************************
   555*                                                               *
   556*                                                               *
   557*                            ERC687PI                           *
   558*                            VMOD=2.004                         *
   559*                                                               *
   560*****************************************************************.
   561
   562     12  FILLER                      REDEFINES
   563         PI-PROGRAM-WORK-AREA.
   564
   565         16  PI-TEMP-STORAGE-KEY.
   566             20  PI-TSK-TERM-ID      PIC X(4).
   567             20  PI-TSK-TIME         PIC S9(7)     COMP-3.
   568
   569         16  PI-PROCESSING-SW        PIC S9        COMP-3.
   570
   571         16  PI-NUMBER-OF-ALIGNMENT-CHECKS PIC S9  COMP-3.
   572
   573         16  PI-ALIGNMENT-CONTROL-GROUP  PIC S9(8) COMP.
   574
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL687.cbl
   575         16  PI-ALIGNMENT-SEQUENCE-NO  PIC S9(4)   COMP.
   576
   577         16  PI-NUMBER-OF-CONTROL-GROUPS  PIC S9(4) COMP.
   578
   579         16  PI-CONTROL-GROUPS       COMP
   580             OCCURS 4 TIMES          INDEXED BY PI-INDEX.
   581
   582             20  PI-CONTROL-GROUP    PIC S9(8).
   583             20  PI-HIGH-SEQUENCE    PIC S9(4).
   584
   585         16  PI-CHECK-PRINTER-ID     PIC X(4).
   586
   587         16  PI-PRINTER-STARTED-SW   PIC S9      COMP-3.
   588
   589         16  PI-ASSIGN-CHECK-NUMBERS PIC X.
   590
   591         16  PI-COMPANY-ADDRESS.
   592             20  PI-COMPANY-NAME             PIC X(30).
   593             20  PI-COMPANY-ADDRESS-LINE1    PIC X(30).
   594             20  PI-COMPANY-ADDRESS-LINE2    PIC X(30).
   595             20  PI-COMPANY-ADDRESS-LINE3    PIC X(30).
   596             20  PI-COMPANY-CITY-ST          PIC X(30).
   597             20  PI-COMPANY-ZIP-CODE.
   598                 24  PI-COMPANY-ZIP-PRIME.
   599                     26  PI-ZIP-PRI-1ST      PIC X.
   600                         88  PI-CO-CANADIAN-POST-CODE
   601                                          VALUE 'A' THRU 'Z'.
   602                     26  FILLER              PIC X(4).
   603                 24  PI-COMPANY-ZIP-PLUS4    PIC X(4).
   604             20  PI-CANADIAN-POSTAL-CODE REDEFINES
   605                 PI-COMPANY-ZIP-CODE.
   606                 24  PI-CAN-POSTAL-1         PIC XXX.
   607                 24  PI-CAN-POSTAL-2         PIC XXX.
   608                 24  FILLER                  PIC XXX.
   609             20  PI-COMPANY-PHONE-NUMBER     PIC S9(11) COMP-3.
   610         16  PI-SYSID                PIC X(4).
   611
   612         16  PI-TEMP-STORAGE-ITEM    PIC S9(4) COMP SYNC.
   613         16  PI-LETTERS-IND          PIC X.
   614
   615         16  FILLER                  PIC X(419).
   616
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL687.cbl
   618*                            COPY ERCCPA.
   619******************************************************************
   620*                                                                *
   621*                                                                *
   622*                            ERCCPA                              *
   623*                            VMOD=2.005                          *
   624*                                                                *
   625*   DESCRIPTION:  DATA TO BE PASSED TO CHECK WRITER ROUTINE.     *
   626*   LENGTH: 700 CHARACTERS                                       *
   627*                                                                *
   628******************************************************************
   629
   630 01  CHECK-PASS-AREA.
   631     12  CPA-ALIGNMENT               PIC S9(3)     COMP-3.
   632     12  CPA-CARRIER                 PIC X.
   633     12  CPA-GROUPING                PIC X(6).
   634     12  CPA-ACCOUNT                 PIC X(10).
   635     12  CPA-FIN-RESP                PIC X(10).
   636     12  CPA-STATE                   PIC XX.
   637     12  CPA-CERT-NO                 PIC X(11).
   638
   639     12  CPA-CAR-NAME                PIC X(30).
   640     12  CPA-CAR-ADDRESS-LINE1       PIC X(30).
   641     12  CPA-CAR-ADDRESS-LINE2       PIC X(30).
   642     12  CPA-CAR-ADDRESS-LINE3       PIC X(30).
   643     12  CPA-CAR-CITY-STATE          PIC X(30).
   644     12  CPA-CAR-ZIP-CODE            PIC S9(9)     COMP-3.
   645     12  CPA-PAYMENT-TYPE            PIC X.
   646     12  CPA-PAYMENT-BY              PIC X(4).
   647     12  CPA-CHECK-DATE              PIC X(2).
   648     12  CPA-CHECK-NUMBER            PIC X(7).
   649     12  CPA-AMOUNT-PAID             PIC S9(9)V99  COMP-3.
   650     12  CPA-AMOUNT-PAID-TO-DATE     PIC S9(9)V99  COMP-3.
   651     12  CPA-INCURRED-DT             PIC XX.
   652     12  CPA-REPORTED-DT             PIC XX.
   653     12  CPA-PAID-THRU-DT            PIC XX.
   654     12  CPA-PAID-FROM-DT            PIC XX.
   655     12  CPA-PAID-DT                 PIC XX.
   656
   657     12  CPA-PAYEE-NAME              PIC X(30).
   658     12  CPA-PAYEE-IN-CARE-OF        PIC X(30).
   659     12  CPA-PAYEE-ADDRESS-LINE1     PIC X(30).
   660     12  CPA-PAYEE-ADDRESS-LINE2     PIC X(30).
   661     12  CPA-PAYEE-CITY-ST           PIC X(30).
   662     12  CPA-PAYEE-ZIP-CODE.
   663         16  CPA-PAYEE-ZIP-PRIME.
   664             20  CPA-PAYEE-PRI-1ST   PIC X.
   665                 88  CPA-PAYEE-CAN-POST-CODE   VALUE 'A' THRU 'Z'.
   666             20  FILLER              PIC X(4).
   667         16  CPA-PAYEE-ZIP-PLUS4     PIC X(4).
   668     12  CPA-PAYEE-CAN-POSTAL-CODE  REDEFINES  CPA-PAYEE-ZIP-CODE.
   669         16  CPA-PAYEE-POST-1        PIC XXX.
   670         16  CPA-PAYEE-POST-2        PIC XXX.
   671         16  FILLER                  PIC XXX.
   672     12  CPA-PAYEE-PHONE-NO          PIC S9(11)   COMP-3.
   673
   674     12  CPA-SOC-SEC-NO              PIC X(11).
   675     12  CPA-MEMBER-NUMBER           PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL687.cbl
   676     12  CPA-NO-OF-PMTS-MADE         PIC S9(3)    COMP-3.
   677     12  CPA-GENERAL-LEDGER          PIC X(7).
   678     12  CPA-CANC-DT                 PIC XX.
   679     12  CPA-LF-REFUND               PIC S9(7)V99  COMP-3.
   680     12  CPA-AH-REFUND               PIC S9(7)V99  COMP-3.
   681     12  CPA-INSURED-NAME            PIC X(28).
   682     12  CPA-CERT-EFF-DT             PIC XX.
   683     12  CPA-DEDUCT-WITHHELD         PIC S9(5)V99  COMP-3.
   684     12  CPA-ADDITIONAL-CHARGE       PIC S9(5)V99  COMP-3.
   685     12  FILLER                      PIC X(26).
   686     12  CPA-REST-OF-RECORD          PIC X(250).
   687
   688     12  CPA-CHECK-STUBS             REDEFINES
   689         CPA-REST-OF-RECORD.
   690         16  CPA-STUB1               PIC X(50).
   691         16  CPA-STUB2               PIC X(50).
   692         16  CPA-STUB3               PIC X(50).
   693         16  CPA-STUB4               PIC X(50).
   694         16  CPA-STUB5               PIC X(50).
   695
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL687.cbl
   697*                            COPY ELCNWA.
   698*****************************************************************
   699*                                                               *
   700*                                                               *
   701*                            ELCNWA.                            *
   702*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   703*                            VMOD=2.003                         *
   704*                                                               *
   705*            M O V E   N A M E   W O R K   A R E A.             *
   706*                                                               *
   707*****************************************************************.
   708
   709 01  WS-NAME-WORK-AREA.
   710     05  WS-INSURED-LAST-NAME        PIC X(15).
   711     05  WS-INSURED-1ST-NAME         PIC X(12).
   712     05  WS-INSURED-MID-INIT         PIC X.
   713
   714     05  WS-NAME-WORK.
   715         10  WS-NW                   PIC X
   716             OCCURS 30 TIMES INDEXED BY NWA-INDEX.
   717
   718     05  WS-NAME-WORK2.
   719         10  WS-NW2                  PIC X
   720             OCCURS 20 TIMES INDEXED BY NWA-INDEX2 NWA-INDEX3
   721                                        NWA-INDEX0.
   722
   723     05  WS-NAME-SW                  PIC S9          VALUE ZERO
   724                                     COMP-3.
   725
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL687.cbl
   727*                            COPY EL687S.
   728 01  EL687AI.
   729     05  FILLER            PIC  X(0012).
   730*    -------------------------------
   731     05  ADATEL PIC S9(0004) COMP.
   732     05  ADATEF PIC  X(0001).
   733     05  FILLER REDEFINES ADATEF.
   734         10  ADATEA PIC  X(0001).
   735     05  ADATEI PIC  X(0008).
   736*    -------------------------------
   737     05  ATIMEL PIC S9(0004) COMP.
   738     05  ATIMEF PIC  X(0001).
   739     05  FILLER REDEFINES ATIMEF.
   740         10  ATIMEA PIC  X(0001).
   741     05  ATIMEI PIC  X(0005).
   742*    -------------------------------
   743     05  AOPTIONL PIC S9(0004) COMP.
   744     05  AOPTIONF PIC  X(0001).
   745     05  FILLER REDEFINES AOPTIONF.
   746         10  AOPTIONA PIC  X(0001).
   747     05  AOPTIONI PIC  X(0001).
   748*    -------------------------------
   749     05  ACG01L PIC S9(0004) COMP.
   750     05  ACG01F PIC  X(0001).
   751     05  FILLER REDEFINES ACG01F.
   752         10  ACG01A PIC  X(0001).
   753     05  ACG01I PIC  X(0007).
   754*    -------------------------------
   755     05  ACG02L PIC S9(0004) COMP.
   756     05  ACG02F PIC  X(0001).
   757     05  FILLER REDEFINES ACG02F.
   758         10  ACG02A PIC  X(0001).
   759     05  ACG02I PIC  X(0007).
   760*    -------------------------------
   761     05  ACG03L PIC S9(0004) COMP.
   762     05  ACG03F PIC  X(0001).
   763     05  FILLER REDEFINES ACG03F.
   764         10  ACG03A PIC  X(0001).
   765     05  ACG03I PIC  X(0007).
   766*    -------------------------------
   767     05  ACG04L PIC S9(0004) COMP.
   768     05  ACG04F PIC  X(0001).
   769     05  FILLER REDEFINES ACG04F.
   770         10  ACG04A PIC  X(0001).
   771     05  ACG04I PIC  X(0007).
   772*    -------------------------------
   773     05  AALIGNL PIC S9(0004) COMP.
   774     05  AALIGNF PIC  X(0001).
   775     05  FILLER REDEFINES AALIGNF.
   776         10  AALIGNA PIC  X(0001).
   777     05  AALIGNI PIC  X(0001).
   778*    -------------------------------
   779     05  ACKNOL PIC S9(0004) COMP.
   780     05  ACKNOF PIC  X(0001).
   781     05  FILLER REDEFINES ACKNOF.
   782         10  ACKNOA PIC  X(0001).
   783     05  ACKNOI PIC  X(0007).
   784*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL687.cbl
   785     05  AACNL PIC S9(0004) COMP.
   786     05  AACNF PIC  X(0001).
   787     05  FILLER REDEFINES AACNF.
   788         10  AACNA PIC  X(0001).
   789     05  AACNI PIC  X(0001).
   790*    -------------------------------
   791     05  APRTL PIC S9(0004) COMP.
   792     05  APRTF PIC  X(0001).
   793     05  FILLER REDEFINES APRTF.
   794         10  APRTA PIC  X(0001).
   795     05  APRTI PIC  X(0004).
   796*    -------------------------------
   797     05  AEMSG1L PIC S9(0004) COMP.
   798     05  AEMSG1F PIC  X(0001).
   799     05  FILLER REDEFINES AEMSG1F.
   800         10  AEMSG1A PIC  X(0001).
   801     05  AEMSG1I PIC  X(0079).
   802*    -------------------------------
   803     05  AEMSG2L PIC S9(0004) COMP.
   804     05  AEMSG2F PIC  X(0001).
   805     05  FILLER REDEFINES AEMSG2F.
   806         10  AEMSG2A PIC  X(0001).
   807     05  AEMSG2I PIC  X(0079).
   808*    -------------------------------
   809     05  AEMSG3L PIC S9(0004) COMP.
   810     05  AEMSG3F PIC  X(0001).
   811     05  FILLER REDEFINES AEMSG3F.
   812         10  AEMSG3A PIC  X(0001).
   813     05  AEMSG3I PIC  X(0079).
   814*    -------------------------------
   815     05  APFKL PIC S9(0004) COMP.
   816     05  APFKF PIC  X(0001).
   817     05  FILLER REDEFINES APFKF.
   818         10  APFKA PIC  X(0001).
   819     05  APFKI PIC  9(2).
   820 01  EL687AO REDEFINES EL687AI.
   821     05  FILLER            PIC  X(0012).
   822*    -------------------------------
   823     05  FILLER            PIC  X(0003).
   824     05  ADATEO PIC  X(0008).
   825*    -------------------------------
   826     05  FILLER            PIC  X(0003).
   827     05  ATIMEO PIC  99.99.
   828*    -------------------------------
   829     05  FILLER            PIC  X(0003).
   830     05  AOPTIONO PIC  X(0001).
   831*    -------------------------------
   832     05  FILLER            PIC  X(0003).
   833     05  ACG01O PIC  9999999.
   834*    -------------------------------
   835     05  FILLER            PIC  X(0003).
   836     05  ACG02O PIC  9999999.
   837*    -------------------------------
   838     05  FILLER            PIC  X(0003).
   839     05  ACG03O PIC  9999999.
   840*    -------------------------------
   841     05  FILLER            PIC  X(0003).
   842     05  ACG04O PIC  9999999.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL687.cbl
   843*    -------------------------------
   844     05  FILLER            PIC  X(0003).
   845     05  AALIGNO PIC  9.
   846*    -------------------------------
   847     05  FILLER            PIC  X(0003).
   848     05  ACKNOO PIC  9999999.
   849*    -------------------------------
   850     05  FILLER            PIC  X(0003).
   851     05  AACNO PIC  X(0001).
   852*    -------------------------------
   853     05  FILLER            PIC  X(0003).
   854     05  APRTO PIC  X(0004).
   855*    -------------------------------
   856     05  FILLER            PIC  X(0003).
   857     05  AEMSG1O PIC  X(0079).
   858*    -------------------------------
   859     05  FILLER            PIC  X(0003).
   860     05  AEMSG2O PIC  X(0079).
   861*    -------------------------------
   862     05  FILLER            PIC  X(0003).
   863     05  AEMSG3O PIC  X(0079).
   864*    -------------------------------
   865     05  FILLER            PIC  X(0003).
   866     05  APFKO PIC  99.
   867*    -------------------------------
   868 01  FILLER                          REDEFINES
   869     EL687AI.
   870
   871     05  FILLER                      PIC X(35).
   872
   873     05  FILLER                      OCCURS 4 TIMES
   874                                     INDEXED BY EL687A-INDEX.
   875
   876         10  EL687A-CONTROL-GROUP-LENGTH   PIC S9(4)
   877                                           COMP.
   878         10  EL687A-CONTROL-GROUP-ATTRB    PIC X.
   879         10  EL687A-CONTROL-GROUP          PIC 9(7).
   880         10  EL687A-CONTROL-GROUP-X        REDEFINES
   881             EL687A-CONTROL-GROUP          PIC X(7).
   882
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL687.cbl
   884*                            COPY ELCJPFX.
   885******************************************************************
   886*                                                                *
   887*                                                                *
   888*                            ELCJPFX.                            *
   889*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   890*                            VMOD=2.002                          *
   891*                                                                *
   892*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   893*                                                                *
   894*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   895*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   896*        ELCNTL - CONTROL FILE                                   *
   897*        ELMSTR - CLAIM MASTERS                                  *
   898*        ELTRLR - ACTIVITY TRAILERS                              *
   899*        ELCHKQ - CHECK QUE                                      *
   900******************************************************************
   901 01  JOURNAL-RECORD.
   902     12  JP-USER-ID                  PIC X(4).
   903     12  JP-FILE-ID                  PIC X(8).
   904     12  JP-PROGRAM-ID               PIC X(8).
   905     12  JP-RECORD-TYPE              PIC X.
   906         88 JP-ADD              VALUE 'A'.
   907         88 JP-BEFORE-CHANGE    VALUE 'B'.
   908         88 JP-AFTER-CHANGE     VALUE 'C'.
   909         88 JP-DELETE           VALUE 'D'.
   910         88 JP-GENERIC-DELETE   VALUE 'G'.
   911         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   912         88 JP-KEY-CHG-ADD      VALUE 'N'.
   913     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   914     12  JP-RECORD-AREA
   915
   916
   917                                     PIC X(750).
   918
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL687.cbl
   920*                            COPY ELCEMIB.
   921******************************************************************
   922*                                                                *
   923*                                                                *
   924*                            ELCEMIB.                            *
   925*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   926*                            VMOD=2.005                          *
   927*                                                                *
   928*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   929*                                                                *
   930******************************************************************
   931 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   932     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   933     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   934     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   935     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   936     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   937     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   938     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   939     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   940     12  EMI-SWITCH1             PIC X        VALUE '1'.
   941         88  EMI-NO-ERRORS                    VALUE '1'.
   942         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   943         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   944     12  EMI-SWITCH2             PIC X        VALUE '1'.
   945         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   946     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   947         88  EMI-AREA1-EMPTY                  VALUE '1'.
   948         88  EMI-AREA1-FULL                   VALUE '2'.
   949     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   950         88  EMI-AREA2-EMPTY                  VALUE '1'.
   951         88  EMI-AREA2-FULL                   VALUE '2'.
   952     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   953         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   954         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   955         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   956         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   957         88  EMI-BYPASS-FATALS                VALUE 'X'.
   958     12  EMI-ERROR-LINES.
   959         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   960         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   961         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   962         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   963             20  EMI-ERR-CODES OCCURS 10 TIMES.
   964                 24  EMI-ERR-NUM         PIC X(4).
   965                 24  EMI-FILLER          PIC X.
   966                 24  EMI-SEV             PIC X.
   967                 24  FILLER              PIC X.
   968             20  FILLER                  PIC X(02).
   969     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   970         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   971             20  EMI-ERROR-NUMBER    PIC X(4).
   972             20  EMI-FILL            PIC X.
   973             20  EMI-SEVERITY        PIC X.
   974             20  FILLER              PIC X.
   975             20  EMI-ERROR-TEXT.
   976                 24  EMI-TEXT-VARIABLE   PIC X(10).
   977                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL687.cbl
   978     12  EMI-SEVERITY-SAVE           PIC X.
   979         88  EMI-NOTE                    VALUE 'N'.
   980         88  EMI-WARNING                 VALUE 'W'.
   981         88  EMI-FORCABLE                VALUE 'F'.
   982         88  EMI-FATAL                   VALUE 'X'.
   983     12  EMI-MESSAGE-FLAG            PIC X.
   984         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   985         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   986     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   987     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   988         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   989         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   990         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   991     12  FILLER                      PIC X(137)  VALUE SPACES.
   992     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   993     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   994     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   995     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   996
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL687.cbl
   998*                            COPY ELCDATE.
   999******************************************************************
  1000*                                                                *
  1001*                                                                *
  1002*                            ELCDATE.                            *
  1003*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1004*                            VMOD=2.003
  1005*                                                                *
  1006*                                                                *
  1007*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1008*                 LENGTH = 200                                   *
  1009******************************************************************
  1010
  1011 01  DATE-CONVERSION-DATA.
  1012     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1013     12  DC-OPTION-CODE                PIC X.
  1014         88  BIN-TO-GREG                VALUE ' '.
  1015         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  1016         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1017         88  YMD-GREG-TO-BIN            VALUE '3'.
  1018         88  MDY-GREG-TO-BIN            VALUE '4'.
  1019         88  JULIAN-TO-BIN              VALUE '5'.
  1020         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1021         88  FIND-CENTURY               VALUE '7'.
  1022         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1023         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1024         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1025         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1026         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1027         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1028         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1029         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1030         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1031         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1032         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1033         88  BIN-3-TO-GREG              VALUE 'I'.
  1034         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1035         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1036         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1037         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1038         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1039         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1040         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1041         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1042         88  THREE-CHARACTER-BIN
  1043                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1044         88  GREGORIAN-TO-BIN
  1045                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1046         88  BIN-TO-GREGORIAN
  1047                  VALUES ' ' '1' 'I' '8' 'G'.
  1048         88  JULIAN-TO-BINARY
  1049                  VALUES '5' 'C' 'E' 'F'.
  1050     12  DC-ERROR-CODE                 PIC X.
  1051         88  NO-CONVERSION-ERROR        VALUE ' '.
  1052         88  DATE-CONVERSION-ERROR
  1053                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1054         88  DATE-IS-ZERO               VALUE '1'.
  1055         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL687.cbl
  1056         88  DATE-IS-INVALID            VALUE '3'.
  1057         88  DATE1-GREATER-DATE2        VALUE '4'.
  1058         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1059         88  DATE-INVALID-OPTION        VALUE '9'.
  1060         88  INVALID-CENTURY            VALUE 'A'.
  1061         88  ONLY-CENTURY               VALUE 'B'.
  1062         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1063         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1064     12  DC-END-OF-MONTH               PIC X.
  1065         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1066     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1067         88  USE-NORMAL-PROCESS         VALUE ' '.
  1068         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1069         88  ADJUST-UP-100-YRS          VALUE '2'.
  1070     12  FILLER                        PIC X.
  1071     12  DC-CONVERSION-DATES.
  1072         16  DC-BIN-DATE-1             PIC XX.
  1073         16  DC-BIN-DATE-2             PIC XX.
  1074         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1075         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1076                       DC-GREG-DATE-1-EDIT.
  1077             20  DC-EDIT1-MONTH        PIC 99.
  1078             20  SLASH1-1              PIC X.
  1079             20  DC-EDIT1-DAY          PIC 99.
  1080             20  SLASH1-2              PIC X.
  1081             20  DC-EDIT1-YEAR         PIC 99.
  1082         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1083         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1084                     DC-GREG-DATE-2-EDIT.
  1085             20  DC-EDIT2-MONTH        PIC 99.
  1086             20  SLASH2-1              PIC X.
  1087             20  DC-EDIT2-DAY          PIC 99.
  1088             20  SLASH2-2              PIC X.
  1089             20  DC-EDIT2-YEAR         PIC 99.
  1090         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1091         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1092                     DC-GREG-DATE-1-YMD.
  1093             20  DC-YMD-YEAR           PIC 99.
  1094             20  DC-YMD-MONTH          PIC 99.
  1095             20  DC-YMD-DAY            PIC 99.
  1096         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1097         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1098                      DC-GREG-DATE-1-MDY.
  1099             20  DC-MDY-MONTH          PIC 99.
  1100             20  DC-MDY-DAY            PIC 99.
  1101             20  DC-MDY-YEAR           PIC 99.
  1102         16  DC-GREG-DATE-1-ALPHA.
  1103             20  DC-ALPHA-MONTH        PIC X(10).
  1104             20  DC-ALPHA-DAY          PIC 99.
  1105             20  FILLER                PIC XX.
  1106             20  DC-ALPHA-CENTURY.
  1107                 24 DC-ALPHA-CEN-N     PIC 99.
  1108             20  DC-ALPHA-YEAR         PIC 99.
  1109         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1110         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1111         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1112         16  DC-JULIAN-DATE            PIC 9(05).
  1113         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL687.cbl
  1114                                       PIC 9(05).
  1115         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1116             20  DC-JULIAN-YEAR        PIC 99.
  1117             20  DC-JULIAN-DAYS        PIC 999.
  1118         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1119         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1120         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1121     12  DATE-CONVERSION-VARIBLES.
  1122         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1123         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1124             20  FILLER                PIC 9(3).
  1125             20  HOLD-CEN-1-CCYY.
  1126                 24  HOLD-CEN-1-CC     PIC 99.
  1127                 24  HOLD-CEN-1-YY     PIC 99.
  1128             20  HOLD-CEN-1-MO         PIC 99.
  1129             20  HOLD-CEN-1-DA         PIC 99.
  1130         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1131             20  HOLD-CEN-1-R-MO       PIC 99.
  1132             20  HOLD-CEN-1-R-DA       PIC 99.
  1133             20  HOLD-CEN-1-R-CCYY.
  1134                 24  HOLD-CEN-1-R-CC   PIC 99.
  1135                 24  HOLD-CEN-1-R-YY   PIC 99.
  1136             20  FILLER                PIC 9(3).
  1137         16  HOLD-CENTURY-1-X.
  1138             20  FILLER                PIC X(3)  VALUE SPACES.
  1139             20  HOLD-CEN-1-X-CCYY.
  1140                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1141                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1142             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1143             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1144         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1145             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1146             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1147             20  HOLD-CEN-1-R-X-CCYY.
  1148                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1149                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1150             20  FILLER                PIC XXX.
  1151         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1152         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1153         16  DC-JULIAN-DATE-1          PIC 9(07).
  1154         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1155             20  DC-JULIAN-1-CCYY.
  1156                 24  DC-JULIAN-1-CC    PIC 99.
  1157                 24  DC-JULIAN-1-YR    PIC 99.
  1158             20  DC-JULIAN-DA-1        PIC 999.
  1159         16  DC-JULIAN-DATE-2          PIC 9(07).
  1160         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1161             20  DC-JULIAN-2-CCYY.
  1162                 24  DC-JULIAN-2-CC    PIC 99.
  1163                 24  DC-JULIAN-2-YR    PIC 99.
  1164             20  DC-JULIAN-DA-2        PIC 999.
  1165         16  DC-GREG-DATE-A-EDIT.
  1166             20  DC-EDITA-MONTH        PIC 99.
  1167             20  SLASHA-1              PIC X VALUE '/'.
  1168             20  DC-EDITA-DAY          PIC 99.
  1169             20  SLASHA-2              PIC X VALUE '/'.
  1170             20  DC-EDITA-CCYY.
  1171                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL687.cbl
  1172                 24  DC-EDITA-YEAR     PIC 99.
  1173         16  DC-GREG-DATE-B-EDIT.
  1174             20  DC-EDITB-MONTH        PIC 99.
  1175             20  SLASHB-1              PIC X VALUE '/'.
  1176             20  DC-EDITB-DAY          PIC 99.
  1177             20  SLASHB-2              PIC X VALUE '/'.
  1178             20  DC-EDITB-CCYY.
  1179                 24  DC-EDITB-CENT     PIC 99.
  1180                 24  DC-EDITB-YEAR     PIC 99.
  1181         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1182         16  DC-GREG-DATE-CYMD-R REDEFINES
  1183                              DC-GREG-DATE-CYMD.
  1184             20  DC-CYMD-CEN           PIC 99.
  1185             20  DC-CYMD-YEAR          PIC 99.
  1186             20  DC-CYMD-MONTH         PIC 99.
  1187             20  DC-CYMD-DAY           PIC 99.
  1188         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1189         16  DC-GREG-DATE-MDCY-R REDEFINES
  1190                              DC-GREG-DATE-MDCY.
  1191             20  DC-MDCY-MONTH         PIC 99.
  1192             20  DC-MDCY-DAY           PIC 99.
  1193             20  DC-MDCY-CEN           PIC 99.
  1194             20  DC-MDCY-YEAR          PIC 99.
  1195    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1196        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1197    12  DC-EL310-DATE                  PIC X(21).
  1198    12  FILLER                         PIC X(28).
  1199
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL687.cbl
  1201*                            COPY ELCLOGOF.
  1202******************************************************************
  1203*                                                                *
  1204*                                                                *
  1205*                            ELCLOGOF.                           *
  1206*                            VMOD=2.001                          *
  1207*                                                                *
  1208*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1209*                                                                *
  1210******************************************************************
  1211 01  CLASIC-LOGOFF.
  1212     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1213     12  LOGOFF-TEXT.
  1214         16  FILLER          PIC X(5)    VALUE SPACES.
  1215         16  LOGOFF-MSG.
  1216             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1217             20  FILLER      PIC X       VALUE SPACES.
  1218             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1219         16  FILLER          PIC X(80)
  1220           VALUE '* YOU ARE NOW LOGGED OFF'.
  1221         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1222         16  FILLER          PIC X       VALUE QUOTE.
  1223         16  LOGOFF-SYS-MSG  PIC X(17)
  1224           VALUE 'S CLAS-IC SYSTEM '.
  1225     12  TEXT-MESSAGES.
  1226         16  UNACCESS-MSG    PIC X(29)
  1227             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1228         16  PGMIDERR-MSG    PIC X(17)
  1229             VALUE 'PROGRAM NOT FOUND'.
  1230
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL687.cbl
  1232*                            COPY ELCATTR.
  1233******************************************************************
  1234*                                                                *
  1235*                            ELCATTR.                            *
  1236*                            VMOD=2.001                          *
  1237*                                                                *
  1238*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1239*                                                                *
  1240*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1241*                                                                *
  1242*                   POS 1   P=PROTECTED                          *
  1243*                           U=UNPROTECTED                        *
  1244*                           S=ASKIP                              *
  1245*                   POS 2   A=ALPHA/NUMERIC                      *
  1246*                           N=NUMERIC                            *
  1247*                   POS 3   N=NORMAL                             *
  1248*                           B=BRIGHT                             *
  1249*                           D=DARK                               *
  1250*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1251*                           OF=MODIFIED DATA TAG OFF             *
  1252*                                                                *
  1253*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1254******************************************************************
  1255 01  ATTRIBUTE-LIST.
  1256     12  AL-PABOF            PIC X       VALUE 'Y'.
  1257     12  AL-PABON            PIC X       VALUE 'Z'.
  1258     12  AL-PADOF            PIC X       VALUE '%'.
  1259     12  AL-PADON            PIC X       VALUE '_'.
  1260     12  AL-PANOF            PIC X       VALUE '-'.
  1261     12  AL-PANON            PIC X       VALUE '/'.
  1262     12  AL-SABOF            PIC X       VALUE '8'.
  1263     12  AL-SABON            PIC X       VALUE '9'.
  1264     12  AL-SADOF            PIC X       VALUE '@'.
  1265     12  AL-SADON            PIC X       VALUE QUOTE.
  1266     12  AL-SANOF            PIC X       VALUE '0'.
  1267     12  AL-SANON            PIC X       VALUE '1'.
  1268     12  AL-UABOF            PIC X       VALUE 'H'.
  1269     12  AL-UABON            PIC X       VALUE 'I'.
  1270     12  AL-UADOF            PIC X       VALUE '<'.
  1271     12  AL-UADON            PIC X       VALUE '('.
  1272     12  AL-UANOF            PIC X       VALUE ' '.
  1273     12  AL-UANON            PIC X       VALUE 'A'.
  1274     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1275     12  AL-UNBON            PIC X       VALUE 'R'.
  1276     12  AL-UNDOF            PIC X       VALUE '*'.
  1277     12  AL-UNDON            PIC X       VALUE ')'.
  1278     12  AL-UNNOF            PIC X       VALUE '&'.
  1279     12  AL-UNNON            PIC X       VALUE 'J'.
  1280
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL687.cbl
  1282*                            COPY ELCAID.
  1283******************************************************************
  1284*                                                                *
  1285*                            ELCAID.                             *
  1286*                            VMOD=2.001                          *
  1287*                                                                *
  1288*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1289*                                                                *
  1290*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1291*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1292******************************************************************
  1293
  1294 01  DFHAID.
  1295   02  DFHNULL   PIC  X  VALUE  ' '.
  1296   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1297   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1298   02  DFHPEN    PIC  X  VALUE  '='.
  1299   02  DFHOPID   PIC  X  VALUE  'W'.
  1300   02  DFHPA1    PIC  X  VALUE  '%'.
  1301   02  DFHPA2    PIC  X  VALUE  '>'.
  1302   02  DFHPA3    PIC  X  VALUE  ','.
  1303   02  DFHPF1    PIC  X  VALUE  '1'.
  1304   02  DFHPF2    PIC  X  VALUE  '2'.
  1305   02  DFHPF3    PIC  X  VALUE  '3'.
  1306   02  DFHPF4    PIC  X  VALUE  '4'.
  1307   02  DFHPF5    PIC  X  VALUE  '5'.
  1308   02  DFHPF6    PIC  X  VALUE  '6'.
  1309   02  DFHPF7    PIC  X  VALUE  '7'.
  1310   02  DFHPF8    PIC  X  VALUE  '8'.
  1311   02  DFHPF9    PIC  X  VALUE  '9'.
  1312   02  DFHPF10   PIC  X  VALUE  ':'.
  1313   02  DFHPF11   PIC  X  VALUE  '#'.
  1314   02  DFHPF12   PIC  X  VALUE  '@'.
  1315   02  DFHPF13   PIC  X  VALUE  'A'.
  1316   02  DFHPF14   PIC  X  VALUE  'B'.
  1317   02  DFHPF15   PIC  X  VALUE  'C'.
  1318   02  DFHPF16   PIC  X  VALUE  'D'.
  1319   02  DFHPF17   PIC  X  VALUE  'E'.
  1320   02  DFHPF18   PIC  X  VALUE  'F'.
  1321   02  DFHPF19   PIC  X  VALUE  'G'.
  1322   02  DFHPF20   PIC  X  VALUE  'H'.
  1323   02  DFHPF21   PIC  X  VALUE  'I'.
  1324*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1325   02  DFHPF22   PIC  X  VALUE  '['.
  1326   02  DFHPF23   PIC  X  VALUE  '.'.
  1327   02  DFHPF24   PIC  X  VALUE  '<'.
  1328   02  DFHMSRE   PIC  X  VALUE  'X'.
  1329   02  DFHSTRF   PIC  X  VALUE  'h'.
  1330   02  DFHTRIG   PIC  X  VALUE  '"'.
  1331
  1332 01  FILLER                      REDEFINES
  1333     DFHAID.
  1334
  1335     05  FILLER                      PIC X(8).
  1336
  1337     05  PF-VALUES                   PIC X
  1338         OCCURS 24 TIMES.
  1339
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL687.cbl
  1341****************************************************************
  1342*
  1343* Copyright (c) 2007 by Clerity Solutions, Inc.
  1344* All rights reserved.
  1345*
  1346****************************************************************
  1347 01  DFHEIV.
  1348   02  DFHEIV0               PIC X(35).
  1349   02  DFHEIV1               PIC X(08).
  1350   02  DFHEIV2               PIC X(08).
  1351   02  DFHEIV3               PIC X(08).
  1352   02  DFHEIV4               PIC X(06).
  1353   02  DFHEIV5               PIC X(04).
  1354   02  DFHEIV6               PIC X(04).
  1355   02  DFHEIV7               PIC X(02).
  1356   02  DFHEIV8               PIC X(02).
  1357   02  DFHEIV9               PIC X(01).
  1358   02  DFHEIV10              PIC S9(7) COMP-3.
  1359   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1360   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1361   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1362   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1363   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1364   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1365   02  DFHEIV17              PIC X(04).
  1366   02  DFHEIV18              PIC X(04).
  1367   02  DFHEIV19              PIC X(04).
  1368   02  DFHEIV20              USAGE IS POINTER.
  1369   02  DFHEIV21              USAGE IS POINTER.
  1370   02  DFHEIV22              USAGE IS POINTER.
  1371   02  DFHEIV23              USAGE IS POINTER.
  1372   02  DFHEIV24              USAGE IS POINTER.
  1373   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1374   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1375   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1376   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1377   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1378   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1379   02  FILLER                PIC X(02).
  1380   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1381   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1382   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1383   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1384   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1385 LINKAGE  SECTION.
  1386*****************************************************************
  1387*                                                               *
  1388* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1389* All rights reserved.                                          *
  1390*                                                               *
  1391*****************************************************************
  1392 01  dfheiblk.
  1393     02  eibtime          pic s9(7) comp-3.
  1394     02  eibdate          pic s9(7) comp-3.
  1395     02  eibtrnid         pic x(4).
  1396     02  eibtaskn         pic s9(7) comp-3.
  1397     02  eibtrmid         pic x(4).
  1398     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL687.cbl
  1399     02  eibcposn         pic s9(4) comp.
  1400     02  eibcalen         pic s9(4) comp.
  1401     02  eibaid           pic x(1).
  1402     02  eibfiller1       pic x(1).
  1403     02  eibfn            pic x(2).
  1404     02  eibfiller2       pic x(2).
  1405     02  eibrcode         pic x(6).
  1406     02  eibfiller3       pic x(2).
  1407     02  eibds            pic x(8).
  1408     02  eibreqid         pic x(8).
  1409     02  eibrsrce         pic x(8).
  1410     02  eibsync          pic x(1).
  1411     02  eibfree          pic x(1).
  1412     02  eibrecv          pic x(1).
  1413     02  eibsend          pic x(1).
  1414     02  eibatt           pic x(1).
  1415     02  eibeoc           pic x(1).
  1416     02  eibfmh           pic x(1).
  1417     02  eibcompl         pic x(1).
  1418     02  eibsig           pic x(1).
  1419     02  eibconf          pic x(1).
  1420     02  eiberr           pic x(1).
  1421     02  eibrldbk         pic x(1).
  1422     02  eiberrcd         pic x(4).
  1423     02  eibsynrb         pic x(1).
  1424     02  eibnodat         pic x(1).
  1425     02  eibfiller5       pic x(2).
  1426     02  eibresp          pic 9(09) comp.
  1427     02  eibresp2         pic 9(09) comp.
  1428     02  dfheigdj         pic s9(4) comp.
  1429     02  dfheigdk         pic s9(4) comp.
  1430
  1431 01  DFHCOMMAREA                     PIC X(1024).
  1432
  1433*01 DFHBLLDS                         COMP SYNC.
  1434*    05  BLLCBAR                     PIC S9(9).
  1435*    05  CQFCBAR                     PIC S9(9).
  1436*    05  CFCBAR                      PIC S9(9).
  1437*    05  PPFCBAR                     PIC S9(9).
  1438*    05  CMFCBAR                     PIC S9(9).
  1439*    05  CHFCBAR                     PIC S9(9).
  1440
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL687.cbl
  1442*                            COPY ERCCHKQ.
  1443******************************************************************
  1444*                                                                *
  1445*                                                                *
  1446*                            ERCCHKQ                             *
  1447*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1448*                            VMOD=2.005                          *
  1449*                                                                *
  1450*   FILE DESCRIPTION = CHECK QUE FILE FOR THE CREDIT SYSTEM      *
  1451*                                                                *
  1452*   FILE TYPE = VSAM,KSDS                                        *
  1453*   RECORD SIZE = 100  RECFORM = FIXED                           *
  1454*                                                                *
  1455*   BASE CLUSTER = ERCHKQ                         RKP=2,LEN=7    *
  1456*       ALTERNATE PATH  = NONE                                   *
  1457*                                                                *
  1458*   LOG = YES                                                    *
  1459*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1460******************************************************************
  1461 01  CHECK-QUE.
  1462     12  CQ-RECORD-ID                PIC XX.
  1463         88  VALID-CQ-ID                     VALUE 'CQ'.
  1464
  1465     12  CQ-CONTROL-PRIMARY.
  1466         16  CQ-COMPANY-CD           PIC X.
  1467         16  CQ-CONTROL-NUMBER       PIC S9(8)       COMP.
  1468         16  CQ-SEQUENCE-NUMBER      PIC S9(4)       COMP.
  1469
  1470     12  CQ-ENTRY-TYPE               PIC X.
  1471             88  CHECK-ON-QUE           VALUE 'Q'.
  1472             88  ALIGNMENT-CHECK        VALUE 'A'.
  1473             88  MANUAL-CHECK           VALUE 'M'.
  1474             88  SPOILED-CHECK          VALUE 'S'.
  1475             88  VOIDED-CHECK           VALUE 'V'.
  1476             88  PAYMENT-ABORTED        VALUE 'X'.
  1477
  1478     12  CQ-CREDIT-MASTER-CNTL       PIC X(50).
  1479
  1480     12  CQ-CREDIT-PYAJ-CNTL         REDEFINES
  1481         CQ-CREDIT-MASTER-CNTL.
  1482         16  CQ-PYAJ-CARRIER         PIC X.
  1483         16  CQ-PYAJ-GROUPING        PIC X(6).
  1484         16  CQ-PYAJ-FIN-RESP        PIC X(10).
  1485         16  CQ-PYAJ-ACCOUNT         PIC X(10).
  1486         16  CQ-PYAJ-SEQ             PIC S9(8)  COMP.
  1487         16  CQ-PYAJ-REC-TYPE        PIC X.
  1488         16  FILLER                  PIC X(18).
  1489
  1490     12  CQ-CREDIT-CHEK-CNTL         REDEFINES
  1491         CQ-CREDIT-MASTER-CNTL.
  1492         16  CQ-CHEK-CARRIER         PIC X.
  1493         16  CQ-CHEK-GROUPING        PIC X(6).
  1494         16  CQ-CHEK-STATE           PIC XX.
  1495         16  CQ-CHEK-ACCOUNT         PIC X(10).
  1496         16  CQ-CHEK-CERT-EFF-DT     PIC XX.
  1497         16  CQ-CHEK-CERT-NO.
  1498             20  CQ-CHEK-CERT-PRIME  PIC X(10).
  1499             20  CQ-CHEK-CERT-SFX    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL687.cbl
  1500         16  CQ-CHEK-SEQ-NO          PIC S9(4)       COMP.
  1501         16  CQ-CHEK-FIN-RESP        PIC X(10).
  1502         16  FILLER                  PIC X(06).
  1503
  1504     12  CQ-CHECK-NUMBER             PIC X(7).
  1505     12  CQ-CHECK-AMOUNT             PIC S9(7)V99    COMP-3.
  1506     12  CQ-PAYMENT-TYPE             PIC X.
  1507             88  CQ-BILLING-CREDIT         VALUE '1'.
  1508             88  CQ-REFUND-PMT             VALUE '2'.
  1509             88  CQ-CHECK-MAINT-PMT        VALUE '3'.
  1510     12  CQ-VOID-INDICATOR           PIC X.
  1511             88  CHECK-IS-VOID             VALUE 'V'.
  1512     12  CQ-TIMES-PRINTED            PIC S9(4)       COMP.
  1513     12  CQ-PRINT-AT-HHMM            PIC S9(4)       COMP.
  1514     12  CQ-CHECK-BY-USER            PIC X(4).
  1515     12  CQ-PRE-NUMBERING-SW         PIC X.
  1516       88  CHECKS-WERE-NOT-PRE-NUMBERED    VALUE SPACE.
  1517       88  CHECKS-WERE-PRE-NUMBERED        VALUE '1'.
  1518
  1519     12  CQ-CHECK-WRITTEN-DT         PIC XX.
  1520     12  CQ-LAST-UPDATED-BY          PIC S9(4)       COMP.
  1521     12  CQ-ACCOUNT-AGENT            PIC X(10).
  1522     12  CQ-CHECK-VOIDED-DT          PIC XX.
  1523
  1524     12  CQ-LETTERS-IND              PIC X.
  1525         88  CQ-LETTERS-REQUIRED           VALUE 'Y'.
  1526
  1527******************************************************************
  1528
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL687.cbl
  1530*                            COPY ELCCNTL.
  1531******************************************************************
  1532*                                                                *
  1533*                                                                *
  1534*                            ELCCNTL.                            *
  1535*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1536*                            VMOD=2.059                          *
  1537*                                                                *
  1538*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1539*                                                                *
  1540*   FILE TYPE = VSAM,KSDS                                        *
  1541*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1542*                                                                *
  1543*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1544*       ALTERNATE INDEX = NONE                                   *
  1545*                                                                *
  1546*   LOG = YES                                                    *
  1547*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1548******************************************************************
  1549*                   C H A N G E   L O G
  1550*
  1551* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1552*-----------------------------------------------------------------
  1553*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1554* EFFECTIVE    NUMBER
  1555*-----------------------------------------------------------------
  1556* 082503                   PEMA  ADD BENEFIT GROUP
  1557* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1558* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1559* 092705    2005050300006  PEMA  ADD SPP LEASES
  1560* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1561* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1562* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1563* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1564* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1565******************************************************************
  1566*
  1567 01  CONTROL-FILE.
  1568     12  CF-RECORD-ID                       PIC XX.
  1569         88  VALID-CF-ID                        VALUE 'CF'.
  1570
  1571     12  CF-CONTROL-PRIMARY.
  1572         16  CF-COMPANY-ID                  PIC XXX.
  1573         16  CF-RECORD-TYPE                 PIC X.
  1574             88  CF-COMPANY-MASTER              VALUE '1'.
  1575             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1576             88  CF-STATE-MASTER                VALUE '3'.
  1577             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1578             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1579             88  CF-CARRIER-MASTER              VALUE '6'.
  1580             88  CF-MORTALITY-MASTER            VALUE '7'.
  1581             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1582             88  CF-TERMINAL-MASTER             VALUE '9'.
  1583             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1584             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1585             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1586             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1587             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL687.cbl
  1588             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1589             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1590             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1591             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1592         16  CF-ACCESS-CD-GENL              PIC X(4).
  1593         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1594             20  CF-PROCESSOR               PIC X(4).
  1595         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1596             20  CF-STATE-CODE              PIC XX.
  1597             20  FILLER                     PIC XX.
  1598         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1599             20  FILLER                     PIC XX.
  1600             20  CF-HI-BEN-IN-REC           PIC XX.
  1601         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1602             20  FILLER                     PIC XXX.
  1603             20  CF-CARRIER-CNTL            PIC X.
  1604         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1605             20  FILLER                     PIC XX.
  1606             20  CF-HI-TYPE-IN-REC          PIC 99.
  1607         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1608             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1609                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1610             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1611             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1612         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1613             20  FILLER                     PIC X.
  1614             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1615         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1616             20  FILLER                     PIC XX.
  1617             20  CF-MORTGAGE-PLAN           PIC XX.
  1618         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1619
  1620     12  CF-LAST-MAINT-DT                   PIC XX.
  1621     12  CF-LAST-MAINT-BY                   PIC X(4).
  1622     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1623
  1624     12  CF-RECORD-BODY                     PIC X(728).
  1625
  1626
  1627****************************************************************
  1628*             COMPANY MASTER RECORD                            *
  1629****************************************************************
  1630
  1631     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1632         16  CF-COMPANY-ADDRESS.
  1633             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1634             20  CF-CL-IN-CARE-OF           PIC X(30).
  1635             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1636             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1637             20  CF-CL-CITY-STATE           PIC X(30).
  1638             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1639             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1640         16  CF-COMPANY-CD                  PIC X.
  1641         16  CF-COMPANY-PASSWORD            PIC X(8).
  1642         16  CF-SECURITY-OPTION             PIC X.
  1643             88  ALL-SECURITY                   VALUE '1'.
  1644             88  COMPANY-VERIFY                 VALUE '2'.
  1645             88  PROCESSOR-VERIFY               VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL687.cbl
  1646             88  NO-SECURITY                    VALUE '4'.
  1647             88  ALL-BUT-TERM                   VALUE '5'.
  1648         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1649             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1650         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1651             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1652         16  CF-INFORCE-LOCATION            PIC X.
  1653             88  CERTS-ARE-ONLINE               VALUE '1'.
  1654             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1655             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1656         16  CF-LOWER-CASE-LETTERS          PIC X.
  1657         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1658             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1659             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1660             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1661             88  CF-ACCNT-CNTL                  VALUE '3'.
  1662             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1663
  1664         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1665         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1666
  1667         16  CF-LGX-CREDIT-USER             PIC X.
  1668             88  CO-IS-NOT-USER                 VALUE 'N'.
  1669             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1670
  1671         16 CF-CREDIT-CALC-CODES.
  1672             20  CF-CR-REM-TERM-CALC PIC X.
  1673               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1674               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1675               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1676               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1677               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1678               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1679               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1680             20  CF-CR-R78-METHOD           PIC X.
  1681               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1682               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1683
  1684         16  CF-CLAIM-CONTROL-COUNTS.
  1685             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1686                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1687
  1688             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1689                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1690
  1691             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1692                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1693
  1694             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1695                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1696
  1697         16  CF-CURRENT-MONTH-END           PIC XX.
  1698
  1699         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1700             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1701             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1702             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1703             20  CF-CO-CLAIM-REJECT-SW      PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL687.cbl
  1704                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1705                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1706             20  CF-CO-PREM-REJECT-SW       PIC X.
  1707                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1708                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1709             20  CF-CO-REF-REJECT-SW        PIC X.
  1710                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1711                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1712
  1713         16  CF-CO-REPORTING-DT             PIC XX.
  1714         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1715         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1716           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1717           88  CF-CO-MONTH-END                  VALUE '1'.
  1718
  1719         16  CF-LGX-CLAIM-USER              PIC X.
  1720             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1721             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1722
  1723         16  CF-CREDIT-EDIT-CONTROLS.
  1724             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1725             20  CF-MIN-AGE                 PIC 99.
  1726             20  CF-DEFAULT-AGE             PIC 99.
  1727             20  CF-MIN-TERM                PIC S999      COMP-3.
  1728             20  CF-MAX-TERM                PIC S999      COMP-3.
  1729             20  CF-DEFAULT-SEX             PIC X.
  1730             20  CF-JOINT-AGE-INPUT         PIC X.
  1731                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1732             20  CF-BIRTH-DATE-INPUT        PIC X.
  1733                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1734             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1735                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1736                 88  CF-ZERO-CARRIER            VALUE '1'.
  1737                 88  CF-ZERO-GROUPING           VALUE '2'.
  1738                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1739             20  CF-EDIT-SW                 PIC X.
  1740                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1741             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1742             20  CF-CR-PR-METHOD            PIC X.
  1743               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1744               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1745             20  FILLER                     PIC X.
  1746
  1747         16  CF-CREDIT-MISC-CONTROLS.
  1748             20  CF-REIN-TABLE-SW           PIC X.
  1749                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1750             20  CF-COMP-TABLE-SW           PIC X.
  1751                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1752             20  CF-EXPERIENCE-RETENTION-AGE
  1753                                            PIC S9        COMP-3.
  1754             20  CF-CONVERSION-DT           PIC XX.
  1755             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1756             20  CF-RUN-FREQUENCY-SW        PIC X.
  1757                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1758                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1759
  1760             20  CF-CR-CHECK-NO-CONTROL.
  1761                 24  CF-CR-CHECK-NO-METHOD    PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL687.cbl
  1762                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1763                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1764                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1765                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1766                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1767
  1768                 24  CF-CR-CHECK-COUNT       REDEFINES
  1769                     CF-CR-CHECK-COUNTER      PIC X(4).
  1770
  1771                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1772                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1773
  1774                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1775                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1776                 24  CF-MAIL-PROCESSING       PIC X.
  1777                     88  MAIL-PROCESSING          VALUE 'Y'.
  1778
  1779         16  CF-MISC-SYSTEM-CONTROL.
  1780             20  CF-SYSTEM-C                 PIC X.
  1781                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1782             20  CF-SYSTEM-D                 PIC X.
  1783                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1784             20  CF-SOC-SEC-NO-SW            PIC X.
  1785                 88  SOC-SEC-NO-USED             VALUE '1'.
  1786             20  CF-MEMBER-NO-SW             PIC X.
  1787                 88  MEMBER-NO-USED              VALUE '1'.
  1788             20  CF-TAX-ID-NUMBER            PIC X(11).
  1789             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1790             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1791                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1792                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1793                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1794                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1795             20  CF-SYSTEM-E                 PIC X.
  1796                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1797
  1798         16  CF-LGX-LIFE-USER               PIC X.
  1799             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1800             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1801
  1802         16  CF-CR-MONTH-END-DT             PIC XX.
  1803
  1804         16  CF-FILE-MAINT-DATES.
  1805             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1806                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1807             20  CF-LAST-BATCH       REDEFINES
  1808                 CF-LAST-BATCH-NO               PIC X(4).
  1809             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1810             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1811             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1812             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1813             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1814             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1815             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1816             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1817             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1818             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1819
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL687.cbl
  1820         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1821         16  FILLER                         PIC X.
  1822
  1823         16  CF-ALT-MORT-CODE               PIC X(4).
  1824         16  CF-MEMBER-CAPTION              PIC X(10).
  1825
  1826         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1827             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1828             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1829             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1830             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1831             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1832
  1833         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1834
  1835         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1836         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1837         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1838         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1839
  1840         16  CF-AH-OVERRIDE-L1              PIC X.
  1841         16  CF-AH-OVERRIDE-L2              PIC XX.
  1842         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1843         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1844
  1845         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1846         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1847
  1848         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1849         16  CF-AR-LAST-EL860-DT            PIC XX.
  1850         16  CF-MP-MONTH-END-DT             PIC XX.
  1851
  1852         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1853         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1854             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1855
  1856         16  CF-AR-MONTH-END-DT             PIC XX.
  1857
  1858         16  CF-CRDTCRD-USER                PIC X.
  1859             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1860             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1861
  1862         16  CF-CC-MONTH-END-DT             PIC XX.
  1863
  1864         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1865
  1866         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1867             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1868             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1869             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1870         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1871         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1872         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1873         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1874             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1875             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1876         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1877         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL687.cbl
  1878         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1879             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1880         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1881
  1882         16  CF-CL-ZIP-CODE.
  1883             20  CF-CL-ZIP-PRIME.
  1884                 24  CF-CL-ZIP-1ST          PIC X.
  1885                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1886                 24  FILLER                 PIC X(4).
  1887             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1888         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1889             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1890             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1891             20  FILLER                     PIC XXX.
  1892
  1893         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1894         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1895         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1896         16  CF-CO-OPTION-START-DATE        PIC XX.
  1897         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1898           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1899                                                      '3' '4'.
  1900           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1901           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1902           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1903           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1904           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1905           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1906
  1907         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1908
  1909         16  CF-PAYMENT-APPROVAL-LEVELS.
  1910             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1911             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1912             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1913             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1914             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1915             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1916
  1917         16  CF-END-USER-REPORTING-USER     PIC X.
  1918             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1919             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1920
  1921         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1922             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1923             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1924
  1925         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1926
  1927         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1928         16  FILLER                         PIC X.
  1929
  1930         16  CF-CREDIT-ARCHIVE-CNTL.
  1931             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1932             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1933             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1934
  1935         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL687.cbl
  1936
  1937         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1938             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1939             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1940
  1941         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1942             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1943             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1944
  1945         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1946
  1947         16  CF-CO-ACH-ID-CODE              PIC  X.
  1948             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1949             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1950             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1951         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1952         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1953         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1954         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1955         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1956         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1957         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1958         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1959         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1960                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1961         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1962                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1963
  1964         16  CF-CO-OVER-SHORT.
  1965             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1966             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1967
  1968*         16  FILLER                         PIC X(102).
  1969         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1970             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1971             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1972
  1973         16  CF-AH-APPROVAL-DAYS.
  1974             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1975             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1976             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1977             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1978
  1979         16  FILLER                         PIC X(82).
  1980****************************************************************
  1981*             PROCESSOR/USER RECORD                            *
  1982****************************************************************
  1983
  1984     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1985         16  CF-PROCESSOR-NAME              PIC X(30).
  1986         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1987         16  CF-PROCESSOR-TITLE             PIC X(26).
  1988         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1989                 88  MESSAGE-YES                VALUE 'Y'.
  1990                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1991
  1992*****************************************************
  1993****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL687.cbl
  1994****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1995****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1996****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1997*****************************************************
  1998
  1999         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2000             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2001             20  CF-APPLICATION-FORCE       PIC X.
  2002             20  CF-INDIVIDUAL-APP.
  2003                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2004                     28  CF-BROWSE-APP      PIC X.
  2005                     28  CF-UPDATE-APP      PIC X.
  2006
  2007         16  CF-CURRENT-TERM-ON             PIC X(4).
  2008         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2009             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2010             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2011             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2012             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2013             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2014             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2015             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2016         16  CF-PROCESSOR-CARRIER           PIC X.
  2017             88  NO-CARRIER-SECURITY            VALUE ' '.
  2018         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2019             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2020         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2021             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2022         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2023             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2024
  2025         16  CF-PROC-SYS-ACCESS-SW.
  2026             20  CF-PROC-CREDIT-CLAIMS-SW.
  2027                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2028                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2029                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2030                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2031             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2032                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2033                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2034             20  CF-PROC-LIFE-GNRLDGR-SW.
  2035                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2036                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2037                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2038                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2039             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2040                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2041                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2042         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2043             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2044             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2045         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2046
  2047         16  CF-APPROVAL-LEVEL                  PIC X.
  2048             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2049             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2050             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2051             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL687.cbl
  2052
  2053         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2054
  2055         16  CF-LANGUAGE-TYPE                   PIC X.
  2056             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2057             88  CF-LANG-IS-FR                      VALUE 'F'.
  2058         16  FILLER                             PIC  X(240).
  2059
  2060****************************************************************
  2061*             PROCESSOR/REMINDERS RECORD                       *
  2062****************************************************************
  2063
  2064     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2065         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2066             20  CF-START-REMIND-DT         PIC XX.
  2067             20  CF-END-REMIND-DT           PIC XX.
  2068             20  CF-REMINDER-TEXT           PIC X(50).
  2069         16  FILLER                         PIC X(296).
  2070
  2071
  2072****************************************************************
  2073*             STATE MASTER RECORD                              *
  2074****************************************************************
  2075
  2076     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2077         16  CF-STATE-ABBREVIATION          PIC XX.
  2078         16  CF-STATE-NAME                  PIC X(25).
  2079         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2080         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2081             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2082             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2083             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2084             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2085                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2086                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2087             20  CF-ST-PREM-REJECT-SW       PIC X.
  2088                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2089                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2090             20  CF-ST-REF-REJECT-SW        PIC X.
  2091                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2092                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2093         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2094         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2095         16  CF-ST-REFUND-RULES.
  2096             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2097             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2098             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2099         16  CF-ST-FST-PMT-EXTENSION.
  2100             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2101             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2102                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2103                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2104                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2105                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2106         16  CF-ST-STATE-CALL.
  2107             20  CF-ST-CALL-UNEARNED        PIC X.
  2108             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2109             20  CF-ST-CALL-RATE-DEV        PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL687.cbl
  2110         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2111             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2112             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2113         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2114         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2115         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2116         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2117         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2118         16  FILLER                         PIC X.
  2119         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2120             20  CF-ST-BENEFIT-CD           PIC XX.
  2121             20  CF-ST-BENEFIT-KIND         PIC X.
  2122                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  2123                 88  CF-ST-AH-KIND              VALUE 'A'.
  2124             20  CF-ST-REM-TERM-CALC        PIC X.
  2125                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  2126                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  2127                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  2128                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  2129                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  2130                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  2131                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  2132                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  2133
  2134             20  CF-ST-REFUND-CALC          PIC X.
  2135                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  2136                 88  ST-REFD-BY-R78             VALUE '1'.
  2137                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  2138                 88  ST-REFD-AS-CALIF           VALUE '3'.
  2139                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  2140                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  2141                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  2142                 88  ST-REFD-UTAH               VALUE '7'.
  2143                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  2144                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  2145                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  2146
  2147             20  CF-ST-EARNING-CALC         PIC X.
  2148                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  2149                 88  ST-EARN-BY-R78             VALUE '1'.
  2150                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  2151                 88  ST-EARN-AS-CALIF           VALUE '3'.
  2152                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  2153                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  2154                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  2155                 88  ST-EARN-MEAN               VALUE '8'.
  2156                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  2157
  2158             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  2159                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  2160                 88  ST-OVRD-BY-R78             VALUE '1'.
  2161                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  2162                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  2163                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  2164                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  2165                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  2166                 88  ST-OVRD-MEAN               VALUE '8'.
  2167                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL687.cbl
  2168             20  FILLER                     PIC X.
  2169
  2170         16  CF-ST-COMMISSION-CAPS.
  2171             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  2172             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  2173             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  2174             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  2175         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  2176                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  2177
  2178         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  2179
  2180         16  CF-ST-STATUTORY-INTEREST.
  2181             20  CF-ST-STAT-DATE-FROM       PIC X.
  2182                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  2183                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  2184             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  2185             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  2186             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  2187             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  2188             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  2189
  2190         16  CF-ST-OVER-SHORT.
  2191             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  2192             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  2193
  2194         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  2195
  2196         16  CF-ST-RT-CALC                  PIC X.
  2197
  2198         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2199         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2200         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2201         16  CF-ST-RF-LR-CALC               PIC X.
  2202         16  CF-ST-RF-LL-CALC               PIC X.
  2203         16  CF-ST-RF-LN-CALC               PIC X.
  2204         16  CF-ST-RF-AH-CALC               PIC X.
  2205         16  CF-ST-RF-CP-CALC               PIC X.
  2206*        16  FILLER                         PIC X(206).
  2207*CIDMOD         16  FILLER                         PIC X(192).
  2208         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2209             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2210         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2211         16  CF-ST-VFY-2ND-BENE             PIC X.
  2212         16  FILLER                         PIC X(186).
  2213
  2214****************************************************************
  2215*             BENEFIT MASTER RECORD                            *
  2216****************************************************************
  2217
  2218     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2219         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2220             20  CF-BENEFIT-CODE            PIC XX.
  2221             20  CF-BENEFIT-NUMERIC  REDEFINES
  2222                 CF-BENEFIT-CODE            PIC XX.
  2223             20  CF-BENEFIT-ALPHA           PIC XXX.
  2224             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2225             20  CF-BENEFIT-COMMENT         PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL687.cbl
  2226
  2227             20  CF-LF-COVERAGE-TYPE        PIC X.
  2228                 88  CF-REDUCING                VALUE 'R'.
  2229                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2230
  2231             20  CF-SPECIAL-CALC-CD         PIC X.
  2232                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2233                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2234                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2235                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2236                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2237                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2238                 88  CF-FARM-PLAN               VALUE 'F'.
  2239                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2240                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2241                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2242                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2243                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2244                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2245                 88  CF-PRUDENTIAL              VALUE 'P'.
  2246                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2247                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2248                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2249                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2250                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2251                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2252
  2253             20  CF-JOINT-INDICATOR         PIC X.
  2254                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2255
  2256*            20  FILLER                     PIC X(12).
  2257             20  FILLER                     PIC X(11).
  2258             20  CF-BENEFIT-CATEGORY        PIC X.
  2259             20  CF-LOAN-TYPE               PIC X(8).
  2260
  2261             20  CF-CO-REM-TERM-CALC        PIC X.
  2262                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2263                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2264                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2265                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2266                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2267
  2268             20  CF-CO-EARNINGS-CALC        PIC X.
  2269                 88  CO-EARN-BY-R78             VALUE '1'.
  2270                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2271                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2272                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2273                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2274                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2275                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2276                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2277
  2278             20  CF-CO-REFUND-CALC          PIC X.
  2279                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2280                 88  CO-REFD-BY-R78             VALUE '1'.
  2281                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2282                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2283                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL687.cbl
  2284                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2285                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2286                 88  CO-REFD-MEAN               VALUE '8'.
  2287                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2288                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2289                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2290
  2291             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2292                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2293                 88  CO-OVRD-BY-R78             VALUE '1'.
  2294                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2295                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2296                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2297                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2298                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2299                 88  CO-OVRD-MEAN               VALUE '8'.
  2300                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2301
  2302             20  CF-CO-BEN-I-G-CD           PIC X.
  2303                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2304                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2305                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2306
  2307         16  FILLER                         PIC X(304).
  2308
  2309
  2310****************************************************************
  2311*             CARRIER MASTER RECORD                            *
  2312****************************************************************
  2313
  2314     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2315         16  CF-ADDRESS-DATA.
  2316             20  CF-MAIL-TO-NAME            PIC X(30).
  2317             20  CF-IN-CARE-OF              PIC X(30).
  2318             20  CF-ADDRESS-LINE-1          PIC X(30).
  2319             20  CF-ADDRESS-LINE-2          PIC X(30).
  2320             20  CF-CITY-STATE              PIC X(30).
  2321             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2322             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2323
  2324         16  CF-CLAIM-NO-CONTROL.
  2325             20  CF-CLAIM-NO-METHOD         PIC X.
  2326                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2327                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2328                 88  CLAIM-NO-SEQ               VALUE '3'.
  2329                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2330             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2331                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2332                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2333                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2334
  2335         16  CF-CHECK-NO-CONTROL.
  2336             20  CF-CHECK-NO-METHOD         PIC X.
  2337                 88  CHECK-NO-MANUAL            VALUE '1'.
  2338                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2339                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2340                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2341             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL687.cbl
  2342                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2343
  2344         16  CF-DOMICILE-STATE              PIC XX.
  2345
  2346         16  CF-EXPENSE-CONTROLS.
  2347             20  CF-EXPENSE-METHOD          PIC X.
  2348                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2349                 88  DOLLARS-PER-PMT            VALUE '2'.
  2350                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2351                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2352             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2353             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2354
  2355         16  CF-CORRESPONDENCE-CONTROL.
  2356             20  CF-LETTER-RESEND-OPT       PIC X.
  2357                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2358                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2359             20  FILLER                     PIC X(4).
  2360
  2361         16  CF-RESERVE-CONTROLS.
  2362             20  CF-MANUAL-SW               PIC X.
  2363                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2364             20  CF-FUTURE-SW               PIC X.
  2365                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2366             20  CF-PTC-SW                  PIC X.
  2367                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2368             20  CF-IBNR-SW                 PIC X.
  2369                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2370             20  CF-PTC-LF-SW               PIC X.
  2371                 88  CF-LF-PTC-USED             VALUE '1'.
  2372             20  CF-CDT-ACCESS-METHOD       PIC X.
  2373                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2374                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  2375                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2376             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2377
  2378         16  CF-CLAIM-CALC-METHOD           PIC X.
  2379             88  360-PLUS-MONTHS                VALUE '1'.
  2380             88  365-PLUS-MONTHS                VALUE '2'.
  2381             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2382             88  360-DAILY                      VALUE '4'.
  2383             88  365-DAILY                      VALUE '5'.
  2384
  2385         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2386         16  FILLER                         PIC X(11).
  2387
  2388         16  CF-LIMIT-AMOUNTS.
  2389             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2390             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2391             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2392             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2393             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2394             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2395             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2396             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2397             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2398             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2399
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL687.cbl
  2400         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2401         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2402         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2403
  2404         16  CF-ZIP-CODE.
  2405             20  CF-ZIP-PRIME.
  2406                 24  CF-ZIP-1ST             PIC X.
  2407                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2408                 24  FILLER                 PIC X(4).
  2409             20  CF-ZIP-PLUS4               PIC X(4).
  2410         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2411             20  CF-CAN-POSTAL-1            PIC XXX.
  2412             20  CF-CAN-POSTAL-2            PIC XXX.
  2413             20  FILLER                     PIC XXX.
  2414
  2415         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2416         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2417         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2418
  2419         16  CF-RATING-SWITCH               PIC X.
  2420             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2421             88  CF-NO-RATING                   VALUE 'N'.
  2422
  2423         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2424
  2425         16  CF-CARRIER-OVER-SHORT.
  2426             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2427             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2428
  2429         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2430         16  CF-SECPAY-SWITCH               PIC X.
  2431             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2432             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2433         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2434         16  FILLER                         PIC X(448).
  2435*        16  FILLER                         PIC X(452).
  2436
  2437
  2438****************************************************************
  2439*             MORTALITY MASTER RECORD                          *
  2440****************************************************************
  2441
  2442     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2443         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2444                                INDEXED BY CF-MORT-NDX.
  2445             20  CF-MORT-TABLE              PIC X(5).
  2446             20  CF-MORT-TABLE-TYPE         PIC X.
  2447                 88  CF-MORT-JOINT              VALUE 'J'.
  2448                 88  CF-MORT-SINGLE             VALUE 'S'.
  2449                 88  CF-MORT-COMBINED           VALUE 'C'.
  2450                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2451                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2452             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2453             20  CF-MORT-AGE-METHOD         PIC XX.
  2454                 88  CF-AGE-LAST                VALUE 'AL'.
  2455                 88  CF-AGE-NEAR                VALUE 'AN'.
  2456             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2457             20  CF-MORT-ADJUSTMENT-DIRECTION
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL687.cbl
  2458                                            PIC X.
  2459                 88  CF-MINUS                   VALUE '-'.
  2460                 88  CF-PLUS                    VALUE '+'.
  2461             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2462             20  CF-MORT-JOINT-CODE         PIC X.
  2463                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2464             20  CF-MORT-PC-Q               PIC X.
  2465                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2466             20  CF-MORT-TABLE-CODE         PIC X(4).
  2467             20  CF-MORT-COMMENTS           PIC X(15).
  2468             20  FILLER                     PIC X(14).
  2469
  2470         16  FILLER                         PIC X(251).
  2471
  2472
  2473****************************************************************
  2474*             BUSSINESS TYPE MASTER RECORD                     *
  2475****************************************************************
  2476
  2477     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2478* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2479* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2480* AND RECORD 05 IS TYPES 81-99
  2481         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2482             20  CF-BUSINESS-TITLE          PIC  X(19).
  2483             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2484                                            PIC S9V9(4) COMP-3.
  2485             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2486             20  FILLER                     PIC  X.
  2487         16  FILLER                         PIC  X(248).
  2488
  2489
  2490****************************************************************
  2491*             TERMINAL MASTER RECORD                           *
  2492****************************************************************
  2493
  2494     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2495
  2496         16  CF-COMPANY-TERMINALS.
  2497             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2498                                  PIC X(4).
  2499         16  FILLER               PIC X(248).
  2500
  2501
  2502****************************************************************
  2503*             LIFE EDIT MASTER RECORD                          *
  2504****************************************************************
  2505
  2506     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2507         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2508             20  CF-LIFE-CODE-IN            PIC XX.
  2509             20  CF-LIFE-CODE-OUT           PIC XX.
  2510         16  FILLER                         PIC X(248).
  2511
  2512
  2513****************************************************************
  2514*             AH EDIT MASTER RECORD                            *
  2515****************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL687.cbl
  2516
  2517     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2518         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2519             20  CF-AH-CODE-IN              PIC XXX.
  2520             20  CF-AH-CODE-OUT             PIC XX.
  2521         16  FILLER                         PIC X(248).
  2522
  2523
  2524****************************************************************
  2525*             CREDIBILITY TABLES                               *
  2526****************************************************************
  2527
  2528     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2529         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2530                             INDEXED BY CF-CRDB-NDX.
  2531             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2532             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2533             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2534         16  FILLER                         PIC  X(332).
  2535
  2536
  2537****************************************************************
  2538*             REPORT CUSTOMIZATION RECORD                      *
  2539****************************************************************
  2540
  2541     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2542         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2543             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2544             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2545             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2546**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2547****       A T-TRANSFER.                                   ****
  2548             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2549
  2550         16  FILLER                         PIC XX.
  2551
  2552         16  CF-CARRIER-CNTL-OPT.
  2553             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2554                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2555                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2556             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2557                                            PIC X.
  2558         16  CF-GROUP-CNTL-OPT.
  2559             20  CF-GROUP-OPT-SEQ           PIC 9.
  2560                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2561                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2562             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2563                                            PIC X(6).
  2564         16  CF-STATE-CNTL-OPT.
  2565             20  CF-STATE-OPT-SEQ           PIC 9.
  2566                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2567                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2568             20  CF-STATE-SELECT OCCURS 3 TIMES
  2569                                            PIC XX.
  2570         16  CF-ACCOUNT-CNTL-OPT.
  2571             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2572                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2573                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL687.cbl
  2574             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2575                                            PIC X(10).
  2576         16  CF-BUS-TYP-CNTL-OPT.
  2577             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2578                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2579                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2580             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2581                                            PIC XX.
  2582         16  CF-LF-TYP-CNTL-OPT.
  2583             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2584                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2585                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2586             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2587                                            PIC XX.
  2588         16  CF-AH-TYP-CNTL-OPT.
  2589             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2590                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2591                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2592             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2593                                            PIC XX.
  2594         16  CF-REPTCD1-CNTL-OPT.
  2595             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2596                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2597                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2598             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2599                                            PIC X(10).
  2600         16  CF-REPTCD2-CNTL-OPT.
  2601             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2602                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2603                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2604             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2605                                            PIC X(10).
  2606         16  CF-USER1-CNTL-OPT.
  2607             20  CF-USER1-OPT-SEQ           PIC 9.
  2608                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2609                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2610             20  CF-USER1-SELECT OCCURS 3 TIMES
  2611                                            PIC X(10).
  2612         16  CF-USER2-CNTL-OPT.
  2613             20  CF-USER2-OPT-SEQ           PIC 9.
  2614                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2615                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2616             20  CF-USER2-SELECT OCCURS 3 TIMES
  2617                                            PIC X(10).
  2618         16  CF-USER3-CNTL-OPT.
  2619             20  CF-USER3-OPT-SEQ           PIC 9.
  2620                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2621                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2622             20  CF-USER3-SELECT OCCURS 3 TIMES
  2623                                            PIC X(10).
  2624         16  CF-USER4-CNTL-OPT.
  2625             20  CF-USER4-OPT-SEQ           PIC 9.
  2626                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2627                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2628             20  CF-USER4-SELECT OCCURS 3 TIMES
  2629                                            PIC X(10).
  2630         16  CF-USER5-CNTL-OPT.
  2631             20  CF-USER5-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL687.cbl
  2632                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2633                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2634             20  CF-USER5-SELECT OCCURS 3 TIMES
  2635                                            PIC X(10).
  2636         16  CF-REINS-CNTL-OPT.
  2637             20  CF-REINS-OPT-SEQ           PIC 9.
  2638                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2639                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2640             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2641                 24  CF-REINS-PRIME         PIC XXX.
  2642                 24  CF-REINS-SUB           PIC XXX.
  2643
  2644         16  CF-AGENT-CNTL-OPT.
  2645             20  CF-AGENT-OPT-SEQ           PIC 9.
  2646                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2647                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2648             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2649                                            PIC X(10).
  2650
  2651         16  FILLER                         PIC X(43).
  2652
  2653         16  CF-LOSS-RATIO-SELECT.
  2654             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2655             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2656         16  CF-ENTRY-DATE-SELECT.
  2657             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2658             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2659         16  CF-EFFECTIVE-DATE-SELECT.
  2660             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2661             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2662
  2663         16  CF-EXCEPTION-LIST-IND          PIC X.
  2664             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2665
  2666         16  FILLER                         PIC X(318).
  2667
  2668****************************************************************
  2669*                  EXCEPTION REPORTING RECORD                  *
  2670****************************************************************
  2671
  2672     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2673         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2674             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2675
  2676         16  CF-COMBINED-LIFE-AH-OPT.
  2677             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2678             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2679             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2680             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2681
  2682         16  CF-LIFE-OPT.
  2683             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2684             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2685             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2686             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2687             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2688             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2689             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL687.cbl
  2690             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2691             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2692             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2693
  2694         16  CF-AH-OPT.
  2695             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2696             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2697             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2698             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2699             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2700             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2701             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2702             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2703             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2704             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2705
  2706         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2707             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2708             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2709             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2710
  2711         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2712
  2713         16  FILLER                         PIC X(673).
  2714
  2715
  2716****************************************************************
  2717*             MORTGAGE SYSTEM PLAN RECORD                      *
  2718****************************************************************
  2719
  2720     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2721         16  CF-PLAN-TYPE                   PIC X.
  2722             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2723             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2724             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2725         16  CF-PLAN-ABBREV                 PIC XXX.
  2726         16  CF-PLAN-DESCRIPT               PIC X(10).
  2727         16  CF-PLAN-NOTES                  PIC X(20).
  2728         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2729         16  CF-PLAN-UNDERWRITING.
  2730             20  CF-PLAN-TERM-DATA.
  2731                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2732                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2733             20  CF-PLAN-AGE-DATA.
  2734                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2735                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2736                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2737             20  CF-PLAN-BENEFIT-DATA.
  2738                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2739                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2740                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2741                                            PIC S9(7)V99  COMP-3.
  2742         16  CF-PLAN-POLICY-FORMS.
  2743             20  CF-POLICY-FORM             PIC X(12).
  2744             20  CF-MASTER-APPLICATION      PIC X(12).
  2745             20  CF-MASTER-POLICY           PIC X(12).
  2746         16  CF-PLAN-RATING.
  2747             20  CF-RATE-CODE               PIC X(5).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL687.cbl
  2748             20  CF-SEX-RATING              PIC X.
  2749                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2750                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2751             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2752             20  CF-SUB-STD-TYPE            PIC X.
  2753                 88  CF-PCT-OF-PREM            VALUE '1'.
  2754                 88  CF-PCT-OF-BENE            VALUE '2'.
  2755         16  CF-PLAN-PREM-TOLERANCES.
  2756             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2757             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2758         16  CF-PLAN-PYMT-TOLERANCES.
  2759             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2760             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2761         16  CF-PLAN-MISC-DATA.
  2762             20  FILLER                     PIC X.
  2763             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2764             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2765         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2766         16  CF-PLAN-IND-GRP                PIC X.
  2767             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2768                                                     '1'.
  2769             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2770                                                     '2'.
  2771         16  CF-MIB-SEARCH-SW               PIC X.
  2772             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2773             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2774             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2775             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2776         16  CF-ALPHA-SEARCH-SW             PIC X.
  2777             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2778             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2779             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2780             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2781             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2782             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2783             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2784             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2785             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2786             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2787                                                     'A' 'B' 'C'
  2788                                                     'X' 'Y' 'Z'.
  2789         16  CF-EFF-DT-RULE-SW              PIC X.
  2790             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2791             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2792             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2793             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2794             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2795         16  FILLER                         PIC X(4).
  2796         16  CF-HEALTH-QUESTIONS            PIC X.
  2797             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2798         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2799         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2800         16  CF-PLAN-SNGL-JNT               PIC X.
  2801             88  CF-COMBINED-PLAN              VALUE 'C'.
  2802             88  CF-JNT-PLAN                   VALUE 'J'.
  2803             88  CF-SNGL-PLAN                  VALUE 'S'.
  2804         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2805         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL687.cbl
  2806         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2807         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2808         16  CF-RERATE-CNTL                 PIC  X.
  2809             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2810             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2811             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2812             88  CF-AUTO-RECALC                 VALUE '4'.
  2813         16  CF-BENEFIT-TYPE                PIC  X.
  2814             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2815             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2816         16  CF-POLICY-FEE                  PIC S999V99
  2817                                                    COMP-3.
  2818         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2819         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2820         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2821         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2822         16  FILLER                         PIC  X(32).
  2823         16  CF-TERMINATION-FORM            PIC  X(04).
  2824         16  FILLER                         PIC  X(08).
  2825         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2826                                                       COMP-3.
  2827         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2828         16  CF-ISSUE-LETTER                PIC  X(4).
  2829         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2830         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2831             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2832             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2833         16  CF-MP-REFUND-CALC              PIC X.
  2834             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2835             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2836             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2837             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2838             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2839             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2840             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2841             88  CF-MP-REFD-MEAN                VALUE '8'.
  2842         16  CF-ALT-RATE-CODE               PIC  X(5).
  2843
  2844
  2845         16  FILLER                         PIC X(498).
  2846****************************************************************
  2847*             MORTGAGE COMPANY MASTER RECORD                   *
  2848****************************************************************
  2849
  2850     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2851         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2852         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2853             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2854             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2855             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2856             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2857             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2858
  2859         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2860         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2861         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2862         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2863         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL687.cbl
  2864
  2865         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2866             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2867         16  CF-MP-RECON-USE-IND            PIC X(1).
  2868             88  CF-MP-USE-RECON             VALUE 'Y'.
  2869         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2870             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2871         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2872             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2873             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2874         16  FILLER                         PIC X(1).
  2875         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2876             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2877         16  CF-MORTG-MIB-VERSION           PIC X.
  2878             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2879             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2880             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2881         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2882             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2883                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2884             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2885                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2886             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2887                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2888             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2889                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2890             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2891                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2892             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2893                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2894         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2895         16  FILLER                         PIC X(7).
  2896         16  CF-MORTG-DESTINATION-SYMBOL.
  2897             20  CF-MORTG-MIB-COMM          PIC X(5).
  2898             20  CF-MORTG-MIB-TERM          PIC X(5).
  2899         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2900             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2901         16  FILLER                         PIC X(03).
  2902         16  CF-MP-CHECK-NO-CONTROL.
  2903             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2904                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2905                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2906                                                ' ' LOW-VALUES.
  2907                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2908                                               VALUE '3'.
  2909         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2910         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2911         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2912             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2913                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2914             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2915                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2916             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2917                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2918             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2919                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2920             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2921                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL687.cbl
  2922             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2923                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2924         16  CF-MORTG-BILLING-AREA.
  2925             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2926                                            PIC X.
  2927         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2928         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2929         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2930         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2931             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2932             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2933         16  FILLER                         PIC X.
  2934         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2935             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2936             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2937         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2938         16  FILLER                         PIC X(8).
  2939         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2940         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2941         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2942         16  CF-ACH-COMPANY-ID.
  2943             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2944                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2945                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2946                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2947             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2948         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2949             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2950         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2951             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2952             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2953         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2954         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2955         16  FILLER                         PIC X(536).
  2956
  2957****************************************************************
  2958*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2959****************************************************************
  2960
  2961     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2962         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2963             20  CF-FEMALE-HEIGHT.
  2964                 24  CF-FEMALE-FT           PIC 99.
  2965                 24  CF-FEMALE-IN           PIC 99.
  2966             20  CF-FEMALE-MIN-WT           PIC 999.
  2967             20  CF-FEMALE-MAX-WT           PIC 999.
  2968         16  FILLER                         PIC X(428).
  2969
  2970     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2971         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2972             20  CF-MALE-HEIGHT.
  2973                 24  CF-MALE-FT             PIC 99.
  2974                 24  CF-MALE-IN             PIC 99.
  2975             20  CF-MALE-MIN-WT             PIC 999.
  2976             20  CF-MALE-MAX-WT             PIC 999.
  2977         16  FILLER                         PIC X(428).
  2978******************************************************************
  2979*             AUTOMATIC ACTIVITY RECORD                          *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL687.cbl
  2980******************************************************************
  2981     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2982         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2983             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2984             20  CF-SYS-LETTER-ID           PIC X(04).
  2985             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2986             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2987             20  CF-SYS-RESET-SW            PIC X(01).
  2988             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2989             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2990
  2991         16  FILLER                         PIC X(50).
  2992
  2993         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2994             20  CF-USER-ACTIVE-SW          PIC X(01).
  2995             20  CF-USER-LETTER-ID          PIC X(04).
  2996             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2997             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2998             20  CF-USER-RESET-SW           PIC X(01).
  2999             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3000             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3001             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3002
  3003         16  FILLER                         PIC X(246).
  3004
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL687.cbl
  3006*                            COPY ERCPYAJ.
  3007******************************************************************
  3008*                                                                *
  3009*                            ERCPYAJ                             *
  3010*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3011*                            VMOD=2.015                          *
  3012*                                                                *
  3013*   FILE DESCRIPTION = PENDING PAYMENT AND ADJUSTMENTS           *
  3014*                                                                *
  3015*                                                                *
  3016*   FILE TYPE = VSAM,KSDS                                        *
  3017*   RECORD SIZE = 200  RECFORM = FIXED                           *
  3018*                                                                *
  3019*   BASE CLUSTER = ERPYAJ                         RKP=2,LEN=33   *
  3020*       ALTERNATE PATHS = NONE                                   *
  3021*                                                                *
  3022*   LOG = YES                                                    *
  3023*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3024******************************************************************
  3025******************************************************************
  3026*                   C H A N G E   L O G
  3027*
  3028* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3029*-----------------------------------------------------------------
  3030*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3031* EFFECTIVE    NUMBER
  3032*-----------------------------------------------------------------
  3033* 042303                   PEMA ADD PROCESSING FOR DUE PREM ADJS
  3034* 060205                   PEMA ADD ERCOMP TYPE TO ERPYAJ
  3035******************************************************************
  3036
  3037 01  PENDING-PAY-ADJ.
  3038     12  PY-RECORD-ID                     PIC XX.
  3039         88  VALID-PY-ID                        VALUE 'PY'.
  3040
  3041     12  PY-CONTROL-PRIMARY.
  3042         16  PY-COMPANY-CD                PIC X.
  3043         16  PY-CARRIER                   PIC X.
  3044         16  PY-GROUPING                  PIC X(6).
  3045         16  PY-FIN-RESP                  PIC X(10).
  3046         16  PY-ACCOUNT                   PIC X(10).
  3047         16  PY-PRODUCER REDEFINES PY-ACCOUNT
  3048                                          PIC X(10).
  3049         16  PY-FILE-SEQ-NO               PIC S9(8)     COMP.
  3050         16  PY-RECORD-TYPE               PIC X.
  3051             88  PY-REMIT-RECEIVED            VALUE 'R'.
  3052             88  PY-DEPOSIT                   VALUE 'D'.
  3053             88  PY-CHARGE-TO-AGENT           VALUE 'C'.
  3054             88  PY-ADJ-REM-RECEIVED          VALUE 'S'.
  3055             88  PY-ADJ-DEPOSIT               VALUE 'T'.
  3056             88  PY-ADJ-CHG-TO-AGT            VALUE 'U'.
  3057             88  PY-ADD-TO-YTD-COMP           VALUE 'X'.
  3058             88  PY-SUBTRACT-YTD-COMP         VALUE 'Y'.
  3059             88  PY-ADD-TO-BALANCE            VALUE 'Z'.
  3060             88  PY-FICA-ENTRY                VALUE 'F'.
  3061             88  PY-REMIT-IND-GROUPING        VALUE 'G'.
  3062             88  PY-POLICY-FEE                VALUE 'W'.
  3063             88  PY-DUE-PREM-ADJ              VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL687.cbl
  3064
  3065     12  PY-PYMT-TYPE                     PIC X.
  3066             88  PY-NEW-BUS-PYMT              VALUE 'B'.
  3067             88  PY-REINS-PYMT                VALUE 'R'.
  3068             88  PY-EXP-PYMT                  VALUE 'E'.
  3069
  3070     12  PY-BIL-INV                       PIC X(6).
  3071     12  PY-REF-NO                        PIC X(12).
  3072
  3073     12  PY-LAST-MAINT-DT                 PIC XX.
  3074     12  PY-LAST-MAINT-BY                 PIC X(4).
  3075     12  PY-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  3076
  3077     12  PY-PYADJ-RECORD.
  3078         16  PY-ENTRY-AMT                 PIC S9(7)V99  COMP-3.
  3079         16  PY-ENTRY-COMMENT             PIC X(30).
  3080         16  PY-GL-DATA      REDEFINES PY-ENTRY-COMMENT.
  3081             20  PY-GL-ACCOUNT            PIC X(10).
  3082             20  PY-GL-STATE              PIC X(02).
  3083             20  PY-GL-CANC-SW            PIC X(01).
  3084                 88  PY-GL-CANC-SW-ON     VALUE 'Y'.
  3085                 88  PY-GL-CANC-SW-OFF    VALUE 'N'.
  3086             20  PY-GL-COMMENT            PIC X(10).
  3087             20  FILLER      REDEFINES PY-GL-COMMENT.
  3088                 24  PY-GL-CHECK-NO       PIC 9(06).
  3089                 24  FILLER               PIC X(04).
  3090             20  FILLER                   PIC X(07).
  3091         16  PY-SAVE-ACCOUNT              PIC X(10).
  3092         16  PY-SAVE-TYPE                 PIC X(01).
  3093
  3094         16  PY-LETTERS.
  3095             20  PY-LETTER OCCURS 3 TIMES
  3096                           INDEXED BY PY-LET-NDX
  3097                                          PIC X(04).
  3098
  3099         16  PY-ERCOMP-TYPE               PIC X.
  3100             88  PY-ACCOUNT-TYPE              VALUE 'A'.
  3101             88  PY-GA-TYPE                   VALUE 'G'.
  3102             88  PY-BANK-TYPE                 VALUE 'B'.
  3103         16  FILLER                       PIC X(05).
  3104
  3105     12  PY-RECORD-STATUS.
  3106         16  PY-CREDIT-SELECT-DT          PIC XX.
  3107         16  PY-CREDIT-ACCEPT-DT          PIC XX.
  3108         16  PY-BILLED-DATE               PIC XX.
  3109         16  PY-REPORTED-DT               PIC XX.
  3110         16  PY-PMT-APPLIED               PIC X.
  3111             88  PY-ACCOUNT-PMT               VALUE 'A'.
  3112             88  PY-GA-PMT                    VALUE 'G'.
  3113             88  PY-OVWRITE-PMT               VALUE 'O'.
  3114             88  PY-NON-AR-PMT                VALUE 'N'.
  3115         16  FILLER                       PIC X(5).
  3116         16  PY-INPUT-DT                  PIC XX.
  3117         16  PY-CHECK-NUMBER              PIC X(6).
  3118         16  PY-VOID-SW                   PIC X.
  3119             88  PY-CHECK-VOIDED              VALUE 'V'.
  3120         16  PY-CHECK-ORIGIN-SW           PIC X.
  3121             88  PY-BILLING-CHECK             VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL687.cbl
  3122             88  PY-REFUND-CHECK              VALUE 'R'.
  3123             88  PY-GA-CHECK                  VALUE 'G'.
  3124             88  PY-CHECK-WRITTEN             VALUE 'W'.
  3125             88  PY-CHECK-REVERSAL            VALUE 'V'.
  3126         16  PY-CHECK-WRITTEN-DT          PIC XX.
  3127         16  PY-CHECK-QUE-CONTROL         PIC S9(8) COMP.
  3128         16  PY-CHECK-QUE-SEQUENCE        PIC S9(4) COMP.
  3129         16  PY-BILL-FLAG                 PIC X.
  3130             88  PY-BILLED                    VALUE 'B'.
  3131         16  PY-AR-FLAG                   PIC X.
  3132             88  PY-AR-CYCLE                  VALUE 'C'.
  3133             88  PY-AR-MONTH-END              VALUE 'M'.
  3134         16  PY-AR-DATE                   PIC XX.
  3135
  3136     12  PY-GL-CODES.
  3137         16  PY-GL-DB                     PIC X(14).
  3138         16  PY-GL-CR                     PIC X(14).
  3139         16  PY-GL-FLAG                   PIC X.
  3140         16  PY-GL-DATE                   PIC XX.
  3141
  3142     12  PY-CANCEL-FEE-FLAG               PIC X(2).
  3143     12  FILLER                           PIC X(3).
  3144******************************************************************
  3145
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL687.cbl
  3147*                            COPY ERCCOMP.
  3148******************************************************************
  3149*                                                                *
  3150*                                                                *
  3151*                            ERCCOMP                             *
  3152*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3153*                            VMOD=2.019                          *
  3154*                                                                *
  3155*   ONLINE CREDIT SYSTEM                                         *
  3156*                                                                *
  3157*   FILE DESCRIPTION = COMPENSATION MASTER                       *
  3158*                                                                *
  3159*   FILE TYPE = VSAM,KSDS                                        *
  3160*   RECORD SIZE = 700   RECFORM = FIXED                          *
  3161*                                                                *
  3162*   BASE CLUSTER NAME = ERCOMP                   RKP=2,LEN=29    *
  3163*       ALTERNATE PATH = NONE                                    *
  3164*                                                                *
  3165*   LOG = NO                                                     *
  3166*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3167*                                                                *
  3168******************************************************************
  3169*                   C H A N G E   L O G
  3170*
  3171* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3172*-----------------------------------------------------------------
  3173*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3174* EFFECTIVE    NUMBER
  3175*-----------------------------------------------------------------
  3176* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3177* 041105    2005031100003  PEMA  ADD TYPE CODE FOR BANKS
  3178* 092205    2005050300006  PEMA  ADD LEASE FEE
  3179* 032406    2006022800001  AJRA  ADD FIRST WRITTEN DATE
  3180* 072406    2006022400001  PEMA  ADD REF EDIT FLD ON B RECS
  3181* 062907    2004020600003  PEMA  ADD WITHOLDING PERCENT
  3182* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3183* 020310  CR2008100900004  PEMA  ADD REF4 EXTRACT PROCESSING
  3184******************************************************************
  3185
  3186 01  COMPENSATION-MASTER.
  3187     12  CO-RECORD-ID                          PIC XX.
  3188         88  VALID-CO-ID                          VALUE 'CO'.
  3189
  3190     12  CO-CONTROL-PRIMARY.
  3191         16  CO-COMPANY-CD                     PIC X.
  3192         16  CO-CONTROL.
  3193             20  CO-CTL-1.
  3194                 24  CO-CARR-GROUP.
  3195                     28  CO-CARRIER            PIC X.
  3196                     28  CO-GROUPING.
  3197                         32  CO-GROUP-PREFIX   PIC XXX.
  3198                         32  CO-GROUP-PRIME    PIC XXX.
  3199                 24  CO-RESP-NO.
  3200                     28  CO-RESP-PREFIX        PIC X(4).
  3201                     28  CO-RESP-PRIME         PIC X(6).
  3202             20  CO-CTL-2.
  3203                 24  CO-ACCOUNT.
  3204                     28  CO-ACCT-PREFIX        PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL687.cbl
  3205                     28  CO-ACCT-PRIME         PIC X(6).
  3206         16  CO-TYPE                           PIC X.
  3207             88  CO-COMPANY-TYPE                  VALUE 'C'.
  3208             88  CO-GEN-AGENT-TYPE     VALUE 'G' 'B'.
  3209             88  CO-ACCOUNT-TYPE                  VALUE 'A'.
  3210
  3211     12  CO-MAINT-INFORMATION.
  3212         16  CO-LAST-MAINT-DT                  PIC XX.
  3213         16  CO-LAST-MAINT-HHMMSS              PIC S9(7)  COMP-3.
  3214         16  CO-LAST-MAINT-USER                PIC X(4).
  3215     12  FILLER                                PIC XX.
  3216     12  CO-STMT-TYPE                          PIC XXX.
  3217     12  CO-COMP-TYPE                          PIC X.
  3218         88  CO-COMP-IS-SPPDD                    VALUE '1'.
  3219     12  CO-STMT-OWNER                         PIC X(4).
  3220     12  CO-BALANCE-CONTROL                    PIC X.
  3221         88  CO-CARRY-BALANCE                     VALUE 'Y'.
  3222         88  CO-NO-BALANCE                        VALUE 'N'.
  3223
  3224     12  CO-INTERNAL-CONTROL-1                 PIC X.
  3225         88  CO-AUTO-GENERATED-THIS-RUN           VALUE 'X'.
  3226         88  CO-AUTO-GENERATED                    VALUE 'Y'.
  3227         88  CO-NOT-AUTO-GENERATED                VALUE 'N'.
  3228
  3229     12  CO-INTERNAL-CONTROL-2                 PIC X.
  3230         88  CO-STATEMENT-THIS-RUN                VALUE 'Y'.
  3231         88  CO-NO-STATEMENT-THIS-RUN             VALUE 'N'.
  3232
  3233     12  CO-GA-WITHOLD-PCT                     PIC S9V9999 COMP-3.
  3234     12  CO-GA-DIRECT-DEP                      PIC X.
  3235     12  CO-FUTURE-SPACE                       PIC X.
  3236         88  CO-FUTURE-NOT-USED                   VALUE ' '.
  3237
  3238     12  CO-ACCT-NAME                          PIC X(30).
  3239     12  CO-MAIL-NAME                          PIC X(30).
  3240     12  CO-ADDR-1                             PIC X(30).
  3241     12  CO-ADDR-2                             PIC X(30).
  3242     12  CO-ADDR-3.
  3243         16  CO-ADDR-CITY                      PIC X(27).
  3244         16  CO-ADDR-STATE                     PIC XX.
  3245     12  CO-CSO-1099                           PIC X.
  3246     12  CO-ZIP.
  3247         16  CO-ZIP-PRIME.
  3248             20  CO-ZIP-PRI-1ST                PIC X.
  3249                 88  CO-CANADIAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3250             20  FILLER                        PIC X(4).
  3251         16  CO-ZIP-PLUS4                      PIC X(4).
  3252     12  CO-CANADIAN-POSTAL-CODE  REDEFINES  CO-ZIP.
  3253         16  CO-CAN-POSTAL-1                   PIC XXX.
  3254         16  CO-CAN-POSTAL-2                   PIC XXX.
  3255         16  FILLER                            PIC XXX.
  3256     12  CO-SOC-SEC                            PIC X(13).
  3257     12  CO-TELEPHONE.
  3258         16  CO-AREA-CODE                      PIC XXX.
  3259         16  CO-PREFIX                         PIC XXX.
  3260         16  CO-PHONE                          PIC X(4).
  3261
  3262     12  CO-ROLADEX-PRINT-DT                   PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL687.cbl
  3263
  3264     12  CO-AR-BAL-LEVEL                       PIC X.
  3265         88  CO-AR-REF-LVL                        VALUE '1'.
  3266         88  CO-AR-BILL-REF-LVL                   VALUE '1'.
  3267         88  CO-AR-BILL-LVL                       VALUE '2'.
  3268         88  CO-AR-AGT-LVL                        VALUE '3'.
  3269         88  CO-AR-FR-LVL                         VALUE '4'.
  3270
  3271     12  CO-AR-NORMAL-PRINT                    PIC X.
  3272         88  CO-AR-BILL-IS-PRINTED                VALUE 'Y'.
  3273         88  CO-AR-BILL-NOT-PRINTED               VALUE 'N'.
  3274
  3275     12  CO-AR-SUMMARY-CODE                    PIC X(6).
  3276
  3277     12  CO-AR-REPORTING                       PIC X.
  3278         88  CO-AR-NET-REPORT                     VALUE 'N'.
  3279         88  CO-AR-GROSS-REPORT                   VALUE 'G'.
  3280
  3281     12  CO-AR-PULL-CHECK                      PIC X.
  3282         88  CO-AR-CHECKS-PULLED                  VALUE 'Y'.
  3283         88  CO-AR-CHECKS-NOT-PULLED              VALUE 'N'.
  3284
  3285     12  CO-AR-BALANCE-PRINT                   PIC X.
  3286         88  CO-AR-PRINT-NO-BALANCE               VALUE 'N'.
  3287
  3288     12  CO-AR-LAST-RUN-CODE                   PIC X.
  3289         88  CO-AR-LAST-RUN-ANNUAL                VALUE 'A'.
  3290         88  CO-AR-LAST-RUN-CYCLE                 VALUE 'C'.
  3291         88  CO-AR-LAST-RUN-EOM                   VALUE 'M'.
  3292
  3293     12  CO-LAST-EOM-STMT-DT                   PIC XX.
  3294
  3295     12  CO-USER-CODE                          PIC X.
  3296     12  CO-REPORT-GROUP-ID                    PIC X(12).
  3297
  3298******************************************************************
  3299*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN THE TOTALS AS OF
  3300*    THE LAST MONTH END RUN.
  3301******************************************************************
  3302
  3303     12  CO-LAST-ACTIVITY-DATE.
  3304         16  CO-ACT-YEAR                       PIC 99.
  3305         16  CO-ACT-MONTH                      PIC 99.
  3306         16  CO-ACT-DAY                        PIC 99.
  3307
  3308     12  CO-LAST-STMT-DT.
  3309         16  CO-LAST-STMT-YEAR                 PIC 99.
  3310         16  CO-LAST-STMT-MONTH                PIC 99.
  3311         16  CO-LAST-STMT-DAY                  PIC 99.
  3312
  3313     12  CO-MO-END-TOTALS.
  3314         16  CO-MONTHLY-TOTALS.
  3315             20  CO-BAL-FWD                PIC S9(7)V99   COMP-3.
  3316             20  CO-CUR-COM                PIC S9(7)V99   COMP-3.
  3317             20  CO-CUR-CHG                PIC S9(7)V99   COMP-3.
  3318             20  CO-CUR-PMT                PIC S9(7)V99   COMP-3.
  3319             20  CO-END-BAL                PIC S9(7)V99   COMP-3.
  3320
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL687.cbl
  3321         16  CO-AGING-TOTALS.
  3322             20  CO-CUR                    PIC S9(7)V99   COMP-3.
  3323             20  CO-OV30                   PIC S9(7)V99   COMP-3.
  3324             20  CO-OV60                   PIC S9(7)V99   COMP-3.
  3325             20  CO-OV90                   PIC S9(7)V99   COMP-3.
  3326
  3327         16  CO-YTD-TOTALS.
  3328             20  CO-YTD-COM                PIC S9(7)V99   COMP-3.
  3329             20  CO-YTD-OV                 PIC S9(7)V99   COMP-3.
  3330
  3331         16  CO-OVER-UNDER-TOTALS.
  3332             20  CO-CUR-OVR-UNDR           PIC S9(7)V99   COMP-3.
  3333             20  CO-YTD-OVR-UNDR           PIC S9(7)V99   COMP-3.
  3334
  3335     12  CO-MISCELLANEOUS-TOTALS.
  3336         16  CO-FICA-TOTALS.
  3337             20  CO-CUR-FICA               PIC S9(7)V99   COMP-3.
  3338             20  CO-YTD-FICA               PIC S9(7)V99   COMP-3.
  3339
  3340         16  CO-CLAIM-TOTALS.
  3341             20  CO-LF-CLM-AMT             PIC S9(9)V99   COMP-3.
  3342             20  CO-AH-CLM-AMT             PIC S9(9)V99   COMP-3.
  3343
  3344******************************************************************
  3345*    FOR A/R USERS THE FOLLOWING FIELDS CONTAIN TOTALS THAT
  3346*    REPRESENT CURRENT MONTH (TOTALS OF CYCLES).
  3347******************************************************************
  3348
  3349     12  CO-CURRENT-TOTALS.
  3350         16  CO-CURRENT-LAST-STMT-DT.
  3351             20  CO-CURRENT-LAST-STMT-YEAR     PIC 99.
  3352             20  CO-CURRENT-LAST-STMT-MONTH    PIC 99.
  3353             20  CO-CURRENT-LAST-STMT-DAY      PIC 99.
  3354
  3355         16  CO-CURRENT-MONTHLY-TOTALS.
  3356             20  CO-CURRENT-BAL-FWD        PIC S9(7)V99   COMP-3.
  3357             20  CO-CURRENT-CUR-COM        PIC S9(7)V99   COMP-3.
  3358             20  CO-CURRENT-CUR-CHG        PIC S9(7)V99   COMP-3.
  3359             20  CO-CURRENT-CUR-PMT        PIC S9(7)V99   COMP-3.
  3360             20  CO-CURRENT-END-BAL        PIC S9(7)V99   COMP-3.
  3361
  3362         16  CO-CURRENT-AGING-TOTALS.
  3363             20  CO-CURRENT-CUR            PIC S9(7)V99   COMP-3.
  3364             20  CO-CURRENT-OV30           PIC S9(7)V99   COMP-3.
  3365             20  CO-CURRENT-OV60           PIC S9(7)V99   COMP-3.
  3366             20  CO-CURRENT-OV90           PIC S9(7)V99   COMP-3.
  3367
  3368         16  CO-CURRENT-YTD-TOTALS.
  3369             20  CO-CURRENT-YTD-COM        PIC S9(7)V99   COMP-3.
  3370             20  CO-CURRENT-YTD-OV         PIC S9(7)V99   COMP-3.
  3371
  3372     12  CO-PAID-COMM-TOTALS.
  3373         16  CO-YTD-PAID-COMMS.
  3374             20  CO-YTD-PAID-COM           PIC S9(7)V99   COMP-3.
  3375             20  CO-YTD-PAID-OV            PIC S9(7)V99   COMP-3.
  3376
  3377     12  CO-CURRENT-MONTH-ACTIVITY         PIC X.
  3378         88  CO-HAS-CURR-MONTH-ACTIVITY       VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL687.cbl
  3379         88  CO-NO-CURR-MONTH-ACTIVITY        VALUE 'N'.
  3380
  3381     12  CO-DELINQUENT-LETTER-CODE         PIC X.
  3382         88  CO-ACCOUNT-1ST-LETTER            VALUE 'A'.
  3383         88  CO-ACCOUNT-2ND-LETTER            VALUE 'B'.
  3384         88  CO-AGENT-1ST-LETTER              VALUE 'B'.
  3385         88  CO-AGENT-2ND-LETTER              VALUE 'G'.
  3386         88  CO-OVERWRITE-LETTER              VALUE 'O'.
  3387         88  CO-MEMO-TO-REGION-MGR            VALUE 'M'.
  3388         88  CO-FINAL-LETTER                  VALUE 'F'.
  3389         88  CO-RECONCILING                   VALUE 'R'.
  3390         88  CO-PHONE-CALL                    VALUE 'P'.
  3391         88  CO-LEGAL                         VALUE 'L'.
  3392         88  CO-COLLECTION-AGENCY             VALUE 'C'.
  3393         88  CO-WRITE-OFF                     VALUE 'W'.
  3394         88  CO-NO-ACTION                     VALUE 'N' ' '.
  3395
  3396     12  CO-CSR-CODE                       PIC X(4).
  3397
  3398     12  CO-GA-STATUS-INFO.
  3399         16  CO-GA-EFFECTIVE-DT            PIC XX.
  3400         16  CO-GA-TERMINATION-DT          PIC XX.
  3401         16  CO-GA-STATUS-CODE             PIC X.
  3402             88  CO-GA-ACTIVE                 VALUE 'A'.
  3403             88  CO-GA-INACTIVE               VALUE 'I'.
  3404             88  CO-GA-PENDING                VALUE 'P'.
  3405         16  CO-GA-COMMENTS.
  3406             20  CO-GA-COMMENT-1           PIC X(40).
  3407             20  CO-GA-COMMENT-2           PIC X(40).
  3408             20  CO-GA-COMMENT-3           PIC X(40).
  3409             20  CO-GA-COMMENT-4           PIC X(40).
  3410
  3411     12  CO-RPTCD2                         PIC X(10).
  3412
  3413     12  CO-TYPE-AGENT                     PIC X(01).
  3414         88  CO-CORPORATION                   VALUE 'C'.
  3415         88  CO-PARTNERSHIP                   VALUE 'P'.
  3416         88  CO-SOLE-PROPRIETOR               VALUE 'S'.
  3417         88  CO-TRUST                         VALUE 'T'.
  3418         88  CO-UNKNOWN                       VALUE ' ' 'X'.
  3419
  3420     12  CO-FAXNO.
  3421         16  CO-FAX-AREA-CODE                  PIC XXX.
  3422         16  CO-FAX-PREFIX                     PIC XXX.
  3423         16  CO-FAX-PHONE                      PIC X(4).
  3424
  3425     12  CO-BANK-INFORMATION.
  3426         16  CO-BANK-TRANSIT-NO                PIC X(8).
  3427         16  CO-BANK-TRANSIT-NON REDEFINES
  3428             CO-BANK-TRANSIT-NO                PIC 9(8).
  3429
  3430         16  CO-BANK-ACCOUNT-NUMBER            PIC X(17).
  3431     12  CO-MISC-DEDUCT-INFO REDEFINES
  3432                  CO-BANK-INFORMATION.
  3433         16  CO-MD-GL-ACCT                     PIC X(10).
  3434         16  CO-MD-DIV                         PIC XX.
  3435         16  CO-MD-CENTER                      PIC X(4).
  3436         16  CO-MD-AMT                        PIC S9(5)V99 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL687.cbl
  3437         16  CO-CREATE-AP-CHECK                PIC X.
  3438         16  CO-DELIVER-CK-TO-MEL              PIC X.
  3439         16  FILLER                            PIC XXX.
  3440     12  CO-ACH-STATUS                         PIC X.
  3441         88  CO-ACH-ACTIVE                         VALUE 'A'.
  3442         88  CO-ACH-PENDING                        VALUE 'P'.
  3443
  3444     12  CO-BILL-SW                            PIC X.
  3445     12  CO-CONTROL-NAME                       PIC X(30).
  3446     12  CO-MAX-BANK-FEE-LEASE                 PIC S999V99 COMP-3.
  3447     12  CO-MAX-BANK-FEE                       PIC S999V99 COMP-3.
  3448     12  CO-CLP-STATE                          PIC XX.
  3449     12  CO-FIRST-WRITTEN-DT                   PIC XX.
  3450     12  CO-SPP-REFUND-EDIT                    PIC X.
  3451
  3452******************************************************************
  3453
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL687.cbl
  3455*                            COPY ERCCHEK.
  3456******************************************************************
  3457*                                                                *
  3458*                                                                *
  3459*                            ERCCHEK                             *
  3460*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3461*                            VMOD=2.008                          *
  3462*                                                                *
  3463*   FILE DESCRIPTION = CHECK RECORDS                             *
  3464*                                                                *
  3465*   FILE TYPE = VSAM,KSDS                                        *
  3466*   RECORD SIZE = 600    RECFORM = FIXED                         *
  3467*                                                                *
  3468*   BASE CLUSTER NAME = ERCHEK             RKP=2,LEN=35          *
  3469*       ALTERNATE INDEX = NONE                                   *
  3470*                                                                *
  3471*   LOG = YES                                                    *
  3472*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3473******************************************************************
  3474 01  CHECK-RECORDS.
  3475     12  CH-RECORD-ID                      PIC XX.
  3476         88  VALID-CH-ID                      VALUE 'CH'.
  3477
  3478     12  CH-CONTROL-PRIMARY.
  3479         16  CH-COMPANY-CD                 PIC X.
  3480         16  CH-CARRIER                    PIC X.
  3481         16  CH-GROUPING                   PIC X(6).
  3482         16  CH-STATE                      PIC XX.
  3483         16  CH-ACCOUNT                    PIC X(10).
  3484         16  CH-CERT-EFF-DT                PIC XX.
  3485         16  CH-CERT-NO.
  3486             20  CH-CERT-PRIME             PIC X(10).
  3487             20  CH-CERT-SFX               PIC X.
  3488         16  CH-SEQUENCE-NO                PIC S9(4)     COMP.
  3489
  3490     12  CH-RECORDED-DT                    PIC XX.
  3491     12  CH-RECORDED-BY                    PIC X(4).
  3492     12  CH-LAST-MAINT-HHMMSS              PIC S9(6)     COMP-3.
  3493
  3494     12  CH-AMOUNT-PAID                    PIC S9(7)V99  COMP-3.
  3495     12  CH-CHECK-NO                       PIC X(7).
  3496     12  CH-REASON-FOR-CHECK               PIC X(25).
  3497     12  CH-CHECK-WRITTEN-DT               PIC XX.
  3498     12  CH-OFFLINE-CHECK-IND              PIC X.
  3499         88  MANUAL-CHECK-WRITTEN             VALUE 'Y'.
  3500
  3501     12  CH-PAYEE-INFO.
  3502         16  CH-PAYEE-NAME-1               PIC X(30).
  3503         16  CH-PAYEE-NAME-2               PIC X(30).
  3504         16  CH-PAYEE-ADDRESS-1            PIC X(30).
  3505         16  CH-PAYEE-ADDRESS-2            PIC X(30).
  3506         16  CH-PAYEE-CITY-ST              PIC X(30).
  3507         16  CH-PAYEE-ZIP-CODE.
  3508             20  CH-PAYEE-ZIP.
  3509                 24  CH-ZIP-PRI-1ST        PIC X.
  3510                     88  CH-CANADIAN-POST-CODE
  3511                                           VALUES 'A' THRU 'Z'.
  3512                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL687.cbl
  3513             20  CH-PAYEE-ZIP-EXT          PIC X(4).
  3514         16  CH-CANADIAN-POSTAL-CODE REDEFINES CH-PAYEE-ZIP-CODE.
  3515             20  CH-CAN-POSTAL-1           PIC XXX.
  3516             20  CH-CAN-POSTAL-2           PIC XXX.
  3517             20  FILLER                    PIC XXX.
  3518
  3519     12  CH-CHECK-STUB-TEXT.
  3520         16  CH-STUB-LINE-1                PIC X(50).
  3521         16  CH-STUB-LINE-2                PIC X(50).
  3522         16  CH-STUB-LINE-3                PIC X(50).
  3523         16  FILLER.
  3524           18  CH-STUB-LINE-4              PIC X(20).
  3525           18  CH-LIENHOLDER-NAME          PIC X(30).
  3526
  3527     12  CH-COMPENSATION-CONTROL.
  3528         16  CH-COMP-CARRIER               PIC X.
  3529         16  CH-COMP-GROUPING              PIC X(6).
  3530         16  CH-COMP-FIN-RESP              PIC X(10).
  3531         16  CH-COMP-ACCOUNT               PIC X(10).
  3532
  3533     12  CH-CREDIT-SELECT-DT               PIC XX.
  3534     12  CH-CREDIT-ACCEPT-DT               PIC XX.
  3535     12  CH-PAYEE-CODE                     PIC X(6).
  3536
  3537     12  CH-VOID-DATA.
  3538         20  CH-VOID-DT                    PIC XX.
  3539         20  CH-VOID-BY                    PIC X(4).
  3540         20  CH-VOID-REASON                PIC X(25).
  3541
  3542     12  CH-CHECK-QUE-CONTROL              PIC S9(8)     COMP.
  3543             88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  3544     12  CH-CHECK-QUE-SEQUENCE             PIC S9(4)     COMP.
  3545
  3546     12  CH-CHECK-REFERENCE                PIC X(12).
  3547     12  CH-CHECK-ORIGIN-SW                PIC X.
  3548             88  CH-REFUND-CHECK              VALUE 'R'.
  3549             88  CH-MAINT-CHECK               VALUE 'M'.
  3550
  3551     12  CH-CANC-DT                        PIC XX.
  3552     12  CH-LF-REFUND                      PIC S9(7)V99  COMP-3.
  3553     12  CH-AH-REFUND                      PIC S9(7)V99  COMP-3.
  3554
  3555     12  CH-INSURED-NAME                   PIC X(28).
  3556
  3557     12  CH-DEDUCT-WITHHELD                PIC S9(5)V99  COMP-3.
  3558     12  CH-ADDITIONAL-CHARGE              PIC S9(5)V99  COMP-3.
  3559
  3560     12  CH-LETTER-TABLE.
  3561         16  CH-LETTERS OCCURS 3 TIMES
  3562                        INDEXED BY CH-LT-NDX
  3563                                           PIC X(04).
  3564
  3565     12  FILLER                            PIC X(07).
  3566
  3567
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL687.cbl
  3569 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CHECK-QUE
  3570                          CONTROL-FILE PENDING-PAY-ADJ
  3571                          COMPENSATION-MASTER CHECK-RECORDS.
  3572 0000-DFHEXIT SECTION.
  3573     MOVE '9#                    $   ' TO DFHEIV0.
  3574     MOVE 'EL687' TO DFHEIV1.
  3575     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  3576
  3577     MOVE DFHCOMMAREA            TO  PROGRAM-INTERFACE-BLOCK.
  3578
  3579*    NOTE *******************************************************
  3580*         *      ACCESS TO THIS MODULE CAN BE ONLY FROM AN XCTL *
  3581*         *  FROM ANOTHER MODULE.                               *
  3582*         *******************************************************.
  3583
  3584     MOVE EIBDATE                TO  DC-JULIAN-YYDDD
  3585     MOVE '5'                    TO  DC-OPTION-CODE
  3586     PERFORM 8500-DATE-CONVERSION
  3587     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-DATE
  3588
  3589     IF EIBCALEN NOT GREATER THAN ZERO
  3590         MOVE UNACCESS-MSG       TO  LOGOFF-MSG
  3591         GO TO 8300-SEND-TEXT.
  3592
  3593
  3594* EXEC CICS HANDLE CONDITION
  3595*        PGMIDERR   (9600-PGMIDERR)
  3596*        NOTFND     (0180-MAIN-LOGIC)
  3597*        ENDFILE    (0190-MAIN-LOGIC)
  3598*        TERMIDERR  (0900-TERMIDERR)
  3599*        ENQBUSY    (0910-ENQ-BUSY)
  3600*        ERROR      (9990-ERROR) END-EXEC.
  3601*    MOVE '"$LI''[).              ! " #00003589' TO DFHEIV0
  3602     MOVE X'22244C49275B292E20202020' TO DFHEIV0(1:12)
  3603     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3604     MOVE X'2220233030303033353839' TO DFHEIV0(25:11)
  3605     CALL 'kxdfhei1' USING DFHEIV0
  3606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3607
  3608
  3609     MOVE +3                     TO  EMI-NUMBER-OF-LINES
  3610     MOVE +2                     TO  EMI-SWITCH2.
  3611
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL687.cbl
  3613 0010-MAIN-LOGIC.
  3614     IF PI-CALLING-PROGRAM NOT = WS-PROGRAM-ID
  3615         IF PI-RETURN-TO-PROGRAM NOT = WS-PROGRAM-ID
  3616             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  3617             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  3618             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  3619             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  3620             MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  3621             MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  3622             MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  3623             MOVE WS-PROGRAM-ID        TO  PI-CALLING-PROGRAM
  3624           ELSE
  3625             MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  3626             MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  3627             MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  3628             MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  3629             MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  3630             MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  3631             MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  3632             MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  3633       ELSE
  3634         GO TO 0040-MAIN-LOGIC.
  3635
  3636 0015-MAIN-LOGIC.
  3637*    NOTE *******************************************************
  3638*         *      INITIALIZE THE WORK FIELDS FOR THE PROGRAM     *
  3639*         *  INTERFACE BLOCK FOR THIS MODULE.                   *
  3640*         *******************************************************.
  3641
  3642     MOVE SPACES                 TO  PI-PROGRAM-WORK-AREA.
  3643
  3644     MOVE ZEROS                  TO  PI-NUMBER-OF-CONTROL-GROUPS
  3645                                     PI-NUMBER-OF-ALIGNMENT-CHECKS
  3646                                     PI-ALIGNMENT-CONTROL-GROUP
  3647                                     PI-ALIGNMENT-SEQUENCE-NO
  3648                                     PI-PROCESSING-SW
  3649                                     PI-CONTROL-GROUP (1)
  3650                                     PI-CONTROL-GROUP (2)
  3651                                     PI-CONTROL-GROUP (3)
  3652                                     PI-CONTROL-GROUP (4)
  3653                                     PI-HIGH-SEQUENCE (1)
  3654                                     PI-HIGH-SEQUENCE (2)
  3655                                     PI-HIGH-SEQUENCE (3)
  3656                                     PI-HIGH-SEQUENCE (4)
  3657                                     PI-COMPANY-ZIP-CODE
  3658                                     PI-COMPANY-PHONE-NUMBER.
  3659
  3660     MOVE WS-PRINTER-STARTED-SW  TO  PI-PRINTER-STARTED-SW.
  3661     MOVE WS-TEMP-STORAGE-KEY    TO  PI-TEMP-STORAGE-KEY.
  3662
  3663     MOVE LOW-VALUES             TO  EL687AI.
  3664     MOVE -1                     TO  AOPTIONL
  3665
  3666
  3667* EXEC CICS ASSIGN
  3668*        SYSID (PI-SYSID)
  3669*        END-EXEC.
  3670*    MOVE '"(         $          "   #00003654' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL687.cbl
  3671     MOVE X'222820202020202020202024' TO DFHEIV0(1:12)
  3672     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  3673     MOVE X'2020233030303033363534' TO DFHEIV0(25:11)
  3674     CALL 'kxdfhei1' USING DFHEIV0,
  3675           PI-SYSID
  3676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3677
  3678
  3679     PERFORM 8100-SEND-INITIAL-MAP.
  3680
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL687.cbl
  3682 0040-MAIN-LOGIC.
  3683*    NOTE *******************************************************
  3684*         *      AFTER THE FIRST TIME THROUGH THE PROPER ATTEN- *
  3685*         *  TION KEY USAGE NEEDS TO BE CHECKED FOR VALIDITY    *
  3686*         *  BEFORE ANY FURTHER PROCESSING CAN BE DONE.         *
  3687*         *******************************************************.
  3688
  3689     IF EIBAID = DFHCLEAR
  3690         GO TO 9400-CLEAR.
  3691
  3692     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  3693         MOVE LOW-VALUES         TO  EL687AI
  3694         MOVE ER-0008            TO  EMI-ERROR
  3695         MOVE -1                 TO  APFKL
  3696         PERFORM 8200-SEND-DATAONLY.
  3697
  3698
  3699* EXEC CICS RECEIVE
  3700*        INTO   (EL687AI)
  3701*        MAPSET (WS-MAPSET-NAME)
  3702*        MAP    (WS-MAP-NAME) END-EXEC.
  3703     MOVE LENGTH OF
  3704      EL687AI
  3705       TO DFHEIV11
  3706*    MOVE '8"T I  L              ''   #00003677' TO DFHEIV0
  3707     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  3708     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3709     MOVE X'2020233030303033363737' TO DFHEIV0(25:11)
  3710     CALL 'kxdfhei1' USING DFHEIV0,
  3711           WS-MAP-NAME,
  3712           EL687AI,
  3713           DFHEIV11,
  3714           WS-MAPSET-NAME,
  3715           DFHEIV99,
  3716           DFHEIV99
  3717     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3718
  3719
  3720     IF APFKL IS GREATER THAN ZERO
  3721         IF EIBAID NOT = DFHENTER
  3722             MOVE ER-0004        TO  EMI-ERROR
  3723             MOVE AL-UNBOF       TO  APFKA
  3724             MOVE -1             TO  APFKL
  3725             PERFORM 8200-SEND-DATAONLY
  3726           ELSE
  3727             IF APFKO GREATER ZERO AND LESS '25'
  3728                 MOVE PF-VALUES (APFKI)  TO  EIBAID
  3729               ELSE
  3730                 MOVE ER-0029        TO  EMI-ERROR
  3731                 MOVE AL-UNBOF       TO  APFKA
  3732                 MOVE -1             TO  APFKL
  3733                 PERFORM 8200-SEND-DATAONLY.
  3734
  3735     IF EIBAID IS = DFHPF12
  3736         MOVE 'EL010'            TO  WS-PROGRAM-ID
  3737         GO TO 9300-XCTL.
  3738
  3739     IF EIBAID IS = DFHPF23
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL687.cbl
  3740         GO TO 9000-RETURN-CICS.
  3741
  3742     IF EIBAID IS = DFHPF24
  3743         MOVE 'EL126'            TO  WS-PROGRAM-ID
  3744         GO TO 9300-XCTL.
  3745
  3746     IF EIBAID NOT = DFHENTER
  3747         MOVE ER-0008            TO  EMI-ERROR
  3748         MOVE -1                 TO  APFKL
  3749         PERFORM 8200-SEND-DATAONLY.
  3750
  3751     IF PI-PROCESSING-SW NOT = ZERO
  3752         GO TO 0240-MAIN-LOGIC.
  3753
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL687.cbl
  3755 0100-MAIN-LOGIC.
  3756*    NOTE *******************************************************
  3757*         *          SYNTAX CHECK THE MAP FIELDS                *
  3758*         *******************************************************.
  3759
  3760     IF AOPTIONL NOT GREATER THAN ZERO
  3761         MOVE -1                 TO  AOPTIONL
  3762         MOVE AL-UNBON           TO  AOPTIONA
  3763         MOVE ER-0002            TO  EMI-ERROR
  3764         PERFORM 8200-SEND-DATAONLY.
  3765
  3766     IF (AOPTIONI GREATER ZERO AND LESS '4')
  3767       OR
  3768         (PI-COMPANY-ID = 'POS' AND
  3769          AOPTIONI = ('2' OR '3'))
  3770             MOVE AL-UNNON           TO  AOPTIONA
  3771           ELSE
  3772             MOVE -1                 TO  AOPTIONL
  3773             MOVE AL-UNBON           TO  AOPTIONA
  3774             MOVE ER-0330            TO  EMI-ERROR
  3775             PERFORM 9900-ERROR-FORMAT.
  3776
  3777     IF AALIGNL GREATER THAN ZERO
  3778         IF AALIGNI IS NUMERIC
  3779             MOVE AALIGNO  TO  PI-NUMBER-OF-ALIGNMENT-CHECKS
  3780             MOVE AL-UNNON       TO  AALIGNA
  3781           ELSE
  3782             MOVE ER-0365        TO  EMI-ERROR
  3783             MOVE -1             TO  AALIGNL
  3784             MOVE AL-UNBON       TO  AALIGNA
  3785             PERFORM 9900-ERROR-FORMAT.
  3786
  3787     IF ACKNOL GREATER THAN ZERO
  3788         IF ACKNOI IS NUMERIC
  3789             MOVE AL-UNNON       TO  ACKNOA
  3790             MOVE ACKNOI         TO  WS-CHECK-NUMBER-X
  3791           ELSE
  3792             MOVE ER-0366        TO  EMI-ERROR
  3793             MOVE -1             TO  ACKNOL
  3794             MOVE AL-UNBON       TO  ACKNOA
  3795             PERFORM 9900-ERROR-FORMAT
  3796       ELSE
  3797         MOVE ZERO               TO  WS-CHECK-NUMBER.
  3798
  3799     IF AACNL GREATER THAN ZERO
  3800         MOVE AACNI              TO  PI-ASSIGN-CHECK-NUMBERS
  3801         IF AACNI = ('Y' OR 'N')
  3802             MOVE AL-UANON       TO  AACNA
  3803             MOVE AACNI         TO  PI-ENTRY-CD-1
  3804           ELSE
  3805             MOVE AL-UABON       TO  AACNA
  3806             MOVE -1             TO  AACNL
  3807             MOVE ER-0367        TO  EMI-ERROR
  3808             PERFORM 9900-ERROR-FORMAT
  3809       ELSE
  3810         MOVE AL-UABOF           TO  AACNA
  3811         MOVE -1                 TO  AACNL
  3812         MOVE ER-0368            TO  EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL687.cbl
  3813         PERFORM 9900-ERROR-FORMAT.
  3814
  3815     IF AACNI = 'Y'
  3816       AND ACKNOL NOT GREATER THAN ZERO
  3817         MOVE -1                 TO  ACKNOL
  3818         MOVE AL-UNBOF           TO  ACKNOA
  3819         MOVE ER-0392            TO  EMI-ERROR
  3820         PERFORM 9900-ERROR-FORMAT.
  3821
  3822     IF AACNI = 'N'
  3823       AND ACKNOL GREATER THAN ZERO
  3824         MOVE -1                 TO  ACKNOL
  3825         MOVE AL-UNBON           TO  ACKNOA
  3826         MOVE ER-0393            TO  EMI-ERROR
  3827         PERFORM 9900-ERROR-FORMAT.
  3828
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL687.cbl
  3830*    NOTE *******************************************************
  3831*         *      CHECK THE VALIDITY OF ANY CONTROL GROUPS       *
  3832*         *  ENTERED.                                           *
  3833*         *******************************************************.
  3834
  3835     SET EL687A-INDEX
  3836         PI-INDEX TO +1.
  3837
  3838 0120-MAIN-LOGIC.
  3839     IF EL687A-CONTROL-GROUP-LENGTH (EL687A-INDEX)
  3840                                 NOT GREATER THAN ZERO
  3841         MOVE AL-UNNOF  TO  EL687A-CONTROL-GROUP-ATTRB
  3842                                                    (EL687A-INDEX)
  3843         GO TO 0190-MAIN-LOGIC.
  3844
  3845     IF EL687A-CONTROL-GROUP (EL687A-INDEX) IS NOT NUMERIC
  3846         MOVE AL-UNBON  TO  EL687A-CONTROL-GROUP-ATTRB
  3847                                                    (EL687A-INDEX)
  3848         MOVE -1  TO  EL687A-CONTROL-GROUP-LENGTH (EL687A-INDEX)
  3849         MOVE ER-0369            TO  EMI-ERROR
  3850         PERFORM 9900-ERROR-FORMAT
  3851         GO TO 0190-MAIN-LOGIC.
  3852
  3853     MOVE EL687A-CONTROL-GROUP (EL687A-INDEX)
  3854                                 TO  PI-CONTROL-GROUP (PI-INDEX)
  3855     SET PI-INDEX UP BY +1
  3856     MOVE AL-UNNON  TO  EL687A-CONTROL-GROUP-ATTRB (EL687A-INDEX)
  3857
  3858     IF PI-INDEX IS GREATER THAN +2
  3859       AND PI-CONTROL-GROUP (PI-INDEX - 2)
  3860                     NOT LESS THAN PI-CONTROL-GROUP (PI-INDEX - 1)
  3861         MOVE ER-0385            TO  EMI-ERROR
  3862         PERFORM 9900-ERROR-FORMAT
  3863         MOVE -1 TO EL687A-CONTROL-GROUP-LENGTH (EL687A-INDEX)
  3864         MOVE AL-UNBON TO EL687A-CONTROL-GROUP-ATTRB
  3865                                                   (EL687A-INDEX).
  3866
  3867     MOVE ZERO                   TO  WS-NOT-FOUND
  3868
  3869     MOVE LOW-VALUES             TO  WS-CHECK-QUEUE-KEY
  3870
  3871     MOVE PI-COMPANY-CD          TO  WS-CQK-COMPANY-CD
  3872     MOVE EL687A-CONTROL-GROUP (EL687A-INDEX)
  3873                                 TO  WS-CQK-CONTROL-NUMBER
  3874
  3875     IF WS-CHECK-QUEUE-BROWSE-SW = ZERO
  3876
  3877* EXEC CICS STARTBR
  3878*            DATASET   (WS-CHECK-QUEUE-DSID)
  3879*            RIDFLD    (WS-CHECK-QUEUE-KEY)
  3880*            GENERIC   EQUAL
  3881*            KEYLENGTH (5) END-EXEC
  3882     MOVE 5
  3883       TO DFHEIV11
  3884     MOVE 0
  3885       TO DFHEIV12
  3886*    MOVE '&,   KG    E          &   #00003838' TO DFHEIV0
  3887     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL687.cbl
  3888     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3889     MOVE X'2020233030303033383338' TO DFHEIV0(25:11)
  3890     CALL 'kxdfhei1' USING DFHEIV0,
  3891           WS-CHECK-QUEUE-DSID,
  3892           WS-CHECK-QUEUE-KEY,
  3893           DFHEIV11,
  3894           DFHEIV12,
  3895           DFHEIV99
  3896     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3897         MOVE +1                 TO  WS-CHECK-QUEUE-BROWSE-SW
  3898       ELSE
  3899
  3900* EXEC CICS RESETBR
  3901*        DATASET   (WS-CHECK-QUEUE-DSID)
  3902*        RIDFLD    (WS-CHECK-QUEUE-KEY)
  3903*        GENERIC   EQUAL
  3904*        KEYLENGTH (5) END-EXEC.
  3905     MOVE 5
  3906       TO DFHEIV11
  3907     MOVE 0
  3908       TO DFHEIV12
  3909*    MOVE '&4   KG    E          &   #00003845' TO DFHEIV0
  3910     MOVE X'26342020204B472020202045' TO DFHEIV0(1:12)
  3911     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3912     MOVE X'2020233030303033383435' TO DFHEIV0(25:11)
  3913     CALL 'kxdfhei1' USING DFHEIV0,
  3914           WS-CHECK-QUEUE-DSID,
  3915           WS-CHECK-QUEUE-KEY,
  3916           DFHEIV11,
  3917           DFHEIV12,
  3918           DFHEIV99
  3919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3920
  3921
  3922 0130-MAIN-LOGIC.
  3923
  3924* EXEC CICS READNEXT
  3925*        DATASET (WS-CHECK-QUEUE-DSID)
  3926*        RIDFLD  (WS-CHECK-QUEUE-KEY)
  3927*        SET     (ADDRESS OF CHECK-QUE) END-EXEC
  3928     MOVE 0
  3929       TO DFHEIV11
  3930*    MOVE '&.S                   )   #00003852' TO DFHEIV0
  3931     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  3932     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3933     MOVE X'2020233030303033383532' TO DFHEIV0(25:11)
  3934     CALL 'kxdfhei1' USING DFHEIV0,
  3935           WS-CHECK-QUEUE-DSID,
  3936           DFHEIV20,
  3937           DFHEIV99,
  3938           WS-CHECK-QUEUE-KEY,
  3939           DFHEIV99,
  3940           DFHEIV11,
  3941           DFHEIV99,
  3942           DFHEIV99
  3943     SET ADDRESS OF CHECK-QUE TO
  3944         DFHEIV20
  3945     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL687.cbl
  3946
  3947     IF WS-CQK-COMPANY-CD NOT = PI-COMPANY-CD
  3948         GO TO 0170-MAIN-LOGIC.
  3949
  3950     IF WS-CQK-CONTROL-NUMBER NOT = EL687A-CONTROL-GROUP
  3951                                                    (EL687A-INDEX)
  3952         GO TO 0170-MAIN-LOGIC.
  3953
  3954     IF CQ-ENTRY-TYPE NOT = 'Q'
  3955         GO TO 0130-MAIN-LOGIC.
  3956
  3957     IF PI-COMPANY-ID = 'POS'
  3958         MOVE CQ-PYAJ-CARRIER    TO  PI-CARRIER.
  3959
  3960     IF AOPTIONI = '2'
  3961       AND CQ-TIMES-PRINTED NOT GREATER THAN ZERO
  3962         GO TO 0190-MAIN-LOGIC.
  3963
  3964     IF AOPTIONI = '3'
  3965       AND CQ-TIMES-PRINTED GREATER THAN ZERO
  3966         GO TO 0190-MAIN-LOGIC.
  3967
  3968     GO TO 0130-MAIN-LOGIC.
  3969
  3970 0170-MAIN-LOGIC.
  3971     MOVE ER-0394                TO  EMI-ERROR
  3972     PERFORM 9900-ERROR-FORMAT
  3973     MOVE -1 TO EL687A-CONTROL-GROUP-LENGTH (EL687A-INDEX)
  3974     MOVE AL-UNBON TO EL687A-CONTROL-GROUP-ATTRB (EL687A-INDEX)
  3975
  3976     GO TO 0190-MAIN-LOGIC.
  3977
  3978 0180-MAIN-LOGIC.
  3979     MOVE ER-0387                TO  EMI-ERROR
  3980     PERFORM 9900-ERROR-FORMAT
  3981     MOVE -1 TO EL687A-CONTROL-GROUP-LENGTH (EL687A-INDEX)
  3982     MOVE AL-UNBON TO EL687A-CONTROL-GROUP-ATTRB (EL687A-INDEX).
  3983
  3984 0190-MAIN-LOGIC.
  3985     IF EL687A-INDEX LESS THAN +4
  3986         SET EL687A-INDEX UP BY +1
  3987         GO TO 0120-MAIN-LOGIC.
  3988
  3989     IF WS-CHECK-QUEUE-BROWSE-SW NOT = ZERO
  3990         MOVE ZERO               TO  WS-CHECK-QUEUE-BROWSE-SW
  3991
  3992* EXEC CICS ENDBR
  3993*            DATASET (WS-CHECK-QUEUE-DSID) END-EXEC.
  3994     MOVE 0
  3995       TO DFHEIV11
  3996*    MOVE '&2                    $   #00003901' TO DFHEIV0
  3997     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  3998     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3999     MOVE X'2020233030303033393031' TO DFHEIV0(25:11)
  4000     CALL 'kxdfhei1' USING DFHEIV0,
  4001           WS-CHECK-QUEUE-DSID,
  4002           DFHEIV11,
  4003           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL687.cbl
  4004     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4005
  4006
  4007     IF EMI-FATAL-CTR GREATER THAN ZERO
  4008         PERFORM 8200-SEND-DATAONLY.
  4009
  4010     IF AOPTIONI = ('2' OR '3')
  4011       AND PI-INDEX NOT GREATER THAN +1
  4012         MOVE -1                 TO  ACG01L
  4013         MOVE AL-UNBOF  TO  ACG01A ACG02A ACG03A ACG04A
  4014         MOVE ER-0370            TO  EMI-ERROR
  4015         PERFORM 9900-ERROR-FORMAT.
  4016
  4017     IF PI-INDEX GREATER THAN +1
  4018         NEXT SENTENCE
  4019       ELSE
  4020         GO TO 0200-MAIN-LOGIC.
  4021
  4022     SET PI-INDEX DOWN BY +1
  4023     SET PI-NUMBER-OF-CONTROL-GROUPS TO PI-INDEX
  4024     SET PI-INDEX
  4025         EL687A-INDEX TO +1.
  4026
  4027 0195-MAIN-LOGIC.
  4028     IF PI-CONTROL-GROUP (PI-INDEX) GREATER THAN ZERO
  4029         MOVE PI-CONTROL-GROUP (PI-INDEX)
  4030                     TO  EL687A-CONTROL-GROUP (EL687A-INDEX)
  4031         MOVE AL-UNNON TO EL687A-CONTROL-GROUP-ATTRB
  4032                                                    (EL687A-INDEX)
  4033       ELSE
  4034         MOVE WS-INIT-CONTROL-GROUP
  4035                     TO  EL687A-CONTROL-GROUP (EL687A-INDEX)
  4036         MOVE AL-UNNOF TO EL687A-CONTROL-GROUP-ATTRB
  4037                                                   (EL687A-INDEX).
  4038
  4039     IF PI-INDEX LESS THAN +4
  4040         SET PI-INDEX
  4041             EL687A-INDEX UP BY +1
  4042         GO TO 0195-MAIN-LOGIC.
  4043
  4044     SET EL687A-INDEX
  4045         PI-INDEX TO +1.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL687.cbl
  4047 0200-MAIN-LOGIC.
  4048*    NOTE *******************************************************
  4049*         *      ALL OF THE SYNTAX CHECKS HAVE BEEN SUCCESSFUL- *
  4050*         *  NOW DO THE PRE-EDIT.                               *
  4051*         *                                                     *
  4052*         *      BEFORE A CHECK BATCH IS QUEUED FOR PRINT, A    *
  4053*         *  PRE-EDIT IS DONE TO ASSURE CONSISTENCY IN          *
  4054*         *  PROCESSING.  THIS EDIT CONSISTS OF THE FOLLOWING   *
  4055*         *  STEPS:                                             *
  4056*         *                                                     *
  4057*         *  1. IF A STARTING CHECK NUMBER HAS BEEN ENTERED,    *
  4058*         *     THE NUMBER IS COMPARED TO OTHER NUMBERS IN THE  *
  4059*         *     FILE FOR OVERLAPS AND GAPS.                     *
  4060*         *                                                     *
  4061*         *  2. IF ANY CHECKS IN THE RELEASED GROUPS HAVE       *
  4062*         *     ALREADY BEEN QUEUED FOR PRINT OR PRINTED.       *
  4063*         *                                                     *
  4064*         *  3. IF PRE-NUMBERING IS NOT USED THAT ALL CHECKS    *
  4065*         *     HAVE A CHECK NUMBER ASSIGNED.                   *
  4066*         *                                                     *
  4067*         *  4. IF DUPLICATE CHECK NUMBERS ARE ASSIGNED.        *
  4068*         *                                                     *
  4069*         *      BEFORE A CHECK BATCH IS QUEUED FOR RE-PRINT, A *
  4070*         *  PRE-EDIT IS DONE TO ASSURE CONSISTENCY IN          *
  4071*         *  PROCESSING.  THIS EDIT CONSISTS OF THE FOLLOWING   *
  4072*         *  STEPS:                                             *
  4073*         *                                                     *
  4074*         *  1. ALL CHECKS IN THE INDICATED GROUP(S) MUST HAVE  *
  4075*         *     BEEN PREVIOUSLY PRINTED.                        *
  4076*         *                                                     *
  4077*         *  2. IF THE PRE-NUMBERING SWITCH IS SET IN ANY RECORD*
  4078*         *     IT MUST BE SET IN ALL RECORDS.                  *
  4079*         *                                                     *
  4080*         *  3. IF A STARTING CHECK NUMBER HAS BEEN ENTERED,    *
  4081*         *     THE NUMBER IS COMPARED TO OTHER NUMBERS IN THE  *
  4082*         *     FILE FOR OVERLAPS AND GAPS.                     *
  4083*         *******************************************************.
  4084
  4085     MOVE PI-COMPANY-ID          TO  WS-ENQ-COMPANY-ID.
  4086
  4087
  4088* EXEC CICS ENQ
  4089*        RESOURCE (WS-CHECK-QUEUE-DSID)
  4090*        LENGTH   (11) END-EXEC.
  4091     MOVE 11
  4092       TO DFHEIV11
  4093*    MOVE '2$L                   $   #00003984' TO DFHEIV0
  4094     MOVE X'32244C202020202020202020' TO DFHEIV0(1:12)
  4095     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4096     MOVE X'2020233030303033393834' TO DFHEIV0(25:11)
  4097     CALL 'kxdfhei1' USING DFHEIV0,
  4098           WS-CHECK-QUEUE-DSID,
  4099           DFHEIV11,
  4100           DFHEIV99
  4101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4102
  4103
  4104
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL687.cbl
  4105* EXEC CICS HANDLE CONDITION
  4106*        NOTFND  (0225-MAIN-LOGIC)
  4107*        ENDFILE (0230-MAIN-LOGIC) END-EXEC.
  4108*    MOVE '"$I''                  ! # #00003988' TO DFHEIV0
  4109     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4110     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4111     MOVE X'2320233030303033393838' TO DFHEIV0(25:11)
  4112     CALL 'kxdfhei1' USING DFHEIV0
  4113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4114
  4115
  4116     MOVE LOW-VALUES             TO  WS-CHECK-QUEUE-KEY.
  4117     MOVE +5                     TO  WS-KEY-LENGTH.
  4118
  4119     MOVE PI-COMPANY-CD          TO  WS-CQK-COMPANY-CD.
  4120
  4121
  4122* EXEC CICS STARTBR
  4123*        DATASET (WS-CHECK-QUEUE-DSID)
  4124*        RIDFLD  (WS-CHECK-QUEUE-KEY)
  4125*        GTEQ    END-EXEC.
  4126     MOVE 0
  4127       TO DFHEIV11
  4128*    MOVE '&,         G          &   #00003997' TO DFHEIV0
  4129     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4130     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4131     MOVE X'2020233030303033393937' TO DFHEIV0(25:11)
  4132     CALL 'kxdfhei1' USING DFHEIV0,
  4133           WS-CHECK-QUEUE-DSID,
  4134           WS-CHECK-QUEUE-KEY,
  4135           DFHEIV99,
  4136           DFHEIV11,
  4137           DFHEIV99
  4138     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4139
  4140
  4141 0210-MAIN-LOGIC.
  4142     MOVE EMI-FATAL-CTR         TO  WS-LAST-ERROR-COUNT.
  4143
  4144
  4145* EXEC CICS READNEXT
  4146*        DATASET (WS-CHECK-QUEUE-DSID)
  4147*        RIDFLD  (WS-CHECK-QUEUE-KEY)
  4148*        SET     (ADDRESS OF CHECK-QUE) END-EXEC.
  4149     MOVE 0
  4150       TO DFHEIV11
  4151*    MOVE '&.S                   )   #00004005' TO DFHEIV0
  4152     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4153     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4154     MOVE X'2020233030303034303035' TO DFHEIV0(25:11)
  4155     CALL 'kxdfhei1' USING DFHEIV0,
  4156           WS-CHECK-QUEUE-DSID,
  4157           DFHEIV20,
  4158           DFHEIV99,
  4159           WS-CHECK-QUEUE-KEY,
  4160           DFHEIV99,
  4161           DFHEIV11,
  4162           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL687.cbl
  4163           DFHEIV99
  4164     SET ADDRESS OF CHECK-QUE TO
  4165         DFHEIV20
  4166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4167
  4168
  4169     IF CQ-COMPANY-CD NOT = PI-COMPANY-CD
  4170         GO TO 0230-MAIN-LOGIC.
  4171
  4172*    IF CQ-ENTRY-TYPE NOT = 'Q'
  4173*        GO TO 0210-MAIN-LOGIC.
  4174
  4175     IF  (AOPTIONI = '1' OR '2')
  4176             AND
  4177         CQ-ENTRY-TYPE NOT = 'Q'
  4178         GO TO 0210-MAIN-LOGIC.
  4179
  4180*    NOTE *******************************************************
  4181*         *      SAVE THE CHECK NUMBER SO AT THE END OF THE     *
  4182*         *  BROWSE YOU CAN CHECK FOR GAPS OR OVERLAPS.         *
  4183*         *******************************************************.
  4184
  4185     IF CQ-CHECK-NUMBER GREATER THAN WS-GREATEST-CHECK-NUMBER-X
  4186         MOVE CQ-CHECK-NUMBER    TO  WS-GREATEST-CHECK-NUMBER-X.
  4187
  4188*    NOTE *******************************************************
  4189*         *      IF YOU ARE PROCESSING BY GROUPS BYPASS ALL     *
  4190*         *  RECORDS IF NOT IN SPECIFIED GROUPS.  SAVE THE HIGH *
  4191*         *  SEQUENCE NUMBER IN EACH GROUP FOR REPRINT.         *
  4192*         *******************************************************.
  4193
  4194     IF AOPTIONI = '2' OR '3'
  4195         NEXT SENTENCE
  4196       ELSE
  4197         GO TO 0213-MAIN-LOGIC.
  4198
  4199     SET PI-INDEX
  4200         EL687A-INDEX TO +1.
  4201
  4202 0212-MAIN-LOGIC.
  4203     IF CQ-CONTROL-NUMBER  = PI-CONTROL-GROUP (PI-INDEX)
  4204         IF CQ-SEQUENCE-NUMBER GREATER PI-HIGH-SEQUENCE (PI-INDEX)
  4205             MOVE CQ-SEQUENCE-NUMBER
  4206                                 TO PI-HIGH-SEQUENCE (PI-INDEX)
  4207             GO TO 0215-MAIN-LOGIC
  4208           ELSE
  4209             GO TO 0215-MAIN-LOGIC.
  4210
  4211     IF PI-INDEX LESS THAN +4
  4212         SET PI-INDEX
  4213             EL687A-INDEX UP BY +1
  4214         GO TO 0212-MAIN-LOGIC.
  4215
  4216     GO TO 0210-MAIN-LOGIC.
  4217
  4218 0213-MAIN-LOGIC.
  4219*    NOTE *******************************************************
  4220*         *      IF YOU ARE PRINTING ALL CONTROL GROUPS BYPASS  *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL687.cbl
  4221*         *  THE CONTROL GROUPS THAT HAVE ALREADY BEEN PRINTED. *
  4222*         *******************************************************.
  4223
  4224     IF CQ-CONTROL-NUMBER NOT = WS-LAST-CONTROL-GROUP
  4225         MOVE CQ-CONTROL-NUMBER  TO  WS-LAST-CONTROL-GROUP
  4226         MOVE CQ-TIMES-PRINTED   TO  WS-TIMES-PRINTED.
  4227
  4228     IF WS-TIMES-PRINTED GREATER THAN ZERO
  4229         GO TO 0210-MAIN-LOGIC.
  4230
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL687.cbl
  4232 0215-MAIN-LOGIC.
  4233
  4234*    IF  AOPTIONI = '3'
  4235     IF AOPTIONI = '1' OR '2'
  4236         GO TO 0220-MAIN-LOGIC.
  4237
  4238     IF CQ-TIMES-PRINTED GREATER THAN ZERO
  4239        MOVE -1 TO EL687A-CONTROL-GROUP-LENGTH (EL687A-INDEX)
  4240        MOVE AL-UNBON TO EL687A-CONTROL-GROUP-ATTRB (EL687A-INDEX)
  4241        MOVE ER-0379             TO  EMI-ERROR
  4242        PERFORM 9900-ERROR-FORMAT.
  4243
  4244     IF AACNI = 'Y'
  4245       AND CQ-CHECK-NUMBER NOT = SPACES
  4246         MOVE ER-0382            TO  EMI-ERROR
  4247         PERFORM 9900-ERROR-FORMAT
  4248         MOVE -1                 TO  AACNL
  4249         MOVE AL-UABON           TO  AACNA
  4250     ELSE
  4251         IF AACNI = 'N'
  4252           AND CQ-CHECK-NUMBER = SPACES
  4253             MOVE -1             TO  AACNL
  4254             MOVE AL-UABON       TO  AACNA
  4255             MOVE ER-0383        TO  EMI-ERROR
  4256             PERFORM 9900-ERROR-FORMAT.
  4257
  4258     GO TO 0210-MAIN-LOGIC.
  4259
  4260 0220-MAIN-LOGIC.
  4261
  4262     IF  CQ-ENTRY-TYPE NOT = 'Q'
  4263         GO TO 0210-MAIN-LOGIC.
  4264
  4265     IF CQ-TIMES-PRINTED NOT GREATER THAN ZERO
  4266        MOVE -1 TO EL687A-CONTROL-GROUP-LENGTH (EL687A-INDEX)
  4267        MOVE AL-UNBON TO EL687A-CONTROL-GROUP-ATTRB (EL687A-INDEX)
  4268        MOVE ER-0389             TO  EMI-ERROR
  4269        PERFORM 9900-ERROR-FORMAT.
  4270
  4271     IF CQ-PRE-NUMBERING-SW = '1'
  4272       AND AACNI = 'N'
  4273         MOVE -1                 TO  AACNL
  4274         MOVE AL-UABON           TO  AACNA
  4275         MOVE ER-0390            TO  EMI-ERROR
  4276         PERFORM 9900-ERROR-FORMAT.
  4277
  4278     IF CQ-PRE-NUMBERING-SW = SPACES
  4279       AND AACNI = 'Y'
  4280         MOVE -1                 TO  AACNL
  4281         MOVE AL-UABON           TO  AACNA
  4282         MOVE ER-0391            TO  EMI-ERROR
  4283         PERFORM 9900-ERROR-FORMAT.
  4284
  4285     GO TO 0210-MAIN-LOGIC.
  4286
  4287 0225-MAIN-LOGIC.
  4288     MOVE ER-0490                TO  EMI-ERROR
  4289     MOVE -1                     TO  AOPTIONL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL687.cbl
  4290     PERFORM 8200-SEND-DATAONLY
  4291     PERFORM 9100-RETURN-TRAN.
  4292
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL687.cbl
  4294 0230-MAIN-LOGIC.
  4295
  4296* EXEC CICS ENDBR
  4297*        DATASET (WS-CHECK-QUEUE-DSID) END-EXEC.
  4298     MOVE 0
  4299       TO DFHEIV11
  4300*    MOVE '&2                    $   #00004136' TO DFHEIV0
  4301     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4302     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4303     MOVE X'2020233030303034313336' TO DFHEIV0(25:11)
  4304     CALL 'kxdfhei1' USING DFHEIV0,
  4305           WS-CHECK-QUEUE-DSID,
  4306           DFHEIV11,
  4307           DFHEIV99
  4308     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4309
  4310
  4311     IF EMI-FATAL-CTR GREATER THAN ZERO
  4312         PERFORM 8200-SEND-DATAONLY.
  4313
  4314*    NOTE *******************************************************
  4315*         *      READ THE COMPANY RECORD FROM THE CONTROL FILE  *
  4316*         *  TO GET THE CICS/VS PRINTER TERMINAL ID AND CHECK   *
  4317*         *  TO SEE IF THE PRINTER HAS BEEN SPECIFIED.          *
  4318*         *******************************************************.
  4319
  4320     MOVE PI-COMPANY-ID          TO  WS-CONTROL-FILE-KEY.
  4321     MOVE '1'                    TO  WS-CFK-RECORD-TYPE.
  4322     MOVE ZERO                   TO  WS-CFK-SEQUENCE-NO.
  4323
  4324
  4325* EXEC CICS READ
  4326*        DATASET (WS-CONTROL-FILE-DSID)
  4327*        RIDFLD  (WS-CONTROL-FILE-KEY)
  4328*        SET    (ADDRESS OF CONTROL-FILE) END-EXEC.
  4329*    MOVE '&"S        E          (   #00004152' TO DFHEIV0
  4330     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4331     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4332     MOVE X'2020233030303034313532' TO DFHEIV0(25:11)
  4333     CALL 'kxdfhei1' USING DFHEIV0,
  4334           WS-CONTROL-FILE-DSID,
  4335           DFHEIV20,
  4336           DFHEIV99,
  4337           WS-CONTROL-FILE-KEY,
  4338           DFHEIV99,
  4339           DFHEIV99,
  4340           DFHEIV99
  4341     SET ADDRESS OF CONTROL-FILE TO
  4342         DFHEIV20
  4343     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4344
  4345
  4346     IF CF-CHECK-PRINTER-ID = SPACES
  4347         MOVE ER-0371            TO  EMI-ERROR
  4348         MOVE -1                 TO  APFKL
  4349         PERFORM 9900-ERROR-FORMAT.
  4350
  4351     MOVE SPACES                 TO  PI-ALT-DMD-PRT-ID.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL687.cbl
  4352     IF APRTL GREATER THAN ZEROS
  4353         MOVE AL-UANON           TO  APRTA
  4354         MOVE APRTI              TO  PI-CHECK-PRINTER-ID
  4355                                     PI-ALT-DMD-PRT-ID
  4356     ELSE
  4357         MOVE CF-CHECK-PRINTER-ID
  4358                                 TO  PI-CHECK-PRINTER-ID.
  4359
  4360     MOVE CF-COMPANY-ADDRESS     TO  PI-COMPANY-ADDRESS.
  4361
  4362     IF AACNI = 'Y'
  4363         IF WS-GREATEST-CHECK-NUMBER-X NOT LESS THAN ACKNOI
  4364             MOVE ER-0380        TO  EMI-ERROR
  4365             PERFORM 9900-ERROR-FORMAT
  4366             MOVE -1             TO  ACKNOL
  4367             MOVE AL-UNBON       TO  ACKNOA
  4368         ELSE
  4369             SUBTRACT +1 FROM ACKNOO GIVING WS-ACKNO
  4370             IF WS-GREATEST-CHECK-NUMBER-X NOT = WS-ACKNO-X
  4371                 MOVE ER-0381    TO  EMI-ERROR
  4372                 PERFORM 9900-ERROR-FORMAT
  4373                 MOVE -1         TO  ACKNOL
  4374                 MOVE AL-UNBON   TO  ACKNOA
  4375             ELSE
  4376                 MOVE AL-SANON   TO  ACKNOA.
  4377
  4378     IF EMI-FATAL-CTR GREATER THAN ZERO
  4379         PERFORM 8200-SEND-DATAONLY.
  4380
  4381     MOVE AL-SANON               TO  AOPTIONA
  4382                                     ACG01A
  4383                                     ACG02A
  4384                                     ACG03A
  4385                                     ACG04A
  4386                                     AACNA
  4387                                     APRTA.
  4388
  4389     MOVE +1                     TO  PI-PROCESSING-SW
  4390                                     AALIGNL.
  4391
  4392     IF PI-NUMBER-OF-ALIGNMENT-CHECKS GREATER THAN ZERO
  4393         MOVE ER-0361            TO  EMI-ERROR
  4394       ELSE
  4395         MOVE ER-0362            TO  EMI-ERROR.
  4396
  4397     PERFORM 8200-SEND-DATAONLY.
  4398
  4399
  4400* EXEC CICS HANDLE AID
  4401*        CLEAR (9400-CLEAR)
  4402*        PA1   (0040-MAIN-LOGIC)
  4403*        PA2   (0040-MAIN-LOGIC)
  4404*        PA3   (0040-MAIN-LOGIC) END-EXEC.
  4405*    MOVE '"&=!"#               V! $ #00004210' TO DFHEIV0
  4406     MOVE X'22263D212223202020202020' TO DFHEIV0(1:12)
  4407     MOVE X'202020202020202020562120' TO DFHEIV0(13:12)
  4408     MOVE X'2420233030303034323130' TO DFHEIV0(25:11)
  4409     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL687.cbl
  4410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4411
  4412
  4413
  4414* EXEC CICS SYNCPOINT
  4415*        END-EXEC.
  4416*    MOVE '6"                    !   #00004216' TO DFHEIV0
  4417     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  4418     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4419     MOVE X'2020233030303034323136' TO DFHEIV0(25:11)
  4420     CALL 'kxdfhei1' USING DFHEIV0
  4421     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4422
  4423
  4424     GO TO 0040-MAIN-LOGIC.
  4425
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL687.cbl
  4427 0240-MAIN-LOGIC.
  4428     IF AALIGNL GREATER THAN ZERO
  4429         IF AALIGNI IS NUMERIC
  4430             MOVE AALIGNO  TO  PI-NUMBER-OF-ALIGNMENT-CHECKS
  4431             MOVE AL-UNNON       TO  AALIGNA
  4432           ELSE
  4433             MOVE ER-0365        TO  EMI-ERROR
  4434             MOVE -1             TO  AALIGNL
  4435             MOVE AL-UNBON       TO  AALIGNA
  4436             PERFORM 8200-SEND-DATAONLY
  4437             GO TO 0040-MAIN-LOGIC.
  4438
  4439     IF PI-NUMBER-OF-ALIGNMENT-CHECKS NOT GREATER THAN ZERO
  4440         GO TO 0300-MAIN-LOGIC.
  4441
  4442     IF PI-ALIGNMENT-CONTROL-GROUP GREATER THAN ZERO
  4443         GO TO 0245-MAIN-LOGIC.
  4444
  4445     MOVE PI-COMPANY-ID          TO  WS-CONTROL-FILE-KEY.
  4446     MOVE '1'                    TO  WS-CFK-RECORD-TYPE.
  4447     MOVE ZERO                   TO  WS-CFK-SEQUENCE-NO.
  4448
  4449
  4450* EXEC CICS READ UPDATE
  4451*        DATASET (WS-CONTROL-FILE-DSID)
  4452*        RIDFLD  (WS-CONTROL-FILE-KEY)
  4453*        SET    (ADDRESS OF CONTROL-FILE) END-EXEC.
  4454*    MOVE '&"S        EU         (   #00004244' TO DFHEIV0
  4455     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4456     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4457     MOVE X'2020233030303034323434' TO DFHEIV0(25:11)
  4458     CALL 'kxdfhei1' USING DFHEIV0,
  4459           WS-CONTROL-FILE-DSID,
  4460           DFHEIV20,
  4461           DFHEIV99,
  4462           WS-CONTROL-FILE-KEY,
  4463           DFHEIV99,
  4464           DFHEIV99,
  4465           DFHEIV99
  4466     SET ADDRESS OF CONTROL-FILE TO
  4467         DFHEIV20
  4468     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4469
  4470
  4471     ADD +1  TO  CF-CR-CHECK-QUE-COUNTER.
  4472
  4473     IF CR-QUE-COUNT-RESET
  4474         MOVE +1                 TO  CF-CR-CHECK-QUE-COUNTER.
  4475
  4476     MOVE CF-CR-CHECK-QUE-COUNTER TO PI-ALIGNMENT-CONTROL-GROUP.
  4477
  4478     MOVE CONTROL-FILE           TO  JP-RECORD-AREA.
  4479     MOVE WS-CONTROL-FILE-DSID   TO  JP-FILE-ID.
  4480     MOVE 'C'                    TO  JP-RECORD-TYPE.
  4481
  4482
  4483* EXEC CICS REWRITE
  4484*        DATASET (WS-CONTROL-FILE-DSID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL687.cbl
  4485*        FROM    (CONTROL-FILE) END-EXEC.
  4486     MOVE LENGTH OF
  4487      CONTROL-FILE
  4488       TO DFHEIV11
  4489*    MOVE '&& L                  %   #00004260' TO DFHEIV0
  4490     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  4491     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4492     MOVE X'2020233030303034323630' TO DFHEIV0(25:11)
  4493     CALL 'kxdfhei1' USING DFHEIV0,
  4494           WS-CONTROL-FILE-DSID,
  4495           CONTROL-FILE,
  4496           DFHEIV11,
  4497           DFHEIV99
  4498     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4499
  4500
  4501     PERFORM 8400-LOG-JOURNAL-RECORD.
  4502
  4503     MOVE EIBTRMID               TO  PI-TSK-TERM-ID.
  4504     MOVE EIBTIME                TO  PI-TSK-TIME.
  4505
  4506     IF PI-COMPANY-ID = 'DMD' OR 'CID' OR 'AHL'
  4507*        MOVE EIBTRMID       TO PI-CHECK-PRINTER-ID
  4508
  4509* EXEC CICS START
  4510*            TRANSID (WS-CHECK-WRITER-TRANS-ID)
  4511*            FROM    (PROGRAM-INTERFACE-BLOCK)
  4512*            LENGTH  (PI-COMM-LENGTH)
  4513*            TERMID  (PI-CHECK-PRINTER-ID)
  4514*        END-EXEC
  4515*    MOVE '0( LF                 0   #00004271' TO DFHEIV0
  4516     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  4517     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  4518     MOVE X'2020233030303034323731' TO DFHEIV0(25:11)
  4519     CALL 'kxdfhei1' USING DFHEIV0,
  4520           DFHEIV99,
  4521           WS-CHECK-WRITER-TRANS-ID,
  4522           DFHEIV99,
  4523           PROGRAM-INTERFACE-BLOCK,
  4524           PI-COMM-LENGTH,
  4525           DFHEIV99,
  4526           DFHEIV99,
  4527           DFHEIV99,
  4528           DFHEIV99,
  4529           DFHEIV99,
  4530           DFHEIV99,
  4531           DFHEIV99,
  4532           DFHEIV99,
  4533           DFHEIV99,
  4534           DFHEIV99
  4535     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4536     ELSE
  4537
  4538* EXEC CICS START
  4539*            TRANSID (WS-CHECK-WRITER-TRANS-ID)
  4540*            FROM    (PROGRAM-INTERFACE-BLOCK)
  4541*            LENGTH  (PI-COMM-LENGTH)
  4542*            TERMID  (PI-CHECK-PRINTER-ID)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL687.cbl
  4543*        END-EXEC.
  4544*    MOVE '0( LFT                0   #00004278' TO DFHEIV0
  4545     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  4546     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  4547     MOVE X'2020233030303034323738' TO DFHEIV0(25:11)
  4548     CALL 'kxdfhei1' USING DFHEIV0,
  4549           DFHEIV99,
  4550           WS-CHECK-WRITER-TRANS-ID,
  4551           DFHEIV99,
  4552           PROGRAM-INTERFACE-BLOCK,
  4553           PI-COMM-LENGTH,
  4554           PI-CHECK-PRINTER-ID,
  4555           DFHEIV99,
  4556           DFHEIV99,
  4557           DFHEIV99,
  4558           DFHEIV99,
  4559           DFHEIV99,
  4560           DFHEIV99,
  4561           DFHEIV99,
  4562           DFHEIV99,
  4563           DFHEIV99
  4564     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4565
  4566
  4567     MOVE +1                     TO  PI-PRINTER-STARTED-SW.
  4568
  4569
  4570* EXEC CICS GETMAIN
  4571*        SET     (ADDRESS OF CHECK-QUE)
  4572*        LENGTH  (WS-ERCHKQ-LENGTH)
  4573*        INITIMG (WS-SPACES) END-EXEC.
  4574*    MOVE ',"IL                  $   #00004287' TO DFHEIV0
  4575     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  4576     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4577     MOVE X'2020233030303034323837' TO DFHEIV0(25:11)
  4578     CALL 'kxdfhei1' USING DFHEIV0,
  4579           DFHEIV20,
  4580           WS-ERCHKQ-LENGTH,
  4581           WS-SPACES
  4582     SET ADDRESS OF CHECK-QUE TO
  4583         DFHEIV20
  4584     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4585
  4586
  4587 0245-MAIN-LOGIC.
  4588     MOVE SPACES                 TO  CHECK-QUE.
  4589
  4590     MOVE 'CQ'                   TO  CQ-RECORD-ID.
  4591
  4592     MOVE PI-COMPANY-CD          TO  CQ-COMPANY-CD.
  4593     MOVE 'A'                    TO  CQ-ENTRY-TYPE.
  4594
  4595     MOVE PI-ALIGNMENT-CONTROL-GROUP  TO  CQ-CONTROL-NUMBER.
  4596
  4597     MOVE ZERO                   TO  CQ-CHECK-AMOUNT.
  4598     MOVE +1                     TO  CQ-TIMES-PRINTED.
  4599     MOVE WS-CURRENT-DATE        TO  CQ-CHECK-WRITTEN-DT.
  4600
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL687.cbl
  4601     MOVE WS-CHECK-QUEUE-DSID    TO  JP-FILE-ID.
  4602     MOVE 'A'                    TO  JP-RECORD-TYPE.
  4603
  4604     MOVE +6870                  TO  CQ-LAST-UPDATED-BY.
  4605
  4606 0250-MAIN-LOGIC.
  4607     IF AACNI = 'Y'
  4608         MOVE WS-CHECK-NUMBER-X  TO  CQ-CHECK-NUMBER
  4609         ADD +1  TO  WS-CHECK-NUMBER
  4610         MOVE '1'                TO  CQ-PRE-NUMBERING-SW.
  4611
  4612     MOVE PI-ALIGNMENT-SEQUENCE-NO  TO  CQ-SEQUENCE-NUMBER.
  4613     ADD +1  TO  PI-ALIGNMENT-SEQUENCE-NO.
  4614
  4615     MOVE SPACES                 TO  CHECK-PASS-AREA.
  4616
  4617     MOVE +1                     TO  CPA-ALIGNMENT.
  4618     MOVE CQ-CHECK-NUMBER        TO  CPA-CHECK-NUMBER.
  4619
  4620     PERFORM 0800-PRINT-CHECK.
  4621
  4622     IF AACNI = 'Y'
  4623         MOVE CHECK-QUE          TO  JP-RECORD-AREA
  4624
  4625* EXEC CICS WRITE
  4626*            DATASET (WS-CHECK-QUEUE-DSID)
  4627*            RIDFLD  (CQ-CONTROL-PRIMARY)
  4628*            FROM    (CHECK-QUE) END-EXEC
  4629     MOVE LENGTH OF
  4630      CHECK-QUE
  4631       TO DFHEIV11
  4632*    MOVE '&$ L                  ''   #00004329' TO DFHEIV0
  4633     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  4634     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4635     MOVE X'2020233030303034333239' TO DFHEIV0(25:11)
  4636     CALL 'kxdfhei1' USING DFHEIV0,
  4637           WS-CHECK-QUEUE-DSID,
  4638           CHECK-QUE,
  4639           DFHEIV11,
  4640           CQ-CONTROL-PRIMARY,
  4641           DFHEIV99,
  4642           DFHEIV99
  4643     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4644         PERFORM 8400-LOG-JOURNAL-RECORD.
  4645
  4646     SUBTRACT +1 FROM PI-NUMBER-OF-ALIGNMENT-CHECKS.
  4647
  4648     IF PI-NUMBER-OF-ALIGNMENT-CHECKS IS GREATER THAN ZERO
  4649         GO TO 0250-MAIN-LOGIC.
  4650
  4651     MOVE SPACES                 TO  AALIGNI.
  4652     MOVE AL-UNNOF               TO  AALIGNA.
  4653     MOVE -1                     TO  AALIGNL.
  4654     MOVE ER-0362                TO  EMI-ERROR.
  4655     PERFORM 8200-SEND-DATAONLY.
  4656
  4657
  4658* EXEC CICS SYNCPOINT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL687.cbl
  4659*        END-EXEC.
  4660*    MOVE '6"                    !   #00004346' TO DFHEIV0
  4661     MOVE X'362220202020202020202020' TO DFHEIV0(1:12)
  4662     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4663     MOVE X'2020233030303034333436' TO DFHEIV0(25:11)
  4664     CALL 'kxdfhei1' USING DFHEIV0
  4665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4666
  4667
  4668     GO TO 0040-MAIN-LOGIC.
  4669
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL687.cbl
  4671 0300-MAIN-LOGIC.
  4672     IF PI-PRINTER-STARTED-SW = ZERO
  4673         MOVE +1                 TO  PI-PRINTER-STARTED-SW
  4674         MOVE EIBTRMID TO PI-TSK-TERM-ID
  4675         MOVE EIBTIME  TO PI-TSK-TIME
  4676
  4677         IF PI-COMPANY-ID = 'DMD' OR 'CID' OR 'AHL'
  4678*            MOVE EIBTRMID       TO PI-CHECK-PRINTER-ID
  4679
  4680* EXEC CICS START
  4681*                TRANSID (WS-CHECK-WRITER-TRANS-ID)
  4682*                FROM    (PROGRAM-INTERFACE-BLOCK)
  4683*                LENGTH  (PI-COMM-LENGTH)
  4684*                TERMID  (PI-CHECK-PRINTER-ID)
  4685*            END-EXEC
  4686*    MOVE '0( LF                 0   #00004360' TO DFHEIV0
  4687     MOVE X'3028204C4620202020202020' TO DFHEIV0(1:12)
  4688     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  4689     MOVE X'2020233030303034333630' TO DFHEIV0(25:11)
  4690     CALL 'kxdfhei1' USING DFHEIV0,
  4691           DFHEIV99,
  4692           WS-CHECK-WRITER-TRANS-ID,
  4693           DFHEIV99,
  4694           PROGRAM-INTERFACE-BLOCK,
  4695           PI-COMM-LENGTH,
  4696           DFHEIV99,
  4697           DFHEIV99,
  4698           DFHEIV99,
  4699           DFHEIV99,
  4700           DFHEIV99,
  4701           DFHEIV99,
  4702           DFHEIV99,
  4703           DFHEIV99,
  4704           DFHEIV99,
  4705           DFHEIV99
  4706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4707         ELSE
  4708
  4709* EXEC CICS START
  4710*                TRANSID (WS-CHECK-WRITER-TRANS-ID)
  4711*                FROM    (PROGRAM-INTERFACE-BLOCK)
  4712*                LENGTH  (PI-COMM-LENGTH)
  4713*                TERMID  (PI-CHECK-PRINTER-ID)
  4714*            END-EXEC.
  4715*    MOVE '0( LFT                0   #00004367' TO DFHEIV0
  4716     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  4717     MOVE X'202020202020202020203020' TO DFHEIV0(13:12)
  4718     MOVE X'2020233030303034333637' TO DFHEIV0(25:11)
  4719     CALL 'kxdfhei1' USING DFHEIV0,
  4720           DFHEIV99,
  4721           WS-CHECK-WRITER-TRANS-ID,
  4722           DFHEIV99,
  4723           PROGRAM-INTERFACE-BLOCK,
  4724           PI-COMM-LENGTH,
  4725           PI-CHECK-PRINTER-ID,
  4726           DFHEIV99,
  4727           DFHEIV99,
  4728           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL687.cbl
  4729           DFHEIV99,
  4730           DFHEIV99,
  4731           DFHEIV99,
  4732           DFHEIV99,
  4733           DFHEIV99,
  4734           DFHEIV99
  4735     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4736
  4737
  4738     SET PI-INDEX TO +1.
  4739
  4740     MOVE LOW-VALUES             TO  WS-CHECK-QUEUE-KEY.
  4741     MOVE +5                     TO  WS-KEY-LENGTH.
  4742
  4743     MOVE PI-COMPANY-CD          TO  WS-CQK-COMPANY-CD.
  4744
  4745 0310-MAIN-LOGIC.
  4746     IF AOPTIONI = '1'
  4747
  4748* EXEC CICS STARTBR
  4749*            DATASET (WS-CHECK-QUEUE-DSID)
  4750*            RIDFLD  (WS-CHECK-QUEUE-KEY)
  4751*            GTEQ    END-EXEC
  4752     MOVE 0
  4753       TO DFHEIV11
  4754*    MOVE '&,         G          &   #00004383' TO DFHEIV0
  4755     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  4756     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4757     MOVE X'2020233030303034333833' TO DFHEIV0(25:11)
  4758     CALL 'kxdfhei1' USING DFHEIV0,
  4759           WS-CHECK-QUEUE-DSID,
  4760           WS-CHECK-QUEUE-KEY,
  4761           DFHEIV99,
  4762           DFHEIV11,
  4763           DFHEIV99
  4764     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4765       ELSE
  4766         MOVE PI-CONTROL-GROUP (PI-INDEX) TO WS-CQK-CONTROL-NUMBER
  4767         ADD +1  PI-HIGH-SEQUENCE (PI-INDEX)
  4768             GIVING WS-SEQUENCE-NUMBER
  4769         MOVE ZERO               TO  WS-CQK-SEQUENCE-NUMBER
  4770         IF WS-CHECK-QUEUE-BROWSE-SW = ZERO
  4771
  4772* EXEC CICS STARTBR
  4773*                DATASET   (WS-CHECK-QUEUE-DSID)
  4774*                RIDFLD    (WS-CHECK-QUEUE-KEY)
  4775*                KEYLENGTH (WS-KEY-LENGTH)
  4776*                GENERIC   EQUAL END-EXEC
  4777     MOVE 0
  4778       TO DFHEIV11
  4779*    MOVE '&,   KG    E          &   #00004393' TO DFHEIV0
  4780     MOVE X'262C2020204B472020202045' TO DFHEIV0(1:12)
  4781     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4782     MOVE X'2020233030303034333933' TO DFHEIV0(25:11)
  4783     CALL 'kxdfhei1' USING DFHEIV0,
  4784           WS-CHECK-QUEUE-DSID,
  4785           WS-CHECK-QUEUE-KEY,
  4786           WS-KEY-LENGTH,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL687.cbl
  4787           DFHEIV11,
  4788           DFHEIV99
  4789     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4790             MOVE +1             TO  WS-CHECK-QUEUE-BROWSE-SW
  4791           ELSE
  4792
  4793* EXEC CICS RESETBR
  4794*                DATASET   (WS-CHECK-QUEUE-DSID)
  4795*                RIDFLD    (WS-CHECK-QUEUE-KEY)
  4796*                KEYLENGTH (WS-KEY-LENGTH)
  4797*                GENERIC   EQUAL END-EXEC.
  4798     MOVE 0
  4799       TO DFHEIV11
  4800*    MOVE '&4   KG    E          &   #00004400' TO DFHEIV0
  4801     MOVE X'26342020204B472020202045' TO DFHEIV0(1:12)
  4802     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  4803     MOVE X'2020233030303034343030' TO DFHEIV0(25:11)
  4804     CALL 'kxdfhei1' USING DFHEIV0,
  4805           WS-CHECK-QUEUE-DSID,
  4806           WS-CHECK-QUEUE-KEY,
  4807           WS-KEY-LENGTH,
  4808           DFHEIV11,
  4809           DFHEIV99
  4810     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4811
  4812
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL687.cbl
  4814 0320-MAIN-LOGIC.
  4815
  4816* EXEC CICS HANDLE CONDITION
  4817*        NOTFND
  4818*        ENDFILE (0390-MAIN-LOGIC) END-EXEC.
  4819*    MOVE '"$''                  ! % #00004408' TO DFHEIV0
  4820     MOVE X'2224B9272020202020202020' TO DFHEIV0(1:12)
  4821     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4822     MOVE X'2520233030303034343038' TO DFHEIV0(25:11)
  4823     CALL 'kxdfhei1' USING DFHEIV0
  4824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4825
  4826
  4827 0325-MAIN-LOGIC.
  4828
  4829
  4830* EXEC CICS READNEXT
  4831*        DATASET (WS-CHECK-QUEUE-DSID)
  4832*        RIDFLD  (WS-CHECK-QUEUE-KEY)
  4833*        SET     (ADDRESS OF CHECK-QUE) END-EXEC.
  4834     MOVE 0
  4835       TO DFHEIV11
  4836*    MOVE '&.S                   )   #00004414' TO DFHEIV0
  4837     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  4838     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  4839     MOVE X'2020233030303034343134' TO DFHEIV0(25:11)
  4840     CALL 'kxdfhei1' USING DFHEIV0,
  4841           WS-CHECK-QUEUE-DSID,
  4842           DFHEIV20,
  4843           DFHEIV99,
  4844           WS-CHECK-QUEUE-KEY,
  4845           DFHEIV99,
  4846           DFHEIV11,
  4847           DFHEIV99,
  4848           DFHEIV99
  4849     SET ADDRESS OF CHECK-QUE TO
  4850         DFHEIV20
  4851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4852
  4853
  4854     IF WS-CHECK-QUEUE-KEY NOT GREATER WS-LAST-CHECK-QUEUE-KEY
  4855         GO TO 0325-MAIN-LOGIC.
  4856
  4857     MOVE WS-CHECK-QUEUE-KEY    TO WS-LAST-CHECK-QUEUE-KEY.
  4858
  4859     IF CQ-COMPANY-CD NOT = PI-COMPANY-CD
  4860         GO TO 0390-MAIN-LOGIC.
  4861
  4862     IF AOPTIONI = ('2' OR '3')
  4863         IF CQ-CONTROL-NUMBER = PI-CONTROL-GROUP (PI-INDEX)
  4864          AND CQ-SEQUENCE-NUMBER NOT GREATER THAN PI-HIGH-SEQUENCE
  4865                                                       (PI-INDEX)
  4866             NEXT SENTENCE
  4867           ELSE
  4868             GO TO 0390-MAIN-LOGIC.
  4869
  4870     IF CQ-ENTRY-TYPE NOT = 'Q'
  4871         GO TO 0325-MAIN-LOGIC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL687.cbl
  4872
  4873     IF (AOPTIONI NOT = '3' AND
  4874         CQ-TIMES-PRINTED GREATER THAN ZERO)
  4875       OR
  4876        (AOPTIONI = '3' AND
  4877         CQ-TIMES-PRINTED NOT GREATER THAN ZERO)
  4878             GO TO 0325-MAIN-LOGIC.
  4879
  4880
  4881* EXEC CICS ENDBR
  4882*        DATASET (WS-CHECK-QUEUE-DSID) END-EXEC.
  4883     MOVE 0
  4884       TO DFHEIV11
  4885*    MOVE '&2                    $   #00004445' TO DFHEIV0
  4886     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  4887     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  4888     MOVE X'2020233030303034343435' TO DFHEIV0(25:11)
  4889     CALL 'kxdfhei1' USING DFHEIV0,
  4890           WS-CHECK-QUEUE-DSID,
  4891           DFHEIV11,
  4892           DFHEIV99
  4893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4894
  4895
  4896
  4897* EXEC CICS READ UPDATE
  4898*        DATASET (WS-CHECK-QUEUE-DSID)
  4899*        RIDFLD  (WS-CHECK-QUEUE-KEY)
  4900*        SET     (ADDRESS OF CHECK-QUE) END-EXEC.
  4901*    MOVE '&"S        EU         (   #00004448' TO DFHEIV0
  4902     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4903     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4904     MOVE X'2020233030303034343438' TO DFHEIV0(25:11)
  4905     CALL 'kxdfhei1' USING DFHEIV0,
  4906           WS-CHECK-QUEUE-DSID,
  4907           DFHEIV20,
  4908           DFHEIV99,
  4909           WS-CHECK-QUEUE-KEY,
  4910           DFHEIV99,
  4911           DFHEIV99,
  4912           DFHEIV99
  4913     SET ADDRESS OF CHECK-QUE TO
  4914         DFHEIV20
  4915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4916
  4917
  4918     MOVE CHECK-QUE              TO  WS-OLD-CHECK-QUEUE-RECORD.
  4919
  4920     IF AACNI = 'Y'
  4921         MOVE WS-CHECK-NUMBER-X  TO  CQ-CHECK-NUMBER
  4922         ADD +1  TO  WS-CHECK-NUMBER
  4923         MOVE '1'                TO  CQ-PRE-NUMBERING-SW.
  4924
  4925*    NOTE *******************************************************
  4926*         *                PRINT THE CHECK                      *
  4927*         *******************************************************.
  4928
  4929     IF CQ-CHECK-MAINT-PMT OR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL687.cbl
  4930        CQ-REFUND-PMT
  4931         GO TO 0350-MAIN-LOGIC.
  4932
  4933*    NOTE *******************************************************
  4934*         *                PRINT BILLING CHECKS                 *
  4935*         *******************************************************.
  4936
  4937     MOVE SPACES                 TO  CHECK-PASS-AREA.
  4938     MOVE LOW-VALUES             TO  WS-COMPENSATION-MASTER-KEY
  4939                                     WS-PENDING-PAYMENTS-KEY.
  4940     MOVE PI-COMPANY-CD          TO  WS-CM-COMPANY-CD
  4941                                     WS-PPK-COMPANY-CD.
  4942     MOVE CQ-PYAJ-CARRIER        TO  WS-CM-CARRIER
  4943                                     CPA-CARRIER
  4944                                     WS-PPK-CARRIER.
  4945     MOVE CQ-PYAJ-GROUPING       TO  WS-CM-GROUPING
  4946                                     CPA-GROUPING
  4947                                     WS-PPK-GROUPING.
  4948     MOVE CQ-PYAJ-FIN-RESP       TO  WS-CM-FIN-RESP
  4949                                     CPA-FIN-RESP
  4950                                     WS-PPK-FIN-RESP.
  4951     MOVE CQ-PYAJ-ACCOUNT        TO  WS-CM-ACCOUNT
  4952                                     CPA-ACCOUNT
  4953                                     WS-PPK-ACCOUNT.
  4954     MOVE CQ-PYAJ-SEQ            TO  WS-PPK-FILE-SEQ-NO.
  4955     MOVE 'C'                    TO  WS-PPK-RECORD-TYPE.
  4956
  4957     IF CQ-PYAJ-ACCOUNT NOT = LOW-VALUES
  4958        MOVE 'A'                 TO  WS-CM-TYPE
  4959     ELSE
  4960        MOVE 'G'                 TO  WS-CM-TYPE.
  4961
  4962
  4963* EXEC CICS READ
  4964*        DATASET (WS-COMPENSATION-MASTER-DSID)
  4965*        RIDFLD  (WS-COMPENSATION-MASTER-KEY)
  4966*        SET     (ADDRESS OF COMPENSATION-MASTER) END-EXEC.
  4967*    MOVE '&"S        E          (   #00004497' TO DFHEIV0
  4968     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4969     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4970     MOVE X'2020233030303034343937' TO DFHEIV0(25:11)
  4971     CALL 'kxdfhei1' USING DFHEIV0,
  4972           WS-COMPENSATION-MASTER-DSID,
  4973           DFHEIV20,
  4974           DFHEIV99,
  4975           WS-COMPENSATION-MASTER-KEY,
  4976           DFHEIV99,
  4977           DFHEIV99,
  4978           DFHEIV99
  4979     SET ADDRESS OF COMPENSATION-MASTER TO
  4980         DFHEIV20
  4981     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4982
  4983
  4984
  4985* EXEC CICS READ UPDATE
  4986*        DATASET (WS-PENDING-PAYMENTS-DSID)
  4987*        RIDFLD  (WS-PENDING-PAYMENTS-KEY)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL687.cbl
  4988*        SET     (ADDRESS OF PENDING-PAY-ADJ) END-EXEC.
  4989*    MOVE '&"S        EU         (   #00004502' TO DFHEIV0
  4990     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  4991     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  4992     MOVE X'2020233030303034353032' TO DFHEIV0(25:11)
  4993     CALL 'kxdfhei1' USING DFHEIV0,
  4994           WS-PENDING-PAYMENTS-DSID,
  4995           DFHEIV20,
  4996           DFHEIV99,
  4997           WS-PENDING-PAYMENTS-KEY,
  4998           DFHEIV99,
  4999           DFHEIV99,
  5000           DFHEIV99
  5001     SET ADDRESS OF PENDING-PAY-ADJ TO
  5002         DFHEIV20
  5003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5004
  5005
  5006     MOVE ZERO                   TO  CPA-ALIGNMENT.
  5007     MOVE SPACES                 TO  CPA-CERT-NO.
  5008     MOVE ZEROS                  TO  WS-CHECK-NO.
  5009     MOVE CQ-PAYMENT-TYPE        TO  CPA-PAYMENT-TYPE.
  5010     MOVE CQ-CHECK-BY-USER       TO  CPA-PAYMENT-BY.
  5011     MOVE CQ-CHECK-NUMBER        TO  CPA-CHECK-NUMBER
  5012                                     WS-CHECK-NO.
  5013     MOVE WS-CHECK-WORK          TO  PY-CHECK-NUMBER.
  5014     MOVE CQ-CHECK-AMOUNT        TO  CPA-AMOUNT-PAID.
  5015     MOVE ZEROS                  TO  CPA-AMOUNT-PAID-TO-DATE
  5016                                     CPA-NO-OF-PMTS-MADE
  5017                                     CPA-LF-REFUND
  5018                                     CPA-AH-REFUND
  5019                                     CPA-DEDUCT-WITHHELD
  5020                                     CPA-ADDITIONAL-CHARGE.
  5021     MOVE PY-REPORTED-DT         TO  CPA-REPORTED-DT.
  5022     MOVE LOW-VALUES             TO  CPA-INCURRED-DT
  5023                                     CPA-PAID-THRU-DT
  5024                                     CPA-PAID-FROM-DT
  5025                                     CPA-PAID-DT
  5026                                     CPA-CERT-EFF-DT.
  5027     MOVE ZEROS                  TO  CPA-CAR-ZIP-CODE.
  5028     MOVE CO-MAIL-NAME           TO  CPA-PAYEE-IN-CARE-OF.
  5029     MOVE CO-ACCT-NAME           TO  CPA-PAYEE-NAME.
  5030     MOVE CO-ADDR-1              TO  CPA-PAYEE-ADDRESS-LINE1.
  5031     MOVE CO-ADDR-2              TO  CPA-PAYEE-ADDRESS-LINE2.
  5032*    MOVE CO-ADDR-3              TO  CPA-PAYEE-CITY-ST.
  5033     STRING CO-ADDR-CITY ' ' CO-ADDR-STATE
  5034        DELIMITED BY '  ' INTO CPA-PAYEE-CITY-ST
  5035     END-STRING
  5036     MOVE CO-TELEPHONE           TO  CPA-PAYEE-PHONE-NO.
  5037     MOVE CO-ZIP                 TO  CPA-PAYEE-ZIP-CODE.
  5038
  5039     IF NOT CO-CANADIAN-POST-CODE
  5040         INSPECT CPA-PAYEE-ZIP-CODE REPLACING ALL ' ' BY ZEROS
  5041         IF CPA-PAYEE-ZIP-PRIME NUMERIC
  5042             MOVE SPACES         TO CPA-PAYEE-ZIP-PLUS4
  5043         ELSE
  5044             MOVE ZEROS          TO CPA-PAYEE-ZIP-CODE.
  5045
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL687.cbl
  5046     MOVE SPACES                 TO  WS-SSN-STATE
  5047                                     WS-MEMBER-STATE
  5048                                     CPA-MEMBER-NUMBER
  5049                                     WS-SSN-LN3
  5050                                     WS-MEMBER-LN4.
  5051     MOVE CO-ACCT-PRIME          TO  WS-SSN-ACCOUNT
  5052                                     WS-MEMBER-ACCOUNT.
  5053     MOVE CO-SOC-SEC             TO  CPA-SOC-SEC-NO.
  5054     MOVE WS-CURRENT-DATE        TO  CPA-CHECK-DATE
  5055                                     CQ-CHECK-WRITTEN-DT
  5056                                     PY-CHECK-WRITTEN-DT.
  5057
  5058     IF  PY-LETTER (1) GREATER THAN SPACES
  5059         MOVE 'Y'                TO  PI-LETTERS-IND
  5060
  5061     ELSE
  5062         MOVE LOW-VALUES         TO  PI-LETTERS-IND.
  5063
  5064     IF PI-COMPANY-ID = 'ITY'
  5065         MOVE PY-ENTRY-COMMENT   TO  CPA-STUB5.
  5066
  5067     IF AOPTIONI = '3'
  5068       AND CQ-PRE-NUMBERING-SW = '1'
  5069         MOVE WS-SEQUENCE-NUMBER TO  PY-CHECK-QUE-SEQUENCE.
  5070
  5071     MOVE PENDING-PAY-ADJ        TO  JP-RECORD-AREA.
  5072
  5073     MOVE +6870                  TO  CQ-LAST-UPDATED-BY.
  5074
  5075
  5076* EXEC CICS REWRITE
  5077*        DATASET (WS-PENDING-PAYMENTS-DSID)
  5078*        FROM    (PENDING-PAY-ADJ)  END-EXEC.
  5079     MOVE LENGTH OF
  5080      PENDING-PAY-ADJ
  5081       TO DFHEIV11
  5082*    MOVE '&& L                  %   #00004576' TO DFHEIV0
  5083     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5084     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5085     MOVE X'2020233030303034353736' TO DFHEIV0(25:11)
  5086     CALL 'kxdfhei1' USING DFHEIV0,
  5087           WS-PENDING-PAYMENTS-DSID,
  5088           PENDING-PAY-ADJ,
  5089           DFHEIV11,
  5090           DFHEIV99
  5091     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5092
  5093
  5094     MOVE WS-PENDING-PAYMENTS-DSID TO  JP-FILE-ID.
  5095     MOVE 'C'                      TO  JP-RECORD-TYPE.
  5096     PERFORM 8400-LOG-JOURNAL-RECORD.
  5097
  5098     GO TO 0375-MAIN-LOGIC.
  5099
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL687.cbl
  5101 0350-MAIN-LOGIC.
  5102*    NOTE *******************************************************
  5103*         *         PRINT REFUND OR MISCELLANEOUS CHECKS        *
  5104*         *******************************************************.
  5105
  5106     MOVE SPACES                 TO  CHECK-PASS-AREA.
  5107     MOVE ZERO                   TO  CPA-ALIGNMENT.
  5108     MOVE LOW-VALUES             TO  WS-CHECK-MAINT-KEY.
  5109     MOVE PI-COMPANY-CD          TO  WS-CMK-COMPANY-CD.
  5110     MOVE CQ-CHEK-CARRIER        TO  WS-CMK-CARRIER
  5111                                     CPA-CARRIER.
  5112     MOVE CQ-CHEK-GROUPING       TO  WS-CMK-GROUPING
  5113                                     CPA-GROUPING.
  5114     MOVE CQ-CHEK-STATE          TO  WS-CMK-STATE
  5115                                     CPA-STATE.
  5116     MOVE CQ-CHEK-ACCOUNT        TO  WS-CMK-ACCOUNT
  5117                                     CPA-ACCOUNT.
  5118     MOVE CQ-CHEK-CERT-NO        TO  WS-CMK-CERT-NO
  5119                                     CPA-CERT-NO.
  5120     MOVE CQ-CHEK-CERT-EFF-DT    TO  WS-CMK-CERT-EFF-DT.
  5121     MOVE CQ-CHEK-SEQ-NO         TO  WS-CMK-SEQ-NO.
  5122
  5123
  5124* EXEC CICS READ UPDATE
  5125*        DATASET (WS-CHECK-MAINT-DSID)
  5126*        RIDFLD  (WS-CHECK-MAINT-KEY)
  5127*        SET     (ADDRESS OF CHECK-RECORDS) END-EXEC.
  5128*    MOVE '&"S        EU         (   #00004609' TO DFHEIV0
  5129     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5130     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5131     MOVE X'2020233030303034363039' TO DFHEIV0(25:11)
  5132     CALL 'kxdfhei1' USING DFHEIV0,
  5133           WS-CHECK-MAINT-DSID,
  5134           DFHEIV20,
  5135           DFHEIV99,
  5136           WS-CHECK-MAINT-KEY,
  5137           DFHEIV99,
  5138           DFHEIV99,
  5139           DFHEIV99
  5140     SET ADDRESS OF CHECK-RECORDS TO
  5141         DFHEIV20
  5142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5143
  5144
  5145     IF CH-LF-REFUND NOT NUMERIC
  5146         MOVE ZEROS              TO  CH-LF-REFUND.
  5147     IF CH-AH-REFUND NOT NUMERIC
  5148         MOVE ZEROS              TO  CH-AH-REFUND.
  5149     IF CH-DEDUCT-WITHHELD NOT NUMERIC
  5150         MOVE ZEROS              TO  CH-DEDUCT-WITHHELD.
  5151     IF CH-ADDITIONAL-CHARGE NOT NUMERIC
  5152         MOVE ZEROS              TO  CH-ADDITIONAL-CHARGE.
  5153
  5154     MOVE ZERO                   TO  CPA-ALIGNMENT.
  5155     MOVE CQ-PAYMENT-TYPE        TO  CPA-PAYMENT-TYPE.
  5156     MOVE CQ-CHECK-BY-USER       TO  CPA-PAYMENT-BY.
  5157     MOVE CQ-CHECK-NUMBER        TO  CPA-CHECK-NUMBER
  5158                                     CH-CHECK-NO.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL687.cbl
  5159     MOVE CQ-CHECK-AMOUNT        TO  CPA-AMOUNT-PAID.
  5160     MOVE ZEROS                  TO  CPA-AMOUNT-PAID-TO-DATE
  5161                                     CPA-NO-OF-PMTS-MADE.
  5162     MOVE CH-RECORDED-DT         TO  CPA-REPORTED-DT.
  5163     MOVE LOW-VALUES             TO  CPA-INCURRED-DT
  5164                                     CPA-PAID-THRU-DT
  5165                                     CPA-PAID-FROM-DT
  5166                                     CPA-PAID-DT.
  5167     MOVE ZEROS                  TO  CPA-CAR-ZIP-CODE.
  5168     MOVE CH-PAYEE-NAME-1        TO  CPA-PAYEE-NAME.
  5169     MOVE CH-PAYEE-NAME-2        TO  CPA-PAYEE-IN-CARE-OF.
  5170     MOVE CH-PAYEE-ADDRESS-1     TO  CPA-PAYEE-ADDRESS-LINE1.
  5171
  5172     IF CH-PAYEE-CITY-ST EQUAL SPACES
  5173         MOVE CH-PAYEE-ADDRESS-2
  5174                                 TO  CPA-PAYEE-CITY-ST
  5175         MOVE SPACES             TO  CPA-PAYEE-ADDRESS-LINE2
  5176     ELSE
  5177         MOVE CH-PAYEE-ADDRESS-2
  5178                                 TO  CPA-PAYEE-ADDRESS-LINE2
  5179         MOVE CH-PAYEE-CITY-ST   TO  CPA-PAYEE-CITY-ST.
  5180
  5181     MOVE CH-STUB-LINE-1         TO  CPA-STUB1.
  5182     MOVE CH-STUB-LINE-2         TO  CPA-STUB2.
  5183     MOVE CH-STUB-LINE-3         TO  CPA-STUB3.
  5184     MOVE CH-STUB-LINE-4         TO  CPA-STUB4.
  5185     MOVE CH-PAYEE-ZIP-CODE      TO  CPA-PAYEE-ZIP-CODE.
  5186
  5187     IF CQ-REFUND-PMT
  5188         MOVE CH-CANC-DT         TO  CPA-CANC-DT
  5189         MOVE CH-CERT-EFF-DT     TO  CPA-CERT-EFF-DT
  5190         MOVE CH-INSURED-NAME    TO  CPA-INSURED-NAME
  5191     ELSE
  5192         MOVE LOW-VALUES         TO  CPA-CANC-DT
  5193                                     CPA-CERT-EFF-DT
  5194         MOVE SPACES             TO  CPA-INSURED-NAME.
  5195
  5196     MOVE CH-LF-REFUND           TO  CPA-LF-REFUND.
  5197     MOVE CH-AH-REFUND           TO  CPA-AH-REFUND.
  5198     MOVE CH-DEDUCT-WITHHELD     TO  CPA-DEDUCT-WITHHELD.
  5199     MOVE CH-ADDITIONAL-CHARGE   TO  CPA-ADDITIONAL-CHARGE.
  5200
  5201     MOVE SPACES                 TO  WS-SSN-STATE
  5202                                     WS-MEMBER-STATE
  5203                                     CPA-MEMBER-NUMBER
  5204                                     WS-SSN-LN3
  5205                                     WS-MEMBER-LN4.
  5206     MOVE CO-ACCT-PRIME          TO  WS-SSN-ACCOUNT
  5207                                     WS-MEMBER-ACCOUNT.
  5208     MOVE CO-SOC-SEC             TO  CPA-SOC-SEC-NO.
  5209     MOVE WS-CURRENT-DATE        TO  CPA-CHECK-DATE
  5210                                     CQ-CHECK-WRITTEN-DT
  5211                                     CH-CHECK-WRITTEN-DT.
  5212     IF AOPTIONI = '3'
  5213       AND CQ-PRE-NUMBERING-SW = '1'
  5214         MOVE WS-SEQUENCE-NUMBER TO  CH-CHECK-QUE-SEQUENCE.
  5215
  5216     MOVE CHECK-RECORDS          TO  JP-RECORD-AREA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL687.cbl
  5217
  5218     IF  CH-LETTERS (1) GREATER THAN SPACES
  5219         MOVE 'Y'                TO  PI-LETTERS-IND
  5220
  5221     ELSE
  5222         MOVE LOW-VALUES         TO  PI-LETTERS-IND.
  5223
  5224     MOVE +6870                  TO  CQ-LAST-UPDATED-BY.
  5225
  5226
  5227* EXEC CICS REWRITE
  5228*        DATASET (WS-CHECK-MAINT-DSID)
  5229*        FROM    (CHECK-RECORDS)  END-EXEC.
  5230     MOVE LENGTH OF
  5231      CHECK-RECORDS
  5232       TO DFHEIV11
  5233*    MOVE '&& L                  %   #00004695' TO DFHEIV0
  5234     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5235     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5236     MOVE X'2020233030303034363935' TO DFHEIV0(25:11)
  5237     CALL 'kxdfhei1' USING DFHEIV0,
  5238           WS-CHECK-MAINT-DSID,
  5239           CHECK-RECORDS,
  5240           DFHEIV11,
  5241           DFHEIV99
  5242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5243
  5244
  5245     MOVE WS-CHECK-MAINT-DSID    TO  JP-FILE-ID.
  5246     MOVE 'C'                    TO  JP-RECORD-TYPE.
  5247     PERFORM 8400-LOG-JOURNAL-RECORD.
  5248
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL687.cbl
  5250
  5251 0375-MAIN-LOGIC.
  5252     ADD +1  TO  CQ-TIMES-PRINTED.
  5253
  5254     IF AOPTIONI = '3'
  5255       AND CQ-PRE-NUMBERING-SW = '1'
  5256         MOVE CHECK-QUE          TO  WS-NEW-CHECK-QUEUE-RECORD
  5257         MOVE WS-OLD-CHECK-QUEUE-RECORD  TO  CHECK-QUE
  5258         MOVE 'S'                TO  CQ-ENTRY-TYPE.
  5259
  5260     MOVE +6870                  TO  CQ-LAST-UPDATED-BY.
  5261
  5262     MOVE 'C'                    TO  JP-RECORD-TYPE.
  5263     MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  5264     MOVE WS-CHECK-QUEUE-DSID    TO  JP-FILE-ID.
  5265     MOVE PI-LETTERS-IND         TO  CQ-LETTERS-IND.
  5266
  5267
  5268* EXEC CICS REWRITE
  5269*        DATASET (WS-CHECK-QUEUE-DSID)
  5270*        FROM    (CHECK-QUE) END-EXEC.
  5271     MOVE LENGTH OF
  5272      CHECK-QUE
  5273       TO DFHEIV11
  5274*    MOVE '&& L                  %   #00004721' TO DFHEIV0
  5275     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5276     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5277     MOVE X'2020233030303034373231' TO DFHEIV0(25:11)
  5278     CALL 'kxdfhei1' USING DFHEIV0,
  5279           WS-CHECK-QUEUE-DSID,
  5280           CHECK-QUE,
  5281           DFHEIV11,
  5282           DFHEIV99
  5283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5284
  5285
  5286     PERFORM 8400-LOG-JOURNAL-RECORD.
  5287
  5288     IF AOPTIONI NOT = '3'
  5289         GO TO 0380-MAIN-LOGIC.
  5290
  5291     IF LCP-ONCTR-01 =  0
  5292         ADD 1 TO LCP-ONCTR-01
  5293                              ,
  5294
  5295* EXEC CICS GETMAIN
  5296*            SET    (WS-CQFCBAR)
  5297*            LENGTH  (WS-ERCHKQ-LENGTH)
  5298*            END-EXEC.
  5299*    MOVE '," L                  $   #00004733' TO DFHEIV0
  5300     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  5301     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5302     MOVE X'2020233030303034373333' TO DFHEIV0(25:11)
  5303     CALL 'kxdfhei1' USING DFHEIV0,
  5304           WS-CQFCBAR,
  5305           WS-ERCHKQ-LENGTH,
  5306           DFHEIV99
  5307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL687.cbl
  5308
  5309
  5310     MOVE WS-CQFCBAR             TO LCP-WS-ADDR-COMP
  5311     SET ADDRESS OF CHECK-QUE TO LCP-WS-ADDR-PNTR.
  5312
  5313     MOVE WS-NEW-CHECK-QUEUE-RECORD  TO  CHECK-QUE.
  5314
  5315     IF CQ-PRE-NUMBERING-SW NOT = '1'
  5316         GO TO 0380-MAIN-LOGIC.
  5317
  5318     MOVE 'Q'                    TO  CQ-ENTRY-TYPE.
  5319     MOVE PI-LETTERS-IND         TO  CQ-LETTERS-IND.
  5320
  5321     MOVE WS-SEQUENCE-NUMBER     TO  CQ-SEQUENCE-NUMBER.
  5322
  5323     ADD +1  TO  WS-SEQUENCE-NUMBER.
  5324
  5325     MOVE +6870                  TO  CQ-LAST-UPDATED-BY.
  5326
  5327     MOVE CHECK-QUE              TO  JP-RECORD-AREA.
  5328
  5329
  5330* EXEC CICS WRITE
  5331*        DATASET (WS-CHECK-QUEUE-DSID)
  5332*        RIDFLD  (CQ-CONTROL-PRIMARY)
  5333*        FROM    (CHECK-QUE) END-EXEC.
  5334     MOVE LENGTH OF
  5335      CHECK-QUE
  5336       TO DFHEIV11
  5337*    MOVE '&$ L                  ''   #00004757' TO DFHEIV0
  5338     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  5339     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5340     MOVE X'2020233030303034373537' TO DFHEIV0(25:11)
  5341     CALL 'kxdfhei1' USING DFHEIV0,
  5342           WS-CHECK-QUEUE-DSID,
  5343           CHECK-QUE,
  5344           DFHEIV11,
  5345           CQ-CONTROL-PRIMARY,
  5346           DFHEIV99,
  5347           DFHEIV99
  5348     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5349
  5350
  5351     MOVE 'A'                    TO  JP-RECORD-TYPE.
  5352     PERFORM 8400-LOG-JOURNAL-RECORD.
  5353
  5354 0380-MAIN-LOGIC.
  5355     PERFORM 0800-PRINT-CHECK.
  5356
  5357
  5358* EXEC CICS STARTBR
  5359*        DATASET (WS-CHECK-QUEUE-DSID)
  5360*        RIDFLD  (WS-CHECK-QUEUE-KEY)
  5361*        EQUAL   END-EXEC.
  5362     MOVE 0
  5363       TO DFHEIV11
  5364*    MOVE '&,         E          &   #00004768' TO DFHEIV0
  5365     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL687.cbl
  5366     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5367     MOVE X'2020233030303034373638' TO DFHEIV0(25:11)
  5368     CALL 'kxdfhei1' USING DFHEIV0,
  5369           WS-CHECK-QUEUE-DSID,
  5370           WS-CHECK-QUEUE-KEY,
  5371           DFHEIV99,
  5372           DFHEIV11,
  5373           DFHEIV99
  5374     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5375
  5376
  5377     GO TO 0320-MAIN-LOGIC.
  5378
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL687.cbl
  5380 0390-MAIN-LOGIC.
  5381     IF AOPTIONI NOT = '1'
  5382       AND PI-INDEX LESS THAN PI-NUMBER-OF-CONTROL-GROUPS
  5383         SET PI-INDEX UP BY +1
  5384         MOVE LOW-VALUES         TO WS-LAST-CHECK-QUEUE-KEY
  5385         GO TO 0310-MAIN-LOGIC.
  5386
  5387
  5388* EXEC CICS ENDBR
  5389*        DATASET (WS-CHECK-QUEUE-DSID) END-EXEC.
  5390     MOVE 0
  5391       TO DFHEIV11
  5392*    MOVE '&2                    $   #00004783' TO DFHEIV0
  5393     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5394     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5395     MOVE X'2020233030303034373833' TO DFHEIV0(25:11)
  5396     CALL 'kxdfhei1' USING DFHEIV0,
  5397           WS-CHECK-QUEUE-DSID,
  5398           DFHEIV11,
  5399           DFHEIV99
  5400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5401
  5402
  5403     IF PI-CHECK-PRINTER-ID NOT = 'R2T7'
  5404         PERFORM 0700-END-PRINT.
  5405
  5406     MOVE PI-PRINTER-STARTED-SW  TO  WS-PRINTER-STARTED-SW.
  5407     MOVE PI-TEMP-STORAGE-KEY    TO  WS-TEMP-STORAGE-KEY.
  5408     ADD +1  TO  WS-COMPLETED-SUCCESSFUL.
  5409     GO TO 0015-MAIN-LOGIC.
  5410
  5411 0700-END-PRINT SECTION.
  5412     MOVE HIGH-VALUES            TO  CHECK-PASS-AREA.
  5413     MOVE +1                     TO  WS-TS-LENGTH.
  5414
  5415     PERFORM 0800-PRINT-CHECK.
  5416
  5417     MOVE ZERO                   TO  PI-PRINTER-STARTED-SW.
  5418
  5419 0700-EXIT.
  5420     EXIT.
  5421
  5422 0800-PRINT-CHECK SECTION.
  5423
  5424* EXEC CICS WRITEQ TS
  5425*         QUEUE  (PI-TEMP-STORAGE-KEY)
  5426*         ITEM   (WS-TEMP-STORAGE-ITEM)
  5427*         FROM   (CHECK-PASS-AREA)
  5428*         LENGTH (WS-TS-LENGTH) END-EXEC.
  5429*    MOVE '*" I                  ''   #00004806' TO DFHEIV0
  5430     MOVE X'2A2220492020202020202020' TO DFHEIV0(1:12)
  5431     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5432     MOVE X'2020233030303034383036' TO DFHEIV0(25:11)
  5433     CALL 'kxdfhei1' USING DFHEIV0,
  5434           PI-TEMP-STORAGE-KEY,
  5435           CHECK-PASS-AREA,
  5436           WS-TS-LENGTH,
  5437           WS-TEMP-STORAGE-ITEM,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL687.cbl
  5438           DFHEIV99,
  5439           DFHEIV99
  5440     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5441
  5442
  5443 0800-EXIT.
  5444     EXIT.
  5445
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL687.cbl
  5447 0900-TERMIDERR SECTION.
  5448
  5449
  5450* EXEC CICS SYNCPOINT
  5451*        ROLLBACK END-EXEC.
  5452*    MOVE '6"R                   !   #00004818' TO DFHEIV0
  5453     MOVE X'362252202020202020202020' TO DFHEIV0(1:12)
  5454     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5455     MOVE X'2020233030303034383138' TO DFHEIV0(25:11)
  5456     CALL 'kxdfhei1' USING DFHEIV0
  5457     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5458
  5459
  5460     MOVE ER-0371                TO  EMI-ERROR.
  5461     MOVE -1                     TO  APFKL.
  5462     PERFORM 8200-SEND-DATAONLY.
  5463     PERFORM 9100-RETURN-TRAN.
  5464
  5465 0910-ENQ-BUSY.
  5466     MOVE ER-0395                TO  EMI-ERROR.
  5467     MOVE -1                     TO  AOPTIONL.
  5468     PERFORM 8200-SEND-DATAONLY.
  5469     PERFORM 9100-RETURN-TRAN.
  5470
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL687.cbl
  5472*5000-MOVE-NAME SECTION. COPY ELCMNS.
  5473
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL687.cbl
  5475 8100-SEND-INITIAL-MAP SECTION.
  5476
  5477     IF EMI-ERROR NOT = ZERO
  5478         PERFORM 9900-ERROR-FORMAT
  5479       ELSE
  5480         IF TRANSACTION-SUCCESSFUL
  5481             PERFORM 9900-ERROR-FORMAT
  5482             IF CHECKS-WITHOUT-ADDRESSES
  5483                 MOVE ER-0364    TO  EMI-ERROR
  5484                 PERFORM 9900-ERROR-FORMAT.
  5485
  5486     MOVE EIBTIME                TO  WS-TIME-WORK.
  5487
  5488* EXEC CICS ASKTIME ABSTIME(LCP-CICS-DATE)
  5489*    END-EXEC
  5490*    MOVE '0"A                   "   #00004848' TO DFHEIV0
  5491     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
  5492     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  5493     MOVE X'2020233030303034383438' TO DFHEIV0(25:11)
  5494     CALL 'kxdfhei1' USING DFHEIV0,
  5495           LCP-CICS-DATE
  5496     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5497
  5498* EXEC CICS FORMATTIME
  5499*              ABSTIME(LCP-CICS-DATE)
  5500*              YYMMDD(LCP-CURRENT-DATE-68)
  5501*              DATESEP('/')
  5502*    END-EXEC
  5503     MOVE '/' TO DFHEIV9
  5504*    MOVE 'j$((   "              $   #00004850' TO DFHEIV0
  5505     MOVE X'6A2428282020202220202020' TO DFHEIV0(1:12)
  5506     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5507     MOVE X'2020233030303034383530' TO DFHEIV0(25:11)
  5508     CALL 'kxdfhei1' USING DFHEIV0,
  5509           LCP-CICS-DATE,
  5510           LCP-CURRENT-DATE-68,
  5511           DFHEIV9
  5512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5513
  5514     MOVE LCP-CURRENT-DATE-68 TO ADATEO.
  5515     MOVE WS-TIME                TO  ATIMEO.
  5516     MOVE EMI-MESSAGE-AREA (1)   TO  AEMSG1O.
  5517     MOVE EMI-MESSAGE-AREA (2)   TO  AEMSG2O.
  5518     MOVE EMI-MESSAGE-AREA (3)   TO  AEMSG3O.
  5519
  5520
  5521* EXEC CICS SEND
  5522*        FROM   (EL687AI)
  5523*        MAPSET (WS-MAPSET-NAME)
  5524*        MAP    (WS-MAP-NAME)
  5525*        CURSOR ERASE END-EXEC.
  5526     MOVE LENGTH OF
  5527      EL687AI
  5528       TO DFHEIV12
  5529     MOVE -1
  5530       TO DFHEIV11
  5531*    MOVE '8$     CT  E    H L F ,   #00004862' TO DFHEIV0
  5532     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL687.cbl
  5533     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5534     MOVE X'2020233030303034383632' TO DFHEIV0(25:11)
  5535     CALL 'kxdfhei1' USING DFHEIV0,
  5536           WS-MAP-NAME,
  5537           EL687AI,
  5538           DFHEIV12,
  5539           WS-MAPSET-NAME,
  5540           DFHEIV99,
  5541           DFHEIV99,
  5542           DFHEIV99,
  5543           DFHEIV11,
  5544           DFHEIV99,
  5545           DFHEIV99,
  5546           DFHEIV99
  5547     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5548
  5549
  5550     PERFORM 9100-RETURN-TRAN.
  5551
  5552 8100-EXIT.
  5553     EXIT.
  5554
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL687.cbl
  5556 8200-SEND-DATAONLY SECTION.
  5557
  5558     IF EMI-ERROR NOT = 3130
  5559         PERFORM 9900-ERROR-FORMAT
  5560       ELSE
  5561         IF TRANSACTION-SUCCESSFUL
  5562             PERFORM 9900-ERROR-FORMAT
  5563             IF CHECKS-WITHOUT-ADDRESSES
  5564                 MOVE ER-0364    TO  EMI-ERROR
  5565                 PERFORM 9900-ERROR-FORMAT.
  5566
  5567     MOVE EIBTIME                TO  WS-TIME-WORK.
  5568
  5569* EXEC CICS ASKTIME ABSTIME(LCP-CICS-DATE)
  5570*    END-EXEC
  5571*    MOVE '0"A                   "   #00004886' TO DFHEIV0
  5572     MOVE X'302241202020202020202020' TO DFHEIV0(1:12)
  5573     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  5574     MOVE X'2020233030303034383836' TO DFHEIV0(25:11)
  5575     CALL 'kxdfhei1' USING DFHEIV0,
  5576           LCP-CICS-DATE
  5577     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5578
  5579* EXEC CICS FORMATTIME
  5580*              ABSTIME(LCP-CICS-DATE)
  5581*              YYMMDD(LCP-CURRENT-DATE-68)
  5582*              DATESEP('/')
  5583*    END-EXEC
  5584     MOVE '/' TO DFHEIV9
  5585*    MOVE 'j$((   "              $   #00004888' TO DFHEIV0
  5586     MOVE X'6A2428282020202220202020' TO DFHEIV0(1:12)
  5587     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5588     MOVE X'2020233030303034383838' TO DFHEIV0(25:11)
  5589     CALL 'kxdfhei1' USING DFHEIV0,
  5590           LCP-CICS-DATE,
  5591           LCP-CURRENT-DATE-68,
  5592           DFHEIV9
  5593     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5594
  5595     MOVE LCP-CURRENT-DATE-68 TO ADATEO.
  5596     MOVE WS-TIME                TO  ATIMEO.
  5597     MOVE EMI-MESSAGE-AREA (1)   TO  AEMSG1O.
  5598     MOVE EMI-MESSAGE-AREA (2)   TO  AEMSG2O.
  5599     MOVE EMI-MESSAGE-AREA (3)   TO  AEMSG3O.
  5600
  5601
  5602* EXEC CICS SEND DATAONLY
  5603*        FROM   (EL687AI)
  5604*        MAPSET (WS-MAPSET-NAME)
  5605*        MAP    (WS-MAP-NAME)
  5606*        CURSOR END-EXEC.
  5607     MOVE LENGTH OF
  5608      EL687AI
  5609       TO DFHEIV12
  5610     MOVE -1
  5611       TO DFHEIV11
  5612*    MOVE '8$D    CT       H L F ,   #00004900' TO DFHEIV0
  5613     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL687.cbl
  5614     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  5615     MOVE X'2020233030303034393030' TO DFHEIV0(25:11)
  5616     CALL 'kxdfhei1' USING DFHEIV0,
  5617           WS-MAP-NAME,
  5618           EL687AI,
  5619           DFHEIV12,
  5620           WS-MAPSET-NAME,
  5621           DFHEIV99,
  5622           DFHEIV99,
  5623           DFHEIV99,
  5624           DFHEIV11,
  5625           DFHEIV99,
  5626           DFHEIV99,
  5627           DFHEIV99
  5628     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5629
  5630
  5631     IF PI-PROCESSING-SW = ZERO
  5632         PERFORM 9100-RETURN-TRAN.
  5633
  5634     MOVE ZERO                   TO  EMI-SUB
  5635                                     EMI-NOTE-CTR
  5636                                     EMI-WARNING-CTR
  5637                                     EMI-FORCABLE-CTR
  5638                                     EMI-FATAL-CTR.
  5639
  5640     MOVE '1'                    TO  EMI-SWITCH-AREA-1
  5641                                     EMI-SWITCH-AREA-2.
  5642
  5643     MOVE SPACES                 TO  EMI-ERROR-LINES.
  5644
  5645 8200-EXIT.
  5646     EXIT.
  5647
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL687.cbl
  5649 8300-SEND-TEXT SECTION.
  5650
  5651     IF PI-PRINTER-STARTED-SW NOT = ZERO
  5652         PERFORM 0700-END-PRINT.
  5653
  5654
  5655* EXEC CICS SEND TEXT
  5656*        FROM   (LOGOFF-TEXT)
  5657*        LENGTH (LOGOFF-LENGTH)
  5658*        ERASE  FREEKB END-EXEC.
  5659*    MOVE '8&      T  E F  H   F -   #00004929' TO DFHEIV0
  5660     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  5661     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  5662     MOVE X'2020233030303034393239' TO DFHEIV0(25:11)
  5663     CALL 'kxdfhei1' USING DFHEIV0,
  5664           LOGOFF-TEXT,
  5665           LOGOFF-LENGTH,
  5666           DFHEIV99,
  5667           DFHEIV99,
  5668           DFHEIV99,
  5669           DFHEIV99,
  5670           DFHEIV99,
  5671           DFHEIV99,
  5672           DFHEIV99,
  5673           DFHEIV99,
  5674           DFHEIV99,
  5675           DFHEIV99
  5676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5677
  5678
  5679
  5680* EXEC CICS RETURN
  5681*        END-EXEC.
  5682*    MOVE '.(                    &   #00004934' TO DFHEIV0
  5683     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  5684     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5685     MOVE X'2020233030303034393334' TO DFHEIV0(25:11)
  5686     CALL 'kxdfhei1' USING DFHEIV0,
  5687           DFHEIV99,
  5688           DFHEIV99,
  5689           DFHEIV99,
  5690           DFHEIV99,
  5691           DFHEIV99
  5692     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5693
  5694
  5695
  5696 8300-EXIT.
  5697     EXIT.
  5698
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL687.cbl
  5700 8400-LOG-JOURNAL-RECORD SECTION.
  5701
  5702     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  5703     MOVE WS-PROGRAM-ID          TO  JP-PROGRAM-ID.
  5704
  5705*    EXEC CICS JOURNAL
  5706*        JFILEID (PI-JOURNAL-FILE-ID)
  5707*        JTYPEID (WS-JOURNAL-TYPE-ID)
  5708*        FROM    (JOURNAL-RECORD)
  5709*        LENGTH  (WS-JOURNAL-RECORD-LENGTH) END-EXEC.
  5710
  5711 8400-EXIT.
  5712     EXIT.
  5713
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL687.cbl
  5715 8500-DATE-CONVERSION SECTION.
  5716
  5717
  5718* EXEC CICS LINK
  5719*        PROGRAM  ('ELDATCV')
  5720*        COMMAREA (DATE-CONVERSION-DATA)
  5721*        LENGTH   (DC-COMM-LENGTH) END-EXEC.
  5722     MOVE 'ELDATCV' TO DFHEIV1
  5723*    MOVE '."C                   ''   #00004959' TO DFHEIV0
  5724     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5725     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5726     MOVE X'2020233030303034393539' TO DFHEIV0(25:11)
  5727     CALL 'kxdfhei1' USING DFHEIV0,
  5728           DFHEIV1,
  5729           DATE-CONVERSION-DATA,
  5730           DC-COMM-LENGTH,
  5731           DFHEIV99,
  5732           DFHEIV99,
  5733           DFHEIV99
  5734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5735
  5736
  5737
  5738 8500-EXIT.
  5739     EXIT.
  5740
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL687.cbl
  5742 8700-LOCATE-BENEFIT SECTION.
  5743
  5744
  5745* EXEC CICS HANDLE CONDITION
  5746*        NOTFND (8700-EXIT) END-EXEC.
  5747*    MOVE '"$I                   ! & #00004971' TO DFHEIV0
  5748     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  5749     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5750     MOVE X'2620233030303034393731' TO DFHEIV0(25:11)
  5751     CALL 'kxdfhei1' USING DFHEIV0
  5752     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5753
  5754
  5755     MOVE SPACES                 TO  WS-KIND.
  5756
  5757     MOVE PI-COMPANY-ID          TO  WS-CFK-COMPANY-ID.
  5758     MOVE WS-BENEFIT-NO          TO  WS-CFK-BENEFIT-NO.
  5759
  5760
  5761* EXEC CICS READ
  5762*        DATASET (WS-CONTROL-FILE-DSID)
  5763*        RIDFLD  (WS-CONTROL-FILE-KEY)
  5764*        SET     (ADDRESS OF CONTROL-FILE)
  5765*        GTEQ    END-EXEC.
  5766*    MOVE '&"S        G          (   #00004979' TO DFHEIV0
  5767     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  5768     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5769     MOVE X'2020233030303034393739' TO DFHEIV0(25:11)
  5770     CALL 'kxdfhei1' USING DFHEIV0,
  5771           WS-CONTROL-FILE-DSID,
  5772           DFHEIV20,
  5773           DFHEIV99,
  5774           WS-CONTROL-FILE-KEY,
  5775           DFHEIV99,
  5776           DFHEIV99,
  5777           DFHEIV99
  5778     SET ADDRESS OF CONTROL-FILE TO
  5779         DFHEIV20
  5780     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5781
  5782
  5783     IF WS-CFK-COMPANY-ID NOT = CF-COMPANY-ID
  5784       OR WS-CFK-RECORD-TYPE NOT = CF-RECORD-TYPE
  5785         GO TO 8700-EXIT.
  5786
  5787     MOVE +1                     TO  WS-INDEX.
  5788
  5789 8700-LOOKUP-BENEFIT.
  5790     IF WS-BENEFIT-NO = CF-BENEFIT-CODE (WS-INDEX)
  5791         MOVE CF-BENEFIT-ALPHA (WS-INDEX)  TO  WS-KIND
  5792         GO TO 8700-EXIT.
  5793
  5794     IF CF-BENEFIT-CODE (WS-INDEX) NOT LESS CF-HI-BEN-IN-REC
  5795         GO TO 8700-EXIT.
  5796
  5797     IF WS-INDEX LESS THAN +8
  5798         ADD +1  TO  WS-INDEX
  5799         GO TO 8700-LOOKUP-BENEFIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL687.cbl
  5800
  5801 8700-EXIT.
  5802     EXIT.
  5803
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL687.cbl
  5805 9000-RETURN-CICS SECTION.
  5806
  5807     MOVE 'EL005'                TO  WS-PROGRAM-ID.
  5808     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  5809     PERFORM 9300-XCTL.
  5810
  5811 9000-EXIT.
  5812     EXIT.
  5813
  5814 9100-RETURN-TRAN SECTION.
  5815
  5816     MOVE EMI-ERROR-NUMBER (1)  TO  PI-LAST-ERROR-NO.
  5817     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  5818
  5819
  5820* EXEC CICS RETURN
  5821*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  5822*        LENGTH   (PI-COMM-LENGTH)
  5823*        TRANSID  (WS-TRANS-ID) END-EXEC.
  5824*    MOVE '.(CT                  &   #00005021' TO DFHEIV0
  5825     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  5826     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5827     MOVE X'2020233030303035303231' TO DFHEIV0(25:11)
  5828     CALL 'kxdfhei1' USING DFHEIV0,
  5829           WS-TRANS-ID,
  5830           PROGRAM-INTERFACE-BLOCK,
  5831           PI-COMM-LENGTH,
  5832           DFHEIV99,
  5833           DFHEIV99
  5834     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5835
  5836
  5837 9100-EXIT.
  5838     EXIT.
  5839
  5840 9300-XCTL SECTION.
  5841
  5842     IF PI-PRINTER-STARTED-SW NOT = ZERO
  5843         PERFORM 0700-END-PRINT.
  5844
  5845     MOVE DFHENTER               TO  EIBAID.
  5846
  5847
  5848* EXEC CICS XCTL
  5849*        PROGRAM  (WS-PROGRAM-ID)
  5850*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  5851*        LENGTH   (PI-COMM-LENGTH) END-EXEC.
  5852*    MOVE '.$C                   $   #00005036' TO DFHEIV0
  5853     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  5854     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5855     MOVE X'2020233030303035303336' TO DFHEIV0(25:11)
  5856     CALL 'kxdfhei1' USING DFHEIV0,
  5857           WS-PROGRAM-ID,
  5858           PROGRAM-INTERFACE-BLOCK,
  5859           PI-COMM-LENGTH
  5860     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5861
  5862
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL687.cbl
  5863 9300-EXIT.
  5864     EXIT.
  5865
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL687.cbl
  5867 9400-CLEAR SECTION.
  5868
  5869     MOVE PI-RETURN-TO-PROGRAM  TO  WS-PROGRAM-ID.
  5870     PERFORM 9300-XCTL.
  5871
  5872 9400-EXIT.
  5873     EXIT.
  5874
  5875 9600-PGMIDERR SECTION.
  5876
  5877
  5878* EXEC CICS HANDLE CONDITION
  5879*        PGMIDERR (8300-SEND-TEXT) END-EXEC.
  5880*    MOVE '"$L                   ! '' #00005055' TO DFHEIV0
  5881     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  5882     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5883     MOVE X'2720233030303035303535' TO DFHEIV0(25:11)
  5884     CALL 'kxdfhei1' USING DFHEIV0
  5885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5886
  5887
  5888     MOVE WS-PROGRAM-ID          TO  PI-CALLING-PROGRAM.
  5889
  5890     MOVE 'EL005'                TO  WS-PROGRAM-ID
  5891                                     LOGOFF-PGM.
  5892     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  5893     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  5894     PERFORM 9300-XCTL.
  5895
  5896 9600-EXIT.
  5897     EXIT.
  5898
  5899 9900-ERROR-FORMAT SECTION.
  5900
  5901     IF EMI-ERRORS-COMPLETE
  5902         MOVE ER-3130            TO  EMI-ERROR
  5903         GO TO 9900-EXIT.
  5904
  5905
  5906* EXEC CICS LINK
  5907*        PROGRAM  ('EL001')
  5908*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  5909*        LENGTH   (EMI-COMM-LENGTH) END-EXEC.
  5910     MOVE 'EL001' TO DFHEIV1
  5911*    MOVE '."C                   ''   #00005075' TO DFHEIV0
  5912     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5913     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5914     MOVE X'2020233030303035303735' TO DFHEIV0(25:11)
  5915     CALL 'kxdfhei1' USING DFHEIV0,
  5916           DFHEIV1,
  5917           ERROR-MESSAGE-INTERFACE-BLOCK,
  5918           EMI-COMM-LENGTH,
  5919           DFHEIV99,
  5920           DFHEIV99,
  5921           DFHEIV99
  5922     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5923
  5924
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL687.cbl
  5925     MOVE ER-3130                TO  EMI-ERROR.
  5926
  5927 9900-EXIT.
  5928     EXIT.
  5929
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL687.cbl
  5931 9990-ERROR SECTION.
  5932
  5933     MOVE DFHEIBLK TO EMI-LINE1.
  5934
  5935* EXEC CICS LINK
  5936*        PROGRAM  ('EL004')
  5937*        COMMAREA (EMI-LINE1)
  5938*        LENGTH   (72) END-EXEC.
  5939     MOVE 'EL004' TO DFHEIV1
  5940     MOVE 72
  5941       TO DFHEIV11
  5942*    MOVE '."C                   ''   #00005089' TO DFHEIV0
  5943     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5944     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5945     MOVE X'2020233030303035303839' TO DFHEIV0(25:11)
  5946     CALL 'kxdfhei1' USING DFHEIV0,
  5947           DFHEIV1,
  5948           EMI-LINE1,
  5949           DFHEIV11,
  5950           DFHEIV99,
  5951           DFHEIV99,
  5952           DFHEIV99
  5953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5954
  5955     PERFORM 8200-SEND-DATAONLY.
  5956     GO TO 9100-RETURN-TRAN.
  5957
  5958 9990-EXIT.
  5959     EXIT.
  5960
  5961 9999-LAST-PARAGRAPH SECTION.
  5962
  5963
  5964* GOBACK.
  5965     MOVE '9%                    "   ' TO DFHEIV0
  5966     MOVE 'EL687' TO DFHEIV1
  5967     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5968     GOBACK.
  5969
  5970
  5971 9999-DFHBACK SECTION.
  5972     MOVE '9%                    "   ' TO DFHEIV0
  5973     MOVE 'EL687' TO DFHEIV1
  5974     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5975     GOBACK.
  5976 9999-DFHEXIT.
  5977     IF DFHEIGDJ EQUAL 0001
  5978         NEXT SENTENCE
  5979     ELSE IF DFHEIGDJ EQUAL 2
  5980         GO TO 9600-PGMIDERR,
  5981               0180-MAIN-LOGIC,
  5982               0190-MAIN-LOGIC,
  5983               0900-TERMIDERR,
  5984               0910-ENQ-BUSY,
  5985               9990-ERROR
  5986         DEPENDING ON DFHEIGDI
  5987     ELSE IF DFHEIGDJ EQUAL 3
  5988         GO TO 0225-MAIN-LOGIC,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 129
* EL687.cbl
  5989               0230-MAIN-LOGIC
  5990         DEPENDING ON DFHEIGDI
  5991     ELSE IF DFHEIGDJ EQUAL 4
  5992         GO TO 9400-CLEAR,
  5993               0040-MAIN-LOGIC,
  5994               0040-MAIN-LOGIC,
  5995               0040-MAIN-LOGIC
  5996         DEPENDING ON DFHEIGDI
  5997     ELSE IF DFHEIGDJ EQUAL 5
  5998         GO TO 9999-DFHBACK,
  5999               0390-MAIN-LOGIC
  6000         DEPENDING ON DFHEIGDI
  6001     ELSE IF DFHEIGDJ EQUAL 6
  6002         GO TO 8700-EXIT
  6003         DEPENDING ON DFHEIGDI
  6004     ELSE IF DFHEIGDJ EQUAL 7
  6005         GO TO 8300-SEND-TEXT
  6006         DEPENDING ON DFHEIGDI.
  6007     MOVE '9%                    "   ' TO DFHEIV0
  6008     MOVE 'EL687' TO DFHEIV1
  6009     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  6010     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5856     Code:       13958
