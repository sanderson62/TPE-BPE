* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL113.cbl
* Options: int("EL113.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL113.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL113.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL113.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL113.
     4*                            VMOD=2.002.
     5
     6 AUTHOR.     LOGIC,INC.
     7             DALLAS, TEXAS.
     8
     9 DATE-COMPILED. 02-Nov-12 23:15.
    11 SECURITY.   *****************************************************
    12             *                                                   *
    13             *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    14             *                                                   *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL113.cbl
    15             *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    16             *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    17             *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    18             *                                                   *
    19             *****************************************************
    20
    21 REMARKS.    TRANSACTION - EX38 - ACCOUNT MASTER DISPLAY.
    22
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL113.cbl
    24 ENVIRONMENT DIVISION.
    25 DATA DIVISION.
    26 WORKING-STORAGE SECTION.
    27 01  DFH-START PIC X(04).
    28 77  FILLER  PIC X(32)  VALUE '*** PAN EL113     PANLVL 006 ***'.
    29 77  FILLER  PIC X(32)  VALUE '********************************'.
    30 77  FILLER  PIC X(32)  VALUE '*    EL113 WORKING STORAGE     *'.
    31 77  FILLER  PIC X(32)  VALUE '********** V/M 2.002 ***********'.
    32
    33 01  WS-DATE-AREA.
    34     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    35     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
    36
    37 01  STANDARD-AREAS.
    38     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
    39     12  MAP-NAME            PIC X(8)    VALUE 'EL113A'.
    40     12  MAPSET-NAME         PIC X(8)    VALUE 'EL113S'.
    41     12  TRANS-ID            PIC X(4)    VALUE 'EX38'.
    42     12  PGM-NAME            PIC X(8).
    43     12  TIME-IN             PIC S9(7).
    44     12  TIME-OUT-R  REDEFINES TIME-IN.
    45         16  FILLER          PIC X.
    46         16  TIME-OUT        PIC 99V99.
    47         16  FILLER          PIC X(2).
    48     12  XCTL-005            PIC X(5)    VALUE 'EL005'.
    49     12  XCTL-010            PIC X(5)    VALUE 'EL010'.
    50     12  XCTL-126            PIC X(5)    VALUE 'EL126'.
    51     12  LINK-001            PIC X(5)    VALUE 'EL001'.
    52     12  LINK-004            PIC X(5)    VALUE 'EL004'.
    53     12  LINK-CLDATCV        PIC X(7)    VALUE 'ELDATCV'.
    54     12  PGM-EL113           PIC X(8)    VALUE 'EL113'.
    55     12  ACCT-ID             PIC X(8)    VALUE 'ERACCT'.
    56     12  ACCT-VG-ID          PIC X(8)    VALUE 'ERACCT2'.
    57     12  SAVE-ACCT-PARTIAL-KEY   PIC X(20)  VALUE LOW-VALUES.
    58     12  WS-ZIP.
    59         16  WS-ZIP-CODE         PIC X(5).
    60         16  WS-DASH             PIC X(1)   VALUE '-'.
    61         16  WS-ZIP-PLUS4        PIC X(4).
    62     12  WS-CANADIAN-POSTAL-CODES REDEFINES WS-ZIP.
    63         16  WS-CAN-POSTAL-CD-1  PIC X(3).
    64         16  WS-DASH-CAN         PIC X(1).
    65         16  WS-CAN-POSTAL-CD-2  PIC X(3).
    66         16  WS-CAN-FILLER       PIC X(3).
    67     12  WS-WORK-PHONE           PIC X(10)  VALUE ZEROS.
    68     12  WS-NUMERIC-PHONE REDEFINES WS-WORK-PHONE
    69                                 PIC 9(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL113.cbl
    71
    72 01  WORK-AREAS.
    73     12  BROWSE-STARTED-SW       PIC X       VALUE ' '.
    74         88  BROWSE-STARTED      VALUE 'Y'.
    75     12  FIRST-TIME-SW           PIC X       VALUE ' '.
    76         88  FIRST-TIME          VALUE 'Y'.
    77     12  DEEDIT-FIELD            PIC X(15).
    78     12  DEEDIT-FIELD-V0 REDEFINES DEEDIT-FIELD   PIC S9(15).
    79     12  DEEDIT-FIELD-V1 REDEFINES DEEDIT-FIELD   PIC S9(13)V99.
    80     12  EXPDTE-SAVE             PIC XX.
    81     12  EFFDTE-SAVE             PIC XX.
    82     12  ALLOW-SAVE              PIC S9(3)V99  VALUE ZEROS.
    83     12  E023                    PIC X(4)    VALUE '0023'.
    84     12  E042                    PIC X(4)    VALUE '0042'.
    85     12  E052                    PIC X(4)    VALUE '0052'.
    86     12  E066                    PIC X(4)    VALUE '0066'.
    87     12  E067                    PIC X(4)    VALUE '0067'.
    88     12  E144                    PIC X(4)    VALUE '0144'.
    89     12  E168                    PIC X(4)    VALUE '0168'.
    90     12  E193                    PIC X(4)    VALUE '0193'.
    91     12  E195                    PIC X(4)    VALUE '0195'.
    92     12  E226                    PIC X(4)    VALUE '0226'.
    93     12  E348                    PIC X(4)    VALUE '0348'.
    94     12  E453                    PIC X(4)    VALUE '0453'.
    95     12  E454                    PIC X(4)    VALUE '0454'.
    96     12  E455                    PIC X(4)    VALUE '0455'.
    97     12  E456                    PIC X(4)    VALUE '0456'.
    98     12  E457                    PIC X(4)    VALUE '0457'.
    99     12  E470                    PIC X(4)    VALUE '0470'.
   100     12  E471                    PIC X(4)    VALUE '0471'.
   101     12  E472                    PIC X(4)    VALUE '0472'.
   102     12  E482                    PIC X(4)    VALUE '0482'.
   103
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL113.cbl
   105*                            COPY ELCDATE.
   106******************************************************************
   107*                                                                *
   108*                                                                *
   109*                            ELCDATE.                            *
   110*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   111*                            VMOD=2.003
   112*                                                                *
   113*                                                                *
   114*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   115*                 LENGTH = 200                                   *
   116******************************************************************
   117
   118 01  DATE-CONVERSION-DATA.
   119     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   120     12  DC-OPTION-CODE                PIC X.
   121         88  BIN-TO-GREG                VALUE ' '.
   122         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   123         88  EDIT-GREG-TO-BIN           VALUE '2'.
   124         88  YMD-GREG-TO-BIN            VALUE '3'.
   125         88  MDY-GREG-TO-BIN            VALUE '4'.
   126         88  JULIAN-TO-BIN              VALUE '5'.
   127         88  BIN-PLUS-ELAPSED           VALUE '6'.
   128         88  FIND-CENTURY               VALUE '7'.
   129         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   130         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   131         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   132         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   133         88  JULIAN-TO-BIN-3            VALUE 'C'.
   134         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   135         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   136         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   137         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   138         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   139         88  CHECK-LEAP-YEAR            VALUE 'H'.
   140         88  BIN-3-TO-GREG              VALUE 'I'.
   141         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   142         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   143         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   144         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   145         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   146         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   147         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   148         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   149         88  THREE-CHARACTER-BIN
   150                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   151         88  GREGORIAN-TO-BIN
   152                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   153         88  BIN-TO-GREGORIAN
   154                  VALUES ' ' '1' 'I' '8' 'G'.
   155         88  JULIAN-TO-BINARY
   156                  VALUES '5' 'C' 'E' 'F'.
   157     12  DC-ERROR-CODE                 PIC X.
   158         88  NO-CONVERSION-ERROR        VALUE ' '.
   159         88  DATE-CONVERSION-ERROR
   160                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   161         88  DATE-IS-ZERO               VALUE '1'.
   162         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL113.cbl
   163         88  DATE-IS-INVALID            VALUE '3'.
   164         88  DATE1-GREATER-DATE2        VALUE '4'.
   165         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   166         88  DATE-INVALID-OPTION        VALUE '9'.
   167         88  INVALID-CENTURY            VALUE 'A'.
   168         88  ONLY-CENTURY               VALUE 'B'.
   169         88  ONLY-LEAP-YEAR             VALUE 'C'.
   170         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   171     12  DC-END-OF-MONTH               PIC X.
   172         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   173     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   174         88  USE-NORMAL-PROCESS         VALUE ' '.
   175         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   176         88  ADJUST-UP-100-YRS          VALUE '2'.
   177     12  FILLER                        PIC X.
   178     12  DC-CONVERSION-DATES.
   179         16  DC-BIN-DATE-1             PIC XX.
   180         16  DC-BIN-DATE-2             PIC XX.
   181         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   182         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   183                       DC-GREG-DATE-1-EDIT.
   184             20  DC-EDIT1-MONTH        PIC 99.
   185             20  SLASH1-1              PIC X.
   186             20  DC-EDIT1-DAY          PIC 99.
   187             20  SLASH1-2              PIC X.
   188             20  DC-EDIT1-YEAR         PIC 99.
   189         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   190         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   191                     DC-GREG-DATE-2-EDIT.
   192             20  DC-EDIT2-MONTH        PIC 99.
   193             20  SLASH2-1              PIC X.
   194             20  DC-EDIT2-DAY          PIC 99.
   195             20  SLASH2-2              PIC X.
   196             20  DC-EDIT2-YEAR         PIC 99.
   197         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   198         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   199                     DC-GREG-DATE-1-YMD.
   200             20  DC-YMD-YEAR           PIC 99.
   201             20  DC-YMD-MONTH          PIC 99.
   202             20  DC-YMD-DAY            PIC 99.
   203         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   204         16  DC-GREG-DATE-1-MDY-R REDEFINES
   205                      DC-GREG-DATE-1-MDY.
   206             20  DC-MDY-MONTH          PIC 99.
   207             20  DC-MDY-DAY            PIC 99.
   208             20  DC-MDY-YEAR           PIC 99.
   209         16  DC-GREG-DATE-1-ALPHA.
   210             20  DC-ALPHA-MONTH        PIC X(10).
   211             20  DC-ALPHA-DAY          PIC 99.
   212             20  FILLER                PIC XX.
   213             20  DC-ALPHA-CENTURY.
   214                 24 DC-ALPHA-CEN-N     PIC 99.
   215             20  DC-ALPHA-YEAR         PIC 99.
   216         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   217         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   218         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   219         16  DC-JULIAN-DATE            PIC 9(05).
   220         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL113.cbl
   221                                       PIC 9(05).
   222         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   223             20  DC-JULIAN-YEAR        PIC 99.
   224             20  DC-JULIAN-DAYS        PIC 999.
   225         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   226         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   227         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   228     12  DATE-CONVERSION-VARIBLES.
   229         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   230         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   231             20  FILLER                PIC 9(3).
   232             20  HOLD-CEN-1-CCYY.
   233                 24  HOLD-CEN-1-CC     PIC 99.
   234                 24  HOLD-CEN-1-YY     PIC 99.
   235             20  HOLD-CEN-1-MO         PIC 99.
   236             20  HOLD-CEN-1-DA         PIC 99.
   237         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   238             20  HOLD-CEN-1-R-MO       PIC 99.
   239             20  HOLD-CEN-1-R-DA       PIC 99.
   240             20  HOLD-CEN-1-R-CCYY.
   241                 24  HOLD-CEN-1-R-CC   PIC 99.
   242                 24  HOLD-CEN-1-R-YY   PIC 99.
   243             20  FILLER                PIC 9(3).
   244         16  HOLD-CENTURY-1-X.
   245             20  FILLER                PIC X(3)  VALUE SPACES.
   246             20  HOLD-CEN-1-X-CCYY.
   247                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   248                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   249             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   250             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   251         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   252             20  HOLD-CEN-1-R-X-MO     PIC XX.
   253             20  HOLD-CEN-1-R-X-DA     PIC XX.
   254             20  HOLD-CEN-1-R-X-CCYY.
   255                 24  HOLD-CEN-1-R-X-CC PIC XX.
   256                 24  HOLD-CEN-1-R-X-YY PIC XX.
   257             20  FILLER                PIC XXX.
   258         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   259         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   260         16  DC-JULIAN-DATE-1          PIC 9(07).
   261         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   262             20  DC-JULIAN-1-CCYY.
   263                 24  DC-JULIAN-1-CC    PIC 99.
   264                 24  DC-JULIAN-1-YR    PIC 99.
   265             20  DC-JULIAN-DA-1        PIC 999.
   266         16  DC-JULIAN-DATE-2          PIC 9(07).
   267         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   268             20  DC-JULIAN-2-CCYY.
   269                 24  DC-JULIAN-2-CC    PIC 99.
   270                 24  DC-JULIAN-2-YR    PIC 99.
   271             20  DC-JULIAN-DA-2        PIC 999.
   272         16  DC-GREG-DATE-A-EDIT.
   273             20  DC-EDITA-MONTH        PIC 99.
   274             20  SLASHA-1              PIC X VALUE '/'.
   275             20  DC-EDITA-DAY          PIC 99.
   276             20  SLASHA-2              PIC X VALUE '/'.
   277             20  DC-EDITA-CCYY.
   278                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL113.cbl
   279                 24  DC-EDITA-YEAR     PIC 99.
   280         16  DC-GREG-DATE-B-EDIT.
   281             20  DC-EDITB-MONTH        PIC 99.
   282             20  SLASHB-1              PIC X VALUE '/'.
   283             20  DC-EDITB-DAY          PIC 99.
   284             20  SLASHB-2              PIC X VALUE '/'.
   285             20  DC-EDITB-CCYY.
   286                 24  DC-EDITB-CENT     PIC 99.
   287                 24  DC-EDITB-YEAR     PIC 99.
   288         16  DC-GREG-DATE-CYMD         PIC 9(08).
   289         16  DC-GREG-DATE-CYMD-R REDEFINES
   290                              DC-GREG-DATE-CYMD.
   291             20  DC-CYMD-CEN           PIC 99.
   292             20  DC-CYMD-YEAR          PIC 99.
   293             20  DC-CYMD-MONTH         PIC 99.
   294             20  DC-CYMD-DAY           PIC 99.
   295         16  DC-GREG-DATE-MDCY         PIC 9(08).
   296         16  DC-GREG-DATE-MDCY-R REDEFINES
   297                              DC-GREG-DATE-MDCY.
   298             20  DC-MDCY-MONTH         PIC 99.
   299             20  DC-MDCY-DAY           PIC 99.
   300             20  DC-MDCY-CEN           PIC 99.
   301             20  DC-MDCY-YEAR          PIC 99.
   302    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   303        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   304    12  DC-EL310-DATE                  PIC X(21).
   305    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL113.cbl
   307*                            COPY ELCLOGOF.
   308******************************************************************
   309*                                                                *
   310*                                                                *
   311*                            ELCLOGOF.                           *
   312*                            VMOD=2.001                          *
   313*                                                                *
   314*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   315*                                                                *
   316******************************************************************
   317 01  CLASIC-LOGOFF.
   318     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   319     12  LOGOFF-TEXT.
   320         16  FILLER          PIC X(5)    VALUE SPACES.
   321         16  LOGOFF-MSG.
   322             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   323             20  FILLER      PIC X       VALUE SPACES.
   324             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   325         16  FILLER          PIC X(80)
   326           VALUE '* YOU ARE NOW LOGGED OFF'.
   327         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   328         16  FILLER          PIC X       VALUE QUOTE.
   329         16  LOGOFF-SYS-MSG  PIC X(17)
   330           VALUE 'S CLAS-IC SYSTEM '.
   331     12  TEXT-MESSAGES.
   332         16  UNACCESS-MSG    PIC X(29)
   333             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   334         16  PGMIDERR-MSG    PIC X(17)
   335             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL113.cbl
   337*                            COPY ELCATTR.
   338******************************************************************
   339*                                                                *
   340*                            ELCATTR.                            *
   341*                            VMOD=2.001                          *
   342*                                                                *
   343*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   344*                                                                *
   345*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   346*                                                                *
   347*                   POS 1   P=PROTECTED                          *
   348*                           U=UNPROTECTED                        *
   349*                           S=ASKIP                              *
   350*                   POS 2   A=ALPHA/NUMERIC                      *
   351*                           N=NUMERIC                            *
   352*                   POS 3   N=NORMAL                             *
   353*                           B=BRIGHT                             *
   354*                           D=DARK                               *
   355*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   356*                           OF=MODIFIED DATA TAG OFF             *
   357*                                                                *
   358*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   359******************************************************************
   360 01  ATTRIBUTE-LIST.
   361     12  AL-PABOF            PIC X       VALUE 'Y'.
   362     12  AL-PABON            PIC X       VALUE 'Z'.
   363     12  AL-PADOF            PIC X       VALUE '%'.
   364     12  AL-PADON            PIC X       VALUE '_'.
   365     12  AL-PANOF            PIC X       VALUE '-'.
   366     12  AL-PANON            PIC X       VALUE '/'.
   367     12  AL-SABOF            PIC X       VALUE '8'.
   368     12  AL-SABON            PIC X       VALUE '9'.
   369     12  AL-SADOF            PIC X       VALUE '@'.
   370     12  AL-SADON            PIC X       VALUE QUOTE.
   371     12  AL-SANOF            PIC X       VALUE '0'.
   372     12  AL-SANON            PIC X       VALUE '1'.
   373     12  AL-UABOF            PIC X       VALUE 'H'.
   374     12  AL-UABON            PIC X       VALUE 'I'.
   375     12  AL-UADOF            PIC X       VALUE '<'.
   376     12  AL-UADON            PIC X       VALUE '('.
   377     12  AL-UANOF            PIC X       VALUE ' '.
   378     12  AL-UANON            PIC X       VALUE 'A'.
   379     12  AL-UNBOF            PIC X       VALUE 'Q'.
   380     12  AL-UNBON            PIC X       VALUE 'R'.
   381     12  AL-UNDOF            PIC X       VALUE '*'.
   382     12  AL-UNDON            PIC X       VALUE ')'.
   383     12  AL-UNNOF            PIC X       VALUE '&'.
   384     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL113.cbl
   386*                                  COPY ELCEMIB.
   387******************************************************************
   388*                                                                *
   389*                                                                *
   390*                            ELCEMIB.                            *
   391*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   392*                            VMOD=2.005                          *
   393*                                                                *
   394*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   395*                                                                *
   396******************************************************************
   397 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   398     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   399     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   400     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   401     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   402     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   403     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   404     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   405     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   406     12  EMI-SWITCH1             PIC X        VALUE '1'.
   407         88  EMI-NO-ERRORS                    VALUE '1'.
   408         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   409         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   410     12  EMI-SWITCH2             PIC X        VALUE '1'.
   411         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   412     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   413         88  EMI-AREA1-EMPTY                  VALUE '1'.
   414         88  EMI-AREA1-FULL                   VALUE '2'.
   415     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   416         88  EMI-AREA2-EMPTY                  VALUE '1'.
   417         88  EMI-AREA2-FULL                   VALUE '2'.
   418     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   419         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   420         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   421         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   422         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   423         88  EMI-BYPASS-FATALS                VALUE 'X'.
   424     12  EMI-ERROR-LINES.
   425         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   426         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   427         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   428         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   429             20  EMI-ERR-CODES OCCURS 10 TIMES.
   430                 24  EMI-ERR-NUM         PIC X(4).
   431                 24  EMI-FILLER          PIC X.
   432                 24  EMI-SEV             PIC X.
   433                 24  FILLER              PIC X.
   434             20  FILLER                  PIC X(02).
   435     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   436         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   437             20  EMI-ERROR-NUMBER    PIC X(4).
   438             20  EMI-FILL            PIC X.
   439             20  EMI-SEVERITY        PIC X.
   440             20  FILLER              PIC X.
   441             20  EMI-ERROR-TEXT.
   442                 24  EMI-TEXT-VARIABLE   PIC X(10).
   443                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL113.cbl
   444     12  EMI-SEVERITY-SAVE           PIC X.
   445         88  EMI-NOTE                    VALUE 'N'.
   446         88  EMI-WARNING                 VALUE 'W'.
   447         88  EMI-FORCABLE                VALUE 'F'.
   448         88  EMI-FATAL                   VALUE 'X'.
   449     12  EMI-MESSAGE-FLAG            PIC X.
   450         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   451         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   452     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   453     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   454         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   455         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   456         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   457     12  FILLER                      PIC X(137)  VALUE SPACES.
   458     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   459     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   460     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   461     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL113.cbl
   463*                            COPY ELCJPFX.
   464******************************************************************
   465*                                                                *
   466*                                                                *
   467*                            ELCJPFX.                            *
   468*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   469*                            VMOD=2.002                          *
   470*                                                                *
   471*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   472*                                                                *
   473*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   474*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   475*        ELCNTL - CONTROL FILE                                   *
   476*        ELMSTR - CLAIM MASTERS                                  *
   477*        ELTRLR - ACTIVITY TRAILERS                              *
   478*        ELCHKQ - CHECK QUE                                      *
   479******************************************************************
   480 01  JOURNAL-RECORD.
   481     12  JP-USER-ID                  PIC X(4).
   482     12  JP-FILE-ID                  PIC X(8).
   483     12  JP-PROGRAM-ID               PIC X(8).
   484     12  JP-RECORD-TYPE              PIC X.
   485         88 JP-ADD              VALUE 'A'.
   486         88 JP-BEFORE-CHANGE    VALUE 'B'.
   487         88 JP-AFTER-CHANGE     VALUE 'C'.
   488         88 JP-DELETE           VALUE 'D'.
   489         88 JP-GENERIC-DELETE   VALUE 'G'.
   490         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   491         88 JP-KEY-CHG-ADD      VALUE 'N'.
   492     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   493     12  JP-RECORD-AREA
   494
   495
   496                                  PIC X(2000).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL113.cbl
   498*                            COPY ELCINTF.
   499******************************************************************
   500*                                                                *
   501*                                                                *
   502*                            ELCINTF.                            *
   503*                            VMOD=2.017                          *
   504*                                                                *
   505*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   506*                                                                *
   507*       LENGTH = 1024                                            *
   508*                                                                *
   509******************************************************************
   510 01  PROGRAM-INTERFACE-BLOCK.
   511     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   512     12  PI-CALLING-PROGRAM              PIC X(8).
   513     12  PI-SAVED-PROGRAM-1              PIC X(8).
   514     12  PI-SAVED-PROGRAM-2              PIC X(8).
   515     12  PI-SAVED-PROGRAM-3              PIC X(8).
   516     12  PI-SAVED-PROGRAM-4              PIC X(8).
   517     12  PI-SAVED-PROGRAM-5              PIC X(8).
   518     12  PI-SAVED-PROGRAM-6              PIC X(8).
   519     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   520     12  PI-COMPANY-ID                   PIC XXX.
   521     12  PI-COMPANY-CD                   PIC X.
   522
   523     12  PI-COMPANY-PASSWORD             PIC X(8).
   524
   525     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   526
   527     12  PI-CONTROL-IN-PROGRESS.
   528         16  PI-CARRIER                  PIC X.
   529         16  PI-GROUPING                 PIC X(6).
   530         16  PI-STATE                    PIC XX.
   531         16  PI-ACCOUNT                  PIC X(10).
   532         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   533                                         PIC X(10).
   534         16  PI-CLAIM-CERT-GRP.
   535             20  PI-CLAIM-NO             PIC X(7).
   536             20  PI-CERT-NO.
   537                 25  PI-CERT-PRIME       PIC X(10).
   538                 25  PI-CERT-SFX         PIC X.
   539             20  PI-CERT-EFF-DT          PIC XX.
   540         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   541             20  PI-PLAN-CODE            PIC X(2).
   542             20  PI-REVISION-NUMBER      PIC X(3).
   543             20  PI-PLAN-EFF-DT          PIC X(2).
   544             20  PI-PLAN-EXP-DT          PIC X(2).
   545             20  FILLER                  PIC X(11).
   546         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   547             20  PI-OE-REFERENCE-1.
   548                 25  PI-OE-REF-1-PRIME   PIC X(18).
   549                 25  PI-OE-REF-1-SUFF    PIC XX.
   550
   551     12  PI-SESSION-IN-PROGRESS          PIC X.
   552         88  CLAIM-SESSION                   VALUE '1'.
   553         88  CREDIT-SESSION                  VALUE '2'.
   554         88  WARRANTY-SESSION                VALUE '3'.
   555         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL113.cbl
   556         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   557
   558
   559*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   560
   561     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   562     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   563
   564     12  PI-CREDIT-USER                  PIC X.
   565         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   566         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   567
   568     12  PI-CLAIM-USER                   PIC X.
   569         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   570         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   571
   572     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   573         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   574         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   575         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   576         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   577         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   578
   579     12  PI-PROCESSOR-ID                 PIC X(4).
   580
   581     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   582
   583     12  PI-MEMBER-CAPTION               PIC X(10).
   584
   585     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   586         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   587
   588     12  PI-LIFE-OVERRIDE-L1             PIC X.
   589     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   590     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   591     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   592
   593     12  PI-AH-OVERRIDE-L1               PIC X.
   594     12  PI-AH-OVERRIDE-L2               PIC XX.
   595     12  PI-AH-OVERRIDE-L6               PIC X(6).
   596     12  PI-AH-OVERRIDE-L12              PIC X(12).
   597
   598     12  PI-NEW-SYSTEM                   PIC X(2).
   599
   600     12  PI-PRIMARY-CERT-NO              PIC X(11).
   601     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   602         88  PI-USES-PAID-TO                 VALUE '1'.
   603     12  PI-CRDTCRD-SYSTEM.
   604         16  PI-CRDTCRD-USER             PIC X.
   605             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   606             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   607         16  PI-CC-MONTH-END-DT          PIC XX.
   608     12  PI-PROCESSOR-PRINTER            PIC X(4).
   609
   610     12  PI-OE-REFERENCE-2.
   611         16  PI-OE-REF-2-PRIME           PIC X(10).
   612         16  PI-OE-REF-2-SUFF            PIC X.
   613
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL113.cbl
   614     12  PI-REM-TRM-CALC-OPTION          PIC X.
   615
   616     12  PI-LANGUAGE-TYPE                PIC X.
   617             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   618             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   619             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   620
   621     12  PI-POLICY-LINKAGE-IND           PIC X.
   622         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   623         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   624                                                   LOW-VALUES.
   625
   626     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   627     12  PI-CLAIM-PW-SESSION             PIC X(1).
   628         88  PI-CLAIM-CREDIT                 VALUE '1'.
   629         88  PI-CLAIM-CONVEN                 VALUE '2'.
   630     12  FILLER                          PIC X(4).
   631
   632     12  PI-SYSTEM-LEVEL                 PIC X(145).
   633
   634     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   635         PI-SYSTEM-LEVEL.
   636
   637         16  PI-ENTRY-CODES.
   638             20  PI-ENTRY-CD-1           PIC X.
   639             20  PI-ENTRY-CD-2           PIC X.
   640
   641         16  PI-RETURN-CODES.
   642             20  PI-RETURN-CD-1          PIC X.
   643             20  PI-RETURN-CD-2          PIC X.
   644
   645         16  PI-UPDATE-STATUS-SAVE.
   646             20  PI-UPDATE-BY            PIC X(4).
   647             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   648
   649         16  PI-LOWER-CASE-LETTERS       PIC X.
   650             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   651
   652*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   653*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   654*            88  CARRIER-CLM-CNTL            VALUE '2'.
   655
   656         16  PI-CERT-ACCESS-CONTROL      PIC X.
   657             88  ST-ACCNT-CNTL               VALUE ' '.
   658             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   659             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   660             88  ACCNT-CNTL                  VALUE '3'.
   661             88  CARR-ACCNT-CNTL             VALUE '4'.
   662
   663         16  PI-PROCESSOR-CAP-LIST.
   664             20  PI-SYSTEM-CONTROLS.
   665                24 PI-SYSTEM-DISPLAY     PIC X.
   666                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   667                24 PI-SYSTEM-MODIFY      PIC X.
   668                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   669             20  FILLER                  PIC XX.
   670             20  PI-DISPLAY-CAP          PIC X.
   671                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL113.cbl
   672             20  PI-MODIFY-CAP           PIC X.
   673                 88  MODIFY-CAP              VALUE 'Y'.
   674             20  PI-MSG-AT-LOGON-CAP     PIC X.
   675                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   676             20  PI-FORCE-CAP            PIC X.
   677                 88  FORCE-CAP               VALUE 'Y'.
   678
   679         16  PI-PROGRAM-CONTROLS.
   680             20  PI-PGM-PRINT-OPT        PIC X.
   681             20  PI-PGM-FORMAT-OPT       PIC X.
   682             20  PI-PGM-PROCESS-OPT      PIC X.
   683             20  PI-PGM-TOTALS-OPT       PIC X.
   684
   685         16  PI-HELP-INTERFACE.
   686             20  PI-LAST-ERROR-NO        PIC X(4).
   687             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   688
   689         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   690             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   691
   692         16  PI-CR-CONTROL-IN-PROGRESS.
   693             20  PI-CR-CARRIER           PIC X.
   694             20  PI-CR-GROUPING          PIC X(6).
   695             20  PI-CR-STATE             PIC XX.
   696             20  PI-CR-ACCOUNT           PIC X(10).
   697             20  PI-CR-FIN-RESP          PIC X(10).
   698             20  PI-CR-TYPE              PIC X.
   699
   700         16  PI-CR-BATCH-NUMBER          PIC X(6).
   701
   702         16  PI-CR-MONTH-END-DT          PIC XX.
   703
   704         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   705             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   706             88  PI-ZERO-CARRIER             VALUE '1'.
   707             88  PI-ZERO-GROUPING            VALUE '2'.
   708             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   709
   710         16  PI-CARRIER-SECURITY         PIC X.
   711             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   712
   713         16  PI-ACCOUNT-SECURITY         PIC X(10).
   714             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   715             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   716
   717         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   718             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   719                                         INDEXED BY PI-ACCESS-NDX
   720                                         PIC X.
   721
   722         16  PI-GA-BILLING-CONTROL       PIC X.
   723             88  PI-GA-BILLING               VALUE '1'.
   724
   725         16  PI-MAIL-PROCESSING          PIC X.
   726             88  PI-MAIL-YES                 VALUE 'Y'.
   727
   728         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   729
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL113.cbl
   730         16  PI-AR-SYSTEM.
   731             20  PI-AR-PROCESSING-CNTL   PIC X.
   732                 88  PI-AR-PROCESSING        VALUE 'Y'.
   733             20  PI-AR-SUMMARY-CODE      PIC X(6).
   734             20  PI-AR-MONTH-END-DT      PIC XX.
   735
   736         16  PI-MP-SYSTEM.
   737             20  PI-MORTGAGE-USER            PIC X.
   738                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   739                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   740             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   741                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   742                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   743                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   744                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   745                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   746             20  PI-MP-MONTH-END-DT          PIC XX.
   747             20  PI-MP-REFERENCE-NO.
   748                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   749                 24  PI-MP-REFERENCE-SFX     PIC XX.
   750
   751         16  PI-LABEL-CONTROL            PIC X(01).
   752             88  PI-CREATE-LABELS                    VALUE 'Y'.
   753             88  PI-BYPASS-LABELS                    VALUE 'N'.
   754
   755         16  PI-BILL-GROUPING-CODE       PIC X(01).
   756             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   757
   758         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   759             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   760             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   761
   762         16  FILLER                      PIC X(14).
   763
   764     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   765******************************************************************
   766     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   767         16  PI-PREV-ACCOUNT     PIC X(26).
   768         16  PI-PREV-VG-ACCOUNT  PIC X(26).
   769
   770         16  ACCT-KEY.
   771           18  ACCT-PARTIAL-KEY.
   772             20  ACCT-CO             PIC X.
   773             20  ACCT-CARRIER        PIC X.
   774             20  ACCT-GROUPING       PIC X(6).
   775             20  ACCT-STATE          PIC XX.
   776             20  ACCT-ACCOUNT        PIC X(10).
   777           18  ACCT-EXP-DT           PIC XX.
   778           18  ACCT-FILLER           PIC X(04).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL113.cbl
   780*                            COPY ELCAID.
   781******************************************************************
   782*                                                                *
   783*                            ELCAID.                             *
   784*                            VMOD=2.001                          *
   785*                                                                *
   786*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   787*                                                                *
   788*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   789*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   790******************************************************************
   791
   792 01  DFHAID.
   793   02  DFHNULL   PIC  X  VALUE  ' '.
   794   02  DFHENTER  PIC  X  VALUE  QUOTE.
   795   02  DFHCLEAR  PIC  X  VALUE  '_'.
   796   02  DFHPEN    PIC  X  VALUE  '='.
   797   02  DFHOPID   PIC  X  VALUE  'W'.
   798   02  DFHPA1    PIC  X  VALUE  '%'.
   799   02  DFHPA2    PIC  X  VALUE  '>'.
   800   02  DFHPA3    PIC  X  VALUE  ','.
   801   02  DFHPF1    PIC  X  VALUE  '1'.
   802   02  DFHPF2    PIC  X  VALUE  '2'.
   803   02  DFHPF3    PIC  X  VALUE  '3'.
   804   02  DFHPF4    PIC  X  VALUE  '4'.
   805   02  DFHPF5    PIC  X  VALUE  '5'.
   806   02  DFHPF6    PIC  X  VALUE  '6'.
   807   02  DFHPF7    PIC  X  VALUE  '7'.
   808   02  DFHPF8    PIC  X  VALUE  '8'.
   809   02  DFHPF9    PIC  X  VALUE  '9'.
   810   02  DFHPF10   PIC  X  VALUE  ':'.
   811   02  DFHPF11   PIC  X  VALUE  '#'.
   812   02  DFHPF12   PIC  X  VALUE  '@'.
   813   02  DFHPF13   PIC  X  VALUE  'A'.
   814   02  DFHPF14   PIC  X  VALUE  'B'.
   815   02  DFHPF15   PIC  X  VALUE  'C'.
   816   02  DFHPF16   PIC  X  VALUE  'D'.
   817   02  DFHPF17   PIC  X  VALUE  'E'.
   818   02  DFHPF18   PIC  X  VALUE  'F'.
   819   02  DFHPF19   PIC  X  VALUE  'G'.
   820   02  DFHPF20   PIC  X  VALUE  'H'.
   821   02  DFHPF21   PIC  X  VALUE  'I'.
   822*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   823   02  DFHPF22   PIC  X  VALUE  '['.
   824   02  DFHPF23   PIC  X  VALUE  '.'.
   825   02  DFHPF24   PIC  X  VALUE  '<'.
   826   02  DFHMSRE   PIC  X  VALUE  'X'.
   827   02  DFHSTRF   PIC  X  VALUE  'h'.
   828   02  DFHTRIG   PIC  X  VALUE  '"'.
   829 01  FILLER    REDEFINES DFHAID.
   830     12  FILLER              PIC X(8).
   831     12  PF-VALUES           PIC X       OCCURS 2.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL113.cbl
   833*                            COPY EL113S.
   834 01  EL113AI.
   835     05  FILLER            PIC  X(0012).
   836*    -------------------------------
   837     05  ADATEL PIC S9(0004) COMP.
   838     05  ADATEF PIC  X(0001).
   839     05  FILLER REDEFINES ADATEF.
   840         10  ADATEA PIC  X(0001).
   841     05  ADATEI PIC  X(0008).
   842*    -------------------------------
   843     05  ATIMEL PIC S9(0004) COMP.
   844     05  ATIMEF PIC  X(0001).
   845     05  FILLER REDEFINES ATIMEF.
   846         10  ATIMEA PIC  X(0001).
   847     05  ATIMEI PIC  X(0005).
   848*    -------------------------------
   849     05  AMAINTL PIC S9(0004) COMP.
   850     05  AMAINTF PIC  X(0001).
   851     05  FILLER REDEFINES AMAINTF.
   852         10  AMAINTA PIC  X(0001).
   853     05  AMAINTI PIC  X(0001).
   854*    -------------------------------
   855     05  ACARIERL PIC S9(0004) COMP.
   856     05  ACARIERF PIC  X(0001).
   857     05  FILLER REDEFINES ACARIERF.
   858         10  ACARIERA PIC  X(0001).
   859     05  ACARIERI PIC  X(0001).
   860*    -------------------------------
   861     05  AGROUPL PIC S9(0004) COMP.
   862     05  AGROUPF PIC  X(0001).
   863     05  FILLER REDEFINES AGROUPF.
   864         10  AGROUPA PIC  X(0001).
   865     05  AGROUPI PIC  X(0006).
   866*    -------------------------------
   867     05  ASTATEL PIC S9(0004) COMP.
   868     05  ASTATEF PIC  X(0001).
   869     05  FILLER REDEFINES ASTATEF.
   870         10  ASTATEA PIC  X(0001).
   871     05  ASTATEI PIC  X(0002).
   872*    -------------------------------
   873     05  AACCTL PIC S9(0004) COMP.
   874     05  AACCTF PIC  X(0001).
   875     05  FILLER REDEFINES AACCTF.
   876         10  AACCTA PIC  X(0001).
   877     05  AACCTI PIC  X(0010).
   878*    -------------------------------
   879     05  AEXPDTL PIC S9(0004) COMP.
   880     05  AEXPDTF PIC  X(0001).
   881     05  FILLER REDEFINES AEXPDTF.
   882         10  AEXPDTA PIC  X(0001).
   883     05  AEXPDTI PIC  X(0008).
   884*    -------------------------------
   885     05  AEFFDTL PIC S9(0004) COMP.
   886     05  AEFFDTF PIC  X(0001).
   887     05  FILLER REDEFINES AEFFDTF.
   888         10  AEFFDTA PIC  X(0001).
   889     05  AEFFDTI PIC  X(0008).
   890*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL113.cbl
   891     05  ANAMEL PIC S9(0004) COMP.
   892     05  ANAMEF PIC  X(0001).
   893     05  FILLER REDEFINES ANAMEF.
   894         10  ANAMEA PIC  X(0001).
   895     05  ANAMEI PIC  X(0030).
   896*    -------------------------------
   897     05  ACAREOFL PIC S9(0004) COMP.
   898     05  ACAREOFF PIC  X(0001).
   899     05  FILLER REDEFINES ACAREOFF.
   900         10  ACAREOFA PIC  X(0001).
   901     05  ACAREOFI PIC  X(0030).
   902*    -------------------------------
   903     05  AADDR1L PIC S9(0004) COMP.
   904     05  AADDR1F PIC  X(0001).
   905     05  FILLER REDEFINES AADDR1F.
   906         10  AADDR1A PIC  X(0001).
   907     05  AADDR1I PIC  X(0030).
   908*    -------------------------------
   909     05  ACITYSTL PIC S9(0004) COMP.
   910     05  ACITYSTF PIC  X(0001).
   911     05  FILLER REDEFINES ACITYSTF.
   912         10  ACITYSTA PIC  X(0001).
   913     05  ACITYSTI PIC  X(0030).
   914*    -------------------------------
   915     05  AZIPL PIC S9(0004) COMP.
   916     05  AZIPF PIC  X(0001).
   917     05  FILLER REDEFINES AZIPF.
   918         10  AZIPA PIC  X(0001).
   919     05  AZIPI PIC  X(0010).
   920*    -------------------------------
   921     05  APHONEL PIC S9(0004) COMP.
   922     05  APHONEF PIC  X(0001).
   923     05  FILLER REDEFINES APHONEF.
   924         10  APHONEA PIC  X(0001).
   925     05  APHONEI PIC  X(0012).
   926*    -------------------------------
   927     05  ALIFLEVL PIC S9(0004) COMP.
   928     05  ALIFLEVF PIC  X(0001).
   929     05  FILLER REDEFINES ALIFLEVF.
   930         10  ALIFLEVA PIC  X(0001).
   931     05  ALIFLEVI PIC  X(0001).
   932*    -------------------------------
   933     05  ADECLIFL PIC S9(0004) COMP.
   934     05  ADECLIFF PIC  X(0001).
   935     05  FILLER REDEFINES ADECLIFF.
   936         10  ADECLIFA PIC  X(0001).
   937     05  ADECLIFI PIC  X(0001).
   938*    -------------------------------
   939     05  ADECAHL PIC S9(0004) COMP.
   940     05  ADECAHF PIC  X(0001).
   941     05  FILLER REDEFINES ADECAHF.
   942         10  ADECAHA PIC  X(0001).
   943     05  ADECAHI PIC  X(0001).
   944*    -------------------------------
   945     05  AALLOWL PIC S9(0004) COMP.
   946     05  AALLOWF PIC  X(0001).
   947     05  FILLER REDEFINES AALLOWF.
   948         10  AALLOWA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL113.cbl
   949     05  AALLOWI PIC  X(0006).
   950*    -------------------------------
   951     05  AEMSG1L PIC S9(0004) COMP.
   952     05  AEMSG1F PIC  X(0001).
   953     05  FILLER REDEFINES AEMSG1F.
   954         10  AEMSG1A PIC  X(0001).
   955     05  AEMSG1I PIC  X(0079).
   956*    -------------------------------
   957     05  AEMSG2L PIC S9(0004) COMP.
   958     05  AEMSG2F PIC  X(0001).
   959     05  FILLER REDEFINES AEMSG2F.
   960         10  AEMSG2A PIC  X(0001).
   961     05  AEMSG2I PIC  X(0079).
   962*    -------------------------------
   963     05  AEMSG3L PIC S9(0004) COMP.
   964     05  AEMSG3F PIC  X(0001).
   965     05  FILLER REDEFINES AEMSG3F.
   966         10  AEMSG3A PIC  X(0001).
   967     05  AEMSG3I PIC  X(0079).
   968*    -------------------------------
   969     05  APFKL PIC S9(0004) COMP.
   970     05  APFKF PIC  X(0001).
   971     05  FILLER REDEFINES APFKF.
   972         10  APFKA PIC  X(0001).
   973     05  APFKI PIC  9(2).
   974 01  EL113AO REDEFINES EL113AI.
   975     05  FILLER            PIC  X(0012).
   976*    -------------------------------
   977     05  FILLER            PIC  X(0003).
   978     05  ADATEO PIC  X(0008).
   979*    -------------------------------
   980     05  FILLER            PIC  X(0003).
   981     05  ATIMEO PIC  99.99.
   982*    -------------------------------
   983     05  FILLER            PIC  X(0003).
   984     05  AMAINTO PIC  X(0001).
   985*    -------------------------------
   986     05  FILLER            PIC  X(0003).
   987     05  ACARIERO PIC  X(0001).
   988*    -------------------------------
   989     05  FILLER            PIC  X(0003).
   990     05  AGROUPO PIC  X(0006).
   991*    -------------------------------
   992     05  FILLER            PIC  X(0003).
   993     05  ASTATEO PIC  X(0002).
   994*    -------------------------------
   995     05  FILLER            PIC  X(0003).
   996     05  AACCTO PIC  X(0010).
   997*    -------------------------------
   998     05  FILLER            PIC  X(0003).
   999     05  AEXPDTO PIC  99B99B99.
  1000*    -------------------------------
  1001     05  FILLER            PIC  X(0003).
  1002     05  AEFFDTO PIC  99B99B99.
  1003*    -------------------------------
  1004     05  FILLER            PIC  X(0003).
  1005     05  ANAMEO PIC  X(0030).
  1006*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL113.cbl
  1007     05  FILLER            PIC  X(0003).
  1008     05  ACAREOFO PIC  X(0030).
  1009*    -------------------------------
  1010     05  FILLER            PIC  X(0003).
  1011     05  AADDR1O PIC  X(0030).
  1012*    -------------------------------
  1013     05  FILLER            PIC  X(0003).
  1014     05  ACITYSTO PIC  X(0030).
  1015*    -------------------------------
  1016     05  FILLER            PIC  X(0003).
  1017     05  AZIPO PIC  X(0010).
  1018*    -------------------------------
  1019     05  FILLER            PIC  X(0003).
  1020     05  APHONEO PIC  999B999B9999.
  1021*    -------------------------------
  1022     05  FILLER            PIC  X(0003).
  1023     05  ALIFLEVO PIC  X(0001).
  1024*    -------------------------------
  1025     05  FILLER            PIC  X(0003).
  1026     05  ADECLIFO PIC  X(0001).
  1027*    -------------------------------
  1028     05  FILLER            PIC  X(0003).
  1029     05  ADECAHO PIC  X(0001).
  1030*    -------------------------------
  1031     05  FILLER            PIC  X(0003).
  1032     05  AALLOWO PIC  ZZ9.99.
  1033*    -------------------------------
  1034     05  FILLER            PIC  X(0003).
  1035     05  AEMSG1O PIC  X(0079).
  1036*    -------------------------------
  1037     05  FILLER            PIC  X(0003).
  1038     05  AEMSG2O PIC  X(0079).
  1039*    -------------------------------
  1040     05  FILLER            PIC  X(0003).
  1041     05  AEMSG3O PIC  X(0079).
  1042*    -------------------------------
  1043     05  FILLER            PIC  X(0003).
  1044     05  APFKO PIC  99.
  1045*    -------------------------------
  1046*01  MAP-REDEF REDEFINES EL113AI.
  1047*    12  FILLER                  PIC X(70).
  1048*    12  MAP-RECORD-AREA         PIC X(214).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL113.cbl
  1050****************************************************************
  1051*
  1052* Copyright (c) 2007 by Clerity Solutions, Inc.
  1053* All rights reserved.
  1054*
  1055****************************************************************
  1056 01  DFHEIV.
  1057   02  DFHEIV0               PIC X(35).
  1058   02  DFHEIV1               PIC X(08).
  1059   02  DFHEIV2               PIC X(08).
  1060   02  DFHEIV3               PIC X(08).
  1061   02  DFHEIV4               PIC X(06).
  1062   02  DFHEIV5               PIC X(04).
  1063   02  DFHEIV6               PIC X(04).
  1064   02  DFHEIV7               PIC X(02).
  1065   02  DFHEIV8               PIC X(02).
  1066   02  DFHEIV9               PIC X(01).
  1067   02  DFHEIV10              PIC S9(7) COMP-3.
  1068   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1069   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1070   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1071   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1072   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1073   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1074   02  DFHEIV17              PIC X(04).
  1075   02  DFHEIV18              PIC X(04).
  1076   02  DFHEIV19              PIC X(04).
  1077   02  DFHEIV20              USAGE IS POINTER.
  1078   02  DFHEIV21              USAGE IS POINTER.
  1079   02  DFHEIV22              USAGE IS POINTER.
  1080   02  DFHEIV23              USAGE IS POINTER.
  1081   02  DFHEIV24              USAGE IS POINTER.
  1082   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1083   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1084   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1085   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1086   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1087   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1088   02  FILLER                PIC X(02).
  1089   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1090   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1091   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1092   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1093   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1094 LINKAGE  SECTION.
  1095*****************************************************************
  1096*                                                               *
  1097* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1098* All rights reserved.                                          *
  1099*                                                               *
  1100*****************************************************************
  1101 01  dfheiblk.
  1102     02  eibtime          pic s9(7) comp-3.
  1103     02  eibdate          pic s9(7) comp-3.
  1104     02  eibtrnid         pic x(4).
  1105     02  eibtaskn         pic s9(7) comp-3.
  1106     02  eibtrmid         pic x(4).
  1107     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL113.cbl
  1108     02  eibcposn         pic s9(4) comp.
  1109     02  eibcalen         pic s9(4) comp.
  1110     02  eibaid           pic x(1).
  1111     02  eibfiller1       pic x(1).
  1112     02  eibfn            pic x(2).
  1113     02  eibfiller2       pic x(2).
  1114     02  eibrcode         pic x(6).
  1115     02  eibfiller3       pic x(2).
  1116     02  eibds            pic x(8).
  1117     02  eibreqid         pic x(8).
  1118     02  eibrsrce         pic x(8).
  1119     02  eibsync          pic x(1).
  1120     02  eibfree          pic x(1).
  1121     02  eibrecv          pic x(1).
  1122     02  eibsend          pic x(1).
  1123     02  eibatt           pic x(1).
  1124     02  eibeoc           pic x(1).
  1125     02  eibfmh           pic x(1).
  1126     02  eibcompl         pic x(1).
  1127     02  eibsig           pic x(1).
  1128     02  eibconf          pic x(1).
  1129     02  eiberr           pic x(1).
  1130     02  eibrldbk         pic x(1).
  1131     02  eiberrcd         pic x(4).
  1132     02  eibsynrb         pic x(1).
  1133     02  eibnodat         pic x(1).
  1134     02  eibfiller5       pic x(2).
  1135     02  eibresp          pic 9(09) comp.
  1136     02  eibresp2         pic 9(09) comp.
  1137     02  dfheigdj         pic s9(4) comp.
  1138     02  dfheigdk         pic s9(4) comp.
  1139 01  DFHCOMMAREA             PIC X(1024).
  1140
  1141 01  PARMLIST.
  1142     02  FILLER              PIC S9(8)   COMP.
  1143     02  ACCT-POINTER        PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL113.cbl
  1145*                            COPY ERCACCT.
  1146******************************************************************
  1147*                                                                *
  1148*                                                                *
  1149*                            ERCACCT                             *
  1150*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1151*                            VMOD=2.031                          *
  1152*                                                                *
  1153*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1154*                                                                *
  1155*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1156*   VSAM ACCOUNT MASTER FILES.                                   *
  1157*                                                                *
  1158*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1159*                                                                *
  1160*   FILE TYPE = VSAM,KSDS                                        *
  1161*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1162*                                                                *
  1163*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1164*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1165*                                                                *
  1166*   LOG = NO                                                     *
  1167*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1168*                                                                *
  1169*                                                                *
  1170******************************************************************
  1171*                   C H A N G E   L O G
  1172*
  1173* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1174*-----------------------------------------------------------------
  1175*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1176* EFFECTIVE    NUMBER
  1177*-----------------------------------------------------------------
  1178* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1179* 092705    2005050300006  PEMA  ADD SPP LEASES
  1180* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1181* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1182******************************************************************
  1183
  1184 01  ACCOUNT-MASTER.
  1185     12  AM-RECORD-ID                      PIC XX.
  1186         88  VALID-AM-ID                      VALUE 'AM'.
  1187
  1188     12  AM-CONTROL-PRIMARY.
  1189         16  AM-COMPANY-CD                 PIC X.
  1190         16  AM-MSTR-CNTRL.
  1191             20  AM-CONTROL-A.
  1192                 24  AM-CARRIER            PIC X.
  1193                 24  AM-GROUPING.
  1194                     28 AM-GROUPING-PREFIX PIC XXX.
  1195                     28 AM-GROUPING-PRIME  PIC XXX.
  1196                 24  AM-STATE              PIC XX.
  1197                 24  AM-ACCOUNT.
  1198                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1199                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1200             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1201                                           PIC X(19).
  1202             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL113.cbl
  1203                 24  AM-EXPIRATION-DT      PIC XX.
  1204                 24  FILLER                PIC X(4).
  1205             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1206                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1207
  1208     12  AM-CONTROL-BY-VAR-GRP.
  1209         16  AM-COMPANY-CD-A1              PIC X.
  1210         16  AM-VG-CARRIER                 PIC X.
  1211         16  AM-VG-GROUPING                PIC X(6).
  1212         16  AM-VG-STATE                   PIC XX.
  1213         16  AM-VG-ACCOUNT                 PIC X(10).
  1214         16  AM-VG-DATE.
  1215             20  AM-VG-EXPIRATION-DT       PIC XX.
  1216             20  FILLER                    PIC X(4).
  1217         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1218                                           PIC 9(11)      COMP-3.
  1219     12  AM-MAINT-INFORMATION.
  1220         16  AM-LAST-MAINT-DT              PIC XX.
  1221         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1222         16  AM-LAST-MAINT-USER            PIC X(4).
  1223         16  FILLER                        PIC XX.
  1224
  1225     12  AM-EFFECTIVE-DT                   PIC XX.
  1226     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1227
  1228     12  AM-PREV-DATES  COMP-3.
  1229         16  AM-PREV-EXP-DT                PIC 9(11).
  1230         16  AM-PREV-EFF-DT                PIC 9(11).
  1231
  1232     12  AM-REPORT-CODE-1                  PIC X(10).
  1233     12  AM-REPORT-CODE-2                  PIC X(10).
  1234
  1235     12  AM-CITY-CODE                      PIC X(4).
  1236     12  AM-COUNTY-PARISH                  PIC X(6).
  1237
  1238     12  AM-NAME                           PIC X(30).
  1239     12  AM-PERSON                         PIC X(30).
  1240     12  AM-ADDRS                          PIC X(30).
  1241     12  AM-CITY.
  1242         16  AM-ADDR-CITY                  PIC X(28).
  1243         16  AM-ADDR-STATE                 PIC XX.
  1244     12  AM-ZIP.
  1245         16  AM-ZIP-PRIME.
  1246             20  AM-ZIP-PRI-1ST            PIC X.
  1247                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1248             20  FILLER                    PIC X(4).
  1249         16  AM-ZIP-PLUS4                  PIC X(4).
  1250     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1251         16  AM-CAN-POSTAL-1               PIC XXX.
  1252         16  AM-CAN-POSTAL-2               PIC XXX.
  1253         16  FILLER                        PIC XXX.
  1254     12  AM-TEL-NO.
  1255         16  AM-AREA-CODE                  PIC 999.
  1256         16  AM-TEL-PRE                    PIC 999.
  1257         16  AM-TEL-NBR                    PIC 9(4).
  1258     12  AM-TEL-LOC                        PIC X.
  1259         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1260         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL113.cbl
  1261
  1262     12  AM-COMM-STRUCTURE.
  1263         16  AM-DEFN-1.
  1264             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1265                 24  AM-AGT.
  1266                     28  AM-AGT-PREFIX     PIC X(4).
  1267                     28  AM-AGT-PRIME      PIC X(6).
  1268                 24  AM-COM-TYP            PIC X.
  1269                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1270                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1271                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1272                 24  AM-RECALC-LV-INDIC    PIC X.
  1273                 24  AM-RETRO-LV-INDIC     PIC X.
  1274                 24  AM-GL-CODES           PIC X.
  1275                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1276                 24  FILLER                PIC X(01).
  1277         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1278             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1279                 24  FILLER                PIC X(11).
  1280                 24  AM-L-COMA             PIC XXX.
  1281                 24  AM-J-COMA             PIC XXX.
  1282                 24  AM-A-COMA             PIC XXX.
  1283                 24  FILLER                PIC X(6).
  1284
  1285     12  AM-COMM-CHANGE-STATUS             PIC X.
  1286         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1287
  1288     12  AM-CSR-CODE                       PIC X(4).
  1289
  1290     12  AM-BILLING-STATUS                 PIC X.
  1291         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1292         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1293     12  AM-AUTO-REFUND-SW                 PIC X.
  1294         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1295         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1296     12  AM-GPCD                           PIC 99.
  1297     12  AM-IG                             PIC X.
  1298         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1299         88  AM-HAS-GROUP                     VALUE '2'.
  1300     12  AM-STATUS                         PIC X.
  1301         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1302         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1303         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1304         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1305         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1306     12  AM-REMIT-TO                       PIC 99.
  1307     12  AM-ID-NO                          PIC X(11).
  1308
  1309     12  AM-CAL-TABLE                      PIC XX.
  1310     12  AM-LF-DEVIATION                   PIC XXX.
  1311     12  AM-AH-DEVIATION                   PIC XXX.
  1312     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1313     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1314     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1315     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1316     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1317     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1318
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL113.cbl
  1319     12  AM-USER-FIELDS.
  1320         16  AM-FLD-1                      PIC XX.
  1321         16  AM-FLD-2                      PIC XX.
  1322         16  AM-FLD-3                      PIC XX.
  1323         16  AM-FLD-4                      PIC XX.
  1324         16  AM-FLD-5                      PIC XX.
  1325
  1326     12  AM-1ST-PROD-DATE.
  1327         16  AM-1ST-PROD-YR                PIC XX.
  1328         16  AM-1ST-PROD-MO                PIC XX.
  1329         16  AM-1ST-PROD-DA                PIC XX.
  1330     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1331     12  AM-CERTS-PURGED-DATE.
  1332         16  AM-PUR-YR                     PIC XX.
  1333         16  AM-PUR-MO                     PIC XX.
  1334         16  AM-PUR-DA                     PIC XX.
  1335     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1336     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1337     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1338     12  AM-INACTIVE-DATE.
  1339         16  AM-INA-MO                     PIC 99.
  1340         16  AM-INA-DA                     PIC 99.
  1341         16  AM-INA-YR                     PIC 99.
  1342     12  AM-AR-HI-CERT-DATE                PIC XX.
  1343
  1344     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1345     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1346
  1347     12  AM-OB-PAYMENT-MODE                PIC X.
  1348         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1349         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1350         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1351         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1352
  1353     12  AM-AH-ONLY-INDICATOR              PIC X.
  1354         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1355         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1356
  1357     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1358
  1359     12  AM-OVER-SHORT.
  1360         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1361         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1362
  1363     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1364     12  AM-DCC-CLP-STATE                  PIC XX.
  1365
  1366     12  AM-RECALC-COMM                    PIC X.
  1367     12  AM-RECALC-REIN                    PIC X.
  1368
  1369     12  AM-REI-TABLE                      PIC XXX.
  1370     12  AM-REI-ET-LF                      PIC X.
  1371     12  AM-REI-ET-AH                      PIC X.
  1372     12  AM-REI-PE-LF                      PIC X.
  1373     12  AM-REI-PE-AH                      PIC X.
  1374     12  AM-REI-PRT-ST                     PIC X.
  1375     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1376     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL113.cbl
  1377     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1378     12  AM-REI-GROUP-A                    PIC X(6).
  1379     12  AM-REI-MORT                       PIC X(4).
  1380     12  AM-REI-PRT-OW                     PIC X.
  1381     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1382     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1383     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1384     12  AM-REI-GROUP-B                    PIC X(6).
  1385
  1386     12  AM-TRUST-TYPE                     PIC X(2).
  1387
  1388     12  AM-EMPLOYER-STMT-USED             PIC X.
  1389     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1390
  1391     12  AM-STD-AH-TYPE                    PIC XX.
  1392     12  AM-EARN-METHODS.
  1393         16  AM-EARN-METHOD-R              PIC X.
  1394             88 AM-REF-RL-R78                 VALUE 'R'.
  1395             88 AM-REF-RL-PR                  VALUE 'P'.
  1396             88 AM-REF-RL-MEAN                VALUE 'M'.
  1397             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1398         16  AM-EARN-METHOD-L              PIC X.
  1399             88 AM-REF-LL-R78                 VALUE 'R'.
  1400             88 AM-REF-LL-PR                  VALUE 'P'.
  1401             88 AM-REF-LL-MEAN                VALUE 'M'.
  1402             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1403         16  AM-EARN-METHOD-A              PIC X.
  1404             88 AM-REF-AH-R78                 VALUE 'R'.
  1405             88 AM-REF-AH-PR                  VALUE 'P'.
  1406             88 AM-REF-AH-MEAN                VALUE 'M'.
  1407             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1408             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1409             88 AM-REF-AH-NET                 VALUE 'N'.
  1410
  1411     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1412     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1413     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1414
  1415     12  AM-RET-Y-N                        PIC X.
  1416     12  AM-RET-P-E                        PIC X.
  1417     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1418     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1419     12  AM-RET-GRP                        PIC X(6).
  1420     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1421         16  AM-POOL-PRIME                 PIC XXX.
  1422         16  AM-POOL-SUB                   PIC XXX.
  1423     12  AM-RETRO-EARNINGS.
  1424         16  AM-RET-EARN-R                 PIC X.
  1425         16  AM-RET-EARN-L                 PIC X.
  1426         16  AM-RET-EARN-A                 PIC X.
  1427     12  AM-RET-ST-TAX-USE                 PIC X.
  1428         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1429         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1430     12  AM-RETRO-BEG-EARNINGS.
  1431         16  AM-RET-BEG-EARN-R             PIC X.
  1432         16  AM-RET-BEG-EARN-L             PIC X.
  1433         16  AM-RET-BEG-EARN-A             PIC X.
  1434     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL113.cbl
  1435     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1436
  1437     12  AM-USER-SELECT-OPTIONS.
  1438         16  AM-USER-SELECT-1              PIC X(10).
  1439         16  AM-USER-SELECT-2              PIC X(10).
  1440         16  AM-USER-SELECT-3              PIC X(10).
  1441         16  AM-USER-SELECT-4              PIC X(10).
  1442         16  AM-USER-SELECT-5              PIC X(10).
  1443
  1444     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1445
  1446     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1447
  1448     12  AM-RPT045A-SWITCH                 PIC X.
  1449         88  RPT045A-OFF                   VALUE 'N'.
  1450
  1451     12  AM-INSURANCE-LIMITS.
  1452         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1453         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1454
  1455     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1456         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1457
  1458     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1459         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1460         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1461
  1462     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1463
  1464     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1465     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1466     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1467     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1468     12  FILLER                            PIC X(5).
  1469     12  AM-REPORT-CODE-3                  PIC X(10).
  1470*    12  FILLER                            PIC X(22).
  1471
  1472     12  AM-RESERVE-DATE.
  1473         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1474         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1475         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1476
  1477     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1478     12  AM-NOTIFICATION-TYPES.
  1479         16  AM-NOTIF-OF-LETTERS           PIC X.
  1480         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1481         16  AM-NOTIF-OF-REPORTS           PIC X.
  1482         16  AM-NOTIF-OF-STATUS            PIC X.
  1483
  1484     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1485         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1486         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1487         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1488         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1489
  1490     12  AM-BENEFIT-CONTROLS.
  1491         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  1492             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL113.cbl
  1493             20  AM-BENEFIT-TYPE           PIC X.
  1494             20  AM-BENEFIT-REVISION       PIC XXX.
  1495             20  AM-BENEFIT-REM-TERM       PIC X.
  1496             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  1497             20  FILLER                    PIC XX.
  1498         16  FILLER                        PIC X(80).
  1499
  1500     12  AM-TRANSFER-DATA.
  1501         16  AM-TRANSFERRED-FROM.
  1502             20  AM-TRNFROM-CARRIER        PIC X.
  1503             20  AM-TRNFROM-GROUPING.
  1504                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  1505                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  1506             20  AM-TRNFROM-STATE          PIC XX.
  1507             20  AM-TRNFROM-ACCOUNT.
  1508                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  1509                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  1510             20  AM-TRNFROM-DTE            PIC XX.
  1511         16  AM-TRANSFERRED-TO.
  1512             20  AM-TRNTO-CARRIER          PIC X.
  1513             20  AM-TRNTO-GROUPING.
  1514                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  1515                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  1516             20  AM-TRNTO-STATE            PIC XX.
  1517             20  AM-TRNTO-ACCOUNT.
  1518                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  1519                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  1520             20  AM-TRNTO-DTE              PIC XX.
  1521         16  FILLER                        PIC X(10).
  1522
  1523     12  AM-SAVED-REMIT-TO                 PIC 99.
  1524
  1525     12  AM-COMM-STRUCTURE-SAVED.
  1526         16  AM-DEFN-1-SAVED.
  1527             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  1528                 24  AM-AGT-SV             PIC X(10).
  1529                 24  AM-COM-TYP-SV         PIC X.
  1530                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  1531                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  1532                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  1533                 24  AM-RECALC-LV-INDIC-SV PIC X.
  1534                 24  FILLER                PIC X.
  1535                 24  AM-GL-CODES-SV        PIC X.
  1536                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  1537                 24  FILLER                PIC X.
  1538         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  1539             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  1540                 24  FILLER                PIC X(11).
  1541                 24  AM-L-COMA-SV          PIC XXX.
  1542                 24  AM-J-COMA-SV          PIC XXX.
  1543                 24  AM-A-COMA-SV          PIC XXX.
  1544                 24  FILLER                PIC X(6).
  1545
  1546     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  1547         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  1548            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  1549            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  1550            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL113.cbl
  1551
  1552     12  AM-ORIG-DEALER-NO                 PIC X(10).
  1553     12  FILLER                            PIC X(120).
  1554
  1555     12  AM-ACCOUNT-EXECUTIVE-DATA.
  1556         16  AM-CONTROL-NAME               PIC X(30).
  1557         16  AM-EXECUTIVE-ONE.
  1558             20  AM-EXEC1-NAME             PIC X(15).
  1559             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  1560                                                          COMP-3.
  1561             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  1562                                                          COMP-3.
  1563         16  AM-EXECUTIVE-TWO.
  1564             20  AM-EXEC2-NAME             PIC X(15).
  1565             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  1566                                                          COMP-3.
  1567             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  1568                                                          COMP-3.
  1569
  1570     12  AM-RETRO-ADDITIONAL-DATA.
  1571         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  1572         16  AM-RETRO-PREM-P-E             PIC X.
  1573         16  AM-RETRO-CLMS-P-I             PIC X.
  1574         16  AM-RETRO-RET-BRACKET-LF.
  1575             20  AM-RETRO-RET-METHOD-LF    PIC X.
  1576                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  1577                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  1578             20  AM-RETRO-RET-BASIS-LF     PIC X.
  1579                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  1580                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  1581             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  1582                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  1583                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  1584         16  AM-RETRO-RET-BRACKET-AH.
  1585             20  AM-RETRO-RET-METHOD-AH    PIC X.
  1586                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  1587                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  1588                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  1589             20  AM-RETRO-RET-BASIS-AH     PIC X.
  1590                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  1591                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  1592             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  1593                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  1594                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  1595
  1596     12  AM-COMMENTS.
  1597         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  1598
  1599     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  1600         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  1601         16  AM-FLI-BILLING-CODE           PIC X.
  1602         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  1603         16  AM-FLI-UNITED-IDENT           PIC X.
  1604         16  AM-FLI-INTEREST-LOST-DATA.
  1605             20  AM-FLI-BANK-NO            PIC X(5).
  1606             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  1607             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  1608             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL113.cbl
  1609         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  1610             20  AM-FLI-AGT                PIC X(9).
  1611             20  AM-FLI-AGT-COMM-ACC       PIC X.
  1612             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  1613         16  FILLER                        PIC X(102).
  1614
  1615     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  1616         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  1617             20  AM-BENEFIT-DMD-CODE         PIC XX.
  1618             20  AM-BENEFIT-DMD-TYPE         PIC X.
  1619             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  1620             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  1621             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  1622         16  FILLER                          PIC X(10).
  1623******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL113.cbl
  1625 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA PARMLIST
  1626                          ACCOUNT-MASTER.
  1627 0000-DFHEXIT SECTION.
  1628     MOVE '9#                    $   ' TO DFHEIV0.
  1629     MOVE 'EL113' TO DFHEIV1.
  1630     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1631     SERVICE RELOAD PARMLIST.
  1632     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  1633     MOVE 3  TO EMI-NUMBER-OF-LINES.
  1634     IF EIBCALEN = 0
  1635         GO TO 8800-UNAUTHORIZED-ACCESS.
  1636
  1637     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1638     MOVE '5'                   TO DC-OPTION-CODE.
  1639     PERFORM 9700-DATE-LINK.
  1640     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1641     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1642
  1643
  1644     IF PI-CALLING-PROGRAM NOT = PGM-EL113
  1645         IF PI-RETURN-TO-PROGRAM NOT = PGM-EL113
  1646             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1647             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1648             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1649             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1650             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1651             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1652             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1653             MOVE PGM-EL113 TO PI-CALLING-PROGRAM
  1654             MOVE LOW-VALUES TO EL113AO
  1655                                PI-PROGRAM-WORK-AREA
  1656             GO TO 8100-SEND-INITIAL-MAP.
  1657
  1658
  1659
  1660* EXEC CICS HANDLE CONDITION
  1661*        PGMIDERR(9600-PGMID-ERROR)
  1662*        ERROR   (9990-ABEND)
  1663*    END-EXEC.
  1664*    MOVE '"$L.                  ! " #00001655' TO DFHEIV0
  1665     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1666     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1667     MOVE X'2220233030303031363535' TO DFHEIV0(25:11)
  1668     CALL 'kxdfhei1' USING DFHEIV0
  1669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1670
  1671
  1672     IF EIBAID = DFHCLEAR
  1673         GO TO 9400-CLEAR.
  1674
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL113.cbl
  1676 0200-RECEIVE.
  1677     MOVE LOW-VALUES             TO EL113AI.
  1678     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1679         MOVE 0008               TO EMI-ERROR
  1680         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1681         MOVE -1                 TO AMAINTL
  1682         GO TO 8200-SEND-DATAONLY.
  1683
  1684
  1685* EXEC CICS RECEIVE
  1686*        MAP   (MAP-NAME)
  1687*        MAPSET(MAPSET-NAME)
  1688*        INTO  (EL113AI)
  1689*    END-EXEC.
  1690     MOVE LENGTH OF
  1691      EL113AI
  1692       TO DFHEIV11
  1693*    MOVE '8"T I  L              ''   #00001672' TO DFHEIV0
  1694     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1695     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1696     MOVE X'2020233030303031363732' TO DFHEIV0(25:11)
  1697     CALL 'kxdfhei1' USING DFHEIV0,
  1698           MAP-NAME,
  1699           EL113AI,
  1700           DFHEIV11,
  1701           MAPSET-NAME,
  1702           DFHEIV99,
  1703           DFHEIV99
  1704     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1705
  1706
  1707     IF APFKL = 0
  1708         GO TO 0300-CHECK-PFKEYS.
  1709
  1710     IF EIBAID NOT = DFHENTER
  1711         MOVE 0004               TO EMI-ERROR
  1712         GO TO 0320-INPUT-ERROR.
  1713     IF (APFKI NUMERIC) AND (APFKI > 0 AND < 25)
  1714         MOVE PF-VALUES (APFKI) TO EIBAID
  1715     ELSE
  1716         MOVE 0029               TO EMI-ERROR
  1717         GO TO 0320-INPUT-ERROR.
  1718
  1719 0300-CHECK-PFKEYS.
  1720     IF EIBAID = DFHPF23
  1721         GO TO 8810-PF23.
  1722     IF EIBAID = DFHPF24
  1723         GO TO 9200-RETURN-MAIN-MENU.
  1724     IF EIBAID = DFHPF12
  1725         GO TO 9500-PF12.
  1726     IF (AMAINTL NOT = 0 AND AMAINTI NOT = SPACE) AND
  1727        EIBAID NOT = DFHENTER
  1728         MOVE 0050               TO EMI-ERROR
  1729         GO TO 0320-INPUT-ERROR.
  1730     IF EIBAID = DFHPF1
  1731         GO TO 5000-FIND-NEXT-ACCOUNT.
  1732     IF EIBAID = DFHPF2
  1733         GO TO 5100-FIND-PREV-ACCOUNT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL113.cbl
  1734     IF EIBAID = DFHENTER
  1735         GO TO 0330-EDIT-DATA.
  1736
  1737     MOVE 0029                   TO EMI-ERROR.
  1738 0320-INPUT-ERROR.
  1739     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1740
  1741     MOVE AL-UNBON               TO APFKA.
  1742
  1743     IF APFKL = 0
  1744         MOVE -1                 TO AMAINTL
  1745        ELSE
  1746         MOVE -1                 TO APFKL.
  1747
  1748     GO TO 8200-SEND-DATAONLY.
  1749
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL113.cbl
  1751 0330-EDIT-DATA.
  1752     MOVE AL-UANON               TO AMAINTA.
  1753
  1754     IF AMAINTI = 'S'
  1755         GO TO 1000-SHOW-ACCOUNT.
  1756
  1757     MOVE E023                   TO EMI-ERROR.
  1758     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1759     MOVE -1                     TO AMAINTL.
  1760     MOVE AL-UABON               TO AMAINTA.
  1761     GO TO 8200-SEND-DATAONLY.
  1762
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL113.cbl
  1764 1000-SHOW-ACCOUNT.
  1765     PERFORM 6100-BUILD-KEY THRU 6199-EXIT.
  1766     MOVE ACCT-PARTIAL-KEY TO SAVE-ACCT-PARTIAL-KEY.
  1767
  1768
  1769* EXEC CICS HANDLE CONDITION
  1770*         NOTFND(1010-NOT-FOUND)
  1771*    END-EXEC.
  1772*    MOVE '"$I                   ! # #00001739' TO DFHEIV0
  1773     MOVE X'222449202020202020202020' TO DFHEIV0(1:12)
  1774     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1775     MOVE X'2320233030303031373339' TO DFHEIV0(25:11)
  1776     CALL 'kxdfhei1' USING DFHEIV0
  1777     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1778
  1779
  1780 1005-READ-ACCT.
  1781     MOVE LOW-VALUES             TO ACCT-FILLER.
  1782
  1783     IF ACCT-EXP-DT = LOW-VALUES
  1784
  1785* EXEC CICS READ
  1786*           DATASET(ACCT-ID)
  1787*           SET    (ACCT-POINTER)
  1788*           RIDFLD (ACCT-KEY)
  1789*           GTEQ
  1790*       END-EXEC
  1791*    MOVE '&"S        G          (   #00001747' TO DFHEIV0
  1792     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  1793     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1794     MOVE X'2020233030303031373437' TO DFHEIV0(25:11)
  1795     CALL 'kxdfhei1' USING DFHEIV0,
  1796           ACCT-ID,
  1797           ACCT-POINTER,
  1798           DFHEIV99,
  1799           ACCT-KEY,
  1800           DFHEIV99,
  1801           DFHEIV99,
  1802           DFHEIV99
  1803     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1804       ELSE
  1805
  1806* EXEC CICS READ
  1807*           DATASET(ACCT-ID)
  1808*           SET    (ACCT-POINTER)
  1809*           RIDFLD (ACCT-KEY)
  1810*       END-EXEC.
  1811*    MOVE '&"S        E          (   #00001754' TO DFHEIV0
  1812     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  1813     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1814     MOVE X'2020233030303031373534' TO DFHEIV0(25:11)
  1815     CALL 'kxdfhei1' USING DFHEIV0,
  1816           ACCT-ID,
  1817           ACCT-POINTER,
  1818           DFHEIV99,
  1819           ACCT-KEY,
  1820           DFHEIV99,
  1821           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL113.cbl
  1822           DFHEIV99
  1823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1824
  1825
  1826     SERVICE RELOAD ACCOUNT-MASTER.
  1827
  1828     MOVE AM-CONTROL-PRIMARY     TO PI-PREV-ACCOUNT
  1829                                    ACCT-KEY.
  1830     IF ACCT-PARTIAL-KEY NOT = SAVE-ACCT-PARTIAL-KEY
  1831        GO TO 1010-NOT-FOUND.
  1832
  1833     MOVE AM-CONTROL-BY-VAR-GRP  TO PI-PREV-VG-ACCOUNT.
  1834     GO TO 7000-BUILD-OUTPUT-MAP.
  1835
  1836
  1837 1010-NOT-FOUND.
  1838     MOVE E226                   TO EMI-ERROR.
  1839     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1840     MOVE -1                     TO AMAINTL.
  1841     MOVE AL-UABON               TO ACARIERA
  1842                                    AGROUPA
  1843                                    ASTATEA
  1844                                    AACCTA
  1845                                    AEXPDTA.
  1846
  1847     MOVE LOW-VALUES             TO PI-PROGRAM-WORK-AREA.
  1848     GO TO 8100-SEND-INITIAL-MAP.
  1849
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL113.cbl
  1851 5000-FIND-NEXT-ACCOUNT.
  1852     MOVE PI-PREV-ACCOUNT        TO ACCT-KEY.
  1853
  1854     IF PI-PREV-ACCOUNT = LOW-VALUES
  1855        MOVE PI-COMPANY-CD       TO ACCT-CO
  1856      ELSE
  1857        MOVE 'Y' TO FIRST-TIME-SW.
  1858
  1859
  1860* EXEC CICS HANDLE CONDITION
  1861*         NOTFND (5030-NOT-FOUND)
  1862*         ENDFILE(5030-NOT-FOUND)
  1863*    END-EXEC.
  1864*    MOVE '"$I''                  ! $ #00001793' TO DFHEIV0
  1865     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  1866     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1867     MOVE X'2420233030303031373933' TO DFHEIV0(25:11)
  1868     CALL 'kxdfhei1' USING DFHEIV0
  1869     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1870
  1871
  1872 5005-START-BR.
  1873     MOVE LOW-VALUES             TO ACCT-FILLER.
  1874
  1875
  1876* EXEC CICS STARTBR
  1877*         DATASET(ACCT-ID)
  1878*         RIDFLD (ACCT-KEY)
  1879*    END-EXEC.
  1880     MOVE 0
  1881       TO DFHEIV11
  1882*    MOVE '&,         G          &   #00001801' TO DFHEIV0
  1883     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1884     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1885     MOVE X'2020233030303031383031' TO DFHEIV0(25:11)
  1886     CALL 'kxdfhei1' USING DFHEIV0,
  1887           ACCT-ID,
  1888           ACCT-KEY,
  1889           DFHEIV99,
  1890           DFHEIV11,
  1891           DFHEIV99
  1892     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1893
  1894
  1895     MOVE 'Y'                    TO BROWSE-STARTED-SW.
  1896
  1897 5010-READ-NEXT.
  1898
  1899* EXEC CICS READNEXT
  1900*         DATASET(ACCT-ID)
  1901*         SET    (ACCT-POINTER)
  1902*         RIDFLD (ACCT-KEY)
  1903*    END-EXEC.
  1904     MOVE 0
  1905       TO DFHEIV11
  1906*    MOVE '&.S                   )   #00001809' TO DFHEIV0
  1907     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1908     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL113.cbl
  1909     MOVE X'2020233030303031383039' TO DFHEIV0(25:11)
  1910     CALL 'kxdfhei1' USING DFHEIV0,
  1911           ACCT-ID,
  1912           ACCT-POINTER,
  1913           DFHEIV99,
  1914           ACCT-KEY,
  1915           DFHEIV99,
  1916           DFHEIV11,
  1917           DFHEIV99,
  1918           DFHEIV99
  1919     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1920
  1921
  1922     SERVICE RELOAD ACCOUNT-MASTER.
  1923
  1924     IF PI-COMPANY-CD  NOT = ACCT-CO
  1925        IF PI-PREV-ACCOUNT = LOW-VALUES
  1926           MOVE E472             TO EMI-ERROR
  1927           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1928           MOVE -1               TO AMAINTL
  1929           GO TO 8200-SEND-DATAONLY
  1930        ELSE
  1931           MOVE E066                   TO EMI-ERROR
  1932           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1933           MOVE -1               TO AMAINTL
  1934           GO TO 8200-SEND-DATAONLY.
  1935
  1936     IF FIRST-TIME
  1937        MOVE SPACES TO FIRST-TIME-SW
  1938        GO TO 5010-READ-NEXT.
  1939
  1940 5020-DISPLAY-RECORD.
  1941     MOVE AM-CONTROL-PRIMARY     TO PI-PREV-ACCOUNT.
  1942     MOVE AM-CONTROL-BY-VAR-GRP  TO PI-PREV-VG-ACCOUNT.
  1943     GO TO 7000-BUILD-OUTPUT-MAP.
  1944
  1945 5030-NOT-FOUND.
  1946     IF BROWSE-STARTED
  1947        MOVE SPACE               TO BROWSE-STARTED-SW
  1948
  1949* EXEC CICS ENDBR
  1950*            DATASET(ACCT-ID)
  1951*       END-EXEC.
  1952     MOVE 0
  1953       TO DFHEIV11
  1954*    MOVE '&2                    $   #00001841' TO DFHEIV0
  1955     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  1956     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  1957     MOVE X'2020233030303031383431' TO DFHEIV0(25:11)
  1958     CALL 'kxdfhei1' USING DFHEIV0,
  1959           ACCT-ID,
  1960           DFHEIV11,
  1961           DFHEIV99
  1962     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1963
  1964
  1965     IF ACCT-ACCOUNT = LOW-VALUE
  1966        MOVE E472                   TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL113.cbl
  1967        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1968        MOVE -1 TO AMAINTL
  1969        GO TO 8200-SEND-DATAONLY.
  1970
  1971     MOVE E066                   TO EMI-ERROR.
  1972     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1973     MOVE PI-PREV-ACCOUNT        TO ACCT-KEY.
  1974     GO TO 5005-START-BR.
  1975
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL113.cbl
  1977 5100-FIND-PREV-ACCOUNT.
  1978     IF PI-PREV-ACCOUNT = LOW-VALUES
  1979        GO TO 5130-NOT-FOUND
  1980     ELSE
  1981        MOVE PI-PREV-ACCOUNT TO ACCT-KEY.
  1982
  1983
  1984* EXEC CICS HANDLE CONDITION
  1985*         NOTFND (5130-NOT-FOUND)
  1986*         ENDFILE(5130-NOT-FOUND)
  1987*    END-EXEC.
  1988*    MOVE '"$I''                  ! % #00001863' TO DFHEIV0
  1989     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  1990     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1991     MOVE X'2520233030303031383633' TO DFHEIV0(25:11)
  1992     CALL 'kxdfhei1' USING DFHEIV0
  1993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1994
  1995
  1996
  1997* EXEC CICS STARTBR
  1998*         DATASET(ACCT-ID)
  1999*         RIDFLD (ACCT-KEY)
  2000*         EQUAL
  2001*    END-EXEC.
  2002     MOVE 0
  2003       TO DFHEIV11
  2004*    MOVE '&,         E          &   #00001868' TO DFHEIV0
  2005     MOVE X'262C20202020202020202045' TO DFHEIV0(1:12)
  2006     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2007     MOVE X'2020233030303031383638' TO DFHEIV0(25:11)
  2008     CALL 'kxdfhei1' USING DFHEIV0,
  2009           ACCT-ID,
  2010           ACCT-KEY,
  2011           DFHEIV99,
  2012           DFHEIV11,
  2013           DFHEIV99
  2014     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2015
  2016
  2017     MOVE 'Y'                    TO BROWSE-STARTED-SW
  2018                                    FIRST-TIME-SW.
  2019
  2020 5110-READ-PREV.
  2021
  2022* EXEC CICS READPREV
  2023*         DATASET(ACCT-ID)
  2024*         SET    (ACCT-POINTER)
  2025*         RIDFLD (ACCT-KEY)
  2026*    END-EXEC.
  2027     MOVE 0
  2028       TO DFHEIV11
  2029*    MOVE '&0S                   )   #00001878' TO DFHEIV0
  2030     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  2031     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2032     MOVE X'2020233030303031383738' TO DFHEIV0(25:11)
  2033     CALL 'kxdfhei1' USING DFHEIV0,
  2034           ACCT-ID,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL113.cbl
  2035           ACCT-POINTER,
  2036           DFHEIV99,
  2037           ACCT-KEY,
  2038           DFHEIV99,
  2039           DFHEIV11,
  2040           DFHEIV99,
  2041           DFHEIV99
  2042     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2043
  2044
  2045     SERVICE RELOAD ACCOUNT-MASTER.
  2046
  2047     IF ACCT-CO NOT = PI-COMPANY-CD
  2048        GO TO 5130-NOT-FOUND.
  2049
  2050     IF FIRST-TIME
  2051        MOVE SPACES TO FIRST-TIME-SW
  2052        GO TO 5110-READ-PREV.
  2053
  2054     MOVE AM-CONTROL-PRIMARY     TO PI-PREV-ACCOUNT.
  2055     MOVE AM-CONTROL-BY-VAR-GRP  TO PI-PREV-VG-ACCOUNT.
  2056     GO TO 7000-BUILD-OUTPUT-MAP.
  2057
  2058 5130-NOT-FOUND.
  2059     IF BROWSE-STARTED
  2060        MOVE SPACE               TO BROWSE-STARTED-SW
  2061
  2062* EXEC CICS ENDBR
  2063*            DATASET(ACCT-ID)
  2064*        END-EXEC.
  2065     MOVE 0
  2066       TO DFHEIV11
  2067*    MOVE '&2                    $   #00001900' TO DFHEIV0
  2068     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2069     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2070     MOVE X'2020233030303031393030' TO DFHEIV0(25:11)
  2071     CALL 'kxdfhei1' USING DFHEIV0,
  2072           ACCT-ID,
  2073           DFHEIV11,
  2074           DFHEIV99
  2075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2076
  2077
  2078     MOVE E067                   TO EMI-ERROR.
  2079     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2080     MOVE -1                     TO AMAINTL.
  2081
  2082     IF PI-PREV-ACCOUNT  =  LOW-VALUES
  2083        GO TO 5000-FIND-NEXT-ACCOUNT.
  2084
  2085     MOVE PI-PREV-ACCOUNT        TO ACCT-KEY.
  2086     GO TO 1005-READ-ACCT.
  2087
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL113.cbl
  2089
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL113.cbl
  2091 6100-BUILD-KEY.
  2092     MOVE LOW-VALUES             TO ACCT-KEY.
  2093     MOVE PI-COMPANY-CD          TO ACCT-CO.
  2094
  2095     IF ACARIERI = SPACES OR LOW-VALUES
  2096         MOVE SPACES             TO ACCT-CARRIER
  2097     ELSE
  2098         MOVE AL-UANON           TO ACARIERA
  2099         MOVE ACARIERI           TO ACCT-CARRIER.
  2100
  2101     IF AGROUPI = SPACES OR LOW-VALUES
  2102         MOVE SPACES             TO ACCT-GROUPING
  2103     ELSE
  2104         MOVE AL-UANON           TO AGROUPA
  2105         MOVE AGROUPI            TO ACCT-GROUPING.
  2106
  2107     IF ASTATEI = SPACES OR LOW-VALUES
  2108         MOVE SPACES             TO ACCT-STATE
  2109     ELSE
  2110         MOVE AL-UANON           TO ASTATEA
  2111         MOVE ASTATEI            TO ACCT-STATE.
  2112
  2113     IF AACCTI = SPACES OR LOW-VALUES
  2114         MOVE E471               TO EMI-ERROR
  2115         MOVE -1                 TO AACCTL
  2116         PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT
  2117     ELSE
  2118         MOVE AL-UANON           TO AACCTA
  2119         MOVE AACCTI             TO ACCT-ACCOUNT.
  2120
  2121     IF ACCT-STATE = SPACES AND
  2122        (ST-ACCNT-CNTL         OR
  2123         CARR-ST-ACCNT-CNTL    OR
  2124         CARR-GROUP-ST-ACCNT-CNTL)
  2125        MOVE E144                TO EMI-ERROR
  2126        MOVE -1                  TO ASTATEL
  2127        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  2128
  2129     IF ACCT-CARRIER = SPACES AND
  2130        (CARR-ACCNT-CNTL       OR
  2131         CARR-ST-ACCNT-CNTL    OR
  2132         CARR-GROUP-ST-ACCNT-CNTL)
  2133        MOVE E193                TO EMI-ERROR
  2134        MOVE -1                  TO ACARIERL
  2135        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  2136
  2137     IF ACCT-GROUPING = SPACES AND
  2138         CARR-GROUP-ST-ACCNT-CNTL
  2139        MOVE E195                TO EMI-ERROR
  2140        MOVE -1                  TO AGROUPL
  2141        PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  2142
  2143     IF AEXPDTL = ZEROS
  2144        GO TO 6150-CHECK-ERRORS.
  2145
  2146     MOVE AEXPDTI                TO DEEDIT-FIELD.
  2147     PERFORM 8600-DEEDIT.
  2148     IF DEEDIT-FIELD-V0 NOT LESS 999999
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL113.cbl
  2149        MOVE DEEDIT-FIELD-V0     TO AEXPDTO
  2150*       TRANSFORM AEXPDTI FROM SPACES TO '/'
  2151        INSPECT AEXPDTI REPLACING ALL ' ' BY '/'
  2152        MOVE HIGH-VALUES         TO EXPDTE-SAVE
  2153                                    ACCT-EXP-DT
  2154        GO TO 6150-CHECK-ERRORS.
  2155
  2156     MOVE DEEDIT-FIELD-V0        TO DC-GREG-DATE-1-MDY.
  2157     MOVE '4'                    TO DC-OPTION-CODE.
  2158     PERFORM 9700-DATE-LINK.
  2159     IF DATE-CONVERSION-ERROR
  2160        MOVE E454                TO EMI-ERROR
  2161        MOVE -1                  TO AEXPDTL
  2162        MOVE AL-UABON            TO AEXPDTA
  2163        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2164     ELSE
  2165        MOVE AL-UANON            TO AEXPDTA
  2166        MOVE DC-GREG-DATE-1-EDIT TO AEXPDTI
  2167        MOVE AL-UANON            TO AEXPDTA
  2168        MOVE DC-BIN-DATE-1       TO EXPDTE-SAVE
  2169                                    ACCT-EXP-DT.
  2170
  2171 6150-CHECK-ERRORS.
  2172     IF NOT EMI-NO-ERRORS
  2173        GO TO 8200-SEND-DATAONLY.
  2174
  2175     IF ACCT-CARRIER  = SPACES  OR
  2176        ACCT-STATE    = SPACES  OR
  2177        ACCT-GROUPING = SPACES
  2178        MOVE ACCT-VG-ID          TO ACCT-ID.
  2179
  2180 6199-EXIT.
  2181     EXIT.
  2182
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL113.cbl
  2184 7000-BUILD-OUTPUT-MAP.
  2185     MOVE AL-UANON               TO ACARIERA
  2186                                    AGROUPA
  2187                                    ASTATEA
  2188                                    AACCTA
  2189                                    AEXPDTA.
  2190     MOVE AM-CARRIER             TO ACARIERO.
  2191     MOVE AM-GROUPING            TO AGROUPO.
  2192     MOVE AM-STATE               TO ASTATEO.
  2193     MOVE AM-ACCOUNT             TO AACCTO.
  2194
  2195     IF AM-EXPIRATION-DT = HIGH-VALUES
  2196        MOVE 999999              TO AEXPDTO
  2197*       TRANSFORM AEXPDTI FROM SPACES TO '/'
  2198        INSPECT AEXPDTI REPLACING ALL ' ' BY '/'
  2199       ELSE
  2200        MOVE AM-EXPIRATION-DT       TO DC-BIN-DATE-1
  2201        MOVE SPACE                  TO DC-OPTION-CODE
  2202        PERFORM 9700-DATE-LINK
  2203        IF DATE-CONVERSION-ERROR
  2204            MOVE SPACES             TO AEXPDTI
  2205           ELSE
  2206            MOVE DC-GREG-DATE-1-EDIT TO AEXPDTI.
  2207
  2208     MOVE AM-EFFECTIVE-DT        TO DC-BIN-DATE-1.
  2209     MOVE SPACE                  TO DC-OPTION-CODE.
  2210     PERFORM 9700-DATE-LINK.
  2211     IF DATE-CONVERSION-ERROR
  2212         MOVE SPACES             TO AEFFDTI
  2213        ELSE
  2214         MOVE DC-GREG-DATE-1-EDIT TO AEFFDTI.
  2215
  2216     MOVE AM-NAME                TO ANAMEO.
  2217     MOVE AM-PERSON              TO ACAREOFO.
  2218     MOVE AM-ADDRS               TO AADDR1O.
  2219*    MOVE AM-CITY                TO ACITYSTO.
  2220     STRING AM-ADDR-CITY ' ' AM-ADDR-STATE
  2221        DELIMITED BY '  ' INTO ACITYSTO
  2222     END-STRING
  2223     MOVE AM-TEL-NO              TO WS-WORK-PHONE.
  2224*    TRANSFORM WS-WORK-PHONE FROM SPACES TO '0'.
  2225     INSPECT WS-WORK-PHONE REPLACING ALL ' ' BY '0'.
  2226     MOVE WS-NUMERIC-PHONE       TO APHONEO.
  2227*    TRANSFORM APHONEI FROM SPACES TO '-'.
  2228     INSPECT APHONEI REPLACING ALL ' ' BY '/'
  2229
  2230     IF  AM-CANADIAN-POST-CODE
  2231         MOVE AM-CAN-POSTAL-1    TO WS-CAN-POSTAL-CD-1
  2232         MOVE AM-CAN-POSTAL-2    TO WS-CAN-POSTAL-CD-2
  2233         MOVE SPACES             TO WS-DASH-CAN
  2234*                                TO WS-CAN-FILLER
  2235                                    WS-CAN-FILLER
  2236         MOVE WS-CANADIAN-POSTAL-CODES
  2237                                 TO AZIPO
  2238
  2239     ELSE
  2240         MOVE AM-ZIP-PRIME       TO WS-ZIP-CODE
  2241
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL113.cbl
  2242         IF  AM-ZIP-PLUS4 = SPACES OR ZEROS
  2243             MOVE SPACES         TO WS-ZIP-PLUS4
  2244                                    WS-DASH
  2245             MOVE WS-ZIP         TO AZIPO
  2246
  2247         ELSE
  2248             MOVE AM-ZIP-PLUS4   TO WS-ZIP-PLUS4
  2249             MOVE '-'            TO WS-DASH
  2250             MOVE WS-ZIP         TO AZIPO.
  2251
  2252     MOVE AM-EARN-METHOD-A       TO ADECAHO.
  2253     MOVE AM-EARN-METHOD-L       TO ALIFLEVO.
  2254     MOVE AM-EARN-METHOD-R       TO ADECLIFO.
  2255     MOVE AM-TOL-CLM             TO AALLOWO.
  2256
  2257     MOVE -1 TO AMAINTL.
  2258     IF BROWSE-STARTED
  2259        MOVE SPACE               TO BROWSE-STARTED-SW
  2260
  2261* EXEC CICS ENDBR
  2262*            DATASET(ACCT-ID)
  2263*       END-EXEC.
  2264     MOVE 0
  2265       TO DFHEIV11
  2266*    MOVE '&2                    $   #00002086' TO DFHEIV0
  2267     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2268     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2269     MOVE X'2020233030303032303836' TO DFHEIV0(25:11)
  2270     CALL 'kxdfhei1' USING DFHEIV0,
  2271           ACCT-ID,
  2272           DFHEIV11,
  2273           DFHEIV99
  2274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2275
  2276
  2277     GO TO 8100-SEND-INITIAL-MAP.
  2278
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL113.cbl
  2280 8100-SEND-INITIAL-MAP.
  2281     MOVE SAVE-DATE    TO ADATEO.
  2282     MOVE EIBTIME      TO TIME-IN.
  2283     MOVE TIME-OUT     TO ATIMEO.
  2284     MOVE -1           TO AMAINTL.
  2285     MOVE EMI-MESSAGE-AREA (1) TO AEMSG1O.
  2286     MOVE EMI-MESSAGE-AREA (2) TO AEMSG2O.
  2287
  2288* EXEC CICS SEND
  2289*        MAP   (MAP-NAME)
  2290*        MAPSET(MAPSET-NAME)
  2291*        FROM  (EL113AO)
  2292*        ERASE
  2293*        CURSOR
  2294*    END-EXEC.
  2295     MOVE LENGTH OF
  2296      EL113AO
  2297       TO DFHEIV12
  2298     MOVE -1
  2299       TO DFHEIV11
  2300*    MOVE '8$     CT  E    H L F ,   #00002100' TO DFHEIV0
  2301     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2302     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2303     MOVE X'2020233030303032313030' TO DFHEIV0(25:11)
  2304     CALL 'kxdfhei1' USING DFHEIV0,
  2305           MAP-NAME,
  2306           EL113AO,
  2307           DFHEIV12,
  2308           MAPSET-NAME,
  2309           DFHEIV99,
  2310           DFHEIV99,
  2311           DFHEIV99,
  2312           DFHEIV11,
  2313           DFHEIV99,
  2314           DFHEIV99,
  2315           DFHEIV99
  2316     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2317
  2318
  2319     GO TO 9100-RETURN-TRAN.
  2320
  2321 8200-SEND-DATAONLY.
  2322     MOVE SAVE-DATE    TO ADATEO.
  2323     MOVE EIBTIME TO TIME-IN.
  2324     MOVE TIME-OUT TO ATIMEO.
  2325     MOVE EMI-MESSAGE-AREA (1) TO AEMSG1O.
  2326     MOVE EMI-MESSAGE-AREA (2) TO AEMSG2O.
  2327
  2328
  2329* EXEC CICS SEND
  2330*        MAP   (MAP-NAME)
  2331*        MAPSET(MAPSET-NAME)
  2332*        FROM  (EL113AO)
  2333*        DATAONLY
  2334*        CURSOR
  2335*    END-EXEC.
  2336     MOVE LENGTH OF
  2337      EL113AO
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL113.cbl
  2338       TO DFHEIV12
  2339     MOVE -1
  2340       TO DFHEIV11
  2341*    MOVE '8$D    CT       H L F ,   #00002117' TO DFHEIV0
  2342     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2343     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2344     MOVE X'2020233030303032313137' TO DFHEIV0(25:11)
  2345     CALL 'kxdfhei1' USING DFHEIV0,
  2346           MAP-NAME,
  2347           EL113AO,
  2348           DFHEIV12,
  2349           MAPSET-NAME,
  2350           DFHEIV99,
  2351           DFHEIV99,
  2352           DFHEIV99,
  2353           DFHEIV11,
  2354           DFHEIV99,
  2355           DFHEIV99,
  2356           DFHEIV99
  2357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2358
  2359
  2360     GO TO 9100-RETURN-TRAN.
  2361
  2362 8300-SEND-TEXT.
  2363
  2364* EXEC CICS SEND TEXT
  2365*        FROM  (LOGOFF-TEXT)
  2366*        LENGTH(LOGOFF-LENGTH)
  2367*        ERASE
  2368*        FREEKB
  2369*    END-EXEC.
  2370*    MOVE '8&      T  E F  H   F -   #00002128' TO DFHEIV0
  2371     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2372     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2373     MOVE X'2020233030303032313238' TO DFHEIV0(25:11)
  2374     CALL 'kxdfhei1' USING DFHEIV0,
  2375           LOGOFF-TEXT,
  2376           LOGOFF-LENGTH,
  2377           DFHEIV99,
  2378           DFHEIV99,
  2379           DFHEIV99,
  2380           DFHEIV99,
  2381           DFHEIV99,
  2382           DFHEIV99,
  2383           DFHEIV99,
  2384           DFHEIV99,
  2385           DFHEIV99,
  2386           DFHEIV99
  2387     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2388
  2389
  2390
  2391* EXEC CICS RETURN
  2392*    END-EXEC.
  2393*    MOVE '.(                    &   #00002135' TO DFHEIV0
  2394     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2395     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL113.cbl
  2396     MOVE X'2020233030303032313335' TO DFHEIV0(25:11)
  2397     CALL 'kxdfhei1' USING DFHEIV0,
  2398           DFHEIV99,
  2399           DFHEIV99,
  2400           DFHEIV99,
  2401           DFHEIV99,
  2402           DFHEIV99
  2403     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2404
  2405
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL113.cbl
  2407 8400-LOG-JOURNAL-RECORD.
  2408     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
  2409     MOVE ACCT-ID                TO JP-FILE-ID.
  2410     MOVE PGM-EL113              TO JP-PROGRAM-ID.
  2411*    EXEC CICS JOURNAL
  2412*         JFILEID(PI-JOURNAL-FILE-ID)
  2413*         JTYPEID('CL')
  2414*         FROM   (JOURNAL-RECORD)
  2415*         LENGTH (273)
  2416*    END-EXEC.
  2417
  2418
  2419 8600-DEEDIT.
  2420
  2421* EXEC CICS BIF DEEDIT
  2422*         FIELD (DEEDIT-FIELD)
  2423*         LENGTH(15)
  2424*    END-EXEC.
  2425     MOVE 15
  2426       TO DFHEIV11
  2427*    MOVE '@"L                   #   #00002152' TO DFHEIV0
  2428     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2429     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2430     MOVE X'2020233030303032313532' TO DFHEIV0(25:11)
  2431     CALL 'kxdfhei1' USING DFHEIV0,
  2432           DEEDIT-FIELD,
  2433           DFHEIV11
  2434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2435
  2436
  2437 8800-UNAUTHORIZED-ACCESS.
  2438     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  2439     GO TO 8300-SEND-TEXT.
  2440
  2441 8810-PF23.
  2442     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  2443     MOVE XCTL-005               TO PGM-NAME.
  2444     GO TO 9300-XCTL.
  2445
  2446 8850-DUPREC.
  2447     MOVE 0147                   TO EMI-ERROR.
  2448     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2449     MOVE -1                     TO AACCTL.
  2450     MOVE AL-UABON               TO AACCTA.
  2451     GO TO 8200-SEND-DATAONLY.
  2452
  2453 8870-CNTL-NOTOPEN.
  2454     MOVE E042                   TO EMI-ERROR.
  2455     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2456     MOVE -1                     TO AMAINTL.
  2457     GO TO 8200-SEND-DATAONLY.
  2458
  2459 8880-ACCT-NOTOPEN.
  2460     MOVE E168                   TO EMI-ERROR.
  2461     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2462     MOVE -1                     TO AMAINTL.
  2463     GO TO 8200-SEND-DATAONLY.
  2464
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL113.cbl
  2465 9000-RETURN-CICS.
  2466
  2467* EXEC CICS RETURN
  2468*    END-EXEC.
  2469*    MOVE '.(                    &   #00002186' TO DFHEIV0
  2470     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2471     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2472     MOVE X'2020233030303032313836' TO DFHEIV0(25:11)
  2473     CALL 'kxdfhei1' USING DFHEIV0,
  2474           DFHEIV99,
  2475           DFHEIV99,
  2476           DFHEIV99,
  2477           DFHEIV99,
  2478           DFHEIV99
  2479     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2480
  2481
  2482 9100-RETURN-TRAN.
  2483     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  2484     MOVE '106A' TO PI-CURRENT-SCREEN-NO.
  2485
  2486* EXEC CICS RETURN
  2487*        TRANSID(TRANS-ID)
  2488*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  2489*        LENGTH(PI-COMM-LENGTH)
  2490*    END-EXEC.
  2491*    MOVE '.(CT                  &   #00002192' TO DFHEIV0
  2492     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2493     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2494     MOVE X'2020233030303032313932' TO DFHEIV0(25:11)
  2495     CALL 'kxdfhei1' USING DFHEIV0,
  2496           TRANS-ID,
  2497           PROGRAM-INTERFACE-BLOCK,
  2498           PI-COMM-LENGTH,
  2499           DFHEIV99,
  2500           DFHEIV99
  2501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2502
  2503
  2504 9200-RETURN-MAIN-MENU.
  2505     MOVE XCTL-126 TO PGM-NAME.
  2506     GO TO 9300-XCTL.
  2507
  2508 9300-XCTL.
  2509
  2510* EXEC CICS XCTL
  2511*        PROGRAM(PGM-NAME)
  2512*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  2513*        LENGTH(PI-COMM-LENGTH)
  2514*    END-EXEC.
  2515*    MOVE '.$C                   $   #00002203' TO DFHEIV0
  2516     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2517     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2518     MOVE X'2020233030303032323033' TO DFHEIV0(25:11)
  2519     CALL 'kxdfhei1' USING DFHEIV0,
  2520           PGM-NAME,
  2521           PROGRAM-INTERFACE-BLOCK,
  2522           PI-COMM-LENGTH
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL113.cbl
  2523     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2524
  2525
  2526 9400-CLEAR.
  2527     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  2528     GO TO 9300-XCTL.
  2529
  2530 9500-PF12.
  2531     MOVE XCTL-010 TO PGM-NAME.
  2532     GO TO 9300-XCTL.
  2533
  2534 9700-DATE-LINK.
  2535     MOVE LINK-CLDATCV           TO PGM-NAME
  2536
  2537* EXEC CICS LINK
  2538*        PROGRAM   (PGM-NAME)
  2539*        COMMAREA  (DATE-CONVERSION-DATA)
  2540*        LENGTH    (DC-COMM-LENGTH)
  2541*    END-EXEC.
  2542*    MOVE '."C                   ''   #00002219' TO DFHEIV0
  2543     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2544     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2545     MOVE X'2020233030303032323139' TO DFHEIV0(25:11)
  2546     CALL 'kxdfhei1' USING DFHEIV0,
  2547           PGM-NAME,
  2548           DATE-CONVERSION-DATA,
  2549           DC-COMM-LENGTH,
  2550           DFHEIV99,
  2551           DFHEIV99,
  2552           DFHEIV99
  2553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2554
  2555
  2556 9600-PGMID-ERROR.
  2557
  2558* EXEC CICS HANDLE CONDITION
  2559*        PGMIDERR(8300-SEND-TEXT)
  2560*    END-EXEC.
  2561*    MOVE '"$L                   ! & #00002226' TO DFHEIV0
  2562     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2563     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2564     MOVE X'2620233030303032323236' TO DFHEIV0(25:11)
  2565     CALL 'kxdfhei1' USING DFHEIV0
  2566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2567
  2568
  2569     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  2570     MOVE ' '          TO PI-ENTRY-CD-1.
  2571     MOVE XCTL-005     TO PGM-NAME.
  2572     MOVE PGM-NAME     TO LOGOFF-PGM.
  2573     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  2574     GO TO 9300-XCTL.
  2575
  2576 9900-ERROR-FORMAT.
  2577     IF NOT EMI-ERRORS-COMPLETE
  2578         MOVE LINK-001 TO PGM-NAME
  2579
  2580* EXEC CICS LINK
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL113.cbl
  2581*            PROGRAM(PGM-NAME)
  2582*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  2583*            LENGTH(EMI-COMM-LENGTH)
  2584*        END-EXEC.
  2585*    MOVE '."C                   ''   #00002240' TO DFHEIV0
  2586     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2587     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2588     MOVE X'2020233030303032323430' TO DFHEIV0(25:11)
  2589     CALL 'kxdfhei1' USING DFHEIV0,
  2590           PGM-NAME,
  2591           ERROR-MESSAGE-INTERFACE-BLOCK,
  2592           EMI-COMM-LENGTH,
  2593           DFHEIV99,
  2594           DFHEIV99,
  2595           DFHEIV99
  2596     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2597
  2598
  2599 9900-EXIT.
  2600     EXIT.
  2601
  2602 9990-ABEND.
  2603     MOVE LINK-004 TO PGM-NAME.
  2604     MOVE DFHEIBLK TO EMI-LINE1.
  2605
  2606* EXEC CICS LINK
  2607*        PROGRAM  (PGM-NAME)
  2608*        COMMAREA (EMI-LINE1)
  2609*        LENGTH   (72)
  2610*    END-EXEC.
  2611     MOVE 72
  2612       TO DFHEIV11
  2613*    MOVE '."C                   ''   #00002252' TO DFHEIV0
  2614     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2615     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2616     MOVE X'2020233030303032323532' TO DFHEIV0(25:11)
  2617     CALL 'kxdfhei1' USING DFHEIV0,
  2618           PGM-NAME,
  2619           EMI-LINE1,
  2620           DFHEIV11,
  2621           DFHEIV99,
  2622           DFHEIV99,
  2623           DFHEIV99
  2624     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2625
  2626
  2627     GO TO 8200-SEND-DATAONLY.
  2628
  2629* GOBACK.
  2630     MOVE '9%                    "   ' TO DFHEIV0
  2631     MOVE 'EL113' TO DFHEIV1
  2632     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2633     GOBACK.
  2634
  2635 9999-DFHBACK SECTION.
  2636     MOVE '9%                    "   ' TO DFHEIV0
  2637     MOVE 'EL113' TO DFHEIV1
  2638     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL113.cbl
  2639     GOBACK.
  2640 9999-DFHEXIT.
  2641     IF DFHEIGDJ EQUAL 0001
  2642         NEXT SENTENCE
  2643     ELSE IF DFHEIGDJ EQUAL 2
  2644         GO TO 9600-PGMID-ERROR,
  2645               9990-ABEND
  2646         DEPENDING ON DFHEIGDI
  2647     ELSE IF DFHEIGDJ EQUAL 3
  2648         GO TO 1010-NOT-FOUND
  2649         DEPENDING ON DFHEIGDI
  2650     ELSE IF DFHEIGDJ EQUAL 4
  2651         GO TO 5030-NOT-FOUND,
  2652               5030-NOT-FOUND
  2653         DEPENDING ON DFHEIGDI
  2654     ELSE IF DFHEIGDJ EQUAL 5
  2655         GO TO 5130-NOT-FOUND,
  2656               5130-NOT-FOUND
  2657         DEPENDING ON DFHEIGDI
  2658     ELSE IF DFHEIGDJ EQUAL 6
  2659         GO TO 8300-SEND-TEXT
  2660         DEPENDING ON DFHEIGDI.
  2661     MOVE '9%                    "   ' TO DFHEIV0
  2662     MOVE 'EL113' TO DFHEIV1
  2663     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2664     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5836     Code:        6383
