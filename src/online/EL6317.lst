* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   1
* EL6317.cbl
* Options: int("EL6317.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6317.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6317.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6317.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6317.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CNETRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   2
* EL6317.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24*          2011022800001  PEMA  NEW PROGRAM
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 071712 CR2011022800001  AJRA  NAPERSOFT CANCELS
    28* 072312   2011022800001  AJRA  NAPERSOFT MISC
    29* 100412   2011022800001  AJRA  POST IMPLEMENTATION ITEMS
    30* 102212   2012101700002  AJRA  SCREEN ID
    31* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    32* 110612   2012101700002  AJRA  ADD NEW FIELDS
    33* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    34* 121112   2012101700002  AJRA  CHANGE PF KEYS
    35* 121212   2012101700002  AJRA  ADD BILLING NOTE ENTRY
    36* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    37* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    38* 120313   2013090300001  AJRA  NAPERSOFT PHASE 2
    39* 121713   2013090300001  AJRA  ADD ENCLOSURE CODE TO SCREEN
    40* 041320 CR2020030500002  PEMA  Issue, cancel billing notes
    41*-----------------------------------------------------------------
    42*REMARKS.
    43*        TRANSACTION - EXBD - CERTIFICATE VERIFICATION
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   3
* EL6317.cbl
    45 ENVIRONMENT DIVISION.
    46 DATA DIVISION.
    47 WORKING-STORAGE SECTION.
    48 01  DFH-START PIC X(04).
    49 77  FILLER  PIC X(32)  VALUE '********************************'.
    50 77  FILLER  PIC X(32)  VALUE '*    EL6317 WORKING STORAGE    *'.
    51 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    52 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    53 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    54 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    55 77  s1                          pic s999 comp-3 value +0.
    56 77  s2                          pic s999 comp-3 value +0.
    57 77  W-ARCH-NUMBER               PIC S9(08)      COMP value +0.
    58 77  WS-REASON-SW                PIC X  VALUE ' '.
    59     88  REASONS-FOUND                  VALUE 'Y'.
    60     88  REASONS-NOT-FOUND              VALUE 'N'.
    61 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    62     88  NO-CERT-RW                 VALUE 'N'.
    63     88  CERT-RW                    VALUE 'Y'.
    64 01  P pointer.
    65 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    66 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    67 01  var-ptr pointer.
    68 01  env-var-len                 pic 9(4)  binary.
    69 01  rc                          pic 9(9)  binary.
    70 01  WS-KIXHOST                  PIC X(10).
    71 01  WS-KIXSYS.
    72     05  WS-KIX-FIL1             PIC X(10).
    73     05  WS-KIX-APPS             PIC X(10).
    74     05  WS-KIX-ENV              PIC X(10).
    75     05  WS-KIX-MYENV            PIC X(10).
    76     05  WS-KIX-SYS              PIC X(10).
    77*                                COPY ELCSCTM.
    78******************************************************************
    79*                                                                *
    80*                                                                *
    81*                            ELCSCTM                             *
    82*                            VMOD=2.001                          *
    83*                                                                *
    84*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    85*                                                                *
    86******************************************************************
    87 01  SECURITY-MESSAGE.
    88     12  FILLER                          PIC X(30)
    89            VALUE '** LOGIC SECURITY VIOLATION -'.
    90     12  SM-READ                         PIC X(6).
    91     12  FILLER                          PIC X(5)
    92            VALUE ' PGM='.
    93     12  SM-PGM                          PIC X(6).
    94     12  FILLER                          PIC X(5)
    95            VALUE ' OPR='.
    96     12  SM-PROCESSOR-ID                 PIC X(4).
    97     12  FILLER                          PIC X(6)
    98            VALUE ' TERM='.
    99     12  SM-TERMID                       PIC X(4).
   100     12  FILLER                          PIC XX   VALUE SPACE.
   101     12  SM-JUL-DATE                     PIC 9(5).
   102     12  FILLER                          PIC X    VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   4
* EL6317.cbl
   103     12  SM-TIME                         PIC 99.99.
   104
   105*                                COPY ELCSCRTY.
   106******************************************************************
   107*                                                                *
   108*                                                                *
   109*                            ELCSCRTY                            *
   110*                            VMOD=2.001                          *
   111*                                                                *
   112*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   113*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   114*        SAVED IN PI-SECURITY-ADDRESS.                           *
   115*                                                                *
   116******************************************************************
   117 01  SECURITY-CONTROL.
   118     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   119     12  FILLER                       PIC XX    VALUE 'SC'.
   120     12  SC-CREDIT-CODES.
   121         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   122             20  SC-CREDIT-DISPLAY    PIC X.
   123             20  SC-CREDIT-UPDATE     PIC X.
   124     12  SC-CLAIMS-CODES.
   125         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   126             20  SC-CLAIMS-DISPLAY    PIC X.
   127             20  SC-CLAIMS-UPDATE     PIC X.
   128 01 srch-commarea.
   129*                                copy ELCADLTRSPI.
   130******************************************************************
   131*                   C H A N G E   L O G
   132*
   133* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   134*-----------------------------------------------------------------
   135*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   136* EFFECTIVE    NUMBER
   137*-----------------------------------------------------------------
   138* 060611    2011022800001  PEMA  NEW COPYBOOK
   139* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   140* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   141******************************************************************
   142****************************************
   143*  commarea for NaperSoft On Demand Admin services letters
   144*  (business logic input & output)
   145****************************************
   146     03  BL-INPUT.
   147         05  BL-DATA-SRCE        PIC X.
   148         05  BL-LETTER-ID        PIC XXXX.
   149         05  BL-CARRIER          PIC X.
   150         05  BL-GROUP            PIC X(6).
   151         05  BL-STATE            PIC XX.
   152         05  BL-ACCOUNT          PIC X(10).
   153         05  BL-EFF-DT           PIC X(10).
   154         05  BL-CERT-NO          PIC X(11).
   155         05  BL-BATCH-NO         PIC X(6).
   156         05  BL-BATCH-SEQ        PIC 9(8).
   157         05  BL-RESP-NO          PIC X(10).
   158         05  BL-NO-OF-COPIES     PIC 99.
   159         05  BL-PROC-ID          PIC XXXX.
   160         05  BL-COMP-ID          PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   5
* EL6317.cbl
   161         05  BL-PRINT-NOW-SW     PIC X.
   162         05  BL-ENC-CD           PIC XXX.
   163         05  BL-RESEND-DT        PIC X(10).
   164         05  BL-FOLLOW-UP-DT     PIC X(10).
   165         05  BL-ARCHIVE-NO       PIC 9(8).
   166         05  BL-FUNC             PIC X(8).
   167         05  BL-COMMENTS         PIC X(100).
   168         05  FILLER REDEFINES BL-COMMENTS.
   169             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   170             10  BL-LETTER-TO-ACCT PIC X.
   171             10  BL-LETTER-TO-BENE PIC X.
   172             10  BL-WRITE-ERARCH   PIC X.
   173                 88  ERARCH-QWS      VALUE 'Q'.
   174                 88  ERARCH-BATCH    VALUE 'B'.
   175                 88  ERARCH-TEMP     VALUE 'T'.
   176             10  BL-PROCESS-TYPE PIC X(07).
   177             10  BL-CERT-FORM-ID PIC X(05).
   178             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   179             10  BL-SOURCE-SCREEN PIC X(8).
   180             10  FILLER          PIC X(25).
   181     03  BL-OUTPUT.
   182         05  BL-STATUS                   PIC X.
   183             88  BL-OK                      VALUE "P".
   184             88  BL-FAIL                  VALUE "F".
   185         05  BL-MESSAGE          PIC X(50).
   186     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   187     03  FILLER                  PIC X(31).
   188
   189*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   190*                                COPY ELCZREC.
   191******************************************************************
   192*                                                                *
   193*                                                                *
   194*                            ELCZREC.                            *
   195*                                                                *
   196*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   197*                                                                *
   198******************************************************************
   199*-----------------------------------------------------------------
   200*                   C H A N G E   L O G
   201*
   202* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   203*-----------------------------------------------------------------
   204*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   205* EFFECTIVE    NUMBER
   206*-----------------------------------------------------------------
   207* 122011    2011022800001  AJRA  NEW FILE
   208* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
   209* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   210* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   211* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   212*-----------------------------------------------------------------
   213 01  W-Z-CONTROL-DATA.
   214     05  W-NUMBER-OF-COPIES      PIC  9.
   215     05  FILLER                  PIC  X.
   216     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   217     05  FILLER                  PIC  X.
   218     05  W-DAYS-TO-RESEND        PIC  999.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   6
* EL6317.cbl
   219     05  FILLER                  PIC  X.
   220     05  W-FORM-TO-RESEND        PIC  X(4).
   221     05  W-ADD-BAR-CODE          PIC  X.
   222     05  W-PROMPT-LETTER         PIC  X.
   223     05  W-HAS-RETURN-ENV        PIC  X.
   224     05  W-ENCLOSURE-CD          PIC  XXX.
   225     05  W-SIG-FLAG-DEFAULT      PIC  X.
   226     05  W-AUTO-CLOSE-IND        PIC  X.
   227     05  FILLER                  PIC  X.
   228     05  W-LETTER-TO-BENE        PIC  X.
   229     05  FILLER                  PIC  X.
   230     05  W-LETTER-TO-ACCT        PIC  X.
   231     05  FILLER                  PIC  X.
   232     05  W-LETTER-TYPE           PIC  X.
   233     05  FILLER                  PIC  X.
   234     05  W-PRINT-CERTIFICATE     PIC  X.
   235     05  FILLER                  PIC  X.
   236     05  W-REFUND-REQUIRED       PIC  X.
   237     05  FILLER                  PIC  X.
   238     05  W-ONBASE-CODE           PIC  XX.
   239     05  FILLER                  PIC  X.
   240     05  W-ACCT-SUMM             PIC  X.
   241     05  FILLER                  PIC  X.
   242     05  W-CSO-SUMM              PIC  X.
   243     05  FILLER                  PIC  X.
   244     05  W-REASONS-REQUIRED      PIC  X.
   245     05  FILLER                  PIC  X(29).
   246 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   247 01  STANDARD-AREAS.
   248     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   249     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   250                                 PIC  X(08).
   251     12  W-ARCH-LENGTH           PIC S9(04)  COMP  VALUE +250.
   252     12  QID.
   253         16  QID-TERM        PIC X(4)    VALUE SPACES.
   254         16  FILLER          PIC X(4)    VALUE '631J'.
   255     12  MAP-LENGTH          PIC 9(4)   VALUE 359 BINARY.
   256     12  TIME-MT                 PIC S9(7).
   257     12  TIME-MT-R  REDEFINES TIME-MT.
   258         16  FILLER              PIC X.
   259         16  TIME-LMT            PIC 99V99.
   260         16  FILLER              PIC X(2).
   261     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   262     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   263     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   264     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   265     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   266     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   267     12  ELENCC-LENGTH           PIC S9(04) VALUE +400 COMP.
   268     12  W-CNTL-KEY.
   269         16  W-CNTL-COMPANY-ID   PIC  X(03).
   270         16  W-CNTL-RECORD-TYPE  PIC  X(01)   VALUE '1'.
   271         16  W-CNTL-GENL.
   272             20  W-CNTL-GEN1     PIC  X(02)   VALUE SPACES.
   273             20  W-CNTL-GEN2.
   274                 24 W-CNTL-GEN3  PIC  X(01)   VALUE SPACES.
   275                 24 W-CNTL-GEN4  PIC  X(01)   VALUE SPACES.
   276         16  W-CNTL-SEQ-NO       PIC S9(04)   VALUE +0    COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   7
* EL6317.cbl
   277     12  WS-ELCERT-KEY.
   278         16  W-CERT-COMPANY-CD   PIC X.
   279         16  W-CERT-CARRIER      PIC X.
   280         16  W-CERT-GROUPING     PIC X(6).
   281         16  W-CERT-STATE        PIC XX.
   282         16  W-CERT-ACCOUNT      PIC X(10).
   283         16  W-CERT-CERT-EFF-DT  PIC XX.
   284         16  W-CERT-CERT-PRIME   PIC X(10).
   285         16  W-CERT-CERT-SFX     PIC X.
   286
   287     12  WS-ELCRTT-KEY.
   288         16  WS-ELCRTT-PRIMARY   PIC X(33).
   289         16  WS-ELCRTT-REC-TYPE  PIC X(1).
   290     12  ELCRTT-RECORD-LENGTH    PIC S9(4) COMP VALUE +552.
   291     12  ELCRTT-JOURNAL-LENGTH   PIC S9(4) COMP VALUE +575.
   292
   293     12  WS-ELEOBC-KEY.
   294         16  WS-EOBC-COMPANY-CD  PIC X.
   295         16  WS-EOBC-REC-TYPE    PIC X.
   296         16  WS-EOBC-CODE        PIC X(4).
   297         16  FILLER              PIC X(9).
   298     12  WS-ERNOTE-KEY.
   299         16  W-NOTE-COMPANY-CD   PIC X.
   300         16  W-NOTE-CARRIER      PIC X.
   301         16  W-NOTE-GROUPING     PIC X(6).
   302         16  W-NOTE-STATE        PIC XX.
   303         16  W-NOTE-ACCOUNT      PIC X(10).
   304         16  W-NOTE-CERT-EFF-DT  PIC XX.
   305         16  W-NOTE-CERT-PRIME   PIC X(10).
   306         16  W-NOTE-CERT-SFX     PIC X.
   307         16  w-note-record-type  pic x.
   308     12  ELLETR-KEY.
   309         16  LETR-PART-KEY.
   310             20  LETR-COMPANY-CD PIC X.
   311             20  LETR-LETTER-ID  PIC X(4).
   312         16  LETR-FILLER         PIC X(8).
   313         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   314     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   315     12  ERPNDB2-KEY.
   316         16  PNDB2-COMPANY-CD    PIC X.
   317         16  PNDB2-CARRIER       PIC X.
   318         16  PNDB2-GROUPING      PIC X(6).
   319         16  PNDB2-STATE         PIC XX.
   320         16  PNDB2-ACCOUNT       PIC X(10).
   321         16  PNDB2-CERT-EFF-DT   PIC XX.
   322         16  PNDB2-CERT-PRIME    PIC X(10).
   323         16  PNDB2-CERT-SFX      PIC X.
   324         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   325         16  PNDB2-RECORD-TYPE   PIC X.
   326     12  ERPNDB-KEY.
   327         16  PNDB-COMPANY-CD     PIC X.
   328         16  PNDB-BATCH-NO       PIC X(6).
   329         16  PNDB-BATCH-SEQ-NO   PIC 9(4) BINARY.
   330         16  PNDB-CHG-SEQ-NO     PIC 9(4) BINARY.
   331     12  ERENDT-KEY.
   332         16  ENDT-COMPANY-CD       PIC X.
   333         16  ENDT-CARRIER          PIC X.
   334         16  ENDT-GROUPING         PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   8
* EL6317.cbl
   335         16  ENDT-STATE            PIC XX.
   336         16  ENDT-ACCOUNT          PIC X(10).
   337         16  ENDT-CERT-EFF-DT      PIC XX.
   338         16  ENDT-CERT-PRIME       PIC X(10).
   339         16  ENDT-CERT-SFX         PIC X.
   340         16  ENDT-RECORD-TYPE      PIC X.
   341         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   342     12  ELCRTO-KEY.
   343         16  CRTO-COMPANY-CD     PIC X.
   344         16  CRTO-CARRIER        PIC X.
   345         16  CRTO-GROUPING       PIC X(6).
   346         16  CRTO-STATE          PIC XX.
   347         16  CRTO-ACCOUNT        PIC X(10).
   348         16  CRTO-CERT-EFF-DT    PIC XX.
   349         16  CRTO-CERT-PRIME     PIC X(10).
   350         16  CRTO-CERT-SFX       PIC X.
   351         16  CRTO-RECORD-TYPE    PIC X.
   352         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   353     12  WS-ERMAIL-KEY.
   354         16  MAIL-COMPANY-CD     PIC X.
   355         16  MAIL-CARRIER        PIC X.
   356         16  MAIL-GROUPING       PIC X(6).
   357         16  MAIL-STATE          PIC XX.
   358         16  MAIL-ACCOUNT        PIC X(10).
   359         16  MAIL-CERT-EFF-DT    PIC XX.
   360         16  MAIL-CERT-PRIME     PIC X(10).
   361         16  MAIL-CERT-SFX       PIC X.
   362
   363     12  WS-ELENCC-KEY.
   364         16  WS-ENCC-COMPANY-CD  PIC X.
   365         16  WS-ENCC-REC-TYPE    PIC X.
   366         16  WS-ENCC-ENC-CODE    PIC X(5).
   367         16  FILLER              PIC X(09).
   368
   369     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   370     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   371     12  WS-CURRENT-DT.
   372         16  FILLER              PIC X(6)    VALUE SPACES.
   373         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   374     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   375     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   376         88  CANCEL-REC            VALUE 'C'.
   377         88  ISSUE-REC             VALUE 'I'.
   378     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   379     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   380     12  ELCNTL-KEY.
   381         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   382         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   383         16  CNTL-ACCESS.
   384             20  CNTL-STATE      PIC XX    VALUE SPACES.
   385             20  FILLER          PIC X     VALUE SPACES.
   386             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   387         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   388     12  ERACCT-KEY.
   389         16  ERACCT-COMP-KEY.
   390             20  ACCT-CO         PIC X     VALUE SPACES.
   391             20  ACCT-CARRIER    PIC X     VALUE SPACES.
   392             20  ACCT-GROUPING   PIC X(6)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page   9
* EL6317.cbl
   393             20  ACCT-STATE      PIC XX    VALUE SPACES.
   394             20  ACCT-ACCOUNT    PIC X(10) VALUE SPACES.
   395         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   396         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   397     12  ERACCT-SAVE-KEY         PIC X(20) VALUE SPACES.
   398     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   399     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   400     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   401     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   402     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   403     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   404     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
   405     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   406     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   407     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   408     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   409     12  WS-ELENCC-FILE-ID       PIC X(8) VALUE 'ELENCC'.
   410     12  WS-RESPONSE             PIC S9(8)   COMP.
   411         88  RESP-NORMAL                  VALUE +00.
   412         88  RESP-NOTFND                  VALUE +13.
   413         88  RESP-DUPREC                  VALUE +14.
   414         88  RESP-DUPKEY                  VALUE +15.
   415         88  RESP-NOTOPEN                 VALUE +19.
   416         88  RESP-ENDFILE                 VALUE +20.
   417     12  MAP-NAME            PIC X(8)    VALUE 'EL631J'.
   418     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6317S'.
   419     12  SCREEN-NUMBER       PIC X(4)    VALUE '631J'.
   420     12  TRANS-ID            PIC X(4)    VALUE 'EXBD'.
   421     12  THIS-PGM            PIC X(8)    VALUE 'EL6317'.
   422     12  PGM-NAME            PIC X(8).
   423     12  TIME-IN             PIC S9(7).
   424     12  TIME-OUT-R  REDEFINES TIME-IN.
   425         16  FILLER          PIC X.
   426         16  TIME-OUT        PIC 99V99.
   427         16  FILLER          PIC X(2).
   428     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   429     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   430     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   431     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   432     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   433     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   434     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   435     12  WS-PHONE.
   436         16  WS-PH1              PIC XXX.
   437         16  WS-PH2              PIC XXX.
   438         16  WS-PH3              PIC XXXX.
   439     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   440     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   441
   442     12  WS-BILLING-NOTE.
   443         16  WS-BN-NOTE          PIC X(25).
   444         16  WS-BN-LTRID         PIC X(4).
   445         16  FILLER              PIC X(3).
   446         16  WS-BN-DATE          PIC X(8).
   447         16  FILLER              PIC X(3).
   448         16  WS-BN-USERID        PIC X(4).
   449         16  FILLER              PIC X(30).
   450     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  10
* EL6317.cbl
   451         16  WS-MAN-BN-NOTE      PIC X(63).
   452         16  FILLER              PIC X(14).
   453     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   454
   455 01  NEW-ELCRTO-REC.
   456     12  NEW-ELCRTO-KEY.
   457         16  NCRTO-COMPANY-CD      PIC X.
   458         16  NCRTO-CARRIER         PIC X.
   459         16  NCRTO-GROUPING        PIC X(6).
   460         16  NCRTO-STATE           PIC XX.
   461         16  NCRTO-ACCOUNT         PIC X(10).
   462         16  NCRTO-CERT-EFF-DT     PIC XX.
   463         16  NCRTO-CERT-PRIME      PIC X(10).
   464         16  NCRTO-CERT-SFX        PIC X.
   465         16  NCRTO-RECORD-TYPE     PIC X.
   466         16  NCRTO-SEQ-NO          PIC 9(4) BINARY.
   467     12  NEW-ORIG-REC.
   468         16  NCRTO-INS-LAST-NAME   PIC X(15).
   469         16  NCRTO-INS-FIRST-NAME  PIC X(10).
   470         16  NCRTO-INS-MIDDLE-INIT PIC X.
   471         16  NCRTO-INS-AGE         PIC S999     COMP-3.
   472         16  NCRTO-JNT-LAST-NAME   PIC X(15).
   473         16  NCRTO-JNT-FIRST-NAME  PIC X(10).
   474         16  NCRTO-JNT-MIDDLE-INIT PIC X.
   475         16  NCRTO-JNT-AGE         PIC S999     COMP-3.
   476         16  NCRTO-LF-BENCD        PIC XX.
   477         16  NCRTO-LF-TERM         PIC S999      COMP-3.
   478         16  NCRTO-LF-BEN-AMT      PIC S9(9)V99  COMP-3.
   479         16  NCRTO-LF-PRM-AMT      PIC S9(7)V99  COMP-3.
   480         16  NCRTO-LF-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
   481         16  NCRTO-LF-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
   482         16  NCRTO-LF-EXP-DT       PIC XX.
   483         16  NCRTO-LF-COMM-PCT     PIC SV9(5)    COMP-3.
   484         16  NCRTO-LF-CANCEL-DT    PIC XX.
   485         16  NCRTO-LF-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   486         16  NCRTO-LF-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   487         16  NCRTO-AH-BENCD        PIC XX.
   488         16  NCRTO-AH-TERM         PIC S999      COMP-3.
   489         16  NCRTO-AH-BEN-AMT      PIC S9(9)V99  COMP-3.
   490         16  NCRTO-AH-PRM-AMT      PIC S9(7)V99  COMP-3.
   491         16  NCRTO-AH-EXP-DT       PIC XX.
   492         16  NCRTO-AH-COMM-PCT     PIC SV9(5)    COMP-3.
   493         16  NCRTO-AH-CP           PIC 99.
   494         16  NCRTO-AH-CANCEL-DT    PIC XX.
   495         16  NCRTO-AH-CANCEL-AMT   PIC S9(7)V99  COMP-3.
   496         16  NCRTO-AH-ITD-CANCEL-AMT PIC S9(7)V99 COMP-3.
   497         16  NCRTO-CRED-BENE-NAME  PIC X(25).
   498         16  NCRTO-1ST-PMT-DT      PIC XX.
   499         16  NCRTO-INS-AGE-DEFAULT-FLAG PIC X.
   500         16  NCRTO-JNT-AGE-DEFAULT-FLAG PIC X.
   501         16  NCRTO-ISSUE-TRAN-IND  PIC X.
   502         16  NCRTO-CANCEL-TRAN-IND PIC X.
   503         16  FILLER                PIC X(235).
   504
   505 01  CERT-NOTE-ENTRIES.
   506     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   507         16  CERT-NT-TEXT                PIC X(63).
   508         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  11
* EL6317.cbl
   509         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   510         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   511
   512 01  ERCNOT-AREA.
   513     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   514     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   515     12  ERCNOT-KEY.
   516         16  ERCNOT-PARTIAL-KEY.
   517             20 ERCNOT-COMPANY-CD    PIC X.
   518             20 ERCNOT-CARRIER       PIC X.
   519             20 ERCNOT-GROUPING      PIC X(06).
   520             20 ERCNOT-STATE         PIC XX.
   521             20 ERCNOT-ACCOUNT       PIC X(10).
   522             20 ERCNOT-EFF-DT        PIC XX.
   523             20 ERCNOT-CERT-NO.
   524                25 ERCNOT-CERT-PRIME PIC X(10).
   525                25 ERCNOT-CERT-SFX   PIC X.
   526             20 ERCNOT-REC-TYP       PIC X.
   527         16 ERCNOT-SEQ           PIC S9(4) COMP.
   528     12  SV-PARTIAL-KEY.
   529         20 SV-COMPANY-CD            PIC X.
   530         20 SV-CARRIER               PIC X.
   531         20 SV-GROUPING              PIC X(06).
   532         20 SV-STATE                 PIC XX.
   533         20 SV-ACCOUNT               PIC X(10).
   534         20 SV-EFF-DT                PIC XX.
   535         20 SV-CERT-NO.
   536            25 SV-CERT-PRIME         PIC X(10).
   537            25 SV-CERT-SFX           PIC X(1).
   538         20 SV-REC-TYP               PIC X.
   539 01  ERROR-MESSAGES.
   540     12  ER-0000                 PIC X(4)  VALUE '0000'.
   541     12  ER-0004                 PIC X(4)  VALUE '0004'.
   542     12  ER-0008                 PIC X(4)  VALUE '0008'.
   543     12  ER-0023                 PIC X(4)  VALUE '0023'.
   544     12  ER-0029                 PIC X(4)  VALUE '0029'.
   545     12  ER-0068                 PIC X(4)  VALUE '0068'.
   546     12  ER-0132                 PIC X(4)  VALUE '0132'.
   547     12  ER-0142                 PIC X(4)  VALUE '0142'.
   548     12  ER-0148                 PIC X(4)  VALUE '0148'.
   549     12  ER-0215                 PIC X(4)  VALUE '0215'.
   550     12  ER-0280                 PIC X(4)  VALUE '0280'.
   551     12  ER-0348                 PIC X(4)  VALUE '0348'.
   552     12  ER-0419                 PIC X(4)  VALUE '0419'.
   553     12  ER-0894                 PIC X(4)  VALUE '0894'.
   554     12  ER-1101                 PIC X(4)  VALUE '1101'.
   555     12  ER-1236                 PIC X(4)  VALUE '1236'.
   556     12  ER-1560                 PIC X(4)  VALUE '1560'.
   557     12  ER-1818                 PIC X(4)  VALUE '1818'.
   558     12  ER-1820                 PIC X(4)  VALUE '1820'.
   559     12  ER-2056                 PIC X(4)  VALUE '2056'.
   560     12  ER-2079                 PIC X(4)  VALUE '2079'.
   561     12  ER-2208                 PIC X(4)  VALUE '2208'.
   562     12  ER-2209                 PIC X(4)  VALUE '2209'.
   563     12  ER-2237                 PIC X(4)  VALUE '2237'.
   564     12  ER-2238                 PIC X(4)  VALUE '2238'.
   565     12  ER-2253                 PIC X(4)  VALUE '2253'.
   566     12  ER-2619                 PIC X(4)  VALUE '2619'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  12
* EL6317.cbl
   567     12  ER-2651                 PIC X(4)  VALUE '2651'.
   568     12  ER-2784                 PIC X(4)  VALUE '2784'.
   569     12  ER-2785                 PIC X(4)  VALUE '2785'.
   570     12  ER-2786                 PIC X(4)  VALUE '2786'.
   571     12  ER-2791                 PIC X(4)  VALUE '2791'.
   572     12  ER-2845                 PIC X(4)  VALUE '2845'.
   573     12  ER-2848                 PIC X(4)  VALUE '2848'.
   574     12  ER-2851                 PIC X(4)  VALUE '2851'.
   575     12  ER-3830                 PIC X(4)  VALUE '3830'.
   576     12  ER-3833                 PIC X(4)  VALUE '3833'.
   577     12  ER-7345                 PIC X(4)  VALUE '7345'.
   578     12  ER-7638                 PIC X(4)  VALUE '7638'.
   579     12  ER-8888                 PIC X(4)  VALUE '8888'.
   580     12  ER-9999                 PIC X(4)  VALUE '9999'.
   581*    COPY ELCDATE.
   582******************************************************************
   583*                                                                *
   584*                                                                *
   585*                            ELCDATE.                            *
   586*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   587*                            VMOD=2.003
   588*                                                                *
   589*                                                                *
   590*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   591*                 LENGTH = 200                                   *
   592******************************************************************
   593
   594 01  DATE-CONVERSION-DATA.
   595     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   596     12  DC-OPTION-CODE                PIC X.
   597         88  BIN-TO-GREG                VALUE ' '.
   598         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   599         88  EDIT-GREG-TO-BIN           VALUE '2'.
   600         88  YMD-GREG-TO-BIN            VALUE '3'.
   601         88  MDY-GREG-TO-BIN            VALUE '4'.
   602         88  JULIAN-TO-BIN              VALUE '5'.
   603         88  BIN-PLUS-ELAPSED           VALUE '6'.
   604         88  FIND-CENTURY               VALUE '7'.
   605         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   606         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   607         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   608         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   609         88  JULIAN-TO-BIN-3            VALUE 'C'.
   610         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   611         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   612         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   613         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   614         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   615         88  CHECK-LEAP-YEAR            VALUE 'H'.
   616         88  BIN-3-TO-GREG              VALUE 'I'.
   617         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   618         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   619         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   620         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   621         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   622         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   623         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   624         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  13
* EL6317.cbl
   625         88  THREE-CHARACTER-BIN
   626                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   627         88  GREGORIAN-TO-BIN
   628                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   629         88  BIN-TO-GREGORIAN
   630                  VALUES ' ' '1' 'I' '8' 'G'.
   631         88  JULIAN-TO-BINARY
   632                  VALUES '5' 'C' 'E' 'F'.
   633     12  DC-ERROR-CODE                 PIC X.
   634         88  NO-CONVERSION-ERROR        VALUE ' '.
   635         88  DATE-CONVERSION-ERROR
   636                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   637         88  DATE-IS-ZERO               VALUE '1'.
   638         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   639         88  DATE-IS-INVALID            VALUE '3'.
   640         88  DATE1-GREATER-DATE2        VALUE '4'.
   641         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   642         88  DATE-INVALID-OPTION        VALUE '9'.
   643         88  INVALID-CENTURY            VALUE 'A'.
   644         88  ONLY-CENTURY               VALUE 'B'.
   645         88  ONLY-LEAP-YEAR             VALUE 'C'.
   646         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   647     12  DC-END-OF-MONTH               PIC X.
   648         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   649     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   650         88  USE-NORMAL-PROCESS         VALUE ' '.
   651         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   652         88  ADJUST-UP-100-YRS          VALUE '2'.
   653     12  FILLER                        PIC X.
   654     12  DC-CONVERSION-DATES.
   655         16  DC-BIN-DATE-1             PIC XX.
   656         16  DC-BIN-DATE-2             PIC XX.
   657         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   658         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   659                       DC-GREG-DATE-1-EDIT.
   660             20  DC-EDIT1-MONTH        PIC 99.
   661             20  SLASH1-1              PIC X.
   662             20  DC-EDIT1-DAY          PIC 99.
   663             20  SLASH1-2              PIC X.
   664             20  DC-EDIT1-YEAR         PIC 99.
   665         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   666         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   667                     DC-GREG-DATE-2-EDIT.
   668             20  DC-EDIT2-MONTH        PIC 99.
   669             20  SLASH2-1              PIC X.
   670             20  DC-EDIT2-DAY          PIC 99.
   671             20  SLASH2-2              PIC X.
   672             20  DC-EDIT2-YEAR         PIC 99.
   673         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   674         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   675                     DC-GREG-DATE-1-YMD.
   676             20  DC-YMD-YEAR           PIC 99.
   677             20  DC-YMD-MONTH          PIC 99.
   678             20  DC-YMD-DAY            PIC 99.
   679         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   680         16  DC-GREG-DATE-1-MDY-R REDEFINES
   681                      DC-GREG-DATE-1-MDY.
   682             20  DC-MDY-MONTH          PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  14
* EL6317.cbl
   683             20  DC-MDY-DAY            PIC 99.
   684             20  DC-MDY-YEAR           PIC 99.
   685         16  DC-GREG-DATE-1-ALPHA.
   686             20  DC-ALPHA-MONTH        PIC X(10).
   687             20  DC-ALPHA-DAY          PIC 99.
   688             20  FILLER                PIC XX.
   689             20  DC-ALPHA-CENTURY.
   690                 24 DC-ALPHA-CEN-N     PIC 99.
   691             20  DC-ALPHA-YEAR         PIC 99.
   692         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   693         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   694         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   695         16  DC-JULIAN-DATE            PIC 9(05).
   696         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   697                                       PIC 9(05).
   698         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   699             20  DC-JULIAN-YEAR        PIC 99.
   700             20  DC-JULIAN-DAYS        PIC 999.
   701         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   702         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   703         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   704     12  DATE-CONVERSION-VARIBLES.
   705         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   706         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   707             20  FILLER                PIC 9(3).
   708             20  HOLD-CEN-1-CCYY.
   709                 24  HOLD-CEN-1-CC     PIC 99.
   710                 24  HOLD-CEN-1-YY     PIC 99.
   711             20  HOLD-CEN-1-MO         PIC 99.
   712             20  HOLD-CEN-1-DA         PIC 99.
   713         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   714             20  HOLD-CEN-1-R-MO       PIC 99.
   715             20  HOLD-CEN-1-R-DA       PIC 99.
   716             20  HOLD-CEN-1-R-CCYY.
   717                 24  HOLD-CEN-1-R-CC   PIC 99.
   718                 24  HOLD-CEN-1-R-YY   PIC 99.
   719             20  FILLER                PIC 9(3).
   720         16  HOLD-CENTURY-1-X.
   721             20  FILLER                PIC X(3)  VALUE SPACES.
   722             20  HOLD-CEN-1-X-CCYY.
   723                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   724                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   725             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   726             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   727         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   728             20  HOLD-CEN-1-R-X-MO     PIC XX.
   729             20  HOLD-CEN-1-R-X-DA     PIC XX.
   730             20  HOLD-CEN-1-R-X-CCYY.
   731                 24  HOLD-CEN-1-R-X-CC PIC XX.
   732                 24  HOLD-CEN-1-R-X-YY PIC XX.
   733             20  FILLER                PIC XXX.
   734         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   735         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   736         16  DC-JULIAN-DATE-1          PIC 9(07).
   737         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   738             20  DC-JULIAN-1-CCYY.
   739                 24  DC-JULIAN-1-CC    PIC 99.
   740                 24  DC-JULIAN-1-YR    PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  15
* EL6317.cbl
   741             20  DC-JULIAN-DA-1        PIC 999.
   742         16  DC-JULIAN-DATE-2          PIC 9(07).
   743         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   744             20  DC-JULIAN-2-CCYY.
   745                 24  DC-JULIAN-2-CC    PIC 99.
   746                 24  DC-JULIAN-2-YR    PIC 99.
   747             20  DC-JULIAN-DA-2        PIC 999.
   748         16  DC-GREG-DATE-A-EDIT.
   749             20  DC-EDITA-MONTH        PIC 99.
   750             20  SLASHA-1              PIC X VALUE '/'.
   751             20  DC-EDITA-DAY          PIC 99.
   752             20  SLASHA-2              PIC X VALUE '/'.
   753             20  DC-EDITA-CCYY.
   754                 24  DC-EDITA-CENT     PIC 99.
   755                 24  DC-EDITA-YEAR     PIC 99.
   756         16  DC-GREG-DATE-B-EDIT.
   757             20  DC-EDITB-MONTH        PIC 99.
   758             20  SLASHB-1              PIC X VALUE '/'.
   759             20  DC-EDITB-DAY          PIC 99.
   760             20  SLASHB-2              PIC X VALUE '/'.
   761             20  DC-EDITB-CCYY.
   762                 24  DC-EDITB-CENT     PIC 99.
   763                 24  DC-EDITB-YEAR     PIC 99.
   764         16  DC-GREG-DATE-CYMD         PIC 9(08).
   765         16  DC-GREG-DATE-CYMD-R REDEFINES
   766                              DC-GREG-DATE-CYMD.
   767             20  DC-CYMD-CEN           PIC 99.
   768             20  DC-CYMD-YEAR          PIC 99.
   769             20  DC-CYMD-MONTH         PIC 99.
   770             20  DC-CYMD-DAY           PIC 99.
   771         16  DC-GREG-DATE-MDCY         PIC 9(08).
   772         16  DC-GREG-DATE-MDCY-R REDEFINES
   773                              DC-GREG-DATE-MDCY.
   774             20  DC-MDCY-MONTH         PIC 99.
   775             20  DC-MDCY-DAY           PIC 99.
   776             20  DC-MDCY-CEN           PIC 99.
   777             20  DC-MDCY-YEAR          PIC 99.
   778    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   779        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   780    12  DC-EL310-DATE                  PIC X(21).
   781    12  FILLER                         PIC X(28).
   782*    COPY ELCTEXT.
   783******************************************************************
   784*                                                                *
   785*                                                                *
   786*                            ELCTEXT.                            *
   787*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   788*                            VMOD=2.008                          *
   789*                                                                *
   790*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   791*                                     FORM LETTERS,              *
   792*                                     CERT FORM DISPLAY.
   793*                                                                *
   794*   FILE TYPE = VSAM,KSDS                                        *
   795*   RECORD SIZE = 100   RECFORM = FIXED                          *
   796*                                                                *
   797*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   798*       ALTERNATE INDEX = NONE                                   *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  16
* EL6317.cbl
   799*                                                                *
   800*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   801*       ALTERNATE INDEX = NONE                                   *
   802*                                                                *
   803*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   804*       ALTERNATE INDEX = NONE                                   *
   805*                                                                *
   806*   LOG = NO                                                     *
   807*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   808******************************************************************
   809 01  TEXT-FILES.
   810     12  TEXT-FILE-ID                PIC XX.
   811         88  FORMS-FILE-TEXT            VALUE 'TF'.
   812         88  LETTER-FILE-TEXT           VALUE 'TL'.
   813         88  HELP-FILE-TEXT             VALUE 'TH'.
   814
   815     12  TX-CONTROL-PRIMARY.
   816         16  TX-COMPANY-CD           PIC X.
   817             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   818         16  TX-ACCESS-CD-GENL       PIC X(12).
   819
   820         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   821             20  TX-LETTER-NO        PIC X(4).
   822             20  FILLER              PIC X(8).
   823
   824         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   825             20  TX-FORM-NO          PIC X(12).
   826
   827         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   828             20  TX-HELP-TYPE        PIC X.
   829                 88  HELP-FOR-GENERAL   VALUE ' '.
   830                 88  HELP-BY-SCREEN     VALUE 'S'.
   831                 88  HELP-BY-ERROR      VALUE 'E'.
   832             20  TX-SCREEN-OR-ERROR  PIC X(4).
   833                 88  GENERAL-INFO-HELP  VALUE '0000'.
   834             20  TX-HELP-FOR-COMPANY  PIC XXX.
   835                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   836             20  FILLER              PIC X(4).
   837
   838         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   839
   840     12  TX-PROCESS-CONTROL          PIC XX.
   841         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   842
   843     12  TX-TEXT-LINE                PIC X(70).
   844
   845     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   846         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   847         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   848         88  TX-VALID-FORM-SQUEEZE-VALUE
   849                                        VALUE 'Y' ' '.
   850
   851     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   852         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   853         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   854         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   855         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   856         88  TX-NEW-PARAGRAPH           VALUE 'P'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  17
* EL6317.cbl
   857         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   858         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   859                                              'K' 'N' ' '
   860                                              'Z'.
   861
   862     12  TX-ARCHIVE-SW               PIC X.
   863         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
   864         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
   865         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
   866
   867     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
   868     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
   869
   870     12  TX-BSR-CODE                 PIC X.
   871         88  TX-BSR-LETTER              VALUE 'B'.
   872         88  TX-NON-BSR-LETTER          VALUE ' '.
   873
   874     12  FILLER                      PIC X.
   875*****************************************************************
   876*    COPY ELCLOGOF.
   877******************************************************************
   878*                                                                *
   879*                                                                *
   880*                            ELCLOGOF.                           *
   881*                            VMOD=2.001                          *
   882*                                                                *
   883*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   884*                                                                *
   885******************************************************************
   886 01  CLASIC-LOGOFF.
   887     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   888     12  LOGOFF-TEXT.
   889         16  FILLER          PIC X(5)    VALUE SPACES.
   890         16  LOGOFF-MSG.
   891             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   892             20  FILLER      PIC X       VALUE SPACES.
   893             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   894         16  FILLER          PIC X(80)
   895           VALUE '* YOU ARE NOW LOGGED OFF'.
   896         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   897         16  FILLER          PIC X       VALUE QUOTE.
   898         16  LOGOFF-SYS-MSG  PIC X(17)
   899           VALUE 'S CLAS-IC SYSTEM '.
   900     12  TEXT-MESSAGES.
   901         16  UNACCESS-MSG    PIC X(29)
   902             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   903         16  PGMIDERR-MSG    PIC X(17)
   904             VALUE 'PROGRAM NOT FOUND'.
   905*    COPY ELCATTR.
   906******************************************************************
   907*                                                                *
   908*                            ELCATTR.                            *
   909*                            VMOD=2.001                          *
   910*                                                                *
   911*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   912*                                                                *
   913*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   914*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  18
* EL6317.cbl
   915*                   POS 1   P=PROTECTED                          *
   916*                           U=UNPROTECTED                        *
   917*                           S=ASKIP                              *
   918*                   POS 2   A=ALPHA/NUMERIC                      *
   919*                           N=NUMERIC                            *
   920*                   POS 3   N=NORMAL                             *
   921*                           B=BRIGHT                             *
   922*                           D=DARK                               *
   923*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   924*                           OF=MODIFIED DATA TAG OFF             *
   925*                                                                *
   926*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   927******************************************************************
   928 01  ATTRIBUTE-LIST.
   929     12  AL-PABOF            PIC X       VALUE 'Y'.
   930     12  AL-PABON            PIC X       VALUE 'Z'.
   931     12  AL-PADOF            PIC X       VALUE '%'.
   932     12  AL-PADON            PIC X       VALUE '_'.
   933     12  AL-PANOF            PIC X       VALUE '-'.
   934     12  AL-PANON            PIC X       VALUE '/'.
   935     12  AL-SABOF            PIC X       VALUE '8'.
   936     12  AL-SABON            PIC X       VALUE '9'.
   937     12  AL-SADOF            PIC X       VALUE '@'.
   938     12  AL-SADON            PIC X       VALUE QUOTE.
   939     12  AL-SANOF            PIC X       VALUE '0'.
   940     12  AL-SANON            PIC X       VALUE '1'.
   941     12  AL-UABOF            PIC X       VALUE 'H'.
   942     12  AL-UABON            PIC X       VALUE 'I'.
   943     12  AL-UADOF            PIC X       VALUE '<'.
   944     12  AL-UADON            PIC X       VALUE '('.
   945     12  AL-UANOF            PIC X       VALUE ' '.
   946     12  AL-UANON            PIC X       VALUE 'A'.
   947     12  AL-UNBOF            PIC X       VALUE 'Q'.
   948     12  AL-UNBON            PIC X       VALUE 'R'.
   949     12  AL-UNDOF            PIC X       VALUE '*'.
   950     12  AL-UNDON            PIC X       VALUE ')'.
   951     12  AL-UNNOF            PIC X       VALUE '&'.
   952     12  AL-UNNON            PIC X       VALUE 'J'.
   953*    COPY ELCEMIB.
   954******************************************************************
   955*                                                                *
   956*                                                                *
   957*                            ELCEMIB.                            *
   958*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   959*                            VMOD=2.005                          *
   960*                                                                *
   961*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   962*                                                                *
   963******************************************************************
   964 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   965     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   966     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   967     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   968     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   969     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   970     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   971     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   972     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  19
* EL6317.cbl
   973     12  EMI-SWITCH1             PIC X        VALUE '1'.
   974         88  EMI-NO-ERRORS                    VALUE '1'.
   975         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   976         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   977     12  EMI-SWITCH2             PIC X        VALUE '1'.
   978         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   979     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   980         88  EMI-AREA1-EMPTY                  VALUE '1'.
   981         88  EMI-AREA1-FULL                   VALUE '2'.
   982     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   983         88  EMI-AREA2-EMPTY                  VALUE '1'.
   984         88  EMI-AREA2-FULL                   VALUE '2'.
   985     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   986         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   987         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   988         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   989         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   990         88  EMI-BYPASS-FATALS                VALUE 'X'.
   991     12  EMI-ERROR-LINES.
   992         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   993         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   994         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   995         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   996             20  EMI-ERR-CODES OCCURS 10 TIMES.
   997                 24  EMI-ERR-NUM         PIC X(4).
   998                 24  EMI-FILLER          PIC X.
   999                 24  EMI-SEV             PIC X.
  1000                 24  FILLER              PIC X.
  1001             20  FILLER                  PIC X(02).
  1002     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1003         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1004             20  EMI-ERROR-NUMBER    PIC X(4).
  1005             20  EMI-FILL            PIC X.
  1006             20  EMI-SEVERITY        PIC X.
  1007             20  FILLER              PIC X.
  1008             20  EMI-ERROR-TEXT.
  1009                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1010                 24  FILLER          PIC X(55).
  1011     12  EMI-SEVERITY-SAVE           PIC X.
  1012         88  EMI-NOTE                    VALUE 'N'.
  1013         88  EMI-WARNING                 VALUE 'W'.
  1014         88  EMI-FORCABLE                VALUE 'F'.
  1015         88  EMI-FATAL                   VALUE 'X'.
  1016     12  EMI-MESSAGE-FLAG            PIC X.
  1017         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1018         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1019     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1020     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1021         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1022         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1023         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1024     12  emi-claim-no                pic x(7).
  1025     12  emi-claim-type              pic x(6).
  1026     12  FILLER                      PIC X(124)  VALUE SPACES.
  1027     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1028     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1029     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1030     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  20
* EL6317.cbl
  1031*    COPY ELCINTF.
  1032******************************************************************
  1033*                                                                *
  1034*                                                                *
  1035*                            ELCINTF.                            *
  1036*                            VMOD=2.017                          *
  1037*                                                                *
  1038*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1039*                                                                *
  1040*       LENGTH = 1024                                            *
  1041*                                                                *
  1042******************************************************************
  1043*                   C H A N G E   L O G
  1044*
  1045* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1046*-----------------------------------------------------------------
  1047*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1048* EFFECTIVE    NUMBER
  1049*-----------------------------------------------------------------
  1050* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1051******************************************************************
  1052 01  PROGRAM-INTERFACE-BLOCK.
  1053     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1054     12  PI-CALLING-PROGRAM              PIC X(8).
  1055     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1056     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1057     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1058     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1059     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1060     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1061     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1062     12  PI-COMPANY-ID                   PIC XXX.
  1063     12  PI-COMPANY-CD                   PIC X.
  1064
  1065     12  PI-COMPANY-PASSWORD             PIC X(8).
  1066
  1067     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1068
  1069     12  PI-CONTROL-IN-PROGRESS.
  1070         16  PI-CARRIER                  PIC X.
  1071         16  PI-GROUPING                 PIC X(6).
  1072         16  PI-STATE                    PIC XX.
  1073         16  PI-ACCOUNT                  PIC X(10).
  1074         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1075                                         PIC X(10).
  1076         16  PI-CLAIM-CERT-GRP.
  1077             20  PI-CLAIM-NO             PIC X(7).
  1078             20  PI-CERT-NO.
  1079                 25  PI-CERT-PRIME       PIC X(10).
  1080                 25  PI-CERT-SFX         PIC X.
  1081             20  PI-CERT-EFF-DT          PIC XX.
  1082         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1083             20  PI-PLAN-CODE            PIC X(2).
  1084             20  PI-REVISION-NUMBER      PIC X(3).
  1085             20  PI-PLAN-EFF-DT          PIC X(2).
  1086             20  PI-PLAN-EXP-DT          PIC X(2).
  1087             20  FILLER                  PIC X(11).
  1088         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  21
* EL6317.cbl
  1089             20  PI-OE-REFERENCE-1.
  1090                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1091                 25  PI-OE-REF-1-SUFF    PIC XX.
  1092
  1093     12  PI-SESSION-IN-PROGRESS          PIC X.
  1094         88  CLAIM-SESSION                   VALUE '1'.
  1095         88  CREDIT-SESSION                  VALUE '2'.
  1096         88  WARRANTY-SESSION                VALUE '3'.
  1097         88  MORTGAGE-SESSION                VALUE '4'.
  1098         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1099
  1100
  1101*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1102
  1103     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1104     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1105
  1106     12  PI-CREDIT-USER                  PIC X.
  1107         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1108         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1109
  1110     12  PI-CLAIM-USER                   PIC X.
  1111         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1112         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1113
  1114     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1115         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1116         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1117         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1118         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1119         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1120
  1121     12  PI-PROCESSOR-ID                 PIC X(4).
  1122
  1123     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1124
  1125     12  PI-MEMBER-CAPTION               PIC X(10).
  1126
  1127     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1128         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1129
  1130     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1131     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1132     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1133     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1134
  1135     12  PI-AH-OVERRIDE-L1               PIC X.
  1136     12  PI-AH-OVERRIDE-L2               PIC XX.
  1137     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1138     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1139
  1140     12  PI-NEW-SYSTEM                   PIC X(2).
  1141
  1142     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1143     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1144         88  PI-USES-PAID-TO                 VALUE '1'.
  1145     12  PI-CRDTCRD-SYSTEM.
  1146         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  22
* EL6317.cbl
  1147             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1148             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1149         16  PI-CC-MONTH-END-DT          PIC XX.
  1150     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1151
  1152     12  PI-OE-REFERENCE-2.
  1153         16  PI-OE-REF-2-PRIME           PIC X(10).
  1154         16  PI-OE-REF-2-SUFF            PIC X.
  1155
  1156     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1157
  1158     12  PI-LANGUAGE-TYPE                PIC X.
  1159             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1160             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1161             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1162
  1163     12  PI-POLICY-LINKAGE-IND           PIC X.
  1164         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1165         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1166                                                   LOW-VALUES.
  1167
  1168     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1169     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1170         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1171         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1172
  1173     12  PI-PROCESSOR-CSR-IND            PIC X.
  1174         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1175         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1176
  1177     12  FILLER                          PIC X(3).
  1178
  1179     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1180
  1181     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1182         PI-SYSTEM-LEVEL.
  1183
  1184         16  PI-ENTRY-CODES.
  1185             20  PI-ENTRY-CD-1           PIC X.
  1186             20  PI-ENTRY-CD-2           PIC X.
  1187
  1188         16  PI-RETURN-CODES.
  1189             20  PI-RETURN-CD-1          PIC X.
  1190             20  PI-RETURN-CD-2          PIC X.
  1191
  1192         16  PI-UPDATE-STATUS-SAVE.
  1193             20  PI-UPDATE-BY            PIC X(4).
  1194             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1195
  1196         16  PI-LOWER-CASE-LETTERS       PIC X.
  1197             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1198
  1199*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1200*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1201*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1202
  1203         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1204             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  23
* EL6317.cbl
  1205             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1206             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1207             88  ACCNT-CNTL                  VALUE '3'.
  1208             88  CARR-ACCNT-CNTL             VALUE '4'.
  1209
  1210         16  PI-PROCESSOR-CAP-LIST.
  1211             20  PI-SYSTEM-CONTROLS.
  1212                24 PI-SYSTEM-DISPLAY     PIC X.
  1213                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1214                24 PI-SYSTEM-MODIFY      PIC X.
  1215                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1216             20  FILLER                  PIC XX.
  1217             20  PI-DISPLAY-CAP          PIC X.
  1218                 88  DISPLAY-CAP             VALUE 'Y'.
  1219             20  PI-MODIFY-CAP           PIC X.
  1220                 88  MODIFY-CAP              VALUE 'Y'.
  1221             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1222                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1223             20  PI-FORCE-CAP            PIC X.
  1224                 88  FORCE-CAP               VALUE 'Y'.
  1225
  1226         16  PI-PROGRAM-CONTROLS.
  1227             20  PI-PGM-PRINT-OPT        PIC X.
  1228             20  PI-PGM-FORMAT-OPT       PIC X.
  1229             20  PI-PGM-PROCESS-OPT      PIC X.
  1230             20  PI-PGM-TOTALS-OPT       PIC X.
  1231
  1232         16  PI-HELP-INTERFACE.
  1233             20  PI-LAST-ERROR-NO        PIC X(4).
  1234             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1235
  1236         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1237             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1238
  1239         16  PI-CR-CONTROL-IN-PROGRESS.
  1240             20  PI-CR-CARRIER           PIC X.
  1241             20  PI-CR-GROUPING          PIC X(6).
  1242             20  PI-CR-STATE             PIC XX.
  1243             20  PI-CR-ACCOUNT           PIC X(10).
  1244             20  PI-CR-FIN-RESP          PIC X(10).
  1245             20  PI-CR-TYPE              PIC X.
  1246
  1247         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1248
  1249         16  PI-CR-MONTH-END-DT          PIC XX.
  1250
  1251         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1252             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1253             88  PI-ZERO-CARRIER             VALUE '1'.
  1254             88  PI-ZERO-GROUPING            VALUE '2'.
  1255             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1256
  1257         16  PI-CARRIER-SECURITY         PIC X.
  1258             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1259
  1260         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1261             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1262             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  24
* EL6317.cbl
  1263
  1264         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1265             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1266                                         INDEXED BY PI-ACCESS-NDX
  1267                                         PIC X.
  1268
  1269         16  PI-GA-BILLING-CONTROL       PIC X.
  1270             88  PI-GA-BILLING               VALUE '1'.
  1271
  1272         16  PI-MAIL-PROCESSING          PIC X.
  1273             88  PI-MAIL-YES                 VALUE 'Y'.
  1274
  1275         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1276
  1277         16  PI-AR-SYSTEM.
  1278             20  PI-AR-PROCESSING-CNTL   PIC X.
  1279                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1280             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1281             20  PI-AR-MONTH-END-DT      PIC XX.
  1282
  1283         16  PI-MP-SYSTEM.
  1284             20  PI-MORTGAGE-USER            PIC X.
  1285                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1286                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1287             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1288                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1289                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1290                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1291                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1292                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1293             20  PI-MP-MONTH-END-DT          PIC XX.
  1294             20  PI-MP-REFERENCE-NO.
  1295                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1296                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1297
  1298         16  PI-LABEL-CONTROL            PIC X(01).
  1299             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1300             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1301
  1302         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1303             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1304
  1305         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1306             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1307             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1308
  1309         16  FILLER                      PIC X(14).
  1310
  1311     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1312******************************************************************
  1313     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1314        16  PI-ISS-CAN-SW           PIC X.
  1315        16  PI-ERENDT-KEY.
  1316            20  PI-ENDT-COMPANY-CD  PIC X.
  1317            20  PI-ENDT-CARRIER     PIC X.
  1318            20  PI-ENDT-GROUPING    PIC X(6).
  1319            20  PI-ENDT-STATE       PIC XX.
  1320            20  PI-ENDT-ACCOUNT     PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  25
* EL6317.cbl
  1321            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1322            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1323            20  PI-ENDT-CERT-SFX    PIC X.
  1324            20  PI-ENDT-RECORD-TYPE PIC X.
  1325            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1326        16  PI-ELCRTO-KEY.
  1327            20  PI-CRTO-COMPANY-CD  PIC X.
  1328            20  PI-CRTO-CARRIER     PIC X.
  1329            20  PI-CRTO-GROUPING    PIC X(6).
  1330            20  PI-CRTO-STATE       PIC XX.
  1331            20  PI-CRTO-ACCOUNT     PIC X(10).
  1332            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1333            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1334            20  PI-CRTO-CERT-SFX    PIC X.
  1335            20  PI-CRTO-RECORD-TYPE PIC X.
  1336            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1337        16  PI-ERPNDB-KEY           PIC X(11).
  1338        16  PI-DOCUMENT-PROCESSED   PIC X.
  1339            88  PI-VERI-PROCESSED      VALUE 'V'.
  1340            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1341        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1342        16  PI-RES-REF-CLM-TYPE     PIC X.
  1343        16  PI-CLM-REFORM-IND       PIC X.
  1344        16  PI-CLEAR-ERROR-SW       PIC X.
  1345            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1346        16  PI-PRINT-CERTIFICATE    PIC X.
  1347        16  PI-ENTERED.
  1348            20  PI-PRTSW-ENTERED    PIC X.
  1349            20  PI-SIGREQ-ENTERED   PIC X.
  1350            20  PI-MONEY-ENTERED    PIC X.
  1351            20  PI-LTRID-ENTERED    PIC X(4).
  1352            20  PI-REASONS-ENTERED  PIC X(84).
  1353            20  PI-CERTNT1-ENTERED  PIC X(63).
  1354            20  PI-CERTNT2-ENTERED  PIC X(63).
  1355        16  FILLER                  PIC X(17).
  1356        16  PI-FINALIZED-IND        PIC X.
  1357        16  PI-BILLNT1-ENTERED      PIC X(63).
  1358        16  PI-BILLNT2-ENTERED      PIC X(63).
  1359        16  PI-ENCCODE              PIC X(3).
  1360        16  FILLER                  PIC X(151).
  1361    12  FILLER                      PIC X(276).
  1362*    COPY ELCAID.
  1363******************************************************************
  1364*                                                                *
  1365*                            ELCAID.                             *
  1366*                            VMOD=2.001                          *
  1367*                                                                *
  1368*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1369*                                                                *
  1370*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1371*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1372******************************************************************
  1373
  1374 01  DFHAID.
  1375   02  DFHNULL   PIC  X  VALUE  ' '.
  1376   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1377   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1378   02  DFHPEN    PIC  X  VALUE  '='.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  26
* EL6317.cbl
  1379   02  DFHOPID   PIC  X  VALUE  'W'.
  1380   02  DFHPA1    PIC  X  VALUE  '%'.
  1381   02  DFHPA2    PIC  X  VALUE  '>'.
  1382   02  DFHPA3    PIC  X  VALUE  ','.
  1383   02  DFHPF1    PIC  X  VALUE  '1'.
  1384   02  DFHPF2    PIC  X  VALUE  '2'.
  1385   02  DFHPF3    PIC  X  VALUE  '3'.
  1386   02  DFHPF4    PIC  X  VALUE  '4'.
  1387   02  DFHPF5    PIC  X  VALUE  '5'.
  1388   02  DFHPF6    PIC  X  VALUE  '6'.
  1389   02  DFHPF7    PIC  X  VALUE  '7'.
  1390   02  DFHPF8    PIC  X  VALUE  '8'.
  1391   02  DFHPF9    PIC  X  VALUE  '9'.
  1392   02  DFHPF10   PIC  X  VALUE  ':'.
  1393   02  DFHPF11   PIC  X  VALUE  '#'.
  1394   02  DFHPF12   PIC  X  VALUE  '@'.
  1395   02  DFHPF13   PIC  X  VALUE  'A'.
  1396   02  DFHPF14   PIC  X  VALUE  'B'.
  1397   02  DFHPF15   PIC  X  VALUE  'C'.
  1398   02  DFHPF16   PIC  X  VALUE  'D'.
  1399   02  DFHPF17   PIC  X  VALUE  'E'.
  1400   02  DFHPF18   PIC  X  VALUE  'F'.
  1401   02  DFHPF19   PIC  X  VALUE  'G'.
  1402   02  DFHPF20   PIC  X  VALUE  'H'.
  1403   02  DFHPF21   PIC  X  VALUE  'I'.
  1404*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1405   02  DFHPF22   PIC  X  VALUE  '['.
  1406   02  DFHPF23   PIC  X  VALUE  '.'.
  1407   02  DFHPF24   PIC  X  VALUE  '<'.
  1408   02  DFHMSRE   PIC  X  VALUE  'X'.
  1409   02  DFHSTRF   PIC  X  VALUE  'h'.
  1410   02  DFHTRIG   PIC  X  VALUE  '"'.
  1411 01  FILLER    REDEFINES DFHAID.
  1412     12  FILLER              PIC X(8).
  1413     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1414*   COPY EL6317S.
  1415 01  EL631JI.
  1416     05  FILLER            PIC  X(0012).
  1417*    -------------------------------
  1418     05  DATEL PIC S9(0004) COMP.
  1419     05  DATEF PIC  X(0001).
  1420     05  FILLER REDEFINES DATEF.
  1421         10  DATEA PIC  X(0001).
  1422     05  DATEI PIC  X(0008).
  1423*    -------------------------------
  1424     05  TIMEL PIC S9(0004) COMP.
  1425     05  TIMEF PIC  X(0001).
  1426     05  FILLER REDEFINES TIMEF.
  1427         10  TIMEA PIC  X(0001).
  1428     05  TIMEI PIC  X(0005).
  1429*    -------------------------------
  1430     05  PROCIDL PIC S9(0004) COMP.
  1431     05  PROCIDF PIC  X(0001).
  1432     05  FILLER REDEFINES PROCIDF.
  1433         10  PROCIDA PIC  X(0001).
  1434     05  PROCIDI PIC  X(0004).
  1435*    -------------------------------
  1436     05  HOSTL PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  27
* EL6317.cbl
  1437     05  HOSTF PIC  X(0001).
  1438     05  FILLER REDEFINES HOSTF.
  1439         10  HOSTA PIC  X(0001).
  1440     05  HOSTI PIC  X(0009).
  1441*    -------------------------------
  1442     05  SYSL PIC S9(0004) COMP.
  1443     05  SYSF PIC  X(0001).
  1444     05  FILLER REDEFINES SYSF.
  1445         10  SYSA PIC  X(0001).
  1446     05  SYSI PIC  X(0005).
  1447*    -------------------------------
  1448     05  COMPANYL PIC S9(0004) COMP.
  1449     05  COMPANYF PIC  X(0001).
  1450     05  FILLER REDEFINES COMPANYF.
  1451         10  COMPANYA PIC  X(0001).
  1452     05  COMPANYI PIC  X(0003).
  1453*    -------------------------------
  1454     05  DATASORL PIC S9(0004) COMP.
  1455     05  DATASORF PIC  X(0001).
  1456     05  FILLER REDEFINES DATASORF.
  1457         10  DATASORA PIC  X(0001).
  1458     05  DATASORI PIC  X(0001).
  1459*    -------------------------------
  1460     05  BATCHNOL PIC S9(0004) COMP.
  1461     05  BATCHNOF PIC  X(0001).
  1462     05  FILLER REDEFINES BATCHNOF.
  1463         10  BATCHNOA PIC  X(0001).
  1464     05  BATCHNOI PIC  X(0006).
  1465*    -------------------------------
  1466     05  BSEQNOL PIC S9(0004) COMP.
  1467     05  BSEQNOF PIC  X(0001).
  1468     05  FILLER REDEFINES BSEQNOF.
  1469         10  BSEQNOA PIC  X(0001).
  1470     05  BSEQNOI PIC  X(0008).
  1471*    -------------------------------
  1472     05  ARCHNOL PIC S9(0004) COMP.
  1473     05  ARCHNOF PIC  X(0001).
  1474     05  FILLER REDEFINES ARCHNOF.
  1475         10  ARCHNOA PIC  X(0001).
  1476     05  ARCHNOI PIC  X(0008).
  1477*    -------------------------------
  1478     05  PRTSWL PIC S9(0004) COMP.
  1479     05  PRTSWF PIC  X(0001).
  1480     05  FILLER REDEFINES PRTSWF.
  1481         10  PRTSWA PIC  X(0001).
  1482     05  PRTSWI PIC  X(0001).
  1483*    -------------------------------
  1484     05  CARRL PIC S9(0004) COMP.
  1485     05  CARRF PIC  X(0001).
  1486     05  FILLER REDEFINES CARRF.
  1487         10  CARRA PIC  X(0001).
  1488     05  CARRI PIC  X(0001).
  1489*    -------------------------------
  1490     05  GROUPL PIC S9(0004) COMP.
  1491     05  GROUPF PIC  X(0001).
  1492     05  FILLER REDEFINES GROUPF.
  1493         10  GROUPA PIC  X(0001).
  1494     05  GROUPI PIC  X(0006).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  28
* EL6317.cbl
  1495*    -------------------------------
  1496     05  STATEL PIC S9(0004) COMP.
  1497     05  STATEF PIC  X(0001).
  1498     05  FILLER REDEFINES STATEF.
  1499         10  STATEA PIC  X(0001).
  1500     05  STATEI PIC  X(0002).
  1501*    -------------------------------
  1502     05  ACCTL PIC S9(0004) COMP.
  1503     05  ACCTF PIC  X(0001).
  1504     05  FILLER REDEFINES ACCTF.
  1505         10  ACCTA PIC  X(0001).
  1506     05  ACCTI PIC  X(0010).
  1507*    -------------------------------
  1508     05  EFFDTL PIC S9(0004) COMP.
  1509     05  EFFDTF PIC  X(0001).
  1510     05  FILLER REDEFINES EFFDTF.
  1511         10  EFFDTA PIC  X(0001).
  1512     05  EFFDTI PIC  X(0008).
  1513*    -------------------------------
  1514     05  CERTNOL PIC S9(0004) COMP.
  1515     05  CERTNOF PIC  X(0001).
  1516     05  FILLER REDEFINES CERTNOF.
  1517         10  CERTNOA PIC  X(0001).
  1518     05  CERTNOI PIC  X(0010).
  1519*    -------------------------------
  1520     05  CRTSFXL PIC S9(0004) COMP.
  1521     05  CRTSFXF PIC  X(0001).
  1522     05  FILLER REDEFINES CRTSFXF.
  1523         10  CRTSFXA PIC  X(0001).
  1524     05  CRTSFXI PIC  X(0001).
  1525*    -------------------------------
  1526     05  SEQNOL PIC S9(0004) COMP.
  1527     05  SEQNOF PIC  X(0001).
  1528     05  FILLER REDEFINES SEQNOF.
  1529         10  SEQNOA PIC  X(0001).
  1530     05  SEQNOI PIC  X(0006).
  1531*    -------------------------------
  1532     05  SIGREQL PIC S9(0004) COMP.
  1533     05  SIGREQF PIC  X(0001).
  1534     05  FILLER REDEFINES SIGREQF.
  1535         10  SIGREQA PIC  X(0001).
  1536     05  SIGREQI PIC  X(0001).
  1537*    -------------------------------
  1538     05  LTRIDL PIC S9(0004) COMP.
  1539     05  LTRIDF PIC  X(0001).
  1540     05  FILLER REDEFINES LTRIDF.
  1541         10  LTRIDA PIC  X(0001).
  1542     05  LTRIDI PIC  X(0004).
  1543*    -------------------------------
  1544     05  ENCCODEL PIC S9(0004) COMP.
  1545     05  ENCCODEF PIC  X(0001).
  1546     05  FILLER REDEFINES ENCCODEF.
  1547         10  ENCCODEA PIC  X(0001).
  1548     05  ENCCODEI PIC  X(0003).
  1549*    -------------------------------
  1550     05  RCD01L PIC S9(0004) COMP.
  1551     05  RCD01F PIC  X(0001).
  1552     05  FILLER REDEFINES RCD01F.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  29
* EL6317.cbl
  1553         10  RCD01A PIC  X(0001).
  1554     05  RCD01I PIC  X(0004).
  1555*    -------------------------------
  1556     05  RCD02L PIC S9(0004) COMP.
  1557     05  RCD02F PIC  X(0001).
  1558     05  FILLER REDEFINES RCD02F.
  1559         10  RCD02A PIC  X(0001).
  1560     05  RCD02I PIC  X(0004).
  1561*    -------------------------------
  1562     05  RCD03L PIC S9(0004) COMP.
  1563     05  RCD03F PIC  X(0001).
  1564     05  FILLER REDEFINES RCD03F.
  1565         10  RCD03A PIC  X(0001).
  1566     05  RCD03I PIC  X(0004).
  1567*    -------------------------------
  1568     05  RCD04L PIC S9(0004) COMP.
  1569     05  RCD04F PIC  X(0001).
  1570     05  FILLER REDEFINES RCD04F.
  1571         10  RCD04A PIC  X(0001).
  1572     05  RCD04I PIC  X(0004).
  1573*    -------------------------------
  1574     05  RCD05L PIC S9(0004) COMP.
  1575     05  RCD05F PIC  X(0001).
  1576     05  FILLER REDEFINES RCD05F.
  1577         10  RCD05A PIC  X(0001).
  1578     05  RCD05I PIC  X(0004).
  1579*    -------------------------------
  1580     05  RCD06L PIC S9(0004) COMP.
  1581     05  RCD06F PIC  X(0001).
  1582     05  FILLER REDEFINES RCD06F.
  1583         10  RCD06A PIC  X(0001).
  1584     05  RCD06I PIC  X(0004).
  1585*    -------------------------------
  1586     05  RCD07L PIC S9(0004) COMP.
  1587     05  RCD07F PIC  X(0001).
  1588     05  FILLER REDEFINES RCD07F.
  1589         10  RCD07A PIC  X(0001).
  1590     05  RCD07I PIC  X(0004).
  1591*    -------------------------------
  1592     05  RCD08L PIC S9(0004) COMP.
  1593     05  RCD08F PIC  X(0001).
  1594     05  FILLER REDEFINES RCD08F.
  1595         10  RCD08A PIC  X(0001).
  1596     05  RCD08I PIC  X(0004).
  1597*    -------------------------------
  1598     05  RCD09L PIC S9(0004) COMP.
  1599     05  RCD09F PIC  X(0001).
  1600     05  FILLER REDEFINES RCD09F.
  1601         10  RCD09A PIC  X(0001).
  1602     05  RCD09I PIC  X(0004).
  1603*    -------------------------------
  1604     05  RCD10L PIC S9(0004) COMP.
  1605     05  RCD10F PIC  X(0001).
  1606     05  FILLER REDEFINES RCD10F.
  1607         10  RCD10A PIC  X(0001).
  1608     05  RCD10I PIC  X(0004).
  1609*    -------------------------------
  1610     05  RCD11L PIC S9(0004) COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  30
* EL6317.cbl
  1611     05  RCD11F PIC  X(0001).
  1612     05  FILLER REDEFINES RCD11F.
  1613         10  RCD11A PIC  X(0001).
  1614     05  RCD11I PIC  X(0004).
  1615*    -------------------------------
  1616     05  RCD12L PIC S9(0004) COMP.
  1617     05  RCD12F PIC  X(0001).
  1618     05  FILLER REDEFINES RCD12F.
  1619         10  RCD12A PIC  X(0001).
  1620     05  RCD12I PIC  X(0004).
  1621*    -------------------------------
  1622     05  CRTNT1L PIC S9(0004) COMP.
  1623     05  CRTNT1F PIC  X(0001).
  1624     05  FILLER REDEFINES CRTNT1F.
  1625         10  CRTNT1A PIC  X(0001).
  1626     05  CRTNT1I PIC  X(0063).
  1627*    -------------------------------
  1628     05  CRTNT2L PIC S9(0004) COMP.
  1629     05  CRTNT2F PIC  X(0001).
  1630     05  FILLER REDEFINES CRTNT2F.
  1631         10  CRTNT2A PIC  X(0001).
  1632     05  CRTNT2I PIC  X(0063).
  1633*    -------------------------------
  1634     05  BILNT1L PIC S9(0004) COMP.
  1635     05  BILNT1F PIC  X(0001).
  1636     05  FILLER REDEFINES BILNT1F.
  1637         10  BILNT1A PIC  X(0001).
  1638     05  BILNT1I PIC  X(0063).
  1639*    -------------------------------
  1640     05  BILNT2L PIC S9(0004) COMP.
  1641     05  BILNT2F PIC  X(0001).
  1642     05  FILLER REDEFINES BILNT2F.
  1643         10  BILNT2A PIC  X(0001).
  1644     05  BILNT2I PIC  X(0063).
  1645*    -------------------------------
  1646     05  ERRMSG1L PIC S9(0004) COMP.
  1647     05  ERRMSG1F PIC  X(0001).
  1648     05  FILLER REDEFINES ERRMSG1F.
  1649         10  ERRMSG1A PIC  X(0001).
  1650     05  ERRMSG1I PIC  X(0075).
  1651*    -------------------------------
  1652     05  ERRMSG2L PIC S9(0004) COMP.
  1653     05  ERRMSG2F PIC  X(0001).
  1654     05  FILLER REDEFINES ERRMSG2F.
  1655         10  ERRMSG2A PIC  X(0001).
  1656     05  ERRMSG2I PIC  X(0075).
  1657*    -------------------------------
  1658     05  PFENTRL PIC S9(0004) COMP.
  1659     05  PFENTRF PIC  X(0001).
  1660     05  FILLER REDEFINES PFENTRF.
  1661         10  PFENTRA PIC  X(0001).
  1662     05  PFENTRI PIC  9(2).
  1663 01  EL631JO REDEFINES EL631JI.
  1664     05  FILLER            PIC  X(0012).
  1665*    -------------------------------
  1666     05  FILLER            PIC  X(0003).
  1667     05  DATEO PIC  X(0008).
  1668*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  31
* EL6317.cbl
  1669     05  FILLER            PIC  X(0003).
  1670     05  TIMEO PIC  99.99.
  1671*    -------------------------------
  1672     05  FILLER            PIC  X(0003).
  1673     05  PROCIDO PIC  X(0004).
  1674*    -------------------------------
  1675     05  FILLER            PIC  X(0003).
  1676     05  HOSTO PIC  X(0009).
  1677*    -------------------------------
  1678     05  FILLER            PIC  X(0003).
  1679     05  SYSO PIC  X(0005).
  1680*    -------------------------------
  1681     05  FILLER            PIC  X(0003).
  1682     05  COMPANYO PIC  X(0003).
  1683*    -------------------------------
  1684     05  FILLER            PIC  X(0003).
  1685     05  DATASORO PIC  X(0001).
  1686*    -------------------------------
  1687     05  FILLER            PIC  X(0003).
  1688     05  BATCHNOO PIC  X(0006).
  1689*    -------------------------------
  1690     05  FILLER            PIC  X(0003).
  1691     05  BSEQNOO PIC  X(0008).
  1692*    -------------------------------
  1693     05  FILLER            PIC  X(0003).
  1694     05  ARCHNOO PIC  X(0008).
  1695*    -------------------------------
  1696     05  FILLER            PIC  X(0003).
  1697     05  PRTSWO PIC  X(0001).
  1698*    -------------------------------
  1699     05  FILLER            PIC  X(0003).
  1700     05  CARRO PIC  X(0001).
  1701*    -------------------------------
  1702     05  FILLER            PIC  X(0003).
  1703     05  GROUPO PIC  X(0006).
  1704*    -------------------------------
  1705     05  FILLER            PIC  X(0003).
  1706     05  STATEO PIC  X(0002).
  1707*    -------------------------------
  1708     05  FILLER            PIC  X(0003).
  1709     05  ACCTO PIC  X(0010).
  1710*    -------------------------------
  1711     05  FILLER            PIC  X(0003).
  1712     05  EFFDTO PIC  X(0008).
  1713*    -------------------------------
  1714     05  FILLER            PIC  X(0003).
  1715     05  CERTNOO PIC  X(0010).
  1716*    -------------------------------
  1717     05  FILLER            PIC  X(0003).
  1718     05  CRTSFXO PIC  X(0001).
  1719*    -------------------------------
  1720     05  FILLER            PIC  X(0003).
  1721     05  SEQNOO PIC  999999.
  1722*    -------------------------------
  1723     05  FILLER            PIC  X(0003).
  1724     05  SIGREQO PIC  X(0001).
  1725*    -------------------------------
  1726     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  32
* EL6317.cbl
  1727     05  LTRIDO PIC  X(0004).
  1728*    -------------------------------
  1729     05  FILLER            PIC  X(0003).
  1730     05  ENCCODEO PIC  X(0003).
  1731*    -------------------------------
  1732     05  FILLER            PIC  X(0003).
  1733     05  RCD01O PIC  X(0004).
  1734*    -------------------------------
  1735     05  FILLER            PIC  X(0003).
  1736     05  RCD02O PIC  X(0004).
  1737*    -------------------------------
  1738     05  FILLER            PIC  X(0003).
  1739     05  RCD03O PIC  X(0004).
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  RCD04O PIC  X(0004).
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  RCD05O PIC  X(0004).
  1746*    -------------------------------
  1747     05  FILLER            PIC  X(0003).
  1748     05  RCD06O PIC  X(0004).
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  RCD07O PIC  X(0004).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
  1754     05  RCD08O PIC  X(0004).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  RCD09O PIC  X(0004).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  RCD10O PIC  X(0004).
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  RCD11O PIC  X(0004).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  RCD12O PIC  X(0004).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  CRTNT1O PIC  X(0063).
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  CRTNT2O PIC  X(0063).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  BILNT1O PIC  X(0063).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  BILNT2O PIC  X(0063).
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  ERRMSG1O PIC  X(0075).
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
  1784     05  ERRMSG2O PIC  X(0075).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  33
* EL6317.cbl
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  PFENTRO PIC  X(0002).
  1788*    -------------------------------
  1789 01  filler redefines el631ji.
  1790     12  filler                   pic x(188).
  1791     12  REASONCDS.
  1792         16  filler occurs 12.
  1793             20  reacdl       pic s9(4) comp.
  1794             20  reacda       pic x.
  1795             20  reacd-in     pic x(4).
  1796    12  FILLER                   PIC X(293).
  1797****************************************************************
  1798*
  1799* Copyright (c) 2007-2013 Dell Inc.
  1800* All rights reserved.
  1801*
  1802****************************************************************
  1803 01  DFHEIV.
  1804   02  DFHEIV0               PIC X(35).
  1805   02  DFHEIV1               PIC X(08).
  1806   02  DFHEIV2               PIC X(08).
  1807   02  DFHEIV3               PIC X(08).
  1808   02  DFHEIV4               PIC X(06).
  1809   02  DFHEIV5               PIC X(04).
  1810   02  DFHEIV6               PIC X(04).
  1811   02  DFHEIV7               PIC X(02).
  1812   02  DFHEIV8               PIC X(02).
  1813   02  DFHEIV9               PIC X(01).
  1814   02  DFHEIV10              PIC S9(7) COMP-3.
  1815   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1816   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1817   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1818   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1819   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1820   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1821   02  DFHEIV17              PIC X(04).
  1822   02  DFHEIV18              PIC X(04).
  1823   02  DFHEIV19              PIC X(04).
  1824   02  DFHEIV20              USAGE IS POINTER.
  1825   02  DFHEIV21              USAGE IS POINTER.
  1826   02  DFHEIV22              USAGE IS POINTER.
  1827   02  DFHEIV23              USAGE IS POINTER.
  1828   02  DFHEIV24              USAGE IS POINTER.
  1829   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1830   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1831   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1832   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1833   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1834   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1835   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1836   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1837   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1838   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1839   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1840   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1841   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1842   02  FILLER                PIC X(02).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  34
* EL6317.cbl
  1843   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1844   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1845   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1846   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1847   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1848   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1849   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1850 LINKAGE  SECTION.
  1851*****************************************************************
  1852*                                                               *
  1853* Copyright (c) 2007-2013 Dell Inc.                             *
  1854* All rights reserved.                                          *
  1855*                                                               *
  1856*****************************************************************
  1857 01  dfheiblk.
  1858     02  eibtime          pic s9(7) comp-3.
  1859     02  eibdate          pic s9(7) comp-3.
  1860     02  eibtrnid         pic x(4).
  1861     02  eibtaskn         pic s9(7) comp-3.
  1862     02  eibtrmid         pic x(4).
  1863     02  dfheigdi         pic s9(4) comp.
  1864     02  eibcposn         pic s9(4) comp.
  1865     02  eibcalen         pic s9(4) comp.
  1866     02  eibaid           pic x(1).
  1867     02  eibfiller1       pic x(1).
  1868     02  eibfn            pic x(2).
  1869     02  eibfiller2       pic x(2).
  1870     02  eibrcode         pic x(6).
  1871     02  eibfiller3       pic x(2).
  1872     02  eibds            pic x(8).
  1873     02  eibreqid         pic x(8).
  1874     02  eibrsrce         pic x(8).
  1875     02  eibsync          pic x(1).
  1876     02  eibfree          pic x(1).
  1877     02  eibrecv          pic x(1).
  1878     02  eibsend          pic x(1).
  1879     02  eibatt           pic x(1).
  1880     02  eibeoc           pic x(1).
  1881     02  eibfmh           pic x(1).
  1882     02  eibcompl         pic x(1).
  1883     02  eibsig           pic x(1).
  1884     02  eibconf          pic x(1).
  1885     02  eiberr           pic x(1).
  1886     02  eibrldbk         pic x(1).
  1887     02  eiberrcd         pic x(4).
  1888     02  eibsynrb         pic x(1).
  1889     02  eibnodat         pic x(1).
  1890     02  eibfiller5       pic x(2).
  1891     02  eibresp          pic s9(8) comp.
  1892     02  eibresp2         pic s9(8) comp.
  1893     02  dfheigdj         pic s9(4) comp.
  1894     02  dfheigdk         pic s9(4) comp.
  1895 01  DFHCOMMAREA                 PIC X(1300).
  1896 01  var  pic x(30).
  1897*                                COPY ERCACCT.
  1898******************************************************************
  1899*                                                                *
  1900*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  35
* EL6317.cbl
  1901*                            ERCACCT                             *
  1902*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1903*                            VMOD=2.031                          *
  1904*                                                                *
  1905*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1906*                                                                *
  1907*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1908*   VSAM ACCOUNT MASTER FILES.                                   *
  1909*                                                                *
  1910*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1911*                                                                *
  1912*   FILE TYPE = VSAM,KSDS                                        *
  1913*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1914*                                                                *
  1915*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1916*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1917*                                                                *
  1918*   LOG = NO                                                     *
  1919*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1920*                                                                *
  1921*                                                                *
  1922******************************************************************
  1923*                   C H A N G E   L O G
  1924*
  1925* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1926*-----------------------------------------------------------------
  1927*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1928* EFFECTIVE    NUMBER
  1929*-----------------------------------------------------------------
  1930* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1931* 092705    2005050300006  PEMA  ADD SPP LEASES
  1932* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1933* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1934* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  1935* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  1936* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  1937* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  1938******************************************************************
  1939
  1940 01  ACCOUNT-MASTER.
  1941     12  AM-RECORD-ID                      PIC XX.
  1942         88  VALID-AM-ID                      VALUE 'AM'.
  1943
  1944     12  AM-CONTROL-PRIMARY.
  1945         16  AM-COMPANY-CD                 PIC X.
  1946         16  AM-MSTR-CNTRL.
  1947             20  AM-CONTROL-A.
  1948                 24  AM-CARRIER            PIC X.
  1949                 24  AM-GROUPING.
  1950                     28 AM-GROUPING-PREFIX PIC XXX.
  1951                     28 AM-GROUPING-PRIME  PIC XXX.
  1952                 24  AM-STATE              PIC XX.
  1953                 24  AM-ACCOUNT.
  1954                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1955                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1956             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1957                                           PIC X(19).
  1958             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  36
* EL6317.cbl
  1959                 24  AM-EXPIRATION-DT      PIC XX.
  1960                 24  FILLER                PIC X(4).
  1961             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1962                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1963
  1964     12  AM-CONTROL-BY-VAR-GRP.
  1965         16  AM-COMPANY-CD-A1              PIC X.
  1966         16  AM-VG-CARRIER                 PIC X.
  1967         16  AM-VG-GROUPING                PIC X(6).
  1968         16  AM-VG-STATE                   PIC XX.
  1969         16  AM-VG-ACCOUNT                 PIC X(10).
  1970         16  AM-VG-DATE.
  1971             20  AM-VG-EXPIRATION-DT       PIC XX.
  1972             20  FILLER                    PIC X(4).
  1973         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1974                                           PIC 9(11)      COMP-3.
  1975     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  1976         16  FILLER                        PIC X(10).
  1977         16  AM-VG-KEY3.
  1978             20  AM-VG3-ACCOUNT            PIC X(10).
  1979             20  AM-VG3-EXP-DT             PIC XX.
  1980         16  FILLER                        PIC X(4).
  1981     12  AM-MAINT-INFORMATION.
  1982         16  AM-LAST-MAINT-DT              PIC XX.
  1983         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1984         16  AM-LAST-MAINT-USER            PIC X(4).
  1985         16  FILLER                        PIC XX.
  1986
  1987     12  AM-EFFECTIVE-DT                   PIC XX.
  1988     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1989
  1990     12  AM-PREV-DATES  COMP-3.
  1991         16  AM-PREV-EXP-DT                PIC 9(11).
  1992         16  AM-PREV-EFF-DT                PIC 9(11).
  1993
  1994     12  AM-REPORT-CODE-1                  PIC X(10).
  1995     12  AM-REPORT-CODE-2                  PIC X(10).
  1996
  1997     12  AM-CITY-CODE                      PIC X(4).
  1998     12  AM-COUNTY-PARISH                  PIC X(6).
  1999
  2000     12  AM-NAME                           PIC X(30).
  2001     12  AM-PERSON                         PIC X(30).
  2002     12  AM-ADDRS                          PIC X(30).
  2003     12  AM-CITY.
  2004         16  AM-ADDR-CITY                  PIC X(28).
  2005         16  AM-ADDR-STATE                 PIC XX.
  2006     12  AM-ZIP.
  2007         16  AM-ZIP-PRIME.
  2008             20  AM-ZIP-PRI-1ST            PIC X.
  2009                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2010             20  FILLER                    PIC X(4).
  2011         16  AM-ZIP-PLUS4                  PIC X(4).
  2012     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2013         16  AM-CAN-POSTAL-1               PIC XXX.
  2014         16  AM-CAN-POSTAL-2               PIC XXX.
  2015         16  FILLER                        PIC XXX.
  2016     12  AM-TEL-NO.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  37
* EL6317.cbl
  2017         16  AM-AREA-CODE                  PIC 999.
  2018         16  AM-TEL-PRE                    PIC 999.
  2019         16  AM-TEL-NBR                    PIC 9(4).
  2020     12  AM-TEL-LOC                        PIC X.
  2021         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2022         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2023
  2024     12  AM-COMM-STRUCTURE.
  2025         16  AM-DEFN-1.
  2026             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2027                 24  AM-AGT.
  2028                     28  AM-AGT-PREFIX     PIC X(4).
  2029                     28  AM-AGT-PRIME      PIC X(6).
  2030                 24  AM-COM-TYP            PIC X.
  2031                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2032                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2033                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2034                 24  AM-RECALC-LV-INDIC    PIC X.
  2035                 24  AM-RETRO-LV-INDIC     PIC X.
  2036                 24  AM-GL-CODES           PIC X.
  2037                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2038                 24  FILLER                PIC X(01).
  2039         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2040             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2041                 24  FILLER                PIC X(11).
  2042                 24  AM-L-COMA             PIC XXX.
  2043                 24  AM-J-COMA             PIC XXX.
  2044                 24  AM-A-COMA             PIC XXX.
  2045                 24  FILLER                PIC X(6).
  2046
  2047     12  AM-COMM-CHANGE-STATUS             PIC X.
  2048         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2049
  2050     12  AM-CSR-CODE                       PIC X(4).
  2051
  2052     12  AM-BILLING-STATUS                 PIC X.
  2053         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2054         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2055     12  AM-AUTO-REFUND-SW                 PIC X.
  2056         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2057         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2058     12  AM-GPCD                           PIC 99.
  2059     12  AM-IG                             PIC X.
  2060         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2061         88  AM-HAS-GROUP                     VALUE '2'.
  2062     12  AM-STATUS                         PIC X.
  2063         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2064         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2065         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2066         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2067         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2068         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2069         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2070         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2071         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2072         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2073     12  AM-REMIT-TO                       PIC 99.
  2074     12  AM-ID-NO                          PIC X(11).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  38
* EL6317.cbl
  2075
  2076     12  AM-CAL-TABLE                      PIC XX.
  2077     12  AM-LF-DEVIATION                   PIC XXX.
  2078     12  AM-AH-DEVIATION                   PIC XXX.
  2079     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2080     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2081     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  2082     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2083     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2084     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2085
  2086     12  AM-USER-FIELDS.
  2087         16  AM-FLD-1                      PIC XX.
  2088         16  AM-FLD-2                      PIC XX.
  2089         16  AM-FLD-3                      PIC XX.
  2090         16  AM-FLD-4                      PIC XX.
  2091         16  AM-FLD-5                      PIC XX.
  2092
  2093     12  AM-1ST-PROD-DATE.
  2094         16  AM-1ST-PROD-YR                PIC XX.
  2095         16  AM-1ST-PROD-MO                PIC XX.
  2096         16  AM-1ST-PROD-DA                PIC XX.
  2097     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2098     12  AM-CERTS-PURGED-DATE.
  2099         16  AM-PUR-YR                     PIC XX.
  2100         16  AM-PUR-MO                     PIC XX.
  2101         16  AM-PUR-DA                     PIC XX.
  2102     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2103     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2104     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2105     12  AM-INACTIVE-DATE.
  2106         16  AM-INA-MO                     PIC 99.
  2107         16  AM-INA-DA                     PIC 99.
  2108         16  AM-INA-YR                     PIC 99.
  2109     12  AM-AR-HI-CERT-DATE                PIC XX.
  2110
  2111     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2112     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2113
  2114     12  AM-OB-PAYMENT-MODE                PIC X.
  2115         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2116         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2117         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2118         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2119
  2120     12  AM-AH-ONLY-INDICATOR              PIC X.
  2121         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2122         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2123
  2124     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2125
  2126     12  AM-OVER-SHORT.
  2127         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2128         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2129
  2130     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2131     12  AM-DCC-CLP-STATE                  PIC XX.
  2132
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  39
* EL6317.cbl
  2133     12  AM-RECALC-COMM                    PIC X.
  2134     12  AM-RECALC-REIN                    PIC X.
  2135
  2136     12  AM-REI-TABLE                      PIC XXX.
  2137     12  AM-REI-ET-LF                      PIC X.
  2138     12  AM-REI-ET-AH                      PIC X.
  2139     12  AM-REI-PE-LF                      PIC X.
  2140     12  AM-REI-PE-AH                      PIC X.
  2141     12  AM-REI-PRT-ST                     PIC X.
  2142     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2143     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2144     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2145     12  AM-REI-GROUP-A                    PIC X(6).
  2146     12  AM-REI-MORT                       PIC X(4).
  2147     12  AM-REI-PRT-OW                     PIC X.
  2148     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2149     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2150     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2151     12  AM-REI-GROUP-B                    PIC X(6).
  2152
  2153     12  AM-TRUST-TYPE                     PIC X(2).
  2154
  2155     12  AM-EMPLOYER-STMT-USED             PIC X.
  2156     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2157
  2158     12  AM-STD-AH-TYPE                    PIC XX.
  2159     12  AM-EARN-METHODS.
  2160         16  AM-EARN-METHOD-R              PIC X.
  2161             88 AM-REF-RL-R78                 VALUE 'R'.
  2162             88 AM-REF-RL-PR                  VALUE 'P'.
  2163             88 AM-REF-RL-MEAN                VALUE 'M'.
  2164             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2165         16  AM-EARN-METHOD-L              PIC X.
  2166             88 AM-REF-LL-R78                 VALUE 'R'.
  2167             88 AM-REF-LL-PR                  VALUE 'P'.
  2168             88 AM-REF-LL-MEAN                VALUE 'M'.
  2169             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2170         16  AM-EARN-METHOD-A              PIC X.
  2171             88 AM-REF-AH-R78                 VALUE 'R'.
  2172             88 AM-REF-AH-PR                  VALUE 'P'.
  2173             88 AM-REF-AH-MEAN                VALUE 'M'.
  2174             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2175             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2176             88 AM-REF-AH-NET                 VALUE 'N'.
  2177
  2178     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2179     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2180     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2181
  2182     12  AM-RET-Y-N                        PIC X.
  2183     12  AM-RET-P-E                        PIC X.
  2184     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2185     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2186     12  AM-RET-GRP                        PIC X(6).
  2187     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2188         16  AM-POOL-PRIME                 PIC XXX.
  2189         16  AM-POOL-SUB                   PIC XXX.
  2190     12  AM-RETRO-EARNINGS.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  40
* EL6317.cbl
  2191         16  AM-RET-EARN-R                 PIC X.
  2192         16  AM-RET-EARN-L                 PIC X.
  2193         16  AM-RET-EARN-A                 PIC X.
  2194     12  AM-RET-ST-TAX-USE                 PIC X.
  2195         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2196         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2197     12  AM-RETRO-BEG-EARNINGS.
  2198         16  AM-RET-BEG-EARN-R             PIC X.
  2199         16  AM-RET-BEG-EARN-L             PIC X.
  2200         16  AM-RET-BEG-EARN-A             PIC X.
  2201     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2202     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2203
  2204     12  AM-USER-SELECT-OPTIONS.
  2205         16  AM-USER-SELECT-1              PIC X(10).
  2206         16  AM-USER-SELECT-2              PIC X(10).
  2207         16  AM-USER-SELECT-3              PIC X(10).
  2208         16  AM-USER-SELECT-4              PIC X(10).
  2209         16  AM-USER-SELECT-5              PIC X(10).
  2210
  2211     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2212
  2213     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2214
  2215     12  AM-RPT045A-SWITCH                 PIC X.
  2216         88  RPT045A-OFF                   VALUE 'N'.
  2217
  2218     12  AM-INSURANCE-LIMITS.
  2219         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2220         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2221
  2222     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2223         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2224
  2225     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2226         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2227         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2228
  2229     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2230
  2231     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2232     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2233     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2234     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2235     12  AM-DCC-UEF-STATE                  PIC XX.
  2236     12  FILLER                            PIC XXX.
  2237     12  AM-REPORT-CODE-3                  PIC X(10).
  2238*    12  FILLER                            PIC X(22).
  2239
  2240     12  AM-RESERVE-DATE.
  2241         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2242         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2243         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2244
  2245     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2246     12  AM-NOTIFICATION-TYPES.
  2247         16  AM-NOTIF-OF-LETTERS           PIC X.
  2248         16  AM-NOTIF-OF-PAYMENTS          PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  41
* EL6317.cbl
  2249         16  AM-NOTIF-OF-REPORTS           PIC X.
  2250         16  AM-NOTIF-OF-STATUS            PIC X.
  2251
  2252     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2253         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2254         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2255         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  2256         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2257
  2258     12  AM-BENEFIT-CONTROLS.
  2259         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2260             20  AM-BENEFIT-CODE           PIC XX.
  2261             20  AM-BENEFIT-TYPE           PIC X.
  2262             20  AM-BENEFIT-REVISION       PIC XXX.
  2263             20  AM-BENEFIT-REM-TERM       PIC X.
  2264             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2265             20  FILLER                    PIC XX.
  2266         16  FILLER                        PIC X(80).
  2267
  2268     12  AM-TRANSFER-DATA.
  2269         16  AM-TRANSFERRED-FROM.
  2270             20  AM-TRNFROM-CARRIER        PIC X.
  2271             20  AM-TRNFROM-GROUPING.
  2272                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2273                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2274             20  AM-TRNFROM-STATE          PIC XX.
  2275             20  AM-TRNFROM-ACCOUNT.
  2276                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2277                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2278             20  AM-TRNFROM-DTE            PIC XX.
  2279         16  AM-TRANSFERRED-TO.
  2280             20  AM-TRNTO-CARRIER          PIC X.
  2281             20  AM-TRNTO-GROUPING.
  2282                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2283                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2284             20  AM-TRNTO-STATE            PIC XX.
  2285             20  AM-TRNTO-ACCOUNT.
  2286                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2287                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2288             20  AM-TRNTO-DTE              PIC XX.
  2289         16  FILLER                        PIC X(10).
  2290
  2291     12  AM-SAVED-REMIT-TO                 PIC 99.
  2292
  2293     12  AM-COMM-STRUCTURE-SAVED.
  2294         16  AM-DEFN-1-SAVED.
  2295             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2296                 24  AM-AGT-SV             PIC X(10).
  2297                 24  AM-COM-TYP-SV         PIC X.
  2298                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2299                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2300                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2301                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2302                 24  FILLER                PIC X.
  2303                 24  AM-GL-CODES-SV        PIC X.
  2304                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2305                 24  FILLER                PIC X.
  2306         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  42
* EL6317.cbl
  2307             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2308                 24  FILLER                PIC X(11).
  2309                 24  AM-L-COMA-SV          PIC XXX.
  2310                 24  AM-J-COMA-SV          PIC XXX.
  2311                 24  AM-A-COMA-SV          PIC XXX.
  2312                 24  FILLER                PIC X(6).
  2313
  2314     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2315         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2316            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2317            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2318            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2319
  2320     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2321     12  FILLER                            PIC X(120).
  2322
  2323     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2324         16  AM-CONTROL-NAME               PIC X(30).
  2325         16  AM-EXECUTIVE-ONE.
  2326             20  AM-EXEC1-NAME             PIC X(15).
  2327             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2328                                                          COMP-3.
  2329             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2330                                                          COMP-3.
  2331         16  AM-EXECUTIVE-TWO.
  2332             20  AM-EXEC2-NAME             PIC X(15).
  2333             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2334                                                          COMP-3.
  2335             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2336                                                          COMP-3.
  2337
  2338     12  AM-RETRO-ADDITIONAL-DATA.
  2339         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2340         16  AM-RETRO-PREM-P-E             PIC X.
  2341         16  AM-RETRO-CLMS-P-I             PIC X.
  2342         16  AM-RETRO-RET-BRACKET-LF.
  2343             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2344                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2345                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2346             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2347                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2348                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2349             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2350                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2351                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2352         16  AM-RETRO-RET-BRACKET-AH.
  2353             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2354                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2355                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2356                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2357             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2358                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2359                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2360             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2361                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2362                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2363
  2364     12  AM-COMMENTS.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  43
* EL6317.cbl
  2365         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2366
  2367     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2368         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2369         16  AM-FLI-BILLING-CODE           PIC X.
  2370         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2371         16  AM-FLI-UNITED-IDENT           PIC X.
  2372         16  AM-FLI-INTEREST-LOST-DATA.
  2373             20  AM-FLI-BANK-NO            PIC X(5).
  2374             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2375             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2376             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2377         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2378             20  AM-FLI-AGT                PIC X(9).
  2379             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2380             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2381         16  FILLER                        PIC X(102).
  2382
  2383     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2384         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2385             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2386             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2387             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2388             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2389             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2390         16  FILLER                          PIC X(10).
  2391******************************************************************
  2392*                                COPY ELCCNTL.
  2393******************************************************************
  2394*                                                                *
  2395*                                                                *
  2396*                            ELCCNTL.                            *
  2397*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2398*                            VMOD=2.059                          *
  2399*                                                                *
  2400*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2401*                                                                *
  2402*   FILE TYPE = VSAM,KSDS                                        *
  2403*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2404*                                                                *
  2405*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2406*       ALTERNATE INDEX = NONE                                   *
  2407*                                                                *
  2408*   LOG = YES                                                    *
  2409*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2410******************************************************************
  2411*                   C H A N G E   L O G
  2412*
  2413* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2414*-----------------------------------------------------------------
  2415*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2416* EFFECTIVE    NUMBER
  2417*-----------------------------------------------------------------
  2418* 082503                   PEMA  ADD BENEFIT GROUP
  2419* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2420* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2421* 092705    2005050300006  PEMA  ADD SPP LEASES
  2422* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  44
* EL6317.cbl
  2423* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2424* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2425* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2426* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2427* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2428* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2429* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2430* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2431* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2432* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2433******************************************************************
  2434*
  2435 01  CONTROL-FILE.
  2436     12  CF-RECORD-ID                       PIC XX.
  2437         88  VALID-CF-ID                        VALUE 'CF'.
  2438
  2439     12  CF-CONTROL-PRIMARY.
  2440         16  CF-COMPANY-ID                  PIC XXX.
  2441         16  CF-RECORD-TYPE                 PIC X.
  2442             88  CF-COMPANY-MASTER              VALUE '1'.
  2443             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2444             88  CF-STATE-MASTER                VALUE '3'.
  2445             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2446             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2447             88  CF-CARRIER-MASTER              VALUE '6'.
  2448             88  CF-MORTALITY-MASTER            VALUE '7'.
  2449             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2450             88  CF-TERMINAL-MASTER             VALUE '9'.
  2451             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2452             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2453             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2454             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2455             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2456             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2457             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2458             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2459             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2460         16  CF-ACCESS-CD-GENL              PIC X(4).
  2461         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2462             20  CF-PROCESSOR               PIC X(4).
  2463         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2464             20  CF-STATE-CODE              PIC XX.
  2465             20  FILLER                     PIC XX.
  2466         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2467             20  FILLER                     PIC XX.
  2468             20  CF-HI-BEN-IN-REC           PIC XX.
  2469         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2470             20  FILLER                     PIC XXX.
  2471             20  CF-CARRIER-CNTL            PIC X.
  2472         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2473             20  FILLER                     PIC XX.
  2474             20  CF-HI-TYPE-IN-REC          PIC 99.
  2475         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2476             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2477                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2478             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2479             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2480         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  45
* EL6317.cbl
  2481             20  FILLER                     PIC X.
  2482             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2483         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2484             20  FILLER                     PIC XX.
  2485             20  CF-MORTGAGE-PLAN           PIC XX.
  2486         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2487
  2488     12  CF-LAST-MAINT-DT                   PIC XX.
  2489     12  CF-LAST-MAINT-BY                   PIC X(4).
  2490     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2491
  2492     12  CF-RECORD-BODY                     PIC X(728).
  2493
  2494
  2495****************************************************************
  2496*             COMPANY MASTER RECORD                            *
  2497****************************************************************
  2498
  2499     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2500         16  CF-COMPANY-ADDRESS.
  2501             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2502             20  CF-CL-IN-CARE-OF           PIC X(30).
  2503             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2504             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2505             20  CF-CL-CITY-STATE           PIC X(30).
  2506             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2507             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2508         16  CF-COMPANY-CD                  PIC X.
  2509         16  CF-COMPANY-PASSWORD            PIC X(8).
  2510         16  CF-SECURITY-OPTION             PIC X.
  2511             88  ALL-SECURITY                   VALUE '1'.
  2512             88  COMPANY-VERIFY                 VALUE '2'.
  2513             88  PROCESSOR-VERIFY               VALUE '3'.
  2514             88  NO-SECURITY                    VALUE '4'.
  2515             88  ALL-BUT-TERM                   VALUE '5'.
  2516         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2517             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2518         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2519             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2520         16  CF-INFORCE-LOCATION            PIC X.
  2521             88  CERTS-ARE-ONLINE               VALUE '1'.
  2522             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2523             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2524         16  CF-LOWER-CASE-LETTERS          PIC X.
  2525         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2526             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2527             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2528             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2529             88  CF-ACCNT-CNTL                  VALUE '3'.
  2530             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2531
  2532         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2533         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2534
  2535         16  CF-LGX-CREDIT-USER             PIC X.
  2536             88  CO-IS-NOT-USER                 VALUE 'N'.
  2537             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2538
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  46
* EL6317.cbl
  2539         16 CF-CREDIT-CALC-CODES.
  2540             20  CF-CR-REM-TERM-CALC PIC X.
  2541               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2542               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2543               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2544               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2545               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2546               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2547               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2548             20  CF-CR-R78-METHOD           PIC X.
  2549               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2550               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2551
  2552         16  CF-CLAIM-CONTROL-COUNTS.
  2553             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2554                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2555
  2556             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2557                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2558
  2559             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2560                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2561
  2562             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2563                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2564
  2565         16  CF-CURRENT-MONTH-END           PIC XX.
  2566
  2567         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2568             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2569             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2570             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2571             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2572                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2573                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2574             20  CF-CO-PREM-REJECT-SW       PIC X.
  2575                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2576                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2577             20  CF-CO-REF-REJECT-SW        PIC X.
  2578                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2579                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2580
  2581         16  CF-CO-REPORTING-DT             PIC XX.
  2582         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2583         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2584           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2585           88  CF-CO-MONTH-END                  VALUE '1'.
  2586
  2587         16  CF-LGX-CLAIM-USER              PIC X.
  2588             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2589             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2590
  2591         16  CF-CREDIT-EDIT-CONTROLS.
  2592             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2593             20  CF-MIN-AGE                 PIC 99.
  2594             20  CF-DEFAULT-AGE             PIC 99.
  2595             20  CF-MIN-TERM                PIC S999      COMP-3.
  2596             20  CF-MAX-TERM                PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  47
* EL6317.cbl
  2597             20  CF-DEFAULT-SEX             PIC X.
  2598             20  CF-JOINT-AGE-INPUT         PIC X.
  2599                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2600             20  CF-BIRTH-DATE-INPUT        PIC X.
  2601                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2602             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2603                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2604                 88  CF-ZERO-CARRIER            VALUE '1'.
  2605                 88  CF-ZERO-GROUPING           VALUE '2'.
  2606                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2607             20  CF-EDIT-SW                 PIC X.
  2608                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2609             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2610             20  CF-CR-PR-METHOD            PIC X.
  2611               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2612               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2613             20  FILLER                     PIC X.
  2614
  2615         16  CF-CREDIT-MISC-CONTROLS.
  2616             20  CF-REIN-TABLE-SW           PIC X.
  2617                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2618             20  CF-COMP-TABLE-SW           PIC X.
  2619                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2620             20  CF-EXPERIENCE-RETENTION-AGE
  2621                                            PIC S9        COMP-3.
  2622             20  CF-CONVERSION-DT           PIC XX.
  2623             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2624             20  CF-RUN-FREQUENCY-SW        PIC X.
  2625                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2626                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2627
  2628             20  CF-CR-CHECK-NO-CONTROL.
  2629                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2630                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2631                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2632                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2633                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2634                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2635
  2636                 24  CF-CR-CHECK-COUNT       REDEFINES
  2637                     CF-CR-CHECK-COUNTER      PIC X(4).
  2638
  2639                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2640                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2641
  2642                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2643                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2644                 24  CF-MAIL-PROCESSING       PIC X.
  2645                     88  MAIL-PROCESSING          VALUE 'Y'.
  2646
  2647         16  CF-MISC-SYSTEM-CONTROL.
  2648             20  CF-SYSTEM-C                 PIC X.
  2649                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2650             20  CF-SYSTEM-D                 PIC X.
  2651                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2652             20  CF-SOC-SEC-NO-SW            PIC X.
  2653                 88  SOC-SEC-NO-USED             VALUE '1'.
  2654             20  CF-MEMBER-NO-SW             PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  48
* EL6317.cbl
  2655                 88  MEMBER-NO-USED              VALUE '1'.
  2656             20  CF-TAX-ID-NUMBER            PIC X(11).
  2657             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2658             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2659                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2660                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2661                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2662                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2663             20  CF-SYSTEM-E                 PIC X.
  2664                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2665
  2666         16  CF-LGX-LIFE-USER               PIC X.
  2667             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2668             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2669
  2670         16  CF-CR-MONTH-END-DT             PIC XX.
  2671
  2672         16  CF-FILE-MAINT-DATES.
  2673             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2674                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2675             20  CF-LAST-BATCH       REDEFINES
  2676                 CF-LAST-BATCH-NO               PIC X(4).
  2677             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2678             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2679             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2680             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2681             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2682             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2683             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2684             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2685             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2686             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2687
  2688         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2689         16  FILLER                         PIC X.
  2690
  2691         16  CF-ALT-MORT-CODE               PIC X(4).
  2692         16  CF-MEMBER-CAPTION              PIC X(10).
  2693
  2694         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2695             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2696             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2697             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2698             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2699             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2700
  2701         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2702
  2703         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2704         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2705         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2706         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2707
  2708         16  CF-AH-OVERRIDE-L1              PIC X.
  2709         16  CF-AH-OVERRIDE-L2              PIC XX.
  2710         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2711         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2712
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  49
* EL6317.cbl
  2713         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2714         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2715
  2716         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2717         16  CF-AR-LAST-EL860-DT            PIC XX.
  2718         16  CF-MP-MONTH-END-DT             PIC XX.
  2719
  2720         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2721         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2722             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2723
  2724         16  CF-AR-MONTH-END-DT             PIC XX.
  2725
  2726         16  CF-CRDTCRD-USER                PIC X.
  2727             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2728             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2729
  2730         16  CF-CC-MONTH-END-DT             PIC XX.
  2731
  2732         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2733
  2734         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2735             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2736             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2737             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2738         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2739         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2740         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2741         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2742             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2743             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2744         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2745         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2746         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2747             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2748         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2749
  2750         16  CF-CL-ZIP-CODE.
  2751             20  CF-CL-ZIP-PRIME.
  2752                 24  CF-CL-ZIP-1ST          PIC X.
  2753                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2754                 24  FILLER                 PIC X(4).
  2755             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2756         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2757             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2758             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2759             20  FILLER                     PIC XXX.
  2760
  2761         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2762         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2763         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2764         16  CF-CO-OPTION-START-DATE        PIC XX.
  2765         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2766           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2767                                                      '3' '4'.
  2768           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2769           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2770           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  50
* EL6317.cbl
  2771           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2772           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2773           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2774
  2775         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2776
  2777         16  CF-PAYMENT-APPROVAL-LEVELS.
  2778             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2779             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2780             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2781             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2782             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2783             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2784
  2785         16  CF-END-USER-REPORTING-USER     PIC X.
  2786             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2787             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2788
  2789         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2790             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2791             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2792
  2793         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2794
  2795         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2796         16  FILLER                         PIC X.
  2797
  2798         16  CF-CREDIT-ARCHIVE-CNTL.
  2799             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2800             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2801             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2802
  2803         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2804
  2805         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2806             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2807             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2808
  2809         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2810             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2811             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2812
  2813         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2814
  2815         16  CF-CO-ACH-ID-CODE              PIC  X.
  2816             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2817             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2818             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2819         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2820         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2821         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2822         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2823         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2824         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2825         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2826         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2827         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2828                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  51
* EL6317.cbl
  2829         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2830                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2831
  2832         16  CF-CO-OVER-SHORT.
  2833             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2834             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2835
  2836*         16  FILLER                         PIC X(102).
  2837         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2838             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2839             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2840
  2841         16  CF-AH-APPROVAL-DAYS.
  2842             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2843             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2844             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2845             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2846
  2847         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2848
  2849         16  CF-APPROV-LEV-5.
  2850             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2851             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2852             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2853
  2854         16  FILLER                         PIC X(68).
  2855****************************************************************
  2856*             PROCESSOR/USER RECORD                            *
  2857****************************************************************
  2858
  2859     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2860         16  CF-PROCESSOR-NAME              PIC X(30).
  2861         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2862         16  CF-PROCESSOR-TITLE             PIC X(26).
  2863         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2864                 88  MESSAGE-YES                VALUE 'Y'.
  2865                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2866
  2867*****************************************************
  2868****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2869****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2870****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2871****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2872*****************************************************
  2873
  2874         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2875             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2876             20  CF-APPLICATION-FORCE       PIC X.
  2877             20  CF-INDIVIDUAL-APP.
  2878                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2879                     28  CF-BROWSE-APP      PIC X.
  2880                     28  CF-UPDATE-APP      PIC X.
  2881
  2882         16  CF-CURRENT-TERM-ON             PIC X(4).
  2883         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2884             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2885             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2886             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  52
* EL6317.cbl
  2887             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2888             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2889             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2890             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2891         16  CF-PROCESSOR-CARRIER           PIC X.
  2892             88  NO-CARRIER-SECURITY            VALUE ' '.
  2893         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  2894             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  2895         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  2896             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  2897         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  2898             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  2899
  2900         16  CF-PROC-SYS-ACCESS-SW.
  2901             20  CF-PROC-CREDIT-CLAIMS-SW.
  2902                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  2903                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  2904                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  2905                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  2906             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  2907                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  2908                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  2909             20  CF-PROC-LIFE-GNRLDGR-SW.
  2910                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  2911                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  2912                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  2913                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  2914             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  2915                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  2916                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  2917         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  2918             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  2919             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  2920         16  CF-PROCESSOR-PRINTER               PIC X(4).
  2921
  2922         16  CF-APPROVAL-LEVEL                  PIC X.
  2923             88  APPROVAL-LEVEL-1                   VALUE '1'.
  2924             88  APPROVAL-LEVEL-2                   VALUE '2'.
  2925             88  APPROVAL-LEVEL-3                   VALUE '3'.
  2926             88  APPROVAL-LEVEL-4                   VALUE '4'.
  2927             88  APPROVAL-LEVEL-5                   VALUE '5'.
  2928
  2929         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  2930
  2931         16  CF-LANGUAGE-TYPE                   PIC X.
  2932             88  CF-LANG-IS-ENG                     VALUE 'E'.
  2933             88  CF-LANG-IS-FR                      VALUE 'F'.
  2934
  2935         16  CF-CSR-IND                         PIC X.
  2936         16  FILLER                             PIC X(239).
  2937
  2938****************************************************************
  2939*             PROCESSOR/REMINDERS RECORD                       *
  2940****************************************************************
  2941
  2942     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  2943         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  2944             20  CF-START-REMIND-DT         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  53
* EL6317.cbl
  2945             20  CF-END-REMIND-DT           PIC XX.
  2946             20  CF-REMINDER-TEXT           PIC X(50).
  2947         16  FILLER                         PIC X(296).
  2948
  2949
  2950****************************************************************
  2951*             STATE MASTER RECORD                              *
  2952****************************************************************
  2953
  2954     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2955         16  CF-STATE-ABBREVIATION          PIC XX.
  2956         16  CF-STATE-NAME                  PIC X(25).
  2957         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  2958         16  CF-ST-CALC-QUOTE-TOLERANCE.
  2959             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  2960             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  2961             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  2962             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  2963                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2964                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2965             20  CF-ST-PREM-REJECT-SW       PIC X.
  2966                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  2967                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  2968             20  CF-ST-REF-REJECT-SW        PIC X.
  2969                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  2970                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  2971         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  2972         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  2973         16  CF-ST-REFUND-RULES.
  2974             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  2975             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  2976             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  2977         16  CF-ST-FST-PMT-EXTENSION.
  2978             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  2979             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  2980                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  2981                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  2982                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  2983                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  2984         16  CF-ST-STATE-CALL.
  2985             20  CF-ST-CALL-UNEARNED        PIC X.
  2986             20  CF-ST-CALL-RPT-CNTL        PIC X.
  2987             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  2988         16  CF-REPLACEMENT-LAW-SW          PIC X.
  2989             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  2990             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  2991         16  CF-REPLACEMENT-LETTER          PIC X(4).
  2992         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  2993         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  2994         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  2995         16  CF-ST-SPLIT-PAYMENT            PIC X.
  2996         16  FILLER                         PIC X.
  2997         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  2998             20  CF-ST-BENEFIT-CD           PIC XX.
  2999             20  CF-ST-BENEFIT-KIND         PIC X.
  3000                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3001                 88  CF-ST-AH-KIND              VALUE 'A'.
  3002             20  CF-ST-REM-TERM-CALC        PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  54
* EL6317.cbl
  3003                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3004                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3005                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3006                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3007                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3008                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3009                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3010                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3011
  3012             20  CF-ST-REFUND-CALC          PIC X.
  3013                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3014                 88  ST-REFD-BY-R78             VALUE '1'.
  3015                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3016                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3017                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3018                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3019                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3020                 88  ST-REFD-UTAH               VALUE '7'.
  3021                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3022                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3023                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3024
  3025             20  CF-ST-EARNING-CALC         PIC X.
  3026                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3027                 88  ST-EARN-BY-R78             VALUE '1'.
  3028                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3029                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3030                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3031                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3032                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3033                 88  ST-EARN-MEAN               VALUE '8'.
  3034                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3035
  3036             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3037                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3038                 88  ST-OVRD-BY-R78             VALUE '1'.
  3039                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3040                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3041                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3042                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3043                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3044                 88  ST-OVRD-MEAN               VALUE '8'.
  3045                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3046             20  cf-st-extra-periods        pic 9.
  3047*            20  FILLER                     PIC X.
  3048
  3049         16  CF-ST-COMMISSION-CAPS.
  3050             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3051             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3052             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3053             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3054         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3055                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3056                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  3057                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  3058
  3059         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3060
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  55
* EL6317.cbl
  3061         16  CF-ST-STATUTORY-INTEREST.
  3062             20  CF-ST-STAT-DATE-FROM       PIC X.
  3063                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3064                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3065             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3066             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3067             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3068             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3069             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3070
  3071         16  CF-ST-OVER-SHORT.
  3072             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3073             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3074
  3075         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3076
  3077         16  CF-ST-RT-CALC                  PIC X.
  3078
  3079         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3080         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3081         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3082         16  CF-ST-RF-LR-CALC               PIC X.
  3083         16  CF-ST-RF-LL-CALC               PIC X.
  3084         16  CF-ST-RF-LN-CALC               PIC X.
  3085         16  CF-ST-RF-AH-CALC               PIC X.
  3086         16  CF-ST-RF-CP-CALC               PIC X.
  3087*        16  FILLER                         PIC X(206).
  3088*CIDMOD         16  FILLER                         PIC X(192).
  3089         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3090             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3091         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3092         16  CF-ST-VFY-2ND-BENE             PIC X.
  3093         16  CF-ST-CAUSAL-STATE             PIC X.
  3094         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3095         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3096         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3097             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3098         16  CF-ST-NET-ONLY-STATE           PIC X.
  3099             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3100         16  cf-commission-cap-required     pic x.
  3101         16  CF-ST-GA-COMMISSION-CAPS.
  3102             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  3103             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  3104             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  3105             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  3106         16  CF-ST-TOT-COMMISSION-CAPS.
  3107             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  3108             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  3109             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  3110             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  3111         16  FILLER                         PIC X(156).
  3112
  3113****************************************************************
  3114*             BENEFIT MASTER RECORD                            *
  3115****************************************************************
  3116
  3117     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3118         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  56
* EL6317.cbl
  3119             20  CF-BENEFIT-CODE            PIC XX.
  3120             20  CF-BENEFIT-NUMERIC  REDEFINES
  3121                 CF-BENEFIT-CODE            PIC XX.
  3122             20  CF-BENEFIT-ALPHA           PIC XXX.
  3123             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3124             20  CF-BENEFIT-COMMENT         PIC X(10).
  3125
  3126             20  CF-LF-COVERAGE-TYPE        PIC X.
  3127                 88  CF-REDUCING                VALUE 'R'.
  3128                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3129
  3130             20  CF-SPECIAL-CALC-CD         PIC X.
  3131                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3132                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3133                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3134                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3135                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3136                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3137                 88  CF-FARM-PLAN               VALUE 'F'.
  3138                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3139                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3140                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3141                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3142                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3143                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3144                 88  CF-PRUDENTIAL              VALUE 'P'.
  3145                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3146                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3147                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3148                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3149                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3150                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3151
  3152             20  CF-JOINT-INDICATOR         PIC X.
  3153                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3154
  3155*            20  FILLER                     PIC X(12).
  3156             20  cf-maximum-benefits        pic s999 comp-3.
  3157             20  FILLER                     PIC X(09).
  3158             20  CF-BENEFIT-CATEGORY        PIC X.
  3159             20  CF-LOAN-TYPE               PIC X(8).
  3160
  3161             20  CF-CO-REM-TERM-CALC        PIC X.
  3162                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3163                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3164                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3165                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3166                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3167
  3168             20  CF-CO-EARNINGS-CALC        PIC X.
  3169                 88  CO-EARN-BY-R78             VALUE '1'.
  3170                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3171                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3172                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3173                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3174                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3175                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3176                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  57
* EL6317.cbl
  3177
  3178             20  CF-CO-REFUND-CALC          PIC X.
  3179                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3180                 88  CO-REFD-BY-R78             VALUE '1'.
  3181                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3182                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3183                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3184                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3185                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3186                 88  CO-REFD-MEAN               VALUE '8'.
  3187                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3188                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3189                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3190
  3191             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3192                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3193                 88  CO-OVRD-BY-R78             VALUE '1'.
  3194                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3195                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3196                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3197                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3198                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3199                 88  CO-OVRD-MEAN               VALUE '8'.
  3200                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3201
  3202             20  CF-CO-BEN-I-G-CD           PIC X.
  3203                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3204                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3205                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3206
  3207         16  FILLER                         PIC X(304).
  3208
  3209
  3210****************************************************************
  3211*             CARRIER MASTER RECORD                            *
  3212****************************************************************
  3213
  3214     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3215         16  CF-ADDRESS-DATA.
  3216             20  CF-MAIL-TO-NAME            PIC X(30).
  3217             20  CF-IN-CARE-OF              PIC X(30).
  3218             20  CF-ADDRESS-LINE-1          PIC X(30).
  3219             20  CF-ADDRESS-LINE-2          PIC X(30).
  3220             20  CF-CITY-STATE              PIC X(30).
  3221             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3222             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3223
  3224         16  CF-CLAIM-NO-CONTROL.
  3225             20  CF-CLAIM-NO-METHOD         PIC X.
  3226                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3227                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3228                 88  CLAIM-NO-SEQ               VALUE '3'.
  3229                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3230             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3231                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3232                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3233                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3234
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  58
* EL6317.cbl
  3235         16  CF-CHECK-NO-CONTROL.
  3236             20  CF-CHECK-NO-METHOD         PIC X.
  3237                 88  CHECK-NO-MANUAL            VALUE '1'.
  3238                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3239                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3240                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3241             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3242                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3243
  3244         16  CF-DOMICILE-STATE              PIC XX.
  3245
  3246         16  CF-EXPENSE-CONTROLS.
  3247             20  CF-EXPENSE-METHOD          PIC X.
  3248                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3249                 88  DOLLARS-PER-PMT            VALUE '2'.
  3250                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3251                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3252             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3253             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3254
  3255         16  CF-CORRESPONDENCE-CONTROL.
  3256             20  CF-LETTER-RESEND-OPT       PIC X.
  3257                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3258                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3259             20  FILLER                     PIC X(4).
  3260
  3261         16  CF-RESERVE-CONTROLS.
  3262             20  CF-MANUAL-SW               PIC X.
  3263                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3264             20  CF-FUTURE-SW               PIC X.
  3265                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3266             20  CF-PTC-SW                  PIC X.
  3267                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3268             20  CF-IBNR-SW                 PIC X.
  3269                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3270             20  CF-PTC-LF-SW               PIC X.
  3271                 88  CF-LF-PTC-USED             VALUE '1'.
  3272             20  CF-CDT-ACCESS-METHOD       PIC X.
  3273                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3274                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3275                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3276             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3277
  3278         16  CF-CLAIM-CALC-METHOD           PIC X.
  3279             88  360-PLUS-MONTHS                VALUE '1'.
  3280             88  365-PLUS-MONTHS                VALUE '2'.
  3281             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3282             88  360-DAILY                      VALUE '4'.
  3283             88  365-DAILY                      VALUE '5'.
  3284
  3285         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3286         16  FILLER                         PIC X(11).
  3287
  3288         16  CF-LIMIT-AMOUNTS.
  3289             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3290             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3291             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3292             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  59
* EL6317.cbl
  3293             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3294             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3295             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3296             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3297             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3298             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3299
  3300         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3301         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3302         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3303
  3304         16  CF-ZIP-CODE.
  3305             20  CF-ZIP-PRIME.
  3306                 24  CF-ZIP-1ST             PIC X.
  3307                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3308                 24  FILLER                 PIC X(4).
  3309             20  CF-ZIP-PLUS4               PIC X(4).
  3310         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3311             20  CF-CAN-POSTAL-1            PIC XXX.
  3312             20  CF-CAN-POSTAL-2            PIC XXX.
  3313             20  FILLER                     PIC XXX.
  3314
  3315         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3316         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3317         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3318
  3319         16  CF-RATING-SWITCH               PIC X.
  3320             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3321             88  CF-NO-RATING                   VALUE 'N'.
  3322
  3323         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3324
  3325         16  CF-CARRIER-OVER-SHORT.
  3326             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3327             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3328
  3329         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3330         16  CF-SECPAY-SWITCH               PIC X.
  3331             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3332             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3333         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3334         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3335         16  FILLER                         PIC X(444).
  3336*        16  FILLER                         PIC X(452).
  3337
  3338
  3339****************************************************************
  3340*             MORTALITY MASTER RECORD                          *
  3341****************************************************************
  3342
  3343     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3344         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3345                                INDEXED BY CF-MORT-NDX.
  3346             20  CF-MORT-TABLE              PIC X(5).
  3347             20  CF-MORT-TABLE-TYPE         PIC X.
  3348                 88  CF-MORT-JOINT              VALUE 'J'.
  3349                 88  CF-MORT-SINGLE             VALUE 'S'.
  3350                 88  CF-MORT-COMBINED           VALUE 'C'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  60
* EL6317.cbl
  3351                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3352                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3353             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3354             20  CF-MORT-AGE-METHOD         PIC XX.
  3355                 88  CF-AGE-LAST                VALUE 'AL'.
  3356                 88  CF-AGE-NEAR                VALUE 'AN'.
  3357             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3358             20  CF-MORT-ADJUSTMENT-DIRECTION
  3359                                            PIC X.
  3360                 88  CF-MINUS                   VALUE '-'.
  3361                 88  CF-PLUS                    VALUE '+'.
  3362             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3363             20  CF-MORT-JOINT-CODE         PIC X.
  3364                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3365             20  CF-MORT-PC-Q               PIC X.
  3366                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3367             20  CF-MORT-TABLE-CODE         PIC X(4).
  3368             20  CF-MORT-COMMENTS           PIC X(15).
  3369             20  FILLER                     PIC X(14).
  3370
  3371         16  FILLER                         PIC X(251).
  3372
  3373
  3374****************************************************************
  3375*             BUSSINESS TYPE MASTER RECORD                     *
  3376****************************************************************
  3377
  3378     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3379* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3380* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3381* AND RECORD 05 IS TYPES 81-99
  3382         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3383             20  CF-BUSINESS-TITLE          PIC  X(19).
  3384             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3385                                            PIC S9V9(4) COMP-3.
  3386             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3387             20  FILLER                     PIC  X.
  3388         16  FILLER                         PIC  X(248).
  3389
  3390
  3391****************************************************************
  3392*             TERMINAL MASTER RECORD                           *
  3393****************************************************************
  3394
  3395     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3396
  3397         16  CF-COMPANY-TERMINALS.
  3398             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3399                                  PIC X(4).
  3400         16  FILLER               PIC X(248).
  3401
  3402
  3403****************************************************************
  3404*             LIFE EDIT MASTER RECORD                          *
  3405****************************************************************
  3406
  3407     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3408         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  61
* EL6317.cbl
  3409             20  CF-LIFE-CODE-IN            PIC XX.
  3410             20  CF-LIFE-CODE-OUT           PIC XX.
  3411         16  FILLER                         PIC X(248).
  3412
  3413
  3414****************************************************************
  3415*             AH EDIT MASTER RECORD                            *
  3416****************************************************************
  3417
  3418     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3419         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3420             20  CF-AH-CODE-IN              PIC XXX.
  3421             20  CF-AH-CODE-OUT             PIC XX.
  3422         16  FILLER                         PIC X(248).
  3423
  3424
  3425****************************************************************
  3426*             CREDIBILITY TABLES                               *
  3427****************************************************************
  3428
  3429     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3430         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3431                             INDEXED BY CF-CRDB-NDX.
  3432             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3433             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3434             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3435         16  FILLER                         PIC  X(332).
  3436
  3437
  3438****************************************************************
  3439*             REPORT CUSTOMIZATION RECORD                      *
  3440****************************************************************
  3441
  3442     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3443         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3444             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3445             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3446             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3447**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3448****       A T-TRANSFER.                                   ****
  3449             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3450
  3451         16  FILLER                         PIC XX.
  3452
  3453         16  CF-CARRIER-CNTL-OPT.
  3454             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3455                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3456                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3457             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3458                                            PIC X.
  3459         16  CF-GROUP-CNTL-OPT.
  3460             20  CF-GROUP-OPT-SEQ           PIC 9.
  3461                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3462                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3463             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3464                                            PIC X(6).
  3465         16  CF-STATE-CNTL-OPT.
  3466             20  CF-STATE-OPT-SEQ           PIC 9.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  62
* EL6317.cbl
  3467                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3468                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3469             20  CF-STATE-SELECT OCCURS 3 TIMES
  3470                                            PIC XX.
  3471         16  CF-ACCOUNT-CNTL-OPT.
  3472             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3473                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3474                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3475             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3476                                            PIC X(10).
  3477         16  CF-BUS-TYP-CNTL-OPT.
  3478             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3479                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3480                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3481             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3482                                            PIC XX.
  3483         16  CF-LF-TYP-CNTL-OPT.
  3484             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3485                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3486                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3487             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3488                                            PIC XX.
  3489         16  CF-AH-TYP-CNTL-OPT.
  3490             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3491                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3492                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3493             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3494                                            PIC XX.
  3495         16  CF-REPTCD1-CNTL-OPT.
  3496             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3497                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3498                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3499             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3500                                            PIC X(10).
  3501         16  CF-REPTCD2-CNTL-OPT.
  3502             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3503                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3504                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3505             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3506                                            PIC X(10).
  3507         16  CF-USER1-CNTL-OPT.
  3508             20  CF-USER1-OPT-SEQ           PIC 9.
  3509                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3510                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3511             20  CF-USER1-SELECT OCCURS 3 TIMES
  3512                                            PIC X(10).
  3513         16  CF-USER2-CNTL-OPT.
  3514             20  CF-USER2-OPT-SEQ           PIC 9.
  3515                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3516                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3517             20  CF-USER2-SELECT OCCURS 3 TIMES
  3518                                            PIC X(10).
  3519         16  CF-USER3-CNTL-OPT.
  3520             20  CF-USER3-OPT-SEQ           PIC 9.
  3521                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3522                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3523             20  CF-USER3-SELECT OCCURS 3 TIMES
  3524                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  63
* EL6317.cbl
  3525         16  CF-USER4-CNTL-OPT.
  3526             20  CF-USER4-OPT-SEQ           PIC 9.
  3527                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3528                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3529             20  CF-USER4-SELECT OCCURS 3 TIMES
  3530                                            PIC X(10).
  3531         16  CF-USER5-CNTL-OPT.
  3532             20  CF-USER5-OPT-SEQ           PIC 9.
  3533                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3534                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3535             20  CF-USER5-SELECT OCCURS 3 TIMES
  3536                                            PIC X(10).
  3537         16  CF-REINS-CNTL-OPT.
  3538             20  CF-REINS-OPT-SEQ           PIC 9.
  3539                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3540                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3541             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3542                 24  CF-REINS-PRIME         PIC XXX.
  3543                 24  CF-REINS-SUB           PIC XXX.
  3544
  3545         16  CF-AGENT-CNTL-OPT.
  3546             20  CF-AGENT-OPT-SEQ           PIC 9.
  3547                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3548                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3549             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3550                                            PIC X(10).
  3551
  3552         16  FILLER                         PIC X(43).
  3553
  3554         16  CF-LOSS-RATIO-SELECT.
  3555             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3556             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3557         16  CF-ENTRY-DATE-SELECT.
  3558             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3559             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3560         16  CF-EFFECTIVE-DATE-SELECT.
  3561             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3562             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3563
  3564         16  CF-EXCEPTION-LIST-IND          PIC X.
  3565             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3566
  3567         16  FILLER                         PIC X(318).
  3568
  3569****************************************************************
  3570*                  EXCEPTION REPORTING RECORD                  *
  3571****************************************************************
  3572
  3573     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3574         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3575             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3576
  3577         16  CF-COMBINED-LIFE-AH-OPT.
  3578             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3579             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3580             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3581             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3582
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  64
* EL6317.cbl
  3583         16  CF-LIFE-OPT.
  3584             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3585             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3586             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3587             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3588             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3589             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3590             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3591             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3592             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3593             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3594
  3595         16  CF-AH-OPT.
  3596             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3597             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3598             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3599             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3600             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3601             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3602             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3603             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3604             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3605             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3606
  3607         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3608             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3609             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3610             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3611
  3612         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3613
  3614         16  FILLER                         PIC X(673).
  3615
  3616
  3617****************************************************************
  3618*             MORTGAGE SYSTEM PLAN RECORD                      *
  3619****************************************************************
  3620
  3621     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3622         16  CF-PLAN-TYPE                   PIC X.
  3623             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3624             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3625             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3626         16  CF-PLAN-ABBREV                 PIC XXX.
  3627         16  CF-PLAN-DESCRIPT               PIC X(10).
  3628         16  CF-PLAN-NOTES                  PIC X(20).
  3629         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3630         16  CF-PLAN-UNDERWRITING.
  3631             20  CF-PLAN-TERM-DATA.
  3632                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3633                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3634             20  CF-PLAN-AGE-DATA.
  3635                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3636                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3637                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3638             20  CF-PLAN-BENEFIT-DATA.
  3639                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3640                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  65
* EL6317.cbl
  3641                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3642                                            PIC S9(7)V99  COMP-3.
  3643         16  CF-PLAN-POLICY-FORMS.
  3644             20  CF-POLICY-FORM             PIC X(12).
  3645             20  CF-MASTER-APPLICATION      PIC X(12).
  3646             20  CF-MASTER-POLICY           PIC X(12).
  3647         16  CF-PLAN-RATING.
  3648             20  CF-RATE-CODE               PIC X(5).
  3649             20  CF-SEX-RATING              PIC X.
  3650                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3651                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3652             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3653             20  CF-SUB-STD-TYPE            PIC X.
  3654                 88  CF-PCT-OF-PREM            VALUE '1'.
  3655                 88  CF-PCT-OF-BENE            VALUE '2'.
  3656         16  CF-PLAN-PREM-TOLERANCES.
  3657             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3658             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3659         16  CF-PLAN-PYMT-TOLERANCES.
  3660             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3661             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3662         16  CF-PLAN-MISC-DATA.
  3663             20  FILLER                     PIC X.
  3664             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3665             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3666         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3667         16  CF-PLAN-IND-GRP                PIC X.
  3668             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3669                                                     '1'.
  3670             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3671                                                     '2'.
  3672         16  CF-MIB-SEARCH-SW               PIC X.
  3673             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3674             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3675             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3676             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3677         16  CF-ALPHA-SEARCH-SW             PIC X.
  3678             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3679             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3680             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3681             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3682             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3683             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3684             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3685             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3686             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3687             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3688                                                     'A' 'B' 'C'
  3689                                                     'X' 'Y' 'Z'.
  3690         16  CF-EFF-DT-RULE-SW              PIC X.
  3691             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3692             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3693             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3694             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3695             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3696         16  FILLER                         PIC X(4).
  3697         16  CF-HEALTH-QUESTIONS            PIC X.
  3698             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  66
* EL6317.cbl
  3699         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3700         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3701         16  CF-PLAN-SNGL-JNT               PIC X.
  3702             88  CF-COMBINED-PLAN              VALUE 'C'.
  3703             88  CF-JNT-PLAN                   VALUE 'J'.
  3704             88  CF-SNGL-PLAN                  VALUE 'S'.
  3705         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  3706         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3707         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3708         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3709         16  CF-RERATE-CNTL                 PIC  X.
  3710             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3711             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3712             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3713             88  CF-AUTO-RECALC                 VALUE '4'.
  3714         16  CF-BENEFIT-TYPE                PIC  X.
  3715             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3716             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3717         16  CF-POLICY-FEE                  PIC S999V99
  3718                                                    COMP-3.
  3719         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3720         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3721         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3722         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3723         16  FILLER                         PIC  X(32).
  3724         16  CF-TERMINATION-FORM            PIC  X(04).
  3725         16  FILLER                         PIC  X(08).
  3726         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3727                                                       COMP-3.
  3728         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3729         16  CF-ISSUE-LETTER                PIC  X(4).
  3730         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3731         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3732             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3733             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3734         16  CF-MP-REFUND-CALC              PIC X.
  3735             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3736             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3737             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3738             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3739             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3740             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3741             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3742             88  CF-MP-REFD-MEAN                VALUE '8'.
  3743         16  CF-ALT-RATE-CODE               PIC  X(5).
  3744
  3745
  3746         16  FILLER                         PIC X(498).
  3747****************************************************************
  3748*             MORTGAGE COMPANY MASTER RECORD                   *
  3749****************************************************************
  3750
  3751     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3752         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3753         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3754             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3755             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3756             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  67
* EL6317.cbl
  3757             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3758             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3759
  3760         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3761         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3762         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3763         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  3764         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3765
  3766         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3767             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3768         16  CF-MP-RECON-USE-IND            PIC X(1).
  3769             88  CF-MP-USE-RECON             VALUE 'Y'.
  3770         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3771             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3772         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3773             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3774             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3775         16  FILLER                         PIC X(1).
  3776         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3777             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3778         16  CF-MORTG-MIB-VERSION           PIC X.
  3779             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3780             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3781             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3782         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3783             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3784                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3785             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3786                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3787             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3788                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3789             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3790                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3791             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3792                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3793             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3794                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3795         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3796         16  FILLER                         PIC X(7).
  3797         16  CF-MORTG-DESTINATION-SYMBOL.
  3798             20  CF-MORTG-MIB-COMM          PIC X(5).
  3799             20  CF-MORTG-MIB-TERM          PIC X(5).
  3800         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3801             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3802         16  FILLER                         PIC X(03).
  3803         16  CF-MP-CHECK-NO-CONTROL.
  3804             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3805                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3806                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3807                                                ' ' LOW-VALUES.
  3808                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3809                                               VALUE '3'.
  3810         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3811         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3812         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3813             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3814                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  68
* EL6317.cbl
  3815             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3816                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3817             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3818                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3819             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3820                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3821             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  3822                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3823             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3824                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3825         16  CF-MORTG-BILLING-AREA.
  3826             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3827                                            PIC X.
  3828         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3829         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3830         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3831         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3832             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3833             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3834         16  FILLER                         PIC X.
  3835         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3836             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3837             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3838         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3839         16  FILLER                         PIC X(8).
  3840         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3841         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3842         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3843         16  CF-ACH-COMPANY-ID.
  3844             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3845                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3846                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3847                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3848             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3849         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3850             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3851         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3852             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3853             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3854         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3855         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3856         16  FILLER                         PIC X(536).
  3857
  3858****************************************************************
  3859*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3860****************************************************************
  3861
  3862     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3863         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3864             20  CF-FEMALE-HEIGHT.
  3865                 24  CF-FEMALE-FT           PIC 99.
  3866                 24  CF-FEMALE-IN           PIC 99.
  3867             20  CF-FEMALE-MIN-WT           PIC 999.
  3868             20  CF-FEMALE-MAX-WT           PIC 999.
  3869         16  FILLER                         PIC X(428).
  3870
  3871     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3872         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  69
* EL6317.cbl
  3873             20  CF-MALE-HEIGHT.
  3874                 24  CF-MALE-FT             PIC 99.
  3875                 24  CF-MALE-IN             PIC 99.
  3876             20  CF-MALE-MIN-WT             PIC 999.
  3877             20  CF-MALE-MAX-WT             PIC 999.
  3878         16  FILLER                         PIC X(428).
  3879******************************************************************
  3880*             AUTOMATIC ACTIVITY RECORD                          *
  3881******************************************************************
  3882     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3883         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3884             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3885             20  CF-SYS-LETTER-ID           PIC X(04).
  3886             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3887             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3888             20  CF-SYS-RESET-SW            PIC X(01).
  3889             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3890             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3891
  3892         16  FILLER                         PIC X(50).
  3893
  3894         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  3895             20  CF-USER-ACTIVE-SW          PIC X(01).
  3896             20  CF-USER-LETTER-ID          PIC X(04).
  3897             20  CF-USER-RESEND-DAYS        PIC 9(03).
  3898             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  3899             20  CF-USER-RESET-SW           PIC X(01).
  3900             20  CF-USER-REPORT-DAYS        PIC 9(03).
  3901             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  3902             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  3903
  3904         16  FILLER                         PIC X(246).
  3905*                                COPY ERCPNDB.
  3906******************************************************************
  3907*                                                                *
  3908*                                                                *
  3909*                            ERCPNDB.                            *
  3910*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  3911*                            VMOD=2.025                          *
  3912*                                                                *
  3913*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  3914*                                                                *
  3915******************************************************************
  3916*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  3917*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  3918******************************************************************
  3919*                                                                *
  3920*                                                                *
  3921*   FILE TYPE = VSAM,KSDS                                        *
  3922*   RECORD SIZE = 585  RECFORM = FIXED                           *
  3923*                                                                *
  3924*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  3925*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  3926*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  3927*                                                 RKP=13,LEN=36  *
  3928*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  3929*                                      AND CHG-SEQ.)             *
  3930*                                                RKP=49,LEN=11   *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  70
* EL6317.cbl
  3931*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  3932*                                      AND CHG-SEQ.)             *
  3933*                                                RKP=60,LEN=15   *
  3934*                                                                *
  3935*   LOG = NO                                                     *
  3936*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  3937******************************************************************
  3938******************************************************************
  3939*                   C H A N G E   L O G
  3940*
  3941* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  3942*-----------------------------------------------------------------
  3943*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  3944* EFFECTIVE    NUMBER
  3945*-----------------------------------------------------------------
  3946* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  3947* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  3948* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  3949* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  3950* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  3951* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  3952* 032306                   PEMA  ADD BOW LOAN NUMBER
  3953* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  3954* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  3955* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  3956* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  3957* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  3958* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  3959* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  3960* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  3961* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  3962* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  3963* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  3964* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  3965* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  3966******************************************************************
  3967
  3968 01  PENDING-BUSINESS.
  3969     12  PB-RECORD-ID                     PIC XX.
  3970         88  VALID-PB-ID                        VALUE 'PB'.
  3971
  3972     12  PB-CONTROL-PRIMARY.
  3973         16  PB-COMPANY-CD                PIC X.
  3974         16  PB-ENTRY-BATCH               PIC X(6).
  3975         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  3976         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  3977
  3978     12  PB-CONTROL-BY-ACCOUNT.
  3979         16  PB-COMPANY-CD-A1             PIC X.
  3980         16  PB-CARRIER                   PIC X.
  3981         16  PB-GROUPING.
  3982             20  PB-GROUPING-PREFIX       PIC XXX.
  3983             20  PB-GROUPING-PRIME        PIC XXX.
  3984         16  PB-STATE                     PIC XX.
  3985         16  PB-ACCOUNT.
  3986             20  PB-ACCOUNT-PREFIX        PIC X(4).
  3987             20  PB-ACCOUNT-PRIME         PIC X(6).
  3988         16  PB-CERT-EFF-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  71
* EL6317.cbl
  3989         16  PB-CERT-NO.
  3990             20  PB-CERT-PRIME            PIC X(10).
  3991             20  PB-CERT-SFX              PIC X.
  3992         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  3993
  3994         16  PB-RECORD-TYPE               PIC X.
  3995             88  PB-MAILING-DATA                VALUE '0'.
  3996             88  PB-ISSUE                       VALUE '1'.
  3997             88  PB-CANCELLATION                VALUE '2'.
  3998             88  PB-BATCH-TRAILER               VALUE '9'.
  3999
  4000     12  PB-CONTROL-BY-ORIG-BATCH.
  4001         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4002         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4003         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4004         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4005
  4006     12  PB-CONTROL-BY-CSR.
  4007         16  PB-CSR-COMPANY-CD            PIC X.
  4008         16  PB-CSR-ID                    PIC X(4).
  4009         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4010         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4011         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4012******************************************************************
  4013*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4014******************************************************************
  4015
  4016     12  PB-LAST-MAINT-DT                 PIC XX.
  4017     12  PB-LAST-MAINT-BY                 PIC X(4).
  4018     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4019
  4020     12  PB-RECORD-BODY                   PIC X(375).
  4021
  4022     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4023         16  PB-CERT-ORIGIN               PIC X.
  4024             88  CLASIC-CREATED-CERT         VALUE '1'.
  4025         16  PB-I-NAME.
  4026             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4027             20  PB-I-INSURED-FIRST-NAME.
  4028                 24  PB-I-INSURED-1ST-INIT PIC X.
  4029                 24  FILLER                PIC X(9).
  4030             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4031         16  PB-I-AGE                     PIC S99   COMP-3.
  4032         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4033         16  PB-I-BIRTHDAY                PIC XX.
  4034         16  PB-I-INSURED-SEX             PIC X.
  4035             88  PB-SEX-MALE     VALUE 'M'.
  4036             88  PB-SEX-FEMALE   VALUE 'F'.
  4037
  4038         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4039         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4040         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4041         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4042         16  PB-I-SKIP-CODE               PIC X.
  4043             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4044             88  PB-SKIP-JULY              VALUE '1'.
  4045             88  PB-SKIP-AUGUST            VALUE '2'.
  4046             88  PB-SKIP-SEPTEMBER         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  72
* EL6317.cbl
  4047             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4048             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4049             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4050             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4051             88  PB-SKIP-JUNE              VALUE '8'.
  4052             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4053             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
  4054             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4055         16  PB-I-TERM-TYPE               PIC X.
  4056             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4057             88  PB-PAID-WEEKLY            VALUE 'W'.
  4058             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4059             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4060             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4061         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4062         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4063         16  PB-I-DATA-ENTRY-SW           PIC X.
  4064             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4065             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4066             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4067             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4068         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4069         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4070*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4071         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4072         16  PB-I-LETTER-REQD             PIC X.
  4073
  4074         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4075             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4076             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4077                                                   '90' THRU '99'.
  4078         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4079                                          PIC XX.
  4080         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4081         16  PB-I-AMOUNT-FINANCED REDEFINES
  4082                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4083         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4084         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4085                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4086         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4087         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4088         16  PB-I-CLP-AMOUNT REDEFINES
  4089                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4090         16  PB-I-LF-CALC-FLAG            PIC X.
  4091             88 PB-COMP-LF-PREM               VALUE '?'.
  4092         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4093         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4094         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4095         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4096         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4097         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4098         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4099         16  PB-I-LF-ABBR                 PIC XXX.
  4100         16  PB-I-LF-INPUT-CD             PIC XX.
  4101
  4102         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4103             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4104             88  PB-INVALID-AH               VALUE '  ' '00'
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  73
* EL6317.cbl
  4105                                                   '90' THRU '99'.
  4106         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4107         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4108         16  PB-I-AH-CALC-FLAG            PIC X.
  4109             88 PB-COMP-AH-PREM                  VALUE '?'.
  4110         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4111         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
  4112         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4113         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4114         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4115         16  PB-I-AH-ABBR                 PIC XXX.
  4116         16  PB-I-AH-INPUT-CD             PIC XXX.
  4117
  4118         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4119         16  PB-I-REIN-TABLE              PIC XXX.
  4120         16  PB-I-BUSINESS-TYPE           PIC 99.
  4121         16  PB-I-INDV-GRP-CD             PIC X.
  4122         16  PB-I-MORT-CODE.
  4123             20  PB-I-TABLE               PIC X.
  4124             20  PB-I-INTEREST            PIC XX.
  4125             20  PB-I-MORT-TYP            PIC X.
  4126         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4127         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4128         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4129         16  PB-I-INDV-GRP-OVRD           PIC X.
  4130         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4131         16  PB-I-SIG-SW                  PIC X.
  4132             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4133         16  PB-I-RATE-CLASS              PIC XX.
  4134         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4135         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4136         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4137         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4138         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4139         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4140         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4141         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4142         16  PB-I-OB-FLAG                 PIC X.
  4143             88  PB-I-OB                      VALUE 'B'.
  4144             88  PB-I-SUMMARY                 VALUE 'Z'.
  4145         16  PB-I-ENTRY-STATUS            PIC X.
  4146             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4147                                              'M' '5' '9' '2'.
  4148             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4149             88  PB-I-POLICY-PENDING          VALUE '2'.
  4150             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4151             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4152             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4153             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4154             88  PB-I-REIN-ONLY               VALUE '9'.
  4155             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4156             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4157             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4158             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4159         16  PB-I-INT-CODE                PIC X.
  4160             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4161             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4162         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  74
* EL6317.cbl
  4163         16  PB-I-SOC-SEC-NO              PIC X(11).
  4164         16  PB-I-MEMBER-NO               PIC X(12).
  4165         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4166*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4167         16  PB-I-OLD-LOF                 PIC XXX.
  4168         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4169         16  PB-I-AH-EXPIRE-DT            PIC XX.
  4170         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4171         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4172         16  PB-I-LIFE-INDICATOR          PIC X.
  4173             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4174         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4175         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4176                                          PIC S9(5)V99    COMP-3.
  4177         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4178             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4179             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4180         16  PB-I-1ST-PMT-DT              PIC XX.
  4181         16  PB-I-JOINT-INSURED.
  4182             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4183             20 PB-I-JOINT-FIRST-NAME.
  4184                24  PB-I-JOINT-FIRST-INIT PIC X.
  4185                24  FILLER                PIC X(9).
  4186             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4187*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4188         16  PB-I-BENEFICIARY-NAME.
  4189             20  PB-I-BANK-NUMBER         PIC X(10).
  4190             20  FILLER                   PIC X(15).
  4191         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4192         16  PB-I-REFERENCE               PIC X(12).
  4193         16  FILLER REDEFINES PB-I-REFERENCE.
  4194             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4195             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4196             20  PB-I-CLP-STATE           PIC XX.
  4197         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4198             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4199             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4200             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4201         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4202         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4203         16  PB-I-RESIDENT-STATE          PIC XX.
  4204         16  PB-I-RATE-CODE               PIC X(4).
  4205         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4206         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4207         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4208         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4209         16  PB-I-BANK-NOCHRGB            PIC 99.
  4210         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4211         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4212
  4213     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4214         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4215             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4216         16  PB-C-CANCEL-ORIGIN           PIC X.
  4217             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4218         16  PB-C-LF-CANCEL-DT            PIC XX.
  4219         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4220         16  PB-C-LF-CALC-REQ             PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  75
* EL6317.cbl
  4221             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4222         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4223         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4224         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4225             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4226         16  PB-C-AH-CANCEL-DT            PIC XX.
  4227         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4228         16  PB-C-AH-CALC-REQ             PIC X.
  4229             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4230         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4231         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4232         16  PB-C-LAST-NAME               PIC X(15).
  4233         16  PB-C-REFUND-SW               PIC X.
  4234             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4235             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4236         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4237         16  PB-C-PAYEE-CODE              PIC X(6).
  4238         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4239         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4240         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4241         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4242         16  PB-C-REFERENCE               PIC X(12).
  4243         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4244         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4245         16  PB-C-POST-CARD-IND           PIC X.
  4246         16  PB-C-CANCEL-REASON           PIC X.
  4247         16  PB-C-REF-INTERFACE-SW        PIC X.
  4248         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4249         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4250         16  FILLER                       PIC X(01).
  4251*        16  FILLER                       PIC X(18).
  4252         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4253*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4254         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4255         16  PB-CANCELED-CERT-DATA.
  4256             20  PB-CI-INSURED-NAME.
  4257                 24  PB-CI-LAST-NAME      PIC X(15).
  4258                 24  PB-CI-INITIALS       PIC XX.
  4259             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4260             20  PB-CI-INSURED-SEX        PIC X.
  4261             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4262             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4263             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4264             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4265             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4266             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4267             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4268             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4269             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4270             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4271             20  PB-CI-RATE-CLASS         PIC XX.
  4272             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4273             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4274             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4275             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4276             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4277             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4278             20  PB-CI-LF-ABBR            PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  76
* EL6317.cbl
  4279             20  PB-CI-AH-ABBR            PIC X(3).
  4280             20  PB-CI-OB-FLAG            PIC X.
  4281                 88  PB-CI-OB                VALUE 'B'.
  4282             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4283                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4284                                           'M' '4' '5' '9' '2'.
  4285                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
  4286                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4287                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4288                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4289                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4290                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4291                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4292                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4293                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4294                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4295                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4296                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4297                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4298             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4299                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4300                                           'M' '4' '5' '9' '2'.
  4301                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4302                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4303                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4304                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4305                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4306                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4307                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4308                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4309                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4310                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4311                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4312                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4313                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4314             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4315             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4316             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4317             20  PB-CI-MEMBER-NO          PIC X(12).
  4318             20  PB-CI-INT-CODE           PIC X.
  4319                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4320                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4321             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4322             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4323             20  PB-CI-COMP-EXCP-SW       PIC X.
  4324                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4325                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4326             20  PB-CI-ENTRY-STATUS       PIC X.
  4327             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4328             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4329             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4330             20  PB-CI-DEATH-DT           PIC XX.
  4331             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4332             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4333             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4334             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4335             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4336             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  77
* EL6317.cbl
  4337             20  PB-CI-ENTRY-DT              PIC XX.
  4338             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4339             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4340             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4341             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4342             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4343             20  PB-CI-OLD-LOF               PIC XXX.
  4344*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4345             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4346             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4347             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4348             20  PB-CI-INDV-GRP-CD           PIC X.
  4349             20  PB-CI-BENEFICIARY-NAME.
  4350                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4351                 24  FILLER                  PIC X(15).
  4352             20  PB-CI-NOTE-SW               PIC X.
  4353             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4354             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4355             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4356             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4357             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4358             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4359             20  PB-CI-FIRST-NAME            PIC X(10).
  4360             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4361
  4362         16  FILLER                       PIC X(13).
  4363*032306  16  FILLER                       PIC X(27).
  4364*        16  FILLER                       PIC X(46).
  4365
  4366     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4367         16  FILLER                       PIC X(10).
  4368         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4369         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4370         16  PB-M-INSURED-MID-INIT        PIC X.
  4371         16  PB-M-INSURED-AGE             PIC 99.
  4372         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4373         16  PB-M-INSURED-SEX             PIC X.
  4374         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4375         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4376         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4377         16  PB-M-INSURED-CITY-STATE.
  4378             20  PB-M-INSURED-CITY        PIC X(28).
  4379             20  PB-M-INSURED-STATE       PIC XX.
  4380         16  PB-M-INSURED-ZIP-CODE.
  4381             20  PB-M-INSURED-ZIP-PRIME.
  4382                 24  PB-M-INSURED-ZIP-1   PIC X.
  4383                     88  PB-M-CANADIAN-POST-CODE
  4384                                             VALUE 'A' THRU 'Z'.
  4385                 24  FILLER               PIC X(4).
  4386             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4387         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4388                                        PB-M-INSURED-ZIP-CODE.
  4389             20  PM-M-INS-CAN-POST1       PIC XXX.
  4390             20  PM-M-INS-CAN-POST2       PIC XXX.
  4391             20  FILLER                   PIC XXX.
  4392         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4393         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4394         16  PB-M-CRED-BENE-NAME          PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  78
* EL6317.cbl
  4395         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4396         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4397         16  PB-M-CRED-BENE-CITYST.
  4398             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4399             20  PB-M-CRED-BENE-STATE     PIC XX.
  4400         16  FILLER                       PIC X(92).
  4401
  4402     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4403         16  FILLER                       PIC X(10).
  4404         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4405         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4406         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4407         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4408         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4409         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4410         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4411         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4412         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4413         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4414         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4415         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4416         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4417         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4418         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4419         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4420         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4421         16  PB-ACCOUNT-NAME              PIC X(30).
  4422         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4423         16  PB-REFERENCE                 PIC X(12).
  4424         16  PB-B-RECEIVED-DT             PIC XX.
  4425         16  FILLER                       PIC X(234).
  4426
  4427     12  PB-RECORD-STATUS.
  4428         16  PB-CREDIT-SELECT-DT          PIC XX.
  4429         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4430         16  PB-BILLED-DT                 PIC XX.
  4431         16  PB-BILLING-STATUS            PIC X.
  4432             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4433             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4434             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4435         16  PB-RECORD-BILL               PIC X.
  4436             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4437             88  PB-RECORD-RETURNED           VALUE 'R'.
  4438             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4439             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4440             88  PB-OVERRIDE-AH               VALUE 'A'.
  4441             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4442         16  PB-BATCH-ENTRY               PIC X.
  4443             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4444             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4445             88  PB-REISSUED-CERT             VALUE 'E'.
  4446             88  PB-CASH-CERT                 VALUE 'C'.
  4447             88  PB-MONTHLY-CERT              VALUE 'M'.
  4448             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4449             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4450             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4451         16  PB-FORCE-CODE                PIC X.
  4452             88  PB-FORCE-OFF                 VALUE ' ' '0'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  79
* EL6317.cbl
  4453             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4454             88  PB-CANCEL-FORCE              VALUE '8'.
  4455             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4456             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4457             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4458             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4459             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
  4460             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4461             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4462             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4463         16  PB-FATAL-FLAG                PIC X.
  4464             88  PB-FATAL-ERRORS              VALUE 'X'.
  4465         16  PB-FORCE-ER-CD               PIC X.
  4466             88  PB-FORCE-ERRORS              VALUE 'F'.
  4467             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4468         16  PB-WARN-ER-CD                PIC X.
  4469             88  PB-WARNING-ERRORS            VALUE 'W'.
  4470         16  FILLER                       PIC X.
  4471         16  PB-OUT-BAL-CD                PIC X.
  4472             88  PB-OUT-OF-BAL                VALUE 'O'.
  4473         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4474         16  PB-AH-OVERRIDE-L1            PIC X.
  4475         16  PB-INPUT-DT                  PIC XX.
  4476         16  PB-INPUT-BY                  PIC X(4).
  4477         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4478         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4479         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4480         16  PB-LF-EARNING-METHOD         PIC X.
  4481         16  PB-AH-EARNING-METHOD         PIC X.
  4482         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4483         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4484         16  PB-REIN-CD                   PIC XXX.
  4485         16  PB-LF-REFUND-TYPE            PIC X.
  4486         16  PB-AH-REFUND-TYPE            PIC X.
  4487         16  PB-ACCT-EFF-DT               PIC XX.
  4488         16  PB-ACCT-EXP-DT               PIC XX.
  4489         16  PB-COMPANY-ID                PIC X(3).
  4490         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4491         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4492         16  PB-SV-CARRIER                PIC X.
  4493         16  PB-SV-GROUPING               PIC X(6).
  4494         16  PB-SV-STATE                  PIC XX.
  4495         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4496         16  PB-GA-BILLING-INFO.
  4497             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4498                                          PIC XX.
  4499         16  PB-SV-REMIT-TO  REDEFINES
  4500             PB-GA-BILLING-INFO           PIC X(10).
  4501         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4502         16  PB-I-LOAN-OFFICER            PIC X(5).
  4503         16  PB-I-VIN                     PIC X(17).
  4504
  4505         16  FILLER                       PIC X(04).
  4506         16  IMNET-BYPASS-SW              PIC X.
  4507
  4508******************************************************************
  4509*                COMMON EDIT ERRORS                              *
  4510******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  80
* EL6317.cbl
  4511
  4512     12  PB-COMMON-ERRORS.
  4513         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4514                                           PIC S9(4)     COMP.
  4515
  4516******************************************************************
  4517*                                COPY ELCCERT.
  4518******************************************************************
  4519*                                                                *
  4520*                            ELCCERT.                            *
  4521*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4522*                            VMOD=2.013                          *
  4523*                                                                *
  4524*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4525*                                                                *
  4526*   FILE TYPE = VSAM,KSDS                                        *
  4527*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4528*                                                                *
  4529*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4530*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4531*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4532*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4533*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4534*                                                                *
  4535*   LOG = YES                                                    *
  4536*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4537******************************************************************
  4538*                   C H A N G E   L O G
  4539*
  4540* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4541*-----------------------------------------------------------------
  4542*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4543* EFFECTIVE    NUMBER
  4544*-----------------------------------------------------------------
  4545* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4546* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4547* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4548* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4549* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4550* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4551* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4552* 032612  CR2011110200001  PEMA  AHL CHANGES
  4553* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4554* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4555* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4556******************************************************************
  4557
  4558 01  CERTIFICATE-MASTER.
  4559     12  CM-RECORD-ID                      PIC XX.
  4560         88  VALID-CM-ID                      VALUE 'CM'.
  4561
  4562     12  CM-CONTROL-PRIMARY.
  4563         16  CM-COMPANY-CD                 PIC X.
  4564         16  CM-CARRIER                    PIC X.
  4565         16  CM-GROUPING.
  4566             20  CM-GROUPING-PREFIX        PIC X(3).
  4567             20  CM-GROUPING-PRIME         PIC X(3).
  4568         16  CM-STATE                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  81
* EL6317.cbl
  4569         16  CM-ACCOUNT.
  4570             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4571             20  CM-ACCOUNT-PRIME          PIC X(6).
  4572         16  CM-CERT-EFF-DT                PIC XX.
  4573         16  CM-CERT-NO.
  4574             20  CM-CERT-PRIME             PIC X(10).
  4575             20  CM-CERT-SFX               PIC X.
  4576
  4577     12  CM-CONTROL-BY-NAME.
  4578         16  CM-COMPANY-CD-A1              PIC X.
  4579         16  CM-INSURED-LAST-NAME          PIC X(15).
  4580         16  CM-INSURED-INITIALS.
  4581             20  CM-INSURED-INITIAL1       PIC X.
  4582             20  CM-INSURED-INITIAL2       PIC X.
  4583
  4584     12  CM-CONTROL-BY-SSN.
  4585         16  CM-COMPANY-CD-A2              PIC X.
  4586         16  CM-SOC-SEC-NO.
  4587             20  CM-SSN-STATE              PIC XX.
  4588             20  CM-SSN-ACCOUNT            PIC X(6).
  4589             20  CM-SSN-LN3.
  4590                 25  CM-INSURED-INITIALS-A2.
  4591                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4592                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4593                 25 CM-PART-LAST-NAME-A2         PIC X.
  4594
  4595     12  CM-CONTROL-BY-CERT-NO.
  4596         16  CM-COMPANY-CD-A4              PIC X.
  4597         16  CM-CERT-NO-A4                 PIC X(11).
  4598
  4599     12  CM-CONTROL-BY-MEMB.
  4600         16  CM-COMPANY-CD-A5              PIC X.
  4601         16  CM-MEMBER-NO.
  4602             20  CM-MEMB-STATE             PIC XX.
  4603             20  CM-MEMB-ACCOUNT           PIC X(6).
  4604             20  CM-MEMB-LN4.
  4605                 25  CM-INSURED-INITIALS-A5.
  4606                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4607                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4608                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4609
  4610     12  CM-INSURED-PROFILE-DATA.
  4611         16  CM-INSURED-FIRST-NAME.
  4612             20  CM-INSURED-1ST-INIT       PIC X.
  4613             20  FILLER                    PIC X(9).
  4614         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4615         16  CM-INSURED-SEX                PIC X.
  4616             88  CM-SEX-MALE                  VALUE 'M'.
  4617             88  CM-SEX-FEMAL                 VALUE 'F'.
  4618         16  CM-INSURED-JOINT-AGE          PIC 99.
  4619         16  CM-JOINT-INSURED-NAME.
  4620             20  CM-JT-LAST-NAME           PIC X(15).
  4621             20  CM-JT-FIRST-NAME.
  4622                 24  CM-JT-1ST-INIT        PIC X.
  4623                 24  FILLER                PIC X(9).
  4624             20  CM-JT-INITIAL             PIC X.
  4625
  4626     12  CM-LIFE-DATA.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  82
* EL6317.cbl
  4627         16  CM-LF-BENEFIT-CD              PIC XX.
  4628         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4629         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4630         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4631         16  CM-LF-DEV-CODE                PIC XXX.
  4632         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4633         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
  4634         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4635         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4636         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4637         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4638         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4639         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4640         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4641         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4642         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4643         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4644         16  cm-temp-epiq                  pic xx.
  4645             88  EPIQ-CLASS                  value 'EQ'.
  4646*        16  FILLER                        PIC XX.
  4647
  4648     12  CM-AH-DATA.
  4649         16  CM-AH-BENEFIT-CD              PIC XX.
  4650         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4651         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4652         16  CM-AH-DEV-CODE                PIC XXX.
  4653         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4654         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4655         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4656         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4657         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4658         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4659         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4660         16  CM-AH-PAID-THRU-DT            PIC XX.
  4661             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4662         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4663         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4664         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4665         16  FILLER                        PIC X.
  4666
  4667     12  CM-LOAN-INFORMATION.
  4668         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4669         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4670                                           PIC S9(5)V99  COMP-3.
  4671         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4672         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4673         16  CM-PAY-FREQUENCY              PIC S99.
  4674         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4675         16  CM-RATE-CLASS                 PIC XX.
  4676         16  CM-BENEFICIARY                PIC X(25).
  4677         16  CM-POLICY-FORM-NO             PIC X(12).
  4678         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4679         16  CM-LAST-ADD-ON-DT             PIC XX.
  4680         16  CM-DEDUCTIBLE-AMOUNTS.
  4681             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4682             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4683         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4684             20  CM-RESIDENT-STATE         PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  83
* EL6317.cbl
  4685             20  CM-RATE-CODE              PIC X(4).
  4686             20  FILLER                    PIC XX.
  4687         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4688             20  CM-LOAN-OFFICER           PIC X(5).
  4689             20  FILLER                    PIC XXX.
  4690         16  CM-CSR-CODE                   PIC XXX.
  4691         16  CM-UNDERWRITING-CODE          PIC X.
  4692             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4693         16  CM-POST-CARD-IND              PIC X.
  4694         16  CM-REF-INTERFACE-SW           PIC X.
  4695         16  CM-PREMIUM-TYPE               PIC X.
  4696             88  CM-SING-PRM                  VALUE '1'.
  4697             88  CM-O-B-COVERAGE              VALUE '2'.
  4698             88  CM-OPEN-END                  VALUE '3'.
  4699         16  CM-IND-GRP-TYPE               PIC X.
  4700             88  CM-INDIVIDUAL                VALUE 'I'.
  4701             88  CM-GROUP                     VALUE 'G'.
  4702         16  CM-SKIP-CODE                  PIC X.
  4703             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4704             88  SKIP-JULY                    VALUE '1'.
  4705             88  SKIP-AUGUST                  VALUE '2'.
  4706             88  SKIP-SEPTEMBER               VALUE '3'.
  4707             88  SKIP-JULY-AUG                VALUE '4'.
  4708             88  SKIP-AUG-SEPT                VALUE '5'.
  4709             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4710             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4711             88  SKIP-JUNE                    VALUE '8'.
  4712             88  SKIP-JUNE-JULY               VALUE '9'.
  4713             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4714             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4715         16  CM-PAYMENT-MODE               PIC X.
  4716             88  PAY-MONTHLY                  VALUE SPACE.
  4717             88  PAY-WEEKLY                   VALUE '1'.
  4718             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4719             88  PAY-BI-WEEKLY                VALUE '3'.
  4720             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4721         16  CM-LOAN-NUMBER                PIC X(8).
  4722         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4723         16  CM-OLD-LOF                    PIC XXX.
  4724*        16  CM-LOAN-OFFICER               PIC XXX.
  4725         16  CM-REIN-TABLE                 PIC XXX.
  4726         16  CM-SPECIAL-REIN-CODE          PIC X.
  4727         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4728         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4729         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4730
  4731     12  CM-STATUS-DATA.
  4732         16  CM-ENTRY-STATUS               PIC X.
  4733         16  CM-ENTRY-DT                   PIC XX.
  4734
  4735         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4736         16  CM-LF-CANCEL-DT               PIC XX.
  4737         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4738
  4739         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4740         16  CM-LF-DEATH-DT                PIC XX.
  4741         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4742
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  84
* EL6317.cbl
  4743         16  CM-LF-CURRENT-STATUS          PIC X.
  4744             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4745                                                'M' '4' '5' '9'.
  4746             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4747             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4748             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4749             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
  4750             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4751             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4752             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4753             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4754             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4755             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4756             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4757             88  CM-LF-DECLINED               VALUE 'D'.
  4758             88  CM-LF-VOIDED                 VALUE 'V'.
  4759
  4760         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4761         16  CM-AH-CANCEL-DT               PIC XX.
  4762         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4763
  4764         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4765         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4766         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4767
  4768         16  CM-AH-CURRENT-STATUS          PIC X.
  4769             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4770                                                'M' '4' '5' '9'.
  4771             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4772             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4773             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4774             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4775             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4776             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4777             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4778             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4779             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4780             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4781             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4782             88  CM-AH-DECLINED               VALUE 'D'.
  4783             88  CM-AH-VOIDED                 VALUE 'V'.
  4784
  4785         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4786             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4787             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4788             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4789         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4790
  4791         16  CM-ENTRY-BATCH                PIC X(6).
  4792         16  CM-LF-EXIT-BATCH              PIC X(6).
  4793         16  CM-AH-EXIT-BATCH              PIC X(6).
  4794         16  CM-LAST-MONTH-END             PIC XX.
  4795
  4796     12  CM-NOTE-SW                        PIC X.
  4797         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4798         88  CERT-NOTES-PRESENT               VALUE '1'.
  4799         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4800         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  85
* EL6317.cbl
  4801         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4802         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4803         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4804         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4805     12  CM-COMP-EXCP-SW                   PIC X.
  4806         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4807         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
  4808     12  CM-INSURED-ADDRESS-SW             PIC X.
  4809         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4810         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4811
  4812*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4813     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4814     12  FILLER                            PIC X.
  4815
  4816*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4817     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4818     12  FILLER                            PIC X.
  4819*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4820     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  4821
  4822     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4823         88  CERT-ADDED-BATCH                 VALUE ' '.
  4824         88  CERT-ADDED-ONLINE                VALUE '1'.
  4825         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4826         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4827         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4828     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4829         88  CERT-AS-LOADED                   VALUE ' '.
  4830         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4831         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4832         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4833         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4834         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4835         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4836         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4837
  4838     12  CM-ACCOUNT-COMM-PCTS.
  4839         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4840         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4841
  4842     12  CM-USER-FIELD                     PIC X.
  4843     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4844     12  CM-CLP-STATE                      PIC XX.
  4845     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4846     12  CM-USER-RESERVED                  PIC XXX.
  4847     12  FILLER REDEFINES CM-USER-RESERVED.
  4848         16  CM-AH-CLASS-CD                PIC XX.
  4849         16  F                             PIC X.
  4850******************************************************************
  4851*                                COPY ELCCRTO.
  4852******************************************************************
  4853*                                                                *
  4854*                            ELCCRTO.                            *
  4855*                                                                *
  4856*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4857*                                                                *
  4858*   FILE TYPE = VSAM,KSDS                                        *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  86
* EL6317.cbl
  4859*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4860*                                                                *
  4861*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4862*                                                                *
  4863*   LOG = YES                                                    *
  4864*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4865******************************************************************
  4866*                   C H A N G E   L O G
  4867*
  4868* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4869*-----------------------------------------------------------------
  4870*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4871* EFFECTIVE    NUMBER
  4872*-----------------------------------------------------------------
  4873* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4874* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4875* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4876* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4877* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4878******************************************************************
  4879 01  ORIGINAL-CERTIFICATE.
  4880     12  OC-RECORD-ID                      PIC XX.
  4881         88  VALID-OC-ID                      VALUE 'OC'.
  4882     12  OC-CONTROL-PRIMARY.
  4883         16  OC-COMPANY-CD                 PIC X.
  4884         16  OC-CARRIER                    PIC X.
  4885         16  OC-GROUPING                   PIC X(6).
  4886         16  OC-STATE                      PIC XX.
  4887         16  OC-ACCOUNT                    PIC X(10).
  4888         16  OC-CERT-EFF-DT                PIC XX.
  4889         16  OC-CERT-NO.
  4890             20  OC-CERT-PRIME             PIC X(10).
  4891             20  OC-CERT-SFX               PIC X.
  4892         16  OC-RECORD-TYPE                PIC X.
  4893         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  4894     12  OC-LAST-MAINT-DT                  PIC XX.
  4895     12  OC-LAST-MAINT-BY                  PIC X(4).
  4896     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  4897     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  4898     12  FILLER                            PIC X(49).
  4899     12  OC-ORIG-REC.
  4900         16  OC-INS-LAST-NAME              PIC X(15).
  4901         16  OC-INS-FIRST-NAME             PIC X(10).
  4902         16  OC-INS-MIDDLE-INIT            PIC X.
  4903         16  OC-INS-AGE                    PIC S999     COMP-3.
  4904         16  OC-JNT-LAST-NAME              PIC X(15).
  4905         16  OC-JNT-FIRST-NAME             PIC X(10).
  4906         16  OC-JNT-MIDDLE-INIT            PIC X.
  4907         16  OC-JNT-AGE                    PIC S999     COMP-3.
  4908         16  OC-LF-BENCD                   PIC XX.
  4909         16  OC-LF-TERM                    PIC S999      COMP-3.
  4910         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4911         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4912         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  4913         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  4914         16  OC-LF-EXP-DT                  PIC XX.
  4915         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  4916         16  OC-LF-CANCEL-DT               PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  87
* EL6317.cbl
  4917         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4918         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4919         16  OC-AH-BENCD                   PIC XX.
  4920         16  OC-AH-TERM                    PIC S999      COMP-3.
  4921         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  4922         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  4923         16  OC-AH-EXP-DT                  PIC XX.
  4924         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4925         16  OC-AH-CP                      PIC 99.
  4926         16  OC-AH-CANCEL-DT               PIC XX.
  4927         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  4928         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4929         16  OC-CRED-BENE-NAME             PIC X(25).
  4930         16  OC-1ST-PMT-DT                 PIC XX.
  4931         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  4932         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  4933         16  OC-ISSUE-TRAN-IND             PIC X.
  4934         16  OC-CANCEL-TRAN-IND            PIC X.
  4935         16  FILLER                        PIC X(211).
  4936
  4937     12  FILLER                            PIC X(50).
  4938******************************************************************
  4939*                                COPY ERCENDT.
  4940******************************************************************
  4941*                                                                *
  4942*                                                                *
  4943*                            ERCENDT.                            *
  4944*                            VMOD=2.001                          *
  4945*                                                                *
  4946*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  4947*                                                                *
  4948*   FILE TYPE = VSAM,KSDS                                        *
  4949*   RECORD SIZE = 579  RECFORM = FIXED                           *
  4950*                                                                *
  4951*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  4952*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  4953*                                                                *
  4954*   LOG = NO                                                     *
  4955*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4956******************************************************************
  4957*-----------------------------------------------------------------
  4958*                   C H A N G E   L O G
  4959*
  4960* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4961*-----------------------------------------------------------------
  4962*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4963* EFFECTIVE    NUMBER
  4964*-----------------------------------------------------------------
  4965* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  4966*                                WITH OPEN CLAIMS
  4967* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  4968* 110612    2012101700002  AJRA  ADD NEW FIELDS
  4969* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4970* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  4971*-----------------------------------------------------------------
  4972 01  ENDORSEMENT-RECORD.
  4973     12  EN-RECORD-ID                PIC XX.
  4974         88  VALID-EN-ID                VALUE 'EN'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  88
* EL6317.cbl
  4975     12  EN-CONTROL-PRIMARY.
  4976         16  EN-COMPANY-CD           PIC X.
  4977         16  EN-CARRIER              PIC X.
  4978         16  EN-GROUPING             PIC X(6).
  4979         16  EN-STATE                PIC XX.
  4980         16  EN-ACCOUNT              PIC X(10).
  4981         16  EN-CERT-EFF-DT          PIC XX.
  4982         16  EN-CERT-NO.
  4983             20  EN-CERT-PRIME       PIC X(10).
  4984             20  EN-CERT-SFX         PIC X.
  4985         16  EN-REC-TYPE             PIC X.
  4986             88  EN-ISSUE               VALUE 'I'.
  4987             88  EN-CANCELLATION        VALUE 'C'.
  4988         16  EN-SEQ-NO               PIC 9(04) BINARY.
  4989     12  EN-CONTROL-BY-ARCH-NO.
  4990         16  EN-COMPANY-CD-A1              PIC X.
  4991         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  4992     12  EN-LAST-MAINT-DT            PIC XX.
  4993     12  EN-LAST-MAINT-BY            PIC X(4).
  4994     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  4995     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  4996     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  4997         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  4998         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  4999         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  5000         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  5001         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  5002         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  5003         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  5004         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  5005         16  EN-LF-ORIG-BENCD        PIC XX.
  5006         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  5007         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5008         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5009         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  5010         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  5011         16  EN-LF-ORIG-EXP-DT       PIC XX.
  5012*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  5013         16  EN-ORIG-CRED-BENE       PIC X(25).
  5014         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5015         16  FILLER                  PIC X.
  5016         16  EN-AH-ORIG-BENCD        PIC XX.
  5017         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  5018         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5019         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5020         16  EN-AH-ORIG-EXP-DT       PIC XX.
  5021*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  5022*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  5023         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5024         16  F                       PIC X(09).
  5025         16  EN-AH-ORIG-CP           PIC 99.
  5026         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  5027         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  5028         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  5029         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5030         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5031         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5032         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  89
* EL6317.cbl
  5033         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5034         16  EN-LF-NEW-BENCD         PIC XX.
  5035         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5036         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5037         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5038         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5039         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
  5040         16  EN-LF-NEW-EXP-DT        PIC XX.
  5041         16  EN-NEW-CRED-BENE        PIC X(25).
  5042         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5043         16  FILLER                  PIC X.
  5044         16  EN-AH-NEW-BENCD         PIC XX.
  5045         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5046         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5047         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5048         16  EN-AH-NEW-EXP-DT        PIC XX.
  5049*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5050*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5051*        16  F                       PIC X(12).
  5052         16  EN-AH-NEW-CP            PIC 99.
  5053         16  EN-SIG-SW               PIC X.
  5054         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5055         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5056         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5057         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5058         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5059         16  FILLER                  PIC X(33).
  5060     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5061         16  EN-LF-ORIG-REF-DT       PIC XX.
  5062         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5063         16  EN-AH-ORIG-REF-DT       PIC XX.
  5064         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5065         16  EN-LF-NEW-REF-DT        PIC XX.
  5066         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5067         16  EN-AH-NEW-REF-DT        PIC XX.
  5068         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5069         16  EN-FLAG-CERT            PIC X.
  5070         16  EN-INS-LAST-NAME        PIC X(15).
  5071         16  EN-INS-FIRST-NAME       PIC X(10).
  5072         16  EN-INS-MIDDLE-INIT      PIC X.
  5073         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5074         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5075         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5076         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5077         16  FILLER                  PIC X(262).
  5078     12  EN-MONEY-SW             PIC X.
  5079     12  EN-HEALTH-APP           PIC X.
  5080     12  EN-VOUCHER-SW           PIC X.
  5081     12  EN-PAYEE                PIC X(14).
  5082     12  EN-INPUT-DT             PIC XX.
  5083     12  EN-PROCESS-DT           PIC XX.
  5084     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5085     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5086     12  EN-REASON-CODES.
  5087         16  F OCCURS 12.
  5088             20  EN-REASON-CODE  PIC X(4).
  5089     12  EN-TEMPLATE-USED        PIC X(8).
  5090     12  EN-DOCU-TYPE            PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  90
* EL6317.cbl
  5091         88  EN-VERI-DOCU          VALUE 'V'.
  5092         88  EN-GCE-DOCU           VALUE 'G'.
  5093         88  EN-CANC-DOCU          VALUE 'C'.
  5094     12  EN-COMMENTS1            PIC X(13).
  5095     12  EN-COMMENTS2            PIC X(70).
  5096     12  EN-COMM-CHGBK           PIC X.
  5097         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
  5098         88  EN-CHG-ACCT           VALUE 'Y'.
  5099     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5100     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5101     12  EN-BATCH-NUMBER         PIC X(6).
  5102     12  EN-ACCT-SUMM            PIC X.
  5103     12  EN-CSO-SUMM             PIC X.
  5104     12  en-check-type           pic x.
  5105     12  FILLER                  PIC X(12).
  5106******************************************************************
  5107*                                COPY ERCNOTE.
  5108******************************************************************
  5109*                                                                *
  5110*                                                                *
  5111*                            ERCNOTE                             *
  5112*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5113*                            VMOD=2.003                          *
  5114*                                                                *
  5115*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5116*                                                                *
  5117*        FILE TYPE= VSAM,KSDS                                    *
  5118*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5119*                                                                *
  5120*        BASE CLUSTER = ERNOTE        RKP=2,LEN=34               *
  5121*                                                                *
  5122*        LOG = YES                                               *
  5123*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5124*                                                                *
  5125******************************************************************
  5126*                   C H A N G E   L O G
  5127*
  5128* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5129*-----------------------------------------------------------------
  5130*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5131* EFFECTIVE    NUMBER
  5132*-----------------------------------------------------------------
  5133* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5134*                                FILE WILL CONTAIN BILLING NOTES O
  5135* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
  5136******************************************************************
  5137
  5138 01  CERTIFICATE-NOTE.
  5139     12  CN-RECORD-ID                PIC  XX.
  5140         88  VALID-CN-ID                  VALUE 'CN'.
  5141
  5142     12  CN-CONTROL-PRIMARY.
  5143         16  CN-COMPANY-CD           PIC X.
  5144         16  CN-CARRIER              PIC X.
  5145         16  CN-GROUPING.
  5146             20 CN-GROUPING-PREFIX   PIC XXX.
  5147             20 CN-GROUPING-PRIME    PIC XXX.
  5148         16  CN-STATE                PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  91
* EL6317.cbl
  5149         16  CN-ACCOUNT.
  5150             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5151             20 CN-ACCOUNT-PRIME     PIC X(6).
  5152         16  CN-CERT-EFF-DT          PIC XX.
  5153         16  CN-CERT-NO.
  5154             20  CN-CERT-PRIME       PIC X(10).
  5155             20  CN-CERT-SFX         PIC X.
  5156         16  CN-RECORD-TYPE          PIC X.
  5157             88  CN-ISSUE-BILLING-NOTE    VALUE '1'.
  5158             88  CN-CANCEL-BILLING-NOTE   VALUE '2'.
  5159     12  CN-BILLING-START-LINE-NO    PIC 99.
  5160     12  CN-BILLING-END-LINE-NO      PIC 99.
  5161
  5162     12  CN-LINES.
  5163         16  CN-LINE OCCURS 10       PIC X(77).
  5164
  5165     12  CN-LAST-MAINT-DT            PIC XX.
  5166     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5167     12  CN-LAST-MAINT-USER          PIC X(4).
  5168     12  FILLER                      PIC X(5).
  5169******************************************************************
  5170*                                COPY ERCMAIL.
  5171******************************************************************
  5172*                                                                *
  5173*                                                                *
  5174*                            ERCMAIL                             *
  5175*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5176*                            VMOD=2.003                          *
  5177*                                                                *
  5178*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5179*                                                                *
  5180*   FILE TYPE = VSAM,KSDS                                        *
  5181*   RECORD SIZE = 374   RECFORM = FIX                            *
  5182*                                                                *
  5183*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5184*   ALTERNATE PATH    = NOT USED                                 *
  5185*                                                                *
  5186*   LOG = YES                                                    *
  5187*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5188******************************************************************
  5189*                   C H A N G E   L O G
  5190*
  5191* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5192*-----------------------------------------------------------------
  5193*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5194* EFFECTIVE    NUMBER
  5195*-----------------------------------------------------------------
  5196* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5197* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5198* 111108                   PEMA  ADD CRED BENE ADDR2
  5199******************************************************************
  5200
  5201 01  MAILING-DATA.
  5202     12  MA-RECORD-ID                      PIC XX.
  5203         88  VALID-MA-ID                       VALUE 'MA'.
  5204
  5205     12  MA-CONTROL-PRIMARY.
  5206         16  MA-COMPANY-CD                 PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  92
* EL6317.cbl
  5207         16  MA-CARRIER                    PIC X.
  5208         16  MA-GROUPING.
  5209             20  MA-GROUPING-PREFIX        PIC XXX.
  5210             20  MA-GROUPING-PRIME         PIC XXX.
  5211         16  MA-STATE                      PIC XX.
  5212         16  MA-ACCOUNT.
  5213             20  MA-ACCOUNT-PREFIX         PIC X(4).
  5214             20  MA-ACCOUNT-PRIME          PIC X(6).
  5215         16  MA-CERT-EFF-DT                PIC XX.
  5216         16  MA-CERT-NO.
  5217             20  MA-CERT-PRIME             PIC X(10).
  5218             20  MA-CERT-SFX               PIC X.
  5219
  5220     12  FILLER                            PIC XX.
  5221
  5222     12  MA-ACCESS-CONTROL.
  5223         16  MA-SOURCE-SYSTEM              PIC XX.
  5224             88  MA-FROM-CREDIT                VALUE 'CR'.
  5225             88  MA-FROM-VSI                   VALUE 'VS'.
  5226             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5227             88  MA-FROM-OTHER                 VALUE 'OT'.
  5228         16  MA-RECORD-ADD-DT              PIC XX.
  5229         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5230         16  MA-LAST-MAINT-DT              PIC XX.
  5231         16  MA-LAST-MAINT-BY              PIC XXXX.
  5232         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5233
  5234     12  MA-PROFILE-INFO.
  5235         16  MA-QUALIFY-CODE-1             PIC XX.
  5236         16  MA-QUALIFY-CODE-2             PIC XX.
  5237         16  MA-QUALIFY-CODE-3             PIC XX.
  5238         16  MA-QUALIFY-CODE-4             PIC XX.
  5239         16  MA-QUALIFY-CODE-5             PIC XX.
  5240
  5241         16  MA-INSURED-LAST-NAME          PIC X(15).
  5242         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5243         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5244         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5245         16  MA-INSURED-BIRTH-DT           PIC XX.
  5246         16  MA-INSURED-SEX                PIC X.
  5247             88  MA-SEX-MALE                   VALUE 'M'.
  5248             88  MA-SEX-FEMALE                 VALUE 'F'.
  5249         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5250
  5251         16  MA-ADDRESS-CORRECTED          PIC X.
  5252         16  MA-JOINT-BIRTH-DT             PIC XX.
  5253*        16  FILLER                        PIC X(12).
  5254
  5255         16  MA-ADDRESS-LINE-1             PIC X(30).
  5256         16  MA-ADDRESS-LINE-2             PIC X(30).
  5257         16  MA-CITY-STATE.
  5258             20  MA-CITY                   PIC X(28).
  5259             20  MA-ADDR-STATE             PIC XX.
  5260         16  MA-ZIP.
  5261             20  MA-ZIP-CODE.
  5262                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5263                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5264                 24  FILLER                PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  93
* EL6317.cbl
  5265             20  MA-ZIP-PLUS4              PIC X(4).
  5266         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5267             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5268             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5269             20  FILLER                    PIC X(3).
  5270
  5271         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
  5272
  5273         16  FILLER                        PIC XXX.
  5274*        16  FILLER                        PIC X(10).
  5275
  5276     12  MA-CRED-BENE-INFO.
  5277         16  MA-CRED-BENE-NAME                 PIC X(25).
  5278         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5279         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5280         16  MA-CRED-BENE-CTYST.
  5281             20  MA-CRED-BENE-CITY             PIC X(28).
  5282             20  MA-CRED-BENE-STATE            PIC XX.
  5283         16  MA-CRED-BENE-ZIP.
  5284             20  MA-CB-ZIP-CODE.
  5285                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5286                     88  MA-CB-CANADIAN-POST-CODE
  5287                                           VALUE 'A' THRU 'Z'.
  5288                 24  FILLER                    PIC X(4).
  5289             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5290         16  MA-CB-CANADIAN-POSTAL-CODE
  5291                            REDEFINES MA-CRED-BENE-ZIP.
  5292             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5293             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5294             20  FILLER                        PIC X(3).
  5295     12  MA-POST-CARD-MAIL-DATA.
  5296         16  MA-MAIL-DATA OCCURS 7.
  5297             20  MA-MAIL-TYPE              PIC X.
  5298                 88  MA-12MO-MAILING           VALUE '1'.
  5299                 88  MA-EXP-MAILING            VALUE '2'.
  5300             20  MA-MAIL-STATUS            PIC X.
  5301                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5302                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5303                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5304             20  MA-MAIL-DATE              PIC XX.
  5305     12  FILLER                            PIC XX.
  5306     12  FILLER                            PIC XX.
  5307*    12  FILLER                            PIC X(30).
  5308******************************************************************
  5309*                                COPY ERCARCH.
  5310******************************************************************
  5311*                                                                *
  5312*                            ERCARCH.                            *
  5313*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5314*                            VMOD=2.002                          *
  5315*                                                                *
  5316*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  5317*                                                                *
  5318*   FILE TYPE = VSAM,KSDS                                        *
  5319*   RECORD SIZE = 250  RECFORM = FIXED                           *
  5320*                                                                *
  5321*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  5322*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  94
* EL6317.cbl
  5323*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  5324*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  5325*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  5326*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  5327*                                                                *
  5328*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5329******************************************************************
  5330*                   C H A N G E   L O G
  5331*
  5332* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5333*-----------------------------------------------------------------
  5334*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5335* EFFECTIVE    NUMBER
  5336*-----------------------------------------------------------------
  5337* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  5338* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  5339* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5340* 102918  CR2018080300002  PEMA  ADD ONBASE STUFF
  5341******************************************************************
  5342 01  LETTER-ARCHIVE.
  5343     12  LA-RECORD-ID                PIC  X(02).
  5344         88  LA-VALID-ID                VALUE 'LA'.
  5345
  5346     12  LA-CONTROL-PRIMARY.
  5347         16  LA-COMPANY-CD           PIC  X(01).
  5348         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  5349
  5350     12  LA-CONTROL-BY-CERT-RESP.
  5351         16  LA-COMPANY-CD-A2        PIC  X(01).
  5352         16  LA-CERT-NO-A2.
  5353             20  LA-CERT-PRIME-A2    PIC  X(10).
  5354             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  5355         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  5356             20  LA-RESP-PERSON-A2   PIC  X(10).
  5357             20  LA-TYPE-A2          PIC  X(01).
  5358         16  LA-CARRIER-A2           PIC  X(01).
  5359         16  LA-GROUPING-A2          PIC  X(06).
  5360         16  LA-STATE-A2             PIC  X(02).
  5361         16  LA-ACCOUNT-A2           PIC  X(10).
  5362         16  LA-EFFECT-DATE-A2       PIC  X(02).
  5363         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  5364
  5365     12  LA-CONTROL-BY-FORM.
  5366         16  LA-COMPANY-CD-A3        PIC  X(01).
  5367         16  LA-FORM-A3              PIC  X(04).
  5368         16  LA-CARRIER-A3           PIC  X(01).
  5369         16  LA-GROUPING-A3          PIC  X(06).
  5370         16  LA-STATE-A3             PIC  X(02).
  5371         16  LA-ACCOUNT-A3           PIC  X(10).
  5372         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  5373
  5374     12  LA-CONTROL-BY-PROCESSOR.
  5375         16  LA-COMPANY-CD-A4        PIC  X(01).
  5376         16  LA-PROCESSOR-CD         PIC  X(04).
  5377         16  LA-CARRIER-A4           PIC  X(01).
  5378         16  LA-GROUPING-A4          PIC  X(06).
  5379         16  LA-STATE-A4             PIC  X(02).
  5380         16  LA-ACCOUNT-A4           PIC  X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  95
* EL6317.cbl
  5381         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  5382
  5383     12  LA-CONTROL-BY-KEY-FIELDS.
  5384         16  LA-COMPANY-CD-A5        PIC  X(01).
  5385         16  LA-CARRIER-A5           PIC  X(01).
  5386         16  LA-GROUPING-A5          PIC  X(06).
  5387         16  LA-STATE-A5             PIC  X(02).
  5388         16  LA-ACCOUNT-A5           PIC  X(10).
  5389         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  5390
  5391     12  LA-CONTROL-BY-GROUP-CODE.
  5392         16  LA-COMPANY-CD-A6        PIC  X(01).
  5393         16  LA-ENTRY-A6.
  5394             20  LA-FILLER           PIC  X(02).
  5395             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  5396         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  5397
  5398     12  FILLER                      PIC  X(09).
  5399
  5400     12  LA-HEADER-RECORD.
  5401         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  5402         16  LA-CREATION-DATE        PIC  X(02).
  5403         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  5404         16  LA-FINAL-ACT-DATE       REDEFINES
  5405               LA-FOLLOW-UP-DATE     PIC  X(02).
  5406         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  5407         16  LA-NO-OF-COPIES         PIC S9(01).
  5408         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  5409         16  LA-REPLY-DATE           PIC  X(02).
  5410         16  LA-RESEND-DATES.
  5411             20  LA-RESEND-DATE      PIC  X(02).
  5412             20  LA-SENT-DATE        PIC  X(02).
  5413             20  FILLER              PIC  X(08).
  5414         16  LA-SOURCE-INFORMATION.
  5415             20  LA-DATA-SOURCE      PIC  X(01).
  5416             20  LA-ADDR-SOURCE      PIC  X(01).
  5417         16  LA-STATUS               PIC  X(01).
  5418             88  LA-STATUS-ACTIVE         VALUE 'A'.
  5419             88  LA-STATUS-COMPLETED      VALUE 'C'.
  5420             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  5421             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  5422             88  LA-STATUS-PURGED         VALUE 'P'.
  5423             88  LA-STATUS-VOIDED         VALUE 'V'.
  5424         16  LA-LAST-RESENT-PRINT-DATE
  5425                                     PIC  X(02).
  5426         16  LA-PRINT-RESTRICTION    PIC  X(01).
  5427             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  5428                                          VALUE 'C'.
  5429             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  5430                                          VALUE 'F'.
  5431             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  5432                                          VALUE 'P'.
  5433         16  LA-PURGED-DATE          PIC  X(02).
  5434         16  LA-VOIDED-DATE          PIC  X(02).
  5435         16  LA-RESEND-LETR          PIC  X(4).
  5436         16  LA-VOID-ONBASE-YN       PIC  X.
  5437         16  LA-ONBASE-UNIQUE-ID     PIC S9(5) COMP-3.
  5438         16  FILLER                  PIC  X(04).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  96
* EL6317.cbl
  5439*        16  LA-RESEND-LETR-2        PIC  X(4).
  5440*        16  LA-RESEND-LETR-3        PIC  X(4).
  5441*        16  FILLER                  PIC  X(59).
  5442         16  LA-ARCHIVE-STATUS       PIC  X.
  5443             88  LA-TEMP                VALUE 'T'.
  5444             88  LA-QWS                 VALUE 'Q'.
  5445             88  LA-BATCH               VALUE 'B'.
  5446         16  LA-FINAL-ACT-IND        PIC  X(1).
  5447         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  5448         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  5449         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  5450                                     PIC X(4).
  5451         16  FILLER                  PIC  X(42).
  5452*        16  FILLER                  PIC  X(71).
  5453         16  LA-LAST-MAINT-DATE      PIC  X(2).
  5454         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  5455         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  5456                                     PIC  X(4).
  5457         16  LA-LAST-UPDATED-BY      PIC  X(4).
  5458
  5459******************************************************************
  5460*                                COPY ERCCNOT.
  5461******************************************************************
  5462*                                                                *
  5463*                            ERCCNOT                             *
  5464*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5465*                            VMOD=2.003                          *
  5466*                                                                *
  5467*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5468*                                                                *
  5469*        FILE TYPE= VSAM,KSDS                                    *
  5470*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5471*                                                                *
  5472*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5473*                                                                *
  5474*        LOG = YES                                               *
  5475*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5476*                                                                *
  5477******************************************************************
  5478*                   C H A N G E   L O G
  5479*
  5480* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5481*-----------------------------------------------------------------
  5482*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5483* EFFECTIVE    NUMBER
  5484*-----------------------------------------------------------------
  5485* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5486******************************************************************
  5487
  5488 01  CERT-NOTE-FILE.
  5489     12  CZ-RECORD-ID                PIC  XX.
  5490         88  VALID-CZ-ID                  VALUE 'CZ'.
  5491
  5492     12  CZ-CONTROL-PRIMARY.
  5493         16  CZ-COMPANY-CD           PIC X.
  5494         16  CZ-CARRIER              PIC X.
  5495         16  CZ-GROUPING.
  5496             20 CZ-GROUPING-PREFIX   PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  97
* EL6317.cbl
  5497             20 CZ-GROUPING-PRIME    PIC XXX.
  5498         16  CZ-STATE                PIC XX.
  5499         16  CZ-ACCOUNT.
  5500             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5501             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5502         16  CZ-CERT-EFF-DT          PIC XX.
  5503         16  CZ-CERT-NO.
  5504             20  CZ-CERT-PRIME       PIC X(10).
  5505             20  CZ-CERT-SFX         PIC X.
  5506         16  CZ-RECORD-TYPE          PIC X.
  5507             88  CERT-NOTE           VALUE '1'.
  5508             88  CLAIM-CERT-NOTE     VALUE '2'.
  5509         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5510
  5511     12  CZ-LAST-MAINT-DT            PIC XX.
  5512     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5513     12  CZ-LAST-MAINT-USER          PIC X(4).
  5514
  5515     12  CZ-NOTE-INFORMATION.
  5516         16  CZ-NOTE                 PIC X(63).
  5517         16  FILLER                  PIC X(39).
  5518******************************************************************
  5519*                                COPY ELCEOBC.
  5520******************************************************************
  5521*                                                                *
  5522*                                                                *
  5523*                            ELCEOBC                             *
  5524*                            VMOD=2.001                          *
  5525*                                                                *
  5526*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5527*                                                                *
  5528*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5529*   VSAM EOB CODE TABLE                                          *
  5530*                                                                *
  5531*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5532*                                                                *
  5533*   FILE TYPE = VSAM,KSDS                                        *
  5534*   RECORD SIZE = 350   RECFORM = FIX                            *
  5535*                                                                *
  5536*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5537*                                                                *
  5538*   LOG = NO                                                     *
  5539*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5540*                                                                *
  5541*                                                                *
  5542******************************************************************
  5543*                   C H A N G E   L O G
  5544*
  5545* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5546*-----------------------------------------------------------------
  5547*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5548* EFFECTIVE    NUMBER
  5549*-----------------------------------------------------------------
  5550* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5551* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5552* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  5553******************************************************************
  5554 01  EOB-CODES.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  98
* EL6317.cbl
  5555     12  EO-RECORD-ID                      PIC XX.
  5556         88  VALID-DN-ID                      VALUE 'EO'.
  5557     12  EO-CONTROL-PRIMARY.
  5558         16  EO-COMPANY-CD                 PIC X.
  5559         16  EO-RECORD-TYPE                PIC X.
  5560             88  EO-EOB-RECS                  VALUE '1'.
  5561             88  EO-VERIF-RECS                VALUE '2'.
  5562             88  EO-GCE-RECS                  VALUE '3'.
  5563             88  EO-CANC-RECS                 VALUE '4'.
  5564             88  EO-BILL-NOTE-RECS            VALUE '5'.
  5565         16  EO-EOB-CODE                   PIC X(4).
  5566         16  FILLER                        PIC X(9).
  5567     12  EO-MAINT-INFORMATION.
  5568         16  EO-LAST-MAINT-DT              PIC XX.
  5569         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5570         16  EO-LAST-MAINT-USER            PIC X(4).
  5571         16  FILLER                        PIC XX.
  5572     12  EO-DESCRIPTION                    PIC X(275).
  5573     12  FILLER                            PIC X(46).
  5574******************************************************************
  5575*                                COPY ELCCRTT.
  5576******************************************************************
  5577*                                                                *
  5578*                            ELCCRTT.                            *
  5579*                                                                *
  5580*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5581*                                                                *
  5582*   FILE TYPE = VSAM,KSDS                                        *
  5583*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5584*                                                                *
  5585*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5586*                                                                *
  5587*   LOG = YES                                                    *
  5588*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5589******************************************************************
  5590*                   C H A N G E   L O G
  5591*
  5592* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5593*-----------------------------------------------------------------
  5594*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5595* EFFECTIVE    NUMBER
  5596*-----------------------------------------------------------------
  5597* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5598* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5599* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5600* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5601* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5602* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5603* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5604* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5605* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5606* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  5607* 091318  CR2018073000001  PEMA  ADD Refund methods
  5608* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  5609******************************************************************
  5610
  5611 01  CERTIFICATE-TRAILERS.
  5612     12  CS-RECORD-ID                      PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page  99
* EL6317.cbl
  5613         88  VALID-CS-ID                      VALUE 'CS'.
  5614
  5615     12  CS-CONTROL-PRIMARY.
  5616         16  CS-COMPANY-CD                 PIC X.
  5617         16  CS-CARRIER                    PIC X.
  5618         16  CS-GROUPING                   PIC X(6).
  5619         16  CS-STATE                      PIC XX.
  5620         16  CS-ACCOUNT                    PIC X(10).
  5621         16  CS-CERT-EFF-DT                PIC XX.
  5622         16  CS-CERT-NO.
  5623             20  CS-CERT-PRIME             PIC X(10).
  5624             20  CS-CERT-SFX               PIC X.
  5625         16  CS-TRAILER-TYPE               PIC X.
  5626             88  COMM-TRLR           VALUE 'A'.
  5627             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5628             88  CERT-DATA-TRLR      VALUE 'C'.
  5629
  5630     12  CS-DATA-AREA                      PIC X(516).
  5631
  5632     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5633         16  CS-BANK-COMMISSION-AREA.
  5634             20  CS-BANK-COMMS       OCCURS 10.
  5635                 24  CS-AGT                PIC X(10).
  5636                 24  CS-COM-TYP            PIC X.
  5637                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5638                 24  CS-RECALC-LV-INDIC    PIC X.
  5639                 24  FILLER                PIC X(10).
  5640         16  FILLER                        PIC X(256).
  5641
  5642     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5643****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5644         16  CS-MB-CLAIM-DATA OCCURS 24.
  5645             20  CS-CLAIM-NO               PIC X(7).
  5646             20  CS-CLAIM-TYPE             PIC X.
  5647                 88  CS-AH-CLM               VALUE 'A'.
  5648                 88  CS-IU-CLM               VALUE 'I'.
  5649                 88  CS-GP-CLM               VALUE 'G'.
  5650                 88  CS-LF-CLM               VALUE 'L'.
  5651                 88  CS-PR-CLM               VALUE 'P'.
  5652                 88  CS-FL-CLM               VALUE 'F'.
  5653                 88  CS-OT-CLM               VALUE 'O'.
  5654             20  CS-INSURED-TYPE           PIC X.
  5655                 88  CS-PRIM-INSURED          VALUE 'P'.
  5656                 88  CS-CO-BORROWER           VALUE 'C'.
  5657             20  CS-BENEFIT-PERIOD         PIC 99.
  5658             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
  5659             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5660             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5661         16  FILLER                        PIC X(12).
  5662     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5663         16  CS-VIN-NUMBER                 PIC X(17).
  5664         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5665         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5666         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5667         16  cs-agent-name.
  5668             20  cs-agent-fname            pic x(20).
  5669             20  cs-agent-mi               pic x.
  5670             20  cs-agent-lname            pic x(25).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 100
* EL6317.cbl
  5671         16  cs-license-no                 pic x(15).
  5672         16  cs-npn-number                 pic x(10).
  5673         16  cs-agent-edit-status          pic x.
  5674             88  cs-ae-refer-to-manager      value 'M'.
  5675             88  cs-ae-cover-sheet           value 'C'.
  5676             88  cs-ae-sig-form              value 'S'.
  5677             88  cs-ae-verified              value 'V'.
  5678             88  cs-unidentified-signature   value 'U'.
  5679             88  cs-cert-returned            value 'R'.
  5680             88  cs-accept-no-commission     value 'N'.
  5681         16  cs-year                       pic 9999.
  5682         16  cs-make                       pic x(20).
  5683         16  cs-model                      pic x(20).
  5684         16  cs-future                     pic x(20).
  5685         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5686         16  cs-claim-verification-status  pic x.
  5687             88  cs-clm-ver-eligible         value 'A'.
  5688             88  cs-clm-ver-partial-elig     value 'B'.
  5689             88  cs-clm-ver-not-eligible     value 'C'.
  5690             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  5691             88  cs-clm-ver-not-part-elig-rw value 'E'.
  5692             88  cs-clm-ver-ND-CERT          value 'F'.
  5693             88  cs-clm-ver-spec-other       value 'G'.
  5694             88  cs-clam-ver-pratial-corrected
  5695                                             value 'H'.
  5696             88  cs-clm-ver-no-matches       value 'I'.
  5697             88  cs-clm-ver-not-elig-corrected
  5698                                             value 'J'.
  5699             88  cs-clm-ver-needs-review     value 'R'.
  5700             88  cs-clm-ver-sent-to-claims   value 'W'.
  5701         16  CS-LF-REFUND-METHOD           PIC X.
  5702         16  CS-AH-REFUND-METHOD           PIC X.
  5703         16  FILLER                        PIC X(353). *> was 420
  5704*        16  FILLER                        PIC X(496).
  5705*                                COPY ELCENCC.
  5706******************************************************************
  5707*                                                                *
  5708*                                                                *
  5709*                            ELCENCC                             *
  5710*                            VMOD=2.001                          *
  5711*                                                                *
  5712*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5713*                                                                *
  5714*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5715*   A NAPERSOFT DOCUMENT                                         *
  5716*                                                                *
  5717*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5718*                                                                *
  5719*   FILE TYPE = VSAM,KSDS                                        *
  5720*   RECORD SIZE = 400   RECFORM = FIX                            *
  5721*                                                                *
  5722*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5723*                                                                *
  5724*   LOG = NO                                                     *
  5725*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5726*                                                                *
  5727*                                                                *
  5728******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 101
* EL6317.cbl
  5729*                   C H A N G E   L O G
  5730*
  5731* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5732*-----------------------------------------------------------------
  5733*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5734* EFFECTIVE    NUMBER
  5735*-----------------------------------------------------------------
  5736* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5737* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  5738******************************************************************
  5739 01  ENCLOSURE-CODES.
  5740     12  NC-RECORD-ID                      PIC XX.
  5741         88  VALID-NC-ID                      VALUE 'NC'.
  5742     12  NC-CONTROL-PRIMARY.
  5743         16  NC-COMPANY-CD                 PIC X.
  5744         16  NC-REC-TYPE                   PIC X.
  5745             88  NC-CLAIMS                   VALUE '1'.
  5746             88  NC-ADMIN                    VALUE '2'.
  5747         16  NC-ENC-CODE                   PIC X(5).
  5748         16  FILLER                        PIC X(09).
  5749     12  NC-MAINT-INFORMATION.
  5750         16  NC-LAST-MAINT-DT              PIC XX.
  5751         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5752         16  NC-LAST-MAINT-USER            PIC X(4).
  5753         16  FILLER                        PIC XX.
  5754     12  NC-OUTPUT-STACK                   PIC XXX.
  5755     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5756     12  NC-ATTACHMENTS                    PIC X(255).
  5757     12  NC-FUTURE                         PIC X(12).
  5758******************************************************************
  5759 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5760                          ACCOUNT-MASTER CONTROL-FILE
  5761                          PENDING-BUSINESS CERTIFICATE-MASTER
  5762                          ORIGINAL-CERTIFICATE
  5763                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5764                          MAILING-DATA LETTER-ARCHIVE
  5765                          CERT-NOTE-FILE EOB-CODES
  5766                          CERTIFICATE-TRAILERS ENCLOSURE-CODES.
  5767 0000-DFHEXIT SECTION.
  5768     MOVE '9#                    $   ' TO DFHEIV0.
  5769     MOVE 'EL6317' TO DFHEIV1.
  5770     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5771     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
  5772     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5773     MOVE '5'                    TO DC-OPTION-CODE
  5774     PERFORM 9700-DATE-LINK
  5775     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT
  5776     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT
  5777     MOVE EIBTRMID               TO QID-TERM
  5778     MOVE 2                      TO EMI-NUMBER-OF-LINES
  5779     IF EIBCALEN = 0
  5780        GO TO 8800-UNAUTHORIZED-ACCESS
  5781     END-IF
  5782     MOVE FUNCTION LENGTH(EL631JI) TO MAP-LENGTH
  5783     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5784        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5785           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5786           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 102
* EL6317.cbl
  5787           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5788           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5789           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5790           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5791           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5792           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5793           MOVE LOW-VALUES           TO EL631JI
  5794           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5795           GO TO 0350-BUILD-INIT-MAP
  5796        END-IF
  5797     END-IF
  5798     IF PI-CALLING-PROGRAM = 'EL614'
  5799        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5800                                 TO WS-PASSED-REASON-CODES
  5801        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5802        IF WS-PASSED-REASON-CODES NOT = SPACES
  5803           MOVE 'Y'              TO WS-SET-CODES-MDT
  5804        ELSE
  5805           MOVE 'N'              TO WS-SET-CODES-MDT
  5806        END-IF
  5807        PERFORM 0600-RECOVER-TEMP-STORAGE
  5808                                 THRU 0600-EXIT
  5809        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5810        GO TO 0350-BUILD-INIT-MAP
  5811     END-IF
  5812     IF EIBAID = DFHCLEAR
  5813        IF PI-CLEAR-ERROR
  5814           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5815           MOVE ER-3833           TO EMI-ERROR
  5816           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5817           GO TO 0350-BUILD-INIT-MAP
  5818        ELSE
  5819           GO TO 9400-CLEAR
  5820        END-IF
  5821     END-IF
  5822     .
  5823 0200-RECEIVE.
  5824     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5825        MOVE ER-0008             TO EMI-ERROR
  5826        PERFORM 9900-ERROR-FORMAT
  5827                                 THRU 9900-EXIT
  5828        MOVE -1                  TO PFENTRL
  5829        GO TO 8100-SEND-INITIAL-MAP
  5830     END-IF
  5831
  5832* EXEC CICS RECEIVE
  5833*        MAP      (MAP-NAME)
  5834*        MAPSET   (MAPSET-NAME)
  5835*        INTO     (EL631JI)
  5836*    END-EXEC
  5837     MOVE LENGTH OF
  5838      EL631JI
  5839       TO DFHEIV11
  5840*    MOVE '8"T I  L              ''   #00005827' TO DFHEIV0
  5841     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5842     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5843     MOVE X'2020233030303035383237' TO DFHEIV0(25:11)
  5844     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 103
* EL6317.cbl
  5845           MAP-NAME,
  5846           EL631JI,
  5847           DFHEIV11,
  5848           MAPSET-NAME,
  5849           DFHEIV99,
  5850           DFHEIV99
  5851     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5852     IF PFENTRL = 0
  5853         GO TO 0300-CHECK-PFKEYS
  5854     END-IF
  5855     IF EIBAID NOT = DFHENTER
  5856         MOVE ER-0004            TO EMI-ERROR
  5857         GO TO 0320-INPUT-ERROR
  5858     END-IF
  5859     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5860        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5861     ELSE
  5862        MOVE ER-0029            TO EMI-ERROR
  5863        GO TO 0320-INPUT-ERROR
  5864     END-IF
  5865     .
  5866 0300-CHECK-PFKEYS.
  5867     IF EIBAID = DFHPF3
  5868        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5869        PERFORM 0500-CREATE-TEMP-STORAGE THRU 0500-EXIT
  5870        MOVE 'EL614'             TO PGM-NAME
  5871        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5872        move +1                  to s2
  5873        perform varying s1 from +1 by +1 until s1 > +12
  5874           if reacd-in (s1) not = spaces and low-values
  5875              move reacd-in (s1)    to pi-program-work-area (s2:4)
  5876              add +5 to s2
  5877           end-if
  5878        END-perform
  5879        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5880        GO TO 9300-XCTL
  5881     END-IF
  5882     IF EIBAID = DFHPF4 OR DFHPF8
  5883        GO TO 0360-FINALIZE
  5884     END-IF
  5885     IF EIBAID = DFHPF23
  5886        IF PI-CLEAR-ERROR
  5887           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5888           MOVE ER-3833           TO EMI-ERROR
  5889           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5890           GO TO 0350-BUILD-INIT-MAP
  5891        ELSE
  5892           GO TO 8810-PF23
  5893        END-IF
  5894     END-IF
  5895     IF EIBAID = DFHPF24
  5896        IF PI-CLEAR-ERROR
  5897           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5898           MOVE ER-3833           TO EMI-ERROR
  5899           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5900           GO TO 0350-BUILD-INIT-MAP
  5901        ELSE
  5902           GO TO 9200-RETURN-MAIN-MENU
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 104
* EL6317.cbl
  5903        END-IF
  5904     END-IF
  5905     IF EIBAID = DFHPF12
  5906        GO TO 9500-PF12
  5907     END-IF
  5908     IF EIBAID = DFHENTER
  5909        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5910        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5911        GO TO 0330-CHECK-ERRORS
  5912     END-IF
  5913     MOVE ER-0029                TO EMI-ERROR
  5914     .
  5915 0320-INPUT-ERROR.
  5916     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5917     MOVE AL-UNBON               TO PFENTRA
  5918     MOVE -1                     TO PFENTRL
  5919     GO TO 8200-SEND-DATAONLY
  5920     .
  5921 0325-EDIT-SCREEN.
  5922     if prtswl > zeros
  5923        if prtswi = 'Y' OR 'N' OR 'P' OR ' '
  5924*          MOVE AL-UANON       TO PRTSWA
  5925*          IF PRTSWI = ' '
  5926              MOVE 'P'         TO PRTSWI
  5927*          END-IF
  5928*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5929        END-IF
  5930     END-IF
  5931     IF (SIGREQL > ZEROS)
  5932        AND (SIGREQI = 'Y' OR 'N' OR ' ')
  5933        MOVE AL-UANON         TO SIGREQA
  5934        IF SIGREQI = ' '
  5935           MOVE 'N'           TO SIGREQI
  5936        END-IF
  5937        MOVE SIGREQI          TO PI-SIGREQ-ENTERED
  5938     ELSE
  5939        MOVE ER-2651          TO EMI-ERROR
  5940        MOVE -1               TO SIGREQL
  5941        MOVE AL-UABON         TO SIGREQA
  5942        PERFORM 9900-ERROR-FORMAT
  5943                                 THRU 9900-EXIT
  5944     END-IF
  5945     IF LTRIDL > ZEROS
  5946        AND LTRIDI > SPACES
  5947        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5948        MOVE LTRIDI              TO LETR-LETTER-ID
  5949                                    PI-LTRID-ENTERED
  5950        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  5951        MOVE SPACES              TO LETR-FILLER
  5952        MOVE 0                   TO LETR-SEQ-NO
  5953        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  5954     ELSE
  5955        MOVE ER-1236          TO EMI-ERROR
  5956        MOVE -1               TO LTRIDL
  5957        MOVE AL-UABON         TO LTRIDA
  5958        PERFORM 9900-ERROR-FORMAT
  5959                                 THRU 9900-EXIT
  5960     END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 105
* EL6317.cbl
  5961
  5962     IF W-PROMPT-LETTER EQUAL 'Y'
  5963         MOVE ER-0894            TO EMI-ERROR
  5964         MOVE -1                 TO LTRIDL
  5965         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5966     END-IF
  5967
  5968     IF ENCCODEL > ZEROS
  5969        MOVE FUNCTION UPPER-CASE(ENCCODEI) TO ENCCODEI
  5970                                              PI-ENCCODE
  5971        MOVE SPACES             TO WS-ELENCC-KEY
  5972        MOVE PI-COMPANY-CD      TO WS-ENCC-COMPANY-CD
  5973        MOVE '2'                TO WS-ENCC-REC-TYPE
  5974        MOVE ENCCODEI           TO WS-ENCC-ENC-CODE
  5975
  5976
  5977* EXEC CICS READ
  5978*           DATASET    (WS-ELENCC-FILE-ID)
  5979*           SET        (ADDRESS OF ENCLOSURE-CODES)
  5980*           RIDFLD     (WS-ELENCC-KEY)
  5981*           RESP       (WS-RESPONSE)
  5982*       END-EXEC
  5983*    MOVE '&"S        E          (  N#00005956' TO DFHEIV0
  5984     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5985     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5986     MOVE X'204E233030303035393536' TO DFHEIV0(25:11)
  5987     CALL 'kxdfhei1' USING DFHEIV0,
  5988           WS-ELENCC-FILE-ID,
  5989           DFHEIV20,
  5990           DFHEIV99,
  5991           WS-ELENCC-KEY,
  5992           DFHEIV99,
  5993           DFHEIV99,
  5994           DFHEIV99
  5995     SET ADDRESS OF ENCLOSURE-CODES TO
  5996         DFHEIV20
  5997     MOVE EIBRESP  TO WS-RESPONSE
  5998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5999
  6000        IF RESP-NORMAL
  6001           MOVE ENCCODEI         TO PI-ENCCODE
  6002                                    W-ENCLOSURE-CD
  6003           MOVE AL-UANON         TO ENCCODEA
  6004        ELSE
  6005           MOVE ER-1560          TO EMI-ERROR
  6006           MOVE -1               TO ENCCODEL
  6007           MOVE AL-UABON         TO ENCCODEA
  6008           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6009        END-IF
  6010     END-IF
  6011
  6012     SET REASONS-NOT-FOUND TO TRUE
  6013     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6014        IF REACDL (S1) = +4 OR
  6015          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6016              MOVE AL-SANON     TO REACDA (S1)
  6017              SET REASONS-FOUND TO TRUE
  6018        END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 106
* EL6317.cbl
  6019     END-PERFORM
  6020
  6021     IF REASONS-NOT-FOUND
  6022        MOVE ER-1820             TO EMI-ERROR
  6023        MOVE -1                  TO PFENTRL
  6024        PERFORM 9900-ERROR-FORMAT
  6025                                 THRU 9900-EXIT
  6026     ELSE
  6027        MOVE REASONCDS           TO PI-REASONS-ENTERED
  6028     END-IF
  6029
  6030     IF CRTNT1L > ZEROS
  6031        IF CRTNT1I > SPACES
  6032           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  6033        END-IF
  6034     END-IF
  6035
  6036     IF CRTNT2L > ZEROS
  6037        IF CRTNT2I > SPACES
  6038           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  6039        END-IF
  6040     END-IF
  6041
  6042     IF BILNT1L > ZEROS
  6043        IF BILNT1I > SPACES
  6044           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  6045        END-IF
  6046     END-IF
  6047
  6048     IF BILNT2L > ZEROS
  6049        IF BILNT2I > SPACES
  6050           MOVE BILNT2I          TO PI-BILLNT2-ENTERED
  6051        END-IF
  6052     END-IF
  6053
  6054     .
  6055 0325-EXIT.
  6056     EXIT.
  6057
  6058 0326-GET-Z-RECORD.
  6059
  6060     MOVE SPACES  TO W-Z-CONTROL-DATA
  6061
  6062
  6063* EXEC CICS STARTBR
  6064*         DATASET    ('ELLETR')
  6065*         RIDFLD     (ELLETR-KEY)
  6066*         GTEQ
  6067*         RESP      (WS-RESPONSE)
  6068*    END-EXEC.
  6069     MOVE 'ELLETR' TO DFHEIV1
  6070     MOVE 0
  6071       TO DFHEIV11
  6072*    MOVE '&,         G          &  N#00006025' TO DFHEIV0
  6073     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6074     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6075     MOVE X'204E233030303036303235' TO DFHEIV0(25:11)
  6076     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 107
* EL6317.cbl
  6077           DFHEIV1,
  6078           ELLETR-KEY,
  6079           DFHEIV99,
  6080           DFHEIV11,
  6081           DFHEIV99
  6082     MOVE EIBRESP  TO WS-RESPONSE
  6083     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6084
  6085     IF NOT RESP-NORMAL
  6086         MOVE ER-1236          TO EMI-ERROR
  6087         MOVE -1               TO LTRIDL
  6088         MOVE AL-UABON         TO LTRIDA
  6089         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6090         GO TO 0326-ENDBR
  6091     END-IF.
  6092
  6093 0326-READNEXT.
  6094
  6095
  6096* EXEC CICS READNEXT
  6097*        DATASET   ('ELLETR')
  6098*        INTO      (TEXT-FILES)
  6099*        RIDFLD    (ELLETR-KEY)
  6100*        RESP      (WS-RESPONSE)
  6101*    END-EXEC
  6102     MOVE LENGTH OF
  6103      TEXT-FILES
  6104       TO DFHEIV12
  6105     MOVE 'ELLETR' TO DFHEIV1
  6106     MOVE 0
  6107       TO DFHEIV11
  6108*    MOVE '&.IL                  )  N#00006041' TO DFHEIV0
  6109     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6110     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6111     MOVE X'204E233030303036303431' TO DFHEIV0(25:11)
  6112     CALL 'kxdfhei1' USING DFHEIV0,
  6113           DFHEIV1,
  6114           TEXT-FILES,
  6115           DFHEIV12,
  6116           ELLETR-KEY,
  6117           DFHEIV99,
  6118           DFHEIV11,
  6119           DFHEIV99,
  6120           DFHEIV99
  6121     MOVE EIBRESP  TO WS-RESPONSE
  6122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6123     IF RESP-NORMAL
  6124        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  6125           MOVE ER-1236          TO EMI-ERROR
  6126           MOVE -1               TO LTRIDL
  6127           MOVE AL-UABON         TO LTRIDA
  6128           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6129           GO TO 0326-ENDBR
  6130        END-IF
  6131
  6132        MOVE AL-UANON         TO LTRIDA
  6133        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  6134           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 108
* EL6317.cbl
  6135        ELSE
  6136           GO TO 0326-READNEXT
  6137        END-IF
  6138     ELSE
  6139        MOVE ER-1236          TO EMI-ERROR
  6140        MOVE -1               TO LTRIDL
  6141        MOVE AL-UABON         TO LTRIDA
  6142        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6143        GO TO 0326-ENDBR
  6144     END-IF.
  6145
  6146     IF PI-ENCCODE NOT GREATER THAN SPACES
  6147         MOVE W-ENCLOSURE-CD            TO PI-ENCCODE
  6148                                           ENCCODEO
  6149         MOVE AL-UANON                  TO ENCCODEA
  6150         MOVE +3                        TO ENCCODEL
  6151     END-IF.
  6152
  6153 0326-ENDBR.
  6154
  6155
  6156* EXEC CICS ENDBR
  6157*        DATASET     ('ELLETR')
  6158*    END-EXEC.
  6159     MOVE 'ELLETR' TO DFHEIV1
  6160     MOVE 0
  6161       TO DFHEIV11
  6162*    MOVE '&2                    $   #00006079' TO DFHEIV0
  6163     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6164     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6165     MOVE X'2020233030303036303739' TO DFHEIV0(25:11)
  6166     CALL 'kxdfhei1' USING DFHEIV0,
  6167           DFHEIV1,
  6168           DFHEIV11,
  6169           DFHEIV99
  6170     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6171
  6172
  6173 0326-EXIT.
  6174      EXIT.
  6175 0330-CHECK-ERRORS.
  6176     IF EMI-NO-ERRORS
  6177        GO TO 0350-BUILD-INIT-MAP
  6178     ELSE
  6179        GO TO 8200-SEND-DATAONLY
  6180     END-IF
  6181     .
  6182 0330-EXIT.
  6183     EXIT.
  6184 0350-BUILD-INIT-MAP.
  6185
  6186     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  6187      OR 'EL6314'
  6188        display 'coming from ' PI-RETURN-TO-PROGRAM
  6189        MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  6190        MOVE PI-CARRIER             TO CRTO-CARRIER
  6191        MOVE PI-GROUPING            TO CRTO-GROUPING
  6192        MOVE PI-STATE               TO CRTO-STATE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 109
* EL6317.cbl
  6193        MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  6194        MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  6195        MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  6196        MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  6197        MOVE 'I'                    TO CRTO-RECORD-TYPE
  6198        MOVE ZEROS                  TO CRTO-SEQ-NO
  6199        MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  6200                                       PI-ERENDT-KEY
  6201     END-IF
  6202     MOVE PI-CRTO-CARRIER        TO CARRO
  6203     MOVE PI-CRTO-GROUPING       TO GROUPO
  6204     MOVE PI-CRTO-STATE          TO STATEO
  6205     MOVE PI-CRTO-ACCOUNT        TO ACCTO
  6206     MOVE PI-CRTO-CERT-PRIME     TO CERTNOO
  6207     MOVE PI-CRTO-CERT-SFX       TO CRTSFXO
  6208     MOVE PI-CRTO-SEQ-NO         TO SEQNOO
  6209     MOVE PI-CRTO-CERT-EFF-DT    TO DC-BIN-DATE-1
  6210     MOVE ' '                    TO DC-OPTION-CODE
  6211     PERFORM 9700-DATE-LINK
  6212     IF NO-CONVERSION-ERROR
  6213        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6214     END-IF
  6215
  6216*    IF PI-PRTSW-ENTERED > SPACES
  6217*       MOVE PI-PRTSW-ENTERED    TO PRTSWI
  6218*       MOVE AL-UANON            TO PRTSWA
  6219*       MOVE +1                  TO PRTSWL
  6220*    END-IF
  6221
  6222     IF PI-SIGREQ-ENTERED > SPACES
  6223        MOVE PI-SIGREQ-ENTERED   TO SIGREQI
  6224        MOVE AL-UANON            TO SIGREQA
  6225        MOVE +1                  TO SIGREQL
  6226     END-IF
  6227
  6228     IF PI-LTRID-ENTERED > SPACES
  6229        MOVE PI-LTRID-ENTERED    TO LTRIDI
  6230        MOVE AL-UANON            TO LTRIDA
  6231        MOVE +4                  TO LTRIDL
  6232     END-IF
  6233
  6234     IF PI-ENCCODE > SPACES
  6235        MOVE PI-ENCCODE          TO ENCCODEI
  6236        MOVE AL-UANON            TO ENCCODEA
  6237        MOVE +3                  TO ENCCODEL
  6238     END-IF
  6239
  6240     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6241     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6242        IF REACDL (S1) = +4 OR
  6243          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6244              MOVE AL-SANON      TO REACDA (S1)
  6245              MOVE +4            TO REACDL (S1)
  6246              SET REASONS-FOUND  TO TRUE
  6247        END-IF
  6248     END-PERFORM
  6249
  6250     IF PI-CERTNT1-ENTERED > SPACES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 110
* EL6317.cbl
  6251        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6252        MOVE AL-UANON            TO CRTNT1A
  6253        MOVE +63                 TO CRTNT1L
  6254     END-IF
  6255
  6256     IF PI-CERTNT2-ENTERED > SPACES
  6257        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6258        MOVE AL-UANON            TO CRTNT2A
  6259        MOVE +63                 TO CRTNT2L
  6260     END-IF
  6261
  6262     IF PI-BILLNT1-ENTERED > SPACES
  6263        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6264        MOVE AL-UANON            TO BILNT1A
  6265        MOVE +63                 TO BILNT1L
  6266     END-IF
  6267
  6268     IF PI-BILLNT2-ENTERED > SPACES
  6269        MOVE PI-BILLNT2-ENTERED  TO BILNT2I
  6270        MOVE AL-UANON            TO BILNT2A
  6271        MOVE +63                 TO BILNT2L
  6272     END-IF
  6273
  6274     GO TO 8100-SEND-INITIAL-MAP
  6275     .
  6276 0360-FINALIZE.
  6277     display ' made it to 0360 '
  6278     PERFORM 0325-EDIT-SCREEN    THRU 0325-EXIT
  6279     IF NOT EMI-NO-ERRORS
  6280       AND EIBAID = DFHPF4
  6281        GO TO 8200-SEND-DATAONLY
  6282     END-IF
  6283     set P to address of KIXSYS
  6284     CALL "getenv" using by value P returning var-ptr
  6285     if var-ptr = null then
  6286        display ' kixsys not set '
  6287     else
  6288        set address of var to var-ptr
  6289        move 0 to env-var-len
  6290        inspect var tallying env-var-len
  6291          for characters before X'00'
  6292*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  6293        unstring var (1:env-var-len) delimited by '/'
  6294           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  6295              WS-KIX-SYS
  6296        end-unstring
  6297*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  6298*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  6299     end-if
  6300     set P to address of KIXHOST
  6301     CALL "getenv" using by value P returning var-ptr
  6302     if var-ptr = null then
  6303        display ' kixhost not set '
  6304     else
  6305        set address of var to var-ptr
  6306        move 0 to env-var-len
  6307        inspect var tallying env-var-len
  6308          for characters before X'00'
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 111
* EL6317.cbl
  6309*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  6310        MOVE var(1:env-var-len)  to ws-kixhost
  6311        DISPLAY ' WS KIX HOST ' WS-KIXhost
  6312     end-if
  6313     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  6314     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6315     IF RESP-NORMAL
  6316        AND (PI-ELCRTO-KEY (1:33) = OC-CONTROL-PRIMARY (1:33))
  6317        DISPLAY ' RESP NORMAL AND = '
  6318        MOVE OC-KEY-SEQ-NO  TO CRTO-SEQ-NO
  6319                               PI-CRTO-SEQ-NO
  6320        MOVE LOW-VALUES     TO NEW-ELCRTO-REC
  6321        MOVE PI-ELCRTO-KEY  TO NEW-ELCRTO-KEY
  6322        SUBTRACT +1         FROM NCRTO-SEQ-NO
  6323        PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  6324*       PERFORM 1000-BUILD-ERARCH THRU 1000-EXIT
  6325        PERFORM 1100-CALL-NS-BUS-LOGIC
  6326                                 THRU 1100-EXIT
  6327        IF BL-OK
  6328           CONTINUE
  6329        ELSE
  6330           MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  6331           MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  6332           MOVE -1               TO CARRL
  6333        END-IF
  6334     ELSE
  6335        MOVE ER-9999             TO EMI-ERROR
  6336        PERFORM 9900-ERROR-FORMAT
  6337                                 THRU 9900-EXIT
  6338        MOVE -1                  TO CARRL
  6339        GO TO 8100-SEND-INITIAL-MAP
  6340     END-IF
  6341     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  6342                                 TO SYSO
  6343     MOVE WS-KIXHOST             TO HOSTO
  6344     MOVE PI-COMPANY-ID          TO COMPANYO
  6345     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  6346       OR 'EL6314'
  6347         MOVE '2'                TO DATASORO
  6348     ELSE
  6349         MOVE '4'                TO DATASORO
  6350     END-IF
  6351     MOVE BL-BATCH-NO            TO BATCHNOO
  6352     MOVE BL-BATCH-SEQ           TO BSEQNOO
  6353     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  6354     MOVE PI-PROCESSOR-ID        TO PROCIDO
  6355*    MOVE -1                     TO PRTSWL
  6356*    MOVE AL-UANON               TO PRTSWA
  6357     MOVE -1                     TO SIGREQL
  6358     MOVE AL-UANON               TO SIGREQA
  6359     IF EIBAID = DFHPF4
  6360        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  6361        MOVE ER-0280             TO EMI-ERROR
  6362        PERFORM 9900-ERROR-FORMAT
  6363                                 THRU 9900-EXIT
  6364        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  6365        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  6366        MOVE 'Y'                 TO PI-FINALIZED-IND
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 112
* EL6317.cbl
  6367        GO TO 9400-CLEAR
  6368     ELSE
  6369        MOVE ER-1818             TO EMI-ERROR
  6370        PERFORM 9900-ERROR-FORMAT
  6371                                 THRU 9900-EXIT
  6372     END-IF
  6373     GO TO 0350-BUILD-INIT-MAP
  6374     .
  6375 0360-EXIT.
  6376     EXIT.
  6377 0362-READ-ELCRTO.
  6378     display ' made it to 0362 '
  6379
  6380* EXEC CICS READ
  6381*        DATASET   (WS-ELCRTO-FILE-ID)
  6382*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6383*        RIDFLD    (ELCRTO-KEY)
  6384*        GTEQ
  6385*        RESP      (WS-RESPONSE)
  6386*    END-EXEC
  6387*    MOVE '&"S        G          (  N#00006289' TO DFHEIV0
  6388     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6389     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6390     MOVE X'204E233030303036323839' TO DFHEIV0(25:11)
  6391     CALL 'kxdfhei1' USING DFHEIV0,
  6392           WS-ELCRTO-FILE-ID,
  6393           DFHEIV20,
  6394           DFHEIV99,
  6395           ELCRTO-KEY,
  6396           DFHEIV99,
  6397           DFHEIV99,
  6398           DFHEIV99
  6399     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6400         DFHEIV20
  6401     MOVE EIBRESP  TO WS-RESPONSE
  6402     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6403     .
  6404 0362-EXIT.
  6405     EXIT.
  6406 0363-READ-ELCRTO-UPD.
  6407     display ' made it to 0363 '
  6408
  6409* EXEC CICS READ
  6410*        DATASET   (WS-ELCRTO-FILE-ID)
  6411*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6412*        RIDFLD    (ELCRTO-KEY)
  6413*        UPDATE
  6414*        RESP      (WS-RESPONSE)
  6415*    END-EXEC
  6416*    MOVE '&"S        EU         (  N#00006301' TO DFHEIV0
  6417     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6418     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6419     MOVE X'204E233030303036333031' TO DFHEIV0(25:11)
  6420     CALL 'kxdfhei1' USING DFHEIV0,
  6421           WS-ELCRTO-FILE-ID,
  6422           DFHEIV20,
  6423           DFHEIV99,
  6424           ELCRTO-KEY,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 113
* EL6317.cbl
  6425           DFHEIV99,
  6426           DFHEIV99,
  6427           DFHEIV99
  6428     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6429         DFHEIV20
  6430     MOVE EIBRESP  TO WS-RESPONSE
  6431     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6432     .
  6433 0363-EXIT.
  6434     EXIT.
  6435 0365-READ-ERENDT.
  6436
  6437* EXEC CICS READ
  6438*        DATASET   (WS-ERENDT-FILE-ID)
  6439*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6440*        RIDFLD    (ERENDT-KEY)
  6441*        RESP      (WS-RESPONSE)
  6442*    END-EXEC
  6443*    MOVE '&"S        E          (  N#00006312' TO DFHEIV0
  6444     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6445     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6446     MOVE X'204E233030303036333132' TO DFHEIV0(25:11)
  6447     CALL 'kxdfhei1' USING DFHEIV0,
  6448           WS-ERENDT-FILE-ID,
  6449           DFHEIV20,
  6450           DFHEIV99,
  6451           ERENDT-KEY,
  6452           DFHEIV99,
  6453           DFHEIV99,
  6454           DFHEIV99
  6455     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6456         DFHEIV20
  6457     MOVE EIBRESP  TO WS-RESPONSE
  6458     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6459     .
  6460 0365-EXIT.
  6461     EXIT.
  6462 0400-ADD-ERENDT.
  6463     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6464     display ' made it to 0400 '
  6465
  6466* EXEC CICS GETMAIN
  6467*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6468*         LENGTH   (ERENDT-LENGTH)
  6469*         INITIMG  (GETMAIN-SPACE)
  6470*    END-EXEC
  6471*    MOVE ',"IL                  $   #00006324' TO DFHEIV0
  6472     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6473     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6474     MOVE X'2020233030303036333234' TO DFHEIV0(25:11)
  6475     CALL 'kxdfhei1' USING DFHEIV0,
  6476           DFHEIV20,
  6477           ERENDT-LENGTH,
  6478           GETMAIN-SPACE
  6479     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6480         DFHEIV20
  6481     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6482     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 114
* EL6317.cbl
  6483     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6484     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6485     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6486                                    EN-INPUT-DT
  6487                                    EN-PROCESS-DT
  6488
  6489     MOVE OC-INS-FIRST-NAME    TO EN-INS-ORIG-FIRST-NAME
  6490     MOVE OC-INS-MIDDLE-INIT   TO EN-INS-ORIG-MIDDLE-INIT
  6491     MOVE OC-INS-LAST-NAME     TO EN-INS-ORIG-LAST-NAME
  6492     MOVE OC-INS-AGE           TO EN-INS-ORIG-AGE
  6493     MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-ORIG-AGE-DEF-FLAG
  6494     MOVE OC-JNT-FIRST-NAME    TO EN-JNT-ORIG-FIRST-NAME
  6495     MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-ORIG-MIDDLE-INIT
  6496     MOVE OC-JNT-LAST-NAME     TO EN-JNT-ORIG-LAST-NAME
  6497     MOVE OC-JNT-AGE           TO EN-JNT-ORIG-AGE
  6498     MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-ORIG-AGE-DEF-FLAG
  6499     MOVE OC-LF-BENCD          TO EN-LF-ORIG-BENCD
  6500     IF OC-LF-BENCD NOT = '00' AND '  '
  6501        MOVE OC-LF-BEN-AMT       TO EN-LF-ORIG-BEN-AMT
  6502        MOVE OC-LF-PRM-AMT       TO EN-LF-ORIG-PRM-AMT
  6503        MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-ORIG-ALT-BEN-AMT
  6504        MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-ORIG-ALT-PRM-AMT
  6505        MOVE OC-LF-TERM          TO EN-LF-ORIG-TERM
  6506        MOVE OC-LF-EXP-DT        TO EN-LF-ORIG-EXP-DT
  6507        MOVE OC-LF-COMM-PCT      TO EN-LF-ORIG-COMM-PCT
  6508     END-IF
  6509     MOVE OC-AH-BENCD          TO EN-AH-ORIG-BENCD
  6510     IF OC-AH-BENCD NOT = '00' AND '  '
  6511        MOVE OC-AH-BEN-AMT       TO EN-AH-ORIG-BEN-AMT
  6512        MOVE OC-AH-PRM-AMT       TO EN-AH-ORIG-PRM-AMT
  6513        MOVE OC-AH-TERM          TO EN-AH-ORIG-TERM
  6514        MOVE OC-AH-EXP-DT        TO EN-AH-ORIG-EXP-DT
  6515        MOVE OC-AH-CP            TO EN-AH-ORIG-CP
  6516        MOVE OC-AH-COMM-PCT      TO EN-AH-ORIG-COMM-PCT
  6517     END-IF
  6518     MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6519
  6520     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  6521       OR 'EL6314'
  6522         display 'from ' PI-RETURN-TO-PROGRAM
  6523                 ', using crto for new crto'
  6524
  6525        MOVE OC-INS-FIRST-NAME    TO EN-INS-NEW-FIRST-NAME
  6526                                     NCRTO-INS-FIRST-NAME
  6527        MOVE OC-INS-MIDDLE-INIT   TO EN-INS-NEW-MIDDLE-INIT
  6528                                     NCRTO-INS-MIDDLE-INIT
  6529        MOVE OC-INS-LAST-NAME     TO EN-INS-NEW-LAST-NAME
  6530                                     NCRTO-INS-LAST-NAME
  6531        MOVE OC-INS-AGE           TO EN-INS-NEW-AGE
  6532                                     NCRTO-INS-AGE
  6533        MOVE OC-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  6534                                     NCRTO-INS-AGE-DEFAULT-FLAG
  6535        MOVE OC-JNT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6536                                     NCRTO-JNT-FIRST-NAME
  6537        MOVE OC-JNT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6538                                     NCRTO-JNT-MIDDLE-INIT
  6539        MOVE OC-JNT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6540                                     NCRTO-JNT-LAST-NAME
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 115
* EL6317.cbl
  6541        MOVE OC-JNT-AGE           TO EN-JNT-NEW-AGE
  6542                                     NCRTO-JNT-AGE
  6543        MOVE OC-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  6544                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  6545        MOVE OC-LF-BENCD          TO EN-LF-NEW-BENCD
  6546                                     NCRTO-LF-BENCD
  6547        IF OC-LF-BENCD NOT = '00' AND '  '
  6548           MOVE OC-LF-BEN-AMT       TO EN-LF-NEW-BEN-AMT
  6549                                       NCRTO-LF-BEN-AMT
  6550           MOVE OC-LF-PRM-AMT       TO EN-LF-NEW-PRM-AMT
  6551                                       NCRTO-LF-PRM-AMT
  6552           MOVE OC-LF-ALT-BEN-AMT   TO EN-LF-NEW-ALT-BEN-AMT
  6553                                       NCRTO-LF-ALT-BEN-AMT
  6554           MOVE OC-LF-ALT-PRM-AMT   TO EN-LF-NEW-ALT-PRM-AMT
  6555                                       NCRTO-LF-ALT-PRM-AMT
  6556           MOVE OC-LF-TERM          TO EN-LF-NEW-TERM
  6557                                       NCRTO-LF-TERM
  6558           MOVE OC-LF-EXP-DT        TO EN-LF-NEW-EXP-DT
  6559                                       NCRTO-LF-EXP-DT
  6560           MOVE OC-LF-COMM-PCT      TO EN-LF-NEW-COMM-PCT
  6561                                       NCRTO-LF-COMM-PCT
  6562           MOVE OC-LF-CANCEL-DT     TO NCRTO-LF-CANCEL-DT
  6563           MOVE OC-LF-CANCEL-AMT    TO NCRTO-LF-CANCEL-AMT
  6564           MOVE OC-LF-ITD-CANCEL-AMT TO NCRTO-LF-ITD-CANCEL-AMT
  6565        END-IF
  6566        MOVE OC-AH-BENCD          TO EN-AH-NEW-BENCD
  6567                                     NCRTO-AH-BENCD
  6568        IF OC-AH-BENCD NOT = '00' AND '  '
  6569           MOVE OC-AH-BEN-AMT       TO EN-AH-NEW-BEN-AMT
  6570                                       NCRTO-AH-BEN-AMT
  6571           MOVE OC-AH-PRM-AMT       TO EN-AH-NEW-PRM-AMT
  6572                                       NCRTO-AH-PRM-AMT
  6573           MOVE OC-AH-TERM          TO EN-AH-NEW-TERM
  6574                                       NCRTO-AH-TERM
  6575           MOVE OC-AH-EXP-DT        TO EN-AH-NEW-EXP-DT
  6576                                       NCRTO-AH-EXP-DT
  6577           MOVE OC-AH-CP            TO EN-AH-NEW-CP
  6578                                       NCRTO-AH-CP
  6579           MOVE OC-AH-COMM-PCT      TO EN-AH-NEW-COMM-PCT
  6580                                       NCRTO-AH-COMM-PCT
  6581           MOVE OC-AH-CANCEL-DT     TO NCRTO-AH-CANCEL-DT
  6582           MOVE OC-AH-CANCEL-AMT    TO NCRTO-AH-CANCEL-AMT
  6583           MOVE OC-AH-ITD-CANCEL-AMT TO NCRTO-AH-ITD-CANCEL-AMT
  6584        END-IF
  6585        MOVE OC-CRED-BENE-NAME      TO EN-ORIG-CRED-BENE
  6586                                       NCRTO-CRED-BENE-NAME
  6587
  6588        GO TO 0400-WRITE-ENDT
  6589     END-IF
  6590
  6591* EXEC CICS GETMAIN
  6592*         SET      (ADDRESS OF PENDING-BUSINESS)
  6593*         LENGTH   (ERPNDB-LENGTH)
  6594*         INITIMG  (GETMAIN-SPACE)
  6595*    END-EXEC
  6596*    MOVE ',"IL                  $   #00006437' TO DFHEIV0
  6597     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6598     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 116
* EL6317.cbl
  6599     MOVE X'2020233030303036343337' TO DFHEIV0(25:11)
  6600     CALL 'kxdfhei1' USING DFHEIV0,
  6601           DFHEIV20,
  6602           ERPNDB-LENGTH,
  6603           GETMAIN-SPACE
  6604     SET ADDRESS OF PENDING-BUSINESS TO
  6605         DFHEIV20
  6606     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6607     DISPLAY ' JUST DID GETMAIN ON ERPNDB '
  6608     MOVE PI-ERPNDB-KEY          TO ERPNDB-KEY
  6609
  6610* EXEC CICS READ
  6611*        DATASET   (WS-ERPNDB-FILE-ID)
  6612*        INTO      (PENDING-BUSINESS)
  6613*        RIDFLD    (ERPNDB-KEY)
  6614*        RESP      (WS-RESPONSE)
  6615*    END-EXEC
  6616     MOVE LENGTH OF
  6617      PENDING-BUSINESS
  6618       TO DFHEIV11
  6619*    MOVE '&"IL       E          (  N#00006444' TO DFHEIV0
  6620     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  6621     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6622     MOVE X'204E233030303036343434' TO DFHEIV0(25:11)
  6623     CALL 'kxdfhei1' USING DFHEIV0,
  6624           WS-ERPNDB-FILE-ID,
  6625           PENDING-BUSINESS,
  6626           DFHEIV11,
  6627           ERPNDB-KEY,
  6628           DFHEIV99,
  6629           DFHEIV99,
  6630           DFHEIV99
  6631     MOVE EIBRESP  TO WS-RESPONSE
  6632     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6633     IF NOT RESP-NORMAL
  6634        GO TO 0400-EXIT
  6635     END-IF
  6636*    set found-pndb to true
  6637     display ' good read on erpndb '
  6638     MOVE PB-I-INSURED-FIRST-NAME  TO EN-INS-NEW-FIRST-NAME
  6639                                      NCRTO-INS-FIRST-NAME
  6640     MOVE PB-I-INSURED-MIDDLE-INIT TO EN-INS-NEW-MIDDLE-INIT
  6641                                      NCRTO-INS-MIDDLE-INIT
  6642     MOVE PB-I-INSURED-LAST-NAME   TO EN-INS-NEW-LAST-NAME
  6643                                      NCRTO-INS-LAST-NAME
  6644     MOVE PB-I-AGE                 TO EN-INS-NEW-AGE
  6645                                      NCRTO-INS-AGE
  6646     MOVE PB-I-JOINT-FIRST-NAME    TO EN-JNT-NEW-FIRST-NAME
  6647                                      NCRTO-JNT-FIRST-NAME
  6648     MOVE PB-I-JOINT-MIDDLE-INIT   TO EN-JNT-NEW-MIDDLE-INIT
  6649                                      NCRTO-JNT-MIDDLE-INIT
  6650     MOVE PB-I-JOINT-LAST-NAME     TO EN-JNT-NEW-LAST-NAME
  6651                                      NCRTO-JNT-LAST-NAME
  6652     MOVE PB-I-JOINT-AGE           TO EN-JNT-NEW-AGE
  6653                                      NCRTO-JNT-AGE
  6654     MOVE PB-I-LF-BENEFIT-CD       TO EN-LF-NEW-BENCD
  6655                                      NCRTO-LF-BENCD
  6656     IF PB-I-LF-BENEFIT-CD NOT = '00' AND '  '
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 117
* EL6317.cbl
  6657        MOVE PB-I-LF-BENEFIT-AMT   TO EN-LF-NEW-BEN-AMT
  6658                                      NCRTO-LF-BEN-AMT
  6659        MOVE PB-I-LF-PREMIUM-AMT   TO EN-LF-NEW-PRM-AMT
  6660                                      NCRTO-LF-PRM-AMT
  6661        MOVE PB-I-LF-ALT-BENEFIT-AMT TO EN-LF-NEW-ALT-BEN-AMT
  6662                                      NCRTO-LF-ALT-BEN-AMT
  6663        MOVE PB-I-LF-ALT-PREMIUM-AMT TO EN-LF-NEW-ALT-PRM-AMT
  6664                                      NCRTO-LF-ALT-PRM-AMT
  6665        MOVE PB-I-LF-TERM          TO EN-LF-NEW-TERM
  6666                                      NCRTO-LF-TERM
  6667        MOVE PB-I-LF-EXPIRE-DT     TO EN-LF-NEW-EXP-DT
  6668                                      NCRTO-LF-EXP-DT
  6669        IF PB-I-JOINT-COMMISSION > +0
  6670           MOVE PB-I-JOINT-COMMISSION
  6671                                   TO EN-LF-NEW-COMM-PCT
  6672                                      NCRTO-LF-COMM-PCT
  6673        ELSE
  6674           MOVE PB-I-LIFE-COMMISSION
  6675                                   TO EN-LF-NEW-COMM-PCT
  6676                                      NCRTO-LF-COMM-PCT
  6677        MOVE LOW-VALUES            TO NCRTO-LF-CANCEL-DT
  6678        MOVE +0                    TO NCRTO-LF-CANCEL-AMT
  6679                                      NCRTO-LF-ITD-CANCEL-AMT
  6680        END-IF
  6681     END-IF
  6682     MOVE PB-I-AH-BENEFIT-CD       TO EN-AH-NEW-BENCD
  6683                                      NCRTO-AH-BENCD
  6684     IF PB-I-AH-BENEFIT-CD NOT = '00' AND '  '
  6685        MOVE PB-I-AH-BENEFIT-AMT   TO EN-AH-NEW-BEN-AMT
  6686                                      NCRTO-AH-BEN-AMT
  6687        MOVE PB-I-AH-PREMIUM-AMT   TO EN-AH-NEW-PRM-AMT
  6688                                      NCRTO-AH-PRM-AMT
  6689        MOVE PB-I-AH-TERM          TO EN-AH-NEW-TERM
  6690                                      NCRTO-AH-TERM
  6691        MOVE PB-I-AH-EXPIRE-DT     TO EN-AH-NEW-EXP-DT
  6692                                      NCRTO-AH-EXP-DT
  6693        MOVE PB-I-AH-CRIT-PER      TO EN-AH-NEW-CP
  6694                                      NCRTO-AH-CP
  6695        MOVE PB-I-AH-COMMISSION    TO EN-AH-NEW-COMM-PCT
  6696                                      NCRTO-AH-COMM-PCT
  6697        MOVE LOW-VALUES            TO NCRTO-AH-CANCEL-DT
  6698        MOVE +0                    TO NCRTO-AH-CANCEL-AMT
  6699                                      NCRTO-AH-ITD-CANCEL-AMT
  6700     END-IF
  6701     MOVE PB-I-1ST-PMT-DT          TO NCRTO-1ST-PMT-DT
  6702     MOVE PB-ENTRY-BATCH           TO EN-BATCH-NUMBER
  6703     move pb-control-by-account (1:33)
  6704                                 to ws-ermail-key
  6705
  6706* EXEC CICS READ
  6707*        DATASET   ('ERMAIL')
  6708*        SET       (ADDRESS OF MAILING-DATA)
  6709*        RIDFLD    (WS-ERMAIL-KEY)
  6710*        RESP      (WS-RESPONSE)
  6711*    END-EXEC
  6712     MOVE 'ERMAIL' TO DFHEIV1
  6713*    MOVE '&"S        E          (  N#00006522' TO DFHEIV0
  6714     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 118
* EL6317.cbl
  6715     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6716     MOVE X'204E233030303036353232' TO DFHEIV0(25:11)
  6717     CALL 'kxdfhei1' USING DFHEIV0,
  6718           DFHEIV1,
  6719           DFHEIV20,
  6720           DFHEIV99,
  6721           WS-ERMAIL-KEY,
  6722           DFHEIV99,
  6723           DFHEIV99,
  6724           DFHEIV99
  6725     SET ADDRESS OF MAILING-DATA TO
  6726         DFHEIV20
  6727     MOVE EIBRESP  TO WS-RESPONSE
  6728     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6729     IF RESP-NORMAL
  6730        DISPLAY ' FOUND ERMAIL '
  6731        MOVE MA-CRED-BENE-NAME   TO EN-NEW-CRED-BENE
  6732                                    NCRTO-CRED-BENE-NAME
  6733     ELSE
  6734        DISPLAY ' ERMAIL READ ' WS-RESPONSE
  6735     END-IF
  6736
  6737     MOVE PB-CONTROL-BY-ACCOUNT (1:33) TO WS-ELCRTT-PRIMARY
  6738     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  6739
  6740
  6741* EXEC CICS READ
  6742*         DATASET  (WS-ELCRTT-FILE-ID)
  6743*         RIDFLD   (WS-ELCRTT-KEY)
  6744*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  6745*         RESP     (WS-RESPONSE)
  6746*    END-EXEC
  6747*    MOVE '&"S        E          (  N#00006539' TO DFHEIV0
  6748     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6749     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6750     MOVE X'204E233030303036353339' TO DFHEIV0(25:11)
  6751     CALL 'kxdfhei1' USING DFHEIV0,
  6752           WS-ELCRTT-FILE-ID,
  6753           DFHEIV20,
  6754           DFHEIV99,
  6755           WS-ELCRTT-KEY,
  6756           DFHEIV99,
  6757           DFHEIV99,
  6758           DFHEIV99
  6759     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  6760         DFHEIV20
  6761     MOVE EIBRESP  TO WS-RESPONSE
  6762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6763
  6764     IF RESP-NORMAL
  6765        MOVE CS-INS-AGE-DEFAULT-FLAG TO EN-INS-NEW-AGE-DEF-FLAG
  6766                                     NCRTO-INS-AGE-DEFAULT-FLAG
  6767        MOVE CS-JNT-AGE-DEFAULT-FLAG TO EN-JNT-NEW-AGE-DEF-FLAG
  6768                                     NCRTO-JNT-AGE-DEFAULT-FLAG
  6769     END-IF.
  6770      .
  6771 0400-WRITE-ENDT.
  6772
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 119
* EL6317.cbl
  6773     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6774        IF REACD-IN (S1) NOT = LOW-VALUES
  6775           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6776        END-IF
  6777     END-PERFORM
  6778     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6779     MOVE 'V'                    TO EN-DOCU-TYPE
  6780     MOVE ' '                    TO EN-MONEY-SW
  6781     MOVE SIGREQI                TO EN-SIG-SW
  6782     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6783     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6784     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6785*    IF NOT EMI-NO-ERRORS
  6786*       DISPLAY ' GOING TO 8200 FROM 0400 '
  6787*       GO TO 8200-SEND-DATAONLY
  6788*    END-IF
  6789     DISPLAY ' 0400 EXIT '
  6790     .
  6791 0400-EXIT.
  6792     EXIT.
  6793 0410-INIT-ERENDT.
  6794     display ' made it to 0410 '
  6795     MOVE OC-CONTROL-PRIMARY     TO ERENDT-KEY
  6796     MOVE ZEROS                  TO ENDT-SEQ-NO
  6797
  6798* EXEC CICS READ
  6799*        DATASET    (WS-ERENDT-FILE-ID)
  6800*        RIDFLD     (ERENDT-KEY)
  6801*        INTO       (ENDORSEMENT-RECORD)
  6802*        RESP       (WS-RESPONSE)
  6803*        GTEQ
  6804*    END-EXEC
  6805     MOVE LENGTH OF
  6806      ENDORSEMENT-RECORD
  6807       TO DFHEIV11
  6808*    MOVE '&"IL       G          (  N#00006579' TO DFHEIV0
  6809     MOVE X'2622494C2020202020202047' TO DFHEIV0(1:12)
  6810     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6811     MOVE X'204E233030303036353739' TO DFHEIV0(25:11)
  6812     CALL 'kxdfhei1' USING DFHEIV0,
  6813           WS-ERENDT-FILE-ID,
  6814           ENDORSEMENT-RECORD,
  6815           DFHEIV11,
  6816           ERENDT-KEY,
  6817           DFHEIV99,
  6818           DFHEIV99,
  6819           DFHEIV99
  6820     MOVE EIBRESP  TO WS-RESPONSE
  6821     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6822     IF RESP-NORMAL
  6823        AND (EN-CONTROL-PRIMARY (1:34) =
  6824           OC-CONTROL-PRIMARY (1:34))
  6825        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6826     ELSE
  6827        MOVE +4096               TO WS-SEQ-NO
  6828     END-IF
  6829     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6830     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 120
* EL6317.cbl
  6831     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6832     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6833     INITIALIZE EN-ISSUE-RECORD
  6834     MOVE LOW-VALUES             TO EN-LF-ORIG-EXP-DT
  6835                                    EN-AH-ORIG-EXP-DT
  6836                                    EN-LF-NEW-EXP-DT
  6837                                    EN-AH-NEW-EXP-DT
  6838                                    EN-PROCESS-DT
  6839     .
  6840 0410-EXIT.
  6841     EXIT.
  6842 0420-UPDATE-ELCRTO.
  6843     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6844     IF RESP-NORMAL
  6845        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6846                                    OC-LAST-MAINT-DT
  6847        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6848        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6849
  6850* EXEC CICS REWRITE
  6851*          FROM     (ORIGINAL-CERTIFICATE)
  6852*          DATASET  ('ELCRTO')
  6853*       END-EXEC
  6854     MOVE LENGTH OF
  6855      ORIGINAL-CERTIFICATE
  6856       TO DFHEIV11
  6857     MOVE 'ELCRTO' TO DFHEIV1
  6858*    MOVE '&& L                  %   #00006613' TO DFHEIV0
  6859     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6860     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6861     MOVE X'2020233030303036363133' TO DFHEIV0(25:11)
  6862     CALL 'kxdfhei1' USING DFHEIV0,
  6863           DFHEIV1,
  6864           ORIGINAL-CERTIFICATE,
  6865           DFHEIV11,
  6866           DFHEIV99
  6867     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6868     END-IF
  6869     .
  6870 0420-EXIT.
  6871     EXIT.
  6872
  6873 0425-ADD-NEW-ELCRTO.
  6874     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6875     MOVE 'OC'                   TO OC-RECORD-ID
  6876     MOVE NEW-ELCRTO-KEY         TO OC-CONTROL-PRIMARY
  6877     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6878     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6879     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6880     MOVE NCRTO-INS-FIRST-NAME   TO OC-INS-FIRST-NAME
  6881     MOVE NCRTO-INS-MIDDLE-INIT  TO OC-INS-MIDDLE-INIT
  6882     MOVE NCRTO-INS-LAST-NAME    TO OC-INS-LAST-NAME
  6883     MOVE NCRTO-INS-AGE          TO OC-INS-AGE
  6884     MOVE NCRTO-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  6885     MOVE NCRTO-JNT-FIRST-NAME   TO OC-JNT-FIRST-NAME
  6886     MOVE NCRTO-JNT-MIDDLE-INIT  TO OC-JNT-MIDDLE-INIT
  6887     MOVE NCRTO-JNT-LAST-NAME    TO OC-JNT-LAST-NAME
  6888     MOVE NCRTO-JNT-AGE          TO OC-JNT-AGE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 121
* EL6317.cbl
  6889     MOVE NCRTO-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  6890     MOVE NCRTO-LF-BENCD         TO OC-LF-BENCD
  6891     MOVE NCRTO-LF-BEN-AMT       TO OC-LF-BEN-AMT
  6892     MOVE NCRTO-LF-PRM-AMT       TO OC-LF-PRM-AMT
  6893     MOVE NCRTO-LF-ALT-BEN-AMT   TO OC-LF-ALT-BEN-AMT
  6894     MOVE NCRTO-LF-ALT-PRM-AMT   TO OC-LF-ALT-PRM-AMT
  6895     MOVE NCRTO-LF-TERM          TO OC-LF-TERM
  6896     MOVE NCRTO-LF-EXP-DT        TO OC-LF-EXP-DT
  6897     MOVE NCRTO-LF-COMM-PCT      TO OC-LF-COMM-PCT
  6898     MOVE NCRTO-LF-CANCEL-DT     TO OC-LF-CANCEL-DT
  6899     MOVE NCRTO-LF-CANCEL-AMT    TO OC-LF-CANCEL-AMT
  6900     MOVE NCRTO-LF-ITD-CANCEL-AMT TO OC-LF-ITD-CANCEL-AMT
  6901     MOVE NCRTO-AH-BENCD         TO OC-AH-BENCD
  6902     MOVE NCRTO-AH-BEN-AMT       TO OC-AH-BEN-AMT
  6903     MOVE NCRTO-AH-PRM-AMT       TO OC-AH-PRM-AMT
  6904     MOVE NCRTO-AH-TERM          TO OC-AH-TERM
  6905     MOVE NCRTO-AH-EXP-DT        TO OC-AH-EXP-DT
  6906     MOVE NCRTO-AH-CP            TO OC-AH-CP
  6907     MOVE NCRTO-AH-COMM-PCT      TO OC-AH-COMM-PCT
  6908     MOVE NCRTO-AH-CANCEL-DT     TO OC-AH-CANCEL-DT
  6909     MOVE NCRTO-AH-CANCEL-AMT    TO OC-AH-CANCEL-AMT
  6910     MOVE NCRTO-AH-ITD-CANCEL-AMT TO OC-AH-ITD-CANCEL-AMT
  6911     MOVE NCRTO-CRED-BENE-NAME   TO OC-CRED-BENE-NAME
  6912     MOVE NCRTO-1ST-PMT-DT       TO OC-1ST-PMT-DT
  6913     MOVE 'Y'                    TO OC-ISSUE-TRAN-IND
  6914     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
  6915     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  6916     .
  6917 0425-WRITE-ELCRTO.
  6918
  6919
  6920* EXEC CICS WRITE
  6921*       DATASET   ('ELCRTO')
  6922*       FROM      (ORIGINAL-CERTIFICATE)
  6923*       RIDFLD    (OC-CONTROL-PRIMARY)
  6924*       RESP      (WS-RESPONSE)
  6925*    END-EXEC
  6926     MOVE LENGTH OF
  6927      ORIGINAL-CERTIFICATE
  6928       TO DFHEIV11
  6929     MOVE 'ELCRTO' TO DFHEIV1
  6930*    MOVE '&$ L                  ''  N#00006668' TO DFHEIV0
  6931     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  6932     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  6933     MOVE X'204E233030303036363638' TO DFHEIV0(25:11)
  6934     CALL 'kxdfhei1' USING DFHEIV0,
  6935           DFHEIV1,
  6936           ORIGINAL-CERTIFICATE,
  6937           DFHEIV11,
  6938           OC-CONTROL-PRIMARY,
  6939           DFHEIV99,
  6940           DFHEIV99
  6941     MOVE EIBRESP  TO WS-RESPONSE
  6942     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6943
  6944     display ' just wrote new crto ' ws-response
  6945                           ' ' oc-key-seq-no
  6946     IF RESP-DUPKEY
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 122
* EL6317.cbl
  6947        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  6948        GO TO 0425-WRITE-ELCRTO
  6949     ELSE
  6950        IF NOT RESP-NORMAL
  6951           MOVE -1               TO SIGREQL
  6952           MOVE ER-3830          TO EMI-ERROR
  6953           PERFORM 9900-ERROR-FORMAT
  6954                                 THRU 9900-EXIT
  6955        ELSE
  6956           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  6957        END-IF
  6958     END-IF
  6959
  6960     .
  6961 0425-EXIT.
  6962     EXIT.
  6963
  6964 0426-ADD-CERT-NOTES.
  6965
  6966     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  6967     SET TB-INDX TO 1
  6968
  6969     IF PI-CERTNT1-ENTERED > SPACES
  6970         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6971         MOVE PI-PROCESSOR-ID    TO
  6972                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6973         MOVE EIBTIME            TO
  6974                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6975         MOVE WS-CURRENT-BIN-DT  TO
  6976                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6977         SET TB-INDX UP BY +1
  6978     END-IF
  6979
  6980     IF PI-CERTNT2-ENTERED > SPACES
  6981         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  6982         MOVE PI-PROCESSOR-ID    TO
  6983                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  6984         MOVE EIBTIME            TO
  6985                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  6986         MOVE WS-CURRENT-BIN-DT  TO
  6987                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  6988         SET TB-INDX UP BY +1
  6989     END-IF
  6990
  6991     IF CERT-NOTE-ENTRIES > SPACES
  6992         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  6993         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  6994     END-IF
  6995
  6996     IF PI-BILLNT1-ENTERED > SPACES
  6997         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  6998         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  6999         MOVE +63 TO WS-LEN
  7000         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7001     END-IF
  7002
  7003     IF PI-BILLNT2-ENTERED > SPACES
  7004         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 123
* EL6317.cbl
  7005         MOVE PI-BILLNT2-ENTERED TO WS-MAN-BN-NOTE
  7006         MOVE +63 TO WS-LEN
  7007         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7008     END-IF
  7009
  7010     .
  7011 0426-EXIT.
  7012     EXIT.
  7013
  7014 0427-LOAD-CURRENT-CERT-NOTES.
  7015
  7016     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  7017     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  7018     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  7019     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  7020     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  7021     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  7022     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  7023     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  7024     MOVE '1'                 TO ERCNOT-REC-TYP
  7025     MOVE +0                  TO ERCNOT-SEQ
  7026     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  7027
  7028
  7029* EXEC CICS STARTBR
  7030*         DATASET(WS-ERCNOT-FILE-ID)
  7031*         RIDFLD(ERCNOT-KEY)
  7032*         KEYLENGTH(ERCNOT-START-LENGTH)
  7033*         RESP      (WS-RESPONSE)
  7034*         GENERIC
  7035*         GTEQ
  7036*    END-EXEC.
  7037     MOVE 0
  7038       TO DFHEIV11
  7039*    MOVE '&,   KG    G          &  N#00006759' TO DFHEIV0
  7040     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  7041     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7042     MOVE X'204E233030303036373539' TO DFHEIV0(25:11)
  7043     CALL 'kxdfhei1' USING DFHEIV0,
  7044           WS-ERCNOT-FILE-ID,
  7045           ERCNOT-KEY,
  7046           ERCNOT-START-LENGTH,
  7047           DFHEIV11,
  7048           DFHEIV99
  7049     MOVE EIBRESP  TO WS-RESPONSE
  7050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7051
  7052
  7053     IF NOT RESP-NORMAL
  7054        GO TO 0427-ENDBR
  7055     END-IF.
  7056
  7057 0427-LOOP.
  7058
  7059* EXEC CICS READNEXT
  7060*         SET(ADDRESS OF CERT-NOTE-FILE)
  7061*         DATASET(WS-ERCNOT-FILE-ID)
  7062*         RIDFLD(ERCNOT-KEY)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 124
* EL6317.cbl
  7063*    END-EXEC.
  7064     MOVE 0
  7065       TO DFHEIV11
  7066*    MOVE '&.S                   )   #00006773' TO DFHEIV0
  7067     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7068     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7069     MOVE X'2020233030303036373733' TO DFHEIV0(25:11)
  7070     CALL 'kxdfhei1' USING DFHEIV0,
  7071           WS-ERCNOT-FILE-ID,
  7072           DFHEIV20,
  7073           DFHEIV99,
  7074           ERCNOT-KEY,
  7075           DFHEIV99,
  7076           DFHEIV11,
  7077           DFHEIV99,
  7078           DFHEIV99
  7079     SET ADDRESS OF CERT-NOTE-FILE TO
  7080         DFHEIV20
  7081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7082
  7083
  7084     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  7085         GO TO 0427-ENDBR
  7086     END-IF.
  7087
  7088     IF (CZ-CARRIER = SV-CARRIER)
  7089        AND (CZ-GROUPING = SV-GROUPING)
  7090        AND (CZ-STATE = SV-STATE)
  7091        AND (CZ-ACCOUNT = SV-ACCOUNT)
  7092        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  7093        AND (CZ-CERT-NO = SV-CERT-NO)
  7094        AND (CZ-RECORD-TYPE = '1')
  7095          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  7096          MOVE CZ-LAST-MAINT-USER TO
  7097                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7098          MOVE CZ-LAST-MAINT-DT TO
  7099                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7100          MOVE CZ-LAST-MAINT-HHMMSS TO
  7101                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7102          SET TB-INDX UP BY 1
  7103          GO TO 0427-LOOP
  7104     END-IF.
  7105
  7106 0427-ENDBR.
  7107
  7108
  7109* EXEC CICS ENDBR
  7110*         DATASET(WS-ERCNOT-FILE-ID)
  7111*    END-EXEC.
  7112     MOVE 0
  7113       TO DFHEIV11
  7114*    MOVE '&2                    $   #00006803' TO DFHEIV0
  7115     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7116     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7117     MOVE X'2020233030303036383033' TO DFHEIV0(25:11)
  7118     CALL 'kxdfhei1' USING DFHEIV0,
  7119           WS-ERCNOT-FILE-ID,
  7120           DFHEIV11,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 125
* EL6317.cbl
  7121           DFHEIV99
  7122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7123
  7124
  7125     .
  7126 0427-EXIT.
  7127     EXIT.
  7128
  7129 0430-WRITE-ERENDT.
  7130     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  7131     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  7132     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  7133
  7134* EXEC CICS WRITE
  7135*         DATASET   (WS-ERENDT-FILE-ID)
  7136*         FROM      (ENDORSEMENT-RECORD)
  7137*         RIDFLD    (EN-CONTROL-PRIMARY)
  7138*         RESP      (WS-RESPONSE)
  7139*    END-EXEC
  7140     MOVE LENGTH OF
  7141      ENDORSEMENT-RECORD
  7142       TO DFHEIV11
  7143*    MOVE '&$ L                  ''  N#00006815' TO DFHEIV0
  7144     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7145     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7146     MOVE X'204E233030303036383135' TO DFHEIV0(25:11)
  7147     CALL 'kxdfhei1' USING DFHEIV0,
  7148           WS-ERENDT-FILE-ID,
  7149           ENDORSEMENT-RECORD,
  7150           DFHEIV11,
  7151           EN-CONTROL-PRIMARY,
  7152           DFHEIV99,
  7153           DFHEIV99
  7154     MOVE EIBRESP  TO WS-RESPONSE
  7155     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7156     IF RESP-NORMAL
  7157        MOVE 'V'                 TO PI-DOCUMENT-PROCESSED
  7158        display ' good write erendt '
  7159        IF EIBAID = DFHPF4
  7160           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  7161           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  7162           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  7163           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  7164        END-IF
  7165     ELSE
  7166        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  7167        MOVE -1                  TO CARRL
  7168        MOVE ER-0132             TO EMI-ERROR
  7169        MOVE AL-UABON            TO CARRA
  7170        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7171     END-IF
  7172     .
  7173 0430-EXIT.
  7174     EXIT.
  7175 0440-ADD-BILLING-NOTE.
  7176
  7177* EXEC CICS GETMAIN
  7178*         SET      (ADDRESS OF EOB-CODES)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 126
* EL6317.cbl
  7179*         LENGTH   (ELEOBC-LENGTH)
  7180*         INITIMG  (GETMAIN-SPACE)
  7181*    END-EXEC
  7182*    MOVE ',"IL                  $   #00006841' TO DFHEIV0
  7183     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7184     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7185     MOVE X'2020233030303036383431' TO DFHEIV0(25:11)
  7186     CALL 'kxdfhei1' USING DFHEIV0,
  7187           DFHEIV20,
  7188           ELEOBC-LENGTH,
  7189           GETMAIN-SPACE
  7190     SET ADDRESS OF EOB-CODES TO
  7191         DFHEIV20
  7192     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7193
  7194     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  7195     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  7196     MOVE '5'                    TO WS-EOBC-REC-TYPE
  7197
  7198
  7199* EXEC CICS STARTBR
  7200*        DATASET   ('ELEOBC')
  7201*        RIDFLD    (WS-ELEOBC-KEY)
  7202*        GTEQ
  7203*        RESP      (WS-RESPONSE)
  7204*    END-EXEC
  7205     MOVE 'ELEOBC' TO DFHEIV1
  7206     MOVE 0
  7207       TO DFHEIV11
  7208*    MOVE '&,         G          &  N#00006851' TO DFHEIV0
  7209     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7210     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7211     MOVE X'204E233030303036383531' TO DFHEIV0(25:11)
  7212     CALL 'kxdfhei1' USING DFHEIV0,
  7213           DFHEIV1,
  7214           WS-ELEOBC-KEY,
  7215           DFHEIV99,
  7216           DFHEIV11,
  7217           DFHEIV99
  7218     MOVE EIBRESP  TO WS-RESPONSE
  7219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7220
  7221     IF NOT RESP-NORMAL
  7222        GO TO 0440-EXIT
  7223     END-IF
  7224      .
  7225 0440-READNEXT-ELEOBC.
  7226
  7227
  7228* EXEC CICS READNEXT
  7229*       INTO    (EOB-CODES)
  7230*       DATASET ('ELEOBC')
  7231*       RIDFLD  (WS-ELEOBC-KEY)
  7232*       RESP    (WS-RESPONSE)
  7233*    END-EXEC
  7234     MOVE LENGTH OF
  7235      EOB-CODES
  7236       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 127
* EL6317.cbl
  7237     MOVE 'ELEOBC' TO DFHEIV1
  7238     MOVE 0
  7239       TO DFHEIV11
  7240*    MOVE '&.IL                  )  N#00006864' TO DFHEIV0
  7241     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7242     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7243     MOVE X'204E233030303036383634' TO DFHEIV0(25:11)
  7244     CALL 'kxdfhei1' USING DFHEIV0,
  7245           DFHEIV1,
  7246           EOB-CODES,
  7247           DFHEIV12,
  7248           WS-ELEOBC-KEY,
  7249           DFHEIV99,
  7250           DFHEIV11,
  7251           DFHEIV99,
  7252           DFHEIV99
  7253     MOVE EIBRESP  TO WS-RESPONSE
  7254     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7255
  7256     IF RESP-NORMAL
  7257         IF EO-RECORD-TYPE NOT = '5'
  7258             GO TO 0440-EXIT
  7259         END-IF
  7260     ELSE
  7261         GO TO 0440-EXIT
  7262     END-IF
  7263
  7264     IF EO-RECORD-TYPE = '5' AND
  7265        EO-EOB-CODE = PI-LTRID-ENTERED
  7266           CONTINUE
  7267     ELSE
  7268         GO TO 0440-READNEXT-ELEOBC
  7269     END-IF
  7270
  7271     MOVE SPACES TO WS-BILLING-NOTE
  7272     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  7273     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
  7274     MOVE WS-CURRENT-DT TO WS-BN-DATE
  7275     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  7276     MOVE +25 TO WS-LEN
  7277
  7278     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7279     .
  7280 0440-EXIT.
  7281     EXIT.
  7282
  7283 0441-UPDATE-BILLING-NOTE.
  7284
  7285
  7286* EXEC CICS GETMAIN
  7287*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7288*         LENGTH   (ERNOTE-LENGTH)
  7289*         INITIMG  (GETMAIN-SPACE)
  7290*    END-EXEC
  7291*    MOVE ',"IL                  $   #00006900' TO DFHEIV0
  7292     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7293     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7294     MOVE X'2020233030303036393030' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 128
* EL6317.cbl
  7295     CALL 'kxdfhei1' USING DFHEIV0,
  7296           DFHEIV20,
  7297           ERNOTE-LENGTH,
  7298           GETMAIN-SPACE
  7299     SET ADDRESS OF CERTIFICATE-NOTE TO
  7300         DFHEIV20
  7301     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7302
  7303     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7304     move '1'                    to w-note-record-type
  7305
  7306
  7307* EXEC CICS READ
  7308*       DATASET    (WS-ERNOTE-FILE-ID)
  7309*       RIDFLD     (WS-ERNOTE-KEY)
  7310*       INTO       (CERTIFICATE-NOTE)
  7311*       RESP       (WS-RESPONSE)
  7312*       UPDATE
  7313*    END-EXEC
  7314     MOVE LENGTH OF
  7315      CERTIFICATE-NOTE
  7316       TO DFHEIV11
  7317*    MOVE '&"IL       EU         (  N#00006909' TO DFHEIV0
  7318     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7319     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7320     MOVE X'204E233030303036393039' TO DFHEIV0(25:11)
  7321     CALL 'kxdfhei1' USING DFHEIV0,
  7322           WS-ERNOTE-FILE-ID,
  7323           CERTIFICATE-NOTE,
  7324           DFHEIV11,
  7325           WS-ERNOTE-KEY,
  7326           DFHEIV99,
  7327           DFHEIV99,
  7328           DFHEIV99
  7329     MOVE EIBRESP  TO WS-RESPONSE
  7330     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7331
  7332     IF RESP-NORMAL
  7333       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7334          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7335       END-IF
  7336       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7337          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7338       END-IF
  7339       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7340           (NOTE-SUB > +10) OR
  7341           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7342                             WS-BILLING-NOTE (1:WS-LEN))
  7343       END-PERFORM
  7344       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7345                              WS-BILLING-NOTE (1:WS-LEN)
  7346
  7347* EXEC CICS UNLOCK
  7348*           DATASET    (WS-ERNOTE-FILE-ID)
  7349*        END-EXEC
  7350*    MOVE '&*                    #   #00006931' TO DFHEIV0
  7351     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7352     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 129
* EL6317.cbl
  7353     MOVE X'2020233030303036393331' TO DFHEIV0(25:11)
  7354     CALL 'kxdfhei1' USING DFHEIV0,
  7355           WS-ERNOTE-FILE-ID,
  7356           DFHEIV99
  7357     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7358       ELSE
  7359         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7360           (NOTE-SUB > +10) OR
  7361           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7362         END-PERFORM
  7363         IF (NOTE-SUB < +11)
  7364           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7365              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7366                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7367           ELSE
  7368             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7369              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7370                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7371                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7372             ELSE
  7373               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7374                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7375                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7376                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7377               ELSE
  7378                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7379                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7380                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7381                                       CN-BILLING-START-LINE-NO
  7382                 ELSE
  7383                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7384                 END-IF
  7385               END-IF
  7386             END-IF
  7387           END-IF
  7388           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7389           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7390           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7391
  7392* EXEC CICS REWRITE
  7393*             DATASET    (WS-ERNOTE-FILE-ID)
  7394*             FROM       (CERTIFICATE-NOTE)
  7395*             RESP       (WS-RESPONSE)
  7396*          END-EXEC
  7397     MOVE LENGTH OF
  7398      CERTIFICATE-NOTE
  7399       TO DFHEIV11
  7400*    MOVE '&& L                  %  N#00006967' TO DFHEIV0
  7401     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7402     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7403     MOVE X'204E233030303036393637' TO DFHEIV0(25:11)
  7404     CALL 'kxdfhei1' USING DFHEIV0,
  7405           WS-ERNOTE-FILE-ID,
  7406           CERTIFICATE-NOTE,
  7407           DFHEIV11,
  7408           DFHEIV99
  7409     MOVE EIBRESP  TO WS-RESPONSE
  7410     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 130
* EL6317.cbl
  7411           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7412         END-IF
  7413       END-IF
  7414     ELSE
  7415        MOVE SPACES              TO CERTIFICATE-NOTE
  7416        MOVE 'CN'                TO CN-RECORD-ID
  7417        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7418                                     WS-ERNOTE-KEY
  7419        move '1'                 to cn-record-type
  7420                                    w-note-record-type
  7421        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7422                                    CN-BILLING-END-LINE-NO
  7423        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7424        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7425        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7426        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7427
  7428* EXEC CICS WRITE
  7429*          DATASET    (WS-ERNOTE-FILE-ID)
  7430*          FROM       (CERTIFICATE-NOTE)
  7431*          RIDFLD     (WS-ERNOTE-KEY)
  7432*          RESP       (WS-RESPONSE)
  7433*       END-EXEC
  7434     MOVE LENGTH OF
  7435      CERTIFICATE-NOTE
  7436       TO DFHEIV11
  7437*    MOVE '&$ L                  ''  N#00006988' TO DFHEIV0
  7438     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7439     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7440     MOVE X'204E233030303036393838' TO DFHEIV0(25:11)
  7441     CALL 'kxdfhei1' USING DFHEIV0,
  7442           WS-ERNOTE-FILE-ID,
  7443           CERTIFICATE-NOTE,
  7444           DFHEIV11,
  7445           WS-ERNOTE-KEY,
  7446           DFHEIV99,
  7447           DFHEIV99
  7448     MOVE EIBRESP  TO WS-RESPONSE
  7449     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7450
  7451        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7452     END-IF
  7453
  7454     .
  7455 0441-EXIT.
  7456     EXIT.
  7457
  7458
  7459 0442-SQUEEZE-IT-IN.
  7460
  7461     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7462        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7463           NOTE-SUB = +10
  7464           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7465           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7466             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7467             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7468             MOVE +9 TO NOTE-SUB
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 131
* EL6317.cbl
  7469           END-IF
  7470        END-PERFORM
  7471     ELSE
  7472        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7473           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7474             UNTIL NOTE-SUB = +1
  7475             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7476             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7477                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7478                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7479                MOVE +2          TO NOTE-SUB
  7480             END-IF
  7481           END-PERFORM
  7482        END-IF
  7483     END-IF
  7484
  7485     .
  7486 0442-EXIT.
  7487     EXIT.
  7488
  7489 0445-CERTIFICATE-UPDATE.
  7490    display 'billing note written, updating cert'
  7491     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7492     IF RESP-NORMAL
  7493        EVALUATE CM-NOTE-SW
  7494           WHEN '2'
  7495           WHEN '3'
  7496           WHEN '6'
  7497           WHEN '7'
  7498              SET NO-CERT-RW     TO TRUE
  7499           WHEN ' '
  7500              MOVE '2'           TO CM-NOTE-SW
  7501           WHEN '1'
  7502              MOVE '3'           TO CM-NOTE-SW
  7503           WHEN '4'
  7504              MOVE '6'           TO CM-NOTE-SW
  7505           WHEN '5'
  7506              MOVE '7'           TO CM-NOTE-SW
  7507        END-EVALUATE
  7508     END-IF
  7509     IF NOT NO-CERT-RW
  7510        PERFORM 1810-REWRITE-ELCERT
  7511                                 THRU 1810-EXIT
  7512     ELSE
  7513
  7514* EXEC CICS UNLOCK
  7515*          DATASET    (WS-ELCERT-FILE-ID)
  7516*       END-EXEC
  7517*    MOVE '&*                    #   #00007057' TO DFHEIV0
  7518     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7519     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7520     MOVE X'2020233030303037303537' TO DFHEIV0(25:11)
  7521     CALL 'kxdfhei1' USING DFHEIV0,
  7522           WS-ELCERT-FILE-ID,
  7523           DFHEIV99
  7524     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7525     END-IF
  7526
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 132
* EL6317.cbl
  7527     .
  7528 0445-EXIT.
  7529     EXIT.
  7530
  7531 0500-CREATE-TEMP-STORAGE.
  7532     display ' about to write pi ' program-interface-block
  7533
  7534* EXEC CICS WRITEQ TS
  7535*        QUEUE (QID)
  7536*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7537*        LENGTH(PI-COMM-LENGTH)
  7538*    END-EXEC
  7539*    MOVE '*"     L              ''   #00007068' TO DFHEIV0
  7540     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7541     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7542     MOVE X'2020233030303037303638' TO DFHEIV0(25:11)
  7543     CALL 'kxdfhei1' USING DFHEIV0,
  7544           QID,
  7545           PROGRAM-INTERFACE-BLOCK,
  7546           PI-COMM-LENGTH,
  7547           DFHEIV99,
  7548           DFHEIV99,
  7549           DFHEIV99
  7550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7551     display ' about to write map ' el631ji
  7552
  7553* EXEC CICS WRITEQ TS
  7554*        QUEUE (QID)
  7555*        FROM  (EL631JI)
  7556*        LENGTH(MAP-LENGTH)
  7557*    END-EXEC.
  7558*    MOVE '*"     L              ''   #00007074' TO DFHEIV0
  7559     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7560     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7561     MOVE X'2020233030303037303734' TO DFHEIV0(25:11)
  7562     CALL 'kxdfhei1' USING DFHEIV0,
  7563           QID,
  7564           EL631JI,
  7565           MAP-LENGTH,
  7566           DFHEIV99,
  7567           DFHEIV99,
  7568           DFHEIV99
  7569     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7570
  7571 0500-EXIT.
  7572      EXIT.
  7573 0600-RECOVER-TEMP-STORAGE.
  7574     display ' about to recover pi '
  7575
  7576* EXEC CICS READQ TS
  7577*        QUEUE (QID)
  7578*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7579*        LENGTH(PI-COMM-LENGTH)
  7580*    END-EXEC
  7581*    MOVE '*$I    L              ''   #00007083' TO DFHEIV0
  7582     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7583     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7584     MOVE X'2020233030303037303833' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 133
* EL6317.cbl
  7585     CALL 'kxdfhei1' USING DFHEIV0,
  7586           QID,
  7587           PROGRAM-INTERFACE-BLOCK,
  7588           PI-COMM-LENGTH,
  7589           DFHEIV99,
  7590           DFHEIV99,
  7591           DFHEIV99
  7592     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7593     display ' pi ' pi-program-work-area
  7594     display ' about to recover map '
  7595
  7596* EXEC CICS READQ TS
  7597*        QUEUE (QID)
  7598*        INTO  (EL631JI)
  7599*        LENGTH(MAP-LENGTH)
  7600*    END-EXEC
  7601*    MOVE '*$I    L              ''   #00007090' TO DFHEIV0
  7602     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7603     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7604     MOVE X'2020233030303037303930' TO DFHEIV0(25:11)
  7605     CALL 'kxdfhei1' USING DFHEIV0,
  7606           QID,
  7607           EL631JI,
  7608           MAP-LENGTH,
  7609           DFHEIV99,
  7610           DFHEIV99,
  7611           DFHEIV99
  7612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7613     display ' map ' el631ji
  7614     PERFORM 0800-DELETE-TS THRU 0800-EXIT.
  7615     MOVE AL-UANON            TO SIGREQA
  7616     MOVE AL-UANON            TO LTRIDA
  7617     IF WS-SET-CODES-MDT = 'Y'
  7618        move +1                  to s2
  7619        perform varying s1 from +1 by +5 until s1 > +60
  7620           MOVE WS-PASSED-REASON-CODES (s1:4)
  7621                                 TO reacd-in (s2)
  7622           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7623               MOVE AL-SANON     TO REACDA (S2)
  7624               MOVE +4           TO REACDL (S2)
  7625           END-IF
  7626           add +1                to s2
  7627        end-perform
  7628        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7629     END-IF
  7630
  7631     IF ENCCODEI > SPACES
  7632         MOVE AL-UANON       TO ENCCODEA
  7633     END-IF
  7634
  7635     IF CRTNT1I > SPACES
  7636         MOVE AL-UANON       TO CRTNT1A
  7637     END-IF
  7638
  7639     IF CRTNT2I > SPACES
  7640         MOVE AL-UANON       TO CRTNT2A
  7641     END-IF
  7642
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 134
* EL6317.cbl
  7643     IF BILNT1I > SPACES
  7644         MOVE AL-UANON       TO BILNT1A
  7645     END-IF
  7646     .
  7647 0600-EXIT.
  7648      EXIT.
  7649 0800-DELETE-TS.
  7650
  7651* EXEC CICS DELETEQ TS
  7652*        QUEUE(QID)
  7653*    END-EXEC
  7654*    MOVE '*&                    #   #00007132' TO DFHEIV0
  7655     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  7656     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7657     MOVE X'2020233030303037313332' TO DFHEIV0(25:11)
  7658     CALL 'kxdfhei1' USING DFHEIV0,
  7659           QID,
  7660           DFHEIV99
  7661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7662     .
  7663 0800-EXIT.
  7664      EXIT.
  7665 1000-BUILD-ERARCH.
  7666     display ' made it to 1000 '
  7667     MOVE SPACES                 TO W-CNTL-KEY
  7668     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID
  7669     MOVE '1'                    TO W-CNTL-RECORD-TYPE
  7670     MOVE ZEROS                  TO W-CNTL-SEQ-NO
  7671
  7672* EXEC CICS READ
  7673*         DATASET    (WS-ELCNTL-FILE-ID)
  7674*         SET        (ADDRESS OF CONTROL-FILE)
  7675*         RIDFLD     (W-CNTL-KEY)
  7676*         UPDATE
  7677*         RESP       (WS-RESPONSE)
  7678*    END-EXEC
  7679*    MOVE '&"S        EU         (  N#00007144' TO DFHEIV0
  7680     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7681     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7682     MOVE X'204E233030303037313434' TO DFHEIV0(25:11)
  7683     CALL 'kxdfhei1' USING DFHEIV0,
  7684           WS-ELCNTL-FILE-ID,
  7685           DFHEIV20,
  7686           DFHEIV99,
  7687           W-CNTL-KEY,
  7688           DFHEIV99,
  7689           DFHEIV99,
  7690           DFHEIV99
  7691     SET ADDRESS OF CONTROL-FILE TO
  7692         DFHEIV20
  7693     MOVE EIBRESP  TO WS-RESPONSE
  7694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7695     IF RESP-NORMAL
  7696        display ' good read elcntl '
  7697        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7698           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7699        END-IF
  7700        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 135
* EL6317.cbl
  7701        MOVE CF-CREDIT-LAST-ARCH-NUM
  7702                                 TO W-ARCH-NUMBER
  7703
  7704* EXEC CICS REWRITE
  7705*          FROM      (CONTROL-FILE)
  7706*          DATASET   (WS-ELCNTL-FILE-ID)
  7707*       END-EXEC
  7708     MOVE LENGTH OF
  7709      CONTROL-FILE
  7710       TO DFHEIV11
  7711*    MOVE '&& L                  %   #00007159' TO DFHEIV0
  7712     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7713     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7714     MOVE X'2020233030303037313539' TO DFHEIV0(25:11)
  7715     CALL 'kxdfhei1' USING DFHEIV0,
  7716           WS-ELCNTL-FILE-ID,
  7717           CONTROL-FILE,
  7718           DFHEIV11,
  7719           DFHEIV99
  7720     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7721     END-IF
  7722
  7723* EXEC CICS GETMAIN
  7724*       SET      (ADDRESS OF LETTER-ARCHIVE)
  7725*       LENGTH   (W-ARCH-LENGTH)
  7726*    END-EXEC
  7727*    MOVE '," L                  $   #00007164' TO DFHEIV0
  7728     MOVE X'2C22204C2020202020202020' TO DFHEIV0(1:12)
  7729     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7730     MOVE X'2020233030303037313634' TO DFHEIV0(25:11)
  7731     CALL 'kxdfhei1' USING DFHEIV0,
  7732           DFHEIV20,
  7733           W-ARCH-LENGTH,
  7734           DFHEIV99
  7735     SET ADDRESS OF LETTER-ARCHIVE TO
  7736         DFHEIV20
  7737     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7738     MOVE 'LA'                   TO LETTER-ARCHIVE
  7739     MOVE W-ARCH-NUMBER          TO LA-ARCHIVE-NO
  7740                                    LA-ARCHIVE-NO-A2
  7741                                    LA-ARCHIVE-NO-A3
  7742                                    LA-ARCHIVE-NO-A4
  7743                                    LA-ARCHIVE-NO-A5
  7744                                    LA-ARCHIVE-NO-A6
  7745     MOVE PI-COMPANY-CD          TO LA-COMPANY-CD
  7746                                    LA-COMPANY-CD-A2
  7747                                    LA-COMPANY-CD-A3
  7748                                    LA-COMPANY-CD-A4
  7749                                    LA-COMPANY-CD-A5
  7750                                    LA-COMPANY-CD-A6
  7751     MOVE PB-CARRIER             TO LA-CARRIER-A2
  7752                                    LA-CARRIER-A3
  7753                                    LA-CARRIER-A4
  7754                                    LA-CARRIER-A5
  7755     MOVE Pb-cert-eff-dt         TO LA-EFFECT-DATE-A2
  7756     MOVE PB-GROUPING            TO LA-GROUPING-A2
  7757                                    LA-GROUPING-A3
  7758                                    LA-GROUPING-A4
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 136
* EL6317.cbl
  7759                                    LA-GROUPING-A5
  7760     MOVE PB-ACCOUNT             TO LA-ACCOUNT-A2
  7761                                    LA-ACCOUNT-A3
  7762                                    LA-ACCOUNT-A4
  7763                                    LA-ACCOUNT-A5
  7764     MOVE PB-STATE               TO LA-STATE-A2
  7765                                    LA-STATE-A3
  7766                                    LA-STATE-A4
  7767                                    LA-STATE-A5
  7768     MOVE PB-CERT-PRIME          TO LA-CERT-PRIME-A2
  7769     MOVE PB-CERT-SFX            TO LA-CERT-SUFFIX-A2
  7770     MOVE PB-ENTRY-BATCH         TO LA-ENTRY-A6
  7771     MOVE PI-PROCESSOR-ID        TO LA-PROCESSOR-CD
  7772     MOVE LOW-VALUES             TO LA-LAST-RESENT-PRINT-DATE
  7773                                    LA-INITIAL-PRINT-DATE
  7774                                    LA-SENT-DATE
  7775                                    LA-REPLY-DATE
  7776                                    LA-RESEND-DATE
  7777                                    LA-FOLLOW-UP-DATE
  7778     MOVE 'A'                    TO LA-STATUS
  7779     MOVE W-NUMBER-OF-COPIES     TO LA-NO-OF-COPIES
  7780     MOVE W-AUTO-CLOSE-IND       TO LA-FINAL-ACT-IND
  7781     MOVE LTRIDI                 TO LA-FORM-A3
  7782     MOVE '4'                    TO LA-DATA-SOURCE
  7783     MOVE WS-CURRENT-BIN-DT      TO LA-CREATION-DATE
  7784     MOVE ZEROS                  TO LA-NUMBER-LABEL-LINES
  7785                                    LA-NO-OF-TEXT-RECORDS
  7786
  7787* EXEC CICS WRITE
  7788*         DATASET   ('ERARCH')
  7789*         FROM      (LETTER-ARCHIVE)
  7790*         RIDFLD    (LA-CONTROL-PRIMARY)
  7791*         RESP      (WS-RESPONSE)
  7792*    END-EXEC
  7793     MOVE LENGTH OF
  7794      LETTER-ARCHIVE
  7795       TO DFHEIV11
  7796     MOVE 'ERARCH' TO DFHEIV1
  7797*    MOVE '&$ L                  ''  N#00007216' TO DFHEIV0
  7798     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7799     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7800     MOVE X'204E233030303037323136' TO DFHEIV0(25:11)
  7801     CALL 'kxdfhei1' USING DFHEIV0,
  7802           DFHEIV1,
  7803           LETTER-ARCHIVE,
  7804           DFHEIV11,
  7805           LA-CONTROL-PRIMARY,
  7806           DFHEIV99,
  7807           DFHEIV99
  7808     MOVE EIBRESP  TO WS-RESPONSE
  7809     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7810     IF RESP-NORMAL
  7811        display ' good write erarch '
  7812        MOVE ER-0280             TO EMI-ERROR
  7813        MOVE -1                  TO SIGREQL
  7814        PERFORM 9900-ERROR-FORMAT
  7815                                 THRU 9900-EXIT
  7816        MOVE W-ARCH-NUMBER       TO W-ARCH-SUPPRESS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 137
* EL6317.cbl
  7817        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  7818     ELSE
  7819        MOVE ER-7345             TO EMI-ERROR
  7820        MOVE -1                  TO SIGREQL
  7821        PERFORM 9900-ERROR-FORMAT
  7822                                 THRU 9900-EXIT
  7823     END-IF
  7824     .
  7825 1000-EXIT.
  7826     EXIT.
  7827 1100-CALL-NS-BUS-LOGIC.
  7828     DISPLAY ' MADE IT TO 1100 '
  7829     MOVE SPACES                 TO BL-INPUT
  7830     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  7831     IF PI-RETURN-TO-PROGRAM = 'EL1273'
  7832       OR 'EL6314'
  7833         MOVE '2'                TO BL-DATA-SRCE
  7834         MOVE SPACES             TO BL-BATCH-NO
  7835         MOVE ZEROS              TO BL-BATCH-SEQ
  7836     ELSE
  7837         MOVE '4'                TO BL-DATA-SRCE
  7838         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  7839         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  7840     END-IF
  7841     MOVE PI-CARRIER             TO BL-CARRIER
  7842     MOVE PI-GROUPING            TO BL-GROUP
  7843     MOVE PI-STATE               TO BL-STATE
  7844     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  7845     IF PI-CERT-EFF-DT NOT = LOW-VALUES
  7846        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  7847        MOVE ' '                 TO DC-OPTION-CODE
  7848        PERFORM 9700-date-link
  7849        IF NO-CONVERSION-ERROR
  7850           MOVE DC-GREG-DATE-1-EDIT
  7851                                 TO BL-EFF-DT
  7852        END-IF
  7853     END-IF
  7854     MOVE PI-CERT-NO             TO BL-CERT-NO
  7855     MOVE SPACES                 TO BL-RESP-NO
  7856     MOVE LTRIDI                 TO BL-LETTER-ID
  7857     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  7858     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  7859     MOVE 'CrtVerif'               TO BL-FUNC
  7860*    MOVE 'ALWA'                 TO BL-PROC-ID
  7861     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  7862*    MOVE IFF-PRINT-NOW-SW       TO BL-PRINT-NOW-SW
  7863*    MOVE IFF-ENC-CD             TO BL-ENC-CD
  7864     MOVE PI-ENCCODE             TO BL-ENC-CD
  7865     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  7866     MOVE 'VERIFY  '             TO BL-SOURCE-SCREEN
  7867     IF EIBAID = DFHPF4
  7868        MOVE 'B'                 TO BL-WRITE-ERARCH
  7869     ELSE
  7870        MOVE 'T'                 TO BL-WRITE-ERARCH
  7871     END-IF
  7872     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  7873        MOVE REACD-IN (S1)       TO BL-REASON-CODE (S1)
  7874     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 138
* EL6317.cbl
  7875    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  7876*****************************************
  7877* Invoke the LETTER business logic
  7878*****************************************
  7879
  7880* exec cics link
  7881*       program('NSRASBL')
  7882*       commarea(srch-commarea)
  7883*    end-exec.
  7884     MOVE LENGTH OF
  7885      srch-commarea
  7886       TO DFHEIV11
  7887     MOVE 'NSRASBL' TO DFHEIV1
  7888*    MOVE '."C                   (   #00007291' TO DFHEIV0
  7889     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  7890     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7891     MOVE X'2020233030303037323931' TO DFHEIV0(25:11)
  7892     CALL 'kxdfhei1' USING DFHEIV0,
  7893           DFHEIV1,
  7894           srch-commarea,
  7895           DFHEIV11,
  7896           DFHEIV99,
  7897           DFHEIV99,
  7898           DFHEIV99,
  7899           DFHEIV99
  7900     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7901
  7902     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  7903        BL-MESSAGE
  7904     .
  7905 1100-EXIT.
  7906     EXIT.
  7907 1500-GET-ARCH-NO.
  7908     display ' made it to 1500 '
  7909     MOVE SPACES                 TO ELCNTL-KEY
  7910     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  7911     MOVE '1'                    TO CNTL-REC-TYPE
  7912     MOVE ZEROS                  TO CNTL-SEQ
  7913
  7914* EXEC CICS READ
  7915*         DATASET    (WS-ELCNTL-FILE-ID)
  7916*         SET        (ADDRESS OF CONTROL-FILE)
  7917*         RIDFLD     (ELCNTL-KEY)
  7918*         UPDATE
  7919*         RESP       (WS-RESPONSE)
  7920*    END-EXEC
  7921*    MOVE '&"S        EU         (  N#00007306' TO DFHEIV0
  7922     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  7923     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7924     MOVE X'204E233030303037333036' TO DFHEIV0(25:11)
  7925     CALL 'kxdfhei1' USING DFHEIV0,
  7926           WS-ELCNTL-FILE-ID,
  7927           DFHEIV20,
  7928           DFHEIV99,
  7929           ELCNTL-KEY,
  7930           DFHEIV99,
  7931           DFHEIV99,
  7932           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 139
* EL6317.cbl
  7933     SET ADDRESS OF CONTROL-FILE TO
  7934         DFHEIV20
  7935     MOVE EIBRESP  TO WS-RESPONSE
  7936     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7937     IF RESP-NORMAL
  7938        display ' good read elcntl '
  7939        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
  7940           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  7941        END-IF
  7942        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  7943        MOVE CF-CREDIT-LAST-ARCH-NUM
  7944                                 TO W-ARCH-NUMBER
  7945        display ' new arch number ' w-arch-number
  7946
  7947* EXEC CICS REWRITE
  7948*          FROM      (CONTROL-FILE)
  7949*          DATASET   (WS-ELCNTL-FILE-ID)
  7950*       END-EXEC
  7951     MOVE LENGTH OF
  7952      CONTROL-FILE
  7953       TO DFHEIV11
  7954*    MOVE '&& L                  %   #00007322' TO DFHEIV0
  7955     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7956     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7957     MOVE X'2020233030303037333232' TO DFHEIV0(25:11)
  7958     CALL 'kxdfhei1' USING DFHEIV0,
  7959           WS-ELCNTL-FILE-ID,
  7960           CONTROL-FILE,
  7961           DFHEIV11,
  7962           DFHEIV99
  7963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7964     END-IF
  7965     .
  7966 1500-EXIT.
  7967     EXIT.
  7968
  7969
  7970 1700-WRITE-CERT-NOTE      SECTION.
  7971
  7972
  7973     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  7974     MOVE ZERO           TO ERCNOT-SEQ.
  7975     SET TB-INDX         DOWN BY 1.
  7976     SET TB-INDX1        TO TB-INDX.
  7977
  7978****DELETE CURRENT CERT NOTES
  7979 1700-LOOP.
  7980
  7981* EXEC CICS READ
  7982*        DATASET (WS-ERCNOT-FILE-ID)
  7983*        RIDFLD  (ERCNOT-KEY)
  7984*        SET     (ADDRESS OF CERT-NOTE-FILE)
  7985*        RESP    (WS-RESPONSE)
  7986*        GTEQ
  7987*    END-EXEC.
  7988*    MOVE '&"S        G          (  N#00007342' TO DFHEIV0
  7989     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7990     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 140
* EL6317.cbl
  7991     MOVE X'204E233030303037333432' TO DFHEIV0(25:11)
  7992     CALL 'kxdfhei1' USING DFHEIV0,
  7993           WS-ERCNOT-FILE-ID,
  7994           DFHEIV20,
  7995           DFHEIV99,
  7996           ERCNOT-KEY,
  7997           DFHEIV99,
  7998           DFHEIV99,
  7999           DFHEIV99
  8000     SET ADDRESS OF CERT-NOTE-FILE TO
  8001         DFHEIV20
  8002     MOVE EIBRESP  TO WS-RESPONSE
  8003     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8004
  8005
  8006     IF NOT RESP-NORMAL
  8007        GO TO 1700-ENDDEL
  8008     END-IF
  8009
  8010     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  8011
  8012     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  8013         GO TO 1700-ENDDEL
  8014     END-IF.
  8015
  8016
  8017* EXEC CICS DELETE
  8018*        DATASET (WS-ERCNOT-FILE-ID)
  8019*        RIDFLD  (ERCNOT-KEY)
  8020*    END-EXEC.
  8021*    MOVE '&(  R                 &   #00007360' TO DFHEIV0
  8022     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8023     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8024     MOVE X'2020233030303037333630' TO DFHEIV0(25:11)
  8025     CALL 'kxdfhei1' USING DFHEIV0,
  8026           WS-ERCNOT-FILE-ID,
  8027           ERCNOT-KEY,
  8028           DFHEIV99,
  8029           DFHEIV99,
  8030           DFHEIV99
  8031     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8032
  8033
  8034     GO TO 1700-LOOP.
  8035
  8036 1700-ENDDEL.
  8037
  8038
  8039* EXEC CICS GETMAIN
  8040*         LENGTH(ERCNOT-LENGTH)
  8041*         SET(ADDRESS OF CERT-NOTE-FILE)
  8042*         INITIMG(GETMAIN-SPACE)
  8043*    END-EXEC.
  8044*    MOVE ',"IL                  $   #00007369' TO DFHEIV0
  8045     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8046     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8047     MOVE X'2020233030303037333639' TO DFHEIV0(25:11)
  8048     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 141
* EL6317.cbl
  8049           DFHEIV20,
  8050           ERCNOT-LENGTH,
  8051           GETMAIN-SPACE
  8052     SET ADDRESS OF CERT-NOTE-FILE TO
  8053         DFHEIV20
  8054     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8055
  8056
  8057     SET TB-INDX TO 1.
  8058     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  8059     MOVE +0             TO ERCNOT-SEQ
  8060
  8061     PERFORM VARYING TB-INDX FROM 1 BY 1
  8062             UNTIL TB-INDX > TB-INDX1
  8063        MOVE SPACES                 TO  CERT-NOTE-FILE
  8064        ADD 1                       TO  ERCNOT-SEQ
  8065        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  8066        MOVE  'CZ'                  TO  CZ-RECORD-ID
  8067        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  8068        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  8069                                    TO  CZ-LAST-MAINT-USER
  8070        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  8071                                    TO  CZ-LAST-MAINT-HHMMSS
  8072        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  8073                                    TO  CZ-LAST-MAINT-DT
  8074
  8075
  8076* EXEC CICS WRITE
  8077*            DATASET(WS-ERCNOT-FILE-ID)
  8078*            FROM(CERT-NOTE-FILE)
  8079*            RIDFLD(ERCNOT-KEY)
  8080*       END-EXEC
  8081     MOVE LENGTH OF
  8082      CERT-NOTE-FILE
  8083       TO DFHEIV11
  8084*    MOVE '&$ L                  ''   #00007393' TO DFHEIV0
  8085     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8086     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8087     MOVE X'2020233030303037333933' TO DFHEIV0(25:11)
  8088     CALL 'kxdfhei1' USING DFHEIV0,
  8089           WS-ERCNOT-FILE-ID,
  8090           CERT-NOTE-FILE,
  8091           DFHEIV11,
  8092           ERCNOT-KEY,
  8093           DFHEIV99,
  8094           DFHEIV99
  8095     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8096     END-PERFORM
  8097
  8098     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8099     IF RESP-NORMAL
  8100        EVALUATE CM-NOTE-SW
  8101           WHEN '1'
  8102           WHEN '3'
  8103           WHEN '5'
  8104           WHEN '7'
  8105              SET NO-CERT-RW     TO TRUE
  8106           WHEN ' '
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 142
* EL6317.cbl
  8107              MOVE '1'           TO CM-NOTE-SW
  8108           WHEN '2'
  8109              MOVE '3'           TO CM-NOTE-SW
  8110           WHEN '4'
  8111              MOVE '5'           TO CM-NOTE-SW
  8112           WHEN '6'
  8113              MOVE '7'           TO CM-NOTE-SW
  8114        END-EVALUATE
  8115     END-IF
  8116     IF NOT NO-CERT-RW
  8117        PERFORM 1810-REWRITE-ELCERT
  8118                                 THRU 1810-EXIT
  8119     ELSE
  8120
  8121* EXEC CICS UNLOCK
  8122*          DATASET    (WS-ELCERT-FILE-ID)
  8123*       END-EXEC
  8124*    MOVE '&*                    #   #00007422' TO DFHEIV0
  8125     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8126     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8127     MOVE X'2020233030303037343232' TO DFHEIV0(25:11)
  8128     CALL 'kxdfhei1' USING DFHEIV0,
  8129           WS-ELCERT-FILE-ID,
  8130           DFHEIV99
  8131     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8132     END-IF
  8133
  8134     .
  8135 1799-EXIT.
  8136     EXIT.
  8137
  8138 1800-READ-ELCERT-UPDATE.
  8139
  8140     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  8141     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  8142     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  8143     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  8144     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  8145     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  8146     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  8147     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  8148
  8149
  8150* EXEC CICS READ
  8151*        UPDATE
  8152*        DATASET  (WS-ELCERT-FILE-ID)
  8153*        RIDFLD   (WS-ELCERT-KEY)
  8154*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8155*        RESP     (WS-RESPONSE)
  8156*    END-EXEC
  8157*    MOVE '&"S        EU         (  N#00007442' TO DFHEIV0
  8158     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8159     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8160     MOVE X'204E233030303037343432' TO DFHEIV0(25:11)
  8161     CALL 'kxdfhei1' USING DFHEIV0,
  8162           WS-ELCERT-FILE-ID,
  8163           DFHEIV20,
  8164           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 143
* EL6317.cbl
  8165           WS-ELCERT-KEY,
  8166           DFHEIV99,
  8167           DFHEIV99,
  8168           DFHEIV99
  8169     SET ADDRESS OF CERTIFICATE-MASTER TO
  8170         DFHEIV20
  8171     MOVE EIBRESP  TO WS-RESPONSE
  8172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8173
  8174     .
  8175 1800-EXIT.
  8176     EXIT.
  8177
  8178 1810-REWRITE-ELCERT.
  8179
  8180
  8181* EXEC CICS REWRITE
  8182*        FROM     (CERTIFICATE-MASTER)
  8183*        DATASET  (WS-ELCERT-FILE-ID)
  8184*        RESP     (WS-RESPONSE)
  8185*    END-EXEC.
  8186     MOVE LENGTH OF
  8187      CERTIFICATE-MASTER
  8188       TO DFHEIV11
  8189*    MOVE '&& L                  %  N#00007456' TO DFHEIV0
  8190     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8191     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8192     MOVE X'204E233030303037343536' TO DFHEIV0(25:11)
  8193     CALL 'kxdfhei1' USING DFHEIV0,
  8194           WS-ELCERT-FILE-ID,
  8195           CERTIFICATE-MASTER,
  8196           DFHEIV11,
  8197           DFHEIV99
  8198     MOVE EIBRESP  TO WS-RESPONSE
  8199     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8200
  8201
  8202     .
  8203 1810-EXIT.
  8204     EXIT.
  8205
  8206 8100-SEND-INITIAL-MAP.
  8207     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8208     MOVE '5'                    TO DC-OPTION-CODE.
  8209     PERFORM 9700-DATE-LINK.
  8210     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8211     MOVE EIBTIME                TO TIME-IN.
  8212     MOVE TIME-OUT               TO TIMEO.
  8213     MOVE -1                     TO SIGREQL.
  8214     IF PI-PROCESSOR-IS-CSR-SUPER
  8215        perform varying s1 from +1 by +1 until
  8216           s1 > +12
  8217           MOVE AL-UANON            TO reacda (s1)
  8218        end-perform
  8219     END-IF
  8220     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8221     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O.
  8222
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 144
* EL6317.cbl
  8223* EXEC CICS SEND
  8224*        MAP      (MAP-NAME)
  8225*        MAPSET   (MAPSET-NAME)
  8226*        FROM     (EL631JO)
  8227*        ERASE
  8228*        CURSOR
  8229*    END-EXEC.
  8230     MOVE LENGTH OF
  8231      EL631JO
  8232       TO DFHEIV12
  8233     MOVE -1
  8234       TO DFHEIV11
  8235*    MOVE '8$     CT  E    H L F ,   #00007482' TO DFHEIV0
  8236     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  8237     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  8238     MOVE X'2020233030303037343832' TO DFHEIV0(25:11)
  8239     CALL 'kxdfhei1' USING DFHEIV0,
  8240           MAP-NAME,
  8241           EL631JO,
  8242           DFHEIV12,
  8243           MAPSET-NAME,
  8244           DFHEIV99,
  8245           DFHEIV99,
  8246           DFHEIV99,
  8247           DFHEIV11,
  8248           DFHEIV99,
  8249           DFHEIV99,
  8250           DFHEIV99
  8251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8252
  8253     GO TO 9100-RETURN-TRAN.
  8254 8200-SEND-DATAONLY.
  8255     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8256     MOVE '5'                    TO DC-OPTION-CODE.
  8257     PERFORM 9700-DATE-LINK.
  8258     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8259     MOVE EIBTIME                TO TIME-IN.
  8260     MOVE TIME-OUT               TO TIMEO.
  8261     MOVE -1                     TO PFENTRL
  8262     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O
  8263     MOVE EMI-MESSAGE-AREA (2)   TO ERRMSG2O
  8264
  8265* EXEC CICS SEND
  8266*        MAP      (MAP-NAME)
  8267*        MAPSET   (MAPSET-NAME)
  8268*        FROM     (EL631JO)
  8269*        DATAONLY
  8270*        ERASEAUP
  8271*        CURSOR
  8272*    END-EXEC.
  8273     MOVE LENGTH OF
  8274      EL631JO
  8275       TO DFHEIV12
  8276     MOVE -1
  8277       TO DFHEIV11
  8278*    MOVE '8$D    CT  A    H L F ,   #00007500' TO DFHEIV0
  8279     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  8280     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 145
* EL6317.cbl
  8281     MOVE X'2020233030303037353030' TO DFHEIV0(25:11)
  8282     CALL 'kxdfhei1' USING DFHEIV0,
  8283           MAP-NAME,
  8284           EL631JO,
  8285           DFHEIV12,
  8286           MAPSET-NAME,
  8287           DFHEIV99,
  8288           DFHEIV99,
  8289           DFHEIV99,
  8290           DFHEIV11,
  8291           DFHEIV99,
  8292           DFHEIV99,
  8293           DFHEIV99
  8294     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8295
  8296     GO TO 9100-RETURN-TRAN.
  8297 8300-SEND-TEXT.
  8298
  8299* EXEC CICS SEND TEXT
  8300*        FROM     (LOGOFF-TEXT)
  8301*        LENGTH   (LOGOFF-LENGTH)
  8302*        ERASE
  8303*        FREEKB
  8304*    END-EXEC.
  8305*    MOVE '8&      T  E F  H   F -   #00007510' TO DFHEIV0
  8306     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  8307     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  8308     MOVE X'2020233030303037353130' TO DFHEIV0(25:11)
  8309     CALL 'kxdfhei1' USING DFHEIV0,
  8310           LOGOFF-TEXT,
  8311           LOGOFF-LENGTH,
  8312           DFHEIV99,
  8313           DFHEIV99,
  8314           DFHEIV99,
  8315           DFHEIV99,
  8316           DFHEIV99,
  8317           DFHEIV99,
  8318           DFHEIV99,
  8319           DFHEIV99,
  8320           DFHEIV99,
  8321           DFHEIV99
  8322     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8323
  8324
  8325* EXEC CICS RETURN
  8326*    END-EXEC.
  8327*    MOVE '.(                    ''   #00007516' TO DFHEIV0
  8328     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8329     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8330     MOVE X'2020233030303037353136' TO DFHEIV0(25:11)
  8331     CALL 'kxdfhei1' USING DFHEIV0,
  8332           DFHEIV99,
  8333           DFHEIV99,
  8334           DFHEIV99,
  8335           DFHEIV99,
  8336           DFHEIV99,
  8337           DFHEIV99
  8338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 146
* EL6317.cbl
  8339
  8340 8800-UNAUTHORIZED-ACCESS.
  8341     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8342     GO TO 8300-SEND-TEXT.
  8343 8810-PF23.
  8344     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  8345     MOVE XCTL-005               TO PGM-NAME.
  8346     GO TO 9300-XCTL.
  8347 9000-RETURN-CICS.
  8348
  8349* EXEC CICS RETURN
  8350*    END-EXEC.
  8351*    MOVE '.(                    ''   #00007526' TO DFHEIV0
  8352     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  8353     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8354     MOVE X'2020233030303037353236' TO DFHEIV0(25:11)
  8355     CALL 'kxdfhei1' USING DFHEIV0,
  8356           DFHEIV99,
  8357           DFHEIV99,
  8358           DFHEIV99,
  8359           DFHEIV99,
  8360           DFHEIV99,
  8361           DFHEIV99
  8362     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8363
  8364 9100-RETURN-TRAN.
  8365     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  8366     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  8367
  8368* EXEC CICS RETURN
  8369*        TRANSID    (TRANS-ID)
  8370*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8371*        LENGTH     (PI-COMM-LENGTH)
  8372*    END-EXEC.
  8373*    MOVE '.(CT                  ''   #00007531' TO DFHEIV0
  8374     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  8375     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8376     MOVE X'2020233030303037353331' TO DFHEIV0(25:11)
  8377     CALL 'kxdfhei1' USING DFHEIV0,
  8378           TRANS-ID,
  8379           PROGRAM-INTERFACE-BLOCK,
  8380           PI-COMM-LENGTH,
  8381           DFHEIV99,
  8382           DFHEIV99,
  8383           DFHEIV99
  8384     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8385
  8386 9200-RETURN-MAIN-MENU.
  8387     MOVE XCTL-626               TO PGM-NAME.
  8388     GO TO 9300-XCTL.
  8389 9300-XCTL.
  8390
  8391* EXEC CICS XCTL
  8392*        PROGRAM    (PGM-NAME)
  8393*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8394*        LENGTH     (PI-COMM-LENGTH)
  8395*    END-EXEC.
  8396*    MOVE '.$C                   %   #00007540' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 147
* EL6317.cbl
  8397     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8398     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8399     MOVE X'2020233030303037353430' TO DFHEIV0(25:11)
  8400     CALL 'kxdfhei1' USING DFHEIV0,
  8401           PGM-NAME,
  8402           PROGRAM-INTERFACE-BLOCK,
  8403           PI-COMM-LENGTH,
  8404           DFHEIV99
  8405     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8406
  8407 9400-CLEAR.
  8408     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  8409
  8410* EXEC CICS XCTL
  8411*        PROGRAM    (PGM-NAME)
  8412*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  8413*        LENGTH     (PI-COMM-LENGTH)
  8414*    END-EXEC.
  8415*    MOVE '.$C                   %   #00007547' TO DFHEIV0
  8416     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  8417     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8418     MOVE X'2020233030303037353437' TO DFHEIV0(25:11)
  8419     CALL 'kxdfhei1' USING DFHEIV0,
  8420           PGM-NAME,
  8421           PROGRAM-INTERFACE-BLOCK,
  8422           PI-COMM-LENGTH,
  8423           DFHEIV99
  8424     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8425
  8426 9500-PF12.
  8427     MOVE XCTL-010               TO PGM-NAME.
  8428     GO TO 9300-XCTL.
  8429 9600-PGMID-ERROR.
  8430
  8431* EXEC CICS HANDLE CONDITION
  8432*        PGMIDERR    (8300-SEND-TEXT)
  8433*    END-EXEC.
  8434*    MOVE '"$L                   ! " #00007556' TO DFHEIV0
  8435     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  8436     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8437     MOVE X'2220233030303037353536' TO DFHEIV0(25:11)
  8438     CALL 'kxdfhei1' USING DFHEIV0
  8439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8440
  8441     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  8442     MOVE ' '                    TO PI-ENTRY-CD-1.
  8443     MOVE XCTL-005               TO PGM-NAME.
  8444     MOVE PGM-NAME               TO LOGOFF-PGM.
  8445     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  8446     GO TO 9300-XCTL.
  8447 9700-DATE-LINK.
  8448     MOVE LINK-ELDATCV           TO PGM-NAME.
  8449
  8450* EXEC CICS LINK
  8451*        PROGRAM    (PGM-NAME)
  8452*        COMMAREA   (DATE-CONVERSION-DATA)
  8453*        LENGTH     (DC-COMM-LENGTH)
  8454*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 148
* EL6317.cbl
  8455*    MOVE '."C                   (   #00007567' TO DFHEIV0
  8456     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8457     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8458     MOVE X'2020233030303037353637' TO DFHEIV0(25:11)
  8459     CALL 'kxdfhei1' USING DFHEIV0,
  8460           PGM-NAME,
  8461           DATE-CONVERSION-DATA,
  8462           DC-COMM-LENGTH,
  8463           DFHEIV99,
  8464           DFHEIV99,
  8465           DFHEIV99,
  8466           DFHEIV99
  8467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8468
  8469 9900-ERROR-FORMAT.
  8470     IF NOT EMI-ERRORS-COMPLETE
  8471        MOVE LINK-001            TO PGM-NAME
  8472
  8473* EXEC CICS LINK
  8474*           PROGRAM    (PGM-NAME)
  8475*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  8476*           LENGTH     (EMI-COMM-LENGTH)
  8477*       END-EXEC
  8478*    MOVE '."C                   (   #00007575' TO DFHEIV0
  8479     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8480     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8481     MOVE X'2020233030303037353735' TO DFHEIV0(25:11)
  8482     CALL 'kxdfhei1' USING DFHEIV0,
  8483           PGM-NAME,
  8484           ERROR-MESSAGE-INTERFACE-BLOCK,
  8485           EMI-COMM-LENGTH,
  8486           DFHEIV99,
  8487           DFHEIV99,
  8488           DFHEIV99,
  8489           DFHEIV99
  8490     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8491     END-IF
  8492     .
  8493 9900-EXIT.
  8494     EXIT.
  8495 9990-ABEND.
  8496     MOVE LINK-004               TO PGM-NAME.
  8497     MOVE DFHEIBLK               TO EMI-LINE1.
  8498
  8499* EXEC CICS LINK
  8500*        PROGRAM   (PGM-NAME)
  8501*        COMMAREA  (EMI-LINE1)
  8502*        LENGTH    (72)
  8503*    END-EXEC.
  8504     MOVE 72
  8505       TO DFHEIV11
  8506*    MOVE '."C                   (   #00007587' TO DFHEIV0
  8507     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8508     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8509     MOVE X'2020233030303037353837' TO DFHEIV0(25:11)
  8510     CALL 'kxdfhei1' USING DFHEIV0,
  8511           PGM-NAME,
  8512           EMI-LINE1,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 149
* EL6317.cbl
  8513           DFHEIV11,
  8514           DFHEIV99,
  8515           DFHEIV99,
  8516           DFHEIV99,
  8517           DFHEIV99
  8518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8519
  8520     GO TO 8200-SEND-DATAONLY.
  8521
  8522* GOBACK.
  8523     MOVE '9%                    "   ' TO DFHEIV0
  8524     MOVE 'EL6317' TO DFHEIV1
  8525     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8526     GOBACK.
  8527 9995-SECURITY-VIOLATION.
  8528*                            COPY ELCSCTP.
  8529******************************************************************
  8530*                                                                *
  8531*                            ELCSCTP                             *
  8532*                            VMOD=2.001                          *
  8533*                                                                *
  8534*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  8535******************************************************************
  8536
  8537
  8538     MOVE EIBDATE          TO SM-JUL-DATE.
  8539     MOVE EIBTRMID         TO SM-TERMID.
  8540     MOVE THIS-PGM         TO SM-PGM.
  8541     MOVE EIBTIME          TO TIME-IN.
  8542     MOVE TIME-OUT         TO SM-TIME.
  8543     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  8544
  8545
  8546* EXEC CICS LINK
  8547*         PROGRAM  ('EL003')
  8548*         COMMAREA (SECURITY-MESSAGE)
  8549*         LENGTH   (80)
  8550*    END-EXEC.
  8551     MOVE 'EL003' TO DFHEIV1
  8552     MOVE 80
  8553       TO DFHEIV11
  8554*    MOVE '."C                   (   #00007612' TO DFHEIV0
  8555     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8556     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8557     MOVE X'2020233030303037363132' TO DFHEIV0(25:11)
  8558     CALL 'kxdfhei1' USING DFHEIV0,
  8559           DFHEIV1,
  8560           SECURITY-MESSAGE,
  8561           DFHEIV11,
  8562           DFHEIV99,
  8563           DFHEIV99,
  8564           DFHEIV99,
  8565           DFHEIV99
  8566     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8567
  8568
  8569******************************************************************
  8570
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:19 Page 150
* EL6317.cbl
  8571 9995-EXIT.
  8572     EXIT.
  8573
  8574 9999-DFHBACK SECTION.
  8575     MOVE '9%                    "   ' TO DFHEIV0
  8576     MOVE 'EL6317' TO DFHEIV1
  8577     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8578     GOBACK.
  8579 9999-DFHEXIT.
  8580     IF DFHEIGDJ EQUAL 0001
  8581         NEXT SENTENCE
  8582     ELSE IF DFHEIGDJ EQUAL 2
  8583         GO TO 8300-SEND-TEXT
  8584         DEPENDING ON DFHEIGDI.
  8585     MOVE '9%                    "   ' TO DFHEIV0
  8586     MOVE 'EL6317' TO DFHEIV1
  8587     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  8588     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       35116     Code:       19050
