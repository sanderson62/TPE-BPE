* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6565.cbl
* Options: int("EL6565.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6565.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6565.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6565.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 ID DIVISION.
     2
     3 PROGRAM-ID.                 EL6565.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 11/29/95 08:43:10.
     7*              PROGRAM REVIEWED FOR YEAR 2000 COMPLIANCE
     8*                            VMOD=2.011
     9
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6565.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION - EXEA - RATE TABLE DISPLAY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6565.cbl
    26 ENVIRONMENT DIVISION.
    27 DATA DIVISION.
    28 WORKING-STORAGE SECTION.
    29 01  DFH-START PIC X(04).
    30 77  FILLER  PIC X(32)  VALUE '********************************'.
    31 77  FILLER  PIC X(32)  VALUE '*    EL6565 WORKING STORAGE    *'.
    32 77  FILLER  PIC X(32)  VALUE '************ V/M 2.011 *********'.
    33
    34 01  WS-DATE-AREA.
    35     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    36     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
    37
    38 01  WS-AREA.
    39     05  DEEDIT-FIELD                PIC X(15).
    40     05  DEEDIT-FIELD-V0  REDEFINES DEEDIT-FIELD PIC S9(15).
    41     05  DEEDIT-FIELD-V1  REDEFINES DEEDIT-FIELD PIC S9(14)V9.
    42     05  DEEDIT-FIELD-V2  REDEFINES DEEDIT-FIELD PIC S9(13)V99.
    43     05  DEEDIT-FIELD-V3  REDEFINES DEEDIT-FIELD PIC S9(12)V999.
    44     05  DEEDIT-FIELD-V4  REDEFINES DEEDIT-FIELD PIC S9(11)V9(4).
    45     05  DEEDIT-FIELD-V5  REDEFINES DEEDIT-FIELD PIC S9(10)V9(5).
    46     05  DEEDIT-FIELD-V6  REDEFINES DEEDIT-FIELD PIC S9(9)V9(6).
    47
    48     05  WS-DEV-PCT          PIC S9V9(6) VALUE ZEROS.
    49     05  WS-DEV-RATE         PIC S99V9(6) VALUE ZEROS.
    50     05  WS-DEV-RATES        PIC X       VALUE ' '.
    51         88  RATES-DEVIATED              VALUE 'X'.
    52     05  WS-CALLED-FROM-ACCT PIC X(8)    VALUE 'EL6507'.
    53     05  WS-CALL-FROM-STATE  PIC X(8)    VALUE 'EL106'.
    54     05  WS-CALL-FROM-STATE-ALT PIC X(8) VALUE 'EL1061'.
    55     05  WS-COMM-LENGTH      PIC S9(4) COMP VALUE +1525.
    56     05  TRANS-ID            PIC X(4)    VALUE 'EXEA'.
    57     05  THIS-PGM            PIC X(8)    VALUE 'EL6565'.
    58     05  WS-MAPNAME          PIC X(8)    VALUE 'EL6565A'.
    59     05  WS-MAPSET-NAME      PIC X(8)    VALUE 'EL6565S'.
    60     05  PGM-NAME            PIC X(8).
    61     05  SUB1                PIC S999    VALUE +0.
    62     05  SUB2                PIC S999    VALUE +0.
    63     05  SUB3                PIC S99     VALUE +0.
    64         88  EVEN-SUB              VALUE +2  +4  +6  +8 +10
    65                                        +12 +14 +16 +18 +20.
    66     05  SUB4                PIC S99     VALUE +0.
    67     05  TIME-IN             PIC S9(7)   VALUE +0.
    68     05  TIME-OUT-R  REDEFINES TIME-IN.
    69         10  FILLER          PIC X.
    70         10  TIME-OUT        PIC 99V99.
    71         10  FILLER          PIC XX.
    72     05  XCTL-005            PIC X(8)    VALUE 'EL005'.
    73     05  XCTL-010            PIC X(8)    VALUE 'EL010'.
    74     05  XCTL-626            PIC X(8)    VALUE 'EL126'.
    75     05  LINK-001            PIC X(8)    VALUE 'EL001'.
    76     05  LINK-004            PIC X(8)    VALUE 'EL004'.
    77     05  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
    78
    79     05  ER-0004             PIC X(4)    VALUE  '0004'.
    80     05  ER-0008             PIC X(4)    VALUE  '0008'.
    81     05  ER-0029             PIC X(4)    VALUE  '0029'.
    82     05  ER-0130             PIC X(4)    VALUE  '0130'.
    83     05  ER-0142             PIC X(4)    VALUE  '0142'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6565.cbl
    84     05  ER-2055             PIC X(4)    VALUE  '2055'.
    85     05  ER-2067             PIC X(4)    VALUE  '2067'.
    86     05  ER-2154             PIC X(4)    VALUE  '2154'.
    87     05  ER-2238             PIC X(4)    VALUE  '2238'.
    88     05  ER-2263             PIC X(4)    VALUE  '2263'.
    89
    90     05  ACCT-FILE-ID        PIC X(8)    VALUE 'ERACCT'.
    91     05  PLAN-FILE-ID        PIC X(8)    VALUE 'ERPLAN'.
    92     05  RATE-FILE-ID        PIC X(8)    VALUE 'ERRATE'.
    93
    94     05  WS-SAVE-RATE-KEY    PIC X(28)   VALUE SPACES.
    95
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6565.cbl
    97*                                  COPY ELCSCTM.
    98******************************************************************
    99*                                                                *
   100*                                                                *
   101*                            ELCSCTM                             *
   102*                            VMOD=2.001                          *
   103*                                                                *
   104*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
   105*                                                                *
   106******************************************************************
   107 01  SECURITY-MESSAGE.
   108     12  FILLER                          PIC X(30)
   109            VALUE '** LOGIC SECURITY VIOLATION -'.
   110     12  SM-READ                         PIC X(6).
   111     12  FILLER                          PIC X(5)
   112            VALUE ' PGM='.
   113     12  SM-PGM                          PIC X(6).
   114     12  FILLER                          PIC X(5)
   115            VALUE ' OPR='.
   116     12  SM-PROCESSOR-ID                 PIC X(4).
   117     12  FILLER                          PIC X(6)
   118            VALUE ' TERM='.
   119     12  SM-TERMID                       PIC X(4).
   120     12  FILLER                          PIC XX   VALUE SPACE.
   121     12  SM-JUL-DATE                     PIC 9(5).
   122     12  FILLER                          PIC X    VALUE SPACE.
   123     12  SM-TIME                         PIC 99.99.
   124
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6565.cbl
   126*                                  COPY ELCSCRTY.
   127******************************************************************
   128*                                                                *
   129*                                                                *
   130*                            ELCSCRTY                            *
   131*                            VMOD=2.001                          *
   132*                                                                *
   133*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   134*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   135*        SAVED IN PI-SECURITY-ADDRESS.                           *
   136*                                                                *
   137******************************************************************
   138 01  SECURITY-CONTROL.
   139     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   140     12  FILLER                       PIC XX    VALUE 'SC'.
   141     12  SC-CREDIT-CODES.
   142         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   143             20  SC-CREDIT-DISPLAY    PIC X.
   144             20  SC-CREDIT-UPDATE     PIC X.
   145     12  SC-CLAIMS-CODES.
   146         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   147             20  SC-CLAIMS-DISPLAY    PIC X.
   148             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6565.cbl
   150*                                  COPY ELCDATE.
   151******************************************************************
   152*                                                                *
   153*                                                                *
   154*                            ELCDATE.                            *
   155*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   156*                            VMOD=2.003
   157*                                                                *
   158*                                                                *
   159*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   160*                 LENGTH = 200                                   *
   161******************************************************************
   162
   163 01  DATE-CONVERSION-DATA.
   164     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   165     12  DC-OPTION-CODE                PIC X.
   166         88  BIN-TO-GREG                VALUE ' '.
   167         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   168         88  EDIT-GREG-TO-BIN           VALUE '2'.
   169         88  YMD-GREG-TO-BIN            VALUE '3'.
   170         88  MDY-GREG-TO-BIN            VALUE '4'.
   171         88  JULIAN-TO-BIN              VALUE '5'.
   172         88  BIN-PLUS-ELAPSED           VALUE '6'.
   173         88  FIND-CENTURY               VALUE '7'.
   174         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   175         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   176         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   177         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   178         88  JULIAN-TO-BIN-3            VALUE 'C'.
   179         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   180         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   181         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   182         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   183         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   184         88  CHECK-LEAP-YEAR            VALUE 'H'.
   185         88  BIN-3-TO-GREG              VALUE 'I'.
   186         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   187         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   188         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   189         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   190         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   191         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   192         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   193         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   194         88  THREE-CHARACTER-BIN
   195                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   196         88  GREGORIAN-TO-BIN
   197                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   198         88  BIN-TO-GREGORIAN
   199                  VALUES ' ' '1' 'I' '8' 'G'.
   200         88  JULIAN-TO-BINARY
   201                  VALUES '5' 'C' 'E' 'F'.
   202     12  DC-ERROR-CODE                 PIC X.
   203         88  NO-CONVERSION-ERROR        VALUE ' '.
   204         88  DATE-CONVERSION-ERROR
   205                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   206         88  DATE-IS-ZERO               VALUE '1'.
   207         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6565.cbl
   208         88  DATE-IS-INVALID            VALUE '3'.
   209         88  DATE1-GREATER-DATE2        VALUE '4'.
   210         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   211         88  DATE-INVALID-OPTION        VALUE '9'.
   212         88  INVALID-CENTURY            VALUE 'A'.
   213         88  ONLY-CENTURY               VALUE 'B'.
   214         88  ONLY-LEAP-YEAR             VALUE 'C'.
   215         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   216     12  DC-END-OF-MONTH               PIC X.
   217         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   218     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   219         88  USE-NORMAL-PROCESS         VALUE ' '.
   220         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   221         88  ADJUST-UP-100-YRS          VALUE '2'.
   222     12  FILLER                        PIC X.
   223     12  DC-CONVERSION-DATES.
   224         16  DC-BIN-DATE-1             PIC XX.
   225         16  DC-BIN-DATE-2             PIC XX.
   226         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   227         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   228                       DC-GREG-DATE-1-EDIT.
   229             20  DC-EDIT1-MONTH        PIC 99.
   230             20  SLASH1-1              PIC X.
   231             20  DC-EDIT1-DAY          PIC 99.
   232             20  SLASH1-2              PIC X.
   233             20  DC-EDIT1-YEAR         PIC 99.
   234         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   235         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   236                     DC-GREG-DATE-2-EDIT.
   237             20  DC-EDIT2-MONTH        PIC 99.
   238             20  SLASH2-1              PIC X.
   239             20  DC-EDIT2-DAY          PIC 99.
   240             20  SLASH2-2              PIC X.
   241             20  DC-EDIT2-YEAR         PIC 99.
   242         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   243         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   244                     DC-GREG-DATE-1-YMD.
   245             20  DC-YMD-YEAR           PIC 99.
   246             20  DC-YMD-MONTH          PIC 99.
   247             20  DC-YMD-DAY            PIC 99.
   248         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   249         16  DC-GREG-DATE-1-MDY-R REDEFINES
   250                      DC-GREG-DATE-1-MDY.
   251             20  DC-MDY-MONTH          PIC 99.
   252             20  DC-MDY-DAY            PIC 99.
   253             20  DC-MDY-YEAR           PIC 99.
   254         16  DC-GREG-DATE-1-ALPHA.
   255             20  DC-ALPHA-MONTH        PIC X(10).
   256             20  DC-ALPHA-DAY          PIC 99.
   257             20  FILLER                PIC XX.
   258             20  DC-ALPHA-CENTURY.
   259                 24 DC-ALPHA-CEN-N     PIC 99.
   260             20  DC-ALPHA-YEAR         PIC 99.
   261         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   262         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   263         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   264         16  DC-JULIAN-DATE            PIC 9(05).
   265         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6565.cbl
   266                                       PIC 9(05).
   267         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   268             20  DC-JULIAN-YEAR        PIC 99.
   269             20  DC-JULIAN-DAYS        PIC 999.
   270         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   271         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   272         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   273     12  DATE-CONVERSION-VARIBLES.
   274         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   275         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   276             20  FILLER                PIC 9(3).
   277             20  HOLD-CEN-1-CCYY.
   278                 24  HOLD-CEN-1-CC     PIC 99.
   279                 24  HOLD-CEN-1-YY     PIC 99.
   280             20  HOLD-CEN-1-MO         PIC 99.
   281             20  HOLD-CEN-1-DA         PIC 99.
   282         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   283             20  HOLD-CEN-1-R-MO       PIC 99.
   284             20  HOLD-CEN-1-R-DA       PIC 99.
   285             20  HOLD-CEN-1-R-CCYY.
   286                 24  HOLD-CEN-1-R-CC   PIC 99.
   287                 24  HOLD-CEN-1-R-YY   PIC 99.
   288             20  FILLER                PIC 9(3).
   289         16  HOLD-CENTURY-1-X.
   290             20  FILLER                PIC X(3)  VALUE SPACES.
   291             20  HOLD-CEN-1-X-CCYY.
   292                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   293                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   294             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   295             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   296         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   297             20  HOLD-CEN-1-R-X-MO     PIC XX.
   298             20  HOLD-CEN-1-R-X-DA     PIC XX.
   299             20  HOLD-CEN-1-R-X-CCYY.
   300                 24  HOLD-CEN-1-R-X-CC PIC XX.
   301                 24  HOLD-CEN-1-R-X-YY PIC XX.
   302             20  FILLER                PIC XXX.
   303         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   304         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   305         16  DC-JULIAN-DATE-1          PIC 9(07).
   306         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   307             20  DC-JULIAN-1-CCYY.
   308                 24  DC-JULIAN-1-CC    PIC 99.
   309                 24  DC-JULIAN-1-YR    PIC 99.
   310             20  DC-JULIAN-DA-1        PIC 999.
   311         16  DC-JULIAN-DATE-2          PIC 9(07).
   312         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   313             20  DC-JULIAN-2-CCYY.
   314                 24  DC-JULIAN-2-CC    PIC 99.
   315                 24  DC-JULIAN-2-YR    PIC 99.
   316             20  DC-JULIAN-DA-2        PIC 999.
   317         16  DC-GREG-DATE-A-EDIT.
   318             20  DC-EDITA-MONTH        PIC 99.
   319             20  SLASHA-1              PIC X VALUE '/'.
   320             20  DC-EDITA-DAY          PIC 99.
   321             20  SLASHA-2              PIC X VALUE '/'.
   322             20  DC-EDITA-CCYY.
   323                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6565.cbl
   324                 24  DC-EDITA-YEAR     PIC 99.
   325         16  DC-GREG-DATE-B-EDIT.
   326             20  DC-EDITB-MONTH        PIC 99.
   327             20  SLASHB-1              PIC X VALUE '/'.
   328             20  DC-EDITB-DAY          PIC 99.
   329             20  SLASHB-2              PIC X VALUE '/'.
   330             20  DC-EDITB-CCYY.
   331                 24  DC-EDITB-CENT     PIC 99.
   332                 24  DC-EDITB-YEAR     PIC 99.
   333         16  DC-GREG-DATE-CYMD         PIC 9(08).
   334         16  DC-GREG-DATE-CYMD-R REDEFINES
   335                              DC-GREG-DATE-CYMD.
   336             20  DC-CYMD-CEN           PIC 99.
   337             20  DC-CYMD-YEAR          PIC 99.
   338             20  DC-CYMD-MONTH         PIC 99.
   339             20  DC-CYMD-DAY           PIC 99.
   340         16  DC-GREG-DATE-MDCY         PIC 9(08).
   341         16  DC-GREG-DATE-MDCY-R REDEFINES
   342                              DC-GREG-DATE-MDCY.
   343             20  DC-MDCY-MONTH         PIC 99.
   344             20  DC-MDCY-DAY           PIC 99.
   345             20  DC-MDCY-CEN           PIC 99.
   346             20  DC-MDCY-YEAR          PIC 99.
   347    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   348        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   349    12  DC-EL310-DATE                  PIC X(21).
   350    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6565.cbl
   352*                                  COPY ELCLOGOF.
   353******************************************************************
   354*                                                                *
   355*                                                                *
   356*                            ELCLOGOF.                           *
   357*                            VMOD=2.001                          *
   358*                                                                *
   359*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   360*                                                                *
   361******************************************************************
   362 01  CLASIC-LOGOFF.
   363     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   364     12  LOGOFF-TEXT.
   365         16  FILLER          PIC X(5)    VALUE SPACES.
   366         16  LOGOFF-MSG.
   367             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   368             20  FILLER      PIC X       VALUE SPACES.
   369             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   370         16  FILLER          PIC X(80)
   371           VALUE '* YOU ARE NOW LOGGED OFF'.
   372         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   373         16  FILLER          PIC X       VALUE QUOTE.
   374         16  LOGOFF-SYS-MSG  PIC X(17)
   375           VALUE 'S CLAS-IC SYSTEM '.
   376     12  TEXT-MESSAGES.
   377         16  UNACCESS-MSG    PIC X(29)
   378             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   379         16  PGMIDERR-MSG    PIC X(17)
   380             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6565.cbl
   382*                                  COPY ELCATTR.
   383******************************************************************
   384*                                                                *
   385*                            ELCATTR.                            *
   386*                            VMOD=2.001                          *
   387*                                                                *
   388*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   389*                                                                *
   390*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   391*                                                                *
   392*                   POS 1   P=PROTECTED                          *
   393*                           U=UNPROTECTED                        *
   394*                           S=ASKIP                              *
   395*                   POS 2   A=ALPHA/NUMERIC                      *
   396*                           N=NUMERIC                            *
   397*                   POS 3   N=NORMAL                             *
   398*                           B=BRIGHT                             *
   399*                           D=DARK                               *
   400*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   401*                           OF=MODIFIED DATA TAG OFF             *
   402*                                                                *
   403*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   404******************************************************************
   405 01  ATTRIBUTE-LIST.
   406     12  AL-PABOF            PIC X       VALUE 'Y'.
   407     12  AL-PABON            PIC X       VALUE 'Z'.
   408     12  AL-PADOF            PIC X       VALUE '%'.
   409     12  AL-PADON            PIC X       VALUE '_'.
   410     12  AL-PANOF            PIC X       VALUE '-'.
   411     12  AL-PANON            PIC X       VALUE '/'.
   412     12  AL-SABOF            PIC X       VALUE '8'.
   413     12  AL-SABON            PIC X       VALUE '9'.
   414     12  AL-SADOF            PIC X       VALUE '@'.
   415     12  AL-SADON            PIC X       VALUE QUOTE.
   416     12  AL-SANOF            PIC X       VALUE '0'.
   417     12  AL-SANON            PIC X       VALUE '1'.
   418     12  AL-UABOF            PIC X       VALUE 'H'.
   419     12  AL-UABON            PIC X       VALUE 'I'.
   420     12  AL-UADOF            PIC X       VALUE '<'.
   421     12  AL-UADON            PIC X       VALUE '('.
   422     12  AL-UANOF            PIC X       VALUE ' '.
   423     12  AL-UANON            PIC X       VALUE 'A'.
   424     12  AL-UNBOF            PIC X       VALUE 'Q'.
   425     12  AL-UNBON            PIC X       VALUE 'R'.
   426     12  AL-UNDOF            PIC X       VALUE '*'.
   427     12  AL-UNDON            PIC X       VALUE ')'.
   428     12  AL-UNNOF            PIC X       VALUE '&'.
   429     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6565.cbl
   431*                                  COPY ELCEMIB.
   432******************************************************************
   433*                                                                *
   434*                                                                *
   435*                            ELCEMIB.                            *
   436*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   437*                            VMOD=2.005                          *
   438*                                                                *
   439*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   440*                                                                *
   441******************************************************************
   442 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   443     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   444     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   445     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   446     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   447     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   448     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   449     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   450     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   451     12  EMI-SWITCH1             PIC X        VALUE '1'.
   452         88  EMI-NO-ERRORS                    VALUE '1'.
   453         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   454         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   455     12  EMI-SWITCH2             PIC X        VALUE '1'.
   456         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   457     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   458         88  EMI-AREA1-EMPTY                  VALUE '1'.
   459         88  EMI-AREA1-FULL                   VALUE '2'.
   460     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   461         88  EMI-AREA2-EMPTY                  VALUE '1'.
   462         88  EMI-AREA2-FULL                   VALUE '2'.
   463     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   464         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   465         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   466         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   467         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   468         88  EMI-BYPASS-FATALS                VALUE 'X'.
   469     12  EMI-ERROR-LINES.
   470         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   471         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   472         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   473         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   474             20  EMI-ERR-CODES OCCURS 10 TIMES.
   475                 24  EMI-ERR-NUM         PIC X(4).
   476                 24  EMI-FILLER          PIC X.
   477                 24  EMI-SEV             PIC X.
   478                 24  FILLER              PIC X.
   479             20  FILLER                  PIC X(02).
   480     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   481         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   482             20  EMI-ERROR-NUMBER    PIC X(4).
   483             20  EMI-FILL            PIC X.
   484             20  EMI-SEVERITY        PIC X.
   485             20  FILLER              PIC X.
   486             20  EMI-ERROR-TEXT.
   487                 24  EMI-TEXT-VARIABLE   PIC X(10).
   488                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6565.cbl
   489     12  EMI-SEVERITY-SAVE           PIC X.
   490         88  EMI-NOTE                    VALUE 'N'.
   491         88  EMI-WARNING                 VALUE 'W'.
   492         88  EMI-FORCABLE                VALUE 'F'.
   493         88  EMI-FATAL                   VALUE 'X'.
   494     12  EMI-MESSAGE-FLAG            PIC X.
   495         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   496         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   497     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   498     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   499         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   500         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   501         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   502     12  FILLER                      PIC X(137)  VALUE SPACES.
   503     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   504     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   505     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   506     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6565.cbl
   508*                                  COPY ELCINTF.
   509******************************************************************
   510*                                                                *
   511*                                                                *
   512*                            ELCINTF.                            *
   513*                            VMOD=2.017                          *
   514*                                                                *
   515*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   516*                                                                *
   517*       LENGTH = 1024                                            *
   518*                                                                *
   519******************************************************************
   520 01  PROGRAM-INTERFACE-BLOCK.
   521     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   522     12  PI-CALLING-PROGRAM              PIC X(8).
   523     12  PI-SAVED-PROGRAM-1              PIC X(8).
   524     12  PI-SAVED-PROGRAM-2              PIC X(8).
   525     12  PI-SAVED-PROGRAM-3              PIC X(8).
   526     12  PI-SAVED-PROGRAM-4              PIC X(8).
   527     12  PI-SAVED-PROGRAM-5              PIC X(8).
   528     12  PI-SAVED-PROGRAM-6              PIC X(8).
   529     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   530     12  PI-COMPANY-ID                   PIC XXX.
   531     12  PI-COMPANY-CD                   PIC X.
   532
   533     12  PI-COMPANY-PASSWORD             PIC X(8).
   534
   535     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   536
   537     12  PI-CONTROL-IN-PROGRESS.
   538         16  PI-CARRIER                  PIC X.
   539         16  PI-GROUPING                 PIC X(6).
   540         16  PI-STATE                    PIC XX.
   541         16  PI-ACCOUNT                  PIC X(10).
   542         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   543                                         PIC X(10).
   544         16  PI-CLAIM-CERT-GRP.
   545             20  PI-CLAIM-NO             PIC X(7).
   546             20  PI-CERT-NO.
   547                 25  PI-CERT-PRIME       PIC X(10).
   548                 25  PI-CERT-SFX         PIC X.
   549             20  PI-CERT-EFF-DT          PIC XX.
   550         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   551             20  PI-PLAN-CODE            PIC X(2).
   552             20  PI-REVISION-NUMBER      PIC X(3).
   553             20  PI-PLAN-EFF-DT          PIC X(2).
   554             20  PI-PLAN-EXP-DT          PIC X(2).
   555             20  FILLER                  PIC X(11).
   556         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   557             20  PI-OE-REFERENCE-1.
   558                 25  PI-OE-REF-1-PRIME   PIC X(18).
   559                 25  PI-OE-REF-1-SUFF    PIC XX.
   560
   561     12  PI-SESSION-IN-PROGRESS          PIC X.
   562         88  CLAIM-SESSION                   VALUE '1'.
   563         88  CREDIT-SESSION                  VALUE '2'.
   564         88  WARRANTY-SESSION                VALUE '3'.
   565         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6565.cbl
   566         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   567
   568
   569*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   570
   571     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   572     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   573
   574     12  PI-CREDIT-USER                  PIC X.
   575         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   576         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   577
   578     12  PI-CLAIM-USER                   PIC X.
   579         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   580         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   581
   582     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   583         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   584         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   585         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   586         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   587         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   588
   589     12  PI-PROCESSOR-ID                 PIC X(4).
   590
   591     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   592
   593     12  PI-MEMBER-CAPTION               PIC X(10).
   594
   595     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   596         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   597
   598     12  PI-LIFE-OVERRIDE-L1             PIC X.
   599     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   600     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   601     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   602
   603     12  PI-AH-OVERRIDE-L1               PIC X.
   604     12  PI-AH-OVERRIDE-L2               PIC XX.
   605     12  PI-AH-OVERRIDE-L6               PIC X(6).
   606     12  PI-AH-OVERRIDE-L12              PIC X(12).
   607
   608     12  PI-NEW-SYSTEM                   PIC X(2).
   609
   610     12  PI-PRIMARY-CERT-NO              PIC X(11).
   611     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   612         88  PI-USES-PAID-TO                 VALUE '1'.
   613     12  PI-CRDTCRD-SYSTEM.
   614         16  PI-CRDTCRD-USER             PIC X.
   615             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   616             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   617         16  PI-CC-MONTH-END-DT          PIC XX.
   618     12  PI-PROCESSOR-PRINTER            PIC X(4).
   619
   620     12  PI-OE-REFERENCE-2.
   621         16  PI-OE-REF-2-PRIME           PIC X(10).
   622         16  PI-OE-REF-2-SUFF            PIC X.
   623
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6565.cbl
   624     12  PI-REM-TRM-CALC-OPTION          PIC X.
   625
   626     12  PI-LANGUAGE-TYPE                PIC X.
   627             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   628             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   629             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   630
   631     12  PI-POLICY-LINKAGE-IND           PIC X.
   632         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   633         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   634                                                   LOW-VALUES.
   635
   636     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   637     12  PI-CLAIM-PW-SESSION             PIC X(1).
   638         88  PI-CLAIM-CREDIT                 VALUE '1'.
   639         88  PI-CLAIM-CONVEN                 VALUE '2'.
   640     12  FILLER                          PIC X(4).
   641
   642     12  PI-SYSTEM-LEVEL                 PIC X(145).
   643
   644     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   645         PI-SYSTEM-LEVEL.
   646
   647         16  PI-ENTRY-CODES.
   648             20  PI-ENTRY-CD-1           PIC X.
   649             20  PI-ENTRY-CD-2           PIC X.
   650
   651         16  PI-RETURN-CODES.
   652             20  PI-RETURN-CD-1          PIC X.
   653             20  PI-RETURN-CD-2          PIC X.
   654
   655         16  PI-UPDATE-STATUS-SAVE.
   656             20  PI-UPDATE-BY            PIC X(4).
   657             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   658
   659         16  PI-LOWER-CASE-LETTERS       PIC X.
   660             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   661
   662*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   663*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   664*            88  CARRIER-CLM-CNTL            VALUE '2'.
   665
   666         16  PI-CERT-ACCESS-CONTROL      PIC X.
   667             88  ST-ACCNT-CNTL               VALUE ' '.
   668             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   669             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   670             88  ACCNT-CNTL                  VALUE '3'.
   671             88  CARR-ACCNT-CNTL             VALUE '4'.
   672
   673         16  PI-PROCESSOR-CAP-LIST.
   674             20  PI-SYSTEM-CONTROLS.
   675                24 PI-SYSTEM-DISPLAY     PIC X.
   676                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   677                24 PI-SYSTEM-MODIFY      PIC X.
   678                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   679             20  FILLER                  PIC XX.
   680             20  PI-DISPLAY-CAP          PIC X.
   681                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6565.cbl
   682             20  PI-MODIFY-CAP           PIC X.
   683                 88  MODIFY-CAP              VALUE 'Y'.
   684             20  PI-MSG-AT-LOGON-CAP     PIC X.
   685                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   686             20  PI-FORCE-CAP            PIC X.
   687                 88  FORCE-CAP               VALUE 'Y'.
   688
   689         16  PI-PROGRAM-CONTROLS.
   690             20  PI-PGM-PRINT-OPT        PIC X.
   691             20  PI-PGM-FORMAT-OPT       PIC X.
   692             20  PI-PGM-PROCESS-OPT      PIC X.
   693             20  PI-PGM-TOTALS-OPT       PIC X.
   694
   695         16  PI-HELP-INTERFACE.
   696             20  PI-LAST-ERROR-NO        PIC X(4).
   697             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   698
   699         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   700             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   701
   702         16  PI-CR-CONTROL-IN-PROGRESS.
   703             20  PI-CR-CARRIER           PIC X.
   704             20  PI-CR-GROUPING          PIC X(6).
   705             20  PI-CR-STATE             PIC XX.
   706             20  PI-CR-ACCOUNT           PIC X(10).
   707             20  PI-CR-FIN-RESP          PIC X(10).
   708             20  PI-CR-TYPE              PIC X.
   709
   710         16  PI-CR-BATCH-NUMBER          PIC X(6).
   711
   712         16  PI-CR-MONTH-END-DT          PIC XX.
   713
   714         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   715             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   716             88  PI-ZERO-CARRIER             VALUE '1'.
   717             88  PI-ZERO-GROUPING            VALUE '2'.
   718             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   719
   720         16  PI-CARRIER-SECURITY         PIC X.
   721             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   722
   723         16  PI-ACCOUNT-SECURITY         PIC X(10).
   724             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   725             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   726
   727         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   728             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   729                                         INDEXED BY PI-ACCESS-NDX
   730                                         PIC X.
   731
   732         16  PI-GA-BILLING-CONTROL       PIC X.
   733             88  PI-GA-BILLING               VALUE '1'.
   734
   735         16  PI-MAIL-PROCESSING          PIC X.
   736             88  PI-MAIL-YES                 VALUE 'Y'.
   737
   738         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   739
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6565.cbl
   740         16  PI-AR-SYSTEM.
   741             20  PI-AR-PROCESSING-CNTL   PIC X.
   742                 88  PI-AR-PROCESSING        VALUE 'Y'.
   743             20  PI-AR-SUMMARY-CODE      PIC X(6).
   744             20  PI-AR-MONTH-END-DT      PIC XX.
   745
   746         16  PI-MP-SYSTEM.
   747             20  PI-MORTGAGE-USER            PIC X.
   748                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   749                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   750             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   751                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   752                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   753                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   754                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   755                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   756             20  PI-MP-MONTH-END-DT          PIC XX.
   757             20  PI-MP-REFERENCE-NO.
   758                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   759                 24  PI-MP-REFERENCE-SFX     PIC XX.
   760
   761         16  PI-LABEL-CONTROL            PIC X(01).
   762             88  PI-CREATE-LABELS                    VALUE 'Y'.
   763             88  PI-BYPASS-LABELS                    VALUE 'N'.
   764
   765         16  PI-BILL-GROUPING-CODE       PIC X(01).
   766             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   767
   768         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   769             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   770             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   771
   772         16  FILLER                      PIC X(14).
   773
   774     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   775******************************************************************
   776     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   777         16  FILLER                       PIC X(41).
   778         16  PI-ACCT-KEY.
   779             20  PI-ACCT-CCGSA-KEY.
   780                 24  PI-ACCT-CO             PIC X.
   781                 24  PI-ACCT-CARRIER        PIC X.
   782                 24  PI-ACCT-GROUPING       PIC X(6).
   783                 24  PI-ACCT-STATE          PIC XX.
   784                 24  PI-ACCT-ACCOUNT        PIC X(10).
   785             20  PI-ACCT-EXP-DT           PIC XX.
   786             20  PI-ACCT-REST-OF-EXP      PIC X(4).
   787         16  FILLER                       PIC X(08).
   788         16  PI-PLAN-KEY.
   789             20  PI-PLAN-ACCT-KEY.
   790                 24  PI-PLAN-COMPANY-CD PIC X.
   791                 24  PI-PLAN-CARRIER    PIC X.
   792                 24  PI-PLAN-GROUP      PIC X(6).
   793                 24  PI-PLAN-STATE      PIC X(2).
   794                 24  PI-PLAN-ACCOUNT    PIC X(10).
   795             20  PI-PLAN-BEN-TYPE       PIC X.
   796             20  PI-PLAN-BEN            PIC XX.
   797             20  PI-PLAN-REVISION       PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6565.cbl
   798
   799         16  PI-WS-STATE                PIC XX.
   800         16  PI-WS-CLASS                PIC XX.
   801         16  PI-WS-DEV                  PIC X(3).
   802         16  PI-WS-TYPE                 PIC X.
   803         16  PI-WS-PLAN                 PIC XX.
   804         16  PI-PREV-STATE              PIC X(4).
   805
   806*****************
   807         16  PI-SUB                            PIC S999.
   808         16  PI-YEAR                           PIC S99.
   809         16  PI-NDX                            PIC S99.
   810         16  PI-SAVE-CALLING-PGM               PIC X(8).
   811         16  PI-ERRATE-EOF-SW                  PIC X.
   812             88 ERRATE-EOF                            VALUE 'Y'.
   813         16  PI-BROWSE-SW                      PIC X.
   814             88 BROWSE-STARTED               VALUE 'Y'.
   815         16  PI-STATE-FOUND-SW                 PIC X.
   816             88 STATE-NOT-FOUND              VALUE 'N'.
   817
   818         16  PI-ERRATE-KEY.
   819             20  PI-RATE-COMPANY-CD         PIC X.
   820             20  PI-RATE-STATE-CODE.
   821                 24  PI-RATE-CODE           PIC XX.
   822                 24  PI-RATE-CLASS          PIC XX.
   823                 24  PI-RATE-DEV            PIC XXX.
   824             20  PI-RATE-L-AH-CODE.
   825                 24  PI-RATE-L-AH           PIC X.
   826                 24  PI-RATE-LAH-NUM        PIC XX.
   827             20  PI-RATE-LIMITS             PIC X(11).
   828             20  PI-RATE-EXPIRY-DATE        PIC 9(11)   COMP-3.
   829         16  PI-LF-DEV-PCT                  PIC S9V9(6) COMP-3.
   830         16  PI-AH-DEV-PCT                  PIC S9V9(6) COMP-3.
   831         16  PI-SAVE-RATE-CODE              PIC XX.
   832         16  PI-1ST-TIME                    PIC X.
   833             88  PI-FIRST-TIME-THRU          VALUE 'X'.
   834         16  FILLER                        PIC X(468).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6565.cbl
   836*                            COPY ELCAID.
   837******************************************************************
   838*                                                                *
   839*                            ELCAID.                             *
   840*                            VMOD=2.001                          *
   841*                                                                *
   842*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   843*                                                                *
   844*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   845*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   846******************************************************************
   847
   848 01  DFHAID.
   849   02  DFHNULL   PIC  X  VALUE  ' '.
   850   02  DFHENTER  PIC  X  VALUE  QUOTE.
   851   02  DFHCLEAR  PIC  X  VALUE  '_'.
   852   02  DFHPEN    PIC  X  VALUE  '='.
   853   02  DFHOPID   PIC  X  VALUE  'W'.
   854   02  DFHPA1    PIC  X  VALUE  '%'.
   855   02  DFHPA2    PIC  X  VALUE  '>'.
   856   02  DFHPA3    PIC  X  VALUE  ','.
   857   02  DFHPF1    PIC  X  VALUE  '1'.
   858   02  DFHPF2    PIC  X  VALUE  '2'.
   859   02  DFHPF3    PIC  X  VALUE  '3'.
   860   02  DFHPF4    PIC  X  VALUE  '4'.
   861   02  DFHPF5    PIC  X  VALUE  '5'.
   862   02  DFHPF6    PIC  X  VALUE  '6'.
   863   02  DFHPF7    PIC  X  VALUE  '7'.
   864   02  DFHPF8    PIC  X  VALUE  '8'.
   865   02  DFHPF9    PIC  X  VALUE  '9'.
   866   02  DFHPF10   PIC  X  VALUE  ':'.
   867   02  DFHPF11   PIC  X  VALUE  '#'.
   868   02  DFHPF12   PIC  X  VALUE  '@'.
   869   02  DFHPF13   PIC  X  VALUE  'A'.
   870   02  DFHPF14   PIC  X  VALUE  'B'.
   871   02  DFHPF15   PIC  X  VALUE  'C'.
   872   02  DFHPF16   PIC  X  VALUE  'D'.
   873   02  DFHPF17   PIC  X  VALUE  'E'.
   874   02  DFHPF18   PIC  X  VALUE  'F'.
   875   02  DFHPF19   PIC  X  VALUE  'G'.
   876   02  DFHPF20   PIC  X  VALUE  'H'.
   877   02  DFHPF21   PIC  X  VALUE  'I'.
   878*00039    02  DFHPF22   PIC  X  VALUE  ''.
   879   02  DFHPF22   PIC  X  VALUE  '['.
   880   02  DFHPF23   PIC  X  VALUE  '.'.
   881   02  DFHPF24   PIC  X  VALUE  '<'.
   882   02  DFHMSRE   PIC  X  VALUE  'X'.
   883   02  DFHSTRF   PIC  X  VALUE  'h'.
   884   02  DFHTRIG   PIC  X  VALUE  '"'.
   885
   886 01  FILLER REDEFINES DFHAID.
   887     05  FILLER              PIC X(8).
   888     05  PF-VALUES           PIC X       OCCURS 2.
   889
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6565.cbl
   891*                            COPY EL6565S.
   892 01  EL6565AI.
   893     05  FILLER            PIC  X(0012).
   894*    -------------------------------
   895     05  RUNDATEL PIC S9(0004) COMP.
   896     05  RUNDATEF PIC  X(0001).
   897     05  FILLER REDEFINES RUNDATEF.
   898         10  RUNDATEA PIC  X(0001).
   899     05  RUNDATEI PIC  X(0008).
   900*    -------------------------------
   901     05  RUNTIMEL PIC S9(0004) COMP.
   902     05  RUNTIMEF PIC  X(0001).
   903     05  FILLER REDEFINES RUNTIMEF.
   904         10  RUNTIMEA PIC  X(0001).
   905     05  RUNTIMEI PIC  X(0005).
   906*    -------------------------------
   907     05  STATEL PIC S9(0004) COMP.
   908     05  STATEF PIC  X(0001).
   909     05  FILLER REDEFINES STATEF.
   910         10  STATEA PIC  X(0001).
   911     05  STATEI PIC  X(0002).
   912*    -------------------------------
   913     05  CLASSL PIC S9(0004) COMP.
   914     05  CLASSF PIC  X(0001).
   915     05  FILLER REDEFINES CLASSF.
   916         10  CLASSA PIC  X(0001).
   917     05  CLASSI PIC  X(0002).
   918*    -------------------------------
   919     05  DEVL PIC S9(0004) COMP.
   920     05  DEVF PIC  X(0001).
   921     05  FILLER REDEFINES DEVF.
   922         10  DEVA PIC  X(0001).
   923     05  DEVI PIC  X(0003).
   924*    -------------------------------
   925     05  PCTL PIC S9(0004) COMP.
   926     05  PCTF PIC  X(0001).
   927     05  FILLER REDEFINES PCTF.
   928         10  PCTA PIC  X(0001).
   929     05  PCTI PIC  X(0008).
   930*    -------------------------------
   931     05  TYPEL PIC S9(0004) COMP.
   932     05  TYPEF PIC  X(0001).
   933     05  FILLER REDEFINES TYPEF.
   934         10  TYPEA PIC  X(0001).
   935     05  TYPEI PIC  X(0001).
   936*    -------------------------------
   937     05  PLANL PIC S9(0004) COMP.
   938     05  PLANF PIC  X(0001).
   939     05  FILLER REDEFINES PLANF.
   940         10  PLANA PIC  X(0001).
   941     05  PLANI PIC  X(0002).
   942*    -------------------------------
   943     05  YR1L PIC S9(0004) COMP.
   944     05  YR1F PIC  X(0001).
   945     05  FILLER REDEFINES YR1F.
   946         10  YR1A PIC  X(0001).
   947     05  YR1I PIC  X(0002).
   948*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6565.cbl
   949     05  M01L PIC S9(0004) COMP.
   950     05  M01F PIC  X(0001).
   951     05  FILLER REDEFINES M01F.
   952         10  M01A PIC  X(0001).
   953     05  M01I PIC  X(0005).
   954*    -------------------------------
   955     05  LINE1L PIC S9(0004) COMP.
   956     05  LINE1F PIC  X(0001).
   957     05  FILLER REDEFINES LINE1F.
   958         10  LINE1A PIC  X(0001).
   959     05  LINE1I PIC  X(0060).
   960*    -------------------------------
   961     05  YR1AL PIC S9(0004) COMP.
   962     05  YR1AF PIC  X(0001).
   963     05  FILLER REDEFINES YR1AF.
   964         10  YR1AA PIC  X(0001).
   965     05  YR1AI PIC  X(0002).
   966*    -------------------------------
   967     05  M01AL PIC S9(0004) COMP.
   968     05  M01AF PIC  X(0001).
   969     05  FILLER REDEFINES M01AF.
   970         10  M01AA PIC  X(0001).
   971     05  M01AI PIC  X(0005).
   972*    -------------------------------
   973     05  LINE2L PIC S9(0004) COMP.
   974     05  LINE2F PIC  X(0001).
   975     05  FILLER REDEFINES LINE2F.
   976         10  LINE2A PIC  X(0001).
   977     05  LINE2I PIC  X(0060).
   978*    -------------------------------
   979     05  YR2L PIC S9(0004) COMP.
   980     05  YR2F PIC  X(0001).
   981     05  FILLER REDEFINES YR2F.
   982         10  YR2A PIC  X(0001).
   983     05  YR2I PIC  X(0002).
   984*    -------------------------------
   985     05  M02L PIC S9(0004) COMP.
   986     05  M02F PIC  X(0001).
   987     05  FILLER REDEFINES M02F.
   988         10  M02A PIC  X(0001).
   989     05  M02I PIC  X(0005).
   990*    -------------------------------
   991     05  LINE3L PIC S9(0004) COMP.
   992     05  LINE3F PIC  X(0001).
   993     05  FILLER REDEFINES LINE3F.
   994         10  LINE3A PIC  X(0001).
   995     05  LINE3I PIC  X(0060).
   996*    -------------------------------
   997     05  YR2AL PIC S9(0004) COMP.
   998     05  YR2AF PIC  X(0001).
   999     05  FILLER REDEFINES YR2AF.
  1000         10  YR2AA PIC  X(0001).
  1001     05  YR2AI PIC  X(0002).
  1002*    -------------------------------
  1003     05  M02AL PIC S9(0004) COMP.
  1004     05  M02AF PIC  X(0001).
  1005     05  FILLER REDEFINES M02AF.
  1006         10  M02AA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6565.cbl
  1007     05  M02AI PIC  X(0005).
  1008*    -------------------------------
  1009     05  LINE4L PIC S9(0004) COMP.
  1010     05  LINE4F PIC  X(0001).
  1011     05  FILLER REDEFINES LINE4F.
  1012         10  LINE4A PIC  X(0001).
  1013     05  LINE4I PIC  X(0060).
  1014*    -------------------------------
  1015     05  YR3L PIC S9(0004) COMP.
  1016     05  YR3F PIC  X(0001).
  1017     05  FILLER REDEFINES YR3F.
  1018         10  YR3A PIC  X(0001).
  1019     05  YR3I PIC  X(0002).
  1020*    -------------------------------
  1021     05  M03L PIC S9(0004) COMP.
  1022     05  M03F PIC  X(0001).
  1023     05  FILLER REDEFINES M03F.
  1024         10  M03A PIC  X(0001).
  1025     05  M03I PIC  X(0005).
  1026*    -------------------------------
  1027     05  LINE5L PIC S9(0004) COMP.
  1028     05  LINE5F PIC  X(0001).
  1029     05  FILLER REDEFINES LINE5F.
  1030         10  LINE5A PIC  X(0001).
  1031     05  LINE5I PIC  X(0060).
  1032*    -------------------------------
  1033     05  YR3AL PIC S9(0004) COMP.
  1034     05  YR3AF PIC  X(0001).
  1035     05  FILLER REDEFINES YR3AF.
  1036         10  YR3AA PIC  X(0001).
  1037     05  YR3AI PIC  X(0002).
  1038*    -------------------------------
  1039     05  M03AL PIC S9(0004) COMP.
  1040     05  M03AF PIC  X(0001).
  1041     05  FILLER REDEFINES M03AF.
  1042         10  M03AA PIC  X(0001).
  1043     05  M03AI PIC  X(0005).
  1044*    -------------------------------
  1045     05  LINE6L PIC S9(0004) COMP.
  1046     05  LINE6F PIC  X(0001).
  1047     05  FILLER REDEFINES LINE6F.
  1048         10  LINE6A PIC  X(0001).
  1049     05  LINE6I PIC  X(0060).
  1050*    -------------------------------
  1051     05  YR4L PIC S9(0004) COMP.
  1052     05  YR4F PIC  X(0001).
  1053     05  FILLER REDEFINES YR4F.
  1054         10  YR4A PIC  X(0001).
  1055     05  YR4I PIC  X(0002).
  1056*    -------------------------------
  1057     05  M04L PIC S9(0004) COMP.
  1058     05  M04F PIC  X(0001).
  1059     05  FILLER REDEFINES M04F.
  1060         10  M04A PIC  X(0001).
  1061     05  M04I PIC  X(0005).
  1062*    -------------------------------
  1063     05  LINE7L PIC S9(0004) COMP.
  1064     05  LINE7F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6565.cbl
  1065     05  FILLER REDEFINES LINE7F.
  1066         10  LINE7A PIC  X(0001).
  1067     05  LINE7I PIC  X(0060).
  1068*    -------------------------------
  1069     05  YR4AL PIC S9(0004) COMP.
  1070     05  YR4AF PIC  X(0001).
  1071     05  FILLER REDEFINES YR4AF.
  1072         10  YR4AA PIC  X(0001).
  1073     05  YR4AI PIC  X(0002).
  1074*    -------------------------------
  1075     05  M04AL PIC S9(0004) COMP.
  1076     05  M04AF PIC  X(0001).
  1077     05  FILLER REDEFINES M04AF.
  1078         10  M04AA PIC  X(0001).
  1079     05  M04AI PIC  X(0005).
  1080*    -------------------------------
  1081     05  LINE8L PIC S9(0004) COMP.
  1082     05  LINE8F PIC  X(0001).
  1083     05  FILLER REDEFINES LINE8F.
  1084         10  LINE8A PIC  X(0001).
  1085     05  LINE8I PIC  X(0060).
  1086*    -------------------------------
  1087     05  YR5L PIC S9(0004) COMP.
  1088     05  YR5F PIC  X(0001).
  1089     05  FILLER REDEFINES YR5F.
  1090         10  YR5A PIC  X(0001).
  1091     05  YR5I PIC  X(0002).
  1092*    -------------------------------
  1093     05  M05L PIC S9(0004) COMP.
  1094     05  M05F PIC  X(0001).
  1095     05  FILLER REDEFINES M05F.
  1096         10  M05A PIC  X(0001).
  1097     05  M05I PIC  X(0005).
  1098*    -------------------------------
  1099     05  LINE9L PIC S9(0004) COMP.
  1100     05  LINE9F PIC  X(0001).
  1101     05  FILLER REDEFINES LINE9F.
  1102         10  LINE9A PIC  X(0001).
  1103     05  LINE9I PIC  X(0060).
  1104*    -------------------------------
  1105     05  YR5AL PIC S9(0004) COMP.
  1106     05  YR5AF PIC  X(0001).
  1107     05  FILLER REDEFINES YR5AF.
  1108         10  YR5AA PIC  X(0001).
  1109     05  YR5AI PIC  X(0002).
  1110*    -------------------------------
  1111     05  M05AL PIC S9(0004) COMP.
  1112     05  M05AF PIC  X(0001).
  1113     05  FILLER REDEFINES M05AF.
  1114         10  M05AA PIC  X(0001).
  1115     05  M05AI PIC  X(0005).
  1116*    -------------------------------
  1117     05  LINE10L PIC S9(0004) COMP.
  1118     05  LINE10F PIC  X(0001).
  1119     05  FILLER REDEFINES LINE10F.
  1120         10  LINE10A PIC  X(0001).
  1121     05  LINE10I PIC  X(0060).
  1122*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6565.cbl
  1123     05  YR6L PIC S9(0004) COMP.
  1124     05  YR6F PIC  X(0001).
  1125     05  FILLER REDEFINES YR6F.
  1126         10  YR6A PIC  X(0001).
  1127     05  YR6I PIC  X(0002).
  1128*    -------------------------------
  1129     05  M06L PIC S9(0004) COMP.
  1130     05  M06F PIC  X(0001).
  1131     05  FILLER REDEFINES M06F.
  1132         10  M06A PIC  X(0001).
  1133     05  M06I PIC  X(0005).
  1134*    -------------------------------
  1135     05  LINE11L PIC S9(0004) COMP.
  1136     05  LINE11F PIC  X(0001).
  1137     05  FILLER REDEFINES LINE11F.
  1138         10  LINE11A PIC  X(0001).
  1139     05  LINE11I PIC  X(0060).
  1140*    -------------------------------
  1141     05  YR6AL PIC S9(0004) COMP.
  1142     05  YR6AF PIC  X(0001).
  1143     05  FILLER REDEFINES YR6AF.
  1144         10  YR6AA PIC  X(0001).
  1145     05  YR6AI PIC  X(0002).
  1146*    -------------------------------
  1147     05  M06AL PIC S9(0004) COMP.
  1148     05  M06AF PIC  X(0001).
  1149     05  FILLER REDEFINES M06AF.
  1150         10  M06AA PIC  X(0001).
  1151     05  M06AI PIC  X(0005).
  1152*    -------------------------------
  1153     05  LINE12L PIC S9(0004) COMP.
  1154     05  LINE12F PIC  X(0001).
  1155     05  FILLER REDEFINES LINE12F.
  1156         10  LINE12A PIC  X(0001).
  1157     05  LINE12I PIC  X(0060).
  1158*    -------------------------------
  1159     05  YR7L PIC S9(0004) COMP.
  1160     05  YR7F PIC  X(0001).
  1161     05  FILLER REDEFINES YR7F.
  1162         10  YR7A PIC  X(0001).
  1163     05  YR7I PIC  X(0002).
  1164*    -------------------------------
  1165     05  M07L PIC S9(0004) COMP.
  1166     05  M07F PIC  X(0001).
  1167     05  FILLER REDEFINES M07F.
  1168         10  M07A PIC  X(0001).
  1169     05  M07I PIC  X(0005).
  1170*    -------------------------------
  1171     05  LINE13L PIC S9(0004) COMP.
  1172     05  LINE13F PIC  X(0001).
  1173     05  FILLER REDEFINES LINE13F.
  1174         10  LINE13A PIC  X(0001).
  1175     05  LINE13I PIC  X(0060).
  1176*    -------------------------------
  1177     05  YR7AL PIC S9(0004) COMP.
  1178     05  YR7AF PIC  X(0001).
  1179     05  FILLER REDEFINES YR7AF.
  1180         10  YR7AA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6565.cbl
  1181     05  YR7AI PIC  X(0002).
  1182*    -------------------------------
  1183     05  M07AL PIC S9(0004) COMP.
  1184     05  M07AF PIC  X(0001).
  1185     05  FILLER REDEFINES M07AF.
  1186         10  M07AA PIC  X(0001).
  1187     05  M07AI PIC  X(0005).
  1188*    -------------------------------
  1189     05  LINE14L PIC S9(0004) COMP.
  1190     05  LINE14F PIC  X(0001).
  1191     05  FILLER REDEFINES LINE14F.
  1192         10  LINE14A PIC  X(0001).
  1193     05  LINE14I PIC  X(0060).
  1194*    -------------------------------
  1195     05  YR8L PIC S9(0004) COMP.
  1196     05  YR8F PIC  X(0001).
  1197     05  FILLER REDEFINES YR8F.
  1198         10  YR8A PIC  X(0001).
  1199     05  YR8I PIC  X(0002).
  1200*    -------------------------------
  1201     05  M08L PIC S9(0004) COMP.
  1202     05  M08F PIC  X(0001).
  1203     05  FILLER REDEFINES M08F.
  1204         10  M08A PIC  X(0001).
  1205     05  M08I PIC  X(0005).
  1206*    -------------------------------
  1207     05  LINE15L PIC S9(0004) COMP.
  1208     05  LINE15F PIC  X(0001).
  1209     05  FILLER REDEFINES LINE15F.
  1210         10  LINE15A PIC  X(0001).
  1211     05  LINE15I PIC  X(0060).
  1212*    -------------------------------
  1213     05  YR8AL PIC S9(0004) COMP.
  1214     05  YR8AF PIC  X(0001).
  1215     05  FILLER REDEFINES YR8AF.
  1216         10  YR8AA PIC  X(0001).
  1217     05  YR8AI PIC  X(0002).
  1218*    -------------------------------
  1219     05  M08AL PIC S9(0004) COMP.
  1220     05  M08AF PIC  X(0001).
  1221     05  FILLER REDEFINES M08AF.
  1222         10  M08AA PIC  X(0001).
  1223     05  M08AI PIC  X(0005).
  1224*    -------------------------------
  1225     05  LINE16L PIC S9(0004) COMP.
  1226     05  LINE16F PIC  X(0001).
  1227     05  FILLER REDEFINES LINE16F.
  1228         10  LINE16A PIC  X(0001).
  1229     05  LINE16I PIC  X(0060).
  1230*    -------------------------------
  1231     05  YR9L PIC S9(0004) COMP.
  1232     05  YR9F PIC  X(0001).
  1233     05  FILLER REDEFINES YR9F.
  1234         10  YR9A PIC  X(0001).
  1235     05  YR9I PIC  X(0002).
  1236*    -------------------------------
  1237     05  M09L PIC S9(0004) COMP.
  1238     05  M09F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6565.cbl
  1239     05  FILLER REDEFINES M09F.
  1240         10  M09A PIC  X(0001).
  1241     05  M09I PIC  X(0005).
  1242*    -------------------------------
  1243     05  LINE17L PIC S9(0004) COMP.
  1244     05  LINE17F PIC  X(0001).
  1245     05  FILLER REDEFINES LINE17F.
  1246         10  LINE17A PIC  X(0001).
  1247     05  LINE17I PIC  X(0060).
  1248*    -------------------------------
  1249     05  YR9AL PIC S9(0004) COMP.
  1250     05  YR9AF PIC  X(0001).
  1251     05  FILLER REDEFINES YR9AF.
  1252         10  YR9AA PIC  X(0001).
  1253     05  YR9AI PIC  X(0002).
  1254*    -------------------------------
  1255     05  M09AL PIC S9(0004) COMP.
  1256     05  M09AF PIC  X(0001).
  1257     05  FILLER REDEFINES M09AF.
  1258         10  M09AA PIC  X(0001).
  1259     05  M09AI PIC  X(0005).
  1260*    -------------------------------
  1261     05  LINE18L PIC S9(0004) COMP.
  1262     05  LINE18F PIC  X(0001).
  1263     05  FILLER REDEFINES LINE18F.
  1264         10  LINE18A PIC  X(0001).
  1265     05  LINE18I PIC  X(0060).
  1266*    -------------------------------
  1267     05  YRAL PIC S9(0004) COMP.
  1268     05  YRAF PIC  X(0001).
  1269     05  FILLER REDEFINES YRAF.
  1270         10  YRAA PIC  X(0001).
  1271     05  YRAI PIC  X(0002).
  1272*    -------------------------------
  1273     05  M0AL PIC S9(0004) COMP.
  1274     05  M0AF PIC  X(0001).
  1275     05  FILLER REDEFINES M0AF.
  1276         10  M0AA PIC  X(0001).
  1277     05  M0AI PIC  X(0005).
  1278*    -------------------------------
  1279     05  LINE19L PIC S9(0004) COMP.
  1280     05  LINE19F PIC  X(0001).
  1281     05  FILLER REDEFINES LINE19F.
  1282         10  LINE19A PIC  X(0001).
  1283     05  LINE19I PIC  X(0060).
  1284*    -------------------------------
  1285     05  YRAAL PIC S9(0004) COMP.
  1286     05  YRAAF PIC  X(0001).
  1287     05  FILLER REDEFINES YRAAF.
  1288         10  YRAAA PIC  X(0001).
  1289     05  YRAAI PIC  X(0002).
  1290*    -------------------------------
  1291     05  M0AAL PIC S9(0004) COMP.
  1292     05  M0AAF PIC  X(0001).
  1293     05  FILLER REDEFINES M0AAF.
  1294         10  M0AAA PIC  X(0001).
  1295     05  M0AAI PIC  X(0005).
  1296*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6565.cbl
  1297     05  LINE20L PIC S9(0004) COMP.
  1298     05  LINE20F PIC  X(0001).
  1299     05  FILLER REDEFINES LINE20F.
  1300         10  LINE20A PIC  X(0001).
  1301     05  LINE20I PIC  X(0060).
  1302*    -------------------------------
  1303     05  ERRMSG1L PIC S9(0004) COMP.
  1304     05  ERRMSG1F PIC  X(0001).
  1305     05  FILLER REDEFINES ERRMSG1F.
  1306         10  ERRMSG1A PIC  X(0001).
  1307     05  ERRMSG1I PIC  X(0072).
  1308*    -------------------------------
  1309     05  PFENTERL PIC S9(0004) COMP.
  1310     05  PFENTERF PIC  X(0001).
  1311     05  FILLER REDEFINES PFENTERF.
  1312         10  PFENTERA PIC  X(0001).
  1313     05  PFENTERI PIC  99.
  1314*    -------------------------------
  1315     05  PF3DEVL PIC S9(0004) COMP.
  1316     05  PF3DEVF PIC  X(0001).
  1317     05  FILLER REDEFINES PF3DEVF.
  1318         10  PF3DEVA PIC  X(0001).
  1319     05  PF3DEVI PIC  X(0020).
  1320 01  EL6565AO REDEFINES EL6565AI.
  1321     05  FILLER            PIC  X(0012).
  1322*    -------------------------------
  1323     05  FILLER            PIC  X(0003).
  1324     05  RUNDATEO PIC  X(0008).
  1325*    -------------------------------
  1326     05  FILLER            PIC  X(0003).
  1327     05  RUNTIMEO PIC  99.99.
  1328*    -------------------------------
  1329     05  FILLER            PIC  X(0003).
  1330     05  STATEO PIC  X(0002).
  1331*    -------------------------------
  1332     05  FILLER            PIC  X(0003).
  1333     05  CLASSO PIC  X(0002).
  1334*    -------------------------------
  1335     05  FILLER            PIC  X(0003).
  1336     05  DEVO PIC  X(0003).
  1337*    -------------------------------
  1338     05  FILLER            PIC  X(0003).
  1339     05  PCTO PIC  Z.999999.
  1340*    -------------------------------
  1341     05  FILLER            PIC  X(0003).
  1342     05  TYPEO PIC  X(0001).
  1343*    -------------------------------
  1344     05  FILLER            PIC  X(0003).
  1345     05  PLANO PIC  X(0002).
  1346*    -------------------------------
  1347     05  FILLER            PIC  X(0003).
  1348     05  YR1O PIC  X(0002).
  1349*    -------------------------------
  1350     05  FILLER            PIC  X(0003).
  1351     05  M01O PIC  X(0005).
  1352*    -------------------------------
  1353     05  FILLER            PIC  X(0003).
  1354     05  LINE1O PIC  X(0060).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6565.cbl
  1355*    -------------------------------
  1356     05  FILLER            PIC  X(0003).
  1357     05  YR1AO PIC  99.
  1358*    -------------------------------
  1359     05  FILLER            PIC  X(0003).
  1360     05  M01AO PIC  X(0005).
  1361*    -------------------------------
  1362     05  FILLER            PIC  X(0003).
  1363     05  LINE2O PIC  X(0060).
  1364*    -------------------------------
  1365     05  FILLER            PIC  X(0003).
  1366     05  YR2O PIC  X(0002).
  1367*    -------------------------------
  1368     05  FILLER            PIC  X(0003).
  1369     05  M02O PIC  X(0005).
  1370*    -------------------------------
  1371     05  FILLER            PIC  X(0003).
  1372     05  LINE3O PIC  X(0060).
  1373*    -------------------------------
  1374     05  FILLER            PIC  X(0003).
  1375     05  YR2AO PIC  99.
  1376*    -------------------------------
  1377     05  FILLER            PIC  X(0003).
  1378     05  M02AO PIC  X(0005).
  1379*    -------------------------------
  1380     05  FILLER            PIC  X(0003).
  1381     05  LINE4O PIC  X(0060).
  1382*    -------------------------------
  1383     05  FILLER            PIC  X(0003).
  1384     05  YR3O PIC  X(0002).
  1385*    -------------------------------
  1386     05  FILLER            PIC  X(0003).
  1387     05  M03O PIC  X(0005).
  1388*    -------------------------------
  1389     05  FILLER            PIC  X(0003).
  1390     05  LINE5O PIC  X(0060).
  1391*    -------------------------------
  1392     05  FILLER            PIC  X(0003).
  1393     05  YR3AO PIC  99.
  1394*    -------------------------------
  1395     05  FILLER            PIC  X(0003).
  1396     05  M03AO PIC  X(0005).
  1397*    -------------------------------
  1398     05  FILLER            PIC  X(0003).
  1399     05  LINE6O PIC  X(0060).
  1400*    -------------------------------
  1401     05  FILLER            PIC  X(0003).
  1402     05  YR4O PIC  X(0002).
  1403*    -------------------------------
  1404     05  FILLER            PIC  X(0003).
  1405     05  M04O PIC  X(0005).
  1406*    -------------------------------
  1407     05  FILLER            PIC  X(0003).
  1408     05  LINE7O PIC  X(0060).
  1409*    -------------------------------
  1410     05  FILLER            PIC  X(0003).
  1411     05  YR4AO PIC  99.
  1412*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6565.cbl
  1413     05  FILLER            PIC  X(0003).
  1414     05  M04AO PIC  X(0005).
  1415*    -------------------------------
  1416     05  FILLER            PIC  X(0003).
  1417     05  LINE8O PIC  X(0060).
  1418*    -------------------------------
  1419     05  FILLER            PIC  X(0003).
  1420     05  YR5O PIC  X(0002).
  1421*    -------------------------------
  1422     05  FILLER            PIC  X(0003).
  1423     05  M05O PIC  X(0005).
  1424*    -------------------------------
  1425     05  FILLER            PIC  X(0003).
  1426     05  LINE9O PIC  X(0060).
  1427*    -------------------------------
  1428     05  FILLER            PIC  X(0003).
  1429     05  YR5AO PIC  99.
  1430*    -------------------------------
  1431     05  FILLER            PIC  X(0003).
  1432     05  M05AO PIC  X(0005).
  1433*    -------------------------------
  1434     05  FILLER            PIC  X(0003).
  1435     05  LINE10O PIC  X(0060).
  1436*    -------------------------------
  1437     05  FILLER            PIC  X(0003).
  1438     05  YR6O PIC  X(0002).
  1439*    -------------------------------
  1440     05  FILLER            PIC  X(0003).
  1441     05  M06O PIC  X(0005).
  1442*    -------------------------------
  1443     05  FILLER            PIC  X(0003).
  1444     05  LINE11O PIC  X(0060).
  1445*    -------------------------------
  1446     05  FILLER            PIC  X(0003).
  1447     05  YR6AO PIC  99.
  1448*    -------------------------------
  1449     05  FILLER            PIC  X(0003).
  1450     05  M06AO PIC  X(0005).
  1451*    -------------------------------
  1452     05  FILLER            PIC  X(0003).
  1453     05  LINE12O PIC  X(0060).
  1454*    -------------------------------
  1455     05  FILLER            PIC  X(0003).
  1456     05  YR7O PIC  X(0002).
  1457*    -------------------------------
  1458     05  FILLER            PIC  X(0003).
  1459     05  M07O PIC  X(0005).
  1460*    -------------------------------
  1461     05  FILLER            PIC  X(0003).
  1462     05  LINE13O PIC  X(0060).
  1463*    -------------------------------
  1464     05  FILLER            PIC  X(0003).
  1465     05  YR7AO PIC  99.
  1466*    -------------------------------
  1467     05  FILLER            PIC  X(0003).
  1468     05  M07AO PIC  X(0005).
  1469*    -------------------------------
  1470     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6565.cbl
  1471     05  LINE14O PIC  X(0060).
  1472*    -------------------------------
  1473     05  FILLER            PIC  X(0003).
  1474     05  YR8O PIC  X(0002).
  1475*    -------------------------------
  1476     05  FILLER            PIC  X(0003).
  1477     05  M08O PIC  X(0005).
  1478*    -------------------------------
  1479     05  FILLER            PIC  X(0003).
  1480     05  LINE15O PIC  X(0060).
  1481*    -------------------------------
  1482     05  FILLER            PIC  X(0003).
  1483     05  YR8AO PIC  99.
  1484*    -------------------------------
  1485     05  FILLER            PIC  X(0003).
  1486     05  M08AO PIC  X(0005).
  1487*    -------------------------------
  1488     05  FILLER            PIC  X(0003).
  1489     05  LINE16O PIC  X(0060).
  1490*    -------------------------------
  1491     05  FILLER            PIC  X(0003).
  1492     05  YR9O PIC  X(0002).
  1493*    -------------------------------
  1494     05  FILLER            PIC  X(0003).
  1495     05  M09O PIC  X(0005).
  1496*    -------------------------------
  1497     05  FILLER            PIC  X(0003).
  1498     05  LINE17O PIC  X(0060).
  1499*    -------------------------------
  1500     05  FILLER            PIC  X(0003).
  1501     05  YR9AO PIC  99.
  1502*    -------------------------------
  1503     05  FILLER            PIC  X(0003).
  1504     05  M09AO PIC  X(0005).
  1505*    -------------------------------
  1506     05  FILLER            PIC  X(0003).
  1507     05  LINE18O PIC  X(0060).
  1508*    -------------------------------
  1509     05  FILLER            PIC  X(0003).
  1510     05  YRAO PIC  X(0002).
  1511*    -------------------------------
  1512     05  FILLER            PIC  X(0003).
  1513     05  M0AO PIC  X(0005).
  1514*    -------------------------------
  1515     05  FILLER            PIC  X(0003).
  1516     05  LINE19O PIC  X(0060).
  1517*    -------------------------------
  1518     05  FILLER            PIC  X(0003).
  1519     05  YRAAO PIC  99.
  1520*    -------------------------------
  1521     05  FILLER            PIC  X(0003).
  1522     05  M0AAO PIC  X(0005).
  1523*    -------------------------------
  1524     05  FILLER            PIC  X(0003).
  1525     05  LINE20O PIC  X(0060).
  1526*    -------------------------------
  1527     05  FILLER            PIC  X(0003).
  1528     05  ERRMSG1O PIC  X(0072).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6565.cbl
  1529*    -------------------------------
  1530     05  FILLER            PIC  X(0003).
  1531     05  PFENTERO PIC  99.
  1532*    -------------------------------
  1533     05  FILLER            PIC  X(0003).
  1534     05  PF3DEVO PIC  X(0020).
  1535*    -------------------------------
  1536
  1537 01  FILLER REDEFINES EL6565AI.
  1538     05  FILLER             PIC X(66).
  1539     05  SCREEN-TABLE       OCCURS 20 TIMES
  1540                            INDEXED BY ST-INDX.
  1541         10  FILLER         PIC XXX.
  1542         10  YEAR           PIC 99.
  1543         10  YEAR-1 REDEFINES YEAR
  1544                            PIC XX.
  1545         10  FILLER         PIC XXX.
  1546         10  MONTH          PIC X(5).
  1547         10  FILLER         PIC XXX.
  1548         10  RATE-TABLE     OCCURS 6 TIMES
  1549                            INDEXED BY RT-INDX.
  1550             15  RATE1      PIC Z(4).99999.
  1551             15  RATE2 REDEFINES RATE1
  1552                            PIC X(10).
  1553
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6565.cbl
  1555
  1556****************************************************************
  1557*
  1558* Copyright (c) 2007 by Clerity Solutions, Inc.
  1559* All rights reserved.
  1560*
  1561****************************************************************
  1562 01  DFHEIV.
  1563   02  DFHEIV0               PIC X(35).
  1564   02  DFHEIV1               PIC X(08).
  1565   02  DFHEIV2               PIC X(08).
  1566   02  DFHEIV3               PIC X(08).
  1567   02  DFHEIV4               PIC X(06).
  1568   02  DFHEIV5               PIC X(04).
  1569   02  DFHEIV6               PIC X(04).
  1570   02  DFHEIV7               PIC X(02).
  1571   02  DFHEIV8               PIC X(02).
  1572   02  DFHEIV9               PIC X(01).
  1573   02  DFHEIV10              PIC S9(7) COMP-3.
  1574   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1575   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1576   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1577   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1578   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1579   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1580   02  DFHEIV17              PIC X(04).
  1581   02  DFHEIV18              PIC X(04).
  1582   02  DFHEIV19              PIC X(04).
  1583   02  DFHEIV20              USAGE IS POINTER.
  1584   02  DFHEIV21              USAGE IS POINTER.
  1585   02  DFHEIV22              USAGE IS POINTER.
  1586   02  DFHEIV23              USAGE IS POINTER.
  1587   02  DFHEIV24              USAGE IS POINTER.
  1588   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1589   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1590   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1591   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1592   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1593   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1594   02  FILLER                PIC X(02).
  1595   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1596   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1597   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1598   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1599   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1600 LINKAGE  SECTION.
  1601*****************************************************************
  1602*                                                               *
  1603* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1604* All rights reserved.                                          *
  1605*                                                               *
  1606*****************************************************************
  1607 01  dfheiblk.
  1608     02  eibtime          pic s9(7) comp-3.
  1609     02  eibdate          pic s9(7) comp-3.
  1610     02  eibtrnid         pic x(4).
  1611     02  eibtaskn         pic s9(7) comp-3.
  1612     02  eibtrmid         pic x(4).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6565.cbl
  1613     02  dfheigdi         pic s9(4) comp.
  1614     02  eibcposn         pic s9(4) comp.
  1615     02  eibcalen         pic s9(4) comp.
  1616     02  eibaid           pic x(1).
  1617     02  eibfiller1       pic x(1).
  1618     02  eibfn            pic x(2).
  1619     02  eibfiller2       pic x(2).
  1620     02  eibrcode         pic x(6).
  1621     02  eibfiller3       pic x(2).
  1622     02  eibds            pic x(8).
  1623     02  eibreqid         pic x(8).
  1624     02  eibrsrce         pic x(8).
  1625     02  eibsync          pic x(1).
  1626     02  eibfree          pic x(1).
  1627     02  eibrecv          pic x(1).
  1628     02  eibsend          pic x(1).
  1629     02  eibatt           pic x(1).
  1630     02  eibeoc           pic x(1).
  1631     02  eibfmh           pic x(1).
  1632     02  eibcompl         pic x(1).
  1633     02  eibsig           pic x(1).
  1634     02  eibconf          pic x(1).
  1635     02  eiberr           pic x(1).
  1636     02  eibrldbk         pic x(1).
  1637     02  eiberrcd         pic x(4).
  1638     02  eibsynrb         pic x(1).
  1639     02  eibnodat         pic x(1).
  1640     02  eibfiller5       pic x(2).
  1641     02  eibresp          pic 9(09) comp.
  1642     02  eibresp2         pic 9(09) comp.
  1643     02  dfheigdj         pic s9(4) comp.
  1644     02  dfheigdk         pic s9(4) comp.
  1645
  1646 01  DFHCOMMAREA             PIC X(1520).
  1647
  1648*01 PARMLIST        COMP.
  1649*    02  FILLER              PIC S9(8).
  1650*    02  ERACCT-POINTER      PIC S9(8).
  1651*    02  ERPLAN-POINTER      PIC S9(8).
  1652*    02  ERRATE-POINTER      PIC S9(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6565.cbl
  1654*                            COPY ERCACCT.
  1655******************************************************************
  1656*                                                                *
  1657*                                                                *
  1658*                            ERCACCT                             *
  1659*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1660*                            VMOD=2.031                          *
  1661*                                                                *
  1662*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  1663*                                                                *
  1664*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1665*   VSAM ACCOUNT MASTER FILES.                                   *
  1666*                                                                *
  1667*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  1668*                                                                *
  1669*   FILE TYPE = VSAM,KSDS                                        *
  1670*   RECORD SIZE = 2000  RECFORM = FIX                            *
  1671*                                                                *
  1672*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  1673*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  1674*                                                                *
  1675*   LOG = NO                                                     *
  1676*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1677*                                                                *
  1678*                                                                *
  1679******************************************************************
  1680*                   C H A N G E   L O G
  1681*
  1682* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1683*-----------------------------------------------------------------
  1684*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1685* EFFECTIVE    NUMBER
  1686*-----------------------------------------------------------------
  1687* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  1688* 092705    2005050300006  PEMA  ADD SPP LEASES
  1689* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  1690* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  1691******************************************************************
  1692
  1693 01  ACCOUNT-MASTER.
  1694     12  AM-RECORD-ID                      PIC XX.
  1695         88  VALID-AM-ID                      VALUE 'AM'.
  1696
  1697     12  AM-CONTROL-PRIMARY.
  1698         16  AM-COMPANY-CD                 PIC X.
  1699         16  AM-MSTR-CNTRL.
  1700             20  AM-CONTROL-A.
  1701                 24  AM-CARRIER            PIC X.
  1702                 24  AM-GROUPING.
  1703                     28 AM-GROUPING-PREFIX PIC XXX.
  1704                     28 AM-GROUPING-PRIME  PIC XXX.
  1705                 24  AM-STATE              PIC XX.
  1706                 24  AM-ACCOUNT.
  1707                     28  AM-ACCOUNT-PREFIX PIC X(4).
  1708                     28  AM-ACCOUNT-PRIME  PIC X(6).
  1709             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  1710                                           PIC X(19).
  1711             20  AM-CNTRL-B.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6565.cbl
  1712                 24  AM-EXPIRATION-DT      PIC XX.
  1713                 24  FILLER                PIC X(4).
  1714             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  1715                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  1716
  1717     12  AM-CONTROL-BY-VAR-GRP.
  1718         16  AM-COMPANY-CD-A1              PIC X.
  1719         16  AM-VG-CARRIER                 PIC X.
  1720         16  AM-VG-GROUPING                PIC X(6).
  1721         16  AM-VG-STATE                   PIC XX.
  1722         16  AM-VG-ACCOUNT                 PIC X(10).
  1723         16  AM-VG-DATE.
  1724             20  AM-VG-EXPIRATION-DT       PIC XX.
  1725             20  FILLER                    PIC X(4).
  1726         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  1727                                           PIC 9(11)      COMP-3.
  1728     12  AM-MAINT-INFORMATION.
  1729         16  AM-LAST-MAINT-DT              PIC XX.
  1730         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1731         16  AM-LAST-MAINT-USER            PIC X(4).
  1732         16  FILLER                        PIC XX.
  1733
  1734     12  AM-EFFECTIVE-DT                   PIC XX.
  1735     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  1736
  1737     12  AM-PREV-DATES  COMP-3.
  1738         16  AM-PREV-EXP-DT                PIC 9(11).
  1739         16  AM-PREV-EFF-DT                PIC 9(11).
  1740
  1741     12  AM-REPORT-CODE-1                  PIC X(10).
  1742     12  AM-REPORT-CODE-2                  PIC X(10).
  1743
  1744     12  AM-CITY-CODE                      PIC X(4).
  1745     12  AM-COUNTY-PARISH                  PIC X(6).
  1746
  1747     12  AM-NAME                           PIC X(30).
  1748     12  AM-PERSON                         PIC X(30).
  1749     12  AM-ADDRS                          PIC X(30).
  1750     12  AM-CITY.
  1751         16  AM-ADDR-CITY                  PIC X(28).
  1752         16  AM-ADDR-STATE                 PIC XX.
  1753     12  AM-ZIP.
  1754         16  AM-ZIP-PRIME.
  1755             20  AM-ZIP-PRI-1ST            PIC X.
  1756                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  1757             20  FILLER                    PIC X(4).
  1758         16  AM-ZIP-PLUS4                  PIC X(4).
  1759     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  1760         16  AM-CAN-POSTAL-1               PIC XXX.
  1761         16  AM-CAN-POSTAL-2               PIC XXX.
  1762         16  FILLER                        PIC XXX.
  1763     12  AM-TEL-NO.
  1764         16  AM-AREA-CODE                  PIC 999.
  1765         16  AM-TEL-PRE                    PIC 999.
  1766         16  AM-TEL-NBR                    PIC 9(4).
  1767     12  AM-TEL-LOC                        PIC X.
  1768         88  AM-TEL-AT-HOME                   VALUE 'H'.
  1769         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6565.cbl
  1770
  1771     12  AM-COMM-STRUCTURE.
  1772         16  AM-DEFN-1.
  1773             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  1774                 24  AM-AGT.
  1775                     28  AM-AGT-PREFIX     PIC X(4).
  1776                     28  AM-AGT-PRIME      PIC X(6).
  1777                 24  AM-COM-TYP            PIC X.
  1778                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  1779                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  1780                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  1781                 24  AM-RECALC-LV-INDIC    PIC X.
  1782                 24  AM-RETRO-LV-INDIC     PIC X.
  1783                 24  AM-GL-CODES           PIC X.
  1784                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  1785                 24  FILLER                PIC X(01).
  1786         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  1787             20  AM-COM-TBLS        OCCURS 10 TIMES.
  1788                 24  FILLER                PIC X(11).
  1789                 24  AM-L-COMA             PIC XXX.
  1790                 24  AM-J-COMA             PIC XXX.
  1791                 24  AM-A-COMA             PIC XXX.
  1792                 24  FILLER                PIC X(6).
  1793
  1794     12  AM-COMM-CHANGE-STATUS             PIC X.
  1795         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  1796
  1797     12  AM-CSR-CODE                       PIC X(4).
  1798
  1799     12  AM-BILLING-STATUS                 PIC X.
  1800         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  1801         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  1802     12  AM-AUTO-REFUND-SW                 PIC X.
  1803         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  1804         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  1805     12  AM-GPCD                           PIC 99.
  1806     12  AM-IG                             PIC X.
  1807         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  1808         88  AM-HAS-GROUP                     VALUE '2'.
  1809     12  AM-STATUS                         PIC X.
  1810         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  1811         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  1812         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  1813         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  1814         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  1815     12  AM-REMIT-TO                       PIC 99.
  1816     12  AM-ID-NO                          PIC X(11).
  1817
  1818     12  AM-CAL-TABLE                      PIC XX.
  1819     12  AM-LF-DEVIATION                   PIC XXX.
  1820     12  AM-AH-DEVIATION                   PIC XXX.
  1821     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1822     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  1823     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
  1824     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  1825     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1826     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  1827
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6565.cbl
  1828     12  AM-USER-FIELDS.
  1829         16  AM-FLD-1                      PIC XX.
  1830         16  AM-FLD-2                      PIC XX.
  1831         16  AM-FLD-3                      PIC XX.
  1832         16  AM-FLD-4                      PIC XX.
  1833         16  AM-FLD-5                      PIC XX.
  1834
  1835     12  AM-1ST-PROD-DATE.
  1836         16  AM-1ST-PROD-YR                PIC XX.
  1837         16  AM-1ST-PROD-MO                PIC XX.
  1838         16  AM-1ST-PROD-DA                PIC XX.
  1839     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  1840     12  AM-CERTS-PURGED-DATE.
  1841         16  AM-PUR-YR                     PIC XX.
  1842         16  AM-PUR-MO                     PIC XX.
  1843         16  AM-PUR-DA                     PIC XX.
  1844     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  1845     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  1846     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  1847     12  AM-INACTIVE-DATE.
  1848         16  AM-INA-MO                     PIC 99.
  1849         16  AM-INA-DA                     PIC 99.
  1850         16  AM-INA-YR                     PIC 99.
  1851     12  AM-AR-HI-CERT-DATE                PIC XX.
  1852
  1853     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1854     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  1855
  1856     12  AM-OB-PAYMENT-MODE                PIC X.
  1857         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  1858         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  1859         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  1860         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  1861
  1862     12  AM-AH-ONLY-INDICATOR              PIC X.
  1863         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  1864         88  AM-NO-AH-ONLY                    VALUE 'N'.
  1865
  1866     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  1867
  1868     12  AM-OVER-SHORT.
  1869         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  1870         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  1871
  1872     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  1873     12  AM-DCC-CLP-STATE                  PIC XX.
  1874
  1875     12  AM-RECALC-COMM                    PIC X.
  1876     12  AM-RECALC-REIN                    PIC X.
  1877
  1878     12  AM-REI-TABLE                      PIC XXX.
  1879     12  AM-REI-ET-LF                      PIC X.
  1880     12  AM-REI-ET-AH                      PIC X.
  1881     12  AM-REI-PE-LF                      PIC X.
  1882     12  AM-REI-PE-AH                      PIC X.
  1883     12  AM-REI-PRT-ST                     PIC X.
  1884     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  1885     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6565.cbl
  1886     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  1887     12  AM-REI-GROUP-A                    PIC X(6).
  1888     12  AM-REI-MORT                       PIC X(4).
  1889     12  AM-REI-PRT-OW                     PIC X.
  1890     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  1891     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  1892     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  1893     12  AM-REI-GROUP-B                    PIC X(6).
  1894
  1895     12  AM-TRUST-TYPE                     PIC X(2).
  1896
  1897     12  AM-EMPLOYER-STMT-USED             PIC X.
  1898     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  1899
  1900     12  AM-STD-AH-TYPE                    PIC XX.
  1901     12  AM-EARN-METHODS.
  1902         16  AM-EARN-METHOD-R              PIC X.
  1903             88 AM-REF-RL-R78                 VALUE 'R'.
  1904             88 AM-REF-RL-PR                  VALUE 'P'.
  1905             88 AM-REF-RL-MEAN                VALUE 'M'.
  1906             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  1907         16  AM-EARN-METHOD-L              PIC X.
  1908             88 AM-REF-LL-R78                 VALUE 'R'.
  1909             88 AM-REF-LL-PR                  VALUE 'P'.
  1910             88 AM-REF-LL-MEAN                VALUE 'M'.
  1911             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  1912         16  AM-EARN-METHOD-A              PIC X.
  1913             88 AM-REF-AH-R78                 VALUE 'R'.
  1914             88 AM-REF-AH-PR                  VALUE 'P'.
  1915             88 AM-REF-AH-MEAN                VALUE 'M'.
  1916             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  1917             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  1918             88 AM-REF-AH-NET                 VALUE 'N'.
  1919
  1920     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  1921     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  1922     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  1923
  1924     12  AM-RET-Y-N                        PIC X.
  1925     12  AM-RET-P-E                        PIC X.
  1926     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  1927     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  1928     12  AM-RET-GRP                        PIC X(6).
  1929     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  1930         16  AM-POOL-PRIME                 PIC XXX.
  1931         16  AM-POOL-SUB                   PIC XXX.
  1932     12  AM-RETRO-EARNINGS.
  1933         16  AM-RET-EARN-R                 PIC X.
  1934         16  AM-RET-EARN-L                 PIC X.
  1935         16  AM-RET-EARN-A                 PIC X.
  1936     12  AM-RET-ST-TAX-USE                 PIC X.
  1937         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  1938         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  1939     12  AM-RETRO-BEG-EARNINGS.
  1940         16  AM-RET-BEG-EARN-R             PIC X.
  1941         16  AM-RET-BEG-EARN-L             PIC X.
  1942         16  AM-RET-BEG-EARN-A             PIC X.
  1943     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6565.cbl
  1944     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  1945
  1946     12  AM-USER-SELECT-OPTIONS.
  1947         16  AM-USER-SELECT-1              PIC X(10).
  1948         16  AM-USER-SELECT-2              PIC X(10).
  1949         16  AM-USER-SELECT-3              PIC X(10).
  1950         16  AM-USER-SELECT-4              PIC X(10).
  1951         16  AM-USER-SELECT-5              PIC X(10).
  1952
  1953     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1954
  1955     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  1956
  1957     12  AM-RPT045A-SWITCH                 PIC X.
  1958         88  RPT045A-OFF                   VALUE 'N'.
  1959
  1960     12  AM-INSURANCE-LIMITS.
  1961         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  1962         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  1963
  1964     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  1965         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  1966
  1967     12  AM-DISMBR-COVERAGE-SW             PIC X.
  1968         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  1969         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  1970
  1971     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  1972
  1973     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  1974     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  1975     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  1976     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  1977     12  FILLER                            PIC X(5).
  1978     12  AM-REPORT-CODE-3                  PIC X(10).
  1979*    12  FILLER                            PIC X(22).
  1980
  1981     12  AM-RESERVE-DATE.
  1982         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  1983         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  1984         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  1985
  1986     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  1987     12  AM-NOTIFICATION-TYPES.
  1988         16  AM-NOTIF-OF-LETTERS           PIC X.
  1989         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  1990         16  AM-NOTIF-OF-REPORTS           PIC X.
  1991         16  AM-NOTIF-OF-STATUS            PIC X.
  1992
  1993     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  1994         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  1995         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  1996         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
  1997         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  1998
  1999     12  AM-BENEFIT-CONTROLS.
  2000         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2001             20  AM-BENEFIT-CODE           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6565.cbl
  2002             20  AM-BENEFIT-TYPE           PIC X.
  2003             20  AM-BENEFIT-REVISION       PIC XXX.
  2004             20  AM-BENEFIT-REM-TERM       PIC X.
  2005             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2006             20  FILLER                    PIC XX.
  2007         16  FILLER                        PIC X(80).
  2008
  2009     12  AM-TRANSFER-DATA.
  2010         16  AM-TRANSFERRED-FROM.
  2011             20  AM-TRNFROM-CARRIER        PIC X.
  2012             20  AM-TRNFROM-GROUPING.
  2013                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2014                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2015             20  AM-TRNFROM-STATE          PIC XX.
  2016             20  AM-TRNFROM-ACCOUNT.
  2017                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2018                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2019             20  AM-TRNFROM-DTE            PIC XX.
  2020         16  AM-TRANSFERRED-TO.
  2021             20  AM-TRNTO-CARRIER          PIC X.
  2022             20  AM-TRNTO-GROUPING.
  2023                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2024                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2025             20  AM-TRNTO-STATE            PIC XX.
  2026             20  AM-TRNTO-ACCOUNT.
  2027                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2028                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2029             20  AM-TRNTO-DTE              PIC XX.
  2030         16  FILLER                        PIC X(10).
  2031
  2032     12  AM-SAVED-REMIT-TO                 PIC 99.
  2033
  2034     12  AM-COMM-STRUCTURE-SAVED.
  2035         16  AM-DEFN-1-SAVED.
  2036             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2037                 24  AM-AGT-SV             PIC X(10).
  2038                 24  AM-COM-TYP-SV         PIC X.
  2039                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2040                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2041                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2042                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2043                 24  FILLER                PIC X.
  2044                 24  AM-GL-CODES-SV        PIC X.
  2045                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2046                 24  FILLER                PIC X.
  2047         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2048             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2049                 24  FILLER                PIC X(11).
  2050                 24  AM-L-COMA-SV          PIC XXX.
  2051                 24  AM-J-COMA-SV          PIC XXX.
  2052                 24  AM-A-COMA-SV          PIC XXX.
  2053                 24  FILLER                PIC X(6).
  2054
  2055     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2056         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2057            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2058            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2059            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6565.cbl
  2060
  2061     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2062     12  FILLER                            PIC X(120).
  2063
  2064     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2065         16  AM-CONTROL-NAME               PIC X(30).
  2066         16  AM-EXECUTIVE-ONE.
  2067             20  AM-EXEC1-NAME             PIC X(15).
  2068             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2069                                                          COMP-3.
  2070             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2071                                                          COMP-3.
  2072         16  AM-EXECUTIVE-TWO.
  2073             20  AM-EXEC2-NAME             PIC X(15).
  2074             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2075                                                          COMP-3.
  2076             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2077                                                          COMP-3.
  2078
  2079     12  AM-RETRO-ADDITIONAL-DATA.
  2080         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2081         16  AM-RETRO-PREM-P-E             PIC X.
  2082         16  AM-RETRO-CLMS-P-I             PIC X.
  2083         16  AM-RETRO-RET-BRACKET-LF.
  2084             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2085                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2086                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2087             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2088                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2089                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2090             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2091                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2092                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2093         16  AM-RETRO-RET-BRACKET-AH.
  2094             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2095                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2096                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2097                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2098             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2099                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2100                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2101             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2102                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2103                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2104
  2105     12  AM-COMMENTS.
  2106         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2107
  2108     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2109         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2110         16  AM-FLI-BILLING-CODE           PIC X.
  2111         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2112         16  AM-FLI-UNITED-IDENT           PIC X.
  2113         16  AM-FLI-INTEREST-LOST-DATA.
  2114             20  AM-FLI-BANK-NO            PIC X(5).
  2115             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2116             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2117             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6565.cbl
  2118         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2119             20  AM-FLI-AGT                PIC X(9).
  2120             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2121             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2122         16  FILLER                        PIC X(102).
  2123
  2124     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2125         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2126             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2127             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2128             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2129             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2130             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2131         16  FILLER                          PIC X(10).
  2132******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6565.cbl
  2134*                            COPY ERCPLAN.
  2135******************************************************************
  2136*                                                                *
  2137*                                                                *
  2138*                            ERCPLAN                             *
  2139*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2140*                            VMOD=2.003                          *
  2141*                                                                *
  2142*   CREDIT SYSTEM ACCOUNT PLAN MASTER FILE                       *
  2143*                                                                *
  2144*   THIS COPYBOOK IS USED FOR THE ONLINE VSAM ACCOUNT            *
  2145*   PLAN MASTER                                                  *
  2146*                                                                *
  2147*   FILE DESCRIPTION = ACCOUNT OR PRODUCER PLAN MASTER           *
  2148*                                                                *
  2149*   FILE TYPE = VSAM,KSDS                                        *
  2150*   RECORD SIZE = 420   RECFORM = FIX                            *
  2151*                                                                *
  2152*   BASE CLUSTER NAME = ERPLAN                    RKP=2,LEN=26   *
  2153*       ALTERNATE PATH1 = N/A                                    *
  2154*                                                                *
  2155*   LOG = NO                                                     *
  2156*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2157*                                                                *
  2158*                                                                *
  2159******************************************************************
  2160
  2161 01  PLAN-MASTER.
  2162     12  PL-RECORD-ID                      PIC XX.
  2163         88  VALID-PL-ID                      VALUE 'PL'.
  2164
  2165     12  PL-CONTROL-PRIMARY.
  2166         16  PL-COMPANY-CD                 PIC X.
  2167         16  PL-MSTR-CNTRL.
  2168             20  PL-CONTROL-A.
  2169                 24  PL-CARRIER            PIC X.
  2170                 24  PL-GROUPING           PIC X(6).
  2171                 24  PL-STATE              PIC XX.
  2172                 24  PL-ACCOUNT            PIC X(10).
  2173             20  PL-BENEFIT-TYPE           PIC X.
  2174             20  PL-BENEFIT-CODE           PIC XX.
  2175             20  PL-REVISION-NO            PIC X(3).
  2176
  2177     12  PL-CONTROL-BY-VAR-GRP.
  2178         16  PL-COMPANY-CD-A1              PIC X.
  2179         16  PL-VG-CARRIER                 PIC X.
  2180         16  PL-VG-GROUPING                PIC X(6).
  2181         16  PL-VG-STATE                   PIC XX.
  2182         16  PL-VG-ACCOUNT                 PIC X(10).
  2183         16  PL-BENEFIT-TYPE-A1            PIC X.
  2184         16  PL-BENEFIT-CODE-A1            PIC XX.
  2185         16  PL-REVISION-NO-A1             PIC 999.
  2186
  2187     12  PL-MAINT-INFORMATION.
  2188         16  PL-LAST-MAINT-DT              PIC XX.
  2189         16  PL-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2190         16  PL-LAST-MAINT-USER            PIC X(4).
  2191         16  FILLER                        PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6565.cbl
  2192
  2193     12  PL-LIABILITY-LIMITS.
  2194         16  PL-ATT-AGE                    PIC S99        COMP-3.
  2195         16  PL-L-LIMITS        OCCURS 8 TIMES.
  2196             20  PL-LM-AGE                 PIC S99        COMP-3.
  2197             20  PL-LM-DUR                 PIC S999       COMP-3.
  2198             20  PL-LM-MOA                 PIC S9(4)      COMP-3.
  2199             20  PL-LM-AMT                 PIC S9(6)      COMP-3.
  2200
  2201     12  FILLER                            PIC X(30).
  2202
  2203     12  PL-GL-ACCOUNT-NOS.
  2204         16  PL-PREMIUM-GL                 PIC X(8).
  2205         16  PL-COMM-GL                    PIC X(8).
  2206         16  PL-CLAIM-GL                   PIC X(8).
  2207     12  FILLER                            PIC X(24).
  2208     12  PL-TOLERANCES.
  2209         16  PL-TOL-PREM-AMT               PIC S999V99    COMP-3.
  2210         16  PL-TOL-REF-AMT                PIC S999V99    COMP-3.
  2211         16  PL-TOL-CLM-AMT                PIC S999V99    COMP-3.
  2212         16  PL-TOL-PREM-PCT               PIC S9V9999    COMP-3.
  2213         16  PL-TOL-REF-PCT                PIC S9V9999    COMP-3.
  2214         16  PL-TOL-CLM-PCT                PIC S9V9999    COMP-3.
  2215     12  PL-OVER-SHORT.
  2216         16  PL-OVER-SHORT-AMT             PIC S999V99    COMP-3.
  2217         16  PL-OVER-SHORT-PCT             PIC S9V9(4)    COMP-3.
  2218     12  FILLER                            PIC X(24).
  2219     12  PLAN-MISC.
  2220         16  PL-POLICY-FEE                 PIC S9(3)V99   COMP-3.
  2221         16  PL-STATE-TAX                  PIC S9V9999    COMP-3.
  2222         16  PL-IG                         PIC X.
  2223         16  PL-RETRO-RET                  PIC S9V9999    COMP-3.
  2224         16  PL-POLICY-FORM                PIC X(12).
  2225         16  PL-EDIT-FOR-FORM              PIC X(01).
  2226         16  PL-DEV-CODE                   PIC XXX.
  2227         16  PL-DEV-PCT                    PIC S9V9(6)    COMP-3.
  2228         16  PL-CALC-METHOD                PIC X.
  2229         16  PL-BENEFIT-GROUP              PIC X(05).
  2230         16  PL-SALES-TAX                  PIC S9V9999    COMP-3.
  2231
  2232         16  FILLER                        PIC X(99).
  2233******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6565.cbl
  2235*                            COPY ERCRATE.
  2236******************************************************************
  2237*                                                                *
  2238*                                                                *
  2239*                            ERCRATE                             *
  2240*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2241*                            VMOD=2.008                          *
  2242*                                                                *
  2243*   ONLINE CREDIT SYSTEM                                         *
  2244*                                                                *
  2245*   FILE DESCRIPTION = RATES MASTER FILE                         *
  2246*                                                                *
  2247*   FILE TYPE = VSAM,KSDS                                        *
  2248*   RECORD SIZE = 1765  RECFORM = FIXED                          *
  2249*                                                                *
  2250*   BASE CLUSTER NAME = ERRATE                   RKP=2,LEN=28    *
  2251*       ALTERNATE PATH = NONE                                    *
  2252*                                                                *
  2253*   LOG = NO                                                     *
  2254*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2255*                                                                *
  2256******************************************************************
  2257
  2258 01  RATE-RECORD.
  2259     12  RT-RECORD-ID                      PIC XX.
  2260         88  VALID-RT-ID                      VALUE 'RT'.
  2261
  2262     12  RT-CONTROL-PRIMARY.
  2263         16  RT-COMPANY-CD                 PIC X.
  2264         16  RT-STATE-CODE.
  2265             20  RT-ST-CODE                PIC XX.
  2266             20  RT-ST-CLASS               PIC XX.
  2267             20  RT-ST-DEV                 PIC XXX.
  2268         16  RT-L-AH-CODE.
  2269             20  RT-L-AH                   PIC X.
  2270             20  RT-LAH-NUM                PIC XX.
  2271         16  RT-LIMITS.
  2272             20  RT-HIGH-AGE               PIC 99.
  2273             20  RT-HIGH-AMT               PIC 9(6).
  2274             20  RT-FUTURE                 PIC XX.
  2275             20  RT-SEX                    PIC X.
  2276         16  RT-EXPIRY-DATE                PIC 9(11)  COMP-3.
  2277
  2278     12  RT-MAINT-INFORMATION.
  2279         16  RT-LAST-MAINT-DT              PIC XX.
  2280         16  RT-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2281         16  RT-LAST-MAINT-USER            PIC X(4).
  2282         16  FILLER                        PIC X(10).
  2283
  2284     12  RT-STRUCTURE-COMMENT              PIC X(50).
  2285     12  RT-RATE-COMMENT                   PIC X(50).
  2286
  2287     12  CSL-RESERVED                      PIC X(10).
  2288     12  FILLER                            PIC X(12).
  2289
  2290     12  RT-MAX-AGE                        PIC 99.
  2291
  2292     12  RT-LIFE-LIMS-FLDS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6565.cbl
  2293         16  RT-LIFE-MORT-CODE             PIC X(4).
  2294         16  RT-LIFE-EXCEPTIONS   OCCURS 8 TIMES.
  2295             20  RT-L-EX-AGE               PIC 99.
  2296             20  RT-L-EX-TERM              PIC S999       COMP-3.
  2297             20  RT-L-EX-FACE              PIC S9(7)      COMP-3.
  2298         16  FILLER                        PIC X(20).
  2299
  2300     12  RT-AH-LIMS-FLDS   REDEFINES   RT-LIFE-LIMS-FLDS.
  2301         16  RT-AH-EXCEPTIONS   OCCURS 8 TIMES.
  2302             20  RT-AH-AGE                 PIC 99.
  2303             20  RT-AH-TERM                PIC S999       COMP-3.
  2304             20  RT-AH-BEN-M               PIC S9(5)      COMP-3.
  2305             20  RT-AH-BEN-F               PIC S9(7)      COMP-3.
  2306
  2307     12  RT-LIFE-RATES.
  2308         16  RT-L-RATE  OCCURS 360 TIMES   PIC S99V9(5)   COMP-3.
  2309
  2310     12  RT-AH-RATES   REDEFINES   RT-LIFE-RATES.
  2311         16  RT-AH-RATE  OCCURS 360 TIMES  PIC S99V9(5)   COMP-3.
  2312
  2313     12  RT-DAILY-RATE                     PIC S99V9(5)   COMP-3.
  2314
  2315     12  RT-DISCOUNT-OPTION                PIC X.
  2316         88  RT-DO-NOT-USE                     VALUE ' '.
  2317         88  RT-USE-DISCOUNT-FACTOR            VALUE '1'.
  2318         88  RT-USE-APR-AS-DISCOUNT            VALUE '2'.
  2319
  2320     12  RT-DISCOUNT-RATE                  PIC S99V9(5)   COMP-3.
  2321     12  RT-DISCOUNT-OB-RATE               PIC S99V9(5)   COMP-3.
  2322
  2323     12  RT-COMPOSITE-OPTION               PIC X.
  2324         88  RT-NO-COMPOSITE                   VALUE ' '.
  2325         88  RT-USE-COMPOSITE-RATE             VALUE '1'.
  2326
  2327     12  RT-COMPOSITE-RATE                 PIC S99V9(5)   COMP-3.
  2328
  2329     12  RT-POLICY-FEE                     PIC S9(3)V99   COMP-3.
  2330     12  FILLER                            PIC X(13).
  2331
  2332     12  RT-TYPE-RATE                      PIC X.
  2333         88  RT-IS-STND                        VALUE ' ' 'S'.
  2334         88  RT-IS-OB                          VALUE 'O'.
  2335
  2336     12  RT-SRT-ALPHA                      PIC X.
  2337
  2338     12  RT-CONTROL-2.
  2339         16  RTC-1                         PIC X(7).
  2340         16  RTC-3                         PIC X(11).
  2341         16  RTC-4                         PIC 9(11) COMP-3.
  2342         16  RTC-2                         PIC X(3).
  2343******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6565.cbl
  2345 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA ACCOUNT-MASTER
  2346                          PLAN-MASTER RATE-RECORD.
  2347 0000-DFHEXIT SECTION.
  2348     MOVE '9#                    $   ' TO DFHEIV0.
  2349     MOVE 'EL6565' TO DFHEIV1.
  2350     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2351     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  2352     MOVE '5'                   TO DC-OPTION-CODE.
  2353     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2354     MOVE DC-GREG-DATE-1-EDIT   TO SAVE-DATE.
  2355     MOVE DC-BIN-DATE-1         TO SAVE-BIN-DATE.
  2356
  2357     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  2358
  2359 0100-START.
  2360     IF EIBCALEN = 0
  2361         GO TO 8800-UNAUTHORIZED-ACCESS.
  2362
  2363     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2364         MOVE PI-CALLING-PROGRAM TO PI-SAVE-CALLING-PGM
  2365         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2366             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2367             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2368             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2369             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2370             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2371             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2372             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2373             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  2374         ELSE
  2375             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2376             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2377             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2378             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2379             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2380             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2381             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2382             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  2383
  2384
  2385* EXEC CICS HANDLE CONDITION
  2386*        PGMIDERR (9600-PGMID-ERROR)
  2387*        ERROR    (9990-ABEND)
  2388*    END-EXEC.
  2389*    MOVE '"$L.                  ! " #00002380' TO DFHEIV0
  2390     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  2391     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2392     MOVE X'2220233030303032333830' TO DFHEIV0(25:11)
  2393     CALL 'kxdfhei1' USING DFHEIV0
  2394     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2395
  2396
  2397     IF EIBTRNID NOT = TRANS-ID
  2398         MOVE LOW-VALUES TO EL6565AI
  2399         MOVE +1         TO PI-SUB
  2400                            PI-YEAR
  2401         MOVE 'X'        TO PI-1ST-TIME
  2402         GO TO 2000-INITIAL-DISPLAY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6565.cbl
  2403
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6565.cbl
  2405     IF EIBAID = DFHCLEAR
  2406         GO TO 9400-CLEAR.
  2407
  2408 0200-RECEIVE.
  2409     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2410         MOVE ER-0008 TO EMI-ERROR
  2411         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2412         MOVE -1   TO STATEL
  2413         GO TO 8200-SEND-DATAONLY.
  2414
  2415
  2416* EXEC CICS RECEIVE
  2417*        MAP    (WS-MAPNAME)
  2418*        MAPSET (WS-MAPSET-NAME)
  2419*        INTO   (EL6565AI)
  2420*    END-EXEC.
  2421     MOVE LENGTH OF
  2422      EL6565AI
  2423       TO DFHEIV11
  2424*    MOVE '8"T I  L              ''   #00002403' TO DFHEIV0
  2425     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2426     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2427     MOVE X'2020233030303032343033' TO DFHEIV0(25:11)
  2428     CALL 'kxdfhei1' USING DFHEIV0,
  2429           WS-MAPNAME,
  2430           EL6565AI,
  2431           DFHEIV11,
  2432           WS-MAPSET-NAME,
  2433           DFHEIV99,
  2434           DFHEIV99
  2435     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2436
  2437
  2438     IF PFENTERL = 0
  2439         GO TO 0300-CHECK-PFENTERS.
  2440
  2441     IF EIBAID NOT = DFHENTER
  2442         MOVE ER-0004 TO EMI-ERROR
  2443         GO TO 0310-INPUT-ERROR.
  2444
  2445     IF (PFENTERI NUMERIC) AND (PFENTERI GREATER 0 AND LESS 25)
  2446         MOVE PF-VALUES (PFENTERI) TO EIBAID
  2447         GO TO 0300-CHECK-PFENTERS
  2448     ELSE
  2449         MOVE ER-0029 TO EMI-ERROR
  2450         GO TO 0310-INPUT-ERROR.
  2451
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6565.cbl
  2453
  2454 0300-CHECK-PFENTERS.
  2455     IF EIBAID = DFHPF23
  2456         GO TO 8810-PF23.
  2457
  2458     IF EIBAID = DFHPF24
  2459         GO TO 9200-RETURN-MAIN-MENU.
  2460
  2461     IF EIBAID = DFHPF1
  2462         GO TO 5300-PAGE-FORWARD.
  2463
  2464     IF EIBAID = DFHPF2
  2465         GO TO 5400-PAGE-BACKWARD.
  2466
  2467     IF EIBAID = DFHPF3
  2468         MOVE 'X'            TO WS-DEV-RATES
  2469         GO TO 1000-EDIT.
  2470
  2471     IF EIBAID = DFHENTER
  2472         GO TO 1000-EDIT.
  2473
  2474     MOVE ER-0029 TO EMI-ERROR.
  2475
  2476 0310-INPUT-ERROR.
  2477     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2478     MOVE AL-UNBON TO PFENTERA.
  2479     MOVE -1       TO PFENTERL.
  2480
  2481     GO TO 8200-SEND-DATAONLY.
  2482
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6565.cbl
  2484
  2485 1000-EDIT.
  2486     MOVE PI-COMPANY-CD             TO PI-RATE-COMPANY-CD.
  2487
  2488     IF STATEL GREATER ZERO
  2489         MOVE STATEI                TO PI-RATE-CODE
  2490         MOVE AL-UANON              TO STATEA.
  2491
  2492     IF CLASSL GREATER ZERO
  2493         MOVE CLASSI                TO PI-RATE-CLASS
  2494         MOVE AL-UANON              TO CLASSA.
  2495
  2496     IF DEVL GREATER ZERO
  2497         MOVE DEVI                  TO PI-RATE-DEV
  2498         MOVE AL-UANON              TO DEVA.
  2499
  2500     MOVE +1                        TO WS-DEV-PCT.
  2501
  2502     IF PCTL GREATER ZERO
  2503        MOVE PCTI                   TO DEEDIT-FIELD
  2504        PERFORM 8600-DEEDIT
  2505        IF DEEDIT-FIELD-V6 NUMERIC
  2506           MOVE DEEDIT-FIELD-V6   TO WS-DEV-PCT
  2507                                     PCTO
  2508           MOVE AL-UANON          TO PCTA
  2509        ELSE
  2510           MOVE -1                TO PCTL
  2511           MOVE AL-UABON          TO PCTA
  2512           MOVE ER-2263           TO EMI-ERROR
  2513           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2514
  2515     IF TYPEL GREATER ZERO
  2516         MOVE TYPEI                 TO PI-RATE-L-AH
  2517         MOVE AL-UANON              TO TYPEA.
  2518
  2519     IF PLANL GREATER ZERO
  2520         MOVE PLANI                 TO PI-RATE-LAH-NUM
  2521         MOVE AL-UANON              TO PLANA.
  2522
  2523     MOVE '99999999999'             TO PI-RATE-LIMITS.
  2524     MOVE 99999999999               TO PI-RATE-EXPIRY-DATE.
  2525
  2526
  2527* EXEC CICS HANDLE CONDITION
  2528*        NOTOPEN  (9990-ABEND)
  2529*        NOTFND   (8880-NOT-FOUND)
  2530*    END-EXEC.
  2531*    MOVE '"$JI                  ! # #00002497' TO DFHEIV0
  2532     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  2533     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2534     MOVE X'2320233030303032343937' TO DFHEIV0(25:11)
  2535     CALL 'kxdfhei1' USING DFHEIV0
  2536     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2537
  2538
  2539     PERFORM 7650-READ-ERRATE THRU 7650-EXIT.
  2540
  2541     MOVE +1                     TO PI-SUB
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6565.cbl
  2542                                    PI-YEAR.
  2543     GO TO 3000-DISPLAY-RATE.
  2544
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6565.cbl
  2546 2000-INITIAL-DISPLAY.
  2547     MOVE +1                        TO PI-AH-DEV-PCT
  2548                                       PI-LF-DEV-PCT
  2549                                       WS-DEV-PCT.
  2550
  2551     IF PI-SAVE-CALLING-PGM NOT = WS-CALLED-FROM-ACCT
  2552         GO TO 2010-NO-ACCOUNT.
  2553
  2554     MOVE 1 TO PI-NDX.
  2555
  2556 2001-GET-ACCOUNT.
  2557
  2558* EXEC CICS HANDLE CONDITION
  2559*        NOTOPEN  (9990-ABEND)
  2560*        NOTFND   (2525-NO-ACCOUNT)
  2561*    END-EXEC.
  2562*    MOVE '"$JI                  ! $ #00002520' TO DFHEIV0
  2563     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  2564     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2565     MOVE X'2420233030303032353230' TO DFHEIV0(25:11)
  2566     CALL 'kxdfhei1' USING DFHEIV0
  2567     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2568
  2569
  2570     PERFORM 7850-READ-ERACCT THRU 7850-EXIT.
  2571
  2572     PERFORM 7950-READ-ERPLAN THRU 7950-EXIT.
  2573
  2574     MOVE PI-COMPANY-CD             TO PI-RATE-COMPANY-CD.
  2575
  2576     MOVE PI-WS-STATE               TO STATEO
  2577                                       PI-RATE-CODE.
  2578     MOVE ZEROS                     TO CLASSO
  2579                                       PI-RATE-CLASS.
  2580 2005-CHECK-TYPE.
  2581     IF AM-BENEFIT-TYPE (PI-NDX) = SPACES OR ZEROS OR LOW-VALUES
  2582       IF PI-NDX = +1
  2583         GO TO 5200-NO-RATE
  2584        ELSE
  2585         GO TO 5350-ENDFILE.
  2586
  2587     IF PI-FIRST-TIME-THRU
  2588       IF AM-BENEFIT-TYPE (PI-NDX) = PI-WS-TYPE  AND
  2589          AM-BENEFIT-CODE (PI-NDX) = PI-WS-PLAN
  2590             NEXT SENTENCE
  2591           ELSE
  2592             ADD +1 TO PI-NDX
  2593             GO TO 2005-CHECK-TYPE.
  2594
  2595     MOVE SPACE                     TO PI-1ST-TIME.
  2596
  2597     MOVE AM-BENEFIT-TYPE (PI-NDX)  TO TYPEO
  2598                                       PI-RATE-L-AH.
  2599     MOVE AM-BENEFIT-CODE (PI-NDX)  TO PLANO
  2600                                       PI-RATE-LAH-NUM.
  2601
  2602     MOVE ZEROS                     TO DEVO
  2603                                       PI-RATE-DEV.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6565.cbl
  2604
  2605     MOVE ZEROS                     TO PCTO.
  2606
  2607     IF AM-BENEFIT-TYPE (PI-NDX) = PI-AH-OVERRIDE-L1
  2608       IF PL-DEV-PCT NUMERIC AND
  2609          PL-DEV-PCT GREATER ZEROS
  2610         MOVE PL-DEV-PCT            TO WS-DEV-PCT
  2611       ELSE
  2612         MOVE AM-AH-DEVIATION-PCT   TO WS-DEV-PCT
  2613       ELSE
  2614     IF AM-BENEFIT-TYPE (PI-NDX) = PI-LIFE-OVERRIDE-L1
  2615       IF PL-DEV-PCT NUMERIC AND
  2616          PL-DEV-PCT GREATER ZEROS
  2617         MOVE PL-DEV-PCT            TO WS-DEV-PCT
  2618       ELSE
  2619         MOVE AM-LF-DEVIATION-PCT   TO WS-DEV-PCT.
  2620
  2621     IF WS-DEV-PCT = ZERO
  2622         MOVE +1.0                  TO WS-DEV-PCT.
  2623
  2624     GO TO 2020-CONTINUE.
  2625
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6565.cbl
  2627 2010-NO-ACCOUNT.
  2628     MOVE PI-COMPANY-CD             TO PI-RATE-COMPANY-CD.
  2629
  2630     MOVE PI-WS-STATE               TO STATEO
  2631                                       PI-RATE-CODE
  2632                                       PI-SAVE-RATE-CODE.
  2633     MOVE PI-WS-CLASS               TO CLASSO
  2634                                       PI-RATE-CLASS.
  2635     MOVE PI-WS-DEV                 TO DEVO
  2636                                       PI-RATE-DEV.
  2637     MOVE PI-WS-TYPE                TO TYPEO
  2638                                       PI-RATE-L-AH.
  2639     MOVE PI-WS-PLAN                TO PLANO
  2640                                       PI-RATE-LAH-NUM.
  2641
  2642 2020-CONTINUE.
  2643     MOVE '99999999999'             TO PI-RATE-LIMITS.
  2644     MOVE 99999999999               TO PI-RATE-EXPIRY-DATE.
  2645
  2646     MOVE AL-UANON                  TO STATEA
  2647                                       CLASSA
  2648                                       DEVA
  2649                                       TYPEA
  2650                                       PLANA
  2651                                       PCTA.
  2652
  2653     MOVE +2                        TO STATEL.
  2654     MOVE +2                        TO CLASSL.
  2655     MOVE +3                        TO DEVL.
  2656     MOVE +1                        TO TYPEL.
  2657     MOVE +2                        TO PLANL.
  2658     MOVE +7                        TO PCTL.
  2659
  2660
  2661* EXEC CICS HANDLE CONDITION
  2662*        NOTOPEN  (9990-ABEND)
  2663*        NOTFND   (5200-NO-RATE)
  2664*    END-EXEC.
  2665*    MOVE '"$JI                  ! % #00002615' TO DFHEIV0
  2666     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  2667     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2668     MOVE X'2520233030303032363135' TO DFHEIV0(25:11)
  2669     CALL 'kxdfhei1' USING DFHEIV0
  2670     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2671
  2672
  2673     PERFORM 7650-READ-ERRATE THRU 7650-EXIT.
  2674
  2675     MOVE +1                     TO PI-SUB
  2676                                    PI-YEAR.
  2677     GO TO 3000-DISPLAY-RATE.
  2678
  2679 2525-NO-ACCOUNT.
  2680     MOVE ER-2154            TO EMI-ERROR.
  2681     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2682     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6565.cbl
  2684 3000-DISPLAY-RATE.
  2685     MOVE PI-SUB                    TO SUB1.
  2686     MOVE PI-YEAR                   TO SUB4.
  2687
  2688 3025-SET-UP-SCREEN.
  2689     MOVE PI-COMPANY-CD             TO PI-RATE-COMPANY-CD.
  2690
  2691     MOVE WS-DEV-PCT                TO PCTO.
  2692
  2693     MOVE RT-ST-CODE                TO STATEO
  2694                                       PI-RATE-CODE.
  2695     MOVE RT-ST-CLASS               TO CLASSO
  2696                                       PI-RATE-CLASS.
  2697     MOVE RT-ST-DEV                 TO DEVO
  2698                                       PI-RATE-DEV.
  2699     MOVE RT-L-AH                   TO TYPEO
  2700                                       PI-RATE-L-AH.
  2701     MOVE RT-LAH-NUM                TO PLANO
  2702                                       PI-RATE-LAH-NUM.
  2703
  2704     MOVE '99999999999'             TO PI-RATE-LIMITS.
  2705     MOVE 99999999999               TO PI-RATE-EXPIRY-DATE.
  2706
  2707     MOVE +1     TO SUB2
  2708                    SUB3.
  2709     SET ST-INDX
  2710         RT-INDX TO +1.
  2711
  2712 3050-SET-UP.
  2713     IF ST-INDX GREATER +20
  2714         MOVE +1     TO SUB1
  2715                        SUB2
  2716                        SUB3
  2717                        SUB4
  2718         SET ST-INDX
  2719             RT-INDX TO +1
  2720         GO TO 8100-SEND-INITIAL-MAP.
  2721
  2722*    MOVE SUB4 TO YEAR (ST-INDX).
  2723
  2724     IF SUB4 GREATER +10
  2725         MOVE SPACES       TO MONTH    (ST-INDX)
  2726                              YEAR-1   (ST-INDX)
  2727       ELSE
  2728         IF EVEN-SUB
  2729             ADD +1 TO SUB4
  2730             MOVE SPACES   TO YEAR-1  (ST-INDX)
  2731             MOVE '07-12'  TO MONTH   (ST-INDX)
  2732           ELSE
  2733             MOVE '01-06'  TO MONTH   (ST-INDX).
  2734
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6565.cbl
  2736 3075-SET-UP-RATES.
  2737     IF SUB1 GREATER +120
  2738         MOVE SPACES             TO RATE2  (ST-INDX RT-INDX)
  2739     ELSE
  2740         IF RT-L-AH = PI-AH-OVERRIDE-L1
  2741           IF RATES-DEVIATED AND
  2742              WS-DEV-PCT        GREATER ZERO AND
  2743              RT-AH-RATE (SUB1) GREATER ZERO
  2744             COMPUTE WS-DEV-RATE = (RT-AH-RATE (SUB1)
  2745                                  * WS-DEV-PCT)
  2746             MOVE WS-DEV-RATE       TO RATE1 (ST-INDX RT-INDX)
  2747             MOVE AL-UABON          TO PF3DEVA
  2748            ELSE
  2749             MOVE RT-AH-RATE (SUB1) TO RATE1 (ST-INDX RT-INDX)
  2750         ELSE
  2751         IF RT-L-AH = PI-LIFE-OVERRIDE-L1
  2752           IF RATES-DEVIATED AND
  2753              WS-DEV-PCT       GREATER ZERO AND
  2754              RT-L-RATE (SUB1) GREATER ZERO
  2755             COMPUTE WS-DEV-RATE = (RT-L-RATE (SUB1)
  2756                                  * WS-DEV-PCT)
  2757             MOVE WS-DEV-RATE       TO RATE1 (ST-INDX RT-INDX)
  2758             MOVE AL-UABON          TO PF3DEVA
  2759            ELSE
  2760             MOVE RT-L-RATE (SUB1)  TO RATE1 (ST-INDX RT-INDX).
  2761
  2762     ADD +1 TO SUB1
  2763               SUB2.
  2764     SET RT-INDX UP BY +1.
  2765
  2766     IF RT-INDX GREATER +6
  2767         SET RT-INDX TO +1
  2768         SET ST-INDX UP BY +1
  2769         ADD +1  TO  SUB3
  2770         GO TO 3050-SET-UP
  2771     ELSE
  2772         GO TO 3075-SET-UP-RATES.
  2773
  2774 3099-EXIT.
  2775      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6565.cbl
  2777 5200-NO-RATE.
  2778     IF PI-SAVE-CALLING-PGM = WS-CALLED-FROM-ACCT
  2779         MOVE ER-2154            TO EMI-ERROR
  2780         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2781         GO TO 8100-SEND-INITIAL-MAP.
  2782
  2783 5300-PAGE-FORWARD.
  2784     IF PI-SAVE-CALLING-PGM = WS-CALLED-FROM-ACCT
  2785         ADD +1 TO PI-NDX
  2786         IF PI-NDX GREATER +20
  2787             GO TO 5350-ENDFILE
  2788          ELSE
  2789             GO TO 2001-GET-ACCOUNT.
  2790
  2791     MOVE SPACES                TO PI-ERRATE-EOF-SW
  2792                                   PI-STATE-FOUND-SW.
  2793
  2794
  2795* EXEC CICS HANDLE CONDITION
  2796*        ENDFILE  (5350-ENDFILE)
  2797*        NOTFND   (5350-ENDFILE)
  2798*    END-EXEC.
  2799*    MOVE '"$''I                  ! & #00002741' TO DFHEIV0
  2800     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  2801     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2802     MOVE X'2620233030303032373431' TO DFHEIV0(25:11)
  2803     CALL 'kxdfhei1' USING DFHEIV0
  2804     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2805
  2806
  2807     MOVE PI-COMPANY-CD         TO PI-RATE-COMPANY-CD.
  2808     MOVE PI-ERRATE-KEY         TO WS-SAVE-RATE-KEY.
  2809
  2810     PERFORM 6000-START-BROWSE THRU 6000-EXIT.
  2811
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6565.cbl
  2813 5305-READ-NEXT.
  2814
  2815* EXEC CICS HANDLE CONDITION
  2816*        ENDFILE  (5350-ENDFILE)
  2817*        NOTFND   (5350-ENDFILE)
  2818*    END-EXEC.
  2819*    MOVE '"$''I                  ! '' #00002753' TO DFHEIV0
  2820     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  2821     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2822     MOVE X'2720233030303032373533' TO DFHEIV0(25:11)
  2823     CALL 'kxdfhei1' USING DFHEIV0
  2824     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2825
  2826
  2827     PERFORM 6050-READNEXT     THRU 6050-EXIT.
  2828
  2829     IF ERRATE-EOF
  2830         MOVE ER-0130            TO EMI-ERROR
  2831         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2832         GO TO 8100-SEND-INITIAL-MAP.
  2833
  2834     IF STATE-NOT-FOUND
  2835         MOVE ER-2154            TO EMI-ERROR
  2836         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2837         GO TO 8100-SEND-INITIAL-MAP.
  2838
  2839     MOVE +1                     TO PI-SUB
  2840                                    PI-YEAR.
  2841     GO TO 3000-DISPLAY-RATE.
  2842
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6565.cbl
  2844 5350-ENDFILE.
  2845     IF BROWSE-STARTED
  2846         PERFORM 6500-ENDBROWSE THRU 6500-EXIT.
  2847
  2848     MOVE ER-0130            TO EMI-ERROR.
  2849     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2850     SUBTRACT +1 FROM PI-NDX.
  2851     GO TO 8200-SEND-DATAONLY.
  2852
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6565.cbl
  2854 5400-PAGE-BACKWARD.
  2855     IF PI-SAVE-CALLING-PGM = WS-CALLED-FROM-ACCT
  2856        IF PI-NDX LESS +2
  2857            GO TO 5500-ENDFILE
  2858         ELSE
  2859            SUBTRACT +1 FROM PI-NDX
  2860            GO TO 2001-GET-ACCOUNT.
  2861
  2862     MOVE SPACES             TO PI-ERRATE-EOF-SW.
  2863     MOVE PI-COMPANY-CD      TO PI-RATE-COMPANY-CD.
  2864
  2865
  2866* EXEC CICS HANDLE CONDITION
  2867*        ENDFILE  (5500-ENDFILE)
  2868*        NOTFND   (5500-ENDFILE)
  2869*    END-EXEC.
  2870*    MOVE '"$''I                  ! ( #00002796' TO DFHEIV0
  2871     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  2872     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2873     MOVE X'2820233030303032373936' TO DFHEIV0(25:11)
  2874     CALL 'kxdfhei1' USING DFHEIV0
  2875     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2876
  2877
  2878     PERFORM 6000-START-BROWSE THRU 6000-EXIT.
  2879
  2880     PERFORM 6800-READ-PREV    THRU 6800-EXIT.
  2881
  2882 5450-READ-PREV.
  2883
  2884* EXEC CICS HANDLE CONDITION
  2885*        ENDFILE  (5500-ENDFILE)
  2886*        NOTFND   (5500-ENDFILE)
  2887*    END-EXEC.
  2888*    MOVE '"$''I                  ! ) #00002806' TO DFHEIV0
  2889     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  2890     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2891     MOVE X'2920233030303032383036' TO DFHEIV0(25:11)
  2892     CALL 'kxdfhei1' USING DFHEIV0
  2893     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2894
  2895
  2896     PERFORM 6800-READ-PREV    THRU 6800-EXIT.
  2897
  2898     IF PI-COMPANY-CD NOT = RT-COMPANY-CD
  2899         GO TO 5500-ENDFILE.
  2900
  2901     MOVE +1                     TO PI-SUB
  2902                                    PI-YEAR.
  2903     GO TO 3000-DISPLAY-RATE.
  2904
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6565.cbl
  2906 5500-ENDFILE.
  2907     IF BROWSE-STARTED
  2908         PERFORM 6500-ENDBROWSE    THRU 6500-EXIT.
  2909
  2910     MOVE ER-2238            TO EMI-ERROR.
  2911     MOVE -1                 TO STATEL.
  2912     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2913     GO TO 8200-SEND-DATAONLY.
  2914
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6565.cbl
  2916 6000-START-BROWSE.
  2917
  2918* EXEC CICS STARTBR
  2919*        DATASET  (RATE-FILE-ID)
  2920*        RIDFLD   (PI-ERRATE-KEY)
  2921*    END-EXEC.
  2922     MOVE 0
  2923       TO DFHEIV11
  2924*    MOVE '&,         G          &   #00002832' TO DFHEIV0
  2925     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2926     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2927     MOVE X'2020233030303032383332' TO DFHEIV0(25:11)
  2928     CALL 'kxdfhei1' USING DFHEIV0,
  2929           RATE-FILE-ID,
  2930           PI-ERRATE-KEY,
  2931           DFHEIV99,
  2932           DFHEIV11,
  2933           DFHEIV99
  2934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2935
  2936
  2937     MOVE 'Y'                   TO PI-BROWSE-SW.
  2938
  2939 6000-EXIT.
  2940      EXIT.
  2941
  2942 6050-READNEXT.
  2943
  2944* EXEC CICS READNEXT
  2945*        DATASET  (RATE-FILE-ID)
  2946*        SET      (ADDRESS OF RATE-RECORD)
  2947*        RIDFLD   (PI-ERRATE-KEY)
  2948*    END-EXEC.
  2949     MOVE 0
  2950       TO DFHEIV11
  2951*    MOVE '&.S                   )   #00002843' TO DFHEIV0
  2952     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2953     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2954     MOVE X'2020233030303032383433' TO DFHEIV0(25:11)
  2955     CALL 'kxdfhei1' USING DFHEIV0,
  2956           RATE-FILE-ID,
  2957           DFHEIV20,
  2958           DFHEIV99,
  2959           PI-ERRATE-KEY,
  2960           DFHEIV99,
  2961           DFHEIV11,
  2962           DFHEIV99,
  2963           DFHEIV99
  2964     SET ADDRESS OF RATE-RECORD TO
  2965         DFHEIV20
  2966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2967
  2968
  2969     IF PI-COMPANY-CD NOT = RT-COMPANY-CD
  2970         MOVE 'Y'            TO PI-ERRATE-EOF-SW.
  2971
  2972     IF (PI-SAVE-CALLING-PGM = WS-CALL-FROM-STATE  OR
  2973                               WS-CALL-FROM-STATE-ALT)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6565.cbl
  2974          AND
  2975         PI-SAVE-RATE-CODE NOT = RT-ST-CODE
  2976             MOVE 'N'       TO PI-STATE-FOUND-SW.
  2977
  2978     IF PI-ERRATE-KEY = WS-SAVE-RATE-KEY
  2979         GO TO 6050-READNEXT.
  2980
  2981     MOVE RT-CONTROL-PRIMARY TO PI-ERRATE-KEY.
  2982
  2983 6050-EXIT.
  2984      EXIT.
  2985
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6565.cbl
  2987 6500-ENDBROWSE.
  2988
  2989* EXEC CICS ENDBR
  2990*        DATASET  (RATE-FILE-ID)
  2991*    END-EXEC.
  2992     MOVE 0
  2993       TO DFHEIV11
  2994*    MOVE '&2                    $   #00002868' TO DFHEIV0
  2995     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2996     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2997     MOVE X'2020233030303032383638' TO DFHEIV0(25:11)
  2998     CALL 'kxdfhei1' USING DFHEIV0,
  2999           RATE-FILE-ID,
  3000           DFHEIV11,
  3001           DFHEIV99
  3002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3003
  3004
  3005     MOVE 'N'                TO PI-BROWSE-SW.
  3006
  3007 6500-EXIT.
  3008      EXIT.
  3009
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6565.cbl
  3011 6800-READ-PREV.
  3012
  3013* EXEC CICS READPREV
  3014*        DATASET  (RATE-FILE-ID)
  3015*        SET      (ADDRESS OF RATE-RECORD)
  3016*        RIDFLD   (PI-ERRATE-KEY)
  3017*    END-EXEC.
  3018     MOVE 0
  3019       TO DFHEIV11
  3020*    MOVE '&0S                   )   #00002879' TO DFHEIV0
  3021     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  3022     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  3023     MOVE X'2020233030303032383739' TO DFHEIV0(25:11)
  3024     CALL 'kxdfhei1' USING DFHEIV0,
  3025           RATE-FILE-ID,
  3026           DFHEIV20,
  3027           DFHEIV99,
  3028           PI-ERRATE-KEY,
  3029           DFHEIV99,
  3030           DFHEIV11,
  3031           DFHEIV99,
  3032           DFHEIV99
  3033     SET ADDRESS OF RATE-RECORD TO
  3034         DFHEIV20
  3035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3036
  3037
  3038 6800-EXIT.
  3039      EXIT.
  3040
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL6565.cbl
  3042
  3043 7650-READ-ERRATE.
  3044     MOVE PI-COMPANY-CD  TO  PI-RATE-COMPANY-CD.
  3045
  3046
  3047* EXEC CICS READ
  3048*        DATASET  (RATE-FILE-ID)
  3049*        SET      (ADDRESS OF RATE-RECORD)
  3050*        RIDFLD   (PI-ERRATE-KEY)
  3051*    END-EXEC.
  3052*    MOVE '&"S        E          (   #00002893' TO DFHEIV0
  3053     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3054     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3055     MOVE X'2020233030303032383933' TO DFHEIV0(25:11)
  3056     CALL 'kxdfhei1' USING DFHEIV0,
  3057           RATE-FILE-ID,
  3058           DFHEIV20,
  3059           DFHEIV99,
  3060           PI-ERRATE-KEY,
  3061           DFHEIV99,
  3062           DFHEIV99,
  3063           DFHEIV99
  3064     SET ADDRESS OF RATE-RECORD TO
  3065         DFHEIV20
  3066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3067
  3068
  3069 7650-EXIT.
  3070      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL6565.cbl
  3072
  3073 7850-READ-ERACCT.
  3074
  3075* EXEC CICS READ
  3076*        DATASET  (ACCT-FILE-ID)
  3077*        SET      (ADDRESS OF ACCOUNT-MASTER)
  3078*        RIDFLD   (PI-ACCT-KEY)
  3079*    END-EXEC.
  3080*    MOVE '&"S        E          (   #00002904' TO DFHEIV0
  3081     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3082     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3083     MOVE X'2020233030303032393034' TO DFHEIV0(25:11)
  3084     CALL 'kxdfhei1' USING DFHEIV0,
  3085           ACCT-FILE-ID,
  3086           DFHEIV20,
  3087           DFHEIV99,
  3088           PI-ACCT-KEY,
  3089           DFHEIV99,
  3090           DFHEIV99,
  3091           DFHEIV99
  3092     SET ADDRESS OF ACCOUNT-MASTER TO
  3093         DFHEIV20
  3094     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3095
  3096
  3097 7850-EXIT.
  3098      EXIT.
  3099
  3100 7950-READ-ERPLAN.
  3101
  3102* EXEC CICS READ
  3103*        DATASET  (PLAN-FILE-ID)
  3104*        SET      (ADDRESS OF PLAN-MASTER)
  3105*        RIDFLD   (PI-PLAN-KEY)
  3106*    END-EXEC.
  3107*    MOVE '&"S        E          (   #00002914' TO DFHEIV0
  3108     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3109     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3110     MOVE X'2020233030303032393134' TO DFHEIV0(25:11)
  3111     CALL 'kxdfhei1' USING DFHEIV0,
  3112           PLAN-FILE-ID,
  3113           DFHEIV20,
  3114           DFHEIV99,
  3115           PI-PLAN-KEY,
  3116           DFHEIV99,
  3117           DFHEIV99,
  3118           DFHEIV99
  3119     SET ADDRESS OF PLAN-MASTER TO
  3120         DFHEIV20
  3121     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3122
  3123
  3124 7950-EXIT.
  3125      EXIT.
  3126
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL6565.cbl
  3128
  3129 8100-SEND-INITIAL-MAP.
  3130     MOVE EIBTIME              TO TIME-IN.
  3131     MOVE SAVE-DATE            TO RUNDATEO.
  3132     MOVE TIME-OUT             TO RUNTIMEO.
  3133     MOVE EMI-MESSAGE-AREA (1) TO ERRMSG1O.
  3134     MOVE -1                   TO STATEL.
  3135
  3136* EXEC CICS SEND
  3137*        MAP   (WS-MAPNAME)
  3138*        MAPSET(WS-MAPSET-NAME)
  3139*        FROM  (EL6565AO)
  3140*        ERASE
  3141*        CURSOR
  3142*    END-EXEC.
  3143     MOVE LENGTH OF
  3144      EL6565AO
  3145       TO DFHEIV12
  3146     MOVE -1
  3147       TO DFHEIV11
  3148*    MOVE '8$     CT  E    H L F ,   #00002931' TO DFHEIV0
  3149     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3150     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3151     MOVE X'2020233030303032393331' TO DFHEIV0(25:11)
  3152     CALL 'kxdfhei1' USING DFHEIV0,
  3153           WS-MAPNAME,
  3154           EL6565AO,
  3155           DFHEIV12,
  3156           WS-MAPSET-NAME,
  3157           DFHEIV99,
  3158           DFHEIV99,
  3159           DFHEIV99,
  3160           DFHEIV11,
  3161           DFHEIV99,
  3162           DFHEIV99,
  3163           DFHEIV99
  3164     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3165
  3166
  3167     GO TO 9100-RETURN-TRAN.
  3168
  3169 8200-SEND-DATAONLY.
  3170     MOVE EIBTIME              TO TIME-IN.
  3171     MOVE SAVE-DATE            TO RUNDATEO.
  3172     MOVE TIME-OUT             TO RUNTIMEO.
  3173     MOVE EMI-MESSAGE-AREA (1) TO ERRMSG1O.
  3174     MOVE -1                   TO STATEL.
  3175
  3176* EXEC CICS SEND
  3177*        MAP   (WS-MAPNAME)
  3178*        MAPSET(WS-MAPSET-NAME)
  3179*        FROM  (EL6565AO)
  3180*        DATAONLY
  3181*        CURSOR
  3182*    END-EXEC.
  3183     MOVE LENGTH OF
  3184      EL6565AO
  3185       TO DFHEIV12
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL6565.cbl
  3186     MOVE -1
  3187       TO DFHEIV11
  3188*    MOVE '8$D    CT       H L F ,   #00002947' TO DFHEIV0
  3189     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3190     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3191     MOVE X'2020233030303032393437' TO DFHEIV0(25:11)
  3192     CALL 'kxdfhei1' USING DFHEIV0,
  3193           WS-MAPNAME,
  3194           EL6565AO,
  3195           DFHEIV12,
  3196           WS-MAPSET-NAME,
  3197           DFHEIV99,
  3198           DFHEIV99,
  3199           DFHEIV99,
  3200           DFHEIV11,
  3201           DFHEIV99,
  3202           DFHEIV99,
  3203           DFHEIV99
  3204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3205
  3206
  3207     GO TO 9100-RETURN-TRAN.
  3208
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL6565.cbl
  3210 8300-SEND-TEXT.
  3211
  3212* EXEC CICS SEND TEXT
  3213*        FROM  (LOGOFF-TEXT)
  3214*        LENGTH(LOGOFF-LENGTH)
  3215*        ERASE
  3216*        FREEKB
  3217*    END-EXEC.
  3218*    MOVE '8&      T  E F  H   F -   #00002959' TO DFHEIV0
  3219     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3220     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3221     MOVE X'2020233030303032393539' TO DFHEIV0(25:11)
  3222     CALL 'kxdfhei1' USING DFHEIV0,
  3223           LOGOFF-TEXT,
  3224           LOGOFF-LENGTH,
  3225           DFHEIV99,
  3226           DFHEIV99,
  3227           DFHEIV99,
  3228           DFHEIV99,
  3229           DFHEIV99,
  3230           DFHEIV99,
  3231           DFHEIV99,
  3232           DFHEIV99,
  3233           DFHEIV99,
  3234           DFHEIV99
  3235     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3236
  3237
  3238
  3239* EXEC CICS RETURN
  3240*    END-EXEC.
  3241*    MOVE '.(                    &   #00002966' TO DFHEIV0
  3242     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3243     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3244     MOVE X'2020233030303032393636' TO DFHEIV0(25:11)
  3245     CALL 'kxdfhei1' USING DFHEIV0,
  3246           DFHEIV99,
  3247           DFHEIV99,
  3248           DFHEIV99,
  3249           DFHEIV99,
  3250           DFHEIV99
  3251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3252
  3253
  3254 8600-DEEDIT.
  3255
  3256* EXEC CICS BIF DEEDIT
  3257*         FIELD (DEEDIT-FIELD)
  3258*         LENGTH(15)
  3259*    END-EXEC.
  3260     MOVE 15
  3261       TO DFHEIV11
  3262*    MOVE '@"L                   #   #00002970' TO DFHEIV0
  3263     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3264     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3265     MOVE X'2020233030303032393730' TO DFHEIV0(25:11)
  3266     CALL 'kxdfhei1' USING DFHEIV0,
  3267           DEEDIT-FIELD,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL6565.cbl
  3268           DFHEIV11
  3269     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3270
  3271
  3272 8800-UNAUTHORIZED-ACCESS.
  3273     MOVE UNACCESS-MSG TO LOGOFF-MSG.
  3274     GO TO 8300-SEND-TEXT.
  3275
  3276 8810-PF23.
  3277     MOVE EIBAID   TO PI-ENTRY-CD-1.
  3278     MOVE XCTL-005 TO PGM-NAME.
  3279     GO TO 9300-XCTL.
  3280
  3281 8880-NOT-FOUND.
  3282     MOVE ER-0142 TO EMI-ERROR.
  3283     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3284     MOVE -1        TO STATEL.
  3285
  3286     GO TO 8200-SEND-DATAONLY.
  3287
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL6565.cbl
  3289 9000-RETURN-CICS.
  3290
  3291* EXEC CICS RETURN
  3292*    END-EXEC.
  3293*    MOVE '.(                    &   #00002993' TO DFHEIV0
  3294     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3295     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3296     MOVE X'2020233030303032393933' TO DFHEIV0(25:11)
  3297     CALL 'kxdfhei1' USING DFHEIV0,
  3298           DFHEIV99,
  3299           DFHEIV99,
  3300           DFHEIV99,
  3301           DFHEIV99,
  3302           DFHEIV99
  3303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3304
  3305
  3306 9100-RETURN-TRAN.
  3307     MOVE EMI-ERROR-NUMBER (1) TO PI-LAST-ERROR-NO.
  3308     MOVE '656C'               TO PI-CURRENT-SCREEN-NO.
  3309
  3310* EXEC CICS RETURN
  3311*        TRANSID (TRANS-ID)
  3312*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  3313*        LENGTH  (WS-COMM-LENGTH)
  3314*    END-EXEC.
  3315*    MOVE '.(CT                  &   #00002999' TO DFHEIV0
  3316     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3317     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3318     MOVE X'2020233030303032393939' TO DFHEIV0(25:11)
  3319     CALL 'kxdfhei1' USING DFHEIV0,
  3320           TRANS-ID,
  3321           PROGRAM-INTERFACE-BLOCK,
  3322           WS-COMM-LENGTH,
  3323           DFHEIV99,
  3324           DFHEIV99
  3325     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3326
  3327
  3328 9200-RETURN-MAIN-MENU.
  3329     MOVE XCTL-626 TO PGM-NAME.
  3330     GO TO 9300-XCTL.
  3331
  3332 9300-XCTL.
  3333
  3334* EXEC CICS XCTL
  3335*        PROGRAM (PGM-NAME)
  3336*        COMMAREA(PROGRAM-INTERFACE-BLOCK)
  3337*        LENGTH  (WS-COMM-LENGTH)
  3338*    END-EXEC.
  3339*    MOVE '.$C                   $   #00003010' TO DFHEIV0
  3340     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3341     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  3342     MOVE X'2020233030303033303130' TO DFHEIV0(25:11)
  3343     CALL 'kxdfhei1' USING DFHEIV0,
  3344           PGM-NAME,
  3345           PROGRAM-INTERFACE-BLOCK,
  3346           WS-COMM-LENGTH
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL6565.cbl
  3347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3348
  3349
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL6565.cbl
  3351 9400-CLEAR.
  3352     MOVE PI-RETURN-TO-PROGRAM TO PGM-NAME.
  3353     GO TO 9300-XCTL.
  3354
  3355 9500-PF12.
  3356     MOVE XCTL-010 TO PGM-NAME.
  3357     GO TO 9300-XCTL.
  3358
  3359 9600-PGMID-ERROR.
  3360
  3361* EXEC CICS HANDLE CONDITION
  3362*        PGMIDERR(8300-SEND-TEXT)
  3363*    END-EXEC.
  3364*    MOVE '"$L                   ! * #00003026' TO DFHEIV0
  3365     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3366     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3367     MOVE X'2A20233030303033303236' TO DFHEIV0(25:11)
  3368     CALL 'kxdfhei1' USING DFHEIV0
  3369     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3370
  3371
  3372     MOVE PGM-NAME     TO PI-CALLING-PROGRAM.
  3373     MOVE ' '          TO PI-ENTRY-CD-1.
  3374     MOVE XCTL-005     TO PGM-NAME.
  3375     MOVE PGM-NAME     TO LOGOFF-PGM.
  3376     MOVE PGMIDERR-MSG TO LOGOFF-FILL.
  3377     GO TO 9300-XCTL.
  3378
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL6565.cbl
  3380 9700-LINK-DATE-CONVERT.
  3381     MOVE LINK-ELDATCV TO PGM-NAME.
  3382
  3383
  3384* EXEC CICS LINK
  3385*        PROGRAM (PGM-NAME)
  3386*        COMMAREA(DATE-CONVERSION-DATA)
  3387*        LENGTH  (DC-COMM-LENGTH)
  3388*    END-EXEC.
  3389*    MOVE '."C                   ''   #00003041' TO DFHEIV0
  3390     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3391     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3392     MOVE X'2020233030303033303431' TO DFHEIV0(25:11)
  3393     CALL 'kxdfhei1' USING DFHEIV0,
  3394           PGM-NAME,
  3395           DATE-CONVERSION-DATA,
  3396           DC-COMM-LENGTH,
  3397           DFHEIV99,
  3398           DFHEIV99,
  3399           DFHEIV99
  3400     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3401
  3402
  3403 9700-EXIT.
  3404      EXIT.
  3405
  3406 9900-ERROR-FORMAT.
  3407     IF NOT EMI-ERRORS-COMPLETE
  3408         MOVE LINK-001 TO PGM-NAME
  3409
  3410* EXEC CICS LINK
  3411*            PROGRAM (PGM-NAME)
  3412*            COMMAREA(ERROR-MESSAGE-INTERFACE-BLOCK)
  3413*            LENGTH  (EMI-COMM-LENGTH)
  3414*        END-EXEC.
  3415*    MOVE '."C                   ''   #00003053' TO DFHEIV0
  3416     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3417     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3418     MOVE X'2020233030303033303533' TO DFHEIV0(25:11)
  3419     CALL 'kxdfhei1' USING DFHEIV0,
  3420           PGM-NAME,
  3421           ERROR-MESSAGE-INTERFACE-BLOCK,
  3422           EMI-COMM-LENGTH,
  3423           DFHEIV99,
  3424           DFHEIV99,
  3425           DFHEIV99
  3426     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3427
  3428
  3429 9900-EXIT.
  3430      EXIT.
  3431
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL6565.cbl
  3433 9990-ABEND.
  3434     MOVE LINK-004               TO PGM-NAME.
  3435     MOVE DFHEIBLK               TO EMI-LINE1.
  3436
  3437* EXEC CICS LINK
  3438*        PROGRAM   (PGM-NAME)
  3439*        COMMAREA  (EMI-LINE1)
  3440*        LENGTH    (72)
  3441*    END-EXEC.
  3442     MOVE 72
  3443       TO DFHEIV11
  3444*    MOVE '."C                   ''   #00003066' TO DFHEIV0
  3445     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3446     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3447     MOVE X'2020233030303033303636' TO DFHEIV0(25:11)
  3448     CALL 'kxdfhei1' USING DFHEIV0,
  3449           PGM-NAME,
  3450           EMI-LINE1,
  3451           DFHEIV11,
  3452           DFHEIV99,
  3453           DFHEIV99,
  3454           DFHEIV99
  3455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3456
  3457
  3458     GO TO 8200-SEND-DATAONLY.
  3459
  3460
  3461 9999-DFHBACK SECTION.
  3462     MOVE '9%                    "   ' TO DFHEIV0
  3463     MOVE 'EL6565' TO DFHEIV1
  3464     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3465     GOBACK.
  3466 9999-DFHEXIT.
  3467     IF DFHEIGDJ EQUAL 0001
  3468         NEXT SENTENCE
  3469     ELSE IF DFHEIGDJ EQUAL 2
  3470         GO TO 9600-PGMID-ERROR,
  3471               9990-ABEND
  3472         DEPENDING ON DFHEIGDI
  3473     ELSE IF DFHEIGDJ EQUAL 3
  3474         GO TO 9990-ABEND,
  3475               8880-NOT-FOUND
  3476         DEPENDING ON DFHEIGDI
  3477     ELSE IF DFHEIGDJ EQUAL 4
  3478         GO TO 9990-ABEND,
  3479               2525-NO-ACCOUNT
  3480         DEPENDING ON DFHEIGDI
  3481     ELSE IF DFHEIGDJ EQUAL 5
  3482         GO TO 9990-ABEND,
  3483               5200-NO-RATE
  3484         DEPENDING ON DFHEIGDI
  3485     ELSE IF DFHEIGDJ EQUAL 6
  3486         GO TO 5350-ENDFILE,
  3487               5350-ENDFILE
  3488         DEPENDING ON DFHEIGDI
  3489     ELSE IF DFHEIGDJ EQUAL 7
  3490         GO TO 5350-ENDFILE,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL6565.cbl
  3491               5350-ENDFILE
  3492         DEPENDING ON DFHEIGDI
  3493     ELSE IF DFHEIGDJ EQUAL 8
  3494         GO TO 5500-ENDFILE,
  3495               5500-ENDFILE
  3496         DEPENDING ON DFHEIGDI
  3497     ELSE IF DFHEIGDJ EQUAL 9
  3498         GO TO 5500-ENDFILE,
  3499               5500-ENDFILE
  3500         DEPENDING ON DFHEIGDI
  3501     ELSE IF DFHEIGDJ EQUAL 10
  3502         GO TO 8300-SEND-TEXT
  3503         DEPENDING ON DFHEIGDI.
  3504     MOVE '9%                    "   ' TO DFHEIV0
  3505     MOVE 'EL6565' TO DFHEIV1
  3506     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3507     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5208     Code:        6923
