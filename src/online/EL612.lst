* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL612.cbl
* Options: int("EL612.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL612.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL612.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL612.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL612 .
     3*                            VMOD=2.001.
     4*AUTHOR.    CSO.
     5*           OMAHA, NEBRASKA.
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    10*            *                                                   *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL612.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*REMARKS.
    17*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    18*    FOR THE LIFE CLAIM INTEREST SELECTION CRITERIA.
    19*
    20*    SCREENS     - EL612A - SELECTION CRITERIA
    21*
    22*    ENTERED BY  - EL605 - LIFE CLAIM INTEREST MENU
    23*
    24*    EXIT TO     - EL605 - LIFE CLAIM INTEREST MENU
    25*
    26*    COMMAREA    - PASSED
    27*
    28*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL101.  ON
    29*                  FIRST ENTRY, A SKELETON SCREEN IS SENT AND THE
    30*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    31*                  ENTRIES (XCTL FROM CICS VIA EX  ) THE SCREEN
    32*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    33*                  MAINTENANCE TYPE INDICATED.
    34******************************************************************
    35*                   C H A N G E   L O G
    36*
    37* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    38*-----------------------------------------------------------------
    39*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    40* EFFECTIVE    NUMBER
    41*-----------------------------------------------------------------
    42* 052605    2004040700004  PEMA  NEW PROGRAM
    43* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
    44******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL612.cbl
    46 ENVIRONMENT DIVISION.
    47 DATA DIVISION.
    48 WORKING-STORAGE SECTION.
    49 01  DFH-START PIC X(04).
    50 77  FILLER  PIC X(32)  VALUE '********************************'.
    51 77  FILLER  PIC X(32)  VALUE '*   EL612  WORKING STORAGE     *'.
    52 77  FILLER  PIC X(32)  VALUE '***********VMOD=2.001 **********'.
    53 77  CI1                PIC S999  COMP-3 VALUE +0.
    54 77  B1                 PIC S999  COMP-3 VALUE +0.
    55*    COPY ELCSCTM.
    56******************************************************************
    57*                                                                *
    58*                                                                *
    59*                            ELCSCTM                             *
    60*                            VMOD=2.001                          *
    61*                                                                *
    62*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    63*                                                                *
    64******************************************************************
    65 01  SECURITY-MESSAGE.
    66     12  FILLER                          PIC X(30)
    67            VALUE '** LOGIC SECURITY VIOLATION -'.
    68     12  SM-READ                         PIC X(6).
    69     12  FILLER                          PIC X(5)
    70            VALUE ' PGM='.
    71     12  SM-PGM                          PIC X(6).
    72     12  FILLER                          PIC X(5)
    73            VALUE ' OPR='.
    74     12  SM-PROCESSOR-ID                 PIC X(4).
    75     12  FILLER                          PIC X(6)
    76            VALUE ' TERM='.
    77     12  SM-TERMID                       PIC X(4).
    78     12  FILLER                          PIC XX   VALUE SPACE.
    79     12  SM-JUL-DATE                     PIC 9(5).
    80     12  FILLER                          PIC X    VALUE SPACE.
    81     12  SM-TIME                         PIC 99.99.
    82
    83*    COPY ELCSCRTY.
    84******************************************************************
    85*                                                                *
    86*                                                                *
    87*                            ELCSCRTY                            *
    88*                            VMOD=2.001                          *
    89*                                                                *
    90*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    91*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    92*        SAVED IN PI-SECURITY-ADDRESS.                           *
    93*                                                                *
    94******************************************************************
    95 01  SECURITY-CONTROL.
    96     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    97     12  FILLER                       PIC XX    VALUE 'SC'.
    98     12  SC-CREDIT-CODES.
    99         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   100             20  SC-CREDIT-DISPLAY    PIC X.
   101             20  SC-CREDIT-UPDATE     PIC X.
   102     12  SC-CLAIMS-CODES.
   103         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL612.cbl
   104             20  SC-CLAIMS-DISPLAY    PIC X.
   105             20  SC-CLAIMS-UPDATE     PIC X.
   106 01  WS-DATE-AREA.
   107     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
   108     05  SAVE-BIN-DATE       PIC X(2)    VALUE SPACES.
   109 01  WS-INC-DATE                 PIC XX  VALUE LOW-VALUES.
   110 01  WS-RPT-DATE                 PIC XX  VALUE LOW-VALUES.
   111 01  WS-EST-DATE                 PIC XX  VALUE LOW-VALUES.
   112 01  WS-PRF-DATE                 PIC XX  VALUE LOW-VALUES.
   113 01  WS-EFF-DATE                 PIC XX  VALUE LOW-VALUES.
   114 01  WS-LSTPD-DATE               PIC XX  VALUE LOW-VALUES.
   115 01  FILLER                          COMP-3.
   116     05  WS-RECORD-COUNT             PIC S9(3)   VALUE ZERO.
   117     05  WS-READNEXT-SW              PIC S9      VALUE ZERO.
   118     05  WS-LAST-ERROR-COUNT         PIC S9(3)   VALUE ZERO.
   119     05  WS-UPDATE-SW                PIC S9      VALUE ZERO.
   120     05  WS-COMPLETED-SUCCESSFUL     PIC S9      VALUE ZERO.
   121       88  TRANSACTION-SUCCESSFUL                    VALUE +1.
   122       88  INITIAL-TRANSACTION                       VALUE +2.
   123       88  CHANGE-SUCCESSFUL                         VALUE +3.
   124     05  TIME-IN                     PIC S9(7)   VALUE ZERO.
   125     05  TIME-OUT                    REDEFINES
   126         TIME-IN                     PIC S9(3)V9(4).
   127 01  FILLER                          COMP SYNC.
   128     05  WS-INDEX                    PIC S9(4)   VALUE ZERO.
   129     05  WS-JOURNAL-FILE-ID          PIC S9(4)   VALUE +1.
   130     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +773.
   131     05  ELCISC-LENGTH               PIC S9(4)   VALUE +100.
   132     05  GETMAIN-SPACE               PIC  X      VALUE SPACE.
   133 01  FILLER.
   134     12  DEEDIT-FIELD        PIC  X(10).
   135     12  DEEDIT-FIELD-V0  REDEFINES
   136         DEEDIT-FIELD        PIC S9(10).
   137     12  DEEDIT-FIELD-V2  REDEFINES
   138         DEEDIT-FIELD        PIC 9(8)V99.
   139     05  WS-BIN-DATES OCCURS 10.
   140         10  WS-BIN-DATE         PIC XX.
   141     05  WS-RESPONSE             PIC S9(8)   COMP.
   142         88  RESP-NORMAL              VALUE +00.
   143         88  RESP-ERROR               VALUE +01.
   144         88  RESP-NOTFND              VALUE +13.
   145         88  RESP-NOTOPEN             VALUE +19.
   146         88  RESP-ENDFILE             VALUE +20.
   147     05  WS-CONTROL-PRIMARY.
   148         10  WS-COMPANY-CD           PIC X      VALUE SPACES.
   149         10  WS-STATE                PIC XX     VALUE SPACES.
   150         10  WS-PROD                 PIC XX     VALUE SPACES.
   151         10  WS-COV-TYPE             PIC XX     VALUE SPACES.
   152     05  WS-CONTROL-FILE-KEY.
   153         10  WS-CFK-COMPANY-ID       PIC X(3)    VALUE SPACES.
   154         10  WS-CFK-RECORD-TYPE      PIC X       VALUE SPACES.
   155         10  WS-CFK-STATE            PIC XX      VALUE SPACES.
   156         10  WS-CFK-BENEFIT-CD       PIC XX      VALUE SPACES.
   157         10  WS-CFK-SEQUENCE-NO      PIC S9(4)   VALUE ZERO COMP.
   158     05  WS-MAPSET-NAME              PIC X(8)  VALUE 'EL612S'.
   159     05  WS-MAP-NAME                 PIC X(8)  VALUE 'EL612A'.
   160     05  FILLER                      REDEFINES
   161         WS-MAP-NAME.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL612.cbl
   162         10  FILLER                  PIC XX.
   163         10  WS-MAP-NUMBER           PIC X(4).
   164         10  FILLER                  PIC XX.
   165     05  THIS-PGM                    PIC X(8)  VALUE 'EL612'.
   166     05  WS-JOURNAL-TYPE-ID          PIC XX      VALUE 'EL'.
   167     05  WS-LOW-VALUES               PIC X VALUE LOW-VALUES.
   168     05  WS-SPACE                    PIC X       VALUE SPACE.
   169     05  WS-TRANS-ID                 PIC X(4)    VALUE 'EXAG'.
   170     05  WS-TEMP-STORAGE-KEY.
   171         10  WS-TS-TERM-ID           PIC X(4)    VALUE 'XXXX'.
   172         10  FILLER                  PIC X(4)    VALUE '612'.
   173     05  WS-ERROR-MESSAGE-AREA.
   174         10  ER-0000                 PIC 9(4)   VALUE 0000.
   175         10  ER-0004                 PIC 9(4)   VALUE 0004.
   176         10  ER-0006                 PIC 9(4)   VALUE 0006.
   177         10  ER-0008                 PIC 9(4)   VALUE 0008.
   178         10  ER-0023                 PIC 9(4)   VALUE 0023.
   179         10  ER-0029                 PIC 9(4)   VALUE 0029.
   180         10  ER-0070                 PIC 9(4)   VALUE 0070.
   181         10  ER-0150                 PIC 9(4)   VALUE 0150.
   182         10  ER-0196                 PIC 9(4)   VALUE 0196.
   183         10  ER-0419                 PIC 9(4)   VALUE 0419.
   184         10  ER-0491                 PIC 9(4)   VALUE 0491.
   185         10  ER-1079                 PIC 9(4)   VALUE 1079.
   186         10  ER-1257                 PIC 9(4)   VALUE 1257.
   187         10  ER-1258                 PIC 9(4)   VALUE 1258.
   188         10  ER-2261                 PIC 9(4)   VALUE 2261.
   189         10  ER-3800                 PIC 9(4)   VALUE 3800.
   190         10  ER-3801                 PIC 9(4)   VALUE 3801.
   191         10  ER-3802                 PIC 9(4)   VALUE 3802.
   192         10  ER-3803                 PIC 9(4)   VALUE 3803.
   193         10  ER-3804                 PIC 9(4)   VALUE 3804.
   194         10  ER-3805                 PIC 9(4)   VALUE 3805.
   195         10  ER-3806                 PIC 9(4)   VALUE 3806.
   196         10  ER-3807                 PIC 9(4)   VALUE 3807.
   197         10  ER-3810                 PIC 9(4)   VALUE 3810.
   198         10  ER-3811                 PIC 9(4)   VALUE 3811.
   199         10  ER-3812                 PIC 9(4)   VALUE 3812.
   200         10  ER-3813                 PIC 9(4)   VALUE 3813.
   201         10  ER-3814                 PIC 9(4)   VALUE 3814.
   202         10  ER-3815                 PIC 9(4)   VALUE 3815.
   203         10  ER-3816                 PIC 9(4)   VALUE 3816.
   204         10  ER-3817                 PIC 9(4)   VALUE 3817.
   205         10  ER-3818                 PIC 9(4)   VALUE 3818.
   206         10  ER-3819                 PIC 9(4)   VALUE 3819.
   207         10  ER-7220                 PIC 9(4)   VALUE 7220.
   208         10  ER-7698                 PIC 9(4)   VALUE 7698.
   209         10  ER-9999                 PIC 9(4)   VALUE 9999.
   210*                                COPY ELCINTF.
   211******************************************************************
   212*                                                                *
   213*                                                                *
   214*                            ELCINTF.                            *
   215*                            VMOD=2.017                          *
   216*                                                                *
   217*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   218*                                                                *
   219*       LENGTH = 1024                                            *
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL612.cbl
   220*                                                                *
   221******************************************************************
   222 01  PROGRAM-INTERFACE-BLOCK.
   223     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   224     12  PI-CALLING-PROGRAM              PIC X(8).
   225     12  PI-SAVED-PROGRAM-1              PIC X(8).
   226     12  PI-SAVED-PROGRAM-2              PIC X(8).
   227     12  PI-SAVED-PROGRAM-3              PIC X(8).
   228     12  PI-SAVED-PROGRAM-4              PIC X(8).
   229     12  PI-SAVED-PROGRAM-5              PIC X(8).
   230     12  PI-SAVED-PROGRAM-6              PIC X(8).
   231     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   232     12  PI-COMPANY-ID                   PIC XXX.
   233     12  PI-COMPANY-CD                   PIC X.
   234
   235     12  PI-COMPANY-PASSWORD             PIC X(8).
   236
   237     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   238
   239     12  PI-CONTROL-IN-PROGRESS.
   240         16  PI-CARRIER                  PIC X.
   241         16  PI-GROUPING                 PIC X(6).
   242         16  PI-STATE                    PIC XX.
   243         16  PI-ACCOUNT                  PIC X(10).
   244         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   245                                         PIC X(10).
   246         16  PI-CLAIM-CERT-GRP.
   247             20  PI-CLAIM-NO             PIC X(7).
   248             20  PI-CERT-NO.
   249                 25  PI-CERT-PRIME       PIC X(10).
   250                 25  PI-CERT-SFX         PIC X.
   251             20  PI-CERT-EFF-DT          PIC XX.
   252         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   253             20  PI-PLAN-CODE            PIC X(2).
   254             20  PI-REVISION-NUMBER      PIC X(3).
   255             20  PI-PLAN-EFF-DT          PIC X(2).
   256             20  PI-PLAN-EXP-DT          PIC X(2).
   257             20  FILLER                  PIC X(11).
   258         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   259             20  PI-OE-REFERENCE-1.
   260                 25  PI-OE-REF-1-PRIME   PIC X(18).
   261                 25  PI-OE-REF-1-SUFF    PIC XX.
   262
   263     12  PI-SESSION-IN-PROGRESS          PIC X.
   264         88  CLAIM-SESSION                   VALUE '1'.
   265         88  CREDIT-SESSION                  VALUE '2'.
   266         88  WARRANTY-SESSION                VALUE '3'.
   267         88  MORTGAGE-SESSION                VALUE '4'.
   268         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   269
   270
   271*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   272
   273     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   274     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   275
   276     12  PI-CREDIT-USER                  PIC X.
   277         88  PI-NOT-CREDIT-USER              VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL612.cbl
   278         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   279
   280     12  PI-CLAIM-USER                   PIC X.
   281         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   282         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   283
   284     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   285         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   286         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   287         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   288         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   289         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   290
   291     12  PI-PROCESSOR-ID                 PIC X(4).
   292
   293     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   294
   295     12  PI-MEMBER-CAPTION               PIC X(10).
   296
   297     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   298         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   299
   300     12  PI-LIFE-OVERRIDE-L1             PIC X.
   301     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   302     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   303     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   304
   305     12  PI-AH-OVERRIDE-L1               PIC X.
   306     12  PI-AH-OVERRIDE-L2               PIC XX.
   307     12  PI-AH-OVERRIDE-L6               PIC X(6).
   308     12  PI-AH-OVERRIDE-L12              PIC X(12).
   309
   310     12  PI-NEW-SYSTEM                   PIC X(2).
   311
   312     12  PI-PRIMARY-CERT-NO              PIC X(11).
   313     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   314         88  PI-USES-PAID-TO                 VALUE '1'.
   315     12  PI-CRDTCRD-SYSTEM.
   316         16  PI-CRDTCRD-USER             PIC X.
   317             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   318             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   319         16  PI-CC-MONTH-END-DT          PIC XX.
   320     12  PI-PROCESSOR-PRINTER            PIC X(4).
   321
   322     12  PI-OE-REFERENCE-2.
   323         16  PI-OE-REF-2-PRIME           PIC X(10).
   324         16  PI-OE-REF-2-SUFF            PIC X.
   325
   326     12  PI-REM-TRM-CALC-OPTION          PIC X.
   327
   328     12  PI-LANGUAGE-TYPE                PIC X.
   329             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   330             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   331             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   332
   333     12  PI-POLICY-LINKAGE-IND           PIC X.
   334         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   335         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL612.cbl
   336                                                   LOW-VALUES.
   337
   338     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   339     12  PI-CLAIM-PW-SESSION             PIC X(1).
   340         88  PI-CLAIM-CREDIT                 VALUE '1'.
   341         88  PI-CLAIM-CONVEN                 VALUE '2'.
   342     12  FILLER                          PIC X(4).
   343
   344     12  PI-SYSTEM-LEVEL                 PIC X(145).
   345
   346     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   347         PI-SYSTEM-LEVEL.
   348
   349         16  PI-ENTRY-CODES.
   350             20  PI-ENTRY-CD-1           PIC X.
   351             20  PI-ENTRY-CD-2           PIC X.
   352
   353         16  PI-RETURN-CODES.
   354             20  PI-RETURN-CD-1          PIC X.
   355             20  PI-RETURN-CD-2          PIC X.
   356
   357         16  PI-UPDATE-STATUS-SAVE.
   358             20  PI-UPDATE-BY            PIC X(4).
   359             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   360
   361         16  PI-LOWER-CASE-LETTERS       PIC X.
   362             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   363
   364*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   365*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   366*            88  CARRIER-CLM-CNTL            VALUE '2'.
   367
   368         16  PI-CERT-ACCESS-CONTROL      PIC X.
   369             88  ST-ACCNT-CNTL               VALUE ' '.
   370             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   371             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   372             88  ACCNT-CNTL                  VALUE '3'.
   373             88  CARR-ACCNT-CNTL             VALUE '4'.
   374
   375         16  PI-PROCESSOR-CAP-LIST.
   376             20  PI-SYSTEM-CONTROLS.
   377                24 PI-SYSTEM-DISPLAY     PIC X.
   378                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   379                24 PI-SYSTEM-MODIFY      PIC X.
   380                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   381             20  FILLER                  PIC XX.
   382             20  PI-DISPLAY-CAP          PIC X.
   383                 88  DISPLAY-CAP             VALUE 'Y'.
   384             20  PI-MODIFY-CAP           PIC X.
   385                 88  MODIFY-CAP              VALUE 'Y'.
   386             20  PI-MSG-AT-LOGON-CAP     PIC X.
   387                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   388             20  PI-FORCE-CAP            PIC X.
   389                 88  FORCE-CAP               VALUE 'Y'.
   390
   391         16  PI-PROGRAM-CONTROLS.
   392             20  PI-PGM-PRINT-OPT        PIC X.
   393             20  PI-PGM-FORMAT-OPT       PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL612.cbl
   394             20  PI-PGM-PROCESS-OPT      PIC X.
   395             20  PI-PGM-TOTALS-OPT       PIC X.
   396
   397         16  PI-HELP-INTERFACE.
   398             20  PI-LAST-ERROR-NO        PIC X(4).
   399             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   400
   401         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   402             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   403
   404         16  PI-CR-CONTROL-IN-PROGRESS.
   405             20  PI-CR-CARRIER           PIC X.
   406             20  PI-CR-GROUPING          PIC X(6).
   407             20  PI-CR-STATE             PIC XX.
   408             20  PI-CR-ACCOUNT           PIC X(10).
   409             20  PI-CR-FIN-RESP          PIC X(10).
   410             20  PI-CR-TYPE              PIC X.
   411
   412         16  PI-CR-BATCH-NUMBER          PIC X(6).
   413
   414         16  PI-CR-MONTH-END-DT          PIC XX.
   415
   416         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   417             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   418             88  PI-ZERO-CARRIER             VALUE '1'.
   419             88  PI-ZERO-GROUPING            VALUE '2'.
   420             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   421
   422         16  PI-CARRIER-SECURITY         PIC X.
   423             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   424
   425         16  PI-ACCOUNT-SECURITY         PIC X(10).
   426             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   427             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   428
   429         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   430             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   431                                         INDEXED BY PI-ACCESS-NDX
   432                                         PIC X.
   433
   434         16  PI-GA-BILLING-CONTROL       PIC X.
   435             88  PI-GA-BILLING               VALUE '1'.
   436
   437         16  PI-MAIL-PROCESSING          PIC X.
   438             88  PI-MAIL-YES                 VALUE 'Y'.
   439
   440         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   441
   442         16  PI-AR-SYSTEM.
   443             20  PI-AR-PROCESSING-CNTL   PIC X.
   444                 88  PI-AR-PROCESSING        VALUE 'Y'.
   445             20  PI-AR-SUMMARY-CODE      PIC X(6).
   446             20  PI-AR-MONTH-END-DT      PIC XX.
   447
   448         16  PI-MP-SYSTEM.
   449             20  PI-MORTGAGE-USER            PIC X.
   450                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   451                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL612.cbl
   452             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   453                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   454                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   455                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   456                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   457                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   458             20  PI-MP-MONTH-END-DT          PIC XX.
   459             20  PI-MP-REFERENCE-NO.
   460                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   461                 24  PI-MP-REFERENCE-SFX     PIC XX.
   462
   463         16  PI-LABEL-CONTROL            PIC X(01).
   464             88  PI-CREATE-LABELS                    VALUE 'Y'.
   465             88  PI-BYPASS-LABELS                    VALUE 'N'.
   466
   467         16  PI-BILL-GROUPING-CODE       PIC X(01).
   468             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   469
   470         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   471             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   472             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   473
   474         16  FILLER                      PIC X(14).
   475
   476     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   477******************************************************************
   478     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   479         16  PI-1ST-TIME-SW          PIC S9     COMP-3.
   480         16  PI-MODE                 PIC X.
   481             88  ADD-FUNCTION         VALUE 'A'.
   482         16  PI-CI-STATE             PIC XX.
   483         16  PI-CI-PROD              PIC XX.
   484         16  PI-CI-COV-TYPE          PIC XX.
   485         16  PI-CI-TOP-KEY           PIC X(7).
   486         16  PI-CI-BOT-KEY           PIC X(7).
   487         16  PI-CI-KEYS OCCURS 10.
   488             20  PI-CI-KEY           PIC X(7).
   489         16  PI-LAST-BENEFIT-NUMBER  PIC XX.
   490         16  PI-NEXT-BENEFIT-NUMBER  PIC XX.
   491         16  PI-LINE-COUNT           PIC S9(3)  COMP-3.
   492         16  PI-BROWSE-SW            PIC S9     COMP-3.
   493         16  PI-SHOW-SW              PIC S9     COMP-3.
   494         16  PI-CHANGE-SW            PIC S9     COMP-3.
   495         16  PI-UPDATE-KEY           PIC X(10).
   496         16  FILLER                  PIC X(553).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL612.cbl
   498*                                COPY EL612S.
   499 01  EL612AI.
   500     05  FILLER            PIC  X(0012).
   501*    -------------------------------
   502     05  ADATEL PIC S9(0004) COMP.
   503     05  ADATEF PIC  X(0001).
   504     05  FILLER REDEFINES ADATEF.
   505         10  ADATEA PIC  X(0001).
   506     05  ADATEI PIC  X(0008).
   507*    -------------------------------
   508     05  ATIMEL PIC S9(0004) COMP.
   509     05  ATIMEF PIC  X(0001).
   510     05  FILLER REDEFINES ATIMEF.
   511         10  ATIMEA PIC  X(0001).
   512     05  ATIMEI PIC  X(0005).
   513*    -------------------------------
   514     05  STATEL PIC S9(0004) COMP.
   515     05  STATEF PIC  X(0001).
   516     05  FILLER REDEFINES STATEF.
   517         10  STATEA PIC  X(0001).
   518     05  STATEI PIC  X(0002).
   519*    -------------------------------
   520     05  ZINTRATL PIC S9(0004) COMP.
   521     05  ZINTRATF PIC  X(0001).
   522     05  FILLER REDEFINES ZINTRATF.
   523         10  ZINTRATA PIC  X(0001).
   524     05  ZINTRATI PIC  999V9(5).
   525*    -------------------------------
   526     05  PRODL PIC S9(0004) COMP.
   527     05  PRODF PIC  X(0001).
   528     05  FILLER REDEFINES PRODF.
   529         10  PRODA PIC  X(0001).
   530     05  PRODI PIC  X(0002).
   531*    -------------------------------
   532     05  COVL PIC S9(0004) COMP.
   533     05  COVF PIC  X(0001).
   534     05  FILLER REDEFINES COVF.
   535         10  COVA PIC  X(0001).
   536     05  COVI PIC  X(0002).
   537*    -------------------------------
   538     05  INCDTL PIC S9(0004) COMP.
   539     05  INCDTF PIC  X(0001).
   540     05  FILLER REDEFINES INCDTF.
   541         10  INCDTA PIC  X(0001).
   542     05  INCDTI PIC  X(0010).
   543*    -------------------------------
   544     05  ESTDTL PIC S9(0004) COMP.
   545     05  ESTDTF PIC  X(0001).
   546     05  FILLER REDEFINES ESTDTF.
   547         10  ESTDTA PIC  X(0001).
   548     05  ESTDTI PIC  X(0010).
   549*    -------------------------------
   550     05  LSTPDDTL PIC S9(0004) COMP.
   551     05  LSTPDDTF PIC  X(0001).
   552     05  FILLER REDEFINES LSTPDDTF.
   553         10  LSTPDDTA PIC  X(0001).
   554     05  LSTPDDTI PIC  X(0010).
   555*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL612.cbl
   556     05  RPTDTL PIC S9(0004) COMP.
   557     05  RPTDTF PIC  X(0001).
   558     05  FILLER REDEFINES RPTDTF.
   559         10  RPTDTA PIC  X(0001).
   560     05  RPTDTI PIC  X(0010).
   561*    -------------------------------
   562     05  PRFDTL PIC S9(0004) COMP.
   563     05  PRFDTF PIC  X(0001).
   564     05  FILLER REDEFINES PRFDTF.
   565         10  PRFDTA PIC  X(0001).
   566     05  PRFDTI PIC  X(0010).
   567*    -------------------------------
   568     05  EFFDTL PIC S9(0004) COMP.
   569     05  EFFDTF PIC  X(0001).
   570     05  FILLER REDEFINES EFFDTF.
   571         10  EFFDTA PIC  X(0001).
   572     05  EFFDTI PIC  X(0010).
   573*    -------------------------------
   574     05  CLMAMTL PIC S9(0004) COMP.
   575     05  CLMAMTF PIC  X(0001).
   576     05  FILLER REDEFINES CLMAMTF.
   577         10  CLMAMTA PIC  X(0001).
   578     05  CLMAMTI PIC  9(8)V99.
   579*    -------------------------------
   580     05  QUALL PIC S9(0004) COMP.
   581     05  QUALF PIC  X(0001).
   582     05  FILLER REDEFINES QUALF.
   583         10  QUALA PIC  X(0001).
   584     05  QUALI PIC  X(0001).
   585*    -------------------------------
   586     05  INTAMTL PIC S9(0004) COMP.
   587     05  INTAMTF PIC  X(0001).
   588     05  FILLER REDEFINES INTAMTF.
   589         10  INTAMTA PIC  X(0001).
   590     05  INTAMTI PIC  X(0010).
   591*    -------------------------------
   592     05  INTRATL PIC S9(0004) COMP.
   593     05  INTRATF PIC  X(0001).
   594     05  FILLER REDEFINES INTRATF.
   595         10  INTRATA PIC  X(0001).
   596     05  INTRATI PIC  X(0008).
   597*    -------------------------------
   598     05  NODAYSL PIC S9(0004) COMP.
   599     05  NODAYSF PIC  X(0001).
   600     05  FILLER REDEFINES NODAYSF.
   601         10  NODAYSA PIC  X(0001).
   602     05  NODAYSI PIC  X(0005).
   603*    -------------------------------
   604     05  AEMSG1L PIC S9(0004) COMP.
   605     05  AEMSG1F PIC  X(0001).
   606     05  FILLER REDEFINES AEMSG1F.
   607         10  AEMSG1A PIC  X(0001).
   608     05  AEMSG1I PIC  X(0079).
   609*    -------------------------------
   610     05  AEMSG2L PIC S9(0004) COMP.
   611     05  AEMSG2F PIC  X(0001).
   612     05  FILLER REDEFINES AEMSG2F.
   613         10  AEMSG2A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL612.cbl
   614     05  AEMSG2I PIC  X(0079).
   615*    -------------------------------
   616     05  APFKL PIC S9(0004) COMP.
   617     05  APFKF PIC  X(0001).
   618     05  FILLER REDEFINES APFKF.
   619         10  APFKA PIC  X(0001).
   620     05  APFKI PIC  S99.
   621 01  EL612AO REDEFINES EL612AI.
   622     05  FILLER            PIC  X(0012).
   623*    -------------------------------
   624     05  FILLER            PIC  X(0003).
   625     05  ADATEO PIC  X(0008).
   626*    -------------------------------
   627     05  FILLER            PIC  X(0003).
   628     05  ATIMEO PIC  99.99.
   629*    -------------------------------
   630     05  FILLER            PIC  X(0003).
   631     05  STATEO PIC  X(0002).
   632*    -------------------------------
   633     05  FILLER            PIC  X(0003).
   634     05  ZINTRATO PIC  ZZ.99999.
   635*    -------------------------------
   636     05  FILLER            PIC  X(0003).
   637     05  PRODO PIC  X(0002).
   638*    -------------------------------
   639     05  FILLER            PIC  X(0003).
   640     05  COVO PIC  X(0002).
   641*    -------------------------------
   642     05  FILLER            PIC  X(0003).
   643     05  INCDTO PIC  X(0010).
   644*    -------------------------------
   645     05  FILLER            PIC  X(0003).
   646     05  ESTDTO PIC  X(0010).
   647*    -------------------------------
   648     05  FILLER            PIC  X(0003).
   649     05  LSTPDDTO PIC  X(0010).
   650*    -------------------------------
   651     05  FILLER            PIC  X(0003).
   652     05  RPTDTO PIC  X(0010).
   653*    -------------------------------
   654     05  FILLER            PIC  X(0003).
   655     05  PRFDTO PIC  X(0010).
   656*    -------------------------------
   657     05  FILLER            PIC  X(0003).
   658     05  EFFDTO PIC  X(0010).
   659*    -------------------------------
   660     05  FILLER            PIC  X(0003).
   661     05  CLMAMTO PIC  ZZZ,ZZ9.99.
   662*    -------------------------------
   663     05  FILLER            PIC  X(0003).
   664     05  QUALO PIC  X(0001).
   665*    -------------------------------
   666     05  FILLER            PIC  X(0003).
   667     05  INTAMTO PIC  ZZZ,ZZ9.99.
   668*    -------------------------------
   669     05  FILLER            PIC  X(0003).
   670     05  INTRATO PIC  ZZ.99999.
   671*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL612.cbl
   672     05  FILLER            PIC  X(0003).
   673     05  NODAYSO PIC  Z,Z99.
   674*    -------------------------------
   675     05  FILLER            PIC  X(0003).
   676     05  AEMSG1O PIC  X(0079).
   677*    -------------------------------
   678     05  FILLER            PIC  X(0003).
   679     05  AEMSG2O PIC  X(0079).
   680*    -------------------------------
   681     05  FILLER            PIC  X(0003).
   682     05  APFKO PIC  X(0002).
   683*    -------------------------------
   684*                                COPY ELCICALC.
   685******************************************************************
   686*                                                                *
   687*                           ELCCICALC.                           *
   688*                            VMOD=2.001                          *
   689*                                                                *
   690*   DESCRIPTION:  DATA TO BE PASSED TO THE CLAIM INTEREST        *
   691*                 CALCULATION MODULE                             *
   692*                                                                *
   693*  PASSED TO ELCLMI                                              *
   694*  -----------------                                             *
   695*  STATE                                                         *
   696*  PRODUCT                                                       *
   697*  COVERAGE                                                      *
   698*  EFFECTIVE DATE                                                *
   699*  INCURRED DATE                                                 *
   700*  ESTABLISHED DATE                                              *
   701*  LAST PAID DATE                                                *
   702*  REPORTED DATE                                                 *
   703*  CLAIM PAYMENT AMOUNT                                          *
   704*                                                                *
   705*  RETURNED FROM ELRTRM                                          *
   706*  ---------------------                                         *
   707*  RETURN CODE                                                   *
   708*  CLAIM INTEREST DUE SWITCH Y/N                                 *
   709*  CLAIM INTEREST AMOUNT                                         *
   710*----------------------------------------------------------------*
   711*----------------------------------------------------------------*
   712*                 LENGTH = 100                                   *
   713*                                                                *
   714******************************************************************
   715******************************************************************
   716*                   C H A N G E   L O G
   717*
   718* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   719*-----------------------------------------------------------------
   720*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   721* EFFECTIVE    NUMBER
   722*-----------------------------------------------------------------
   723* 120905    2004040700004  PEMA  NEW COPYBOOK
   724* 060608    2008040300002  PEMA  ADD EFF DT TO ELCLMI PASS AREA
   725******************************************************************
   726
   727 01  CLAIM-INT-PASS-AREA.
   728     12  CP-CLAIM-LENGTH           PIC S9(4)         VALUE +100
   729                                     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL612.cbl
   730
   731     12  CI-RETURN-CODE            PIC X             VALUE ZERO.
   732       88  NO-CI-ERROR                             VALUE ZERO.
   733       88  CP-ERROR-OCCURED VALUE '1' '2' '3' '4' '5' '6' '7' '8'.
   734       88  CP-ERROR-IN-SEL-CRITERIA                VALUE '1'.
   735       88  CP-NOT-QUAL-LEVEL-1                     VALUE '2'.
   736       88  CP-NOT-QUAL-LEVEL-2                     VALUE '3'.
   737       88  CP-AMT-LT-5000                          VALUE '4'.
   738       88  CP-ERROR-IN-DATES                       VALUE '5'.
   739       88  CP-ERROR-IN-ST-BREAKOUT                 VALUE '6'.
   740       88  CP-ERROR-IN-SCHEDULES                   VALUE '7'.
   741       88  CP-INTEREST-RATE-IS-ZERO                VALUE '8'.
   742***********************  INPUT AREAS ****************************
   743
   744     12  CP-CALCULATION-AREA.
   745         16  CP-COMPANY-CD         PIC X.
   746         16  CP-STATE              PIC XX.
   747         16  CP-PRODUCT            PIC XX.
   748         16  CP-COVERAGE           PIC XX.
   749         16  CP-INC-DT             PIC XX.
   750         16  CP-EST-DT             PIC XX.
   751         16  CP-LSTPD-DT           PIC XX.
   752         16  CP-RPT-DT             PIC XX.
   753         16  CP-PRF-DT             PIC XX.
   754         16  CP-EFF-DT             PIC XX.
   755         16  CP-CLAIM-AMT          PIC S9(7)V99 COMP-3.
   756         16  CP-INT-RATE           PIC S99V9(5) COMP-3.
   757         16  FILLER                PIC X(37).
   758
   759***************    OUTPUT FROM ELCLMI   ************************
   760
   761         16  CP-CLM-INT-SW         PIC X         VALUE SPACES.
   762
   763         16  CP-CLM-INT-AMT        PIC S9(7)V99  VALUE +0 COMP-3.
   764         16  CP-CLM-INT-RATE       PIC S99V9(5)  VALUE +0 COMP-3.
   765         16  CP-CLM-INT-NODAYS     PIC S9(5)     VALUE +0 COMP-3.
   766         16  FILLER                PIC X(19).
   767******************************************************************
   768*                                COPY ELCJPFX.
   769******************************************************************
   770*                                                                *
   771*                                                                *
   772*                            ELCJPFX.                            *
   773*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   774*                            VMOD=2.002                          *
   775*                                                                *
   776*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   777*                                                                *
   778*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   779*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   780*        ELCNTL - CONTROL FILE                                   *
   781*        ELMSTR - CLAIM MASTERS                                  *
   782*        ELTRLR - ACTIVITY TRAILERS                              *
   783*        ELCHKQ - CHECK QUE                                      *
   784******************************************************************
   785 01  JOURNAL-RECORD.
   786     12  JP-USER-ID                  PIC X(4).
   787     12  JP-FILE-ID                  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL612.cbl
   788     12  JP-PROGRAM-ID               PIC X(8).
   789     12  JP-RECORD-TYPE              PIC X.
   790         88 JP-ADD              VALUE 'A'.
   791         88 JP-BEFORE-CHANGE    VALUE 'B'.
   792         88 JP-AFTER-CHANGE     VALUE 'C'.
   793         88 JP-DELETE           VALUE 'D'.
   794         88 JP-GENERIC-DELETE   VALUE 'G'.
   795         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   796         88 JP-KEY-CHG-ADD      VALUE 'N'.
   797     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   798     12  JP-RECORD-AREA
   799
   800
   801                                 PIC X(750).
   802*                                COPY ELCEMIB.
   803******************************************************************
   804*                                                                *
   805*                                                                *
   806*                            ELCEMIB.                            *
   807*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   808*                            VMOD=2.005                          *
   809*                                                                *
   810*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   811*                                                                *
   812******************************************************************
   813 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   814     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   815     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   816     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   817     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   818     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   819     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   820     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   821     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   822     12  EMI-SWITCH1             PIC X        VALUE '1'.
   823         88  EMI-NO-ERRORS                    VALUE '1'.
   824         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   825         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   826     12  EMI-SWITCH2             PIC X        VALUE '1'.
   827         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   828     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   829         88  EMI-AREA1-EMPTY                  VALUE '1'.
   830         88  EMI-AREA1-FULL                   VALUE '2'.
   831     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   832         88  EMI-AREA2-EMPTY                  VALUE '1'.
   833         88  EMI-AREA2-FULL                   VALUE '2'.
   834     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   835         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   836         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   837         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   838         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   839         88  EMI-BYPASS-FATALS                VALUE 'X'.
   840     12  EMI-ERROR-LINES.
   841         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   842         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   843         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   844         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   845             20  EMI-ERR-CODES OCCURS 10 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL612.cbl
   846                 24  EMI-ERR-NUM         PIC X(4).
   847                 24  EMI-FILLER          PIC X.
   848                 24  EMI-SEV             PIC X.
   849                 24  FILLER              PIC X.
   850             20  FILLER                  PIC X(02).
   851     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   852         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   853             20  EMI-ERROR-NUMBER    PIC X(4).
   854             20  EMI-FILL            PIC X.
   855             20  EMI-SEVERITY        PIC X.
   856             20  FILLER              PIC X.
   857             20  EMI-ERROR-TEXT.
   858                 24  EMI-TEXT-VARIABLE   PIC X(10).
   859                 24  FILLER          PIC X(55).
   860     12  EMI-SEVERITY-SAVE           PIC X.
   861         88  EMI-NOTE                    VALUE 'N'.
   862         88  EMI-WARNING                 VALUE 'W'.
   863         88  EMI-FORCABLE                VALUE 'F'.
   864         88  EMI-FATAL                   VALUE 'X'.
   865     12  EMI-MESSAGE-FLAG            PIC X.
   866         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   867         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   868     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   869     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   870         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   871         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   872         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   873     12  FILLER                      PIC X(137)  VALUE SPACES.
   874     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   875     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   876     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   877     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   878*                                COPY ELCDATE.
   879******************************************************************
   880*                                                                *
   881*                                                                *
   882*                            ELCDATE.                            *
   883*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   884*                            VMOD=2.003
   885*                                                                *
   886*                                                                *
   887*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   888*                 LENGTH = 200                                   *
   889******************************************************************
   890
   891 01  DATE-CONVERSION-DATA.
   892     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   893     12  DC-OPTION-CODE                PIC X.
   894         88  BIN-TO-GREG                VALUE ' '.
   895         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   896         88  EDIT-GREG-TO-BIN           VALUE '2'.
   897         88  YMD-GREG-TO-BIN            VALUE '3'.
   898         88  MDY-GREG-TO-BIN            VALUE '4'.
   899         88  JULIAN-TO-BIN              VALUE '5'.
   900         88  BIN-PLUS-ELAPSED           VALUE '6'.
   901         88  FIND-CENTURY               VALUE '7'.
   902         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   903         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL612.cbl
   904         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   905         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   906         88  JULIAN-TO-BIN-3            VALUE 'C'.
   907         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   908         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   909         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   910         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   911         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   912         88  CHECK-LEAP-YEAR            VALUE 'H'.
   913         88  BIN-3-TO-GREG              VALUE 'I'.
   914         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   915         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   916         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   917         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   918         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   919         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   920         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   921         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   922         88  THREE-CHARACTER-BIN
   923                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   924         88  GREGORIAN-TO-BIN
   925                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   926         88  BIN-TO-GREGORIAN
   927                  VALUES ' ' '1' 'I' '8' 'G'.
   928         88  JULIAN-TO-BINARY
   929                  VALUES '5' 'C' 'E' 'F'.
   930     12  DC-ERROR-CODE                 PIC X.
   931         88  NO-CONVERSION-ERROR        VALUE ' '.
   932         88  DATE-CONVERSION-ERROR
   933                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   934         88  DATE-IS-ZERO               VALUE '1'.
   935         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   936         88  DATE-IS-INVALID            VALUE '3'.
   937         88  DATE1-GREATER-DATE2        VALUE '4'.
   938         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   939         88  DATE-INVALID-OPTION        VALUE '9'.
   940         88  INVALID-CENTURY            VALUE 'A'.
   941         88  ONLY-CENTURY               VALUE 'B'.
   942         88  ONLY-LEAP-YEAR             VALUE 'C'.
   943         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   944     12  DC-END-OF-MONTH               PIC X.
   945         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   946     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   947         88  USE-NORMAL-PROCESS         VALUE ' '.
   948         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   949         88  ADJUST-UP-100-YRS          VALUE '2'.
   950     12  FILLER                        PIC X.
   951     12  DC-CONVERSION-DATES.
   952         16  DC-BIN-DATE-1             PIC XX.
   953         16  DC-BIN-DATE-2             PIC XX.
   954         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   955         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   956                       DC-GREG-DATE-1-EDIT.
   957             20  DC-EDIT1-MONTH        PIC 99.
   958             20  SLASH1-1              PIC X.
   959             20  DC-EDIT1-DAY          PIC 99.
   960             20  SLASH1-2              PIC X.
   961             20  DC-EDIT1-YEAR         PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL612.cbl
   962         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   963         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   964                     DC-GREG-DATE-2-EDIT.
   965             20  DC-EDIT2-MONTH        PIC 99.
   966             20  SLASH2-1              PIC X.
   967             20  DC-EDIT2-DAY          PIC 99.
   968             20  SLASH2-2              PIC X.
   969             20  DC-EDIT2-YEAR         PIC 99.
   970         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   971         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   972                     DC-GREG-DATE-1-YMD.
   973             20  DC-YMD-YEAR           PIC 99.
   974             20  DC-YMD-MONTH          PIC 99.
   975             20  DC-YMD-DAY            PIC 99.
   976         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   977         16  DC-GREG-DATE-1-MDY-R REDEFINES
   978                      DC-GREG-DATE-1-MDY.
   979             20  DC-MDY-MONTH          PIC 99.
   980             20  DC-MDY-DAY            PIC 99.
   981             20  DC-MDY-YEAR           PIC 99.
   982         16  DC-GREG-DATE-1-ALPHA.
   983             20  DC-ALPHA-MONTH        PIC X(10).
   984             20  DC-ALPHA-DAY          PIC 99.
   985             20  FILLER                PIC XX.
   986             20  DC-ALPHA-CENTURY.
   987                 24 DC-ALPHA-CEN-N     PIC 99.
   988             20  DC-ALPHA-YEAR         PIC 99.
   989         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   990         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   991         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   992         16  DC-JULIAN-DATE            PIC 9(05).
   993         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   994                                       PIC 9(05).
   995         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   996             20  DC-JULIAN-YEAR        PIC 99.
   997             20  DC-JULIAN-DAYS        PIC 999.
   998         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   999         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1000         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1001     12  DATE-CONVERSION-VARIBLES.
  1002         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1003         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1004             20  FILLER                PIC 9(3).
  1005             20  HOLD-CEN-1-CCYY.
  1006                 24  HOLD-CEN-1-CC     PIC 99.
  1007                 24  HOLD-CEN-1-YY     PIC 99.
  1008             20  HOLD-CEN-1-MO         PIC 99.
  1009             20  HOLD-CEN-1-DA         PIC 99.
  1010         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1011             20  HOLD-CEN-1-R-MO       PIC 99.
  1012             20  HOLD-CEN-1-R-DA       PIC 99.
  1013             20  HOLD-CEN-1-R-CCYY.
  1014                 24  HOLD-CEN-1-R-CC   PIC 99.
  1015                 24  HOLD-CEN-1-R-YY   PIC 99.
  1016             20  FILLER                PIC 9(3).
  1017         16  HOLD-CENTURY-1-X.
  1018             20  FILLER                PIC X(3)  VALUE SPACES.
  1019             20  HOLD-CEN-1-X-CCYY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL612.cbl
  1020                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1021                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1022             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1023             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1024         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1025             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1026             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1027             20  HOLD-CEN-1-R-X-CCYY.
  1028                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1029                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1030             20  FILLER                PIC XXX.
  1031         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1032         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1033         16  DC-JULIAN-DATE-1          PIC 9(07).
  1034         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1035             20  DC-JULIAN-1-CCYY.
  1036                 24  DC-JULIAN-1-CC    PIC 99.
  1037                 24  DC-JULIAN-1-YR    PIC 99.
  1038             20  DC-JULIAN-DA-1        PIC 999.
  1039         16  DC-JULIAN-DATE-2          PIC 9(07).
  1040         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1041             20  DC-JULIAN-2-CCYY.
  1042                 24  DC-JULIAN-2-CC    PIC 99.
  1043                 24  DC-JULIAN-2-YR    PIC 99.
  1044             20  DC-JULIAN-DA-2        PIC 999.
  1045         16  DC-GREG-DATE-A-EDIT.
  1046             20  DC-EDITA-MONTH        PIC 99.
  1047             20  SLASHA-1              PIC X VALUE '/'.
  1048             20  DC-EDITA-DAY          PIC 99.
  1049             20  SLASHA-2              PIC X VALUE '/'.
  1050             20  DC-EDITA-CCYY.
  1051                 24  DC-EDITA-CENT     PIC 99.
  1052                 24  DC-EDITA-YEAR     PIC 99.
  1053         16  DC-GREG-DATE-B-EDIT.
  1054             20  DC-EDITB-MONTH        PIC 99.
  1055             20  SLASHB-1              PIC X VALUE '/'.
  1056             20  DC-EDITB-DAY          PIC 99.
  1057             20  SLASHB-2              PIC X VALUE '/'.
  1058             20  DC-EDITB-CCYY.
  1059                 24  DC-EDITB-CENT     PIC 99.
  1060                 24  DC-EDITB-YEAR     PIC 99.
  1061         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1062         16  DC-GREG-DATE-CYMD-R REDEFINES
  1063                              DC-GREG-DATE-CYMD.
  1064             20  DC-CYMD-CEN           PIC 99.
  1065             20  DC-CYMD-YEAR          PIC 99.
  1066             20  DC-CYMD-MONTH         PIC 99.
  1067             20  DC-CYMD-DAY           PIC 99.
  1068         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1069         16  DC-GREG-DATE-MDCY-R REDEFINES
  1070                              DC-GREG-DATE-MDCY.
  1071             20  DC-MDCY-MONTH         PIC 99.
  1072             20  DC-MDCY-DAY           PIC 99.
  1073             20  DC-MDCY-CEN           PIC 99.
  1074             20  DC-MDCY-YEAR          PIC 99.
  1075    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1076        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1077    12  DC-EL310-DATE                  PIC X(21).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL612.cbl
  1078    12  FILLER                         PIC X(28).
  1079*                                COPY ELCLOGOF.
  1080******************************************************************
  1081*                                                                *
  1082*                                                                *
  1083*                            ELCLOGOF.                           *
  1084*                            VMOD=2.001                          *
  1085*                                                                *
  1086*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1087*                                                                *
  1088******************************************************************
  1089 01  CLASIC-LOGOFF.
  1090     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1091     12  LOGOFF-TEXT.
  1092         16  FILLER          PIC X(5)    VALUE SPACES.
  1093         16  LOGOFF-MSG.
  1094             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1095             20  FILLER      PIC X       VALUE SPACES.
  1096             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1097         16  FILLER          PIC X(80)
  1098           VALUE '* YOU ARE NOW LOGGED OFF'.
  1099         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1100         16  FILLER          PIC X       VALUE QUOTE.
  1101         16  LOGOFF-SYS-MSG  PIC X(17)
  1102           VALUE 'S CLAS-IC SYSTEM '.
  1103     12  TEXT-MESSAGES.
  1104         16  UNACCESS-MSG    PIC X(29)
  1105             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1106         16  PGMIDERR-MSG    PIC X(17)
  1107             VALUE 'PROGRAM NOT FOUND'.
  1108*                                COPY ELCATTR.
  1109******************************************************************
  1110*                                                                *
  1111*                            ELCATTR.                            *
  1112*                            VMOD=2.001                          *
  1113*                                                                *
  1114*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1115*                                                                *
  1116*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1117*                                                                *
  1118*                   POS 1   P=PROTECTED                          *
  1119*                           U=UNPROTECTED                        *
  1120*                           S=ASKIP                              *
  1121*                   POS 2   A=ALPHA/NUMERIC                      *
  1122*                           N=NUMERIC                            *
  1123*                   POS 3   N=NORMAL                             *
  1124*                           B=BRIGHT                             *
  1125*                           D=DARK                               *
  1126*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1127*                           OF=MODIFIED DATA TAG OFF             *
  1128*                                                                *
  1129*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1130******************************************************************
  1131 01  ATTRIBUTE-LIST.
  1132     12  AL-PABOF            PIC X       VALUE 'Y'.
  1133     12  AL-PABON            PIC X       VALUE 'Z'.
  1134     12  AL-PADOF            PIC X       VALUE '%'.
  1135     12  AL-PADON            PIC X       VALUE '_'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL612.cbl
  1136     12  AL-PANOF            PIC X       VALUE '-'.
  1137     12  AL-PANON            PIC X       VALUE '/'.
  1138     12  AL-SABOF            PIC X       VALUE '8'.
  1139     12  AL-SABON            PIC X       VALUE '9'.
  1140     12  AL-SADOF            PIC X       VALUE '@'.
  1141     12  AL-SADON            PIC X       VALUE QUOTE.
  1142     12  AL-SANOF            PIC X       VALUE '0'.
  1143     12  AL-SANON            PIC X       VALUE '1'.
  1144     12  AL-UABOF            PIC X       VALUE 'H'.
  1145     12  AL-UABON            PIC X       VALUE 'I'.
  1146     12  AL-UADOF            PIC X       VALUE '<'.
  1147     12  AL-UADON            PIC X       VALUE '('.
  1148     12  AL-UANOF            PIC X       VALUE ' '.
  1149     12  AL-UANON            PIC X       VALUE 'A'.
  1150     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1151     12  AL-UNBON            PIC X       VALUE 'R'.
  1152     12  AL-UNDOF            PIC X       VALUE '*'.
  1153     12  AL-UNDON            PIC X       VALUE ')'.
  1154     12  AL-UNNOF            PIC X       VALUE '&'.
  1155     12  AL-UNNON            PIC X       VALUE 'J'.
  1156*                                COPY ELCAID.
  1157******************************************************************
  1158*                                                                *
  1159*                            ELCAID.                             *
  1160*                            VMOD=2.001                          *
  1161*                                                                *
  1162*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1163*                                                                *
  1164*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1165*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1166******************************************************************
  1167
  1168 01  DFHAID.
  1169   02  DFHNULL   PIC  X  VALUE  ' '.
  1170   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1171   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1172   02  DFHPEN    PIC  X  VALUE  '='.
  1173   02  DFHOPID   PIC  X  VALUE  'W'.
  1174   02  DFHPA1    PIC  X  VALUE  '%'.
  1175   02  DFHPA2    PIC  X  VALUE  '>'.
  1176   02  DFHPA3    PIC  X  VALUE  ','.
  1177   02  DFHPF1    PIC  X  VALUE  '1'.
  1178   02  DFHPF2    PIC  X  VALUE  '2'.
  1179   02  DFHPF3    PIC  X  VALUE  '3'.
  1180   02  DFHPF4    PIC  X  VALUE  '4'.
  1181   02  DFHPF5    PIC  X  VALUE  '5'.
  1182   02  DFHPF6    PIC  X  VALUE  '6'.
  1183   02  DFHPF7    PIC  X  VALUE  '7'.
  1184   02  DFHPF8    PIC  X  VALUE  '8'.
  1185   02  DFHPF9    PIC  X  VALUE  '9'.
  1186   02  DFHPF10   PIC  X  VALUE  ':'.
  1187   02  DFHPF11   PIC  X  VALUE  '#'.
  1188   02  DFHPF12   PIC  X  VALUE  '@'.
  1189   02  DFHPF13   PIC  X  VALUE  'A'.
  1190   02  DFHPF14   PIC  X  VALUE  'B'.
  1191   02  DFHPF15   PIC  X  VALUE  'C'.
  1192   02  DFHPF16   PIC  X  VALUE  'D'.
  1193   02  DFHPF17   PIC  X  VALUE  'E'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL612.cbl
  1194   02  DFHPF18   PIC  X  VALUE  'F'.
  1195   02  DFHPF19   PIC  X  VALUE  'G'.
  1196   02  DFHPF20   PIC  X  VALUE  'H'.
  1197   02  DFHPF21   PIC  X  VALUE  'I'.
  1198*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1199   02  DFHPF22   PIC  X  VALUE  '['.
  1200   02  DFHPF23   PIC  X  VALUE  '.'.
  1201   02  DFHPF24   PIC  X  VALUE  '<'.
  1202   02  DFHMSRE   PIC  X  VALUE  'X'.
  1203   02  DFHSTRF   PIC  X  VALUE  'h'.
  1204   02  DFHTRIG   PIC  X  VALUE  '"'.
  1205 01  FILLER    REDEFINES DFHAID.
  1206     05  FILLER                      PIC X(8).
  1207     05  PF-VALUES                   PIC X
  1208         OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL612.cbl
  1210****************************************************************
  1211*
  1212* Copyright (c) 2007 by Clerity Solutions, Inc.
  1213* All rights reserved.
  1214*
  1215****************************************************************
  1216 01  DFHEIV.
  1217   02  DFHEIV0               PIC X(35).
  1218   02  DFHEIV1               PIC X(08).
  1219   02  DFHEIV2               PIC X(08).
  1220   02  DFHEIV3               PIC X(08).
  1221   02  DFHEIV4               PIC X(06).
  1222   02  DFHEIV5               PIC X(04).
  1223   02  DFHEIV6               PIC X(04).
  1224   02  DFHEIV7               PIC X(02).
  1225   02  DFHEIV8               PIC X(02).
  1226   02  DFHEIV9               PIC X(01).
  1227   02  DFHEIV10              PIC S9(7) COMP-3.
  1228   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1229   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1230   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1231   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1232   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1233   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1234   02  DFHEIV17              PIC X(04).
  1235   02  DFHEIV18              PIC X(04).
  1236   02  DFHEIV19              PIC X(04).
  1237   02  DFHEIV20              USAGE IS POINTER.
  1238   02  DFHEIV21              USAGE IS POINTER.
  1239   02  DFHEIV22              USAGE IS POINTER.
  1240   02  DFHEIV23              USAGE IS POINTER.
  1241   02  DFHEIV24              USAGE IS POINTER.
  1242   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1243   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1244   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1245   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1246   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1247   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1248   02  FILLER                PIC X(02).
  1249   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1250   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1251   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1252   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1253   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1254 LINKAGE  SECTION.
  1255*****************************************************************
  1256*                                                               *
  1257* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1258* All rights reserved.                                          *
  1259*                                                               *
  1260*****************************************************************
  1261 01  dfheiblk.
  1262     02  eibtime          pic s9(7) comp-3.
  1263     02  eibdate          pic s9(7) comp-3.
  1264     02  eibtrnid         pic x(4).
  1265     02  eibtaskn         pic s9(7) comp-3.
  1266     02  eibtrmid         pic x(4).
  1267     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL612.cbl
  1268     02  eibcposn         pic s9(4) comp.
  1269     02  eibcalen         pic s9(4) comp.
  1270     02  eibaid           pic x(1).
  1271     02  eibfiller1       pic x(1).
  1272     02  eibfn            pic x(2).
  1273     02  eibfiller2       pic x(2).
  1274     02  eibrcode         pic x(6).
  1275     02  eibfiller3       pic x(2).
  1276     02  eibds            pic x(8).
  1277     02  eibreqid         pic x(8).
  1278     02  eibrsrce         pic x(8).
  1279     02  eibsync          pic x(1).
  1280     02  eibfree          pic x(1).
  1281     02  eibrecv          pic x(1).
  1282     02  eibsend          pic x(1).
  1283     02  eibatt           pic x(1).
  1284     02  eibeoc           pic x(1).
  1285     02  eibfmh           pic x(1).
  1286     02  eibcompl         pic x(1).
  1287     02  eibsig           pic x(1).
  1288     02  eibconf          pic x(1).
  1289     02  eiberr           pic x(1).
  1290     02  eibrldbk         pic x(1).
  1291     02  eiberrcd         pic x(4).
  1292     02  eibsynrb         pic x(1).
  1293     02  eibnodat         pic x(1).
  1294     02  eibfiller5       pic x(2).
  1295     02  eibresp          pic 9(09) comp.
  1296     02  eibresp2         pic 9(09) comp.
  1297     02  dfheigdj         pic s9(4) comp.
  1298     02  dfheigdk         pic s9(4) comp.
  1299 01  DFHCOMMAREA                     PIC X(1024).
  1300 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1301 0000-DFHEXIT SECTION.
  1302     MOVE '9#                    $   ' TO DFHEIV0.
  1303     MOVE 'EL612' TO DFHEIV1.
  1304     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1305     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1306     MOVE '5'                   TO DC-OPTION-CODE.
  1307     PERFORM 8500-DATE-CONVERSION
  1308                                THRU 8500-EXIT
  1309     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1310     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1311     MOVE DFHCOMMAREA           TO  PROGRAM-INTERFACE-BLOCK.
  1312     MOVE +2                    TO  EMI-NUMBER-OF-LINES
  1313                                    EMI-SWITCH2.
  1314     IF EIBCALEN NOT > ZERO
  1315        MOVE UNACCESS-MSG        TO LOGOFF-MSG
  1316        GO TO 8300-SEND-TEXT
  1317     END-IF
  1318
  1319* EXEC CICS HANDLE CONDITION
  1320*        PGMIDERR (9600-PGMIDERR)
  1321*        ERROR    (9990-ERROR)
  1322*    END-EXEC
  1323*    MOVE '"$L.                  ! " #00001314' TO DFHEIV0
  1324     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1325     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL612.cbl
  1326     MOVE X'2220233030303031333134' TO DFHEIV0(25:11)
  1327     CALL 'kxdfhei1' USING DFHEIV0
  1328     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1329     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1330        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1331           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1332           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1333           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1334           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1335           MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1336           MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1337           MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1338           MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  1339        ELSE
  1340           MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  1341           MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  1342           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  1343           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  1344           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  1345           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  1346           MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  1347           MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  1348        END-IF
  1349     END-IF
  1350     IF EIBTRNID NOT = WS-TRANS-ID
  1351        GO TO 1000-INITIAL-SCREEN
  1352     END-IF
  1353     IF EIBAID = DFHCLEAR
  1354        GO TO 9400-CLEAR
  1355     END-IF
  1356     IF NOT SYSTEM-DISPLAY-CAP
  1357        MOVE 'READ'              TO SM-READ
  1358        PERFORM 9995-SECURITY-VIOLATION
  1359        MOVE ER-0070             TO EMI-ERROR
  1360        PERFORM 9900-ERROR-FORMAT
  1361                                 THRU 9900-EXIT
  1362        GO TO 8100-SEND-INITIAL-MAP
  1363     END-IF
  1364     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1365        MOVE LOW-VALUES          TO EL612AO
  1366        MOVE -1                  TO APFKL
  1367        MOVE ER-0008             TO EMI-ERROR
  1368        GO TO 8200-SEND-DATAONLY
  1369     END-IF
  1370
  1371* EXEC CICS RECEIVE
  1372*        INTO   (EL612AO)
  1373*        MAPSET (WS-MAPSET-NAME)
  1374*        MAP    (WS-MAP-NAME)
  1375*    END-EXEC
  1376     MOVE LENGTH OF
  1377      EL612AO
  1378       TO DFHEIV11
  1379*    MOVE '8"T I  L              ''   #00001359' TO DFHEIV0
  1380     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1381     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1382     MOVE X'2020233030303031333539' TO DFHEIV0(25:11)
  1383     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL612.cbl
  1384           WS-MAP-NAME,
  1385           EL612AO,
  1386           DFHEIV11,
  1387           WS-MAPSET-NAME,
  1388           DFHEIV99,
  1389           DFHEIV99
  1390     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1391     IF APFKL > ZERO
  1392        IF EIBAID NOT = DFHENTER
  1393           MOVE ER-0004          TO EMI-ERROR
  1394           MOVE AL-UNBOF         TO APFKA
  1395           MOVE -1               TO APFKL
  1396           GO TO 8200-SEND-DATAONLY
  1397        ELSE
  1398           IF APFKO NUMERIC AND
  1399              (APFKO > ZERO AND LESS '25')
  1400              MOVE PF-VALUES (APFKI)
  1401                                 TO  EIBAID
  1402           ELSE
  1403              MOVE ER-0029       TO  EMI-ERROR
  1404              MOVE AL-UNBOF      TO  APFKA
  1405              MOVE -1            TO  APFKL
  1406              GO TO 8200-SEND-DATAONLY
  1407           END-IF
  1408        END-IF
  1409     END-IF
  1410     IF EIBAID = DFHPF12
  1411        MOVE 'EL010'             TO THIS-PGM
  1412        GO TO 9300-XCTL
  1413     END-IF
  1414     IF EIBAID = DFHPF23
  1415        GO TO 9000-RETURN-CICS
  1416     END-IF
  1417     IF EIBAID = DFHPF24
  1418        IF CREDIT-SESSION
  1419           MOVE 'EL626'          TO THIS-PGM
  1420           GO TO 9300-XCTL
  1421        ELSE
  1422           MOVE 'EL126'          TO THIS-PGM
  1423           GO TO 9300-XCTL
  1424        END-IF
  1425     END-IF
  1426     IF EIBAID = DFHENTER
  1427        CONTINUE
  1428     ELSE
  1429        MOVE ER-0008             TO EMI-ERROR
  1430        MOVE -1                  TO APFKL
  1431        GO TO 8200-SEND-DATAONLY
  1432     END-IF
  1433     IF SYSTEM-MODIFY-CAP
  1434        CONTINUE
  1435     ELSE
  1436        MOVE 'UPDATE'            TO SM-READ
  1437        PERFORM 9995-SECURITY-VIOLATION
  1438        MOVE ER-0070             TO EMI-ERROR
  1439        MOVE -1                  TO STATEL
  1440        MOVE AL-UABON            TO STATEA
  1441        GO TO 8200-SEND-DATAONLY
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL612.cbl
  1442     END-IF
  1443     IF EMI-FATAL-CTR > ZERO
  1444        GO TO 8200-SEND-DATAONLY
  1445     END-IF
  1446     GO TO 3000-PROCESS-TEST
  1447     MOVE 'LOGIC ERROR HAS OCCURRED - PROGRAM EL612'
  1448                                 TO  LOGOFF-MSG.
  1449     GO TO 8300-SEND-TEXT.
  1450     .
  1451 1000-INITIAL-SCREEN.
  1452     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA
  1453     MOVE PI-COMPANY-CD          TO PI-CI-TOP-KEY (1:1)
  1454                                    PI-CI-BOT-KEY (1:1)
  1455     MOVE ZERO                   TO PI-1ST-TIME-SW
  1456                                    PI-LINE-COUNT
  1457                                    PI-BROWSE-SW
  1458                                    PI-SHOW-SW
  1459                                    PI-CHANGE-SW
  1460     MOVE LOW-VALUES             TO EL612AO
  1461     MOVE -1                     TO STATEL
  1462     MOVE +2                     TO WS-COMPLETED-SUCCESSFUL
  1463     GO TO 8100-SEND-INITIAL-MAP
  1464     .
  1465*****************************************************************
  1466 3000-PROCESS-TEST.
  1467*****************************************************************
  1468     PERFORM 6010-EDIT-DATA      THRU 6010-EXIT
  1469     IF NOT EMI-NO-ERRORS
  1470        GO TO 8200-SEND-DATAONLY
  1471     END-IF
  1472     MOVE PI-COMPANY-CD          TO CP-COMPANY-CD
  1473     MOVE STATEI                 TO CP-STATE
  1474     MOVE PRODI                  TO CP-PRODUCT
  1475     MOVE COVI                   TO CP-COVERAGE
  1476     MOVE WS-INC-DATE            TO CP-INC-DT
  1477     MOVE WS-EST-DATE            TO CP-EST-DT
  1478     MOVE WS-LSTPD-DATE          TO CP-LSTPD-DT
  1479     MOVE WS-RPT-DATE            TO CP-RPT-DT
  1480     MOVE WS-PRF-DATE            TO CP-PRF-DT
  1481     MOVE WS-EFF-DATE            TO CP-EFF-DT
  1482*    MOVE CLMAMTI                TO CP-CLAIM-AMT
  1483     PERFORM 7000-LINK-ELCLMI    THRU 7000-EXIT
  1484*    MOVE +123.45                TO CP-CLM-INT-AMT
  1485     MOVE CP-CLM-INT-SW          TO QUALO
  1486*    IF CP-CLM-INT-SW = 'N'
  1487*       MOVE 'N'                 TO QUALO
  1488*    ELSE
  1489*       MOVE 'Y'                 TO QUALO
  1490*    END-IF
  1491     IF NO-CI-ERROR
  1492        MOVE CP-CLM-INT-AMT      TO INTAMTO
  1493        MOVE CP-CLM-INT-RATE     TO INTRATO
  1494        MOVE CP-CLM-INT-NODAYS   TO NODAYSO
  1495        MOVE ZEROS               TO EMI-ERROR
  1496        GO TO 8100-SEND-INITIAL-MAP
  1497     END-IF
  1498     EVALUATE CI-RETURN-CODE
  1499        WHEN '1'
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL612.cbl
  1500           MOVE ER-3811          TO EMI-ERROR
  1501        WHEN '2'
  1502           MOVE ER-3812          TO EMI-ERROR
  1503        WHEN '3'
  1504           MOVE ER-3813          TO EMI-ERROR
  1505        WHEN '4'
  1506           MOVE ER-3814          TO EMI-ERROR
  1507        WHEN '5'
  1508           MOVE ER-3815          TO EMI-ERROR
  1509        WHEN '6'
  1510           MOVE ER-3816          TO EMI-ERROR
  1511        WHEN '7'
  1512           MOVE ER-3817          TO EMI-ERROR
  1513        WHEN '8'
  1514           MOVE ER-3818          TO EMI-ERROR
  1515        WHEN OTHER
  1516           MOVE ER-9999          TO EMI-ERROR
  1517     END-EVALUATE
  1518     MOVE AL-UABON               TO STATEA
  1519     MOVE -1                     TO STATEL
  1520     MOVE CI-RETURN-CODE         TO STATEO
  1521     MOVE ZEROS                  TO INTAMTO
  1522                                    INTRATO
  1523                                    NODAYSO
  1524     GO TO 8200-SEND-DATAONLY
  1525     .
  1526 6010-EDIT-DATA.
  1527     IF STATEL > +0
  1528        MOVE STATEI              TO CP-STATE
  1529        MOVE AL-UANON            TO STATEA
  1530     ELSE
  1531        MOVE ER-0196             TO EMI-ERROR
  1532        PERFORM 9900-ERROR-FORMAT
  1533        MOVE AL-UABON            TO STATEA
  1534        MOVE -1                  TO STATEL
  1535     END-IF
  1536     IF PRODL > +0
  1537        MOVE PRODI               TO CP-PRODUCT
  1538        MOVE AL-UANON            TO PRODA
  1539     ELSE
  1540        MOVE ER-3819             TO EMI-ERROR
  1541        PERFORM 9900-ERROR-FORMAT
  1542        MOVE AL-UABON            TO PRODA
  1543        MOVE -1                  TO PRODL
  1544     END-IF
  1545     IF COVL > +0
  1546        MOVE COVI                TO CP-COVERAGE
  1547        MOVE AL-UANON            TO COVA
  1548     ELSE
  1549        MOVE ER-3819             TO EMI-ERROR
  1550        PERFORM 9900-ERROR-FORMAT
  1551        MOVE AL-UABON            TO COVA
  1552        MOVE -1                  TO COVL
  1553     END-IF
  1554     IF INCDTL > +0
  1555        MOVE INCDTI              TO DEEDIT-FIELD
  1556
  1557* EXEC CICS BIF DEEDIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL612.cbl
  1558*           FIELD   (DEEDIT-FIELD)
  1559*           LENGTH  (10)
  1560*       END-EXEC
  1561     MOVE 10
  1562       TO DFHEIV11
  1563*    MOVE '@"L                   #   #00001529' TO DFHEIV0
  1564     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  1565     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1566     MOVE X'2020233030303031353239' TO DFHEIV0(25:11)
  1567     CALL 'kxdfhei1' USING DFHEIV0,
  1568           DEEDIT-FIELD,
  1569           DFHEIV11
  1570     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1571        IF DEEDIT-FIELD-V0 NUMERIC
  1572           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-MDCY
  1573           MOVE 'M'              TO DC-OPTION-CODE
  1574           PERFORM 8500-DATE-CONVERSION
  1575                                 THRU 8500-EXIT
  1576           IF NO-CONVERSION-ERROR
  1577              MOVE AL-UANON      TO INCDTA
  1578              MOVE DC-BIN-DATE-1 TO WS-INC-DATE
  1579              MOVE DC-GREG-DATE-A-EDIT TO INCDTO
  1580           ELSE
  1581              MOVE ER-3801       TO EMI-ERROR
  1582              PERFORM 9900-ERROR-FORMAT
  1583              MOVE DEEDIT-FIELD  TO INCDTO
  1584              MOVE AL-UABON      TO INCDTA
  1585              MOVE -1            TO INCDTL
  1586           END-IF
  1587        ELSE
  1588           MOVE ER-3801          TO EMI-ERROR
  1589           PERFORM 9900-ERROR-FORMAT
  1590           MOVE DEEDIT-FIELD     TO INCDTO
  1591           MOVE AL-UABON         TO INCDTA
  1592           MOVE -1               TO INCDTL
  1593        END-IF
  1594     ELSE
  1595        MOVE ER-3819             TO EMI-ERROR
  1596        PERFORM 9900-ERROR-FORMAT
  1597        MOVE AL-UABON            TO INCDTA
  1598        MOVE -1                  TO INCDTL
  1599     END-IF
  1600     IF ESTDTL > +0
  1601        MOVE ESTDTI              TO DEEDIT-FIELD
  1602
  1603* EXEC CICS BIF DEEDIT
  1604*           FIELD   (DEEDIT-FIELD)
  1605*           LENGTH  (10)
  1606*       END-EXEC
  1607     MOVE 10
  1608       TO DFHEIV11
  1609*    MOVE '@"L                   #   #00001564' TO DFHEIV0
  1610     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  1611     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1612     MOVE X'2020233030303031353634' TO DFHEIV0(25:11)
  1613     CALL 'kxdfhei1' USING DFHEIV0,
  1614           DEEDIT-FIELD,
  1615           DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL612.cbl
  1616     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1617        IF DEEDIT-FIELD-V0 NUMERIC
  1618           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-MDCY
  1619           MOVE 'M'              TO DC-OPTION-CODE
  1620           PERFORM 8500-DATE-CONVERSION
  1621                                 THRU 8500-EXIT
  1622           IF NO-CONVERSION-ERROR
  1623              MOVE AL-UANON      TO ESTDTA
  1624              MOVE DC-BIN-DATE-1 TO WS-EST-DATE
  1625              MOVE DC-GREG-DATE-A-EDIT TO ESTDTO
  1626           ELSE
  1627              MOVE ER-3801       TO EMI-ERROR
  1628              PERFORM 9900-ERROR-FORMAT
  1629              MOVE DEEDIT-FIELD  TO ESTDTO
  1630              MOVE AL-UABON      TO ESTDTA
  1631              MOVE -1            TO ESTDTL
  1632           END-IF
  1633        ELSE
  1634           MOVE ER-3801          TO EMI-ERROR
  1635           PERFORM 9900-ERROR-FORMAT
  1636           MOVE DEEDIT-FIELD     TO ESTDTO
  1637           MOVE AL-UABON         TO ESTDTA
  1638           MOVE -1               TO ESTDTL
  1639        END-IF
  1640     ELSE
  1641        MOVE ER-3819             TO EMI-ERROR
  1642        PERFORM 9900-ERROR-FORMAT
  1643        MOVE AL-UABON            TO ESTDTA
  1644        MOVE -1                  TO ESTDTL
  1645     END-IF
  1646     IF LSTPDDTL > +0
  1647        MOVE LSTPDDTI            TO DEEDIT-FIELD
  1648
  1649* EXEC CICS BIF DEEDIT
  1650*           FIELD   (DEEDIT-FIELD)
  1651*           LENGTH  (10)
  1652*       END-EXEC
  1653     MOVE 10
  1654       TO DFHEIV11
  1655*    MOVE '@"L                   #   #00001599' TO DFHEIV0
  1656     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  1657     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1658     MOVE X'2020233030303031353939' TO DFHEIV0(25:11)
  1659     CALL 'kxdfhei1' USING DFHEIV0,
  1660           DEEDIT-FIELD,
  1661           DFHEIV11
  1662     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1663        IF DEEDIT-FIELD-V0 NUMERIC
  1664           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-MDCY
  1665           MOVE 'M'              TO DC-OPTION-CODE
  1666           PERFORM 8500-DATE-CONVERSION
  1667                                 THRU 8500-EXIT
  1668           IF NO-CONVERSION-ERROR
  1669              MOVE AL-UANON      TO LSTPDDTA
  1670              MOVE DC-BIN-DATE-1 TO WS-LSTPD-DATE
  1671              MOVE DC-GREG-DATE-A-EDIT TO LSTPDDTO
  1672           ELSE
  1673              MOVE ER-3801       TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL612.cbl
  1674              PERFORM 9900-ERROR-FORMAT
  1675              MOVE DEEDIT-FIELD  TO LSTPDDTO
  1676              MOVE AL-UABON      TO LSTPDDTA
  1677              MOVE -1            TO LSTPDDTL
  1678           END-IF
  1679        ELSE
  1680           MOVE ER-3801          TO EMI-ERROR
  1681           PERFORM 9900-ERROR-FORMAT
  1682           MOVE DEEDIT-FIELD     TO LSTPDDTO
  1683           MOVE AL-UABON         TO LSTPDDTA
  1684           MOVE -1               TO LSTPDDTL
  1685        END-IF
  1686     ELSE
  1687        MOVE SAVE-BIN-DATE       TO WS-LSTPD-DATE
  1688     END-IF
  1689     IF RPTDTL > +0
  1690        MOVE RPTDTI              TO DEEDIT-FIELD
  1691
  1692* EXEC CICS BIF DEEDIT
  1693*           FIELD   (DEEDIT-FIELD)
  1694*           LENGTH  (10)
  1695*       END-EXEC
  1696     MOVE 10
  1697       TO DFHEIV11
  1698*    MOVE '@"L                   #   #00001631' TO DFHEIV0
  1699     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  1700     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1701     MOVE X'2020233030303031363331' TO DFHEIV0(25:11)
  1702     CALL 'kxdfhei1' USING DFHEIV0,
  1703           DEEDIT-FIELD,
  1704           DFHEIV11
  1705     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1706        IF DEEDIT-FIELD-V0 NUMERIC
  1707           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-MDCY
  1708           MOVE 'M'              TO DC-OPTION-CODE
  1709           PERFORM 8500-DATE-CONVERSION
  1710                                 THRU 8500-EXIT
  1711           IF NO-CONVERSION-ERROR
  1712              MOVE AL-UANON      TO RPTDTA
  1713              MOVE DC-BIN-DATE-1 TO WS-RPT-DATE
  1714              MOVE DC-GREG-DATE-A-EDIT TO RPTDTO
  1715           ELSE
  1716              MOVE ER-3801       TO EMI-ERROR
  1717              PERFORM 9900-ERROR-FORMAT
  1718              MOVE DEEDIT-FIELD  TO RPTDTO
  1719              MOVE AL-UABON      TO RPTDTA
  1720              MOVE -1            TO RPTDTL
  1721           END-IF
  1722        ELSE
  1723           MOVE ER-3801          TO EMI-ERROR
  1724           PERFORM 9900-ERROR-FORMAT
  1725           MOVE DEEDIT-FIELD     TO RPTDTO
  1726           MOVE AL-UABON         TO RPTDTA
  1727           MOVE -1               TO RPTDTL
  1728        END-IF
  1729     ELSE
  1730        MOVE ER-3819             TO EMI-ERROR
  1731        PERFORM 9900-ERROR-FORMAT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL612.cbl
  1732        MOVE AL-UABON            TO RPTDTA
  1733        MOVE -1                  TO RPTDTL
  1734     END-IF
  1735     IF PRFDTL > +0
  1736        MOVE PRFDTI              TO DEEDIT-FIELD
  1737
  1738* EXEC CICS BIF DEEDIT
  1739*           FIELD   (DEEDIT-FIELD)
  1740*           LENGTH  (10)
  1741*       END-EXEC
  1742     MOVE 10
  1743       TO DFHEIV11
  1744*    MOVE '@"L                   #   #00001666' TO DFHEIV0
  1745     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  1746     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1747     MOVE X'2020233030303031363636' TO DFHEIV0(25:11)
  1748     CALL 'kxdfhei1' USING DFHEIV0,
  1749           DEEDIT-FIELD,
  1750           DFHEIV11
  1751     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1752        IF DEEDIT-FIELD-V0 NUMERIC
  1753           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-MDCY
  1754           MOVE 'M'              TO DC-OPTION-CODE
  1755           PERFORM 8500-DATE-CONVERSION
  1756                                 THRU 8500-EXIT
  1757           IF NO-CONVERSION-ERROR
  1758              MOVE AL-UANON      TO PRFDTA
  1759              MOVE DC-BIN-DATE-1 TO WS-PRF-DATE
  1760              MOVE DC-GREG-DATE-A-EDIT TO PRFDTO
  1761           ELSE
  1762              MOVE ER-3801       TO EMI-ERROR
  1763              PERFORM 9900-ERROR-FORMAT
  1764              MOVE DEEDIT-FIELD  TO PRFDTO
  1765              MOVE AL-UABON      TO PRFDTA
  1766              MOVE -1            TO PRFDTL
  1767           END-IF
  1768        ELSE
  1769           MOVE ER-3801          TO EMI-ERROR
  1770           PERFORM 9900-ERROR-FORMAT
  1771           MOVE DEEDIT-FIELD     TO PRFDTO
  1772           MOVE AL-UABON         TO PRFDTA
  1773           MOVE -1               TO PRFDTL
  1774        END-IF
  1775     ELSE
  1776        MOVE ER-3819             TO EMI-ERROR
  1777        PERFORM 9900-ERROR-FORMAT
  1778        MOVE AL-UABON            TO PRFDTA
  1779        MOVE -1                  TO PRFDTL
  1780     END-IF
  1781     IF EFFDTL > +0
  1782        MOVE EFFDTI              TO DEEDIT-FIELD
  1783
  1784* EXEC CICS BIF DEEDIT
  1785*           FIELD   (DEEDIT-FIELD)
  1786*           LENGTH  (10)
  1787*       END-EXEC
  1788     MOVE 10
  1789       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL612.cbl
  1790*    MOVE '@"L                   #   #00001701' TO DFHEIV0
  1791     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  1792     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1793     MOVE X'2020233030303031373031' TO DFHEIV0(25:11)
  1794     CALL 'kxdfhei1' USING DFHEIV0,
  1795           DEEDIT-FIELD,
  1796           DFHEIV11
  1797     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1798        IF DEEDIT-FIELD-V0 NUMERIC
  1799           MOVE DEEDIT-FIELD-V0  TO DC-GREG-DATE-MDCY
  1800           MOVE 'M'              TO DC-OPTION-CODE
  1801           PERFORM 8500-DATE-CONVERSION
  1802                                 THRU 8500-EXIT
  1803           IF NO-CONVERSION-ERROR
  1804              MOVE AL-UANON      TO EFFDTA
  1805              MOVE DC-BIN-DATE-1 TO WS-EFF-DATE
  1806              MOVE DC-GREG-DATE-A-EDIT TO EFFDTO
  1807           ELSE
  1808              MOVE ER-3801       TO EMI-ERROR
  1809              PERFORM 9900-ERROR-FORMAT
  1810              MOVE DEEDIT-FIELD  TO EFFDTO
  1811              MOVE AL-UABON      TO EFFDTA
  1812              MOVE -1            TO EFFDTL
  1813           END-IF
  1814        ELSE
  1815           MOVE ER-3801          TO EMI-ERROR
  1816           PERFORM 9900-ERROR-FORMAT
  1817           MOVE DEEDIT-FIELD     TO EFFDTO
  1818           MOVE AL-UABON         TO EFFDTA
  1819           MOVE -1               TO EFFDTL
  1820        END-IF
  1821     ELSE
  1822        IF CP-STATE = 'UT'
  1823           MOVE ER-3819             TO EMI-ERROR
  1824           PERFORM 9900-ERROR-FORMAT
  1825           MOVE AL-UABON            TO EFFDTA
  1826           MOVE -1                  TO EFFDTL
  1827        END-IF
  1828     END-IF
  1829     IF CLMAMTL > +0
  1830*       MOVE CLMAMTI             TO DEEDIT-FIELD
  1831
  1832* EXEC CICS BIF DEEDIT
  1833*           FIELD   (CLMAMTI)
  1834*           LENGTH  (10)
  1835*       END-EXEC
  1836     MOVE 10
  1837       TO DFHEIV11
  1838*    MOVE '@"L                   #   #00001738' TO DFHEIV0
  1839     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  1840     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1841     MOVE X'2020233030303031373338' TO DFHEIV0(25:11)
  1842     CALL 'kxdfhei1' USING DFHEIV0,
  1843           CLMAMTI,
  1844           DFHEIV11
  1845     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1846        IF CLMAMTI NOT NUMERIC
  1847           MOVE ER-0419          TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL612.cbl
  1848           PERFORM 9900-ERROR-FORMAT
  1849           MOVE AL-UABON         TO CLMAMTA
  1850           MOVE -1               TO CLMAMTL
  1851        ELSE
  1852           MOVE CLMAMTI          TO CP-CLAIM-AMT
  1853           MOVE CP-CLAIM-AMT     TO CLMAMTO
  1854           MOVE AL-UNNON         TO CLMAMTA
  1855        END-IF
  1856     ELSE
  1857        MOVE ER-3819             TO EMI-ERROR
  1858        PERFORM 9900-ERROR-FORMAT
  1859        MOVE AL-UABON            TO CLMAMTA
  1860        MOVE -1                  TO CLMAMTL
  1861     END-IF
  1862     IF ZINTRATL > +0
  1863
  1864* EXEC CICS BIF DEEDIT
  1865*           FIELD   (ZINTRATI)
  1866*           LENGTH  (08)
  1867*       END-EXEC
  1868     MOVE 08
  1869       TO DFHEIV11
  1870*    MOVE '@"L                   #   #00001759' TO DFHEIV0
  1871     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  1872     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  1873     MOVE X'2020233030303031373539' TO DFHEIV0(25:11)
  1874     CALL 'kxdfhei1' USING DFHEIV0,
  1875           ZINTRATI,
  1876           DFHEIV11
  1877     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1878        IF ZINTRATI NOT NUMERIC
  1879           MOVE ER-0419          TO EMI-ERROR
  1880           PERFORM 9900-ERROR-FORMAT
  1881           MOVE AL-UABON         TO ZINTRATA
  1882           MOVE -1               TO ZINTRATL
  1883        ELSE
  1884           MOVE ZINTRATI         TO CP-INT-RATE
  1885           MOVE CP-INT-RATE      TO ZINTRATO
  1886           MOVE AL-UNNON         TO ZINTRATA
  1887        END-IF
  1888     ELSE
  1889        MOVE ZEROS               TO CP-INT-RATE
  1890     END-IF
  1891     .
  1892 6010-EXIT.
  1893     EXIT.
  1894 7000-LINK-ELCLMI.
  1895
  1896* EXEC CICS LINK
  1897*       PROGRAM   ('ELCLMI')
  1898*       COMMAREA  (CLAIM-INT-PASS-AREA)
  1899*       LENGTH    (CP-CLAIM-LENGTH)
  1900*    END-EXEC
  1901     MOVE 'ELCLMI' TO DFHEIV1
  1902*    MOVE '."C                   ''   #00001780' TO DFHEIV0
  1903     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  1904     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1905     MOVE X'2020233030303031373830' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL612.cbl
  1906     CALL 'kxdfhei1' USING DFHEIV0,
  1907           DFHEIV1,
  1908           CLAIM-INT-PASS-AREA,
  1909           CP-CLAIM-LENGTH,
  1910           DFHEIV99,
  1911           DFHEIV99,
  1912           DFHEIV99
  1913     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1914     .
  1915 7000-EXIT.
  1916     EXIT.
  1917 8100-SEND-INITIAL-MAP.
  1918*****************************************************************
  1919     MOVE ZERO                   TO  PI-BROWSE-SW.
  1920     MOVE -1                     TO  STATEL
  1921     MOVE SAVE-DATE              TO  ADATEO.
  1922     MOVE EIBTIME                TO  TIME-IN.
  1923     MOVE TIME-OUT               TO  ATIMEO.
  1924     IF EMI-ERROR NOT = ZERO
  1925         PERFORM 9900-ERROR-FORMAT
  1926     END-IF
  1927     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSG1O.
  1928     MOVE EMI-MESSAGE-AREA (2)    TO  AEMSG2O.
  1929
  1930* EXEC CICS SEND
  1931*        FROM   (EL612AO)
  1932*        MAPSET (WS-MAPSET-NAME)
  1933*        MAP    (WS-MAP-NAME)
  1934*        CURSOR ERASE
  1935*    END-EXEC.
  1936     MOVE LENGTH OF
  1937      EL612AO
  1938       TO DFHEIV12
  1939     MOVE -1
  1940       TO DFHEIV11
  1941*    MOVE '8$     CT  E    H L F ,   #00001800' TO DFHEIV0
  1942     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  1943     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1944     MOVE X'2020233030303031383030' TO DFHEIV0(25:11)
  1945     CALL 'kxdfhei1' USING DFHEIV0,
  1946           WS-MAP-NAME,
  1947           EL612AO,
  1948           DFHEIV12,
  1949           WS-MAPSET-NAME,
  1950           DFHEIV99,
  1951           DFHEIV99,
  1952           DFHEIV99,
  1953           DFHEIV11,
  1954           DFHEIV99,
  1955           DFHEIV99,
  1956           DFHEIV99
  1957     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1958
  1959     GO TO 9100-RETURN-TRAN
  1960     .
  1961 8100-EXIT.
  1962      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL612.cbl
  1964*****************************************************************
  1965 8200-SEND-DATAONLY.
  1966*****************************************************************
  1967     MOVE SAVE-DATE              TO  ADATEO.
  1968     MOVE EIBTIME                TO  TIME-IN.
  1969     MOVE TIME-OUT               TO  ATIMEO.
  1970     IF EMI-ERROR NOT = ZERO
  1971         PERFORM 9900-ERROR-FORMAT.
  1972     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSG1O.
  1973     MOVE EMI-MESSAGE-AREA (2)    TO  AEMSG2O.
  1974
  1975* EXEC CICS SEND DATAONLY
  1976*        FROM   (EL612AO)
  1977*        MAPSET (WS-MAPSET-NAME)
  1978*        MAP    (WS-MAP-NAME)
  1979*        CURSOR
  1980*    END-EXEC.
  1981     MOVE LENGTH OF
  1982      EL612AO
  1983       TO DFHEIV12
  1984     MOVE -1
  1985       TO DFHEIV11
  1986*    MOVE '8$D    CT       H L F ,   #00001821' TO DFHEIV0
  1987     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  1988     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  1989     MOVE X'2020233030303031383231' TO DFHEIV0(25:11)
  1990     CALL 'kxdfhei1' USING DFHEIV0,
  1991           WS-MAP-NAME,
  1992           EL612AO,
  1993           DFHEIV12,
  1994           WS-MAPSET-NAME,
  1995           DFHEIV99,
  1996           DFHEIV99,
  1997           DFHEIV99,
  1998           DFHEIV11,
  1999           DFHEIV99,
  2000           DFHEIV99,
  2001           DFHEIV99
  2002     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2003
  2004     GO TO 9100-RETURN-TRAN
  2005     .
  2006 8200-EXIT.
  2007      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL612.cbl
  2009*****************************************************************
  2010 8300-SEND-TEXT.
  2011*****************************************************************
  2012
  2013* EXEC CICS SEND TEXT
  2014*        FROM   (LOGOFF-TEXT)
  2015*        LENGTH (LOGOFF-LENGTH)
  2016*        ERASE  FREEKB
  2017*    END-EXEC.
  2018*    MOVE '8&      T  E F  H   F -   #00001835' TO DFHEIV0
  2019     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2020     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2021     MOVE X'2020233030303031383335' TO DFHEIV0(25:11)
  2022     CALL 'kxdfhei1' USING DFHEIV0,
  2023           LOGOFF-TEXT,
  2024           LOGOFF-LENGTH,
  2025           DFHEIV99,
  2026           DFHEIV99,
  2027           DFHEIV99,
  2028           DFHEIV99,
  2029           DFHEIV99,
  2030           DFHEIV99,
  2031           DFHEIV99,
  2032           DFHEIV99,
  2033           DFHEIV99,
  2034           DFHEIV99
  2035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2036
  2037
  2038* EXEC CICS RETURN
  2039*    END-EXEC.
  2040*    MOVE '.(                    &   #00001840' TO DFHEIV0
  2041     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2042     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2043     MOVE X'2020233030303031383430' TO DFHEIV0(25:11)
  2044     CALL 'kxdfhei1' USING DFHEIV0,
  2045           DFHEIV99,
  2046           DFHEIV99,
  2047           DFHEIV99,
  2048           DFHEIV99,
  2049           DFHEIV99
  2050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2051
  2052 8300-EXIT.
  2053      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL612.cbl
  2055*****************************************************************
  2056 8400-LOG-JOURNAL-RECORD.
  2057*****************************************************************
  2058     IF PI-JOURNAL-FILE-ID = 0
  2059         GO TO 8400-EXIT.
  2060     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  2061     MOVE 'ELCNTL'               TO  JP-FILE-ID.
  2062     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  2063*    EXEC CICS JOURNAL
  2064*        JFILEID (PI-JOURNAL-FILE-ID)
  2065*        JTYPEID (WS-JOURNAL-TYPE-ID)
  2066*        FROM    (JOURNAL-RECORD)
  2067*        LENGTH  (WS-JOURNAL-RECORD-LENGTH)
  2068*    END-EXEC.
  2069 8400-EXIT.
  2070      EXIT.
  2071*****************************************************************
  2072 8500-DATE-CONVERSION.
  2073*****************************************************************
  2074
  2075* EXEC CICS LINK
  2076*        PROGRAM  ('ELDATCV')
  2077*        COMMAREA (DATE-CONVERSION-DATA)
  2078*        LENGTH   (DC-COMM-LENGTH)
  2079*    END-EXEC.
  2080     MOVE 'ELDATCV' TO DFHEIV1
  2081*    MOVE '."C                   ''   #00001864' TO DFHEIV0
  2082     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2083     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2084     MOVE X'2020233030303031383634' TO DFHEIV0(25:11)
  2085     CALL 'kxdfhei1' USING DFHEIV0,
  2086           DFHEIV1,
  2087           DATE-CONVERSION-DATA,
  2088           DC-COMM-LENGTH,
  2089           DFHEIV99,
  2090           DFHEIV99,
  2091           DFHEIV99
  2092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2093
  2094 8500-EXIT.
  2095      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL612.cbl
  2097*****************************************************************
  2098 9000-RETURN-CICS.
  2099*****************************************************************
  2100     MOVE 'EL005'                TO  THIS-PGM.
  2101     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  2102     PERFORM 9300-XCTL.
  2103 9000-EXIT.
  2104      EXIT.
  2105*****************************************************************
  2106 9100-RETURN-TRAN.
  2107*****************************************************************
  2108     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  2109     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  2110
  2111* EXEC CICS RETURN
  2112*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2113*        LENGTH   (PI-COMM-LENGTH)
  2114*        TRANSID  (WS-TRANS-ID)
  2115*    END-EXEC.
  2116*    MOVE '.(CT                  &   #00001885' TO DFHEIV0
  2117     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2118     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2119     MOVE X'2020233030303031383835' TO DFHEIV0(25:11)
  2120     CALL 'kxdfhei1' USING DFHEIV0,
  2121           WS-TRANS-ID,
  2122           PROGRAM-INTERFACE-BLOCK,
  2123           PI-COMM-LENGTH,
  2124           DFHEIV99,
  2125           DFHEIV99
  2126     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2127
  2128 9100-EXIT.
  2129      EXIT.
  2130*****************************************************************
  2131 9300-XCTL.
  2132*****************************************************************
  2133     MOVE DFHENTER               TO  EIBAID.
  2134
  2135* EXEC CICS XCTL
  2136*        PROGRAM  (THIS-PGM)
  2137*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  2138*        LENGTH   (PI-COMM-LENGTH)
  2139*    END-EXEC.
  2140*    MOVE '.$C                   $   #00001896' TO DFHEIV0
  2141     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2142     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2143     MOVE X'2020233030303031383936' TO DFHEIV0(25:11)
  2144     CALL 'kxdfhei1' USING DFHEIV0,
  2145           THIS-PGM,
  2146           PROGRAM-INTERFACE-BLOCK,
  2147           PI-COMM-LENGTH
  2148     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2149
  2150 9300-EXIT.
  2151      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL612.cbl
  2153*****************************************************************
  2154 9400-CLEAR.
  2155*****************************************************************
  2156     MOVE PI-RETURN-TO-PROGRAM  TO  THIS-PGM.
  2157     PERFORM 9300-XCTL.
  2158 9400-EXIT.
  2159      EXIT.
  2160*****************************************************************
  2161 9600-PGMIDERR.
  2162*****************************************************************
  2163
  2164* EXEC CICS HANDLE CONDITION
  2165*        PGMIDERR (8300-SEND-TEXT)
  2166*    END-EXEC.
  2167*    MOVE '"$L                   ! # #00001914' TO DFHEIV0
  2168     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2169     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2170     MOVE X'2320233030303031393134' TO DFHEIV0(25:11)
  2171     CALL 'kxdfhei1' USING DFHEIV0
  2172     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2173
  2174     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  2175                                     LOGOFF-PGM.
  2176     MOVE 'EL005'                TO  THIS-PGM.
  2177     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  2178     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  2179     PERFORM 9300-XCTL.
  2180 9600-EXIT.
  2181      EXIT.
  2182*****************************************************************
  2183 9900-ERROR-FORMAT.
  2184*****************************************************************
  2185     IF EMI-ERRORS-COMPLETE
  2186         ADD +1             TO  EMI-FATAL-CTR
  2187         MOVE ZERO          TO  EMI-ERROR
  2188         GO TO 9900-EXIT.
  2189
  2190* EXEC CICS LINK
  2191*        PROGRAM  ('EL001')
  2192*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  2193*        LENGTH   (EMI-COMM-LENGTH)
  2194*    END-EXEC.
  2195     MOVE 'EL001' TO DFHEIV1
  2196*    MOVE '."C                   ''   #00001932' TO DFHEIV0
  2197     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2198     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2199     MOVE X'2020233030303031393332' TO DFHEIV0(25:11)
  2200     CALL 'kxdfhei1' USING DFHEIV0,
  2201           DFHEIV1,
  2202           ERROR-MESSAGE-INTERFACE-BLOCK,
  2203           EMI-COMM-LENGTH,
  2204           DFHEIV99,
  2205           DFHEIV99,
  2206           DFHEIV99
  2207     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2208
  2209     MOVE ZERO              TO  EMI-ERROR.
  2210 9900-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL612.cbl
  2211      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL612.cbl
  2213*****************************************************************
  2214 9990-ERROR.
  2215*****************************************************************
  2216     MOVE DFHEIBLK               TO EMI-LINE1.
  2217
  2218* EXEC CICS LINK
  2219*        PROGRAM   ('EL004')
  2220*        COMMAREA  (EMI-LINE1)
  2221*        LENGTH    (72)
  2222*    END-EXEC.
  2223     MOVE 'EL004' TO DFHEIV1
  2224     MOVE 72
  2225       TO DFHEIV11
  2226*    MOVE '."C                   ''   #00001945' TO DFHEIV0
  2227     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2228     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2229     MOVE X'2020233030303031393435' TO DFHEIV0(25:11)
  2230     CALL 'kxdfhei1' USING DFHEIV0,
  2231           DFHEIV1,
  2232           EMI-LINE1,
  2233           DFHEIV11,
  2234           DFHEIV99,
  2235           DFHEIV99,
  2236           DFHEIV99
  2237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2238
  2239     PERFORM 8200-SEND-DATAONLY.
  2240     GO TO 9100-RETURN-TRAN.
  2241 9990-EXIT.
  2242      EXIT.
  2243*****************************************************************
  2244 9995-SECURITY-VIOLATION.
  2245*****************************************************************
  2246*           COPY ELCSCTP.
  2247******************************************************************
  2248*                                                                *
  2249*                            ELCSCTP                             *
  2250*                            VMOD=2.001                          *
  2251*                                                                *
  2252*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2253******************************************************************
  2254
  2255
  2256     MOVE EIBDATE          TO SM-JUL-DATE.
  2257     MOVE EIBTRMID         TO SM-TERMID.
  2258     MOVE THIS-PGM         TO SM-PGM.
  2259     MOVE EIBTIME          TO TIME-IN.
  2260     MOVE TIME-OUT         TO SM-TIME.
  2261     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2262
  2263
  2264* EXEC CICS LINK
  2265*         PROGRAM  ('EL003')
  2266*         COMMAREA (SECURITY-MESSAGE)
  2267*         LENGTH   (80)
  2268*    END-EXEC.
  2269     MOVE 'EL003' TO DFHEIV1
  2270     MOVE 80
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL612.cbl
  2271       TO DFHEIV11
  2272*    MOVE '."C                   ''   #00001974' TO DFHEIV0
  2273     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2274     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2275     MOVE X'2020233030303031393734' TO DFHEIV0(25:11)
  2276     CALL 'kxdfhei1' USING DFHEIV0,
  2277           DFHEIV1,
  2278           SECURITY-MESSAGE,
  2279           DFHEIV11,
  2280           DFHEIV99,
  2281           DFHEIV99,
  2282           DFHEIV99
  2283     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2284
  2285
  2286******************************************************************
  2287
  2288 9995-EXIT.
  2289      EXIT.
  2290 9999-LAST-PARAGRAPH.
  2291
  2292* GOBACK.
  2293     MOVE '9%                    "   ' TO DFHEIV0
  2294     MOVE 'EL612' TO DFHEIV1
  2295     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2296     GOBACK.
  2297
  2298 9999-DFHBACK SECTION.
  2299     MOVE '9%                    "   ' TO DFHEIV0
  2300     MOVE 'EL612' TO DFHEIV1
  2301     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2302     GOBACK.
  2303 9999-DFHEXIT.
  2304     IF DFHEIGDJ EQUAL 0001
  2305         NEXT SENTENCE
  2306     ELSE IF DFHEIGDJ EQUAL 2
  2307         GO TO 9600-PGMIDERR,
  2308               9990-ERROR
  2309         DEPENDING ON DFHEIGDI
  2310     ELSE IF DFHEIGDJ EQUAL 3
  2311         GO TO 8300-SEND-TEXT
  2312         DEPENDING ON DFHEIGDI.
  2313     MOVE '9%                    "   ' TO DFHEIV0
  2314     MOVE 'EL612' TO DFHEIV1
  2315     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2316     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4820     Code:        5868
