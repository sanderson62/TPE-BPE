* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL6942.cbl
* Options: int("EL6942.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6942.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6942.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6942.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL6942.
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 10:03:45.
     7*                            VMOD=2.007
     8*
     9*
    10*AUTHOR.           LOGIC,INC.
    11*                  DALLAS,TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL6942.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOCIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS. TRANSACTION EXM5 - LETTER PRINTER
    26*        THIS PROGRAM IS USED TO PRINT THE STORED LETTERS AND
    27*        LABELS  DEPENDING ON THE VALUE OF THE PI-ENTRY-CODES.
    28
    29*        PRINT INITIAL LETTERS   CODE-1 = 1
    30*                                CODE-2 = 1
    31
    32*        PRINT FOLLOW-UP LETTERS CODE-1 = 1
    33*                                CODE-2 = 2
    34
    35*        RE-PRINT LETTERS        CODE-1 = 0
    36*                                CODE-2 = 3
    37
    38*        PRINT ADDRESS LABELS    CODE-1 = 0
    39*                                CODE-2 = 2
    40******************************************************************
    41*                   C H A N G E   L O G
    42*
    43* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    44*-----------------------------------------------------------------
    45*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    46* EFFECTIVE    NUMBER
    47*-----------------------------------------------------------------
    48* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    49******************************************************************
    50 ENVIRONMENT DIVISION.
    51 DATA DIVISION.
    52 WORKING-STORAGE SECTION.
    53 01  DFH-START PIC X(04).
    54 77  FILLER  PIC  X(32) VALUE '********************************'.
    55 77  FILLER  PIC  X(32) VALUE '*   EL6942 WORKING STORAGE     *'.
    56 77  FILLER  PIC  X(32) VALUE '********* V/M 2.007 ************'.
    57
    58 01  W-PROGRAM-CONSTANTS.
    59     12  FILLER                  PIC  X(18)
    60                                 VALUE 'PROGRAM CONSTANTS:'.
    61
    62     12  W-ZEROS                 PIC S9(04)  COMP VALUE +0.
    63
    64     12  W-ARCH-ID               PIC  X(08)  VALUE 'ERARCH'.
    65     12  W-ARCH3-ID              PIC  X(08)  VALUE 'ERARCH3'.
    66     12  W-ARCH4-ID              PIC  X(08)  VALUE 'ERARCH4'.
    67     12  W-ARCH5-ID              PIC  X(08)  VALUE 'ERARCH5'.
    68     12  W-ARCH6-ID              PIC  X(08)  VALUE 'ERARCH6'.
    69     12  W-ARCT-ID               PIC  X(08)  VALUE 'ERARCT'.
    70     12  W-CNTL-ID               PIC  X(08)  VALUE 'ELCNTL'.
    71
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL6942.cbl
    72 01  W-PROGRAM-WORK-AREA.
    73     12  THIS-PGM                PIC  X(8)  VALUE 'EL6942'.
    74     12  FILLER                  PIC  X(18)
    75                                 VALUE 'PROGRAM WORK AREA:'.
    76
    77     12  W-ASKTIME-CTR           PIC S9(04)  COMP.
    78     12  W-ARCHIVE-SAVE          PIC S9(08)  COMP.
    79     12  W-COPIES                PIC  9.
    80     12  W-DELAY-INTERVAL        PIC S9(07)  COMP-3 VALUE +2.
    81     12  W-NDX                   PIC S9(04)  COMP   VALUE +0.
    82     12  W-NUM-OF-TEXT-RECORDS   PIC S9(04)  COMP   VALUE +0.
    83     12  W-NUMBER-OF-LINES       PIC S9(04)  COMP.
    84     12  W-RECORD-COUNT          PIC S9(04)         VALUE +0.
    85     12  W-SAVE-ARCH-NO          PIC S9(08)  COMP   VALUE +0.
    86     12  W-SKIP                  PIC  9(02).
    87     12  W-SUB                   PIC S9(04)  COMP.
    88     12  W-LETTER-TOTALS         PIC  9(07)  COMP-3 VALUE 0.
    89
    90     12  W-ASTERISK-LINE1.
    91         16  FILLER              PIC  X(78)  VALUE ALL '*'.
    92     12  W-ASTERISK-LINE.
    93         16  FILLER              PIC  X(01)  VALUE SPACES.
    94         16  FILLER              PIC  X(78)  VALUE ALL '*'.
    95     12  W-CALL-PGM              PIC  X(08).
    96     12  W-CURRENT-SAVE          PIC  X(02).
    97     12  W-ERROR-LINE            PIC  X(80).
    98     12  W-LAST-RESENT-PRINT-DATE
    99                                 PIC  X(02)  VALUE SPACES.
   100
   101     12  W-LABEL-HOLD-AREA.
   102         16  W-LABEL-LINES OCCURS 6 TIMES INDEXED BY W-L-NDX.
   103             20  W-LABEL-ZIP.
   104                 24  W-LABEL-1ST-ZIP
   105                                 PIC  X(04).
   106                 24  W-LABEL-2ND-ZIP
   107                                 PIC  X(05).
   108             20  FILLER          PIC  X(12).
   109             20  WS-LAST-ZIP.
   110                 24  WS-LAST-1ST-ZIP
   111                                 PIC  X(04).
   112                 24  WS-LAST-2ND-ZIP
   113                                 PIC  X(05).
   114
   115     12  W-SAVE-CURRENT-DATE     PIC  X(08)  VALUE SPACES.
   116     12  W-SAVE-CURRENT-BIN-DATE PIC  X(02)  VALUE SPACES.
   117     12  W-SAVE-LETTER-ARCHIVE   PIC X(250)  VALUE SPACES.
   118     12  W-TOTAL-LINE.
   119         20  FILLER              PIC  X(01)  VALUE SPACES.
   120         20  FILLER              PIC  X(20)
   121             VALUE 'PROCESS COMPLETED.  '.
   122         20  W-TOTAL-LINE-DESC   PIC  X(26)
   123             VALUE 'LETTERS PRINTED TOTAL   - '.
   124         20  W-TOTAL-LETTERS     PIC Z,ZZZ,ZZ9.
   125     12  W-WORKING-RESEND-DATE   PIC  X(02)  VALUE SPACES.
   126     12  W-LABEL-LINE-DESC   PIC  X(26)
   127             VALUE 'LABELS PRINTED TOTAL    - '.
   128
   129 01  W-PROGRAM-KEYS.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL6942.cbl
   130     12  FILLER                  PIC  X(13)
   131                                 VALUE 'PROGRAM KEYS:'.
   132     12  W-ARCH-KEY.
   133         20  W-ARCH-COMPANY-CD   PIC  X(01).
   134         20  W-ARCH-NUMBER       PIC S9(08)     COMP.
   135
   136     12  W-ARCH3-KEY.
   137         16  W-ARCH3-COMPANY-CD  PIC  X(01).
   138         16  W-ARCH3-FORM        PIC  X(04).
   139         16  W-ARCH3-CARRIER     PIC  X(01).
   140         16  W-ARCH3-GROUPING    PIC  X(06).
   141         16  W-ARCH3-STATE       PIC  X(02).
   142         16  W-ARCH3-ACCOUNT     PIC  X(10).
   143         16  W-ARCH3-ARCHIVE-NO  PIC S9(08)  COMP.
   144
   145     12  W-ARCH4-KEY.
   146         16  W-ARCH4-COMPANY-CD  PIC  X(01).
   147         16  W-ARCH4-PROCESSOR-CD
   148                                 PIC  X(04).
   149         16  W-ARCH4-CARRIER     PIC  X(01).
   150         16  W-ARCH4-GROUPING    PIC  X(06).
   151         16  W-ARCH4-STATE       PIC  X(02).
   152         16  W-ARCH4-ACCOUNT     PIC  X(10).
   153         16  W-ARCH4-ARCHIVE-NO  PIC S9(08)    COMP.
   154
   155     12  W-ARCH5-KEY.
   156         16  W-ARCH5-COMPANY-CD  PIC  X(01).
   157         16  W-ARCH5-CARRIER     PIC  X(01).
   158         16  W-ARCH5-GROUPING    PIC  X(06).
   159         16  W-ARCH5-STATE       PIC  X(02).
   160         16  W-ARCH5-ACCOUNT     PIC  X(10).
   161         16  W-ARCH5-ARCHIVE-NO  PIC S9(08)  COMP.
   162
   163     12  W-ARCH6-KEY.
   164         16  W-ARCH6-COMPANY-CD  PIC  X(01).
   165         16  W-ARCH6-ENTRY.
   166             20  W-ARCH6-FILLER  PIC  X(02).
   167             20  W-ARCH6-CONTROL PIC S9(08)  COMP.
   168         16  W-ARCH6-ARCHIVE-NO  PIC S9(08)  COMP.
   169
   170     12  W-ARCT-KEY.
   171         16  W-ARCT-PARTIAL-KEY.
   172             20  W-ARCT-COMPANY-CD
   173                                 PIC  X(01).
   174             20  W-ARCT-NUMBER   PIC S9(08)     COMP.
   175         16  W-ARCT-REC-ID       PIC  X(01).
   176         16  W-ARCT-SEQ          PIC S9(04)     COMP VALUE +0.
   177
   178     12  W-CNTL-KEY.
   179         16  W-CNTL-COMPANY-ID   PIC  X(03).
   180         16  W-CNTL-RECORD-TYPE  PIC  X(01)  VALUE '1'.
   181         16  W-CNTL-GENL.
   182             20  W-CNTL-GEN1     PIC  X(02)  VALUE SPACES.
   183             20  W-CNTL-GEN2.
   184                 24 W-CNTL-GEN3  PIC  X(01)  VALUE SPACES.
   185                 24 W-CNTL-GEN4  PIC  X(01)  VALUE SPACES.
   186         16  W-CNTL-SEQ          PIC S9(04)  VALUE +0    COMP.
   187
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL6942.cbl
   188 01  W-PROGRAM-SWITCES.
   189     12  FILLER                  PIC  X(17)
   190                                 VALUE 'PROGRAM SWITCHES:'.
   191
   192     12  W-ENDBR-SW              PIC  X(01)          VALUE ' '.
   193         88  W-ENDBR                                 VALUE 'Y'.
   194     12  W-FIRST-FORM-SW         PIC  X(01)          VALUE ' '.
   195         88  W-THIS-IS-FIRST-FORM                    VALUE ' '.
   196         88  W-THIS-IS-NOT-FIRST-FORM                VALUE 'Y'.
   197     12  W-HEADER-BROWSE-STARTED PIC  X(01)          VALUE 'N'.
   198     12  W-HEADER-SW             PIC  X(01)          VALUE SPACE.
   199         88  W-HEADER-REC-FOUND                      VALUE SPACE.
   200     12  W-PRINT-SW              PIC S9(01) COMP-3   VALUE ZERO.
   201     12  W-PROCESSING-SW         PIC S9(01) COMP-3   VALUE ZERO.
   202         88  W-PROCESS-BY-KEY                        VALUE +3.
   203     12  W-TEXT-BROWSE-STARTED   PIC  X(01)          VALUE 'N'.
   204     12  W-TOP-FORM-SW           PIC  X(01)          VALUE SPACE.
   205         88  W-TOP-FORM-SET                          VALUE 'T'.
   206     12  W-OPTION-CODES          PIC  X(02).
   207         88  W-PRINT-INITIAL                         VALUE '11'.
   208         88  W-PRINT-FOLLOW-UP                       VALUE '12'.
   209         88  W-PRINT-LABELS                          VALUE ' 2'.
   210         88  W-REPRINT-LETTERS                       VALUE ' 3'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL6942.cbl
   212 01  FILLER                      PIC  X(25)
   213                             VALUE 'PROGRAM INTERFACE STARTS:'.
   214*                                COPY ELCINTF.
   215******************************************************************
   216*                                                                *
   217*                                                                *
   218*                            ELCINTF.                            *
   219*                            VMOD=2.017                          *
   220*                                                                *
   221*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   222*                                                                *
   223*       LENGTH = 1024                                            *
   224*                                                                *
   225******************************************************************
   226 01  PROGRAM-INTERFACE-BLOCK.
   227     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   228     12  PI-CALLING-PROGRAM              PIC X(8).
   229     12  PI-SAVED-PROGRAM-1              PIC X(8).
   230     12  PI-SAVED-PROGRAM-2              PIC X(8).
   231     12  PI-SAVED-PROGRAM-3              PIC X(8).
   232     12  PI-SAVED-PROGRAM-4              PIC X(8).
   233     12  PI-SAVED-PROGRAM-5              PIC X(8).
   234     12  PI-SAVED-PROGRAM-6              PIC X(8).
   235     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   236     12  PI-COMPANY-ID                   PIC XXX.
   237     12  PI-COMPANY-CD                   PIC X.
   238
   239     12  PI-COMPANY-PASSWORD             PIC X(8).
   240
   241     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   242
   243     12  PI-CONTROL-IN-PROGRESS.
   244         16  PI-CARRIER                  PIC X.
   245         16  PI-GROUPING                 PIC X(6).
   246         16  PI-STATE                    PIC XX.
   247         16  PI-ACCOUNT                  PIC X(10).
   248         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   249                                         PIC X(10).
   250         16  PI-CLAIM-CERT-GRP.
   251             20  PI-CLAIM-NO             PIC X(7).
   252             20  PI-CERT-NO.
   253                 25  PI-CERT-PRIME       PIC X(10).
   254                 25  PI-CERT-SFX         PIC X.
   255             20  PI-CERT-EFF-DT          PIC XX.
   256         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   257             20  PI-PLAN-CODE            PIC X(2).
   258             20  PI-REVISION-NUMBER      PIC X(3).
   259             20  PI-PLAN-EFF-DT          PIC X(2).
   260             20  PI-PLAN-EXP-DT          PIC X(2).
   261             20  FILLER                  PIC X(11).
   262         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   263             20  PI-OE-REFERENCE-1.
   264                 25  PI-OE-REF-1-PRIME   PIC X(18).
   265                 25  PI-OE-REF-1-SUFF    PIC XX.
   266
   267     12  PI-SESSION-IN-PROGRESS          PIC X.
   268         88  CLAIM-SESSION                   VALUE '1'.
   269         88  CREDIT-SESSION                  VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL6942.cbl
   270         88  WARRANTY-SESSION                VALUE '3'.
   271         88  MORTGAGE-SESSION                VALUE '4'.
   272         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   273
   274
   275*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   276
   277     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   278     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   279
   280     12  PI-CREDIT-USER                  PIC X.
   281         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   282         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   283
   284     12  PI-CLAIM-USER                   PIC X.
   285         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   286         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   287
   288     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   289         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   290         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   291         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   292         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   293         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   294
   295     12  PI-PROCESSOR-ID                 PIC X(4).
   296
   297     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   298
   299     12  PI-MEMBER-CAPTION               PIC X(10).
   300
   301     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   302         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   303
   304     12  PI-LIFE-OVERRIDE-L1             PIC X.
   305     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   306     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   307     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   308
   309     12  PI-AH-OVERRIDE-L1               PIC X.
   310     12  PI-AH-OVERRIDE-L2               PIC XX.
   311     12  PI-AH-OVERRIDE-L6               PIC X(6).
   312     12  PI-AH-OVERRIDE-L12              PIC X(12).
   313
   314     12  PI-NEW-SYSTEM                   PIC X(2).
   315
   316     12  PI-PRIMARY-CERT-NO              PIC X(11).
   317     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   318         88  PI-USES-PAID-TO                 VALUE '1'.
   319     12  PI-CRDTCRD-SYSTEM.
   320         16  PI-CRDTCRD-USER             PIC X.
   321             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   322             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   323         16  PI-CC-MONTH-END-DT          PIC XX.
   324     12  PI-PROCESSOR-PRINTER            PIC X(4).
   325
   326     12  PI-OE-REFERENCE-2.
   327         16  PI-OE-REF-2-PRIME           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL6942.cbl
   328         16  PI-OE-REF-2-SUFF            PIC X.
   329
   330     12  PI-REM-TRM-CALC-OPTION          PIC X.
   331
   332     12  PI-LANGUAGE-TYPE                PIC X.
   333             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   334             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   335             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   336
   337     12  PI-POLICY-LINKAGE-IND           PIC X.
   338         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   339         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   340                                                   LOW-VALUES.
   341
   342     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   343     12  PI-CLAIM-PW-SESSION             PIC X(1).
   344         88  PI-CLAIM-CREDIT                 VALUE '1'.
   345         88  PI-CLAIM-CONVEN                 VALUE '2'.
   346     12  FILLER                          PIC X(4).
   347
   348     12  PI-SYSTEM-LEVEL                 PIC X(145).
   349
   350     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   351         PI-SYSTEM-LEVEL.
   352
   353         16  PI-ENTRY-CODES.
   354             20  PI-ENTRY-CD-1           PIC X.
   355             20  PI-ENTRY-CD-2           PIC X.
   356
   357         16  PI-RETURN-CODES.
   358             20  PI-RETURN-CD-1          PIC X.
   359             20  PI-RETURN-CD-2          PIC X.
   360
   361         16  PI-UPDATE-STATUS-SAVE.
   362             20  PI-UPDATE-BY            PIC X(4).
   363             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   364
   365         16  PI-LOWER-CASE-LETTERS       PIC X.
   366             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   367
   368*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   369*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   370*            88  CARRIER-CLM-CNTL            VALUE '2'.
   371
   372         16  PI-CERT-ACCESS-CONTROL      PIC X.
   373             88  ST-ACCNT-CNTL               VALUE ' '.
   374             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   375             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   376             88  ACCNT-CNTL                  VALUE '3'.
   377             88  CARR-ACCNT-CNTL             VALUE '4'.
   378
   379         16  PI-PROCESSOR-CAP-LIST.
   380             20  PI-SYSTEM-CONTROLS.
   381                24 PI-SYSTEM-DISPLAY     PIC X.
   382                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   383                24 PI-SYSTEM-MODIFY      PIC X.
   384                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   385             20  FILLER                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL6942.cbl
   386             20  PI-DISPLAY-CAP          PIC X.
   387                 88  DISPLAY-CAP             VALUE 'Y'.
   388             20  PI-MODIFY-CAP           PIC X.
   389                 88  MODIFY-CAP              VALUE 'Y'.
   390             20  PI-MSG-AT-LOGON-CAP     PIC X.
   391                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   392             20  PI-FORCE-CAP            PIC X.
   393                 88  FORCE-CAP               VALUE 'Y'.
   394
   395         16  PI-PROGRAM-CONTROLS.
   396             20  PI-PGM-PRINT-OPT        PIC X.
   397             20  PI-PGM-FORMAT-OPT       PIC X.
   398             20  PI-PGM-PROCESS-OPT      PIC X.
   399             20  PI-PGM-TOTALS-OPT       PIC X.
   400
   401         16  PI-HELP-INTERFACE.
   402             20  PI-LAST-ERROR-NO        PIC X(4).
   403             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   404
   405         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   406             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   407
   408         16  PI-CR-CONTROL-IN-PROGRESS.
   409             20  PI-CR-CARRIER           PIC X.
   410             20  PI-CR-GROUPING          PIC X(6).
   411             20  PI-CR-STATE             PIC XX.
   412             20  PI-CR-ACCOUNT           PIC X(10).
   413             20  PI-CR-FIN-RESP          PIC X(10).
   414             20  PI-CR-TYPE              PIC X.
   415
   416         16  PI-CR-BATCH-NUMBER          PIC X(6).
   417
   418         16  PI-CR-MONTH-END-DT          PIC XX.
   419
   420         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   421             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   422             88  PI-ZERO-CARRIER             VALUE '1'.
   423             88  PI-ZERO-GROUPING            VALUE '2'.
   424             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   425
   426         16  PI-CARRIER-SECURITY         PIC X.
   427             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   428
   429         16  PI-ACCOUNT-SECURITY         PIC X(10).
   430             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   431             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   432
   433         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   434             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   435                                         INDEXED BY PI-ACCESS-NDX
   436                                         PIC X.
   437
   438         16  PI-GA-BILLING-CONTROL       PIC X.
   439             88  PI-GA-BILLING               VALUE '1'.
   440
   441         16  PI-MAIL-PROCESSING          PIC X.
   442             88  PI-MAIL-YES                 VALUE 'Y'.
   443
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL6942.cbl
   444         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   445
   446         16  PI-AR-SYSTEM.
   447             20  PI-AR-PROCESSING-CNTL   PIC X.
   448                 88  PI-AR-PROCESSING        VALUE 'Y'.
   449             20  PI-AR-SUMMARY-CODE      PIC X(6).
   450             20  PI-AR-MONTH-END-DT      PIC XX.
   451
   452         16  PI-MP-SYSTEM.
   453             20  PI-MORTGAGE-USER            PIC X.
   454                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   455                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   456             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   457                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   458                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   459                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   460                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   461                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   462             20  PI-MP-MONTH-END-DT          PIC XX.
   463             20  PI-MP-REFERENCE-NO.
   464                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   465                 24  PI-MP-REFERENCE-SFX     PIC XX.
   466
   467         16  PI-LABEL-CONTROL            PIC X(01).
   468             88  PI-CREATE-LABELS                    VALUE 'Y'.
   469             88  PI-BYPASS-LABELS                    VALUE 'N'.
   470
   471         16  PI-BILL-GROUPING-CODE       PIC X(01).
   472             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   473
   474         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   475             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   476             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   477
   478         16  FILLER                      PIC X(14).
   479
   480     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   481******************************************************************
   482     12  PI-WA REDEFINES PI-PROGRAM-WORK-AREA.
   483**********************************************************
   484         16  PI-6942-ALIGNMENT-COPIES
   485                                 PIC S9(01) COMP-3.
   486         16  PI-6942-PRINT-DATE  PIC  X(08).
   487         16  PI-6942-PRINT-DATE-BIN
   488                                 PIC  X(02).
   489         16  PI-6942-PRINT-BY-KEY-IND
   490                                 PIC  X(01).
   491             88  PI-6942-PRINT-BY-KEY      VALUE 'C' 'G' 'S' 'A'.
   492             88  PI-6942-PRINT-BY-CARRIER  VALUE 'C'.
   493             88  PI-6942-PRINT-BY-GROUPING VALUE 'G'.
   494             88  PI-6942-PRINT-BY-STATE    VALUE 'S'.
   495             88  PI-6942-PRINT-BY-ACCOUNT  VALUE 'A'.
   496         16  PI-6942-PRINT-BY-PROCESSOR-IND
   497                                 PIC  X(01).
   498             88  PI-6942-PRINT-BY-PROCESSOR
   499                                           VALUE 'Y'.
   500         16  PI-6942-PRINT-ID    PIC  X(04).
   501         16  PI-6942-PRINT-KEY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL6942.cbl
   502             20  PI-6942-PRINT-CARRIER
   503                                 PIC  X(01).
   504             20  PI-6942-PRINT-GROUPING
   505                                 PIC  X(06).
   506             20  PI-6942-PRINT-STATE
   507                                 PIC  X(02).
   508             20  PI-6942-PRINT-ACCOUNT
   509                                 PIC  X(10).
   510         16  PI-6942-PRINT-PROCESSOR
   511                                 PIC  X(04).
   512         16  PI-6942-LETTER-FORM PIC  X(04).
   513         16  PI-6942-LETTER-TYPE PIC  X(01).
   514         16  PI-6942-STARTING-ARCH-NO
   515                                 PIC S9(08) COMP.
   516         16  PI-6942-ENTRY.
   517             20  PI-6942-FILLER  PIC  X(02).
   518             20  PI-6942-QUE-CONTROL
   519                                 PIC S9(08) COMP.
   520         16  FILLER              PIC X(585).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL6942.cbl
   522*    COPY ELPRTCVD.
   523*****************************************************************
   524*                                                               *
   525*                            ELPRTCVD.                          *
   526*                            VMOD=2.001                         *
   527*****************************************************************.
   528
   529******************************************************************
   530***   WORK AREAS  FOR TERMINAL ONLINE PRINT ROUTINE
   531***                 -ELPRTCVD-
   532***   TO BE USED WITH PROCEDURE COPY MEMBER -ELPRTCVP-
   533******************************************************************
   534
   535 01  S-WORK-AREA                     SYNC.
   536     12  WS-LINE-LEN                 PIC S9(4)       VALUE +80
   537                                     COMP.
   538
   539     12  WS-LINE-LENGTH              PIC S9(4)       VALUE ZERO
   540                                     COMP.
   541
   542     12  WS-BUFFER-SIZE              PIC S9(4)       VALUE +1916
   543                                     COMP.
   544
   545     12  WS-BUFFER-LENGTH            PIC S9(4)       VALUE ZERO
   546                                     COMP.
   547
   548     12  WS-PROG-END                 PIC X           VALUE SPACES.
   549
   550     12  WS-PRINT-AREA.
   551         16  WS-PASSED-CNTL-CHAR     PIC X           VALUE SPACES.
   552           88  SINGLE-SPACE                          VALUE ' '.
   553           88  DOUBLE-SPACE                          VALUE '0'.
   554           88  TRIPLE-SPACE                          VALUE '-'.
   555           88  TOP-PAGE                              VALUE '1'.
   556
   557         16  WS-PASSED-DATA.
   558             20  WS-PRINT-BYTE       PIC X
   559                 OCCURS 132 TIMES    INDEXED BY PRT-INDEX.
   560
   561     12  WS-LINE-CNT                 PIC S9(3)        VALUE ZERO
   562                                     COMP-3.
   563     12  WS-WCC-CNTL                 PIC X(1)         VALUE 'H'.
   564
   565     12  WS-EM                       PIC S9(4)        VALUE +25
   566                                     COMP.
   567     12  FILLER   REDEFINES WS-EM.
   568         16  FILLER                  PIC X.
   569         16  T-EM                    PIC X.
   570
   571*    12  WS-SS                       PIC S9(4)        VALUE +21
   572     12  WS-SS                       PIC S9(4)        VALUE +10
   573                                     COMP.
   574     12  FILLER   REDEFINES WS-SS.
   575         16  FILLER                  PIC X.
   576         16  T-SS                    PIC X.
   577
   578     12  WS-TP                       PIC S9(4)      VALUE +12
   579                                     COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL6942.cbl
   580     12  FILLER   REDEFINES WS-TP.
   581         16  FILLER                  PIC X.
   582         16  T-TP                    PIC X.
   583
   584     12  WS-FIRST-TIME-SW            PIC X           VALUE '1'.
   585         88  FIRST-TIME                              VALUE '1'.
   586         88  FIRST-LINE-NEXT-BUFFER                  VALUE '2'.
   587
   588     12  WS-BUFFER-AREA.
   589         16  WS-BUFFER-BYTE          PIC X
   590             OCCURS 1920 TIMES       INDEXED BY BUFFER-INDEX
   591                                                BUFFER-INDEX2.
   592
   593******************************************************************
   594 01  FILLER.
   595     16  FILLER                  PIC  X(200)
   596         VALUE 'THIS IS PART OF THE BUFFER ZONE'.
   597
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL6942.cbl
   599 01  FILLER                      PIC  X(18)
   600                             VALUE 'WORK TABLE STARTS:'.
   601
   602 01  W-ADJUST-AREA.
   603     12  FILLER                  PIC  X(07).
   604     12  W-AD-PRINT-AREA         PIC  X(70).
   605     12  FILLER                  PIC  X(03).
   606
   607 01  W-WORK-TABLE.
   608     12  W-WORK-LINE OCCURS 300 TIMES
   609                          INDEXED BY W-WK-NDX.
   610         16  W-TEXT-LINE         PIC  X(70).
   611         16  W-SKIP-CONTROL      PIC  X(02).
   612             88  W-NO-LINES-SKIPPED            VALUE SPACES.
   613             88  W-SKIP-TO-NEXT-PAGE           VALUE '99'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL6942.cbl
   615
   616 01  FILLER                      PIC  X(16)
   617                             VALUE 'WORK TABLE ENDS:'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL6942.cbl
   619*    COPY ELCDATE.
   620******************************************************************
   621*                                                                *
   622*                                                                *
   623*                            ELCDATE.                            *
   624*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   625*                            VMOD=2.003
   626*                                                                *
   627*                                                                *
   628*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   629*                 LENGTH = 200                                   *
   630******************************************************************
   631
   632 01  DATE-CONVERSION-DATA.
   633     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   634     12  DC-OPTION-CODE                PIC X.
   635         88  BIN-TO-GREG                VALUE ' '.
   636         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   637         88  EDIT-GREG-TO-BIN           VALUE '2'.
   638         88  YMD-GREG-TO-BIN            VALUE '3'.
   639         88  MDY-GREG-TO-BIN            VALUE '4'.
   640         88  JULIAN-TO-BIN              VALUE '5'.
   641         88  BIN-PLUS-ELAPSED           VALUE '6'.
   642         88  FIND-CENTURY               VALUE '7'.
   643         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   644         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   645         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   646         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   647         88  JULIAN-TO-BIN-3            VALUE 'C'.
   648         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   649         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   650         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   651         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   652         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   653         88  CHECK-LEAP-YEAR            VALUE 'H'.
   654         88  BIN-3-TO-GREG              VALUE 'I'.
   655         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   656         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   657         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   658         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   659         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   660         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   661         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   662         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   663         88  THREE-CHARACTER-BIN
   664                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   665         88  GREGORIAN-TO-BIN
   666                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   667         88  BIN-TO-GREGORIAN
   668                  VALUES ' ' '1' 'I' '8' 'G'.
   669         88  JULIAN-TO-BINARY
   670                  VALUES '5' 'C' 'E' 'F'.
   671     12  DC-ERROR-CODE                 PIC X.
   672         88  NO-CONVERSION-ERROR        VALUE ' '.
   673         88  DATE-CONVERSION-ERROR
   674                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   675         88  DATE-IS-ZERO               VALUE '1'.
   676         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL6942.cbl
   677         88  DATE-IS-INVALID            VALUE '3'.
   678         88  DATE1-GREATER-DATE2        VALUE '4'.
   679         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   680         88  DATE-INVALID-OPTION        VALUE '9'.
   681         88  INVALID-CENTURY            VALUE 'A'.
   682         88  ONLY-CENTURY               VALUE 'B'.
   683         88  ONLY-LEAP-YEAR             VALUE 'C'.
   684         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   685     12  DC-END-OF-MONTH               PIC X.
   686         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   687     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   688         88  USE-NORMAL-PROCESS         VALUE ' '.
   689         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   690         88  ADJUST-UP-100-YRS          VALUE '2'.
   691     12  FILLER                        PIC X.
   692     12  DC-CONVERSION-DATES.
   693         16  DC-BIN-DATE-1             PIC XX.
   694         16  DC-BIN-DATE-2             PIC XX.
   695         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   696         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   697                       DC-GREG-DATE-1-EDIT.
   698             20  DC-EDIT1-MONTH        PIC 99.
   699             20  SLASH1-1              PIC X.
   700             20  DC-EDIT1-DAY          PIC 99.
   701             20  SLASH1-2              PIC X.
   702             20  DC-EDIT1-YEAR         PIC 99.
   703         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   704         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   705                     DC-GREG-DATE-2-EDIT.
   706             20  DC-EDIT2-MONTH        PIC 99.
   707             20  SLASH2-1              PIC X.
   708             20  DC-EDIT2-DAY          PIC 99.
   709             20  SLASH2-2              PIC X.
   710             20  DC-EDIT2-YEAR         PIC 99.
   711         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   712         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   713                     DC-GREG-DATE-1-YMD.
   714             20  DC-YMD-YEAR           PIC 99.
   715             20  DC-YMD-MONTH          PIC 99.
   716             20  DC-YMD-DAY            PIC 99.
   717         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   718         16  DC-GREG-DATE-1-MDY-R REDEFINES
   719                      DC-GREG-DATE-1-MDY.
   720             20  DC-MDY-MONTH          PIC 99.
   721             20  DC-MDY-DAY            PIC 99.
   722             20  DC-MDY-YEAR           PIC 99.
   723         16  DC-GREG-DATE-1-ALPHA.
   724             20  DC-ALPHA-MONTH        PIC X(10).
   725             20  DC-ALPHA-DAY          PIC 99.
   726             20  FILLER                PIC XX.
   727             20  DC-ALPHA-CENTURY.
   728                 24 DC-ALPHA-CEN-N     PIC 99.
   729             20  DC-ALPHA-YEAR         PIC 99.
   730         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   731         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   732         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   733         16  DC-JULIAN-DATE            PIC 9(05).
   734         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL6942.cbl
   735                                       PIC 9(05).
   736         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   737             20  DC-JULIAN-YEAR        PIC 99.
   738             20  DC-JULIAN-DAYS        PIC 999.
   739         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   740         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   741         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   742     12  DATE-CONVERSION-VARIBLES.
   743         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   744         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   745             20  FILLER                PIC 9(3).
   746             20  HOLD-CEN-1-CCYY.
   747                 24  HOLD-CEN-1-CC     PIC 99.
   748                 24  HOLD-CEN-1-YY     PIC 99.
   749             20  HOLD-CEN-1-MO         PIC 99.
   750             20  HOLD-CEN-1-DA         PIC 99.
   751         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   752             20  HOLD-CEN-1-R-MO       PIC 99.
   753             20  HOLD-CEN-1-R-DA       PIC 99.
   754             20  HOLD-CEN-1-R-CCYY.
   755                 24  HOLD-CEN-1-R-CC   PIC 99.
   756                 24  HOLD-CEN-1-R-YY   PIC 99.
   757             20  FILLER                PIC 9(3).
   758         16  HOLD-CENTURY-1-X.
   759             20  FILLER                PIC X(3)  VALUE SPACES.
   760             20  HOLD-CEN-1-X-CCYY.
   761                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   762                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   763             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   764             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   765         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   766             20  HOLD-CEN-1-R-X-MO     PIC XX.
   767             20  HOLD-CEN-1-R-X-DA     PIC XX.
   768             20  HOLD-CEN-1-R-X-CCYY.
   769                 24  HOLD-CEN-1-R-X-CC PIC XX.
   770                 24  HOLD-CEN-1-R-X-YY PIC XX.
   771             20  FILLER                PIC XXX.
   772         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   773         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   774         16  DC-JULIAN-DATE-1          PIC 9(07).
   775         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   776             20  DC-JULIAN-1-CCYY.
   777                 24  DC-JULIAN-1-CC    PIC 99.
   778                 24  DC-JULIAN-1-YR    PIC 99.
   779             20  DC-JULIAN-DA-1        PIC 999.
   780         16  DC-JULIAN-DATE-2          PIC 9(07).
   781         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   782             20  DC-JULIAN-2-CCYY.
   783                 24  DC-JULIAN-2-CC    PIC 99.
   784                 24  DC-JULIAN-2-YR    PIC 99.
   785             20  DC-JULIAN-DA-2        PIC 999.
   786         16  DC-GREG-DATE-A-EDIT.
   787             20  DC-EDITA-MONTH        PIC 99.
   788             20  SLASHA-1              PIC X VALUE '/'.
   789             20  DC-EDITA-DAY          PIC 99.
   790             20  SLASHA-2              PIC X VALUE '/'.
   791             20  DC-EDITA-CCYY.
   792                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL6942.cbl
   793                 24  DC-EDITA-YEAR     PIC 99.
   794         16  DC-GREG-DATE-B-EDIT.
   795             20  DC-EDITB-MONTH        PIC 99.
   796             20  SLASHB-1              PIC X VALUE '/'.
   797             20  DC-EDITB-DAY          PIC 99.
   798             20  SLASHB-2              PIC X VALUE '/'.
   799             20  DC-EDITB-CCYY.
   800                 24  DC-EDITB-CENT     PIC 99.
   801                 24  DC-EDITB-YEAR     PIC 99.
   802         16  DC-GREG-DATE-CYMD         PIC 9(08).
   803         16  DC-GREG-DATE-CYMD-R REDEFINES
   804                              DC-GREG-DATE-CYMD.
   805             20  DC-CYMD-CEN           PIC 99.
   806             20  DC-CYMD-YEAR          PIC 99.
   807             20  DC-CYMD-MONTH         PIC 99.
   808             20  DC-CYMD-DAY           PIC 99.
   809         16  DC-GREG-DATE-MDCY         PIC 9(08).
   810         16  DC-GREG-DATE-MDCY-R REDEFINES
   811                              DC-GREG-DATE-MDCY.
   812             20  DC-MDCY-MONTH         PIC 99.
   813             20  DC-MDCY-DAY           PIC 99.
   814             20  DC-MDCY-CEN           PIC 99.
   815             20  DC-MDCY-YEAR          PIC 99.
   816    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   817        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   818    12  DC-EL310-DATE                  PIC X(21).
   819    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL6942.cbl
   821*    COPY ERCARCH.
   822******************************************************************
   823*                                                                *
   824*                            ERCARCH.                            *
   825*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   826*                            VMOD=2.002                          *
   827*                                                                *
   828*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
   829*                                                                *
   830*   FILE TYPE = VSAM,KSDS                                        *
   831*   RECORD SIZE = 250  RECFORM = FIXED                           *
   832*                                                                *
   833*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
   834*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
   835*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
   836*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
   837*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
   838*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
   839*                                                                *
   840*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   841******************************************************************
   842*                   C H A N G E   L O G
   843*
   844* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   845*-----------------------------------------------------------------
   846*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   847* EFFECTIVE    NUMBER
   848*-----------------------------------------------------------------
   849* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
   850******************************************************************
   851 01  LETTER-ARCHIVE.
   852     12  LA-RECORD-ID                PIC  X(02).
   853         88  LA-VALID-ID                VALUE 'LA'.
   854
   855     12  LA-CONTROL-PRIMARY.
   856         16  LA-COMPANY-CD           PIC  X(01).
   857         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
   858
   859     12  LA-CONTROL-BY-CERT-RESP.
   860         16  LA-COMPANY-CD-A2        PIC  X(01).
   861         16  LA-CERT-NO-A2.
   862             20  LA-CERT-PRIME-A2    PIC  X(10).
   863             20  LA-CERT-SUFFIX-A2   PIC  X(01).
   864         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
   865             20  LA-RESP-PERSON-A2   PIC  X(10).
   866             20  LA-TYPE-A2          PIC  X(01).
   867         16  LA-CARRIER-A2           PIC  X(01).
   868         16  LA-GROUPING-A2          PIC  X(06).
   869         16  LA-STATE-A2             PIC  X(02).
   870         16  LA-ACCOUNT-A2           PIC  X(10).
   871         16  LA-EFFECT-DATE-A2       PIC  X(02).
   872         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
   873
   874     12  LA-CONTROL-BY-FORM.
   875         16  LA-COMPANY-CD-A3        PIC  X(01).
   876         16  LA-FORM-A3              PIC  X(04).
   877         16  LA-CARRIER-A3           PIC  X(01).
   878         16  LA-GROUPING-A3          PIC  X(06).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL6942.cbl
   879         16  LA-STATE-A3             PIC  X(02).
   880         16  LA-ACCOUNT-A3           PIC  X(10).
   881         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
   882
   883     12  LA-CONTROL-BY-PROCESSOR.
   884         16  LA-COMPANY-CD-A4        PIC  X(01).
   885         16  LA-PROCESSOR-CD         PIC  X(04).
   886         16  LA-CARRIER-A4           PIC  X(01).
   887         16  LA-GROUPING-A4          PIC  X(06).
   888         16  LA-STATE-A4             PIC  X(02).
   889         16  LA-ACCOUNT-A4           PIC  X(10).
   890         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
   891
   892     12  LA-CONTROL-BY-KEY-FIELDS.
   893         16  LA-COMPANY-CD-A5        PIC  X(01).
   894         16  LA-CARRIER-A5           PIC  X(01).
   895         16  LA-GROUPING-A5          PIC  X(06).
   896         16  LA-STATE-A5             PIC  X(02).
   897         16  LA-ACCOUNT-A5           PIC  X(10).
   898         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
   899
   900     12  LA-CONTROL-BY-GROUP-CODE.
   901         16  LA-COMPANY-CD-A6        PIC  X(01).
   902         16  LA-ENTRY-A6.
   903             20  LA-FILLER           PIC  X(02).
   904             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
   905         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
   906
   907     12  FILLER                      PIC  X(09).
   908
   909     12  LA-HEADER-RECORD.
   910         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
   911         16  LA-CREATION-DATE        PIC  X(02).
   912         16  LA-FOLLOW-UP-DATE       PIC  X(02).
   913         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
   914         16  LA-NO-OF-COPIES         PIC S9(01).
   915         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
   916         16  LA-REPLY-DATE           PIC  X(02).
   917         16  LA-RESEND-DATES.
   918             20  LA-RESEND-DATE      PIC  X(02).
   919             20  LA-SENT-DATE        PIC  X(02).
   920             20  FILLER              PIC  X(08).
   921         16  LA-SOURCE-INFORMATION.
   922             20  LA-DATA-SOURCE      PIC  X(01).
   923             20  LA-ADDR-SOURCE      PIC  X(01).
   924         16  LA-STATUS               PIC  X(01).
   925             88  LA-STATUS-ACTIVE         VALUE 'A'.
   926             88  LA-STATUS-COMPLETED      VALUE 'C'.
   927             88  LA-STATUS-ON-HOLD        VALUE 'H'.
   928             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
   929             88  LA-STATUS-PURGED         VALUE 'P'.
   930             88  LA-STATUS-VOIDED         VALUE 'V'.
   931         16  LA-LAST-RESENT-PRINT-DATE
   932                                     PIC  X(02).
   933         16  LA-PRINT-RESTRICTION    PIC  X(01).
   934             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
   935                                          VALUE 'C'.
   936             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL6942.cbl
   937                                          VALUE 'F'.
   938             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
   939                                          VALUE 'P'.
   940         16  LA-PURGED-DATE          PIC  X(02).
   941         16  LA-VOIDED-DATE          PIC  X(02).
   942         16  LA-RESEND-LETR          PIC  X(4).
   943         16  FILLER                  PIC  X(08).
   944*        16  LA-RESEND-LETR-2        PIC  X(4).
   945*        16  LA-RESEND-LETR-3        PIC  X(4).
   946         16  FILLER                  PIC  X(59).
   947*        16  FILLER                  PIC  X(71).
   948
   949******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL6942.cbl
   951*    COPY ELCDMD34.
   952******************************************************************
   953*                                                                *
   954*                                                                *
   955*                            ELCDMD34.                           *
   956*                            VMOD=2.001                          *
   957*                                                                *
   958*   FILE DESCRIPTION = DMD DLO034 PARAMETER AREA                 *
   959*                                                                *
   960*    LENGTH = 272    RECFRM = FIXED                              *
   961*                                                                *
   962******************************************************************
   963 01  DLO034-COMMUNICATION-AREA.
   964     12  DL34-PROCESS-TYPE             PIC X.
   965     12  DL34-COMPANY-ID               PIC XXX.
   966     12  DL34-PRINT-PROGRAM-ID         PIC X(8).
   967     12  DL34-USERID                   PIC X(4).
   968     12  DL34-PRINT-LINE               PIC X(250).
   969     12  DL34-OVERRIDE-PRINTER-ID      PIC X(4).
   970     12  DL34-RETURN-CODE              PIC XX.
   971 01  DLO034-REC-LENGTH                 PIC S9(4) COMP VALUE +272.
   972
   973****************************************************************
   974*
   975* Copyright (c) 2007 by Clerity Solutions, Inc.
   976* All rights reserved.
   977*
   978****************************************************************
   979 01  DFHEIV.
   980   02  DFHEIV0               PIC X(35).
   981   02  DFHEIV1               PIC X(08).
   982   02  DFHEIV2               PIC X(08).
   983   02  DFHEIV3               PIC X(08).
   984   02  DFHEIV4               PIC X(06).
   985   02  DFHEIV5               PIC X(04).
   986   02  DFHEIV6               PIC X(04).
   987   02  DFHEIV7               PIC X(02).
   988   02  DFHEIV8               PIC X(02).
   989   02  DFHEIV9               PIC X(01).
   990   02  DFHEIV10              PIC S9(7) COMP-3.
   991   02  DFHEIV11              PIC S9(4) COMP SYNC.
   992   02  DFHEIV12              PIC S9(4) COMP SYNC.
   993   02  DFHEIV13              PIC S9(4) COMP SYNC.
   994   02  DFHEIV14              PIC S9(4) COMP SYNC.
   995   02  DFHEIV15              PIC S9(4) COMP SYNC.
   996   02  DFHEIV16              PIC S9(9) COMP SYNC.
   997   02  DFHEIV17              PIC X(04).
   998   02  DFHEIV18              PIC X(04).
   999   02  DFHEIV19              PIC X(04).
  1000   02  DFHEIV20              USAGE IS POINTER.
  1001   02  DFHEIV21              USAGE IS POINTER.
  1002   02  DFHEIV22              USAGE IS POINTER.
  1003   02  DFHEIV23              USAGE IS POINTER.
  1004   02  DFHEIV24              USAGE IS POINTER.
  1005   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1006   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1007   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1008   02  DFHEIV28              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL6942.cbl
  1009   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1010   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1011   02  FILLER                PIC X(02).
  1012   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1013   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1014   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1015   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1016   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1017 LINKAGE  SECTION.
  1018*****************************************************************
  1019*                                                               *
  1020* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1021* All rights reserved.                                          *
  1022*                                                               *
  1023*****************************************************************
  1024 01  dfheiblk.
  1025     02  eibtime          pic s9(7) comp-3.
  1026     02  eibdate          pic s9(7) comp-3.
  1027     02  eibtrnid         pic x(4).
  1028     02  eibtaskn         pic s9(7) comp-3.
  1029     02  eibtrmid         pic x(4).
  1030     02  dfheigdi         pic s9(4) comp.
  1031     02  eibcposn         pic s9(4) comp.
  1032     02  eibcalen         pic s9(4) comp.
  1033     02  eibaid           pic x(1).
  1034     02  eibfiller1       pic x(1).
  1035     02  eibfn            pic x(2).
  1036     02  eibfiller2       pic x(2).
  1037     02  eibrcode         pic x(6).
  1038     02  eibfiller3       pic x(2).
  1039     02  eibds            pic x(8).
  1040     02  eibreqid         pic x(8).
  1041     02  eibrsrce         pic x(8).
  1042     02  eibsync          pic x(1).
  1043     02  eibfree          pic x(1).
  1044     02  eibrecv          pic x(1).
  1045     02  eibsend          pic x(1).
  1046     02  eibatt           pic x(1).
  1047     02  eibeoc           pic x(1).
  1048     02  eibfmh           pic x(1).
  1049     02  eibcompl         pic x(1).
  1050     02  eibsig           pic x(1).
  1051     02  eibconf          pic x(1).
  1052     02  eiberr           pic x(1).
  1053     02  eibrldbk         pic x(1).
  1054     02  eiberrcd         pic x(4).
  1055     02  eibsynrb         pic x(1).
  1056     02  eibnodat         pic x(1).
  1057     02  eibfiller5       pic x(2).
  1058     02  eibresp          pic 9(09) comp.
  1059     02  eibresp2         pic 9(09) comp.
  1060     02  dfheigdj         pic s9(4) comp.
  1061     02  dfheigdk         pic s9(4) comp.
  1062*01 PARMLIST .
  1063*    02  FILLER                  PIC S9(08) COMP.
  1064*    02  L-ARCH-POINTER          PIC S9(08) COMP.
  1065*    02  L-ARCT-POINTER          PIC S9(08) COMP.
  1066*    02  L-CNTL-POINTER          PIC S9(08) COMP.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL6942.cbl
  1068 01  DFHCOMMAREA       PIC X(01).
  1069 01  L-LETTER-ARCHIVE            PIC X(250).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL6942.cbl
  1071*    COPY ERCARCT.
  1072******************************************************************
  1073*                                                                *
  1074*                            ERCARCT.                            *
  1075*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1076*                            VMOD=2.002                          *
  1077*                                                                *
  1078*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  1079*                                                                *
  1080*   FILE TYPE = VSAM,KSDS                                        *
  1081*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  1082*                                                                *
  1083*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  1084*                                                                *
  1085*   LOG = NO                                                     *
  1086*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1087******************************************************************
  1088 01  LETTER-ARCHIVE-TEXT.
  1089     12  LT-RECORD-ID                PIC  X(02).
  1090         88  LT-VALID-ID                VALUE 'LA'.
  1091
  1092     12  LT-CONTROL-PRIMARY.
  1093         16  LT-COMPANY-CD           PIC  X(01).
  1094         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  1095         16  LT-RECORD-TYPE          PIC  X(01).
  1096             88  LT-ADDRESS-DATA        VALUE '1'.
  1097             88  LT-TEXT-DATA           VALUE '2'.
  1098         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  1099
  1100     12  FILLER                      PIC  X(28).
  1101     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  1102
  1103     12  LT-TEXT-RECORD.
  1104         16  LT-LETTER-TEXT OCCURS 20 TIMES
  1105                            INDEXED BY LT-NDX.
  1106             20  LT-TEXT-LINE        PIC  X(70).
  1107             20  LT-SKIP-CONTROL     PIC  X(02).
  1108                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  1109                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  1110             20  FILLER              PIC  X(08).
  1111
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL6942.cbl
  1113*    COPY ELCCNTL.
  1114******************************************************************
  1115*                                                                *
  1116*                                                                *
  1117*                            ELCCNTL.                            *
  1118*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1119*                            VMOD=2.059                          *
  1120*                                                                *
  1121*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1122*                                                                *
  1123*   FILE TYPE = VSAM,KSDS                                        *
  1124*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1125*                                                                *
  1126*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1127*       ALTERNATE INDEX = NONE                                   *
  1128*                                                                *
  1129*   LOG = YES                                                    *
  1130*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1131******************************************************************
  1132*                   C H A N G E   L O G
  1133*
  1134* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1135*-----------------------------------------------------------------
  1136*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1137* EFFECTIVE    NUMBER
  1138*-----------------------------------------------------------------
  1139* 082503                   PEMA  ADD BENEFIT GROUP
  1140* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1141* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1142* 092705    2005050300006  PEMA  ADD SPP LEASES
  1143* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1144* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1145* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1146* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1147******************************************************************
  1148*
  1149 01  CONTROL-FILE.
  1150     12  CF-RECORD-ID                       PIC XX.
  1151         88  VALID-CF-ID                        VALUE 'CF'.
  1152
  1153     12  CF-CONTROL-PRIMARY.
  1154         16  CF-COMPANY-ID                  PIC XXX.
  1155         16  CF-RECORD-TYPE                 PIC X.
  1156             88  CF-COMPANY-MASTER              VALUE '1'.
  1157             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1158             88  CF-STATE-MASTER                VALUE '3'.
  1159             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1160             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1161             88  CF-CARRIER-MASTER              VALUE '6'.
  1162             88  CF-MORTALITY-MASTER            VALUE '7'.
  1163             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1164             88  CF-TERMINAL-MASTER             VALUE '9'.
  1165             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1166             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1167             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1168             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1169             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1170             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL6942.cbl
  1171             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1172             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1173             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1174         16  CF-ACCESS-CD-GENL              PIC X(4).
  1175         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1176             20  CF-PROCESSOR               PIC X(4).
  1177         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1178             20  CF-STATE-CODE              PIC XX.
  1179             20  FILLER                     PIC XX.
  1180         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1181             20  FILLER                     PIC XX.
  1182             20  CF-HI-BEN-IN-REC           PIC XX.
  1183         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1184             20  FILLER                     PIC XXX.
  1185             20  CF-CARRIER-CNTL            PIC X.
  1186         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1187             20  FILLER                     PIC XX.
  1188             20  CF-HI-TYPE-IN-REC          PIC 99.
  1189         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1190             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1191                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1192             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1193             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1194         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1195             20  FILLER                     PIC X.
  1196             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1197         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1198             20  FILLER                     PIC XX.
  1199             20  CF-MORTGAGE-PLAN           PIC XX.
  1200         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1201
  1202     12  CF-LAST-MAINT-DT                   PIC XX.
  1203     12  CF-LAST-MAINT-BY                   PIC X(4).
  1204     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1205
  1206     12  CF-RECORD-BODY                     PIC X(728).
  1207
  1208
  1209****************************************************************
  1210*             COMPANY MASTER RECORD                            *
  1211****************************************************************
  1212
  1213     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1214         16  CF-COMPANY-ADDRESS.
  1215             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1216             20  CF-CL-IN-CARE-OF           PIC X(30).
  1217             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1218             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1219             20  CF-CL-CITY-STATE           PIC X(30).
  1220             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1221             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1222         16  CF-COMPANY-CD                  PIC X.
  1223         16  CF-COMPANY-PASSWORD            PIC X(8).
  1224         16  CF-SECURITY-OPTION             PIC X.
  1225             88  ALL-SECURITY                   VALUE '1'.
  1226             88  COMPANY-VERIFY                 VALUE '2'.
  1227             88  PROCESSOR-VERIFY               VALUE '3'.
  1228             88  NO-SECURITY                    VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL6942.cbl
  1229             88  ALL-BUT-TERM                   VALUE '5'.
  1230         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1231             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1232         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1233             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1234         16  CF-INFORCE-LOCATION            PIC X.
  1235             88  CERTS-ARE-ONLINE               VALUE '1'.
  1236             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1237             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1238         16  CF-LOWER-CASE-LETTERS          PIC X.
  1239         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1240             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1241             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1242             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1243             88  CF-ACCNT-CNTL                  VALUE '3'.
  1244             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1245
  1246         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1247         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1248
  1249         16  CF-LGX-CREDIT-USER             PIC X.
  1250             88  CO-IS-NOT-USER                 VALUE 'N'.
  1251             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1252
  1253         16 CF-CREDIT-CALC-CODES.
  1254             20  CF-CR-REM-TERM-CALC PIC X.
  1255               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1256               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1257               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1258               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1259               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1260               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1261               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1262             20  CF-CR-R78-METHOD           PIC X.
  1263               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1264               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1265
  1266         16  CF-CLAIM-CONTROL-COUNTS.
  1267             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1268                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1269
  1270             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1271                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1272
  1273             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1274                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1275
  1276             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1277                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1278
  1279         16  CF-CURRENT-MONTH-END           PIC XX.
  1280
  1281         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1282             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1283             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1284             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1285             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1286                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL6942.cbl
  1287                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1288             20  CF-CO-PREM-REJECT-SW       PIC X.
  1289                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1290                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1291             20  CF-CO-REF-REJECT-SW        PIC X.
  1292                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  1293                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1294
  1295         16  CF-CO-REPORTING-DT             PIC XX.
  1296         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1297         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1298           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1299           88  CF-CO-MONTH-END                  VALUE '1'.
  1300
  1301         16  CF-LGX-CLAIM-USER              PIC X.
  1302             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1303             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1304
  1305         16  CF-CREDIT-EDIT-CONTROLS.
  1306             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1307             20  CF-MIN-AGE                 PIC 99.
  1308             20  CF-DEFAULT-AGE             PIC 99.
  1309             20  CF-MIN-TERM                PIC S999      COMP-3.
  1310             20  CF-MAX-TERM                PIC S999      COMP-3.
  1311             20  CF-DEFAULT-SEX             PIC X.
  1312             20  CF-JOINT-AGE-INPUT         PIC X.
  1313                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1314             20  CF-BIRTH-DATE-INPUT        PIC X.
  1315                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1316             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1317                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1318                 88  CF-ZERO-CARRIER            VALUE '1'.
  1319                 88  CF-ZERO-GROUPING           VALUE '2'.
  1320                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1321             20  CF-EDIT-SW                 PIC X.
  1322                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1323             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1324             20  CF-CR-PR-METHOD            PIC X.
  1325               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1326               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1327             20  FILLER                     PIC X.
  1328
  1329         16  CF-CREDIT-MISC-CONTROLS.
  1330             20  CF-REIN-TABLE-SW           PIC X.
  1331                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1332             20  CF-COMP-TABLE-SW           PIC X.
  1333                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1334             20  CF-EXPERIENCE-RETENTION-AGE
  1335                                            PIC S9        COMP-3.
  1336             20  CF-CONVERSION-DT           PIC XX.
  1337             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1338             20  CF-RUN-FREQUENCY-SW        PIC X.
  1339                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1340                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1341
  1342             20  CF-CR-CHECK-NO-CONTROL.
  1343                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1344                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL6942.cbl
  1345                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1346                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1347                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1348                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1349
  1350                 24  CF-CR-CHECK-COUNT       REDEFINES
  1351                     CF-CR-CHECK-COUNTER      PIC X(4).
  1352
  1353                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1354                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1355
  1356                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1357                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1358                 24  CF-MAIL-PROCESSING       PIC X.
  1359                     88  MAIL-PROCESSING          VALUE 'Y'.
  1360
  1361         16  CF-MISC-SYSTEM-CONTROL.
  1362             20  CF-SYSTEM-C                 PIC X.
  1363                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1364             20  CF-SYSTEM-D                 PIC X.
  1365                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1366             20  CF-SOC-SEC-NO-SW            PIC X.
  1367                 88  SOC-SEC-NO-USED             VALUE '1'.
  1368             20  CF-MEMBER-NO-SW             PIC X.
  1369                 88  MEMBER-NO-USED              VALUE '1'.
  1370             20  CF-TAX-ID-NUMBER            PIC X(11).
  1371             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1372             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1373                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1374                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1375                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1376                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1377             20  CF-SYSTEM-E                 PIC X.
  1378                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1379
  1380         16  CF-LGX-LIFE-USER               PIC X.
  1381             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1382             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1383
  1384         16  CF-CR-MONTH-END-DT             PIC XX.
  1385
  1386         16  CF-FILE-MAINT-DATES.
  1387             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1388                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1389             20  CF-LAST-BATCH       REDEFINES
  1390                 CF-LAST-BATCH-NO               PIC X(4).
  1391             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1392             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1393             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1394             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1395             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1396             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1397             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1398             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1399             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1400             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1401
  1402         16  CF-NEXT-COMPANY-ID             PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL6942.cbl
  1403         16  FILLER                         PIC X.
  1404
  1405         16  CF-ALT-MORT-CODE               PIC X(4).
  1406         16  CF-MEMBER-CAPTION              PIC X(10).
  1407
  1408         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  1409             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1410             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1411             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1412             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1413             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1414
  1415         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1416
  1417         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1418         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1419         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1420         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1421
  1422         16  CF-AH-OVERRIDE-L1              PIC X.
  1423         16  CF-AH-OVERRIDE-L2              PIC XX.
  1424         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1425         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1426
  1427         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1428         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1429
  1430         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1431         16  CF-AR-LAST-EL860-DT            PIC XX.
  1432         16  CF-MP-MONTH-END-DT             PIC XX.
  1433
  1434         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1435         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1436             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1437
  1438         16  CF-AR-MONTH-END-DT             PIC XX.
  1439
  1440         16  CF-CRDTCRD-USER                PIC X.
  1441             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1442             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1443
  1444         16  CF-CC-MONTH-END-DT             PIC XX.
  1445
  1446         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1447
  1448         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1449             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1450             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1451             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1452         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1453         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1454         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1455         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1456             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1457             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1458         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1459         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1460         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL6942.cbl
  1461             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1462         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1463
  1464         16  CF-CL-ZIP-CODE.
  1465             20  CF-CL-ZIP-PRIME.
  1466                 24  CF-CL-ZIP-1ST          PIC X.
  1467                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1468                 24  FILLER                 PIC X(4).
  1469             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1470         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1471             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1472             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1473             20  FILLER                     PIC XXX.
  1474
  1475         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1476         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1477         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1478         16  CF-CO-OPTION-START-DATE        PIC XX.
  1479         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1480           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1481                                                      '3' '4'.
  1482           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1483           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1484           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1485           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1486           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1487           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1488
  1489         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1490
  1491         16  CF-PAYMENT-APPROVAL-LEVELS.
  1492             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1493             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1494             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1495             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1496             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1497             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1498
  1499         16  CF-END-USER-REPORTING-USER     PIC X.
  1500             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1501             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1502
  1503         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1504             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1505             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1506
  1507         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1508
  1509         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1510         16  FILLER                         PIC X.
  1511
  1512         16  CF-CREDIT-ARCHIVE-CNTL.
  1513             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1514             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1515             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1516
  1517         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1518
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL6942.cbl
  1519         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1520             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1521             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1522
  1523         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1524             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  1525             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1526
  1527         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1528
  1529         16  CF-CO-ACH-ID-CODE              PIC  X.
  1530             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1531             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1532             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1533         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1534         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1535         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1536         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1537         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1538         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1539         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1540         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1541         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1542                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1543         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1544                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1545
  1546         16  CF-CO-OVER-SHORT.
  1547             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1548             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1549
  1550*         16  FILLER                         PIC X(102).
  1551         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1552             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1553             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1554
  1555         16  CF-AH-APPROVAL-DAYS.
  1556             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1557             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1558             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1559             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1560
  1561         16  FILLER                         PIC X(82).
  1562****************************************************************
  1563*             PROCESSOR/USER RECORD                            *
  1564****************************************************************
  1565
  1566     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1567         16  CF-PROCESSOR-NAME              PIC X(30).
  1568         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1569         16  CF-PROCESSOR-TITLE             PIC X(26).
  1570         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1571                 88  MESSAGE-YES                VALUE 'Y'.
  1572                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1573
  1574*****************************************************
  1575****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  1576****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL6942.cbl
  1577****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1578****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1579*****************************************************
  1580
  1581         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1582             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1583             20  CF-APPLICATION-FORCE       PIC X.
  1584             20  CF-INDIVIDUAL-APP.
  1585                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1586                     28  CF-BROWSE-APP      PIC X.
  1587                     28  CF-UPDATE-APP      PIC X.
  1588
  1589         16  CF-CURRENT-TERM-ON             PIC X(4).
  1590         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1591             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1592             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1593             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1594             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1595             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1596             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1597             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1598         16  CF-PROCESSOR-CARRIER           PIC X.
  1599             88  NO-CARRIER-SECURITY            VALUE ' '.
  1600         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1601             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1602         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1603             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1604         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1605             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1606
  1607         16  CF-PROC-SYS-ACCESS-SW.
  1608             20  CF-PROC-CREDIT-CLAIMS-SW.
  1609                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1610                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1611                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1612                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1613             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1614                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1615                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1616             20  CF-PROC-LIFE-GNRLDGR-SW.
  1617                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1618                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1619                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1620                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1621             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1622                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1623                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1624         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1625             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1626             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1627         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1628
  1629         16  CF-APPROVAL-LEVEL                  PIC X.
  1630             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1631             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1632             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1633             88  APPROVAL-LEVEL-4                   VALUE '4'.
  1634
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL6942.cbl
  1635         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1636
  1637         16  CF-LANGUAGE-TYPE                   PIC X.
  1638             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1639             88  CF-LANG-IS-FR                      VALUE 'F'.
  1640         16  FILLER                             PIC  X(240).
  1641
  1642****************************************************************
  1643*             PROCESSOR/REMINDERS RECORD                       *
  1644****************************************************************
  1645
  1646     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1647         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1648             20  CF-START-REMIND-DT         PIC XX.
  1649             20  CF-END-REMIND-DT           PIC XX.
  1650             20  CF-REMINDER-TEXT           PIC X(50).
  1651         16  FILLER                         PIC X(296).
  1652
  1653
  1654****************************************************************
  1655*             STATE MASTER RECORD                              *
  1656****************************************************************
  1657
  1658     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1659         16  CF-STATE-ABBREVIATION          PIC XX.
  1660         16  CF-STATE-NAME                  PIC X(25).
  1661         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1662         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1663             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1664             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1665             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1666             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1667                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1668                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1669             20  CF-ST-PREM-REJECT-SW       PIC X.
  1670                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1671                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1672             20  CF-ST-REF-REJECT-SW        PIC X.
  1673                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1674                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1675         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1676         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1677         16  CF-ST-REFUND-RULES.
  1678             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1679             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1680             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1681         16  CF-ST-FST-PMT-EXTENSION.
  1682             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1683             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1684                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1685                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1686                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1687                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1688         16  CF-ST-STATE-CALL.
  1689             20  CF-ST-CALL-UNEARNED        PIC X.
  1690             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1691             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1692         16  CF-REPLACEMENT-LAW-SW          PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL6942.cbl
  1693             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1694             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1695         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1696         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1697         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1698         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1699         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1700         16  FILLER                         PIC X.
  1701         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1702             20  CF-ST-BENEFIT-CD           PIC XX.
  1703             20  CF-ST-BENEFIT-KIND         PIC X.
  1704                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1705                 88  CF-ST-AH-KIND              VALUE 'A'.
  1706             20  CF-ST-REM-TERM-CALC        PIC X.
  1707                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1708                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1709                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1710                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1711                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1712                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1713                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1714                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1715
  1716             20  CF-ST-REFUND-CALC          PIC X.
  1717                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1718                 88  ST-REFD-BY-R78             VALUE '1'.
  1719                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1720                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1721                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1722                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1723                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1724                 88  ST-REFD-UTAH               VALUE '7'.
  1725                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1726                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1727                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1728
  1729             20  CF-ST-EARNING-CALC         PIC X.
  1730                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1731                 88  ST-EARN-BY-R78             VALUE '1'.
  1732                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1733                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1734                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1735                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1736                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1737                 88  ST-EARN-MEAN               VALUE '8'.
  1738                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1739
  1740             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1741                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1742                 88  ST-OVRD-BY-R78             VALUE '1'.
  1743                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1744                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1745                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1746                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  1747                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1748                 88  ST-OVRD-MEAN               VALUE '8'.
  1749                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1750             20  FILLER                     PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL6942.cbl
  1751
  1752         16  CF-ST-COMMISSION-CAPS.
  1753             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1754             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1755             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1756             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1757         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1758                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1759
  1760         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1761
  1762         16  CF-ST-STATUTORY-INTEREST.
  1763             20  CF-ST-STAT-DATE-FROM       PIC X.
  1764                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1765                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1766             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1767             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1768             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1769             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1770             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1771
  1772         16  CF-ST-OVER-SHORT.
  1773             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1774             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1775
  1776         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1777
  1778         16  CF-ST-RT-CALC                  PIC X.
  1779
  1780         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  1781         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  1782         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  1783         16  CF-ST-RF-LR-CALC               PIC X.
  1784         16  CF-ST-RF-LL-CALC               PIC X.
  1785         16  CF-ST-RF-LN-CALC               PIC X.
  1786         16  CF-ST-RF-AH-CALC               PIC X.
  1787         16  CF-ST-RF-CP-CALC               PIC X.
  1788*        16  FILLER                         PIC X(206).
  1789*CIDMOD         16  FILLER                         PIC X(192).
  1790         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  1791             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  1792         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  1793         16  FILLER                         PIC X(187).
  1794
  1795****************************************************************
  1796*             BENEFIT MASTER RECORD                            *
  1797****************************************************************
  1798
  1799     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1800         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  1801             20  CF-BENEFIT-CODE            PIC XX.
  1802             20  CF-BENEFIT-NUMERIC  REDEFINES
  1803                 CF-BENEFIT-CODE            PIC XX.
  1804             20  CF-BENEFIT-ALPHA           PIC XXX.
  1805             20  CF-BENEFIT-DESCRIP         PIC X(10).
  1806             20  CF-BENEFIT-COMMENT         PIC X(10).
  1807
  1808             20  CF-LF-COVERAGE-TYPE        PIC X.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL6942.cbl
  1809                 88  CF-REDUCING                VALUE 'R'.
  1810                 88  CF-LEVEL                   VALUE 'L' 'P'.
  1811
  1812             20  CF-SPECIAL-CALC-CD         PIC X.
  1813                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  1814                 88  CF-NP-0-MO-INT             VALUE 'A'.
  1815                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  1816                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  1817                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  1818                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  1819                 88  CF-FARM-PLAN               VALUE 'F'.
  1820                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  1821                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  1822                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  1823                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  1824                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  1825                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  1826                 88  CF-PRUDENTIAL              VALUE 'P'.
  1827                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  1828                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  1829                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  1830                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  1831                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  1832                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  1833
  1834             20  CF-JOINT-INDICATOR         PIC X.
  1835                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  1836
  1837*            20  FILLER                     PIC X(12).
  1838             20  FILLER                     PIC X(11).
  1839             20  CF-BENEFIT-CATEGORY        PIC X.
  1840             20  CF-LOAN-TYPE               PIC X(8).
  1841
  1842             20  CF-CO-REM-TERM-CALC        PIC X.
  1843                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  1844                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  1845                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  1846                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  1847                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  1848
  1849             20  CF-CO-EARNINGS-CALC        PIC X.
  1850                 88  CO-EARN-BY-R78             VALUE '1'.
  1851                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  1852                 88  CO-EARN-AS-CALIF           VALUE '3'.
  1853                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  1854                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  1855                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  1856                 88  CO-EARN-AS-MEAN            VALUE '8'.
  1857                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  1858
  1859             20  CF-CO-REFUND-CALC          PIC X.
  1860                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  1861                 88  CO-REFD-BY-R78             VALUE '1'.
  1862                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  1863                 88  CO-REFD-AS-CALIF           VALUE '3'.
  1864                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  1865                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  1866                 88  CO-REFD-ANTICIPATION       VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL6942.cbl
  1867                 88  CO-REFD-MEAN               VALUE '8'.
  1868                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  1869                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  1870                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  1871
  1872             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  1873                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  1874                 88  CO-OVRD-BY-R78             VALUE '1'.
  1875                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  1876                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  1877                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  1878                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  1879                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  1880                 88  CO-OVRD-MEAN               VALUE '8'.
  1881                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  1882
  1883             20  CF-CO-BEN-I-G-CD           PIC X.
  1884                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  1885                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  1886                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  1887
  1888         16  FILLER                         PIC X(304).
  1889
  1890
  1891****************************************************************
  1892*             CARRIER MASTER RECORD                            *
  1893****************************************************************
  1894
  1895     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1896         16  CF-ADDRESS-DATA.
  1897             20  CF-MAIL-TO-NAME            PIC X(30).
  1898             20  CF-IN-CARE-OF              PIC X(30).
  1899             20  CF-ADDRESS-LINE-1          PIC X(30).
  1900             20  CF-ADDRESS-LINE-2          PIC X(30).
  1901             20  CF-CITY-STATE              PIC X(30).
  1902             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  1903             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  1904
  1905         16  CF-CLAIM-NO-CONTROL.
  1906             20  CF-CLAIM-NO-METHOD         PIC X.
  1907                 88  CLAIM-NO-MANUAL            VALUE '1'.
  1908                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  1909                 88  CLAIM-NO-SEQ               VALUE '3'.
  1910                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  1911             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  1912                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  1913                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  1914                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  1915
  1916         16  CF-CHECK-NO-CONTROL.
  1917             20  CF-CHECK-NO-METHOD         PIC X.
  1918                 88  CHECK-NO-MANUAL            VALUE '1'.
  1919                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  1920                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  1921                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  1922             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  1923                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  1924
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL6942.cbl
  1925         16  CF-DOMICILE-STATE              PIC XX.
  1926
  1927         16  CF-EXPENSE-CONTROLS.
  1928             20  CF-EXPENSE-METHOD          PIC X.
  1929                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  1930                 88  DOLLARS-PER-PMT            VALUE '2'.
  1931                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  1932                 88  DOLLARS-PER-MONTH          VALUE '4'.
  1933             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  1934             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  1935
  1936         16  CF-CORRESPONDENCE-CONTROL.
  1937             20  CF-LETTER-RESEND-OPT       PIC X.
  1938                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  1939                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  1940             20  FILLER                     PIC X(4).
  1941
  1942         16  CF-RESERVE-CONTROLS.
  1943             20  CF-MANUAL-SW               PIC X.
  1944                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  1945             20  CF-FUTURE-SW               PIC X.
  1946                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  1947             20  CF-PTC-SW                  PIC X.
  1948                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  1949             20  CF-IBNR-SW                 PIC X.
  1950                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  1951             20  CF-PTC-LF-SW               PIC X.
  1952                 88  CF-LF-PTC-USED             VALUE '1'.
  1953             20  CF-CDT-ACCESS-METHOD       PIC X.
  1954                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  1955                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  1956                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  1957             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  1958
  1959         16  CF-CLAIM-CALC-METHOD           PIC X.
  1960             88  360-PLUS-MONTHS                VALUE '1'.
  1961             88  365-PLUS-MONTHS                VALUE '2'.
  1962             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  1963             88  360-DAILY                      VALUE '4'.
  1964             88  365-DAILY                      VALUE '5'.
  1965
  1966         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  1967         16  FILLER                         PIC X(11).
  1968
  1969         16  CF-LIMIT-AMOUNTS.
  1970             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  1971             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  1972             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  1973             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  1974             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  1975             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  1976             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  1977             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  1978             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  1979             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  1980
  1981         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  1982         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL6942.cbl
  1983         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  1984
  1985         16  CF-ZIP-CODE.
  1986             20  CF-ZIP-PRIME.
  1987                 24  CF-ZIP-1ST             PIC X.
  1988                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1989                 24  FILLER                 PIC X(4).
  1990             20  CF-ZIP-PLUS4               PIC X(4).
  1991         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  1992             20  CF-CAN-POSTAL-1            PIC XXX.
  1993             20  CF-CAN-POSTAL-2            PIC XXX.
  1994             20  FILLER                     PIC XXX.
  1995
  1996         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  1997         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  1998         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  1999
  2000         16  CF-RATING-SWITCH               PIC X.
  2001             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2002             88  CF-NO-RATING                   VALUE 'N'.
  2003
  2004         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2005
  2006         16  CF-CARRIER-OVER-SHORT.
  2007             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2008             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2009
  2010         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2011         16  CF-SECPAY-SWITCH               PIC X.
  2012             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2013             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  2014         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2015         16  FILLER                         PIC X(448).
  2016*        16  FILLER                         PIC X(452).
  2017
  2018
  2019****************************************************************
  2020*             MORTALITY MASTER RECORD                          *
  2021****************************************************************
  2022
  2023     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2024         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2025                                INDEXED BY CF-MORT-NDX.
  2026             20  CF-MORT-TABLE              PIC X(5).
  2027             20  CF-MORT-TABLE-TYPE         PIC X.
  2028                 88  CF-MORT-JOINT              VALUE 'J'.
  2029                 88  CF-MORT-SINGLE             VALUE 'S'.
  2030                 88  CF-MORT-COMBINED           VALUE 'C'.
  2031                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2032                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2033             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2034             20  CF-MORT-AGE-METHOD         PIC XX.
  2035                 88  CF-AGE-LAST                VALUE 'AL'.
  2036                 88  CF-AGE-NEAR                VALUE 'AN'.
  2037             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2038             20  CF-MORT-ADJUSTMENT-DIRECTION
  2039                                            PIC X.
  2040                 88  CF-MINUS                   VALUE '-'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL6942.cbl
  2041                 88  CF-PLUS                    VALUE '+'.
  2042             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2043             20  CF-MORT-JOINT-CODE         PIC X.
  2044                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2045             20  CF-MORT-PC-Q               PIC X.
  2046                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2047             20  CF-MORT-TABLE-CODE         PIC X(4).
  2048             20  CF-MORT-COMMENTS           PIC X(15).
  2049             20  FILLER                     PIC X(14).
  2050
  2051         16  FILLER                         PIC X(251).
  2052
  2053
  2054****************************************************************
  2055*             BUSSINESS TYPE MASTER RECORD                     *
  2056****************************************************************
  2057
  2058     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2059* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2060* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2061* AND RECORD 05 IS TYPES 81-99
  2062         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2063             20  CF-BUSINESS-TITLE          PIC  X(19).
  2064             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2065                                            PIC S9V9(4) COMP-3.
  2066             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2067             20  FILLER                     PIC  X.
  2068         16  FILLER                         PIC  X(248).
  2069
  2070
  2071****************************************************************
  2072*             TERMINAL MASTER RECORD                           *
  2073****************************************************************
  2074
  2075     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2076
  2077         16  CF-COMPANY-TERMINALS.
  2078             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2079                                  PIC X(4).
  2080         16  FILLER               PIC X(248).
  2081
  2082
  2083****************************************************************
  2084*             LIFE EDIT MASTER RECORD                          *
  2085****************************************************************
  2086
  2087     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2088         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2089             20  CF-LIFE-CODE-IN            PIC XX.
  2090             20  CF-LIFE-CODE-OUT           PIC XX.
  2091         16  FILLER                         PIC X(248).
  2092
  2093
  2094****************************************************************
  2095*             AH EDIT MASTER RECORD                            *
  2096****************************************************************
  2097
  2098     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL6942.cbl
  2099         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2100             20  CF-AH-CODE-IN              PIC XXX.
  2101             20  CF-AH-CODE-OUT             PIC XX.
  2102         16  FILLER                         PIC X(248).
  2103
  2104
  2105****************************************************************
  2106*             CREDIBILITY TABLES                               *
  2107****************************************************************
  2108
  2109     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2110         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2111                             INDEXED BY CF-CRDB-NDX.
  2112             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2113             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2114             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2115         16  FILLER                         PIC  X(332).
  2116
  2117
  2118****************************************************************
  2119*             REPORT CUSTOMIZATION RECORD                      *
  2120****************************************************************
  2121
  2122     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2123         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2124             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2125             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2126             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2127**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2128****       A T-TRANSFER.                                   ****
  2129             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2130
  2131         16  FILLER                         PIC XX.
  2132
  2133         16  CF-CARRIER-CNTL-OPT.
  2134             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2135                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2136                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2137             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2138                                            PIC X.
  2139         16  CF-GROUP-CNTL-OPT.
  2140             20  CF-GROUP-OPT-SEQ           PIC 9.
  2141                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2142                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2143             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2144                                            PIC X(6).
  2145         16  CF-STATE-CNTL-OPT.
  2146             20  CF-STATE-OPT-SEQ           PIC 9.
  2147                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2148                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2149             20  CF-STATE-SELECT OCCURS 3 TIMES
  2150                                            PIC XX.
  2151         16  CF-ACCOUNT-CNTL-OPT.
  2152             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2153                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2154                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2155             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2156                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL6942.cbl
  2157         16  CF-BUS-TYP-CNTL-OPT.
  2158             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2159                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2160                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2161             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2162                                            PIC XX.
  2163         16  CF-LF-TYP-CNTL-OPT.
  2164             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2165                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2166                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2167             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2168                                            PIC XX.
  2169         16  CF-AH-TYP-CNTL-OPT.
  2170             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2171                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2172                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2173             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2174                                            PIC XX.
  2175         16  CF-REPTCD1-CNTL-OPT.
  2176             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2177                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2178                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2179             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2180                                            PIC X(10).
  2181         16  CF-REPTCD2-CNTL-OPT.
  2182             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2183                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2184                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2185             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2186                                            PIC X(10).
  2187         16  CF-USER1-CNTL-OPT.
  2188             20  CF-USER1-OPT-SEQ           PIC 9.
  2189                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2190                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2191             20  CF-USER1-SELECT OCCURS 3 TIMES
  2192                                            PIC X(10).
  2193         16  CF-USER2-CNTL-OPT.
  2194             20  CF-USER2-OPT-SEQ           PIC 9.
  2195                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2196                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2197             20  CF-USER2-SELECT OCCURS 3 TIMES
  2198                                            PIC X(10).
  2199         16  CF-USER3-CNTL-OPT.
  2200             20  CF-USER3-OPT-SEQ           PIC 9.
  2201                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2202                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2203             20  CF-USER3-SELECT OCCURS 3 TIMES
  2204                                            PIC X(10).
  2205         16  CF-USER4-CNTL-OPT.
  2206             20  CF-USER4-OPT-SEQ           PIC 9.
  2207                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2208                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2209             20  CF-USER4-SELECT OCCURS 3 TIMES
  2210                                            PIC X(10).
  2211         16  CF-USER5-CNTL-OPT.
  2212             20  CF-USER5-OPT-SEQ           PIC 9.
  2213                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2214                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL6942.cbl
  2215             20  CF-USER5-SELECT OCCURS 3 TIMES
  2216                                            PIC X(10).
  2217         16  CF-REINS-CNTL-OPT.
  2218             20  CF-REINS-OPT-SEQ           PIC 9.
  2219                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2220                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2221             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2222                 24  CF-REINS-PRIME         PIC XXX.
  2223                 24  CF-REINS-SUB           PIC XXX.
  2224
  2225         16  CF-AGENT-CNTL-OPT.
  2226             20  CF-AGENT-OPT-SEQ           PIC 9.
  2227                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2228                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2229             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2230                                            PIC X(10).
  2231
  2232         16  FILLER                         PIC X(43).
  2233
  2234         16  CF-LOSS-RATIO-SELECT.
  2235             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2236             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2237         16  CF-ENTRY-DATE-SELECT.
  2238             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2239             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2240         16  CF-EFFECTIVE-DATE-SELECT.
  2241             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2242             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2243
  2244         16  CF-EXCEPTION-LIST-IND          PIC X.
  2245             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2246
  2247         16  FILLER                         PIC X(318).
  2248
  2249****************************************************************
  2250*                  EXCEPTION REPORTING RECORD                  *
  2251****************************************************************
  2252
  2253     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2254         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2255             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2256
  2257         16  CF-COMBINED-LIFE-AH-OPT.
  2258             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2259             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2260             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2261             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2262
  2263         16  CF-LIFE-OPT.
  2264             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2265             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2266             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2267             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2268             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2269             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2270             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2271             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2272             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL6942.cbl
  2273             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2274
  2275         16  CF-AH-OPT.
  2276             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2277             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2278             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2279             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2280             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2281             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2282             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2283             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2284             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2285             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2286
  2287         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2288             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2289             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2290             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2291
  2292         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2293
  2294         16  FILLER                         PIC X(673).
  2295
  2296
  2297****************************************************************
  2298*             MORTGAGE SYSTEM PLAN RECORD                      *
  2299****************************************************************
  2300
  2301     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2302         16  CF-PLAN-TYPE                   PIC X.
  2303             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2304             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2305             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2306         16  CF-PLAN-ABBREV                 PIC XXX.
  2307         16  CF-PLAN-DESCRIPT               PIC X(10).
  2308         16  CF-PLAN-NOTES                  PIC X(20).
  2309         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2310         16  CF-PLAN-UNDERWRITING.
  2311             20  CF-PLAN-TERM-DATA.
  2312                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2313                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2314             20  CF-PLAN-AGE-DATA.
  2315                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2316                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2317                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2318             20  CF-PLAN-BENEFIT-DATA.
  2319                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2320                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2321                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2322                                            PIC S9(7)V99  COMP-3.
  2323         16  CF-PLAN-POLICY-FORMS.
  2324             20  CF-POLICY-FORM             PIC X(12).
  2325             20  CF-MASTER-APPLICATION      PIC X(12).
  2326             20  CF-MASTER-POLICY           PIC X(12).
  2327         16  CF-PLAN-RATING.
  2328             20  CF-RATE-CODE               PIC X(5).
  2329             20  CF-SEX-RATING              PIC X.
  2330                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL6942.cbl
  2331                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2332             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2333             20  CF-SUB-STD-TYPE            PIC X.
  2334                 88  CF-PCT-OF-PREM            VALUE '1'.
  2335                 88  CF-PCT-OF-BENE            VALUE '2'.
  2336         16  CF-PLAN-PREM-TOLERANCES.
  2337             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2338             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2339         16  CF-PLAN-PYMT-TOLERANCES.
  2340             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2341             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2342         16  CF-PLAN-MISC-DATA.
  2343             20  FILLER                     PIC X.
  2344             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2345             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2346         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2347         16  CF-PLAN-IND-GRP                PIC X.
  2348             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2349                                                     '1'.
  2350             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2351                                                     '2'.
  2352         16  CF-MIB-SEARCH-SW               PIC X.
  2353             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2354             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2355             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2356             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2357         16  CF-ALPHA-SEARCH-SW             PIC X.
  2358             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2359             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2360             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  2361             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2362             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2363             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2364             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2365             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2366             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2367             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2368                                                     'A' 'B' 'C'
  2369                                                     'X' 'Y' 'Z'.
  2370         16  CF-EFF-DT-RULE-SW              PIC X.
  2371             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2372             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2373             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2374             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2375             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2376         16  FILLER                         PIC X(4).
  2377         16  CF-HEALTH-QUESTIONS            PIC X.
  2378             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2379         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2380         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2381         16  CF-PLAN-SNGL-JNT               PIC X.
  2382             88  CF-COMBINED-PLAN              VALUE 'C'.
  2383             88  CF-JNT-PLAN                   VALUE 'J'.
  2384             88  CF-SNGL-PLAN                  VALUE 'S'.
  2385         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2386         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2387         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2388         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL6942.cbl
  2389         16  CF-RERATE-CNTL                 PIC  X.
  2390             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2391             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2392             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2393             88  CF-AUTO-RECALC                 VALUE '4'.
  2394         16  CF-BENEFIT-TYPE                PIC  X.
  2395             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2396             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2397         16  CF-POLICY-FEE                  PIC S999V99
  2398                                                    COMP-3.
  2399         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2400         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2401         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2402         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2403         16  FILLER                         PIC  X(32).
  2404         16  CF-TERMINATION-FORM            PIC  X(04).
  2405         16  FILLER                         PIC  X(08).
  2406         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2407                                                       COMP-3.
  2408         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2409         16  CF-ISSUE-LETTER                PIC  X(4).
  2410         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2411         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2412             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2413             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2414         16  CF-MP-REFUND-CALC              PIC X.
  2415             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2416             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2417             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2418             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  2419             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2420             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2421             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2422             88  CF-MP-REFD-MEAN                VALUE '8'.
  2423         16  CF-ALT-RATE-CODE               PIC  X(5).
  2424
  2425
  2426         16  FILLER                         PIC X(498).
  2427****************************************************************
  2428*             MORTGAGE COMPANY MASTER RECORD                   *
  2429****************************************************************
  2430
  2431     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2432         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2433         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2434             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2435             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2436             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2437             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2438             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2439
  2440         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2441         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2442         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2443         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2444         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2445
  2446         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL6942.cbl
  2447             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2448         16  CF-MP-RECON-USE-IND            PIC X(1).
  2449             88  CF-MP-USE-RECON             VALUE 'Y'.
  2450         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2451             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2452         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2453             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2454             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2455         16  FILLER                         PIC X(1).
  2456         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2457             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2458         16  CF-MORTG-MIB-VERSION           PIC X.
  2459             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2460             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2461             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2462         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2463             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2464                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2465             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2466                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2467             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2468                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2469             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2470                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2471             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2472                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2473             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2474                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2475         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2476         16  FILLER                         PIC X(7).
  2477         16  CF-MORTG-DESTINATION-SYMBOL.
  2478             20  CF-MORTG-MIB-COMM          PIC X(5).
  2479             20  CF-MORTG-MIB-TERM          PIC X(5).
  2480         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2481             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2482         16  FILLER                         PIC X(03).
  2483         16  CF-MP-CHECK-NO-CONTROL.
  2484             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2485                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2486                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2487                                                ' ' LOW-VALUES.
  2488                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2489                                               VALUE '3'.
  2490         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2491         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2492         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2493             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2494                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2495             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2496                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2497             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2498                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2499             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2500                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2501             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2502                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2503             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2504                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL6942.cbl
  2505         16  CF-MORTG-BILLING-AREA.
  2506             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2507                                            PIC X.
  2508         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2509         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2510         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2511         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2512             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2513             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2514         16  FILLER                         PIC X.
  2515         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2516             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2517             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2518         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2519         16  FILLER                         PIC X(8).
  2520         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2521         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2522         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2523         16  CF-ACH-COMPANY-ID.
  2524             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2525                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2526                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2527                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2528             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2529         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2530             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2531         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2532             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2533             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2534         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  2535         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2536         16  FILLER                         PIC X(536).
  2537
  2538****************************************************************
  2539*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2540****************************************************************
  2541
  2542     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2543         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2544             20  CF-FEMALE-HEIGHT.
  2545                 24  CF-FEMALE-FT           PIC 99.
  2546                 24  CF-FEMALE-IN           PIC 99.
  2547             20  CF-FEMALE-MIN-WT           PIC 999.
  2548             20  CF-FEMALE-MAX-WT           PIC 999.
  2549         16  FILLER                         PIC X(428).
  2550
  2551     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2552         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2553             20  CF-MALE-HEIGHT.
  2554                 24  CF-MALE-FT             PIC 99.
  2555                 24  CF-MALE-IN             PIC 99.
  2556             20  CF-MALE-MIN-WT             PIC 999.
  2557             20  CF-MALE-MAX-WT             PIC 999.
  2558         16  FILLER                         PIC X(428).
  2559******************************************************************
  2560*             AUTOMATIC ACTIVITY RECORD                          *
  2561******************************************************************
  2562     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL6942.cbl
  2563         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2564             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2565             20  CF-SYS-LETTER-ID           PIC X(04).
  2566             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2567             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2568             20  CF-SYS-RESET-SW            PIC X(01).
  2569             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2570             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2571
  2572         16  FILLER                         PIC X(50).
  2573
  2574         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2575             20  CF-USER-ACTIVE-SW          PIC X(01).
  2576             20  CF-USER-LETTER-ID          PIC X(04).
  2577             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2578             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2579             20  CF-USER-RESET-SW           PIC X(01).
  2580             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2581             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2582             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2583
  2584         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL6942.cbl
  2586 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA L-LETTER-ARCHIVE
  2587                          LETTER-ARCHIVE-TEXT CONTROL-FILE.
  2588 0000-DFHEXIT SECTION.
  2589     MOVE '9#                    $   ' TO DFHEIV0.
  2590     MOVE 'EL6942' TO DFHEIV1.
  2591     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2592
  2593     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  2594     MOVE '5'                    TO DC-OPTION-CODE.
  2595     PERFORM 9700-DATE-LINK THRU 9700-EXIT.
  2596     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-CURRENT-DATE.
  2597     MOVE DC-BIN-DATE-1          TO W-SAVE-CURRENT-BIN-DATE.
  2598     MOVE SPACES                 TO DL34-PROCESS-TYPE.
  2599
  2600 0100-RETRIEVE-LOOP.
  2601
  2602
  2603* EXEC CICS HANDLE CONDITION
  2604*         ENDDATA (0200-END-DATA)
  2605*         NOTFND  (0300-NOT-FOUND)
  2606*    END-EXEC.
  2607*    MOVE '"$&I                  ! " #00002598' TO DFHEIV0
  2608     MOVE X'222426492020202020202020' TO DFHEIV0(1:12)
  2609     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2610     MOVE X'2220233030303032353938' TO DFHEIV0(25:11)
  2611     CALL 'kxdfhei1' USING DFHEIV0
  2612     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2613
  2614
  2615
  2616* EXEC CICS RETRIEVE
  2617*         INTO    (PROGRAM-INTERFACE-BLOCK)
  2618*         LENGTH  (PI-COMM-LENGTH)
  2619*    END-EXEC.
  2620*    MOVE '0*I L                 &   #00002603' TO DFHEIV0
  2621     MOVE X'302A49204C20202020202020' TO DFHEIV0(1:12)
  2622     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2623     MOVE X'2020233030303032363033' TO DFHEIV0(25:11)
  2624     CALL 'kxdfhei1' USING DFHEIV0,
  2625           PROGRAM-INTERFACE-BLOCK,
  2626           PI-COMM-LENGTH,
  2627           DFHEIV99,
  2628           DFHEIV99,
  2629           DFHEIV99
  2630     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2631
  2632
  2633
  2634* DLO034 OPEN WHEN DMD OR CID
  2635     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  2636         IF DL34-PROCESS-TYPE IS EQUAL TO SPACES
  2637             MOVE 'O'                TO DL34-PROCESS-TYPE
  2638             MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  2639             MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  2640             MOVE PI-PROCESSOR-ID    TO DL34-USERID
  2641             MOVE SPACES             TO DL34-PRINT-LINE
  2642             MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
  2643
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL6942.cbl
  2644* EXEC CICS LINK
  2645*                PROGRAM    ('DLO034')
  2646*                COMMAREA   (DLO034-COMMUNICATION-AREA)
  2647*                LENGTH     (DLO034-REC-LENGTH)
  2648*            END-EXEC
  2649     MOVE 'DLO034' TO DFHEIV1
  2650*    MOVE '."C                   ''   #00002618' TO DFHEIV0
  2651     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2652     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2653     MOVE X'2020233030303032363138' TO DFHEIV0(25:11)
  2654     CALL 'kxdfhei1' USING DFHEIV0,
  2655           DFHEIV1,
  2656           DLO034-COMMUNICATION-AREA,
  2657           DLO034-REC-LENGTH,
  2658           DFHEIV99,
  2659           DFHEIV99,
  2660           DFHEIV99
  2661     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2662             IF DL34-RETURN-CODE NOT = 'OK'
  2663                 MOVE  '**DLO034 OPEN ERROR - ABORT**'
  2664                                     TO W-ERROR-LINE
  2665                 PERFORM 0400-SEND-TEXT
  2666
  2667* EXEC CICS RETURN
  2668*                END-EXEC.
  2669*    MOVE '.(                    &   #00002627' TO DFHEIV0
  2670     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2671     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2672     MOVE X'2020233030303032363237' TO DFHEIV0(25:11)
  2673     CALL 'kxdfhei1' USING DFHEIV0,
  2674           DFHEIV99,
  2675           DFHEIV99,
  2676           DFHEIV99,
  2677           DFHEIV99,
  2678           DFHEIV99
  2679     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2680
  2681
  2682     PERFORM 1000-INITIALIZE THRU 1000-EXIT.
  2683     PERFORM 2000-PROCESS-ARCHIVES THRU 2999-EXIT.
  2684
  2685     IF  W-SAVE-ARCH-NO EQUAL ZEROS
  2686             OR
  2687         PI-6942-STARTING-ARCH-NO EQUAL W-SAVE-ARCH-NO
  2688         GO TO 0200-END-DATA.
  2689
  2690 0150-UPDATE-CONTROL-FILE.
  2691
  2692
  2693* EXEC CICS HANDLE CONDITION
  2694*         NOTOPEN     (0200-END-DATA)
  2695*         NOTFND      (0200-END-DATA)
  2696*    END-EXEC.
  2697*    MOVE '"$JI                  ! # #00002640' TO DFHEIV0
  2698     MOVE X'22244A492020202020202020' TO DFHEIV0(1:12)
  2699     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2700     MOVE X'2320233030303032363430' TO DFHEIV0(25:11)
  2701     CALL 'kxdfhei1' USING DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL6942.cbl
  2702     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2703
  2704
  2705     MOVE SPACES                 TO W-CNTL-KEY.
  2706     MOVE PI-COMPANY-ID          TO W-CNTL-COMPANY-ID.
  2707     MOVE '1'                    TO W-CNTL-RECORD-TYPE.
  2708     MOVE ZEROS                  TO W-CNTL-SEQ.
  2709
  2710
  2711* EXEC CICS READ
  2712*         UPDATE
  2713*         DATASET (W-CNTL-ID)
  2714*         SET     (ADDRESS OF CONTROL-FILE)
  2715*         RIDFLD  (W-CNTL-KEY)
  2716*    END-EXEC.
  2717*    MOVE '&"S        EU         (   #00002650' TO DFHEIV0
  2718     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2719     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2720     MOVE X'2020233030303032363530' TO DFHEIV0(25:11)
  2721     CALL 'kxdfhei1' USING DFHEIV0,
  2722           W-CNTL-ID,
  2723           DFHEIV20,
  2724           DFHEIV99,
  2725           W-CNTL-KEY,
  2726           DFHEIV99,
  2727           DFHEIV99,
  2728           DFHEIV99
  2729     SET ADDRESS OF CONTROL-FILE TO
  2730         DFHEIV20
  2731     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2732
  2733
  2734     MOVE W-SAVE-ARCH-NO         TO CF-CREDIT-START-ARCH-NUM.
  2735
  2736
  2737* EXEC CICS REWRITE
  2738*         DATASET (W-CNTL-ID)
  2739*         FROM    (CONTROL-FILE)
  2740*    END-EXEC.
  2741     MOVE LENGTH OF
  2742      CONTROL-FILE
  2743       TO DFHEIV11
  2744*    MOVE '&& L                  %   #00002659' TO DFHEIV0
  2745     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2746     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2747     MOVE X'2020233030303032363539' TO DFHEIV0(25:11)
  2748     CALL 'kxdfhei1' USING DFHEIV0,
  2749           W-CNTL-ID,
  2750           CONTROL-FILE,
  2751           DFHEIV11,
  2752           DFHEIV99
  2753     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2754
  2755
  2756 0200-END-DATA.
  2757
  2758     MOVE '1'                    TO WS-PRINT-AREA.
  2759     MOVE W-ASTERISK-LINE1       TO WS-PASSED-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL6942.cbl
  2760     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  2761     MOVE SPACES                 TO WS-PRINT-AREA.
  2762     MOVE W-ASTERISK-LINE        TO WS-PASSED-DATA.
  2763     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  2764
  2765     MOVE '0'                    TO WS-PRINT-AREA.
  2766
  2767     IF W-PRINT-LABELS
  2768         MOVE W-LABEL-LINE-DESC  TO W-TOTAL-LINE-DESC.
  2769
  2770     MOVE W-LETTER-TOTALS        TO W-TOTAL-LETTERS.
  2771     MOVE W-TOTAL-LINE           TO WS-PASSED-DATA.
  2772     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  2773
  2774     MOVE '0'                    TO WS-PRINT-AREA.
  2775     MOVE W-ASTERISK-LINE        TO WS-PASSED-DATA.
  2776     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  2777     MOVE SPACES                 TO WS-PRINT-AREA.
  2778     MOVE W-ASTERISK-LINE        TO WS-PASSED-DATA.
  2779     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  2780     MOVE '1'                    TO WS-PRINT-AREA.
  2781     MOVE SPACES                 TO WS-PASSED-DATA.
  2782     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  2783
  2784     MOVE 'X'                    TO WS-PROG-END.
  2785     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  2786
  2787* DLO034 CLOSE
  2788     IF PI-COMPANY-ID = 'DMD' OR 'XXX'
  2789         MOVE 'C'                TO DL34-PROCESS-TYPE
  2790         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  2791         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  2792         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  2793         MOVE SPACES             TO DL34-PRINT-LINE
  2794                                    DL34-OVERRIDE-PRINTER-ID
  2795
  2796* EXEC CICS LINK
  2797*            PROGRAM    ('DLO034')
  2798*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  2799*            LENGTH     (DLO034-REC-LENGTH)
  2800*        END-EXEC
  2801     MOVE 'DLO034' TO DFHEIV1
  2802*    MOVE '."C                   ''   #00002703' TO DFHEIV0
  2803     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2804     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2805     MOVE X'2020233030303032373033' TO DFHEIV0(25:11)
  2806     CALL 'kxdfhei1' USING DFHEIV0,
  2807           DFHEIV1,
  2808           DLO034-COMMUNICATION-AREA,
  2809           DLO034-REC-LENGTH,
  2810           DFHEIV99,
  2811           DFHEIV99,
  2812           DFHEIV99
  2813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2814         IF DL34-RETURN-CODE NOT = 'OK'
  2815             MOVE  '**DLO034 CLOSE ERROR - ABORT**'
  2816                                 TO W-ERROR-LINE
  2817             PERFORM 0400-SEND-TEXT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL6942.cbl
  2818
  2819
  2820* EXEC CICS RETURN
  2821*    END-EXEC.
  2822*    MOVE '.(                    &   #00002713' TO DFHEIV0
  2823     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2824     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2825     MOVE X'2020233030303032373133' TO DFHEIV0(25:11)
  2826     CALL 'kxdfhei1' USING DFHEIV0,
  2827           DFHEIV99,
  2828           DFHEIV99,
  2829           DFHEIV99,
  2830           DFHEIV99,
  2831           DFHEIV99
  2832     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2833
  2834
  2835 0300-NOT-FOUND.
  2836
  2837     MOVE 'NO COMMUNICATION AREA FOUND'
  2838                                 TO W-ERROR-LINE.
  2839     PERFORM 0400-SEND-TEXT.
  2840     GO TO 0200-END-DATA.
  2841
  2842 0400-SEND-TEXT.
  2843
  2844
  2845* EXEC CICS SEND TEXT
  2846*        FROM   (W-ERROR-LINE)
  2847*        LENGTH (70)
  2848*    END-EXEC.
  2849     MOVE 70
  2850       TO DFHEIV11
  2851*    MOVE '8&      T       H   F -   #00002725' TO DFHEIV0
  2852     MOVE X'382620202020202054202020' TO DFHEIV0(1:12)
  2853     MOVE X'202020204820202046202D20' TO DFHEIV0(13:12)
  2854     MOVE X'2020233030303032373235' TO DFHEIV0(25:11)
  2855     CALL 'kxdfhei1' USING DFHEIV0,
  2856           W-ERROR-LINE,
  2857           DFHEIV11,
  2858           DFHEIV99,
  2859           DFHEIV99,
  2860           DFHEIV99,
  2861           DFHEIV99,
  2862           DFHEIV99,
  2863           DFHEIV99,
  2864           DFHEIV99,
  2865           DFHEIV99,
  2866           DFHEIV99,
  2867           DFHEIV99
  2868     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2869
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL6942.cbl
  2871 1000-INITIALIZE.
  2872
  2873     MOVE SPACES                 TO W-ADJUST-AREA.
  2874     MOVE W-SAVE-CURRENT-BIN-DATE
  2875                                 TO W-CURRENT-SAVE.
  2876
  2877     MOVE PI-ENTRY-CODES         TO W-OPTION-CODES.
  2878     MOVE PI-6942-STARTING-ARCH-NO
  2879                                 TO W-SAVE-ARCH-NO.
  2880
  2881*****************************************************************
  2882*  THE FOLLOWING 'IF' LOGIC SETS THE PRIORITIES WHEN THE USER   *
  2883*  ENTERS MORE THAN ONE PRINT RESTRICTION.  THE LOGIC USING     *
  2884*  W-PROCESSING-SW MAKES DECISIONS BASED ON THIS PRIORITY.      *
  2885*  THE PRIORITY IS 1. BRANCH ENTRY/ CHECK QUE CONTROL           *
  2886*                  2. PROCESSOR ID                              *
  2887*                  3. LETTER FORM CODE                          *
  2888*                  4. KEY FIELDS                                *
  2889*                  5. NO RESTRICTIONS                           *
  2890*****************************************************************
  2891
  2892     IF  PI-6942-ENTRY GREATER THAN LOW-VALUES
  2893         MOVE 5                  TO W-PROCESSING-SW
  2894     ELSE
  2895         IF  PI-6942-PRINT-BY-PROCESSOR
  2896             MOVE 1              TO W-PROCESSING-SW
  2897         ELSE
  2898             IF  PI-6942-LETTER-FORM GREATER THAN SPACES
  2899                 MOVE 2          TO W-PROCESSING-SW
  2900             ELSE
  2901                 IF  PI-6942-PRINT-BY-KEY
  2902                     MOVE 3      TO W-PROCESSING-SW
  2903                 ELSE
  2904                     MOVE 4      TO W-PROCESSING-SW.
  2905
  2906 1000-EXIT.
  2907     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL6942.cbl
  2909 2000-PROCESS-ARCHIVES.
  2910
  2911     GO TO 2100-BY-PROCESSOR
  2912           2200-BY-LETTER
  2913           2300-BY-KEY
  2914           2400-BY-ARCHIVE
  2915           2500-BY-CONTROL-ENTRY
  2916                                 DEPENDING ON W-PROCESSING-SW.
  2917
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL6942.cbl
  2919 2100-BY-PROCESSOR.
  2920
  2921     MOVE LOW-VALUES             TO W-ARCH4-KEY.
  2922     MOVE PI-COMPANY-CD          TO W-ARCH4-COMPANY-CD.
  2923     MOVE PI-6942-PRINT-PROCESSOR
  2924                                 TO W-ARCH4-PROCESSOR-CD.
  2925     MOVE PI-6942-PRINT-CARRIER  TO W-ARCH4-CARRIER.
  2926     MOVE PI-6942-PRINT-GROUPING TO W-ARCH4-GROUPING.
  2927     MOVE PI-6942-PRINT-STATE    TO W-ARCH4-STATE.
  2928     MOVE PI-6942-PRINT-ACCOUNT  TO W-ARCH4-ACCOUNT.
  2929
  2930     IF  W-PRINT-INITIAL
  2931             OR
  2932         W-PRINT-FOLLOW-UP
  2933         COMPUTE W-ARCH4-ARCHIVE-NO
  2934             = PI-6942-STARTING-ARCH-NO - 1.
  2935
  2936
  2937* EXEC CICS HANDLE CONDITION
  2938*         NOTOPEN  (8800-ARCH4-NOT-OPEN)
  2939*         NOTFND   (2999-EXIT)
  2940*         ENDFILE  (2999-EXIT)
  2941*    END-EXEC.
  2942*    MOVE '"$JI''                 ! $ #00002795' TO DFHEIV0
  2943     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  2944     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2945     MOVE X'2420233030303032373935' TO DFHEIV0(25:11)
  2946     CALL 'kxdfhei1' USING DFHEIV0
  2947     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2948
  2949
  2950 2100-READ-NEXT.
  2951
  2952     ADD +1                      TO W-ARCH4-ARCHIVE-NO.
  2953
  2954
  2955* EXEC CICS READ
  2956*         DATASET (W-ARCH4-ID)
  2957*         RIDFLD  (W-ARCH4-KEY)
  2958*         SET     (ADDRESS OF L-LETTER-ARCHIVE)
  2959*         GTEQ
  2960*    END-EXEC.
  2961*    MOVE '&"S        G          (   #00002805' TO DFHEIV0
  2962     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  2963     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  2964     MOVE X'2020233030303032383035' TO DFHEIV0(25:11)
  2965     CALL 'kxdfhei1' USING DFHEIV0,
  2966           W-ARCH4-ID,
  2967           DFHEIV20,
  2968           DFHEIV99,
  2969           W-ARCH4-KEY,
  2970           DFHEIV99,
  2971           DFHEIV99,
  2972           DFHEIV99
  2973     SET ADDRESS OF L-LETTER-ARCHIVE TO
  2974         DFHEIV20
  2975     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2976
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL6942.cbl
  2977
  2978     MOVE L-LETTER-ARCHIVE       TO LETTER-ARCHIVE.
  2979
  2980     IF  PI-COMPANY-CD NOT EQUAL LA-COMPANY-CD
  2981         GO TO 2999-EXIT.
  2982
  2983     IF  LA-PROCESSOR-CD NOT EQUAL PI-6942-PRINT-PROCESSOR
  2984         GO TO 2999-EXIT.
  2985
  2986     MOVE LA-CONTROL-BY-PROCESSOR
  2987                                 TO W-ARCH4-KEY.
  2988
  2989     IF  LA-REPLY-DATE GREATER THAN LOW-VALUES
  2990             OR
  2991         LA-STATUS-VOIDED
  2992             OR
  2993         LA-STATUS-PURGED
  2994             OR
  2995         LA-STATUS-TO-BE-PURGED
  2996             OR
  2997         LA-STATUS-ON-HOLD
  2998         GO TO 2100-READ-NEXT.
  2999
  3000     ADD +1                      TO W-RECORD-COUNT.
  3001
  3002     IF  W-RECORD-COUNT IS GREATER THAN +50
  3003         MOVE +0                 TO W-RECORD-COUNT
  3004
  3005
  3006* EXEC CICS DELAY
  3007*            INTERVAL  (W-DELAY-INTERVAL)
  3008*        END-EXEC.
  3009*    MOVE '0$I                   &   #00002839' TO DFHEIV0
  3010     MOVE X'302449202020202020202020' TO DFHEIV0(1:12)
  3011     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3012     MOVE X'2020233030303032383339' TO DFHEIV0(25:11)
  3013     CALL 'kxdfhei1' USING DFHEIV0,
  3014           W-DELAY-INTERVAL,
  3015           DFHEIV99,
  3016           DFHEIV99,
  3017           DFHEIV99,
  3018           DFHEIV99
  3019     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3020
  3021
  3022     MOVE LA-ARCHIVE-NO          TO W-ARCHIVE-SAVE.
  3023
  3024     IF  W-REPRINT-LETTERS
  3025         PERFORM 6000-REPRINT-CHECKS THRU 6299-EXIT
  3026         GO TO 2100-READ-NEXT.
  3027
  3028     IF  W-PRINT-LABELS
  3029         PERFORM 6300-LABEL-CHECKS THRU 6399-EXIT
  3030         GO TO 2100-READ-NEXT.
  3031
  3032     IF  LA-STATUS-COMPLETED
  3033         GO TO 2100-READ-NEXT.
  3034
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL6942.cbl
  3035     IF  W-PRINT-INITIAL
  3036         PERFORM 3000-INITIAL-CHECKS THRU 3999-EXIT
  3037         GO TO 2100-READ-NEXT.
  3038
  3039     IF  W-PRINT-FOLLOW-UP
  3040         PERFORM 4000-FOLLOW-UP-CHECKS THRU 4199-EXIT
  3041         GO TO 2100-READ-NEXT.
  3042
  3043     GO TO 2100-READ-NEXT.
  3044
  3045 2100-EXIT.
  3046     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL6942.cbl
  3048 2200-BY-LETTER.
  3049
  3050     MOVE LOW-VALUES             TO W-ARCH3-KEY.
  3051     MOVE PI-COMPANY-CD          TO W-ARCH3-COMPANY-CD.
  3052     MOVE PI-6942-LETTER-FORM    TO W-ARCH3-FORM.
  3053     MOVE PI-6942-PRINT-CARRIER  TO W-ARCH3-CARRIER.
  3054     MOVE PI-6942-PRINT-GROUPING TO W-ARCH3-GROUPING.
  3055     MOVE PI-6942-PRINT-STATE    TO W-ARCH3-STATE.
  3056     MOVE PI-6942-PRINT-ACCOUNT  TO W-ARCH3-ACCOUNT.
  3057
  3058     IF  W-PRINT-INITIAL
  3059             OR
  3060         W-PRINT-FOLLOW-UP
  3061         COMPUTE W-ARCH3-ARCHIVE-NO
  3062             = PI-6942-STARTING-ARCH-NO - 1.
  3063
  3064
  3065* EXEC CICS HANDLE CONDITION
  3066*         NOTOPEN  (8810-ARCH3-NOT-OPEN)
  3067*         NOTFND   (2999-EXIT)
  3068*         ENDFILE  (2999-EXIT)
  3069*    END-EXEC.
  3070*    MOVE '"$JI''                 ! % #00002885' TO DFHEIV0
  3071     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3072     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3073     MOVE X'2520233030303032383835' TO DFHEIV0(25:11)
  3074     CALL 'kxdfhei1' USING DFHEIV0
  3075     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3076
  3077
  3078 2200-READ-NEXT.
  3079
  3080     ADD +1                      TO W-ARCH3-ARCHIVE-NO.
  3081
  3082
  3083* EXEC CICS READ
  3084*         DATASET (W-ARCH3-ID)
  3085*         RIDFLD  (W-ARCH3-KEY)
  3086*         SET     (ADDRESS OF L-LETTER-ARCHIVE)
  3087*         GTEQ
  3088*    END-EXEC.
  3089*    MOVE '&"S        G          (   #00002895' TO DFHEIV0
  3090     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3091     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3092     MOVE X'2020233030303032383935' TO DFHEIV0(25:11)
  3093     CALL 'kxdfhei1' USING DFHEIV0,
  3094           W-ARCH3-ID,
  3095           DFHEIV20,
  3096           DFHEIV99,
  3097           W-ARCH3-KEY,
  3098           DFHEIV99,
  3099           DFHEIV99,
  3100           DFHEIV99
  3101     SET ADDRESS OF L-LETTER-ARCHIVE TO
  3102         DFHEIV20
  3103     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3104
  3105
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  64
* EL6942.cbl
  3106     MOVE L-LETTER-ARCHIVE       TO LETTER-ARCHIVE.
  3107
  3108     IF  PI-COMPANY-CD NOT EQUAL LA-COMPANY-CD
  3109         GO TO 2999-EXIT.
  3110
  3111     IF  LA-FORM-A3 NOT EQUAL PI-6942-LETTER-FORM
  3112         GO TO 2999-EXIT.
  3113
  3114     MOVE LA-CONTROL-BY-FORM     TO W-ARCH3-KEY.
  3115
  3116     IF  LA-REPLY-DATE GREATER THAN LOW-VALUES
  3117             OR
  3118         LA-STATUS-VOIDED
  3119             OR
  3120         LA-STATUS-PURGED
  3121             OR
  3122         LA-STATUS-TO-BE-PURGED
  3123             OR
  3124         LA-STATUS-ON-HOLD
  3125         GO TO 2200-READ-NEXT.
  3126
  3127     ADD +1                      TO W-RECORD-COUNT.
  3128
  3129     IF  W-RECORD-COUNT IS GREATER THAN +50
  3130         MOVE +0                 TO W-RECORD-COUNT
  3131
  3132
  3133* EXEC CICS DELAY
  3134*            INTERVAL  (W-DELAY-INTERVAL)
  3135*        END-EXEC.
  3136*    MOVE '0$I                   &   #00002928' TO DFHEIV0
  3137     MOVE X'302449202020202020202020' TO DFHEIV0(1:12)
  3138     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3139     MOVE X'2020233030303032393238' TO DFHEIV0(25:11)
  3140     CALL 'kxdfhei1' USING DFHEIV0,
  3141           W-DELAY-INTERVAL,
  3142           DFHEIV99,
  3143           DFHEIV99,
  3144           DFHEIV99,
  3145           DFHEIV99
  3146     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3147
  3148
  3149     MOVE LA-ARCHIVE-NO          TO W-ARCHIVE-SAVE.
  3150
  3151     IF  W-REPRINT-LETTERS
  3152         PERFORM 6000-REPRINT-CHECKS THRU 6299-EXIT
  3153         GO TO 2200-READ-NEXT.
  3154
  3155     IF  W-PRINT-LABELS
  3156         PERFORM 6300-LABEL-CHECKS THRU 6399-EXIT
  3157         GO TO 2200-READ-NEXT.
  3158
  3159     IF  LA-STATUS-COMPLETED
  3160         GO TO 2200-READ-NEXT.
  3161
  3162     IF  W-PRINT-INITIAL
  3163         PERFORM 3000-INITIAL-CHECKS THRU 3999-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  65
* EL6942.cbl
  3164         GO TO 2200-READ-NEXT.
  3165
  3166     IF  W-PRINT-FOLLOW-UP
  3167         PERFORM 4000-FOLLOW-UP-CHECKS THRU 4199-EXIT
  3168         GO TO 2200-READ-NEXT.
  3169
  3170     GO TO 2200-READ-NEXT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  66
* EL6942.cbl
  3172 2300-BY-KEY.
  3173
  3174     MOVE LOW-VALUES             TO W-ARCH5-KEY.
  3175     MOVE PI-COMPANY-CD          TO W-ARCH5-COMPANY-CD.
  3176     MOVE PI-6942-PRINT-CARRIER  TO W-ARCH5-CARRIER.
  3177     MOVE PI-6942-PRINT-GROUPING TO W-ARCH5-GROUPING.
  3178     MOVE PI-6942-PRINT-STATE    TO W-ARCH5-STATE.
  3179     MOVE PI-6942-PRINT-ACCOUNT  TO W-ARCH5-ACCOUNT.
  3180
  3181     IF  W-PRINT-INITIAL
  3182             OR
  3183         W-PRINT-FOLLOW-UP
  3184         COMPUTE W-ARCH5-ARCHIVE-NO
  3185             = PI-6942-STARTING-ARCH-NO - 1.
  3186
  3187
  3188* EXEC CICS HANDLE CONDITION
  3189*         NOTOPEN  (8860-ARCH5-NOT-OPEN)
  3190*         NOTFND   (2999-EXIT)
  3191*         ENDFILE  (2999-EXIT)
  3192*    END-EXEC.
  3193*    MOVE '"$JI''                 ! & #00002970' TO DFHEIV0
  3194     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3195     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3196     MOVE X'2620233030303032393730' TO DFHEIV0(25:11)
  3197     CALL 'kxdfhei1' USING DFHEIV0
  3198     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3199
  3200
  3201 2300-READ-NEXT.
  3202
  3203     ADD +1                      TO W-ARCH5-ARCHIVE-NO.
  3204
  3205
  3206* EXEC CICS READ
  3207*         DATASET (W-ARCH5-ID)
  3208*         RIDFLD  (W-ARCH5-KEY)
  3209*         SET     (ADDRESS OF L-LETTER-ARCHIVE)
  3210*         GTEQ
  3211*    END-EXEC.
  3212*    MOVE '&"S        G          (   #00002980' TO DFHEIV0
  3213     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3214     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3215     MOVE X'2020233030303032393830' TO DFHEIV0(25:11)
  3216     CALL 'kxdfhei1' USING DFHEIV0,
  3217           W-ARCH5-ID,
  3218           DFHEIV20,
  3219           DFHEIV99,
  3220           W-ARCH5-KEY,
  3221           DFHEIV99,
  3222           DFHEIV99,
  3223           DFHEIV99
  3224     SET ADDRESS OF L-LETTER-ARCHIVE TO
  3225         DFHEIV20
  3226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3227
  3228
  3229     MOVE L-LETTER-ARCHIVE       TO LETTER-ARCHIVE.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  67
* EL6942.cbl
  3230
  3231     IF  PI-COMPANY-CD NOT EQUAL LA-COMPANY-CD
  3232         GO TO 2999-EXIT.
  3233
  3234     MOVE LA-CONTROL-BY-KEY-FIELDS
  3235                                 TO W-ARCH5-KEY.
  3236
  3237     IF  LA-REPLY-DATE GREATER THAN LOW-VALUES
  3238             OR
  3239         LA-STATUS-VOIDED
  3240             OR
  3241         LA-STATUS-PURGED
  3242             OR
  3243         LA-STATUS-TO-BE-PURGED
  3244             OR
  3245         LA-STATUS-ON-HOLD
  3246         GO TO 2300-READ-NEXT.
  3247
  3248     ADD +1                      TO W-RECORD-COUNT.
  3249
  3250     IF  W-RECORD-COUNT IS GREATER THAN +50
  3251         MOVE +0                 TO W-RECORD-COUNT
  3252
  3253* EXEC CICS DELAY
  3254*            INTERVAL  (W-DELAY-INTERVAL)
  3255*        END-EXEC.
  3256*    MOVE '0$I                   &   #00003010' TO DFHEIV0
  3257     MOVE X'302449202020202020202020' TO DFHEIV0(1:12)
  3258     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3259     MOVE X'2020233030303033303130' TO DFHEIV0(25:11)
  3260     CALL 'kxdfhei1' USING DFHEIV0,
  3261           W-DELAY-INTERVAL,
  3262           DFHEIV99,
  3263           DFHEIV99,
  3264           DFHEIV99,
  3265           DFHEIV99
  3266     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3267
  3268
  3269     MOVE LA-ARCHIVE-NO          TO W-ARCHIVE-SAVE.
  3270
  3271     IF  W-REPRINT-LETTERS
  3272         PERFORM 6000-REPRINT-CHECKS THRU 6299-EXIT
  3273         GO TO 2300-READ-NEXT.
  3274
  3275     IF  W-PRINT-LABELS
  3276         PERFORM 6300-LABEL-CHECKS THRU 6399-EXIT
  3277         GO TO 2300-READ-NEXT.
  3278
  3279     IF  LA-STATUS-COMPLETED
  3280         GO TO 2300-READ-NEXT.
  3281
  3282     IF  W-PRINT-INITIAL
  3283         PERFORM 3000-INITIAL-CHECKS THRU 3999-EXIT
  3284         GO TO 2300-READ-NEXT.
  3285
  3286     IF  W-PRINT-FOLLOW-UP
  3287         PERFORM 4000-FOLLOW-UP-CHECKS THRU 4199-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  68
* EL6942.cbl
  3288         GO TO 2300-READ-NEXT.
  3289
  3290     GO TO 2300-READ-NEXT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  69
* EL6942.cbl
  3292 2400-BY-ARCHIVE.
  3293
  3294     MOVE LOW-VALUES             TO W-ARCH-KEY.
  3295     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD.
  3296
  3297     IF  W-PRINT-INITIAL
  3298             OR
  3299         W-PRINT-FOLLOW-UP
  3300         COMPUTE W-ARCH-NUMBER
  3301             = PI-6942-STARTING-ARCH-NO - 1.
  3302
  3303
  3304* EXEC CICS HANDLE CONDITION
  3305*         NOTOPEN  (8870-ARCH-NOT-OPEN)
  3306*         NOTFND   (2999-EXIT)
  3307*         ENDFILE  (2999-EXIT)
  3308*    END-EXEC.
  3309*    MOVE '"$JI''                 ! '' #00003048' TO DFHEIV0
  3310     MOVE X'22244A492720202020202020' TO DFHEIV0(1:12)
  3311     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3312     MOVE X'2720233030303033303438' TO DFHEIV0(25:11)
  3313     CALL 'kxdfhei1' USING DFHEIV0
  3314     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3315
  3316
  3317 2400-READ-NEXT.
  3318
  3319     ADD +1                      TO W-ARCH-NUMBER.
  3320
  3321
  3322* EXEC CICS READ
  3323*         DATASET (W-ARCH-ID)
  3324*         RIDFLD  (W-ARCH-KEY)
  3325*         SET     (ADDRESS OF L-LETTER-ARCHIVE)
  3326*         GTEQ
  3327*    END-EXEC.
  3328*    MOVE '&"S        G          (   #00003058' TO DFHEIV0
  3329     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3330     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3331     MOVE X'2020233030303033303538' TO DFHEIV0(25:11)
  3332     CALL 'kxdfhei1' USING DFHEIV0,
  3333           W-ARCH-ID,
  3334           DFHEIV20,
  3335           DFHEIV99,
  3336           W-ARCH-KEY,
  3337           DFHEIV99,
  3338           DFHEIV99,
  3339           DFHEIV99
  3340     SET ADDRESS OF L-LETTER-ARCHIVE TO
  3341         DFHEIV20
  3342     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3343
  3344
  3345     MOVE L-LETTER-ARCHIVE       TO LETTER-ARCHIVE.
  3346
  3347     IF  PI-COMPANY-CD NOT EQUAL LA-COMPANY-CD
  3348         GO TO 2999-EXIT.
  3349
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  70
* EL6942.cbl
  3350     MOVE LA-CONTROL-PRIMARY     TO W-ARCH-KEY.
  3351
  3352     IF  LA-REPLY-DATE GREATER THAN LOW-VALUES
  3353             OR
  3354         LA-STATUS-VOIDED
  3355             OR
  3356         LA-STATUS-PURGED
  3357             OR
  3358         LA-STATUS-TO-BE-PURGED
  3359             OR
  3360         LA-STATUS-ON-HOLD
  3361         GO TO 2400-READ-NEXT.
  3362
  3363     ADD +1                      TO W-RECORD-COUNT.
  3364
  3365     IF  W-RECORD-COUNT IS GREATER THAN +50
  3366         MOVE +0                 TO W-RECORD-COUNT
  3367
  3368* EXEC CICS DELAY
  3369*            INTERVAL  (W-DELAY-INTERVAL)
  3370*        END-EXEC.
  3371*    MOVE '0$I                   &   #00003087' TO DFHEIV0
  3372     MOVE X'302449202020202020202020' TO DFHEIV0(1:12)
  3373     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3374     MOVE X'2020233030303033303837' TO DFHEIV0(25:11)
  3375     CALL 'kxdfhei1' USING DFHEIV0,
  3376           W-DELAY-INTERVAL,
  3377           DFHEIV99,
  3378           DFHEIV99,
  3379           DFHEIV99,
  3380           DFHEIV99
  3381     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3382
  3383
  3384     MOVE LA-ARCHIVE-NO          TO W-ARCHIVE-SAVE.
  3385
  3386     IF  W-REPRINT-LETTERS
  3387         PERFORM 6000-REPRINT-CHECKS THRU 6299-EXIT
  3388         GO TO 2400-READ-NEXT.
  3389
  3390     IF  W-PRINT-LABELS
  3391         PERFORM 6300-LABEL-CHECKS THRU 6399-EXIT
  3392         GO TO 2400-READ-NEXT.
  3393
  3394     IF  LA-STATUS-COMPLETED
  3395         GO TO 2400-READ-NEXT.
  3396
  3397     IF  W-PRINT-INITIAL
  3398         PERFORM 3000-INITIAL-CHECKS THRU 3999-EXIT
  3399         GO TO 2400-READ-NEXT.
  3400
  3401     IF  W-PRINT-FOLLOW-UP
  3402         PERFORM 4000-FOLLOW-UP-CHECKS THRU 4199-EXIT
  3403         GO TO 2400-READ-NEXT.
  3404
  3405     GO TO 2400-READ-NEXT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  71
* EL6942.cbl
  3407 2500-BY-CONTROL-ENTRY.
  3408
  3409     MOVE LOW-VALUES             TO W-ARCH6-KEY.
  3410     MOVE PI-COMPANY-CD          TO W-ARCH6-COMPANY-CD.
  3411     MOVE PI-6942-ENTRY          TO W-ARCH6-ENTRY.
  3412
  3413     IF  W-PRINT-INITIAL
  3414             OR
  3415         W-PRINT-FOLLOW-UP
  3416         COMPUTE W-ARCH6-ARCHIVE-NO
  3417             = PI-6942-STARTING-ARCH-NO - 1.
  3418
  3419
  3420* EXEC CICS HANDLE CONDITION
  3421*         NOTOPEN  (8860-ARCH5-NOT-OPEN)
  3422*    END-EXEC.
  3423*    MOVE '"$J                   ! ( #00003126' TO DFHEIV0
  3424     MOVE X'22244A202020202020202020' TO DFHEIV0(1:12)
  3425     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3426     MOVE X'2820233030303033313236' TO DFHEIV0(25:11)
  3427     CALL 'kxdfhei1' USING DFHEIV0
  3428     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3429
  3430
  3431 2500-READ-NEXT.
  3432
  3433
  3434* EXEC CICS HANDLE CONDITION
  3435*         ENDFILE  (2999-EXIT)
  3436*         NOTFND   (2999-EXIT)
  3437*    END-EXEC.
  3438*    MOVE '"$''I                  ! ) #00003132' TO DFHEIV0
  3439     MOVE X'222427492020202020202020' TO DFHEIV0(1:12)
  3440     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3441     MOVE X'2920233030303033313332' TO DFHEIV0(25:11)
  3442     CALL 'kxdfhei1' USING DFHEIV0
  3443     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3444
  3445
  3446     ADD +1                      TO W-ARCH6-ARCHIVE-NO.
  3447
  3448
  3449* EXEC CICS READ
  3450*         DATASET (W-ARCH6-ID)
  3451*         RIDFLD  (W-ARCH6-KEY)
  3452*         SET     (ADDRESS OF L-LETTER-ARCHIVE)
  3453*         GTEQ
  3454*    END-EXEC.
  3455*    MOVE '&"S        G          (   #00003139' TO DFHEIV0
  3456     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  3457     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3458     MOVE X'2020233030303033313339' TO DFHEIV0(25:11)
  3459     CALL 'kxdfhei1' USING DFHEIV0,
  3460           W-ARCH6-ID,
  3461           DFHEIV20,
  3462           DFHEIV99,
  3463           W-ARCH6-KEY,
  3464           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  72
* EL6942.cbl
  3465           DFHEIV99,
  3466           DFHEIV99
  3467     SET ADDRESS OF L-LETTER-ARCHIVE TO
  3468         DFHEIV20
  3469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3470
  3471
  3472     MOVE L-LETTER-ARCHIVE       TO LETTER-ARCHIVE.
  3473
  3474     IF  PI-COMPANY-CD NOT EQUAL LA-COMPANY-CD
  3475         GO TO 2999-EXIT.
  3476
  3477     IF  PI-6942-ENTRY NOT EQUAL LA-ENTRY-A6
  3478         GO TO 2999-EXIT.
  3479
  3480     MOVE LA-CONTROL-BY-GROUP-CODE
  3481                                 TO W-ARCH6-KEY.
  3482
  3483     IF  LA-REPLY-DATE GREATER THAN LOW-VALUES
  3484             OR
  3485         LA-STATUS-VOIDED
  3486             OR
  3487         LA-STATUS-PURGED
  3488             OR
  3489         LA-STATUS-TO-BE-PURGED
  3490             OR
  3491         LA-STATUS-ON-HOLD
  3492         GO TO 2500-READ-NEXT.
  3493
  3494     ADD +1                      TO W-RECORD-COUNT.
  3495
  3496     IF  W-RECORD-COUNT IS GREATER THAN +50
  3497         MOVE +0                 TO W-RECORD-COUNT
  3498
  3499* EXEC CICS DELAY
  3500*            INTERVAL  (W-DELAY-INTERVAL)
  3501*        END-EXEC.
  3502*    MOVE '0$I                   &   #00003172' TO DFHEIV0
  3503     MOVE X'302449202020202020202020' TO DFHEIV0(1:12)
  3504     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  3505     MOVE X'2020233030303033313732' TO DFHEIV0(25:11)
  3506     CALL 'kxdfhei1' USING DFHEIV0,
  3507           W-DELAY-INTERVAL,
  3508           DFHEIV99,
  3509           DFHEIV99,
  3510           DFHEIV99,
  3511           DFHEIV99
  3512     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3513
  3514
  3515     MOVE LA-ARCHIVE-NO          TO W-ARCHIVE-SAVE.
  3516
  3517     IF  W-REPRINT-LETTERS
  3518         PERFORM 6000-REPRINT-CHECKS THRU 6299-EXIT
  3519         GO TO 2500-READ-NEXT.
  3520
  3521     IF  W-PRINT-LABELS
  3522         PERFORM 6300-LABEL-CHECKS THRU 6399-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  73
* EL6942.cbl
  3523         GO TO 2500-READ-NEXT.
  3524
  3525     IF  LA-STATUS-COMPLETED
  3526         GO TO 2500-READ-NEXT.
  3527
  3528     IF  W-PRINT-INITIAL
  3529         PERFORM 3000-INITIAL-CHECKS THRU 3999-EXIT
  3530         GO TO 2500-READ-NEXT.
  3531
  3532     IF  W-PRINT-FOLLOW-UP
  3533         PERFORM 4000-FOLLOW-UP-CHECKS THRU 4199-EXIT
  3534         GO TO 2500-READ-NEXT.
  3535
  3536     GO TO 2500-READ-NEXT.
  3537
  3538 2999-EXIT.
  3539     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  74
* EL6942.cbl
  3541 3000-INITIAL-CHECKS.
  3542
  3543     IF  LA-INITIAL-PRINT-DATE NOT EQUAL LOW-VALUES
  3544         GO TO 3999-EXIT.
  3545
  3546     PERFORM 3900-CHECK-FOR-ACTIVE-RESENDS THRU 3900-EXIT
  3547     IF PI-6942-PRINT-DATE-BIN NOT = LOW-VALUES
  3548        IF LA-CREATION-DATE NOT = PI-6942-PRINT-DATE-BIN
  3549           GO TO 3999-EXIT
  3550        END-IF
  3551     END-IF
  3552     GO TO 3100-BY-PROCESSOR
  3553           3200-BY-LETTER
  3554           3300-BY-KEY
  3555           3400-BY-ARCHIVE
  3556           3500-BY-CONTROL-ENTRY
  3557                                 DEPENDING ON W-PROCESSING-SW.
  3558     GO TO 3999-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  75
* EL6942.cbl
  3560 3100-BY-PROCESSOR.
  3561
  3562     IF  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  3563         GO TO 3999-EXIT.
  3564
  3565     IF  PI-6942-LETTER-FORM GREATER THAN SPACES
  3566             AND
  3567         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  3568         GO TO 3999-EXIT.
  3569
  3570     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  3571             AND
  3572         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  3573         GO TO 3999-EXIT.
  3574
  3575     IF  NOT PI-6942-PRINT-BY-KEY
  3576         GO TO 3100-CONTINUE.
  3577
  3578     IF  LA-CARRIER-A4 GREATER THAN PI-6942-PRINT-CARRIER
  3579         MOVE 'Y'                TO W-ENDBR-SW
  3580         GO TO 3999-EXIT.
  3581
  3582     IF  PI-6942-PRINT-BY-CARRIER
  3583         GO TO 3100-CONTINUE.
  3584
  3585     IF  LA-GROUPING-A4 GREATER THAN PI-6942-PRINT-GROUPING
  3586         MOVE 'Y'                TO W-ENDBR-SW
  3587         GO TO 3999-EXIT.
  3588
  3589     IF  PI-6942-PRINT-BY-GROUPING
  3590         GO TO 3100-CONTINUE.
  3591
  3592     IF  LA-STATE-A4 GREATER THAN PI-6942-PRINT-STATE
  3593         MOVE 'Y'                TO W-ENDBR-SW
  3594         GO TO 3999-EXIT.
  3595
  3596     IF  PI-6942-PRINT-BY-STATE
  3597         GO TO 3100-CONTINUE.
  3598
  3599     IF  LA-ACCOUNT-A4 GREATER THAN PI-6942-PRINT-ACCOUNT
  3600         MOVE 'Y'                TO W-ENDBR-SW
  3601         GO TO 3999-EXIT.
  3602
  3603 3100-CONTINUE.
  3604
  3605     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  3606
  3607     MOVE W-CURRENT-SAVE         TO LA-INITIAL-PRINT-DATE.
  3608
  3609     IF  LA-RESEND-DATE = LOW-VALUES
  3610         MOVE 'C'                TO LA-STATUS.
  3611
  3612     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  3613
  3614     IF  W-THIS-IS-FIRST-FORM
  3615         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  3616             PI-6942-ALIGNMENT-COPIES TIMES
  3617         MOVE 'Y'                TO W-FIRST-FORM-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  76
* EL6942.cbl
  3618
  3619     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  3620         W-COPIES TIMES.
  3621
  3622     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  3623
  3624     GO TO 3999-EXIT.
  3625
  3626 3100-EXIT.
  3627      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  77
* EL6942.cbl
  3629 3200-BY-LETTER.
  3630
  3631     IF  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  3632             OR
  3633         LA-PRINT-ONLY-WHEN-PROC-GIVEN
  3634         GO TO 3999-EXIT.
  3635
  3636     IF  NOT PI-6942-PRINT-BY-KEY
  3637         GO TO 3200-CONTINUE.
  3638
  3639     IF  LA-CARRIER-A3 GREATER THAN PI-6942-PRINT-CARRIER
  3640         MOVE 'Y'                TO W-ENDBR-SW
  3641         GO TO 3999-EXIT.
  3642
  3643     IF  PI-6942-PRINT-BY-CARRIER
  3644         GO TO 3200-CONTINUE.
  3645
  3646     IF  LA-GROUPING-A3 GREATER THAN PI-6942-PRINT-GROUPING
  3647         MOVE 'Y'                TO W-ENDBR-SW
  3648         GO TO 3999-EXIT.
  3649
  3650     IF  PI-6942-PRINT-BY-GROUPING
  3651         GO TO 3200-CONTINUE.
  3652
  3653     IF  LA-STATE-A3 GREATER THAN PI-6942-PRINT-STATE
  3654         MOVE 'Y'                TO W-ENDBR-SW
  3655         GO TO 3999-EXIT.
  3656
  3657     IF  PI-6942-PRINT-BY-STATE
  3658         GO TO 3200-CONTINUE.
  3659
  3660     IF  LA-ACCOUNT-A3 GREATER THAN PI-6942-PRINT-ACCOUNT
  3661         MOVE 'Y'                TO W-ENDBR-SW
  3662         GO TO 3999-EXIT.
  3663
  3664 3200-CONTINUE.
  3665
  3666     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  3667
  3668     MOVE W-CURRENT-SAVE         TO LA-INITIAL-PRINT-DATE.
  3669
  3670     IF  LA-RESEND-DATE   EQUAL LOW-VALUES
  3671         MOVE 'C'                TO LA-STATUS.
  3672
  3673     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  3674
  3675     IF  W-THIS-IS-FIRST-FORM
  3676         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  3677             PI-6942-ALIGNMENT-COPIES TIMES
  3678         MOVE 'Y'                TO W-FIRST-FORM-SW.
  3679
  3680     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  3681         W-COPIES TIMES.
  3682
  3683     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  3684
  3685     GO TO 3999-EXIT.
  3686
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  78
* EL6942.cbl
  3687 3200-EXIT.
  3688      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  79
* EL6942.cbl
  3690 3300-BY-KEY.
  3691
  3692     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  3693             OR
  3694         LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  3695             OR
  3696         LA-PRINT-ONLY-WHEN-PROC-GIVEN
  3697         GO TO 3999-EXIT.
  3698
  3699     IF  LA-CARRIER-A5 GREATER THAN PI-6942-PRINT-CARRIER
  3700         MOVE 'Y'                TO W-ENDBR-SW
  3701         GO TO 3999-EXIT.
  3702
  3703     IF  PI-6942-PRINT-BY-CARRIER
  3704         GO TO 3300-CONTINUE.
  3705
  3706     IF  LA-GROUPING-A5 GREATER THAN PI-6942-PRINT-GROUPING
  3707         MOVE 'Y'                TO W-ENDBR-SW
  3708         GO TO 3999-EXIT.
  3709
  3710     IF  PI-6942-PRINT-BY-GROUPING
  3711         GO TO 3300-CONTINUE.
  3712
  3713     IF  LA-STATE-A5 GREATER THAN PI-6942-PRINT-STATE
  3714         MOVE 'Y'                TO W-ENDBR-SW
  3715         GO TO 3999-EXIT.
  3716
  3717     IF  PI-6942-PRINT-BY-STATE
  3718         GO TO 3300-CONTINUE.
  3719
  3720     IF  LA-ACCOUNT-A5 GREATER THAN PI-6942-PRINT-ACCOUNT
  3721         MOVE 'Y'                TO W-ENDBR-SW
  3722         GO TO 3999-EXIT.
  3723
  3724 3300-CONTINUE.
  3725
  3726     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  3727
  3728     MOVE W-CURRENT-SAVE         TO LA-INITIAL-PRINT-DATE.
  3729     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  3730
  3731     IF  W-THIS-IS-FIRST-FORM
  3732         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  3733             PI-6942-ALIGNMENT-COPIES TIMES
  3734         MOVE 'Y'                TO W-FIRST-FORM-SW.
  3735
  3736     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  3737         W-COPIES TIMES.
  3738
  3739     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  3740
  3741     GO TO 3999-EXIT.
  3742
  3743 3300-EXIT.
  3744      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  80
* EL6942.cbl
  3746 3400-BY-ARCHIVE.
  3747
  3748     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  3749             OR
  3750         LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  3751             OR
  3752         LA-PRINT-ONLY-WHEN-PROC-GIVEN
  3753         GO TO 3999-EXIT.
  3754
  3755     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  3756
  3757     MOVE W-CURRENT-SAVE         TO LA-INITIAL-PRINT-DATE.
  3758
  3759     IF  LA-RESEND-DATE   EQUAL LOW-VALUES
  3760         MOVE 'C'                TO LA-STATUS.
  3761
  3762     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  3763
  3764     IF  W-THIS-IS-FIRST-FORM
  3765         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  3766             PI-6942-ALIGNMENT-COPIES TIMES
  3767         MOVE 'Y'                TO W-FIRST-FORM-SW.
  3768
  3769     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  3770         W-COPIES TIMES.
  3771
  3772     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  3773
  3774     GO TO 3999-EXIT.
  3775
  3776 3400-EXIT.
  3777      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  81
* EL6942.cbl
  3779 3500-BY-CONTROL-ENTRY.
  3780
  3781     IF  PI-6942-PRINT-PROCESSOR GREATER THAN SPACES
  3782             AND
  3783         PI-6942-PRINT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  3784         GO TO 3999-EXIT.
  3785
  3786     IF  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  3787             AND
  3788         PI-6942-PRINT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  3789         GO TO 3999-EXIT.
  3790
  3791     IF  PI-6942-LETTER-FORM GREATER THAN SPACES
  3792             AND
  3793         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  3794         GO TO 3999-EXIT.
  3795
  3796     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  3797             AND
  3798         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  3799         GO TO 3999-EXIT.
  3800
  3801     IF  NOT W-PROCESS-BY-KEY
  3802         GO TO 3500-CONTINUE.
  3803
  3804     IF  PI-6942-PRINT-BY-KEY
  3805         IF  PI-6942-PRINT-BY-CARRIER
  3806             IF  LA-CARRIER-A3 IS EQUAL PI-6942-PRINT-CARRIER
  3807                 NEXT SENTENCE
  3808             ELSE
  3809                 GO TO 3999-EXIT
  3810         ELSE
  3811             IF  PI-6942-PRINT-BY-GROUPING
  3812                 IF  LA-CARRIER-A3 IS EQUAL
  3813                         PI-6942-PRINT-CARRIER
  3814                         AND
  3815                     LA-GROUPING-A3 IS EQUAL
  3816                         PI-6942-PRINT-GROUPING
  3817                     NEXT SENTENCE
  3818                 ELSE
  3819                     GO TO 3999-EXIT
  3820             ELSE
  3821                 IF  PI-6942-PRINT-BY-STATE
  3822                     IF  LA-CARRIER-A3 IS EQUAL
  3823                             PI-6942-PRINT-CARRIER
  3824                             AND
  3825                         LA-GROUPING-A3 IS EQUAL
  3826                             PI-6942-PRINT-GROUPING
  3827                             AND
  3828                         LA-STATE-A3 IS EQUAL
  3829                             PI-6942-PRINT-STATE
  3830                         NEXT SENTENCE
  3831                     ELSE
  3832                         GO TO 3999-EXIT
  3833                 ELSE
  3834                     IF  PI-6942-PRINT-BY-ACCOUNT
  3835                         IF  LA-CARRIER-A3 IS EQUAL
  3836                                 PI-6942-PRINT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  82
* EL6942.cbl
  3837                                 AND
  3838                             LA-GROUPING-A3 IS EQUAL
  3839                                 PI-6942-PRINT-GROUPING
  3840                                 AND
  3841                             LA-STATE-A3 IS EQUAL
  3842                                 PI-6942-PRINT-STATE
  3843                                 AND
  3844                             LA-ACCOUNT-A3 IS EQUAL
  3845                                 PI-6942-PRINT-ACCOUNT
  3846                             NEXT SENTENCE
  3847                         ELSE
  3848                             GO TO 3999-EXIT.
  3849
  3850 3500-CONTINUE.
  3851
  3852     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  3853
  3854     MOVE W-CURRENT-SAVE         TO LA-INITIAL-PRINT-DATE.
  3855
  3856     IF  LA-RESEND-DATE = LOW-VALUES
  3857         MOVE 'C'                TO LA-STATUS.
  3858
  3859     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  3860
  3861     IF  W-THIS-IS-FIRST-FORM
  3862         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  3863             PI-6942-ALIGNMENT-COPIES TIMES
  3864         MOVE 'Y'                TO W-FIRST-FORM-SW.
  3865
  3866     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  3867         W-COPIES TIMES.
  3868
  3869     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  3870
  3871     GO TO 3999-EXIT.
  3872
  3873 3500-EXIT.
  3874      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  83
* EL6942.cbl
  3876 3900-CHECK-FOR-ACTIVE-RESENDS.
  3877
  3878     IF LA-RESEND-DATE > LA-LAST-RESENT-PRINT-DATE
  3879        MOVE LA-ARCHIVE-NO       TO W-SAVE-ARCH-NO
  3880     END-IF
  3881     .
  3882 3900-EXIT.
  3883      EXIT.
  3884 3999-EXIT.
  3885      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  84
* EL6942.cbl
  3887 4000-FOLLOW-UP-CHECKS.
  3888
  3889     IF  LA-INITIAL-PRINT-DATE = LOW-VALUES
  3890         IF  W-SAVE-ARCH-NO = ZEROS
  3891                 OR
  3892             LA-ARCHIVE-NO LESS THAN W-SAVE-ARCH-NO
  3893             MOVE LA-ARCHIVE-NO  TO W-SAVE-ARCH-NO
  3894             GO TO 4199-EXIT
  3895         ELSE
  3896             GO TO 4199-EXIT.
  3897
  3898     IF  LA-RESEND-DATE = LOW-VALUES
  3899         GO TO 4199-EXIT.
  3900
  3901     MOVE LOW-VALUES             TO W-WORKING-RESEND-DATE
  3902                                    W-LAST-RESENT-PRINT-DATE.
  3903
  3904     IF  PI-6942-PRINT-DATE-BIN NOT = LOW-VALUES
  3905         PERFORM 4600-GET-APP-RSND-DT-DT-GIVEN THRU 4600-EXIT
  3906     ELSE
  3907         PERFORM 4500-GET-APP-RSND-DT-CURR-DT THRU 4500-EXIT
  3908     END-IF
  3909
  3910     IF  W-WORKING-RESEND-DATE EQUAL LOW-VALUES
  3911         IF  W-SAVE-ARCH-NO EQUAL ZEROS
  3912             GO TO 4100-CHECK-ACTIVITY
  3913         ELSE
  3914             GO TO 4199-EXIT
  3915     ELSE
  3916         IF  W-SAVE-ARCH-NO EQUAL ZEROS
  3917             MOVE LA-ARCHIVE-NO  TO W-SAVE-ARCH-NO.
  3918
  3919     GO TO 4010-BY-PROCESSOR
  3920           4020-BY-LETTER
  3921           4030-BY-KEY
  3922           4040-BY-ARCHIVE
  3923           4050-BY-CONTROL-ENTRY
  3924                                 DEPENDING ON W-PROCESSING-SW.
  3925     GO TO 4199-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  85
* EL6942.cbl
  3927 4010-BY-PROCESSOR.
  3928
  3929     IF  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  3930         GO TO 4199-EXIT.
  3931
  3932     IF  PI-6942-LETTER-FORM GREATER THAN SPACES
  3933             AND
  3934         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  3935         GO TO 4199-EXIT.
  3936
  3937     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  3938             AND
  3939         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  3940         GO TO 4199-EXIT.
  3941
  3942     IF  NOT PI-6942-PRINT-BY-KEY
  3943         GO TO 4010-CONTINUE.
  3944
  3945     IF  LA-CARRIER-A4 LESS THAN PI-6942-PRINT-CARRIER
  3946         MOVE 'Y'                TO W-ENDBR-SW
  3947         GO TO 4199-EXIT.
  3948
  3949     IF  PI-6942-PRINT-BY-CARRIER
  3950         GO TO 4010-CONTINUE.
  3951
  3952     IF  LA-GROUPING-A4 LESS THAN PI-6942-PRINT-GROUPING
  3953         MOVE 'Y'                TO W-ENDBR-SW
  3954         GO TO 4199-EXIT.
  3955
  3956     IF  PI-6942-PRINT-BY-GROUPING
  3957         GO TO 4010-CONTINUE.
  3958
  3959     IF  LA-STATE-A4 LESS THAN PI-6942-PRINT-STATE
  3960         MOVE 'Y'                TO W-ENDBR-SW
  3961         GO TO 4199-EXIT.
  3962
  3963     IF  PI-6942-PRINT-BY-STATE
  3964         GO TO 4010-CONTINUE.
  3965
  3966     IF  LA-ACCOUNT-A4 LESS THAN PI-6942-PRINT-ACCOUNT
  3967         MOVE 'Y'                TO W-ENDBR-SW
  3968         GO TO 4199-EXIT.
  3969
  3970 4010-CONTINUE.
  3971
  3972     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  3973
  3974     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  3975
  3976     IF  W-THIS-IS-FIRST-FORM
  3977         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  3978             PI-6942-ALIGNMENT-COPIES TIMES
  3979         MOVE 'Y'                TO W-FIRST-FORM-SW.
  3980
  3981     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  3982         W-COPIES TIMES.
  3983
  3984     MOVE W-LAST-RESENT-PRINT-DATE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  86
* EL6942.cbl
  3985                                 TO LA-LAST-RESENT-PRINT-DATE
  3986                                    LA-SENT-DATE
  3987
  3988     MOVE 'C'                TO LA-STATUS
  3989
  3990     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  3991     GO TO 4199-EXIT.
  3992
  3993 4010-EXIT.
  3994      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  87
* EL6942.cbl
  3996 4020-BY-LETTER.
  3997
  3998     IF  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  3999             OR
  4000         LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4001         GO TO 4199-EXIT.
  4002
  4003     IF  NOT PI-6942-PRINT-BY-KEY
  4004         GO TO 4020-CONTINUE.
  4005
  4006     IF  LA-CARRIER-A3 LESS THAN PI-6942-PRINT-CARRIER
  4007         MOVE 'Y'                TO W-ENDBR-SW
  4008         GO TO 4199-EXIT.
  4009
  4010     IF  PI-6942-PRINT-BY-CARRIER
  4011         GO TO 4020-CONTINUE.
  4012
  4013     IF  LA-GROUPING-A3 LESS THAN PI-6942-PRINT-GROUPING
  4014         MOVE 'Y'                TO W-ENDBR-SW
  4015         GO TO 4199-EXIT.
  4016
  4017     IF  PI-6942-PRINT-BY-GROUPING
  4018         GO TO 4020-CONTINUE.
  4019
  4020     IF  LA-STATE-A3 LESS THAN PI-6942-PRINT-STATE
  4021         MOVE 'Y'                TO W-ENDBR-SW
  4022         GO TO 4199-EXIT.
  4023
  4024     IF  PI-6942-PRINT-BY-STATE
  4025         GO TO 4020-CONTINUE.
  4026
  4027     IF  LA-ACCOUNT-A3 LESS THAN PI-6942-PRINT-ACCOUNT
  4028         MOVE 'Y'                TO W-ENDBR-SW
  4029         GO TO 4199-EXIT.
  4030
  4031 4020-CONTINUE.
  4032
  4033     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  4034
  4035     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  4036
  4037     IF  W-THIS-IS-FIRST-FORM
  4038         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4039             PI-6942-ALIGNMENT-COPIES TIMES
  4040         MOVE 'Y'                TO W-FIRST-FORM-SW.
  4041
  4042     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4043         W-COPIES TIMES.
  4044
  4045     MOVE W-LAST-RESENT-PRINT-DATE
  4046                                 TO LA-LAST-RESENT-PRINT-DATE
  4047                                    LA-SENT-DATE
  4048
  4049         MOVE 'C'                TO LA-STATUS.
  4050
  4051     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  4052     GO TO 4199-EXIT.
  4053
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  88
* EL6942.cbl
  4054 4020-EXIT.
  4055      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  89
* EL6942.cbl
  4057 4030-BY-KEY.
  4058
  4059     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4060             OR
  4061         LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4062             OR
  4063         LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4064         GO TO 4199-EXIT.
  4065
  4066     IF  LA-CARRIER-A5 LESS THAN PI-6942-PRINT-CARRIER
  4067         MOVE 'Y'                TO W-ENDBR-SW
  4068         GO TO 4199-EXIT.
  4069
  4070     IF  PI-6942-PRINT-BY-CARRIER
  4071         GO TO 4030-CONTINUE.
  4072
  4073     IF  LA-GROUPING-A5 LESS THAN PI-6942-PRINT-GROUPING
  4074         MOVE 'Y'                TO W-ENDBR-SW
  4075         GO TO 4199-EXIT.
  4076
  4077     IF  PI-6942-PRINT-BY-GROUPING
  4078         GO TO 4030-CONTINUE.
  4079
  4080     IF  LA-STATE-A5 LESS THAN PI-6942-PRINT-STATE
  4081         MOVE 'Y'                TO W-ENDBR-SW
  4082         GO TO 4199-EXIT.
  4083
  4084     IF  PI-6942-PRINT-BY-STATE
  4085         GO TO 4030-CONTINUE.
  4086
  4087     IF  LA-ACCOUNT-A5 LESS THAN PI-6942-PRINT-ACCOUNT
  4088         MOVE 'Y'                TO W-ENDBR-SW
  4089         GO TO 4199-EXIT.
  4090
  4091 4030-CONTINUE.
  4092
  4093     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  4094
  4095     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  4096
  4097     IF  W-THIS-IS-FIRST-FORM
  4098         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4099             PI-6942-ALIGNMENT-COPIES TIMES
  4100         MOVE 'Y'                TO W-FIRST-FORM-SW.
  4101
  4102     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4103         W-COPIES TIMES.
  4104
  4105     MOVE W-LAST-RESENT-PRINT-DATE
  4106                                 TO LA-LAST-RESENT-PRINT-DATE
  4107                                    LA-SENT-DATE
  4108
  4109         MOVE 'C'                TO LA-STATUS.
  4110
  4111     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  4112     GO TO 4199-EXIT.
  4113
  4114 4030-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  90
* EL6942.cbl
  4115      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  91
* EL6942.cbl
  4117 4040-BY-ARCHIVE.
  4118
  4119     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4120             OR
  4121         LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4122             OR
  4123         LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4124         GO TO 4199-EXIT.
  4125
  4126     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  4127
  4128     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  4129
  4130     IF  W-THIS-IS-FIRST-FORM
  4131         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4132             PI-6942-ALIGNMENT-COPIES TIMES
  4133         MOVE 'Y'                TO W-FIRST-FORM-SW.
  4134
  4135     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4136         W-COPIES TIMES.
  4137
  4138     MOVE W-LAST-RESENT-PRINT-DATE
  4139                                 TO LA-LAST-RESENT-PRINT-DATE
  4140                                    LA-SENT-DATE
  4141
  4142         MOVE 'C'                TO LA-STATUS.
  4143
  4144     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  4145     GO TO 4199-EXIT.
  4146
  4147 4040-EXIT.
  4148      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  92
* EL6942.cbl
  4150 4050-BY-CONTROL-ENTRY.
  4151
  4152     IF  PI-6942-PRINT-PROCESSOR GREATER THAN SPACES
  4153             AND
  4154         PI-6942-PRINT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  4155         GO TO 4199-EXIT.
  4156
  4157     IF  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4158             AND
  4159         PI-6942-PRINT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  4160         GO TO 4199-EXIT.
  4161
  4162     IF  PI-6942-LETTER-FORM GREATER THAN SPACES
  4163             AND
  4164         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  4165         GO TO 4199-EXIT.
  4166
  4167     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4168             AND
  4169         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  4170         GO TO 3999-EXIT.
  4171
  4172     IF  W-PROCESS-BY-KEY
  4173         GO TO 4050-CONTINUE.
  4174
  4175     IF  PI-6942-PRINT-BY-KEY
  4176         IF  PI-6942-PRINT-BY-CARRIER
  4177             IF  LA-CARRIER-A3 IS EQUAL PI-6942-PRINT-CARRIER
  4178                 NEXT SENTENCE
  4179             ELSE
  4180                 GO TO 4199-EXIT
  4181         ELSE
  4182             IF  PI-6942-PRINT-BY-GROUPING
  4183                 IF  LA-CARRIER-A3 IS EQUAL
  4184                         PI-6942-PRINT-CARRIER
  4185                         AND
  4186                     LA-GROUPING-A3 IS EQUAL
  4187                         PI-6942-PRINT-GROUPING
  4188                     NEXT SENTENCE
  4189                 ELSE
  4190                     GO TO 4199-EXIT
  4191             ELSE
  4192                 IF  PI-6942-PRINT-BY-STATE
  4193                     IF  LA-CARRIER-A3 IS EQUAL
  4194                             PI-6942-PRINT-CARRIER
  4195                             AND
  4196                         LA-GROUPING-A3 IS EQUAL
  4197                             PI-6942-PRINT-GROUPING
  4198                             AND
  4199                         LA-STATE-A3 IS EQUAL
  4200                             PI-6942-PRINT-STATE
  4201                         NEXT SENTENCE
  4202                     ELSE
  4203                         GO TO 4199-EXIT
  4204                 ELSE
  4205                     IF  PI-6942-PRINT-BY-ACCOUNT
  4206                         IF  LA-CARRIER-A3 IS EQUAL
  4207                                 PI-6942-PRINT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  93
* EL6942.cbl
  4208                                 AND
  4209                             LA-GROUPING-A3 IS EQUAL
  4210                                 PI-6942-PRINT-GROUPING
  4211                                 AND
  4212                             LA-STATE-A3 IS EQUAL
  4213                                 PI-6942-PRINT-STATE
  4214                                 AND
  4215                             LA-ACCOUNT-A3 IS EQUAL
  4216                                 PI-6942-PRINT-ACCOUNT
  4217                             NEXT SENTENCE
  4218                         ELSE
  4219                             GO TO 4199-EXIT.
  4220
  4221 4050-CONTINUE.
  4222
  4223     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  4224
  4225     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  4226
  4227     IF  W-THIS-IS-FIRST-FORM
  4228         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4229             PI-6942-ALIGNMENT-COPIES TIMES
  4230         MOVE 'Y'                TO W-FIRST-FORM-SW.
  4231
  4232     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4233         W-COPIES TIMES.
  4234
  4235     MOVE W-LAST-RESENT-PRINT-DATE
  4236                                 TO LA-LAST-RESENT-PRINT-DATE
  4237                                    LA-SENT-DATE
  4238
  4239         MOVE 'C'                TO LA-STATUS.
  4240
  4241     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  4242     GO TO 4199-EXIT.
  4243
  4244 4050-EXIT.
  4245      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  94
* EL6942.cbl
  4247 4100-CHECK-ACTIVITY.
  4248
  4249     PERFORM 3900-CHECK-FOR-ACTIVE-RESENDS THRU 3900-EXIT
  4250     .
  4251 4199-EXIT.
  4252     EXIT.
  4253
  4254 4500-GET-APP-RSND-DT-CURR-DT.
  4255
  4256     IF LA-RESEND-DATE = LOW-VALUE
  4257         GO TO 4500-EXIT.
  4258
  4259     IF (LA-RESEND-DATE NOT > W-CURRENT-SAVE)
  4260        AND (LA-RESEND-DATE > LA-LAST-RESENT-PRINT-DATE)
  4261         MOVE W-CURRENT-SAVE     TO W-LAST-RESENT-PRINT-DATE
  4262         MOVE LA-RESEND-DATE     TO W-WORKING-RESEND-DATE.
  4263
  4264 4500-EXIT.
  4265      EXIT.
  4266
  4267 4600-GET-APP-RSND-DT-DT-GIVEN.
  4268
  4269     IF  LA-RESEND-DATE EQUAL LOW-VALUE
  4270         GO TO 4600-EXIT.
  4271
  4272     IF  (LA-RESEND-DATE = PI-6942-PRINT-DATE-BIN)
  4273         AND (LA-RESEND-DATE > LA-LAST-RESENT-PRINT-DATE)
  4274         MOVE PI-6942-PRINT-DATE-BIN
  4275                                 TO W-LAST-RESENT-PRINT-DATE
  4276         MOVE LA-RESEND-DATE     TO W-WORKING-RESEND-DATE.
  4277
  4278 4600-EXIT.
  4279      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  95
* EL6942.cbl
  4281 6000-REPRINT-CHECKS.
  4282
  4283     IF  PI-6942-LETTER-TYPE = 'I'
  4284         IF  LA-LAST-RESENT-PRINT-DATE GREATER THAN LOW-VALUES
  4285                 OR
  4286             LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
  4287             GO TO 6299-EXIT
  4288         ELSE
  4289             IF  LA-INITIAL-PRINT-DATE NOT EQUAL
  4290                     PI-6942-PRINT-DATE-BIN
  4291                 GO TO 6299-EXIT
  4292             ELSE
  4293                 NEXT SENTENCE
  4294     ELSE
  4295         IF  PI-6942-LETTER-TYPE = 'R'
  4296             IF  LA-LAST-RESENT-PRINT-DATE = LOW-VALUES
  4297                 GO TO 6299-EXIT
  4298             ELSE
  4299                 IF  LA-LAST-RESENT-PRINT-DATE NOT EQUAL
  4300                         PI-6942-PRINT-DATE-BIN
  4301                     GO TO 6299-EXIT
  4302                 ELSE
  4303                     NEXT SENTENCE
  4304         ELSE
  4305             IF  LA-LAST-RESENT-PRINT-DATE = LOW-VALUES
  4306                 IF  LA-INITIAL-PRINT-DATE EQUAL LOW-VALUES
  4307                     GO TO 6299-EXIT
  4308                 ELSE
  4309                     IF  LA-INITIAL-PRINT-DATE NOT EQUAL
  4310                             PI-6942-PRINT-DATE-BIN
  4311                         GO TO 6299-EXIT
  4312             ELSE
  4313                 IF  LA-LAST-RESENT-PRINT-DATE NOT EQUAL
  4314                         PI-6942-PRINT-DATE-BIN
  4315                     GO TO 6299-EXIT.
  4316
  4317     GO TO 6010-BY-PROCESSOR
  4318           6020-BY-LETTER
  4319           6030-BY-KEY
  4320           6040-BY-ARCHIVE
  4321           6050-BY-CONTROL-ENTRY
  4322                                 DEPENDING ON W-PROCESSING-SW.
  4323     GO TO 6299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  96
* EL6942.cbl
  4325 6010-BY-PROCESSOR.
  4326
  4327     IF  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4328         GO TO 6299-EXIT.
  4329
  4330     IF  PI-6942-LETTER-FORM GREATER THAN SPACES
  4331             AND
  4332         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  4333         GO TO 6299-EXIT.
  4334
  4335     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4336             AND
  4337         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  4338         GO TO 6299-EXIT.
  4339
  4340     IF  LA-CARRIER-A4 LESS THAN PI-6942-PRINT-CARRIER
  4341         MOVE 'Y'                TO W-ENDBR-SW
  4342         GO TO 6299-EXIT.
  4343
  4344     IF  PI-6942-PRINT-BY-CARRIER
  4345         GO TO 6010-CONTINUE.
  4346
  4347     IF  LA-GROUPING-A4 LESS THAN PI-6942-PRINT-GROUPING
  4348         MOVE 'Y'                TO W-ENDBR-SW
  4349         GO TO 6299-EXIT.
  4350
  4351     IF  PI-6942-PRINT-BY-GROUPING
  4352         GO TO 6010-CONTINUE.
  4353
  4354     IF  LA-STATE-A4 LESS THAN PI-6942-PRINT-STATE
  4355         MOVE 'Y'                TO W-ENDBR-SW
  4356         GO TO 6299-EXIT.
  4357
  4358     IF  PI-6942-PRINT-BY-STATE
  4359         GO TO 6010-CONTINUE.
  4360
  4361     IF  LA-ACCOUNT-A4 LESS THAN PI-6942-PRINT-ACCOUNT
  4362         MOVE 'Y'                TO W-ENDBR-SW
  4363         GO TO 6299-EXIT.
  4364
  4365 6010-CONTINUE.
  4366
  4367     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  4368
  4369     MOVE W-CURRENT-SAVE         TO LA-INITIAL-PRINT-DATE.
  4370     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  4371
  4372     IF  W-THIS-IS-FIRST-FORM
  4373         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4374             PI-6942-ALIGNMENT-COPIES TIMES
  4375         MOVE 'Y'                TO W-FIRST-FORM-SW.
  4376
  4377     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4378         W-COPIES TIMES.
  4379
  4380     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  4381
  4382     GO TO 6299-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  97
* EL6942.cbl
  4383
  4384 6010-EXIT.
  4385      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  98
* EL6942.cbl
  4387 6020-BY-LETTER.
  4388
  4389     IF  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4390             OR
  4391         LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4392         GO TO 6299-EXIT.
  4393
  4394     IF  NOT PI-6942-PRINT-BY-KEY
  4395         GO TO 6020-CONTINUE.
  4396
  4397     IF  LA-CARRIER-A3 LESS THAN PI-6942-PRINT-CARRIER
  4398         GO TO 6299-EXIT.
  4399
  4400     IF  LA-CARRIER-A3 LESS THAN PI-6942-PRINT-CARRIER
  4401         MOVE 'Y'                TO W-ENDBR-SW
  4402         GO TO 6299-EXIT.
  4403
  4404     IF  PI-6942-PRINT-BY-CARRIER
  4405         GO TO 6020-CONTINUE.
  4406
  4407     IF  LA-GROUPING-A3 LESS THAN PI-6942-PRINT-GROUPING
  4408         GO TO 6299-EXIT.
  4409
  4410     IF  LA-GROUPING-A3 LESS THAN PI-6942-PRINT-GROUPING
  4411         MOVE 'Y'                TO W-ENDBR-SW
  4412         GO TO 6299-EXIT.
  4413
  4414     IF  PI-6942-PRINT-BY-GROUPING
  4415         GO TO 6020-CONTINUE.
  4416
  4417     IF  LA-STATE-A3 LESS THAN PI-6942-PRINT-STATE
  4418         GO TO 6299-EXIT.
  4419
  4420     IF  LA-STATE-A3 LESS THAN PI-6942-PRINT-STATE
  4421         MOVE 'Y'                TO W-ENDBR-SW
  4422         GO TO 6299-EXIT.
  4423
  4424     IF  PI-6942-PRINT-BY-STATE
  4425         GO TO 6020-CONTINUE.
  4426
  4427     IF  LA-ACCOUNT-A3 LESS THAN PI-6942-PRINT-ACCOUNT
  4428         GO TO 6299-EXIT.
  4429
  4430     IF  LA-ACCOUNT-A3 LESS THAN PI-6942-PRINT-ACCOUNT
  4431         MOVE 'Y'                TO W-ENDBR-SW
  4432         GO TO 6299-EXIT.
  4433
  4434 6020-CONTINUE.
  4435
  4436     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  4437
  4438     MOVE W-CURRENT-SAVE         TO LA-INITIAL-PRINT-DATE.
  4439     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  4440
  4441     IF  W-THIS-IS-FIRST-FORM
  4442         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4443             PI-6942-ALIGNMENT-COPIES TIMES
  4444         MOVE 'Y'                TO W-FIRST-FORM-SW.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  99
* EL6942.cbl
  4445
  4446     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4447         W-COPIES TIMES.
  4448
  4449     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  4450
  4451     GO TO 6299-EXIT.
  4452
  4453 6020-EXIT.
  4454      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 100
* EL6942.cbl
  4456 6030-BY-KEY.
  4457
  4458     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4459             OR
  4460         LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4461             OR
  4462         LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4463         GO TO 6299-EXIT.
  4464
  4465     IF  LA-CARRIER-A5 LESS THAN PI-6942-PRINT-CARRIER
  4466         MOVE 'Y'                TO W-ENDBR-SW
  4467         GO TO 6299-EXIT.
  4468
  4469     IF  PI-6942-PRINT-BY-CARRIER
  4470         GO TO 6030-CONTINUE.
  4471
  4472     IF  LA-GROUPING-A5 LESS THAN PI-6942-PRINT-GROUPING
  4473         MOVE 'Y'                TO W-ENDBR-SW
  4474         GO TO 6299-EXIT.
  4475
  4476     IF  PI-6942-PRINT-BY-GROUPING
  4477         GO TO 6030-CONTINUE.
  4478
  4479     IF  LA-STATE-A5 LESS THAN PI-6942-PRINT-STATE
  4480         MOVE 'Y'                TO W-ENDBR-SW
  4481         GO TO 6299-EXIT.
  4482
  4483     IF  PI-6942-PRINT-BY-STATE
  4484         GO TO 6030-CONTINUE.
  4485
  4486     IF  LA-ACCOUNT-A5 LESS THAN PI-6942-PRINT-ACCOUNT
  4487         MOVE 'Y'                TO W-ENDBR-SW
  4488         GO TO 6299-EXIT.
  4489
  4490 6030-CONTINUE.
  4491
  4492     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  4493
  4494     MOVE W-CURRENT-SAVE         TO LA-INITIAL-PRINT-DATE.
  4495     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  4496
  4497     IF  W-THIS-IS-FIRST-FORM
  4498         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4499             PI-6942-ALIGNMENT-COPIES TIMES
  4500         MOVE 'Y'                TO W-FIRST-FORM-SW.
  4501
  4502     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4503         W-COPIES TIMES.
  4504
  4505     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  4506
  4507     GO TO 6299-EXIT.
  4508
  4509 6030-EXIT.
  4510      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 101
* EL6942.cbl
  4512 6040-BY-ARCHIVE.
  4513
  4514     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4515             OR
  4516         LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4517             OR
  4518         LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4519         GO TO 6299-EXIT.
  4520
  4521     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  4522
  4523     MOVE W-CURRENT-SAVE         TO LA-INITIAL-PRINT-DATE.
  4524     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  4525
  4526     IF  W-THIS-IS-FIRST-FORM
  4527         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4528             PI-6942-ALIGNMENT-COPIES TIMES
  4529         MOVE 'Y'                TO W-FIRST-FORM-SW.
  4530
  4531     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4532         W-COPIES TIMES.
  4533
  4534     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  4535
  4536     GO TO 6299-EXIT.
  4537
  4538 6040-EXIT.
  4539      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 102
* EL6942.cbl
  4541 6050-BY-CONTROL-ENTRY.
  4542
  4543     IF  PI-6942-PRINT-PROCESSOR GREATER THAN SPACES
  4544             AND
  4545         PI-6942-PRINT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  4546         GO TO 6299-EXIT.
  4547
  4548     IF  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4549             AND
  4550         PI-6942-PRINT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  4551         GO TO 6299-EXIT.
  4552
  4553     IF  PI-6942-LETTER-FORM GREATER THAN SPACES
  4554             AND
  4555         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  4556         GO TO 6299-EXIT.
  4557
  4558     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4559             AND
  4560         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  4561         GO TO 6299-EXIT.
  4562
  4563     IF  W-PROCESS-BY-KEY
  4564         GO TO 6050-CONTINUE.
  4565
  4566     IF  PI-6942-PRINT-BY-KEY
  4567         IF  PI-6942-PRINT-BY-CARRIER
  4568             IF  LA-CARRIER-A3 IS EQUAL PI-6942-PRINT-CARRIER
  4569                 NEXT SENTENCE
  4570             ELSE
  4571                 GO TO 6299-EXIT
  4572         ELSE
  4573             IF  PI-6942-PRINT-BY-GROUPING
  4574                 IF  LA-CARRIER-A3 IS EQUAL
  4575                         PI-6942-PRINT-CARRIER
  4576                         AND
  4577                     LA-GROUPING-A3 IS EQUAL
  4578                         PI-6942-PRINT-GROUPING
  4579                     NEXT SENTENCE
  4580                 ELSE
  4581                     GO TO 6299-EXIT
  4582             ELSE
  4583                 IF  PI-6942-PRINT-BY-STATE
  4584
  4585                     IF  LA-CARRIER-A3 IS EQUAL
  4586                             PI-6942-PRINT-CARRIER
  4587                             AND
  4588                         LA-GROUPING-A3 IS EQUAL
  4589                             PI-6942-PRINT-GROUPING
  4590                             AND
  4591                         LA-STATE-A3 IS EQUAL
  4592                             PI-6942-PRINT-STATE
  4593                         NEXT SENTENCE
  4594                     ELSE
  4595                         GO TO 6299-EXIT
  4596                 ELSE
  4597                     IF  PI-6942-PRINT-BY-ACCOUNT
  4598                         IF  LA-CARRIER-A3 IS EQUAL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 103
* EL6942.cbl
  4599                                 PI-6942-PRINT-CARRIER
  4600                                 AND
  4601                             LA-GROUPING-A3 IS EQUAL
  4602                                 PI-6942-PRINT-GROUPING
  4603                                 AND
  4604                             LA-STATE-A3 IS EQUAL
  4605                                 PI-6942-PRINT-STATE
  4606                                 AND
  4607                             LA-ACCOUNT-A3 IS EQUAL
  4608                                 PI-6942-PRINT-ACCOUNT
  4609                             NEXT SENTENCE
  4610                         ELSE
  4611                             GO TO 6299-EXIT.
  4612
  4613 6050-CONTINUE.
  4614
  4615     MOVE LA-NO-OF-COPIES        TO W-COPIES.
  4616
  4617     MOVE W-CURRENT-SAVE         TO LA-INITIAL-PRINT-DATE.
  4618     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  4619
  4620     IF  W-THIS-IS-FIRST-FORM
  4621         PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4622             PI-6942-ALIGNMENT-COPIES TIMES
  4623         MOVE 'Y'                TO W-FIRST-FORM-SW.
  4624
  4625     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT
  4626         W-COPIES TIMES.
  4627     PERFORM 7300-UPDATE-ARCHIVE-HEADER THRU 7399-EXIT.
  4628     GO TO 6299-EXIT.
  4629
  4630 6050-EXIT.
  4631      EXIT.
  4632
  4633 6299-EXIT.
  4634      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 104
* EL6942.cbl
  4636 6300-LABEL-CHECKS.
  4637
  4638     IF  FIRST-TIME
  4639         PERFORM 6400-ALIGNMENT-PRINT THRU 6450-EXIT.
  4640
  4641     MOVE SPACES                 TO W-LABEL-HOLD-AREA.
  4642
  4643     IF  LA-INITIAL-PRINT-DATE NOT EQUAL PI-6942-PRINT-DATE-BIN
  4644             AND
  4645         LA-LAST-RESENT-PRINT-DATE NOT EQUAL
  4646             PI-6942-PRINT-DATE-BIN
  4647         GO TO 6399-EXIT.
  4648
  4649     IF  PI-6942-LETTER-TYPE = 'I'
  4650         IF  LA-LAST-RESENT-PRINT-DATE GREATER THAN LOW-VALUES
  4651             GO TO 6399-EXIT
  4652         ELSE
  4653             IF  LA-INITIAL-PRINT-DATE NOT EQUAL
  4654                     PI-6942-PRINT-DATE-BIN
  4655                 GO TO 6399-EXIT
  4656             ELSE
  4657                 NEXT SENTENCE
  4658     ELSE
  4659         IF  PI-6942-LETTER-TYPE = 'R'
  4660             IF  LA-LAST-RESENT-PRINT-DATE = LOW-VALUES
  4661                 GO TO 6399-EXIT
  4662             ELSE
  4663                 IF  LA-LAST-RESENT-PRINT-DATE NOT EQUAL
  4664                         PI-6942-PRINT-DATE-BIN
  4665                     GO TO 6399-EXIT.
  4666
  4667     GO TO 6310-BY-PROCESSOR
  4668           6320-BY-LETTER
  4669           6330-BY-KEY
  4670           6340-BY-ARCHIVE
  4671           6350-BY-CONTROL-ENTRY
  4672                                 DEPENDING ON W-PROCESSING-SW.
  4673     GO TO 6399-EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 105
* EL6942.cbl
  4675 6310-BY-PROCESSOR.
  4676
  4677     IF  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4678         GO TO 6399-EXIT.
  4679
  4680     IF  PI-6942-LETTER-FORM GREATER THAN SPACES
  4681             AND
  4682         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  4683         GO TO 6399-EXIT.
  4684
  4685     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4686             AND
  4687         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  4688         GO TO 6399-EXIT.
  4689
  4690     IF  NOT PI-6942-PRINT-BY-KEY
  4691         GO TO 6310-CONTINUE.
  4692
  4693     IF  LA-CARRIER-A5 LESS THAN PI-6942-PRINT-CARRIER
  4694         MOVE 'Y'                TO W-ENDBR-SW
  4695         GO TO 6399-EXIT.
  4696
  4697     IF  PI-6942-PRINT-BY-CARRIER
  4698         GO TO 6310-CONTINUE.
  4699
  4700     IF  LA-GROUPING-A5 LESS THAN PI-6942-PRINT-GROUPING
  4701         MOVE 'Y'                TO W-ENDBR-SW
  4702         GO TO 6399-EXIT.
  4703
  4704     IF  PI-6942-PRINT-BY-GROUPING
  4705         GO TO 6310-CONTINUE.
  4706
  4707     IF  LA-STATE-A5 LESS THAN PI-6942-PRINT-STATE
  4708         MOVE 'Y'                TO W-ENDBR-SW
  4709         GO TO 6399-EXIT.
  4710
  4711     IF  PI-6942-PRINT-BY-STATE
  4712         GO TO 6310-CONTINUE.
  4713
  4714     IF  LA-ACCOUNT-A5 LESS THAN PI-6942-PRINT-ACCOUNT
  4715         MOVE 'Y'                TO W-ENDBR-SW
  4716         GO TO 6399-EXIT.
  4717
  4718 6310-CONTINUE.
  4719
  4720     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  4721     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT.
  4722     GO TO 6399-EXIT.
  4723
  4724 6310-EXIT.
  4725      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 106
* EL6942.cbl
  4727 6320-BY-LETTER.
  4728
  4729     IF  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4730             OR
  4731         LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4732         GO TO 6399-EXIT.
  4733
  4734     IF  NOT PI-6942-PRINT-BY-KEY
  4735         GO TO 6320-CONTINUE.
  4736
  4737     IF  LA-CARRIER-A3 LESS THAN PI-6942-PRINT-CARRIER
  4738         MOVE 'Y'                TO W-ENDBR-SW
  4739         GO TO 6399-EXIT.
  4740
  4741     IF  PI-6942-PRINT-BY-CARRIER
  4742         GO TO 6320-CONTINUE.
  4743
  4744     IF  LA-GROUPING-A3 LESS THAN PI-6942-PRINT-GROUPING
  4745         MOVE 'Y'                TO W-ENDBR-SW
  4746         GO TO 6399-EXIT.
  4747
  4748     IF  PI-6942-PRINT-BY-GROUPING
  4749         GO TO 6320-CONTINUE.
  4750
  4751     IF  LA-STATE-A3 LESS THAN PI-6942-PRINT-STATE
  4752         MOVE 'Y'                TO W-ENDBR-SW
  4753         GO TO 6399-EXIT.
  4754
  4755     IF  PI-6942-PRINT-BY-STATE
  4756         GO TO 6320-CONTINUE.
  4757
  4758     IF  LA-ACCOUNT-A3 LESS THAN PI-6942-PRINT-ACCOUNT
  4759         MOVE 'Y'                TO W-ENDBR-SW
  4760         GO TO 6399-EXIT.
  4761
  4762 6320-CONTINUE.
  4763
  4764     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  4765     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT.
  4766     GO TO 6399-EXIT.
  4767
  4768 6320-EXIT.
  4769      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 107
* EL6942.cbl
  4771 6330-BY-KEY.
  4772
  4773     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4774             OR
  4775         LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4776             OR
  4777         LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4778         GO TO 6399-EXIT.
  4779
  4780     IF  LA-CARRIER-A5 LESS THAN PI-6942-PRINT-CARRIER
  4781         MOVE 'Y'                TO W-ENDBR-SW
  4782         GO TO 6399-EXIT.
  4783
  4784     IF  PI-6942-PRINT-BY-CARRIER
  4785         GO TO 6330-CONTINUE.
  4786
  4787     IF  LA-GROUPING-A5 LESS THAN PI-6942-PRINT-GROUPING
  4788         MOVE 'Y'                TO W-ENDBR-SW
  4789         GO TO 6399-EXIT.
  4790
  4791     IF  PI-6942-PRINT-BY-GROUPING
  4792         GO TO 6330-CONTINUE.
  4793
  4794     IF  LA-STATE-A5 LESS THAN PI-6942-PRINT-STATE
  4795         MOVE 'Y'                TO W-ENDBR-SW
  4796         GO TO 6399-EXIT.
  4797
  4798     IF  PI-6942-PRINT-BY-STATE
  4799         GO TO 6330-CONTINUE.
  4800
  4801     IF  LA-ACCOUNT-A5 LESS THAN PI-6942-PRINT-ACCOUNT
  4802         MOVE 'Y'                TO W-ENDBR-SW
  4803         GO TO 6399-EXIT.
  4804
  4805 6330-CONTINUE.
  4806
  4807     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  4808     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT.
  4809     GO TO 6399-EXIT.
  4810
  4811 6330-EXIT.
  4812      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 108
* EL6942.cbl
  4814 6340-BY-ARCHIVE.
  4815
  4816     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4817             OR
  4818         LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  4819             OR
  4820         LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4821         GO TO 6399-EXIT.
  4822
  4823     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  4824     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT.
  4825     GO TO 6399-EXIT.
  4826
  4827 6340-EXIT.
  4828      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 109
* EL6942.cbl
  4830 6350-BY-CONTROL-ENTRY.
  4831
  4832     IF  PI-6942-PRINT-PROCESSOR GREATER THAN SPACES
  4833             AND
  4834         PI-6942-PRINT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  4835         GO TO 6399-EXIT.
  4836
  4837     IF  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  4838             AND
  4839         PI-6942-PRINT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  4840         GO TO 6399-EXIT.
  4841
  4842     IF  PI-6942-LETTER-FORM GREATER THAN SPACES
  4843             AND
  4844         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  4845         GO TO 6399-EXIT.
  4846
  4847     IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  4848             AND
  4849         PI-6942-LETTER-FORM NOT EQUAL LA-FORM-A3
  4850         GO TO 6399-EXIT.
  4851
  4852     IF  W-PROCESS-BY-KEY
  4853         GO TO 6350-CONTINUE.
  4854
  4855     IF  PI-6942-PRINT-BY-KEY
  4856         IF  PI-6942-PRINT-BY-CARRIER
  4857             IF  LA-CARRIER-A3 IS EQUAL PI-6942-PRINT-CARRIER
  4858                 NEXT SENTENCE
  4859             ELSE
  4860                 GO TO 6399-EXIT
  4861         ELSE
  4862             IF  PI-6942-PRINT-BY-GROUPING
  4863                 IF  LA-CARRIER-A3 IS EQUAL
  4864                         PI-6942-PRINT-CARRIER
  4865                         AND
  4866                     LA-GROUPING-A3 IS EQUAL
  4867                         PI-6942-PRINT-GROUPING
  4868                     NEXT SENTENCE
  4869                 ELSE
  4870                     GO TO 6399-EXIT
  4871             ELSE
  4872                 IF  PI-6942-PRINT-BY-STATE
  4873                     IF  LA-CARRIER-A3 IS EQUAL
  4874                             PI-6942-PRINT-CARRIER
  4875                             AND
  4876                         LA-GROUPING-A3 IS EQUAL
  4877                             PI-6942-PRINT-GROUPING
  4878                             AND
  4879                         LA-STATE-A3 IS EQUAL
  4880                             PI-6942-PRINT-STATE
  4881                         NEXT SENTENCE
  4882                     ELSE
  4883                         GO TO 6399-EXIT
  4884                 ELSE
  4885                     IF  PI-6942-PRINT-BY-ACCOUNT
  4886                         IF  LA-CARRIER-A3 IS EQUAL
  4887                                 PI-6942-PRINT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 110
* EL6942.cbl
  4888                                 AND
  4889                             LA-GROUPING-A3 IS EQUAL
  4890                                 PI-6942-PRINT-GROUPING
  4891                                 AND
  4892                             LA-STATE-A3 IS EQUAL
  4893                                 PI-6942-PRINT-STATE
  4894                                 AND
  4895                             LA-ACCOUNT-A3 IS EQUAL
  4896                                 PI-6942-PRINT-ACCOUNT
  4897                             NEXT SENTENCE
  4898                         ELSE
  4899                             GO TO 6399-EXIT.
  4900
  4901 6350-CONTINUE.
  4902
  4903     PERFORM 7100-CREATE-PRINT-TABLES THRU 7100-EXIT.
  4904     PERFORM 7200-PRINT-ARCHIVE-RECORDS THRU 7200-EXIT.
  4905     GO TO 6399-EXIT.
  4906
  4907 6350-EXIT.
  4908      EXIT.
  4909
  4910 6399-EXIT.
  4911      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 111
* EL6942.cbl
  4913 6400-ALIGNMENT-PRINT.
  4914
  4915     MOVE ALL '*'                TO W-LABEL-LINES (1)
  4916                                    W-LABEL-LINES (2)
  4917                                    W-LABEL-LINES (3).
  4918
  4919     MOVE SPACES                 TO W-LABEL-LINES (4)
  4920                                    W-LABEL-LINES (5)
  4921                                    W-LABEL-LINES (6).
  4922
  4923     IF  PI-6942-ALIGNMENT-COPIES GREATER THAN +0
  4924         PERFORM 6480-MOVE-TO-PRINT THRU 6499-EXIT
  4925             PI-6942-ALIGNMENT-COPIES TIMES
  4926     ELSE
  4927         PERFORM 6480-MOVE-TO-PRINT THRU 6499-EXIT 6 TIMES.
  4928
  4929 6450-EXIT.
  4930      EXIT.
  4931
  4932 6480-MOVE-TO-PRINT.
  4933
  4934     MOVE SPACES                 TO WS-PASSED-CNTL-CHAR.
  4935     MOVE W-LABEL-LINES (1)      TO WS-PASSED-DATA.
  4936     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  4937     MOVE W-LABEL-LINES (2)      TO WS-PASSED-DATA.
  4938     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  4939     MOVE W-LABEL-LINES (3)      TO WS-PASSED-DATA.
  4940     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  4941     MOVE W-LABEL-LINES (4)      TO WS-PASSED-DATA.
  4942     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  4943     MOVE W-LABEL-LINES (5)      TO WS-PASSED-DATA.
  4944     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  4945     MOVE W-LABEL-LINES (6)      TO WS-PASSED-DATA.
  4946     PERFORM ELPRTCVP THRU ELPRTCVP-EXIT.
  4947
  4948 6499-EXIT.
  4949      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 112
* EL6942.cbl
  4951 7100-CREATE-PRINT-TABLES.
  4952
  4953     MOVE ZEROS                  TO W-NUM-OF-TEXT-RECORDS.
  4954     MOVE LOW-VALUES             TO W-ARCT-KEY.
  4955     MOVE PI-COMPANY-CD          TO W-ARCT-COMPANY-CD.
  4956     MOVE SPACES                 TO WS-PROG-END
  4957     MOVE SPACES                 TO W-WORK-TABLE.
  4958     SET W-WK-NDX                TO W-ZEROS.
  4959     MOVE LA-ARCHIVE-NO          TO W-ARCT-NUMBER.
  4960     MOVE +1                     TO W-ARCT-SEQ.
  4961
  4962     IF  W-PRINT-LABELS
  4963         MOVE +0                 TO W-ARCT-SEQ
  4964         MOVE '1'                TO W-ARCT-REC-ID
  4965         SET W-L-NDX             TO 1
  4966     ELSE
  4967         MOVE '2'                TO W-ARCT-REC-ID.
  4968
  4969
  4970* EXEC CICS HANDLE CONDITION
  4971*         NOTFND  (7100-EXIT)
  4972*         ENDFILE (7100-EXIT)
  4973*         NOTOPEN (8890-ARCT-NOT-OPEN)
  4974*    END-EXEC.
  4975*    MOVE '"$I''J                 ! * #00004630' TO DFHEIV0
  4976     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  4977     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4978     MOVE X'2A20233030303034363330' TO DFHEIV0(25:11)
  4979     CALL 'kxdfhei1' USING DFHEIV0
  4980     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4981
  4982
  4983     IF  W-PRINT-LABELS
  4984          PERFORM 7110-READ-NEXT THRU 7110-EXIT
  4985     ELSE
  4986          ADD +1 TO W-LETTER-TOTALS
  4987          PERFORM 7110-READ-NEXT THRU 7110-EXIT
  4988            LA-NO-OF-TEXT-RECORDS TIMES.
  4989
  4990 7100-EXIT.
  4991     EXIT.
  4992
  4993 7110-READ-NEXT.
  4994
  4995
  4996* EXEC CICS READ
  4997*         DATASET (W-ARCT-ID)
  4998*         RIDFLD  (W-ARCT-KEY)
  4999*         SET     (ADDRESS OF LETTER-ARCHIVE-TEXT)
  5000*    END-EXEC.
  5001*    MOVE '&"S        E          (   #00004648' TO DFHEIV0
  5002     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5003     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  5004     MOVE X'2020233030303034363438' TO DFHEIV0(25:11)
  5005     CALL 'kxdfhei1' USING DFHEIV0,
  5006           W-ARCT-ID,
  5007           DFHEIV20,
  5008           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 113
* EL6942.cbl
  5009           W-ARCT-KEY,
  5010           DFHEIV99,
  5011           DFHEIV99,
  5012           DFHEIV99
  5013     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  5014         DFHEIV20
  5015     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5016
  5017
  5018     IF  W-PRINT-LABELS
  5019         IF (LT-LETTER-TEXT (1) EQUAL SPACES OR LOW-VALUES)  AND
  5020            (LT-LETTER-TEXT (2) EQUAL SPACES OR LOW-VALUES)  AND
  5021            (LT-LETTER-TEXT (3) EQUAL SPACES OR LOW-VALUES)  AND
  5022            (LT-LETTER-TEXT (4) EQUAL SPACES OR LOW-VALUES)  AND
  5023            (LT-LETTER-TEXT (5) EQUAL SPACES OR LOW-VALUES)  AND
  5024            (LT-LETTER-TEXT (6) EQUAL SPACES OR LOW-VALUES)
  5025             GO TO 7110-EXIT
  5026         ELSE
  5027             ADD +1 TO W-LETTER-TOTALS
  5028             MOVE LT-LETTER-TEXT (1) TO W-LABEL-LINES (1)
  5029             MOVE LT-LETTER-TEXT (2) TO W-LABEL-LINES (2)
  5030             MOVE LT-LETTER-TEXT (3) TO W-LABEL-LINES (3)
  5031             MOVE LT-LETTER-TEXT (4) TO W-LABEL-LINES (4)
  5032             MOVE LT-LETTER-TEXT (5) TO W-LABEL-LINES (5)
  5033             MOVE LT-LETTER-TEXT (6) TO W-LABEL-LINES (6)
  5034             PERFORM 6480-MOVE-TO-PRINT THRU 6499-EXIT
  5035             GO TO 7110-EXIT.
  5036
  5037     PERFORM 7120-PROCESS-RECORD THRU 7120-EXIT
  5038             VARYING
  5039         LT-NDX FROM +1 BY +1
  5040             UNTIL
  5041         LT-NDX GREATER THAN LT-NUM-LINES-ON-RECORD.
  5042
  5043     ADD +1                      TO W-ARCT-SEQ.
  5044
  5045 7110-EXIT.
  5046     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 114
* EL6942.cbl
  5048 7120-PROCESS-RECORD.
  5049
  5050     SET W-WK-NDX UP BY +1.
  5051     ADD +1                      TO W-NUM-OF-TEXT-RECORDS.
  5052     MOVE LT-LETTER-TEXT (LT-NDX)
  5053                                 TO W-WORK-LINE (W-WK-NDX).
  5054
  5055 7120-EXIT.
  5056     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 115
* EL6942.cbl
  5058 7200-PRINT-ARCHIVE-RECORDS.
  5059
  5060     PERFORM 7220-PROCESS-TABLE THRU 7220-EXIT
  5061             VARYING
  5062         W-WK-NDX FROM 1 BY 1
  5063             UNTIL
  5064         W-WK-NDX GREATER THAN W-NUM-OF-TEXT-RECORDS.
  5065
  5066 7200-EXIT.
  5067     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 116
* EL6942.cbl
  5069 7220-PROCESS-TABLE.
  5070
  5071     IF  W-SKIP-CONTROL (W-WK-NDX) GREATER THAN '00'
  5072             AND
  5073         W-SKIP-CONTROL (W-WK-NDX) LESS THAN '99'
  5074         MOVE SPACES             TO WS-PRINT-AREA
  5075         MOVE W-SKIP-CONTROL (W-WK-NDX)
  5076                                 TO W-SKIP
  5077         PERFORM ELPRTCVP THRU ELPRTCVP-EXIT W-SKIP TIMES
  5078     ELSE
  5079         IF  W-SKIP-TO-NEXT-PAGE (W-WK-NDX)
  5080             IF  W-TEXT-LINE (W-WK-NDX) EQUAL SPACES
  5081                 MOVE '1'        TO WS-PRINT-AREA
  5082             ELSE
  5083                 MOVE '1'        TO WS-PRINT-AREA
  5084                 PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  5085                 MOVE SPACES     TO WS-PRINT-AREA
  5086         ELSE
  5087             MOVE SPACES         TO WS-PRINT-AREA.
  5088     IF W-TEXT-LINE (W-WK-NDX) (1:6) = '&&&&&&'
  5089        CONTINUE
  5090     ELSE
  5091        MOVE W-TEXT-LINE (W-WK-NDX) TO W-AD-PRINT-AREA
  5092        MOVE W-ADJUST-AREA          TO WS-PASSED-DATA
  5093        PERFORM ELPRTCVP THRU ELPRTCVP-EXIT
  5094     END-IF
  5095     .
  5096 7220-EXIT.
  5097     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 117
* EL6942.cbl
  5099 7300-UPDATE-ARCHIVE-HEADER.
  5100
  5101
  5102* EXEC CICS HANDLE CONDITION
  5103*        DUPKEY (7399-EXIT)
  5104*    END-EXEC.
  5105*    MOVE '"$$                   ! + #00004737' TO DFHEIV0
  5106     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  5107     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5108     MOVE X'2B20233030303034373337' TO DFHEIV0(25:11)
  5109     CALL 'kxdfhei1' USING DFHEIV0
  5110     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5111
  5112
  5113
  5114* EXEC CICS READ
  5115*         DATASET (W-ARCH-ID)
  5116*         RIDFLD  (LA-CONTROL-PRIMARY)
  5117*         SET     (ADDRESS OF L-LETTER-ARCHIVE)
  5118*         UPDATE
  5119*    END-EXEC.
  5120*    MOVE '&"S        EU         (   #00004741' TO DFHEIV0
  5121     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  5122     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  5123     MOVE X'2020233030303034373431' TO DFHEIV0(25:11)
  5124     CALL 'kxdfhei1' USING DFHEIV0,
  5125           W-ARCH-ID,
  5126           DFHEIV20,
  5127           DFHEIV99,
  5128           LA-CONTROL-PRIMARY,
  5129           DFHEIV99,
  5130           DFHEIV99,
  5131           DFHEIV99
  5132     SET ADDRESS OF L-LETTER-ARCHIVE TO
  5133         DFHEIV20
  5134     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5135
  5136
  5137
  5138* EXEC CICS REWRITE
  5139*        DATASET (W-ARCH-ID)
  5140*        FROM    (LETTER-ARCHIVE)
  5141*    END-EXEC.
  5142     MOVE LENGTH OF
  5143      LETTER-ARCHIVE
  5144       TO DFHEIV11
  5145*    MOVE '&& L                  %   #00004748' TO DFHEIV0
  5146     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5147     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5148     MOVE X'2020233030303034373438' TO DFHEIV0(25:11)
  5149     CALL 'kxdfhei1' USING DFHEIV0,
  5150           W-ARCH-ID,
  5151           LETTER-ARCHIVE,
  5152           DFHEIV11,
  5153           DFHEIV99
  5154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5155
  5156
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 118
* EL6942.cbl
  5157 7399-EXIT.
  5158     EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 119
* EL6942.cbl
  5160 8800-ARCH4-NOT-OPEN.
  5161
  5162     MOVE 'LETTER ARCHIVE FILE NOT OPEN - ERARCH4'
  5163                                 TO W-ERROR-LINE.
  5164     PERFORM 0400-SEND-TEXT.
  5165     GO TO 0200-END-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 120
* EL6942.cbl
  5167 8810-ARCH3-NOT-OPEN.
  5168
  5169     MOVE 'LETTER ARCHIVE FILE NOT OPEN - ERARCH3'
  5170                                 TO W-ERROR-LINE.
  5171     PERFORM 0400-SEND-TEXT.
  5172     GO TO 0200-END-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 121
* EL6942.cbl
  5174 8860-ARCH5-NOT-OPEN.
  5175
  5176     MOVE 'LETTER ARCHIVE FILE NOT OPEN - ERARCH5'
  5177                                 TO W-ERROR-LINE.
  5178     PERFORM 0400-SEND-TEXT.
  5179     GO TO 0200-END-DATA.
  5180
  5181 8870-ARCH-NOT-OPEN.
  5182
  5183     MOVE 'LETTER ARCHIVE FILE NOT OPEN - ERARCH'
  5184                                 TO W-ERROR-LINE.
  5185     PERFORM 0400-SEND-TEXT.
  5186     GO TO 0200-END-DATA.
  5187
  5188 8890-ARCT-NOT-OPEN.
  5189
  5190     MOVE 'LETTER ARCHIVE TEXT FILE NOT OPEN -ERARCTT'
  5191                                 TO W-ERROR-LINE.
  5192     PERFORM 0400-SEND-TEXT.
  5193     GO TO 0200-END-DATA.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 122
* EL6942.cbl
  5195 9700-DATE-LINK.
  5196
  5197
  5198* EXEC CICS LINK
  5199*         PROGRAM  ('ELDATCV')
  5200*         COMMAREA (DATE-CONVERSION-DATA)
  5201*         LENGTH   (DC-COMM-LENGTH)
  5202*    END-EXEC.
  5203     MOVE 'ELDATCV' TO DFHEIV1
  5204*    MOVE '."C                   ''   #00004793' TO DFHEIV0
  5205     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5206     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5207     MOVE X'2020233030303034373933' TO DFHEIV0(25:11)
  5208     CALL 'kxdfhei1' USING DFHEIV0,
  5209           DFHEIV1,
  5210           DATE-CONVERSION-DATA,
  5211           DC-COMM-LENGTH,
  5212           DFHEIV99,
  5213           DFHEIV99,
  5214           DFHEIV99
  5215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5216
  5217
  5218 9700-EXIT.
  5219      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 123
* EL6942.cbl
  5221*9800-PRINT-ROUTINE.             COPY ELPRTCVP.
  5222 9800-PRINT-ROUTINE.
  5223*    COPY ELPRTCVP.
  5224******************************************************************
  5225***                                                              *
  5226***                          ELPRTCVP.                           *
  5227***                          VMOD=2.003                          *
  5228***                                                              *
  5229***     COPY MEMBER FOR TERMINAL ONLINE PRINT ROUTINE.           *
  5230***     THIS ROUTINE WILL ACCOMODATE PRINTING TO A 3270          *
  5231***     TERMINAL PRINTER. A BUFFER OF UP TO 1920 CHARACTERS      *
  5232***     IS ACCUMULATED AND PRINTED COLLECTIVELY.                 *
  5233***                                                              *
  5234***     THIS ROUTINE TO BE USED ONLY WITH ACCOMPANIMENT          *
  5235***      OF THE WORKING-STORAGE COPY MEMBER ( ELPRTCVD )         *
  5236***     THE HOST PROGRAM MUST INITIALIZE THE FOLLOWING 3 FIELDS  *
  5237***      FROM THE ABOVE COPY MEMBER FOR THIS PROCEDURE TO BE     *
  5238***      SUCCESSFUL.                                             *
  5239***      05  WS-LINE-LEN    PIC  S9(4)  COMP  VALUE +80.         *
  5240***                         LENGTH OF THE LINE TO BE PRINTED     *
  5241***                         DEFAULT IS 80, YOU CAN USE ANY NUMBER*
  5242***                         UP TO 132.  THIS FIELD IS ONLY ACCEP-*
  5243***                         TED THE FIRST TIME THRU THE ROUTINE. *
  5244***      05  WS-PROG-END    PIC  X  VALUE SPACES.                *
  5245***                         PROGRAM END SWITCH. INITIALIZED      *
  5246***                         TO SPACE-     MOVE IN ANY NONBLANK   *
  5247***                         TO IT WHEN PROGRAM IS FINISHED.      *
  5248***      05  WS-PRINT-AREA.                                      *
  5249***          10  WS-PASSED-CNTL-CHAR     PIC X.                  *
  5250***          10  WS-PASSED-DATA          PIC X(132).             *
  5251***                         USE THE DATA TO BE PRINTED IN THE    *
  5252***                         WS-PASSED-DATA.                      *
  5253***                         USE THE STANDARD CARRIAGE CONTROL    *
  5254***                         CHARACTER IN THE WS-PASSED-CNTL-CHAR *
  5255***                           SINGLE-SPACE            VALUE ' '  *
  5256***                           DOUBLE-SPACE            VALUE '0'  *
  5257***                           TRIPLE-SPACE            VALUE '-'  *
  5258***                           TOP-PAGE                VALUE '1'  *
  5259***      NOTE: A LINE COUNT IS PROVIDED IN FIELDNAME -WS-LINE-CNT*
  5260***            THE USE OF THIS FIELD IS OPTIONAL.                *
  5261***            THIS ROUTINE WILL ONLY ADD 1, 2, OR 3             *
  5262***            TO THIS COUNT DEPENDING ON THE WS-PASSED-CNTL-CHAR*
  5263***            AND RESET THE COUNT TO ZERO WHEN TOP-PAGE         *
  5264***            CONDITION.                                        *
  5265***                                                              *
  5266******************************************************************
  5267
  5268 ELPRTCVP.
  5269
  5270*    IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'CID'
  5271     IF PI-COMPANY-ID IS EQUAL TO 'DMD' OR 'XXX'
  5272         MOVE 'P'                TO DL34-PROCESS-TYPE
  5273         MOVE THIS-PGM           TO DL34-PRINT-PROGRAM-ID
  5274         MOVE PI-PROCESSOR-ID    TO DL34-USERID
  5275         MOVE PI-COMPANY-ID      TO DL34-COMPANY-ID
  5276         MOVE WS-PRINT-AREA      TO DL34-PRINT-LINE
  5277         MOVE PI-ALT-DMD-PRT-ID  TO DL34-OVERRIDE-PRINTER-ID
  5278
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 124
* EL6942.cbl
  5279
  5280* EXEC CICS LINK
  5281*            PROGRAM    ('DLO034')
  5282*            COMMAREA   (DLO034-COMMUNICATION-AREA)
  5283*            LENGTH     (DLO034-REC-LENGTH)
  5284*        END-EXEC
  5285     MOVE 'DLO034' TO DFHEIV1
  5286*    MOVE '."C                   ''   #00004860' TO DFHEIV0
  5287     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  5288     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5289     MOVE X'2020233030303034383630' TO DFHEIV0(25:11)
  5290     CALL 'kxdfhei1' USING DFHEIV0,
  5291           DFHEIV1,
  5292           DLO034-COMMUNICATION-AREA,
  5293           DLO034-REC-LENGTH,
  5294           DFHEIV99,
  5295           DFHEIV99,
  5296           DFHEIV99
  5297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5298
  5299            IF DL34-RETURN-CODE = 'OK'
  5300                GO TO ELPRTCVP-EXIT
  5301            ELSE
  5302*               MOVE '8339'     TO EMI-ERROR ?????ERROR MESSAGE???
  5303                GO TO ELPRTCVP-EXIT.
  5304
  5305     IF NOT FIRST-TIME
  5306         GO TO ELPRTCVP-020.
  5307
  5308     IF WS-LINE-LEN NOT GREATER ZERO
  5309         GO TO ELPRTCVP-EXIT.
  5310
  5311     MOVE '2'                    TO WS-FIRST-TIME-SW.
  5312     MOVE LOW-VALUES             TO WS-BUFFER-AREA.
  5313
  5314     SET BUFFER-INDEX TO +1
  5315
  5316     IF EIBTRMID IS EQUAL TO 'AFLP'
  5317         NEXT SENTENCE
  5318     ELSE
  5319         IF NOT TOP-PAGE
  5320             MOVE T-TP           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  5321             SET BUFFER-INDEX UP BY +1.
  5322
  5323 ELPRTCVP-020.
  5324     IF WS-PROG-END = SPACES
  5325         GO TO ELPRTCVP-030.
  5326
  5327     MOVE SPACES                 TO WS-PROG-END.
  5328
  5329     IF BUFFER-INDEX GREATER +1
  5330         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  5331
  5332     MOVE '1'                    TO WS-FIRST-TIME-SW.
  5333
  5334     GO TO ELPRTCVP-EXIT.
  5335
  5336 ELPRTCVP-030.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 125
* EL6942.cbl
  5337     IF WS-PASSED-DATA = SPACES
  5338         SET PRT-INDEX TO +1
  5339         GO TO ELPRTCVP-050.
  5340
  5341     SET PRT-INDEX TO WS-LINE-LEN.
  5342
  5343 ELPRTCVP-040.
  5344     IF WS-PRINT-BYTE (PRT-INDEX) NOT = SPACES
  5345         GO TO ELPRTCVP-050.
  5346
  5347     IF PRT-INDEX GREATER +1
  5348         SET PRT-INDEX DOWN BY +1
  5349         GO TO ELPRTCVP-040.
  5350
  5351 ELPRTCVP-050.
  5352     SET WS-LINE-LENGTH TO PRT-INDEX.
  5353     SET BUFFER-INDEX2 TO BUFFER-INDEX.
  5354     SET BUFFER-INDEX2 UP BY WS-LINE-LENGTH.
  5355
  5356     IF BUFFER-INDEX2 NOT LESS WS-BUFFER-SIZE
  5357         PERFORM ELPRTCVP-PRINT-BUFFER THRU ELPRTCVP-PRINT-EXIT.
  5358
  5359     IF TRIPLE-SPACE
  5360          ADD +2  TO  WS-LINE-CNT
  5361          MOVE T-SS           TO WS-BUFFER-BYTE (BUFFER-INDEX)
  5362                                 WS-BUFFER-BYTE (BUFFER-INDEX + 1)
  5363          SET BUFFER-INDEX UP BY +2.
  5364
  5365     IF DOUBLE-SPACE
  5366          ADD +1  TO  WS-LINE-CNT
  5367          MOVE T-SS             TO WS-BUFFER-BYTE (BUFFER-INDEX)
  5368          SET BUFFER-INDEX UP BY +1.
  5369
  5370     ADD +1 TO WS-LINE-CNT
  5371************************************************************
  5372*     BYPASS NEW LINE SYMBOL                               *
  5373*        IF FIRST BUFFER SENT AND TOP-OF-FORM SET.         *
  5374*     OR IF FIRST LINE OF SUBSEQUENT BUFFERS.              *
  5375************************************************************
  5376
  5377     IF (BUFFER-INDEX GREATER +1 AND
  5378         WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-TP)  OR
  5379         FIRST-LINE-NEXT-BUFFER
  5380         MOVE ZERO               TO WS-FIRST-TIME-SW
  5381     ELSE
  5382         MOVE T-SS               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  5383         SET BUFFER-INDEX UP BY +1.
  5384
  5385**   NOTE, SINGLE SPACE IS REQUIRED BEFORE TOP PAGE CHAR
  5386
  5387     IF TOP-PAGE
  5388         MOVE +1                TO WS-LINE-CNT
  5389         MOVE T-TP              TO WS-BUFFER-BYTE (BUFFER-INDEX)
  5390         SET BUFFER-INDEX UP BY +1.
  5391
  5392     SET PRT-INDEX TO +1.
  5393
  5394 ELPRTCVP-060.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 126
* EL6942.cbl
  5395     MOVE WS-PRINT-BYTE (PRT-INDEX)
  5396                                 TO WS-BUFFER-BYTE (BUFFER-INDEX).
  5397     SET BUFFER-INDEX UP BY +1.
  5398
  5399     IF PRT-INDEX LESS WS-LINE-LENGTH
  5400         SET PRT-INDEX UP BY +1
  5401         GO TO ELPRTCVP-060.
  5402
  5403 ELPRTCVP-EXIT.
  5404     EXIT.
  5405
  5406 ELPRTCVP-PRINT-BUFFER.
  5407     IF WS-BUFFER-BYTE (BUFFER-INDEX - 1) = T-SS
  5408        MOVE SPACE               TO WS-BUFFER-BYTE (BUFFER-INDEX)
  5409        SET BUFFER-INDEX UP BY 1.
  5410
  5411     MOVE  T-EM                  TO  WS-BUFFER-BYTE (BUFFER-INDEX)
  5412     SET WS-BUFFER-LENGTH TO BUFFER-INDEX.
  5413
  5414
  5415* EXEC CICS SEND
  5416*        FROM    (WS-BUFFER-AREA)
  5417*        LENGTH  (WS-BUFFER-LENGTH)
  5418*        CTLCHAR (WS-WCC-CNTL)
  5419*        ERASE
  5420*    END-EXEC.
  5421*    MOVE '$$    C E         L F ,   #00004981' TO DFHEIV0
  5422     MOVE X'242420202020432045202020' TO DFHEIV0(1:12)
  5423     MOVE X'2020202020204C2046202C20' TO DFHEIV0(13:12)
  5424     MOVE X'2020233030303034393831' TO DFHEIV0(25:11)
  5425     CALL 'kxdfhei1' USING DFHEIV0,
  5426           WS-BUFFER-AREA,
  5427           WS-BUFFER-LENGTH,
  5428           DFHEIV99,
  5429           DFHEIV99,
  5430           WS-WCC-CNTL,
  5431           DFHEIV99,
  5432           DFHEIV99,
  5433           DFHEIV99,
  5434           DFHEIV99,
  5435           DFHEIV99,
  5436           DFHEIV99
  5437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5438
  5439
  5440     SET BUFFER-INDEX TO +1.
  5441     MOVE '2'                    TO WS-FIRST-TIME-SW.
  5442
  5443 ELPRTCVP-PRINT-EXIT.
  5444     EXIT.
  5445
  5446
  5447 9999-GOBACK.
  5448
  5449
  5450* GOBACK.
  5451     MOVE '9%                    "   ' TO DFHEIV0
  5452     MOVE 'EL6942' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 127
* EL6942.cbl
  5453     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5454     GOBACK.
  5455
  5456 9999-EXIT.
  5457     EXIT.
  5458
  5459 9999-DFHBACK SECTION.
  5460     MOVE '9%                    "   ' TO DFHEIV0
  5461     MOVE 'EL6942' TO DFHEIV1
  5462     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5463     GOBACK.
  5464 9999-DFHEXIT.
  5465     IF DFHEIGDJ EQUAL 0001
  5466         NEXT SENTENCE
  5467     ELSE IF DFHEIGDJ EQUAL 2
  5468         GO TO 0200-END-DATA,
  5469               0300-NOT-FOUND
  5470         DEPENDING ON DFHEIGDI
  5471     ELSE IF DFHEIGDJ EQUAL 3
  5472         GO TO 0200-END-DATA,
  5473               0200-END-DATA
  5474         DEPENDING ON DFHEIGDI
  5475     ELSE IF DFHEIGDJ EQUAL 4
  5476         GO TO 8800-ARCH4-NOT-OPEN,
  5477               2999-EXIT,
  5478               2999-EXIT
  5479         DEPENDING ON DFHEIGDI
  5480     ELSE IF DFHEIGDJ EQUAL 5
  5481         GO TO 8810-ARCH3-NOT-OPEN,
  5482               2999-EXIT,
  5483               2999-EXIT
  5484         DEPENDING ON DFHEIGDI
  5485     ELSE IF DFHEIGDJ EQUAL 6
  5486         GO TO 8860-ARCH5-NOT-OPEN,
  5487               2999-EXIT,
  5488               2999-EXIT
  5489         DEPENDING ON DFHEIGDI
  5490     ELSE IF DFHEIGDJ EQUAL 7
  5491         GO TO 8870-ARCH-NOT-OPEN,
  5492               2999-EXIT,
  5493               2999-EXIT
  5494         DEPENDING ON DFHEIGDI
  5495     ELSE IF DFHEIGDJ EQUAL 8
  5496         GO TO 8860-ARCH5-NOT-OPEN
  5497         DEPENDING ON DFHEIGDI
  5498     ELSE IF DFHEIGDJ EQUAL 9
  5499         GO TO 2999-EXIT,
  5500               2999-EXIT
  5501         DEPENDING ON DFHEIGDI
  5502     ELSE IF DFHEIGDJ EQUAL 10
  5503         GO TO 7100-EXIT,
  5504               7100-EXIT,
  5505               8890-ARCT-NOT-OPEN
  5506         DEPENDING ON DFHEIGDI
  5507     ELSE IF DFHEIGDJ EQUAL 11
  5508         GO TO 7399-EXIT
  5509         DEPENDING ON DFHEIGDI.
  5510     MOVE '9%                    "   ' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page 128
* EL6942.cbl
  5511     MOVE 'EL6942' TO DFHEIV1
  5512     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  5513     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       28128     Code:       15064
