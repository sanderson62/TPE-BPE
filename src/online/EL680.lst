* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page   1
* EL680.cbl
* Options: int("EL680.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL680.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL680.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL680.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL680 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 04/20/94 15:21:06.
     7*                            VMOD 2.015
     8*
     9*AUTHOR.    LOGIC, INC.
    10*           DALLAS, TEXAS.
    11
    12*DATE-COMPILED.
    13
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page   2
* EL680.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    20*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    21*            *                                                   *
    22*            *****************************************************
    23
    24*REMARKS.    TRANSACTION - EXF6 - PAYMENT CALCULATIONS.
    25******************************************************************
    26*                   C H A N G E   L O G
    27*
    28* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    29*-----------------------------------------------------------------
    30*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    31* EFFECTIVE    NUMBER
    32*-----------------------------------------------------------------
    33* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    34* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    35******************************************************************
    36
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page   3
* EL680.cbl
    38 ENVIRONMENT DIVISION.
    39
    40 DATA DIVISION.
    41
    42 WORKING-STORAGE SECTION.
    43 01  DFH-START PIC X(04).
    44 77  FILLER  PIC X(32)  VALUE '********************************'.
    45 77  FILLER  PIC X(32)  VALUE '*   EL680  WORKING STORAGE     *'.
    46 77  FILLER  PIC X(32)  VALUE '************VMOD=2.015 *********'.
    47
    48 01  WS-DATE-AREA.
    49     05  SAVE-DATE           PIC X(8)    VALUE SPACES.
    50     05  SAVE-BIN-DATE       PIC XX      VALUE SPACES.
    51
    52 01  ACCESS-KEYS.
    53     12  ELCNTL-KEY.
    54         16  CNTL-COMP-ID    PIC XXX.
    55         16  CNTL-REC-TYPE   PIC X.
    56         16  CNTL-ACCESS     PIC X(4).
    57         16  CNTL-SEQ-NO     PIC S9(4)    COMP.
    58
    59 01  SPC-FLD.
    60     03  SPC-FLD-9    PIC 99.
    61
    62*********************  INPUT AREAS *******************************
    63 01  FILLER.
    64     05  WS-NAME                 PIC X(20)           VALUE SPACES.
    65     05  WS-FREQ                 PIC XX              VALUE SPACES.
    66     05  WS-BASIS-X              PIC XX              VALUE SPACES.
    67     05  WS-NPBEN                PIC X               VALUE SPACES.
    68     05  WS-BALYN                PIC X               VALUE SPACES.
    69     05  WS-OBYN                 PIC X               VALUE SPACES.
    70     05  WS-ADDCHG               PIC X               VALUE SPACES.
    71         88 NO-CHG                                   VALUE ' '.
    72         88 CHG-LF                                   VALUE '1'.
    73         88 CHG-AH                                   VALUE '2'.
    74         88 CHG-LF-AH                                VALUE '3'.
    75
    76 01  FILLER      COMP-3.
    77     05  WS-AMOUNT-REQUESTED     PIC S9(9)V99        VALUE +0.
    78     05  WS-APR                  PIC S9(6)V9(8)      VALUE +0.
    79     05  WS-NUMBER-OF-PMTS       PIC S999            VALUE +0.
    80     05  WS-ADDTL-DAYS           PIC S999            VALUE +0.
    81     05  WS-TRUNC                PIC S999            VALUE +0.
    82     05  WS-EXTRA                PIC S9              VALUE +0.
    83     05  WS-LIFE-RATE            PIC S9(6)V9(8)      VALUE +0.
    84     05  WS-LIFE-DEVIATION       PIC S9(6)V9(8)      VALUE +0.
    85     05  WS-AH-RATE              PIC S9(6)V9(8)      VALUE +0.
    86     05  WS-BL-RATE              PIC S9(6)V9(8)      VALUE +0.
    87     05  WS-AH-DEVIATION         PIC S9(6)V9(8)      VALUE +0.
    88     05  WS-PAYMENTS-COVERED     PIC S999            VALUE +0.
    89     05  WS-BALLOON-AMOUNT       PIC S9(6)V99        VALUE +0.
    90*    05  WS-REGULAR-PAYMENT      PIC S9(6)V99        VALUE +0.
    91
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page   4
* EL680.cbl
    93
    94 01  FILLER         COMP-3.
    95     05  ANGLM                   PIC S9(7)V9(11) VALUE ZERO.
    96     05  ANGLN                   PIC S9(7)V9(11) VALUE ZERO.
    97
    98     05  AHN                     PIC S999        VALUE ZERO.
    99     05  ATF                     PIC S9(7)V9(11) VALUE ZERO.
   100     05  EMII                    PIC S999        VALUE ZERO.
   101     05  OTF                     PIC S9(7)V9(11) VALUE ZERO.
   102     05  PPY                     PIC S999        VALUE ZERO.
   103
   104     05  CA                      PIC S9(7)V9(11) VALUE ZERO.
   105     05  I                       PIC S9(7)V9(11) VALUE ZERO.
   106     05  K1                      PIC S9(7)V9(11) VALUE ZERO.
   107     05  L                       PIC S9(7)V9(11) VALUE ZERO.
   108     05  L1                      PIC S9(7)V9(11) VALUE ZERO.
   109     05  M                       PIC S9(7)V9(11) VALUE ZERO.
   110     05  N                       PIC S9(5)       VALUE ZERO.
   111     05  N1                      PIC S9(7)V9(11) VALUE ZERO.
   112     05  RA                      PIC S9(7)V9(11) VALUE ZERO.
   113     05  TA                      PIC S9(7)V9(11) VALUE ZERO.
   114     05  V                       PIC S9(7)V9(11) VALUE ZERO.
   115     05  VA                      PIC S9(7)V9(11) VALUE ZERO.
   116     05  VU                      PIC S9(7)V9(11) VALUE ZERO.
   117     05  VU1                     PIC S9(7)V9(11) VALUE ZERO.
   118
   119     05  NALF                    PIC S9(7)V9(11) VALUE ZERO.
   120     05  NPLF                    PIC S9(7)V9(11) VALUE ZERO.
   121     05  PADJ                    PIC S9(7)V9(11) VALUE ZERO.
   122
   123     05  TOT-PMTS                PIC S9(7)V9(11) VALUE ZERO.
   124     05  ATOT-PMTS               PIC S9(7)V9(11) VALUE ZERO.
   125     05  ADL-DAYS                PIC S999        VALUE ZERO.
   126     05  ADL-ADJ                 PIC S9(7)V9(11) VALUE ZERO.
   127     05  COV-TERM                PIC S999        VALUE ZERO.
   128
   129     05  LIFE-RATE               PIC S9(7)V9(11) VALUE ZERO.
   130     05  LIFEDEV                 PIC S9(7)V9(11) VALUE ZERO.
   131     05  LR                      PIC S9(7)V9(11) VALUE ZERO.
   132     05  LIFE-PREM               PIC S9(7)V9(11) VALUE ZERO.
   133
   134     05  AH-RATE                 PIC S9(7)V9(11) VALUE ZERO.
   135     05  AHDEV                   PIC S9(7)V9(11) VALUE ZERO.
   136     05  AH                      PIC S9(7)V9(11) VALUE ZERO.
   137     05  AH-PREM                 PIC S9(7)V9(11) VALUE ZERO.
   138
   139     05  BL-RATE                 PIC S9(7)V9(11) VALUE ZERO.
   140     05  BL                      PIC S9(7)V9(11) VALUE ZERO.
   141
   142************ OUTPUT AREAS ******
   143     05  L-PREMIUM               PIC S9(7)V99    VALUE ZERO.
   144     05  A-PREMIUM               PIC S9(7)V99    VALUE ZERO.
   145     05  PAYMENT                 PIC S9(7)V99    VALUE ZERO.
   146     05  TOT-FIN                 PIC S9(7)V99    VALUE ZERO.
   147     05  TOT-PAYMT               PIC S9(7)V99    VALUE ZERO.
   148     05  TOT-INTRS               PIC S9(7)V99    VALUE ZERO.
   149
   150 01  FILLER         COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page   5
* EL680.cbl
   151     05  V-NTH                   PIC S9(7)V9(11) VALUE ZERO.
   152     05  B                       PIC S9(7)V9(11) VALUE ZERO.
   153     05  ANGLN-LESS-1            PIC S9(7)V9(11) VALUE ZERO.
   154     05  NM1                     PIC S9(7)V9(11) VALUE ZERO.
   155     05  AEQ                     PIC S9(7)V9(11) VALUE ZERO.
   156     05  MPT                     PIC S9(7)V9(11) VALUE ZERO.
   157     05  MPB                     PIC S9(7)V9(11) VALUE ZERO.
   158     05  MP                      PIC S9(7)V9(11) VALUE ZERO.
   159     05  IA                      PIC S9(7)V9(11) VALUE ZERO.
   160
   161 01  FILLER.
   162     05  XREPT                       PIC S999    COMP.
   163     05  WS-ERROR-COUNT              PIC S999        VALUE ZERO.
   164     05  WS-MESSAGE                  PIC X(79).
   165     05  WS-BASIS                    PIC S99         VALUE ZERO.
   166     05  WS-TIME-WORK                PIC S9(7)    VALUE ZERO.
   167     05  WS-TIME                     REDEFINES
   168         WS-TIME-WORK                PIC S999V9(4).
   169
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page   6
* EL680.cbl
   171 01  ERROR-MESSAGES.
   172     12  ER-0004                 PIC X(4)  VALUE '0004'.
   173     12  ER-0008                 PIC X(4)  VALUE '0008'.
   174     12  ER-0029                 PIC X(4)  VALUE '0029'.
   175     12  ER-0042                 PIC X(4)  VALUE '0042'.
   176     12  ER-0190                 PIC X(4)  VALUE '0190'.
   177     12  ER-0412                 PIC X(4)  VALUE '0412'.
   178     12  ER-0413                 PIC X(4)  VALUE '0413'.
   179     12  ER-2361                 PIC X(4)  VALUE '2361'.
   180     12  ER-2363                 PIC X(4)  VALUE '2363'.
   181     12  ER-2364                 PIC X(4)  VALUE '2364'.
   182     12  ER-2365                 PIC X(4)  VALUE '2365'.
   183     12  ER-2366                 PIC X(4)  VALUE '2366'.
   184     12  ER-2367                 PIC X(4)  VALUE '2367'.
   185     12  ER-2920                 PIC X(4)  VALUE '2920'.
   186     12  ER-2921                 PIC X(4)  VALUE '2921'.
   187     12  ER-2922                 PIC X(4)  VALUE '2922'.
   188     12  ER-2923                 PIC X(4)  VALUE '2923'.
   189     12  ER-2924                 PIC X(4)  VALUE '2924'.
   190     12  ER-2925                 PIC X(4)  VALUE '2925'.
   191     12  ER-2926                 PIC X(4)  VALUE '2926'.
   192     12  ER-2927                 PIC X(4)  VALUE '2927'.
   193     12  ER-4004                 PIC X(4)  VALUE '4004'.
   194     12  ER-4007                 PIC X(4)  VALUE '4007'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page   7
* EL680.cbl
   196 01  STANDARD-AREAS.
   197     12  MAPSET-NAME         PIC X(8)    VALUE 'EL680S'.
   198     12  MAP-NAME            PIC X(8)    VALUE 'EL680A'.
   199     12  SCREEN-NUMBER       PIC X(4)    VALUE '680A'.
   200     12  TRANS-ID            PIC X(4)    VALUE 'EXF6'.
   201     12  START-TRANS-ID      PIC X(4)    VALUE 'EXF7'.
   202     12  THIS-PGM            PIC X(8)    VALUE 'EL680'.
   203     12  PGM-NAME            PIC X(8).
   204     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   205     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   206     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   207     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   208     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   209
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page   8
* EL680.cbl
   211*                            COPY EL680S.
   212 01  EL680AI.
   213     05  FILLER            PIC  X(0012).
   214*    -------------------------------
   215     05  ADATEL PIC S9(0004) COMP.
   216     05  ADATEF PIC  X(0001).
   217     05  FILLER REDEFINES ADATEF.
   218         10  ADATEA PIC  X(0001).
   219     05  ADATEI PIC  X(0008).
   220*    -------------------------------
   221     05  ATIMEL PIC S9(0004) COMP.
   222     05  ATIMEF PIC  X(0001).
   223     05  FILLER REDEFINES ATIMEF.
   224         10  ATIMEA PIC  X(0001).
   225     05  ATIMEI PIC  X(0005).
   226*    -------------------------------
   227     05  ACOMPIDL PIC S9(0004) COMP.
   228     05  ACOMPIDF PIC  X(0001).
   229     05  FILLER REDEFINES ACOMPIDF.
   230         10  ACOMPIDA PIC  X(0001).
   231     05  ACOMPIDI PIC  X(0003).
   232*    -------------------------------
   233     05  ANAMEL PIC S9(0004) COMP.
   234     05  ANAMEF PIC  X(0001).
   235     05  FILLER REDEFINES ANAMEF.
   236         10  ANAMEA PIC  X(0001).
   237     05  ANAMEI PIC  X(0020).
   238*    -------------------------------
   239     05  AAMOUNTL PIC S9(0004) COMP.
   240     05  AAMOUNTF PIC  X(0001).
   241     05  FILLER REDEFINES AAMOUNTF.
   242         10  AAMOUNTA PIC  X(0001).
   243     05  AAMOUNTI PIC  9(10)V99.
   244*    -------------------------------
   245     05  AINTRATL PIC S9(0004) COMP.
   246     05  AINTRATF PIC  X(0001).
   247     05  FILLER REDEFINES AINTRATF.
   248         10  AINTRATA PIC  X(0001).
   249     05  AINTRATI PIC  9(4)V9(4).
   250*    -------------------------------
   251     05  AFREQL PIC S9(0004) COMP.
   252     05  AFREQF PIC  X(0001).
   253     05  FILLER REDEFINES AFREQF.
   254         10  AFREQA PIC  X(0001).
   255     05  AFREQI PIC  X(0002).
   256*    -------------------------------
   257     05  BAMOUNTL PIC S9(0004) COMP.
   258     05  BAMOUNTF PIC  X(0001).
   259     05  FILLER REDEFINES BAMOUNTF.
   260         10  BAMOUNTA PIC  X(0001).
   261     05  BAMOUNTI PIC  X(0011).
   262*    -------------------------------
   263     05  ANOPMTSL PIC S9(0004) COMP.
   264     05  ANOPMTSF PIC  X(0001).
   265     05  FILLER REDEFINES ANOPMTSF.
   266         10  ANOPMTSA PIC  X(0001).
   267     05  ANOPMTSI PIC  999.
   268*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page   9
* EL680.cbl
   269     05  BLAMTL PIC S9(0004) COMP.
   270     05  BLAMTF PIC  X(0001).
   271     05  FILLER REDEFINES BLAMTF.
   272         10  BLAMTA PIC  X(0001).
   273     05  BLAMTI PIC  X(0011).
   274*    -------------------------------
   275     05  AADDAYSL PIC S9(0004) COMP.
   276     05  AADDAYSF PIC  X(0001).
   277     05  FILLER REDEFINES AADDAYSF.
   278         10  AADDAYSA PIC  X(0001).
   279     05  AADDAYSI PIC  999.
   280*    -------------------------------
   281     05  ADDCHGL PIC S9(0004) COMP.
   282     05  ADDCHGF PIC  X(0001).
   283     05  FILLER REDEFINES ADDCHGF.
   284         10  ADDCHGA PIC  X(0001).
   285     05  ADDCHGI PIC  X(0001).
   286*    -------------------------------
   287     05  BDAMTL PIC S9(0004) COMP.
   288     05  BDAMTF PIC  X(0001).
   289     05  FILLER REDEFINES BDAMTF.
   290         10  BDAMTA PIC  X(0001).
   291     05  BDAMTI PIC  X(0011).
   292*    -------------------------------
   293     05  ABASISL PIC S9(0004) COMP.
   294     05  ABASISF PIC  X(0001).
   295     05  FILLER REDEFINES ABASISF.
   296         10  ABASISA PIC  X(0001).
   297     05  ABASISI PIC  X(0002).
   298*    -------------------------------
   299     05  BMOPMTL PIC S9(0004) COMP.
   300     05  BMOPMTF PIC  X(0001).
   301     05  FILLER REDEFINES BMOPMTF.
   302         10  BMOPMTA PIC  X(0001).
   303     05  BMOPMTI PIC  X(0011).
   304*    -------------------------------
   305     05  OBYORNL PIC S9(0004) COMP.
   306     05  OBYORNF PIC  X(0001).
   307     05  FILLER REDEFINES OBYORNF.
   308         10  OBYORNA PIC  X(0001).
   309     05  OBYORNI PIC  X(0001).
   310*    -------------------------------
   311     05  BALPMTL PIC S9(0004) COMP.
   312     05  BALPMTF PIC  X(0001).
   313     05  FILLER REDEFINES BALPMTF.
   314         10  BALPMTA PIC  X(0001).
   315     05  BALPMTI PIC  X(0011).
   316*    -------------------------------
   317     05  ANPREML PIC S9(0004) COMP.
   318     05  ANPREMF PIC  X(0001).
   319     05  FILLER REDEFINES ANPREMF.
   320         10  ANPREMA PIC  X(0001).
   321     05  ANPREMI PIC  X(0001).
   322*    -------------------------------
   323     05  BTOTPMTL PIC S9(0004) COMP.
   324     05  BTOTPMTF PIC  X(0001).
   325     05  FILLER REDEFINES BTOTPMTF.
   326         10  BTOTPMTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  10
* EL680.cbl
   327     05  BTOTPMTI PIC  X(0011).
   328*    -------------------------------
   329     05  ATRUNCL PIC S9(0004) COMP.
   330     05  ATRUNCF PIC  X(0001).
   331     05  FILLER REDEFINES ATRUNCF.
   332         10  ATRUNCA PIC  X(0001).
   333     05  ATRUNCI PIC  999.
   334*    -------------------------------
   335     05  BTOTINTL PIC S9(0004) COMP.
   336     05  BTOTINTF PIC  X(0001).
   337     05  FILLER REDEFINES BTOTINTF.
   338         10  BTOTINTA PIC  X(0001).
   339     05  BTOTINTI PIC  X(0011).
   340*    -------------------------------
   341     05  AEXTRAL PIC S9(0004) COMP.
   342     05  AEXTRAF PIC  X(0001).
   343     05  FILLER REDEFINES AEXTRAF.
   344         10  AEXTRAA PIC  X(0001).
   345     05  AEXTRAI PIC  9.
   346*    -------------------------------
   347     05  ALRATEL PIC S9(0004) COMP.
   348     05  ALRATEF PIC  X(0001).
   349     05  FILLER REDEFINES ALRATEF.
   350         10  ALRATEA PIC  X(0001).
   351     05  ALRATEI PIC  9(4)V9(4).
   352*    -------------------------------
   353     05  ALFDEVL PIC S9(0004) COMP.
   354     05  ALFDEVF PIC  X(0001).
   355     05  FILLER REDEFINES ALFDEVF.
   356         10  ALFDEVA PIC  X(0001).
   357     05  ALFDEVI PIC  9(4)V999.
   358*    -------------------------------
   359     05  ADRATEL PIC S9(0004) COMP.
   360     05  ADRATEF PIC  X(0001).
   361     05  FILLER REDEFINES ADRATEF.
   362         10  ADRATEA PIC  X(0001).
   363     05  ADRATEI PIC  9(4)V9(4).
   364*    -------------------------------
   365     05  AAHDEVL PIC S9(0004) COMP.
   366     05  AAHDEVF PIC  X(0001).
   367     05  FILLER REDEFINES AAHDEVF.
   368         10  AAHDEVA PIC  X(0001).
   369     05  AAHDEVI PIC  9(4)V999.
   370*    -------------------------------
   371     05  ANOTLFL PIC S9(0004) COMP.
   372     05  ANOTLFF PIC  X(0001).
   373     05  FILLER REDEFINES ANOTLFF.
   374         10  ANOTLFA PIC  X(0001).
   375     05  ANOTLFI PIC  999.
   376*    -------------------------------
   377     05  BALAMTL PIC S9(0004) COMP.
   378     05  BALAMTF PIC  X(0001).
   379     05  FILLER REDEFINES BALAMTF.
   380         10  BALAMTA PIC  X(0001).
   381     05  BALAMTI PIC  9(10)V99.
   382*    -------------------------------
   383     05  BALRL PIC S9(0004) COMP.
   384     05  BALRF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  11
* EL680.cbl
   385     05  FILLER REDEFINES BALRF.
   386         10  BALRA PIC  X(0001).
   387     05  BALRI PIC  X(0036).
   388*    -------------------------------
   389     05  BLRATEL PIC S9(0004) COMP.
   390     05  BLRATEF PIC  X(0001).
   391     05  FILLER REDEFINES BLRATEF.
   392         10  BLRATEA PIC  X(0001).
   393     05  BLRATEI PIC  9(4)V9(4).
   394*    -------------------------------
   395     05  BALYNL PIC S9(0004) COMP.
   396     05  BALYNF PIC  X(0001).
   397     05  FILLER REDEFINES BALYNF.
   398         10  BALYNA PIC  X(0001).
   399     05  BALYNI PIC  X(0001).
   400*    -------------------------------
   401     05  ERRMSG1L PIC S9(0004) COMP.
   402     05  ERRMSG1F PIC  X(0001).
   403     05  FILLER REDEFINES ERRMSG1F.
   404         10  ERRMSG1A PIC  X(0001).
   405     05  ERRMSG1I PIC  X(0079).
   406*    -------------------------------
   407     05  PFENTERL PIC S9(0004) COMP.
   408     05  PFENTERF PIC  X(0001).
   409     05  FILLER REDEFINES PFENTERF.
   410         10  PFENTERA PIC  X(0001).
   411     05  PFENTERI PIC  99.
   412 01  EL680AO REDEFINES EL680AI.
   413     05  FILLER            PIC  X(0012).
   414*    -------------------------------
   415     05  FILLER            PIC  X(0003).
   416     05  ADATEO PIC  X(0008).
   417*    -------------------------------
   418     05  FILLER            PIC  X(0003).
   419     05  ATIMEO PIC  99.99.
   420*    -------------------------------
   421     05  FILLER            PIC  X(0003).
   422     05  ACOMPIDO PIC  X(0003).
   423*    -------------------------------
   424     05  FILLER            PIC  X(0003).
   425     05  ANAMEO PIC  X(0020).
   426*    -------------------------------
   427     05  FILLER            PIC  X(0003).
   428     05  AAMOUNTO PIC  Z,ZZZ,ZZ9.99.
   429*    -------------------------------
   430     05  FILLER            PIC  X(0003).
   431     05  AINTRATO PIC  ZZ9.9(4).
   432*    -------------------------------
   433     05  FILLER            PIC  X(0003).
   434     05  AFREQO PIC  X(0002).
   435*    -------------------------------
   436     05  FILLER            PIC  X(0003).
   437     05  BAMOUNTO PIC  ZZZ,ZZ9.99-.
   438*    -------------------------------
   439     05  FILLER            PIC  X(0003).
   440     05  ANOPMTSO PIC  ZZ9.
   441*    -------------------------------
   442     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  12
* EL680.cbl
   443     05  BLAMTO PIC  ZZZ,ZZ9.99-.
   444*    -------------------------------
   445     05  FILLER            PIC  X(0003).
   446     05  AADDAYSO PIC  ZZ9.
   447*    -------------------------------
   448     05  FILLER            PIC  X(0003).
   449     05  ADDCHGO PIC  X(0001).
   450*    -------------------------------
   451     05  FILLER            PIC  X(0003).
   452     05  BDAMTO PIC  ZZZ,ZZ9.99-.
   453*    -------------------------------
   454     05  FILLER            PIC  X(0003).
   455     05  ABASISO PIC  X(0002).
   456*    -------------------------------
   457     05  FILLER            PIC  X(0003).
   458     05  BMOPMTO PIC  ZZZ,ZZ9.99-.
   459*    -------------------------------
   460     05  FILLER            PIC  X(0003).
   461     05  OBYORNO PIC  X(0001).
   462*    -------------------------------
   463     05  FILLER            PIC  X(0003).
   464     05  BALPMTO PIC  ZZZ,ZZ9.99-.
   465*    -------------------------------
   466     05  FILLER            PIC  X(0003).
   467     05  ANPREMO PIC  X(0001).
   468*    -------------------------------
   469     05  FILLER            PIC  X(0003).
   470     05  BTOTPMTO PIC  ZZZ,ZZ9.99-.
   471*    -------------------------------
   472     05  FILLER            PIC  X(0003).
   473     05  ATRUNCO PIC  ZZ9.
   474*    -------------------------------
   475     05  FILLER            PIC  X(0003).
   476     05  BTOTINTO PIC  ZZZ,ZZ9.99-.
   477*    -------------------------------
   478     05  FILLER            PIC  X(0003).
   479     05  AEXTRAO PIC  9.
   480*    -------------------------------
   481     05  FILLER            PIC  X(0003).
   482     05  ALRATEO PIC  ZZ9.9(4).
   483*    -------------------------------
   484     05  FILLER            PIC  X(0003).
   485     05  ALFDEVO PIC  ZZ9.999.
   486*    -------------------------------
   487     05  FILLER            PIC  X(0003).
   488     05  ADRATEO PIC  ZZ9.9(4).
   489*    -------------------------------
   490     05  FILLER            PIC  X(0003).
   491     05  AAHDEVO PIC  ZZ9.999.
   492*    -------------------------------
   493     05  FILLER            PIC  X(0003).
   494     05  ANOTLFO PIC  ZZ9.
   495*    -------------------------------
   496     05  FILLER            PIC  X(0003).
   497     05  BALAMTO PIC  Z,ZZZ,ZZ9.99.
   498*    -------------------------------
   499     05  FILLER            PIC  X(0003).
   500     05  BALRO PIC  X(0036).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  13
* EL680.cbl
   501*    -------------------------------
   502     05  FILLER            PIC  X(0003).
   503     05  BLRATEO PIC  ZZ9.9(4).
   504*    -------------------------------
   505     05  FILLER            PIC  X(0003).
   506     05  BALYNO PIC  X(0001).
   507*    -------------------------------
   508     05  FILLER            PIC  X(0003).
   509     05  ERRMSG1O PIC  X(0079).
   510*    -------------------------------
   511     05  FILLER            PIC  X(0003).
   512     05  PFENTERO PIC  Z9.
   513*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  14
* EL680.cbl
   515*                            COPY ELCLOGOF.
   516******************************************************************
   517*                                                                *
   518*                                                                *
   519*                            ELCLOGOF.                           *
   520*                            VMOD=2.001                          *
   521*                                                                *
   522*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   523*                                                                *
   524******************************************************************
   525 01  CLASIC-LOGOFF.
   526     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   527     12  LOGOFF-TEXT.
   528         16  FILLER          PIC X(5)    VALUE SPACES.
   529         16  LOGOFF-MSG.
   530             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   531             20  FILLER      PIC X       VALUE SPACES.
   532             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   533         16  FILLER          PIC X(80)
   534           VALUE '* YOU ARE NOW LOGGED OFF'.
   535         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   536         16  FILLER          PIC X       VALUE QUOTE.
   537         16  LOGOFF-SYS-MSG  PIC X(17)
   538           VALUE 'S CLAS-IC SYSTEM '.
   539     12  TEXT-MESSAGES.
   540         16  UNACCESS-MSG    PIC X(29)
   541             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   542         16  PGMIDERR-MSG    PIC X(17)
   543             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  15
* EL680.cbl
   545*                            COPY ELCDATE.
   546******************************************************************
   547*                                                                *
   548*                                                                *
   549*                            ELCDATE.                            *
   550*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   551*                            VMOD=2.003
   552*                                                                *
   553*                                                                *
   554*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   555*                 LENGTH = 200                                   *
   556******************************************************************
   557
   558 01  DATE-CONVERSION-DATA.
   559     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   560     12  DC-OPTION-CODE                PIC X.
   561         88  BIN-TO-GREG                VALUE ' '.
   562         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   563         88  EDIT-GREG-TO-BIN           VALUE '2'.
   564         88  YMD-GREG-TO-BIN            VALUE '3'.
   565         88  MDY-GREG-TO-BIN            VALUE '4'.
   566         88  JULIAN-TO-BIN              VALUE '5'.
   567         88  BIN-PLUS-ELAPSED           VALUE '6'.
   568         88  FIND-CENTURY               VALUE '7'.
   569         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   570         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   571         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   572         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   573         88  JULIAN-TO-BIN-3            VALUE 'C'.
   574         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   575         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   576         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   577         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   578         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   579         88  CHECK-LEAP-YEAR            VALUE 'H'.
   580         88  BIN-3-TO-GREG              VALUE 'I'.
   581         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   582         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   583         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   584         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   585         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   586         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   587         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   588         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   589         88  THREE-CHARACTER-BIN
   590                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   591         88  GREGORIAN-TO-BIN
   592                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   593         88  BIN-TO-GREGORIAN
   594                  VALUES ' ' '1' 'I' '8' 'G'.
   595         88  JULIAN-TO-BINARY
   596                  VALUES '5' 'C' 'E' 'F'.
   597     12  DC-ERROR-CODE                 PIC X.
   598         88  NO-CONVERSION-ERROR        VALUE ' '.
   599         88  DATE-CONVERSION-ERROR
   600                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   601         88  DATE-IS-ZERO               VALUE '1'.
   602         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  16
* EL680.cbl
   603         88  DATE-IS-INVALID            VALUE '3'.
   604         88  DATE1-GREATER-DATE2        VALUE '4'.
   605         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   606         88  DATE-INVALID-OPTION        VALUE '9'.
   607         88  INVALID-CENTURY            VALUE 'A'.
   608         88  ONLY-CENTURY               VALUE 'B'.
   609         88  ONLY-LEAP-YEAR             VALUE 'C'.
   610         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   611     12  DC-END-OF-MONTH               PIC X.
   612         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   613     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   614         88  USE-NORMAL-PROCESS         VALUE ' '.
   615         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   616         88  ADJUST-UP-100-YRS          VALUE '2'.
   617     12  FILLER                        PIC X.
   618     12  DC-CONVERSION-DATES.
   619         16  DC-BIN-DATE-1             PIC XX.
   620         16  DC-BIN-DATE-2             PIC XX.
   621         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   622         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   623                       DC-GREG-DATE-1-EDIT.
   624             20  DC-EDIT1-MONTH        PIC 99.
   625             20  SLASH1-1              PIC X.
   626             20  DC-EDIT1-DAY          PIC 99.
   627             20  SLASH1-2              PIC X.
   628             20  DC-EDIT1-YEAR         PIC 99.
   629         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   630         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   631                     DC-GREG-DATE-2-EDIT.
   632             20  DC-EDIT2-MONTH        PIC 99.
   633             20  SLASH2-1              PIC X.
   634             20  DC-EDIT2-DAY          PIC 99.
   635             20  SLASH2-2              PIC X.
   636             20  DC-EDIT2-YEAR         PIC 99.
   637         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   638         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   639                     DC-GREG-DATE-1-YMD.
   640             20  DC-YMD-YEAR           PIC 99.
   641             20  DC-YMD-MONTH          PIC 99.
   642             20  DC-YMD-DAY            PIC 99.
   643         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   644         16  DC-GREG-DATE-1-MDY-R REDEFINES
   645                      DC-GREG-DATE-1-MDY.
   646             20  DC-MDY-MONTH          PIC 99.
   647             20  DC-MDY-DAY            PIC 99.
   648             20  DC-MDY-YEAR           PIC 99.
   649         16  DC-GREG-DATE-1-ALPHA.
   650             20  DC-ALPHA-MONTH        PIC X(10).
   651             20  DC-ALPHA-DAY          PIC 99.
   652             20  FILLER                PIC XX.
   653             20  DC-ALPHA-CENTURY.
   654                 24 DC-ALPHA-CEN-N     PIC 99.
   655             20  DC-ALPHA-YEAR         PIC 99.
   656         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   657         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   658         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   659         16  DC-JULIAN-DATE            PIC 9(05).
   660         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  17
* EL680.cbl
   661                                       PIC 9(05).
   662         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   663             20  DC-JULIAN-YEAR        PIC 99.
   664             20  DC-JULIAN-DAYS        PIC 999.
   665         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   666         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   667         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   668     12  DATE-CONVERSION-VARIBLES.
   669         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   670         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   671             20  FILLER                PIC 9(3).
   672             20  HOLD-CEN-1-CCYY.
   673                 24  HOLD-CEN-1-CC     PIC 99.
   674                 24  HOLD-CEN-1-YY     PIC 99.
   675             20  HOLD-CEN-1-MO         PIC 99.
   676             20  HOLD-CEN-1-DA         PIC 99.
   677         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   678             20  HOLD-CEN-1-R-MO       PIC 99.
   679             20  HOLD-CEN-1-R-DA       PIC 99.
   680             20  HOLD-CEN-1-R-CCYY.
   681                 24  HOLD-CEN-1-R-CC   PIC 99.
   682                 24  HOLD-CEN-1-R-YY   PIC 99.
   683             20  FILLER                PIC 9(3).
   684         16  HOLD-CENTURY-1-X.
   685             20  FILLER                PIC X(3)  VALUE SPACES.
   686             20  HOLD-CEN-1-X-CCYY.
   687                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   688                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   689             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   690             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   691         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   692             20  HOLD-CEN-1-R-X-MO     PIC XX.
   693             20  HOLD-CEN-1-R-X-DA     PIC XX.
   694             20  HOLD-CEN-1-R-X-CCYY.
   695                 24  HOLD-CEN-1-R-X-CC PIC XX.
   696                 24  HOLD-CEN-1-R-X-YY PIC XX.
   697             20  FILLER                PIC XXX.
   698         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   699         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   700         16  DC-JULIAN-DATE-1          PIC 9(07).
   701         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   702             20  DC-JULIAN-1-CCYY.
   703                 24  DC-JULIAN-1-CC    PIC 99.
   704                 24  DC-JULIAN-1-YR    PIC 99.
   705             20  DC-JULIAN-DA-1        PIC 999.
   706         16  DC-JULIAN-DATE-2          PIC 9(07).
   707         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   708             20  DC-JULIAN-2-CCYY.
   709                 24  DC-JULIAN-2-CC    PIC 99.
   710                 24  DC-JULIAN-2-YR    PIC 99.
   711             20  DC-JULIAN-DA-2        PIC 999.
   712         16  DC-GREG-DATE-A-EDIT.
   713             20  DC-EDITA-MONTH        PIC 99.
   714             20  SLASHA-1              PIC X VALUE '/'.
   715             20  DC-EDITA-DAY          PIC 99.
   716             20  SLASHA-2              PIC X VALUE '/'.
   717             20  DC-EDITA-CCYY.
   718                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  18
* EL680.cbl
   719                 24  DC-EDITA-YEAR     PIC 99.
   720         16  DC-GREG-DATE-B-EDIT.
   721             20  DC-EDITB-MONTH        PIC 99.
   722             20  SLASHB-1              PIC X VALUE '/'.
   723             20  DC-EDITB-DAY          PIC 99.
   724             20  SLASHB-2              PIC X VALUE '/'.
   725             20  DC-EDITB-CCYY.
   726                 24  DC-EDITB-CENT     PIC 99.
   727                 24  DC-EDITB-YEAR     PIC 99.
   728         16  DC-GREG-DATE-CYMD         PIC 9(08).
   729         16  DC-GREG-DATE-CYMD-R REDEFINES
   730                              DC-GREG-DATE-CYMD.
   731             20  DC-CYMD-CEN           PIC 99.
   732             20  DC-CYMD-YEAR          PIC 99.
   733             20  DC-CYMD-MONTH         PIC 99.
   734             20  DC-CYMD-DAY           PIC 99.
   735         16  DC-GREG-DATE-MDCY         PIC 9(08).
   736         16  DC-GREG-DATE-MDCY-R REDEFINES
   737                              DC-GREG-DATE-MDCY.
   738             20  DC-MDCY-MONTH         PIC 99.
   739             20  DC-MDCY-DAY           PIC 99.
   740             20  DC-MDCY-CEN           PIC 99.
   741             20  DC-MDCY-YEAR          PIC 99.
   742    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   743        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   744    12  DC-EL310-DATE                  PIC X(21).
   745    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  19
* EL680.cbl
   747*                            COPY ELCATTR.
   748******************************************************************
   749*                                                                *
   750*                            ELCATTR.                            *
   751*                            VMOD=2.001                          *
   752*                                                                *
   753*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   754*                                                                *
   755*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   756*                                                                *
   757*                   POS 1   P=PROTECTED                          *
   758*                           U=UNPROTECTED                        *
   759*                           S=ASKIP                              *
   760*                   POS 2   A=ALPHA/NUMERIC                      *
   761*                           N=NUMERIC                            *
   762*                   POS 3   N=NORMAL                             *
   763*                           B=BRIGHT                             *
   764*                           D=DARK                               *
   765*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   766*                           OF=MODIFIED DATA TAG OFF             *
   767*                                                                *
   768*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   769******************************************************************
   770 01  ATTRIBUTE-LIST.
   771     12  AL-PABOF            PIC X       VALUE 'Y'.
   772     12  AL-PABON            PIC X       VALUE 'Z'.
   773     12  AL-PADOF            PIC X       VALUE '%'.
   774     12  AL-PADON            PIC X       VALUE '_'.
   775     12  AL-PANOF            PIC X       VALUE '-'.
   776     12  AL-PANON            PIC X       VALUE '/'.
   777     12  AL-SABOF            PIC X       VALUE '8'.
   778     12  AL-SABON            PIC X       VALUE '9'.
   779     12  AL-SADOF            PIC X       VALUE '@'.
   780     12  AL-SADON            PIC X       VALUE QUOTE.
   781     12  AL-SANOF            PIC X       VALUE '0'.
   782     12  AL-SANON            PIC X       VALUE '1'.
   783     12  AL-UABOF            PIC X       VALUE 'H'.
   784     12  AL-UABON            PIC X       VALUE 'I'.
   785     12  AL-UADOF            PIC X       VALUE '<'.
   786     12  AL-UADON            PIC X       VALUE '('.
   787     12  AL-UANOF            PIC X       VALUE ' '.
   788     12  AL-UANON            PIC X       VALUE 'A'.
   789     12  AL-UNBOF            PIC X       VALUE 'Q'.
   790     12  AL-UNBON            PIC X       VALUE 'R'.
   791     12  AL-UNDOF            PIC X       VALUE '*'.
   792     12  AL-UNDON            PIC X       VALUE ')'.
   793     12  AL-UNNOF            PIC X       VALUE '&'.
   794     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  20
* EL680.cbl
   796*                            COPY ELCAID.
   797******************************************************************
   798*                                                                *
   799*                            ELCAID.                             *
   800*                            VMOD=2.001                          *
   801*                                                                *
   802*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   803*                                                                *
   804*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   805*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   806******************************************************************
   807
   808 01  DFHAID.
   809   02  DFHNULL   PIC  X  VALUE  ' '.
   810   02  DFHENTER  PIC  X  VALUE  QUOTE.
   811   02  DFHCLEAR  PIC  X  VALUE  '_'.
   812   02  DFHPEN    PIC  X  VALUE  '='.
   813   02  DFHOPID   PIC  X  VALUE  'W'.
   814   02  DFHPA1    PIC  X  VALUE  '%'.
   815   02  DFHPA2    PIC  X  VALUE  '>'.
   816   02  DFHPA3    PIC  X  VALUE  ','.
   817   02  DFHPF1    PIC  X  VALUE  '1'.
   818   02  DFHPF2    PIC  X  VALUE  '2'.
   819   02  DFHPF3    PIC  X  VALUE  '3'.
   820   02  DFHPF4    PIC  X  VALUE  '4'.
   821   02  DFHPF5    PIC  X  VALUE  '5'.
   822   02  DFHPF6    PIC  X  VALUE  '6'.
   823   02  DFHPF7    PIC  X  VALUE  '7'.
   824   02  DFHPF8    PIC  X  VALUE  '8'.
   825   02  DFHPF9    PIC  X  VALUE  '9'.
   826   02  DFHPF10   PIC  X  VALUE  ':'.
   827   02  DFHPF11   PIC  X  VALUE  '#'.
   828   02  DFHPF12   PIC  X  VALUE  '@'.
   829   02  DFHPF13   PIC  X  VALUE  'A'.
   830   02  DFHPF14   PIC  X  VALUE  'B'.
   831   02  DFHPF15   PIC  X  VALUE  'C'.
   832   02  DFHPF16   PIC  X  VALUE  'D'.
   833   02  DFHPF17   PIC  X  VALUE  'E'.
   834   02  DFHPF18   PIC  X  VALUE  'F'.
   835   02  DFHPF19   PIC  X  VALUE  'G'.
   836   02  DFHPF20   PIC  X  VALUE  'H'.
   837   02  DFHPF21   PIC  X  VALUE  'I'.
   838*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   839   02  DFHPF22   PIC  X  VALUE  '['.
   840   02  DFHPF23   PIC  X  VALUE  '.'.
   841   02  DFHPF24   PIC  X  VALUE  '<'.
   842   02  DFHMSRE   PIC  X  VALUE  'X'.
   843   02  DFHSTRF   PIC  X  VALUE  'h'.
   844   02  DFHTRIG   PIC  X  VALUE  '"'.
   845 01  FILLER    REDEFINES DFHAID.
   846     12  FILLER              PIC X(8).
   847     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  21
* EL680.cbl
   849*                            COPY ELCEMIB.
   850******************************************************************
   851*                                                                *
   852*                                                                *
   853*                            ELCEMIB.                            *
   854*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   855*                            VMOD=2.005                          *
   856*                                                                *
   857*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   858*                                                                *
   859******************************************************************
   860 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   861     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   862     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   863     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   864     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   865     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   866     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   867     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   868     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   869     12  EMI-SWITCH1             PIC X        VALUE '1'.
   870         88  EMI-NO-ERRORS                    VALUE '1'.
   871         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   872         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   873     12  EMI-SWITCH2             PIC X        VALUE '1'.
   874         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   875     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   876         88  EMI-AREA1-EMPTY                  VALUE '1'.
   877         88  EMI-AREA1-FULL                   VALUE '2'.
   878     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   879         88  EMI-AREA2-EMPTY                  VALUE '1'.
   880         88  EMI-AREA2-FULL                   VALUE '2'.
   881     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   882         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   883         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   884         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   885         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   886         88  EMI-BYPASS-FATALS                VALUE 'X'.
   887     12  EMI-ERROR-LINES.
   888         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   889         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   890         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   891         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   892             20  EMI-ERR-CODES OCCURS 10 TIMES.
   893                 24  EMI-ERR-NUM         PIC X(4).
   894                 24  EMI-FILLER          PIC X.
   895                 24  EMI-SEV             PIC X.
   896                 24  FILLER              PIC X.
   897             20  FILLER                  PIC X(02).
   898     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   899         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   900             20  EMI-ERROR-NUMBER    PIC X(4).
   901             20  EMI-FILL            PIC X.
   902             20  EMI-SEVERITY        PIC X.
   903             20  FILLER              PIC X.
   904             20  EMI-ERROR-TEXT.
   905                 24  EMI-TEXT-VARIABLE   PIC X(10).
   906                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  22
* EL680.cbl
   907     12  EMI-SEVERITY-SAVE           PIC X.
   908         88  EMI-NOTE                    VALUE 'N'.
   909         88  EMI-WARNING                 VALUE 'W'.
   910         88  EMI-FORCABLE                VALUE 'F'.
   911         88  EMI-FATAL                   VALUE 'X'.
   912     12  EMI-MESSAGE-FLAG            PIC X.
   913         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   914         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   915     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   916     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   917         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   918         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   919         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   920     12  emi-claim-no                pic x(7).
   921     12  emi-claim-type              pic x(6).
   922     12  FILLER                      PIC X(124)  VALUE SPACES.
   923     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   924     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   925     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   926     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  23
* EL680.cbl
   928*                            COPY ELCINTF.
   929******************************************************************
   930*                                                                *
   931*                                                                *
   932*                            ELCINTF.                            *
   933*                            VMOD=2.017                          *
   934*                                                                *
   935*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   936*                                                                *
   937*       LENGTH = 1024                                            *
   938*                                                                *
   939******************************************************************
   940*                   C H A N G E   L O G
   941*
   942* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   943*-----------------------------------------------------------------
   944*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   945* EFFECTIVE    NUMBER
   946*-----------------------------------------------------------------
   947* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   948******************************************************************
   949 01  PROGRAM-INTERFACE-BLOCK.
   950     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   951     12  PI-CALLING-PROGRAM              PIC X(8).
   952     12  PI-SAVED-PROGRAM-1              PIC X(8).
   953     12  PI-SAVED-PROGRAM-2              PIC X(8).
   954     12  PI-SAVED-PROGRAM-3              PIC X(8).
   955     12  PI-SAVED-PROGRAM-4              PIC X(8).
   956     12  PI-SAVED-PROGRAM-5              PIC X(8).
   957     12  PI-SAVED-PROGRAM-6              PIC X(8).
   958     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   959     12  PI-COMPANY-ID                   PIC XXX.
   960     12  PI-COMPANY-CD                   PIC X.
   961
   962     12  PI-COMPANY-PASSWORD             PIC X(8).
   963
   964     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   965
   966     12  PI-CONTROL-IN-PROGRESS.
   967         16  PI-CARRIER                  PIC X.
   968         16  PI-GROUPING                 PIC X(6).
   969         16  PI-STATE                    PIC XX.
   970         16  PI-ACCOUNT                  PIC X(10).
   971         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   972                                         PIC X(10).
   973         16  PI-CLAIM-CERT-GRP.
   974             20  PI-CLAIM-NO             PIC X(7).
   975             20  PI-CERT-NO.
   976                 25  PI-CERT-PRIME       PIC X(10).
   977                 25  PI-CERT-SFX         PIC X.
   978             20  PI-CERT-EFF-DT          PIC XX.
   979         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   980             20  PI-PLAN-CODE            PIC X(2).
   981             20  PI-REVISION-NUMBER      PIC X(3).
   982             20  PI-PLAN-EFF-DT          PIC X(2).
   983             20  PI-PLAN-EXP-DT          PIC X(2).
   984             20  FILLER                  PIC X(11).
   985         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  24
* EL680.cbl
   986             20  PI-OE-REFERENCE-1.
   987                 25  PI-OE-REF-1-PRIME   PIC X(18).
   988                 25  PI-OE-REF-1-SUFF    PIC XX.
   989
   990     12  PI-SESSION-IN-PROGRESS          PIC X.
   991         88  CLAIM-SESSION                   VALUE '1'.
   992         88  CREDIT-SESSION                  VALUE '2'.
   993         88  WARRANTY-SESSION                VALUE '3'.
   994         88  MORTGAGE-SESSION                VALUE '4'.
   995         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   996
   997
   998*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   999
  1000     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1001     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1002
  1003     12  PI-CREDIT-USER                  PIC X.
  1004         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1005         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1006
  1007     12  PI-CLAIM-USER                   PIC X.
  1008         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1009         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1010
  1011     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1012         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1013         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1014         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1015         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1016         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1017
  1018     12  PI-PROCESSOR-ID                 PIC X(4).
  1019
  1020     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1021
  1022     12  PI-MEMBER-CAPTION               PIC X(10).
  1023
  1024     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1025         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1026
  1027     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1028     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1029     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1030     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1031
  1032     12  PI-AH-OVERRIDE-L1               PIC X.
  1033     12  PI-AH-OVERRIDE-L2               PIC XX.
  1034     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1035     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1036
  1037     12  PI-NEW-SYSTEM                   PIC X(2).
  1038
  1039     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1040     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1041         88  PI-USES-PAID-TO                 VALUE '1'.
  1042     12  PI-CRDTCRD-SYSTEM.
  1043         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  25
* EL680.cbl
  1044             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1045             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1046         16  PI-CC-MONTH-END-DT          PIC XX.
  1047     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1048
  1049     12  PI-OE-REFERENCE-2.
  1050         16  PI-OE-REF-2-PRIME           PIC X(10).
  1051         16  PI-OE-REF-2-SUFF            PIC X.
  1052
  1053     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1054
  1055     12  PI-LANGUAGE-TYPE                PIC X.
  1056             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1057             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1058             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1059
  1060     12  PI-POLICY-LINKAGE-IND           PIC X.
  1061         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1062         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1063                                                   LOW-VALUES.
  1064
  1065     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1066     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1067         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1068         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1069
  1070     12  PI-PROCESSOR-CSR-IND            PIC X.
  1071         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1072         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1073
  1074     12  FILLER                          PIC X(3).
  1075
  1076     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1077
  1078     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1079         PI-SYSTEM-LEVEL.
  1080
  1081         16  PI-ENTRY-CODES.
  1082             20  PI-ENTRY-CD-1           PIC X.
  1083             20  PI-ENTRY-CD-2           PIC X.
  1084
  1085         16  PI-RETURN-CODES.
  1086             20  PI-RETURN-CD-1          PIC X.
  1087             20  PI-RETURN-CD-2          PIC X.
  1088
  1089         16  PI-UPDATE-STATUS-SAVE.
  1090             20  PI-UPDATE-BY            PIC X(4).
  1091             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1092
  1093         16  PI-LOWER-CASE-LETTERS       PIC X.
  1094             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1095
  1096*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1097*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1098*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1099
  1100         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1101             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  26
* EL680.cbl
  1102             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1103             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1104             88  ACCNT-CNTL                  VALUE '3'.
  1105             88  CARR-ACCNT-CNTL             VALUE '4'.
  1106
  1107         16  PI-PROCESSOR-CAP-LIST.
  1108             20  PI-SYSTEM-CONTROLS.
  1109                24 PI-SYSTEM-DISPLAY     PIC X.
  1110                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1111                24 PI-SYSTEM-MODIFY      PIC X.
  1112                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1113             20  FILLER                  PIC XX.
  1114             20  PI-DISPLAY-CAP          PIC X.
  1115                 88  DISPLAY-CAP             VALUE 'Y'.
  1116             20  PI-MODIFY-CAP           PIC X.
  1117                 88  MODIFY-CAP              VALUE 'Y'.
  1118             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1119                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1120             20  PI-FORCE-CAP            PIC X.
  1121                 88  FORCE-CAP               VALUE 'Y'.
  1122
  1123         16  PI-PROGRAM-CONTROLS.
  1124             20  PI-PGM-PRINT-OPT        PIC X.
  1125             20  PI-PGM-FORMAT-OPT       PIC X.
  1126             20  PI-PGM-PROCESS-OPT      PIC X.
  1127             20  PI-PGM-TOTALS-OPT       PIC X.
  1128
  1129         16  PI-HELP-INTERFACE.
  1130             20  PI-LAST-ERROR-NO        PIC X(4).
  1131             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1132
  1133         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1134             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1135
  1136         16  PI-CR-CONTROL-IN-PROGRESS.
  1137             20  PI-CR-CARRIER           PIC X.
  1138             20  PI-CR-GROUPING          PIC X(6).
  1139             20  PI-CR-STATE             PIC XX.
  1140             20  PI-CR-ACCOUNT           PIC X(10).
  1141             20  PI-CR-FIN-RESP          PIC X(10).
  1142             20  PI-CR-TYPE              PIC X.
  1143
  1144         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1145
  1146         16  PI-CR-MONTH-END-DT          PIC XX.
  1147
  1148         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1149             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1150             88  PI-ZERO-CARRIER             VALUE '1'.
  1151             88  PI-ZERO-GROUPING            VALUE '2'.
  1152             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1153
  1154         16  PI-CARRIER-SECURITY         PIC X.
  1155             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1156
  1157         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1158             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1159             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  27
* EL680.cbl
  1160
  1161         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1162             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1163                                         INDEXED BY PI-ACCESS-NDX
  1164                                         PIC X.
  1165
  1166         16  PI-GA-BILLING-CONTROL       PIC X.
  1167             88  PI-GA-BILLING               VALUE '1'.
  1168
  1169         16  PI-MAIL-PROCESSING          PIC X.
  1170             88  PI-MAIL-YES                 VALUE 'Y'.
  1171
  1172         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1173
  1174         16  PI-AR-SYSTEM.
  1175             20  PI-AR-PROCESSING-CNTL   PIC X.
  1176                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1177             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1178             20  PI-AR-MONTH-END-DT      PIC XX.
  1179
  1180         16  PI-MP-SYSTEM.
  1181             20  PI-MORTGAGE-USER            PIC X.
  1182                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1183                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1184             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1185                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1186                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1187                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1188                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1189                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1190             20  PI-MP-MONTH-END-DT          PIC XX.
  1191             20  PI-MP-REFERENCE-NO.
  1192                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1193                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1194
  1195         16  PI-LABEL-CONTROL            PIC X(01).
  1196             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1197             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1198
  1199         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1200             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1201
  1202         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1203             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1204             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1205
  1206         16  FILLER                      PIC X(14).
  1207
  1208     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1209******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  28
* EL680.cbl
  1211****************************************************************
  1212*
  1213* Copyright (c) 2007-2013 Dell Inc.
  1214* All rights reserved.
  1215*
  1216****************************************************************
  1217 01  DFHEIV.
  1218   02  DFHEIV0               PIC X(35).
  1219   02  DFHEIV1               PIC X(08).
  1220   02  DFHEIV2               PIC X(08).
  1221   02  DFHEIV3               PIC X(08).
  1222   02  DFHEIV4               PIC X(06).
  1223   02  DFHEIV5               PIC X(04).
  1224   02  DFHEIV6               PIC X(04).
  1225   02  DFHEIV7               PIC X(02).
  1226   02  DFHEIV8               PIC X(02).
  1227   02  DFHEIV9               PIC X(01).
  1228   02  DFHEIV10              PIC S9(7) COMP-3.
  1229   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1230   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1231   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1232   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1233   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1234   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1235   02  DFHEIV17              PIC X(04).
  1236   02  DFHEIV18              PIC X(04).
  1237   02  DFHEIV19              PIC X(04).
  1238   02  DFHEIV20              USAGE IS POINTER.
  1239   02  DFHEIV21              USAGE IS POINTER.
  1240   02  DFHEIV22              USAGE IS POINTER.
  1241   02  DFHEIV23              USAGE IS POINTER.
  1242   02  DFHEIV24              USAGE IS POINTER.
  1243   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1244   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1245   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1246   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1247   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1248   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1249   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1250   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1251   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1252   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1253   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1254   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1255   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1256   02  FILLER                PIC X(02).
  1257   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1258   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1259   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1260   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1261   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1262   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1263   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1264 LINKAGE  SECTION.
  1265*****************************************************************
  1266*                                                               *
  1267* Copyright (c) 2007-2013 Dell Inc.                             *
  1268* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  29
* EL680.cbl
  1269*                                                               *
  1270*****************************************************************
  1271 01  dfheiblk.
  1272     02  eibtime          pic s9(7) comp-3.
  1273     02  eibdate          pic s9(7) comp-3.
  1274     02  eibtrnid         pic x(4).
  1275     02  eibtaskn         pic s9(7) comp-3.
  1276     02  eibtrmid         pic x(4).
  1277     02  dfheigdi         pic s9(4) comp.
  1278     02  eibcposn         pic s9(4) comp.
  1279     02  eibcalen         pic s9(4) comp.
  1280     02  eibaid           pic x(1).
  1281     02  eibfiller1       pic x(1).
  1282     02  eibfn            pic x(2).
  1283     02  eibfiller2       pic x(2).
  1284     02  eibrcode         pic x(6).
  1285     02  eibfiller3       pic x(2).
  1286     02  eibds            pic x(8).
  1287     02  eibreqid         pic x(8).
  1288     02  eibrsrce         pic x(8).
  1289     02  eibsync          pic x(1).
  1290     02  eibfree          pic x(1).
  1291     02  eibrecv          pic x(1).
  1292     02  eibsend          pic x(1).
  1293     02  eibatt           pic x(1).
  1294     02  eibeoc           pic x(1).
  1295     02  eibfmh           pic x(1).
  1296     02  eibcompl         pic x(1).
  1297     02  eibsig           pic x(1).
  1298     02  eibconf          pic x(1).
  1299     02  eiberr           pic x(1).
  1300     02  eibrldbk         pic x(1).
  1301     02  eiberrcd         pic x(4).
  1302     02  eibsynrb         pic x(1).
  1303     02  eibnodat         pic x(1).
  1304     02  eibfiller5       pic x(2).
  1305     02  eibresp          pic s9(8) comp.
  1306     02  eibresp2         pic s9(8) comp.
  1307     02  dfheigdj         pic s9(4) comp.
  1308     02  dfheigdk         pic s9(4) comp.
  1309 01  DFHCOMMAREA         PIC X(1024).
  1310*01 PARMLIST   COMP.
  1311*    02  FILLER          PIC S9(8).
  1312*    02  ELCNTL-POINTER  PIC S9(8).
  1313
  1314*                             COPY ELCCNTL.
  1315******************************************************************
  1316*                                                                *
  1317*                                                                *
  1318*                            ELCCNTL.                            *
  1319*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1320*                            VMOD=2.059                          *
  1321*                                                                *
  1322*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  1323*                                                                *
  1324*   FILE TYPE = VSAM,KSDS                                        *
  1325*   RECORD SIZE = 750  RECFORM = FIXED                           *
  1326*                                                                *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  30
* EL680.cbl
  1327*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  1328*       ALTERNATE INDEX = NONE                                   *
  1329*                                                                *
  1330*   LOG = YES                                                    *
  1331*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1332******************************************************************
  1333*                   C H A N G E   L O G
  1334*
  1335* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1336*-----------------------------------------------------------------
  1337*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1338* EFFECTIVE    NUMBER
  1339*-----------------------------------------------------------------
  1340* 082503                   PEMA  ADD BENEFIT GROUP
  1341* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  1342* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  1343* 092705    2005050300006  PEMA  ADD SPP LEASES
  1344* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  1345* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  1346* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  1347* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  1348* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  1349* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1350* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  1351* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  1352* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  1353* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1354* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  1355******************************************************************
  1356*
  1357 01  CONTROL-FILE.
  1358     12  CF-RECORD-ID                       PIC XX.
  1359         88  VALID-CF-ID                        VALUE 'CF'.
  1360
  1361     12  CF-CONTROL-PRIMARY.
  1362         16  CF-COMPANY-ID                  PIC XXX.
  1363         16  CF-RECORD-TYPE                 PIC X.
  1364             88  CF-COMPANY-MASTER              VALUE '1'.
  1365             88  CF-PROCESSOR-MASTER            VALUE '2'.
  1366             88  CF-STATE-MASTER                VALUE '3'.
  1367             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  1368             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  1369             88  CF-CARRIER-MASTER              VALUE '6'.
  1370             88  CF-MORTALITY-MASTER            VALUE '7'.
  1371             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  1372             88  CF-TERMINAL-MASTER             VALUE '9'.
  1373             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  1374             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  1375             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  1376             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  1377             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  1378             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  1379             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  1380             88  CF-REMINDERS-MASTER            VALUE 'R'.
  1381             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  1382         16  CF-ACCESS-CD-GENL              PIC X(4).
  1383         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  1384             20  CF-PROCESSOR               PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  31
* EL680.cbl
  1385         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  1386             20  CF-STATE-CODE              PIC XX.
  1387             20  FILLER                     PIC XX.
  1388         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  1389             20  FILLER                     PIC XX.
  1390             20  CF-HI-BEN-IN-REC           PIC XX.
  1391         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  1392             20  FILLER                     PIC XXX.
  1393             20  CF-CARRIER-CNTL            PIC X.
  1394         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  1395             20  FILLER                     PIC XX.
  1396             20  CF-HI-TYPE-IN-REC          PIC 99.
  1397         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  1398             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  1399                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  1400             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  1401             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  1402         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  1403             20  FILLER                     PIC X.
  1404             20  CF-CUSTOM-REPORT-NO        PIC 999.
  1405         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  1406             20  FILLER                     PIC XX.
  1407             20  CF-MORTGAGE-PLAN           PIC XX.
  1408         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  1409
  1410     12  CF-LAST-MAINT-DT                   PIC XX.
  1411     12  CF-LAST-MAINT-BY                   PIC X(4).
  1412     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  1413
  1414     12  CF-RECORD-BODY                     PIC X(728).
  1415
  1416
  1417****************************************************************
  1418*             COMPANY MASTER RECORD                            *
  1419****************************************************************
  1420
  1421     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1422         16  CF-COMPANY-ADDRESS.
  1423             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  1424             20  CF-CL-IN-CARE-OF           PIC X(30).
  1425             20  CF-CL-ADDR-LINE-1          PIC X(30).
  1426             20  CF-CL-ADDR-LINE-2          PIC X(30).
  1427             20  CF-CL-CITY-STATE           PIC X(30).
  1428             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  1429             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  1430         16  CF-COMPANY-CD                  PIC X.
  1431         16  CF-COMPANY-PASSWORD            PIC X(8).
  1432         16  CF-SECURITY-OPTION             PIC X.
  1433             88  ALL-SECURITY                   VALUE '1'.
  1434             88  COMPANY-VERIFY                 VALUE '2'.
  1435             88  PROCESSOR-VERIFY               VALUE '3'.
  1436             88  NO-SECURITY                    VALUE '4'.
  1437             88  ALL-BUT-TERM                   VALUE '5'.
  1438         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  1439             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  1440         16  CF-LGX-INTERFACE-CNTL          PIC X.
  1441             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  1442         16  CF-INFORCE-LOCATION            PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  32
* EL680.cbl
  1443             88  CERTS-ARE-ONLINE               VALUE '1'.
  1444             88  CERTS-ARE-OFFLINE              VALUE '2'.
  1445             88  NO-CERTS-AVAILABLE             VALUE '3'.
  1446         16  CF-LOWER-CASE-LETTERS          PIC X.
  1447         16  CF-CERT-ACCESS-CONTROL         PIC X.
  1448             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  1449             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1450             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  1451             88  CF-ACCNT-CNTL                  VALUE '3'.
  1452             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  1453
  1454         16  CF-FORMS-PRINTER-ID            PIC X(4).
  1455         16  CF-CHECK-PRINTER-ID            PIC X(4).
  1456
  1457         16  CF-LGX-CREDIT-USER             PIC X.
  1458             88  CO-IS-NOT-USER                 VALUE 'N'.
  1459             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  1460
  1461         16 CF-CREDIT-CALC-CODES.
  1462             20  CF-CR-REM-TERM-CALC PIC X.
  1463               88  CR-EARN-AFTER-15TH           VALUE '1'.
  1464               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  1465               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  1466               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  1467               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  1468               88  CR-EARN-AFTER-14TH           VALUE '6'.
  1469               88  CR-EARN-AFTER-16TH           VALUE '7'.
  1470             20  CF-CR-R78-METHOD           PIC X.
  1471               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  1472               88  DONT-USE-PLUS-ONE            VALUE '1'.
  1473
  1474         16  CF-CLAIM-CONTROL-COUNTS.
  1475             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  1476                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  1477
  1478             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  1479                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  1480
  1481             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  1482                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  1483
  1484             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  1485                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  1486
  1487         16  CF-CURRENT-MONTH-END           PIC XX.
  1488
  1489         16  CF-CO-CALC-QUOTE-TOLERANCE.
  1490             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  1491             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  1492             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  1493             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  1494                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1495                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1496             20  CF-CO-PREM-REJECT-SW       PIC X.
  1497                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  1498                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  1499             20  CF-CO-REF-REJECT-SW        PIC X.
  1500                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  33
* EL680.cbl
  1501                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  1502
  1503         16  CF-CO-REPORTING-DT             PIC XX.
  1504         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  1505         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  1506           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  1507           88  CF-CO-MONTH-END                  VALUE '1'.
  1508
  1509         16  CF-LGX-CLAIM-USER              PIC X.
  1510             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  1511             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  1512
  1513         16  CF-CREDIT-EDIT-CONTROLS.
  1514             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  1515             20  CF-MIN-AGE                 PIC 99.
  1516             20  CF-DEFAULT-AGE             PIC 99.
  1517             20  CF-MIN-TERM                PIC S999      COMP-3.
  1518             20  CF-MAX-TERM                PIC S999      COMP-3.
  1519             20  CF-DEFAULT-SEX             PIC X.
  1520             20  CF-JOINT-AGE-INPUT         PIC X.
  1521                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  1522             20  CF-BIRTH-DATE-INPUT        PIC X.
  1523                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  1524             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  1525                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  1526                 88  CF-ZERO-CARRIER            VALUE '1'.
  1527                 88  CF-ZERO-GROUPING           VALUE '2'.
  1528                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  1529             20  CF-EDIT-SW                 PIC X.
  1530                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  1531             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  1532             20  CF-CR-PR-METHOD            PIC X.
  1533               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  1534               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  1535             20  FILLER                     PIC X.
  1536
  1537         16  CF-CREDIT-MISC-CONTROLS.
  1538             20  CF-REIN-TABLE-SW           PIC X.
  1539                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  1540             20  CF-COMP-TABLE-SW           PIC X.
  1541                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  1542             20  CF-EXPERIENCE-RETENTION-AGE
  1543                                            PIC S9        COMP-3.
  1544             20  CF-CONVERSION-DT           PIC XX.
  1545             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  1546             20  CF-RUN-FREQUENCY-SW        PIC X.
  1547                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  1548                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  1549
  1550             20  CF-CR-CHECK-NO-CONTROL.
  1551                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  1552                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  1553                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  1554                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  1555                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  1556                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  1557
  1558                 24  CF-CR-CHECK-COUNT       REDEFINES
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  34
* EL680.cbl
  1559                     CF-CR-CHECK-COUNTER      PIC X(4).
  1560
  1561                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  1562                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  1563
  1564                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  1565                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  1566                 24  CF-MAIL-PROCESSING       PIC X.
  1567                     88  MAIL-PROCESSING          VALUE 'Y'.
  1568
  1569         16  CF-MISC-SYSTEM-CONTROL.
  1570             20  CF-SYSTEM-C                 PIC X.
  1571                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  1572             20  CF-SYSTEM-D                 PIC X.
  1573                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  1574             20  CF-SOC-SEC-NO-SW            PIC X.
  1575                 88  SOC-SEC-NO-USED             VALUE '1'.
  1576             20  CF-MEMBER-NO-SW             PIC X.
  1577                 88  MEMBER-NO-USED              VALUE '1'.
  1578             20  CF-TAX-ID-NUMBER            PIC X(11).
  1579             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  1580             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  1581                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  1582                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  1583                 88  CF-ALL-APPROVED             VALUE 'Y'.
  1584                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  1585             20  CF-SYSTEM-E                 PIC X.
  1586                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  1587
  1588         16  CF-LGX-LIFE-USER               PIC X.
  1589             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  1590             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  1591
  1592         16  CF-CR-MONTH-END-DT             PIC XX.
  1593
  1594         16  CF-FILE-MAINT-DATES.
  1595             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  1596                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  1597             20  CF-LAST-BATCH       REDEFINES
  1598                 CF-LAST-BATCH-NO               PIC X(4).
  1599             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  1600             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  1601             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  1602             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  1603             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  1604             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  1605             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  1606             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  1607             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  1608             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  1609
  1610         16  CF-NEXT-COMPANY-ID             PIC XXX.
  1611         16  FILLER                         PIC X.
  1612
  1613         16  CF-ALT-MORT-CODE               PIC X(4).
  1614         16  CF-MEMBER-CAPTION              PIC X(10).
  1615
  1616         16  CF-LIFE-ACCESS-CONTROL         PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  35
* EL680.cbl
  1617             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  1618             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  1619             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  1620             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  1621             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  1622
  1623         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  1624
  1625         16  CF-LIFE-OVERRIDE-L1            PIC X.
  1626         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  1627         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  1628         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  1629
  1630         16  CF-AH-OVERRIDE-L1              PIC X.
  1631         16  CF-AH-OVERRIDE-L2              PIC XX.
  1632         16  CF-AH-OVERRIDE-L6              PIC X(6).
  1633         16  CF-AH-OVERRIDE-L12             PIC X(12).
  1634
  1635         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  1636         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  1637
  1638         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  1639         16  CF-AR-LAST-EL860-DT            PIC XX.
  1640         16  CF-MP-MONTH-END-DT             PIC XX.
  1641
  1642         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  1643         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  1644             88  CF-CLAIM-PAID-TO               VALUE '1'.
  1645
  1646         16  CF-AR-MONTH-END-DT             PIC XX.
  1647
  1648         16  CF-CRDTCRD-USER                PIC X.
  1649             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  1650             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  1651
  1652         16  CF-CC-MONTH-END-DT             PIC XX.
  1653
  1654         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  1655
  1656         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  1657             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  1658             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  1659             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  1660         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  1661         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  1662         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  1663         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  1664             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  1665             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  1666         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  1667         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  1668         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  1669             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  1670         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  1671
  1672         16  CF-CL-ZIP-CODE.
  1673             20  CF-CL-ZIP-PRIME.
  1674                 24  CF-CL-ZIP-1ST          PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  36
* EL680.cbl
  1675                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  1676                 24  FILLER                 PIC X(4).
  1677             20  CF-CL-ZIP-PLUS4            PIC X(4).
  1678         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  1679             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  1680             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  1681             20  FILLER                     PIC XXX.
  1682
  1683         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  1684         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  1685         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  1686         16  CF-CO-OPTION-START-DATE        PIC XX.
  1687         16  CF-REM-TRM-CALC-OPTION         PIC X.
  1688           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  1689                                                      '3' '4'.
  1690           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  1691           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  1692           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  1693           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  1694           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  1695           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  1696
  1697         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  1698
  1699         16  CF-PAYMENT-APPROVAL-LEVELS.
  1700             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  1701             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  1702             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  1703             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  1704             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  1705             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  1706
  1707         16  CF-END-USER-REPORTING-USER     PIC X.
  1708             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  1709             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  1710
  1711         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  1712             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  1713             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  1714
  1715         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  1716
  1717         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  1718         16  FILLER                         PIC X.
  1719
  1720         16  CF-CREDIT-ARCHIVE-CNTL.
  1721             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  1722             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  1723             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  1724
  1725         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  1726
  1727         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  1728             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  1729             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  1730
  1731         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  1732             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  37
* EL680.cbl
  1733             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  1734
  1735         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  1736
  1737         16  CF-CO-ACH-ID-CODE              PIC  X.
  1738             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  1739             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  1740             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  1741         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  1742         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  1743         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  1744         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  1745         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  1746         16  CF-CO-ACH-RECV-NO              PIC X(08).
  1747         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  1748         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  1749         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  1750                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  1751         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  1752                 CF-CO-ACH-TRACE-NO         PIC X(4).
  1753
  1754         16  CF-CO-OVER-SHORT.
  1755             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  1756             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  1757
  1758*         16  FILLER                         PIC X(102).
  1759         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  1760             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  1761             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  1762
  1763         16  CF-AH-APPROVAL-DAYS.
  1764             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  1765             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  1766             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  1767             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  1768
  1769         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  1770
  1771         16  CF-APPROV-LEV-5.
  1772             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  1773             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  1774             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  1775
  1776         16  FILLER                         PIC X(68).
  1777****************************************************************
  1778*             PROCESSOR/USER RECORD                            *
  1779****************************************************************
  1780
  1781     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1782         16  CF-PROCESSOR-NAME              PIC X(30).
  1783         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  1784         16  CF-PROCESSOR-TITLE             PIC X(26).
  1785         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  1786                 88  MESSAGE-YES                VALUE 'Y'.
  1787                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  1788
  1789*****************************************************
  1790****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  38
* EL680.cbl
  1791****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  1792****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  1793****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  1794*****************************************************
  1795
  1796         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  1797             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  1798             20  CF-APPLICATION-FORCE       PIC X.
  1799             20  CF-INDIVIDUAL-APP.
  1800                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  1801                     28  CF-BROWSE-APP      PIC X.
  1802                     28  CF-UPDATE-APP      PIC X.
  1803
  1804         16  CF-CURRENT-TERM-ON             PIC X(4).
  1805         16  CF-PROCESSOR-LIMITS-CLAIMS.
  1806             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  1807             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  1808             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  1809             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  1810             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  1811             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  1812             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  1813         16  CF-PROCESSOR-CARRIER           PIC X.
  1814             88  NO-CARRIER-SECURITY            VALUE ' '.
  1815         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  1816             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  1817         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  1818             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  1819         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  1820             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  1821
  1822         16  CF-PROC-SYS-ACCESS-SW.
  1823             20  CF-PROC-CREDIT-CLAIMS-SW.
  1824                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  1825                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  1826                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  1827                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  1828             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  1829                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  1830                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  1831             20  CF-PROC-LIFE-GNRLDGR-SW.
  1832                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  1833                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  1834                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  1835                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  1836             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  1837                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  1838                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  1839         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  1840             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  1841             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  1842         16  CF-PROCESSOR-PRINTER               PIC X(4).
  1843
  1844         16  CF-APPROVAL-LEVEL                  PIC X.
  1845             88  APPROVAL-LEVEL-1                   VALUE '1'.
  1846             88  APPROVAL-LEVEL-2                   VALUE '2'.
  1847             88  APPROVAL-LEVEL-3                   VALUE '3'.
  1848             88  APPROVAL-LEVEL-4                   VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  39
* EL680.cbl
  1849             88  APPROVAL-LEVEL-5                   VALUE '5'.
  1850
  1851         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  1852
  1853         16  CF-LANGUAGE-TYPE                   PIC X.
  1854             88  CF-LANG-IS-ENG                     VALUE 'E'.
  1855             88  CF-LANG-IS-FR                      VALUE 'F'.
  1856
  1857         16  CF-CSR-IND                         PIC X.
  1858         16  FILLER                             PIC X(239).
  1859
  1860****************************************************************
  1861*             PROCESSOR/REMINDERS RECORD                       *
  1862****************************************************************
  1863
  1864     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  1865         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  1866             20  CF-START-REMIND-DT         PIC XX.
  1867             20  CF-END-REMIND-DT           PIC XX.
  1868             20  CF-REMINDER-TEXT           PIC X(50).
  1869         16  FILLER                         PIC X(296).
  1870
  1871
  1872****************************************************************
  1873*             STATE MASTER RECORD                              *
  1874****************************************************************
  1875
  1876     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  1877         16  CF-STATE-ABBREVIATION          PIC XX.
  1878         16  CF-STATE-NAME                  PIC X(25).
  1879         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  1880         16  CF-ST-CALC-QUOTE-TOLERANCE.
  1881             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  1882             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  1883             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  1884             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  1885                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  1886                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  1887             20  CF-ST-PREM-REJECT-SW       PIC X.
  1888                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  1889                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  1890             20  CF-ST-REF-REJECT-SW        PIC X.
  1891                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  1892                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  1893         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  1894         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  1895         16  CF-ST-REFUND-RULES.
  1896             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  1897             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  1898             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  1899         16  CF-ST-FST-PMT-EXTENSION.
  1900             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  1901             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  1902                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  1903                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  1904                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  1905                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  1906         16  CF-ST-STATE-CALL.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  40
* EL680.cbl
  1907             20  CF-ST-CALL-UNEARNED        PIC X.
  1908             20  CF-ST-CALL-RPT-CNTL        PIC X.
  1909             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  1910         16  CF-REPLACEMENT-LAW-SW          PIC X.
  1911             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  1912             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  1913         16  CF-REPLACEMENT-LETTER          PIC X(4).
  1914         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  1915         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  1916         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  1917         16  CF-ST-SPLIT-PAYMENT            PIC X.
  1918         16  FILLER                         PIC X.
  1919         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  1920             20  CF-ST-BENEFIT-CD           PIC XX.
  1921             20  CF-ST-BENEFIT-KIND         PIC X.
  1922                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  1923                 88  CF-ST-AH-KIND              VALUE 'A'.
  1924             20  CF-ST-REM-TERM-CALC        PIC X.
  1925                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  1926                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  1927                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  1928                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  1929                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  1930                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  1931                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  1932                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  1933
  1934             20  CF-ST-REFUND-CALC          PIC X.
  1935                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  1936                 88  ST-REFD-BY-R78             VALUE '1'.
  1937                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  1938                 88  ST-REFD-AS-CALIF           VALUE '3'.
  1939                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  1940                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  1941                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  1942                 88  ST-REFD-UTAH               VALUE '7'.
  1943                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  1944                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  1945                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  1946
  1947             20  CF-ST-EARNING-CALC         PIC X.
  1948                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  1949                 88  ST-EARN-BY-R78             VALUE '1'.
  1950                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  1951                 88  ST-EARN-AS-CALIF           VALUE '3'.
  1952                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  1953                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  1954                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  1955                 88  ST-EARN-MEAN               VALUE '8'.
  1956                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  1957
  1958             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  1959                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  1960                 88  ST-OVRD-BY-R78             VALUE '1'.
  1961                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  1962                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  1963                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  1964                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  41
* EL680.cbl
  1965                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  1966                 88  ST-OVRD-MEAN               VALUE '8'.
  1967                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  1968             20  cf-st-extra-periods        pic 9.
  1969*            20  FILLER                     PIC X.
  1970
  1971         16  CF-ST-COMMISSION-CAPS.
  1972             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  1973             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  1974             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  1975             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  1976         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  1977                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  1978                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  1979                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  1980
  1981         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  1982
  1983         16  CF-ST-STATUTORY-INTEREST.
  1984             20  CF-ST-STAT-DATE-FROM       PIC X.
  1985                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  1986                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  1987             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  1988             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  1989             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  1990             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  1991             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  1992
  1993         16  CF-ST-OVER-SHORT.
  1994             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  1995             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  1996
  1997         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  1998
  1999         16  CF-ST-RT-CALC                  PIC X.
  2000
  2001         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  2002         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  2003         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  2004         16  CF-ST-RF-LR-CALC               PIC X.
  2005         16  CF-ST-RF-LL-CALC               PIC X.
  2006         16  CF-ST-RF-LN-CALC               PIC X.
  2007         16  CF-ST-RF-AH-CALC               PIC X.
  2008         16  CF-ST-RF-CP-CALC               PIC X.
  2009*        16  FILLER                         PIC X(206).
  2010*CIDMOD         16  FILLER                         PIC X(192).
  2011         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  2012             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  2013         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  2014         16  CF-ST-VFY-2ND-BENE             PIC X.
  2015         16  CF-ST-CAUSAL-STATE             PIC X.
  2016         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  2017         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  2018         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  2019             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  2020         16  CF-ST-NET-ONLY-STATE           PIC X.
  2021             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  2022         16  cf-commission-cap-required     pic x.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  42
* EL680.cbl
  2023         16  CF-ST-GA-COMMISSION-CAPS.
  2024             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  2025             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  2026             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  2027             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  2028         16  CF-ST-TOT-COMMISSION-CAPS.
  2029             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  2030             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  2031             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  2032             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  2033         16  FILLER                         PIC X(156).
  2034
  2035****************************************************************
  2036*             BENEFIT MASTER RECORD                            *
  2037****************************************************************
  2038
  2039     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2040         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  2041             20  CF-BENEFIT-CODE            PIC XX.
  2042             20  CF-BENEFIT-NUMERIC  REDEFINES
  2043                 CF-BENEFIT-CODE            PIC XX.
  2044             20  CF-BENEFIT-ALPHA           PIC XXX.
  2045             20  CF-BENEFIT-DESCRIP         PIC X(10).
  2046             20  CF-BENEFIT-COMMENT         PIC X(10).
  2047
  2048             20  CF-LF-COVERAGE-TYPE        PIC X.
  2049                 88  CF-REDUCING                VALUE 'R'.
  2050                 88  CF-LEVEL                   VALUE 'L' 'P'.
  2051
  2052             20  CF-SPECIAL-CALC-CD         PIC X.
  2053                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  2054                 88  CF-NP-0-MO-INT             VALUE 'A'.
  2055                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  2056                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  2057                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  2058                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  2059                 88  CF-FARM-PLAN               VALUE 'F'.
  2060                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  2061                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  2062                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  2063                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  2064                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  2065                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  2066                 88  CF-PRUDENTIAL              VALUE 'P'.
  2067                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  2068                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  2069                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  2070                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  2071                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  2072                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  2073
  2074             20  CF-JOINT-INDICATOR         PIC X.
  2075                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  2076
  2077*            20  FILLER                     PIC X(12).
  2078             20  cf-maximum-benefits        pic s999 comp-3.
  2079             20  FILLER                     PIC X(09).
  2080             20  CF-BENEFIT-CATEGORY        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  43
* EL680.cbl
  2081             20  CF-LOAN-TYPE               PIC X(8).
  2082
  2083             20  CF-CO-REM-TERM-CALC        PIC X.
  2084                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  2085                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  2086                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  2087                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  2088                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  2089
  2090             20  CF-CO-EARNINGS-CALC        PIC X.
  2091                 88  CO-EARN-BY-R78             VALUE '1'.
  2092                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  2093                 88  CO-EARN-AS-CALIF           VALUE '3'.
  2094                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  2095                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  2096                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  2097                 88  CO-EARN-AS-MEAN            VALUE '8'.
  2098                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  2099
  2100             20  CF-CO-REFUND-CALC          PIC X.
  2101                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  2102                 88  CO-REFD-BY-R78             VALUE '1'.
  2103                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  2104                 88  CO-REFD-AS-CALIF           VALUE '3'.
  2105                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  2106                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  2107                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  2108                 88  CO-REFD-MEAN               VALUE '8'.
  2109                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  2110                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  2111                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  2112
  2113             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  2114                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  2115                 88  CO-OVRD-BY-R78             VALUE '1'.
  2116                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  2117                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  2118                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  2119                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  2120                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  2121                 88  CO-OVRD-MEAN               VALUE '8'.
  2122                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  2123
  2124             20  CF-CO-BEN-I-G-CD           PIC X.
  2125                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  2126                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  2127                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  2128
  2129         16  FILLER                         PIC X(304).
  2130
  2131
  2132****************************************************************
  2133*             CARRIER MASTER RECORD                            *
  2134****************************************************************
  2135
  2136     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2137         16  CF-ADDRESS-DATA.
  2138             20  CF-MAIL-TO-NAME            PIC X(30).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  44
* EL680.cbl
  2139             20  CF-IN-CARE-OF              PIC X(30).
  2140             20  CF-ADDRESS-LINE-1          PIC X(30).
  2141             20  CF-ADDRESS-LINE-2          PIC X(30).
  2142             20  CF-CITY-STATE              PIC X(30).
  2143             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  2144             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  2145
  2146         16  CF-CLAIM-NO-CONTROL.
  2147             20  CF-CLAIM-NO-METHOD         PIC X.
  2148                 88  CLAIM-NO-MANUAL            VALUE '1'.
  2149                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  2150                 88  CLAIM-NO-SEQ               VALUE '3'.
  2151                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  2152             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  2153                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  2154                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  2155                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  2156
  2157         16  CF-CHECK-NO-CONTROL.
  2158             20  CF-CHECK-NO-METHOD         PIC X.
  2159                 88  CHECK-NO-MANUAL            VALUE '1'.
  2160                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  2161                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  2162                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  2163             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  2164                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  2165
  2166         16  CF-DOMICILE-STATE              PIC XX.
  2167
  2168         16  CF-EXPENSE-CONTROLS.
  2169             20  CF-EXPENSE-METHOD          PIC X.
  2170                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  2171                 88  DOLLARS-PER-PMT            VALUE '2'.
  2172                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  2173                 88  DOLLARS-PER-MONTH          VALUE '4'.
  2174             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  2175             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  2176
  2177         16  CF-CORRESPONDENCE-CONTROL.
  2178             20  CF-LETTER-RESEND-OPT       PIC X.
  2179                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  2180                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  2181             20  FILLER                     PIC X(4).
  2182
  2183         16  CF-RESERVE-CONTROLS.
  2184             20  CF-MANUAL-SW               PIC X.
  2185                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  2186             20  CF-FUTURE-SW               PIC X.
  2187                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  2188             20  CF-PTC-SW                  PIC X.
  2189                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  2190             20  CF-IBNR-SW                 PIC X.
  2191                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  2192             20  CF-PTC-LF-SW               PIC X.
  2193                 88  CF-LF-PTC-USED             VALUE '1'.
  2194             20  CF-CDT-ACCESS-METHOD       PIC X.
  2195                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  2196                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  45
* EL680.cbl
  2197                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  2198             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  2199
  2200         16  CF-CLAIM-CALC-METHOD           PIC X.
  2201             88  360-PLUS-MONTHS                VALUE '1'.
  2202             88  365-PLUS-MONTHS                VALUE '2'.
  2203             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  2204             88  360-DAILY                      VALUE '4'.
  2205             88  365-DAILY                      VALUE '5'.
  2206
  2207         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  2208         16  FILLER                         PIC X(11).
  2209
  2210         16  CF-LIMIT-AMOUNTS.
  2211             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  2212             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  2213             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  2214             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  2215             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  2216             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  2217             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  2218             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  2219             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  2220             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  2221
  2222         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  2223         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  2224         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  2225
  2226         16  CF-ZIP-CODE.
  2227             20  CF-ZIP-PRIME.
  2228                 24  CF-ZIP-1ST             PIC X.
  2229                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  2230                 24  FILLER                 PIC X(4).
  2231             20  CF-ZIP-PLUS4               PIC X(4).
  2232         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  2233             20  CF-CAN-POSTAL-1            PIC XXX.
  2234             20  CF-CAN-POSTAL-2            PIC XXX.
  2235             20  FILLER                     PIC XXX.
  2236
  2237         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  2238         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  2239         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  2240
  2241         16  CF-RATING-SWITCH               PIC X.
  2242             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  2243             88  CF-NO-RATING                   VALUE 'N'.
  2244
  2245         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  2246
  2247         16  CF-CARRIER-OVER-SHORT.
  2248             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2249             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2250
  2251         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  2252         16  CF-SECPAY-SWITCH               PIC X.
  2253             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  2254             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  46
* EL680.cbl
  2255         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  2256         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  2257         16  FILLER                         PIC X(444).
  2258*        16  FILLER                         PIC X(452).
  2259
  2260
  2261****************************************************************
  2262*             MORTALITY MASTER RECORD                          *
  2263****************************************************************
  2264
  2265     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2266         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  2267                                INDEXED BY CF-MORT-NDX.
  2268             20  CF-MORT-TABLE              PIC X(5).
  2269             20  CF-MORT-TABLE-TYPE         PIC X.
  2270                 88  CF-MORT-JOINT              VALUE 'J'.
  2271                 88  CF-MORT-SINGLE             VALUE 'S'.
  2272                 88  CF-MORT-COMBINED           VALUE 'C'.
  2273                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  2274                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  2275             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  2276             20  CF-MORT-AGE-METHOD         PIC XX.
  2277                 88  CF-AGE-LAST                VALUE 'AL'.
  2278                 88  CF-AGE-NEAR                VALUE 'AN'.
  2279             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  2280             20  CF-MORT-ADJUSTMENT-DIRECTION
  2281                                            PIC X.
  2282                 88  CF-MINUS                   VALUE '-'.
  2283                 88  CF-PLUS                    VALUE '+'.
  2284             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  2285             20  CF-MORT-JOINT-CODE         PIC X.
  2286                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  2287             20  CF-MORT-PC-Q               PIC X.
  2288                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  2289             20  CF-MORT-TABLE-CODE         PIC X(4).
  2290             20  CF-MORT-COMMENTS           PIC X(15).
  2291             20  FILLER                     PIC X(14).
  2292
  2293         16  FILLER                         PIC X(251).
  2294
  2295
  2296****************************************************************
  2297*             BUSSINESS TYPE MASTER RECORD                     *
  2298****************************************************************
  2299
  2300     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2301* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  2302* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  2303* AND RECORD 05 IS TYPES 81-99
  2304         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  2305             20  CF-BUSINESS-TITLE          PIC  X(19).
  2306             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  2307                                            PIC S9V9(4) COMP-3.
  2308             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  2309             20  FILLER                     PIC  X.
  2310         16  FILLER                         PIC  X(248).
  2311
  2312
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  47
* EL680.cbl
  2313****************************************************************
  2314*             TERMINAL MASTER RECORD                           *
  2315****************************************************************
  2316
  2317     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2318
  2319         16  CF-COMPANY-TERMINALS.
  2320             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  2321                                  PIC X(4).
  2322         16  FILLER               PIC X(248).
  2323
  2324
  2325****************************************************************
  2326*             LIFE EDIT MASTER RECORD                          *
  2327****************************************************************
  2328
  2329     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2330         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  2331             20  CF-LIFE-CODE-IN            PIC XX.
  2332             20  CF-LIFE-CODE-OUT           PIC XX.
  2333         16  FILLER                         PIC X(248).
  2334
  2335
  2336****************************************************************
  2337*             AH EDIT MASTER RECORD                            *
  2338****************************************************************
  2339
  2340     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2341         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  2342             20  CF-AH-CODE-IN              PIC XXX.
  2343             20  CF-AH-CODE-OUT             PIC XX.
  2344         16  FILLER                         PIC X(248).
  2345
  2346
  2347****************************************************************
  2348*             CREDIBILITY TABLES                               *
  2349****************************************************************
  2350
  2351     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  2352         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  2353                             INDEXED BY CF-CRDB-NDX.
  2354             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  2355             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  2356             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  2357         16  FILLER                         PIC  X(332).
  2358
  2359
  2360****************************************************************
  2361*             REPORT CUSTOMIZATION RECORD                      *
  2362****************************************************************
  2363
  2364     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  2365         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  2366             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  2367             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  2368             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  2369**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  2370****       A T-TRANSFER.                                   ****
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  48
* EL680.cbl
  2371             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  2372
  2373         16  FILLER                         PIC XX.
  2374
  2375         16  CF-CARRIER-CNTL-OPT.
  2376             20  CF-CARRIER-OPT-SEQ         PIC 9.
  2377                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  2378                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  2379             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  2380                                            PIC X.
  2381         16  CF-GROUP-CNTL-OPT.
  2382             20  CF-GROUP-OPT-SEQ           PIC 9.
  2383                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  2384                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  2385             20  CF-GROUP-SELECT OCCURS 3 TIMES
  2386                                            PIC X(6).
  2387         16  CF-STATE-CNTL-OPT.
  2388             20  CF-STATE-OPT-SEQ           PIC 9.
  2389                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  2390                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  2391             20  CF-STATE-SELECT OCCURS 3 TIMES
  2392                                            PIC XX.
  2393         16  CF-ACCOUNT-CNTL-OPT.
  2394             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  2395                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  2396                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  2397             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  2398                                            PIC X(10).
  2399         16  CF-BUS-TYP-CNTL-OPT.
  2400             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  2401                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  2402                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  2403             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  2404                                            PIC XX.
  2405         16  CF-LF-TYP-CNTL-OPT.
  2406             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  2407                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  2408                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  2409             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  2410                                            PIC XX.
  2411         16  CF-AH-TYP-CNTL-OPT.
  2412             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  2413                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  2414                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  2415             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  2416                                            PIC XX.
  2417         16  CF-REPTCD1-CNTL-OPT.
  2418             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  2419                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  2420                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  2421             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  2422                                            PIC X(10).
  2423         16  CF-REPTCD2-CNTL-OPT.
  2424             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  2425                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  2426                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  2427             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  2428                                            PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  49
* EL680.cbl
  2429         16  CF-USER1-CNTL-OPT.
  2430             20  CF-USER1-OPT-SEQ           PIC 9.
  2431                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  2432                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  2433             20  CF-USER1-SELECT OCCURS 3 TIMES
  2434                                            PIC X(10).
  2435         16  CF-USER2-CNTL-OPT.
  2436             20  CF-USER2-OPT-SEQ           PIC 9.
  2437                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  2438                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  2439             20  CF-USER2-SELECT OCCURS 3 TIMES
  2440                                            PIC X(10).
  2441         16  CF-USER3-CNTL-OPT.
  2442             20  CF-USER3-OPT-SEQ           PIC 9.
  2443                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  2444                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  2445             20  CF-USER3-SELECT OCCURS 3 TIMES
  2446                                            PIC X(10).
  2447         16  CF-USER4-CNTL-OPT.
  2448             20  CF-USER4-OPT-SEQ           PIC 9.
  2449                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  2450                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  2451             20  CF-USER4-SELECT OCCURS 3 TIMES
  2452                                            PIC X(10).
  2453         16  CF-USER5-CNTL-OPT.
  2454             20  CF-USER5-OPT-SEQ           PIC 9.
  2455                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  2456                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  2457             20  CF-USER5-SELECT OCCURS 3 TIMES
  2458                                            PIC X(10).
  2459         16  CF-REINS-CNTL-OPT.
  2460             20  CF-REINS-OPT-SEQ           PIC 9.
  2461                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  2462                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  2463             20  CF-REINS-SELECT OCCURS 3 TIMES.
  2464                 24  CF-REINS-PRIME         PIC XXX.
  2465                 24  CF-REINS-SUB           PIC XXX.
  2466
  2467         16  CF-AGENT-CNTL-OPT.
  2468             20  CF-AGENT-OPT-SEQ           PIC 9.
  2469                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  2470                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  2471             20  CF-AGENT-SELECT OCCURS 3 TIMES
  2472                                            PIC X(10).
  2473
  2474         16  FILLER                         PIC X(43).
  2475
  2476         16  CF-LOSS-RATIO-SELECT.
  2477             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  2478             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  2479         16  CF-ENTRY-DATE-SELECT.
  2480             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  2481             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  2482         16  CF-EFFECTIVE-DATE-SELECT.
  2483             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  2484             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  2485
  2486         16  CF-EXCEPTION-LIST-IND          PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  50
* EL680.cbl
  2487             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  2488
  2489         16  FILLER                         PIC X(318).
  2490
  2491****************************************************************
  2492*                  EXCEPTION REPORTING RECORD                  *
  2493****************************************************************
  2494
  2495     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  2496         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  2497             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  2498
  2499         16  CF-COMBINED-LIFE-AH-OPT.
  2500             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  2501             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  2502             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  2503             20  CF-CANCELLATION-RATIO      PIC S9(02).
  2504
  2505         16  CF-LIFE-OPT.
  2506             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2507             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2508             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2509             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2510             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2511             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2512             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2513             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2514             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2515             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  2516
  2517         16  CF-AH-OPT.
  2518             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  2519             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  2520             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  2521             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  2522             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  2523             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  2524             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  2525             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  2526             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  2527             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  2528
  2529         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  2530             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  2531             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  2532             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  2533
  2534         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  2535
  2536         16  FILLER                         PIC X(673).
  2537
  2538
  2539****************************************************************
  2540*             MORTGAGE SYSTEM PLAN RECORD                      *
  2541****************************************************************
  2542
  2543     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  2544         16  CF-PLAN-TYPE                   PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  51
* EL680.cbl
  2545             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  2546             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  2547             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  2548         16  CF-PLAN-ABBREV                 PIC XXX.
  2549         16  CF-PLAN-DESCRIPT               PIC X(10).
  2550         16  CF-PLAN-NOTES                  PIC X(20).
  2551         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  2552         16  CF-PLAN-UNDERWRITING.
  2553             20  CF-PLAN-TERM-DATA.
  2554                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  2555                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  2556             20  CF-PLAN-AGE-DATA.
  2557                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  2558                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  2559                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  2560             20  CF-PLAN-BENEFIT-DATA.
  2561                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2562                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  2563                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  2564                                            PIC S9(7)V99  COMP-3.
  2565         16  CF-PLAN-POLICY-FORMS.
  2566             20  CF-POLICY-FORM             PIC X(12).
  2567             20  CF-MASTER-APPLICATION      PIC X(12).
  2568             20  CF-MASTER-POLICY           PIC X(12).
  2569         16  CF-PLAN-RATING.
  2570             20  CF-RATE-CODE               PIC X(5).
  2571             20  CF-SEX-RATING              PIC X.
  2572                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  2573                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  2574             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  2575             20  CF-SUB-STD-TYPE            PIC X.
  2576                 88  CF-PCT-OF-PREM            VALUE '1'.
  2577                 88  CF-PCT-OF-BENE            VALUE '2'.
  2578         16  CF-PLAN-PREM-TOLERANCES.
  2579             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  2580             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  2581         16  CF-PLAN-PYMT-TOLERANCES.
  2582             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  2583             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  2584         16  CF-PLAN-MISC-DATA.
  2585             20  FILLER                     PIC X.
  2586             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  2587             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  2588         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  2589         16  CF-PLAN-IND-GRP                PIC X.
  2590             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  2591                                                     '1'.
  2592             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  2593                                                     '2'.
  2594         16  CF-MIB-SEARCH-SW               PIC X.
  2595             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  2596             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  2597             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  2598             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  2599         16  CF-ALPHA-SEARCH-SW             PIC X.
  2600             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  2601             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  2602             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  52
* EL680.cbl
  2603             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  2604             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  2605             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  2606             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  2607             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  2608             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  2609             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  2610                                                     'A' 'B' 'C'
  2611                                                     'X' 'Y' 'Z'.
  2612         16  CF-EFF-DT-RULE-SW              PIC X.
  2613             88  CF-EFF-DT-ENTER               VALUE 'E'.
  2614             88  CF-EFF-DT-MONTH               VALUE 'M'.
  2615             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  2616             88  CF-EFF-DT-SEMI                VALUE 'S'.
  2617             88  CF-EFF-DT-ANN                 VALUE 'A'.
  2618         16  FILLER                         PIC X(4).
  2619         16  CF-HEALTH-QUESTIONS            PIC X.
  2620             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  2621         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  2622         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  2623         16  CF-PLAN-SNGL-JNT               PIC X.
  2624             88  CF-COMBINED-PLAN              VALUE 'C'.
  2625             88  CF-JNT-PLAN                   VALUE 'J'.
  2626             88  CF-SNGL-PLAN                  VALUE 'S'.
  2627         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  2628         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  2629         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  2630         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  2631         16  CF-RERATE-CNTL                 PIC  X.
  2632             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  2633             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  2634             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  2635             88  CF-AUTO-RECALC                 VALUE '4'.
  2636         16  CF-BENEFIT-TYPE                PIC  X.
  2637             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  2638             88  CF-BENEFIT-REDUCES             VALUE '2'.
  2639         16  CF-POLICY-FEE                  PIC S999V99
  2640                                                    COMP-3.
  2641         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  2642         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  2643         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  2644         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  2645         16  FILLER                         PIC  X(32).
  2646         16  CF-TERMINATION-FORM            PIC  X(04).
  2647         16  FILLER                         PIC  X(08).
  2648         16  CF-CLAIM-CAP                   PIC S9(7)V99
  2649                                                       COMP-3.
  2650         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  2651         16  CF-ISSUE-LETTER                PIC  X(4).
  2652         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  2653         16  CF-DEPENDENT-COVERAGE          PIC  X.
  2654             88  CF-YES-DEP-COV                 VALUE 'Y'.
  2655             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  2656         16  CF-MP-REFUND-CALC              PIC X.
  2657             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  2658             88  CF-MP-REFD-BY-R78              VALUE '1'.
  2659             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  2660             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  53
* EL680.cbl
  2661             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  2662             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  2663             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  2664             88  CF-MP-REFD-MEAN                VALUE '8'.
  2665         16  CF-ALT-RATE-CODE               PIC  X(5).
  2666
  2667
  2668         16  FILLER                         PIC X(498).
  2669****************************************************************
  2670*             MORTGAGE COMPANY MASTER RECORD                   *
  2671****************************************************************
  2672
  2673     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2674         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  2675         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  2676             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  2677             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  2678             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  2679             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  2680             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  2681
  2682         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  2683         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  2684         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  2685         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  2686         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  2687
  2688         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  2689             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  2690         16  CF-MP-RECON-USE-IND            PIC X(1).
  2691             88  CF-MP-USE-RECON             VALUE 'Y'.
  2692         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  2693             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  2694         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  2695             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  2696             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  2697         16  FILLER                         PIC X(1).
  2698         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  2699             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  2700         16  CF-MORTG-MIB-VERSION           PIC X.
  2701             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  2702             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  2703             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  2704         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  2705             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  2706                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  2707             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  2708                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  2709             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  2710                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  2711             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  2712                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  2713             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  2714                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  2715             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  2716                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  2717         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  2718         16  FILLER                         PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  54
* EL680.cbl
  2719         16  CF-MORTG-DESTINATION-SYMBOL.
  2720             20  CF-MORTG-MIB-COMM          PIC X(5).
  2721             20  CF-MORTG-MIB-TERM          PIC X(5).
  2722         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  2723             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  2724         16  FILLER                         PIC X(03).
  2725         16  CF-MP-CHECK-NO-CONTROL.
  2726             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  2727                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  2728                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  2729                                                ' ' LOW-VALUES.
  2730                 88  CF-MP-CHECK-NO-PRE-PRINTED
  2731                                               VALUE '3'.
  2732         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  2733         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  2734         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  2735             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  2736                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  2737             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  2738                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  2739             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  2740                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  2741             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  2742                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  2743             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  2744                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  2745             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  2746                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  2747         16  CF-MORTG-BILLING-AREA.
  2748             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  2749                                            PIC X.
  2750         16  CF-MORTG-MONTH-END-DT          PIC XX.
  2751         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  2752         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  2753         16  CF-MORTG-MIB-DEST-SW           PIC X.
  2754             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  2755             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  2756         16  FILLER                         PIC X.
  2757         16  CF-MORTG-LABEL-CONTROL         PIC X.
  2758             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  2759             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  2760         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  2761         16  FILLER                         PIC X(8).
  2762         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  2763         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  2764         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  2765         16  CF-ACH-COMPANY-ID.
  2766             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  2767                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  2768                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  2769                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  2770             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  2771         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  2772             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  2773         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  2774             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  2775             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  2776         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  55
* EL680.cbl
  2777         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  2778         16  FILLER                         PIC X(536).
  2779
  2780****************************************************************
  2781*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  2782****************************************************************
  2783
  2784     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  2785         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  2786             20  CF-FEMALE-HEIGHT.
  2787                 24  CF-FEMALE-FT           PIC 99.
  2788                 24  CF-FEMALE-IN           PIC 99.
  2789             20  CF-FEMALE-MIN-WT           PIC 999.
  2790             20  CF-FEMALE-MAX-WT           PIC 999.
  2791         16  FILLER                         PIC X(428).
  2792
  2793     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  2794         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  2795             20  CF-MALE-HEIGHT.
  2796                 24  CF-MALE-FT             PIC 99.
  2797                 24  CF-MALE-IN             PIC 99.
  2798             20  CF-MALE-MIN-WT             PIC 999.
  2799             20  CF-MALE-MAX-WT             PIC 999.
  2800         16  FILLER                         PIC X(428).
  2801******************************************************************
  2802*             AUTOMATIC ACTIVITY RECORD                          *
  2803******************************************************************
  2804     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  2805         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  2806             20  CF-SYS-ACTIVE-SW           PIC X(01).
  2807             20  CF-SYS-LETTER-ID           PIC X(04).
  2808             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  2809             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  2810             20  CF-SYS-RESET-SW            PIC X(01).
  2811             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  2812             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  2813
  2814         16  FILLER                         PIC X(50).
  2815
  2816         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  2817             20  CF-USER-ACTIVE-SW          PIC X(01).
  2818             20  CF-USER-LETTER-ID          PIC X(04).
  2819             20  CF-USER-RESEND-DAYS        PIC 9(03).
  2820             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  2821             20  CF-USER-RESET-SW           PIC X(01).
  2822             20  CF-USER-REPORT-DAYS        PIC 9(03).
  2823             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  2824             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  2825
  2826         16  FILLER                         PIC X(246).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  56
* EL680.cbl
  2828 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CONTROL-FILE.
  2829 0000-DFHEXIT SECTION.
  2830     MOVE '9#                    $   ' TO DFHEIV0.
  2831     MOVE 'EL680' TO DFHEIV1.
  2832     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2833     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  2834     MOVE '5'                   TO DC-OPTION-CODE.
  2835     PERFORM 9700-LINK-DATE-CONVERT THRU 9700-EXIT.
  2836     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  2837     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  2838
  2839     MOVE DFHCOMMAREA TO PROGRAM-INTERFACE-BLOCK.
  2840     MOVE 2           TO EMI-NUMBER-OF-LINES.
  2841
  2842     IF EIBCALEN = 0
  2843         GO TO 8800-UNAUTHORIZED-ACCESS.
  2844
  2845     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2846         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2847             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2848             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2849             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2850             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2851             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2852             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2853             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2854             MOVE THIS-PGM             TO PI-CALLING-PROGRAM.
  2855
  2856     IF EIBTRNID NOT = TRANS-ID
  2857         GO TO 8100-SEND-INITIAL-MAP.
  2858
  2859     IF EIBAID = DFHCLEAR
  2860         GO TO 9400-CLEAR.
  2861
  2862
  2863* EXEC CICS HANDLE CONDITION
  2864*        MAPFAIL (8100-SEND-INITIAL-MAP)
  2865*    END-EXEC.
  2866*    MOVE '"$?                   ! " #00002858' TO DFHEIV0
  2867     MOVE X'22243F202020202020202020' TO DFHEIV0(1:12)
  2868     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2869     MOVE X'2220233030303032383538' TO DFHEIV0(25:11)
  2870     CALL 'kxdfhei1' USING DFHEIV0
  2871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2872
  2873
  2874 0100-RECEIVE-MAP.
  2875
  2876* EXEC CICS RECEIVE
  2877*        MAP    (MAP-NAME)
  2878*        MAPSET (MAPSET-NAME)
  2879*        INTO   (EL680AI)
  2880*    END-EXEC.
  2881     MOVE LENGTH OF
  2882      EL680AI
  2883       TO DFHEIV11
  2884*    MOVE '8"T I  L              ''   #00002863' TO DFHEIV0
  2885     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  57
* EL680.cbl
  2886     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2887     MOVE X'2020233030303032383633' TO DFHEIV0(25:11)
  2888     CALL 'kxdfhei1' USING DFHEIV0,
  2889           MAP-NAME,
  2890           EL680AI,
  2891           DFHEIV11,
  2892           MAPSET-NAME,
  2893           DFHEIV99,
  2894           DFHEIV99
  2895     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2896
  2897
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  58
* EL680.cbl
  2899 0200-RECEIVE.
  2900     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2901         MOVE ER-0008  TO EMI-ERROR
  2902         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2903         MOVE -1    TO ANAMEL
  2904         GO TO 8200-SEND-DATAONLY.
  2905
  2906     IF PFENTERL = 0
  2907         GO TO 0300-CHECK-PFKEYS.
  2908     IF EIBAID NOT = DFHENTER
  2909         MOVE ER-0004  TO EMI-ERROR
  2910         GO TO 0320-INPUT-ERROR.
  2911
  2912     IF (PFENTERI NUMERIC) AND (PFENTERI GREATER 0 AND LESS 25)
  2913         MOVE PF-VALUES (PFENTERI) TO EIBAID
  2914     ELSE
  2915         MOVE ER-0029  TO EMI-ERROR
  2916         GO TO 0320-INPUT-ERROR.
  2917
  2918 0300-CHECK-PFKEYS.
  2919     IF EIBAID = DFHPF1
  2920         GO TO 1000-EDIT-INPUT-DATA.
  2921
  2922     IF EIBAID = DFHPF23
  2923         GO TO 8810-PF23.
  2924
  2925     IF EIBAID = DFHPF24
  2926         GO TO 9200-RETURN-MAIN-MENU.
  2927
  2928     IF EIBAID = DFHPF12
  2929         GO TO 9500-PF12.
  2930
  2931     IF EIBAID = DFHENTER
  2932         GO TO 1000-EDIT-INPUT-DATA.
  2933
  2934     MOVE ER-0029 TO EMI-ERROR.
  2935 0320-INPUT-ERROR.
  2936     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2937     MOVE AL-UNBON               TO PFENTERA.
  2938     IF PFENTERL = 0
  2939         MOVE -1                 TO ANAMEL
  2940     ELSE
  2941         MOVE -1                 TO PFENTERL.
  2942
  2943     GO TO 8200-SEND-DATAONLY.
  2944
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  59
* EL680.cbl
  2946 1000-EDIT-INPUT-DATA.
  2947******EDIT AMOUNT REQUESTED
  2948
  2949
  2950* EXEC CICS BIF DEEDIT
  2951*        FIELD  (AAMOUNTI)
  2952*        LENGTH (12)
  2953*    END-EXEC.
  2954     MOVE 12
  2955       TO DFHEIV11
  2956*    MOVE '@"L                   #   #00002920' TO DFHEIV0
  2957     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2958     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2959     MOVE X'2020233030303032393230' TO DFHEIV0(25:11)
  2960     CALL 'kxdfhei1' USING DFHEIV0,
  2961           AAMOUNTI,
  2962           DFHEIV11
  2963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2964
  2965
  2966     IF (AAMOUNTI NUMERIC)  AND
  2967        (AAMOUNTI NOT = ZERO)
  2968         MOVE AAMOUNTI       TO  WS-AMOUNT-REQUESTED
  2969                                 AAMOUNTO
  2970         MOVE AL-UNNON       TO  AAMOUNTA
  2971       ELSE
  2972         MOVE -1             TO  AAMOUNTL
  2973         MOVE AL-UNBON       TO  AAMOUNTA
  2974         MOVE ER-2361        TO  EMI-ERROR
  2975         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2976         ADD +1  TO  WS-ERROR-COUNT.
  2977
  2978***********INTEREST RATE (APR)
  2979
  2980* EXEC CICS BIF DEEDIT
  2981*        FIELD  (AINTRATI)
  2982*        LENGTH (8)
  2983*    END-EXEC.
  2984     MOVE 8
  2985       TO DFHEIV11
  2986*    MOVE '@"L                   #   #00002938' TO DFHEIV0
  2987     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2988     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2989     MOVE X'2020233030303032393338' TO DFHEIV0(25:11)
  2990     CALL 'kxdfhei1' USING DFHEIV0,
  2991           AINTRATI,
  2992           DFHEIV11
  2993     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2994
  2995
  2996     IF (AINTRATI NUMERIC)  AND
  2997        (AINTRATI NOT = ZERO)
  2998         MOVE AINTRATI       TO  WS-APR
  2999                                 AINTRATO
  3000         MOVE AL-UNNON       TO  AINTRATA
  3001       ELSE
  3002         MOVE -1             TO  AINTRATL
  3003         MOVE AL-UNBON       TO  AINTRATA
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  60
* EL680.cbl
  3004         MOVE ER-2363        TO  EMI-ERROR
  3005         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3006         ADD +1  TO  WS-ERROR-COUNT.
  3007
  3008***********PAYMENT FREQUENCY
  3009     IF AFREQI = 'MO' OR 'SM' OR 'BW' OR 'WK' OR
  3010                 'SA' OR 'AN' OR '13'
  3011         MOVE AL-UANON       TO  AFREQA
  3012         MOVE AFREQI         TO  WS-FREQ
  3013       ELSE
  3014         MOVE -1             TO  AFREQL
  3015         MOVE AL-UABON       TO  AFREQA
  3016         MOVE ER-2920        TO  EMI-ERROR
  3017         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3018         ADD +1  TO  WS-ERROR-COUNT.
  3019
  3020***********NUMBER OF PAYMENTS
  3021
  3022* EXEC CICS BIF DEEDIT
  3023*        FIELD  (ANOPMTSI)
  3024*        LENGTH (3)
  3025*    END-EXEC.
  3026     MOVE 3
  3027       TO DFHEIV11
  3028*    MOVE '@"L                   #   #00002968' TO DFHEIV0
  3029     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3030     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3031     MOVE X'2020233030303032393638' TO DFHEIV0(25:11)
  3032     CALL 'kxdfhei1' USING DFHEIV0,
  3033           ANOPMTSI,
  3034           DFHEIV11
  3035     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3036
  3037
  3038     IF (ANOPMTSI NUMERIC) AND
  3039        (ANOPMTSI NOT = ZERO)
  3040         MOVE ANOPMTSI       TO  WS-NUMBER-OF-PMTS
  3041                                 ANOPMTSO
  3042         MOVE AL-UNNON       TO  ANOPMTSA
  3043       ELSE
  3044         MOVE -1             TO  ANOPMTSL
  3045         MOVE AL-UNBON       TO  ANOPMTSA
  3046         MOVE ER-2364        TO  EMI-ERROR
  3047         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3048         ADD +1  TO  WS-ERROR-COUNT.
  3049
  3050***********ADDITIONAL DAYS TO FIRST PAYMENT
  3051     IF AADDAYSL GREATER THAN ZERO
  3052
  3053* EXEC CICS BIF DEEDIT
  3054*            FIELD  (AADDAYSI)
  3055*            LENGTH (3)
  3056*        END-EXEC
  3057     MOVE 3
  3058       TO DFHEIV11
  3059*    MOVE '@"L                   #   #00002987' TO DFHEIV0
  3060     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3061     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  61
* EL680.cbl
  3062     MOVE X'2020233030303032393837' TO DFHEIV0(25:11)
  3063     CALL 'kxdfhei1' USING DFHEIV0,
  3064           AADDAYSI,
  3065           DFHEIV11
  3066     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3067         IF AADDAYSI NUMERIC
  3068             MOVE AADDAYSI       TO  WS-ADDTL-DAYS
  3069                                     AADDAYSO
  3070             MOVE AL-UNNON       TO  AADDAYSA
  3071           ELSE
  3072             MOVE -1             TO  AADDAYSL
  3073             MOVE AL-UNBON       TO  AADDAYSA
  3074             MOVE ER-2921        TO  EMI-ERROR
  3075             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3076             ADD +1  TO  WS-ERROR-COUNT.
  3077
  3078***********ADDITIONAL DAYS CHARGING METHOD
  3079********** SPACE=NO CHG, 1=LF, 2=AH, 3=LF AND AH
  3080     IF ADDCHGL  GREATER THAN ZERO
  3081     IF ADDCHGI = '1' OR '2' OR '3' OR ' '
  3082         MOVE AL-UANON       TO  ADDCHGA
  3083         MOVE ADDCHGI        TO  WS-ADDCHG
  3084       ELSE
  3085         MOVE -1             TO  ADDCHGL
  3086         MOVE AL-UABON       TO  ADDCHGA
  3087         MOVE ER-4004        TO  EMI-ERROR
  3088         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3089         ADD +1  TO  WS-ERROR-COUNT.
  3090
  3091***********BASIS
  3092     IF ABASISI = 'AF' OR 'TP' OR 'NP'
  3093         MOVE AL-UANON       TO  ABASISA
  3094         MOVE ABASISI        TO  WS-BASIS-X
  3095       ELSE
  3096         MOVE -1             TO  ABASISL
  3097         MOVE AL-UABON       TO  ABASISA
  3098         MOVE ER-2367        TO  EMI-ERROR
  3099         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3100         ADD +1  TO  WS-ERROR-COUNT.
  3101
  3102**********USE O/B NET ACTUARIAL RATE
  3103     IF OBYORNL GREATER ZERO
  3104     IF OBYORNI = 'Y' OR 'N'
  3105         MOVE AL-UANON       TO  OBYORNA
  3106         MOVE OBYORNI        TO  WS-OBYN
  3107       ELSE
  3108         MOVE -1             TO  OBYORNL
  3109         MOVE AL-UABON       TO  OBYORNA
  3110         MOVE ER-2922        TO  EMI-ERROR
  3111         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3112         ADD +1  TO  WS-ERROR-COUNT.
  3113
  3114***********NP BENEFIT INCLUDES PREMIUM (Y/N)
  3115     IF WS-BASIS-X = 'NP'
  3116         IF ANPREMI = 'Y' OR 'N'
  3117             MOVE AL-UANON       TO  ANPREMA
  3118             MOVE ANPREMI        TO  WS-NPBEN
  3119           ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  62
* EL680.cbl
  3120             MOVE -1             TO  ANPREML
  3121             MOVE AL-UABON       TO  ANPREMA
  3122             MOVE ER-2922        TO  EMI-ERROR
  3123             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3124             ADD +1  TO  WS-ERROR-COUNT.
  3125
  3126***********TRUNCATED LIFE NO. OF PAYMENTS COVERED
  3127     IF ATRUNCL GREATER THAN ZERO
  3128
  3129* EXEC CICS BIF DEEDIT
  3130*            FIELD  (ATRUNCI)
  3131*            LENGTH (3)
  3132*        END-EXEC
  3133     MOVE 3
  3134       TO DFHEIV11
  3135*    MOVE '@"L                   #   #00003052' TO DFHEIV0
  3136     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3137     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3138     MOVE X'2020233030303033303532' TO DFHEIV0(25:11)
  3139     CALL 'kxdfhei1' USING DFHEIV0,
  3140           ATRUNCI,
  3141           DFHEIV11
  3142     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3143         IF ATRUNCI IS NUMERIC
  3144             MOVE ATRUNCI        TO  WS-TRUNC
  3145                                     ATRUNCO
  3146             MOVE AL-UNNON       TO  ATRUNCA
  3147           IF WS-TRUNC GREATER WS-NUMBER-OF-PMTS
  3148             MOVE -1             TO  ATRUNCL
  3149             MOVE AL-UNBON       TO  ATRUNCA
  3150             MOVE ER-4007        TO  EMI-ERROR
  3151             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3152             ADD +1  TO  WS-ERROR-COUNT
  3153           ELSE
  3154             NEXT SENTENCE
  3155           ELSE
  3156             MOVE -1             TO  ATRUNCL
  3157             MOVE AL-UNBON       TO  ATRUNCA
  3158             MOVE ER-2923        TO  EMI-ERROR
  3159             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3160             ADD +1  TO  WS-ERROR-COUNT.
  3161
  3162***********EXTRA INTEREST PERIODS
  3163     IF AEXTRAL GREATER THAN ZERO
  3164
  3165* EXEC CICS BIF DEEDIT
  3166*            FIELD  (AEXTRAI)
  3167*            LENGTH (1)
  3168*        END-EXEC
  3169     MOVE 1
  3170       TO DFHEIV11
  3171*    MOVE '@"L                   #   #00003077' TO DFHEIV0
  3172     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3173     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3174     MOVE X'2020233030303033303737' TO DFHEIV0(25:11)
  3175     CALL 'kxdfhei1' USING DFHEIV0,
  3176           AEXTRAI,
  3177           DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  63
* EL680.cbl
  3178     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3179         IF AEXTRAI NUMERIC
  3180             MOVE AEXTRAI        TO  WS-EXTRA
  3181                                     AEXTRAO
  3182             MOVE AL-UNNON       TO  AEXTRAA
  3183           ELSE
  3184             MOVE -1             TO  AEXTRAL
  3185             MOVE AL-UNBON       TO  AEXTRAA
  3186             MOVE ER-2924        TO  EMI-ERROR
  3187             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3188             ADD +1  TO  WS-ERROR-COUNT.
  3189
  3190***********LIFE RATE
  3191     IF ALRATEL GREATER THAN ZERO
  3192
  3193* EXEC CICS BIF DEEDIT
  3194*            FIELD  (ALRATEI)
  3195*            LENGTH (8)
  3196*        END-EXEC
  3197     MOVE 8
  3198       TO DFHEIV11
  3199*    MOVE '@"L                   #   #00003094' TO DFHEIV0
  3200     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3201     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3202     MOVE X'2020233030303033303934' TO DFHEIV0(25:11)
  3203     CALL 'kxdfhei1' USING DFHEIV0,
  3204           ALRATEI,
  3205           DFHEIV11
  3206     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3207         IF ALRATEI NUMERIC
  3208             MOVE ALRATEI        TO  WS-LIFE-RATE
  3209                                     ALRATEO
  3210             MOVE AL-UNNON       TO  ALRATEA
  3211           ELSE
  3212             MOVE -1             TO  ALRATEL
  3213             MOVE AL-UNBON       TO  ALRATEA
  3214             MOVE ER-2365        TO  EMI-ERROR
  3215             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3216             ADD +1  TO  WS-ERROR-COUNT.
  3217
  3218***********LIFE DEVIATION
  3219     IF ALFDEVL GREATER THAN ZERO
  3220
  3221* EXEC CICS BIF DEEDIT
  3222*            FIELD  (ALFDEVI)
  3223*            LENGTH (7)
  3224*        END-EXEC
  3225     MOVE 7
  3226       TO DFHEIV11
  3227*    MOVE '@"L                   #   #00003111' TO DFHEIV0
  3228     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3229     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3230     MOVE X'2020233030303033313131' TO DFHEIV0(25:11)
  3231     CALL 'kxdfhei1' USING DFHEIV0,
  3232           ALFDEVI,
  3233           DFHEIV11
  3234     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3235         IF ALFDEVI NUMERIC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  64
* EL680.cbl
  3236             MOVE ALFDEVI        TO  WS-LIFE-DEVIATION
  3237                                     ALFDEVO
  3238             MOVE AL-UNNON       TO  ALFDEVA
  3239           ELSE
  3240             MOVE -1             TO  ALFDEVL
  3241             MOVE AL-UNBON       TO  ALFDEVA
  3242             MOVE ER-2925        TO  EMI-ERROR
  3243             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3244             ADD +1  TO  WS-ERROR-COUNT
  3245     ELSE
  3246        MOVE 100 TO WS-LIFE-DEVIATION
  3247                    ALFDEVO.
  3248
  3249***********DISABILITY RATE
  3250     IF ADRATEL GREATER THAN ZERO
  3251
  3252* EXEC CICS BIF DEEDIT
  3253*            FIELD  (ADRATEI)
  3254*            LENGTH (8)
  3255*        END-EXEC
  3256     MOVE 8
  3257       TO DFHEIV11
  3258*    MOVE '@"L                   #   #00003131' TO DFHEIV0
  3259     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3260     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3261     MOVE X'2020233030303033313331' TO DFHEIV0(25:11)
  3262     CALL 'kxdfhei1' USING DFHEIV0,
  3263           ADRATEI,
  3264           DFHEIV11
  3265     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3266         IF ADRATEI NUMERIC
  3267             MOVE ADRATEI        TO  WS-AH-RATE
  3268                                     ADRATEO
  3269             MOVE AL-UNNON       TO  ADRATEA
  3270           ELSE
  3271             MOVE -1             TO  ADRATEL
  3272             MOVE AL-UNBON       TO  ADRATEA
  3273             MOVE ER-2366        TO  EMI-ERROR
  3274             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3275             ADD +1  TO  WS-ERROR-COUNT.
  3276
  3277***********AH DEVIATION
  3278     IF AAHDEVL GREATER THAN ZERO
  3279
  3280* EXEC CICS BIF DEEDIT
  3281*            FIELD  (AAHDEVI)
  3282*            LENGTH (7)
  3283*        END-EXEC
  3284     MOVE 7
  3285       TO DFHEIV11
  3286*    MOVE '@"L                   #   #00003148' TO DFHEIV0
  3287     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3288     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3289     MOVE X'2020233030303033313438' TO DFHEIV0(25:11)
  3290     CALL 'kxdfhei1' USING DFHEIV0,
  3291           AAHDEVI,
  3292           DFHEIV11
  3293     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  65
* EL680.cbl
  3294         IF AAHDEVI NUMERIC
  3295             MOVE AAHDEVI        TO  WS-AH-DEVIATION
  3296                                     AAHDEVO
  3297             MOVE AL-UNNON       TO  AAHDEVA
  3298           ELSE
  3299             MOVE -1             TO  AAHDEVL
  3300             MOVE AL-UNBON       TO  AAHDEVA
  3301             MOVE ER-2926        TO  EMI-ERROR
  3302             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3303             ADD +1  TO  WS-ERROR-COUNT
  3304     ELSE
  3305        MOVE 100 TO WS-AH-DEVIATION
  3306                    AAHDEVO.
  3307
  3308********** NO. PAYMENTS COVERED IF NOT SAME AS LIFE
  3309     IF ANOTLFL GREATER THAN ZERO
  3310
  3311* EXEC CICS BIF DEEDIT
  3312*            FIELD  (ANOTLFI)
  3313*            LENGTH (3)
  3314*        END-EXEC
  3315     MOVE 3
  3316       TO DFHEIV11
  3317*    MOVE '@"L                   #   #00003168' TO DFHEIV0
  3318     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3319     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3320     MOVE X'2020233030303033313638' TO DFHEIV0(25:11)
  3321     CALL 'kxdfhei1' USING DFHEIV0,
  3322           ANOTLFI,
  3323           DFHEIV11
  3324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3325         IF ANOTLFI NUMERIC
  3326             MOVE ANOTLFI        TO  WS-PAYMENTS-COVERED
  3327                                     ANOTLFO
  3328             MOVE AL-UNNON       TO  ANOTLFA
  3329           ELSE
  3330             MOVE -1             TO  ANOTLFL
  3331             MOVE AL-UNBON       TO  ANOTLFA
  3332             MOVE ER-2927        TO  EMI-ERROR
  3333             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3334             ADD +1  TO  WS-ERROR-COUNT.
  3335
  3336********** BALLOON AMOUNT
  3337     IF BALAMTL GREATER THAN ZERO
  3338
  3339* EXEC CICS BIF DEEDIT
  3340*            FIELD  (BALAMTI)
  3341*            LENGTH (12)
  3342*        END-EXEC
  3343     MOVE 12
  3344       TO DFHEIV11
  3345*    MOVE '@"L                   #   #00003185' TO DFHEIV0
  3346     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3347     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3348     MOVE X'2020233030303033313835' TO DFHEIV0(25:11)
  3349     CALL 'kxdfhei1' USING DFHEIV0,
  3350           BALAMTI,
  3351           DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  66
* EL680.cbl
  3352     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3353         IF BALAMTI NUMERIC
  3354             MOVE BALAMTI        TO  WS-BALLOON-AMOUNT
  3355                                     BALAMTO
  3356             MOVE AL-UNNON       TO  BALAMTA
  3357           ELSE
  3358             MOVE -1             TO  BALAMTL
  3359             MOVE AL-UNBON       TO  BALAMTA
  3360             MOVE ER-2927        TO  EMI-ERROR
  3361             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3362             ADD +1  TO  WS-ERROR-COUNT.
  3363
  3364***********BALLOON RATE
  3365     IF BLRATEL GREATER THAN ZERO
  3366
  3367* EXEC CICS BIF DEEDIT
  3368*            FIELD  (BLRATEI)
  3369*            LENGTH (8)
  3370*        END-EXEC
  3371     MOVE 8
  3372       TO DFHEIV11
  3373*    MOVE '@"L                   #   #00003202' TO DFHEIV0
  3374     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  3375     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  3376     MOVE X'2020233030303033323032' TO DFHEIV0(25:11)
  3377     CALL 'kxdfhei1' USING DFHEIV0,
  3378           BLRATEI,
  3379           DFHEIV11
  3380     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  3381         IF BLRATEI NUMERIC
  3382             MOVE BLRATEI        TO  WS-BL-RATE
  3383                                     BLRATEO
  3384             MOVE AL-UNNON       TO  BLRATEA
  3385           ELSE
  3386             MOVE -1             TO  BLRATEL
  3387             MOVE AL-UNBON       TO  BLRATEA
  3388             MOVE ER-2366        TO  EMI-ERROR
  3389             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3390             ADD +1  TO  WS-ERROR-COUNT.
  3391
  3392********** BALLOON PAYMENT COINCIDE W/LAST PAYMENT (Y/N)
  3393     IF BALYNL GREATER THAN ZERO
  3394         IF BALYNI = 'Y' OR 'N'
  3395             MOVE BALYNI         TO  WS-BALYN
  3396             MOVE AL-UANON       TO  BALYNA
  3397           ELSE
  3398             MOVE -1             TO  BALYNL
  3399             MOVE AL-UABON       TO  BALYNA
  3400             MOVE ER-2927        TO  EMI-ERROR
  3401             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3402             ADD +1  TO  WS-ERROR-COUNT.
  3403
  3404********** REGULAR PAYMENT AMOUNT
  3405*    IF BALPAYL GREATER THAN ZERO
  3406*        EXEC CICS BIF DEEDIT
  3407*            FIELD  (BALPAYI)
  3408*            LENGTH (12)
  3409*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  67
* EL680.cbl
  3410*        IF BALPAYI NUMERIC  AND
  3411*           BALPAYI NOT = ZERO
  3412*            MOVE BALPAYI        TO  WS-REGULAR-PAYMENT
  3413*                                    BALPAYO
  3414*            MOVE AL-UNNON       TO  BALPAYA
  3415*          ELSE
  3416*            MOVE -1             TO  BALPAYL
  3417*            MOVE AL-UNBON       TO  BALPAYA
  3418*            MOVE ER-2927        TO  EMI-ERROR
  3419*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  3420*            ADD +1  TO  WS-ERROR-COUNT.
  3421
  3422     IF WS-ERROR-COUNT GREATER THAN ZERO
  3423         GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  68
* EL680.cbl
  3425
  3426 4000-PERFORM-CALCULATIONS.
  3427     IF WS-FREQ = 'MO'
  3428          MOVE 12 TO PPY.
  3429     IF WS-FREQ = '13'
  3430          MOVE 13 TO PPY.
  3431     IF WS-FREQ = 'SM'
  3432          MOVE 24 TO PPY.
  3433     IF WS-FREQ = 'BW'
  3434          MOVE 26 TO PPY.
  3435     IF WS-FREQ = 'WK'
  3436          MOVE 52 TO PPY.
  3437     IF WS-FREQ = 'SA'
  3438          MOVE 2 TO PPY.
  3439     IF WS-FREQ = 'AN'
  3440          MOVE 1 TO PPY.
  3441
  3442     IF WS-BASIS-X = 'AF'
  3443          MOVE 1 TO WS-BASIS.
  3444     IF WS-BASIS-X = 'TP'
  3445          MOVE 2 TO WS-BASIS.
  3446     IF WS-BASIS-X = 'NP'
  3447          MOVE 3 TO WS-BASIS.
  3448
  3449     MOVE WS-AMOUNT-REQUESTED TO OTF.
  3450
  3451     COMPUTE I = WS-APR / (100 * PPY).
  3452
  3453     MOVE WS-ADDTL-DAYS TO ADL-DAYS.
  3454
  3455     COMPUTE ADL-ADJ = 1 + I * ADL-DAYS / (365 / PPY).
  3456
  3457     COMPUTE ATF = OTF * ADL-ADJ.
  3458
  3459     MOVE WS-TRUNC TO COV-TERM.
  3460
  3461     MOVE WS-PAYMENTS-COVERED TO AHN.
  3462
  3463     MOVE WS-NUMBER-OF-PMTS TO N.
  3464
  3465     IF AHN LESS 1
  3466         MOVE COV-TERM TO AHN.
  3467
  3468     IF AHN LESS 1
  3469         MOVE N TO AHN.
  3470
  3471     MOVE WS-EXTRA TO EMII.
  3472
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  69
* EL680.cbl
  3474
  3475 4000-CONTINUE-CALCS-1.
  3476********* M USED FOR TRUNCATED NET PAY
  3477     IF PI-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'MON' OR 'CSO'
  3478                         OR 'LGX'
  3479        IF WS-TRUNC NOT EQUAL +0
  3480           MOVE WS-TRUNC         TO M.
  3481
  3482     MOVE WS-LIFE-RATE TO LIFE-RATE.
  3483
  3484     COMPUTE LR = (LIFE-RATE / 100) * 12 / PPY.
  3485
  3486     COMPUTE LIFEDEV = WS-LIFE-DEVIATION / 100.
  3487
  3488     COMPUTE LR = LR * LIFEDEV.
  3489
  3490     MOVE WS-AH-RATE TO AH-RATE.
  3491
  3492     COMPUTE AH = AH-RATE / 100.
  3493
  3494     COMPUTE AHDEV = WS-AH-DEVIATION / 100.
  3495
  3496     COMPUTE AH = AH * AHDEV.
  3497
  3498****** BALLOON RATE
  3499     MOVE WS-BL-RATE TO BL-RATE.
  3500
  3501     COMPUTE BL = BL-RATE / 100.
  3502*******************
  3503
  3504*****  N1 USED FOR O/B
  3505     IF COV-TERM = ZERO
  3506        COMPUTE N1 = N * 12 / PPY
  3507       ELSE
  3508        COMPUTE N1 = COV-TERM * 12 / PPY.
  3509
  3510     COMPUTE K1 = 12 / PPY.
  3511
  3512     IF PPY = 1 OR 2
  3513         MOVE 1     TO K1.
  3514
  3515     COMPUTE PADJ = (N1 + K1) / (N1 + 1).
  3516
  3517     IF WS-OBYN = 'Y'
  3518        IF PI-COMPANY-ID EQUAL 'CSO' OR 'CID' OR 'LGX' OR 'AHL'
  3519              or 'FNL'
  3520        COMPUTE L = LR * PADJ * M / 12 * (N1 + 1) / 20 * 12 / N1
  3521        ELSE
  3522        COMPUTE L = LR * PADJ * N / 12 * (N1 + 1) / 20 * 12 / N1
  3523     ELSE
  3524        IF PI-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'MON' OR 'CSO'
  3525                         OR 'CID' OR 'AHL' OR 'FNL'
  3526                         OR 'LGX'
  3527           COMPUTE L = LR * PADJ * M / 12
  3528        ELSE
  3529*          COMPUTE L = LR * PADJ * N / 12.
  3530           COMPUTE L = LR * PADJ * AHN / 12.
  3531
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  70
* EL680.cbl
  3532     IF WS-BALLOON-AMOUNT NOT = ZERO
  3533         GO TO 7000-BALLOON-CALC.
  3534
  3535     COMPUTE V = 1 / (1 + I).
  3536
  3537     COMPUTE VU = 1 - V ** N.
  3538
  3539     COMPUTE ANGLN = VU / I.
  3540
  3541     IF PI-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'MON' OR 'CSO'
  3542                         OR 'CID' OR 'AHL' or 'FNL'
  3543                         OR 'LGX'
  3544        COMPUTE TOT-PMTS = I / VU * M
  3545     ELSE
  3546        COMPUTE TOT-PMTS = I / VU * N.
  3547
  3548     COMPUTE ATOT-PMTS = I / VU * AHN.
  3549
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  71
* EL680.cbl
  3551
  3552 4000-CONTINUE-CALCS-2.
  3553     GO TO 4000-COMM, 4000-COMM, 4000-NP
  3554         DEPENDING ON WS-BASIS.
  3555
  3556 4000-NP.
  3557     MOVE COV-TERM TO M.
  3558     IF M = 0
  3559        MOVE N TO M.
  3560
  3561     COMPUTE VU1 = 1 - V ** (N - M).
  3562
  3563     COMPUTE ANGLM = VU1 / I.
  3564
  3565     COMPUTE VA = (M - ANGLN + ANGLM) * 2 * N
  3566                   / (I * M * (2 * N - M + 1) * ANGLN).
  3567
  3568     IF PI-COMPANY-ID EQUAL 'CDC' OR 'GTL' OR 'MON' OR 'CSO'
  3569                         OR 'CID' OR 'AHL' OR 'FNL'
  3570                         OR 'LGX'
  3571        COMPUTE VA = VA * ((1 + N) / (1 + M)).
  3572
  3573     COMPUTE RA = 1 - (N - M) * (N - M + 1) / (N * (N + 1)).
  3574
  3575     COMPUTE TA = VA * RA.
  3576
  3577     COMPUTE NPLF = TA * L * (1 + EMII * I).
  3578
  3579     IF WS-NPBEN = 'Y'
  3580        COMPUTE NPLF = NPLF / (1 - NPLF).
  3581
  3582 4000-COMM.
  3583     MOVE ZERO TO LIFE-PREM AH-PREM.
  3584
  3585     PERFORM 4000-GET-PREMIUM THRU 4000-EXIT.
  3586     GO TO 6000-DISPLAY-RESULTS.
  3587
  3588 4000-GET-PREMIUM.
  3589     PERFORM 5000-COMPUTE-PREMIUMS THRU 5000-EXIT
  3590         VARYING XREPT FROM +1 BY +1 UNTIL XREPT = +15.
  3591 4000-EXIT.
  3592     EXIT.
  3593
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  72
* EL680.cbl
  3595
  3596 5000-COMPUTE-PREMIUMS.
  3597     GO TO 5000-AF, 5000-TP, 5000-NP
  3598         DEPENDING ON WS-BASIS.
  3599
  3600 5000-AF.
  3601     COMPUTE LIFE-PREM = L / (1 - L) * (1 + AH-PREM).
  3602     GO TO 5000-GET-AH-PREM.
  3603
  3604 5000-TP.
  3605     COMPUTE LIFE-PREM = TOT-PMTS * L / (1 - TOT-PMTS * L)
  3606                             * (1 + AH-PREM).
  3607     GO TO 5000-GET-AH-PREM.
  3608
  3609 5000-NP.
  3610     COMPUTE LIFE-PREM = NPLF * (1 + AH-PREM).
  3611     GO TO 5000-GET-AH-PREM.
  3612
  3613 5000-GET-AH-PREM.
  3614     COMPUTE AH-PREM = ATOT-PMTS * AH / (1 - ATOT-PMTS * AH)
  3615                             * (1 + LIFE-PREM).
  3616
  3617     IF AH = 0 OR
  3618        LR = 0
  3619          GO TO 4000-EXIT.
  3620
  3621 5000-EXIT.
  3622     EXIT.
  3623
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  73
* EL680.cbl
  3625
  3626 6000-DISPLAY-RESULTS.
  3627     IF CHG-LF OR CHG-LF-AH
  3628         COMPUTE L-PREMIUM = LIFE-PREM * ATF
  3629       ELSE
  3630         COMPUTE L-PREMIUM = LIFE-PREM * OTF.
  3631
  3632     COMPUTE L-PREMIUM = (L-PREMIUM * 100 + .502) / 100.
  3633
  3634     IF CHG-AH OR CHG-LF-AH
  3635         COMPUTE A-PREMIUM = AH-PREM * ATF
  3636       ELSE
  3637         COMPUTE A-PREMIUM = AH-PREM * OTF.
  3638
  3639     COMPUTE A-PREMIUM = (A-PREMIUM * 100 + .502) / 100.
  3640
  3641     COMPUTE PAYMENT = I / VU * (ATF + L-PREMIUM + A-PREMIUM).
  3642
  3643     COMPUTE PAYMENT = (PAYMENT * 100 + .002) / 100.
  3644
  3645     COMPUTE TOT-FIN = OTF + L-PREMIUM + A-PREMIUM.
  3646
  3647     COMPUTE TOT-PAYMT = N * PAYMENT.
  3648
  3649     COMPUTE TOT-INTRS = TOT-PAYMT - TOT-FIN.
  3650
  3651 6500-COMMON-DISPLAY.
  3652     MOVE TOT-FIN             TO BAMOUNTO.
  3653
  3654     MOVE L-PREMIUM           TO BLAMTO.
  3655     MOVE A-PREMIUM           TO BDAMTO.
  3656     MOVE PAYMENT             TO BMOPMTO.
  3657     MOVE TOT-PAYMT           TO BTOTPMTO.
  3658     MOVE TOT-INTRS           TO BTOTINTO.
  3659     MOVE B                   TO BALPMTO.
  3660
  3661     MOVE -1                  TO ANAMEL.
  3662     GO TO 8200-SEND-DATAONLY.
  3663
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  74
* EL680.cbl
  3665 7000-BALLOON-CALC.
  3666     MOVE WS-BALLOON-AMOUNT   TO B.
  3667*    MOVE WS-REGULAR-PAYMENT  TO MP.
  3668
  3669     COMPUTE V = 1 / (1 + I).
  3670
  3671     COMPUTE V-NTH = V ** N.
  3672
  3673     COMPUTE ANGLN = (1 - V-NTH) / I.
  3674
  3675     COMPUTE ANGLN-LESS-1 = (1 - V-NTH / V) / I.
  3676
  3677     COMPUTE NM1 = N - 1.
  3678
  3679     COMPUTE AEQ = N / (N + 1).
  3680
  3681     IF WS-BALYN = 'Y'
  3682         MOVE N TO NM1
  3683         MOVE ANGLN TO ANGLN-LESS-1
  3684         MOVE 1 TO AEQ.
  3685
  3686     IF WS-BASIS = 2
  3687         GO TO 7500-TP-BALLOON.
  3688
  3689*    IF MP NOT = ZERO
  3690*        GO TO 7200-REGULAR-PAYMENT.
  3691
  3692     COMPUTE MPT = (N + 1) / 2 * (ATF - B * V-NTH) + L * (1 + EMII
  3693                  * I) * B * ANGLN.
  3694
  3695     COMPUTE MPB = (N + 1) / 2 * (ANGLN-LESS-1 - NM1 * AH) - L
  3696                   * (1 + EMII * I) * ((NM1 - ANGLN-LESS-1) / I).
  3697
  3698     DIVIDE MPT BY MPB GIVING MP.
  3699
  3700     GO TO 8000-DISPLAY-BALLOON-RESULTS.
  3701
  3702 7200-REGULAR-PAYMENT.
  3703     COMPUTE MPB = (N + 1) / 2 * (ANGLN-LESS-1 - NM1 * AH) - L
  3704                    * (1 + EMII * I) * (NM1 - ANGLN-LESS-1) / I.
  3705
  3706     COMPUTE B = (MPB * MP - (N + 1) / 2 * ATF) / (L * (1 + EMII
  3707                   * I) * ANGLN - (N + 1) / 2 * V-NTH).
  3708
  3709     GO TO 8000-DISPLAY-BALLOON-RESULTS.
  3710
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  75
* EL680.cbl
  3712 7500-TP-BALLOON.
  3713*    IF MP NOT = ZERO
  3714*        GO TO 7600-REGULAR-PAYMENT.
  3715
  3716     COMPUTE MPT = (ATF - B * V-NTH) + L * B * 2 * N / (N + 1).
  3717
  3718     COMPUTE MPB = (ANGLN-LESS-1 - NM1 * AH) - L * NM1 * AEQ.
  3719
  3720     COMPUTE MP = MPT / MPB.
  3721
  3722     GO TO 7700-SKIP.
  3723
  3724 7600-REGULAR-PAYMENT.
  3725     COMPUTE MPB = (ANGLN-LESS-1 - NM1 * AH) - L * NM1 * AEQ.
  3726
  3727     COMPUTE B = (MPB * MP - ATF) / (L * 2 * N / (N + 1) - V-NTH).
  3728
  3729 7700-SKIP.
  3730     COMPUTE IA = MP * NM1 + B.
  3731
  3732     IF WS-BALYN = 'Y'
  3733         COMPUTE VA = 1 + B / IA * (N - 1) / (N + 1)
  3734      ELSE
  3735         COMPUTE VA = N * (IA + B) / (IA * (N + 1)).
  3736
  3737 8000-DISPLAY-BALLOON-RESULTS.
  3738     COMPUTE A-PREMIUM = NM1 * MP * AH.
  3739
  3740     IF WS-BASIS = 2
  3741        COMPUTE L-PREMIUM = L * IA * VA
  3742      ELSE
  3743        COMPUTE L-PREMIUM = MP * ANGLN-LESS-1 + B * V-NTH - ATF -
  3744                A-PREMIUM.
  3745
  3746** IF BALLOON RATE KEYED, ADD PREMIUM TO LIFE PREMIUM
  3747     IF BL GREATER ZERO
  3748         COMPUTE L-PREMIUM = L-PREMIUM + (B * BL).
  3749
  3750     COMPUTE L-PREMIUM = (L-PREMIUM * 100 + .502) / 100.
  3751
  3752     COMPUTE A-PREMIUM = (A-PREMIUM * 100 + .502) / 100.
  3753
  3754     COMPUTE TOT-FIN = OTF + L-PREMIUM + A-PREMIUM.
  3755
  3756     COMPUTE MP = (MP * 100 + .002) / 100.
  3757     COMPUTE TOT-PAYMT = MP * NM1 + B.
  3758     MOVE MP TO PAYMENT.
  3759
  3760     COMPUTE TOT-INTRS = TOT-PAYMT - TOT-FIN.
  3761
  3762     GO TO 6500-COMMON-DISPLAY.
  3763
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  76
* EL680.cbl
  3765 8100-SEND-INITIAL-MAP SECTION.
  3766     MOVE LOW-VALUES             TO  EL680AI.
  3767
  3768     MOVE SAVE-DATE              TO  ADATEO.
  3769     MOVE EIBTIME                TO  WS-TIME-WORK.
  3770     MOVE WS-TIME                TO  ATIMEO.
  3771
  3772     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  3773
  3774
  3775* EXEC CICS SEND
  3776*        FROM   (EL680AI)
  3777*        MAPSET (MAPSET-NAME)
  3778*        MAP    (MAP-NAME)
  3779*        ERASE
  3780*    END-EXEC.
  3781     MOVE LENGTH OF
  3782      EL680AI
  3783       TO DFHEIV11
  3784*    MOVE '8$      T  E    H L F ,   #00003599' TO DFHEIV0
  3785     MOVE X'382420202020202054202045' TO DFHEIV0(1:12)
  3786     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3787     MOVE X'2020233030303033353939' TO DFHEIV0(25:11)
  3788     CALL 'kxdfhei1' USING DFHEIV0,
  3789           MAP-NAME,
  3790           EL680AI,
  3791           DFHEIV11,
  3792           MAPSET-NAME,
  3793           DFHEIV99,
  3794           DFHEIV99,
  3795           DFHEIV99,
  3796           DFHEIV99,
  3797           DFHEIV99,
  3798           DFHEIV99,
  3799           DFHEIV99
  3800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3801
  3802
  3803     GO TO 9100-RETURN-TRAN.
  3804
  3805 8100-EXIT.
  3806      EXIT.
  3807
  3808 8200-SEND-DATAONLY SECTION.
  3809     MOVE SAVE-DATE              TO  ADATEO.
  3810     MOVE EIBTIME                TO  WS-TIME-WORK.
  3811     MOVE WS-TIME                TO  ATIMEO.
  3812
  3813     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  3814
  3815     IF EMI-ERROR = 0
  3816        IF EIBAID = DFHPF1
  3817           MOVE SPACE            TO EIBAID
  3818           PERFORM 9000-START-PRINTER THRU 9000-EXIT
  3819           MOVE SPACES           TO SPC-FLD
  3820           MOVE SPC-FLD          TO PFENTERI
  3821           MOVE 0                TO PFENTERL
  3822           MOVE AL-UNNOF         TO PFENTERA.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  77
* EL680.cbl
  3823
  3824
  3825* EXEC CICS SEND DATAONLY
  3826*        FROM   (EL680AI)
  3827*        MAPSET (MAPSET-NAME)
  3828*        MAP    (MAP-NAME)
  3829*        CURSOR
  3830*    END-EXEC.
  3831     MOVE LENGTH OF
  3832      EL680AI
  3833       TO DFHEIV12
  3834     MOVE -1
  3835       TO DFHEIV11
  3836*    MOVE '8$D    CT       H L F ,   #00003627' TO DFHEIV0
  3837     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3838     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  3839     MOVE X'2020233030303033363237' TO DFHEIV0(25:11)
  3840     CALL 'kxdfhei1' USING DFHEIV0,
  3841           MAP-NAME,
  3842           EL680AI,
  3843           DFHEIV12,
  3844           MAPSET-NAME,
  3845           DFHEIV99,
  3846           DFHEIV99,
  3847           DFHEIV99,
  3848           DFHEIV11,
  3849           DFHEIV99,
  3850           DFHEIV99,
  3851           DFHEIV99
  3852     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3853
  3854
  3855     GO TO 9100-RETURN-TRAN.
  3856
  3857 8200-EXIT.
  3858     EXIT.
  3859
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  78
* EL680.cbl
  3861 8300-SEND-TEXT SECTION.
  3862
  3863* EXEC CICS SEND TEXT
  3864*        FROM   (LOGOFF-TEXT)
  3865*        LENGTH (LOGOFF-LENGTH)
  3866*        ERASE  FREEKB
  3867*    END-EXEC.
  3868*    MOVE '8&      T  E F  H   F -   #00003641' TO DFHEIV0
  3869     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3870     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3871     MOVE X'2020233030303033363431' TO DFHEIV0(25:11)
  3872     CALL 'kxdfhei1' USING DFHEIV0,
  3873           LOGOFF-TEXT,
  3874           LOGOFF-LENGTH,
  3875           DFHEIV99,
  3876           DFHEIV99,
  3877           DFHEIV99,
  3878           DFHEIV99,
  3879           DFHEIV99,
  3880           DFHEIV99,
  3881           DFHEIV99,
  3882           DFHEIV99,
  3883           DFHEIV99,
  3884           DFHEIV99
  3885     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3886
  3887
  3888
  3889* EXEC CICS RETURN
  3890*    END-EXEC.
  3891*    MOVE '.(                    ''   #00003647' TO DFHEIV0
  3892     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3893     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3894     MOVE X'2020233030303033363437' TO DFHEIV0(25:11)
  3895     CALL 'kxdfhei1' USING DFHEIV0,
  3896           DFHEIV99,
  3897           DFHEIV99,
  3898           DFHEIV99,
  3899           DFHEIV99,
  3900           DFHEIV99,
  3901           DFHEIV99
  3902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3903
  3904
  3905 8300-EXIT.
  3906     EXIT.
  3907
  3908 8400-NOT-FOUND.
  3909     MOVE ER-0190                TO EMI-ERROR.
  3910     PERFORM 9900-ERROR-FORMAT  THRU 9900-EXIT.
  3911     GO TO 8200-SEND-DATAONLY.
  3912
  3913 8820-TERMID-ERROR.
  3914     MOVE ER-0412                TO EMI-ERROR.
  3915     GO TO 8999-OPEN-ERROR.
  3916
  3917 8830-TRANS-ERROR.
  3918     MOVE ER-0413                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  79
* EL680.cbl
  3919     GO TO 8999-OPEN-ERROR.
  3920
  3921 8840-CNTL-NOT-OPEN.
  3922     MOVE ER-0042 TO EMI-ERROR.
  3923     GO TO 8999-OPEN-ERROR.
  3924
  3925 8800-UNAUTHORIZED-ACCESS.
  3926     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3927     GO TO 8300-SEND-TEXT.
  3928
  3929 8810-PF23.
  3930     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  3931     MOVE XCTL-005               TO PGM-NAME.
  3932     GO TO 9300-XCTL.
  3933
  3934 8999-OPEN-ERROR.
  3935     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3936     GO TO 8200-SEND-DATAONLY.
  3937
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  80
* EL680.cbl
  3939 9000-START-PRINTER.
  3940     MOVE PI-COMPANY-ID TO CNTL-COMP-ID.
  3941
  3942
  3943* EXEC CICS HANDLE CONDITION
  3944*         NOTOPEN     (8840-CNTL-NOT-OPEN)
  3945*         NOTFND      (8400-NOT-FOUND)
  3946*         TERMIDERR   (8820-TERMID-ERROR)
  3947*         TRANSIDERR  (8830-TRANS-ERROR)
  3948*    END-EXEC.
  3949*    MOVE '"$JI[\                ! # #00003687' TO DFHEIV0
  3950     MOVE X'22244A495B5C202020202020' TO DFHEIV0(1:12)
  3951     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3952     MOVE X'2320233030303033363837' TO DFHEIV0(25:11)
  3953     CALL 'kxdfhei1' USING DFHEIV0
  3954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3955
  3956
  3957     MOVE '1'        TO CNTL-REC-TYPE.
  3958     MOVE SPACES     TO CNTL-ACCESS.
  3959     MOVE +0         TO CNTL-SEQ-NO.
  3960
  3961
  3962* EXEC CICS READ
  3963*        DATASET ('ELCNTL')
  3964*        SET     (ADDRESS OF CONTROL-FILE)
  3965*        RIDFLD  (ELCNTL-KEY)
  3966*    END-EXEC.
  3967     MOVE 'ELCNTL' TO DFHEIV1
  3968*    MOVE '&"S        E          (   #00003698' TO DFHEIV0
  3969     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  3970     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3971     MOVE X'2020233030303033363938' TO DFHEIV0(25:11)
  3972     CALL 'kxdfhei1' USING DFHEIV0,
  3973           DFHEIV1,
  3974           DFHEIV20,
  3975           DFHEIV99,
  3976           ELCNTL-KEY,
  3977           DFHEIV99,
  3978           DFHEIV99,
  3979           DFHEIV99
  3980     SET ADDRESS OF CONTROL-FILE TO
  3981         DFHEIV20
  3982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3983
  3984
  3985     IF PI-COMPANY-ID = 'DMD' OR 'CID' OR 'AHL' OR 'FNL'
  3986*        MOVE EIBTRMID       TO CF-FORMS-PRINTER-ID
  3987         MOVE EL680AI        TO PI-PROGRAM-WORK-AREA
  3988
  3989* EXEC CICS START
  3990*             INTERVAL  (0)
  3991*             TRANSID   (START-TRANS-ID)
  3992*             FROM      (PROGRAM-INTERFACE-BLOCK)
  3993*             LENGTH    (PI-COMM-LENGTH)
  3994*             TERMID (CF-FORMS-PRINTER-ID)
  3995*             END-EXEC
  3996     MOVE 0 TO DFHEIV10
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  81
* EL680.cbl
  3997*    MOVE '0(ILF                 1   #00003707' TO DFHEIV0
  3998     MOVE X'3028494C4620202020202020' TO DFHEIV0(1:12)
  3999     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  4000     MOVE X'2020233030303033373037' TO DFHEIV0(25:11)
  4001     CALL 'kxdfhei1' USING DFHEIV0,
  4002           DFHEIV10,
  4003           START-TRANS-ID,
  4004           DFHEIV99,
  4005           PROGRAM-INTERFACE-BLOCK,
  4006           PI-COMM-LENGTH,
  4007           DFHEIV99,
  4008           DFHEIV99,
  4009           DFHEIV99,
  4010           DFHEIV99,
  4011           DFHEIV99,
  4012           DFHEIV99,
  4013           DFHEIV99,
  4014           DFHEIV99,
  4015           DFHEIV99,
  4016           DFHEIV99,
  4017           DFHEIV99
  4018     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  4019     ELSE
  4020
  4021* EXEC CICS START
  4022*            TRANSID(START-TRANS-ID)
  4023*            TERMID (CF-FORMS-PRINTER-ID)
  4024*            FROM   (EL680AI)
  4025*            LENGTH (426)
  4026*        END-EXEC.
  4027     MOVE 426
  4028       TO DFHEIV11
  4029*    MOVE '0( LFT                1   #00003715' TO DFHEIV0
  4030     MOVE X'3028204C4654202020202020' TO DFHEIV0(1:12)
  4031     MOVE X'202020202020202020203120' TO DFHEIV0(13:12)
  4032     MOVE X'2020233030303033373135' TO DFHEIV0(25:11)
  4033     CALL 'kxdfhei1' USING DFHEIV0,
  4034           DFHEIV99,
  4035           START-TRANS-ID,
  4036           DFHEIV99,
  4037           EL680AI,
  4038           DFHEIV11,
  4039           CF-FORMS-PRINTER-ID,
  4040           DFHEIV99,
  4041           DFHEIV99,
  4042           DFHEIV99,
  4043           DFHEIV99,
  4044           DFHEIV99,
  4045           DFHEIV99,
  4046           DFHEIV99,
  4047           DFHEIV99,
  4048           DFHEIV99,
  4049           DFHEIV99
  4050     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4051
  4052
  4053 9000-EXIT.
  4054     EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  82
* EL680.cbl
  4055
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  83
* EL680.cbl
  4057 9100-RETURN-TRAN.
  4058     MOVE    EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  4059     MOVE SCREEN-NUMBER             TO PI-CURRENT-SCREEN-NO.
  4060
  4061* EXEC CICS RETURN
  4062*        TRANSID    (TRANS-ID)
  4063*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  4064*        LENGTH     (PI-COMM-LENGTH)
  4065*    END-EXEC.
  4066*    MOVE '.(CT                  ''   #00003729' TO DFHEIV0
  4067     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  4068     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4069     MOVE X'2020233030303033373239' TO DFHEIV0(25:11)
  4070     CALL 'kxdfhei1' USING DFHEIV0,
  4071           TRANS-ID,
  4072           PROGRAM-INTERFACE-BLOCK,
  4073           PI-COMM-LENGTH,
  4074           DFHEIV99,
  4075           DFHEIV99,
  4076           DFHEIV99
  4077     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4078
  4079
  4080
  4081* GOBACK.
  4082     MOVE '9%                    "   ' TO DFHEIV0
  4083     MOVE 'EL680' TO DFHEIV1
  4084     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4085     GOBACK.
  4086
  4087 9200-RETURN-MAIN-MENU.
  4088     MOVE XCTL-626               TO PGM-NAME.
  4089     GO TO 9300-XCTL.
  4090
  4091 9300-XCTL.
  4092
  4093* EXEC CICS XCTL
  4094*        PROGRAM    (PGM-NAME)
  4095*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  4096*        LENGTH     (PI-COMM-LENGTH)
  4097*    END-EXEC.
  4098*    MOVE '.$C                   %   #00003742' TO DFHEIV0
  4099     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  4100     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  4101     MOVE X'2020233030303033373432' TO DFHEIV0(25:11)
  4102     CALL 'kxdfhei1' USING DFHEIV0,
  4103           PGM-NAME,
  4104           PROGRAM-INTERFACE-BLOCK,
  4105           PI-COMM-LENGTH,
  4106           DFHEIV99
  4107     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4108
  4109
  4110 9400-CLEAR.
  4111     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  4112     GO TO 9300-XCTL.
  4113
  4114 9500-PF12.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  84
* EL680.cbl
  4115     MOVE XCTL-010               TO PGM-NAME.
  4116     GO TO 9300-XCTL.
  4117
  4118 9600-PGMID-ERROR.
  4119
  4120* EXEC CICS HANDLE CONDITION
  4121*        PGMIDERR    (8300-SEND-TEXT)
  4122*    END-EXEC.
  4123*    MOVE '"$L                   ! $ #00003757' TO DFHEIV0
  4124     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  4125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4126     MOVE X'2420233030303033373537' TO DFHEIV0(25:11)
  4127     CALL 'kxdfhei1' USING DFHEIV0
  4128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4129
  4130
  4131     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  4132     MOVE ' '                    TO PI-ENTRY-CD-1.
  4133     MOVE XCTL-005               TO PGM-NAME.
  4134     MOVE PGM-NAME               TO LOGOFF-PGM.
  4135     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  4136     GO TO 9300-XCTL.
  4137
  4138 9700-LINK-DATE-CONVERT.
  4139
  4140* EXEC CICS LINK
  4141*        PROGRAM    ('ELDATCV')
  4142*        COMMAREA   (DATE-CONVERSION-DATA)
  4143*        LENGTH     (DC-COMM-LENGTH)
  4144*    END-EXEC.
  4145     MOVE 'ELDATCV' TO DFHEIV1
  4146*    MOVE '."C                   (   #00003769' TO DFHEIV0
  4147     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4148     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4149     MOVE X'2020233030303033373639' TO DFHEIV0(25:11)
  4150     CALL 'kxdfhei1' USING DFHEIV0,
  4151           DFHEIV1,
  4152           DATE-CONVERSION-DATA,
  4153           DC-COMM-LENGTH,
  4154           DFHEIV99,
  4155           DFHEIV99,
  4156           DFHEIV99,
  4157           DFHEIV99
  4158     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4159
  4160
  4161 9700-EXIT.
  4162     EXIT.
  4163
  4164 9900-ERROR-FORMAT.
  4165     IF NOT EMI-ERRORS-COMPLETE
  4166         MOVE LINK-001           TO PGM-NAME
  4167
  4168* EXEC CICS LINK
  4169*            PROGRAM    (PGM-NAME)
  4170*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  4171*            LENGTH     (EMI-COMM-LENGTH)
  4172*        END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  85
* EL680.cbl
  4173*    MOVE '."C                   (   #00003781' TO DFHEIV0
  4174     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4175     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4176     MOVE X'2020233030303033373831' TO DFHEIV0(25:11)
  4177     CALL 'kxdfhei1' USING DFHEIV0,
  4178           PGM-NAME,
  4179           ERROR-MESSAGE-INTERFACE-BLOCK,
  4180           EMI-COMM-LENGTH,
  4181           DFHEIV99,
  4182           DFHEIV99,
  4183           DFHEIV99,
  4184           DFHEIV99
  4185     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4186
  4187
  4188 9900-EXIT.
  4189     EXIT.
  4190
  4191 9990-ABEND.
  4192     MOVE LINK-004               TO PGM-NAME.
  4193     MOVE DFHEIBLK               TO EMI-LINE1.
  4194
  4195
  4196* EXEC CICS LINK
  4197*        PROGRAM   (PGM-NAME)
  4198*        COMMAREA  (EMI-LINE1)
  4199*        LENGTH    (72)
  4200*    END-EXEC.
  4201     MOVE 72
  4202       TO DFHEIV11
  4203*    MOVE '."C                   (   #00003794' TO DFHEIV0
  4204     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  4205     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  4206     MOVE X'2020233030303033373934' TO DFHEIV0(25:11)
  4207     CALL 'kxdfhei1' USING DFHEIV0,
  4208           PGM-NAME,
  4209           EMI-LINE1,
  4210           DFHEIV11,
  4211           DFHEIV99,
  4212           DFHEIV99,
  4213           DFHEIV99,
  4214           DFHEIV99
  4215     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4216
  4217
  4218     GO TO 8200-SEND-DATAONLY.
  4219
  4220
  4221 9999-DFHBACK SECTION.
  4222     MOVE '9%                    "   ' TO DFHEIV0
  4223     MOVE 'EL680' TO DFHEIV1
  4224     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4225     GOBACK.
  4226 9999-DFHEXIT.
  4227     IF DFHEIGDJ EQUAL 0001
  4228         NEXT SENTENCE
  4229     ELSE IF DFHEIGDJ EQUAL 2
  4230         GO TO 8100-SEND-INITIAL-MAP
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 09:42 Page  86
* EL680.cbl
  4231         DEPENDING ON DFHEIGDI
  4232     ELSE IF DFHEIGDJ EQUAL 3
  4233         GO TO 8840-CNTL-NOT-OPEN,
  4234               8400-NOT-FOUND,
  4235               8820-TERMID-ERROR,
  4236               8830-TRANS-ERROR
  4237         DEPENDING ON DFHEIGDI
  4238     ELSE IF DFHEIGDJ EQUAL 4
  4239         GO TO 8300-SEND-TEXT
  4240         DEPENDING ON DFHEIGDI.
  4241     MOVE '9%                    "   ' TO DFHEIV0
  4242     MOVE 'EL680' TO DFHEIV1
  4243     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  4244     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4864     Code:       10755
