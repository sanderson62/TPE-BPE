* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page   1
* EL153.cbl
* Options: int("EL153.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL153.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL153.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL153.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL153 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 06/20/94 09:17:09.
     7*                            VMOD=2.019
     8*
     9*
    10*AUTHOR.    LOGIC, INC.
    11*           DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page   2
* EL153.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC, INC.     *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS.
    26*    SCREENS     - EL153S - NOTES AND REMINDERS
    27
    28*    ENTERED BY  - EL150 - STATUS AND DISPOSITION
    29
    30*    EXIT TO     - EL150 - CALLING PROGRAM
    31
    32*    INPUT FILE  - ELMSTR - CLAIM MASTER
    33*                - ELTRLR - ACTIVITY TRAILERS
    34
    35*    OUTPUT FILE - ELMSTR - CLAIM MASTER
    36*                - ELTRLR - ACTIVITY TRAILERS
    37
    38*    COMMAREA    - PASSED CLAIM NUMBER FROM PROG INTERFACE BLK
    39
    40*    ERROR-CODES ACCESSED - 132, 314, 133, 137, 29, 50, 315,
    41*                            316, 317, 08
    42*    NARRATIVE   - PROVIDE CREATION OF AUTO-PROMPT-TRAILER
    43*                  AND GENERAL-INFO-TRAILER
    44*                  IF THE AUTO PROMPT DATE GIVEN  IS LOWER
    45*                  THAN THE NEXT-REMINDER DATE OF THE CLAIM MASTER
    46*                  THIS FIELD IS UPDATED IN THE CLAIM MASTER
    47
    48******************************************************************
    49*                   C H A N G E   L O G
    50*
    51* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    52*-----------------------------------------------------------------
    53*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    54* EFFECTIVE    NUMBER
    55*-----------------------------------------------------------------
    56* 031102    2002022100003  SMVA  ADD CERT# TO EL153A SCREEN HEADER
    57* 062602    2002030700006  PEMA  Add note type of 'S'
    58*                                  (special review)
    59* 080106    2006052500001  AJRA  ADD NOTE TYPE 'N'(NOTE AND FILE)
    60* 030612  CR2011120900003  AJRA  ADD AHL COMPANY CODE
    61* 102418  CR2018083000001  TANA  ADD NEW CALL TYPE
    62* 062121  CR2021021600001  PEMA  ADD PROCESSING FOR NEW COMP FNL
    63******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page   3
* EL153.cbl
    65 ENVIRONMENT DIVISION.
    66
    67 DATA DIVISION.
    68
    69 WORKING-STORAGE SECTION.
    70 01  DFH-START PIC X(04).
    71
    72 77  FILLER  PIC X(32)  VALUE '********************************'.
    73 77  FILLER  PIC X(32)  VALUE '*   EL153  WORKING STORAGE     *'.
    74 77  FILLER  PIC X(32)  VALUE '*********** VMOD=2.019 *********'.
    75
    76*                                    COPY ELCSCTM.
    77******************************************************************
    78*                                                                *
    79*                                                                *
    80*                            ELCSCTM                             *
    81*                            VMOD=2.001                          *
    82*                                                                *
    83*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    84*                                                                *
    85******************************************************************
    86 01  SECURITY-MESSAGE.
    87     12  FILLER                          PIC X(30)
    88            VALUE '** LOGIC SECURITY VIOLATION -'.
    89     12  SM-READ                         PIC X(6).
    90     12  FILLER                          PIC X(5)
    91            VALUE ' PGM='.
    92     12  SM-PGM                          PIC X(6).
    93     12  FILLER                          PIC X(5)
    94            VALUE ' OPR='.
    95     12  SM-PROCESSOR-ID                 PIC X(4).
    96     12  FILLER                          PIC X(6)
    97            VALUE ' TERM='.
    98     12  SM-TERMID                       PIC X(4).
    99     12  FILLER                          PIC XX   VALUE SPACE.
   100     12  SM-JUL-DATE                     PIC 9(5).
   101     12  FILLER                          PIC X    VALUE SPACE.
   102     12  SM-TIME                         PIC 99.99.
   103
   104
   105*                                    COPY ELCSCRTY.
   106******************************************************************
   107*                                                                *
   108*                                                                *
   109*                            ELCSCRTY                            *
   110*                            VMOD=2.001                          *
   111*                                                                *
   112*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   113*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   114*        SAVED IN PI-SECURITY-ADDRESS.                           *
   115*                                                                *
   116******************************************************************
   117 01  SECURITY-CONTROL.
   118     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   119     12  FILLER                       PIC XX    VALUE 'SC'.
   120     12  SC-CREDIT-CODES.
   121         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   122             20  SC-CREDIT-DISPLAY    PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page   4
* EL153.cbl
   123             20  SC-CREDIT-UPDATE     PIC X.
   124     12  SC-CLAIMS-CODES.
   125         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   126             20  SC-CLAIMS-DISPLAY    PIC X.
   127             20  SC-CLAIMS-UPDATE     PIC X.
   128
   129 01  WS-DATE-AREA.
   130     12  SAVE-DATE                   PIC X(8)    VALUE SPACES.
   131     12  SAVE-BIN-DATE               PIC XX      VALUE SPACES.
   132     12  CURRENT-PLUS3-SAVE          PIC XX      VALUE SPACES.
   133
   134 01  WS-SCRATCH-AREA.
   135     12  GETMAIN-SPACE               PIC X       VALUE SPACE.
   136     12  WS-TRLR-LENGTH              PIC S9(4)   VALUE +200  COMP.
   137     12  SC-ITEM                     PIC S9(4)   VALUE +0001 COMP.
   138
   139     12  WS-JOURNAL-TYPE-ID          PIC XX      VALUE 'EL'.
   140
   141     12  WS-CURSOR                   PIC S9(4)   VALUE -1    COMP.
   142
   143     12  WS-MAP-NAME                 PIC X(8)    VALUE 'EL153A'.
   144     12  WS-MAPSET-NAME              PIC X(8)    VALUE 'EL153S'.
   145
   146     12  WS-TRANS-ID                 PIC X(4)    VALUE 'EX26'.
   147     12  THIS-PGM                    PIC X(8)    VALUE  'EL153'.
   148
   149     12  TIME-OUT.
   150         16  WS-TRANS-HOUR           PIC XX      VALUE SPACE.
   151         16  FILLER                  PIC X       VALUE '.'.
   152         16  WS-TRANS-MINUTE         PIC XX      VALUE SPACE.
   153
   154     12  WS-DATE-UNEDIT.
   155         16  FILLER                  PIC XX.
   156         16  WS-DATE-MDY.
   157             20  WS-DATE-MM          PIC XX.
   158             20  WS-DATE-DD          PIC XX.
   159             20  WS-DATE-YY          PIC XX.
   160
   161     12  WS-STR-DATE-BIN             PIC XX      VALUE LOW-VALUES.
   162     12  WS-END-DATE-BIN             PIC XX      VALUE LOW-VALUES.
   163
   164     12  SUB                         PIC S99     VALUE ZEROS.
   165     12  SUB-1                       PIC S99     VALUE ZEROS.
   166
   167     12  WS-FIRST-TIME-SW            PIC X       VALUE 'Y'.
   168
   169     12  WS-EDIT-NOTE.
   170         16  WS-EDIT-NOTE-1-4.
   171             20  WS-EDIT-NOTE-1-3    PIC X(3).
   172             20  FILLER              PIC X.
   173         16  FILLER                  PIC X(56).
   174
   175     12  WS-DATE-ERROR-SW            PIC X       VALUE SPACE.
   176         88  DATE-ERROR                          VALUE 'X'.
   177
   178     12  W-NOTE-TYPE                 PIC X       VALUE SPACE.
   179     12  W-CALL-TYPE                 PIC X       VALUE SPACE.
   180     12  W-NOTE-TYPE-IND             PIC X       VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page   5
* EL153.cbl
   181
   182     12  TIME-IN                     PIC S9(7).
   183     12  WS-TIME  REDEFINES TIME-IN.
   184         16  FILLER                  PIC 9.
   185         16  WS-HOUR                 PIC 99.
   186         16  WS-MINUTE               PIC 99.
   187         16  FILLER                  PIC 99.
   188
   189     12  WS-TRAILER-KEY.
   190         16  WS-CLAIM-KEY.
   191             20  WS-KEY-COMPANY-CD       PIC X.
   192             20  WS-KEY-CARRIER          PIC X.
   193             20  WS-KEY-CLAIM-NO         PIC X(7).
   194             20  WS-KEY-CERT-NO.
   195                 24  WS-KEY-CERT-PRIME   PIC X(10).
   196                 24  WS-KEY-CERT-SFX     PIC X.
   197         16  WS-KEY-SEQUENCE-NO          PIC S9(4) COMP.
   198
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page   6
* EL153.cbl
   200 01  ERROR-MESSAGES.
   201     12  ER-0000                     PIC X(4)    VALUE '0000'.
   202     12  ER-0004                     PIC X(4)    VALUE '0004'.
   203     12  ER-0008                     PIC X(4)    VALUE '0008'.
   204     12  ER-0029                     PIC X(4)    VALUE '0029'.
   205     12  ER-0050                     PIC X(4)    VALUE '0050'.
   206     12  ER-0070                     PIC X(4)    VALUE '0070'.
   207     12  ER-0132                     PIC X(4)    VALUE '0132'.
   208     12  ER-0133                     PIC X(4)    VALUE '0133'.
   209     12  ER-0137                     PIC X(4)    VALUE '0137'.
   210     12  ER-0154                     PIC X(4)    VALUE '0154'.
   211     12  ER-0172                     PIC X(4)    VALUE '0172'.
   212     12  ER-0314                     PIC X(4)    VALUE '0314'.
   213     12  ER-0316                     PIC X(4)    VALUE '0316'.
   214     12  ER-0317                     PIC X(4)    VALUE '0317'.
   215     12  ER-0483                     PIC X(4)    VALUE '0483'.
   216     12  ER-0694                     PIC X(4)    VALUE '0694'.
   217     12  ER-0914                     PIC X(4)    VALUE '0914'.
   218     12  ER-0915                     PIC X(4)    VALUE '0915'.
   219     12  ER-0916                     PIC X(4)    VALUE '0916'.
   220     12  ER-0917                     PIC X(4)    VALUE '0917'.
   221     12  ER-0924                     PIC X(4)    VALUE '0924'.
   222     12  ER-7840                     PIC X(4)    VALUE '7840'.
   223     12  ER-7846                     PIC X(4)    VALUE '7846'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page   7
* EL153.cbl
   225*                                    COPY ELCAID.
   226******************************************************************
   227*                                                                *
   228*                            ELCAID.                             *
   229*                            VMOD=2.001                          *
   230*                                                                *
   231*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   232*                                                                *
   233*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   234*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   235******************************************************************
   236
   237 01  DFHAID.
   238   02  DFHNULL   PIC  X  VALUE  ' '.
   239   02  DFHENTER  PIC  X  VALUE  QUOTE.
   240   02  DFHCLEAR  PIC  X  VALUE  '_'.
   241   02  DFHPEN    PIC  X  VALUE  '='.
   242   02  DFHOPID   PIC  X  VALUE  'W'.
   243   02  DFHPA1    PIC  X  VALUE  '%'.
   244   02  DFHPA2    PIC  X  VALUE  '>'.
   245   02  DFHPA3    PIC  X  VALUE  ','.
   246   02  DFHPF1    PIC  X  VALUE  '1'.
   247   02  DFHPF2    PIC  X  VALUE  '2'.
   248   02  DFHPF3    PIC  X  VALUE  '3'.
   249   02  DFHPF4    PIC  X  VALUE  '4'.
   250   02  DFHPF5    PIC  X  VALUE  '5'.
   251   02  DFHPF6    PIC  X  VALUE  '6'.
   252   02  DFHPF7    PIC  X  VALUE  '7'.
   253   02  DFHPF8    PIC  X  VALUE  '8'.
   254   02  DFHPF9    PIC  X  VALUE  '9'.
   255   02  DFHPF10   PIC  X  VALUE  ':'.
   256   02  DFHPF11   PIC  X  VALUE  '#'.
   257   02  DFHPF12   PIC  X  VALUE  '@'.
   258   02  DFHPF13   PIC  X  VALUE  'A'.
   259   02  DFHPF14   PIC  X  VALUE  'B'.
   260   02  DFHPF15   PIC  X  VALUE  'C'.
   261   02  DFHPF16   PIC  X  VALUE  'D'.
   262   02  DFHPF17   PIC  X  VALUE  'E'.
   263   02  DFHPF18   PIC  X  VALUE  'F'.
   264   02  DFHPF19   PIC  X  VALUE  'G'.
   265   02  DFHPF20   PIC  X  VALUE  'H'.
   266   02  DFHPF21   PIC  X  VALUE  'I'.
   267*00039    02  DFHPF22   PIC  X  VALUE  'Õ'.
   268   02  DFHPF22   PIC  X  VALUE  '['.
   269   02  DFHPF23   PIC  X  VALUE  '.'.
   270   02  DFHPF24   PIC  X  VALUE  '<'.
   271   02  DFHMSRE   PIC  X  VALUE  'X'.
   272   02  DFHSTRF   PIC  X  VALUE  'h'.
   273   02  DFHTRIG   PIC  X  VALUE  '"'.
   274 01  PF-AID REDEFINES DFHAID.
   275     05  FILLER                      PIC X(8).
   276     05  PF-VALUES  OCCURS 24        PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page   8
* EL153.cbl
   278*                                    COPY ELCINTF.
   279******************************************************************
   280*                                                                *
   281*                                                                *
   282*                            ELCINTF.                            *
   283*                            VMOD=2.017                          *
   284*                                                                *
   285*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   286*                                                                *
   287*       LENGTH = 1024                                            *
   288*                                                                *
   289******************************************************************
   290*                   C H A N G E   L O G
   291*
   292* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   293*-----------------------------------------------------------------
   294*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   295* EFFECTIVE    NUMBER
   296*-----------------------------------------------------------------
   297* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   298******************************************************************
   299 01  PROGRAM-INTERFACE-BLOCK.
   300     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   301     12  PI-CALLING-PROGRAM              PIC X(8).
   302     12  PI-SAVED-PROGRAM-1              PIC X(8).
   303     12  PI-SAVED-PROGRAM-2              PIC X(8).
   304     12  PI-SAVED-PROGRAM-3              PIC X(8).
   305     12  PI-SAVED-PROGRAM-4              PIC X(8).
   306     12  PI-SAVED-PROGRAM-5              PIC X(8).
   307     12  PI-SAVED-PROGRAM-6              PIC X(8).
   308     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   309     12  PI-COMPANY-ID                   PIC XXX.
   310     12  PI-COMPANY-CD                   PIC X.
   311
   312     12  PI-COMPANY-PASSWORD             PIC X(8).
   313
   314     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   315
   316     12  PI-CONTROL-IN-PROGRESS.
   317         16  PI-CARRIER                  PIC X.
   318         16  PI-GROUPING                 PIC X(6).
   319         16  PI-STATE                    PIC XX.
   320         16  PI-ACCOUNT                  PIC X(10).
   321         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   322                                         PIC X(10).
   323         16  PI-CLAIM-CERT-GRP.
   324             20  PI-CLAIM-NO             PIC X(7).
   325             20  PI-CERT-NO.
   326                 25  PI-CERT-PRIME       PIC X(10).
   327                 25  PI-CERT-SFX         PIC X.
   328             20  PI-CERT-EFF-DT          PIC XX.
   329         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   330             20  PI-PLAN-CODE            PIC X(2).
   331             20  PI-REVISION-NUMBER      PIC X(3).
   332             20  PI-PLAN-EFF-DT          PIC X(2).
   333             20  PI-PLAN-EXP-DT          PIC X(2).
   334             20  FILLER                  PIC X(11).
   335         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page   9
* EL153.cbl
   336             20  PI-OE-REFERENCE-1.
   337                 25  PI-OE-REF-1-PRIME   PIC X(18).
   338                 25  PI-OE-REF-1-SUFF    PIC XX.
   339
   340     12  PI-SESSION-IN-PROGRESS          PIC X.
   341         88  CLAIM-SESSION                   VALUE '1'.
   342         88  CREDIT-SESSION                  VALUE '2'.
   343         88  WARRANTY-SESSION                VALUE '3'.
   344         88  MORTGAGE-SESSION                VALUE '4'.
   345         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   346
   347
   348*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   349
   350     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   351     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   352
   353     12  PI-CREDIT-USER                  PIC X.
   354         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   355         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   356
   357     12  PI-CLAIM-USER                   PIC X.
   358         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   359         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   360
   361     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   362         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   363         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   364         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   365         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   366         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   367
   368     12  PI-PROCESSOR-ID                 PIC X(4).
   369
   370     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   371
   372     12  PI-MEMBER-CAPTION               PIC X(10).
   373
   374     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   375         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   376
   377     12  PI-LIFE-OVERRIDE-L1             PIC X.
   378     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   379     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   380     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   381
   382     12  PI-AH-OVERRIDE-L1               PIC X.
   383     12  PI-AH-OVERRIDE-L2               PIC XX.
   384     12  PI-AH-OVERRIDE-L6               PIC X(6).
   385     12  PI-AH-OVERRIDE-L12              PIC X(12).
   386
   387     12  PI-NEW-SYSTEM                   PIC X(2).
   388
   389     12  PI-PRIMARY-CERT-NO              PIC X(11).
   390     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   391         88  PI-USES-PAID-TO                 VALUE '1'.
   392     12  PI-CRDTCRD-SYSTEM.
   393         16  PI-CRDTCRD-USER             PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  10
* EL153.cbl
   394             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   395             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   396         16  PI-CC-MONTH-END-DT          PIC XX.
   397     12  PI-PROCESSOR-PRINTER            PIC X(4).
   398
   399     12  PI-OE-REFERENCE-2.
   400         16  PI-OE-REF-2-PRIME           PIC X(10).
   401         16  PI-OE-REF-2-SUFF            PIC X.
   402
   403     12  PI-REM-TRM-CALC-OPTION          PIC X.
   404
   405     12  PI-LANGUAGE-TYPE                PIC X.
   406             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   407             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   408             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   409
   410     12  PI-POLICY-LINKAGE-IND           PIC X.
   411         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   412         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   413                                                   LOW-VALUES.
   414
   415     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   416     12  PI-CLAIM-PW-SESSION             PIC X(1).
   417         88  PI-CLAIM-CREDIT                 VALUE '1'.
   418         88  PI-CLAIM-CONVEN                 VALUE '2'.
   419
   420     12  PI-PROCESSOR-CSR-IND            PIC X.
   421         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   422         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   423
   424     12  FILLER                          PIC X(3).
   425
   426     12  PI-SYSTEM-LEVEL                 PIC X(145).
   427
   428     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   429         PI-SYSTEM-LEVEL.
   430
   431         16  PI-ENTRY-CODES.
   432             20  PI-ENTRY-CD-1           PIC X.
   433             20  PI-ENTRY-CD-2           PIC X.
   434
   435         16  PI-RETURN-CODES.
   436             20  PI-RETURN-CD-1          PIC X.
   437             20  PI-RETURN-CD-2          PIC X.
   438
   439         16  PI-UPDATE-STATUS-SAVE.
   440             20  PI-UPDATE-BY            PIC X(4).
   441             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   442
   443         16  PI-LOWER-CASE-LETTERS       PIC X.
   444             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   445
   446*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   447*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   448*            88  CARRIER-CLM-CNTL            VALUE '2'.
   449
   450         16  PI-CERT-ACCESS-CONTROL      PIC X.
   451             88  ST-ACCNT-CNTL               VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  11
* EL153.cbl
   452             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   453             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   454             88  ACCNT-CNTL                  VALUE '3'.
   455             88  CARR-ACCNT-CNTL             VALUE '4'.
   456
   457         16  PI-PROCESSOR-CAP-LIST.
   458             20  PI-SYSTEM-CONTROLS.
   459                24 PI-SYSTEM-DISPLAY     PIC X.
   460                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   461                24 PI-SYSTEM-MODIFY      PIC X.
   462                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   463             20  FILLER                  PIC XX.
   464             20  PI-DISPLAY-CAP          PIC X.
   465                 88  DISPLAY-CAP             VALUE 'Y'.
   466             20  PI-MODIFY-CAP           PIC X.
   467                 88  MODIFY-CAP              VALUE 'Y'.
   468             20  PI-MSG-AT-LOGON-CAP     PIC X.
   469                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   470             20  PI-FORCE-CAP            PIC X.
   471                 88  FORCE-CAP               VALUE 'Y'.
   472
   473         16  PI-PROGRAM-CONTROLS.
   474             20  PI-PGM-PRINT-OPT        PIC X.
   475             20  PI-PGM-FORMAT-OPT       PIC X.
   476             20  PI-PGM-PROCESS-OPT      PIC X.
   477             20  PI-PGM-TOTALS-OPT       PIC X.
   478
   479         16  PI-HELP-INTERFACE.
   480             20  PI-LAST-ERROR-NO        PIC X(4).
   481             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   482
   483         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   484             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   485
   486         16  PI-CR-CONTROL-IN-PROGRESS.
   487             20  PI-CR-CARRIER           PIC X.
   488             20  PI-CR-GROUPING          PIC X(6).
   489             20  PI-CR-STATE             PIC XX.
   490             20  PI-CR-ACCOUNT           PIC X(10).
   491             20  PI-CR-FIN-RESP          PIC X(10).
   492             20  PI-CR-TYPE              PIC X.
   493
   494         16  PI-CR-BATCH-NUMBER          PIC X(6).
   495
   496         16  PI-CR-MONTH-END-DT          PIC XX.
   497
   498         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   499             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   500             88  PI-ZERO-CARRIER             VALUE '1'.
   501             88  PI-ZERO-GROUPING            VALUE '2'.
   502             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   503
   504         16  PI-CARRIER-SECURITY         PIC X.
   505             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   506
   507         16  PI-ACCOUNT-SECURITY         PIC X(10).
   508             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   509             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  12
* EL153.cbl
   510
   511         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   512             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   513                                         INDEXED BY PI-ACCESS-NDX
   514                                         PIC X.
   515
   516         16  PI-GA-BILLING-CONTROL       PIC X.
   517             88  PI-GA-BILLING               VALUE '1'.
   518
   519         16  PI-MAIL-PROCESSING          PIC X.
   520             88  PI-MAIL-YES                 VALUE 'Y'.
   521
   522         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   523
   524         16  PI-AR-SYSTEM.
   525             20  PI-AR-PROCESSING-CNTL   PIC X.
   526                 88  PI-AR-PROCESSING        VALUE 'Y'.
   527             20  PI-AR-SUMMARY-CODE      PIC X(6).
   528             20  PI-AR-MONTH-END-DT      PIC XX.
   529
   530         16  PI-MP-SYSTEM.
   531             20  PI-MORTGAGE-USER            PIC X.
   532                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   533                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   534             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   535                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   536                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   537                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   538                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   539                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   540             20  PI-MP-MONTH-END-DT          PIC XX.
   541             20  PI-MP-REFERENCE-NO.
   542                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   543                 24  PI-MP-REFERENCE-SFX     PIC XX.
   544
   545         16  PI-LABEL-CONTROL            PIC X(01).
   546             88  PI-CREATE-LABELS                    VALUE 'Y'.
   547             88  PI-BYPASS-LABELS                    VALUE 'N'.
   548
   549         16  PI-BILL-GROUPING-CODE       PIC X(01).
   550             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   551
   552         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   553             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   554             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   555
   556         16  FILLER                      PIC X(14).
   557
   558     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   559******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  13
* EL153.cbl
   561*                                    COPY ELCATTR.
   562******************************************************************
   563*                                                                *
   564*                            ELCATTR.                            *
   565*                            VMOD=2.001                          *
   566*                                                                *
   567*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   568*                                                                *
   569*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   570*                                                                *
   571*                   POS 1   P=PROTECTED                          *
   572*                           U=UNPROTECTED                        *
   573*                           S=ASKIP                              *
   574*                   POS 2   A=ALPHA/NUMERIC                      *
   575*                           N=NUMERIC                            *
   576*                   POS 3   N=NORMAL                             *
   577*                           B=BRIGHT                             *
   578*                           D=DARK                               *
   579*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   580*                           OF=MODIFIED DATA TAG OFF             *
   581*                                                                *
   582*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   583******************************************************************
   584 01  ATTRIBUTE-LIST.
   585     12  AL-PABOF            PIC X       VALUE 'Y'.
   586     12  AL-PABON            PIC X       VALUE 'Z'.
   587     12  AL-PADOF            PIC X       VALUE '%'.
   588     12  AL-PADON            PIC X       VALUE '_'.
   589     12  AL-PANOF            PIC X       VALUE '-'.
   590     12  AL-PANON            PIC X       VALUE '/'.
   591     12  AL-SABOF            PIC X       VALUE '8'.
   592     12  AL-SABON            PIC X       VALUE '9'.
   593     12  AL-SADOF            PIC X       VALUE '@'.
   594     12  AL-SADON            PIC X       VALUE QUOTE.
   595     12  AL-SANOF            PIC X       VALUE '0'.
   596     12  AL-SANON            PIC X       VALUE '1'.
   597     12  AL-UABOF            PIC X       VALUE 'H'.
   598     12  AL-UABON            PIC X       VALUE 'I'.
   599     12  AL-UADOF            PIC X       VALUE '<'.
   600     12  AL-UADON            PIC X       VALUE '('.
   601     12  AL-UANOF            PIC X       VALUE ' '.
   602     12  AL-UANON            PIC X       VALUE 'A'.
   603     12  AL-UNBOF            PIC X       VALUE 'Q'.
   604     12  AL-UNBON            PIC X       VALUE 'R'.
   605     12  AL-UNDOF            PIC X       VALUE '*'.
   606     12  AL-UNDON            PIC X       VALUE ')'.
   607     12  AL-UNNOF            PIC X       VALUE '&'.
   608     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  14
* EL153.cbl
   610*                                    COPY ELCLOGOF.
   611******************************************************************
   612*                                                                *
   613*                                                                *
   614*                            ELCLOGOF.                           *
   615*                            VMOD=2.001                          *
   616*                                                                *
   617*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   618*                                                                *
   619******************************************************************
   620 01  CLASIC-LOGOFF.
   621     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   622     12  LOGOFF-TEXT.
   623         16  FILLER          PIC X(5)    VALUE SPACES.
   624         16  LOGOFF-MSG.
   625             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   626             20  FILLER      PIC X       VALUE SPACES.
   627             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   628         16  FILLER          PIC X(80)
   629           VALUE '* YOU ARE NOW LOGGED OFF'.
   630         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   631         16  FILLER          PIC X       VALUE QUOTE.
   632         16  LOGOFF-SYS-MSG  PIC X(17)
   633           VALUE 'S CLAS-IC SYSTEM '.
   634     12  TEXT-MESSAGES.
   635         16  UNACCESS-MSG    PIC X(29)
   636             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   637         16  PGMIDERR-MSG    PIC X(17)
   638             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  15
* EL153.cbl
   640*                                    COPY ELCDATE.
   641******************************************************************
   642*                                                                *
   643*                                                                *
   644*                            ELCDATE.                            *
   645*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   646*                            VMOD=2.003
   647*                                                                *
   648*                                                                *
   649*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   650*                 LENGTH = 200                                   *
   651******************************************************************
   652
   653 01  DATE-CONVERSION-DATA.
   654     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   655     12  DC-OPTION-CODE                PIC X.
   656         88  BIN-TO-GREG                VALUE ' '.
   657         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   658         88  EDIT-GREG-TO-BIN           VALUE '2'.
   659         88  YMD-GREG-TO-BIN            VALUE '3'.
   660         88  MDY-GREG-TO-BIN            VALUE '4'.
   661         88  JULIAN-TO-BIN              VALUE '5'.
   662         88  BIN-PLUS-ELAPSED           VALUE '6'.
   663         88  FIND-CENTURY               VALUE '7'.
   664         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   665         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   666         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   667         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   668         88  JULIAN-TO-BIN-3            VALUE 'C'.
   669         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   670         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   671         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   672         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   673         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   674         88  CHECK-LEAP-YEAR            VALUE 'H'.
   675         88  BIN-3-TO-GREG              VALUE 'I'.
   676         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   677         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   678         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   679         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   680         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   681         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   682         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   683         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   684         88  THREE-CHARACTER-BIN
   685                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   686         88  GREGORIAN-TO-BIN
   687                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   688         88  BIN-TO-GREGORIAN
   689                  VALUES ' ' '1' 'I' '8' 'G'.
   690         88  JULIAN-TO-BINARY
   691                  VALUES '5' 'C' 'E' 'F'.
   692     12  DC-ERROR-CODE                 PIC X.
   693         88  NO-CONVERSION-ERROR        VALUE ' '.
   694         88  DATE-CONVERSION-ERROR
   695                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   696         88  DATE-IS-ZERO               VALUE '1'.
   697         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  16
* EL153.cbl
   698         88  DATE-IS-INVALID            VALUE '3'.
   699         88  DATE1-GREATER-DATE2        VALUE '4'.
   700         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   701         88  DATE-INVALID-OPTION        VALUE '9'.
   702         88  INVALID-CENTURY            VALUE 'A'.
   703         88  ONLY-CENTURY               VALUE 'B'.
   704         88  ONLY-LEAP-YEAR             VALUE 'C'.
   705         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   706     12  DC-END-OF-MONTH               PIC X.
   707         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   708     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   709         88  USE-NORMAL-PROCESS         VALUE ' '.
   710         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   711         88  ADJUST-UP-100-YRS          VALUE '2'.
   712     12  FILLER                        PIC X.
   713     12  DC-CONVERSION-DATES.
   714         16  DC-BIN-DATE-1             PIC XX.
   715         16  DC-BIN-DATE-2             PIC XX.
   716         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   717         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   718                       DC-GREG-DATE-1-EDIT.
   719             20  DC-EDIT1-MONTH        PIC 99.
   720             20  SLASH1-1              PIC X.
   721             20  DC-EDIT1-DAY          PIC 99.
   722             20  SLASH1-2              PIC X.
   723             20  DC-EDIT1-YEAR         PIC 99.
   724         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   725         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   726                     DC-GREG-DATE-2-EDIT.
   727             20  DC-EDIT2-MONTH        PIC 99.
   728             20  SLASH2-1              PIC X.
   729             20  DC-EDIT2-DAY          PIC 99.
   730             20  SLASH2-2              PIC X.
   731             20  DC-EDIT2-YEAR         PIC 99.
   732         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   733         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   734                     DC-GREG-DATE-1-YMD.
   735             20  DC-YMD-YEAR           PIC 99.
   736             20  DC-YMD-MONTH          PIC 99.
   737             20  DC-YMD-DAY            PIC 99.
   738         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   739         16  DC-GREG-DATE-1-MDY-R REDEFINES
   740                      DC-GREG-DATE-1-MDY.
   741             20  DC-MDY-MONTH          PIC 99.
   742             20  DC-MDY-DAY            PIC 99.
   743             20  DC-MDY-YEAR           PIC 99.
   744         16  DC-GREG-DATE-1-ALPHA.
   745             20  DC-ALPHA-MONTH        PIC X(10).
   746             20  DC-ALPHA-DAY          PIC 99.
   747             20  FILLER                PIC XX.
   748             20  DC-ALPHA-CENTURY.
   749                 24 DC-ALPHA-CEN-N     PIC 99.
   750             20  DC-ALPHA-YEAR         PIC 99.
   751         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   752         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   753         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   754         16  DC-JULIAN-DATE            PIC 9(05).
   755         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  17
* EL153.cbl
   756                                       PIC 9(05).
   757         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   758             20  DC-JULIAN-YEAR        PIC 99.
   759             20  DC-JULIAN-DAYS        PIC 999.
   760         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   761         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   762         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   763     12  DATE-CONVERSION-VARIBLES.
   764         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   765         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   766             20  FILLER                PIC 9(3).
   767             20  HOLD-CEN-1-CCYY.
   768                 24  HOLD-CEN-1-CC     PIC 99.
   769                 24  HOLD-CEN-1-YY     PIC 99.
   770             20  HOLD-CEN-1-MO         PIC 99.
   771             20  HOLD-CEN-1-DA         PIC 99.
   772         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   773             20  HOLD-CEN-1-R-MO       PIC 99.
   774             20  HOLD-CEN-1-R-DA       PIC 99.
   775             20  HOLD-CEN-1-R-CCYY.
   776                 24  HOLD-CEN-1-R-CC   PIC 99.
   777                 24  HOLD-CEN-1-R-YY   PIC 99.
   778             20  FILLER                PIC 9(3).
   779         16  HOLD-CENTURY-1-X.
   780             20  FILLER                PIC X(3)  VALUE SPACES.
   781             20  HOLD-CEN-1-X-CCYY.
   782                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   783                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   784             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   785             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   786         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   787             20  HOLD-CEN-1-R-X-MO     PIC XX.
   788             20  HOLD-CEN-1-R-X-DA     PIC XX.
   789             20  HOLD-CEN-1-R-X-CCYY.
   790                 24  HOLD-CEN-1-R-X-CC PIC XX.
   791                 24  HOLD-CEN-1-R-X-YY PIC XX.
   792             20  FILLER                PIC XXX.
   793         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   794         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   795         16  DC-JULIAN-DATE-1          PIC 9(07).
   796         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   797             20  DC-JULIAN-1-CCYY.
   798                 24  DC-JULIAN-1-CC    PIC 99.
   799                 24  DC-JULIAN-1-YR    PIC 99.
   800             20  DC-JULIAN-DA-1        PIC 999.
   801         16  DC-JULIAN-DATE-2          PIC 9(07).
   802         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   803             20  DC-JULIAN-2-CCYY.
   804                 24  DC-JULIAN-2-CC    PIC 99.
   805                 24  DC-JULIAN-2-YR    PIC 99.
   806             20  DC-JULIAN-DA-2        PIC 999.
   807         16  DC-GREG-DATE-A-EDIT.
   808             20  DC-EDITA-MONTH        PIC 99.
   809             20  SLASHA-1              PIC X VALUE '/'.
   810             20  DC-EDITA-DAY          PIC 99.
   811             20  SLASHA-2              PIC X VALUE '/'.
   812             20  DC-EDITA-CCYY.
   813                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  18
* EL153.cbl
   814                 24  DC-EDITA-YEAR     PIC 99.
   815         16  DC-GREG-DATE-B-EDIT.
   816             20  DC-EDITB-MONTH        PIC 99.
   817             20  SLASHB-1              PIC X VALUE '/'.
   818             20  DC-EDITB-DAY          PIC 99.
   819             20  SLASHB-2              PIC X VALUE '/'.
   820             20  DC-EDITB-CCYY.
   821                 24  DC-EDITB-CENT     PIC 99.
   822                 24  DC-EDITB-YEAR     PIC 99.
   823         16  DC-GREG-DATE-CYMD         PIC 9(08).
   824         16  DC-GREG-DATE-CYMD-R REDEFINES
   825                              DC-GREG-DATE-CYMD.
   826             20  DC-CYMD-CEN           PIC 99.
   827             20  DC-CYMD-YEAR          PIC 99.
   828             20  DC-CYMD-MONTH         PIC 99.
   829             20  DC-CYMD-DAY           PIC 99.
   830         16  DC-GREG-DATE-MDCY         PIC 9(08).
   831         16  DC-GREG-DATE-MDCY-R REDEFINES
   832                              DC-GREG-DATE-MDCY.
   833             20  DC-MDCY-MONTH         PIC 99.
   834             20  DC-MDCY-DAY           PIC 99.
   835             20  DC-MDCY-CEN           PIC 99.
   836             20  DC-MDCY-YEAR          PIC 99.
   837    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   838        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   839    12  DC-EL310-DATE                  PIC X(21).
   840    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  19
* EL153.cbl
   842*                                    COPY ELCEMIB.
   843******************************************************************
   844*                                                                *
   845*                                                                *
   846*                            ELCEMIB.                            *
   847*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   848*                            VMOD=2.005                          *
   849*                                                                *
   850*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   851*                                                                *
   852******************************************************************
   853 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   854     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   855     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   856     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   857     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   858     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   859     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   860     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   861     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   862     12  EMI-SWITCH1             PIC X        VALUE '1'.
   863         88  EMI-NO-ERRORS                    VALUE '1'.
   864         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   865         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   866     12  EMI-SWITCH2             PIC X        VALUE '1'.
   867         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   868     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   869         88  EMI-AREA1-EMPTY                  VALUE '1'.
   870         88  EMI-AREA1-FULL                   VALUE '2'.
   871     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   872         88  EMI-AREA2-EMPTY                  VALUE '1'.
   873         88  EMI-AREA2-FULL                   VALUE '2'.
   874     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   875         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   876         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   877         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   878         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   879         88  EMI-BYPASS-FATALS                VALUE 'X'.
   880     12  EMI-ERROR-LINES.
   881         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   882         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   883         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   884         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   885             20  EMI-ERR-CODES OCCURS 10 TIMES.
   886                 24  EMI-ERR-NUM         PIC X(4).
   887                 24  EMI-FILLER          PIC X.
   888                 24  EMI-SEV             PIC X.
   889                 24  FILLER              PIC X.
   890             20  FILLER                  PIC X(02).
   891     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   892         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   893             20  EMI-ERROR-NUMBER    PIC X(4).
   894             20  EMI-FILL            PIC X.
   895             20  EMI-SEVERITY        PIC X.
   896             20  FILLER              PIC X.
   897             20  EMI-ERROR-TEXT.
   898                 24  EMI-TEXT-VARIABLE   PIC X(10).
   899                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  20
* EL153.cbl
   900     12  EMI-SEVERITY-SAVE           PIC X.
   901         88  EMI-NOTE                    VALUE 'N'.
   902         88  EMI-WARNING                 VALUE 'W'.
   903         88  EMI-FORCABLE                VALUE 'F'.
   904         88  EMI-FATAL                   VALUE 'X'.
   905     12  EMI-MESSAGE-FLAG            PIC X.
   906         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   907         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   908     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   909     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   910         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   911         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   912         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   913     12  emi-claim-no                pic x(7).
   914     12  emi-claim-type              pic x(6).
   915     12  FILLER                      PIC X(124)  VALUE SPACES.
   916     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   917     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   918     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   919     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  21
* EL153.cbl
   921*                                    COPY EL153S.
   922 01  EL153AI.
   923     05  FILLER            PIC  X(0012).
   924*    -------------------------------
   925     05  MRNDATEL PIC S9(0004) COMP.
   926     05  MRNDATEF PIC  X(0001).
   927     05  FILLER REDEFINES MRNDATEF.
   928         10  MRNDATEA PIC  X(0001).
   929     05  MRNDATEI PIC  X(0008).
   930*    -------------------------------
   931     05  MRNTIMEL PIC S9(0004) COMP.
   932     05  MRNTIMEF PIC  X(0001).
   933     05  FILLER REDEFINES MRNTIMEF.
   934         10  MRNTIMEA PIC  X(0001).
   935     05  MRNTIMEI PIC  X(0005).
   936*    -------------------------------
   937     05  MCERTL PIC S9(0004) COMP.
   938     05  MCERTF PIC  X(0001).
   939     05  FILLER REDEFINES MCERTF.
   940         10  MCERTA PIC  X(0001).
   941     05  MCERTI PIC  X(0010).
   942*    -------------------------------
   943     05  MSTRDTL PIC S9(0004) COMP.
   944     05  MSTRDTF PIC  X(0001).
   945     05  FILLER REDEFINES MSTRDTF.
   946         10  MSTRDTA PIC  X(0001).
   947     05  MSTRDTI PIC  X(0008).
   948*    -------------------------------
   949     05  MENDDTL PIC S9(0004) COMP.
   950     05  MENDDTF PIC  X(0001).
   951     05  FILLER REDEFINES MENDDTF.
   952         10  MENDDTA PIC  X(0001).
   953     05  MENDDTI PIC  X(0008).
   954*    -------------------------------
   955     05  CALLTPL PIC S9(0004) COMP.
   956     05  CALLTPF PIC  X(0001).
   957     05  FILLER REDEFINES CALLTPF.
   958         10  CALLTPA PIC  X(0001).
   959     05  CALLTPI PIC  X(0001).
   960*    -------------------------------
   961     05  NOTETPL PIC S9(0004) COMP.
   962     05  NOTETPF PIC  X(0001).
   963     05  FILLER REDEFINES NOTETPF.
   964         10  NOTETPA PIC  X(0001).
   965     05  NOTETPI PIC  X(0001).
   966*    -------------------------------
   967     05  MLINE1L PIC S9(0004) COMP.
   968     05  MLINE1F PIC  X(0001).
   969     05  FILLER REDEFINES MLINE1F.
   970         10  MLINE1A PIC  X(0001).
   971     05  MLINE1I PIC  X(0060).
   972*    -------------------------------
   973     05  MLINE2L PIC S9(0004) COMP.
   974     05  MLINE2F PIC  X(0001).
   975     05  FILLER REDEFINES MLINE2F.
   976         10  MLINE2A PIC  X(0001).
   977     05  MLINE2I PIC  X(0060).
   978*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  22
* EL153.cbl
   979     05  MLINE3L PIC S9(0004) COMP.
   980     05  MLINE3F PIC  X(0001).
   981     05  FILLER REDEFINES MLINE3F.
   982         10  MLINE3A PIC  X(0001).
   983     05  MLINE3I PIC  X(0060).
   984*    -------------------------------
   985     05  MLINE4L PIC S9(0004) COMP.
   986     05  MLINE4F PIC  X(0001).
   987     05  FILLER REDEFINES MLINE4F.
   988         10  MLINE4A PIC  X(0001).
   989     05  MLINE4I PIC  X(0060).
   990*    -------------------------------
   991     05  MLINE5L PIC S9(0004) COMP.
   992     05  MLINE5F PIC  X(0001).
   993     05  FILLER REDEFINES MLINE5F.
   994         10  MLINE5A PIC  X(0001).
   995     05  MLINE5I PIC  X(0060).
   996*    -------------------------------
   997     05  MLINE6L PIC S9(0004) COMP.
   998     05  MLINE6F PIC  X(0001).
   999     05  FILLER REDEFINES MLINE6F.
  1000         10  MLINE6A PIC  X(0001).
  1001     05  MLINE6I PIC  X(0060).
  1002*    -------------------------------
  1003     05  MLINE7L PIC S9(0004) COMP.
  1004     05  MLINE7F PIC  X(0001).
  1005     05  FILLER REDEFINES MLINE7F.
  1006         10  MLINE7A PIC  X(0001).
  1007     05  MLINE7I PIC  X(0060).
  1008*    -------------------------------
  1009     05  MLINE8L PIC S9(0004) COMP.
  1010     05  MLINE8F PIC  X(0001).
  1011     05  FILLER REDEFINES MLINE8F.
  1012         10  MLINE8A PIC  X(0001).
  1013     05  MLINE8I PIC  X(0060).
  1014*    -------------------------------
  1015     05  MLINE9L PIC S9(0004) COMP.
  1016     05  MLINE9F PIC  X(0001).
  1017     05  FILLER REDEFINES MLINE9F.
  1018         10  MLINE9A PIC  X(0001).
  1019     05  MLINE9I PIC  X(0060).
  1020*    -------------------------------
  1021     05  MLINE10L PIC S9(0004) COMP.
  1022     05  MLINE10F PIC  X(0001).
  1023     05  FILLER REDEFINES MLINE10F.
  1024         10  MLINE10A PIC  X(0001).
  1025     05  MLINE10I PIC  X(0060).
  1026*    -------------------------------
  1027     05  MLINE11L PIC S9(0004) COMP.
  1028     05  MLINE11F PIC  X(0001).
  1029     05  FILLER REDEFINES MLINE11F.
  1030         10  MLINE11A PIC  X(0001).
  1031     05  MLINE11I PIC  X(0060).
  1032*    -------------------------------
  1033     05  MLINE12L PIC S9(0004) COMP.
  1034     05  MLINE12F PIC  X(0001).
  1035     05  FILLER REDEFINES MLINE12F.
  1036         10  MLINE12A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  23
* EL153.cbl
  1037     05  MLINE12I PIC  X(0060).
  1038*    -------------------------------
  1039     05  MLINE13L PIC S9(0004) COMP.
  1040     05  MLINE13F PIC  X(0001).
  1041     05  FILLER REDEFINES MLINE13F.
  1042         10  MLINE13A PIC  X(0001).
  1043     05  MLINE13I PIC  X(0060).
  1044*    -------------------------------
  1045     05  MLINE14L PIC S9(0004) COMP.
  1046     05  MLINE14F PIC  X(0001).
  1047     05  FILLER REDEFINES MLINE14F.
  1048         10  MLINE14A PIC  X(0001).
  1049     05  MLINE14I PIC  X(0060).
  1050*    -------------------------------
  1051     05  MERMSG1L PIC S9(0004) COMP.
  1052     05  MERMSG1F PIC  X(0001).
  1053     05  FILLER REDEFINES MERMSG1F.
  1054         10  MERMSG1A PIC  X(0001).
  1055     05  MERMSG1I PIC  X(0079).
  1056*    -------------------------------
  1057     05  MERMSG2L PIC S9(0004) COMP.
  1058     05  MERMSG2F PIC  X(0001).
  1059     05  FILLER REDEFINES MERMSG2F.
  1060         10  MERMSG2A PIC  X(0001).
  1061     05  MERMSG2I PIC  X(0079).
  1062*    -------------------------------
  1063     05  MPFNUMBL PIC S9(0004) COMP.
  1064     05  MPFNUMBF PIC  X(0001).
  1065     05  FILLER REDEFINES MPFNUMBF.
  1066         10  MPFNUMBA PIC  X(0001).
  1067     05  MPFNUMBI PIC  99.
  1068*    -------------------------------
  1069     05  PFKEY4L PIC S9(0004) COMP.
  1070     05  PFKEY4F PIC  X(0001).
  1071     05  FILLER REDEFINES PFKEY4F.
  1072         10  PFKEY4A PIC  X(0001).
  1073     05  PFKEY4I PIC  X(0014).
  1074 01  EL153AO REDEFINES EL153AI.
  1075     05  FILLER            PIC  X(0012).
  1076*    -------------------------------
  1077     05  FILLER            PIC  X(0003).
  1078     05  MRNDATEO PIC  X(0008).
  1079*    -------------------------------
  1080     05  FILLER            PIC  X(0003).
  1081     05  MRNTIMEO PIC  99.99.
  1082*    -------------------------------
  1083     05  FILLER            PIC  X(0003).
  1084     05  MCERTO PIC  X(0010).
  1085*    -------------------------------
  1086     05  FILLER            PIC  X(0003).
  1087     05  MSTRDTO PIC  X(0008).
  1088*    -------------------------------
  1089     05  FILLER            PIC  X(0003).
  1090     05  MENDDTO PIC  X(0008).
  1091*    -------------------------------
  1092     05  FILLER            PIC  X(0003).
  1093     05  CALLTPO PIC  X(0001).
  1094*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  24
* EL153.cbl
  1095     05  FILLER            PIC  X(0003).
  1096     05  NOTETPO PIC  X(0001).
  1097*    -------------------------------
  1098     05  FILLER            PIC  X(0003).
  1099     05  MLINE1O PIC  X(0060).
  1100*    -------------------------------
  1101     05  FILLER            PIC  X(0003).
  1102     05  MLINE2O PIC  X(0060).
  1103*    -------------------------------
  1104     05  FILLER            PIC  X(0003).
  1105     05  MLINE3O PIC  X(0060).
  1106*    -------------------------------
  1107     05  FILLER            PIC  X(0003).
  1108     05  MLINE4O PIC  X(0060).
  1109*    -------------------------------
  1110     05  FILLER            PIC  X(0003).
  1111     05  MLINE5O PIC  X(0060).
  1112*    -------------------------------
  1113     05  FILLER            PIC  X(0003).
  1114     05  MLINE6O PIC  X(0060).
  1115*    -------------------------------
  1116     05  FILLER            PIC  X(0003).
  1117     05  MLINE7O PIC  X(0060).
  1118*    -------------------------------
  1119     05  FILLER            PIC  X(0003).
  1120     05  MLINE8O PIC  X(0060).
  1121*    -------------------------------
  1122     05  FILLER            PIC  X(0003).
  1123     05  MLINE9O PIC  X(0060).
  1124*    -------------------------------
  1125     05  FILLER            PIC  X(0003).
  1126     05  MLINE10O PIC  X(0060).
  1127*    -------------------------------
  1128     05  FILLER            PIC  X(0003).
  1129     05  MLINE11O PIC  X(0060).
  1130*    -------------------------------
  1131     05  FILLER            PIC  X(0003).
  1132     05  MLINE12O PIC  X(0060).
  1133*    -------------------------------
  1134     05  FILLER            PIC  X(0003).
  1135     05  MLINE13O PIC  X(0060).
  1136*    -------------------------------
  1137     05  FILLER            PIC  X(0003).
  1138     05  MLINE14O PIC  X(0060).
  1139*    -------------------------------
  1140     05  FILLER            PIC  X(0003).
  1141     05  MERMSG1O PIC  X(0079).
  1142*    -------------------------------
  1143     05  FILLER            PIC  X(0003).
  1144     05  MERMSG2O PIC  X(0079).
  1145*    -------------------------------
  1146     05  FILLER            PIC  X(0003).
  1147     05  MPFNUMBO PIC  X(0002).
  1148*    -------------------------------
  1149     05  FILLER            PIC  X(0003).
  1150     05  PFKEY4O PIC  X(0014).
  1151*    -------------------------------
  1152 01  EL153AI-R REDEFINES EL153AI.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  25
* EL153.cbl
  1153*    12  FILLER                      PIC X(70).
  1154     12  FILLER                      PIC X(74).
  1155     12  EL153AI-OCCURS OCCURS 14 TIMES.
  1156         16  EL153A-NOTE-LENGTH      PIC S9(4)     COMP.
  1157         16  EL153A-NOTE-ATTRB       PIC X.
  1158         16  EL153A-NOTE             PIC X(60).
  1159
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  26
* EL153.cbl
  1161****************************************************************
  1162*
  1163* Copyright (c) 2007-2013 Dell Inc.
  1164* All rights reserved.
  1165*
  1166****************************************************************
  1167 01  DFHEIV.
  1168   02  DFHEIV0               PIC X(35).
  1169   02  DFHEIV1               PIC X(08).
  1170   02  DFHEIV2               PIC X(08).
  1171   02  DFHEIV3               PIC X(08).
  1172   02  DFHEIV4               PIC X(06).
  1173   02  DFHEIV5               PIC X(04).
  1174   02  DFHEIV6               PIC X(04).
  1175   02  DFHEIV7               PIC X(02).
  1176   02  DFHEIV8               PIC X(02).
  1177   02  DFHEIV9               PIC X(01).
  1178   02  DFHEIV10              PIC S9(7) COMP-3.
  1179   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1180   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1181   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1182   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1183   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1184   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1185   02  DFHEIV17              PIC X(04).
  1186   02  DFHEIV18              PIC X(04).
  1187   02  DFHEIV19              PIC X(04).
  1188   02  DFHEIV20              USAGE IS POINTER.
  1189   02  DFHEIV21              USAGE IS POINTER.
  1190   02  DFHEIV22              USAGE IS POINTER.
  1191   02  DFHEIV23              USAGE IS POINTER.
  1192   02  DFHEIV24              USAGE IS POINTER.
  1193   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1194   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1195   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1196   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1197   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1198   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1199   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1200   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1201   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1202   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1203   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1204   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1205   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1206   02  FILLER                PIC X(02).
  1207   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1208   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1209   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1210   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1211   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1212   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1213   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1214 LINKAGE  SECTION.
  1215*****************************************************************
  1216*                                                               *
  1217* Copyright (c) 2007-2013 Dell Inc.                             *
  1218* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  27
* EL153.cbl
  1219*                                                               *
  1220*****************************************************************
  1221 01  dfheiblk.
  1222     02  eibtime          pic s9(7) comp-3.
  1223     02  eibdate          pic s9(7) comp-3.
  1224     02  eibtrnid         pic x(4).
  1225     02  eibtaskn         pic s9(7) comp-3.
  1226     02  eibtrmid         pic x(4).
  1227     02  dfheigdi         pic s9(4) comp.
  1228     02  eibcposn         pic s9(4) comp.
  1229     02  eibcalen         pic s9(4) comp.
  1230     02  eibaid           pic x(1).
  1231     02  eibfiller1       pic x(1).
  1232     02  eibfn            pic x(2).
  1233     02  eibfiller2       pic x(2).
  1234     02  eibrcode         pic x(6).
  1235     02  eibfiller3       pic x(2).
  1236     02  eibds            pic x(8).
  1237     02  eibreqid         pic x(8).
  1238     02  eibrsrce         pic x(8).
  1239     02  eibsync          pic x(1).
  1240     02  eibfree          pic x(1).
  1241     02  eibrecv          pic x(1).
  1242     02  eibsend          pic x(1).
  1243     02  eibatt           pic x(1).
  1244     02  eibeoc           pic x(1).
  1245     02  eibfmh           pic x(1).
  1246     02  eibcompl         pic x(1).
  1247     02  eibsig           pic x(1).
  1248     02  eibconf          pic x(1).
  1249     02  eiberr           pic x(1).
  1250     02  eibrldbk         pic x(1).
  1251     02  eiberrcd         pic x(4).
  1252     02  eibsynrb         pic x(1).
  1253     02  eibnodat         pic x(1).
  1254     02  eibfiller5       pic x(2).
  1255     02  eibresp          pic s9(8) comp.
  1256     02  eibresp2         pic s9(8) comp.
  1257     02  dfheigdj         pic s9(4) comp.
  1258     02  dfheigdk         pic s9(4) comp.
  1259
  1260 01  DFHCOMMAREA                     PIC X(1024).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  28
* EL153.cbl
  1262*                                    COPY ELCMSTR.
  1263******************************************************************
  1264*                                                                *
  1265*                            ELCMSTR.                            *
  1266*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1267*                            VMOD=2.012                          *
  1268*                                                                *
  1269*   FILE DESCRIPTION = CLAIM MASTER FILE                         *
  1270*                                                                *
  1271*   FILE TYPE = VSAM,KSDS                                        *
  1272*   RECORD SIZE = 350  RECFORM = FIXED                           *
  1273*                                                                *
  1274*   BASE CLUSTER = ELMSTR                         RKP=2,LEN=20   *
  1275*       ALTERNATE PATH1 = ELMSTR2 (BY NAME)       RKP=22,LEN=29  *
  1276*       ALTERNATE PATH2 = ELMSTR3 (BY SOC SEC NO) RKP=51,LEN=12  *
  1277*       ALTERNATE PATH3 = ELMSTR5 (BY CERT NO)    RKP=63,LEN=12  *
  1278*       ALTERNATE PATH4 = ELMSTR6 (BY CREDIT CARD NO)            *
  1279*                                                 RKP=75,LEN=21  *
  1280*                                                                *
  1281*   **** NOTE ****                                               *
  1282*             ANY CHANGES TO THIS COPYBOOK MUST ALSO BE          *
  1283*             IMPLEMENTED IN COPYBOOK ELCRETR (RETRIEVE MASTER)  *
  1284*                                                                *
  1285*   LOG = YES                                                    *
  1286*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1287******************************************************************
  1288*                   C H A N G E   L O G
  1289*
  1290* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1291*-----------------------------------------------------------------
  1292*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1293* EFFECTIVE    NUMBER
  1294*-----------------------------------------------------------------
  1295* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1296* 080307    2007032100001  PEMA  ADD TOTAL INTEREST PAID FIELD
  1297* 031213    2012113000002  PEMA  ADD ACCIDENT INDICATOR
  1298* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  1299* 052614    2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1300* 081817    2016100700001  TANA  ADD NBR OF EXTENSIONS
  1301* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1302******************************************************************
  1303 01  CLAIM-MASTER.
  1304     12  CL-RECORD-ID                PIC XX.
  1305         88  VALID-CL-ID         VALUE 'CL'.
  1306
  1307     12  CL-CONTROL-PRIMARY.
  1308         16  CL-COMPANY-CD           PIC X.
  1309         16  CL-CARRIER              PIC X.
  1310         16  CL-CLAIM-NO             PIC X(7).
  1311         16  CL-CERT-NO.
  1312             20  CL-CERT-PRIME       PIC X(10).
  1313             20  CL-CERT-SFX         PIC X.
  1314
  1315     12  CL-CONTROL-BY-NAME.
  1316         16  CL-COMPANY-CD-A1        PIC X.
  1317         16  CL-INSURED-LAST-NAME    PIC X(15).
  1318         16  CL-INSURED-NAME.
  1319             20  CL-INSURED-1ST-NAME PIC X(12).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  29
* EL153.cbl
  1320             20  CL-INSURED-MID-INIT PIC X.
  1321
  1322     12  CL-CONTROL-BY-SSN.
  1323         16  CL-COMPANY-CD-A2        PIC X.
  1324         16  CL-SOC-SEC-NO.
  1325             20  CL-SSN-STATE        PIC XX.
  1326             20  CL-SSN-ACCOUNT      PIC X(6).
  1327             20  CL-SSN-LN3          PIC X(3).
  1328
  1329     12  CL-CONTROL-BY-CERT-NO.
  1330         16  CL-COMPANY-CD-A4        PIC X.
  1331         16  CL-CERT-NO-A4.
  1332             20  CL-CERT-A4-PRIME    PIC X(10).
  1333             20  CL-CERT-A4-SFX      PIC X.
  1334
  1335     12  CL-CONTROL-BY-CCN.
  1336         16  CL-COMPANY-CD-A5        PIC X.
  1337         16  CL-CCN-A5.
  1338             20  CL-CCN.
  1339                 24  CL-CCN-PREFIX-A5 PIC X(4).
  1340                 24  CL-CCN-PRIME-A5 PIC X(12).
  1341             20  CL-CCN-FILLER-A5    PIC X(4).
  1342
  1343     12  CL-INSURED-PROFILE-DATA.
  1344         16  CL-INSURED-BIRTH-DT     PIC XX.
  1345         16  CL-INSURED-SEX-CD       PIC X.
  1346             88  INSURED-IS-MALE        VALUE 'M'.
  1347             88  INSURED-IS-FEMALE      VALUE 'F'.
  1348             88  INSURED-SEX-UNKNOWN    VALUE ' '.
  1349         16  CL-INSURED-OCC-CD       PIC X(6).
  1350         16  FILLER                  PIC X(5).
  1351
  1352     12  CL-PROCESSING-INFO.
  1353         16  CL-PROCESSOR-ID         PIC X(4).
  1354         16  CL-CLAIM-STATUS         PIC X.
  1355             88  CLAIM-IS-OPEN          VALUE 'O'.
  1356             88  CLAIM-IS-CLOSED        VALUE 'C'.
  1357         16  CL-CLAIM-TYPE           PIC X.
  1358*            88  AH-CLAIM               VALUE 'A'.
  1359*            88  LIFE-CLAIM             VALUE 'L'.
  1360*            88  PROPERTY-CLAIM         VALUE 'P'.
  1361*            88  IUI-CLAIM              VALUE 'I'.
  1362*            88  GAP-CLAIM              VALUE 'G'.
  1363*            88  FAMILY-LEAVE-CLAIM     VALUE 'F'.
  1364*            88  OTHER-CLAIM            VALUE 'O'.
  1365         16  CL-CLAIM-PREM-TYPE      PIC X.
  1366             88  SINGLE-PREMIUM         VALUE '1'.
  1367             88  O-B-COVERAGE           VALUE '2'.
  1368             88  OPEN-END-COVERAGE      VALUE '3'.
  1369         16  CL-INCURRED-DT          PIC XX.
  1370         16  CL-REPORTED-DT          PIC XX.
  1371         16  CL-FILE-ESTABLISH-DT    PIC XX.
  1372         16  CL-EST-END-OF-DISAB-DT  PIC XX.
  1373         16  CL-LAST-PMT-DT          PIC XX.
  1374         16  CL-LAST-PMT-AMT         PIC S9(7)V99  COMP-3.
  1375         16  CL-PAID-THRU-DT         PIC XX.
  1376         16  CL-TOTAL-PAID-AMT       PIC S9(7)V99  COMP-3.
  1377         16  CL-NO-OF-PMTS-MADE      PIC S9(3)     COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  30
* EL153.cbl
  1378         16  CL-NO-OF-DAYS-PAID      PIC S9(4)     COMP.
  1379         16  CL-PMT-CALC-METHOD      PIC X.
  1380             88  CL-360-DAY-YR          VALUE '1'.
  1381             88  CL-365-DAY-YR          VALUE '2'.
  1382             88  CL-FULL-MONTHS         VALUE '3'.
  1383         16  CL-CAUSE-CD             PIC X(6).
  1384
  1385         16  CL-PRIME-CERT-NO.
  1386             20  CL-PRIME-CERT-PRIME PIC X(10).
  1387             20  CL-PRIME-CERT-SFX   PIC X.
  1388
  1389         16  CL-SYSTEM-IDENTIFIER    PIC XX.
  1390             88  CL-CREDIT-CLAIM        VALUE 'CR'.
  1391             88  CL-CONVENIENCE-CLAIM   VALUE 'CV'.
  1392
  1393         16  CL-MICROFILM-NO         PIC X(10).
  1394         16  FILLER REDEFINES CL-MICROFILM-NO.
  1395             20  CL-BENEFIT-PERIOD   PIC 99.
  1396             20  FILLER              PIC X(8).
  1397         16  CL-PROG-FORM-TYPE       PIC X.
  1398         16  CL-LAST-ADD-ON-DT       PIC XX.
  1399
  1400         16  CL-LAST-REOPEN-DT       PIC XX.
  1401         16  CL-LAST-CLOSE-DT        PIC XX.
  1402         16  CL-LAST-CLOSE-REASON    PIC X(01).
  1403             88  FINAL-PAID             VALUE '1'.
  1404             88  CLAIM-DENIED           VALUE '2'.
  1405             88  AUTO-CLOSE             VALUE '3'.
  1406             88  MANUAL-CLOSE           VALUE '4'.
  1407             88  BENEFITS-CHANGED       VALUE 'C'.
  1408             88  SETUP-ERRORS           VALUE 'E'.
  1409         16  CL-ASSOC-CERT-SEQU      PIC S99.
  1410         16  CL-ASSOC-CERT-TOTAL     PIC S99.
  1411         16  CL-CLAIM-PAYMENT-STATUS PIC 9.
  1412             88  PAYMENT-IN-PREP        VALUE 1 THRU 9.
  1413         16  CL-TOTAL-INT-PAID       PIC S9(5)V99 COMP-3.
  1414         16  FILLER                  PIC X.
  1415
  1416     12  CL-CERTIFICATE-DATA.
  1417         16  CL-CERT-ORIGIN          PIC X.
  1418             88  CERT-WAS-ONLINE        VALUE '1'.
  1419             88  CERT-WAS-CREATED       VALUE '2'.
  1420             88  COVERAGE-WAS-ADDED     VALUE '3'.
  1421         16  CL-CERT-KEY-DATA.
  1422             20  CL-CERT-CARRIER     PIC X.
  1423             20  CL-CERT-GROUPING    PIC X(6).
  1424             20  CL-CERT-STATE       PIC XX.
  1425             20  CL-CERT-ACCOUNT.
  1426                 24  CL-CERT-ACCOUNT-PREFIX PIC X(4).
  1427                 24  CL-CERT-ACCOUNT-PRIME  PIC X(6).
  1428             20  CL-CERT-EFF-DT      PIC XX.
  1429
  1430     12  CL-STATUS-CONTROLS.
  1431         16  CL-PRIORITY-CD          PIC X.
  1432             88  CONFIDENTIAL-DATA      VALUE '8'.
  1433             88  HIGHEST-PRIORITY       VALUE '9'.
  1434         16  CL-SUPV-ATTN-CD         PIC X.
  1435             88  SUPV-NOT-REQUIRED      VALUE ' ' 'N'.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  31
* EL153.cbl
  1436             88  SUPV-IS-REQUIRED       VALUE 'Y'.
  1437         16  CL-PURGED-DT            PIC XX.
  1438         16  CL-RESTORED-DT          PIC XX.
  1439         16  CL-NEXT-AUTO-PAY-DT     PIC XX.
  1440         16  CL-NEXT-RESEND-DT       PIC XX.
  1441         16  CL-NEXT-FOLLOWUP-DT     PIC XX.
  1442         16  CL-CRITICAL-PERIOD      PIC 99.
  1443*        16  FILLER                  PIC XX.
  1444         16  CL-LAST-MAINT-DT        PIC XX.
  1445         16  CL-LAST-MAINT-USER      PIC X(4).
  1446         16  CL-LAST-MAINT-HHMMSS    PIC S9(6)     COMP-3.
  1447         16  CL-LAST-MAINT-TYPE      PIC X.
  1448             88  CLAIM-SET-UP           VALUE ' '.
  1449             88  PAYMENT-MADE           VALUE '1'.
  1450             88  LETTER-SENT            VALUE '2'.
  1451             88  MASTER-WAS-ALTERED     VALUE '3'.
  1452             88  MASTER-WAS-RESTORED    VALUE '4'.
  1453             88  INCURRED-DATE-CHANGED  VALUE '5'.
  1454             88  FILE-CONVERTED         VALUE '6'.
  1455             88  CHANGE-OF-BENEFITS     VALUE 'C'.
  1456             88  ERROR-CORRECTION       VALUE 'E'.
  1457         16  CL-RELATED-CLAIM-NO     PIC X(7).
  1458         16  CL-HISTORY-ARCHIVE-DT   PIC XX.
  1459         16  CL-BENEFICIARY          PIC X(10).
  1460         16  CL-FILE-ESTABLISHED-BY  PIC X(4).
  1461         16  CL-DENIAL-TYPE          PIC X.
  1462             88  CL-TYPE-DENIAL          VALUE '1'.
  1463             88  CL-TYPE-RESCISSION      VALUE '2'.
  1464             88  CL-TYPE-REFORMATION     VALUE '3'.
  1465             88  CL-TYPE-REF-TO-RES      VALUE '4'.
  1466             88  CL-TYPE-RECONSIDERED    VALUE '5'.
  1467         16  CL-NO-OF-EXTENSIONS     PIC 99.
  1468         16  filler                  pic x(3).
  1469*        16  CL-CRIT-PER-RECURRENT   PIC X.
  1470*        16  CL-CRIT-PER-RTW-MOS     PIC 99.
  1471*        16  CL-RTW-DT               PIC XX.
  1472
  1473     12  CL-TRAILER-CONTROLS.
  1474         16  CL-TRAILER-SEQ-CNT      PIC S9(4)     COMP.
  1475             88  CL-1ST-TRL-AVAIL       VALUE +4095.
  1476             88  CL-LAST-TRL-AVAIL      VALUE +100.
  1477             88  CL-RESV-EXP-HIST-TRLR  VALUE +0.
  1478         16  CL-LAST-INC-DT-CHANGE   PIC S9(4)     COMP.
  1479         16  FILLER                  PIC XX.
  1480         16  CL-AUTO-PAY-SEQ         PIC S9(4)     COMP.
  1481         16  CL-ADDRESS-TRAILER-CNT.
  1482             20  CL-INSURED-ADDR-CNT  PIC S9(1).
  1483                 88  NO-INSURED-AVAILABLE    VALUE ZERO.
  1484             20  CL-ACCOUNT-ADDR-CNT  PIC S9(1).
  1485                 88  ACCOUNT-IS-ONLINE       VALUE ZERO.
  1486             20  CL-BENIF-ADDR-CNT    PIC S9(1).
  1487                 88  BENEFICIARY-IS-ONLINE   VALUE ZERO.
  1488             20  CL-EMPLOYER-ADDR-CNT PIC S9(1).
  1489                 88  NO-EMPLOY-AVAILABLE     VALUE ZERO.
  1490             20  CL-DOCTOR-ADDR-CNT   PIC S9(1).
  1491                 88  NO-DOCTOR-AVAILABLE     VALUE ZERO.
  1492             20  CL-OTHER-1-ADDR-CNT  PIC S9(1).
  1493                 88  NO-OTHER-1-ADDRESSES    VALUE ZERO.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  32
* EL153.cbl
  1494             20  CL-OTHER-2-ADDR-CNT  PIC S9(1).
  1495                 88  NO-OTHER-2-ADDRESSES    VALUE ZERO.
  1496
  1497     12  CL-CV-REFERENCE-NO.
  1498         16  CL-CV-REFNO-PRIME       PIC X(18).
  1499         16  CL-CV-REFNO-SFX         PIC XX.
  1500
  1501     12  CL-FILE-LOCATION            PIC X(4).
  1502
  1503     12  CL-PROCESS-ERRORS.
  1504         16  CL-FATAL-ERROR-CNT      PIC S9(4)     COMP.
  1505             88  NO-FATAL-ERRORS        VALUE ZERO.
  1506         16  CL-FORCEABLE-ERROR-CNT  PIC S9(4)     COMP.
  1507             88  NO-FORCABLE-ERRORS     VALUE ZERO.
  1508
  1509     12  CL-PRODUCT-CD               PIC X.
  1510
  1511     12  CL-CURRENT-KEY-DATA.
  1512         16  CL-CURRENT-CARRIER      PIC X.
  1513         16  CL-CURRENT-GROUPING     PIC X(6).
  1514         16  CL-CURRENT-STATE        PIC XX.
  1515         16  CL-CURRENT-ACCOUNT      PIC X(10).
  1516
  1517     12  CL-ASSOCIATES               PIC X.
  1518         88  CL-ASSOC-NO-INTERFACE      VALUE 'A'.
  1519         88  CL-ASSOC-INTERFACE         VALUE 'I'.
  1520         88  CL-NON-ASSOC-NO-INTERFACE  VALUE 'N'.
  1521         88  CL-NON-ASSOC-INTERFACE     VALUE 'M'.
  1522
  1523     12  CL-ACTIVITY-CODE            PIC 99.
  1524     12  CL-ACTIVITY-MAINT-DT        PIC XX.
  1525     12  CL-ACTIVITY-MAINT-TYPE      PIC X(4).
  1526
  1527     12  CL-LAPSE-REPORT-CODE        PIC 9.
  1528     12  CL-LAG-REPORT-CODE          PIC 9.
  1529     12  CL-LOAN-TYPE                PIC XX.
  1530     12  CL-LEGAL-STATE              PIC XX.
  1531
  1532     12  CL-YESNOSW                  PIC X.
  1533     12  CL-ACCIDENT-CLAIM-SW        PIC X.
  1534         88  CL-ACCIDENT-NOT-SET           VALUE ' '.
  1535         88  CL-CLAIM-DUE-TO-ACCIDENT      VALUE 'Y'.
  1536         88  CL-CLAIM-NOT-DUE-TO-ACCIDENT  VALUE 'N'.
  1537     12  cl-insured-type             pic x.
  1538         88  cl-claim-on-primary         value 'P'.
  1539         88  cl-claim-on-co-borrower     value 'C'.
  1540     12  cl-benefit-expiration-dt    PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  33
* EL153.cbl
  1542*                                    COPY ELCTRLR.
  1543******************************************************************
  1544*                                                                *
  1545*                            ELCTRLR.                            *
  1546*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1547*                            VMOD=2.014                          *
  1548*                                                                *
  1549*   FILE DESCRIPTION = ACTIVITY TRAILER FILE                     *
  1550*                                                                *
  1551*   FILE TYPE = VSAM,KSDS                                        *
  1552*   RECORD SIZE = 200    RECFORM = FIXED                         *
  1553*                                                                *
  1554*   BASE CLUSTER NAME = ELTRLR             RKP=2,LEN=22          *
  1555*       ALTERNATE INDEX = NONE                                   *
  1556*                                                                *
  1557*   LOG = YES                                                    *
  1558*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1559******************************************************************
  1560*                   C H A N G E   L O G
  1561*
  1562* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1563*-----------------------------------------------------------------
  1564*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1565* EFFECTIVE    NUMBER
  1566*-----------------------------------------------------------------
  1567* 120503    2003080800002  SMVA  INITIAL SECURE PAY CHANGES
  1568* 022106    2004040700004  PEMA  ADD LIFE CLAIM INTEREST
  1569* 050506    2006030600001  AJRA  ADD DENIAL PROOF DATE
  1570* 062806    2006030600001  AJRA  ADD PAYMENT PROOF DATE
  1571* 080106    2006052500001  AJRA  ADD N AND R NOTE TYPES
  1572* 041807    2006032200004  AJRA  ADD APPROVED BY TO PAYMENT
  1573* 082807    2007032100001  PEMA  ADD INT RATE TO PMT TRLR
  1574* 101807  IR2007100100007  PEMA  EXPAND SIZE OF CLM RESERVE FLDS
  1575* 070909    2009060400001  AJRA  ADD AUTO PAY END LETTER
  1576* 040110  CR2009070600002  AJRA  ADD RESEND LETTER ID TO LETTER
  1577* 071910  CR2009122800001  PEMA  ADD EOB SWITCHES
  1578* 102610    2009122800001  AJRA  ADD STOP DATE TO LETTER
  1579* 061511    2011042000002  AJRA  ADD VFY 2ND BENE TO ADDRESS TRAIL
  1580* 020413    2012071700001  AJRA  PRINT SURVEY AND PRINT CLM FORM I
  1581* 021213    2012092400007  AJRA  CAUSAL STATE SEQUENCE NO
  1582* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  1583* 102413  CR2013100800001  AJRA  ADD SPECIAL RELEASE IND
  1584* 022614    2013050100003  AJRA  ADD CERT CANCELLED NOTE TYPE - T
  1585* 040814    2014030500002  AJRA  ADD ICD CODES
  1586* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  1587* 013017  CR2016053100001  PEMA  ACH PROCESSING
  1588* 062217  CR2017050300002  TANA  ADD AUTH RCVD
  1589* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  1590* 102418  CR2018083000001  TANA  ADD ADD NEW CALL TYPE
  1591******************************************************************
  1592 01  ACTIVITY-TRAILERS.
  1593     12  AT-RECORD-ID                    PIC XX.
  1594         88  VALID-AT-ID                       VALUE 'AT'.
  1595
  1596     12  AT-CONTROL-PRIMARY.
  1597         16  AT-COMPANY-CD               PIC X.
  1598         16  AT-CARRIER                  PIC X.
  1599         16  AT-CLAIM-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  34
* EL153.cbl
  1600         16  AT-CERT-NO.
  1601             20  AT-CERT-PRIME           PIC X(10).
  1602             20  AT-CERT-SFX             PIC X.
  1603         16  AT-SEQUENCE-NO              PIC S9(4)     COMP.
  1604             88  AT-1ST-TRL-AVAIL             VALUE +4095.
  1605             88  AT-LAST-TRL-AVAIL            VALUE +100.
  1606             88  AT-RESV-EXP-HIST-TRL         VALUE +0.
  1607             88  AT-INSURED-ADDR-TRL          VALUE +1 THRU +9.
  1608             88  AT-BENEFICIARY-ADDR-TRL      VALUE +11 THRU +19.
  1609             88  AT-ACCOUNT-ADDR-TRL          VALUE +21 THRU +29.
  1610             88  AT-PHYSICIAN-ADDR-TRL        VALUE +31 THRU +39.
  1611             88  AT-EMPLOYERS-ADDR-TRL        VALUE +41 THRU +49.
  1612             88  AT-OTHER-1-ADDR-TRL          VALUE +51 THRU +59.
  1613             88  AT-OTHER-2-ADDR-TRL          VALUE +61 THRU +69.
  1614             88  AT-DIAGNOSIS-TRL             VALUE +90.
  1615             88  AT-BENEFICIARY-TRL           VALUE +91.
  1616             88  AT-SPECIAL-REVIEW-TRL        VALUE +92.
  1617             88  AT-VFY-2ND-BENE-NOTE-TRL     VALUE +93.
  1618             88  AT-VFY-CAUSAL-STATE          VALUE +94.
  1619             88  AT-ERROR-MSGS-TRL            VALUE +95.
  1620
  1621     12  AT-TRAILER-TYPE                 PIC X.
  1622         88  RESERVE-EXPENSE-TR               VALUE '1'.
  1623         88  PAYMENT-TR                       VALUE '2'.
  1624         88  AUTO-PAY-TR                      VALUE '3'.
  1625         88  CORRESPONDENCE-TR                VALUE '4'.
  1626         88  ADDRESS-TR                       VALUE '5'.
  1627         88  GENERAL-INFO-TR                  VALUE '6'.
  1628         88  AUTO-PROMPT-TR                   VALUE '7'.
  1629         88  DENIAL-TR                        VALUE '8'.
  1630         88  INCURRED-CHG-TR                  VALUE '9'.
  1631         88  FORM-CONTROL-TR                  VALUE 'A'.
  1632
  1633     12  AT-RECORDED-DT                  PIC XX.
  1634     12  AT-RECORDED-BY                  PIC X(4).
  1635     12  AT-LAST-MAINT-HHMMSS            PIC S9(6)     COMP-3.
  1636
  1637     12  AT-TRAILER-BODY                 PIC X(165).
  1638
  1639     12  AT-RESERVE-EXPENSE-TR  REDEFINES  AT-TRAILER-BODY.
  1640         16  AT-RESERVE-CONTROLS.
  1641             20  AT-MANUAL-SW            PIC X.
  1642                 88  AT-MANUAL-RESERVES-USED VALUE '1'.
  1643             20  AT-FUTURE-SW            PIC X.
  1644                 88  AT-FUTURE-RESERVES-USED VALUE '1'.
  1645             20  AT-PTC-SW               PIC X.
  1646                 88  AT-PAY-TO-CURRENT-USED  VALUE '1'.
  1647             20  AT-IBNR-SW              PIC X.
  1648                 88  AT-IBNR-RESERVES-USED   VALUE '1'.
  1649             20  AT-PTC-LF-SW            PIC X.
  1650                 88  AT-LF-PTC-USED          VALUE '1'.
  1651             20  AT-CDT-ACCESS-METHOD    PIC X.
  1652                 88  AT-CDT-ROUND-NEAR       VALUE '1'.
  1653                 88  AT-CDT-ROUND-HIGH       VALUE '2'.
  1654                 88  AT-CDT-INTERPOLATED     VALUE '3'.
  1655             20  AT-PERCENT-OF-CDT       PIC S9(3)V99    COMP-3.
  1656         16  AT-LAST-COMPUTED-DT         PIC XX.
  1657         16  AT-FUTURE-RESERVE           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  35
* EL153.cbl
  1658         16  AT-PAY-CURRENT-RESERVE      PIC S9(7)V99    COMP-3.
  1659         16  AT-IBNR-RESERVE             PIC S9(7)V99    COMP-3.
  1660         16  AT-INITIAL-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1661         16  AT-CURRENT-MANUAL-RESERVE   PIC S9(7)V99    COMP-3.
  1662         16  AT-ITD-ADDITIONAL-RESERVE   PIC S9(7)V99    COMP-3.
  1663         16  AT-EXPENSE-CONTROLS.
  1664             20  AT-EXPENSE-METHOD       PIC X.
  1665                 88  NO-EXPENSE-CALCULATED    VALUE '1'.
  1666                 88  FLAT-DOLLAR-PER-PMT      VALUE '2'.
  1667                 88  PERCENT-OF-PMT           VALUE '3'.
  1668                 88  DOLLAR-PER-OPEN-MONTH    VALUE '4'.
  1669             20  AT-EXPENSE-PERCENT      PIC S9(3)V99    COMP-3.
  1670             20  AT-EXPENSE-DOLLAR       PIC S9(3)V99    COMP-3.
  1671         16  AT-ITD-PAID-EXPENSES        PIC S9(5)V99    COMP-3.
  1672         16  AT-ITD-CHARGEABLE-EXPENSE   PIC S9(5)V99    COMP-3.
  1673
  1674         16  AT-ITD-LIFE-REFUNDS         PIC S9(5)V99    COMP-3.
  1675         16  AT-ITD-AH-REFUNDS           PIC S9(5)V99    COMP-3.
  1676
  1677*        16  FILLER                      PIC X(53).
  1678         16  FILLER                      PIC X(47).
  1679
  1680         16  AT-RESERVES-LAST-MAINT-DT   PIC XX.
  1681         16  AT-RESERVES-LAST-UPDATED-BY PIC X(4).
  1682
  1683         16  AT-OPEN-CLOSE-HISTORY OCCURS 6 TIMES.
  1684             20  AT-OPEN-CLOSE-DATE      PIC XX.
  1685             20  AT-OPEN-CLOSE-TYPE      PIC X.
  1686*                    C = CLOSED
  1687*                    O = OPEN
  1688             20  AT-OPEN-CLOSE-REASON    PIC X(5).
  1689*                   REASONS = ALTER, AUTO, FINAL, NEW, FORCE
  1690
  1691     12  AT-PAYMENT-TR  REDEFINES  AT-TRAILER-BODY.
  1692         16  AT-PAYMENT-TYPE             PIC X.
  1693             88  PARTIAL-PAYMENT                VALUE '1'.
  1694             88  FINAL-PAYMENT                  VALUE '2'.
  1695             88  LUMP-SUM-PAYMENT               VALUE '3'.
  1696             88  ADDITIONAL-PAYMENT             VALUE '4'.
  1697             88  CHARGEABLE-EXPENSE             VALUE '5'.
  1698             88  NON-CHARGEABLE-EXPENSE         VALUE '6'.
  1699             88  VOIDED-PAYMENT                 VALUE '9'.
  1700             88  TRANSFER                       VALUE 'T'.
  1701             88  LIFE-INTEREST                  VALUE 'I'.
  1702
  1703         16  AT-CLAIM-TYPE               PIC X.
  1704             88  PAID-FOR-AH                    VALUE 'A'.
  1705             88  PAID-FOR-LIFE                  VALUE 'L'.
  1706             88  PAID-FOR-IUI                   VALUE 'I'.
  1707             88  PAID-FOR-GAP                   VALUE 'G'.
  1708             88  PAID-FOR-FAM                   VALUE 'F'.
  1709             88  PAID-FOR-OTH                   VALUE 'O'.
  1710         16  AT-CLAIM-PREM-TYPE          PIC X.
  1711             88  AT-SINGLE-PREMIUM              VALUE '1'.
  1712             88  AT-O-B-COVERAGE                VALUE '2'.
  1713             88  AT-OPEN-END-COVERAGE           VALUE '3'.
  1714         16  AT-AMOUNT-PAID              PIC S9(7)V99  COMP-3.
  1715         16  AT-CHECK-NO                 PIC X(7).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  36
* EL153.cbl
  1716         16  AT-PAID-FROM-DT             PIC XX.
  1717         16  AT-PAID-THRU-DT             PIC XX.
  1718         16  AT-DAYS-IN-PERIOD           PIC S9(4)     COMP.
  1719         16  AT-ACH-PAYMENT              PIC X.
  1720*        16  FILLER                      PIC X.
  1721         16  AT-PAYEES-NAME              PIC X(30).
  1722         16  AT-PAYMENT-ORIGIN           PIC X.
  1723             88  ONLINE-MANUAL-PMT              VALUE '1'.
  1724             88  ONLINE-AUTO-PMT                VALUE '2'.
  1725             88  OFFLINE-PMT                    VALUE '3'.
  1726         16  AT-CHECK-WRITTEN-DT         PIC XX.
  1727         16  AT-TO-BE-WRITTEN-DT         PIC XX.
  1728         16  AT-VOID-DATA.
  1729             20  AT-VOID-DT              PIC XX.
  1730*00144       20  AT-VOID-REASON          PIC X(30).
  1731             20  AT-VOID-REASON          PIC X(26).
  1732         16  AT-PMT-APPROVED-BY          PIC X(04).
  1733         16  AT-ADDL-RESERVE             PIC S9(5)V99  COMP-3.
  1734         16  AT-EXPENSE-PER-PMT          PIC S9(5)V99  COMP-3.
  1735         16  AT-INT-RATE REDEFINES AT-EXPENSE-PER-PMT
  1736                                         PIC S99V9(5)  COMP-3.
  1737         16  AT-CREDIT-INTERFACE.
  1738             20  AT-PMT-SELECT-DT        PIC XX.
  1739                 88  PAYMENT-NOT-SELECTED  VALUE LOW-VALUE.
  1740             20  AT-PMT-ACCEPT-DT        PIC XX.
  1741                 88  PAYMENT-NOT-ACCEPTED  VALUE LOW-VALUE.
  1742             20  AT-VOID-SELECT-DT       PIC XX.
  1743                 88  VOID-NOT-SELECTED     VALUE LOW-VALUE.
  1744             20  AT-VOID-ACCEPT-DT       PIC XX.
  1745                 88  VOID-NOT-ACCEPTED     VALUE LOW-VALUE.
  1746
  1747         16  AT-CHECK-QUE-CONTROL        PIC S9(8)     COMP.
  1748                 88  PAYMENT-NOT-QUEUED           VALUE ZERO.
  1749                 88  CONVERSION-PAYMENT           VALUE +99999999.
  1750         16  AT-CHECK-QUE-SEQUENCE       PIC S9(4)     COMP.
  1751
  1752         16  AT-FORCE-CONTROL            PIC X.
  1753             88  PAYMENT-WAS-FORCED           VALUE '1'.
  1754         16  AT-PREV-LAST-PMT-DT         PIC XX.
  1755         16  AT-PREV-PAID-THRU-DT        PIC XX.
  1756         16  AT-PREV-LAST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1757         16  AT-ELIMINATION-DAYS         PIC S999      COMP-3.
  1758         16  AT-DAILY-RATE               PIC S9(3)V99  COMP-3.
  1759         16  AT-BENEFIT-TYPE             PIC X.
  1760
  1761         16  AT-EXPENSE-TYPE             PIC X.
  1762         16  AT-PAYMENT-APPROVAL-SW      PIC X.
  1763
  1764         16  AT-PAYEE-TYPE-CD.
  1765             20  AT-PAYEE-TYPE           PIC X.
  1766                 88  INSURED-PAID           VALUE 'I'.
  1767                 88  BENEFICIARY-PAID       VALUE 'B'.
  1768                 88  ACCOUNT-PAID           VALUE 'A'.
  1769                 88  OTHER-1-PAID           VALUE 'O'.
  1770                 88  OTHER-2-PAID           VALUE 'Q'.
  1771                 88  DOCTOR-PAID            VALUE 'P'.
  1772                 88  EMPLOYER-PAID          VALUE 'E'.
  1773             20  AT-PAYEE-SEQ            PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  37
* EL153.cbl
  1774
  1775         16  AT-CASH-PAYMENT             PIC X.
  1776         16  AT-GROUPED-PAYMENT          PIC X.
  1777         16  AT-PAYMENT-NOTE-SEQ-NO      PIC S9(4)       COMP.
  1778         16  AT-APPROVAL-LEVEL-REQD      PIC X.
  1779         16  AT-APPROVED-LEVEL           PIC X.
  1780         16  AT-VOID-TYPE                PIC X.
  1781             88  AT-PAYMENT-WAS-STOPPED     VALUE 'S'.
  1782             88  AT-PAYMENT-WAS-VOIDED      VALUE 'V'.
  1783         16  AT-AIG-UNEMP-IND            PIC X.
  1784             88  AT-AIG-UNEMPLOYMENT-PMT    VALUE 'U'.
  1785         16  AT-ASSOCIATES               PIC X.
  1786             88  AT-AIG-INTERFACE           VALUE 'I' 'N'.
  1787             88  AT-AIG-NON-INTERFACE       VALUE 'A' 'M'.
  1788
  1789         16  AT-FORM-CTL-SEQ-NO          PIC S9(4)       COMP.
  1790         16  AT-CV-PMT-CODE              PIC X.
  1791             88  FULL-DEATH-PAYMENT         VALUE '1'.
  1792             88  HALF-DEATH-PAYMENT         VALUE '2'.
  1793             88  FULL-ADD-PAYMENT           VALUE '3'.
  1794             88  HALF-ADD-PAYMENT           VALUE '4'.
  1795             88  FULL-RIDER-PAYMENT         VALUE '5'.
  1796             88  HALF-RIDER-PAYMENT         VALUE '6'.
  1797             88  NON-CHG-EXP-PAYMENT        VALUE '7'.
  1798             88  ADDL-PAYMENT               VALUE '8'.
  1799
  1800         16  AT-EOB-CODE1                PIC XXX.
  1801         16  AT-EOB-CODE2                PIC XXX.
  1802         16  AT-EOB-CODE3                PIC XXX.
  1803         16  FILLER REDEFINES AT-EOB-CODE3.
  1804             20  AT-PRINT-CLM-FORM       PIC X.
  1805             20  AT-PRINT-SURVEY         PIC X.
  1806             20  AT-SPECIAL-RELEASE      PIC X.
  1807         16  AT-EOB-CODE4                PIC XXX.
  1808         16  FILLER REDEFINES AT-EOB-CODE4.
  1809             20  AT-INT-PMT-SELECT-DT    PIC XX.
  1810             20  FILLER                  PIC X.
  1811         16  AT-EOB-CODE5                PIC XXX.
  1812         16  FILLER REDEFINES AT-EOB-CODE5.
  1813             20  AT-PMT-PROOF-DT         PIC XX.
  1814             20  FILLER                  PIC X.
  1815
  1816         16  AT-PRINT-EOB-WITH-CHECK     PIC X.
  1817             88  AT-PRINT-EOB            VALUE 'Y'.
  1818
  1819         16  AT-PAYMENT-LAST-MAINT-DT    PIC XX.
  1820         16  AT-PAYMENT-LAST-UPDATED-BY  PIC X(4).
  1821
  1822     12  AT-AUTO-PAY-TR  REDEFINES  AT-TRAILER-BODY.
  1823         16  AT-SCHEDULE-START-DT        PIC XX.
  1824         16  AT-SCHEDULE-END-DT          PIC XX.
  1825         16  AT-TERMINATED-DT            PIC XX.
  1826         16  AT-LAST-PMT-TYPE            PIC X.
  1827             88  LAST-PMT-IS-FINAL              VALUE 'F'.
  1828             88  LAST-PMT-IS-PARTIAL            VALUE 'P'.
  1829         16  AT-FIRST-PMT-DATA.
  1830             20  AT-FIRST-PMT-AMT        PIC S9(7)V99  COMP-3.
  1831             20  AT-DAYS-IN-1ST-PMT      PIC S9(4)     COMP.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  38
* EL153.cbl
  1832             20  AT-1ST-PAY-THRU-DT      PIC XX.
  1833         16  AT-REGULAR-PMT-DATA.
  1834             20  AT-REGULAR-PMT-AMT      PIC S9(7)V99  COMP-3.
  1835             20  AT-DAYS-IN-REG-PMT      PIC S9(4)     COMP.
  1836             20  AT-INTERVAL-MONTHS      PIC S9(4)     COMP.
  1837         16  AT-AUTO-PAYEE-CD.
  1838             20  AT-AUTO-PAYEE-TYPE      PIC X.
  1839                 88  INSURED-PAID-AUTO      VALUE 'I'.
  1840                 88  BENEFICIARY-PAID-AUTO  VALUE 'B'.
  1841                 88  ACCOUNT-PAID-AUTO      VALUE 'A'.
  1842                 88  OTHER-1-PAID-AUTO      VALUE 'O'.
  1843                 88  OTHER-2-PAID-AUTO      VALUE 'Q'.
  1844             20  AT-AUTO-PAYEE-SEQ       PIC X.
  1845         16  AT-AUTO-PAY-DAY             PIC 99.
  1846         16  AT-AUTO-CASH                PIC X.
  1847             88  AT-CASH                      VALUE 'Y'.
  1848             88  AT-NON-CASH                  VALUE 'N'.
  1849*        16  FILLER                      PIC X(129).
  1850         16  AT-AUTO-END-LETTER          PIC X(4).
  1851         16  FILLER                      PIC X(125).
  1852
  1853         16  AT-AUTO-PAY-LAST-MAINT-DT   PIC XX.
  1854         16  AT-AUTO-PAY-LAST-UPDATED-BY PIC X(4).
  1855
  1856     12  AT-CORRESPONDENCE-TR  REDEFINES  AT-TRAILER-BODY.
  1857         16  AT-LETTER-SENT-DT           PIC XX.
  1858         16  AT-RECEIPT-FOLLOW-UP        PIC XX.
  1859         16  AT-AUTO-RE-SEND-DT          PIC XX.
  1860         16  AT-LETTER-ANSWERED-DT       PIC XX.
  1861         16  AT-LETTER-ARCHIVE-NO        PIC S9(8)     COMP.
  1862         16  AT-LETTER-ORIGIN            PIC X.
  1863             88  ONLINE-CREATION              VALUE '1' '3'.
  1864             88  OFFLINE-CREATION             VALUE '2' '4'.
  1865             88  NAPER-ONLINE-CREATION        VALUE '3'.
  1866             88  NAPER-OFFLINE-CREATION       VALUE '4'.
  1867         16  AT-STD-LETTER-FORM          PIC X(4).
  1868         16  AT-REASON-TEXT              PIC X(70).
  1869         16  AT-ADDRESS-REC-SEQ-NO       PIC S9(4)     COMP.
  1870         16  AT-ADDRESEE-TYPE            PIC X.
  1871              88  INSURED-ADDRESEE            VALUE 'I'.
  1872              88  BENEFICIARY-ADDRESEE        VALUE 'B'.
  1873              88  ACCOUNT-ADDRESEE            VALUE 'A'.
  1874              88  PHYSICIAN-ADDRESEE          VALUE 'P'.
  1875              88  EMPLOYER-ADDRESEE           VALUE 'E'.
  1876              88  OTHER-ADDRESEE-1            VALUE 'O'.
  1877              88  OTHER-ADDRESEE-2            VALUE 'Q'.
  1878         16  AT-ADDRESSEE-NAME           PIC X(30).
  1879         16  AT-INITIAL-PRINT-DATE       PIC XX.
  1880         16  AT-RESEND-PRINT-DATE        PIC XX.
  1881         16  AT-CORR-SOL-UNSOL           PIC X.
  1882         16  AT-LETTER-PURGED-DT         PIC XX.
  1883*
  1884*FOLLOWING CID CHGS REENTERED AS DMD CHGS OVERLAID THEM.
  1885*
  1886         16  AT-CSO-REDEFINITION.
  1887             20  AT-RESEND-LETTER-FORM   PIC X(4).
  1888             20  AT-AUTO-CLOSE-IND       PIC X(1).
  1889             20  AT-LETTER-TO-BENE       PIC X(1).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  39
* EL153.cbl
  1890             20  AT-STOP-LETTER-DT       PIC X(2).
  1891             20  AT-AUTH-RCVD            PIC X(1).
  1892             20  FILLER                  PIC X(18).
  1893*             20  FILLER                  PIC X(27).
  1894             20  AT-CSO-LETTER-STATUS    PIC X.
  1895                 88  AT-CSO-LETTER-ONLINE    VALUE '1'.
  1896                 88  AT-CSO-LETTER-PURGED    VALUE '2'.
  1897                 88  AT-CSO-LETTER-RELOADED  VALUE '3'.
  1898             20  AT-CSO-LETTER-PURGE-DATE   PIC XX.
  1899             20  AT-CSO-LETTER-RELOAD-DATE  PIC XX.
  1900*
  1901*FOLLOWING DMD CHGS COMMENTED OUT AS THEY OVERLAY CID MODS NEEDED
  1902*
  1903*        16  FILLER                      PIC X(26).
  1904*
  1905*        16  AT-DMD-BSR-CODE             PIC X.
  1906*            88  AT-AUTOMATED-BSR              VALUE 'A'.
  1907*            88  AT-NON-AUTOMATED-BSR          VALUE 'B' ' '.
  1908*
  1909*        16  AT-DMD-LETTER-STATUS        PIC X.
  1910*            88  AT-DMD-LETTER-ONLINE          VALUE '1'.
  1911*            88  AT-DMD-LETTER-PURGED          VALUE '2'.
  1912*            88  AT-DMD-LETTER-RELOADED        VALUE '3'.
  1913*        16  AT-DMD-LETTER-PURGE-DT      PIC XX.
  1914*        16  AT-DMD-LETTER-RELOAD-DT     PIC XX.
  1915
  1916         16  AT-CORR-LAST-MAINT-DT       PIC XX.
  1917         16  AT-CORR-LAST-UPDATED-BY     PIC X(4).
  1918
  1919     12  AT-ADDRESS-TR  REDEFINES  AT-TRAILER-BODY.
  1920         16  AT-ADDRESS-TYPE             PIC X.
  1921             88  INSURED-ADDRESS               VALUE 'I'.
  1922             88  BENEFICIARY-ADDRESS           VALUE 'B'.
  1923             88  ACCOUNT-ADDRESS               VALUE 'A'.
  1924             88  PHYSICIAN-ADDRESS             VALUE 'P'.
  1925             88  EMPLOYER-ADDRESS              VALUE 'E'.
  1926             88  OTHER-ADDRESS-1               VALUE 'O'.
  1927             88  OTHER-ADDRESS-2               VALUE 'Q'.
  1928         16  AT-MAIL-TO-NAME             PIC X(30).
  1929         16  AT-ADDRESS-LINE-1           PIC X(30).
  1930         16  AT-ADDRESS-LINE-2           PIC X(30).
  1931         16  AT-CITY-STATE.
  1932             20  AT-CITY                 PIC X(28).
  1933             20  AT-STATE                PIC XX.
  1934         16  AT-ZIP.
  1935             20  AT-ZIP-CODE.
  1936                 24  AT-ZIP-1ST          PIC X.
  1937                     88  AT-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  1938                 24  FILLER              PIC X(4).
  1939             20  AT-ZIP-PLUS4            PIC X(4).
  1940         16  AT-CANADIAN-POSTAL-CODE  REDEFINES  AT-ZIP.
  1941             20  AT-CAN-POSTAL-1         PIC XXX.
  1942             20  AT-CAN-POSTAL-2         PIC XXX.
  1943             20  FILLER                  PIC XXX.
  1944         16  AT-PHONE-NO                 PIC 9(11)     COMP-3.
  1945*         16  FILLER                      PIC X(23).
  1946         16  AT-VFY-2ND-BENE-SSN         PIC X(9).
  1947         16  AT-VFY-2ND-BENE-VERIFIED    PIC X.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  40
* EL153.cbl
  1948         16  FILLER                      PIC X(13).
  1949         16  AT-ADDRESS-LAST-MAINT-DT    PIC XX.
  1950         16  AT-ADDRESS-LAST-UPDATED-BY  PIC X(4).
  1951
  1952     12  AT-GENERAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1953         16  AT-INFO-LINE-1              PIC X(60).
  1954         16  FILLER REDEFINES AT-INFO-LINE-1.
  1955             20  AT-NOTE-ERROR-NO OCCURS 15
  1956                                         PIC X(4).
  1957         16  AT-INFO-LINE-2              PIC X(60).
  1958         16  FILLER REDEFINES AT-INFO-LINE-2.
  1959             20  AT-ICD-CODE-1           PIC X(8).
  1960             20  AT-ICD-CODE-2           PIC X(8).
  1961             20  FILLER                  PIC X(44).
  1962         16  AT-INFO-TRAILER-TYPE        PIC X.
  1963             88  AT-ERRORS-NOTE          VALUE 'E'.
  1964             88  AT-PAYMENT-NOTE         VALUE 'P'.
  1965             88  AT-CALL-NOTE            VALUE 'C'.
  1966             88  AT-MAINT-NOTE           VALUE 'M'.
  1967             88  AT-CERT-CHANGE          VALUE 'X'.
  1968             88  AT-APPROVAL-NOTE        VALUE 'R'.
  1969             88  AT-NOTE-FILE-NOTE       VALUE 'N'.
  1970             88  AT-CERT-CANCELLED       VALUE 'T'.
  1971         16  AT-CALL-TYPE                PIC X.
  1972             88  AT-PHONE-CALL-IN        VALUE 'I'.
  1973             88  AT-PHONE-CALL-NEW       VALUE 'N'.
  1974             88  AT-PHONE-CALL-OUT       VALUE 'O'.
  1975         16  AT-NOTE-CONTINUATION        PIC X.
  1976             88  AT-CONTINUED-NOTE       VALUE 'X'.
  1977         16  AT-EOB-CODES-EXIST          PIC X.
  1978             88  AT-EOB-CODES-PRESENT    VALUE 'Y'.
  1979         16  FILLER                      PIC X(35).
  1980         16  AT-GEN-INFO-LAST-MAINT-DT   PIC XX.
  1981         16  AT-GEN-INFO-LAST-UPDATED-BY PIC X(4).
  1982
  1983     12  AT-AUTO-PROMPT-TR  REDEFINES  AT-TRAILER-BODY.
  1984         16  AT-PROMPT-LINE-1            PIC X(60).
  1985         16  AT-PROMPT-LINE-2            PIC X(60).
  1986         16  AT-PROMPT-START-DT          PIC XX.
  1987         16  AT-PROMPT-END-DT            PIC XX.
  1988         16  FILLER                      PIC X(35).
  1989         16  AT-PROMPT-LAST-MAINT-DT     PIC XX.
  1990         16  AT-PROMPT-LAST-UPDATED-BY   PIC X(4).
  1991
  1992     12  AT-DENIAL-INFO-TR  REDEFINES  AT-TRAILER-BODY.
  1993         16  AT-DENIAL-INFO-1            PIC X(60).
  1994         16  AT-DENIAL-INFO-2            PIC X(60).
  1995         16  AT-DENIAL-DT                PIC XX.
  1996         16  AT-RETRACTION-DT            PIC XX.
  1997         16  AT-DENIAL-REASON-CODE       PIC X(4).
  1998*         16  FILLER                      PIC X(31).
  1999         16  AT-DENIAL-PROOF-DT          PIC XX.
  2000         16  FILLER                      PIC X(29).
  2001         16  AT-DENIAL-LAST-MAINT-DT     PIC XX.
  2002         16  AT-DENIAL-LAST-UPDATED-BY   PIC X(4).
  2003
  2004     12  AT-INCURRED-CHG-TR  REDEFINES  AT-TRAILER-BODY.
  2005         16  AT-OLD-INCURRED-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  41
* EL153.cbl
  2006         16  AT-OLD-REPORTED-DT          PIC XX.
  2007         16  AT-OLD-ESTABLISHED-DT       PIC XX.
  2008         16  AT-OLD-TOTAL-PAID           PIC S9(7)V99     COMP-3.
  2009         16  AT-OLD-DAYS-PAID            PIC S9(4)        COMP.
  2010         16  AT-OLD-NO-OF-PMTS           PIC S9(3)        COMP-3.
  2011         16  AT-OLD-PAID-THRU-DT         PIC XX.
  2012         16  AT-LAST-PMT-MADE-DT         PIC XX.
  2013         16  FILLER                      PIC X(26).
  2014         16  AT-OLD-DIAG-CODE            PIC X(6).
  2015         16  AT-TRAILER-CNT-AT-CHG       PIC S9(4)        COMP.
  2016         16  AT-OLD-ITD-PAID-EXPENSE     PIC S9(5)V99     COMP-3.
  2017         16  AT-OLD-CHARGABLE-EXPENSE    PIC S9(5)V99     COMP-3.
  2018         16  AT-OLD-INIT-MAN-RESV        PIC S9(7)V99     COMP-3.
  2019         16  AT-OLD-CURRENT-MAN-RESV     PIC S9(7)V99     COMP-3.
  2020         16  AT-OLD-ADDL-MAN-RESV        PIC S9(7)V99     COMP-3.
  2021         16  AT-OLD-DIAG-DESCRIP         PIC X(60).
  2022         16  AT-OLD-ICD-CODE-1           PIC X(8).
  2023         16  AT-OLD-ICD-CODE-2           PIC X(8).
  2024         16  FILLER                      PIC X(9).
  2025         16  AT-INCURRED-LAST-UPDATED-BY PIC X(4).
  2026
  2027     12  AT-FORM-CONTROL-TR  REDEFINES  AT-TRAILER-BODY.
  2028         16  AT-FORM-SEND-ON-DT          PIC XX.
  2029         16  AT-FORM-FOLLOW-UP-DT        PIC XX.
  2030         16  AT-FORM-RE-SEND-DT          PIC XX.
  2031         16  AT-FORM-ANSWERED-DT         PIC XX.
  2032         16  AT-FORM-PRINTED-DT          PIC XX.
  2033         16  AT-FORM-REPRINT-DT          PIC XX.
  2034         16  AT-FORM-TYPE                PIC X.
  2035             88  INITIAL-FORM                  VALUE '1'.
  2036             88  PROGRESS-FORM                 VALUE '2'.
  2037         16  AT-INSTRUCT-LN-1            PIC X(28).
  2038         16  AT-INSTRUCT-LN-2            PIC X(28).
  2039         16  AT-INSTRUCT-LN-3            PIC X(28).
  2040         16  AT-FORM-ADDR-SEQ-NO         PIC S9(4)      COMP.
  2041         16  AT-FORM-ADDRESS             PIC X.
  2042             88  FORM-TO-INSURED              VALUE 'I'.
  2043             88  FORM-TO-ACCOUNT              VALUE 'A'.
  2044             88  FORM-TO-OTHER-1              VALUE 'O'.
  2045             88  FORM-TO-OTHER-2              VALUE 'Q'.
  2046         16  AT-RELATED-1.
  2047             20 AT-REL-CARR-1            PIC X.
  2048             20 AT-REL-CLAIM-1           PIC X(7).
  2049             20 AT-REL-CERT-1            PIC X(11).
  2050         16  AT-RELATED-2.
  2051             20 AT-REL-CARR-2            PIC X.
  2052             20 AT-REL-CLAIM-2           PIC X(7).
  2053             20 AT-REL-CERT-2            PIC X(11).
  2054         16  AT-EMP-FORM-SEND-ON-DT      PIC XX.
  2055         16  AT-PHY-FORM-SEND-ON-DT      PIC XX.
  2056         16  AT-EMP-FORM-ANSWERED-DT     PIC XX.
  2057         16  AT-PHY-FORM-ANSWERED-DT     PIC XX.
  2058         16  AT-FORM-REM-PRINT-DT        PIC XX.
  2059         16  AT-STOP-FORM-DT             PIC X(2).
  2060
  2061         16  FILLER                      PIC X(09).
  2062         16  AT-FORM-LAST-MAINT-DT       PIC XX.
  2063         16  AT-FORM-LAST-UPDATED-BY     PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  42
* EL153.cbl
  2064******************************************************************
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  43
* EL153.cbl
  2066 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA CLAIM-MASTER
  2067                          ACTIVITY-TRAILERS.
  2068 0000-DFHEXIT SECTION.
  2069     MOVE '9#                    $   ' TO DFHEIV0.
  2070     MOVE 'EL153' TO DFHEIV1.
  2071     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  2072
  2073     MOVE EIBDATE               TO  DC-JULIAN-YYDDD.
  2074     MOVE '5'                   TO  DC-OPTION-CODE.
  2075     PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT.
  2076     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  2077     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  2078
  2079     MOVE DFHCOMMAREA           TO  PROGRAM-INTERFACE-BLOCK.
  2080
  2081     IF EIBCALEN NOT GREATER THAN ZEROS
  2082       GO TO 9000-UNAUTHERR.
  2083
  2084     IF PI-COMPANY-ID = 'DMD'
  2085         MOVE +3                TO  DC-ELAPSED-MONTHS
  2086         MOVE +0                TO  DC-ELAPSED-DAYS
  2087         MOVE '6'               TO  DC-OPTION-CODE
  2088         PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT
  2089         MOVE DC-BIN-DATE-2     TO  CURRENT-PLUS3-SAVE.
  2090
  2091
  2092* EXEC CICS  HANDLE CONDITION
  2093*           ERROR    (9990-ERROR)
  2094*           PGMIDERR (9600-PGMIDERR)
  2095*    END-EXEC.
  2096*    MOVE '"$.L                  ! " #00002087' TO DFHEIV0
  2097     MOVE X'22242E4C2020202020202020' TO DFHEIV0(1:12)
  2098     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2099     MOVE X'2220233030303032303837' TO DFHEIV0(25:11)
  2100     CALL 'kxdfhei1' USING DFHEIV0
  2101     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2102
  2103
  2104     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  2105         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  2106             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  2107             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  2108             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  2109             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  2110             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  2111             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  2112             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  2113             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  2114         ELSE
  2115             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  2116             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  2117             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  2118             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  2119             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  2120             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  2121             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  2122             MOVE SPACES               TO PI-SAVED-PROGRAM-6
  2123     ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  44
* EL153.cbl
  2124         GO TO 0100-RECEIVE.
  2125
  2126     MOVE LOW-VALUES             TO  EL153AO.
  2127
  2128     IF PI-COMPANY-ID = 'DMD' or 'CID' OR 'AHL' or 'FNL'
  2129        MOVE -1                  TO CALLTPL
  2130     ELSE
  2131*       IF PI-COMPANY-ID = 'CID'
  2132*          MOVE -1               TO MLINE1L
  2133*       ELSE
  2134           MOVE -1               TO MSTRDTL
  2135*       END-IF
  2136     END-IF
  2137
  2138     MOVE +2                     TO  EMI-NUMBER-OF-LINES.
  2139     MOVE SPACES                 TO  MERMSG1O
  2140                                     MERMSG2O.
  2141     MOVE '153A'                 TO  PI-CURRENT-SCREEN-NO.
  2142     MOVE ER-0694                TO  EMI-ERROR.
  2143     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2144     GO TO 8100-SEND-INITIAL-MAP.
  2145
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  45
* EL153.cbl
  2147 0100-RECEIVE.
  2148
  2149     IF EIBAID = DFHCLEAR
  2150         GO TO 9400-CLEAR.
  2151
  2152     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  2153         MOVE LOW-VALUES         TO  EL153AO
  2154         MOVE ER-0008            TO  EMI-ERROR
  2155         MOVE -1                 TO  MLINE1L
  2156         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2157         GO TO 8200-SEND-DATAONLY.
  2158
  2159     IF PI-PROCESSOR-ID = 'LGXX'
  2160         NEXT SENTENCE
  2161     ELSE
  2162
  2163* EXEC CICS READQ TS
  2164*            QUEUE    (PI-SECURITY-TEMP-STORE-ID)
  2165*            INTO     (SECURITY-CONTROL)
  2166*            LENGTH   (SC-COMM-LENGTH)
  2167*            ITEM     (SC-ITEM)
  2168*        END-EXEC
  2169*    MOVE '*$II   L              ''   #00002150' TO DFHEIV0
  2170     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  2171     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2172     MOVE X'2020233030303032313530' TO DFHEIV0(25:11)
  2173     CALL 'kxdfhei1' USING DFHEIV0,
  2174           PI-SECURITY-TEMP-STORE-ID,
  2175           SECURITY-CONTROL,
  2176           SC-COMM-LENGTH,
  2177           SC-ITEM,
  2178           DFHEIV99,
  2179           DFHEIV99
  2180     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2181         MOVE SC-CLAIMS-DISPLAY (8)  TO  PI-DISPLAY-CAP
  2182         MOVE SC-CLAIMS-UPDATE  (8)  TO  PI-MODIFY-CAP.
  2183
  2184
  2185* EXEC CICS RECEIVE
  2186*        MAP      (WS-MAP-NAME)
  2187*        MAPSET   (WS-MAPSET-NAME)
  2188*        INTO     (EL153AI)
  2189*    END-EXEC.
  2190     MOVE LENGTH OF
  2191      EL153AI
  2192       TO DFHEIV11
  2193*    MOVE '8"T I  L              ''   #00002159' TO DFHEIV0
  2194     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  2195     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2196     MOVE X'2020233030303032313539' TO DFHEIV0(25:11)
  2197     CALL 'kxdfhei1' USING DFHEIV0,
  2198           WS-MAP-NAME,
  2199           EL153AI,
  2200           DFHEIV11,
  2201           WS-MAPSET-NAME,
  2202           DFHEIV99,
  2203           DFHEIV99
  2204     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  46
* EL153.cbl
  2205
  2206
  2207     IF MPFNUMBL > +0
  2208         IF EIBAID NOT = DFHENTER
  2209             MOVE ER-0004        TO  EMI-ERROR
  2210             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2211             MOVE AL-UNBOF       TO  MPFNUMBA
  2212             MOVE -1             TO  MPFNUMBL
  2213             GO TO 8200-SEND-DATAONLY.
  2214
  2215     IF MPFNUMBI IS NUMERIC
  2216         IF MPFNUMBO > ZERO AND
  2217            MPFNUMBO < 25
  2218             MOVE PF-VALUES (MPFNUMBI)   TO  EIBAID
  2219         ELSE
  2220             MOVE ER-0029                TO  EMI-ERROR
  2221             MOVE AL-UNBOF               TO  MPFNUMBA
  2222             MOVE -1                     TO  MPFNUMBL
  2223             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2224             GO TO 8200-SEND-DATAONLY.
  2225
  2226     IF EIBAID = DFHPF12
  2227         MOVE 'EL010   '         TO  THIS-PGM
  2228         GO TO 9300-XCTL.
  2229
  2230     IF EIBAID = DFHPF23
  2231         MOVE EIBAID             TO  PI-ENTRY-CD-1
  2232         MOVE 'EL005   '         TO  THIS-PGM
  2233         GO TO 9300-XCTL.
  2234
  2235     IF EIBAID = DFHPF24
  2236         MOVE 'EL126   '         TO  THIS-PGM
  2237         GO TO 9300-XCTL.
  2238
  2239     IF (EIBAID = DFHENTER)
  2240               OR
  2241        (EIBAID = DFHPF4 AND
  2242         PI-COMPANY-ID = 'DMD')
  2243         NEXT SENTENCE
  2244     ELSE
  2245         MOVE ER-0008            TO  EMI-ERROR
  2246         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2247         MOVE -1                 TO  MPFNUMBL
  2248         MOVE AL-UNBON           TO  MPFNUMBA
  2249         GO TO 8200-SEND-DATAONLY.
  2250
  2251 0200-PROCESSING-MAINLINE.
  2252
  2253     IF NOT MODIFY-CAP
  2254         MOVE 'UPDATE'           TO  SM-READ
  2255         PERFORM 9995-SECURITY-VIOLATION
  2256         MOVE ER-0070            TO  EMI-ERROR
  2257         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2258         MOVE -1                 TO  MPFNUMBL
  2259         GO TO 8100-SEND-INITIAL-MAP.
  2260
  2261     MOVE +0                     TO  SUB.
  2262     PERFORM 4000-CHECK-INPUT-LOOP THRU 4000-CHECK-EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  47
* EL153.cbl
  2263
  2264     IF NOT EMI-NO-ERRORS
  2265         GO TO 8200-SEND-DATAONLY.
  2266
  2267     MOVE PI-COMPANY-CD          TO  WS-KEY-COMPANY-CD.
  2268     MOVE PI-CARRIER             TO  WS-KEY-CARRIER.
  2269     MOVE PI-CLAIM-NO            TO  WS-KEY-CLAIM-NO.
  2270     MOVE PI-CERT-NO             TO  WS-KEY-CERT-NO.
  2271
  2272     IF (NOTETPL > +0)
  2273*       AND (NOTETPI = 'S')
  2274        IF (NOTETPI = 'S')
  2275          GO TO 1200-BUILD-SPEC-REVIEW
  2276        ELSE
  2277          GO TO 1000-BUILD-NOTES
  2278        END-IF
  2279     ELSE
  2280       IF MSTRDTI = (LOW-VALUES OR SPACES) AND
  2281         MENDDTI = (LOW-VALUES OR SPACES)
  2282         GO TO 1000-BUILD-NOTES
  2283       ELSE
  2284          GO TO 1500-BUILD-REMINDERS
  2285       END-IF
  2286     END-IF
  2287     .
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  48
* EL153.cbl
  2289 1000-BUILD-NOTES.
  2290
  2291     MOVE SPACES TO W-CALL-TYPE W-NOTE-TYPE-IND W-NOTE-TYPE.
  2292
  2293     IF CALLTPI NOT = SPACES AND LOW-VALUES
  2294         IF CALLTPI = 'I' OR 'O' OR 'N'
  2295             MOVE CALLTPI    TO W-CALL-TYPE
  2296             MOVE 'C'        TO W-NOTE-TYPE-IND
  2297         ELSE
  2298             MOVE ER-0915    TO EMI-ERROR
  2299             MOVE AL-UABON   TO CALLTPA
  2300             MOVE -1         TO CALLTPL
  2301             MOVE 'X'        TO WS-DATE-ERROR-SW
  2302             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2303             GO TO 8200-SEND-DATAONLY.
  2304
  2305     IF NOTETPI NOT = SPACES AND LOW-VALUES
  2306         IF NOTETPI = 'N'
  2307             MOVE NOTETPI    TO W-NOTE-TYPE
  2308             MOVE 'N'        TO W-NOTE-TYPE-IND
  2309         ELSE
  2310             MOVE ER-7846    TO EMI-ERROR
  2311             MOVE AL-UABON   TO NOTETPA
  2312             MOVE -1         TO NOTETPL
  2313             MOVE 'X'        TO WS-DATE-ERROR-SW
  2314             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2315             GO TO 8200-SEND-DATAONLY
  2316         END-IF
  2317     END-IF.
  2318
  2319     MOVE +1                     TO  SUB   SUB-1.
  2320     PERFORM 4100-SQUASH-SCREEN THRU 4100-EXIT.
  2321
  2322     IF PI-COMPANY-ID = 'AIG' OR 'AUK'
  2323         MOVE +0                 TO  SUB
  2324         PERFORM 6000-EXPAND-AIG-NOTES THRU 6000-EXIT.
  2325
  2326     PERFORM 7000-READ-UP-CLAIM THRU 7050-EXIT.
  2327     PERFORM 7100-GETMAIN-TRLR  THRU 7100-EXIT.
  2328
  2329     MOVE +15                    TO  SUB.
  2330     PERFORM 3200-BUILD-GI-TRLR-LOOP THRU 3200-EXIT.
  2331     MOVE +0                     TO  SUB   SUB-1.
  2332
  2333     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
  2334     MOVE SAVE-BIN-DATE          TO  CL-LAST-MAINT-DT.
  2335     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
  2336     MOVE '3'                    TO  CL-LAST-MAINT-TYPE.
  2337
  2338     PERFORM 7055-REWRITE-CLAIM THRU 7055-EXIT.
  2339
  2340     MOVE ER-0000                TO  EMI-ERROR.
  2341     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2342     MOVE -1                     TO  EL153A-NOTE-LENGTH (1).
  2343
  2344     IF PI-COMPANY-ID = 'DMD' or 'CID' OR 'AHL' OR 'FNL'
  2345         MOVE -1                 TO  CALLTPL.
  2346
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  49
* EL153.cbl
  2347     GO TO 8200-SEND-DATAONLY.
  2348
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  50
* EL153.cbl
  2350 1200-BUILD-SPEC-REVIEW.
  2351
  2352     IF NOTETPI NOT = SPACES AND LOW-VALUES
  2353         IF NOTETPI = 'S'
  2354             MOVE NOTETPI    TO W-NOTE-TYPE
  2355             MOVE 'S'        TO W-NOTE-TYPE-IND
  2356         ELSE
  2357             MOVE ER-7846    TO EMI-ERROR
  2358             MOVE AL-UABON   TO NOTETPA
  2359             MOVE -1         TO NOTETPL
  2360             MOVE 'X'        TO WS-DATE-ERROR-SW
  2361             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2362             GO TO 8200-SEND-DATAONLY.
  2363
  2364     MOVE +1                     TO  SUB   SUB-1.
  2365     PERFORM 4100-SQUASH-SCREEN THRU 4100-EXIT.
  2366
  2367     PERFORM 7000-READ-UP-CLAIM THRU 7050-EXIT.
  2368     PERFORM 7100-GETMAIN-TRLR     THRU 7100-EXIT.
  2369     PERFORM 3150-BUILD-TRAILER-SR THRU 3150-EXIT.
  2370
  2371     PERFORM 7150-WRITE-TRAILER THRU 7199-EXIT.
  2372
  2373     MOVE PI-PROCESSOR-ID        TO  CL-LAST-MAINT-USER.
  2374     MOVE SAVE-BIN-DATE          TO  CL-LAST-MAINT-DT.
  2375     MOVE EIBTIME                TO  CL-LAST-MAINT-HHMMSS.
  2376     MOVE '3'                    TO  CL-LAST-MAINT-TYPE.
  2377
  2378     PERFORM 7055-REWRITE-CLAIM THRU 7055-EXIT.
  2379
  2380     MOVE ER-0000                TO  EMI-ERROR.
  2381     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2382     MOVE -1                     TO  EL153A-NOTE-LENGTH (1).
  2383
  2384     IF PI-COMPANY-ID = 'DMD' or 'CID' OR 'AHL' OR 'FNL'
  2385         MOVE -1                 TO  CALLTPL.
  2386
  2387     GO TO 8200-SEND-DATAONLY.
  2388
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  51
* EL153.cbl
  2390 1500-BUILD-REMINDERS.
  2391
  2392     PERFORM 2000-EDIT-SCREEN THRU 2000-EXIT.
  2393
  2394     IF NOT EMI-NO-ERRORS
  2395         GO TO 8200-SEND-DATAONLY.
  2396
  2397     PERFORM 7000-READ-UP-CLAIM    THRU 7050-EXIT.
  2398     PERFORM 2200-CHECK-DATES      THRU 2200-EXIT.
  2399     PERFORM 7100-GETMAIN-TRLR     THRU 7100-EXIT.
  2400     PERFORM 3000-REDUCE-SEQ       THRU 3000-EXIT.
  2401     PERFORM 3100-BUILD-TRAILER-AP THRU 3100-EXIT.
  2402
  2403     PERFORM 7150-WRITE-TRAILER THRU 7199-EXIT.
  2404
  2405     IF CL-NEXT-FOLLOWUP-DT = LOW-VALUES
  2406         MOVE WS-STR-DATE-BIN        TO  CL-NEXT-FOLLOWUP-DT
  2407     ELSE
  2408         IF WS-STR-DATE-BIN < CL-NEXT-FOLLOWUP-DT AND
  2409            WS-STR-DATE-BIN NOT = LOW-VALUES
  2410             MOVE WS-STR-DATE-BIN    TO  CL-NEXT-FOLLOWUP-DT.
  2411
  2412     PERFORM 7055-REWRITE-CLAIM THRU 7055-EXIT.
  2413
  2414     MOVE ER-0000                TO  EMI-ERROR.
  2415     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2416     MOVE -1                     TO  EL153A-NOTE-LENGTH (1).
  2417
  2418     IF PI-COMPANY-ID = 'DMD' or 'CID' OR 'AHL' OR 'FNL'
  2419         MOVE -1                 TO  CALLTPL.
  2420
  2421     GO TO 8200-SEND-DATAONLY.
  2422
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  52
* EL153.cbl
  2424 2000-EDIT-SCREEN.
  2425     MOVE SPACES                 TO  WS-DATE-ERROR-SW.
  2426
  2427     IF MSTRDTI = SPACES OR LOW-VALUES
  2428         MOVE LOW-VALUES         TO  WS-STR-DATE-BIN
  2429     ELSE
  2430         MOVE MSTRDTI            TO  WS-DATE-UNEDIT
  2431
  2432* EXEC CICS  BIF  DEEDIT
  2433*            FIELD (WS-DATE-UNEDIT)
  2434*            LENGTH (8)
  2435*        END-EXEC
  2436     MOVE 8
  2437       TO DFHEIV11
  2438*    MOVE '@"L                   #   #00002389' TO DFHEIV0
  2439     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2440     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2441     MOVE X'2020233030303032333839' TO DFHEIV0(25:11)
  2442     CALL 'kxdfhei1' USING DFHEIV0,
  2443           WS-DATE-UNEDIT,
  2444           DFHEIV11
  2445     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2446         MOVE '4'                TO  DC-OPTION-CODE
  2447         MOVE WS-DATE-MDY        TO  DC-GREG-DATE-1-MDY
  2448         PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT
  2449         IF DATE-CONVERSION-ERROR
  2450             MOVE ER-0314        TO  EMI-ERROR
  2451             MOVE AL-UABON       TO  MSTRDTA
  2452             MOVE -1             TO  MSTRDTL
  2453             MOVE 'X'            TO  WS-DATE-ERROR-SW
  2454             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2455         ELSE
  2456             IF (PI-COMPANY-ID = 'DMD') AND
  2457                (EIBAID NOT = DFHPF4)   AND
  2458                (DC-BIN-DATE-1 > CURRENT-PLUS3-SAVE)
  2459                 MOVE 'PF4=FORCE 7840' TO PFKEY4O
  2460                 MOVE AL-SABON         TO PFKEY4A
  2461                 MOVE ER-7840          TO EMI-ERROR
  2462                 MOVE AL-UABON         TO MSTRDTA
  2463                 MOVE -1               TO MSTRDTL
  2464                 MOVE 'X'              TO WS-DATE-ERROR-SW
  2465                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2466             ELSE
  2467               MOVE SPACES               TO PFKEY4O
  2468               MOVE AL-SADON             TO PFKEY4A
  2469               MOVE AL-UANON             TO MSTRDTA
  2470               MOVE DC-BIN-DATE-1        TO WS-STR-DATE-BIN
  2471               MOVE DC-GREG-DATE-1-EDIT  TO MSTRDTI.
  2472
  2473     IF MENDDTI = SPACES OR = LOW-VALUES
  2474         MOVE LOW-VALUES         TO  WS-END-DATE-BIN
  2475     ELSE
  2476         MOVE MENDDTI            TO  WS-DATE-UNEDIT
  2477
  2478* EXEC CICS  BIF  DEEDIT
  2479*            FIELD (WS-DATE-UNEDIT)
  2480*            LENGTH (8)
  2481*        END-EXEC
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  53
* EL153.cbl
  2482     MOVE 8
  2483       TO DFHEIV11
  2484*    MOVE '@"L                   #   #00002424' TO DFHEIV0
  2485     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  2486     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2487     MOVE X'2020233030303032343234' TO DFHEIV0(25:11)
  2488     CALL 'kxdfhei1' USING DFHEIV0,
  2489           WS-DATE-UNEDIT,
  2490           DFHEIV11
  2491     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2492         MOVE '4'                TO  DC-OPTION-CODE
  2493         MOVE WS-DATE-MDY        TO  DC-GREG-DATE-1-MDY
  2494         PERFORM 8500-DATE-CONVERSION THRU 8500-EXIT
  2495         IF  DATE-CONVERSION-ERROR
  2496             MOVE ER-0314        TO  EMI-ERROR
  2497             MOVE AL-UABON       TO  MENDDTA
  2498             MOVE -1             TO  MENDDTL
  2499             MOVE 'X'            TO  WS-DATE-ERROR-SW
  2500             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2501         ELSE
  2502             MOVE AL-UANON             TO  MENDDTA
  2503             MOVE DC-BIN-DATE-1        TO  WS-END-DATE-BIN
  2504             MOVE DC-GREG-DATE-1-EDIT  TO  MENDDTI.
  2505 2000-EXIT.
  2506      EXIT.
  2507
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  54
* EL153.cbl
  2509 2200-CHECK-DATES.
  2510     IF WS-STR-DATE-BIN  LESS THAN SAVE-BIN-DATE AND
  2511        WS-END-DATE-BIN  LESS THAN SAVE-BIN-DATE
  2512         MOVE ER-0316            TO  EMI-ERROR
  2513         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2514         MOVE -1                 TO  MSTRDTL
  2515         GO TO 8100-SEND-INITIAL-MAP.
  2516
  2517     IF WS-STR-DATE-BIN  GREATER THAN WS-END-DATE-BIN
  2518         MOVE ER-0317            TO  EMI-ERROR
  2519         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2520         MOVE -1                 TO  MSTRDTL
  2521         GO TO 8100-SEND-INITIAL-MAP.
  2522
  2523 2200-EXIT.
  2524      EXIT.
  2525
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  55
* EL153.cbl
  2527 3000-REDUCE-SEQ.
  2528     IF CL-LAST-TRL-AVAIL
  2529         MOVE ER-0137            TO  EMI-ERROR
  2530         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2531         MOVE -1                 TO  EL153A-NOTE-LENGTH (1)
  2532         GO TO 8100-SEND-INITIAL-MAP.
  2533
  2534     SUBTRACT  1 FROM CL-TRAILER-SEQ-CNT.
  2535     MOVE CL-TRAILER-SEQ-CNT     TO  WS-KEY-SEQUENCE-NO
  2536                                     AT-SEQUENCE-NO.
  2537
  2538 3000-EXIT.
  2539      EXIT.
  2540
  2541 3100-BUILD-TRAILER-AP.
  2542     MOVE 'AT'                   TO  AT-RECORD-ID.
  2543     MOVE '7'                    TO  AT-TRAILER-TYPE.
  2544
  2545     IF EL153A-NOTE-LENGTH (1) NOT > +0
  2546         MOVE SPACES             TO  AT-PROMPT-LINE-1
  2547     ELSE
  2548         MOVE EL153A-NOTE  (1)   TO  AT-PROMPT-LINE-1.
  2549
  2550     IF EL153A-NOTE-LENGTH (2) NOT > +0
  2551         MOVE SPACES             TO  AT-PROMPT-LINE-2
  2552     ELSE
  2553         MOVE EL153A-NOTE  (2)   TO  AT-PROMPT-LINE-2.
  2554
  2555     MOVE WS-STR-DATE-BIN        TO  AT-PROMPT-START-DT.
  2556     MOVE WS-END-DATE-BIN        TO  AT-PROMPT-END-DT.
  2557     MOVE WS-TRAILER-KEY         TO  AT-CONTROL-PRIMARY.
  2558     MOVE PI-PROCESSOR-ID        TO  AT-RECORDED-BY
  2559                                     AT-PROMPT-LAST-UPDATED-BY.
  2560     MOVE EIBTIME                TO  AT-LAST-MAINT-HHMMSS.
  2561     MOVE SAVE-BIN-DATE          TO  AT-RECORDED-DT
  2562                                     AT-PROMPT-LAST-MAINT-DT.
  2563
  2564 3100-EXIT.
  2565      EXIT.
  2566
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  56
* EL153.cbl
  2568 3150-BUILD-TRAILER-SR.
  2569     MOVE 'AT'                   TO  AT-RECORD-ID.
  2570     MOVE '6'                    TO  AT-TRAILER-TYPE.
  2571
  2572     IF EL153A-NOTE-LENGTH (1) NOT > +0
  2573         MOVE SPACES             TO  AT-info-line-1
  2574     ELSE
  2575         MOVE EL153A-NOTE  (1)   TO  AT-info-line-1.
  2576
  2577     IF EL153A-NOTE-LENGTH (2) NOT > +0
  2578         MOVE SPACES             TO  AT-info-line-2
  2579     ELSE
  2580         MOVE EL153A-NOTE  (2)   TO  AT-info-line-2.
  2581
  2582     MOVE W-NOTE-TYPE-IND        TO  AT-INFO-TRAILER-TYPE.
  2583     move +92                    to  ws-key-sequence-no
  2584     MOVE WS-TRAILER-KEY         TO  AT-CONTROL-PRIMARY.
  2585     MOVE PI-PROCESSOR-ID        TO  AT-RECORDED-BY
  2586                                     AT-GEN-INFO-LAST-UPDATED-BY.
  2587     MOVE EIBTIME                TO  AT-LAST-MAINT-HHMMSS.
  2588     MOVE SAVE-BIN-DATE          TO  AT-RECORDED-DT
  2589                                     AT-GEN-INFO-LAST-MAINT-DT
  2590     .
  2591 3150-EXIT.
  2592      EXIT.
  2593
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  57
* EL153.cbl
  2595 3200-BUILD-GI-TRLR-LOOP.
  2596
  2597     SUBTRACT +1 FROM SUB.
  2598
  2599     IF SUB < +1
  2600         GO TO 3200-EXIT.
  2601
  2602     IF EL153A-NOTE-LENGTH (SUB) = +0
  2603         GO TO 3200-BUILD-GI-TRLR-LOOP.
  2604
  2605     MOVE SPACES                 TO ACTIVITY-TRAILERS.
  2606     MOVE 'AT'                   TO  AT-RECORD-ID.
  2607     MOVE '6'                    TO  AT-TRAILER-TYPE.
  2608
  2609     MOVE WS-TRAILER-KEY         TO  AT-CONTROL-PRIMARY.
  2610     MOVE PI-PROCESSOR-ID        TO  AT-RECORDED-BY
  2611                                     AT-GEN-INFO-LAST-UPDATED-BY.
  2612     MOVE W-NOTE-TYPE-IND        TO  AT-INFO-TRAILER-TYPE.
  2613     MOVE W-CALL-TYPE            TO  AT-CALL-TYPE.
  2614     MOVE EIBTIME                TO  AT-LAST-MAINT-HHMMSS.
  2615     MOVE SAVE-BIN-DATE          TO  AT-RECORDED-DT
  2616                                     AT-GEN-INFO-LAST-MAINT-DT.
  2617
  2618     IF WS-FIRST-TIME-SW = 'Y'
  2619         MOVE 'N'                TO  WS-FIRST-TIME-SW
  2620         IF SUB NOT = 1 AND 2
  2621             MOVE 'X'            TO AT-NOTE-CONTINUATION
  2622         END-IF
  2623         IF SUB = 1 OR 3 OR 5 OR 7 OR 9 OR 11 OR 13
  2624             MOVE EL153A-NOTE (SUB)  TO  AT-INFO-LINE-1
  2625             PERFORM 3000-REDUCE-SEQ THRU 3000-EXIT
  2626             MOVE CL-TRAILER-SEQ-CNT TO  AT-SEQUENCE-NO
  2627             PERFORM 7150-WRITE-TRAILER THRU 7199-EXIT
  2628             GO TO 3200-BUILD-GI-TRLR-LOOP
  2629         ELSE
  2630             MOVE EL153A-NOTE (SUB)  TO  AT-INFO-LINE-2
  2631             SUBTRACT +1             FROM SUB
  2632             MOVE EL153A-NOTE (SUB)  TO  AT-INFO-LINE-1
  2633             PERFORM 3000-REDUCE-SEQ THRU 3000-EXIT
  2634             MOVE CL-TRAILER-SEQ-CNT TO  AT-SEQUENCE-NO
  2635             PERFORM 7150-WRITE-TRAILER THRU 7199-EXIT
  2636             GO TO 3200-BUILD-GI-TRLR-LOOP.
  2637
  2638     MOVE EL153A-NOTE (SUB)      TO  AT-INFO-LINE-2.
  2639     SUBTRACT +1 FROM SUB.
  2640     MOVE EL153A-NOTE (SUB)      TO  AT-INFO-LINE-1.
  2641
  2642     IF SUB NOT = 1
  2643         MOVE 'X'                TO AT-NOTE-CONTINUATION.
  2644
  2645     PERFORM 3000-REDUCE-SEQ THRU 3000-EXIT.
  2646     MOVE CL-TRAILER-SEQ-CNT     TO  AT-SEQUENCE-NO.
  2647     PERFORM 7150-WRITE-TRAILER THRU 7199-EXIT.
  2648
  2649     GO TO 3200-BUILD-GI-TRLR-LOOP.
  2650
  2651 3200-EXIT.
  2652      EXIT.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  58
* EL153.cbl
  2653
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  59
* EL153.cbl
  2655 4000-CHECK-INPUT-LOOP.
  2656
  2657      ADD +1 TO SUB.
  2658
  2659      IF SUB > +14
  2660          MOVE ER-0483           TO  EMI-ERROR
  2661          PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2662          MOVE -1                TO  EL153A-NOTE-LENGTH (1)
  2663          GO TO 4000-CHECK-EXIT.
  2664
  2665      IF EL153A-NOTE-LENGTH (SUB) NOT > +0
  2666          GO TO 4000-CHECK-INPUT-LOOP.
  2667
  2668 4000-CHECK-EXIT.
  2669     EXIT.
  2670
  2671 4100-SQUASH-SCREEN.
  2672
  2673     IF SUB > +14
  2674         GO TO 4100-EXIT.
  2675
  2676     IF EL153A-NOTE-LENGTH (SUB) > +0
  2677         IF SUB = SUB-1
  2678             ADD +1              TO  SUB   SUB-1
  2679             GO TO 4100-SQUASH-SCREEN.
  2680
  2681     IF EL153A-NOTE-LENGTH (SUB) > +0
  2682         MOVE EL153A-NOTE-LENGTH (SUB)   TO
  2683                                      EL153A-NOTE-LENGTH (SUB-1)
  2684         MOVE EL153A-NOTE-ATTRB  (SUB)   TO
  2685                                      EL153A-NOTE-ATTRB  (SUB-1)
  2686         MOVE EL153A-NOTE        (SUB)   TO  EL153A-NOTE (SUB-1)
  2687         MOVE +0                         TO
  2688                                      EL153A-NOTE-LENGTH (SUB)
  2689         MOVE LOW-VALUES                 TO  EL153A-NOTE (SUB)
  2690         MOVE AL-UANOF                   TO
  2691                                      EL153A-NOTE-ATTRB  (SUB)
  2692         ADD +1                          TO  SUB   SUB-1
  2693     ELSE
  2694         ADD +1                          TO  SUB.
  2695
  2696     GO TO 4100-SQUASH-SCREEN.
  2697
  2698 4100-EXIT.
  2699     EXIT.
  2700
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  60
* EL153.cbl
  2702 6000-EXPAND-AIG-NOTES.
  2703
  2704     ADD +1 TO SUB.
  2705
  2706     IF SUB > +14
  2707         GO TO 6000-EXIT.
  2708
  2709     IF EL153A-NOTE-LENGTH (SUB) > +0
  2710         MOVE EL153A-NOTE (SUB)          TO  WS-EDIT-NOTE
  2711         INSPECT WS-EDIT-NOTE REPLACING ALL LOW-VALUES BY SPACES
  2712         IF WS-EDIT-NOTE-1-4 = 'APC '
  2713             MOVE 'AUTO-PAY CLAIM'       TO  EL153A-NOTE (SUB)
  2714         ELSE
  2715         IF WS-EDIT-NOTE-1-4 = 'MGR '
  2716             MOVE 'MANAGEMENT REVIEW'    TO  EL153A-NOTE (SUB)
  2717         ELSE
  2718         IF WS-EDIT-NOTE-1-4 = 'SVR '
  2719             MOVE 'SUPERVISOR REVIEW'    TO  EL153A-NOTE (SUB)
  2720         ELSE
  2721         IF WS-EDIT-NOTE-1-4 = 'OIO '
  2722             MOVE 'OUTSIDE INVESTIGATION ORDERED'
  2723                                         TO  EL153A-NOTE (SUB)
  2724         ELSE
  2725         IF WS-EDIT-NOTE-1-4 = 'LGR '
  2726             MOVE 'LEGAL REVIEW'         TO  EL153A-NOTE (SUB)
  2727         ELSE
  2728         IF WS-EDIT-NOTE-1-4 = 'FRN '
  2729             MOVE 'FORM REVIEWED/NO ADDITIONAL PAYMENT DUE AT THIS
  2730-                 ' TIME'                TO  EL153A-NOTE (SUB)
  2731         ELSE
  2732         IF WS-EDIT-NOTE-1-4 = 'PRB '
  2733             MOVE 'PHONE CALL RECEIVED--BRANCH'
  2734                                         TO  EL153A-NOTE (SUB)
  2735         ELSE
  2736         IF WS-EDIT-NOTE-1-4 = 'PRG '
  2737             MOVE 'PHONE CALL RECEIVED--GROUP'
  2738                                         TO  EL153A-NOTE (SUB)
  2739         ELSE
  2740         IF WS-EDIT-NOTE-1-4 = 'PRH '
  2741             MOVE 'PHONE CALL RECEIVED--HOSPITAL'
  2742                                         TO  EL153A-NOTE (SUB)
  2743         ELSE
  2744         IF WS-EDIT-NOTE-1-4 = 'PRI '
  2745             MOVE 'PHONE CALL RECEIVED--INSURED'
  2746                                         TO  EL153A-NOTE (SUB)
  2747         ELSE
  2748         IF WS-EDIT-NOTE-1-4 = 'PRO '
  2749             MOVE 'PHONE CALL RECEIVED--OTHER'
  2750                                         TO  EL153A-NOTE (SUB)
  2751         ELSE
  2752         IF WS-EDIT-NOTE-1-4 = 'PRP '
  2753             MOVE 'PHONE CALL RECEIVED--PHYSICIAN'
  2754                                         TO  EL153A-NOTE (SUB)
  2755         ELSE
  2756         IF WS-EDIT-NOTE-1-4 = 'PMB '
  2757             MOVE 'PHONE CALL MADE--BRANCH'
  2758                                         TO  EL153A-NOTE (SUB)
  2759         ELSE
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  61
* EL153.cbl
  2760         IF WS-EDIT-NOTE-1-4 = 'PMG '
  2761             MOVE 'PHONE CALL MADE--GROUP'
  2762                                         TO  EL153A-NOTE (SUB)
  2763         ELSE
  2764         IF WS-EDIT-NOTE-1-4 = 'PMH '
  2765             MOVE 'PHONE CALL MADE--HOSPITAL'
  2766                                         TO  EL153A-NOTE (SUB)
  2767         ELSE
  2768         IF WS-EDIT-NOTE-1-4 = 'PMI '
  2769             MOVE 'PHONE CALL MADE--INSURED'
  2770                                         TO  EL153A-NOTE (SUB)
  2771         ELSE
  2772         IF WS-EDIT-NOTE-1-4 = 'PMO '
  2773             MOVE 'PHONE CALL MADE--OTHER'
  2774                                         TO  EL153A-NOTE (SUB)
  2775         ELSE
  2776         IF WS-EDIT-NOTE-1-4 = 'PMP '
  2777             MOVE 'PHONE CALL MADE--PHYSICIAN'
  2778                                         TO  EL153A-NOTE (SUB)
  2779         ELSE
  2780         IF WS-EDIT-NOTE-1-3 = '01 '
  2781             MOVE 'CONTINUING CLAIM FORM RCVD'
  2782                                         TO  EL153A-NOTE (SUB)
  2783         ELSE
  2784         IF WS-EDIT-NOTE-1-3 = '02 '
  2785             MOVE 'ACCOUNT INFORMATION RCVD'
  2786                                         TO  EL153A-NOTE (SUB)
  2787         ELSE
  2788         IF WS-EDIT-NOTE-1-3 = '03 '
  2789             MOVE 'MEDICAL HISTORY RCVD'
  2790                                         TO  EL153A-NOTE (SUB)
  2791         ELSE
  2792         IF WS-EDIT-NOTE-1-3 = '04 '
  2793             MOVE 'INSURED INFO RCVD'
  2794                                         TO  EL153A-NOTE (SUB)
  2795         ELSE
  2796         IF WS-EDIT-NOTE-1-3 = '05 '
  2797             MOVE 'EMPLOYER INFO RCVD'
  2798                                         TO  EL153A-NOTE (SUB)
  2799         ELSE
  2800         IF WS-EDIT-NOTE-1-3 = '06 '
  2801             MOVE 'PARTIAL INVESTIGATION RCVD.  CLAIM IS STILL PEN
  2802-                 'DING'                 TO  EL153A-NOTE (SUB)
  2803         ELSE
  2804         IF WS-EDIT-NOTE-1-3 = '07 '
  2805             MOVE 'DEATH CERTIFICATE RCVD'
  2806                                         TO  EL153A-NOTE (SUB)
  2807         ELSE
  2808         IF WS-EDIT-NOTE-1-3 = '08 '
  2809             MOVE 'ATTORNEY LTR RCVD'
  2810                                         TO  EL153A-NOTE (SUB)
  2811         ELSE
  2812         IF WS-EDIT-NOTE-1-3 = '09 '
  2813             MOVE 'EXAM RESULTS RCVD'
  2814                                         TO  EL153A-NOTE (SUB)
  2815         ELSE
  2816         IF WS-EDIT-NOTE-1-3 = '10 '
  2817             MOVE 'INS DEPT INQUIRY RCVD'
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  62
* EL153.cbl
  2818                                         TO  EL153A-NOTE (SUB)
  2819         ELSE
  2820         IF WS-EDIT-NOTE-1-3 = '11 '
  2821             MOVE 'RETURNED MAIL RCVD'
  2822                                         TO  EL153A-NOTE (SUB)
  2823         ELSE
  2824         IF WS-EDIT-NOTE-1-3 = '12 '
  2825             MOVE 'INITIAL CLAIM RCVD'
  2826                                         TO  EL153A-NOTE (SUB).
  2827
  2828     GO TO 6000-EXPAND-AIG-NOTES.
  2829
  2830 6000-EXIT.
  2831     EXIT.
  2832
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  63
* EL153.cbl
  2834 7000-READ-UP-CLAIM.
  2835
  2836
  2837* EXEC CICS HANDLE CONDITION
  2838*        NOTFND    (7040-NOTFND)
  2839*        NOTOPEN   (9981-NOTOPEN-MSTR)
  2840*    END-EXEC.
  2841*    MOVE '"$IJ                  ! # #00002772' TO DFHEIV0
  2842     MOVE X'2224494A2020202020202020' TO DFHEIV0(1:12)
  2843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2844     MOVE X'2320233030303032373732' TO DFHEIV0(25:11)
  2845     CALL 'kxdfhei1' USING DFHEIV0
  2846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2847
  2848
  2849
  2850* EXEC CICS READ
  2851*        DATASET   ('ELMSTR')
  2852*        RIDFLD    (WS-CLAIM-KEY)
  2853*        SET       (ADDRESS OF CLAIM-MASTER)
  2854*        UPDATE
  2855*    END-EXEC.
  2856     MOVE 'ELMSTR' TO DFHEIV1
  2857*    MOVE '&"S        EU         (   #00002777' TO DFHEIV0
  2858     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2859     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2860     MOVE X'2020233030303032373737' TO DFHEIV0(25:11)
  2861     CALL 'kxdfhei1' USING DFHEIV0,
  2862           DFHEIV1,
  2863           DFHEIV20,
  2864           DFHEIV99,
  2865           WS-CLAIM-KEY,
  2866           DFHEIV99,
  2867           DFHEIV99,
  2868           DFHEIV99
  2869     SET ADDRESS OF CLAIM-MASTER TO
  2870         DFHEIV20
  2871     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2872
  2873
  2874     GO TO 7050-EXIT.
  2875
  2876 7040-NOTFND.
  2877
  2878     MOVE ER-0133                TO  EMI-ERROR.
  2879     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2880     MOVE -1                     TO  EL153A-NOTE-LENGTH (1).
  2881     GO TO 8100-SEND-INITIAL-MAP.
  2882
  2883 7050-EXIT.
  2884     EXIT.
  2885
  2886 7055-REWRITE-CLAIM.
  2887
  2888
  2889* EXEC CICS HANDLE CONDITION
  2890*        DUPKEY   (7055-EXIT)
  2891*    END-EXEC.
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  64
* EL153.cbl
  2892*    MOVE '"$$                   ! $ #00002798' TO DFHEIV0
  2893     MOVE X'222424202020202020202020' TO DFHEIV0(1:12)
  2894     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2895     MOVE X'2420233030303032373938' TO DFHEIV0(25:11)
  2896     CALL 'kxdfhei1' USING DFHEIV0
  2897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2898
  2899
  2900
  2901* EXEC CICS REWRITE
  2902*        DATASET   ('ELMSTR')
  2903*        FROM      (CLAIM-MASTER)
  2904*    END-EXEC.
  2905     MOVE LENGTH OF
  2906      CLAIM-MASTER
  2907       TO DFHEIV11
  2908     MOVE 'ELMSTR' TO DFHEIV1
  2909*    MOVE '&& L                  %   #00002802' TO DFHEIV0
  2910     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2911     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2912     MOVE X'2020233030303032383032' TO DFHEIV0(25:11)
  2913     CALL 'kxdfhei1' USING DFHEIV0,
  2914           DFHEIV1,
  2915           CLAIM-MASTER,
  2916           DFHEIV11,
  2917           DFHEIV99
  2918     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2919
  2920
  2921 7055-EXIT.
  2922     EXIT.
  2923
  2924 7100-GETMAIN-TRLR.
  2925
  2926* EXEC CICS GETMAIN
  2927*        SET      (ADDRESS OF ACTIVITY-TRAILERS)
  2928*        INITIMG  (GETMAIN-SPACE)
  2929*        LENGTH   (WS-TRLR-LENGTH)
  2930*    END-EXEC.
  2931*    MOVE ',"IL                  $   #00002811' TO DFHEIV0
  2932     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  2933     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2934     MOVE X'2020233030303032383131' TO DFHEIV0(25:11)
  2935     CALL 'kxdfhei1' USING DFHEIV0,
  2936           DFHEIV20,
  2937           WS-TRLR-LENGTH,
  2938           GETMAIN-SPACE
  2939     SET ADDRESS OF ACTIVITY-TRAILERS TO
  2940         DFHEIV20
  2941     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2942
  2943
  2944 7100-EXIT.
  2945      EXIT.
  2946
  2947 7150-WRITE-TRAILER.
  2948
  2949
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  65
* EL153.cbl
  2950* EXEC CICS HANDLE CONDITION
  2951*        DUPREC    (7190-DUPREC)
  2952*        NOTOPEN   (9982-NOTOPEN-TRLR)
  2953*    END-EXEC.
  2954*    MOVE '"$%J                  ! % #00002822' TO DFHEIV0
  2955     MOVE X'2224254A2020202020202020' TO DFHEIV0(1:12)
  2956     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2957     MOVE X'2520233030303032383232' TO DFHEIV0(25:11)
  2958     CALL 'kxdfhei1' USING DFHEIV0
  2959     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2960
  2961
  2962
  2963* EXEC CICS WRITE
  2964*        DATASET   ('ELTRLR')
  2965*        RIDFLD    (WS-TRAILER-KEY)
  2966*        FROM      (ACTIVITY-TRAILERS)
  2967*    END-EXEC.
  2968     MOVE LENGTH OF
  2969      ACTIVITY-TRAILERS
  2970       TO DFHEIV11
  2971     MOVE 'ELTRLR' TO DFHEIV1
  2972*    MOVE '&$ L                  ''   #00002827' TO DFHEIV0
  2973     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  2974     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2975     MOVE X'2020233030303032383237' TO DFHEIV0(25:11)
  2976     CALL 'kxdfhei1' USING DFHEIV0,
  2977           DFHEIV1,
  2978           ACTIVITY-TRAILERS,
  2979           DFHEIV11,
  2980           WS-TRAILER-KEY,
  2981           DFHEIV99,
  2982           DFHEIV99
  2983     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2984
  2985
  2986     GO TO 7199-EXIT.
  2987
  2988 7190-DUPREC.
  2989
  2990     if w-note-type = 'S'
  2991        MOVE ER-7846             TO EMI-ERROR
  2992        MOVE -1                  TO notetpl
  2993        PERFORM 9900-ERROR-FORMAT
  2994                                 THRU 9900-EXIT
  2995        GO TO 8200-SEND-DATAONLY
  2996     else
  2997        PERFORM 3000-REDUCE-SEQ  THRU 3000-EXIT
  2998        GO TO 7150-WRITE-TRAILER
  2999     end-if
  3000     .
  3001 7199-EXIT.
  3002     EXIT.
  3003
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  66
* EL153.cbl
  3005 8100-SEND-INITIAL-MAP.
  3006     MOVE EIBTIME                TO  TIME-IN.
  3007     MOVE WS-HOUR                TO  WS-TRANS-HOUR.
  3008     MOVE WS-MINUTE              TO  WS-TRANS-MINUTE.
  3009     MOVE TIME-OUT               TO  MRNTIMEO.
  3010     MOVE SAVE-DATE              TO  MRNDATEO.
  3011     MOVE PI-CERT-NO             TO  MCERTO.
  3012
  3013
  3014* EXEC CICS SEND
  3015*        MAP      (WS-MAP-NAME)
  3016*        MAPSET   (WS-MAPSET-NAME)
  3017*        FROM     (EL153AI)
  3018*        FREEKB
  3019*        ERASE
  3020*        CURSOR
  3021*    END-EXEC.
  3022     MOVE LENGTH OF
  3023      EL153AI
  3024       TO DFHEIV12
  3025     MOVE -1
  3026       TO DFHEIV11
  3027*    MOVE '8$     CT  E F  H L F ,   #00002860' TO DFHEIV0
  3028     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  3029     MOVE X'2046202048204C2046202C20' TO DFHEIV0(13:12)
  3030     MOVE X'2020233030303032383630' TO DFHEIV0(25:11)
  3031     CALL 'kxdfhei1' USING DFHEIV0,
  3032           WS-MAP-NAME,
  3033           EL153AI,
  3034           DFHEIV12,
  3035           WS-MAPSET-NAME,
  3036           DFHEIV99,
  3037           DFHEIV99,
  3038           DFHEIV99,
  3039           DFHEIV11,
  3040           DFHEIV99,
  3041           DFHEIV99,
  3042           DFHEIV99
  3043     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3044
  3045
  3046     GO TO 9100-RETURN-TRANS.
  3047 8100-EXIT.
  3048     EXIT.
  3049
  3050 8200-SEND-DATAONLY.
  3051     MOVE EIBTIME                TO  TIME-IN.
  3052     MOVE WS-HOUR                TO  WS-TRANS-HOUR.
  3053     MOVE WS-MINUTE              TO  WS-TRANS-MINUTE.
  3054     MOVE TIME-OUT               TO  MRNTIMEO.
  3055     MOVE SAVE-DATE              TO  MRNDATEO.
  3056     MOVE PI-CERT-NO             TO  MCERTO.
  3057
  3058
  3059* EXEC CICS SEND
  3060*        MAP      (WS-MAP-NAME)
  3061*        MAPSET   (WS-MAPSET-NAME)
  3062*        FROM     (EL153AI)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  67
* EL153.cbl
  3063*        FREEKB
  3064*        DATAONLY
  3065*        CURSOR
  3066*    END-EXEC.
  3067     MOVE LENGTH OF
  3068      EL153AI
  3069       TO DFHEIV12
  3070     MOVE -1
  3071       TO DFHEIV11
  3072*    MOVE '8$D    CT    F  H L F ,   #00002881' TO DFHEIV0
  3073     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  3074     MOVE X'2046202048204C2046202C20' TO DFHEIV0(13:12)
  3075     MOVE X'2020233030303032383831' TO DFHEIV0(25:11)
  3076     CALL 'kxdfhei1' USING DFHEIV0,
  3077           WS-MAP-NAME,
  3078           EL153AI,
  3079           DFHEIV12,
  3080           WS-MAPSET-NAME,
  3081           DFHEIV99,
  3082           DFHEIV99,
  3083           DFHEIV99,
  3084           DFHEIV11,
  3085           DFHEIV99,
  3086           DFHEIV99,
  3087           DFHEIV99
  3088     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3089
  3090
  3091     GO TO 9100-RETURN-TRANS.
  3092
  3093 8200-EXIT.
  3094     EXIT.
  3095
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  68
* EL153.cbl
  3097 8300-SEND-TEXT.
  3098
  3099* EXEC CICS SEND TEXT
  3100*        FROM     (LOGOFF-TEXT)
  3101*        ERASE
  3102*        FREEKB
  3103*        LENGTH   (LOGOFF-LENGTH)
  3104*    END-EXEC.
  3105*    MOVE '8&      T  E F  H   F -   #00002897' TO DFHEIV0
  3106     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  3107     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  3108     MOVE X'2020233030303032383937' TO DFHEIV0(25:11)
  3109     CALL 'kxdfhei1' USING DFHEIV0,
  3110           LOGOFF-TEXT,
  3111           LOGOFF-LENGTH,
  3112           DFHEIV99,
  3113           DFHEIV99,
  3114           DFHEIV99,
  3115           DFHEIV99,
  3116           DFHEIV99,
  3117           DFHEIV99,
  3118           DFHEIV99,
  3119           DFHEIV99,
  3120           DFHEIV99,
  3121           DFHEIV99
  3122     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3123
  3124
  3125
  3126* EXEC CICS RETURN
  3127*    END-EXEC.
  3128*    MOVE '.(                    ''   #00002904' TO DFHEIV0
  3129     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  3130     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3131     MOVE X'2020233030303032393034' TO DFHEIV0(25:11)
  3132     CALL 'kxdfhei1' USING DFHEIV0,
  3133           DFHEIV99,
  3134           DFHEIV99,
  3135           DFHEIV99,
  3136           DFHEIV99,
  3137           DFHEIV99,
  3138           DFHEIV99
  3139     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3140
  3141
  3142 8300-EXIT.
  3143      EXIT.
  3144
  3145 8500-DATE-CONVERSION.
  3146
  3147* EXEC CICS LINK
  3148*           PROGRAM  ('ELDATCV')
  3149*           COMMAREA (DATE-CONVERSION-DATA)
  3150*           LENGTH   (DC-COMM-LENGTH)
  3151*    END-EXEC.
  3152     MOVE 'ELDATCV' TO DFHEIV1
  3153*    MOVE '."C                   (   #00002911' TO DFHEIV0
  3154     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  69
* EL153.cbl
  3155     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3156     MOVE X'2020233030303032393131' TO DFHEIV0(25:11)
  3157     CALL 'kxdfhei1' USING DFHEIV0,
  3158           DFHEIV1,
  3159           DATE-CONVERSION-DATA,
  3160           DC-COMM-LENGTH,
  3161           DFHEIV99,
  3162           DFHEIV99,
  3163           DFHEIV99,
  3164           DFHEIV99
  3165     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3166
  3167
  3168 8500-EXIT.
  3169      EXIT.
  3170
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  70
* EL153.cbl
  3172 9000-UNAUTHERR.
  3173     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  3174     GO TO 8300-SEND-TEXT.
  3175
  3176 9100-RETURN-TRANS.
  3177
  3178* EXEC CICS RETURN
  3179*        TRANSID  (WS-TRANS-ID)
  3180*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3181*        LENGTH   (PI-COMM-LENGTH)
  3182*    END-EXEC.
  3183*    MOVE '.(CT                  ''   #00002926' TO DFHEIV0
  3184     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3185     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3186     MOVE X'2020233030303032393236' TO DFHEIV0(25:11)
  3187     CALL 'kxdfhei1' USING DFHEIV0,
  3188           WS-TRANS-ID,
  3189           PROGRAM-INTERFACE-BLOCK,
  3190           PI-COMM-LENGTH,
  3191           DFHEIV99,
  3192           DFHEIV99,
  3193           DFHEIV99
  3194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3195
  3196
  3197 9100-EXIT.
  3198      EXIT.
  3199
  3200 9300-XCTL.
  3201
  3202* EXEC CICS XCTL
  3203*        PROGRAM  (THIS-PGM)
  3204*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3205*        LENGTH   (PI-COMM-LENGTH)
  3206*    END-EXEC.
  3207*    MOVE '.$C                   %   #00002936' TO DFHEIV0
  3208     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3209     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3210     MOVE X'2020233030303032393336' TO DFHEIV0(25:11)
  3211     CALL 'kxdfhei1' USING DFHEIV0,
  3212           THIS-PGM,
  3213           PROGRAM-INTERFACE-BLOCK,
  3214           PI-COMM-LENGTH,
  3215           DFHEIV99
  3216     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3217
  3218
  3219 9300-EXIT.
  3220      EXIT.
  3221
  3222 9400-CLEAR.
  3223     MOVE DFHENTER              TO  EIBAID.
  3224     MOVE PI-RETURN-TO-PROGRAM  TO  THIS-PGM.
  3225     GO TO 9300-XCTL.
  3226
  3227 9400-EXIT.
  3228     EXIT.
  3229
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  71
* EL153.cbl
  3231 9600-PGMIDERR.
  3232
  3233* EXEC CICS HANDLE CONDITION
  3234*        PGMIDERR (8300-SEND-TEXT)
  3235*    END-EXEC.
  3236*    MOVE '"$L                   ! & #00002955' TO DFHEIV0
  3237     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3238     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3239     MOVE X'2620233030303032393535' TO DFHEIV0(25:11)
  3240     CALL 'kxdfhei1' USING DFHEIV0
  3241     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3242
  3243
  3244     MOVE THIS-PGM               TO  LOGOFF-PGM
  3245                                     PI-CALLING-PROGRAM.
  3246     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  3247     MOVE 'EL005'                TO  THIS-PGM.
  3248     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  3249     GO TO 9300-XCTL.
  3250
  3251 9600-EXIT.
  3252      EXIT.
  3253
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  72
* EL153.cbl
  3255 9900-ERROR-FORMAT.
  3256
  3257* EXEC CICS LINK
  3258*        PROGRAM  ('EL001')
  3259*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  3260*        LENGTH   (EMI-COMM-LENGTH)
  3261*    END-EXEC.
  3262     MOVE 'EL001' TO DFHEIV1
  3263*    MOVE '."C                   (   #00002971' TO DFHEIV0
  3264     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3265     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3266     MOVE X'2020233030303032393731' TO DFHEIV0(25:11)
  3267     CALL 'kxdfhei1' USING DFHEIV0,
  3268           DFHEIV1,
  3269           ERROR-MESSAGE-INTERFACE-BLOCK,
  3270           EMI-COMM-LENGTH,
  3271           DFHEIV99,
  3272           DFHEIV99,
  3273           DFHEIV99,
  3274           DFHEIV99
  3275     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3276
  3277
  3278     MOVE EMI-LINE1          TO MERMSG1O.
  3279     MOVE EMI-LINE2          TO MERMSG2O.
  3280
  3281 9900-EXIT.
  3282      EXIT.
  3283
  3284 9981-NOTOPEN-MSTR.
  3285     MOVE ER-0154                TO  EMI-ERROR.
  3286     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3287     MOVE -1                     TO  MPFNUMBL.
  3288     GO TO 8100-SEND-INITIAL-MAP.
  3289
  3290 9981-EXIT.
  3291      EXIT.
  3292
  3293 9982-NOTOPEN-TRLR.
  3294     MOVE ER-0172                TO  EMI-ERROR.
  3295     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  3296     MOVE -1                     TO  MPFNUMBL.
  3297     GO TO 8100-SEND-INITIAL-MAP.
  3298
  3299 9990-ERROR.
  3300
  3301* EXEC CICS LINK
  3302*        PROGRAM  ('EL004')
  3303*        COMMAREA (DFHEIBLK)
  3304*        LENGTH   (64)
  3305*    END-EXEC.
  3306     MOVE 'EL004' TO DFHEIV1
  3307     MOVE 64
  3308       TO DFHEIV11
  3309*    MOVE '."C                   (   #00002999' TO DFHEIV0
  3310     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3311     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3312     MOVE X'2020233030303032393939' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  73
* EL153.cbl
  3313     CALL 'kxdfhei1' USING DFHEIV0,
  3314           DFHEIV1,
  3315           DFHEIBLK,
  3316           DFHEIV11,
  3317           DFHEIV99,
  3318           DFHEIV99,
  3319           DFHEIV99,
  3320           DFHEIV99
  3321     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3322
  3323
  3324     GO TO 8200-SEND-DATAONLY.
  3325
  3326 9995-SECURITY-VIOLATION.
  3327*                            COPY ELCSCTP SUPPRESS.
  3328******************************************************************
  3329*                                                                *
  3330*                            ELCSCTP                             *
  3331*                            VMOD=2.001                          *
  3332*                                                                *
  3333*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3334******************************************************************
  3335
  3336
  3337     MOVE EIBDATE          TO SM-JUL-DATE.
  3338     MOVE EIBTRMID         TO SM-TERMID.
  3339     MOVE THIS-PGM         TO SM-PGM.
  3340     MOVE EIBTIME          TO TIME-IN.
  3341     MOVE TIME-OUT         TO SM-TIME.
  3342     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3343
  3344
  3345* EXEC CICS LINK
  3346*         PROGRAM  ('EL003')
  3347*         COMMAREA (SECURITY-MESSAGE)
  3348*         LENGTH   (80)
  3349*    END-EXEC.
  3350     MOVE 'EL003' TO DFHEIV1
  3351     MOVE 80
  3352       TO DFHEIV11
  3353*    MOVE '."C                   (   #00003025' TO DFHEIV0
  3354     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3355     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3356     MOVE X'2020233030303033303235' TO DFHEIV0(25:11)
  3357     CALL 'kxdfhei1' USING DFHEIV0,
  3358           DFHEIV1,
  3359           SECURITY-MESSAGE,
  3360           DFHEIV11,
  3361           DFHEIV99,
  3362           DFHEIV99,
  3363           DFHEIV99,
  3364           DFHEIV99
  3365     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3366
  3367
  3368******************************************************************
  3369
  3370
* Micro Focus Server Express         V5.1 revision 000 25-Jun-21 08:19 Page  74
* EL153.cbl
  3371
  3372 9999-DFHBACK SECTION.
  3373     MOVE '9%                    "   ' TO DFHEIV0
  3374     MOVE 'EL153' TO DFHEIV1
  3375     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3376     GOBACK.
  3377 9999-DFHEXIT.
  3378     IF DFHEIGDJ EQUAL 0001
  3379         NEXT SENTENCE
  3380     ELSE IF DFHEIGDJ EQUAL 2
  3381         GO TO 9990-ERROR,
  3382               9600-PGMIDERR
  3383         DEPENDING ON DFHEIGDI
  3384     ELSE IF DFHEIGDJ EQUAL 3
  3385         GO TO 7040-NOTFND,
  3386               9981-NOTOPEN-MSTR
  3387         DEPENDING ON DFHEIGDI
  3388     ELSE IF DFHEIGDJ EQUAL 4
  3389         GO TO 7055-EXIT
  3390         DEPENDING ON DFHEIGDI
  3391     ELSE IF DFHEIGDJ EQUAL 5
  3392         GO TO 7190-DUPREC,
  3393               9982-NOTOPEN-TRLR
  3394         DEPENDING ON DFHEIGDI
  3395     ELSE IF DFHEIGDJ EQUAL 6
  3396         GO TO 8300-SEND-TEXT
  3397         DEPENDING ON DFHEIGDI.
  3398     MOVE '9%                    "   ' TO DFHEIV0
  3399     MOVE 'EL153' TO DFHEIV1
  3400     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3401     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        5164     Code:        8688
