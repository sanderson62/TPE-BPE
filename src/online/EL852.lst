* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   1
* EL852.cbl
* Options: int("EL852.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL852.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL852.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL852.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL852 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/14/96 08:03:10.
     7*                            VMOD=2.007
     8*
     9*
    10*AUTHOR.     LOGIC,INC.
    11*            DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   2
* EL852.cbl
    14*SECURITY.   *****************************************************
    15*            *                                                   *
    16*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    17*            *                                                   *
    18*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    19*                                                                *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24
    25*REMARKS. TRANSACTION - EXJ2 - ACCOUNTS RECEIVABLE
    26*                              REQUEST FILE SELECTION.
    27
    28 ENVIRONMENT DIVISION.
    29
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   3
* EL852.cbl
    31 DATA DIVISION.
    32 WORKING-STORAGE SECTION.
    33 01  DFH-START PIC X(04).
    34
    35 77  FILLER  PIC X(32)  VALUE '********************************'.
    36 77  FILLER  PIC X(32)  VALUE '*    EL852 WORKING STORAGE     *'.
    37 77  FILLER  PIC X(32)  VALUE '************ V/M 2.007 *********'.
    38
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   4
* EL852.cbl
    40
    41*                            COPY ELCSCTM.
    42******************************************************************
    43*                                                                *
    44*                                                                *
    45*                            ELCSCTM                             *
    46*                            VMOD=2.001                          *
    47*                                                                *
    48*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    49*                                                                *
    50******************************************************************
    51 01  SECURITY-MESSAGE.
    52     12  FILLER                          PIC X(30)
    53            VALUE '** LOGIC SECURITY VIOLATION -'.
    54     12  SM-READ                         PIC X(6).
    55     12  FILLER                          PIC X(5)
    56            VALUE ' PGM='.
    57     12  SM-PGM                          PIC X(6).
    58     12  FILLER                          PIC X(5)
    59            VALUE ' OPR='.
    60     12  SM-PROCESSOR-ID                 PIC X(4).
    61     12  FILLER                          PIC X(6)
    62            VALUE ' TERM='.
    63     12  SM-TERMID                       PIC X(4).
    64     12  FILLER                          PIC XX   VALUE SPACE.
    65     12  SM-JUL-DATE                     PIC 9(5).
    66     12  FILLER                          PIC X    VALUE SPACE.
    67     12  SM-TIME                         PIC 99.99.
    68
    69*                            COPY ELCSCRTY.
    70******************************************************************
    71*                                                                *
    72*                                                                *
    73*                            ELCSCRTY                            *
    74*                            VMOD=2.001                          *
    75*                                                                *
    76*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
    77*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
    78*        SAVED IN PI-SECURITY-ADDRESS.                           *
    79*                                                                *
    80******************************************************************
    81 01  SECURITY-CONTROL.
    82     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
    83     12  FILLER                       PIC XX    VALUE 'SC'.
    84     12  SC-CREDIT-CODES.
    85         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
    86             20  SC-CREDIT-DISPLAY    PIC X.
    87             20  SC-CREDIT-UPDATE     PIC X.
    88     12  SC-CLAIMS-CODES.
    89         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
    90             20  SC-CLAIMS-DISPLAY    PIC X.
    91             20  SC-CLAIMS-UPDATE     PIC X.
    92
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   5
* EL852.cbl
    94
    95******************************************************************
    96*                                                                *
    97*              S T A N D A R D   A R E A S                       *
    98*                                                                *
    99******************************************************************
   100
   101 01  STANDARD-AREAS.
   102     12  SC-ITEM             PIC S9(4)   VALUE +1   COMP.
   103     12  GETMAIN-SPACE       PIC X       VALUE SPACE.
   104     12  EL852A              PIC X(8)    VALUE 'EL852A'.
   105     12  EL852B              PIC X(8)    VALUE 'EL852B'.
   106     12  EL852C              PIC X(8)    VALUE 'EL852C'.
   107     12  EL852D              PIC X(8)    VALUE 'EL852D'.
   108     12  MAPSET-EL852S       PIC X(8)    VALUE 'EL852S'.
   109     12  TRANS-EXJ2          PIC X(4)    VALUE 'EXJ2'.
   110     12  THIS-PGM            PIC X(8)    VALUE 'EL852 '.
   111     12  PGM-NAME            PIC X(8).
   112     12  TIME-IN             PIC S9(7).
   113     12  TIME-OUT-R  REDEFINES TIME-IN.
   114         16  FILLER          PIC X.
   115         16  TIME-OUT        PIC 99V99.
   116         16  FILLER              PIC X(2).
   117     12  LINK-EL001              PIC X(8)    VALUE 'EL001'.
   118     12  LINK-EL004              PIC X(8)    VALUE 'EL004'.
   119     12  XCTL-EL005              PIC X(8)    VALUE 'EL005'.
   120     12  XCTL-EL010              PIC X(8)    VALUE 'EL010'.
   121     12  XCTL-EL626              PIC X(8)    VALUE 'EL626'.
   122     12  XCTL-EL8521             PIC X(8)    VALUE 'EL8521'.
   123     12  LINK-ELDATCV            PIC X(8)    VALUE 'ELDATCV'.
   124     12  FILE-ID-ERRQST          PIC X(8)    VALUE 'ERRQST'.
   125     12  FILE-ID-ERRQST2         PIC X(8)    VALUE 'ERRQST2'.
   126     12  FILE-ID-ERRQST3         PIC X(8)    VALUE 'ERRQST3'.
   127     12  FILE-ID-ERRQST4         PIC X(8)    VALUE 'ERRQST4'.
   128     12  FILE-ID-ERRQST5         PIC X(8)    VALUE 'ERRQST5'.
   129     12  FILE-ID-ERSUMM          PIC X(8)    VALUE 'ERSUMM'.
   130     12  WS-CURRENT-DT           PIC X(8)    VALUE SPACES.
   131     12  WS-CURRENT-BIN-DT       PIC XX      VALUE SPACES.
   132     12  WS-DATA-SELECTED-SW     PIC X       VALUE SPACE.
   133         88 WS-DATA-SELECTED                 VALUE 'Y'.
   134     12  WS-OPTION-COUNTER       PIC S999    VALUE ZEROS COMP-3.
   135     12  WS-MAINT-FUNCTION       PIC X       VALUE SPACE.
   136         88 WS-BROWSE-FUNCTION               VALUE 'B'.
   137         88 WS-SUBMIT-FUNCTION               VALUE 'S'.
   138         88 WS-RESUBMIT-FUNCTION             VALUE 'R'.
   139     12  WS-REQUEST-BROWSE-SW    PIC X       VALUE SPACE.
   140         88 WS-REQUEST-BROWSE-STARTED        VALUE 'Y'.
   141     12  WS-SUMMARY-BROWSE-SW    PIC X       VALUE SPACE.
   142         88 WS-SUMMARY-BROWSE-STARTED        VALUE 'Y'.
   143     12  WS-SAVE-ACCESS-KEY      PIC X(46)   VALUE SPACES.
   144     12  WS-RQST-ACCT-CONTROL    PIC X(20)   VALUE SPACES.
   145     12  WS-RQST-FIN-RESP-CNTL   PIC X(18)   VALUE SPACES.
   146     12  WS-ACCESS-KEY           PIC X(46)   VALUE SPACES.
   147     12  QID.
   148         16  QID-TERM            PIC X(4)      VALUE SPACES.
   149         16  FILLER              PIC X(4)      VALUE '125D'.
   150
   151
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   6
* EL852.cbl
   153
   154******************************************************************
   155*                                                                *
   156*                E R R O R   M E S S A G E S                     *
   157*                                                                *
   158******************************************************************
   159
   160 01  ERROR-MESSAGES.
   161     12  ER-0000                 PIC X(4)  VALUE '0000'.
   162     12  ER-0004                 PIC X(4)  VALUE '0004'.
   163     12  ER-0008                 PIC X(4)  VALUE '0008'.
   164     12  ER-0023                 PIC X(4)  VALUE '0023'.
   165     12  ER-0029                 PIC X(4)  VALUE '0029'.
   166     12  ER-0070                 PIC X(4)  VALUE '0070'.
   167     12  ER-2132                 PIC X(4)  VALUE '2132'.
   168     12  ER-2134                 PIC X(4)  VALUE '2134'.
   169     12  ER-2919                 PIC X(4)  VALUE '2919'.
   170     12  ER-2935                 PIC X(4)  VALUE '2935'.
   171     12  ER-3133                 PIC X(4)  VALUE '3133'.
   172
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   7
* EL852.cbl
   174
   175******************************************************************
   176*                                                                *
   177*              A C C E S S   K E Y S                             *
   178*                                                                *
   179******************************************************************
   180
   181 01  ACCESS-KEYS.
   182     12  ERRQST-KEY.
   183         16  ERRQST-COMPANY-CD       PIC X     VALUE SPACE.
   184         16  ERRQST-ENTRY-BATCH      PIC X(6)  VALUE SPACES.
   185
   186     12  ERRQST-ALT-KEY1.
   187         16  ERRQST-ACCT-CONTROL.
   188             20 ERRQST-COMPANY-CD-A1 PIC X     VALUE SPACES.
   189             20 ERRQST-CARRIER-A1    PIC X     VALUE SPACES.
   190             20 ERRQST-GROUPING-A1   PIC X(6)  VALUE SPACES.
   191             20 ERRQST-STATE-A1      PIC XX    VALUE SPACES.
   192             20 ERRQST-ACCOUNT-A1    PIC X(10) VALUE SPACES.
   193         16  ERRQST-REFERENCE-A1     PIC X(12) VALUE SPACES.
   194         16  ERRQST-BATCH-A1         PIC X(6)  VALUE SPACES.
   195
   196     12  ERRQST-ALT-KEY2.
   197         16  ERRQST-FIN-RESP-CONTROL.
   198             20 ERRQST-COMPANY-CD-A2 PIC X     VALUE SPACES.
   199             20 ERRQST-CARRIER-A2    PIC X     VALUE SPACES.
   200             20 ERRQST-GROUPING-A2   PIC X(6)  VALUE SPACES.
   201             20 ERRQST-FIN-RESP-A2   PIC X(10) VALUE SPACES.
   202         16  ERRQST-ACCT-AGENT-A2    PIC X(10) VALUE SPACES.
   203         16  ERRQST-REFERENCE-A2     PIC X(12) VALUE SPACES.
   204         16  ERRQST-BATCH-A2         PIC X(6)  VALUE SPACES.
   205
   206     12  ERRQST-ALT-KEY3.
   207         16  ERRQST-COMPANY-CD-A3    PIC X     VALUE SPACES.
   208         16  ERRQST-CARRIER-A3       PIC X     VALUE SPACES.
   209         16  ERRQST-GROUPING-A3      PIC X     VALUE SPACES.
   210         16  ERRQST-ACCOUNT-AGENT    PIC X     VALUE SPACES.
   211         16  ERRQST-BATCH-A3         PIC X     VALUE SPACES.
   212
   213     12  ERRQST-ALT-KEY4.
   214         16  ERRQST-COMPANY-CD-A4    PIC X     VALUE SPACES.
   215         16  ERRQST-SUMMARY-CODE     PIC X(6)  VALUE SPACES.
   216         16  ERRQST-ACCOUNT-A4       PIC X(10) VALUE SPACES.
   217         16  ERRQST-REFERENCE-A4     PIC X(12) VALUE SPACES.
   218         16  ERRQST-BATCH-A4         PIC X(6)  VALUE SPACES.
   219
   220     12  ERRQST-RECORD-LENGTH        PIC S9(4) COMP VALUE +200.
   221     12  ERRQST-JOURNAL-LENGTH       PIC S9(4) COMP VALUE +223.
   222
   223
   224
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   8
* EL852.cbl
   226
   227*                            COPY ELCDATE.
   228******************************************************************
   229*                                                                *
   230*                                                                *
   231*                            ELCDATE.                            *
   232*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   233*                            VMOD=2.003
   234*                                                                *
   235*                                                                *
   236*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   237*                 LENGTH = 200                                   *
   238******************************************************************
   239
   240 01  DATE-CONVERSION-DATA.
   241     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   242     12  DC-OPTION-CODE                PIC X.
   243         88  BIN-TO-GREG                VALUE ' '.
   244         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   245         88  EDIT-GREG-TO-BIN           VALUE '2'.
   246         88  YMD-GREG-TO-BIN            VALUE '3'.
   247         88  MDY-GREG-TO-BIN            VALUE '4'.
   248         88  JULIAN-TO-BIN              VALUE '5'.
   249         88  BIN-PLUS-ELAPSED           VALUE '6'.
   250         88  FIND-CENTURY               VALUE '7'.
   251         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   252         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   253         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   254         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   255         88  JULIAN-TO-BIN-3            VALUE 'C'.
   256         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   257         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   258         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   259         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   260         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   261         88  CHECK-LEAP-YEAR            VALUE 'H'.
   262         88  BIN-3-TO-GREG              VALUE 'I'.
   263         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   264         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   265         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   266         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   267         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   268         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   269         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   270         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   271         88  THREE-CHARACTER-BIN
   272                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   273         88  GREGORIAN-TO-BIN
   274                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   275         88  BIN-TO-GREGORIAN
   276                  VALUES ' ' '1' 'I' '8' 'G'.
   277         88  JULIAN-TO-BINARY
   278                  VALUES '5' 'C' 'E' 'F'.
   279     12  DC-ERROR-CODE                 PIC X.
   280         88  NO-CONVERSION-ERROR        VALUE ' '.
   281         88  DATE-CONVERSION-ERROR
   282                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   283         88  DATE-IS-ZERO               VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page   9
* EL852.cbl
   284         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   285         88  DATE-IS-INVALID            VALUE '3'.
   286         88  DATE1-GREATER-DATE2        VALUE '4'.
   287         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   288         88  DATE-INVALID-OPTION        VALUE '9'.
   289         88  INVALID-CENTURY            VALUE 'A'.
   290         88  ONLY-CENTURY               VALUE 'B'.
   291         88  ONLY-LEAP-YEAR             VALUE 'C'.
   292         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   293     12  DC-END-OF-MONTH               PIC X.
   294         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   295     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   296         88  USE-NORMAL-PROCESS         VALUE ' '.
   297         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   298         88  ADJUST-UP-100-YRS          VALUE '2'.
   299     12  FILLER                        PIC X.
   300     12  DC-CONVERSION-DATES.
   301         16  DC-BIN-DATE-1             PIC XX.
   302         16  DC-BIN-DATE-2             PIC XX.
   303         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   304         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   305                       DC-GREG-DATE-1-EDIT.
   306             20  DC-EDIT1-MONTH        PIC 99.
   307             20  SLASH1-1              PIC X.
   308             20  DC-EDIT1-DAY          PIC 99.
   309             20  SLASH1-2              PIC X.
   310             20  DC-EDIT1-YEAR         PIC 99.
   311         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   312         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   313                     DC-GREG-DATE-2-EDIT.
   314             20  DC-EDIT2-MONTH        PIC 99.
   315             20  SLASH2-1              PIC X.
   316             20  DC-EDIT2-DAY          PIC 99.
   317             20  SLASH2-2              PIC X.
   318             20  DC-EDIT2-YEAR         PIC 99.
   319         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   320         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   321                     DC-GREG-DATE-1-YMD.
   322             20  DC-YMD-YEAR           PIC 99.
   323             20  DC-YMD-MONTH          PIC 99.
   324             20  DC-YMD-DAY            PIC 99.
   325         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   326         16  DC-GREG-DATE-1-MDY-R REDEFINES
   327                      DC-GREG-DATE-1-MDY.
   328             20  DC-MDY-MONTH          PIC 99.
   329             20  DC-MDY-DAY            PIC 99.
   330             20  DC-MDY-YEAR           PIC 99.
   331         16  DC-GREG-DATE-1-ALPHA.
   332             20  DC-ALPHA-MONTH        PIC X(10).
   333             20  DC-ALPHA-DAY          PIC 99.
   334             20  FILLER                PIC XX.
   335             20  DC-ALPHA-CENTURY.
   336                 24 DC-ALPHA-CEN-N     PIC 99.
   337             20  DC-ALPHA-YEAR         PIC 99.
   338         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   339         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   340         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   341         16  DC-JULIAN-DATE            PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  10
* EL852.cbl
   342         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   343                                       PIC 9(05).
   344         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   345             20  DC-JULIAN-YEAR        PIC 99.
   346             20  DC-JULIAN-DAYS        PIC 999.
   347         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   348         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   349         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   350     12  DATE-CONVERSION-VARIBLES.
   351         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   352         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   353             20  FILLER                PIC 9(3).
   354             20  HOLD-CEN-1-CCYY.
   355                 24  HOLD-CEN-1-CC     PIC 99.
   356                 24  HOLD-CEN-1-YY     PIC 99.
   357             20  HOLD-CEN-1-MO         PIC 99.
   358             20  HOLD-CEN-1-DA         PIC 99.
   359         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   360             20  HOLD-CEN-1-R-MO       PIC 99.
   361             20  HOLD-CEN-1-R-DA       PIC 99.
   362             20  HOLD-CEN-1-R-CCYY.
   363                 24  HOLD-CEN-1-R-CC   PIC 99.
   364                 24  HOLD-CEN-1-R-YY   PIC 99.
   365             20  FILLER                PIC 9(3).
   366         16  HOLD-CENTURY-1-X.
   367             20  FILLER                PIC X(3)  VALUE SPACES.
   368             20  HOLD-CEN-1-X-CCYY.
   369                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   370                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   371             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   372             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   373         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   374             20  HOLD-CEN-1-R-X-MO     PIC XX.
   375             20  HOLD-CEN-1-R-X-DA     PIC XX.
   376             20  HOLD-CEN-1-R-X-CCYY.
   377                 24  HOLD-CEN-1-R-X-CC PIC XX.
   378                 24  HOLD-CEN-1-R-X-YY PIC XX.
   379             20  FILLER                PIC XXX.
   380         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   381         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   382         16  DC-JULIAN-DATE-1          PIC 9(07).
   383         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   384             20  DC-JULIAN-1-CCYY.
   385                 24  DC-JULIAN-1-CC    PIC 99.
   386                 24  DC-JULIAN-1-YR    PIC 99.
   387             20  DC-JULIAN-DA-1        PIC 999.
   388         16  DC-JULIAN-DATE-2          PIC 9(07).
   389         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   390             20  DC-JULIAN-2-CCYY.
   391                 24  DC-JULIAN-2-CC    PIC 99.
   392                 24  DC-JULIAN-2-YR    PIC 99.
   393             20  DC-JULIAN-DA-2        PIC 999.
   394         16  DC-GREG-DATE-A-EDIT.
   395             20  DC-EDITA-MONTH        PIC 99.
   396             20  SLASHA-1              PIC X VALUE '/'.
   397             20  DC-EDITA-DAY          PIC 99.
   398             20  SLASHA-2              PIC X VALUE '/'.
   399             20  DC-EDITA-CCYY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  11
* EL852.cbl
   400                 24  DC-EDITA-CENT     PIC 99.
   401                 24  DC-EDITA-YEAR     PIC 99.
   402         16  DC-GREG-DATE-B-EDIT.
   403             20  DC-EDITB-MONTH        PIC 99.
   404             20  SLASHB-1              PIC X VALUE '/'.
   405             20  DC-EDITB-DAY          PIC 99.
   406             20  SLASHB-2              PIC X VALUE '/'.
   407             20  DC-EDITB-CCYY.
   408                 24  DC-EDITB-CENT     PIC 99.
   409                 24  DC-EDITB-YEAR     PIC 99.
   410         16  DC-GREG-DATE-CYMD         PIC 9(08).
   411         16  DC-GREG-DATE-CYMD-R REDEFINES
   412                              DC-GREG-DATE-CYMD.
   413             20  DC-CYMD-CEN           PIC 99.
   414             20  DC-CYMD-YEAR          PIC 99.
   415             20  DC-CYMD-MONTH         PIC 99.
   416             20  DC-CYMD-DAY           PIC 99.
   417         16  DC-GREG-DATE-MDCY         PIC 9(08).
   418         16  DC-GREG-DATE-MDCY-R REDEFINES
   419                              DC-GREG-DATE-MDCY.
   420             20  DC-MDCY-MONTH         PIC 99.
   421             20  DC-MDCY-DAY           PIC 99.
   422             20  DC-MDCY-CEN           PIC 99.
   423             20  DC-MDCY-YEAR          PIC 99.
   424    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   425        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   426    12  DC-EL310-DATE                  PIC X(21).
   427    12  FILLER                         PIC X(28).
   428
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  12
* EL852.cbl
   430*                            COPY ELCLOGOF.
   431******************************************************************
   432*                                                                *
   433*                                                                *
   434*                            ELCLOGOF.                           *
   435*                            VMOD=2.001                          *
   436*                                                                *
   437*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   438*                                                                *
   439******************************************************************
   440 01  CLASIC-LOGOFF.
   441     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   442     12  LOGOFF-TEXT.
   443         16  FILLER          PIC X(5)    VALUE SPACES.
   444         16  LOGOFF-MSG.
   445             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   446             20  FILLER      PIC X       VALUE SPACES.
   447             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   448         16  FILLER          PIC X(80)
   449           VALUE '* YOU ARE NOW LOGGED OFF'.
   450         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   451         16  FILLER          PIC X       VALUE QUOTE.
   452         16  LOGOFF-SYS-MSG  PIC X(17)
   453           VALUE 'S CLAS-IC SYSTEM '.
   454     12  TEXT-MESSAGES.
   455         16  UNACCESS-MSG    PIC X(29)
   456             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   457         16  PGMIDERR-MSG    PIC X(17)
   458             VALUE 'PROGRAM NOT FOUND'.
   459
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  13
* EL852.cbl
   461*                            COPY ELCATTR.
   462******************************************************************
   463*                                                                *
   464*                            ELCATTR.                            *
   465*                            VMOD=2.001                          *
   466*                                                                *
   467*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   468*                                                                *
   469*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   470*                                                                *
   471*                   POS 1   P=PROTECTED                          *
   472*                           U=UNPROTECTED                        *
   473*                           S=ASKIP                              *
   474*                   POS 2   A=ALPHA/NUMERIC                      *
   475*                           N=NUMERIC                            *
   476*                   POS 3   N=NORMAL                             *
   477*                           B=BRIGHT                             *
   478*                           D=DARK                               *
   479*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   480*                           OF=MODIFIED DATA TAG OFF             *
   481*                                                                *
   482*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   483******************************************************************
   484 01  ATTRIBUTE-LIST.
   485     12  AL-PABOF            PIC X       VALUE 'Y'.
   486     12  AL-PABON            PIC X       VALUE 'Z'.
   487     12  AL-PADOF            PIC X       VALUE '%'.
   488     12  AL-PADON            PIC X       VALUE '_'.
   489     12  AL-PANOF            PIC X       VALUE '-'.
   490     12  AL-PANON            PIC X       VALUE '/'.
   491     12  AL-SABOF            PIC X       VALUE '8'.
   492     12  AL-SABON            PIC X       VALUE '9'.
   493     12  AL-SADOF            PIC X       VALUE '@'.
   494     12  AL-SADON            PIC X       VALUE QUOTE.
   495     12  AL-SANOF            PIC X       VALUE '0'.
   496     12  AL-SANON            PIC X       VALUE '1'.
   497     12  AL-UABOF            PIC X       VALUE 'H'.
   498     12  AL-UABON            PIC X       VALUE 'I'.
   499     12  AL-UADOF            PIC X       VALUE '<'.
   500     12  AL-UADON            PIC X       VALUE '('.
   501     12  AL-UANOF            PIC X       VALUE ' '.
   502     12  AL-UANON            PIC X       VALUE 'A'.
   503     12  AL-UNBOF            PIC X       VALUE 'Q'.
   504     12  AL-UNBON            PIC X       VALUE 'R'.
   505     12  AL-UNDOF            PIC X       VALUE '*'.
   506     12  AL-UNDON            PIC X       VALUE ')'.
   507     12  AL-UNNOF            PIC X       VALUE '&'.
   508     12  AL-UNNON            PIC X       VALUE 'J'.
   509
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  14
* EL852.cbl
   511*                                  COPY ELCEMIB.
   512******************************************************************
   513*                                                                *
   514*                                                                *
   515*                            ELCEMIB.                            *
   516*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   517*                            VMOD=2.005                          *
   518*                                                                *
   519*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   520*                                                                *
   521******************************************************************
   522 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   523     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
   524     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   525     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   526     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   527     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   528     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   529     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   530     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   531     12  EMI-SWITCH1             PIC X        VALUE '1'.
   532         88  EMI-NO-ERRORS                    VALUE '1'.
   533         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   534         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   535     12  EMI-SWITCH2             PIC X        VALUE '1'.
   536         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   537     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   538         88  EMI-AREA1-EMPTY                  VALUE '1'.
   539         88  EMI-AREA1-FULL                   VALUE '2'.
   540     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   541         88  EMI-AREA2-EMPTY                  VALUE '1'.
   542         88  EMI-AREA2-FULL                   VALUE '2'.
   543     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   544         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   545         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   546         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   547         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   548         88  EMI-BYPASS-FATALS                VALUE 'X'.
   549     12  EMI-ERROR-LINES.
   550         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   551         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   552         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   553         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   554             20  EMI-ERR-CODES OCCURS 10 TIMES.
   555                 24  EMI-ERR-NUM         PIC X(4).
   556                 24  EMI-FILLER          PIC X.
   557                 24  EMI-SEV             PIC X.
   558                 24  FILLER              PIC X.
   559             20  FILLER                  PIC X(02).
   560     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   561         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   562             20  EMI-ERROR-NUMBER    PIC X(4).
   563             20  EMI-FILL            PIC X.
   564             20  EMI-SEVERITY        PIC X.
   565             20  FILLER              PIC X.
   566             20  EMI-ERROR-TEXT.
   567                 24  EMI-TEXT-VARIABLE   PIC X(10).
   568                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  15
* EL852.cbl
   569     12  EMI-SEVERITY-SAVE           PIC X.
   570         88  EMI-NOTE                    VALUE 'N'.
   571         88  EMI-WARNING                 VALUE 'W'.
   572         88  EMI-FORCABLE                VALUE 'F'.
   573         88  EMI-FATAL                   VALUE 'X'.
   574     12  EMI-MESSAGE-FLAG            PIC X.
   575         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   576         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   577     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   578     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   579         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   580         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   581         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
   582     12  FILLER                      PIC X(137)  VALUE SPACES.
   583     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   584     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   585     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   586     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   587
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  16
* EL852.cbl
   589*                            COPY ELCINTF.
   590******************************************************************
   591*                                                                *
   592*                                                                *
   593*                            ELCINTF.                            *
   594*                            VMOD=2.017                          *
   595*                                                                *
   596*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   597*                                                                *
   598*       LENGTH = 1024                                            *
   599*                                                                *
   600******************************************************************
   601 01  PROGRAM-INTERFACE-BLOCK.
   602     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   603     12  PI-CALLING-PROGRAM              PIC X(8).
   604     12  PI-SAVED-PROGRAM-1              PIC X(8).
   605     12  PI-SAVED-PROGRAM-2              PIC X(8).
   606     12  PI-SAVED-PROGRAM-3              PIC X(8).
   607     12  PI-SAVED-PROGRAM-4              PIC X(8).
   608     12  PI-SAVED-PROGRAM-5              PIC X(8).
   609     12  PI-SAVED-PROGRAM-6              PIC X(8).
   610     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   611     12  PI-COMPANY-ID                   PIC XXX.
   612     12  PI-COMPANY-CD                   PIC X.
   613
   614     12  PI-COMPANY-PASSWORD             PIC X(8).
   615
   616     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   617
   618     12  PI-CONTROL-IN-PROGRESS.
   619         16  PI-CARRIER                  PIC X.
   620         16  PI-GROUPING                 PIC X(6).
   621         16  PI-STATE                    PIC XX.
   622         16  PI-ACCOUNT                  PIC X(10).
   623         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   624                                         PIC X(10).
   625         16  PI-CLAIM-CERT-GRP.
   626             20  PI-CLAIM-NO             PIC X(7).
   627             20  PI-CERT-NO.
   628                 25  PI-CERT-PRIME       PIC X(10).
   629                 25  PI-CERT-SFX         PIC X.
   630             20  PI-CERT-EFF-DT          PIC XX.
   631         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   632             20  PI-PLAN-CODE            PIC X(2).
   633             20  PI-REVISION-NUMBER      PIC X(3).
   634             20  PI-PLAN-EFF-DT          PIC X(2).
   635             20  PI-PLAN-EXP-DT          PIC X(2).
   636             20  FILLER                  PIC X(11).
   637         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   638             20  PI-OE-REFERENCE-1.
   639                 25  PI-OE-REF-1-PRIME   PIC X(18).
   640                 25  PI-OE-REF-1-SUFF    PIC XX.
   641
   642     12  PI-SESSION-IN-PROGRESS          PIC X.
   643         88  CLAIM-SESSION                   VALUE '1'.
   644         88  CREDIT-SESSION                  VALUE '2'.
   645         88  WARRANTY-SESSION                VALUE '3'.
   646         88  MORTGAGE-SESSION                VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  17
* EL852.cbl
   647         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   648
   649
   650*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   651
   652     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   653     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   654
   655     12  PI-CREDIT-USER                  PIC X.
   656         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   657         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   658
   659     12  PI-CLAIM-USER                   PIC X.
   660         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   661         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   662
   663     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   664         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   665         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   666         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   667         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   668         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   669
   670     12  PI-PROCESSOR-ID                 PIC X(4).
   671
   672     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   673
   674     12  PI-MEMBER-CAPTION               PIC X(10).
   675
   676     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   677         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   678
   679     12  PI-LIFE-OVERRIDE-L1             PIC X.
   680     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   681     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   682     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   683
   684     12  PI-AH-OVERRIDE-L1               PIC X.
   685     12  PI-AH-OVERRIDE-L2               PIC XX.
   686     12  PI-AH-OVERRIDE-L6               PIC X(6).
   687     12  PI-AH-OVERRIDE-L12              PIC X(12).
   688
   689     12  PI-NEW-SYSTEM                   PIC X(2).
   690
   691     12  PI-PRIMARY-CERT-NO              PIC X(11).
   692     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   693         88  PI-USES-PAID-TO                 VALUE '1'.
   694     12  PI-CRDTCRD-SYSTEM.
   695         16  PI-CRDTCRD-USER             PIC X.
   696             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
   697             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   698         16  PI-CC-MONTH-END-DT          PIC XX.
   699     12  PI-PROCESSOR-PRINTER            PIC X(4).
   700
   701     12  PI-OE-REFERENCE-2.
   702         16  PI-OE-REF-2-PRIME           PIC X(10).
   703         16  PI-OE-REF-2-SUFF            PIC X.
   704
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  18
* EL852.cbl
   705     12  PI-REM-TRM-CALC-OPTION          PIC X.
   706
   707     12  PI-LANGUAGE-TYPE                PIC X.
   708             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   709             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   710             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   711
   712     12  PI-POLICY-LINKAGE-IND           PIC X.
   713         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   714         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   715                                                   LOW-VALUES.
   716
   717     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   718     12  PI-CLAIM-PW-SESSION             PIC X(1).
   719         88  PI-CLAIM-CREDIT                 VALUE '1'.
   720         88  PI-CLAIM-CONVEN                 VALUE '2'.
   721     12  FILLER                          PIC X(4).
   722
   723     12  PI-SYSTEM-LEVEL                 PIC X(145).
   724
   725     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   726         PI-SYSTEM-LEVEL.
   727
   728         16  PI-ENTRY-CODES.
   729             20  PI-ENTRY-CD-1           PIC X.
   730             20  PI-ENTRY-CD-2           PIC X.
   731
   732         16  PI-RETURN-CODES.
   733             20  PI-RETURN-CD-1          PIC X.
   734             20  PI-RETURN-CD-2          PIC X.
   735
   736         16  PI-UPDATE-STATUS-SAVE.
   737             20  PI-UPDATE-BY            PIC X(4).
   738             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   739
   740         16  PI-LOWER-CASE-LETTERS       PIC X.
   741             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   742
   743*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   744*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   745*            88  CARRIER-CLM-CNTL            VALUE '2'.
   746
   747         16  PI-CERT-ACCESS-CONTROL      PIC X.
   748             88  ST-ACCNT-CNTL               VALUE ' '.
   749             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
   750             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   751             88  ACCNT-CNTL                  VALUE '3'.
   752             88  CARR-ACCNT-CNTL             VALUE '4'.
   753
   754         16  PI-PROCESSOR-CAP-LIST.
   755             20  PI-SYSTEM-CONTROLS.
   756                24 PI-SYSTEM-DISPLAY     PIC X.
   757                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   758                24 PI-SYSTEM-MODIFY      PIC X.
   759                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   760             20  FILLER                  PIC XX.
   761             20  PI-DISPLAY-CAP          PIC X.
   762                 88  DISPLAY-CAP             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  19
* EL852.cbl
   763             20  PI-MODIFY-CAP           PIC X.
   764                 88  MODIFY-CAP              VALUE 'Y'.
   765             20  PI-MSG-AT-LOGON-CAP     PIC X.
   766                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   767             20  PI-FORCE-CAP            PIC X.
   768                 88  FORCE-CAP               VALUE 'Y'.
   769
   770         16  PI-PROGRAM-CONTROLS.
   771             20  PI-PGM-PRINT-OPT        PIC X.
   772             20  PI-PGM-FORMAT-OPT       PIC X.
   773             20  PI-PGM-PROCESS-OPT      PIC X.
   774             20  PI-PGM-TOTALS-OPT       PIC X.
   775
   776         16  PI-HELP-INTERFACE.
   777             20  PI-LAST-ERROR-NO        PIC X(4).
   778             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   779
   780         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   781             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   782
   783         16  PI-CR-CONTROL-IN-PROGRESS.
   784             20  PI-CR-CARRIER           PIC X.
   785             20  PI-CR-GROUPING          PIC X(6).
   786             20  PI-CR-STATE             PIC XX.
   787             20  PI-CR-ACCOUNT           PIC X(10).
   788             20  PI-CR-FIN-RESP          PIC X(10).
   789             20  PI-CR-TYPE              PIC X.
   790
   791         16  PI-CR-BATCH-NUMBER          PIC X(6).
   792
   793         16  PI-CR-MONTH-END-DT          PIC XX.
   794
   795         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   796             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   797             88  PI-ZERO-CARRIER             VALUE '1'.
   798             88  PI-ZERO-GROUPING            VALUE '2'.
   799             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   800
   801         16  PI-CARRIER-SECURITY         PIC X.
   802             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   803
   804         16  PI-ACCOUNT-SECURITY         PIC X(10).
   805             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   806             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   807
   808         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   809             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   810                                         INDEXED BY PI-ACCESS-NDX
   811                                         PIC X.
   812
   813         16  PI-GA-BILLING-CONTROL       PIC X.
   814             88  PI-GA-BILLING               VALUE '1'.
   815
   816         16  PI-MAIL-PROCESSING          PIC X.
   817             88  PI-MAIL-YES                 VALUE 'Y'.
   818
   819         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   820
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  20
* EL852.cbl
   821         16  PI-AR-SYSTEM.
   822             20  PI-AR-PROCESSING-CNTL   PIC X.
   823                 88  PI-AR-PROCESSING        VALUE 'Y'.
   824             20  PI-AR-SUMMARY-CODE      PIC X(6).
   825             20  PI-AR-MONTH-END-DT      PIC XX.
   826
   827         16  PI-MP-SYSTEM.
   828             20  PI-MORTGAGE-USER            PIC X.
   829                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   830                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   831             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   832                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   833                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   834                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   835                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   836                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   837             20  PI-MP-MONTH-END-DT          PIC XX.
   838             20  PI-MP-REFERENCE-NO.
   839                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   840                 24  PI-MP-REFERENCE-SFX     PIC XX.
   841
   842         16  PI-LABEL-CONTROL            PIC X(01).
   843             88  PI-CREATE-LABELS                    VALUE 'Y'.
   844             88  PI-BYPASS-LABELS                    VALUE 'N'.
   845
   846         16  PI-BILL-GROUPING-CODE       PIC X(01).
   847             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   848
   849         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   850             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   851             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   852
   853         16  FILLER                      PIC X(14).
   854
   855     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   856******************************************************************
   857*    COPY ELC852PI.
   858
   859******************************************************************
   860*                            ELC852PI                            *
   861*                            VMOD=2.002                          *
   862*                                                                *
   863*                                                                *
   864******************************************************************
   865
   866     12  FILLER    REDEFINES PI-PROGRAM-WORK-AREA.
   867         16  PI-OPTION               PIC X.
   868             88  PI-NO-OPTION-SELECTED     VALUE ' '.
   869             88  PI-OPTION-ONE-SELECTED    VALUE '1'.
   870             88  PI-OPTION-TWO-SELECTED    VALUE '2'.
   871             88  PI-OPTION-THREE-SELECTED  VALUE '3'.
   872             88  PI-OPTION-FOUR-SELECTED   VALUE '4'.
   873
   874         16  PI-FILE-ID              PIC X(8).
   875         16  PI-ACCESS-KEY           PIC X(46).
   876         16  PI-SELECT-KEY           PIC X(46).
   877
   878         16  PI-1ST-REQUEST-KEY      PIC X(46).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  21
* EL852.cbl
   879
   880         16  PI-MAP-NAME             PIC X(8).
   881
   882         16  PI-PREV-MAP-NAME        PIC X(8).
   883
   884         16  PI-TOP-OF-FILE-SW       PIC X.
   885             88 PI-TOP-OF-FILE              VALUE 'Y'.
   886
   887         16  PI-END-OF-FILE-SW       PIC X.
   888             88 PI-END-OF-FILE              VALUE 'Y'.
   889
   890         16  PI-REQUEST-KEY OCCURS 10 PIC X(46).
   891
   892         16  FILLER                  PIC X(15).
   893
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  22
* EL852.cbl
   896*                            COPY ELCJPFX.
   897******************************************************************
   898*                                                                *
   899*                                                                *
   900*                            ELCJPFX.                            *
   901*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   902*                            VMOD=2.002                          *
   903*                                                                *
   904*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
   905*                                                                *
   906*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
   907*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
   908*        ELCNTL - CONTROL FILE                                   *
   909*        ELMSTR - CLAIM MASTERS                                  *
   910*        ELTRLR - ACTIVITY TRAILERS                              *
   911*        ELCHKQ - CHECK QUE                                      *
   912******************************************************************
   913 01  JOURNAL-RECORD.
   914     12  JP-USER-ID                  PIC X(4).
   915     12  JP-FILE-ID                  PIC X(8).
   916     12  JP-PROGRAM-ID               PIC X(8).
   917     12  JP-RECORD-TYPE              PIC X.
   918         88 JP-ADD              VALUE 'A'.
   919         88 JP-BEFORE-CHANGE    VALUE 'B'.
   920         88 JP-AFTER-CHANGE     VALUE 'C'.
   921         88 JP-DELETE           VALUE 'D'.
   922         88 JP-GENERIC-DELETE   VALUE 'G'.
   923         88 JP-KEY-CHG-DELETE   VALUE 'K'.
   924         88 JP-KEY-CHG-ADD      VALUE 'N'.
   925     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
   926     12  JP-RECORD-AREA
   927
   928
   929                             PIC X(223).
   930
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  23
* EL852.cbl
   932*                            COPY ELCAID.
   933******************************************************************
   934*                                                                *
   935*                            ELCAID.                             *
   936*                            VMOD=2.001                          *
   937*                                                                *
   938*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
   939*                                                                *
   940*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
   941*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
   942******************************************************************
   943
   944 01  DFHAID.
   945   02  DFHNULL   PIC  X  VALUE  ' '.
   946   02  DFHENTER  PIC  X  VALUE  QUOTE.
   947   02  DFHCLEAR  PIC  X  VALUE  '_'.
   948   02  DFHPEN    PIC  X  VALUE  '='.
   949   02  DFHOPID   PIC  X  VALUE  'W'.
   950   02  DFHPA1    PIC  X  VALUE  '%'.
   951   02  DFHPA2    PIC  X  VALUE  '>'.
   952   02  DFHPA3    PIC  X  VALUE  ','.
   953   02  DFHPF1    PIC  X  VALUE  '1'.
   954   02  DFHPF2    PIC  X  VALUE  '2'.
   955   02  DFHPF3    PIC  X  VALUE  '3'.
   956   02  DFHPF4    PIC  X  VALUE  '4'.
   957   02  DFHPF5    PIC  X  VALUE  '5'.
   958   02  DFHPF6    PIC  X  VALUE  '6'.
   959   02  DFHPF7    PIC  X  VALUE  '7'.
   960   02  DFHPF8    PIC  X  VALUE  '8'.
   961   02  DFHPF9    PIC  X  VALUE  '9'.
   962   02  DFHPF10   PIC  X  VALUE  ':'.
   963   02  DFHPF11   PIC  X  VALUE  '#'.
   964   02  DFHPF12   PIC  X  VALUE  '@'.
   965   02  DFHPF13   PIC  X  VALUE  'A'.
   966   02  DFHPF14   PIC  X  VALUE  'B'.
   967   02  DFHPF15   PIC  X  VALUE  'C'.
   968   02  DFHPF16   PIC  X  VALUE  'D'.
   969   02  DFHPF17   PIC  X  VALUE  'E'.
   970   02  DFHPF18   PIC  X  VALUE  'F'.
   971   02  DFHPF19   PIC  X  VALUE  'G'.
   972   02  DFHPF20   PIC  X  VALUE  'H'.
   973   02  DFHPF21   PIC  X  VALUE  'I'.
   974*00039    02  DFHPF22   PIC  X  VALUE  ''.
   975   02  DFHPF22   PIC  X  VALUE  '['.
   976   02  DFHPF23   PIC  X  VALUE  '.'.
   977   02  DFHPF24   PIC  X  VALUE  '<'.
   978   02  DFHMSRE   PIC  X  VALUE  'X'.
   979   02  DFHSTRF   PIC  X  VALUE  'h'.
   980   02  DFHTRIG   PIC  X  VALUE  '"'.
   981 01  FILLER    REDEFINES DFHAID.
   982     12  FILLER              PIC X(8).
   983     12  PF-VALUES           PIC X       OCCURS 2.
   984
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  24
* EL852.cbl
   986*                            COPY EL852S.
   987 01  EL852AI.
   988     05  FILLER            PIC  X(0012).
   989*    -------------------------------
   990     05  DATEL PIC S9(0004) COMP.
   991     05  DATEF PIC  X(0001).
   992     05  FILLER REDEFINES DATEF.
   993         10  DATEA PIC  X(0001).
   994     05  DATEI PIC  X(0008).
   995*    -------------------------------
   996     05  TIMEL PIC S9(0004) COMP.
   997     05  TIMEF PIC  X(0001).
   998     05  FILLER REDEFINES TIMEF.
   999         10  TIMEA PIC  X(0001).
  1000     05  TIMEI PIC  X(0005).
  1001*    -------------------------------
  1002     05  MAINTL PIC S9(0004) COMP.
  1003     05  MAINTF PIC  X(0001).
  1004     05  FILLER REDEFINES MAINTF.
  1005         10  MAINTA PIC  X(0001).
  1006     05  MAINTI PIC  X(0001).
  1007*    -------------------------------
  1008     05  FRCARL PIC S9(0004) COMP.
  1009     05  FRCARF PIC  X(0001).
  1010     05  FILLER REDEFINES FRCARF.
  1011         10  FRCARA PIC  X(0001).
  1012     05  FRCARI PIC  X(0001).
  1013*    -------------------------------
  1014     05  FRGRPL PIC S9(0004) COMP.
  1015     05  FRGRPF PIC  X(0001).
  1016     05  FILLER REDEFINES FRGRPF.
  1017         10  FRGRPA PIC  X(0001).
  1018     05  FRGRPI PIC  X(0006).
  1019*    -------------------------------
  1020     05  FRESPL PIC S9(0004) COMP.
  1021     05  FRESPF PIC  X(0001).
  1022     05  FILLER REDEFINES FRESPF.
  1023         10  FRESPA PIC  X(0001).
  1024     05  FRESPI PIC  X(0010).
  1025*    -------------------------------
  1026     05  ACCTCARL PIC S9(0004) COMP.
  1027     05  ACCTCARF PIC  X(0001).
  1028     05  FILLER REDEFINES ACCTCARF.
  1029         10  ACCTCARA PIC  X(0001).
  1030     05  ACCTCARI PIC  X(0001).
  1031*    -------------------------------
  1032     05  ACCTGRPL PIC S9(0004) COMP.
  1033     05  ACCTGRPF PIC  X(0001).
  1034     05  FILLER REDEFINES ACCTGRPF.
  1035         10  ACCTGRPA PIC  X(0001).
  1036     05  ACCTGRPI PIC  X(0006).
  1037*    -------------------------------
  1038     05  ACCTSTL PIC S9(0004) COMP.
  1039     05  ACCTSTF PIC  X(0001).
  1040     05  FILLER REDEFINES ACCTSTF.
  1041         10  ACCTSTA PIC  X(0001).
  1042     05  ACCTSTI PIC  X(0002).
  1043*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  25
* EL852.cbl
  1044     05  ACCOUNTL PIC S9(0004) COMP.
  1045     05  ACCOUNTF PIC  X(0001).
  1046     05  FILLER REDEFINES ACCOUNTF.
  1047         10  ACCOUNTA PIC  X(0001).
  1048     05  ACCOUNTI PIC  X(0010).
  1049*    -------------------------------
  1050     05  ACCTREFL PIC S9(0004) COMP.
  1051     05  ACCTREFF PIC  X(0001).
  1052     05  FILLER REDEFINES ACCTREFF.
  1053         10  ACCTREFA PIC  X(0001).
  1054     05  ACCTREFI PIC  X(0012).
  1055*    -------------------------------
  1056     05  SUMMARYL PIC S9(0004) COMP.
  1057     05  SUMMARYF PIC  X(0001).
  1058     05  FILLER REDEFINES SUMMARYF.
  1059         10  SUMMARYA PIC  X(0001).
  1060     05  SUMMARYI PIC  X(0006).
  1061*    -------------------------------
  1062     05  BATCHL PIC S9(0004) COMP.
  1063     05  BATCHF PIC  X(0001).
  1064     05  FILLER REDEFINES BATCHF.
  1065         10  BATCHA PIC  X(0001).
  1066     05  BATCHI PIC  X(0006).
  1067*    -------------------------------
  1068     05  ERMESGL PIC S9(0004) COMP.
  1069     05  ERMESGF PIC  X(0001).
  1070     05  FILLER REDEFINES ERMESGF.
  1071         10  ERMESGA PIC  X(0001).
  1072     05  ERMESGI PIC  X(0079).
  1073*    -------------------------------
  1074     05  PFENTERL PIC S9(0004) COMP.
  1075     05  PFENTERF PIC  X(0001).
  1076     05  FILLER REDEFINES PFENTERF.
  1077         10  PFENTERA PIC  X(0001).
  1078     05  PFENTERI PIC  9(2).
  1079 01  EL852AO REDEFINES EL852AI.
  1080     05  FILLER            PIC  X(0012).
  1081*    -------------------------------
  1082     05  FILLER            PIC  X(0003).
  1083     05  DATEO PIC  X(0008).
  1084*    -------------------------------
  1085     05  FILLER            PIC  X(0003).
  1086     05  TIMEO PIC  99.99.
  1087*    -------------------------------
  1088     05  FILLER            PIC  X(0003).
  1089     05  MAINTO PIC  X(0001).
  1090*    -------------------------------
  1091     05  FILLER            PIC  X(0003).
  1092     05  FRCARO PIC  X(0001).
  1093*    -------------------------------
  1094     05  FILLER            PIC  X(0003).
  1095     05  FRGRPO PIC  X(0006).
  1096*    -------------------------------
  1097     05  FILLER            PIC  X(0003).
  1098     05  FRESPO PIC  X(0010).
  1099*    -------------------------------
  1100     05  FILLER            PIC  X(0003).
  1101     05  ACCTCARO PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  26
* EL852.cbl
  1102*    -------------------------------
  1103     05  FILLER            PIC  X(0003).
  1104     05  ACCTGRPO PIC  X(0006).
  1105*    -------------------------------
  1106     05  FILLER            PIC  X(0003).
  1107     05  ACCTSTO PIC  X(0002).
  1108*    -------------------------------
  1109     05  FILLER            PIC  X(0003).
  1110     05  ACCOUNTO PIC  X(0010).
  1111*    -------------------------------
  1112     05  FILLER            PIC  X(0003).
  1113     05  ACCTREFO PIC  X(0012).
  1114*    -------------------------------
  1115     05  FILLER            PIC  X(0003).
  1116     05  SUMMARYO PIC  X(0006).
  1117*    -------------------------------
  1118     05  FILLER            PIC  X(0003).
  1119     05  BATCHO PIC  X(0006).
  1120*    -------------------------------
  1121     05  FILLER            PIC  X(0003).
  1122     05  ERMESGO PIC  X(0079).
  1123*    -------------------------------
  1124     05  FILLER            PIC  X(0003).
  1125     05  PFENTERO PIC  X(0002).
  1126*    -------------------------------
  1127
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  27
* EL852.cbl
  1129
  1130
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  28
* EL852.cbl
  1132****************************************************************
  1133*
  1134* Copyright (c) 2007 by Clerity Solutions, Inc.
  1135* All rights reserved.
  1136*
  1137****************************************************************
  1138 01  DFHEIV.
  1139   02  DFHEIV0               PIC X(35).
  1140   02  DFHEIV1               PIC X(08).
  1141   02  DFHEIV2               PIC X(08).
  1142   02  DFHEIV3               PIC X(08).
  1143   02  DFHEIV4               PIC X(06).
  1144   02  DFHEIV5               PIC X(04).
  1145   02  DFHEIV6               PIC X(04).
  1146   02  DFHEIV7               PIC X(02).
  1147   02  DFHEIV8               PIC X(02).
  1148   02  DFHEIV9               PIC X(01).
  1149   02  DFHEIV10              PIC S9(7) COMP-3.
  1150   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1151   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1152   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1153   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1154   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1155   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1156   02  DFHEIV17              PIC X(04).
  1157   02  DFHEIV18              PIC X(04).
  1158   02  DFHEIV19              PIC X(04).
  1159   02  DFHEIV20              USAGE IS POINTER.
  1160   02  DFHEIV21              USAGE IS POINTER.
  1161   02  DFHEIV22              USAGE IS POINTER.
  1162   02  DFHEIV23              USAGE IS POINTER.
  1163   02  DFHEIV24              USAGE IS POINTER.
  1164   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1165   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1166   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1167   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1168   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1169   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1170   02  FILLER                PIC X(02).
  1171   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1172   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1173   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1174   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1175   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1176 LINKAGE  SECTION.
  1177*****************************************************************
  1178*                                                               *
  1179* Copyright (c) 2007 by Clerity Solutions, Inc.                 *
  1180* All rights reserved.                                          *
  1181*                                                               *
  1182*****************************************************************
  1183 01  dfheiblk.
  1184     02  eibtime          pic s9(7) comp-3.
  1185     02  eibdate          pic s9(7) comp-3.
  1186     02  eibtrnid         pic x(4).
  1187     02  eibtaskn         pic s9(7) comp-3.
  1188     02  eibtrmid         pic x(4).
  1189     02  dfheigdi         pic s9(4) comp.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  29
* EL852.cbl
  1190     02  eibcposn         pic s9(4) comp.
  1191     02  eibcalen         pic s9(4) comp.
  1192     02  eibaid           pic x(1).
  1193     02  eibfiller1       pic x(1).
  1194     02  eibfn            pic x(2).
  1195     02  eibfiller2       pic x(2).
  1196     02  eibrcode         pic x(6).
  1197     02  eibfiller3       pic x(2).
  1198     02  eibds            pic x(8).
  1199     02  eibreqid         pic x(8).
  1200     02  eibrsrce         pic x(8).
  1201     02  eibsync          pic x(1).
  1202     02  eibfree          pic x(1).
  1203     02  eibrecv          pic x(1).
  1204     02  eibsend          pic x(1).
  1205     02  eibatt           pic x(1).
  1206     02  eibeoc           pic x(1).
  1207     02  eibfmh           pic x(1).
  1208     02  eibcompl         pic x(1).
  1209     02  eibsig           pic x(1).
  1210     02  eibconf          pic x(1).
  1211     02  eiberr           pic x(1).
  1212     02  eibrldbk         pic x(1).
  1213     02  eiberrcd         pic x(4).
  1214     02  eibsynrb         pic x(1).
  1215     02  eibnodat         pic x(1).
  1216     02  eibfiller5       pic x(2).
  1217     02  eibresp          pic 9(09) comp.
  1218     02  eibresp2         pic 9(09) comp.
  1219     02  dfheigdj         pic s9(4) comp.
  1220     02  dfheigdk         pic s9(4) comp.
  1221 01  DFHCOMMAREA             PIC X(1024).
  1222
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  30
* EL852.cbl
  1224
  1225*                                COPY ERCRQST.
  1226******************************************************************
  1227*                                                                *
  1228*                                                                *
  1229*                            ERCRQST.                            *
  1230*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1231*                            VMOD=2.002                          *
  1232*                                                                *
  1233*   FILE DESCRIPTION = ACCOUNTS RECEIVABLE REQUEST RECORD        *
  1234*                                                                *
  1235*   FILE TYPE = VSAM,KSDS                                        *
  1236*   RECORD SIZE = 200  RECFORM = FIXED                           *
  1237*                                                                *
  1238*   BASE CLUSTER = ERRQST                         RKP=2,LEN=7    *
  1239*       ALTERNATE PATH1 = ERRQST2  (BY CO, CAR, GROUP, ST,       *
  1240*                                   ACCOUNT, REF, BATCH)         *
  1241*                                                RKP=9, LEN=38   *
  1242*       ALTERNATE PATH2 = ERRQST3  (BY CO, CAR, GROUP, FIN  RESP *
  1243*                                   ACCOUNT, REF, BATCH)         *
  1244*                                                RKP=47, LEN=46  *
  1245*       ALTERNATE PATH3 = ERRQST4  (BY CO, CAR, GROUP, AGENT,    *
  1246*                                   BATCH)                       *
  1247*                                                RKP=93, LEN=24  *
  1248*       ALTERNATE PATH4 = ERRQST5  (BY CO, SUMMARY CODE, ACCT,   *
  1249*                                   REF, BATCH)                  *
  1250*                                                RKP=117, LEN=35 *
  1251*   LOG = NO                                                     *
  1252*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1253******************************************************************
  1254
  1255 01  AR-REQUEST-RECORD.
  1256     12  RQ-RECORD-ID                     PIC XX.
  1257         88  VALID-RQ-ID                        VALUE 'RQ'.
  1258
  1259     12  RQ-CONTROL-PRIMARY.
  1260         16  RQ-COMPANY-CD                PIC X.
  1261         16  RQ-ENTRY-BATCH               PIC X(6).
  1262
  1263     12  RQ-CONTROL-BY-ACCT-REF.
  1264         16  RQ-COMPANY-CD-A1             PIC X.
  1265         16  RQ-CARRIER-A1                PIC X.
  1266         16  RQ-GROUPING-A1               PIC X(6).
  1267         16  RQ-STATE-A1                  PIC XX.
  1268         16  RQ-ACCOUNT-A1                PIC X(10).
  1269         16  RQ-REFERENCE-A1              PIC X(12).
  1270         16  RQ-BATCH-A1                  PIC X(6).
  1271
  1272     12  RQ-CONTROL-BY-FIN-RESP.
  1273         16  RQ-COMPANY-CD-A2             PIC X.
  1274         16  RQ-CARRIER-A2                PIC X.
  1275         16  RQ-GROUPING-A2               PIC X(6).
  1276         16  RQ-FIN-RESP-A2               PIC X(10).
  1277         16  RQ-ACCT-AGENT-A2             PIC X(10).
  1278         16  RQ-REFERENCE-A2              PIC X(12).
  1279         16  RQ-BATCH-A2                  PIC X(6).
  1280
  1281     12  RQ-CONTROL-BY-ACCT-AGENT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  31
* EL852.cbl
  1282         16  RQ-COMPANY-CD-A3             PIC X.
  1283         16  RQ-CARRIER-A3                PIC X.
  1284         16  RQ-GROUPING-A3               PIC X(6).
  1285         16  RQ-ACCT-AGENT-A3             PIC X(10).
  1286         16  RQ-BATCH-A3                  PIC X(6).
  1287
  1288     12  RQ-CONTROL-BY-SUMMARY.
  1289         16  RQ-COMPANY-CD-A4             PIC X.
  1290         16  RQ-SUMMARY-CODE              PIC X(6).
  1291         16  RQ-ACCOUNT-A4                PIC X(10).
  1292         16  RQ-REFERENCE-A4              PIC X(12).
  1293         16  RQ-BATCH-A4                  PIC X(6).
  1294
  1295     12  RQ-REQUEST-METHOD                PIC X.
  1296         88 RQ-FIN-RESP-REQUEST               VALUE 'F'.
  1297         88 RQ-ACCT-AGENT-REQUEST             VALUE 'A'.
  1298         88 RQ-SUMMARY-REQUEST                VALUE 'S'.
  1299         88 RQ-BATCH-REQUEST                  VALUE 'B'.
  1300     12  FILLER                           PIC X.
  1301     12  RQ-STATUS                        PIC X.
  1302         88  RQ-REQUEST-ERROR                 VALUE 'E'.
  1303         88  RQ-RESUBMIT                      VALUE 'R'.
  1304     12  RQ-PROCESSOR-ID                  PIC X(4).
  1305     12  RQ-ENTRY-DT                      PIC XX.
  1306     12  RQ-MO-END-DT                     PIC XX.
  1307     12  RQ-REQUEST-DT                    PIC XX.
  1308     12  RQ-STMT-DT                       PIC XX.
  1309     12  RQ-REVERSAL-DT                   PIC XX.
  1310     12  RQ-CREDIT-SELECT-DT              PIC XX.
  1311     12  RQ-CREDIT-ACCEPT-DT              PIC XX.
  1312
  1313     12  FILLER                           PIC X(27).
  1314
  1315******************************************************************
  1316
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  32
* EL852.cbl
  1318
  1319*                                COPY ERCSUMM.
  1320******************************************************************
  1321*                                                                *
  1322*                                                                *
  1323*                            ERCSUMM                             *
  1324*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1325*                            VMOD=2.002                          *
  1326*                                                                *
  1327*   ONLINE CREDIT SYSTEM                                         *
  1328*                                                                *
  1329*   FILE DESCRIPTION = AR SUMMARY CROSS REFERENCE                *
  1330*                                                                *
  1331*   FILE TYPE = VSAM,KSDS                                        *
  1332*   RECORD SIZE = 150           RECFORM = FIXED                  *
  1333*                                                                *
  1334*   BASE CLUSTER NAME = ERSUMM                   RKP=2,LEN=34    *
  1335*                                                                *
  1336*       ALTERNATE PATH1 = ERSUMM2  (BY CO SUMMARY CARR           *
  1337*                                      GROUP F.R. AGENT)         *
  1338*                                                 RKP=36 ,LEN=34 *
  1339*                                                                *
  1340*   LOG = NO                                                     *
  1341*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1342*                                                                *
  1343******************************************************************
  1344
  1345 01  SUMM-CROSS-REFERENCE.
  1346     12  SX-RECORD-ID                PIC XX.
  1347         88  VALID-SX-ID             VALUE 'SX'.
  1348
  1349     12  SX-CONTROL-PRIMARY.
  1350         16  SX-COMPANY-CD           PIC X.
  1351         16  SX-SUMMARY              PIC X(6).
  1352         16  SX-CARRIER              PIC X.
  1353         16  SX-GROUP                PIC X(6).
  1354         16  SX-FIN-RESP             PIC X(10).
  1355         16  SX-ACCT-AGENT           PIC X(10).
  1356
  1357     12  SX-CONTROL-A1.
  1358         16  SX-COMPANY-A1           PIC X.
  1359         16  SX-ACCT-AGENT-A1        PIC X(10).
  1360         16  SX-SUMMARY-A1           PIC X(6).
  1361         16  SX-CARR-A1              PIC X.
  1362         16  SX-GROUP-A1             PIC X(6).
  1363         16  SX-FIN-RESP-A1          PIC X(10).
  1364
  1365     12  SX-MAINT-INFORMATION.
  1366         16  SX-LAST-MAINT-DT        PIC XX.
  1367         16  SX-LAST-MAINT-BY        PIC X(4).
  1368         16  SX-LAST-MAINT-HHMMSS    PIC S9(7)  COMP-3.
  1369
  1370     12  SX-SUMM-OR-AGT-NAME         PIC X(30).
  1371
  1372     12  FILLER                      PIC X(40).
  1373
  1374******************************************************************
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  33
* EL852.cbl
  1376
  1377 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA AR-REQUEST-RECORD
  1378                          SUMM-CROSS-REFERENCE.
  1379 0000-DFHEXIT SECTION.
  1380     MOVE '9#                    $   ' TO DFHEIV0.
  1381     MOVE 'EL852' TO DFHEIV1.
  1382     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1383
  1384     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  1385     MOVE 1                      TO EMI-NUMBER-OF-LINES.
  1386
  1387     IF EIBCALEN = 0
  1388         GO TO 8800-UNAUTHORIZED-ACCESS.
  1389
  1390     MOVE EIBTRMID               TO QID-TERM.
  1391     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  1392     MOVE '5'                    TO DC-OPTION-CODE.
  1393     PERFORM 8500-DATE-CONVERT THRU 8500-EXIT.
  1394     MOVE DC-BIN-DATE-1          TO WS-CURRENT-BIN-DT.
  1395     MOVE DC-GREG-DATE-1-EDIT    TO WS-CURRENT-DT.
  1396
  1397     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1398         IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1399             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  1400             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  1401             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  1402             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  1403             MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  1404             MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  1405             MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  1406             MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  1407         ELSE
  1408             MOVE PI-RETURN-TO-PROGRAM TO PI-CALLING-PROGRAM
  1409             MOVE PI-SAVED-PROGRAM-1   TO PI-RETURN-TO-PROGRAM
  1410             MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-1
  1411             MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-2
  1412             MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-3
  1413             MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-4
  1414             MOVE PI-SAVED-PROGRAM-6   TO PI-SAVED-PROGRAM-5
  1415             MOVE SPACES               TO PI-SAVED-PROGRAM-6.
  1416
  1417     MOVE LOW-VALUES             TO EL852AI.
  1418
  1419     IF EIBTRNID NOT = TRANS-EXJ2
  1420        GO TO 8100-SEND-INITIAL-MAP.
  1421
  1422
  1423* EXEC CICS HANDLE CONDITION
  1424*        PGMIDERR  (9600-PGMID-ERROR)
  1425*        ERROR     (9990-ABEND)
  1426*    END-EXEC.
  1427*    MOVE '"$L.                  ! " #00001418' TO DFHEIV0
  1428     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1429     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1430     MOVE X'2220233030303031343138' TO DFHEIV0(25:11)
  1431     CALL 'kxdfhei1' USING DFHEIV0
  1432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1433
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  34
* EL852.cbl
  1434
  1435     IF EIBAID = DFHCLEAR
  1436         GO TO 9400-CLEAR.
  1437
  1438
  1439     IF PI-PROCESSOR-ID = 'LGXX'
  1440         GO TO 0200-RECEIVE.
  1441
  1442
  1443* EXEC CICS READQ TS
  1444*        QUEUE  (QID)
  1445*        INTO   (SECURITY-CONTROL)
  1446*        LENGTH (SC-COMM-LENGTH)
  1447*        ITEM   (SC-ITEM)
  1448*    END-EXEC.
  1449*    MOVE '*$II   L              ''   #00001430' TO DFHEIV0
  1450     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  1451     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1452     MOVE X'2020233030303031343330' TO DFHEIV0(25:11)
  1453     CALL 'kxdfhei1' USING DFHEIV0,
  1454           QID,
  1455           SECURITY-CONTROL,
  1456           SC-COMM-LENGTH,
  1457           SC-ITEM,
  1458           DFHEIV99,
  1459           DFHEIV99
  1460     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1461
  1462
  1463     MOVE SC-CREDIT-DISPLAY (2)   TO PI-DISPLAY-CAP.
  1464     MOVE SC-CREDIT-UPDATE  (2)   TO PI-MODIFY-CAP.
  1465
  1466     IF NOT DISPLAY-CAP
  1467         MOVE 'READ'          TO SM-READ
  1468         PERFORM 9995-SECURITY-VIOLATION
  1469         MOVE ER-0070         TO  EMI-ERROR
  1470         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1471         GO TO 8100-SEND-INITIAL-MAP.
  1472
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  35
* EL852.cbl
  1474
  1475******************************************************************
  1476*                                                                *
  1477*              R E C E I V E   M A P                             *
  1478*                                                                *
  1479******************************************************************
  1480
  1481 0200-RECEIVE.
  1482
  1483     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1484         MOVE ER-0008            TO EMI-ERROR
  1485         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1486         MOVE -1                 TO MAINTL
  1487         GO TO 8200-SEND-DATAONLY.
  1488
  1489
  1490* EXEC CICS RECEIVE
  1491*        MAP      (EL852A)
  1492*        MAPSET   (MAPSET-EL852S)
  1493*        INTO     (EL852AI)
  1494*    END-EXEC.
  1495     MOVE LENGTH OF
  1496      EL852AI
  1497       TO DFHEIV11
  1498*    MOVE '8"T I  L              ''   #00001463' TO DFHEIV0
  1499     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1500     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1501     MOVE X'2020233030303031343633' TO DFHEIV0(25:11)
  1502     CALL 'kxdfhei1' USING DFHEIV0,
  1503           EL852A,
  1504           EL852AI,
  1505           DFHEIV11,
  1506           MAPSET-EL852S,
  1507           DFHEIV99,
  1508           DFHEIV99
  1509     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1510
  1511
  1512
  1513     IF PFENTERL GREATER THAN ZERO
  1514        IF EIBAID NOT = DFHENTER
  1515           MOVE ER-0004          TO EMI-ERROR
  1516           MOVE AL-UNBOF         TO PFENTERA
  1517           MOVE -1               TO PFENTERL
  1518           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1519           GO TO 8200-SEND-DATAONLY
  1520        ELSE
  1521           IF (PFENTERI NUMERIC) AND
  1522              (PFENTERI GREATER 0 AND LESS 25)
  1523              MOVE PF-VALUES (PFENTERI) TO EIBAID
  1524           ELSE
  1525              MOVE ER-0029       TO EMI-ERROR
  1526              MOVE AL-UNBOF      TO PFENTERA
  1527              MOVE -1            TO PFENTERL
  1528              PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1529              GO TO 8200-SEND-DATAONLY.
  1530
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  36
* EL852.cbl
  1532
  1533******************************************************************
  1534*                                                                *
  1535*              C H E C K   P F K E Y S                           *
  1536*                                                                *
  1537******************************************************************
  1538
  1539 0300-CHECK-PFKEYS.
  1540
  1541     IF EIBAID = DFHPF23
  1542         GO TO 8810-PF23.
  1543
  1544     IF EIBAID = DFHPF24
  1545         GO TO 9200-RETURN-MAIN-MENU.
  1546
  1547     IF EIBAID = DFHPF12
  1548         GO TO 9500-PF12.
  1549
  1550     IF EIBAID = DFHENTER
  1551         GO TO 1000-EDIT-MAP.
  1552
  1553     MOVE ER-0008 TO EMI-ERROR.
  1554     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1555     MOVE -1                     TO PFENTERL.
  1556
  1557     GO TO 8200-SEND-DATAONLY.
  1558
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  37
* EL852.cbl
  1560
  1561******************************************************************
  1562*                                                                *
  1563*                  E D I T    M A P                              *
  1564*                                                                *
  1565******************************************************************
  1566
  1567 1000-EDIT-MAP.
  1568
  1569     MOVE SPACES                 TO PI-PROGRAM-WORK-AREA.
  1570
  1571     IF MAINTI = 'S' OR 'R' OR 'B'
  1572        MOVE MAINTI              TO WS-MAINT-FUNCTION
  1573        MOVE AL-UANON            TO MAINTA
  1574     ELSE
  1575        MOVE ER-0023             TO EMI-ERROR
  1576        MOVE -1                  TO MAINTL
  1577        MOVE AL-UABON            TO MAINTA
  1578        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1579        GO TO 8200-SEND-DATAONLY.
  1580
  1581     IF NOT MODIFY-CAP
  1582        IF MAINTI = 'B'
  1583           NEXT SENTENCE
  1584        ELSE
  1585           MOVE 'UPDATE'            TO SM-READ
  1586           PERFORM 9995-SECURITY-VIOLATION
  1587           MOVE ER-0070             TO EMI-ERROR
  1588           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1589           GO TO 8100-SEND-INITIAL-MAP.
  1590
  1591     IF FRCARL GREATER THAN ZERO OR
  1592        FRGRPL GREATER THAN ZERO OR
  1593        FRESPL GREATER THAN ZERO
  1594        MOVE '1'                 TO PI-OPTION
  1595        ADD +1                   TO WS-OPTION-COUNTER.
  1596
  1597     IF ACCTCARL GREATER THAN ZERO OR
  1598        ACCTGRPL GREATER THAN ZERO OR
  1599        ACCTSTL  GREATER THAN ZERO OR
  1600        ACCOUNTL GREATER THAN ZERO OR
  1601        ACCTREFL GREATER THAN ZERO
  1602        MOVE '2'                 TO PI-OPTION
  1603        ADD +1                   TO WS-OPTION-COUNTER.
  1604
  1605     IF SUMMARYL GREATER THAN ZERO
  1606        MOVE '3'                 TO PI-OPTION
  1607        ADD +1                   TO WS-OPTION-COUNTER.
  1608
  1609     IF BATCHL   GREATER THAN ZERO
  1610        MOVE '4'                 TO PI-OPTION
  1611        ADD +1                   TO WS-OPTION-COUNTER.
  1612
  1613     IF WS-OPTION-COUNTER GREATER THAN +1
  1614        MOVE SPACE               TO PI-OPTION
  1615        MOVE ER-2919             TO EMI-ERROR
  1616        MOVE -1                  TO FRCARL
  1617        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  38
* EL852.cbl
  1618        GO TO 8200-SEND-DATAONLY.
  1619
  1620     IF (WS-SUBMIT-FUNCTION OR WS-RESUBMIT-FUNCTION)
  1621        IF WS-OPTION-COUNTER GREATER THAN +0
  1622           NEXT SENTENCE
  1623        ELSE
  1624           MOVE SPACE            TO PI-OPTION
  1625           MOVE ER-2935          TO EMI-ERROR
  1626           MOVE -1               TO MAINTL
  1627           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  1628           GO TO 8200-SEND-DATAONLY.
  1629
  1630     IF PI-OPTION-ONE-SELECTED
  1631        GO TO 1100-PROCESS-OPTION-1.
  1632
  1633     IF PI-OPTION-TWO-SELECTED
  1634        GO TO 1200-PROCESS-OPTION-2.
  1635
  1636     IF PI-OPTION-THREE-SELECTED
  1637        GO TO 1300-PROCESS-OPTION-3.
  1638
  1639     MOVE '4'                    TO PI-OPTION.
  1640     GO TO 1400-PROCESS-OPTION-4.
  1641
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  39
* EL852.cbl
  1643
  1644******************************************************************
  1645*                                                                *
  1646*           P R O C E S S   O P T I O N   O N E                  *
  1647*                                                                *
  1648******************************************************************
  1649
  1650 1100-PROCESS-OPTION-1.
  1651
  1652     MOVE LOW-VALUES             TO ERRQST-ALT-KEY2.
  1653     MOVE PI-COMPANY-CD          TO ERRQST-COMPANY-CD-A2.
  1654
  1655     IF FRCARL GREATER THAN ZERO
  1656        MOVE FRCARI              TO ERRQST-CARRIER-A2.
  1657
  1658     IF FRGRPL GREATER THAN ZERO
  1659        MOVE FRGRPI              TO ERRQST-GROUPING-A2.
  1660
  1661     IF FRESPL GREATER THAN ZERO
  1662        MOVE FRESPI              TO ERRQST-FIN-RESP-A2.
  1663
  1664     MOVE ERRQST-ALT-KEY2        TO PI-SELECT-KEY
  1665                                    PI-ACCESS-KEY.
  1666
  1667     MOVE FILE-ID-ERRQST3        TO PI-FILE-ID.
  1668
  1669     PERFORM 4000-READ-REQUEST-FILE THRU 4090-EXIT.
  1670
  1671     IF ERRQST-CARRIER-A2 = RQ-CARRIER-A2
  1672        AND ERRQST-GROUPING-A2 = RQ-GROUPING-A2
  1673           AND ERRQST-FIN-RESP-A2 = RQ-FIN-RESP-A2
  1674              NEXT SENTENCE
  1675           ELSE
  1676              GO TO 1190-SELECTION-ERROR.
  1677
  1678     IF (WS-SUBMIT-FUNCTION OR WS-RESUBMIT-FUNCTION)
  1679        PERFORM 5000-PROCESS-REQUEST-FILE THRU 5090-EXIT.
  1680
  1681     MOVE EL852B              TO PI-MAP-NAME.
  1682     MOVE XCTL-EL8521         TO PGM-NAME.
  1683     GO TO 9300-XCTL.
  1684
  1685 1190-SELECTION-ERROR.
  1686     MOVE SPACE                  TO PI-OPTION.
  1687     MOVE ER-2132                TO EMI-ERROR.
  1688     MOVE -1                     TO FRCARL.
  1689     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1690     GO TO 8200-SEND-DATAONLY.
  1691
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  40
* EL852.cbl
  1693
  1694******************************************************************
  1695*                                                                *
  1696*           P R O C E S S   O P T I O N   T W O                  *
  1697*                                                                *
  1698******************************************************************
  1699
  1700 1200-PROCESS-OPTION-2.
  1701
  1702     MOVE LOW-VALUES             TO ERRQST-ALT-KEY1.
  1703     MOVE PI-COMPANY-CD          TO ERRQST-COMPANY-CD-A1.
  1704
  1705     IF ACCTCARL GREATER THAN ZERO
  1706        MOVE ACCTCARI            TO ERRQST-CARRIER-A1.
  1707
  1708     IF ACCTGRPL GREATER THAN ZERO
  1709        MOVE ACCTGRPI            TO ERRQST-GROUPING-A1.
  1710
  1711     IF ACCTSTL GREATER THAN ZERO
  1712        MOVE ACCTSTI             TO ERRQST-STATE-A1.
  1713
  1714     IF ACCOUNTL GREATER THAN ZERO
  1715        MOVE ACCOUNTI            TO ERRQST-ACCOUNT-A1.
  1716
  1717     IF ACCTREFL GREATER THAN ZERO
  1718        MOVE ACCTREFI            TO ERRQST-REFERENCE-A1.
  1719
  1720     MOVE FILE-ID-ERRQST2        TO PI-FILE-ID.
  1721     MOVE ERRQST-ALT-KEY1        TO PI-ACCESS-KEY
  1722                                    PI-SELECT-KEY.
  1723
  1724     PERFORM 4000-READ-REQUEST-FILE THRU 4090-EXIT.
  1725
  1726     IF ERRQST-CARRIER-A1 = RQ-CARRIER-A1
  1727        AND ERRQST-GROUPING-A1 = RQ-GROUPING-A1
  1728           AND ERRQST-STATE-A1 = RQ-STATE-A1
  1729              AND ERRQST-ACCOUNT-A1 = RQ-ACCOUNT-A1
  1730                    NEXT SENTENCE
  1731                 ELSE
  1732                    GO TO 1290-SELECTION-ERROR.
  1733
  1734     IF ACCTREFL GREATER THAN ZERO
  1735        IF ERRQST-REFERENCE-A1 = RQ-REFERENCE-A1
  1736           NEXT SENTENCE
  1737        ELSE
  1738           GO TO 1290-SELECTION-ERROR.
  1739
  1740     IF (WS-SUBMIT-FUNCTION OR WS-RESUBMIT-FUNCTION)
  1741        PERFORM 5000-PROCESS-REQUEST-FILE THRU 5090-EXIT.
  1742
  1743
  1744     MOVE EL852C                 TO PI-MAP-NAME.
  1745     MOVE XCTL-EL8521            TO PGM-NAME.
  1746     GO TO 9300-XCTL.
  1747
  1748 1290-SELECTION-ERROR.
  1749
  1750     MOVE SPACE                  TO PI-OPTION.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  41
* EL852.cbl
  1751     MOVE ER-2132                TO EMI-ERROR.
  1752     MOVE -1                     TO ACCTCARL.
  1753     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1754     GO TO 8200-SEND-DATAONLY.
  1755
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  42
* EL852.cbl
  1757
  1758******************************************************************
  1759*                                                                *
  1760*           P R O C E S S   O P T I O N   T H R E E              *
  1761*                                                                *
  1762******************************************************************
  1763
  1764 1300-PROCESS-OPTION-3.
  1765
  1766     MOVE LOW-VALUES             TO ERRQST-ALT-KEY4.
  1767     MOVE PI-COMPANY-CD          TO ERRQST-COMPANY-CD-A4.
  1768
  1769     IF SUMMARYL GREATER THAN ZERO
  1770        MOVE SUMMARYI            TO ERRQST-SUMMARY-CODE.
  1771
  1772
  1773     IF (WS-SUBMIT-FUNCTION OR WS-RESUBMIT-FUNCTION)
  1774        PERFORM 6000-PROCESS-SUMMARY-FILE THRU 6090-EXIT.
  1775
  1776     MOVE FILE-ID-ERRQST5        TO PI-FILE-ID.
  1777     MOVE ERRQST-ALT-KEY4        TO PI-SELECT-KEY
  1778                                    PI-ACCESS-KEY.
  1779
  1780     PERFORM 4000-READ-REQUEST-FILE THRU 4090-EXIT.
  1781
  1782     IF ERRQST-SUMMARY-CODE = RQ-SUMMARY-CODE
  1783        NEXT SENTENCE
  1784     ELSE
  1785        GO TO 1390-SELECTION-ERROR.
  1786
  1787     MOVE EL852B                 TO PI-MAP-NAME
  1788     MOVE XCTL-EL8521            TO PGM-NAME
  1789     GO TO 9300-XCTL.
  1790
  1791 1390-SELECTION-ERROR.
  1792
  1793     MOVE SPACE                  TO PI-OPTION.
  1794     MOVE ER-2132                TO EMI-ERROR.
  1795     MOVE -1                     TO SUMMARYL.
  1796     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1797     GO TO 8200-SEND-DATAONLY.
  1798
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  43
* EL852.cbl
  1800
  1801******************************************************************
  1802*                                                                *
  1803*           P R O C E S S   O P T I O N   F O U R                *
  1804*                                                                *
  1805******************************************************************
  1806
  1807 1400-PROCESS-OPTION-4.
  1808
  1809     MOVE LOW-VALUES             TO ERRQST-KEY.
  1810     MOVE PI-COMPANY-CD          TO ERRQST-COMPANY-CD.
  1811
  1812     IF BATCHL GREATER THAN ZERO
  1813        MOVE BATCHI              TO ERRQST-ENTRY-BATCH.
  1814
  1815     MOVE FILE-ID-ERRQST         TO PI-FILE-ID.
  1816     MOVE ERRQST-KEY             TO PI-ACCESS-KEY
  1817                                    PI-SELECT-KEY.
  1818
  1819     PERFORM 4000-READ-REQUEST-FILE THRU 4090-EXIT.
  1820
  1821     IF ERRQST-ENTRY-BATCH = LOW-VALUES
  1822        MOVE EL852B                 TO PI-MAP-NAME
  1823        MOVE XCTL-EL8521            TO PGM-NAME
  1824        GO TO 9300-XCTL.
  1825
  1826     IF ERRQST-ENTRY-BATCH = RQ-ENTRY-BATCH
  1827        NEXT SENTENCE
  1828     ELSE
  1829        GO TO 1490-SELECTION-ERROR.
  1830
  1831     IF (WS-SUBMIT-FUNCTION OR WS-RESUBMIT-FUNCTION)
  1832        PERFORM 5000-PROCESS-REQUEST-FILE THRU 5090-EXIT.
  1833
  1834     MOVE EL852B                 TO PI-MAP-NAME.
  1835     MOVE XCTL-EL8521            TO PGM-NAME
  1836     GO TO 9300-XCTL.
  1837
  1838 1490-SELECTION-ERROR.
  1839
  1840     MOVE SPACE                  TO PI-OPTION.
  1841     MOVE ER-2132                TO EMI-ERROR.
  1842     MOVE -1                     TO BATCHL.
  1843     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1844     GO TO 8200-SEND-DATAONLY.
  1845
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  44
* EL852.cbl
  1847
  1848******************************************************************
  1849*                                                                *
  1850*           R E A D   R E Q U E S T   F I L E                    *
  1851*                                                                *
  1852******************************************************************
  1853
  1854 4000-READ-REQUEST-FILE.
  1855
  1856
  1857* EXEC CICS HANDLE CONDITION
  1858*        NOTFND  (4080-REQUEST-NOTFND)
  1859*        ENDFILE (4080-REQUEST-NOTFND)
  1860*    END-EXEC.
  1861*    MOVE '"$I''                  ! # #00001813' TO DFHEIV0
  1862     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  1863     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1864     MOVE X'2320233030303031383133' TO DFHEIV0(25:11)
  1865     CALL 'kxdfhei1' USING DFHEIV0
  1866     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1867
  1868
  1869
  1870* EXEC CICS READ
  1871*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  1872*        DATASET(PI-FILE-ID)
  1873*        RIDFLD (PI-ACCESS-KEY)
  1874*        GTEQ
  1875*    END-EXEC.
  1876*    MOVE '&"S        G          (   #00001818' TO DFHEIV0
  1877     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  1878     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  1879     MOVE X'2020233030303031383138' TO DFHEIV0(25:11)
  1880     CALL 'kxdfhei1' USING DFHEIV0,
  1881           PI-FILE-ID,
  1882           DFHEIV20,
  1883           DFHEIV99,
  1884           PI-ACCESS-KEY,
  1885           DFHEIV99,
  1886           DFHEIV99,
  1887           DFHEIV99
  1888     SET ADDRESS OF AR-REQUEST-RECORD TO
  1889         DFHEIV20
  1890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1891
  1892
  1893     IF RQ-COMPANY-CD NOT = PI-COMPANY-CD
  1894        GO TO 4080-REQUEST-NOTFND.
  1895
  1896     GO TO 4090-EXIT.
  1897
  1898 4080-REQUEST-NOTFND.
  1899
  1900      MOVE SPACE                 TO PI-OPTION.
  1901      MOVE ER-2132               TO EMI-ERROR.
  1902      MOVE -1                    TO FRCARL.
  1903      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  1904      GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  45
* EL852.cbl
  1905
  1906 4090-EXIT.
  1907      EXIT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  46
* EL852.cbl
  1909
  1910******************************************************************
  1911*                                                                *
  1912*           P R O C E S S   R E Q U E S T   F I L E              *
  1913*                                                                *
  1914*   . BROWSE THE REQUEST FILE FOR THE SELECTED OPTION AND        *
  1915*     SET THE REQUEST DATE TO THE CURRENT DATE.                  *
  1916*                                                                *
  1917*   . IF THE OPTION IS BEING RE-REQUESTED, FLAG THEM AS SUCH.    *
  1918*                                                                *
  1919******************************************************************
  1920
  1921 5000-PROCESS-REQUEST-FILE.
  1922
  1923     IF WS-REQUEST-BROWSE-STARTED
  1924
  1925* EXEC CICS HANDLE CONDITION
  1926*            NOTFND  (5070-REQUEST-PROCESSED)
  1927*            ENDFILE (5070-REQUEST-PROCESSED)
  1928*       END-EXEC
  1929*    MOVE '"$I''                  ! $ #00001856' TO DFHEIV0
  1930     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  1931     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1932     MOVE X'2420233030303031383536' TO DFHEIV0(25:11)
  1933     CALL 'kxdfhei1' USING DFHEIV0
  1934     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1935     ELSE
  1936
  1937* EXEC CICS HANDLE CONDITION
  1938*            NOTFND  (5080-REQUEST-NOTFND)
  1939*            ENDFILE (5080-REQUEST-NOTFND)
  1940*       END-EXEC.
  1941*    MOVE '"$I''                  ! % #00001861' TO DFHEIV0
  1942     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  1943     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1944     MOVE X'2520233030303031383631' TO DFHEIV0(25:11)
  1945     CALL 'kxdfhei1' USING DFHEIV0
  1946     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1947
  1948
  1949
  1950* EXEC CICS STARTBR
  1951*        DATASET (PI-FILE-ID)
  1952*        RIDFLD  (PI-ACCESS-KEY)
  1953*    END-EXEC.
  1954     MOVE 0
  1955       TO DFHEIV11
  1956*    MOVE '&,         G          &   #00001866' TO DFHEIV0
  1957     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1958     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1959     MOVE X'2020233030303031383636' TO DFHEIV0(25:11)
  1960     CALL 'kxdfhei1' USING DFHEIV0,
  1961           PI-FILE-ID,
  1962           PI-ACCESS-KEY,
  1963           DFHEIV99,
  1964           DFHEIV11,
  1965           DFHEIV99
  1966     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  47
* EL852.cbl
  1967
  1968
  1969 5020-READ-REQUEST-FILE.
  1970
  1971
  1972* EXEC CICS READNEXT
  1973*        SET    (ADDRESS OF AR-REQUEST-RECORD)
  1974*        DATASET(PI-FILE-ID)
  1975*        RIDFLD (PI-ACCESS-KEY)
  1976*    END-EXEC.
  1977     MOVE 0
  1978       TO DFHEIV11
  1979*    MOVE '&.S                   )   #00001873' TO DFHEIV0
  1980     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  1981     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  1982     MOVE X'2020233030303031383733' TO DFHEIV0(25:11)
  1983     CALL 'kxdfhei1' USING DFHEIV0,
  1984           PI-FILE-ID,
  1985           DFHEIV20,
  1986           DFHEIV99,
  1987           PI-ACCESS-KEY,
  1988           DFHEIV99,
  1989           DFHEIV11,
  1990           DFHEIV99,
  1991           DFHEIV99
  1992     SET ADDRESS OF AR-REQUEST-RECORD TO
  1993         DFHEIV20
  1994     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1995
  1996
  1997     MOVE 'Y'                    TO WS-REQUEST-BROWSE-SW.
  1998
  1999     IF RQ-COMPANY-CD NOT = PI-COMPANY-CD
  2000        GO TO 5070-REQUEST-PROCESSED.
  2001
  2002     IF WS-SAVE-ACCESS-KEY = PI-ACCESS-KEY
  2003        GO TO 5020-READ-REQUEST-FILE.
  2004
  2005     MOVE PI-ACCESS-KEY          TO WS-SAVE-ACCESS-KEY.
  2006
  2007     IF RQ-REQUEST-DT GREATER THAN LOW-VALUES OR
  2008        RQ-REQUEST-DT = SPACES
  2009        IF MAINTI = 'R'
  2010           NEXT SENTENCE
  2011        ELSE
  2012           GO TO 5020-READ-REQUEST-FILE.
  2013
  2014     IF RQ-MO-END-DT GREATER THAN PI-AR-MONTH-END-DT
  2015        GO TO 5020-READ-REQUEST-FILE.
  2016
  2017     IF PI-OPTION-ONE-SELECTED
  2018        MOVE RQ-CONTROL-BY-FIN-RESP TO WS-RQST-FIN-RESP-CNTL
  2019        IF WS-RQST-FIN-RESP-CNTL GREATER THAN
  2020              ERRQST-FIN-RESP-CONTROL
  2021           GO TO 5070-REQUEST-PROCESSED.
  2022
  2023     IF PI-OPTION-TWO-SELECTED
  2024        MOVE RQ-CONTROL-BY-ACCT-REF TO WS-RQST-ACCT-CONTROL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  48
* EL852.cbl
  2025        IF WS-RQST-ACCT-CONTROL GREATER THAN ERRQST-ACCT-CONTROL
  2026           GO TO 5070-REQUEST-PROCESSED.
  2027
  2028     IF PI-OPTION-TWO-SELECTED
  2029        IF ERRQST-REFERENCE-A1 GREATER THAN LOW-VALUES
  2030           IF ERRQST-REFERENCE-A1 = RQ-REFERENCE-A1
  2031              NEXT SENTENCE
  2032           ELSE
  2033              GO TO 5070-REQUEST-PROCESSED.
  2034
  2035     IF NOT PI-OPTION-THREE-SELECTED
  2036        NEXT SENTENCE
  2037     ELSE
  2038        IF  RQ-CARRIER-A2 = ERRQST-CARRIER-A2
  2039            AND RQ-GROUPING-A2 = ERRQST-GROUPING-A2
  2040                AND RQ-FIN-RESP-A2 = ERRQST-FIN-RESP-A2
  2041                    AND RQ-ACCT-AGENT-A2 = ERRQST-ACCT-AGENT-A2
  2042                        NEXT SENTENCE
  2043        ELSE
  2044            GO TO 5070-REQUEST-PROCESSED.
  2045
  2046     IF PI-OPTION-FOUR-SELECTED
  2047        IF ERRQST-ENTRY-BATCH = RQ-ENTRY-BATCH
  2048           NEXT SENTENCE
  2049        ELSE
  2050           GO TO 5070-REQUEST-PROCESSED.
  2051
  2052     MOVE RQ-CONTROL-PRIMARY     TO ERRQST-KEY.
  2053
  2054
  2055* EXEC CICS ENDBR
  2056*        DATASET (PI-FILE-ID)
  2057*    END-EXEC.
  2058     MOVE 0
  2059       TO DFHEIV11
  2060*    MOVE '&2                    $   #00001936' TO DFHEIV0
  2061     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2062     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2063     MOVE X'2020233030303031393336' TO DFHEIV0(25:11)
  2064     CALL 'kxdfhei1' USING DFHEIV0,
  2065           PI-FILE-ID,
  2066           DFHEIV11,
  2067           DFHEIV99
  2068     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2069
  2070
  2071
  2072* EXEC CICS READ
  2073*        SET     (ADDRESS OF AR-REQUEST-RECORD)
  2074*        DATASET (FILE-ID-ERRQST)
  2075*        RIDFLD  (ERRQST-KEY)
  2076*        UPDATE
  2077*    END-EXEC.
  2078*    MOVE '&"S        EU         (   #00001940' TO DFHEIV0
  2079     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  2080     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  2081     MOVE X'2020233030303031393430' TO DFHEIV0(25:11)
  2082     CALL 'kxdfhei1' USING DFHEIV0,
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  49
* EL852.cbl
  2083           FILE-ID-ERRQST,
  2084           DFHEIV20,
  2085           DFHEIV99,
  2086           ERRQST-KEY,
  2087           DFHEIV99,
  2088           DFHEIV99,
  2089           DFHEIV99
  2090     SET ADDRESS OF AR-REQUEST-RECORD TO
  2091         DFHEIV20
  2092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2093
  2094
  2095     MOVE 'B'                    TO JP-RECORD-TYPE.
  2096     MOVE AR-REQUEST-RECORD      TO JP-RECORD-AREA.
  2097
  2098     PERFORM 8400-LOG-JOURNAL-RECORD.
  2099
  2100     MOVE 'Y'                    TO WS-DATA-SELECTED-SW.
  2101
  2102     IF PI-OPTION-THREE-SELECTED
  2103        MOVE SX-SUMMARY          TO RQ-SUMMARY-CODE.
  2104
  2105     IF RQ-STATUS = 'E'
  2106         GO TO 5050-WRITE.
  2107
  2108     IF (RQ-CARRIER-A1  = SPACES OR LOW-VALUES) OR
  2109        (RQ-GROUPING-A1 = SPACES OR LOW-VALUES) OR
  2110        (RQ-STATE-A1    = SPACES OR LOW-VALUES)
  2111         GO TO 5050-WRITE.
  2112
  2113     IF WS-RESUBMIT-FUNCTION
  2114         IF RQ-STMT-DT = LOW-VALUES
  2115             MOVE ' '            TO RQ-STATUS
  2116         ELSE
  2117             MOVE 'R'            TO RQ-STATUS.
  2118
  2119     MOVE PI-PROCESSOR-ID        TO RQ-PROCESSOR-ID.
  2120     MOVE WS-CURRENT-BIN-DT      TO RQ-REQUEST-DT.
  2121
  2122     IF PI-OPTION-ONE-SELECTED
  2123        MOVE 'F'                 TO RQ-REQUEST-METHOD.
  2124
  2125     IF PI-OPTION-TWO-SELECTED
  2126        MOVE 'A'                 TO RQ-REQUEST-METHOD.
  2127
  2128     IF PI-OPTION-THREE-SELECTED
  2129        MOVE 'S'                 TO RQ-REQUEST-METHOD.
  2130
  2131     IF PI-OPTION-FOUR-SELECTED
  2132        MOVE 'B'                 TO RQ-REQUEST-METHOD.
  2133
  2134 5050-WRITE.
  2135
  2136     MOVE 'C'                    TO JP-RECORD-TYPE.
  2137     MOVE AR-REQUEST-RECORD      TO JP-RECORD-AREA.
  2138
  2139
  2140* EXEC CICS REWRITE
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  50
* EL852.cbl
  2141*        DATASET (FILE-ID-ERRQST)
  2142*        FROM    (AR-REQUEST-RECORD)
  2143*    END-EXEC.
  2144     MOVE LENGTH OF
  2145      AR-REQUEST-RECORD
  2146       TO DFHEIV11
  2147*    MOVE '&& L                  %   #00001991' TO DFHEIV0
  2148     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  2149     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  2150     MOVE X'2020233030303031393931' TO DFHEIV0(25:11)
  2151     CALL 'kxdfhei1' USING DFHEIV0,
  2152           FILE-ID-ERRQST,
  2153           AR-REQUEST-RECORD,
  2154           DFHEIV11,
  2155           DFHEIV99
  2156     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2157
  2158
  2159     PERFORM 8400-LOG-JOURNAL-RECORD.
  2160
  2161     GO TO 5000-PROCESS-REQUEST-FILE.
  2162
  2163 5070-REQUEST-PROCESSED.
  2164
  2165
  2166* EXEC CICS ENDBR
  2167*        DATASET (PI-FILE-ID)
  2168*    END-EXEC.
  2169     MOVE 0
  2170       TO DFHEIV11
  2171*    MOVE '&2                    $   #00002002' TO DFHEIV0
  2172     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2173     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2174     MOVE X'2020233030303032303032' TO DFHEIV0(25:11)
  2175     CALL 'kxdfhei1' USING DFHEIV0,
  2176           PI-FILE-ID,
  2177           DFHEIV11,
  2178           DFHEIV99
  2179     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2180
  2181
  2182     IF PI-OPTION-FOUR-SELECTED
  2183        GO TO 5090-EXIT.
  2184
  2185     IF PI-OPTION-THREE-SELECTED
  2186        GO TO 5090-EXIT.
  2187
  2188     IF WS-DATA-SELECTED
  2189        GO TO 5090-EXIT.
  2190
  2191     MOVE SPACE                 TO PI-OPTION.
  2192     MOVE ER-2134               TO EMI-ERROR.
  2193     MOVE -1                    TO FRCARL.
  2194     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2195     GO TO 8200-SEND-DATAONLY.
  2196
  2197 5080-REQUEST-NOTFND.
  2198
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  51
* EL852.cbl
  2199     IF PI-OPTION-FOUR-SELECTED
  2200        GO TO 5090-EXIT.
  2201
  2202      MOVE SPACE                 TO PI-OPTION.
  2203      MOVE ER-2134               TO EMI-ERROR.
  2204      MOVE -1                    TO FRCARL.
  2205      PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2206      GO TO 8200-SEND-DATAONLY.
  2207
  2208 5090-EXIT.
  2209      EXIT.
  2210
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  52
* EL852.cbl
  2212
  2213
  2214******************************************************************
  2215*                                                                *
  2216*           P R O C E S S   S U M M A R Y   F I L E              *
  2217*                                                                *
  2218*   . BROWSE THE SUMMARY FILE FOR THE SELECTED SUMMARY CODE.     *
  2219*                                                                *
  2220*   . BROWSE THE REQUEST FILE FOR THE SELECTED SUMMARY CODE.     *
  2221*                                                                *
  2222*   . UPDATE THE THOSE REQUEST RECORDS THAT ARE ASSOCIATED       *
  2223*     WITH THE SELECTED SUMMARY RECORDS.                         *
  2224*                                                                *
  2225******************************************************************
  2226
  2227 6000-PROCESS-SUMMARY-FILE.
  2228
  2229
  2230* EXEC CICS HANDLE CONDITION
  2231*          NOTFND  (6080-REQUEST-NOTFND)
  2232*          ENDFILE (6080-REQUEST-NOTFND)
  2233*     END-EXEC.
  2234*    MOVE '"$I''                  ! & #00002053' TO DFHEIV0
  2235     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  2236     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2237     MOVE X'2620233030303032303533' TO DFHEIV0(25:11)
  2238     CALL 'kxdfhei1' USING DFHEIV0
  2239     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2240
  2241
  2242     MOVE ERRQST-ALT-KEY4        TO WS-ACCESS-KEY.
  2243
  2244
  2245* EXEC CICS STARTBR
  2246*        DATASET (FILE-ID-ERSUMM)
  2247*        RIDFLD  (WS-ACCESS-KEY)
  2248*    END-EXEC.
  2249     MOVE 0
  2250       TO DFHEIV11
  2251*    MOVE '&,         G          &   #00002060' TO DFHEIV0
  2252     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2253     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2254     MOVE X'2020233030303032303630' TO DFHEIV0(25:11)
  2255     CALL 'kxdfhei1' USING DFHEIV0,
  2256           FILE-ID-ERSUMM,
  2257           WS-ACCESS-KEY,
  2258           DFHEIV99,
  2259           DFHEIV11,
  2260           DFHEIV99
  2261     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2262
  2263
  2264
  2265* EXEC CICS HANDLE CONDITION
  2266*         NOTFND  (6070-REQUEST-PROCESSED)
  2267*         ENDFILE (6070-REQUEST-PROCESSED)
  2268*    END-EXEC.
  2269*    MOVE '"$I''                  ! '' #00002065' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  53
* EL852.cbl
  2270     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  2271     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2272     MOVE X'2720233030303032303635' TO DFHEIV0(25:11)
  2273     CALL 'kxdfhei1' USING DFHEIV0
  2274     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2275
  2276
  2277 6020-READ-SUMMARY-FILE.
  2278
  2279
  2280* EXEC CICS READNEXT
  2281*        SET    (ADDRESS OF SUMM-CROSS-REFERENCE)
  2282*        DATASET(FILE-ID-ERSUMM)
  2283*        RIDFLD (WS-ACCESS-KEY)
  2284*    END-EXEC.
  2285     MOVE 0
  2286       TO DFHEIV11
  2287*    MOVE '&.S                   )   #00002072' TO DFHEIV0
  2288     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  2289     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2290     MOVE X'2020233030303032303732' TO DFHEIV0(25:11)
  2291     CALL 'kxdfhei1' USING DFHEIV0,
  2292           FILE-ID-ERSUMM,
  2293           DFHEIV20,
  2294           DFHEIV99,
  2295           WS-ACCESS-KEY,
  2296           DFHEIV99,
  2297           DFHEIV11,
  2298           DFHEIV99,
  2299           DFHEIV99
  2300     SET ADDRESS OF SUMM-CROSS-REFERENCE TO
  2301         DFHEIV20
  2302     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2303
  2304
  2305     MOVE 'Y'                    TO WS-SUMMARY-BROWSE-SW.
  2306
  2307     IF SX-COMPANY-CD NOT = PI-COMPANY-CD
  2308        GO TO 6070-REQUEST-PROCESSED.
  2309
  2310     IF SX-SUMMARY GREATER THAN ERRQST-SUMMARY-CODE
  2311        GO TO 6070-REQUEST-PROCESSED.
  2312
  2313******************************************************************
  2314*           BYPASS SUMMARY NAME RECORD                           *
  2315******************************************************************
  2316
  2317     IF SX-CARRIER = LOW-VALUES
  2318        GO 6020-READ-SUMMARY-FILE.
  2319
  2320     MOVE LOW-VALUES            TO ERRQST-ALT-KEY2.
  2321     MOVE SX-COMPANY-CD         TO ERRQST-COMPANY-CD-A2.
  2322     MOVE SX-CARRIER            TO ERRQST-CARRIER-A2.
  2323     MOVE SX-GROUP              TO ERRQST-GROUPING-A2.
  2324     MOVE SX-FIN-RESP           TO ERRQST-FIN-RESP-A2.
  2325     MOVE SX-ACCT-AGENT         TO ERRQST-ACCT-AGENT-A2.
  2326     MOVE ERRQST-ALT-KEY2       TO PI-ACCESS-KEY.
  2327     MOVE FILE-ID-ERRQST3       TO PI-FILE-ID.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  54
* EL852.cbl
  2328
  2329     MOVE LOW-VALUES TO WS-SAVE-ACCESS-KEY.
  2330
  2331     PERFORM 5000-PROCESS-REQUEST-FILE THRU 5090-EXIT.
  2332
  2333     GO TO 6020-READ-SUMMARY-FILE.
  2334
  2335 6070-REQUEST-PROCESSED.
  2336
  2337
  2338* EXEC CICS ENDBR
  2339*        DATASET (FILE-ID-ERSUMM)
  2340*    END-EXEC.
  2341     MOVE 0
  2342       TO DFHEIV11
  2343*    MOVE '&2                    $   #00002110' TO DFHEIV0
  2344     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2345     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2346     MOVE X'2020233030303032313130' TO DFHEIV0(25:11)
  2347     CALL 'kxdfhei1' USING DFHEIV0,
  2348           FILE-ID-ERSUMM,
  2349           DFHEIV11,
  2350           DFHEIV99
  2351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2352
  2353
  2354     IF WS-DATA-SELECTED
  2355        GO TO 6090-EXIT.
  2356
  2357     MOVE SPACE                 TO PI-OPTION.
  2358     MOVE ER-2134               TO EMI-ERROR.
  2359     MOVE -1                    TO FRCARL.
  2360     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2361     GO TO 8200-SEND-DATAONLY.
  2362
  2363 6080-REQUEST-NOTFND.
  2364
  2365     MOVE SPACE                 TO PI-OPTION.
  2366     MOVE ER-3133               TO EMI-ERROR.
  2367     MOVE -1                    TO FRCARL.
  2368     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  2369     GO TO 8200-SEND-DATAONLY.
  2370
  2371 6090-EXIT.
  2372      EXIT.
  2373
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  55
* EL852.cbl
  2375******************************************************************
  2376*                                                                *
  2377*            S  E N D    I N I T I A L   M A P                   *
  2378*                                                                *
  2379******************************************************************
  2380
  2381 8100-SEND-INITIAL-MAP.
  2382
  2383     MOVE WS-CURRENT-DT          TO DATEO.
  2384     MOVE EIBTIME                TO TIME-IN.
  2385     MOVE TIME-OUT               TO TIMEO.
  2386     MOVE -1                     TO MAINTL.
  2387
  2388     MOVE EMI-MESSAGE-AREA (1)   TO ERMESGO.
  2389
  2390
  2391* EXEC CICS SEND
  2392*        MAP      (EL852A)
  2393*        MAPSET   (MAPSET-EL852S)
  2394*        FROM     (EL852AI)
  2395*        ERASE
  2396*        CURSOR
  2397*    END-EXEC.
  2398     MOVE LENGTH OF
  2399      EL852AI
  2400       TO DFHEIV12
  2401     MOVE -1
  2402       TO DFHEIV11
  2403*    MOVE '8$     CT  E    H L F ,   #00002150' TO DFHEIV0
  2404     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2405     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2406     MOVE X'2020233030303032313530' TO DFHEIV0(25:11)
  2407     CALL 'kxdfhei1' USING DFHEIV0,
  2408           EL852A,
  2409           EL852AI,
  2410           DFHEIV12,
  2411           MAPSET-EL852S,
  2412           DFHEIV99,
  2413           DFHEIV99,
  2414           DFHEIV99,
  2415           DFHEIV11,
  2416           DFHEIV99,
  2417           DFHEIV99,
  2418           DFHEIV99
  2419     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2420
  2421
  2422     GO TO 9100-RETURN-TRAN.
  2423
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  56
* EL852.cbl
  2425
  2426******************************************************************
  2427*                                                                *
  2428*              S E N D    D A T A O N L Y                        *
  2429*                                                                *
  2430******************************************************************
  2431
  2432 8200-SEND-DATAONLY.
  2433
  2434     MOVE WS-CURRENT-DT          TO DATEO.
  2435     MOVE EIBTIME                TO TIME-IN.
  2436     MOVE TIME-OUT               TO TIMEO.
  2437
  2438     MOVE EMI-MESSAGE-AREA (1)   TO ERMESGO.
  2439
  2440
  2441* EXEC CICS SEND
  2442*         MAP      (EL852A)
  2443*         MAPSET   (MAPSET-EL852S)
  2444*         FROM     (EL852AI)
  2445*         DATAONLY
  2446*         CURSOR
  2447*    END-EXEC.
  2448     MOVE LENGTH OF
  2449      EL852AI
  2450       TO DFHEIV12
  2451     MOVE -1
  2452       TO DFHEIV11
  2453*    MOVE '8$D    CT       H L F ,   #00002176' TO DFHEIV0
  2454     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2455     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2456     MOVE X'2020233030303032313736' TO DFHEIV0(25:11)
  2457     CALL 'kxdfhei1' USING DFHEIV0,
  2458           EL852A,
  2459           EL852AI,
  2460           DFHEIV12,
  2461           MAPSET-EL852S,
  2462           DFHEIV99,
  2463           DFHEIV99,
  2464           DFHEIV99,
  2465           DFHEIV11,
  2466           DFHEIV99,
  2467           DFHEIV99,
  2468           DFHEIV99
  2469     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2470
  2471
  2472     GO TO 9100-RETURN-TRAN.
  2473
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  57
* EL852.cbl
  2475
  2476 8300-SEND-TEXT.
  2477
  2478* EXEC CICS SEND TEXT
  2479*        FROM     (LOGOFF-TEXT)
  2480*        LENGTH   (LOGOFF-LENGTH)
  2481*        ERASE
  2482*        FREEKB
  2483*    END-EXEC.
  2484*    MOVE '8&      T  E F  H   F -   #00002189' TO DFHEIV0
  2485     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2486     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2487     MOVE X'2020233030303032313839' TO DFHEIV0(25:11)
  2488     CALL 'kxdfhei1' USING DFHEIV0,
  2489           LOGOFF-TEXT,
  2490           LOGOFF-LENGTH,
  2491           DFHEIV99,
  2492           DFHEIV99,
  2493           DFHEIV99,
  2494           DFHEIV99,
  2495           DFHEIV99,
  2496           DFHEIV99,
  2497           DFHEIV99,
  2498           DFHEIV99,
  2499           DFHEIV99,
  2500           DFHEIV99
  2501     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2502
  2503
  2504
  2505* EXEC CICS RETURN
  2506*    END-EXEC.
  2507*    MOVE '.(                    &   #00002196' TO DFHEIV0
  2508     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2509     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2510     MOVE X'2020233030303032313936' TO DFHEIV0(25:11)
  2511     CALL 'kxdfhei1' USING DFHEIV0,
  2512           DFHEIV99,
  2513           DFHEIV99,
  2514           DFHEIV99,
  2515           DFHEIV99,
  2516           DFHEIV99
  2517     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2518
  2519
  2520
  2521 8400-LOG-JOURNAL-RECORD.
  2522     MOVE PI-PROCESSOR-ID        TO JP-USER-ID.
  2523     MOVE THIS-PGM                TO JP-PROGRAM-ID.
  2524
  2525*    EXEC CICS JOURNAL
  2526*        JFILEID     (PI-JOURNAL-FILE-ID)
  2527*        JTYPEID     ('EL')
  2528*        FROM        (JOURNAL-RECORD)
  2529*        LENGTH      (WS-JOURNAL-RECORD-LENGTH)
  2530*        END-EXEC.
  2531
  2532 8500-DATE-CONVERT.
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  58
* EL852.cbl
  2533
  2534* EXEC CICS LINK
  2535*        PROGRAM  (LINK-ELDATCV)
  2536*        COMMAREA (DATE-CONVERSION-DATA)
  2537*        LENGTH   (DC-COMM-LENGTH)
  2538*    END-EXEC.
  2539*    MOVE '."C                   ''   #00002212' TO DFHEIV0
  2540     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2541     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2542     MOVE X'2020233030303032323132' TO DFHEIV0(25:11)
  2543     CALL 'kxdfhei1' USING DFHEIV0,
  2544           LINK-ELDATCV,
  2545           DATE-CONVERSION-DATA,
  2546           DC-COMM-LENGTH,
  2547           DFHEIV99,
  2548           DFHEIV99,
  2549           DFHEIV99
  2550     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2551
  2552
  2553 8500-EXIT.
  2554     EXIT.
  2555
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  59
* EL852.cbl
  2557
  2558 8800-UNAUTHORIZED-ACCESS.
  2559     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  2560     GO TO 8300-SEND-TEXT.
  2561
  2562 8810-PF23.
  2563     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  2564     MOVE XCTL-EL005             TO PGM-NAME.
  2565     GO TO 9300-XCTL.
  2566
  2567 9200-RETURN-MAIN-MENU.
  2568     MOVE XCTL-EL626             TO PGM-NAME.
  2569     GO TO 9300-XCTL.
  2570
  2571 9000-RETURN-CICS.
  2572
  2573* EXEC CICS RETURN
  2574*    END-EXEC.
  2575*    MOVE '.(                    &   #00002237' TO DFHEIV0
  2576     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2577     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2578     MOVE X'2020233030303032323337' TO DFHEIV0(25:11)
  2579     CALL 'kxdfhei1' USING DFHEIV0,
  2580           DFHEIV99,
  2581           DFHEIV99,
  2582           DFHEIV99,
  2583           DFHEIV99,
  2584           DFHEIV99
  2585     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2586
  2587
  2588 9100-RETURN-TRAN.
  2589
  2590     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  2591     MOVE '852A'                 TO PI-CURRENT-SCREEN-NO.
  2592
  2593
  2594* EXEC CICS RETURN
  2595*        TRANSID    (TRANS-EXJ2)
  2596*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2597*        LENGTH     (PI-COMM-LENGTH)
  2598*    END-EXEC.
  2599*    MOVE '.(CT                  &   #00002245' TO DFHEIV0
  2600     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  2601     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2602     MOVE X'2020233030303032323435' TO DFHEIV0(25:11)
  2603     CALL 'kxdfhei1' USING DFHEIV0,
  2604           TRANS-EXJ2,
  2605           PROGRAM-INTERFACE-BLOCK,
  2606           PI-COMM-LENGTH,
  2607           DFHEIV99,
  2608           DFHEIV99
  2609     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2610
  2611
  2612 9300-XCTL.
  2613
  2614* EXEC CICS XCTL
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  60
* EL852.cbl
  2615*        PROGRAM    (PGM-NAME)
  2616*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  2617*        LENGTH     (PI-COMM-LENGTH)
  2618*    END-EXEC.
  2619*    MOVE '.$C                   $   #00002252' TO DFHEIV0
  2620     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  2621     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2622     MOVE X'2020233030303032323532' TO DFHEIV0(25:11)
  2623     CALL 'kxdfhei1' USING DFHEIV0,
  2624           PGM-NAME,
  2625           PROGRAM-INTERFACE-BLOCK,
  2626           PI-COMM-LENGTH
  2627     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2628
  2629
  2630 9400-CLEAR.
  2631     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME
  2632     GO TO 9300-XCTL.
  2633
  2634 9500-PF12.
  2635     MOVE XCTL-EL010             TO PGM-NAME.
  2636     GO TO 9300-XCTL.
  2637
  2638 9600-PGMID-ERROR.
  2639
  2640
  2641* EXEC CICS HANDLE CONDITION
  2642*        PGMIDERR    (8300-SEND-TEXT)
  2643*    END-EXEC.
  2644*    MOVE '"$L                   ! ( #00002268' TO DFHEIV0
  2645     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  2646     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2647     MOVE X'2820233030303032323638' TO DFHEIV0(25:11)
  2648     CALL 'kxdfhei1' USING DFHEIV0
  2649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2650
  2651
  2652     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  2653     MOVE ' '                    TO PI-ENTRY-CD-1.
  2654     MOVE XCTL-EL005             TO PGM-NAME.
  2655     MOVE PGM-NAME               TO LOGOFF-PGM.
  2656     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  2657     GO TO 9300-XCTL.
  2658
  2659 9900-ERROR-FORMAT.
  2660
  2661     IF NOT EMI-ERRORS-COMPLETE
  2662         MOVE LINK-EL001         TO PGM-NAME
  2663
  2664* EXEC CICS LINK
  2665*            PROGRAM    (PGM-NAME)
  2666*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  2667*            LENGTH     (EMI-COMM-LENGTH)
  2668*        END-EXEC.
  2669*    MOVE '."C                   ''   #00002283' TO DFHEIV0
  2670     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2671     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2672     MOVE X'2020233030303032323833' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  61
* EL852.cbl
  2673     CALL 'kxdfhei1' USING DFHEIV0,
  2674           PGM-NAME,
  2675           ERROR-MESSAGE-INTERFACE-BLOCK,
  2676           EMI-COMM-LENGTH,
  2677           DFHEIV99,
  2678           DFHEIV99,
  2679           DFHEIV99
  2680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2681
  2682
  2683 9900-EXIT.
  2684     EXIT.
  2685
  2686 9990-ABEND.
  2687     MOVE LINK-EL004             TO PGM-NAME.
  2688     MOVE DFHEIBLK               TO EMI-LINE1.
  2689
  2690* EXEC CICS LINK
  2691*        PROGRAM   (PGM-NAME)
  2692*        COMMAREA  (EMI-LINE1)
  2693*        LENGTH    (72)
  2694*    END-EXEC.
  2695     MOVE 72
  2696       TO DFHEIV11
  2697*    MOVE '."C                   ''   #00002295' TO DFHEIV0
  2698     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2699     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2700     MOVE X'2020233030303032323935' TO DFHEIV0(25:11)
  2701     CALL 'kxdfhei1' USING DFHEIV0,
  2702           PGM-NAME,
  2703           EMI-LINE1,
  2704           DFHEIV11,
  2705           DFHEIV99,
  2706           DFHEIV99,
  2707           DFHEIV99
  2708     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2709
  2710
  2711     MOVE -1                     TO PFENTERL.
  2712
  2713     GO TO 8200-SEND-DATAONLY.
  2714
  2715
  2716* GOBACK.
  2717     MOVE '9%                    "   ' TO DFHEIV0
  2718     MOVE 'EL852' TO DFHEIV1
  2719     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2720     GOBACK.
  2721
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  62
* EL852.cbl
  2723
  2724 9995-SECURITY-VIOLATION.
  2725*                            COPY ELCSCTP.
  2726******************************************************************
  2727*                                                                *
  2728*                            ELCSCTP                             *
  2729*                            VMOD=2.001                          *
  2730*                                                                *
  2731*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  2732******************************************************************
  2733
  2734
  2735     MOVE EIBDATE          TO SM-JUL-DATE.
  2736     MOVE EIBTRMID         TO SM-TERMID.
  2737     MOVE THIS-PGM         TO SM-PGM.
  2738     MOVE EIBTIME          TO TIME-IN.
  2739     MOVE TIME-OUT         TO SM-TIME.
  2740     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  2741
  2742
  2743* EXEC CICS LINK
  2744*         PROGRAM  ('EL003')
  2745*         COMMAREA (SECURITY-MESSAGE)
  2746*         LENGTH   (80)
  2747*    END-EXEC.
  2748     MOVE 'EL003' TO DFHEIV1
  2749     MOVE 80
  2750       TO DFHEIV11
  2751*    MOVE '."C                   ''   #00002327' TO DFHEIV0
  2752     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  2753     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2754     MOVE X'2020233030303032333237' TO DFHEIV0(25:11)
  2755     CALL 'kxdfhei1' USING DFHEIV0,
  2756           DFHEIV1,
  2757           SECURITY-MESSAGE,
  2758           DFHEIV11,
  2759           DFHEIV99,
  2760           DFHEIV99,
  2761           DFHEIV99
  2762     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2763
  2764
  2765******************************************************************
  2766
  2767
  2768 9995-EXIT.
  2769     EXIT.
  2770
  2771
  2772 9999-DFHBACK SECTION.
  2773     MOVE '9%                    "   ' TO DFHEIV0
  2774     MOVE 'EL852' TO DFHEIV1
  2775     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2776     GOBACK.
  2777 9999-DFHEXIT.
  2778     IF DFHEIGDJ EQUAL 0001
  2779         NEXT SENTENCE
  2780     ELSE IF DFHEIGDJ EQUAL 2
* Micro Focus Server Express         V5.1 revision 000 02-Nov-12 23:15 Page  63
* EL852.cbl
  2781         GO TO 9600-PGMID-ERROR,
  2782               9990-ABEND
  2783         DEPENDING ON DFHEIGDI
  2784     ELSE IF DFHEIGDJ EQUAL 3
  2785         GO TO 4080-REQUEST-NOTFND,
  2786               4080-REQUEST-NOTFND
  2787         DEPENDING ON DFHEIGDI
  2788     ELSE IF DFHEIGDJ EQUAL 4
  2789         GO TO 5070-REQUEST-PROCESSED,
  2790               5070-REQUEST-PROCESSED
  2791         DEPENDING ON DFHEIGDI
  2792     ELSE IF DFHEIGDJ EQUAL 5
  2793         GO TO 5080-REQUEST-NOTFND,
  2794               5080-REQUEST-NOTFND
  2795         DEPENDING ON DFHEIGDI
  2796     ELSE IF DFHEIGDJ EQUAL 6
  2797         GO TO 6080-REQUEST-NOTFND,
  2798               6080-REQUEST-NOTFND
  2799         DEPENDING ON DFHEIGDI
  2800     ELSE IF DFHEIGDJ EQUAL 7
  2801         GO TO 6070-REQUEST-PROCESSED,
  2802               6070-REQUEST-PROCESSED
  2803         DEPENDING ON DFHEIGDI
  2804     ELSE IF DFHEIGDJ EQUAL 8
  2805         GO TO 8300-SEND-TEXT
  2806         DEPENDING ON DFHEIGDI.
  2807     MOVE '9%                    "   ' TO DFHEIV0
  2808     MOVE 'EL852' TO DFHEIV1
  2809     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  2810     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        4188     Code:        7090
