* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page   1
* EL614.cbl
* Options: int("EL614.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL614.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL614.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL614.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL614 .
     3*                            VMOD=2.001.
     4*
     5*
     6*AUTHOR.    PABLO.
     7*           COLLEYVILLE TX.
     8*DATE-COMPILED.
     9*SECURITY.   *****************************************************
    10*            *                                                   *
    11*            *   THIS PROGRAM IS THE PROPERTY OF CSO             *
    12*            *                                                   *
    13*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page   2
* EL614.cbl
    14*            *   OF    CSO      IS EXPRESSLY PROHIBITED WITHOUT  *
    15*            *   THE PRIOR WRITTEN PERMISSION OF CSO.            *
    16*            *                                                   *
    17*            *****************************************************
    18*REMARKS.
    19*        THIS PROGRAM PROVIDES THE MAINTENANCE FUNCTIONS NEEDED
    20*    FOR THE  EOB   CODES IN THE CLAIM SYSTEM.
    21*
    22*    SCREENS     - EL614A - EOB CODE MAINTENANCE
    23*
    24*    ENTERED BY  - EL101 - SYSTEM ADMINISTRATION MENU
    25*                  EL156 - PAYMENT WORKSHEET
    26*                  EL6317 - CERTIFICATE VERIFICATION
    27*    EXIT TO     - EL101 - SYSTEM ADMINISTRATION MENU
    28*                  EL156 - PAYMENT WORKSHEET
    29*                  EL6317 - CERTIFICATE VERIFICATION
    30*    COMMAREA    - PASSED
    31*
    32*    NARRATIVE   - FIRST ENTRY IS VIA AN XCTL FROM EL101.  ON
    33*                  FIRST ENTRY, A SKELETON SCREEN IS SENT AND THE
    34*                  PROGRAM EXITS TO WAIT FOR INPUT.  ON SUCCESSIVE
    35*                  ENTRIES (XCTL FROM CICS VIA EX  ) THE SCREEN
    36*                  WILL BE READ AND ACTION WILL BE BASED ON THE
    37*                  MAINTENANCE TYPE INDICATED.
    38******************************************************************
    39*                   C H A N G E   L O G
    40*
    41* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    42*-----------------------------------------------------------------
    43*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    44* EFFECTIVE    NUMBER
    45*-----------------------------------------------------------------
    46* 083110    2009122800001  PEMA  NEW PROGRAM
    47* 011811    2009122800001  AJRA  FIX SELECTION
    48* 042211    2011040600001  PEMA  FIX ISSUE NO RECORDS FOUND
    49* 081511    2011022800001  PEMA  ADMIN SERV NAPERSOFT CHANGES
    50* 121012    2012101700002  AJRA  HIGHLIGHT REASON CODES
    51* 112113    2013090300001  AJRA  NAPERSOFT PHASE 2
    52* 120318  IR2018112800001  PEMA  Fix memory problem
    53******************************************************************
    54 ENVIRONMENT DIVISION.
    55 DATA DIVISION.
    56 WORKING-STORAGE SECTION.
    57 01  DFH-START PIC X(04).
    58 77  FILLER  PIC X(32)  VALUE '********************************'.
    59 77  FILLER  PIC X(32)  VALUE '*   EL614  WORKING STORAGE     *'.
    60 77  FILLER  PIC X(32)  VALUE '***********VMOD=2.001 **********'.
    61 77  i1                 pic s999  comp-3 value +0.
    62 77  S1                 PIC S999  COMP-3 VALUE +0.
    63 77  S2                 PIC S999  COMP-3 VALUE +0.
    64 77  E1                 PIC S999  COMP-3 VALUE +0.
    65 77  WS-DUP-EOB-SW      PIC X VALUE ' '.
    66     88  FOUND-DUP-EOB     VALUE 'Y'.
    67*    COPY ELCSCTM.
    68******************************************************************
    69*                                                                *
    70*                                                                *
    71*                            ELCSCTM                             *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page   3
* EL614.cbl
    72*                            VMOD=2.001                          *
    73*                                                                *
    74*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    75*                                                                *
    76******************************************************************
    77 01  SECURITY-MESSAGE.
    78     12  FILLER                          PIC X(30)
    79            VALUE '** LOGIC SECURITY VIOLATION -'.
    80     12  SM-READ                         PIC X(6).
    81     12  FILLER                          PIC X(5)
    82            VALUE ' PGM='.
    83     12  SM-PGM                          PIC X(6).
    84     12  FILLER                          PIC X(5)
    85            VALUE ' OPR='.
    86     12  SM-PROCESSOR-ID                 PIC X(4).
    87     12  FILLER                          PIC X(6)
    88            VALUE ' TERM='.
    89     12  SM-TERMID                       PIC X(4).
    90     12  FILLER                          PIC XX   VALUE SPACE.
    91     12  SM-JUL-DATE                     PIC 9(5).
    92     12  FILLER                          PIC X    VALUE SPACE.
    93     12  SM-TIME                         PIC 99.99.
    94
    95*    COPY ELCSCRTY.
    96******************************************************************
    97*                                                                *
    98*                                                                *
    99*                            ELCSCRTY                            *
   100*                            VMOD=2.001                          *
   101*                                                                *
   102*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   103*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   104*        SAVED IN PI-SECURITY-ADDRESS.                           *
   105*                                                                *
   106******************************************************************
   107 01  SECURITY-CONTROL.
   108     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   109     12  FILLER                       PIC XX    VALUE 'SC'.
   110     12  SC-CREDIT-CODES.
   111         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   112             20  SC-CREDIT-DISPLAY    PIC X.
   113             20  SC-CREDIT-UPDATE     PIC X.
   114     12  SC-CLAIMS-CODES.
   115         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   116             20  SC-CLAIMS-DISPLAY    PIC X.
   117             20  SC-CLAIMS-UPDATE     PIC X.
   118 01  WS-PASSED-FROM-CALL-PGM     PIC X(60)  VALUE SPACES.
   119 01  WS-DATE-AREA.
   120     05  SAVE-DATE               PIC X(8)    VALUE SPACES.
   121     05  SAVE-BIN-DATE           PIC X(2)    VALUE SPACES.
   122 01  WS-SELECTED-EOB-CODES.
   123     05  WS-SELECTED-CODES OCCURS 12.
   124         10  WS-SEL-EOB-CODE     PIC XXXX.
   125         10  FILLER              PIC X.
   126 01  FILLER                          COMP-3.
   127     05  TIME-IN                     PIC S9(7)   VALUE ZERO.
   128     05  TIME-OUT                    REDEFINES
   129         TIME-IN                     PIC S9(3)V9(4).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page   4
* EL614.cbl
   130 01  FILLER                          COMP SYNC.
   131     05  WS-INDEX                    PIC S9(4)   VALUE ZERO.
   132     05  WS-JOURNAL-FILE-ID          PIC S9(4)   VALUE +1.
   133     05  WS-JOURNAL-RECORD-LENGTH    PIC S9(4)   VALUE +773.
   134 01  FILLER.
   135     05  QID.
   136         10  QID-TERM            PIC X(4).
   137         10  FILLER              PIC X(4)    VALUE '614A'.
   138     05  QID-ITEM                PIC S9(4)   COMP VALUE +0.
   139     05  NUM-LINES-PER-SCREEN    PIC 99      VALUE 17.
   140     05  TS-LENGTH               PIC S9(4)   VALUE +3360 COMP.
   141 01  ws-endbr-sw                 pic x value ' '.
   142     88  true-endbr               value 'Y'.
   143 01  FILLER.
   144     05  DEEDIT-FIELD        PIC  X(10).
   145     05  DEEDIT-FIELD-V0  REDEFINES
   146         DEEDIT-FIELD        PIC S9(10).
   147     05  WS-RESPONSE             PIC S9(8)   COMP.
   148         88  RESP-NORMAL              VALUE +00.
   149         88  RESP-ERROR               VALUE +01.
   150         88  RESP-NOTFND              VALUE +13.
   151         88  RESP-NOTOPEN             VALUE +19.
   152         88  RESP-ENDFILE             VALUE +20.
   153     05  WS-ELEOBC-KEY.
   154         10  WS-COMPANY-CD           PIC X      VALUE LOW-VALUES.
   155         10  WS-EOB-REC-TYPE         PIC X      VALUE LOW-VALUES.
   156         10  WS-EOB-CODE             PIC X(4)   VALUE LOW-VALUES.
   157         10  FILLER                  PIC X(9)   VALUE LOW-VALUES.
   158     05  WS-MAPSET-NAME              PIC X(8)  VALUE 'EL614S'.
   159     05  WS-MAP-NAME                 PIC X(8)  VALUE 'EL614A'.
   160     05  FILLER                      REDEFINES
   161         WS-MAP-NAME.
   162         10  FILLER                  PIC XX.
   163         10  WS-MAP-NUMBER           PIC X(4).
   164         10  FILLER                  PIC XX.
   165     05  THIS-PGM                    PIC X(8)  VALUE 'EL614'.
   166     05  WS-JOURNAL-TYPE-ID          PIC XX      VALUE 'EL'.
   167     05  WS-TRANS-ID                 PIC X(4)    VALUE 'EXAI'.
   168     05  WS-TEMP-STORAGE-KEY.
   169         10  WS-TS-TERM-ID           PIC X(4)    VALUE 'XXXX'.
   170         10  FILLER                  PIC X(4)    VALUE '614'.
   171     05  WS-REASON-CODE-PASSED       PIC X(26).
   172     05  WS-TABLE-CODE.
   173         10  WS-TAB-CODE-1           PIC X(1).
   174         10  WS-TAB-CODE-2-4         PIC X(3).
   175     05  WS-SCREEN-CODE.
   176         10  WS-SCR-CODE-1-3         PIC X(3).
   177         10  WS-SCR-CODE-4           PIC X(1).
   178     05  WS-ERROR-MESSAGE-AREA.
   179         10  ER-0004             PIC 9(4)   VALUE 0004.
   180         10  ER-0006             PIC 9(4)   VALUE 0006.
   181         10  ER-0008             PIC 9(4)   VALUE 0008.
   182         10  ER-0023             PIC 9(4)   VALUE 0023.
   183         10  ER-0029             PIC 9(4)   VALUE 0029.
   184         10  ER-0033             PIC 9(4)   VALUE 0033.
   185         10  ER-1698             PIC 9(4)   VALUE 1698.
   186         10  ER-1699             PIC 9(4)   VALUE 1699.
   187*                                COPY ELCINTF.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page   5
* EL614.cbl
   188******************************************************************
   189*                                                                *
   190*                                                                *
   191*                            ELCINTF.                            *
   192*                            VMOD=2.017                          *
   193*                                                                *
   194*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
   195*                                                                *
   196*       LENGTH = 1024                                            *
   197*                                                                *
   198******************************************************************
   199*                   C H A N G E   L O G
   200*
   201* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   202*-----------------------------------------------------------------
   203*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   204* EFFECTIVE    NUMBER
   205*-----------------------------------------------------------------
   206* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
   207******************************************************************
   208 01  PROGRAM-INTERFACE-BLOCK.
   209     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
   210     12  PI-CALLING-PROGRAM              PIC X(8).
   211     12  PI-SAVED-PROGRAM-1              PIC X(8).
   212     12  PI-SAVED-PROGRAM-2              PIC X(8).
   213     12  PI-SAVED-PROGRAM-3              PIC X(8).
   214     12  PI-SAVED-PROGRAM-4              PIC X(8).
   215     12  PI-SAVED-PROGRAM-5              PIC X(8).
   216     12  PI-SAVED-PROGRAM-6              PIC X(8).
   217     12  PI-RETURN-TO-PROGRAM            PIC X(8).
   218     12  PI-COMPANY-ID                   PIC XXX.
   219     12  PI-COMPANY-CD                   PIC X.
   220
   221     12  PI-COMPANY-PASSWORD             PIC X(8).
   222
   223     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
   224
   225     12  PI-CONTROL-IN-PROGRESS.
   226         16  PI-CARRIER                  PIC X.
   227         16  PI-GROUPING                 PIC X(6).
   228         16  PI-STATE                    PIC XX.
   229         16  PI-ACCOUNT                  PIC X(10).
   230         16  PI-PRODUCER REDEFINES PI-ACCOUNT
   231                                         PIC X(10).
   232         16  PI-CLAIM-CERT-GRP.
   233             20  PI-CLAIM-NO             PIC X(7).
   234             20  PI-CERT-NO.
   235                 25  PI-CERT-PRIME       PIC X(10).
   236                 25  PI-CERT-SFX         PIC X.
   237             20  PI-CERT-EFF-DT          PIC XX.
   238         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
   239             20  PI-PLAN-CODE            PIC X(2).
   240             20  PI-REVISION-NUMBER      PIC X(3).
   241             20  PI-PLAN-EFF-DT          PIC X(2).
   242             20  PI-PLAN-EXP-DT          PIC X(2).
   243             20  FILLER                  PIC X(11).
   244         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
   245             20  PI-OE-REFERENCE-1.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page   6
* EL614.cbl
   246                 25  PI-OE-REF-1-PRIME   PIC X(18).
   247                 25  PI-OE-REF-1-SUFF    PIC XX.
   248
   249     12  PI-SESSION-IN-PROGRESS          PIC X.
   250         88  CLAIM-SESSION                   VALUE '1'.
   251         88  CREDIT-SESSION                  VALUE '2'.
   252         88  WARRANTY-SESSION                VALUE '3'.
   253         88  MORTGAGE-SESSION                VALUE '4'.
   254         88  GENERAL-LEDGER-SESSION          VALUE '5'.
   255
   256
   257*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
   258
   259     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
   260     12  PI-ORIGINAL-COMPANY-CD          PIC X.
   261
   262     12  PI-CREDIT-USER                  PIC X.
   263         88  PI-NOT-CREDIT-USER              VALUE 'N'.
   264         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
   265
   266     12  PI-CLAIM-USER                   PIC X.
   267         88  PI-NOT-CLAIM-USER               VALUE 'N'.
   268         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
   269
   270     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
   271         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
   272         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
   273         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
   274         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
   275         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
   276
   277     12  PI-PROCESSOR-ID                 PIC X(4).
   278
   279     12  PI-PROCESSOR-PASSWORD           PIC X(11).
   280
   281     12  PI-MEMBER-CAPTION               PIC X(10).
   282
   283     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
   284         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
   285
   286     12  PI-LIFE-OVERRIDE-L1             PIC X.
   287     12  PI-LIFE-OVERRIDE-L2             PIC XX.
   288     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
   289     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
   290
   291     12  PI-AH-OVERRIDE-L1               PIC X.
   292     12  PI-AH-OVERRIDE-L2               PIC XX.
   293     12  PI-AH-OVERRIDE-L6               PIC X(6).
   294     12  PI-AH-OVERRIDE-L12              PIC X(12).
   295
   296     12  PI-NEW-SYSTEM                   PIC X(2).
   297
   298     12  PI-PRIMARY-CERT-NO              PIC X(11).
   299     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
   300         88  PI-USES-PAID-TO                 VALUE '1'.
   301     12  PI-CRDTCRD-SYSTEM.
   302         16  PI-CRDTCRD-USER             PIC X.
   303             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page   7
* EL614.cbl
   304             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
   305         16  PI-CC-MONTH-END-DT          PIC XX.
   306     12  PI-PROCESSOR-PRINTER            PIC X(4).
   307
   308     12  PI-OE-REFERENCE-2.
   309         16  PI-OE-REF-2-PRIME           PIC X(10).
   310         16  PI-OE-REF-2-SUFF            PIC X.
   311
   312     12  PI-REM-TRM-CALC-OPTION          PIC X.
   313
   314     12  PI-LANGUAGE-TYPE                PIC X.
   315             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
   316             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
   317             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
   318
   319     12  PI-POLICY-LINKAGE-IND           PIC X.
   320         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
   321         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
   322                                                   LOW-VALUES.
   323
   324     12  PI-ALT-DMD-PRT-ID               PIC X(4).
   325     12  PI-CLAIM-PW-SESSION             PIC X(1).
   326         88  PI-CLAIM-CREDIT                 VALUE '1'.
   327         88  PI-CLAIM-CONVEN                 VALUE '2'.
   328
   329     12  PI-PROCESSOR-CSR-IND            PIC X.
   330         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
   331         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
   332
   333     12  FILLER                          PIC X(3).
   334
   335     12  PI-SYSTEM-LEVEL                 PIC X(145).
   336
   337     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
   338         PI-SYSTEM-LEVEL.
   339
   340         16  PI-ENTRY-CODES.
   341             20  PI-ENTRY-CD-1           PIC X.
   342             20  PI-ENTRY-CD-2           PIC X.
   343
   344         16  PI-RETURN-CODES.
   345             20  PI-RETURN-CD-1          PIC X.
   346             20  PI-RETURN-CD-2          PIC X.
   347
   348         16  PI-UPDATE-STATUS-SAVE.
   349             20  PI-UPDATE-BY            PIC X(4).
   350             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
   351
   352         16  PI-LOWER-CASE-LETTERS       PIC X.
   353             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
   354
   355*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
   356*            88  CLAIM-NO-UNIQUE             VALUE '1'.
   357*            88  CARRIER-CLM-CNTL            VALUE '2'.
   358
   359         16  PI-CERT-ACCESS-CONTROL      PIC X.
   360             88  ST-ACCNT-CNTL               VALUE ' '.
   361             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page   8
* EL614.cbl
   362             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
   363             88  ACCNT-CNTL                  VALUE '3'.
   364             88  CARR-ACCNT-CNTL             VALUE '4'.
   365
   366         16  PI-PROCESSOR-CAP-LIST.
   367             20  PI-SYSTEM-CONTROLS.
   368                24 PI-SYSTEM-DISPLAY     PIC X.
   369                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
   370                24 PI-SYSTEM-MODIFY      PIC X.
   371                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
   372             20  FILLER                  PIC XX.
   373             20  PI-DISPLAY-CAP          PIC X.
   374                 88  DISPLAY-CAP             VALUE 'Y'.
   375             20  PI-MODIFY-CAP           PIC X.
   376                 88  MODIFY-CAP              VALUE 'Y'.
   377             20  PI-MSG-AT-LOGON-CAP     PIC X.
   378                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
   379             20  PI-FORCE-CAP            PIC X.
   380                 88  FORCE-CAP               VALUE 'Y'.
   381
   382         16  PI-PROGRAM-CONTROLS.
   383             20  PI-PGM-PRINT-OPT        PIC X.
   384             20  PI-PGM-FORMAT-OPT       PIC X.
   385             20  PI-PGM-PROCESS-OPT      PIC X.
   386             20  PI-PGM-TOTALS-OPT       PIC X.
   387
   388         16  PI-HELP-INTERFACE.
   389             20  PI-LAST-ERROR-NO        PIC X(4).
   390             20  PI-CURRENT-SCREEN-NO    PIC X(4).
   391
   392         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
   393             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
   394
   395         16  PI-CR-CONTROL-IN-PROGRESS.
   396             20  PI-CR-CARRIER           PIC X.
   397             20  PI-CR-GROUPING          PIC X(6).
   398             20  PI-CR-STATE             PIC XX.
   399             20  PI-CR-ACCOUNT           PIC X(10).
   400             20  PI-CR-FIN-RESP          PIC X(10).
   401             20  PI-CR-TYPE              PIC X.
   402
   403         16  PI-CR-BATCH-NUMBER          PIC X(6).
   404
   405         16  PI-CR-MONTH-END-DT          PIC XX.
   406
   407         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
   408             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
   409             88  PI-ZERO-CARRIER             VALUE '1'.
   410             88  PI-ZERO-GROUPING            VALUE '2'.
   411             88  PI-ZERO-CAR-GROUP           VALUE '3'.
   412
   413         16  PI-CARRIER-SECURITY         PIC X.
   414             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
   415
   416         16  PI-ACCOUNT-SECURITY         PIC X(10).
   417             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
   418             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
   419
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page   9
* EL614.cbl
   420         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
   421             20  PI-ACCESS-CODE          OCCURS 10 TIMES
   422                                         INDEXED BY PI-ACCESS-NDX
   423                                         PIC X.
   424
   425         16  PI-GA-BILLING-CONTROL       PIC X.
   426             88  PI-GA-BILLING               VALUE '1'.
   427
   428         16  PI-MAIL-PROCESSING          PIC X.
   429             88  PI-MAIL-YES                 VALUE 'Y'.
   430
   431         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
   432
   433         16  PI-AR-SYSTEM.
   434             20  PI-AR-PROCESSING-CNTL   PIC X.
   435                 88  PI-AR-PROCESSING        VALUE 'Y'.
   436             20  PI-AR-SUMMARY-CODE      PIC X(6).
   437             20  PI-AR-MONTH-END-DT      PIC XX.
   438
   439         16  PI-MP-SYSTEM.
   440             20  PI-MORTGAGE-USER            PIC X.
   441                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
   442                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
   443             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
   444                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
   445                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
   446                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
   447                 88  PI-MP-PROD-CNTL                 VALUE '3'.
   448                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
   449             20  PI-MP-MONTH-END-DT          PIC XX.
   450             20  PI-MP-REFERENCE-NO.
   451                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
   452                 24  PI-MP-REFERENCE-SFX     PIC XX.
   453
   454         16  PI-LABEL-CONTROL            PIC X(01).
   455             88  PI-CREATE-LABELS                    VALUE 'Y'.
   456             88  PI-BYPASS-LABELS                    VALUE 'N'.
   457
   458         16  PI-BILL-GROUPING-CODE       PIC X(01).
   459             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
   460
   461         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
   462             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
   463             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
   464
   465         16  FILLER                      PIC X(14).
   466
   467     12  PI-PROGRAM-WORK-AREA            PIC X(640).
   468******************************************************************
   469     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
   470         16  PI-SELECTED-EOB-CODES.
   471             20  PI-SELECTED-CODES OCCURS 12.
   472                 24  PI-EOB-CODE     PIC XXXX.
   473                 24  FILLER          PIC X.
   474         16  PI-1ST-TIME-SW          PIC S9     COMP-3.
   475         16  PI-MODE                 PIC X.
   476             88  ADD-FUNCTION         VALUE 'A'.
   477         16  PI-DN-RCODE             PIC XXXX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  10
* EL614.cbl
   478         16  PI-DN-TOP-KEY           PIC X(15).
   479         16  PI-DN-BOT-KEY           PIC X(15).
   480         16  PI-DN-KEYS OCCURS 17.
   481             20  PI-DN-KEY           PIC X(15).
   482         16  PI-LINE-COUNT           PIC S9(3)  COMP-3.
   483         16  PI-BROWSE-SW            PIC S9     COMP-3.
   484         16  PI-SHOW-SW              PIC S9     COMP-3.
   485         16  PI-CHANGE-SW            PIC S9     COMP-3.
   486         16  PI-RECORD-TYPE          PIC X.
   487         16  pi-FILLER               PIC X(244).
   488         16  PI-TOTAL-LINES          PIC S9(3)   comp-3.
   489         16  PI-CURRENT-LINE         PIC S9(3)   COMP-3.
   490         16  PI-TOP-LINE-NUM         PIC S9(3)   COMP-3.
   491         16  PI-BOT-LINE-NUM         PIC S9(3)   COMP-3.
   492         16  PI-TEMP-STOR-ITEMS      PIC S9(4)   COMP.
   493         16  PI-REASON-CODE-IND.
   494             20 PI-REASON-CODE-FLAG  OCCURS 26 TIMES PIC X(1).
   495         16  PI-EXPANDED-VIEW        PIC X(1).
   496         16  pi-6318-pass            PIC X.
   497         16  filler                  pic x.
   498*                                COPY EL614S.
   499 01  EL614AI.
   500     05  FILLER            PIC  X(0012).
   501*    -------------------------------
   502     05  ADATEL PIC S9(0004) COMP.
   503     05  ADATEF PIC  X(0001).
   504     05  FILLER REDEFINES ADATEF.
   505         10  ADATEA PIC  X(0001).
   506     05  ADATEI PIC  X(0008).
   507*    -------------------------------
   508     05  ATIMEL PIC S9(0004) COMP.
   509     05  ATIMEF PIC  X(0001).
   510     05  FILLER REDEFINES ATIMEF.
   511         10  ATIMEA PIC  X(0001).
   512     05  ATIMEI PIC  X(0005).
   513*    -------------------------------
   514     05  SELHL PIC S9(0004) COMP.
   515     05  SELHF PIC  X(0001).
   516     05  FILLER REDEFINES SELHF.
   517         10  SELHA PIC  X(0001).
   518     05  SELHI PIC  X(0003).
   519*    -------------------------------
   520     05  SEL01L PIC S9(0004) COMP.
   521     05  SEL01F PIC  X(0001).
   522     05  FILLER REDEFINES SEL01F.
   523         10  SEL01A PIC  X(0001).
   524     05  SEL01I PIC  X(0001).
   525*    -------------------------------
   526     05  EOBCD01L PIC S9(0004) COMP.
   527     05  EOBCD01F PIC  X(0001).
   528     05  FILLER REDEFINES EOBCD01F.
   529         10  EOBCD01A PIC  X(0001).
   530     05  EOBCD01I PIC  X(0004).
   531*    -------------------------------
   532     05  DESC01L PIC S9(0004) COMP.
   533     05  DESC01F PIC  X(0001).
   534     05  FILLER REDEFINES DESC01F.
   535         10  DESC01A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  11
* EL614.cbl
   536     05  DESC01I PIC  X(0060).
   537*    -------------------------------
   538     05  SEL02L PIC S9(0004) COMP.
   539     05  SEL02F PIC  X(0001).
   540     05  FILLER REDEFINES SEL02F.
   541         10  SEL02A PIC  X(0001).
   542     05  SEL02I PIC  X(0001).
   543*    -------------------------------
   544     05  EOBCD02L PIC S9(0004) COMP.
   545     05  EOBCD02F PIC  X(0001).
   546     05  FILLER REDEFINES EOBCD02F.
   547         10  EOBCD02A PIC  X(0001).
   548     05  EOBCD02I PIC  X(0004).
   549*    -------------------------------
   550     05  DESC02L PIC S9(0004) COMP.
   551     05  DESC02F PIC  X(0001).
   552     05  FILLER REDEFINES DESC02F.
   553         10  DESC02A PIC  X(0001).
   554     05  DESC02I PIC  X(0060).
   555*    -------------------------------
   556     05  SEL03L PIC S9(0004) COMP.
   557     05  SEL03F PIC  X(0001).
   558     05  FILLER REDEFINES SEL03F.
   559         10  SEL03A PIC  X(0001).
   560     05  SEL03I PIC  X(0001).
   561*    -------------------------------
   562     05  EOBCD03L PIC S9(0004) COMP.
   563     05  EOBCD03F PIC  X(0001).
   564     05  FILLER REDEFINES EOBCD03F.
   565         10  EOBCD03A PIC  X(0001).
   566     05  EOBCD03I PIC  X(0004).
   567*    -------------------------------
   568     05  DESC03L PIC S9(0004) COMP.
   569     05  DESC03F PIC  X(0001).
   570     05  FILLER REDEFINES DESC03F.
   571         10  DESC03A PIC  X(0001).
   572     05  DESC03I PIC  X(0060).
   573*    -------------------------------
   574     05  SEL04L PIC S9(0004) COMP.
   575     05  SEL04F PIC  X(0001).
   576     05  FILLER REDEFINES SEL04F.
   577         10  SEL04A PIC  X(0001).
   578     05  SEL04I PIC  X(0001).
   579*    -------------------------------
   580     05  EOBCD04L PIC S9(0004) COMP.
   581     05  EOBCD04F PIC  X(0001).
   582     05  FILLER REDEFINES EOBCD04F.
   583         10  EOBCD04A PIC  X(0001).
   584     05  EOBCD04I PIC  X(0004).
   585*    -------------------------------
   586     05  DESC04L PIC S9(0004) COMP.
   587     05  DESC04F PIC  X(0001).
   588     05  FILLER REDEFINES DESC04F.
   589         10  DESC04A PIC  X(0001).
   590     05  DESC04I PIC  X(0060).
   591*    -------------------------------
   592     05  SEL05L PIC S9(0004) COMP.
   593     05  SEL05F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  12
* EL614.cbl
   594     05  FILLER REDEFINES SEL05F.
   595         10  SEL05A PIC  X(0001).
   596     05  SEL05I PIC  X(0001).
   597*    -------------------------------
   598     05  EOBCD05L PIC S9(0004) COMP.
   599     05  EOBCD05F PIC  X(0001).
   600     05  FILLER REDEFINES EOBCD05F.
   601         10  EOBCD05A PIC  X(0001).
   602     05  EOBCD05I PIC  X(0004).
   603*    -------------------------------
   604     05  DESC05L PIC S9(0004) COMP.
   605     05  DESC05F PIC  X(0001).
   606     05  FILLER REDEFINES DESC05F.
   607         10  DESC05A PIC  X(0001).
   608     05  DESC05I PIC  X(0060).
   609*    -------------------------------
   610     05  SEL06L PIC S9(0004) COMP.
   611     05  SEL06F PIC  X(0001).
   612     05  FILLER REDEFINES SEL06F.
   613         10  SEL06A PIC  X(0001).
   614     05  SEL06I PIC  X(0001).
   615*    -------------------------------
   616     05  EOBCD06L PIC S9(0004) COMP.
   617     05  EOBCD06F PIC  X(0001).
   618     05  FILLER REDEFINES EOBCD06F.
   619         10  EOBCD06A PIC  X(0001).
   620     05  EOBCD06I PIC  X(0004).
   621*    -------------------------------
   622     05  DESC06L PIC S9(0004) COMP.
   623     05  DESC06F PIC  X(0001).
   624     05  FILLER REDEFINES DESC06F.
   625         10  DESC06A PIC  X(0001).
   626     05  DESC06I PIC  X(0060).
   627*    -------------------------------
   628     05  SEL07L PIC S9(0004) COMP.
   629     05  SEL07F PIC  X(0001).
   630     05  FILLER REDEFINES SEL07F.
   631         10  SEL07A PIC  X(0001).
   632     05  SEL07I PIC  X(0001).
   633*    -------------------------------
   634     05  EOBCD07L PIC S9(0004) COMP.
   635     05  EOBCD07F PIC  X(0001).
   636     05  FILLER REDEFINES EOBCD07F.
   637         10  EOBCD07A PIC  X(0001).
   638     05  EOBCD07I PIC  X(0004).
   639*    -------------------------------
   640     05  DESC07L PIC S9(0004) COMP.
   641     05  DESC07F PIC  X(0001).
   642     05  FILLER REDEFINES DESC07F.
   643         10  DESC07A PIC  X(0001).
   644     05  DESC07I PIC  X(0060).
   645*    -------------------------------
   646     05  SEL08L PIC S9(0004) COMP.
   647     05  SEL08F PIC  X(0001).
   648     05  FILLER REDEFINES SEL08F.
   649         10  SEL08A PIC  X(0001).
   650     05  SEL08I PIC  X(0001).
   651*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  13
* EL614.cbl
   652     05  EOBCD08L PIC S9(0004) COMP.
   653     05  EOBCD08F PIC  X(0001).
   654     05  FILLER REDEFINES EOBCD08F.
   655         10  EOBCD08A PIC  X(0001).
   656     05  EOBCD08I PIC  X(0004).
   657*    -------------------------------
   658     05  DESC08L PIC S9(0004) COMP.
   659     05  DESC08F PIC  X(0001).
   660     05  FILLER REDEFINES DESC08F.
   661         10  DESC08A PIC  X(0001).
   662     05  DESC08I PIC  X(0060).
   663*    -------------------------------
   664     05  SEL09L PIC S9(0004) COMP.
   665     05  SEL09F PIC  X(0001).
   666     05  FILLER REDEFINES SEL09F.
   667         10  SEL09A PIC  X(0001).
   668     05  SEL09I PIC  X(0001).
   669*    -------------------------------
   670     05  EOBCD09L PIC S9(0004) COMP.
   671     05  EOBCD09F PIC  X(0001).
   672     05  FILLER REDEFINES EOBCD09F.
   673         10  EOBCD09A PIC  X(0001).
   674     05  EOBCD09I PIC  X(0004).
   675*    -------------------------------
   676     05  DESC09L PIC S9(0004) COMP.
   677     05  DESC09F PIC  X(0001).
   678     05  FILLER REDEFINES DESC09F.
   679         10  DESC09A PIC  X(0001).
   680     05  DESC09I PIC  X(0060).
   681*    -------------------------------
   682     05  SEL10L PIC S9(0004) COMP.
   683     05  SEL10F PIC  X(0001).
   684     05  FILLER REDEFINES SEL10F.
   685         10  SEL10A PIC  X(0001).
   686     05  SEL10I PIC  X(0001).
   687*    -------------------------------
   688     05  EOBCD10L PIC S9(0004) COMP.
   689     05  EOBCD10F PIC  X(0001).
   690     05  FILLER REDEFINES EOBCD10F.
   691         10  EOBCD10A PIC  X(0001).
   692     05  EOBCD10I PIC  X(0004).
   693*    -------------------------------
   694     05  DESC10L PIC S9(0004) COMP.
   695     05  DESC10F PIC  X(0001).
   696     05  FILLER REDEFINES DESC10F.
   697         10  DESC10A PIC  X(0001).
   698     05  DESC10I PIC  X(0060).
   699*    -------------------------------
   700     05  SEL11L PIC S9(0004) COMP.
   701     05  SEL11F PIC  X(0001).
   702     05  FILLER REDEFINES SEL11F.
   703         10  SEL11A PIC  X(0001).
   704     05  SEL11I PIC  X(0001).
   705*    -------------------------------
   706     05  EOBCD11L PIC S9(0004) COMP.
   707     05  EOBCD11F PIC  X(0001).
   708     05  FILLER REDEFINES EOBCD11F.
   709         10  EOBCD11A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  14
* EL614.cbl
   710     05  EOBCD11I PIC  X(0004).
   711*    -------------------------------
   712     05  DESC11L PIC S9(0004) COMP.
   713     05  DESC11F PIC  X(0001).
   714     05  FILLER REDEFINES DESC11F.
   715         10  DESC11A PIC  X(0001).
   716     05  DESC11I PIC  X(0060).
   717*    -------------------------------
   718     05  SEL12L PIC S9(0004) COMP.
   719     05  SEL12F PIC  X(0001).
   720     05  FILLER REDEFINES SEL12F.
   721         10  SEL12A PIC  X(0001).
   722     05  SEL12I PIC  X(0001).
   723*    -------------------------------
   724     05  EOBCD12L PIC S9(0004) COMP.
   725     05  EOBCD12F PIC  X(0001).
   726     05  FILLER REDEFINES EOBCD12F.
   727         10  EOBCD12A PIC  X(0001).
   728     05  EOBCD12I PIC  X(0004).
   729*    -------------------------------
   730     05  DESC12L PIC S9(0004) COMP.
   731     05  DESC12F PIC  X(0001).
   732     05  FILLER REDEFINES DESC12F.
   733         10  DESC12A PIC  X(0001).
   734     05  DESC12I PIC  X(0060).
   735*    -------------------------------
   736     05  SEL13L PIC S9(0004) COMP.
   737     05  SEL13F PIC  X(0001).
   738     05  FILLER REDEFINES SEL13F.
   739         10  SEL13A PIC  X(0001).
   740     05  SEL13I PIC  X(0001).
   741*    -------------------------------
   742     05  EOBCD13L PIC S9(0004) COMP.
   743     05  EOBCD13F PIC  X(0001).
   744     05  FILLER REDEFINES EOBCD13F.
   745         10  EOBCD13A PIC  X(0001).
   746     05  EOBCD13I PIC  X(0004).
   747*    -------------------------------
   748     05  DESC13L PIC S9(0004) COMP.
   749     05  DESC13F PIC  X(0001).
   750     05  FILLER REDEFINES DESC13F.
   751         10  DESC13A PIC  X(0001).
   752     05  DESC13I PIC  X(0060).
   753*    -------------------------------
   754     05  SEL14L PIC S9(0004) COMP.
   755     05  SEL14F PIC  X(0001).
   756     05  FILLER REDEFINES SEL14F.
   757         10  SEL14A PIC  X(0001).
   758     05  SEL14I PIC  X(0001).
   759*    -------------------------------
   760     05  EOBCD14L PIC S9(0004) COMP.
   761     05  EOBCD14F PIC  X(0001).
   762     05  FILLER REDEFINES EOBCD14F.
   763         10  EOBCD14A PIC  X(0001).
   764     05  EOBCD14I PIC  X(0004).
   765*    -------------------------------
   766     05  DESC14L PIC S9(0004) COMP.
   767     05  DESC14F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  15
* EL614.cbl
   768     05  FILLER REDEFINES DESC14F.
   769         10  DESC14A PIC  X(0001).
   770     05  DESC14I PIC  X(0060).
   771*    -------------------------------
   772     05  SEL15L PIC S9(0004) COMP.
   773     05  SEL15F PIC  X(0001).
   774     05  FILLER REDEFINES SEL15F.
   775         10  SEL15A PIC  X(0001).
   776     05  SEL15I PIC  X(0001).
   777*    -------------------------------
   778     05  EOBCD15L PIC S9(0004) COMP.
   779     05  EOBCD15F PIC  X(0001).
   780     05  FILLER REDEFINES EOBCD15F.
   781         10  EOBCD15A PIC  X(0001).
   782     05  EOBCD15I PIC  X(0004).
   783*    -------------------------------
   784     05  DESC15L PIC S9(0004) COMP.
   785     05  DESC15F PIC  X(0001).
   786     05  FILLER REDEFINES DESC15F.
   787         10  DESC15A PIC  X(0001).
   788     05  DESC15I PIC  X(0060).
   789*    -------------------------------
   790     05  SEL16L PIC S9(0004) COMP.
   791     05  SEL16F PIC  X(0001).
   792     05  FILLER REDEFINES SEL16F.
   793         10  SEL16A PIC  X(0001).
   794     05  SEL16I PIC  X(0001).
   795*    -------------------------------
   796     05  EOBCD16L PIC S9(0004) COMP.
   797     05  EOBCD16F PIC  X(0001).
   798     05  FILLER REDEFINES EOBCD16F.
   799         10  EOBCD16A PIC  X(0001).
   800     05  EOBCD16I PIC  X(0004).
   801*    -------------------------------
   802     05  DESC16L PIC S9(0004) COMP.
   803     05  DESC16F PIC  X(0001).
   804     05  FILLER REDEFINES DESC16F.
   805         10  DESC16A PIC  X(0001).
   806     05  DESC16I PIC  X(0060).
   807*    -------------------------------
   808     05  SEL17L PIC S9(0004) COMP.
   809     05  SEL17F PIC  X(0001).
   810     05  FILLER REDEFINES SEL17F.
   811         10  SEL17A PIC  X(0001).
   812     05  SEL17I PIC  X(0001).
   813*    -------------------------------
   814     05  EOBCD17L PIC S9(0004) COMP.
   815     05  EOBCD17F PIC  X(0001).
   816     05  FILLER REDEFINES EOBCD17F.
   817         10  EOBCD17A PIC  X(0001).
   818     05  EOBCD17I PIC  X(0004).
   819*    -------------------------------
   820     05  DESC17L PIC S9(0004) COMP.
   821     05  DESC17F PIC  X(0001).
   822     05  FILLER REDEFINES DESC17F.
   823         10  DESC17A PIC  X(0001).
   824     05  DESC17I PIC  X(0060).
   825*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  16
* EL614.cbl
   826     05  AEMSGL PIC S9(0004) COMP.
   827     05  AEMSGF PIC  X(0001).
   828     05  FILLER REDEFINES AEMSGF.
   829         10  AEMSGA PIC  X(0001).
   830     05  AEMSGI PIC  X(0079).
   831*    -------------------------------
   832     05  APFKL PIC S9(0004) COMP.
   833     05  APFKF PIC  X(0001).
   834     05  FILLER REDEFINES APFKF.
   835         10  APFKA PIC  X(0001).
   836     05  APFKI PIC  S99.
   837*    -------------------------------
   838     05  F3KEYL PIC S9(0004) COMP.
   839     05  F3KEYF PIC  X(0001).
   840     05  FILLER REDEFINES F3KEYF.
   841         10  F3KEYA PIC  X(0001).
   842     05  F3KEYI PIC  X(0019).
   843*    -------------------------------
   844     05  F5KEYL PIC S9(0004) COMP.
   845     05  F5KEYF PIC  X(0001).
   846     05  FILLER REDEFINES F5KEYF.
   847         10  F5KEYA PIC  X(0001).
   848     05  F5KEYI PIC  X(0025).
   849 01  EL614AO REDEFINES EL614AI.
   850     05  FILLER            PIC  X(0012).
   851*    -------------------------------
   852     05  FILLER            PIC  X(0003).
   853     05  ADATEO PIC  X(0008).
   854*    -------------------------------
   855     05  FILLER            PIC  X(0003).
   856     05  ATIMEO PIC  99.99.
   857*    -------------------------------
   858     05  FILLER            PIC  X(0003).
   859     05  SELHO PIC  X(0003).
   860*    -------------------------------
   861     05  FILLER            PIC  X(0003).
   862     05  SEL01O PIC  X(0001).
   863*    -------------------------------
   864     05  FILLER            PIC  X(0003).
   865     05  EOBCD01O PIC  X(0004).
   866*    -------------------------------
   867     05  FILLER            PIC  X(0003).
   868     05  DESC01O PIC  X(0060).
   869*    -------------------------------
   870     05  FILLER            PIC  X(0003).
   871     05  SEL02O PIC  X(0001).
   872*    -------------------------------
   873     05  FILLER            PIC  X(0003).
   874     05  EOBCD02O PIC  X(0004).
   875*    -------------------------------
   876     05  FILLER            PIC  X(0003).
   877     05  DESC02O PIC  X(0060).
   878*    -------------------------------
   879     05  FILLER            PIC  X(0003).
   880     05  SEL03O PIC  X(0001).
   881*    -------------------------------
   882     05  FILLER            PIC  X(0003).
   883     05  EOBCD03O PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  17
* EL614.cbl
   884*    -------------------------------
   885     05  FILLER            PIC  X(0003).
   886     05  DESC03O PIC  X(0060).
   887*    -------------------------------
   888     05  FILLER            PIC  X(0003).
   889     05  SEL04O PIC  X(0001).
   890*    -------------------------------
   891     05  FILLER            PIC  X(0003).
   892     05  EOBCD04O PIC  X(0004).
   893*    -------------------------------
   894     05  FILLER            PIC  X(0003).
   895     05  DESC04O PIC  X(0060).
   896*    -------------------------------
   897     05  FILLER            PIC  X(0003).
   898     05  SEL05O PIC  X(0001).
   899*    -------------------------------
   900     05  FILLER            PIC  X(0003).
   901     05  EOBCD05O PIC  X(0004).
   902*    -------------------------------
   903     05  FILLER            PIC  X(0003).
   904     05  DESC05O PIC  X(0060).
   905*    -------------------------------
   906     05  FILLER            PIC  X(0003).
   907     05  SEL06O PIC  X(0001).
   908*    -------------------------------
   909     05  FILLER            PIC  X(0003).
   910     05  EOBCD06O PIC  X(0004).
   911*    -------------------------------
   912     05  FILLER            PIC  X(0003).
   913     05  DESC06O PIC  X(0060).
   914*    -------------------------------
   915     05  FILLER            PIC  X(0003).
   916     05  SEL07O PIC  X(0001).
   917*    -------------------------------
   918     05  FILLER            PIC  X(0003).
   919     05  EOBCD07O PIC  X(0004).
   920*    -------------------------------
   921     05  FILLER            PIC  X(0003).
   922     05  DESC07O PIC  X(0060).
   923*    -------------------------------
   924     05  FILLER            PIC  X(0003).
   925     05  SEL08O PIC  X(0001).
   926*    -------------------------------
   927     05  FILLER            PIC  X(0003).
   928     05  EOBCD08O PIC  X(0004).
   929*    -------------------------------
   930     05  FILLER            PIC  X(0003).
   931     05  DESC08O PIC  X(0060).
   932*    -------------------------------
   933     05  FILLER            PIC  X(0003).
   934     05  SEL09O PIC  X(0001).
   935*    -------------------------------
   936     05  FILLER            PIC  X(0003).
   937     05  EOBCD09O PIC  X(0004).
   938*    -------------------------------
   939     05  FILLER            PIC  X(0003).
   940     05  DESC09O PIC  X(0060).
   941*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  18
* EL614.cbl
   942     05  FILLER            PIC  X(0003).
   943     05  SEL10O PIC  X(0001).
   944*    -------------------------------
   945     05  FILLER            PIC  X(0003).
   946     05  EOBCD10O PIC  X(0004).
   947*    -------------------------------
   948     05  FILLER            PIC  X(0003).
   949     05  DESC10O PIC  X(0060).
   950*    -------------------------------
   951     05  FILLER            PIC  X(0003).
   952     05  SEL11O PIC  X(0001).
   953*    -------------------------------
   954     05  FILLER            PIC  X(0003).
   955     05  EOBCD11O PIC  X(0004).
   956*    -------------------------------
   957     05  FILLER            PIC  X(0003).
   958     05  DESC11O PIC  X(0060).
   959*    -------------------------------
   960     05  FILLER            PIC  X(0003).
   961     05  SEL12O PIC  X(0001).
   962*    -------------------------------
   963     05  FILLER            PIC  X(0003).
   964     05  EOBCD12O PIC  X(0004).
   965*    -------------------------------
   966     05  FILLER            PIC  X(0003).
   967     05  DESC12O PIC  X(0060).
   968*    -------------------------------
   969     05  FILLER            PIC  X(0003).
   970     05  SEL13O PIC  X(0001).
   971*    -------------------------------
   972     05  FILLER            PIC  X(0003).
   973     05  EOBCD13O PIC  X(0004).
   974*    -------------------------------
   975     05  FILLER            PIC  X(0003).
   976     05  DESC13O PIC  X(0060).
   977*    -------------------------------
   978     05  FILLER            PIC  X(0003).
   979     05  SEL14O PIC  X(0001).
   980*    -------------------------------
   981     05  FILLER            PIC  X(0003).
   982     05  EOBCD14O PIC  X(0004).
   983*    -------------------------------
   984     05  FILLER            PIC  X(0003).
   985     05  DESC14O PIC  X(0060).
   986*    -------------------------------
   987     05  FILLER            PIC  X(0003).
   988     05  SEL15O PIC  X(0001).
   989*    -------------------------------
   990     05  FILLER            PIC  X(0003).
   991     05  EOBCD15O PIC  X(0004).
   992*    -------------------------------
   993     05  FILLER            PIC  X(0003).
   994     05  DESC15O PIC  X(0060).
   995*    -------------------------------
   996     05  FILLER            PIC  X(0003).
   997     05  SEL16O PIC  X(0001).
   998*    -------------------------------
   999     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  19
* EL614.cbl
  1000     05  EOBCD16O PIC  X(0004).
  1001*    -------------------------------
  1002     05  FILLER            PIC  X(0003).
  1003     05  DESC16O PIC  X(0060).
  1004*    -------------------------------
  1005     05  FILLER            PIC  X(0003).
  1006     05  SEL17O PIC  X(0001).
  1007*    -------------------------------
  1008     05  FILLER            PIC  X(0003).
  1009     05  EOBCD17O PIC  X(0004).
  1010*    -------------------------------
  1011     05  FILLER            PIC  X(0003).
  1012     05  DESC17O PIC  X(0060).
  1013*    -------------------------------
  1014     05  FILLER            PIC  X(0003).
  1015     05  AEMSGO PIC  X(0079).
  1016*    -------------------------------
  1017     05  FILLER            PIC  X(0003).
  1018     05  APFKO PIC  X(0002).
  1019*    -------------------------------
  1020     05  FILLER            PIC  X(0003).
  1021     05  F3KEYO PIC  X(0019).
  1022*    -------------------------------
  1023     05  FILLER            PIC  X(0003).
  1024     05  F5KEYO PIC  X(0025).
  1025*    -------------------------------
  1026 01  EL614AO-R REDEFINES EL614AI.
  1027     05  FILLER                      PIC X(37).
  1028     05  WS-MAP-LINE                 OCCURS 17
  1029                                     INDEXED BY M1 M2 N1.
  1030         10  SELL                    PIC S9(4)  COMP.
  1031         10  SELA                    PIC X.
  1032         10  SELI                    PIC X.
  1033         10  RCODEL                  PIC S9(4)  COMP.
  1034         10  RCODEA                  PIC X.
  1035         10  RCODEO                  PIC XXXX.
  1036         10  RCODEI                  REDEFINES
  1037             RCODEO                  PIC XXXX.
  1038         10  DESCL                   PIC S9(4)   COMP.
  1039         10  DESCA                   PIC X.
  1040         10  DESCO                   PIC X(60).
  1041         10  DESCI                   REDEFINES
  1042             DESCO                   PIC X(60).
  1043     05  FILLER                      PIC X(137).
  1044*                                COPY ELCJPFX.
  1045******************************************************************
  1046*                                                                *
  1047*                                                                *
  1048*                            ELCJPFX.                            *
  1049*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1050*                            VMOD=2.002                          *
  1051*                                                                *
  1052*    USER DATA FOR SYSTEM JOURNAL RECORDS  JOURNAL I.D. = "EL"   *
  1053*                                                                *
  1054*     ALL RECORDS ARE JOURNALED FOR ERROR RECOVERY               *
  1055*     FILES JOURNALED FOR AUDIT TRAIL (BEFORE CHANGE) ARE -      *
  1056*        ELCNTL - CONTROL FILE                                   *
  1057*        ELMSTR - CLAIM MASTERS                                  *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  20
* EL614.cbl
  1058*        ELTRLR - ACTIVITY TRAILERS                              *
  1059*        ELCHKQ - CHECK QUE                                      *
  1060******************************************************************
  1061 01  JOURNAL-RECORD.
  1062     12  jp-date                     pic s9(5) comp-3.
  1063     12  jp-time                     pic s9(7) comp-3.
  1064     12  JP-USER-ID                  PIC X(4).
  1065     12  JP-FILE-ID                  PIC X(8).
  1066     12  JP-PROGRAM-ID               PIC X(8).
  1067     12  JP-RECORD-TYPE              PIC X.
  1068         88 JP-ADD              VALUE 'A'.
  1069         88 JP-BEFORE-CHANGE    VALUE 'B'.
  1070         88 JP-AFTER-CHANGE     VALUE 'C'.
  1071         88 JP-DELETE           VALUE 'D'.
  1072         88 JP-GENERIC-DELETE   VALUE 'G'.
  1073         88 JP-KEY-CHG-DELETE   VALUE 'K'.
  1074         88 JP-KEY-CHG-ADD      VALUE 'N'.
  1075     12  JP-GENERIC-KEY-LENGTH       PIC S9(4)   COMP.
  1076     12  JP-RECORD-AREA
  1077
  1078
  1079                                 PIC X(750).
  1080*                                COPY ELCEOBC.
  1081******************************************************************
  1082*                                                                *
  1083*                                                                *
  1084*                            ELCEOBC                             *
  1085*                            VMOD=2.001                          *
  1086*                                                                *
  1087*   CLAIM SYSTEM EOB CODE TABLE                                  *
  1088*                                                                *
  1089*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  1090*   VSAM EOB CODE TABLE                                          *
  1091*                                                                *
  1092*   FILE DESCRIPTION = EOB CODE TABLE                            *
  1093*                                                                *
  1094*   FILE TYPE = VSAM,KSDS                                        *
  1095*   RECORD SIZE = 350   RECFORM = FIX                            *
  1096*                                                                *
  1097*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  1098*                                                                *
  1099*   LOG = NO                                                     *
  1100*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  1101*                                                                *
  1102*                                                                *
  1103******************************************************************
  1104*                   C H A N G E   L O G
  1105*
  1106* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1107*-----------------------------------------------------------------
  1108*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1109* EFFECTIVE    NUMBER
  1110*-----------------------------------------------------------------
  1111* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  1112* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  1113* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  1114******************************************************************
  1115 01  EOB-CODES.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  21
* EL614.cbl
  1116     12  EO-RECORD-ID                      PIC XX.
  1117         88  VALID-DN-ID                      VALUE 'EO'.
  1118     12  EO-CONTROL-PRIMARY.
  1119         16  EO-COMPANY-CD                 PIC X.
  1120         16  EO-RECORD-TYPE                PIC X.
  1121             88  EO-EOB-RECS                  VALUE '1'.
  1122             88  EO-VERIF-RECS                VALUE '2'.
  1123             88  EO-GCE-RECS                  VALUE '3'.
  1124             88  EO-CANC-RECS                 VALUE '4'.
  1125             88  EO-BILL-NOTE-RECS            VALUE '5'.
  1126         16  EO-EOB-CODE                   PIC X(4).
  1127         16  FILLER                        PIC X(9).
  1128     12  EO-MAINT-INFORMATION.
  1129         16  EO-LAST-MAINT-DT              PIC XX.
  1130         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  1131         16  EO-LAST-MAINT-USER            PIC X(4).
  1132         16  FILLER                        PIC XX.
  1133     12  EO-DESCRIPTION                    PIC X(275).
  1134     12  FILLER                            PIC X(46).
  1135******************************************************************
  1136*                                COPY ELCEMIB.
  1137******************************************************************
  1138*                                                                *
  1139*                                                                *
  1140*                            ELCEMIB.                            *
  1141*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1142*                            VMOD=2.005                          *
  1143*                                                                *
  1144*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  1145*                                                                *
  1146******************************************************************
  1147 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  1148     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  1149     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  1150     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  1151     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  1152     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  1153     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  1154     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  1155     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  1156     12  EMI-SWITCH1             PIC X        VALUE '1'.
  1157         88  EMI-NO-ERRORS                    VALUE '1'.
  1158         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  1159         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  1160     12  EMI-SWITCH2             PIC X        VALUE '1'.
  1161         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  1162     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  1163         88  EMI-AREA1-EMPTY                  VALUE '1'.
  1164         88  EMI-AREA1-FULL                   VALUE '2'.
  1165     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  1166         88  EMI-AREA2-EMPTY                  VALUE '1'.
  1167         88  EMI-AREA2-FULL                   VALUE '2'.
  1168     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  1169         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  1170         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  1171         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  1172         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  1173         88  EMI-BYPASS-FATALS                VALUE 'X'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  22
* EL614.cbl
  1174     12  EMI-ERROR-LINES.
  1175         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  1176         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  1177         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  1178         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  1179             20  EMI-ERR-CODES OCCURS 10 TIMES.
  1180                 24  EMI-ERR-NUM         PIC X(4).
  1181                 24  EMI-FILLER          PIC X.
  1182                 24  EMI-SEV             PIC X.
  1183                 24  FILLER              PIC X.
  1184             20  FILLER                  PIC X(02).
  1185     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  1186         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  1187             20  EMI-ERROR-NUMBER    PIC X(4).
  1188             20  EMI-FILL            PIC X.
  1189             20  EMI-SEVERITY        PIC X.
  1190             20  FILLER              PIC X.
  1191             20  EMI-ERROR-TEXT.
  1192                 24  EMI-TEXT-VARIABLE   PIC X(10).
  1193                 24  FILLER          PIC X(55).
  1194     12  EMI-SEVERITY-SAVE           PIC X.
  1195         88  EMI-NOTE                    VALUE 'N'.
  1196         88  EMI-WARNING                 VALUE 'W'.
  1197         88  EMI-FORCABLE                VALUE 'F'.
  1198         88  EMI-FATAL                   VALUE 'X'.
  1199     12  EMI-MESSAGE-FLAG            PIC X.
  1200         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  1201         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  1202     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  1203     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  1204         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  1205         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  1206         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  1207     12  emi-claim-no                pic x(7).
  1208     12  emi-claim-type              pic x(6).
  1209     12  FILLER                      PIC X(124)  VALUE SPACES.
  1210     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  1211     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  1212     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  1213     12  EMI-AH-OVERRIDE-L6          PIC X(6).
  1214*                                COPY ELCDATE.
  1215******************************************************************
  1216*                                                                *
  1217*                                                                *
  1218*                            ELCDATE.                            *
  1219*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  1220*                            VMOD=2.003
  1221*                                                                *
  1222*                                                                *
  1223*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  1224*                 LENGTH = 200                                   *
  1225******************************************************************
  1226
  1227 01  DATE-CONVERSION-DATA.
  1228     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  1229     12  DC-OPTION-CODE                PIC X.
  1230         88  BIN-TO-GREG                VALUE ' '.
  1231         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  23
* EL614.cbl
  1232         88  EDIT-GREG-TO-BIN           VALUE '2'.
  1233         88  YMD-GREG-TO-BIN            VALUE '3'.
  1234         88  MDY-GREG-TO-BIN            VALUE '4'.
  1235         88  JULIAN-TO-BIN              VALUE '5'.
  1236         88  BIN-PLUS-ELAPSED           VALUE '6'.
  1237         88  FIND-CENTURY               VALUE '7'.
  1238         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  1239         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  1240         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  1241         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  1242         88  JULIAN-TO-BIN-3            VALUE 'C'.
  1243         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  1244         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  1245         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  1246         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  1247         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  1248         88  CHECK-LEAP-YEAR            VALUE 'H'.
  1249         88  BIN-3-TO-GREG              VALUE 'I'.
  1250         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  1251         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  1252         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  1253         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  1254         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  1255         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  1256         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  1257         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  1258         88  THREE-CHARACTER-BIN
  1259                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  1260         88  GREGORIAN-TO-BIN
  1261                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  1262         88  BIN-TO-GREGORIAN
  1263                  VALUES ' ' '1' 'I' '8' 'G'.
  1264         88  JULIAN-TO-BINARY
  1265                  VALUES '5' 'C' 'E' 'F'.
  1266     12  DC-ERROR-CODE                 PIC X.
  1267         88  NO-CONVERSION-ERROR        VALUE ' '.
  1268         88  DATE-CONVERSION-ERROR
  1269                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  1270         88  DATE-IS-ZERO               VALUE '1'.
  1271         88  DATE-IS-NON-NUMERIC        VALUE '2'.
  1272         88  DATE-IS-INVALID            VALUE '3'.
  1273         88  DATE1-GREATER-DATE2        VALUE '4'.
  1274         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  1275         88  DATE-INVALID-OPTION        VALUE '9'.
  1276         88  INVALID-CENTURY            VALUE 'A'.
  1277         88  ONLY-CENTURY               VALUE 'B'.
  1278         88  ONLY-LEAP-YEAR             VALUE 'C'.
  1279         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  1280     12  DC-END-OF-MONTH               PIC X.
  1281         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  1282     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  1283         88  USE-NORMAL-PROCESS         VALUE ' '.
  1284         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  1285         88  ADJUST-UP-100-YRS          VALUE '2'.
  1286     12  FILLER                        PIC X.
  1287     12  DC-CONVERSION-DATES.
  1288         16  DC-BIN-DATE-1             PIC XX.
  1289         16  DC-BIN-DATE-2             PIC XX.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  24
* EL614.cbl
  1290         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  1291         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  1292                       DC-GREG-DATE-1-EDIT.
  1293             20  DC-EDIT1-MONTH        PIC 99.
  1294             20  SLASH1-1              PIC X.
  1295             20  DC-EDIT1-DAY          PIC 99.
  1296             20  SLASH1-2              PIC X.
  1297             20  DC-EDIT1-YEAR         PIC 99.
  1298         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  1299         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  1300                     DC-GREG-DATE-2-EDIT.
  1301             20  DC-EDIT2-MONTH        PIC 99.
  1302             20  SLASH2-1              PIC X.
  1303             20  DC-EDIT2-DAY          PIC 99.
  1304             20  SLASH2-2              PIC X.
  1305             20  DC-EDIT2-YEAR         PIC 99.
  1306         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  1307         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  1308                     DC-GREG-DATE-1-YMD.
  1309             20  DC-YMD-YEAR           PIC 99.
  1310             20  DC-YMD-MONTH          PIC 99.
  1311             20  DC-YMD-DAY            PIC 99.
  1312         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  1313         16  DC-GREG-DATE-1-MDY-R REDEFINES
  1314                      DC-GREG-DATE-1-MDY.
  1315             20  DC-MDY-MONTH          PIC 99.
  1316             20  DC-MDY-DAY            PIC 99.
  1317             20  DC-MDY-YEAR           PIC 99.
  1318         16  DC-GREG-DATE-1-ALPHA.
  1319             20  DC-ALPHA-MONTH        PIC X(10).
  1320             20  DC-ALPHA-DAY          PIC 99.
  1321             20  FILLER                PIC XX.
  1322             20  DC-ALPHA-CENTURY.
  1323                 24 DC-ALPHA-CEN-N     PIC 99.
  1324             20  DC-ALPHA-YEAR         PIC 99.
  1325         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  1326         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  1327         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  1328         16  DC-JULIAN-DATE            PIC 9(05).
  1329         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
  1330                                       PIC 9(05).
  1331         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  1332             20  DC-JULIAN-YEAR        PIC 99.
  1333             20  DC-JULIAN-DAYS        PIC 999.
  1334         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  1335         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  1336         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  1337     12  DATE-CONVERSION-VARIBLES.
  1338         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  1339         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  1340             20  FILLER                PIC 9(3).
  1341             20  HOLD-CEN-1-CCYY.
  1342                 24  HOLD-CEN-1-CC     PIC 99.
  1343                 24  HOLD-CEN-1-YY     PIC 99.
  1344             20  HOLD-CEN-1-MO         PIC 99.
  1345             20  HOLD-CEN-1-DA         PIC 99.
  1346         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  1347             20  HOLD-CEN-1-R-MO       PIC 99.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  25
* EL614.cbl
  1348             20  HOLD-CEN-1-R-DA       PIC 99.
  1349             20  HOLD-CEN-1-R-CCYY.
  1350                 24  HOLD-CEN-1-R-CC   PIC 99.
  1351                 24  HOLD-CEN-1-R-YY   PIC 99.
  1352             20  FILLER                PIC 9(3).
  1353         16  HOLD-CENTURY-1-X.
  1354             20  FILLER                PIC X(3)  VALUE SPACES.
  1355             20  HOLD-CEN-1-X-CCYY.
  1356                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  1357                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  1358             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  1359             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  1360         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  1361             20  HOLD-CEN-1-R-X-MO     PIC XX.
  1362             20  HOLD-CEN-1-R-X-DA     PIC XX.
  1363             20  HOLD-CEN-1-R-X-CCYY.
  1364                 24  HOLD-CEN-1-R-X-CC PIC XX.
  1365                 24  HOLD-CEN-1-R-X-YY PIC XX.
  1366             20  FILLER                PIC XXX.
  1367         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  1368         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  1369         16  DC-JULIAN-DATE-1          PIC 9(07).
  1370         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  1371             20  DC-JULIAN-1-CCYY.
  1372                 24  DC-JULIAN-1-CC    PIC 99.
  1373                 24  DC-JULIAN-1-YR    PIC 99.
  1374             20  DC-JULIAN-DA-1        PIC 999.
  1375         16  DC-JULIAN-DATE-2          PIC 9(07).
  1376         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  1377             20  DC-JULIAN-2-CCYY.
  1378                 24  DC-JULIAN-2-CC    PIC 99.
  1379                 24  DC-JULIAN-2-YR    PIC 99.
  1380             20  DC-JULIAN-DA-2        PIC 999.
  1381         16  DC-GREG-DATE-A-EDIT.
  1382             20  DC-EDITA-MONTH        PIC 99.
  1383             20  SLASHA-1              PIC X VALUE '/'.
  1384             20  DC-EDITA-DAY          PIC 99.
  1385             20  SLASHA-2              PIC X VALUE '/'.
  1386             20  DC-EDITA-CCYY.
  1387                 24  DC-EDITA-CENT     PIC 99.
  1388                 24  DC-EDITA-YEAR     PIC 99.
  1389         16  DC-GREG-DATE-B-EDIT.
  1390             20  DC-EDITB-MONTH        PIC 99.
  1391             20  SLASHB-1              PIC X VALUE '/'.
  1392             20  DC-EDITB-DAY          PIC 99.
  1393             20  SLASHB-2              PIC X VALUE '/'.
  1394             20  DC-EDITB-CCYY.
  1395                 24  DC-EDITB-CENT     PIC 99.
  1396                 24  DC-EDITB-YEAR     PIC 99.
  1397         16  DC-GREG-DATE-CYMD         PIC 9(08).
  1398         16  DC-GREG-DATE-CYMD-R REDEFINES
  1399                              DC-GREG-DATE-CYMD.
  1400             20  DC-CYMD-CEN           PIC 99.
  1401             20  DC-CYMD-YEAR          PIC 99.
  1402             20  DC-CYMD-MONTH         PIC 99.
  1403             20  DC-CYMD-DAY           PIC 99.
  1404         16  DC-GREG-DATE-MDCY         PIC 9(08).
  1405         16  DC-GREG-DATE-MDCY-R REDEFINES
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  26
* EL614.cbl
  1406                              DC-GREG-DATE-MDCY.
  1407             20  DC-MDCY-MONTH         PIC 99.
  1408             20  DC-MDCY-DAY           PIC 99.
  1409             20  DC-MDCY-CEN           PIC 99.
  1410             20  DC-MDCY-YEAR          PIC 99.
  1411    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  1412        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  1413    12  DC-EL310-DATE                  PIC X(21).
  1414    12  FILLER                         PIC X(28).
  1415*                                COPY ELCLOGOF.
  1416******************************************************************
  1417*                                                                *
  1418*                                                                *
  1419*                            ELCLOGOF.                           *
  1420*                            VMOD=2.001                          *
  1421*                                                                *
  1422*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  1423*                                                                *
  1424******************************************************************
  1425 01  CLASIC-LOGOFF.
  1426     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  1427     12  LOGOFF-TEXT.
  1428         16  FILLER          PIC X(5)    VALUE SPACES.
  1429         16  LOGOFF-MSG.
  1430             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  1431             20  FILLER      PIC X       VALUE SPACES.
  1432             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  1433         16  FILLER          PIC X(80)
  1434           VALUE '* YOU ARE NOW LOGGED OFF'.
  1435         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  1436         16  FILLER          PIC X       VALUE QUOTE.
  1437         16  LOGOFF-SYS-MSG  PIC X(17)
  1438           VALUE 'S CLAS-IC SYSTEM '.
  1439     12  TEXT-MESSAGES.
  1440         16  UNACCESS-MSG    PIC X(29)
  1441             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  1442         16  PGMIDERR-MSG    PIC X(17)
  1443             VALUE 'PROGRAM NOT FOUND'.
  1444*                                COPY ELCATTR.
  1445******************************************************************
  1446*                                                                *
  1447*                            ELCATTR.                            *
  1448*                            VMOD=2.001                          *
  1449*                                                                *
  1450*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1451*                                                                *
  1452*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1453*                                                                *
  1454*                   POS 1   P=PROTECTED                          *
  1455*                           U=UNPROTECTED                        *
  1456*                           S=ASKIP                              *
  1457*                   POS 2   A=ALPHA/NUMERIC                      *
  1458*                           N=NUMERIC                            *
  1459*                   POS 3   N=NORMAL                             *
  1460*                           B=BRIGHT                             *
  1461*                           D=DARK                               *
  1462*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1463*                           OF=MODIFIED DATA TAG OFF             *
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  27
* EL614.cbl
  1464*                                                                *
  1465*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1466******************************************************************
  1467 01  ATTRIBUTE-LIST.
  1468     12  AL-PABOF            PIC X       VALUE 'Y'.
  1469     12  AL-PABON            PIC X       VALUE 'Z'.
  1470     12  AL-PADOF            PIC X       VALUE '%'.
  1471     12  AL-PADON            PIC X       VALUE '_'.
  1472     12  AL-PANOF            PIC X       VALUE '-'.
  1473     12  AL-PANON            PIC X       VALUE '/'.
  1474     12  AL-SABOF            PIC X       VALUE '8'.
  1475     12  AL-SABON            PIC X       VALUE '9'.
  1476     12  AL-SADOF            PIC X       VALUE '@'.
  1477     12  AL-SADON            PIC X       VALUE QUOTE.
  1478     12  AL-SANOF            PIC X       VALUE '0'.
  1479     12  AL-SANON            PIC X       VALUE '1'.
  1480     12  AL-UABOF            PIC X       VALUE 'H'.
  1481     12  AL-UABON            PIC X       VALUE 'I'.
  1482     12  AL-UADOF            PIC X       VALUE '<'.
  1483     12  AL-UADON            PIC X       VALUE '('.
  1484     12  AL-UANOF            PIC X       VALUE ' '.
  1485     12  AL-UANON            PIC X       VALUE 'A'.
  1486     12  AL-UNBOF            PIC X       VALUE 'Q'.
  1487     12  AL-UNBON            PIC X       VALUE 'R'.
  1488     12  AL-UNDOF            PIC X       VALUE '*'.
  1489     12  AL-UNDON            PIC X       VALUE ')'.
  1490     12  AL-UNNOF            PIC X       VALUE '&'.
  1491     12  AL-UNNON            PIC X       VALUE 'J'.
  1492*                                COPY ELCAID.
  1493******************************************************************
  1494*                                                                *
  1495*                            ELCAID.                             *
  1496*                            VMOD=2.001                          *
  1497*                                                                *
  1498*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1499*                                                                *
  1500*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1501*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1502******************************************************************
  1503
  1504 01  DFHAID.
  1505   02  DFHNULL   PIC  X  VALUE  ' '.
  1506   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1507   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1508   02  DFHPEN    PIC  X  VALUE  '='.
  1509   02  DFHOPID   PIC  X  VALUE  'W'.
  1510   02  DFHPA1    PIC  X  VALUE  '%'.
  1511   02  DFHPA2    PIC  X  VALUE  '>'.
  1512   02  DFHPA3    PIC  X  VALUE  ','.
  1513   02  DFHPF1    PIC  X  VALUE  '1'.
  1514   02  DFHPF2    PIC  X  VALUE  '2'.
  1515   02  DFHPF3    PIC  X  VALUE  '3'.
  1516   02  DFHPF4    PIC  X  VALUE  '4'.
  1517   02  DFHPF5    PIC  X  VALUE  '5'.
  1518   02  DFHPF6    PIC  X  VALUE  '6'.
  1519   02  DFHPF7    PIC  X  VALUE  '7'.
  1520   02  DFHPF8    PIC  X  VALUE  '8'.
  1521   02  DFHPF9    PIC  X  VALUE  '9'.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  28
* EL614.cbl
  1522   02  DFHPF10   PIC  X  VALUE  ':'.
  1523   02  DFHPF11   PIC  X  VALUE  '#'.
  1524   02  DFHPF12   PIC  X  VALUE  '@'.
  1525   02  DFHPF13   PIC  X  VALUE  'A'.
  1526   02  DFHPF14   PIC  X  VALUE  'B'.
  1527   02  DFHPF15   PIC  X  VALUE  'C'.
  1528   02  DFHPF16   PIC  X  VALUE  'D'.
  1529   02  DFHPF17   PIC  X  VALUE  'E'.
  1530   02  DFHPF18   PIC  X  VALUE  'F'.
  1531   02  DFHPF19   PIC  X  VALUE  'G'.
  1532   02  DFHPF20   PIC  X  VALUE  'H'.
  1533   02  DFHPF21   PIC  X  VALUE  'I'.
  1534*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1535   02  DFHPF22   PIC  X  VALUE  '['.
  1536   02  DFHPF23   PIC  X  VALUE  '.'.
  1537   02  DFHPF24   PIC  X  VALUE  '<'.
  1538   02  DFHMSRE   PIC  X  VALUE  'X'.
  1539   02  DFHSTRF   PIC  X  VALUE  'h'.
  1540   02  DFHTRIG   PIC  X  VALUE  '"'.
  1541 01  FILLER    REDEFINES DFHAID.
  1542     05  FILLER                      PIC X(8).
  1543     05  PF-VALUES                   PIC X
  1544         OCCURS 24 TIMES.
  1545 01  TS-WORK-AREA                PIC X(3348).
  1546****************************************************************
  1547*
  1548* Copyright (c) 2007-2013 Dell Inc.
  1549* All rights reserved.
  1550*
  1551****************************************************************
  1552 01  DFHEIV.
  1553   02  DFHEIV0               PIC X(35).
  1554   02  DFHEIV1               PIC X(08).
  1555   02  DFHEIV2               PIC X(08).
  1556   02  DFHEIV3               PIC X(08).
  1557   02  DFHEIV4               PIC X(06).
  1558   02  DFHEIV5               PIC X(04).
  1559   02  DFHEIV6               PIC X(04).
  1560   02  DFHEIV7               PIC X(02).
  1561   02  DFHEIV8               PIC X(02).
  1562   02  DFHEIV9               PIC X(01).
  1563   02  DFHEIV10              PIC S9(7) COMP-3.
  1564   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1565   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1566   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1567   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1568   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1569   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1570   02  DFHEIV17              PIC X(04).
  1571   02  DFHEIV18              PIC X(04).
  1572   02  DFHEIV19              PIC X(04).
  1573   02  DFHEIV20              USAGE IS POINTER.
  1574   02  DFHEIV21              USAGE IS POINTER.
  1575   02  DFHEIV22              USAGE IS POINTER.
  1576   02  DFHEIV23              USAGE IS POINTER.
  1577   02  DFHEIV24              USAGE IS POINTER.
  1578   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1579   02  DFHEIV26              PIC S9(9) COMP SYNC.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  29
* EL614.cbl
  1580   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1581   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1582   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1583   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1584   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1585   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1586   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1587   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1588   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1589   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1590   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1591   02  FILLER                PIC X(02).
  1592   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1593   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1594   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1595   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1596   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1597   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1598   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  1599 LINKAGE  SECTION.
  1600*****************************************************************
  1601*                                                               *
  1602* Copyright (c) 2007-2013 Dell Inc.                             *
  1603* All rights reserved.                                          *
  1604*                                                               *
  1605*****************************************************************
  1606 01  dfheiblk.
  1607     02  eibtime          pic s9(7) comp-3.
  1608     02  eibdate          pic s9(7) comp-3.
  1609     02  eibtrnid         pic x(4).
  1610     02  eibtaskn         pic s9(7) comp-3.
  1611     02  eibtrmid         pic x(4).
  1612     02  dfheigdi         pic s9(4) comp.
  1613     02  eibcposn         pic s9(4) comp.
  1614     02  eibcalen         pic s9(4) comp.
  1615     02  eibaid           pic x(1).
  1616     02  eibfiller1       pic x(1).
  1617     02  eibfn            pic x(2).
  1618     02  eibfiller2       pic x(2).
  1619     02  eibrcode         pic x(6).
  1620     02  eibfiller3       pic x(2).
  1621     02  eibds            pic x(8).
  1622     02  eibreqid         pic x(8).
  1623     02  eibrsrce         pic x(8).
  1624     02  eibsync          pic x(1).
  1625     02  eibfree          pic x(1).
  1626     02  eibrecv          pic x(1).
  1627     02  eibsend          pic x(1).
  1628     02  eibatt           pic x(1).
  1629     02  eibeoc           pic x(1).
  1630     02  eibfmh           pic x(1).
  1631     02  eibcompl         pic x(1).
  1632     02  eibsig           pic x(1).
  1633     02  eibconf          pic x(1).
  1634     02  eiberr           pic x(1).
  1635     02  eibrldbk         pic x(1).
  1636     02  eiberrcd         pic x(4).
  1637     02  eibsynrb         pic x(1).
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  30
* EL614.cbl
  1638     02  eibnodat         pic x(1).
  1639     02  eibfiller5       pic x(2).
  1640     02  eibresp          pic s9(8) comp.
  1641     02  eibresp2         pic s9(8) comp.
  1642     02  dfheigdj         pic s9(4) comp.
  1643     02  dfheigdk         pic s9(4) comp.
  1644 01  DFHCOMMAREA                 PIC X(1024).
  1645 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA.
  1646 0000-DFHEXIT SECTION.
  1647     MOVE '9#                    $   ' TO DFHEIV0.
  1648     MOVE 'EL614' TO DFHEIV1.
  1649     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  1650     MOVE EIBDATE               TO DC-JULIAN-YYDDD.
  1651     MOVE '5'                   TO DC-OPTION-CODE.
  1652     PERFORM 8500-DATE-CONVERSION
  1653                                THRU 8500-EXIT
  1654     MOVE DC-GREG-DATE-1-EDIT   TO  SAVE-DATE.
  1655     MOVE DC-BIN-DATE-1         TO  SAVE-BIN-DATE.
  1656     MOVE DFHCOMMAREA           TO  PROGRAM-INTERFACE-BLOCK.
  1657     MOVE +1                    TO  EMI-NUMBER-OF-LINES
  1658                                    EMI-SWITCH2.
  1659     IF EIBCALEN NOT > ZERO
  1660        MOVE UNACCESS-MSG        TO LOGOFF-MSG
  1661        GO TO 8300-SEND-TEXT
  1662     END-IF
  1663
  1664* EXEC CICS HANDLE CONDITION
  1665*        PGMIDERR (9600-PGMIDERR)
  1666*        ERROR    (9990-ERROR)
  1667*    END-EXEC
  1668*    MOVE '"$L.                  ! " #00001659' TO DFHEIV0
  1669     MOVE X'22244C2E2020202020202020' TO DFHEIV0(1:12)
  1670     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  1671     MOVE X'2220233030303031363539' TO DFHEIV0(25:11)
  1672     CALL 'kxdfhei1' USING DFHEIV0
  1673     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1674     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  1675        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  1676           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-6
  1677           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-5
  1678           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-4
  1679           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-3
  1680           MOVE PI-SAVED-PROGRAM-1   TO  PI-SAVED-PROGRAM-2
  1681           MOVE PI-RETURN-TO-PROGRAM TO  PI-SAVED-PROGRAM-1
  1682           MOVE PI-CALLING-PROGRAM   TO  PI-RETURN-TO-PROGRAM
  1683           MOVE THIS-PGM             TO  PI-CALLING-PROGRAM
  1684        ELSE
  1685           MOVE PI-RETURN-TO-PROGRAM TO  PI-CALLING-PROGRAM
  1686           MOVE PI-SAVED-PROGRAM-1   TO  PI-RETURN-TO-PROGRAM
  1687           MOVE PI-SAVED-PROGRAM-2   TO  PI-SAVED-PROGRAM-1
  1688           MOVE PI-SAVED-PROGRAM-3   TO  PI-SAVED-PROGRAM-2
  1689           MOVE PI-SAVED-PROGRAM-4   TO  PI-SAVED-PROGRAM-3
  1690           MOVE PI-SAVED-PROGRAM-5   TO  PI-SAVED-PROGRAM-4
  1691           MOVE PI-SAVED-PROGRAM-6   TO  PI-SAVED-PROGRAM-5
  1692           MOVE SPACES               TO  PI-SAVED-PROGRAM-6
  1693        END-IF
  1694     END-IF
  1695     IF EIBTRNID NOT = WS-TRANS-ID
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  31
* EL614.cbl
  1696        GO TO 1000-INITIAL-SCREEN
  1697     END-IF
  1698     IF EIBAID = DFHCLEAR
  1699        GO TO 9400-CLEAR
  1700     END-IF
  1701     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  1702        MOVE LOW-VALUES          TO EL614AO
  1703        MOVE -1                  TO APFKL
  1704        MOVE ER-0008             TO EMI-ERROR
  1705        GO TO 8200-SEND-DATAONLY
  1706     END-IF
  1707
  1708* EXEC CICS RECEIVE
  1709*        INTO   (EL614AO)
  1710*        MAPSET (WS-MAPSET-NAME)
  1711*        MAP    (WS-MAP-NAME)
  1712*    END-EXEC
  1713     MOVE LENGTH OF
  1714      EL614AO
  1715       TO DFHEIV11
  1716*    MOVE '8"T I  L              ''   #00001696' TO DFHEIV0
  1717     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  1718     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  1719     MOVE X'2020233030303031363936' TO DFHEIV0(25:11)
  1720     CALL 'kxdfhei1' USING DFHEIV0,
  1721           WS-MAP-NAME,
  1722           EL614AO,
  1723           DFHEIV11,
  1724           WS-MAPSET-NAME,
  1725           DFHEIV99,
  1726           DFHEIV99
  1727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  1728     IF APFKL > ZERO
  1729        IF EIBAID NOT = DFHENTER
  1730           MOVE ER-0004          TO EMI-ERROR
  1731           MOVE AL-UNBOF         TO APFKA
  1732           MOVE -1               TO APFKL
  1733           GO TO 8200-SEND-DATAONLY
  1734        ELSE
  1735           IF APFKO NUMERIC AND
  1736              (APFKO > ZERO AND LESS '25')
  1737              MOVE PF-VALUES (APFKI)
  1738                                 TO  EIBAID
  1739           ELSE
  1740              MOVE ER-0029       TO  EMI-ERROR
  1741              MOVE AL-UNBOF      TO  APFKA
  1742              MOVE -1            TO  APFKL
  1743              GO TO 8200-SEND-DATAONLY
  1744           END-IF
  1745        END-IF
  1746     END-IF
  1747     IF EIBAID = DFHPF12
  1748        MOVE 'EL010'             TO THIS-PGM
  1749        GO TO 9300-XCTL
  1750     END-IF
  1751     IF EIBAID = DFHPF23
  1752        GO TO 9000-RETURN-CICS
  1753     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  32
* EL614.cbl
  1754     IF EIBAID = DFHPF24
  1755        IF CREDIT-SESSION
  1756           MOVE 'EL626'          TO THIS-PGM
  1757           GO TO 9300-XCTL
  1758        ELSE
  1759           MOVE 'EL126'          TO THIS-PGM
  1760           GO TO 9300-XCTL
  1761        END-IF
  1762     END-IF
  1763     IF EIBAID = DFHENTER OR DFHPF1 OR DFHPF2
  1764        OR DFHPF3 OR DFHPF4 OR DFHPF5
  1765        CONTINUE
  1766     ELSE
  1767        MOVE ER-0008             TO EMI-ERROR
  1768        MOVE -1                  TO APFKL
  1769        GO TO 8200-SEND-DATAONLY
  1770     END-IF
  1771     IF EIBAID = DFHPF1 OR DFHPF2 OR DFHPF3
  1772        OR DFHPF4 OR DFHENTER OR DFHPF5
  1773        MOVE 'S'                 TO PI-MODE
  1774     ELSE
  1775        MOVE AL-UABOF            TO APFKA
  1776        MOVE -1                  TO APFKL
  1777        MOVE ER-0023             TO EMI-ERROR
  1778        PERFORM 9900-ERROR-FORMAT
  1779     END-IF
  1780     IF EMI-FATAL-CTR > ZERO
  1781        GO TO 8200-SEND-DATAONLY
  1782     END-IF
  1783     IF PI-MODE EQUAL 'S'
  1784        GO TO 2000-PROCESS-SHOW
  1785     END-IF
  1786     MOVE 'LOGIC ERROR HAS OCCURRED - PROGRAM EL614'
  1787                                 TO LOGOFF-MSG
  1788     GO TO 8300-SEND-TEXT
  1789     .
  1790 1000-INITIAL-SCREEN.
  1791     MOVE PI-PROGRAM-WORK-AREA (1:60)
  1792                                 TO WS-PASSED-FROM-CALL-PGM
  1793     MOVE PI-REASON-CODE-IND     TO WS-REASON-CODE-PASSED
  1794     EVALUATE TRUE
  1795        WHEN PI-RETURN-TO-PROGRAM = 'EL156'
  1796           MOVE WS-PASSED-FROM-CALL-PGM
  1797                                 TO PI-PROGRAM-WORK-AREA
  1798           MOVE '1'              TO PI-RECORD-TYPE
  1799        WHEN PI-RETURN-TO-PROGRAM = 'EL6316'
  1800           MOVE WS-PASSED-FROM-CALL-PGM
  1801                                 TO PI-PROGRAM-WORK-AREA
  1802           MOVE '4'              TO PI-RECORD-TYPE
  1803        WHEN PI-RETURN-TO-PROGRAM = 'EL6317'
  1804           MOVE WS-PASSED-FROM-CALL-PGM
  1805                                 TO PI-PROGRAM-WORK-AREA
  1806           MOVE '2'              TO PI-RECORD-TYPE
  1807        WHEN PI-RETURN-TO-PROGRAM = 'EL6318'
  1808           MOVE WS-PASSED-FROM-CALL-PGM
  1809                                 TO PI-PROGRAM-WORK-AREA
  1810           MOVE WS-REASON-CODE-PASSED TO PI-REASON-CODE-IND
  1811           MOVE 'N'              TO PI-EXPANDED-VIEW
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  33
* EL614.cbl
  1812           MOVE '3'              TO PI-RECORD-TYPE
  1813        WHEN OTHER
  1814           MOVE SPACES           TO PI-PROGRAM-WORK-AREA
  1815                                    WS-PASSED-FROM-CALL-PGM
  1816                                    PI-RECORD-TYPE
  1817     END-EVALUATE
  1818     MOVE PI-COMPANY-CD          TO WS-ELEOBC-KEY
  1819     MOVE PI-RECORD-TYPE         TO WS-EOB-REC-TYPE
  1820     MOVE ZERO                   TO PI-1ST-TIME-SW
  1821                                    PI-LINE-COUNT
  1822                                    PI-BROWSE-SW
  1823                                    PI-SHOW-SW
  1824                                    PI-CHANGE-SW
  1825     MOVE LOW-VALUES             TO EL614AO
  1826     GO TO 7000-BUILD-TABLE
  1827     .
  1828 2000-PROCESS-SHOW.
  1829**  THE FIRST THING TO DO IS CHECK
  1830**  FOR PF4 (CLEAR SELECTED CODES) IF PRESSED
  1831**  SPACE OUT THE PRIOR SELECTIONS. NEXT CHECK
  1832**  THE SELECTED CODES
  1833**  AGAINST THE TABLE AND SYNC THEM UP.
  1834**  IF THEY SPACE ONE OUT THEN GET RID OF IT FROM THE
  1835**  TABLE
  1836     IF EIBAID = DFHPF4
  1837        MOVE SPACES              TO PI-SELECTED-EOB-CODES
  1838        move pi-dn-TOP-key    to WS-ELEOBC-KEY
  1839        GO TO 7000-browse-fwd
  1840     END-IF
  1841
  1842     IF EIBAID = DFHPF5
  1843         IF PI-EXPANDED-VIEW = 'Y'
  1844             MOVE 'N'        TO PI-EXPANDED-VIEW
  1845         ELSE
  1846             MOVE 'Y'        TO PI-EXPANDED-VIEW
  1847         END-IF
  1848         move pi-dn-TOP-key    to WS-ELEOBC-KEY
  1849         GO TO 7000-browse-fwd
  1850     END-IF
  1851     IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317' OR 'EL6318'
  1852        OR 'EL6316'
  1853        PERFORM VARYING M1 FROM +1 BY +1 UNTIL
  1854           M1 > +17
  1855           IF SELL (M1) > +0
  1856              IF SELI (M1) = SPACES
  1857                 PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  1858                    E1 > +12
  1859                    IF PI-EOB-CODE (E1) = RCODEI (M1)
  1860                       MOVE SPACES TO PI-EOB-CODE (E1)
  1861                    END-IF
  1862                 END-PERFORM
  1863              ELSE
  1864                 MOVE ' '       TO WS-DUP-EOB-SW
  1865                 PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  1866                    E1 > +12
  1867                    IF RCODEI (M1) = PI-EOB-CODE (E1)
  1868                       SET FOUND-DUP-EOB TO TRUE
  1869                    END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  34
* EL614.cbl
  1870                 END-PERFORM
  1871                 IF NOT FOUND-DUP-EOB
  1872                    PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  1873                       (PI-EOB-CODE (E1) = SPACES)
  1874                       OR (E1 > +12)
  1875                    END-PERFORM
  1876                    IF E1 < +13
  1877                       MOVE RCODEI (M1) TO PI-EOB-CODE (E1)
  1878                    END-IF
  1879                 END-IF
  1880              END-IF
  1881           END-IF
  1882        END-PERFORM
  1883     END-IF
  1884     EVALUATE TRUE
  1885        WHEN EIBAID = DFHPF2
  1886           MOVE PI-TOP-LINE-NUM TO PI-BOT-LINE-NUM
  1887                                   PI-CURRENT-LINE
  1888           move pi-dn-top-key    to WS-ELEOBC-KEY
  1889           GO TO 7150-browse-bwd
  1890        WHEN EIBAID = DFHPF1
  1891           MOVE PI-BOT-LINE-NUM TO PI-TOP-LINE-NUM
  1892                                   PI-CURRENT-LINE
  1893           move pi-dn-bot-key    to WS-ELEOBC-KEY
  1894           GO TO 7000-browse-fwd
  1895        WHEN EIBAID = DFHPF3
  1896           PERFORM 6100-FORMAT-EOB-CODES
  1897                                 THRU 6100-EXIT
  1898           GO TO 9400-CLEAR
  1899        WHEN OTHER
  1900*          MOVE PI-COMPANY-CD    TO WS-ELEOBC-KEY
  1901*          GO TO 7000-BROWSE-FWD
  1902           MOVE -1 TO SELL (1)
  1903           GO TO 8200-SEND-DATAONLY
  1904     END-EVALUATE
  1905     .
  1906 6100-FORMAT-EOB-CODES.
  1907**  THIS ROUTINE JUST ELIMINATES ANY EOB CODES THAT
  1908**  WERE "UN SELECTED"
  1909     MOVE SPACES                 TO WS-SELECTED-EOB-CODES
  1910     MOVE +1                     TO E1 S1
  1911     PERFORM UNTIL E1 > +12
  1912        IF PI-EOB-CODE (E1) NOT = SPACES
  1913           MOVE PI-EOB-CODE (E1) TO WS-SEL-EOB-CODE (S1)
  1914           ADD +1                TO S1
  1915        END-IF
  1916        ADD +1                   TO E1
  1917     END-PERFORM
  1918     MOVE WS-SELECTED-EOB-CODES  TO PI-SELECTED-EOB-CODES
  1919     .
  1920 6100-EXIT.
  1921     EXIT.
  1922
  1923 7000-BUILD-TABLE.
  1924     MOVE ZEROS                  TO  PI-TOTAL-LINES
  1925                                     PI-CURRENT-LINE
  1926                                     PI-TEMP-STOR-ITEMS
  1927                                     i1
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  35
* EL614.cbl
  1928     MOVE ZERO                   TO PI-LINE-COUNT
  1929     MOVE +1                     TO PI-BROWSE-SW
  1930     move ' '                    to pi-6318-pass
  1931****IF TEMP STORAGE EXISTS, DELETE IT.
  1932     PERFORM 7500-READ-TS THRU 7599-EXIT
  1933
  1934     IF PI-TEMP-STOR-ITEMS NOT = ZERO
  1935        PERFORM 7250-DELETE-TEMP-STOR THRU 7299-EXIT
  1936     END-IF.
  1937 7000-browse-fwd.
  1938     set m1 to +1
  1939     move +1 to pi-browse-sw
  1940     move low-values to el614ao
  1941
  1942
  1943* EXEC CICS STARTBR
  1944*        DATASET   ('ELEOBC')
  1945*        RIDFLD    (WS-ELEOBC-KEY)
  1946*        GTEQ
  1947*        RESP      (WS-RESPONSE)
  1948*    END-EXEC.
  1949     MOVE 'ELEOBC' TO DFHEIV1
  1950     MOVE 0
  1951       TO DFHEIV11
  1952*    MOVE '&,         G          &  N#00001915' TO DFHEIV0
  1953     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  1954     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  1955     MOVE X'204E233030303031393135' TO DFHEIV0(25:11)
  1956     CALL 'kxdfhei1' USING DFHEIV0,
  1957           DFHEIV1,
  1958           WS-ELEOBC-KEY,
  1959           DFHEIV99,
  1960           DFHEIV11,
  1961           DFHEIV99
  1962     MOVE EIBRESP  TO WS-RESPONSE
  1963     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  1964
  1965
  1966     EVALUATE TRUE
  1967        WHEN RESP-ENDFILE
  1968           GO TO 7030-ENDBR
  1969        WHEN RESP-NORMAL
  1970           CONTINUE
  1971        WHEN RESP-NOTFND
  1972           GO TO 7030-ENDBR
  1973     END-EVALUATE.
  1974
  1975***IF COMING FROM EL6318 WE WANT TO LOAD THE HIGHLIGHTED REASON CO
  1976***FOLLOWED BY THE NON HIGHLIGHTED. FOR ALL OTHER SCREENS WE JUST
  1977***REASON CODES IN ORDER.
  1978     IF PI-RETURN-TO-PROGRAM NOT EQUAL 'EL6318'
  1979         GO TO 7020-LOOP
  1980     END-IF.
  1981     perform varying s2 from +1 by +1 until
  1982        (s2 > +26)
  1983        or (WS-EOB-CODE(1:1) = pi-reason-code-flag (s2))
  1984     end-perform
  1985     if s2 <= +26
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  36
* EL614.cbl
  1986        move '1'                 to pi-6318-pass
  1987     else
  1988        move '2'                 to pi-6318-pass
  1989     end-if
  1990     if pi-6318-pass = '2'
  1991        go to 7010-NON-HIGHLIGHT-LOOP
  1992     end-if
  1993     .
  1994 7001-HIGHLIGHT-LOOP.
  1995
  1996* EXEC CICS READNEXT
  1997*        INTO    (EOB-CODES)
  1998*        DATASET ('ELEOBC')
  1999*        RIDFLD  (WS-ELEOBC-KEY)
  2000*        RESP    (WS-RESPONSE)
  2001*    END-EXEC
  2002     MOVE LENGTH OF
  2003      EOB-CODES
  2004       TO DFHEIV12
  2005     MOVE 'ELEOBC' TO DFHEIV1
  2006     MOVE 0
  2007       TO DFHEIV11
  2008*    MOVE '&.IL                  )  N#00001951' TO DFHEIV0
  2009     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2010     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2011     MOVE X'204E233030303031393531' TO DFHEIV0(25:11)
  2012     CALL 'kxdfhei1' USING DFHEIV0,
  2013           DFHEIV1,
  2014           EOB-CODES,
  2015           DFHEIV12,
  2016           WS-ELEOBC-KEY,
  2017           DFHEIV99,
  2018           DFHEIV11,
  2019           DFHEIV99,
  2020           DFHEIV99
  2021     MOVE EIBRESP  TO WS-RESPONSE
  2022     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2023
  2024     EVALUATE TRUE
  2025        WHEN RESP-ENDFILE
  2026           GO TO 7005-ENDBR
  2027        WHEN (PI-COMPANY-CD NOT = WS-COMPANY-CD)
  2028           OR ((PI-RECORD-TYPE NOT = EO-RECORD-TYPE)
  2029               AND (PI-RECORD-TYPE NOT = SPACES))
  2030           GO TO 7005-ENDBR
  2031        WHEN RESP-NORMAL
  2032           CONTINUE
  2033        WHEN RESP-NOTFND
  2034           GO TO 7005-ENDBR
  2035        WHEN EO-COMPANY-CD NOT = PI-COMPANY-CD
  2036           GO TO 7005-ENDBR
  2037     END-EVALUATE
  2038
  2039     PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  2040        (S2 > +26)
  2041        or (eo-eob-code (1:1) = pi-reason-code-flag (s2))
  2042     end-perform
  2043     if s2 > +26
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  37
* EL614.cbl
  2044        go to 7001-highlight-loop
  2045     end-if
  2046     MOVE eo-eob-code            TO WS-TABLE-CODE
  2047     MOVE WS-TAB-CODE-1          TO WS-SCR-CODE-4
  2048     MOVE WS-TAB-CODE-2-4        TO WS-SCR-CODE-1-3
  2049     MOVE WS-SCREEN-CODE         TO RCODEO (M1)
  2050     MOVE eo-DESCRIPTION         TO DESCO (M1)
  2051     MOVE AL-SABON               TO RCODEA (M1)
  2052     MOVE AL-SABOF               TO DESCA (M1)
  2053     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  2054        E1 > +12
  2055        MOVE PI-EOB-CODE (E1)    TO WS-SCREEN-CODE
  2056        MOVE WS-SCR-CODE-1-3     TO WS-TAB-CODE-2-4
  2057        MOVE WS-SCR-CODE-4       TO WS-TAB-CODE-1
  2058        IF eo-EOB-CODE  = WS-TABLE-CODE
  2059           MOVE 'S'              TO SELI (M1)
  2060           MOVE +1               TO SELL (M1)
  2061        END-IF
  2062     END-PERFORM
  2063     if m1 = +1
  2064        move ws-eleobc-key to pi-dn-top-key
  2065     else
  2066        move ws-eleobc-key to pi-dn-bot-key
  2067     end-if
  2068     IF PI-EXPANDED-VIEW = 'Y'
  2069         IF eo-DESCRIPTION (61:60) > SPACES
  2070           AND M1 < +17
  2071             SET N1 TO M1
  2072             SET M1 UP BY +1
  2073             MOVE eo-DESCRIPTION (61:60) TO DESCO (M1)
  2074             MOVE DESCA (N1)    TO DESCA (M1)
  2075             MOVE AL-SADOF      TO SELA (M1)
  2076         END-IF
  2077         IF eo-DESCRIPTION (121:60) > SPACES
  2078           AND M1 < +17
  2079             SET N1 TO M1
  2080             SET M1 UP BY +1
  2081             MOVE eo-DESCRIPTION (121:60) TO DESCO (M1)
  2082             MOVE DESCA (N1)    TO DESCA (M1)
  2083             MOVE AL-SADOF      TO SELA (M1)
  2084         END-IF
  2085         IF eo-DESCRIPTION (181:60) > SPACES
  2086           AND M1 < +17
  2087             SET N1 TO M1
  2088             SET M1 UP BY +1
  2089             MOVE eo-DESCRIPTION (181:60) TO DESCO (M1)
  2090             MOVE DESCA (N1)    TO DESCA (M1)
  2091             MOVE AL-SADOF      TO SELA (M1)
  2092         END-IF
  2093         IF Eo-DESCRIPTION (241:35) > SPACES
  2094           AND M1 < +17
  2095             SET N1 TO M1
  2096             SET M1 UP BY +1
  2097             MOVE eo-DESCRIPTION (241:35) TO DESCO (M1)
  2098             MOVE DESCA (N1)    TO DESCA (M1)
  2099             MOVE AL-SADOF      TO SELA (M1)
  2100         END-IF
  2101     END-IF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  38
* EL614.cbl
  2102     if m1 < num-lines-per-screen
  2103        set m1 up by +1
  2104        go to 7001-HIGHLIGHT-LOOP
  2105     end-if
  2106     .
  2107 7005-ENDBR.
  2108     if m1 = num-lines-per-screen   *> filled up the screen
  2109        go to 7030-endbr
  2110     end-if
  2111*** did not fill up screen, now load non highlighted stuff
  2112
  2113* EXEC CICS ENDBR
  2114*        DATASET ('ELEOBC')
  2115*    END-EXEC
  2116     MOVE 'ELEOBC' TO DFHEIV1
  2117     MOVE 0
  2118       TO DFHEIV11
  2119*    MOVE '&2                    $   #00002046' TO DFHEIV0
  2120     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2121     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2122     MOVE X'2020233030303032303436' TO DFHEIV0(25:11)
  2123     CALL 'kxdfhei1' USING DFHEIV0,
  2124           DFHEIV1,
  2125           DFHEIV11,
  2126           DFHEIV99
  2127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2128     move '2'                    to pi-6318-pass
  2129
  2130     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  2131     MOVE PI-COMPANY-CD          TO WS-ELEOBC-KEY
  2132     MOVE PI-RECORD-TYPE         TO WS-EOB-REC-TYPE
  2133
  2134* EXEC CICS STARTBR
  2135*        DATASET   ('ELEOBC')
  2136*        RIDFLD    (WS-ELEOBC-KEY)
  2137*        GTEQ
  2138*        RESP      (WS-RESPONSE)
  2139*    END-EXEC.
  2140     MOVE 'ELEOBC' TO DFHEIV1
  2141     MOVE 0
  2142       TO DFHEIV11
  2143*    MOVE '&,         G          &  N#00002054' TO DFHEIV0
  2144     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2145     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2146     MOVE X'204E233030303032303534' TO DFHEIV0(25:11)
  2147     CALL 'kxdfhei1' USING DFHEIV0,
  2148           DFHEIV1,
  2149           WS-ELEOBC-KEY,
  2150           DFHEIV99,
  2151           DFHEIV11,
  2152           DFHEIV99
  2153     MOVE EIBRESP  TO WS-RESPONSE
  2154     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2155
  2156
  2157     EVALUATE TRUE
  2158        WHEN RESP-ENDFILE
  2159           GO TO 7030-ENDBR
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  39
* EL614.cbl
  2160        WHEN RESP-NORMAL
  2161           CONTINUE
  2162        WHEN RESP-NOTFND
  2163           GO TO 7030-ENDBR
  2164     END-EVALUATE.
  2165
  2166 7010-NON-HIGHLIGHT-LOOP.
  2167
  2168* EXEC CICS READNEXT
  2169*        INTO    (EOB-CODES)
  2170*        DATASET ('ELEOBC')
  2171*        RIDFLD  (WS-ELEOBC-KEY)
  2172*        RESP    (WS-RESPONSE)
  2173*    END-EXEC
  2174     MOVE LENGTH OF
  2175      EOB-CODES
  2176       TO DFHEIV12
  2177     MOVE 'ELEOBC' TO DFHEIV1
  2178     MOVE 0
  2179       TO DFHEIV11
  2180*    MOVE '&.IL                  )  N#00002071' TO DFHEIV0
  2181     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2182     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2183     MOVE X'204E233030303032303731' TO DFHEIV0(25:11)
  2184     CALL 'kxdfhei1' USING DFHEIV0,
  2185           DFHEIV1,
  2186           EOB-CODES,
  2187           DFHEIV12,
  2188           WS-ELEOBC-KEY,
  2189           DFHEIV99,
  2190           DFHEIV11,
  2191           DFHEIV99,
  2192           DFHEIV99
  2193     MOVE EIBRESP  TO WS-RESPONSE
  2194     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2195
  2196     EVALUATE TRUE
  2197        WHEN RESP-ENDFILE
  2198           GO TO 7030-ENDBR
  2199        WHEN (PI-COMPANY-CD NOT = WS-COMPANY-CD)
  2200           OR ((PI-RECORD-TYPE NOT = EO-RECORD-TYPE)
  2201               AND (PI-RECORD-TYPE NOT = SPACES))
  2202           GO TO 7030-ENDBR
  2203        WHEN RESP-NORMAL
  2204           CONTINUE
  2205        WHEN RESP-NOTFND
  2206           GO TO 7030-ENDBR
  2207        WHEN EO-COMPANY-CD NOT = PI-COMPANY-CD
  2208           GO TO 7030-ENDBR
  2209     END-EVALUATE
  2210
  2211     PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  2212        (S2 > +26)
  2213        or EO-EOB-CODE (1:1) = PI-REASON-CODE-FLAG (S2)
  2214     END-PERFORM
  2215     if s2 <= +26  *> found one previously loaded on screen
  2216        go to 7010-non-highlight-loop
  2217     end-if
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  40
* EL614.cbl
  2218     MOVE eo-eob-code            TO WS-TABLE-CODE
  2219     MOVE WS-TAB-CODE-1          TO WS-SCR-CODE-4
  2220     MOVE WS-TAB-CODE-2-4        TO WS-SCR-CODE-1-3
  2221     MOVE WS-SCREEN-CODE         TO RCODEO (M1)
  2222     MOVE eo-DESCRIPTION         TO DESCO (M1)
  2223     PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  2224        E1 > +12
  2225        MOVE PI-EOB-CODE (E1)    TO WS-SCREEN-CODE
  2226        MOVE WS-SCR-CODE-1-3     TO WS-TAB-CODE-2-4
  2227        MOVE WS-SCR-CODE-4       TO WS-TAB-CODE-1
  2228        IF eo-EOB-CODE  = WS-TABLE-CODE
  2229           MOVE 'S'              TO SELI (M1)
  2230           MOVE +1               TO SELL (M1)
  2231        END-IF
  2232     END-PERFORM
  2233     if m1 = +1
  2234        move ws-eleobc-key to pi-dn-top-key
  2235     else
  2236        move ws-eleobc-key to pi-dn-bot-key
  2237     end-if
  2238     IF PI-EXPANDED-VIEW = 'Y'
  2239         IF eo-DESCRIPTION (61:60) > SPACES
  2240           AND M1 < +17
  2241             SET N1 TO M1
  2242             SET M1 UP BY +1
  2243             MOVE eo-DESCRIPTION (61:60) TO DESCO (M1)
  2244             MOVE DESCA (N1)    TO DESCA (M1)
  2245             MOVE AL-SADOF      TO SELA (M1)
  2246         END-IF
  2247         IF eo-DESCRIPTION (121:60) > SPACES
  2248           AND M1 < +17
  2249             SET N1 TO M1
  2250             SET M1 UP BY +1
  2251             MOVE eo-DESCRIPTION (121:60) TO DESCO (M1)
  2252             MOVE DESCA (N1)    TO DESCA (M1)
  2253             MOVE AL-SADOF      TO SELA (M1)
  2254         END-IF
  2255         IF eo-DESCRIPTION (181:60) > SPACES
  2256           AND M1 < +17
  2257             SET N1 TO M1
  2258             SET M1 UP BY +1
  2259             MOVE eo-DESCRIPTION (181:60) TO DESCO (M1)
  2260             MOVE DESCA (N1)    TO DESCA (M1)
  2261             MOVE AL-SADOF      TO SELA (M1)
  2262         END-IF
  2263         IF Eo-DESCRIPTION (241:35) > SPACES
  2264           AND M1 < +17
  2265             SET N1 TO M1
  2266             SET M1 UP BY +1
  2267             MOVE eo-DESCRIPTION (241:35) TO DESCO (M1)
  2268             MOVE DESCA (N1)    TO DESCA (M1)
  2269             MOVE AL-SADOF      TO SELA (M1)
  2270         END-IF
  2271     END-IF
  2272     if m1 < num-lines-per-screen
  2273        set m1 up by +1
  2274        go to 7010-NON-HIGHLIGHT-LOOP
  2275     end-if
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  41
* EL614.cbl
  2276***  filled up the screen
  2277     go to 7030-endbr
  2278     .
  2279 7020-LOOP.
  2280
  2281* EXEC CICS READNEXT
  2282*        INTO    (EOB-CODES)
  2283*        DATASET ('ELEOBC')
  2284*        RIDFLD  (WS-ELEOBC-KEY)
  2285*        RESP    (WS-RESPONSE)
  2286*    END-EXEC
  2287     MOVE LENGTH OF
  2288      EOB-CODES
  2289       TO DFHEIV12
  2290     MOVE 'ELEOBC' TO DFHEIV1
  2291     MOVE 0
  2292       TO DFHEIV11
  2293*    MOVE '&.IL                  )  N#00002162' TO DFHEIV0
  2294     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  2295     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2296     MOVE X'204E233030303032313632' TO DFHEIV0(25:11)
  2297     CALL 'kxdfhei1' USING DFHEIV0,
  2298           DFHEIV1,
  2299           EOB-CODES,
  2300           DFHEIV12,
  2301           WS-ELEOBC-KEY,
  2302           DFHEIV99,
  2303           DFHEIV11,
  2304           DFHEIV99,
  2305           DFHEIV99
  2306     MOVE EIBRESP  TO WS-RESPONSE
  2307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2308
  2309     EVALUATE TRUE
  2310        WHEN RESP-ENDFILE
  2311           GO TO 7030-ENDBR
  2312        WHEN (PI-COMPANY-CD NOT = WS-COMPANY-CD)
  2313           OR ((PI-RECORD-TYPE NOT = EO-RECORD-TYPE)
  2314               AND (PI-RECORD-TYPE NOT = SPACES))
  2315           GO TO 7030-ENDBR
  2316        WHEN RESP-NORMAL
  2317           CONTINUE
  2318        WHEN RESP-NOTFND
  2319           GO TO 7030-ENDBR
  2320        WHEN EO-COMPANY-CD NOT = PI-COMPANY-CD
  2321           GO TO 7030-ENDBR
  2322     END-EVALUATE
  2323     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2324         MOVE eo-eob-code        TO WS-TABLE-CODE
  2325         MOVE WS-TAB-CODE-1      TO WS-SCR-CODE-4
  2326         MOVE WS-TAB-CODE-2-4    TO WS-SCR-CODE-1-3
  2327         MOVE WS-SCREEN-CODE     TO RCODEO (M1)
  2328     ELSE
  2329         MOVE eo-eob-code        TO RCODEO (M1)
  2330     END-IF
  2331     MOVE eo-DESCRIPTION         TO DESCO (M1)
  2332** Highlighting done here I think
  2333     IF PI-RETURN-TO-PROGRAM = 'EL6318'
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  42
* EL614.cbl
  2334        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  2335          S2 > +26
  2336            IF RCODEO (M1)(4:1) = PI-REASON-CODE-FLAG (S2)
  2337               MOVE AL-SABON TO RCODEA (M1)
  2338               MOVE AL-SABOF TO DESCA (M1)
  2339            END-IF
  2340        END-PERFORM
  2341     END-IF
  2342     IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317'
  2343        OR 'EL6316'
  2344        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  2345           E1 > +12
  2346           IF EO-EOB-CODE = PI-EOB-CODE (E1)
  2347              MOVE 'S'           TO SELI (M1)
  2348              MOVE +1            TO SELL (M1)
  2349           END-IF
  2350        END-PERFORM
  2351     END-IF
  2352     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2353        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  2354           E1 > +12
  2355           MOVE PI-EOB-CODE (E1) TO WS-SCREEN-CODE
  2356           MOVE WS-SCR-CODE-1-3  TO WS-TAB-CODE-2-4
  2357           MOVE WS-SCR-CODE-4    TO WS-TAB-CODE-1
  2358           IF eo-EOB-CODE  = WS-TABLE-CODE
  2359              MOVE 'S'           TO SELI (M1)
  2360              MOVE +1            TO SELL (M1)
  2361           END-IF
  2362        END-PERFORM
  2363     END-IF
  2364     if m1 = +1
  2365        move ws-eleobc-key to pi-dn-top-key
  2366     else
  2367        move ws-eleobc-key to pi-dn-bot-key
  2368     end-if
  2369     IF PI-EXPANDED-VIEW = 'Y'
  2370         IF eo-DESCRIPTION (61:60) > SPACES
  2371           AND M1 < +17
  2372             SET N1 TO M1
  2373             SET M1 UP BY +1
  2374             MOVE eo-DESCRIPTION (61:60) TO DESCO (M1)
  2375             MOVE DESCA (N1)    TO DESCA (M1)
  2376             MOVE AL-SADOF      TO SELA (M1)
  2377         END-IF
  2378         IF eo-DESCRIPTION (121:60) > SPACES
  2379           AND M1 < +17
  2380             SET N1 TO M1
  2381             SET M1 UP BY +1
  2382             MOVE eo-DESCRIPTION (121:60) TO DESCO (M1)
  2383             MOVE DESCA (N1)    TO DESCA (M1)
  2384             MOVE AL-SADOF      TO SELA (M1)
  2385         END-IF
  2386         IF eo-DESCRIPTION (181:60) > SPACES
  2387           AND M1 < +17
  2388             SET N1 TO M1
  2389             SET M1 UP BY +1
  2390             MOVE eo-DESCRIPTION (181:60) TO DESCO (M1)
  2391             MOVE DESCA (N1)    TO DESCA (M1)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  43
* EL614.cbl
  2392             MOVE AL-SADOF      TO SELA (M1)
  2393         END-IF
  2394         IF Eo-DESCRIPTION (241:35) > SPACES
  2395           AND M1 < +17
  2396             SET N1 TO M1
  2397             SET M1 UP BY +1
  2398             MOVE eo-DESCRIPTION (241:35) TO DESCO (M1)
  2399             MOVE DESCA (N1)    TO DESCA (M1)
  2400             MOVE AL-SADOF      TO SELA (M1)
  2401         END-IF
  2402     END-IF
  2403     if m1 < num-lines-per-screen
  2404        set m1 up by +1
  2405        go to 7020-loop
  2406     end-if
  2407     .
  2408 7030-ENDBR.
  2409     IF PI-BROWSE-SW = +1
  2410
  2411* EXEC CICS ENDBR
  2412*          DATASET ('ELEOBC')
  2413*       END-EXEC
  2414     MOVE 'ELEOBC' TO DFHEIV1
  2415     MOVE 0
  2416       TO DFHEIV11
  2417*    MOVE '&2                    $   #00002270' TO DFHEIV0
  2418     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2419     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2420     MOVE X'2020233030303032323730' TO DFHEIV0(25:11)
  2421     CALL 'kxdfhei1' USING DFHEIV0,
  2422           DFHEIV1,
  2423           DFHEIV11,
  2424           DFHEIV99
  2425     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2426        MOVE +0                  TO PI-BROWSE-SW
  2427     END-IF
  2428     IF m1 = 0
  2429         MOVE ER-0006            TO EMI-ERROR
  2430         MOVE -1                 TO APFKL
  2431         MOVE AL-UABOF           TO APFKA
  2432         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2433         MOVE ZEROS              TO PI-TOTAL-LINES
  2434         GO TO 8100-SEND-INITIAL-MAP
  2435     END-IF.
  2436     IF m1 < num-lines-per-screen
  2437        MOVE ER-1699             TO EMI-ERROR
  2438        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2439     END-IF.
  2440     go to 8100-send-initial-map
  2441     .
  2442 7150-browse-bwd.
  2443     set m1 to num-lines-per-screen
  2444     move +1 to pi-browse-sw
  2445     move low-values to el614ao
  2446
  2447* EXEC CICS STARTBR
  2448*        DATASET   ('ELEOBC')
  2449*        RIDFLD    (WS-ELEOBC-KEY)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  44
* EL614.cbl
  2450*        GTEQ
  2451*        RESP      (WS-RESPONSE)
  2452*    END-EXEC.
  2453     MOVE 'ELEOBC' TO DFHEIV1
  2454     MOVE 0
  2455       TO DFHEIV11
  2456*    MOVE '&,         G          &  N#00002293' TO DFHEIV0
  2457     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  2458     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2459     MOVE X'204E233030303032323933' TO DFHEIV0(25:11)
  2460     CALL 'kxdfhei1' USING DFHEIV0,
  2461           DFHEIV1,
  2462           WS-ELEOBC-KEY,
  2463           DFHEIV99,
  2464           DFHEIV11,
  2465           DFHEIV99
  2466     MOVE EIBRESP  TO WS-RESPONSE
  2467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2468
  2469 7150-check-startbr.
  2470     EVALUATE TRUE
  2471        WHEN RESP-ENDFILE
  2472           GO TO 7180-ENDBR
  2473        WHEN RESP-NORMAL
  2474           CONTINUE
  2475        WHEN RESP-NOTFND
  2476           GO TO 7180-ENDBR
  2477     END-EVALUATE.
  2478*** 6318-pass is just if we came from 6318
  2479*** pass one = highligted ones, pass two = all others
  2480     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2481        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  2482          (S2 > +26)
  2483           or (ws-eob-code(1:1) = PI-REASON-CODE-FLAG (S2))
  2484        END-PERFORM
  2485        if s2 <= +26
  2486           move '1'              to pi-6318-pass
  2487        end-if
  2488     END-IF
  2489     .
  2490 7160-LOOP.
  2491
  2492* EXEC CICS READPREV
  2493*        INTO    (EOB-CODES)
  2494*        DATASET ('ELEOBC')
  2495*        RIDFLD  (WS-ELEOBC-KEY)
  2496*        RESP    (WS-RESPONSE)
  2497*    END-EXEC
  2498     MOVE LENGTH OF
  2499      EOB-CODES
  2500       TO DFHEIV12
  2501     MOVE 'ELEOBC' TO DFHEIV1
  2502     MOVE 0
  2503       TO DFHEIV11
  2504*    MOVE '&0IL                  )  N#00002321' TO DFHEIV0
  2505     MOVE X'2630494C2020202020202020' TO DFHEIV0(1:12)
  2506     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  2507     MOVE X'204E233030303032333231' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  45
* EL614.cbl
  2508     CALL 'kxdfhei1' USING DFHEIV0,
  2509           DFHEIV1,
  2510           EOB-CODES,
  2511           DFHEIV12,
  2512           WS-ELEOBC-KEY,
  2513           DFHEIV99,
  2514           DFHEIV11,
  2515           DFHEIV99,
  2516           DFHEIV99
  2517     MOVE EIBRESP  TO WS-RESPONSE
  2518     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2519     EVALUATE TRUE
  2520        WHEN RESP-ENDFILE
  2521           set true-endbr to true
  2522           GO TO 7180-ENDBR
  2523        WHEN (PI-COMPANY-CD NOT = WS-COMPANY-CD)
  2524           OR ((PI-RECORD-TYPE NOT = EO-RECORD-TYPE)
  2525               AND (PI-RECORD-TYPE NOT = SPACES))
  2526           set true-endbr to true
  2527           GO TO 7180-ENDBR
  2528        WHEN EO-COMPANY-CD NOT = PI-COMPANY-CD
  2529           set true-endbr to true
  2530           GO TO 7180-ENDBR
  2531        WHEN RESP-NORMAL
  2532           CONTINUE
  2533        WHEN RESP-NOTFND
  2534           set true-endbr to true
  2535           GO TO 7180-ENDBR
  2536     END-EVALUATE
  2537     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2538        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  2539          (S2 > +26)
  2540           or (eo-eob-code(1:1) = PI-REASON-CODE-FLAG (S2))
  2541        END-PERFORM
  2542        if s2 <= +26
  2543           if pi-6318-pass = '1'
  2544              continue
  2545           else
  2546              go to 7160-loop
  2547           end-if
  2548        else
  2549           if pi-6318-pass = '2'
  2550              continue
  2551           else
  2552              go to 7160-loop
  2553           end-if
  2554        end-if
  2555     end-if
  2556     if m1 = num-lines-per-screen
  2557        move ws-eleobc-key to pi-dn-bot-key
  2558     else
  2559        move ws-eleobc-key to pi-dn-top-key
  2560     end-if
  2561     IF PI-EXPANDED-VIEW = 'Y'
  2562        EVALUATE TRUE
  2563          WHEN EO-DESCRIPTION (241:35) > SPACES
  2564            IF M1 < +5
  2565                GO TO 7180-ENDBR
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  46
* EL614.cbl
  2566            ELSE
  2567                SET M1 DOWN BY +4
  2568            END-IF
  2569          WHEN EO-DESCRIPTION (181:60) > SPACES
  2570            IF M1 < +4
  2571                GO TO 7180-ENDBR
  2572            ELSE
  2573                SET M1 DOWN BY +3
  2574            END-IF
  2575          WHEN EO-DESCRIPTION (121:60) > SPACES
  2576            IF M1 < +3
  2577                GO TO 7180-ENDBR
  2578            ELSE
  2579                SET M1 DOWN BY +2
  2580            END-IF
  2581          WHEN EO-DESCRIPTION (61:60) > SPACES
  2582            IF M1 < +2
  2583                GO TO 7180-ENDBR
  2584            ELSE
  2585                SET M1 DOWN BY +1
  2586            END-IF
  2587        END-EVALUATE
  2588     END-IF
  2589     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2590         MOVE eo-eob-code        TO WS-TABLE-CODE
  2591         MOVE WS-TAB-CODE-1      TO WS-SCR-CODE-4
  2592         MOVE WS-TAB-CODE-2-4    TO WS-SCR-CODE-1-3
  2593         MOVE WS-SCREEN-CODE     TO RCODEO (M1)
  2594     ELSE
  2595         MOVE eo-eob-code        TO RCODEO (M1)
  2596     END-IF
  2597     MOVE eo-DESCRIPTION         TO DESCO (M1)
  2598     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2599        PERFORM VARYING S2 FROM +1 BY +1 UNTIL
  2600          S2 > +26
  2601            IF RCODEO (M1)(4:1) = PI-REASON-CODE-FLAG (S2)
  2602               MOVE AL-SABON TO RCODEA (M1)
  2603               MOVE AL-SABOF TO DESCA (M1)
  2604            END-IF
  2605        END-PERFORM
  2606     END-IF
  2607     IF PI-RETURN-TO-PROGRAM = 'EL156' OR 'EL6317'
  2608        OR 'EL6316'
  2609        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  2610           E1 > +12
  2611           IF eo-EOB-CODE = PI-EOB-CODE (E1)
  2612              MOVE 'S'           TO SELI (M1)
  2613              MOVE +1            TO SELL (M1)
  2614           END-IF
  2615        END-PERFORM
  2616     END-IF
  2617     IF PI-RETURN-TO-PROGRAM = 'EL6318'
  2618        PERFORM VARYING E1 FROM +1 BY +1 UNTIL
  2619           E1 > +12
  2620           MOVE PI-EOB-CODE (E1) TO WS-SCREEN-CODE
  2621           MOVE WS-SCR-CODE-1-3  TO WS-TAB-CODE-2-4
  2622           MOVE WS-SCR-CODE-4    TO WS-TAB-CODE-1
  2623           IF eo-EOB-CODE = WS-TABLE-CODE
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  47
* EL614.cbl
  2624              MOVE 'S'           TO SELI (M1)
  2625              MOVE +1            TO SELL (M1)
  2626           END-IF
  2627        END-PERFORM
  2628     END-IF
  2629     SET M2 TO M1
  2630     IF PI-EXPANDED-VIEW = 'Y'
  2631        IF EO-DESCRIPTION (61:60) > SPACES
  2632           SET N1 TO M1
  2633           SET M1 UP BY +1
  2634           MOVE EO-DESCRIPTION (61:60) TO DESCO(M1)
  2635           MOVE DESCA (N1)       TO DESCA (M1)
  2636           MOVE AL-SADOF         TO SELA (M1)
  2637        END-IF
  2638        IF EO-DESCRIPTION (121:60) > SPACES
  2639           SET N1 TO M1
  2640           SET M1 UP BY +1
  2641           MOVE EO-DESCRIPTION (121:60) TO DESCO(M1)
  2642           MOVE DESCA (N1)       TO DESCA (M1)
  2643           MOVE AL-SADOF         TO SELA (M1)
  2644        END-IF
  2645        IF EO-DESCRIPTION (181:60) > SPACES
  2646           SET N1 TO M1
  2647           SET M1 UP BY +1
  2648           MOVE EO-DESCRIPTION (181:60) TO DESCO(M1)
  2649           MOVE DESCA (N1)       TO DESCA (M1)
  2650           MOVE AL-SADOF         TO SELA (M1)
  2651        END-IF
  2652        IF EO-DESCRIPTION (241:35) > SPACES
  2653           SET N1 TO M1
  2654           SET M1 UP BY +1
  2655           MOVE EO-DESCRIPTION (241:35) TO DESCO(M1)
  2656           MOVE DESCA (N1)       TO DESCA (M1)
  2657           MOVE AL-SADOF         TO SELA (M1)
  2658        END-IF
  2659     END-IF
  2660     SET M1 TO M2
  2661     if m1 > +1
  2662        set m1 down by +1
  2663        go to 7160-loop
  2664     end-if
  2665     .
  2666 7180-ENDBR.
  2667     if pi-return-to-program = 'EL6318'
  2668        if pi-6318-pass = '2'
  2669           and true-endbr
  2670           if m1 > +1
  2671              move '1' to pi-6318-pass
  2672
  2673* EXEC CICS ENDBR
  2674*                DATASET ('ELEOBC')
  2675*             END-EXEC
  2676     MOVE 'ELEOBC' TO DFHEIV1
  2677     MOVE 0
  2678       TO DFHEIV11
  2679*    MOVE '&2                    $   #00002480' TO DFHEIV0
  2680     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2681     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  48
* EL614.cbl
  2682     MOVE X'2020233030303032343830' TO DFHEIV0(25:11)
  2683     CALL 'kxdfhei1' USING DFHEIV0,
  2684           DFHEIV1,
  2685           DFHEIV11,
  2686           DFHEIV99
  2687     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2688              MOVE +0            TO PI-BROWSE-SW
  2689              move '4' to ws-eob-rec-type
  2690              move spaces to ws-eob-code
  2691
  2692* EXEC CICS STARTBR
  2693*                 DATASET   ('ELEOBC')
  2694*                 RIDFLD    (WS-ELEOBC-KEY)
  2695*                 LTEQ
  2696*                 RESP      (WS-RESPONSE)
  2697*             END-EXEC
  2698     MOVE 'ELEOBC' TO DFHEIV1
  2699     MOVE 0
  2700       TO DFHEIV11
  2701*    MOVE '&,         L          &  N#00002486' TO DFHEIV0
  2702     MOVE X'262C2020202020202020204C' TO DFHEIV0(1:12)
  2703     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  2704     MOVE X'204E233030303032343836' TO DFHEIV0(25:11)
  2705     CALL 'kxdfhei1' USING DFHEIV0,
  2706           DFHEIV1,
  2707           WS-ELEOBC-KEY,
  2708           DFHEIV99,
  2709           DFHEIV11,
  2710           DFHEIV99
  2711     MOVE EIBRESP  TO WS-RESPONSE
  2712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2713              move ' ' to ws-endbr-sw
  2714              go to 7150-check-startbr
  2715           end-if
  2716        end-if
  2717     end-if
  2718     IF PI-BROWSE-SW = +1
  2719
  2720* EXEC CICS ENDBR
  2721*          DATASET ('ELEOBC')
  2722*       END-EXEC
  2723     MOVE 'ELEOBC' TO DFHEIV1
  2724     MOVE 0
  2725       TO DFHEIV11
  2726*    MOVE '&2                    $   #00002498' TO DFHEIV0
  2727     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  2728     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  2729     MOVE X'2020233030303032343938' TO DFHEIV0(25:11)
  2730     CALL 'kxdfhei1' USING DFHEIV0,
  2731           DFHEIV1,
  2732           DFHEIV11,
  2733           DFHEIV99
  2734     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  2735        MOVE +0                  TO PI-BROWSE-SW
  2736     END-IF
  2737     IF m1 = 0
  2738         MOVE ER-0006            TO EMI-ERROR
  2739         MOVE -1                 TO APFKL
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  49
* EL614.cbl
  2740         MOVE AL-UABOF           TO APFKA
  2741         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2742         MOVE ZEROS              TO PI-TOTAL-LINES
  2743         GO TO 8100-SEND-INITIAL-MAP
  2744     END-IF.
  2745     if true-endbr
  2746        and pi-6318-pass not = '2'
  2747        MOVE ER-1698             TO EMI-ERROR
  2748        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2749     end-if
  2750     IF m1 > +1
  2751        move pi-dn-top-key to ws-eleobc-key
  2752        go to 7000-browse-fwd
  2753     END-IF
  2754     go to 8100-send-initial-map
  2755     .
  2756 7250-DELETE-TEMP-STOR.
  2757
  2758* EXEC CICS HANDLE CONDITION
  2759*         QIDERR(7299-EXIT)
  2760*    END-EXEC.
  2761*    MOVE '"$N                   ! # #00002523' TO DFHEIV0
  2762     MOVE X'22244E202020202020202020' TO DFHEIV0(1:12)
  2763     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2764     MOVE X'2320233030303032353233' TO DFHEIV0(25:11)
  2765     CALL 'kxdfhei1' USING DFHEIV0
  2766     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2767
  2768
  2769* EXEC CICS DELETEQ TS
  2770*         QUEUE(QID)
  2771*    END-EXEC.
  2772*    MOVE '*&                    #   #00002526' TO DFHEIV0
  2773     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  2774     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  2775     MOVE X'2020233030303032353236' TO DFHEIV0(25:11)
  2776     CALL 'kxdfhei1' USING DFHEIV0,
  2777           QID,
  2778           DFHEIV99
  2779     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2780
  2781 7299-EXIT.
  2782     EXIT.
  2783
  2784 7500-READ-TS.
  2785
  2786* EXEC CICS HANDLE CONDITION
  2787*         QIDERR(7590-TS-QIDERR)
  2788*         ITEMERR(7585-QID-ITEMERR)
  2789*    END-EXEC.
  2790*    MOVE '"$N<                  ! $ #00002533' TO DFHEIV0
  2791     MOVE X'22244E3C2020202020202020' TO DFHEIV0(1:12)
  2792     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  2793     MOVE X'2420233030303032353333' TO DFHEIV0(25:11)
  2794     CALL 'kxdfhei1' USING DFHEIV0
  2795     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2796
  2797     MOVE 1                      TO QID-ITEM.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  50
* EL614.cbl
  2798 7501-LOOP.
  2799
  2800* EXEC CICS READQ TS
  2801*         INTO(TS-WORK-AREA)
  2802*         QUEUE(QID)
  2803*         LENGTH(TS-LENGTH)
  2804*         ITEM(QID-ITEM)
  2805*    END-EXEC.
  2806*    MOVE '*$II   L              ''   #00002539' TO DFHEIV0
  2807     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  2808     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2809     MOVE X'2020233030303032353339' TO DFHEIV0(25:11)
  2810     CALL 'kxdfhei1' USING DFHEIV0,
  2811           QID,
  2812           TS-WORK-AREA,
  2813           TS-LENGTH,
  2814           QID-ITEM,
  2815           DFHEIV99,
  2816           DFHEIV99
  2817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2818
  2819     ADD 1 TO QID-ITEM.
  2820     GO TO 7501-LOOP.
  2821
  2822 7585-QID-ITEMERR.
  2823     IF EIBTRNID NOT = WS-TRANS-ID
  2824        SUBTRACT 1 FROM QID-ITEM
  2825        MOVE QID-ITEM            TO PI-TEMP-STOR-ITEMS
  2826     END-IF.
  2827     GO TO 7599-EXIT.
  2828
  2829 7590-TS-QIDERR.
  2830     IF EIBTRNID = WS-TRANS-ID
  2831        AND EIBAID = DFHCLEAR
  2832           GO TO 9100-RETURN-TRAN
  2833     END-IF.
  2834     IF EIBTRNID = WS-TRANS-ID
  2835        MOVE ER-0033             TO EMI-ERROR
  2836        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  2837        GO TO 8100-SEND-INITIAL-MAP
  2838     END-IF.
  2839
  2840 7599-EXIT.
  2841      EXIT.
  2842*****************************************************************
  2843 8100-SEND-INITIAL-MAP.
  2844*****************************************************************
  2845     MOVE -1                     TO  APFKL.
  2846     MOVE ZERO                   TO  PI-BROWSE-SW.
  2847     MOVE SAVE-DATE              TO  ADATEO.
  2848     MOVE EIBTIME                TO  TIME-IN.
  2849     MOVE TIME-OUT               TO  ATIMEO.
  2850     IF EMI-ERROR NOT = ZERO
  2851         PERFORM 9900-ERROR-FORMAT
  2852     END-IF
  2853     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSGO
  2854     IF PI-RETURN-TO-PROGRAM NOT = 'EL156' AND 'EL6317' AND
  2855           'EL6318' AND 'EL6316'
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  51
* EL614.cbl
  2856        MOVE AL-SADOF            TO SELHA
  2857                                    F3KEYA
  2858        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  2859           S1 > +17
  2860           MOVE AL-SADOF         TO SELA (S1)
  2861        END-PERFORM
  2862     END-IF
  2863
  2864     IF PI-EXPANDED-VIEW = 'Y'
  2865         MOVE 'PF5=UNEXPAND DESCRIPTIONS' TO F5KEYO
  2866     ELSE
  2867         MOVE 'PF5=EXPAND DESCRIPTIONS  ' TO F5KEYO
  2868     END-IF
  2869
  2870* EXEC CICS SEND
  2871*        FROM   (EL614AO)
  2872*        MAPSET (WS-MAPSET-NAME)
  2873*        MAP    (WS-MAP-NAME)
  2874*        CURSOR ERASE
  2875*    END-EXEC.
  2876     MOVE LENGTH OF
  2877      EL614AO
  2878       TO DFHEIV12
  2879     MOVE -1
  2880       TO DFHEIV11
  2881*    MOVE '8$     CT  E    H L F ,   #00002595' TO DFHEIV0
  2882     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  2883     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2884     MOVE X'2020233030303032353935' TO DFHEIV0(25:11)
  2885     CALL 'kxdfhei1' USING DFHEIV0,
  2886           WS-MAP-NAME,
  2887           EL614AO,
  2888           DFHEIV12,
  2889           WS-MAPSET-NAME,
  2890           DFHEIV99,
  2891           DFHEIV99,
  2892           DFHEIV99,
  2893           DFHEIV11,
  2894           DFHEIV99,
  2895           DFHEIV99,
  2896           DFHEIV99
  2897     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2898
  2899     GO TO 9100-RETURN-TRAN
  2900     .
  2901 8100-EXIT.
  2902      EXIT.
  2903*****************************************************************
  2904 8200-SEND-DATAONLY.
  2905*****************************************************************
  2906     MOVE SAVE-DATE              TO  ADATEO.
  2907     MOVE EIBTIME                TO  TIME-IN.
  2908     MOVE TIME-OUT               TO  ATIMEO.
  2909     IF EMI-ERROR NOT = ZERO
  2910         PERFORM 9900-ERROR-FORMAT.
  2911     MOVE EMI-MESSAGE-AREA (1)    TO  AEMSGO.
  2912     IF PI-RETURN-TO-PROGRAM NOT = 'EL156' AND 'EL6317' AND
  2913           'EL6318' AND 'EL6316'
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  52
* EL614.cbl
  2914        MOVE AL-SADOF            TO SELHA
  2915                                    F3KEYA
  2916        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  2917           S1 > +17
  2918           MOVE AL-SADOF         TO SELA (S1)
  2919        END-PERFORM
  2920     END-IF
  2921
  2922* EXEC CICS SEND DATAONLY
  2923*        FROM   (EL614AO)
  2924*        MAPSET (WS-MAPSET-NAME)
  2925*        MAP    (WS-MAP-NAME)
  2926*        CURSOR
  2927*    END-EXEC.
  2928     MOVE LENGTH OF
  2929      EL614AO
  2930       TO DFHEIV12
  2931     MOVE -1
  2932       TO DFHEIV11
  2933*    MOVE '8$D    CT       H L F ,   #00002623' TO DFHEIV0
  2934     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  2935     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  2936     MOVE X'2020233030303032363233' TO DFHEIV0(25:11)
  2937     CALL 'kxdfhei1' USING DFHEIV0,
  2938           WS-MAP-NAME,
  2939           EL614AO,
  2940           DFHEIV12,
  2941           WS-MAPSET-NAME,
  2942           DFHEIV99,
  2943           DFHEIV99,
  2944           DFHEIV99,
  2945           DFHEIV11,
  2946           DFHEIV99,
  2947           DFHEIV99,
  2948           DFHEIV99
  2949     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2950
  2951     GO TO 9100-RETURN-TRAN
  2952     .
  2953 8200-EXIT.
  2954      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  53
* EL614.cbl
  2956*****************************************************************
  2957 8300-SEND-TEXT.
  2958*****************************************************************
  2959
  2960* EXEC CICS SEND TEXT
  2961*        FROM   (LOGOFF-TEXT)
  2962*        LENGTH (LOGOFF-LENGTH)
  2963*        ERASE  FREEKB
  2964*    END-EXEC.
  2965*    MOVE '8&      T  E F  H   F -   #00002637' TO DFHEIV0
  2966     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  2967     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  2968     MOVE X'2020233030303032363337' TO DFHEIV0(25:11)
  2969     CALL 'kxdfhei1' USING DFHEIV0,
  2970           LOGOFF-TEXT,
  2971           LOGOFF-LENGTH,
  2972           DFHEIV99,
  2973           DFHEIV99,
  2974           DFHEIV99,
  2975           DFHEIV99,
  2976           DFHEIV99,
  2977           DFHEIV99,
  2978           DFHEIV99,
  2979           DFHEIV99,
  2980           DFHEIV99,
  2981           DFHEIV99
  2982     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2983
  2984
  2985* EXEC CICS RETURN
  2986*    END-EXEC.
  2987*    MOVE '.(                    ''   #00002642' TO DFHEIV0
  2988     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  2989     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  2990     MOVE X'2020233030303032363432' TO DFHEIV0(25:11)
  2991     CALL 'kxdfhei1' USING DFHEIV0,
  2992           DFHEIV99,
  2993           DFHEIV99,
  2994           DFHEIV99,
  2995           DFHEIV99,
  2996           DFHEIV99,
  2997           DFHEIV99
  2998     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  2999
  3000 8300-EXIT.
  3001      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  54
* EL614.cbl
  3003*****************************************************************
  3004 8400-LOG-JOURNAL-RECORD.
  3005*****************************************************************
  3006     IF PI-JOURNAL-FILE-ID = 0
  3007         GO TO 8400-EXIT.
  3008     MOVE PI-PROCESSOR-ID        TO  JP-USER-ID.
  3009     MOVE 'ELCNTL'               TO  JP-FILE-ID.
  3010     MOVE THIS-PGM               TO  JP-PROGRAM-ID.
  3011*    EXEC CICS JOURNAL
  3012*        JFILEID (PI-JOURNAL-FILE-ID)
  3013*        JTYPEID (WS-JOURNAL-TYPE-ID)
  3014*        FROM    (JOURNAL-RECORD)
  3015*        LENGTH  (WS-JOURNAL-RECORD-LENGTH)
  3016*    END-EXEC.
  3017 8400-EXIT.
  3018      EXIT.
  3019*****************************************************************
  3020 8500-DATE-CONVERSION.
  3021*****************************************************************
  3022
  3023* EXEC CICS LINK
  3024*        PROGRAM  ('ELDATCV')
  3025*        COMMAREA (DATE-CONVERSION-DATA)
  3026*        LENGTH   (DC-COMM-LENGTH)
  3027*    END-EXEC.
  3028     MOVE 'ELDATCV' TO DFHEIV1
  3029*    MOVE '."C                   (   #00002666' TO DFHEIV0
  3030     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3031     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3032     MOVE X'2020233030303032363636' TO DFHEIV0(25:11)
  3033     CALL 'kxdfhei1' USING DFHEIV0,
  3034           DFHEIV1,
  3035           DATE-CONVERSION-DATA,
  3036           DC-COMM-LENGTH,
  3037           DFHEIV99,
  3038           DFHEIV99,
  3039           DFHEIV99,
  3040           DFHEIV99
  3041     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3042
  3043 8500-EXIT.
  3044      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  55
* EL614.cbl
  3046*****************************************************************
  3047 9000-RETURN-CICS.
  3048*****************************************************************
  3049     MOVE 'EL005'                TO  THIS-PGM.
  3050     MOVE EIBAID                 TO  PI-ENTRY-CD-1.
  3051     PERFORM 9300-XCTL.
  3052 9000-EXIT.
  3053      EXIT.
  3054*****************************************************************
  3055 9100-RETURN-TRAN.
  3056*****************************************************************
  3057     MOVE EMI-ERROR-NUMBER (1)   TO  PI-LAST-ERROR-NO.
  3058     MOVE WS-MAP-NUMBER          TO  PI-CURRENT-SCREEN-NO.
  3059
  3060* EXEC CICS RETURN
  3061*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3062*        LENGTH   (PI-COMM-LENGTH)
  3063*        TRANSID  (WS-TRANS-ID)
  3064*    END-EXEC.
  3065*    MOVE '.(CT                  ''   #00002687' TO DFHEIV0
  3066     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  3067     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  3068     MOVE X'2020233030303032363837' TO DFHEIV0(25:11)
  3069     CALL 'kxdfhei1' USING DFHEIV0,
  3070           WS-TRANS-ID,
  3071           PROGRAM-INTERFACE-BLOCK,
  3072           PI-COMM-LENGTH,
  3073           DFHEIV99,
  3074           DFHEIV99,
  3075           DFHEIV99
  3076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3077
  3078 9100-EXIT.
  3079      EXIT.
  3080*****************************************************************
  3081 9300-XCTL.
  3082*****************************************************************
  3083     MOVE DFHENTER               TO  EIBAID.
  3084
  3085* EXEC CICS XCTL
  3086*        PROGRAM  (THIS-PGM)
  3087*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  3088*        LENGTH   (PI-COMM-LENGTH)
  3089*    END-EXEC.
  3090*    MOVE '.$C                   %   #00002698' TO DFHEIV0
  3091     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  3092     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  3093     MOVE X'2020233030303032363938' TO DFHEIV0(25:11)
  3094     CALL 'kxdfhei1' USING DFHEIV0,
  3095           THIS-PGM,
  3096           PROGRAM-INTERFACE-BLOCK,
  3097           PI-COMM-LENGTH,
  3098           DFHEIV99
  3099     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3100
  3101 9300-EXIT.
  3102      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  56
* EL614.cbl
  3104*****************************************************************
  3105 9400-CLEAR.
  3106*****************************************************************
  3107     MOVE PI-RETURN-TO-PROGRAM  TO  THIS-PGM.
  3108     PERFORM 9300-XCTL.
  3109 9400-EXIT.
  3110      EXIT.
  3111*****************************************************************
  3112 9600-PGMIDERR.
  3113*****************************************************************
  3114
  3115* EXEC CICS HANDLE CONDITION
  3116*        PGMIDERR (8300-SEND-TEXT)
  3117*    END-EXEC.
  3118*    MOVE '"$L                   ! % #00002716' TO DFHEIV0
  3119     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  3120     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  3121     MOVE X'2520233030303032373136' TO DFHEIV0(25:11)
  3122     CALL 'kxdfhei1' USING DFHEIV0
  3123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3124
  3125     MOVE THIS-PGM               TO  PI-CALLING-PROGRAM
  3126                                     LOGOFF-PGM.
  3127     MOVE 'EL005'                TO  THIS-PGM.
  3128     MOVE PGMIDERR-MSG           TO  LOGOFF-FILL.
  3129     MOVE SPACES                 TO  PI-ENTRY-CD-1.
  3130     PERFORM 9300-XCTL.
  3131 9600-EXIT.
  3132      EXIT.
  3133*****************************************************************
  3134 9900-ERROR-FORMAT.
  3135*****************************************************************
  3136     IF EMI-ERRORS-COMPLETE
  3137         ADD +1             TO  EMI-FATAL-CTR
  3138         MOVE ZERO          TO  EMI-ERROR
  3139         GO TO 9900-EXIT.
  3140
  3141* EXEC CICS LINK
  3142*        PROGRAM  ('EL001')
  3143*        COMMAREA (ERROR-MESSAGE-INTERFACE-BLOCK)
  3144*        LENGTH   (EMI-COMM-LENGTH)
  3145*    END-EXEC.
  3146     MOVE 'EL001' TO DFHEIV1
  3147*    MOVE '."C                   (   #00002734' TO DFHEIV0
  3148     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3149     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3150     MOVE X'2020233030303032373334' TO DFHEIV0(25:11)
  3151     CALL 'kxdfhei1' USING DFHEIV0,
  3152           DFHEIV1,
  3153           ERROR-MESSAGE-INTERFACE-BLOCK,
  3154           EMI-COMM-LENGTH,
  3155           DFHEIV99,
  3156           DFHEIV99,
  3157           DFHEIV99,
  3158           DFHEIV99
  3159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3160
  3161     MOVE ZERO              TO  EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  57
* EL614.cbl
  3162 9900-EXIT.
  3163      EXIT.
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  58
* EL614.cbl
  3165*****************************************************************
  3166 9990-ERROR.
  3167*****************************************************************
  3168     MOVE DFHEIBLK               TO EMI-LINE1.
  3169
  3170* EXEC CICS LINK
  3171*        PROGRAM   ('EL004')
  3172*        COMMAREA  (EMI-LINE1)
  3173*        LENGTH    (72)
  3174*    END-EXEC.
  3175     MOVE 'EL004' TO DFHEIV1
  3176     MOVE 72
  3177       TO DFHEIV11
  3178*    MOVE '."C                   (   #00002747' TO DFHEIV0
  3179     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3180     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3181     MOVE X'2020233030303032373437' TO DFHEIV0(25:11)
  3182     CALL 'kxdfhei1' USING DFHEIV0,
  3183           DFHEIV1,
  3184           EMI-LINE1,
  3185           DFHEIV11,
  3186           DFHEIV99,
  3187           DFHEIV99,
  3188           DFHEIV99,
  3189           DFHEIV99
  3190     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3191
  3192     PERFORM 8200-SEND-DATAONLY.
  3193     GO TO 9100-RETURN-TRAN.
  3194 9990-EXIT.
  3195      EXIT.
  3196*****************************************************************
  3197 9995-SECURITY-VIOLATION.
  3198*****************************************************************
  3199*           COPY ELCSCTP.
  3200******************************************************************
  3201*                                                                *
  3202*                            ELCSCTP                             *
  3203*                            VMOD=2.001                          *
  3204*                                                                *
  3205*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  3206******************************************************************
  3207
  3208
  3209     MOVE EIBDATE          TO SM-JUL-DATE.
  3210     MOVE EIBTRMID         TO SM-TERMID.
  3211     MOVE THIS-PGM         TO SM-PGM.
  3212     MOVE EIBTIME          TO TIME-IN.
  3213     MOVE TIME-OUT         TO SM-TIME.
  3214     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  3215
  3216
  3217* EXEC CICS LINK
  3218*         PROGRAM  ('EL003')
  3219*         COMMAREA (SECURITY-MESSAGE)
  3220*         LENGTH   (80)
  3221*    END-EXEC.
  3222     MOVE 'EL003' TO DFHEIV1
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  59
* EL614.cbl
  3223     MOVE 80
  3224       TO DFHEIV11
  3225*    MOVE '."C                   (   #00002776' TO DFHEIV0
  3226     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  3227     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  3228     MOVE X'2020233030303032373736' TO DFHEIV0(25:11)
  3229     CALL 'kxdfhei1' USING DFHEIV0,
  3230           DFHEIV1,
  3231           SECURITY-MESSAGE,
  3232           DFHEIV11,
  3233           DFHEIV99,
  3234           DFHEIV99,
  3235           DFHEIV99,
  3236           DFHEIV99
  3237     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  3238
  3239
  3240******************************************************************
  3241
  3242 9995-EXIT.
  3243      EXIT.
  3244 9999-LAST-PARAGRAPH SECTION.
  3245
  3246* GOBACK.
  3247     MOVE '9%                    "   ' TO DFHEIV0
  3248     MOVE 'EL614' TO DFHEIV1
  3249     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3250     GOBACK.
  3251
  3252 9999-DFHBACK SECTION.
  3253     MOVE '9%                    "   ' TO DFHEIV0
  3254     MOVE 'EL614' TO DFHEIV1
  3255     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3256     GOBACK.
  3257 9999-DFHEXIT.
  3258     IF DFHEIGDJ EQUAL 0001
  3259         NEXT SENTENCE
  3260     ELSE IF DFHEIGDJ EQUAL 2
  3261         GO TO 9600-PGMIDERR,
  3262               9990-ERROR
  3263         DEPENDING ON DFHEIGDI
  3264     ELSE IF DFHEIGDJ EQUAL 3
  3265         GO TO 7299-EXIT
  3266         DEPENDING ON DFHEIGDI
  3267     ELSE IF DFHEIGDJ EQUAL 4
  3268         GO TO 7590-TS-QIDERR,
  3269               7585-QID-ITEMERR
  3270         DEPENDING ON DFHEIGDI
  3271     ELSE IF DFHEIGDJ EQUAL 5
  3272         GO TO 8300-SEND-TEXT
  3273         DEPENDING ON DFHEIGDI.
  3274     MOVE '9%                    "   ' TO DFHEIV0
  3275     MOVE 'EL614' TO DFHEIV1
  3276     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  3277     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Micro Focus Server Express         V5.1 revision 000 11-Dec-18 09:06 Page  60
* EL614.cbl
* Total Messages:     0
* Data:       10052     Code:       11373
