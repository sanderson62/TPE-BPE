* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   1
* EL6316.cbl
* Options: int("EL6316.int") anim csi verbose NOBOUND LINKCHECK
*          PARAMCOUNTCHECK directives(cobopt.bth) endp list("EL6316.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL6316.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL6316.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2 PROGRAM-ID.                 EL6316.
     3*
     4*AUTHOR.        PABLO
     5*               OMAHA, NEBRASKA
     6*DATE-COMPILED.
     7*SECURITY.   *****************************************************
     8*            *                                                   *
     9*            *   THIS PROGRAM IS THE PROPERTY OF CENTRAL STATES  *
    10*            *   HEALTH AND LIFE                                 *
    11*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    12*            *   OF CSO.        IS EXPRESSLY PROHIBITED WITHOUT  *
    13*            *   THE PRIOR WRITTEN PERMISSION OF CENTRAL STATES. *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   2
* EL6316.cbl
    14*            *                                                   *
    15*            *****************************************************
    16*-----------------------------------------------------------------
    17*                   C H A N G E   L O G
    18*
    19* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    20*-----------------------------------------------------------------
    21*  CHANGE  CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    22* EFFECTIVE    NUMBER
    23*-----------------------------------------------------------------
    24* 110410   2007070900001  PEMA  ADD REFORMATIONS AND RESCISSIONS
    25* 012412   2011022800001  AJRA  NAPERSOFT
    26* 062712   2011022800001  AJRA  REDEFINE ORIG DATA
    27* 072312   2011022800001  AJRA  NAPERSOFT MISC
    28* 091812 IR2012091400003  AJRA  CHANGE MSG 9999
    29* 101512   2011022800001  AJRA  FIX CLM RESC DEFAULT
    30* 102212   2012101700002  AJRA  SCREEN ID
    31* 103012   2012101700002  AJRA  ADD CERT NOTES TO TOP OF LIST
    32* 110612   2012101700002  AJRA  ADD NEW FIELDS
    33* 112612   2012101700002  AJRA  CHECK FOR PROMPT LETTER
    34* 121212   2012101700002  AJRA  ADD BILLING NOTE ENTRY
    35* 121712   2012101700002  AJRA  ADD DEFAULT AGE FLAG
    36* 011413 IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
    37* 121713   2013090300001  AJRA  ADD ENCLOSURE CODE TO SCREEN
    38* 122313   2013090300001  AJRA  DO ENDORSEMENT FROM CERT SCREEN
    39* 041320 CR2020030500002  PEMA  Issue, cancel billing notes
    40*-----------------------------------------------------------------
    41*REMARKS.
    42*        TRANSACTION - EXBC - CANCEL CHANGES
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   3
* EL6316.cbl
    44 ENVIRONMENT DIVISION.
    45 DATA DIVISION.
    46 WORKING-STORAGE SECTION.
    47 01  DFH-START PIC X(04).
    48 77  FILLER  PIC X(32)  VALUE '********************************'.
    49 77  FILLER  PIC X(32)  VALUE '*    EL6316 WORKING STORAGE    *'.
    50 77  FILLER  PIC X(32)  VALUE '******** VMOD=2.001 ************'.
    51 77  NOTE-SUB PIC S9(5) COMP-3 VALUE +0.
    52 77  WS-SEQ-NO                   PIC 9(4) BINARY.
    53 77  W-ARCH-NUMBER               PIC 9(8) BINARY  VALUE ZEROS.
    54 77  w-prtsw                     pic x  value spaces.
    55 77  WS-SET-CODES-MDT            PIC X  VALUE SPACES.
    56 77  WS-ERACCT-SW                PIC X  VALUE ' '.
    57     88  ACCT-FOUND                 VALUE 'Y'.
    58 77  WS-CHGBACK                  PIC 99  VALUE ZEROS.
    59 77  WS-CSO-PORTION              PIC S9(5)V99 COMP-3 VALUE +0.
    60 77  WS-ACCT-PORTION             PIC S9(5)V99 COMP-3 VALUE +0.
    61 77  WS-DIFF                     PIC 99 VALUE ZEROS.
    62 77  WS-SAVE-ERACCT-KEY          PIC X(20)  VALUE SPACES.
    63 77  WS-DUE-BORROWER             PIC S9(7)V99 COMP-3 VALUE +0.
    64 77  s1                          pic s999 comp-3 value +0.
    65 77  s2                          pic s999 comp-3 value +0.
    66 77  WS-REASON-SW                PIC X  VALUE ' '.
    67     88  REASONS-FOUND                  VALUE 'Y'.
    68     88  REASONS-NOT-FOUND              VALUE 'N'.
    69 77  WS-CERT-UPDATE-SW           PIC X  VALUE ' '.
    70     88  NO-CERT-RW                 VALUE 'N'.
    71     88  CERT-RW                    VALUE 'Y'.
    72 77  WS-COMM-LENGTH              PIC 9(4) BINARY.
    73 01  P pointer.
    74 01  KIXSYS                      pic X(7)  VALUE Z"KIXSYS".
    75 01  KIXHOST             pic x(9) value Z"HOSTNAME".
    76 01  var-ptr pointer.
    77 01  env-var-len                 pic 9(4)  binary.
    78 01  rc                          pic 9(9)  binary.
    79 01  WS-KIXHOST                  PIC X(10).
    80 01  WS-KIXSYS.
    81     05  WS-KIX-FIL1             PIC X(10).
    82     05  WS-KIX-APPS             PIC X(10).
    83     05  WS-KIX-ENV              PIC X(10).
    84     05  WS-KIX-MYENV            PIC X(10).
    85     05  WS-KIX-SYS              PIC X(10).
    86*    COPY ELCSCTM.
    87******************************************************************
    88*                                                                *
    89*                                                                *
    90*                            ELCSCTM                             *
    91*                            VMOD=2.001                          *
    92*                                                                *
    93*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
    94*                                                                *
    95******************************************************************
    96 01  SECURITY-MESSAGE.
    97     12  FILLER                          PIC X(30)
    98            VALUE '** LOGIC SECURITY VIOLATION -'.
    99     12  SM-READ                         PIC X(6).
   100     12  FILLER                          PIC X(5)
   101            VALUE ' PGM='.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   4
* EL6316.cbl
   102     12  SM-PGM                          PIC X(6).
   103     12  FILLER                          PIC X(5)
   104            VALUE ' OPR='.
   105     12  SM-PROCESSOR-ID                 PIC X(4).
   106     12  FILLER                          PIC X(6)
   107            VALUE ' TERM='.
   108     12  SM-TERMID                       PIC X(4).
   109     12  FILLER                          PIC XX   VALUE SPACE.
   110     12  SM-JUL-DATE                     PIC 9(5).
   111     12  FILLER                          PIC X    VALUE SPACE.
   112     12  SM-TIME                         PIC 99.99.
   113
   114*    COPY ELCSCRTY.
   115******************************************************************
   116*                                                                *
   117*                                                                *
   118*                            ELCSCRTY                            *
   119*                            VMOD=2.001                          *
   120*                                                                *
   121*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
   122*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
   123*        SAVED IN PI-SECURITY-ADDRESS.                           *
   124*                                                                *
   125******************************************************************
   126 01  SECURITY-CONTROL.
   127     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
   128     12  FILLER                       PIC XX    VALUE 'SC'.
   129     12  SC-CREDIT-CODES.
   130         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
   131             20  SC-CREDIT-DISPLAY    PIC X.
   132             20  SC-CREDIT-UPDATE     PIC X.
   133     12  SC-CLAIMS-CODES.
   134         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
   135             20  SC-CLAIMS-DISPLAY    PIC X.
   136             20  SC-CLAIMS-UPDATE     PIC X.
   137 01 srch-commarea.
   138*                                copy ELCADLTRSPI.
   139******************************************************************
   140*                   C H A N G E   L O G
   141*
   142* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   143*-----------------------------------------------------------------
   144*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   145* EFFECTIVE    NUMBER
   146*-----------------------------------------------------------------
   147* 060611    2011022800001  PEMA  NEW COPYBOOK
   148* 101812    2012101700002  AJRA  ADD ENDT ARCHIVE NO, SCREENID
   149* 110612    2012101700002  AJRA  EXPAND PASSED DATA
   150******************************************************************
   151****************************************
   152*  commarea for NaperSoft On Demand Admin services letters
   153*  (business logic input & output)
   154****************************************
   155     03  BL-INPUT.
   156         05  BL-DATA-SRCE        PIC X.
   157         05  BL-LETTER-ID        PIC XXXX.
   158         05  BL-CARRIER          PIC X.
   159         05  BL-GROUP            PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   5
* EL6316.cbl
   160         05  BL-STATE            PIC XX.
   161         05  BL-ACCOUNT          PIC X(10).
   162         05  BL-EFF-DT           PIC X(10).
   163         05  BL-CERT-NO          PIC X(11).
   164         05  BL-BATCH-NO         PIC X(6).
   165         05  BL-BATCH-SEQ        PIC 9(8).
   166         05  BL-RESP-NO          PIC X(10).
   167         05  BL-NO-OF-COPIES     PIC 99.
   168         05  BL-PROC-ID          PIC XXXX.
   169         05  BL-COMP-ID          PIC XXX.
   170         05  BL-PRINT-NOW-SW     PIC X.
   171         05  BL-ENC-CD           PIC XXX.
   172         05  BL-RESEND-DT        PIC X(10).
   173         05  BL-FOLLOW-UP-DT     PIC X(10).
   174         05  BL-ARCHIVE-NO       PIC 9(8).
   175         05  BL-FUNC             PIC X(8).
   176         05  BL-COMMENTS         PIC X(100).
   177         05  FILLER REDEFINES BL-COMMENTS.
   178             10  BL-REASON-CODE OCCURS 12 PIC X(4).
   179             10  BL-LETTER-TO-ACCT PIC X.
   180             10  BL-LETTER-TO-BENE PIC X.
   181             10  BL-WRITE-ERARCH   PIC X.
   182                 88  ERARCH-QWS      VALUE 'Q'.
   183                 88  ERARCH-BATCH    VALUE 'B'.
   184                 88  ERARCH-TEMP     VALUE 'T'.
   185             10  BL-PROCESS-TYPE PIC X(07).
   186             10  BL-CERT-FORM-ID PIC X(05).
   187             10  BL-ENDT-ARCH-NO PIC 9(08) BINARY.
   188             10  BL-SOURCE-SCREEN PIC X(8).
   189             10  FILLER          PIC X(25).
   190     03  BL-OUTPUT.
   191         05  BL-STATUS                   PIC X.
   192             88  BL-OK                      VALUE "P".
   193             88  BL-FAIL                  VALUE "F".
   194         05  BL-MESSAGE          PIC X(50).
   195     03  BL-RECORD-PASSED-DATA   PIC X(6200).
   196     03  FILLER                  PIC X(31).
   197
   198*** Z CONTROL LAYOUT MOVED TO COPYBOOK ELCZREC
   199*                                COPY ELCZREC.
   200******************************************************************
   201*                                                                *
   202*                                                                *
   203*                            ELCZREC.                            *
   204*                                                                *
   205*   FILE DESCRIPTION = Z CONTROL RECORD LAYOUT                   *
   206*                                                                *
   207******************************************************************
   208*-----------------------------------------------------------------
   209*                   C H A N G E   L O G
   210*
   211* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
   212*-----------------------------------------------------------------
   213*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
   214* EFFECTIVE    NUMBER
   215*-----------------------------------------------------------------
   216* 122011    2011022800001  AJRA  NEW FILE
   217* 073112    2011022800001  AJRA  ADD ACCT SUMM, CSO SUMM
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   6
* EL6316.cbl
   218* 122712    2012101700002  AJRA  ADD REASON CODE REQUIRED FLAG
   219* 072313    2013062000003  AJRA  ADD IND FOR INSERTION BAR CODE
   220* 091913    2013090300001  AJRA  ADD SIGNATURE FLAG DEFAULT
   221*-----------------------------------------------------------------
   222 01  W-Z-CONTROL-DATA.
   223     05  W-NUMBER-OF-COPIES      PIC  9.
   224     05  FILLER                  PIC  X.
   225     05  W-DAYS-TO-FOLLOW-UP     PIC  999.
   226     05  FILLER                  PIC  X.
   227     05  W-DAYS-TO-RESEND        PIC  999.
   228     05  FILLER                  PIC  X.
   229     05  W-FORM-TO-RESEND        PIC  X(4).
   230     05  W-ADD-BAR-CODE          PIC  X.
   231     05  W-PROMPT-LETTER         PIC  X.
   232     05  W-HAS-RETURN-ENV        PIC  X.
   233     05  W-ENCLOSURE-CD          PIC  XXX.
   234     05  W-SIG-FLAG-DEFAULT      PIC  X.
   235     05  W-AUTO-CLOSE-IND        PIC  X.
   236     05  FILLER                  PIC  X.
   237     05  W-LETTER-TO-BENE        PIC  X.
   238     05  FILLER                  PIC  X.
   239     05  W-LETTER-TO-ACCT        PIC  X.
   240     05  FILLER                  PIC  X.
   241     05  W-LETTER-TYPE           PIC  X.
   242     05  FILLER                  PIC  X.
   243     05  W-PRINT-CERTIFICATE     PIC  X.
   244     05  FILLER                  PIC  X.
   245     05  W-REFUND-REQUIRED       PIC  X.
   246     05  FILLER                  PIC  X.
   247     05  W-ONBASE-CODE           PIC  XX.
   248     05  FILLER                  PIC  X.
   249     05  W-ACCT-SUMM             PIC  X.
   250     05  FILLER                  PIC  X.
   251     05  W-CSO-SUMM              PIC  X.
   252     05  FILLER                  PIC  X.
   253     05  W-REASONS-REQUIRED      PIC  X.
   254     05  FILLER                  PIC  X(29).
   255 01  WS-PASSED-REASON-CODES      PIC X(60)  VALUE SPACES.
   256 01  STANDARD-AREAS.
   257     12  W-ARCH-SUPPRESS         PIC ZZZZZZZ9.
   258     12  W-ARCH-EDIT REDEFINES W-ARCH-SUPPRESS
   259                                 PIC  X(08).
   260     12  QID.
   261         16  QID-TERM        PIC X(4)    VALUE SPACES.
   262         16  FILLER          PIC X(4)    VALUE '631I'.
   263     12  TIME-MT                 PIC S9(7).
   264     12  TIME-MT-R  REDEFINES TIME-MT.
   265         16  FILLER              PIC X.
   266         16  TIME-LMT            PIC 99V99.
   267         16  FILLER              PIC X(2).
   268     12  GETMAIN-SPACE           PIC X VALUE SPACES.
   269     12  MAP-LENGTH              PIC 9(4)   VALUE 359 BINARY.
   270     12  ERENDT-LENGTH           PIC S9(04) VALUE +579 COMP.
   271     12  ERPNDB-LENGTH           PIC 9(04)  VALUE 585 COMP.
   272     12  ERCNOT-LENGTH           PIC S9(04) VALUE +150 COMP.
   273     12  ERNOTE-LENGTH           PIC S9(04) VALUE +825 COMP.
   274     12  ELEOBC-LENGTH           PIC S9(04) VALUE +350 COMP.
   275     12  ELENCC-LENGTH           PIC S9(04) VALUE +400 COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   7
* EL6316.cbl
   276     12  WS-ELCERT-KEY.
   277         16  W-CERT-COMPANY-CD   PIC X.
   278         16  W-CERT-CARRIER      PIC X.
   279         16  W-CERT-GROUPING     PIC X(6).
   280         16  W-CERT-STATE        PIC XX.
   281         16  W-CERT-ACCOUNT      PIC X(10).
   282         16  W-CERT-CERT-EFF-DT  PIC XX.
   283         16  W-CERT-CERT-PRIME   PIC X(10).
   284         16  W-CERT-CERT-SFX     PIC X.
   285     12  WS-ELEOBC-KEY.
   286         16  WS-EOBC-COMPANY-CD  PIC X.
   287         16  WS-EOBC-REC-TYPE    PIC X.
   288         16  WS-EOBC-CODE        PIC X(4).
   289         16  FILLER              PIC X(9).
   290     12  WS-ERNOTE-KEY.
   291         16  W-NOTE-COMPANY-CD   PIC X.
   292         16  W-NOTE-CARRIER      PIC X.
   293         16  W-NOTE-GROUPING     PIC X(6).
   294         16  W-NOTE-STATE        PIC XX.
   295         16  W-NOTE-ACCOUNT      PIC X(10).
   296         16  W-NOTE-CERT-EFF-DT  PIC XX.
   297         16  W-NOTE-CERT-PRIME   PIC X(10).
   298         16  W-NOTE-CERT-SFX     PIC X.
   299         16  W-NOTE-RECORD-TYPE  PIC X.
   300     12  ELLETR-KEY.
   301         16  LETR-PART-KEY.
   302             20  LETR-COMPANY-CD PIC X.
   303             20  LETR-LETTER-ID  PIC X(4).
   304         16  LETR-FILLER         PIC X(8).
   305         16  LETR-SEQ-NO         PIC 9(4) BINARY.
   306     12  ELLETR-SAVE-PART-KEY    PIC X(5).
   307     12  ERPNDB2-KEY.
   308         16  PNDB2-COMPANY-CD    PIC X.
   309         16  PNDB2-CARRIER       PIC X.
   310         16  PNDB2-GROUPING      PIC X(6).
   311         16  PNDB2-STATE         PIC XX.
   312         16  PNDB2-ACCOUNT       PIC X(10).
   313         16  PNDB2-CERT-EFF-DT   PIC XX.
   314         16  PNDB2-CERT-PRIME    PIC X(10).
   315         16  PNDB2-CERT-SFX      PIC X.
   316         16  PNDB2-CHG-SEQ-NO    PIC 9(4) BINARY.
   317         16  PNDB2-RECORD-TYPE   PIC X.
   318     12  ERENDT-KEY.
   319         16  ENDT-COMPANY-CD       PIC X.
   320         16  ENDT-CARRIER          PIC X.
   321         16  ENDT-GROUPING         PIC X(6).
   322         16  ENDT-STATE            PIC XX.
   323         16  ENDT-ACCOUNT          PIC X(10).
   324         16  ENDT-CERT-EFF-DT      PIC XX.
   325         16  ENDT-CERT-PRIME       PIC X(10).
   326         16  ENDT-CERT-SFX         PIC X.
   327         16  ENDT-RECORD-TYPE      PIC X.
   328         16  ENDT-SEQ-NO           PIC 9(4) BINARY.
   329     12  ELCRTO-KEY.
   330         16  CRTO-COMPANY-CD     PIC X.
   331         16  CRTO-CARRIER        PIC X.
   332         16  CRTO-GROUPING       PIC X(6).
   333         16  CRTO-STATE          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   8
* EL6316.cbl
   334         16  CRTO-ACCOUNT        PIC X(10).
   335         16  CRTO-CERT-EFF-DT    PIC XX.
   336         16  CRTO-CERT-PRIME     PIC X(10).
   337         16  CRTO-CERT-SFX       PIC X.
   338         16  CRTO-RECORD-TYPE    PIC X.
   339         16  CRTO-SEQ-NO         PIC 9(4) BINARY.
   340     12  WS-ERMAIL-KEY.
   341         16  MAIL-COMPANY-CD     PIC X.
   342         16  MAIL-CARRIER        PIC X.
   343         16  MAIL-GROUPING       PIC X(6).
   344         16  MAIL-STATE          PIC XX.
   345         16  MAIL-ACCOUNT        PIC X(10).
   346         16  MAIL-CERT-EFF-DT    PIC XX.
   347         16  MAIL-CERT-PRIME     PIC X(10).
   348         16  MAIL-CERT-SFX       PIC X.
   349     12  WS-ELCRTT-KEY.
   350         16  WS-ELCRTT-PRIMARY       PIC X(33).
   351         16  WS-ELCRTT-REC-TYPE      PIC X(1).
   352
   353     12  WS-ELENCC-KEY.
   354         16  WS-ENCC-COMPANY-CD  PIC X.
   355         16  WS-ENCC-REC-TYPE    PIC X.
   356         16  WS-ENCC-ENC-CODE    PIC X(5).
   357         16  FILLER              PIC X(09).
   358
   359     12  WS-LF-CANC-DT           PIC XX   VALUE LOW-VALUES.
   360     12  WS-AH-CANC-DT           PIC XX   VALUE LOW-VALUES.
   361     12  WS-CURRENT-DT.
   362         16  FILLER              PIC X(6)    VALUE SPACES.
   363         16  WS-CURRENT-YR       PIC XX      VALUE SPACES.
   364     12  WS-CURRENT-BIN-DT       PIC XX    VALUE LOW-VALUES.
   365     12  WS-ISS-CAN-SW           PIC X     VALUE LOW-VALUES.
   366         88  CANCEL-REC            VALUE 'C'.
   367         88  ISSUE-REC             VALUE 'I'.
   368     12  WS-WORK-AMT             PIC S9(9)V99 COMP-3 VALUE +0.
   369     12  WS-HOLD-ACCT-KEY        PIC X(26) VALUE LOW-VALUES.
   370     12  ELCNTL-KEY.
   371         16  CNTL-COMP-ID        PIC X(3)  VALUE SPACES.
   372         16  CNTL-REC-TYPE       PIC X     VALUE SPACES.
   373         16  CNTL-ACCESS.
   374             20  CNTL-STATE      PIC XX    VALUE SPACES.
   375             20  FILLER          PIC X     VALUE SPACES.
   376             20  CNTL-CARRIER    PIC X     VALUE SPACES.
   377         16  CNTL-SEQ            PIC S9(4) VALUE +0 COMP.
   378     12  WS-ERACCT-KEY.
   379         16  ACCT-COMPANY-CD     PIC X.
   380         16  ACCT-CARRIER        PIC X.
   381         16  ACCT-GROUPING       PIC X(6).
   382         16  ACCT-STATE          PIC XX.
   383         16  ACCT-ACCOUNT        PIC X(10).
   384         16  ACCT-EXP-DATE       PIC XX    VALUE SPACES.
   385         16  FILLER              PIC X(4)  VALUE LOW-VALUES.
   386     12  WS-ELCNTL-FILE-ID       PIC X(8) VALUE 'ELCNTL'.
   387     12  WS-ERNOTE-FILE-ID       PIC X(8) VALUE 'ERNOTE'.
   388     12  WS-ELCRTO-FILE-ID       PIC X(8) VALUE 'ELCRTO'.
   389     12  WS-ERENDT-FILE-ID       PIC X(8) VALUE 'ERENDT'.
   390     12  WS-ERPNDB2-FILE-ID      PIC X(8) VALUE 'ERPNDB2'.
   391     12  WS-ERPNDB-FILE-ID       PIC X(8) VALUE 'ERPNDB'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page   9
* EL6316.cbl
   392     12  WS-ERACCT2-FILE-ID      PIC X(8) VALUE 'ERACCT2'.
   393     12  WS-ELCERT-FILE-ID       PIC X(8) VALUE 'ELCERT'.
   394     12  WS-ERCNOT-FILE-ID       PIC X(8) VALUE 'ERCNOT'.
   395     12  WS-ELEOBC-FILE-ID       PIC X(8) VALUE 'ELEOBC'.
   396     12  WS-ELENCC-FILE-ID       PIC X(8) VALUE 'ELENCC'.
   397     12  WS-ELCRTT-FILE-ID       PIC X(8) VALUE 'ELCRTT'.
   398     12  WS-ERMAIL-FILE-ID       PIC X(8) VALUE 'ERMAIL'.
   399     12  WS-RESPONSE             PIC S9(8)   COMP.
   400         88  RESP-NORMAL                  VALUE +00.
   401         88  RESP-NOTFND                  VALUE +13.
   402         88  RESP-DUPREC                  VALUE +14.
   403         88  RESP-DUPKEY                  VALUE +15.
   404         88  RESP-NOTOPEN                 VALUE +19.
   405         88  RESP-ENDFILE                 VALUE +20.
   406     12  MAP-NAME            PIC X(8)    VALUE 'EL631I'.
   407     12  MAPSET-NAME         PIC X(8)    VALUE 'EL6316S'.
   408     12  SCREEN-NUMBER       PIC X(4)    VALUE '631I'.
   409     12  TRANS-ID            PIC X(4)    VALUE 'EXBC'.
   410     12  THIS-PGM            PIC X(8)    VALUE 'EL6316'.
   411     12  PGM-NAME            PIC X(8).
   412     12  TIME-IN             PIC S9(7).
   413     12  TIME-OUT-R  REDEFINES TIME-IN.
   414         16  FILLER          PIC X.
   415         16  TIME-OUT        PIC 99V99.
   416         16  FILLER          PIC X(2).
   417     12  XCTL-005            PIC X(8)    VALUE 'EL005'.
   418     12  XCTL-010            PIC X(8)    VALUE 'EL010'.
   419     12  XCTL-626            PIC X(8)    VALUE 'EL626'.
   420     12  XCTL-6311           PIC X(8)    VALUE 'EL6311'.
   421     12  XCTL-6317           PIC X(8)    VALUE 'EL6317'.
   422     12  XCTL-6318           PIC X(8)    VALUE 'EL6318'.
   423     12  LINK-001            PIC X(8)    VALUE 'EL001'.
   424     12  LINK-004            PIC X(8)    VALUE 'EL004'.
   425     12  LINK-ELDATCV        PIC X(8)    VALUE 'ELDATCV'.
   426     12  WS-PHONE.
   427         16  WS-PH1              PIC XXX.
   428         16  WS-PH2              PIC XXX.
   429         16  WS-PH3              PIC XXXX.
   430     12  WS-PHONE-NUM REDEFINES WS-PHONE PIC 9(10).
   431     12  WS-DEV-RT               PIC S9V9(6) COMP-3.
   432
   433     12  WS-BILLING-NOTE.
   434         16  WS-BN-NOTE          PIC X(25).
   435         16  WS-BN-LTRID         PIC X(4).
   436         16  FILLER              PIC X(3).
   437         16  WS-BN-DATE          PIC X(8).
   438         16  FILLER              PIC X(3).
   439         16  WS-BN-USERID        PIC X(4).
   440         16  FILLER              PIC X(30).
   441     12  WS-MANUAL-BILL-NOTE REDEFINES WS-BILLING-NOTE.
   442         16  WS-MAN-BN-NOTE      PIC X(63).
   443         16  FILLER              PIC X(14).
   444     12  WS-LEN                  PIC S9(5) COMP-3 VALUE +0.
   445     12  WS-TMPDATE.
   446         16  FILLER              PIC X(2).
   447         16  WS-TMPDT            PIC X(6).
   448     12  WS-AMTX                 PIC X(10).
   449     12  WS-AMTN  REDEFINES WS-AMTX PIC 9(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  10
* EL6316.cbl
   450     12  WS-AMTV2 REDEFINES WS-AMTN PIC 9(8)V99.
   451     12  NEW-ORIG-REC.
   452         16  NEW-INS-LAST-NAME             PIC X(15).
   453         16  NEW-INS-FIRST-NAME            PIC X(10).
   454         16  NEW-INS-MIDDLE-INIT           PIC X.
   455         16  NEW-INS-AGE                   PIC S999     COMP-3.
   456         16  NEW-JNT-LAST-NAME             PIC X(15).
   457         16  NEW-JNT-FIRST-NAME            PIC X(10).
   458         16  NEW-JNT-MIDDLE-INIT           PIC X.
   459         16  NEW-JNT-AGE                   PIC S999     COMP-3.
   460         16  NEW-LF-BENCD                  PIC XX.
   461         16  NEW-LF-TERM                   PIC S999      COMP-3.
   462         16  NEW-LF-BEN-AMT                PIC S9(9)V99  COMP-3.
   463         16  NEW-LF-PRM-AMT                PIC S9(7)V99  COMP-3.
   464         16  NEW-LF-ALT-BEN-AMT            PIC S9(9)V99  COMP-3.
   465         16  NEW-LF-ALT-PRM-AMT            PIC S9(7)V99  COMP-3.
   466         16  NEW-LF-EXP-DT                 PIC XX.
   467         16  NEW-LF-COMM-PCT               PIC SV9(5)    COMP-3.
   468         16  NEW-LF-CANCEL-DT              PIC XX.
   469         16  NEW-LF-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   470         16  NEW-LF-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   471         16  NEW-AH-BENCD                  PIC XX.
   472         16  NEW-AH-TERM                   PIC S999      COMP-3.
   473         16  NEW-AH-BEN-AMT                PIC S9(9)V99  COMP-3.
   474         16  NEW-AH-PRM-AMT                PIC S9(7)V99  COMP-3.
   475         16  NEW-AH-EXP-DT                 PIC XX.
   476         16  NEW-AH-COMM-PCT               PIC SV9(5)    COMP-3.
   477         16  NEW-AH-CP                     PIC 99.
   478         16  NEW-AH-CANCEL-DT              PIC XX.
   479         16  NEW-AH-CANCEL-AMT             PIC S9(7)V99  COMP-3.
   480         16  NEW-AH-ITD-CANCEL-AMT         PIC S9(7)V99  COMP-3.
   481         16  NEW-CRED-BENE-NAME            PIC X(25).
   482         16  NEW-1ST-PMT-DT                PIC XX.
   483         16  NEW-INS-AGE-DEFAULT-FLAG      PIC X.
   484         16  NEW-JNT-AGE-DEFAULT-FLAG      PIC X.
   485         16  NEW-ISSUE-TRAN-IND            PIC X.
   486         16  NEW-CANCEL-TRAN-IND           PIC X.
   487         16  FILLER                        PIC X(235).
   488
   489 01  CERT-NOTE-ENTRIES.
   490     12  CERT-NT OCCURS 300 TIMES INDEXED BY TB-INDX TB-INDX1.
   491         16  CERT-NT-TEXT                PIC X(63).
   492         16  CERT-NT-LAST-MAINT-BY       PIC XXXX.
   493         16  CERT-NT-LAST-MAINT-DT       PIC XX.
   494         16  CERT-NT-LAST-MAINT-HHMMSS   PIC S9(7) COMP-3.
   495
   496 01  ERCNOT-AREA.
   497     12  ERCNOT-KEY-LENGTH       PIC S9(4)   COMP VALUE +36.
   498     12  ERCNOT-START-LENGTH     PIC S9(4)   COMP VALUE +34.
   499     12  ERCNOT-KEY.
   500         16  ERCNOT-PARTIAL-KEY.
   501             20 ERCNOT-COMPANY-CD    PIC X.
   502             20 ERCNOT-CARRIER       PIC X.
   503             20 ERCNOT-GROUPING      PIC X(06).
   504             20 ERCNOT-STATE         PIC XX.
   505             20 ERCNOT-ACCOUNT       PIC X(10).
   506             20 ERCNOT-EFF-DT        PIC XX.
   507             20 ERCNOT-CERT-NO.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  11
* EL6316.cbl
   508                25 ERCNOT-CERT-PRIME PIC X(10).
   509                25 ERCNOT-CERT-SFX   PIC X.
   510             20 ERCNOT-REC-TYP       PIC X.
   511         16 ERCNOT-SEQ           PIC S9(4) COMP.
   512     12  SV-PARTIAL-KEY.
   513         20 SV-COMPANY-CD            PIC X.
   514         20 SV-CARRIER               PIC X.
   515         20 SV-GROUPING              PIC X(06).
   516         20 SV-STATE                 PIC XX.
   517         20 SV-ACCOUNT               PIC X(10).
   518         20 SV-EFF-DT                PIC XX.
   519         20 SV-CERT-NO.
   520            25 SV-CERT-PRIME         PIC X(10).
   521            25 SV-CERT-SFX           PIC X(1).
   522         20 SV-REC-TYP               PIC X.
   523 01  ERROR-MESSAGES.
   524     12  ER-0000                 PIC X(4)  VALUE '0000'.
   525     12  ER-0004                 PIC X(4)  VALUE '0004'.
   526     12  ER-0008                 PIC X(4)  VALUE '0008'.
   527     12  ER-0023                 PIC X(4)  VALUE '0023'.
   528     12  ER-0029                 PIC X(4)  VALUE '0029'.
   529     12  ER-0068                 PIC X(4)  VALUE '0068'.
   530     12  ER-0132                 PIC X(4)  VALUE '0132'.
   531     12  ER-0142                 PIC X(4)  VALUE '0142'.
   532     12  ER-0148                 PIC X(4)  VALUE '0148'.
   533     12  ER-0215                 PIC X(4)  VALUE '0215'.
   534     12  ER-0280                 PIC X(4)  VALUE '0280'.
   535     12  ER-0348                 PIC X(4)  VALUE '0348'.
   536     12  ER-0419                 PIC X(4)  VALUE '0419'.
   537     12  ER-0894                 PIC X(4)  VALUE '0894'.
   538     12  ER-1101                 PIC X(4)  VALUE '1101'.
   539     12  ER-1236                 PIC X(4)  VALUE '1236'.
   540     12  ER-1560                 PIC X(4)  VALUE '1560'.
   541     12  ER-1818                 PIC X(4)  VALUE '1818'.
   542     12  ER-1820                 PIC X(4)  VALUE '1820'.
   543     12  ER-2056                 PIC X(4)  VALUE '2056'.
   544     12  ER-2079                 PIC X(4)  VALUE '2079'.
   545     12  ER-2208                 PIC X(4)  VALUE '2208'.
   546     12  ER-2209                 PIC X(4)  VALUE '2209'.
   547     12  ER-2237                 PIC X(4)  VALUE '2237'.
   548     12  ER-2238                 PIC X(4)  VALUE '2238'.
   549     12  ER-2253                 PIC X(4)  VALUE '2253'.
   550     12  ER-2619                 PIC X(4)  VALUE '2619'.
   551     12  ER-2651                 PIC X(4)  VALUE '2651'.
   552     12  ER-2784                 PIC X(4)  VALUE '2784'.
   553     12  ER-2785                 PIC X(4)  VALUE '2785'.
   554     12  ER-2786                 PIC X(4)  VALUE '2786'.
   555     12  ER-2791                 PIC X(4)  VALUE '2791'.
   556     12  ER-2845                 PIC X(4)  VALUE '2845'.
   557     12  ER-2848                 PIC X(4)  VALUE '2848'.
   558     12  ER-2851                 PIC X(4)  VALUE '2851'.
   559     12  ER-3829                 PIC X(4)  VALUE '3829'.
   560     12  ER-3830                 PIC X(4)  VALUE '3830'.
   561     12  ER-3833                 PIC X(4)  VALUE '3833'.
   562     12  ER-7638                 PIC X(4)  VALUE '7638'.
   563     12  ER-8888                 PIC X(4)  VALUE '8888'.
   564     12  ER-9999                 PIC X(4)  VALUE '9999'.
   565*    COPY ELCDATE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  12
* EL6316.cbl
   566******************************************************************
   567*                                                                *
   568*                                                                *
   569*                            ELCDATE.                            *
   570*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   571*                            VMOD=2.003
   572*                                                                *
   573*                                                                *
   574*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
   575*                 LENGTH = 200                                   *
   576******************************************************************
   577
   578 01  DATE-CONVERSION-DATA.
   579     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
   580     12  DC-OPTION-CODE                PIC X.
   581         88  BIN-TO-GREG                VALUE ' '.
   582         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
   583         88  EDIT-GREG-TO-BIN           VALUE '2'.
   584         88  YMD-GREG-TO-BIN            VALUE '3'.
   585         88  MDY-GREG-TO-BIN            VALUE '4'.
   586         88  JULIAN-TO-BIN              VALUE '5'.
   587         88  BIN-PLUS-ELAPSED           VALUE '6'.
   588         88  FIND-CENTURY               VALUE '7'.
   589         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
   590         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
   591         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
   592         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
   593         88  JULIAN-TO-BIN-3            VALUE 'C'.
   594         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
   595         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
   596         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
   597         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
   598         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
   599         88  CHECK-LEAP-YEAR            VALUE 'H'.
   600         88  BIN-3-TO-GREG              VALUE 'I'.
   601         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
   602         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
   603         88  CYMD-GREG-TO-BIN           VALUE 'L'.
   604         88  MDCY-GREG-TO-BIN           VALUE 'M'.
   605         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
   606         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
   607         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
   608         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
   609         88  THREE-CHARACTER-BIN
   610                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
   611         88  GREGORIAN-TO-BIN
   612                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
   613         88  BIN-TO-GREGORIAN
   614                  VALUES ' ' '1' 'I' '8' 'G'.
   615         88  JULIAN-TO-BINARY
   616                  VALUES '5' 'C' 'E' 'F'.
   617     12  DC-ERROR-CODE                 PIC X.
   618         88  NO-CONVERSION-ERROR        VALUE ' '.
   619         88  DATE-CONVERSION-ERROR
   620                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
   621         88  DATE-IS-ZERO               VALUE '1'.
   622         88  DATE-IS-NON-NUMERIC        VALUE '2'.
   623         88  DATE-IS-INVALID            VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  13
* EL6316.cbl
   624         88  DATE1-GREATER-DATE2        VALUE '4'.
   625         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
   626         88  DATE-INVALID-OPTION        VALUE '9'.
   627         88  INVALID-CENTURY            VALUE 'A'.
   628         88  ONLY-CENTURY               VALUE 'B'.
   629         88  ONLY-LEAP-YEAR             VALUE 'C'.
   630         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
   631     12  DC-END-OF-MONTH               PIC X.
   632         88  CALCULATE-END-OF-MONTH     VALUE '1'.
   633     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
   634         88  USE-NORMAL-PROCESS         VALUE ' '.
   635         88  ADJUST-DOWN-100-YRS        VALUE '1'.
   636         88  ADJUST-UP-100-YRS          VALUE '2'.
   637     12  FILLER                        PIC X.
   638     12  DC-CONVERSION-DATES.
   639         16  DC-BIN-DATE-1             PIC XX.
   640         16  DC-BIN-DATE-2             PIC XX.
   641         16  DC-GREG-DATE-1-EDIT       PIC X(08).
   642         16  DC-GREG-DATE-1-EDIT-R REDEFINES
   643                       DC-GREG-DATE-1-EDIT.
   644             20  DC-EDIT1-MONTH        PIC 99.
   645             20  SLASH1-1              PIC X.
   646             20  DC-EDIT1-DAY          PIC 99.
   647             20  SLASH1-2              PIC X.
   648             20  DC-EDIT1-YEAR         PIC 99.
   649         16  DC-GREG-DATE-2-EDIT       PIC X(08).
   650         16  DC-GREG-DATE-2-EDIT-R REDEFINES
   651                     DC-GREG-DATE-2-EDIT.
   652             20  DC-EDIT2-MONTH        PIC 99.
   653             20  SLASH2-1              PIC X.
   654             20  DC-EDIT2-DAY          PIC 99.
   655             20  SLASH2-2              PIC X.
   656             20  DC-EDIT2-YEAR         PIC 99.
   657         16  DC-GREG-DATE-1-YMD        PIC 9(06).
   658         16  DC-GREG-DATE-1-YMD-R  REDEFINES
   659                     DC-GREG-DATE-1-YMD.
   660             20  DC-YMD-YEAR           PIC 99.
   661             20  DC-YMD-MONTH          PIC 99.
   662             20  DC-YMD-DAY            PIC 99.
   663         16  DC-GREG-DATE-1-MDY        PIC 9(06).
   664         16  DC-GREG-DATE-1-MDY-R REDEFINES
   665                      DC-GREG-DATE-1-MDY.
   666             20  DC-MDY-MONTH          PIC 99.
   667             20  DC-MDY-DAY            PIC 99.
   668             20  DC-MDY-YEAR           PIC 99.
   669         16  DC-GREG-DATE-1-ALPHA.
   670             20  DC-ALPHA-MONTH        PIC X(10).
   671             20  DC-ALPHA-DAY          PIC 99.
   672             20  FILLER                PIC XX.
   673             20  DC-ALPHA-CENTURY.
   674                 24 DC-ALPHA-CEN-N     PIC 99.
   675             20  DC-ALPHA-YEAR         PIC 99.
   676         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
   677         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
   678         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
   679         16  DC-JULIAN-DATE            PIC 9(05).
   680         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
   681                                       PIC 9(05).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  14
* EL6316.cbl
   682         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
   683             20  DC-JULIAN-YEAR        PIC 99.
   684             20  DC-JULIAN-DAYS        PIC 999.
   685         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
   686         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
   687         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
   688     12  DATE-CONVERSION-VARIBLES.
   689         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
   690         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
   691             20  FILLER                PIC 9(3).
   692             20  HOLD-CEN-1-CCYY.
   693                 24  HOLD-CEN-1-CC     PIC 99.
   694                 24  HOLD-CEN-1-YY     PIC 99.
   695             20  HOLD-CEN-1-MO         PIC 99.
   696             20  HOLD-CEN-1-DA         PIC 99.
   697         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
   698             20  HOLD-CEN-1-R-MO       PIC 99.
   699             20  HOLD-CEN-1-R-DA       PIC 99.
   700             20  HOLD-CEN-1-R-CCYY.
   701                 24  HOLD-CEN-1-R-CC   PIC 99.
   702                 24  HOLD-CEN-1-R-YY   PIC 99.
   703             20  FILLER                PIC 9(3).
   704         16  HOLD-CENTURY-1-X.
   705             20  FILLER                PIC X(3)  VALUE SPACES.
   706             20  HOLD-CEN-1-X-CCYY.
   707                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
   708                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
   709             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
   710             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
   711         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
   712             20  HOLD-CEN-1-R-X-MO     PIC XX.
   713             20  HOLD-CEN-1-R-X-DA     PIC XX.
   714             20  HOLD-CEN-1-R-X-CCYY.
   715                 24  HOLD-CEN-1-R-X-CC PIC XX.
   716                 24  HOLD-CEN-1-R-X-YY PIC XX.
   717             20  FILLER                PIC XXX.
   718         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
   719         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
   720         16  DC-JULIAN-DATE-1          PIC 9(07).
   721         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
   722             20  DC-JULIAN-1-CCYY.
   723                 24  DC-JULIAN-1-CC    PIC 99.
   724                 24  DC-JULIAN-1-YR    PIC 99.
   725             20  DC-JULIAN-DA-1        PIC 999.
   726         16  DC-JULIAN-DATE-2          PIC 9(07).
   727         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
   728             20  DC-JULIAN-2-CCYY.
   729                 24  DC-JULIAN-2-CC    PIC 99.
   730                 24  DC-JULIAN-2-YR    PIC 99.
   731             20  DC-JULIAN-DA-2        PIC 999.
   732         16  DC-GREG-DATE-A-EDIT.
   733             20  DC-EDITA-MONTH        PIC 99.
   734             20  SLASHA-1              PIC X VALUE '/'.
   735             20  DC-EDITA-DAY          PIC 99.
   736             20  SLASHA-2              PIC X VALUE '/'.
   737             20  DC-EDITA-CCYY.
   738                 24  DC-EDITA-CENT     PIC 99.
   739                 24  DC-EDITA-YEAR     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  15
* EL6316.cbl
   740         16  DC-GREG-DATE-B-EDIT.
   741             20  DC-EDITB-MONTH        PIC 99.
   742             20  SLASHB-1              PIC X VALUE '/'.
   743             20  DC-EDITB-DAY          PIC 99.
   744             20  SLASHB-2              PIC X VALUE '/'.
   745             20  DC-EDITB-CCYY.
   746                 24  DC-EDITB-CENT     PIC 99.
   747                 24  DC-EDITB-YEAR     PIC 99.
   748         16  DC-GREG-DATE-CYMD         PIC 9(08).
   749         16  DC-GREG-DATE-CYMD-R REDEFINES
   750                              DC-GREG-DATE-CYMD.
   751             20  DC-CYMD-CEN           PIC 99.
   752             20  DC-CYMD-YEAR          PIC 99.
   753             20  DC-CYMD-MONTH         PIC 99.
   754             20  DC-CYMD-DAY           PIC 99.
   755         16  DC-GREG-DATE-MDCY         PIC 9(08).
   756         16  DC-GREG-DATE-MDCY-R REDEFINES
   757                              DC-GREG-DATE-MDCY.
   758             20  DC-MDCY-MONTH         PIC 99.
   759             20  DC-MDCY-DAY           PIC 99.
   760             20  DC-MDCY-CEN           PIC 99.
   761             20  DC-MDCY-YEAR          PIC 99.
   762    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
   763        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
   764    12  DC-EL310-DATE                  PIC X(21).
   765    12  FILLER                         PIC X(28).
   766*    COPY ELCLOGOF.
   767******************************************************************
   768*                                                                *
   769*                                                                *
   770*                            ELCLOGOF.                           *
   771*                            VMOD=2.001                          *
   772*                                                                *
   773*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
   774*                                                                *
   775******************************************************************
   776 01  CLASIC-LOGOFF.
   777     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
   778     12  LOGOFF-TEXT.
   779         16  FILLER          PIC X(5)    VALUE SPACES.
   780         16  LOGOFF-MSG.
   781             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
   782             20  FILLER      PIC X       VALUE SPACES.
   783             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
   784         16  FILLER          PIC X(80)
   785           VALUE '* YOU ARE NOW LOGGED OFF'.
   786         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
   787         16  FILLER          PIC X       VALUE QUOTE.
   788         16  LOGOFF-SYS-MSG  PIC X(17)
   789           VALUE 'S CLAS-IC SYSTEM '.
   790     12  TEXT-MESSAGES.
   791         16  UNACCESS-MSG    PIC X(29)
   792             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
   793         16  PGMIDERR-MSG    PIC X(17)
   794             VALUE 'PROGRAM NOT FOUND'.
   795*    COPY ELCATTR.
   796******************************************************************
   797*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  16
* EL6316.cbl
   798*                            ELCATTR.                            *
   799*                            VMOD=2.001                          *
   800*                                                                *
   801*             LIST OF STANDARD ATTRIBUTE VALUES                  *
   802*                                                                *
   803*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
   804*                                                                *
   805*                   POS 1   P=PROTECTED                          *
   806*                           U=UNPROTECTED                        *
   807*                           S=ASKIP                              *
   808*                   POS 2   A=ALPHA/NUMERIC                      *
   809*                           N=NUMERIC                            *
   810*                   POS 3   N=NORMAL                             *
   811*                           B=BRIGHT                             *
   812*                           D=DARK                               *
   813*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
   814*                           OF=MODIFIED DATA TAG OFF             *
   815*                                                                *
   816*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
   817******************************************************************
   818 01  ATTRIBUTE-LIST.
   819     12  AL-PABOF            PIC X       VALUE 'Y'.
   820     12  AL-PABON            PIC X       VALUE 'Z'.
   821     12  AL-PADOF            PIC X       VALUE '%'.
   822     12  AL-PADON            PIC X       VALUE '_'.
   823     12  AL-PANOF            PIC X       VALUE '-'.
   824     12  AL-PANON            PIC X       VALUE '/'.
   825     12  AL-SABOF            PIC X       VALUE '8'.
   826     12  AL-SABON            PIC X       VALUE '9'.
   827     12  AL-SADOF            PIC X       VALUE '@'.
   828     12  AL-SADON            PIC X       VALUE QUOTE.
   829     12  AL-SANOF            PIC X       VALUE '0'.
   830     12  AL-SANON            PIC X       VALUE '1'.
   831     12  AL-UABOF            PIC X       VALUE 'H'.
   832     12  AL-UABON            PIC X       VALUE 'I'.
   833     12  AL-UADOF            PIC X       VALUE '<'.
   834     12  AL-UADON            PIC X       VALUE '('.
   835     12  AL-UANOF            PIC X       VALUE ' '.
   836     12  AL-UANON            PIC X       VALUE 'A'.
   837     12  AL-UNBOF            PIC X       VALUE 'Q'.
   838     12  AL-UNBON            PIC X       VALUE 'R'.
   839     12  AL-UNDOF            PIC X       VALUE '*'.
   840     12  AL-UNDON            PIC X       VALUE ')'.
   841     12  AL-UNNOF            PIC X       VALUE '&'.
   842     12  AL-UNNON            PIC X       VALUE 'J'.
   843*    COPY ELCEMIB.
   844******************************************************************
   845*                                                                *
   846*                                                                *
   847*                            ELCEMIB.                            *
   848*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   849*                            VMOD=2.005                          *
   850*                                                                *
   851*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
   852*                                                                *
   853******************************************************************
   854 01  ERROR-MESSAGE-INTERFACE-BLOCK.
   855     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  17
* EL6316.cbl
   856     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
   857     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
   858     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
   859     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
   860     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
   861     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
   862     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
   863     12  EMI-SWITCH1             PIC X        VALUE '1'.
   864         88  EMI-NO-ERRORS                    VALUE '1'.
   865         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
   866         88  EMI-ERRORS-COMPLETE              VALUE '3'.
   867     12  EMI-SWITCH2             PIC X        VALUE '1'.
   868         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
   869     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
   870         88  EMI-AREA1-EMPTY                  VALUE '1'.
   871         88  EMI-AREA1-FULL                   VALUE '2'.
   872     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
   873         88  EMI-AREA2-EMPTY                  VALUE '1'.
   874         88  EMI-AREA2-FULL                   VALUE '2'.
   875     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
   876         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
   877         88  EMI-BYPASS-NOTES                 VALUE 'N'.
   878         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
   879         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
   880         88  EMI-BYPASS-FATALS                VALUE 'X'.
   881     12  EMI-ERROR-LINES.
   882         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
   883         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
   884         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
   885         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
   886             20  EMI-ERR-CODES OCCURS 10 TIMES.
   887                 24  EMI-ERR-NUM         PIC X(4).
   888                 24  EMI-FILLER          PIC X.
   889                 24  EMI-SEV             PIC X.
   890                 24  FILLER              PIC X.
   891             20  FILLER                  PIC X(02).
   892     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
   893         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
   894             20  EMI-ERROR-NUMBER    PIC X(4).
   895             20  EMI-FILL            PIC X.
   896             20  EMI-SEVERITY        PIC X.
   897             20  FILLER              PIC X.
   898             20  EMI-ERROR-TEXT.
   899                 24  EMI-TEXT-VARIABLE   PIC X(10).
   900                 24  FILLER          PIC X(55).
   901     12  EMI-SEVERITY-SAVE           PIC X.
   902         88  EMI-NOTE                    VALUE 'N'.
   903         88  EMI-WARNING                 VALUE 'W'.
   904         88  EMI-FORCABLE                VALUE 'F'.
   905         88  EMI-FATAL                   VALUE 'X'.
   906     12  EMI-MESSAGE-FLAG            PIC X.
   907         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
   908         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
   909     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
   910     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
   911         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
   912         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
   913         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  18
* EL6316.cbl
   914     12  emi-claim-no                pic x(7).
   915     12  emi-claim-type              pic x(6).
   916     12  FILLER                      PIC X(124)  VALUE SPACES.
   917     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
   918     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
   919     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
   920     12  EMI-AH-OVERRIDE-L6          PIC X(6).
   921*    COPY ELCTEXT.
   922******************************************************************
   923*                                                                *
   924*                                                                *
   925*                            ELCTEXT.                            *
   926*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
   927*                            VMOD=2.008                          *
   928*                                                                *
   929*   FILE DESCRIPTION = TEXT FILES FOR HELP DISPLAY,              *
   930*                                     FORM LETTERS,              *
   931*                                     CERT FORM DISPLAY.
   932*                                                                *
   933*   FILE TYPE = VSAM,KSDS                                        *
   934*   RECORD SIZE = 100   RECFORM = FIXED                          *
   935*                                                                *
   936*   BASE CLUSTER NAME = ELLETR (LETTERS)   RKP=2,LEN=15          *
   937*       ALTERNATE INDEX = NONE                                   *
   938*                                                                *
   939*   BASE CLUSTER NAME = ELFORM (FORMS)     RKP=2,LEN=15          *
   940*       ALTERNATE INDEX = NONE                                   *
   941*                                                                *
   942*   BASE CLUSTER NAME = ELHELP (HELP)      RKP=2,LEN=15          *
   943*       ALTERNATE INDEX = NONE                                   *
   944*                                                                *
   945*   LOG = NO                                                     *
   946*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
   947******************************************************************
   948 01  TEXT-FILES.
   949     12  TEXT-FILE-ID                PIC XX.
   950         88  FORMS-FILE-TEXT            VALUE 'TF'.
   951         88  LETTER-FILE-TEXT           VALUE 'TL'.
   952         88  HELP-FILE-TEXT             VALUE 'TH'.
   953
   954     12  TX-CONTROL-PRIMARY.
   955         16  TX-COMPANY-CD           PIC X.
   956             88  TX-SYSTEM-WIDE-FILE    VALUE LOW-VALUE.
   957         16  TX-ACCESS-CD-GENL       PIC X(12).
   958
   959         16  TX-LETTER-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   960             20  TX-LETTER-NO        PIC X(4).
   961             20  FILLER              PIC X(8).
   962
   963         16  TX-FORM-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   964             20  TX-FORM-NO          PIC X(12).
   965
   966         16  TX-HELP-ACCESS  REDEFINES  TX-ACCESS-CD-GENL.
   967             20  TX-HELP-TYPE        PIC X.
   968                 88  HELP-FOR-GENERAL   VALUE ' '.
   969                 88  HELP-BY-SCREEN     VALUE 'S'.
   970                 88  HELP-BY-ERROR      VALUE 'E'.
   971             20  TX-SCREEN-OR-ERROR  PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  19
* EL6316.cbl
   972                 88  GENERAL-INFO-HELP  VALUE '0000'.
   973             20  TX-HELP-FOR-COMPANY  PIC XXX.
   974                 88  NOT-COMPANY-SPECIFIC VALUE '   '.
   975             20  FILLER              PIC X(4).
   976
   977         16  TX-LINE-SEQUENCE        PIC S9(4)     COMP.
   978
   979     12  TX-PROCESS-CONTROL          PIC XX.
   980         88  LETTER-LINE-SKIPS          VALUE '01' THRU '99'.
   981
   982     12  TX-TEXT-LINE                PIC X(70).
   983
   984     12  TX-FORM-SQUEEZE-CONTROL     PIC X.
   985         88  TX-FORM-SQUEEZE-ON         VALUE 'Y'.
   986         88  TX-FORM-SQUEEZE-OFF        VALUE SPACES.
   987         88  TX-VALID-FORM-SQUEEZE-VALUE
   988                                        VALUE 'Y' ' '.
   989
   990     12  TX-LINE-SQUEEZE-CONTROL     PIC X.
   991         88  TX-ADJUST-TO-LINE-LENGTH   VALUE 'A'.
   992         88  TX-CONTINUE-PARAGRAPH      VALUE 'C'.
   993         88  TX-DO-NOT-ADJUST           VALUE 'N'.
   994         88  TX-FORM-CONTROL-LINE       VALUE 'K'.
   995         88  TX-NEW-PARAGRAPH           VALUE 'P'.
   996         88  TX-NO-SPECIAL-INSTRUCTION  VALUE ' '.
   997         88  TX-VALID-LINE-SQ-VALUE     VALUE 'A' 'C' 'P'
   998                                              'K' 'N' ' '
   999                                              'Z'.
  1000
  1001     12  TX-ARCHIVE-SW               PIC X.
  1002         88  TX-ARCHIVE-THIS-LETTER     VALUE 'Y'.
  1003         88  TX-DO-NOT-ARCHIVE          VALUE SPACES.
  1004         88  TX-VALID-ARCHIVE-VALUE     VALUE 'Y' ' '.
  1005
  1006     12  TX-LAST-MAINTENANCED-BY     PIC X(4).
  1007     12  TX-LAST-MAINTENANCED-DT     PIC X(2).
  1008
  1009     12  TX-BSR-CODE                 PIC X.
  1010         88  TX-BSR-LETTER              VALUE 'B'.
  1011         88  TX-NON-BSR-LETTER          VALUE ' '.
  1012
  1013     12  FILLER                      PIC X.
  1014*****************************************************************
  1015*    COPY ELCINTF.
  1016******************************************************************
  1017*                                                                *
  1018*                                                                *
  1019*                            ELCINTF.                            *
  1020*                            VMOD=2.017                          *
  1021*                                                                *
  1022*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1023*                                                                *
  1024*       LENGTH = 1024                                            *
  1025*                                                                *
  1026******************************************************************
  1027*                   C H A N G E   L O G
  1028*
  1029* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  20
* EL6316.cbl
  1030*-----------------------------------------------------------------
  1031*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1032* EFFECTIVE    NUMBER
  1033*-----------------------------------------------------------------
  1034* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1035******************************************************************
  1036 01  PROGRAM-INTERFACE-BLOCK.
  1037     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1038     12  PI-CALLING-PROGRAM              PIC X(8).
  1039     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1040     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1041     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1042     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1043     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1044     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1045     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1046     12  PI-COMPANY-ID                   PIC XXX.
  1047     12  PI-COMPANY-CD                   PIC X.
  1048
  1049     12  PI-COMPANY-PASSWORD             PIC X(8).
  1050
  1051     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1052
  1053     12  PI-CONTROL-IN-PROGRESS.
  1054         16  PI-CARRIER                  PIC X.
  1055         16  PI-GROUPING                 PIC X(6).
  1056         16  PI-STATE                    PIC XX.
  1057         16  PI-ACCOUNT                  PIC X(10).
  1058         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1059                                         PIC X(10).
  1060         16  PI-CLAIM-CERT-GRP.
  1061             20  PI-CLAIM-NO             PIC X(7).
  1062             20  PI-CERT-NO.
  1063                 25  PI-CERT-PRIME       PIC X(10).
  1064                 25  PI-CERT-SFX         PIC X.
  1065             20  PI-CERT-EFF-DT          PIC XX.
  1066         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1067             20  PI-PLAN-CODE            PIC X(2).
  1068             20  PI-REVISION-NUMBER      PIC X(3).
  1069             20  PI-PLAN-EFF-DT          PIC X(2).
  1070             20  PI-PLAN-EXP-DT          PIC X(2).
  1071             20  FILLER                  PIC X(11).
  1072         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1073             20  PI-OE-REFERENCE-1.
  1074                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1075                 25  PI-OE-REF-1-SUFF    PIC XX.
  1076
  1077     12  PI-SESSION-IN-PROGRESS          PIC X.
  1078         88  CLAIM-SESSION                   VALUE '1'.
  1079         88  CREDIT-SESSION                  VALUE '2'.
  1080         88  WARRANTY-SESSION                VALUE '3'.
  1081         88  MORTGAGE-SESSION                VALUE '4'.
  1082         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1083
  1084
  1085*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1086
  1087     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  21
* EL6316.cbl
  1088     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1089
  1090     12  PI-CREDIT-USER                  PIC X.
  1091         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1092         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1093
  1094     12  PI-CLAIM-USER                   PIC X.
  1095         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1096         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1097
  1098     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1099         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1100         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1101         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1102         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1103         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1104
  1105     12  PI-PROCESSOR-ID                 PIC X(4).
  1106
  1107     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1108
  1109     12  PI-MEMBER-CAPTION               PIC X(10).
  1110
  1111     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1112         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1113
  1114     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1115     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1116     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1117     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1118
  1119     12  PI-AH-OVERRIDE-L1               PIC X.
  1120     12  PI-AH-OVERRIDE-L2               PIC XX.
  1121     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1122     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1123
  1124     12  PI-NEW-SYSTEM                   PIC X(2).
  1125
  1126     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1127     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
  1128         88  PI-USES-PAID-TO                 VALUE '1'.
  1129     12  PI-CRDTCRD-SYSTEM.
  1130         16  PI-CRDTCRD-USER             PIC X.
  1131             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1132             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1133         16  PI-CC-MONTH-END-DT          PIC XX.
  1134     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1135
  1136     12  PI-OE-REFERENCE-2.
  1137         16  PI-OE-REF-2-PRIME           PIC X(10).
  1138         16  PI-OE-REF-2-SUFF            PIC X.
  1139
  1140     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1141
  1142     12  PI-LANGUAGE-TYPE                PIC X.
  1143             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1144             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1145             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  22
* EL6316.cbl
  1146
  1147     12  PI-POLICY-LINKAGE-IND           PIC X.
  1148         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1149         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1150                                                   LOW-VALUES.
  1151
  1152     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1153     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1154         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1155         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1156
  1157     12  PI-PROCESSOR-CSR-IND            PIC X.
  1158         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1159         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1160
  1161     12  FILLER                          PIC X(3).
  1162
  1163     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1164
  1165     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1166         PI-SYSTEM-LEVEL.
  1167
  1168         16  PI-ENTRY-CODES.
  1169             20  PI-ENTRY-CD-1           PIC X.
  1170             20  PI-ENTRY-CD-2           PIC X.
  1171
  1172         16  PI-RETURN-CODES.
  1173             20  PI-RETURN-CD-1          PIC X.
  1174             20  PI-RETURN-CD-2          PIC X.
  1175
  1176         16  PI-UPDATE-STATUS-SAVE.
  1177             20  PI-UPDATE-BY            PIC X(4).
  1178             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1179
  1180         16  PI-LOWER-CASE-LETTERS       PIC X.
  1181             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1182
  1183*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1184*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1185*            88  CARRIER-CLM-CNTL            VALUE '2'.
  1186
  1187         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1188             88  ST-ACCNT-CNTL               VALUE ' '.
  1189             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1190             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1191             88  ACCNT-CNTL                  VALUE '3'.
  1192             88  CARR-ACCNT-CNTL             VALUE '4'.
  1193
  1194         16  PI-PROCESSOR-CAP-LIST.
  1195             20  PI-SYSTEM-CONTROLS.
  1196                24 PI-SYSTEM-DISPLAY     PIC X.
  1197                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1198                24 PI-SYSTEM-MODIFY      PIC X.
  1199                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1200             20  FILLER                  PIC XX.
  1201             20  PI-DISPLAY-CAP          PIC X.
  1202                 88  DISPLAY-CAP             VALUE 'Y'.
  1203             20  PI-MODIFY-CAP           PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  23
* EL6316.cbl
  1204                 88  MODIFY-CAP              VALUE 'Y'.
  1205             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1206                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1207             20  PI-FORCE-CAP            PIC X.
  1208                 88  FORCE-CAP               VALUE 'Y'.
  1209
  1210         16  PI-PROGRAM-CONTROLS.
  1211             20  PI-PGM-PRINT-OPT        PIC X.
  1212             20  PI-PGM-FORMAT-OPT       PIC X.
  1213             20  PI-PGM-PROCESS-OPT      PIC X.
  1214             20  PI-PGM-TOTALS-OPT       PIC X.
  1215
  1216         16  PI-HELP-INTERFACE.
  1217             20  PI-LAST-ERROR-NO        PIC X(4).
  1218             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1219
  1220         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1221             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1222
  1223         16  PI-CR-CONTROL-IN-PROGRESS.
  1224             20  PI-CR-CARRIER           PIC X.
  1225             20  PI-CR-GROUPING          PIC X(6).
  1226             20  PI-CR-STATE             PIC XX.
  1227             20  PI-CR-ACCOUNT           PIC X(10).
  1228             20  PI-CR-FIN-RESP          PIC X(10).
  1229             20  PI-CR-TYPE              PIC X.
  1230
  1231         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1232
  1233         16  PI-CR-MONTH-END-DT          PIC XX.
  1234
  1235         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1236             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1237             88  PI-ZERO-CARRIER             VALUE '1'.
  1238             88  PI-ZERO-GROUPING            VALUE '2'.
  1239             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1240
  1241         16  PI-CARRIER-SECURITY         PIC X.
  1242             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1243
  1244         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1245             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1246             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1247
  1248         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1249             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1250                                         INDEXED BY PI-ACCESS-NDX
  1251                                         PIC X.
  1252
  1253         16  PI-GA-BILLING-CONTROL       PIC X.
  1254             88  PI-GA-BILLING               VALUE '1'.
  1255
  1256         16  PI-MAIL-PROCESSING          PIC X.
  1257             88  PI-MAIL-YES                 VALUE 'Y'.
  1258
  1259         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1260
  1261         16  PI-AR-SYSTEM.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  24
* EL6316.cbl
  1262             20  PI-AR-PROCESSING-CNTL   PIC X.
  1263                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1264             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1265             20  PI-AR-MONTH-END-DT      PIC XX.
  1266
  1267         16  PI-MP-SYSTEM.
  1268             20  PI-MORTGAGE-USER            PIC X.
  1269                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1270                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1271             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1272                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1273                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1274                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1275                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1276                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1277             20  PI-MP-MONTH-END-DT          PIC XX.
  1278             20  PI-MP-REFERENCE-NO.
  1279                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1280                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1281
  1282         16  PI-LABEL-CONTROL            PIC X(01).
  1283             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1284             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1285
  1286         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1287             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1288
  1289         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1290             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1291             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1292
  1293         16  FILLER                      PIC X(14).
  1294
  1295     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1296******************************************************************
  1297     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1298        16  PI-ISS-CAN-SW           PIC X.
  1299        16  PI-ERENDT-KEY.
  1300            20  PI-ENDT-COMPANY-CD  PIC X.
  1301            20  PI-ENDT-CARRIER     PIC X.
  1302            20  PI-ENDT-GROUPING    PIC X(6).
  1303            20  PI-ENDT-STATE       PIC XX.
  1304            20  PI-ENDT-ACCOUNT     PIC X(10).
  1305            20  PI-ENDT-CERT-EFF-DT PIC XX.
  1306            20  PI-ENDT-CERT-PRIME  PIC X(10).
  1307            20  PI-ENDT-CERT-SFX    PIC X.
  1308            20  PI-ENDT-RECORD-TYPE PIC X.
  1309            20  PI-ENDT-SEQ-NO      PIC 9(4) BINARY.
  1310        16  PI-ELCRTO-KEY.
  1311            20  PI-CRTO-COMPANY-CD  PIC X.
  1312            20  PI-CRTO-CARRIER     PIC X.
  1313            20  PI-CRTO-GROUPING    PIC X(6).
  1314            20  PI-CRTO-STATE       PIC XX.
  1315            20  PI-CRTO-ACCOUNT     PIC X(10).
  1316            20  PI-CRTO-CERT-EFF-DT PIC XX.
  1317            20  PI-CRTO-CERT-PRIME  PIC X(10).
  1318            20  PI-CRTO-CERT-SFX    PIC X.
  1319            20  PI-CRTO-RECORD-TYPE PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  25
* EL6316.cbl
  1320            20  PI-CRTO-SEQ-NO      PIC 9(4) BINARY.
  1321        16  PI-ERPNDB-KEY           PIC X(11).
  1322        16  PI-DOCUMENT-PROCESSED   PIC X.
  1323            88  PI-VERI-PROCESSED      VALUE 'V'.
  1324            88  PI-ENDO-PROCESSED      VALUE 'G'.
  1325        16  PI-PREV-ERENDT-KEY      PIC X(36).
  1326        16  PI-RES-REF-CLM-TYPE     PIC X.
  1327        16  PI-CLM-RESC-IND         PIC X.
  1328            88  PI-CLM-RESCISSION      VALUE 'Y'.
  1329        16  PI-CLEAR-ERROR-SW       PIC X.
  1330            88  PI-CLEAR-ERROR         VALUE 'Y'.
  1331        16  PI-PRTSW-ENTERED        PIC X.
  1332        16  PI-LTRID-ENTERED        PIC X(4).
  1333        16  PI-REASONS-ENTERED      PIC X(84).
  1334        16  PI-CERTNT1-ENTERED      PIC X(63).
  1335        16  PI-CERTNT2-ENTERED      PIC X(63).
  1336        16  FILLER                  PIC X(20).
  1337        16  PI-FINALIZED-IND        PIC X.
  1338        16  PI-BILLNT1-ENTERED      PIC X(63).
  1339        16  PI-ENCCODE              PIC X(3).
  1340        16  PI-FROM-CERT            PIC X.
  1341        16  PI-ENDORSE-RECORD       PIC X.
  1342        16  FILLER                  PIC X(212).
  1343    12  FILLER                      PIC X(276).
  1344*    COPY ELCAID.
  1345******************************************************************
  1346*                                                                *
  1347*                            ELCAID.                             *
  1348*                            VMOD=2.001                          *
  1349*                                                                *
  1350*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1351*                                                                *
  1352*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1353*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1354******************************************************************
  1355
  1356 01  DFHAID.
  1357   02  DFHNULL   PIC  X  VALUE  ' '.
  1358   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1359   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1360   02  DFHPEN    PIC  X  VALUE  '='.
  1361   02  DFHOPID   PIC  X  VALUE  'W'.
  1362   02  DFHPA1    PIC  X  VALUE  '%'.
  1363   02  DFHPA2    PIC  X  VALUE  '>'.
  1364   02  DFHPA3    PIC  X  VALUE  ','.
  1365   02  DFHPF1    PIC  X  VALUE  '1'.
  1366   02  DFHPF2    PIC  X  VALUE  '2'.
  1367   02  DFHPF3    PIC  X  VALUE  '3'.
  1368   02  DFHPF4    PIC  X  VALUE  '4'.
  1369   02  DFHPF5    PIC  X  VALUE  '5'.
  1370   02  DFHPF6    PIC  X  VALUE  '6'.
  1371   02  DFHPF7    PIC  X  VALUE  '7'.
  1372   02  DFHPF8    PIC  X  VALUE  '8'.
  1373   02  DFHPF9    PIC  X  VALUE  '9'.
  1374   02  DFHPF10   PIC  X  VALUE  ':'.
  1375   02  DFHPF11   PIC  X  VALUE  '#'.
  1376   02  DFHPF12   PIC  X  VALUE  '@'.
  1377   02  DFHPF13   PIC  X  VALUE  'A'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  26
* EL6316.cbl
  1378   02  DFHPF14   PIC  X  VALUE  'B'.
  1379   02  DFHPF15   PIC  X  VALUE  'C'.
  1380   02  DFHPF16   PIC  X  VALUE  'D'.
  1381   02  DFHPF17   PIC  X  VALUE  'E'.
  1382   02  DFHPF18   PIC  X  VALUE  'F'.
  1383   02  DFHPF19   PIC  X  VALUE  'G'.
  1384   02  DFHPF20   PIC  X  VALUE  'H'.
  1385   02  DFHPF21   PIC  X  VALUE  'I'.
  1386*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1387   02  DFHPF22   PIC  X  VALUE  '['.
  1388   02  DFHPF23   PIC  X  VALUE  '.'.
  1389   02  DFHPF24   PIC  X  VALUE  '<'.
  1390   02  DFHMSRE   PIC  X  VALUE  'X'.
  1391   02  DFHSTRF   PIC  X  VALUE  'h'.
  1392   02  DFHTRIG   PIC  X  VALUE  '"'.
  1393 01  FILLER    REDEFINES DFHAID.
  1394     12  FILLER              PIC X(8).
  1395     12  PF-VALUES           PIC X       OCCURS 24 TIMES.
  1396*   COPY EL6316S.
  1397 01  EL631II.
  1398     05  FILLER            PIC  X(0012).
  1399*    -------------------------------
  1400     05  DATEL PIC S9(0004) COMP.
  1401     05  DATEF PIC  X(0001).
  1402     05  FILLER REDEFINES DATEF.
  1403         10  DATEA PIC  X(0001).
  1404     05  DATEI PIC  X(0008).
  1405*    -------------------------------
  1406     05  TIMEL PIC S9(0004) COMP.
  1407     05  TIMEF PIC  X(0001).
  1408     05  FILLER REDEFINES TIMEF.
  1409         10  TIMEA PIC  X(0001).
  1410     05  TIMEI PIC  X(0005).
  1411*    -------------------------------
  1412     05  PROCIDL PIC S9(0004) COMP.
  1413     05  PROCIDF PIC  X(0001).
  1414     05  FILLER REDEFINES PROCIDF.
  1415         10  PROCIDA PIC  X(0001).
  1416     05  PROCIDI PIC  X(0004).
  1417*    -------------------------------
  1418     05  HOSTL PIC S9(0004) COMP.
  1419     05  HOSTF PIC  X(0001).
  1420     05  FILLER REDEFINES HOSTF.
  1421         10  HOSTA PIC  X(0001).
  1422     05  HOSTI PIC  X(0009).
  1423*    -------------------------------
  1424     05  SYSL PIC S9(0004) COMP.
  1425     05  SYSF PIC  X(0001).
  1426     05  FILLER REDEFINES SYSF.
  1427         10  SYSA PIC  X(0001).
  1428     05  SYSI PIC  X(0005).
  1429*    -------------------------------
  1430     05  COMPANYL PIC S9(0004) COMP.
  1431     05  COMPANYF PIC  X(0001).
  1432     05  FILLER REDEFINES COMPANYF.
  1433         10  COMPANYA PIC  X(0001).
  1434     05  COMPANYI PIC  X(0003).
  1435*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  27
* EL6316.cbl
  1436     05  DATASORL PIC S9(0004) COMP.
  1437     05  DATASORF PIC  X(0001).
  1438     05  FILLER REDEFINES DATASORF.
  1439         10  DATASORA PIC  X(0001).
  1440     05  DATASORI PIC  X(0001).
  1441*    -------------------------------
  1442     05  BATCHNOL PIC S9(0004) COMP.
  1443     05  BATCHNOF PIC  X(0001).
  1444     05  FILLER REDEFINES BATCHNOF.
  1445         10  BATCHNOA PIC  X(0001).
  1446     05  BATCHNOI PIC  X(0006).
  1447*    -------------------------------
  1448     05  BSEQNOL PIC S9(0004) COMP.
  1449     05  BSEQNOF PIC  X(0001).
  1450     05  FILLER REDEFINES BSEQNOF.
  1451         10  BSEQNOA PIC  X(0001).
  1452     05  BSEQNOI PIC  X(0008).
  1453*    -------------------------------
  1454     05  ARCHNOL PIC S9(0004) COMP.
  1455     05  ARCHNOF PIC  X(0001).
  1456     05  FILLER REDEFINES ARCHNOF.
  1457         10  ARCHNOA PIC  X(0001).
  1458     05  ARCHNOI PIC  X(0008).
  1459*    -------------------------------
  1460     05  PRTSWL PIC S9(0004) COMP.
  1461     05  PRTSWF PIC  X(0001).
  1462     05  FILLER REDEFINES PRTSWF.
  1463         10  PRTSWA PIC  X(0001).
  1464     05  PRTSWI PIC  X(0001).
  1465*    -------------------------------
  1466     05  CARRL PIC S9(0004) COMP.
  1467     05  CARRF PIC  X(0001).
  1468     05  FILLER REDEFINES CARRF.
  1469         10  CARRA PIC  X(0001).
  1470     05  CARRI PIC  X(0001).
  1471*    -------------------------------
  1472     05  GROUPL PIC S9(0004) COMP.
  1473     05  GROUPF PIC  X(0001).
  1474     05  FILLER REDEFINES GROUPF.
  1475         10  GROUPA PIC  X(0001).
  1476     05  GROUPI PIC  X(0006).
  1477*    -------------------------------
  1478     05  STATEL PIC S9(0004) COMP.
  1479     05  STATEF PIC  X(0001).
  1480     05  FILLER REDEFINES STATEF.
  1481         10  STATEA PIC  X(0001).
  1482     05  STATEI PIC  X(0002).
  1483*    -------------------------------
  1484     05  ACCTL PIC S9(0004) COMP.
  1485     05  ACCTF PIC  X(0001).
  1486     05  FILLER REDEFINES ACCTF.
  1487         10  ACCTA PIC  X(0001).
  1488     05  ACCTI PIC  X(0010).
  1489*    -------------------------------
  1490     05  EFFDTL PIC S9(0004) COMP.
  1491     05  EFFDTF PIC  X(0001).
  1492     05  FILLER REDEFINES EFFDTF.
  1493         10  EFFDTA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  28
* EL6316.cbl
  1494     05  EFFDTI PIC  X(0008).
  1495*    -------------------------------
  1496     05  CERTNOL PIC S9(0004) COMP.
  1497     05  CERTNOF PIC  X(0001).
  1498     05  FILLER REDEFINES CERTNOF.
  1499         10  CERTNOA PIC  X(0001).
  1500     05  CERTNOI PIC  X(0010).
  1501*    -------------------------------
  1502     05  CRTSFXL PIC S9(0004) COMP.
  1503     05  CRTSFXF PIC  X(0001).
  1504     05  FILLER REDEFINES CRTSFXF.
  1505         10  CRTSFXA PIC  X(0001).
  1506     05  CRTSFXI PIC  X(0001).
  1507*    -------------------------------
  1508     05  LTRIDL PIC S9(0004) COMP.
  1509     05  LTRIDF PIC  X(0001).
  1510     05  FILLER REDEFINES LTRIDF.
  1511         10  LTRIDA PIC  X(0001).
  1512     05  LTRIDI PIC  X(0004).
  1513*    -------------------------------
  1514     05  SEQNOL PIC S9(0004) COMP.
  1515     05  SEQNOF PIC  X(0001).
  1516     05  FILLER REDEFINES SEQNOF.
  1517         10  SEQNOA PIC  X(0001).
  1518     05  SEQNOI PIC  X(0006).
  1519*    -------------------------------
  1520     05  FNAMEL PIC S9(0004) COMP.
  1521     05  FNAMEF PIC  X(0001).
  1522     05  FILLER REDEFINES FNAMEF.
  1523         10  FNAMEA PIC  X(0001).
  1524     05  FNAMEI PIC  X(0010).
  1525*    -------------------------------
  1526     05  MINITL PIC S9(0004) COMP.
  1527     05  MINITF PIC  X(0001).
  1528     05  FILLER REDEFINES MINITF.
  1529         10  MINITA PIC  X(0001).
  1530     05  MINITI PIC  X(0001).
  1531*    -------------------------------
  1532     05  LNAMEL PIC S9(0004) COMP.
  1533     05  LNAMEF PIC  X(0001).
  1534     05  FILLER REDEFINES LNAMEF.
  1535         10  LNAMEA PIC  X(0001).
  1536     05  LNAMEI PIC  X(0015).
  1537*    -------------------------------
  1538     05  ENCCODEL PIC S9(0004) COMP.
  1539     05  ENCCODEF PIC  X(0001).
  1540     05  FILLER REDEFINES ENCCODEF.
  1541         10  ENCCODEA PIC  X(0001).
  1542     05  ENCCODEI PIC  X(0003).
  1543*    -------------------------------
  1544     05  OLFDTL PIC S9(0004) COMP.
  1545     05  OLFDTF PIC  X(0001).
  1546     05  FILLER REDEFINES OLFDTF.
  1547         10  OLFDTA PIC  X(0001).
  1548     05  OLFDTI PIC  X(0008).
  1549*    -------------------------------
  1550     05  OLFAMTL PIC S9(0004) COMP.
  1551     05  OLFAMTF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  29
* EL6316.cbl
  1552     05  FILLER REDEFINES OLFAMTF.
  1553         10  OLFAMTA PIC  X(0001).
  1554     05  OLFAMTI PIC  X(0010).
  1555*    -------------------------------
  1556     05  OAHDTL PIC S9(0004) COMP.
  1557     05  OAHDTF PIC  X(0001).
  1558     05  FILLER REDEFINES OAHDTF.
  1559         10  OAHDTA PIC  X(0001).
  1560     05  OAHDTI PIC  X(0008).
  1561*    -------------------------------
  1562     05  OAHAMTL PIC S9(0004) COMP.
  1563     05  OAHAMTF PIC  X(0001).
  1564     05  FILLER REDEFINES OAHAMTF.
  1565         10  OAHAMTA PIC  X(0001).
  1566     05  OAHAMTI PIC  X(0010).
  1567*    -------------------------------
  1568     05  NLFDTL PIC S9(0004) COMP.
  1569     05  NLFDTF PIC  X(0001).
  1570     05  FILLER REDEFINES NLFDTF.
  1571         10  NLFDTA PIC  X(0001).
  1572     05  NLFDTI PIC  X(0008).
  1573*    -------------------------------
  1574     05  NLFAMTL PIC S9(0004) COMP.
  1575     05  NLFAMTF PIC  X(0001).
  1576     05  FILLER REDEFINES NLFAMTF.
  1577         10  NLFAMTA PIC  X(0001).
  1578     05  NLFAMTI PIC  X(0010).
  1579*    -------------------------------
  1580     05  NAHDTL PIC S9(0004) COMP.
  1581     05  NAHDTF PIC  X(0001).
  1582     05  FILLER REDEFINES NAHDTF.
  1583         10  NAHDTA PIC  X(0001).
  1584     05  NAHDTI PIC  X(0008).
  1585*    -------------------------------
  1586     05  NAHAMTL PIC S9(0004) COMP.
  1587     05  NAHAMTF PIC  X(0001).
  1588     05  FILLER REDEFINES NAHAMTF.
  1589         10  NAHAMTA PIC  X(0001).
  1590     05  NAHAMTI PIC  X(0010).
  1591*    -------------------------------
  1592     05  INPDTL PIC S9(0004) COMP.
  1593     05  INPDTF PIC  X(0001).
  1594     05  FILLER REDEFINES INPDTF.
  1595         10  INPDTA PIC  X(0001).
  1596     05  INPDTI PIC  X(0008).
  1597*    -------------------------------
  1598     05  PROCDTL PIC S9(0004) COMP.
  1599     05  PROCDTF PIC  X(0001).
  1600     05  FILLER REDEFINES PROCDTF.
  1601         10  PROCDTA PIC  X(0001).
  1602     05  PROCDTI PIC  X(0008).
  1603*    -------------------------------
  1604     05  LFCOMML PIC S9(0004) COMP.
  1605     05  LFCOMMF PIC  X(0001).
  1606     05  FILLER REDEFINES LFCOMMF.
  1607         10  LFCOMMA PIC  X(0001).
  1608     05  LFCOMMI PIC  X(0006).
  1609*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  30
* EL6316.cbl
  1610     05  AHCOMML PIC S9(0004) COMP.
  1611     05  AHCOMMF PIC  X(0001).
  1612     05  FILLER REDEFINES AHCOMMF.
  1613         10  AHCOMMA PIC  X(0001).
  1614     05  AHCOMMI PIC  X(0006).
  1615*    -------------------------------
  1616     05  RCD01L PIC S9(0004) COMP.
  1617     05  RCD01F PIC  X(0001).
  1618     05  FILLER REDEFINES RCD01F.
  1619         10  RCD01A PIC  X(0001).
  1620     05  RCD01I PIC  X(0004).
  1621*    -------------------------------
  1622     05  RCD02L PIC S9(0004) COMP.
  1623     05  RCD02F PIC  X(0001).
  1624     05  FILLER REDEFINES RCD02F.
  1625         10  RCD02A PIC  X(0001).
  1626     05  RCD02I PIC  X(0004).
  1627*    -------------------------------
  1628     05  RCD03L PIC S9(0004) COMP.
  1629     05  RCD03F PIC  X(0001).
  1630     05  FILLER REDEFINES RCD03F.
  1631         10  RCD03A PIC  X(0001).
  1632     05  RCD03I PIC  X(0004).
  1633*    -------------------------------
  1634     05  RCD04L PIC S9(0004) COMP.
  1635     05  RCD04F PIC  X(0001).
  1636     05  FILLER REDEFINES RCD04F.
  1637         10  RCD04A PIC  X(0001).
  1638     05  RCD04I PIC  X(0004).
  1639*    -------------------------------
  1640     05  RCD05L PIC S9(0004) COMP.
  1641     05  RCD05F PIC  X(0001).
  1642     05  FILLER REDEFINES RCD05F.
  1643         10  RCD05A PIC  X(0001).
  1644     05  RCD05I PIC  X(0004).
  1645*    -------------------------------
  1646     05  RCD06L PIC S9(0004) COMP.
  1647     05  RCD06F PIC  X(0001).
  1648     05  FILLER REDEFINES RCD06F.
  1649         10  RCD06A PIC  X(0001).
  1650     05  RCD06I PIC  X(0004).
  1651*    -------------------------------
  1652     05  RCD07L PIC S9(0004) COMP.
  1653     05  RCD07F PIC  X(0001).
  1654     05  FILLER REDEFINES RCD07F.
  1655         10  RCD07A PIC  X(0001).
  1656     05  RCD07I PIC  X(0004).
  1657*    -------------------------------
  1658     05  RCD08L PIC S9(0004) COMP.
  1659     05  RCD08F PIC  X(0001).
  1660     05  FILLER REDEFINES RCD08F.
  1661         10  RCD08A PIC  X(0001).
  1662     05  RCD08I PIC  X(0004).
  1663*    -------------------------------
  1664     05  RCD09L PIC S9(0004) COMP.
  1665     05  RCD09F PIC  X(0001).
  1666     05  FILLER REDEFINES RCD09F.
  1667         10  RCD09A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  31
* EL6316.cbl
  1668     05  RCD09I PIC  X(0004).
  1669*    -------------------------------
  1670     05  RCD10L PIC S9(0004) COMP.
  1671     05  RCD10F PIC  X(0001).
  1672     05  FILLER REDEFINES RCD10F.
  1673         10  RCD10A PIC  X(0001).
  1674     05  RCD10I PIC  X(0004).
  1675*    -------------------------------
  1676     05  RCD11L PIC S9(0004) COMP.
  1677     05  RCD11F PIC  X(0001).
  1678     05  FILLER REDEFINES RCD11F.
  1679         10  RCD11A PIC  X(0001).
  1680     05  RCD11I PIC  X(0004).
  1681*    -------------------------------
  1682     05  RCD12L PIC S9(0004) COMP.
  1683     05  RCD12F PIC  X(0001).
  1684     05  FILLER REDEFINES RCD12F.
  1685         10  RCD12A PIC  X(0001).
  1686     05  RCD12I PIC  X(0004).
  1687*    -------------------------------
  1688     05  CRTNT1L PIC S9(0004) COMP.
  1689     05  CRTNT1F PIC  X(0001).
  1690     05  FILLER REDEFINES CRTNT1F.
  1691         10  CRTNT1A PIC  X(0001).
  1692     05  CRTNT1I PIC  X(0063).
  1693*    -------------------------------
  1694     05  CRTNT2L PIC S9(0004) COMP.
  1695     05  CRTNT2F PIC  X(0001).
  1696     05  FILLER REDEFINES CRTNT2F.
  1697         10  CRTNT2A PIC  X(0001).
  1698     05  CRTNT2I PIC  X(0063).
  1699*    -------------------------------
  1700     05  BILNT1L PIC S9(0004) COMP.
  1701     05  BILNT1F PIC  X(0001).
  1702     05  FILLER REDEFINES BILNT1F.
  1703         10  BILNT1A PIC  X(0001).
  1704     05  BILNT1I PIC  X(0063).
  1705*    -------------------------------
  1706     05  ERRMSGL PIC S9(0004) COMP.
  1707     05  ERRMSGF PIC  X(0001).
  1708     05  FILLER REDEFINES ERRMSGF.
  1709         10  ERRMSGA PIC  X(0001).
  1710     05  ERRMSGI PIC  X(0075).
  1711*    -------------------------------
  1712     05  PFENTRL PIC S9(0004) COMP.
  1713     05  PFENTRF PIC  X(0001).
  1714     05  FILLER REDEFINES PFENTRF.
  1715         10  PFENTRA PIC  X(0001).
  1716     05  PFENTRI PIC  9(2).
  1717*    -------------------------------
  1718     05  PF3L PIC S9(0004) COMP.
  1719     05  PF3F PIC  X(0001).
  1720     05  FILLER REDEFINES PF3F.
  1721         10  PF3A PIC  X(0001).
  1722     05  PF3I PIC  X(0019).
  1723*    -------------------------------
  1724     05  PF4L PIC S9(0004) COMP.
  1725     05  PF4F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  32
* EL6316.cbl
  1726     05  FILLER REDEFINES PF4F.
  1727         10  PF4A PIC  X(0001).
  1728     05  PF4I PIC  X(0019).
  1729 01  EL631IO REDEFINES EL631II.
  1730     05  FILLER            PIC  X(0012).
  1731*    -------------------------------
  1732     05  FILLER            PIC  X(0003).
  1733     05  DATEO PIC  X(0008).
  1734*    -------------------------------
  1735     05  FILLER            PIC  X(0003).
  1736     05  TIMEO PIC  99.99.
  1737*    -------------------------------
  1738     05  FILLER            PIC  X(0003).
  1739     05  PROCIDO PIC  X(0004).
  1740*    -------------------------------
  1741     05  FILLER            PIC  X(0003).
  1742     05  HOSTO PIC  X(0009).
  1743*    -------------------------------
  1744     05  FILLER            PIC  X(0003).
  1745     05  SYSO PIC  X(0005).
  1746*    -------------------------------
  1747     05  FILLER            PIC  X(0003).
  1748     05  COMPANYO PIC  X(0003).
  1749*    -------------------------------
  1750     05  FILLER            PIC  X(0003).
  1751     05  DATASORO PIC  X(0001).
  1752*    -------------------------------
  1753     05  FILLER            PIC  X(0003).
  1754     05  BATCHNOO PIC  X(0006).
  1755*    -------------------------------
  1756     05  FILLER            PIC  X(0003).
  1757     05  BSEQNOO PIC  X(0008).
  1758*    -------------------------------
  1759     05  FILLER            PIC  X(0003).
  1760     05  ARCHNOO PIC  X(0008).
  1761*    -------------------------------
  1762     05  FILLER            PIC  X(0003).
  1763     05  PRTSWO PIC  X(0001).
  1764*    -------------------------------
  1765     05  FILLER            PIC  X(0003).
  1766     05  CARRO PIC  X(0001).
  1767*    -------------------------------
  1768     05  FILLER            PIC  X(0003).
  1769     05  GROUPO PIC  X(0006).
  1770*    -------------------------------
  1771     05  FILLER            PIC  X(0003).
  1772     05  STATEO PIC  X(0002).
  1773*    -------------------------------
  1774     05  FILLER            PIC  X(0003).
  1775     05  ACCTO PIC  X(0010).
  1776*    -------------------------------
  1777     05  FILLER            PIC  X(0003).
  1778     05  EFFDTO PIC  X(0008).
  1779*    -------------------------------
  1780     05  FILLER            PIC  X(0003).
  1781     05  CERTNOO PIC  X(0010).
  1782*    -------------------------------
  1783     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  33
* EL6316.cbl
  1784     05  CRTSFXO PIC  X(0001).
  1785*    -------------------------------
  1786     05  FILLER            PIC  X(0003).
  1787     05  LTRIDO PIC  X(0004).
  1788*    -------------------------------
  1789     05  FILLER            PIC  X(0003).
  1790     05  SEQNOO PIC  999999.
  1791*    -------------------------------
  1792     05  FILLER            PIC  X(0003).
  1793     05  FNAMEO PIC  X(0010).
  1794*    -------------------------------
  1795     05  FILLER            PIC  X(0003).
  1796     05  MINITO PIC  X(0001).
  1797*    -------------------------------
  1798     05  FILLER            PIC  X(0003).
  1799     05  LNAMEO PIC  X(0015).
  1800*    -------------------------------
  1801     05  FILLER            PIC  X(0003).
  1802     05  ENCCODEO PIC  X(0003).
  1803*    -------------------------------
  1804     05  FILLER            PIC  X(0003).
  1805     05  OLFDTO PIC  X(0008).
  1806*    -------------------------------
  1807     05  FILLER            PIC  X(0003).
  1808     05  OLFAMTO PIC  ZZZZ999.99.
  1809*    -------------------------------
  1810     05  FILLER            PIC  X(0003).
  1811     05  OAHDTO PIC  X(0008).
  1812*    -------------------------------
  1813     05  FILLER            PIC  X(0003).
  1814     05  OAHAMTO PIC  ZZZZ999.99.
  1815*    -------------------------------
  1816     05  FILLER            PIC  X(0003).
  1817     05  NLFDTO PIC  X(0008).
  1818*    -------------------------------
  1819     05  FILLER            PIC  X(0003).
  1820     05  NLFAMTO PIC  ZZZZ999.99.
  1821*    -------------------------------
  1822     05  FILLER            PIC  X(0003).
  1823     05  NAHDTO PIC  X(0008).
  1824*    -------------------------------
  1825     05  FILLER            PIC  X(0003).
  1826     05  NAHAMTO PIC  ZZZZ999.99.
  1827*    -------------------------------
  1828     05  FILLER            PIC  X(0003).
  1829     05  INPDTO PIC  X(0008).
  1830*    -------------------------------
  1831     05  FILLER            PIC  X(0003).
  1832     05  PROCDTO PIC  X(0008).
  1833*    -------------------------------
  1834     05  FILLER            PIC  X(0003).
  1835     05  LFCOMMO PIC  .99999.
  1836*    -------------------------------
  1837     05  FILLER            PIC  X(0003).
  1838     05  AHCOMMO PIC  .99999.
  1839*    -------------------------------
  1840     05  FILLER            PIC  X(0003).
  1841     05  RCD01O PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  34
* EL6316.cbl
  1842*    -------------------------------
  1843     05  FILLER            PIC  X(0003).
  1844     05  RCD02O PIC  X(0004).
  1845*    -------------------------------
  1846     05  FILLER            PIC  X(0003).
  1847     05  RCD03O PIC  X(0004).
  1848*    -------------------------------
  1849     05  FILLER            PIC  X(0003).
  1850     05  RCD04O PIC  X(0004).
  1851*    -------------------------------
  1852     05  FILLER            PIC  X(0003).
  1853     05  RCD05O PIC  X(0004).
  1854*    -------------------------------
  1855     05  FILLER            PIC  X(0003).
  1856     05  RCD06O PIC  X(0004).
  1857*    -------------------------------
  1858     05  FILLER            PIC  X(0003).
  1859     05  RCD07O PIC  X(0004).
  1860*    -------------------------------
  1861     05  FILLER            PIC  X(0003).
  1862     05  RCD08O PIC  X(0004).
  1863*    -------------------------------
  1864     05  FILLER            PIC  X(0003).
  1865     05  RCD09O PIC  X(0004).
  1866*    -------------------------------
  1867     05  FILLER            PIC  X(0003).
  1868     05  RCD10O PIC  X(0004).
  1869*    -------------------------------
  1870     05  FILLER            PIC  X(0003).
  1871     05  RCD11O PIC  X(0004).
  1872*    -------------------------------
  1873     05  FILLER            PIC  X(0003).
  1874     05  RCD12O PIC  X(0004).
  1875*    -------------------------------
  1876     05  FILLER            PIC  X(0003).
  1877     05  CRTNT1O PIC  X(0063).
  1878*    -------------------------------
  1879     05  FILLER            PIC  X(0003).
  1880     05  CRTNT2O PIC  X(0063).
  1881*    -------------------------------
  1882     05  FILLER            PIC  X(0003).
  1883     05  BILNT1O PIC  X(0063).
  1884*    -------------------------------
  1885     05  FILLER            PIC  X(0003).
  1886     05  ERRMSGO PIC  X(0075).
  1887*    -------------------------------
  1888     05  FILLER            PIC  X(0003).
  1889     05  PFENTRO PIC  X(0002).
  1890*    -------------------------------
  1891     05  FILLER            PIC  X(0003).
  1892     05  PF3O PIC  X(0019).
  1893*    -------------------------------
  1894     05  FILLER            PIC  X(0003).
  1895     05  PF4O PIC  X(0019).
  1896*    -------------------------------
  1897 01  FILLER REDEFINES EL631II.
  1898     12  FILLER                   PIC X(355).
  1899     12  REASONCDS.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  35
* EL6316.cbl
  1900         16  FILLER OCCURS 12.
  1901             20  REACDL       PIC S9(4) COMP.
  1902             20  REACDA       PIC X.
  1903             20  REACD-IN     PIC X(4).
  1904     12  FILLER               PIC X(215).
  1905****************************************************************
  1906*
  1907* Copyright (c) 2007-2013 Dell Inc.
  1908* All rights reserved.
  1909*
  1910****************************************************************
  1911 01  DFHEIV.
  1912   02  DFHEIV0               PIC X(35).
  1913   02  DFHEIV1               PIC X(08).
  1914   02  DFHEIV2               PIC X(08).
  1915   02  DFHEIV3               PIC X(08).
  1916   02  DFHEIV4               PIC X(06).
  1917   02  DFHEIV5               PIC X(04).
  1918   02  DFHEIV6               PIC X(04).
  1919   02  DFHEIV7               PIC X(02).
  1920   02  DFHEIV8               PIC X(02).
  1921   02  DFHEIV9               PIC X(01).
  1922   02  DFHEIV10              PIC S9(7) COMP-3.
  1923   02  DFHEIV11              PIC S9(4) COMP SYNC.
  1924   02  DFHEIV12              PIC S9(4) COMP SYNC.
  1925   02  DFHEIV13              PIC S9(4) COMP SYNC.
  1926   02  DFHEIV14              PIC S9(4) COMP SYNC.
  1927   02  DFHEIV15              PIC S9(4) COMP SYNC.
  1928   02  DFHEIV16              PIC S9(9) COMP SYNC.
  1929   02  DFHEIV17              PIC X(04).
  1930   02  DFHEIV18              PIC X(04).
  1931   02  DFHEIV19              PIC X(04).
  1932   02  DFHEIV20              USAGE IS POINTER.
  1933   02  DFHEIV21              USAGE IS POINTER.
  1934   02  DFHEIV22              USAGE IS POINTER.
  1935   02  DFHEIV23              USAGE IS POINTER.
  1936   02  DFHEIV24              USAGE IS POINTER.
  1937   02  DFHEIV25              PIC S9(9) COMP SYNC.
  1938   02  DFHEIV26              PIC S9(9) COMP SYNC.
  1939   02  DFHEIV27              PIC S9(9) COMP SYNC.
  1940   02  DFHEIV28              PIC S9(9) COMP SYNC.
  1941   02  DFHEIV29              PIC S9(9) COMP SYNC.
  1942   02  DFHEIV30              PIC S9(9) COMP SYNC.
  1943   02  DFHEIV31              PIC S9(9) COMP SYNC.
  1944   02  DFHEIV32              PIC S9(4) COMP SYNC.
  1945   02  DFHEIV33              PIC S9(4) COMP SYNC.
  1946   02  DFHEIV34              PIC S9(4) COMP SYNC.
  1947   02  DFHEIV35              PIC S9(4) COMP SYNC.
  1948   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  1949   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  1950   02  FILLER                PIC X(02).
  1951   02  DFHEIV99              PIC X(08) VALUE SPACE.
  1952   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  1953   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  1954   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  1955   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  1956   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  1957   02  DFHEIVL5              PIC X(255) VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  36
* EL6316.cbl
  1958 LINKAGE  SECTION.
  1959*****************************************************************
  1960*                                                               *
  1961* Copyright (c) 2007-2013 Dell Inc.                             *
  1962* All rights reserved.                                          *
  1963*                                                               *
  1964*****************************************************************
  1965 01  dfheiblk.
  1966     02  eibtime          pic s9(7) comp-3.
  1967     02  eibdate          pic s9(7) comp-3.
  1968     02  eibtrnid         pic x(4).
  1969     02  eibtaskn         pic s9(7) comp-3.
  1970     02  eibtrmid         pic x(4).
  1971     02  dfheigdi         pic s9(4) comp.
  1972     02  eibcposn         pic s9(4) comp.
  1973     02  eibcalen         pic s9(4) comp.
  1974     02  eibaid           pic x(1).
  1975     02  eibfiller1       pic x(1).
  1976     02  eibfn            pic x(2).
  1977     02  eibfiller2       pic x(2).
  1978     02  eibrcode         pic x(6).
  1979     02  eibfiller3       pic x(2).
  1980     02  eibds            pic x(8).
  1981     02  eibreqid         pic x(8).
  1982     02  eibrsrce         pic x(8).
  1983     02  eibsync          pic x(1).
  1984     02  eibfree          pic x(1).
  1985     02  eibrecv          pic x(1).
  1986     02  eibsend          pic x(1).
  1987     02  eibatt           pic x(1).
  1988     02  eibeoc           pic x(1).
  1989     02  eibfmh           pic x(1).
  1990     02  eibcompl         pic x(1).
  1991     02  eibsig           pic x(1).
  1992     02  eibconf          pic x(1).
  1993     02  eiberr           pic x(1).
  1994     02  eibrldbk         pic x(1).
  1995     02  eiberrcd         pic x(4).
  1996     02  eibsynrb         pic x(1).
  1997     02  eibnodat         pic x(1).
  1998     02  eibfiller5       pic x(2).
  1999     02  eibresp          pic s9(8) comp.
  2000     02  eibresp2         pic s9(8) comp.
  2001     02  dfheigdj         pic s9(4) comp.
  2002     02  dfheigdk         pic s9(4) comp.
  2003 01  DFHCOMMAREA                 PIC X(1300).
  2004 01  var  pic x(30).
  2005*                                COPY ERCACCT.
  2006******************************************************************
  2007*                                                                *
  2008*                                                                *
  2009*                            ERCACCT                             *
  2010*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2011*                            VMOD=2.031                          *
  2012*                                                                *
  2013*   CREDIT SYSTEM ACCOUNT MASTER FILE                            *
  2014*                                                                *
  2015*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  37
* EL6316.cbl
  2016*   VSAM ACCOUNT MASTER FILES.                                   *
  2017*                                                                *
  2018*   FILE DESCRIPTION = ACCOUNT OR PRODUCER FILES                 *
  2019*                                                                *
  2020*   FILE TYPE = VSAM,KSDS                                        *
  2021*   RECORD SIZE = 2000  RECFORM = FIX                            *
  2022*                                                                *
  2023*   BASE CLUSTER NAME = ERACCT                    RKP=2,LEN=26   *
  2024*       ALTERNATE PATH1 = ERACCT2 (ALT GROUPING) RKP=28,LEN=26   *
  2025*                                                                *
  2026*   LOG = NO                                                     *
  2027*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2028*                                                                *
  2029*                                                                *
  2030******************************************************************
  2031*                   C H A N G E   L O G
  2032*
  2033* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2034*-----------------------------------------------------------------
  2035*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2036* EFFECTIVE    NUMBER
  2037*-----------------------------------------------------------------
  2038* 102004    2003031400002  PEMA  ADD NEW STATUS CODE
  2039* 092705    2005050300006  PEMA  ADD SPP LEASES
  2040* 022808    2007083100002  PEMA  ADD FREEZE STATUS
  2041* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  2042* 030211  CR2010012100001  PEMA  ADD EMAILS FROM RDS
  2043* 031811  CR2011012700001  PEMA  ADD ACCT STATUS S - SUSPENDED
  2044* 101711  CR2011092000001  PEMA  ADD UNEARNED FACTOR STATE FOR DCC
  2045* 021916  CR2014010900001  TANA  ADD NEW STATUS CODE VALUES
  2046******************************************************************
  2047
  2048 01  ACCOUNT-MASTER.
  2049     12  AM-RECORD-ID                      PIC XX.
  2050         88  VALID-AM-ID                      VALUE 'AM'.
  2051
  2052     12  AM-CONTROL-PRIMARY.
  2053         16  AM-COMPANY-CD                 PIC X.
  2054         16  AM-MSTR-CNTRL.
  2055             20  AM-CONTROL-A.
  2056                 24  AM-CARRIER            PIC X.
  2057                 24  AM-GROUPING.
  2058                     28 AM-GROUPING-PREFIX PIC XXX.
  2059                     28 AM-GROUPING-PRIME  PIC XXX.
  2060                 24  AM-STATE              PIC XX.
  2061                 24  AM-ACCOUNT.
  2062                     28  AM-ACCOUNT-PREFIX PIC X(4).
  2063                     28  AM-ACCOUNT-PRIME  PIC X(6).
  2064             20  AM-CNTRL-1   REDEFINES   AM-CONTROL-A
  2065                                           PIC X(19).
  2066             20  AM-CNTRL-B.
  2067                 24  AM-EXPIRATION-DT      PIC XX.
  2068                 24  FILLER                PIC X(4).
  2069             20  AM-CNTRL-2 REDEFINES AM-CNTRL-B.
  2070                 24  AM-EXPIRE-DT          PIC 9(11)  COMP-3.
  2071
  2072     12  AM-CONTROL-BY-VAR-GRP.
  2073         16  AM-COMPANY-CD-A1              PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  38
* EL6316.cbl
  2074         16  AM-VG-CARRIER                 PIC X.
  2075         16  AM-VG-GROUPING                PIC X(6).
  2076         16  AM-VG-STATE                   PIC XX.
  2077         16  AM-VG-ACCOUNT                 PIC X(10).
  2078         16  AM-VG-DATE.
  2079             20  AM-VG-EXPIRATION-DT       PIC XX.
  2080             20  FILLER                    PIC X(4).
  2081         16  AM-VG-EXP-DATE REDEFINES AM-VG-DATE
  2082                                           PIC 9(11)      COMP-3.
  2083     12  FILLER REDEFINES AM-CONTROL-BY-VAR-GRP.
  2084         16  FILLER                        PIC X(10).
  2085         16  AM-VG-KEY3.
  2086             20  AM-VG3-ACCOUNT            PIC X(10).
  2087             20  AM-VG3-EXP-DT             PIC XX.
  2088         16  FILLER                        PIC X(4).
  2089     12  AM-MAINT-INFORMATION.
  2090         16  AM-LAST-MAINT-DT              PIC XX.
  2091         16  AM-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  2092         16  AM-LAST-MAINT-USER            PIC X(4).
  2093         16  FILLER                        PIC XX.
  2094
  2095     12  AM-EFFECTIVE-DT                   PIC XX.
  2096     12  AM-EFFECT-DT                      PIC 9(11)      COMP-3.
  2097
  2098     12  AM-PREV-DATES  COMP-3.
  2099         16  AM-PREV-EXP-DT                PIC 9(11).
  2100         16  AM-PREV-EFF-DT                PIC 9(11).
  2101
  2102     12  AM-REPORT-CODE-1                  PIC X(10).
  2103     12  AM-REPORT-CODE-2                  PIC X(10).
  2104
  2105     12  AM-CITY-CODE                      PIC X(4).
  2106     12  AM-COUNTY-PARISH                  PIC X(6).
  2107
  2108     12  AM-NAME                           PIC X(30).
  2109     12  AM-PERSON                         PIC X(30).
  2110     12  AM-ADDRS                          PIC X(30).
  2111     12  AM-CITY.
  2112         16  AM-ADDR-CITY                  PIC X(28).
  2113         16  AM-ADDR-STATE                 PIC XX.
  2114     12  AM-ZIP.
  2115         16  AM-ZIP-PRIME.
  2116             20  AM-ZIP-PRI-1ST            PIC X.
  2117                 88  AM-CANADIAN-POST-CODE    VALUE 'A' THRU 'Z'.
  2118             20  FILLER                    PIC X(4).
  2119         16  AM-ZIP-PLUS4                  PIC X(4).
  2120     12  AM-CANADIAN-POSTAL-CODE  REDEFINES  AM-ZIP.
  2121         16  AM-CAN-POSTAL-1               PIC XXX.
  2122         16  AM-CAN-POSTAL-2               PIC XXX.
  2123         16  FILLER                        PIC XXX.
  2124     12  AM-TEL-NO.
  2125         16  AM-AREA-CODE                  PIC 999.
  2126         16  AM-TEL-PRE                    PIC 999.
  2127         16  AM-TEL-NBR                    PIC 9(4).
  2128     12  AM-TEL-LOC                        PIC X.
  2129         88  AM-TEL-AT-HOME                   VALUE 'H'.
  2130         88  AM-TEL-AT-BUSINESS               VALUE 'B'.
  2131
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  39
* EL6316.cbl
  2132     12  AM-COMM-STRUCTURE.
  2133         16  AM-DEFN-1.
  2134             20  AM-AGT-COMMS       OCCURS 10 TIMES.
  2135                 24  AM-AGT.
  2136                     28  AM-AGT-PREFIX     PIC X(4).
  2137                     28  AM-AGT-PRIME      PIC X(6).
  2138                 24  AM-COM-TYP            PIC X.
  2139                 24  AM-L-COM              PIC SV9(5)     COMP-3.
  2140                 24  AM-J-COM              PIC SV9(5)     COMP-3.
  2141                 24  AM-A-COM              PIC SV9(5)     COMP-3.
  2142                 24  AM-RECALC-LV-INDIC    PIC X.
  2143                 24  AM-RETRO-LV-INDIC     PIC X.
  2144                 24  AM-GL-CODES           PIC X.
  2145                 24  AM-COMM-CHARGEBACK    PIC 9(02).
  2146                 24  FILLER                PIC X(01).
  2147         16  AM-DEFN-2   REDEFINES   AM-DEFN-1.
  2148             20  AM-COM-TBLS        OCCURS 10 TIMES.
  2149                 24  FILLER                PIC X(11).
  2150                 24  AM-L-COMA             PIC XXX.
  2151                 24  AM-J-COMA             PIC XXX.
  2152                 24  AM-A-COMA             PIC XXX.
  2153                 24  FILLER                PIC X(6).
  2154
  2155     12  AM-COMM-CHANGE-STATUS             PIC X.
  2156         88  AM-COMMISSIONS-CHANGED           VALUE '*'.
  2157
  2158     12  AM-CSR-CODE                       PIC X(4).
  2159
  2160     12  AM-BILLING-STATUS                 PIC X.
  2161         88  AM-ACCOUNT-BILLED                VALUE 'B'.
  2162         88  AM-ACCOUNT-NOT-BILLED            VALUE ' '.
  2163     12  AM-AUTO-REFUND-SW                 PIC X.
  2164         88  AUTO-REFUNDS-USED                VALUE 'Y'.
  2165         88  AUTO-REFUNDS-NOT-USED            VALUE 'N' ' '.
  2166     12  AM-GPCD                           PIC 99.
  2167     12  AM-IG                             PIC X.
  2168         88  AM-HAS-INDIVIDUAL                VALUE '1'.
  2169         88  AM-HAS-GROUP                     VALUE '2'.
  2170     12  AM-STATUS                         PIC X.
  2171         88  AM-ACCOUNT-ACTIVE                VALUE '0'.
  2172         88  AM-ACCOUNT-INACTIVE              VALUE '1'.
  2173         88  AM-ACCOUNT-TRANSFERRED           VALUE '2'.
  2174         88  AM-ACCOUNT-CANCELLED             VALUE '3'.
  2175         88  AM-ACCOUNT-FROZEN                VALUE '4'.
  2176         88  AM-ACCOUNT-SUSPENDED             VALUE '5'.
  2177         88  AM-ACCOUNT-DROPPED               VALUE '6'.
  2178         88  AM-ACCOUNT-LAPSED                VALUE '7'.
  2179         88  AM-ACCOUNT-RUN-OFF               VALUE '8'.
  2180         88  AM-ACCOUNT-PENDING               VALUE '9'.
  2181     12  AM-REMIT-TO                       PIC 99.
  2182     12  AM-ID-NO                          PIC X(11).
  2183
  2184     12  AM-CAL-TABLE                      PIC XX.
  2185     12  AM-LF-DEVIATION                   PIC XXX.
  2186     12  AM-AH-DEVIATION                   PIC XXX.
  2187     12  AM-LF-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2188     12  AM-AH-DEVIATION-PCT               PIC S9V9(6)    COMP-3.
  2189     12  AM-LF-OB-RATE                     PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  40
* EL6316.cbl
  2190     12  AM-AH-OB-RATE                     PIC S99V9(5)   COMP-3.
  2191     12  AM-LF-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2192     12  AM-AH-OB-RATE-JNT                 PIC S99V9(5)   COMP-3.
  2193
  2194     12  AM-USER-FIELDS.
  2195         16  AM-FLD-1                      PIC XX.
  2196         16  AM-FLD-2                      PIC XX.
  2197         16  AM-FLD-3                      PIC XX.
  2198         16  AM-FLD-4                      PIC XX.
  2199         16  AM-FLD-5                      PIC XX.
  2200
  2201     12  AM-1ST-PROD-DATE.
  2202         16  AM-1ST-PROD-YR                PIC XX.
  2203         16  AM-1ST-PROD-MO                PIC XX.
  2204         16  AM-1ST-PROD-DA                PIC XX.
  2205     12  AM-ANNIVERSARY-DATE               PIC 9(11)  COMP-3.
  2206     12  AM-CERTS-PURGED-DATE.
  2207         16  AM-PUR-YR                     PIC XX.
  2208         16  AM-PUR-MO                     PIC XX.
  2209         16  AM-PUR-DA                     PIC XX.
  2210     12  AM-HI-CERT-DATE                   PIC 9(11)  COMP-3.
  2211     12  AM-LO-CERT-DATE                   PIC 9(11)  COMP-3.
  2212     12  AM-ENTRY-DATE                     PIC 9(11)  COMP-3.
  2213     12  AM-INACTIVE-DATE.
  2214         16  AM-INA-MO                     PIC 99.
  2215         16  AM-INA-DA                     PIC 99.
  2216         16  AM-INA-YR                     PIC 99.
  2217     12  AM-AR-HI-CERT-DATE                PIC XX.
  2218
  2219     12  AM-LF-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2220     12  AM-AH-PSI-FACTOR                  PIC S9V9(6)    COMP-3.
  2221
  2222     12  AM-OB-PAYMENT-MODE                PIC X.
  2223         88  AM-OB-PAID-MONTHLY               VALUE 'M' ' '.
  2224         88  AM-OB-PAID-QUARTERLY             VALUE 'Q'.
  2225         88  AM-OB-PAID-SEMI-ANNUALLY         VALUE 'S'.
  2226         88  AM-OB-PAID-ANNUALLY              VALUE 'A'.
  2227
  2228     12  AM-AH-ONLY-INDICATOR              PIC X.
  2229         88  AM-AH-ONLY-ALLOWED               VALUE 'Y' ' '.
  2230         88  AM-NO-AH-ONLY                    VALUE 'N'.
  2231
  2232     12  AM-EDIT-LOAN-OFC                  PIC X(01).
  2233
  2234     12  AM-OVER-SHORT.
  2235         16 AM-OVR-SHT-AMT                 PIC S999V99    COMP-3.
  2236         16 AM-OVR-SHT-PCT                 PIC S9V9(4)    COMP-3.
  2237
  2238     12  AM-DCC-PRODUCT-CODE               PIC XXX.
  2239     12  AM-DCC-CLP-STATE                  PIC XX.
  2240
  2241     12  AM-RECALC-COMM                    PIC X.
  2242     12  AM-RECALC-REIN                    PIC X.
  2243
  2244     12  AM-REI-TABLE                      PIC XXX.
  2245     12  AM-REI-ET-LF                      PIC X.
  2246     12  AM-REI-ET-AH                      PIC X.
  2247     12  AM-REI-PE-LF                      PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  41
* EL6316.cbl
  2248     12  AM-REI-PE-AH                      PIC X.
  2249     12  AM-REI-PRT-ST                     PIC X.
  2250     12  AM-REI-FEE-LF                     PIC S9V9999    COMP-3.
  2251     12  AM-REI-FEE-AH                     PIC S9V9999    COMP-3.
  2252     12  AM-REI-LF-TAX                     PIC S9V9999    COMP-3.
  2253     12  AM-REI-GROUP-A                    PIC X(6).
  2254     12  AM-REI-MORT                       PIC X(4).
  2255     12  AM-REI-PRT-OW                     PIC X.
  2256     12  AM-REI-PR-PCT                     PIC S9V9999    COMP-3.
  2257     12  AM-REI-78-PCT                     PIC S9V9999    COMP-3.
  2258     12  AM-REI-AH-TAX                     PIC S9V9999    COMP-3.
  2259     12  AM-REI-GROUP-B                    PIC X(6).
  2260
  2261     12  AM-TRUST-TYPE                     PIC X(2).
  2262
  2263     12  AM-EMPLOYER-STMT-USED             PIC X.
  2264     12  AM-GROUPED-CHECKS-Y-N             PIC X.
  2265
  2266     12  AM-STD-AH-TYPE                    PIC XX.
  2267     12  AM-EARN-METHODS.
  2268         16  AM-EARN-METHOD-R              PIC X.
  2269             88 AM-REF-RL-R78                 VALUE 'R'.
  2270             88 AM-REF-RL-PR                  VALUE 'P'.
  2271             88 AM-REF-RL-MEAN                VALUE 'M'.
  2272             88 AM-REF-RL-ANTICIPATION        VALUE 'A'.
  2273         16  AM-EARN-METHOD-L              PIC X.
  2274             88 AM-REF-LL-R78                 VALUE 'R'.
  2275             88 AM-REF-LL-PR                  VALUE 'P'.
  2276             88 AM-REF-LL-MEAN                VALUE 'M'.
  2277             88 AM-REF-LL-ANTICIPATION        VALUE 'A'.
  2278         16  AM-EARN-METHOD-A              PIC X.
  2279             88 AM-REF-AH-R78                 VALUE 'R'.
  2280             88 AM-REF-AH-PR                  VALUE 'P'.
  2281             88 AM-REF-AH-MEAN                VALUE 'M'.
  2282             88 AM-REF-AH-ANTICIPATION        VALUE 'A'.
  2283             88 AM-REF-AH-CALIF-SPEC          VALUE 'C'.
  2284             88 AM-REF-AH-NET                 VALUE 'N'.
  2285
  2286     12  AM-TOL-PREM                       PIC S999V99    COMP-3.
  2287     12  AM-TOL-REF                        PIC S999V99    COMP-3.
  2288     12  AM-TOL-CLM                        PIC S999V99    COMP-3.
  2289
  2290     12  AM-RET-Y-N                        PIC X.
  2291     12  AM-RET-P-E                        PIC X.
  2292     12  AM-LF-RET                         PIC S9V9999    COMP-3.
  2293     12  AM-AH-RET                         PIC S9V9999    COMP-3.
  2294     12  AM-RET-GRP                        PIC X(6).
  2295     12  AM-RETRO-POOL  REDEFINES  AM-RET-GRP.
  2296         16  AM-POOL-PRIME                 PIC XXX.
  2297         16  AM-POOL-SUB                   PIC XXX.
  2298     12  AM-RETRO-EARNINGS.
  2299         16  AM-RET-EARN-R                 PIC X.
  2300         16  AM-RET-EARN-L                 PIC X.
  2301         16  AM-RET-EARN-A                 PIC X.
  2302     12  AM-RET-ST-TAX-USE                 PIC X.
  2303         88  CHARGE-ST-TAXES-ON-RETRO         VALUE 'Y' 'E' 'P'.
  2304         88  TAXES-NOT-IN-RETRO               VALUE 'N' ' '.
  2305     12  AM-RETRO-BEG-EARNINGS.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  42
* EL6316.cbl
  2306         16  AM-RET-BEG-EARN-R             PIC X.
  2307         16  AM-RET-BEG-EARN-L             PIC X.
  2308         16  AM-RET-BEG-EARN-A             PIC X.
  2309     12  AM-RET-MIN-LOSS-L                 PIC SV999      COMP-3.
  2310     12  AM-RET-MIN-LOSS-A                 PIC SV999      COMP-3.
  2311
  2312     12  AM-USER-SELECT-OPTIONS.
  2313         16  AM-USER-SELECT-1              PIC X(10).
  2314         16  AM-USER-SELECT-2              PIC X(10).
  2315         16  AM-USER-SELECT-3              PIC X(10).
  2316         16  AM-USER-SELECT-4              PIC X(10).
  2317         16  AM-USER-SELECT-5              PIC X(10).
  2318
  2319     12  AM-LF-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2320
  2321     12  AM-AH-RPT021-EXP-PCT              PIC S9(3)V9(4) COMP-3.
  2322
  2323     12  AM-RPT045A-SWITCH                 PIC X.
  2324         88  RPT045A-OFF                   VALUE 'N'.
  2325
  2326     12  AM-INSURANCE-LIMITS.
  2327         16  AM-MAX-MON-BEN                PIC S9(7)      COMP-3.
  2328         16  AM-MAX-TOT-BEN                PIC S9(7)      COMP-3.
  2329
  2330     12  AM-PROFILE-CHANGE-SWITCH          PIC X.
  2331         88  AM-PROFILE-DATA-CHANGED          VALUE '*'.
  2332
  2333     12  AM-DISMBR-COVERAGE-SW             PIC X.
  2334         88  AM-DISMBR-COVERAGE               VALUE 'Y'.
  2335         88  AM-NO-DISMBR-COVERAGE            VALUE 'N'.
  2336
  2337     12  AM-CANCEL-FEE                     PIC S9(3)V9(2) COMP-3.
  2338
  2339     12  AM-TOL-REF-PCT                    PIC S9V9(4)    COMP-3.
  2340     12  AM-CLP-TOL-PCT                    PIC S9V9(4)    COMP-3.
  2341     12  AM-SPP-LEASE-COMM                 PIC S9(5)V99   COMP-3.
  2342     12  AM-DCC-MAX-MARKETING-FEE          PIC S9(5)      COMP-3.
  2343     12  AM-DCC-UEF-STATE                  PIC XX.
  2344     12  FILLER                            PIC XXX.
  2345     12  AM-REPORT-CODE-3                  PIC X(10).
  2346*    12  FILLER                            PIC X(22).
  2347
  2348     12  AM-RESERVE-DATE.
  2349         16  AM-TARGET-LOSS-RATIO          PIC S9V9(4) COMP-3.
  2350         16  AM-LIFE-IBNR-PCT              PIC S9V9(4) COMP-3.
  2351         16  AM-CRDT-MODIFICATION-PCT      PIC S9V9(4) COMP-3.
  2352
  2353     12  AM-3RD-PARTY-NOTIF-LEVEL          PIC 99.
  2354     12  AM-NOTIFICATION-TYPES.
  2355         16  AM-NOTIF-OF-LETTERS           PIC X.
  2356         16  AM-NOTIF-OF-PAYMENTS          PIC X.
  2357         16  AM-NOTIF-OF-REPORTS           PIC X.
  2358         16  AM-NOTIF-OF-STATUS            PIC X.
  2359
  2360     12  AM-BENEFIT-TABLE-USAGE            PIC X.
  2361         88  AM-BENEFIT-TABLE-USED            VALUE 'Y'.
  2362         88  AM-USE-DEVIATIONS-ONLY           VALUE 'D'.
  2363         88  AM-EDIT-BENEFITS-ONLY            VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  43
* EL6316.cbl
  2364         88  AM-EDITS-NOT-USED                VALUE ' '  'N'.
  2365
  2366     12  AM-BENEFIT-CONTROLS.
  2367         16  AM-ALLOWABLE-BENEFITS  OCCURS  20  TIMES.
  2368             20  AM-BENEFIT-CODE           PIC XX.
  2369             20  AM-BENEFIT-TYPE           PIC X.
  2370             20  AM-BENEFIT-REVISION       PIC XXX.
  2371             20  AM-BENEFIT-REM-TERM       PIC X.
  2372             20  AM-BENEFIT-RETRO-Y-N      PIC X.
  2373             20  FILLER                    PIC XX.
  2374         16  FILLER                        PIC X(80).
  2375
  2376     12  AM-TRANSFER-DATA.
  2377         16  AM-TRANSFERRED-FROM.
  2378             20  AM-TRNFROM-CARRIER        PIC X.
  2379             20  AM-TRNFROM-GROUPING.
  2380                 24  AM-TRNFROM-GRP-PREFIX PIC XXX.
  2381                 24  AM-TRNFROM-GRP-PRIME  PIC XXX.
  2382             20  AM-TRNFROM-STATE          PIC XX.
  2383             20  AM-TRNFROM-ACCOUNT.
  2384                 24  AM-TRNFROM-ACCT-PREFIX PIC X(4).
  2385                 24  AM-TRNFROM-ACCT-PRIME PIC X(6).
  2386             20  AM-TRNFROM-DTE            PIC XX.
  2387         16  AM-TRANSFERRED-TO.
  2388             20  AM-TRNTO-CARRIER          PIC X.
  2389             20  AM-TRNTO-GROUPING.
  2390                 24  AM-TRNTO-GRP-PREFIX   PIC XXX.
  2391                 24  AM-TRNTO-GRP-PRIME    PIC XXX.
  2392             20  AM-TRNTO-STATE            PIC XX.
  2393             20  AM-TRNTO-ACCOUNT.
  2394                 24  AM-TRNTO-ACCT-PREFIX  PIC X(4).
  2395                 24  AM-TRNTO-ACCT-PRIME   PIC X(6).
  2396             20  AM-TRNTO-DTE              PIC XX.
  2397         16  FILLER                        PIC X(10).
  2398
  2399     12  AM-SAVED-REMIT-TO                 PIC 99.
  2400
  2401     12  AM-COMM-STRUCTURE-SAVED.
  2402         16  AM-DEFN-1-SAVED.
  2403             20  AM-AGT-COMMS-SAVED    OCCURS 10 TIMES.
  2404                 24  AM-AGT-SV             PIC X(10).
  2405                 24  AM-COM-TYP-SV         PIC X.
  2406                 24  AM-L-COM-SV           PIC SV9(5)     COMP-3.
  2407                 24  AM-J-COM-SV           PIC SV9(5)     COMP-3.
  2408                 24  AM-A-COM-SV           PIC SV9(5)     COMP-3.
  2409                 24  AM-RECALC-LV-INDIC-SV PIC X.
  2410                 24  FILLER                PIC X.
  2411                 24  AM-GL-CODES-SV        PIC X.
  2412                 24  AM-COM-CHARGEBACK-SV  PIC 99.
  2413                 24  FILLER                PIC X.
  2414         16  AM-DEFN-2-SAVED   REDEFINES   AM-DEFN-1-SAVED.
  2415             20  AM-COM-TBLS-SAVED    OCCURS 10 TIMES.
  2416                 24  FILLER                PIC X(11).
  2417                 24  AM-L-COMA-SV          PIC XXX.
  2418                 24  AM-J-COMA-SV          PIC XXX.
  2419                 24  AM-A-COMA-SV          PIC XXX.
  2420                 24  FILLER                PIC X(6).
  2421
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  44
* EL6316.cbl
  2422     12  AM-FLC-NET-PREMIUM-ALLOWANCE.
  2423         16 AM-ACCOUNT-ALLOWANCE OCCURS  5 TIMES.
  2424            20  AM-ALLOW-BEGIN-RANGE       PIC S9(5)      COMP-3.
  2425            20  AM-ALLOW-END-RANGE         PIC S9(5)      COMP-3.
  2426            20  AM-ALLOWANCE-AMT           PIC S9(5)V99   COMP-3.
  2427
  2428     12  AM-ORIG-DEALER-NO                 PIC X(10).
  2429     12  FILLER                            PIC X(120).
  2430
  2431     12  AM-ACCOUNT-EXECUTIVE-DATA.
  2432         16  AM-CONTROL-NAME               PIC X(30).
  2433         16  AM-EXECUTIVE-ONE.
  2434             20  AM-EXEC1-NAME             PIC X(15).
  2435             20  AM-EXEC1-DIS-PERCENT      PIC S9(01)V9(04)
  2436                                                          COMP-3.
  2437             20  AM-EXEC1-LIFE-PERCENT     PIC S9(01)V9(04)
  2438                                                          COMP-3.
  2439         16  AM-EXECUTIVE-TWO.
  2440             20  AM-EXEC2-NAME             PIC X(15).
  2441             20  AM-EXEC2-DIS-PERCENT      PIC S9(01)V9(04)
  2442                                                          COMP-3.
  2443             20  AM-EXEC2-LIFE-PERCENT     PIC S9(01)V9(04)
  2444                                                          COMP-3.
  2445
  2446     12  AM-RETRO-ADDITIONAL-DATA.
  2447         16  AM-RETRO-QUALIFY-LIMIT        PIC S9(7)      COMP-3.
  2448         16  AM-RETRO-PREM-P-E             PIC X.
  2449         16  AM-RETRO-CLMS-P-I             PIC X.
  2450         16  AM-RETRO-RET-BRACKET-LF.
  2451             20  AM-RETRO-RET-METHOD-LF    PIC X.
  2452                 88  AM-RETRO-USE-PCT-LF      VALUE 'P' ' '.
  2453                 88  AM-RETRO-USE-SCALE-LF    VALUE 'S'.
  2454             20  AM-RETRO-RET-BASIS-LF     PIC X.
  2455                 88  AM-RETRO-EARN-BASIS-LF   VALUE 'E' ' '.
  2456                 88  AM-RETRO-PAID-BASIS-LF   VALUE 'P'.
  2457             20  AM-RETRO-BRACKETS-LF  OCCURS  3 TIMES.
  2458                 24  AM-RETRO-RET-PCT-LF   PIC S9V9999    COMP-3.
  2459                 24  AM-RETRO-RET-THRU-LF  PIC S9(7)      COMP-3.
  2460         16  AM-RETRO-RET-BRACKET-AH.
  2461             20  AM-RETRO-RET-METHOD-AH    PIC X.
  2462                 88  AM-RETRO-USE-PCT-AH      VALUE 'P' ' '.
  2463                 88  AM-RETRO-USE-SCALE-AH    VALUE 'S'.
  2464                 88  AM-RETRO-USE-LIFE-METHOD VALUE 'L'.
  2465             20  AM-RETRO-RET-BASIS-AH     PIC X.
  2466                 88  AM-RETRO-EARN-BASIS-AH   VALUE 'E' ' '.
  2467                 88  AM-RETRO-PAID-BASIS-AH   VALUE 'P'.
  2468             20  AM-RETRO-BRACKETS-AH  OCCURS  3 TIMES.
  2469                 24  AM-RETRO-RET-PCT-AH   PIC S9V9999    COMP-3.
  2470                 24  AM-RETRO-RET-THRU-AH  PIC S9(7)      COMP-3.
  2471
  2472     12  AM-COMMENTS.
  2473         16  AM-COMMENT-LINE           PIC X(50)   OCCURS 5 TIMES.
  2474
  2475     12  AM-CLIENT-OVERLAY-FLI   REDEFINES   AM-COMMENTS.
  2476         16  AM-FLI-RETRO-SHARE-CODE       PIC X.
  2477         16  AM-FLI-BILLING-CODE           PIC X.
  2478         16  AM-FLI-ALT-STATE-CODE         PIC XX.
  2479         16  AM-FLI-UNITED-IDENT           PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  45
* EL6316.cbl
  2480         16  AM-FLI-INTEREST-LOST-DATA.
  2481             20  AM-FLI-BANK-NO            PIC X(5).
  2482             20  AM-FLI-BANK-BALANCE       PIC S9(9)V99   COMP-3.
  2483             20  AM-FLI-BANK-1ST-6-PREM    PIC S9(9)V99   COMP-3.
  2484             20  AM-FLI-BANK-CAP-AMT       PIC S9(9)V99   COMP-3.
  2485         16  AM-FLI-ALT-AGENT-CODES   OCCURS 10 TIMES.
  2486             20  AM-FLI-AGT                PIC X(9).
  2487             20  AM-FLI-AGT-COMM-ACC       PIC X.
  2488             20  AM-FLI-AGT-SHARE-PCT      PIC S9V99      COMP-3.
  2489         16  FILLER                        PIC X(102).
  2490
  2491     12  AM-CLIENT-OVERLAY-DMD   REDEFINES   AM-COMMENTS.
  2492         16  AM-ALLOWABLE-DMD-BENEFITS  OCCURS 30 TIMES.
  2493             20  AM-BENEFIT-DMD-CODE         PIC XX.
  2494             20  AM-BENEFIT-DMD-TYPE         PIC X.
  2495             20  AM-BENEFIT-DMD-REVISION     PIC XXX.
  2496             20  AM-BENEFIT-DMD-REM-TERM     PIC X.
  2497             20  AM-BENEFIT-DMD-RETRO-Y-N    PIC X.
  2498         16  FILLER                          PIC X(10).
  2499******************************************************************
  2500*                                COPY ELCCNTL.
  2501******************************************************************
  2502*                                                                *
  2503*                                                                *
  2504*                            ELCCNTL.                            *
  2505*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2506*                            VMOD=2.059                          *
  2507*                                                                *
  2508*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2509*                                                                *
  2510*   FILE TYPE = VSAM,KSDS                                        *
  2511*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2512*                                                                *
  2513*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2514*       ALTERNATE INDEX = NONE                                   *
  2515*                                                                *
  2516*   LOG = YES                                                    *
  2517*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2518******************************************************************
  2519*                   C H A N G E   L O G
  2520*
  2521* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2522*-----------------------------------------------------------------
  2523*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2524* EFFECTIVE    NUMBER
  2525*-----------------------------------------------------------------
  2526* 082503                   PEMA  ADD BENEFIT GROUP
  2527* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2528* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2529* 092705    2005050300006  PEMA  ADD SPP LEASES
  2530* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2531* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2532* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2533* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2534* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2535* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2536* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2537* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  46
* EL6316.cbl
  2538* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2539* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2540* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2541******************************************************************
  2542*
  2543 01  CONTROL-FILE.
  2544     12  CF-RECORD-ID                       PIC XX.
  2545         88  VALID-CF-ID                        VALUE 'CF'.
  2546
  2547     12  CF-CONTROL-PRIMARY.
  2548         16  CF-COMPANY-ID                  PIC XXX.
  2549         16  CF-RECORD-TYPE                 PIC X.
  2550             88  CF-COMPANY-MASTER              VALUE '1'.
  2551             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2552             88  CF-STATE-MASTER                VALUE '3'.
  2553             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2554             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2555             88  CF-CARRIER-MASTER              VALUE '6'.
  2556             88  CF-MORTALITY-MASTER            VALUE '7'.
  2557             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
  2558             88  CF-TERMINAL-MASTER             VALUE '9'.
  2559             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2560             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2561             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2562             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2563             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2564             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2565             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2566             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2567             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2568         16  CF-ACCESS-CD-GENL              PIC X(4).
  2569         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2570             20  CF-PROCESSOR               PIC X(4).
  2571         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2572             20  CF-STATE-CODE              PIC XX.
  2573             20  FILLER                     PIC XX.
  2574         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2575             20  FILLER                     PIC XX.
  2576             20  CF-HI-BEN-IN-REC           PIC XX.
  2577         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2578             20  FILLER                     PIC XXX.
  2579             20  CF-CARRIER-CNTL            PIC X.
  2580         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2581             20  FILLER                     PIC XX.
  2582             20  CF-HI-TYPE-IN-REC          PIC 99.
  2583         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2584             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2585                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2586             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2587             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2588         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2589             20  FILLER                     PIC X.
  2590             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2591         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2592             20  FILLER                     PIC XX.
  2593             20  CF-MORTGAGE-PLAN           PIC XX.
  2594         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2595
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  47
* EL6316.cbl
  2596     12  CF-LAST-MAINT-DT                   PIC XX.
  2597     12  CF-LAST-MAINT-BY                   PIC X(4).
  2598     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2599
  2600     12  CF-RECORD-BODY                     PIC X(728).
  2601
  2602
  2603****************************************************************
  2604*             COMPANY MASTER RECORD                            *
  2605****************************************************************
  2606
  2607     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2608         16  CF-COMPANY-ADDRESS.
  2609             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2610             20  CF-CL-IN-CARE-OF           PIC X(30).
  2611             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2612             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2613             20  CF-CL-CITY-STATE           PIC X(30).
  2614             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2615             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
  2616         16  CF-COMPANY-CD                  PIC X.
  2617         16  CF-COMPANY-PASSWORD            PIC X(8).
  2618         16  CF-SECURITY-OPTION             PIC X.
  2619             88  ALL-SECURITY                   VALUE '1'.
  2620             88  COMPANY-VERIFY                 VALUE '2'.
  2621             88  PROCESSOR-VERIFY               VALUE '3'.
  2622             88  NO-SECURITY                    VALUE '4'.
  2623             88  ALL-BUT-TERM                   VALUE '5'.
  2624         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2625             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2626         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2627             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2628         16  CF-INFORCE-LOCATION            PIC X.
  2629             88  CERTS-ARE-ONLINE               VALUE '1'.
  2630             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2631             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2632         16  CF-LOWER-CASE-LETTERS          PIC X.
  2633         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2634             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2635             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2636             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2637             88  CF-ACCNT-CNTL                  VALUE '3'.
  2638             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2639
  2640         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2641         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2642
  2643         16  CF-LGX-CREDIT-USER             PIC X.
  2644             88  CO-IS-NOT-USER                 VALUE 'N'.
  2645             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2646
  2647         16 CF-CREDIT-CALC-CODES.
  2648             20  CF-CR-REM-TERM-CALC PIC X.
  2649               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2650               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2651               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2652               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2653               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  48
* EL6316.cbl
  2654               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2655               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2656             20  CF-CR-R78-METHOD           PIC X.
  2657               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2658               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2659
  2660         16  CF-CLAIM-CONTROL-COUNTS.
  2661             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2662                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2663
  2664             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2665                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2666
  2667             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2668                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2669
  2670             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2671                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2672
  2673         16  CF-CURRENT-MONTH-END           PIC XX.
  2674
  2675         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2676             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2677             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2678             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2679             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2680                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2681                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2682             20  CF-CO-PREM-REJECT-SW       PIC X.
  2683                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2684                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2685             20  CF-CO-REF-REJECT-SW        PIC X.
  2686                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2687                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2688
  2689         16  CF-CO-REPORTING-DT             PIC XX.
  2690         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2691         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2692           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2693           88  CF-CO-MONTH-END                  VALUE '1'.
  2694
  2695         16  CF-LGX-CLAIM-USER              PIC X.
  2696             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2697             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2698
  2699         16  CF-CREDIT-EDIT-CONTROLS.
  2700             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2701             20  CF-MIN-AGE                 PIC 99.
  2702             20  CF-DEFAULT-AGE             PIC 99.
  2703             20  CF-MIN-TERM                PIC S999      COMP-3.
  2704             20  CF-MAX-TERM                PIC S999      COMP-3.
  2705             20  CF-DEFAULT-SEX             PIC X.
  2706             20  CF-JOINT-AGE-INPUT         PIC X.
  2707                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2708             20  CF-BIRTH-DATE-INPUT        PIC X.
  2709                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2710             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2711                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  49
* EL6316.cbl
  2712                 88  CF-ZERO-CARRIER            VALUE '1'.
  2713                 88  CF-ZERO-GROUPING           VALUE '2'.
  2714                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2715             20  CF-EDIT-SW                 PIC X.
  2716                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2717             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2718             20  CF-CR-PR-METHOD            PIC X.
  2719               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2720               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2721             20  FILLER                     PIC X.
  2722
  2723         16  CF-CREDIT-MISC-CONTROLS.
  2724             20  CF-REIN-TABLE-SW           PIC X.
  2725                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2726             20  CF-COMP-TABLE-SW           PIC X.
  2727                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2728             20  CF-EXPERIENCE-RETENTION-AGE
  2729                                            PIC S9        COMP-3.
  2730             20  CF-CONVERSION-DT           PIC XX.
  2731             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
  2732             20  CF-RUN-FREQUENCY-SW        PIC X.
  2733                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2734                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2735
  2736             20  CF-CR-CHECK-NO-CONTROL.
  2737                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2738                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2739                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2740                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2741                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2742                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2743
  2744                 24  CF-CR-CHECK-COUNT       REDEFINES
  2745                     CF-CR-CHECK-COUNTER      PIC X(4).
  2746
  2747                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2748                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2749
  2750                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2751                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2752                 24  CF-MAIL-PROCESSING       PIC X.
  2753                     88  MAIL-PROCESSING          VALUE 'Y'.
  2754
  2755         16  CF-MISC-SYSTEM-CONTROL.
  2756             20  CF-SYSTEM-C                 PIC X.
  2757                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2758             20  CF-SYSTEM-D                 PIC X.
  2759                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2760             20  CF-SOC-SEC-NO-SW            PIC X.
  2761                 88  SOC-SEC-NO-USED             VALUE '1'.
  2762             20  CF-MEMBER-NO-SW             PIC X.
  2763                 88  MEMBER-NO-USED              VALUE '1'.
  2764             20  CF-TAX-ID-NUMBER            PIC X(11).
  2765             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2766             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2767                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2768                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2769                 88  CF-ALL-APPROVED             VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  50
* EL6316.cbl
  2770                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2771             20  CF-SYSTEM-E                 PIC X.
  2772                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2773
  2774         16  CF-LGX-LIFE-USER               PIC X.
  2775             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2776             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2777
  2778         16  CF-CR-MONTH-END-DT             PIC XX.
  2779
  2780         16  CF-FILE-MAINT-DATES.
  2781             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2782                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2783             20  CF-LAST-BATCH       REDEFINES
  2784                 CF-LAST-BATCH-NO               PIC X(4).
  2785             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2786             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2787             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2788             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2789             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
  2790             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2791             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2792             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2793             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2794             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2795
  2796         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2797         16  FILLER                         PIC X.
  2798
  2799         16  CF-ALT-MORT-CODE               PIC X(4).
  2800         16  CF-MEMBER-CAPTION              PIC X(10).
  2801
  2802         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2803             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2804             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2805             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2806             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2807             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2808
  2809         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2810
  2811         16  CF-LIFE-OVERRIDE-L1            PIC X.
  2812         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  2813         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  2814         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  2815
  2816         16  CF-AH-OVERRIDE-L1              PIC X.
  2817         16  CF-AH-OVERRIDE-L2              PIC XX.
  2818         16  CF-AH-OVERRIDE-L6              PIC X(6).
  2819         16  CF-AH-OVERRIDE-L12             PIC X(12).
  2820
  2821         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  2822         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  2823
  2824         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  2825         16  CF-AR-LAST-EL860-DT            PIC XX.
  2826         16  CF-MP-MONTH-END-DT             PIC XX.
  2827
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  51
* EL6316.cbl
  2828         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  2829         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  2830             88  CF-CLAIM-PAID-TO               VALUE '1'.
  2831
  2832         16  CF-AR-MONTH-END-DT             PIC XX.
  2833
  2834         16  CF-CRDTCRD-USER                PIC X.
  2835             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  2836             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  2837
  2838         16  CF-CC-MONTH-END-DT             PIC XX.
  2839
  2840         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  2841
  2842         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  2843             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  2844             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  2845             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  2846         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  2847         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
  2848         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  2849         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  2850             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  2851             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  2852         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  2853         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  2854         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  2855             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  2856         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  2857
  2858         16  CF-CL-ZIP-CODE.
  2859             20  CF-CL-ZIP-PRIME.
  2860                 24  CF-CL-ZIP-1ST          PIC X.
  2861                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  2862                 24  FILLER                 PIC X(4).
  2863             20  CF-CL-ZIP-PLUS4            PIC X(4).
  2864         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  2865             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  2866             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  2867             20  FILLER                     PIC XXX.
  2868
  2869         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  2870         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  2871         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  2872         16  CF-CO-OPTION-START-DATE        PIC XX.
  2873         16  CF-REM-TRM-CALC-OPTION         PIC X.
  2874           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  2875                                                      '3' '4'.
  2876           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  2877           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  2878           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  2879           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  2880           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  2881           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  2882
  2883         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  2884
  2885         16  CF-PAYMENT-APPROVAL-LEVELS.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  52
* EL6316.cbl
  2886             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  2887             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  2888             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  2889             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  2890             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  2891             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  2892
  2893         16  CF-END-USER-REPORTING-USER     PIC X.
  2894             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  2895             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  2896
  2897         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  2898             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  2899             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  2900
  2901         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  2902
  2903         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  2904         16  FILLER                         PIC X.
  2905
  2906         16  CF-CREDIT-ARCHIVE-CNTL.
  2907             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  2908             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  2909             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  2910
  2911         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  2912
  2913         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  2914             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  2915             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  2916
  2917         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  2918             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  2919             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  2920
  2921         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  2922
  2923         16  CF-CO-ACH-ID-CODE              PIC  X.
  2924             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  2925             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  2926             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  2927         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  2928         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  2929         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  2930         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  2931         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  2932         16  CF-CO-ACH-RECV-NO              PIC X(08).
  2933         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  2934         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  2935         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  2936                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  2937         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  2938                 CF-CO-ACH-TRACE-NO         PIC X(4).
  2939
  2940         16  CF-CO-OVER-SHORT.
  2941             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  2942             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  2943
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  53
* EL6316.cbl
  2944*         16  FILLER                         PIC X(102).
  2945         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  2946             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  2947             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  2948
  2949         16  CF-AH-APPROVAL-DAYS.
  2950             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  2951             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  2952             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  2953             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  2954
  2955         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  2956
  2957         16  CF-APPROV-LEV-5.
  2958             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  2959             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  2960             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  2961
  2962         16  FILLER                         PIC X(68).
  2963****************************************************************
  2964*             PROCESSOR/USER RECORD                            *
  2965****************************************************************
  2966
  2967     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2968         16  CF-PROCESSOR-NAME              PIC X(30).
  2969         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  2970         16  CF-PROCESSOR-TITLE             PIC X(26).
  2971         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  2972                 88  MESSAGE-YES                VALUE 'Y'.
  2973                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  2974
  2975*****************************************************
  2976****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  2977****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  2978****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  2979****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  2980*****************************************************
  2981
  2982         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  2983             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  2984             20  CF-APPLICATION-FORCE       PIC X.
  2985             20  CF-INDIVIDUAL-APP.
  2986                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  2987                     28  CF-BROWSE-APP      PIC X.
  2988                     28  CF-UPDATE-APP      PIC X.
  2989
  2990         16  CF-CURRENT-TERM-ON             PIC X(4).
  2991         16  CF-PROCESSOR-LIMITS-CLAIMS.
  2992             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  2993             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  2994             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  2995             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  2996             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  2997             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  2998             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  2999         16  CF-PROCESSOR-CARRIER           PIC X.
  3000             88  NO-CARRIER-SECURITY            VALUE ' '.
  3001         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  54
* EL6316.cbl
  3002             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3003         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3004             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3005         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3006             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3007
  3008         16  CF-PROC-SYS-ACCESS-SW.
  3009             20  CF-PROC-CREDIT-CLAIMS-SW.
  3010                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3011                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3012                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3013                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3014             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3015                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3016                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3017             20  CF-PROC-LIFE-GNRLDGR-SW.
  3018                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3019                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3020                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3021                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
  3022             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3023                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3024                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3025         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3026             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3027             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3028         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3029
  3030         16  CF-APPROVAL-LEVEL                  PIC X.
  3031             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3032             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3033             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3034             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3035             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3036
  3037         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3038
  3039         16  CF-LANGUAGE-TYPE                   PIC X.
  3040             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3041             88  CF-LANG-IS-FR                      VALUE 'F'.
  3042
  3043         16  CF-CSR-IND                         PIC X.
  3044         16  FILLER                             PIC X(239).
  3045
  3046****************************************************************
  3047*             PROCESSOR/REMINDERS RECORD                       *
  3048****************************************************************
  3049
  3050     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3051         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3052             20  CF-START-REMIND-DT         PIC XX.
  3053             20  CF-END-REMIND-DT           PIC XX.
  3054             20  CF-REMINDER-TEXT           PIC X(50).
  3055         16  FILLER                         PIC X(296).
  3056
  3057
  3058****************************************************************
  3059*             STATE MASTER RECORD                              *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  55
* EL6316.cbl
  3060****************************************************************
  3061
  3062     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3063         16  CF-STATE-ABBREVIATION          PIC XX.
  3064         16  CF-STATE-NAME                  PIC X(25).
  3065         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3066         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3067             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3068             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3069             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3070             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3071                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3072                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3073             20  CF-ST-PREM-REJECT-SW       PIC X.
  3074                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3075                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3076             20  CF-ST-REF-REJECT-SW        PIC X.
  3077                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3078                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3079         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
  3080         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3081         16  CF-ST-REFUND-RULES.
  3082             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3083             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3084             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3085         16  CF-ST-FST-PMT-EXTENSION.
  3086             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3087             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3088                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3089                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3090                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3091                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3092         16  CF-ST-STATE-CALL.
  3093             20  CF-ST-CALL-UNEARNED        PIC X.
  3094             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3095             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3096         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3097             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3098             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3099         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3100         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3101         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3102         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3103         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3104         16  FILLER                         PIC X.
  3105         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3106             20  CF-ST-BENEFIT-CD           PIC XX.
  3107             20  CF-ST-BENEFIT-KIND         PIC X.
  3108                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3109                 88  CF-ST-AH-KIND              VALUE 'A'.
  3110             20  CF-ST-REM-TERM-CALC        PIC X.
  3111                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3112                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3113                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3114                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3115                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3116                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3117                 88  ST-EARN-AFTER-14TH         VALUE '6'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  56
* EL6316.cbl
  3118                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3119
  3120             20  CF-ST-REFUND-CALC          PIC X.
  3121                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3122                 88  ST-REFD-BY-R78             VALUE '1'.
  3123                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3124                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3125                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3126                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3127                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3128                 88  ST-REFD-UTAH               VALUE '7'.
  3129                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3130                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3131                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3132
  3133             20  CF-ST-EARNING-CALC         PIC X.
  3134                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3135                 88  ST-EARN-BY-R78             VALUE '1'.
  3136                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3137                 88  ST-EARN-AS-CALIF           VALUE '3'.
  3138                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3139                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3140                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3141                 88  ST-EARN-MEAN               VALUE '8'.
  3142                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3143
  3144             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3145                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3146                 88  ST-OVRD-BY-R78             VALUE '1'.
  3147                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3148                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3149                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3150                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3151                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3152                 88  ST-OVRD-MEAN               VALUE '8'.
  3153                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3154             20  cf-st-extra-periods        pic 9.
  3155*            20  FILLER                     PIC X.
  3156
  3157         16  CF-ST-COMMISSION-CAPS.
  3158             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3159             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3160             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3161             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3162         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3163                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3164                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  3165                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  3166
  3167         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3168
  3169         16  CF-ST-STATUTORY-INTEREST.
  3170             20  CF-ST-STAT-DATE-FROM       PIC X.
  3171                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3172                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3173             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3174             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3175             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  57
* EL6316.cbl
  3176             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3177             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3178
  3179         16  CF-ST-OVER-SHORT.
  3180             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3181             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3182
  3183         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3184
  3185         16  CF-ST-RT-CALC                  PIC X.
  3186
  3187         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3188         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3189         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3190         16  CF-ST-RF-LR-CALC               PIC X.
  3191         16  CF-ST-RF-LL-CALC               PIC X.
  3192         16  CF-ST-RF-LN-CALC               PIC X.
  3193         16  CF-ST-RF-AH-CALC               PIC X.
  3194         16  CF-ST-RF-CP-CALC               PIC X.
  3195*        16  FILLER                         PIC X(206).
  3196*CIDMOD         16  FILLER                         PIC X(192).
  3197         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3198             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3199         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3200         16  CF-ST-VFY-2ND-BENE             PIC X.
  3201         16  CF-ST-CAUSAL-STATE             PIC X.
  3202         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3203         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3204         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3205             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3206         16  CF-ST-NET-ONLY-STATE           PIC X.
  3207             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3208         16  cf-commission-cap-required     pic x.
  3209         16  CF-ST-GA-COMMISSION-CAPS.
  3210             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  3211             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  3212             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  3213             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  3214         16  CF-ST-TOT-COMMISSION-CAPS.
  3215             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  3216             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  3217             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  3218             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  3219         16  FILLER                         PIC X(156).
  3220
  3221****************************************************************
  3222*             BENEFIT MASTER RECORD                            *
  3223****************************************************************
  3224
  3225     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3226         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3227             20  CF-BENEFIT-CODE            PIC XX.
  3228             20  CF-BENEFIT-NUMERIC  REDEFINES
  3229                 CF-BENEFIT-CODE            PIC XX.
  3230             20  CF-BENEFIT-ALPHA           PIC XXX.
  3231             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3232             20  CF-BENEFIT-COMMENT         PIC X(10).
  3233
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  58
* EL6316.cbl
  3234             20  CF-LF-COVERAGE-TYPE        PIC X.
  3235                 88  CF-REDUCING                VALUE 'R'.
  3236                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3237
  3238             20  CF-SPECIAL-CALC-CD         PIC X.
  3239                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3240                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3241                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3242                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3243                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3244                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3245                 88  CF-FARM-PLAN               VALUE 'F'.
  3246                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3247                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3248                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3249                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3250                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3251                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3252                 88  CF-PRUDENTIAL              VALUE 'P'.
  3253                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
  3254                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3255                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3256                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3257                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3258                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3259
  3260             20  CF-JOINT-INDICATOR         PIC X.
  3261                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3262
  3263*            20  FILLER                     PIC X(12).
  3264             20  cf-maximum-benefits        pic s999 comp-3.
  3265             20  FILLER                     PIC X(09).
  3266             20  CF-BENEFIT-CATEGORY        PIC X.
  3267             20  CF-LOAN-TYPE               PIC X(8).
  3268
  3269             20  CF-CO-REM-TERM-CALC        PIC X.
  3270                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3271                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3272                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3273                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3274                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3275
  3276             20  CF-CO-EARNINGS-CALC        PIC X.
  3277                 88  CO-EARN-BY-R78             VALUE '1'.
  3278                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3279                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3280                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3281                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3282                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3283                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3284                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3285
  3286             20  CF-CO-REFUND-CALC          PIC X.
  3287                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3288                 88  CO-REFD-BY-R78             VALUE '1'.
  3289                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3290                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3291                 88  CO-REFD-AS-TEXAS           VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  59
* EL6316.cbl
  3292                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3293                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3294                 88  CO-REFD-MEAN               VALUE '8'.
  3295                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3296                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3297                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3298
  3299             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3300                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3301                 88  CO-OVRD-BY-R78             VALUE '1'.
  3302                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3303                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3304                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3305                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3306                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3307                 88  CO-OVRD-MEAN               VALUE '8'.
  3308                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3309
  3310             20  CF-CO-BEN-I-G-CD           PIC X.
  3311                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
  3312                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3313                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3314
  3315         16  FILLER                         PIC X(304).
  3316
  3317
  3318****************************************************************
  3319*             CARRIER MASTER RECORD                            *
  3320****************************************************************
  3321
  3322     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3323         16  CF-ADDRESS-DATA.
  3324             20  CF-MAIL-TO-NAME            PIC X(30).
  3325             20  CF-IN-CARE-OF              PIC X(30).
  3326             20  CF-ADDRESS-LINE-1          PIC X(30).
  3327             20  CF-ADDRESS-LINE-2          PIC X(30).
  3328             20  CF-CITY-STATE              PIC X(30).
  3329             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3330             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3331
  3332         16  CF-CLAIM-NO-CONTROL.
  3333             20  CF-CLAIM-NO-METHOD         PIC X.
  3334                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3335                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3336                 88  CLAIM-NO-SEQ               VALUE '3'.
  3337                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3338             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3339                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3340                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3341                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3342
  3343         16  CF-CHECK-NO-CONTROL.
  3344             20  CF-CHECK-NO-METHOD         PIC X.
  3345                 88  CHECK-NO-MANUAL            VALUE '1'.
  3346                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3347                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3348                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3349             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  60
* EL6316.cbl
  3350                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3351
  3352         16  CF-DOMICILE-STATE              PIC XX.
  3353
  3354         16  CF-EXPENSE-CONTROLS.
  3355             20  CF-EXPENSE-METHOD          PIC X.
  3356                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3357                 88  DOLLARS-PER-PMT            VALUE '2'.
  3358                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3359                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3360             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3361             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3362
  3363         16  CF-CORRESPONDENCE-CONTROL.
  3364             20  CF-LETTER-RESEND-OPT       PIC X.
  3365                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3366                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3367             20  FILLER                     PIC X(4).
  3368
  3369         16  CF-RESERVE-CONTROLS.
  3370             20  CF-MANUAL-SW               PIC X.
  3371                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3372             20  CF-FUTURE-SW               PIC X.
  3373                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3374             20  CF-PTC-SW                  PIC X.
  3375                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3376             20  CF-IBNR-SW                 PIC X.
  3377                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3378             20  CF-PTC-LF-SW               PIC X.
  3379                 88  CF-LF-PTC-USED             VALUE '1'.
  3380             20  CF-CDT-ACCESS-METHOD       PIC X.
  3381                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3382                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3383                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3384             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3385
  3386         16  CF-CLAIM-CALC-METHOD           PIC X.
  3387             88  360-PLUS-MONTHS                VALUE '1'.
  3388             88  365-PLUS-MONTHS                VALUE '2'.
  3389             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3390             88  360-DAILY                      VALUE '4'.
  3391             88  365-DAILY                      VALUE '5'.
  3392
  3393         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3394         16  FILLER                         PIC X(11).
  3395
  3396         16  CF-LIMIT-AMOUNTS.
  3397             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3398             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3399             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3400             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3401             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3402             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3403             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3404             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3405             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3406             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3407
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  61
* EL6316.cbl
  3408         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3409         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3410         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3411
  3412         16  CF-ZIP-CODE.
  3413             20  CF-ZIP-PRIME.
  3414                 24  CF-ZIP-1ST             PIC X.
  3415                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3416                 24  FILLER                 PIC X(4).
  3417             20  CF-ZIP-PLUS4               PIC X(4).
  3418         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3419             20  CF-CAN-POSTAL-1            PIC XXX.
  3420             20  CF-CAN-POSTAL-2            PIC XXX.
  3421             20  FILLER                     PIC XXX.
  3422
  3423         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3424         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3425         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3426
  3427         16  CF-RATING-SWITCH               PIC X.
  3428             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3429             88  CF-NO-RATING                   VALUE 'N'.
  3430
  3431         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3432
  3433         16  CF-CARRIER-OVER-SHORT.
  3434             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3435             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3436
  3437         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3438         16  CF-SECPAY-SWITCH               PIC X.
  3439             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3440             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3441         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3442         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3443         16  FILLER                         PIC X(444).
  3444*        16  FILLER                         PIC X(452).
  3445
  3446
  3447****************************************************************
  3448*             MORTALITY MASTER RECORD                          *
  3449****************************************************************
  3450
  3451     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3452         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3453                                INDEXED BY CF-MORT-NDX.
  3454             20  CF-MORT-TABLE              PIC X(5).
  3455             20  CF-MORT-TABLE-TYPE         PIC X.
  3456                 88  CF-MORT-JOINT              VALUE 'J'.
  3457                 88  CF-MORT-SINGLE             VALUE 'S'.
  3458                 88  CF-MORT-COMBINED           VALUE 'C'.
  3459                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3460                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3461             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3462             20  CF-MORT-AGE-METHOD         PIC XX.
  3463                 88  CF-AGE-LAST                VALUE 'AL'.
  3464                 88  CF-AGE-NEAR                VALUE 'AN'.
  3465             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  62
* EL6316.cbl
  3466             20  CF-MORT-ADJUSTMENT-DIRECTION
  3467                                            PIC X.
  3468                 88  CF-MINUS                   VALUE '-'.
  3469                 88  CF-PLUS                    VALUE '+'.
  3470             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3471             20  CF-MORT-JOINT-CODE         PIC X.
  3472                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3473             20  CF-MORT-PC-Q               PIC X.
  3474                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3475             20  CF-MORT-TABLE-CODE         PIC X(4).
  3476             20  CF-MORT-COMMENTS           PIC X(15).
  3477             20  FILLER                     PIC X(14).
  3478
  3479         16  FILLER                         PIC X(251).
  3480
  3481
  3482****************************************************************
  3483*             BUSSINESS TYPE MASTER RECORD                     *
  3484****************************************************************
  3485
  3486     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3487* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3488* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3489* AND RECORD 05 IS TYPES 81-99
  3490         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3491             20  CF-BUSINESS-TITLE          PIC  X(19).
  3492             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3493                                            PIC S9V9(4) COMP-3.
  3494             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3495             20  FILLER                     PIC  X.
  3496         16  FILLER                         PIC  X(248).
  3497
  3498
  3499****************************************************************
  3500*             TERMINAL MASTER RECORD                           *
  3501****************************************************************
  3502
  3503     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3504
  3505         16  CF-COMPANY-TERMINALS.
  3506             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3507                                  PIC X(4).
  3508         16  FILLER               PIC X(248).
  3509
  3510
  3511****************************************************************
  3512*             LIFE EDIT MASTER RECORD                          *
  3513****************************************************************
  3514
  3515     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3516         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3517             20  CF-LIFE-CODE-IN            PIC XX.
  3518             20  CF-LIFE-CODE-OUT           PIC XX.
  3519         16  FILLER                         PIC X(248).
  3520
  3521
  3522****************************************************************
  3523*             AH EDIT MASTER RECORD                            *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  63
* EL6316.cbl
  3524****************************************************************
  3525
  3526     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3527         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3528             20  CF-AH-CODE-IN              PIC XXX.
  3529             20  CF-AH-CODE-OUT             PIC XX.
  3530         16  FILLER                         PIC X(248).
  3531
  3532
  3533****************************************************************
  3534*             CREDIBILITY TABLES                               *
  3535****************************************************************
  3536
  3537     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3538         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3539                             INDEXED BY CF-CRDB-NDX.
  3540             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3541             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3542             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3543         16  FILLER                         PIC  X(332).
  3544
  3545
  3546****************************************************************
  3547*             REPORT CUSTOMIZATION RECORD                      *
  3548****************************************************************
  3549
  3550     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3551         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3552             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3553             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3554             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3555**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3556****       A T-TRANSFER.                                   ****
  3557             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3558
  3559         16  FILLER                         PIC XX.
  3560
  3561         16  CF-CARRIER-CNTL-OPT.
  3562             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3563                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3564                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3565             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3566                                            PIC X.
  3567         16  CF-GROUP-CNTL-OPT.
  3568             20  CF-GROUP-OPT-SEQ           PIC 9.
  3569                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3570                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3571             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3572                                            PIC X(6).
  3573         16  CF-STATE-CNTL-OPT.
  3574             20  CF-STATE-OPT-SEQ           PIC 9.
  3575                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3576                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3577             20  CF-STATE-SELECT OCCURS 3 TIMES
  3578                                            PIC XX.
  3579         16  CF-ACCOUNT-CNTL-OPT.
  3580             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3581                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  64
* EL6316.cbl
  3582                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3583             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3584                                            PIC X(10).
  3585         16  CF-BUS-TYP-CNTL-OPT.
  3586             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3587                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3588                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3589             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3590                                            PIC XX.
  3591         16  CF-LF-TYP-CNTL-OPT.
  3592             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3593                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3594                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3595             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3596                                            PIC XX.
  3597         16  CF-AH-TYP-CNTL-OPT.
  3598             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3599                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3600                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3601             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
  3602                                            PIC XX.
  3603         16  CF-REPTCD1-CNTL-OPT.
  3604             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3605                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3606                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3607             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3608                                            PIC X(10).
  3609         16  CF-REPTCD2-CNTL-OPT.
  3610             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3611                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3612                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3613             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3614                                            PIC X(10).
  3615         16  CF-USER1-CNTL-OPT.
  3616             20  CF-USER1-OPT-SEQ           PIC 9.
  3617                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3618                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3619             20  CF-USER1-SELECT OCCURS 3 TIMES
  3620                                            PIC X(10).
  3621         16  CF-USER2-CNTL-OPT.
  3622             20  CF-USER2-OPT-SEQ           PIC 9.
  3623                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3624                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3625             20  CF-USER2-SELECT OCCURS 3 TIMES
  3626                                            PIC X(10).
  3627         16  CF-USER3-CNTL-OPT.
  3628             20  CF-USER3-OPT-SEQ           PIC 9.
  3629                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3630                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3631             20  CF-USER3-SELECT OCCURS 3 TIMES
  3632                                            PIC X(10).
  3633         16  CF-USER4-CNTL-OPT.
  3634             20  CF-USER4-OPT-SEQ           PIC 9.
  3635                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3636                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3637             20  CF-USER4-SELECT OCCURS 3 TIMES
  3638                                            PIC X(10).
  3639         16  CF-USER5-CNTL-OPT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  65
* EL6316.cbl
  3640             20  CF-USER5-OPT-SEQ           PIC 9.
  3641                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3642                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3643             20  CF-USER5-SELECT OCCURS 3 TIMES
  3644                                            PIC X(10).
  3645         16  CF-REINS-CNTL-OPT.
  3646             20  CF-REINS-OPT-SEQ           PIC 9.
  3647                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3648                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3649             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3650                 24  CF-REINS-PRIME         PIC XXX.
  3651                 24  CF-REINS-SUB           PIC XXX.
  3652
  3653         16  CF-AGENT-CNTL-OPT.
  3654             20  CF-AGENT-OPT-SEQ           PIC 9.
  3655                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3656                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3657             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3658                                            PIC X(10).
  3659
  3660         16  FILLER                         PIC X(43).
  3661
  3662         16  CF-LOSS-RATIO-SELECT.
  3663             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3664             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3665         16  CF-ENTRY-DATE-SELECT.
  3666             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3667             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3668         16  CF-EFFECTIVE-DATE-SELECT.
  3669             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3670             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3671
  3672         16  CF-EXCEPTION-LIST-IND          PIC X.
  3673             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3674
  3675         16  FILLER                         PIC X(318).
  3676
  3677****************************************************************
  3678*                  EXCEPTION REPORTING RECORD                  *
  3679****************************************************************
  3680
  3681     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3682         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3683             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3684
  3685         16  CF-COMBINED-LIFE-AH-OPT.
  3686             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3687             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3688             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3689             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3690
  3691         16  CF-LIFE-OPT.
  3692             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3693             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3694             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3695             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3696             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3697             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  66
* EL6316.cbl
  3698             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3699             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3700             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3701             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3702
  3703         16  CF-AH-OPT.
  3704             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3705             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3706             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3707             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3708             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3709             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3710             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3711             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3712             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3713             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3714
  3715         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3716             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3717             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
  3718             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3719
  3720         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3721
  3722         16  FILLER                         PIC X(673).
  3723
  3724
  3725****************************************************************
  3726*             MORTGAGE SYSTEM PLAN RECORD                      *
  3727****************************************************************
  3728
  3729     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3730         16  CF-PLAN-TYPE                   PIC X.
  3731             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3732             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3733             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3734         16  CF-PLAN-ABBREV                 PIC XXX.
  3735         16  CF-PLAN-DESCRIPT               PIC X(10).
  3736         16  CF-PLAN-NOTES                  PIC X(20).
  3737         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3738         16  CF-PLAN-UNDERWRITING.
  3739             20  CF-PLAN-TERM-DATA.
  3740                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3741                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3742             20  CF-PLAN-AGE-DATA.
  3743                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3744                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3745                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3746             20  CF-PLAN-BENEFIT-DATA.
  3747                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3748                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3749                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3750                                            PIC S9(7)V99  COMP-3.
  3751         16  CF-PLAN-POLICY-FORMS.
  3752             20  CF-POLICY-FORM             PIC X(12).
  3753             20  CF-MASTER-APPLICATION      PIC X(12).
  3754             20  CF-MASTER-POLICY           PIC X(12).
  3755         16  CF-PLAN-RATING.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  67
* EL6316.cbl
  3756             20  CF-RATE-CODE               PIC X(5).
  3757             20  CF-SEX-RATING              PIC X.
  3758                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3759                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3760             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3761             20  CF-SUB-STD-TYPE            PIC X.
  3762                 88  CF-PCT-OF-PREM            VALUE '1'.
  3763                 88  CF-PCT-OF-BENE            VALUE '2'.
  3764         16  CF-PLAN-PREM-TOLERANCES.
  3765             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3766             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3767         16  CF-PLAN-PYMT-TOLERANCES.
  3768             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3769             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3770         16  CF-PLAN-MISC-DATA.
  3771             20  FILLER                     PIC X.
  3772             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3773             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3774         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3775         16  CF-PLAN-IND-GRP                PIC X.
  3776             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3777                                                     '1'.
  3778             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3779                                                     '2'.
  3780         16  CF-MIB-SEARCH-SW               PIC X.
  3781             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3782             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3783             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3784             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3785         16  CF-ALPHA-SEARCH-SW             PIC X.
  3786             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3787             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3788             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3789             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3790             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3791             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3792             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3793             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3794             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3795             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3796                                                     'A' 'B' 'C'
  3797                                                     'X' 'Y' 'Z'.
  3798         16  CF-EFF-DT-RULE-SW              PIC X.
  3799             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3800             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3801             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3802             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3803             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3804         16  FILLER                         PIC X(4).
  3805         16  CF-HEALTH-QUESTIONS            PIC X.
  3806             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3807         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3808         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3809         16  CF-PLAN-SNGL-JNT               PIC X.
  3810             88  CF-COMBINED-PLAN              VALUE 'C'.
  3811             88  CF-JNT-PLAN                   VALUE 'J'.
  3812             88  CF-SNGL-PLAN                  VALUE 'S'.
  3813         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  68
* EL6316.cbl
  3814         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  3815         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  3816         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  3817         16  CF-RERATE-CNTL                 PIC  X.
  3818             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  3819             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  3820             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  3821             88  CF-AUTO-RECALC                 VALUE '4'.
  3822         16  CF-BENEFIT-TYPE                PIC  X.
  3823             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  3824             88  CF-BENEFIT-REDUCES             VALUE '2'.
  3825         16  CF-POLICY-FEE                  PIC S999V99
  3826                                                    COMP-3.
  3827         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  3828         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  3829         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  3830         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  3831         16  FILLER                         PIC  X(32).
  3832         16  CF-TERMINATION-FORM            PIC  X(04).
  3833         16  FILLER                         PIC  X(08).
  3834         16  CF-CLAIM-CAP                   PIC S9(7)V99
  3835                                                       COMP-3.
  3836         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  3837         16  CF-ISSUE-LETTER                PIC  X(4).
  3838         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  3839         16  CF-DEPENDENT-COVERAGE          PIC  X.
  3840             88  CF-YES-DEP-COV                 VALUE 'Y'.
  3841             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  3842         16  CF-MP-REFUND-CALC              PIC X.
  3843             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  3844             88  CF-MP-REFD-BY-R78              VALUE '1'.
  3845             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  3846             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  3847             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  3848             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  3849             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  3850             88  CF-MP-REFD-MEAN                VALUE '8'.
  3851         16  CF-ALT-RATE-CODE               PIC  X(5).
  3852
  3853
  3854         16  FILLER                         PIC X(498).
  3855****************************************************************
  3856*             MORTGAGE COMPANY MASTER RECORD                   *
  3857****************************************************************
  3858
  3859     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3860         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  3861         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  3862             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  3863             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  3864             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  3865             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  3866             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  3867
  3868         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  3869         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  3870         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  3871         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  69
* EL6316.cbl
  3872         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  3873
  3874         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  3875             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  3876         16  CF-MP-RECON-USE-IND            PIC X(1).
  3877             88  CF-MP-USE-RECON             VALUE 'Y'.
  3878         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  3879             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  3880         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  3881             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  3882             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  3883         16  FILLER                         PIC X(1).
  3884         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  3885             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  3886         16  CF-MORTG-MIB-VERSION           PIC X.
  3887             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  3888             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  3889             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  3890         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  3891             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
  3892                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  3893             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  3894                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  3895             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  3896                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  3897             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  3898                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  3899             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  3900                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  3901             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  3902                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  3903         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  3904         16  FILLER                         PIC X(7).
  3905         16  CF-MORTG-DESTINATION-SYMBOL.
  3906             20  CF-MORTG-MIB-COMM          PIC X(5).
  3907             20  CF-MORTG-MIB-TERM          PIC X(5).
  3908         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  3909             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  3910         16  FILLER                         PIC X(03).
  3911         16  CF-MP-CHECK-NO-CONTROL.
  3912             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  3913                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  3914                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  3915                                                ' ' LOW-VALUES.
  3916                 88  CF-MP-CHECK-NO-PRE-PRINTED
  3917                                               VALUE '3'.
  3918         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  3919         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  3920         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  3921             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  3922                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  3923             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  3924                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  3925             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  3926                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  3927             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  3928                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  3929             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  70
* EL6316.cbl
  3930                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  3931             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  3932                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  3933         16  CF-MORTG-BILLING-AREA.
  3934             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  3935                                            PIC X.
  3936         16  CF-MORTG-MONTH-END-DT          PIC XX.
  3937         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  3938         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  3939         16  CF-MORTG-MIB-DEST-SW           PIC X.
  3940             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  3941             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  3942         16  FILLER                         PIC X.
  3943         16  CF-MORTG-LABEL-CONTROL         PIC X.
  3944             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  3945             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  3946         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  3947         16  FILLER                         PIC X(8).
  3948         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  3949         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
  3950         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  3951         16  CF-ACH-COMPANY-ID.
  3952             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  3953                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  3954                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  3955                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  3956             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  3957         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  3958             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  3959         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  3960             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  3961             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  3962         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  3963         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  3964         16  FILLER                         PIC X(536).
  3965
  3966****************************************************************
  3967*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  3968****************************************************************
  3969
  3970     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  3971         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  3972             20  CF-FEMALE-HEIGHT.
  3973                 24  CF-FEMALE-FT           PIC 99.
  3974                 24  CF-FEMALE-IN           PIC 99.
  3975             20  CF-FEMALE-MIN-WT           PIC 999.
  3976             20  CF-FEMALE-MAX-WT           PIC 999.
  3977         16  FILLER                         PIC X(428).
  3978
  3979     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  3980         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  3981             20  CF-MALE-HEIGHT.
  3982                 24  CF-MALE-FT             PIC 99.
  3983                 24  CF-MALE-IN             PIC 99.
  3984             20  CF-MALE-MIN-WT             PIC 999.
  3985             20  CF-MALE-MAX-WT             PIC 999.
  3986         16  FILLER                         PIC X(428).
  3987******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  71
* EL6316.cbl
  3988*             AUTOMATIC ACTIVITY RECORD                          *
  3989******************************************************************
  3990     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  3991         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  3992             20  CF-SYS-ACTIVE-SW           PIC X(01).
  3993             20  CF-SYS-LETTER-ID           PIC X(04).
  3994             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  3995             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  3996             20  CF-SYS-RESET-SW            PIC X(01).
  3997             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  3998             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  3999
  4000         16  FILLER                         PIC X(50).
  4001
  4002         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4003             20  CF-USER-ACTIVE-SW          PIC X(01).
  4004             20  CF-USER-LETTER-ID          PIC X(04).
  4005             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4006             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4007             20  CF-USER-RESET-SW           PIC X(01).
  4008             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4009             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4010             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4011
  4012         16  FILLER                         PIC X(246).
  4013*                                COPY ERCPNDB.
  4014******************************************************************
  4015*                                                                *
  4016*                                                                *
  4017*                            ERCPNDB.                            *
  4018*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4019*                            VMOD=2.025                          *
  4020*                                                                *
  4021*   FILE DESCRIPTION = PENDING NEW BUSINESS (ISSUES AND CANCELS) *
  4022*                                                                *
  4023******************************************************************
  4024*   NOTE: IF THIS FORMAT IS CHANGED, THE SORT RECORD IN THE      *
  4025*         EL861 A/R SYSTEM MAY NEED TO BE CHANGED.               *
  4026******************************************************************
  4027*                                                                *
  4028*                                                                *
  4029*   FILE TYPE = VSAM,KSDS                                        *
  4030*   RECORD SIZE = 585  RECFORM = FIXED                           *
  4031*                                                                *
  4032*   BASE CLUSTER = ERPNDB                         RKP=2,LEN=11   *
  4033*       ALTERNATE PATH1 = ERPNDB2  (BY CAR GRP STATE ACCOUNT     *
  4034*                                  EFF-DT CERT CHG-SEQ REC-TYPE) *
  4035*                                                 RKP=13,LEN=36  *
  4036*       ALTERNATE PATH2 = ERPNDB3  (BY CO, ORIGINAL BATCH, SEQ.  *
  4037*                                      AND CHG-SEQ.)             *
  4038*                                                RKP=49,LEN=11   *
  4039*       ALTERNATE PATH3 = ERPNDB4  (BY CO, CSR-ID, BATCH, SEQ.   *
  4040*                                      AND CHG-SEQ.)             *
  4041*                                                RKP=60,LEN=15   *
  4042*                                                                *
  4043*   LOG = NO                                                     *
  4044*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4045******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  72
* EL6316.cbl
  4046******************************************************************
  4047*                   C H A N G E   L O G
  4048*
  4049* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4050*-----------------------------------------------------------------
  4051*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4052* EFFECTIVE    NUMBER
  4053*-----------------------------------------------------------------
  4054* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4055* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  4056* 011904                   PEMA  ADD TOTAL FEE PROCESSING
  4057* 040504    2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4058* 020305    2005020000000  PEMA  ADD CLP STATE TO PNDB RECORD
  4059* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4060* 032306                   PEMA  ADD BOW LOAN NUMBER
  4061* 081606    2006080800002  PEMA  ADD VIN, ISSUES ONLY
  4062* 073107  CR2006051600002  PEMA  ADD OVERCHARGE PROCESSING
  4063* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4064* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  4065* 032109    2009021700002  PEMA  ADD CRED BENE TO PNDB REC
  4066* 072209  CR2008101500003  AJRA  ADD BORROWER FIRST NAME TO ENDORS
  4067* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4068* 071211  CR2010012700001  PEMA  ADD SPP DEALER DIRECT
  4069* 073114  CR2014012300001  PEMA  ADD CU CARRIER 7 PROCESSING
  4070* 010716    2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4071* 010517  CR2016021600005  PEMA ADD NEW FORCE CODE FOR AGG
  4072* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4073* 012220  CR2018092700002  TANA ADD LETTER REQUIRED FIELD
  4074******************************************************************
  4075
  4076 01  PENDING-BUSINESS.
  4077     12  PB-RECORD-ID                     PIC XX.
  4078         88  VALID-PB-ID                        VALUE 'PB'.
  4079
  4080     12  PB-CONTROL-PRIMARY.
  4081         16  PB-COMPANY-CD                PIC X.
  4082         16  PB-ENTRY-BATCH               PIC X(6).
  4083         16  PB-BATCH-SEQ-NO              PIC S9(4)     COMP.
  4084         16  PB-BATCH-CHG-SEQ-NO          PIC S9(4)     COMP.
  4085
  4086     12  PB-CONTROL-BY-ACCOUNT.
  4087         16  PB-COMPANY-CD-A1             PIC X.
  4088         16  PB-CARRIER                   PIC X.
  4089         16  PB-GROUPING.
  4090             20  PB-GROUPING-PREFIX       PIC XXX.
  4091             20  PB-GROUPING-PRIME        PIC XXX.
  4092         16  PB-STATE                     PIC XX.
  4093         16  PB-ACCOUNT.
  4094             20  PB-ACCOUNT-PREFIX        PIC X(4).
  4095             20  PB-ACCOUNT-PRIME         PIC X(6).
  4096         16  PB-CERT-EFF-DT               PIC XX.
  4097         16  PB-CERT-NO.
  4098             20  PB-CERT-PRIME            PIC X(10).
  4099             20  PB-CERT-SFX              PIC X.
  4100         16  PB-ALT-CHG-SEQ-NO            PIC S9(4)     COMP.
  4101
  4102         16  PB-RECORD-TYPE               PIC X.
  4103             88  PB-MAILING-DATA                VALUE '0'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  73
* EL6316.cbl
  4104             88  PB-ISSUE                       VALUE '1'.
  4105             88  PB-CANCELLATION                VALUE '2'.
  4106             88  PB-BATCH-TRAILER               VALUE '9'.
  4107
  4108     12  PB-CONTROL-BY-ORIG-BATCH.
  4109         16  PB-ORIGINAL-COMPANY-CD       PIC X.
  4110         16  PB-ORIGINAL-ENTRY-BATCH      PIC X(6).
  4111         16  PB-ORIGINAL-SEQ-NO           PIC S9(4)     COMP.
  4112         16  PB-ORIGINAL-CHG-SEQ-NO       PIC S9(4)     COMP.
  4113
  4114     12  PB-CONTROL-BY-CSR.
  4115         16  PB-CSR-COMPANY-CD            PIC X.
  4116         16  PB-CSR-ID                    PIC X(4).
  4117         16  PB-CSR-ENTRY-BATCH           PIC X(6).
  4118         16  PB-CSR-BATCH-SEQ-NO          PIC S9(4)     COMP.
  4119         16  PB-CSR-BATCH-CHG-SEQ-NO      PIC S9(4)     COMP.
  4120******************************************************************
  4121*    MAILING DATA IS PROCESSED IN ONLY PRGS. EL512 & EL513       *
  4122******************************************************************
  4123
  4124     12  PB-LAST-MAINT-DT                 PIC XX.
  4125     12  PB-LAST-MAINT-BY                 PIC X(4).
  4126     12  PB-LAST-MAINT-HHMMSS             PIC S9(6)     COMP-3.
  4127
  4128     12  PB-RECORD-BODY                   PIC X(375).
  4129
  4130     12  PB-ISSUE-RECORD   REDEFINES PB-RECORD-BODY.
  4131         16  PB-CERT-ORIGIN               PIC X.
  4132             88  CLASIC-CREATED-CERT         VALUE '1'.
  4133         16  PB-I-NAME.
  4134             20  PB-I-INSURED-LAST-NAME   PIC X(15).
  4135             20  PB-I-INSURED-FIRST-NAME.
  4136                 24  PB-I-INSURED-1ST-INIT PIC X.
  4137                 24  FILLER                PIC X(9).
  4138             20  PB-I-INSURED-MIDDLE-INIT PIC X.
  4139         16  PB-I-AGE                     PIC S99   COMP-3.
  4140         16  PB-I-JOINT-AGE               PIC S99   COMP-3.
  4141         16  PB-I-BIRTHDAY                PIC XX.
  4142         16  PB-I-INSURED-SEX             PIC X.
  4143             88  PB-SEX-MALE     VALUE 'M'.
  4144             88  PB-SEX-FEMALE   VALUE 'F'.
  4145
  4146         16  PB-I-LF-TERM                 PIC S999   COMP-3.
  4147         16  PB-I-AH-TERM                 PIC S999   COMP-3.
  4148         16  PB-I-LOAN-TERM               PIC S999   COMP-3.
  4149         16  PB-I-PAY-FREQUENCY           PIC S99    COMP-3.
  4150         16  PB-I-SKIP-CODE               PIC X.
  4151             88  PB-NO-MONTHS-SKIPPED      VALUE ' ' '0'.
  4152             88  PB-SKIP-JULY              VALUE '1'.
  4153             88  PB-SKIP-AUGUST            VALUE '2'.
  4154             88  PB-SKIP-SEPTEMBER         VALUE '3'.
  4155             88  PB-SKIP-JULY-AUG          VALUE '4'.
  4156             88  PB-SKIP-AUG-SEPT          VALUE '5'.
  4157             88  PB-SKIP-JULY-AUG-SEPT     VALUE '6'.
  4158             88  PB-SKIP-JUNE-JULY-AUG     VALUE '7'.
  4159             88  PB-SKIP-JUNE              VALUE '8'.
  4160             88  PB-SKIP-JUNE-JULY         VALUE '9'.
  4161             88  PB-SKIP-AUG-SEPT-OCT      VALUE 'A'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  74
* EL6316.cbl
  4162             88  PB-SKIP-BI-WKLY-3RD-PMT   VALUE 'X'.
  4163         16  PB-I-TERM-TYPE               PIC X.
  4164             88  PB-PAID-MONTHLY           VALUE ' ' 'M'.
  4165             88  PB-PAID-WEEKLY            VALUE 'W'.
  4166             88  PB-PAID-SEMI-MONTHLY      VALUE 'S'.
  4167             88  PB-PAID-BI-WEEKLY         VALUE 'B'.
  4168             88  PB-PAID-13-YEARLY         VALUE 'T'.
  4169         16  PB-I-NO-OF-PAYMENTS          PIC S999   COMP-3.
  4170         16  PB-I-POLICY-FORM-NO          PIC X(12).
  4171         16  PB-I-DATA-ENTRY-SW           PIC X.
  4172             88  PB-EFF-DT-PROCESSING      VALUE '1' ' '.
  4173             88  PB-EXT-DAYS-PROCESSING    VALUE '2'.
  4174             88  PB-EXPIRE-DT-PROCESSING   VALUE '3'.
  4175             88  PB-1ST-PMT-DT-PROCESSING  VALUE '4'.
  4176         16  PB-I-PAYMENT-AMOUNT          PIC S9(7)V99  COMP-3.
  4177         16  PB-I-DCC-OVER-CHG-AMT        PIC S9(5)V99  COMP-3.
  4178*        16  PB-I-MICROFILM-NO            PIC S9(9)      COMP-3.
  4179         16  PB-I-AH-CLP                  PIC S9(5)V99 COMP-3.
  4180         16  PB-I-LETTER-REQD             PIC X.
  4181
  4182         16  PB-I-LIFE-BENEFIT-CD         PIC XX.
  4183             88  PB-VALID-LIFE               VALUE '01' THRU '89'.
  4184             88  PB-INVALID-LIFE             VALUE '  ' '00'
  4185                                                   '90' THRU '99'.
  4186         16  PB-I-LF-BENEFIT-CD   REDEFINES PB-I-LIFE-BENEFIT-CD
  4187                                          PIC XX.
  4188         16  PB-I-LF-BENEFIT-AMT          PIC S9(9)V99   COMP-3.
  4189         16  PB-I-AMOUNT-FINANCED REDEFINES
  4190                  PB-I-LF-BENEFIT-AMT     PIC S9(9)V99   COMP-3.
  4191         16  PB-I-LF-ALT-BENEFIT-AMT      PIC S9(9)V99   COMP-3.
  4192         16  PB-I-UNPAID-CASH-PRICE REDEFINES
  4193                  PB-I-LF-ALT-BENEFIT-AMT PIC S9(9)V99   COMP-3.
  4194         16  PB-I-LF-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4195         16  PB-I-LF-ALT-PREMIUM-AMT      PIC S9(7)V99   COMP-3.
  4196         16  PB-I-CLP-AMOUNT REDEFINES
  4197                  PB-I-LF-ALT-PREMIUM-AMT PIC S9(7)V99   COMP-3.
  4198         16  PB-I-LF-CALC-FLAG            PIC X.
  4199             88 PB-COMP-LF-PREM               VALUE '?'.
  4200         16  PB-I-LF-PREM-CALC            PIC S9(7)V99   COMP-3.
  4201         16  PB-I-LF-ALT-PREM-CALC        PIC S9(7)V99   COMP-3.
  4202         16  PB-I-LF-RATE                 PIC S99V9(5)   COMP-3.
  4203         16  PB-I-LF-ALT-RATE             PIC S99V9(5)   COMP-3.
  4204         16  PB-I-LF-POLICY-FEE           PIC S9(3)V99   COMP-3.
  4205         16  PB-I-LF-REI-RATE             PIC S99V9(5)   COMP-3.
  4206         16  PB-I-LF-ALT-REI-RATE         PIC S99V9(5)   COMP-3.
  4207         16  PB-I-LF-ABBR                 PIC XXX.
  4208         16  PB-I-LF-INPUT-CD             PIC XX.
  4209
  4210         16  PB-I-AH-BENEFIT-CD           PIC XX.
  4211             88  PB-VALID-AH                 VALUE '01' THRU '89'.
  4212             88  PB-INVALID-AH               VALUE '  ' '00'
  4213                                                   '90' THRU '99'.
  4214         16  PB-I-AH-BENEFIT-AMT          PIC S9(7)V99   COMP-3.
  4215         16  PB-I-AH-PREMIUM-AMT          PIC S9(7)V99   COMP-3.
  4216         16  PB-I-AH-CALC-FLAG            PIC X.
  4217             88 PB-COMP-AH-PREM                  VALUE '?'.
  4218         16  PB-I-AH-PREM-CALC            PIC S9(7)V99   COMP-3.
  4219         16  PB-I-AH-RATE                 PIC S99V9(5)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  75
* EL6316.cbl
  4220         16  PB-I-CANCEL-FEE              PIC S9(3)V99   COMP-3.
  4221         16  PB-I-AH-REI-RATE             PIC S99V9(5)   COMP-3.
  4222         16  PB-I-AH-RATE-TRM             PIC S999       COMP-3.
  4223         16  PB-I-AH-ABBR                 PIC XXX.
  4224         16  PB-I-AH-INPUT-CD             PIC XXX.
  4225
  4226         16  PB-I-SPECIAL-REIN-CODE       PIC X.
  4227         16  PB-I-REIN-TABLE              PIC XXX.
  4228         16  PB-I-BUSINESS-TYPE           PIC 99.
  4229         16  PB-I-INDV-GRP-CD             PIC X.
  4230         16  PB-I-MORT-CODE.
  4231             20  PB-I-TABLE               PIC X.
  4232             20  PB-I-INTEREST            PIC XX.
  4233             20  PB-I-MORT-TYP            PIC X.
  4234         16  PB-I-LF-CRIT-PER             PIC S9(3)      COMP-3.
  4235         16  PB-I-AH-CRIT-PER             PIC S9(3)      COMP-3.
  4236         16  PB-I-LF-CLP                  PIC S9(5)V99   COMP-3.
  4237         16  PB-I-INDV-GRP-OVRD           PIC X.
  4238         16  PB-I-RATE-CLASS-OVRD         PIC XX.
  4239         16  PB-I-SIG-SW                  PIC X.
  4240             88  PB-POLICY-SIGNED             VALUE 'Y'.
  4241         16  PB-I-RATE-CLASS              PIC XX.
  4242         16  PB-I-RATE-DEVIATION-LF       PIC XXX.
  4243         16  PB-I-RATE-DEVIATION-AH       PIC XXX.
  4244         16  PB-I-RATE-DEV-PCT-LF         PIC S9V9(6)    COMP-3.
  4245         16  PB-I-RATE-DEV-PCT-AH         PIC S9V9(6)    COMP-3.
  4246         16  PB-I-LIFE-COMMISSION         PIC SV9(5)     COMP-3.
  4247         16  PB-I-JOINT-COMMISSION        PIC SV9(5)     COMP-3.
  4248         16  PB-I-AH-COMMISSION           PIC SV9(5)     COMP-3.
  4249         16  PB-I-BENEFIT-TYPE            PIC XXX.
  4250         16  PB-I-OB-FLAG                 PIC X.
  4251             88  PB-I-OB                      VALUE 'B'.
  4252             88  PB-I-SUMMARY                 VALUE 'Z'.
  4253         16  PB-I-ENTRY-STATUS            PIC X.
  4254             88  PB-I-POLICY-IS-ACTIVE        VALUE '1' '3' '4'
  4255                                              'M' '5' '9' '2'.
  4256             88  PB-I-NORMAL-ENTRY            VALUE '1'.
  4257             88  PB-I-POLICY-PENDING          VALUE '2'.
  4258             88  PB-I-CONVERSION-ENTRY        VALUE '4'.
  4259             88  PB-I-POLICY-IS-REISSUE       VALUE '5'.
  4260             88  PB-I-POLICY-IS-CASH          VALUE 'C'.
  4261             88  PB-I-POLICY-IS-MONTHLY       VALUE 'M'.
  4262             88  PB-I-REIN-ONLY               VALUE '9'.
  4263             88  PB-I-POLICY-IS-DECLINED      VALUE 'D'.
  4264             88  PB-I-POLICY-IS-VOIDED        VALUE 'V'.
  4265             88  PB-I-PREM-ACCTNG-ONLY        VALUE 'P'.
  4266             88  PB-I-UNDERWRITE-POLICY       VALUE 'U'.
  4267         16  PB-I-INT-CODE                PIC X.
  4268             88  PB-ADD-ON-INTEREST           VALUE 'A'.
  4269             88  PB-SIMPLE-INTEREST           VALUE 'S'.
  4270         16  PB-I-LOAN-APR                PIC 9(3)V9(4)   COMP-3.
  4271         16  PB-I-SOC-SEC-NO              PIC X(11).
  4272         16  PB-I-MEMBER-NO               PIC X(12).
  4273         16  PB-I-CURR-SEQ                PIC S9(4)       COMP.
  4274*        16  PB-I-LOAN-OFFICER            PIC XXX.
  4275         16  PB-I-OLD-LOF                 PIC XXX.
  4276         16  PB-I-LF-EXPIRE-DT            PIC XX.
  4277         16  PB-I-AH-EXPIRE-DT            PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  76
* EL6316.cbl
  4278         16  PB-I-EXTENTION-DAYS          PIC S999        COMP-3.
  4279         16  PB-I-TERM-IN-DAYS            PIC S9(5)       COMP-3.
  4280         16  PB-I-LIFE-INDICATOR          PIC X.
  4281             88  PB-I-JOINT-COVERAGE         VALUE 'J'.
  4282         16  PB-I-LIVES                   PIC S9(7)       COMP-3.
  4283         16  PB-I-DDF-IU-RATE-UP REDEFINES PB-I-LIVES
  4284                                          PIC S9(5)V99    COMP-3.
  4285         16  PB-I-MAIL-ADDRS-SW           PIC X.
  4286             88 PB-I-MAIL-ADDRS-NOT-PRESENT  VALUE ' '.
  4287             88 PB-I-MAIL-ADDRS-PRESENT      VALUE '1'.
  4288         16  PB-I-1ST-PMT-DT              PIC XX.
  4289         16  PB-I-JOINT-INSURED.
  4290             20 PB-I-JOINT-LAST-NAME      PIC X(15).
  4291             20 PB-I-JOINT-FIRST-NAME.
  4292                24  PB-I-JOINT-FIRST-INIT PIC X.
  4293                24  FILLER                PIC X(9).
  4294             20 PB-I-JOINT-MIDDLE-INIT    PIC X.
  4295*        16  PB-I-BENEFICIARY-NAME        PIC X(25).
  4296         16  PB-I-BENEFICIARY-NAME.
  4297             20  PB-I-BANK-NUMBER         PIC X(10).
  4298             20  FILLER                   PIC X(15).
  4299         16  PB-I-LAST-ADD-ON-DT          PIC XX.
  4300         16  PB-I-REFERENCE               PIC X(12).
  4301         16  FILLER REDEFINES PB-I-REFERENCE.
  4302             20  PB-I-TOT-FEES            PIC S9(7)V99 COMP-3.
  4303             20  PB-I-TOT-FEES-CALC       PIC S9(7)V99 COMP-3.
  4304             20  PB-I-CLP-STATE           PIC XX.
  4305         16  PB-I-UNDERWRITING-STATUS     PIC X.
  4306             88  PB-I-POLICY-ACCEPTED         VALUE 'A' 'N'.
  4307             88  PB-I-POLICY-DECLINED         VALUE 'D'.
  4308             88  PB-I-NEEDS-UNDERWRITING      VALUE 'U'.
  4309         16  PB-I-STATE-TAX               PIC S9(7)V99 COMP-3.
  4310         16  PB-I-MUNI-TAX                PIC S9(7)V99 COMP-3.
  4311         16  PB-I-RESIDENT-STATE          PIC XX.
  4312         16  PB-I-RATE-CODE               PIC X(4).
  4313         16  PB-I-NUM-BILLED              PIC S9(7)    COMP-3.
  4314         16  PB-I-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4315         16  PB-I-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4316         16  PB-I-BANK-FEE                PIC S999V99  COMP-3.
  4317         16  PB-I-BANK-NOCHRGB            PIC 99.
  4318         16  PB-I-ADDL-CLP                PIC S9(5)V99 COMP-3.
  4319         16  PB-I-JOINT-BIRTHDAY          PIC XX.
  4320
  4321     12  PB-CANCEL-RECORD   REDEFINES PB-RECORD-BODY.
  4322         16  PB-C-LF-CANCEL-VOID-SW       PIC X.
  4323             88  PB-C-LF-CANCEL-VOIDED        VALUE '1'.
  4324         16  PB-C-CANCEL-ORIGIN           PIC X.
  4325             88  PB-C-CLAIM-CREATED-CANCEL   VALUE '1'.
  4326         16  PB-C-LF-CANCEL-DT            PIC XX.
  4327         16  PB-C-LF-CANCEL-AMT           PIC S9(7)V99    COMP-3.
  4328         16  PB-C-LF-CALC-REQ             PIC X.
  4329             88 PB-COMP-LF-CANCEL            VALUE '?'.
  4330         16  PB-C-LF-REF-CALC             PIC S9(7)V99    COMP-3.
  4331         16  PB-C-LF-REM-TERM             PIC S9(3)       COMP-3.
  4332         16  PB-C-AH-CANCEL-VOID-SW       PIC X.
  4333             88  PB-C-AH-CANCEL-VOIDED        VALUE '1'.
  4334         16  PB-C-AH-CANCEL-DT            PIC XX.
  4335         16  PB-C-AH-CANCEL-AMT           PIC S9(7)V99    COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  77
* EL6316.cbl
  4336         16  PB-C-AH-CALC-REQ             PIC X.
  4337             88 PB-COMP-AH-CANCEL            VALUE '?'.
  4338         16  PB-C-AH-REF-CALC             PIC S9(7)V99    COMP-3.
  4339         16  PB-C-AH-REM-TERM             PIC S9(3)       COMP-3.
  4340         16  PB-C-LAST-NAME               PIC X(15).
  4341         16  PB-C-REFUND-SW               PIC X.
  4342             88  PB-C-REFUND-CREATED          VALUE 'Y'.
  4343             88  PB-C-REFUND-REQUESTED        VALUE 'R'.
  4344         16  PB-C-LIVES                   PIC S9(3)       COMP-3.
  4345         16  PB-C-PAYEE-CODE              PIC X(6).
  4346         16  PB-C-LF-REFUND-OVERRIDE      PIC X.
  4347         16  PB-C-AH-REFUND-OVERRIDE      PIC X.
  4348         16  PB-C-LF-COMM-CHARGEBACK      PIC X.
  4349         16  PB-C-AH-COMM-CHARGEBACK      PIC X.
  4350         16  PB-C-REFERENCE               PIC X(12).
  4351         16  PB-C-LF-PREM-TAX             PIC S9V9(4)  COMP-3.
  4352         16  PB-C-AH-PREM-TAX             PIC S9V9(4)  COMP-3.
  4353         16  PB-C-POST-CARD-IND           PIC X.
  4354         16  PB-C-CANCEL-REASON           PIC X.
  4355         16  PB-C-REF-INTERFACE-SW        PIC X.
  4356         16  PB-C-LF-RFND-CLP             PIC S9(5)V99 COMP-3.
  4357         16  PB-C-AH-RFND-CLP             PIC S9(5)V99 COMP-3.
  4358         16  FILLER                       PIC X(01).
  4359*        16  FILLER                       PIC X(18).
  4360         16  PB-C-POLICY-FORM-NO          PIC X(12).
  4361*        16  PB-C-MICROFILM-NO            PIC S9(9)      COMP-3.
  4362         16  PB-C-INT-ON-REFS             PIC S9(7)V99   COMP-3.
  4363         16  PB-CANCELED-CERT-DATA.
  4364             20  PB-CI-INSURED-NAME.
  4365                 24  PB-CI-LAST-NAME      PIC X(15).
  4366                 24  PB-CI-INITIALS       PIC XX.
  4367             20  PB-CI-INSURED-AGE        PIC S99         COMP-3.
  4368             20  PB-CI-INSURED-SEX        PIC X.
  4369             20  PB-CI-LF-TERM            PIC S999        COMP-3.
  4370             20  PB-CI-LF-BENEFIT-CD      PIC XX.
  4371             20  PB-CI-LF-BENEFIT-AMT     PIC S9(9)V99    COMP-3.
  4372             20  PB-CI-LF-ALT-BENEFIT-AMT PIC S9(9)V99    COMP-3.
  4373             20  PB-CI-LF-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4374             20  PB-CI-LF-ALT-PREMIUM-AMT PIC S9(7)V99    COMP-3.
  4375             20  PB-CI-AH-TERM            PIC S999        COMP-3.
  4376             20  PB-CI-AH-BENEFIT-CD      PIC XX.
  4377             20  PB-CI-AH-BENEFIT-AMT     PIC S9(7)V99    COMP-3.
  4378             20  PB-CI-AH-PREMIUM-AMT     PIC S9(7)V99    COMP-3.
  4379             20  PB-CI-RATE-CLASS         PIC XX.
  4380             20  PB-CI-RATE-DEV-LF        PIC XXX.
  4381             20  PB-CI-RATE-DEV-AH        PIC XXX.
  4382             20  PB-CI-RATE-DEV-PCT-LF    PIC S9V9(6)     COMP-3.
  4383             20  PB-CI-RATE-DEV-PCT-AH    PIC S9V9(6)     COMP-3.
  4384             20  PB-CI-LIFE-COMMISSION    PIC SV9(5)      COMP-3.
  4385             20  PB-CI-AH-COMMISSION      PIC SV9(5)      COMP-3.
  4386             20  PB-CI-LF-ABBR            PIC X(3).
  4387             20  PB-CI-AH-ABBR            PIC X(3).
  4388             20  PB-CI-OB-FLAG            PIC X.
  4389                 88  PB-CI-OB                VALUE 'B'.
  4390             20  PB-CI-LF-POLICY-STATUS   PIC X.
  4391                 88  PB-CI-LF-POLICY-IS-ACTIVE       VALUE '1' '3'
  4392                                           'M' '4' '5' '9' '2'.
  4393                 88  PB-CI-LF-NORMAL-ENTRY           VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  78
* EL6316.cbl
  4394                 88  PB-CI-LF-POLICY-PENDING         VALUE '2'.
  4395                 88  PB-CI-LF-POLICY-IS-RESTORE      VALUE '3'.
  4396                 88  PB-CI-LF-CONVERSION-ENTRY       VALUE '4'.
  4397                 88  PB-CI-LF-POLICY-IS-REISSUE      VALUE '5'.
  4398                 88  PB-CI-LF-POLICY-IS-CASH         VALUE 'C'.
  4399                 88  PB-CI-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4400                 88  PB-CI-LF-LUMP-SUM-DISAB         VALUE '6'.
  4401                 88  PB-CI-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4402                 88  PB-CI-LF-CANCEL-APPLIED         VALUE '8'.
  4403                 88  PB-CI-LF-REIN-ONLY              VALUE '9'.
  4404                 88  PB-CI-LF-POLICY-IS-DECLINED     VALUE 'D'.
  4405                 88  PB-CI-LF-POLICY-IS-VOID         VALUE 'V'.
  4406             20  PB-CI-AH-POLICY-STATUS   PIC X.
  4407                 88  PB-CI-AH-POLICY-IS-ACTIVE       VALUE '1' '3'
  4408                                           'M' '4' '5' '9' '2'.
  4409                 88  PB-CI-AH-NORMAL-ENTRY           VALUE '1'.
  4410                 88  PB-CI-AH-POLICY-PENDING         VALUE '2'.
  4411                 88  PB-CI-AH-POLICY-IS-RESTORE      VALUE '3'.
  4412                 88  PB-CI-AH-CONVERSION-ENTRY       VALUE '4'.
  4413                 88  PB-CI-AH-POLICY-IS-REISSUE      VALUE '5'.
  4414                 88  PB-CI-AH-POLICY-IS-CASH         VALUE 'C'.
  4415                 88  PB-CI-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4416                 88  PB-CI-AH-LUMP-SUM-DISAB         VALUE '6'.
  4417                 88  PB-CI-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4418                 88  PB-CI-AH-CANCEL-APPLIED         VALUE '8'.
  4419                 88  PB-CI-AH-REIN-ONLY              VALUE '9'.
  4420                 88  PB-CI-AH-POLICY-IS-DECLINED     VALUE 'D'.
  4421                 88  PB-CI-AH-POLICY-IS-VOID         VALUE 'V'.
  4422             20  PB-CI-PAY-FREQUENCY      PIC 99.
  4423             20  PB-CI-LOAN-APR           PIC 9(3)V9(4)   COMP-3.
  4424             20  PB-CI-SOC-SEC-NO         PIC X(11).
  4425             20  PB-CI-MEMBER-NO          PIC X(12).
  4426             20  PB-CI-INT-CODE           PIC X.
  4427                 88  PB-CI-ADD-ON                  VALUE 'A'.
  4428                 88  PB-CI-SIMPLE                  VALUE 'S'.
  4429             20  PB-CI-LOAN-TERM          PIC S999        COMP-3.
  4430             20  PB-CI-LOAN-1ST-PMT-DT    PIC X(2).
  4431             20  PB-CI-COMP-EXCP-SW       PIC X.
  4432                 88  PB-CI-NO-COMP-EXCP            VALUE ' '.
  4433                 88  PB-CI-CERT-HAS-ERCOMM-ENTRY   VALUE '1'.
  4434             20  PB-CI-ENTRY-STATUS       PIC X.
  4435             20  PB-CI-CURR-SEQ           PIC S9(4)       COMP.
  4436             20  PB-CI-AH-PAID-THRU-DT    PIC XX.
  4437             20  PB-CI-AH-SETTLEMENT-DT   PIC XX.
  4438             20  PB-CI-DEATH-DT           PIC XX.
  4439             20  PB-CI-LF-PRIOR-CANCEL-DT PIC XX.
  4440             20  PB-CI-AH-PRIOR-CANCEL-DT PIC XX.
  4441             20  PB-CI-AH-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4442             20  PB-CI-LF-CANCEL-AMT      PIC S9(7)V99    COMP-3.
  4443             20  PB-CI-CREDIT-INTERFACE-SW-1 PIC X.
  4444             20  PB-CI-CREDIT-INTERFACE-SW-2 PIC X.
  4445             20  PB-CI-ENTRY-DT              PIC XX.
  4446             20  PB-CI-ENTRY-BATCH           PIC X(6).
  4447             20  PB-CI-LF-EXPIRE-DT          PIC XX.
  4448             20  PB-CI-AH-EXPIRE-DT          PIC XX.
  4449             20  PB-CI-EXTENTION-DAYS        PIC S999     COMP-3.
  4450             20  PB-CI-TERM-IN-DAYS          PIC S9(5)    COMP-3.
  4451             20  PB-CI-OLD-LOF               PIC XXX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  79
* EL6316.cbl
  4452*            20  PB-CI-LOAN-OFFICER          PIC XXX.
  4453             20  PB-CI-LIVES                 PIC S9(3)    COMP-3.
  4454             20  PB-CI-LF-CRIT-PER           PIC S9(3)    COMP-3.
  4455             20  PB-CI-AH-CRIT-PER           PIC S9(3)    COMP-3.
  4456             20  PB-CI-INDV-GRP-CD           PIC X.
  4457             20  PB-CI-BENEFICIARY-NAME.
  4458                 24  PB-CI-BANK-NUMBER       PIC X(10).
  4459                 24  FILLER                  PIC X(15).
  4460             20  PB-CI-NOTE-SW               PIC X.
  4461             20  PB-CI-CANCEL-FEE            PIC S9(3)V99 COMP-3.
  4462             20  PB-CI-MUNI-TAX              PIC S9(7)V99 COMP-3.
  4463             20  PB-CI-STATE-TAX             PIC S9(7)V99 COMP-3.
  4464             20  PB-CI-ADDL-CLP              PIC S9(5)V99 COMP-3.
  4465             20  PB-CI-LOAN-OFFICER          PIC X(5).
  4466             20  PB-CI-BOW-LOAN-NUMBER       PIC X(14).
  4467             20  PB-CI-FIRST-NAME            PIC X(10).
  4468             20  PB-CI-DDF-IU-RATE-UP        PIC S9(5)V99 COMP-3.
  4469
  4470         16  FILLER                       PIC X(13).
  4471*032306  16  FILLER                       PIC X(27).
  4472*        16  FILLER                       PIC X(46).
  4473
  4474     12  PB-MAIL-RECORD    REDEFINES PB-RECORD-BODY.
  4475         16  FILLER                       PIC X(10).
  4476         16  PB-M-INSURED-LAST-NAME       PIC X(15).
  4477         16  PB-M-INSURED-FIRST-NAME      PIC X(10).
  4478         16  PB-M-INSURED-MID-INIT        PIC X.
  4479         16  PB-M-INSURED-AGE             PIC 99.
  4480         16  PB-M-INSURED-BIRTHDAY        PIC XX.
  4481         16  PB-M-INSURED-SEX             PIC X.
  4482         16  PB-M-INSURED-SOC-SEC-NO      PIC X(11).
  4483         16  PB-M-INSURED-ADDRESS-1       PIC X(30).
  4484         16  PB-M-INSURED-ADDRESS-2       PIC X(30).
  4485         16  PB-M-INSURED-CITY-STATE.
  4486             20  PB-M-INSURED-CITY        PIC X(28).
  4487             20  PB-M-INSURED-STATE       PIC XX.
  4488         16  PB-M-INSURED-ZIP-CODE.
  4489             20  PB-M-INSURED-ZIP-PRIME.
  4490                 24  PB-M-INSURED-ZIP-1   PIC X.
  4491                     88  PB-M-CANADIAN-POST-CODE
  4492                                             VALUE 'A' THRU 'Z'.
  4493                 24  FILLER               PIC X(4).
  4494             20  PB-M-INSURED-ZIP-PLUS4   PIC X(4).
  4495         16  PB-M-INSURED-CANADIAN-ZIP  REDEFINES
  4496                                        PB-M-INSURED-ZIP-CODE.
  4497             20  PM-M-INS-CAN-POST1       PIC XXX.
  4498             20  PM-M-INS-CAN-POST2       PIC XXX.
  4499             20  FILLER                   PIC XXX.
  4500         16  PB-M-INSURED-PHONE-NO        PIC 9(10).
  4501         16  PB-M-JOINT-BIRTHDAY          PIC XX.
  4502         16  PB-M-CRED-BENE-NAME          PIC X(30).
  4503         16  PB-M-CRED-BENE-ADDR1         PIC X(30).
  4504         16  PB-M-CRED-BENE-ADDR2         PIC X(30).
  4505         16  PB-M-CRED-BENE-CITYST.
  4506             20  PB-M-CRED-BENE-CITY      PIC X(28).
  4507             20  PB-M-CRED-BENE-STATE     PIC XX.
  4508         16  FILLER                       PIC X(92).
  4509
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  80
* EL6316.cbl
  4510     12  PB-BATCH-RECORD   REDEFINES PB-RECORD-BODY.
  4511         16  FILLER                       PIC X(10).
  4512         16  PB-B-LF-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4513         16  PB-B-LF-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4514         16  PB-B-LF-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4515         16  PB-B-LF-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4516         16  PB-B-LF-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4517         16  PB-B-LF-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4518         16  PB-B-AH-ISS-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4519         16  PB-B-AH-ISS-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4520         16  PB-B-AH-ISS-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4521         16  PB-B-AH-CAN-PRM-REMITTED     PIC S9(9)V99 COMP-3.
  4522         16  PB-B-AH-CAN-PRM-ENTERED      PIC S9(9)V99 COMP-3.
  4523         16  PB-B-AH-CAN-PRM-COMPUTED     PIC S9(9)V99 COMP-3.
  4524         16  PB-B-ISSUE-CNT-REMITTED      PIC S9(5)    COMP-3.
  4525         16  PB-B-ISSUE-CNT-ENTERED       PIC S9(5)    COMP-3.
  4526         16  PB-B-CANCEL-CNT-REMITTED     PIC S9(5)    COMP-3.
  4527         16  PB-B-CANCEL-CNT-ENTERED      PIC S9(5)    COMP-3.
  4528         16  PB-B-HIGHEST-SEQ-NO          PIC S9(4)    COMP.
  4529         16  PB-ACCOUNT-NAME              PIC X(30).
  4530         16  PB-PREM-REF-RPT-FLAG         PIC X.
  4531         16  PB-REFERENCE                 PIC X(12).
  4532         16  PB-B-RECEIVED-DT             PIC XX.
  4533         16  FILLER                       PIC X(234).
  4534
  4535     12  PB-RECORD-STATUS.
  4536         16  PB-CREDIT-SELECT-DT          PIC XX.
  4537         16  PB-CREDIT-ACCEPT-DT          PIC XX.
  4538         16  PB-BILLED-DT                 PIC XX.
  4539         16  PB-BILLING-STATUS            PIC X.
  4540             88  PB-ENTRY-REVERSED            VALUE 'R'.
  4541             88  PB-EL860-INTERNAL-ERROR      VALUE 'E'.
  4542             88  PB-EL860-INTERNAL-PROCESS    VALUE 'P'.
  4543         16  PB-RECORD-BILL               PIC X.
  4544             88  PB-RECORD-ON-HOLD            VALUE 'H'.
  4545             88  PB-RECORD-RETURNED           VALUE 'R'.
  4546             88  PB-RECORD-ENDORSED           VALUE 'E'.
  4547             88  PB-OVERRIDE-LIFE             VALUE 'L'.
  4548             88  PB-OVERRIDE-AH               VALUE 'A'.
  4549             88  PB-OVERRIDE-BOTH             VALUE 'B'.
  4550         16  PB-BATCH-ENTRY               PIC X.
  4551             88  PB-POLICY-IS-DECLINED        VALUE 'D'.
  4552             88  PB-REIN-ONLY-CERT            VALUE 'R'.
  4553             88  PB-REISSUED-CERT             VALUE 'E'.
  4554             88  PB-CASH-CERT                 VALUE 'C'.
  4555             88  PB-MONTHLY-CERT              VALUE 'M'.
  4556             88  PB-PREM-ACCTNG-ONLY          VALUE 'P'.
  4557             88  PB-NEEDS-UNDERWRITING        VALUE 'U'.
  4558             88  PB-POLICY-IS-VOIDED          VALUE 'V'.
  4559         16  PB-FORCE-CODE                PIC X.
  4560             88  PB-FORCE-OFF                 VALUE ' ' '0'.
  4561             88  PB-ISSUE-FORCE               VALUE 'A' 'O'.
  4562             88  PB-CANCEL-FORCE              VALUE '8'.
  4563             88  PB-ALL-ISSUE-FORCED          VALUE 'A' 'O'.
  4564             88  PB-ALL-CANCEL-FORCED         VALUE '8'.
  4565             88  PB-ALL-CANCEL-FORCED-NO-FEE  VALUE '9'.
  4566             88  PB-CANCEL-DATE-FORCED        VALUE 'D'.
  4567             88  PB-CANCEL-DATE-FORCED-NO-FEE VALUE 'E'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  81
* EL6316.cbl
  4568             88  PB-ISSUE-DATE-FORCED         VALUE 'D'.
  4569             88  PB-EXCEEDED-LIMIT-FORCED     VALUE 'L'.
  4570             88  PB-OVERCHARGE-FORCE          VALUE 'O'.
  4571         16  PB-FATAL-FLAG                PIC X.
  4572             88  PB-FATAL-ERRORS              VALUE 'X'.
  4573         16  PB-FORCE-ER-CD               PIC X.
  4574             88  PB-FORCE-ERRORS              VALUE 'F'.
  4575             88  PB-UNFORCED-ERRORS           VALUE 'X'.
  4576         16  PB-WARN-ER-CD                PIC X.
  4577             88  PB-WARNING-ERRORS            VALUE 'W'.
  4578         16  FILLER                       PIC X.
  4579         16  PB-OUT-BAL-CD                PIC X.
  4580             88  PB-OUT-OF-BAL                VALUE 'O'.
  4581         16  PB-LIFE-OVERRIDE-L1          PIC X.
  4582         16  PB-AH-OVERRIDE-L1            PIC X.
  4583         16  PB-INPUT-DT                  PIC XX.
  4584         16  PB-INPUT-BY                  PIC X(4).
  4585         16  PB-CHG-COUNT                 PIC 9(3)        COMP-3.
  4586         16  PB-CALC-TOLERANCE            PIC 9(3)V99     COMP-3.
  4587         16  PB-TOLERANCE-REJECT-SW       PIC X.
  4588         16  PB-LF-EARNING-METHOD         PIC X.
  4589         16  PB-AH-EARNING-METHOD         PIC X.
  4590         16  PB-LF-TERM-CALC-METHOD       PIC X.
  4591         16  PB-AH-TERM-CALC-METHOD       PIC X.
  4592         16  PB-REIN-CD                   PIC XXX.
  4593         16  PB-LF-REFUND-TYPE            PIC X.
  4594         16  PB-AH-REFUND-TYPE            PIC X.
  4595         16  PB-ACCT-EFF-DT               PIC XX.
  4596         16  PB-ACCT-EXP-DT               PIC XX.
  4597         16  PB-COMPANY-ID                PIC X(3).
  4598         16  PB-LF-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4599         16  PB-AH-BILLED-AMTS            PIC S9(7)V99  COMP-3.
  4600         16  PB-SV-CARRIER                PIC X.
  4601         16  PB-SV-GROUPING               PIC X(6).
  4602         16  PB-SV-STATE                  PIC XX.
  4603         16  PB-CONFIRMATION-REPT-DT      PIC XX.
  4604         16  PB-GA-BILLING-INFO.
  4605             20  PB-GA-BILL-DT OCCURS 5 TIMES
  4606                                          PIC XX.
  4607         16  PB-SV-REMIT-TO  REDEFINES
  4608             PB-GA-BILLING-INFO           PIC X(10).
  4609         16  PB-NO-OF-ERRORS              PIC S9(3) COMP-3.
  4610         16  PB-I-LOAN-OFFICER            PIC X(5).
  4611         16  PB-I-VIN                     PIC X(17).
  4612
  4613         16  FILLER                       PIC X(04).
  4614         16  IMNET-BYPASS-SW              PIC X.
  4615
  4616******************************************************************
  4617*                COMMON EDIT ERRORS                              *
  4618******************************************************************
  4619
  4620     12  PB-COMMON-ERRORS.
  4621         16  PB-COMMON-ERROR    OCCURS 10 TIMES
  4622                                           PIC S9(4)     COMP.
  4623
  4624******************************************************************
  4625*                                COPY ELCCERT.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  82
* EL6316.cbl
  4626******************************************************************
  4627*                                                                *
  4628*                            ELCCERT.                            *
  4629*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  4630*                            VMOD=2.013                          *
  4631*                                                                *
  4632*   FILE DESCRIPTION = CERTIFICATE MASTER                        *
  4633*                                                                *
  4634*   FILE TYPE = VSAM,KSDS                                        *
  4635*   RECORD SIZE = 450  RECFORM = FIXED                           *
  4636*                                                                *
  4637*   BASE CLUSTER = ELCERT                         RKP=2,LEN=33   *
  4638*       ALTERNATE PATH1 = ELCERT2 (BY NAME)       RKP=35,LEN=18  *
  4639*       ALTERNATE PATH2 = ELCERT3 (BY SOC SEC NO) RKP=53,LEN=12  *
  4640*       ALTERNATE PATH3 = ELCERT5 (BY CERT NO.)   RKP=65,LEN=12  *
  4641*       ALTERNATE PATH4 = ELCERT6 (BY MEMBER NO.) RKP=77,LEN=13  *
  4642*                                                                *
  4643*   LOG = YES                                                    *
  4644*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4645******************************************************************
  4646*                   C H A N G E   L O G
  4647*
  4648* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4649*-----------------------------------------------------------------
  4650*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4651* EFFECTIVE    NUMBER
  4652*-----------------------------------------------------------------
  4653* 122002                   PEMA  ADD MONTHLY PRODUCT PROCESSING
  4654* 040504  CR2003080800002  PEMA  ADD DEALER INCENTIVE PROCESSING
  4655* 061405  CR2005060300001  PEMA  ADD CLP STATE PROCESS FOR DCC
  4656* 110105    2005071200004  PEMA  INCREASE SIZE OF LOAN OFFICER
  4657* 072308  CR2007110500003  PEMA  ADD NH REFUND INTEREST PROCESSING
  4658* 102109  CR2008100900003  AJRA  ADD CLAIM CERT NOTE IND
  4659* 011410  CR2009050700003  PEMA  ADD SPP DEALER DIRECT
  4660* 032612  CR2011110200001  PEMA  AHL CHANGES
  4661* 090314  CR2014081300001  PEMA  LOAD CERTS INVOLVED IN THAO
  4662* 010716  CR2015082500001  PEMA CHG POLICY FEE TO CANCEL FEE
  4663* 062017  CR2015091000001  PEMA RENAME INTEREST FIELD
  4664******************************************************************
  4665
  4666 01  CERTIFICATE-MASTER.
  4667     12  CM-RECORD-ID                      PIC XX.
  4668         88  VALID-CM-ID                      VALUE 'CM'.
  4669
  4670     12  CM-CONTROL-PRIMARY.
  4671         16  CM-COMPANY-CD                 PIC X.
  4672         16  CM-CARRIER                    PIC X.
  4673         16  CM-GROUPING.
  4674             20  CM-GROUPING-PREFIX        PIC X(3).
  4675             20  CM-GROUPING-PRIME         PIC X(3).
  4676         16  CM-STATE                      PIC XX.
  4677         16  CM-ACCOUNT.
  4678             20  CM-ACCOUNT-PREFIX         PIC X(4).
  4679             20  CM-ACCOUNT-PRIME          PIC X(6).
  4680         16  CM-CERT-EFF-DT                PIC XX.
  4681         16  CM-CERT-NO.
  4682             20  CM-CERT-PRIME             PIC X(10).
  4683             20  CM-CERT-SFX               PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  83
* EL6316.cbl
  4684
  4685     12  CM-CONTROL-BY-NAME.
  4686         16  CM-COMPANY-CD-A1              PIC X.
  4687         16  CM-INSURED-LAST-NAME          PIC X(15).
  4688         16  CM-INSURED-INITIALS.
  4689             20  CM-INSURED-INITIAL1       PIC X.
  4690             20  CM-INSURED-INITIAL2       PIC X.
  4691
  4692     12  CM-CONTROL-BY-SSN.
  4693         16  CM-COMPANY-CD-A2              PIC X.
  4694         16  CM-SOC-SEC-NO.
  4695             20  CM-SSN-STATE              PIC XX.
  4696             20  CM-SSN-ACCOUNT            PIC X(6).
  4697             20  CM-SSN-LN3.
  4698                 25  CM-INSURED-INITIALS-A2.
  4699                     30 CM-INSURED-INITIAL1-A2   PIC X.
  4700                     30 CM-INSURED-INITIAL2-A2   PIC X.
  4701                 25 CM-PART-LAST-NAME-A2         PIC X.
  4702
  4703     12  CM-CONTROL-BY-CERT-NO.
  4704         16  CM-COMPANY-CD-A4              PIC X.
  4705         16  CM-CERT-NO-A4                 PIC X(11).
  4706
  4707     12  CM-CONTROL-BY-MEMB.
  4708         16  CM-COMPANY-CD-A5              PIC X.
  4709         16  CM-MEMBER-NO.
  4710             20  CM-MEMB-STATE             PIC XX.
  4711             20  CM-MEMB-ACCOUNT           PIC X(6).
  4712             20  CM-MEMB-LN4.
  4713                 25  CM-INSURED-INITIALS-A5.
  4714                     30 CM-INSURED-INITIAL1-A5   PIC X.
  4715                     30 CM-INSURED-INITIAL2-A5   PIC X.
  4716                 25 CM-PART-LAST-NAME-A5         PIC XX.
  4717
  4718     12  CM-INSURED-PROFILE-DATA.
  4719         16  CM-INSURED-FIRST-NAME.
  4720             20  CM-INSURED-1ST-INIT       PIC X.
  4721             20  FILLER                    PIC X(9).
  4722         16  CM-INSURED-ISSUE-AGE          PIC 99.
  4723         16  CM-INSURED-SEX                PIC X.
  4724             88  CM-SEX-MALE                  VALUE 'M'.
  4725             88  CM-SEX-FEMAL                 VALUE 'F'.
  4726         16  CM-INSURED-JOINT-AGE          PIC 99.
  4727         16  CM-JOINT-INSURED-NAME.
  4728             20  CM-JT-LAST-NAME           PIC X(15).
  4729             20  CM-JT-FIRST-NAME.
  4730                 24  CM-JT-1ST-INIT        PIC X.
  4731                 24  FILLER                PIC X(9).
  4732             20  CM-JT-INITIAL             PIC X.
  4733
  4734     12  CM-LIFE-DATA.
  4735         16  CM-LF-BENEFIT-CD              PIC XX.
  4736         16  CM-LF-ORIG-TERM               PIC S999      COMP-3.
  4737         16  CM-LF-CRITICAL-PERIOD         PIC S999      COMP-3.
  4738         16  CM-LF-TERM-IN-DAYS            PIC S9(5)     COMP-3.
  4739         16  CM-LF-DEV-CODE                PIC XXX.
  4740         16  CM-LF-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4741         16  CM-LF-BENEFIT-AMT             PIC S9(9)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  84
* EL6316.cbl
  4742         16  CM-LF-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4743         16  CM-LF-ALT-BENEFIT-AMT         PIC S9(9)V99  COMP-3.
  4744         16  CM-LF-ALT-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4745         16  CM-LF-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4746         16  CM-LF-REMAINING-AMT           PIC S9(9)V99  COMP-3.
  4747         16  CM-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4748         16  CM-LF-ITD-DEATH-AMT           PIC S9(9)V99  COMP-3.
  4749         16  CM-LF-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4750         16  CM-LF-POLICY-FEE              PIC S9(3)V99  COMP-3.
  4751         16  CM-LF-ALT-PREMIUM-RATE        PIC S99V9(5)  COMP-3.
  4752         16  cm-temp-epiq                  pic xx.
  4753             88  EPIQ-CLASS                  value 'EQ'.
  4754*        16  FILLER                        PIC XX.
  4755
  4756     12  CM-AH-DATA.
  4757         16  CM-AH-BENEFIT-CD              PIC XX.
  4758         16  CM-AH-ORIG-TERM               PIC S999      COMP-3.
  4759         16  CM-AH-CRITICAL-PERIOD         PIC S999      COMP-3.
  4760         16  CM-AH-DEV-CODE                PIC XXX.
  4761         16  CM-AH-DEV-PCT                 PIC S9V9(6)   COMP-3.
  4762         16  CM-AH-BENEFIT-AMT             PIC S9(7)V99  COMP-3.
  4763         16  CM-AH-PREMIUM-AMT             PIC S9(7)V99  COMP-3.
  4764         16  CM-AH-NSP-PREMIUM-AMT         PIC S9(7)V99  COMP-3.
  4765         16  CM-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  4766         16  CM-AH-ITD-LUMP-PMT            PIC S9(7)V99  COMP-3.
  4767         16  CM-AH-ITD-AH-PMT              PIC S9(9)V99  COMP-3.
  4768         16  CM-AH-PAID-THRU-DT            PIC XX.
  4769             88  NO-AH-CLAIMS-PAID            VALUE LOW-VALUE.
  4770         16  CM-AH-PREMIUM-RATE            PIC S99V9(5)  COMP-3.
  4771         16  CM-CANCEL-FEE                 PIC S9(3)V99  COMP-3.
  4772         16  CM-AH-CEDED-BENEFIT           PIC S9(7)V99  COMP-3.
  4773         16  FILLER                        PIC X.
  4774
  4775     12  CM-LOAN-INFORMATION.
  4776         16  CM-LIVES                      PIC S9(7)     COMP-3.
  4777         16  CM-DDF-IU-RATE-UP REDEFINES CM-LIVES
  4778                                           PIC S9(5)V99  COMP-3.
  4779         16  CM-BILLED                     PIC S9(7)     COMP-3.
  4780         16  CM-LOAN-APR                   PIC S999V9(4) COMP-3.
  4781         16  CM-PAY-FREQUENCY              PIC S99.
  4782         16  CM-LOAN-TERM                  PIC S999      COMP-3.
  4783         16  CM-RATE-CLASS                 PIC XX.
  4784         16  CM-BENEFICIARY                PIC X(25).
  4785         16  CM-POLICY-FORM-NO             PIC X(12).
  4786         16  CM-PMT-EXTENSION-DAYS         PIC S999      COMP-3.
  4787         16  CM-LAST-ADD-ON-DT             PIC XX.
  4788         16  CM-DEDUCTIBLE-AMOUNTS.
  4789             20  CM-CLAIM-DEDUCT-WITHHELD  PIC S9(5)V99  COMP-3.
  4790             20  CM-CANCEL-DEDUCT-WITHHELD PIC S9(5)V99  COMP-3.
  4791         16  CM-RESIDENT-RATE REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4792             20  CM-RESIDENT-STATE         PIC XX.
  4793             20  CM-RATE-CODE              PIC X(4).
  4794             20  FILLER                    PIC XX.
  4795         16  FILLER REDEFINES CM-DEDUCTIBLE-AMOUNTS.
  4796             20  CM-LOAN-OFFICER           PIC X(5).
  4797             20  FILLER                    PIC XXX.
  4798         16  CM-CSR-CODE                   PIC XXX.
  4799         16  CM-UNDERWRITING-CODE          PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  85
* EL6316.cbl
  4800             88  CM-POLICY-UNDERWRITTEN       VALUE 'Y'.
  4801         16  CM-POST-CARD-IND              PIC X.
  4802         16  CM-REF-INTERFACE-SW           PIC X.
  4803         16  CM-PREMIUM-TYPE               PIC X.
  4804             88  CM-SING-PRM                  VALUE '1'.
  4805             88  CM-O-B-COVERAGE              VALUE '2'.
  4806             88  CM-OPEN-END                  VALUE '3'.
  4807         16  CM-IND-GRP-TYPE               PIC X.
  4808             88  CM-INDIVIDUAL                VALUE 'I'.
  4809             88  CM-GROUP                     VALUE 'G'.
  4810         16  CM-SKIP-CODE                  PIC X.
  4811             88  NO-MONTHS-SKIPPED            VALUE SPACE.
  4812             88  SKIP-JULY                    VALUE '1'.
  4813             88  SKIP-AUGUST                  VALUE '2'.
  4814             88  SKIP-SEPTEMBER               VALUE '3'.
  4815             88  SKIP-JULY-AUG                VALUE '4'.
  4816             88  SKIP-AUG-SEPT                VALUE '5'.
  4817             88  SKIP-JULY-AUG-SEPT           VALUE '6'.
  4818             88  SKIP-JUNE-JULY-AUG           VALUE '7'.
  4819             88  SKIP-JUNE                    VALUE '8'.
  4820             88  SKIP-JUNE-JULY               VALUE '9'.
  4821             88  SKIP-AUG-SEPT-OCT            VALUE 'A'.
  4822             88  SKIP-BI-WEEKLY-3RD-PMT       VALUE 'X'.
  4823         16  CM-PAYMENT-MODE               PIC X.
  4824             88  PAY-MONTHLY                  VALUE SPACE.
  4825             88  PAY-WEEKLY                   VALUE '1'.
  4826             88  PAY-SEMI-MONTHLY             VALUE '2'.
  4827             88  PAY-BI-WEEKLY                VALUE '3'.
  4828             88  PAY-SEMI-ANUALLY             VALUE '4'.
  4829         16  CM-LOAN-NUMBER                PIC X(8).
  4830         16  CM-LOAN-BALANCE               PIC S9(7)V99  COMP-3.
  4831         16  CM-OLD-LOF                    PIC XXX.
  4832*        16  CM-LOAN-OFFICER               PIC XXX.
  4833         16  CM-REIN-TABLE                 PIC XXX.
  4834         16  CM-SPECIAL-REIN-CODE          PIC X.
  4835         16  CM-LF-LOAN-EXPIRE-DT          PIC XX.
  4836         16  CM-AH-LOAN-EXPIRE-DT          PIC XX.
  4837         16  CM-LOAN-1ST-PMT-DT            PIC XX.
  4838
  4839     12  CM-STATUS-DATA.
  4840         16  CM-ENTRY-STATUS               PIC X.
  4841         16  CM-ENTRY-DT                   PIC XX.
  4842
  4843         16  CM-LF-STATUS-AT-CANCEL        PIC X.
  4844         16  CM-LF-CANCEL-DT               PIC XX.
  4845         16  CM-LF-CANCEL-EXIT-DT          PIC XX.
  4846
  4847         16  CM-LF-STATUS-AT-DEATH         PIC X.
  4848         16  CM-LF-DEATH-DT                PIC XX.
  4849         16  CM-LF-DEATH-EXIT-DT           PIC XX.
  4850
  4851         16  CM-LF-CURRENT-STATUS          PIC X.
  4852             88  CM-LF-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4853                                                'M' '4' '5' '9'.
  4854             88  CM-LF-NORMAL-ENTRY           VALUE '1'.
  4855             88  CM-LF-POLICY-PENDING         VALUE '2'.
  4856             88  CM-LF-POLICY-IS-RESTORE      VALUE '3'.
  4857             88  CM-LF-CONVERSION-ENTRY       VALUE '4'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  86
* EL6316.cbl
  4858             88  CM-LF-POLICY-IS-REISSUE      VALUE '5'.
  4859             88  CM-LF-POLICY-IS-CASH         VALUE 'C'.
  4860             88  CM-LF-POLICY-IS-MONTHLY      VALUE 'M'.
  4861             88  CM-LF-LUMP-SUM-DISAB         VALUE '6'.
  4862             88  CM-LF-DEATH-CLAIM-APPLIED    VALUE '7'.
  4863             88  CM-LF-CANCEL-APPLIED         VALUE '8'.
  4864             88  CM-LF-IS-REIN-ONLY           VALUE '9'.
  4865             88  CM-LF-DECLINED               VALUE 'D'.
  4866             88  CM-LF-VOIDED                 VALUE 'V'.
  4867
  4868         16  CM-AH-STATUS-AT-CANCEL        PIC X.
  4869         16  CM-AH-CANCEL-DT               PIC XX.
  4870         16  CM-AH-CANCEL-EXIT-DT          PIC XX.
  4871
  4872         16  CM-AH-STATUS-AT-SETTLEMENT    PIC X.
  4873         16  CM-AH-SETTLEMENT-DT           PIC XX.
  4874         16  CM-AH-SETTLEMENT-EXIT-DT      PIC XX.
  4875
  4876         16  CM-AH-CURRENT-STATUS          PIC X.
  4877             88  CM-AH-POLICY-IS-ACTIVE       VALUE '1' '2' '3'
  4878                                                'M' '4' '5' '9'.
  4879             88  CM-AH-NORMAL-ENTRY           VALUE '1'.
  4880             88  CM-AH-POLICY-PENDING         VALUE '2'.
  4881             88  CM-AH-POLICY-IS-RESTORE      VALUE '3'.
  4882             88  CM-AH-CONVERSION-ENTRY       VALUE '4'.
  4883             88  CM-AH-POLICY-IS-REISSUE      VALUE '5'.
  4884             88  CM-AH-POLICY-IS-CASH         VALUE 'C'.
  4885             88  CM-AH-POLICY-IS-MONTHLY      VALUE 'M'.
  4886             88  CM-AH-LUMP-SUM-DISAB         VALUE '6'.
  4887             88  CM-AH-DEATH-CLAIM-APPLIED    VALUE '7'.
  4888             88  CM-AH-CANCEL-APPLIED         VALUE '8'.
  4889             88  CM-AH-IS-REIN-ONLY           VALUE '9'.
  4890             88  CM-AH-DECLINED               VALUE 'D'.
  4891             88  CM-AH-VOIDED                 VALUE 'V'.
  4892
  4893         16  CM-CLAIM-INTERFACE-SW         PIC X.
  4894             88  NO-CLAIM-ATTACHED            VALUE SPACE.
  4895             88  CERT-AND-CLAIM-ONLINE        VALUE '1'.
  4896             88  CERT-WAS-CREATED-FOR-CLAIM   VALUE '2'.
  4897         16  CM-CLAIM-ATTACHED-COUNT       PIC S9(4)     COMP.
  4898
  4899         16  CM-ENTRY-BATCH                PIC X(6).
  4900         16  CM-LF-EXIT-BATCH              PIC X(6).
  4901         16  CM-AH-EXIT-BATCH              PIC X(6).
  4902         16  CM-LAST-MONTH-END             PIC XX.
  4903
  4904     12  CM-NOTE-SW                        PIC X.
  4905         88  CERT-NOTES-ARE-NOT-PRESENT       VALUE ' '.
  4906         88  CERT-NOTES-PRESENT               VALUE '1'.
  4907         88  BILLING-NOTES-PRESENT            VALUE '2'.
  4908         88  CERT-BILLING-NOTES-PRESENT       VALUE '3'.
  4909         88  CLAIM-NOTES-PRESENT              VALUE '4'.
  4910         88  CLAIM-CERT-NOTES-PRESENT         VALUE '5'.
  4911         88  CLAIM-BILLING-NOTES-PRESENT      VALUE '6'.
  4912         88  CLAIM-CERT-BILL-NOTES-PRESENT    VALUE '7'.
  4913     12  CM-COMP-EXCP-SW                   PIC X.
  4914         88  COMPENSATION-SAME-AS-ACCT        VALUE ' '.
  4915         88  THIS-CERT-HAS-ERCOMM-ENTRY       VALUE '1'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  87
* EL6316.cbl
  4916     12  CM-INSURED-ADDRESS-SW             PIC X.
  4917         88  INSURED-ADDR-NOT-PRESENT         VALUE ' '.
  4918         88  INSURED-ADDR-PRESENT             VALUE '1'.
  4919
  4920*    12  CM-LF-CEDED-BENEFIT               PIC S9(7)V99   COMP-3.
  4921     12  CM-LF-CLP                         PIC S9(5)V99   COMP-3.
  4922     12  FILLER                            PIC X.
  4923
  4924*    12  CM-ISS-MICROFILM-NO               PIC S9(9)      COMP-3.
  4925     12  CM-AH-CLP                         PIC S9(5)V99   COMP-3.
  4926     12  FILLER                            PIC X.
  4927*    12  CM-CAN-MICROFILM-NO               PIC S9(9)      COMP-3.
  4928     12  CM-INT-ON-REFS                    PIC S9(7)V99   COMP-3.
  4929
  4930     12  CM-CREDIT-INTERFACE-SW-1          PIC X.
  4931         88  CERT-ADDED-BATCH                 VALUE ' '.
  4932         88  CERT-ADDED-ONLINE                VALUE '1'.
  4933         88  CERT-PEND-ISSUE-ERROR            VALUE '2'.
  4934         88  CERT-PURGED-OFFLINE              VALUE '3'.
  4935         88  CERT-PEND-ISSUE-RETURNED         VALUE '4'.
  4936     12  CM-CREDIT-INTERFACE-SW-2          PIC X.
  4937         88  CERT-AS-LOADED                   VALUE ' '.
  4938         88  CERT-CANCELLED-ONLINE            VALUE '1'.
  4939         88  CERT-CLAIM-ONLINE                VALUE '2'.
  4940         88  CERT-CLAIM-CANCEL-ONLINE         VALUE '3'.
  4941         88  CERT-PEND-CANCEL-ERROR           VALUE '4'.
  4942         88  CERT-PEND-CANCEL-VOID            VALUE '5'.
  4943         88  CERT-PEND-CAN-VOID-ERROR         VALUE '6'.
  4944         88  CERT-PEND-CANCEL-RETURNED        VALUE '7'.
  4945
  4946     12  CM-ACCOUNT-COMM-PCTS.
  4947         16  CM-LIFE-COMM-PCT              PIC SV9(5)    COMP-3.
  4948         16  CM-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  4949
  4950     12  CM-USER-FIELD                     PIC X.
  4951     12  CM-ADDL-CLP                       PIC S9(5)V99  COMP-3.
  4952     12  CM-CLP-STATE                      PIC XX.
  4953     12  CM-LF-CLASS-CD REDEFINES CM-CLP-STATE PIC XX.
  4954     12  CM-USER-RESERVED                  PIC XXX.
  4955     12  FILLER REDEFINES CM-USER-RESERVED.
  4956         16  CM-AH-CLASS-CD                PIC XX.
  4957         16  F                             PIC X.
  4958******************************************************************
  4959*                                COPY ELCCRTO.
  4960******************************************************************
  4961*                                                                *
  4962*                            ELCCRTO.                            *
  4963*                                                                *
  4964*   FILE DESCRIPTION = ORIGINAL CERTIFICATE INFORMATION          *
  4965*                                                                *
  4966*   FILE TYPE = VSAM,KSDS                                        *
  4967*   RECORD SIZE = 524  RECFORM = FIXED                           *
  4968*                                                                *
  4969*   BASE CLUSTER = ELCRTO                         RKP=2,LEN=36   *
  4970*                                                                *
  4971*   LOG = YES                                                    *
  4972*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  4973******************************************************************
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  88
* EL6316.cbl
  4974*                   C H A N G E   L O G
  4975*
  4976* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  4977*-----------------------------------------------------------------
  4978*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  4979* EFFECTIVE    NUMBER
  4980*-----------------------------------------------------------------
  4981* 061011  2011022800001    PEMA  NEW FILE TO SAVE ORIG CERT INFO
  4982* 062712  2011022800001    AJRA  REDEFINE ORIG DATA
  4983* 071712  CR2011022800001  AJRA  NAPERSOFT CANCELS
  4984* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  4985* 011413  IR2012122700003  AJRA  ADD CRTO ISSUE/CANCEL INDICATOR
  4986******************************************************************
  4987 01  ORIGINAL-CERTIFICATE.
  4988     12  OC-RECORD-ID                      PIC XX.
  4989         88  VALID-OC-ID                      VALUE 'OC'.
  4990     12  OC-CONTROL-PRIMARY.
  4991         16  OC-COMPANY-CD                 PIC X.
  4992         16  OC-CARRIER                    PIC X.
  4993         16  OC-GROUPING                   PIC X(6).
  4994         16  OC-STATE                      PIC XX.
  4995         16  OC-ACCOUNT                    PIC X(10).
  4996         16  OC-CERT-EFF-DT                PIC XX.
  4997         16  OC-CERT-NO.
  4998             20  OC-CERT-PRIME             PIC X(10).
  4999             20  OC-CERT-SFX               PIC X.
  5000         16  OC-RECORD-TYPE                PIC X.
  5001         16  OC-KEY-SEQ-NO                 PIC 9(4) BINARY.
  5002     12  OC-LAST-MAINT-DT                  PIC XX.
  5003     12  OC-LAST-MAINT-BY                  PIC X(4).
  5004     12  OC-LAST-MAINT-HHMMSS              PIC S9(6)   COMP-3.
  5005     12  OC-ENDORSEMENT-PROCESSED-DT       PIC XX.
  5006     12  FILLER                            PIC X(49).
  5007     12  OC-ORIG-REC.
  5008         16  OC-INS-LAST-NAME              PIC X(15).
  5009         16  OC-INS-FIRST-NAME             PIC X(10).
  5010         16  OC-INS-MIDDLE-INIT            PIC X.
  5011         16  OC-INS-AGE                    PIC S999     COMP-3.
  5012         16  OC-JNT-LAST-NAME              PIC X(15).
  5013         16  OC-JNT-FIRST-NAME             PIC X(10).
  5014         16  OC-JNT-MIDDLE-INIT            PIC X.
  5015         16  OC-JNT-AGE                    PIC S999     COMP-3.
  5016         16  OC-LF-BENCD                   PIC XX.
  5017         16  OC-LF-TERM                    PIC S999      COMP-3.
  5018         16  OC-LF-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5019         16  OC-LF-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5020         16  OC-LF-ALT-BEN-AMT             PIC S9(9)V99  COMP-3.
  5021         16  OC-LF-ALT-PRM-AMT             PIC S9(7)V99  COMP-3.
  5022         16  OC-LF-EXP-DT                  PIC XX.
  5023         16  OC-LF-COMM-PCT                PIC SV9(5)    COMP-3.
  5024         16  OC-LF-CANCEL-DT               PIC XX.
  5025         16  OC-LF-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5026         16  OC-LF-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5027         16  OC-AH-BENCD                   PIC XX.
  5028         16  OC-AH-TERM                    PIC S999      COMP-3.
  5029         16  OC-AH-BEN-AMT                 PIC S9(9)V99  COMP-3.
  5030         16  OC-AH-PRM-AMT                 PIC S9(7)V99  COMP-3.
  5031         16  OC-AH-EXP-DT                  PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  89
* EL6316.cbl
  5032         16  OC-AH-COMM-PCT                PIC SV9(5)    COMP-3.
  5033         16  OC-AH-CP                      PIC 99.
  5034         16  OC-AH-CANCEL-DT               PIC XX.
  5035         16  OC-AH-CANCEL-AMT              PIC S9(7)V99  COMP-3.
  5036         16  OC-AH-ITD-CANCEL-AMT          PIC S9(7)V99  COMP-3.
  5037         16  OC-CRED-BENE-NAME             PIC X(25).
  5038         16  OC-1ST-PMT-DT                 PIC XX.
  5039         16  OC-INS-AGE-DEFAULT-FLAG       PIC X.
  5040         16  OC-JNT-AGE-DEFAULT-FLAG       PIC X.
  5041         16  OC-ISSUE-TRAN-IND             PIC X.
  5042         16  OC-CANCEL-TRAN-IND            PIC X.
  5043         16  FILLER                        PIC X(211).
  5044
  5045     12  FILLER                            PIC X(50).
  5046******************************************************************
  5047*                                COPY ERCENDT.
  5048******************************************************************
  5049*                                                                *
  5050*                                                                *
  5051*                            ERCENDT.                            *
  5052*                            VMOD=2.001                          *
  5053*                                                                *
  5054*   FILE DESCRIPTION = ENDORSEMENT FILE                          *
  5055*                                                                *
  5056*   FILE TYPE = VSAM,KSDS                                        *
  5057*   RECORD SIZE = 579  RECFORM = FIXED                           *
  5058*                                                                *
  5059*   BASE CLUSTER = ERENDT                         RKP=02,LEN=36  *
  5060*       ALTERNATE PATH1 = ERENDT2 (BY ARCH NO)    RKP=38,LEN=05  *
  5061*                                                                *
  5062*   LOG = NO                                                     *
  5063*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5064******************************************************************
  5065*-----------------------------------------------------------------
  5066*                   C H A N G E   L O G
  5067*
  5068* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5069*-----------------------------------------------------------------
  5070*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5071* EFFECTIVE    NUMBER
  5072*-----------------------------------------------------------------
  5073* 052307    2006052600001  AJRA  ADDED FLAG FOR CANCELS ON CERTS
  5074*                                WITH OPEN CLAIMS
  5075* 072312    2011022800001  AJRA  ADDED BATCH NUMBER
  5076* 110612    2012101700002  AJRA  ADD NEW FIELDS
  5077* 121812  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
  5078* 010616  CR2015082000001  PEMA  ADD ENDORSEMENT CHECK PROCESSING
  5079*-----------------------------------------------------------------
  5080 01  ENDORSEMENT-RECORD.
  5081     12  EN-RECORD-ID                PIC XX.
  5082         88  VALID-EN-ID                VALUE 'EN'.
  5083     12  EN-CONTROL-PRIMARY.
  5084         16  EN-COMPANY-CD           PIC X.
  5085         16  EN-CARRIER              PIC X.
  5086         16  EN-GROUPING             PIC X(6).
  5087         16  EN-STATE                PIC XX.
  5088         16  EN-ACCOUNT              PIC X(10).
  5089         16  EN-CERT-EFF-DT          PIC XX.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  90
* EL6316.cbl
  5090         16  EN-CERT-NO.
  5091             20  EN-CERT-PRIME       PIC X(10).
  5092             20  EN-CERT-SFX         PIC X.
  5093         16  EN-REC-TYPE             PIC X.
  5094             88  EN-ISSUE               VALUE 'I'.
  5095             88  EN-CANCELLATION        VALUE 'C'.
  5096         16  EN-SEQ-NO               PIC 9(04) BINARY.
  5097     12  EN-CONTROL-BY-ARCH-NO.
  5098         16  EN-COMPANY-CD-A1              PIC X.
  5099         16  EN-ARCHIVE-NO                 PIC 9(8) BINARY.
  5100     12  EN-LAST-MAINT-DT            PIC XX.
  5101     12  EN-LAST-MAINT-BY            PIC X(4).
  5102     12  EN-LAST-MAINT-HHMMSS        PIC S9(6)     COMP-3.
  5103     12  EN-ENDORSEMENT-RECORD       PIC X(329).
  5104     12  EN-ISSUE-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5105         16  EN-INS-ORIG-LAST-NAME   PIC X(15).
  5106         16  EN-INS-ORIG-FIRST-NAME  PIC X(10).
  5107         16  EN-INS-ORIG-MIDDLE-INIT PIC X.
  5108         16  EN-INS-ORIG-AGE         PIC S999     COMP-3.
  5109         16  EN-JNT-ORIG-LAST-NAME   PIC X(15).
  5110         16  EN-JNT-ORIG-FIRST-NAME  PIC X(10).
  5111         16  EN-JNT-ORIG-MIDDLE-INIT PIC X.
  5112         16  EN-JNT-ORIG-AGE         PIC S999     COMP-3.
  5113         16  EN-LF-ORIG-BENCD        PIC XX.
  5114         16  EN-LF-ORIG-TERM         PIC S999      COMP-3.
  5115         16  EN-LF-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5116         16  EN-LF-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5117         16  EN-LF-ORIG-ALT-BEN-AMT  PIC S9(9)V99  COMP-3.
  5118         16  EN-LF-ORIG-ALT-PRM-AMT  PIC S9(7)V99  COMP-3.
  5119         16  EN-LF-ORIG-EXP-DT       PIC XX.
  5120*        16  EN-LF-ORIG-COV-TYPE     PIC X(10).
  5121         16  EN-ORIG-CRED-BENE       PIC X(25).
  5122         16  EN-LF-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5123         16  FILLER                  PIC X.
  5124         16  EN-AH-ORIG-BENCD        PIC XX.
  5125         16  EN-AH-ORIG-TERM         PIC S999      COMP-3.
  5126         16  EN-AH-ORIG-BEN-AMT      PIC S9(9)V99  COMP-3.
  5127         16  EN-AH-ORIG-PRM-AMT      PIC S9(7)V99  COMP-3.
  5128         16  EN-AH-ORIG-EXP-DT       PIC XX.
  5129*        16  EN-AH-ORIG-COV-TYPE     PIC X(10).
  5130*        16  EN-AH-ORIG-WAIT-PER     PIC 99.
  5131         16  EN-AH-ORIG-COMM-PCT     PIC SV9(5)    COMP-3.
  5132         16  F                       PIC X(09).
  5133         16  EN-AH-ORIG-CP           PIC 99.
  5134         16  EN-INS-NEW-LAST-NAME    PIC X(15).
  5135         16  EN-INS-NEW-FIRST-NAME   PIC X(10).
  5136         16  EN-INS-NEW-MIDDLE-INIT  PIC X.
  5137         16  EN-INS-NEW-AGE          PIC S999     COMP-3.
  5138         16  EN-JNT-NEW-LAST-NAME    PIC X(15).
  5139         16  EN-JNT-NEW-FIRST-NAME   PIC X(10).
  5140         16  EN-JNT-NEW-MIDDLE-INIT  PIC X.
  5141         16  EN-JNT-NEW-AGE          PIC S999     COMP-3.
  5142         16  EN-LF-NEW-BENCD         PIC XX.
  5143         16  EN-LF-NEW-TERM          PIC S999      COMP-3.
  5144         16  EN-LF-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5145         16  EN-LF-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5146         16  EN-LF-NEW-ALT-BEN-AMT   PIC S9(9)V99  COMP-3.
  5147         16  EN-LF-NEW-ALT-PRM-AMT   PIC S9(7)V99  COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  91
* EL6316.cbl
  5148         16  EN-LF-NEW-EXP-DT        PIC XX.
  5149         16  EN-NEW-CRED-BENE        PIC X(25).
  5150         16  EN-LF-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5151         16  FILLER                  PIC X.
  5152         16  EN-AH-NEW-BENCD         PIC XX.
  5153         16  EN-AH-NEW-TERM          PIC S999      COMP-3.
  5154         16  EN-AH-NEW-BEN-AMT       PIC S9(9)V99  COMP-3.
  5155         16  EN-AH-NEW-PRM-AMT       PIC S9(7)V99  COMP-3.
  5156         16  EN-AH-NEW-EXP-DT        PIC XX.
  5157*        16  EN-AH-NEW-COV-TYPE      PIC X(10).
  5158*        16  EN-AH-NEW-WAIT-PER      PIC 99.
  5159*        16  F                       PIC X(12).
  5160         16  EN-AH-NEW-CP            PIC 99.
  5161         16  EN-SIG-SW               PIC X.
  5162         16  EN-AH-NEW-COMM-PCT      PIC SV9(5)    COMP-3.
  5163         16  EN-INS-ORIG-AGE-DEF-FLAG PIC X.
  5164         16  EN-JNT-ORIG-AGE-DEF-FLAG PIC X.
  5165         16  EN-INS-NEW-AGE-DEF-FLAG PIC X.
  5166         16  EN-JNT-NEW-AGE-DEF-FLAG PIC X.
  5167         16  FILLER                  PIC X(33).
  5168     12  EN-CANCEL-RECORD REDEFINES EN-ENDORSEMENT-RECORD.
  5169         16  EN-LF-ORIG-REF-DT       PIC XX.
  5170         16  EN-LF-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5171         16  EN-AH-ORIG-REF-DT       PIC XX.
  5172         16  EN-AH-ORIG-REF-AMT      PIC S9(7)V99  COMP-3.
  5173         16  EN-LF-NEW-REF-DT        PIC XX.
  5174         16  EN-LF-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5175         16  EN-AH-NEW-REF-DT        PIC XX.
  5176         16  EN-AH-NEW-REF-AMT       PIC S9(7)V99  COMP-3.
  5177         16  EN-FLAG-CERT            PIC X.
  5178         16  EN-INS-LAST-NAME        PIC X(15).
  5179         16  EN-INS-FIRST-NAME       PIC X(10).
  5180         16  EN-INS-MIDDLE-INIT      PIC X.
  5181         16  EN-LF-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5182         16  EN-AH-ORIG-REF-COMM-PCT PIC SV9(5)    COMP-3.
  5183         16  EN-LF-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5184         16  EN-AH-NEW-REF-COMM-PCT  PIC SV9(5)    COMP-3.
  5185         16  FILLER                  PIC X(262).
  5186     12  EN-MONEY-SW             PIC X.
  5187     12  EN-HEALTH-APP           PIC X.
  5188     12  EN-VOUCHER-SW           PIC X.
  5189     12  EN-PAYEE                PIC X(14).
  5190     12  EN-INPUT-DT             PIC XX.
  5191     12  EN-PROCESS-DT           PIC XX.
  5192     12  EN-LF-COMMISSION        PIC SV9(5)    COMP-3.
  5193     12  EN-AH-COMMISSION        PIC SV9(5)    COMP-3.
  5194     12  EN-REASON-CODES.
  5195         16  F OCCURS 12.
  5196             20  EN-REASON-CODE  PIC X(4).
  5197     12  EN-TEMPLATE-USED        PIC X(8).
  5198     12  EN-DOCU-TYPE            PIC X.
  5199         88  EN-VERI-DOCU          VALUE 'V'.
  5200         88  EN-GCE-DOCU           VALUE 'G'.
  5201         88  EN-CANC-DOCU          VALUE 'C'.
  5202     12  EN-COMMENTS1            PIC X(13).
  5203     12  EN-COMMENTS2            PIC X(70).
  5204     12  EN-COMM-CHGBK           PIC X.
  5205         88  EN-DO-NOT-CHG-ACCT    VALUE 'N'.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  92
* EL6316.cbl
  5206         88  EN-CHG-ACCT           VALUE 'Y'.
  5207     12  EN-CSO-PORTION          PIC S9(5)V99  COMP-3.
  5208     12  EN-ACCT-PORTION         PIC S9(5)V99  COMP-3.
  5209     12  EN-BATCH-NUMBER         PIC X(6).
  5210     12  EN-ACCT-SUMM            PIC X.
  5211     12  EN-CSO-SUMM             PIC X.
  5212     12  en-check-type           pic x.
  5213     12  FILLER                  PIC X(12).
  5214******************************************************************
  5215*                                COPY ERCNOTE.
  5216******************************************************************
  5217*                                                                *
  5218*                                                                *
  5219*                            ERCNOTE                             *
  5220*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5221*                            VMOD=2.003                          *
  5222*                                                                *
  5223*        FILE DESCRIPTION = CERTIFICATE AND BILLING NOTES        *
  5224*                                                                *
  5225*        FILE TYPE= VSAM,KSDS                                    *
  5226*        RECORD SIZE = 825    RECFORM = FIXED                    *
  5227*                                                                *
  5228*        BASE CLUSTER = ERNOTE        RKP=2,LEN=34               *
  5229*                                                                *
  5230*        LOG = YES                                               *
  5231*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5232*                                                                *
  5233******************************************************************
  5234*                   C H A N G E   L O G
  5235*
  5236* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5237*-----------------------------------------------------------------
  5238*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5239* EFFECTIVE    NUMBER
  5240*-----------------------------------------------------------------
  5241* 091509  CR2008100900003  AJRA  CERT NOTES MOVED TO NEW FILE. THI
  5242*                                FILE WILL CONTAIN BILLING NOTES O
  5243* 041320  CR2020030500002  PEMA  Distinguish between iss and canc
  5244******************************************************************
  5245
  5246 01  CERTIFICATE-NOTE.
  5247     12  CN-RECORD-ID                PIC  XX.
  5248         88  VALID-CN-ID                  VALUE 'CN'.
  5249
  5250     12  CN-CONTROL-PRIMARY.
  5251         16  CN-COMPANY-CD           PIC X.
  5252         16  CN-CARRIER              PIC X.
  5253         16  CN-GROUPING.
  5254             20 CN-GROUPING-PREFIX   PIC XXX.
  5255             20 CN-GROUPING-PRIME    PIC XXX.
  5256         16  CN-STATE                PIC XX.
  5257         16  CN-ACCOUNT.
  5258             20 CN-ACCOUNT-PREFIX    PIC X(4).
  5259             20 CN-ACCOUNT-PRIME     PIC X(6).
  5260         16  CN-CERT-EFF-DT          PIC XX.
  5261         16  CN-CERT-NO.
  5262             20  CN-CERT-PRIME       PIC X(10).
  5263             20  CN-CERT-SFX         PIC X.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  93
* EL6316.cbl
  5264         16  CN-RECORD-TYPE          PIC X.
  5265             88  CN-ISSUE-BILLING-NOTE    VALUE '1'.
  5266             88  CN-CANCEL-BILLING-NOTE   VALUE '2'.
  5267     12  CN-BILLING-START-LINE-NO    PIC 99.
  5268     12  CN-BILLING-END-LINE-NO      PIC 99.
  5269
  5270     12  CN-LINES.
  5271         16  CN-LINE OCCURS 10       PIC X(77).
  5272
  5273     12  CN-LAST-MAINT-DT            PIC XX.
  5274     12  CN-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5275     12  CN-LAST-MAINT-USER          PIC X(4).
  5276     12  FILLER                      PIC X(5).
  5277******************************************************************
  5278*                                COPY ERCMAIL.
  5279******************************************************************
  5280*                                                                *
  5281*                                                                *
  5282*                            ERCMAIL                             *
  5283*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5284*                            VMOD=2.003                          *
  5285*                                                                *
  5286*   FILE DESCRIPTION = MAILING DATA CAPTURE RECORDS              *
  5287*                                                                *
  5288*   FILE TYPE = VSAM,KSDS                                        *
  5289*   RECORD SIZE = 374   RECFORM = FIX                            *
  5290*                                                                *
  5291*   BASE CLUSTER NAME = ERMAIL                 RKP=2,LEN=33      *
  5292*   ALTERNATE PATH    = NOT USED                                 *
  5293*                                                                *
  5294*   LOG = YES                                                    *
  5295*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5296******************************************************************
  5297*                   C H A N G E   L O G
  5298*
  5299* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5300*-----------------------------------------------------------------
  5301*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5302* EFFECTIVE    NUMBER
  5303*-----------------------------------------------------------------
  5304* 080406    2006051800002  PEMA  ADD POST CARD MAIL INFO
  5305* 090408  CR2008040800002  PEMA  ADD JOINT BIRTH DATE PROCESSING
  5306* 111108                   PEMA  ADD CRED BENE ADDR2
  5307******************************************************************
  5308
  5309 01  MAILING-DATA.
  5310     12  MA-RECORD-ID                      PIC XX.
  5311         88  VALID-MA-ID                       VALUE 'MA'.
  5312
  5313     12  MA-CONTROL-PRIMARY.
  5314         16  MA-COMPANY-CD                 PIC X.
  5315         16  MA-CARRIER                    PIC X.
  5316         16  MA-GROUPING.
  5317             20  MA-GROUPING-PREFIX        PIC XXX.
  5318             20  MA-GROUPING-PRIME         PIC XXX.
  5319         16  MA-STATE                      PIC XX.
  5320         16  MA-ACCOUNT.
  5321             20  MA-ACCOUNT-PREFIX         PIC X(4).
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  94
* EL6316.cbl
  5322             20  MA-ACCOUNT-PRIME          PIC X(6).
  5323         16  MA-CERT-EFF-DT                PIC XX.
  5324         16  MA-CERT-NO.
  5325             20  MA-CERT-PRIME             PIC X(10).
  5326             20  MA-CERT-SFX               PIC X.
  5327
  5328     12  FILLER                            PIC XX.
  5329
  5330     12  MA-ACCESS-CONTROL.
  5331         16  MA-SOURCE-SYSTEM              PIC XX.
  5332             88  MA-FROM-CREDIT                VALUE 'CR'.
  5333             88  MA-FROM-VSI                   VALUE 'VS'.
  5334             88  MA-FROM-WARRANTY              VALUE 'WA'.
  5335             88  MA-FROM-OTHER                 VALUE 'OT'.
  5336         16  MA-RECORD-ADD-DT              PIC XX.
  5337         16  MA-RECORD-ADDED-BY            PIC XXXX.
  5338         16  MA-LAST-MAINT-DT              PIC XX.
  5339         16  MA-LAST-MAINT-BY              PIC XXXX.
  5340         16  MA-LAST-MAINT-HHMMSS          PIC S9(6)       COMP-3.
  5341
  5342     12  MA-PROFILE-INFO.
  5343         16  MA-QUALIFY-CODE-1             PIC XX.
  5344         16  MA-QUALIFY-CODE-2             PIC XX.
  5345         16  MA-QUALIFY-CODE-3             PIC XX.
  5346         16  MA-QUALIFY-CODE-4             PIC XX.
  5347         16  MA-QUALIFY-CODE-5             PIC XX.
  5348
  5349         16  MA-INSURED-LAST-NAME          PIC X(15).
  5350         16  MA-INSURED-FIRST-NAME         PIC X(10).
  5351         16  MA-INSURED-MIDDLE-INIT        PIC X.
  5352         16  MA-INSURED-ISSUE-AGE          PIC 99.
  5353         16  MA-INSURED-BIRTH-DT           PIC XX.
  5354         16  MA-INSURED-SEX                PIC X.
  5355             88  MA-SEX-MALE                   VALUE 'M'.
  5356             88  MA-SEX-FEMALE                 VALUE 'F'.
  5357         16  MA-INSURED-SOC-SEC-NO         PIC X(11).
  5358
  5359         16  MA-ADDRESS-CORRECTED          PIC X.
  5360         16  MA-JOINT-BIRTH-DT             PIC XX.
  5361*        16  FILLER                        PIC X(12).
  5362
  5363         16  MA-ADDRESS-LINE-1             PIC X(30).
  5364         16  MA-ADDRESS-LINE-2             PIC X(30).
  5365         16  MA-CITY-STATE.
  5366             20  MA-CITY                   PIC X(28).
  5367             20  MA-ADDR-STATE             PIC XX.
  5368         16  MA-ZIP.
  5369             20  MA-ZIP-CODE.
  5370                 24  MA-ZIP-CODE-1ST       PIC X(1).
  5371                     88  MA-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  5372                 24  FILLER                PIC X(4).
  5373             20  MA-ZIP-PLUS4              PIC X(4).
  5374         16  MA-CANADIAN-POSTAL-CODE REDEFINES MA-ZIP.
  5375             20  MA-CAN-POSTAL-CODE-1      PIC X(3).
  5376             20  MA-CAN-POSTAL-CODE-2      PIC X(3).
  5377             20  FILLER                    PIC X(3).
  5378
  5379         16  MA-PHONE-NO                   PIC 9(11)       COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  95
* EL6316.cbl
  5380
  5381         16  FILLER                        PIC XXX.
  5382*        16  FILLER                        PIC X(10).
  5383
  5384     12  MA-CRED-BENE-INFO.
  5385         16  MA-CRED-BENE-NAME                 PIC X(25).
  5386         16  MA-CRED-BENE-ADDR                 PIC X(30).
  5387         16  MA-CRED-BENE-ADDR2                PIC X(30).
  5388         16  MA-CRED-BENE-CTYST.
  5389             20  MA-CRED-BENE-CITY             PIC X(28).
  5390             20  MA-CRED-BENE-STATE            PIC XX.
  5391         16  MA-CRED-BENE-ZIP.
  5392             20  MA-CB-ZIP-CODE.
  5393                 24  MA-CB-ZIP-CODE-1ST        PIC X(1).
  5394                     88  MA-CB-CANADIAN-POST-CODE
  5395                                           VALUE 'A' THRU 'Z'.
  5396                 24  FILLER                    PIC X(4).
  5397             20  MA-CB-ZIP-PLUS4               PIC X(4).
  5398         16  MA-CB-CANADIAN-POSTAL-CODE
  5399                            REDEFINES MA-CRED-BENE-ZIP.
  5400             20  MA-CB-CAN-POSTAL-CODE-1       PIC X(3).
  5401             20  MA-CB-CAN-POSTAL-CODE-2       PIC X(3).
  5402             20  FILLER                        PIC X(3).
  5403     12  MA-POST-CARD-MAIL-DATA.
  5404         16  MA-MAIL-DATA OCCURS 7.
  5405             20  MA-MAIL-TYPE              PIC X.
  5406                 88  MA-12MO-MAILING           VALUE '1'.
  5407                 88  MA-EXP-MAILING            VALUE '2'.
  5408             20  MA-MAIL-STATUS            PIC X.
  5409                 88  MA-MAIL-ST-MAILED         VALUE '1'.
  5410                 88  MA-MAIL-ST-RETURNED       VALUE '2'.
  5411                 88  MA-MAIL-ST-NOT-MAILED     VALUE '3'.
  5412             20  MA-MAIL-DATE              PIC XX.
  5413     12  FILLER                            PIC XX.
  5414     12  FILLER                            PIC XX.
  5415*    12  FILLER                            PIC X(30).
  5416******************************************************************
  5417*                                COPY ERCCNOT.
  5418******************************************************************
  5419*                                                                *
  5420*                            ERCCNOT                             *
  5421*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  5422*                            VMOD=2.003                          *
  5423*                                                                *
  5424*        FILE DESCRIPTION = CERTIFICATE NOTES                    *
  5425*                                                                *
  5426*        FILE TYPE= VSAM,KSDS                                    *
  5427*        RECORD SIZE = 150    RECFORM = FIXED                    *
  5428*                                                                *
  5429*        BASE CLUSTER = ERCNOT        RKP=2,LEN=36               *
  5430*                                                                *
  5431*        LOG = YES                                               *
  5432*        SERVREQ = DELETE,UPDATE,NEWREC                          *
  5433*                                                                *
  5434******************************************************************
  5435*                   C H A N G E   L O G
  5436*
  5437* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  96
* EL6316.cbl
  5438*-----------------------------------------------------------------
  5439*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5440* EFFECTIVE    NUMBER
  5441*-----------------------------------------------------------------
  5442* 091509  CR2008100900003  AJRA  NEW FILE FOR CERT NOTES.
  5443******************************************************************
  5444
  5445 01  CERT-NOTE-FILE.
  5446     12  CZ-RECORD-ID                PIC  XX.
  5447         88  VALID-CZ-ID                  VALUE 'CZ'.
  5448
  5449     12  CZ-CONTROL-PRIMARY.
  5450         16  CZ-COMPANY-CD           PIC X.
  5451         16  CZ-CARRIER              PIC X.
  5452         16  CZ-GROUPING.
  5453             20 CZ-GROUPING-PREFIX   PIC XXX.
  5454             20 CZ-GROUPING-PRIME    PIC XXX.
  5455         16  CZ-STATE                PIC XX.
  5456         16  CZ-ACCOUNT.
  5457             20 CZ-ACCOUNT-PREFIX    PIC X(4).
  5458             20 CZ-ACCOUNT-PRIME     PIC X(6).
  5459         16  CZ-CERT-EFF-DT          PIC XX.
  5460         16  CZ-CERT-NO.
  5461             20  CZ-CERT-PRIME       PIC X(10).
  5462             20  CZ-CERT-SFX         PIC X.
  5463         16  CZ-RECORD-TYPE          PIC X.
  5464             88  CERT-NOTE           VALUE '1'.
  5465             88  CLAIM-CERT-NOTE     VALUE '2'.
  5466         16  CZ-NOTE-SEQUENCE        PIC S9(4)     COMP.
  5467
  5468     12  CZ-LAST-MAINT-DT            PIC XX.
  5469     12  CZ-LAST-MAINT-HHMMSS        PIC S9(7)   COMP-3.
  5470     12  CZ-LAST-MAINT-USER          PIC X(4).
  5471
  5472     12  CZ-NOTE-INFORMATION.
  5473         16  CZ-NOTE                 PIC X(63).
  5474         16  FILLER                  PIC X(39).
  5475******************************************************************
  5476*                                COPY ELCEOBC.
  5477******************************************************************
  5478*                                                                *
  5479*                                                                *
  5480*                            ELCEOBC                             *
  5481*                            VMOD=2.001                          *
  5482*                                                                *
  5483*   CLAIM SYSTEM EOB CODE TABLE                                  *
  5484*                                                                *
  5485*   THIS COPYBOOK IS USED FOR BOTH THE ONLINE AND BATCH          *
  5486*   VSAM EOB CODE TABLE                                          *
  5487*                                                                *
  5488*   FILE DESCRIPTION = EOB CODE TABLE                            *
  5489*                                                                *
  5490*   FILE TYPE = VSAM,KSDS                                        *
  5491*   RECORD SIZE = 350   RECFORM = FIX                            *
  5492*                                                                *
  5493*   BASE CLUSTER NAME = ELEOBC                    RKP=2,LEN=15   *
  5494*                                                                *
  5495*   LOG = NO                                                     *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  97
* EL6316.cbl
  5496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5497*                                                                *
  5498*                                                                *
  5499******************************************************************
  5500*                   C H A N G E   L O G
  5501*
  5502* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5503*-----------------------------------------------------------------
  5504*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5505* EFFECTIVE    NUMBER
  5506*-----------------------------------------------------------------
  5507* 120808    2008100900001  PEMA  NEW COPYBOOK/FILE
  5508* 081511    2011022800001  PEMA  CHG FOR ADMIN SERV NAPERSOFT
  5509* 091913    2013090300001  AJRA  ADDITIONAL RECORD TYPES
  5510******************************************************************
  5511 01  EOB-CODES.
  5512     12  EO-RECORD-ID                      PIC XX.
  5513         88  VALID-DN-ID                      VALUE 'EO'.
  5514     12  EO-CONTROL-PRIMARY.
  5515         16  EO-COMPANY-CD                 PIC X.
  5516         16  EO-RECORD-TYPE                PIC X.
  5517             88  EO-EOB-RECS                  VALUE '1'.
  5518             88  EO-VERIF-RECS                VALUE '2'.
  5519             88  EO-GCE-RECS                  VALUE '3'.
  5520             88  EO-CANC-RECS                 VALUE '4'.
  5521             88  EO-BILL-NOTE-RECS            VALUE '5'.
  5522         16  EO-EOB-CODE                   PIC X(4).
  5523         16  FILLER                        PIC X(9).
  5524     12  EO-MAINT-INFORMATION.
  5525         16  EO-LAST-MAINT-DT              PIC XX.
  5526         16  EO-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5527         16  EO-LAST-MAINT-USER            PIC X(4).
  5528         16  FILLER                        PIC XX.
  5529     12  EO-DESCRIPTION                    PIC X(275).
  5530     12  FILLER                            PIC X(46).
  5531******************************************************************
  5532*                                COPY ELCENCC.
  5533******************************************************************
  5534*                                                                *
  5535*                                                                *
  5536*                            ELCENCC                             *
  5537*                            VMOD=2.001                          *
  5538*                                                                *
  5539*   CLAIM SYSTEM ENCLOSURE CODE TABLE                            *
  5540*                                                                *
  5541*   THIS COPYBOOK IS USED FOR THE ONLINE PROCESS OF CREATING     *
  5542*   A NAPERSOFT DOCUMENT                                         *
  5543*                                                                *
  5544*   FILE DESCRIPTION = ENCLOSURE CODE TABLE                      *
  5545*                                                                *
  5546*   FILE TYPE = VSAM,KSDS                                        *
  5547*   RECORD SIZE = 400   RECFORM = FIX                            *
  5548*                                                                *
  5549*   BASE CLUSTER NAME = ELENCC                    RKP=2,LEN=16   *
  5550*                                                                *
  5551*   LOG = NO                                                     *
  5552*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5553*                                                                *
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  98
* EL6316.cbl
  5554*                                                                *
  5555******************************************************************
  5556*                   C H A N G E   L O G
  5557*
  5558* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5559*-----------------------------------------------------------------
  5560*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5561* EFFECTIVE    NUMBER
  5562*-----------------------------------------------------------------
  5563* 082010    2008100900001  PEMA  NEW COPYBOOK/FILE
  5564* 061217    2017060900001  TANA  INCREASE ATTACHMENTS FIELD SIZE
  5565******************************************************************
  5566 01  ENCLOSURE-CODES.
  5567     12  NC-RECORD-ID                      PIC XX.
  5568         88  VALID-NC-ID                      VALUE 'NC'.
  5569     12  NC-CONTROL-PRIMARY.
  5570         16  NC-COMPANY-CD                 PIC X.
  5571         16  NC-REC-TYPE                   PIC X.
  5572             88  NC-CLAIMS                   VALUE '1'.
  5573             88  NC-ADMIN                    VALUE '2'.
  5574         16  NC-ENC-CODE                   PIC X(5).
  5575         16  FILLER                        PIC X(09).
  5576     12  NC-MAINT-INFORMATION.
  5577         16  NC-LAST-MAINT-DT              PIC XX.
  5578         16  NC-LAST-MAINT-HHMMSS          PIC S9(7)      COMP-3.
  5579         16  NC-LAST-MAINT-USER            PIC X(4).
  5580         16  FILLER                        PIC XX.
  5581     12  NC-OUTPUT-STACK                   PIC XXX.
  5582     12  NC-ENCLOSURE-LINE                 PIC X(100).
  5583     12  NC-ATTACHMENTS                    PIC X(255).
  5584     12  NC-FUTURE                         PIC X(12).
  5585******************************************************************
  5586*                                COPY ELCCRTT.
  5587******************************************************************
  5588*                                                                *
  5589*                            ELCCRTT.                            *
  5590*                                                                *
  5591*   FILE DESCRIPTION = CERTIFICATE TRAILERS                      *
  5592*                                                                *
  5593*   FILE TYPE = VSAM,KSDS                                        *
  5594*   RECORD SIZE = 552  RECFORM = FIXED                           *
  5595*                                                                *
  5596*   BASE CLUSTER = ELCRTT                         RKP=2,LEN=34   *
  5597*                                                                *
  5598*   LOG = YES                                                    *
  5599*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  5600******************************************************************
  5601*                   C H A N G E   L O G
  5602*
  5603* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  5604*-----------------------------------------------------------------
  5605*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  5606* EFFECTIVE    NUMBER
  5607*-----------------------------------------------------------------
  5608* 111204                   PEMA  NEW FILE TO SPLIT BANK COMM
  5609* 040109  2009031600001    AJRA  ADD NEW TRAILER TYPE AND REDEFINE
  5610* 012010  2009061500002    AJRA  ADD FLAG FOR REFUND WITH OPEN CLA
  5611* 121712  CR2012101700002  AJRA  ADD DEFAULT AGE FLAG
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page  99
* EL6316.cbl
  5612* 061013  CR2012113000002  PEMA  SPP CLAIM RELATED CHANGES
  5613* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  5614* 052614  CR2014022100001  AJRA  ADD FAMILY LEAVE CLAIM TYPE
  5615* 022715  CR2015010800003  PEMA  AGENT SIGNATURE
  5616* 020816  CR2015082500001  PEMA  ADD NEW VPP COMPANY
  5617* 012918  CR2017062000002  PEMA  AUDIT NB FOR PREV CLAIMS
  5618* 091318  CR2018073000001  PEMA  ADD Refund methods
  5619* 100518  CR2017061500001  TANA  ADD OTHER CLAIM TYPE
  5620******************************************************************
  5621
  5622 01  CERTIFICATE-TRAILERS.
  5623     12  CS-RECORD-ID                      PIC XX.
  5624         88  VALID-CS-ID                      VALUE 'CS'.
  5625
  5626     12  CS-CONTROL-PRIMARY.
  5627         16  CS-COMPANY-CD                 PIC X.
  5628         16  CS-CARRIER                    PIC X.
  5629         16  CS-GROUPING                   PIC X(6).
  5630         16  CS-STATE                      PIC XX.
  5631         16  CS-ACCOUNT                    PIC X(10).
  5632         16  CS-CERT-EFF-DT                PIC XX.
  5633         16  CS-CERT-NO.
  5634             20  CS-CERT-PRIME             PIC X(10).
  5635             20  CS-CERT-SFX               PIC X.
  5636         16  CS-TRAILER-TYPE               PIC X.
  5637             88  COMM-TRLR           VALUE 'A'.
  5638             88  CLAIM-HISTORY-TRLR  VALUE 'B'.
  5639             88  CERT-DATA-TRLR      VALUE 'C'.
  5640
  5641     12  CS-DATA-AREA                      PIC X(516).
  5642
  5643     12  CS-BANK-COMMISSIONS REDEFINES CS-DATA-AREA.
  5644         16  CS-BANK-COMMISSION-AREA.
  5645             20  CS-BANK-COMMS       OCCURS 10.
  5646                 24  CS-AGT                PIC X(10).
  5647                 24  CS-COM-TYP            PIC X.
  5648                 24  CS-SPP-FEES           PIC S9(5)V99   COMP-3.
  5649                 24  CS-RECALC-LV-INDIC    PIC X.
  5650                 24  FILLER                PIC X(10).
  5651         16  FILLER                        PIC X(256).
  5652
  5653     12  CS-CLAIM-HISTORY-TRAILER REDEFINES CS-DATA-AREA.
  5654****  TO CALC NO OF BENEFITS PAID = (CS-DAYS-PAID / 30)
  5655         16  CS-MB-CLAIM-DATA OCCURS 24.
  5656             20  CS-CLAIM-NO               PIC X(7).
  5657             20  CS-CLAIM-TYPE             PIC X.
  5658                 88  CS-AH-CLM               VALUE 'A'.
  5659                 88  CS-IU-CLM               VALUE 'I'.
  5660                 88  CS-GP-CLM               VALUE 'G'.
  5661                 88  CS-LF-CLM               VALUE 'L'.
  5662                 88  CS-PR-CLM               VALUE 'P'.
  5663                 88  CS-FL-CLM               VALUE 'F'.
  5664                 88  CS-OT-CLM               VALUE 'O'.
  5665             20  CS-INSURED-TYPE           PIC X.
  5666                 88  CS-PRIM-INSURED          VALUE 'P'.
  5667                 88  CS-CO-BORROWER           VALUE 'C'.
  5668             20  CS-BENEFIT-PERIOD         PIC 99.
  5669             20  CS-DAYS-PAID              PIC S9(5) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 100
* EL6316.cbl
  5670             20  CS-TOTAL-PAID             PIC S9(7)V99 COMP-3.
  5671             20  CS-REMAINING-BENS         PIC S999 COMP-3.
  5672         16  FILLER                        PIC X(12).
  5673     12  CS-CERT-DATA REDEFINES CS-DATA-AREA.
  5674         16  CS-VIN-NUMBER                 PIC X(17).
  5675         16  CS-REFUND-CLAIM-FLAG          PIC X(01).
  5676         16  CS-INS-AGE-DEFAULT-FLAG       PIC X(01).
  5677         16  CS-JNT-AGE-DEFAULT-FLAG       PIC X(01).
  5678         16  cs-agent-name.
  5679             20  cs-agent-fname            pic x(20).
  5680             20  cs-agent-mi               pic x.
  5681             20  cs-agent-lname            pic x(25).
  5682         16  cs-license-no                 pic x(15).
  5683         16  cs-npn-number                 pic x(10).
  5684         16  cs-agent-edit-status          pic x.
  5685             88  cs-ae-refer-to-manager      value 'M'.
  5686             88  cs-ae-cover-sheet           value 'C'.
  5687             88  cs-ae-sig-form              value 'S'.
  5688             88  cs-ae-verified              value 'V'.
  5689             88  cs-unidentified-signature   value 'U'.
  5690             88  cs-cert-returned            value 'R'.
  5691             88  cs-accept-no-commission     value 'N'.
  5692         16  cs-year                       pic 9999.
  5693         16  cs-make                       pic x(20).
  5694         16  cs-model                      pic x(20).
  5695         16  cs-future                     pic x(20).
  5696         16  cs-vehicle-odometer           pic s9(7) comp-3.
  5697         16  cs-claim-verification-status  pic x.
  5698             88  cs-clm-ver-eligible         value 'A'.
  5699             88  cs-clm-ver-partial-elig     value 'B'.
  5700             88  cs-clm-ver-not-eligible     value 'C'.
  5701             88  cs-clm-ver-not-elig-opn-clm value 'D'.
  5702             88  cs-clm-ver-not-part-elig-rw value 'E'.
  5703             88  cs-clm-ver-ND-CERT          value 'F'.
  5704             88  cs-clm-ver-spec-other       value 'G'.
  5705             88  cs-clam-ver-pratial-corrected
  5706                                             value 'H'.
  5707             88  cs-clm-ver-no-matches       value 'I'.
  5708             88  cs-clm-ver-not-elig-corrected
  5709                                             value 'J'.
  5710             88  cs-clm-ver-needs-review     value 'R'.
  5711             88  cs-clm-ver-sent-to-claims   value 'W'.
  5712         16  CS-LF-REFUND-METHOD           PIC X.
  5713         16  CS-AH-REFUND-METHOD           PIC X.
  5714         16  FILLER                        PIC X(353). *> was 420
  5715*        16  FILLER                        PIC X(496).
  5716 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA VAR
  5717                          ACCOUNT-MASTER CONTROL-FILE
  5718                          PENDING-BUSINESS CERTIFICATE-MASTER
  5719                          ORIGINAL-CERTIFICATE
  5720                          ENDORSEMENT-RECORD CERTIFICATE-NOTE
  5721                          MAILING-DATA CERT-NOTE-FILE EOB-CODES
  5722                          ENCLOSURE-CODES CERTIFICATE-TRAILERS.
  5723 0000-DFHEXIT SECTION.
  5724     MOVE '9#                    $   ' TO DFHEIV0.
  5725     MOVE 'EL6316' TO DFHEIV1.
  5726     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  5727     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 101
* EL6316.cbl
  5728     MOVE EIBDATE                TO DC-JULIAN-YYDDD
  5729     MOVE '5'                    TO DC-OPTION-CODE
  5730     PERFORM 9700-DATE-LINK
  5731     MOVE DC-GREG-DATE-1-EDIT    TO  WS-CURRENT-DT
  5732     MOVE DC-BIN-DATE-1          TO  WS-CURRENT-BIN-DT
  5733     MOVE EIBTRMID               TO QID-TERM
  5734     IF EIBCALEN = 0
  5735        GO TO 8800-UNAUTHORIZED-ACCESS
  5736     END-IF
  5737     DISPLAY ' ENDORSE LENGTH  '
  5738                FUNCTION LENGTH(ENDORSEMENT-RECORD)
  5739     move function length(EL631II) TO MAP-LENGTH
  5740     DISPLAY ' MAP LENGTH      ' MAP-LENGTH
  5741     IF PI-CALLING-PROGRAM = 'EL6314'
  5742         MOVE 'Y'                    TO PI-FROM-CERT
  5743         MOVE THIS-PGM               TO PI-CALLING-PROGRAM
  5744         MOVE LOW-VALUES             TO EL631II
  5745         MOVE 'Y'                    TO PI-CLEAR-ERROR-SW
  5746         GO TO 0350-DISPLAY-COMMON-DATA
  5747     END-IF
  5748
  5749     IF PI-CALLING-PROGRAM NOT = THIS-PGM
  5750        IF PI-RETURN-TO-PROGRAM NOT = THIS-PGM
  5751           MOVE PI-SAVED-PROGRAM-5   TO PI-SAVED-PROGRAM-6
  5752           MOVE PI-SAVED-PROGRAM-4   TO PI-SAVED-PROGRAM-5
  5753           MOVE PI-SAVED-PROGRAM-3   TO PI-SAVED-PROGRAM-4
  5754           MOVE PI-SAVED-PROGRAM-2   TO PI-SAVED-PROGRAM-3
  5755           MOVE PI-SAVED-PROGRAM-1   TO PI-SAVED-PROGRAM-2
  5756           MOVE PI-RETURN-TO-PROGRAM TO PI-SAVED-PROGRAM-1
  5757           MOVE PI-CALLING-PROGRAM   TO PI-RETURN-TO-PROGRAM
  5758           MOVE THIS-PGM             TO PI-CALLING-PROGRAM
  5759           MOVE LOW-VALUES             TO EL631II
  5760           MOVE 'Y'                  TO PI-CLEAR-ERROR-SW
  5761           GO TO 0350-DISPLAY-COMMON-DATA
  5762        END-IF
  5763     END-IF
  5764     IF PI-CALLING-PROGRAM = 'EL614'
  5765        MOVE PI-PROGRAM-WORK-AREA (1:60)
  5766                                 TO WS-PASSED-REASON-CODES
  5767        DISPLAY ' COMING BACK FROM 614 ' WS-PASSED-REASON-CODES
  5768        IF WS-PASSED-REASON-CODES NOT = SPACES
  5769           MOVE 'Y'                TO WS-SET-CODES-MDT
  5770        ELSE
  5771           MOVE 'N'                TO WS-SET-CODES-MDT
  5772        END-IF
  5773        PERFORM 0610-RECOVER-TEMP-STORAGE
  5774                                 THRU 0610-EXIT
  5775        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5776        GO TO 0350-DISPLAY-COMMON-DATA
  5777     END-IF
  5778     IF EIBAID = DFHCLEAR
  5779        IF PI-CLEAR-ERROR
  5780           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5781           MOVE ER-3833           TO EMI-ERROR
  5782           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5783           GO TO 0350-DISPLAY-COMMON-DATA
  5784        ELSE
  5785           GO TO 9400-CLEAR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 102
* EL6316.cbl
  5786        END-IF
  5787     END-IF
  5788     .
  5789 0200-RECEIVE.
  5790     IF EIBAID = DFHPA1 OR DFHPA2 OR DFHPA3
  5791        MOVE ER-0008             TO EMI-ERROR
  5792        PERFORM 9900-ERROR-FORMAT
  5793                                 THRU 9900-EXIT
  5794        MOVE -1                  TO PFENTRL
  5795        GO TO 8100-SEND-INITIAL-MAP
  5796     END-IF
  5797
  5798* EXEC CICS RECEIVE
  5799*        MAP      (MAP-NAME)
  5800*        MAPSET   (MAPSET-NAME)
  5801*        INTO     (EL631II)
  5802*    END-EXEC
  5803     MOVE LENGTH OF
  5804      EL631II
  5805       TO DFHEIV11
  5806*    MOVE '8"T I  L              ''   #00005793' TO DFHEIV0
  5807     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  5808     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  5809     MOVE X'2020233030303035373933' TO DFHEIV0(25:11)
  5810     CALL 'kxdfhei1' USING DFHEIV0,
  5811           MAP-NAME,
  5812           EL631II,
  5813           DFHEIV11,
  5814           MAPSET-NAME,
  5815           DFHEIV99,
  5816           DFHEIV99
  5817     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5818     IF PFENTRL = 0
  5819         GO TO 0300-CHECK-PFKEYS
  5820     END-IF
  5821     IF EIBAID NOT = DFHENTER
  5822         MOVE ER-0004            TO EMI-ERROR
  5823         GO TO 0320-INPUT-ERROR
  5824     END-IF
  5825     IF (PFENTRI NUMERIC) AND (PFENTRI > 0 AND < 25)
  5826        MOVE PF-VALUES (PFENTRI) TO EIBAID
  5827     ELSE
  5828        MOVE ER-0029            TO EMI-ERROR
  5829        GO TO 0320-INPUT-ERROR
  5830     END-IF
  5831     .
  5832 0300-CHECK-PFKEYS.
  5833     IF EIBAID = DFHPF1
  5834        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5835        PERFORM 0520-ERENDT-STARTBR
  5836                                 THRU 0520-EXIT
  5837        PERFORM 0510-ERENDT-READNEXT
  5838                                 THRU 0510-EXIT
  5839        IF ERENDT-KEY = PI-PREV-ERENDT-KEY
  5840            PERFORM 0510-ERENDT-READNEXT
  5841                                 THRU 0510-EXIT
  5842        END-IF
  5843        IF (RESP-NORMAL) AND
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 103
* EL6316.cbl
  5844         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5845           PERFORM 0390-BUILD-FROM-ERENDT
  5846                                 THRU 0390-EXIT
  5847           MOVE 'Y'              TO PI-ENDORSE-RECORD
  5848           MOVE ER-0000          TO EMI-ERROR
  5849           PERFORM 9900-ERROR-FORMAT
  5850                                 THRU 9900-EXIT
  5851           GO TO 8100-SEND-INITIAL-MAP
  5852        ELSE
  5853           MOVE ER-2237          TO EMI-ERROR
  5854           MOVE -1               TO CARRL
  5855           PERFORM 9900-ERROR-FORMAT
  5856                                 THRU 9900-EXIT
  5857           GO TO 8200-SEND-DATAONLY
  5858        END-IF
  5859     END-IF
  5860     IF EIBAID = DFHPF2
  5861        MOVE PI-ERENDT-KEY       TO ERENDT-KEY
  5862        PERFORM 0520-ERENDT-STARTBR
  5863                                 THRU 0520-EXIT
  5864        PERFORM 0510-ERENDT-READNEXT
  5865                                 THRU 0510-EXIT
  5866        PERFORM 0530-ERENDT-READPREV
  5867                                 THRU 0530-EXIT
  5868        PERFORM 0530-ERENDT-READPREV
  5869                                 THRU 0530-EXIT
  5870        IF (RESP-NORMAL) AND
  5871         (PI-ERENDT-KEY (1:34) = EN-CONTROL-PRIMARY (1:34))
  5872           PERFORM 0390-BUILD-FROM-ERENDT
  5873                                 THRU 0390-EXIT
  5874           MOVE 'Y'              TO PI-ENDORSE-RECORD
  5875           MOVE ER-0000          TO EMI-ERROR
  5876           PERFORM 9900-ERROR-FORMAT
  5877                                 THRU 9900-EXIT
  5878           GO TO 8100-SEND-INITIAL-MAP
  5879        ELSE
  5880           MOVE 'N'              TO PI-ENDORSE-RECORD
  5881           MOVE LOW-VALUES       TO  EL631II
  5882           GO TO 0350-DISPLAY-COMMON-DATA
  5883           MOVE ER-2238          TO EMI-ERROR
  5884           PERFORM 9900-ERROR-FORMAT
  5885                                 THRU 9900-EXIT
  5886           MOVE -1               TO CARRL
  5887           GO TO 8200-SEND-DATAONLY
  5888        END-IF
  5889     END-IF
  5890
  5891     IF (EIBAID = DFHPF3 OR DFHPF4 OR DFHPF8) AND
  5892        PI-FROM-CERT = 'Y' AND
  5893        NOT PI-PROCESSOR-IS-CSR-SUPER
  5894           GO TO 0300-CONTINUE
  5895     END-IF
  5896
  5897     IF (EIBAID = DFHPF3 OR DFHPF4 OR DFHPF8) AND
  5898        PI-ENDORSE-RECORD = 'Y'
  5899           GO TO 0300-CONTINUE
  5900     END-IF
  5901     IF EIBAID = DFHPF3
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 104
* EL6316.cbl
  5902        IF PI-FROM-CERT = 'Y'
  5903         AND PI-PROCESSOR-IS-CSR-SUPER
  5904            MOVE PI-ELCRTO-KEY      TO ELCRTO-KEY
  5905            PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  5906            PERFORM 0785-CHG-CRTO-REC THRU 0785-EXIT
  5907        END-IF
  5908
  5909        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5910        PERFORM 0600-CREATE-TEMP-STORAGE
  5911                                 THRU 0600-EXIT
  5912        MOVE 'EL614'             TO PGM-NAME
  5913        MOVE SPACES              TO PI-PROGRAM-WORK-AREA
  5914        MOVE +1                  TO S2
  5915        PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  5916           IF REACD-IN (S1) NOT = SPACES AND LOW-VALUES
  5917              MOVE REACD-IN (S1) TO PI-PROGRAM-WORK-AREA (S2:4)
  5918              ADD +5 TO S2
  5919           END-IF
  5920        END-PERFORM
  5921        DISPLAY ' GOING TO 614 ' PI-PROGRAM-WORK-AREA (1:60)
  5922        GO TO 9300-XCTL
  5923     END-IF
  5924     IF EIBAID = DFHPF4 OR DFHPF8
  5925        GO TO 1000-FINALIZE
  5926     END-IF
  5927
  5928      .
  5929 0300-CONTINUE.
  5930     IF EIBAID = DFHPF23
  5931        IF PI-CLEAR-ERROR
  5932           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5933           MOVE ER-3833           TO EMI-ERROR
  5934           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5935           GO TO 0350-DISPLAY-COMMON-DATA
  5936        ELSE
  5937           GO TO 8810-PF23
  5938        END-IF
  5939     END-IF
  5940     IF EIBAID = DFHPF24
  5941        IF PI-CLEAR-ERROR
  5942           MOVE SPACES            TO PI-CLEAR-ERROR-SW
  5943           MOVE ER-3833           TO EMI-ERROR
  5944           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5945           GO TO 0350-DISPLAY-COMMON-DATA
  5946        ELSE
  5947           GO TO 9200-RETURN-MAIN-MENU
  5948        END-IF
  5949     END-IF
  5950     IF EIBAID = DFHPF12
  5951        GO TO 9500-PF12
  5952     END-IF
  5953
  5954     IF EIBAID = DFHENTER
  5955      AND PI-FROM-CERT = 'Y'
  5956      AND PI-PROCESSOR-IS-CSR-SUPER
  5957      AND PI-ENDORSE-RECORD NOT EQUAL 'Y'
  5958         MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  5959         PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 105
* EL6316.cbl
  5960         PERFORM 0785-CHG-CRTO-REC THRU 0785-EXIT
  5961         PERFORM 0755-READ-CERT THRU 0755-EXIT
  5962         PERFORM 0770-MOVE-CERT-TO-SCREEN THRU 0770-EXIT
  5963*         MOVE ER-0000          TO EMI-ERROR
  5964*         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5965*         GO TO 8100-SEND-INITIAL-MAP
  5966     END-IF
  5967     IF EIBAID = DFHENTER
  5968        MOVE 'Y'                 TO PI-CLEAR-ERROR-SW
  5969        PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  5970        IF EMI-NO-ERRORS
  5971           GO TO 0350-DISPLAY-COMMON-DATA
  5972        ELSE
  5973           GO TO 8200-SEND-DATAONLY
  5974        END-IF
  5975     END-IF
  5976     MOVE ER-0029                TO EMI-ERROR
  5977     .
  5978 0320-INPUT-ERROR.
  5979     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5980     MOVE AL-UNBON               TO PFENTRA
  5981     MOVE -1                     TO PFENTRL
  5982     GO TO 8200-SEND-DATAONLY
  5983     .
  5984 0325-EDIT-SCREEN.
  5985     IF PRTSWL > ZEROS
  5986        IF PRTSWI = 'Y' OR 'N' OR 'P' OR ' '
  5987*          move prtswi to w-prtsw
  5988*          MOVE AL-UANON         TO PRTSWA
  5989*          IF PRTSWI = ' '
  5990              MOVE 'P'         TO PRTSWI
  5991*          END-IF
  5992*          MOVE PRTSWI         TO PI-PRTSW-ENTERED
  5993        END-IF
  5994     END-IF
  5995     IF LTRIDL > ZEROS
  5996        AND LTRIDI > SPACES
  5997        MOVE PI-COMPANY-CD       TO LETR-COMPANY-CD
  5998        MOVE LTRIDI              TO LETR-LETTER-ID
  5999                                    PI-LTRID-ENTERED
  6000        MOVE LETR-PART-KEY       TO ELLETR-SAVE-PART-KEY
  6001        MOVE SPACES              TO LETR-FILLER
  6002        MOVE 0                   TO LETR-SEQ-NO
  6003        PERFORM 0326-GET-Z-RECORD THRU 0326-EXIT
  6004     ELSE
  6005        MOVE ER-1236          TO EMI-ERROR
  6006        MOVE -1               TO LTRIDL
  6007        MOVE AL-UABON         TO LTRIDA
  6008        PERFORM 9900-ERROR-FORMAT
  6009                                 THRU 9900-EXIT
  6010     END-IF
  6011
  6012     IF W-PROMPT-LETTER EQUAL 'Y'
  6013         MOVE ER-0894            TO EMI-ERROR
  6014         MOVE -1                 TO LTRIDL
  6015         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6016     END-IF
  6017
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 106
* EL6316.cbl
  6018     IF ENCCODEL > ZEROS
  6019        MOVE FUNCTION UPPER-CASE(ENCCODEI) TO ENCCODEI
  6020                                              PI-ENCCODE
  6021        MOVE SPACES             TO WS-ELENCC-KEY
  6022        MOVE PI-COMPANY-CD      TO WS-ENCC-COMPANY-CD
  6023        MOVE '2'                TO WS-ENCC-REC-TYPE
  6024        MOVE ENCCODEI           TO WS-ENCC-ENC-CODE
  6025
  6026
  6027* EXEC CICS READ
  6028*           DATASET    (WS-ELENCC-FILE-ID)
  6029*           SET        (ADDRESS OF ENCLOSURE-CODES)
  6030*           RIDFLD     (WS-ELENCC-KEY)
  6031*           RESP       (WS-RESPONSE)
  6032*       END-EXEC
  6033*    MOVE '&"S        E          (  N#00006006' TO DFHEIV0
  6034     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6035     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6036     MOVE X'204E233030303036303036' TO DFHEIV0(25:11)
  6037     CALL 'kxdfhei1' USING DFHEIV0,
  6038           WS-ELENCC-FILE-ID,
  6039           DFHEIV20,
  6040           DFHEIV99,
  6041           WS-ELENCC-KEY,
  6042           DFHEIV99,
  6043           DFHEIV99,
  6044           DFHEIV99
  6045     SET ADDRESS OF ENCLOSURE-CODES TO
  6046         DFHEIV20
  6047     MOVE EIBRESP  TO WS-RESPONSE
  6048     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6049
  6050        IF RESP-NORMAL
  6051           MOVE ENCCODEI         TO PI-ENCCODE
  6052                                    W-ENCLOSURE-CD
  6053           MOVE AL-UANON         TO ENCCODEA
  6054        ELSE
  6055           MOVE ER-1560          TO EMI-ERROR
  6056           MOVE -1               TO ENCCODEL
  6057           MOVE AL-UABON         TO ENCCODEA
  6058           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6059        END-IF
  6060     END-IF
  6061
  6062     SET REASONS-NOT-FOUND TO TRUE
  6063     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6064        IF REACDL (S1) = +4 OR
  6065          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6066              MOVE AL-SANON     TO REACDA (S1)
  6067              SET REASONS-FOUND TO TRUE
  6068        END-IF
  6069     END-PERFORM
  6070
  6071     IF REASONS-NOT-FOUND
  6072        MOVE ER-1820             TO EMI-ERROR
  6073        MOVE -1                  TO PFENTRL
  6074        PERFORM 9900-ERROR-FORMAT
  6075                                 THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 107
* EL6316.cbl
  6076     ELSE
  6077        MOVE REASONCDS           TO PI-REASONS-ENTERED
  6078     END-IF
  6079
  6080     IF CRTNT1L > ZEROS
  6081        IF CRTNT1I > SPACES
  6082           MOVE CRTNT1I          TO PI-CERTNT1-ENTERED
  6083        END-IF
  6084     END-IF
  6085
  6086     IF CRTNT2L > ZEROS
  6087        IF CRTNT2I > SPACES
  6088           MOVE CRTNT2I          TO PI-CERTNT2-ENTERED
  6089        END-IF
  6090     END-IF
  6091
  6092     IF BILNT1L > ZEROS
  6093        IF BILNT1I > SPACES
  6094           MOVE BILNT1I          TO PI-BILLNT1-ENTERED
  6095        END-IF
  6096     END-IF
  6097
  6098     .
  6099 0325-EXIT.
  6100     EXIT.
  6101
  6102 0326-GET-Z-RECORD.
  6103
  6104     MOVE SPACES  TO W-Z-CONTROL-DATA
  6105
  6106
  6107* EXEC CICS STARTBR
  6108*         DATASET    ('ELLETR')
  6109*         RIDFLD     (ELLETR-KEY)
  6110*         GTEQ
  6111*         RESP      (WS-RESPONSE)
  6112*    END-EXEC.
  6113     MOVE 'ELLETR' TO DFHEIV1
  6114     MOVE 0
  6115       TO DFHEIV11
  6116*    MOVE '&,         G          &  N#00006069' TO DFHEIV0
  6117     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6118     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6119     MOVE X'204E233030303036303639' TO DFHEIV0(25:11)
  6120     CALL 'kxdfhei1' USING DFHEIV0,
  6121           DFHEIV1,
  6122           ELLETR-KEY,
  6123           DFHEIV99,
  6124           DFHEIV11,
  6125           DFHEIV99
  6126     MOVE EIBRESP  TO WS-RESPONSE
  6127     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6128
  6129     IF NOT RESP-NORMAL
  6130         MOVE ER-1236          TO EMI-ERROR
  6131         MOVE -1               TO LTRIDL
  6132         MOVE AL-UABON         TO LTRIDA
  6133         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 108
* EL6316.cbl
  6134         GO TO 0326-ENDBR
  6135     END-IF.
  6136
  6137 0326-READNEXT.
  6138
  6139
  6140* EXEC CICS READNEXT
  6141*        DATASET   ('ELLETR')
  6142*        INTO      (TEXT-FILES)
  6143*        RIDFLD    (ELLETR-KEY)
  6144*        RESP      (WS-RESPONSE)
  6145*    END-EXEC
  6146     MOVE LENGTH OF
  6147      TEXT-FILES
  6148       TO DFHEIV12
  6149     MOVE 'ELLETR' TO DFHEIV1
  6150     MOVE 0
  6151       TO DFHEIV11
  6152*    MOVE '&.IL                  )  N#00006085' TO DFHEIV0
  6153     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  6154     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  6155     MOVE X'204E233030303036303835' TO DFHEIV0(25:11)
  6156     CALL 'kxdfhei1' USING DFHEIV0,
  6157           DFHEIV1,
  6158           TEXT-FILES,
  6159           DFHEIV12,
  6160           ELLETR-KEY,
  6161           DFHEIV99,
  6162           DFHEIV11,
  6163           DFHEIV99,
  6164           DFHEIV99
  6165     MOVE EIBRESP  TO WS-RESPONSE
  6166     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6167     IF RESP-NORMAL
  6168        IF TX-CONTROL-PRIMARY(1:5) NOT = ELLETR-SAVE-PART-KEY
  6169           MOVE ER-1236          TO EMI-ERROR
  6170           MOVE -1               TO LTRIDL
  6171           MOVE AL-UABON         TO LTRIDA
  6172           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6173           GO TO 0326-ENDBR
  6174        END-IF
  6175
  6176        MOVE AL-UANON         TO LTRIDA
  6177        IF TX-LINE-SQUEEZE-CONTROL = 'Z'
  6178           MOVE TX-TEXT-LINE  TO W-Z-CONTROL-DATA
  6179        ELSE
  6180           GO TO 0326-READNEXT
  6181        END-IF
  6182     ELSE
  6183        MOVE ER-1236          TO EMI-ERROR
  6184        MOVE -1               TO LTRIDL
  6185        MOVE AL-UABON         TO LTRIDA
  6186        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  6187        GO TO 0326-ENDBR
  6188     END-IF.
  6189
  6190     IF PI-ENCCODE NOT GREATER THAN SPACES
  6191         MOVE W-ENCLOSURE-CD            TO PI-ENCCODE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 109
* EL6316.cbl
  6192                                           ENCCODEO
  6193         MOVE AL-UANON                  TO ENCCODEA
  6194         MOVE +3                        TO ENCCODEL
  6195     END-IF.
  6196
  6197 0326-ENDBR.
  6198
  6199
  6200* EXEC CICS ENDBR
  6201*        DATASET     ('ELLETR')
  6202*    END-EXEC.
  6203     MOVE 'ELLETR' TO DFHEIV1
  6204     MOVE 0
  6205       TO DFHEIV11
  6206*    MOVE '&2                    $   #00006123' TO DFHEIV0
  6207     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6208     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6209     MOVE X'2020233030303036313233' TO DFHEIV0(25:11)
  6210     CALL 'kxdfhei1' USING DFHEIV0,
  6211           DFHEIV1,
  6212           DFHEIV11,
  6213           DFHEIV99
  6214     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6215
  6216
  6217 0326-EXIT.
  6218      EXIT.
  6219 0350-DISPLAY-COMMON-DATA.
  6220     display ' made it to 0350 '
  6221
  6222     IF PI-FROM-CERT = 'Y'
  6223         PERFORM 0700-LOAD-FROM-CERT THRU 0700-EXIT
  6224     ELSE
  6225         PERFORM 0360-CHECK-PENDING THRU 0360-EXIT
  6226     END-IF
  6227     IF PI-LTRID-ENTERED > SPACES
  6228        MOVE PI-LTRID-ENTERED    TO LTRIDI
  6229        MOVE AL-UANON            TO LTRIDA
  6230        MOVE +4                  TO LTRIDL
  6231     ELSE
  6232        IF PI-CLM-RESCISSION
  6233            MOVE 'CLRC'          TO LTRIDI
  6234                                    PI-LTRID-ENTERED
  6235            MOVE +4              TO LTRIDL
  6236            MOVE AL-UANON        TO LTRIDA
  6237        END-IF
  6238     END-IF
  6239
  6240     IF PI-ENCCODE > SPACES
  6241        MOVE PI-ENCCODE          TO ENCCODEI
  6242        MOVE AL-UANON            TO ENCCODEA
  6243        MOVE +3                  TO ENCCODEL
  6244     END-IF
  6245
  6246     SET REASONS-NOT-FOUND TO TRUE
  6247     MOVE PI-REASONS-ENTERED     TO REASONCDS
  6248     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6249        IF REACDL (S1) = +4 OR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 110
* EL6316.cbl
  6250          (REACD-IN (S1) NOT = SPACES AND LOW-VALUES)
  6251              MOVE AL-SANON      TO REACDA (S1)
  6252              MOVE +4            TO REACDL (S1)
  6253              SET REASONS-FOUND  TO TRUE
  6254        END-IF
  6255     END-PERFORM
  6256
  6257     IF REASONS-NOT-FOUND
  6258         IF PI-CLM-RESCISSION
  6259            MOVE 'CRNA'          TO REACD-IN (1)
  6260            MOVE AL-SANON        TO REACDA (1)
  6261            MOVE +4              TO REACDL (1)
  6262            SET REASONS-FOUND    TO TRUE
  6263        END-IF
  6264     END-IF
  6265
  6266     IF PI-CERTNT1-ENTERED > SPACES
  6267        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6268        MOVE AL-UANON            TO CRTNT1A
  6269        MOVE +63                 TO CRTNT1L
  6270     END-IF
  6271
  6272     IF PI-CERTNT2-ENTERED > SPACES
  6273        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6274        MOVE AL-UANON            TO CRTNT2A
  6275        MOVE +63                 TO CRTNT2L
  6276     END-IF
  6277
  6278     IF PI-BILLNT1-ENTERED > SPACES
  6279        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6280        MOVE AL-UANON            TO BILNT1A
  6281        MOVE +63                 TO BILNT1L
  6282     END-IF
  6283     GO TO 8100-SEND-INITIAL-MAP
  6284     .
  6285 0350-EXIT.
  6286     EXIT.
  6287 0360-CHECK-PENDING.
  6288     display ' made it to 0360 '
  6289     MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  6290     MOVE PI-CARRIER             TO CRTO-CARRIER
  6291     MOVE PI-GROUPING            TO CRTO-GROUPING
  6292     MOVE PI-STATE               TO CRTO-STATE
  6293     MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  6294     MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  6295     MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
  6296     MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  6297     MOVE 'I'                    TO CRTO-RECORD-TYPE
  6298     MOVE ZEROS                  TO CRTO-SEQ-NO
  6299     MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  6300     MOVE ELCRTO-KEY (1:33)      TO PI-ERENDT-KEY (1:33)
  6301     MOVE 'C'                    TO PI-ENDT-RECORD-TYPE
  6302     MOVE ZEROS                  TO PI-ENDT-SEQ-NO
  6303     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  6304     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  6305      display 'response ' ws-response
  6306      display 'pi-elcrto-key ' pi-elcrto-key
  6307      display 'oc key ' oc-control-primary
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 111
* EL6316.cbl
  6308     IF RESP-NORMAL
  6309       IF (PI-ELCRTO-KEY (1:33) =
  6310              OC-CONTROL-PRIMARY (1:33))
  6311          DISPLAY 'CRTO RESP NORMAL '
  6312          MOVE OC-CONTROL-PRIMARY  TO PI-ELCRTO-KEY
  6313          PERFORM 0361-MOVE-CRTO-TO-SCREEN THRU 0361-EXIT
  6314          PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  6315          IF RESP-NORMAL
  6316             MOVE PB-CONTROL-PRIMARY TO PI-ERPNDB-KEY
  6317             PERFORM 0380-BUILD-FROM-ERPNDB THRU 0380-EXIT
  6318          END-IF
  6319       ELSE
  6320          MOVE ER-3829           TO EMI-ERROR
  6321          PERFORM 9900-ERROR-FORMAT
  6322                                 THRU 9900-EXIT
  6323          MOVE -1                TO CARRL
  6324          GO TO 8100-SEND-INITIAL-MAP
  6325       END-IF
  6326     ELSE
  6327        MOVE ER-3829             TO EMI-ERROR
  6328        PERFORM 9900-ERROR-FORMAT
  6329                                 THRU 9900-EXIT
  6330        MOVE -1                  TO CARRL
  6331        GO TO 8100-SEND-INITIAL-MAP
  6332     END-IF
  6333     .
  6334 0360-EXIT.
  6335     EXIT.
  6336 0361-MOVE-CRTO-TO-SCREEN.
  6337     display ' made it to 0361 '
  6338     MOVE OC-LF-CANCEL-DT          TO DC-BIN-DATE-1
  6339     MOVE ' '                      TO DC-OPTION-CODE
  6340     PERFORM 9700-DATE-LINK
  6341     IF NO-CONVERSION-ERROR
  6342        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  6343     END-IF
  6344     MOVE OC-AH-CANCEL-DT          TO DC-BIN-DATE-1
  6345     MOVE ' '                      TO DC-OPTION-CODE
  6346     PERFORM 9700-DATE-LINK
  6347     IF NO-CONVERSION-ERROR
  6348        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
  6349     END-IF
  6350     IF OC-LF-CANCEL-AMT NUMERIC
  6351        MOVE OC-LF-CANCEL-AMT      TO OLFAMTO
  6352     ELSE
  6353        MOVE ZEROS                 TO OLFAMTO
  6354     END-IF
  6355     IF OC-AH-CANCEL-AMT NUMERIC
  6356        MOVE OC-AH-CANCEL-AMT      TO OAHAMTO
  6357     ELSE
  6358        MOVE ZEROS                 TO OAHAMTO
  6359     END-IF
  6360     .
  6361 0361-EXIT.
  6362     EXIT.
  6363 0362-READ-ELCRTO.
  6364     display ' made it to 0362 '
  6365
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 112
* EL6316.cbl
  6366* EXEC CICS READ
  6367*        DATASET   (WS-ELCRTO-FILE-ID)
  6368*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6369*        RIDFLD    (ELCRTO-KEY)
  6370*        GTEQ
  6371*        RESP      (WS-RESPONSE)
  6372*    END-EXEC
  6373*    MOVE '&"S        G          (  N#00006275' TO DFHEIV0
  6374     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6375     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6376     MOVE X'204E233030303036323735' TO DFHEIV0(25:11)
  6377     CALL 'kxdfhei1' USING DFHEIV0,
  6378           WS-ELCRTO-FILE-ID,
  6379           DFHEIV20,
  6380           DFHEIV99,
  6381           ELCRTO-KEY,
  6382           DFHEIV99,
  6383           DFHEIV99,
  6384           DFHEIV99
  6385     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6386         DFHEIV20
  6387     MOVE EIBRESP  TO WS-RESPONSE
  6388     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6389     .
  6390 0362-EXIT.
  6391     EXIT.
  6392 0363-READ-ELCRTO-UPD.
  6393     display ' made it to 0363 '
  6394
  6395* EXEC CICS READ
  6396*        DATASET   (WS-ELCRTO-FILE-ID)
  6397*        SET       (ADDRESS OF ORIGINAL-CERTIFICATE)
  6398*        RIDFLD    (ELCRTO-KEY)
  6399*        UPDATE
  6400*        RESP      (WS-RESPONSE)
  6401*    END-EXEC
  6402*    MOVE '&"S        EU         (  N#00006287' TO DFHEIV0
  6403     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6404     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  6405     MOVE X'204E233030303036323837' TO DFHEIV0(25:11)
  6406     CALL 'kxdfhei1' USING DFHEIV0,
  6407           WS-ELCRTO-FILE-ID,
  6408           DFHEIV20,
  6409           DFHEIV99,
  6410           ELCRTO-KEY,
  6411           DFHEIV99,
  6412           DFHEIV99,
  6413           DFHEIV99
  6414     SET ADDRESS OF ORIGINAL-CERTIFICATE TO
  6415         DFHEIV20
  6416     MOVE EIBRESP  TO WS-RESPONSE
  6417     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6418     .
  6419 0363-EXIT.
  6420     EXIT.
  6421
  6422 0364-MOVE-ZERO-TO-SCREEN.
  6423
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 113
* EL6316.cbl
  6424     MOVE ZEROS    TO OLFDTO
  6425                      OAHDTO
  6426                      OLFAMTO
  6427                      OAHAMTO.
  6428
  6429 0364-EXIT.
  6430     EXIT.
  6431
  6432 0365-READ-ERENDT.
  6433
  6434* EXEC CICS READ
  6435*        DATASET   (WS-ERENDT-FILE-ID)
  6436*        SET       (ADDRESS OF ENDORSEMENT-RECORD)
  6437*        RIDFLD    (ERENDT-KEY)
  6438*        RESP      (WS-RESPONSE)
  6439*    END-EXEC
  6440*    MOVE '&"S        E          (  N#00006309' TO DFHEIV0
  6441     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6442     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6443     MOVE X'204E233030303036333039' TO DFHEIV0(25:11)
  6444     CALL 'kxdfhei1' USING DFHEIV0,
  6445           WS-ERENDT-FILE-ID,
  6446           DFHEIV20,
  6447           DFHEIV99,
  6448           ERENDT-KEY,
  6449           DFHEIV99,
  6450           DFHEIV99,
  6451           DFHEIV99
  6452     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6453         DFHEIV20
  6454     MOVE EIBRESP  TO WS-RESPONSE
  6455     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6456     .
  6457 0365-EXIT.
  6458     EXIT.
  6459 0370-READ-ERPNDB.
  6460     display ' made it to 0370 '
  6461     MOVE PI-COMPANY-CD          TO PNDB2-COMPANY-CD
  6462     MOVE PI-CRTO-CARRIER        TO PNDB2-CARRIER
  6463     MOVE PI-CRTO-GROUPING       TO PNDB2-GROUPING
  6464     MOVE PI-CRTO-STATE          TO PNDB2-STATE
  6465     MOVE PI-CRTO-ACCOUNT        TO PNDB2-ACCOUNT
  6466     MOVE PI-CRTO-CERT-PRIME     TO PNDB2-CERT-PRIME
  6467     MOVE PI-CRTO-CERT-SFX       TO PNDB2-CERT-SFX
  6468     MOVE PI-CRTO-CERT-EFF-DT    TO PNDB2-CERT-EFF-DT
  6469     MOVE +0                     TO PNDB2-CHG-SEQ-NO
  6470     MOVE '2'                    TO PNDB2-RECORD-TYPE
  6471
  6472* EXEC CICS READ
  6473*        DATASET   (WS-ERPNDB2-FILE-ID)
  6474*        SET       (ADDRESS OF PENDING-BUSINESS)
  6475*        RIDFLD    (ERPNDB2-KEY)
  6476*        RESP      (WS-RESPONSE)
  6477*    END-EXEC
  6478*    MOVE '&"S        E          (  N#00006330' TO DFHEIV0
  6479     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6480     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6481     MOVE X'204E233030303036333330' TO DFHEIV0(25:11)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 114
* EL6316.cbl
  6482     CALL 'kxdfhei1' USING DFHEIV0,
  6483           WS-ERPNDB2-FILE-ID,
  6484           DFHEIV20,
  6485           DFHEIV99,
  6486           ERPNDB2-KEY,
  6487           DFHEIV99,
  6488           DFHEIV99,
  6489           DFHEIV99
  6490     SET ADDRESS OF PENDING-BUSINESS TO
  6491         DFHEIV20
  6492     MOVE EIBRESP  TO WS-RESPONSE
  6493     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6494     .
  6495 0370-EXIT.
  6496     EXIT.
  6497 0380-BUILD-FROM-ERPNDB.
  6498     display ' made it to 0380 '
  6499     MOVE PB-CARRIER             TO CARRO
  6500     MOVE PB-GROUPING            TO GROUPO
  6501     MOVE PB-STATE               TO STATEO
  6502     MOVE PB-ACCOUNT             TO ACCTO
  6503     MOVE PB-CERT-PRIME          TO CERTNOO
  6504     MOVE PB-CERT-SFX            TO CRTSFXO
  6505     MOVE PB-CERT-EFF-DT         TO DC-BIN-DATE-1
  6506     MOVE ' '                    TO DC-OPTION-CODE
  6507     PERFORM 9700-DATE-LINK
  6508     IF NO-CONVERSION-ERROR
  6509        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6510     END-IF
  6511     MOVE PB-CI-LAST-NAME        TO LNAMEO
  6512     MOVE PB-CI-FIRST-NAME       TO FNAMEO
  6513     MOVE PB-CI-INITIALS (2:1)   TO MINITO
  6514     MOVE PB-C-LF-CANCEL-DT        TO DC-BIN-DATE-1
  6515     MOVE ' '                      TO DC-OPTION-CODE
  6516     PERFORM 9700-DATE-LINK
  6517     IF NO-CONVERSION-ERROR
  6518        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6519     END-IF
  6520     MOVE PB-C-AH-CANCEL-DT        TO DC-BIN-DATE-1
  6521     MOVE ' '                      TO DC-OPTION-CODE
  6522     PERFORM 9700-DATE-LINK
  6523     IF NO-CONVERSION-ERROR
  6524        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6525     END-IF
  6526     MOVE PB-C-LF-CANCEL-AMT       TO NLFAMTO
  6527     MOVE PB-C-AH-CANCEL-AMT       TO NAHAMTO
  6528     IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  6529        MOVE PB-CI-LIFE-COMMISSION
  6530                              TO LFCOMMO
  6531*       MOVE AL-UNNON         TO LFCOMMA
  6532     END-IF
  6533     IF PB-CI-AH-COMMISSION NOT = ZEROS
  6534        MOVE PB-CI-AH-COMMISSION
  6535                              TO AHCOMMO
  6536*       MOVE AL-UNNON         TO AHCOMMA
  6537     END-IF
  6538     MOVE ER-2785                TO EMI-ERROR
  6539     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 115
* EL6316.cbl
  6540     .
  6541 0380-EXIT.
  6542     EXIT.
  6543 0390-BUILD-FROM-ERENDT.
  6544     MOVE LOW-VALUES             TO EL631II
  6545*    move PI-PRTSW-ENTERED       to prtswo
  6546     IF PI-CERTNT1-ENTERED > SPACES
  6547        MOVE PI-CERTNT1-ENTERED  TO CRTNT1I
  6548        MOVE AL-UANON            TO CRTNT1A
  6549        MOVE +63                 TO CRTNT1L
  6550     END-IF
  6551
  6552     IF PI-CERTNT2-ENTERED > SPACES
  6553        MOVE PI-CERTNT2-ENTERED  TO CRTNT2I
  6554        MOVE AL-UANON            TO CRTNT2A
  6555        MOVE +63                 TO CRTNT2L
  6556     END-IF
  6557
  6558     IF PI-BILLNT1-ENTERED > SPACES
  6559        MOVE PI-BILLNT1-ENTERED  TO BILNT1I
  6560        MOVE AL-UANON            TO BILNT1A
  6561        MOVE +63                 TO BILNT1L
  6562     END-IF
  6563
  6564     IF PI-ENCCODE > SPACES
  6565         MOVE PI-ENCCODE         TO ENCCODEO
  6566         MOVE AL-UANON           TO ENCCODEA
  6567         MOVE +3                 TO ENCCODEL
  6568     END-IF.
  6569
  6570     MOVE PI-COMPANY-CD          TO PI-ENDT-COMPANY-CD
  6571     MOVE EN-CARRIER             TO PI-ENDT-CARRIER
  6572     MOVE EN-GROUPING            TO PI-ENDT-GROUPING
  6573     MOVE EN-STATE               TO PI-ENDT-STATE
  6574     MOVE EN-ACCOUNT             TO PI-ENDT-ACCOUNT
  6575     MOVE EN-CERT-PRIME          TO PI-ENDT-CERT-PRIME
  6576     MOVE EN-CERT-SFX            TO PI-ENDT-CERT-SFX
  6577     MOVE EN-CERT-EFF-DT         TO PI-ENDT-CERT-EFF-DT
  6578     MOVE EN-REC-TYPE            TO PI-ENDT-RECORD-TYPE
  6579     MOVE EN-SEQ-NO              TO PI-ENDT-SEQ-NO
  6580     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  6581     MOVE EN-CARRIER             TO CARRO
  6582     MOVE EN-GROUPING            TO GROUPO
  6583     MOVE EN-STATE               TO STATEO
  6584     MOVE EN-ACCOUNT             TO ACCTO
  6585     MOVE EN-CERT-PRIME          TO CERTNOO
  6586     MOVE EN-CERT-SFX            TO CRTSFXO
  6587     MOVE EN-SEQ-NO              TO SEQNOO
  6588     MOVE EN-TEMPLATE-USED       TO LTRIDO
  6589
  6590     IF PI-FROM-CERT = 'Y'
  6591         PERFORM 0755-READ-CERT THRU 0755-EXIT
  6592         MOVE CM-INSURED-LAST-NAME TO LNAMEO
  6593         MOVE CM-INSURED-FIRST-NAME TO FNAMEO
  6594         MOVE CM-INSURED-INITIAL2  TO MINITO
  6595         IF CM-LIFE-COMM-PCT NOT = ZEROS
  6596             MOVE CM-LIFE-COMM-PCT TO LFCOMMO
  6597         END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 116
* EL6316.cbl
  6598         IF CM-AH-COMM-PCT NOT = ZEROS
  6599             MOVE CM-AH-COMM-PCT   TO AHCOMMO
  6600         END-IF
  6601     ELSE
  6602        PERFORM 0370-READ-ERPNDB THRU 0370-EXIT
  6603        MOVE PB-CI-LAST-NAME        TO LNAMEO
  6604        MOVE PB-CI-FIRST-NAME       TO FNAMEO
  6605        MOVE PB-CI-INITIALS (2:1)   TO MINITO
  6606        IF PB-CI-LIFE-COMMISSION NOT = ZEROS
  6607           MOVE PB-CI-LIFE-COMMISSION TO LFCOMMO
  6608        END-IF
  6609        IF PB-CI-AH-COMMISSION NOT = ZEROS
  6610           MOVE PB-CI-AH-COMMISSION TO AHCOMMO
  6611        END-IF
  6612     END-IF
  6613     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6614        IF EN-REASON-CODE (S1) NOT = SPACES
  6615           MOVE EN-REASON-CODE (S1) TO REACD-IN (S1)
  6616           MOVE AL-SANON         TO REACDA (S1)
  6617           MOVE +4               TO REACDL (S1)
  6618        END-IF
  6619     END-PERFORM
  6620     MOVE EN-CERT-EFF-DT         TO DC-BIN-DATE-1
  6621     MOVE ' '                    TO DC-OPTION-CODE
  6622     PERFORM 9700-DATE-LINK
  6623     IF NO-CONVERSION-ERROR
  6624        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  6625     END-IF
  6626     IF EN-PROCESS-DT NOT = SPACES AND LOW-VALUES
  6627        MOVE EN-PROCESS-DT       TO DC-BIN-DATE-1
  6628        MOVE ' '                 TO DC-OPTION-CODE
  6629        PERFORM 9700-DATE-LINK
  6630        IF NO-CONVERSION-ERROR
  6631           MOVE DC-GREG-DATE-1-EDIT
  6632                                 TO PROCDTO
  6633        END-IF
  6634     END-IF
  6635     IF EN-INPUT-DT NOT = SPACES AND LOW-VALUES
  6636        MOVE EN-INPUT-DT         TO DC-BIN-DATE-1
  6637        MOVE ' '                 TO DC-OPTION-CODE
  6638        PERFORM 9700-DATE-LINK
  6639        IF NO-CONVERSION-ERROR
  6640           MOVE DC-GREG-DATE-1-EDIT
  6641                                 TO INPDTO
  6642        END-IF
  6643     END-IF
  6644     MOVE EN-LF-ORIG-REF-DT        TO DC-BIN-DATE-1
  6645     MOVE ' '                      TO DC-OPTION-CODE
  6646     PERFORM 9700-DATE-LINK
  6647     IF NO-CONVERSION-ERROR
  6648        MOVE DC-GREG-DATE-1-EDIT   TO OLFDTO
  6649     END-IF
  6650     MOVE EN-LF-ORIG-REF-AMT       TO OLFAMTO
  6651     MOVE EN-AH-ORIG-REF-DT        TO DC-BIN-DATE-1
  6652     MOVE ' '                      TO DC-OPTION-CODE
  6653     PERFORM 9700-DATE-LINK
  6654     IF NO-CONVERSION-ERROR
  6655        MOVE DC-GREG-DATE-1-EDIT   TO OAHDTO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 117
* EL6316.cbl
  6656     END-IF
  6657     MOVE EN-AH-ORIG-REF-AMT       TO OAHAMTO
  6658     MOVE EN-LF-NEW-REF-DT         TO DC-BIN-DATE-1
  6659     MOVE ' '                      TO DC-OPTION-CODE
  6660     PERFORM 9700-DATE-LINK
  6661     IF NO-CONVERSION-ERROR
  6662        MOVE DC-GREG-DATE-1-EDIT   TO NLFDTO
  6663     END-IF
  6664     MOVE EN-LF-NEW-REF-AMT        TO NLFAMTO
  6665     MOVE EN-AH-NEW-REF-DT         TO DC-BIN-DATE-1
  6666     MOVE ' '                      TO DC-OPTION-CODE
  6667     PERFORM 9700-DATE-LINK
  6668     IF NO-CONVERSION-ERROR
  6669        MOVE DC-GREG-DATE-1-EDIT   TO NAHDTO
  6670     END-IF
  6671     MOVE EN-AH-NEW-REF-AMT        TO NAHAMTO
  6672     MOVE EN-ARCHIVE-NO            TO ARCHNOO
  6673     .
  6674 0390-EXIT.
  6675     EXIT.
  6676 0400-ADD-ERENDT.
  6677     PERFORM 1500-GET-ARCH-NO    THRU 1500-EXIT
  6678
  6679* EXEC CICS GETMAIN
  6680*         SET      (ADDRESS OF ENDORSEMENT-RECORD)
  6681*         LENGTH   (ERENDT-LENGTH)
  6682*         INITIMG  (GETMAIN-SPACE)
  6683*    END-EXEC
  6684*    MOVE ',"IL                  $   #00006520' TO DFHEIV0
  6685     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  6686     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6687     MOVE X'2020233030303036353230' TO DFHEIV0(25:11)
  6688     CALL 'kxdfhei1' USING DFHEIV0,
  6689           DFHEIV20,
  6690           ERENDT-LENGTH,
  6691           GETMAIN-SPACE
  6692     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6693         DFHEIV20
  6694     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6695     PERFORM 0410-INIT-ERENDT    THRU 0410-EXIT
  6696     MOVE PI-PROCESSOR-ID        TO EN-LAST-MAINT-BY
  6697     MOVE EIBTIME                TO EN-LAST-MAINT-HHMMSS
  6698     MOVE WS-CURRENT-BIN-DT      TO EN-LAST-MAINT-DT
  6699                                    EN-INPUT-DT
  6700     MOVE OC-LF-CANCEL-DT        TO EN-LF-ORIG-REF-DT
  6701     MOVE OC-AH-CANCEL-DT        TO EN-AH-ORIG-REF-DT
  6702     MOVE OC-LF-CANCEL-AMT       TO EN-LF-ORIG-REF-AMT
  6703     MOVE OC-AH-CANCEL-AMT       TO EN-AH-ORIG-REF-AMT
  6704
  6705     MOVE OC-LF-ITD-CANCEL-AMT   TO NEW-LF-ITD-CANCEL-AMT
  6706     MOVE OC-AH-ITD-CANCEL-AMT   TO NEW-AH-ITD-CANCEL-AMT
  6707
  6708     MOVE OC-INS-LAST-NAME       TO EN-INS-LAST-NAME
  6709     MOVE OC-INS-FIRST-NAME      TO EN-INS-FIRST-NAME
  6710     MOVE OC-INS-MIDDLE-INIT     TO EN-INS-MIDDLE-INIT
  6711
  6712     MOVE OC-LF-COMM-PCT         TO EN-LF-ORIG-REF-COMM-PCT
  6713     MOVE OC-AH-COMM-PCT         TO EN-AH-ORIG-REF-COMM-PCT
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 118
* EL6316.cbl
  6714
  6715     IF PI-FROM-CERT = 'Y'
  6716         DISPLAY 'USING CERT FOR NEW'
  6717
  6718         MOVE PI-COMPANY-CD       TO  W-CERT-COMPANY-CD
  6719         MOVE PI-CRTO-CARRIER     TO  W-CERT-CARRIER
  6720         MOVE PI-CRTO-GROUPING    TO  W-CERT-GROUPING
  6721         MOVE PI-CRTO-STATE       TO  W-CERT-STATE
  6722         MOVE PI-CRTO-ACCOUNT     TO  W-CERT-ACCOUNT
  6723         MOVE PI-CRTO-CERT-EFF-DT TO  W-CERT-CERT-EFF-DT
  6724         MOVE PI-CRTO-CERT-PRIME  TO  W-CERT-CERT-PRIME
  6725         MOVE PI-CRTO-CERT-SFX    TO  W-CERT-CERT-SFX
  6726
  6727
  6728* EXEC CICS READ
  6729*            DATASET  (WS-ELCERT-FILE-ID)
  6730*            RIDFLD   (WS-ELCERT-KEY)
  6731*            SET      (ADDRESS OF CERTIFICATE-MASTER)
  6732*            RESP     (WS-RESPONSE)
  6733*        END-EXEC
  6734*    MOVE '&"S        E          (  N#00006557' TO DFHEIV0
  6735     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6736     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6737     MOVE X'204E233030303036353537' TO DFHEIV0(25:11)
  6738     CALL 'kxdfhei1' USING DFHEIV0,
  6739           WS-ELCERT-FILE-ID,
  6740           DFHEIV20,
  6741           DFHEIV99,
  6742           WS-ELCERT-KEY,
  6743           DFHEIV99,
  6744           DFHEIV99,
  6745           DFHEIV99
  6746     SET ADDRESS OF CERTIFICATE-MASTER TO
  6747         DFHEIV20
  6748     MOVE EIBRESP  TO WS-RESPONSE
  6749     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6750         IF NOT RESP-NORMAL
  6751            GO TO 0400-EXIT
  6752         END-IF
  6753
  6754         MOVE CM-LF-CANCEL-DT    TO EN-LF-NEW-REF-DT
  6755                                    NEW-LF-CANCEL-DT
  6756         MOVE CM-AH-CANCEL-DT    TO EN-AH-NEW-REF-DT
  6757                                    NEW-AH-CANCEL-DT
  6758
  6759         MOVE CM-LF-ITD-CANCEL-AMT TO EN-LF-NEW-REF-AMT
  6760                                      NEW-LF-CANCEL-AMT
  6761         MOVE CM-AH-ITD-CANCEL-AMT TO EN-AH-NEW-REF-AMT
  6762                                      NEW-AH-CANCEL-AMT
  6763
  6764         MOVE CM-LIFE-COMM-PCT   TO EN-LF-NEW-COMM-PCT
  6765                                    EN-LF-NEW-REF-COMM-PCT
  6766                                    NEW-LF-COMM-PCT
  6767
  6768         MOVE CM-AH-COMM-PCT     TO EN-AH-NEW-COMM-PCT
  6769                                    EN-AH-NEW-REF-COMM-PCT
  6770                                    NEW-AH-COMM-PCT
  6771
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 119
* EL6316.cbl
  6772
  6773         GO TO 0400-CONTINUE
  6774     END-IF.
  6775
  6776
  6777* EXEC CICS READ
  6778*        DATASET   (WS-ERPNDB-FILE-ID)
  6779*        SET       (ADDRESS OF PENDING-BUSINESS)
  6780*        RIDFLD    (PI-ERPNDB-KEY)
  6781*        RESP      (WS-RESPONSE)
  6782*    END-EXEC
  6783*    MOVE '&"S        E          (  N#00006589' TO DFHEIV0
  6784     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  6785     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6786     MOVE X'204E233030303036353839' TO DFHEIV0(25:11)
  6787     CALL 'kxdfhei1' USING DFHEIV0,
  6788           WS-ERPNDB-FILE-ID,
  6789           DFHEIV20,
  6790           DFHEIV99,
  6791           PI-ERPNDB-KEY,
  6792           DFHEIV99,
  6793           DFHEIV99,
  6794           DFHEIV99
  6795     SET ADDRESS OF PENDING-BUSINESS TO
  6796         DFHEIV20
  6797     MOVE EIBRESP  TO WS-RESPONSE
  6798     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6799     IF NOT RESP-NORMAL
  6800        GO TO 0400-EXIT
  6801     END-IF
  6802     MOVE PB-C-LF-CANCEL-DT      TO EN-LF-NEW-REF-DT
  6803                                    NEW-LF-CANCEL-DT
  6804     MOVE PB-C-AH-CANCEL-DT      TO EN-AH-NEW-REF-DT
  6805                                    NEW-AH-CANCEL-DT
  6806     MOVE PB-C-LF-CANCEL-AMT     TO EN-LF-NEW-REF-AMT
  6807                                    NEW-LF-CANCEL-AMT
  6808     MOVE PB-C-AH-CANCEL-AMT     TO EN-AH-NEW-REF-AMT
  6809                                    NEW-AH-CANCEL-AMT
  6810     MOVE PB-CI-LIFE-COMMISSION  TO EN-LF-COMMISSION
  6811                                    EN-LF-NEW-REF-COMM-PCT
  6812                                    NEW-LF-COMM-PCT
  6813     MOVE PB-CI-AH-COMMISSION    TO EN-AH-COMMISSION
  6814                                    EN-AH-NEW-REF-COMM-PCT
  6815                                    NEW-AH-COMM-PCT.
  6816     MOVE PB-ENTRY-BATCH         TO EN-BATCH-NUMBER.
  6817
  6818 0400-CONTINUE.
  6819
  6820     MOVE LTRIDI                 TO EN-TEMPLATE-USED
  6821     MOVE 'C'                    TO EN-DOCU-TYPE
  6822     MOVE 'Y'                    TO EN-MONEY-SW
  6823     MOVE W-ACCT-SUMM            TO EN-ACCT-SUMM
  6824     MOVE W-CSO-SUMM             TO EN-CSO-SUMM
  6825     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  6826        IF REACD-IN (S1) NOT = LOW-VALUES
  6827           MOVE REACD-IN (S1)    TO EN-REASON-CODE (S1)
  6828        END-IF
  6829     END-PERFORM
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 120
* EL6316.cbl
  6830     PERFORM 0450-GET-ERACCT     THRU 0450-EXIT
  6831
  6832     IF ACCT-FOUND
  6833        IF PI-FROM-CERT = 'Y'
  6834            MOVE CM-CERT-EFF-DT  TO DC-BIN-DATE-1
  6835            MOVE CM-AH-CANCEL-DT TO DC-BIN-DATE-2
  6836            IF CM-LF-CANCEL-DT > DC-BIN-DATE-2
  6837                MOVE CM-LF-CANCEL-DT TO DC-BIN-DATE-2
  6838            END-IF
  6839        ELSE
  6840            MOVE PB-CERT-EFF-DT      TO DC-BIN-DATE-1
  6841            MOVE PB-C-AH-CANCEL-DT   TO DC-BIN-DATE-2
  6842            IF PB-C-LF-CANCEL-DT > DC-BIN-DATE-2
  6843               MOVE PB-C-LF-CANCEL-DT TO DC-BIN-DATE-2
  6844            END-IF
  6845        END-IF
  6846        MOVE '1'                 TO DC-OPTION-CODE
  6847        PERFORM 9700-DATE-LINK
  6848        IF NO-CONVERSION-ERROR
  6849           MOVE DC-ELAPSED-MONTHS TO WS-DIFF
  6850           IF DC-ODD-DAYS-OVER > +1
  6851              ADD +1          TO WS-DIFF
  6852           END-IF
  6853        ELSE
  6854            MOVE +0           TO WS-DIFF
  6855        END-IF
  6856     ELSE
  6857        MOVE +0           TO WS-DIFF
  6858     END-IF
  6859
  6860     COMPUTE WS-DUE-BORROWER = (EN-LF-NEW-REF-AMT
  6861         + EN-AH-NEW-REF-AMT)
  6862
  6863     IF (WS-CHGBACK = 99)
  6864         OR (WS-DIFF > WS-CHGBACK AND WS-CHGBACK > 0)
  6865          MOVE WS-DUE-BORROWER TO EN-CSO-PORTION
  6866          MOVE ZEROS           TO EN-ACCT-PORTION
  6867          MOVE 'N'             TO EN-COMM-CHGBK
  6868     ELSE
  6869         COMPUTE EN-ACCT-PORTION = (EN-LF-NEW-REF-AMT
  6870                 * EN-LF-COMMISSION) +
  6871                (EN-AH-NEW-REF-AMT * EN-AH-COMMISSION)
  6872         COMPUTE EN-CSO-PORTION = WS-DUE-BORROWER
  6873                 - EN-ACCT-PORTION
  6874         MOVE 'Y'                TO EN-COMM-CHGBK
  6875     END-IF
  6876     PERFORM 0430-WRITE-ERENDT   THRU 0430-EXIT
  6877     .
  6878 0400-EXIT.
  6879     EXIT.
  6880 0410-INIT-ERENDT.
  6881     MOVE OC-CONTROL-PRIMARY (1:33) TO ERENDT-KEY (1:33)
  6882     MOVE 'C'                    TO ENDT-RECORD-TYPE
  6883     MOVE ZEROS                  TO ENDT-SEQ-NO
  6884
  6885* EXEC CICS READ
  6886*        DATASET    (WS-ERENDT-FILE-ID)
  6887*        RIDFLD     (ERENDT-KEY)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 121
* EL6316.cbl
  6888*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
  6889*        RESP       (WS-RESPONSE)
  6890*        GTEQ
  6891*    END-EXEC
  6892*    MOVE '&"S        G          (  N#00006680' TO DFHEIV0
  6893     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  6894     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  6895     MOVE X'204E233030303036363830' TO DFHEIV0(25:11)
  6896     CALL 'kxdfhei1' USING DFHEIV0,
  6897           WS-ERENDT-FILE-ID,
  6898           DFHEIV20,
  6899           DFHEIV99,
  6900           ERENDT-KEY,
  6901           DFHEIV99,
  6902           DFHEIV99,
  6903           DFHEIV99
  6904     SET ADDRESS OF ENDORSEMENT-RECORD TO
  6905         DFHEIV20
  6906     MOVE EIBRESP  TO WS-RESPONSE
  6907     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6908     IF RESP-NORMAL
  6909        AND (EN-CONTROL-PRIMARY (1:34) = ERENDT-KEY (1:34))
  6910        COMPUTE WS-SEQ-NO = EN-SEQ-NO - +1
  6911     ELSE
  6912        MOVE +4096               TO WS-SEQ-NO
  6913     END-IF
  6914     MOVE 'EN'                   TO ENDORSEMENT-RECORD
  6915     MOVE OC-CONTROL-PRIMARY     TO EN-CONTROL-PRIMARY
  6916     MOVE EN-COMPANY-CD          TO EN-COMPANY-CD-A1
  6917     MOVE WS-SEQ-NO              TO EN-SEQ-NO
  6918     MOVE WS-CURRENT-BIN-DT      TO EN-PROCESS-DT
  6919     MOVE 'C'                    TO EN-REC-TYPE
  6920     INITIALIZE EN-CANCEL-RECORD
  6921     MOVE ZEROS TO EN-CSO-PORTION EN-ACCT-PORTION
  6922     MOVE LOW-VALUES             TO EN-LF-ORIG-REF-DT
  6923                                    EN-AH-ORIG-REF-DT
  6924                                    EN-LF-NEW-REF-DT
  6925                                    EN-AH-NEW-REF-DT
  6926     .
  6927 0410-EXIT.
  6928     EXIT.
  6929 0420-UPDATE-ELCRTO.
  6930     PERFORM 0363-READ-ELCRTO-UPD THRU 0363-EXIT
  6931     IF RESP-NORMAL
  6932        MOVE WS-CURRENT-BIN-DT   TO OC-ENDORSEMENT-PROCESSED-DT
  6933                                    OC-LAST-MAINT-DT
  6934        MOVE EIBTIME             TO OC-LAST-MAINT-HHMMSS
  6935        MOVE PI-PROCESSOR-ID     TO OC-LAST-MAINT-BY
  6936
  6937* EXEC CICS REWRITE
  6938*          FROM     (ORIGINAL-CERTIFICATE)
  6939*          DATASET  ('ELCRTO')
  6940*       END-EXEC
  6941     MOVE LENGTH OF
  6942      ORIGINAL-CERTIFICATE
  6943       TO DFHEIV11
  6944     MOVE 'ELCRTO' TO DFHEIV1
  6945*    MOVE '&& L                  %   #00006715' TO DFHEIV0
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 122
* EL6316.cbl
  6946     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  6947     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  6948     MOVE X'2020233030303036373135' TO DFHEIV0(25:11)
  6949     CALL 'kxdfhei1' USING DFHEIV0,
  6950           DFHEIV1,
  6951           ORIGINAL-CERTIFICATE,
  6952           DFHEIV11,
  6953           DFHEIV99
  6954     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  6955     END-IF
  6956     .
  6957 0420-EXIT.
  6958     EXIT.
  6959
  6960 0425-ADD-NEW-ELCRTO.
  6961     MOVE SPACES                 TO ORIGINAL-CERTIFICATE
  6962     MOVE 'OC'                   TO OC-RECORD-ID
  6963     MOVE PI-ELCRTO-KEY          TO OC-CONTROL-PRIMARY
  6964     SUBTRACT +1                 FROM OC-KEY-SEQ-NO
  6965     MOVE PI-PROCESSOR-ID        TO OC-LAST-MAINT-BY
  6966     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  6967     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  6968     MOVE NEW-INS-FIRST-NAME     TO OC-INS-FIRST-NAME
  6969     MOVE NEW-INS-MIDDLE-INIT    TO OC-INS-MIDDLE-INIT
  6970     MOVE NEW-INS-LAST-NAME      TO OC-INS-LAST-NAME
  6971     MOVE NEW-INS-AGE            TO OC-INS-AGE
  6972     MOVE NEW-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  6973     MOVE NEW-JNT-FIRST-NAME     TO OC-JNT-FIRST-NAME
  6974     MOVE NEW-JNT-MIDDLE-INIT    TO OC-JNT-MIDDLE-INIT
  6975     MOVE NEW-JNT-LAST-NAME      TO OC-JNT-LAST-NAME
  6976     MOVE NEW-JNT-AGE            TO OC-JNT-AGE
  6977     MOVE NEW-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  6978     MOVE NEW-LF-BENCD           TO OC-LF-BENCD
  6979     MOVE NEW-LF-BEN-AMT         TO OC-LF-BEN-AMT
  6980     MOVE NEW-LF-PRM-AMT         TO OC-LF-PRM-AMT
  6981     MOVE NEW-LF-ALT-BEN-AMT     TO OC-LF-ALT-BEN-AMT
  6982     MOVE NEW-LF-ALT-PRM-AMT     TO OC-LF-ALT-PRM-AMT
  6983     MOVE NEW-LF-TERM            TO OC-LF-TERM
  6984     MOVE NEW-LF-EXP-DT          TO OC-LF-EXP-DT
  6985     MOVE NEW-LF-COMM-PCT        TO OC-LF-COMM-PCT
  6986     MOVE NEW-LF-CANCEL-DT       TO OC-LF-CANCEL-DT
  6987     MOVE NEW-LF-CANCEL-AMT      TO OC-LF-CANCEL-AMT
  6988     MOVE NEW-AH-BENCD           TO OC-AH-BENCD
  6989     MOVE NEW-AH-BEN-AMT         TO OC-AH-BEN-AMT
  6990     MOVE NEW-AH-PRM-AMT         TO OC-AH-PRM-AMT
  6991     MOVE NEW-AH-TERM            TO OC-AH-TERM
  6992     MOVE NEW-AH-EXP-DT          TO OC-AH-EXP-DT
  6993     MOVE NEW-AH-CP              TO OC-AH-CP
  6994     MOVE NEW-AH-COMM-PCT        TO OC-AH-COMM-PCT
  6995     MOVE NEW-AH-CANCEL-DT       TO OC-AH-CANCEL-DT
  6996     MOVE NEW-AH-CANCEL-AMT      TO OC-AH-CANCEL-AMT
  6997     MOVE NEW-CRED-BENE-NAME     TO OC-CRED-BENE-NAME
  6998     MOVE NEW-1ST-PMT-DT         TO OC-1ST-PMT-DT
  6999     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
  7000     MOVE 'Y'                    TO OC-CANCEL-TRAN-IND
  7001     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  7002     .
  7003 0425-WRITE-ELCRTO.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 123
* EL6316.cbl
  7004
  7005
  7006* EXEC CICS WRITE
  7007*       DATASET   ('ELCRTO')
  7008*       FROM      (ORIGINAL-CERTIFICATE)
  7009*       RIDFLD    (OC-CONTROL-PRIMARY)
  7010*       RESP      (WS-RESPONSE)
  7011*    END-EXEC
  7012     MOVE LENGTH OF
  7013      ORIGINAL-CERTIFICATE
  7014       TO DFHEIV11
  7015     MOVE 'ELCRTO' TO DFHEIV1
  7016*    MOVE '&$ L                  ''  N#00006769' TO DFHEIV0
  7017     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7018     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7019     MOVE X'204E233030303036373639' TO DFHEIV0(25:11)
  7020     CALL 'kxdfhei1' USING DFHEIV0,
  7021           DFHEIV1,
  7022           ORIGINAL-CERTIFICATE,
  7023           DFHEIV11,
  7024           OC-CONTROL-PRIMARY,
  7025           DFHEIV99,
  7026           DFHEIV99
  7027     MOVE EIBRESP  TO WS-RESPONSE
  7028     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7029
  7030     display ' just wrote new crto ' ws-response
  7031     IF RESP-DUPKEY
  7032        SUBTRACT +1              FROM OC-KEY-SEQ-NO
  7033        GO TO 0425-WRITE-ELCRTO
  7034     ELSE
  7035        IF NOT RESP-NORMAL
  7036           MOVE -1               TO LTRIDL
  7037           MOVE ER-3830          TO EMI-ERROR
  7038           PERFORM 9900-ERROR-FORMAT
  7039                                 THRU 9900-EXIT
  7040        ELSE
  7041           MOVE OC-CONTROL-PRIMARY TO PI-ELCRTO-KEY
  7042        END-IF
  7043     END-IF
  7044
  7045     .
  7046 0425-EXIT.
  7047     EXIT.
  7048
  7049 0426-ADD-CERT-NOTES.
  7050
  7051     MOVE LOW-VALUES TO CERT-NOTE-ENTRIES
  7052     SET TB-INDX TO 1
  7053
  7054     IF PI-CERTNT1-ENTERED > SPACES
  7055         MOVE PI-CERTNT1-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7056         MOVE PI-PROCESSOR-ID    TO
  7057                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7058         MOVE EIBTIME            TO
  7059                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7060         MOVE WS-CURRENT-BIN-DT  TO
  7061                      CERT-NT-LAST-MAINT-DT (TB-INDX)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 124
* EL6316.cbl
  7062         SET TB-INDX UP BY +1
  7063     END-IF
  7064
  7065     IF PI-CERTNT2-ENTERED > SPACES
  7066         MOVE PI-CERTNT2-ENTERED TO CERT-NT-TEXT (TB-INDX)
  7067         MOVE PI-PROCESSOR-ID    TO
  7068                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7069         MOVE EIBTIME            TO
  7070                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7071         MOVE WS-CURRENT-BIN-DT  TO
  7072                      CERT-NT-LAST-MAINT-DT (TB-INDX)
  7073         SET TB-INDX UP BY +1
  7074     END-IF
  7075
  7076     IF CERT-NOTE-ENTRIES > SPACES
  7077         PERFORM 0427-LOAD-CURRENT-CERT-NOTES THRU 0427-EXIT
  7078         PERFORM 1700-WRITE-CERT-NOTE THRU 1799-EXIT
  7079     END-IF
  7080
  7081     IF PI-BILLNT1-ENTERED > SPACES
  7082         MOVE SPACES             TO WS-MANUAL-BILL-NOTE
  7083         MOVE PI-BILLNT1-ENTERED TO WS-MAN-BN-NOTE
  7084         MOVE +63 TO WS-LEN
  7085         PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7086     END-IF
  7087
  7088     .
  7089 0426-EXIT.
  7090     EXIT.
  7091
  7092 0427-LOAD-CURRENT-CERT-NOTES.
  7093
  7094     MOVE PI-CRTO-COMPANY-CD  TO ERCNOT-COMPANY-CD
  7095     MOVE PI-CRTO-CARRIER     TO ERCNOT-CARRIER
  7096     MOVE PI-CRTO-GROUPING    TO ERCNOT-GROUPING
  7097     MOVE PI-CRTO-STATE       TO ERCNOT-STATE
  7098     MOVE PI-CRTO-ACCOUNT     TO ERCNOT-ACCOUNT
  7099     MOVE PI-CRTO-CERT-EFF-DT TO ERCNOT-EFF-DT
  7100     MOVE PI-CRTO-CERT-PRIME  TO ERCNOT-CERT-PRIME
  7101     MOVE PI-CRTO-CERT-SFX    TO ERCNOT-CERT-SFX
  7102     MOVE '1'                 TO ERCNOT-REC-TYP
  7103     MOVE +0                  TO ERCNOT-SEQ
  7104     MOVE ERCNOT-PARTIAL-KEY  TO SV-PARTIAL-KEY
  7105
  7106
  7107* EXEC CICS STARTBR
  7108*         DATASET(WS-ERCNOT-FILE-ID)
  7109*         RIDFLD(ERCNOT-KEY)
  7110*         KEYLENGTH(ERCNOT-START-LENGTH)
  7111*         RESP      (WS-RESPONSE)
  7112*         GENERIC
  7113*         GTEQ
  7114*    END-EXEC.
  7115     MOVE 0
  7116       TO DFHEIV11
  7117*    MOVE '&,   KG    G          &  N#00006852' TO DFHEIV0
  7118     MOVE X'262C2020204B472020202047' TO DFHEIV0(1:12)
  7119     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 125
* EL6316.cbl
  7120     MOVE X'204E233030303036383532' TO DFHEIV0(25:11)
  7121     CALL 'kxdfhei1' USING DFHEIV0,
  7122           WS-ERCNOT-FILE-ID,
  7123           ERCNOT-KEY,
  7124           ERCNOT-START-LENGTH,
  7125           DFHEIV11,
  7126           DFHEIV99
  7127     MOVE EIBRESP  TO WS-RESPONSE
  7128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7129
  7130
  7131     IF NOT RESP-NORMAL
  7132        GO TO 0427-ENDBR
  7133     END-IF.
  7134
  7135 0427-LOOP.
  7136
  7137* EXEC CICS READNEXT
  7138*         SET(ADDRESS OF CERT-NOTE-FILE)
  7139*         DATASET(WS-ERCNOT-FILE-ID)
  7140*         RIDFLD(ERCNOT-KEY)
  7141*    END-EXEC.
  7142     MOVE 0
  7143       TO DFHEIV11
  7144*    MOVE '&.S                   )   #00006866' TO DFHEIV0
  7145     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7146     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7147     MOVE X'2020233030303036383636' TO DFHEIV0(25:11)
  7148     CALL 'kxdfhei1' USING DFHEIV0,
  7149           WS-ERCNOT-FILE-ID,
  7150           DFHEIV20,
  7151           DFHEIV99,
  7152           ERCNOT-KEY,
  7153           DFHEIV99,
  7154           DFHEIV11,
  7155           DFHEIV99,
  7156           DFHEIV99
  7157     SET ADDRESS OF CERT-NOTE-FILE TO
  7158         DFHEIV20
  7159     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7160
  7161
  7162     IF CZ-COMPANY-CD NOT = PI-CRTO-COMPANY-CD
  7163         GO TO 0427-ENDBR
  7164     END-IF.
  7165
  7166     IF (CZ-CARRIER = SV-CARRIER)
  7167        AND (CZ-GROUPING = SV-GROUPING)
  7168        AND (CZ-STATE = SV-STATE)
  7169        AND (CZ-ACCOUNT = SV-ACCOUNT)
  7170        AND (CZ-CERT-EFF-DT = SV-EFF-DT)
  7171        AND (CZ-CERT-NO = SV-CERT-NO)
  7172        AND (CZ-RECORD-TYPE = '1')
  7173          MOVE CZ-NOTE TO CERT-NT-TEXT (TB-INDX)
  7174          MOVE CZ-LAST-MAINT-USER TO
  7175                      CERT-NT-LAST-MAINT-BY (TB-INDX)
  7176          MOVE CZ-LAST-MAINT-DT TO
  7177                      CERT-NT-LAST-MAINT-DT (TB-INDX)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 126
* EL6316.cbl
  7178          MOVE CZ-LAST-MAINT-HHMMSS TO
  7179                      CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  7180          SET TB-INDX UP BY 1
  7181          GO TO 0427-LOOP
  7182     END-IF.
  7183
  7184 0427-ENDBR.
  7185
  7186
  7187* EXEC CICS ENDBR
  7188*         DATASET(WS-ERCNOT-FILE-ID)
  7189*    END-EXEC.
  7190     MOVE 0
  7191       TO DFHEIV11
  7192*    MOVE '&2                    $   #00006896' TO DFHEIV0
  7193     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7194     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7195     MOVE X'2020233030303036383936' TO DFHEIV0(25:11)
  7196     CALL 'kxdfhei1' USING DFHEIV0,
  7197           WS-ERCNOT-FILE-ID,
  7198           DFHEIV11,
  7199           DFHEIV99
  7200     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7201
  7202
  7203     .
  7204 0427-EXIT.
  7205     EXIT.
  7206
  7207 0430-WRITE-ERENDT.
  7208     DISPLAY ' NO ERRORS, ABOUT TO WRITE ERENDT '
  7209     MOVE EN-CONTROL-PRIMARY     TO PI-ERENDT-KEY
  7210     MOVE W-ARCH-NUMBER          TO EN-ARCHIVE-NO
  7211
  7212* EXEC CICS WRITE
  7213*         DATASET   (WS-ERENDT-FILE-ID)
  7214*         FROM      (ENDORSEMENT-RECORD)
  7215*         RIDFLD    (EN-CONTROL-PRIMARY)
  7216*         RESP      (WS-RESPONSE)
  7217*    END-EXEC
  7218     MOVE LENGTH OF
  7219      ENDORSEMENT-RECORD
  7220       TO DFHEIV11
  7221*    MOVE '&$ L                  ''  N#00006908' TO DFHEIV0
  7222     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7223     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7224     MOVE X'204E233030303036393038' TO DFHEIV0(25:11)
  7225     CALL 'kxdfhei1' USING DFHEIV0,
  7226           WS-ERENDT-FILE-ID,
  7227           ENDORSEMENT-RECORD,
  7228           DFHEIV11,
  7229           EN-CONTROL-PRIMARY,
  7230           DFHEIV99,
  7231           DFHEIV99
  7232     MOVE EIBRESP  TO WS-RESPONSE
  7233     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7234     IF RESP-NORMAL
  7235        MOVE 'C'                 TO PI-DOCUMENT-PROCESSED
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 127
* EL6316.cbl
  7236        display ' good write erendt '
  7237        IF EIBAID = DFHPF4
  7238           PERFORM 0420-UPDATE-ELCRTO THRU 0420-EXIT
  7239           PERFORM 0425-ADD-NEW-ELCRTO THRU 0425-EXIT
  7240           PERFORM 0426-ADD-CERT-NOTES THRU 0426-EXIT
  7241           PERFORM 0440-ADD-BILLING-NOTE THRU 0440-EXIT
  7242        END-IF
  7243     ELSE
  7244        DISPLAY ' NOT A GOOD WRITE ERENDT ' WS-RESPONSE
  7245        MOVE -1                  TO LTRIDL
  7246        MOVE ER-0132             TO EMI-ERROR
  7247        MOVE AL-UABON            TO LTRIDA
  7248        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  7249     END-IF
  7250     .
  7251 0430-EXIT.
  7252     EXIT.
  7253 0440-ADD-BILLING-NOTE.
  7254
  7255* EXEC CICS GETMAIN
  7256*         SET      (ADDRESS OF EOB-CODES)
  7257*         LENGTH   (ELEOBC-LENGTH)
  7258*         INITIMG  (GETMAIN-SPACE)
  7259*    END-EXEC
  7260*    MOVE ',"IL                  $   #00006934' TO DFHEIV0
  7261     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7262     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7263     MOVE X'2020233030303036393334' TO DFHEIV0(25:11)
  7264     CALL 'kxdfhei1' USING DFHEIV0,
  7265           DFHEIV20,
  7266           ELEOBC-LENGTH,
  7267           GETMAIN-SPACE
  7268     SET ADDRESS OF EOB-CODES TO
  7269         DFHEIV20
  7270     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7271
  7272     MOVE LOW-VALUES             TO WS-ELEOBC-KEY
  7273     MOVE PI-COMPANY-CD          TO WS-EOBC-COMPANY-CD
  7274     MOVE '5'                    TO WS-EOBC-REC-TYPE
  7275
  7276
  7277* EXEC CICS STARTBR
  7278*        DATASET   ('ELEOBC')
  7279*        RIDFLD    (WS-ELEOBC-KEY)
  7280*        GTEQ
  7281*        RESP      (WS-RESPONSE)
  7282*    END-EXEC
  7283     MOVE 'ELEOBC' TO DFHEIV1
  7284     MOVE 0
  7285       TO DFHEIV11
  7286*    MOVE '&,         G          &  N#00006944' TO DFHEIV0
  7287     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7288     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7289     MOVE X'204E233030303036393434' TO DFHEIV0(25:11)
  7290     CALL 'kxdfhei1' USING DFHEIV0,
  7291           DFHEIV1,
  7292           WS-ELEOBC-KEY,
  7293           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 128
* EL6316.cbl
  7294           DFHEIV11,
  7295           DFHEIV99
  7296     MOVE EIBRESP  TO WS-RESPONSE
  7297     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7298
  7299     IF NOT RESP-NORMAL
  7300        GO TO 0440-EXIT
  7301     END-IF
  7302      .
  7303 0440-READNEXT-ELEOBC.
  7304
  7305
  7306* EXEC CICS READNEXT
  7307*       INTO    (EOB-CODES)
  7308*       DATASET ('ELEOBC')
  7309*       RIDFLD  (WS-ELEOBC-KEY)
  7310*       RESP    (WS-RESPONSE)
  7311*    END-EXEC
  7312     MOVE LENGTH OF
  7313      EOB-CODES
  7314       TO DFHEIV12
  7315     MOVE 'ELEOBC' TO DFHEIV1
  7316     MOVE 0
  7317       TO DFHEIV11
  7318*    MOVE '&.IL                  )  N#00006957' TO DFHEIV0
  7319     MOVE X'262E494C2020202020202020' TO DFHEIV0(1:12)
  7320     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7321     MOVE X'204E233030303036393537' TO DFHEIV0(25:11)
  7322     CALL 'kxdfhei1' USING DFHEIV0,
  7323           DFHEIV1,
  7324           EOB-CODES,
  7325           DFHEIV12,
  7326           WS-ELEOBC-KEY,
  7327           DFHEIV99,
  7328           DFHEIV11,
  7329           DFHEIV99,
  7330           DFHEIV99
  7331     MOVE EIBRESP  TO WS-RESPONSE
  7332     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7333
  7334     IF RESP-NORMAL
  7335         IF EO-RECORD-TYPE NOT = '5'
  7336             GO TO 0440-EXIT
  7337         END-IF
  7338     ELSE
  7339         GO TO 0440-EXIT
  7340     END-IF
  7341
  7342     IF EO-RECORD-TYPE = '5' AND
  7343        EO-EOB-CODE = PI-LTRID-ENTERED
  7344           CONTINUE
  7345     ELSE
  7346         GO TO 0440-READNEXT-ELEOBC
  7347     END-IF
  7348
  7349     MOVE SPACES TO WS-BILLING-NOTE
  7350     MOVE EO-DESCRIPTION TO WS-BN-NOTE
  7351     MOVE PI-LTRID-ENTERED TO WS-BN-LTRID
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 129
* EL6316.cbl
  7352     MOVE WS-CURRENT-DT TO WS-BN-DATE
  7353     MOVE PI-PROCESSOR-ID TO WS-BN-USERID
  7354     MOVE +25 TO WS-LEN
  7355
  7356     PERFORM 0441-UPDATE-BILLING-NOTE THRU 0441-EXIT
  7357     .
  7358 0440-EXIT.
  7359     EXIT.
  7360
  7361 0441-UPDATE-BILLING-NOTE.
  7362
  7363* EXEC CICS GETMAIN
  7364*         SET      (ADDRESS OF CERTIFICATE-NOTE)
  7365*         LENGTH   (ERNOTE-LENGTH)
  7366*         INITIMG  (GETMAIN-SPACE)
  7367*    END-EXEC
  7368*    MOVE ',"IL                  $   #00006992' TO DFHEIV0
  7369     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  7370     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7371     MOVE X'2020233030303036393932' TO DFHEIV0(25:11)
  7372     CALL 'kxdfhei1' USING DFHEIV0,
  7373           DFHEIV20,
  7374           ERNOTE-LENGTH,
  7375           GETMAIN-SPACE
  7376     SET ADDRESS OF CERTIFICATE-NOTE TO
  7377         DFHEIV20
  7378     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7379
  7380     MOVE PI-ERENDT-KEY (1:33) TO WS-ERNOTE-KEY
  7381     move '2'                    to w-note-record-type
  7382
  7383
  7384* EXEC CICS READ
  7385*       DATASET    (WS-ERNOTE-FILE-ID)
  7386*       RIDFLD     (WS-ERNOTE-KEY)
  7387*       INTO       (CERTIFICATE-NOTE)
  7388*       RESP       (WS-RESPONSE)
  7389*       UPDATE
  7390*    END-EXEC
  7391     MOVE LENGTH OF
  7392      CERTIFICATE-NOTE
  7393       TO DFHEIV11
  7394*    MOVE '&"IL       EU         (  N#00007001' TO DFHEIV0
  7395     MOVE X'2622494C2020202020202045' TO DFHEIV0(1:12)
  7396     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  7397     MOVE X'204E233030303037303031' TO DFHEIV0(25:11)
  7398     CALL 'kxdfhei1' USING DFHEIV0,
  7399           WS-ERNOTE-FILE-ID,
  7400           CERTIFICATE-NOTE,
  7401           DFHEIV11,
  7402           WS-ERNOTE-KEY,
  7403           DFHEIV99,
  7404           DFHEIV99,
  7405           DFHEIV99
  7406     MOVE EIBRESP  TO WS-RESPONSE
  7407     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7408
  7409     IF RESP-NORMAL
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 130
* EL6316.cbl
  7410       IF CN-BILLING-START-LINE-NO NOT NUMERIC
  7411          MOVE ZEROS            TO CN-BILLING-START-LINE-NO
  7412       END-IF
  7413       IF CN-BILLING-END-LINE-NO NOT NUMERIC
  7414          MOVE ZEROS            TO CN-BILLING-END-LINE-NO
  7415       END-IF
  7416       PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7417           (NOTE-SUB > +10) OR
  7418           (CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7419                             WS-BILLING-NOTE (1:WS-LEN))
  7420       END-PERFORM
  7421       IF CN-LINE (NOTE-SUB) (1:WS-LEN) =
  7422                              WS-BILLING-NOTE (1:WS-LEN)
  7423
  7424* EXEC CICS UNLOCK
  7425*           DATASET    (WS-ERNOTE-FILE-ID)
  7426*        END-EXEC
  7427*    MOVE '&*                    #   #00007023' TO DFHEIV0
  7428     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7429     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7430     MOVE X'2020233030303037303233' TO DFHEIV0(25:11)
  7431     CALL 'kxdfhei1' USING DFHEIV0,
  7432           WS-ERNOTE-FILE-ID,
  7433           DFHEIV99
  7434     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7435       ELSE
  7436         PERFORM VARYING NOTE-SUB FROM +1 BY +1 UNTIL
  7437           (NOTE-SUB > +10) OR
  7438           (CN-LINE (NOTE-SUB) = SPACES OR LOW-VALUES)
  7439         END-PERFORM
  7440         IF (NOTE-SUB < +11)
  7441           IF NOTE-SUB >= CN-BILLING-START-LINE-NO AND
  7442              NOTE-SUB <= CN-BILLING-END-LINE-NO
  7443                MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7444           ELSE
  7445             IF (CN-BILLING-END-LINE-NO NOT = ZEROS) AND
  7446              (NOTE-SUB = (CN-BILLING-END-LINE-NO + +1))
  7447                MOVE WS-BILLING-NOTE   TO CN-LINE (NOTE-SUB)
  7448                MOVE NOTE-SUB     TO CN-BILLING-END-LINE-NO
  7449             ELSE
  7450               IF (CN-BILLING-START-LINE-NO NOT = ZEROS) AND
  7451                  (NOTE-SUB = (CN-BILLING-START-LINE-NO - +1))
  7452                     MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB)
  7453                     MOVE NOTE-SUB  TO CN-BILLING-START-LINE-NO
  7454               ELSE
  7455                 IF (CN-BILLING-END-LINE-NO = ZEROS)
  7456                   MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB)
  7457                   MOVE NOTE-SUB    TO CN-BILLING-END-LINE-NO
  7458                                       CN-BILLING-START-LINE-NO
  7459                 ELSE
  7460                    PERFORM 0442-SQUEEZE-IT-IN THRU 0442-EXIT
  7461                 END-IF
  7462               END-IF
  7463             END-IF
  7464           END-IF
  7465           MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7466           MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7467           MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 131
* EL6316.cbl
  7468
  7469* EXEC CICS REWRITE
  7470*             DATASET    (WS-ERNOTE-FILE-ID)
  7471*             FROM       (CERTIFICATE-NOTE)
  7472*             RESP       (WS-RESPONSE)
  7473*          END-EXEC
  7474     MOVE LENGTH OF
  7475      CERTIFICATE-NOTE
  7476       TO DFHEIV11
  7477*    MOVE '&& L                  %  N#00007059' TO DFHEIV0
  7478     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  7479     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  7480     MOVE X'204E233030303037303539' TO DFHEIV0(25:11)
  7481     CALL 'kxdfhei1' USING DFHEIV0,
  7482           WS-ERNOTE-FILE-ID,
  7483           CERTIFICATE-NOTE,
  7484           DFHEIV11,
  7485           DFHEIV99
  7486     MOVE EIBRESP  TO WS-RESPONSE
  7487     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7488           PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7489         END-IF
  7490       END-IF
  7491     ELSE
  7492        MOVE SPACES              TO CERTIFICATE-NOTE
  7493        MOVE 'CN'                TO CN-RECORD-ID
  7494        MOVE PI-ERENDT-KEY (1:33) TO CN-CONTROL-PRIMARY
  7495                                     WS-ERNOTE-KEY
  7496        move '2'                 to cn-record-type
  7497                                    w-note-record-type
  7498        MOVE 01                  TO CN-BILLING-START-LINE-NO
  7499                                    CN-BILLING-END-LINE-NO
  7500        MOVE WS-BILLING-NOTE     TO CN-LINE (01)
  7501        MOVE PI-PROCESSOR-ID     TO CN-LAST-MAINT-USER
  7502        MOVE WS-CURRENT-BIN-DT   TO CN-LAST-MAINT-DT
  7503        MOVE EIBTIME             TO CN-LAST-MAINT-HHMMSS
  7504
  7505* EXEC CICS WRITE
  7506*          DATASET    (WS-ERNOTE-FILE-ID)
  7507*          FROM       (CERTIFICATE-NOTE)
  7508*          RIDFLD     (WS-ERNOTE-KEY)
  7509*          RESP       (WS-RESPONSE)
  7510*       END-EXEC
  7511     MOVE LENGTH OF
  7512      CERTIFICATE-NOTE
  7513       TO DFHEIV11
  7514*    MOVE '&$ L                  ''  N#00007080' TO DFHEIV0
  7515     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  7516     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7517     MOVE X'204E233030303037303830' TO DFHEIV0(25:11)
  7518     CALL 'kxdfhei1' USING DFHEIV0,
  7519           WS-ERNOTE-FILE-ID,
  7520           CERTIFICATE-NOTE,
  7521           DFHEIV11,
  7522           WS-ERNOTE-KEY,
  7523           DFHEIV99,
  7524           DFHEIV99
  7525     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 132
* EL6316.cbl
  7526     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7527
  7528        PERFORM 0445-CERTIFICATE-UPDATE THRU 0445-EXIT
  7529     END-IF
  7530
  7531     .
  7532 0441-EXIT.
  7533     EXIT.
  7534
  7535
  7536 0442-SQUEEZE-IT-IN.
  7537
  7538     IF NOTE-SUB < CN-BILLING-START-LINE-NO
  7539        PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7540           NOTE-SUB = +10
  7541           MOVE CN-LINE (NOTE-SUB + 1) TO CN-LINE (NOTE-SUB)
  7542           IF (NOTE-SUB + 1) = (CN-BILLING-START-LINE-NO - 1)
  7543             MOVE WS-BILLING-NOTE TO CN-LINE (NOTE-SUB + 1)
  7544             COMPUTE CN-BILLING-START-LINE-NO = NOTE-SUB + 1
  7545             MOVE +9 TO NOTE-SUB
  7546           END-IF
  7547        END-PERFORM
  7548     ELSE
  7549        IF NOTE-SUB > CN-BILLING-END-LINE-NO
  7550           PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY -1
  7551             UNTIL NOTE-SUB = +1
  7552             MOVE CN-LINE (NOTE-SUB - 1) TO CN-LINE (NOTE-SUB)
  7553             IF (NOTE-SUB - 1) = (CN-BILLING-END-LINE-NO + 1)
  7554                MOVE WS-BILLING-NOTE  TO CN-LINE (NOTE-SUB - 1)
  7555                COMPUTE CN-BILLING-END-LINE-NO = NOTE-SUB - 1
  7556                MOVE +2          TO NOTE-SUB
  7557             END-IF
  7558           END-PERFORM
  7559        END-IF
  7560     END-IF
  7561
  7562     .
  7563 0442-EXIT.
  7564     EXIT.
  7565
  7566 0445-CERTIFICATE-UPDATE.
  7567    display 'billing note written, updating cert'
  7568     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  7569     IF RESP-NORMAL
  7570        EVALUATE CM-NOTE-SW
  7571           WHEN '2'
  7572           WHEN '3'
  7573           WHEN '6'
  7574           WHEN '7'
  7575              SET NO-CERT-RW     TO TRUE
  7576           WHEN ' '
  7577              MOVE '2'           TO CM-NOTE-SW
  7578           WHEN '1'
  7579              MOVE '3'           TO CM-NOTE-SW
  7580           WHEN '4'
  7581              MOVE '6'           TO CM-NOTE-SW
  7582           WHEN '5'
  7583              MOVE '7'           TO CM-NOTE-SW
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 133
* EL6316.cbl
  7584        END-EVALUATE
  7585     END-IF
  7586     IF NOT NO-CERT-RW
  7587        PERFORM 1810-REWRITE-ELCERT
  7588                                 THRU 1810-EXIT
  7589     ELSE
  7590
  7591* EXEC CICS UNLOCK
  7592*          DATASET    (WS-ELCERT-FILE-ID)
  7593*       END-EXEC
  7594*    MOVE '&*                    #   #00007149' TO DFHEIV0
  7595     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  7596     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  7597     MOVE X'2020233030303037313439' TO DFHEIV0(25:11)
  7598     CALL 'kxdfhei1' USING DFHEIV0,
  7599           WS-ELCERT-FILE-ID,
  7600           DFHEIV99
  7601     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7602     END-IF
  7603
  7604     .
  7605 0445-EXIT.
  7606     EXIT.
  7607
  7608 0450-GET-ERACCT.
  7609     DISPLAY ' MADE IT TO 0450 '
  7610     MOVE ' '                    TO WS-ERACCT-SW
  7611     MOVE ZEROS                  TO WS-CHGBACK
  7612                                    WS-CSO-PORTION
  7613                                    WS-ACCT-PORTION
  7614                                    WS-DIFF
  7615     PERFORM 0460-STARTBR-ERACCT THRU 0460-EXIT
  7616     IF RESP-NORMAL
  7617        DISPLAY ' GOOD STARTBR '
  7618        PERFORM 0470-READNEXT-ERACCT
  7619                                 THRU 0470-EXIT
  7620     END-IF
  7621     IF RESP-NORMAL
  7622        DISPLAY ' GOOD READNEXT '
  7623        IF AM-CONTROL-PRIMARY (1:20) = EN-CONTROL-PRIMARY (1:20)
  7624           IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  7625              AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  7626              DISPLAY ' SETTING ACCT FOUND TO TRUE '
  7627              SET ACCT-FOUND TO TRUE
  7628           ELSE
  7629              PERFORM 0470-READNEXT-ERACCT
  7630                                 THRU 0470-EXIT
  7631              IF RESP-NORMAL
  7632                 IF AM-CONTROL-PRIMARY (1:20)
  7633                    = EN-CONTROL-PRIMARY (1:20)
  7634                    IF (EN-CERT-EFF-DT < AM-EXPIRATION-DT)
  7635                       AND (EN-CERT-EFF-DT >= AM-EFFECTIVE-DT)
  7636                       DISPLAY ' SETTING ACCT FOUND TO TRUE '
  7637                       SET ACCT-FOUND TO TRUE
  7638                    END-IF
  7639                 END-IF
  7640              END-IF
  7641           END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 134
* EL6316.cbl
  7642        END-IF
  7643     END-IF
  7644     IF ACCT-FOUND
  7645        PERFORM VARYING S1 FROM +1 BY +1 UNTIL
  7646           (AM-COM-TYP (S1) = 'C' OR 'D')
  7647           OR (S1 > +10)
  7648        END-PERFORM
  7649        IF S1 < +11
  7650           MOVE AM-COMM-CHARGEBACK (S1)
  7651                                 TO WS-CHGBACK
  7652        END-IF
  7653     END-IF
  7654
  7655* EXEC CICS ENDBR
  7656*        DATASET     ('ERACCT')
  7657*    END-EXEC.
  7658     MOVE 'ERACCT' TO DFHEIV1
  7659     MOVE 0
  7660       TO DFHEIV11
  7661*    MOVE '&2                    $   #00007204' TO DFHEIV0
  7662     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7663     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7664     MOVE X'2020233030303037323034' TO DFHEIV0(25:11)
  7665     CALL 'kxdfhei1' USING DFHEIV0,
  7666           DFHEIV1,
  7667           DFHEIV11,
  7668           DFHEIV99
  7669     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7670
  7671    .
  7672 0450-EXIT.
  7673     EXIT.
  7674 0460-STARTBR-ERACCT.
  7675     MOVE LOW-VALUES             TO WS-ERACCT-KEY
  7676     MOVE EN-CONTROL-PRIMARY     TO WS-ERACCT-KEY (1:22)
  7677     MOVE WS-ERACCT-KEY          TO WS-SAVE-ERACCT-KEY
  7678
  7679* EXEC CICS STARTBR
  7680*        DATASET   ('ERACCT')
  7681*        RIDFLD    (WS-ERACCT-KEY)
  7682*        GTEQ
  7683*        RESP      (WS-RESPONSE)
  7684*    END-EXEC
  7685     MOVE 'ERACCT' TO DFHEIV1
  7686     MOVE 0
  7687       TO DFHEIV11
  7688*    MOVE '&,         G          &  N#00007214' TO DFHEIV0
  7689     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7690     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7691     MOVE X'204E233030303037323134' TO DFHEIV0(25:11)
  7692     CALL 'kxdfhei1' USING DFHEIV0,
  7693           DFHEIV1,
  7694           WS-ERACCT-KEY,
  7695           DFHEIV99,
  7696           DFHEIV11,
  7697           DFHEIV99
  7698     MOVE EIBRESP  TO WS-RESPONSE
  7699     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 135
* EL6316.cbl
  7700     .
  7701 0460-EXIT.
  7702     EXIT.
  7703 0470-READNEXT-ERACCT.
  7704
  7705* EXEC CICS READNEXT
  7706*       SET      (ADDRESS OF ACCOUNT-MASTER)
  7707*       DATASET ('ERACCT')
  7708*       RIDFLD  (WS-ERACCT-KEY)
  7709*       RESP    (WS-RESPONSE)
  7710*    END-EXEC
  7711     MOVE 'ERACCT' TO DFHEIV1
  7712     MOVE 0
  7713       TO DFHEIV11
  7714*    MOVE '&.S                   )  N#00007224' TO DFHEIV0
  7715     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7716     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7717     MOVE X'204E233030303037323234' TO DFHEIV0(25:11)
  7718     CALL 'kxdfhei1' USING DFHEIV0,
  7719           DFHEIV1,
  7720           DFHEIV20,
  7721           DFHEIV99,
  7722           WS-ERACCT-KEY,
  7723           DFHEIV99,
  7724           DFHEIV11,
  7725           DFHEIV99,
  7726           DFHEIV99
  7727     SET ADDRESS OF ACCOUNT-MASTER TO
  7728         DFHEIV20
  7729     MOVE EIBRESP  TO WS-RESPONSE
  7730     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7731     .
  7732 0470-EXIT.
  7733     EXIT.
  7734 0493-SQUEEZE-ERNOTE.
  7735     IF CN-BILLING-START-LINE-NO > 0
  7736         MOVE CN-BILLING-START-LINE-NO TO NOTE-SUB
  7737     ELSE
  7738         MOVE +1                 TO NOTE-SUB
  7739     END-IF.
  7740
  7741     PERFORM VARYING NOTE-SUB FROM NOTE-SUB BY +1 UNTIL
  7742        (NOTE-SUB > +9)
  7743        IF CN-LINE (NOTE-SUB) = SPACES
  7744           MOVE CN-LINE (NOTE-SUB + +1)
  7745                                 TO CN-LINE (NOTE-SUB)
  7746           MOVE SPACES           TO CN-LINE (NOTE-SUB + +1)
  7747        END-IF
  7748     END-PERFORM
  7749     .
  7750 0493-EXIT.
  7751     EXIT.
  7752 0500-ERENDT-READ-GTEQ.
  7753
  7754* EXEC CICS READ
  7755*        DATASET    (WS-ERENDT-FILE-ID)
  7756*        RIDFLD     (ERENDT-KEY)
  7757*        SET        (ADDRESS OF ENDORSEMENT-RECORD)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 136
* EL6316.cbl
  7758*        RESP       (WS-RESPONSE)
  7759*        GTEQ
  7760*    END-EXEC
  7761*    MOVE '&"S        G          (  N#00007252' TO DFHEIV0
  7762     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  7763     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  7764     MOVE X'204E233030303037323532' TO DFHEIV0(25:11)
  7765     CALL 'kxdfhei1' USING DFHEIV0,
  7766           WS-ERENDT-FILE-ID,
  7767           DFHEIV20,
  7768           DFHEIV99,
  7769           ERENDT-KEY,
  7770           DFHEIV99,
  7771           DFHEIV99,
  7772           DFHEIV99
  7773     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7774         DFHEIV20
  7775     MOVE EIBRESP  TO WS-RESPONSE
  7776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7777     IF NOT RESP-NORMAL
  7778        MOVE ER-2237             TO EMI-ERROR
  7779        PERFORM 9900-ERROR-FORMAT
  7780                                 THRU 9900-EXIT
  7781        MOVE -1                  TO CARRL
  7782        GO TO 8200-SEND-DATAONLY
  7783     END-IF
  7784     .
  7785 0500-EXIT.
  7786     EXIT.
  7787 0510-ERENDT-READNEXT.
  7788
  7789* EXEC CICS READNEXT
  7790*       DATASET    (WS-ERENDT-FILE-ID)
  7791*       RIDFLD     (ERENDT-KEY)
  7792*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7793*       RESP       (WS-RESPONSE)
  7794*    END-EXEC
  7795     MOVE 0
  7796       TO DFHEIV11
  7797*    MOVE '&.S                   )  N#00007270' TO DFHEIV0
  7798     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  7799     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7800     MOVE X'204E233030303037323730' TO DFHEIV0(25:11)
  7801     CALL 'kxdfhei1' USING DFHEIV0,
  7802           WS-ERENDT-FILE-ID,
  7803           DFHEIV20,
  7804           DFHEIV99,
  7805           ERENDT-KEY,
  7806           DFHEIV99,
  7807           DFHEIV11,
  7808           DFHEIV99,
  7809           DFHEIV99
  7810     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7811         DFHEIV20
  7812     MOVE EIBRESP  TO WS-RESPONSE
  7813     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7814     IF NOT RESP-NORMAL
  7815        MOVE ER-2237             TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 137
* EL6316.cbl
  7816        PERFORM 9900-ERROR-FORMAT
  7817                                 THRU 9900-EXIT
  7818        MOVE -1                  TO CARRL
  7819        GO TO 8200-SEND-DATAONLY
  7820     END-IF
  7821     .
  7822 0510-EXIT.
  7823     EXIT.
  7824 0520-ERENDT-STARTBR.
  7825
  7826* EXEC CICS STARTBR
  7827*       DATASET    (WS-ERENDT-FILE-ID)
  7828*       RIDFLD     (ERENDT-KEY)
  7829*       RESP       (WS-RESPONSE)
  7830*    END-EXEC
  7831     MOVE 0
  7832       TO DFHEIV11
  7833*    MOVE '&,         G          &  N#00007287' TO DFHEIV0
  7834     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7835     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7836     MOVE X'204E233030303037323837' TO DFHEIV0(25:11)
  7837     CALL 'kxdfhei1' USING DFHEIV0,
  7838           WS-ERENDT-FILE-ID,
  7839           ERENDT-KEY,
  7840           DFHEIV99,
  7841           DFHEIV11,
  7842           DFHEIV99
  7843     MOVE EIBRESP  TO WS-RESPONSE
  7844     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7845     IF NOT RESP-NORMAL
  7846        MOVE ER-2237             TO EMI-ERROR
  7847        PERFORM 9900-ERROR-FORMAT
  7848                                 THRU 9900-EXIT
  7849        MOVE -1                  TO CARRL
  7850        GO TO 8200-SEND-DATAONLY
  7851     END-IF
  7852     .
  7853 0520-EXIT.
  7854     EXIT.
  7855 0530-ERENDT-READPREV.
  7856
  7857* EXEC CICS READPREV
  7858*       DATASET    (WS-ERENDT-FILE-ID)
  7859*       RIDFLD     (ERENDT-KEY)
  7860*       SET        (ADDRESS OF ENDORSEMENT-RECORD)
  7861*       RESP       (WS-RESPONSE)
  7862*    END-EXEC
  7863     MOVE 0
  7864       TO DFHEIV11
  7865*    MOVE '&0S                   )  N#00007303' TO DFHEIV0
  7866     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  7867     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  7868     MOVE X'204E233030303037333033' TO DFHEIV0(25:11)
  7869     CALL 'kxdfhei1' USING DFHEIV0,
  7870           WS-ERENDT-FILE-ID,
  7871           DFHEIV20,
  7872           DFHEIV99,
  7873           ERENDT-KEY,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 138
* EL6316.cbl
  7874           DFHEIV99,
  7875           DFHEIV11,
  7876           DFHEIV99,
  7877           DFHEIV99
  7878     SET ADDRESS OF ENDORSEMENT-RECORD TO
  7879         DFHEIV20
  7880     MOVE EIBRESP  TO WS-RESPONSE
  7881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7882     IF NOT RESP-NORMAL
  7883        MOVE ER-2238             TO EMI-ERROR
  7884        PERFORM 9900-ERROR-FORMAT
  7885                                 THRU 9900-EXIT
  7886        MOVE -1                  TO CARRL
  7887        MOVE 'N'                 TO PI-ENDORSE-RECORD
  7888        MOVE LOW-VALUES          TO  EL631II
  7889        GO TO 0350-DISPLAY-COMMON-DATA
  7890     END-IF
  7891     .
  7892 0530-EXIT.
  7893     EXIT.
  7894 0600-CREATE-TEMP-STORAGE.
  7895
  7896* EXEC CICS WRITEQ TS
  7897*        QUEUE (QID)
  7898*        FROM  (PROGRAM-INTERFACE-BLOCK)
  7899*        LENGTH(PI-COMM-LENGTH)
  7900*    END-EXEC
  7901*    MOVE '*"     L              ''   #00007322' TO DFHEIV0
  7902     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7903     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7904     MOVE X'2020233030303037333232' TO DFHEIV0(25:11)
  7905     CALL 'kxdfhei1' USING DFHEIV0,
  7906           QID,
  7907           PROGRAM-INTERFACE-BLOCK,
  7908           PI-COMM-LENGTH,
  7909           DFHEIV99,
  7910           DFHEIV99,
  7911           DFHEIV99
  7912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7913     display ' about to write map ' el631ii
  7914
  7915* EXEC CICS WRITEQ TS
  7916*        QUEUE (QID)
  7917*        FROM  (EL631II)
  7918*        LENGTH(MAP-LENGTH)
  7919*    END-EXEC.
  7920*    MOVE '*"     L              ''   #00007328' TO DFHEIV0
  7921     MOVE X'2A2220202020204C20202020' TO DFHEIV0(1:12)
  7922     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7923     MOVE X'2020233030303037333238' TO DFHEIV0(25:11)
  7924     CALL 'kxdfhei1' USING DFHEIV0,
  7925           QID,
  7926           EL631II,
  7927           MAP-LENGTH,
  7928           DFHEIV99,
  7929           DFHEIV99,
  7930           DFHEIV99
  7931     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 139
* EL6316.cbl
  7932
  7933 0600-EXIT.
  7934      EXIT.
  7935 0610-RECOVER-TEMP-STORAGE.
  7936
  7937* EXEC CICS READQ TS
  7938*        QUEUE (QID)
  7939*        INTO  (PROGRAM-INTERFACE-BLOCK)
  7940*        LENGTH(PI-COMM-LENGTH)
  7941*    END-EXEC
  7942*    MOVE '*$I    L              ''   #00007336' TO DFHEIV0
  7943     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7944     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7945     MOVE X'2020233030303037333336' TO DFHEIV0(25:11)
  7946     CALL 'kxdfhei1' USING DFHEIV0,
  7947           QID,
  7948           PROGRAM-INTERFACE-BLOCK,
  7949           PI-COMM-LENGTH,
  7950           DFHEIV99,
  7951           DFHEIV99,
  7952           DFHEIV99
  7953     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7954
  7955* EXEC CICS READQ TS
  7956*        QUEUE (QID)
  7957*        INTO  (EL631II)
  7958*        LENGTH(MAP-LENGTH)
  7959*    END-EXEC
  7960*    MOVE '*$I    L              ''   #00007341' TO DFHEIV0
  7961     MOVE X'2A2449202020204C20202020' TO DFHEIV0(1:12)
  7962     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  7963     MOVE X'2020233030303037333431' TO DFHEIV0(25:11)
  7964     CALL 'kxdfhei1' USING DFHEIV0,
  7965           QID,
  7966           EL631II,
  7967           MAP-LENGTH,
  7968           DFHEIV99,
  7969           DFHEIV99,
  7970           DFHEIV99
  7971     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  7972     display ' map ' EL631II
  7973     PERFORM 0620-DELETE-TS THRU 0620-EXIT
  7974     MOVE AL-UANON            TO LTRIDA
  7975     IF PI-FROM-CERT = 'Y' AND
  7976        PI-PROCESSOR-IS-CSR-SUPER
  7977            MOVE AL-UNNON        TO OLFDTA
  7978                                    OAHDTA
  7979                                    OLFAMTA
  7980                                    OAHAMTA
  7981     END-IF
  7982     IF WS-SET-CODES-MDT = 'Y'
  7983        move +1                  to s2
  7984        perform varying s1 from +1 by +5 until s1 > +60
  7985           MOVE WS-PASSED-REASON-CODES (s1:4)
  7986                                 TO reacd-in (s2)
  7987           IF REACD-IN (S2) NOT EQUAL SPACES AND LOW-VALUES
  7988               MOVE AL-SANON     TO REACDA (S2)
  7989               MOVE +4           TO REACDL (S2)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 140
* EL6316.cbl
  7990           END-IF
  7991           add +1                to s2
  7992        end-perform
  7993        MOVE REASONCDS       TO PI-REASONS-ENTERED
  7994     END-IF
  7995
  7996     IF ENCCODEI > SPACES
  7997         MOVE AL-UANON       TO ENCCODEA
  7998     END-IF
  7999
  8000     IF CRTNT1I > SPACES
  8001         MOVE AL-UANON       TO CRTNT1A
  8002     END-IF
  8003
  8004     IF CRTNT2I > SPACES
  8005         MOVE AL-UANON       TO CRTNT2A
  8006     END-IF
  8007
  8008     IF BILNT1I > SPACES
  8009         MOVE AL-UANON       TO BILNT1A
  8010     END-IF
  8011     .
  8012 0610-EXIT.
  8013      EXIT.
  8014 0620-DELETE-TS.
  8015
  8016* EXEC CICS DELETEQ TS
  8017*        QUEUE(QID)
  8018*    END-EXEC
  8019*    MOVE '*&                    #   #00007389' TO DFHEIV0
  8020     MOVE X'2A2620202020202020202020' TO DFHEIV0(1:12)
  8021     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8022     MOVE X'2020233030303037333839' TO DFHEIV0(25:11)
  8023     CALL 'kxdfhei1' USING DFHEIV0,
  8024           QID,
  8025           DFHEIV99
  8026     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8027     .
  8028 0620-EXIT.
  8029      EXIT.
  8030
  8031 0700-LOAD-FROM-CERT.
  8032     PERFORM 0755-READ-CERT THRU 0755-EXIT
  8033     PERFORM 0760-CHECK-OLD-ORIG THRU 0760-EXIT
  8034     PERFORM 0770-MOVE-CERT-TO-SCREEN THRU 0770-EXIT
  8035     MOVE ER-2784                TO EMI-ERROR
  8036     PERFORM 9900-ERROR-FORMAT   THRU 9900-EXIT
  8037     GO TO 8100-SEND-INITIAL-MAP
  8038     .
  8039 0700-EXIT.
  8040      EXIT.
  8041
  8042
  8043 0755-READ-CERT.
  8044*     display 'made it to 0755'
  8045     MOVE PI-COMPANY-CD          TO W-CERT-COMPANY-CD
  8046     MOVE PI-CARRIER             TO W-CERT-CARRIER
  8047     MOVE PI-GROUPING            TO W-CERT-GROUPING
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 141
* EL6316.cbl
  8048     MOVE PI-STATE               TO W-CERT-STATE
  8049     MOVE PI-ACCOUNT             TO W-CERT-ACCOUNT
  8050     MOVE PI-CERT-PRIME          TO W-CERT-CERT-PRIME
  8051     MOVE PI-CERT-SFX            TO W-CERT-CERT-SFX
  8052     MOVE PI-CERT-EFF-DT         TO W-CERT-CERT-EFF-DT
  8053
  8054
  8055* EXEC CICS READ
  8056*        DATASET   (WS-ELCERT-FILE-ID)
  8057*        SET       (ADDRESS OF CERTIFICATE-MASTER)
  8058*        RIDFLD    (WS-ELCERT-KEY)
  8059*        RESP      (WS-RESPONSE)
  8060*    END-EXEC
  8061*    MOVE '&"S        E          (  N#00007419' TO DFHEIV0
  8062     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8063     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8064     MOVE X'204E233030303037343139' TO DFHEIV0(25:11)
  8065     CALL 'kxdfhei1' USING DFHEIV0,
  8066           WS-ELCERT-FILE-ID,
  8067           DFHEIV20,
  8068           DFHEIV99,
  8069           WS-ELCERT-KEY,
  8070           DFHEIV99,
  8071           DFHEIV99,
  8072           DFHEIV99
  8073     SET ADDRESS OF CERTIFICATE-MASTER TO
  8074         DFHEIV20
  8075     MOVE EIBRESP  TO WS-RESPONSE
  8076     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8077
  8078     IF RESP-NORMAL
  8079        CONTINUE
  8080     ELSE
  8081        IF RESP-NOTFND
  8082           MOVE LOW-VALUES       TO EL631II
  8083           MOVE ER-2253          TO EMI-ERROR
  8084           PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8085           MOVE -1               TO CARRL
  8086           GO TO 8100-SEND-INITIAL-MAP
  8087        END-IF
  8088     END-IF
  8089
  8090     .
  8091 0755-EXIT.
  8092     EXIT.
  8093
  8094
  8095 0760-CHECK-OLD-ORIG.
  8096
  8097     display ' made it to 0760 '
  8098
  8099     MOVE PI-COMPANY-CD          TO CRTO-COMPANY-CD
  8100     MOVE PI-CARRIER             TO CRTO-CARRIER
  8101     MOVE PI-GROUPING            TO CRTO-GROUPING
  8102     MOVE PI-STATE               TO CRTO-STATE
  8103     MOVE PI-ACCOUNT             TO CRTO-ACCOUNT
  8104     MOVE PI-CERT-PRIME          TO CRTO-CERT-PRIME
  8105     MOVE PI-CERT-SFX            TO CRTO-CERT-SFX
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 142
* EL6316.cbl
  8106     MOVE PI-CERT-EFF-DT         TO CRTO-CERT-EFF-DT
  8107     MOVE 'I'                    TO CRTO-RECORD-TYPE
  8108     MOVE ZEROS                  TO CRTO-SEQ-NO
  8109     MOVE ELCRTO-KEY             TO PI-ELCRTO-KEY
  8110     MOVE ELCRTO-KEY (1:33)      TO PI-ERENDT-KEY (1:33)
  8111     MOVE 'C'                    TO PI-ENDT-RECORD-TYPE
  8112     MOVE ZEROS                  TO PI-ENDT-SEQ-NO
  8113     MOVE PI-ERENDT-KEY          TO PI-PREV-ERENDT-KEY
  8114
  8115     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  8116      display 'response ' ws-response
  8117      display 'pi-elcrto-key ' pi-elcrto-key
  8118      display 'oc key ' oc-control-primary
  8119     IF RESP-NORMAL
  8120       AND (PI-ELCRTO-KEY (1:33) =
  8121              OC-CONTROL-PRIMARY (1:33))
  8122          DISPLAY 'CRTO RESP NORMAL AND = '
  8123          IF OC-ENDORSEMENT-PROCESSED-DT = LOW-VALUES
  8124             MOVE OC-CONTROL-PRIMARY  TO PI-ELCRTO-KEY
  8125          ELSE
  8126             SUBTRACT +1 FROM OC-KEY-SEQ-NO
  8127             PERFORM 0780-ADD-CRTO-REC THRU 0780-EXIT
  8128          END-IF
  8129     ELSE
  8130          MOVE SPACES              TO ORIGINAL-CERTIFICATE
  8131          MOVE 'OC'                TO OC-RECORD-ID
  8132          MOVE ELCRTO-KEY (1:33)   TO OC-CONTROL-PRIMARY (1:33)
  8133          MOVE +4096               TO OC-KEY-SEQ-NO
  8134          PERFORM 0780-ADD-CRTO-REC THRU 0780-EXIT
  8135     END-IF
  8136
  8137     PERFORM 0361-MOVE-CRTO-TO-SCREEN THRU 0361-EXIT
  8138
  8139     .
  8140 0760-EXIT.
  8141     EXIT.
  8142
  8143 0770-MOVE-CERT-TO-SCREEN.
  8144
  8145     display ' made it to 0770 '
  8146
  8147     MOVE CM-CARRIER             TO CARRO
  8148     MOVE CM-GROUPING            TO GROUPO
  8149     MOVE CM-STATE               TO STATEO
  8150     MOVE CM-ACCOUNT             TO ACCTO
  8151     MOVE CM-CERT-PRIME          TO CERTNOO
  8152     MOVE CM-CERT-SFX            TO CRTSFXO
  8153
  8154     MOVE CM-CERT-EFF-DT         TO DC-BIN-DATE-1
  8155     MOVE ' '                    TO DC-OPTION-CODE
  8156     PERFORM 9700-DATE-LINK
  8157     IF NO-CONVERSION-ERROR
  8158        MOVE DC-GREG-DATE-1-EDIT TO EFFDTO
  8159     END-IF
  8160
  8161     MOVE CM-INSURED-LAST-NAME   TO LNAMEO
  8162     MOVE CM-INSURED-FIRST-NAME  TO FNAMEO
  8163     MOVE CM-INSURED-INITIAL2    TO MINITO
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 143
* EL6316.cbl
  8164
  8165     MOVE CM-LF-CANCEL-DT        TO DC-BIN-DATE-1
  8166     MOVE ' '                    TO DC-OPTION-CODE
  8167     PERFORM 9700-DATE-LINK
  8168     IF NO-CONVERSION-ERROR
  8169        MOVE DC-GREG-DATE-1-EDIT TO NLFDTO
  8170     END-IF
  8171     MOVE CM-AH-CANCEL-DT        TO DC-BIN-DATE-1
  8172     MOVE ' '                    TO DC-OPTION-CODE
  8173     PERFORM 9700-DATE-LINK
  8174     IF NO-CONVERSION-ERROR
  8175        MOVE DC-GREG-DATE-1-EDIT TO NAHDTO
  8176     END-IF
  8177
  8178     MOVE CM-LF-ITD-CANCEL-AMT   TO NLFAMTO
  8179     MOVE CM-AH-ITD-CANCEL-AMT   TO NAHAMTO
  8180
  8181     IF CM-LIFE-COMM-PCT NOT = ZEROS
  8182        MOVE CM-LIFE-COMM-PCT TO LFCOMMO
  8183     END-IF
  8184     IF CM-AH-COMM-PCT NOT = ZEROS
  8185        MOVE CM-AH-COMM-PCT   TO AHCOMMO
  8186     END-IF
  8187
  8188
  8189     .
  8190 0770-EXIT.
  8191     EXIT.
  8192
  8193
  8194 0780-ADD-CRTO-REC.
  8195      display 'made it to 0780'
  8196     PERFORM 0783-LOAD-CERT-TO-CRTO-REC THRU 0783-EXIT
  8197
  8198
  8199* EXEC CICS WRITE
  8200*       DATASET   ('ELCRTO')
  8201*       FROM      (ORIGINAL-CERTIFICATE)
  8202*       RIDFLD    (OC-CONTROL-PRIMARY)
  8203*       RESP      (WS-RESPONSE)
  8204*    END-EXEC.
  8205     MOVE LENGTH OF
  8206      ORIGINAL-CERTIFICATE
  8207       TO DFHEIV11
  8208     MOVE 'ELCRTO' TO DFHEIV1
  8209*    MOVE '&$ L                  ''  N#00007546' TO DFHEIV0
  8210     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8211     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8212     MOVE X'204E233030303037353436' TO DFHEIV0(25:11)
  8213     CALL 'kxdfhei1' USING DFHEIV0,
  8214           DFHEIV1,
  8215           ORIGINAL-CERTIFICATE,
  8216           DFHEIV11,
  8217           OC-CONTROL-PRIMARY,
  8218           DFHEIV99,
  8219           DFHEIV99
  8220     MOVE EIBRESP  TO WS-RESPONSE
  8221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 144
* EL6316.cbl
  8222
  8223
  8224     IF NOT RESP-NORMAL
  8225         DISPLAY 'ERROR IN 0780 WRITING ELCRTO ' WS-RESPONSE
  8226         MOVE ER-9999      TO EMI-ERROR
  8227         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8228         GO TO 8200-SEND-DATAONLY
  8229     END-IF
  8230
  8231     .
  8232 0780-EXIT.
  8233     EXIT.
  8234
  8235
  8236 0783-LOAD-CERT-TO-CRTO-REC.
  8237
  8238      display 'made it to 0783'
  8239
  8240     MOVE '6316'                 TO OC-LAST-MAINT-BY
  8241     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  8242     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  8243     MOVE 'I'                    TO OC-RECORD-TYPE
  8244     MOVE CM-INSURED-LAST-NAME   TO OC-INS-LAST-NAME
  8245     MOVE CM-INSURED-FIRST-NAME  TO OC-INS-FIRST-NAME
  8246     MOVE CM-INSURED-INITIAL2    TO OC-INS-MIDDLE-INIT
  8247     MOVE CM-INSURED-ISSUE-AGE   TO OC-INS-AGE
  8248     MOVE CM-JT-LAST-NAME        TO OC-JNT-LAST-NAME
  8249     MOVE CM-JT-FIRST-NAME       TO OC-JNT-FIRST-NAME
  8250     MOVE CM-JT-INITIAL          TO OC-JNT-MIDDLE-INIT
  8251     MOVE CM-INSURED-JOINT-AGE   TO OC-JNT-AGE
  8252     MOVE CM-LF-BENEFIT-CD       TO OC-LF-BENCD
  8253     IF CM-LF-BENEFIT-CD NOT = '00' AND '  '
  8254         MOVE CM-LF-ORIG-TERM    TO OC-LF-TERM
  8255         MOVE CM-LF-BENEFIT-AMT  TO OC-LF-BEN-AMT
  8256         MOVE CM-LF-PREMIUM-AMT  TO OC-LF-PRM-AMT
  8257         MOVE CM-LF-ALT-BENEFIT-AMT TO OC-LF-ALT-BEN-AMT
  8258         MOVE CM-LF-ALT-PREMIUM-AMT TO OC-LF-ALT-PRM-AMT
  8259         MOVE CM-LF-LOAN-EXPIRE-DT TO OC-LF-EXP-DT
  8260         MOVE CM-LIFE-COMM-PCT   TO OC-LF-COMM-PCT
  8261         MOVE CM-LF-CANCEL-DT    TO OC-LF-CANCEL-DT
  8262         MOVE CM-LF-ITD-CANCEL-AMT TO OC-LF-CANCEL-AMT
  8263                                      OC-LF-ITD-CANCEL-AMT
  8264     END-IF
  8265     MOVE CM-AH-BENEFIT-CD       TO OC-AH-BENCD
  8266     IF CM-AH-BENEFIT-CD NOT = '00' AND '  '
  8267         MOVE CM-AH-ORIG-TERM    TO OC-AH-TERM
  8268         MOVE CM-AH-BENEFIT-AMT  TO OC-AH-BEN-AMT
  8269         MOVE CM-AH-PREMIUM-AMT  TO OC-AH-PRM-AMT
  8270         MOVE CM-AH-LOAN-EXPIRE-DT TO OC-AH-EXP-DT
  8271         MOVE CM-AH-COMM-PCT     TO OC-AH-COMM-PCT
  8272         MOVE CM-AH-CRITICAL-PERIOD TO OC-AH-CP
  8273         MOVE CM-AH-CANCEL-DT    TO OC-AH-CANCEL-DT
  8274         MOVE CM-AH-ITD-CANCEL-AMT TO OC-AH-CANCEL-AMT
  8275                                      OC-AH-ITD-CANCEL-AMT
  8276     END-IF
  8277     MOVE CM-LOAN-1ST-PMT-DT     TO OC-1ST-PMT-DT
  8278     MOVE 'N'                    TO OC-ISSUE-TRAN-IND
  8279     MOVE 'N'                    TO OC-CANCEL-TRAN-IND
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 145
* EL6316.cbl
  8280
  8281     MOVE LOW-VALUES             TO OC-ENDORSEMENT-PROCESSED-DT
  8282
  8283     MOVE ELCRTO-KEY (1:33) TO WS-ERMAIL-KEY
  8284
  8285
  8286* EXEC CICS READ
  8287*         DATASET   (WS-ERMAIL-FILE-ID)
  8288*         RIDFLD    (WS-ERMAIL-KEY)
  8289*         SET       (ADDRESS OF MAILING-DATA)
  8290*         RESP      (WS-RESPONSE)
  8291*    END-EXEC
  8292*    MOVE '&"S        E          (  N#00007614' TO DFHEIV0
  8293     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8294     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8295     MOVE X'204E233030303037363134' TO DFHEIV0(25:11)
  8296     CALL 'kxdfhei1' USING DFHEIV0,
  8297           WS-ERMAIL-FILE-ID,
  8298           DFHEIV20,
  8299           DFHEIV99,
  8300           WS-ERMAIL-KEY,
  8301           DFHEIV99,
  8302           DFHEIV99,
  8303           DFHEIV99
  8304     SET ADDRESS OF MAILING-DATA TO
  8305         DFHEIV20
  8306     MOVE EIBRESP  TO WS-RESPONSE
  8307     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8308
  8309     IF RESP-NORMAL
  8310         MOVE MA-CRED-BENE-NAME TO OC-CRED-BENE-NAME
  8311     END-IF.
  8312
  8313     MOVE ELCRTO-KEY (1:33)     TO WS-ELCRTT-PRIMARY
  8314     MOVE 'C'                   TO WS-ELCRTT-REC-TYPE
  8315
  8316
  8317* EXEC CICS READ
  8318*         DATASET  (WS-ELCRTT-FILE-ID)
  8319*         RIDFLD   (WS-ELCRTT-KEY)
  8320*         SET      (ADDRESS OF CERTIFICATE-TRAILERS)
  8321*         RESP     (WS-RESPONSE)
  8322*    END-EXEC
  8323*    MOVE '&"S        E          (  N#00007628' TO DFHEIV0
  8324     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8325     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8326     MOVE X'204E233030303037363238' TO DFHEIV0(25:11)
  8327     CALL 'kxdfhei1' USING DFHEIV0,
  8328           WS-ELCRTT-FILE-ID,
  8329           DFHEIV20,
  8330           DFHEIV99,
  8331           WS-ELCRTT-KEY,
  8332           DFHEIV99,
  8333           DFHEIV99,
  8334           DFHEIV99
  8335     SET ADDRESS OF CERTIFICATE-TRAILERS TO
  8336         DFHEIV20
  8337     MOVE EIBRESP  TO WS-RESPONSE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 146
* EL6316.cbl
  8338     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8339
  8340     IF RESP-NORMAL
  8341         MOVE CS-INS-AGE-DEFAULT-FLAG TO OC-INS-AGE-DEFAULT-FLAG
  8342         MOVE CS-JNT-AGE-DEFAULT-FLAG TO OC-JNT-AGE-DEFAULT-FLAG
  8343     END-IF.
  8344
  8345
  8346     .
  8347 0783-EXIT.
  8348     EXIT.
  8349
  8350 0785-CHG-CRTO-REC.
  8351
  8352     display 'made it to 0785'
  8353
  8354     MOVE '6316'                 TO OC-LAST-MAINT-BY
  8355     MOVE EIBTIME                TO OC-LAST-MAINT-HHMMSS
  8356     MOVE WS-CURRENT-BIN-DT      TO OC-LAST-MAINT-DT
  8357
  8358     MOVE OLFDTO                 TO WS-TMPDATE
  8359
  8360* EXEC CICS BIF DEEDIT
  8361*         FIELD   (WS-TMPDATE)
  8362*         LENGTH  (8)
  8363*    END-EXEC
  8364     MOVE 8
  8365       TO DFHEIV11
  8366*    MOVE '@"L                   #   #00007654' TO DFHEIV0
  8367     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8368     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8369     MOVE X'2020233030303037363534' TO DFHEIV0(25:11)
  8370     CALL 'kxdfhei1' USING DFHEIV0,
  8371           WS-TMPDATE,
  8372           DFHEIV11
  8373     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8374     MOVE WS-TMPDT               TO DC-GREG-DATE-1-MDY
  8375     MOVE '4'                    TO DC-OPTION-CODE
  8376     PERFORM 9700-DATE-LINK
  8377     IF NOT DATE-CONVERSION-ERROR
  8378        MOVE DC-BIN-DATE-1       TO OC-LF-CANCEL-DT
  8379     END-IF
  8380
  8381     display 'lf amt ' olfamto
  8382     MOVE OLFAMTO                TO WS-AMTX
  8383
  8384* EXEC CICS BIF DEEDIT
  8385*         FIELD   (WS-AMTX)
  8386*         LENGTH  (10)
  8387*    END-EXEC
  8388     MOVE 10
  8389       TO DFHEIV11
  8390*    MOVE '@"L                   #   #00007667' TO DFHEIV0
  8391     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8392     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8393     MOVE X'2020233030303037363637' TO DFHEIV0(25:11)
  8394     CALL 'kxdfhei1' USING DFHEIV0,
  8395           WS-AMTX,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 147
* EL6316.cbl
  8396           DFHEIV11
  8397     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8398     MOVE WS-AMTV2               TO OC-LF-CANCEL-AMT
  8399
  8400     MOVE OAHDTO                 TO WS-TMPDATE
  8401
  8402* EXEC CICS BIF DEEDIT
  8403*         FIELD   (WS-TMPDATE)
  8404*         LENGTH  (8)
  8405*    END-EXEC
  8406     MOVE 8
  8407       TO DFHEIV11
  8408*    MOVE '@"L                   #   #00007674' TO DFHEIV0
  8409     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8410     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8411     MOVE X'2020233030303037363734' TO DFHEIV0(25:11)
  8412     CALL 'kxdfhei1' USING DFHEIV0,
  8413           WS-TMPDATE,
  8414           DFHEIV11
  8415     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8416     MOVE WS-TMPDT               TO DC-GREG-DATE-1-MDY
  8417     MOVE '4'                    TO DC-OPTION-CODE
  8418     PERFORM 9700-DATE-LINK
  8419     IF NOT DATE-CONVERSION-ERROR
  8420        MOVE DC-BIN-DATE-1       TO OC-AH-CANCEL-DT
  8421     END-IF
  8422
  8423     display 'ah amt ' oahamto
  8424     MOVE OAHAMTO                TO WS-AMTX
  8425
  8426* EXEC CICS BIF DEEDIT
  8427*         FIELD   (WS-AMTX)
  8428*         LENGTH  (10)
  8429*    END-EXEC
  8430     MOVE 10
  8431       TO DFHEIV11
  8432*    MOVE '@"L                   #   #00007687' TO DFHEIV0
  8433     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  8434     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8435     MOVE X'2020233030303037363837' TO DFHEIV0(25:11)
  8436     CALL 'kxdfhei1' USING DFHEIV0,
  8437           WS-AMTX,
  8438           DFHEIV11
  8439     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8440     MOVE WS-AMTV2               TO OC-AH-CANCEL-AMT
  8441
  8442
  8443* EXEC CICS REWRITE
  8444*       DATASET   ('ELCRTO')
  8445*       FROM      (ORIGINAL-CERTIFICATE)
  8446*       RESP      (WS-RESPONSE)
  8447*    END-EXEC
  8448     MOVE LENGTH OF
  8449      ORIGINAL-CERTIFICATE
  8450       TO DFHEIV11
  8451     MOVE 'ELCRTO' TO DFHEIV1
  8452*    MOVE '&& L                  %  N#00007693' TO DFHEIV0
  8453     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 148
* EL6316.cbl
  8454     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8455     MOVE X'204E233030303037363933' TO DFHEIV0(25:11)
  8456     CALL 'kxdfhei1' USING DFHEIV0,
  8457           DFHEIV1,
  8458           ORIGINAL-CERTIFICATE,
  8459           DFHEIV11,
  8460           DFHEIV99
  8461     MOVE EIBRESP  TO WS-RESPONSE
  8462     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8463
  8464     IF NOT RESP-NORMAL
  8465         DISPLAY 'ERROR IN 0385 REWRITING ELCRTO ' WS-RESPONSE
  8466         MOVE ER-9999      TO EMI-ERROR
  8467         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8468         GO TO 8200-SEND-DATAONLY
  8469     END-IF
  8470
  8471     PERFORM 0361-MOVE-CRTO-TO-SCREEN THRU 0361-EXIT
  8472
  8473     .
  8474 0785-EXIT.
  8475     EXIT.
  8476
  8477 1000-FINALIZE.
  8478     PERFORM 0325-EDIT-SCREEN THRU 0325-EXIT
  8479     IF NOT EMI-NO-ERRORS
  8480      AND EIBAID = DFHPF4
  8481        GO TO 8200-SEND-DATAONLY
  8482     END-IF
  8483     display ' made it to 1000 '
  8484     set P to address of KIXSYS
  8485     CALL "getenv" using by value P returning var-ptr
  8486     if var-ptr = null then
  8487        display ' kixsys not set '
  8488     else
  8489        set address of var to var-ptr
  8490        move 0 to env-var-len
  8491        inspect var tallying env-var-len
  8492          for characters before X'00'
  8493*       DISPLAY '  KIXSYS = ' var (1:env-var-len)
  8494        unstring var (1:env-var-len) delimited by '/'
  8495           into WS-KIX-FIL1 WS-KIX-APPS WS-KIX-ENV WS-KIX-MYENV
  8496              WS-KIX-SYS
  8497        end-unstring
  8498*       DISPLAY ' WS KIX SYS ' WS-KIXSYS
  8499*       DISPLAY ' WS KIX MYENV ' WS-KIX-MYENV
  8500     end-if
  8501     set P to address of KIXHOST
  8502     CALL "getenv" using by value P returning var-ptr
  8503     if var-ptr = null then
  8504        display ' kixhost not set '
  8505     else
  8506        set address of var to var-ptr
  8507        move 0 to env-var-len
  8508        inspect var tallying env-var-len
  8509          for characters before X'00'
  8510*       DISPLAY '  KIXHOST = ' var (1:env-var-len)
  8511        MOVE var(1:env-var-len)  to ws-kixhost
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 149
* EL6316.cbl
  8512        DISPLAY ' WS KIX HOST ' WS-KIXhost
  8513     end-if
  8514     MOVE PI-ELCRTO-KEY          TO ELCRTO-KEY
  8515     PERFORM 0362-READ-ELCRTO    THRU 0362-EXIT
  8516     IF RESP-NORMAL
  8517        AND (PI-ELCRTO-KEY (1:33) =
  8518              OC-CONTROL-PRIMARY (1:33))
  8519           DISPLAY ' RESP NORMAL AND = '
  8520           MOVE OC-ORIG-REC         TO NEW-ORIG-REC
  8521           PERFORM 0400-ADD-ERENDT  THRU 0400-EXIT
  8522           PERFORM 1100-CALL-NS-BUS-LOGIC
  8523                                    THRU 1100-EXIT
  8524           IF BL-OK
  8525              CONTINUE
  8526           ELSE
  8527              MOVE ER-8888          TO EMI-ERROR-NUMBER (1)
  8528              MOVE BL-MESSAGE       TO EMI-ERROR-TEXT (1)
  8529              MOVE -1               TO CARRL
  8530           END-IF
  8531     ELSE
  8532        MOVE ER-3829             TO EMI-ERROR
  8533        PERFORM 9900-ERROR-FORMAT
  8534                                 THRU 9900-EXIT
  8535        MOVE -1                  TO CARRL
  8536        GO TO 8100-SEND-INITIAL-MAP
  8537     END-IF
  8538     PERFORM 0390-BUILD-FROM-ERENDT THRU 0390-EXIT
  8539     MOVE FUNCTION UPPER-CASE(WS-KIX-MYENV)
  8540                                 TO SYSO
  8541     MOVE WS-KIXHOST             TO HOSTO
  8542     MOVE PI-COMPANY-ID          TO COMPANYO
  8543     MOVE PI-PROCESSOR-ID        TO PROCIDO
  8544     IF PI-FROM-CERT = 'Y'
  8545         MOVE '2'                TO DATASORO
  8546     ELSE
  8547         MOVE '4'                TO DATASORO
  8548     END-IF
  8549     MOVE BL-BATCH-NO            TO BATCHNOO
  8550     MOVE BL-BATCH-SEQ           TO BSEQNOO
  8551     MOVE BL-ARCHIVE-NO          TO ARCHNOO
  8552*    MOVE -1                     TO PRTSWL
  8553*    MOVE AL-UANON               TO PRTSWA
  8554     IF EIBAID = DFHPF4
  8555        MOVE SPACES              TO PI-CLEAR-ERROR-SW
  8556        MOVE ER-0280             TO EMI-ERROR
  8557        PERFORM 9900-ERROR-FORMAT
  8558                                 THRU 9900-EXIT
  8559        MOVE BL-ARCHIVE-NO       TO W-ARCH-SUPPRESS
  8560        MOVE W-ARCH-EDIT         TO EMI-TEXT-VARIABLE (1)
  8561        MOVE 'Y'                 TO PI-FINALIZED-IND
  8562        GO TO 9400-CLEAR
  8563     ELSE
  8564        MOVE ER-1818             TO EMI-ERROR
  8565        PERFORM 9900-ERROR-FORMAT
  8566                                 THRU 9900-EXIT
  8567     END-IF
  8568     GO TO 8100-SEND-INITIAL-MAP
  8569     .
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 150
* EL6316.cbl
  8570 1000-EXIT.
  8571     EXIT.
  8572 1100-CALL-NS-BUS-LOGIC.
  8573     DISPLAY ' MADE IT TO 1100 ' w-arch-number
  8574     MOVE SPACES                 TO BL-INPUT
  8575     MOVE W-ARCH-NUMBER          TO BL-ARCHIVE-NO
  8576     IF PI-FROM-CERT = 'Y'
  8577         MOVE '2'                TO BL-DATA-SRCE
  8578         MOVE SPACES             TO BL-BATCH-NO
  8579         MOVE ZEROS              TO BL-BATCH-SEQ
  8580     ELSE
  8581         MOVE '4'                TO BL-DATA-SRCE
  8582         MOVE PB-ENTRY-BATCH     TO BL-BATCH-NO
  8583         MOVE PB-BATCH-SEQ-NO    TO BL-BATCH-SEQ
  8584     END-IF
  8585     MOVE PI-CARRIER             TO BL-CARRIER
  8586     MOVE PI-GROUPING            TO BL-GROUP
  8587     MOVE PI-STATE               TO BL-STATE
  8588     MOVE PI-ACCOUNT             TO BL-ACCOUNT
  8589     IF PI-CERT-EFF-DT NOT = LOW-VALUES
  8590        MOVE PI-CERT-EFF-DT      TO DC-BIN-DATE-1
  8591        MOVE ' '                 TO DC-OPTION-CODE
  8592        PERFORM 9700-date-link
  8593        IF NO-CONVERSION-ERROR
  8594           MOVE DC-GREG-DATE-B-EDIT
  8595                                 TO BL-EFF-DT
  8596        END-IF
  8597     END-IF
  8598     MOVE PI-CERT-NO             TO BL-CERT-NO
  8599     MOVE SPACES                 TO BL-RESP-NO
  8600     MOVE LTRIDI                 TO BL-LETTER-ID
  8601     MOVE W-NUMBER-OF-COPIES     TO BL-NO-OF-COPIES
  8602     MOVE PI-PROCESSOR-ID        TO BL-PROC-ID
  8603*    MOVE 'ALWA'                 TO BL-PROC-ID
  8604     MOVE PI-COMPANY-ID          TO BL-COMP-ID
  8605     MOVE PI-ENCCODE             TO BL-ENC-CD
  8606     IF EIBAID = DFHPF4
  8607        MOVE 'B'                 TO BL-WRITE-ERARCH
  8608     ELSE
  8609        MOVE 'T'                 TO BL-WRITE-ERARCH
  8610     END-IF
  8611     MOVE SPACES                 TO BL-CERT-FORM-ID
  8612     MOVE W-ARCH-NUMBER          TO BL-ENDT-ARCH-NO
  8613     MOVE 'CAN ENDT'             TO BL-SOURCE-SCREEN
  8614     PERFORM VARYING S1 FROM +1 BY +1 UNTIL S1 > +12
  8615        IF REACD-IN (S1) NOT = LOW-VALUES
  8616           MOVE REACD-IN (S1)    TO BL-REASON-CODE (S1)
  8617        END-IF
  8618     END-PERFORM
  8619    DISPLAY ' ABOUT TO LINK TO NSRASBL '
  8620     DISPLAY ' BL INPUT ' BL-INPUT
  8621*****************************************
  8622* Invoke the LETTER business logic
  8623*****************************************
  8624     MOVE FUNCTION LENGTH(SRCH-COMMAREA) TO WS-COMM-LENGTH
  8625     display ' srch commarea ' srch-commarea
  8626     display ' length ' ws-comm-length
  8627
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 151
* EL6316.cbl
  8628* exec cics link
  8629*       program('NSRASBL')
  8630*       commarea(srch-commarea)
  8631*       LENGTH  (WS-COMM-LENGTH)
  8632*    end-exec.
  8633     MOVE 'NSRASBL' TO DFHEIV1
  8634*    MOVE '."C                   (   #00007862' TO DFHEIV0
  8635     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  8636     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8637     MOVE X'2020233030303037383632' TO DFHEIV0(25:11)
  8638     CALL 'kxdfhei1' USING DFHEIV0,
  8639           DFHEIV1,
  8640           srch-commarea,
  8641           WS-COMM-LENGTH,
  8642           DFHEIV99,
  8643           DFHEIV99,
  8644           DFHEIV99,
  8645           DFHEIV99
  8646     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8647
  8648     DISPLAY ' MADE IT BACK FROM NSRASBL ' BL-STATUS ' '
  8649        BL-MESSAGE
  8650     .
  8651 1100-EXIT.
  8652     EXIT.
  8653 1500-GET-ARCH-NO.
  8654     display ' made it to 1500 '
  8655     MOVE SPACES                 TO ELCNTL-KEY
  8656     MOVE PI-COMPANY-ID          TO CNTL-COMP-ID
  8657     MOVE '1'                    TO CNTL-REC-TYPE
  8658     MOVE ZEROS                  TO CNTL-SEQ
  8659
  8660* EXEC CICS READ
  8661*         DATASET    (WS-ELCNTL-FILE-ID)
  8662*         SET        (ADDRESS OF CONTROL-FILE)
  8663*         RIDFLD     (ELCNTL-KEY)
  8664*         UPDATE
  8665*         RESP       (WS-RESPONSE)
  8666*    END-EXEC
  8667*    MOVE '&"S        EU         (  N#00007878' TO DFHEIV0
  8668     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8669     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8670     MOVE X'204E233030303037383738' TO DFHEIV0(25:11)
  8671     CALL 'kxdfhei1' USING DFHEIV0,
  8672           WS-ELCNTL-FILE-ID,
  8673           DFHEIV20,
  8674           DFHEIV99,
  8675           ELCNTL-KEY,
  8676           DFHEIV99,
  8677           DFHEIV99,
  8678           DFHEIV99
  8679     SET ADDRESS OF CONTROL-FILE TO
  8680         DFHEIV20
  8681     MOVE EIBRESP  TO WS-RESPONSE
  8682     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8683     IF RESP-NORMAL
  8684        display ' good read elcntl '
  8685        IF CF-CREDIT-LAST-ARCH-NUM NOT NUMERIC
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 152
* EL6316.cbl
  8686           MOVE ZEROS            TO CF-CREDIT-LAST-ARCH-NUM
  8687        END-IF
  8688        ADD 1                    TO CF-CREDIT-LAST-ARCH-NUM
  8689        MOVE CF-CREDIT-LAST-ARCH-NUM
  8690                                 TO W-ARCH-NUMBER
  8691        display ' new arch number ' w-arch-number
  8692
  8693* EXEC CICS REWRITE
  8694*          FROM      (CONTROL-FILE)
  8695*          DATASET   (WS-ELCNTL-FILE-ID)
  8696*       END-EXEC
  8697     MOVE LENGTH OF
  8698      CONTROL-FILE
  8699       TO DFHEIV11
  8700*    MOVE '&& L                  %   #00007894' TO DFHEIV0
  8701     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8702     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8703     MOVE X'2020233030303037383934' TO DFHEIV0(25:11)
  8704     CALL 'kxdfhei1' USING DFHEIV0,
  8705           WS-ELCNTL-FILE-ID,
  8706           CONTROL-FILE,
  8707           DFHEIV11,
  8708           DFHEIV99
  8709     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8710     END-IF
  8711     .
  8712 1500-EXIT.
  8713     EXIT.
  8714
  8715
  8716 1700-WRITE-CERT-NOTE      SECTION.
  8717
  8718     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY.
  8719     MOVE ZERO           TO ERCNOT-SEQ.
  8720     SET TB-INDX         DOWN BY 1.
  8721     SET TB-INDX1        TO TB-INDX.
  8722
  8723****DELETE CURRENT CERT NOTES
  8724 1700-LOOP.
  8725
  8726* EXEC CICS READ
  8727*        DATASET (WS-ERCNOT-FILE-ID)
  8728*        RIDFLD  (ERCNOT-KEY)
  8729*        SET     (ADDRESS OF CERT-NOTE-FILE)
  8730*        RESP    (WS-RESPONSE)
  8731*        GTEQ
  8732*    END-EXEC.
  8733*    MOVE '&"S        G          (  N#00007913' TO DFHEIV0
  8734     MOVE X'262253202020202020202047' TO DFHEIV0(1:12)
  8735     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8736     MOVE X'204E233030303037393133' TO DFHEIV0(25:11)
  8737     CALL 'kxdfhei1' USING DFHEIV0,
  8738           WS-ERCNOT-FILE-ID,
  8739           DFHEIV20,
  8740           DFHEIV99,
  8741           ERCNOT-KEY,
  8742           DFHEIV99,
  8743           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 153
* EL6316.cbl
  8744           DFHEIV99
  8745     SET ADDRESS OF CERT-NOTE-FILE TO
  8746         DFHEIV20
  8747     MOVE EIBRESP  TO WS-RESPONSE
  8748     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8749
  8750
  8751     IF NOT RESP-NORMAL
  8752        GO TO 1700-ENDDEL
  8753     END-IF
  8754
  8755     MOVE CZ-CONTROL-PRIMARY     TO ERCNOT-KEY.
  8756
  8757     IF ERCNOT-PARTIAL-KEY NOT = SV-PARTIAL-KEY
  8758         GO TO 1700-ENDDEL
  8759     END-IF.
  8760
  8761
  8762* EXEC CICS DELETE
  8763*        DATASET (WS-ERCNOT-FILE-ID)
  8764*        RIDFLD  (ERCNOT-KEY)
  8765*    END-EXEC.
  8766*    MOVE '&(  R                 &   #00007931' TO DFHEIV0
  8767     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8768     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8769     MOVE X'2020233030303037393331' TO DFHEIV0(25:11)
  8770     CALL 'kxdfhei1' USING DFHEIV0,
  8771           WS-ERCNOT-FILE-ID,
  8772           ERCNOT-KEY,
  8773           DFHEIV99,
  8774           DFHEIV99,
  8775           DFHEIV99
  8776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8777
  8778
  8779     GO TO 1700-LOOP.
  8780
  8781 1700-ENDDEL.
  8782
  8783
  8784* EXEC CICS GETMAIN
  8785*         LENGTH(ERCNOT-LENGTH)
  8786*         SET(ADDRESS OF CERT-NOTE-FILE)
  8787*         INITIMG(GETMAIN-SPACE)
  8788*    END-EXEC.
  8789*    MOVE ',"IL                  $   #00007940' TO DFHEIV0
  8790     MOVE X'2C22494C2020202020202020' TO DFHEIV0(1:12)
  8791     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8792     MOVE X'2020233030303037393430' TO DFHEIV0(25:11)
  8793     CALL 'kxdfhei1' USING DFHEIV0,
  8794           DFHEIV20,
  8795           ERCNOT-LENGTH,
  8796           GETMAIN-SPACE
  8797     SET ADDRESS OF CERT-NOTE-FILE TO
  8798         DFHEIV20
  8799     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8800
  8801
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 154
* EL6316.cbl
  8802     SET TB-INDX TO 1.
  8803     MOVE SV-PARTIAL-KEY TO ERCNOT-PARTIAL-KEY
  8804     MOVE +0             TO ERCNOT-SEQ
  8805
  8806     PERFORM VARYING TB-INDX FROM 1 BY 1
  8807             UNTIL TB-INDX > TB-INDX1
  8808        MOVE SPACES                 TO  CERT-NOTE-FILE
  8809        ADD 1                       TO  ERCNOT-SEQ
  8810        MOVE ERCNOT-KEY             TO  CZ-CONTROL-PRIMARY
  8811        MOVE  'CZ'                  TO  CZ-RECORD-ID
  8812        MOVE CERT-NT-TEXT (TB-INDX) TO  CZ-NOTE
  8813        MOVE CERT-NT-LAST-MAINT-BY (TB-INDX)
  8814                                    TO  CZ-LAST-MAINT-USER
  8815        MOVE CERT-NT-LAST-MAINT-HHMMSS (TB-INDX)
  8816                                    TO  CZ-LAST-MAINT-HHMMSS
  8817        MOVE CERT-NT-LAST-MAINT-DT (TB-INDX)
  8818                                    TO  CZ-LAST-MAINT-DT
  8819
  8820
  8821* EXEC CICS WRITE
  8822*            DATASET(WS-ERCNOT-FILE-ID)
  8823*            FROM(CERT-NOTE-FILE)
  8824*            RIDFLD(ERCNOT-KEY)
  8825*       END-EXEC
  8826     MOVE LENGTH OF
  8827      CERT-NOTE-FILE
  8828       TO DFHEIV11
  8829*    MOVE '&$ L                  ''   #00007964' TO DFHEIV0
  8830     MOVE X'2624204C2020202020202020' TO DFHEIV0(1:12)
  8831     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  8832     MOVE X'2020233030303037393634' TO DFHEIV0(25:11)
  8833     CALL 'kxdfhei1' USING DFHEIV0,
  8834           WS-ERCNOT-FILE-ID,
  8835           CERT-NOTE-FILE,
  8836           DFHEIV11,
  8837           ERCNOT-KEY,
  8838           DFHEIV99,
  8839           DFHEIV99
  8840     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8841     END-PERFORM
  8842
  8843     PERFORM 1800-READ-ELCERT-UPDATE THRU 1800-EXIT
  8844     IF RESP-NORMAL
  8845        EVALUATE CM-NOTE-SW
  8846           WHEN '1'
  8847           WHEN '3'
  8848           WHEN '5'
  8849           WHEN '7'
  8850              SET NO-CERT-RW     TO TRUE
  8851           WHEN ' '
  8852              MOVE '1'           TO CM-NOTE-SW
  8853           WHEN '2'
  8854              MOVE '3'           TO CM-NOTE-SW
  8855           WHEN '4'
  8856              MOVE '5'           TO CM-NOTE-SW
  8857           WHEN '6'
  8858              MOVE '7'           TO CM-NOTE-SW
  8859        END-EVALUATE
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 155
* EL6316.cbl
  8860     END-IF
  8861     IF NOT NO-CERT-RW
  8862        PERFORM 1810-REWRITE-ELCERT
  8863                                 THRU 1810-EXIT
  8864     ELSE
  8865
  8866* EXEC CICS UNLOCK
  8867*          DATASET    (WS-ELCERT-FILE-ID)
  8868*       END-EXEC
  8869*    MOVE '&*                    #   #00007993' TO DFHEIV0
  8870     MOVE X'262A20202020202020202020' TO DFHEIV0(1:12)
  8871     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  8872     MOVE X'2020233030303037393933' TO DFHEIV0(25:11)
  8873     CALL 'kxdfhei1' USING DFHEIV0,
  8874           WS-ELCERT-FILE-ID,
  8875           DFHEIV99
  8876     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  8877     END-IF
  8878
  8879     .
  8880 1799-EXIT.
  8881     EXIT.
  8882
  8883 1800-READ-ELCERT-UPDATE.
  8884
  8885     MOVE PI-COMPANY-CD          TO  W-CERT-COMPANY-CD.
  8886     MOVE PI-CRTO-CARRIER        TO  W-CERT-CARRIER.
  8887     MOVE PI-CRTO-GROUPING       TO  W-CERT-GROUPING.
  8888     MOVE PI-CRTO-STATE          TO  W-CERT-STATE.
  8889     MOVE PI-CRTO-ACCOUNT        TO  W-CERT-ACCOUNT.
  8890     MOVE PI-CRTO-CERT-EFF-DT    TO  W-CERT-CERT-EFF-DT.
  8891     MOVE PI-CRTO-CERT-PRIME     TO  W-CERT-CERT-PRIME.
  8892     MOVE PI-CRTO-CERT-SFX       TO  W-CERT-CERT-SFX.
  8893
  8894
  8895* EXEC CICS READ
  8896*        UPDATE
  8897*        DATASET  (WS-ELCERT-FILE-ID)
  8898*        RIDFLD   (WS-ELCERT-KEY)
  8899*        SET      (ADDRESS OF CERTIFICATE-MASTER)
  8900*        RESP     (WS-RESPONSE)
  8901*    END-EXEC
  8902*    MOVE '&"S        EU         (  N#00008013' TO DFHEIV0
  8903     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8904     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8905     MOVE X'204E233030303038303133' TO DFHEIV0(25:11)
  8906     CALL 'kxdfhei1' USING DFHEIV0,
  8907           WS-ELCERT-FILE-ID,
  8908           DFHEIV20,
  8909           DFHEIV99,
  8910           WS-ELCERT-KEY,
  8911           DFHEIV99,
  8912           DFHEIV99,
  8913           DFHEIV99
  8914     SET ADDRESS OF CERTIFICATE-MASTER TO
  8915         DFHEIV20
  8916     MOVE EIBRESP  TO WS-RESPONSE
  8917     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 156
* EL6316.cbl
  8918
  8919     .
  8920 1800-EXIT.
  8921     EXIT.
  8922
  8923 1810-REWRITE-ELCERT.
  8924
  8925
  8926* EXEC CICS REWRITE
  8927*        FROM     (CERTIFICATE-MASTER)
  8928*        DATASET  (WS-ELCERT-FILE-ID)
  8929*        RESP     (WS-RESPONSE)
  8930*    END-EXEC.
  8931     MOVE LENGTH OF
  8932      CERTIFICATE-MASTER
  8933       TO DFHEIV11
  8934*    MOVE '&& L                  %  N#00008027' TO DFHEIV0
  8935     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  8936     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  8937     MOVE X'204E233030303038303237' TO DFHEIV0(25:11)
  8938     CALL 'kxdfhei1' USING DFHEIV0,
  8939           WS-ELCERT-FILE-ID,
  8940           CERTIFICATE-MASTER,
  8941           DFHEIV11,
  8942           DFHEIV99
  8943     MOVE EIBRESP  TO WS-RESPONSE
  8944     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8945
  8946
  8947     .
  8948 1810-EXIT.
  8949     EXIT.
  8950
  8951 8100-SEND-INITIAL-MAP.
  8952     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  8953     MOVE '5'                    TO DC-OPTION-CODE.
  8954     PERFORM 9700-DATE-LINK.
  8955     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  8956     MOVE EIBTIME                TO TIME-IN.
  8957     MOVE TIME-OUT               TO TIMEO.
  8958     MOVE -1                     TO LTRIDL
  8959*    MOVE AL-UANON               TO PRTSWA
  8960     IF PI-PROCESSOR-IS-CSR-SUPER
  8961      AND PI-ENDORSE-RECORD NOT EQUAL 'Y'
  8962        perform varying s1 from +1 by +1 until
  8963           s1 > +12
  8964           MOVE AL-UANON            TO reacda (s1)
  8965        end-perform
  8966     END-IF
  8967
  8968     IF PI-FROM-CERT = 'Y' AND
  8969        PI-PROCESSOR-IS-CSR-SUPER AND
  8970        PI-ENDORSE-RECORD NOT EQUAL 'Y'
  8971            MOVE AL-UNNON        TO OLFDTA
  8972                                    OAHDTA
  8973                                    OLFAMTA
  8974                                    OAHAMTA
  8975     END-IF
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 157
* EL6316.cbl
  8976
  8977     IF PI-FROM-CERT = 'Y' AND
  8978        NOT PI-PROCESSOR-IS-CSR-SUPER
  8979            MOVE AL-SANOF        TO LTRIDA
  8980                                    ENCCODEA
  8981                                    CRTNT1A
  8982                                    CRTNT2A
  8983                                    BILNT1A
  8984            MOVE AL-SADOF        TO PF3A
  8985                                    PF4A
  8986     END-IF
  8987
  8988     IF PI-ENDORSE-RECORD = 'Y'
  8989            MOVE AL-SANOF        TO LTRIDA
  8990                                    ENCCODEA
  8991                                    CRTNT1A
  8992                                    CRTNT2A
  8993                                    BILNT1A
  8994            MOVE AL-SADOF        TO PF3A
  8995                                    PF4A
  8996     END-IF
  8997     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO.
  8998
  8999* EXEC CICS SEND
  9000*        MAP      (MAP-NAME)
  9001*        MAPSET   (MAPSET-NAME)
  9002*        FROM     (EL631IO)
  9003*        ERASE
  9004*        CURSOR
  9005*    END-EXEC.
  9006     MOVE LENGTH OF
  9007      EL631IO
  9008       TO DFHEIV12
  9009     MOVE -1
  9010       TO DFHEIV11
  9011*    MOVE '8$     CT  E    H L F ,   #00008084' TO DFHEIV0
  9012     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9013     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9014     MOVE X'2020233030303038303834' TO DFHEIV0(25:11)
  9015     CALL 'kxdfhei1' USING DFHEIV0,
  9016           MAP-NAME,
  9017           EL631IO,
  9018           DFHEIV12,
  9019           MAPSET-NAME,
  9020           DFHEIV99,
  9021           DFHEIV99,
  9022           DFHEIV99,
  9023           DFHEIV11,
  9024           DFHEIV99,
  9025           DFHEIV99,
  9026           DFHEIV99
  9027     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9028
  9029     GO TO 9100-RETURN-TRAN.
  9030 8200-SEND-DATAONLY.
  9031     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  9032     MOVE '5'                    TO DC-OPTION-CODE.
  9033     PERFORM 9700-DATE-LINK.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 158
* EL6316.cbl
  9034     MOVE DC-GREG-DATE-1-EDIT    TO DATEO.
  9035     MOVE EIBTIME                TO TIME-IN.
  9036     MOVE TIME-OUT               TO TIMEO.
  9037     MOVE -1                     TO PFENTRL
  9038     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSGO
  9039
  9040* EXEC CICS SEND
  9041*        MAP      (MAP-NAME)
  9042*        MAPSET   (MAPSET-NAME)
  9043*        FROM     (EL631IO)
  9044*        DATAONLY
  9045*        ERASEAUP
  9046*        CURSOR
  9047*    END-EXEC.
  9048     MOVE LENGTH OF
  9049      EL631IO
  9050       TO DFHEIV12
  9051     MOVE -1
  9052       TO DFHEIV11
  9053*    MOVE '8$D    CT  A    H L F ,   #00008101' TO DFHEIV0
  9054     MOVE X'382444202020204354202041' TO DFHEIV0(1:12)
  9055     MOVE X'2020202048204C2046202C20' TO DFHEIV0(13:12)
  9056     MOVE X'2020233030303038313031' TO DFHEIV0(25:11)
  9057     CALL 'kxdfhei1' USING DFHEIV0,
  9058           MAP-NAME,
  9059           EL631IO,
  9060           DFHEIV12,
  9061           MAPSET-NAME,
  9062           DFHEIV99,
  9063           DFHEIV99,
  9064           DFHEIV99,
  9065           DFHEIV11,
  9066           DFHEIV99,
  9067           DFHEIV99,
  9068           DFHEIV99
  9069     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9070
  9071     GO TO 9100-RETURN-TRAN.
  9072 8300-SEND-TEXT.
  9073
  9074* EXEC CICS SEND TEXT
  9075*        FROM     (LOGOFF-TEXT)
  9076*        LENGTH   (LOGOFF-LENGTH)
  9077*        ERASE
  9078*        FREEKB
  9079*    END-EXEC.
  9080*    MOVE '8&      T  E F  H   F -   #00008111' TO DFHEIV0
  9081     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9082     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9083     MOVE X'2020233030303038313131' TO DFHEIV0(25:11)
  9084     CALL 'kxdfhei1' USING DFHEIV0,
  9085           LOGOFF-TEXT,
  9086           LOGOFF-LENGTH,
  9087           DFHEIV99,
  9088           DFHEIV99,
  9089           DFHEIV99,
  9090           DFHEIV99,
  9091           DFHEIV99,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 159
* EL6316.cbl
  9092           DFHEIV99,
  9093           DFHEIV99,
  9094           DFHEIV99,
  9095           DFHEIV99,
  9096           DFHEIV99
  9097     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9098
  9099
  9100* EXEC CICS RETURN
  9101*    END-EXEC.
  9102*    MOVE '.(                    ''   #00008117' TO DFHEIV0
  9103     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9104     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9105     MOVE X'2020233030303038313137' TO DFHEIV0(25:11)
  9106     CALL 'kxdfhei1' USING DFHEIV0,
  9107           DFHEIV99,
  9108           DFHEIV99,
  9109           DFHEIV99,
  9110           DFHEIV99,
  9111           DFHEIV99,
  9112           DFHEIV99
  9113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9114
  9115 8800-UNAUTHORIZED-ACCESS.
  9116     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  9117     GO TO 8300-SEND-TEXT.
  9118 8810-PF23.
  9119     MOVE EIBAID                 TO PI-ENTRY-CD-1.
  9120     MOVE XCTL-005               TO PGM-NAME.
  9121     GO TO 9300-XCTL.
  9122 9000-RETURN-CICS.
  9123
  9124* EXEC CICS RETURN
  9125*    END-EXEC.
  9126*    MOVE '.(                    ''   #00008127' TO DFHEIV0
  9127     MOVE X'2E2820202020202020202020' TO DFHEIV0(1:12)
  9128     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9129     MOVE X'2020233030303038313237' TO DFHEIV0(25:11)
  9130     CALL 'kxdfhei1' USING DFHEIV0,
  9131           DFHEIV99,
  9132           DFHEIV99,
  9133           DFHEIV99,
  9134           DFHEIV99,
  9135           DFHEIV99,
  9136           DFHEIV99
  9137     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9138
  9139 9100-RETURN-TRAN.
  9140     MOVE EMI-ERROR-NUMBER (1)   TO PI-LAST-ERROR-NO.
  9141     MOVE SCREEN-NUMBER          TO PI-CURRENT-SCREEN-NO.
  9142
  9143* EXEC CICS RETURN
  9144*        TRANSID    (TRANS-ID)
  9145*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  9146*        LENGTH     (1300)
  9147*    END-EXEC.
  9148     MOVE 1300
  9149       TO DFHEIV11
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 160
* EL6316.cbl
  9150*    MOVE '.(CT                  ''   #00008132' TO DFHEIV0
  9151     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9152     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9153     MOVE X'2020233030303038313332' TO DFHEIV0(25:11)
  9154     CALL 'kxdfhei1' USING DFHEIV0,
  9155           TRANS-ID,
  9156           PROGRAM-INTERFACE-BLOCK,
  9157           DFHEIV11,
  9158           DFHEIV99,
  9159           DFHEIV99,
  9160           DFHEIV99
  9161     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9162
  9163 9200-RETURN-MAIN-MENU.
  9164     MOVE XCTL-626               TO PGM-NAME.
  9165     GO TO 9300-XCTL.
  9166 9300-XCTL.
  9167
  9168* EXEC CICS XCTL
  9169*        PROGRAM    (PGM-NAME)
  9170*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  9171*        LENGTH     (1300)
  9172*    END-EXEC.
  9173     MOVE 1300
  9174       TO DFHEIV11
  9175*    MOVE '.$C                   %   #00008141' TO DFHEIV0
  9176     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9177     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9178     MOVE X'2020233030303038313431' TO DFHEIV0(25:11)
  9179     CALL 'kxdfhei1' USING DFHEIV0,
  9180           PGM-NAME,
  9181           PROGRAM-INTERFACE-BLOCK,
  9182           DFHEIV11,
  9183           DFHEIV99
  9184     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9185
  9186 9400-CLEAR.
  9187     MOVE PI-RETURN-TO-PROGRAM   TO PGM-NAME.
  9188
  9189* EXEC CICS XCTL
  9190*        PROGRAM    (PGM-NAME)
  9191*        COMMAREA   (PROGRAM-INTERFACE-BLOCK)
  9192*        LENGTH     (1300)
  9193*    END-EXEC.
  9194     MOVE 1300
  9195       TO DFHEIV11
  9196*    MOVE '.$C                   %   #00008148' TO DFHEIV0
  9197     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9198     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9199     MOVE X'2020233030303038313438' TO DFHEIV0(25:11)
  9200     CALL 'kxdfhei1' USING DFHEIV0,
  9201           PGM-NAME,
  9202           PROGRAM-INTERFACE-BLOCK,
  9203           DFHEIV11,
  9204           DFHEIV99
  9205     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9206
  9207 9500-PF12.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 161
* EL6316.cbl
  9208     MOVE XCTL-010               TO PGM-NAME.
  9209     GO TO 9300-XCTL.
  9210 9600-PGMID-ERROR.
  9211
  9212* EXEC CICS HANDLE CONDITION
  9213*        PGMIDERR    (8300-SEND-TEXT)
  9214*    END-EXEC.
  9215*    MOVE '"$L                   ! " #00008157' TO DFHEIV0
  9216     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9217     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9218     MOVE X'2220233030303038313537' TO DFHEIV0(25:11)
  9219     CALL 'kxdfhei1' USING DFHEIV0
  9220     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9221
  9222     MOVE PGM-NAME               TO PI-CALLING-PROGRAM.
  9223     MOVE ' '                    TO PI-ENTRY-CD-1.
  9224     MOVE XCTL-005               TO PGM-NAME.
  9225     MOVE PGM-NAME               TO LOGOFF-PGM.
  9226     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  9227     GO TO 9300-XCTL.
  9228 9700-DATE-LINK.
  9229     MOVE LINK-ELDATCV           TO PGM-NAME.
  9230
  9231* EXEC CICS LINK
  9232*        PROGRAM    (PGM-NAME)
  9233*        COMMAREA   (DATE-CONVERSION-DATA)
  9234*        LENGTH     (DC-COMM-LENGTH)
  9235*    END-EXEC.
  9236*    MOVE '."C                   (   #00008168' TO DFHEIV0
  9237     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9238     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9239     MOVE X'2020233030303038313638' TO DFHEIV0(25:11)
  9240     CALL 'kxdfhei1' USING DFHEIV0,
  9241           PGM-NAME,
  9242           DATE-CONVERSION-DATA,
  9243           DC-COMM-LENGTH,
  9244           DFHEIV99,
  9245           DFHEIV99,
  9246           DFHEIV99,
  9247           DFHEIV99
  9248     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9249
  9250 9900-ERROR-FORMAT.
  9251     IF NOT EMI-ERRORS-COMPLETE
  9252        MOVE LINK-001            TO PGM-NAME
  9253
  9254* EXEC CICS LINK
  9255*           PROGRAM    (PGM-NAME)
  9256*           COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  9257*           LENGTH     (EMI-COMM-LENGTH)
  9258*       END-EXEC
  9259*    MOVE '."C                   (   #00008176' TO DFHEIV0
  9260     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9261     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9262     MOVE X'2020233030303038313736' TO DFHEIV0(25:11)
  9263     CALL 'kxdfhei1' USING DFHEIV0,
  9264           PGM-NAME,
  9265           ERROR-MESSAGE-INTERFACE-BLOCK,
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 162
* EL6316.cbl
  9266           EMI-COMM-LENGTH,
  9267           DFHEIV99,
  9268           DFHEIV99,
  9269           DFHEIV99,
  9270           DFHEIV99
  9271     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9272     END-IF
  9273     .
  9274 9900-EXIT.
  9275     EXIT.
  9276 9990-ABEND.
  9277     MOVE LINK-004               TO PGM-NAME.
  9278     MOVE DFHEIBLK               TO EMI-LINE1.
  9279
  9280* EXEC CICS LINK
  9281*        PROGRAM   (PGM-NAME)
  9282*        COMMAREA  (EMI-LINE1)
  9283*        LENGTH    (72)
  9284*    END-EXEC.
  9285     MOVE 72
  9286       TO DFHEIV11
  9287*    MOVE '."C                   (   #00008188' TO DFHEIV0
  9288     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9289     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9290     MOVE X'2020233030303038313838' TO DFHEIV0(25:11)
  9291     CALL 'kxdfhei1' USING DFHEIV0,
  9292           PGM-NAME,
  9293           EMI-LINE1,
  9294           DFHEIV11,
  9295           DFHEIV99,
  9296           DFHEIV99,
  9297           DFHEIV99,
  9298           DFHEIV99
  9299     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9300
  9301     GO TO 8200-SEND-DATAONLY.
  9302
  9303* GOBACK.
  9304     MOVE '9%                    "   ' TO DFHEIV0
  9305     MOVE 'EL6316' TO DFHEIV1
  9306     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9307     GOBACK.
  9308 9995-SECURITY-VIOLATION.
  9309*                            COPY ELCSCTP.
  9310******************************************************************
  9311*                                                                *
  9312*                            ELCSCTP                             *
  9313*                            VMOD=2.001                          *
  9314*                                                                *
  9315*   DESCRIPTION = C.I.C.S. COMMON SECURITY-MESSAGE LINK          *
  9316******************************************************************
  9317
  9318
  9319     MOVE EIBDATE          TO SM-JUL-DATE.
  9320     MOVE EIBTRMID         TO SM-TERMID.
  9321     MOVE THIS-PGM         TO SM-PGM.
  9322     MOVE EIBTIME          TO TIME-IN.
  9323     MOVE TIME-OUT         TO SM-TIME.
* Micro Focus Server Express         V5.1 revision 000 29-Sep-20 14:18 Page 163
* EL6316.cbl
  9324     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9325
  9326
  9327* EXEC CICS LINK
  9328*         PROGRAM  ('EL003')
  9329*         COMMAREA (SECURITY-MESSAGE)
  9330*         LENGTH   (80)
  9331*    END-EXEC.
  9332     MOVE 'EL003' TO DFHEIV1
  9333     MOVE 80
  9334       TO DFHEIV11
  9335*    MOVE '."C                   (   #00008213' TO DFHEIV0
  9336     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9337     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9338     MOVE X'2020233030303038323133' TO DFHEIV0(25:11)
  9339     CALL 'kxdfhei1' USING DFHEIV0,
  9340           DFHEIV1,
  9341           SECURITY-MESSAGE,
  9342           DFHEIV11,
  9343           DFHEIV99,
  9344           DFHEIV99,
  9345           DFHEIV99,
  9346           DFHEIV99
  9347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9348
  9349
  9350******************************************************************
  9351
  9352 9995-EXIT.
  9353     EXIT.
  9354
  9355 9999-DFHBACK SECTION.
  9356     MOVE '9%                    "   ' TO DFHEIV0
  9357     MOVE 'EL6316' TO DFHEIV1
  9358     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9359     GOBACK.
  9360 9999-DFHEXIT.
  9361     IF DFHEIGDJ EQUAL 0001
  9362         NEXT SENTENCE
  9363     ELSE IF DFHEIGDJ EQUAL 2
  9364         GO TO 8300-SEND-TEXT
  9365         DEPENDING ON DFHEIGDI.
  9366     MOVE '9%                    "   ' TO DFHEIV0
  9367     MOVE 'EL6316' TO DFHEIV1
  9368     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9369     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:       35216     Code:       23389
