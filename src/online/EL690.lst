* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   1
* EL690.cbl
* Options: int("EL690.int") anim csi verbose NOBOUND LINKCHECK PARAMCOUNTCHECK
*          directives(cobopt.bth) endp list("EL690.lst")
* Setting: NOACCEPTREFRESH NOADV ALIGN"8" ALPHASTART"1" NOALTER NOAMODE ANIM
*          NOANIMPREP ANS85 APOST NOAREACHECK ARITHMETIC"OSVS" ASSIGN
*          "EXTERNAL" NOASSIGN-PRINTER NOAUTOLOCK NOBELL NOBOUND NOBRIEF
*          NOBS2000 BWZSTAR NOBYTEMODEMOVE CALLFH"EXTFH" NOCALLMCS
*          NOCALLRECOVERY CALLSORT"EXTSM" CANCEL CANCELLBR NOCHANGEMESSAGE
*          CHARSET"ASCII" CHECKDIV"ANSI" NOCHECKREFMOD NOCICS CICS-CPY
*          NOCICSOPTIMIZE NOCMPR2 NOCOBFSTATCONV NOCOBIDY NOCOBOL370 COBOLDIR
*          NOCOMP COMP-5"2" COMP-6"2" NOCOMS85 CONFIRM NOCONVERTRET CONVSPACE
*          COPYEXT",cbl,cpy" NOCOPYLBR COPYLIST COPYLISTCOMMENT"1" CSI
*          CURRENCY-SIGN"36" CURRENT-DATE"MMDDYY" NODATA DATACOMPRESS"0"
*          NODATA-CONTEXT DATE DBCHECK DBCS"2" NODBCSSOSI DBSPACE DE-EDIT"2"
*          DEFAULTBYTE"0" NODEFAULTCALLS DETECTLOCK NODG DIALECT"MF"
*          NODIRECTIVES-IN-COMMENTS NODOSVS NODPCINSUBSCRIPT DYNAM
*          NOEARLY-RELEASE ECHO NOECHOALL NOEDITOR ENSUITE"0" NOENTCOBOL
*          ERRFORMAT"1" ERRLIST"EMBED" NOERRQ FASTSORT NOFCD3 NOFCDREG
*          NOFDCLEAR NOFILESHARE FILETYPE"0" NOFLAG NOFLAGAS NOFLAGCD
*          NOFLAGEUC NOFLAGMIG NOFLAGQ FLAGSINEDIT NOFLAGSTD NOFOLDCALLNAME
*          NOFOLDCOPYNAME FORM"60" NOFP-ROUNDING NOHOSTARITHMETIC
*          NOHOSTCONTZERO NOHOST-NUMCOMPARE NOHOST-NUMMOVE NOHOSTFD NOHOSTRW
*          NOIBM-MS IBMCOMP IDXFORMAT"0" NOILGEN IMPLICITSCOPE NOINDD
*          INFORETURN"0" NOINITCALL INITPTR INT"EL690.int" INTDATE"ANSI"
*          INTLEVEL"2" IOCONV NOISO2002 NOIXNLSKEY NOIXNUMKEY KEEP-INT
*          KEYCHECK KEYCOMPRESS"0" LIBRARIAN"2" NOLINE-COUNT LIST"EL690.lst"
*          LISTPATH"" LISTWIDTH"80" LITVAL-SIZE"4" LOCKTYPE"0" NOMAPNAME
*          NOMAXERROR METHODDEFAULT"REFERENCE" MF"15" MFCOMMENT NOMOVELENCHECK
*          NOMS NOMVS NATIVE"ASCII" NONATIVEFLOATINGPOINT NONCHAR
*          NONEWBASENAME NONLS NSYMBOL"DBCS" NOODOOSVS NOODOSLIDE
*          NOOLDBLANKLINE NOOLDCOPY NOOLDINDEX NOOLDNEXTSENTENCE NOOLDREADINTO
*          NOOLDSTRMIX OOCTRL"-C-E-G-P+Q+R-S+W" OPTIONAL-FILE NOOS390 OSEXT""
*          NOOSVS NOOUTDD NOP64 NOPANVALET PERFORM-TYPE"OSVS" NOPREPLIST
*          NOPREPROCESS NOPRINT-EXT NOPROFILE NOPROGID-COMMENT
*          NOPROGID-INT-NAME NOPROTECT-LINKAGE PROTOTYPE"RELAXED" QUAL
*          QUALPROC NOQUERY NOQUOTE NORAWLIST NORDW RECMODE"F" NOREENTRANT
*          NOREF NOREFNO REMAINDER"1" REPORT-LINE"256" RESEQ NORETRYLOCK
*          REWRITE-LS NORM RTNCODE-SIZE"4" NORWHARDPAGE NOSAA SEG NOSEQCHK
*          SEQUENTIAL"RECORD" NOSERIAL SETTING"LINE" NOSHAREOUTDD NOSHOW-DIR
*          SIGN"ASCII" NOSIGNDISCARD NOSIGNFIXUP SORTTYPE"DFSORT" SOURCEFORMAT
*          "FIXED" SOURCETABSTOP"8" NOSPZERO NOSSRANGE STDERR STICKY-LINKAGE
*          "2" NOSTICKY-PERFORM SUPFF SWITCHTYPE"1" SYMBSTART"1" SYSPUNCH"132"
*          TERMPAGE TIME NOTRACE NOTRUNC NOTRUNCCALLNAME NOTRUNCCOPY TRUNCINC
*          "10" UNICODE"NATIVE" VERBOSE VSC2"4" WARNING"1" NOWB NOWB2 NOWB3
*          WEBSERVER"CGI" NOWRITELOCK NOWRITETHRU NOXOPEN NOXREF
*          NOZEROLENGTHFALSE NOZEROSEQ NOZWB
     1 IDENTIFICATION DIVISION.
     2
     3 PROGRAM-ID.                 EL690 .
     4*              PROGRAM CONVERTED BY
     5*              COBOL CONVERSION AID PO 5785-ABJ
     6*              CONVERSION DATE 02/12/96 10:00:53.
     7*                            VMOD=2.005
     8*
     9*
    10*AUTHOR.        LOGIC,INC.
    11*               DALLAS, TEXAS.
    12
    13*DATE-COMPILED.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   2
* EL690.cbl
    14
    15*SECURITY.   *****************************************************
    16*            *                                                   *
    17*            *   THIS PROGRAM IS THE PROPERTY OF LOGIC, INC.     *
    18*            *                                                   *
    19*            *   USE OF THIS PROGRAM BY OTHER THAN THE EMPLOYEES *
    20*            *   OF LOGIC, INC. IS EXPRESSLY PROHIBITED WITHOUT  *
    21*            *   THE PRIOR WRITTEN PERMISSION OF LOGIC INC.      *
    22*            *                                                   *
    23*            *****************************************************
    24*
    25*REMARKS.
    26*       TRANSACTION - EXM3 - CREDIT SYSTEM CORRESPONDENCE REVIEW
    27*
    28******************************************************************
    29*    0012447420    C H A N G E   L O G
    30*
    31* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
    32*-----------------------------------------------------------------
    33*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
    34* EFFECTIVE    NUMBER
    35*-----------------------------------------------------------------
    36* 101101    2001100100006  SMVA  ADD USERID & COMPANY ID(CMPNYID)
    37*                              ADJUSTED REDEFINES EL690AI FILLER
    38* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
    39* 070711    2011022800001  AJRA  NAPERSOFT CHANGES
    40* 012312    2011022800001  AJRA  NAPERSOFT CHANGES
    41* 101512    2011022800001  AJRA  FIX LIST FOR SAME CERT DIFF EFF D
    42* 121112    2012101700002  AJRA  ADD PF6 TO CERT NOTES
    43* 102020 IR2020101300001   PEMA  Correct billing notes
    44******************************************************************
    45
    46 ENVIRONMENT DIVISION.
    47 DATA DIVISION.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   3
* EL690.cbl
    49 WORKING-STORAGE SECTION.
    50 01  DFH-START PIC X(04).
    51 77  FILLER   PIC  X(32) VALUE '*******************************'.
    52 77  FILLER   PIC  X(32) VALUE '*    EL690 WORKING STORAGE    *'.
    53 77  FILLER   PIC  X(32) VALUE '********* VMOD=2.005 **********'.
    54
    55 01  W-PROGRAM-CONSTANTS.
    56     12  FILLER                  PIC  X(18)
    57                                 VALUE 'PROGRAM CONSTANTS:'.
    58     12  W-APPL-SCRTY-NDX        PIC S9(04)  VALUE +3    COMP.
    59
    60     12  W-ARCH-FILE-ID          PIC  X(08)  VALUE 'ERARCH'.
    61     12  W-ARCH2-FILE-ID         PIC  X(08)  VALUE 'ERARCH2'.
    62     12  W-ARCH3-FILE-ID         PIC  X(08)  VALUE 'ERARCH3'.
    63     12  W-ARCH4-FILE-ID         PIC  X(08)  VALUE 'ERARCH4'.
    64     12  W-ARCH5-FILE-ID         PIC  X(08)  VALUE 'ERARCH5'.
    65     12  W-ARCH6-FILE-ID         PIC  X(08)  VALUE 'ERARCH6'.
    66     12  W-ARCT-FILE-ID          PIC  X(08)  VALUE 'ERARCT'.
    67     12  W-CNTL-FILE-ID          PIC  X(08)  VALUE 'ELCNTL'.
    68     12  W-LINK-001              PIC  X(08)  VALUE 'EL001'.
    69     12  W-LINK-004              PIC  X(08)  VALUE 'EL004'.
    70     12  W-MAP                   PIC  X(08)  VALUE 'EL690A'.
    71     12  W-MAP-REDEFINE  REDEFINES   W-MAP.
    72         16  FILLER              PIC  X(02).
    73         16  W-MAP-NUM           PIC  X(06).
    74     12  W-MAPSET                PIC  X(08)  VALUE 'EL690S'.
    75     12  W-THIS-PGM              PIC  X(08)  VALUE 'EL690'.
    76     12  W-TRANSACTION           PIC  X(04)  VALUE 'EXM3'.
    77     12  W-XCTL-005              PIC  X(08)  VALUE 'EL005'.
    78     12  W-XCTL-010              PIC  X(08)  VALUE 'EL010'.
    79     12  W-XCTL-153              PIC  X(08)  VALUE 'EL690'.
    80     12  W-XCTL-626              PIC  X(08)  VALUE 'EL626'.
    81     12  W-XCTL-689              PIC  X(08)  VALUE 'EL689'.
    82     12  W-XCTL-691              PIC  X(08)  VALUE 'EL691'.
    83     12  W-XCTL-1279             PIC  X(08)  VALUE 'EL1279'.
    84
    85 01  W-WORK-AREAS.
    86     12  FILLER                  PIC  X(11)
    87                                      VALUE 'WORK AREAS:'.
    88
    89     12  W-ARCH-NDX              PIC S9(04)  COMP.
    90     12  W-ARCH-NDX2             PIC S9(04)  COMP.
    91     12  W-ARCH-NDX3             PIC S9(04)  COMP.
    92     12  W-ARCH-NUMBER           PIC S9(08)  COMP.
    93     12  W-HOLD-ARCHIVE          PIC S9(08)  COMP.
    94     12  W-KEY-NDX               PIC S9(04)  COMP.
    95     12  W-LAST-ERROR            PIC  9(04)  VALUE 9999.
    96
    97     12  W-CALL-PGM              PIC  X(08)  VALUE SPACES.
    98
    99     12  W-DEEDIT-FIELD          PIC  X(15).
   100     12  W-DEEDIT-FIELD-V0 REDEFINES W-DEEDIT-FIELD
   101                                 PIC S9(15).
   102
   103     12  W-HOLD-LINE             PIC X(100).
   104     12  W-RETURNED-FROM         PIC  X(08)  VALUE SPACES.
   105     12  W-RESEND-DATE-1         PIC  X(02)  VALUE SPACES.
   106     12  W-RESEND-DATE-2         PIC  X(02)  VALUE SPACES.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   4
* EL690.cbl
   107     12  W-RESEND-DATE-3         PIC  X(02)  VALUE SPACES.
   108     12  W-REPLY-DATE            PIC  X(02)  VALUE SPACES.
   109     12  W-SAVE-BIN-DATE         PIC  X(02)  VALUE SPACES.
   110     12  W-SAVE-DATE             PIC  X(08)  VALUE SPACES.
   111     12  W-STATUS                PIC  X(01)  VALUE SPACES.
   112
   113     12  W-TIME-IN               PIC S9(07).
   114     12  FILLER REDEFINES W-TIME-IN.
   115         16  FILLER              PIC  X(01).
   116         16  W-TIME-OUT          PIC  9(02)V9(02).
   117         16  FILLER              PIC  X(02).
   118
   119 01  W-KEY-FIELDS.
   120     12  FILLER                  PIC  X(11)
   121                                      VALUE 'KEY FIELDS:'.
   122     12  W-CNTL-KEY.
   123         16  W-CNTL-COMPANY-ID   PIC  X(03).
   124         16  W-CNTL-RECORD-TYPE  PIC  X(01).
   125         16  FILLER              PIC  X(04).
   126         16  W-CNTL-SEQ          PIC S9(04) COMP.
   127     12  W-QUID-KEY.
   128         16  W-QUID-TERMINAL     PIC  X(04).
   129         16  W-QUID-MAP-NUM      PIC  X(04).
   130*
   131*    12  W-SC-QUID-KEY.
   132*        16  W-SC-QUID-TERMINAL  PIC  X(04).
   133*        16  W-SC-QUID-SYSTEM    PIC  X(04).
   134
   135     12  W-ARCH-KEY.
   136         16  W-ARCH-COMPANY-CD   PIC  X(01).
   137         16  W-ARCH-ARCHIVE-NO   PIC S9(08) COMP.
   138
   139     12  W-ARCH2-KEY.
   140         16  W-ARCH2-COMPANY-CD  PIC  X(01).
   141         16  W-ARCH2-CSCSAE-KEYLET.
   142             20  W-ARCH2-CERT-PRIME
   143                                 PIC  X(10).
   144             20  W-ARCH2-SUFFIX  PIC  X(01).
   145             20  W-ARCH2-CARRIER PIC  X(01).
   146             20  W-ARCH2-GROUPING
   147                                 PIC  X(06).
   148             20  W-ARCH2-STATE   PIC  X(02).
   149             20  W-ARCH2-ACCOUNT PIC  X(10).
   150             20  W-ARCH2-EFF-DTE PIC  X(02).
   151         16  W-ARCH2-ARCHIVE-NO  PIC S9(08) COMP.
   152
   153     12  W-ARCH3-KEY.
   154         16  W-ARCH3-COMPANY-CD  PIC  X(01).
   155         16  W-ARCH3-FCGSA-KEYLET.
   156             20  W-ARCH3-FORM    PIC  X(04).
   157             20  W-ARCH3-CARRIER PIC  X(01).
   158             20  W-ARCH3-GROUPING
   159                                 PIC  X(06).
   160             20  W-ARCH3-STATE   PIC  X(02).
   161             20  W-ARCH3-ACCOUNT PIC  X(10).
   162         16  W-ARCH3-ARCHIVE-NO  PIC S9(08) COMP.
   163
   164     12  W-ARCH4-KEY.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   5
* EL690.cbl
   165         16  W-ARCH4-COMPANY-CD  PIC  X(01).
   166         16  W-ARCH4-PCGSA-KEYLET.
   167             20  W-ARCH4-PROCESSOR
   168                                 PIC  X(04).
   169             20  W-ARCH4-CARRIER PIC  X(01).
   170             20  W-ARCH4-GROUPING
   171                                 PIC  X(06).
   172             20  W-ARCH4-STATE   PIC  X(02).
   173             20  W-ARCH4-ACCOUNT PIC  X(10).
   174         16  W-ARCH4-ARCHIVE-NO  PIC S9(08) COMP.
   175
   176     12  W-ARCH5-KEY.
   177         16  W-ARCH5-COMPANY-CD  PIC  X(01).
   178         16  W-ARCH5-CGSA-KEYLET.
   179             20  W-ARCH5-CARRIER PIC  X(01).
   180             20  W-ARCH5-GROUPING
   181                                 PIC  X(06).
   182             20  W-ARCH5-STATE   PIC  X(02).
   183             20  W-ARCH5-ACCOUNT PIC  X(10).
   184         16  W-ARCH5-ARCHIVE-NO  PIC S9(08) COMP.
   185
   186     12  W-ARCH6-KEY.
   187         16  W-ARCH6-COMPANY-CD  PIC  X(01).
   188         16  W-ARCH6-ENTRY.
   189             20  W-ARCH6-FILLER  PIC  X(02).
   190             20  W-ARCH6-QUE-CONTROL
   191                                 PIC S9(08) COMP.
   192         16  W-ARCH6-ARCHIVE-NO  PIC S9(08) COMP.
   193
   194     12  W-ARCT-KEY.
   195         16  W-ARCT-COMPANY-CD   PIC  X(01).
   196         16  W-ARCT-ARCHIVE-NO   PIC S9(08) COMP.
   197         16  W-ARCT-RECORD-TYPE  PIC  X(01).
   198             88  W-ARCT-ADDRESS-DATA   VALUE '1'.
   199             88  W-ARCT-TEXT-DATA      VALUE '2'.
   200         16  W-ARCT-LINE-SEQ-NO  PIC S9(04) COMP.
   201
   202     12  FILLER                      PIC  X(28).
   203     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
   204
   205     12  LT-TEXT-RECORD.
   206         16  LT-LETTER-TEXT OCCURS 20 TIMES
   207                            INDEXED BY LT-NDX.
   208             20  LT-TEXT-LINE        PIC  X(70).
   209             20  LT-SKIP-CONTROL     PIC  X(02).
   210                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
   211                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
   212             20  FILLER              PIC  X(08).
   213
   214
   215 01  W-PROGRAM-SWITCHES.
   216     12  FILLER                  PIC  X(09)
   217                                      VALUE 'SWITCHES:'.
   218     12  W-CHANGE-REQUESTED-IND  PIC  X(01)  VALUE SPACES.
   219         88  W-CHANGE-REQUESTED       VALUE 'Y'.
   220         88  W-NO-CHANGES-MADE        VALUE SPACES.
   221     12  W-FIRST-CHANGE-IND      PIC  9(02)  VALUE ZEROS.
   222         88  W-FIRST-CHANGE-FOUND     VALUES 01 THRU 12.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   6
* EL690.cbl
   223         88  W-NO-FIRST-CHANGE        VALUE ZEROS.
   224     12  W-READ-PREV-TWICE-IND   PIC  X(01)  VALUE SPACES.
   225         88  W-READ-PREV-TWICE        VALUE 'Y'.
   226     12  W-VALID-STATUS-SW       PIC  X(01).
   227         88  W-ALLOWED-ENTRIES        VALUE 'A' 'H' '+' '#' '@'
   228                                            'X' 'V'.
   229         88  W-VALID-STATUS           VALUE 'A' 'H'
   230                                            'P' 'X' 'V' 'C'.
   231         88  W-ACTIVE                 VALUE 'A'.
   232         88  W-COMPLETED              VALUE 'C'.
   233         88  W-VOIDED                 VALUE 'V'.
   234         88  W-TO-BE-PURGED-STATUS    VALUE 'X'.
   235         88  W-PURGED-STATUS          VALUE 'P'.
   236         88  W-SPECIAL-STATUS         VALUE '+'.
   237         88  W-CLEAR-INITIAL          VALUE '#'.
   238         88  W-CHECK-STATUS           VALUE '@'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   7
* EL690.cbl
   240 01  FILLER                      PIC  X(14)
   241                                      VALUE 'PGRM MAP AREA:'.
   242*    COPY EL690S.
   243 01  EL690AI.
   244     05  FILLER            PIC  X(0012).
   245*    -------------------------------
   246     05  RUNDTEL PIC S9(0004) COMP.
   247     05  RUNDTEF PIC  X(0001).
   248     05  FILLER REDEFINES RUNDTEF.
   249         10  RUNDTEA PIC  X(0001).
   250     05  RUNDTEI PIC  X(0008).
   251*    -------------------------------
   252     05  RUNTIMEL PIC S9(0004) COMP.
   253     05  RUNTIMEF PIC  X(0001).
   254     05  FILLER REDEFINES RUNTIMEF.
   255         10  RUNTIMEA PIC  X(0001).
   256     05  RUNTIMEI PIC  X(0005).
   257*    -------------------------------
   258     05  COMPANYL PIC S9(0004) COMP.
   259     05  COMPANYF PIC  X(0001).
   260     05  FILLER REDEFINES COMPANYF.
   261         10  COMPANYA PIC  X(0001).
   262     05  COMPANYI PIC  X(0003).
   263*    -------------------------------
   264     05  USERIDL PIC S9(0004) COMP.
   265     05  USERIDF PIC  X(0001).
   266     05  FILLER REDEFINES USERIDF.
   267         10  USERIDA PIC  X(0001).
   268     05  USERIDI PIC  X(0004).
   269*    -------------------------------
   270     05  MAINTL PIC S9(0004) COMP.
   271     05  MAINTF PIC  X(0001).
   272     05  FILLER REDEFINES MAINTF.
   273         10  MAINTA PIC  X(0001).
   274     05  MAINTI PIC  X(0001).
   275*    -------------------------------
   276     05  TYPEBRL PIC S9(0004) COMP.
   277     05  TYPEBRF PIC  X(0001).
   278     05  FILLER REDEFINES TYPEBRF.
   279         10  TYPEBRA PIC  X(0001).
   280     05  TYPEBRI PIC  X(0001).
   281*    -------------------------------
   282     05  CERTRPL PIC S9(0004) COMP.
   283     05  CERTRPF PIC  X(0001).
   284     05  FILLER REDEFINES CERTRPF.
   285         10  CERTRPA PIC  X(0001).
   286     05  CERTRPI PIC  X(0010).
   287*    -------------------------------
   288     05  SUFFIXL PIC S9(0004) COMP.
   289     05  SUFFIXF PIC  X(0001).
   290     05  FILLER REDEFINES SUFFIXF.
   291         10  SUFFIXA PIC  X(0001).
   292     05  SUFFIXI PIC  X(0001).
   293*    -------------------------------
   294     05  FORML PIC S9(0004) COMP.
   295     05  FORMF PIC  X(0001).
   296     05  FILLER REDEFINES FORMF.
   297         10  FORMA PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   8
* EL690.cbl
   298     05  FORMI PIC  X(0004).
   299*    -------------------------------
   300     05  ENTRYL PIC S9(0004) COMP.
   301     05  ENTRYF PIC  X(0001).
   302     05  FILLER REDEFINES ENTRYF.
   303         10  ENTRYA PIC  X(0001).
   304     05  ENTRYI PIC  X(0006).
   305*    -------------------------------
   306     05  CKCNTLL PIC S9(0004) COMP.
   307     05  CKCNTLF PIC  X(0001).
   308     05  FILLER REDEFINES CKCNTLF.
   309         10  CKCNTLA PIC  X(0001).
   310     05  CKCNTLI PIC  9(8).
   311*    -------------------------------
   312     05  CARRIERL PIC S9(0004) COMP.
   313     05  CARRIERF PIC  X(0001).
   314     05  FILLER REDEFINES CARRIERF.
   315         10  CARRIERA PIC  X(0001).
   316     05  CARRIERI PIC  X(0001).
   317*    -------------------------------
   318     05  GROUPL PIC S9(0004) COMP.
   319     05  GROUPF PIC  X(0001).
   320     05  FILLER REDEFINES GROUPF.
   321         10  GROUPA PIC  X(0001).
   322     05  GROUPI PIC  X(0006).
   323*    -------------------------------
   324     05  STATEL PIC S9(0004) COMP.
   325     05  STATEF PIC  X(0001).
   326     05  FILLER REDEFINES STATEF.
   327         10  STATEA PIC  X(0001).
   328     05  STATEI PIC  X(0002).
   329*    -------------------------------
   330     05  ACCTL PIC S9(0004) COMP.
   331     05  ACCTF PIC  X(0001).
   332     05  FILLER REDEFINES ACCTF.
   333         10  ACCTA PIC  X(0001).
   334     05  ACCTI PIC  X(0010).
   335*    -------------------------------
   336     05  EFFDTEL PIC S9(0004) COMP.
   337     05  EFFDTEF PIC  X(0001).
   338     05  FILLER REDEFINES EFFDTEF.
   339         10  EFFDTEA PIC  X(0001).
   340     05  EFFDTEI PIC  X(0008).
   341*    -------------------------------
   342     05  PROCSRL PIC S9(0004) COMP.
   343     05  PROCSRF PIC  X(0001).
   344     05  FILLER REDEFINES PROCSRF.
   345         10  PROCSRA PIC  X(0001).
   346     05  PROCSRI PIC  X(0004).
   347*    -------------------------------
   348     05  CORRSELL PIC S9(0004) COMP.
   349     05  CORRSELF PIC  X(0001).
   350     05  FILLER REDEFINES CORRSELF.
   351         10  CORRSELA PIC  X(0001).
   352     05  CORRSELI PIC  X(0002).
   353*    -------------------------------
   354     05  STATSELL PIC S9(0004) COMP.
   355     05  STATSELF PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page   9
* EL690.cbl
   356     05  FILLER REDEFINES STATSELF.
   357         10  STATSELA PIC  X(0001).
   358     05  STATSELI PIC  X(0001).
   359*    -------------------------------
   360     05  ARCNO1L PIC S9(0004) COMP.
   361     05  ARCNO1F PIC  X(0001).
   362     05  FILLER REDEFINES ARCNO1F.
   363         10  ARCNO1A PIC  X(0001).
   364     05  ARCNO1I PIC  X(0008).
   365*    -------------------------------
   366     05  FORM1L PIC S9(0004) COMP.
   367     05  FORM1F PIC  X(0001).
   368     05  FILLER REDEFINES FORM1F.
   369         10  FORM1A PIC  X(0001).
   370     05  FORM1I PIC  X(0004).
   371*    -------------------------------
   372     05  USRID1L PIC S9(0004) COMP.
   373     05  USRID1F PIC  X(0001).
   374     05  FILLER REDEFINES USRID1F.
   375         10  USRID1A PIC  X(0001).
   376     05  USRID1I PIC  X(0004).
   377*    -------------------------------
   378     05  PRINT1L PIC S9(0004) COMP.
   379     05  PRINT1F PIC  X(0001).
   380     05  FILLER REDEFINES PRINT1F.
   381         10  PRINT1A PIC  X(0001).
   382     05  PRINT1I PIC  X(0008).
   383*    -------------------------------
   384     05  STATS1L PIC S9(0004) COMP.
   385     05  STATS1F PIC  X(0001).
   386     05  FILLER REDEFINES STATS1F.
   387         10  STATS1A PIC  X(0001).
   388     05  STATS1I PIC  X(0008).
   389*    -------------------------------
   390     05  RSFRM1L PIC S9(0004) COMP.
   391     05  RSFRM1F PIC  X(0001).
   392     05  FILLER REDEFINES RSFRM1F.
   393         10  RSFRM1A PIC  X(0001).
   394     05  RSFRM1I PIC  X(0004).
   395*    -------------------------------
   396     05  RSDAT1L PIC S9(0004) COMP.
   397     05  RSDAT1F PIC  X(0001).
   398     05  FILLER REDEFINES RSDAT1F.
   399         10  RSDAT1A PIC  X(0001).
   400     05  RSDAT1I PIC  X(0008).
   401*    -------------------------------
   402     05  ARCNO2L PIC S9(0004) COMP.
   403     05  ARCNO2F PIC  X(0001).
   404     05  FILLER REDEFINES ARCNO2F.
   405         10  ARCNO2A PIC  X(0001).
   406     05  ARCNO2I PIC  X(0008).
   407*    -------------------------------
   408     05  FORM2L PIC S9(0004) COMP.
   409     05  FORM2F PIC  X(0001).
   410     05  FILLER REDEFINES FORM2F.
   411         10  FORM2A PIC  X(0001).
   412     05  FORM2I PIC  X(0004).
   413*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  10
* EL690.cbl
   414     05  USRID2L PIC S9(0004) COMP.
   415     05  USRID2F PIC  X(0001).
   416     05  FILLER REDEFINES USRID2F.
   417         10  USRID2A PIC  X(0001).
   418     05  USRID2I PIC  X(0004).
   419*    -------------------------------
   420     05  PRINT2L PIC S9(0004) COMP.
   421     05  PRINT2F PIC  X(0001).
   422     05  FILLER REDEFINES PRINT2F.
   423         10  PRINT2A PIC  X(0001).
   424     05  PRINT2I PIC  X(0008).
   425*    -------------------------------
   426     05  STATS2L PIC S9(0004) COMP.
   427     05  STATS2F PIC  X(0001).
   428     05  FILLER REDEFINES STATS2F.
   429         10  STATS2A PIC  X(0001).
   430     05  STATS2I PIC  X(0008).
   431*    -------------------------------
   432     05  RSFRM2L PIC S9(0004) COMP.
   433     05  RSFRM2F PIC  X(0001).
   434     05  FILLER REDEFINES RSFRM2F.
   435         10  RSFRM2A PIC  X(0001).
   436     05  RSFRM2I PIC  X(0004).
   437*    -------------------------------
   438     05  RSDAT2L PIC S9(0004) COMP.
   439     05  RSDAT2F PIC  X(0001).
   440     05  FILLER REDEFINES RSDAT2F.
   441         10  RSDAT2A PIC  X(0001).
   442     05  RSDAT2I PIC  X(0008).
   443*    -------------------------------
   444     05  ARCNO3L PIC S9(0004) COMP.
   445     05  ARCNO3F PIC  X(0001).
   446     05  FILLER REDEFINES ARCNO3F.
   447         10  ARCNO3A PIC  X(0001).
   448     05  ARCNO3I PIC  X(0008).
   449*    -------------------------------
   450     05  FORM3L PIC S9(0004) COMP.
   451     05  FORM3F PIC  X(0001).
   452     05  FILLER REDEFINES FORM3F.
   453         10  FORM3A PIC  X(0001).
   454     05  FORM3I PIC  X(0004).
   455*    -------------------------------
   456     05  USRID3L PIC S9(0004) COMP.
   457     05  USRID3F PIC  X(0001).
   458     05  FILLER REDEFINES USRID3F.
   459         10  USRID3A PIC  X(0001).
   460     05  USRID3I PIC  X(0004).
   461*    -------------------------------
   462     05  PRINT3L PIC S9(0004) COMP.
   463     05  PRINT3F PIC  X(0001).
   464     05  FILLER REDEFINES PRINT3F.
   465         10  PRINT3A PIC  X(0001).
   466     05  PRINT3I PIC  X(0008).
   467*    -------------------------------
   468     05  STATS3L PIC S9(0004) COMP.
   469     05  STATS3F PIC  X(0001).
   470     05  FILLER REDEFINES STATS3F.
   471         10  STATS3A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  11
* EL690.cbl
   472     05  STATS3I PIC  X(0008).
   473*    -------------------------------
   474     05  RSFRM3L PIC S9(0004) COMP.
   475     05  RSFRM3F PIC  X(0001).
   476     05  FILLER REDEFINES RSFRM3F.
   477         10  RSFRM3A PIC  X(0001).
   478     05  RSFRM3I PIC  X(0004).
   479*    -------------------------------
   480     05  RSDAT3L PIC S9(0004) COMP.
   481     05  RSDAT3F PIC  X(0001).
   482     05  FILLER REDEFINES RSDAT3F.
   483         10  RSDAT3A PIC  X(0001).
   484     05  RSDAT3I PIC  X(0008).
   485*    -------------------------------
   486     05  ARCNO4L PIC S9(0004) COMP.
   487     05  ARCNO4F PIC  X(0001).
   488     05  FILLER REDEFINES ARCNO4F.
   489         10  ARCNO4A PIC  X(0001).
   490     05  ARCNO4I PIC  X(0008).
   491*    -------------------------------
   492     05  FORM4L PIC S9(0004) COMP.
   493     05  FORM4F PIC  X(0001).
   494     05  FILLER REDEFINES FORM4F.
   495         10  FORM4A PIC  X(0001).
   496     05  FORM4I PIC  X(0004).
   497*    -------------------------------
   498     05  USRID4L PIC S9(0004) COMP.
   499     05  USRID4F PIC  X(0001).
   500     05  FILLER REDEFINES USRID4F.
   501         10  USRID4A PIC  X(0001).
   502     05  USRID4I PIC  X(0004).
   503*    -------------------------------
   504     05  PRINT4L PIC S9(0004) COMP.
   505     05  PRINT4F PIC  X(0001).
   506     05  FILLER REDEFINES PRINT4F.
   507         10  PRINT4A PIC  X(0001).
   508     05  PRINT4I PIC  X(0008).
   509*    -------------------------------
   510     05  STATS4L PIC S9(0004) COMP.
   511     05  STATS4F PIC  X(0001).
   512     05  FILLER REDEFINES STATS4F.
   513         10  STATS4A PIC  X(0001).
   514     05  STATS4I PIC  X(0008).
   515*    -------------------------------
   516     05  RSFRM4L PIC S9(0004) COMP.
   517     05  RSFRM4F PIC  X(0001).
   518     05  FILLER REDEFINES RSFRM4F.
   519         10  RSFRM4A PIC  X(0001).
   520     05  RSFRM4I PIC  X(0004).
   521*    -------------------------------
   522     05  RSDAT4L PIC S9(0004) COMP.
   523     05  RSDAT4F PIC  X(0001).
   524     05  FILLER REDEFINES RSDAT4F.
   525         10  RSDAT4A PIC  X(0001).
   526     05  RSDAT4I PIC  X(0008).
   527*    -------------------------------
   528     05  ARCNO5L PIC S9(0004) COMP.
   529     05  ARCNO5F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  12
* EL690.cbl
   530     05  FILLER REDEFINES ARCNO5F.
   531         10  ARCNO5A PIC  X(0001).
   532     05  ARCNO5I PIC  X(0008).
   533*    -------------------------------
   534     05  FORM5L PIC S9(0004) COMP.
   535     05  FORM5F PIC  X(0001).
   536     05  FILLER REDEFINES FORM5F.
   537         10  FORM5A PIC  X(0001).
   538     05  FORM5I PIC  X(0004).
   539*    -------------------------------
   540     05  USRID5L PIC S9(0004) COMP.
   541     05  USRID5F PIC  X(0001).
   542     05  FILLER REDEFINES USRID5F.
   543         10  USRID5A PIC  X(0001).
   544     05  USRID5I PIC  X(0004).
   545*    -------------------------------
   546     05  PRINT5L PIC S9(0004) COMP.
   547     05  PRINT5F PIC  X(0001).
   548     05  FILLER REDEFINES PRINT5F.
   549         10  PRINT5A PIC  X(0001).
   550     05  PRINT5I PIC  X(0008).
   551*    -------------------------------
   552     05  STATS5L PIC S9(0004) COMP.
   553     05  STATS5F PIC  X(0001).
   554     05  FILLER REDEFINES STATS5F.
   555         10  STATS5A PIC  X(0001).
   556     05  STATS5I PIC  X(0008).
   557*    -------------------------------
   558     05  RSFRM5L PIC S9(0004) COMP.
   559     05  RSFRM5F PIC  X(0001).
   560     05  FILLER REDEFINES RSFRM5F.
   561         10  RSFRM5A PIC  X(0001).
   562     05  RSFRM5I PIC  X(0004).
   563*    -------------------------------
   564     05  RSDAT5L PIC S9(0004) COMP.
   565     05  RSDAT5F PIC  X(0001).
   566     05  FILLER REDEFINES RSDAT5F.
   567         10  RSDAT5A PIC  X(0001).
   568     05  RSDAT5I PIC  X(0008).
   569*    -------------------------------
   570     05  ARCNO6L PIC S9(0004) COMP.
   571     05  ARCNO6F PIC  X(0001).
   572     05  FILLER REDEFINES ARCNO6F.
   573         10  ARCNO6A PIC  X(0001).
   574     05  ARCNO6I PIC  X(0008).
   575*    -------------------------------
   576     05  FORM6L PIC S9(0004) COMP.
   577     05  FORM6F PIC  X(0001).
   578     05  FILLER REDEFINES FORM6F.
   579         10  FORM6A PIC  X(0001).
   580     05  FORM6I PIC  X(0004).
   581*    -------------------------------
   582     05  USRID6L PIC S9(0004) COMP.
   583     05  USRID6F PIC  X(0001).
   584     05  FILLER REDEFINES USRID6F.
   585         10  USRID6A PIC  X(0001).
   586     05  USRID6I PIC  X(0004).
   587*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  13
* EL690.cbl
   588     05  PRINT6L PIC S9(0004) COMP.
   589     05  PRINT6F PIC  X(0001).
   590     05  FILLER REDEFINES PRINT6F.
   591         10  PRINT6A PIC  X(0001).
   592     05  PRINT6I PIC  X(0008).
   593*    -------------------------------
   594     05  STATS6L PIC S9(0004) COMP.
   595     05  STATS6F PIC  X(0001).
   596     05  FILLER REDEFINES STATS6F.
   597         10  STATS6A PIC  X(0001).
   598     05  STATS6I PIC  X(0008).
   599*    -------------------------------
   600     05  RSFRM6L PIC S9(0004) COMP.
   601     05  RSFRM6F PIC  X(0001).
   602     05  FILLER REDEFINES RSFRM6F.
   603         10  RSFRM6A PIC  X(0001).
   604     05  RSFRM6I PIC  X(0004).
   605*    -------------------------------
   606     05  RSDAT6L PIC S9(0004) COMP.
   607     05  RSDAT6F PIC  X(0001).
   608     05  FILLER REDEFINES RSDAT6F.
   609         10  RSDAT6A PIC  X(0001).
   610     05  RSDAT6I PIC  X(0008).
   611*    -------------------------------
   612     05  ARCNO7L PIC S9(0004) COMP.
   613     05  ARCNO7F PIC  X(0001).
   614     05  FILLER REDEFINES ARCNO7F.
   615         10  ARCNO7A PIC  X(0001).
   616     05  ARCNO7I PIC  X(0008).
   617*    -------------------------------
   618     05  FORM7L PIC S9(0004) COMP.
   619     05  FORM7F PIC  X(0001).
   620     05  FILLER REDEFINES FORM7F.
   621         10  FORM7A PIC  X(0001).
   622     05  FORM7I PIC  X(0004).
   623*    -------------------------------
   624     05  USRID7L PIC S9(0004) COMP.
   625     05  USRID7F PIC  X(0001).
   626     05  FILLER REDEFINES USRID7F.
   627         10  USRID7A PIC  X(0001).
   628     05  USRID7I PIC  X(0004).
   629*    -------------------------------
   630     05  PRINT7L PIC S9(0004) COMP.
   631     05  PRINT7F PIC  X(0001).
   632     05  FILLER REDEFINES PRINT7F.
   633         10  PRINT7A PIC  X(0001).
   634     05  PRINT7I PIC  X(0008).
   635*    -------------------------------
   636     05  STATS7L PIC S9(0004) COMP.
   637     05  STATS7F PIC  X(0001).
   638     05  FILLER REDEFINES STATS7F.
   639         10  STATS7A PIC  X(0001).
   640     05  STATS7I PIC  X(0008).
   641*    -------------------------------
   642     05  RSFRM7L PIC S9(0004) COMP.
   643     05  RSFRM7F PIC  X(0001).
   644     05  FILLER REDEFINES RSFRM7F.
   645         10  RSFRM7A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  14
* EL690.cbl
   646     05  RSFRM7I PIC  X(0004).
   647*    -------------------------------
   648     05  RSDAT7L PIC S9(0004) COMP.
   649     05  RSDAT7F PIC  X(0001).
   650     05  FILLER REDEFINES RSDAT7F.
   651         10  RSDAT7A PIC  X(0001).
   652     05  RSDAT7I PIC  X(0008).
   653*    -------------------------------
   654     05  ARCNO8L PIC S9(0004) COMP.
   655     05  ARCNO8F PIC  X(0001).
   656     05  FILLER REDEFINES ARCNO8F.
   657         10  ARCNO8A PIC  X(0001).
   658     05  ARCNO8I PIC  X(0008).
   659*    -------------------------------
   660     05  FORM8L PIC S9(0004) COMP.
   661     05  FORM8F PIC  X(0001).
   662     05  FILLER REDEFINES FORM8F.
   663         10  FORM8A PIC  X(0001).
   664     05  FORM8I PIC  X(0004).
   665*    -------------------------------
   666     05  USRID8L PIC S9(0004) COMP.
   667     05  USRID8F PIC  X(0001).
   668     05  FILLER REDEFINES USRID8F.
   669         10  USRID8A PIC  X(0001).
   670     05  USRID8I PIC  X(0004).
   671*    -------------------------------
   672     05  PRINT8L PIC S9(0004) COMP.
   673     05  PRINT8F PIC  X(0001).
   674     05  FILLER REDEFINES PRINT8F.
   675         10  PRINT8A PIC  X(0001).
   676     05  PRINT8I PIC  X(0008).
   677*    -------------------------------
   678     05  STATS8L PIC S9(0004) COMP.
   679     05  STATS8F PIC  X(0001).
   680     05  FILLER REDEFINES STATS8F.
   681         10  STATS8A PIC  X(0001).
   682     05  STATS8I PIC  X(0008).
   683*    -------------------------------
   684     05  RSFRM8L PIC S9(0004) COMP.
   685     05  RSFRM8F PIC  X(0001).
   686     05  FILLER REDEFINES RSFRM8F.
   687         10  RSFRM8A PIC  X(0001).
   688     05  RSFRM8I PIC  X(0004).
   689*    -------------------------------
   690     05  RSDAT8L PIC S9(0004) COMP.
   691     05  RSDAT8F PIC  X(0001).
   692     05  FILLER REDEFINES RSDAT8F.
   693         10  RSDAT8A PIC  X(0001).
   694     05  RSDAT8I PIC  X(0008).
   695*    -------------------------------
   696     05  ARCNO9L PIC S9(0004) COMP.
   697     05  ARCNO9F PIC  X(0001).
   698     05  FILLER REDEFINES ARCNO9F.
   699         10  ARCNO9A PIC  X(0001).
   700     05  ARCNO9I PIC  X(0008).
   701*    -------------------------------
   702     05  FORM9L PIC S9(0004) COMP.
   703     05  FORM9F PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  15
* EL690.cbl
   704     05  FILLER REDEFINES FORM9F.
   705         10  FORM9A PIC  X(0001).
   706     05  FORM9I PIC  X(0004).
   707*    -------------------------------
   708     05  USRID9L PIC S9(0004) COMP.
   709     05  USRID9F PIC  X(0001).
   710     05  FILLER REDEFINES USRID9F.
   711         10  USRID9A PIC  X(0001).
   712     05  USRID9I PIC  X(0004).
   713*    -------------------------------
   714     05  PRINT9L PIC S9(0004) COMP.
   715     05  PRINT9F PIC  X(0001).
   716     05  FILLER REDEFINES PRINT9F.
   717         10  PRINT9A PIC  X(0001).
   718     05  PRINT9I PIC  X(0008).
   719*    -------------------------------
   720     05  STATS9L PIC S9(0004) COMP.
   721     05  STATS9F PIC  X(0001).
   722     05  FILLER REDEFINES STATS9F.
   723         10  STATS9A PIC  X(0001).
   724     05  STATS9I PIC  X(0008).
   725*    -------------------------------
   726     05  RSFRM9L PIC S9(0004) COMP.
   727     05  RSFRM9F PIC  X(0001).
   728     05  FILLER REDEFINES RSFRM9F.
   729         10  RSFRM9A PIC  X(0001).
   730     05  RSFRM9I PIC  X(0004).
   731*    -------------------------------
   732     05  RSDAT9L PIC S9(0004) COMP.
   733     05  RSDAT9F PIC  X(0001).
   734     05  FILLER REDEFINES RSDAT9F.
   735         10  RSDAT9A PIC  X(0001).
   736     05  RSDAT9I PIC  X(0008).
   737*    -------------------------------
   738     05  ARCNO10L PIC S9(0004) COMP.
   739     05  ARCNO10F PIC  X(0001).
   740     05  FILLER REDEFINES ARCNO10F.
   741         10  ARCNO10A PIC  X(0001).
   742     05  ARCNO10I PIC  X(0008).
   743*    -------------------------------
   744     05  FORM10L PIC S9(0004) COMP.
   745     05  FORM10F PIC  X(0001).
   746     05  FILLER REDEFINES FORM10F.
   747         10  FORM10A PIC  X(0001).
   748     05  FORM10I PIC  X(0004).
   749*    -------------------------------
   750     05  USRID10L PIC S9(0004) COMP.
   751     05  USRID10F PIC  X(0001).
   752     05  FILLER REDEFINES USRID10F.
   753         10  USRID10A PIC  X(0001).
   754     05  USRID10I PIC  X(0004).
   755*    -------------------------------
   756     05  PRINT10L PIC S9(0004) COMP.
   757     05  PRINT10F PIC  X(0001).
   758     05  FILLER REDEFINES PRINT10F.
   759         10  PRINT10A PIC  X(0001).
   760     05  PRINT10I PIC  X(0008).
   761*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  16
* EL690.cbl
   762     05  STATS10L PIC S9(0004) COMP.
   763     05  STATS10F PIC  X(0001).
   764     05  FILLER REDEFINES STATS10F.
   765         10  STATS10A PIC  X(0001).
   766     05  STATS10I PIC  X(0008).
   767*    -------------------------------
   768     05  RSFRM10L PIC S9(0004) COMP.
   769     05  RSFRM10F PIC  X(0001).
   770     05  FILLER REDEFINES RSFRM10F.
   771         10  RSFRM10A PIC  X(0001).
   772     05  RSFRM10I PIC  X(0004).
   773*    -------------------------------
   774     05  RSDAT10L PIC S9(0004) COMP.
   775     05  RSDAT10F PIC  X(0001).
   776     05  FILLER REDEFINES RSDAT10F.
   777         10  RSDAT10A PIC  X(0001).
   778     05  RSDAT10I PIC  X(0008).
   779*    -------------------------------
   780     05  ARCNO11L PIC S9(0004) COMP.
   781     05  ARCNO11F PIC  X(0001).
   782     05  FILLER REDEFINES ARCNO11F.
   783         10  ARCNO11A PIC  X(0001).
   784     05  ARCNO11I PIC  X(0008).
   785*    -------------------------------
   786     05  FORM11L PIC S9(0004) COMP.
   787     05  FORM11F PIC  X(0001).
   788     05  FILLER REDEFINES FORM11F.
   789         10  FORM11A PIC  X(0001).
   790     05  FORM11I PIC  X(0004).
   791*    -------------------------------
   792     05  USRID11L PIC S9(0004) COMP.
   793     05  USRID11F PIC  X(0001).
   794     05  FILLER REDEFINES USRID11F.
   795         10  USRID11A PIC  X(0001).
   796     05  USRID11I PIC  X(0004).
   797*    -------------------------------
   798     05  PRINT11L PIC S9(0004) COMP.
   799     05  PRINT11F PIC  X(0001).
   800     05  FILLER REDEFINES PRINT11F.
   801         10  PRINT11A PIC  X(0001).
   802     05  PRINT11I PIC  X(0008).
   803*    -------------------------------
   804     05  STATS11L PIC S9(0004) COMP.
   805     05  STATS11F PIC  X(0001).
   806     05  FILLER REDEFINES STATS11F.
   807         10  STATS11A PIC  X(0001).
   808     05  STATS11I PIC  X(0008).
   809*    -------------------------------
   810     05  RSFRM11L PIC S9(0004) COMP.
   811     05  RSFRM11F PIC  X(0001).
   812     05  FILLER REDEFINES RSFRM11F.
   813         10  RSFRM11A PIC  X(0001).
   814     05  RSFRM11I PIC  X(0004).
   815*    -------------------------------
   816     05  RSDAT11L PIC S9(0004) COMP.
   817     05  RSDAT11F PIC  X(0001).
   818     05  FILLER REDEFINES RSDAT11F.
   819         10  RSDAT11A PIC  X(0001).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  17
* EL690.cbl
   820     05  RSDAT11I PIC  X(0008).
   821*    -------------------------------
   822     05  ARCNO12L PIC S9(0004) COMP.
   823     05  ARCNO12F PIC  X(0001).
   824     05  FILLER REDEFINES ARCNO12F.
   825         10  ARCNO12A PIC  X(0001).
   826     05  ARCNO12I PIC  X(0008).
   827*    -------------------------------
   828     05  FORM12L PIC S9(0004) COMP.
   829     05  FORM12F PIC  X(0001).
   830     05  FILLER REDEFINES FORM12F.
   831         10  FORM12A PIC  X(0001).
   832     05  FORM12I PIC  X(0004).
   833*    -------------------------------
   834     05  USRID12L PIC S9(0004) COMP.
   835     05  USRID12F PIC  X(0001).
   836     05  FILLER REDEFINES USRID12F.
   837         10  USRID12A PIC  X(0001).
   838     05  USRID12I PIC  X(0004).
   839*    -------------------------------
   840     05  PRINT12L PIC S9(0004) COMP.
   841     05  PRINT12F PIC  X(0001).
   842     05  FILLER REDEFINES PRINT12F.
   843         10  PRINT12A PIC  X(0001).
   844     05  PRINT12I PIC  X(0008).
   845*    -------------------------------
   846     05  STATS12L PIC S9(0004) COMP.
   847     05  STATS12F PIC  X(0001).
   848     05  FILLER REDEFINES STATS12F.
   849         10  STATS12A PIC  X(0001).
   850     05  STATS12I PIC  X(0008).
   851*    -------------------------------
   852     05  RSFRM12L PIC S9(0004) COMP.
   853     05  RSFRM12F PIC  X(0001).
   854     05  FILLER REDEFINES RSFRM12F.
   855         10  RSFRM12A PIC  X(0001).
   856     05  RSFRM12I PIC  X(0004).
   857*    -------------------------------
   858     05  RSDAT12L PIC S9(0004) COMP.
   859     05  RSDAT12F PIC  X(0001).
   860     05  FILLER REDEFINES RSDAT12F.
   861         10  RSDAT12A PIC  X(0001).
   862     05  RSDAT12I PIC  X(0008).
   863*    -------------------------------
   864     05  ERRMSG1L PIC S9(0004) COMP.
   865     05  ERRMSG1F PIC  X(0001).
   866     05  FILLER REDEFINES ERRMSG1F.
   867         10  ERRMSG1A PIC  X(0001).
   868     05  ERRMSG1I PIC  X(0079).
   869*    -------------------------------
   870     05  PFKEYL PIC S9(0004) COMP.
   871     05  PFKEYF PIC  X(0001).
   872     05  FILLER REDEFINES PFKEYF.
   873         10  PFKEYA PIC  X(0001).
   874     05  PFKEYI PIC  9(2).
   875 01  EL690AO REDEFINES EL690AI.
   876     05  FILLER            PIC  X(0012).
   877*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  18
* EL690.cbl
   878     05  FILLER            PIC  X(0003).
   879     05  RUNDTEO PIC  X(0008).
   880*    -------------------------------
   881     05  FILLER            PIC  X(0003).
   882     05  RUNTIMEO PIC  99.99.
   883*    -------------------------------
   884     05  FILLER            PIC  X(0003).
   885     05  COMPANYO PIC  X(0003).
   886*    -------------------------------
   887     05  FILLER            PIC  X(0003).
   888     05  USERIDO PIC  X(0004).
   889*    -------------------------------
   890     05  FILLER            PIC  X(0003).
   891     05  MAINTO PIC  X(0001).
   892*    -------------------------------
   893     05  FILLER            PIC  X(0003).
   894     05  TYPEBRO PIC  X(0001).
   895*    -------------------------------
   896     05  FILLER            PIC  X(0003).
   897     05  CERTRPO PIC  X(0010).
   898*    -------------------------------
   899     05  FILLER            PIC  X(0003).
   900     05  SUFFIXO PIC  X(0001).
   901*    -------------------------------
   902     05  FILLER            PIC  X(0003).
   903     05  FORMO PIC  X(0004).
   904*    -------------------------------
   905     05  FILLER            PIC  X(0003).
   906     05  ENTRYO PIC  X(0006).
   907*    -------------------------------
   908     05  FILLER            PIC  X(0003).
   909     05  CKCNTLO PIC  ZZZZZZZ9.
   910*    -------------------------------
   911     05  FILLER            PIC  X(0003).
   912     05  CARRIERO PIC  X(0001).
   913*    -------------------------------
   914     05  FILLER            PIC  X(0003).
   915     05  GROUPO PIC  X(0006).
   916*    -------------------------------
   917     05  FILLER            PIC  X(0003).
   918     05  STATEO PIC  X(0002).
   919*    -------------------------------
   920     05  FILLER            PIC  X(0003).
   921     05  ACCTO PIC  X(0010).
   922*    -------------------------------
   923     05  FILLER            PIC  X(0003).
   924     05  EFFDTEO PIC  X(0008).
   925*    -------------------------------
   926     05  FILLER            PIC  X(0003).
   927     05  PROCSRO PIC  X(0004).
   928*    -------------------------------
   929     05  FILLER            PIC  X(0003).
   930     05  CORRSELO PIC  ZZ.
   931*    -------------------------------
   932     05  FILLER            PIC  X(0003).
   933     05  STATSELO PIC  X(0001).
   934*    -------------------------------
   935     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  19
* EL690.cbl
   936     05  ARCNO1O PIC  X(0008).
   937*    -------------------------------
   938     05  FILLER            PIC  X(0003).
   939     05  FORM1O PIC  X(0004).
   940*    -------------------------------
   941     05  FILLER            PIC  X(0003).
   942     05  USRID1O PIC  X(0004).
   943*    -------------------------------
   944     05  FILLER            PIC  X(0003).
   945     05  PRINT1O PIC  X(0008).
   946*    -------------------------------
   947     05  FILLER            PIC  X(0003).
   948     05  STATS1O PIC  X(0008).
   949*    -------------------------------
   950     05  FILLER            PIC  X(0003).
   951     05  RSFRM1O PIC  X(0004).
   952*    -------------------------------
   953     05  FILLER            PIC  X(0003).
   954     05  RSDAT1O PIC  X(0008).
   955*    -------------------------------
   956     05  FILLER            PIC  X(0003).
   957     05  ARCNO2O PIC  X(0008).
   958*    -------------------------------
   959     05  FILLER            PIC  X(0003).
   960     05  FORM2O PIC  X(0004).
   961*    -------------------------------
   962     05  FILLER            PIC  X(0003).
   963     05  USRID2O PIC  X(0004).
   964*    -------------------------------
   965     05  FILLER            PIC  X(0003).
   966     05  PRINT2O PIC  X(0008).
   967*    -------------------------------
   968     05  FILLER            PIC  X(0003).
   969     05  STATS2O PIC  X(0008).
   970*    -------------------------------
   971     05  FILLER            PIC  X(0003).
   972     05  RSFRM2O PIC  X(0004).
   973*    -------------------------------
   974     05  FILLER            PIC  X(0003).
   975     05  RSDAT2O PIC  X(0008).
   976*    -------------------------------
   977     05  FILLER            PIC  X(0003).
   978     05  ARCNO3O PIC  X(0008).
   979*    -------------------------------
   980     05  FILLER            PIC  X(0003).
   981     05  FORM3O PIC  X(0004).
   982*    -------------------------------
   983     05  FILLER            PIC  X(0003).
   984     05  USRID3O PIC  X(0004).
   985*    -------------------------------
   986     05  FILLER            PIC  X(0003).
   987     05  PRINT3O PIC  X(0008).
   988*    -------------------------------
   989     05  FILLER            PIC  X(0003).
   990     05  STATS3O PIC  X(0008).
   991*    -------------------------------
   992     05  FILLER            PIC  X(0003).
   993     05  RSFRM3O PIC  X(0004).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  20
* EL690.cbl
   994*    -------------------------------
   995     05  FILLER            PIC  X(0003).
   996     05  RSDAT3O PIC  X(0008).
   997*    -------------------------------
   998     05  FILLER            PIC  X(0003).
   999     05  ARCNO4O PIC  X(0008).
  1000*    -------------------------------
  1001     05  FILLER            PIC  X(0003).
  1002     05  FORM4O PIC  X(0004).
  1003*    -------------------------------
  1004     05  FILLER            PIC  X(0003).
  1005     05  USRID4O PIC  X(0004).
  1006*    -------------------------------
  1007     05  FILLER            PIC  X(0003).
  1008     05  PRINT4O PIC  X(0008).
  1009*    -------------------------------
  1010     05  FILLER            PIC  X(0003).
  1011     05  STATS4O PIC  X(0008).
  1012*    -------------------------------
  1013     05  FILLER            PIC  X(0003).
  1014     05  RSFRM4O PIC  X(0004).
  1015*    -------------------------------
  1016     05  FILLER            PIC  X(0003).
  1017     05  RSDAT4O PIC  X(0008).
  1018*    -------------------------------
  1019     05  FILLER            PIC  X(0003).
  1020     05  ARCNO5O PIC  X(0008).
  1021*    -------------------------------
  1022     05  FILLER            PIC  X(0003).
  1023     05  FORM5O PIC  X(0004).
  1024*    -------------------------------
  1025     05  FILLER            PIC  X(0003).
  1026     05  USRID5O PIC  X(0004).
  1027*    -------------------------------
  1028     05  FILLER            PIC  X(0003).
  1029     05  PRINT5O PIC  X(0008).
  1030*    -------------------------------
  1031     05  FILLER            PIC  X(0003).
  1032     05  STATS5O PIC  X(0008).
  1033*    -------------------------------
  1034     05  FILLER            PIC  X(0003).
  1035     05  RSFRM5O PIC  X(0004).
  1036*    -------------------------------
  1037     05  FILLER            PIC  X(0003).
  1038     05  RSDAT5O PIC  X(0008).
  1039*    -------------------------------
  1040     05  FILLER            PIC  X(0003).
  1041     05  ARCNO6O PIC  X(0008).
  1042*    -------------------------------
  1043     05  FILLER            PIC  X(0003).
  1044     05  FORM6O PIC  X(0004).
  1045*    -------------------------------
  1046     05  FILLER            PIC  X(0003).
  1047     05  USRID6O PIC  X(0004).
  1048*    -------------------------------
  1049     05  FILLER            PIC  X(0003).
  1050     05  PRINT6O PIC  X(0008).
  1051*    -------------------------------
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  21
* EL690.cbl
  1052     05  FILLER            PIC  X(0003).
  1053     05  STATS6O PIC  X(0008).
  1054*    -------------------------------
  1055     05  FILLER            PIC  X(0003).
  1056     05  RSFRM6O PIC  X(0004).
  1057*    -------------------------------
  1058     05  FILLER            PIC  X(0003).
  1059     05  RSDAT6O PIC  X(0008).
  1060*    -------------------------------
  1061     05  FILLER            PIC  X(0003).
  1062     05  ARCNO7O PIC  X(0008).
  1063*    -------------------------------
  1064     05  FILLER            PIC  X(0003).
  1065     05  FORM7O PIC  X(0004).
  1066*    -------------------------------
  1067     05  FILLER            PIC  X(0003).
  1068     05  USRID7O PIC  X(0004).
  1069*    -------------------------------
  1070     05  FILLER            PIC  X(0003).
  1071     05  PRINT7O PIC  X(0008).
  1072*    -------------------------------
  1073     05  FILLER            PIC  X(0003).
  1074     05  STATS7O PIC  X(0008).
  1075*    -------------------------------
  1076     05  FILLER            PIC  X(0003).
  1077     05  RSFRM7O PIC  X(0004).
  1078*    -------------------------------
  1079     05  FILLER            PIC  X(0003).
  1080     05  RSDAT7O PIC  X(0008).
  1081*    -------------------------------
  1082     05  FILLER            PIC  X(0003).
  1083     05  ARCNO8O PIC  X(0008).
  1084*    -------------------------------
  1085     05  FILLER            PIC  X(0003).
  1086     05  FORM8O PIC  X(0004).
  1087*    -------------------------------
  1088     05  FILLER            PIC  X(0003).
  1089     05  USRID8O PIC  X(0004).
  1090*    -------------------------------
  1091     05  FILLER            PIC  X(0003).
  1092     05  PRINT8O PIC  X(0008).
  1093*    -------------------------------
  1094     05  FILLER            PIC  X(0003).
  1095     05  STATS8O PIC  X(0008).
  1096*    -------------------------------
  1097     05  FILLER            PIC  X(0003).
  1098     05  RSFRM8O PIC  X(0004).
  1099*    -------------------------------
  1100     05  FILLER            PIC  X(0003).
  1101     05  RSDAT8O PIC  X(0008).
  1102*    -------------------------------
  1103     05  FILLER            PIC  X(0003).
  1104     05  ARCNO9O PIC  X(0008).
  1105*    -------------------------------
  1106     05  FILLER            PIC  X(0003).
  1107     05  FORM9O PIC  X(0004).
  1108*    -------------------------------
  1109     05  FILLER            PIC  X(0003).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  22
* EL690.cbl
  1110     05  USRID9O PIC  X(0004).
  1111*    -------------------------------
  1112     05  FILLER            PIC  X(0003).
  1113     05  PRINT9O PIC  X(0008).
  1114*    -------------------------------
  1115     05  FILLER            PIC  X(0003).
  1116     05  STATS9O PIC  X(0008).
  1117*    -------------------------------
  1118     05  FILLER            PIC  X(0003).
  1119     05  RSFRM9O PIC  X(0004).
  1120*    -------------------------------
  1121     05  FILLER            PIC  X(0003).
  1122     05  RSDAT9O PIC  X(0008).
  1123*    -------------------------------
  1124     05  FILLER            PIC  X(0003).
  1125     05  ARCNO10O PIC  X(0008).
  1126*    -------------------------------
  1127     05  FILLER            PIC  X(0003).
  1128     05  FORM10O PIC  X(0004).
  1129*    -------------------------------
  1130     05  FILLER            PIC  X(0003).
  1131     05  USRID10O PIC  X(0004).
  1132*    -------------------------------
  1133     05  FILLER            PIC  X(0003).
  1134     05  PRINT10O PIC  X(0008).
  1135*    -------------------------------
  1136     05  FILLER            PIC  X(0003).
  1137     05  STATS10O PIC  X(0008).
  1138*    -------------------------------
  1139     05  FILLER            PIC  X(0003).
  1140     05  RSFRM10O PIC  X(0004).
  1141*    -------------------------------
  1142     05  FILLER            PIC  X(0003).
  1143     05  RSDAT10O PIC  X(0008).
  1144*    -------------------------------
  1145     05  FILLER            PIC  X(0003).
  1146     05  ARCNO11O PIC  X(0008).
  1147*    -------------------------------
  1148     05  FILLER            PIC  X(0003).
  1149     05  FORM11O PIC  X(0004).
  1150*    -------------------------------
  1151     05  FILLER            PIC  X(0003).
  1152     05  USRID11O PIC  X(0004).
  1153*    -------------------------------
  1154     05  FILLER            PIC  X(0003).
  1155     05  PRINT11O PIC  X(0008).
  1156*    -------------------------------
  1157     05  FILLER            PIC  X(0003).
  1158     05  STATS11O PIC  X(0008).
  1159*    -------------------------------
  1160     05  FILLER            PIC  X(0003).
  1161     05  RSFRM11O PIC  X(0004).
  1162*    -------------------------------
  1163     05  FILLER            PIC  X(0003).
  1164     05  RSDAT11O PIC  X(0008).
  1165*    -------------------------------
  1166     05  FILLER            PIC  X(0003).
  1167     05  ARCNO12O PIC  X(0008).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  23
* EL690.cbl
  1168*    -------------------------------
  1169     05  FILLER            PIC  X(0003).
  1170     05  FORM12O PIC  X(0004).
  1171*    -------------------------------
  1172     05  FILLER            PIC  X(0003).
  1173     05  USRID12O PIC  X(0004).
  1174*    -------------------------------
  1175     05  FILLER            PIC  X(0003).
  1176     05  PRINT12O PIC  X(0008).
  1177*    -------------------------------
  1178     05  FILLER            PIC  X(0003).
  1179     05  STATS12O PIC  X(0008).
  1180*    -------------------------------
  1181     05  FILLER            PIC  X(0003).
  1182     05  RSFRM12O PIC  X(0004).
  1183*    -------------------------------
  1184     05  FILLER            PIC  X(0003).
  1185     05  RSDAT12O PIC  X(0008).
  1186*    -------------------------------
  1187     05  FILLER            PIC  X(0003).
  1188     05  ERRMSG1O PIC  X(0079).
  1189*    -------------------------------
  1190     05  FILLER            PIC  X(0003).
  1191     05  PFKEYO PIC  X(0002).
  1192*    -------------------------------
  1193 01  FILLER REDEFINES EL690AI.
  1194     16  FILLER                  PIC X(154).
  1195     16  W-ARCH-GROUPS.
  1196         20  W-ARCHGRP-DATA OCCURS 12 TIMES.
  1197             24  W-ARCNOL        PIC S9(04) COMP.
  1198             24  W-ARCNOA        PIC  X(01).
  1199             24  W-ARCNOO        PIC  9(08).
  1200             24  W-FORML         PIC S9(04) COMP.
  1201             24  W-FORMA         PIC  X(01).
  1202             24  W-FORMO         PIC  X(04).
  1203             24  W-USRIDL        PIC S9(04) COMP.
  1204             24  W-USRIDA        PIC  X(01).
  1205             24  W-USRIDO        PIC  X(04).
  1206             24  W-PRINTL        PIC S9(04) COMP.
  1207             24  W-PRINTA        PIC  X(01).
  1208             24  W-PRINTO        PIC  X(08).
  1209             24  W-STATUSL       PIC S9(04) COMP.
  1210             24  W-STATUSA       PIC  X(01).
  1211             24  W-STATUSO       PIC  X(08).
  1212             24  W-RSFRML        PIC S9(04) COMP.
  1213             24  W-RSFRMA        PIC  X(01).
  1214             24  W-RSFRMO        PIC  X(04).
  1215             24  W-RSDATL        PIC S9(04) COMP.
  1216             24  W-RSDATA        PIC  X(01).
  1217             24  W-RSDATO        PIC  X(08).
  1218     16  FILLER                  PIC  X(87).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  24
* EL690.cbl
  1220
  1221 01  FILLER                      PIC  X(22)
  1222                                 VALUE 'PGRM INTERFACE STARTS:'.
  1223*    COPY ELCINTF.
  1224******************************************************************
  1225*                                                                *
  1226*                                                                *
  1227*                            ELCINTF.                            *
  1228*                            VMOD=2.017                          *
  1229*                                                                *
  1230*   FILE DESCRIPTION = C.I.C.S. COMMON DATA AREA                 *
  1231*                                                                *
  1232*       LENGTH = 1024                                            *
  1233*                                                                *
  1234******************************************************************
  1235*                   C H A N G E   L O G
  1236*
  1237* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1238*-----------------------------------------------------------------
  1239*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1240* EFFECTIVE    NUMBER
  1241*-----------------------------------------------------------------
  1242* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  1243******************************************************************
  1244 01  PROGRAM-INTERFACE-BLOCK.
  1245     12  PI-COMM-LENGTH                PIC S9(4) COMP VALUE +1024.
  1246     12  PI-CALLING-PROGRAM              PIC X(8).
  1247     12  PI-SAVED-PROGRAM-1              PIC X(8).
  1248     12  PI-SAVED-PROGRAM-2              PIC X(8).
  1249     12  PI-SAVED-PROGRAM-3              PIC X(8).
  1250     12  PI-SAVED-PROGRAM-4              PIC X(8).
  1251     12  PI-SAVED-PROGRAM-5              PIC X(8).
  1252     12  PI-SAVED-PROGRAM-6              PIC X(8).
  1253     12  PI-RETURN-TO-PROGRAM            PIC X(8).
  1254     12  PI-COMPANY-ID                   PIC XXX.
  1255     12  PI-COMPANY-CD                   PIC X.
  1256
  1257     12  PI-COMPANY-PASSWORD             PIC X(8).
  1258
  1259     12  PI-JOURNAL-FILE-ID              PIC S9(4) COMP.
  1260
  1261     12  PI-CONTROL-IN-PROGRESS.
  1262         16  PI-CARRIER                  PIC X.
  1263         16  PI-GROUPING                 PIC X(6).
  1264         16  PI-STATE                    PIC XX.
  1265         16  PI-ACCOUNT                  PIC X(10).
  1266         16  PI-PRODUCER REDEFINES PI-ACCOUNT
  1267                                         PIC X(10).
  1268         16  PI-CLAIM-CERT-GRP.
  1269             20  PI-CLAIM-NO             PIC X(7).
  1270             20  PI-CERT-NO.
  1271                 25  PI-CERT-PRIME       PIC X(10).
  1272                 25  PI-CERT-SFX         PIC X.
  1273             20  PI-CERT-EFF-DT          PIC XX.
  1274         16  PI-PLAN-DATA REDEFINES PI-CLAIM-CERT-GRP.
  1275             20  PI-PLAN-CODE            PIC X(2).
  1276             20  PI-REVISION-NUMBER      PIC X(3).
  1277             20  PI-PLAN-EFF-DT          PIC X(2).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  25
* EL690.cbl
  1278             20  PI-PLAN-EXP-DT          PIC X(2).
  1279             20  FILLER                  PIC X(11).
  1280         16  PI-OE-REFERENCE-1 REDEFINES PI-CLAIM-CERT-GRP.
  1281             20  PI-OE-REFERENCE-1.
  1282                 25  PI-OE-REF-1-PRIME   PIC X(18).
  1283                 25  PI-OE-REF-1-SUFF    PIC XX.
  1284
  1285     12  PI-SESSION-IN-PROGRESS          PIC X.
  1286         88  CLAIM-SESSION                   VALUE '1'.
  1287         88  CREDIT-SESSION                  VALUE '2'.
  1288         88  WARRANTY-SESSION                VALUE '3'.
  1289         88  MORTGAGE-SESSION                VALUE '4'.
  1290         88  GENERAL-LEDGER-SESSION          VALUE '5'.
  1291
  1292
  1293*THE FOLLOWING TWO FIELDS ARE USED ONLY WITH MULTI COMPANY CLIENTS
  1294
  1295     12  PI-ORIGINAL-COMPANY-ID          PIC X(3).
  1296     12  PI-ORIGINAL-COMPANY-CD          PIC X.
  1297
  1298     12  PI-CREDIT-USER                  PIC X.
  1299         88  PI-NOT-CREDIT-USER              VALUE 'N'.
  1300         88  PI-HAS-CLAS-IC-CREDIT           VALUE 'Y'.
  1301
  1302     12  PI-CLAIM-USER                   PIC X.
  1303         88  PI-NOT-CLAIM-USER               VALUE 'N'.
  1304         88  PI-HAS-CLAS-IC-CLAIM            VALUE 'Y'.
  1305
  1306     12  PI-PROCESSOR-SYS-ACCESS         PIC X.
  1307         88  PI-ACCESS-TO-BOTH-SYSTEMS       VALUE ' '.
  1308         88  PI-ACCESS-TO-ALL-SYSTEMS        VALUE ' '.
  1309         88  PI-ACCESS-TO-CLAIM-ONLY         VALUE '1'.
  1310         88  PI-ACCESS-TO-CREDIT-ONLY        VALUE '2'.
  1311         88  PI-ACCESS-TO-MORTGAGE-ONLY      VALUE '3'.
  1312
  1313     12  PI-PROCESSOR-ID                 PIC X(4).
  1314
  1315     12  PI-PROCESSOR-PASSWORD           PIC X(11).
  1316
  1317     12  PI-MEMBER-CAPTION               PIC X(10).
  1318
  1319     12  PI-PROCESSOR-USER-ALMIGHTY      PIC X.
  1320         88  PI-USER-ALMIGHTY-YES            VALUE 'Y'.
  1321
  1322     12  PI-LIFE-OVERRIDE-L1             PIC X.
  1323     12  PI-LIFE-OVERRIDE-L2             PIC XX.
  1324     12  PI-LIFE-OVERRIDE-L6             PIC X(6).
  1325     12  PI-LIFE-OVERRIDE-L12            PIC X(12).
  1326
  1327     12  PI-AH-OVERRIDE-L1               PIC X.
  1328     12  PI-AH-OVERRIDE-L2               PIC XX.
  1329     12  PI-AH-OVERRIDE-L6               PIC X(6).
  1330     12  PI-AH-OVERRIDE-L12              PIC X(12).
  1331
  1332     12  PI-NEW-SYSTEM                   PIC X(2).
  1333
  1334     12  PI-PRIMARY-CERT-NO              PIC X(11).
  1335     12  PI-CLAIM-PAID-THRU-TO           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  26
* EL690.cbl
  1336         88  PI-USES-PAID-TO                 VALUE '1'.
  1337     12  PI-CRDTCRD-SYSTEM.
  1338         16  PI-CRDTCRD-USER             PIC X.
  1339             88  PI-NOT-CRDTCRD-USER         VALUE 'N'.
  1340             88  PI-HAS-CLAS-IC-CRDTCRD      VALUE 'Y'.
  1341         16  PI-CC-MONTH-END-DT          PIC XX.
  1342     12  PI-PROCESSOR-PRINTER            PIC X(4).
  1343
  1344     12  PI-OE-REFERENCE-2.
  1345         16  PI-OE-REF-2-PRIME           PIC X(10).
  1346         16  PI-OE-REF-2-SUFF            PIC X.
  1347
  1348     12  PI-REM-TRM-CALC-OPTION          PIC X.
  1349
  1350     12  PI-LANGUAGE-TYPE                PIC X.
  1351             88  PI-LANGUAGE-IS-ENG          VALUE 'E'.
  1352             88  PI-LANGUAGE-IS-FR           VALUE 'F'.
  1353             88  PI-LANGUAGE-IS-SPAN         VALUE 'S'.
  1354
  1355     12  PI-POLICY-LINKAGE-IND           PIC X.
  1356         88  PI-USE-POLICY-LINKAGE           VALUE 'Y'.
  1357         88  PI-POLICY-LINKAGE-NOT-USED      VALUE 'N'
  1358                                                   LOW-VALUES.
  1359
  1360     12  PI-ALT-DMD-PRT-ID               PIC X(4).
  1361     12  PI-CLAIM-PW-SESSION             PIC X(1).
  1362         88  PI-CLAIM-CREDIT                 VALUE '1'.
  1363         88  PI-CLAIM-CONVEN                 VALUE '2'.
  1364
  1365     12  PI-PROCESSOR-CSR-IND            PIC X.
  1366         88  PI-PROCESSOR-IS-CSR             VALUE 'Y' 'S'.
  1367         88  PI-PROCESSOR-IS-CSR-SUPER       VALUE 'S'.
  1368
  1369     12  FILLER                          PIC X(3).
  1370
  1371     12  PI-SYSTEM-LEVEL                 PIC X(145).
  1372
  1373     12  PI-CLAIMS-CREDIT-LEVEL          REDEFINES
  1374         PI-SYSTEM-LEVEL.
  1375
  1376         16  PI-ENTRY-CODES.
  1377             20  PI-ENTRY-CD-1           PIC X.
  1378             20  PI-ENTRY-CD-2           PIC X.
  1379
  1380         16  PI-RETURN-CODES.
  1381             20  PI-RETURN-CD-1          PIC X.
  1382             20  PI-RETURN-CD-2          PIC X.
  1383
  1384         16  PI-UPDATE-STATUS-SAVE.
  1385             20  PI-UPDATE-BY            PIC X(4).
  1386             20  PI-UPDATE-HHMMSS        PIC S9(7)     COMP-3.
  1387
  1388         16  PI-LOWER-CASE-LETTERS       PIC X.
  1389             88  LOWER-CASE-LETTERS-USED     VALUE 'Y'.
  1390
  1391*        16  PI-CLAIM-ACCESS-CONTROL     PIC X.
  1392*            88  CLAIM-NO-UNIQUE             VALUE '1'.
  1393*            88  CARRIER-CLM-CNTL            VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  27
* EL690.cbl
  1394
  1395         16  PI-CERT-ACCESS-CONTROL      PIC X.
  1396             88  ST-ACCNT-CNTL               VALUE ' '.
  1397             88  CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  1398             88  CARR-ST-ACCNT-CNTL          VALUE '2'.
  1399             88  ACCNT-CNTL                  VALUE '3'.
  1400             88  CARR-ACCNT-CNTL             VALUE '4'.
  1401
  1402         16  PI-PROCESSOR-CAP-LIST.
  1403             20  PI-SYSTEM-CONTROLS.
  1404                24 PI-SYSTEM-DISPLAY     PIC X.
  1405                 88  SYSTEM-DISPLAY-CAP      VALUE 'Y'.
  1406                24 PI-SYSTEM-MODIFY      PIC X.
  1407                 88  SYSTEM-MODIFY-CAP       VALUE 'Y'.
  1408             20  FILLER                  PIC XX.
  1409             20  PI-DISPLAY-CAP          PIC X.
  1410                 88  DISPLAY-CAP             VALUE 'Y'.
  1411             20  PI-MODIFY-CAP           PIC X.
  1412                 88  MODIFY-CAP              VALUE 'Y'.
  1413             20  PI-MSG-AT-LOGON-CAP     PIC X.
  1414                 88  MSG-AT-LOGON-CAP        VALUE 'Y'.
  1415             20  PI-FORCE-CAP            PIC X.
  1416                 88  FORCE-CAP               VALUE 'Y'.
  1417
  1418         16  PI-PROGRAM-CONTROLS.
  1419             20  PI-PGM-PRINT-OPT        PIC X.
  1420             20  PI-PGM-FORMAT-OPT       PIC X.
  1421             20  PI-PGM-PROCESS-OPT      PIC X.
  1422             20  PI-PGM-TOTALS-OPT       PIC X.
  1423
  1424         16  PI-HELP-INTERFACE.
  1425             20  PI-LAST-ERROR-NO        PIC X(4).
  1426             20  PI-CURRENT-SCREEN-NO    PIC X(4).
  1427
  1428         16  PI-CARRIER-CONTROL-LEVEL    PIC X.
  1429             88  CONTROL-IS-ACTUAL-CARRIER   VALUE SPACE.
  1430
  1431         16  PI-CR-CONTROL-IN-PROGRESS.
  1432             20  PI-CR-CARRIER           PIC X.
  1433             20  PI-CR-GROUPING          PIC X(6).
  1434             20  PI-CR-STATE             PIC XX.
  1435             20  PI-CR-ACCOUNT           PIC X(10).
  1436             20  PI-CR-FIN-RESP          PIC X(10).
  1437             20  PI-CR-TYPE              PIC X.
  1438
  1439         16  PI-CR-BATCH-NUMBER          PIC X(6).
  1440
  1441         16  PI-CR-MONTH-END-DT          PIC XX.
  1442
  1443         16  PI-CAR-GROUP-ACCESS-CNTL    PIC X.
  1444             88  PI-USE-ACTUAL-CARRIER       VALUE ' '.
  1445             88  PI-ZERO-CARRIER             VALUE '1'.
  1446             88  PI-ZERO-GROUPING            VALUE '2'.
  1447             88  PI-ZERO-CAR-GROUP           VALUE '3'.
  1448
  1449         16  PI-CARRIER-SECURITY         PIC X.
  1450             88  PI-NO-CARRIER-SECURITY      VALUE ' '.
  1451
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  28
* EL690.cbl
  1452         16  PI-ACCOUNT-SECURITY         PIC X(10).
  1453             88  PI-NO-ACCOUNT-SECURITY      VALUE SPACES.
  1454             88  PI-NO-PRODUCER-SECURITY     VALUE SPACES.
  1455
  1456         16  PI-CODE-SECURITY REDEFINES PI-ACCOUNT-SECURITY.
  1457             20  PI-ACCESS-CODE          OCCURS 10 TIMES
  1458                                         INDEXED BY PI-ACCESS-NDX
  1459                                         PIC X.
  1460
  1461         16  PI-GA-BILLING-CONTROL       PIC X.
  1462             88  PI-GA-BILLING               VALUE '1'.
  1463
  1464         16  PI-MAIL-PROCESSING          PIC X.
  1465             88  PI-MAIL-YES                 VALUE 'Y'.
  1466
  1467         16  PI-SECURITY-TEMP-STORE-ID   PIC X(8).
  1468
  1469         16  PI-AR-SYSTEM.
  1470             20  PI-AR-PROCESSING-CNTL   PIC X.
  1471                 88  PI-AR-PROCESSING        VALUE 'Y'.
  1472             20  PI-AR-SUMMARY-CODE      PIC X(6).
  1473             20  PI-AR-MONTH-END-DT      PIC XX.
  1474
  1475         16  PI-MP-SYSTEM.
  1476             20  PI-MORTGAGE-USER            PIC X.
  1477                 88  PI-NOT-MORTGAGE-USER            VALUE 'N'.
  1478                 88  PI-HAS-CLAS-IC-MORTGAGE         VALUE 'Y'.
  1479             20  PI-MORTGAGE-ACCESS-CONTROL  PIC X.
  1480                 88  PI-MP-ST-PROD-CNTL              VALUE ' '.
  1481                 88  PI-MP-CARR-GRP-ST-PROD-CNTL     VALUE '1'.
  1482                 88  PI-MP-CARR-ST-PROD-CNTL         VALUE '2'.
  1483                 88  PI-MP-PROD-CNTL                 VALUE '3'.
  1484                 88  PI-MP-CARR-PROD-CNTL            VALUE '4'.
  1485             20  PI-MP-MONTH-END-DT          PIC XX.
  1486             20  PI-MP-REFERENCE-NO.
  1487                 24  PI-MP-REFERENCE-PRIME   PIC X(18).
  1488                 24  PI-MP-REFERENCE-SFX     PIC XX.
  1489
  1490         16  PI-LABEL-CONTROL            PIC X(01).
  1491             88  PI-CREATE-LABELS                    VALUE 'Y'.
  1492             88  PI-BYPASS-LABELS                    VALUE 'N'.
  1493
  1494         16  PI-BILL-GROUPING-CODE       PIC X(01).
  1495             88  PI-CO-HAS-BILL-GROUPING             VALUE 'Y'.
  1496
  1497         16  PI-RATE-DEV-AUTHORIZATION   PIC X(01).
  1498             88  PI-RATE-DEV-AUTHORIZED              VALUE 'Y'.
  1499             88  PI-RATE-DEV-NOT-AUTHORIZED          VALUE 'N'.
  1500
  1501         16  FILLER                      PIC X(14).
  1502
  1503     12  PI-PROGRAM-WORK-AREA            PIC X(640).
  1504******************************************************************
  1505     12  FILLER REDEFINES PI-PROGRAM-WORK-AREA.
  1506*    COPY ELC1042.
  1507******************************************************************
  1508*                                                                *
  1509*                                                                *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  29
* EL690.cbl
  1510*                           ELC1042                              *
  1511*                            VMOD=2.002                          *
  1512*                                                                *
  1513*    NOTE                                                        *
  1514*        THE WORK AREA IS USED BY EL152, EL1522, EL1042, EL153,  *
  1515*        EM152, EM1522, EL689, EL6892, EL6311, AND EL690.        *
  1516*        THIS COPYBOOK SHOULD NOT BE CHANGED WITHOUT REFERENCE   *
  1517*        TO THESE PROGRAMS.                                      *
  1518*                                                                *
  1519*    NOTE                                                        *
  1520*        THE FILLER AREA AT THE BOTTOM ARE FOR FUTURE EL1042     *
  1521*        USE ONLY!                                               *
  1522*                                                                *
  1523******************************************************************
  1524
  1525         16  PI-1042-WA.
  1526             20  PI-ACTION       PIC  X(01).
  1527                 88 PI-SHOW-MODE           VALUE '1'.
  1528                 88 PI-CLEAR-MODE          VALUE '2'.
  1529                 88 PI-CREATE-MODE         VALUE '3'.
  1530             20  PI-COMM-CONTROL PIC  X(12).
  1531             20  PI-CURRENT-LINE PIC S9(03) COMP-3.
  1532             20  PI-EOF-SW       PIC  X(01).
  1533                 88  PI-FILE-EOF           VALUE 'Y'.
  1534             20  PI-FILETYP      PIC  X(01).
  1535             20  PI-FORM-SQUEEZE-CONTROL
  1536                                 PIC  X(01).
  1537                 88  PI-FORM-SQUEEZE-ON     VALUE 'Y'.
  1538                 88  PI-FORM-SQUEEZE-OFF    VALUE ' '.
  1539             20  PI-LAST-CONTROL PIC  X(12).
  1540             20  PI-TEMP-STOR-ITEMS
  1541                                 PIC S9(04) COMP.
  1542             20  PI-TOTAL-LINES  PIC S9(03) COMP-3.
  1543             20  PI-UPDATE-SW    PIC  9(01).
  1544                 88 ANY-UPDATES            VALUE 1.
  1545             20  PI-104-SCREEN-SENT-IND
  1546                                 PIC  X(01).
  1547                 88  PI-104-SCREEN-SENT    VALUE 'Y'.
  1548                 88  PI-104-SCREEN-NOT-SENT VALUE 'N'.
  1549             20  PI-1042-SCREEN-SENT-IND
  1550                                 PIC  X(01).
  1551                 88  PI-1042-SCREEN-SENT    VALUE 'Y'.
  1552                 88  PI-1042-SCREEN-NOT-SENT VALUE 'N'.
  1553             20  PI-1042-ARCHIVE-IND
  1554                                 PIC  X(01).
  1555                 88  PI-1042-ARCHIVE-LETTER VALUE 'Y'.
  1556             20  FILLER          PIC  X(29).
  1557*    COPY ELC689PI.
  1558******************************************************************
  1559*                                                                *
  1560*                            ELC689PI                            *
  1561*                            VMOD=2.003                          *
  1562*                                                                *
  1563*    THIS IS THE PI-PROGRAM-WORK-AREA THAT IS USED FOR THE       *
  1564*    CREDIT CORRESPONDENCE SUB-SYSTEM.  ANY CHANGES WILL         *
  1565*    WILL EFFECT THE PROGRAMS OF THAT SUB-SYSTEM.                *
  1566*                                                                *
  1567*    IF THE LENGTH OF THIS PI-AREA CHANGES THE LENGTH MUST       *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  30
* EL690.cbl
  1568*    BE CHANGED FOR THE COMM-AREA WHEN PASSING THIS PI-AREA      *
  1569*    BETWEEN PROGRAMS.                                           *
  1570*                                                                *
  1571*    THE FOLLOWING PROGRAMS USE THIS COPYBOOK:                   *
  1572*                                                                *
  1573*               EL631 - EL689  - EL6891 - EL6892                 *
  1574*                                                                *
  1575******************************************************************
  1576*                   C H A N G E   L O G
  1577*
  1578* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  1579*-----------------------------------------------------------------
  1580*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  1581* EFFECTIVE    NUMBER
  1582*-----------------------------------------------------------------
  1583* 081004                   PEMA  CONVERT TO PSUEDO CONVERSATIONAL
  1584* 100705  CR2004072800004  PEMA  ADD LETTERS TO BE RESENT
  1585* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  1586******************************************************************
  1587
  1588
  1589         16  PI-689-WORK-AREA.
  1590             20  PI-689-ALT-PRINTER-ID
  1591                                 PIC  X(04).
  1592             20  PI-689-ARCHIVE-NUMBER
  1593                                 PIC  9(08).
  1594             20  PI-689-ARCHIVE-SW
  1595                                 PIC  X(01).
  1596                 88  PI-689-ARCHIVE-LETTER VALUE 'Y'.
  1597             20  PI-689-DATA-SOURCE
  1598                                 PIC  X(01).
  1599                 88  PI-689-SRC-ACCOUNT        VALUE '1'.
  1600                 88  PI-689-SRC-CERTIFICATE    VALUE '2'.
  1601                 88  PI-689-SRC-COMPENSATION   VALUE '3'.
  1602                 88  PI-689-SRC-PEND-BUSINESS  VALUE '4'.
  1603                 88  PI-689-SRC-CHECKS         VALUE '5'.
  1604             20  PI-689-ERROR-IND
  1605                                 PIC  X(01).
  1606                 88  PI-689-ERR-DETECTED-PREV  VALUE 'Y'.
  1607             20  PI-689-ERROR    PIC  9(04).
  1608                 88  PI-689-NO-ERRORS-DETECTED VALUE 0000.
  1609                 88  PI-689-FATAL-ERROR
  1610                     VALUES 0004 0006 0008 0013 0023 0029 0033
  1611                            0042 0047 0051 0066 0067 0070
  1612                            0168 0169 0174 0175 0176 0177 0179
  1613                            0180 0181 0182 0184 0185 0189 0190
  1614                            0191
  1615                            0215 0279 0280
  1616                            0412 0413 0454
  1617                            0533 0537
  1618                            2055 2114 2208 2209 2216 2232 2369
  1619                            2398 2433 2908 2999
  1620                            3000 3770 3771 3775
  1621                            7250 7365 7367 7368 7369 7370 7371
  1622                            7272 7373 7374 7376 7377 7378 7379
  1623                            7381 7388 7390 7393 7395 7396 7398
  1624                            9095 9096 9281 9298 9299 9320 9327
  1625                            9426 9427.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  31
* EL690.cbl
  1626                 88  PI-689-STOP-ERROR
  1627                     VALUES 0004 0008 0013 0023 0029 0033
  1628                            0042 0047 0066 0067 0070
  1629                            0168 0169 0174 0175 0176 0177
  1630                            0181 0182 0184 0185 0189 0190
  1631                            0279 0280
  1632                            0412 0413 0454
  1633                            2055 2208 2209 2216 2232
  1634                            2398 2999
  1635                            3000 3770 3771 3775
  1636                            7250 7365 7369 7370 7371
  1637                            7272 7373 7374 7376 7377 7378 7379
  1638                            7381 7388 7390 7393 7396 7398
  1639                            9095 9096 9299 9320 9426.
  1640             20  PI-689-FOLLOW-UP-DATE
  1641                                 PIC  X(02).
  1642             20  PI-689-FORM-NUMBER
  1643                                 PIC  X(04).
  1644             20  PI-689-LABEL-SOURCE
  1645                                 PIC X(01).
  1646                 88  PI-689-SOURCE-ACCOUNT  VALUE '1'.
  1647                 88  PI-689-SOURCE-CARRIER  VALUE '2'.
  1648                 88  PI-689-SOURCE-COMPANY  VALUE '3'.
  1649                 88  PI-689-SOURCE-COMP     VALUE '4'.
  1650                 88  PI-689-SOURCE-MAIL     VALUE '5'.
  1651                 88  PI-689-SOURCE-CHECK    VALUE '6'.
  1652                 88  PI-689-SOURCE-VARIABLE VALUE '7'.
  1653             20  PI-689-NUMBER-COPIES
  1654                                 PIC  9(01).
  1655             20  PI-689-NUMBER-LABEL-LINES
  1656                                 PIC  9(01).
  1657             20  PI-689-NUMBER-TEXT-RECORDS
  1658                                 PIC  9(03).
  1659             20  PI-689-PRINT-ORDER-SW
  1660                                 PIC  X(01).
  1661                 88  PI-689-PRINT-FIRST     VALUE '1'.
  1662                 88  PI-689-PRINT-SECOND    VALUE '2'.
  1663                 88  PI-689-PRINT-LATER     VALUE '3'.
  1664                 88  PI-689-PRINT-ONLY      VALUE '4'.
  1665             20  PI-689-PRINT-RESTRICTION
  1666                                 PIC  X(01).
  1667                 88  PI-689-VALID-RESTRICT     VALUE 'C' 'F'.
  1668                 88  PI-689-PRT-ONLY-WITH-CNTL VALUE 'C'.
  1669                 88  PI-689-PRT-ONLY-WITH-FORM VALUE 'F'.
  1670             20  PI-689-PRINT-SW PIC  X(01).
  1671                 88  PI-689-PRINT-PERFORMED VALUE '1'.
  1672             20  PI-689-RESEND-DATE-1
  1673                                 PIC  X(02).
  1674             20  PI-689-RESEND-LETR-1
  1675                                 PIC X(4).
  1676             20  PI-689-TEMP-STOR-ID
  1677                                 PIC  X(08).
  1678             20  PI-689-USE-SCREEN-IND
  1679                                 PIC  X(01).
  1680                 88  PI-689-CREATE-NO-SCREENS VALUE '1'.
  1681             20  PI-689-ARCH-POINTER
  1682                                 PIC S9(08) COMP.
  1683                 88  PI-689-GET-ARCH-MAIN     VALUE +0.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  32
* EL690.cbl
  1684             20  PI-689-ARCT-POINTER
  1685                                 PIC S9(08) COMP.
  1686                 88  PI-689-GET-ARCT-MAIN     VALUE +0.
  1687             20  PI-689-VARIABLE-DATA-GRP.
  1688                 24  PI-689-VARIABLE-DATA-1
  1689                                 PIC  X(30).
  1690                 24  PI-689-VARIABLE-DATA-2
  1691                                 PIC  X(30).
  1692                 24  PI-689-VARIABLE-DATA-3
  1693                                 PIC  X(30).
  1694                 24  PI-689-VARIABLE-DATA-4
  1695                                 PIC  X(30).
  1696
  1697         16  PI-689-KEY-DATA-FIELDS.
  1698             20  PI-689-ACCOUNT  PIC  X(10).
  1699             20  PI-689-CARRIER  PIC  X(01).
  1700             20  PI-689-CERT-NO.
  1701                 24  PI-689-CERT-PRIME
  1702                                 PIC  X(10).
  1703                 24  PI-689-CERT-SFX
  1704                                 PIC  X(01).
  1705             20  PI-689-CHG-SEQ-NO
  1706                                 PIC S9(04)    COMP.
  1707             20  PI-689-CHG-SEQ-NOX REDEFINES PI-689-CHG-SEQ-NO
  1708                                 PIC  X(02).
  1709             20  PI-689-ENTRY-BATCH
  1710                                 PIC  X(06).
  1711             20  PI-689-EFF-DATE PIC  X(02).
  1712             20  PI-689-EXP-DATE PIC  X(02).
  1713             20  PI-689-GROUPING PIC  X(06).
  1714             20  PI-689-RESP-PERSON
  1715                                 PIC  X(10).
  1716             20  PI-689-SEQ-NO   PIC S9(08)    COMP.
  1717             20  PI-689-SEQ-NOX REDEFINES PI-689-SEQ-NO
  1718                                 PIC  X(04).
  1719             20  PI-689-STATE    PIC  X(02).
  1720             20  PI-689-TYPE     PIC  X(01).
  1721             20  PI-689-CONTROL  PIC S9(08)    COMP.
  1722             20  PI-689-ALT-SEQ-NO
  1723                                 PIC S9(04)    COMP.
  1724         16  PI-689-DATE-EDIT    PIC  X(08).
  1725         16  PI-689-FOLLOW-UP-EDIT
  1726                                 PIC  X(08).
  1727         16  PI-689-RESEND1-EDIT PIC  X(08).
  1728         16  PI-689-SEQ-EDIT     PIC  X(08).
  1729         16  PI-689-BCSEQ-EDIT   PIC  X(04).
  1730         16  PI-689-LBL-OVERRIDE PIC  X(01).
  1731             88  PI-689-LABELS-OVERRIDEN  VALUES 'N'.
  1732         16  PI-689-FATAL-CTR    PIC 999     COMP-3.
  1733         16  PI-689-FORCABLE-CTR PIC 999     COMP-3.
  1734         16  PI-690-WORK-AREA.
  1735             20  PI-690-ARCHIVE-TABLE.
  1736                 24  PI-690-ARCHIVE-NUM OCCURS 12 TIMES
  1737                                 PIC S9(08) COMP.
  1738             20  PI-690-CURSOR   PIC S9(04) COMP.
  1739             20  PI-690-FIRST-DATA.
  1740                 24  PI-690-FIRST-CERT-NO.
  1741                     28  PI-690-FIRST-CERT-PRIME
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  33
* EL690.cbl
  1742                                 PIC  X(10).
  1743                     28  PI-690-FIRST-SUFFIX
  1744                                 PIC  X(01).
  1745                 24  PI-690-FIRST-CARRIER
  1746                                 PIC  X(01).
  1747                 24  PI-690-FIRST-GROUPING
  1748                                 PIC  X(06).
  1749                 24  PI-690-FIRST-STATE
  1750                                 PIC  X(02).
  1751                 24  PI-690-FIRST-ACCOUNT
  1752                                 PIC  X(10).
  1753                 24  PI-690-FIRST-EFFECT-DATE
  1754                                 PIC  X(02).
  1755                 24  PI-690-FIRST-ENTRY.
  1756                     28  PI-690-FIRST-CONTROL-PREFIX
  1757                                 PIC  X(02).
  1758                     28  PI-690-FIRST-CONTROL
  1759                                 PIC S9(08) COMP.
  1760                 24  PI-690-FIRST-FORM
  1761                                 PIC  X(04).
  1762                 24  PI-690-FIRST-PROCESSOR
  1763                                 PIC  X(04).
  1764                 24  PI-690-FIRST-ARCHIVE-NO
  1765                                 PIC S9(08) COMP.
  1766             20  PI-690-INIT-DATA.
  1767                 24  PI-690-INIT-CERT-NO.
  1768                     28  PI-690-INIT-CERT-PRIME
  1769                                 PIC  X(10).
  1770                     28  PI-690-INIT-SUFFIX
  1771                                 PIC  X(01).
  1772                 24  PI-690-INIT-CARRIER
  1773                                 PIC  X(01).
  1774                 24  PI-690-INIT-GROUPING
  1775                                 PIC  X(06).
  1776                 24  PI-690-INIT-STATE
  1777                                 PIC  X(02).
  1778                 24  PI-690-INIT-ACCOUNT
  1779                                 PIC  X(10).
  1780                 24  PI-690-INIT-EFFECT-DATE
  1781                                 PIC  X(02).
  1782                 24  PI-690-INIT-EFF-DTE
  1783                                 PIC  X(08).
  1784                 24  PI-690-INIT-ENTRY.
  1785                     28  PI-690-INIT-CONTROL-PREFIX
  1786                                 PIC  X(02).
  1787                     28  PI-690-INIT-CONTROL
  1788                                 PIC S9(08) COMP.
  1789                 24  PI-690-INIT-FORM
  1790                                 PIC  X(04).
  1791                 24  PI-690-INIT-PROCESSOR
  1792                                 PIC  X(04).
  1793                 24  PI-690-INIT-ARCHIVE-NO
  1794                                 PIC S9(08) COMP.
  1795             20  PI-690-LAST-DATA.
  1796                 24  PI-690-LAST-CERT-NO.
  1797                     28  PI-690-LAST-CERT-PRIME
  1798                                 PIC  X(10).
  1799                     28  PI-690-LAST-SUFFIX
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  34
* EL690.cbl
  1800                                 PIC  X(01).
  1801                 24  PI-690-LAST-CARRIER
  1802                                 PIC  X(01).
  1803                 24  PI-690-LAST-GROUPING
  1804                                 PIC  X(06).
  1805                 24  PI-690-LAST-STATE
  1806                                 PIC  X(02).
  1807                 24  PI-690-LAST-ACCOUNT
  1808                                 PIC  X(10).
  1809                 24  PI-690-LAST-EFFECT-DATE
  1810                                 PIC  X(02).
  1811                 24  PI-690-LAST-ENTRY.
  1812                     28  PI-690-LAST-CONTROL-PREFIX
  1813                                 PIC  X(02).
  1814                     28  PI-690-LAST-CONTROL
  1815                                 PIC S9(08) COMP.
  1816                 24  PI-690-LAST-FORM
  1817                                 PIC  X(04).
  1818                 24  PI-690-LAST-PROCESSOR
  1819                                 PIC  X(04).
  1820                 24  PI-690-LAST-ARCHIVE-NO
  1821                                 PIC S9(08) COMP.
  1822             20  PI-690-LAST-ARCH-NDX
  1823                                 PIC S9(04) COMP.
  1824             20  PI-690-BRWS-TYPE-IND
  1825                                 PIC  9(01).
  1826                 88  PI-690-BRWS-CERTRP               VALUE 1.
  1827                 88  PI-690-BRWS-FORM                 VALUE 2.
  1828                 88  PI-690-BRWS-PROCESSOR            VALUE 3.
  1829                 88  PI-690-BRWS-ACCOUNT              VALUE 4.
  1830                 88  PI-690-BRWS-ENTRY-CNTL           VALUE 5.
  1831                 88  PI-690-BRWS-ARCHIVE              VALUE 6.
  1832             20  PI-690-LAST-BROWSE-IND
  1833                                 PIC  X(01).
  1834                 88  PI-690-LAST-BRWS-FWRD            VALUE '1'.
  1835                 88  PI-690-LAST-BRWS-BWRD            VALUE '2'.
  1836             20  PI-690-STATUS-SELECTION-IND
  1837                                 PIC  X(01).
  1838                 88  PI-690-SELECT-ALL       VALUE 'N'.
  1839                 88  PI-690-VALID-SELECTION  VALUE 'A' 'C' 'H'
  1840                                               'X' 'P' 'V' 'N'.
  1841         16  FILLER              PIC X(67).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  35
* EL690.cbl
  1843 01  FILLER                      PIC  X(19)
  1844                                 VALUE ':END INTERFACE AREA'.
  1845
  1846 01  ERROR-MESSAGES.
  1847     12  ER-0000                 PIC  X(04)  VALUE '0000'.
  1848     12  ER-0004                 PIC  X(04)  VALUE '0004'.
  1849     12  ER-0023                 PIC  X(04)  VALUE '0023'.
  1850     12  ER-0029                 PIC  X(04)  VALUE '0029'.
  1851     12  ER-0050                 PIC  X(04)  VALUE '0050'.
  1852     12  ER-0068                 PIC  X(04)  VALUE '0068'.
  1853     12  ER-0074                 PIC  X(04)  VALUE '0074'.
  1854     12  ER-0085                 PIC  X(04)  VALUE '0085'.
  1855     12  ER-0130                 PIC  X(04)  VALUE '0130'.
  1856     12  ER-0131                 PIC  X(04)  VALUE '0131'.
  1857     12  ER-0185                 PIC  X(04)  VALUE '0185'.
  1858     12  ER-0190                 PIC  X(04)  VALUE '0190'.
  1859     12  ER-0314                 PIC  X(04)  VALUE '0314'.
  1860     12  ER-7008                 PIC  X(04)  VALUE '7008'.
  1861     12  ER-7244                 PIC  X(04)  VALUE '7244'.
  1862     12  ER-7357                 PIC  X(04)  VALUE '7357'.
  1863     12  ER-7358                 PIC  X(04)  VALUE '7358'.
  1864     12  ER-7359                 PIC  X(04)  VALUE '7359'.
  1865     12  ER-7360                 PIC  X(04)  VALUE '7360'.
  1866     12  ER-7361                 PIC  X(04)  VALUE '7361'.
  1867     12  ER-7362                 PIC  X(04)  VALUE '7362'.
  1868     12  ER-7366                 PIC  X(04)  VALUE '7366'.
  1869     12  ER-7384                 PIC  X(04)  VALUE '7384'.
  1870     12  ER-7385                 PIC  X(04)  VALUE '7385'.
  1871     12  ER-7386                 PIC  X(04)  VALUE '7386'.
  1872     12  ER-7387                 PIC  X(04)  VALUE '7387'.
  1873     12  ER-7388                 PIC  X(04)  VALUE '7388'.
  1874*    12  ER-7394                 PIC  X(04)  VALUE '7394'.
  1875     12  ER-7396                 PIC  X(04)  VALUE '7396'.
  1876     12  ER-7397                 PIC  X(04)  VALUE '7397'.
  1877     12  ER-7399                 PIC  X(04)  VALUE '7399'.
  1878     12  ER-9007                 PIC  X(04)  VALUE '9007'.
  1879     12  ER-9008                 PIC  X(04)  VALUE '9008'.
  1880     12  ER-9009                 PIC  X(04)  VALUE '9009'.
  1881     12  ER-9010                 PIC  X(04)  VALUE '9010'.
  1882     12  ER-9011                 PIC  X(04)  VALUE '9011'.
  1883     12  ER-9012                 PIC  X(04)  VALUE '9012'.
  1884     12  ER-9015                 PIC  X(04)  VALUE '9015'.
  1885     12  ER-9016                 PIC  X(04)  VALUE '9016'.
  1886     12  ER-9017                 PIC  X(04)  VALUE '9017'.
  1887     12  ER-9042                 PIC  X(04)  VALUE '9042'.
  1888     12  ER-9080                 PIC  X(04)  VALUE '9080'.
  1889     12  ER-9096                 PIC  X(04)  VALUE '9096'.
  1890     12  ER-9097                 PIC  X(04)  VALUE '9097'.
  1891     12  ER-9129                 PIC  X(04)  VALUE '9129'.
  1892     12  ER-9150                 PIC  X(04)  VALUE '9150'.
  1893     12  ER-9196                 PIC  X(04)  VALUE '9196'.
  1894     12  ER-9245                 PIC  X(04)  VALUE '9245'.
  1895     12  ER-9281                 PIC  X(04)  VALUE '9281'.
  1896     12  ER-9282                 PIC  X(04)  VALUE '9282'.
  1897     12  ER-9293                 PIC  X(04)  VALUE '9293'.
  1898     12  ER-9308                 PIC  X(04)  VALUE '9308'.
  1899     12  ER-9310                 PIC  X(04)  VALUE '9310'.
  1900     12  ER-9312                 PIC  X(04)  VALUE '9312'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  36
* EL690.cbl
  1901     12  ER-9323                 PIC  X(04)  VALUE '9323'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  37
* EL690.cbl
  1903*    COPY ELCAID REPLACING '01 DFHAID.' BY '01  DFHAID.'.
  1904******************************************************************
  1905*                                                                *
  1906*                            ELCAID.                             *
  1907*                            VMOD=2.001                          *
  1908*                                                                *
  1909*   DESCRIPTION:  ATTENTION IDENTIFER CHARACTERS.                *
  1910*                                                                *
  1911*  NO  CID  MODS  IN  COPYBOOK  ELCAID                           *
  1912*  051007  2007041300002 Change PF22 from x'D5' to x'5B'
  1913******************************************************************
  1914
  1915 01  DFHAID.
  1916   02  DFHNULL   PIC  X  VALUE  ' '.
  1917   02  DFHENTER  PIC  X  VALUE  QUOTE.
  1918   02  DFHCLEAR  PIC  X  VALUE  '_'.
  1919   02  DFHPEN    PIC  X  VALUE  '='.
  1920   02  DFHOPID   PIC  X  VALUE  'W'.
  1921   02  DFHPA1    PIC  X  VALUE  '%'.
  1922   02  DFHPA2    PIC  X  VALUE  '>'.
  1923   02  DFHPA3    PIC  X  VALUE  ','.
  1924   02  DFHPF1    PIC  X  VALUE  '1'.
  1925   02  DFHPF2    PIC  X  VALUE  '2'.
  1926   02  DFHPF3    PIC  X  VALUE  '3'.
  1927   02  DFHPF4    PIC  X  VALUE  '4'.
  1928   02  DFHPF5    PIC  X  VALUE  '5'.
  1929   02  DFHPF6    PIC  X  VALUE  '6'.
  1930   02  DFHPF7    PIC  X  VALUE  '7'.
  1931   02  DFHPF8    PIC  X  VALUE  '8'.
  1932   02  DFHPF9    PIC  X  VALUE  '9'.
  1933   02  DFHPF10   PIC  X  VALUE  ':'.
  1934   02  DFHPF11   PIC  X  VALUE  '#'.
  1935   02  DFHPF12   PIC  X  VALUE  '@'.
  1936   02  DFHPF13   PIC  X  VALUE  'A'.
  1937   02  DFHPF14   PIC  X  VALUE  'B'.
  1938   02  DFHPF15   PIC  X  VALUE  'C'.
  1939   02  DFHPF16   PIC  X  VALUE  'D'.
  1940   02  DFHPF17   PIC  X  VALUE  'E'.
  1941   02  DFHPF18   PIC  X  VALUE  'F'.
  1942   02  DFHPF19   PIC  X  VALUE  'G'.
  1943   02  DFHPF20   PIC  X  VALUE  'H'.
  1944   02  DFHPF21   PIC  X  VALUE  'I'.
  1945*00039    02  DFHPF22   PIC  X  VALUE  ''.
  1946   02  DFHPF22   PIC  X  VALUE  '['.
  1947   02  DFHPF23   PIC  X  VALUE  '.'.
  1948   02  DFHPF24   PIC  X  VALUE  '<'.
  1949   02  DFHMSRE   PIC  X  VALUE  'X'.
  1950   02  DFHSTRF   PIC  X  VALUE  'h'.
  1951   02  DFHTRIG   PIC  X  VALUE  '"'.
  1952 01  FILLER  REDEFINES  DFHAID.
  1953     12  FILLER                  PIC  X(08).
  1954     12  PF-VALUES               PIC  X(01)  OCCURS 2.
  1955
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  38
* EL690.cbl
  1957*    COPY ELCATTR.
  1958******************************************************************
  1959*                                                                *
  1960*                            ELCATTR.                            *
  1961*                            VMOD=2.001                          *
  1962*                                                                *
  1963*             LIST OF STANDARD ATTRIBUTE VALUES                  *
  1964*                                                                *
  1965*   THE DATA NAMES IN THIS COPY BOOK WERE ASSIGNED AS FOLLOWS:   *
  1966*                                                                *
  1967*                   POS 1   P=PROTECTED                          *
  1968*                           U=UNPROTECTED                        *
  1969*                           S=ASKIP                              *
  1970*                   POS 2   A=ALPHA/NUMERIC                      *
  1971*                           N=NUMERIC                            *
  1972*                   POS 3   N=NORMAL                             *
  1973*                           B=BRIGHT                             *
  1974*                           D=DARK                               *
  1975*                   POS 4-5 ON=MODIFIED DATA TAG ON              *
  1976*                           OF=MODIFIED DATA TAG OFF             *
  1977*                                                                *
  1978*  NO  CID  MODS  IN  COPYBOOK  ELCATTR                          *
  1979******************************************************************
  1980 01  ATTRIBUTE-LIST.
  1981     12  AL-PABOF            PIC X       VALUE 'Y'.
  1982     12  AL-PABON            PIC X       VALUE 'Z'.
  1983     12  AL-PADOF            PIC X       VALUE '%'.
  1984     12  AL-PADON            PIC X       VALUE '_'.
  1985     12  AL-PANOF            PIC X       VALUE '-'.
  1986     12  AL-PANON            PIC X       VALUE '/'.
  1987     12  AL-SABOF            PIC X       VALUE '8'.
  1988     12  AL-SABON            PIC X       VALUE '9'.
  1989     12  AL-SADOF            PIC X       VALUE '@'.
  1990     12  AL-SADON            PIC X       VALUE QUOTE.
  1991     12  AL-SANOF            PIC X       VALUE '0'.
  1992     12  AL-SANON            PIC X       VALUE '1'.
  1993     12  AL-UABOF            PIC X       VALUE 'H'.
  1994     12  AL-UABON            PIC X       VALUE 'I'.
  1995     12  AL-UADOF            PIC X       VALUE '<'.
  1996     12  AL-UADON            PIC X       VALUE '('.
  1997     12  AL-UANOF            PIC X       VALUE ' '.
  1998     12  AL-UANON            PIC X       VALUE 'A'.
  1999     12  AL-UNBOF            PIC X       VALUE 'Q'.
  2000     12  AL-UNBON            PIC X       VALUE 'R'.
  2001     12  AL-UNDOF            PIC X       VALUE '*'.
  2002     12  AL-UNDON            PIC X       VALUE ')'.
  2003     12  AL-UNNOF            PIC X       VALUE '&'.
  2004     12  AL-UNNON            PIC X       VALUE 'J'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  39
* EL690.cbl
  2006*    COPY ELCDATE.
  2007******************************************************************
  2008*                                                                *
  2009*                                                                *
  2010*                            ELCDATE.                            *
  2011*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2012*                            VMOD=2.003
  2013*                                                                *
  2014*                                                                *
  2015*   DESCRIPTION:  DATA PASSED TO DATE CONVERSION ROUTINE.        *
  2016*                 LENGTH = 200                                   *
  2017******************************************************************
  2018
  2019 01  DATE-CONVERSION-DATA.
  2020     12  DC-COMM-LENGTH                PIC S9(4) COMP VALUE +200.
  2021     12  DC-OPTION-CODE                PIC X.
  2022         88  BIN-TO-GREG                VALUE ' '.
  2023         88  ELAPSED-BETWEEN-BIN        VALUE '1'.
  2024         88  EDIT-GREG-TO-BIN           VALUE '2'.
  2025         88  YMD-GREG-TO-BIN            VALUE '3'.
  2026         88  MDY-GREG-TO-BIN            VALUE '4'.
  2027         88  JULIAN-TO-BIN              VALUE '5'.
  2028         88  BIN-PLUS-ELAPSED           VALUE '6'.
  2029         88  FIND-CENTURY               VALUE '7'.
  2030         88  ELAPSED-BETWEEN-BIN-3      VALUE '8'.
  2031         88  EDIT-GREG-TO-BIN-3         VALUE '9'.
  2032         88  YMD-GREG-TO-BIN-3          VALUE 'A'.
  2033         88  MDY-GREG-TO-BIN-3          VALUE 'B'.
  2034         88  JULIAN-TO-BIN-3            VALUE 'C'.
  2035         88  BIN-PLUS-ELAPSED-3         VALUE 'D'.
  2036         88  JULIAN-EXPANDED-TO-BIN     VALUE 'E'.
  2037         88  JULIAN-EXPANDED-TO-BIN-3   VALUE 'F'.
  2038         88  BIN-TO-JULIAN-EXPANDED     VALUE 'G'.
  2039         88  JULIAN-EXPANDED            VALUE 'E', 'F', 'G'.
  2040         88  CHECK-LEAP-YEAR            VALUE 'H'.
  2041         88  BIN-3-TO-GREG              VALUE 'I'.
  2042         88  CYMD-GREG-TO-BIN-3         VALUE 'J'.
  2043         88  MDCY-GREG-TO-BIN-3         VALUE 'K'.
  2044         88  CYMD-GREG-TO-BIN           VALUE 'L'.
  2045         88  MDCY-GREG-TO-BIN           VALUE 'M'.
  2046         88  MDY-GREG-TO-JULIAN         VALUE 'N'.
  2047         88  MDCY-GREG-TO-JULIAN        VALUE 'O'.
  2048         88  YMD-GREG-TO-JULIAN         VALUE 'P'.
  2049         88  CYMD-GREG-TO-JULIAN        VALUE 'Q'.
  2050         88  THREE-CHARACTER-BIN
  2051                  VALUES  '8' '9' 'A' 'B' 'C' 'D' 'I' 'J' 'K'.
  2052         88  GREGORIAN-TO-BIN
  2053                  VALUES '2' '3' '4' '9' 'A' 'B' 'J' 'K' 'L' 'M'.
  2054         88  BIN-TO-GREGORIAN
  2055                  VALUES ' ' '1' 'I' '8' 'G'.
  2056         88  JULIAN-TO-BINARY
  2057                  VALUES '5' 'C' 'E' 'F'.
  2058     12  DC-ERROR-CODE                 PIC X.
  2059         88  NO-CONVERSION-ERROR        VALUE ' '.
  2060         88  DATE-CONVERSION-ERROR
  2061                  VALUES '1' '2' '3' '4' '5' '9' 'A' 'B' 'C'.
  2062         88  DATE-IS-ZERO               VALUE '1'.
  2063         88  DATE-IS-NON-NUMERIC        VALUE '2'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  40
* EL690.cbl
  2064         88  DATE-IS-INVALID            VALUE '3'.
  2065         88  DATE1-GREATER-DATE2        VALUE '4'.
  2066         88  ELAPSED-PLUS-NEGATIVE      VALUE '5'.
  2067         88  DATE-INVALID-OPTION        VALUE '9'.
  2068         88  INVALID-CENTURY            VALUE 'A'.
  2069         88  ONLY-CENTURY               VALUE 'B'.
  2070         88  ONLY-LEAP-YEAR             VALUE 'C'.
  2071         88  VALID-CENTURY-LEAP-YEAR    VALUE 'B', 'C'.
  2072     12  DC-END-OF-MONTH               PIC X.
  2073         88  CALCULATE-END-OF-MONTH     VALUE '1'.
  2074     12  DC-CENTURY-ADJUSTMENT         PIC X   VALUE SPACES.
  2075         88  USE-NORMAL-PROCESS         VALUE ' '.
  2076         88  ADJUST-DOWN-100-YRS        VALUE '1'.
  2077         88  ADJUST-UP-100-YRS          VALUE '2'.
  2078     12  FILLER                        PIC X.
  2079     12  DC-CONVERSION-DATES.
  2080         16  DC-BIN-DATE-1             PIC XX.
  2081         16  DC-BIN-DATE-2             PIC XX.
  2082         16  DC-GREG-DATE-1-EDIT       PIC X(08).
  2083         16  DC-GREG-DATE-1-EDIT-R REDEFINES
  2084                       DC-GREG-DATE-1-EDIT.
  2085             20  DC-EDIT1-MONTH        PIC 99.
  2086             20  SLASH1-1              PIC X.
  2087             20  DC-EDIT1-DAY          PIC 99.
  2088             20  SLASH1-2              PIC X.
  2089             20  DC-EDIT1-YEAR         PIC 99.
  2090         16  DC-GREG-DATE-2-EDIT       PIC X(08).
  2091         16  DC-GREG-DATE-2-EDIT-R REDEFINES
  2092                     DC-GREG-DATE-2-EDIT.
  2093             20  DC-EDIT2-MONTH        PIC 99.
  2094             20  SLASH2-1              PIC X.
  2095             20  DC-EDIT2-DAY          PIC 99.
  2096             20  SLASH2-2              PIC X.
  2097             20  DC-EDIT2-YEAR         PIC 99.
  2098         16  DC-GREG-DATE-1-YMD        PIC 9(06).
  2099         16  DC-GREG-DATE-1-YMD-R  REDEFINES
  2100                     DC-GREG-DATE-1-YMD.
  2101             20  DC-YMD-YEAR           PIC 99.
  2102             20  DC-YMD-MONTH          PIC 99.
  2103             20  DC-YMD-DAY            PIC 99.
  2104         16  DC-GREG-DATE-1-MDY        PIC 9(06).
  2105         16  DC-GREG-DATE-1-MDY-R REDEFINES
  2106                      DC-GREG-DATE-1-MDY.
  2107             20  DC-MDY-MONTH          PIC 99.
  2108             20  DC-MDY-DAY            PIC 99.
  2109             20  DC-MDY-YEAR           PIC 99.
  2110         16  DC-GREG-DATE-1-ALPHA.
  2111             20  DC-ALPHA-MONTH        PIC X(10).
  2112             20  DC-ALPHA-DAY          PIC 99.
  2113             20  FILLER                PIC XX.
  2114             20  DC-ALPHA-CENTURY.
  2115                 24 DC-ALPHA-CEN-N     PIC 99.
  2116             20  DC-ALPHA-YEAR         PIC 99.
  2117         16  DC-ELAPSED-MONTHS         PIC S9(4)     COMP.
  2118         16  DC-ODD-DAYS-OVER          PIC S9(4)     COMP.
  2119         16  DC-ELAPSED-DAYS           PIC S9(4)     COMP.
  2120         16  DC-JULIAN-DATE            PIC 9(05).
  2121         16  DC-JULIAN-YYDDD REDEFINES DC-JULIAN-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  41
* EL690.cbl
  2122                                       PIC 9(05).
  2123         16  DC-JULIAN-DT REDEFINES DC-JULIAN-DATE.
  2124             20  DC-JULIAN-YEAR        PIC 99.
  2125             20  DC-JULIAN-DAYS        PIC 999.
  2126         16  DC-DAYS-IN-MONTH          PIC S9(3)       COMP-3.
  2127         16  DC-DAY-OF-WEEK            PIC S9  VALUE ZERO COMP-3.
  2128         16  DC-DAY-OF-WEEK2           PIC S9  VALUE ZERO COMP-3.
  2129     12  DATE-CONVERSION-VARIBLES.
  2130         16  HOLD-CENTURY-1            PIC 9(11) VALUE 0.
  2131         16  HOLD-CENTURY-1-SPLIT REDEFINES HOLD-CENTURY-1.
  2132             20  FILLER                PIC 9(3).
  2133             20  HOLD-CEN-1-CCYY.
  2134                 24  HOLD-CEN-1-CC     PIC 99.
  2135                 24  HOLD-CEN-1-YY     PIC 99.
  2136             20  HOLD-CEN-1-MO         PIC 99.
  2137             20  HOLD-CEN-1-DA         PIC 99.
  2138         16  HOLD-CENTURY-1-R   REDEFINES HOLD-CENTURY-1.
  2139             20  HOLD-CEN-1-R-MO       PIC 99.
  2140             20  HOLD-CEN-1-R-DA       PIC 99.
  2141             20  HOLD-CEN-1-R-CCYY.
  2142                 24  HOLD-CEN-1-R-CC   PIC 99.
  2143                 24  HOLD-CEN-1-R-YY   PIC 99.
  2144             20  FILLER                PIC 9(3).
  2145         16  HOLD-CENTURY-1-X.
  2146             20  FILLER                PIC X(3)  VALUE SPACES.
  2147             20  HOLD-CEN-1-X-CCYY.
  2148                 24  HOLD-CEN-1-X-CC   PIC XX VALUE SPACES.
  2149                 24  HOLD-CEN-1-X-YY   PIC XX VALUE SPACES.
  2150             20  HOLD-CEN-1-X-MO       PIC XX VALUE SPACES.
  2151             20  HOLD-CEN-1-X-DA       PIC XX VALUE SPACES.
  2152         16  HOLD-CENTURY-1-R-X REDEFINES HOLD-CENTURY-1-X.
  2153             20  HOLD-CEN-1-R-X-MO     PIC XX.
  2154             20  HOLD-CEN-1-R-X-DA     PIC XX.
  2155             20  HOLD-CEN-1-R-X-CCYY.
  2156                 24  HOLD-CEN-1-R-X-CC PIC XX.
  2157                 24  HOLD-CEN-1-R-X-YY PIC XX.
  2158             20  FILLER                PIC XXX.
  2159         16  DC-BIN-DATE-EXPAND-1      PIC XXX.
  2160         16  DC-BIN-DATE-EXPAND-2      PIC XXX.
  2161         16  DC-JULIAN-DATE-1          PIC 9(07).
  2162         16  DC-JULIAN-DATE-1-R REDEFINES DC-JULIAN-DATE-1.
  2163             20  DC-JULIAN-1-CCYY.
  2164                 24  DC-JULIAN-1-CC    PIC 99.
  2165                 24  DC-JULIAN-1-YR    PIC 99.
  2166             20  DC-JULIAN-DA-1        PIC 999.
  2167         16  DC-JULIAN-DATE-2          PIC 9(07).
  2168         16  DC-JULIAN-DATE-2-R REDEFINES DC-JULIAN-DATE-2.
  2169             20  DC-JULIAN-2-CCYY.
  2170                 24  DC-JULIAN-2-CC    PIC 99.
  2171                 24  DC-JULIAN-2-YR    PIC 99.
  2172             20  DC-JULIAN-DA-2        PIC 999.
  2173         16  DC-GREG-DATE-A-EDIT.
  2174             20  DC-EDITA-MONTH        PIC 99.
  2175             20  SLASHA-1              PIC X VALUE '/'.
  2176             20  DC-EDITA-DAY          PIC 99.
  2177             20  SLASHA-2              PIC X VALUE '/'.
  2178             20  DC-EDITA-CCYY.
  2179                 24  DC-EDITA-CENT     PIC 99.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  42
* EL690.cbl
  2180                 24  DC-EDITA-YEAR     PIC 99.
  2181         16  DC-GREG-DATE-B-EDIT.
  2182             20  DC-EDITB-MONTH        PIC 99.
  2183             20  SLASHB-1              PIC X VALUE '/'.
  2184             20  DC-EDITB-DAY          PIC 99.
  2185             20  SLASHB-2              PIC X VALUE '/'.
  2186             20  DC-EDITB-CCYY.
  2187                 24  DC-EDITB-CENT     PIC 99.
  2188                 24  DC-EDITB-YEAR     PIC 99.
  2189         16  DC-GREG-DATE-CYMD         PIC 9(08).
  2190         16  DC-GREG-DATE-CYMD-R REDEFINES
  2191                              DC-GREG-DATE-CYMD.
  2192             20  DC-CYMD-CEN           PIC 99.
  2193             20  DC-CYMD-YEAR          PIC 99.
  2194             20  DC-CYMD-MONTH         PIC 99.
  2195             20  DC-CYMD-DAY           PIC 99.
  2196         16  DC-GREG-DATE-MDCY         PIC 9(08).
  2197         16  DC-GREG-DATE-MDCY-R REDEFINES
  2198                              DC-GREG-DATE-MDCY.
  2199             20  DC-MDCY-MONTH         PIC 99.
  2200             20  DC-MDCY-DAY           PIC 99.
  2201             20  DC-MDCY-CEN           PIC 99.
  2202             20  DC-MDCY-YEAR          PIC 99.
  2203    12  DC-FORCE-EL310-DATE-SW         PIC X    VALUE SPACE.
  2204        88  DC-FORCE-EL310-DATE                 VALUE 'Y'.
  2205    12  DC-EL310-DATE                  PIC X(21).
  2206    12  FILLER                         PIC X(28).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  43
* EL690.cbl
  2208*    COPY ELCEMIB.
  2209******************************************************************
  2210*                                                                *
  2211*                                                                *
  2212*                            ELCEMIB.                            *
  2213*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2214*                            VMOD=2.005                          *
  2215*                                                                *
  2216*    STANDARD CLAS-IC ERROR MESSAGE COMMUNICATIONS AREA          *
  2217*                                                                *
  2218******************************************************************
  2219 01  ERROR-MESSAGE-INTERFACE-BLOCK.
  2220     12  EMI-COMM-LENGTH         PIC S9(4)    VALUE +400 COMP.
  2221     12  EMI-NUMBER-OF-LINES     PIC 9        VALUE 1.
  2222     12  EMI-ERROR               PIC 9(4)     VALUE ZEROS.
  2223     12  EMI-SUB                 PIC 99       VALUE 1 COMP-3.
  2224     12  EMI-NOTE-CTR            PIC 999      VALUE 0 COMP-3.
  2225     12  EMI-WARNING-CTR         PIC 999      VALUE 0 COMP-3.
  2226     12  EMI-FORCABLE-CTR        PIC 999      VALUE 0 COMP-3.
  2227     12  EMI-FATAL-CTR           PIC 999      VALUE 0 COMP-3.
  2228     12  EMI-SWITCH1             PIC X        VALUE '1'.
  2229         88  EMI-NO-ERRORS                    VALUE '1'.
  2230         88  EMI-ERRORS-NOT-COMPLETE          VALUE '2'.
  2231         88  EMI-ERRORS-COMPLETE              VALUE '3'.
  2232     12  EMI-SWITCH2             PIC X        VALUE '1'.
  2233         88  EMI-FORMAT-CODES-ONLY            VALUE '2'.
  2234     12  EMI-SWITCH-AREA-1       PIC X        VALUE '1'.
  2235         88  EMI-AREA1-EMPTY                  VALUE '1'.
  2236         88  EMI-AREA1-FULL                   VALUE '2'.
  2237     12  EMI-SWITCH-AREA-2       PIC X        VALUE '1'.
  2238         88  EMI-AREA2-EMPTY                  VALUE '1'.
  2239         88  EMI-AREA2-FULL                   VALUE '2'.
  2240     12  EMI-ACTION-SWITCH       PIC X        VALUE ' '.
  2241         88  EMI-PROCESS-ALL-ERRORS           VALUE ' '.
  2242         88  EMI-BYPASS-NOTES                 VALUE 'N'.
  2243         88  EMI-BYPASS-WARNINGS              VALUE 'W'.
  2244         88  EMI-BYPASS-FORCABLES             VALUE 'F'.
  2245         88  EMI-BYPASS-FATALS                VALUE 'X'.
  2246     12  EMI-ERROR-LINES.
  2247         16  EMI-LINE1           PIC X(72)   VALUE SPACES.
  2248         16  EMI-LINE2           PIC X(72)   VALUE SPACES.
  2249         16  EMI-LINE3           PIC X(72)   VALUE SPACES.
  2250         16  EMI-CODE-LINE REDEFINES EMI-LINE3.
  2251             20  EMI-ERR-CODES OCCURS 10 TIMES.
  2252                 24  EMI-ERR-NUM         PIC X(4).
  2253                 24  EMI-FILLER          PIC X.
  2254                 24  EMI-SEV             PIC X.
  2255                 24  FILLER              PIC X.
  2256             20  FILLER                  PIC X(02).
  2257     12  EMI-ERR-LINES REDEFINES EMI-ERROR-LINES.
  2258         16  EMI-MESSAGE-AREA OCCURS 3 TIMES INDEXED BY EMI-INDX.
  2259             20  EMI-ERROR-NUMBER    PIC X(4).
  2260             20  EMI-FILL            PIC X.
  2261             20  EMI-SEVERITY        PIC X.
  2262             20  FILLER              PIC X.
  2263             20  EMI-ERROR-TEXT.
  2264                 24  EMI-TEXT-VARIABLE   PIC X(10).
  2265                 24  FILLER          PIC X(55).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  44
* EL690.cbl
  2266     12  EMI-SEVERITY-SAVE           PIC X.
  2267         88  EMI-NOTE                    VALUE 'N'.
  2268         88  EMI-WARNING                 VALUE 'W'.
  2269         88  EMI-FORCABLE                VALUE 'F'.
  2270         88  EMI-FATAL                   VALUE 'X'.
  2271     12  EMI-MESSAGE-FLAG            PIC X.
  2272         88  EMI-MESSAGE-FORMATTED       VALUE 'Y'.
  2273         88  EMI-NO-MESSAGE-FORMATTED    VALUE 'N'.
  2274     12  EMI-ROLL-SWITCH             PIC X       VALUE SPACES.
  2275     12  EMI-LANGUAGE-IND            PIC X       VALUE SPACES.
  2276         88  EMI-LANGUAGE-IS-FR                  VALUE 'F'.
  2277         88  EMI-LANGUAGE-IS-ENG                 VALUE 'E'.
  2278         88  EMI-LANGUAGE-IS-SPAN                VALUE 'S'.
  2279     12  emi-claim-no                pic x(7).
  2280     12  emi-claim-type              pic x(6).
  2281     12  FILLER                      PIC X(124)  VALUE SPACES.
  2282     12  EMI-DATE-FIELD              PIC X(06)   VALUE SPACES.
  2283     12  EMI-CLIENT-ID               PIC X(3)    VALUE SPACES.
  2284     12  EMI-LIFE-OVERRIDE-L6        PIC X(6).
  2285     12  EMI-AH-OVERRIDE-L6          PIC X(6).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  45
* EL690.cbl
  2287*    COPY ELCLOGOF.
  2288******************************************************************
  2289*                                                                *
  2290*                                                                *
  2291*                            ELCLOGOF.                           *
  2292*                            VMOD=2.001                          *
  2293*                                                                *
  2294*             STANDARD CLAS-IC LOGOFF TEXT AREA                  *
  2295*                                                                *
  2296******************************************************************
  2297 01  CLASIC-LOGOFF.
  2298     12  LOGOFF-LENGTH       PIC S9(4)   VALUE +185   COMP.
  2299     12  LOGOFF-TEXT.
  2300         16  FILLER          PIC X(5)    VALUE SPACES.
  2301         16  LOGOFF-MSG.
  2302             20  LOGOFF-PGM  PIC X(8)    VALUE SPACES.
  2303             20  FILLER      PIC X       VALUE SPACES.
  2304             20  LOGOFF-FILL PIC X(66)   VALUE SPACES.
  2305         16  FILLER          PIC X(80)
  2306           VALUE '* YOU ARE NOW LOGGED OFF'.
  2307         16  FILLER          PIC X(7)    VALUE '* LOGIC'.
  2308         16  FILLER          PIC X       VALUE QUOTE.
  2309         16  LOGOFF-SYS-MSG  PIC X(17)
  2310           VALUE 'S CLAS-IC SYSTEM '.
  2311     12  TEXT-MESSAGES.
  2312         16  UNACCESS-MSG    PIC X(29)
  2313             VALUE  'UNAUTHORIZED ACCESS ATTEMPTED'.
  2314         16  PGMIDERR-MSG    PIC X(17)
  2315             VALUE 'PROGRAM NOT FOUND'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  46
* EL690.cbl
  2317*    COPY ELCSCTM.
  2318******************************************************************
  2319*                                                                *
  2320*                                                                *
  2321*                            ELCSCTM                             *
  2322*                            VMOD=2.001                          *
  2323*                                                                *
  2324*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY MESSAGE AREA     *
  2325*                                                                *
  2326******************************************************************
  2327 01  SECURITY-MESSAGE.
  2328     12  FILLER                          PIC X(30)
  2329            VALUE '** LOGIC SECURITY VIOLATION -'.
  2330     12  SM-READ                         PIC X(6).
  2331     12  FILLER                          PIC X(5)
  2332            VALUE ' PGM='.
  2333     12  SM-PGM                          PIC X(6).
  2334     12  FILLER                          PIC X(5)
  2335            VALUE ' OPR='.
  2336     12  SM-PROCESSOR-ID                 PIC X(4).
  2337     12  FILLER                          PIC X(6)
  2338            VALUE ' TERM='.
  2339     12  SM-TERMID                       PIC X(4).
  2340     12  FILLER                          PIC XX   VALUE SPACE.
  2341     12  SM-JUL-DATE                     PIC 9(5).
  2342     12  FILLER                          PIC X    VALUE SPACE.
  2343     12  SM-TIME                         PIC 99.99.
  2344
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  47
* EL690.cbl
  2346*    COPY ELCSCRTY.
  2347******************************************************************
  2348*                                                                *
  2349*                                                                *
  2350*                            ELCSCRTY                            *
  2351*                            VMOD=2.001                          *
  2352*                                                                *
  2353*   FILE DESCRIPTION = C.I.C.S. COMMON SECURITY DATA AREA        *
  2354*        AREA ACQUIRED BY SIGN ON PROGRAM EL125 AND ADDRESS      *
  2355*        SAVED IN PI-SECURITY-ADDRESS.                           *
  2356*                                                                *
  2357******************************************************************
  2358 01  SECURITY-CONTROL.
  2359     12  SC-COMM-LENGTH               PIC S9(4) VALUE +144 COMP.
  2360     12  FILLER                       PIC XX    VALUE 'SC'.
  2361     12  SC-CREDIT-CODES.
  2362         16  SC-CREDIT-AUTHORIZATION OCCURS 40 TIMES.
  2363             20  SC-CREDIT-DISPLAY    PIC X.
  2364             20  SC-CREDIT-UPDATE     PIC X.
  2365     12  SC-CLAIMS-CODES.
  2366         16  SC-CLAIMS-AUTHORIZATION OCCURS 30 TIMES.
  2367             20  SC-CLAIMS-DISPLAY    PIC X.
  2368             20  SC-CLAIMS-UPDATE     PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  48
* EL690.cbl
  2370****************************************************************
  2371*
  2372* Copyright (c) 2007-2013 Dell Inc.
  2373* All rights reserved.
  2374*
  2375****************************************************************
  2376 01  DFHEIV.
  2377   02  DFHEIV0               PIC X(35).
  2378   02  DFHEIV1               PIC X(08).
  2379   02  DFHEIV2               PIC X(08).
  2380   02  DFHEIV3               PIC X(08).
  2381   02  DFHEIV4               PIC X(06).
  2382   02  DFHEIV5               PIC X(04).
  2383   02  DFHEIV6               PIC X(04).
  2384   02  DFHEIV7               PIC X(02).
  2385   02  DFHEIV8               PIC X(02).
  2386   02  DFHEIV9               PIC X(01).
  2387   02  DFHEIV10              PIC S9(7) COMP-3.
  2388   02  DFHEIV11              PIC S9(4) COMP SYNC.
  2389   02  DFHEIV12              PIC S9(4) COMP SYNC.
  2390   02  DFHEIV13              PIC S9(4) COMP SYNC.
  2391   02  DFHEIV14              PIC S9(4) COMP SYNC.
  2392   02  DFHEIV15              PIC S9(4) COMP SYNC.
  2393   02  DFHEIV16              PIC S9(9) COMP SYNC.
  2394   02  DFHEIV17              PIC X(04).
  2395   02  DFHEIV18              PIC X(04).
  2396   02  DFHEIV19              PIC X(04).
  2397   02  DFHEIV20              USAGE IS POINTER.
  2398   02  DFHEIV21              USAGE IS POINTER.
  2399   02  DFHEIV22              USAGE IS POINTER.
  2400   02  DFHEIV23              USAGE IS POINTER.
  2401   02  DFHEIV24              USAGE IS POINTER.
  2402   02  DFHEIV25              PIC S9(9) COMP SYNC.
  2403   02  DFHEIV26              PIC S9(9) COMP SYNC.
  2404   02  DFHEIV27              PIC S9(9) COMP SYNC.
  2405   02  DFHEIV28              PIC S9(9) COMP SYNC.
  2406   02  DFHEIV29              PIC S9(9) COMP SYNC.
  2407   02  DFHEIV30              PIC S9(9) COMP SYNC.
  2408   02  DFHEIV31              PIC S9(9) COMP SYNC.
  2409   02  DFHEIV32              PIC S9(4) COMP SYNC.
  2410   02  DFHEIV33              PIC S9(4) COMP SYNC.
  2411   02  DFHEIV34              PIC S9(4) COMP SYNC.
  2412   02  DFHEIV35              PIC S9(4) COMP SYNC.
  2413   02  DFHEIV97              PIC S9(7) COMP-3 VALUE ZERO.
  2414   02  DFHEIV98              PIC S9(4) COMP SYNC VALUE ZERO.
  2415   02  FILLER                PIC X(02).
  2416   02  DFHEIV99              PIC X(08) VALUE SPACE.
  2417   02  DFHEIVL0              PIC X(48) VALUE SPACE.
  2418   02  DFHEIVL1              PIC X(48) VALUE SPACE.
  2419   02  DFHEIVL2              PIC X(48) VALUE SPACE.
  2420   02  DFHEIVL3              PIC X(48) VALUE SPACE.
  2421   02  DFHEIVL4              PIC X(255) VALUE SPACE.
  2422   02  DFHEIVL5              PIC X(255) VALUE SPACE.
  2423 LINKAGE  SECTION.
  2424*****************************************************************
  2425*                                                               *
  2426* Copyright (c) 2007-2013 Dell Inc.                             *
  2427* All rights reserved.                                          *
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  49
* EL690.cbl
  2428*                                                               *
  2429*****************************************************************
  2430 01  dfheiblk.
  2431     02  eibtime          pic s9(7) comp-3.
  2432     02  eibdate          pic s9(7) comp-3.
  2433     02  eibtrnid         pic x(4).
  2434     02  eibtaskn         pic s9(7) comp-3.
  2435     02  eibtrmid         pic x(4).
  2436     02  dfheigdi         pic s9(4) comp.
  2437     02  eibcposn         pic s9(4) comp.
  2438     02  eibcalen         pic s9(4) comp.
  2439     02  eibaid           pic x(1).
  2440     02  eibfiller1       pic x(1).
  2441     02  eibfn            pic x(2).
  2442     02  eibfiller2       pic x(2).
  2443     02  eibrcode         pic x(6).
  2444     02  eibfiller3       pic x(2).
  2445     02  eibds            pic x(8).
  2446     02  eibreqid         pic x(8).
  2447     02  eibrsrce         pic x(8).
  2448     02  eibsync          pic x(1).
  2449     02  eibfree          pic x(1).
  2450     02  eibrecv          pic x(1).
  2451     02  eibsend          pic x(1).
  2452     02  eibatt           pic x(1).
  2453     02  eibeoc           pic x(1).
  2454     02  eibfmh           pic x(1).
  2455     02  eibcompl         pic x(1).
  2456     02  eibsig           pic x(1).
  2457     02  eibconf          pic x(1).
  2458     02  eiberr           pic x(1).
  2459     02  eibrldbk         pic x(1).
  2460     02  eiberrcd         pic x(4).
  2461     02  eibsynrb         pic x(1).
  2462     02  eibnodat         pic x(1).
  2463     02  eibfiller5       pic x(2).
  2464     02  eibresp          pic s9(8) comp.
  2465     02  eibresp2         pic s9(8) comp.
  2466     02  dfheigdj         pic s9(4) comp.
  2467     02  dfheigdk         pic s9(4) comp.
  2468 01  DFHCOMMAREA                 PIC X(1024).
  2469
  2470*01 PARMLIST .
  2471*    12  FILLER                  PIC S9(8)   COMP.
  2472*    12  L-ARCH-POINTER          PIC S9(8)   COMP.
  2473*    12  L-ARCT-POINTER          PIC S9(8)   COMP.
  2474*    12  L-CNTL-POINTER          PIC S9(8)   COMP.
  2475
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  50
* EL690.cbl
  2477*    COPY ERCARCH.
  2478******************************************************************
  2479*                                                                *
  2480*                            ERCARCH.                            *
  2481*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2482*                            VMOD=2.002                          *
  2483*                                                                *
  2484*   FILE DESCRIPTION = LETTERS SENT TO ARCHIVE FILE              *
  2485*                                                                *
  2486*   FILE TYPE = VSAM,KSDS                                        *
  2487*   RECORD SIZE = 250  RECFORM = FIXED                           *
  2488*                                                                *
  2489*   BASE CLUSTER = ERARCH                        RKP=2,LEN=5     *
  2490*     ALTERNATE PATH1 = ERARCH2 (CERT/RESP)      RKP=07,LEN=35   *
  2491*     ALTERNATE PATH2 = ERARCH3 (FORM NUMBER)    RKP=44,LEN=28   *
  2492*     ALTERNATE PATH3 = ERARCH4 (PROCCESSOR ID)  RKP=73,LEN=28   *
  2493*     ALTERNATE PATH4 = ERARCH5 (ACCOUNT KEY)    RKP=100,LEN=24  *
  2494*     ALTERNATE PATH5 = ERARCH6 (BTCH/CHK KEY)   RKP=124,LEN=11  *
  2495*                                                                *
  2496*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2497******************************************************************
  2498*                   C H A N G E   L O G
  2499*
  2500* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2501*-----------------------------------------------------------------
  2502*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2503* EFFECTIVE    NUMBER
  2504*-----------------------------------------------------------------
  2505* 031011  CR2007070900001  PEMA  ADD FOLLOW-UP LETTER PROCESSING
  2506* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2507* 110612    2012101700002  AJRA  ADD NEW FIELDS
  2508* 102918  CR2018080300002  PEMA  ADD ONBASE STUFF
  2509******************************************************************
  2510 01  LETTER-ARCHIVE.
  2511     12  LA-RECORD-ID                PIC  X(02).
  2512         88  LA-VALID-ID                VALUE 'LA'.
  2513
  2514     12  LA-CONTROL-PRIMARY.
  2515         16  LA-COMPANY-CD           PIC  X(01).
  2516         16  LA-ARCHIVE-NO           PIC S9(08)    COMP.
  2517
  2518     12  LA-CONTROL-BY-CERT-RESP.
  2519         16  LA-COMPANY-CD-A2        PIC  X(01).
  2520         16  LA-CERT-NO-A2.
  2521             20  LA-CERT-PRIME-A2    PIC  X(10).
  2522             20  LA-CERT-SUFFIX-A2   PIC  X(01).
  2523         16  LA-RSP-PERSON-A2 REDEFINES LA-CERT-NO-A2.
  2524             20  LA-RESP-PERSON-A2   PIC  X(10).
  2525             20  LA-TYPE-A2          PIC  X(01).
  2526         16  LA-CARRIER-A2           PIC  X(01).
  2527         16  LA-GROUPING-A2          PIC  X(06).
  2528         16  LA-STATE-A2             PIC  X(02).
  2529         16  LA-ACCOUNT-A2           PIC  X(10).
  2530         16  LA-EFFECT-DATE-A2       PIC  X(02).
  2531         16  LA-ARCHIVE-NO-A2        PIC S9(08)    COMP.
  2532
  2533     12  LA-CONTROL-BY-FORM.
  2534         16  LA-COMPANY-CD-A3        PIC  X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  51
* EL690.cbl
  2535         16  LA-FORM-A3              PIC  X(04).
  2536         16  LA-CARRIER-A3           PIC  X(01).
  2537         16  LA-GROUPING-A3          PIC  X(06).
  2538         16  LA-STATE-A3             PIC  X(02).
  2539         16  LA-ACCOUNT-A3           PIC  X(10).
  2540         16  LA-ARCHIVE-NO-A3        PIC S9(08)    COMP.
  2541
  2542     12  LA-CONTROL-BY-PROCESSOR.
  2543         16  LA-COMPANY-CD-A4        PIC  X(01).
  2544         16  LA-PROCESSOR-CD         PIC  X(04).
  2545         16  LA-CARRIER-A4           PIC  X(01).
  2546         16  LA-GROUPING-A4          PIC  X(06).
  2547         16  LA-STATE-A4             PIC  X(02).
  2548         16  LA-ACCOUNT-A4           PIC  X(10).
  2549         16  LA-ARCHIVE-NO-A4        PIC S9(08)    COMP.
  2550
  2551     12  LA-CONTROL-BY-KEY-FIELDS.
  2552         16  LA-COMPANY-CD-A5        PIC  X(01).
  2553         16  LA-CARRIER-A5           PIC  X(01).
  2554         16  LA-GROUPING-A5          PIC  X(06).
  2555         16  LA-STATE-A5             PIC  X(02).
  2556         16  LA-ACCOUNT-A5           PIC  X(10).
  2557         16  LA-ARCHIVE-NO-A5        PIC S9(08)    COMP.
  2558
  2559     12  LA-CONTROL-BY-GROUP-CODE.
  2560         16  LA-COMPANY-CD-A6        PIC  X(01).
  2561         16  LA-ENTRY-A6.
  2562             20  LA-FILLER           PIC  X(02).
  2563             20  LA-QUE-CONTROL-A6   PIC S9(08)    COMP.
  2564         16  LA-ARCHIVE-NO-A6        PIC S9(08)    COMP.
  2565
  2566     12  FILLER                      PIC  X(09).
  2567
  2568     12  LA-HEADER-RECORD.
  2569         16  LA-NUMBER-LABEL-LINES   PIC S9(04)    COMP.
  2570         16  LA-CREATION-DATE        PIC  X(02).
  2571         16  LA-FOLLOW-UP-DATE       PIC  X(02).
  2572         16  LA-FINAL-ACT-DATE       REDEFINES
  2573               LA-FOLLOW-UP-DATE     PIC  X(02).
  2574         16  LA-INITIAL-PRINT-DATE   PIC  X(02).
  2575         16  LA-NO-OF-COPIES         PIC S9(01).
  2576         16  LA-NO-OF-TEXT-RECORDS   PIC S9(04)    COMP.
  2577         16  LA-REPLY-DATE           PIC  X(02).
  2578         16  LA-RESEND-DATES.
  2579             20  LA-RESEND-DATE      PIC  X(02).
  2580             20  LA-SENT-DATE        PIC  X(02).
  2581             20  FILLER              PIC  X(08).
  2582         16  LA-SOURCE-INFORMATION.
  2583             20  LA-DATA-SOURCE      PIC  X(01).
  2584             20  LA-ADDR-SOURCE      PIC  X(01).
  2585         16  LA-STATUS               PIC  X(01).
  2586             88  LA-STATUS-ACTIVE         VALUE 'A'.
  2587             88  LA-STATUS-COMPLETED      VALUE 'C'.
  2588             88  LA-STATUS-ON-HOLD        VALUE 'H'.
  2589             88  LA-STATUS-TO-BE-PURGED   VALUE 'X'.
  2590             88  LA-STATUS-PURGED         VALUE 'P'.
  2591             88  LA-STATUS-VOIDED         VALUE 'V'.
  2592         16  LA-LAST-RESENT-PRINT-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  52
* EL690.cbl
  2593                                     PIC  X(02).
  2594         16  LA-PRINT-RESTRICTION    PIC  X(01).
  2595             88  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  2596                                          VALUE 'C'.
  2597             88  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  2598                                          VALUE 'F'.
  2599             88  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  2600                                          VALUE 'P'.
  2601         16  LA-PURGED-DATE          PIC  X(02).
  2602         16  LA-VOIDED-DATE          PIC  X(02).
  2603         16  LA-RESEND-LETR          PIC  X(4).
  2604         16  LA-VOID-ONBASE-YN       PIC  X.
  2605         16  LA-ONBASE-UNIQUE-ID     PIC S9(5) COMP-3.
  2606         16  FILLER                  PIC  X(04).
  2607*        16  LA-RESEND-LETR-2        PIC  X(4).
  2608*        16  LA-RESEND-LETR-3        PIC  X(4).
  2609*        16  FILLER                  PIC  X(59).
  2610         16  LA-ARCHIVE-STATUS       PIC  X.
  2611             88  LA-TEMP                VALUE 'T'.
  2612             88  LA-QWS                 VALUE 'Q'.
  2613             88  LA-BATCH               VALUE 'B'.
  2614         16  LA-FINAL-ACT-IND        PIC  X(1).
  2615         16  LA-VA-DISCLOSURE-IND    PIC  X(1).
  2616         16  LA-ENDT-ARCH-NO         PIC S9(8) COMP.
  2617         16  LA-ENDT-ARCH-NO-X REDEFINES LA-ENDT-ARCH-NO
  2618                                     PIC X(4).
  2619         16  FILLER                  PIC  X(42).
  2620*        16  FILLER                  PIC  X(71).
  2621         16  LA-LAST-MAINT-DATE      PIC  X(2).
  2622         16  LA-LAST-MAINT-TIME      PIC S9(6) COMP-3.
  2623         16  LA-LAST-MAINT-TIMEX  REDEFINES LA-LAST-MAINT-TIME
  2624                                     PIC  X(4).
  2625         16  LA-LAST-UPDATED-BY      PIC  X(4).
  2626
  2627******************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  53
* EL690.cbl
  2629*    COPY ERCARCT.
  2630******************************************************************
  2631*                                                                *
  2632*                            ERCARCT.                            *
  2633*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2634*                            VMOD=2.002                          *
  2635*                                                                *
  2636*   FILE DESCRIPTION = TEXT OF ARCHIVED LETTERDS                 *
  2637*                                                                *
  2638*   FILE TYPE = VSAM,KSDS                                        *
  2639*   RECORD SIZE = 1640  RECFORM = FIXED                          *
  2640*                                                                *
  2641*   BASE CLUSTER = ERARCT                        RKP=2,LEN=8     *
  2642*                                                                *
  2643*   LOG = NO                                                     *
  2644*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2645******************************************************************
  2646*                   C H A N G E   L O G
  2647*
  2648* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2649*-----------------------------------------------------------------
  2650*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2651* EFFECTIVE    NUMBER
  2652*-----------------------------------------------------------------
  2653* 070711  CR2011022800001  AJRA  NAPERSOFT CHANGES
  2654******************************************************************
  2655 01  LETTER-ARCHIVE-TEXT.
  2656     12  LT-RECORD-ID                PIC  X(02).
  2657         88  LT-VALID-ID                VALUE 'LT'.
  2658
  2659     12  LT-CONTROL-PRIMARY.
  2660         16  LT-COMPANY-CD           PIC  X(01).
  2661         16  LT-ARCHIVE-NO           PIC S9(08)    COMP.
  2662         16  LT-RECORD-TYPE          PIC  X(01).
  2663             88  LT-ADDRESS-DATA        VALUE '1'.
  2664             88  LT-TEXT-DATA           VALUE '2'.
  2665             88  LT-COMMENT-DATA        VALUE '3'.
  2666         16  LT-LINE-SEQ-NO          PIC S9(04)    COMP.
  2667
  2668     12  FILLER                      PIC  X(28).
  2669     12  LT-NUM-LINES-ON-RECORD      PIC S9(04)    COMP.
  2670
  2671     12  LT-TEXT-RECORD.
  2672         16  LT-LETTER-TEXT OCCURS 20 TIMES
  2673                            INDEXED BY LT-NDX.
  2674             20  LT-TEXT-LINE        PIC  X(70).
  2675             20  LT-SKIP-CONTROL     PIC  X(02).
  2676                 88  LT-NO-LINES-SKIPPED             VALUE SPACES.
  2677                 88  LT-SKIP-TO-NEXT-PAGE            VALUE '99'.
  2678             20  FILLER              PIC  X(08).
  2679
  2680     12  LT-COMMENT-RECORD  REDEFINES LT-TEXT-RECORD.
  2681         16  LT-LETTER-COMMENT OCCURS 20 TIMES INDEXED BY LC-NDX.
  2682             20  LT-COMMENT-LINE     PIC X(69).
  2683             20  LT-COMMENT-CHG-DT   PIC X(02).
  2684             20  LT-COMMENT-CHG-BY   PIC X(04).
  2685             20  FILLER              PIC X(05).
  2686
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  54
* EL690.cbl
  2688*    COPY ELCCNTL.
  2689******************************************************************
  2690*                                                                *
  2691*                                                                *
  2692*                            ELCCNTL.                            *
  2693*           COPYBOOK REVIEWED FOR YEAR 2000 COMPLIANCE
  2694*                            VMOD=2.059                          *
  2695*                                                                *
  2696*   FILE DESCRIPTION = SYSTEM CONTROL FILE                       *
  2697*                                                                *
  2698*   FILE TYPE = VSAM,KSDS                                        *
  2699*   RECORD SIZE = 750  RECFORM = FIXED                           *
  2700*                                                                *
  2701*   BASE CLUSTER = ELCNTL                        RKP=2,LEN=10    *
  2702*       ALTERNATE INDEX = NONE                                   *
  2703*                                                                *
  2704*   LOG = YES                                                    *
  2705*   SERVREQ = BROWSE, DELETE, UPDATE, NEWREC                     *
  2706******************************************************************
  2707*                   C H A N G E   L O G
  2708*
  2709* CHANGES ARE MARKED BY THE CHANGE EFFECTIVE DATE.
  2710*-----------------------------------------------------------------
  2711*  CHANGE   CHANGE REQUEST PGMR  DESCRIPTION OF CHANGE
  2712* EFFECTIVE    NUMBER
  2713*-----------------------------------------------------------------
  2714* 082503                   PEMA  ADD BENEFIT GROUP
  2715* 100703    2003080800002  PEMA  ADD SUPERGAP PROCESSING
  2716* 033104    2003080800002  PEMA  ADD GAP NON REFUNDABLE OPTION
  2717* 092705    2005050300006  PEMA  ADD SPP LEASES
  2718* 031808    2006032200004  AJRA  ADD APPROVAL LEVEL 4
  2719* 071508  CR2007110500003  PEMA  ADD NH INTEREST REFUND PROCESSING
  2720* 091808    2008022800002  AJRA  ADD CHECK NUMBER TO STATE CNTL FO
  2721* 011410    2009061500002  AJRA  ADD REFUND IND FOR AH AND DEATH C
  2722* 061511    2011042000002  AJRA  ADD IND TO VERIFY 2ND BENEFICIARY
  2723* 011812    2011022800001  AJRA  ADD CSR IND TO USER SECURITY
  2724* 012913    2012092400007  AJRA  ADD CAUSAL STATE IND
  2725* 032813    2011013100001  AJRA  ADD CLAIM REAUDIT FIELDS
  2726* 091813    2013082900001  AJRA  ADD APPROVAL LEVEL 5
  2727* 051414  CR2013021100002  PEMA  RECURRENT CLAIM CHANGES
  2728* 102717  CR2017062000003  PEMA  COMM CAP CHANGES
  2729******************************************************************
  2730*
  2731 01  CONTROL-FILE.
  2732     12  CF-RECORD-ID                       PIC XX.
  2733         88  VALID-CF-ID                        VALUE 'CF'.
  2734
  2735     12  CF-CONTROL-PRIMARY.
  2736         16  CF-COMPANY-ID                  PIC XXX.
  2737         16  CF-RECORD-TYPE                 PIC X.
  2738             88  CF-COMPANY-MASTER              VALUE '1'.
  2739             88  CF-PROCESSOR-MASTER            VALUE '2'.
  2740             88  CF-STATE-MASTER                VALUE '3'.
  2741             88  CF-LF-BENEFIT-MASTER           VALUE '4'.
  2742             88  CF-AH-BENEFIT-MASTER           VALUE '5'.
  2743             88  CF-CARRIER-MASTER              VALUE '6'.
  2744             88  CF-MORTALITY-MASTER            VALUE '7'.
  2745             88  CF-BUSINESS-TYPE-MASTER        VALUE '8'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  55
* EL690.cbl
  2746             88  CF-TERMINAL-MASTER             VALUE '9'.
  2747             88  CF-AH-EDIT-MASTER              VALUE 'A'.
  2748             88  CF-CREDIBILITY-FACTOR-MASTER   VALUE 'B'.
  2749             88  CF-CUSTOM-REPORT-MASTER        VALUE 'C'.
  2750             88  CF-MORTGAGE-HT-WT-CHART        VALUE 'H'.
  2751             88  CF-LIFE-EDIT-MASTER            VALUE 'L'.
  2752             88  CF-MORTGAGE-PLAN-MASTER        VALUE 'M'.
  2753             88  CF-MORTGAGE-COMPANY-MASTER     VALUE 'N'.
  2754             88  CF-REMINDERS-MASTER            VALUE 'R'.
  2755             88  CF-AUTO-ACTIVITY-MASTER        VALUE 'T'.
  2756         16  CF-ACCESS-CD-GENL              PIC X(4).
  2757         16  CF-ACCESS-OF-PROCESSOR  REDEFINES CF-ACCESS-CD-GENL.
  2758             20  CF-PROCESSOR               PIC X(4).
  2759         16  CF-ACCESS-OF-STATE  REDEFINES  CF-ACCESS-CD-GENL.
  2760             20  CF-STATE-CODE              PIC XX.
  2761             20  FILLER                     PIC XX.
  2762         16  CF-ACCESS-OF-BENEFIT  REDEFINES  CF-ACCESS-CD-GENL.
  2763             20  FILLER                     PIC XX.
  2764             20  CF-HI-BEN-IN-REC           PIC XX.
  2765         16  CF-ACCESS-OF-CARRIER  REDEFINES  CF-ACCESS-CD-GENL.
  2766             20  FILLER                     PIC XXX.
  2767             20  CF-CARRIER-CNTL            PIC X.
  2768         16  CF-ACCESS-OF-BUS-TYPE REDEFINES  CF-ACCESS-CD-GENL.
  2769             20  FILLER                     PIC XX.
  2770             20  CF-HI-TYPE-IN-REC          PIC 99.
  2771         16  CF-ACCESS-OF-CRDB-TBL REDEFINES  CF-ACCESS-CD-GENL.
  2772             20  CF-CRDB-TABLE-INDICATOR    PIC X.
  2773                 88  CF-CRDB-NAIC-TABLE         VALUE '9'.
  2774             20  CF-CRDB-BENEFIT-TYPE       PIC X.
  2775             20  CF-CRDB-WAITING-PERIOD     PIC XX.
  2776         16  CF-ACCESS-OF-CUST-RPT REDEFINES  CF-ACCESS-CD-GENL.
  2777             20  FILLER                     PIC X.
  2778             20  CF-CUSTOM-REPORT-NO        PIC 999.
  2779         16  CF-ACCESS-OF-PLAN   REDEFINES  CF-ACCESS-CD-GENL.
  2780             20  FILLER                     PIC XX.
  2781             20  CF-MORTGAGE-PLAN           PIC XX.
  2782         16  CF-SEQUENCE-NO                 PIC S9(4)   COMP.
  2783
  2784     12  CF-LAST-MAINT-DT                   PIC XX.
  2785     12  CF-LAST-MAINT-BY                   PIC X(4).
  2786     12  CF-LAST-MAINT-HHMMSS               PIC S9(6)   COMP-3.
  2787
  2788     12  CF-RECORD-BODY                     PIC X(728).
  2789
  2790
  2791****************************************************************
  2792*             COMPANY MASTER RECORD                            *
  2793****************************************************************
  2794
  2795     12  CF-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  2796         16  CF-COMPANY-ADDRESS.
  2797             20  CF-CL-MAIL-TO-NAME         PIC X(30).
  2798             20  CF-CL-IN-CARE-OF           PIC X(30).
  2799             20  CF-CL-ADDR-LINE-1          PIC X(30).
  2800             20  CF-CL-ADDR-LINE-2          PIC X(30).
  2801             20  CF-CL-CITY-STATE           PIC X(30).
  2802             20  CF-CL-ZIP-CODE-NUM         PIC 9(9)    COMP-3.
  2803             20  CF-CL-PHONE-NO             PIC 9(11)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  56
* EL690.cbl
  2804         16  CF-COMPANY-CD                  PIC X.
  2805         16  CF-COMPANY-PASSWORD            PIC X(8).
  2806         16  CF-SECURITY-OPTION             PIC X.
  2807             88  ALL-SECURITY                   VALUE '1'.
  2808             88  COMPANY-VERIFY                 VALUE '2'.
  2809             88  PROCESSOR-VERIFY               VALUE '3'.
  2810             88  NO-SECURITY                    VALUE '4'.
  2811             88  ALL-BUT-TERM                   VALUE '5'.
  2812         16  CF-CARRIER-CONTROL-LEVEL       PIC X.
  2813             88  USE-ACTUAL-CARRIER             VALUE SPACE.
  2814         16  CF-LGX-INTERFACE-CNTL          PIC X.
  2815             88  LGX-TIME-SHR-COMPANY           VALUE '1'.
  2816         16  CF-INFORCE-LOCATION            PIC X.
  2817             88  CERTS-ARE-ONLINE               VALUE '1'.
  2818             88  CERTS-ARE-OFFLINE              VALUE '2'.
  2819             88  NO-CERTS-AVAILABLE             VALUE '3'.
  2820         16  CF-LOWER-CASE-LETTERS          PIC X.
  2821         16  CF-CERT-ACCESS-CONTROL         PIC X.
  2822             88  CF-ST-ACCNT-CNTL               VALUE ' '.
  2823             88  CF-CARR-GROUP-ST-ACCNT-CNTL    VALUE '1'.
  2824             88  CF-CARR-ST-ACCNT-CNTL          VALUE '2'.
  2825             88  CF-ACCNT-CNTL                  VALUE '3'.
  2826             88  CF-CARR-ACCNT-CNTL             VALUE '4'.
  2827
  2828         16  CF-FORMS-PRINTER-ID            PIC X(4).
  2829         16  CF-CHECK-PRINTER-ID            PIC X(4).
  2830
  2831         16  CF-LGX-CREDIT-USER             PIC X.
  2832             88  CO-IS-NOT-USER                 VALUE 'N'.
  2833             88  CO-HAS-CLAS-IC-CREDIT          VALUE 'Y'.
  2834
  2835         16 CF-CREDIT-CALC-CODES.
  2836             20  CF-CR-REM-TERM-CALC PIC X.
  2837               88  CR-EARN-AFTER-15TH           VALUE '1'.
  2838               88  CR-EARN-ON-HALF-MO           VALUE '2'.
  2839               88  CR-EARN-ON-1ST-DAY           VALUE '3'.
  2840               88  CR-EARN-ON-FULL-MO           VALUE '4'.
  2841               88  CR-EARN-WITH-NO-DAYS         VALUE '5'.
  2842               88  CR-EARN-AFTER-14TH           VALUE '6'.
  2843               88  CR-EARN-AFTER-16TH           VALUE '7'.
  2844             20  CF-CR-R78-METHOD           PIC X.
  2845               88  USE-TERM-PLUS-ONE            VALUE SPACE.
  2846               88  DONT-USE-PLUS-ONE            VALUE '1'.
  2847
  2848         16  CF-CLAIM-CONTROL-COUNTS.
  2849             20  CF-CO-CLAIM-COUNTER        PIC S9(8)   COMP.
  2850                 88  CO-CLM-COUNT-RESET         VALUE +99999.
  2851
  2852             20  CF-CO-ARCHIVE-COUNTER      PIC S9(8)   COMP.
  2853                 88  CO-ARCHIVE-COUNT-RESET     VALUE +999999.
  2854
  2855             20  CF-CO-CHECK-COUNTER        PIC S9(8)   COMP.
  2856                 88  CO-CHECK-COUNT-RESET       VALUE +9999999.
  2857
  2858             20  CF-CO-CHECK-QUE-COUNTER    PIC S9(8)   COMP.
  2859                 88  CO-QUE-COUNT-RESET         VALUE +9999999.
  2860
  2861         16  CF-CURRENT-MONTH-END           PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  57
* EL690.cbl
  2862
  2863         16  CF-CO-CALC-QUOTE-TOLERANCE.
  2864             20  CF-CO-TOL-CLAIM            PIC S999V99   COMP-3.
  2865             20  CF-CO-TOL-PREM             PIC S999V99   COMP-3.
  2866             20  CF-CO-TOL-REFUND           PIC S999V99   COMP-3.
  2867             20  CF-CO-CLAIM-REJECT-SW      PIC X.
  2868                 88 CO-WARN-IF-CLAIM-OUT        VALUE SPACE.
  2869                 88 CO-FORCE-IF-CLAIM-OUT       VALUE '1'.
  2870             20  CF-CO-PREM-REJECT-SW       PIC X.
  2871                 88 CO-WARN-IF-PREM-OUT         VALUE SPACE.
  2872                 88 CO-FORCE-IF-PREM-OUT        VALUE '1'.
  2873             20  CF-CO-REF-REJECT-SW        PIC X.
  2874                 88 CO-WARN-IF-REF-OUT          VALUE SPACE.
  2875                 88 CO-FORCE-IF-REF-OUT         VALUE '1'.
  2876
  2877         16  CF-CO-REPORTING-DT             PIC XX.
  2878         16  CF-CO-REPORTING-MONTH-DT       PIC XX.
  2879         16  CF-CO-REPORTING-MONTH-END-SW   PIC X.
  2880           88  CF-CO-NOT-MONTH-END              VALUE SPACES.
  2881           88  CF-CO-MONTH-END                  VALUE '1'.
  2882
  2883         16  CF-LGX-CLAIM-USER              PIC X.
  2884             88  CO-IS-NOT-CLAIM-USER           VALUE 'N'.
  2885             88  CO-HAS-CLAS-IC-CLAIM           VALUE 'Y'.
  2886
  2887         16  CF-CREDIT-EDIT-CONTROLS.
  2888             20  CF-MIN-PREMIUM             PIC S999V99   COMP-3.
  2889             20  CF-MIN-AGE                 PIC 99.
  2890             20  CF-DEFAULT-AGE             PIC 99.
  2891             20  CF-MIN-TERM                PIC S999      COMP-3.
  2892             20  CF-MAX-TERM                PIC S999      COMP-3.
  2893             20  CF-DEFAULT-SEX             PIC X.
  2894             20  CF-JOINT-AGE-INPUT         PIC X.
  2895                 88 CF-JOINT-AGE-IS-INPUT       VALUE '1'.
  2896             20  CF-BIRTH-DATE-INPUT        PIC X.
  2897                 88 CF-BIRTH-DATE-IS-INPUT      VALUE '1'.
  2898             20  CF-CAR-GROUP-ACCESS-CNTL   PIC X.
  2899                 88  CF-USE-ACTUAL-CARRIER      VALUE ' '.
  2900                 88  CF-ZERO-CARRIER            VALUE '1'.
  2901                 88  CF-ZERO-GROUPING           VALUE '2'.
  2902                 88  CF-ZERO-CAR-GROUP          VALUE '3'.
  2903             20  CF-EDIT-SW                 PIC X.
  2904                 88  CF-START-EDIT-TONIGHT      VALUE '1'.
  2905             20  CF-EDIT-RESTART-BATCH      PIC X(6).
  2906             20  CF-CR-PR-METHOD            PIC X.
  2907               88  USE-NORMAL-PR-METHOD         VALUE SPACE.
  2908               88  ADJUST-ORIG-TERM-BY-5        VALUE '1'.
  2909             20  FILLER                     PIC X.
  2910
  2911         16  CF-CREDIT-MISC-CONTROLS.
  2912             20  CF-REIN-TABLE-SW           PIC X.
  2913                 88 REIN-TABLES-ARE-USED        VALUE '1'.
  2914             20  CF-COMP-TABLE-SW           PIC X.
  2915                 88 COMP-TABLES-ARE-USED        VALUE '1'.
  2916             20  CF-EXPERIENCE-RETENTION-AGE
  2917                                            PIC S9        COMP-3.
  2918             20  CF-CONVERSION-DT           PIC XX.
  2919             20  CF-COMP-WRITE-OFF-AMT      PIC S999V99   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  58
* EL690.cbl
  2920             20  CF-RUN-FREQUENCY-SW        PIC X.
  2921                 88 CO-IS-PROCESSED-MONTHLY     VALUE SPACE.
  2922                 88 CO-IS-PROCESSED-ON-QTR      VALUE '1'.
  2923
  2924             20  CF-CR-CHECK-NO-CONTROL.
  2925                 24  CF-CR-CHECK-NO-METHOD    PIC X.
  2926                     88  CR-CHECK-NO-MANUAL       VALUE '1'.
  2927                     88  CR-CHECK-NO-AUTO-SEQ     VALUE '2'.
  2928                     88  CR-CHECK-NO-AT-PRINT     VALUE '4'.
  2929                 24  CF-CR-CHECK-COUNTER      PIC S9(8)   COMP.
  2930                     88  CR-CHECK-CNT-RESET-VALUE VALUE +999999.
  2931
  2932                 24  CF-CR-CHECK-COUNT       REDEFINES
  2933                     CF-CR-CHECK-COUNTER      PIC X(4).
  2934
  2935                 24  CF-CR-CHECK-QUE-COUNTER  PIC S9(8)  COMP.
  2936                     88  CR-QUE-COUNT-RESET      VALUE +9999999.
  2937
  2938                 24  CF-CR-CHECK-QUE-COUNT   REDEFINES
  2939                     CF-CR-CHECK-QUE-COUNTER  PIC X(4).
  2940                 24  CF-MAIL-PROCESSING       PIC X.
  2941                     88  MAIL-PROCESSING          VALUE 'Y'.
  2942
  2943         16  CF-MISC-SYSTEM-CONTROL.
  2944             20  CF-SYSTEM-C                 PIC X.
  2945                 88  CONFIRMATION-SYS-USED       VALUE '1'.
  2946             20  CF-SYSTEM-D                 PIC X.
  2947                 88  DAILY-BILL-SYS-USED         VALUE '1'.
  2948             20  CF-SOC-SEC-NO-SW            PIC X.
  2949                 88  SOC-SEC-NO-USED             VALUE '1'.
  2950             20  CF-MEMBER-NO-SW             PIC X.
  2951                 88  MEMBER-NO-USED              VALUE '1'.
  2952             20  CF-TAX-ID-NUMBER            PIC X(11).
  2953             20  CF-JOURNAL-FILE-ID          PIC S9(4) COMP.
  2954             20  CF-PAYMENT-APPROVAL-SW      PIC X.
  2955                 88  CF-PMT-APPROVAL-USED        VALUE 'Y' 'G'.
  2956                 88  CF-NO-APPROVAL              VALUE ' ' 'N'.
  2957                 88  CF-ALL-APPROVED             VALUE 'Y'.
  2958                 88  CF-GRADUATED-APPROVAL       VALUE 'G'.
  2959             20  CF-SYSTEM-E                 PIC X.
  2960                 88  CF-AR-SYSTEM-USED           VALUE 'Y'.
  2961
  2962         16  CF-LGX-LIFE-USER               PIC X.
  2963             88  CO-IS-NOT-LIFE-USER            VALUE 'N'.
  2964             88  CO-HAS-CLAS-IC-LIFE            VALUE 'Y'.
  2965
  2966         16  CF-CR-MONTH-END-DT             PIC XX.
  2967
  2968         16  CF-FILE-MAINT-DATES.
  2969             20  CF-LAST-BATCH-NO           PIC S9(8)   COMP.
  2970                 88  CF-LAST-BATCH-RESET        VALUE +999999.
  2971             20  CF-LAST-BATCH       REDEFINES
  2972                 CF-LAST-BATCH-NO               PIC X(4).
  2973             20  CF-RATES-FILE-MAINT-DT         PIC XX.
  2974             20  CF-RATES-FILE-CREATE-DT        PIC XX.
  2975             20  CF-COMMISSION-TAB-MAINT-DT     PIC XX.
  2976             20  CF-COMMISSION-TAB-CREATE-DT    PIC XX.
  2977             20  CF-ACCOUNT-MSTR-MAINT-DT       PIC XX.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  59
* EL690.cbl
  2978             20  CF-ACCOUNT-MSTR-CREATE-DT      PIC XX.
  2979             20  CF-REINSURANCE-TAB-MAINT-DT    PIC XX.
  2980             20  CF-REINSURANCE-TAB-CREATE-DT   PIC XX.
  2981             20  CF-COMPENSATION-MSTR-MAINT-DT  PIC XX.
  2982             20  CF-COMPENSATION-MSTR-CREATE-DT PIC XX.
  2983
  2984         16  CF-NEXT-COMPANY-ID             PIC XXX.
  2985         16  FILLER                         PIC X.
  2986
  2987         16  CF-ALT-MORT-CODE               PIC X(4).
  2988         16  CF-MEMBER-CAPTION              PIC X(10).
  2989
  2990         16  CF-LIFE-ACCESS-CONTROL         PIC X.
  2991             88  CF-LIFE-ST-ACCNT-CNTL          VALUE ' '.
  2992             88  CF-LIFE-CARR-GRP-ST-ACCNT-CNTL VALUE '1'.
  2993             88  CF-LIFE-CARR-ST-ACCNT-CNTL     VALUE '2'.
  2994             88  CF-LIFE-ACCNT-CNTL             VALUE '3'.
  2995             88  CF-LIFE-CARR-ACCNT-CNTL        VALUE '4'.
  2996
  2997         16  CF-STARTING-ARCH-NO            PIC S9(8) COMP.
  2998
  2999         16  CF-LIFE-OVERRIDE-L1            PIC X.
  3000         16  CF-LIFE-OVERRIDE-L2            PIC XX.
  3001         16  CF-LIFE-OVERRIDE-L6            PIC X(6).
  3002         16  CF-LIFE-OVERRIDE-L12           PIC X(12).
  3003
  3004         16  CF-AH-OVERRIDE-L1              PIC X.
  3005         16  CF-AH-OVERRIDE-L2              PIC XX.
  3006         16  CF-AH-OVERRIDE-L6              PIC X(6).
  3007         16  CF-AH-OVERRIDE-L12             PIC X(12).
  3008
  3009         16  CF-REPORT-CD1-CAPTION          PIC X(10).
  3010         16  CF-REPORT-CD2-CAPTION          PIC X(10).
  3011
  3012         16  CF-CLAIM-CUTOFF-DATE           PIC XX.
  3013         16  CF-AR-LAST-EL860-DT            PIC XX.
  3014         16  CF-MP-MONTH-END-DT             PIC XX.
  3015
  3016         16  CF-MAX-NUM-PMTS-CHECK          PIC 99.
  3017         16  CF-CLAIM-PAID-THRU-TO          PIC X.
  3018             88  CF-CLAIM-PAID-TO               VALUE '1'.
  3019
  3020         16  CF-AR-MONTH-END-DT             PIC XX.
  3021
  3022         16  CF-CRDTCRD-USER                PIC X.
  3023             88  CO-IS-NOT-CRDTCRD-USER         VALUE 'N'.
  3024             88  CO-HAS-CLAS-IC-CRDTCRD         VALUE 'Y'.
  3025
  3026         16  CF-CC-MONTH-END-DT             PIC XX.
  3027
  3028         16  CF-PRINT-ADDRESS-LABELS        PIC X.
  3029
  3030         16  CF-MORTALITY-AGE-CALC-METHOD   PIC X.
  3031             88  CF-USE-TABLE-ASSIGNED-METHOD   VALUE '1' ' '.
  3032             88  CF-USE-ALL-AGE-LAST            VALUE '2'.
  3033             88  CF-USE-ALL-AGE-NEAR            VALUE '3'.
  3034         16  CF-CO-TOL-PREM-PCT             PIC S9V9(4)   COMP-3.
  3035         16  CF-CO-TOL-REFUND-PCT           PIC S9V9(4)   COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  60
* EL690.cbl
  3036         16  CF-CO-TOL-CAP                  PIC S9(3)V99  COMP-3.
  3037         16  CF-CO-RESERVE-OPTION-SWITCH    PIC  X.
  3038             88  OPTIONAL-RESERVE-METHOD-AUTH    VALUE 'Y'.
  3039             88  OPTIONAL-RESERVE-MTHD-NOT-AUTH  VALUE ' ' 'N'.
  3040         16  CF-CO-IBNR-LAG-MONTHS          PIC S9(3)     COMP-3.
  3041         16  CF-CO-CIDA-TABLE-DISCOUNT-PCT  PIC S9V9(4)   COMP-3.
  3042         16  CF-CO-CRDB-TABLE-SELECTION     PIC  X.
  3043             88  NIAC-CREDIBILITY-TABLE          VALUE '9'.
  3044         16  CF-CO-ST-CALL-RPT-CNTL         PIC  X.
  3045
  3046         16  CF-CL-ZIP-CODE.
  3047             20  CF-CL-ZIP-PRIME.
  3048                 24  CF-CL-ZIP-1ST          PIC X.
  3049                     88  CF-CL-CAN-POST-CODE  VALUE 'A' THRU 'Z'.
  3050                 24  FILLER                 PIC X(4).
  3051             20  CF-CL-ZIP-PLUS4            PIC X(4).
  3052         16  CF-CL-CANADIAN-POSTAL-CODE REDEFINES CF-CL-ZIP-CODE.
  3053             20  CF-CL-CAN-POSTAL-1         PIC XXX.
  3054             20  CF-CL-CAN-POSTAL-2         PIC XXX.
  3055             20  FILLER                     PIC XXX.
  3056
  3057         16  CF-CO-CALCULATION-INTEREST     PIC S9V9(4)  COMP-3.
  3058         16  CF-CO-IBNR-AH-FACTOR           PIC S9V9(4)  COMP-3.
  3059         16  CF-CO-IBNR-LIFE-FACTOR         PIC S9V9(4)  COMP-3.
  3060         16  CF-CO-OPTION-START-DATE        PIC XX.
  3061         16  CF-REM-TRM-CALC-OPTION         PIC X.
  3062           88  CF-VALID-REM-TRM-OPTION          VALUE '1' '2'
  3063                                                      '3' '4'.
  3064           88  CF-CONSIDER-EXTENSION            VALUE '3' '4'.
  3065           88  CF-30-DAY-MONTH                  VALUE '1' '3'.
  3066           88  CF-NO-EXT-30-DAY-MONTH           VALUE '1'.
  3067           88  CF-NO-EXT-ACTUAL-DAYS            VALUE '2'.
  3068           88  CF-EXT-30-DAY-MONTH              VALUE '3'.
  3069           88  CF-EXT-ACTUAL-DAYS               VALUE '4'.
  3070
  3071         16  CF-DEFAULT-APR                 PIC S999V9(4) COMP-3.
  3072
  3073         16  CF-PAYMENT-APPROVAL-LEVELS.
  3074             20  CF-LIFE-PAY-APP-LEVEL-1    PIC S9(7)   COMP-3.
  3075             20  CF-LIFE-PAY-APP-LEVEL-2    PIC S9(7)   COMP-3.
  3076             20  CF-LIFE-PAY-APP-LEVEL-3    PIC S9(7)   COMP-3.
  3077             20  CF-AH-PAY-APP-LEVEL-1      PIC S9(7)   COMP-3.
  3078             20  CF-AH-PAY-APP-LEVEL-2      PIC S9(7)   COMP-3.
  3079             20  CF-AH-PAY-APP-LEVEL-3      PIC S9(7)   COMP-3.
  3080
  3081         16  CF-END-USER-REPORTING-USER     PIC X.
  3082             88  CO-NO-END-USER-REPORTING       VALUE 'N'.
  3083             88  CO-USES-END-USER-REPORTING     VALUE 'Y'.
  3084
  3085         16  CF-CLAIMS-CHECK-RECON-USER     PIC X.
  3086             88  CO-NO-USE-CLAIMS-RECON         VALUE 'N'.
  3087             88  CO-USES-CLAIMS-RECON           VALUE 'Y'.
  3088
  3089         16  CF-CLAIMS-LAST-PROCESS-DT      PIC XX.
  3090
  3091         16  CF-CREDIT-REF-SSN-CNT          PIC S9(5)  COMP-3.
  3092         16  FILLER                         PIC X.
  3093
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  61
* EL690.cbl
  3094         16  CF-CREDIT-ARCHIVE-CNTL.
  3095             20  CF-CREDIT-LAST-ARCH-NUM    PIC S9(9)  COMP-3.
  3096             20  CF-CREDIT-START-ARCH-NUM   PIC S9(9)  COMP-3.
  3097             20  CF-CREDIT-ARCH-PURGE-YR    PIC S9     COMP-3.
  3098
  3099         16  CF-CR-PRINT-ADDRESS-LABELS     PIC X.
  3100
  3101         16  CF-CLAIMS-AUDIT-CHANGES        PIC X.
  3102             88  CO-NO-USE-AUDIT-CHANGES        VALUE 'N'.
  3103             88  CO-USES-AUDIT-CHANGES          VALUE 'Y'.
  3104
  3105         16  CF-CLAIMS-CREDIT-CARD-INDEX    PIC X.
  3106             88  CO-NO-USE-CREDIT-CARD-INDEX    VALUE 'N'.
  3107             88  CO-USES-CREDIT-CARD-INDEX      VALUE 'Y'.
  3108
  3109         16  CF-CLAIMS-LETTER-MAINT-DAYS    PIC 99.
  3110
  3111         16  CF-CO-ACH-ID-CODE              PIC  X.
  3112             88  CF-CO-ACH-ICD-IRS-EIN          VALUE '1'.
  3113             88  CF-CO-ACH-ICD-DUNS             VALUE '2'.
  3114             88  CF-CO-ACH-ICD-USER-NO          VALUE '3'.
  3115         16  CF-CO-ACH-CLAIM-SEND-NAME      PIC X(23).
  3116         16  CF-CO-ACH-CLAIM-BK-NO          PIC X(09).
  3117         16  CF-CO-ACH-ADMIN-SEND-NAME      PIC X(23).
  3118         16  CF-CO-ACH-ADMIN-NO             PIC X(09).
  3119         16  CF-CO-ACH-RECV-NAME            PIC X(23).
  3120         16  CF-CO-ACH-RECV-NO              PIC X(08).
  3121         16  CF-CO-ACH-ORIGINATOR-NO        PIC X(08).
  3122         16  CF-CO-ACH-COMPANY-ID           PIC X(09).
  3123         16  CF-CO-ACH-TRACE-NO             PIC 9(07) COMP.
  3124                 88  CO-ACH-TRACE-NO-RESET      VALUE 9999999.
  3125         16  CF-CO-ACH-TRACE-SPACE REDEFINES
  3126                 CF-CO-ACH-TRACE-NO         PIC X(4).
  3127
  3128         16  CF-CO-OVER-SHORT.
  3129             20 CF-CO-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3130             20 CF-CO-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3131
  3132*         16  FILLER                         PIC X(102).
  3133         16  CF-PAYMENT-APPROVAL-LEVELS-2.
  3134             20  CF-LIFE-PAY-APP-LEVEL-4    PIC S9(7)   COMP-3.
  3135             20  CF-AH-PAY-APP-LEVEL-4      PIC S9(7)   COMP-3.
  3136
  3137         16  CF-AH-APPROVAL-DAYS.
  3138             20  CF-AH-APP-DAY-LEVEL-1     PIC S9(5)   COMP-3.
  3139             20  CF-AH-APP-DAY-LEVEL-2     PIC S9(5)   COMP-3.
  3140             20  CF-AH-APP-DAY-LEVEL-3     PIC S9(5)   COMP-3.
  3141             20  CF-AH-APP-DAY-LEVEL-4     PIC S9(5)   COMP-3.
  3142
  3143         16  CF-CO-REAUDIT-INTERVAL        PIC S9(5)   COMP-3.
  3144
  3145         16  CF-APPROV-LEV-5.
  3146             20  CF-LIFE-PAY-APP-LEVEL-5    PIC S9(7)   COMP-3.
  3147             20  CF-AH-PAY-APP-LEVEL-5      PIC S9(7)   COMP-3.
  3148             20  CF-AH-APP-DAY-LEVEL-5      PIC S9(5)   COMP-3.
  3149
  3150         16  FILLER                         PIC X(68).
  3151****************************************************************
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  62
* EL690.cbl
  3152*             PROCESSOR/USER RECORD                            *
  3153****************************************************************
  3154
  3155     12  CF-PROCESSOR-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3156         16  CF-PROCESSOR-NAME              PIC X(30).
  3157         16  CF-PROCESSOR-PASSWORD          PIC X(11).
  3158         16  CF-PROCESSOR-TITLE             PIC X(26).
  3159         16  CF-MESSAGE-AT-LOGON-CAP        PIC X.
  3160                 88  MESSAGE-YES                VALUE 'Y'.
  3161                 88  MESSAGE-NO                 VALUE ' ' 'N'.
  3162
  3163*****************************************************
  3164****  OCCURRENCE (1) CREDIT APPLICATIONS         ****
  3165****  OCCURRENCE (2) CLAIMS APPLICATIONS         ****
  3166****  OCCURRENCE (3) CREDIT CARD APPLICATIONS    ****
  3167****  OCCURRENCE (4) ACCT RECV APPLICATIONS      ****
  3168*****************************************************
  3169
  3170         16  CF-SYSTEM-SECURITY  OCCURS  4 TIMES.
  3171             20  CF-ADMINISTRATION-CONTROLS PIC XX.
  3172             20  CF-APPLICATION-FORCE       PIC X.
  3173             20  CF-INDIVIDUAL-APP.
  3174                 24  CF-APP-SWITCHES  OCCURS  44 TIMES.
  3175                     28  CF-BROWSE-APP      PIC X.
  3176                     28  CF-UPDATE-APP      PIC X.
  3177
  3178         16  CF-CURRENT-TERM-ON             PIC X(4).
  3179         16  CF-PROCESSOR-LIMITS-CLAIMS.
  3180             20  CF-PROC-CALC-AMT-TOL       PIC S999V99   COMP-3.
  3181             20  CF-PROC-MAX-REG-PMT        PIC S9(7)V99  COMP-3.
  3182             20  CF-PROC-MAX-REG-DAYS       PIC S999      COMP-3.
  3183             20  CF-PROC-MAX-AUTO-PMT       PIC S9(7)V99  COMP-3.
  3184             20  CF-PROC-MAX-AUTO-MOS       PIC S999      COMP-3.
  3185             20  CF-PROC-CALC-DAYS-TOL      PIC S999      COMP-3.
  3186             20  CF-PROC-MAX-LF-PMT         PIC S9(7)V99  COMP-3.
  3187         16  CF-PROCESSOR-CARRIER           PIC X.
  3188             88  NO-CARRIER-SECURITY            VALUE ' '.
  3189         16  CF-PROCESSOR-ACCOUNT           PIC X(10).
  3190             88  NO-ACCOUNT-SECURITY            VALUE SPACES.
  3191         16  CF-PROCESSOR-LIFE-ACCESS       PIC X.
  3192             88  PROCESSOR-HAS-LIFE-ACCESS      VALUE 'Y'.
  3193         16  CF-PROCESSOR-USER-ALMIGHTY     PIC X.
  3194             88  PROCESSOR-USER-IS-ALMIGHTY     VALUE 'Y'.
  3195
  3196         16  CF-PROC-SYS-ACCESS-SW.
  3197             20  CF-PROC-CREDIT-CLAIMS-SW.
  3198                 24  CF-PROC-SYS-ACCESS-CREDIT  PIC X.
  3199                     88  ACCESS-TO-CREDIT           VALUE 'Y'.
  3200                 24  CF-PROC-SYS-ACCESS-CLAIMS  PIC X.
  3201                     88  ACCESS-TO-CLAIMS           VALUE 'Y'.
  3202             20  CF-PROC-CREDIT-CLAIMS   REDEFINES
  3203                 CF-PROC-CREDIT-CLAIMS-SW       PIC XX.
  3204                 88  ACCESS-TO-CLAIM-CREDIT         VALUE 'YY'.
  3205             20  CF-PROC-LIFE-GNRLDGR-SW.
  3206                 24  CF-PROC-SYS-ACCESS-LIFE    PIC X.
  3207                     88  ACCESS-TO-LIFE             VALUE 'Y'.
  3208                 24  CF-PROC-SYS-ACCESS-GNRLDGR PIC X.
  3209                     88  ACCESS-TO-GNRLDGR          VALUE 'Y'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  63
* EL690.cbl
  3210             20  CF-PROC-LIFE-GNRLDGR    REDEFINES
  3211                 CF-PROC-LIFE-GNRLDGR-SW        PIC XX.
  3212                 88  ACCESS-TO-LIFE-GNRLDGR         VALUE 'YY'.
  3213         16  CF-PROC-SYS-ACCESS-ALL      REDEFINES
  3214             CF-PROC-SYS-ACCESS-SW              PIC X(4).
  3215             88  ACCESS-TO-ALL-SYSTEMS              VALUE 'YYYY'.
  3216         16  CF-PROCESSOR-PRINTER               PIC X(4).
  3217
  3218         16  CF-APPROVAL-LEVEL                  PIC X.
  3219             88  APPROVAL-LEVEL-1                   VALUE '1'.
  3220             88  APPROVAL-LEVEL-2                   VALUE '2'.
  3221             88  APPROVAL-LEVEL-3                   VALUE '3'.
  3222             88  APPROVAL-LEVEL-4                   VALUE '4'.
  3223             88  APPROVAL-LEVEL-5                   VALUE '5'.
  3224
  3225         16  CF-PROC-MAX-EXP-PMT            PIC S9(7)V99  COMP-3.
  3226
  3227         16  CF-LANGUAGE-TYPE                   PIC X.
  3228             88  CF-LANG-IS-ENG                     VALUE 'E'.
  3229             88  CF-LANG-IS-FR                      VALUE 'F'.
  3230
  3231         16  CF-CSR-IND                         PIC X.
  3232         16  FILLER                             PIC X(239).
  3233
  3234****************************************************************
  3235*             PROCESSOR/REMINDERS RECORD                       *
  3236****************************************************************
  3237
  3238     12  CF-PROCESSOR-REMINDER-REC  REDEFINES  CF-RECORD-BODY.
  3239         16  CF-PROCESSOR-REMINDERS  OCCURS 8 TIMES.
  3240             20  CF-START-REMIND-DT         PIC XX.
  3241             20  CF-END-REMIND-DT           PIC XX.
  3242             20  CF-REMINDER-TEXT           PIC X(50).
  3243         16  FILLER                         PIC X(296).
  3244
  3245
  3246****************************************************************
  3247*             STATE MASTER RECORD                              *
  3248****************************************************************
  3249
  3250     12  CF-STATE-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3251         16  CF-STATE-ABBREVIATION          PIC XX.
  3252         16  CF-STATE-NAME                  PIC X(25).
  3253         16  CF-ST-CALC-INTEREST            PIC S9V9(4)   COMP-3.
  3254         16  CF-ST-CALC-QUOTE-TOLERANCE.
  3255             20  CF-ST-TOL-CLAIM            PIC S999V99   COMP-3.
  3256             20  CF-ST-TOL-PREM             PIC S999V99   COMP-3.
  3257             20  CF-ST-TOL-REFUND           PIC S999V99   COMP-3.
  3258             20  CF-ST-CLAIM-REJECT-SW      PIC X.
  3259                 88 ST-WARN-IF-CLAIM-OUT        VALUE SPACE.
  3260                 88 ST-FORCE-IF-CLAIM-OUT       VALUE '1'.
  3261             20  CF-ST-PREM-REJECT-SW       PIC X.
  3262                 88 ST-WARN-IF-PREM-OUT         VALUE SPACE.
  3263                 88 ST-FORCE-IF-PREM-OUT        VALUE '1'.
  3264             20  CF-ST-REF-REJECT-SW        PIC X.
  3265                 88 ST-WARN-IF-REF-OUT          VALUE SPACE.
  3266                 88 ST-FORCE-IF-REF-OUT         VALUE '1'.
  3267         16  CF-ST-LF-EXP-PCT               PIC S999V9(4) COMP-3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  64
* EL690.cbl
  3268         16  CF-ST-AH-EXP-PCT               PIC S999V9(4) COMP-3.
  3269         16  CF-ST-REFUND-RULES.
  3270             20  CF-ST-REFUND-MIN           PIC S999V99    COMP-3.
  3271             20  CF-ST-REFUND-DAYS-FIRST    PIC 99.
  3272             20  CF-ST-REFUND-DAYS-SUBSEQ   PIC 99.
  3273         16  CF-ST-FST-PMT-EXTENSION.
  3274             20  CF-ST-FST-PMT-DAYS-MAX     PIC 999.
  3275             20  CF-ST-FST-PMT-DAYS-CHG     PIC X.
  3276                 88  CF-ST-EXT-NO-CHG           VALUE ' '.
  3277                 88  CF-ST-EXT-CHG-LF           VALUE '1'.
  3278                 88  CF-ST-EXT-CHG-AH           VALUE '2'.
  3279                 88  CF-ST-EXT-CHG-LF-AH        VALUE '3'.
  3280         16  CF-ST-STATE-CALL.
  3281             20  CF-ST-CALL-UNEARNED        PIC X.
  3282             20  CF-ST-CALL-RPT-CNTL        PIC X.
  3283             20  CF-ST-CALL-RATE-DEV        PIC XXX.
  3284         16  CF-REPLACEMENT-LAW-SW          PIC X.
  3285             88  CF-REPLACEMENT-LAW-APPLIES     VALUE 'Y'.
  3286             88  CF-REPL-LAW-NOT-APPLICABLE     VALUE 'N'.
  3287         16  CF-REPLACEMENT-LETTER          PIC X(4).
  3288         16  CF-ST-TOL-PREM-PCT             PIC S9V9999 COMP-3.
  3289         16  CF-ST-TOL-REF-PCT              PIC S9V9999 COMP-3.
  3290         16  CF-ST-TARGET-LOSS-RATIO        PIC S9V9(4) COMP-3.
  3291         16  CF-ST-SPLIT-PAYMENT            PIC X.
  3292         16  FILLER                         PIC X.
  3293         16  CF-STATE-BENEFIT-CNTL  OCCURS 50 TIMES.
  3294             20  CF-ST-BENEFIT-CD           PIC XX.
  3295             20  CF-ST-BENEFIT-KIND         PIC X.
  3296                 88  CF-ST-LIFE-KIND            VALUE 'L'.
  3297                 88  CF-ST-AH-KIND              VALUE 'A'.
  3298             20  CF-ST-REM-TERM-CALC        PIC X.
  3299                 88  ST-REM-TERM-NOT-USED       VALUE SPACE.
  3300                 88  ST-EARN-AFTER-15TH         VALUE '1'.
  3301                 88  ST-EARN-ON-HALF-MO         VALUE '2'.
  3302                 88  ST-EARN-ON-1ST-DAY         VALUE '3'.
  3303                 88  ST-EARN-ON-FULL-MO         VALUE '4'.
  3304                 88  ST-EARN-WITH-NO-DAYS       VALUE '5'.
  3305                 88  ST-EARN-AFTER-14TH         VALUE '6'.
  3306                 88  ST-EARN-AFTER-16TH         VALUE '7'.
  3307
  3308             20  CF-ST-REFUND-CALC          PIC X.
  3309                 88  ST-REFUND-NOT-USED         VALUE SPACE.
  3310                 88  ST-REFD-BY-R78             VALUE '1'.
  3311                 88  ST-REFD-BY-PRO-RATA        VALUE '2'.
  3312                 88  ST-REFD-AS-CALIF           VALUE '3'.
  3313                 88  ST-REFD-AS-TEXAS           VALUE '4'.
  3314                 88  ST-REFD-IS-NET-PAY         VALUE '5'.
  3315                 88  ST-REFD-ANTICIPATION       VALUE '6'.
  3316                 88  ST-REFD-UTAH               VALUE '7'.
  3317                 88  ST-REFD-SUM-OF-DIGITS      VALUE '9'.
  3318                 88  ST-REFD-REG-BALLOON        VALUE 'B'.
  3319                 88  ST-REFD-GAP-NON-REFUND     VALUE 'G'.
  3320
  3321             20  CF-ST-EARNING-CALC         PIC X.
  3322                 88  ST-EARNING-NOT-USED        VALUE SPACE.
  3323                 88  ST-EARN-BY-R78             VALUE '1'.
  3324                 88  ST-EARN-BY-PRO-RATA        VALUE '2'.
  3325                 88  ST-EARN-AS-CALIF           VALUE '3'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  65
* EL690.cbl
  3326                 88  ST-EARN-AS-TEXAS           VALUE '4'.
  3327                 88  ST-EARN-IS-NET-PAY         VALUE '5'.
  3328                 88  ST-EARN-ANTICIPATION       VALUE '6'.
  3329                 88  ST-EARN-MEAN               VALUE '8'.
  3330                 88  ST-EARN-REG-BALLOON        VALUE 'B'.
  3331
  3332             20  CF-ST-OVRD-EARNINGS-CALC   PIC X.
  3333                 88  ST-OVERRIDE-NOT-USED       VALUE SPACE.
  3334                 88  ST-OVRD-BY-R78             VALUE '1'.
  3335                 88  ST-OVRD-BY-PRO-RATA        VALUE '2'.
  3336                 88  ST-OVRD-AS-CALIF           VALUE '3'.
  3337                 88  ST-OVRD-AS-TEXAS           VALUE '4'.
  3338                 88  ST-OVRD-IS-NET-PAY         VALUE '5'.
  3339                 88  ST-OVRD-ANTICIPATION       VALUE '6'.
  3340                 88  ST-OVRD-MEAN               VALUE '8'.
  3341                 88  ST-OVRD-REG-BALLOON        VALUE 'B'.
  3342             20  cf-st-extra-periods        pic 9.
  3343*            20  FILLER                     PIC X.
  3344
  3345         16  CF-ST-COMMISSION-CAPS.
  3346             20  CF-ST-COMM-CAP-SL          PIC S9V9(4) COMP-3.
  3347             20  CF-ST-COMM-CAP-JL          PIC S9V9(4) COMP-3.
  3348             20  CF-ST-COMM-CAP-SA          PIC S9V9(4) COMP-3.
  3349             20  CF-ST-COMM-CAP-JA          PIC S9V9(4) COMP-3.
  3350         16  CF-COMM-CAP-LIMIT-TO           PIC X.
  3351                 88  ST-LIMIT-TO-ACCOUNT        VALUE 'A'.
  3352                 88  ST-LIMIT-TO-GA             VALUE 'G'.
  3353                 88  ST-LIMIT-TO-BOTH           VALUE 'B'.
  3354
  3355         16  CF-ST-RES-TAX-PCT              PIC S9V9(4) COMP-3.
  3356
  3357         16  CF-ST-STATUTORY-INTEREST.
  3358             20  CF-ST-STAT-DATE-FROM       PIC X.
  3359                 88  ST-STAT-FROM-INCURRED      VALUE 'I'.
  3360                 88  ST-STAT-FROM-REPORTED      VALUE 'R'.
  3361             20  CF-ST-NO-DAYS-ELAPSED      PIC 99.
  3362             20  CF-ST-STAT-INTEREST        PIC S9V9(4) COMP-3.
  3363             20  CF-ST-STAT-INTEREST-1      PIC S9V9(4) COMP-3.
  3364             20  CF-ST-STAT-INTEREST-2      PIC S9V9(4) COMP-3.
  3365             20  CF-ST-STAT-INTEREST-3      PIC S9V9(4) COMP-3.
  3366
  3367         16  CF-ST-OVER-SHORT.
  3368             20 CF-ST-OVR-SHT-AMT           PIC S999V99 COMP-3.
  3369             20 CF-ST-OVR-SHT-PCT           PIC S9V9(4) COMP-3.
  3370
  3371         16  CF-ST-FREE-LOOK-PERIOD         PIC S9(3)   COMP-3.
  3372
  3373         16  CF-ST-RT-CALC                  PIC X.
  3374
  3375         16  CF-ST-LF-PREM-TAX              PIC S9V9(4) COMP-3.
  3376         16  CF-ST-AH-PREM-TAX-I            PIC S9V9(4) COMP-3.
  3377         16  CF-ST-AH-PREM-TAX-G            PIC S9V9(4) COMP-3.
  3378         16  CF-ST-RF-LR-CALC               PIC X.
  3379         16  CF-ST-RF-LL-CALC               PIC X.
  3380         16  CF-ST-RF-LN-CALC               PIC X.
  3381         16  CF-ST-RF-AH-CALC               PIC X.
  3382         16  CF-ST-RF-CP-CALC               PIC X.
  3383*        16  FILLER                         PIC X(206).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  66
* EL690.cbl
  3384*CIDMOD         16  FILLER                         PIC X(192).
  3385         16  CF-ST-CHECK-COUNTER            PIC S9(8)   COMP.
  3386             88  CF-ST-CHECK-CNT-RESET      VALUE +9999999.
  3387         16  CF-ST-REF-AH-DEATH-IND         PIC X.
  3388         16  CF-ST-VFY-2ND-BENE             PIC X.
  3389         16  CF-ST-CAUSAL-STATE             PIC X.
  3390         16  CF-ST-EXTRA-INTEREST-PERIODS   PIC 9.
  3391         16  CF-ST-EXTRA-PAYMENTS           PIC 9.
  3392         16  CF-ST-AGENT-SIG-EDIT           PIC X.
  3393             88  CF-ST-EDIT-FOR-SIG           VALUE 'Y'.
  3394         16  CF-ST-NET-ONLY-STATE           PIC X.
  3395             88  CF-ST-IS-NET-ONLY            VALUE 'Y'.
  3396         16  cf-commission-cap-required     pic x.
  3397         16  CF-ST-GA-COMMISSION-CAPS.
  3398             20  CF-ST-GA-COMM-CAP-SL       PIC S9V9(4) COMP-3.
  3399             20  CF-ST-GA-COMM-CAP-JL       PIC S9V9(4) COMP-3.
  3400             20  CF-ST-GA-COMM-CAP-SA       PIC S9V9(4) COMP-3.
  3401             20  CF-ST-GA-COMM-CAP-JA       PIC S9V9(4) COMP-3.
  3402         16  CF-ST-TOT-COMMISSION-CAPS.
  3403             20  CF-ST-TOT-COMM-CAP-SL      PIC S9V9(4) COMP-3.
  3404             20  CF-ST-TOT-COMM-CAP-JL      PIC S9V9(4) COMP-3.
  3405             20  CF-ST-TOT-COMM-CAP-SA      PIC S9V9(4) COMP-3.
  3406             20  CF-ST-TOT-COMM-CAP-JA      PIC S9V9(4) COMP-3.
  3407         16  FILLER                         PIC X(156).
  3408
  3409****************************************************************
  3410*             BENEFIT MASTER RECORD                            *
  3411****************************************************************
  3412
  3413     12  CF-BENEFIT-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3414         16  CF-BENEFIT-CONTROLS  OCCURS 8 TIMES.
  3415             20  CF-BENEFIT-CODE            PIC XX.
  3416             20  CF-BENEFIT-NUMERIC  REDEFINES
  3417                 CF-BENEFIT-CODE            PIC XX.
  3418             20  CF-BENEFIT-ALPHA           PIC XXX.
  3419             20  CF-BENEFIT-DESCRIP         PIC X(10).
  3420             20  CF-BENEFIT-COMMENT         PIC X(10).
  3421
  3422             20  CF-LF-COVERAGE-TYPE        PIC X.
  3423                 88  CF-REDUCING                VALUE 'R'.
  3424                 88  CF-LEVEL                   VALUE 'L' 'P'.
  3425
  3426             20  CF-SPECIAL-CALC-CD         PIC X.
  3427                 88  CF-ALTERNATE-NET-PAY       VALUE 'A'.
  3428                 88  CF-NP-0-MO-INT             VALUE 'A'.
  3429                 88  CF-OB-OFFLINE-RESERVED     VALUE 'B'.
  3430                 88  CF-CRITICAL-PERIOD         VALUE 'C'.
  3431                 88  CF-TERM-IN-DAYS            VALUE 'D'.
  3432                 88  CF-USE-PREMIUM-AS-ENTERED  VALUE 'E'.
  3433                 88  CF-FARM-PLAN               VALUE 'F'.
  3434                 88  CF-RATE-AS-STANDARD        VALUE 'G'.
  3435                 88  CF-2-MTH-INTEREST          VALUE 'I'.
  3436                 88  CF-3-MTH-INTEREST          VALUE 'J'.
  3437                 88  CF-4-MTH-INTEREST          VALUE 'K'.
  3438                 88  CF-BALLOON-LAST-PMT        VALUE 'L'.
  3439                 88  CF-MORTGAGE-PROCESSING     VALUE 'M'.
  3440                 88  CF-PRUDENTIAL              VALUE 'P'.
  3441                 88  CF-OUTSTANDING-BAL         VALUE 'O'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  67
* EL690.cbl
  3442                 88  CF-TRUNCATED-LIFE          VALUE 'T'.
  3443                 88  CF-TRUNCATED-LIFE-ONE      VALUE 'U'.
  3444                 88  CF-TRUNCATED-LIFE-TWO      VALUE 'V'.
  3445                 88  CF-NET-PAY-SIMPLE          VALUE 'S'.
  3446                 88  CF-SUMMARY-PROCESSING      VALUE 'Z'.
  3447
  3448             20  CF-JOINT-INDICATOR         PIC X.
  3449                 88  CF-JOINT-COVERAGE          VALUE 'J'.
  3450
  3451*            20  FILLER                     PIC X(12).
  3452             20  cf-maximum-benefits        pic s999 comp-3.
  3453             20  FILLER                     PIC X(09).
  3454             20  CF-BENEFIT-CATEGORY        PIC X.
  3455             20  CF-LOAN-TYPE               PIC X(8).
  3456
  3457             20  CF-CO-REM-TERM-CALC        PIC X.
  3458                 88  CO-EARN-AFTER-15TH         VALUE '1'.
  3459                 88  CO-EARN-ON-HALF-MO         VALUE '2'.
  3460                 88  CO-EARN-ON-1ST-DAY         VALUE '3'.
  3461                 88  CO-EARN-ON-FULL-MO         VALUE '4'.
  3462                 88  CO-EARN-WITH-NO-DAYS       VALUE '5'.
  3463
  3464             20  CF-CO-EARNINGS-CALC        PIC X.
  3465                 88  CO-EARN-BY-R78             VALUE '1'.
  3466                 88  CO-EARN-BY-PRO-RATA        VALUE '2'.
  3467                 88  CO-EARN-AS-CALIF           VALUE '3'.
  3468                 88  CO-EARN-AS-TEXAS           VALUE '4'.
  3469                 88  CO-EARN-IS-NET-PAY         VALUE '5'.
  3470                 88  CO-EARN-ANTICIPATION       VALUE '6'.
  3471                 88  CO-EARN-AS-MEAN            VALUE '8'.
  3472                 88  CO-EARN-AS-REG-BALLOON     VALUE 'B'.
  3473
  3474             20  CF-CO-REFUND-CALC          PIC X.
  3475                 88  CO-REFUND-NOT-USED         VALUE SPACE.
  3476                 88  CO-REFD-BY-R78             VALUE '1'.
  3477                 88  CO-REFD-BY-PRO-RATA        VALUE '2'.
  3478                 88  CO-REFD-AS-CALIF           VALUE '3'.
  3479                 88  CO-REFD-AS-TEXAS           VALUE '4'.
  3480                 88  CO-REFD-IS-NET-PAY         VALUE '5'.
  3481                 88  CO-REFD-ANTICIPATION       VALUE '6'.
  3482                 88  CO-REFD-MEAN               VALUE '8'.
  3483                 88  CO-REFD-SUM-OF-DIGITS      VALUE '9'.
  3484                 88  CO-REFD-AS-REG-BALLOON     VALUE 'B'.
  3485                 88  CO-REFD-GAP-NON-REFUND     VALUE 'G'.
  3486
  3487             20  CF-CO-OVRD-EARNINGS-CALC   PIC X.
  3488                 88  CO-OVERRIDE-NOT-USED       VALUE SPACE.
  3489                 88  CO-OVRD-BY-R78             VALUE '1'.
  3490                 88  CO-OVRD-BY-PRO-RATA        VALUE '2'.
  3491                 88  CO-OVRD-AS-CALIF           VALUE '3'.
  3492                 88  CO-OVRD-AS-TEXAS           VALUE '4'.
  3493                 88  CO-OVRD-IS-NET-PAY         VALUE '5'.
  3494                 88  CO-OVRD-ANTICIPATION       VALUE '6'.
  3495                 88  CO-OVRD-MEAN               VALUE '8'.
  3496                 88  CO-OVRD-AS-REG-BALLOON     VALUE 'B'.
  3497
  3498             20  CF-CO-BEN-I-G-CD           PIC X.
  3499                 88  CO-BEN-I-G-NOT-USED        VALUE SPACE.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  68
* EL690.cbl
  3500                 88  CO-BEN-I-G-IS-INDV         VALUE 'I'.
  3501                 88  CO-BEN-I-G-IS-GRP          VALUE 'G'.
  3502
  3503         16  FILLER                         PIC X(304).
  3504
  3505
  3506****************************************************************
  3507*             CARRIER MASTER RECORD                            *
  3508****************************************************************
  3509
  3510     12  CF-CARRIER-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3511         16  CF-ADDRESS-DATA.
  3512             20  CF-MAIL-TO-NAME            PIC X(30).
  3513             20  CF-IN-CARE-OF              PIC X(30).
  3514             20  CF-ADDRESS-LINE-1          PIC X(30).
  3515             20  CF-ADDRESS-LINE-2          PIC X(30).
  3516             20  CF-CITY-STATE              PIC X(30).
  3517             20  CF-ZIP-CODE-NUM            PIC 9(9)      COMP-3.
  3518             20  CF-PHONE-NO                PIC 9(11)     COMP-3.
  3519
  3520         16  CF-CLAIM-NO-CONTROL.
  3521             20  CF-CLAIM-NO-METHOD         PIC X.
  3522                 88  CLAIM-NO-MANUAL            VALUE '1'.
  3523                 88  CLAIM-NO-Y-M-SEQ           VALUE '2'.
  3524                 88  CLAIM-NO-SEQ               VALUE '3'.
  3525                 88  CLAIM-NO-ALPHA-SEQ         VALUE '5'.
  3526             20  CF-CLAIM-COUNTER           PIC S9(8)   COMP.
  3527                 88  CLAIM-CNT-RESET-IF-SEQ     VALUE +9999999.
  3528                 88  CLAIM-CNT-RESET-IF-YRMO    VALUE +99999.
  3529                 88  CLAIM-CNT-RESET-IF-YRALPHA VALUE +9999.
  3530
  3531         16  CF-CHECK-NO-CONTROL.
  3532             20  CF-CHECK-NO-METHOD         PIC X.
  3533                 88  CHECK-NO-MANUAL            VALUE '1'.
  3534                 88  CHECK-NO-AUTO-SEQ          VALUE '2'.
  3535                 88  CHECK-NO-CARR-SEQ          VALUE '3'.
  3536                 88  CHECK-NO-AT-PRINT          VALUE '4'.
  3537             20  CF-CHECK-COUNTER           PIC S9(8)   COMP.
  3538                 88  CHECK-CNT-RESET-VALUE      VALUE +999999.
  3539
  3540         16  CF-DOMICILE-STATE              PIC XX.
  3541
  3542         16  CF-EXPENSE-CONTROLS.
  3543             20  CF-EXPENSE-METHOD          PIC X.
  3544                 88  EXPENSE-CALC-MANUAL        VALUE '1'.
  3545                 88  DOLLARS-PER-PMT            VALUE '2'.
  3546                 88  PERCENT-OF-PAYMENT         VALUE '3'.
  3547                 88  DOLLARS-PER-MONTH          VALUE '4'.
  3548             20  CF-EXPENSE-PERCENT         PIC S999V99   COMP-3.
  3549             20  CF-EXPENSE-DOLLAR          PIC S999V99   COMP-3.
  3550
  3551         16  CF-CORRESPONDENCE-CONTROL.
  3552             20  CF-LETTER-RESEND-OPT       PIC X.
  3553                 88  LETTERS-NOT-ARCHIVED       VALUE SPACE.
  3554                 88  LETTERS-ARE-ARCHIVED       VALUE '1'.
  3555             20  FILLER                     PIC X(4).
  3556
  3557         16  CF-RESERVE-CONTROLS.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  69
* EL690.cbl
  3558             20  CF-MANUAL-SW               PIC X.
  3559                 88  CF-MANUAL-RESERVES-USED    VALUE '1'.
  3560             20  CF-FUTURE-SW               PIC X.
  3561                 88  CF-FUTURE-RESERVES-USED    VALUE '1'.
  3562             20  CF-PTC-SW                  PIC X.
  3563                 88  CF-PAY-TO-CURRENT-USED     VALUE '1'.
  3564             20  CF-IBNR-SW                 PIC X.
  3565                 88  CF-IBNR-RESERVES-USED      VALUE '1'.
  3566             20  CF-PTC-LF-SW               PIC X.
  3567                 88  CF-LF-PTC-USED             VALUE '1'.
  3568             20  CF-CDT-ACCESS-METHOD       PIC X.
  3569                 88  CF-CDT-ROUND-NEAR          VALUE '1'.
  3570                 88  CF-CDT-ROUND-HIGH          VALUE '2'.
  3571                 88  CF-CDT-INTERPOLATED        VALUE '3'.
  3572             20  CF-PERCENT-OF-CDT          PIC S999V99   COMP-3.
  3573
  3574         16  CF-CLAIM-CALC-METHOD           PIC X.
  3575             88  360-PLUS-MONTHS                VALUE '1'.
  3576             88  365-PLUS-MONTHS                VALUE '2'.
  3577             88  FULL-MONTHS-ACTUAL-DAY         VALUE '3'.
  3578             88  360-DAILY                      VALUE '4'.
  3579             88  365-DAILY                      VALUE '5'.
  3580
  3581         16  CF-LAST-ALPHA-CHARACTER        PIC X.
  3582         16  FILLER                         PIC X(11).
  3583
  3584         16  CF-LIMIT-AMOUNTS.
  3585             20  CF-CALC-AMT-TOL            PIC S999V99   COMP-3.
  3586             20  CF-MAX-REG-PMT             PIC S9(7)V99  COMP-3.
  3587             20  CF-MAX-REG-DAYS            PIC S999      COMP-3.
  3588             20  CF-MAX-AUTO-PMT            PIC S9(7)V99  COMP-3.
  3589             20  CF-MAX-AUTO-MOS            PIC S999      COMP-3.
  3590             20  CF-CALC-DAYS-TOL           PIC S999      COMP-3.
  3591             20  CF-CR-TOL-PREM             PIC S999V99   COMP-3.
  3592             20  CF-CR-TOL-REFUND           PIC S999V99   COMP-3.
  3593             20  CF-CR-TOL-PREM-PCT         PIC S9V9(4)   COMP-3.
  3594             20  CF-CR-TOL-REFUND-PCT       PIC S9V9(4)   COMP-3.
  3595
  3596         16  CF-DAYS-BEFORE-CLOSED          PIC S999      COMP-3.
  3597         16  CF-MONTHS-BEFORE-PURGED        PIC S999      COMP-3.
  3598         16  CF-IBNR-PERCENT                PIC S9V9(4)   COMP-3.
  3599
  3600         16  CF-ZIP-CODE.
  3601             20  CF-ZIP-PRIME.
  3602                 24  CF-ZIP-1ST             PIC X.
  3603                     88  CF-CANADIAN-POST-CODE VALUE 'A' THRU 'Z'.
  3604                 24  FILLER                 PIC X(4).
  3605             20  CF-ZIP-PLUS4               PIC X(4).
  3606         16  CF-CANADIAN-POSTAL-CODE REDEFINES CF-ZIP-CODE.
  3607             20  CF-CAN-POSTAL-1            PIC XXX.
  3608             20  CF-CAN-POSTAL-2            PIC XXX.
  3609             20  FILLER                     PIC XXX.
  3610
  3611         16  CF-IBNR-UEPRM-PERCENT          PIC S9V9(4) COMP-3.
  3612         16  CF-IBNR-R78-PERCENT            PIC S9V9(4) COMP-3.
  3613         16  CF-IBNR-PRO-PERCENT            PIC S9V9(4) COMP-3.
  3614
  3615         16  CF-RATING-SWITCH               PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  70
* EL690.cbl
  3616             88  CF-PERFORM-RATING              VALUE ' ' 'Y'.
  3617             88  CF-NO-RATING                   VALUE 'N'.
  3618
  3619         16  CF-BUILD-RETRIEVE-AFTER-MONTHS PIC 99.
  3620
  3621         16  CF-CARRIER-OVER-SHORT.
  3622             20 CF-CR-OVR-SHT-AMT           PIC S999V99   COMP-3.
  3623             20 CF-CR-OVR-SHT-PCT           PIC S9V9(4)   COMP-3.
  3624
  3625         16  CF-CARRIER-CLP-TOL-PCT         PIC S9V9(4)   COMP-3.
  3626         16  CF-SECPAY-SWITCH               PIC X.
  3627             88  CF-SECURE-PAY-CARRIER          VALUE 'Y'.
  3628             88  CF-NO-SECURE-PAY               VALUE ' ' 'N'.
  3629         16  CF-CARRIER-LEASE-COMM          PIC S9(5)V99  COMP-3.
  3630         16  CF-CARRIER-NEXT-AUDIT-CHK-NO   PIC S9(8)     COMP.
  3631         16  FILLER                         PIC X(444).
  3632*        16  FILLER                         PIC X(452).
  3633
  3634
  3635****************************************************************
  3636*             MORTALITY MASTER RECORD                          *
  3637****************************************************************
  3638
  3639     12  CF-MORTALITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3640         16  CF-MORT-TABLE-LINE OCCURS  9  TIMES
  3641                                INDEXED BY CF-MORT-NDX.
  3642             20  CF-MORT-TABLE              PIC X(5).
  3643             20  CF-MORT-TABLE-TYPE         PIC X.
  3644                 88  CF-MORT-JOINT              VALUE 'J'.
  3645                 88  CF-MORT-SINGLE             VALUE 'S'.
  3646                 88  CF-MORT-COMBINED           VALUE 'C'.
  3647                 88  CF-MORT-TYPE-VALID-C       VALUE 'J' 'S'.
  3648                 88  CF-MORT-TYPE-VALID-M       VALUE 'J' 'S' 'C'.
  3649             20  CF-MORT-INTEREST           PIC SV9(4)  COMP-3.
  3650             20  CF-MORT-AGE-METHOD         PIC XX.
  3651                 88  CF-AGE-LAST                VALUE 'AL'.
  3652                 88  CF-AGE-NEAR                VALUE 'AN'.
  3653             20  CF-MORT-RESERVE-ADJUSTMENT PIC S9V9(4) COMP-3.
  3654             20  CF-MORT-ADJUSTMENT-DIRECTION
  3655                                            PIC X.
  3656                 88  CF-MINUS                   VALUE '-'.
  3657                 88  CF-PLUS                    VALUE '+'.
  3658             20  CF-MORT-JOINT-FACTOR       PIC S9V9(4) COMP-3.
  3659             20  CF-MORT-JOINT-CODE         PIC X.
  3660                 88  CF-VALID-JOINT-CODE        VALUE 'A' 'V'.
  3661             20  CF-MORT-PC-Q               PIC X.
  3662                 88  CF-VALID-PC-Q              VALUE 'Y' 'N' ' '.
  3663             20  CF-MORT-TABLE-CODE         PIC X(4).
  3664             20  CF-MORT-COMMENTS           PIC X(15).
  3665             20  FILLER                     PIC X(14).
  3666
  3667         16  FILLER                         PIC X(251).
  3668
  3669
  3670****************************************************************
  3671*             BUSSINESS TYPE MASTER RECORD                     *
  3672****************************************************************
  3673
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  71
* EL690.cbl
  3674     12  CF-BUSINESS-TYPE-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3675* FIRST ENTRY IS TYPE 01.. LAST IS TYPE 20
  3676* RECORD 02 IS TYPES 21-40..RECORD 03 IS 41-60..04 IS 61-80
  3677* AND RECORD 05 IS TYPES 81-99
  3678         16  CF-TYPE-DESCRIPTIONS   OCCURS  20  TIMES.
  3679             20  CF-BUSINESS-TITLE          PIC  X(19).
  3680             20  CF-BUS-MOD-ST-TRGT-LOSS-RATIO
  3681                                            PIC S9V9(4) COMP-3.
  3682             20  CF-BUS-EXCL-ST-CALL        PIC  X.
  3683             20  FILLER                     PIC  X.
  3684         16  FILLER                         PIC  X(248).
  3685
  3686
  3687****************************************************************
  3688*             TERMINAL MASTER RECORD                           *
  3689****************************************************************
  3690
  3691     12  CF-TERMINAL-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  3692
  3693         16  CF-COMPANY-TERMINALS.
  3694             20  CF-TERMINAL-ID  OCCURS 120 TIMES
  3695                                  PIC X(4).
  3696         16  FILLER               PIC X(248).
  3697
  3698
  3699****************************************************************
  3700*             LIFE EDIT MASTER RECORD                          *
  3701****************************************************************
  3702
  3703     12  CF-LIFE-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3704         16  CF-LIFE-EDIT-ENTRIES   OCCURS 120  TIMES.
  3705             20  CF-LIFE-CODE-IN            PIC XX.
  3706             20  CF-LIFE-CODE-OUT           PIC XX.
  3707         16  FILLER                         PIC X(248).
  3708
  3709
  3710****************************************************************
  3711*             AH EDIT MASTER RECORD                            *
  3712****************************************************************
  3713
  3714     12  CF-AH-EDIT-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3715         16  CF-AH-EDIT-ENTRIES   OCCURS  96  TIMES.
  3716             20  CF-AH-CODE-IN              PIC XXX.
  3717             20  CF-AH-CODE-OUT             PIC XX.
  3718         16  FILLER                         PIC X(248).
  3719
  3720
  3721****************************************************************
  3722*             CREDIBILITY TABLES                               *
  3723****************************************************************
  3724
  3725     12  CF-CREDIBILITY-MASTER-REC REDEFINES  CF-RECORD-BODY.
  3726         16  CF-CRDB-ENTRY   OCCURS 36 TIMES
  3727                             INDEXED BY CF-CRDB-NDX.
  3728             20  CF-CRDB-FROM               PIC S9(7)   COMP-3.
  3729             20  CF-CRDB-TO                 PIC S9(7)   COMP-3.
  3730             20  CF-CREDIBILITY-FACTOR      PIC S9V9(4) COMP-3.
  3731         16  FILLER                         PIC  X(332).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  72
* EL690.cbl
  3732
  3733
  3734****************************************************************
  3735*             REPORT CUSTOMIZATION RECORD                      *
  3736****************************************************************
  3737
  3738     12  CF-CUSTOM-REPORT-REC  REDEFINES  CF-RECORD-BODY.
  3739         16  CF-ACCOUNT-MASTER-STATUS       PIC X.
  3740             88  CF-ACTIVE-ACCOUNTS             VALUE 'A'.
  3741             88  CF-INACTIVE-ACCOUNTS           VALUE 'I'.
  3742             88  CF-CANCELLED-ACCOUNTS          VALUE 'C'.
  3743**** NOTE: INACTIVE WILL INCLUDE ACCOUNT MASTER CODED WITH ****
  3744****       A T-TRANSFER.                                   ****
  3745             88  CF-ALL-ACCOUNTS                VALUE 'B'.
  3746
  3747         16  FILLER                         PIC XX.
  3748
  3749         16  CF-CARRIER-CNTL-OPT.
  3750             20  CF-CARRIER-OPT-SEQ         PIC 9.
  3751                 88  CF-CARRIER-OPT-USED        VALUE 1 THRU 6.
  3752                 88  CF-CARRIER-OPT-NOT-USED    VALUE 0.
  3753             20  CF-CARRIER-SELECT OCCURS 3 TIMES
  3754                                            PIC X.
  3755         16  CF-GROUP-CNTL-OPT.
  3756             20  CF-GROUP-OPT-SEQ           PIC 9.
  3757                 88  CF-GROUP-OPT-USED          VALUE 1 THRU 6.
  3758                 88  CF-GROUP-OPT-NOT-USED      VALUE 0.
  3759             20  CF-GROUP-SELECT OCCURS 3 TIMES
  3760                                            PIC X(6).
  3761         16  CF-STATE-CNTL-OPT.
  3762             20  CF-STATE-OPT-SEQ           PIC 9.
  3763                 88  CF-STATE-OPT-USED          VALUE 1 THRU 6.
  3764                 88  CF-STATE-OPT-NOT-USED      VALUE 0.
  3765             20  CF-STATE-SELECT OCCURS 3 TIMES
  3766                                            PIC XX.
  3767         16  CF-ACCOUNT-CNTL-OPT.
  3768             20  CF-ACCOUNT-OPT-SEQ         PIC 9.
  3769                 88  CF-ACCOUNT-OPT-USED        VALUE 1 THRU 6.
  3770                 88  CF-ACCOUNT-OPT-NOT-USED    VALUE 0.
  3771             20  CF-ACCOUNT-SELECT OCCURS 3 TIMES
  3772                                            PIC X(10).
  3773         16  CF-BUS-TYP-CNTL-OPT.
  3774             20  CF-BUS-TYP-OPT-SEQ         PIC 9.
  3775                 88  CF-BUS-TYP-OPT-USED        VALUE 1 THRU 6.
  3776                 88  CF-BUS-TYP-OPT-NOT-USED    VALUE 0.
  3777             20  CF-BUS-TYP-SELECT OCCURS 3 TIMES
  3778                                            PIC XX.
  3779         16  CF-LF-TYP-CNTL-OPT.
  3780             20  CF-LF-TYP-OPT-SEQ          PIC 9.
  3781                 88  CF-LF-TYP-OPT-USED         VALUE 1 THRU 6.
  3782                 88  CF-LF-TYP-OPT-NOT-USED     VALUE 0.
  3783             20  CF-BUS-LF-SELECT OCCURS 3 TIMES
  3784                                            PIC XX.
  3785         16  CF-AH-TYP-CNTL-OPT.
  3786             20  CF-AH-TYP-OPT-SEQ          PIC 9.
  3787                 88  CF-AH-TYP-OPT-USED         VALUE 1 THRU 6.
  3788                 88  CF-AH-TYP-OPT-NOT-USED     VALUE 0.
  3789             20  CF-BUS-AH-SELECT OCCURS 3 TIMES
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  73
* EL690.cbl
  3790                                            PIC XX.
  3791         16  CF-REPTCD1-CNTL-OPT.
  3792             20  CF-REPTCD1-OPT-SEQ         PIC 9.
  3793                 88  CF-REPTCD1-OPT-USED        VALUE 1 THRU 6.
  3794                 88  CF-REPTCD1-OPT-NOT-USED    VALUE 0.
  3795             20  CF-REPTCD1-SELECT OCCURS 3 TIMES
  3796                                            PIC X(10).
  3797         16  CF-REPTCD2-CNTL-OPT.
  3798             20  CF-REPTCD2-OPT-SEQ         PIC 9.
  3799                 88  CF-REPTCD2-OPT-USED        VALUE 1 THRU 6.
  3800                 88  CF-REPTCD2-OPT-NOT-USED    VALUE 0.
  3801             20  CF-REPTCD2-SELECT OCCURS 3 TIMES
  3802                                            PIC X(10).
  3803         16  CF-USER1-CNTL-OPT.
  3804             20  CF-USER1-OPT-SEQ           PIC 9.
  3805                 88  CF-USER1-OPT-USED          VALUE 1 THRU 6.
  3806                 88  CF-USER1-OPT-NOT-USED      VALUE 0.
  3807             20  CF-USER1-SELECT OCCURS 3 TIMES
  3808                                            PIC X(10).
  3809         16  CF-USER2-CNTL-OPT.
  3810             20  CF-USER2-OPT-SEQ           PIC 9.
  3811                 88  CF-USER2-OPT-USED          VALUE 1 THRU 6.
  3812                 88  CF-USER2-OPT-NOT-USED      VALUE 0.
  3813             20  CF-USER2-SELECT OCCURS 3 TIMES
  3814                                            PIC X(10).
  3815         16  CF-USER3-CNTL-OPT.
  3816             20  CF-USER3-OPT-SEQ           PIC 9.
  3817                 88  CF-USER3-OPT-USED          VALUE 1 THRU 6.
  3818                 88  CF-USER3-OPT-NOT-USED      VALUE 0.
  3819             20  CF-USER3-SELECT OCCURS 3 TIMES
  3820                                            PIC X(10).
  3821         16  CF-USER4-CNTL-OPT.
  3822             20  CF-USER4-OPT-SEQ           PIC 9.
  3823                 88  CF-USER4-OPT-USED          VALUE 1 THRU 6.
  3824                 88  CF-USER4-OPT-NOT-USED      VALUE 0.
  3825             20  CF-USER4-SELECT OCCURS 3 TIMES
  3826                                            PIC X(10).
  3827         16  CF-USER5-CNTL-OPT.
  3828             20  CF-USER5-OPT-SEQ           PIC 9.
  3829                 88  CF-USER5-OPT-USED          VALUE 1 THRU 6.
  3830                 88  CF-USER5-OPT-NOT-USED      VALUE 0.
  3831             20  CF-USER5-SELECT OCCURS 3 TIMES
  3832                                            PIC X(10).
  3833         16  CF-REINS-CNTL-OPT.
  3834             20  CF-REINS-OPT-SEQ           PIC 9.
  3835                 88  CF-REINS-OPT-USED          VALUE 1 THRU 6.
  3836                 88  CF-REINS-OPT-NOT-USED      VALUE 0.
  3837             20  CF-REINS-SELECT OCCURS 3 TIMES.
  3838                 24  CF-REINS-PRIME         PIC XXX.
  3839                 24  CF-REINS-SUB           PIC XXX.
  3840
  3841         16  CF-AGENT-CNTL-OPT.
  3842             20  CF-AGENT-OPT-SEQ           PIC 9.
  3843                 88  CF-AGENT-OPT-USED          VALUE 1 THRU 6.
  3844                 88  CF-AGENT-OPT-NOT-USED      VALUE 0.
  3845             20  CF-AGENT-SELECT OCCURS 3 TIMES
  3846                                            PIC X(10).
  3847
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  74
* EL690.cbl
  3848         16  FILLER                         PIC X(43).
  3849
  3850         16  CF-LOSS-RATIO-SELECT.
  3851             20  CF-SEL-LO-LOSS-RATIO       PIC S999V99  COMP-3.
  3852             20  CF-SEL-HI-LOSS-RATIO       PIC S999V99  COMP-3.
  3853         16  CF-ENTRY-DATE-SELECT.
  3854             20  CF-SEL-LO-ENTRY-DATE       PIC XX.
  3855             20  CF-SEL-HI-ENTRY-DATE       PIC XX.
  3856         16  CF-EFFECTIVE-DATE-SELECT.
  3857             20  CF-SEL-LO-EFFECTIVE-DATE   PIC XX.
  3858             20  CF-SEL-HI-EFFECTIVE-DATE   PIC XX.
  3859
  3860         16  CF-EXCEPTION-LIST-IND          PIC X.
  3861             88  CF-EXCEPTION-LIST-REQUESTED VALUE 'Y'.
  3862
  3863         16  FILLER                         PIC X(318).
  3864
  3865****************************************************************
  3866*                  EXCEPTION REPORTING RECORD                  *
  3867****************************************************************
  3868
  3869     12  CF-EXCEPTION-REPORT-REC REDEFINES   CF-RECORD-BODY.
  3870         16  CF-ACCOUNTS-LT-ONE-YEAR        PIC X.
  3871             88  CF-EXCEPTION-ACCTS-WITHIN-ONE  VALUE 'Y'.
  3872
  3873         16  CF-COMBINED-LIFE-AH-OPT.
  3874             20  CF-ISS-COUNT-DIFF          PIC S9(05)     COMP-3.
  3875             20  CF-SINGLE-MO-PREM-PCT      PIC S9(02).
  3876             20  CF-EARN-PREM-DECR-PCT      PIC S9(02).
  3877             20  CF-CANCELLATION-RATIO      PIC S9(02).
  3878
  3879         16  CF-LIFE-OPT.
  3880             20  CF-LF-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3881             20  CF-LF-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3882             20  CF-LF-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3883             20  CF-LF-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3884             20  CF-LF-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3885             20  CF-LF-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3886             20  CF-LF-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3887             20  CF-LF-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3888             20  CF-LF-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3889             20  CF-LF-AVG-AGE-MAX          PIC S9(02).
  3890
  3891         16  CF-AH-OPT.
  3892             20  CF-AH-LOSS-RATIO-PCT       PIC S9(03)     COMP-3.
  3893             20  CF-AH-LTM-LOSS-RATIO       PIC S9(03)     COMP-3.
  3894             20  CF-AH-PERIOD-PROFIT        PIC S9(03)     COMP-3.
  3895             20  CF-AH-LTM-PROFIT-PCT       PIC S9(02)V9   COMP-3.
  3896             20  CF-AH-LTM-INFORCE-DECR     PIC S9(02)V9   COMP-3.
  3897             20  CF-AH-LTM-TERM-CHG         PIC S9(02)V9   COMP-3.
  3898             20  CF-AH-TERM-AVG-WEIGHTED    PIC S9(02)V9   COMP-3.
  3899             20  CF-AH-LTM-AGE-PCT          PIC S9(02)V9   COMP-3.
  3900             20  CF-AH-AGE-AVG-WEIGHTED     PIC S9(02)V9   COMP-3.
  3901             20  CF-AH-AVG-AGE-MAX          PIC S9(02).
  3902
  3903         16  CF-ACCT-ZERO-MONTH-PRODUCTION PIC X.
  3904             88  CF-ACCT-CURRENT-MONTH-ACT      VALUE 'A'.
  3905             88  CF-ACCT-WITH-NO-PRODUCTION     VALUE 'B'.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  75
* EL690.cbl
  3906             88  CF-ACCT-WITH-ISSUE-ACTIVITY    VALUE 'C'.
  3907
  3908         16  CF-RETENTION-LIMIT             PIC S9(7)      COMP-3.
  3909
  3910         16  FILLER                         PIC X(673).
  3911
  3912
  3913****************************************************************
  3914*             MORTGAGE SYSTEM PLAN RECORD                      *
  3915****************************************************************
  3916
  3917     12  CF-MORTGAGE-PLAN-MASTER  REDEFINES  CF-RECORD-BODY.
  3918         16  CF-PLAN-TYPE                   PIC X.
  3919             88  CF-LIFE-MORT-PLAN             VALUE 'L'.
  3920             88  CF-DISAB-MORT-PLAN            VALUE 'D'.
  3921             88  CF-AD-D-MORT-PLAN             VALUE 'A'.
  3922         16  CF-PLAN-ABBREV                 PIC XXX.
  3923         16  CF-PLAN-DESCRIPT               PIC X(10).
  3924         16  CF-PLAN-NOTES                  PIC X(20).
  3925         16  CF-PLAN-ESTABLISH-DATE         PIC XX.
  3926         16  CF-PLAN-UNDERWRITING.
  3927             20  CF-PLAN-TERM-DATA.
  3928                 24  CF-MINIMUM-TERM        PIC S999      COMP-3.
  3929                 24  CF-MAXIMUM-TERM        PIC S999      COMP-3.
  3930             20  CF-PLAN-AGE-DATA.
  3931                 24  CF-MINIMUM-AGE         PIC S999      COMP-3.
  3932                 24  CF-MAXIMUM-AGE         PIC S999      COMP-3.
  3933                 24  CF-MAXIMUM-ATTAIN-AGE  PIC S999      COMP-3.
  3934             20  CF-PLAN-BENEFIT-DATA.
  3935                 24  CF-MINIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3936                 24  CF-MAXIMUM-BENEFIT     PIC S9(7)V99  COMP-3.
  3937                 24  CF-MAXIMUM-MONTHLY-BENEFIT
  3938                                            PIC S9(7)V99  COMP-3.
  3939         16  CF-PLAN-POLICY-FORMS.
  3940             20  CF-POLICY-FORM             PIC X(12).
  3941             20  CF-MASTER-APPLICATION      PIC X(12).
  3942             20  CF-MASTER-POLICY           PIC X(12).
  3943         16  CF-PLAN-RATING.
  3944             20  CF-RATE-CODE               PIC X(5).
  3945             20  CF-SEX-RATING              PIC X.
  3946                 88  CF-PLAN-NOT-SEX-RATED     VALUE '1'.
  3947                 88  CF-PLAN-SEX-RATED         VALUE '2'.
  3948             20  CF-SUB-STD-PCT             PIC S9V9999   COMP-3.
  3949             20  CF-SUB-STD-TYPE            PIC X.
  3950                 88  CF-PCT-OF-PREM            VALUE '1'.
  3951                 88  CF-PCT-OF-BENE            VALUE '2'.
  3952         16  CF-PLAN-PREM-TOLERANCES.
  3953             20  CF-PREM-TOLERANCE          PIC S999      COMP-3.
  3954             20  CF-PREM-TOLERANCE-PCT      PIC SV999     COMP-3.
  3955         16  CF-PLAN-PYMT-TOLERANCES.
  3956             20  CF-PYMT-TOLERANCE          PIC S999      COMP-3.
  3957             20  CF-PYMT-TOLERANCE-PCT      PIC SV999     COMP-3.
  3958         16  CF-PLAN-MISC-DATA.
  3959             20  FILLER                     PIC X.
  3960             20  CF-FREE-EXAM-DAYS          PIC S999      COMP-3.
  3961             20  CF-RETRO-RETENTION         PIC S9V9999   COMP-3.
  3962         16  CF-MORT-PLAN-USE-CTR           PIC S999      COMP-3.
  3963         16  CF-PLAN-IND-GRP                PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  76
* EL690.cbl
  3964             88  CF-MORT-INDIV-PLAN            VALUE 'I'
  3965                                                     '1'.
  3966             88  CF-MORT-GROUP-PLAN            VALUE 'G'
  3967                                                     '2'.
  3968         16  CF-MIB-SEARCH-SW               PIC X.
  3969             88  CF-MIB-SEARCH-ALL             VALUE '1'.
  3970             88  CF-MIB-SEARCH-NONE            VALUE '2'.
  3971             88  CF-MIB-SEARCH-EXCEEDED        VALUE '3'.
  3972             88  CF-MIB-SEARCH-VALID      VALUES ARE '1' '2' '3'.
  3973         16  CF-ALPHA-SEARCH-SW             PIC X.
  3974             88  CF-MIB-ALPHA-ALL              VALUE '1'.
  3975             88  CF-MIB-ALPHA-NONE             VALUE '2'.
  3976             88  CF-MIB-APLHA-EXCEEDED         VALUE '3'.
  3977             88  CF-CLIENT-ALPHA-ALL           VALUE 'A'.
  3978             88  CF-CLIENT-ALPHA-NONE          VALUE 'B'.
  3979             88  CF-CLIENT-APLHA-EXCEEDED      VALUE 'C'.
  3980             88  CF-BOTH-ALPHA-ALL             VALUE 'X'.
  3981             88  CF-BOTH-ALPHA-NONE            VALUE 'Y'.
  3982             88  CF-BOTH-APLHA-EXCEEDED        VALUE 'Z'.
  3983             88  CF-ALPHA-SEARCH-VALID    VALUES ARE '1' '2' '3'
  3984                                                     'A' 'B' 'C'
  3985                                                     'X' 'Y' 'Z'.
  3986         16  CF-EFF-DT-RULE-SW              PIC X.
  3987             88  CF-EFF-DT-ENTER               VALUE 'E'.
  3988             88  CF-EFF-DT-MONTH               VALUE 'M'.
  3989             88  CF-EFF-DT-QTR                 VALUE 'Q'.
  3990             88  CF-EFF-DT-SEMI                VALUE 'S'.
  3991             88  CF-EFF-DT-ANN                 VALUE 'A'.
  3992         16  FILLER                         PIC X(4).
  3993         16  CF-HEALTH-QUESTIONS            PIC X.
  3994             88  CF-VALID-QUESTIONS-CNT VALUES ARE '0' THRU '9'.
  3995         16  CF-GRACE-PERIOD                PIC S999      COMP-3.
  3996         16  CF-NUMBER-LAPSE-NOTICES        PIC S999      COMP-3.
  3997         16  CF-PLAN-SNGL-JNT               PIC X.
  3998             88  CF-COMBINED-PLAN              VALUE 'C'.
  3999             88  CF-JNT-PLAN                   VALUE 'J'.
  4000             88  CF-SNGL-PLAN                  VALUE 'S'.
  4001         16  CF-DAYS-TO-1ST-NOTICE          PIC  99.
  4002         16  CF-DAYS-TO-2ND-NOTICE          PIC  99.
  4003         16  CF-DAYS-TO-3RD-NOTICE          PIC  99.
  4004         16  CF-DAYS-TO-4TH-NOTICE          PIC  99.
  4005         16  CF-RERATE-CNTL                 PIC  X.
  4006             88  CF-RERATE-WITH-ISSUE-AGE       VALUE '1'.
  4007             88  CF-RERATE-WITH-CURRENT-AGE     VALUE '2'.
  4008             88  CF-DO-NOT-RERATE               VALUE '3' ' '.
  4009             88  CF-AUTO-RECALC                 VALUE '4'.
  4010         16  CF-BENEFIT-TYPE                PIC  X.
  4011             88  CF-BENEFIT-IS-LEVEL            VALUE '1'.
  4012             88  CF-BENEFIT-REDUCES             VALUE '2'.
  4013         16  CF-POLICY-FEE                  PIC S999V99
  4014                                                    COMP-3.
  4015         16  CF-1ST-NOTICE-FORM             PIC  X(04).
  4016         16  CF-2ND-NOTICE-FORM             PIC  X(04).
  4017         16  CF-3RD-NOTICE-FORM             PIC  X(04).
  4018         16  CF-4TH-NOTICE-FORM             PIC  X(04).
  4019         16  FILLER                         PIC  X(32).
  4020         16  CF-TERMINATION-FORM            PIC  X(04).
  4021         16  FILLER                         PIC  X(08).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  77
* EL690.cbl
  4022         16  CF-CLAIM-CAP                   PIC S9(7)V99
  4023                                                       COMP-3.
  4024         16  CF-REOCCURRING-DISABILITY-PRD  PIC S999   COMP-3.
  4025         16  CF-ISSUE-LETTER                PIC  X(4).
  4026         16  CF-YEARS-TO-NEXT-RERATE        PIC  99.
  4027         16  CF-DEPENDENT-COVERAGE          PIC  X.
  4028             88  CF-YES-DEP-COV                 VALUE 'Y'.
  4029             88  CF-NO-DEP-COV             VALUES ARE 'N' ' '.
  4030         16  CF-MP-REFUND-CALC              PIC X.
  4031             88  CF-MP-REFUND-NOT-USED          VALUE SPACE.
  4032             88  CF-MP-REFD-BY-R78              VALUE '1'.
  4033             88  CF-MP-REFD-BY-PRO-RATA         VALUE '2'.
  4034             88  CF-MP-REFD-AS-CALIF            VALUE '3'.
  4035             88  CF-MP-REFD-AS-TEXAS            VALUE '4'.
  4036             88  CF-MP-REFD-IS-NET-PAY          VALUE '5'.
  4037             88  CF-MP-REFD-ANTICIPATION        VALUE '6'.
  4038             88  CF-MP-REFD-MEAN                VALUE '8'.
  4039         16  CF-ALT-RATE-CODE               PIC  X(5).
  4040
  4041
  4042         16  FILLER                         PIC X(498).
  4043****************************************************************
  4044*             MORTGAGE COMPANY MASTER RECORD                   *
  4045****************************************************************
  4046
  4047     12  CF-MORTG-COMPANY-MASTER-REC  REDEFINES  CF-RECORD-BODY.
  4048         16  CF-MORTG-ALT-MORT-CODE         PIC X(4).
  4049         16  CF-MORTG-ACCESS-CONTROL        PIC X.
  4050             88  CF-MORT-ST-PROD-CNTL                VALUE ' '.
  4051             88  CF-MORT-CARR-GRP-ST-PROD-CNTL       VALUE '1'.
  4052             88  CF-MORT-CARR-ST-PROD-CNTL           VALUE '2'.
  4053             88  CF-MORT-PROD-CNTL                   VALUE '3'.
  4054             88  CF-MORT-CARR-PROD-CNTL              VALUE '4'.
  4055
  4056         16  CF-MORTG-CONVERSION-DATE       PIC XX.
  4057         16  CF-MORTG-RATE-FILE-MAINT-DATE  PIC XX.
  4058         16  CF-MORTG-RATE-FILE-CREAT-DATE  PIC XX.
  4059         16  CF-MORTG-PROD-FILE-MAINT-DATE  PIC XX.
  4060         16  CF-MORTG-PROD-FILE-CREAT-DATE  PIC XX.
  4061
  4062         16  CF-MP-POLICY-LINKAGE-IND       PIC X(1).
  4063             88  CF-MP-PLCY-LINKAGE-USED     VALUE 'Y'.
  4064         16  CF-MP-RECON-USE-IND            PIC X(1).
  4065             88  CF-MP-USE-RECON             VALUE 'Y'.
  4066         16  CF-MORTG-CHECK-NO-COUNTER      PIC 9(6).
  4067             88  CF-MP-CHECK-CNT-RESET-VALUE VALUE 999999.
  4068         16  CF-MP-REPORT-LANGUAGE-IND      PIC X(1).
  4069             88  CF-MP-LANGUAGE-IS-ENG       VALUE 'E'.
  4070             88  CF-MP-LANGUAGE-IS-FR        VALUE 'F'.
  4071         16  FILLER                         PIC X(1).
  4072         16  CF-MORTG-CHECK-QUEUE-COUNTER   PIC 9(6).
  4073             88  CF-MP-CHKQ-CNT-RESET-VALUE  VALUE 999999.
  4074         16  CF-MORTG-MIB-VERSION           PIC X.
  4075             88  CF-MORTG-MIB-BATCH         VALUE '1'.
  4076             88  CF-MORTG-MIB-ONLINE        VALUE '2'.
  4077             88  CF-MORTG-MIB-BOTH          VALUE '3'.
  4078         16  CF-MORTG-ALT-MIB-SEARCH-CNTL.
  4079             20  CF-MORTG-MIB-LNAME-SEARCH  PIC X.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  78
* EL690.cbl
  4080                 88  CF-MIB-LAST-NAME-SEARCH     VALUE 'Y'.
  4081             20  CF-MORTG-MIB-FNAME-SEARCH  PIC X.
  4082                 88  CF-MIB-FIRST-NAME-SEARCH    VALUE 'Y'.
  4083             20  CF-MORTG-MIB-MNAME-SEARCH  PIC X.
  4084                 88  CF-MIB-MIDDLE-NAME-SEARCH   VALUE 'Y'.
  4085             20  CF-MORTG-MIB-BDATE-SEARCH  PIC X.
  4086                 88  CF-MIB-BIRTH-DATE-SEARCH    VALUE 'Y'.
  4087             20  CF-MORTG-MIB-BSTATE-SEARCH PIC X.
  4088                 88  CF-MIB-BIRTH-STATE-SEARCH   VALUE 'Y'.
  4089             20  CF-MORTG-MIB-RSTATE-SEARCH PIC X.
  4090                 88  CF-MIB-RESIDNT-STATE-SEARCH VALUE 'Y'.
  4091         16  CF-MORTG-MIB-COMPANY-SYMBOL    PIC XXX.
  4092         16  FILLER                         PIC X(7).
  4093         16  CF-MORTG-DESTINATION-SYMBOL.
  4094             20  CF-MORTG-MIB-COMM          PIC X(5).
  4095             20  CF-MORTG-MIB-TERM          PIC X(5).
  4096         16  CF-ASSIGN-POLICY-NO-SW         PIC X(01).
  4097             88  CF-ASSIGN-POLICY-NO             VALUE 'Y'.
  4098         16  FILLER                         PIC X(03).
  4099         16  CF-MP-CHECK-NO-CONTROL.
  4100             20  CF-MP-CHECK-NO-METHOD      PIC X(01).
  4101                 88  CF-MP-CHECK-NO-MANUAL     VALUE '1'.
  4102                 88  CF-MP-CHECK-NO-AUTO-SEQ   VALUE '2'
  4103                                                ' ' LOW-VALUES.
  4104                 88  CF-MP-CHECK-NO-PRE-PRINTED
  4105                                               VALUE '3'.
  4106         16  CF-MORTG-LOAN-SHIFT-IND        PIC X(01).
  4107         16  CF-MORTG-SOLICITATION-NUM      PIC S9(17) COMP-3.
  4108         16  CF-MORTG-ALT-ALPHA-SEARCH-CNTL.
  4109             20  CF-MORTG-ALP-LNAME-SEARCH  PIC X.
  4110                 88  CF-ALPHA-LAST-NAME-SEARCH      VALUE 'Y'.
  4111             20  CF-MORTG-ALP-FNAME-SEARCH  PIC X.
  4112                 88  CF-ALPHA-FIRST-NAME-SEARCH     VALUE 'Y'.
  4113             20  CF-MORTG-ALP-MNAME-SEARCH  PIC X.
  4114                 88  CF-ALPHA-MIDDLE-NAME-SEARCH    VALUE 'Y'.
  4115             20  CF-MORTG-ALP-BDATE-SEARCH  PIC X.
  4116                 88  CF-ALPHA-BIRTH-DATE-SEARCH     VALUE 'Y'.
  4117             20  CF-MORTG-ALP-BSTATE-SEARCH PIC X.
  4118                 88  CF-ALPHA-BIRTH-STATE-SEARCH    VALUE 'Y'.
  4119             20  CF-MORTG-ALP-RSTATE-SEARCH PIC X.
  4120                 88  CF-ALPHA-RESIDNT-STATE-SEARCH  VALUE 'Y'.
  4121         16  CF-MORTG-BILLING-AREA.
  4122             20  CF-MORTG-BILL-CYCLE   OCCURS  5  TIMES
  4123                                            PIC X.
  4124         16  CF-MORTG-MONTH-END-DT          PIC XX.
  4125         16  CF-MORTG-CURRENT-ARCH-NUM      PIC S9(8)  COMP.
  4126         16  CF-MORTG-START-ARCH-NUM        PIC S9(8)  COMP.
  4127         16  CF-MORTG-MIB-DEST-SW           PIC X.
  4128             88 CF-MORTG-MIB-COMM-DEST              VALUE '1'.
  4129             88 CF-MORTG-MIB-TERM-DEST              VALUE '2'.
  4130         16  FILLER                         PIC X.
  4131         16  CF-MORTG-LABEL-CONTROL         PIC X.
  4132             88 CF-MORTG-CREATE-LABELS              VALUE 'Y'.
  4133             88 CF-MORTG-BYPASS-LABELS              VALUE 'N'.
  4134         16  CF-ACH-ORIGINATING-DFI-ID      PIC X(8).
  4135         16  FILLER                         PIC X(8).
  4136         16  CF-ACH-SENDING-DFI-NAME        PIC X(23).
  4137         16  CF-ACH-RECVING-DFI-ROUTING-NO  PIC X(8).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  79
* EL690.cbl
  4138         16  CF-ACH-RECVING-DFI-NAME        PIC X(23).
  4139         16  CF-ACH-COMPANY-ID.
  4140             20  CF-ACH-ID-CODE-DESIGNATOR  PIC X.
  4141                 88  CF-ACH-ICD-IRS-EIN             VALUE '1'.
  4142                 88  CF-ACH-ICD-DUNS                VALUE '3'.
  4143                 88  CF-ACH-ICD-USER-ASSIGNED-NO    VALUE '9'.
  4144             20  CF-ACH-COMPANY-ID-NO       PIC X(9).
  4145         16  CF-MORTG-BILL-GROUPING-CODE    PIC X.
  4146             88  CF-MORTG-CO-HAS-GROUPING           VALUE 'Y'.
  4147         16  CF-RATE-DEV-AUTHORIZATION      PIC X.
  4148             88  CF-RATE-DEV-AUTHORIZED             VALUE 'Y'.
  4149             88  CF-RATE-DEV-NOT-AUTHORIZED         VALUE 'N'.
  4150         16  CF-ACH-SENDING-DFI-ROUTING-NO  PIC X(9).
  4151         16  CF-CBA-FILE-CREATE-NUM         PIC 9(4).
  4152         16  FILLER                         PIC X(536).
  4153
  4154****************************************************************
  4155*             MORTGAGE HEIGHT - WEIGHT CHARTS                  *
  4156****************************************************************
  4157
  4158     12  CF-FEMALE-HT-WT-REC  REDEFINES CF-RECORD-BODY.
  4159         16  CF-FEMALE-HT-WT-INFO OCCURS 30 TIMES.
  4160             20  CF-FEMALE-HEIGHT.
  4161                 24  CF-FEMALE-FT           PIC 99.
  4162                 24  CF-FEMALE-IN           PIC 99.
  4163             20  CF-FEMALE-MIN-WT           PIC 999.
  4164             20  CF-FEMALE-MAX-WT           PIC 999.
  4165         16  FILLER                         PIC X(428).
  4166
  4167     12  CF-MALE-HT-WT-REC    REDEFINES CF-RECORD-BODY.
  4168         16  CF-MALE-HT-WT-INFO   OCCURS 30 TIMES.
  4169             20  CF-MALE-HEIGHT.
  4170                 24  CF-MALE-FT             PIC 99.
  4171                 24  CF-MALE-IN             PIC 99.
  4172             20  CF-MALE-MIN-WT             PIC 999.
  4173             20  CF-MALE-MAX-WT             PIC 999.
  4174         16  FILLER                         PIC X(428).
  4175******************************************************************
  4176*             AUTOMATIC ACTIVITY RECORD                          *
  4177******************************************************************
  4178     12  CF-AUTO-ACTIVITY-REC REDEFINES CF-RECORD-BODY.
  4179         16  CF-SYSTEM-DEFINED-ACTIVITY OCCURS 09 TIMES.
  4180             20  CF-SYS-ACTIVE-SW           PIC X(01).
  4181             20  CF-SYS-LETTER-ID           PIC X(04).
  4182             20  CF-SYS-RESEND-DAYS         PIC 9(03).
  4183             20  CF-SYS-FOLLOW-UP-DAYS      PIC 9(03).
  4184             20  CF-SYS-RESET-SW            PIC X(01).
  4185             20  CF-SYS-REPORT-DAYS         PIC 9(03).
  4186             20  CF-SYS-EACH-DAY-AFTER-SW   PIC X(01).
  4187
  4188         16  FILLER                         PIC X(50).
  4189
  4190         16  CF-USER-DEFINED-ACTIVITY  OCCURS 08 TIMES.
  4191             20  CF-USER-ACTIVE-SW          PIC X(01).
  4192             20  CF-USER-LETTER-ID          PIC X(04).
  4193             20  CF-USER-RESEND-DAYS        PIC 9(03).
  4194             20  CF-USER-FOLLOW-UP-DAYS     PIC 9(03).
  4195             20  CF-USER-RESET-SW           PIC X(01).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  80
* EL690.cbl
  4196             20  CF-USER-REPORT-DAYS        PIC 9(03).
  4197             20  CF-USER-EACH-DAY-AFTER-SW  PIC X(01).
  4198             20  CF-USER-ACTIVITY-DESC      PIC X(20).
  4199
  4200         16  FILLER                         PIC X(246).
  4201
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  81
* EL690.cbl
  4203 PROCEDURE DIVISION USING DFHEIBLK DFHCOMMAREA LETTER-ARCHIVE
  4204                          LETTER-ARCHIVE-TEXT CONTROL-FILE.
  4205 0000-DFHEXIT SECTION.
  4206     MOVE '9#                    $   ' TO DFHEIV0.
  4207     MOVE 'EL690' TO DFHEIV1.
  4208     CALL 'kxdfhei1' USING DFHEIV0 DFH-START DFHEIV DFHEIV1.
  4209
  4210     MOVE DFHCOMMAREA            TO PROGRAM-INTERFACE-BLOCK.
  4211
  4212
  4213* EXEC CICS HANDLE CONDITION
  4214*        QIDERR    (0110-PGM-INITIALIZATION)
  4215*        MAPFAIL   (0110-PGM-INITIALIZATION)
  4216*        NOTOPEN   (8070-NOTOPEN)
  4217*        NOTFND    (8080-ARCH-NOT-FOUND)
  4218*        PGMIDERR  (9700-PGMID-ERROR)
  4219*        ERROR     (9800-ABEND)
  4220*        END-EXEC.
  4221*    MOVE '"$N?JIL.              ! " #00004208' TO DFHEIV0
  4222     MOVE X'22244E3F4A494C2E20202020' TO DFHEIV0(1:12)
  4223     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4224     MOVE X'2220233030303034323038' TO DFHEIV0(25:11)
  4225     CALL 'kxdfhei1' USING DFHEIV0
  4226     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4227
  4228
  4229     MOVE EIBDATE                TO DC-JULIAN-YYDDD.
  4230     MOVE '5'                    TO DC-OPTION-CODE.
  4231     PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT.
  4232     MOVE DC-GREG-DATE-1-EDIT    TO W-SAVE-DATE.
  4233     MOVE DC-BIN-DATE-1          TO W-SAVE-BIN-DATE.
  4234
  4235     MOVE +1                     TO EMI-NUMBER-OF-LINES.
  4236     MOVE '2'                    TO EMI-SWITCH2.
  4237
  4238***************************************************************
  4239*       IF ATTEMPTING TO EXECUTE PROGRAM WITHOUT SIGNING ON   *
  4240*       (COMM LENGTH EQUAL ZERO), SEND ERROR MESSAGE.         *
  4241***************************************************************
  4242
  4243     IF  EIBCALEN EQUAL 0
  4244         GO TO 8000-UNAUTHORIZED-ACCESS.
  4245
  4246     IF  PI-RETURN-TO-PROGRAM EQUAL W-THIS-PGM
  4247         MOVE PI-CALLING-PROGRAM TO W-RETURNED-FROM
  4248
  4249     ELSE
  4250         MOVE SPACES             TO W-RETURNED-FROM.
  4251
  4252     IF  PI-CALLING-PROGRAM NOT EQUAL W-THIS-PGM
  4253
  4254         IF  PI-RETURN-TO-PROGRAM NOT EQUAL W-THIS-PGM
  4255             MOVE PI-SAVED-PROGRAM-5    TO PI-SAVED-PROGRAM-6
  4256             MOVE PI-SAVED-PROGRAM-4    TO PI-SAVED-PROGRAM-5
  4257             MOVE PI-SAVED-PROGRAM-3    TO PI-SAVED-PROGRAM-4
  4258             MOVE PI-SAVED-PROGRAM-2    TO PI-SAVED-PROGRAM-3
  4259             MOVE PI-SAVED-PROGRAM-1    TO PI-SAVED-PROGRAM-2
  4260             MOVE PI-RETURN-TO-PROGRAM  TO PI-SAVED-PROGRAM-1
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  82
* EL690.cbl
  4261             MOVE PI-CALLING-PROGRAM    TO PI-RETURN-TO-PROGRAM
  4262             MOVE W-THIS-PGM            TO PI-CALLING-PROGRAM
  4263             MOVE LOW-VALUES            TO PI-690-WORK-AREA
  4264             MOVE HIGH-VALUES           TO PI-690-FIRST-DATA
  4265             MOVE ZEROS                 TO PI-690-BRWS-TYPE-IND
  4266
  4267             IF  PI-RETURN-TO-PROGRAM EQUAL W-XCTL-626
  4268                 MOVE LOW-VALUES        TO PI-CARRIER
  4269                                           PI-GROUPING
  4270                                           PI-STATE
  4271                                           PI-ACCOUNT
  4272                                           PI-CERT-EFF-DT
  4273                                           PI-CERT-PRIME
  4274                                           PI-CERT-SFX
  4275                                           PI-689-WORK-AREA
  4276
  4277             ELSE
  4278                 PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT
  4279                 GO TO 1200-SET-UP-COMPLETE-SCREEN
  4280
  4281         ELSE
  4282             MOVE PI-RETURN-TO-PROGRAM  TO PI-CALLING-PROGRAM
  4283             MOVE PI-SAVED-PROGRAM-1    TO PI-RETURN-TO-PROGRAM
  4284             MOVE PI-SAVED-PROGRAM-2    TO PI-SAVED-PROGRAM-1
  4285             MOVE PI-SAVED-PROGRAM-3    TO PI-SAVED-PROGRAM-2
  4286             MOVE PI-SAVED-PROGRAM-4    TO PI-SAVED-PROGRAM-3
  4287             MOVE PI-SAVED-PROGRAM-5    TO PI-SAVED-PROGRAM-4
  4288             MOVE PI-SAVED-PROGRAM-6    TO PI-SAVED-PROGRAM-5
  4289             MOVE SPACES                TO PI-SAVED-PROGRAM-6.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  83
* EL690.cbl
  4291 0100-ENTRY-LOGIC.
  4292
  4293     IF  EIBTRNID EQUAL W-TRANSACTION
  4294
  4295         IF  EIBAID EQUAL DFHCLEAR
  4296                 OR
  4297             NOT DISPLAY-CAP
  4298             MOVE PI-RETURN-TO-PROGRAM
  4299                                 TO W-CALL-PGM
  4300             PERFORM 9400-XCTL THRU 9400-EXIT
  4301
  4302         ELSE
  4303             GO TO 0200-RECEIVE
  4304
  4305     ELSE
  4306         IF  W-RETURNED-FROM NOT EQUAL SPACES
  4307             GO TO 1000-RECOVER-LAST-SCREEN.
  4308
  4309     MOVE LOW-VALUES             TO EL690AO.
  4310
  4311 0110-PGM-INITIALIZATION.
  4312
  4313     PERFORM 9910-INITIALIZE-SECURITY THRU 9910-EXIT.
  4314
  4315     MOVE LOW-VALUES             TO EL690AO.
  4316     MOVE -1                     TO TYPEBRL.
  4317     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  84
* EL690.cbl
  4319 0200-RECEIVE.
  4320
  4321     IF  EIBAID EQUAL DFHPA1
  4322             OR
  4323         EIBAID EQUAL DFHPA2
  4324             OR
  4325         EIBAID EQUAL DFHPA3
  4326         MOVE ER-7008            TO EMI-ERROR
  4327         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4328         MOVE -1                 TO PFKEYL
  4329         GO TO 8200-SEND-DATAONLY.
  4330
  4331
  4332* EXEC CICS RECEIVE
  4333*        MAP     (W-MAP)
  4334*        MAPSET  (W-MAPSET)
  4335*        INTO    (EL690AI)
  4336*        END-EXEC.
  4337     MOVE LENGTH OF
  4338      EL690AI
  4339       TO DFHEIV11
  4340*    MOVE '8"T I  L              ''   #00004319' TO DFHEIV0
  4341     MOVE X'382254204920204C20202020' TO DFHEIV0(1:12)
  4342     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  4343     MOVE X'2020233030303034333139' TO DFHEIV0(25:11)
  4344     CALL 'kxdfhei1' USING DFHEIV0,
  4345           W-MAP,
  4346           EL690AI,
  4347           DFHEIV11,
  4348           W-MAPSET,
  4349           DFHEIV99,
  4350           DFHEIV99
  4351     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4352
  4353
  4354     IF  PFKEYL EQUAL ZERO
  4355         GO TO 0300-CHECK-PFKEYS.
  4356
  4357     IF  EIBAID NOT EQUAL DFHENTER
  4358         MOVE ER-0004            TO EMI-ERROR
  4359         GO TO 0310-INPUT-ERROR.
  4360
  4361     IF  PFKEYI GREATER 0 AND LESS 25
  4362         MOVE PF-VALUES (PFKEYI) TO EIBAID
  4363
  4364     ELSE
  4365         MOVE ER-0029            TO EMI-ERROR
  4366         GO TO 0310-INPUT-ERROR.
  4367
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  85
* EL690.cbl
  4369 0300-CHECK-PFKEYS.
  4370
  4371     IF  EIBAID EQUAL DFHPF23
  4372         MOVE EIBAID             TO PI-ENTRY-CD-1
  4373         MOVE W-XCTL-005         TO W-CALL-PGM
  4374         PERFORM 9400-XCTL THRU 9400-EXIT.
  4375
  4376     IF  EIBAID EQUAL DFHPF24
  4377         MOVE W-XCTL-626         TO W-CALL-PGM
  4378         PERFORM 9400-XCTL THRU 9400-EXIT.
  4379
  4380     IF  EIBAID EQUAL DFHPF12
  4381         MOVE W-XCTL-010         TO W-CALL-PGM
  4382         PERFORM 9400-XCTL THRU 9400-EXIT.
  4383
  4384     IF  MAINTI EQUAL 'C'
  4385             AND
  4386         EIBAID EQUAL DFHENTER
  4387             AND
  4388         CORRSELL GREATER THAN ZEROS
  4389         MOVE -1                 TO CORRSELL
  4390         MOVE AL-UNBON           TO CORRSELA
  4391                                    MAINTA
  4392         MOVE ER-9323            TO EMI-ERROR
  4393         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4394         GO TO 8200-SEND-DATAONLY.
  4395
  4396     IF  EIBAID EQUAL DFHPF3
  4397*            OR
  4398*        (EIBAID EQUAL DFHENTER
  4399*            AND
  4400*        CORRSELL GREATER THAN ZEROS)
  4401         MOVE '3'                TO EIBAID
  4402         PERFORM 1500-SELECT-ARCHIVE-REC THRU 1500-EXIT
  4403         MOVE W-XCTL-689         TO W-CALL-PGM
  4404         GO TO 9400-XCTL.
  4405
  4406     IF  EIBAID EQUAL DFHPF4
  4407         MOVE LOW-VALUES         TO EL690AO
  4408                                    PI-690-WORK-AREA
  4409         MOVE -1                 TO TYPEBRL
  4410         GO TO 8100-SEND-INITIAL-MAP.
  4411
  4412     IF  EIBAID EQUAL DFHPF5
  4413             OR
  4414         (EIBAID EQUAL DFHENTER
  4415             AND
  4416         CORRSELL GREATER THAN ZEROS)
  4417         MOVE '5'                TO EIBAID
  4418         PERFORM 1500-SELECT-ARCHIVE-REC THRU 1500-EXIT
  4419         IF PI-689-ARCHIVE-NUMBER NOT GREATER ZERO
  4420             MOVE -1             TO CORRSELL
  4421             MOVE AL-UNBON       TO CORRSELA
  4422             MOVE ER-9293        TO EMI-ERROR
  4423             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4424             GO TO 8200-SEND-DATAONLY
  4425         ELSE
  4426            MOVE PI-690-INIT-CARRIER
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  86
* EL690.cbl
  4427                                 TO PI-CARRIER
  4428            MOVE PI-690-INIT-GROUPING
  4429                                 TO PI-GROUPING
  4430            MOVE PI-690-INIT-STATE
  4431                                 TO PI-STATE
  4432            MOVE PI-690-INIT-ACCOUNT
  4433                                 TO PI-ACCOUNT
  4434            MOVE PI-690-INIT-EFFECT-DATE
  4435                                 TO PI-CERT-EFF-DT
  4436            MOVE PI-690-INIT-CERT-PRIME
  4437                                 TO PI-CERT-PRIME
  4438            MOVE PI-690-INIT-SUFFIX
  4439                                 TO PI-CERT-SFX
  4440            MOVE W-XCTL-691      TO W-CALL-PGM
  4441            GO TO 9400-XCTL
  4442         END-IF
  4443     END-IF.
  4444
  4445     IF  EIBAID EQUAL DFHPF6
  4446         MOVE PI-690-INIT-CARRIER  TO PI-CARRIER
  4447         MOVE PI-690-INIT-GROUPING TO PI-GROUPING
  4448         MOVE PI-690-INIT-STATE    TO PI-STATE
  4449         MOVE PI-690-INIT-ACCOUNT  TO PI-ACCOUNT
  4450         MOVE PI-690-INIT-EFFECT-DATE TO PI-CERT-EFF-DT
  4451         MOVE PI-690-INIT-CERT-PRIME TO PI-CERT-PRIME
  4452         MOVE PI-690-INIT-SUFFIX   TO PI-CERT-SFX
  4453         move pi-689-chg-seq-nox(1:1)
  4454                                 to PI-PROGRAM-WORK-AREA(1:1)
  4455         MOVE W-XCTL-1279        TO W-CALL-PGM
  4456         GO TO 9400-XCTL
  4457     END-IF
  4458
  4459     IF  MAINTI EQUAL 'C'
  4460             AND
  4461         EIBAID EQUAL DFHENTER
  4462         GO TO 0700-PROCESS-CHANGES.
  4463
  4464     IF  EIBAID EQUAL DFHPF1
  4465         PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT
  4466         MOVE LOW-VALUES         TO PI-690-FIRST-DATA
  4467                                    W-ARCH-GROUPS
  4468         GO TO 2000-PAGE-FORWARD.
  4469
  4470     IF  EIBAID EQUAL DFHPF2
  4471
  4472         IF  PI-690-INIT-DATA EQUAL LOW-VALUES
  4473             MOVE HIGH-VALUES    TO PI-690-INIT-DATA
  4474             PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT
  4475             MOVE HIGH-VALUES    TO PI-690-LAST-DATA
  4476             MOVE LOW-VALUES     TO W-ARCH-GROUPS
  4477             GO TO 3000-PAGE-BACKWARD
  4478
  4479         ELSE
  4480             PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT
  4481             MOVE HIGH-VALUES    TO PI-690-LAST-DATA
  4482             MOVE LOW-VALUES     TO W-ARCH-GROUPS
  4483             GO TO 3000-PAGE-BACKWARD.
  4484
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  87
* EL690.cbl
  4485     MOVE ER-0029                TO EMI-ERROR.
  4486
  4487 0310-INPUT-ERROR.
  4488
  4489     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4490     MOVE -1                     TO PFKEYL
  4491     MOVE AL-UNBON               TO PFKEYA
  4492     GO TO 8200-SEND-DATAONLY.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  88
* EL690.cbl
  4494 0500-EDIT-SCREEN-DATA.
  4495
  4496     IF  TYPEBRL NOT EQUAL ZEROS
  4497
  4498         IF  TYPEBRI NOT EQUAL PI-690-BRWS-TYPE-IND
  4499             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4500             MOVE TYPEBRI        TO PI-690-BRWS-TYPE-IND
  4501             MOVE AL-UNNON       TO TYPEBRA
  4502
  4503         ELSE
  4504             NEXT SENTENCE
  4505
  4506     ELSE
  4507         IF  PI-690-BRWS-TYPE-IND NOT NUMERIC
  4508                 OR
  4509             PI-690-BRWS-TYPE-IND LESS THAN 1
  4510                 OR
  4511             PI-690-BRWS-TYPE-IND GREATER THAN 6
  4512             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4513             MOVE 6              TO PI-690-BRWS-TYPE-IND
  4514             MOVE +1             TO TYPEBRL
  4515             MOVE AL-UNNON       TO TYPEBRA
  4516
  4517         ELSE
  4518             MOVE +1             TO TYPEBRL
  4519             MOVE AL-UNNON       TO TYPEBRA
  4520             MOVE PI-690-BRWS-TYPE-IND
  4521                                 TO TYPEBRO.
  4522
  4523     IF  CERTRPL GREATER THAN ZEROS
  4524
  4525         IF  CERTRPI NOT EQUAL PI-690-INIT-CERT-PRIME
  4526             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4527             MOVE CERTRPI        TO PI-690-INIT-CERT-PRIME
  4528             MOVE AL-UANON       TO CERTRPA
  4529
  4530             IF  SUFFIXL GREATER THAN ZEROS
  4531
  4532                 IF  SUFFIXI NOT EQUAL PI-690-INIT-SUFFIX
  4533                     MOVE 'Y'    TO W-CHANGE-REQUESTED-IND
  4534
  4535                     IF  SUFFIXI NOT GREATER THAN SPACES
  4536                         MOVE SPACES
  4537                                 TO SUFFIXI
  4538                                    PI-690-INIT-SUFFIX
  4539                         MOVE AL-UANON
  4540                                 TO SUFFIXA
  4541
  4542                     ELSE
  4543                         MOVE AL-UANON
  4544                                 TO SUFFIXA
  4545                         MOVE SUFFIXI
  4546                                 TO PI-690-INIT-SUFFIX
  4547
  4548                 ELSE
  4549                     NEXT SENTENCE
  4550
  4551             ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  89
* EL690.cbl
  4552                 IF  PI-690-INIT-SUFFIX EQUAL LOW-VALUES
  4553                         OR
  4554                     PI-690-INIT-SUFFIX EQUAL HIGH-VALUES
  4555                     MOVE AL-UANON
  4556                                 TO SUFFIXA
  4557                     MOVE SPACES TO PI-690-INIT-SUFFIX
  4558
  4559                 ELSE
  4560                     NEXT SENTENCE
  4561
  4562         ELSE
  4563             NEXT SENTENCE
  4564
  4565     ELSE
  4566         IF  PI-690-INIT-CERT-PRIME GREATER THAN LOW-VALUES
  4567                 AND
  4568             PI-690-INIT-CERT-PRIME LESS THAN HIGH-VALUES
  4569             MOVE PI-690-INIT-CERT-PRIME
  4570                                 TO CERTRPI
  4571             MOVE PI-690-INIT-SUFFIX
  4572                                 TO SUFFIXI
  4573             MOVE AL-UANON       TO CERTRPA
  4574                                    SUFFIXA
  4575             MOVE +10            TO CERTRPL
  4576             MOVE +1             TO SUFFIXL.
  4577
  4578     IF  FORML GREATER THAN ZEROS
  4579
  4580         IF  FORMI NOT EQUAL PI-690-INIT-FORM
  4581             MOVE AL-UANON       TO FORMA
  4582             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4583             MOVE FORMI          TO PI-690-INIT-FORM
  4584
  4585         ELSE
  4586             NEXT SENTENCE
  4587
  4588     ELSE
  4589         IF  PI-690-INIT-FORM GREATER THAN LOW-VALUES
  4590                 AND
  4591             PI-690-INIT-FORM LESS THAN HIGH-VALUES
  4592             MOVE AL-UANON       TO FORMA
  4593             MOVE +4             TO FORML
  4594             MOVE PI-690-INIT-FORM
  4595                                 TO FORMI.
  4596
  4597     IF  ENTRYL GREATER THAN ZEROS
  4598             AND
  4599         CKCNTLL GREATER THAN ZEROS
  4600         MOVE -1                 TO CKCNTLL
  4601         MOVE AL-UABON           TO CKCNTLA
  4602         MOVE ER-7362            TO EMI-ERROR
  4603         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4604         GO TO 8100-SEND-INITIAL-MAP.
  4605
  4606     IF  ENTRYL GREATER THAN ZEROS
  4607
  4608         IF  ENTRYI NOT EQUAL PI-690-INIT-ENTRY
  4609             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  90
* EL690.cbl
  4610             MOVE ENTRYI         TO PI-690-INIT-ENTRY
  4611
  4612         ELSE
  4613             NEXT SENTENCE
  4614
  4615     ELSE
  4616         IF  PI-690-INIT-ENTRY GREATER THAN LOW-VALUES
  4617                 AND
  4618             PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  4619                 AND
  4620             PI-690-INIT-CONTROL-PREFIX NOT EQUAL 'CK'
  4621             MOVE AL-UANON       TO ENTRYA
  4622             MOVE +6             TO ENTRYL
  4623             MOVE PI-690-INIT-ENTRY
  4624                                 TO ENTRYI.
  4625
  4626     IF  CKCNTLL GREATER THAN ZEROS
  4627
  4628         IF  CKCNTLI NUMERIC
  4629
  4630             IF  CKCNTLI NOT EQUAL PI-690-INIT-CONTROL
  4631                 MOVE 'Y'        TO W-CHANGE-REQUESTED-IND
  4632                 MOVE 'CK'       TO PI-690-INIT-CONTROL-PREFIX
  4633                 MOVE CKCNTLI    TO PI-690-INIT-CONTROL
  4634
  4635             ELSE
  4636                 NEXT SENTENCE
  4637
  4638         ELSE
  4639             MOVE ZEROS          TO PI-690-INIT-CONTROL
  4640                                    CKCNTLO
  4641
  4642     ELSE
  4643         IF  PI-690-INIT-CONTROL GREATER THAN ZEROS
  4644                 AND
  4645             PI-690-INIT-CONTROL LESS THAN 99999999
  4646                 AND
  4647             PI-690-INIT-CONTROL-PREFIX EQUAL 'CK'
  4648             MOVE AL-UANON       TO CKCNTLA
  4649             MOVE +8             TO CKCNTLL
  4650             MOVE PI-690-INIT-CONTROL
  4651                                 TO CKCNTLI.
  4652
  4653     IF  CARRIERL GREATER THAN ZEROS
  4654
  4655         IF  CARRIERI NOT EQUAL  TO PI-690-INIT-CARRIER
  4656             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4657             MOVE CARRIERI       TO PI-690-INIT-CARRIER
  4658
  4659         ELSE
  4660             NEXT SENTENCE
  4661
  4662     ELSE
  4663         IF  PI-690-INIT-CARRIER GREATER THAN LOW-VALUES
  4664                 AND
  4665             PI-690-INIT-CARRIER LESS THAN HIGH-VALUES
  4666             MOVE AL-UANON       TO CARRIERA
  4667             MOVE +1             TO CARRIERL
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  91
* EL690.cbl
  4668             MOVE PI-690-INIT-CARRIER
  4669                                 TO CARRIERI.
  4670
  4671     IF  GROUPL GREATER THAN ZEROS
  4672
  4673         IF  GROUPI NOT EQUAL    TO PI-690-INIT-GROUPING
  4674             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4675             MOVE GROUPI         TO PI-690-INIT-GROUPING
  4676
  4677         ELSE
  4678             NEXT SENTENCE
  4679
  4680     ELSE
  4681         IF  PI-690-INIT-GROUPING GREATER THAN LOW-VALUES
  4682                 AND
  4683             PI-690-INIT-GROUPING LESS THAN HIGH-VALUES
  4684             MOVE AL-UANON       TO GROUPA
  4685             MOVE +6             TO GROUPL
  4686             MOVE PI-690-INIT-GROUPING
  4687                                 TO GROUPI.
  4688
  4689     IF  STATEL GREATER THAN ZEROS
  4690
  4691         IF  STATEI NOT EQUAL    TO PI-690-INIT-STATE
  4692             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4693             MOVE STATEI         TO PI-690-INIT-STATE
  4694
  4695         ELSE
  4696             NEXT SENTENCE
  4697
  4698     ELSE
  4699         IF  PI-690-INIT-STATE GREATER THAN LOW-VALUES
  4700                 AND
  4701             PI-690-INIT-STATE LESS THAN HIGH-VALUES
  4702             MOVE AL-UANON       TO STATEA
  4703             MOVE +2             TO STATEL
  4704             MOVE PI-690-INIT-STATE
  4705                                 TO STATEI.
  4706
  4707     IF  ACCTL GREATER THAN ZEROS
  4708
  4709         IF  ACCTI NOT EQUAL     TO PI-690-INIT-ACCOUNT
  4710             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4711             MOVE ACCTI          TO PI-690-INIT-ACCOUNT
  4712
  4713         ELSE
  4714             NEXT SENTENCE
  4715
  4716     ELSE
  4717         IF  PI-690-INIT-ACCOUNT GREATER THAN LOW-VALUES
  4718                 AND
  4719             PI-690-INIT-ACCOUNT LESS THAN HIGH-VALUES
  4720             MOVE AL-UANON       TO ACCTA
  4721             MOVE +10            TO ACCTL
  4722             MOVE PI-690-INIT-ACCOUNT
  4723                                 TO ACCTI.
  4724
  4725     IF  PROCSRL GREATER THAN ZEROS
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  92
* EL690.cbl
  4726
  4727         IF  PROCSRI NOT EQUAL   TO PI-690-INIT-PROCESSOR
  4728             MOVE 'Y'            TO W-CHANGE-REQUESTED-IND
  4729             MOVE PROCSRI        TO PI-690-INIT-PROCESSOR
  4730
  4731         ELSE
  4732             NEXT SENTENCE
  4733
  4734     ELSE
  4735         IF  PI-690-INIT-PROCESSOR GREATER THAN LOW-VALUES
  4736                 AND
  4737             PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  4738             MOVE AL-UANON       TO PROCSRA
  4739             MOVE +4             TO PROCSRL
  4740             MOVE PI-690-INIT-PROCESSOR
  4741                                 TO PROCSRI.
  4742
  4743     IF  EFFDTEL GREATER THAN ZEROS
  4744         MOVE EFFDTEI            TO W-DEEDIT-FIELD
  4745
  4746         PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4747
  4748         IF  DC-ERROR-CODE NOT EQUAL SPACES
  4749             MOVE -1             TO EFFDTEL
  4750             MOVE AL-UABON       TO EFFDTEA
  4751             MOVE ER-0314        TO EMI-ERROR
  4752             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4753             GO TO 8100-SEND-INITIAL-MAP
  4754
  4755         ELSE
  4756             IF  DC-BIN-DATE-1 NOT = PI-690-INIT-EFFECT-DATE
  4757                 MOVE 'Y'        TO W-CHANGE-REQUESTED-IND
  4758                 MOVE DC-BIN-DATE-1
  4759                                 TO PI-690-INIT-EFFECT-DATE
  4760                 MOVE DC-GREG-DATE-1-EDIT
  4761                                 TO PI-690-INIT-EFF-DTE
  4762
  4763             ELSE
  4764                 IF  PI-690-INIT-EFFECT-DATE > LOW-VALUES
  4765                         AND
  4766                     PI-690-INIT-EFFECT-DATE < HIGH-VALUES
  4767                     MOVE AL-UANON
  4768                                 TO EFFDTEA
  4769                     MOVE +8     TO EFFDTEL
  4770                     MOVE PI-690-INIT-EFF-DTE
  4771                                 TO EFFDTEI.
  4772
  4773     IF  STATSELL GREATER THAN ZEROS
  4774         MOVE STATSELI           TO PI-690-STATUS-SELECTION-IND
  4775
  4776         IF  NOT PI-690-VALID-SELECTION
  4777             MOVE -1             TO STATSELL
  4778             MOVE AL-UABON       TO STATSELA
  4779             MOVE ER-7244        TO EMI-ERROR
  4780             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4781             GO TO 8100-SEND-INITIAL-MAP
  4782
  4783         ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  93
* EL690.cbl
  4784             NEXT SENTENCE
  4785
  4786     ELSE
  4787         IF  PI-690-VALID-SELECTION
  4788             MOVE AL-UANON       TO STATSELA
  4789             MOVE +1             TO STATSELL
  4790             MOVE PI-690-STATUS-SELECTION-IND
  4791                                 TO STATSELI
  4792
  4793         ELSE
  4794             MOVE AL-UANON       TO STATSELA
  4795             MOVE +1             TO STATSELL
  4796             MOVE 'N'            TO PI-690-STATUS-SELECTION-IND
  4797                                    STATSELI.
  4798
  4799 0500-EXIT.
  4800     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  94
* EL690.cbl
  4802 0700-PROCESS-CHANGES.
  4803
  4804     IF  NOT MODIFY-CAP
  4805         MOVE 'UPDATE'           TO SM-READ
  4806         PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  4807         MOVE ER-9096            TO EMI-ERROR
  4808         PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4809         MOVE AL-UANON           TO MAINTA
  4810         MOVE -1                 TO MAINTL
  4811         GO TO 8200-SEND-DATAONLY.
  4812
  4813
  4814* EXEC CICS HANDLE CONDITION
  4815*        NOTFND  (8080-ARCH-NOT-FOUND)
  4816*        ENDFILE (8080-ARCH-NOT-FOUND)
  4817*        END-EXEC.
  4818*    MOVE '"$I''                  ! # #00004784' TO DFHEIV0
  4819     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  4820     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  4821     MOVE X'2320233030303034373834' TO DFHEIV0(25:11)
  4822     CALL 'kxdfhei1' USING DFHEIV0
  4823     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  4824
  4825
  4826     MOVE ZEROS                  TO W-FIRST-CHANGE-IND.
  4827
  4828     PERFORM 0720-SEARCH-FOR-CHANGES THRU 0720-EXIT
  4829             VARYING
  4830         W-ARCH-NDX FROM 1 BY 1
  4831             UNTIL
  4832         W-ARCH-NDX GREATER THAN 12
  4833             OR
  4834         PI-690-ARCHIVE-NUM (W-ARCH-NDX) EQUAL ZEROS.
  4835
  4836     IF  NOT EMI-NO-ERRORS
  4837         GO TO 8200-SEND-DATAONLY.
  4838
  4839     MOVE SPACES                 TO MAINTO
  4840     MOVE -1                     TO MAINTL
  4841     MOVE ER-9308                TO EMI-ERROR
  4842     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  4843
  4844     MOVE LOW-VALUES             TO EL690AO.
  4845
  4846     IF  PI-690-LAST-BRWS-FWRD
  4847         MOVE '1'                TO EIBAID
  4848         GO TO 2000-PAGE-FORWARD.
  4849
  4850     IF  PI-690-LAST-BRWS-BWRD
  4851         MOVE '2'                TO EIBAID
  4852         GO TO 3000-PAGE-BACKWARD.
  4853
  4854 0700-EXIT.
  4855     EXIT.
  4856
  4857 0720-SEARCH-FOR-CHANGES.
  4858
  4859     MOVE SPACES                 TO W-REPLY-DATE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  95
* EL690.cbl
  4860                                    W-RESEND-DATE-1
  4861                                    W-RESEND-DATE-2
  4862                                    W-RESEND-DATE-3
  4863                                    W-STATUS
  4864                                    W-VALID-STATUS-SW.
  4865
  4866*    IF  W-STATSL (W-ARCH-NDX) GREATER THAN ZEROS
  4867*        MOVE W-STATSO (W-ARCH-NDX)
  4868*                                TO W-VALID-STATUS-SW
  4869*
  4870*        IF  W-ALLOWED-ENTRIES
  4871*            MOVE W-STATSO (W-ARCH-NDX)
  4872*                                TO W-STATUS
  4873*
  4874*        ELSE
  4875*            MOVE ER-7358        TO EMI-ERROR
  4876*            MOVE AL-UANON       TO W-STATSA (W-ARCH-NDX)
  4877*            MOVE -1             TO W-STATSL (W-ARCH-NDX)
  4878*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4879
  4880     IF  W-RSDATL (W-ARCH-NDX) GREATER THAN ZEROS
  4881
  4882         IF  W-RSDATO (W-ARCH-NDX) EQUAL SPACES
  4883                 OR
  4884             W-RSDATO (W-ARCH-NDX) EQUAL ZEROES
  4885             MOVE LOW-VALUES     TO W-RESEND-DATE-1
  4886
  4887         ELSE
  4888             MOVE W-RSDATO (W-ARCH-NDX)
  4889                                 TO W-DEEDIT-FIELD
  4890
  4891             PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4892
  4893             IF  DC-ERROR-CODE EQUAL SPACES
  4894                 MOVE DC-BIN-DATE-1
  4895                                 TO W-RESEND-DATE-1
  4896                 MOVE DC-GREG-DATE-1-EDIT
  4897                                 TO W-RSDATO (W-ARCH-NDX)
  4898
  4899             ELSE
  4900                 MOVE ER-0185    TO EMI-ERROR
  4901                 MOVE AL-UANON   TO W-RSDATA (W-ARCH-NDX)
  4902                 MOVE -1         TO W-RSDATL (W-ARCH-NDX)
  4903                 PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4904
  4905*    IF  W-RSFRML (W-ARCH-NDX) GREATER THAN ZEROS
  4906*
  4907*        IF  W-RSFRMO (W-ARCH-NDX) EQUAL SPACES
  4908*                OR
  4909*            W-RSFRMO (W-ARCH-NDX) EQUAL ZEROES
  4910*            MOVE LOW-VALUES     TO W-RESEND-DATE-2
  4911*
  4912*        ELSE
  4913*            MOVE W-RSFRMO (W-ARCH-NDX)
  4914*                                TO W-DEEDIT-FIELD
  4915*
  4916*            PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4917*
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  96
* EL690.cbl
  4918*            IF  DC-ERROR-CODE EQUAL SPACES
  4919*                MOVE DC-BIN-DATE-1
  4920*                                TO W-RESEND-DATE-2
  4921*                MOVE DC-GREG-DATE-1-EDIT
  4922*                                TO W-RSFRMO (W-ARCH-NDX)
  4923*
  4924*            ELSE
  4925*                MOVE ER-0185    TO EMI-ERROR
  4926*                MOVE AL-UANON   TO W-RSFRMA (W-ARCH-NDX)
  4927*                MOVE -1         TO W-RSFRML (W-ARCH-NDX)
  4928*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4929*
  4930*    IF  W-RSSTSL (W-ARCH-NDX) GREATER THAN ZEROS
  4931*
  4932*        IF  W-RSSTSO (W-ARCH-NDX) EQUAL SPACES
  4933*                OR
  4934*            W-RSSTSO (W-ARCH-NDX) EQUAL ZEROES
  4935*            MOVE LOW-VALUES     TO W-RESEND-DATE-3
  4936*
  4937*        ELSE
  4938*            MOVE W-RSSTSO (W-ARCH-NDX)
  4939*                                TO W-DEEDIT-FIELD
  4940*
  4941*            PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4942*
  4943*            IF  DC-ERROR-CODE EQUAL SPACES
  4944*                MOVE DC-BIN-DATE-1
  4945*                                TO W-RESEND-DATE-3
  4946*                MOVE DC-GREG-DATE-1-EDIT
  4947*                                TO W-RSSTSO (W-ARCH-NDX)
  4948*
  4949*            ELSE
  4950*                MOVE ER-0185    TO EMI-ERROR
  4951*                MOVE AL-UANON   TO W-RSSTSA (W-ARCH-NDX)
  4952*                MOVE -1         TO W-RSSTSL (W-ARCH-NDX)
  4953*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4954
  4955*    IF  W-REPLYL (W-ARCH-NDX) GREATER THAN ZEROS
  4956*
  4957*        IF  W-REPLYO (W-ARCH-NDX) EQUAL SPACES
  4958*                OR
  4959*            W-REPLYO (W-ARCH-NDX) EQUAL ZEROES
  4960*            MOVE LOW-VALUES     TO W-REPLY-DATE
  4961*
  4962*        ELSE
  4963*            MOVE W-REPLYO (W-ARCH-NDX)
  4964*                                TO W-DEEDIT-FIELD
  4965*
  4966*            PERFORM 9200-DATE-EDIT THRU 9200-EXIT
  4967*
  4968*            IF  DC-ERROR-CODE EQUAL SPACES
  4969*                MOVE DC-BIN-DATE-1
  4970*                                TO W-REPLY-DATE
  4971*                MOVE DC-GREG-DATE-1-EDIT
  4972*                                TO W-REPLYO (W-ARCH-NDX)
  4973*
  4974*            ELSE
  4975*                MOVE ER-9245    TO EMI-ERROR
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  97
* EL690.cbl
  4976*                MOVE AL-UANON   TO W-REPLYA (W-ARCH-NDX)
  4977*                MOVE -1         TO W-REPLYL (W-ARCH-NDX)
  4978*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  4979
  4980*    IF  (W-REPLY-DATE NOT EQUAL SPACES
  4981*            OR
  4982*        W-RESEND-DATE-1 NOT EQUAL SPACES
  4983*            OR
  4984*        W-RESEND-DATE-2 NOT EQUAL SPACES
  4985*            OR
  4986*        W-RESEND-DATE-3 NOT EQUAL SPACES
  4987*            OR
  4988*        W-STATUS GREATER THAN SPACES)
  4989*            AND
  4990*        PI-690-ARCHIVE-NUM (W-ARCH-NDX) NOT EQUAL ZEROS
  4991*        PERFORM 0740-UPDATE-ARCH-RECORD THRU 0740-EXIT.
  4992
  4993 0720-EXIT.
  4994     EXIT.
  4995
  4996 0740-UPDATE-ARCH-RECORD.
  4997
  4998     MOVE LOW-VALUES             TO W-ARCT-KEY.
  4999     MOVE PI-690-ARCHIVE-NUM (W-ARCH-NDX)
  5000                                 TO W-ARCH-ARCHIVE-NO
  5001                                    W-ARCT-ARCHIVE-NO
  5002                                    W-HOLD-ARCHIVE.
  5003     MOVE PI-COMPANY-CD          TO W-ARCH-COMPANY-CD
  5004                                    W-ARCT-COMPANY-CD.
  5005
  5006     IF  W-SPECIAL-STATUS
  5007         PERFORM 7800-DELETE-CYCLE THRU 7800-EXIT
  5008         GO TO 0740-EXIT.
  5009
  5010
  5011* EXEC CICS HANDLE CONDITION
  5012*        NOTFND  (8080-ARCH-NOT-FOUND)
  5013*        ENDFILE (8080-ARCH-NOT-FOUND)
  5014*        END-EXEC.
  5015*    MOVE '"$I''                  ! $ #00004973' TO DFHEIV0
  5016     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5017     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5018     MOVE X'2420233030303034393733' TO DFHEIV0(25:11)
  5019     CALL 'kxdfhei1' USING DFHEIV0
  5020     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5021
  5022
  5023     PERFORM 7600-READ-ARCH-FILE THRU 7600-EXIT.
  5024
  5025     IF  W-REPLY-DATE NOT EQUAL SPACES
  5026
  5027         IF  W-REPLY-DATE EQUAL LOW-VALUES
  5028             MOVE LOW-VALUES     TO LA-REPLY-DATE
  5029             MOVE 'A'            TO W-STATUS
  5030
  5031         ELSE
  5032             MOVE W-REPLY-DATE   TO LA-REPLY-DATE
  5033             MOVE 'C'            TO W-STATUS.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  98
* EL690.cbl
  5034
  5035     IF  W-RESEND-DATE-1 NOT EQUAL SPACES
  5036             AND
  5037         W-RESEND-DATE-1 NOT EQUAL LA-RESEND-DATE
  5038
  5039         IF  LA-SENT-DATE   GREATER THAN LOW-VALUES
  5040             MOVE ER-7396        TO EMI-ERROR
  5041             MOVE AL-UANON       TO W-RSDATA (W-ARCH-NDX)
  5042             MOVE -1             TO W-RSDATL (W-ARCH-NDX)
  5043             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5044
  5045         ELSE
  5046             MOVE 'A'            TO W-STATUS
  5047             MOVE LOW-VALUES     TO LA-SENT-DATE
  5048             MOVE W-RESEND-DATE-1
  5049                                 TO LA-RESEND-DATE.
  5050
  5051*    IF  W-RESEND-DATE-2 NOT EQUAL SPACES
  5052*            AND
  5053*        W-RESEND-DATE-2 NOT EQUAL LA-RESEND-DATE-2
  5054*
  5055*        IF  LA-SENT-DATE-2 GREATER THAN LOW-VALUES
  5056*            MOVE ER-7396        TO EMI-ERROR
  5057*            MOVE AL-UANON       TO W-RSFRMA (W-ARCH-NDX)
  5058*            MOVE -1             TO W-RSFRML (W-ARCH-NDX)
  5059*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5060*
  5061*        ELSE
  5062*            MOVE 'A'            TO W-STATUS
  5063*            MOVE LOW-VALUES     TO LA-SENT-DATE-2
  5064*            MOVE W-RESEND-DATE-2
  5065*                                TO LA-RESEND-DATE-2.
  5066
  5067*    IF  W-RESEND-DATE-3 NOT EQUAL SPACES
  5068*            AND
  5069*        W-RESEND-DATE-3 NOT EQUAL LA-RESEND-DATE-3
  5070*
  5071*        IF  LA-SENT-DATE-3 GREATER THAN LOW-VALUES
  5072*
  5073*            IF  PI-COMPANY-ID EQUAL 'LAP' OR 'RMC'
  5074*                MOVE ER-7396    TO EMI-ERROR
  5075*                MOVE AL-UANON   TO W-RSSTSA (W-ARCH-NDX)
  5076*                MOVE -1         TO W-RSSTSL (W-ARCH-NDX)
  5077*                PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5078*
  5079*            ELSE
  5080*                MOVE LOW-VALUES TO LA-SENT-DATE-3
  5081*                MOVE W-RESEND-DATE-3
  5082*                                TO LA-RESEND-DATE-3
  5083*                MOVE 'A'        TO W-STATUS
  5084*
  5085*        ELSE
  5086*            MOVE 'A'            TO W-STATUS
  5087*            MOVE LOW-VALUES     TO LA-SENT-DATE-3
  5088*            MOVE W-RESEND-DATE-3
  5089*                                TO LA-RESEND-DATE-3.
  5090
  5091*    IF  LA-RESEND-DATE-3 GREATER THAN LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page  99
* EL690.cbl
  5092*
  5093*        IF  LA-RESEND-DATE-3 GREATER THAN LA-RESEND-DATE-2
  5094*            NEXT SENTENCE
  5095*
  5096*        ELSE
  5097*            EXEC CICS UNLOCK
  5098*                DATASET (W-ARCH-FILE-ID)
  5099*            END-EXEC
  5100*            MOVE ER-9281        TO EMI-ERROR
  5101*            MOVE AL-UANON       TO W-RSFRMA (W-ARCH-NDX)
  5102*            MOVE -1             TO W-RSFRML (W-ARCH-NDX)
  5103*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5104*            GO TO 0740-EXIT.
  5105
  5106*    IF  LA-RESEND-DATE-2 GREATER THAN LOW-VALUES
  5107*
  5108*        IF  LA-RESEND-DATE-2 GREATER THAN LA-RESEND-DATE
  5109*            NEXT SENTENCE
  5110*
  5111*        ELSE
  5112*            EXEC CICS UNLOCK
  5113*                DATASET (W-ARCH-FILE-ID)
  5114*            END-EXEC
  5115*
  5116*            MOVE ER-9281        TO EMI-ERROR
  5117*            MOVE AL-UANON       TO W-RSDATA (W-ARCH-NDX)
  5118*            MOVE -1             TO W-RSDATL (W-ARCH-NDX)
  5119*            PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5120*            GO TO 0740-EXIT.
  5121
  5122     IF  LA-STATUS EQUAL 'X'
  5123             AND
  5124         W-ACTIVE
  5125
  5126         IF  LA-VOIDED-DATE GREATER THAN LOW-VALUES
  5127             MOVE 'V'            TO W-STATUS
  5128
  5129         ELSE
  5130             IF  LA-REPLY-DATE GREATER THAN LOW-VALUES
  5131                 MOVE 'C'        TO W-STATUS.
  5132
  5133     IF  LA-STATUS EQUAL 'V'
  5134             AND
  5135         W-ACTIVE
  5136         MOVE LOW-VALUES         TO LA-VOIDED-DATE.
  5137
  5138*    IF  LA-STATUS EQUAL 'C'
  5139*            AND
  5140*        W-ACTIVE
  5141*        MOVE ER-7399            TO EMI-ERROR
  5142*        MOVE AL-UANON           TO W-STATSA (W-ARCH-NDX)
  5143*        MOVE -1                 TO W-STATSL (W-ARCH-NDX)
  5144*        PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5145*        GO TO 0740-REWRITE.
  5146
  5147     IF  W-CLEAR-INITIAL
  5148         MOVE LOW-VALUES         TO LA-INITIAL-PRINT-DATE
  5149         MOVE 'A'                TO W-STATUS.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 100
* EL690.cbl
  5150
  5151     IF  W-CHECK-STATUS
  5152         PERFORM 0750-CHECK-STATUS THRU 0750-EXIT
  5153
  5154     ELSE
  5155         IF  W-VALID-STATUS
  5156                 AND
  5157             W-STATUS GREATER THAN SPACES
  5158             MOVE W-STATUS       TO LA-STATUS.
  5159
  5160     IF  W-VOIDED
  5161         MOVE W-SAVE-BIN-DATE    TO LA-VOIDED-DATE.
  5162
  5163     IF  LA-REPLY-DATE GREATER THAN LOW-VALUES
  5164             AND
  5165         LA-STATUS EQUAL 'A'
  5166         MOVE 'C'                TO LA-STATUS.
  5167
  5168 0740-REWRITE.
  5169
  5170
  5171* EXEC CICS REWRITE
  5172*        DATASET (W-ARCH-FILE-ID)
  5173*        FROM    (LETTER-ARCHIVE)
  5174*    END-EXEC.
  5175     MOVE LENGTH OF
  5176      LETTER-ARCHIVE
  5177       TO DFHEIV11
  5178*    MOVE '&& L                  %   #00005125' TO DFHEIV0
  5179     MOVE X'2626204C2020202020202020' TO DFHEIV0(1:12)
  5180     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  5181     MOVE X'2020233030303035313235' TO DFHEIV0(25:11)
  5182     CALL 'kxdfhei1' USING DFHEIV0,
  5183           W-ARCH-FILE-ID,
  5184           LETTER-ARCHIVE,
  5185           DFHEIV11,
  5186           DFHEIV99
  5187     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5188
  5189
  5190     IF  W-NO-FIRST-CHANGE
  5191         MOVE W-ARCH-NDX         TO W-FIRST-CHANGE-IND.
  5192
  5193 0740-EXIT.
  5194     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 101
* EL690.cbl
  5196 0750-CHECK-STATUS.
  5197
  5198     IF  LA-STATUS EQUAL '#'
  5199         MOVE 'A'                TO LA-STATUS
  5200         GO TO 0750-EXIT.
  5201
  5202     IF  LA-STATUS NOT EQUAL 'A' OR 'C'
  5203         GO TO 0750-EXIT.
  5204
  5205     IF LA-INITIAL-PRINT-DATE > LOW-VALUES
  5206        IF LA-RESEND-DATE > LOW-VALUES
  5207           IF LA-SENT-DATE = LOW-VALUES
  5208              MOVE 'A'           TO LA-STATUS
  5209           ELSE
  5210              MOVE 'C'           TO LA-STATUS
  5211           END-IF
  5212        ELSE
  5213           MOVE 'C'              TO LA-STATUS
  5214        END-IF
  5215     ELSE
  5216        MOVE 'A'                  TO LA-STATUS
  5217     END-IF
  5218*    IF  LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
  5219*        IF  LA-RESEND-DATE GREATER THAN LOW-VALUES
  5220*            IF  LA-SENT-DATE   NOT GREATER THAN LOW-VALUES
  5221*                MOVE 'A'        TO LA-STATUS
  5222*
  5223*            ELSE
  5224*                IF  LA-RESEND-DATE-2 GREATER THAN LOW-VALUES
  5225*
  5226*                    IF  LA-SENT-DATE-2 NOT GREATER THAN
  5227*                            LOW-VALUES
  5228*                        MOVE 'A'        TO LA-STATUS
  5229*
  5230*                    ELSE
  5231*                        IF  LA-RESEND-DATE-3 GREATER THAN
  5232*                                LOW-VALUES
  5233*
  5234*                            IF  LA-SENT-DATE-3 NOT GREATER
  5235*                                    THAN LOW-VALUES
  5236*                                MOVE 'A' TO LA-STATUS
  5237*
  5238*                            ELSE
  5239*                                MOVE 'C' TO LA-STATUS
  5240*
  5241*                        ELSE
  5242*                            MOVE 'C'
  5243*                                TO LA-STATUS
  5244*
  5245*
  5246*                 ELSE
  5247*                     MOVE 'C'   TO LA-STATUS
  5248*
  5249*        ELSE
  5250*            MOVE 'C'            TO LA-STATUS
  5251*
  5252*    ELSE
  5253*        MOVE 'A'                TO LA-STATUS.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 102
* EL690.cbl
  5254
  5255     .
  5256 0750-EXIT.
  5257     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 103
* EL690.cbl
  5259 0800-CONVERT-EFFECT-DATE.
  5260
  5261      IF  PI-CERT-EFF-DT > LOW-VALUES
  5262          MOVE PI-CERT-EFF-DT    TO DC-BIN-DATE-1
  5263                                    PI-690-INIT-EFFECT-DATE
  5264          MOVE ' '               TO DC-OPTION-CODE
  5265          PERFORM 9500-LINK-DATE-CONVERT
  5266              THRU 9500-EXIT
  5267
  5268          IF  DC-ERROR-CODE EQUAL SPACES
  5269              MOVE DC-GREG-DATE-1-EDIT
  5270                                 TO EFFDTEI
  5271                                    PI-690-INIT-EFF-DTE
  5272              MOVE +8            TO EFFDTEL
  5273
  5274          ELSE
  5275              MOVE LOW-VALUES    TO EFFDTEI
  5276              MOVE +8            TO EFFDTEL
  5277
  5278      ELSE
  5279          MOVE LOW-VALUES        TO EFFDTEI
  5280          MOVE +8                TO EFFDTEL.
  5281
  5282 0800-EXIT.
  5283     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 104
* EL690.cbl
  5285 1000-RECOVER-LAST-SCREEN.
  5286
  5287     MOVE LOW-VALUES             TO EL690AO.
  5288     MOVE 1                      TO W-FIRST-CHANGE-IND.
  5289
  5290     MOVE PI-690-BRWS-TYPE-IND   TO TYPEBRI.
  5291     MOVE +1                     TO TYPEBRL.
  5292
  5293     IF  PI-690-INIT-CERT-PRIME GREATER THAN LOW-VALUES
  5294             AND
  5295         PI-690-INIT-CERT-PRIME LESS THAN HIGH-VALUES
  5296         MOVE PI-690-INIT-CERT-PRIME
  5297                                 TO CERTRPI
  5298         MOVE +10                TO CERTRPL
  5299         MOVE PI-690-INIT-SUFFIX TO SUFFIXI
  5300         MOVE +1                 TO SUFFIXL.
  5301
  5302     IF  PI-690-INIT-CARRIER GREATER THAN LOW-VALUES
  5303             AND
  5304         PI-690-INIT-CARRIER LESS THAN HIGH-VALUES
  5305         MOVE PI-690-INIT-CARRIER
  5306                                 TO CARRIERI
  5307         MOVE +1                 TO CARRIERL.
  5308
  5309     IF  PI-690-INIT-GROUPING GREATER THAN LOW-VALUES
  5310             AND
  5311         PI-690-INIT-GROUPING LESS THAN HIGH-VALUES
  5312         MOVE PI-690-INIT-GROUPING
  5313                                 TO GROUPI
  5314         MOVE +6                 TO GROUPL.
  5315
  5316     IF  PI-690-INIT-STATE GREATER THAN LOW-VALUES
  5317             AND
  5318         PI-690-INIT-STATE LESS THAN HIGH-VALUES
  5319         MOVE PI-690-INIT-STATE  TO STATEI
  5320         MOVE +2                 TO STATEL.
  5321
  5322     IF  PI-690-INIT-ACCOUNT GREATER THAN LOW-VALUES
  5323             AND
  5324         PI-690-INIT-ACCOUNT LESS THAN HIGH-VALUES
  5325         MOVE PI-690-INIT-ACCOUNT
  5326                                 TO ACCTI
  5327         MOVE +10                TO ACCTL.
  5328
  5329     IF  PI-690-INIT-FORM GREATER THAN LOW-VALUES
  5330             AND
  5331         PI-690-INIT-FORM LESS THAN HIGH-VALUES
  5332         MOVE PI-690-INIT-FORM   TO FORMI
  5333         MOVE +04                TO FORML.
  5334
  5335     IF  PI-690-INIT-PROCESSOR GREATER THAN LOW-VALUES
  5336             AND
  5337         PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  5338         MOVE PI-690-INIT-PROCESSOR
  5339                                 TO PROCSRI
  5340         MOVE +04                TO PROCSRL.
  5341
  5342     IF  PI-690-INIT-EFFECT-DATE > LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 105
* EL690.cbl
  5343             AND
  5344         PI-690-INIT-EFFECT-DATE < HIGH-VALUES
  5345         MOVE PI-690-INIT-EFFECT-DATE
  5346                                 TO DC-BIN-DATE-1
  5347         MOVE ' '                TO DC-OPTION-CODE
  5348         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  5349
  5350         IF  DC-ERROR-CODE EQUAL SPACES
  5351             MOVE DC-GREG-DATE-1-EDIT
  5352                                 TO EFFDTEI
  5353             MOVE +8             TO EFFDTEL.
  5354
  5355     IF  PI-690-INIT-ENTRY GREATER THAN LOW-VALUES
  5356             AND
  5357         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  5358             AND
  5359         PI-690-INIT-CONTROL-PREFIX NOT EQUAL 'CK'
  5360         MOVE PI-690-INIT-ENTRY  TO ENTRYI
  5361         MOVE +6                 TO ENTRYL
  5362
  5363     ELSE
  5364         IF  PI-690-INIT-CONTROL GREATER THAN ZEROS
  5365                 AND
  5366             PI-690-INIT-CONTROL LESS THAN 99999999
  5367                 AND
  5368             PI-690-INIT-CONTROL-PREFIX EQUAL 'CK'
  5369             MOVE PI-690-INIT-CONTROL
  5370                                 TO CKCNTLI
  5371             MOVE +8             TO CKCNTLL.
  5372
  5373     IF  PI-690-VALID-SELECTION
  5374         MOVE PI-690-STATUS-SELECTION-IND
  5375                                 TO STATSELI
  5376         MOVE +1                 TO STATSELL
  5377
  5378     ELSE
  5379         MOVE 'N'                TO STATSELI
  5380         MOVE +1                 TO STATSELL.
  5381
  5382     IF  PI-690-LAST-BRWS-FWRD
  5383         MOVE '1'                TO EIBAID
  5384         GO TO 2000-PAGE-FORWARD.
  5385
  5386     IF  PI-690-LAST-BRWS-BWRD
  5387         MOVE '2'                TO EIBAID
  5388         MOVE 'Y'                TO W-READ-PREV-TWICE-IND
  5389         GO TO 3000-PAGE-BACKWARD.
  5390
  5391     MOVE -1                     TO CORRSELL.
  5392     GO TO 8100-SEND-INITIAL-MAP.
  5393
  5394 1000-EXIT.
  5395     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 106
* EL690.cbl
  5397 1200-SET-UP-COMPLETE-SCREEN.
  5398
  5399     MOVE LOW-VALUES        TO EL690AO.
  5400
  5401     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6311'
  5402         GO TO 1220-COMING-FROM-EL6311.
  5403
  5404     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL652'
  5405         GO TO 1240-COMING-FROM-EL652.
  5406
  5407     IF  PI-RETURN-TO-PROGRAM EQUAL 'EL1273'
  5408         MOVE LOW-VALUES         TO PI-689-WORK-AREA
  5409         MOVE PI-CERT-PRIME      TO CERTRPI
  5410         MOVE +10                TO CERTRPL
  5411         MOVE PI-CERT-SFX        TO SUFFIXI
  5412         MOVE +1                 TO SUFFIXL
  5413         MOVE 1                  TO TYPEBRI
  5414         MOVE +1                 TO TYPEBRL
  5415
  5416     ELSE
  5417         IF  PI-RETURN-TO-PROGRAM EQUAL 'EL6501'
  5418             MOVE 4              TO TYPEBRI
  5419             MOVE +1             TO TYPEBRL.
  5420
  5421     MOVE PI-CARRIER             TO CARRIERI.
  5422     MOVE +1                     TO CARRIERL.
  5423     MOVE PI-GROUPING            TO GROUPI.
  5424     MOVE +6                     TO GROUPL.
  5425     MOVE PI-STATE               TO STATEI.
  5426     MOVE +2                     TO STATEL.
  5427     MOVE PI-ACCOUNT             TO ACCTI.
  5428     MOVE +10                    TO ACCTL.
  5429
  5430     IF  PI-CERT-EFF-DT NOT EQUAL LOW-VALUES
  5431             AND
  5432         PI-CERT-EFF-DT NOT EQUAL SPACES
  5433         MOVE PI-CERT-EFF-DT     TO DC-BIN-DATE-1
  5434         MOVE ' '                TO DC-OPTION-CODE
  5435         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  5436
  5437         IF  DC-ERROR-CODE EQUAL SPACES
  5438             MOVE DC-GREG-DATE-1-EDIT
  5439                                 TO EFFDTEI
  5440             MOVE +8             TO EFFDTEL.
  5441
  5442     MOVE '1'                    TO EIBAID.
  5443
  5444     PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT.
  5445     MOVE ER-7397                TO EMI-ERROR.
  5446     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5447     GO TO 3000-PAGE-BACKWARD.
  5448*    GO TO 2000-PAGE-FORWARD.
  5449
  5450 1200-EXIT.
  5451     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 107
* EL690.cbl
  5453 1220-COMING-FROM-EL6311.
  5454
  5455     MOVE 1                      TO TYPEBRI.
  5456     MOVE +1                     TO TYPEBRL.
  5457*    MOVE PI-689-ENTRY-BATCH     TO ENTRYI.
  5458*    MOVE +6                     TO ENTRYL.
  5459     MOVE PI-689-CERT-PRIME      TO CERTRPI.
  5460     MOVE +10                    TO CERTRPL.
  5461     MOVE PI-689-CERT-SFX        TO SUFFIXI.
  5462     MOVE +1                     TO SUFFIXL.
  5463     MOVE PI-689-CARRIER         TO CARRIERI.
  5464     MOVE +1                     TO CARRIERL.
  5465     MOVE PI-689-GROUPING        TO GROUPI.
  5466     MOVE +6                     TO GROUPL.
  5467     MOVE PI-689-STATE           TO STATEI.
  5468     MOVE +2                     TO STATEL.
  5469     MOVE PI-689-ACCOUNT         TO ACCTI.
  5470     MOVE +10                    TO ACCTL.
  5471
  5472     IF  PI-689-EFF-DATE GREATER THAN LOW-VALUES
  5473         MOVE PI-689-EFF-DATE    TO DC-BIN-DATE-1
  5474         MOVE ' '                TO DC-OPTION-CODE
  5475         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  5476
  5477         IF  DC-ERROR-CODE EQUAL SPACES
  5478             MOVE DC-GREG-DATE-1-EDIT
  5479                                 TO EFFDTEI
  5480             MOVE +8             TO EFFDTEL
  5481
  5482         ELSE
  5483             MOVE LOW-VALUES     TO EFFDTEI
  5484             MOVE +8             TO EFFDTEL
  5485
  5486     ELSE
  5487         MOVE LOW-VALUES         TO EFFDTEI
  5488         MOVE +8                 TO EFFDTEL.
  5489
  5490     MOVE '1'                    TO EIBAID.
  5491
  5492     PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT.
  5493     MOVE ER-7397                TO EMI-ERROR.
  5494     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5495     GO TO 3000-PAGE-BACKWARD.
  5496*    GO TO 2000-PAGE-FORWARD.
  5497
  5498 1220-EXIT.
  5499     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 108
* EL690.cbl
  5501 1240-COMING-FROM-EL652.
  5502
  5503     MOVE 1                      TO TYPEBRI.
  5504     MOVE +1                     TO TYPEBRL.
  5505     MOVE PI-CR-FIN-RESP         TO CERTRPI.
  5506     MOVE +10                    TO CERTRPL.
  5507     MOVE PI-CR-TYPE             TO SUFFIXI.
  5508     MOVE +1                     TO SUFFIXL.
  5509     MOVE PI-CR-CARRIER          TO CARRIERI.
  5510     MOVE +1                     TO CARRIERL.
  5511     MOVE PI-CR-GROUPING         TO GROUPI.
  5512     MOVE +6                     TO GROUPL.
  5513     MOVE PI-CR-ACCOUNT          TO ACCTI.
  5514     MOVE +10                    TO ACCTL.
  5515
  5516     MOVE AL-UANON               TO CARRIERA
  5517                                    GROUPA
  5518                                    ACCTA
  5519                                    TYPEBRA
  5520                                    CERTRPA.
  5521
  5522     PERFORM 0500-EDIT-SCREEN-DATA THRU 0500-EXIT.
  5523     MOVE ER-7397                TO EMI-ERROR.
  5524     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5525     GO TO 3000-PAGE-BACKWARD.
  5526*    GO TO 2000-PAGE-FORWARD.
  5527
  5528 1240-EXIT.
  5529     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 109
* EL690.cbl
  5531 1500-SELECT-ARCHIVE-REC.
  5532
  5533     MOVE ZEROS                  TO PI-689-ARCHIVE-NUMBER.
  5534
  5535     IF  CORRSELL GREATER THAN +0
  5536
  5537
  5538* EXEC CICS BIF DEEDIT
  5539*            FIELD   (CORRSELI)
  5540*            LENGTH  (2)
  5541*            END-EXEC
  5542     MOVE 2
  5543       TO DFHEIV11
  5544*    MOVE '@"L                   #   #00005477' TO DFHEIV0
  5545     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  5546     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  5547     MOVE X'2020233030303035343737' TO DFHEIV0(25:11)
  5548     CALL 'kxdfhei1' USING DFHEIV0,
  5549           CORRSELI,
  5550           DFHEIV11
  5551     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  5552
  5553         IF  CORRSELI NUMERIC
  5554
  5555             IF  CORRSELI NOT LESS THAN 01
  5556                     AND
  5557                 CORRSELI NOT GREATER THAN 12
  5558                 MOVE CORRSELI   TO W-ARCH-NDX
  5559
  5560                 IF  PI-690-ARCHIVE-NUM (W-ARCH-NDX)
  5561                          NOT EQUAL ZEROS
  5562                     MOVE PI-690-ARCHIVE-NUM (W-ARCH-NDX)
  5563                                 TO PI-689-ARCHIVE-NUMBER
  5564                     GO TO 1500-EXIT
  5565
  5566                 ELSE
  5567                     MOVE ER-9293
  5568                                 TO EMI-ERROR
  5569                     MOVE -1     TO CORRSELL
  5570                     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5571                     GO TO 8200-SEND-DATAONLY
  5572
  5573         ELSE
  5574             MOVE ER-9293        TO EMI-ERROR
  5575             MOVE -1             TO CORRSELL
  5576             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  5577             GO TO 8200-SEND-DATAONLY.
  5578
  5579 1500-EXIT.
  5580     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 110
* EL690.cbl
  5582 2000-PAGE-FORWARD.
  5583
  5584     MOVE '1'                    TO PI-690-LAST-BROWSE-IND.
  5585     MOVE +1                     TO W-ARCH-NDX.
  5586     MOVE ZEROS                  TO W-ARCH-NUMBER.
  5587
  5588     GO TO 2100-ARCH2-PROCESS
  5589           2200-ARCH3-PROCESS
  5590           2300-ARCH4-PROCESS
  5591           2400-ARCH5-PROCESS
  5592           2500-ARCH6-PROCESS
  5593           2600-ARCH-PROCESS DEPENDING ON PI-690-BRWS-TYPE-IND.
  5594
  5595     MOVE ER-7384                TO EMI-ERROR.
  5596     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5597     MOVE -1                     TO TYPEBRL.
  5598     MOVE AL-UABON               TO TYPEBRA.
  5599     GO TO 8100-SEND-INITIAL-MAP.
  5600
  5601 2000-EXIT.
  5602     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 111
* EL690.cbl
  5604 2100-ARCH2-PROCESS.
  5605
  5606     IF  W-CHANGE-REQUESTED
  5607         MOVE LOW-VALUES         TO W-ARCH2-KEY
  5608         MOVE PI-COMPANY-CD      TO W-ARCH2-COMPANY-CD
  5609         MOVE PI-690-INIT-CERT-PRIME
  5610                                 TO W-ARCH2-CERT-PRIME
  5611         MOVE PI-690-INIT-SUFFIX TO W-ARCH2-SUFFIX
  5612         MOVE PI-690-INIT-CARRIER
  5613                                 TO W-ARCH2-CARRIER
  5614         MOVE PI-690-INIT-GROUPING
  5615                                 TO W-ARCH2-GROUPING
  5616         MOVE PI-690-INIT-STATE  TO W-ARCH2-STATE
  5617         MOVE PI-690-INIT-ACCOUNT
  5618                                 TO W-ARCH2-ACCOUNT
  5619         MOVE PI-690-INIT-EFFECT-DATE
  5620                                 TO W-ARCH2-EFF-DTE
  5621         MOVE PI-690-INIT-ARCHIVE-NO
  5622                                 TO W-ARCH2-ARCHIVE-NO
  5623
  5624     ELSE
  5625         IF  W-FIRST-CHANGE-FOUND
  5626             MOVE LOW-VALUES     TO W-ARCH2-KEY
  5627             MOVE PI-COMPANY-CD  TO W-ARCH2-COMPANY-CD
  5628             MOVE PI-690-FIRST-CERT-PRIME
  5629                                 TO W-ARCH2-CERT-PRIME
  5630             MOVE PI-690-FIRST-SUFFIX
  5631                                 TO W-ARCH2-SUFFIX
  5632             MOVE PI-690-FIRST-CARRIER
  5633                                 TO W-ARCH2-CARRIER
  5634             MOVE PI-690-FIRST-GROUPING
  5635                                 TO W-ARCH2-GROUPING
  5636             MOVE PI-690-FIRST-STATE
  5637                                 TO W-ARCH2-STATE
  5638             MOVE PI-690-FIRST-ACCOUNT
  5639                                 TO W-ARCH2-ACCOUNT
  5640             MOVE PI-690-FIRST-EFFECT-DATE
  5641                                 TO W-ARCH2-EFF-DTE
  5642             MOVE PI-690-FIRST-ARCHIVE-NO
  5643                                 TO W-ARCH2-ARCHIVE-NO
  5644
  5645         ELSE
  5646             MOVE LOW-VALUES     TO W-ARCH2-KEY
  5647             MOVE PI-COMPANY-CD  TO W-ARCH2-COMPANY-CD
  5648             MOVE PI-690-LAST-CERT-PRIME
  5649                                 TO W-ARCH2-CERT-PRIME
  5650             MOVE PI-690-LAST-SUFFIX
  5651                                 TO W-ARCH2-SUFFIX
  5652             MOVE PI-690-LAST-CARRIER
  5653                                 TO W-ARCH2-CARRIER
  5654             MOVE PI-690-LAST-GROUPING
  5655                                 TO W-ARCH2-GROUPING
  5656             MOVE PI-690-LAST-STATE
  5657                                 TO W-ARCH2-STATE
  5658             MOVE PI-690-LAST-ACCOUNT
  5659                                 TO W-ARCH2-ACCOUNT
  5660             MOVE PI-690-LAST-EFFECT-DATE
  5661                                 TO W-ARCH2-EFF-DTE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 112
* EL690.cbl
  5662             MOVE PI-690-LAST-ARCHIVE-NO
  5663                                 TO W-ARCH2-ARCHIVE-NO.
  5664
  5665
  5666* EXEC CICS HANDLE CONDITION
  5667*        NOTFND  (8080-ARCH-NOT-FOUND)
  5668*        ENDFILE (8080-ARCH-NOT-FOUND)
  5669*        NOTOPEN (8000-ARCH2-NOT-OPEN)
  5670*        END-EXEC.
  5671*    MOVE '"$I''J                 ! % #00005594' TO DFHEIV0
  5672     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  5673     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5674     MOVE X'2520233030303035353934' TO DFHEIV0(25:11)
  5675     CALL 'kxdfhei1' USING DFHEIV0
  5676     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5677
  5678
  5679
  5680* EXEC CICS STARTBR
  5681*        DATASET  (W-ARCH2-FILE-ID)
  5682*        RIDFLD   (W-ARCH2-KEY)
  5683*        GTEQ
  5684*        END-EXEC.
  5685     MOVE 0
  5686       TO DFHEIV11
  5687*    MOVE '&,         G          &   #00005600' TO DFHEIV0
  5688     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5689     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5690     MOVE X'2020233030303035363030' TO DFHEIV0(25:11)
  5691     CALL 'kxdfhei1' USING DFHEIV0,
  5692           W-ARCH2-FILE-ID,
  5693           W-ARCH2-KEY,
  5694           DFHEIV99,
  5695           DFHEIV11,
  5696           DFHEIV99
  5697     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5698
  5699
  5700     PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT.
  5701
  5702
  5703* EXEC CICS HANDLE CONDITION
  5704*        NOTFND  (2100-END-BROWSE)
  5705*        ENDFILE (2100-END-BROWSE)
  5706*        END-EXEC.
  5707*    MOVE '"$I''                  ! & #00005608' TO DFHEIV0
  5708     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5709     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5710     MOVE X'2620233030303035363038' TO DFHEIV0(25:11)
  5711     CALL 'kxdfhei1' USING DFHEIV0
  5712     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5713
  5714
  5715 2100-BUILD-ARCH2-LIST.
  5716
  5717     IF  LA-COMPANY-CD-A2 NOT EQUAL PI-COMPANY-CD
  5718         GO TO 2100-END-BROWSE.
  5719
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 113
* EL690.cbl
  5720     IF  PI-690-INIT-CERT-NO EQUAL LOW-VALUES OR HIGH-VALUES
  5721         GO TO 2100-CONTINUE.
  5722
  5723     IF  LA-CERT-NO-A2 NOT EQUAL PI-690-INIT-CERT-NO
  5724         GO TO 2100-END-BROWSE.
  5725
  5726     IF  PI-690-INIT-CARRIER EQUAL LOW-VALUES OR HIGH-VALUES
  5727         GO TO 2100-CONTINUE.
  5728
  5729     IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  5730         GO TO 2100-END-BROWSE.
  5731
  5732     IF  PI-690-INIT-GROUPING EQUAL LOW-VALUES OR HIGH-VALUES
  5733         GO TO 2100-CONTINUE.
  5734
  5735     IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  5736         GO TO 2100-END-BROWSE.
  5737
  5738     IF  PI-690-INIT-STATE EQUAL LOW-VALUES OR HIGH-VALUES
  5739         GO TO 2100-CONTINUE.
  5740
  5741     IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  5742         GO TO 2100-END-BROWSE.
  5743
  5744     IF  PI-690-INIT-ACCOUNT EQUAL LOW-VALUES OR HIGH-VALUES
  5745         GO TO 2100-CONTINUE.
  5746
  5747     IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  5748         GO TO 2100-END-BROWSE.
  5749
  5750     IF  PI-690-INIT-EFFECT-DATE = LOW-VALUES OR HIGH-VALUES
  5751         GO TO 2100-CONTINUE.
  5752
  5753     IF  LA-EFFECT-DATE-A2 NOT EQUAL PI-690-INIT-EFFECT-DATE
  5754         GO TO 2100-END-BROWSE.
  5755
  5756 2100-CONTINUE.
  5757
  5758     IF  NOT PI-690-SELECT-ALL
  5759             AND
  5760         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  5761         PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5762         GO TO 2100-BUILD-ARCH2-LIST.
  5763
  5764     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  5765                 AND
  5766         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  5767         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  5768             PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5769             GO TO 2100-BUILD-ARCH2-LIST.
  5770
  5771     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  5772                 AND
  5773         PI-690-INIT-FORM LESS THAN HIGH-VALUES
  5774         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  5775             PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5776             GO TO 2100-BUILD-ARCH2-LIST.
  5777
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 114
* EL690.cbl
  5778     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  5779                 AND
  5780         PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  5781         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  5782             PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5783             GO TO 2100-BUILD-ARCH2-LIST.
  5784
  5785     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  5786
  5787     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  5788
  5789     IF  W-ARCH-NDX LESS THAN +13
  5790         PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT
  5791         GO TO 2100-BUILD-ARCH2-LIST.
  5792
  5793 2100-END.
  5794
  5795     MOVE -1                     TO CORRSELL.
  5796     MOVE ZEROS                  TO CORRSELO.
  5797     PERFORM 2100-END-BROWSE.
  5798     GO TO 8100-SEND-INITIAL-MAP.
  5799
  5800 2100-END-BROWSE.
  5801
  5802
  5803* EXEC CICS ENDBR
  5804*        DATASET (W-ARCH2-FILE-ID)
  5805*    END-EXEC.
  5806     MOVE 0
  5807       TO DFHEIV11
  5808*    MOVE '&2                    $   #00005700' TO DFHEIV0
  5809     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  5810     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  5811     MOVE X'2020233030303035373030' TO DFHEIV0(25:11)
  5812     CALL 'kxdfhei1' USING DFHEIV0,
  5813           W-ARCH2-FILE-ID,
  5814           DFHEIV11,
  5815           DFHEIV99
  5816     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5817
  5818
  5819 2100-NOT-FOUND.
  5820
  5821     MOVE ER-0130                TO EMI-ERROR.
  5822     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  5823     MOVE -1                     TO CORRSELL.
  5824     MOVE ZEROS                  TO CORRSELO.
  5825     GO TO 8100-SEND-INITIAL-MAP.
  5826
  5827 2100-EXIT.
  5828     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 115
* EL690.cbl
  5830 2200-ARCH3-PROCESS.
  5831
  5832     IF  W-CHANGE-REQUESTED
  5833         MOVE LOW-VALUES         TO W-ARCH3-KEY
  5834         MOVE PI-COMPANY-CD      TO W-ARCH3-COMPANY-CD
  5835         MOVE PI-690-INIT-FORM   TO W-ARCH3-FORM
  5836         MOVE PI-690-INIT-CARRIER
  5837                                 TO W-ARCH3-CARRIER
  5838         MOVE PI-690-INIT-GROUPING
  5839                                 TO W-ARCH3-GROUPING
  5840         MOVE PI-690-INIT-STATE  TO W-ARCH3-STATE
  5841         MOVE PI-690-INIT-ACCOUNT
  5842                                 TO W-ARCH3-ACCOUNT
  5843         MOVE PI-690-INIT-ARCHIVE-NO
  5844                                 TO W-ARCH3-ARCHIVE-NO
  5845
  5846     ELSE
  5847         IF  W-FIRST-CHANGE-FOUND
  5848             MOVE LOW-VALUES     TO W-ARCH3-KEY
  5849             MOVE PI-COMPANY-CD  TO W-ARCH3-COMPANY-CD
  5850             MOVE PI-690-FIRST-FORM
  5851                                 TO W-ARCH3-FORM
  5852             MOVE PI-690-FIRST-CARRIER
  5853                                 TO W-ARCH3-CARRIER
  5854             MOVE PI-690-FIRST-GROUPING
  5855                                 TO W-ARCH3-GROUPING
  5856             MOVE PI-690-FIRST-STATE
  5857                                 TO W-ARCH3-STATE
  5858             MOVE PI-690-FIRST-ACCOUNT
  5859                                 TO W-ARCH3-ACCOUNT
  5860             MOVE PI-690-FIRST-ARCHIVE-NO
  5861                                 TO W-ARCH3-ARCHIVE-NO
  5862
  5863         ELSE
  5864             MOVE LOW-VALUES     TO W-ARCH3-KEY
  5865             MOVE PI-COMPANY-CD  TO W-ARCH3-COMPANY-CD
  5866             MOVE PI-690-LAST-FORM
  5867                                 TO W-ARCH3-FORM
  5868             MOVE PI-690-LAST-CARRIER
  5869                                 TO W-ARCH3-CARRIER
  5870             MOVE PI-690-LAST-GROUPING
  5871                                 TO W-ARCH3-GROUPING
  5872             MOVE PI-690-LAST-STATE
  5873                                 TO W-ARCH3-STATE
  5874             MOVE PI-690-LAST-ACCOUNT
  5875                                 TO W-ARCH3-ACCOUNT
  5876             MOVE PI-690-LAST-ARCHIVE-NO
  5877                                 TO W-ARCH3-ARCHIVE-NO.
  5878
  5879
  5880* EXEC CICS HANDLE CONDITION
  5881*        NOTFND  (8080-ARCH-NOT-FOUND)
  5882*        ENDFILE (8080-ARCH-NOT-FOUND)
  5883*        NOTOPEN (8010-ARCH3-NOT-OPEN)
  5884*        END-EXEC.
  5885*    MOVE '"$I''J                 ! '' #00005764' TO DFHEIV0
  5886     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  5887     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 116
* EL690.cbl
  5888     MOVE X'2720233030303035373634' TO DFHEIV0(25:11)
  5889     CALL 'kxdfhei1' USING DFHEIV0
  5890     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5891
  5892
  5893
  5894* EXEC CICS STARTBR
  5895*        DATASET  (W-ARCH3-FILE-ID)
  5896*        RIDFLD   (W-ARCH3-KEY)
  5897*        GTEQ
  5898*    END-EXEC.
  5899     MOVE 0
  5900       TO DFHEIV11
  5901*    MOVE '&,         G          &   #00005770' TO DFHEIV0
  5902     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  5903     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  5904     MOVE X'2020233030303035373730' TO DFHEIV0(25:11)
  5905     CALL 'kxdfhei1' USING DFHEIV0,
  5906           W-ARCH3-FILE-ID,
  5907           W-ARCH3-KEY,
  5908           DFHEIV99,
  5909           DFHEIV11,
  5910           DFHEIV99
  5911     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5912
  5913
  5914     PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT.
  5915
  5916
  5917* EXEC CICS HANDLE CONDITION
  5918*        NOTFND  (2200-END-BROWSE)
  5919*        ENDFILE (2200-END-BROWSE)
  5920*        END-EXEC.
  5921*    MOVE '"$I''                  ! ( #00005778' TO DFHEIV0
  5922     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  5923     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  5924     MOVE X'2820233030303035373738' TO DFHEIV0(25:11)
  5925     CALL 'kxdfhei1' USING DFHEIV0
  5926     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  5927
  5928
  5929 2200-BUILD-ARCH3-LIST.
  5930
  5931     IF  LA-COMPANY-CD-A3 NOT EQUAL PI-COMPANY-CD
  5932         GO TO 2200-END-BROWSE.
  5933
  5934     IF  PI-690-INIT-FORM EQUAL LOW-VALUES OR HIGH-VALUES
  5935         GO TO 2200-CONTINUE.
  5936
  5937     IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  5938         GO TO 2200-END-BROWSE.
  5939
  5940     IF  PI-690-INIT-CARRIER EQUAL LOW-VALUES OR HIGH-VALUES
  5941         GO TO 2200-CONTINUE.
  5942
  5943     IF  LA-CARRIER-A3 NOT EQUAL PI-690-INIT-CARRIER
  5944         GO TO 2200-END-BROWSE.
  5945
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 117
* EL690.cbl
  5946     IF  PI-690-INIT-GROUPING EQUAL LOW-VALUES OR HIGH-VALUES
  5947         GO TO 2200-CONTINUE.
  5948
  5949     IF  LA-GROUPING-A3 NOT EQUAL PI-690-INIT-GROUPING
  5950         GO TO 2200-END-BROWSE.
  5951
  5952     IF  PI-690-INIT-STATE EQUAL LOW-VALUES OR HIGH-VALUES
  5953         GO TO 2200-CONTINUE.
  5954
  5955     IF  LA-STATE-A3 NOT EQUAL PI-690-INIT-STATE
  5956         GO TO 2200-END-BROWSE.
  5957
  5958     IF  PI-690-INIT-ACCOUNT EQUAL LOW-VALUES OR HIGH-VALUES
  5959         GO TO 2200-CONTINUE.
  5960
  5961     IF  LA-ACCOUNT-A3 NOT EQUAL PI-690-INIT-ACCOUNT
  5962         GO TO 2200-END-BROWSE.
  5963
  5964 2200-CONTINUE.
  5965
  5966     IF  NOT PI-690-SELECT-ALL
  5967             AND
  5968         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  5969         PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT
  5970         GO TO 2200-BUILD-ARCH3-LIST.
  5971
  5972     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  5973                 AND
  5974         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  5975         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  5976             PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT
  5977             GO TO 2200-BUILD-ARCH3-LIST.
  5978
  5979     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  5980                 AND
  5981         PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  5982         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  5983             PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT
  5984             GO TO 2200-BUILD-ARCH3-LIST.
  5985
  5986     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  5987
  5988     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  5989
  5990     IF  W-ARCH-NDX LESS THAN +13
  5991         PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT
  5992         GO TO 2200-BUILD-ARCH3-LIST.
  5993
  5994 2200-END.
  5995
  5996     MOVE -1                     TO CORRSELL.
  5997     MOVE ZEROS                  TO CORRSELO.
  5998     PERFORM 2200-END-BROWSE.
  5999     GO TO 8100-SEND-INITIAL-MAP.
  6000
  6001 2200-END-BROWSE.
  6002
  6003
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 118
* EL690.cbl
  6004* EXEC CICS ENDBR
  6005*        DATASET (W-ARCH3-FILE-ID)
  6006*    END-EXEC.
  6007     MOVE 0
  6008       TO DFHEIV11
  6009*    MOVE '&2                    $   #00005857' TO DFHEIV0
  6010     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6011     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6012     MOVE X'2020233030303035383537' TO DFHEIV0(25:11)
  6013     CALL 'kxdfhei1' USING DFHEIV0,
  6014           W-ARCH3-FILE-ID,
  6015           DFHEIV11,
  6016           DFHEIV99
  6017     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6018
  6019
  6020 2200-ARCH3-NOT-FOUND.
  6021
  6022     MOVE ER-0130                TO EMI-ERROR.
  6023     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6024     MOVE -1                     TO CORRSELL.
  6025     MOVE ZEROS                  TO CORRSELO.
  6026     GO TO 8100-SEND-INITIAL-MAP.
  6027
  6028 2200-EXIT.
  6029     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 119
* EL690.cbl
  6031 2300-ARCH4-PROCESS.
  6032
  6033     IF  W-CHANGE-REQUESTED
  6034         MOVE LOW-VALUES         TO W-ARCH4-KEY
  6035         MOVE PI-COMPANY-CD      TO W-ARCH4-COMPANY-CD
  6036         MOVE PI-690-INIT-PROCESSOR
  6037                                 TO W-ARCH4-PROCESSOR
  6038         MOVE PI-690-INIT-CARRIER
  6039                                 TO W-ARCH4-CARRIER
  6040         MOVE PI-690-INIT-GROUPING
  6041                                 TO W-ARCH4-GROUPING
  6042         MOVE PI-690-INIT-STATE  TO W-ARCH4-STATE
  6043         MOVE PI-690-INIT-ACCOUNT
  6044                                 TO W-ARCH4-ACCOUNT
  6045         MOVE PI-690-INIT-ARCHIVE-NO
  6046                                 TO W-ARCH4-ARCHIVE-NO
  6047
  6048     ELSE
  6049         IF  W-FIRST-CHANGE-FOUND
  6050             MOVE LOW-VALUES     TO W-ARCH4-KEY
  6051             MOVE PI-COMPANY-CD  TO W-ARCH4-COMPANY-CD
  6052             MOVE PI-690-FIRST-PROCESSOR
  6053                                 TO W-ARCH4-PROCESSOR
  6054             MOVE PI-690-FIRST-CARRIER
  6055                                 TO W-ARCH4-CARRIER
  6056             MOVE PI-690-FIRST-GROUPING
  6057                                 TO W-ARCH4-GROUPING
  6058             MOVE PI-690-FIRST-STATE
  6059                                 TO W-ARCH4-STATE
  6060             MOVE PI-690-FIRST-ACCOUNT
  6061                                 TO W-ARCH4-ACCOUNT
  6062             MOVE PI-690-FIRST-ARCHIVE-NO
  6063                                 TO W-ARCH4-ARCHIVE-NO
  6064
  6065         ELSE
  6066             MOVE LOW-VALUES     TO W-ARCH4-KEY
  6067             MOVE PI-COMPANY-CD  TO W-ARCH4-COMPANY-CD
  6068             MOVE PI-690-LAST-PROCESSOR
  6069                                 TO W-ARCH4-PROCESSOR
  6070             MOVE PI-690-LAST-CARRIER
  6071                                 TO W-ARCH4-CARRIER
  6072             MOVE PI-690-LAST-GROUPING
  6073                                 TO W-ARCH4-GROUPING
  6074             MOVE PI-690-LAST-STATE
  6075                                 TO W-ARCH4-STATE
  6076             MOVE PI-690-LAST-ACCOUNT
  6077                                 TO W-ARCH4-ACCOUNT
  6078             MOVE PI-690-LAST-ARCHIVE-NO
  6079                                 TO W-ARCH4-ARCHIVE-NO.
  6080
  6081
  6082* EXEC CICS HANDLE CONDITION
  6083*        NOTFND  (8080-ARCH-NOT-FOUND)
  6084*        ENDFILE (8080-ARCH-NOT-FOUND)
  6085*        NOTOPEN (8020-ARCH4-NOT-OPEN)
  6086*        END-EXEC.
  6087*    MOVE '"$I''J                 ! ) #00005922' TO DFHEIV0
  6088     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 120
* EL690.cbl
  6089     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6090     MOVE X'2920233030303035393232' TO DFHEIV0(25:11)
  6091     CALL 'kxdfhei1' USING DFHEIV0
  6092     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6093
  6094
  6095
  6096* EXEC CICS STARTBR
  6097*        DATASET  (W-ARCH4-FILE-ID)
  6098*        RIDFLD   (W-ARCH4-KEY)
  6099*        GTEQ
  6100*    END-EXEC.
  6101     MOVE 0
  6102       TO DFHEIV11
  6103*    MOVE '&,         G          &   #00005928' TO DFHEIV0
  6104     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6105     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6106     MOVE X'2020233030303035393238' TO DFHEIV0(25:11)
  6107     CALL 'kxdfhei1' USING DFHEIV0,
  6108           W-ARCH4-FILE-ID,
  6109           W-ARCH4-KEY,
  6110           DFHEIV99,
  6111           DFHEIV11,
  6112           DFHEIV99
  6113     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6114
  6115
  6116     PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT.
  6117
  6118
  6119* EXEC CICS HANDLE CONDITION
  6120*        NOTFND  (2300-END-BROWSE)
  6121*        ENDFILE (2300-END-BROWSE)
  6122*        END-EXEC.
  6123*    MOVE '"$I''                  ! * #00005936' TO DFHEIV0
  6124     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6125     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6126     MOVE X'2A20233030303035393336' TO DFHEIV0(25:11)
  6127     CALL 'kxdfhei1' USING DFHEIV0
  6128     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6129
  6130
  6131 2300-BUILD-ARCH4-LIST.
  6132
  6133     IF  LA-COMPANY-CD-A4 NOT EQUAL PI-COMPANY-CD
  6134         GO TO 2300-END-BROWSE.
  6135
  6136     IF  PI-690-INIT-PROCESSOR EQUAL LOW-VALUES OR HIGH-VALUES
  6137         GO TO 2300-CONTINUE.
  6138
  6139     IF  LA-PROCESSOR-CD NOT EQUAL PI-690-INIT-PROCESSOR
  6140         GO TO 2300-END-BROWSE.
  6141
  6142     IF  PI-690-INIT-CARRIER EQUAL LOW-VALUES OR HIGH-VALUES
  6143         GO TO 2300-CONTINUE.
  6144
  6145     IF  LA-CARRIER-A4 NOT EQUAL PI-690-INIT-CARRIER
  6146         GO TO 2300-END-BROWSE.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 121
* EL690.cbl
  6147
  6148     IF  PI-690-INIT-GROUPING EQUAL LOW-VALUES OR HIGH-VALUES
  6149         GO TO 2300-CONTINUE.
  6150
  6151     IF  LA-GROUPING-A4 NOT EQUAL PI-690-INIT-GROUPING
  6152         GO TO 2300-END-BROWSE.
  6153
  6154     IF  PI-690-INIT-STATE EQUAL LOW-VALUES OR HIGH-VALUES
  6155         GO TO 2300-CONTINUE.
  6156
  6157     IF  LA-STATE-A4 NOT EQUAL PI-690-INIT-STATE
  6158         GO TO 2300-END-BROWSE.
  6159
  6160     IF  PI-690-INIT-ACCOUNT EQUAL LOW-VALUES OR HIGH-VALUES
  6161         GO TO 2300-CONTINUE.
  6162
  6163     IF  LA-ACCOUNT-A4 NOT EQUAL PI-690-INIT-ACCOUNT
  6164         GO TO 2300-END-BROWSE.
  6165
  6166 2300-CONTINUE.
  6167
  6168     IF  NOT PI-690-SELECT-ALL
  6169             AND
  6170         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6171         PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT
  6172         GO TO 2300-BUILD-ARCH4-LIST.
  6173
  6174     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  6175                 AND
  6176         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  6177         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  6178             PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT
  6179             GO TO 2300-BUILD-ARCH4-LIST.
  6180
  6181     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6182                 AND
  6183         PI-690-INIT-FORM LESS THAN HIGH-VALUES
  6184         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  6185             PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT
  6186             GO TO 2300-BUILD-ARCH4-LIST.
  6187
  6188     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6189
  6190     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6191
  6192     IF  W-ARCH-NDX LESS THAN +13
  6193         PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT
  6194         GO TO 2300-BUILD-ARCH4-LIST.
  6195
  6196 2300-END.
  6197
  6198     MOVE -1                     TO CORRSELL.
  6199     MOVE ZEROS                  TO CORRSELO.
  6200     PERFORM 2300-END-BROWSE.
  6201     GO TO 8100-SEND-INITIAL-MAP.
  6202
  6203 2300-END-BROWSE.
  6204
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 122
* EL690.cbl
  6205
  6206* EXEC CICS ENDBR
  6207*        DATASET (W-ARCH4-FILE-ID)
  6208*    END-EXEC.
  6209     MOVE 0
  6210       TO DFHEIV11
  6211*    MOVE '&2                    $   #00006015' TO DFHEIV0
  6212     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6213     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6214     MOVE X'2020233030303036303135' TO DFHEIV0(25:11)
  6215     CALL 'kxdfhei1' USING DFHEIV0,
  6216           W-ARCH4-FILE-ID,
  6217           DFHEIV11,
  6218           DFHEIV99
  6219     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6220
  6221
  6222 2300-ARCH4-NOT-FOUND.
  6223
  6224     MOVE ER-0130                TO EMI-ERROR.
  6225     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6226     MOVE -1                     TO CORRSELL.
  6227     MOVE ZEROS                  TO CORRSELO.
  6228     GO TO 8100-SEND-INITIAL-MAP.
  6229
  6230 2300-EXIT.
  6231     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 123
* EL690.cbl
  6233 2400-ARCH5-PROCESS.
  6234
  6235     IF  W-CHANGE-REQUESTED
  6236         MOVE LOW-VALUES         TO W-ARCH5-KEY
  6237         MOVE PI-COMPANY-CD      TO W-ARCH5-COMPANY-CD
  6238         MOVE PI-690-INIT-CARRIER
  6239                                 TO W-ARCH5-CARRIER
  6240         MOVE PI-690-INIT-GROUPING
  6241                                 TO W-ARCH5-GROUPING
  6242         MOVE PI-690-INIT-STATE  TO W-ARCH5-STATE
  6243         MOVE PI-690-INIT-ACCOUNT
  6244                                 TO W-ARCH5-ACCOUNT
  6245         MOVE PI-690-INIT-ARCHIVE-NO
  6246                                 TO W-ARCH5-ARCHIVE-NO
  6247
  6248     ELSE
  6249         IF  W-FIRST-CHANGE-FOUND
  6250             MOVE LOW-VALUES     TO W-ARCH5-KEY
  6251             MOVE PI-COMPANY-CD  TO W-ARCH5-COMPANY-CD
  6252             MOVE PI-690-FIRST-CARRIER
  6253                                 TO W-ARCH5-CARRIER
  6254             MOVE PI-690-FIRST-GROUPING
  6255                                 TO W-ARCH5-GROUPING
  6256             MOVE PI-690-FIRST-STATE
  6257                                 TO W-ARCH5-STATE
  6258             MOVE PI-690-FIRST-ACCOUNT
  6259                                 TO W-ARCH5-ACCOUNT
  6260             MOVE PI-690-FIRST-ARCHIVE-NO
  6261                                 TO W-ARCH5-ARCHIVE-NO
  6262
  6263         ELSE
  6264             MOVE LOW-VALUES     TO W-ARCH5-KEY
  6265             MOVE PI-COMPANY-CD  TO W-ARCH5-COMPANY-CD
  6266             MOVE PI-690-LAST-CARRIER
  6267                                 TO W-ARCH5-CARRIER
  6268             MOVE PI-690-LAST-GROUPING
  6269                                 TO W-ARCH5-GROUPING
  6270             MOVE PI-690-LAST-STATE
  6271                                 TO W-ARCH5-STATE
  6272             MOVE PI-690-LAST-ACCOUNT
  6273                                 TO W-ARCH5-ACCOUNT
  6274             MOVE PI-690-LAST-ARCHIVE-NO
  6275                                 TO W-ARCH5-ARCHIVE-NO.
  6276
  6277
  6278* EXEC CICS HANDLE CONDITION
  6279*        NOTFND  (8080-ARCH-NOT-FOUND)
  6280*        ENDFILE (8080-ARCH-NOT-FOUND)
  6281*        NOTOPEN (8030-ARCH5-NOT-OPEN)
  6282*        END-EXEC.
  6283*    MOVE '"$I''J                 ! + #00006074' TO DFHEIV0
  6284     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  6285     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6286     MOVE X'2B20233030303036303734' TO DFHEIV0(25:11)
  6287     CALL 'kxdfhei1' USING DFHEIV0
  6288     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6289
  6290
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 124
* EL690.cbl
  6291
  6292* EXEC CICS STARTBR
  6293*        DATASET  (W-ARCH5-FILE-ID)
  6294*        RIDFLD   (W-ARCH5-KEY)
  6295*        GTEQ
  6296*    END-EXEC.
  6297     MOVE 0
  6298       TO DFHEIV11
  6299*    MOVE '&,         G          &   #00006080' TO DFHEIV0
  6300     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6301     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6302     MOVE X'2020233030303036303830' TO DFHEIV0(25:11)
  6303     CALL 'kxdfhei1' USING DFHEIV0,
  6304           W-ARCH5-FILE-ID,
  6305           W-ARCH5-KEY,
  6306           DFHEIV99,
  6307           DFHEIV11,
  6308           DFHEIV99
  6309     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6310
  6311
  6312     PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT.
  6313
  6314
  6315* EXEC CICS HANDLE CONDITION
  6316*        NOTFND  (2400-END-BROWSE)
  6317*        ENDFILE (2400-END-BROWSE)
  6318*        END-EXEC.
  6319*    MOVE '"$I''                  ! , #00006088' TO DFHEIV0
  6320     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6321     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6322     MOVE X'2C20233030303036303838' TO DFHEIV0(25:11)
  6323     CALL 'kxdfhei1' USING DFHEIV0
  6324     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6325
  6326
  6327 2400-BUILD-ARCH5-LIST.
  6328
  6329     IF  LA-COMPANY-CD-A5 NOT EQUAL PI-COMPANY-CD
  6330         GO TO 2400-END-BROWSE.
  6331
  6332     IF  PI-690-INIT-CARRIER EQUAL LOW-VALUES OR HIGH-VALUES
  6333         GO TO 2400-CONTINUE.
  6334
  6335     IF  LA-CARRIER-A5 NOT EQUAL PI-690-INIT-CARRIER
  6336         GO TO 2400-END-BROWSE.
  6337
  6338     IF  PI-690-INIT-GROUPING EQUAL LOW-VALUES OR HIGH-VALUES
  6339         GO TO 2400-CONTINUE.
  6340
  6341     IF  LA-GROUPING-A5 NOT EQUAL PI-690-INIT-GROUPING
  6342         GO TO 2400-END-BROWSE.
  6343
  6344     IF  PI-690-INIT-STATE EQUAL LOW-VALUES OR HIGH-VALUES
  6345         GO TO 2400-CONTINUE.
  6346
  6347     IF  LA-STATE-A5 NOT EQUAL PI-690-INIT-STATE
  6348         GO TO 2400-END-BROWSE.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 125
* EL690.cbl
  6349
  6350     IF  PI-690-INIT-ACCOUNT EQUAL LOW-VALUES OR HIGH-VALUES
  6351         GO TO 2400-CONTINUE.
  6352
  6353     IF  LA-ACCOUNT-A5 NOT EQUAL PI-690-INIT-ACCOUNT
  6354         GO TO 2400-END-BROWSE.
  6355
  6356 2400-CONTINUE.
  6357
  6358     IF  NOT PI-690-SELECT-ALL
  6359             AND
  6360         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6361         PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6362         GO TO 2400-BUILD-ARCH5-LIST.
  6363
  6364     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  6365                 AND
  6366         PI-690-INIT-ENTRY LESS THAN HIGH-VALUES
  6367         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  6368             PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6369             GO TO 2400-BUILD-ARCH5-LIST.
  6370
  6371     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6372                 AND
  6373         PI-690-INIT-FORM LESS THAN HIGH-VALUES
  6374         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  6375             PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6376             GO TO 2400-BUILD-ARCH5-LIST.
  6377
  6378     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  6379                 AND
  6380         PI-690-INIT-PROCESSOR LESS THAN HIGH-VALUES
  6381         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  6382             PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6383             GO TO 2400-BUILD-ARCH5-LIST.
  6384
  6385     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6386
  6387     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6388
  6389     IF  W-ARCH-NDX LESS THAN +13
  6390         PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT
  6391         GO TO 2400-BUILD-ARCH5-LIST.
  6392
  6393 2400-END.
  6394
  6395     MOVE -1                     TO CORRSELL.
  6396     MOVE ZEROS                  TO CORRSELO.
  6397     PERFORM 2400-END-BROWSE.
  6398     GO TO 8100-SEND-INITIAL-MAP.
  6399
  6400 2400-END-BROWSE.
  6401
  6402
  6403* EXEC CICS ENDBR
  6404*        DATASET (W-ARCH5-FILE-ID)
  6405*    END-EXEC.
  6406     MOVE 0
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 126
* EL690.cbl
  6407       TO DFHEIV11
  6408*    MOVE '&2                    $   #00006168' TO DFHEIV0
  6409     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6410     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6411     MOVE X'2020233030303036313638' TO DFHEIV0(25:11)
  6412     CALL 'kxdfhei1' USING DFHEIV0,
  6413           W-ARCH5-FILE-ID,
  6414           DFHEIV11,
  6415           DFHEIV99
  6416     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6417
  6418
  6419 2400-ARCH5-NOT-FOUND.
  6420
  6421     MOVE ER-0130                TO EMI-ERROR.
  6422     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6423     MOVE -1                     TO CORRSELL.
  6424     MOVE ZEROS                  TO CORRSELO.
  6425     GO TO 8100-SEND-INITIAL-MAP.
  6426
  6427 2400-EXIT.
  6428     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 127
* EL690.cbl
  6430 2500-ARCH6-PROCESS.
  6431
  6432     IF  W-CHANGE-REQUESTED
  6433         MOVE LOW-VALUES         TO W-ARCH6-KEY
  6434         MOVE PI-COMPANY-CD      TO W-ARCH6-COMPANY-CD
  6435         MOVE PI-690-INIT-ENTRY  TO W-ARCH6-ENTRY
  6436         MOVE PI-690-INIT-ARCHIVE-NO
  6437                                 TO W-ARCH6-ARCHIVE-NO
  6438
  6439     ELSE
  6440         IF  W-FIRST-CHANGE-FOUND
  6441             MOVE LOW-VALUES     TO W-ARCH6-KEY
  6442             MOVE PI-COMPANY-CD  TO W-ARCH6-COMPANY-CD
  6443             MOVE PI-690-FIRST-ENTRY
  6444                                 TO W-ARCH6-ENTRY
  6445             MOVE PI-690-FIRST-ARCHIVE-NO
  6446                                 TO W-ARCH6-ARCHIVE-NO
  6447
  6448         ELSE
  6449             MOVE LOW-VALUES     TO W-ARCH6-KEY
  6450             MOVE PI-COMPANY-CD  TO W-ARCH6-COMPANY-CD
  6451             MOVE PI-690-LAST-ENTRY
  6452                                 TO W-ARCH6-ENTRY
  6453             MOVE PI-690-LAST-ARCHIVE-NO
  6454                                 TO W-ARCH6-ARCHIVE-NO.
  6455
  6456
  6457* EXEC CICS HANDLE CONDITION
  6458*        NOTFND  (8080-ARCH-NOT-FOUND)
  6459*        ENDFILE (8080-ARCH-NOT-FOUND)
  6460*        NOTOPEN (8040-ARCH6-NOT-OPEN)
  6461*        END-EXEC.
  6462*    MOVE '"$I''J                 ! - #00006209' TO DFHEIV0
  6463     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  6464     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6465     MOVE X'2D20233030303036323039' TO DFHEIV0(25:11)
  6466     CALL 'kxdfhei1' USING DFHEIV0
  6467     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6468
  6469
  6470
  6471* EXEC CICS STARTBR
  6472*        DATASET  (W-ARCH6-FILE-ID)
  6473*        RIDFLD   (W-ARCH6-KEY)
  6474*        GTEQ
  6475*    END-EXEC.
  6476     MOVE 0
  6477       TO DFHEIV11
  6478*    MOVE '&,         G          &   #00006215' TO DFHEIV0
  6479     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6480     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6481     MOVE X'2020233030303036323135' TO DFHEIV0(25:11)
  6482     CALL 'kxdfhei1' USING DFHEIV0,
  6483           W-ARCH6-FILE-ID,
  6484           W-ARCH6-KEY,
  6485           DFHEIV99,
  6486           DFHEIV11,
  6487           DFHEIV99
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 128
* EL690.cbl
  6488     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6489
  6490
  6491     PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT.
  6492
  6493
  6494* EXEC CICS HANDLE CONDITION
  6495*        NOTFND  (2500-END-BROWSE)
  6496*        ENDFILE (2500-END-BROWSE)
  6497*        END-EXEC.
  6498*    MOVE '"$I''                  ! . #00006223' TO DFHEIV0
  6499     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6500     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6501     MOVE X'2E20233030303036323233' TO DFHEIV0(25:11)
  6502     CALL 'kxdfhei1' USING DFHEIV0
  6503     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6504
  6505
  6506 2500-BUILD-ARCH6-LIST.
  6507
  6508     IF  LA-COMPANY-CD-A6 NOT EQUAL PI-COMPANY-CD
  6509         GO TO 2500-END-BROWSE.
  6510
  6511     IF  PI-690-INIT-ENTRY EQUAL LOW-VALUES OR HIGH-VALUES
  6512         GO TO 2500-CONTINUE.
  6513
  6514     IF  LA-ENTRY-A6 NOT EQUAL PI-690-INIT-ENTRY
  6515         GO TO 2500-END-BROWSE.
  6516
  6517 2500-CONTINUE.
  6518
  6519     IF  NOT PI-690-SELECT-ALL
  6520             AND
  6521         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6522         PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6523         GO TO 2500-BUILD-ARCH6-LIST.
  6524
  6525     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  6526             AND
  6527         PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  6528         IF  LA-ENTRY-A6 NOT EQUAL PI-690-INIT-PROCESSOR
  6529             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6530             GO TO 2500-BUILD-ARCH6-LIST.
  6531
  6532     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6533             AND
  6534         PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  6535         IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  6536             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6537             GO TO 2500-BUILD-ARCH6-LIST.
  6538
  6539     IF  PI-690-INIT-CARRIER NOT EQUAL LOW-VALUES
  6540             AND
  6541         PI-690-INIT-CARRIER NOT EQUAL HIGH-VALUES
  6542         IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  6543             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6544             GO TO 2500-BUILD-ARCH6-LIST.
  6545
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 129
* EL690.cbl
  6546     IF  PI-690-INIT-GROUPING NOT EQUAL LOW-VALUES
  6547             AND
  6548         PI-690-INIT-GROUPING NOT EQUAL HIGH-VALUES
  6549         IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  6550             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6551             GO TO 2500-BUILD-ARCH6-LIST.
  6552
  6553     IF  PI-690-INIT-STATE NOT EQUAL LOW-VALUES
  6554             AND
  6555         PI-690-INIT-STATE NOT EQUAL HIGH-VALUES
  6556         IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  6557             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6558             GO TO 2500-BUILD-ARCH6-LIST.
  6559
  6560     IF  PI-690-INIT-ACCOUNT NOT EQUAL LOW-VALUES
  6561             AND
  6562         PI-690-INIT-ACCOUNT NOT EQUAL HIGH-VALUES
  6563         IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  6564             PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6565             GO TO 2500-BUILD-ARCH6-LIST.
  6566
  6567     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6568
  6569     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6570
  6571     IF  W-ARCH-NDX LESS THAN +13
  6572         PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT
  6573         GO TO 2500-BUILD-ARCH6-LIST.
  6574
  6575 2500-END.
  6576
  6577     MOVE -1                     TO CORRSELL.
  6578     MOVE ZEROS                  TO CORRSELO.
  6579     PERFORM 2500-END-BROWSE.
  6580     GO TO 8100-SEND-INITIAL-MAP.
  6581
  6582 2500-END-BROWSE.
  6583
  6584
  6585* EXEC CICS ENDBR
  6586*        DATASET (W-ARCH6-FILE-ID)
  6587*    END-EXEC.
  6588     MOVE 0
  6589       TO DFHEIV11
  6590*    MOVE '&2                    $   #00006306' TO DFHEIV0
  6591     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6592     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6593     MOVE X'2020233030303036333036' TO DFHEIV0(25:11)
  6594     CALL 'kxdfhei1' USING DFHEIV0,
  6595           W-ARCH6-FILE-ID,
  6596           DFHEIV11,
  6597           DFHEIV99
  6598     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6599
  6600
  6601 2500-ARCH6-NOT-FOUND.
  6602
  6603     MOVE ER-0130                TO EMI-ERROR.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 130
* EL690.cbl
  6604     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6605     MOVE -1                     TO CORRSELL.
  6606     MOVE ZEROS                  TO CORRSELO.
  6607     GO TO 8100-SEND-INITIAL-MAP.
  6608
  6609 2500-EXIT.
  6610     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 131
* EL690.cbl
  6612 2600-ARCH-PROCESS.
  6613
  6614     IF  W-CHANGE-REQUESTED
  6615         MOVE LOW-VALUES         TO W-ARCH-KEY
  6616         MOVE PI-COMPANY-CD      TO W-ARCH-COMPANY-CD
  6617         MOVE PI-690-INIT-ARCHIVE-NO
  6618                                 TO W-ARCH-ARCHIVE-NO
  6619
  6620     ELSE
  6621         IF  W-FIRST-CHANGE-FOUND
  6622             MOVE LOW-VALUES     TO W-ARCH-KEY
  6623             MOVE PI-COMPANY-CD  TO W-ARCH-COMPANY-CD
  6624             MOVE PI-690-FIRST-ARCHIVE-NO
  6625                                 TO W-ARCH-ARCHIVE-NO
  6626
  6627         ELSE
  6628             MOVE LOW-VALUES     TO W-ARCH-KEY
  6629             MOVE PI-COMPANY-CD  TO W-ARCH-COMPANY-CD
  6630             MOVE PI-690-LAST-ARCHIVE-NO
  6631                                 TO W-ARCH-ARCHIVE-NO.
  6632
  6633
  6634* EXEC CICS HANDLE CONDITION
  6635*        NOTFND  (8080-ARCH-NOT-FOUND)
  6636*        ENDFILE (8080-ARCH-NOT-FOUND)
  6637*        NOTOPEN (8050-ARCH-NOT-OPEN)
  6638*        END-EXEC.
  6639*    MOVE '"$I''J                 ! / #00006342' TO DFHEIV0
  6640     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  6641     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6642     MOVE X'2F20233030303036333432' TO DFHEIV0(25:11)
  6643     CALL 'kxdfhei1' USING DFHEIV0
  6644     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6645
  6646
  6647
  6648* EXEC CICS STARTBR
  6649*        DATASET  (W-ARCH-FILE-ID)
  6650*        RIDFLD   (W-ARCH-KEY)
  6651*        GTEQ
  6652*    END-EXEC.
  6653     MOVE 0
  6654       TO DFHEIV11
  6655*    MOVE '&,         G          &   #00006348' TO DFHEIV0
  6656     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6657     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6658     MOVE X'2020233030303036333438' TO DFHEIV0(25:11)
  6659     CALL 'kxdfhei1' USING DFHEIV0,
  6660           W-ARCH-FILE-ID,
  6661           W-ARCH-KEY,
  6662           DFHEIV99,
  6663           DFHEIV11,
  6664           DFHEIV99
  6665     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6666
  6667
  6668     PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT.
  6669
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 132
* EL690.cbl
  6670
  6671* EXEC CICS HANDLE CONDITION
  6672*        NOTFND  (2600-END-BROWSE)
  6673*        ENDFILE (2600-END-BROWSE)
  6674*        END-EXEC.
  6675*    MOVE '"$I''                  ! 0 #00006356' TO DFHEIV0
  6676     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6677     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6678     MOVE X'3020233030303036333536' TO DFHEIV0(25:11)
  6679     CALL 'kxdfhei1' USING DFHEIV0
  6680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6681
  6682
  6683 2600-BUILD-ARCH-LIST.
  6684
  6685     IF  LA-COMPANY-CD NOT EQUAL PI-COMPANY-CD
  6686         GO TO 2600-END-BROWSE.
  6687
  6688     IF  PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  6689             AND
  6690         PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  6691         IF  LA-PROCESSOR-CD NOT EQUAL PI-690-INIT-PROCESSOR
  6692             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6693             GO TO 2600-BUILD-ARCH-LIST.
  6694
  6695     IF  PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6696             AND
  6697         PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  6698         IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  6699             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6700             GO TO 2600-BUILD-ARCH-LIST.
  6701
  6702     IF  PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  6703             AND
  6704         PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  6705         IF  LA-ENTRY-A6 NOT EQUAL PI-690-INIT-ENTRY
  6706             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6707             GO TO 2600-BUILD-ARCH-LIST.
  6708
  6709     IF  PI-690-INIT-CARRIER NOT EQUAL LOW-VALUES
  6710             AND
  6711         PI-690-INIT-CARRIER NOT EQUAL HIGH-VALUES
  6712         IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  6713             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6714             GO TO 2600-BUILD-ARCH-LIST.
  6715
  6716     IF  PI-690-INIT-GROUPING NOT EQUAL LOW-VALUES
  6717             AND
  6718         PI-690-INIT-GROUPING NOT EQUAL HIGH-VALUES
  6719         IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  6720             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6721             GO TO 2600-BUILD-ARCH-LIST.
  6722
  6723     IF  PI-690-INIT-STATE NOT EQUAL LOW-VALUES
  6724             AND
  6725         PI-690-INIT-STATE NOT EQUAL HIGH-VALUES
  6726         IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  6727             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 133
* EL690.cbl
  6728             GO TO 2600-BUILD-ARCH-LIST.
  6729
  6730     IF  PI-690-INIT-ACCOUNT NOT EQUAL LOW-VALUES
  6731             AND
  6732         PI-690-INIT-ACCOUNT NOT EQUAL HIGH-VALUES
  6733         IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  6734             PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6735             GO TO 2600-BUILD-ARCH-LIST.
  6736
  6737 2600-CONTINUE.
  6738
  6739     IF  NOT PI-690-SELECT-ALL
  6740             AND
  6741         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6742         PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6743         GO TO 2600-BUILD-ARCH-LIST.
  6744
  6745     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6746
  6747     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6748
  6749     IF  W-ARCH-NDX LESS THAN +13
  6750         PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT
  6751         GO TO 2600-BUILD-ARCH-LIST.
  6752
  6753 2600-END.
  6754
  6755     MOVE -1                     TO CORRSELL.
  6756     MOVE ZEROS                  TO CORRSELO.
  6757     PERFORM 2600-END-BROWSE.
  6758     GO TO 8100-SEND-INITIAL-MAP.
  6759
  6760 2600-END-BROWSE.
  6761
  6762
  6763* EXEC CICS ENDBR
  6764*        DATASET (W-ARCH-FILE-ID)
  6765*    END-EXEC.
  6766     MOVE 0
  6767       TO DFHEIV11
  6768*    MOVE '&2                    $   #00006440' TO DFHEIV0
  6769     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  6770     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  6771     MOVE X'2020233030303036343430' TO DFHEIV0(25:11)
  6772     CALL 'kxdfhei1' USING DFHEIV0,
  6773           W-ARCH-FILE-ID,
  6774           DFHEIV11,
  6775           DFHEIV99
  6776     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6777
  6778
  6779 2600-ARCH-NOT-FOUND.
  6780
  6781     MOVE ER-0130                TO EMI-ERROR.
  6782     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6783     MOVE -1                     TO CORRSELL.
  6784     MOVE ZEROS                  TO CORRSELO.
  6785     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 134
* EL690.cbl
  6786
  6787 2600-EXIT.
  6788     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 135
* EL690.cbl
  6790 3000-PAGE-BACKWARD.
  6791
  6792     MOVE '2'                    TO PI-690-LAST-BROWSE-IND.
  6793     MOVE +1                     TO W-ARCH-NDX
  6794                                    W-ARCH-NDX2.
  6795     MOVE ZEROS                  TO W-ARCH-NUMBER.
  6796
  6797     GO TO 3100-ARCH2-PROCESS
  6798           3200-ARCH3-PROCESS
  6799           3300-ARCH4-PROCESS
  6800           3400-ARCH5-PROCESS
  6801           3500-ARCH6-PROCESS
  6802           3600-ARCH-PROCESS DEPENDING ON PI-690-BRWS-TYPE-IND.
  6803
  6804     MOVE ER-7384                TO EMI-ERROR.
  6805     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  6806     MOVE -1                     TO TYPEBRL.
  6807     MOVE AL-UABON               TO TYPEBRA.
  6808     GO TO 8100-SEND-INITIAL-MAP.
  6809
  6810 3000-EXIT.
  6811     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 136
* EL690.cbl
  6813 3100-ARCH2-PROCESS.
  6814
  6815     IF  W-CHANGE-REQUESTED
  6816         MOVE HIGH-VALUES        TO W-ARCH2-KEY
  6817         MOVE PI-COMPANY-CD      TO W-ARCH2-COMPANY-CD
  6818         MOVE PI-690-INIT-CERT-PRIME
  6819                                 TO W-ARCH2-CERT-PRIME
  6820         MOVE PI-690-INIT-SUFFIX TO W-ARCH2-SUFFIX
  6821         MOVE PI-690-INIT-CARRIER
  6822                                 TO W-ARCH2-CARRIER
  6823         MOVE PI-690-INIT-GROUPING
  6824                                 TO W-ARCH2-GROUPING
  6825         MOVE PI-690-INIT-STATE  TO W-ARCH2-STATE
  6826         MOVE PI-690-INIT-ACCOUNT
  6827                                 TO W-ARCH2-ACCOUNT
  6828         MOVE PI-690-INIT-EFFECT-DATE
  6829                                 TO W-ARCH2-EFF-DTE
  6830
  6831
  6832     ELSE
  6833         IF  W-FIRST-CHANGE-FOUND
  6834             MOVE HIGH-VALUES    TO W-ARCH2-KEY
  6835             MOVE PI-COMPANY-CD  TO W-ARCH2-COMPANY-CD
  6836             MOVE PI-690-LAST-CERT-PRIME
  6837                                 TO W-ARCH2-CERT-PRIME
  6838             MOVE PI-690-LAST-SUFFIX
  6839                                 TO W-ARCH2-SUFFIX
  6840             MOVE PI-690-LAST-CARRIER
  6841                                 TO W-ARCH2-CARRIER
  6842             MOVE PI-690-LAST-GROUPING
  6843                                 TO W-ARCH2-GROUPING
  6844             MOVE PI-690-LAST-STATE
  6845                                 TO W-ARCH2-STATE
  6846             MOVE PI-690-LAST-ACCOUNT
  6847                                 TO W-ARCH2-ACCOUNT
  6848             MOVE PI-690-LAST-EFFECT-DATE
  6849                                 TO W-ARCH2-EFF-DTE
  6850
  6851         ELSE
  6852             MOVE PI-COMPANY-CD  TO W-ARCH2-COMPANY-CD
  6853             MOVE PI-690-FIRST-CERT-PRIME
  6854                                 TO W-ARCH2-CERT-PRIME
  6855             MOVE PI-690-FIRST-SUFFIX
  6856                                 TO W-ARCH2-SUFFIX
  6857             MOVE PI-690-FIRST-CARRIER
  6858                                 TO W-ARCH2-CARRIER
  6859             MOVE PI-690-FIRST-GROUPING
  6860                                 TO W-ARCH2-GROUPING
  6861             MOVE PI-690-FIRST-STATE
  6862                                 TO W-ARCH2-STATE
  6863             MOVE PI-690-FIRST-ACCOUNT
  6864                                 TO W-ARCH2-ACCOUNT
  6865             MOVE PI-690-FIRST-EFFECT-DATE
  6866                                 TO W-ARCH2-EFF-DTE
  6867             MOVE PI-690-FIRST-ARCHIVE-NO
  6868                                 TO W-ARCH2-ARCHIVE-NO.
  6869
  6870
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 137
* EL690.cbl
  6871* EXEC CICS HANDLE CONDITION
  6872*        NOTFND  (8080-ARCH-NOT-FOUND)
  6873*        ENDFILE (8080-ARCH-NOT-FOUND)
  6874*        NOTOPEN (8000-ARCH2-NOT-OPEN)
  6875*        END-EXEC.
  6876*    MOVE '"$I''J                 ! 1 #00006535' TO DFHEIV0
  6877     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  6878     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6879     MOVE X'3120233030303036353335' TO DFHEIV0(25:11)
  6880     CALL 'kxdfhei1' USING DFHEIV0
  6881     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6882
  6883
  6884
  6885* EXEC CICS STARTBR
  6886*        DATASET  (W-ARCH2-FILE-ID)
  6887*        RIDFLD   (W-ARCH2-KEY)
  6888*        GTEQ
  6889*        END-EXEC.
  6890     MOVE 0
  6891       TO DFHEIV11
  6892*    MOVE '&,         G          &   #00006541' TO DFHEIV0
  6893     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  6894     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  6895     MOVE X'2020233030303036353431' TO DFHEIV0(25:11)
  6896     CALL 'kxdfhei1' USING DFHEIV0,
  6897           W-ARCH2-FILE-ID,
  6898           W-ARCH2-KEY,
  6899           DFHEIV99,
  6900           DFHEIV11,
  6901           DFHEIV99
  6902     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6903
  6904
  6905
  6906* EXEC CICS HANDLE CONDITION
  6907*        NOTFND  (3100-END-BROWSE)
  6908*        ENDFILE (3100-END-BROWSE)
  6909*        END-EXEC.
  6910*    MOVE '"$I''                  ! 2 #00006547' TO DFHEIV0
  6911     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  6912     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  6913     MOVE X'3220233030303036353437' TO DFHEIV0(25:11)
  6914     CALL 'kxdfhei1' USING DFHEIV0
  6915     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  6916
  6917
  6918     PERFORM 7000-READ-ARCH2-FILE-NEXT THRU 7000-EXIT.
  6919
  6920     IF  W-CHANGE-REQUESTED
  6921             OR
  6922         W-READ-PREV-TWICE
  6923         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  6924         PERFORM 7050-READ-PREV-ARCH2 THRU 7050-EXIT.
  6925
  6926 3100-BUILD-ARCH2-LIST-BACKWARD.
  6927
  6928     PERFORM 7050-READ-PREV-ARCH2 THRU 7050-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 138
* EL690.cbl
  6929
  6930     IF  LA-COMPANY-CD-A2 NOT EQUAL PI-COMPANY-CD
  6931         GO TO 3100-END.
  6932
  6933     IF  PI-690-INIT-CERT-NO EQUAL HIGH-VALUES OR LOW-VALUES
  6934         GO TO 3100-CONTINUE.
  6935
  6936     IF  LA-CERT-NO-A2 NOT EQUAL PI-690-INIT-CERT-NO
  6937         GO TO 3100-END-BROWSE.
  6938
  6939     IF  PI-690-INIT-CARRIER EQUAL HIGH-VALUES OR LOW-VALUES
  6940         GO TO 3100-CONTINUE.
  6941
  6942     IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  6943         GO TO 3100-END-BROWSE.
  6944
  6945     IF  PI-690-INIT-GROUPING EQUAL HIGH-VALUES OR LOW-VALUES
  6946         GO TO 3100-CONTINUE.
  6947
  6948     IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  6949         GO TO 3100-END-BROWSE.
  6950
  6951     IF  PI-690-INIT-STATE EQUAL HIGH-VALUES OR LOW-VALUES
  6952         GO TO 3100-CONTINUE.
  6953
  6954     IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  6955         GO TO 3100-END-BROWSE.
  6956
  6957     IF  PI-690-INIT-ACCOUNT EQUAL HIGH-VALUES OR LOW-VALUES
  6958         GO TO 3100-CONTINUE.
  6959
  6960     IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  6961         GO TO 3100-END-BROWSE.
  6962
  6963     IF  PI-690-INIT-EFFECT-DATE = LOW-VALUES OR HIGH-VALUES
  6964         GO TO 3100-CONTINUE.
  6965
  6966     IF  LA-EFFECT-DATE-A2 NOT EQUAL PI-690-INIT-EFFECT-DATE
  6967         GO TO 3100-END-BROWSE.
  6968
  6969 3100-CONTINUE.
  6970
  6971     IF  NOT PI-690-SELECT-ALL
  6972             AND
  6973         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  6974         GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
  6975
  6976     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  6977             AND
  6978         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  6979         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  6980             GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
  6981
  6982     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  6983             AND
  6984         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  6985         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  6986             GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 139
* EL690.cbl
  6987
  6988     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  6989             AND
  6990         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  6991         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  6992             GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
  6993
  6994     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  6995
  6996     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  6997
  6998     IF  W-ARCH-NDX LESS THAN +13
  6999         GO TO 3100-BUILD-ARCH2-LIST-BACKWARD.
  7000
  7001 3100-END.
  7002
  7003     MOVE -1                     TO CORRSELL.
  7004     MOVE ZEROS                  TO CORRSELO.
  7005     PERFORM 3100-END-BROWSE
  7006     GO TO 8100-SEND-INITIAL-MAP.
  7007
  7008 3100-END-BROWSE.
  7009
  7010     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  7011     SUBTRACT +1 FROM W-ARCH-NDX3.
  7012
  7013     IF  W-ARCH-NDX3 GREATER THAN +1
  7014         MOVE +1 TO W-ARCH-NDX2
  7015         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7016                 UNTIL
  7017             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7018
  7019
  7020* EXEC CICS ENDBR
  7021*        DATASET (W-ARCH2-FILE-ID)
  7022*    END-EXEC.
  7023     MOVE 0
  7024       TO DFHEIV11
  7025*    MOVE '&2                    $   #00006653' TO DFHEIV0
  7026     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7027     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7028     MOVE X'2020233030303036363533' TO DFHEIV0(25:11)
  7029     CALL 'kxdfhei1' USING DFHEIV0,
  7030           W-ARCH2-FILE-ID,
  7031           DFHEIV11,
  7032           DFHEIV99
  7033     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7034
  7035
  7036 3100-FRONT-OF-FILE.
  7037
  7038     MOVE ER-0131                TO EMI-ERROR.
  7039     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7040     MOVE -1                     TO CORRSELL.
  7041     MOVE ZEROS                  TO CORRSELO.
  7042     GO TO 8100-SEND-INITIAL-MAP.
  7043
  7044 3100-EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 140
* EL690.cbl
  7045     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 141
* EL690.cbl
  7047 3200-ARCH3-PROCESS.
  7048
  7049     IF  W-CHANGE-REQUESTED
  7050         MOVE HIGH-VALUES        TO W-ARCH3-KEY
  7051         MOVE PI-COMPANY-CD      TO W-ARCH3-COMPANY-CD
  7052         MOVE PI-690-INIT-FORM   TO W-ARCH3-FORM
  7053         MOVE PI-690-INIT-CARRIER
  7054                                 TO W-ARCH3-CARRIER
  7055         MOVE PI-690-INIT-GROUPING
  7056                                 TO W-ARCH3-GROUPING
  7057         MOVE PI-690-INIT-STATE  TO W-ARCH3-STATE
  7058         MOVE PI-690-INIT-ACCOUNT
  7059                                 TO W-ARCH3-ACCOUNT
  7060
  7061     ELSE
  7062         IF  W-FIRST-CHANGE-FOUND
  7063             MOVE HIGH-VALUES    TO W-ARCH3-KEY
  7064             MOVE PI-COMPANY-CD  TO W-ARCH3-COMPANY-CD
  7065             MOVE PI-690-LAST-FORM
  7066                                 TO W-ARCH3-FORM
  7067             MOVE PI-690-LAST-CARRIER
  7068                                 TO W-ARCH3-CARRIER
  7069             MOVE PI-690-LAST-GROUPING
  7070                                 TO W-ARCH3-GROUPING
  7071             MOVE PI-690-LAST-STATE
  7072                                 TO W-ARCH3-STATE
  7073             MOVE PI-690-LAST-ACCOUNT
  7074                                 TO W-ARCH3-ACCOUNT
  7075
  7076         ELSE
  7077             MOVE PI-COMPANY-CD  TO W-ARCH3-COMPANY-CD
  7078             MOVE PI-690-FIRST-FORM
  7079                                 TO W-ARCH3-FORM
  7080             MOVE PI-690-FIRST-CARRIER
  7081                                 TO W-ARCH3-CARRIER
  7082             MOVE PI-690-FIRST-GROUPING
  7083                                 TO W-ARCH3-GROUPING
  7084             MOVE PI-690-FIRST-STATE
  7085                                 TO W-ARCH3-STATE
  7086             MOVE PI-690-FIRST-ACCOUNT
  7087                                 TO W-ARCH3-ACCOUNT
  7088             MOVE PI-690-FIRST-ARCHIVE-NO
  7089                                 TO W-ARCH3-ARCHIVE-NO.
  7090
  7091
  7092* EXEC CICS HANDLE CONDITION
  7093*        NOTFND  (8080-ARCH-NOT-FOUND)
  7094*        ENDFILE (8080-ARCH-NOT-FOUND)
  7095*        NOTOPEN (8010-ARCH3-NOT-OPEN)
  7096*        END-EXEC.
  7097*    MOVE '"$I''J                 ! 3 #00006712' TO DFHEIV0
  7098     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7099     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7100     MOVE X'3320233030303036373132' TO DFHEIV0(25:11)
  7101     CALL 'kxdfhei1' USING DFHEIV0
  7102     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7103
  7104
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 142
* EL690.cbl
  7105
  7106* EXEC CICS STARTBR
  7107*        DATASET  (W-ARCH3-FILE-ID)
  7108*        RIDFLD   (W-ARCH3-KEY)
  7109*        GTEQ
  7110*        END-EXEC.
  7111     MOVE 0
  7112       TO DFHEIV11
  7113*    MOVE '&,         G          &   #00006718' TO DFHEIV0
  7114     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7115     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7116     MOVE X'2020233030303036373138' TO DFHEIV0(25:11)
  7117     CALL 'kxdfhei1' USING DFHEIV0,
  7118           W-ARCH3-FILE-ID,
  7119           W-ARCH3-KEY,
  7120           DFHEIV99,
  7121           DFHEIV11,
  7122           DFHEIV99
  7123     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7124
  7125
  7126
  7127* EXEC CICS HANDLE CONDITION
  7128*        NOTFND  (3200-END-BROWSE)
  7129*        ENDFILE (3200-END-BROWSE)
  7130*        END-EXEC.
  7131*    MOVE '"$I''                  ! 4 #00006724' TO DFHEIV0
  7132     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7133     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7134     MOVE X'3420233030303036373234' TO DFHEIV0(25:11)
  7135     CALL 'kxdfhei1' USING DFHEIV0
  7136     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7137
  7138
  7139     PERFORM 7100-READ-ARCH3-FILE-NEXT THRU 7100-EXIT.
  7140
  7141     IF  W-CHANGE-REQUESTED
  7142             OR
  7143         W-READ-PREV-TWICE
  7144         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7145         PERFORM 7150-READ-PREV-ARCH3 THRU 7150-EXIT.
  7146
  7147 3200-BUILD-ARCH3-LIST-BACKWARD.
  7148
  7149     PERFORM 7150-READ-PREV-ARCH3 THRU 7150-EXIT.
  7150
  7151     IF  LA-COMPANY-CD-A3 NOT EQUAL PI-COMPANY-CD
  7152         GO TO 3200-END.
  7153
  7154     IF  PI-690-INIT-FORM EQUAL HIGH-VALUES OR LOW-VALUES
  7155         GO TO 3200-CONTINUE.
  7156
  7157     IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  7158         GO TO 3200-END-BROWSE.
  7159
  7160     IF  PI-690-INIT-CARRIER EQUAL HIGH-VALUES OR LOW-VALUES
  7161         GO TO 3200-CONTINUE.
  7162
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 143
* EL690.cbl
  7163     IF  LA-CARRIER-A3 NOT EQUAL PI-690-INIT-CARRIER
  7164         GO TO 3200-END-BROWSE.
  7165
  7166     IF  PI-690-INIT-GROUPING EQUAL HIGH-VALUES OR LOW-VALUES
  7167         GO TO 3200-CONTINUE.
  7168
  7169     IF  LA-GROUPING-A3 NOT EQUAL PI-690-INIT-GROUPING
  7170         GO TO 3200-END-BROWSE.
  7171
  7172     IF  PI-690-INIT-STATE EQUAL HIGH-VALUES OR LOW-VALUES
  7173         GO TO 3200-CONTINUE.
  7174
  7175     IF  LA-STATE-A3 NOT EQUAL PI-690-INIT-STATE
  7176         GO TO 3200-END-BROWSE.
  7177
  7178     IF  PI-690-INIT-ACCOUNT EQUAL HIGH-VALUES OR LOW-VALUES
  7179         GO TO 3200-CONTINUE.
  7180
  7181     IF  LA-ACCOUNT-A3 NOT EQUAL PI-690-INIT-ACCOUNT
  7182         GO TO 3200-END-BROWSE.
  7183
  7184 3200-CONTINUE.
  7185
  7186     IF  NOT PI-690-SELECT-ALL
  7187             AND
  7188         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7189         GO TO 3200-BUILD-ARCH3-LIST-BACKWARD.
  7190
  7191     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  7192             AND
  7193         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  7194         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  7195             GO TO 3200-BUILD-ARCH3-LIST-BACKWARD.
  7196
  7197     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  7198             AND
  7199         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  7200         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  7201             GO TO 3200-BUILD-ARCH3-LIST-BACKWARD.
  7202
  7203     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7204
  7205     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7206
  7207     IF  W-ARCH-NDX LESS THAN +13
  7208         GO TO 3200-BUILD-ARCH3-LIST-BACKWARD.
  7209
  7210 3200-END.
  7211
  7212     MOVE -1                     TO CORRSELL.
  7213     MOVE ZEROS                  TO CORRSELO.
  7214     PERFORM 3200-END-BROWSE.
  7215     GO TO 8100-SEND-INITIAL-MAP.
  7216
  7217 3200-END-BROWSE.
  7218
  7219     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  7220     SUBTRACT +1 FROM W-ARCH-NDX3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 144
* EL690.cbl
  7221
  7222     IF  W-ARCH-NDX3 GREATER THAN +1
  7223         MOVE +1 TO W-ARCH-NDX2
  7224         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7225                 UNTIL
  7226             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7227
  7228
  7229* EXEC CICS ENDBR
  7230*        DATASET (W-ARCH3-FILE-ID)
  7231*    END-EXEC.
  7232     MOVE 0
  7233       TO DFHEIV11
  7234*    MOVE '&2                    $   #00006818' TO DFHEIV0
  7235     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7236     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7237     MOVE X'2020233030303036383138' TO DFHEIV0(25:11)
  7238     CALL 'kxdfhei1' USING DFHEIV0,
  7239           W-ARCH3-FILE-ID,
  7240           DFHEIV11,
  7241           DFHEIV99
  7242     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7243
  7244
  7245 3200-FRONT-OF-FILE.
  7246
  7247     MOVE ER-0131                TO EMI-ERROR.
  7248     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7249     MOVE -1                     TO CORRSELL.
  7250     MOVE ZEROS                  TO CORRSELO.
  7251     GO TO 8100-SEND-INITIAL-MAP.
  7252
  7253 3200-EXIT.
  7254     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 145
* EL690.cbl
  7256 3300-ARCH4-PROCESS.
  7257
  7258     IF  W-CHANGE-REQUESTED
  7259         MOVE HIGH-VALUES        TO W-ARCH4-KEY
  7260         MOVE PI-COMPANY-CD      TO W-ARCH4-COMPANY-CD
  7261         MOVE PI-690-INIT-PROCESSOR
  7262                                 TO W-ARCH4-PROCESSOR
  7263         MOVE PI-690-INIT-CARRIER
  7264                                 TO W-ARCH4-CARRIER
  7265         MOVE PI-690-INIT-GROUPING
  7266                                 TO W-ARCH4-GROUPING
  7267         MOVE PI-690-INIT-STATE  TO W-ARCH4-STATE
  7268         MOVE PI-690-INIT-ACCOUNT
  7269                                 TO W-ARCH4-ACCOUNT
  7270
  7271     ELSE
  7272         IF  W-FIRST-CHANGE-FOUND
  7273             MOVE HIGH-VALUES    TO W-ARCH4-KEY
  7274             MOVE PI-COMPANY-CD  TO W-ARCH4-COMPANY-CD
  7275             MOVE PI-690-LAST-PROCESSOR
  7276                                 TO W-ARCH4-PROCESSOR
  7277             MOVE PI-690-LAST-CARRIER
  7278                                 TO W-ARCH4-CARRIER
  7279             MOVE PI-690-LAST-GROUPING
  7280                                 TO W-ARCH4-GROUPING
  7281             MOVE PI-690-LAST-STATE
  7282                                 TO W-ARCH4-STATE
  7283             MOVE PI-690-LAST-ACCOUNT
  7284                                 TO W-ARCH4-ACCOUNT
  7285
  7286         ELSE
  7287             MOVE PI-COMPANY-CD  TO W-ARCH4-COMPANY-CD
  7288             MOVE PI-690-FIRST-PROCESSOR
  7289                                 TO W-ARCH4-PROCESSOR
  7290             MOVE PI-690-FIRST-CARRIER
  7291                                 TO W-ARCH4-CARRIER
  7292             MOVE PI-690-FIRST-GROUPING
  7293                                 TO W-ARCH4-GROUPING
  7294             MOVE PI-690-FIRST-STATE
  7295                                 TO W-ARCH4-STATE
  7296             MOVE PI-690-FIRST-ACCOUNT
  7297                                 TO W-ARCH4-ACCOUNT
  7298             MOVE PI-690-FIRST-ARCHIVE-NO
  7299                                 TO W-ARCH4-ARCHIVE-NO.
  7300
  7301
  7302* EXEC CICS HANDLE CONDITION
  7303*        NOTFND  (8080-ARCH-NOT-FOUND)
  7304*        ENDFILE (8080-ARCH-NOT-FOUND)
  7305*        NOTOPEN (8020-ARCH4-NOT-OPEN)
  7306*        END-EXEC.
  7307*    MOVE '"$I''J                 ! 5 #00006878' TO DFHEIV0
  7308     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7309     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7310     MOVE X'3520233030303036383738' TO DFHEIV0(25:11)
  7311     CALL 'kxdfhei1' USING DFHEIV0
  7312     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7313
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 146
* EL690.cbl
  7314
  7315
  7316* EXEC CICS STARTBR
  7317*        DATASET  (W-ARCH4-FILE-ID)
  7318*        RIDFLD   (W-ARCH4-KEY)
  7319*        GTEQ
  7320*        END-EXEC.
  7321     MOVE 0
  7322       TO DFHEIV11
  7323*    MOVE '&,         G          &   #00006884' TO DFHEIV0
  7324     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7325     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7326     MOVE X'2020233030303036383834' TO DFHEIV0(25:11)
  7327     CALL 'kxdfhei1' USING DFHEIV0,
  7328           W-ARCH4-FILE-ID,
  7329           W-ARCH4-KEY,
  7330           DFHEIV99,
  7331           DFHEIV11,
  7332           DFHEIV99
  7333     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7334
  7335
  7336
  7337* EXEC CICS HANDLE CONDITION
  7338*        NOTFND  (3300-END-BROWSE)
  7339*        ENDFILE (3300-END-BROWSE)
  7340*        END-EXEC.
  7341*    MOVE '"$I''                  ! 6 #00006890' TO DFHEIV0
  7342     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7343     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7344     MOVE X'3620233030303036383930' TO DFHEIV0(25:11)
  7345     CALL 'kxdfhei1' USING DFHEIV0
  7346     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7347
  7348
  7349     PERFORM 7200-READ-ARCH4-FILE-NEXT THRU 7200-EXIT.
  7350
  7351     IF  W-CHANGE-REQUESTED
  7352             OR
  7353         W-READ-PREV-TWICE
  7354         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7355         PERFORM 7250-READ-PREV-ARCH4 THRU 7250-EXIT.
  7356
  7357 3300-BUILD-ARCH4-LIST-BACKWARD.
  7358
  7359     PERFORM 7250-READ-PREV-ARCH4 THRU 7250-EXIT.
  7360
  7361     IF  LA-COMPANY-CD-A3 NOT EQUAL PI-COMPANY-CD
  7362         GO TO 3300-END.
  7363
  7364     IF  PI-690-INIT-PROCESSOR EQUAL HIGH-VALUES OR LOW-VALUES
  7365         GO TO 3300-CONTINUE.
  7366
  7367     IF  LA-PROCESSOR-CD NOT EQUAL PI-690-INIT-PROCESSOR
  7368         GO TO 3300-END-BROWSE.
  7369
  7370     IF  PI-690-INIT-CARRIER EQUAL HIGH-VALUES OR LOW-VALUES
  7371         GO TO 3300-CONTINUE.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 147
* EL690.cbl
  7372
  7373     IF  LA-CARRIER-A4 NOT EQUAL PI-690-INIT-CARRIER
  7374         GO TO 3300-END-BROWSE.
  7375
  7376     IF  PI-690-INIT-GROUPING EQUAL HIGH-VALUES OR LOW-VALUES
  7377         GO TO 3300-CONTINUE.
  7378
  7379     IF  LA-GROUPING-A4 NOT EQUAL PI-690-INIT-GROUPING
  7380         GO TO 3300-END-BROWSE.
  7381
  7382     IF  PI-690-INIT-STATE EQUAL HIGH-VALUES OR LOW-VALUES
  7383         GO TO 3300-CONTINUE.
  7384
  7385     IF  LA-STATE-A4 NOT EQUAL PI-690-INIT-STATE
  7386         GO TO 3300-END-BROWSE.
  7387
  7388     IF  PI-690-INIT-ACCOUNT EQUAL HIGH-VALUES OR LOW-VALUES
  7389         GO TO 3300-CONTINUE.
  7390
  7391     IF  LA-ACCOUNT-A4 NOT EQUAL PI-690-INIT-ACCOUNT
  7392         GO TO 3300-END-BROWSE.
  7393
  7394 3300-CONTINUE.
  7395
  7396     IF  NOT PI-690-SELECT-ALL
  7397             AND
  7398         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7399         GO TO 3300-BUILD-ARCH4-LIST-BACKWARD.
  7400
  7401     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  7402             AND
  7403         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  7404         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  7405             GO TO 3300-BUILD-ARCH4-LIST-BACKWARD.
  7406
  7407     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  7408             AND
  7409         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  7410         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  7411             GO TO 3300-BUILD-ARCH4-LIST-BACKWARD.
  7412
  7413     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7414
  7415     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7416
  7417     IF  W-ARCH-NDX LESS THAN +13
  7418         GO TO 3300-BUILD-ARCH4-LIST-BACKWARD.
  7419
  7420 3300-END.
  7421
  7422     MOVE -1                     TO CORRSELL.
  7423     MOVE ZEROS                  TO CORRSELO.
  7424     PERFORM 3300-END-BROWSE
  7425     GO TO 8100-SEND-INITIAL-MAP.
  7426
  7427 3300-END-BROWSE.
  7428
  7429     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 148
* EL690.cbl
  7430     SUBTRACT +1 FROM W-ARCH-NDX3.
  7431
  7432     IF  W-ARCH-NDX3 GREATER THAN +1
  7433         MOVE +1 TO W-ARCH-NDX2
  7434         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7435                 UNTIL
  7436             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7437
  7438
  7439* EXEC CICS ENDBR
  7440*        DATASET (W-ARCH4-FILE-ID)
  7441*    END-EXEC.
  7442     MOVE 0
  7443       TO DFHEIV11
  7444*    MOVE '&2                    $   #00006984' TO DFHEIV0
  7445     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7446     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7447     MOVE X'2020233030303036393834' TO DFHEIV0(25:11)
  7448     CALL 'kxdfhei1' USING DFHEIV0,
  7449           W-ARCH4-FILE-ID,
  7450           DFHEIV11,
  7451           DFHEIV99
  7452     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7453
  7454
  7455 3300-FRONT-OF-FILE.
  7456
  7457     MOVE ER-0131                TO EMI-ERROR.
  7458     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7459     MOVE -1                     TO CORRSELL.
  7460     MOVE ZEROS                  TO CORRSELO.
  7461     GO TO 8100-SEND-INITIAL-MAP.
  7462
  7463 3300-EXIT.
  7464     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 149
* EL690.cbl
  7466 3400-ARCH5-PROCESS.
  7467
  7468     IF  W-CHANGE-REQUESTED
  7469         MOVE HIGH-VALUES        TO W-ARCH5-KEY
  7470         MOVE PI-COMPANY-CD      TO W-ARCH5-COMPANY-CD
  7471         MOVE PI-690-INIT-CARRIER
  7472                                 TO W-ARCH5-CARRIER
  7473         MOVE PI-690-INIT-GROUPING
  7474                                 TO W-ARCH5-GROUPING
  7475         MOVE PI-690-INIT-STATE  TO W-ARCH5-STATE
  7476         MOVE PI-690-INIT-ACCOUNT
  7477                                 TO W-ARCH5-ACCOUNT
  7478
  7479     ELSE
  7480         IF  W-FIRST-CHANGE-FOUND
  7481             MOVE SPACES         TO W-READ-PREV-TWICE-IND
  7482             MOVE HIGH-VALUES    TO W-ARCH5-KEY
  7483             MOVE PI-COMPANY-CD  TO W-ARCH5-COMPANY-CD
  7484             MOVE PI-690-LAST-CARRIER
  7485                                 TO W-ARCH5-CARRIER
  7486             MOVE PI-690-LAST-GROUPING
  7487                                 TO W-ARCH5-GROUPING
  7488             MOVE PI-690-LAST-STATE
  7489                                 TO W-ARCH5-STATE
  7490             MOVE PI-690-LAST-ACCOUNT
  7491                                 TO W-ARCH5-ACCOUNT
  7492             MOVE PI-690-LAST-ARCHIVE-NO
  7493                                 TO W-ARCH5-ARCHIVE-NO
  7494
  7495         ELSE
  7496             MOVE PI-COMPANY-CD  TO W-ARCH5-COMPANY-CD
  7497             MOVE PI-690-FIRST-CARRIER
  7498                                 TO W-ARCH5-CARRIER
  7499             MOVE PI-690-FIRST-GROUPING
  7500                                 TO W-ARCH5-GROUPING
  7501             MOVE PI-690-FIRST-STATE
  7502                                 TO W-ARCH5-STATE
  7503             MOVE PI-690-FIRST-ACCOUNT
  7504                                 TO W-ARCH5-ACCOUNT
  7505             MOVE PI-690-FIRST-ARCHIVE-NO
  7506                                 TO W-ARCH5-ARCHIVE-NO.
  7507
  7508
  7509* EXEC CICS HANDLE CONDITION
  7510*        NOTFND  (8080-ARCH-NOT-FOUND)
  7511*        ENDFILE (8080-ARCH-NOT-FOUND)
  7512*        NOTOPEN (8030-ARCH5-NOT-OPEN)
  7513*        END-EXEC.
  7514*    MOVE '"$I''J                 ! 7 #00007041' TO DFHEIV0
  7515     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7516     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7517     MOVE X'3720233030303037303431' TO DFHEIV0(25:11)
  7518     CALL 'kxdfhei1' USING DFHEIV0
  7519     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7520
  7521
  7522
  7523* EXEC CICS STARTBR
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 150
* EL690.cbl
  7524*        DATASET  (W-ARCH5-FILE-ID)
  7525*        RIDFLD   (W-ARCH5-KEY)
  7526*        GTEQ
  7527*        END-EXEC.
  7528     MOVE 0
  7529       TO DFHEIV11
  7530*    MOVE '&,         G          &   #00007047' TO DFHEIV0
  7531     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7532     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7533     MOVE X'2020233030303037303437' TO DFHEIV0(25:11)
  7534     CALL 'kxdfhei1' USING DFHEIV0,
  7535           W-ARCH5-FILE-ID,
  7536           W-ARCH5-KEY,
  7537           DFHEIV99,
  7538           DFHEIV11,
  7539           DFHEIV99
  7540     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7541
  7542
  7543
  7544* EXEC CICS HANDLE CONDITION
  7545*        NOTFND  (3400-END-BROWSE)
  7546*        ENDFILE (3400-END-BROWSE)
  7547*        END-EXEC.
  7548*    MOVE '"$I''                  ! 8 #00007053' TO DFHEIV0
  7549     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7550     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7551     MOVE X'3820233030303037303533' TO DFHEIV0(25:11)
  7552     CALL 'kxdfhei1' USING DFHEIV0
  7553     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7554
  7555
  7556     PERFORM 7300-READ-ARCH5-FILE-NEXT THRU 7300-EXIT.
  7557
  7558     IF  W-CHANGE-REQUESTED
  7559*            OR
  7560*        W-READ-PREV-TWICE
  7561*        MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7562         PERFORM 7350-READ-PREV-ARCH5 THRU 7350-EXIT.
  7563
  7564 3400-BUILD-ARCH5-LIST-BACKWARD.
  7565
  7566     PERFORM 7350-READ-PREV-ARCH5 THRU 7350-EXIT.
  7567
  7568     IF  LA-COMPANY-CD-A5 NOT EQUAL PI-COMPANY-CD
  7569         GO TO 3400-END.
  7570
  7571     IF  PI-690-INIT-CARRIER EQUAL HIGH-VALUES OR LOW-VALUES
  7572         GO TO 3400-CONTINUE.
  7573
  7574     IF  LA-CARRIER-A5 NOT EQUAL PI-690-INIT-CARRIER
  7575         GO TO 3400-END-BROWSE.
  7576
  7577     IF  PI-690-INIT-GROUPING EQUAL HIGH-VALUES OR LOW-VALUES
  7578         GO TO 3400-CONTINUE.
  7579
  7580     IF  LA-GROUPING-A5 NOT EQUAL PI-690-INIT-GROUPING
  7581         GO TO 3400-END-BROWSE.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 151
* EL690.cbl
  7582
  7583     IF  PI-690-INIT-STATE EQUAL HIGH-VALUES OR LOW-VALUES
  7584         GO TO 3400-CONTINUE.
  7585
  7586     IF  LA-STATE-A5 NOT EQUAL PI-690-INIT-STATE
  7587         GO TO 3400-END-BROWSE.
  7588
  7589     IF  PI-690-INIT-ACCOUNT EQUAL HIGH-VALUES OR LOW-VALUES
  7590         GO TO 3400-CONTINUE.
  7591
  7592     IF  LA-ACCOUNT-A5 NOT EQUAL PI-690-INIT-ACCOUNT
  7593         GO TO 3400-END-BROWSE.
  7594
  7595 3400-CONTINUE.
  7596
  7597     IF  NOT PI-690-SELECT-ALL
  7598             AND
  7599         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7600         GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7601
  7602     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  7603             AND
  7604         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  7605         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  7606             GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7607
  7608     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  7609             AND
  7610         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  7611         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  7612             GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7613
  7614     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  7615             AND
  7616         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  7617         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  7618             GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7619
  7620     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7621
  7622     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7623
  7624     IF  W-ARCH-NDX LESS THAN +13
  7625         GO TO 3400-BUILD-ARCH5-LIST-BACKWARD.
  7626
  7627 3400-END.
  7628
  7629     MOVE -1                     TO CORRSELL.
  7630     MOVE ZEROS                  TO CORRSELO.
  7631     PERFORM 3400-END-BROWSE
  7632     GO TO 8100-SEND-INITIAL-MAP.
  7633
  7634 3400-END-BROWSE.
  7635
  7636     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  7637     SUBTRACT +1 FROM W-ARCH-NDX3.
  7638
  7639     IF  W-ARCH-NDX3 GREATER THAN +1
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 152
* EL690.cbl
  7640         MOVE +1 TO W-ARCH-NDX2
  7641         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7642                 UNTIL
  7643             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7644
  7645
  7646* EXEC CICS ENDBR
  7647*        DATASET (W-ARCH5-FILE-ID)
  7648*    END-EXEC.
  7649     MOVE 0
  7650       TO DFHEIV11
  7651*    MOVE '&2                    $   #00007147' TO DFHEIV0
  7652     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7653     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7654     MOVE X'2020233030303037313437' TO DFHEIV0(25:11)
  7655     CALL 'kxdfhei1' USING DFHEIV0,
  7656           W-ARCH5-FILE-ID,
  7657           DFHEIV11,
  7658           DFHEIV99
  7659     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7660
  7661
  7662 3400-FRONT-OF-FILE.
  7663
  7664     MOVE ER-0131                TO EMI-ERROR.
  7665     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7666     MOVE -1                     TO CORRSELL.
  7667     MOVE ZEROS                  TO CORRSELO.
  7668     GO TO 8100-SEND-INITIAL-MAP.
  7669
  7670 3400-EXIT.
  7671     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 153
* EL690.cbl
  7673 3500-ARCH6-PROCESS.
  7674
  7675     IF  W-CHANGE-REQUESTED
  7676         MOVE HIGH-VALUES        TO W-ARCH6-KEY
  7677         MOVE PI-COMPANY-CD      TO W-ARCH6-COMPANY-CD
  7678         MOVE PI-690-INIT-ENTRY  TO W-ARCH6-ENTRY
  7679
  7680
  7681     ELSE
  7682         IF  W-FIRST-CHANGE-FOUND
  7683             MOVE HIGH-VALUES    TO W-ARCH6-KEY
  7684             MOVE PI-COMPANY-CD  TO W-ARCH6-COMPANY-CD
  7685             MOVE PI-690-LAST-ENTRY
  7686                                 TO W-ARCH6-ENTRY
  7687
  7688         ELSE
  7689             MOVE PI-COMPANY-CD  TO W-ARCH6-COMPANY-CD
  7690             MOVE PI-690-FIRST-ENTRY
  7691                                 TO W-ARCH6-ENTRY
  7692             MOVE PI-690-FIRST-ARCHIVE-NO
  7693                                 TO W-ARCH6-ARCHIVE-NO.
  7694
  7695
  7696* EXEC CICS HANDLE CONDITION
  7697*        NOTFND  (8080-ARCH-NOT-FOUND)
  7698*        ENDFILE (8080-ARCH-NOT-FOUND)
  7699*        NOTOPEN (8040-ARCH6-NOT-OPEN)
  7700*        END-EXEC.
  7701*    MOVE '"$I''J                 ! 9 #00007184' TO DFHEIV0
  7702     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7703     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7704     MOVE X'3920233030303037313834' TO DFHEIV0(25:11)
  7705     CALL 'kxdfhei1' USING DFHEIV0
  7706     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7707
  7708
  7709
  7710* EXEC CICS STARTBR
  7711*        DATASET  (W-ARCH6-FILE-ID)
  7712*        RIDFLD   (W-ARCH6-KEY)
  7713*        GTEQ
  7714*        END-EXEC.
  7715     MOVE 0
  7716       TO DFHEIV11
  7717*    MOVE '&,         G          &   #00007190' TO DFHEIV0
  7718     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7719     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7720     MOVE X'2020233030303037313930' TO DFHEIV0(25:11)
  7721     CALL 'kxdfhei1' USING DFHEIV0,
  7722           W-ARCH6-FILE-ID,
  7723           W-ARCH6-KEY,
  7724           DFHEIV99,
  7725           DFHEIV11,
  7726           DFHEIV99
  7727     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7728
  7729
  7730
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 154
* EL690.cbl
  7731* EXEC CICS HANDLE CONDITION
  7732*        NOTFND  (3500-END-BROWSE)
  7733*        ENDFILE (3500-END-BROWSE)
  7734*        END-EXEC.
  7735*    MOVE '"$I''                  ! : #00007196' TO DFHEIV0
  7736     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7737     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7738     MOVE X'3A20233030303037313936' TO DFHEIV0(25:11)
  7739     CALL 'kxdfhei1' USING DFHEIV0
  7740     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7741
  7742
  7743     PERFORM 7400-READ-ARCH6-FILE-NEXT THRU 7400-EXIT.
  7744
  7745     IF  W-CHANGE-REQUESTED
  7746             OR
  7747         W-READ-PREV-TWICE
  7748         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7749         PERFORM 7450-READ-PREV-ARCH6 THRU 7450-EXIT.
  7750
  7751 3500-BUILD-ARCH6-LIST-BACKWARD.
  7752
  7753     PERFORM 7450-READ-PREV-ARCH6 THRU 7450-EXIT.
  7754
  7755     IF  LA-COMPANY-CD-A5 NOT EQUAL PI-COMPANY-CD
  7756         GO TO 3500-END.
  7757
  7758     IF  PI-690-INIT-ENTRY EQUAL HIGH-VALUES OR LOW-VALUES
  7759         GO TO 3500-CONTINUE.
  7760
  7761     IF  LA-ENTRY-A6 NOT EQUAL PI-690-INIT-ENTRY
  7762         GO TO 3500-END-BROWSE.
  7763
  7764 3500-CONTINUE.
  7765
  7766     IF  NOT PI-690-SELECT-ALL
  7767             AND
  7768         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7769         GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7770
  7771     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  7772             AND
  7773         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  7774         IF  LA-FORM-A3 NOT EQUAL PI-690-INIT-FORM
  7775             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7776
  7777     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  7778             AND
  7779         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  7780         IF  LA-PROCESSOR-CD NOT EQUAL PI-690-INIT-PROCESSOR
  7781             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7782
  7783     IF  PI-690-INIT-CARRIER NOT EQUAL HIGH-VALUES
  7784             AND
  7785         PI-690-INIT-CARRIER NOT EQUAL LOW-VALUES
  7786         IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  7787             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7788
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 155
* EL690.cbl
  7789     IF  PI-690-INIT-GROUPING NOT EQUAL HIGH-VALUES
  7790             AND
  7791         PI-690-INIT-GROUPING NOT EQUAL LOW-VALUES
  7792         IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  7793             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7794
  7795     IF  PI-690-INIT-STATE NOT EQUAL HIGH-VALUES
  7796             AND
  7797         PI-690-INIT-STATE NOT EQUAL LOW-VALUES
  7798         IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  7799             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7800
  7801     IF  PI-690-INIT-ACCOUNT NOT EQUAL HIGH-VALUES
  7802             AND
  7803         PI-690-INIT-ACCOUNT NOT EQUAL LOW-VALUES
  7804         IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  7805             GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7806
  7807     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7808
  7809     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7810
  7811     IF  W-ARCH-NDX LESS THAN +13
  7812         GO TO 3500-BUILD-ARCH6-LIST-BACKWARD.
  7813
  7814 3500-END.
  7815
  7816     MOVE -1                     TO CORRSELL.
  7817     MOVE ZEROS                  TO CORRSELO.
  7818     PERFORM 3500-END-BROWSE
  7819     GO TO 8100-SEND-INITIAL-MAP.
  7820
  7821 3500-END-BROWSE.
  7822
  7823     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  7824     SUBTRACT +1 FROM W-ARCH-NDX3.
  7825
  7826     IF  W-ARCH-NDX3 GREATER THAN +1
  7827         MOVE +1 TO W-ARCH-NDX2
  7828         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  7829                 UNTIL
  7830             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  7831
  7832
  7833* EXEC CICS ENDBR
  7834*        DATASET (W-ARCH6-FILE-ID)
  7835*    END-EXEC.
  7836     MOVE 0
  7837       TO DFHEIV11
  7838*    MOVE '&2                    $   #00007290' TO DFHEIV0
  7839     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  7840     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  7841     MOVE X'2020233030303037323930' TO DFHEIV0(25:11)
  7842     CALL 'kxdfhei1' USING DFHEIV0,
  7843           W-ARCH6-FILE-ID,
  7844           DFHEIV11,
  7845           DFHEIV99
  7846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 156
* EL690.cbl
  7847
  7848
  7849 3500-FRONT-OF-FILE.
  7850
  7851     MOVE ER-0131                TO EMI-ERROR.
  7852     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  7853     MOVE -1                     TO CORRSELL.
  7854     MOVE ZEROS                  TO CORRSELO.
  7855     GO TO 8100-SEND-INITIAL-MAP.
  7856
  7857 3500-EXIT.
  7858     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 157
* EL690.cbl
  7860 3600-ARCH-PROCESS.
  7861
  7862     IF  W-CHANGE-REQUESTED
  7863         MOVE HIGH-VALUES        TO W-ARCH-KEY
  7864         MOVE PI-COMPANY-CD      TO W-ARCH-COMPANY-CD
  7865
  7866     ELSE
  7867         IF  W-FIRST-CHANGE-FOUND
  7868             MOVE HIGH-VALUES    TO W-ARCH-KEY
  7869             MOVE PI-COMPANY-CD  TO W-ARCH-COMPANY-CD
  7870             MOVE PI-690-LAST-ARCHIVE-NO
  7871                                 TO W-ARCH-ARCHIVE-NO
  7872
  7873         ELSE
  7874             MOVE PI-COMPANY-CD  TO W-ARCH-COMPANY-CD
  7875             MOVE PI-690-FIRST-ARCHIVE-NO
  7876                                 TO W-ARCH-ARCHIVE-NO
  7877             MOVE PI-690-FIRST-ARCHIVE-NO
  7878                                 TO W-ARCH-ARCHIVE-NO.
  7879
  7880
  7881* EXEC CICS HANDLE CONDITION
  7882*        NOTFND  (8080-ARCH-NOT-FOUND)
  7883*        ENDFILE (8080-ARCH-NOT-FOUND)
  7884*        NOTOPEN (8050-ARCH-NOT-OPEN)
  7885*        END-EXEC.
  7886*    MOVE '"$I''J                 ! ; #00007325' TO DFHEIV0
  7887     MOVE X'222449274A20202020202020' TO DFHEIV0(1:12)
  7888     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7889     MOVE X'3B20233030303037333235' TO DFHEIV0(25:11)
  7890     CALL 'kxdfhei1' USING DFHEIV0
  7891     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7892
  7893
  7894
  7895* EXEC CICS STARTBR
  7896*        DATASET  (W-ARCH-FILE-ID)
  7897*        RIDFLD   (W-ARCH-KEY)
  7898*        GTEQ
  7899*        END-EXEC.
  7900     MOVE 0
  7901       TO DFHEIV11
  7902*    MOVE '&,         G          &   #00007331' TO DFHEIV0
  7903     MOVE X'262C20202020202020202047' TO DFHEIV0(1:12)
  7904     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  7905     MOVE X'2020233030303037333331' TO DFHEIV0(25:11)
  7906     CALL 'kxdfhei1' USING DFHEIV0,
  7907           W-ARCH-FILE-ID,
  7908           W-ARCH-KEY,
  7909           DFHEIV99,
  7910           DFHEIV11,
  7911           DFHEIV99
  7912     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7913
  7914
  7915
  7916* EXEC CICS HANDLE CONDITION
  7917*        NOTFND  (3600-END-BROWSE)
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 158
* EL690.cbl
  7918*        ENDFILE (3600-END-BROWSE)
  7919*        END-EXEC.
  7920*    MOVE '"$I''                  ! < #00007337' TO DFHEIV0
  7921     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  7922     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  7923     MOVE X'3C20233030303037333337' TO DFHEIV0(25:11)
  7924     CALL 'kxdfhei1' USING DFHEIV0
  7925     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  7926
  7927
  7928     PERFORM 7500-READ-ARCH-FILE-NEXT THRU 7500-EXIT.
  7929
  7930     IF  W-CHANGE-REQUESTED
  7931             OR
  7932         W-READ-PREV-TWICE
  7933         MOVE SPACES            TO W-READ-PREV-TWICE-IND
  7934         PERFORM 7550-READ-PREV-ARCH THRU 7550-EXIT.
  7935
  7936 3600-BUILD-ARCH-LIST-BACKWARD.
  7937
  7938     PERFORM 7550-READ-PREV-ARCH THRU 7550-EXIT.
  7939
  7940     IF  LA-COMPANY-CD-A5 NOT EQUAL PI-COMPANY-CD
  7941         GO TO 3600-END.
  7942
  7943     IF  PI-690-INIT-ENTRY NOT EQUAL HIGH-VALUES
  7944             AND
  7945         PI-690-INIT-ENTRY NOT EQUAL LOW-VALUES
  7946         IF  PI-690-INIT-ENTRY NOT EQUAL LA-ENTRY-A6
  7947             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7948
  7949     IF  PI-690-INIT-PROCESSOR NOT EQUAL HIGH-VALUES
  7950             AND
  7951         PI-690-INIT-PROCESSOR NOT EQUAL LOW-VALUES
  7952         IF  PI-690-INIT-PROCESSOR NOT EQUAL LA-PROCESSOR-CD
  7953             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7954
  7955     IF  PI-690-INIT-FORM NOT EQUAL HIGH-VALUES
  7956             AND
  7957         PI-690-INIT-FORM NOT EQUAL LOW-VALUES
  7958         IF  PI-690-INIT-FORM NOT EQUAL LA-FORM-A3
  7959             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7960
  7961     IF  PI-690-INIT-CARRIER NOT EQUAL HIGH-VALUES
  7962             AND
  7963         PI-690-INIT-CARRIER NOT EQUAL LOW-VALUES
  7964         IF  LA-CARRIER-A2 NOT EQUAL PI-690-INIT-CARRIER
  7965             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7966
  7967     IF  PI-690-INIT-GROUPING NOT EQUAL HIGH-VALUES
  7968             AND
  7969         PI-690-INIT-GROUPING NOT EQUAL LOW-VALUES
  7970         IF  LA-GROUPING-A2 NOT EQUAL PI-690-INIT-GROUPING
  7971             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7972
  7973     IF  PI-690-INIT-STATE NOT EQUAL HIGH-VALUES
  7974             AND
  7975         PI-690-INIT-STATE NOT EQUAL LOW-VALUES
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 159
* EL690.cbl
  7976         IF  LA-STATE-A2 NOT EQUAL PI-690-INIT-STATE
  7977             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7978
  7979     IF  PI-690-INIT-ACCOUNT NOT EQUAL HIGH-VALUES
  7980             AND
  7981         PI-690-INIT-ACCOUNT NOT EQUAL LOW-VALUES
  7982         IF  LA-ACCOUNT-A2 NOT EQUAL PI-690-INIT-ACCOUNT
  7983             GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7984
  7985     IF  NOT PI-690-SELECT-ALL
  7986             AND
  7987         LA-STATUS NOT EQUAL PI-690-STATUS-SELECTION-IND
  7988         GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7989
  7990     MOVE LA-ARCHIVE-NO          TO W-ARCH-NUMBER.
  7991
  7992     PERFORM 6000-SELECT-FOR-OUTPUT THRU 6000-EXIT.
  7993
  7994     IF  W-ARCH-NDX LESS THAN +13
  7995         GO TO 3600-BUILD-ARCH-LIST-BACKWARD.
  7996
  7997 3600-END.
  7998
  7999     MOVE -1                     TO CORRSELL.
  8000     MOVE ZEROS                  TO CORRSELO.
  8001     PERFORM 3600-END-BROWSE
  8002     GO TO 8100-SEND-INITIAL-MAP.
  8003
  8004 3600-END-BROWSE.
  8005
  8006     MOVE W-ARCH-NDX             TO W-ARCH-NDX3.
  8007     SUBTRACT +1 FROM W-ARCH-NDX3.
  8008
  8009     IF  W-ARCH-NDX3 GREATER THAN +1
  8010         MOVE +1 TO W-ARCH-NDX2
  8011         PERFORM 6500-REVERSE-TABLE-DATA THRU 6500-EXIT
  8012                 UNTIL
  8013             W-ARCH-NDX2 NOT LESS W-ARCH-NDX3.
  8014
  8015
  8016* EXEC CICS ENDBR
  8017*        DATASET (W-ARCH-FILE-ID)
  8018*    END-EXEC.
  8019     MOVE 0
  8020       TO DFHEIV11
  8021*    MOVE '&2                    $   #00007429' TO DFHEIV0
  8022     MOVE X'263220202020202020202020' TO DFHEIV0(1:12)
  8023     MOVE X'202020202020202020202420' TO DFHEIV0(13:12)
  8024     MOVE X'2020233030303037343239' TO DFHEIV0(25:11)
  8025     CALL 'kxdfhei1' USING DFHEIV0,
  8026           W-ARCH-FILE-ID,
  8027           DFHEIV11,
  8028           DFHEIV99
  8029     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8030
  8031
  8032 3600-FRONT-OF-FILE.
  8033
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 160
* EL690.cbl
  8034     MOVE ER-0131                TO EMI-ERROR.
  8035     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8036     MOVE -1                     TO CORRSELL.
  8037     MOVE ZEROS                  TO CORRSELO.
  8038     GO TO 8100-SEND-INITIAL-MAP.
  8039
  8040 3600-EXIT.
  8041     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 161
* EL690.cbl
  8043 6000-SELECT-FOR-OUTPUT.
  8044
  8045     IF  PI-CARRIER-SECURITY GREATER THAN SPACES
  8046             AND
  8047         PI-CARRIER-SECURITY NOT EQUAL LA-CARRIER-A2
  8048
  8049         IF  EMI-ERROR NOT EQUAL ER-9150
  8050             MOVE ER-9150        TO EMI-ERROR
  8051             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  8052             GO TO 6000-EXIT
  8053
  8054         ELSE
  8055             GO TO 6000-EXIT.
  8056
  8057     IF LA-TEMP
  8058         GO TO 6000-EXIT
  8059     END-IF.
  8060
  8061     PERFORM 6100-TABLE-LINE-CREATE  THRU 6100-EXIT.
  8062
  8063     MOVE W-ARCH-NDX             TO PI-690-LAST-ARCH-NDX.
  8064     ADD +1                      TO W-ARCH-NDX.
  8065
  8066
  8067     IF  EIBAID EQUAL DFHPF1
  8068         MOVE LA-CARRIER-A2      TO PI-690-LAST-CARRIER
  8069         MOVE LA-GROUPING-A2     TO PI-690-LAST-GROUPING
  8070         MOVE LA-STATE-A2        TO PI-690-LAST-STATE
  8071         MOVE LA-ACCOUNT-A2      TO PI-690-LAST-ACCOUNT
  8072         MOVE LA-CERT-PRIME-A2   TO PI-690-LAST-CERT-PRIME
  8073         MOVE LA-CERT-SUFFIX-A2  TO PI-690-LAST-SUFFIX
  8074         MOVE LA-EFFECT-DATE-A2  TO PI-690-LAST-EFFECT-DATE
  8075         MOVE LA-FORM-A3         TO PI-690-LAST-FORM
  8076         MOVE LA-PROCESSOR-CD    TO PI-690-LAST-PROCESSOR
  8077         MOVE LA-ENTRY-A6        TO PI-690-LAST-ENTRY
  8078         MOVE LA-ARCHIVE-NO      TO PI-690-LAST-ARCHIVE-NO
  8079
  8080         IF  PI-690-FIRST-DATA EQUAL LOW-VALUES
  8081                 OR
  8082             PI-690-FIRST-DATA EQUAL HIGH-VALUES
  8083             MOVE PI-690-LAST-DATA
  8084                                 TO PI-690-FIRST-DATA
  8085
  8086         ELSE
  8087             NEXT SENTENCE
  8088
  8089     ELSE
  8090         MOVE LA-CARRIER-A2      TO PI-690-FIRST-CARRIER
  8091         MOVE LA-GROUPING-A2     TO PI-690-FIRST-GROUPING
  8092         MOVE LA-STATE-A2        TO PI-690-FIRST-STATE
  8093         MOVE LA-ACCOUNT-A2      TO PI-690-FIRST-ACCOUNT
  8094         MOVE LA-CERT-PRIME-A2   TO PI-690-FIRST-CERT-PRIME
  8095         MOVE LA-CERT-SUFFIX-A2  TO PI-690-FIRST-SUFFIX
  8096         MOVE LA-EFFECT-DATE-A2  TO PI-690-FIRST-EFFECT-DATE
  8097         MOVE LA-FORM-A3         TO PI-690-FIRST-FORM
  8098         MOVE LA-PROCESSOR-CD    TO PI-690-FIRST-PROCESSOR
  8099         MOVE LA-ENTRY-A6        TO PI-690-FIRST-ENTRY
  8100         MOVE LA-ARCHIVE-NO      TO PI-690-FIRST-ARCHIVE-NO
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 162
* EL690.cbl
  8101
  8102         IF  PI-690-LAST-DATA EQUAL LOW-VALUES
  8103                 OR
  8104             PI-690-LAST-DATA EQUAL HIGH-VALUES
  8105             MOVE PI-690-FIRST-DATA
  8106                                 TO PI-690-LAST-DATA.
  8107
  8108 6000-EXIT.
  8109     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 163
* EL690.cbl
  8111 6100-TABLE-LINE-CREATE.
  8112
  8113     MOVE LA-ARCHIVE-NO
  8114         TO W-ARCNOO (W-ARCH-NDX)
  8115            PI-690-ARCHIVE-NUM (W-ARCH-NDX).
  8116
  8117*    MOVE LA-STATUS              TO W-STATSO (W-ARCH-NDX).
  8118     MOVE LA-FORM-A3             TO W-FORMO (W-ARCH-NDX).
  8119     MOVE LA-PROCESSOR-CD        TO W-USRIDO (W-ARCH-NDX).
  8120
  8121*    IF  LA-PRINT-ONLY-WHEN-FORM-GIVEN
  8122*        MOVE 'F'                TO W-PRRSTO (W-ARCH-NDX)
  8123*
  8124*    ELSE
  8125*        IF  LA-PRINT-ONLY-WHEN-PROC-GIVEN
  8126*            MOVE 'P'            TO W-PRRSTO (W-ARCH-NDX)
  8127*
  8128*        ELSE
  8129*            IF  LA-PRINT-ONLY-WHEN-CNTL-GIVEN
  8130*                MOVE 'C'        TO W-PRRSTO (W-ARCH-NDX)
  8131*
  8132*            ELSE
  8133*                MOVE SPACES     TO W-PRRSTO (W-ARCH-NDX).
  8134
  8135     IF  LA-INITIAL-PRINT-DATE GREATER THAN LOW-VALUES
  8136*        MOVE AL-PABON           TO W-PRINTA (W-ARCH-NDX)
  8137         MOVE LA-INITIAL-PRINT-DATE
  8138                                 TO DC-BIN-DATE-1
  8139         MOVE ' '                TO DC-OPTION-CODE
  8140         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8141
  8142         IF  DC-ERROR-CODE EQUAL SPACES
  8143             MOVE DC-GREG-DATE-1-EDIT
  8144                                 TO W-PRINTO (W-ARCH-NDX)
  8145
  8146         ELSE
  8147             MOVE SPACES         TO W-PRINTO (W-ARCH-NDX)
  8148         END-IF
  8149     ELSE
  8150         MOVE SPACES             TO W-PRINTO (W-ARCH-NDX)
  8151     END-IF.
  8152
  8153*        IF  LA-CREATION-DATE GREATER THAN LOW-VALUES
  8154*            MOVE LA-CREATION-DATE
  8155*                                TO DC-BIN-DATE-1
  8156*            MOVE ' '            TO DC-OPTION-CODE
  8157*            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8158*
  8159*            IF  DC-ERROR-CODE EQUAL SPACES
  8160*                MOVE DC-GREG-DATE-1-EDIT
  8161*                                TO W-CREATO (W-ARCH-NDX)
  8162*
  8163*            ELSE
  8164*                MOVE SPACES     TO W-CREATO (W-ARCH-NDX)
  8165*
  8166*        ELSE
  8167*            MOVE SPACES         TO W-CREATO (W-ARCH-NDX).
  8168
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 164
* EL690.cbl
  8169
  8170*    IF  LA-FOLLOW-UP-DATE GREATER THAN LOW-VALUES
  8171*        MOVE LA-FOLLOW-UP-DATE  TO DC-BIN-DATE-1
  8172*        MOVE ' '                TO DC-OPTION-CODE
  8173*        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8174*
  8175*        IF  DC-ERROR-CODE EQUAL SPACES
  8176*            MOVE DC-GREG-DATE-1-EDIT
  8177*                                TO W-FOLUPO (W-ARCH-NDX)
  8178*
  8179*        ELSE
  8180*            MOVE SPACES         TO W-FOLUPO (W-ARCH-NDX)
  8181*
  8182*    ELSE
  8183*        MOVE SPACES             TO W-FOLUPO (W-ARCH-NDX).
  8184*
  8185
  8186*    IF  LA-SENT-DATE   GREATER THAN LOW-VALUES
  8187*        MOVE 'C'                TO W-RSSTSO (W-ARCH-NDX)
  8188*    ELSE
  8189*        MOVE 'A'                TO W-RSSTSO (W-ARCH-NDX)
  8190*    END-IF
  8191
  8192     IF  LA-RESEND-DATE   GREATER THAN LOW-VALUES
  8193         MOVE LA-RESEND-DATE
  8194                             TO DC-BIN-DATE-1
  8195         MOVE ' '            TO DC-OPTION-CODE
  8196         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8197
  8198         IF  DC-ERROR-CODE EQUAL SPACES
  8199             MOVE DC-GREG-DATE-1-EDIT
  8200                             TO W-RSDATO (W-ARCH-NDX)
  8201
  8202         ELSE
  8203             MOVE SPACES     TO W-RSDATO (W-ARCH-NDX)
  8204
  8205     ELSE
  8206         MOVE SPACES         TO W-RSDATO (W-ARCH-NDX)
  8207                                W-RSFRMO (W-ARCH-NDX)
  8208         GO TO 6100-CHECK-REPLY.
  8209
  8210
  8211     IF LA-RESEND-LETR NOT = SPACES
  8212        MOVE LA-RESEND-LETR      TO W-RSFRMO (W-ARCH-NDX)
  8213     ELSE
  8214        MOVE SPACES              TO W-RSFRMO (W-ARCH-NDX)
  8215     END-IF
  8216*    IF  LA-SENT-DATE-2 GREATER THAN LOW-VALUES
  8217*        MOVE AL-UABON           TO W-RSFRMA (W-ARCH-NDX)
  8218*        MOVE LA-SENT-DATE-2     TO DC-BIN-DATE-1
  8219*        MOVE ' '                TO DC-OPTION-CODE
  8220*        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8221*
  8222*        IF  DC-ERROR-CODE EQUAL SPACES
  8223*            MOVE DC-GREG-DATE-1-EDIT
  8224*                                TO W-RSFRMO (W-ARCH-NDX)
  8225*
  8226*        ELSE
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 165
* EL690.cbl
  8227*            MOVE SPACES         TO W-RSFRMO (W-ARCH-NDX)
  8228*
  8229*    ELSE
  8230*        IF  LA-RESEND-DATE-2 GREATER THAN LOW-VALUES
  8231*            MOVE LA-RESEND-DATE-2
  8232*                                TO DC-BIN-DATE-1
  8233*            MOVE ' '            TO DC-OPTION-CODE
  8234*            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8235*
  8236*            IF  DC-ERROR-CODE EQUAL SPACES
  8237*                MOVE DC-GREG-DATE-1-EDIT
  8238*                                TO W-RSFRMO (W-ARCH-NDX)
  8239*
  8240*            ELSE
  8241*                MOVE SPACES     TO W-RSFRMO (W-ARCH-NDX)
  8242*
  8243*        ELSE
  8244*            MOVE SPACES         TO W-RSFRMO (W-ARCH-NDX)
  8245*                                   W-RSSTSO (W-ARCH-NDX)
  8246*            GO TO 6100-CHECK-REPLY.
  8247*
  8248*
  8249*    IF  LA-SENT-DATE-3 GREATER THAN LOW-VALUES
  8250*        MOVE AL-UABON           TO W-RSSTSA (W-ARCH-NDX)
  8251*        MOVE LA-SENT-DATE-3     TO DC-BIN-DATE-1
  8252*        MOVE ' '                TO DC-OPTION-CODE
  8253*        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8254*
  8255*        IF  DC-ERROR-CODE EQUAL SPACES
  8256*            MOVE DC-GREG-DATE-1-EDIT
  8257*                                TO W-RSSTSO (W-ARCH-NDX)
  8258*
  8259*        ELSE
  8260*            MOVE SPACES         TO W-RSSTSO (W-ARCH-NDX)
  8261*
  8262*    ELSE
  8263*        IF  LA-RESEND-DATE-3 GREATER THAN LOW-VALUES
  8264*            MOVE LA-RESEND-DATE-3
  8265*                                TO DC-BIN-DATE-1
  8266*            MOVE ' '            TO DC-OPTION-CODE
  8267*            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8268*
  8269*            IF  DC-ERROR-CODE EQUAL SPACES
  8270*                MOVE DC-GREG-DATE-1-EDIT
  8271*                                TO W-RSSTSO (W-ARCH-NDX)
  8272*
  8273*            ELSE
  8274*                MOVE SPACES     TO W-RSSTSO (W-ARCH-NDX)
  8275*
  8276*        ELSE
  8277*            MOVE SPACES         TO W-RSSTSO (W-ARCH-NDX).
  8278     .
  8279 6100-CHECK-REPLY.
  8280
  8281     IF  LA-PURGED-DATE GREATER THAN LOW-VALUES
  8282             AND
  8283         LA-PURGED-DATE NOT EQUAL SPACES
  8284*        MOVE LA-PURGED-DATE     TO DC-BIN-DATE-1
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 166
* EL690.cbl
  8285*        MOVE ' '                TO DC-OPTION-CODE
  8286*        PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8287
  8288*        IF  DC-ERROR-CODE EQUAL SPACES
  8289*            MOVE DC-GREG-DATE-1-EDIT
  8290*                                TO W-REPLYO (W-ARCH-NDX)
  8291             MOVE 'PURGED'       TO W-STATUSO (W-ARCH-NDX)
  8292
  8293*        ELSE
  8294*            MOVE SPACES         TO W-REPLYO (W-ARCH-NDX)
  8295*                                   W-STOPO (W-ARCH-NDX)
  8296*
  8297*        END-IF
  8298     ELSE
  8299         IF  LA-VOIDED-DATE GREATER THAN LOW-VALUES
  8300                 AND
  8301             LA-VOIDED-DATE NOT EQUAL SPACES
  8302*            MOVE LA-VOIDED-DATE TO DC-BIN-DATE-1
  8303*            MOVE ' '            TO DC-OPTION-CODE
  8304*            PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8305
  8306*            IF  DC-ERROR-CODE EQUAL SPACES
  8307*                MOVE AL-PANOF   TO W-REPLYA (W-ARCH-NDX)
  8308*                MOVE DC-GREG-DATE-1-EDIT
  8309*                                TO W-REPLYO (W-ARCH-NDX)
  8310                 MOVE 'STOPPED'  TO W-STATUSO (W-ARCH-NDX)
  8311
  8312*            ELSE
  8313*                MOVE AL-PANOF   TO W-REPLYA (W-ARCH-NDX)
  8314*                MOVE SPACES     TO W-REPLYO (W-ARCH-NDX)
  8315*                                   W-STOPO (W-ARCH-NDX)
  8316*
  8317*
  8318*            END-IF
  8319         ELSE
  8320             IF  LA-REPLY-DATE GREATER THAN LOW-VALUES
  8321                     AND
  8322                 LA-REPLY-DATE NOT EQUAL SPACES
  8323*                MOVE LA-REPLY-DATE
  8324*                                TO DC-BIN-DATE-1
  8325*                MOVE ' '        TO DC-OPTION-CODE
  8326*                PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  8327*
  8328*                IF  DC-ERROR-CODE EQUAL SPACES
  8329*                    MOVE DC-GREG-DATE-1-EDIT
  8330*                                TO W-REPLYO (W-ARCH-NDX)
  8331                     MOVE 'RECEIVED' TO W-STATUSO (W-ARCH-NDX)
  8332
  8333*                ELSE
  8334*                    MOVE SPACES TO W-REPLYO (W-ARCH-NDX)
  8335*                                   W-STOPO (W-ARCH-NDX)
  8336*
  8337*                END-IF
  8338             ELSE
  8339                 IF LA-STATUS = 'A'
  8340                     MOVE 'ACTIVE' TO W-STATUSO (W-ARCH-NDX)
  8341                 ELSE
  8342                     IF LA-STATUS = 'C'
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 167
* EL690.cbl
  8343                        MOVE 'COMPLETE' TO W-STATUSO (W-ARCH-NDX)
  8344                     ELSE
  8345                        MOVE SPACES     TO W-STATUSO (W-ARCH-NDX)
  8346                     END-IF
  8347                 END-IF
  8348             END-IF
  8349         END-IF
  8350     END-IF.
  8351
  8352
  8353 6100-EXIT.
  8354     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 168
* EL690.cbl
  8356 6500-REVERSE-TABLE-DATA.
  8357
  8358     MOVE W-ARCHGRP-DATA (W-ARCH-NDX2)
  8359                                 TO W-HOLD-LINE.
  8360     MOVE W-ARCHGRP-DATA (W-ARCH-NDX3)
  8361                                 TO W-ARCHGRP-DATA (W-ARCH-NDX2).
  8362     MOVE W-HOLD-LINE            TO W-ARCHGRP-DATA (W-ARCH-NDX3).
  8363     MOVE PI-690-ARCHIVE-NUM (W-ARCH-NDX2)
  8364                                 TO W-HOLD-ARCHIVE.
  8365     MOVE PI-690-ARCHIVE-NUM (W-ARCH-NDX3)
  8366         TO PI-690-ARCHIVE-NUM (W-ARCH-NDX2).
  8367     MOVE W-HOLD-ARCHIVE
  8368         TO PI-690-ARCHIVE-NUM (W-ARCH-NDX3).
  8369
  8370     ADD +1                      TO W-ARCH-NDX2.
  8371     SUBTRACT +1 FROM W-ARCH-NDX3.
  8372
  8373 6500-EXIT.
  8374     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 169
* EL690.cbl
  8376 7000-READ-ARCH2-FILE-NEXT.
  8377
  8378
  8379* EXEC CICS READNEXT
  8380*        DATASET  (W-ARCH2-FILE-ID)
  8381*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8382*        RIDFLD   (W-ARCH2-KEY)
  8383*        END-EXEC.
  8384     MOVE 0
  8385       TO DFHEIV11
  8386*    MOVE '&.S                   )   #00007779' TO DFHEIV0
  8387     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8388     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8389     MOVE X'2020233030303037373739' TO DFHEIV0(25:11)
  8390     CALL 'kxdfhei1' USING DFHEIV0,
  8391           W-ARCH2-FILE-ID,
  8392           DFHEIV20,
  8393           DFHEIV99,
  8394           W-ARCH2-KEY,
  8395           DFHEIV99,
  8396           DFHEIV11,
  8397           DFHEIV99,
  8398           DFHEIV99
  8399     SET ADDRESS OF LETTER-ARCHIVE TO
  8400         DFHEIV20
  8401     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8402
  8403
  8404 7000-EXIT.
  8405     EXIT.
  8406
  8407 7050-READ-PREV-ARCH2.
  8408
  8409
  8410* EXEC CICS READPREV
  8411*        DATASET  (W-ARCH2-FILE-ID)
  8412*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8413*        RIDFLD   (W-ARCH2-KEY)
  8414*        END-EXEC.
  8415     MOVE 0
  8416       TO DFHEIV11
  8417*    MOVE '&0S                   )   #00007790' TO DFHEIV0
  8418     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8419     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8420     MOVE X'2020233030303037373930' TO DFHEIV0(25:11)
  8421     CALL 'kxdfhei1' USING DFHEIV0,
  8422           W-ARCH2-FILE-ID,
  8423           DFHEIV20,
  8424           DFHEIV99,
  8425           W-ARCH2-KEY,
  8426           DFHEIV99,
  8427           DFHEIV11,
  8428           DFHEIV99,
  8429           DFHEIV99
  8430     SET ADDRESS OF LETTER-ARCHIVE TO
  8431         DFHEIV20
  8432     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8433
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 170
* EL690.cbl
  8434
  8435 7050-EXIT.
  8436     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 171
* EL690.cbl
  8438 7100-READ-ARCH3-FILE-NEXT.
  8439
  8440
  8441* EXEC CICS READNEXT
  8442*        DATASET  (W-ARCH3-FILE-ID)
  8443*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8444*        RIDFLD   (W-ARCH3-KEY)
  8445*        END-EXEC.
  8446     MOVE 0
  8447       TO DFHEIV11
  8448*    MOVE '&.S                   )   #00007801' TO DFHEIV0
  8449     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8450     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8451     MOVE X'2020233030303037383031' TO DFHEIV0(25:11)
  8452     CALL 'kxdfhei1' USING DFHEIV0,
  8453           W-ARCH3-FILE-ID,
  8454           DFHEIV20,
  8455           DFHEIV99,
  8456           W-ARCH3-KEY,
  8457           DFHEIV99,
  8458           DFHEIV11,
  8459           DFHEIV99,
  8460           DFHEIV99
  8461     SET ADDRESS OF LETTER-ARCHIVE TO
  8462         DFHEIV20
  8463     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8464
  8465
  8466 7100-EXIT.
  8467     EXIT.
  8468
  8469 7150-READ-PREV-ARCH3.
  8470
  8471
  8472* EXEC CICS READPREV
  8473*        DATASET  (W-ARCH3-FILE-ID)
  8474*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8475*        RIDFLD   (W-ARCH3-KEY)
  8476*    END-EXEC.
  8477     MOVE 0
  8478       TO DFHEIV11
  8479*    MOVE '&0S                   )   #00007812' TO DFHEIV0
  8480     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8481     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8482     MOVE X'2020233030303037383132' TO DFHEIV0(25:11)
  8483     CALL 'kxdfhei1' USING DFHEIV0,
  8484           W-ARCH3-FILE-ID,
  8485           DFHEIV20,
  8486           DFHEIV99,
  8487           W-ARCH3-KEY,
  8488           DFHEIV99,
  8489           DFHEIV11,
  8490           DFHEIV99,
  8491           DFHEIV99
  8492     SET ADDRESS OF LETTER-ARCHIVE TO
  8493         DFHEIV20
  8494     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8495
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 172
* EL690.cbl
  8496
  8497 7150-EXIT.
  8498     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 173
* EL690.cbl
  8500 7200-READ-ARCH4-FILE-NEXT.
  8501
  8502
  8503* EXEC CICS READNEXT
  8504*        DATASET  (W-ARCH4-FILE-ID)
  8505*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8506*        RIDFLD   (W-ARCH4-KEY)
  8507*        END-EXEC.
  8508     MOVE 0
  8509       TO DFHEIV11
  8510*    MOVE '&.S                   )   #00007823' TO DFHEIV0
  8511     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8512     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8513     MOVE X'2020233030303037383233' TO DFHEIV0(25:11)
  8514     CALL 'kxdfhei1' USING DFHEIV0,
  8515           W-ARCH4-FILE-ID,
  8516           DFHEIV20,
  8517           DFHEIV99,
  8518           W-ARCH4-KEY,
  8519           DFHEIV99,
  8520           DFHEIV11,
  8521           DFHEIV99,
  8522           DFHEIV99
  8523     SET ADDRESS OF LETTER-ARCHIVE TO
  8524         DFHEIV20
  8525     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8526
  8527
  8528 7200-EXIT.
  8529     EXIT.
  8530
  8531 7250-READ-PREV-ARCH4.
  8532
  8533
  8534* EXEC CICS READPREV
  8535*        DATASET  (W-ARCH4-FILE-ID)
  8536*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8537*        RIDFLD   (W-ARCH4-KEY)
  8538*    END-EXEC.
  8539     MOVE 0
  8540       TO DFHEIV11
  8541*    MOVE '&0S                   )   #00007834' TO DFHEIV0
  8542     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8543     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8544     MOVE X'2020233030303037383334' TO DFHEIV0(25:11)
  8545     CALL 'kxdfhei1' USING DFHEIV0,
  8546           W-ARCH4-FILE-ID,
  8547           DFHEIV20,
  8548           DFHEIV99,
  8549           W-ARCH4-KEY,
  8550           DFHEIV99,
  8551           DFHEIV11,
  8552           DFHEIV99,
  8553           DFHEIV99
  8554     SET ADDRESS OF LETTER-ARCHIVE TO
  8555         DFHEIV20
  8556     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8557
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 174
* EL690.cbl
  8558
  8559 7250-EXIT.
  8560     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 175
* EL690.cbl
  8562 7300-READ-ARCH5-FILE-NEXT.
  8563
  8564
  8565* EXEC CICS READNEXT
  8566*        DATASET  (W-ARCH5-FILE-ID)
  8567*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8568*        RIDFLD   (W-ARCH5-KEY)
  8569*        END-EXEC.
  8570     MOVE 0
  8571       TO DFHEIV11
  8572*    MOVE '&.S                   )   #00007845' TO DFHEIV0
  8573     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8574     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8575     MOVE X'2020233030303037383435' TO DFHEIV0(25:11)
  8576     CALL 'kxdfhei1' USING DFHEIV0,
  8577           W-ARCH5-FILE-ID,
  8578           DFHEIV20,
  8579           DFHEIV99,
  8580           W-ARCH5-KEY,
  8581           DFHEIV99,
  8582           DFHEIV11,
  8583           DFHEIV99,
  8584           DFHEIV99
  8585     SET ADDRESS OF LETTER-ARCHIVE TO
  8586         DFHEIV20
  8587     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8588
  8589
  8590 7300-EXIT.
  8591     EXIT.
  8592
  8593 7350-READ-PREV-ARCH5.
  8594
  8595
  8596* EXEC CICS READPREV
  8597*        DATASET  (W-ARCH5-FILE-ID)
  8598*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8599*        RIDFLD   (W-ARCH5-KEY)
  8600*    END-EXEC.
  8601     MOVE 0
  8602       TO DFHEIV11
  8603*    MOVE '&0S                   )   #00007856' TO DFHEIV0
  8604     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8605     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8606     MOVE X'2020233030303037383536' TO DFHEIV0(25:11)
  8607     CALL 'kxdfhei1' USING DFHEIV0,
  8608           W-ARCH5-FILE-ID,
  8609           DFHEIV20,
  8610           DFHEIV99,
  8611           W-ARCH5-KEY,
  8612           DFHEIV99,
  8613           DFHEIV11,
  8614           DFHEIV99,
  8615           DFHEIV99
  8616     SET ADDRESS OF LETTER-ARCHIVE TO
  8617         DFHEIV20
  8618     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8619
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 176
* EL690.cbl
  8620
  8621 7350-EXIT.
  8622     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 177
* EL690.cbl
  8624 7400-READ-ARCH6-FILE-NEXT.
  8625
  8626
  8627* EXEC CICS READNEXT
  8628*        DATASET  (W-ARCH6-FILE-ID)
  8629*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8630*        RIDFLD   (W-ARCH6-KEY)
  8631*        END-EXEC.
  8632     MOVE 0
  8633       TO DFHEIV11
  8634*    MOVE '&.S                   )   #00007867' TO DFHEIV0
  8635     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8636     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8637     MOVE X'2020233030303037383637' TO DFHEIV0(25:11)
  8638     CALL 'kxdfhei1' USING DFHEIV0,
  8639           W-ARCH6-FILE-ID,
  8640           DFHEIV20,
  8641           DFHEIV99,
  8642           W-ARCH6-KEY,
  8643           DFHEIV99,
  8644           DFHEIV11,
  8645           DFHEIV99,
  8646           DFHEIV99
  8647     SET ADDRESS OF LETTER-ARCHIVE TO
  8648         DFHEIV20
  8649     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8650
  8651
  8652 7400-EXIT.
  8653     EXIT.
  8654
  8655 7450-READ-PREV-ARCH6.
  8656
  8657
  8658* EXEC CICS READPREV
  8659*        DATASET  (W-ARCH6-FILE-ID)
  8660*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8661*        RIDFLD   (W-ARCH6-KEY)
  8662*    END-EXEC.
  8663     MOVE 0
  8664       TO DFHEIV11
  8665*    MOVE '&0S                   )   #00007878' TO DFHEIV0
  8666     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8667     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8668     MOVE X'2020233030303037383738' TO DFHEIV0(25:11)
  8669     CALL 'kxdfhei1' USING DFHEIV0,
  8670           W-ARCH6-FILE-ID,
  8671           DFHEIV20,
  8672           DFHEIV99,
  8673           W-ARCH6-KEY,
  8674           DFHEIV99,
  8675           DFHEIV11,
  8676           DFHEIV99,
  8677           DFHEIV99
  8678     SET ADDRESS OF LETTER-ARCHIVE TO
  8679         DFHEIV20
  8680     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8681
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 178
* EL690.cbl
  8682
  8683 7450-EXIT.
  8684     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 179
* EL690.cbl
  8686 7500-READ-ARCH-FILE-NEXT.
  8687
  8688
  8689* EXEC CICS READNEXT
  8690*        DATASET  (W-ARCH-FILE-ID)
  8691*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8692*        RIDFLD   (W-ARCH-KEY)
  8693*        END-EXEC.
  8694     MOVE 0
  8695       TO DFHEIV11
  8696*    MOVE '&.S                   )   #00007889' TO DFHEIV0
  8697     MOVE X'262E53202020202020202020' TO DFHEIV0(1:12)
  8698     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8699     MOVE X'2020233030303037383839' TO DFHEIV0(25:11)
  8700     CALL 'kxdfhei1' USING DFHEIV0,
  8701           W-ARCH-FILE-ID,
  8702           DFHEIV20,
  8703           DFHEIV99,
  8704           W-ARCH-KEY,
  8705           DFHEIV99,
  8706           DFHEIV11,
  8707           DFHEIV99,
  8708           DFHEIV99
  8709     SET ADDRESS OF LETTER-ARCHIVE TO
  8710         DFHEIV20
  8711     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8712
  8713
  8714 7500-EXIT.
  8715     EXIT.
  8716
  8717 7550-READ-PREV-ARCH.
  8718
  8719
  8720* EXEC CICS READPREV
  8721*        DATASET  (W-ARCH-FILE-ID)
  8722*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8723*        RIDFLD   (W-ARCH-KEY)
  8724*    END-EXEC.
  8725     MOVE 0
  8726       TO DFHEIV11
  8727*    MOVE '&0S                   )   #00007900' TO DFHEIV0
  8728     MOVE X'263053202020202020202020' TO DFHEIV0(1:12)
  8729     MOVE X'202020202020202020202920' TO DFHEIV0(13:12)
  8730     MOVE X'2020233030303037393030' TO DFHEIV0(25:11)
  8731     CALL 'kxdfhei1' USING DFHEIV0,
  8732           W-ARCH-FILE-ID,
  8733           DFHEIV20,
  8734           DFHEIV99,
  8735           W-ARCH-KEY,
  8736           DFHEIV99,
  8737           DFHEIV11,
  8738           DFHEIV99,
  8739           DFHEIV99
  8740     SET ADDRESS OF LETTER-ARCHIVE TO
  8741         DFHEIV20
  8742     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8743
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 180
* EL690.cbl
  8744
  8745 7550-EXIT.
  8746     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 181
* EL690.cbl
  8748 7600-READ-ARCH-FILE.
  8749
  8750
  8751* EXEC CICS READ
  8752*        DATASET  (W-ARCH-FILE-ID)
  8753*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8754*        RIDFLD   (W-ARCH-KEY)
  8755*        UPDATE
  8756*        END-EXEC.
  8757*    MOVE '&"S        EU         (   #00007911' TO DFHEIV0
  8758     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8759     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8760     MOVE X'2020233030303037393131' TO DFHEIV0(25:11)
  8761     CALL 'kxdfhei1' USING DFHEIV0,
  8762           W-ARCH-FILE-ID,
  8763           DFHEIV20,
  8764           DFHEIV99,
  8765           W-ARCH-KEY,
  8766           DFHEIV99,
  8767           DFHEIV99,
  8768           DFHEIV99
  8769     SET ADDRESS OF LETTER-ARCHIVE TO
  8770         DFHEIV20
  8771     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8772
  8773
  8774 7600-EXIT.
  8775     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 182
* EL690.cbl
  8777 7650-READ-ARCT-FILE.
  8778
  8779
  8780* EXEC CICS READ
  8781*        DATASET  (W-ARCT-FILE-ID)
  8782*        SET      (ADDRESS OF LETTER-ARCHIVE-TEXT)
  8783*        RIDFLD   (W-ARCT-KEY)
  8784*        UPDATE
  8785*        END-EXEC.
  8786*    MOVE '&"S        EU         (   #00007923' TO DFHEIV0
  8787     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8788     MOVE X'552020202020202020202820' TO DFHEIV0(13:12)
  8789     MOVE X'2020233030303037393233' TO DFHEIV0(25:11)
  8790     CALL 'kxdfhei1' USING DFHEIV0,
  8791           W-ARCT-FILE-ID,
  8792           DFHEIV20,
  8793           DFHEIV99,
  8794           W-ARCT-KEY,
  8795           DFHEIV99,
  8796           DFHEIV99,
  8797           DFHEIV99
  8798     SET ADDRESS OF LETTER-ARCHIVE-TEXT TO
  8799         DFHEIV20
  8800     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8801
  8802
  8803 7650-EXIT.
  8804     EXIT.
  8805
  8806 7750-READ-ARCH-FILE-NUPDT.
  8807
  8808
  8809* EXEC CICS READ
  8810*        DATASET  (W-ARCH-FILE-ID)
  8811*        SET      (ADDRESS OF LETTER-ARCHIVE)
  8812*        RIDFLD   (W-ARCH-KEY)
  8813*        END-EXEC.
  8814*    MOVE '&"S        E          (   #00007935' TO DFHEIV0
  8815     MOVE X'262253202020202020202045' TO DFHEIV0(1:12)
  8816     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  8817     MOVE X'2020233030303037393335' TO DFHEIV0(25:11)
  8818     CALL 'kxdfhei1' USING DFHEIV0,
  8819           W-ARCH-FILE-ID,
  8820           DFHEIV20,
  8821           DFHEIV99,
  8822           W-ARCH-KEY,
  8823           DFHEIV99,
  8824           DFHEIV99,
  8825           DFHEIV99
  8826     SET ADDRESS OF LETTER-ARCHIVE TO
  8827         DFHEIV20
  8828     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8829
  8830
  8831 7750-EXIT.
  8832     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 183
* EL690.cbl
  8834 7800-DELETE-CYCLE.
  8835
  8836
  8837* EXEC CICS HANDLE CONDITION
  8838*        NOTFND  (7800-EXIT)
  8839*        ENDFILE (7800-EXIT)
  8840*        END-EXEC.
  8841*    MOVE '"$I''                  ! = #00007946' TO DFHEIV0
  8842     MOVE X'222449272020202020202020' TO DFHEIV0(1:12)
  8843     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  8844     MOVE X'3D20233030303037393436' TO DFHEIV0(25:11)
  8845     CALL 'kxdfhei1' USING DFHEIV0
  8846     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8847
  8848
  8849*    PERFORM 7650-READ-ARCT-FILE THRU 7650-EXIT.
  8850
  8851
  8852* EXEC CICS DELETE
  8853*        DATASET   (W-ARCT-FILE-ID)
  8854*        RIDFLD    (W-ARCT-KEY)
  8855*        KEYLENGTH (5)
  8856*        GENERIC
  8857*    END-EXEC.
  8858     MOVE 5
  8859       TO DFHEIV11
  8860*    MOVE '&(  RKG               &   #00007953' TO DFHEIV0
  8861     MOVE X'26282020524B472020202020' TO DFHEIV0(1:12)
  8862     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8863     MOVE X'2020233030303037393533' TO DFHEIV0(25:11)
  8864     CALL 'kxdfhei1' USING DFHEIV0,
  8865           W-ARCT-FILE-ID,
  8866           W-ARCT-KEY,
  8867           DFHEIV11,
  8868           DFHEIV99,
  8869           DFHEIV99
  8870     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8871
  8872
  8873
  8874* EXEC CICS DELETE
  8875*        DATASET   (W-ARCH-FILE-ID)
  8876*        RIDFLD    (W-ARCH-KEY)
  8877*    END-EXEC.
  8878*    MOVE '&(  R                 &   #00007960' TO DFHEIV0
  8879     MOVE X'262820205220202020202020' TO DFHEIV0(1:12)
  8880     MOVE X'202020202020202020202620' TO DFHEIV0(13:12)
  8881     MOVE X'2020233030303037393630' TO DFHEIV0(25:11)
  8882     CALL 'kxdfhei1' USING DFHEIV0,
  8883           W-ARCH-FILE-ID,
  8884           W-ARCH-KEY,
  8885           DFHEIV99,
  8886           DFHEIV99,
  8887           DFHEIV99
  8888     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  8889
  8890
  8891     MOVE +99999999            TO PI-690-ARCHIVE-NUM (W-ARCH-NDX).
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 184
* EL690.cbl
  8892     MOVE 1                      TO W-FIRST-CHANGE-IND.
  8893
  8894 7800-EXIT.
  8895     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 185
* EL690.cbl
  8897 8000-UNAUTHORIZED-ACCESS.
  8898
  8899     MOVE UNACCESS-MSG           TO LOGOFF-MSG.
  8900     GO TO 8300-SEND-TEXT.
  8901
  8902 8000-ARCH2-NOT-OPEN.
  8903
  8904     MOVE ER-7357                TO EMI-ERROR.
  8905     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8906     MOVE -1                     TO TYPEBRL.
  8907
  8908     GO TO 8100-SEND-INITIAL-MAP.
  8909
  8910 8010-ARCH3-NOT-OPEN.
  8911
  8912     MOVE ER-7366                TO EMI-ERROR.
  8913     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8914     MOVE -1                     TO TYPEBRL.
  8915
  8916     GO TO 8100-SEND-INITIAL-MAP.
  8917
  8918 8020-ARCH4-NOT-OPEN.
  8919
  8920     MOVE ER-7385                TO EMI-ERROR.
  8921     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8922     MOVE -1                     TO TYPEBRL.
  8923
  8924     GO TO 8100-SEND-INITIAL-MAP.
  8925
  8926 8030-ARCH5-NOT-OPEN.
  8927
  8928     MOVE ER-7386                TO EMI-ERROR.
  8929     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8930     MOVE -1                     TO TYPEBRL.
  8931
  8932     GO TO 8100-SEND-INITIAL-MAP.
  8933
  8934 8040-ARCH6-NOT-OPEN.
  8935
  8936     MOVE ER-7387                TO EMI-ERROR.
  8937     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8938     MOVE -1                     TO TYPEBRL.
  8939
  8940     GO TO 8100-SEND-INITIAL-MAP.
  8941
  8942 8050-ARCH-NOT-OPEN.
  8943
  8944     MOVE ER-7388                TO EMI-ERROR.
  8945     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8946     MOVE -1                     TO TYPEBRL.
  8947
  8948     GO TO 8100-SEND-INITIAL-MAP.
  8949
  8950 8070-NOTOPEN.
  8951
  8952     MOVE ER-9282                TO EMI-ERROR.
  8953     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8954     MOVE -1                     TO CERTRPL.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 186
* EL690.cbl
  8955
  8956     GO TO 8100-SEND-INITIAL-MAP.
  8957
  8958 8080-ARCH-NOT-FOUND.
  8959
  8960     MOVE ER-9010                TO EMI-ERROR.
  8961     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8962     MOVE -1                     TO CERTRPL.
  8963     MOVE AL-UABON               TO CERTRPA.
  8964     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 187
* EL690.cbl
  8966
  8967 8090-NOT-FOUND-CNTL.
  8968
  8969     MOVE ER-0190                TO EMI-ERROR.
  8970     PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT.
  8971     MOVE -1                     TO MAINTL.
  8972     MOVE AL-UABON               TO MAINTA.
  8973     GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 188
* EL690.cbl
  8975 8100-SEND-INITIAL-MAP.
  8976******************************************************************
  8977*                                                                *
  8978*       THIS LOGIC SENDS THE INITIAL MAP.  IT WILL LOOK FOR      *
  8979*       THE MAP DATA UNDER THE NAMES LISTED BELOW AND FOUND      *
  8980*       IN THE WORK AREA SECTION OF WORKING STORAGE.             *
  8981*                                                                *
  8982*       W-MAP          PIC  X(08)                                *
  8983*       W-MAPSET       PIC  X(08)                                *
  8984*       W-MAP-AREA     PIC  X(**)                                *
  8985* ** THIS AREA REDEFINES MAP AREA AND IS MAP DEPENDENT           *
  8986*    FOR SIZE.                                                   *
  8987*                                                                *
  8988******************************************************************
  8989
  8990     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  8991
  8992     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  8993
  8994
  8995* EXEC CICS SEND
  8996*        MAP    (W-MAP)
  8997*        MAPSET (W-MAPSET)
  8998*        FROM   (EL690AI)
  8999*        ERASE
  9000*        FREEKB
  9001*        CURSOR
  9002*    END-EXEC.
  9003     MOVE LENGTH OF
  9004      EL690AI
  9005       TO DFHEIV12
  9006     MOVE -1
  9007       TO DFHEIV11
  9008*    MOVE '8$     CT  E F  H L F ,   #00008068' TO DFHEIV0
  9009     MOVE X'382420202020204354202045' TO DFHEIV0(1:12)
  9010     MOVE X'2046202048204C2046202C20' TO DFHEIV0(13:12)
  9011     MOVE X'2020233030303038303638' TO DFHEIV0(25:11)
  9012     CALL 'kxdfhei1' USING DFHEIV0,
  9013           W-MAP,
  9014           EL690AI,
  9015           DFHEIV12,
  9016           W-MAPSET,
  9017           DFHEIV99,
  9018           DFHEIV99,
  9019           DFHEIV99,
  9020           DFHEIV11,
  9021           DFHEIV99,
  9022           DFHEIV99,
  9023           DFHEIV99
  9024     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9025
  9026
  9027     GO TO 9000-RETURN-TRANS.
  9028
  9029 8100-EXIT.
  9030     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 189
* EL690.cbl
  9032 8200-SEND-DATAONLY.
  9033******************************************************************
  9034*                                                                *
  9035*       THIS LOGIC SENDS THE UPDATED VERSION OF THE MAP, USING   *
  9036*       THE FIELDS LISTED BELOW WHICH SHOULD BE FOUND IN THE     *
  9037*       WORK AREA OF WORKING STORAGE.                            *
  9038*                                                                *
  9039*       W-MAP           PIC  X(08)                               *
  9040*       W-MAPSET        PIC  X(08)                               *
  9041*       W-MAP-AREA      PIC  X(****)                             *
  9042*                                                                *
  9043* **** REDEFINES MAP AREA AND IS MAP DEPENDENT.                  *
  9044*                                                                *
  9045******************************************************************
  9046
  9047     PERFORM 9600-FORMAT-DATE-TIME THRU 9600-EXIT.
  9048
  9049     MOVE EMI-MESSAGE-AREA (1)   TO ERRMSG1O.
  9050
  9051
  9052* EXEC CICS SEND
  9053*        MAP    (W-MAP)
  9054*        MAPSET (W-MAPSET)
  9055*        FROM   (EL690AI)
  9056*        DATAONLY
  9057*        FREEKB
  9058*        CURSOR
  9059*    END-EXEC.
  9060     MOVE LENGTH OF
  9061      EL690AI
  9062       TO DFHEIV12
  9063     MOVE -1
  9064       TO DFHEIV11
  9065*    MOVE '8$D    CT    F  H L F ,   #00008101' TO DFHEIV0
  9066     MOVE X'382444202020204354202020' TO DFHEIV0(1:12)
  9067     MOVE X'2046202048204C2046202C20' TO DFHEIV0(13:12)
  9068     MOVE X'2020233030303038313031' TO DFHEIV0(25:11)
  9069     CALL 'kxdfhei1' USING DFHEIV0,
  9070           W-MAP,
  9071           EL690AI,
  9072           DFHEIV12,
  9073           W-MAPSET,
  9074           DFHEIV99,
  9075           DFHEIV99,
  9076           DFHEIV99,
  9077           DFHEIV11,
  9078           DFHEIV99,
  9079           DFHEIV99,
  9080           DFHEIV99
  9081     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9082
  9083
  9084     GO TO 9000-RETURN-TRANS.
  9085
  9086 8200-EXIT.
  9087     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 190
* EL690.cbl
  9089 8300-SEND-TEXT.
  9090*****************************************************************
  9091*    THIS PARAGRAPH SENDS THE COMMON LOGOFF MESSAGE.            *
  9092*****************************************************************
  9093
  9094
  9095* EXEC CICS SEND TEXT
  9096*        FROM    (LOGOFF-TEXT)
  9097*        LENGTH  (LOGOFF-LENGTH)
  9098*        ERASE
  9099*        FREEKB
  9100*    END-EXEC.
  9101*    MOVE '8&      T  E F  H   F -   #00008120' TO DFHEIV0
  9102     MOVE X'382620202020202054202045' TO DFHEIV0(1:12)
  9103     MOVE X'204620204820202046202D20' TO DFHEIV0(13:12)
  9104     MOVE X'2020233030303038313230' TO DFHEIV0(25:11)
  9105     CALL 'kxdfhei1' USING DFHEIV0,
  9106           LOGOFF-TEXT,
  9107           LOGOFF-LENGTH,
  9108           DFHEIV99,
  9109           DFHEIV99,
  9110           DFHEIV99,
  9111           DFHEIV99,
  9112           DFHEIV99,
  9113           DFHEIV99,
  9114           DFHEIV99,
  9115           DFHEIV99,
  9116           DFHEIV99,
  9117           DFHEIV99
  9118     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9119
  9120
  9121     GO TO 9000-RETURN-TRANS.
  9122
  9123 8300-EXIT.
  9124     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 191
* EL690.cbl
  9126 9000-RETURN-TRANS.
  9127*****************************************************************
  9128*     THIS PARAGRAPH CAUSES THE PROGRAM TO EXIT TO A            *
  9129*     TRANSACTION.                                              *
  9130*     THE FOLLOWING FIELDS ARE NEEDED IN WORKING-STORAGE        *
  9131*     W-TRANSACTION          PIC  X(04)  VALUE 'XXXX'.          *
  9132*****************************************************************
  9133
  9134     MOVE EMI-ERROR-NUMBER(1)    TO PI-LAST-ERROR-NO.
  9135
  9136
  9137* EXEC CICS RETURN
  9138*        TRANSID  (W-TRANSACTION)
  9139*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9140*        LENGTH   (PI-COMM-LENGTH)
  9141*    END-EXEC.
  9142*    MOVE '.(CT                  ''   #00008142' TO DFHEIV0
  9143     MOVE X'2E2843542020202020202020' TO DFHEIV0(1:12)
  9144     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9145     MOVE X'2020233030303038313432' TO DFHEIV0(25:11)
  9146     CALL 'kxdfhei1' USING DFHEIV0,
  9147           W-TRANSACTION,
  9148           PROGRAM-INTERFACE-BLOCK,
  9149           PI-COMM-LENGTH,
  9150           DFHEIV99,
  9151           DFHEIV99,
  9152           DFHEIV99
  9153     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9154
  9155
  9156 9000-EXIT.
  9157     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 192
* EL690.cbl
  9159 9200-DATE-EDIT.
  9160*****************************************************************
  9161*     THIS ROUTINE VALIDATES THE DATE PASSED IN THE             *
  9162*     'W-DEEDIT-FIELD' BY CALLING THE 'ELDATECV' PROGRAM.       *
  9163*     AFTER EXITING THIS COPY BOOK, 'DC-ERROR-CODE' CAN BE      *
  9164*     CHECKED FOR SPACES TO DETERMINE IF ERRORS WERE FOUND      *
  9165*     ELSE THE BINARY DATE CAN BE FOUND IN 'DC-BIN-DATE-1'.     *
  9166*****************************************************************
  9167
  9168
  9169* EXEC CICS BIF DEEDIT
  9170*        FIELD  (W-DEEDIT-FIELD)
  9171*        LENGTH (15)
  9172*    END-EXEC.
  9173     MOVE 15
  9174       TO DFHEIV11
  9175*    MOVE '@"L                   #   #00008160' TO DFHEIV0
  9176     MOVE X'40224C202020202020202020' TO DFHEIV0(1:12)
  9177     MOVE X'202020202020202020202320' TO DFHEIV0(13:12)
  9178     MOVE X'2020233030303038313630' TO DFHEIV0(25:11)
  9179     CALL 'kxdfhei1' USING DFHEIV0,
  9180           W-DEEDIT-FIELD,
  9181           DFHEIV11
  9182     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9183
  9184
  9185     IF  W-DEEDIT-FIELD-V0 NUMERIC
  9186         MOVE W-DEEDIT-FIELD-V0  TO DC-GREG-DATE-1-EDIT
  9187                                    DC-GREG-DATE-1-MDY
  9188         INSPECT DC-GREG-DATE-1-EDIT CONVERTING ' ' TO '/'
  9189*        INSPECT DC-GREG-DATE-1-EDIT REPLACING ALL ' ' BY '/'
  9190         MOVE '4'                TO DC-OPTION-CODE
  9191
  9192         PERFORM 9500-LINK-DATE-CONVERT THRU 9500-EXIT
  9193
  9194     ELSE
  9195         MOVE HIGH-VALUES        TO  DC-ERROR-CODE.
  9196
  9197 9200-EXIT.
  9198     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 193
* EL690.cbl
  9200 9400-XCTL.
  9201*****************************************************************
  9202*    THIS PARAGRAPH TRANSFERS CONTROL TO INDICATED PROGRAM.     *
  9203*    PROGRAM MUST RESIDE IN W-CALL-PGM.                         *
  9204*****************************************************************
  9205
  9206
  9207* EXEC CICS XCTL
  9208*        PROGRAM  (W-CALL-PGM)
  9209*        COMMAREA (PROGRAM-INTERFACE-BLOCK)
  9210*        LENGTH   (PI-COMM-LENGTH)
  9211*    END-EXEC.
  9212*    MOVE '.$C                   %   #00008186' TO DFHEIV0
  9213     MOVE X'2E2443202020202020202020' TO DFHEIV0(1:12)
  9214     MOVE X'202020202020202020202520' TO DFHEIV0(13:12)
  9215     MOVE X'2020233030303038313836' TO DFHEIV0(25:11)
  9216     CALL 'kxdfhei1' USING DFHEIV0,
  9217           W-CALL-PGM,
  9218           PROGRAM-INTERFACE-BLOCK,
  9219           PI-COMM-LENGTH,
  9220           DFHEIV99
  9221     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9222
  9223
  9224 9400-EXIT.
  9225     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 194
* EL690.cbl
  9227 9500-LINK-DATE-CONVERT.
  9228*****************************************************************
  9229*    THIS PARAGRAPH 'CALLS' THE UTILITY DATE PROCESSOR.         *
  9230*****************************************************************
  9231
  9232
  9233* EXEC CICS LINK
  9234*        PROGRAM    ('ELDATCV')
  9235*        COMMAREA   (DATE-CONVERSION-DATA)
  9236*        LENGTH     (DC-COMM-LENGTH)
  9237*        END-EXEC.
  9238     MOVE 'ELDATCV' TO DFHEIV1
  9239*    MOVE '."C                   (   #00008200' TO DFHEIV0
  9240     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9241     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9242     MOVE X'2020233030303038323030' TO DFHEIV0(25:11)
  9243     CALL 'kxdfhei1' USING DFHEIV0,
  9244           DFHEIV1,
  9245           DATE-CONVERSION-DATA,
  9246           DC-COMM-LENGTH,
  9247           DFHEIV99,
  9248           DFHEIV99,
  9249           DFHEIV99,
  9250           DFHEIV99
  9251     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9252
  9253
  9254 9500-EXIT.
  9255     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 195
* EL690.cbl
  9257 9600-FORMAT-DATE-TIME.
  9258*****************************************************************
  9259*     THIS LOGIC UPDATES THE DATE/TIME INFO ON GIVEN MAP        *
  9260*****************************************************************
  9261
  9262     MOVE W-SAVE-DATE            TO RUNDTEO.
  9263
  9264
  9265* EXEC CICS ASKTIME
  9266*    END-EXEC.
  9267*    MOVE '0"                    "   #00008216' TO DFHEIV0
  9268     MOVE X'302220202020202020202020' TO DFHEIV0(1:12)
  9269     MOVE X'202020202020202020202220' TO DFHEIV0(13:12)
  9270     MOVE X'2020233030303038323136' TO DFHEIV0(25:11)
  9271     CALL 'kxdfhei1' USING DFHEIV0,
  9272           DFHEIV99
  9273     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9274
  9275
  9276     MOVE EIBTIME                TO W-TIME-IN.
  9277     MOVE W-TIME-OUT             TO RUNTIMEO.
  9278     MOVE PI-COMPANY-ID          TO COMPANYO.
  9279     MOVE PI-PROCESSOR-ID        TO USERIDO.
  9280     MOVE W-MAP-NUM              TO PI-CURRENT-SCREEN-NO.
  9281
  9282 9600-EXIT.
  9283     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 196
* EL690.cbl
  9285 9700-PGMID-ERROR.
  9286*****************************************************************
  9287*     THIS PARAGRAPH TRANSFERS CONTROL TO EL005 LOGOFF.         *
  9288*     THE FOLLOWING FIELDS ARE NEEDED IN WORKING-STORAGE        *
  9289*     W-CALL-PGM             PIC  X(08)  VALUE 'EL000   '.      *
  9290*     W-THIS-PGM             PIC  X(08).                        *
  9291*     W-XCTL-005             PIC  X(08)  VALUE 'EL005   '.      *
  9292*****************************************************************
  9293
  9294
  9295* EXEC CICS  HANDLE CONDITION
  9296*        PGMIDERR  (8300-SEND-TEXT)
  9297*        END-EXEC.
  9298*    MOVE '"$L                   ! > #00008237' TO DFHEIV0
  9299     MOVE X'22244C202020202020202020' TO DFHEIV0(1:12)
  9300     MOVE X'202020202020202020202120' TO DFHEIV0(13:12)
  9301     MOVE X'3E20233030303038323337' TO DFHEIV0(25:11)
  9302     CALL 'kxdfhei1' USING DFHEIV0
  9303     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9304
  9305
  9306     MOVE W-THIS-PGM             TO PI-CALLING-PROGRAM.
  9307     MOVE ' '                    TO PI-ENTRY-CD-1.
  9308     MOVE W-XCTL-005             TO W-CALL-PGM
  9309                                    LOGOFF-PGM.
  9310     MOVE PGMIDERR-MSG           TO LOGOFF-FILL.
  9311
  9312     PERFORM 9400-XCTL THRU 9400-EXIT.
  9313
  9314 9700-EXIT.
  9315     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 197
* EL690.cbl
  9317 9800-ABEND.
  9318*****************************************************************
  9319*     THIS PARAGRAPH LINKS TO A COMMON ABEND ROUTINE.           *
  9320*     THE FOLLOWING FIELDS ARE NEEDED IN WORKING-STORAGE        *
  9321*     W-LINK-004             PIC  X(08)  VALUE 'EL004   '.      *
  9322*****************************************************************
  9323
  9324     MOVE W-LINK-004             TO W-CALL-PGM.
  9325     MOVE DFHEIBLK               TO EMI-LINE1
  9326
  9327
  9328* EXEC CICS  LINK
  9329*        PROGRAM   (W-CALL-PGM)
  9330*        COMMAREA  (EMI-LINE1)
  9331*        LENGTH    (72)
  9332*        END-EXEC.
  9333     MOVE 72
  9334       TO DFHEIV11
  9335*    MOVE '."C                   (   #00008262' TO DFHEIV0
  9336     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9337     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9338     MOVE X'2020233030303038323632' TO DFHEIV0(25:11)
  9339     CALL 'kxdfhei1' USING DFHEIV0,
  9340           W-CALL-PGM,
  9341           EMI-LINE1,
  9342           DFHEIV11,
  9343           DFHEIV99,
  9344           DFHEIV99,
  9345           DFHEIV99,
  9346           DFHEIV99
  9347     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9348
  9349
  9350     GO TO 8200-SEND-DATAONLY.
  9351
  9352 9800-EXIT.
  9353     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 198
* EL690.cbl
  9355 9900-ERROR-FORMAT.
  9356*****************************************************************
  9357*     THIS PARAGRAPH IS THE STANDARDIZED ERROR FORMAT ROUTINE.  *
  9358*     THE FIELDS W-LINK-001 AND W-CALL-PGM MUST BE DEFINED IN   *
  9359*     WORKING STORAGE.                                          *
  9360*****************************************************************
  9361
  9362     IF  NOT EMI-ERRORS-COMPLETE
  9363             AND
  9364         EMI-ERROR NOT EQUAL W-LAST-ERROR
  9365         MOVE W-LINK-001         TO W-CALL-PGM
  9366
  9367
  9368* EXEC CICS LINK
  9369*            PROGRAM    (W-CALL-PGM)
  9370*            COMMAREA   (ERROR-MESSAGE-INTERFACE-BLOCK)
  9371*            LENGTH     (EMI-COMM-LENGTH)
  9372*        END-EXEC
  9373*    MOVE '."C                   (   #00008285' TO DFHEIV0
  9374     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9375     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9376     MOVE X'2020233030303038323835' TO DFHEIV0(25:11)
  9377     CALL 'kxdfhei1' USING DFHEIV0,
  9378           W-CALL-PGM,
  9379           ERROR-MESSAGE-INTERFACE-BLOCK,
  9380           EMI-COMM-LENGTH,
  9381           DFHEIV99,
  9382           DFHEIV99,
  9383           DFHEIV99,
  9384           DFHEIV99
  9385     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9386
  9387         MOVE EMI-ERROR TO W-LAST-ERROR.
  9388
  9389 9900-EXIT.
  9390     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 199
* EL690.cbl
  9392 9910-INITIALIZE-SECURITY.
  9393******************************************************************
  9394*                                                                *
  9395*       THIS LOGIC SETS UP AND READS THE TEMPORARY STORAGE       *
  9396*       USER SECURITY RECORD SET UP BY EL125.  BASED ON THE      *
  9397*       APPLICATION NUMBER FOUND IN WORKING STORAGE UNDER        *
  9398*       W-APPL-SECRTY-NDX (PIC  S9(04) COMP), THIS PROGRAM       *
  9399*       MOVES THE APPROPRIATE APPLICATION AUTHORIZATION INTO     *
  9400*       PI-DISPLAY-CAP AND PI-MODIFY-CAP.  IT THEN CHECKS FOR    *
  9401*       BROWSE AUTHORITY AND IF NOT AUTHORIZED WILL SET AN       *
  9402*       ERROR CONDITION AND EXITS THE PROGRAM.                   *
  9403*                                                                *
  9404*       NOTE:  THE CARRIER/GRP/STATE/PRODUCER SECURITY DATA      *
  9405*       IS ALSO PROVIDED BY THIS LOGIC.                          *
  9406*                                                                *
  9407******************************************************************
  9408
  9409     IF  PI-PROCESSOR-ID EQUAL 'LGXX'
  9410         MOVE 'Y'                TO PI-DISPLAY-CAP
  9411                                        PI-MODIFY-CAP
  9412
  9413     ELSE
  9414*        MOVE '125E'             TO W-SC-QUID-SYSTEM
  9415*        MOVE EIBTRMID           TO W-SC-QUID-TERMINAL
  9416
  9417
  9418* EXEC CICS READQ TS
  9419*            QUEUE  (PI-SECURITY-TEMP-STORE-ID)
  9420*            INTO   (SECURITY-CONTROL)
  9421*            LENGTH (SC-COMM-LENGTH)
  9422*            ITEM   (1)
  9423*        END-EXEC
  9424     MOVE 1
  9425       TO DFHEIV11
  9426*    MOVE '*$II   L              ''   #00008321' TO DFHEIV0
  9427     MOVE X'2A2449492020204C20202020' TO DFHEIV0(1:12)
  9428     MOVE X'202020202020202020202720' TO DFHEIV0(13:12)
  9429     MOVE X'2020233030303038333231' TO DFHEIV0(25:11)
  9430     CALL 'kxdfhei1' USING DFHEIV0,
  9431           PI-SECURITY-TEMP-STORE-ID,
  9432           SECURITY-CONTROL,
  9433           SC-COMM-LENGTH,
  9434           DFHEIV11,
  9435           DFHEIV99,
  9436           DFHEIV99
  9437     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK
  9438
  9439         MOVE SC-CREDIT-DISPLAY (W-APPL-SCRTY-NDX)
  9440                                 TO PI-DISPLAY-CAP
  9441         MOVE SC-CREDIT-UPDATE (W-APPL-SCRTY-NDX)
  9442                                 TO PI-MODIFY-CAP
  9443
  9444         IF  NOT DISPLAY-CAP
  9445             MOVE 'READ'         TO SM-READ
  9446             PERFORM 9995-SECURITY-VIOLATION THRU 9995-EXIT
  9447             MOVE ER-9097        TO EMI-ERROR
  9448             PERFORM 9900-ERROR-FORMAT THRU 9900-EXIT
  9449             GO TO 8100-SEND-INITIAL-MAP.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 200
* EL690.cbl
  9450
  9451 9910-EXIT.
  9452     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 201
* EL690.cbl
  9454 9995-SECURITY-VIOLATION.
  9455
  9456     MOVE EIBDATE          TO SM-JUL-DATE.
  9457     MOVE EIBTRMID         TO SM-TERMID.
  9458     MOVE W-THIS-PGM       TO SM-PGM.
  9459     MOVE EIBTIME          TO W-TIME-IN.
  9460     MOVE W-TIME-OUT       TO SM-TIME.
  9461     MOVE PI-PROCESSOR-ID  TO SM-PROCESSOR-ID.
  9462
  9463
  9464* EXEC CICS LINK
  9465*         PROGRAM  ('EL003')
  9466*         COMMAREA (SECURITY-MESSAGE)
  9467*         LENGTH   (80)
  9468*    END-EXEC.
  9469     MOVE 'EL003' TO DFHEIV1
  9470     MOVE 80
  9471       TO DFHEIV11
  9472*    MOVE '."C                   (   #00008352' TO DFHEIV0
  9473     MOVE X'2E2243202020202020202020' TO DFHEIV0(1:12)
  9474     MOVE X'202020202020202020202820' TO DFHEIV0(13:12)
  9475     MOVE X'2020233030303038333532' TO DFHEIV0(25:11)
  9476     CALL 'kxdfhei1' USING DFHEIV0,
  9477           DFHEIV1,
  9478           SECURITY-MESSAGE,
  9479           DFHEIV11,
  9480           DFHEIV99,
  9481           DFHEIV99,
  9482           DFHEIV99,
  9483           DFHEIV99
  9484     GO TO 9999-DFHEXIT DEPENDING ON DFHEIGDK.
  9485
  9486
  9487 9995-EXIT.
  9488     EXIT.
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 202
* EL690.cbl
  9490 9999-GOBACK.
  9491******************************************************************
  9492*                                                                *
  9493*       THIS PARAGRAPH FULFILL THE COMPILE REQUIRMENT FOR A      *
  9494*       COBOL RETURN COMMAND.  IN A SEPARATE PARAGRAPH IT        *
  9495*       PREVENTS AN COMPILE ERROR.                               *
  9496*                                                                *
  9497******************************************************************
  9498
  9499
  9500* GOBACK.
  9501     MOVE '9%                    "   ' TO DFHEIV0
  9502     MOVE 'EL690' TO DFHEIV1
  9503     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9504     GOBACK.
  9505
  9506 9999-EXIT.
  9507     EXIT.
  9508
  9509 9999-DFHBACK SECTION.
  9510     MOVE '9%                    "   ' TO DFHEIV0
  9511     MOVE 'EL690' TO DFHEIV1
  9512     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9513     GOBACK.
  9514 9999-DFHEXIT.
  9515     IF DFHEIGDJ EQUAL 0001
  9516         NEXT SENTENCE
  9517     ELSE IF DFHEIGDJ EQUAL 2
  9518         GO TO 0110-PGM-INITIALIZATION,
  9519               0110-PGM-INITIALIZATION,
  9520               8070-NOTOPEN,
  9521               8080-ARCH-NOT-FOUND,
  9522               9700-PGMID-ERROR,
  9523               9800-ABEND
  9524         DEPENDING ON DFHEIGDI
  9525     ELSE IF DFHEIGDJ EQUAL 3
  9526         GO TO 8080-ARCH-NOT-FOUND,
  9527               8080-ARCH-NOT-FOUND
  9528         DEPENDING ON DFHEIGDI
  9529     ELSE IF DFHEIGDJ EQUAL 4
  9530         GO TO 8080-ARCH-NOT-FOUND,
  9531               8080-ARCH-NOT-FOUND
  9532         DEPENDING ON DFHEIGDI
  9533     ELSE IF DFHEIGDJ EQUAL 5
  9534         GO TO 8080-ARCH-NOT-FOUND,
  9535               8080-ARCH-NOT-FOUND,
  9536               8000-ARCH2-NOT-OPEN
  9537         DEPENDING ON DFHEIGDI
  9538     ELSE IF DFHEIGDJ EQUAL 6
  9539         GO TO 2100-END-BROWSE,
  9540               2100-END-BROWSE
  9541         DEPENDING ON DFHEIGDI
  9542     ELSE IF DFHEIGDJ EQUAL 7
  9543         GO TO 8080-ARCH-NOT-FOUND,
  9544               8080-ARCH-NOT-FOUND,
  9545               8010-ARCH3-NOT-OPEN
  9546         DEPENDING ON DFHEIGDI
  9547     ELSE IF DFHEIGDJ EQUAL 8
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 203
* EL690.cbl
  9548         GO TO 2200-END-BROWSE,
  9549               2200-END-BROWSE
  9550         DEPENDING ON DFHEIGDI
  9551     ELSE IF DFHEIGDJ EQUAL 9
  9552         GO TO 8080-ARCH-NOT-FOUND,
  9553               8080-ARCH-NOT-FOUND,
  9554               8020-ARCH4-NOT-OPEN
  9555         DEPENDING ON DFHEIGDI
  9556     ELSE IF DFHEIGDJ EQUAL 10
  9557         GO TO 2300-END-BROWSE,
  9558               2300-END-BROWSE
  9559         DEPENDING ON DFHEIGDI
  9560     ELSE IF DFHEIGDJ EQUAL 11
  9561         GO TO 8080-ARCH-NOT-FOUND,
  9562               8080-ARCH-NOT-FOUND,
  9563               8030-ARCH5-NOT-OPEN
  9564         DEPENDING ON DFHEIGDI
  9565     ELSE IF DFHEIGDJ EQUAL 12
  9566         GO TO 2400-END-BROWSE,
  9567               2400-END-BROWSE
  9568         DEPENDING ON DFHEIGDI
  9569     ELSE IF DFHEIGDJ EQUAL 13
  9570         GO TO 8080-ARCH-NOT-FOUND,
  9571               8080-ARCH-NOT-FOUND,
  9572               8040-ARCH6-NOT-OPEN
  9573         DEPENDING ON DFHEIGDI
  9574     ELSE IF DFHEIGDJ EQUAL 14
  9575         GO TO 2500-END-BROWSE,
  9576               2500-END-BROWSE
  9577         DEPENDING ON DFHEIGDI
  9578     ELSE IF DFHEIGDJ EQUAL 15
  9579         GO TO 8080-ARCH-NOT-FOUND,
  9580               8080-ARCH-NOT-FOUND,
  9581               8050-ARCH-NOT-OPEN
  9582         DEPENDING ON DFHEIGDI
  9583     ELSE IF DFHEIGDJ EQUAL 16
  9584         GO TO 2600-END-BROWSE,
  9585               2600-END-BROWSE
  9586         DEPENDING ON DFHEIGDI
  9587     ELSE IF DFHEIGDJ EQUAL 17
  9588         GO TO 8080-ARCH-NOT-FOUND,
  9589               8080-ARCH-NOT-FOUND,
  9590               8000-ARCH2-NOT-OPEN
  9591         DEPENDING ON DFHEIGDI
  9592     ELSE IF DFHEIGDJ EQUAL 18
  9593         GO TO 3100-END-BROWSE,
  9594               3100-END-BROWSE
  9595         DEPENDING ON DFHEIGDI
  9596     ELSE IF DFHEIGDJ EQUAL 19
  9597         GO TO 8080-ARCH-NOT-FOUND,
  9598               8080-ARCH-NOT-FOUND,
  9599               8010-ARCH3-NOT-OPEN
  9600         DEPENDING ON DFHEIGDI
  9601     ELSE IF DFHEIGDJ EQUAL 20
  9602         GO TO 3200-END-BROWSE,
  9603               3200-END-BROWSE
  9604         DEPENDING ON DFHEIGDI
  9605     ELSE IF DFHEIGDJ EQUAL 21
* Micro Focus Server Express         V5.1 revision 000 27-Oct-20 12:47 Page 204
* EL690.cbl
  9606         GO TO 8080-ARCH-NOT-FOUND,
  9607               8080-ARCH-NOT-FOUND,
  9608               8020-ARCH4-NOT-OPEN
  9609         DEPENDING ON DFHEIGDI
  9610     ELSE IF DFHEIGDJ EQUAL 22
  9611         GO TO 3300-END-BROWSE,
  9612               3300-END-BROWSE
  9613         DEPENDING ON DFHEIGDI
  9614     ELSE IF DFHEIGDJ EQUAL 23
  9615         GO TO 8080-ARCH-NOT-FOUND,
  9616               8080-ARCH-NOT-FOUND,
  9617               8030-ARCH5-NOT-OPEN
  9618         DEPENDING ON DFHEIGDI
  9619     ELSE IF DFHEIGDJ EQUAL 24
  9620         GO TO 3400-END-BROWSE,
  9621               3400-END-BROWSE
  9622         DEPENDING ON DFHEIGDI
  9623     ELSE IF DFHEIGDJ EQUAL 25
  9624         GO TO 8080-ARCH-NOT-FOUND,
  9625               8080-ARCH-NOT-FOUND,
  9626               8040-ARCH6-NOT-OPEN
  9627         DEPENDING ON DFHEIGDI
  9628     ELSE IF DFHEIGDJ EQUAL 26
  9629         GO TO 3500-END-BROWSE,
  9630               3500-END-BROWSE
  9631         DEPENDING ON DFHEIGDI
  9632     ELSE IF DFHEIGDJ EQUAL 27
  9633         GO TO 8080-ARCH-NOT-FOUND,
  9634               8080-ARCH-NOT-FOUND,
  9635               8050-ARCH-NOT-OPEN
  9636         DEPENDING ON DFHEIGDI
  9637     ELSE IF DFHEIGDJ EQUAL 28
  9638         GO TO 3600-END-BROWSE,
  9639               3600-END-BROWSE
  9640         DEPENDING ON DFHEIGDI
  9641     ELSE IF DFHEIGDJ EQUAL 29
  9642         GO TO 7800-EXIT,
  9643               7800-EXIT
  9644         DEPENDING ON DFHEIGDI
  9645     ELSE IF DFHEIGDJ EQUAL 30
  9646         GO TO 8300-SEND-TEXT
  9647         DEPENDING ON DFHEIGDI.
  9648     MOVE '9%                    "   ' TO DFHEIV0
  9649     MOVE 'EL690' TO DFHEIV1
  9650     CALL 'kxdfhei1' USING DFHEIV0 DFHEIV1
  9651     GOBACK.
* Micro Focus Server Express         V5.1 revision 000 Compiler
* Copyright (C) Micro Focus IP Development Limited 1984-2012.
*                                                        REF GNR-008065005AF
* Total Messages:     0
* Data:        7296     Code:       24981
